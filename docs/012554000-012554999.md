# StackOverflow 问答 12554000-12554999

# php - 在 php.ini 中设置我的错误消息的样式。我有一半的样式，但似乎无法让其余的样式

> ID：12554000
> 
> 赞同：0
> 
> 时间：2012-09-23T16:22:05.430
> 
> 标签：php, forms, styles

我有这部分 php 代码，它设置错误消息的样式

```
echo("<p class=contactformnotsent>Unable to send information because you need to...</p>"); 
```

我如何还包括这些行，以便它们可以以相同的方式设置样式？

```
foreach ($errors as $error)
   { print $error."<br />\n"; } 
```

当我添加这些行时，它在第二行给我一个语法错误，即

```
 { print $error."<br />\n"; } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T16:24:27.677

通过将它们包装在段落中：

```
echo('<p class="contactformnotsent">');
echo('Unable to send information because you need to...');
foreach ($errors as $error) { 
  echo($error . "<br />\n"); 
}
echo('</p>'); 
```

# serialization - 如何递归调用 WriteJson？

> ID：12554002
> 
> 赞同：2
> 
> 时间：2012-09-23T16:22:10.173
> 
> 标签：serialization, json.net, jsonserializer

我使用 Json.Net。当我序列化一个`Department2`对象并被`WriteJson()`调用时，我希望它与每个`Telephone2`对象一起递归调用，就像我在`ReadJson()`.

我怎么做？

```
using System;
using Newtonsoft.Json;
using Newtonsoft.Json.Linq;

public interface ISimpleDatabag
{
    string Databag { get; set; }
}

[JsonConverter(typeof(JsonDataBagCreationConverter<Department2>))]
public class Department2
{
    public Telephone2[] Phones { get; set; }
}

[JsonConverter(typeof(JsonDataBagCreationConverter<Telephone2>))]
public class Telephone2
{
    public string Name { get; set; }
    public string AreaCode { get; set; }
    public string Number { get; set; }
}

public class JsonDataBagCreationConverter<T> : JsonConverter where T : new()
{
    // Json.Net version 4.5.7.15008
    public override void WriteJson(JsonWriter writer, object value, JsonSerializer serializer)
    {
        // When I serialize Department and this function is invoked
        // I want it to recursively invoke WriteJson with each of the Telephone objects
        // Like I do in ReadJson
        // How do I do that?
        T t = (T)value;
        serializer.Serialize(writer, t.GetType());
    }

    public override object ReadJson(JsonReader reader, Type objectType, object existingValue, JsonSerializer serializer)
    {
        var jsonObject = JObject.Load(reader);
        var target = Create(objectType, jsonObject);
        serializer.Populate(jsonObject.CreateReader(), target); // Will call this function recursively for any objects that have JsonDataBagCreationConverter as attribute
       return target;
    }

    protected T Create(Type objectType, JObject jsonObject)
    {
        return new T();
    }

    public override bool CanConvert(Type objectType)
    {
        return typeof(T).IsAssignableFrom(objectType);
    }   
}

 private void Form1_Load(object sender, EventArgs e)
        {
            string jsonInput = "{\"Name\": \"Seek4\" , \"CustomDepartmentData\": \"This is custom department data\", \"Phones\":[ {\"Name\": \"A\", \"AreaCode\":444, \"Number\":11111111} ,{\"Name\": \"B\", \"AreaCode\":555, \"Number\":987987987}, {\"Name\": \"C\", \"AreaCode\":222, \"Number\":123123123, \"CustomPhoneData\": \"This is custom phone data\"} ] }";
            Department2 objDepartment2 = JsonConvert.DeserializeObject<Department2>(jsonInput); // Yes, it works well
            Array.Reverse(objDepartment2.Phones);
            string jsonNoDatabag = JsonConvert.SerializeObject(objDepartment2);
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T08:44:05.533

我最终自己控制了整个过程，使用这个巨大的（未重构的）功能。我基本上调查了要序列化的对象的每个属性，然后逐个属性地对其进行序列化。然后我可以在每个属性上做自定义的事情

```
/// <summary>
/// Serializes an object by merging its current values into its databag and returns the databag
    /// </summary>
    /// <param name="objectToSerialize"></param>
    /// <returns>the current values merged into the original databag</returns>
    /// <remarks>Jan Nielsen, 01-10-2012</remarks>
    internal static string SerializeObjectToDatabag(object objectToSerialize)
    {
        // You have to do it property by property instead of just serializing the entire object and merge it into the original
        // because the object might contain lists of objects with custom data and these list might have been sorted differently from when they were loaded
        // So you cannot merge them properly unless you do it on a per listitem basis.
        // Which is what I do here.
        try
        {

            if (objectToSerialize == null) // If you ie serialize an empty object in an array
            {
                return null;
            }

            string updatedDatabag = "";
            bool isIDataBag = objectToSerialize is IDataBag;
            if (isIDataBag)
            {
                updatedDatabag = ((IDataBag)objectToSerialize).Data == null ? "" : ((IDataBag)objectToSerialize).Data.ToString();
                //  updatedDatabag = ((IDataBag)objectToSerialize).Data.ToString(); // Save original data in a local variable. This is the one we will merge new values into
            }
            string result = "";
            // Now iterate through the objects properties
            // Possible properties:
            // Simple types: string, int, bool etc: their current value should be overwritten in the databag
            // types that implement IDatabag: they should be sent to this function recursively so their possible customdata is not overwritten
            // but instead their simple values are merged into their own databag. Then the result of this single property merge is overwritten in the outer objects databag
            // Types that are not simple and don't implement IDatabag but have properties that implement IDatabag
            // types that are not simple and don't implement IDatabag and don't have any properties in any depth that implement IDatabag: They are overwritten in the databag
            // Types that are arrays: 
            //      If the types in the array are simple types (string, bool etc) the entire array property is overwritten in the databag
            //      If the types in the array implement IDatabag each object is sent recursively to this function and their databag is updated via merge
            //      Then the entire array is overwritten in the outer objects databag
            // Types that are generic list are treated like arrays

            var properties = objectToSerialize.GetType().GetProperties();

            // In order to be able to deserialize abstract classes and interfaces, we need to serialize the classname with the class
            // the deserializer recognizes the word $type followed by a type, when its is invoked with a serializerSettings of 
            // serializerSettings.TypeNameHandling = TypeNameHandling.Objects;
            string name = objectToSerialize.GetType().AssemblyQualifiedName;
            string shortName = RemoveAssemblyDetails(name);
            bool addedType = false;

            foreach (var propertyInfo in properties)
            {
                if (propertyInfo.Name.ToLower() != "data") // Just skip Databag. Databag is not a "real" property but the contents of all the properties when the object was loaded + possible custom data
                {
                    if (!addedType)
                    {
                        string jsonSingleProperty = "{ " + ToCustomJson("$type") + " : " + ToCustomJson(shortName) + " }";
                        // Merge the current value (jsonSingleProperty) into the databag (that might already have been updated with the values of other properties) 
                        // and update the current result with the new values. Ie "Name" : "Seek4" is updated to "Name" : "Seek4Cars" in the databag
                        // and the function will now use the updated databag to merge the other properties into
                        updatedDatabag = MergeDefault(jsonSingleProperty, updatedDatabag, true);
                        addedType = true;
                    }
                    // propertyInfo.Name.ToLower().Contains("struct")
                    var value = propertyInfo.GetValue(objectToSerialize, null); // This gets the value of the specified property in the current object

                    isIDataBag = value is IDataBag; // Update for the current object. Note that ie an array of IDatabag will return false here, because array is not IsimpleDatabag

                    // Basically we should just check if the property implements IDatabag
                    // But the simpletype check is faster because I don't have to check for the interfaces on ie a string, int etc.
                    // This branch takes care of 3 cases:
                    // 1) it is a simple type, ie int
                    // 2) value is null
                    // 3) it is an array with a value of null
                    // If an array with values enters this branch of code the values of the array will be appended, overwritten
                    // Therefore arrays are treated below in a special case. Unless they are null
                    // GeneralFunctions.IsExtendedSimpleType_AllTypes(propertyInfo.PropertyType) returns true on ie string[], but only arrays with a value of null should be handled here

                    // This first check originally just checked for simple types
                    // Then it became extended simple types ie non-simple types that only contains simple types ie List<int,int>
                    // But not arrays that must be handled separately
                    // Then it also handled null values 
                    // And then a special case was made for arrays that are null

                    if ((GeneralFunctions.IsExtendedSimpleType_AllTypes(propertyInfo.PropertyType) || value == null) && (!propertyInfo.PropertyType.IsArray || (propertyInfo.PropertyType.IsArray && value == null)))
                    {
                        // You have to merge even though it is default value.
                        // If you have ie a bool that has an initial value of true and you deliberately sets it to false
                        // You want the defaultvalue of false to be merged into the json.

                        string jsonSingleProperty = "{" + ToCustomJson(propertyInfo.Name) + " : " + ToCustomJson(value) + "}"; // ie {"Name" : "Seek4Cars"}
                        // Merge the current value (jsonSingleProperty) into the databag (that might already have been updated with the values of other properties) 
                        // and update the current result with the new values. Ie "Name" : "Seek4" is updated to "Name" : "Seek4Cars" in the databag
                        // and the function will now use the updated databag to merge the other properties into
                        updatedDatabag = MergeDefault(jsonSingleProperty, updatedDatabag, true);
                        continue;
                    }

                    if (isIDataBag) // ie PhoneSingle. A single property of type IDataBag
                    {
                        // Invoke recursively

                        // First check if this is an object with all null values
                        bool allPropertiesAreNull = true; // Maybe this should in the future be expanded with a check on if the property has its default value ie an int property with a value of 0
                        foreach (var propertyInfoLocal in value.GetType().GetProperties())
                        {
                            var valueLocal = propertyInfoLocal.GetValue(value, null);
                            if (valueLocal != null)
                            {
                                allPropertiesAreNull = false;
                                break;
                            }
                        }
                        var testjson = "";
                        if (allPropertiesAreNull)
                        {
                            result = "{" + ToCustomJson(propertyInfo.Name) + " : " + " { } }";
                        }
                        else
                        {
                            testjson = ToCustomJson(value);
                            result = "{" + ToCustomJson(propertyInfo.Name) + " : " + SerializeObjectToDatabag(value) + "}";
                        }

                        updatedDatabag = MergeDefault(result, updatedDatabag, true);
                        continue;
                    }

                    bool containsIDataBag = CheckForDatabagInterfaces.ImplementsInterface(propertyInfo.PropertyType, "idatabag"); // Check if anything inside the property implements IDatabag ie an array of IDatabag

                    if (containsIDataBag)
                    {
                        // Check if it is somekind of generic list (List<T>, Dictionary<T,T) etc) and if it is a type of ignoreTypes ie List<entity>)
                        if (value.GetType().IsGenericType && value.GetType().GetGenericArguments().Length > 0)
                        {
                            string listValuesAsJson = "";
                            if (value is IEnumerable)
                            {
                                listValuesAsJson += "{ " + ToCustomJson(propertyInfo.Name) + " : [";
                                bool containsItems = false;
                                foreach (var element in (IEnumerable)value)
                                {
                                    containsItems = true;
                                    var current = SerializeObjectToDatabag(element);
                                    if (current != null) // If you serialize an empty array element it is null
                                    {
                                        listValuesAsJson += current + ", "; // Add , between each element
                                    }
                                }
                                if (containsItems)
                                {
                                    listValuesAsJson = listValuesAsJson.Substring(0, listValuesAsJson.Length - 2) + "] }"; // remove last , and add ending ] for the array and add a } because this property is flowing in the free
                                }
                                else // No items in value
                                {
                                    listValuesAsJson += "] }"; // add ending ] for the array and add a } because this property is flowing in the free
                                }
                            }
                            else // A single, generic KeyValuePair property
                            {
                                listValuesAsJson += "{ " + ToCustomJson(propertyInfo.Name) + " : ";
                                listValuesAsJson += SerializeObjectToDatabag(value);
                                listValuesAsJson += " }";
                            }

                            updatedDatabag = MergeDefault(listValuesAsJson, updatedDatabag, false);
                        }
                        else if (value.GetType().IsArray)
                        {
                            string arrayValuesAsJson = "{ " + ToCustomJson(propertyInfo.Name) + " : [";
                            bool containsItems = false;
                            foreach (var element in (Array)value)
                            {
                                // Treat them the same way you treat any other object 
                                var current = SerializeObjectToDatabag(element);
                                if (current != null) // If you serialize an empty array element it is null
                                {
                                    containsItems = true;
                                    arrayValuesAsJson += current + ", ";
                                }
                            }
                            if (containsItems)
                            {
                                arrayValuesAsJson = arrayValuesAsJson.Substring(0, arrayValuesAsJson.Length - 2) + "] }"; // remove last , and add ending ] for the array and add a } because this property is flowing in the free
                            }
                            else // No items in value
                            {
                                arrayValuesAsJson += "] }"; // add ending ] for the array and add a } because this property is flowing in the free
                            }
                            updatedDatabag = MergeDefault(arrayValuesAsJson, updatedDatabag, false);
                        }
                        else if ( value.GetType().BaseType != null && value.GetType().BaseType.FullName.ToLower().Contains("system.collections.objectmodel"))
                        {
                            // This branch was made specifically to take care of the Media collection of a Seek4.Entities.V2.Media.MediaCollection
                            var genericList = (IList)value;
                            int counter = genericList.Count;

                            string listAsJson = "{ " + ToCustomJson(propertyInfo.Name) + " : [";
                            if (counter == 0)
                            {
                                listAsJson += "] }"; // Ie { "Media": [] }
                            }
                            else
                            {
                                foreach (var obj in genericList)
                                {
                                    var current = SerializeObjectToDatabag(obj);
                                    listAsJson += current + ", ";
                                }
                                listAsJson = listAsJson.Substring(0, listAsJson.Length -2) + " ] }" ; 
                            }
                            updatedDatabag = MergeDefault(listAsJson, updatedDatabag, true); // hvordan gør json.net dette med standard?

                        }
                        else // a single Non-IDatabag property that contains Idatabag properties
                        {
                            string tempResult = "{ " + ToCustomJson(propertyInfo.Name) + " : ";
                            tempResult += SerializeObjectToDatabag(value) + " }";
                            updatedDatabag = MergeDefault(tempResult, updatedDatabag, true);
                        }
                    }
                    else
                    {
                        if (value.GetType().IsArray) // This is an array of simple types so just overwrite
                        {
                            string arrayAsJson = "{ " + ToCustomJson(propertyInfo.Name) + " : ";
                            arrayAsJson += ToCustomJson(value) + "}";
                            updatedDatabag = MergeDefault(arrayAsJson, updatedDatabag, false);
                        }
                        else // ie an object that is not simpledatabag and doesn't contain simple databag
                        {
                            string jsonSingleProperty = "{" + ToCustomJson(propertyInfo.Name) + " : " + ToCustomJson(value) + "}";
                            updatedDatabag = MergeDefault(jsonSingleProperty, updatedDatabag, true);
                        }
                    }
                }
            }
            return updatedDatabag;
        }
        catch (Exception ex)
        {
            string message = ex.Message;
            string stack = ex.StackTrace;
            throw;
        }
    }

internal static string ToCustomJson(object objectToConvertToJson)
    {
        try
        {
            // Distinguished from Mongodb.Bson.ToJson() extensionmethod by Custom name
            JsonSerializerSettings serializerSettings = new JsonSerializerSettings();
            serializerSettings.TypeNameHandling = TypeNameHandling.Objects; // Adds a $type on all objects which we need when it is abstract classes and interfaces
            IgnoreDataMemberContractResolver contractResolver = new IgnoreDataMemberContractResolver(null, true, true);
            serializerSettings.ContractResolver = contractResolver;
            serializerSettings.DefaultValueHandling = DefaultValueHandling.Ignore;
            IsoDateTimeConverter converter = new IsoDateTimeConverter();
            serializerSettings.Converters.Add(converter);
            string result = JsonConvert.SerializeObject(objectToConvertToJson, Formatting.None, serializerSettings);
            return result;
        }
        catch (Exception ex)
        {
            throw new Exception("Error in ToCustomJson: " + ex.Message, ex);
        }
    } 
```

# c# - C# 正则表达式仅在标签外替换字符串

> ID：12554005
> 
> 赞同：2
> 
> 时间：2012-09-23T16:22:33.060
> 
> 标签：c#, regex

我有一个字符串，它代表 xml 的一部分。

```
string text ="word foo<tag foo='a' />another word " 
```

我需要替换这个字符串中的特定单词。所以我使用了这段代码：

```
Regex regex = new Regex("\\b" + co + "\\b", RegexOptions.IgnoreCase);
return regex.Replace(text, new MatchEvaluator(subZvyrazniStr));
static string     subZvyrazniStr(Match m)
    {
        return "<FtxFraze>" + m.ToString() + "</FtxFraze>";
    } 
```

但是我的代码的问题是，它还替换了标签内的字符串，这是我不想要的。那么我应该添加什么来仅替换标签之外的单词？

例如：当我将变量 co 设置为“foo”时，我想返回`"word <FtxFraze>foo</FtxFraze><tag foo='a' />another word"`

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-23T17:45:48.247

如果您不那么挑剔，在某些情况下，像这样的简单技巧可能就足够了：

```
\bfoo\b(?![^<>]*>) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-23T17:56:00.470

这就是你想要的

```
(?<!\<[\w\s]*?)\bfoo\b(?![\w\s]*?>) 
```

在[这里工作](http://regexhero.net/tester/)

[我在这里](https://stackoverflow.com/questions/12305182/parse-commas-not-surrounded-by-brackets/12305883#12305883)回答了一个相关的问题

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-23T16:56:06.010

试试这个正则表达式：

```
Regex r = new Regex(@"\b" + rep + @".*?(?=\<)\b", RegexOptions.IgnoreCase); 
```

# android - 来自 XML 的 Android 自定义控件 onClick

> ID：12554006
> 
> 赞同：1
> 
> 时间：2012-09-23T16:22:33.883
> 
> 标签：android, custom-controls

我创建了一个具有子框架布局的自定义控件，现在我需要在控件上添加点击处理。如果我只是实现 OnClickListener，我将不得不在 Java 代码中指定处理程序。有没有办法像使用普通的 Button 元素一样从 XML 附加侦听器？

# node.js - 在 async.series 中调用 async.series 会产生不可预测的输出

> ID：12554017
> 
> 赞同：4
> 
> 时间：2012-09-23T16:24:37.940
> 
> 标签：node.js

使用 caolan 的 node.js 异步库，我一直在尝试调用一个`async.series`在另一个使用 async.series 的函数内部使用的函数，但我仍然无法让函数以正确的顺序运行，详情如下：

终端输出显示第二个函数在第一个函数之前被调用，原因不明：

```
The "sys" module is now called "util". It should have a similar interface.
Starting the second step in the series
Value of b: undefined
Invoking the function firstStep
the value of toObtain is: [object Object] 
```

这是相应的源代码：

```
var im = require('imagemagick');
var async = require('async');

var toObtain;

var b;
async.series([

function (callback) {
    //It appears that this function is being invoked after the second function.
    //Why is this happening?
    firstStep();
    callback();
},

function (callback) {
    //Why is the output of this function being displayed BEFORE the output of the function above? It's the opposite of the order in which I'm calling the functions.
    console.log("Starting the second step in the series");
    console.log("Value of b: " + b);
}]);

function firstStep(){
    async.series([

    function (next) { // step one - call the function that sets toObtain
        im.identify('kittens.png', function (err, features) {
            if (err) throw err;
            console.log("Invoking the function firstStep");
            toObtain = features;
            //console.log(toObtain);
            b = toObtain.height;
            next(); // invoke the callback provided by async
        });
    },

    function (next) { // step two - display it
        console.log('the value of toObtain is: %s',toObtain.toString());
    }]);
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-23T17:30:20.857

经过大约一个小时的实验，我让它正常工作。我只是简单地修改了 firstStep 函数，使它接受一个回调函数作为参数，并在 firstStep 函数的末尾调用回调。

```
var im = require('imagemagick');
var async = require('async');

var toObtain = false;

var b;
async.series([

function (callback) {
    firstStep(callback); //the firstStep function takes a callback parameter and calls the callback when it finishes running. Now everything seems to be working as intended.
},

function (callback) {
    console.log("Starting the second step in the series");
    console.log("Value of b: " + b);
}]);

function firstStep(theCallback){
    async.series([

    function (next) { // step one - call the function that sets toObtain
        im.identify('kittens.png', function (err, features) {
            if (err) throw err;
            console.log("Invoking the function firstStep");
            toObtain = features;
            //console.log(toObtain);
            b = toObtain.height;
            next(); // invoke the callback provided by async
        });
    },

    function (next) { // step two - display it
        console.log('the value of toObtain is: %s',toObtain.toString());
        theCallback();
    }]);
} 
```

# python - SimpleHTTPServer - 服务大文件

> ID：12554021
> 
> 赞同：4
> 
> 时间：2012-09-23T16:24:53.713
> 
> 标签：python, http, simplehttpserver

我正在使用`python -m SimpleHTTPServer`一个小项目。文件 index.html 引用了一些视频。 `<video><source src="big_buck_bunny_480p_stereo.ogg"></video>` 该文件的大小为 159 MB。当我尝试下载它时，SimpleHTTPServer 会抛出一些错误消息而不是我的视频。

```
Marc-Laptop - - [23/Sep/2012 18:18:29] "GET /big_buck_bunny_480p_stereo.ogg HTTP
/1.1" 200 -
----------------------------------------
Exception happened during processing of request from ('192.168.4.38', 51152)
Traceback (most recent call last):
  File "C:Program Files (x86)PythonlibSocketServer.py", line 284, in _handle
_request_noblock
    self.process_request(request, client_address)
  File "C:Program Files (x86)PythonlibSocketServer.py", line 310, in process
_request
    self.finish_request(request, client_address)
  File "C:Program Files (x86)PythonlibSocketServer.py", line 323, in finish_
request
    self.RequestHandlerClass(request, client_address, self)
  File "C:Program Files (x86)PythonlibSocketServer.py", line 640, in __init_
_
    self.finish()
  File "C:Program Files (x86)PythonlibSocketServer.py", line 693, in finish
    self.wfile.flush()
  File "C:Program Files (x86)Pythonlibsocket.py", line 303, in flush
    self._sock.sendall(view[write_offset:write_offset+buffer_size])
error: [Errno 10054] Eine vorhandene Verbindung wurde vom Remotehost geschlossen

---------------------------------------- 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-07T05:32:56.820

simpleHTTPServer 正在尝试缓冲所有内容，并且确实会因内存不足而爆炸。最好异步执行，但 simpleHTTPServer 不知道如何执行此操作。检查那个[线程](https://code.activestate.com/recipes/259148-simple-http-server-based-on-asyncoreasynchat/)。有人提出了simpleHTTPserver的修改版：[SimpleAsyncHTTPServer.py](https://duckduckgo.com/?q=SimpleAsyncHTTPServer.py)

# android - 将数据从数据库传递到活动

> ID：12554023
> 
> 赞同：0
> 
> 时间：2012-09-23T16:25:11.263
> 
> 标签：android, database, google-maps

我正在开发一个应用程序，当我按下按钮时，它会在地图上显示位置。

但是，我想从数据库中获取此按钮正在接收的纬度和经度数据。

我已经有一个名为“DetaljiProizvoda”的活动，它从数据库中获取项目的详细信息，并且我在数据库中添加了（在文件 DatabaseHelper.java 中）int 类型的纬度和经度列。

我想将纬度和经度数据传递给 GMapsActivity.java 文件并使用它们来显示地图上每个项目的位置。

我在 LogCat 中遇到这些错误，请帮助：

```
09-23 18:07:52.986: E/AndroidRuntime(22995): FATAL EXCEPTION: main
09-23 18:07:52.986: E/AndroidRuntime(22995): java.lang.IllegalStateException: Could not execute method of the activity
09-23 18:07:52.986: E/AndroidRuntime(22995):    at android.view.View$1.onClick(View.java:3044)
09-23 18:07:52.986: E/AndroidRuntime(22995):    at android.view.View.performClick(View.java:3511)
09-23 18:07:52.986: E/AndroidRuntime(22995):    at android.view.View$PerformClick.run(View.java:14105)
09-23 18:07:52.986: E/AndroidRuntime(22995):    at android.os.Handler.handleCallback(Handler.java:605)
09-23 18:07:52.986: E/AndroidRuntime(22995):    at android.os.Handler.dispatchMessage(Handler.java:92)
09-23 18:07:52.986: E/AndroidRuntime(22995):    at android.os.Looper.loop(Looper.java:137)
09-23 18:07:52.986: E/AndroidRuntime(22995):    at android.app.ActivityThread.main(ActivityThread.java:4424)
09-23 18:07:52.986: E/AndroidRuntime(22995):    at java.lang.reflect.Method.invokeNative(Native Method)
09-23 18:07:52.986: E/AndroidRuntime(22995):    at java.lang.reflect.Method.invoke(Method.java:511)
09-23 18:07:52.986: E/AndroidRuntime(22995):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
09-23 18:07:52.986: E/AndroidRuntime(22995):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
09-23 18:07:52.986: E/AndroidRuntime(22995):    at dalvik.system.NativeStart.main(Native Method)
09-23 18:07:52.986: E/AndroidRuntime(22995): Caused by: java.lang.reflect.InvocationTargetException
09-23 18:07:52.986: E/AndroidRuntime(22995):    at java.lang.reflect.Method.invokeNative(Native Method)
09-23 18:07:52.986: E/AndroidRuntime(22995):    at java.lang.reflect.Method.invoke(Method.java:511)
09-23 18:07:52.986: E/AndroidRuntime(22995):    at android.view.View$1.onClick(View.java:3039)
09-23 18:07:52.986: E/AndroidRuntime(22995):    ... 11 more
09-23 18:07:52.986: E/AndroidRuntime(22995): Caused by: java.lang.NullPointerException
09-23 18:07:52.986: E/AndroidRuntime(22995):    at hr.punctum.LociranjePonudaProizvoda.DetaljiProizvoda.changeActivity(DetaljiProizvoda.java:66)
09-23 18:07:52.986: E/AndroidRuntime(22995):    ... 14 more 
```

**DetaljiProizvoda.java**

```
@Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.detalji_proizvoda);

        proizvodId = getIntent().getIntExtra("PROIZVODI_ID", 0);
        SQLiteDatabase db = (new DatabaseHelper(this)).getWritableDatabase();
        Cursor cursor = db.rawQuery("SELECT proizv._id, proizv.naziv, proizv.tvrtka, proizv.cijena, proizv.kategorija, proizv.telefonTvrtke, proizv.adresaTvrtke, proizv.latitude, proizv.longitude FROM proizvodi proizv LEFT OUTER JOIN proizvodi mgr ON proizv._id = mgr._id WHERE proizv._id = ?", 
                new String[]{""+proizvodId});

        if (cursor.getCount() == 1)
        {
            cursor.moveToFirst();

            naziv = (TextView) findViewById(R.id.naziv);
            naziv.setText(cursor.getString(cursor.getColumnIndex("naziv"))); 

            kategorija = (TextView) findViewById(R.id.kategorija);
            kategorija.setText(cursor.getString(cursor.getColumnIndex("kategorija")));

            tvrtka = (TextView) findViewById(R.id.tvrtka);
            tvrtka.setText(cursor.getString(cursor.getColumnIndex("tvrtka")));

            telefonTvrtke = (TextView) findViewById(R.id.telefonTvrtke);
            telefonTvrtke.setText(cursor.getString(cursor.getColumnIndex("telefonTvrtke")));

            adresaTvrtke = (TextView) findViewById(R.id.adresaTvrtke);
            adresaTvrtke.setText(cursor.getString(cursor.getColumnIndex("adresaTvrtke")));

        }

        cursor.close();
        db.close(); 

    }

      public void changeActivity(View view) { 

        Intent intent = new Intent(DetaljiProizvoda.this, GMapsActivity.class);

            intent.putExtra("PROIZVODI_ID", cursor.getColumnIndex("_id"));
            intent.putExtra("PROIZVODI_LATITUDE", cursor.getColumnIndex("latitude"));
            intent.putExtra("PROIZVODI_LONGITUDE", cursor.getColumnIndex("longitude"));
            startActivity(intent);                    

        }                    

    } 
```

**GMapsActivity.java**

公共类 GMapsActivity 扩展 MapActivity {

```
private MapView mapView;
protected int latitudeE6;
protected int longitudeE6;  

@Override
public void onCreate(Bundle savedInstanceState) {

    super.onCreate(savedInstanceState);
    setContentView(R.layout.gmaps_layout);

    latitudeE6 = getIntent().getIntExtra("PROIZVODI_LATITUDE", 0);       
    longitudeE6 = getIntent().getIntExtra("PROIZVODI_LONGITUDE", 0);      

    mapView = (MapView) findViewById(R.id.map_view);       
    mapView.setBuiltInZoomControls(true);

    List<Overlay> mapOverlays = mapView.getOverlays();
    Drawable drawable = this.getResources().getDrawable(R.drawable.icon);
    CustomItemizedOverlay itemizedOverlay = new CustomItemizedOverlay(drawable, this);

    GeoPoint point = new GeoPoint(latitudeE6, longitudeE6);
    OverlayItem overlayitem = new OverlayItem(point, "Dobrodošli u " , "tvrtku Protis");

    itemizedOverlay.addOverlay(overlayitem);
    mapOverlays.add(itemizedOverlay);

    MapController mapController = mapView.getController();

    mapController.animateTo(point);
    mapController.setZoom(18);

}

@Override
protected boolean isRouteDisplayed() {
    return false;
} 
```

}

**ListaProizvoda.java**

```
package hr.punctum.LociranjePonudaProizvoda;    

public class ListaProizvoda extends ListActivity {

    protected EditText searchText;
    protected SQLiteDatabase db;
    protected Cursor cursor;
    protected ListAdapter adapter;

    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
        db = (new DatabaseHelper(this)).getWritableDatabase();
        searchText = (EditText) findViewById (R.id.searchText);

    }    

    @SuppressWarnings("deprecation")
    //kreiranje metode Search za pretraživanje proizvoda u bazi podataka
    public void search(View view) {
        // slijedeci sql query vraca rezultat iz baze svih zapisa koji pocinju na slovo uneseno u search polje
        cursor = db.rawQuery("SELECT _id, naziv, tvrtka, cijena FROM proizvodi WHERE naziv LIKE ?", 
                        new String[]{searchText.getText().toString() + "%"}); 
        adapter = new SimpleCursorAdapter(this,R.layout.proizvodi_list_artikl,cursor,new String[] {"naziv", "tvrtka", "cijena"},new int[] {R.id.naziv, R.id.tvrtka, R.id.cijena});

        setListAdapter(adapter);

    }

    public void onListItemClick(ListView parent, View view, int position, long id) {
        //kreiranje Intenta za komunikaciju s drugim activity-om
        Intent intent = new Intent(this, DetaljiProizvoda.class);
        Cursor cursor = (Cursor) adapter.getItem(position);
        //slanje varijable
        intent.putExtra("PROIZVODI_ID", cursor.getInt(cursor.getColumnIndex("_id")));
        startActivity(intent);

    } 
```

**数据库助手.java**

```
public class DatabaseHelper extends SQLiteOpenHelper {

    public static final String DATABASE_NAME = "proizvodidb";

    public DatabaseHelper(Context context) {
        super(context, DATABASE_NAME, null, 4);
    }

    @Override
    public void onCreate(SQLiteDatabase db) {

        String sql = "CREATE TABLE IF NOT EXISTS proizvodi (" +
                        "_id INTEGER PRIMARY KEY AUTOINCREMENT, " + 
                        "naziv TEXT, " +
                        "tvrtka TEXT, " +
                        "cijena TEXT, " +
                        "kategorija TEXT, " +
                        "telefonTvrtke TEXT, " +
                        "adresaTvrtke TEXT, " +
                        "latitude INTEGER, " +
                        "longitude INTEGER)";

        db.execSQL(sql);

        ContentValues values = new ContentValues();

        values.put("naziv", "Nikon D800");
        values.put("tvrtka", "MagazinRS");
        values.put("cijena", "21600");
        values.put("kategorija", "fotoaparati");
        values.put("telefonTvrtke", "454562542");
        values.put("adresaTvrtke", "Laniste 1B");
        values.put("latitude", 458011234);
        values.put("longitude", 159520583);
        db.insert("proizvodi", "tvrtka", values);   

        ....        

    }

    @Override
    public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
        db.execSQL("DROP TABLE IF EXISTS proizvodi");
        onCreate(db);
    }

} 
```

**detalji_proizvoda.xml**

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"

    android:orientation="vertical"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:paddingTop="12dp"
    android:paddingLeft="12dp">

    <TextView
        android:id="@+id/naziv"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"/>
    <TextView
        android:id="@+id/kategorija"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"/>
    <TextView
        android:id="@+id/tvrtka"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"/>
    <TextView
        android:id="@+id/telefonTvrtke"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"/>
    <TextView
        android:id="@+id/adresaTvrtke"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"/>      
    <Button 
        android:id="@+id/btnButton"
        android:layout_height="wrap_content"
        android:layout_width="fill_parent"
        android:layout_gravity="left"
        android:onClick="changeActivity"
        android:text="@string/prikazi_lokaciju"
        android:textSize="12dp" />

</LinearLayout> 
```

新的 logcat（在 changeActivity 方法后关闭游标后）：

```
09-23 20:04:30.050: E/AndroidRuntime(995): FATAL EXCEPTION: main
09-23 20:04:30.050: E/AndroidRuntime(995): java.lang.IllegalStateException: Could not execute method of the activity
09-23 20:04:30.050: E/AndroidRuntime(995):  at android.view.View$1.onClick(View.java:3044)
09-23 20:04:30.050: E/AndroidRuntime(995):  at android.view.View.performClick(View.java:3511)
09-23 20:04:30.050: E/AndroidRuntime(995):  at android.view.View$PerformClick.run(View.java:14105)
09-23 20:04:30.050: E/AndroidRuntime(995):  at android.os.Handler.handleCallback(Handler.java:605)
09-23 20:04:30.050: E/AndroidRuntime(995):  at android.os.Handler.dispatchMessage(Handler.java:92)
09-23 20:04:30.050: E/AndroidRuntime(995):  at android.os.Looper.loop(Looper.java:137)
09-23 20:04:30.050: E/AndroidRuntime(995):  at android.app.ActivityThread.main(ActivityThread.java:4424)
09-23 20:04:30.050: E/AndroidRuntime(995):  at java.lang.reflect.Method.invokeNative(Native Method)
09-23 20:04:30.050: E/AndroidRuntime(995):  at java.lang.reflect.Method.invoke(Method.java:511)
09-23 20:04:30.050: E/AndroidRuntime(995):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
09-23 20:04:30.050: E/AndroidRuntime(995):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
09-23 20:04:30.050: E/AndroidRuntime(995):  at dalvik.system.NativeStart.main(Native Method)
09-23 20:04:30.050: E/AndroidRuntime(995): Caused by: java.lang.reflect.InvocationTargetException
09-23 20:04:30.050: E/AndroidRuntime(995):  at java.lang.reflect.Method.invokeNative(Native Method)
09-23 20:04:30.050: E/AndroidRuntime(995):  at java.lang.reflect.Method.invoke(Method.java:511)
09-23 20:04:30.050: E/AndroidRuntime(995):  at android.view.View$1.onClick(View.java:3039)
09-23 20:04:30.050: E/AndroidRuntime(995):  ... 11 more
09-23 20:04:30.050: E/AndroidRuntime(995): Caused by: java.lang.NullPointerException
09-23 20:04:30.050: E/AndroidRuntime(995):  at hr.punctum.LociranjePonudaProizvoda.DetaljiProizvoda.changeActivity(DetaljiProizvoda.java:65)
09-23 20:04:30.050: E/AndroidRuntime(995):  ... 14 more 
```

**日志猫：**

```
09-23 22:46:14.652: E/AndroidRuntime(680): FATAL EXCEPTION: main
09-23 22:46:14.652: E/AndroidRuntime(680): java.lang.RuntimeException: Unable to instantiate activity ComponentInfo{hr.punctum.LociranjePonudaProizvoda/hr.punctum.LociranjePonudaProizvoda.ListaProizvoda}: java.lang.ClassNotFoundException: hr.punctum.LociranjePonudaProizvoda.ListaProizvoda
09-23 22:46:14.652: E/AndroidRuntime(680):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1880)
09-23 22:46:14.652: E/AndroidRuntime(680):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1981)
09-23 22:46:14.652: E/AndroidRuntime(680):  at android.app.ActivityThread.access$600(ActivityThread.java:123)
09-23 22:46:14.652: E/AndroidRuntime(680):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1147)
09-23 22:46:14.652: E/AndroidRuntime(680):  at android.os.Handler.dispatchMessage(Handler.java:99)
09-23 22:46:14.652: E/AndroidRuntime(680):  at android.os.Looper.loop(Looper.java:137)
09-23 22:46:14.652: E/AndroidRuntime(680):  at android.app.ActivityThread.main(ActivityThread.java:4424)
09-23 22:46:14.652: E/AndroidRuntime(680):  at java.lang.reflect.Method.invokeNative(Native Method)
09-23 22:46:14.652: E/AndroidRuntime(680):  at java.lang.reflect.Method.invoke(Method.java:511)
09-23 22:46:14.652: E/AndroidRuntime(680):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
09-23 22:46:14.652: E/AndroidRuntime(680):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
09-23 22:46:14.652: E/AndroidRuntime(680):  at dalvik.system.NativeStart.main(Native Method)
09-23 22:46:14.652: E/AndroidRuntime(680): Caused by: java.lang.ClassNotFoundException: hr.punctum.LociranjePonudaProizvoda.ListaProizvoda
09-23 22:46:14.652: E/AndroidRuntime(680):  at dalvik.system.BaseDexClassLoader.findClass(BaseDexClassLoader.java:61)
09-23 22:46:14.652: E/AndroidRuntime(680):  at java.lang.ClassLoader.loadClass(ClassLoader.java:501)
09-23 22:46:14.652: E/AndroidRuntime(680):  at java.lang.ClassLoader.loadClass(ClassLoader.java:461)
09-23 22:46:14.652: E/AndroidRuntime(680):  at android.app.Instrumentation.newActivity(Instrumentation.java:1023)
09-23 22:46:14.652: E/AndroidRuntime(680):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1871)
09-23 22:46:14.652: E/AndroidRuntime(680):  ... 11 more 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T16:52:17.620

在 onCreate() 方法结束时关闭光标。然后在方法 changeActivity() 中尝试使用它。

# c++ - 显示最高销售额和平均销售额

> ID：12554028
> 
> 赞同：-6
> 
> 时间：2012-09-23T16:25:54.410
> 
> 标签：c++

我有这个程序在 C++ 中找到最高的销售数字和平均值，但它在下面给出错误请帮助

```
#include <iostream>

using namespace std;

// You must add the three functions here

void getSales(float & sales1P, float & sales2P, float & sales3P,
        float & sales4P) {

    cout << "Enter four sales values: " << endl;

    cin >> sales1P >> sales2P >> sales3P >> sales4P;
}

float calcAverage(float sales1P, float sales2P, float sales3P, float sales4P) {

    return (sales1P + sales2P + sales3P + sales4P) / 4;
}

float findHighest(float sales1P, float sales2P, float sales3P, float sales4P)

{

    float highest = sales1P;
    if (sales2P > highest)
        highest = sales2P;
    if (sales3P > highest)
        highest = sales3P;
    if (sales4P > highest)
        highest = sales4P;
}

void displayOutput(float highestSales, float averageSales) {
    cout << "The highest sales figure is " << highestSales

    << " with an average of " << averageSales << endl;
}

int main()

{
    float sales1,
    sales2,
    sales3,
    sales4;
    float averageSales;
    float highestSales;
    for (int i = 0; i < 4; i++)
    // Get the sales for each division.
    sales1 = getSales();
    sales2 = getSales();
    sales3 = getSales();
    sales4 = getSales();
    //
    //getSales(sales1, sales2, sales3, sales4);
    averageSales = calcAverage(sales1, sales2, sales3, sales4);
    //getSales(sales1, sales2, sales3, sales4);
    highestSales = findHighest(sales1, sales2, sales3, sales4);
    displayOutput(highestSales, averageSales);
    system("PAUSE");
    return 0;
} 
```

错误：

```
error::::    In function `int main()': 
\Examples_C++\question_4a.cpp 5 C:\Examples_C++\C [Error] too few arguments to function void getSales(float&, float&, float&, float&)' 
\Examples_C++\question_4a.cpp 41 C:\Examples_C++\C [Error] at this point in file 
\Examples_C++\question_4a.cpp 41 C:\Examples_C++\C [Error] void value not ignored as it ought to be
\Examples_C++\question_4a.cpp 5 C:\Examples_C++\C [Error] too few arguments to function `void getSales(float&, float&, float&, float&)' 
\Examples_C++\question_4a.cpp 42 C:\Examples_C++\C [Error] at this point in file 
\Examples_C++\question_4a.cpp 42 C:\Examples_C++\C [Error] void value not ignored as it ought to be 
\Examples_C++\question_4a.cpp 5 C:\Examples_C++\C [Error] too few arguments to function `void getSales(float&, float&, float&, float&)' 
\Examples_C++\question_4a.cpp 43 C:\Examples_C++\C [Error] at this point in file 
\Examples_C++\question_4a.cpp 43 C:\Examples_C++\C [Error] void value not ignored as it ought to be 
\Examples_C++\question_4a.cpp 5 C:\Examples_C++\C [Error] too few arguments to function `void getSales(float&, float&, float&, float&)' 
\Examples_C++\question_4a.cpp 44 C:\Examples_C++\C [Error] at this point in file 
\Examples_C++\question_4a.cpp 44 C:\Examples_C++\C [Error] void value not ignored as it ought to be 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T16:28:19.687

在本节：

```
sales1 = getSales();

sales2 = getSales();

sales3 = getSales();

sales4 = getSales(); 
```

您正在使用一个名为 (getSales) 的函数，该函数应该具有以下签名：getSales(float&, float&, float&, float&)。这意味着该函数有 4 个参数，而你给它 0。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-23T16:39:07.823

这是您的函数定义：

```
void getSales(float & sales1P, float & sales2P, float & sales3P, float & sales4P) 
```

这就是你所说的：

```
sales1 = getSales();

sales2 = getSales();

sales3 = getSales();

sales4 = getSales(); 
```

您是否看到定义与如何调用它之间的脱节？

您需要使用 4 个浮动地址调用 getSales()

编辑：因为 OP 似乎在理解它时遇到了问题......

```
#include<iostream>
using namespace std;

// You must add the three functions here
//changed these to take pointers to floats
void getSales(float *sales1P, float *sales2P, float *sales3P, float *sales4P) {

cout << "Enter four sales values: " <
//Changed the cin to store in the content of pointers
cin >> *sales1P >> *sales2P >> *sales3P >> *sales4P; }

float calcAverage(float sales1P, float sales2P, float sales3P, float sales4P) {

return (sales1P + sales2P + sales3P + sales4P) / 4; }

float findHighest( float sales1P, float sales2P, float sales3P, float sales4P)

{

float highest = sales1P;
if (sales2P > highest)
    highest = sales2P;
if (sales3P > highest)
    highest = sales3P;
if (sales4P > highest)
    highest = sales4P;
//You were for some reason missing the return statement on highest here. 
return highest;
}

void displayOutput(float highestSales, float averageSales) { cout << "The highest sales         figure is " << highestSales  << " with an average of " << averageSales <<endl;
}

int main()

{

float sales1,sales2,sales3,sales4;

float averageSales;

float highestSales;

//for (int i = 0; i < 4; i++)

// Get the sales for each division.
//The For loop here is useless. Call the function with the addresses of the float values. 
getSales(&sales1, &sales2, &sales3, &sales4);

averageSales = calcAverage(sales1, sales2, sales3, sales4);

highestSales = findHighest(sales1, sales2, sales3, sales4);

displayOutput(highestSales, averageSales);

system("PAUSE");

return 0;

} 
```

[阅读指](http://cslibrary.stanford.edu/106/)针对您很有用。

1.  这里的for循环没用
2.  我更改了定义以接受指向浮点数的指针
3.  我传入浮点地址作为参数
4.  您错过了 getHighest() 函数中的 return 语句。
5.  此外，您正在为 getSales 的结果分配一些东西，但 getSales 返回**void**。

我建议你回去学习函数和赋值的基础知识。

祝你有美好的一天！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-23T16:32:44.673

```
// getSales(sales1, sales2, sales3, sales4); 
```

这是正确的。你为什么把它注释掉，直接反对你定义的函数的参数计数？

此外，您的`for`循环可能没有做您认为它正在做的事情。你忘了`{}`. 你现在所拥有的只会执行*第一*行 4 次。

# actionscript-3 - AS3 从服务器中的 SWF 浏览客户端文件

> ID：12554034
> 
> 赞同：1
> 
> 时间：2012-09-23T16:27:23.370
> 
> 标签：actionscript-3, filereference

AS3的新手在这里！:)

基本上我正在尝试编写一个应用程序，让用户选择一个图像文件并显示它（然后我将操纵像素，所以我不希望应用程序将图像存储在一个新文件中，只是管理 ByteArray）。

到目前为止，我在 Flash Develop 中编写了一些工作代码，这些代码显示了一个选择图像然后显示它的窗口。但是当我将生成的文件（myapplication.swf、expressinstall.swf、index.html 和 js 文件夹）上传到服务器时，窗口不再显示。

我正在使用 FileReference.browse() 方法。

怎么了？

（编辑：正如 The_asMan 指出的，我们错过了一些代码，这里是 - 在 The_asMan 的建议下改进）

我的包裹：

```
package searchfiles 
{
    import flash.display.BitmapData;
    import flash.display.Loader;
    import flash.display.Sprite;
    import flash.net.FileReference;
    import flash.net.FileReferenceList;
    import flash.net.FileFilter;
    import flash.events.*;
    import flash.net.FileFilter; 
    import flash.net.FileReference; 
    import flash.net.URLRequest; 
    import flash.utils.ByteArray; 
    import flash.display.DisplayObject;

    /**
     * ...
     * @author ddd
     */
    public class searchForFiles extends EventDispatcher
    {
        public var newfile:FileReference;
        public var loader:Loader
        public var bitmapimg:BitmapData;            

        public function searchForFiles() {
            newfile = new FileReference();
            newfile.addEventListener(Event.SELECT, onFileSelected); 
            newfile.addEventListener(Event.CANCEL, onCancel); 
            newfile.addEventListener(IOErrorEvent.IO_ERROR, onIOError); 
            newfile.addEventListener(SecurityErrorEvent.SECURITY_ERROR, onSecurityError); 

            trace("abbiamo instanziato un searchForFiles");
            var textTypeFilter:FileFilter = new FileFilter("Image files (*.png, *.jpg, *tif)", 
                        "*.png; *.jpg; *tif"); 
            newfile.browse([textTypeFilter]);   

        }       

        public function onFileSelected(evt:Event):void 
        { 
            newfile.addEventListener(ProgressEvent.PROGRESS, onProgress); 
            newfile.addEventListener(Event.COMPLETE, onComplete); 
            newfile.load(); 
        } 

        public function onProgress(evt:ProgressEvent):void 
        { 
            trace("Loaded " + evt.bytesLoaded + " of " + evt.bytesTotal + " bytes."); 

        } 

        public function onComplete(evt:Event):void 
        { 
            trace("File was successfully loaded."); 
            loader = new Loader();              
            loader.loadBytes(newfile.data);         
            loader.contentLoaderInfo.addEventListener(Event.COMPLETE, getBitmapData);           
        } 

        private function erroremanip(evt:IOErrorEvent):void {
            trace("errore " + evt);
        }
        private var bitmapData:BitmapData

        public function getBitmapData(e:Event):void {
            var content:* = loader.content;
            bitmapData = new BitmapData(content.width,content.height,true,0x00000000);
            trace("loader.width = " +loader.width);
            dispatchEvent( new Event(Event.COMPLETE));
            //trace("get bitmap data called");
        }

        public function onCancel(evt:Event):void 
        { 
            trace("The browse request was canceled by the user."); 
        } 

        public function onIOError(evt:IOErrorEvent):void 
        { 
            trace("There was an IO Error."); 
        } 
        public function onSecurityError(evt:Event):void 
        { 
            trace("There was a security error."); 
        }                       
    }    
} 
```

这是 main()

```
package 
{
    import flash.display.Loader;
    import flash.display.MovieClip;
    import flash.display.Sprite;
    import flash.errors.IOError;
    import flash.events.*;
    import flash.events.MouseEvent;
    import flash.net.URLLoader;
    import flash.net.URLRequest;
    import searchfiles.searchForFiles;

    /**
     * ...
     * @author ddd
     */
    [SWF(width = "550", height = "600")]

    public class Main extends MovieClip 
    {
        public var file:searchForFiles;
        public var mybtn:Loader = new Loader();

        public function Main():void 
        {
            if (stage) init();
            else addEventListener(Event.ADDED_TO_STAGE, init);

        }

        private function init(e:Event = null):void 
        {
            removeEventListener(Event.ADDED_TO_STAGE, init);
            // entry point          
            mybtn.addEventListener(MouseEvent.CLICK, mouseclicked);
            mybtn.addEventListener(IOErrorEvent.IO_ERROR, erroremanip);
            var urlqst:URLRequest = new URLRequest("preview_true.png");
            mybtn.load(urlqst);
            addChild(mybtn);

        }

        public function mouseclicked(e:MouseEvent):void {
            trace("clicked");
            file = new searchForFiles();
            file.addEventListener(Event.COMPLETE, puttheimage);     
        }
        private function erroremanip(e:IOError):void {
            trace("ciao erroreio");
        }
        private function puttheimage(e:Event) :void {
            addChild(file.loader);

        }
    }   
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T18:54:41.167

`FileReference`用于访问用户本地机器上的文件。听起来您想从托管 SWF 文件的同一台服务器加载文件。

您不能从 Actionscript 中“浏览”服务器 - 除非您在服务器上编写代码来启用它 - 但您可以使用`URLLoader`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-24T18:10:15.620

> FileReference.browse() 当需要通过用户交互 IE 触发外部本地沙箱时：鼠标单击。
> 基本上，点击事件需要在堆栈中的某个地方。
> 你可以用这个来验证。

```
 file = new FileReference();
    file.addEventListener(SecurityErrorEvent.SECURITY_ERROR, securityErrorHandler);

    private function securityErrorHandler(event:SecurityErrorEvent):void {
        trace("securityErrorHandler: " + event);
    } 
```

但是，您没有发布任何代码，并且很难确定您做错了什么。

[编辑]

```
package searchfiles 
{
    import flash.display.BitmapData;
    import flash.display.Loader;
    import flash.display.Sprite;
    import flash.net.FileReference;
    import flash.net.FileReferenceList;
    import flash.net.FileFilter;
    import flash.events.*;
    import flash.net.FileFilter; 
    import flash.net.FileReference; 
    import flash.net.URLRequest; 
    import flash.utils.ByteArray; 
    import flash.display.DisplayObject;

    /**
     * ...
     * @author ddd
     */
    public class searchForFiles extends EventDispatcher
    {
        public var newfile:FileReference;
        public var loader:Loader
        public var bitmapimg:BitmapData;            

        public function searchForFiles() {
            newfile = new FileReference();
            newfile.addEventListener(Event.SELECT, onFileSelected); 
            newfile.addEventListener(Event.CANCEL, onCancel); 
            newfile.addEventListener(IOErrorEvent.IO_ERROR, onIOError); 
            newfile.addEventListener(SecurityErrorEvent.SECURITY_ERROR, onSecurityError);   
        }

             // new function
        public function browse(event:Event):void{
            var textTypeFilter:FileFilter = new FileFilter("Image files (*.png, *.jpg, *tif)", "*.png; *.jpg; *tif");   
            newfile.browse([textTypeFilter]);
        }

        public function onFileSelected(evt:Event):void 
        { 
                    newfile.addEventListener(ProgressEvent.PROGRESS, onProgress); 
                    newfile.addEventListener(Event.COMPLETE, onComplete); 
                    newfile.load(); 
        } 

        public function onProgress(evt:ProgressEvent):void 
        { 
            trace("Loaded " + evt.bytesLoaded + " of " + evt.bytesTotal + " bytes."); 

        } 

        public function onComplete(evt:Event):void 
        { 
            trace("File was successfully loaded."); 
            loader = new Loader();              
            loader.loadBytes(newfile.data);         
            loader.contentLoaderInfo.addEventListener(Event.COMPLETE, getBitmapData);           
        } 

        private function erroremanip(evt:IOErrorEvent):void {
            trace("errore " + evt);
        }
        private var bitmapData:BitmapData

        public function getBitmapData(e:Event):void {
            var content:* = loader.content;
            bitmapData = new BitmapData(content.width,content.height,true,0x00000000);
            trace("loader.width = " +loader.width);
            dispatchEvent( new Event(Event.COMPLETE));
            //trace("get bitmap data called");
        }

        public function onCancel(evt:Event):void 
        { 
            trace("The browse request was canceled by the user."); 
        } 

        public function onIOError(evt:IOErrorEvent):void 
        { 
            trace("There was an IO Error."); 
        } 
        public function onSecurityError(evt:Event):void 
        { 
            trace("There was a security error."); 
        }                       
    }    
} 
```

这是 main()

```
package 
{
    import flash.display.Loader;
    import flash.display.MovieClip;
    import flash.display.Sprite;
    import flash.errors.IOError;
    import flash.events.*;
    import flash.events.MouseEvent;
    import flash.net.URLLoader;
    import flash.net.URLRequest;
    import searchfiles.searchForFiles;

    /**
     * ...
     * @author ddd
     */
    [SWF(width = "550", height = "600")]

    public class Main extends MovieClip 
    {
        public var file:searchForFiles;
        public var mybtn:Loader = new Loader();

        public function Main():void 
        {
            if (stage) init();
            else addEventListener(Event.ADDED_TO_STAGE, init);

        }

        private function init(e:Event = null):void 
        {
            removeEventListener(Event.ADDED_TO_STAGE, init);
            // entry point

                     // moved to init
            file = new searchForFiles();
            file.addEventListener(Event.COMPLETE, puttheimage);

            mybtn.addEventListener(MouseEvent.CLICK, mouseclicked);
            mybtn.addEventListener(IOErrorEvent.IO_ERROR, erroremanip);
            var urlqst:URLRequest = new URLRequest("preview_true.png");
            mybtn.load(urlqst);
            addChild(mybtn);

        }

        public function mouseclicked(e:MouseEvent):void {
            trace("clicked");
                    // events need to be set before any active code is run in the object
                    // that is why we moved listeners or else you risk the listener
                    // not getting triggered
                    file.browse()
        }
        private function erroremanip(e:IOError):void {
            trace("ciao erroreio");
        }
        private function puttheimage(e:Event) :void {
            addChild(file.loader);

        }
    }   
} 
```

# android - 该应用程序的行为奇怪 - 不同版本的 android

> ID：12554039
> 
> 赞同：0
> 
> 时间：2012-09-23T16:28:20.437
> 
> 标签：android

应用程序在不同版本的 android 中表现异常这是正确的视图：

```
http://shrani.si/f/1b/Ng/20a9K5H6/cool.png 
```

这是错误的看法：

```
http://shrani.si/f/3A/tJ/FQNPrZA/notcool.png 
```

这是我定义主要布局的 main.xml：

```
[st.koda]

<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:background="#646464"
    android:orientation="vertical" >

    <LinearLayout
        android:layout_width="fill_parent"
        android:layout_height="0dip"
        android:layout_gravity="bottom|left"
        android:layout_weight="0.94" >

        <aa.bb.cc.Panel
            android:id="@+id/yourID"
            android:layout_width="fill_parent"
            android:layout_height="412dp" />
    </LinearLayout>

</LinearLayout>

[/st.koda] 
```

这是 onCreate 方法的声明：

```
[st.koda]
  public void onCreate(Bundle savedInstanceState) {

                super.onCreate(savedInstanceState);

                setContentView(R.layout.main);
                mPanel = (Panel) findViewById(R.id.yourID);
[/st.koda] 
```

# c++ - Can't load libcef symbols in Visual Studio 2010

> ID：12554042
> 
> 赞同：3
> 
> 时间：2012-09-23T16:28:39.810
> 
> 标签：c++, symbols, chromium

I'm working with libcef right now, and I can't get the .pdb file to load while I'm debugging.

I'm using the version 3.1180.719 precompiled binary from here: [http://code.google.com/p/chromiumembedded/downloads/detail?name=cef_binary_3.1180.719_windows.zip&can=2&q=](http://code.google.com/p/chromiumembedded/downloads/detail?name=cef_binary_3.1180.719_windows.zip&can=2&q=)

And I'm trying to load the 3.1180.719 symbols from the .pdb file I downloaded from here: [http://www.magpcss.net/cef_symbols/](http://www.magpcss.net/cef_symbols/)

When I hit a breakpoint with some libcef calls in the stack I try to load symbols from this .pdb file (kept in the same directory as libcef.dll and libcef.lib, different directory from my project). It says "**A matching symbol file was not found in this folder**".

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-12T18:51:13.833

The .pdb file only works with Release versions of CEF. I was trying to use it on the debug .dll.

You can find the Debug CEF symbols (.pdb files) here: [http://www.magpcss.net/cef_symbols/](http://www.magpcss.net/cef_symbols/)

# php - 如何在静态类的包含文件中获取变量

> ID：12554045
> 
> 赞同：2
> 
> 时间：2012-09-23T16:29:43.830
> 
> 标签：php, variables, get, include

我在文件中获取变量时遇到问题，该变量是通过静态类方法包含的。

一个.php：

```
require_once("classes/tools.class.php");

$variable = "variable";

Tools::setView("test"); 
```

工具类.php：

```
class Tools{    

    public static function setView($viewName){
        if(!is_file("views/" . $viewName . ".php")){
            echo "Chyba pri nacitani view: \"$viewName\" v " . $_SERVER["SCRIPT_NAME"];
            die();
        }
        else{           
            include "views/" . $viewName . ".php";
        }

    }

} 
```

查看/test.php：

```
echo $variable; 
```

在“回声”之后，我得到了“未定义的变量”错误。

有人可以帮我解决这个问题吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T16:39:06.990

您需要了解其[`variable scope`](http://php.net/manual/en/language.variables.scope.php)工作原理。在这种情况下，您的变量无法在视图脚本中看到，因为视图脚本正在函数内部执行，并且该函数无权访问全局范围内的变量。您可以在函数内将变量声明为全局变量，但不建议这样做——当您不提前知道要设置哪些变量时，这是不切实际的。

理想情况下，您需要将视图脚本将使用的变量注入到设置视图的调用中。也许是这样的：

```
public static function setView($viewName, $vars) {

    // loop through the passed vars and set them in the local scope
    extract($vars);

    // render the view
    include "views/" . $viewName . ".php";
} 
```

然后，在调用 setView 时传递变量：

```
$vars = array(
    'one' => 1,
    'two' => 2
);
Tools::setView('test', $vars); 
```

这将在函数范围内创建名为`$one`and的变量`$two`，然后可以在您的视图脚本中正常使用这些变量。此外，它使视图免受程序中可能碰巧存在的其他附带变量的“毒害”。即，只有显式传递给方法调用的变量才能在视图脚本中使用。

# android - 安卓上的Flash游戏

> ID：12554046
> 
> 赞同：0
> 
> 时间：2012-09-23T16:29:59.197
> 
> 标签：android, flash

我正在考虑开发一款游戏。我想知道如果我将它写在闪存中是否安全，或者任何人都能够在闪存中解码我的代码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T16:42:43.250

有很多混淆工具可以防止反编译器。我认为混淆不会阻止代码被反编译。它只会使反编译变得更加困难。对于闪存，请查看

金[迪](http://www.kindi.com/)

[做SWF](http://www.doswf.com/)

# regex - 使用 Text::Balanced 创建优化模式以使用 Text::Markdown 进行格式化

> ID：12554052
> 
> 赞同：0
> 
> 时间：2012-09-23T16:30:52.443
> 
> 标签：regex, perl, perl-module

我可以在 csv 文件上运行以下命令，以便从文件中获取分隔文本。

```
#!/usr/bin/perl
use strict;
use warnings;
use Text::Balanced q/extract_delimited/;

my $filecontents = do { local $/; <> };

while (my $item = extract_delimited($filecontents, '"')) {
    print "Item: $item\n";
} 
```

但结果总是包含我不想要的引号所以我尝试了以下方法来完全隔离多行记录

```
#!/usr/bin/perl
use strict;
use warnings;
use Text::Balanced qw/gen_delimited_pat/;

my $filecontents = do { local $/; <> };
$patstring = gen_delimited_patq(\G(?:[^"]|""|""")* ]))

while (my $item = extract_delimited($filecontents, '"')) {
    print "Item: $item\n";
} 
```

因为我知道这个正则表达式

```
\G(?:[^"]|""|""")* 
```

找到我想用 Text::Markdown 处理的完整多行记录，但是我收到错误

*   使用？模式？在第 10 行不推荐使用无显式运算符。
*   全局符号“$patstring”在第 10 行需要明确的包名。
*   搜索模式未在第 10 行终止。

我试图只获取看起来像这样的分隔文本进行记录，不包括开头和结尾的引号我希望这是有道理的：

“描述”“Star-Lite 2-Person w/Fly Aluminum, Rust

规格：

*   包装尺寸：13"" X 5""
*   1 门
*   室内面积：41.25 平方英尺
*   峰高：44""
*   地板材质：190T涤纶，2000mm PU涂层
*   网格：没看到-嗯
*   极数：2 根 8.5 毫米的防震铝线。
*   极部分：12"" 长度。
*   包括雨蝇。
*   90"" X 66"" X 44"""

排除我只想要的第一行

Star-Lite 2 人带飞铝，生锈

规格：

*   包装尺寸：13"" X 5""
*   1 门
*   室内面积：41.25 平方英尺
*   峰高：44""
*   地板材质：190T涤纶，2000mm PU涂层
*   网格：没看到-嗯
*   极数：2 根 8.5 毫米的防震铝线。
*   极部分：12"" 长度。
*   包括雨蝇。
*   90"" X 66"" X 44""

我需要做什么来修复这个模块的模式？

编辑：粘贴了错误的脚本

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T19:33:46.210

A bit inelegant, but this will do what I think you want to do:

```
#!/usr/bin/perl
use strict;
use warnings;
use Text::Balanced qw/extract_delimited extract_multiple/;

my $filecontents = do { local $/; <> };

#replace newlines with pipes
$filecontents=~s/\n/\|/g;
$filecontents=~s/""/inches/g;
#grab all your delimited substrings into an array
my @extracted = extract_multiple($filecontents,
                            [ sub {extract_delimited ($_[0],q{"})}],
                            undef, 1);

foreach my $fragment(@extracted){
    #remove "
    $fragment=~s/"//g;
    $fragment=~s/inches/""/g;
    $fragment=~s/\|/\n/g;
    print "$fragment\n";  
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T18:35:06.497

```
Global symbol "$patstring" requires explicit package name at line 10. 
```

您对变量有[严格](http://perldoc.perl.org/strict.html)要求并忘记声明`$patstring`变量。

```
Use of ?PATTERN? without explicit operator is deprecated at line 10 
```

[gen_delimited_pa​​t](https://metacpan.org/module/Text%3a%3aBalanced#gen_delimited_pat)接受一个字符串。你已经通过了它......好吧，你已经通过了它一个语法错误。我想它应该是一个正则表达式？Perl 绝望地试图将其解析为[?PATTERN?](http://perldoc.perl.org/perlop.html#Regexp-Quote-Like-Operators) 使用单个问号然后放弃。

你给出的例子都不应该奏效。两者都包含上述相同的错误。没有调用 Text::Balanced 函数`gen_delimited_patq`（它是`gen_delimited_pat`），也没有从 Text::Balanced 导出正确的函数，并且`$patstring`从未使用过。

# c# - WinRT XAML 数据绑定包含 List 的对象列表

> ID：12554062
> 
> 赞同：2
> 
> 时间：2012-09-23T16:31:59.227
> 
> 标签：xaml, c#, xaml, data-binding, windows-8, windows-runtime

我有一个`List`包含另一个的对象`List`。我想将两个`List`s 绑定到不同的控件（一个嵌套在另一个控件中 - a `ListView`as `GridViewItem`）。但我无法让[xaml](/questions/tagged/xaml "显示标记为“xaml”的问题")工作。

非常接近这个问题的是[Binding List of Lists in XAML?](https://stackoverflow.com/questions/8188025/binding-list-of-lists-in-xaml) .
在 MSDN 文档中有一篇关于此的文章：
[如何绑定到分层数据并创建主/详细信息视图](http://msdn.microsoft.com/en-us/library/windows/apps/xaml/hh758322.aspx)- 可能是解决方案，但我发现很难将其应用到我的代码中。
其他文章涉及这个主题，但不是那么好，而且作为一个新用户，我不允许在一个问题中包含两个以上的超链接。

我的代码看起来与此类似（为清楚起见，更改为城市/餐厅场景）：

**模型：**

```
public class City
{
    string Name { get; set; }
    List<Restaurant> RestaurantList { get; set; }
    //.. also a constructor with parameters for the properties and an overriding toString method that returns Name
}
public class Restaurant
{
    string Name { get; set; }
    List<Uri> UriList { get; set; }
    //.. also a constructor with parameters for the properties and an overriding toString method that returns Name
} 
```

**代码隐藏（LoadState 方法）：**

```
 //.. getting a List of cities (with restaurants), that is being created in some model class
    this.DefaultViewModel["Items"] = Cities; 
```

有些人设置了`DataContext`。我从 MSDN 教程中得到了这个，它到目前为止工作。但我不确定哪个“更好”。

**好的，现在 XAML：**

我想`GridView`与城市作为`GridViewItem`s。在其中`GridViewItem`有一个，在顶行`Grid`显示`City`' ，在下面显示一个。包含s （仅那个！）。s 只显示' s 。我只希望s 可以点击。`Name``ListView``ListView``Restaurant``City``ListViewItem``TextBlocks``Restaurant``Name``Restaurant`

像这样：
![http://imageshack.us/a/img687/5576/listviewasgridviewitem.png](../Images/f6eedf0f25f3b06845c662bb52b6f658.png)

```
<!-- the following line is at the very top and the reason why it should work without setting DataContext explicitly -->
DataContext="{Binding DefaultViewModel, RelativeSource={RelativeSource Self}}"
<!-- ... -->
<GridView Grid.Row="1" ItemsSource="{Binding Items}" SelectionMode="None">
    <GridView.ItemTemplate>
        <DataTemplate>
            <Grid Height="500" Width="200" Margin="50" Background="Gray">
                <Grid.RowDefinitions>
                    <RowDefinition/>
                    <RowDefinition Height="5*"/>
                </Grid.RowDefinitions>
                <TextBlock TextWrapping="Wrap" Text="{Binding Name}"/>
                <ListView
                    Grid.Row="1"
                    ItemsSource="{Binding RestaurantList}" IsItemClickEnabled="True">
                    <ListView.ItemTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding Name}" Tapped="Restaurant_Click"/>
                        </DataTemplate>
                    </ListView.ItemTemplate>
                </ListView>
            </Grid>
        </DataTemplate>
    </GridView.ItemTemplate>
</GridView> 
```

这种方式只显示灰色框。当将`TextBlock`' 绑定更改`Text="{Binding}"`为时，至少`Name`会显示 Cities 的 s。我不明白也不想要，因为我猜这些`toString`方法的覆盖并不意味着以这种方式使用。`Name`s 中的s`Restaurant`在这两种情况下都不会出现。

此外，滚动在这个视图中以某种方式中断，但我想这是一个不同的故事。

**那么：XAML 中的数据绑定有什么问题？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T19:03:14.040

数据绑定引擎需要[公共属性](http://msdn.microsoft.com/en-us/library/ms743643.aspx)（链接是关于 WPF 但相同的概念适用于 WinRT）：

> 您可以绑定到任何公共语言运行时 (CLR) 对象的公共属性、子属性以及索引器。

但是，如果您没有明确指定它，则编译器默认处理成员[“您可以为该成员声明的最受限制的访问”，](https://stackoverflow.com/questions/2521459/what-are-the-default-access-modifiers-in-c)例如`private`在您的情况下。

因此，您需要将您的属性声明为`public`：

```
public class City
{
    public string Name { get; set; }
    public List<Restaurant> RestaurantList { get; set; }
}

public class Restaurant
{
    public string Name { get; set; }
    public List<Uri> UriList { get; set; }
} 
```

# ruby-on-rails - linkedin 人们使用 Ruby on rails 搜索 api 使用情况

> ID：12554067
> 
> 赞同：0
> 
> 时间：2012-09-23T16:33:05.087
> 
> 标签：ruby-on-rails, ruby, linkedin

我尝试使用以下代码在 LinkedIn 中使用 ruby​​ on rails 执行人员搜索：

```
client.search(
  :fields => [{ :people => %w(id first-name last-name api-standard-profile-request)}],
  :first-name =>  params["first_name"]
) 
```

执行时会出现以下错误：

`undefined local variable or method 'name' for #<JobsController:0x00000004888d68>`

问题是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T17:46:14.283

问题与这条线有关。

```
:first-name => params["first_name"] 
```

在 Ruby 中，如果符号被引号包围，则只能在符号中使用减号。因此，我们不必将符号写为`:first-name`，而是将其写为`:'first-name'`。所以我们的新代码将是......

```
client.search(
  :fields => [{ :people => %w(id first-name last-name api-standard-profile-request)}],
  :'first-name' =>  params["first_name"]
) 
```

# python - 常数和糖

> ID：12554069
> 
> 赞同：5
> 
> 时间：2012-09-23T16:33:18.833
> 
> 标签：python, constants, decorator, syntactic-sugar

我有一组我经常使用的函数，所以我想将它们收集到一个库中。在开始编写库之前，我在考虑将影响某些函数行为的常量存储在哪里。

使用该库时我想写的内容如下：

```
import tools
tools.collect(object_a, object_b, mode=tools.collect.RECURSIVE) 
```

一般来说，函数应该能够接受的常量应该存储在函数本身中。

为了实现这一点，我创建了一个装饰器函数，将传递的属性分配给装饰函数。

```
def attr_decorator(**attrs):
    def decorator(f):
        for k, v in attrs.iteritems():
            setattr(f, k, v)
        return f
    return decorator 
```

这个装饰器可以这样使用：

```
@attr_decorator(
    FLAT = 1 << 0,
    RECURSIVE 1 << 1,
)
def collect(a, b, mode):
    # ... 
```

到目前为止，这工作得很好。

## 但是默认参数呢？

```
@attr_decorator(
    FLAT = 1 << 0,
    RECURSIVE 1 << 1,
)
def collect(a, b, mode=collect.RECURSIVE):
    # ... 
```

这不起作用，因为在存储*模式*参数的默认值时未定义*collect函数（因此甚至没有修饰）。*

 *## 这看起来不太好

我能想出的唯一解决方案导致语法很尴尬，而且看起来不太好。我赋予装饰器功能与将要装饰的功能相同的属性。

```
def attr_decorator(**attrs):
    def decorator(f):
        for k, v in attrs.iteritems():
            setattr(f, k, v)
        return f

    for k, v in attrs.iteritems():
        setattr(decorator, k, v)

    return decorator 
```

不需要天才就可以认识到这并不好阅读：

```
collect_d = attr_decorator(
    FLAT = 1 << 0,
    RECURSIVE = 1 << 1,
)
@collect_d
def collect(root, callback, mode=collect_d.RECURSIVE):
    # ... 
```

## 问题：

你能想出更好的方法吗？我真的很想坚持“一个声明来装饰”的事情。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T16:53:45.270

您可以使用特殊变量作为对正在定义的函数的引用。

```
class Attr(object):
    def __init__(self, name): self.name = name

class Attributor(object):
    def __getattr__(self, x): return Attr(x)

_ = Attributor()

def attr_decorator(**attrs):
    def decorator(f):
        for k, v in attrs.iteritems():
            setattr(f, k, v)
        f.func_defaults = tuple(attrs[t.name] if isinstance(t, Attr) else t for t in f.func_defaults)
        return f
    return decorator    

@attr_decorator(
    FLAT = 1 << 0,
    RECURSIVE = 1 << 1,
)
def collect(a, b, mode=_.RECURSIVE, foo=123):
    print a, b, mode, foo

collect(100,200) # 100 200 2 123 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T17:10:11.467

> 一般来说，函数应该能够接受的常量应该存储在函数本身中。

我不同意这种说法。这些常量是函数*外部*接口的一部分，供调用者使用。将它们定义为 的一部分有什么问题`tools`？

```
COLLECT_RECURSIVE=0
COLLECT_NONRECURSIVE=1
COLLECT_OTHER=2

def collect(a,b,mode):
    pass 
```

呼叫者，召集者：

```
import tools
tools.collect(object_a, object_b, mode=tools.COLLECT_RECURSIVE) 
```*

# android - 销毁活动从 BroadcastReceiver 开始

> ID：12554072
> 
> 赞同：1
> 
> 时间：2012-09-23T16:33:52.940
> 
> 标签：android, android-intent, android-activity

我的活动从`BroadcastReceiver`

```
@Override
public void onReceive(Context context, Intent intent) {
    Intent i = new Intent(context, SipCallActivity.class);
    i.putExtra("destination_phone", phoneNumber);
    i.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK | Intent.FLAG_ACTIVITY_CLEAR_WHEN_TASK_RESET);
    context.startActivity(i);
} 
```

一段时间后，按下按钮完成活动：

```
Button endCall = (Button) findViewById(R.id.call_btn_terminate_call);
endCall.setOnClickListener(new OnClickListener() {

        @Override
        public void onClick(View v) {
            endCall(); //SIP related stuff
            finish();
        }
    }); 
```

一切都很好，花花公子。但是，当我试图通过按下应用程序列表中的图标或通过主页按钮从最近的应用程序列表中打开另一个活动时，我总是会得到刚刚关闭的活动 - `SipCallActivity`。这是为什么？

我想关闭该活动，除非从我的`BroadcastReceiver`. 我怎么能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T16:41:37.317

将标志添加[`FLAG_ACTIVITY_EXCLUDE_FROM_RECENTS`](http://developer.android.com/reference/android/content/Intent.html#FLAG_ACTIVITY_EXCLUDE_FROM_RECENTS)到您的启动意图中，或在清单中使用以下内容从最近的应用程序中排除应用程序：

`<activity android:name="<your-activity"`[`android:excludeFromRecents="true"`](http://developer.android.com/guide/topics/manifest/activity-element.html#exclude)`...`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-23T16:57:41.870

## 您需要在调用 mainactivity 的意图中添加标志

```
i.addFlags(intent.FLAG_ACTIVITY_EXCLUDE_FROM_RECENTS| Intent.FLAG_ACTIVITY_CLEAR_WHEN_TASK_RESET |Intent.FLAG_ACTIVITY_NEW_TASK); 
```

## 或者

在您的 Mainfest 文件中::

```
<activity android:name=".SipCallActivity" android:excludeFromRecents="true"> 
```

# android - 有什么方法可以为您的应用添加 Android 通知声音吗？

> ID：12554078
> 
> 赞同：2
> 
> 时间：2012-09-23T16:34:19.300
> 
> 标签：android, notifications, ringtone

我希望能够让用户从我与我的应用程序捆绑的长通知声音中进行选择（而不是默认可用的短通知声音）。我总是可以将通知声音安装为全球可用，但我希望我安装的那些新声音仅可用于我的应用程序，因此我不会弄乱我的用户所有应用程序的通知声音列表

# php - 在 Wordpress 上调整图像大小和填充背景

> ID：12554080
> 
> 赞同：2
> 
> 时间：2012-09-23T16:34:45.790
> 
> 标签：php, wordpress, image-resizing

我有各种尺寸的图像。我也有各种容器来放置这些图像。

示例：我有 680 x 1024 图像，将放置在 500x500 容器上而不进行裁剪。

所以我认为我需要构建具有容器大小的图像，而不是将调整大小的图像放在它上面。

我期望的结果是这样的 ![http://farm9.staticflickr.com/8033/8016052351_bf726f5e43_z.jpg](../Images/da8f318546427968f8be8ba0392bb1d3.png)

或这个

![http://farm9.staticflickr.com/8459/8016053956_8616f8b1f8_z.jpg](../Images/08afe50444969c8df5ae10c27859faf1.png)

如何在 PHP 或 wordpress 上实现这一目标的最佳方式？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-29T00:48:53.567

我写了一个插件，目前在 WordPress 插件库：

> # [JResizr](http://wordpress.org/extend/plugins/jresizr/)
> 
> 这个插件有能力覆盖默认的 worpdress 行为并禁用裁剪图像，但尝试调整图像大小以适应矩形容器大小并用背景颜色填充空间。您还可以选择要使用的背景颜色。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-17T02:34:16.283

有几种方法可以做到这一点。javascript/php 的一种替代方法，如果图像大小大致合适，则只需使用 CSS，特别是[`background-size: contain`](https://developer.mozilla.org/en-US/docs/Web/CSS/background-size)

> **包含**
> 
> 该关键字指定背景图像在确保其尺寸小于或等于背景定位区域的对应尺寸的同时，应尽可能地进行缩放。

您可以在[http://jsfiddle.net/RxTLS/上进行试验](http://jsfiddle.net/RxTLS/)

请记住，尽管 IE8 及以下版本不支持，但大多数情况下都支持这一点。如果您担心 IE 用户，我相信我们那里有一些 polyfill。

仅当您上传的图像接近它们将显示的大小时，此解决方案才是理想的。出于几个不同的原因，不建议尝试对超过 3000 像素宽/高的图像执行此操作。

在这种情况下，您需要先在 PHP 中缩小它们。如果您通过 Wordpress 上传图片，那么您可以在您的图片中使用[`add_image_size`](http://codex.wordpress.org/Function_Reference/add_image_size)，`functions.php`并且在您上传图片时，图片会自动调整大小。或者，您也可以在 PHP 中手动完成，并且有很多关于如何做到这一点的教程。我只是谷歌`PHP image resize`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-08-14T14:01:11.327

在您有`<img>`标签的 html 中，添加一个`width`属性，并将其设置为`100%`应该自动将您的图像调整为其容器大小

```
<img src="imageNamw.jpg" alt="imageAlt" width="100%" /> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-07-11T13:48:25.387

您可以编写一个简单的 Js 文件来完成此操作。

我以前做过这样的事情；所以基本上你比较它容器中图像的高度和宽度。然后如果高度大于宽度，则将高度设置为 500px 并将宽度设置为自动；

否则，如果宽度大于高度，则将宽度设置为 500 像素，将高度设置为自动；

否则，您将宽度和高度设置为 500px；

在css中将容器垂直对齐设置为中间并将文本对齐设置为居中，这应该可以解决问题；

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-07-12T10:26:25.447

您还可以尝试使用简单的 timthumb 库来调整任意大小的图像。

请在此处查看 timthumb 库代码：

[http://timthumb.googlecode.com/svn/trunk/timthumb.php](http://timthumb.googlecode.com/svn/trunk/timthumb.php)

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-09-24T18:41:41.763

在 WordPress 中，只需使用他们的 image_resize 函数

```
image_resize( $file, $max_w, $max_h, $crop, $suffix, $dest_path, $jpeg_quality ); 
```

您将在其中设置文件、容器的宽度、容器的高度和 false（因为您要调整大小，而不是裁剪）。其他是可选的，如果您对新文件目标或名称或质量有特殊需求，则应填写它们。如果您正确输入了所有内容，该函数应返回新调整大小图像的路径。

请注意，使用 WordPress，您实际上可以在上传图片时自动执行此操作，因此稍后您只需检索已经调整大小的图片 - 看看[add_image_size](http://codex.wordpress.org/Function_Reference/add_image_size)函数。

# android - SingleClientConnManager 的无效使用在 Android 2.2,2.3 中发生，但在 4.1 中没有

> ID：12554081
> 
> 赞同：0
> 
> 时间：2012-09-23T16:35:04.373
> 
> 标签：android, httpclient

我已经在 Google 上搜索了这个特定的例外情况，并且出现了多个结果，但我还没有看到我所遇到问题的答案。我目前正在以下列方式访问某个服务器上的 API：

```
// Setup...
HttpClient httpClient = new DefaultHttpClient();
HttpPost httpPost = new HttpPost(url);
List<NameValuePair> nameValuePair = new ArrayList<NameValuePair>();

nameValuePair.add(new BasicNameValuePair("key","value"));
httpPost.setEntity(new UrlEncodedFormEntity(nameValuePair));
HttpResponse response = httpClient.execute(httpPost);
String results = EntityUtils.toString(response.getEntity()) 
```

当然，上面的代码与我使用的代码不完全相同。任何 UI 阻塞任务都使用 AsyncTask 在单独的线程上完成。

当这段代码第一次执行时，一切都很好。然后我们再次执行代码，出现如下异常，但只在Android 2.2和2.3（我没有在3.0或4.0上测试过）：

```
Invalid use of SingleClientConnManager: connection still allocated 
```

现在，可以在此处找到此问题的最佳答案之一：[Exception using HttpRequest.execute(): Invalid use of SingleClientConnManager: connection still assigned](https://stackoverflow.com/questions/4612573/exception-using-httprequest-execute-invalid-use-of-singleclientconnmanager-c)，我没有尝试过，但在此之前，我想知道为什么这个异常不是当我在 Android 4.1 上运行它时被抛出？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T18:35:59.567

`AsyncTask`在 Android 3.2上改变的行为：如果你`targetSdkVersion`是 13 或更高，你`AsyncTasks`将默认共享一个*后台*线程，并且一次只运行一个任务。否则，您`AsyncTasks`将使用线程池并且可以并行运行。由于`HttpClient`默认情况下不是线程安全的，这就是您遇到行为差异的原因。

如果要`HttpClient`跨多个线程使用，请使用`ThreadSafeClientConnManager`.

For more on the `AsyncTask` behavior change: [http://commonsware.com/blog/2012/04/20/asynctask-threading-regression-confirmed.html](http://commonsware.com/blog/2012/04/20/asynctask-threading-regression-confirmed.html)

# ios - 自 XCode 4.5 以来的 int 格式

> ID：12554084
> 
> 赞同：-4
> 
> 时间：2012-09-23T16:35:20.417
> 
> 标签：ios, xcode, string-formatting, lldb

自从升级到 XCode 4.5 后，打印`ints`到控制台会导致异常高的值。例如：

```
int someInt = 300;
NSLog([NSString stringWithFormat:@"Some int: %d", someInt]); // prints Some int: 11581443 
```

通常我只在为数据类型使用错误的格式字符串时才会看到这一点。我正在使用 LLDB。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-23T17:25:04.353

你用错了`NSLog`。

```
void NSLog (
   NSString *format,
   ...
); 
```

前任：

```
int someInt = 100;
NSString* str = [NSString stringWithFormat:@"%d",someInt];
NSLog(@"%@",str); 
```

或者

```
NSLog(@"%d", someInt) 
```

或者

```
NSLog(@"%@", [NSString stringWithFormat:@"%d",someInt]) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-23T16:46:56.027

尝试`NSLog(@"Integer: %i", int)`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-23T17:59:35.207

@askovpen 关于您对 的错误使用是正确的`NSLog`，但是您问题中的这一行很有趣：

> 对数据类型使用错误的格式字符串

你当然会把垃圾拿出来——你把垃圾放进去！

`NSLog`通过使用第一个参数来计算其他参数的大小。即，如果你把`%c`它期望在参数中的下一个字符。如果你把`%d`它期望一个int。因此，如果您传入一个 int 并告诉它期待一个浮点数，那么是的，它不会起作用。你为什么会期望它会？

您可能在 XCode 4.5 而不是其他 XCode 中获得不同值的原因可能是由于编译期间内存管理的变化，或者可能是由于许多其他原因。

# python - IPython %logstart 使用 pydev 的输出进行日志记录

> ID：12554085
> 
> 赞同：1
> 
> 时间：2012-09-23T16:35:21.067
> 
> 标签：python, logging, pydev, ipython

我将 PyDev 与 IPython 控制台一起使用，并希望与输出一起自动登录我的会话。

```
from datetime import datetime
curD = str(datetime.today())
currentDate = curD[8:10] + curD[5:7] + curD[2:4] + curD[11:13] + curD[14:16]
logFileName = '~/logs/log_' + currentDate + '.py' 
```

在 Ctrl+Alt+Enter 之后，我需要`%logstart`从我的`logFileName`. 虽然还不错（1）我想在我的文件中记录控制台的输出。我尝试使用

```
logstart -o
WARNING: Couldn't start log: Log file is already active: ~/logs/log_2309121715.py 
```

当我键入`__IP.logger.log_output = True`时，它不会改变日志记录行为。

(2) 我也想自动执行此操作，因此每当我运行 PyDev 时，它都会默认打开 IPython 并记录到文件中。是否可以编写代码来调用我的脚本来执行它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-18T17:58:19.187

不确定它是否会做你想做的事，但你可以配置 PyDev 在创建 shell 时发送的初始命令：

窗口 > 首选项 > pydev > 交互式控制台 > 初始解释器命令。

# jquery - jQuery选择所有链接但排除iframe内的链接

> ID：12554089
> 
> 赞同：0
> 
> 时间：2012-09-23T16:35:48.257
> 
> 标签：jquery

假设我在正文中有很多链接，在 iframe 中有很多链接，例如：

```
<div>
<a herf=xxxxxxx>...</a>
<a herf=xxxxxxx>...</a>
<a herf=xxxxxxx>...</a>
...
<a herf=xxxxxxx>...</a>
</div>
<iframe src=xxx>
<html>
<head>...</head>
<body>
<a herf=xxxxxxx>...</a>
<a herf=xxxxxxx>...</a>
<a herf=xxxxxxx>...</a>
...
<a herf=xxxxxxx>...</a>
</body>
</html>
</iframe> 
```

jQuery 如何选择所有链接但排除 iframe 内的链接？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T16:49:03.510

我不确定是否`$('a')`也从 iframe 中选择链接，我认为它仅从当前文档中选择。

您可以`class="acls"`在每个`<a>`要选择的地方添加一个，然后在 jQuery 中使用：`$('a.acls')`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T16:56:45.267

如果您只需要从 div 而不是 iframe 获取链接，您可以使用：

```
var links = $("div a"); 
```

如果您想从链接中解析 URL，请尝试以下操作：

```
var urls = [];
$("div a").each(function() { 
    urls.push($(this).attr('href'));

}); 
```

我希望它会有所帮助

# delphi - 使用键盘通过按钮单击添加字符时如何让光标移到字符串的末尾

> ID：12554094
> 
> 赞同：4
> 
> 时间：2012-09-23T16:37:12.423
> 
> 标签：delphi, delphi-xe2

我正在构建一个功能类似于触摸屏上的键盘的表单。我目前遇到的问题是，当我按下一个按钮（例如“1”按钮）时，它必须将该字符“1”添加到一个编辑框中，该框显示已按下的键。现在我遇到的问题是，一旦有人按下一个键，我可以将char添加到编辑框中已经显示的字符串中，但是光标走到了编辑框的前面，并没有出现在后面。我使用以下代码向编辑框添加一个字符：

```
edtPassword.text := edtPassword.text + key; 
```

现在只是将字符添加到编辑框的末尾，但是如何将光标移动到编辑框的末尾。

另外，我还有一个退格按钮，如果单击它，我将使用什么代码擦除编辑框中字符串的最后一个字符？

我正在使用德尔福 XE2

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-24T13:23:20.287

***免责声明：***

我没有按原样回答这个问题。当我需要一个虚拟键盘时，我试图提出一种我宁愿遵循的方法。

***1.现成的组件呢？***

我建议您使用该[`TTouchKeyboard`](http://docwiki.embarcadero.com/Libraries/en/Vcl.Touch.Keyboard.TTouchKeyboard)组件，它是一个 VCL 组件，代表一个虚拟键盘。也就是说，您正在开发一些东西，这已经是 Delphi 发行版的一部分。自 2010 版以来，它是 Delphi 的一部分，但我不能说在哪个发行版中。

***2.它看起来很丑，我宁愿自己做：***

当我[`TTouchKeyboard`](http://docwiki.embarcadero.com/Libraries/en/Vcl.Touch.Keyboard.TTouchKeyboard)第一次看到组件时，我希望它允许所有者绘图。好吧，不幸的是没有。在这种情况下，我会尝试自己模拟击键，而不是为您可能很快或以后使用的其他组件解决这样的情况。

***2.1。如何以自己的方式模拟击键？***

以下代码使用该[`SendInput`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms646310%28v=vs.85%29.aspx)函数模拟击键，它基于[`TTouchKeyboard`](http://docwiki.embarcadero.com/Libraries/en/Vcl.Touch.Keyboard.TTouchKeyboard)组件使用的代码：

```
type
  TKeyState = (ksDown, ksUp);

function SendInputKey(AVirtualKey: Integer; AScanCode: Integer;
  AKeyState: TKeyState): Boolean;
var
  Input: TInput;
begin
  Input.Itype := INPUT_KEYBOARD;
  if (AVirtualKey = -1) and (AScanCode >= 0) then
  begin
    Input.ki.wVk := MapVirtualKey(AScanCode, MAPVK_VSC_TO_VK);
    Input.ki.wScan := AScanCode;
  end
  else if (AVirtualKey >= 0) and (AScanCode = -1) then
  begin
    Input.ki.wVk := AVirtualKey;
    Input.ki.wScan := MapVirtualKey(AVirtualKey, MAPVK_VK_TO_VSC);
  end
  else if (AVirtualKey >= 0) and (AScanCode >= 0) then
  begin
    Input.ki.wVk := AVirtualKey;
    Input.ki.wScan := AScanCode;
  end;
  case AKeyState of
    ksDown: Input.ki.dwFlags := 0;
    ksUp: Input.ki.dwFlags := KEYEVENTF_KEYUP;
  end;
  Result := SendInput(1, Input, SizeOf(TInput)) = 1;
end; 
```

以及上述函数的用法。您可以将虚拟键、扫描码或两者都传递给此函数。当您不确定它们中的任何一个时，传递值 -1 并且键码将由该[`MapVirtualKey`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms646306%28v=vs.85%29.aspx)函数额外映射。以下示例显示如何发送 a`Backspace`和 then `Shift + A`：

```
procedure TForm1.SpeedButton1Click(Sender: TObject);
begin
  SendInputKey(VK_BACK, -1, ksDown);
  SendInputKey(VK_BACK, -1, ksUp);
  SendInputKey(VK_SHIFT, -1, ksDown);
  SendInputKey(Ord('A'), -1, ksDown);
  SendInputKey(Ord('A'), -1, ksUp);
  SendInputKey(VK_SHIFT, -1, ksUp);
end; 
```

***2.2\. 如何以禁止的方式模拟击键？***

您也可以违背参考并使用[`SendKey`](http://docwiki.embarcadero.com/Libraries/en/Vcl.Touch.Keyboard.SendKey)from[`Vcl.Touch.Keyboard`](http://docwiki.embarcadero.com/Libraries/en/Vcl.Touch.Keyboard)单位。在参考文献中指出，它在[`SendKey`](http://docwiki.embarcadero.com/Libraries/en/Vcl.Touch.Keyboard.SendKey)内部使用，不应该被调用，但它在单元外部可见，如果你足够大胆，你可以像这样使用它：

```
uses
  Vcl.Touch.Keyboard, Vcl.Touch.KeyboardTypes;

procedure TForm1.SpeedButton1Click(Sender: TObject);
var
  KeyData: TKeyData;
begin
  KeyData := VKey(VK_BACK, -1);
  SendKey(KeyData, ksDown);
  SendKey(KeyData, ksUp);
  KeyData := VKey(VK_SHIFT, -1);
  SendKey(KeyData, ksDown);
  KeyData := VKey(Ord('A'), -1);
  SendKey(KeyData, ksDown);
  SendKey(KeyData, ksUp);
  KeyData := VKey(VK_SHIFT, -1);
  SendKey(KeyData, ksUp);
end; 
```

***2.3\. 如何在不同的视图中模拟击键？***

*   [`How to send text to another application ?`](https://stackoverflow.com/q/7454417/960757)
*   [`How to send keys to another application ?`](https://stackoverflow.com/q/9673442/960757)
*   [`How to send keys without using SendMessage and PostMessage ?`](https://stackoverflow.com/q/10106725/960757)
*   [`How to programmatically simulate user input ?`](https://stackoverflow.com/q/7723104/960757)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-23T17:24:23.833

你可以试试：

```
edtPassword.Text := edtPassword.Text + key;
edtPassword.SelStart := Length(edtPassword.Text);
edtPassword.SelLenght := 0; 
```

您也可以将消息发布到编辑窗口句柄，如下所示：

```
PostMessage(edtPassword.Handle, WM_KEYDOWN, VK_END, 0);
PostMessage(edtPassword.Handle, WM_KEYUP, VK_END, 0);
PostMessage(edtPassword.Handle, WM_CHAR, StrToInt(key), 0); 
```

至于退格，由于您的光标是虚拟的，您可以通过删除文本中的最后一个符号来模拟删除。

如果您的小键盘计划在某个时候包含箭头键，您将需要计算光标的当前位置并删除符号，而不是在文本末尾，而是在与光标值（偏移量）相对应的任意位置。

# ios - IOS NSData构造函数VS NSMutableData实时使用目的

> ID：12554097
> 
> 赞同：2
> 
> 时间：2012-09-23T16:37:24.170
> 
> 标签：ios, nsdata, nsmutabledata

我有 void* 缓冲区...我需要尽快将其封装在 NSData 结构（NSData 或 NSMutableData）中

我猜只使用一个 NSMutableData （在类中定义）

```
- (void)resetBytesInRange:(NSRange)range
- (void)appendBytes:(const void *)bytes length:(NSUInteger)length 
```

甚至

```
- (void)replaceBytesInRange:(NSRange)range withBytes:(const void *)bytes 
```

将比使用 [NSData dataWithData:] 每个函数调用要快得多...

这是用于音频处理的，所以它需要是最快的。

有谁可以确认我会更快地使用 NSMutableData 而不是 NSData 构造函数？

编辑 ：

缓冲区总是相同的大小，NSMutableData 不需要重新分配内存......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T19:17:34.810

如果您只想用相同长度的`NSMutableData *data`新数据替换（已经初始化的）对象的内容`buffer`，那么最快的方法可能是

```
void *mutableBytes = [data mutableBytes];
memcpy(mutableBytes, buffer, length); 
```

因为没有进行范围检查，也没有进行（重新）分配。另请参阅[使用可变二进制数据](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/BinaryData/Tasks/WorkingMutableData.html)中的示例。

当然，正如论坛中经常说的那样，您应该使用 Instruments 分析您的应用程序，以找出优化程序的位置。

# html - CSS - 大于选择器 - 选择大于 N 的项目

> ID：12554098
> 
> 赞同：8
> 
> 时间：2012-09-23T16:37:54.483
> 
> 标签：html, css, css-selectors

我的 HTML 正文中有几个`<p>`元素。我只想显示前两段，然后设置`display:none`为所有段落。为什么下面的代码不起作用？

```
<html>

<head>
    <style type="text/css">
        p:gt(2) { display:none; }
    </style>
</head>
<body>
    <p>1</p>
    <p>2</p>
    <p>3</p>
    <p>4</p>
</body> 

</html> 
```

我的代码仍然在 Chrome 网络浏览器中显示所有 4 个段落元素。

如何更正我的代码以实现我最初陈述的目标？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-09-23T16:41:40.667

如果他们是兄弟姐妹，那么具有向后兼容性的最简单方法是：

```
p + p ~ p {
    display: none;
} 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/NBurh/)。

您还可以使用：

```
p:nth-of-type(2) ~ p {
    display: none;
} 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/NBurh/1/)。

参考：

*   [CSS 选择器](http://www.w3.org/TR/css3-selectors/#selectors)。
*   [CSS`:nth-of-type()`伪类](http://www.w3.org/TR/css3-selectors/#nth-of-type-pseudo).
*   [相邻兄弟 ( `+`) 组合](http://www.w3.org/TR/css3-selectors/#adjacent-sibling-combinators)子。
*   [通用兄弟 ( `~`) 组合](http://www.w3.org/TR/css3-selectors/#general-sibling-combinators)子。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-23T16:44:45.077

:gt 只是 jQuery 的简写，在 css 中选择它：

```
p:nth-of-type(n+3) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-23T16:41:58.307

您可以使用兄弟选择器：

```
p + p + p {display:none;} 
```

除了前两个，它选择了所有！

### jsFiddle：http: [//jsfiddle.net/KK3mk/](http://jsfiddle.net/KK3mk/)

# python - cvxopt CVXOPT glpk MILP 中的简单优化。无优化

> ID：12554100
> 
> 赞同：1
> 
> 时间：2012-09-23T16:37:55.547
> 
> 标签：python, linear-programming, convex-optimization

我正在使用 CVXOPT 来解决这个简单的优化问题：

```
maximize X1 + X2 
s.t:
 X2 + X6      = 2
 X1 + X2 + X5 = 2
 X1 + X4      = 2
 X1           >=0
 X2           >=0 
```

显然这有一个非常简单的解决方案

```
 X1 = 1 
 X2 = 1 
```

（其余均为0）

但是，cvxopt 完全错误。这就是我所做的：

```
>>> print A
  [ 0.00e+00  1.00e+00  0.00e+00  0.00e+00  0.00e+00  1.00e+00]
  [ 1.00e+00  1.00e+00  0.00e+00  0.00e+00  1.00e+00  0.00e+00]
  [ 1.00e+00  0.00e+00  0.00e+00  1.00e+00  0.00e+00  0.00e+00]

>>> print b
[ 2.00e+00]
[ 2.00e+00]
[ 2.00e+00]

>>> print G
[-1.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]
[ 0.00e+00 -1.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00]

>>> print h
 [ 0.00e+00]
 [ 0.00e+00]

>>> print c
[-1.00e+00]
[-1.00e+00]
[ 0.00e+00]
[ 0.00e+00]
[ 0.00e+00]
[ 0.00e+00] 
```

（以上都是“矩阵”类型的cvxopt）

> > > 打印 glpk.ilp(c,G,h,A,b,I=set([0,1,2,3,4,5]))[1]

```
GLPK Integer Optimizer, v4.43
5 rows, 6 columns, 9 non-zeros
6 integer variables, none of which are binary

Preprocessing...
3 rows, 5 columns, 7 non-zeros
5 integer variables, none of which are binary
Scaling...
 A: min|aij| =  1.000e+00  max|aij| =  1.000e+00  ratio =  1.000e+00
Problem data seem to be well scaled
Constructing initial basis...
Size of triangular part = 3
Solving LP relaxation...

GLPK Simplex Optimizer, v4.43

3 rows, 5 columns, 7 non-zeros
*     0: obj =   0.000000000e+00  infeas =  0.000e+00 (0)
PROBLEM HAS UNBOUNDED SOLUTION
None 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-05-24T01:08:54.677

以下是实现上述内容的代码：

```
import cvxopt.glpk
import cvxopt
c=cvxopt.matrix([1,1,0,0,0,0])
G=cvxopt.matrix([[1.0,0,0,0,0,0], [0,1,0,0,0,0]])
h=cvxopt.matrix([0.0,0.0])
A=cvxopt.matrix([[0.0,1,0,0,0,6], [1,1,0,0,1,0], [1,0,0,1,0,0]])
b=cvxopt.matrix([2.0, 2, 2])
(status, c)=cvxopt.glpk.ilp(-c,-(G.T),-h,A.T,b,I=set([0,1,2,3,4,5]))
print(status, c) 
```

结果是：

```
optimal [ 0.00e+00]
[ 2.00e+00]
[ 0.00e+00]
[ 2.00e+00]
[ 0.00e+00]
[ 0.00e+00] 
```

我不确定如何获得所有解决方案...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-03-25T08:56:50.320

根据您提供的 LP，GLPK 是正确的。

(0.5,0.5,1.5,1,1.5) 是可行的

极端射线是 (1,1,-1,-2,-1)。

# c# - 是否可以创建一个由其他属性组合而成的类属性？

> ID：12554101
> 
> 赞同：3
> 
> 时间：2012-09-23T16:38:00.453
> 
> 标签：c#

我想将几个字符串属性组合成一个字符串，以使排序和显示更容易。我想知道是否有一种方法可以做到这一点，而不必遍历类的集合或列表。下面的 Person 类中的 FullName 之类的东西。

```
public class Person
{
    public string Last {get;set;}
    public string First {get;set;}

    public string FullName = Last + ", " + First {get;}
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-23T16:41:07.157

像这样更新您的课程：

```
public class Person
{
    public string Last { get; set; }
    public string First { get; set; }

    public string FullName 
    { 
        get 
        { 
            return string.Format("{0}, {1}", First, Last); 
        } 
    }
} 
```

除了您的问题，我还建议实现该`ToString()`方法的覆盖（您的问题提到使显示更容易），因为大多数 UI 技术将使用它作为显示对象的默认方式。

```
public override string ToString()
{
    return FullName;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-23T16:41:05.390

```
public string FullName {
  get{
    return Last + ", " + First;
  }
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-23T16:41:06.963

当然：

```
public string FullName 
{
    get
    {
        return FirstName + ", " + LastName;
    }
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-09-23T16:41:10.857

为什么不？

```
public string FullName
{
    get { return Last + ", " + First; }
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-23T16:45:18.830

是的。你可以在你的类中使用一个属性来做同样的事情。甚至微软也建议在一个类中创建一个 void 方法，它只是将类的字段作为属性而不是方法进行简单的操作。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-09-23T16:41:55.727

尝试这个：

```
 public string FullName 
     {
          get
            {
                return Last + " " + First;    
            }        
      } 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-09-23T16:42:23.683

```
public string Fullname
{
    get
    {
        return string.Format("{0}, {1}", Last, First);
    }
    set
    {
        string[] temp = value.Split(',');
        Last = temp[0].Trim();
        First = temp[1].Trim();
    }
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-10-18T10:56:42.230

> 使用字符串插值，因为它简单易行；）

```
 public class ApplicationUser
    {
        public string FirstName { get; set; }
        public string LastName { get; set; }

        public string FullName
        {
            get
            {
                return $"{FirstName} {LastName}";
            }
        }
    } 
```

# iphone - iPhone 像素密度

> ID：12554107
> 
> 赞同：0
> 
> 时间：2012-09-23T16:38:40.447
> 
> 标签：iphone, ppi

Apple 声明 iPhone（不是视网膜显示器）163 ppi 但如果您使用以下计算

[http://en.wikipedia.org/wiki/Pixel_density#Calculation_of_monitor_PPI](http://en.wikipedia.org/wiki/Pixel_density#Calculation_of_monitor_PPI)

结果是 164.825201164068。

什么计算使用苹果？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T18:07:44.790

如果假设对角线为 3.5392 英寸，则分辨率恰好为 163 ppi，这可能在制造公差范围内，因此我假设 Apple 指定了可能在公差范围内的最低分辨率。

# ios - 来自 appDelegate 的 alertView 不会在 buttonIndex 上切换视图

> ID：12554109
> 
> 赞同：0
> 
> 时间：2012-09-23T16:38:56.677
> 
> 标签：ios, xcode, uialertview, appdelegate

我正在尝试从 appDelegate 创建一个 alertView，但我无法让它工作。当应用程序首次启动时，alertView 将作为免责声明。我无法让它工作.. introViewcontroller 没有出现。我究竟做错了什么？附言。我使用情节提要，除了 intoViewController 这是一个 nib 文件。我的根视图控制器是“fisrtViewController”这是我的代码：谢谢..

```
int a; 
```

并在 didFinishLaunchingWithOptions

```
 if ( a == 0) {

UIAlertView *disclaimer = [[UIAlertView alloc] initWithTitle:@"Read Before use" message:@"By using this app you agree to its terms and conditions.\n\n\n\n\n\n\n\n\n\n\ntext heren\n\n\n\n\n\n\n\n\n\n\n\n\n" delegate:self cancelButtonTitle:@"No!" otherButtonTitles:@"Yes Let me In", nil];

[disclaimer show];
}

// Override point for customization after application launch.
return YES;
}

-(void) alertView:(UIAlertView *) alertView clickedButtonAtIndex:(NSInteger)buttonIndex{
if (buttonIndex == 1) {
  //  FirstViewController *firstView = [[FirstViewController alloc] init];
    a+=1;
  //  [self.viewController presentModalViewController:firstView animated:YES];
}
else if (buttonIndex == 2) {
    UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"Sorry!" message:@"You are not allowed to use this app due to the fact that you did not agree to the terms and Conditions. Please exit this app!" delegate:self cancelButtonTitle:@"OK" otherButtonTitles:nil, nil];
    [alert show];

if (buttonIndex ==1) {
       introViewController *intro = [[introViewController alloc] initWithNibName:@"introViewController" bundle:nil];
       [self.viewController presentModalViewController:intro animated:YES];
   introViewController *intro = [[introViewController alloc] initWithNibName:@"introViewController" bundle:nil];
   [self.viewController presentModalViewController:intro animated:YES];
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T17:46:20.773

处理此问题的最佳方法是使用一些 NSString 值写入 NSUserDefaults 文件。当应用程序第一次启动并接受免责声明时（例如：@“accept”），如果用户不接受也相应地更新该 NSString 值。（@“notAccept”）。

在 didFinishLaunchingWithOptions

```
if (![[[NSUserDefaults standardUserDefaults]valueForKey:@"key_disclaimer"] isEqualToString:@"accepted"]) {  
UIAlertView *disclaimer = [[UIAlertView alloc] initWithTitle:@"Read Before use" message:@"By using this app you agree to its terms and conditions.\n\n\n\n\n\n\n\n\n\n\ntext heren\n\n\n\n\n\n\n\n\n\n\n\n\n" delegate:self cancelButtonTitle:@"No!" otherButtonTitles:@"Yes Let me In", nil];   
[disclaimer show];
[disclaimer release];  
//        make sure to release it.  
} 
```

//如果用户接受免责声明。
[[NSUserDefaults standardUserDefaults]setValue:@"accepted" forKey:@"key_disclaimer"];
//如果用户不接受免责声明，[[NSUserDefaults standardUserDefaults]setValue:@"notAccepted" forKey:@"key_disclaimer"];

相应地更新“key_disclaimer”。那是最好的方法。在您的示例中，在时间上使用的值。如果您关闭并重新启动应用程序，它将再次询问免责声明。

在你的代码
int a;
使用
int a = 0 替换它；会没事的。
谢谢。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-23T17:46:26.830

如果你的代码和你上面写的完全一样，a 就不会是 0。如果你没有在启动时明确地将它设置为 0，它可能有任何值。

如果您想检查应用程序是否在安装后第一次打开，请使用 NSUserDefaults，例如（在 didFinishWithOptions 中）：

```
int startCount=[[NSUserDefaults standardUserDefaults] intForKey:@"startCount"];
if (startCount==0]){
  //Is the first start, show your agreement
  //Then increase startCount so that this will not be called at next start
  [[NSUserDefaults standardUserDefaults] setInteger:startCount++ forKey:@"startCount"];
} 
```

您还可以将版本号存储在 NSUserDefaults 中。这样，您可以检查用户是否首先启动了新版本。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-23T21:28:18.430

啊...现在我明白你要做什么了。

您的问题是`self.viewController`在您尝试呈现新的模态 ViewController 之前未设置。另外，我认为您的 buttonIndex 是 1。

请尝试：

```
if (buttonIndex == 1)
    {
        _window = [[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]];
        introViewController *intro = [[introViewController alloc] initWithNibName:@"introViewController" bundle:nil];
        _window.rootViewController = _intro;
        [_window makeKeyAndVisible];
    } 
```

由于您的问题与 无关`UIAlertView`，因此您可能希望更改问题的标题和描述以使其更清楚，以供其他遇到类似问题的人使用。

快乐编码！:)

# html - 查找元素内的插入符号位置

> ID：12554116
> 
> 赞同：0
> 
> 时间：2012-09-23T16:40:25.110
> 
> 标签：html, range, selection, contenteditable, getcaretpos

我在 contenteditable div 中有一个跨度，我需要确定光标是否位于跨度标记的最后一个位置。我查看了选择和范围解决方案，但无法找到实现该目标的直接方法。

```
<html>
    <script>
        var selection =  window.getSelection();
        var range = selection.getRangeAt(0);
        //this is what I am trying to achive
        var selection_target = range.selectNodeContents(document.getElementById('target')); 
        var length = selection_target.toString().length;

     </script>
     <body>  
          <div id='target' contenteditable='true'>
             <span>some text(figure cursor position here)</span>
          </div>
      </body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-25T09:10:32.197

对于跨度只有一个子节点是文本节点的问题的情况，您可以检查插入符号是否在其末尾，如下所示：

演示：http: [//jsfiddle.net/Wm5Hz/](http://jsfiddle.net/Wm5Hz/)

代码：

```
var span = document.getElementById("target").getElementsByTagName("span")[0];
var spanTextNode = span.lastChild;
var sel = window.getSelection();
var isCaretAtEndOfSpan = (sel.isCollapsed
    && sel.focusNode == spanTextNode
    && sel.focusOffset == spanTextNode.data.length); 
```

在一般情况下事情稍微复杂一些：相同的视觉位置可以用不同的方式表示（例如，在文本节点中的最后一个字符之后，在文本节点本身之后，在跨度结束之后），加上如果跨度可以包含元素，那么您需要找到跨度内的最后一个文本节点并将选择与其进行比较。此外，这些都不适用于 IE < 9，它具有完全不同的 API。

# java - 如何远程调用刚刚在 Eclipse 中调试的小程序的功能？

> ID：12554117
> 
> 赞同：1
> 
> 时间：2012-09-23T16:40:26.857
> 
> 标签：java, eclipse, debugging, applet, fest

当我通过 javascript 在浏览器中调用我的小程序的某个函数时，我得到一个异常。但是，我不想在该小程序在浏览器中运行时对其进行调试，我想通过 Debug as... 在 Eclipse 中启动它，然后以某种方式远程调用该函数。那可能吗？如果是这样，怎么做？

或者，在使用 FEST 框架编写测试用例时，我可以通过框架或任何其他方式调用该函数吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-24T06:10:40.250

不。我认为可以从 Eclipse 远程调用在 Eclipse 中运行的小程序。由于这似乎是不可能的，我必须获取堆栈跟踪，甚至远程调试在浏览器中运行的小程序。

# ruby-on-rails - 如何在模型中定义信誉系统值

> ID：12554121
> 
> 赞同：0
> 
> 时间：2012-09-23T16:40:49.067
> 
> 标签：ruby-on-rails, voting

如何在我的博客应用程序中设置 default_scope，以便索引按照模型中定义的算法对条目进行排序？

如果我要使用[类似于 HackerNews 的公式](http://www.quora.com/Whats-Hacker-News-ranking-algorithm)进行排名算法，如下所示，我该如何在我的模型中定义它？

```
total_score = (votes_gained - 1) / (age_in_hours + 2)^1.5 
```

votes_gained 变量依赖于 Active_Record_Reputation_System，在我看来是这样写的：

```
votes_gained = @post.reputation_value_for(:votes).to_i 
```

最后，age_in_hours 非常简单

```
age_in_hours = (Time.now - @post.created_at)/1.hour 
```

我如何使用这些数字来订购我的博客文章索引？我一直在试图弄清楚如何`total_score`在模型中正确定义，以便我可以将其添加到默认范围`default_scope order("total_score DESC")`或类似的东西中。直接替换没有奏效，我不确定如何“改写”公式的每个部分。

我应该如何定义`total_score`？非常感谢您的洞察力！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T20:22:30.843

既然不能依靠活动记录将公式翻译成 SQL，就得自己写。这里唯一的潜在问题是这不是一个独立于数据库的解决方案。

由于您使用的是 Postgres，您可以将您的范围定义为（我还没有测试过，所以让我知道它是否有效）：

```
AGE_IN_HOURS = "(#{Time.now.tv_sec} - EXTRACT (EPOCH FROM posts.created_at))/3600"
TOTAL_SCORE = "(rs_reputations.value - 1)/((#{AGE_IN_HOURS}) + 2)^1.5"

default_scope joins("INNER JOIN rs_reputations ON rs_reputations.target_id = posts.id").where("rs_reputations.target_type = 'Post'").order(TOTAL_SCORE) 
```

编辑：实际上这不起作用，因为就目前而言， Time.now 计算一次（当模型加载时），但每次提取记录时都需要重新计算。利用

```
default_scope lambda { order_by_score }

def self.order_by_score

    age_in_hours = "(#{Time.now.tv_sec} - EXTRACT (EPOCH FROM posts.created_at))/3600"
    total_score = "(rs_reputations.value - 1)/((#{age_in_hours}) + 2)^1.5"

    joins("INNER JOIN rs_reputations ON rs_reputations.target_id = posts.id").where("rs_reputations.target_type = 'Post'").order(TOTAL_SCORE)
end 
```

# android - 更改主页按钮的长按功能

> ID：12554140
> 
> 赞同：2
> 
> 时间：2012-09-23T16:42:53.480
> 
> 标签：android, launcher, taskmanager, long-press, long-click

我正在寻找 Android 的“技巧”来更改长按主页按钮的功能。目前，长按home键打开任务管理器。相反，我希望长按充当短按，这意味着将我们带到默认启动器的主页​​。

理想情况下，这个技巧适用于所有 Android 版本，但如果它只适用于 2.3.x 或 4.xx，那么这就足够了。

（我设法用 Android 2.3.x 禁用了长按，但现在我希望将长按用作短按）

# android - Sencha touch + phonegap。在 android 4.0 上渲染数据视图

> ID：12554141
> 
> 赞同：3
> 
> 时间：2012-09-23T16:42:58.307
> 
> 标签：android, cordova, sencha-touch, sencha-touch-2

我遇到了 android 4.0.3 问题。当我的应用程序加载时，数据视图应该出现（在主页上）。但是在我点击这个空间之前，有一个空白空间。点击后一切正常。这同样适用于列表和嵌套列表视图。只需加载应用程序，然后清空屏幕并点击后 - 没问题。在 iPhone 或旧的 android 版本上一切正常。

也许有人面临同样的问题？

数据视图代码（没什么特别的）：

```
 xtype: 'dataview',
  itemTpl: '<div class="judge-list-item"><tpl if="img"><img src="{img}"/></tpl><small>{description}</small><h4>{title}</h4></div>',
  scrollable: false,
  styleHtmlContent: true,
  listeners: {
            initialize: function () {
                           ...
                        },
                        itemtap: function (dataview, indexx, target, record, eOpts) {
                           ...
                        }
             } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-01T11:44:01.783

尝试：

```
Ext.defer(function() {
    myDataview.refresh();
}, 50); 
```

# c# - 尝试标记 odata 时，可查询属性未在 mvc 4 Web api 中编译

> ID：12554145
> 
> 赞同：8
> 
> 时间：2012-09-23T16:43:27.743
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-4, asp.net-web-api, odata

我正在使用 Visual Studio 2012 附带的 MVC 4 web api。

据我了解，odata 不会自动解析，但我们现在需要将 [Queryable] 属性添加到操作中。

所以我添加了它：

```
public class TestController : ApiController
{
    [Queryable]
    public IQueryable<MyClass> GetMyClasses()
    {
       return ...;
    }
} 
```

但我收到编译错误：

```
The type or namespace name 'Queryable' could not be found (are you missing a using directive or an assembly reference?) 
```

odata 还支持吗？以及为什么 Queryable 未被识别为此处列出的属性。

谢谢

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-09-23T16:51:31.897

[如此处](http://blogs.msdn.com/b/alexj/archive/2012/08/15/odata-support-in-asp-net-web-api.aspx)所述，OData 支持已移至单独的[NuGet 包](http://www.nuget.org/packages/Microsoft.AspNet.WebApi.OData)。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-04-28T01:24:22.337

它在这个程序集（DLL）中：

```
 System.Web.Http.OData.dll 
```

这个命名空间：

```
System.Web.Http.QueryableAttribute 
```

在这个 nuget 包中：

```
Install-Package Microsoft.AspNet.WebApi.OData 
```

当我安装软件包时，它并没有显示为有效类型。即使验证它`System.Web.Http.OData.dll`存在并在对象资源管理器中查找，我也找不到它。最终我只是重新启动了 Visual Studio，一切都很好。我怀疑这个 DLL 的某些旧版本可能会混淆它或类似的东西。

# android - Android 中用于在不同活动/片段之间导航的推荐导航方法是什么

> ID：12554148
> 
> 赞同：0
> 
> 时间：2012-09-23T16:43:49.350
> 
> 标签：android, android-layout

我正在使用 ActionBar 等将我的 Android 应用程序切换到更“合适”的 UX。我一直在尝试确定最佳/推荐的导航样式是什么。

我的应用程序有 5 个活动，我目前使用菜单/溢出菜单在它们之间切换。

我的应用程序有 1 个主屏幕，用户将大部分时间都花在上面。用户需要一种导航到其他活动的方法，但它们都没有真正相互关联。它们更像是用户在需要进行一些维护时会访问的实用程序屏幕。

我正在阅读这个链接：http: [//developer.android.com/design/patterns/actionbar.html](http://developer.android.com/design/patterns/actionbar.html)

我首先考虑使用操作栏下拉导航，但这似乎不是为导航而设计的，更适用于在相同数据的视图之间切换：

```
Use a spinner in the main action bar if:

You don't want to give up the vertical screen real estate for a dedicated tab bar.
The user is switching between views of the same data set (for example: calendar events   viewed by day, week, or month) or data sets of the same type (such as content for two different accounts). 
```

然后我打算使用 ActionBar 选项卡，但它说这更适合在经常使用的项目之间滑动：

```
Use tabs if:

You expect your app's users to switch views frequently.
You want the user to be highly aware of the alternate views. 
```

我想最后一个选项是将操作放入溢出菜单，但这似乎我要倒退了。

谁能提供一些见解？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T23:36:54.753

我决定按照这里使用侧抽屉：http: [//developer.android.com/design/patterns/actionbar.html](http://developer.android.com/design/patterns/actionbar.html)

```
Open a drawer from the main action bar if:

You want to provide direct navigation to a number of views within your app which don't have direct relationships between each other. 
```

# ios - 如何在 UITabbar 中添加 ADBannerView 和 UITableView？

> ID：12554149
> 
> 赞同：0
> 
> 时间：2012-09-23T16:43:58.200
> 
> 标签：ios, uitableview, uinavigationcontroller, uitabbarcontroller, adbannerview

当他们遇到 ADBannerViews 时，我对视图层次结构有点困惑。我想以编程方式将 iAd-Banner 插入现有应用程序，但我不知道从哪里开始。我确实阅读了苹果文档并观看了一个非常好的 WWDC 视频，但我仍然难以理解如何使用这些信息以适当的方式将广告带入我的应用程序。

**这是我的应用程序的架构：**

底部有窗户。
该窗口的 rootViewController 是 UINavigationController。
navigationControllers 堆栈中的第一个 viewController 是 UITabBarController。
这个 tabBarController 拥有五个类似的 UITableView。
在其中一个 tableViews 的其中一个 tableCells 上 Tab 将一个新的 viewcontroller 推送到 navigationControllers 堆栈上。
这个新的 viewController 又是一个 UITabBarController，但是这个只有四个选项卡，这个 tabBarControllers 数组中的四个 Viewcontroller 是：

*   两个不同的 UITableViewControllers
*   两个不同的简单 UIViewController，一个只有一张图片，另一个有许多嵌套视图。

我想在 navigationControllers 堆栈中第二个 tabBarController 的这四个子项的底部插入一个 ADBannerView。我不知道如何做到这一点。

我的问题是：我不明白当用户点击广告时会发生什么。我知道，广告的代码会在我的应用程序上推送一个新视图，但我不明白如何。新视图是否会成为我的 navigationController 堆栈的一部分（我不这么认为）？或者新视图会是 tabBarControllers 视图之一的新子视图吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T14:31:26.553

我没有任何证据，但我的猜测是，当用户点击横幅时，ADBannerView 代码会将新的子视图推送到**根**视图控制器的视图上，因为它需要在所有内容之上显示全屏在您的应用程序中。根视图控制器通常在您的`applicationDidFinishLaunchingWithOptions`方法中设置。

ps题外话了，但你确定要更改标签的数量吗？更传统的 UI 范例是选项卡在屏幕底部保持不变。在这种情况下，你有一个 UITabBarController，它下面有几个 UINavigationControllers。

# javascript - 将 div 覆盖在 JavaScript 元素之上

> ID：12554150
> 
> 赞同：4
> 
> 时间：2012-09-23T16:44:09.740
> 
> 标签：javascript, html, css

我想在另一个包含 JavaScript 的 div(2) 的顶部覆盖一个带有背景图像的 div(1)（在本例中为 Google maps API v3）。这可能吗？

我试过弄乱 z-index 没有运气，我不能使用绝对定位，因为我依靠 div(1) 来定位其他 div。

一个简短的例子可以在这里找到 - _

试图让 _ 语音气泡覆盖 Google 地图。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T16:48:40.550

首先，一个代码示例是个好主意，因为我们需要知道很多细节。（例如。其他哪些 div 依赖于 div(1) 的位置？）

您不能在 box-model 或 inline(model) 中覆盖 div。

您可以尝试使用负边距将 div(1) 移到 div(2) 上，但这不是优雅的解决方案。

您应该重新考虑使用绝对定位，因为它显然是更可取的解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T17:03:32.760

我建议将带有背景图像的 div(1) 放在半透明的 Google 地图容器下方，因为这样您仍然可以访问 Google 地图控件。这可以通过在两个容器上使用`opacity`和`z-index`CSS 属性来完成。

**这是一个使用 Google Maps API 进行现场演示的 JS fiddle：[jsfiddle.net/Xk87Y/](http://jsfiddle.net/Xk87Y/)**

# java - java.lang.StringIndexOutOfBoundsException：字符串索引超出范围：-1

> ID：12554151
> 
> 赞同：2
> 
> 时间：2012-09-23T16:44:16.100
> 
> 标签：java, jsf-2, primefaces

我正在尝试使用可拖放的可拖放组件 S 这是我的代码：

```
<h:panelGrid columns="2" cellpadding="10">   
  <p:column>
    <p:fieldset id="belongTo" legend="Belong To" >  
      <p:dataGrid id="userGroups"
                  var="userGroup"
                  value="#{projectAdminisrationMB.selectedUserMemberOfGroups}"
                  columns="3">  
        <p:column>  
          <p:panel id="pnl1"
                   header="#{userGroup.name}"
                   style="text-align:center">
            <h:panelGrid columns="1" style="width:100%">  
              <p:graphicImage value="/images/group/adminGroup.gif"/> 
            </h:panelGrid>  
          </p:panel>  
          <p:draggable for="pnl1"
                       revert="true"
                       handle=".ui-panel-titlebar"
                       stack=".ui-panel"/>
        </p:column>  
      </p:dataGrid>  
    </p:fieldset>  
    <p:droppable for="belongTo"
                 tolerance="touch"
                 activeStyleClass="ui-state-highlight"
                 datasource="userNotGroups" >
      <p:ajax listener="#{projectAdminisrationMB.onExcludeFromGroupDrop}" />
    </p:droppable> 
  </p:column>
  <p:column>  
    <p:fieldset id="excludeFrom"
                legend="Exclude From"
                style="margin-top:20px">  
      <p:dataGrid id="userNotGroups"
                  var="userNotGroup"
                  value="#{projectAdminisrationMB.selectedUserNotMemberOfGroups}"
                  columns="3">  
        <p:column>  
          <p:panel id="pnl2"
                   header="#{userNotGroup.name}"
                   style="text-align:center">  
            <h:panelGrid columns="1" style="width:100%">  
              <p:graphicImage value="/images/grou/defaultGroup.gif"/> 
            </h:panelGrid>  
          </p:panel>  
          <p:draggable for="pnl2"
                       revert="true"
                       handle=".ui-panel-titlebar" 
                       stack=".ui-panel"/>  
        </p:column>  
      </p:dataGrid>  
    </p:fieldset>   
    <p:droppable for="excludeFrom"
                 tolerance="touch"
                 activeStyleClass="ui-state-highlight"
                 datasource="userGroups"  >  
      <p:ajax listener="#{projectAdminisrationMB.onBelongToGroupDrop}"  />  
    </p:droppable>  
  </p:column>
</h:panelGrid> 
```

因此，当我触摸一个组件以将其拖放到数据网格时，我会收到此错误：即使我只是移动组件，我也会收到它，该组件是一个面板

```
java.lang.StringIndexOutOfBoundsException: String index out of range: -1
    at java.lang.String.substring(Unknown Source)
    at com.sun.faces.renderkit.ServerSideStateHelper.getState(ServerSideStateHelper.java:263)
    at com.sun.faces.renderkit.ResponseStateManagerImpl.getState(ResponseStateManagerImpl.java:97)
    at com.sun.faces.application.view.StateManagementStrategyImpl.restoreView(StateManagementStrategyImpl.java:217)
    at com.sun.faces.application.StateManagerImpl.restoreView(StateManagerImpl.java:177)
    at com.sun.faces.application.view.ViewHandlingStrategy.restoreView(ViewHandlingStrategy.java:119)
    at com.sun.faces.application.view.FaceletViewHandlingStrategy.restoreView(FaceletViewHandlingStrategy.java:438)
    at com.sun.faces.application.view.MultiViewHandler.restoreView(MultiViewHandler.java:144)
    at com.sun.faces.lifecycle.RestoreViewPhase.execute(RestoreViewPhase.java:182)
    at com.sun.faces.lifecycle.Phase.doPhase(Phase.java:97)
    at com.sun.faces.lifecycle.RestoreViewPhase.doPhase(RestoreViewPhase.java:106)
    at com.sun.faces.lifecycle.LifecycleImpl.execute(LifecycleImpl.java:114)
    at javax.faces.webapp.FacesServlet.service(FacesServlet.java:334)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:305)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:225)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:123)
    at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:472)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:168)
    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:98)
    at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:927)
    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:407)
    at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1001)
    at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:579)
    at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:310)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)
    at java.lang.Thread.run(Unknown Source) 
```

# c# - 有没有办法搜索列表 使用部分填充的对象？

> ID：12554156
> 
> 赞同：3
> 
> 时间：2012-09-23T16:44:44.843
> 
> 标签：c#, linq, list

希望能够填充对象的任何属性并在集合中搜索与给定属性匹配的对象。

```
class Program
{
    static List<Marble> marbles = new List<Marble> { 
        new Marble {Color = "Red", Size = 3},
        new Marble {Color = "Green", Size = 4},
        new Marble {Color = "Black", Size = 6}
    };

    static void Main()
    {
        var search1 = new Marble { Color = "Green" };
        var search2 = new Marble { Size = 6 };
        var results = SearchMarbles(search1);
    }

    public static IEnumerable<Marble> SearchMarbles(Marble search)
    {
        var results = from marble in marbles
                      //where ???
                      //Search for marbles with whatever property matches the populated properties of the parameter
                      //In this example it would return just the 'Green' marble
                      select marble;
        return results;
    }

    public class Marble
    {
        public string Color { get; set; }
        public int Size { get; set; }
    }

} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-23T17:44:26.690

诚然，这很有趣，需要我花时间。首先，您需要获取`search`与默认值不同的对象的所有属性，此方法是使用反射的通用方法：

```
var properties = typeof (Marble).GetProperties().Where(p =>
                {
                    var pType = p.PropertyType;
                    var defaultValue = pType.IsValueType 
                            ? Activator.CreateInstance(pType) : null;

                    var recentValue = p.GetValue(search);

                    return !recentValue.Equals(defaultValue);
                }); 
```

然后你可以使用 LINQ`All`来过滤：

```
var results = marbles.Where(m => 
                         properties.All(p => 
                         typeof (Marble).GetProperty(p.Name)
                                        .GetValue(m) == p.GetValue(search))); 
```

ps：这段代码已经测试过了

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-23T17:21:08.573

You can use a separate Filter class like this:

```
class Filter
{
    public string PropertyName { get; set; }
    public object PropertyValue { get; set; }

    public bool Matches(Marble m)
    {
        var T = typeof(Marble);
        var prop = T.GetProperty(PropertyName);
        var value = prop.GetValue(m);
        return value.Equals(PropertyValue);
    }
} 
```

You can use this Filter as follows:

```
var filters = new List<Filter>();
filters.Add(new Filter() { PropertyName = "Color", PropertyValue = "Green" });

//this is essentially the content of SearchMarbles()
var result = marbles.Where(m => filters.All(f => f.Matches(m)));

foreach (var r in result)
{
    Console.WriteLine(r.Color + ", " + r.Size);
} 
```

You could use DependencyProperties to get rid of typing the property name.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-23T22:47:33.037

我将提出适用于任意数量的属性和任何对象的通用解决方案。它也可以在 Linq-To-Sql 上下文中使用——它可以很好地转换为 sql。

首先，首先定义将测试给定值是否被视为非集合的函数，例如：

```
static public bool IsDefault(object o)
{
    return o == null || o.GetType().IsValueType && Activator.CreateInstance(o.GetType()).Equals(o);
} 
```

然后，我们将有一个函数构造一个 Lambda 表达式，并针对`search`对象中所有设置属性的值进行测试：

```
static public Expression<Func<T, bool>> GetComparison<T>(T search)
{
    var param = Expression.Parameter(typeof(T), "t");

    var props = from p in typeof(T).GetProperties()
                where p.CanRead && !IsDefault(p.GetValue(search, null))
                select Expression.Equal(
                    Expression.Property(param, p.Name),
                    Expression.Constant(p.GetValue(search, null))
                );

    var expr = props.Aggregate((a, b) => Expression.AndAlso(a, b));
    var lambda = Expression.Lambda<Func<T, bool>>(expr, param);         
    return lambda;
} 
```

我们可以在任何地方使用它`IQueryable`：

```
public static IEnumerable<Marble> SearchMarbles (Marble search)
{
    var results = marbles.AsQueryable().Where(GetComparison(search));
    return results.AsEnumerable();
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-23T17:01:51.137

您可以在 Marbles 类中覆盖 equals

```
public override bool Equals(object obj)
    {
        var other = obj as Marble;

        if (null == other) return false;

        return other.Color == this.color && other.size == this.size; // (etc for your other porperties
    } 
```

然后你可以搜索

```
return marbles.Where(m => search == m); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-23T16:52:00.443

假设如果属性具有默认值（即`Color == null`和`Size == 0`），则该属性未填充：

```
var results = from marble in marbles
              where (marble.Color == search.Color || search.Color == null)
                 && (marble.Size == search.Size || search.Size == 0)
              select marble; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-23T17:52:45.267

If you want to avoid targeting specific properties, you could use reflection. Start by defining a function that returns the default value of a type (see [here](https://stackoverflow.com/a/2490274/111794) for a simple solution, and [here](https://stackoverflow.com/a/7881481/111794) for something more elaborate).

Then, you can write a method on the `Marble` class, which takes an instance of `Marble` as a filter:

```
public bool MatchesSearch(Marble search) {
    var t = typeof(Marble);
    return !(
        from prp in t.GetProperties()
        //get the value from the search instance
        let searchValue = prp.GetValue(search, null)
        //check if the search value differs from the default
        where searchValue != GetDefaultValue(prp.PropertyType) &&
              //and if it differs from the current instance
              searchValue != prp.GetValue(this, null)
        select prp
    ).Any();
} 
```

Then, the `SearchMarbles` becomes:

```
public static IEnumerable<Marble> SearchMarbles(Marble search) {
    return
        from marble in marbles
        where marble.MatchesSearch(search)
        select marble;
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-09-23T17:31:46.660

使用反射，此方法将适用于**所有类型**，无论它们包含多少或什么类型的属性。

将跳过任何未填写的属性（引用类型为空，值类型为默认值）。如果它找到两个不匹配的已填写属性，则返回 false。如果所有填写的属性都相等，则返回 true。

```
IsPartialMatch(object m1, object m2)
{
    PropertyInfo[] properties = m1.GetType().GetProperties();
    foreach (PropertyInfo property in properties)
    {
        object v1 = property.GetValue(m1, null);
        object v2 = property.GetValue(m2, null);
        object defaultValue = GetDefault(property.PropertyType);

        if (v1.Equals(defaultValue) continue;
        if (v2.Equals(defaultVAlue) continue;
        if (!v1.Equals(v2)) return false;
    }

    return true;
} 
```

* * *

将其应用于您的示例

```
public static IEnumerable<Marble> SearchMarbles(Marble search)
{
    return marbles.Where(m => IsPartialMatch(m, search))
} 
```

* * *

GetDefault() 是这篇文章中的方法，[相当于 default(Type)](https://stackoverflow.com/questions/325426/programmatic-equivalent-of-defaulttype)

# ios - 在 iphone dev 5.0 中模拟无法打开数据库错误

> ID：12554157
> 
> 赞同：0
> 
> 时间：2012-09-23T16:44:47.477
> 
> 标签：ios, sqlite

嗨，我需要模拟一个错误，指出 iphone 应用程序无法打开数据库并显示其中的值。我使用 sqllite。请让我知道如何模拟该错误。我尝试通过锁定数据库文件，将 db 文件更改为只读，但什么也没发生...请让我知道如何模拟错误...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T16:52:35.977

使用单独的连接打开数据库，设置独占[锁定模式](http://www.sqlite.org/pragma.html#pragma_locking_mode)，并进行一些更改（您不需要提交）。

# android - 自定义 android.intent.action.RINGTONE_PICKER

> ID：12554158
> 
> 赞同：0
> 
> 时间：2012-09-23T16:44:59.320
> 
> 标签：android, notifications

除了通知声音列表之外，我还想添加一个与我的应用程序捆绑在一起的自定义声音列表，以便从 RingtonePreference 中选择（我想提供一些 30 秒长的通知声音除了默认情况下可用的短的）。在我看来，最简单的方法是扩展 android.intent.action.RINGTONE_PICKER 以列出一些额外的铃声，但我似乎无法找到来源。我将如何扩展这个意图？这是安全的事情吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-03T11:32:11.100

你不扩展意图。您可以在清单中使用它，并通过 listView 显示您自己的活动，其中可以选择哪些项目。

另一种方法是使用以下项目创建您自己的对话框：“从操作系统中选择...”、“appSound1”、“appSound2”、...。在这里，第一项将引发 android.intent.action.RINGTONE_PICKER 意图的正常对话框。

# jquery - jQuery 验证 - 仅当字段具有值时才将其验证为 URL

> ID：12554159
> 
> 赞同：0
> 
> 时间：2012-09-23T16:44:59.583
> 
> 标签：jquery, forms, validation, jquery-validate

我正在使用*jQuery.validation*插件来验证表单。表单上有一个名为“survey_url”的可选字段。如果此字段为空白，我不想对其进行验证，但是如果有一个值，我想确保它是有效的 URL。

我有以下规则，但尽管我没有将survey_url 设置为“必需”，但即使它没有值，它也会被标记为无效 URL：

```
 //form validation rules
  form.validate({
      errorClass: "help-inline",
      rules: {
          "webcast[title]": "required",
          "webcast[survey_url]":
          {
            url: true
          }
      },
      messages: {
          "webcast[title]": 
          {
              required: "Please enter a title for this Webcast."
          },
          "webcast[survey_url]": 
          {
              required:"You must enter a valid URL, or leave blank."
          }
      },
      submitHandler: function(form) {
          form.submit();
      }
  }); 
```

**我的规则应该是什么样子，以便survey_url 仅在具有值的情况下才被验证为 URL？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-24T14:54:56.240

您的脚本中必须有其他内容，因为您提供的内容可以按预期工作：http: [//jsfiddle.net/ryleyb/ztDwh/1/](http://jsfiddle.net/ryleyb/ztDwh/1/)

您应该能够提交该表单，只填写标题，而 URL 中没有任何内容。如果您输入一个 URL，它必须是正确的 URL 格式。听起来像你想要的？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T17:02:02.620

```
url=$("#survey_url").val();
url=$.trim("#survey_url");

if (url!=""){

if(/^([a-z]([a-z]|\d|\+|-|\.)*):(\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?((\[(|(v[\da-f]{1,}\.(([a-z]|\d|-|\.|_|~)|[!\$&'\(\)\*\+,;=]|:)+))\])|((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=])*)(:\d*)?)(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*|(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)|((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)|((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)){0})(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?   $/i.test(url)) {
 alert("valid url");
 } else {
 alert("invalid url");
 }
 } 
```

# python - 如何在可接受的时间内在 Windows 下获取所有正在运行的 Python 进程？

> ID：12554176
> 
> 赞同：4
> 
> 时间：2012-09-23T16:47:33.843
> 
> 标签：python, process

我想在可接受的时间内获得 Windows 7（以及后来的 Linux）下所有正在运行的 Python 进程的列表。根据结果​​，我想启动我的主要应用程序所依赖的其他新进程。

[我从https://github.com/giampaolo/psutil](https://github.com/giampaolo/psutil)尝试了 psutil ：

```
import psutil
for process in psutil.process_iter():
    if process.name == 'python.exe':
        print(process) 
```

这给了我好看的结果，但运行它大约需要一分钟！

我发现使用 psutil.process_iter() 遍历所有进程和使用**psutil.get_pid_list** **()**列出所有进程都是可以接受的，但是获取每个进程的名称以识别 Python 进程（我将使用**process.cmdline**进一步调查) 似乎很贵。

 ****任何想法如何显着提高速度或其他方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-23T16:56:35.007

[直接使用ctypes](http://docs.python.org/library/ctypes.html)使用 windows 功能[`EnumProcesses()`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms682629%28v=vs.85%29.aspx)（来自`Kernel32.dll`或`Psapi.dll`取决于您的 windows 版本）。****

# jquery - jQuery触发器不起作用

> ID：12554177
> 
> 赞同：1
> 
> 时间：2012-09-23T16:47:41.213
> 
> 标签：jquery, eventtrigger

我正在尝试在页面加载后立即在标题上创建过渡效果（从下到上），但我不知道为什么它不起作用。

**HTML：**

```
<div class="portfolio-title-wrap animate">
    <div class="portfolio-title">Rooftop Garden </div>
    <div class="location">San Francisco, CA</div>
</div> 
```

**CSS：**

```
.animate {
background-color: #c00;
-webkit-transition: all 1s ease;
-moz-transition: all 1s ease;
-o-transition: all 1s ease;
-ms-transition: all 1s ease;
transition: all 1s ease;
position: absolute;
top: 100%;
right: 0;
}

.animate.move {
top: 0%;
margin-top: -700px;
}

.portfolio-title {
color: #F8941F;
font-weight:bold;
} 
```

**jQuery：**

```
jQuery('.animate').trigger(
function() {
$(this).addClass("move");
}); 
```

**演示：** [小提琴](http://jsfiddle.net/Esgba/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T16:51:17.327

为了[`.trigger()`](http://api.jquery.com/trigger/)工作，您需要向它传递一个事件类型。然后，这将执行为给定事件类型附加的所有处理程序。例如：

```
$('.animate').bind('move-event', function () { // handler will fire when 'move-event' is triggered
  $(this).addClass("move");        
});

$('.animate').trigger('move-event'); 
```

**[演示](http://jsfiddle.net/Esgba/)**。

​如果你只是想`move`在页面加载时添加类，根本不需要使用`trigger`，只需添加类：

```
$(document).ready(function () {
  $(".animate").addClass("move"); 
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T16:53:07.533

你实际上并没有触发任何东西，你应该传递[一个事件名称或一个 Event 对象](http://api.jquery.com/category/events/event-object/)：

```
.trigger( eventType [, extraParameters] ) 
```

例如

```
 // Create a new jQuery.Event object with specified event properties.
  var e = jQuery.Event("keydown", { keyCode: 64 });

  // trigger an artificial keydown event with keyCode 64
  jQuery("body").trigger( e ); 
```

# opencv - 打开 CV Surf 并 FindExtrinsicCameraParams2

> ID：12554178
> 
> 赞同：1
> 
> 时间：2012-09-23T16:47:57.570
> 
> 标签：opencv, augmented-reality, emgucv, homography, pose-estimation

是否可以使用 FindExtrinsicCameraParams2 来获取姿势矩阵，而不是使用带有 SURF 特征检测的单应性分解？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T18:56:39.130

是的，假设您有一个校准过的相机并且有一组点，其位置在 t = 0 的世界空间和当前帧中的图像空间中是已知的。如果你知道这两个，那么电话看起来像这样

```
FindExtrinsicCameraParams2(objectPoints, imagePoints, cameraMatrix, distCoeffs, rvec, tvec, useExtrinsicGuess=0) 
```

*   objectPoints 是您在 t==0 处查看的对象的世界坐标中的点。

*   imagePoints 是对应于这些世界坐标的当前图像点。

*   cameraMatrix 是你的相机矩阵

*   distCoeffs 是您的失真系数（忽略那些只是通过所有 0 的系数）。

*   rvec 和 tvec 将由函数填充，因此它们包含您当前的旋转和平移向量。

获得 rvec 和 tvec 的内容后，您可以使用[Rodrigues](http://opencv.willowgarage.com/documentation/cpp/calib3d_camera_calibration_and_3d_reconstruction.html#Rodrigues)将 rvec 转换为旋转矩阵，然后将两者结合以获得您的姿势矩阵。

# perl - “perl”和“perl -w”之间的区别？

> ID：12554179
> 
> 赞同：7
> 
> 时间：2012-09-23T16:48:01.110
> 
> 标签：perl

我正在学习 Perl，非常新的用户。我可以知道这些 Perl 代码之间有什么区别吗？

```
#!/usr/bin/perl 
```

&

```
#!/usr/bin/perl -w 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-23T16:49:22.433

那不是 perl 代码，它是[shebang](http://en.wikipedia.org/wiki/Shebang_%28Unix%29)，它在 linux/unix 环境中用于告诉 shell 应该使用什么程序来运行程序文件。它在 Windows 中没有任何作用，但它会激活任何使用的开关。

该`-w`部分是 perl 的开关，告诉它激活警告。`perl -h`您可以通过在命令提示符下键入来了解有关 perl 命令行开关的更多信息。阅读更多[`perldoc perlrun`](http://perldoc.perl.org/perlrun.html)

`-w`是旧版本的`use warnings`编译指示，现在是首选。While`-w`是全局的，`use warnings`是词法的，可以有选择地激活。

# coding-style - 花括号语言上的“Lisp 样式”缩进

> ID：12554182
> 
> 赞同：5
> 
> 时间：2012-09-23T16:48:11.713
> 
> 标签：coding-style, indentation

我想知道人们对 C++、Java、JavaScript 等语言使用 Lisp 缩进样式的看法。我一直是 Python 的粉丝，以及它是如何在没有大括号的情况下进行格式化的。它对我来说非常紧凑和干净。我想知道用花括号语言做类似的事情是否是个好主意。我最近一直在使用 JavaScript，所以我将使用 JavaScript 作为示例。

通常，我使用这样的东西，例如

```
function doStuff (stuff1, stuff2) {
    if (stuff1 === stuff2) {
        doMoreStuff();
        doEvenMoreStuff();
    }
    else {
        takeABreak();
    }
} 
```

这将成为

```
function doStuff (stuff1, stuff2) {
    if (stuff1 === stuff2) {
        doMoreStuff();
        doEvenMoreStuff(); }
    else {
        takeABreak(); } } 
```

它是紧凑的，并且更多地关注缩进而不是像 Python 这样的大括号。Lisp 并不是以特别漂亮的语言而闻名，但我有点喜欢这种语言，并且不要认为它看起来太糟糕，尽管当你有很多嵌套块同时结束时，事情会变得有点毛茸茸。不过，我想要第二个意见。也许我不应该尝试用 JavaScript 编写 Python 代码？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-23T16:56:41.347

我过去肯定见过这样的代码。它没有任何问题，只要您和任何同事都认为它清晰易读。

如果您正在开发现有产品或与已建立的团队合作，那么最好始终保持您的代码与您周围的内容保持一致，直到（除非）每个人都同意转换样式。如果代码和团队都是新的（或者代码是新的而团队就是你），那么请随意做任何感觉自然的事情。实验是我们前进的动力。

# c# - 如何序列化/反序列化为`Dictionary ` 来自不使用 XElement 的自定义 XML？

> ID：12554186
> 
> 赞同：51
> 
> 时间：2012-09-23T16:48:28.347
> 
> 标签：c#, .net, xml, mono

有空`Dictionary<int, string>`如何用 XML 中的键和值填充它

```
<items>
<item id='int_goes_here' value='string_goes_here'/>
</items> 
```

并将其序列化回 XML 而不使用 XElement？

* * *

## 回答 #1

> 赞同：111
> 
> 时间：2012-09-23T19:50:50.633

在临时`item`课程的帮助下

```
public class item
{
    [XmlAttribute]
    public int id;
    [XmlAttribute]
    public string value;
} 
```

*样本字典：*

```
Dictionary<int, string> dict = new Dictionary<int, string>()
{
    {1,"one"}, {2,"two"}
}; 
```

.

```
XmlSerializer serializer = new XmlSerializer(typeof(item[]), 
                                 new XmlRootAttribute() { ElementName = "items" }); 
```

**序列化**

```
serializer.Serialize(stream, 
              dict.Select(kv=>new item(){id = kv.Key,value=kv.Value}).ToArray() ); 
```

**反序列化**

```
var orgDict = ((item[])serializer.Deserialize(stream))
               .ToDictionary(i => i.id, i => i.value); 
```

## -------------------------------------------------- ----------------------------

如果您改变主意，这是*使用 XElement完成的方法。*

**序列化**

```
XElement xElem = new XElement(
                    "items",
                    dict.Select(x => new XElement("item",new XAttribute("id", x.Key),new XAttribute("value", x.Value)))
                 );
var xml = xElem.ToString(); //xElem.Save(...); 
```

**反序列化**

```
XElement xElem2 = XElement.Parse(xml); //XElement.Load(...)
var newDict = xElem2.Descendants("item")
                    .ToDictionary(x => (int)x.Attribute("id"), x => (string)x.Attribute("value")); 
```

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2012-09-23T18:33:58.930

Paul Welter 的[ASP.NET 博客](http://weblogs.asp.net/pwelter34/archive/2006/05/03/444961.aspx)有一个可序列化的字典。但它不使用属性。我将在代码下方解释原因。

```
using System;
using System.Collections.Generic;
using System.Text;
using System.Xml.Serialization;

[XmlRoot("dictionary")]
public class SerializableDictionary<TKey, TValue>
    : Dictionary<TKey, TValue>, IXmlSerializable
{
    #region IXmlSerializable Members
    public System.Xml.Schema.XmlSchema GetSchema()
    {
        return null;
    }

    public void ReadXml(System.Xml.XmlReader reader)
    {
        XmlSerializer keySerializer = new XmlSerializer(typeof(TKey));
        XmlSerializer valueSerializer = new XmlSerializer(typeof(TValue));

        bool wasEmpty = reader.IsEmptyElement;
        reader.Read();

        if (wasEmpty)
            return;

        while (reader.NodeType != System.Xml.XmlNodeType.EndElement)
        {
            reader.ReadStartElement("item");

            reader.ReadStartElement("key");
            TKey key = (TKey)keySerializer.Deserialize(reader);
            reader.ReadEndElement();

            reader.ReadStartElement("value");
            TValue value = (TValue)valueSerializer.Deserialize(reader);
            reader.ReadEndElement();

            this.Add(key, value);

            reader.ReadEndElement();
            reader.MoveToContent();
        }
        reader.ReadEndElement();
    }

    public void WriteXml(System.Xml.XmlWriter writer)
    {
        XmlSerializer keySerializer = new XmlSerializer(typeof(TKey));
        XmlSerializer valueSerializer = new XmlSerializer(typeof(TValue));

        foreach (TKey key in this.Keys)
        {
            writer.WriteStartElement("item");

            writer.WriteStartElement("key");
            keySerializer.Serialize(writer, key);
            writer.WriteEndElement();

            writer.WriteStartElement("value");
            TValue value = this[key];
            valueSerializer.Serialize(writer, value);
            writer.WriteEndElement();

            writer.WriteEndElement();
        }
    }
    #endregion
} 
```

首先，此代码有一个问题。假设您从另一个来源阅读了一本字典，其中包含以下内容：

```
<dictionary>
  <item>
    <key>
      <string>key1</string>
    </key>
    <value>
      <string>value1</string>
    </value>
  </item>
  <item>
    <key>
      <string>key1</string>
    </key>
    <value>
      <string>value2</string>
    </value>
  </item>
</dictionary> 
```

这将在 de-seariazation 中引发异常，因为您只能拥有一个字典键。

* * *

您必须在序列化字典中使用 XElement 的原因是字典未定义为`Dictionary<String,String>`，字典是`Dictionary<TKey,TValue>`。

要看到这个问题，问问你自己：假设我们有一个`TValue`序列化为使用元素的东西，它把自己描述为 XML（假设一个字典字典`Dictionary<int,Dictionary<int,string>>`（不是那种不常见的模式，它是一个查找表）），如何您的 Attribute only 版本会完全代表属性内的字典吗？

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-09-23T17:07:20.137

默认情况下，字典在 C# 中不可序列化，我不知道为什么，但这似乎是一种设计选择。

现在，我建议使用[Json.NET](http://json.codeplex.com/)将其转换为 JSON 并从那里转换为字典（反之亦然）。除非您真的需要 XML，否则我建议您完全使用 JSON。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2016-06-23T15:43:18.367

基于LB的回答。

用法：

```
var serializer = new DictionarySerializer<string, string>();
serializer.Serialize("dictionary.xml", _dictionary);
_dictionary = _titleDictSerializer.Deserialize("dictionary.xml"); 
```

通用类：

```
public class DictionarySerializer<TKey, TValue>
{
    [XmlType(TypeName = "Item")]
    public class Item
    {
        [XmlAttribute("key")]
        public TKey Key;
        [XmlAttribute("value")]
        public TValue Value;
    }

    private XmlSerializer _serializer = new XmlSerializer(typeof(Item[]), new XmlRootAttribute("Dictionary"));

    public Dictionary<TKey, TValue> Deserialize(string filename)
    {
        using (FileStream stream = new FileStream(filename, FileMode.Open))
        using (XmlReader reader = XmlReader.Create(stream))
        {
            return ((Item[])_serializer.Deserialize(reader)).ToDictionary(p => p.Key, p => p.Value);
        }
    }

    public void Serialize(string filename, Dictionary<TKey, TValue> dictionary)
    {
        using (var writer = new StreamWriter(filename))
        {
            _serializer.Serialize(writer, dictionary.Select(p => new Item() { Key = p.Key, Value = p.Value }).ToArray());
        }
    }
} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2016-09-22T13:24:05.550

您可以使用[ExtendedXmlSerializer](https://github.com/wojtpl2/ExtendedXmlSerializer)。如果你有一堂课：

```
public class TestClass
{
    public Dictionary<int, string> Dictionary { get; set; }
} 
```

并创建此类的实例：

```
var obj = new TestClass
{
    Dictionary = new Dictionary<int, string>
    {
        {1, "First"},
        {2, "Second"},
        {3, "Other"},
    }
}; 
```

您可以使用 ExtendedXmlSerializer 序列化此对象：

```
var serializer = new ConfigurationContainer()
    .UseOptimizedNamespaces() //If you want to have all namespaces in root element
    .Create();

var xml = serializer.Serialize(
    new XmlWriterSettings { Indent = true }, //If you want to formated xml
    obj); 
```

输出 xml 将如下所示：

```
<?xml version="1.0" encoding="utf-8"?>
<TestClass xmlns:sys="https://extendedxmlserializer.github.io/system" xmlns:exs="https://extendedxmlserializer.github.io/v2" xmlns="clr-namespace:ExtendedXmlSerializer.Samples;assembly=ExtendedXmlSerializer.Samples">
  <Dictionary>
    <sys:Item>
      <Key>1</Key>
      <Value>First</Value>
    </sys:Item>
    <sys:Item>
      <Key>2</Key>
      <Value>Second</Value>
    </sys:Item>
    <sys:Item>
      <Key>3</Key>
      <Value>Other</Value>
    </sys:Item>
  </Dictionary>
</TestClass> 
```

您可以从[nuget](https://www.nuget.org/packages/ExtendedXmlSerializer/)安装 ExtendedXmlSerializer或运行以下命令：

```
Install-Package ExtendedXmlSerializer 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2016-11-18T14:49:27.310

我有一个结构`KeyValuePairSerializable`：

```
[Serializable]
public struct KeyValuePairSerializable<K, V>
{
    public KeyValuePairSerializable(KeyValuePair<K, V> pair)
    {
        Key = pair.Key;
        Value = pair.Value;
    }

    [XmlAttribute]
    public K Key { get; set; }

    [XmlText]
    public V Value { get; set; }

    public override string ToString()
    {
        return "[" + StringHelper.ToString(Key, "") + ", " + StringHelper.ToString(Value, "") + "]";
    }
} 
```

然后，属性的 XML 序列化`Dictionary`是：

```
[XmlIgnore]
public Dictionary<string, string> Parameters { get; set; }

[XmlArray("Parameters")]
[XmlArrayItem("Pair")]
[DebuggerBrowsable(DebuggerBrowsableState.Never)] // not necessary
public KeyValuePairSerializable<string, string>[] ParametersXml
{
    get 
    { 
        return Parameters?.Select(p => new KeyValuePairSerializable<string, string>(p)).ToArray(); 
    }
    set
    {
        Parameters = value?.ToDictionary(i => i.Key, i => i.Value);
    }
} 
```

只是属性必须是数组，而不是列表。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-09-23T18:06:34.887

编写一个包含 B 类数组的 A 类。B 类应该有一个 id 属性和一个 value 属性。将 xml 反序列化为 A 类。将 A 中的数组转换为所需的字典。

要序列化字典，请将其转换为 A 类的实例，然后序列化...

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2019-01-25T03:14:56.703

KeyedCollection 像字典一样工作并且是可序列化的。

首先创建一个包含键和值的类：

```
/// <summary>
/// simple class
/// </summary>
/// <remarks></remarks>
[Serializable()]
public class cCulture
{
    /// <summary>
    /// culture
    /// </summary>
    public string culture;

    /// <summary>
    /// word list
    /// </summary>
    public List<string> list;

    /// <summary>
    /// status
    /// </summary>
    public string status;
} 
```

然后创建一个 KeyedCollection 类型的类，并将您的类的属性定义为键。

```
/// <summary>
/// keyed collection.
/// </summary>
/// <remarks></remarks>
[Serializable()]
public class cCultures : System.Collections.ObjectModel.KeyedCollection<string, cCulture>
{
    protected override string GetKeyForItem(cCulture item)
    {
        return item.culture;
    }
} 
```

对序列化此类数据很有用。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2014-01-22T15:18:11.573

我将可序列化的类用于不同模块之间的 WCF 通信。下面是一个可序列化类的示例，它也用作 DataContract。我的方法是使用 LINQ 的强大功能将 Dictionary 转换为 KeyValuePair<> 的开箱即用的可序列化 List<>：

```
 using System;
    using System.Collections.Generic;
    using System.Linq;
    using System.Runtime.Serialization;
    using System.Xml.Serialization;

    namespace MyFirm.Common.Data
    {
        [DataContract]
        [Serializable]
        public class SerializableClassX
        {
            // since the Dictionary<> class is not serializable,
            // we convert it to the List<KeyValuePair<>>
            [XmlIgnore]
            public Dictionary<string, int> DictionaryX 
            {
                get
                {
                    return  SerializableList == null ? 
                            null :
                            SerializableList.ToDictionary(item => item.Key, item => item.Value);
                }

                set
                {
                    SerializableList =  value == null ?
                                        null :
                                        value.ToList();
                }
            }

            [DataMember]
            [XmlArray("SerializableList")]
            [XmlArrayItem("Pair")]
            public List<KeyValuePair<string, int>> SerializableList { get; set; }
        }
    } 
```

用法很简单——我将一个字典分配给我的数据对象的字典字段 - DictionaryX。通过将分配的字典转换为 KeyValuePair<> 的可序列化 List<>，在 SerializableClassX 内部支持序列化：

```
 // create my data object
    SerializableClassX SerializableObj = new SerializableClassX(param);

    // this will call the DictionaryX.set and convert the '
    // new Dictionary into SerializableList
    SerializableObj.DictionaryX = new Dictionary<string, int>
    {
        {"Key1", 1},
        {"Key2", 2},
    }; 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-11-29T06:33:39.083

Sharpeserializer（开源）有一种简单的方法：

[http://www.sharpserializer.com/](http://www.sharpserializer.com/)

它可以直接序列化/反序列化字典。

无需使用任何属性标记您的对象，也无需在 Serialize 方法中指定对象类型（参见[此处](https://www.codeproject.com/kb/xml/sharpserializer.aspx?artkw=sharpserializer) ）。

通过 nuget 安装：`Install-package sharpserializer`

然后很简单：

**Hello World**（来自官方网站）：

```
// create fake obj
var obj = createFakeObject();

// create instance of sharpSerializer
// with standard constructor it serializes to xml
var serializer = new SharpSerializer();

// serialize
serializer.Serialize(obj, "test.xml");

// deserialize
var obj2 = serializer.Deserialize("test.xml"); 
```

# objective-c - 列出/搜索所有现有的 UTI（统一类型标识符）

> ID：12554187
> 
> 赞同：11
> 
> 时间：2012-09-23T16:48:35.410
> 
> 标签：objective-c, macos, cocoa, uti

是否可以在系统上找到所有现有[统一类型标识符](http://developer.apple.com/library/mac/#documentation/FileManagement/Conceptual/understanding_utis/understand_utis_intro/understand_utis_intro.html)的列表？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-24T05:35:10.823

怎么样

```
 /System/Library/Frameworks/CoreServices.framework/Frameworks/LaunchServices.framework/Versions/A/Support/lsregister -dump 
```

更好：所有通用类型标识符的图表 - [Kevin Ballard 的博客](https://web.archive.org/web/20160527232247/http://kevin.sb.org/2006/03/16/graph-of-all-universal-type-identifiers/)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-05-22T13:54:56.327

[您可以使用 UTIsExplorer https://github.com/nst/UTIsExplorer](https://github.com/nst/UTIsExplorer)构建自己的图表

该项目包括我机器上所有 UTI 的图表：http: [//seriot.ch/resources/utis_graph/utis_graph.pdf](http://seriot.ch/resources/utis_graph/utis_graph.pdf)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-11-29T11:27:46.413

此处提供了 UTI 类型的完整列表[https://developer.apple.com/library/archive/documentation/Miscellaneous/Reference/UTIRef/Articles/System-DeclaredUniformTypeIdentifiers.html#//apple_ref/doc/uid/TP40009259-SW1](https://developer.apple.com/library/archive/documentation/Miscellaneous/Reference/UTIRef/Articles/System-DeclaredUniformTypeIdentifiers.html#//apple_ref/doc/uid/TP40009259-SW1)

# android - setOnClickListener 中的变量无法解析

> ID：12554191
> 
> 赞同：1
> 
> 时间：2012-09-23T16:49:00.293
> 
> 标签：android, onclicklistener

我到处找，但找不到我要找的东西。

我正在尝试使用 a 的`Chronometer`内部为 android 制作秒表应用程序`Fragment`，但在`setOnClickListener`某些按钮上出现错误。

它是括号“（）”fx中的变量。( `mStartListener`)，我得到错误`mStartListener cannot be resolved to a variable`。

请帮助我，我真的很想进入android开发。谢谢

这是代码

```
b = (Button) getView().findViewById(R.id.start);
b.setOnClickListener(mStartListener); //--- error
b = (Button) getView().findViewById(R.id.stop);
b.setOnClickListener(mStopListener); //--- error
b = (Button) getView().findViewById(R.id.reset);
b.setOnClickListener(mResetListener); //--- error 
```

完整代码：

```
import android.app.Fragment;
import android.os.Bundle;
import android.os.SystemClock;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.Chronometer;

public class StopWatchFragment extends Fragment {

    Chronometer mChronometer;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
    }

    @Override
    public void onActivityCreated(Bundle savedInstanceState) {
        super.onActivityCreated(savedInstanceState);
    }

    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container,
            Bundle savedInstanceState) {
        View view = inflater.inflate(R.layout.stopwatch, container, false);

        Button b;
        mChronometer = (Chronometer) getView().findViewById(R.id.chronometer);
        // Watch for button clicks.
        b = (Button) getView().findViewById(R.id.start);
        b.setOnClickListener(mStartListener); //--- error
        b = (Button) getView().findViewById(R.id.stop);
        b.setOnClickListener(mStopListener); //--- error
        b = (Button) getView().findViewById(R.id.reset);
        b.setOnClickListener(mResetListener); //--- error

        return view;

    View.OnClickListener mStartListener = new OnClickListener() {
        public void onClick(View v) {
            mChronometer.start();
        }
    };
    View.OnClickListener mStopListener = new OnClickListener() {
        public void onClick(View v) {
            mChronometer.stop();
        }
    };
    View.OnClickListener mResetListener = new OnClickListener() {
        public void onClick(View v) {
            mChronometer.setBase(SystemClock.elapsedRealtime());
    }
    };
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T16:52:18.887

移动将每个 Listener 声明为类变量的位置：

```
public class StopWatchFragment extends Fragment {

    Chronometer mChronometer;
    View.OnClickListener mStartListener;
    ... 
```

**或者**在您尝试使用它们*之前*声明您的听众：

```
Button b;
mChronometer = (Chronometer) getView().findViewById(R.id.chronometer);

View.OnClickListener mStartListener = new OnClickListener() {
    public void onClick(View v) {
        mChronometer.start();
    }
};
...

// Watch for button clicks.
b = (Button) getView().findViewById(R.id.start);
b.setOnClickListener(mStartListener); //--- no more error 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T16:55:41.957

在尝试将它们设置为 OnClickListener**之后**，您正在定义和初始化方法`mStopListener`内部。`onCreateView`

 **您应该将它们移到方法的开头：

```
public View onCreateView(LayoutInflater inflater, ViewGroup container,
            Bundle savedInstanceState) {
        View view = inflater.inflate(R.layout.stopwatch, container, false);
   View.OnClickListener mStartListener = new OnClickListener() {
        public void onClick(View v) {
            mChronometer.start();
        }
    };
    View.OnClickListener mStopListener = new OnClickListener() {
        public void onClick(View v) {
            mChronometer.stop();
        }
    };
    View.OnClickListener mResetListener = new OnClickListener() {
        public void onClick(View v) {
            mChronometer.setBase(SystemClock.elapsedRealtime());
        }
    };
    Button b;
    mChronometer = (Chronometer) getView().findViewById(R.id.chronometer);
    // Watch for button clicks.
    b = (Button) getView().findViewById(R.id.start);
    b.setOnClickListener(mStartListener); //--- error
    b = (Button) getView().findViewById(R.id.stop);
    b.setOnClickListener(mStopListener); //--- error
    b = (Button) getView().findViewById(R.id.reset);
    b.setOnClickListener(mResetListener); //--- error

    return view;

} 
```

**或者，**将它们作为全局变量放在您的方法之外。**

# asp.net - 如何使用 AntiXss 库正确清理内容？

> ID：12554194
> 
> 赞同：6
> 
> 时间：2012-09-23T16:49:20.627
> 
> 标签：asp.net, .net, security, xss, antixsslibrary

我有一个简单的论坛应用程序，当有人发布任何内容时，我会：

```
post.Content = Sanitizer.GetSafeHtml(post.Content); 
```

现在，我不确定我是否做错了什么，或者发生了什么，但它不允许几乎没有 html。即使是简单`<b></b>`的也太过分了。所以我猜这个工具完全没用。

现在我的问题：谁能告诉我应该如何清理我的用户输入，以便他们可以发布一些图像（`<img>`标签）并使用粗体强调等？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-23T17:38:17.567

似乎很多人觉得消毒剂[没什么用](https://wpl.codeplex.com/releases/view/80289#ReviewsAnchor)。不要使用消毒剂，只需对所有内容进行编码，然后将安全部分解码回来：

```
private static readonly IEnumerable<string> WhitelistedTags =
    new[] { "<b>", "</b>", "<i>", "</i>" };

private static readonly (string Encoded, string Decoded)[] DecodingPairs =
    WhitelistedTags
    .Select(tag => (Microsoft.Security.Application.Encoder.HtmlEncode(tag), tag))
    .ToArray();

public static string Sanitize(string html)
{
    // Encode the whole thing
    var safeHtml = Microsoft.Security.Application.Encoder.HtmlEncode(html);
    var builder = new StringBuilder(safeHtml);

    // Decode the safe parts
    foreach (var (encodedTag, decodedTag) in DecodingPairs)
    {
        builder.Replace(encodedTag, decodedTag);
    }

    return builder.ToString();
} 
```

**请注意，安全地解码IMG**标签几乎是不可能的，因为攻击者滥用此标签的方法非常简单。例子：

```
<IMG SRC="javascript:alert('XSS');">

<IMG SRC=&#106;&#97;&#118;&#97;&#115;&#99;&#114;&#105;&#112;&#116;&#58;&#97;&#108;&#101;&#114;&#116;&#40;&#39;&#88;&#83;&#83;&#39;&#41;> 
```

在这里查看更详尽的[XSS 备忘单](https://www.owasp.org/index.php/XSS_Filter_Evasion_Cheat_Sheet)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T09:53:10.817

[这篇文章](http://eksith.wordpress.com/2012/02/13/antixss-4-2-breaks-everything/)最好地描述了 Anti XSS 库的问题，并提供了一个很好的解决方法，将一组标签和属性列入白名单。

我在我的项目中使用这个解决方案，它似乎工作得很好。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2017-09-13T10:31:45.387

有一种非常简单的方法可以通过去掉“危险”标签来阻止威胁。

```
string SanitizeHtml(string html)
{
        html = System.Web.HttpUtility.HtmlDecode(html);

        List<string> blackListedTags = new List<string>() 
        {
                "body", "script", "iframe", "form", "object", "embed", "link", "head", "meta" 
        };

        foreach (string tag in blackListedTags) { 
            html = Regex.Replace(html, "<" + tag, "<p", RegexOptions.IgnoreCase); 
            html = Regex.Replace(html, "</" + tag, "</p", RegexOptions.IgnoreCase);
        }

        return html;
} 
```

有了这个，用户仍然可以看到危险脚本中的内容，但它不会伤害任何东西。

# java - 无法从没有公共类的文件扩展

> ID：12554197
> 
> 赞同：3
> 
> 时间：2012-09-23T16:49:34.713
> 
> 标签：java

Test.java 和 B.java 在默认包中。

文件 Test.java（我们可以为没有公共类的文件提供任何名称）包含：

```
class A{} 
```

文件 B.java 包含：

```
class B extends A{} 
```

如果我编译 B.java 它给出一个错误说：

```
B.java:1: error: cannot find symbol    
class B extends A{   
                ^
symbol: class A
1 error 
```

代码有什么问题？请帮帮我！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T16:57:02.730

编译器将在与提到它的位置相同的文件中查找类`A`（在本例中`B.java`）。之后它将在类路径和`import`列表中查找它。之后它将在`A.java`同一个包内的文件中查找它，该文件不存在。它无处可寻，所以`cannot find symbol`......

做@Vikdor 推荐的事情：`Test.java`先编译。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-23T17:01:04.833

您应该编译`Test.java`以`A.class`创建。然后你应该尝试编译`B.java`，编译器会`A.class`在默认的当前目录中找到`CLASSPATH`。

```
C:\Temp\test>dir
 Volume in drive C is OSDisk
 Volume Serial Number is 1E37-6273

 Directory of C:\Temp\test

09/23/2012  10:48 PM    <DIR>          .
09/23/2012  10:48 PM    <DIR>          ..
09/23/2012  10:47 PM               100 B.java
09/23/2012  10:47 PM                68 Test.java
               2 File(s)            168 bytes
               2 Dir(s)  171,760,668,672 bytes free

C:\Temp\test>type Test.java
class A
{
    static {
        System.out.println("A");
    }
}
C:\Temp\test>Type B.java
class B extends A
{
    public static void main(String [] args)
    {
        new B();
    }
}
C:\Temp\test>javac Test.java

C:\Temp\test>dir
 Volume in drive C is OSDisk
 Volume Serial Number is 1E37-6273

 Directory of C:\Temp\test

09/23/2012  10:49 PM    <DIR>          .
09/23/2012  10:49 PM    <DIR>          ..
09/23/2012  10:49 PM               375 A.class
09/23/2012  10:47 PM               100 B.java
09/23/2012  10:47 PM                68 Test.java
               3 File(s)            543 bytes
               2 Dir(s)  171,760,668,672 bytes free

C:\Temp\test>javac B.java

C:\Temp\test>java B
A

C:\Temp\test> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-23T17:01:48.047

如果先编译Test.java，会有一个A.class文件。如果您不这样做，那么编译器将不知道如何查找 A 类（因为它只知道查找 A.class 或 A.java）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-23T17:17:19.450

**Create class A**

`class A{}`

**Create class B**

`class B extends A{}`

**Now Do take of these :**

**1.** `class A` and `class B` should be in the **Same Package**, as `class A` has a `default access modifier`, so **only package level access** is granted.

**2\. Compile** `class A` **first**, then compile `class B`.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-23T17:08:17.437

```
 It's Working na..............

  //Test.java

   class A   

  {

  public static void main(String arg[])

    {

        System.out.println("A");

    }

 }

 //B.java

public class B extends A

{

    public static void main(String arg[])

    {

        System.out.println("B");

    }

 } 
```

# php - 教义从子查询中选择

> ID：12554202
> 
> 赞同：2
> 
> 时间：2012-09-23T16:50:38.910
> 
> 标签：php, mysql, doctrine

我正在尝试通过学说运行以下查询：

```
$sql = "SELECT league_id, sum(num_fans) AS total_fans FROM ("
."SELECT COUNT(*) as num_fans, t.id AS team_id, l.id AS league_id FROM fan_link fl "
."JOIN team t ON fl.team_id = t.id JOIN League l ON t.league_id = l.id GROUP BY fl.team_id"
.") a GROUP BY league_id LIMIT 0, 3";

$results = $this->em->createQuery($sql)->getScalarResult(); 
```

该查询在 PHPMyAdmin 中运行良好，但是当我尝试在学说中运行它时，我收到此错误：

```
Doctrine\ORM\Query\QueryException [ 0 ]: 
[Semantical Error] line 0, col 51 near '(SELECT COUNT(*)': 
Error: Class '(' is not defined. 
```

括号`(`是教义查询中的保留字符吗？我在`where`其他地方的子句中有子选择可以正常工作，但是子句中的这个`from`子句不想工作。我究竟做错了什么？

更新：
我刚刚尝试使用查询生成器并得到了同样的错误。代码：

```
$qb = $this->em->createQueryBuilder();
$leagueQuery = $qb->select('league_id, sum(num_fans) AS total_fans')
    ->from("(SELECT count(*) as num_fans, t.id AS team_id, l.id AS league_id "
    ."FROM fan_link fl "
    ."JOIN team t ON fl.team_id = t.id "
    ."JOIN League l ON t.league_id = l.id GROUP BY fl.team_id)",
    'a')
    ->groupBy("league_id")
    ->orderBy("total_fans", "DESC")
    ->setMaxResults(3)
    ->getQuery();

$results = $leagueQuery->getArrayResult(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T18:33:37.110

最终使用了这个：

```
$sql = "SELECT league_id, sum(num_fans) AS total_fans FROM "
    ."(SELECT COUNT(*) as num_fans, t.id AS team_id, l.id AS league_id FROM fan_link fl "
    ."JOIN team t ON fl.team_id = t.id JOIN League l ON t.league_id = l.id GROUP BY fl.team_id"
    .") a GROUP BY league_id LIMIT 0, 3";
$q = $this->em->getConnection();
$league_results = $q->fetchAll($sql); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-12-14T16:13:34.720

花很多时间来完成这项工作！

你可以用**createNativeQuery()**

这是工作示例：

```
$rsm = new ResultSetMapping();
$rsm->addScalarResult('c1', 'c1');
$rsm->addScalarResult('b1', 'b1');

$qb = $manager->createNativeQuery("
SELECT SUM(RESULTS.totalHours) AS c1, SUM(RESULTS.totalDuration) AS b1
FROM
(
    SELECT S.totalHours, S.totalDuration
    FROM S
    INNER JOIN SV ON S.specificationId = SV.id
    LEFT JOIN SToTagRel ST ON S.id = ST.specificationId
    LEFT JOIN T ON ST.tagId = T.id
    GROUP BY S.id
) AS RESULTS
", $rsm); 
```

`$qb->getSingleResult();`

# objective-c - iOS 6 旋转问题 - 呈现的模态视图控制器没有旋转

> ID：12554204
> 
> 赞同：16
> 
> 时间：2012-09-23T16:50:45.257
> 
> 标签：objective-c, ios, ios6

我有一个 MainViewController，它有一个通过水平翻转推动新视图（InfoViewController）的按钮。像这样：

```
controller.modalTransitionStyle = UIModalTransitionStyleFlipHorizontal;
[self presentModalViewController:controller animated:YES]; 
```

MainView 控制器支持 Portrait 和 PortraitUpsideDown。像这样：

```
- (BOOL)shouldAutorotate {
    return YES;    
}

- (NSUInteger)supportedInterfaceOrientations {    
    return (UIInterfaceOrientationMaskPortrait | 
            UIInterfaceOrientationMaskPortraitUpsideDown);
} 
```

在我的 InfoViewController 中，它还说明了上述代码。在我的 AppDelegate 中，它在 LaunchOptions 中有这个：

```
[self.window setRootViewController:self.mainViewController]; 
```

在我的 app.plist 文件中，它支持所有方向。这是因为其他视图也需要支持横向。所以在我的 MainViewController 和 InfoViewController 上，我只需要 Portrait 和 PortraitUpsideDown。但从另一个角度来看，我需要所有的 orintations。

我的 MainViewController 工作正常，但我的 InfoViewController 适用于所有方向。

我在尝试让它在 iOS6 中工作时遇到了极大的困难。我研究了其他帖子并尝试了其他人提供的帮助，但没有任何运气。请有人能帮我实现这个谢谢。我是一个 Objective-C 新手 :p

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-09-23T18:47:14.410

不支持您的应用 plist 文件中的所有方向，仅支持您的根视图控制器支持的方向。

iOS 6 中的自动旋转正在发生变化。在 iOS 6 中，`shouldAutorotateToInterfaceOrientation:`不推荐使用 UIViewController 的方法。取而代之的是，您应该使用`supportedInterfaceOrientationsForWindow:`and`shouldAutorotate`方法：

```
- (BOOL)shouldAutorotate {
    return YES;
}

- (NSUInteger)supportedInterfaceOrientations {
    return UIInterfaceOrientationMaskAllButUpsideDown;    
} 
```

模态视图控制器在 iOS 6 中不再获得旋转调用：`willRotateToInterfaceOrientation:duration:,` `willAnimateRotationToInterfaceOrientation:duration:,`和 `didRotateFromInterfaceOrientation:`方法不再在任何对其自身进行全屏呈现的视图控制器上调用——例如那些被调用的视图控制器：`presentViewController:animated:completion:`。

您可以让呈现模态视图控制器的视图控制器通知它旋转。此外，现在您使用：`presentViewController:animated:completion:`来呈现视图控制器。`presentModalViewController:animated:`不推荐使用您在代码中使用的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-08T00:29:50.110

我在使用标签栏控制器时解决了类似的问题。

子类 UITabBarController。实现这些方法：

```
- (NSUInteger)supportedInterfaceOrientations
{
    return UIInterfaceOrientationMaskAll;
}

- (BOOL)shouldAutorotate
{
    NSLog(@"Orientation:%d", [[UIDevice currentDevice] orientation]);

    for (UIViewController *viewController in self.viewControllers) {
        [viewController shouldAutorotate];
    }

    return YES;
} 
```

如果您想在 tabbarcontroller 内的控制器中处理旋转，请在 tab bar 控制器中的每个控制器中也实现这些方法并编写代码来处理方向更改。如果您不想处理它，那么您不需要实现这些方法。TabBarControllers 方法将始终在方向更改时运行。甚至两次，原因不明。

是的，不要忘记删除所有 shouldAutorotate 方法。我完全转向了新的定向模型。如果你想让它们留下来，可能会更难。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-25T05:51:01.723

通过继承 UINavigationController 创建一个类别并在 .h 文件中实现以下方法

```
-(BOOL)shouldAutorotate;
-(NSUInteger)supportedInterfaceOrientations;
- (UIInterfaceOrientation)preferredInterfaceOrientationForPresentation;

 in .m file

-(BOOL)shouldAutorotate
{
return [self.topViewController shouldAutorotate];
}

-(NSUInteger)supportedInterfaceOrientations
 {
return [self.topViewController supportedInterfaceOrientations];
 }

-(UIInterfaceOrientation)preferredInterfaceOrientationForPresentation
 {
return [self.topViewController preferredInterfaceOrientationForPresentation];
 } 
```

并在视图控制器类中实现以下方法，你想启用旋转

```
-(NSUInteger)supportedInterfaceOrientations
{
return (UIInterfaceOrientationMaskPortrait | UIInterfaceOrientationMaskLandscapeLeft |   UIInterfaceOrientationMaskLandscapeRight | UIInterfaceOrientationMaskPortraitUpsideDown);
 }

- (BOOL)shouldAutorotate
{
return YES;
}
- (UIInterfaceOrientation)preferredInterfaceOrientationForPresentation
{
   return UIInterfaceOrientationLandscapeLeft;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-04-16T01:57:52.627

在子类 UITabBarController .m 上添加此代码

```
@implementation UINavigationController (rotation)
//temp hack for iOS6, this allows passing supportedInterfaceOrientations to child viewcontrollers.
- (NSUInteger)supportedInterfaceOrientations {
    return [self.topViewController supportedInterfaceOrientations];
}
@end

@implementation NameClassUITabBar

- (void)viewDidLoad {
    [super viewDidLoad];
}

- (BOOL)shouldAutorotate
{
    return YES;
}

- (NSUInteger)supportedInterfaceOrientations
{
    return UIInterfaceOrientationMaskLandscape;
}

@end 
```

在这里，我在带有旋转的选项卡栏控制器中发布了我的解决方案/体验：http: [//luterr.blogspot.sg/2015/04/example-code-uiinterfaceorientationmask.html](http://luterr.blogspot.sg/2015/04/example-code-uiinterfaceorientationmask.html)

# java - 字符串只接受某些字符

> ID：12554205
> 
> 赞同：2
> 
> 时间：2012-09-23T16:50:53.187
> 
> 标签：java, string

```
import java.util.Scanner;

public class Test {
    public static void main(String[] args) {

        Scanner input = new Scanner(System.in);
        System.out.println("Enter Code");

        String code = input.next();
    }

    public static boolean isValidCode (String code) {

    }
} 
```

当我尝试对输入进行限制时，我在 java 中遇到了很多麻烦。在此示例中，我需要字符串代码仅接受 和 等`$`符号`%`。如何检查以确保没有数字、字母或其他符号？谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-23T17:08:05.690

这应该可以使包含除`$`和/或之外的任何内容的字符串无效`%`：

```
public static boolean isValidCode (String code) {
    return code.matches("^[$%]*$");
} 
```

如果您还要求字符串不为空，则将 更改`*`为 a `+`。如果您需要接受其他字符，只需将它们添加到字符类列表（方括号之间的字符）即可。

如果要进行多次测试（在您发布的代码中并非如此），则预编译模式会更有效：

```
private static final Pattern p = Pattern.compile("^[$%]*$");

public static boolean isValidCode (String code) {
    return p.matcher(code).matches();
} 
```

（对上面的调用`code.matches(...)`只是一种方便的方法。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-23T17:01:23.537

```
public static boolean isValidCode(String code) {
    return code.matches("[$%]*");
} 
```

正如您在正则表达式 javadoc 中看到的那样，尖括号表示您可以在封闭字符之间进行选择（在您的情况下为 $ 和 %）；* 表示它必须出现 0 次或多次。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-23T17:42:41.340

```
import java.util.Scanner;

public class Test 
{
    public static void main(String[] args) 
    {
        Scanner input = new Scanner(System.in);
        System.out.println("Enter Code");

        String code = input.next();
        for(int i=0;i<code.length();i++)
        {
            char c = code.charAt(i);

            if((!Character.isDigit(c))&&(!Character.isLetter(c)&&(!Character.isWhitespace(c))))      
            {
                if(c=='%'||c=='$')
                {
                    //What U Want..........
                }
                else
                {
                    System.out.println("Plz! Enter Only '%' or '$'");
                    break;
                }
            }//if
            else
            {
                System.out.println("Allows Only '%' or '$' Symbols");
                break;
            }
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-23T17:05:34.520

使用`Character`类。

**这是给你的代码：**

```
public class Hello {

    public static void main(String[] args) {

    Scanner input = new Scanner(System.in);
    System.out.println("Enter Code");

     String code = input.next();
     char c = code.charAt(0);
    if( (!Character.isDigit(c)) && (!Character.isLetter(c) && (!Character.isWhitespace(c)))){

        if(c == '%' || c=='$'){

            System.out.println("Its what u want");
        }else{
            System.out.println("Not what u want");
        }
    }else{
        System.out.println("Not what u want$");
    }

     }

} 
```

# ruby - 使用特定路径加载 Haml/Erb

> ID：12554209
> 
> 赞同：1
> 
> 时间：2012-09-23T16:51:21.110
> 
> 标签：ruby, sinatra

我希望能够通过我的网络应用程序中的特定路线。它是一个很好的规模（和不断增长的）sinatra 应用程序。

是）我有的

```
get '/' do
  haml :Hello_World
end 
```

我想要的是

```
get '/' do
  haml :/specific/path/Hello_World
end 
```

我意识到我可以更改根目录
`set :views, settings.root + '/my/path'`

但这确实不是一个可取的选择，因为我需要多条特定的路线。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-23T17:20:20.037

为了使符号包含正斜杠，您需要用引号将其括起来。因此，如果您想在目录中呈现视图，只需用引号将路径括起来。所以你的例子会变成......

```
get '/' do
  haml :'/specific/path/Hello_World'
end 
```

# ruby-on-rails - 对索引操作的结果进行分页

> ID：12554210
> 
> 赞同：0
> 
> 时间：2012-09-23T16:51:24.923
> 
> 标签：ruby-on-rails, twitter-bootstrap

我正在努力与`twitter-bootstrap`我的应用程序集成，并且在索引操作中呈现结果时遇到了一些问题

基本上我想要做的是让我的对象按行显示，每行有 4 个元素。

为了得到一个想法，我已经设法做到了

```
1 2 3 4    
5 6 7 8 
```

但这是 1 行，我需要实现的是这样的

`1 2 3 4`

`5 6 7 8`

调用时有没有办法做到这一点（最好不使用js）

```
<%= render @kindergartens %> 
```

还是里面偏？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T20:46:08.247

你可以使用`in_groups_of`方法。在您看来，您将这样做：

```
<% @kindergartens.in_groups_of(4) do |grp| %>
  <ul>
  <% grp.each do |item| %>
    <li><%= item.id %></li>
  <% end %> 
  </ul>
<% end %> 
```

`ul`这将为每组 4个单独呈现一个。或者您可以执行表格行或任何适合您需要的内容。

# mysql - 在数据库中存储相关值列表的正确方法

> ID：12554211
> 
> 赞同：0
> 
> 时间：2012-09-23T16:51:30.627
> 
> 标签：mysql, sql, sql-server, database, rdbms

假设我有以下情况。`LocalLibrary`一个有两个表的数据库`Books`和`Readers`

```
| BookID|  Title   | Author | 
-----------------------------
|  1    | "Title1" | "John" | 
|  2    | "Title2" | "Adam" | 
|  3    | "Title3" | "Adil" |
------------------------------ 
```

读者表看起来像这样。

```
| UserID| Name | 
-----------------
|  1    | xy   L  
|  2    | yz   | 
|  3    | xz   | 
---------------- 
```

现在，假设用户可以创建他们阅读的书籍列表（一个书架，严格包含上述作者的书籍，即我们数据库中的作者）。那么，在数据库中表示该书架的最佳方式是什么。

我最初的想法是表格中的逗号分隔`BookID`列表`Readers` 。但对于关系数据库来说，这显然听起来很尴尬，而且我每次显示用户书籍列表时都必须拆分它。此外，当用户将新书添加到书架时，除了拆分逗号分隔的列表并比较两者的 ID 之外，没有办法检查它是否已经存在于他们的书架中。删除也不容易。

因此，总而言之，问题是如何适当地模拟这些情况。除了 MySQL 中的简单 SELECT 和 INSERT 之外，我没有做任何事情。如果您可以用更简单的术语进行描述并提供进一步阅读的链接，那将会很有帮助。

如果您需要更多解释，请发表评论。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T16:56:23.010

完全忘记将逗号分隔的书籍列表添加到 Readers 表的想法。这将是不可搜索的并且非常笨拙。您需要连接 Books 表和 Readers 表的第三个表。此表中的每条记录代表一个阅读者正在阅读一本书。

```
Table ReaderList
--------------------
UserID | BookID    |
-------------------- 
```

您将获得特定用户阅读的书籍列表

```
select l.UserID, r.Name, l.BookID, b.Title, b.Author
from ReaderList l left join Books b on l.BookID = b.BookID
     left join Readers r on l.UserID = r.UserID
where l.UserID = 1 
```

如您所见，此模式需要使用关键字 JOIN 来将两个或多个表中的数据结合起来。[您可以在本文](http://en.wikipedia.org/wiki/Join_%28SQL%29)中阅读有关 JOIN 的更多信息
如果需要，您可以增强此模型，向 ReaderList 添加另一个字段，例如 ReadingDate

# c# - “每个请求的会话”模式是否利用了缓存？（“每个会话的会话”或“每个请求的会话”）

> ID：12554213
> 
> 赞同：3
> 
> 时间：2012-09-23T16:51:34.540
> 
> 标签：c#, .net, entity-framework, nhibernate, orm

这几天我在一个 Web 应用程序中从头开始构建一个新应用程序。
（技术是`Asp.Net`，我使用的 ORM 是`Entity Framework`。如果重要的话）

我不确定***每个请求广泛使用的模式会话***是否真的很好。
正如我所看到的，该模式的优点是缓存不会增加，直到数据库会话崩溃\太大，因此效率低下。

但是每个请求的新会话不是太多了吗？这意味着每次服务器调用都会重置缓存，即使是像自动完成这样的简单 ajax 请求也会有一个全新的缓存，实际上每次按键都会重置缓存。

您在一个请求中查询相同的对象实体行的机会很小。

***每个会话***的会话不是更好的模式吗？兼具优势意义

1.  缓存不会永远增长。
2.  缓存其实可以用...

那么......**为什么*每个请求的会话*被如此广泛地使用而*每个会话*的会话却不是？**

* * *

说明：

1.  当我编写 ORM 会话时，它同时适用于`NHibernate's session`和`EntityFramework's DbContext`.
2.  我的意思是在每个请求上刷新 session\dbcontext 的提交保存更改。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T17:43:39.807

对我来说，这一切都是为了通过将一个工作单元限制在一个请求中来提供一致性。我不确定当出现问题时每个会话的会话将如何工作。

例如，如果处理了多个请求，然后在提交时收到乐观并发异常，您会怎么做？那时你可能会有几个合并冲突。

因此，每个请求的会话只会限制您的冲突暴露，并使请求范围内的工作单元。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-23T17:13:59.720

每个请求的会话模式对于与 ORM 一起使用更加自然和健壮。它获得脏实体的机会更小，并且具有更可预测的资源管理。

如果我没听错，并且您的意思是 Session 下的 DbContext 实例，那么 Session Per Session 只能在应用程序中使用而无需修改数据，否则您将收到一个请求提交的意外数据，而其他请求执行数据修改。另外我不确定实体框架上下文是线程安全的——而处理请求是多线程的。

我不完全确定，但我认为 Entity Framework 并没有像您期望的那样广泛使用缓存（== 标识映射）。在选择实体集时，即使所有数据都在缓存中，它也会查询数据库——它只能避免构建新实体，而是使用身份映射中的现有实体。

对于缓存，还有其他解决方案，它们更好。

# c++ - 如何划分编辑框的容量？

> ID：12554215
> 
> 赞同：1
> 
> 时间：2012-09-23T16:51:39.837
> 
> 标签：c++, winapi, stl

```
 textBoxOutput = CreateWindowEx(WS_EX_CLIENTEDGE,L"Edit",NULL,WS_CHILD | WS_VISIBLE | WS_VSCROLL | ES_AUTOVSCROLL |  ES_MULTILINE | ES_READONLY ,10,81,500,90,hMainWindow,NULL,NULL,NULL);
.
.
.

    while(!buffer.empty()) //Buffer contains arrays of  wchar_t* type
            {   
                SendMessage(textBoxOutput,EM_SETSEL,GetWindowTextLength(textBoxOutput),GetWindowTextLength(textBoxOutput));
                SendMessage(textBoxOutput,EM_REPLACESEL,FALSE, (LPARAM) buffer.front()); 

                delete [] buffer.front();
                buffer.pop();
            } 
```

最多可以看到 30000 个宽字符。是否有可能至少增加这个数字？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T16:57:38.210

您可以使用该[`EM_LIMITTEXT`](http://msdn.microsoft.com/en-us/library/windows/desktop/bb761607%28v=vs.85%29.aspx)消息。从参考：

> 它设置编辑控件的文本限制。文本限制是用户可以在编辑控件中键入的最大文本量（以 TCHAR 为单位）。

# iphone - 如何将可选建议列表添加到 UISearch Bar？

> ID：12554223
> 
> 赞同：1
> 
> 时间：2012-09-23T16:52:28.167
> 
> 标签：iphone, objective-c, uitableview, ios5, uisearchbar

我是 iOS 开发的新手。我正在尝试在 IOS SDK 4.3 for iPhone 中为 UISearch Bar 创建一个单词建议列表。

最初，如果用户点击 UISearch 字段，它将在屏幕上向上移动并弹出空白列表，而用户开始键入搜索关键字时，它将根据搜索关键字在 UISearch 栏下列出建议。[一个例子是谷歌搜索。]。列表的建议，来自于 Web 服务的回归。

有点难以理解我应该如何在现有屏幕顶部创建和显示一个带有建议的表格视图，同时移动到 UISearch 栏的顶部，以及我应该如何将搜索栏移动到屏幕顶部并设置到以前的位置根据我隐藏建议表视图时的用户交互。

谢谢..

# c# - TextBox 接受 Tab 键

> ID：12554226
> 
> 赞同：0
> 
> 时间：2012-09-23T16:52:58.470
> 
> 标签：c#, winforms, .net-3.5, textbox

如果我将`TextBox`属性`AcceptsTab`设置`True`为此条件，`TextBox_KeyDown`则事件不起作用。

```
if (e.KeyCode == Keys.Tab)
{
     if ((e.Control) && (e.Shift))
     {
         e.Handled = true;
         if (Tabs.SelectedIndex > 0)
             Tabs.SelectedIndex = Tabs.SelectedIndex - 1;
         else
             Tabs.SelectedIndex = Tabs.TabPages.Count - 1;
     }
     else if (e.Control)
     {
         e.Handled = true;
         if (chatFormTabs.SelectedIndex < chatFormTabs.TabPages.Count - 1)
             chatFormTabs.SelectedIndex = chatFormTabs.SelectedIndex + 1;
         else
             chatFormTabs.SelectedIndex = 0;
     }
} 
```

我喜欢 Form KeyDown 事件中的这种情况，但它对我不起作用。

谁能建议我该怎么做：

*   TextBox 将接受制表键并将“\t”字符添加到当前位置。
*   我将能够通过 Ctrl+Tab 或 Ctrl+Shift+Tab 更改选项卡。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-23T17:39:23.293

试试[PreviewKeyDown 事件](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.previewkeydown.aspx)。我有一个类似的问题（接受箭头键），效果很好。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-23T17:14:36.183

Textbox won't accept the tab unless you are in multi-line mode. Switch to multiline mode by setting the multiline property to true. Then, add the following in your KeyPress event of your textbox control.

```
if (e.KeyChar == '\t' || e.KeyChar== (char)13)
            e.Handled = true; 
```

The above code means, don't do anything by default when tab or enter key is pressed.

After that, add the following code to your KeyDown event of your textbox control:

```
 if (e.KeyCode == Keys.Tab)
  {
     textBox1.AppendText(@"\t");
  } 
```

Inside the braces of the above code, handle whatever you want to do when the tab key is pressed.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-12-28T07:22:04.717

[TextBox.TabStop 属性](http://msdn.microsoft.com/en-us/library/ff836316.aspx) [TextBoxBase.AcceptsTab 属性](http://msdn.microsoft.com/en-us/library/system.windows.forms.textboxbase.acceptstab%28v=vs.110%29.aspx) 可以使用 TabStop 属性指定是否可以使用 TAB 键将焦点移动到控件。读/写布尔值。

# python - 为什么在安装 simplejson 时出现“无法编译 C 扩展”？

> ID：12554230
> 
> 赞同：4
> 
> 时间：2012-09-23T16:53:56.927
> 
> 标签：python, windows, visual-studio, python-extensions

顺便说一句，我使用的是 Windows，所以我必须安装 Visual Studio 吗？

```
(py) D:\python>pip install simplejson
Downloading/unpacking simplejson
  Downloading simplejson-2.6.2.tar.gz (53kB): 53kB downloaded
  Running setup.py egg_info for package simplejson

Installing collected packages: simplejson
  Running setup.py install for simplejson
    building 'simplejson._speedups' extension
    *************************************************************************** 
```

**警告：无法编译 C 扩展，未启用加速。**

```
 Failure information, if any, is above.
    I'm retrying the build without the C extension now.

    ***************************************************************************

    ***************************************************************************
    WARNING: The C extension could not be compiled, speedups are not enabled.
    Plain-Python installation succeeded.
    ***************************************************************************
Successfully installed simplejson
Cleaning up... 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-23T19:20:25.460

为了能够在 Windows 上编译 Python C 扩展模块，您需要安装正确版本的 Visual Studio。请参阅[在 Windows 上构建 C 和 C++ 扩展](http://docs.python.org/extending/windows.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-23T17:08:32.413

这是因为 simplejson 显然包含一些 C 扩展代码来抵消一些处理这提高了速度和效率，但是该人非常友好地为无法编译 python 代码的 c 扩展的机器提供了纯 python 替代方案。其他模块（如 SQLAlchemy 和hiredis）也是如此

# android - 如何通过 HTML 在 TextView 中设置文本位置？

> ID：12554231
> 
> 赞同：0
> 
> 时间：2012-09-23T16:54:01.063
> 
> 标签：android, html, textview

我的应用程序中有一个 TextView，用户可以使用应用程序设置中的 HTML 在此 TextView 中设置任何文本。用户必须能够使用 HTML 标记在此 TextView 中设置文本部分的位置。但是 TextView 不支持 'table' 标签或 CSS。而且我不知道如何设置位置。是否有一些标签来设置位置？或者，HTML.TagHandler 是否可行？如果有可能 - 如何？

两个例子：

1.  我想用 HTML 为这个 TextView 中的一行设置 align="center"。

2.  我想将文本分成两列或三列。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T05:05:56.760

You can try `<div align="center">Your line here</div>`.

[Check out this article to see all the supported HTML tags](http://commonsware.com/blog/Android/2010/05/26/html-tags-supported-by-textview.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T17:21:34.173

我认为您所描述的是像[TinyMCE](http://www.tinymce.com)或[CKEditor](http://ckeditor.com)这样的所见即所得编辑器。这些将允许您对齐文本或使用表格将文本分成多列。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-23T17:24:18.257

要设置对齐，行必须有它的 id 或类，没有它也许你可以使用 jquery 在其中找到所需的行 ant 对齐文本。

也许文本被分成段落，而不是你可以用 jquery 找到需要的段落。

要将文本拆分为列并不容易，请尝试以下操作：[如果我使用 Javascript 和 CSS 为数据库动态获取文本，如何将文本划分为列？](https://stackoverflow.com/questions/8605637/how-to-divide-text-into-columns-if-i-get-text-dynamically-for-database-using-ja)

# mysql - sql联合错误

> ID：12554232
> 
> 赞同：0
> 
> 时间：2012-09-23T16:54:14.830
> 
> 标签：mysql, sql

我总是得到“使用的选择语句有不同的列数”错误。

```
select Sublessee_uname, Sublessee_fname, Sublessee_mname, Sublessee_fname from sublessee
union
select Sublessee_space, Sublessee_product from space_reserve 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T16:54:57.417

该错误几乎是不言自明的。在第一个`SELECT`你有**4 列**，而在第二个你有**2 个列**。为了使用`UNION`，两个 s 中的列数`SELECT`必须匹配。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T22:16:04.520

根据您的一些评论，在我看来您需要*加入*而不是它们的*联合*。

通常，要连接两个表，其中一个必须有一列或多列引用另一个。由于您的查询中显示的列似乎不包含在连接条件中使用的正确列，而且我现在不知道您的两个表拥有哪些其他列，我将假设有一个`Sublessee_Id`列在两个表中。检索所需数据的查询将如下所示：

```
SELECT
  s.Sublessee_uname,
  s.Sublessee_fname,
  s.Sublessee_mname,
  s.Sublessee_fname,
  r.Sublessee_space,
  r.Sublessee_product
FROM sublessee s
LEFT JOIN space_reserve r  /* or, depending on the requirements,
                              INNER JOIN space_reserve r */
  ON s.Sublessee_Id = r.Sublessee_Id
; 
```

如果你想了解更多关于 JOIN 语法的信息，你可以试试这个手册页：

*   [`JOIN`语法 (MySQL)](http://dev.mysql.com/doc/refman/5.6/en/join.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-23T16:56:09.353

在一个`union`列数需要匹配。尝试

```
select Sublessee_uname, Sublessee_fname, Sublessee_mname, Sublessee_fname
from sublessee     
union
select Sublessee_space, Sublessee_product, null, null
from space_reserve 
```

[简化的小提琴示例](http://sqlfiddle.com/#!2/92d56/1)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-23T17:04:10.217

**在联合情况下，查询中的列数应相同供您参考，请检查此** [联合](http://www.w3schools.com/sql/sql_union.asp)

# jquery - 比较元素

> ID：12554233
> 
> 赞同：0
> 
> 时间：2012-09-23T16:54:15.340
> 
> 标签：jquery

```
for (index=1; index<=15; index++) {
    if (undefined != sku[index]) {

        found = jQuery.inArray(sku[index], mr_sku); 
        if( found == -1){ //not in array
            alert( sku[index] + " NOT FOUND - delete index " + index );
        } else { // in array
                  alert("FOUND");
        }

  } 
```

}

两个数组 - sku 和 mr_sku = 试图找到从 1 到 15 的值，其中未定义值在两个数组中。sku[1] 和 mr_sku 我知道是相同的值 - 只是永远不会在数组中显示为 bieng - inarray 总是返回为 -1

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T17:40:26.613

用虚拟数据测试，它工作正常。这是[jsfiddle](http://jsfiddle.net/sahil_kapoor/mMZjh/)，这是我使用的数据：

```
var sku = ['a','b','c'];
var mr_sku = ['a','c','c'];

for (index=1; index<=2; index++) {
    if (undefined != sku[index]) {

        found = jQuery.inArray(sku[index], mr_sku); 
        if( found == -1){ //not in array
            alert( sku[index] + " NOT FOUND - delete index " + index );
        } else { // in array
                  alert("FOUND");
        }

  }
}​ 
```

# c++ - NtQuerySystemInformation 挂钩失败

> ID：12554235
> 
> 赞同：2
> 
> 时间：2012-09-23T16:54:35.907
> 
> 标签：c++, api, winapi, hook

在成功搭建蹦床并详细了解进程内存空间后，我在 MessageBoxA 上测试了蹦床。它工作得很好，所以我决定最终将代码用于它应该首先用于的用途，通过挂钩 NtQuerySystemInformation 隐藏一个进程。重定向功能应该可以正常工作，但是我用来编写 jmp 指令的代码现在每次都会导致任务管理器崩溃。

```
 BYTE tmpJMP[5] = {0xE9,0x00,0x00,0x00,0x00}; //jmp,A,D,D,R
        memcpy(JMP,tmpJMP,5);
        DWORD Addr = ((DWORD)func - ((DWORD)oNtQuerySystemInformation + 0x5));

        for (int i=0;i<4;++i)
            JMP[i+1] = ((BYTE*)&Addr)[i];

        if (VirtualProtect((LPVOID)oNtQuerySystemInformation,5,PAGE_EXECUTE_READWRITE,&oldProtect) == FALSE)
            MessageBox(NULL,L"Error unprotecting memory",L"",MB_OK);

        memcpy(oldBytes,(LPVOID)oNtQuerySystemInformation,5);

        if (!WriteProcessMemory(GetCurrentProcess(),(LPVOID)oNtQuerySystemInformation,(LPCVOID)JMP,5,NULL))
            MessageBox(NULL,L"Unable to write to process memory space",L"",MB_OK);

        VirtualProtect((LPVOID)oNtQuerySystemInformation,5,oldProtect,NULL);

        FlushInstructionCache(GetCurrentProcess(),NULL,NULL); 
```

我是这样写到内存中的。我似乎找不到代码的问题。我在想，也许 API 之间的内存会发生变化，但有人告诉我这是不正确的，这让我很困惑。大家看到有什么不对吗？请描述性。我爱学习o3o

# c++ - 隐藏由 system() 调用的命令提示符；

> ID：12554237
> 
> 赞同：1
> 
> 时间：2012-09-23T16:54:38.297
> 
> 标签：c++, windows

Goodday，我有脚本，循环目录中的所有文件，但我需要隐藏控制台，同时以这种方式循环它们。这是脚本的一部分：

```
#include <iostream>
#include <fstream>
#include <Windows.h>
using namespace std;

 int GetFilesInDirectory(const char * dir,string dest[],unsigned int max){
    string loc=dir;
    int ctr=0;
    if(loc.length()>2)
        if(loc.substr(loc.length()-2,1)=="\\")
            loc=loc.substr(0,loc.length()-1);
    string opcommand;
    string delcommand;
    if(loc.length()>2){
        opcommand="cd "+(loc)+" && dir /s /b /a > tmpfile.cpptmp";
        delcommand="cd "+(loc)+" && del tmpfile.cpptmp";
    } else {
        opcommand="dir /s /b /a > tmpfile.cpptmp";
        delcommand="del tmpfile.cpptmp";
    }
    system(opcommand.c_str());
    ifstream f;
    string line;
    string fileloc;
    if(loc.length()>2)
        fileloc=(loc)+"\\tmpfile.cpptmp";
    else fileloc="tmpfile.cpptmp";
    f.open(fileloc,ios::binary);
    while(f.good()){
        getline(f,line);
        if(line.length()>1&&ctr<max){
            dest[ctr]=line;
            ctr++;
        }
    }
    f.close();
    system(delcommand.c_str());
    return ctr;
}
int main() {
    FreeConsole();
    const unsigned int filescountmax=16184;

    string files[filescountmax];
    int count=GetFilesInDirectory("\\",files,filescountmax);
    string ext;
    for(int i=0;i<count;i++){
            //some script

    }
} 
```

当进程启动时，它会自行隐藏它，但之后它会显示 cmd.exe，它会自行关闭它。顺便说一句，我知道还有其他方法可以循环目录中的文件，但这是循环子目录和子目录的子目录等中的文件的最简单方法。你能帮我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T17:17:21.040

您可以更改子系统以使 Windows 隐藏控制台。在您的源代码中添加此命令：

`#pragma comment(linker, "/subsystem:\"windows\" /entry:\"mainCRTStartup\"" )`

或者，您可以尝试`CreateProcess`使用 flag 的功能`CREATE_NO_WINDOW`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T19:13:27.410

这是我为此类任务编写的系统功能的模拟。

```
int system_hidden(const char *cmdArgs)
{
    PROCESS_INFORMATION pinfo;
    STARTUPINFO sinfo;

    /*
     * Allocate and hide console window
     */
    AllocConsole ();
    ShowWindow (GetConsoleWindow(), 0);

    memset (&sinfo, 0, sizeof (sinfo));
    sinfo.cb = sizeof (sinfo);
    CreateProcess (NULL, (char*)cmdArgs,
                   NULL, NULL, false,
                   0,
                   NULL, NULL, &sinfo, &pinfo);
    DWORD ret;
    while (1)
    {
        HANDLE array[1];
        array[0] = pinfo.hProcess;
        ret = MsgWaitForMultipleObjects (1, array, false, INFINITE,
                                         QS_ALLPOSTMESSAGE);
        if ((ret == WAIT_FAILED) || (ret == WAIT_OBJECT_0))
            break;
        /*
         * Don't block message loop
         */
        MSG msg;
        while (PeekMessage (&msg, 0, 0, 0, PM_REMOVE))
        {
            TranslateMessage (&msg);
            DispatchMessage (&msg);
        }
    }

    DWORD pret;
    GetExitCodeProcess (pinfo.hProcess, &pret);
//    FreeConsole ();
    return pret;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-03-10T22:36:02.763

我注意到接受的答案有点太复杂了。`cmd.exe`这是在没有新窗口的情况下执行命令的更简单方法。根据[Roland Rabien](https://stackoverflow.com/a/1597315/6850771)和[MSDN](https://msdn.microsoft.com/en-ca/library/windows/desktop/ms682425(v=vs.85).aspx)的回答：

```
int windows_system(const char *cmd)
{
  PROCESS_INFORMATION p_info;
  STARTUPINFO s_info;
  LPSTR cmdline, programpath;

  memset(&s_info, 0, sizeof(s_info));
  memset(&p_info, 0, sizeof(p_info));
  s_info.cb = sizeof(s_info);

  cmdline     = _tcsdup(TEXT(cmd));
  programpath = _tcsdup(TEXT(cmd));

  if (CreateProcess(programpath, cmdline, NULL, NULL, 0, 0, NULL, NULL, &s_info, &p_info))
  {
    WaitForSingleObject(p_info.hProcess, INFINITE);
    CloseHandle(p_info.hProcess);
    CloseHandle(p_info.hThread);
  }
} 
```

适用于所有 Windows 平台。像你一样打电话`system()`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-09-05T04:07:51.270

我用这个，只支持run block cmd。比如在destktop中创建shortcat，比如打开notepad.exe编辑文件等等。

```
#define MAX_SYSTEM_PROGRAM (4096)
static int windows_system(const wchar_t *cmd)
{
    PROCESS_INFORMATION p_info;
    STARTUPINFO s_info;
    DWORD ReturnValue;

    memset(&s_info, 0, sizeof(s_info));
    memset(&p_info, 0, sizeof(p_info));
    s_info.cb = sizeof(s_info);

    wchar_t utf16cmd[MAX_SYSTEM_PROGRAM] = {0};
    MultiByteToWideChar(CP_UTF8, 0, cmd, -1, utf16cmd, MAX_SYSTEM_PROGRAM);
    if (CreateProcessW(NULL, utf16cmd, NULL, NULL, 0, 0, NULL, NULL, &s_info, &p_info))
    {
        WaitForSingleObject(p_info.hProcess, INFINITE);
        GetExitCodeProcess(p_info.hProcess, &ReturnValue);
        CloseHandle(p_info.hProcess);
        CloseHandle(p_info.hThread);
    }
    return ReturnValue;
} 
```

# php - log4php - 设置布局模式以显示文件名

> ID：12554239
> 
> 赞同：2
> 
> 时间：2012-09-23T16:54:42.263
> 
> 标签：php, logging, filenames, log4php, pattern-layout

我`log4php`用来记录消息`php`。我有以下xml配置

```
<configuration xmlns="http://logging.apache.org/log4php/">
    <appender name="myAppender" class="LoggerAppenderFile">
        <layout class="LoggerLayoutPattern">
            <param name="conversionPattern" value="%d{Y-m-d H:i:s} %c %-5p %F %L %m%n" />
        </layout>
        <param name="file" value="myLog.log" />
    </appender>

    <root>
        <level value="TRACE" />
        <appender_ref ref="myAppender" />
    </root>
</configuration> 
```

相关部分是

```
<param name="conversionPattern" value="%d{Y-m-d H:i:s} %c %-5p %F %L %m%n" /> 
```

这`%F`是获取文件名的说明符。这是将消息记录到日志文件中。这是一个示例记录的消息：

> 2012-09-23 22:15:04 myLog 致命 /media/study/code/live/public_html/log.php 18 我的消息。

### 问题

我只想显示文件名（`log.php`在这种情况下）而不是文件的完整路径（`/media/study/code/live/public_html/log.php`）。已搜索[Apache 文档](http://logging.apache.org/log4php/docs/layouts/pattern.html)和 SO，但在此参考中找不到任何内容。

任何提示如何实现这一目标？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-12T23:06:41.533

只需添加一点代码帮助即可完成此任务。

毫不奇怪，模式布局被配置`layouts/LoggerLayoutPattern.php`并具有一个冗长的数组`protected static $defaultConverterMap`，该数组定义了转换模式中理解的所有模式。如您所见，字母“F”与 中的`LoggerPatternConverterFile`类相关联`patterns/LoggerPatternConverterFile.php`。快速浏览显示：

```
public function convert(LoggerLoggingEvent $event) {
    return $event->getLocationInformation()->getFileName();
} 
```

这就是导致完整文件路径的原因。添加对 basename() 函数的调用将返回所需的结果，但请注意，这不会在 Log4PHP 更新后继续存在。不过，您可以添加它，然后就完成了。

如果您想要持久更改，则必须扩展上述两个类并将它们添加到您自己的自动加载或包括：

首先扩展 LoggerPatternConverterFile。这将为您带来相关文件的基本名称：

```
class LoggerPatternConverterFileBasename extends LoggerPatternConverterFile
{
    public function convert(LoggerLoggingEvent $event) {
      return basename(parent::convert($event));
    }
} 
```

二扩展LoggerLayoutPattern类

```
class YourLoggerLayoutPattern extends LoggerLayoutPattern {
  public function __construct() {
    parent::__construct();
    $this->converterMap['f'] = 'LoggerPatternConverterFileBasename';
  }
} 
```

这样，您刚刚定义了“小写字母 f”，您只会看到文件的基本名称。

在您的配置中，您只需使用更改后的转换字符串引用这个新的 YourLoggerLayoutPattern 类。

此更改应在 log4php 更新后继续存在。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-23T17:22:23.633

正如斯文在他的回答中所解释的那样，这将需要一个简单的努力。但是我想出了一个解决方法，如下所示：

不要`conversionPattern`在 log4php 配置中放入任何文件格式，而是将文件名作为 php.ini 的初始部分传递。所以，代码

### log4php 配置：

```
'conversionPattern' => '%d{H:i:s Y-m-d} %c %-5p - %m%n' 
```

然后在 php 中将其称为：

```
$log->info(basename($_SERVER['PHP_SELF']).":".__LINE__": Your message/debug details here"); 
```

所以，如果你能接受这种格式（而且你总是卡在中间显示文件名），这将是一个很好的解决方法。

# javascript - 如何从asp.net 中动态创建的文本框调用javascript？

> ID：12554244
> 
> 赞同：-1
> 
> 时间：2012-09-23T16:55:09.653
> 
> 标签：javascript, asp.net, c#-4.0, dynamic, textbox

```
 // Assign Context-Menu to Control
    $(function () {
        var txt1 = "#" + "<%= **myCal**.ClientID %>";

        // Attach Context-Menu to Control
        $(txt1).contextMenu(ctxtMenu, { theme: 'vista' });
    }); 
```

**背后的代码**

```
 TextBox lbl = new TextBox ();
            lbl.BorderColor = System.Drawing.Color.Black;
            lbl.BorderStyle = BorderStyle.Double;
            lbl.BackColor = System.Drawing.Color.BlanchedAlmond;
            lbl.Text = eventname + "<br/>" + dt + "" + dt1;
            e.Cell.Controls.Add(lbl); 
```

我想使用动态创建的 asp.net TextBox 代替 myCal

我该怎么办？请帮忙

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T16:59:08.233

您可以为此控件定义一个 CSS 类：

```
lbl.CssClass = "menu"; 
```

然后使用类选择器：

```
$(function () {
    // Attach Context-Menu to Control
    $('.menu').contextMenu(ctxtMenu, { theme: 'vista' });
}); 
```

# jquery - 如何列出所有的孩子

> ID：12554246
> 
> 赞同：3
> 
> 时间：2012-09-23T16:55:16.043
> 
> 标签：jquery, html

我的 php 将抓取随机行并写入 <ul> 和 <li> 并使用 html5 可排序

```
<ul id='sortable_A'>
<li>A1</li>
<li>A2</li>
<li>A3</li>
<li>A4</li>
</ul> 
```

所以现在我如何使用 jquery 以这种方式获取所有子级 var li_A = A1,A2,A3,A4 在我得到它之后，然后我将使用它来相应地更新数据库

ps：或者有其他更好的方法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-23T16:57:34.307

你可以做

```
 // Get all elements
var li_A = $('#sortable_A li')
           // Iterate on the elements and create an array 
            .map(function() {
                return $(this).text();
            })
            // Get the array
            .get()
            // join the values
            .join(','); 
```

[http://jsfiddle.net/nicolapeluchetti/hhkaV/](http://jsfiddle.net/nicolapeluchetti/hhkaV/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T16:58:30.090

```
var ul = $('ul').html(); 
```

如果您愿意，可以使用该`.each()`方法将列表转换为数组。

你应该看看[jquery docs](http://api.jquery.com)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-23T17:00:17.127

你可以试试这样的

```
 var listElements = $("ul#sortable_A li:not(:empty)"); 
```

列出所有 不为空的**li 元素**

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-23T17:25:00.630

你也可以这样做：

```
var li_A = [];
$('#sortable_A li').each(function(){
    li_A.push($(this).html());
}); 
```

上面的代码为您提供了一个字符串数组。此外，如果你想要一个逗号分隔的字符串，那么你可以这样做：

```
var str = li_A.toString(); 
```

# c# - 存储 PictureEdit.Image 的 NULL 值

> ID：12554256
> 
> 赞同：0
> 
> 时间：2012-09-23T16:56:30.643
> 
> 标签：c#, winforms, devexpress

我的表单中有一个 PictureEdit 和一个按钮，用于将此 PictureEdit.Image 保存到 SQL 数据库。

我写了这段代码：

```
Byte[] imgData = new ImageConverter().ConvertTo(auteurPhoto.Image, typeof(Byte[])) as Byte[];
                        row[11] = imgData == null ?
                           DBNull.Value :
                           imgData as Object; 
```

但是当 PictureEdit.Image 中没有图片时的问题，它将值 0x 存储在 Image 的列上，我想存储 NULL 值！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T20:05:52.863

尝试

```
row[11] = imgData == null || imgData.Length == 0 ? DBNull.Value : imgData as Object; 
```

反而。

# c# - 数组的值无故更改

> ID：12554267
> 
> 赞同：2
> 
> 时间：2012-09-23T16:57:07.820
> 
> 标签：c#, arrays, multidimensional-array, tic-tac-toe

**我正在尝试在井字**游戏中嵌入一个非常基本的 AI，但我在使用数组来识别最合适的方格时遇到了问题。

我有一个数组表示当前状态下的游戏网格，另一个表示如果某个方格被认领时的样子。

人工智能不断做出奇怪的决定，所以我决定让它在某些里程碑报告各种信息。

```
string[,] currentGrid;
string[,] hypotheticalGrid;

MessageBox.Show(currentGrid);

hypotheticalGrid = currentGrid;
hypotheticalGrid[x, y] = "O";

MessageBox.Show(currentGrid); 
```

> 请记住，上面是实际代码的非常简化的版本。

数组沿线分配值，消息框设置为将 currentGrid 显示为其包含的值的序列。

除了消息框之间的代码外，一切正常。

问题是两个消息框显示不同的结果，即使后者是前者的副本，并且在两者之间的空间中没有指定对 currentGrid 的更改。

中间的两行是直接从源代码复制的，应该只影响假设的网格。应该很明显，这些线应该重置假设的网格，然后在有问题的正方形上添加一个“O”。

但是，由于某种原因，“O”也被放置在当前网格中。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-23T17:00:38.843

该行`hypotheticalGrid = currentGrid;`不会复制`currentGrid`，而是两个变量都指向同一个数组。因此，在 hypotheticalGrid 中所做的任何更改也会在 currentGrid 中看到。

您应该让 hypotheticalGrid 成为 currentGrid 的副本：

```
hypotheticalGrid = (string[,])currentGrid.Clone(); 
```

在这种情况下，`Clone()`它将起作用，因为字符串在 .NET 中是不可变的。在其他情况下，`Clone`可能还不够好，只是需要注意一些事情。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-23T16:59:42.883

问题是你的任务：

```
hypotheticalGrid = currentGrid; 
```

仅仅是一个**引用赋值**，这意味着现在它们都指向内存中的同一个数组，因此对假设网格的任何更改也会影响当前网格。

您需要完整的项目副本，以使它们不会相互干扰。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-23T17:08:15.613

请记住，数组是引用类型。您的分配复制了引用，但不会创建数组的副本。赋值后两个数组变量都指向同一个数组！

您可以像这样创建一个数组副本：

```
string[] hypotheticalGrid = new string[currentGrid.Length];
Array.Copy(currentGrid, hypotheticalGrid, currentGrid.Length); 
```

请注意，这不会创建数组中包含的项目的副本，但这不是问题，因为字符串是不可变的。即，如果您在其中一个数组中操作字符串，则会创建一个新字符串，因此对第二个数组没有影响。

* * *

编辑：

通过查看其他帖子，我发现使用该`Clone`方法可以更轻松地完成：

```
string[] hypotheticalGrid = currentGrid.Clone(); 
```

# javascript - 使用 HTTP 开发人员 API 托管 XMPP 服务

> ID：12554269
> 
> 赞同：2
> 
> 时间：2012-09-23T16:57:22.523
> 
> 标签：javascript, websocket, xmpp, chat, instant-messaging

是否有任何服务支持 XMPP Server 以及允许 xml/json http 请求发送/接收 IM 的开发人员 API？

我正在尝试构建一个连接到我的 jaber/xmpp IM 客户端的网络聊天系统。我正在尝试做的是整合我目前为我的公司运营的东西，但添加网络聊天。

[http://www.olark.com/](http://www.olark.com/)提供了我想要的一切功能，但是我想构建自己的客户端界面/架构，因为 Olark 的定价在我计划在我的公司中发挥作用的规模上变得昂贵。

任何建议都会非常有帮助！

哦，顺便说一句，我正在使用 pusher.com 运行我的网络聊天，它完美无缺。问题是我想将 pusher 的 websockets 连接到我当前的 xmpp/jaber 网络中。

# javascript - 外selectAll：选择什么？

> ID：12554274
> 
> 赞同：2
> 
> 时间：2012-09-23T16:57:56.433
> 
> 标签：javascript, svg, d3.js

我正在学习 D3，以及如何使用 D3 的数据绑定机制将元素嵌套或附加到页面。

我修改了[http://www.recursion.org/d3-for-mere-mortals/](http://www.recursion.org/d3-for-mere-mortals/)上的代码。我了解如何设置 svg 画布，也了解将数据绑定到矩形、文本和线条元素的循环。

我不明白的是`selectAll('Anything1/2/3/4')`下面的电话。它们显然是必要的，但我究竟选择了什么，它们如何适应数据绑定机制？谢谢你。

```
 <html>
    <head>
        <title>D3 Test</title>
        <script type="text/javascript" src="d3/d3.v2.js"></script>
    </head>
    <body>

        <script type="text/javascript">

var dat = [ { title:"A", subtitle:"a", year: 2006, books: 54, avg:10 },
            { title:"B", subtitle:"b", year: 2007, books: 43, avg:10 },
            { title:"C", subtitle:"c", year: 2008, books: 41, avg:10 },
            { title:"D", subtitle:"d", year: 2009, books: 44, avg:10 },
            { title:"E", subtitle:"e", year: 2010, books: 35, avg:10 } ];

var width    = 560,
    height   = 500,
    margin   = 20,
    innerBarWidth =  20,
    outerBarWidth =  40;

var x = d3.scale.linear().domain([0, dat.length]).range([0, width]);
var y = d3.scale.linear()
    .range([0, height - 2 * margin])
    .domain([ 0 , 100 ]);

var z = d3.scale.category10();

var n = d3.format(",d"),
    p = d3.format("%");

var canvas = d3.select("body").append("svg")
    .attr("width", width)
    .attr("height", height)
    .append("g")
    .attr("transform", "translate(" + 2 * margin + "," + margin + ")");

// outerbars
var outerBars = d3.select("svg")
  .selectAll("Anything1").data(dat).enter().append("rect")
  .attr("x", function(datum, index) { return x(index); })
  .attr("y", function(datum) { return height - y(datum.books); })
  .attr("height", function(datum) { return y(datum.books); })
  .attr("width", outerBarWidth)
  .attr("fill", "blue")

// innerbars
var innterBars = d3.select("svg")
  .selectAll("Anything2").data(dat).enter().append("rect")
  .attr("x", function(datum, index) { return x(index)+innerBarWidth/2; })
  .attr("y", function(datum) { return height - y(datum.books)/2; })
  .attr("height", function(datum) { return y(datum.books); })
  .attr("width", innerBarWidth)
  .attr("fill", "red");

// avg references
var barlabels = d3.select("svg")
  .selectAll("Anything3").data(dat).enter().append("line")
  .attr("x1", function(datum, index) { return x(index); })
  .attr("x2", function(datum, index) { return x(index)+outerBarWidth; })
  .attr("y1", function(datum) { return height - y(datum.books)/2; })
  .attr("y2", function(datum) { return height - y(datum.books)/2; })
  .style("stroke", "#ccc");

// titles
var barlabels = d3.select("svg")
  .selectAll("Anything4").data(dat).enter().append("text")
  .attr("x", function(datum, index) { return x(index)+innerBarWidth/2; })
  .attr("y", height )
  .attr("text-anchor", "end")
  .text(function (d) {return d.title} );

        </script>
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-24T21:37:16.027

也许 d3 中最重要但最难理解的概念是[选择](https://github.com/mbostock/d3/wiki/Selections)（我强烈建议您添加书签并熟悉 API）。从表面上看，选择提供了与许多其他 JavaScript 库类似的功能，例如 jQuery：

jQuery：

```
var paragraphs = $("p"); 
```

d3：

```
var paragraphs = d3.selectAll("p"); 
```

这两行都创建了“选择对象”，它们本质上是 DOM 元素，它们被组合成一个对象，让您可以更好地控制元素。与其他库一样，您可以使用库中提供的函数在 d3 中操作这些“选定”元素。

jQuery：

```
var paragraphs = $("p").css("color", "red"); 
```

d3：

```
var paragraphs = d3.selectAll("p").style("color", "red"); 
```

同样，从表面上看，这很容易理解。[d3 如此强大的原因在于，它允许您将任意数据绑定到所选元素](https://github.com/mbostock/d3/wiki/Selections#wiki-data)，从而让您更进一步。

假设您有一个空白文档，并且想要添加几段文本 - 并且您将每段文本存储在数组中的单个元素中：

```
var text = ["First", "Second", "Third", "Fourth"]; 
```

由于我们尚未创建这些段落，因此以下调用将返回一个[空选择](https://github.com/mbostock/d3/wiki/Selections#wiki-empty)：

```
var paragraphs = d3.selectAll("p");
console.log(paragraphs.empty()); // true 
```

请注意，这`paragraphs`仍然是一个选择，它只是空的。这是 d3 的一个基本点。您可以将数据绑定到空选择，然后使用[输入的选择](https://github.com/mbostock/d3/wiki/Selections#wiki-enter)使用数据添加新元素。让我们从之前的示例重新开始，并逐步完成这个过程。首先，创建您的空选择并将`text`数组绑定到它：

```
var paragraphs = d3.select("body").selectAll("p").data(text); 
```

然后，使用输入选择，将元素附加`<p>`到正文：

```
paragraphs.enter().append("p").text(function(d) { return d; }); 
```

您的 DOM 现在将具有：

```
<body>
    <p>First</p>
    <p>Second</p>
    <p>Third</p>
    <p>Fourth</p>
</body> 
```

在这一点上肯定有很多事情会让你感到困惑，但我认为这应该会给你一个好的开始。

另请参阅：[使用联接思考](http://bost.ocks.org/mike/join/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-24T00:49:46.333

以下是一些帮助您入门的读物：

[理解 selectAll、data、enter、append 序列](http://knowledgestockpile.blogspot.ca/2012/01/understanding-selectall-data-enter.html)
[绑定数据：Scott Murray D3 Tutorials](http://alignedleft.com/tutorials/d3/binding-data/)

从第二个链接它解释：

> 答案在于 enter()，一个真正神奇的方法。这是此示例的最终代码，我将对其进行解释：
> 
> ```
> d3.select("body").selectAll("p")
>     .data(dataset)
>     .enter()
>     .append("p")
>     .text("New paragraph!"); 
> ```
> 
> `.selectAll("p")`— 选择 DOM 中的所有段落。由于尚不存在，因此这将返回一个空选择。将此空选择视为表示即将存在的段落。

基本上，您正在选择尚不存在的 DOM 元素，然后将数据附加到这些不存在的元素，然后在绑定数据后附加它们。

# algorithm - 如何添加大 O 和大欧米茄

> ID：12554278
> 
> 赞同：5
> 
> 时间：2012-09-23T16:58:52.180
> 
> 标签：algorithm, analysis, asymptotic-complexity, big-o

如果一个算法有两个子算法，当子算法 A1 对给定输入最好的情况下，它是子算法 A2 的最坏情况。我怎样才能找到整体算法的复杂性？我的意思是Ω（N）+ O（N）=？我知道算法是否按顺序执行顺序，总体复杂度为 O(N)+ O(N)，嵌套顺序为 O(N)* O(N)。

请告诉我在这两种情况下，按顺序和嵌套顺序

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-23T17:09:01.197

本质上 Ω(N) + O(N)= Ω(N)。因为 O(N) 表示 Ω(N) 的更低（或最多相同）阶。当它们相加时，可以省略较低的顺序。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-23T17:06:09.530

如果您的算法包括一个需要（例如）O(N) 时间的操作和另一个需要 O(N^2) 时间的操作，那么总体复杂度是 O(N^2)。没有像 O(N^2 + N) 这样的东西。Ω() 也是如此。这回答了您关于“顺序执行顺序”的问题。

如果您的算法包括 N 个操作，每个操作都需要 O(N) 时间，那么总体复杂度为 O(N^2)。Ω() 也是如此。您只需将多项式相乘，并采用随着 N 增加而增长最快的术语。这回答了您关于“嵌套执行顺序”的问题。

# extjs - Extjs 4.1.1 是否可以创建这样的网格？

> ID：12554280
> 
> 赞同：2
> 
> 时间：2012-09-23T16:59:00.657
> 
> 标签：extjs, grid, extjs4.1

是否可以创建如下所示的网格？我有两个具有许多关联的模型：

```
Ext.define('Question', {
extend: 'Ext.data.Model',
fields: [
    {name: 'questionId', type: 'int', convert: null},
    {name: 'content',     type: 'string'},
    {name: 'type',     type: 'int'},
],
hasMany  : {model: 'Answer', name: 'answers'},

idProperty: 'questionId'});

Ext.define('Answer', {
extend: 'Ext.data.Model',
fields: [
    {name: 'answerId', type: 'int', convert: null},
    {name: 'question_id', type: 'int'},//foreignKey
    {name: 'content',     type: 'string'},
    {name: 'isCorrect',     type: 'boolean'},
    {name: 'isMarked',     type: 'boolean'},
],
 associations: [
    { type: 'belongsTo', model: 'Question' }
],
idProperty: 'answerId'}); 
```

JSON 示例

```
{"data":[
{"questionId":4100,"content":"12:4?","type":"2","answers":
  [{"answerId":1051,"content":"11","isCorrect":true,"isMarked":false},    
   {"answerId":1052,"content":"11","isCorrect":false,"isMarked":false},      
   {"answerId":1053,"content":"11","isCorrect":false,"isMarked":false}
]},
{"questionId":4101,"content":"12:4?","type":"2","answers":
  [{"answerId":1054,"content":"11","isCorrect":true,"isMarked":false},    
   {"answerId":1055,"content":"11","isCorrect":false,"isMarked":false},      
   {"answerId":1056,"content":"11","isCorrect":false,"isMarked":false}
]}],"success":true} 
```

这是显示网格视图的链接 [http://imageshack.us/photo/my-images/834/examgrid.jpg/](http://imageshack.us/photo/my-images/834/examgrid.jpg/)

问题可以有不同数量的答案，或者如果不可能有相同数量的答案。复选框用于标记 isMarked 字段。

谁能给我举个例子？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-24T05:14:03.367

开箱即用，没有。使用视图，是的。但我建议您将答案嵌套在问题中，而不是使用单独的模型。您将不得不编写一个带有呈现答案的内部函数的 XTemplate。

使用这种方法，您将没有可排序的列。这将是更多的工作。

所以最后一个我也很感兴趣，这是一个没有任何格式的工作片段！

```
Ext.define('Image', {
    extend: 'Ext.data.Model',
    fields: [
        { name:'question', type:'string' },
        { name:'answer', type:'auto' }
    ]
});

Ext.create('Ext.data.Store', {
    id:'imagesStore',
    model: 'Image',
    data: [
        { question:'Drawing & Charts', answer: [{text: 'yes'}, {text: 'no'}] },
        { question:'Advanced Data', answer: [{text: 'yes'}, {text: 'no'}] },
        { question:'Overhauled Theme', answer: [{text: 'yes'}, {text: 'no'}] },
        { question:'Performance Tuned', answer: [{text: 'yes'}, {text: 'no'}] }
    ]
});

var imageTpl = new Ext.XTemplate(
    '<Table>',
    '<tpl for=".">',
        '<TR>',
               '<TD>{#}</TD>',
            '<TD>{question}</TD>',
            '<TD>',
                '<tpl for="answer">',
                    '{text}',
                '</tpl>',
            '</TD>',
        '</TR>',
    '</tpl>',
    '</Table>'
);

Ext.create('Ext.view.View', {
    store: Ext.data.StoreManager.lookup('imagesStore'),
    tpl: imageTpl,
    itemSelector: 'div.thumb-wrap',
    emptyText: 'No images available',
    renderTo: Ext.getBody()
}); 
```

和**[JSFiddle](http://jsfiddle.net/redYb/)**

# android - 为 Android 设备拉伸图像

> ID：12554281
> 
> 赞同：0
> 
> 时间：2012-09-23T16:59:03.990
> 
> 标签：android, resolution

我一直在为Android编写应用程序。我想将它用于更多设备（平板电脑、智能手机）。我试图在[http://developer.android.com/guide/practices/screens_support.html](http://developer.android.com/guide/practices/screens_support.html)找到一些信息，但它不能正常工作。

我想在不同的设备上自动拉伸图像，而不仅仅是在我的测试设备上。我为移动全屏（与我的手机具有相同的分辨率）绘制图像。但是，例如在平板电脑中它绘制不正确。我试图改变大小，它提供了几个文件夹（lhdpi、small、...）。当我尝试在平板电脑中再次启动它时，它变大了但仍然不正确（边缘有一个黑色空间）。我的应用程序中有几张图像，我也想保留与移动设备中相同的大小。请帮我。

对不起我的拼写错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T17:07:59.417

你必须自己保持纵横比。不要在所有文件夹（hdli、mdpi、ldpi）中放置相同大小的图像，如果是这种情况，他们认为为什么 android 提供不同的文件夹？以 0.75 : 1 : 1.5 的比例放置图像。它会起作用的。另外阅读有关 9 补丁图像，这将使您的生活更轻松。

# django - Tasypie，如何防止修改由 ForeignKey 链接的资源

> ID：12554284
> 
> 赞同：0
> 
> 时间：2012-09-23T16:59:08.467
> 
> 标签：django, tastypie

我有 2 个由外键链接的资源

我想在创建/修改 AJob 时将 AUser 资源设为只读

```
class AUser(ModelResource):
    class Meta:
        queryset = User.objects.all()
        resource_name = 'user'
        authentication = SessionAuthentication()
        authorization = Authorization()
        excludes = ['email', 'password', 'is_superuser', 'is_staff', 'is_active', 'date_joined', 'last_login']
    def can_update(self):
        return False  
    def can_create(self):
        return False
    def can_delete(self):
        return False
    def apply_authorization_limits(self, request, object_list):
        return object_list.filter(pk=request.user.pk)

class AJob(ModelResource):
    user = fields.ForeignKey( AUser, 'user', full=True)
    paused = fields.BooleanField(attribute='isPaused', readonly=True)
    hasRules = fields.BooleanField(attribute='hasRules', readonly=True)
    class Meta:
        queryset = Job.objects.all()
        resource_name = 'job'
        authentication = SessionAuthentication()
        api_name = 'v1'
        authorization = Authorization()
        allowed_methods = ['get', 'post', 'delete']

    def obj_create(self, bundle, request=None, **kwargs):
        return super(AJob, self).obj_create(bundle, request, user=request.user)

    def apply_authorization_limits(self, request, object_list):
        return object_list.filter(user=request.user) 
```

我尝试将 readonly=True 直接添加到 foreignKey 中，但是在补水时它会被忽略并违反约束，因为 user 是 null

如果在我的 POST AJob 请求中我追加

> "用户":{"id":"5","is_staff":false}

5 是当前用户

用户模型得到更新，删除管理员角色

似乎做 save_related 时的美味派没有检查任何授权

如何将此用户资源设置为只读？

我正在使用tastepie v0.9.12-alpha

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-24T09:07:30.660

您可以修改资源`save_related`内部的方法`AJob`并将其定义为不修改`AUser`. 您可以根据需要将 ForeignKey 定义为只读，但是您必须提供`dehydrate_user`方法并在内部获取要返回的值。这将是类似的东西`return bundle['data'].user`。

# c++ - 如何将 API 从 lex yacc 设置为 Program

> ID：12554288
> 
> 赞同：0
> 
> 时间：2012-09-23T16:59:50.793
> 
> 标签：c++, c, yacc, lex, flex-lexer

我创建了一个 .exe 文件，它可以解析由 lex 和 yacc 生成的表达式。但我这样做只是从屏幕获取输入，然后从屏幕返回解析器结果。我看到了一些关于使用的建议`YY_BUFFER_STATE yy_scan_buffer(char *base, yy_size_t size)`，但我仍然找不到一个好的方法来做到这一点。

是否有可能我将一些头文件（由 lex yacc 编译）放到我的主程序 c++ 中，然后我可以使用 yylex() 调用它，给一个字符串作为输入，并在主程序中获取返回值？感谢您的帮助，我对如何实现它感到困惑。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-06T17:09:30.830

`yy_scan_string`是你如何给 flex 一个字符串作为输入。您首先调用它，然后调用`yylex`它，它将使用该字符串作为输入从而不是`stdin`. 当您从 获得 EOF 时`yylex`，它已经扫描了整个字符串。`yy_delete_buffer`然后，您可以调用`YY_BUFFER_STATE`返回的 by `yy_scan_string`（以释放内存）并`yy_scan_string`在要扫描新字符串时再次调用。

您可以`yy_scan_buffer`改为使用来节省一些复制，但是您必须自己正确设置缓冲区（基本上，它需要以*两个*NUL 字节而不是一个字节结束）。

不幸的是，flex 没有标准的头文件来声明这些。因此，您需要自己在某处声明它们（复制 flex 文档中的声明），或者在`.l`文件的第 3 部分调用它们，该部分被逐字复制到`lex.y.c`文件末尾。

# windows - 从tomcat远程安装软件

> ID：12554290
> 
> 赞同：0
> 
> 时间：2012-09-23T16:59:55.223
> 
> 标签：windows, tomcat7

我正在使用tomcat7、jsf2、spring等框架。我是新来的。

我有一个关于远程安装或向远程计算机发送命令行的问题。

我有这种情况：

1.  我有注册任务的 Tomcat 服务器（Windows）。
2.  注册后，服务器必须向远程站（Windows）发送任何命令以启动该任务的简单文件。

是否可以？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T09:25:24.720

如果有人对此感兴趣，我使用了这个工具（用于 Intranet）：

1.  Spring Quartz（执行作业）
2.  xcmd（使用运行时发送此命令）

# c# - 如何创建一个命令行应用程序来强制对某些其他应用程序使用代理？

> ID：12554293
> 
> 赞同：1
> 
> 时间：2012-09-23T17:00:13.153
> 
> 标签：c#, proxy

我基本上想做的是创建一个命令行替代[widecap](http://widecap.ru)。我如何想象这件事：

1.  外部应用程序调用我的命令行工具并将代理作为参数传递
2.  命令行工具启动并重定向通过作为参数传递的代理调用它的应用程序的所有 Web 流量
3.  外部应用程序完成后关闭命令行工具

我不想直接在外部应用程序代码中实现代理支持的原因是我不会一直编写外部应用程序。我希望它是一个任何人都可以使用的独立工具。

您可以给我的任何指示/反馈/建议/链接/想法将不胜感激。

编辑：为了更清楚起见，我想看一个 C# 中的代码示例，它演示了我如何“挂钩”正在运行的进程并通过代理隧道传输其所有 Web 流量。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-06T10:41:40.080

如果不反编译/反汇编外部程序并编辑其代码以执行您的要求，您将无法执行您的要求。另一种解决方案是对您的 C# 应用程序进行编程以捕获外部应用程序的数据包并将它们重定向到您的代理服务器。这将很难实现，但它会解决你的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T17:57:58.967

问题在于您希望在多个应用程序之间共享它。基本的最佳实践方法是为每个程序提供以下选项：

```
Manual Settings
None (ignore proxy)
System System Settings
Auto Detect 
```

从您所说的看来，您希望在许多彼此没有关系的应用程序之间共享设置，但不是所有倾向于破坏模型的应用程序。

现在为了争论，如果所有这些应用程序都是同事等。在共同的开发模式下构建一套工具是可能的，但如果不是这种情况，那就很困难了。

我认为这可行的唯一方法是利用本地代理服务器来获取打开的应用程序/进程的名称并将流量重定向到系统代理或自定义代理设置。这就是虚拟机的功能，但在这些类型的程序中往往会不断地努力正确识别所有应该重定向的相关和子进程。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-25T00:35:56.550

在 Windows 7 和 Vista 中，UAC 直接尝试阻止这种行为，这就是大多数代理程序往往会出现问题的原因。

以下是我知道的 2 个不错的选择（两者都具有相同的名称）：

免费一份： http: [//sourceforge.net/projects/proxifier/](http://sourceforge.net/projects/proxifier/) 付费一份： http: [//www.proxifier.com/download.htm](http://www.proxifier.com/download.htm)

我会尝试第一个，因为我记得它支持命令行参数而没有太多麻烦。我对列出的第二个有问题，但它可能更适合您的需求。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-21T19:42:55.253

代理服务器就是服务器！如果发送给他们的数据包可以捕获它们，则监听特定的端口号。您的问题存在一个歧义：

1.  应用程序连接到代理接口并设计消息语言（应用程序知道使用代理）。
    在这种情况下，您的工作是编写代理服务器应用程序。

2.  强制应用程序使用代理接口。（应用程序不知道使用接口）

    在这种情况下，您可以使用网络接口上层驱动程序（例如 wincap）
    来实现所有数据包，并在短期内编写您的数据包嗅探+防火墙工具
    ，与 cain &able 或 WireShark 相同，并对数据包目标端口号进行一些过滤，
    并做好您的充分准备工作
    建议您确定快速和弱工具方式（1）或
    长时间工作和复杂的工具（2）。
    祝你好运

# ruby-on-rails - 基于来自 Ajax 的实例变量动态更新页面

> ID：12554296
> 
> 赞同：2
> 
> 时间：2012-09-23T17:00:21.637
> 
> 标签：ruby-on-rails, ajax, partial

更新：我的问题得到了回答，但我写了一篇博文，详细说明了我是如何做到这一点的：http: [//lathamcity.com/posts/ajaxInRails.html](http://lathamcity.com/posts/ajaxInRails.html)

我有一个页面显示基于 Ruby 对象的事物列表。我的目标是进行 Ajax 调用以获取新的 Ruby 对象，然后根据该对象更新列表。

我认为这样做的方法是使用部分。我用代码中的 Rails 实例变量使整个列表成为部分文件。然后我希望 Ajax 调用将相应的实例变量设置为新列表并重新渲染部分。

这是最终目标，但现在我正在尝试做一个非常基本的版本，我只是将一个实例变量设置为一个字符串，然后显示该字符串。

所以在我的 div 中，我有：

```
<% form_tag :action => :go , :method => :get, :remote => true  do %>
    <%= submit_tag "Go" %>
<% end %>

<div id="test"><%= render(:partial => 'test') %></div> 
```

在（我的控制器的名称）文件夹中有一个 _test.erb 文件，`views/interface`其内容只有以下行：

```
<%= @test %> 
```

然后在我的控制器中，

```
def go
    @test = "Hello You"
    render :update do |page|
        page.replace_html "test", :partial => "test"
    end
end 
```

当我运行它时，我得到： `Missing template interface/update, application/update`

我不太了解`render :update`，我在谷歌的一个例子中找到了它。

我做错了什么导致这个问题，我该如何解决？我是以正确的方式解决这个问题还是有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-23T17:58:56.403

我认为两者都在 Rails 3.1 中被弃用/删除`render :update`。`replace_html`进行部分更新的标准方法是使用 js.erb 模板。

在您的控制器中，告诉您的操作以响应 js 请求：

```
@test = "Hello you"
respond_to do |format|
    format.js
end 
```

创建 js 响应模板 app/views/interface/go.js.erb：

```
$('#test').html("<%= escape_javascript(render('test', test: @test})) %>") 
```

并将部分代码更改为，`<%= test %>`因为这不再是实例变量；相反，测试作为来自 js.erb 模板的参数传递给部分`test: @test`

# point-cloud-library - 如何解决在点云库中找不到 vtkAppendPolyData.h 文件？

> ID：12554300
> 
> 赞同：0
> 
> 时间：2012-09-23T17:01:18.410
> 
> 标签：point-cloud-library

我已经尝试过[pcl17](http://svn.pointclouds.org/ros/branches/fuerte/perception_pcl_unstable/)来构建我的源代码。

当我 rosmake 显示未找到 vtkAppendPolyData.h 时。[（完整的味精）](http://pastebin.com/NXCVRaYT)

```
 [100%] Building CXX object CMakeFiles/correspondence_grouping.dir/src/correspondence_grouping.o
    In file included from /home/sam/code/ros/pcl/perception_pcl_unstable/pcl17/include/pcl-1.7/pcl17/common/impl/io.hpp:45:0,
                     from /home/sam/code/ros/pcl/perception_pcl_unstable/pcl17/include/pcl-1.7/pcl17/common/io.h:488,
                     from /home/sam/code/ros/pcl/perception_pcl_unstable/pcl17/include/pcl-1.7/pcl17/io/file_io.h:42,
                     from /home/sam/code/ros/pcl/perception_pcl_unstable/pcl17/include/pcl-1.7/pcl17/io/pcd_io.h:44,
                     from /home/sam/code/ros/pcl/pcl_3d_recognition/src/correspondence_grouping.cpp:1:
    /home/sam/code/ros/pcl/perception_pcl_unstable/pcl17/include/pcl-1.7/pcl17/point_types.h:56:0: 警告： ignoring #pragma warning  [-Wunknown-pragmas]
    In file included from /home/sam/code/ros/pcl/perception_pcl_unstable/pcl17/include/pcl-1.7/pcl17/common/impl/io.hpp:45:0,
                     from /home/sam/code/ros/pcl/perception_pcl_unstable/pcl17/include/pcl-1.7/pcl17/common/io.h:488,
                     from /home/sam/code/ros/pcl/perception_pcl_unstable/pcl17/include/pcl-1.7/pcl17/io/file_io.h:42,
                     from /home/sam/code/ros/pcl/perception_pcl_unstable/pcl17/include/pcl-1.7/pcl17/io/pcd_io.h:44,
                     from /home/sam/code/ros/pcl/pcl_3d_recognition/src/correspondence_grouping.cpp:1:
    /home/sam/code/ros/pcl/perception_pcl_unstable/pcl17/include/pcl-1.7/pcl17/point_types.h:636:0: 警告： ignoring #pragma warning  [-Wunknown-pragmas]
    In file included from /home/sam/code/ros/pcl/perception_pcl_unstable/pcl17/include/pcl-1.7/pcl17/visualization/common/common.h:40:0,
                     from /home/sam/code/ros/pcl/perception_pcl_unstable/pcl17/include/pcl-1.7/pcl17/visualization/pcl_visualizer.h:50,
                     from /home/sam/code/ros/pcl/pcl_3d_recognition/src/correspondence_grouping.cpp:10:
    /home/sam/code/ros/pcl/perception_pcl_unstable/pcl17/include/pcl-1.7/pcl17/visualization/vtk.h:51:31: 嚴重錯誤： vtkAppendPolyData.h：沒有此一檔案或目錄
    編譯插斷。
    make[3]: *** [CMakeFiles/correspondence_grouping.dir/src/correspondence_grouping.o] Error 1
    make[3]: Leaving directory `/home/sam/code/ros/pcl/pcl_3d_recognition/build'
    make[2]: *** [CMakeFiles/correspondence_grouping.dir/all] Error 2
    make[2]: Leaving directory `/home/sam/code/ros/pcl/pcl_3d_recognition/build'
    make[1]: *** [all] Error 2
    make[1]: Leaving directory `/home/sam/code/ros/pcl/pcl_3d_recognition/build'
  -------------------------------------------------------------------------------} 
```

如何解决？

谢谢~

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-24T08:05:54.133

编译器中的VTK库是否包含路径？

您可能还想检查是否安装了 libvtk5-dev 软件包，如此[处](http://www.pcl-users.org/vtk-header-files-missed-using-ros-pcl-visualization-under-ubuntu-11-04-td3038682.html)所述。

# javascript - 如何制作简单的搜索引擎？

> ID：12554308
> 
> 赞同：1
> 
> 时间：2012-09-23T17:02:42.603
> 
> 标签：javascript

伙计们，请帮我创建一个简单的搜索引擎，当用户写任何单词并点击输入按钮时，我的网页不会向他显示结果列表，但相反它应该打开那个特定页面，我的网页将以某种方式放入代码中并定义-如果输入了此关键字，请打开此页面。例如，如果用户在搜索框中键入 A 并单击搜索，则应该打开页面“/a.html” A 是字母的第一个字母。

就像[http://dictionary.reference.com](http://dictionary.reference.com)是如何做的（它的词典网站）所以它的作用是当用户输入一个他/她想要含义的单词时，dictionary.reference.com 不显示结果列表，它直接说明意思。就这样。这可以用html表单和javascript来完成吗？如果是怎么办？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-23T17:45:10.523

你是这个意思吗？ [http://jsfiddle.net/Sz2bC/2/](http://jsfiddle.net/Sz2bC/2/)

```
<script>
function redirect() {
    document.location.href = '/browse/' + document.getElementById('search').value;
    return false;
}
</script>

<form onsubmit="return redirect();">
<input id="search" type="text" />
<input type="submit" value="Search">
</form> 
```

# php - 比较没有日期的一天中的时间

> ID：12554310
> 
> 赞同：4
> 
> 时间：2012-09-23T17:02:55.243
> 
> 标签：php, datetime

因此，可以将时间与`<`、`>`等进行比较，但是当与 一起使用时`strtotime`，您将获得 unix 时间戳，因此您无法独立于日期比较时间。

我想做的是能够表达如下内容：

```
$reference_time = "2010-01-01 18:00:00";
print strtotime("19:00:00") > strtotime($reference_time);
print strtotime("16:00:00") > strtotime($reference_time); 
```

但我希望第二个表达式返回`false`（因为忽略日期，时间更短）。最简单的方法是什么？（最好不要拆分字符串）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-23T17:11:29.717

[`strtotime`](http://php.net/strtotime)还有第二个参数。尝试：

```
$reference_time = "2010-01-01 18:00:00";
$absolute = strtotime($reference_time);

print strtotime("19:00:00", $absolute) > $absolute;
print strtotime("16:00:00", $absolute) > $absolute; 
```

演示：[http ://codepad.org/uG4bsxTH](http://codepad.org/uG4bsxTH)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-23T17:06:02.773

您可以取每个 Unix 时间戳相对于 86400（一天中的秒数）的模数。

[http://php.net/manual/en/language.operators.arithmetic.php](http://php.net/manual/en/language.operators.arithmetic.php)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-23T17:08:47.013

你可以这样做：

```
print strtotime("19:00:00") > strtotime(explode(' ',$reference_time)[1]);
print strtotime("16:00:00") > strtotime(explode(' ',$reference_time)[1]); 
```

您需要**PHP 5.4**作为上述代码的最低要求。

# python - 如何在 Python 中使用异常的属性？

> ID：12554313
> 
> 赞同：46
> 
> 时间：2012-09-23T17:03:11.420
> 
> 标签：python, exception, exception-handling, attributes

有没有办法`Exception`在 Python 的 try-except 块中使用对象的属性/属性？

例如，在 Java 中，我们有：

```
try {
    // Some code
} catch(Exception e) {
    // Here we can use some of the attributes of "e"
} 
```

Python中的什么等价物会给我一个参考`e`？

* * *

## 回答 #1

> 赞同：80
> 
> 时间：2012-09-23T17:05:44.790

使用`as`语句。[您可以在处理异常](http://docs.python.org/tutorial/errors.html#handling-exceptions)中阅读更多相关信息。

```
>>> try:
...     print(a)
... except NameError as e:
...     print(dir(e))  # print attributes of e
...
['__cause__', '__class__', '__context__', '__delattr__', '__dict__', '__doc__', '__eq__',
 '__format__', '__ge__', '__getattribute__', '__gt__', '__hash__', '__init__', '__le__',
 '__lt__', '__ne__', '__new__', '__reduce__', '__reduce_ex__', '__repr__', '__setattr__',
 '__setstate__', '__sizeof__', '__str__', '__subclasshook__', '__traceback__', 'args',
 'with_traceback'] 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-09-23T17:06:45.300

这是[文档](http://docs.python.org/tutorial/errors.html)中的一个示例：

```
class MyError(Exception):
   def __init__(self, value):
       self.value = value

   def __str__(self):
      return repr(self.value)

try:
     raise MyError(2*2)
except MyError as e:
     print 'My exception occurred, value:', e.value 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-09-23T17:06:06.313

当然，有：

```
try:
    # some code
except Exception as e:
    # Here we can use some the attribute of "e" 
```

# c# - 单击任何按钮的事件（C# windows 窗体）

> ID：12554314
> 
> 赞同：5
> 
> 时间：2012-09-23T17:03:16.847
> 
> 标签：c#, visual-studio-2010, windows-forms-designer

我正在开发一个程序，该程序具有许多按钮，当单击时应该执行类似的操作，但根据单击的按钮略有不同。问题是唯一直接的方法是为每个按钮编写代码，这将是一项非常重复的任务。有没有一种方法可以简单地编写一个块来单击任何按钮以及单击哪个按钮？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-09-23T17:13:39.233

为所有按钮分配相同的事件处理程序。

```
foreach (var button in Controls.OfType<Button>()) {
    button.Click += button_Click;
} 
```

或者您可以在属性窗口中选择相同的事件处理程序切换到事件（闪烁图标）。

* * *

```
private static void button_Click(object sender, EventArgs eventArgs)
{
    switch (((Button)sender).Name)
    {
        // find a way to disambiguate.
    }
} 
```

您还可以在`Tag`属性中添加一些有用的信息以进行消歧。最后但并非最不重要的一点是，您可以从中派生自己的按钮`Button`并添加适当的属性。它们甚至会出现在属性窗口中。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-09-23T17:21:44.153

通过双击其中一个按钮来创建按钮单击处理程序。但不要对其他按钮执行相同操作，而是转到属性窗口并切换到事件视图。`Click`现在依次选择剩余的每个按钮，然后从属性窗口中其他按钮的事件下拉列表中选择刚刚创建的单击处理程序。现在它们在被点击时都会触发相同的方法。

![在此处输入图像描述](../Images/d86500eac6891af151ba26bea95df051.png)

```
private void button1_Click(object sender, EventArgs e)
{
    var btn = (Button)sender;
    switch (btn.Name) {
        case "button1":
            ...
            break;
        case "button2":
            ...
            break;
        case "button3":
            ...
            break;
        default:
            break;
    }
} 
```

或者，您可以在属性窗口中为按钮的属性定义一个值`Tag`并直接使用它，而无需使用 switch 或 if 语句。

您也可以直接使用 测试特定按钮`sender == button1`，但这在 switch 语句中不起作用。

* * *

创建您自己的派生按钮`Button`并添加所需的属性可能会更容易。编译后，您的按钮将出现在工具箱中，您的属性可以在属性窗口中设置。

```
public class MyButton : Button
{
    public int A { get; set; }
    public int B { get; set; }
} 
```

用法：

```
private void button1_Click(object sender, EventArgs e)
{
    var btn = (MyButton)sender;
    DoSomething(btn.A, btn.B);
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-23T17:21:46.793

> 有没有一种方法可以简单地编写一个块来单击任何按钮以及单击哪个按钮？

我只会使用相同的点击事件并有条件地检查点击了哪个按钮的发件人

```
private void button1_Click(object sender, System.EventArgs e)
{
   if(sender == button1)
   {
      //do something different for button1
   }
   else if(sender == button2)
   {
      ....
   }
} 
```

或者一个switch语句..

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-23T17:32:11.523

是的，您可以只创建一个按钮单击事件处理程序，并使用 Visual Studio Designer 将其与所有按钮连接起来。

这很简单，只需按照以下步骤操作：

1) 通过双击任一按钮为任一按钮创建 btn_click 事件处理程序。2) 对于所有其他按钮，右键单击任何按钮，单击属性，转到事件，在“单击”事件上，从下拉列表中选择 btn_click。

如果您希望同一事件处理程序中的不同按钮具有不同的功能，您可以将 sender 参数向下转换为 Button 类型，然后使用其 Name 属性来区分按钮。

这是一个例子：

```
private void btn_Click(object sender, System.EventArgs e)
{
   Button b =(Button)sender;
   if(b.Name == "button1")
   {
      //some code
   }
   else if(b.Name == "button2")
   {
      ....
   }
} 
```

# c# - C# 如何处理 RIA 域服务中 n:m 关联中的导航属性？

> ID：12554316
> 
> 赞同：1
> 
> 时间：2012-09-23T17:03:38.560
> 
> 标签：c#, silverlight, associations, wcf-ria-services, domainservices

在 Silverlight5 / RIA Services 应用程序中，我在一个非常简单的数据库上构建了域服务：

预订 n:1 设备 1:n GroupToEquipment n:1 组

在我自动生成的 edmx 中，GroupToEquipment 实体永远不会出现，并且显示了直接从 Equipment 到 Group 的关联。到目前为止，一切都很好。

为了让设备引用我的 DomainService 中的 1:n 关联预订，我必须在“DomainService.metadata.cs”中插入 [Include] 和 [Association...]

```
[Include]
[Association("FK_Booking_Equipment", "EquipmentId","EquipmentId")]
public EntityCollection<Booking> Booking { get; set; } 
```

并在“DomainService.cs”中添加了一个 .Include("Booking")

```
public IQueryable<Equipment> GetEquipment()
{
   return this.ObjectContext.Equipment.Include("Booking");
} 
```

这很完美，并且在查询设备时会加载对所有预订的引用！但是我如何必须为 n:m Group-association 采用这个？

以下代码是我在“DomainService.metadata.cs”中另外尝试的代码：

```
 internal sealed class EquipmentMetadata
    {

        // Metadata classes are not meant to be instantiated.
        private EquipmentMetadata()
        {
        }

        [Include]
        [Association("FK_Booking_Equipment", "EquipmentId","EquipmentId")]
        public EntityCollection<Booking> Booking { get; set; }

        public Guid EquipmentId { get; set; }

        [Include]
        [Association("GroupToEquipment", "EquipmentId", "GroupId")]
        public EntityCollection<Group> Group { get; set; }

        public string Name { get; set; }
    }
} 
```

这在 DomainService 中：

```
 public IQueryable<Equipment> GetEquipment()
    {
        return this.ObjectContext.Equipment.Include("Booking").Include("Group");
    } 
```

代码编译得很好，但在查询设备后没有对组的引用...... :-(

我究竟做错了什么？很确定这对于知道的人来说只是一个小问题......

最好的问候，弗洛。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-25T05:29:18.350

很抱歉，WCF Ria 不支持 m:n 关系！从更多信息中查看[此](https://stackoverflow.com/a/1768528/363198)Nikhil kotary 答案

我建议您创建一个 m:n 类并手动处理关系，换句话说，您必须将 GroupToEquipment 实体从 db 公开到 edmx，从 edmx 公开到 WCF Ria。

如果不能忍受这个选项，并且更喜欢添加对其他代码的依赖，请查看[m2mria on codeplex](http://m2m4ria.codeplex.com)，我已经在非常基本的场景中尝试过它并且它有效

希望这会有所帮助，
马可

# sql - 计算列的数据类型是什么？

> ID：12554318
> 
> 赞同：21
> 
> 时间：2012-09-23T17:03:46.503
> 
> 标签：sql, sql-server, calculated-columns

当您`CREATE TABLE`使用`CASE`表达式创建计算列时，您没有显式定义此列的数据类型：

```
CREATE TABLE OrderDetail
( OrderID INT
, ProductID INT
, Qty INT
, OrderDate DATETIME
, ShipDate DATETIME
, STATUS AS CASE
       WHEN shipdate is NULL AND orderdate < DATEADD( dd, -7, GETDATE()) THEN 3 
       WHEN shipdate is NOT NULL THEN 2 
       ELSE 1
   end
 )
GO 
```

SQL Server 如何决定该列的数据类型？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-09-23T17:13:46.580

另外，如果你想强制一个特定的数据类型而不是依赖于数据类型的优先级，你可以在计算中使用`CONVERT`or`CAST`来强制它（假设所有潜在的结果都与你选择的类型兼容）。这在默认情况下最终得到比预期更宽的数据类型的情况下非常有用；我见过的最常见的用例是当你最终得到一个 INT 而不是一个 BIT 时：

```
Active1 AS CASE WHEN something THEN 1 ELSE 0 END,
Active2 AS CONVERT(BIT, CASE WHEN something THEN 1 ELSE 0 END) 
```

在这种情况下`Active1`是一个`INT`（4 个字节），`Active2`而是一个`BIT`（1 个字节 - 或更少，如果它与其他`BIT`列相邻）。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-09-23T17:09:39.280

对于`CASE`表达式，它是具有[最高数据类型优先级](http://msdn.microsoft.com/en-us/library/ms190309.aspx)的分支。在您的示例中，所有三个分支都是在将被解释为整数的范围内的文字，因此列的类型将是`int`

[根据我在此处的回答，](https://stackoverflow.com/questions/7428538/curly-braces-in-t-sql/7428636#7428636)您可以使用`sql_variant_property`来确定文字表达式的数据类型。eg被解释为而不是.`2147483648``numeric(10,0)``bigint`

在问题中的情况下，SQL Server 认识到结果列将是`NOT NULL`但通常对于计算表达式，有必要将表达式包装在 an`ISNULL`中以获得该效果。

# python - 在 ubuntu 中升级 python

> ID：12554319
> 
> 赞同：1
> 
> 时间：2012-09-23T17:03:57.440
> 
> 标签：python, django, mod-wsgi, virtualenv

目前我在 Ubuntu 10.04、python 2.6.5、Django 1.3、virtualenv 和 mod_wsgi 上有一个工作站点。我也有 nginx 为静态文件提供服务，但我不确定它是否适合这个等式。

一年多前我设置了这个，实际上只学到了足够的东西来让它运行，所以我不记得我最初为让它运行所采取的确切步骤。

我需要开始使用 python 2.7，但我不确定最好的方法。从我读过的内容来看，我似乎需要专门为 2.7 重新安装 mod_wsgi。

我相信完成此操作的步骤如下所示：

1.  卸载 mod_wsgi。
2.  insatll python 2.7（我相信这可以与 2.6 并存？）
3.  专门为 python 2.7 重新安装 mod_wsgi。
4.  使用 2.7 创建一个新的 virtualenv 并重新安装要求。

我还在查看我设置的 apache 指向的 django.wsgi 文件（在我的项目中）：

```
import os, sys
import site

wsgi_dir = os.path.abspath(os.path.join(os.path.dirname(__file__)))
project_dir = os.path.dirname(wsgi_dir)
root_dir = os.path.join(project_dir, '..')

site.addsitedir(os.path.join(root_dir, 'env/lib/python2.6/site-packages'))
sys.path.append(project_dir)
os.environ['DJANGO_SETTINGS_MODULE'] = 'settings'

import django.core.handlers.wsgi
application = django.core.handlers.wsgi.WSGIHandler() 
```

而且我在任何地方都没有看到我专门调用了要使用的 python 二进制文件，所以我认为我需要在其中添加一些东西。

所以我的问题是：我需要采取哪些步骤将我的设置升级到 python 2.7？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T18:32:37.370

以下两个链接可能会有所帮助：

1.  [如何将 Django 与 Apache 和 mod_wsgi 一起使用，](https://docs.djangoproject.com/en/dev/howto/deployment/wsgi/modwsgi/) 尤其是“使用 virtualenv”部分

2.  一个类似的问题：[Django virtualenv 部署配置](https://stackoverflow.com/questions/3462102/django-virtualenv-deployment-configuration)

# web-services - 如何从 WP7 应用程序中读取网站的值

> ID：12554321
> 
> 赞同：-1
> 
> 时间：2012-09-23T17:04:11.493
> 
> 标签：web-services, windows-phone-7, rss

我正在为 Windows phone 7 开发货币转换器应用程序。我手动设置了值，我想知道如何从特定的 Web 服务中读取货币值......让我们从这个网站说...... [http：/ /www.cbsl.gov.lk/htm/english/_cei/er/e_1.asp](http://www.cbsl.gov.lk/htm/english/_cei/er/e_1.asp) 怎么做....提前谢谢...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T17:09:23.290

如果我理解您的上述建议，我建议您不要为了提取转化率等数据而对 HTML 网页进行切片/破解。原因是网页结构改变的那一天会破坏你的应用程序。最好的办法是找到一个您可以联系并请求您需要的数据的 API。您可以在搜索引擎上查看货币汇率的 API。例如，我找到了这个。[http://openexchangerates.org/latest.json](http://openexchangerates.org/latest.json)

因此，一旦您选择了一个 API，就可以使用 WebClient 调用它，然后处理响应。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T17:08:41.430

您必须获取页面 HTML，然后解析结果文本以找到您需要的数据。

Codeplex 中有一个开源[货币转换器](http://currency.codeplex.com)应用程序，您可以检查以了解如何实现预期结果。

# mysql - SQL语句优化问题

> ID：12554329
> 
> 赞同：1
> 
> 时间：2012-09-23T17:05:01.357
> 
> 标签：mysql, sql, sorting, union

我想将 region = 'sample' 的行显示为结果中的第一行。我的意思是优先级必须高于其他行，并且它们必须位于顶部。

我使用下面的 SQL 来获得这个结果。

```
SELECT * FROM works Where region = 'sample' UNION Select * FROM works Where region <> 'sample' 
```

没有UNION，有什么最佳方法可以得到结果吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-23T17:08:23.230

您可以使用`order`：

```
SELECT * FROM works
order by case when region = 'sample' then 1 else 2 end 
```

如果您希望您的数据也按另一列排序，您可以在末尾添加它，如下所示：

```
order by case when region = 'sample' then 1 else 2 end, othercolumn 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-23T17:08:35.927

```
SELECT * FROM works 

order by case region when 'sample' then 1 else 2 end; 
```

也许它会帮助你...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-23T17:09:23.727

首先联盟不会保证秩序。即使你这样做，也有可能不按正确的顺序。因此，您必须使用 order by 子句来做到这一点。

简单的

```
select * from work order by case when region='sample' then 0 else 1 end 
```

如果你有一个关于区域的索引会更好

```
select *,0 as ordb from work where region = 'sample'
union
select *,1 as ordb from work where region <> 'sample'
order by ordb 
```

# ember.js - 如何使用 ember.js 做一个类似的过滤器

> ID：12554335
> 
> 赞同：4
> 
> 时间：2012-09-23T17:05:53.820
> 
> 标签：ember.js

我在 ember 1.0 之前有一个简单的 ArrayController，发现如果过滤器找到给定属性的完全匹配项，我可以将列表切掉，但我似乎找不到的是如何使用过滤器进行“喜欢”查询。

如果我用用户搜索数组，我下面的内容会起作用......

```
filtered = ['id', 'username'].map(function(property) {
  return self.get('content').filterProperty(property, filter);
}); 
```

...并且一些用户具有相同的用户名。例如 => 如果我按“smith”搜索/过滤，它将返回两条记录，因为“username”属性与“smith”完全匹配

如何更改此地图功能以使用类似样式的查询，因此当我键入单词“sm”时，它仍然可以找到这两个记录

这是 jsfiddle 显示我上面在操作中显示的过滤器[http://jsfiddle.net/Rf3h8/](http://jsfiddle.net/Rf3h8/)

先感谢您

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-23T23:04:02.653

您可以使用`RegExp`对象来测试数据片段是否匹配。由于您正在编写自己的过滤器逻辑，因此您必须使用该`filter`函数。我已经更新了你的小提琴来完成这项工作：http: [//jsfiddle.net/Rf3h8/1/](http://jsfiddle.net/Rf3h8/1/)

您的小提琴包含大量代码，其他人可能难以理解。这是一个非常简单的`RegExp`用于过滤数组的示例。

```
var names = ['ryan', 'toran', 'steve', 'test'];
var regex = new RegExp('ry');

var filtered = names.filter(function(person) {
  return regex.test(person);
});

filtered // => ['ryan'] 
```

实际上，您甚至可以将其重构为

```
var filtered = names.filter(regex.test, regex); 
```

# r - 在 R 中绘制对数刻度

> ID：12554336
> 
> 赞同：0
> 
> 时间：2012-09-23T17:05:56.503
> 
> 标签：r, graph, statistics, plot, logarithm

我正在尝试绘制对数刻度，但我不断收到此错误：

```
Error in plot.window(...) : invalid "log=1/h" specification. 
```

我不确定我做错了什么。下面是我的代码：

```
 #function
function(stepsize, temp_val, counter) {
  while(counter < 0) {
    counter <- counter + stepsize
    px_norm <- dnorm(counter, mean = 0, sd = .04)
    temp_val <- temp_val + px_norm }
  temp_val <- 2*temp_val
  temp_val <- temp_val *(stepsize/2)
  print(temp_val, digits = 12)
}

#Initial step size
h <- .01 
while (h > .00001) {
  x <- calc_error(h, 0, -5) #Gives me a result around .5
  err <- x - (exp(-.02)*0.5)
  plot(1/h, err, log = "1/h")
  h <- h/10 } 
```

基本上，在我试图展示的这个简短函数中，随着步长的增加，真实答案的误差会减少。但是，我在绘制这个时遇到了麻烦。任何帮助将不胜感激。谢谢

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-23T17:32:08.413

这应该是创建绘图的简单方法：

```
h <- 10^-seq(2, 4)
err <- lapply(h, function(x) calc_error(x, 0, -5) - (exp(-.02) * .5))
plot(1/h, err, log = "x") 
```

![在此处输入图像描述](../Images/a75d26ac762cdc5cc88cea9b53f4c836.png)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-09-23T17:15:51.907

```
plot(1/h, err, log = "1/h") 
```

log 应该是您想要在日志空间中绘制的轴，而不是实际数据。

IE

```
plot(1/h, err, log = "x") 
```

将在日志空间中绘制您的 x 轴

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-23T17:29:46.613

我猜你想要这样的东西：

```
i <- 1
h <- 0.01
err <- vector(0,mode="numeric")

while (h[i] > .00001) {
  x <- rnorm(1,mean=0.5,sd=0.05) #use calc_error instead
  err <- c(err,x - (exp(-.02)*0.5))
  i <- i+1
  h <- c(h,h[i-1]/10) }

plot(1/h[-length(h)],err,log="x") 
```

# java - JPQL ElementCollection：获取具有列表中至少一个角色的所有用户

> ID：12554337
> 
> 赞同：1
> 
> 时间：2012-09-23T17:05:57.563
> 
> 标签：java, jpa, eclipselink

一个用户可以扮演许多角色。我想从参数列表中获取至少具有一个角色的所有用户。

数据定义如下所示：

```
@Entity
public class User implements Serializable {
    @Id
    @Column(name = "Id",
            nullable = false)
    private long id;

    @Column(name = "LoginName",
            length = 30,
            unique = true,
            nullable = false)
    private String loginName;

    @ElementCollection
    @Enumerated(EnumType.STRING)
    @CollectionTable(name = "Role",
                     joinColumns = @JoinColumn(name = "Id"),
                     uniqueConstraints = @UniqueConstraint(columnNames = {"Id", "Role"}))
    @Column(name = "Role")
    private Set<RoleType> roles = new HashSet<RoleType>();
}

public enum RoleType {
    GUEST,
    ACCOUNTING,
    ADMIN,
    OPERATOR;
} 
```

现在我希望所有在参数列表中至少具有一个角色的用户。该列表可以是动态的。我尝试了以下代码：

```
String sql = "SELECT DISTINCT u FROM User u JOIN u.roles AS r WHERE r IN :filteredRoles";
Query query = entityManager.createQuery(sql);
List<RoleType> filteredRoles = new ArrayList<RoleType>();
filteredRoles.add(RoleType.ADMIN);
filteredRoles.add(RoleType.ACCOUNTING);
query.setParameter("filteredRoles", filteredRoles);
List<User> result = (List<User>) query.getResultList(); 
```

并收到以下异常：

```
Exception [EclipseLink-6078] (Eclipse Persistence Services - 2.3.2.v20111125-r10461): org.eclipse.persistence.exceptions.QueryException
Exception Description: The class of the argument for the object comparison is incorrect. 
Expression: [null] 
Mapping: [org.eclipse.persistence.mappings.DirectCollectionMapping[roles]] 
Argument: [[ADMIN, ACCOUNTING]]
Query: ReadAllQuery(referenceClass=User sql="SELECT DISTINCT t0.Id FROM User t0, Role t1 WHERE ((t1.Role IN ?) AND (t1.Id = t0.Id))") 
```

我尝试了 JPQL 的几种变体，但没有成功。我希望收到有用的提示。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-24T13:50:44.290

你能试试 2.4 版本吗，这似乎是固定的。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-24T04:44:57.980

我不确定，这将是最好的解决方案。希望对您有所帮助；

```
public enum Role {
    AAA, BBB, CCC, DDD;
}

@Entity
public class Student implements Serializable {
    @Id
    private String id;
    private String name;
    @ElementCollection
    @Enumerated(EnumType.STRING)
    @CollectionTable(name = "Role", joinColumns = @JoinColumn(name = "Id"),
                     uniqueConstraints = @UniqueConstraint(columnNames = { "Id", "Role" }))
    @Column(name = "Role")
    private List<Role> roleList;

    public Student() {
    }

    //gettter and setter
}

/**
    Assume :
    ==================          ================
    Student Table               Role Table
    ==================          ================
    R001    Student 1           R001    AAA
    R002    Student 2           R002    BBB
    R003    Student 3           R002    CCC
    R004    Student 4           R004    DDD
                                R001    BBB
                                R002    CCC

*/
public class TestCase {
    public static <T> Set<T> intersection(Set<T> setA, Set<T> setB) {
        Set<T> tmp = new TreeSet<T>();
        for (T x : setA)
          if (setB.contains(x))
            tmp.add(x);
        return tmp;
      }

    public static void main(String[] args) {
        EntityManagerFactory emf = Persistence.createEntityManagerFactory("JPA");
        EntityManager em = emf.createEntityManager();
        em.getTransaction().begin();
        Set<Role> paramRoles = new HashSet<Role>();
        paramRoles.add(Role.BBB);
        paramRoles.add(Role.CCC);

        Query q = em.createQuery("SELECT s FROM Student s");
        List<Student> studentList = q.getResultList();
        for (Student s : studentList) {
            Set<Role> result = TestCase.intersection(paramRoles, new HashSet<Role>(s.getRoleList()));
            if (!result.isEmpty()) {
                System.out.println(s.getName());
            }
        }
        em.getTransaction().commit();
        em.close();
    }
}

/** Output :

Student 1
Student 2

*/ 
```

# ruby-on-rails - 使用 Minitest，需要 'minitest_helper' 加载错误

> ID：12554349
> 
> 赞同：6
> 
> 时间：2012-09-23T17:07:04.940
> 
> 标签：ruby-on-rails, ruby, minitest

我正在测试 Minitest::Spec 作为 RSpec 的替代品，但我遇到了一个讨厌的问题，我无法完全找到答案：

我已经在`spec/models/*_spec.rb`. 我的 rails 应用程序包括`minitest-rails`，并且我将 rakefile 设置如下：

```
Rake::TestTask.new do |t|
  t.libs.push "lib"
  t.test_files = FileList['spec/**/*_spec.rb']
  t.verbose = true
end
task :default => :test 
```

现在，如果我这样编写规范文件：

```
require 'minitest_helper'

describe User do
  ...
end 
```

...然后运行`rake test`，我得到：

```
user_spec.rb:1:in `require': cannot load such file -- minitest_helper (LoadError) 
```

但是，如果我将要求行更改为

```
require_relative '../minitest_helper' 
```

然后它工作。所以，这是功能性的，但似乎我在网上找到的每个使用 minitest 规范的人的例子都只是调用`require 'minitest_helper'`，而不是`require_relative`. 那么，我错过了什么让它对其他人有用但不适用于我的情况？

最后一条信息，我的帮助文件如下所示：

```
# spec/minitest_helper.rb
ENV["RAILS_ENV"] = "test"
require File.expand_path('../../config/environment', __FILE__)

require "minitest/autorun"
require "minitest/rails"

# Uncomment if you want Capybara in accceptance/integration tests
# require "minitest/rails/capybara"

# Uncomment if you want awesome colorful output
# require "minitest/pride"

class MiniTest::Rails::ActiveSupport::TestCase
  # Add more helper methods to be used by all tests here...
end 
```

没有什么花哨。谢谢您的帮助！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-28T15:10:49.403

您的测试没有找到帮助文件，因为您没有告诉您的测试查看它的位置。尝试将您的 rake 任务更改为：

```
Rake::TestTask.new do |t|
  t.libs << "lib"
  t.libs << "spec"
  t.test_files = FileList['spec/**/*_spec.rb']
  t.verbose = true
end
task :default => :test 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-23T17:10:35.173

在 Ruby 1.9 中，工作目录*不*包含在 Ruby 加载路径中。如果需要，您可以添加它：

```
$: << "." 
```

...或者您可以添加任何其他要从中获取`require`Ruby 文件的目录。

如果你看到其他人只写：

```
require 'minitest_helper' 
```

...那么毫无疑问他们已经对他们的加载路径做了一些事情（或者 Rails/Rake 已经为他们做了）。您可以尝试`p $:`在 Rakefile 中查看 Rails/Rake 对加载路径（如果有的话）做了什么。

# node.js - 在nodejs中使用异步函数返回值

> ID：12554350
> 
> 赞同：1
> 
> 时间：2012-09-23T17:07:08.173
> 
> 标签：node.js

我有这个功能：

```
exports.readPartial = function(html, values, response) {
  fs.readFile(__dirname + "/../html/partials/" + html, function(error, file) {
  if(error) { this.loadError(response, error); }
  else {
   console.log("\t--> partial found: " + file);
   return file; // FILE VALUE
  }
  });
} 
```

当调用该函数时，它应该返回“文件”的值。但是，当调用`return file;`im 实际上返回匿名函数中的值时，我将其作为参数传递。在使用 nodejs 进行异步编程时返回这个值的正确方法是什么？使用`var that = this;`?

对这种编程风格感到非常困惑。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T17:16:06.693

您的`readPartial`函数依赖于异步函数`readFile`。所以它也变得异步了。

现在，您有几种解决此问题的方法：

*   使用 的同步版本`fs.readFile`，即`fs.readFileSync`（参见[http://nodejs.org/api/fs.html#fs_fs_readfilesync_filename_encoding](http://nodejs.org/api/fs.html#fs_fs_readfilesync_filename_encoding)）。然后你就可以像往常一样返回结果。
*   更改您的函数以使用回调，也是。

所以，基本上这意味着：要么两个函数都必须是异步的，要么都需要同步。

在这两个选项中，我更喜欢使用回调的异步选项：这正是 Node.js 的核心能力——异步、非阻塞 I/O。因此，如果您没有强烈的反对理由，请坚持使用异步版本并使用回调。

当然，您可能对存在的其他选项感兴趣。所以，他们在这里（**虽然我不推荐它**）：

*   Call `fs.readFile` and "wait" for its callback to return. This basically means active waiting with a `while(true)` loop, and is definitely considered bad practice. Anyway, technically it is viable. For the rare case you really want to do this, or you are simply interested in how one might implement something like this, check out [syncasync.js](https://github.com/goloroden/syncasync.js).

# ruby-on-rails - 无法批量分配受保护的属性：约会

> ID：12554361
> 
> 赞同：0
> 
> 时间：2012-09-23T17:08:26.500
> 
> 标签：ruby-on-rails, nested-forms, nested-attributes, mass-assignment

成功下订单后，我正在尝试创建列表对象和约会对象。如果用户专门通过其列表订购约会，则约会对象嵌套在列表对象中。谁能帮我弄清楚我做错了什么？

这是错误：

```
ActiveModel::MassAssignmentSecurity::Error in ListingsController#update
Can't mass-assign protected attributes: appointment 
```

订单创建操作：

```
def create
@order = current_cart.build_order(params[:order])
@order.ip_address = request.remote_ip
@order.user_id = current_user.id

respond_to do |format|
  if @order.save_with_payment

    @order.add_line_items_from_cart(current_cart)         
    Cart.destroy(session[:cart_id])
    session[:cart_id] = nil

    @order.line_items.each do |line_item|
      if line_item.service_id == 2
        listing = Listing.create!(:order_id => @order.id, :user_id => current_user.id, :house_id => @order.house_id)
      end

      if line_item.service_id ==3
        Appointment.create!(:order_id => @order.id, :user_id => current_user.id, :house_id => @order.house_id, :listing_id => listing)
      end
    end

    format.html { render :action => "success", :notice => 'Thank you for your order.' }
    format.xml { render :xml => @order, :status => :created, :location => @order }

  else
    format.html { render :action => "new" }
    format.xml { render :xml => @order.errors,
    :status => :unprocessable_entity }
  end
end 
```

结尾

成功操作包含以下形式：

```
<div class="contain">
<h3>Your order has been received</h3>

<% @order.line_items.each do |line_item| %> 
    <%if line_item.service_id == 2 %>
        <p>Prepare Listing</p>      
        <%= simple_form_for(@order.listing) do |f| %>
            <%= f.error_notification %>

            <div class="form-inputs">

              <%= f.input :start_date %>
              <%= f.input :end_date %>
              <%= f.input :list_price %> <h3>Suggessted list price:****</h3>
              <%= f.input :description %>
              <%= f.input :showing_instructions %>
            </div>

            <% @order.line_items.each do |line_item2| %>
                <%if line_item2.service_id == 3 %>
                    <p>Set up appointments</p>

                    <%= f.simple_fields_for @order.appointment do |a| %>
                        <div class="form-inputs">
                            <%= a.input :start_date %>
                            <%= a.input :showing_instructions%>                         

                            <%= a.input :status %>
                         </div>
                    <% end %>                                             
                <%end%>
            <%end%>

            <div class="form-actions">
              <%= f.button :submit %>
            </div>
        <% end %>
    <%end%>
<%end%> 
```

上市模式

```
attr_accessible :description, :end_date, :house_id, :order_id, :user_id, :appointments_attributes
accepts_nested_attributes_for :appointment

  has_one :appointment 
  belongs_to :order 
```

预约模式

```
 attr_accessible :start_date, :end_date, :listing_id, :order_id, :user_id, 

  belongs_to :listing
  belongs_to :order
  belongs_to :user 
```

订单模型

```
 attr_accessible :first_name, :ip_address, :last_name, :cart_id  

  belongs_to :user
  belongs_to :house
  belongs_to :cart

  has_many :transactions, :class_name => "OrderTransaction"
  has_many :line_items, :dependent => :destroy
  has_one :listing
  has_one :appointment 
```

列表控制器更新操作：

```
 def update
@listing = Listing.find(params[:id])

respond_to do |format|
  if @listing.update_attributes(params[:listing])

    format.html { redirect_to @listing, notice: 'Listing was successfully updated.' }
    format.json { head :no_content }
  else
    format.html { render action: "edit" }
    format.json { render json: @listing.errors, status: :unprocessable_entity }
  end
end
  end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T17:20:54.753

Fix your `Listing` model with this

```
attr_accessible :description, :end_date, :house_id, :order_id, :user_id, :appointment_attributes
accepts_nested_attributes_for :appointment 
```

# mysql - 使用 GROUP BY 时如何强制执行 ORDER BY？

> ID：12554366
> 
> 赞同：3
> 
> 时间：2012-09-23T17:08:36.390
> 
> 标签：mysql, sql

我有这个 SQL：

```
SELECT itemId, parentId, value FROM item ORDER BY value DESC 
```

正确返回：

```
+--------+------------------+
| itemId | parentId | value |
+--------+------------------+
|      1 |        5 |   500 |
|      4 |        1 |   500 |
|      2 |        5 |    10 |
|      5 |        1 |    10 |
|      3 |        5 |     0 |
|      6 |        1 |     0 |
+--------+----------+-------+ 
```

我尝试添加“GROUP BY parentId”，但这似乎选择了两个随机项目，忽略了 ORDER BY 子句：

```
+--------+------------------+
| itemId | parentId | value |
+--------+------------------+
|      2 |        5 |    10 |
|      6 |        1 |     0 |
+--------+----------+-------+ 
```

我应该使用什么 SQL 来仅返回每个 parentId 具有最高值的项目？：

```
+--------+------------------+
| itemId | parentId | value |
+--------+------------------+
|      1 |        5 |   500 |
|      4 |        1 |   500 |
+--------+----------+-------+ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T17:11:19.243

对于 each ，只有当它是它的`itemId`时才选择它：`value``MAX``parentId`

```
SELECT itemId, parentId, value
FROM item i
WHERE value = (SELECT MAX(value) 
               FROM item t 
               WHERE t.parentId = i.parentId) 
```

返回：

```
| ITEMID | PARENTID | VALUE |
-----------------------------
|      1 |        5 |   500 |
|      4 |        1 |   500 | 
```

**[演示](http://sqlfiddle.com/#!2/bbd8e/2)**。

# python - 安装 setup.py 时使用“'packages': []”的无效语法

> ID：12554369
> 
> 赞同：7
> 
> 时间：2012-09-23T17:08:45.313
> 
> 标签：python, ubuntu

我是编程新手，过去几周我一直在自己学习 python。大部分指令来自资源“Learn Python the Hard Way”。

现在我的问题是，我刚开始做一个测验，基本上让你完成并安装你自己的 setup.py 文件。但是，在花了一些时间了解该文件并尝试运行它之后；我在这里的第二个单引号上不断收到“无效语法”错误：

`'packages': [ ],`.

我已经尝试了所有我能想到的方法，例如从左侧变量中删除所有单引号，用等号替换冒号，重命名某些文件和文件夹，或者三者的组合。我已经将代码与其他提供类似教程的网站进行了比较。这是以前的想法出现的地方，并且已经在包括谷歌和 stackoverflow.com 在内的几个地方搜索了这个问题的解决方案。但是，到目前为止，我还没有找到任何与这种特殊情况相关的帖子。

我使用 Ubuntu 12.04 LTS 作为我的操作系统。

* * *

我有这个问题的屏幕截图，但我缺乏在此处发布它的声誉。: (

* * *

这段代码应该与“Learn Python the Hard Way”中的代码完全相同，我只按照说明更改了变量，例如姓名或电子邮件地址。

# 这是'setup.py'中的代码

```
try:  
    from setuptools import setup  
except ImportError:  
    from distutils.core import setup  

config = {
    'description': 'Amateur Remake of the Clannad Visual Novel',  
    'author': 'Kristopher Anders',  
    'url': 'Unavailable Online.',  
    'download_url': 'Not Available online.',  
    'author_email': 'kanders91@gmail.com',  
    'version': '0.1',  
    'install_requires': ['nose']  
    'packages': ['seen0414'],  
    'scripts': [],  
    'name': 'Clannad Visual Novel'  
}  

setup(**config) 
```

* * *

# 这是'setup.py'的文件树

```
|---Clannad    \\root directly for 'setup.py' \\
      |---bin  
      |---docs  
      |---seen0414  
          |---__init__.py    --\\contents is exact copy of 'seen0414.py'\\  
          |---__init__.pyc        \\otherwise '__init__.py' was empty.\\
          |---module0414.py  --\\contains  functions for 'seen0414'\\  
          |---module0414.pyc
          |---script0414.txt --\\contains necessary text for 'module0414.py'\\  
          |---seen0414.py    --\\original(main) script\\  
      |---tests  
          |---clannad_tests.py  
          |---clannad_tests.pyc  
          |---__init__.py  
          |---__init__.pyc  
      |---setup.py 
```

* * *

我确信它可能是一个非常简单的解决方案，但我似乎无法弄清楚这一点。提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-23T17:09:38.933

```
'install_requires': ['nose'] 
```

缺少`,`

尝试

```
'install_requires': ['nose'], 
```

# vim - cvim 命令不能在命令模式下工作，但可以从 GUI 菜单工作

> ID：12554373
> 
> 赞同：2
> 
> 时间：2012-09-23T17:09:04.347
> 
> 标签：vim, vim-plugin

我使用 vi/vim 来编辑文件，并且熟悉进入插入模式（按“a”键）和使用 ESC 进入控制模式以写入文件并退出的基础知识。

我在[这里](http://www.thegeekstuff.com/2009/01/tutorial-make-vim-as-your-cc-ide-using-cvim-plugin/)`cvim`学习教程，除了我在 Ubuntu 12.04 上使用 vim-gtk。像 ^Wv（左 Ctrl + W，然后是 v）这样的命令可以正常工作（从中间拆分窗口），但是当我进入命令模式（按 ESC）并执行（\ 是反斜杠字符）时：

```
\if 
```

它会自动将我置于插入模式。但是，我可以从 GUI 菜单运行命令并且它工作正常（在这种情况下创建一个 C++ 函数）。

我在这里错过了一些基本的东西吗？反斜杠不是反斜杠吗？我在 Google 上的任何地方都找不到关于此的任何文档。

如果有人能指出我哪里出错了，我将不胜感激。GVIM 从菜单中可以正常工作，但是能够在编辑器中使用命令会更有效率。

提前感谢任何帮助/提示/指针:-)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T17:42:14.133

该文件必须保存为有效的 C/C++ 文件才能正常工作。感谢 ire_and_curses 的资源

# javascript - 将子 DIV 放置在父 DIV 的底部

> ID：12554374
> 
> 赞同：1
> 
> 时间：2012-09-23T17:09:11.943
> 
> 标签：javascript, css, html-table

我已经完成了已经打开的问题，但找不到解决方案。

它是这样的：......

```
 <div style="some height">
         <div style="some width"> .......and so on..
              ..

             <table>
                <tr>
                 <td>
                      <div id="parentDiv">
                         <div id="div1">Title Text and description.</div>
                         <div id="div2">Text+Image button here</div>
                      </div>
                </td>
                <td>
                     ..and more such columns and rows.
               </td>

          <Other divs closing> 
```

现在，`parentDiv`无论`parentDiv`.

如果我将 position:relative to`parentDiv`和 position:absolute 分配给 div2，我将无法使用和东西，因此它会粘在`parentDiv`.

我想要这个，因为如果任何其他 TD 由于 div1 中的内容而获得更大的高度，我希望所有文本和按钮图像保持对齐。

PS - 我不能使用表中的表来解决这个问题，因为实际场景使用 JS 来提供功能。任何CSS来解决这个问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-23T17:11:53.453

制作`div2` `position: absolute`然后设置`bottom: 0`。`div2`

只是设置不会成功`position:absolute`。为了定位它，`div2`您必须设置`top`、`bottom`和CSS 属性。设置并确保' 的位置相对于非静态定位的最近祖先（在本例中为）进行调整。`left``right``position: absolute``bottom: 0``div2``parentDiv``position: relative`

# entity-framework-4 - 首先在 EF 代码中设置类似引用的外键

> ID：12554383
> 
> 赞同：1
> 
> 时间：2012-09-23T17:10:08.953
> 
> 标签：entity-framework-4, ef-code-first

我有一组需要以这种方式引用自己的四个 POCO 对象：

一个自由职业者可以有多个客户

客户可以有多个项目

项目可以有多个故事。

我想确保的一个可能是自由职业者开始时没有客户，客户开始时没有项目，项目开始时没有故事，所以我想他们需要可以为空？

另一个方向则相反，一个故事需要一个项目，一个项目需要一个客户，一个客户需要一个自由职业者。

我只是想看看在创建模型（onModelCreating 覆盖）时是否需要做任何事情，以确保这是发生的关系。

这是我的对象：

```
public class Freelancer
{
    public int ID { get; set; }
    public string Email { get; set; }
    public string Password { get; set; }
    public string FirstName { get; set; }
    public string LastName { get; set; }
    public string CompanyName { get; set; }
    public string Avatar { get; set; }
    public Address FreelancerAddress { get; set; }
    public ICollection<Client> Clients { get; set; }
}

public class Client
{
    public int ID { get; set; }
    public string Name { get; set; }
    public Address ClientAddress { get; set; }
    public string Logo { get; set; }
    public ICollection<Project> Projects { get; set; }
}

public class Project
{
    public int ID { get; set; }
    public string Name { get; set; }
    public string Summary { get; set; }
    public string Description { get; set; }
    public ICollection<Story> Stories { get; set; }
}

 public class Story
{
    public int ID { get; set; }
    public string Title { get; set; }
    public DateTime Start { get; set; }
    public DateTime End { get; set; }
    public decimal Duration { get; set; }
    public bool Billable { get; set; }
    public string Notes { get; set; }
} 
```

我知道 EF 会自动做一些事情，我只是想问我是否需要做更多的事情来确保我拥有我想要的关系。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T17:27:13.077

按照惯例，您的模型将创建*可选*关系（“客户*可以*有一个自由职业者，但不需要”），但由于您需要必需的关系（“客户*需要*一个自由职业者”），您必须使用 Fluent API 定义它：

```
modelBuilder.Entity<Freelancer>()
    .HasMany(f => f.Clients)
    .WithRequired()
    .Map(m => m.MapKey("FreelancerID"));  // FK column name in Clients table 
```

您可以在没有最后一行 ( `Map`) 的情况下工作。然后 EF 将创建一个默认外键名称，带有下划线的名称，也许是`Freelancer_ID`.

其他关系的映射相同。

或者，您可以使用外键属性引入反向导航属性：

```
public class Client
{
    public int ID { get; set; }
    //...
    public ICollection<Project> Projects { get; set; }

    public int FreelancerID { get; set; }
    public Freelancer Freelancer { get; set; }
} 
```

使用这样的模型，EF 将根据需要自动识别关系，因为外键属性`FreelancerID`不可为空，并且您不需要使用 Fluent API 进行额外映射。

# html - SVG/HTML5 拉斐尔绘图样本

> ID：12554388
> 
> 赞同：0
> 
> 时间：2012-09-23T17:10:43.463
> 
> 标签：html, svg, drawing, raphael

有没有像 [http://svg-edit.googlecode.com/svn/trunk/editor/svg-editor.html](http://svg-edit.googlecode.com/svn/trunk/editor/svg-editor.html) 这样用 Raphael 制作的项目？

我想用拉斐尔做简单的“笔/线/圆/矩形”工具。有没有 JS 库可以帮助我？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T17:23:15.510

有[jsvectoreditor](http://code.google.com/p/jsvectoreditor/)在 JavaScript 中使用 Raphael 渲染到 SVG/VML 的矢量图形编辑器

# java - 如何在android中重用监听器

> ID：12554389
> 
> 赞同：0
> 
> 时间：2012-09-23T17:10:47.527
> 
> 标签：java, android, listener

我一直在努力让我的观点响应用户的滑动。我让它在我的主要活动上运行良好，我想在多个活动上重用这段代码，而不必每次都复制和粘贴它。

我正在尝试找到一种方法将此侦听器移动到单独的类（和文件），然后调用可以在每个活动中唯一定义的不同响应。我能想到的唯一方法是将 Activity 扩展为自定义类（XActivity）。但是这样做只有在我使用自定义类 XActivity 时才有效，而不是 ListActivity 等。

有谁知道一种方法来隔离和使用 Listener 作为自定义类，这样我就不必一遍又一遍地复制它？

**View_Main** 包 us.ciple.testswipe;

```
import android.app.Activity;
import android.content.Context;
import android.content.Intent;
import android.os.Bundle;
import android.util.DisplayMetrics;
import android.util.Log;
import android.view.GestureDetector;
import android.view.MotionEvent;
import android.view.View;
import android.view.GestureDetector.SimpleOnGestureListener;
import android.view.ViewConfiguration;
import android.widget.Toast;

public class View_Main extends Activity {

/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    // Implement Gesture detection
    gestureDetector = new GestureDetector(new MyGestureDetector());
    gestureListener = new View.OnTouchListener() {
        public boolean onTouch(View v, MotionEvent event) {
            return gestureDetector.onTouchEvent(event);
        }
    };
    View v = (View) getWindow().getDecorView().getRootView();
    v.setOnTouchListener(gestureListener);
}

private void openSecond(){
    Intent i = new Intent(this, View_Second.class);
    startActivity(i);
}

public final void toast(String message) {
    Toast.makeText(getBaseContext(), message, Toast.LENGTH_SHORT).show();
}

/**
 * Gestures
 */
private GestureDetector gestureDetector;
View.OnTouchListener gestureListener;

private class MyGestureDetector extends SimpleOnGestureListener {
    final ViewConfiguration vc = ViewConfiguration.get(getBaseContext());
    final int swipeMinDistance = vc.getScaledTouchSlop() * 2;
    final int swipeThresholdVelocity = vc.getScaledMinimumFlingVelocity();

    @Override
    public boolean onFling(MotionEvent e1, MotionEvent e2, float velocityX, float velocityY) {
        try { 
            /**
            if (Math.abs(e1.getY() - e2.getY()) > swipeMinDistance){
               return false;
            }
            */

            float deltaX = 0;
            float deltaY = 0;

            deltaX = e1.getX() - e2.getX();
            deltaX = Math.abs(deltaX);

            deltaY = e1.getY() - e2.getY();
            deltaY = Math.abs(deltaY);

            Log.i("View_Main - deltaX", Float.toString(deltaX));
            Log.i("View_Main - deltaY", Float.toString(deltaY));

            Log.i("View_Main - swipe e1", Float.toString(e1.getX()) +" , " + Float.toString(e1.getY()));
            Log.i("View_Main - swipe e2", Float.toString(e2.getX()) +" , " + Float.toString(e2.getY()));

            //Vertical Swipe
            if (deltaY > deltaX){
                if(e1.getY() - e2.getY() > swipeMinDistance*2 && Math.abs(velocityY) > swipeThresholdVelocity) {
                onBottomToTopSwipe();
            }  else if (e2.getY() - e1.getY() > swipeMinDistance *2 && Math.abs(velocityY) > swipeThresholdVelocity) {
                onTopToBottomSwipe();
                }
            }

            //Horizontal Swipe
            else {
                if(e1.getX() - e2.getX() > swipeMinDistance && Math.abs(velocityX) > swipeThresholdVelocity) {
                    onRightToLeftSwipe();
                }  else if (e2.getX() - e1.getX() > swipeMinDistance && Math.abs(velocityX) > swipeThresholdVelocity) {
                    onLeftToRightSwipe();
                }
            }    

        } catch (Exception e) {
            // nothing
        }
        return false;
    }
}

private void onRightToLeftSwipe() {
    //do something      
    toast("Right to Left");
    openSecond();
}

private void onLeftToRightSwipe() {
    toast("Left to Right");
    onBackPressed();
}

private void onBottomToTopSwipe() {
    toast("Bottom to Top");
    //do something
}

private void onTopToBottomSwipe(){
    toast("Top to Bottom");
    //do something
}
} 
```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T17:21:06.723

Replace ListActivity by Activity. you will need to use a listview inside activity this. now go ahead with the way you mention . i.e. extend all by some XActivity class .

however you can try more patches like create on BaseListActivity and on BaseActivity and use this listener in both of them, not necessarily need repetition of code, can be like implantation in separate class .

# java - 生产者/消费者多线程

> ID：12554390
> 
> 赞同：19
> 
> 时间：2012-09-23T17:10:54.227
> 
> 标签：java, multithreading

## 背景

没钱上学，我在收费站上夜班，并利用互联网自学一些编码技能，希望明天能找到更好的工作或在线销售我制作的一些应用程序。漫漫长夜，顾客寥寥。

我正在将*多线程*作为一个主题来处理，因为我在文献中遇到了很多使用它的代码（例如 Android SDK），但我仍然觉得它晦涩难懂。

### 精神

在这一点上，我的方法是：尝试编写我能想到的最基本的多线程示例，将我的头撞到墙上，看看我是否可以*伸展我的大脑*来适应一些新颖的思维方式。我将自己暴露在我的极限中，希望能超越它们。随意疯狂批评，吹毛求疵，并指出更好的方法来做我想做的事情。

## 客观的

*   *`Get some advice on how to do the above, based on my efforts so far (code provided)`*

## 练习

这是我定义的范围：

### 定义

创建两个类，它们在数据对象的生产和消费方面协同工作。一个**[线程](http://docs.oracle.com/javase/7/docs/api/java/lang/Thread.html)**创建对象并将它们传递到共享空间，以供另一个线程获取和使用。我们称之为生产线程`Producer`、消费线程`Consumer`和共享空间`SharedSpace`。生产对象以供他人消费的行为可以通过类比这种情况来同化：

```
`Producer`    (a busy mum making chocolate-covered cakes for his child, up to a limit)
`Consumer`    (a hungry child waiting to eat all cakes the mum makes, until told to stop)
`SharedSpace` (a kitchen table on which the cakes are put as soon as they become ready)
`dataValue`   (a chocolate-dripping cake which MUST be eaten immediately or else...) 
```

为了简化练习，我决定在孩子吃蛋糕的时候不让妈妈做饭*。*她只会等孩子吃完蛋糕，然后*立即*再做一个，达到一定的限度，以进行良好的育儿。练习的本质是练习[**Thread**](http://docs.oracle.com/javase/7/docs/api/java/lang/Thread.html)*的信号*，而不是实现任何并发。相反，我专注于完美的序列化，没有轮询或“我可以走了吗？” 检查。我想我将不得不编写后续练习，其中母亲和孩子接下来并行“工作”。[](http://docs.oracle.com/javase/7/docs/api/java/lang/Thread.html)

 **### 方法

*   让我的类实现**[Runnable](http://docs.oracle.com/javase/7/docs/api/java/lang/Runnable.html)**接口，以便它们有自己的代码入口点

*   使用我的类作为**[Thread](http://docs.oracle.com/javase/7/docs/api/java/lang/Thread.html)**对象的构造函数参数，这些对象从程序的`main`入口点 实例化并启动

*   通过**[Thread.join()](http://docs.oracle.com/javase/7/docs/api/java/lang/Thread.html#join%28%29)**确保`main`程序不会在[**Thread之前终止**](http://docs.oracle.com/javase/7/docs/api/java/lang/Thread.html)

*   `Producer`为将创建数据的次数设置限制`Consumer`

*   就将用于表示数据生产结束的*标记*值达成一致`Produce`

*   日志获取共享资源的锁和数据生产/消费事件，包括工作线程的最终签核

*   从程序中创建一个`SharedSpace`对象，`main`并在开始之前将其传递给每个工作人员

*   在内部为每个工作人员存储`private`对对象的引用`SharedSpace`

*   `Consumer`在生成任何数据之前提供防护和消息以描述准备好使用的条件

*   `Producer`在给定次数的迭代后停止

*   `Consumer`读取哨兵值后停止

## 代码

* * *

```
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
class Consumer extends Threaded {
  public Consumer(SharedSpace sharedSpace) {
    super(sharedSpace);
  }
  @Override
  public void run() {
    super.run();
    int consumedData = 0;
    while (consumedData != -1) {
      synchronized (sharedSpace) {
        logger.info("Acquired lock on sharedSpace.");
        consumedData = sharedSpace.dataValue;
        if (consumedData == 0) {
          try {
            logger.info("Data production has not started yet. "
                + "Releasing lock on sharedSpace, "
                + "until notification that it has begun.");
            sharedSpace.wait();
          } catch (InterruptedException interruptedException) {
            logger.error(interruptedException.getStackTrace().toString());
          }
        } else if (consumedData == -1) {
          logger.info("Consumed: END (end of data production token).");
        } else {
          logger.info("Consumed: {}.", consumedData);
          logger.info("Waking up producer to continue data production.");
          sharedSpace.notify();
          try {
            logger.info("Releasing lock on sharedSpace "
                + "until notified of new data availability.");
            sharedSpace.wait();
          } catch (InterruptedException interruptedException) {
            logger.error(interruptedException.getStackTrace().toString());
          }
        }
      }
    }
    logger.info("Signing off.");
  }
}
class Producer extends Threaded {
  private static final int N_ITERATIONS = 10;
  public Producer(SharedSpace sharedSpace) {
    super(sharedSpace);
  }
  @Override
  public void run() {
    super.run();
    int nIterations = 0;
    while (nIterations <= N_ITERATIONS) {
      synchronized (sharedSpace) {
        logger.info("Acquired lock on sharedSpace.");
        nIterations++;
        if (nIterations <= N_ITERATIONS) {
          sharedSpace.dataValue = nIterations;
          logger.info("Produced: {}", nIterations);
        } else {
          sharedSpace.dataValue = -1;
          logger.info("Produced: END (end of data production token).");
        }
        logger.info("Waking up consumer for data consumption.");
        sharedSpace.notify();
        if (nIterations <= N_ITERATIONS) {
          try {
            logger.info("Releasing lock on sharedSpace until notified.");
            sharedSpace.wait();
          } catch (InterruptedException interruptedException) {
            logger.error(interruptedException.getStackTrace().toString());
          }
        }
      }
    }
    logger.info("Signing off.");
  }
}
class SharedSpace {
  volatile int dataValue = 0;
}
abstract class Threaded implements Runnable {
  protected Logger logger;
  protected SharedSpace sharedSpace;
  public Threaded(SharedSpace sharedSpace) {
    this.sharedSpace = sharedSpace;
    logger = LoggerFactory.getLogger(this.getClass());
  }
  @Override
  public void run() {
    logger.info("Started.");
    String workerName = getClass().getName();
    Thread.currentThread().setName(workerName);
  }
}
public class ProducerConsumer {
  public static void main(String[] args) {
    SharedSpace sharedSpace = new SharedSpace();
    Thread producer = new Thread(new Producer(sharedSpace), "Producer");
    Thread consumer = new Thread(new Consumer(sharedSpace), "Consumer");
    producer.start();
    consumer.start();
    try {
      producer.join();
      consumer.join();
    } catch (InterruptedException interruptedException) {
      interruptedException.printStackTrace();
    }
  }
} 
```

* * *

## 执行日志

* * *

```
Consumer - Started.
Consumer - Acquired lock on sharedSpace.
Consumer - Data production has not started yet. Releasing lock on sharedSpace, until notification that it has begun.
Producer - Started.
Producer - Acquired lock on sharedSpace.
Producer - Produced: 1
Producer - Waking up consumer for data consumption.
Producer - Releasing lock on sharedSpace until notified.
Consumer - Acquired lock on sharedSpace.
Consumer - Consumed: 1.
Consumer - Waking up producer to continue data production.
Consumer - Releasing lock on sharedSpace until notified of new data availability.
Producer - Acquired lock on sharedSpace.
Producer - Produced: 2
Producer - Waking up consumer for data consumption.
Producer - Releasing lock on sharedSpace until notified.
Consumer - Acquired lock on sharedSpace.
Consumer - Consumed: 2.
Consumer - Waking up producer to continue data production.
Consumer - Releasing lock on sharedSpace until notified of new data availability.
Producer - Acquired lock on sharedSpace.
Producer - Produced: 3
Producer - Waking up consumer for data consumption.
Producer - Releasing lock on sharedSpace until notified.
Consumer - Acquired lock on sharedSpace.
Consumer - Consumed: 3.
Consumer - Waking up producer to continue data production.
Consumer - Releasing lock on sharedSpace until notified of new data availability.
Producer - Acquired lock on sharedSpace.
Producer - Produced: 4
Producer - Waking up consumer for data consumption.
Producer - Releasing lock on sharedSpace until notified.
Consumer - Acquired lock on sharedSpace.
Consumer - Consumed: 4.
Consumer - Waking up producer to continue data production.
Consumer - Releasing lock on sharedSpace until notified of new data availability.
Producer - Acquired lock on sharedSpace.
Producer - Produced: 5
Producer - Waking up consumer for data consumption.
Producer - Releasing lock on sharedSpace until notified.
Consumer - Acquired lock on sharedSpace.
Consumer - Consumed: 5.
Consumer - Waking up producer to continue data production.
Consumer - Releasing lock on sharedSpace until notified of new data availability.
Producer - Acquired lock on sharedSpace.
Producer - Produced: 6
Producer - Waking up consumer for data consumption.
Producer - Releasing lock on sharedSpace until notified.
Consumer - Acquired lock on sharedSpace.
Consumer - Consumed: 6.
Consumer - Waking up producer to continue data production.
Consumer - Releasing lock on sharedSpace until notified of new data availability.
Producer - Acquired lock on sharedSpace.
Producer - Produced: 7
Producer - Waking up consumer for data consumption.
Producer - Releasing lock on sharedSpace until notified.
Consumer - Acquired lock on sharedSpace.
Consumer - Consumed: 7.
Consumer - Waking up producer to continue data production.
Consumer - Releasing lock on sharedSpace until notified of new data availability.
Producer - Acquired lock on sharedSpace.
Producer - Produced: 8
Producer - Waking up consumer for data consumption.
Producer - Releasing lock on sharedSpace until notified.
Consumer - Acquired lock on sharedSpace.
Consumer - Consumed: 8.
Consumer - Waking up producer to continue data production.
Consumer - Releasing lock on sharedSpace until notified of new data availability.
Producer - Acquired lock on sharedSpace.
Producer - Produced: 9
Producer - Waking up consumer for data consumption.
Producer - Releasing lock on sharedSpace until notified.
Consumer - Acquired lock on sharedSpace.
Consumer - Consumed: 9.
Consumer - Waking up producer to continue data production.
Consumer - Releasing lock on sharedSpace until notified of new data availability.
Producer - Acquired lock on sharedSpace.
Producer - Produced: 10
Producer - Waking up consumer for data consumption.
Producer - Releasing lock on sharedSpace until notified.
Consumer - Acquired lock on sharedSpace.
Consumer - Consumed: 10.
Consumer - Waking up producer to continue data production.
Consumer - Releasing lock on sharedSpace until notified of new data availability.
Producer - Acquired lock on sharedSpace.
Producer - Produced: END (end of data production token).
Producer - Waking up consumer for data consumption.
Producer - Signing off.
Consumer - Acquired lock on sharedSpace.
Consumer - Consumed: END (end of data production token).
Consumer - Signing off. 
```

* * *

## 问题

*   以上是正确的吗？（例如，它是否使用了正确的语言工具、正确的方法、是否包含任何愚蠢的代码……）

### 但它“看起来正确”？

即使输出“看起来不错”，我也会询问正确性，因为您无法想象在我的测试“一次”而不是“另一次”中出现了多少次问题（例如，当消费者首先开始时，当生产者从未退出时在生产哨兵等之后）。我学会了不要从“成功的运行”中声称正确。相反，我对伪并行代码变得非常怀疑！（根据定义，这个甚至不是平行的！0

## 扩展答案

一个好的问题只关注`one requested piece of advice`（上述问题），但如果您愿意，请随时在您的答案中提及对以下其他主题的任何见解：

*   在编写下一次尝试时如何测试并行代码？

*   哪些工具可以帮助我进行开发和调试？考虑我使用**[Eclipse](http://eclipse.org/)**

*   如果我允许`Producer`继续生产，每次生产花费一些可变的时间，而`Consumer`消费任何可用的东西，方法会改变吗？锁定是否必须移动到其他地方？信号是否需要从这种等待/通知范式中改变？

*   这种做事的方法是否*已经过时*，我应该学习其他东西吗？从这个收费站，我不知道“在 Java 的真实世界中”会发生什么

### 下一步

*   我应该从这里去哪里？我在某处看到过*“未来”的概念，但我可以使用一个**编号的主题列表*来按顺序完成，按教学顺序进行，并带有指向相关学习资源的链接

* * *

*蒂诺·西诺*

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-25T20:51:45.603

> 以上是正确的吗？

我看到的唯一问题是@Tudor 和@Bhaskar 提到的问题。每当你在等待一个条件时测试它，你*必须*使用一个`while`循环。然而，这更多的是与多个生产者和消费者的竞争条件。可能会发生虚假唤醒，但竞争条件更有可能发生。请参阅[我关于该主题的页面](http://256stuff.com/gray/docs/misc/producer_consumer_race_conditions/)。

是的，您只有 1 个生产者和 1 个消费者，但您可以尝试为多个消费者扩展代码或将代码复制到另一个场景。

> 我学会了不要从“成功的运行”中声称正确。相反，我对伪并行代码变得非常怀疑！

好本能。

> 在编写下一次尝试时如何测试并行代码？

这很难。扩大规模是一种方法。添加多个生产者和消费者，看看是否有问题。在具有不同数量/类型的处理器的多个架构上运行。你最好的防御将是代码的正确性。紧密同步，很好地使用`BlockingQueue`,`ExecutorService`等类，使您的关闭更简单/更干净。

没有简单的答案。测试多线程代码非常困难。

> 哪些工具可以帮助我进行开发和调试？

就一般的东西而言，我会研究像[Emma](http://emma.sourceforge.net/)这样的覆盖工具，这样你就可以确保你的单元测试覆盖了你的所有代码。

在多线程代码测试方面，了解如何读取`kill -QUIT`线程转储并查看 Jconsole 内部正在运行的线程。[像YourKit](http://www.yourkit.com/)这样的 Java 分析器也可能会有所帮助。

> 如果我允许 Producer 继续制作，每次制作都需要一些可变的时间，这种方法会改变吗？

我不这么认为。消费者将永远等待生产者。也许我不明白这个问题？

> 这种做事的方法是否已经过时，我应该学习其他东西吗？从这个收费站，我不知道“在 Java 的真实世界中”会发生什么

接下来是学习[`ExecutorService`课程](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/ExecutorService.html)。它们处理大部分`new Thread()`样式代码——尤其是当您处理大量使用线程执行的异步任务时。这是一个[教程](http://tutorials.jenkov.com/java-util-concurrent/executorservice.html)。

> 我应该从这里去哪里？

再次，`ExecutorService`。我假设您已阅读[此起始文档](http://docs.oracle.com/javase/tutorial/essential/concurrency/)。正如@Bhaskar 所提到的，[Java Concurrency in Practice](http://www.google.co.uk/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&cad=rja&ved=0CCAQFjAA&url=http://www.cs.unicam.it/culmone/?download=java_concurrency_in_practice.pdf&ei=aURfUMK2O4Wa0QWlpoCYCQ&usg=AFQjCNHlTD9PfmbFBll97WnuCrFFPDDLBQ&sig2=TwGQw8YtwzYokaVMXSBD8A)是一本很好的圣经。

* * *

以下是关于您的代码的一些一般性评论：

*   `SharedSpace`and`Threaded`类似乎是一种人为的方式来做到这一点。如果您正在玩基类等，那很好。但总的来说，我从不使用这样的模式。生产者和消费者通常使用`BlockingQueue`类似的东西[`LinkedBlockingQueue`](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/LinkedBlockingQueue.html)，在这种情况下，同步和`volatile`有效负载会为您处理。此外，我倾向于将共享信息注入对象构造函数，而不是从基类中获取。

*   通常，如果我使用`synchronized`它是在一个`private final`字段上。`private final Object lockObject = new Object();`除非我已经在使用对象，否则我通常会创建一个用于锁定的对象。

*   小心`synchronized`大块并将日志消息放在`synchronized`部分内。日志通常`synchronized`对文件系统进行 IO，这可能非常昂贵。如果可能的话，你应该有小的、非常紧的`synchronized`块。

*   您`consumedData`在循环之外定义。我会在分配点定义它，然后使用 a`break`从循环中退出（如果是）`== -1`。如果可能，请确保限制您的局部变量范围。

*   您的日志消息将主导您的代码性能。这意味着当您删除它们时，您的代码将执行*完全*不同的操作。当您使用它来调试问题时，意识到这一点*非常重要。*当您迁移到具有不同 CPU/内核的不同架构时，性能也（很可能）会发生变化。

*   您可能知道这一点，但是当您调用时`sharedSpace.notify();`，这仅意味着如果另一个线程当前在中，则会*通知*`sharedSpace.wait();`它。如果它不是其他东西，那么它将错过通知。仅供参考。

*   做 a 有点奇怪`if (nIterations <= N_ITERATIONS)`，然后在下面的 3 行`else`再做一次。复制`notify()`会更好地简化分支。

*   然后你有`int nIterations = 0;`一个`while`然后在一个++中。这是 for 循环的秘诀：

    ```
    for (int nIterations = 0; nIterations <= N_ITERATIONS; nIterations++) { 
    ```

* * *

这是您的代码的更严格的版本。这只是我将如何编写它的一个示例。同样，除了丢失之外`while`，您的版本似乎没有任何问题。

```
public class Consumer implements Runnable {
    private final BlockingQueue<Integer> queue;
    public Consumer(BlockingQueue<Integer> queue) {
       this.queue = queue;
    }
    @Override
    public void run() {
       while (true) {
          int consumedData = queue.take();
          if (consumedData ==  Producer.FINAL_VALUE) {
              logger.info("Consumed: END (end of data production token).");
              break;
          }
          logger.info("Consumed: {}.", consumedData);
       }
       logger.info("Signing off.");
    }
}

public class Producer implements Runnable {
    public static final int FINAL_VALUE = -1;
    private final BlockingQueue<Integer> queue;
    public Producer(BlockingQueue<Integer> queue) {
       this.queue = queue;
    }
    @Override
    public void run() {
       for (int nIterations = 0; nIterations <= N_ITERATIONS; nIterations++) {
          logger.info("Produced: {}", nIterations);
          queue.put(nIterations);
       }
       queue.put(FINAL_VALUE);
       logger.info("Produced: END (end of data production token).");
       logger.info("Signing off.");
    }
}

public class ProducerConsumer {
    public static void main(String[] args) {
       // you can add an int argument to the LinkedBlockingQueue constructor
       // to only allow a certain number of items in the queue at one time
       BlockingQueue<Integer> queue = new LinkedBlockingQueue<Integer>();
       Thread producer = new Thread(new Producer(queue), "Producer");
       Thread consumer = new Thread(new Consumer(queue), "Consumer");
       // start and join go here
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-23T17:34:00.183

你似乎在这里做得很好。其实没什么好挑剔的。我想*推荐*的一个想法是您应该避免在缓冲区对象本身上进行同步。在这种情况下没关系，但是假设您切换到数据结构缓冲区，这取决于它可能在内部同步的类（例如`Vector`，虽然它现在已经过时了），所以从外部获取锁可能会搞砸。

**编辑**：Bhaskar 提出了一个很好的观点，即使用 a`while`来包装对`wait`. 这是因为可能发生臭名昭著的虚假唤醒，迫使线程`wait`过早退出，因此您需要确保它重新进入。

您接下来可以做的是实现一个有限缓冲区生产者消费者：拥有一些共享数据结构，例如链表并设置最大大小（例如 10 个项目）。然后让生产者继续生产，并且只有在队列中有 10 个项目时才暂停它。只要缓冲区为空，消费者就会被挂起。

您可以采取的下一步是学习如何自动化您手动实施的流程。看看`BlockingQueue`它提供了一个具有阻塞行为的缓冲区（即，如果缓冲区为空，消费者将自动阻塞，如果缓冲区已满，生产者将自动阻塞）。

此外，根据具体情况，执行器（查看`ExecutorService`）可能是一个有价值的替代品，因为它们封装了一个任务队列和一个或多个工人（消费者），所以您只需要生产者。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-23T17:49:47.120

`Producer`s and `Consumer`s can be simple classes implementing `Runnable` ( no `extends Threaded` ) That way they are less fragile. Clients can create `Thread`s themeselves and attach the instances so no overhead of a class hierarchy is needed.

Your condition before you `wait()` should be a `while()` rather than an `if` .

edit: from JCIP page 301 :

```
void stateDependentMethod() throws InterruptedException {
      // condition predicate must be guarded by lock
      synchronized(lock) {
          while (!conditionPredicate())
            lock.wait();
          // object is now in desired state
       }
  } 
```

You have builtin the condition to stop statically. Normally , producers and consumers ought to be more flexible- they should be able to respond to an external signal for stopping.

For starters , to implement an external stop signal , you have a flag :

```
class Producer implements Runnable { 
     private volatile boolean stopRequested ;

     public void run() {
        while(true){
           if(stopRequested )
                // get out of the loop
         }
     }

     public void stop(){
        stopRequested  = true;
        // arrange to  interrupt the Producer thread here.
     }
 } 
```

When you try to implement the above , you will probably see that there are other complications that arise - for example - your producer is first publishing and then `wait()` ing , but that can lead to problems.

If you are interested in further reading , I suggest read the book - [Java Concurrency In Practice](http://www.google.co.uk/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&cad=rja&ved=0CCAQFjAA&url=http://www.cs.unicam.it/culmone/?download=java_concurrency_in_practice.pdf&ei=aURfUMK2O4Wa0QWlpoCYCQ&usg=AFQjCNHlTD9PfmbFBll97WnuCrFFPDDLBQ&sig2=TwGQw8YtwzYokaVMXSBD8A). This will have a whole lot of recommendations than I can add here.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-07-09T10:12:51.090

巨大的野心！大约 8 年前，你问过这个问题。我希望您的努力为您提供（并继续为您提供）您想要的教育。

这些天来`wait()`，强烈建议不要在 Java 中实现多线程。当你试图在这个低级别控制并发时，你很容易自责（事实上，Java 设计者承认许多方法和语义实际上是设计错误，但为了向后兼容的目的，他们不得不留下它们—— - 许多人正在使用新的“虚拟线程”（Project Loom）——但这是一个不同的话题）。`notify()``join()``Thread`

今天手动启动和控制线程的首选方式是 via `ExecutorService.submit(Callable<V>)`，返回一个`Future<V>`. 然后，您可以通过调用等待线程退出（并获取返回值）`Future<V>.get()`，返回由可调用对象返回的类型值`V`（或者`ExecutionException`如果`Callable`抛出未捕获的异常则抛出）。

下面的类是一个如何实现这样的例子的例子。这将通过单个有界阻塞队列将任意数量的生产者连接到任意数量的消费者。（来自线程的返回值被忽略，因此`ExecutorService.submit(Runnable)`称为返回`Future<?>`，而不是`ExecutorService.submit(Callable<V>)`）。

```
import java.util.ArrayList;
import java.util.List;
import java.util.Optional;
import java.util.concurrent.ArrayBlockingQueue;
import java.util.concurrent.BlockingQueue;
import java.util.concurrent.Callable;
import java.util.concurrent.CancellationException;
import java.util.concurrent.ExecutionException;
import java.util.concurrent.ExecutorService;
import java.util.concurrent.Executors;
import java.util.concurrent.Future;

public abstract class ProducerConsumer<E> {

    private final BlockingQueue<Optional<E>> queue;

    public ProducerConsumer(
            int numProducerThreads, int numConsumerThreads, int queueCapacity) {
        if (numProducerThreads < 1 || numConsumerThreads < 1 || queueCapacity < 1) {
            throw new IllegalArgumentException();
        }
        queue = new ArrayBlockingQueue<Optional<E>>(queueCapacity);
        final ExecutorService executor = 
                Executors.newFixedThreadPool(numProducerThreads + numConsumerThreads);
        try {
            // Start producer threads
            final List<Future<?>> producerFutures = new ArrayList<>();
            final AtomicInteger numLiveProducers = new AtomicInteger();
            for (int i = 0; i < numProducerThreads; i++) {
                producerFutures.add(executor.submit(() -> {
                    numLiveProducers.incrementAndGet();
                    // Run producer
                    producer();
                    // When last producer finishes, deliver poison pills to consumers
                    if (numLiveProducers.decrementAndGet() == 0) {
                        for (int j = 0; j < numConsumerThreads; j++) {
                            queue.put(Optional.empty());
                        }
                    }
                    return null;
                }));
            }
            // Start consumer threads
            final List<Future<?>> consumerFutures = new ArrayList<>();
            for (int i = 0; i < numConsumerThreads; i++) {
                consumerFutures.add(executor.submit(() -> {
                    // Run Consumer
                    consumer();
                    return null;
                }));
            }
            // Wait for all producers to complete
            completionBarrier(producerFutures, false);
            // Shut down any consumers that are still running after producers complete
            completionBarrier(consumerFutures, false);
        } finally {
            executor.shutdownNow();
        }
    }

    private static void completionBarrier(List<Future<?>> futures, boolean cancel) {
        for (Future<?> future : futures) {
            try {
                if (cancel) {
                    future.cancel(true);
                }
                future.get();
            } catch (CancellationException | InterruptedException e) {
                // Ignore
            } catch (ExecutionException e) {
                throw new RuntimeException(e);
            }
        }
    }

    protected void produce(E val) {
        try {
            queue.put(Optional.of(val));
        } catch (InterruptedException e) {
            throw new RuntimeException(e);
        }
    }

    protected Optional<E> consume() {
        try {
            return queue.take();
        } catch (InterruptedException e) {
            throw new RuntimeException(e);
        }
    }

    /** Producer loop. Call {@link #produce(E)} for each element. */
    public abstract void producer();

    /**
     * Consumer thread. Call {@link #consume()} to get each successive element,
     * until an empty {@link Optional} is returned.
     */
    public abstract void consumer();
} 
```

使用如下：

```
new ProducerConsumer<Integer>(/* numProducerThreads = */ 1, /* numConsumerThreads = */ 4,
        /* queueCapacity = */ 10) {
    @Override
    public void producer() {
        for (int i = 0; i < 100; i++) {
            System.out.println("Producing " + i);
            produce(i);
        }
    }

    @Override
    public void consumer() {
        for (Optional<Integer> opt; (opt = consume()).isPresent; ) {
            int i = opt.get();
            System.out.println("Got " + i);
        }
    }
}; 
```**

# python - __call__ vs. __init__：谁得到了论据？谁先被叫到？

> ID：12554397
> 
> 赞同：1
> 
> 时间：2012-09-23T17:11:59.040
> 
> 标签：python, class

> **可能重复：**[python中的](https://stackoverflow.com/questions/9663562/what-is-difference-between-init-and-call-in-python)[**init**](https://stackoverflow.com/questions/9663562/what-is-difference-between-init-and-call-in-python)[和](https://stackoverflow.com/questions/9663562/what-is-difference-between-init-and-call-in-python)[**call**](https://stackoverflow.com/questions/9663562/what-is-difference-between-init-and-call-in-python)
> [有什么区别？](https://stackoverflow.com/questions/9663562/what-is-difference-between-init-and-call-in-python)

 ****我正在尝试创建一个可调用的类，该类将接受参数，然后将自身作为对象返回。

```
class User(object):
    def __init__(self, loginName, password):
        self.loginName = loginName

    def __call__(self):
        if self.login():
            return self
        return None

    def login(self):
        database = db.connection
        realUser = database.checkPassWord(self.loginName, self.password)
        return realUser 
```

我的问题是，如果我这样称呼这个对象：

```
newUserObject = User(submittedLoginName) 
```

之前会`__init__`被调用`__call__`吗？应该`__init__`得到论点还是我应该将论点转移到`__call__`喜欢

```
def __call__(self, loginName): 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-23T17:14:58.520

`__call__` is only called on an instance that defines itself as callable.

`__init__` is the initializer that provided an instance of the class

If you do something like

`MyObject()()` Then you are initliaizing THEN calling.

Using your own example

```
class User(object):
    def __init__(self, loginName, password):
        self.loginName = loginName
        self.password = password

    def __call__(self):
        if self.login():
            return self
        return None

    def login(self):
        database = db.connection
        return database.checkPassWord(self.loginName, self.password)

a = User("me", "mypassword")
a = a() # a is now either None or an instance that is aparantly logged in. 
```****

# php - 数据库决定选择创建监控服务器项目的方式

> ID：12554403
> 
> 赞同：-1
> 
> 时间：2012-09-23T17:12:42.557
> 
> 标签：php, mysql, database

我正在开发一个名为“监控服务器”的项目，我需要从头开始。当我计划数据库表时，我对如何以及在哪里启动数据库表感到困惑。

1.  Register.php (db_register 其中 user_id 是主键)
2.  login.php（db_login 其中 user_id 是主键）
3.  servers.php (db_servers) = 这里每个用户都可以添加多个服务器，并且应该根据登录的用户可见。例如，User1 登录并添加了他自己的服务器（比如 google.com） user2 添加了 yahoo.com

那么我是否需要为每个用户创建单独的数据库？
或者
创建所有具有区分唯一 user_id 的常用表就足够了？

各位大神能给我一些建议吗？?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T17:15:32.080

您需要查看称为外键 (http://en.wikipedia.org/wiki/Foreign_key) 的东西。

这些用于将关系表链接在一起。

例如，用户表的主键为 user_id。

服务器表的主键为 server_id，外键为 user_id。这用于将该服务器与用户相关联。

如果您想获取某个用户拥有的所有服务器（假设该用户的 user_id 为 5），您可以执行如下查询：

```
SELECT * FROM `db_servers` WHERE `user_id` = 5 
```

# c# - 迭代重复的 xml 元素

> ID：12554406
> 
> 赞同：1
> 
> 时间：2012-09-23T17:13:27.300
> 
> 标签：c#, .net, xml, windows-phone-7, xml-parsing

我有一个这样的 XML 文档：

```
 <author>someone</author> 
  <category>Severe Disruption - 5 hours</category> 
  <category>Roadworks</category>
  <pubDate>Sun, 23 Sep 2012 05:07:39 BST</pubDate> 
```

我现有的代码是这样的：

```
 _xml = XElement.Parse(e.Result);
                highwaysResults.Items.Clear();
                foreach (XElement value in _xml.Elements("channel").Elements("item"))
                {
                    highwaysFeedItem _item = new highwaysFeedItem();
                    _item.Title = value.Element("title").Value;
                    _item.Description =    Regex.Replace(value.Element("description").Value,
                    @"<(.|\n)*?>", String.Empty);
                    _item.PubDate = value.Element("pubDate").Value;
                    _item.Category = value.Element("category").Value;
                    _item.Category2 = value.Element("category").Value;

                        highwaysResults.Items.Add(_item); 
```

问题是，我的代码只读取第一个“类别”值，但我现在使用的 XML 有两个“类别”值。

我只想阅读第二个“类别”值。阅读两者都会是额外的，但不是必需的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T17:16:24.543

只需使用`value.Elements("category")`和迭代这些项目。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-24T03:55:05.500

使用 XPath：`using System.Xml.XPath;`您可以选择第二个类别元素。

```
_item.Category2 = value.XPathSelectElement("category[2]").Value; 
```

# php - nl2br() 工作不正常

> ID：12554409
> 
> 赞同：1
> 
> 时间：2012-09-23T17:13:42.190
> 
> 标签：php, mysql, html, textarea

我正在使用以下内容将来自 textarea 的帖子提交到我的 mysql 数据库，以便在输出中保留单/双/三行间距。：

```
$update = nl2br(htmlentities($string, ENT_QUOTES, 'UTF-8')); 
```

有时它可以工作，但有时双行空间会被单行空间替换，而其他时候双行空间会被保留。这是我的输出，所有这些都是使用双行空格输入的（按两次输入）。任何有关如何改进这一点的建议将不胜感激：

```
 something

    went

    a 
    little

    wrong
    there 
```

谢谢普林佐恩。下面是相关表的 CREATE TABLE 语句。

```
如果不存在 `ticket_updates` 则创建表（
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `ticket_id` varchar(100) NOT NULL,
  `update` 文本不为空，
  `time` 时间戳 NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `member_id` varchar(100) NOT NULL,
  主键（`id`）
) 引擎=InnoDB 默认字符集=utf8 AUTO_INCREMENT=28 ;

```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-01T07:20:40.893

如果您使用 htmlentities() 它会将“\n”编码为“%5Cn”。因此，获得实际输出可能会产生问题。

试试下面的代码，可能会帮助你找到你需要的实际输出。

`echo htmlentities($string, ENT_QUOTES, 'UTF-8');`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-18T06:51:39.397

我的问题是由于使用`wordwrap()`尝试格式化输出而不是由于：

```
nl2br(htmlentities($string, ENT_QUOTES, 'UTF-8')); 
```

我将我的更改`wordwrap($update, 50, "&nbsp;\n", true)`为 CSS3 属性`word-break:break-all;`（`word-break:break-word;`不适用于 IE9）

# java - 如何使用 Java 和 MySQL 将值插入到已经可用表中的特定列中

> ID：12554413
> 
> 赞同：0
> 
> 时间：2012-09-23T17:13:56.897
> 
> 标签：java, mysql

我有一个从文本文件中读取行的 Java 程序。我想将读取行插入到 MySQL 数据库中创建的表中已有记录的列中。

已经可用的表由 4 列组成。col1: pk 和自动递增编号 col2: text col3: int col4: text

Col4 是从文本文件中读取每一行后要添加的值。我尝试使用以下内容：

```
Query= "insert into db.table values (?)";
preparedStmt3 = DBConnection.con.prepareStatement(Query); 
```

然后在我从文本文件中读取该行之后，我执行以下操作；

```
 preparedStmt3.setString (3, line); 
```

我需要插入的列是第 4 列。但是，我收到以下错误：

```
DB_Error:_java.sql.SQLException: Parameter index out of range (3 > number of parameters, which is 1). 
```

我的问题：如何使用 Java 在 MySQL 数据库的特定列中插入值而不影响记录中的任何值（包括 pk 自动增量值在内的所有其他列都已插入，根本不需要更改）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T17:20:09.363

我不明白您为什么将其用作`3`参数`setString()`该函数的第一个参数是参数的占位符-查询中的问号-该占位符从该占位符开始，`1`而您只有一个占位符。

尝试，

```
preparedStmt3.setString (1, line); 
```

因为您的查询中只有一个占位符。如果这不是您所寻求的，那么重写您的查询。其实看了异常信息你就会意识到：index out of range *(3 > number of parameters, 也就是1)。*

如果您希望插入多个值，请将您的查询构造为：

```
`INSERT INTO table(c1, c2, c3) VALUES(?, ?, ?)` 
```

进而

```
prepStatement.setString(1, val); // Sets value for c1 
prepStatement.setString(2, val); // Sets value for c2
prepStatement.setString(3, val); // Sets value for c3 
```

# php - How to post a particular button from jQuery

> ID：12554416
> 
> 赞同：0
> 
> 时间：2012-09-23T17:14:11.400
> 
> 标签：php, jquery

How can I submit a particular button by jQuery without submitting other buttons in the same form

I want to post the delete button only when I click yes in jQuery confirmation box

```
$(document).ready(function(){
  $( "#dialog:ui-dialog" ).dialog( "destroy" );
  $( "#dialog-confirm" ).dialog({
    resizable: false,
    height:140,
    modal: true,
    buttons: {
      "Ok": function() {
        $('#form1').submit();
        //*****************************************************************
      },
      Cancel: function() {
        $( this ).dialog( "close" );
      }
    }
  });
}); 
```

Here I want to post only delete button in php without submitting whole form

```
$('#form1').submit(); 
```

What is the modification needs to be done in this code?

My PHP code

```
 if(isset($_POST['delete_btn'])  &&  $_POST['delete_btn']=='Delete' ){
    $rid=$_POST['roleid'];
    $sql_u="SELECT * FROM `user_mst` WHERE `role_id`=".$rid;
    mysql_query($sql_u,$conn) or die("Unable to execute query :". mysql_error());
 } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-23T17:17:24.557

Replace your following code:

```
$('#form1').submit(); 
```

for this one:

```
$('#id_delete').trigger('click'); 
```

where **id_delete** is the `id` of your delete button

# perl - 如何让 Cygwin/perl 加载一个特定的库 à la LD_LIBRARY_PATH/LD_RUN_PATH？

> ID：12554420
> 
> 赞同：1
> 
> 时间：2012-09-23T17:14:47.770
> 
> 标签：perl, dll, cygwin, ld, library-path

我看到的问题是`perl`在 Cygwin（1.7.15，截至 09/2012 的当前版本）上运行的进程中加载​​了错误版本的库。

简单地说，`perl`starts，does `use XML::LibXML`，它是 Daniel Veillard 的 XML 的 C 库的 Perl 接口`libxml2`，然后 Perl/C 胶水加载 C 库。现在，安装了两个版本，一个较旧的版本`/usr/lib`和一个较新的版本`/usr/local/lib`- 一个典型的场景。Perl/C 胶水库 ( `XML::LibXML`) 是针对`/usr/local/lib`. 然而，负责加载库的 Perl 或 Cygwin 组件会选择旧的。这会触发 Perl/C 粘合代码的警告，该代码正确地期望并要求它编译时所针对的版本。（由于向后兼容性，它仍然可以正常工作，但并不完全符合预期。）

需要注意的一件事，在 Cygwin 上不是`lib/libxml2.so.2`，而是`bin/cygxml2-2.dll`！

这是从屏幕复制的操作：

```
MiLu@Dago: /tmp > export LD_LIBRARY_PATH=/usr/local/bin
MiLu@Dago: /tmp > export LD_RUN_PATH=/usr/local/bin
MiLu@Dago: /tmp > ls -l /usr/bin/cygxml2-2.dll
-rwxr-xr-x 1 MiLu root 1096206  1\. Mrz 2012  /usr/bin/cygxml2-2.dll
MiLu@Dago: /tmp > ls -l /usr/local/bin/cygxml2-2.dll
-rwxr-xr-x 1 MiLu None 3997813 21\. Mai 22:35 /usr/local/bin/cygxml2-2.dll
MiLu@Dago: /tmp > perl -MXML::LibXML -e1
Warning: program compiled against libxml 208 using older 207
Warning: XML::LibXML compiled against libxml2 20800,
                 but runtime libxml2 is older 20708 
```

我不确定如何加载C 库`cygxml2-2.dll`（标准名称）。`libxml2`

这是`ldd`Perl/C 胶水库的输出：

```
$ ldd /usr/lib/perl5/site_perl/5.14/i686-cygwin-threads-64int/auto/XML/LibXML/LibXML.dll
    ntdll.dll       => /cygdrive/c/Windows/SysWOW64/ntdll.dll (0x774a0000)
    kernel32.dll    => /cygdrive/c/Windows/syswow64/kernel32.dll (0x756c0000)
    KERNELBASE.dll  => /cygdrive/c/Windows/syswow64/KERNELBASE.dll (0x76750000)
    cygwin1.dll     => /usr/bin/cygwin1.dll (0x61000000)
    cygssp-0.dll    => /usr/bin/cygssp-0.dll (0x6af50000)
>>> cygxml2-2.dll   => /usr/local/bin/cygxml2-2.dll (0x63fc0000) <<<
    cygz.dll        => /usr/bin/cygz.dll (0x6a900000)
    cyggcc_s-1.dll  => /usr/bin/cyggcc_s-1.dll (0x6ca60000)
    cygiconv-2.dll  => /usr/bin/cygiconv-2.dll (0x6c390000)
    cygperl5_14.dll => /usr/bin/cygperl5_14.dll (0x6b8a0000)
    cygcrypt-0.dll  => /usr/bin/cygcrypt-0.dll (0x6d3d0000)
    ???             => ??? (0x520000) 
```

如您所见，新库的位置正确，就像在 UNIX 上一样。但这`ldd`不是实际过程，它可能使用不同的查找机制。

使用`strace perl … | grep -i cygxml`显示没有输出。

在我看来，`LD_LIBRARY_PATH`并被`LD_RUN_PATH`忽略了。因为如果不是，为什么我会收到版本不匹配警告？

库加载机制是特定于`perl`Cygwin 还是 Cygwin？它是如何工作的？如何制作`perl`或 Cygwin 加载正确的库？

[我的一个怀疑是，它`perl`驻留在 中`/usr/bin`，它将*首先*在其二进制文件目录中查找库`/usr/bin`，因此遵循 Windows 约定而不是 UNIX 约定。]

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-24T02:02:16.830

在编写 Alien::Base 时，我需要使用 DynaLoader 直接 dlopen 特定库。[你可以在这里](https://github.com/jberger/Alien-Base/blob/master/lib/Alien/Base.pm)阅读代码，但快速和肮脏的应该是简单的

```
require DynaLoader;
DynaLoader::dl_load_file( $library_path, 0x01 ) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T21:48:35.773

cygwin 确实支持 LD_LIBRARY_PATH；尝试在脚本开头检查它是否按预期设置：

```
BEGIN { print "LD_LIBRARY_PATH: $ENV{LD_LIBRARY_PATH}.\n" } 
```

# python - mapping keys (all occur in the given string) to the position in string

> ID：12554422
> 
> 赞同：2
> 
> 时间：2012-09-23T17:15:11.480
> 
> 标签：python

I am trying to get all indexes of the keys in the string and store them in a dict, so that every index has a list of keys mapping to it.

Example:

```
string = "loloo and foofoo at the foo bar"
keys = "foo", "loo", "bar", "lo" 
```

i expect something like

```
{ 
  0: [lo]
  2: [loo, lo]
 10: [foo]
 13: [foo]
 24: [foo]
 28: [bar]
} 
```

My current answer loos the following:

```
def get_index_for_string(string, keys):
    """
    Get all indexes of the keys in the string and store them in a dict, so that
    every index has a list of keys mapping to it.
    """
    key_in_string = dict((key, [m.start() for m in re.finditer(key, string)])
                            for key in keys if key in string)
    index_of_keys = {}
    for key, values in key_in_string.items():
        for value in values:
            if not value in index_of_keys:
                index_of_keys[value] = []
            index_of_keys[value].append(key)
    return index_of_keys 
```

Any suggestions on how to make this better?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T17:29:15.233

`Non-regex`方法：

using `str.find()`,`str.find()`接受可选的第二个参数，它是您要查找单词的索引。

```
def indexes(word,strs):
    ind=0                #base index is 0
    res=[]
    while strs.find(word,ind)!=-1:   #loop until str.find() doesn't return -1
        ans=strs.find(word,ind)
        res.append(ans)
        ind=ans+1                 #change base index if the word is found
    return res     

strs = "loloo and foofoo at the foo bar"
keys = ["foo", "loo", "bar", "lo"]

print {x:indexes(x,strs) for x in keys} 
```

**输出：**

```
{'lo': [0, 2], 'foo': [10, 13, 24], 'bar': [28], 'loo': [2]} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-23T19:22:36.270

首先，`re.escape`如果它包含句点或类似的东西，您将需要密钥。除此之外，您可以采取更直接的方法来构建结果字典：

```
from collections import defaultdict
def get_index_for_string(string, keys):
    res = defaultdict(list)
    for key in keys:
        for match in re.finditer(re.escape(key), string):
            res[match.start()].append(key)
    return res 
```

注意：除了使用`defaultdict`你还可以使用常规的 dict 和 do `res.setdefault(match.start(), []).append(key)`，但它看起来不那么漂亮。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-23T18:59:07.987

你在寻找什么样的“更好”？如果您需要更好的 Big-O 复杂性，请使用[Aho-Corasic Automaton](http://en.wikipedia.org/wiki/Aho%E2%80%93Corasick_string_matching_algorithm)。有可用于 Python 的快速实现：

*   [https://github.com/scoder/acora](https://github.com/scoder/acora)
*   [http://pypi.python.org/pypi/ahocorasick](http://pypi.python.org/pypi/ahocorasick)

# image - Combine RGB colors from several images

> ID：12554424
> 
> 赞同：1
> 
> 时间：2012-09-23T17:15:39.377
> 
> 标签：image, algorithm, image-processing, colors, rgb

I've several images with different color values, each value is 8-bit value. Every image represents the same frame. I'm trying to sum all images together to get a better picture. I've tried combining the colors using the average of the colors, however the combined picture is too dark. Is there a known algorithm that combines the colors?

Thanks

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T17:35:54.603

听起来您正在尝试使用多个颜色通道制作灰度图像。虽然平均可能有效，但一种标准方法是使用*[对数平均亮度](http://www.cacs.louisiana.edu/~cice/lal/index.html)*：

```
gray_pixel = 0.27*red + 0.67*green + 0.06*blue 
```

请注意，像这样的所有方法都试图根据人眼平均看到图像的方式来产生每种颜色的*感知亮度。*还有许多其他常数会产生类似的结果 - 有关客观和感知亮度的更多信息，请参阅[这个 StackOverflow 答案](https://stackoverflow.com/a/596243/679081)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-24T11:17:00.227

如果照片是几何校准的（即相机和场景在拍摄之间没有改变），只需平均所有图像中每个像素的值。这将减少噪音，并使您的结果保持颜色。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-04-02T07:29:12.683

您必须对彼此对应的每个像素的颜色进行平均。只需将图像彼此相加，然后按元素将其除以图像数量。如果您想从一个图像中获取一些区域，而从其他图像中获取其他区域，则必须对矩阵进行切片，然后将其值填充到新的空数组或零数组中。

# asp.net - 用 taglink 创建一个标签云？

> ID：12554425
> 
> 赞同：1
> 
> 时间：2012-09-23T17:15:42.663
> 
> 标签：asp.net, asp.net-mvc, asp.net-mvc-3, tag-cloud

我正在使用 ASP.NET MVC3 创建一个博客，我想为它创建一个 tagCloud。

现在我的问题是我如何将它放入列表中（我需要吗？），计算然后以不同的尺寸打印出来？

编辑：

我现在可以计算每个帖子中的每个标签，如下所示：

```
Dictionary<string, int> tagLista = new Dictionary<string, int>();

    foreach (Post post in Model)
    {
        foreach (Tag tag in post.Tags)
        {
            if (!tagLista.ContainsKey(tag.Name))
            {
                tagLista[tag.Name] = 1;
            }
            else
            {
                tagLista[tag.Name] += 1;
            }
        }
    }
    //Print out diff. sizes depending on count
    foreach (KeyValuePair<string, int> pair in tagLista)
    {

        if (pair.Value <= 2)
        {
                        <a class="minSize" href="@Href("~/Posts/Tags/" + pair.Key)">@pair.Key</a>
        }

        if (pair.Value > 2 && pair.Value <= 4)
        {
                        <a class="medSize" href="@Href("~/Posts/Tags/" + pair.Key)">@pair.Key</a>
        }
        if (pair.Value > 4 && pair.Value >= 6)
        {
                        <a class="maxSize" href="@Href("~/Posts/Tags/" + pair.Key)">@pair.Key</a> 
        }
    } 
```

现在的问题是它只显示当前页面上所有帖子的标签，而不是数据库中的所有标签。我应该怎么做呢？在这个视图（索引）的顶部，我使用：

```
@using Blog.Models;
@model IEnumerable<Post> 
```

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-24T11:47:05.240

我现在可以计算每个帖子中的每个标签，如下所示：

```
Dictionary<string, int> tagLista = new Dictionary<string, int>();

foreach (Post post in Model)
{
    foreach (Tag tag in post.Tags)
    {
        if (!tagLista.ContainsKey(tag.Name))
        {
            tagLista[tag.Name] = 1;
        }
        else
        {
            tagLista[tag.Name] += 1;
        }
    }
}
//Print out diff. sizes depending on count
foreach (KeyValuePair<string, int> pair in tagLista)
{

    if (pair.Value <= 2)
    {
                    <a class="minSize" href="@Href("~/Posts/Tags/" + pair.Key)">@pair.Key</a>
    }

    if (pair.Value > 2 && pair.Value <= 4)
    {
                    <a class="medSize" href="@Href("~/Posts/Tags/" + pair.Key)">@pair.Key</a>
    }
    if (pair.Value > 4 && pair.Value >= 6)
    {
                    <a class="maxSize" href="@Href("~/Posts/Tags/" + pair.Key)">@pair.Key</a> 
    }
} 
```

现在的问题是它只显示当前页面上所有帖子的标签，而不是数据库中的所有标签。我应该怎么做呢？在这个视图（索引）的顶部，我使用：

```
@using Blog.Models;
@model IEnumerable<Post> 
```

谢谢你的帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T17:31:03.157

我无法对此进行测试，但我希望这仍然有效：

```
var list = Model.SelectMany(x => x.Tags).GroupBy(x => x.Name, g => new {Name = g.Key, Amount = g.Count()}); 
```

返回包含标签名称及其各自数量的列表。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-24T10:43:32.580

你可以试试[这个](https://github.com/addywaddy/jquery.tagcloud.js/)jquery 插件。基本上，您应该根据标签对所有帖子进行分组。

```
<div id="tagCloud">
  foreach(var tag in Tags)
  {
    <a href="@tag.Path()" rel="@tag.Posts.Count">@tag.Name</a>
  }
</div>

$.fn.tagcloud.defaults = {
  size: {start: 14, end: 18, unit: 'pt'},
  color: {start: '#cde', end: '#f52'}
};

$(function () {
  $('#tagCloud a').tagcloud();
}); 
```

# java - 递归作业

> ID：12554430
> 
> 赞同：3
> 
> 时间：2012-09-23T17:16:20.363
> 
> 标签：java, recursion

我有一个作业问题，我可能想多了，我需要`Hello.`使用递归来反转，以便最终结果没有`.`

我目前的方法是：

```
public void foo(){
    Scanner scan = new Scanner(system.in);
    char c = scan.nextChar();
    if (c!='.')
        foo();
    System.out.print(c);
} 
```

这似乎输出了相反的结果，但是它仍然具有`.`. 有人可以指出我摆脱这段时期的正确方向吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-23T17:17:48.683

将打印件放在大括号内：

```
if (c!='.') {
   foo();
   System.out.print(c);
} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-09-23T17:19:00.407

使用`'.'`而不是`"."`因为您正在比较 a `char`，而不是 a `String`：

```
public void foo(){
  Scanner scan = new Scanner(system.in);
  char c = scan.nextChar();
  if (c != '.') {
    foo();
    System.out.print(c);
  }
} 
```

另请注意，如果它是`String`，则需要使用`equals`进行比较。`==`or`!=`用于比较原始类型，例如`char`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-23T17:21:02.663

作为一个`char`，它必须是`single quotes`，`eg : 'A'`

```
if (c!='.')
  foo();
System.out.print(c);
} 
```

# actionscript-3 - 如何防止与 flex 中的 addChild 相关的闪烁？

> ID：12554433
> 
> 赞同：1
> 
> 时间：2012-09-23T17:16:39.840
> 
> 标签：actionscript-3, apache-flex, flex3

我有以下应用程序，我在运行时动态加载标签，我需要它们每 X 秒更新一次（示例中为 3）。在非常慢的互联网连接上更新期间，防止与删除子项然后重新添加子项相关的闪烁的最佳方法是什么？我希望这是无缝的。

```
<?xml version="1.0" encoding="utf-8"?>
<mx:Application xmlns:mx="http://www.adobe.com/2006/mxml"
            width="100%" height="100%" 
            creationComplete="init()">
<mx:Script>
    <![CDATA[
        import mx.containers.HBox;
        import mx.controls.Button;
        import mx.controls.Label;

        private var timer:Timer;

        protected function init():void
        {
            updateContainer();
            timer = new Timer(3000);
            timer.addEventListener(TimerEvent.TIMER, updateContainer);
            timer.start();
        }

        private function updateContainer(evt:TimerEvent = null):void
        {
            trace("update");
            container.removeAllChildren();

            for(var i:int = 0; i < 50; i++){
                var myHBox:HBox = new HBox();
                myHBox.percentWidth = 100;
                myHBox.setStyle("backgroundColor", "#FFFFFF");
                var myLabel:Label = new Label();
                myLabel.text = "Hello World " + i;

                myHBox.addChild(myLabel);
                container.addChild(myHBox);
            }
        }
    ]]>
</mx:Script>    

<mx:VBox id="container" />

</mx:Application> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-24T09:22:18.213

您的问题是不能保证您可以在一次更新中进行操作（ *“删除所有元素”*和*“添加新子元素”）。*实际上，绝对可以肯定它们至少会在两次更新中发生-一次用于删除，一次用于添加。闪烁是由两次更新之间的短暂时间范围引起的。

最简单的解决方法是重用已经创建的组件，而不是在每次计时器更新时费力地创建 50 个带有标签的容器。通过更多的努力，您可以动态地创建和删除新组件或使用绑定。

这是使用组件重用对代码的快速修改。您不会在此处遇到闪烁，因为标签仅在一次更新中更改。

```
<?xml version="1.0" encoding="utf-8"?>
<s:Application xmlns:fx="http://ns.adobe.com/mxml/2009" 
           xmlns:s="library://ns.adobe.com/flex/spark" 
           xmlns:mx="library://ns.adobe.com/flex/mx" minWidth="955" minHeight="600"
           creationComplete="init()">
<fx:Script>
    <![CDATA[
        import mx.containers.HBox;
        import mx.controls.Button;
        import mx.controls.Label;

        private var timer:Timer;
        private var labels:Array = [];

        protected function init():void
        {
            updateContainer();
            timer = new Timer(1000);
            timer.addEventListener(TimerEvent.TIMER, updateContainer);
            timer.start();
            initContainers();
        }

        private function initContainers():void
        {
            labels = [];
            for (var i:int = 0; i < 50; i++)
            {
                var myHBox:HBox = new HBox();
                myHBox.percentWidth = 100;
                myHBox.setStyle("backgroundColor", "#FFFFFF");
                var myLabel:Label = new Label();
                myHBox.addChild(myLabel);
                container.addChild(myHBox);
                labels.push(myLabel);
            }
        }

        private function updateContainer(evt:TimerEvent = null):void
        {
            trace("update");

            for(var i:int = 0; i < 50; i++)
            {
                if (labels[i] != null)
                {
                    (labels[i] as Label).text = "Hello World " + i + " " + (new Date).time;
                }
            }
        }
    ]]>
</fx:Script>
<mx:VBox id="container" /> 
```

# python - Python：在特定行上打印特定单词

> ID：12554434
> 
> 赞同：-1
> 
> 时间：2012-09-23T17:16:44.883
> 
> 标签：python

我正在尝试创建一个程序，该程序将读取文本文件并在用户给出的特定行上打印特定的字号。我对提示没有任何问题，我只是在获取特定单词时遇到问题。我知道我将使用`readlines()`and `split()`，只是将它们放在一起我很难掌握。嵌套的for循环？一个for循环就足够了吗？

如何结合打印行号和字号？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T17:21:00.887

这应该让你开始。你说你已经得到了论据，所以你应该可以随意修改它。

```
with open("inputfile.txt") as myfile:
    for line_no,l in enumerate(myfile.readlines()):
        print "Line number",line_no     
        for word_no,w in enumerate(l.split()):
            print "word number",word_no     
            print "word: ",w 
```

如果你只需要`w`在线的话`l`，你可以做

```
with open("inputfile.txt") as myfile:
    print myfile.readines()[l].split()[w] 
```

# xamarin.ios - Uri with %20 cause ImageLoader.DefaultRequestImage to throw a null reference exception

> ID：12554438
> 
> 赞同：1
> 
> 时间：2012-09-23T17:17:23.760
> 
> 标签：xamarin.ios, monotouch.dialog

I am passing a URL string which contains `%20` (Url encoded space character) to instantiate a new `Uri` object, which I use the Uri as a parameter for `ImageLoader.DefaultRequestImage`.

However when I call the `Scale` method of the `UIImage` object, a null reference exception occurs. How can I resolve this issue?

```
var uri = new Uri("http://example.com/path%20with%20/image.jpg");
var image = ImageLoader.DefaultRequestImage(uri, null);
var small = image.Scale(new SizeF(32,32)); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-24T01:13:08.787

您使用的 api 不正确。

DefaultRequestImage 是一个异步方法，如果图像已经存在于本地缓存中，则返回值是图像；如果图像不存在于缓存中，则返回 null。

返回值为 null，因为缓存中还没有任何内容。您必须提供一个通知函数（调用中的第二个参数，在这种情况下，您选择不通过传递 null 提供一个）

# android - UnsatisfiedLinkError - 适用于 Android 的 Tesseract

> ID：12554442
> 
> 赞同：2
> 
> 时间：2012-09-23T17:17:32.860
> 
> 标签：android, ant, android-ndk, tesseract, unsatisfiedlinkerror

[我从这里](https://github.com/rmtheis/tess-two)下载了适用于 Android 的 Tesseract OCR，我正在尝试使用 NDK 将其构建为我自己的应用程序的库项目。我在这里收到了一些关于如何执行此操作的有用[反馈](https://stackoverflow.com/questions/12469711/building-tesseract-with-android-ndk/12541069#comment16898006_12541069)。首先，我在命令行上执行此操作（[path] 是 tess-two 项目路径的简写）：

```
> cd [path]\tess-two

> C:\android-ndk-r8b-windows\android-ndk-r8b\ndk-build -j8

"Compile thumb : lept <= adaptmap.c

[...]

"Compile++ thumb : lept <= writefile.cpp

Prebuilt       : libgnustl_static.a <= <NDK>/sources/cxx-stl/gnu-libstdc++/4.6/libs/armeabi/

"Compile++ thumb : tess <= applybox.cpp

[...]

"Compile++ thumb : tess <= tessbaseapi.cpp

"Compile thumb : lept <= adaptmap.c

[...]

"Compile++ thumb : lept <= pixa.cpp

Prebuilt       : libgnustl_static.a <= <NDK>/sources/cxx-stl/gnu-libstdc++/4.6/libs/armeabi-v7a/

"Compile++ thumb : lept <= jni.cpp

[...]

"Compile++ thumb : tess <= tessbaseapi.cpp

"Compile x86  : lept <= affine.c

[...]

"Compile++ x86  : lept <= readfile.cpp

Prebuilt       : libgnustl_static.a <= <NDK>/sources/cxx-stl/gnu-libstdc++/4.6/libs/x86/

"Compile++ x86  : tess <= baseapi.cpp

[...]

"Compile++ x86  : tess <= wordclass.cpp

SharedLibrary  : liblept.so

SharedLibrary  : liblept.so

"Compile++ x86  : tess <= tessbaseapi.cpp

SharedLibrary  : liblept.so

"Compile++ x86  : tess <= wordrec.cpp

SharedLibrary  : libtess.so

Install        : liblept.so => libs/x86/liblept.so

Install        : liblept.so => libs/armeabi/liblept.so

SharedLibrary  : libtess.so

Install        : liblept.so => libs/armeabi-v7a/liblept.so

SharedLibrary  : libtess.so

Install        : libtess.so => libs/armeabi/libtess.so

Install        : libtess.so => libs/armeabi-v7a/libtess.so

Install        : libtess.so => libs/x86/libtess.so

> C:\Users\User\android-sdk\tools\android.bat update project --path .

Failed to convert path to a short DOS path: C:\Windows\system32\java.exe
'javaw_exe' is not recognized as an internal or external command,
operable program or batch file.
Updated local.properties

Updated file [path]\tess-two\proguard-project.txt

It seems that there are sub-projects. If you want to update them

please use the --subprojects parameter.

> set JAVA_HOME=C:\Java\JDK
> Buildfile: [path]\tess-two\build.xml

-set-mode-check:

-set-release-mode:

-release-obfuscation-check:
     [echo] proguard.config is ${proguard.config}

-check-env:
 [checkenv] Android SDK Tools Revision 20.0.3
 [checkenv] Installed at C:\Users\User\android-sdks

-setup:
     [echo] Project Name: tess-two
  [gettype] Project Type: Android Library

-build-setup:
     [echo] Resolving Build Target for tess-two...
[gettarget] Project Target:   Google APIs
[gettarget] Vendor:           Google Inc.
[gettarget] Platform Version: 4.1
[gettarget] API level:        16
     [echo] ----------
     [echo] Creating output directories if needed...
     [echo] ----------
     [echo] Resolving Dependencies for tess-two...
[dependency] Library dependencies:
[dependency] No Libraries
[dependency] 
[dependency] ------------------
[dependency] API<=15: Adding annotations.jar to the classpath.
     [echo] ----------
     [echo] Building Libraries with 'release'...
   [subant] No sub-builds to iterate on

-pre-build:

-code-gen:
[mergemanifest] Found Deleted Target File
[mergemanifest] Merging AndroidManifest files into one.
[mergemanifest] Manifest merger disabled. Using project manifest only.
     [echo] Handling aidl files...
     [aidl] No AIDL files to compile.
     [echo] ----------
     [echo] Handling RenderScript files...
[renderscript] No RenderScript files to compile.
     [echo] ----------
     [echo] Handling Resources...
     [aapt] Found new input file
     [aapt] Generating resource IDs...
     [echo] ----------
     [echo] Handling BuildConfig class...
[buildconfig] No need to generate new BuildConfig.

-pre-compile:

-compile:
     [echo] Creating library output jar file...

-post-compile:

-obfuscate:

-dex:
     [echo] Library project: do not convert bytecode...

-crunch:
   [crunch] Crunching PNG Files in source dir: [path]\tess-two\res
   [crunch] To destination dir: [path]\tess-two\bin\res
   [crunch] Crunched 0 PNG files to update cache

-package-resources:
     [echo] Library project: do not package resources...

-package:
     [echo] Library project: do not package apk...

-post-package:

-release-prompt-for-password:

-release-nosign:
     [echo] 
[propertyfile] Updating property file: [path]\tess-two\bin\build.prop
[propertyfile] Updating property file: [path]\tess-two\bin\build.prop
[propertyfile] Updating property file: [path]\tess-two\bin\build.prop
[propertyfile] Updating property file: [path]\tess-two\bin\build.prop

-release-sign:

-post-build:

release:

BUILD SUCCESSFUL
Total time: 1 second 
```

然后，我这样做：文件 -> 导入 -> Android -> 现有代码到工作区 -> 浏览 -> 选择当前工作区目录 -> 确保在出现的列表中选择了 tess-two -> 完成。

然后我右键单击我自己的应用程序，转到属性-> Android 选项卡-> 添加...（在库部分下）-> 选择 tess-two -> 单击确定-> 检查“是库”-> 确定。

但是，毕竟这一切，我在运行我的应用程序时*仍然*收到以下错误：

```
09-23 13:02:42.532: E/AndroidRuntime(675): Caused by: java.lang.UnsatisfiedLinkError: Couldn't load lept: findLibrary returned null
09-23 13:02:42.532: E/AndroidRuntime(675):  at java.lang.Runtime.loadLibrary(Runtime.java:365)
09-23 13:02:42.532: E/AndroidRuntime(675):  at java.lang.System.loadLibrary(System.java:535)
09-23 13:02:42.532: E/AndroidRuntime(675):  at com.googlecode.tesseract.android.TessBaseAPI.<clinit>(TessBaseAPI.java:47) 
```

我自己的应用程序的 project.properties 是：

```
target=android-16
android.library.reference.1=..\\OpenCV\\sdk\\java
android.library.reference.2=../Tesseract/tess-two
android.library=true 
```

这是怎么回事？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-24T02:41:47.283

我明白了，问题是我没有在我的代码中正确初始化 API。正确的语法是：

```
tesseract.init("/mnt/sdcard/", "eng"); 
```

假设您在 mnt/sdcard 下有一个文件夹“tessdata”。现在它完美加载！非常感谢您的帮助，rmthesis！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-02-17T00:26:22.833

对我来说，而不是 2 loadlibrary 我做了所有 4

`System.loadLibrary("jpgt"); System.loadLibrary("pngt"); System.loadLibrary("lept"); System.loadLibrary("tess");` 它奏效了。

# javascript - 如何在没有“new”运算符的情况下使用原型继承

> ID：12554443
> 
> 赞同：1
> 
> 时间：2012-09-23T17:17:38.310
> 
> 标签：javascript, closures, prototype

所以我试图制作具有原型继承的对象，而没有使用闭包的“新”运算符。我的代码是：

```
var TABLE=function (tableId) {
var table=(document.getElementById(tableId)||{}),
    colName=[],
    rows,
    cols,
    selectedRow;

//private methods

    var updateRows=function(){
        //Code that updates the number of row of the table
    }
    updateRows();

//Declare the public methods for the object

var methods={
    prototype:{
        cols:function () {
        return cols;
        },
        rows:function () {
            return rows;
        }
    }
};
    return methods;
}

var table=Table("Inventory")
alert(table.rows()) //I get undefined
alert(table.prototype.rows()) //I get the actual number of rows 
```

我究竟做错了什么？你认为我可以为此使用一些更好的编码方式吗

我感谢所有的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T17:24:36.407

如果您想使用原型继承，我们必须使用 new 关键字。

最好与示例一起使用：-

[http://www.klauskomenda.com/code/javascript-inheritance-by-example/](http://www.klauskomenda.com/code/javascript-inheritance-by-example/)

# javascript - Rows of 7 with values from Array

> ID：12554446
> 
> 赞同：0
> 
> 时间：2012-09-23T17:17:53.820
> 
> 标签：javascript, arrays, loops

I want to create a code that get's the values from array `["1", "2", "3"]` and then it creates a new row with 7 of this. The array will have near 90 values, so from 1-7 is in the first row, 8-14 in another and so. I created this code but it just freezes the website and crashes the browser, so I would like you to tell me where's the mistake.

```
var newVals = new Array("1", "2", "3"..."81");
var target = ".content table";
var activeTar = target + " .active";
for(var i = 0; i < newVals.length; i++){
    for (var y = 0; y < 7; y++){
        if(y == 0){
            jQuery(target).append('<tr class="active"></tr>');
        }
        var valId = newVals[i];
        var valImg = "http://sub.domain.com/" + valId + "/picture";
        var valCode = '<td class="cell"><a class="toggleAdd" tabindex="0" data-icon="'+valId+'"><img src="'+valImg+'"></a></td>';
        jQuery(activeTar).append(valCode);
        if(y == 6){
            jQuery(activeTar).removeClass("active");
            y = -1;
        }
    }
}
jQuery(".toggleAdd").live("click", function(){
    jQuery("input", jQuery(this).closest('form')).val(jQuery("input", jQuery(this).closest('form')).val() + jQuery(this).attr("data-icon"));
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T17:24:09.217

如果我理解正确，您只需要删除以下行：

```
y = -1; 
```

并更改以下 for 循环：

```
for(var i = 0; i < newVals.length; i++){ 
```

对于这个：

```
for(var i = 0; i < newVals.length; i = i + 7){ 
```

并替换您的以下行：

```
var valId = newVals[i]; 
```

对于这个：

```
var valId = newVals[i + y]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-23T17:35:13.787

好像你有一个`"active"`类只是为了做 DOM selecto 插入到正确的行中。

没必要。只需将行保存在变量中，附加到它，然后每七个项目创建并保存一个新行。

```
var newVals = new Array("1", "2", "3", /*...,*/ "81"),
    target = jQuery(".content table"),
    activeRow;

$.each(newVals, function(i, valId) {
    if(i % 7 === 0)
        activeRow = jQuery('<tr></tr>').appendTo(target);

    activeRow.append('<td class="cell"><a class="toggleAdd" tabindex="0" data-icon="'+valId+'"><img src="http://sub.domain.com/' + valId + '/picture"></a></td>');
}); 
```

这使用模运算符来确定是否是时候创建一个新行了。

关于处理程序，如果您使用变量，您可以稍微清理一下。此外，如果您使用的是 jQuery 1.7 或更高版本，则应`on`使用`live`.

```
jQuery(document).on("click", ".toggleAdd", function(){
    var input = jQuery(this).closest('form').find("input"),
        v = input.val() + jQuery(this).attr("data-icon");

    input.val(v);
}); 
```

您应该替换`document`为代表包含所有`.toggleAdd`元素的最深容器的选择器。

# flash - Adobe AIR SDK 和 Flex SDK 的关系？

> ID：12554447
> 
> 赞同：13
> 
> 时间：2012-09-23T17:18:12.200
> 
> 标签：flash, apache-flex, sdk, air, flashdevelop

我试图弄清 Flash 平台的混乱情况（主要是为了让我理解被抛出的术语），到目前为止，我还无法弄清楚 AIR 和 Flex SDK 究竟是如何相关的。如果没有实际查看 SDK，我的理解是 AIR 使您能够开发 Flash（即 ActionScript，显然还有 JavaScript/HTML）应用程序，这些应用程序可以由 AIR 运行时运行而无需浏览器（例如纯桌面或智能手机应用程序）。Flex SDK 似乎是类和附加 API（类似于 JavaFX？）的集合，用于扩展“标准”Flash 库。

现在，我已经下载了这两个 SDK 的最新版本，显然，事情没那么简单。因此，首先我查看了 AIR SDK（[http://www.adobe.com/devnet/air/air-sdk-download.html](http://www.adobe.com/devnet/air/air-sdk-download.html)，截至目前为 v3.4）。据我所知，“adt”实用程序是 AIR 的主要部分，可让您打包完成的应用程序。但是，我不确定 AIR SDK 是否真的包含编译器 - 假设您有一堆 ActionScript .as 文件并想使用 AIR SDK 将它们转换为 .swf 或 .air 文件，这是否可能？

不幸的是， Flex SDK（[http://www.adobe.com/devnet/flex/flex-sdk-download.html，v4.6](http://www.adobe.com/devnet/flex/flex-sdk-download.html)）并没有帮助解决混乱。它确实包括编译器和其他工具，但在它的“bin”文件夹中，我还可以找到“adt”和“adl”——AIR 工具！更重要的是，它还有“AIR SDK license.pdf”和“AIR SDK readme.txt”文件；从这些来看，Flex SDK 似乎包含一些旧版本的 AIR SDK 版本 2。

更令人困惑的是，我还在 Adob​​e 的网站 ( [http://gaming.adobe.com/getstarted /](http://gaming.adobe.com/getstarted/)）。似乎这不仅仅是通过将 AIR 3.4 文件复制到 Flex 4.6 文件、向列表中添加另一个项目来创建的。

所以，本质上，我想知道这两个（三个？）SDK 之间的区别。我需要 Flex 实用程序来编译吗？为什么“纯”Flex SDK 包含 AIR 的部分（？）？我可以将任何版本的 AIR SDK 复制到 Flex SDK 中，以便与 FlashDevelop 一起使用吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-09-23T18:55:33.563

> ```
> I haven't been able to figure out how exactly the AIR and Flex SDKs are related. 
> ```

从封装的角度来看，它们没有任何关系。但是，Adobe 确实将 AIR SDK 与他们的 Flex SDK 版本一起分发。

使用 IDE（例如 Flash Builder）时，需要特定的目录结构，其中包括 Flex SDK 的子目录中的 AIR SDK。

使用 Apache Flex 时，Apache 没有分发 AIR SDK 的权利，因此用户可以将 AIR SDK 和 Flex SDK 结合起来，以便于将 SDK 与 Flash Builder 一起使用。但是，Apache Flex 人员正在开发一种“易于安装”工具来准备 Apache Flex SDK 以与 Flash Builder 一起使用。该工具会下载所有相关的非 Apache 二进制文件，并为您提供一个完整的包。

在没有 AIR 的情况下使用 Flex UI 框架是完全有效的；并在没有 Flex 的情况下使用 AIR SDK。但是，在 Flex SDK 中，特别是在移动组件集中，我相信对 AIR SDK 存在一些依赖关系。要使用 AIR，您需要一些东西来编译它。Flex SDK 中的 MXMLC 是一种选择。

我将尝试回答您的一些具体问题：

> 我的理解是，AIR 使您能够开发 Flash（即 ActionScript，显然还有 JavaScript/HTML）应用程序，这些应用程序可以由 AIR 运行时运行，而无需浏览器（例如纯桌面或智能手机应用程序）。

这是真的; 除了我不相信 AIR 像在桌面上那样支持智能手机的 HTML/JS。Mobile AIR Runtime 不像桌面版本那样包含嵌入式浏览器。但是，您可以使用 StageWebView 使用设备上的浏览器。

> Flex SDK 似乎是一个类和附加 API 的集合......以扩展“标准”Flash 库。

这是对的。除了用于构建您自己的 UI 类的框架之外，Flex 框架还提供了许多 UI 组件类。需要明确的是，Flex SDK 不仅包括 Flex 框架，还包括一步调试器和命令行编译器。

> Flex SDK 似乎包含一些旧版本的 AIR SDK

这是真的; Flex SDK 包含一个 AIR SDK 版本。Flex 和 AIR 不在同一个更新时间表上；所以 Flex 只有在新的 Flex 版本发布时才会使用最新版本的 AIR 进行更新。如果您需要，有多种方法可以将新的 Air SDK 叠加到 Flex SDK 上。 [这里有一些说明](http://helpx.adobe.com/x-productkb/multi/how-overlay-air-sdk-flex-sdk.html)。我忘记了 Adob​​e Flex 4.6 中包含的 AIR 版本，但我认为它是 AIR 3.2。AIR 3.4 是 Adob​​e 的最新版本。

值得注意的是，Flex 已捐赠给[Apache 基金会](http://incubator.apache.org/flex/)；他们已经发布了 Apache Flex 4.8。

> 我需要 Flex 实用程序来编译吗？

我对这个问题的答案并不完全清楚。大多数人使用 Flex SDK 中的 MXMLC 来编译基于 AIR 的应用程序。即使您使用 Flash Builder，MXMLC 也会在后台使用。如果您使用 Flash Professional，我相信它有自己的 AIR 编译器，但我不知道它是否基于 MXMLC。Flash Builder 4.7 将包括一个全新的编译器——代号为 Falcon。

> 我可以将任何版本的 AIR SDK 复制到 Flex SDK 中，以便与 FlashDevelop 一起使用吗？

理论上是的。我对 FlashDevelop 一无所知，但我确实知道它支持 Flex。我假设，通过扩展，它也支持 AIR。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-23T20:20:40.417

我会尽量让它更简单。Flex SDK 和 AIR SDK 的划分是由于 Adob​​e 开发团队的工作方式，主要是因为不同的发布周期。AIR SDK 与 Flex SDK 有不同的时间表，从今天开始，Flex SDK 不再由 Adob​​e 开发。我认为可以肯定地说它们的打包/分发方式没有其他原因 - 我多年来一直找不到它，所以，即使有一个，它也不明显或重要。

Flex SDK 通常包含 AIR SDK 的过时版本，因此您需要通过 Flex SDK 复制 AIR SDK 才能拥有最新的环境。如果您可以处理设置两个部分运行所需的东西（实际上并没有那么多），您可能不会复制任何东西。但是，AIR SDK 不足以进行开发。Flex SDK 就足够了，但不会包含一些与 AIR 相关的部分（还有更多的 SDK，然后是这两个，但为简单起见，这里不再赘述）。

我将尝试在下面列出事物以及寻找它们的地方，我不确定这个系统是否连贯，但看起来这是我能做的最好的：

弹性 SDK

*   ABC（ActionScript）编译器、SWF（转码器、链接器等）。编译器、SWC（库）打包器、文档生成器、反汇编器、调试器等实用程序。
*   基本的 AIR 支持，主要涉及桌面、打包器和启动器（基本上是调试器）。
*   运行时（浏览器的各种播放器，独立的，AIR 播放器）。
*   为不同的运行时链接您的代码的库（类似于 C 中的标头）。
*   用于运行一些实用程序的 Ant 任务，主要是编译器和链接器，但它们也有一些其他的东西，比如 HTML 模板生成等。
*   SDK 源。
*   Flex 框架（用于设计企业风格应用程序的质量可疑的大型 GUI 库 - 表单、空白、图表等）。

AIR SDK

*   AIR、APK 的打包器和启动器以及那个 iOS 应用程序格式是什么......
*   它包含运行时、模拟器（主要是用于 Android 模拟器的 avd + 一些用于处理 adb 等的实用程序，但对于 iOS 也可能类似）。
*   运行时的库（标头）。
*   一些 Flex 框架（上面提到过），特别针对桌面/移动设备。
*   与安装程序/更新程序相关的东西。
*   相关来源。

最重要的是，Adobe 将 Flex SDK 捐赠给了 Apache，最新发布的版本是 4.8（由 Apache 提供）。您可能会发现使用 Apache 版本更复杂，因为它需要您进行更多配置并从 Adob​​e 下载一些位，它们不允许在 Apache 许可下重新分发。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-17T17:03:38.847

我没有足够的声誉将此作为评论，但参考 wxvw 的回答，Apache Flex 一键安装程序已发布，可在此处获得：

[http://flex.apache.org/installer.html](http://flex.apache.org/installer.html)

它当前安装 Flex 4.9 和所有必需的（以及各种可选的）依赖项。

# android - Android accessibility service detect notification

> ID：12554448
> 
> 赞同：14
> 
> 时间：2012-09-23T17:18:42.343
> 
> 标签：android, notifications, accessibility

I'm trying to make my app detect whenever a notification is displayed. I've enabled it in the settings app and `onServiceConnected` does get called, however when I create a notification or receive an e-mail through the gmail app nothing happens, `onAccessibilityEvent` does not get called.

Android manifest:

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
package="com.test.slide"
android:versionCode="1"
android:versionName="1.0">
<uses-sdk
    android:minSdkVersion="8"
    android:targetSdkVersion="15"/>
<uses-permission android:name="android.permission.SYSTEM_ALERT_WINDOW"/>
<uses-permission android:name="android.permission.GET_TASKS"/>
<application android:label="Slide"
    android:icon="@drawable/ic_launcher"
    android:theme="@style/AppTheme">
    <activity
        android:name=".Settings"
        android:label="Slide">
        <intent-filter>
            <action android:name="android.intent.action.MAIN"/>
            <category android:name="android.intent.category.LAUNCHER"/>
        </intent-filter>
    </activity>
    <activity
        android:name=".Tools"
        android:label="Slide"
        android:theme="@android:style/Theme.Translucent.NoTitleBar">
    </activity>
    <service android:name=".LocalService"/>
    <service android:name=".NotificationService"
        android:permission="android.permission.BIND_ACCESSIBILITY_SERVICE"
        android:label="Slide"
        android:enabled="true"
        android:exported="false">
        <intent-filter>
            <action android:name="android.accessibilityservice.AccessibilityService"/>
        </intent-filter>
    </service>
</application> 
```

NotificationService.java

```
package com.test.slide;

import android.accessibilityservice.AccessibilityService;
import android.accessibilityservice.AccessibilityServiceInfo;
import android.view.accessibility.AccessibilityEvent;

public class NotificationService extends AccessibilityService {
@Override
public void onAccessibilityEvent(AccessibilityEvent event) {
    System.out.println("onAccessibilityEvent");
    if (event.getEventType() == AccessibilityEvent.TYPE_NOTIFICATION_STATE_CHANGED) {
        System.out.println("notification: " + event.getText());
    }
}
@Override
protected void onServiceConnected() {
    System.out.println("onServiceConnected");
    AccessibilityServiceInfo info = new AccessibilityServiceInfo();
    info.eventTypes = AccessibilityEvent.TYPE_NOTIFICATION_STATE_CHANGED;
    info.notificationTimeout = 100;
    info.feedbackType = AccessibilityEvent.TYPES_ALL_MASK;
    setServiceInfo(info);
}

@Override
public void onInterrupt() {
    System.out.println("onInterrupt");
}
} 
```

Thanks for any help.

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-09-24T01:33:54.130

[如果清单中没有定义无障碍服务](http://developer.android.com/reference/android/R.styleable.html#AccessibilityService)元数据标记，Android 4.0 及更高版本中的无障碍服务可能会出现异常行为。尝试按照以下示例定义元数据。您应该继续使用 setServiceInfo() 来保持与 4.0 之前的设备的向后兼容性。

此外，我建议指定特定于您的服务的反馈类型，而不是使用“全部”。

**AndroidManifest.xml**

```
 <service
        . . .
        android:name=".NotificationService"
        android:permission="android.permission.BIND_ACCESSIBILITY_SERVICE" >
        <intent-filter>
            <action android:name="android.accessibilityservice.AccessibilityService" />
        </intent-filter>

        <meta-data
            android:name="android.accessibilityservice"
            android:resource="@xml/accessibilityservice" />
    </service> 
```

**res/xml/accessibilityservice.xml**

```
<?xml version="1.0" encoding="utf-8"?>
<accessibility-service xmlns:android="http://schemas.android.com/apk/res/android"
    android:accessibilityEventTypes="typeNotificationStateChanged"
    android:accessibilityFeedbackType="feedbackAllMask"
    android:notificationTimeout="100" /> 
```

您的 feedbackType 有错误。更正如下。不过，请考虑使用更具体的反馈类型。

**NotificationService.java**

```
@Override
protected void onServiceConnected() {
    AccessibilityServiceInfo info = new AccessibilityServiceInfo();
    info.eventTypes = AccessibilityEvent.TYPE_NOTIFICATION_STATE_CHANGED;
    info.feedbackType = AccessibilityServiceInfo.FEEDBACK_ALL_MASK;
    info.notificationTimeout = 100;
    setServiceInfo(info);
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-12T06:26:26.657

使用 AccessibilityService 的应用需要获得设置>辅助功能的权限才能访问系统事件。允许来自设置的权限。这可能有效

检查这个链接

[无障碍服务未启动](https://stackoverflow.com/questions/11087758/accessibility-service-is-not-started)

# java - Java while loop to draw lines

> ID：12554450
> 
> 赞同：0
> 
> 时间：2012-09-23T17:19:01.323
> 
> 标签：java

Hello everyone i am trying to do a exercise from a Java book and what i need to do is draw lines and within a textfield i have to say how far the distance between the lines have to be. All of this has to be in a loop so no hardcoded lines.

i have made everything like i thought it should be done but i get some weird error in my console that is keep coming. the error code is as followed:

> Exception in thread "AWT-EventQueue-0" java.lang.NumberFormatException: For input string: "" at java.lang.NumberFormatException.forInputString(NumberFormatException.java:48) at java.lang.Integer.parseInt(Integer.java:470) at java.lang.Integer.parseInt(Integer.java:499) at h03.LinePanel.paintComponent(LinePanel.java:30) at javax.swing.JComponent.paint(JComponent.java:1037) at javax.swing.JComponent._paintImmediately(JComponent.java:5106) at javax.swing.JComponent.paintImmediately(JComponent.java:4890) at javax.swing.RepaintManager.paintDirtyRegions(RepaintManager.java:812) at javax.swing.RepaintManager.paintDirtyRegions(RepaintManager.java:714) at javax.swing.RepaintManager.prePaintDirtyRegions(RepaintManager.java:694) at javax.swing.RepaintManager.access$700(RepaintManager.java:41) at javax.swing.RepaintManager$ProcessingRunnable.run(RepaintManager.java:1672) at java.awt.event.InvocationEvent.dispatch(InvocationEvent.java:209) at java.awt.EventQueue.dispatchEventImpl(EventQueue.java:702) at java.awt.EventQueue.access$400(EventQueue.java:82) at java.awt.EventQueue$2.run(EventQueue.java:663) at java.awt.EventQueue$2.run(EventQueue.java:661) at java.security.AccessController.doPrivileged(Native Method) at java.security.AccessControlContext$1.doIntersectionPrivilege(AccessControlContext.java:87) at java.awt.EventQueue.dispatchEvent(EventQueue.java:672) at java.awt.EventDispatchThread.pumpOneEventForFilters(EventDispatchThread.java:296) at java.awt.EventDispatchThread.pumpEventsForFilter(EventDispatchThread.java:211) at java.awt.EventDispatchThread.pumpEventsForHierarchy(EventDispatchThread.java:201) at java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:196) at java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:188) at java.awt.EventDispatchThread.run(EventDispatchThread.java:122)

since i am new to Java i don't know what i did wrong and how to troubleshoot this error so i would appreciate any help! the code in my panel that i use for this is

```
DrawLines lines = new DrawLines();

public void paintComponent(Graphics g) {

    super.paintComponent(g);
    int positionY = getHeight() - Integer.parseInt(afstand.getText()); // absolut positioning

    int yPos = 0;

    while(yPos <= positionY) {

        lines.drawLines(g, 0, yPos, getWidth(), yPos);
        yPos = yPos + Integer.parseInt(afstand.getText());
    }

}

public void actionPerformed(ActionEvent e) {

    try {

        repaint();

    }
    catch(NumberFormatException err) {

        JOptionPane.showMessageDialog(null, "something went wrong! heeft u wel    een waarde opgegeven?");

    }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T17:20:36.517

The issue is exactly what it says: you call `Integer.parseInt()` on an empty String, in your example: `afstand.getText()`, and it does not like it.

```
java.lang.NumberFormatException: For input string: "" at
[...]
java.lang.Integer.parseInt(Integer.java:470) at java.lang.Integer.parseInt(Integer.java:499) 
```

To avoid the exception you could catch the exception:

```
try {
    int input = Integer.parseInt(afstand.getText());
    //rest of your code
} catch (NumberFormatException e) {
    //let the use know that the entry is invalid
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T17:25:21.000

getText().toString() 以获取您的文本字段的值。您可以尝试 System.out.println(afstand.getText) 并使用 toString 来查看差异。

否则，您的文本字段中没有整数值。

# jquery - 选择后将类添加到按钮 - jquery

> ID：12554451
> 
> 赞同：0
> 
> 时间：2012-09-23T17:19:03.210
> 
> 标签：jquery, addclass

我有一个提交按钮，在用户从选择列表中选择之前，该按钮处于禁用状态。

我想删除 disabled 属性并添加一个类，以便在更改选择列表时按钮成为我在整个站点中使用的标准按钮类。

我正在尝试以下操作：

```
$(document).ready(
function(){
    $('#category').change(
        function(){
            if ($(this).val()) {
                $('input:submit').attr('disabled',false);
                $('#btn_show').addClass.attr('button green');

            }
        });

}); 
```

#category 是下拉列表 ID，#btn_show 是按钮 ID

禁用的被删除了，但没有添加类。我的逻辑正确吗？

另外，当这种变化发生时，是否也可以改变提交按钮的值？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-23T17:22:01.937

你应该使用`$('#btn_show').addClass('green');`

请阅读手册：[http ://api.jquery.com/addClass/](http://api.jquery.com/addClass/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-23T17:25:12.897

这可以通过 jquery [`addClass('class_name')`](http://api.jquery.com/addClass/)api来完成

试试这个

```
$('#btn_show').addClass('button green'); 
```

# c# - Serialize unquoted property values

> ID：12554453
> 
> 赞同：2
> 
> 时间：2012-09-23T17:19:33.227
> 
> 标签：c#, javascript, json.net

Say I have this C# dictionary:

```
Dictionary<string, object> Parameters { get; set; } 
```

then I put some values inside

```
Parameters["param1"] = "val1";
Parameters["param2"] = "val2"; 
```

and finally I serialize it with

```
var serializer = new JsonSerializer();
var stringWriter = new StringWriter();
var writer = new JsonTextWriter(stringWriter);
writer.QuoteName = false;
writer.QuoteChar = '\'';
serializer.Serialize(writer, Parameters); 
```

(I know there are quicker ways, but I need the quoting char to be a single quote and unquoted names).

The result is as expected:

```
{ 
   param1: 'val1', 
   param2: 'val2' 
} 
```

But what if I want to include a property with an ***unquoted*** value, which may represent a function or an object name? For example, how do I get this result:

```
{ 
   param1: 'val1', 
   param2: 'val2',
   funcReference: someFunctionName,
   objName: valueWithoutQuotes
} 
```

* * *

**EDIT:**

Due to some responses about my JSON syntax saying it's not valid, let me clarify why I need stuff to be unquoted:

I'm using Knockoutjs for Javascript & HTML data-binding. Therefore I need to write something like this - `<div data-bind="something: 'value', event: funcName">...</div>`

I need single quotes so that it won't mess my HTML and I don't quote the properties names because of my personal style which is very common and is perfectly fine in Javascript (I'm not using it for data exchange).

I need some values to be unquoted so that Knockout will know it's a reference to a function, otherwise it'll treat it as a string. And the names of the functions I'm generating on server, along with other properties and values.

I can of course always build and concat the JSON manually, but I'm looking for some automatic way.

Thanks!

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-24T07:33:53.990

> （我知道有更快的方法，但我需要引用字符是单引号和不带引号的名称

抱歉，这不是有效的 JSON。在 JSON 中，所有成员都应该用双引号引起来（数字类型除外），并且您不能拥有函数。.NET 中没有会生成无效 JSON 的 JSON 序列化程序。如果您需要生成无效的 JSON，则必须使用字符串连接手动完成，甚至不要尝试使用序列化程序。

这是有效 JSON 编码对象的[语法](http://www.json.org/)。你必须坚持下去。不要只将术语*JSON*用于任何 javascript 语法，因为 JSON 具有需要遵守的非常具体的规则。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-24T07:37:52.067

添加到我上面的评论中，理想情况下应该是

```
{  
   "param1": "val1",  
   "param2": "val2", 
   "funcReference": "someFunctionName", 
   "objName": "valueWithoutQuotes" 
} 
```

发布为答案，因为我无法在评论中发布代码

# django - OSX 中的 PyDev 创建新项目时会创建多个 settings.py/urlspy

> ID：12554460
> 
> 赞同：1
> 
> 时间：2012-09-23T17:20:42.713
> 
> 标签：django, macos, pydev

我正在尝试在 Pydev 中使用 Django 启动一个新项目，当我创建它时，我得到以下结构：

```
ProjectName
 | ProjectPkg
 |  | ProjectPkg
 |  |  | __init__.py
 |  |  | settings.py
 |  |  | urls.py
 |  | __init__.py
 |  | settings.py
 |  | urls.py
 |  | manage.py 
```

为什么我会得到两个 ProjectPkg 包？为什么我有两个 settings.py/urls.py （只有内部的工作）。我猜这是一个错误，但有人注意到了吗？我没有从谷歌搜索中得到任何线索......我尝试手动创建文件，然后使用这些文件在 pydev 中创建一个新项目，但是 pydev 创建丢失的文件以创建相同的烦人结构。在 Windows 中，它工作得很好。任何人都知道可能发生的事情和/或如何解决它？非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T18:46:03.310

这真是一种奇怪的行为。您是否已经尝试让 Django 创建您的文件夹文件，然后仅将 Django 创建的项目文件夹作为 PyDev 项目导入。请参阅我的另[一篇文章](https://stackoverflow.com/questions/12547097/django-project-console-management-coding-in-eclipse/12547811#12547811)，其中解释了如何做到这一点。

# java - 使用无参数递归的字符串反转

> ID：12554471
> 
> 赞同：2
> 
> 时间：2012-09-23T17:21:23.770
> 
> 标签：java, string, recursion

我被要求编写一个递归方法来反转一个字符串。我有一个名为的类，其名称`Sentence`为私有字符串变量`text`。`Sentence`通过创建对象和调用方法，程序在单独的主类中运行。我无法更改方法的返回类型。我已经为此工作了一段时间，但一无所获。任何帮助或建议将不胜感激。

```
public void reverse() {
    if (text.length() <= 1) {
         return;
    }

    Sentence x = new Sentence(text.substring(1));
    recur = text.substring(0, 1); //recur is another String variable I declared
    text =  x.text.concat(recur);
    x.reverse();
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-23T17:44:37.093

你很接近。据我所知，如果您交换这两行，这应该可以工作：

```
text =  x.text.concat(recur);
x.reverse(); 
```

此外，您应该尝试提出有意义的变量名而不是`x`and `recur`。这将使其他人（和您！）更容易理解您的代码。例如：

```
public void reverse() {
    if (text.length() <= 1)
        return;

    String firstChar = text.substring(0, 1);

    Sentence rest = new Sentence(text.substring(1));
    rest.reverse();

    text = rest.text.concat(firstChar);
} 
```

# lisp - 从 cond 语句中删除多余的 else ？

> ID：12554474
> 
> 赞同：3
> 
> 时间：2012-09-23T17:21:26.077
> 
> 标签：lisp, scheme, conditional-statements, the-little-schemer

我目前正在阅读《小阴谋家》的第 4 版。一个早期的练习是创建一个函数，该函数`insertR`在列表中给定值的右侧插入一个值。本书最终得出以下定义：

```
(define insertR
  (lambda (new old lat)
    (cond
      ((null? lat) (quote ()))
      (else (cond
              ((eq? (car lat) old)
               (cons old
                     (cons new (cdr lat))))
              (else (cons (car lat)
                          (insertR new old
                                   (cdr lat))))))))) 
```

我自己的定义是这样的：

```
(define insertR
  (lambda (new old lat)
    (cond
      ((null? lat) (quote ()))
      ((eq? (car lat) old) (cons old (cons new (cdr lat))))
      (else (cons (car lat) (insertR new old (cdr lat))))))) 
```

它们是等价的吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-23T18:19:25.613

当然这两个定义是等价的，但是你的定义更容易阅读。请记住，您只是在本书的第 3 章，作者喜欢慢慢来。在同一章的后面，在第 41 页，他们将准确地教给你你正在做的那种简化——在一个单一`cond`的表单中处理所有互斥的条件，而不是嵌套`cond`表单。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-24T02:22:06.933

是的，这两个定义具有相同的行为。

这本书有两个`cond`s 的原因是因为它们服务于两个不同的目的。外部`cond`区分列表数据类型的两种情况（列表是或者`null`其`cons`第二个参数是列表）。外部`cond`由所使用的数据类型决定；列表上的所有结构递归函数都将具有该 external `cond`。内部`cond`特定于正在定义的特定功能。

因此，虽然将它们组合起来更紧凑，但通过将它们分开，您可以使函数的结构更清楚地对应于递归类型的结构。如果您始终如一地使用该习惯用法，它会使您的结构递归函数更易于阅读、调试和维护。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-24T06:54:02.617

我要和 Ryan 说同样的话：可读性仅次于正确性。事实上，如果你是学生，可读性可能比正确性*更重要。*

书中出现的版本的优点是它有一个双臂条件，其中一个测试空虚。这是解决问题的完全正常和预期的方法。当我看到这个拆分时，我可以迅速理解这两个代码块的作用。在您的代码中，我必须停下来花时间确保这三种情况是详尽无遗且互斥的，然后推断哪些输入属于哪些垃圾箱。

Here's what I want you to picture: it's 11:52 PM, I'm tired, my eyes hurt, and I'm reading over forty-five solutions to the same problem, written by students. I'm looking for CLARITY, darn it. If you can write your solution in a way that makes it OBVIOUS that you did it right, I'm going to give you 100% and bless your name.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-09-23T17:39:51.417

它们是，是的，虽然我发现你的更容易阅读。`cond`支持*多个*子句，并评估每个子句，直到其中一个评估为一个`true`值。因此，以下内容：

```
(else (cond
        ((eq? (car lat) old) (cons old (cons new (cdr lat))))
        (else (cons (car lat) (insertR new old (cdr lat))))))))) 
```

相当于将第二个的第一个子句`cond`移到第一个：

```
(cond
  ((null? lat) (quote ()))
  ((eq? (car lat) old) (cons old (cons new (cdr lat))))
  (else (cons (car lat) (insertR new old (cdr lat))))))) 
```

也许这本书的作者认为将终止条件与其他两个分开更清楚`null`，但如果是这样的话，`if`那么就足够了，而不是`cond`.

# mongodb - 如何设置 connect-mongo（或在 mongoose 中使用会话）

> ID：12554480
> 
> 赞同：5
> 
> 时间：2012-09-23T17:21:45.213
> 
> 标签：mongodb, express, mongoose, connect

我正在使用 ExpressJS 和猫鼬。

```
var MongoStore = require('connect-mongo')(express);
var sessionStore = new MongoStore({db: 'myappsession'});

app.use(express.session({ secret: "myappsecret", store:sessionStore })); 
```

这会导致“MongoError：错误：未经授权的数据库”。我想我需要将我的登录凭据传递给它。我也有，

```
var mongoose = require('mongoose');
var db = mongoose.createConnection('<omitted username, password and address>', 'myappsession'); 
```

我猜 connect-mongo 需要这些信息来登录我的数据库来创建会话存储？

**问题**

如何传递 connect-mongo 登录信息？还是我做错了？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-23T17:43:38.153

就我而言，由于我已经在积极使用 Mongoose，因此我最终使用了 Mongoose 的解决方案。

**1.安装session-mongoose**

[https://github.com/donpark/session-mongoose](https://github.com/donpark/session-mongoose)

**2\. 使用本教程作为指南。**

[http://mikevalstar.com/Blog/107/Coding_with_Nodejs_Part_31_Mongoose_Sessions](http://mikevalstar.com/Blog/107/Coding_with_Nodejs_Part_31_Mongoose_Sessions)

**3\. 特别是，我对教程的这行有问题。**

```
url: "mongodb://localhost/mv" 
```

这应该是这样的，

```
url: "username:password@url/testdatabase" 
```

然后将会话存储在集合“会话”中名为“测试数据库”的数据库中。

我希望这个答案可以帮助某人避免一些挫败感。:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-23T17:35:04.520

您需要使用 MongoDB URI。在此处查看文档： [http ://www.mongodb.org/display/DOCS/Connections](http://www.mongodb.org/display/DOCS/Connections)

```
mongodb://[username:password@]host1[:port1][,host2[:port2],...[,hostN[:portN]]][/[database][?options]] 
```

因此，如果您要连接到单个服务器，只需使用：

```
mongoose.createConnection('mongodb://[username:password@]host1[:port1]', 'myappsession'); 
```

# ember.js - 根据我的模型中的属性显示/隐藏 Emberjs TextField 时的一些用户交互问题

> ID：12554483
> 
> 赞同：0
> 
> 时间：2012-09-23T17:21:50.897
> 
> 标签：ember.js

很抱歉标题冗长而复杂，但我无法更好地总结它。

我有一个简单的模型，带有一个属性`foo`，初始化为`null`.

在我看来，我不想在`foo`is`null`或时显示输入字段`""`，并且有一个显示*Add foo*的按钮。

```
<a href="#" class="btn" {{action addFoo obj}}> Add foo </a>

{{#if obj.foo}}
  {{view Ember.TextField valueBinding="obj.foo"}}
{{/if}} 
```

然后在我的行动`addFoo`中，我会：

```
obj.set('foo', 1); 
```

这将使输入字段出现。

这种方法有两个问题：

1.  `1`实际上是一个任意值，它在我的应用程序中没有任何特殊含义。
2.  `1`如果用户因为想输入而删除`2`，输入字段将在他们有时间输入之前消失`2`。

这种用户交互有更好的方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-24T07:45:40.210

我不确定我是否理解您的问题，但请检查一下，如果这是您需要的：

属性`foo`是一个长度为 0 的数组，即

```
foo: [] 
```

**车把文件**

```
<a href="#" {{action addTextField obj}} class="btn">Add Foo</a>
{{#each foo}}
  {{view Ember.Textfield}}
{{/each}} 
```

添加文本字段：

```
addTextField: function(){
  obj.get('foo').pushObject(1);
} 
```

因此，文本字段的数量=数组的长度`foo`如果您需要保留文本字段值的绑定，请使用以下方法：（再次`obj.foo`是一个空数组）

```
obj.textFieldView = Ember.CollectionView.extend({
  contentBinding: 'foo',
  itemViewClass: Ember.Textfield.extend({
    valueBinding: 'this.content'
  })
})

obj.addTextField = function(){
  obj.get('foo').pushObject("");
} 
```

**车把文件**

```
<a href="#" {{action addTextField obj}} class="btn">Add Foo</a>
{{#collection obj.textFieldView}}
{{/collection}} 
```

每当您单击“添加 Foo”时，都会添加一个新文本字段，并且您在文本字段中输入的任何内容都绑定到“foo”数组....希望这会有所帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-24T19:14:46.833

我最终为我的模型添加了一个计算属性：

```
fooIsSet: function() { return this.get('foo') !== null }.property('foo') 
```

所以在我的`handlebars`模板中我可以这样做：

```
{{#if obj.fooIsSet}}
  do stuff
{{/if}} 
```

这样我只能处理`null`，并且`''`会表现得好像该属性已设置且有效。

# c++ - Qt - 信息未在 ListView 中加载

> ID：12554484
> 
> 赞同：1
> 
> 时间：2012-09-23T17:21:51.720
> 
> 标签：c++, qt

我有一个 QListView ，它使用模型向其加载信息。当我将新行插入模型时出现错误，它不会显示在 QListView 中。这些是我使用的代码：

在标题中：

```
bugModel = new QStandardItemModel();
ui->bugList->setModel(bugModel); 
```

在 cpp 中（按下按钮时）：

```
bugModel->insertRows(bugModel->rowCount(), 1);
bugModel->setData(bugModel->index(bugModel->rowCount()-1,0), "Test"); 
```

可能是什么问题呢？

PS 当我使用 qDebug() 检查它时，按下按钮时会调用该函数。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T17:31:24.113

你加栏了吗？
如果不是 -`bugModel->insertColumn(0);`在标题中添加行。

# c# - 在 DDD 中打包存储库及其接口

> ID：12554487
> 
> 赞同：7
> 
> 时间：2012-09-23T17:22:11.277
> 
> 标签：c#, domain-driven-design, ddd-repositories

在我从事的 DDD 之后的应用程序中，我们倾向于有一个服务层，其中包含服务 + 存储库 + 存储库和服务的接口，它们都存在于同一个程序集中，而域模型将存在于不同的程序集中。感觉就像在这个大项目中所有不适合领域模型的东西都杂乱无章。

在遵循 DDD 原则和模式的应用程序中，如何打包存储库及其实现的接口？打包 DDD 应用程序的不同逻辑部分（或一般打包）的最佳实践是什么？每个逻辑分区都应该存在于自己的程序集中吗？这还重要吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-23T18:03:20.830

我会看看洋葱架构。基本上所有领域服务的领域模型和接口都被认为是核心。层仅依赖于它们上方更靠近核心的层。它们的实际实现由基础设施处理。

见这里[http://jeffreypalermo.com/blog/the-onion-architecture-part-1/](http://jeffreypalermo.com/blog/the-onion-architecture-part-1/)

最终，您的接口定义了您的应用程序。如何实现的逻辑是外部化的。因此，我希望您拥有包含域模型和域服务的程序集、前端（例如 MVC 等），然后是实现诸如 NHibernate 之类的东西以提供数据等的基础设施程序集。

您可以在链接文章的各个部分中看到实现架构的各种示例。最简单的在这里[https://bitbucket.org/jeffreypalermo/onion-architecture/get/1df2608bc383.zip](https://bitbucket.org/jeffreypalermo/onion-architecture/get/1df2608bc383.zip)

您可以在此处查看与其相关的问题[https://stackoverflow.com/questions/tagged/onion-architecture](https://stackoverflow.com/questions/tagged/onion-architecture)

主要的好处是，变化最频繁的主要是基础设施问题。新的数据层技术，新的文件存储等。此外，您的核心域应该相当稳定，因为它没有实现任何只是通过合约（接口）定义它需要的东西。通过将实施关注点放在一个位置，您可以最大限度地减少整个程序集所需的更改量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-24T12:08:10.837

[您可以在DDD 书中](https://rads.stackoverflow.com/amzn/click/com/0321125215)找到设计层的指南。你基本上有：

*   领域
*   基础设施
*   应用
*   用户界面

服务分为 3 种：应用层服务、基础设施层服务和领域层服务，具体取决于服务的功能。至于存储库，它们的合约（接口）通常驻留在域中，而它们的具体实现则在基础设施层中。

关于组件，我建议每层至少一个。程序集和 dll 都是关于可重用性、关注点分离和解耦的——我是否能够选择该 dll 并将其丢弃以在另一个应用程序中重用它？我是否能够做到这一点，而无需拖累一堆不相关的功能，这些功能会给其他应用程序带来不必要的复杂性？我是否可以通过更改依赖注入模块中的一行代码轻松地将我的 dll 替换为另一个？等等。

# javascript - 将模型属性作为参数传递给 javascript 函数时，Razor 视图中的语法错误

> ID：12554493
> 
> 赞同：12
> 
> 时间：2012-09-23T17:23:48.287
> 
> 标签：javascript, asp.net-mvc, razor, visual-studio-2012

我在以下代码中的`Syntax error`每个逗号 ( `,`) 和最后一个括号 ( ) 上得到一个：`)`

```
<script type="text/javascript">
    Filters.priceRangeInit(@Model.Min, @Model.Max, @Model.From, @Model.To);
</script> 
```

javascript 函数位于另一个文件中，如下所示：

```
Filters = {
    priceRangeInit: function (min, max, from, to) {
        $('#price-range-slider').slider({
            min: min,
            max: max,
            step: 50,
            values: [from, to],
            slide: function (event, ui) {
                $('#left-price-range-amount').val(ui.values[0]);
                $('#right-price-range-amount').val(ui.values[1]);
            }
        });
    }
}; 
```

该模型如下所示：

```
public class PriceRangeFilterModel
{
    public int Min { get; set; }
    public int Max { get; set; }
    public int From { get; set; }
    public int To { get; set; }
} 
```

我使用 Visual Studio 2012、ASP.NET MVC 3 和 Razor，在浏览器中一切正常，但我想摆脱在 IDE 中遇到的 4 个语法错误。

如果我传递参数，因为`strings`我不再收到错误，但是我必须将每个参数都转换回以`int`使滑块工作：

```
<script type="text/javascript">
    Filters.priceRangeInit('@Model.Min', '@Model.Max', '@Model.From', '@Model.To');
</script> 
```

您对如何编写此调用有任何其他想法，以免我收到语法错误吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-09-24T05:30:18.550

Razor Intellisense 刚刚在 Visual Studio 中损坏。您的代码完全有效，您应该忽略这些警告，并希望 Microsoft 在未来的版本中修复它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-05-21T16:31:02.620

要抑制语法错误，请将字符串值包含在引号中或将数字包含在 parseInt() 中，如下所示：

```
var myInt = parseInt('@Model.MyInt');
var myStr = '@Model.MyString'; 
```

或者，对于您的示例：

```
Filters.priceRangeInit(parseInt('@Model.Min'), parseInt('@Model.Max'), parseInt('@Model.From'), parseInt('@Model.To')); 
```

往返转换很烦人，但确实不需要时间。

# stream - 使用 ffmpeg 将 MP3 比特率从一个流转换为另一个流

> ID：12554499
> 
> 赞同：0
> 
> 时间：2012-09-23T17:24:21.990
> 
> 标签：stream, ffmpeg, file-conversion

使用 ffmpeg，我想知道是否可以在收到数据块时转换 mp3 比特率？

这意味着我会缓慢地将块发送到 ffmpeg，以便它输出具有另一个比特率的 mp3。

所以在非常伪代码中，它看起来像这样：

1.  来自用户的 MP3 请求

2.  将默认 mp3 发送到带有参数的 ffmpeg，以转换为所需的比特率。

3.  当它正在编写一个新文件时，在响应输出流中写入到目前为止所写的内容（我在 ASP.Net 中）

这是可行的还是我需要切换到另一种技术？

[编辑]

现在，我正在尝试这样的解决方案：[Convert wma stream to mp3 stream with C# and ffmpeg](https://stackoverflow.com/questions/11767089/convert-wma-stream-to-mp3-stream-with-c-sharp-and-ffmpeg)

[编辑 2]

我回答了我的问题，以 url 作为输入和标准输出作为输出是可行的。使用 url 允许逐块处理文件，使用标准输出，我们可以在处理数据时访问数据。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-24T03:43:35.547

这是 C# 中的方法，请阅读[http://jesal.us/2008/04/how-to-manipulate-video-in-net-using-ffmpeg-updated/](http://jesal.us/2008/04/how-to-manipulate-video-in-net-using-ffmpeg-updated/)并更改为从流到流。这意味着使用 ffmpeg 对流进行“实时”转换。

命令末尾的“ ***- ”代表“标准输出”，这就是它是目的地的原因。***

```
 private void ConvertVideo(string srcURL)
    {
        string ffmpegURL = @"C:\ffmpeg.exe";
        DirectoryInfo directoryInfo = new DirectoryInfo(@"C:\");

        ProcessStartInfo startInfo = new ProcessStartInfo();
        startInfo.FileName = ffmpegURL;
        startInfo.Arguments = string.Format("-i \"{0}\" -ar 44100 -f mp3 -", srcURL);
        startInfo.WorkingDirectory = directoryInfo.FullName;
        startInfo.UseShellExecute = false;
        startInfo.RedirectStandardOutput = true;
        startInfo.RedirectStandardInput = true;
        startInfo.RedirectStandardError = true;
        startInfo.CreateNoWindow = false;
        startInfo.WindowStyle = ProcessWindowStyle.Normal;

        using (Process process = new Process())
        {
            process.StartInfo = startInfo;
            process.EnableRaisingEvents = true;
            process.ErrorDataReceived += new DataReceivedEventHandler(process_ErrorDataReceived);
            process.OutputDataReceived += new DataReceivedEventHandler(process_OutputDataReceived);
            process.Exited += new EventHandler(process_Exited);

            try
            {
                process.Start();
                process.BeginErrorReadLine();
                process.BeginOutputReadLine();
                process.WaitForExit();
            }
            catch (Exception ex)
            {
                MessageBox.Show(ex.Message);
            }
            finally
            {
                process.ErrorDataReceived -= new DataReceivedEventHandler(process_ErrorDataReceived);
                process.OutputDataReceived -= new DataReceivedEventHandler(process_OutputDataReceived);
                process.Exited -= new EventHandler(process_Exited);

            }
        }
    }

    void process_OutputDataReceived(object sender, DataReceivedEventArgs e)
    {
        if (e.Data != null)
        {
            byte[] b = System.Text.Encoding.Unicode.GetBytes(e.Data);
            // If you are in ASP.Net, you do a 
            // Response.OutputStream.Write(b)
            // to send the converted stream as a response
        }
    }

    void process_Exited(object sender, EventArgs e)
    {
        // Conversion is finished.
        // In ASP.Net, do a Response.End() here.
    } 
```

# objective-c - 在 NSTextView 中获取并突出显示当前单词

> ID：12554501
> 
> 赞同：9
> 
> 时间：2012-09-23T17:24:26.210
> 
> 标签：objective-c, cocoa, nstextview

好的，这就是我想要的：

*   我们有一个`NSTextView`
*   在光标位置获取“当前”单词（作为`NSRange`？）（如何确定？）
*   突出显示它（更改其属性）

我不知道该怎么做：我的意思是我主要关心的是在其中获得当前位置`NSTextView`并获得这个词*（我知道一些文本插件支持这一点，但我不确定最初的`NSTextView`实现...... )*

是否有任何内置功能？或者，如果没有，有什么想法吗？

* * *

**更新：** *光标位置*（已解决）

```
NSInteger insertionPoint = [[[myTextView selectedRanges] objectAtIndex:0] rangeValue].location; 
```

现在，仍在尝试找到一种解决方法来指定基础单词...

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-23T18:26:56.293

这是一种方法：

```
NSUInteger insertionPoint = [myTextView selectedRange].location;
NSString *string = [myTextView string];

[string enumerateSubstringsInRange:(NSRange){ 0, [string length] } options:NSStringEnumerationByWords usingBlock:^(NSString *word, NSRange wordRange, NSRange enclosingRange, BOOL *stop) {
if (NSLocationInRange(insertionPoint, wordRange)) {
    NSTextStorage *textStorage = [myTextView textStorage];
    NSDictionary *attributes = @{ NSForegroundColorAttributeName: [NSColor redColor] }; // e.g.
    [textStorage addAttributes:attributes range:wordRange];
    *stop = YES;
}}]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-23T18:26:19.960

查找单词边界的简单算法（假设单词是空格分隔的）：

```
NSInteger prev = insertionPoint;
NSInteger next = insertionPoint;

while([[[myTextView textStorage] string] characterAtIndex:prev] != ' ')
    prev--;

prev++;

while([[[myTextView textStorage] string] characterAtIndex:next] != ' ')
    next++;

next--;

NSRange currentWordRange = NSMakeRange(prev, next - prev + 1);
NSString *currentWord = [[[myTextView textStorage] string] substringWithRange:currentWordRange]; 
```

# php - 成功上传或取消后，我收到 php 通知

> ID：12554504
> 
> 赞同：0
> 
> 时间：2012-09-23T17:24:39.393
> 
> 标签：php, jquery, mysqli

我有一个表格，它附加了行并且我有 3 行，下面的表格看起来像这样：

```
 Question No     Image

    1            (file input)
    2            (file input)
    3            (file input) 
```

下面是创建上表的代码：

```
var qnum = 1;  
var numimage = 0;

var $qid = $("<td class='qid'></td>").text(qnum);
var $image = $("<td class='image'></td>"); 

          $('.num_questions').each( function() {

    var $this = $(this);

     var $questionNumber = $("<input type='hidden' class='num_questionsRow'>").attr('name',$this.attr('name')+"[]")
                   .attr('value',$this.val());

     $qid.append($questionNumber);  
    ++qnum;
    ++numimage;          
    $(".questionNum").text(qnum);
    $(".numimage").val(numimage);

});

    var $fileImage = $("<form action='imageupload.php' method='post' enctype='multipart/form-data' target='upload_target' onsubmit='return imageClickHandler(this);' class='imageuploadform' >" + 
    "Image File: <input name='fileImage' type='file' class='fileImage' /></label><br/><br/><label class='imagelbl'>" + 
    "<input type='submit' name='submitImageBtn' class='sbtnimage' value='Upload' /></label>" + 
    "<input type='hidden' class='numimage' name='numimage' value='" + numimage + "' />" +
    "</p><p class='imagef1_cancel' align='center'><label>" +
    "<input type='reset' name='imageCancel' class='imageCancel' value='Cancel' /></label>" +
    "</p><p class='listImage' align='left'></p>" +      
    "<iframe class='upload_target' name='upload_target' src='#' style='width:0;height:0;border:0px;solid;#fff;'></iframe></form>");        

    $image.append($fileImage);

   $tr.append($qid);
    $tr.append($image); 
```

我遇到的问题是，如果一个文件不成功或被取消，然后我上传了另一个这次成功的文件，我会在 iframe 中收到以下通知：

```
Notice: Undefined index: numimage in /web/stud/...../app/imageupload.php on line 150 
```

我的问题是，当我在尝试或取消失败后成功上传文件时，为什么我会在下面的 php 代码中收到此通知，它会将数据插入数据库？

```
 move_uploaded_file($_FILES["fileImage"]["tmp_name"],
      "ImageFiles/" . $_FILES["fileImage"]["name"]);
      $result = 1;

 $lastID = $mysqli->insert_id;         

 $imagequestionsql = "INSERT INTO Image_Question (ImageId, SessionId, QuestionId)  
    VALUES (?, ?, ?)"; 

     if (!$insertimagequestion = $mysqli->prepare($imagequestionsql)) { 
      // Handle errors with prepare operation here 
       echo "Prepare statement err imagequestion"; 
    } 

$qnum = (int)$_POST['numimage'];

$insertimagequestion->bind_param("isi",$lastID, $sessid, $qnum); 

$sessid =  $_SESSION['id'] . ($_SESSION['initial_count'] > 1 ? $_SESSION['sessionCount'] : ''); 

    $insertimagequestion->execute(); 

                if ($insertimagequestion->errno) { 
          // Handle query error here 
        } 

        $insertimagequestion->close(); 

      }

<script language="javascript" type="text/javascript">window.top.stopImageUpload(<?php echo $result ? 'true' : 'false'; ?>, '<?php echo $_FILES['fileImage']['name'] ?>');</script> 
```

更新：

下面是jquery代码，其中包含`startimageupload`上传开始时的`stopimageupload`函数和上传停止或完成时的函数：

```
function htmlEncode(value) { return $('<div/>').text(value).html(); }

function startImageUpload(imageuploadform){

$(imageuploadform).find('.imagef1_upload_process').css('visibility','visible');
$(imageuploadform).find('.imagef1_cancel').css('visibility','visible');
$(imageuploadform).find('.imagef1_upload_form').css('visibility','hidden');
sourceImageForm = imageuploadform;

$(".sbtnimage").attr("disabled", "disabled");
$(".sbtnvideo").attr("disabled", "disabled");
$(".sbtnaudio").attr("disabled", "disabled");

$(imageuploadform).find(".imageCancel").on("click", function(event) {

$('.upload_target_image').get(0).contentwindow
$("iframe[name='upload_target_image']").attr("src", "javascript:'<html></html>'");
return stopImageUpload(2);
});

return true;

}

var imagecounter = 0;
function stopImageUpload(success, imagefilename){
var result = '';
imagecounter++;

if (success == 1){
result = '<span class="imagemsg'+imagecounter+'">The file was uploaded successfully</span><br/><br/>';
$('.listImage').eq(window.lastUploadImageIndex).append('<div>' + htmlEncode(imagefilename) + '<button type="button" class="deletefileimage" image_file_name="' + imagefilename + '">Remove</button><br/><hr/></div>');
}

else if (success == 2){

result = '<span class="imagemsg'+imagecounter+'"> The file upload was canceled</span><br/><br/>';

}

else {

result = '<span class="imagemsg'+imagecounter+'">There was an error during file upload</span><br/><br/>';
}

$(sourceImageForm).find('.imagef1_upload_process').css('visibility','hidden');
$(sourceImageForm).find('.imagef1_cancel').css('visibility','hidden');
$(sourceImageForm).find('.imagef1_upload_form').html(result + '<label>Image File: <input name="fileImage" class="fileImage" type="file"/></label><br/><br/><label><input type="submit" name="submitImageBtn" class="sbtnimage" value="Upload" /></label><label><input type="button" name="imageClear" class="imageClear" value="Clear File"/></label>');
$(sourceImageForm).find('.imagef1_upload_form').css('visibility','visible');

$(".sbtnimage").removeAttr("disabled");
$(".sbtnvideo").removeAttr("disabled");
$(".sbtnaudio").removeAttr("disabled");

$(".imageClear").on("click", function(event) {
event.preventDefault();
$(this).parents("form:first").find(".fileImage").replaceWith("<input type='file' class='fileImage' name='fileImage' />");
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T17:28:26.153

它在 $_POST 数组中找不到键 numimage - 这意味着 numimage 不是由您的 ajax 调用发送的。您是否尝试过使用 Firebug 查看发送到 php 脚本的内容？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T17:31:37.027

线`$qnum = (int)$_POST['numimage'];`导致它。$_POST 数组似乎没有设置索引的值`numimage`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-23T18:22:35.293

好的，通过查看您发布的代码，我正在猜测正在发生的事情，因为我看不到代码的完整流程。基本上以下代码导致您的问题：

```
$(sourceImageForm).find('.imagef1_upload_process').css('visibility','hidden');
$(sourceImageForm).find('.imagef1_cancel').css('visibility','hidden');
/// THIS LINE BELOW
$(sourceImageForm).find('.imagef1_upload_form').html(result + '<label>Image File: <input name="fileImage" class="fileImage" type="file"/></label><br/><br/><label><input type="submit" name="submitImageBtn" class="sbtnimage" value="Upload" /></label><label><input type="button" name="imageClear" class="imageClear" value="Clear File"/></label>');
/// THIS LINE ABOVE
$(sourceImageForm).find('.imagef1_upload_form').css('visibility','visible'); 
```

上面的代码取自在成功/错误上传发生后运行的代码。此代码继续覆盖负责上传图像的表单。现在这对于成功来说很好，因为正如我可以推断的那样，您的界面对每个图像使用单独的表单......一旦您获得成功，您就不会再次重复使用该表单*（因此服务器端没有错误用于后续上传）*。

但是，当图像上传错误或取消时......我想我猜对了 - 您尝试重复使用该表格再次上传图像？如果是这样，您已经覆盖并删除了 numimage 输入 html：

```
<input type='hidden' class='numimage' name='numimage' value='2' /> 
```

这意味着您会收到一个错误，因为该字段不再存在。

正如我所说，这是一个猜测，但它会导致删除一个开始时确实存在的字段，并会产生您所看到的问题。

# macos - 在任意输入类型上运行服务（OSX Automator 工作流服务）

> ID：12554516
> 
> 赞同：2
> 
> 时间：2012-09-23T17:26:53.583
> 
> 标签：macos, service, workflow, automator, uti

我想创建一个`runWorkflowAsService`使用自定义`InputTypeIdentifier`值的新服务 (OSX)。有没有办法做到这一点？

例如，假设的工作流`document.wflow`文件（由 Automator 生成）如下所示：

```
<key>workflowMetaData</key>
<dict>
    <key>serviceInputTypeIdentifier</key>
    <string>com.apple.Automator.fileSystemObject</string>
    ...
</dict> 
```

但我希望（例如）这是可能的：

```
 <key>serviceInputTypeIdentifier</key>
    <string>com.apple.ApplicationBundle</string> 
```

通过反复试验，系统工作流ServiceRunner 似乎只能`com.apple.Automator`接受预定义的 UTI。有解决方法吗？

# c# - 如果系统日期错误，我如何获得正确的日期

> ID：12554521
> 
> 赞同：2
> 
> 时间：2012-09-23T17:27:35.703
> 
> 标签：c#, asp.net

我 `DateTime.Now.ToString("MM/dd/yyyy");` 用来获取当前日期。如果我更改系统日期，则 DateTime.Now() 返回的日期也会更改，这很容易受到攻击。

任何人都有解决方案吗？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T17:29:40.000

在这种情况下，您必须使用 NTP 服务器来检索当前日期/时间。查看另一个问题中发布的实现。 [如何使用 C# 查询 NTP 服务器？](https://stackoverflow.com/questions/1193955/how-to-query-an-ntp-server-using-c)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-23T17:29:41.930

当您不信任机器的时间时，您可以使用 NTP（网络时间协议）客户端调用向受信任的时间服务器询问正确的时间。

有很多客户代码。例如[http://www.dotnet-snippets.com/dns/c-simple-network-time-ntp-protocol-client-SID571.aspx](http://www.dotnet-snippets.com/dns/c-simple-network-time-ntp-protocol-client-SID571.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-23T20:39:28.160

海都感谢您的评论和网关。

我想分享一个对我有帮助的链接。

[http://nickstips.wordpress.com/2010/02/12/c-get-nist-internet-time/](http://nickstips.wordpress.com/2010/02/12/c-get-nist-internet-time/)

# matlab - 在 MATLAB 中将矩阵划分为子矩阵

> ID：12554522
> 
> 赞同：0
> 
> 时间：2012-09-23T17:27:36.930
> 
> 标签：matlab

我有一个大小为 RGB 的图像`412x550`。我想把它分成 size 的子矩阵`2x2`。我尝试过使用`mat2cell`函数，但它给出了错误。错误是：

> 输入参数 D1 到 D2 必须与输入矩阵大小 [412 550] 的每个维度相加。

如何解决此错误以获得所需的子矩阵？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-23T18:14:28.790

你的语法可能有点不对劲。适合您情况的正确语法是

```
>> A = rand(412,550);
>> B = mat2cell(A, 2*ones(size(A,1)/2,1), 2*ones(size(A,2)/2,1))

ans = 
    [2x2 double]    [2x2 double]    ... 
    [2x2 double]    [2x2 double]    ...
    ... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-23T20:31:04.023

您应该使用该功能`im2col`。这正是您所需要的。

```
A = rand(412,550);
B = im2col(A,[2 2]); 
```

文档在那里：

[http://www.mathworks.fr/help/images/ref/im2col.html;jsessionid=4d24325613716d84d4635b4fc636](http://www.mathworks.fr/help/images/ref/im2col.html;jsessionid=4d24325613716d84d4635b4fc636)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-10-05T13:13:59.927

一般来说，您可以使用以下代码将图像分成块（用于压缩过程或其他）

```
 A=imread('image.bmp'); % i assume 8-bit gray scale image
    [m,n,k]=size(A); % and m=n with 1 channel k=1
    ImageSize=m*n;
    BlockD=2; % i assume 2x2 block
    BlockSize=BlockD*BlockD;
    NoOfBlock=ImageSize/BlockSize;
    SubB=zeros(BlockD,BlockD,NoOfBlock); %arrays of blocks.
    B=double(A); important to convert uint8 to double when dialing with image.
    % thats what ru asking for.
    k=1;
    for i=1:BlockD:m
    for j=1:BlockD:n
        SubB(:,:,k)=B(i:i+BlockD-1,j:j+BlockD-1); k=k+1;
    end
    end
    %compare between first submatrix A with first block.. its the same elements.
    B(1:2,1:2)
    SubB(:,:,1) 
```

# eclipse - 在 Eclipse 上运行另一个项目

> ID：12554523
> 
> 赞同：2
> 
> 时间：2012-09-23T17:27:37.490
> 
> 标签：eclipse, project

在我的 Eclipse 工作区中，我有一个正在处理的库项目，并且我设置了另一个用于测试的项目。

当我单击 时`Ctrl+F11`，我无法运行我的库，因为无法运行库。当我尝试运行库项目时，有没有办法启动我的测试项目？

我真的很讨厌将鼠标移到顶部的绿色按钮并选择另一个项目来运行。在 Visual Studio 中，有一个项目选项可以运行另一个项目，而不是正在开发的项目。

# android - 操作栏中的自定义视图

> ID：12554524
> 
> 赞同：4
> 
> 时间：2012-09-23T17:27:46.600
> 
> 标签：android, android-actionbar, actionbarsherlock

我有一个动作栏。操作栏中的项目之一是通知。我想在操作栏项目的右上角添加一个小图标，表示用户当前拥有多少通知。

我继续为操作栏项目制作了自定义布局。去添加它，令我惊讶的是，我无法将自定义视图添加为操作栏上的按钮。

我正在使用 Actionbar-Sherlock 来兼容旧设备。

这就是我想要的：

![在此处输入图像描述](../Images/d344dc60e44b1c181f98aea3773b9d49.png)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-26T07:37:40.227

您正在寻找[ActionProvider](http://developer.android.com/reference/android/view/ActionProvider.html)。在这里你可以提供你自己的观点和听众。

查看 ABS 演示，[https://github.com/JakeWharton/ActionBarSherlock/blob/master/actionbarsherlock-samples/demos/src/com/actionbarsherlock/sample/demos/ActionProviders.java](https://github.com/JakeWharton/ActionBarSherlock/blob/master/actionbarsherlock-samples/demos/src/com/actionbarsherlock/sample/demos/ActionProviders.java)

# java - 在 Linux 服务器的后台运行 Java 应用程序

> ID：12554526
> 
> 赞同：0
> 
> 时间：2012-09-23T17:28:12.733
> 
> 标签：java, tomcat, jar

我想在我的服务器上运行 jwebsocket 服务器。我没有安装 Tomcat，如果可能的话我宁愿避免它（尽管它对我来说不是那么重要）。jwebsocket 是一个 .jar 应用程序。我现在要运行它，就是通过 SSH 登录到我的服务器，然后启动它。然而，通过这种方式，它会将整个 SSH 控制台变成它自己的日志，如果我想断开与 SSH 的连接，我必须先关闭它。

有没有办法在后台运行它？

如果这不是推荐的方式，我宁愿只安装 Tomcat。但是由于除了一个特定的应用程序之外，Tomcat 对我来说是不必要的，如果不是绝对必要的话，我宁愿避免它。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-23T17:35:56.057

运行它

```
java -jar yourapp.jar > /dev/null & 
```

# vba - 错误 1004 - 使用范围命令中的表格时应用程序定义或对象定义错误

> ID：12554530
> 
> 赞同：0
> 
> 时间：2012-09-23T17:28:51.037
> 
> 标签：vba, excel

我是 VBA 新手，遇到命令问题，我已将其分离到单独的 Excel 电子表格中，但仍然无法正常工作。

如果我在活动工作表上使用以下内容，一切都很好

```
Range(Cells(1, 1), Cells(99, 2)).Value = "Test" 
```

但是当我使用：

```
Sheets("one").Range(Cells(1, 1), Cells(99, 2)).Value = "Test" 
```

我收到错误`1004 application defined or object defined error`。

我的工作簿中有名为“one”的工作表。

我花了最后几个小时在谷歌上搜索，但没有运气，有人能提出问题吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-23T17:34:48.660

您还必须限定`Cells()`对象

```
Sub Sample()
    With Sheets("one")
        .Range(.Cells(1, 1), .Cells(99, 2)).Value = "Test"
    End With
End Sub 
```

# javascript - setInterval 性能

> ID：12554531
> 
> 赞同：0
> 
> 时间：2012-09-23T17:29:13.593
> 
> 标签：javascript, performance, setinterval

> **可能重复：**
> [Javascript：setInterval() 行为，0 毫秒](https://stackoverflow.com/questions/7648557/javascript-setinterval-behaviour-with-0-milliseconds)

我只是想听听，如果将时间设置为 0 毫秒的 setInterval 存在问题？会不会有性能问题？拥有例如 1000 毫秒会更好吗？

我有这个脚本：

```
var countdown_id = setInterval(function() {
    var now = (new Date()).getTime()-(2*60*60*1000);
    ;
    $('.product').each(function() {
        var elm = $(this).attr('id');
        var prod_id = $("#"+elm+" #hidden-"+elm).val();

        var expires = $('#date-end-' + prod_id).val()*1000;

        var seconds_remaining = Math.round((expires - now)/1000);

        var hours = FormatNumberLength(Math.floor(seconds_remaining/(60*60)), 2);
        var sec_remaining = seconds_remaining-(hours*60*60);
        var minutes = FormatNumberLength(Math.floor(sec_remaining/60), 2);
        var sec_remaining2 = sec_remaining-(minutes*60);
        var seconds = FormatNumberLength(sec_remaining2, 2);

        var timestr = hours + ":" + minutes + ":"+seconds;

        if (expires) {
            if (seconds_remaining > 0) {
                $('#'+elm+' .time_left div').text(timestr);
            }
            else {
                $(this).hide();
            }
        }
        $('#'+elm+' .time_left div').text(timestr);
    });
}, 0); 
```

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T17:30:57.480

> 如果将时间设置为 0 毫秒的 setInterval 存在问题？

您不能将间隔设置为**0**，因为浏览器会忽略它。

> 会不会有性能问题？拥有例如 1000 毫秒会更好吗？

当然，如果可能的话，1000 毫秒比 10（不是零）要好。
每 10 毫秒做一件事比每 1000 毫秒做一次精确的事情要花费更多。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-23T17:32:54.707

Javascript 不是多线程的，它只是通过延迟执行来模拟它。当计时器达到您的超时间隔时，它将暂停**所有**其他执行并运行您告诉它的代码。因此，您可能需要注意间隔时间有多短。如果您不小心，它可能会损坏您的浏览器。

# jsf - 尝试运行 Apache MyFaces 2.0.2 应用程序时出现未知 NullPointerException

> ID：12554539
> 
> 赞同：0
> 
> 时间：2012-09-23T17:29:56.157
> 
> 标签：jsf, jsf-2, myfaces, trinidad

我正在尝试运行基于`Apache MyFaces 2.0.2`和`Apache Trinindad 2.0.1`. 我正在运行`weblogic 11g`。我遇到了一个`NullPointerException`我无法调试的特立尼达内部类。这是例外

```
javax.faces.FacesException: java.lang.NullPointerException
    at org.apache.myfaces.shared_impl.context.ExceptionHandlerImpl.wrap(ExceptionHandlerImpl.java:241)
    at org.apache.myfaces.shared_impl.context.ExceptionHandlerImpl.handle(ExceptionHandlerImpl.java:156)
    at org.apache.myfaces.lifecycle.LifecycleImpl.executePhase(LifecycleImpl.java:191)
    at org.apache.myfaces.lifecycle.LifecycleImpl.execute(LifecycleImpl.java:118)
    at javax.faces.webapp.FacesServlet.service(FacesServlet.java:189)
    at weblogic.servlet.internal.StubSecurityHelper$ServletServiceAction.run(StubSecurityHelper.java:227)
    at weblogic.servlet.internal.StubSecurityHelper.invokeServlet(StubSecurityHelper.java:125)
    at weblogic.servlet.internal.ServletStubImpl.execute(ServletStubImpl.java:300)
    at weblogic.servlet.internal.TailFilter.doFilter(TailFilter.java:26)
    at weblogic.servlet.internal.FilterChainImpl.doFilter(FilterChainImpl.java:56)
    at com.others.CacheFilter.doFilter(CacheFilter.java:56)
    at weblogic.servlet.internal.FilterChainImpl.doFilter(FilterChainImpl.java:56)
    at weblogic.servlet.internal.RequestEventsFilter.doFilter(RequestEventsFilter.java:27)
    at weblogic.servlet.internal.FilterChainImpl.doFilter(FilterChainImpl.java:56)
    at weblogic.servlet.internal.WebAppServletContext$ServletInvocationAction.wrapRun(WebAppServletContext.java:3715)
    at weblogic.servlet.internal.WebAppServletContext$ServletInvocationAction.run(WebAppServletContext.java:3681)
    at weblogic.security.acl.internal.AuthenticatedSubject.doAs(AuthenticatedSubject.java:321)
    at weblogic.security.service.SecurityManager.runAs(SecurityManager.java:120)
    at weblogic.servlet.internal.WebAppServletContext.securedExecute(WebAppServletContext.java:2277)
    at weblogic.servlet.internal.WebAppServletContext.execute(WebAppServletContext.java:2183)
    at weblogic.servlet.internal.ServletRequestImpl.run(ServletRequestImpl.java:1454)
    at weblogic.work.ExecuteThread.execute(ExecuteThread.java:207)
    at weblogic.work.ExecuteThread.run(ExecuteThread.java:176)
Caused by: java.lang.NullPointerException
    at java.util.concurrent.ConcurrentHashMap.get(ConcurrentHashMap.java:768)
    at org.apache.myfaces.trinidadinternal.application.ViewDeclarationLanguageFactoryImpl._getInternalView(ViewDeclarationLanguageFactoryImpl.java:104)
    at org.apache.myfaces.trinidadinternal.application.ViewDeclarationLanguageFactoryImpl.getViewDeclarationLanguage(ViewDeclarationLanguageFactoryImpl.java:79)
    at org.apache.myfaces.application.ViewHandlerImpl.getViewDeclarationLanguage(ViewHandlerImpl.java:157)
    at javax.faces.application.ViewHandlerWrapper.getViewDeclarationLanguage(ViewHandlerWrapper.java:128)
    at org.apache.myfaces.lifecycle.RestoreViewExecutor.execute(RestoreViewExecutor.java:150)
    at org.apache.myfaces.lifecycle.LifecycleImpl.executePhase(LifecycleImpl.java:171)
    ... 20 more 
```

在生命周期之后遇到此错误`RESTOREVIEW PHASE`。这是我的`web.xml`。

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://java.sun.com/xml/ns/javaee" xmlns:web="http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd" xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd" id="WebApp_ID" version="2.5">
  <display-name>/*appname*/</display-name>
  <context-param>
    <param-name>javax.faces.PROJECT_STAGE</param-name>
    <param-value>Development</param-value>
  </context-param>
  <context-param>
    <description>State saving method: 'client' or 'server' (=default). See JSF Specification 2.5.2</description>
    <param-name>javax.faces.STATE_SAVING_METHOD</param-name>
    <param-value>client</param-value>
  </context-param>
  <context-param>
    <param-name>org.apache.myfaces.ALLOW_JAVASCRIPT</param-name>
    <param-value>true</param-value>
  </context-param>
  <context-param>
    <param-name>org.apache.myfaces.PRETTY_HTML</param-name>
    <param-value>true</param-value>
  </context-param>
  <context-param>
    <param-name>org.apache.myfaces.DETECT_JAVASCRIPT</param-name>
    <param-value>false</param-value>
  </context-param>
  <context-param>
    <param-name>org.apache.myfaces.AUTO_SCROLL</param-name>
    <param-value>true</param-value>
  </context-param>
 <context-param>
  <param-name>facelets.SKIP_COMMENTS</param-name> 
  <param-value>true</param-value> 
 </context-param>
 <context-param>
    <param-name>javax.faces.DEFAULT_SUFFIX</param-name>
    <param-value>.xhtml</param-value>
  </context-param>
    <context-param>
    <param-name>javax.faces.FACELETS_VIEW_MAPPINGS</param-name>
    <param-value>.xhtml</param-value>
  </context-param>
  <context-param>
    <param-name>org.apache.myfaces.ERROR_HANDLING</param-name>
    <param-value>false</param-value>
  </context-param>
  <context-param>
     <param-name>javax.faces.PARTIAL_STATE_SAVING_METHOD</param-name>
     <param-value>false</param-value>
  </context-param>
 <servlet>
    <servlet-name>Faces Servlet</servlet-name>
    <servlet-class>javax.faces.webapp.FacesServlet</servlet-class>
    <load-on-startup>1</load-on-startup>
  </servlet>
  <servlet-mapping>
    <servlet-name>Faces Servlet</servlet-name>
    <url-pattern>*.xhtml</url-pattern>
  </servlet-mapping>

  <servlet>
    <servlet-name>resources</servlet-name>
    <servlet-class>org.apache.myfaces.trinidad.webapp.ResourceServlet</servlet-class>
  </servlet>
  <servlet-mapping>
    <servlet-name>resources</servlet-name>
    <url-pattern>/adf/*</url-pattern>
  </servlet-mapping>

  <filter>
    <filter-name>trinidad</filter-name>
    <filter-class>org.apache.myfaces.trinidad.webapp.TrinidadFilter</filter-class>
  </filter>
  <filter-mapping>
    <filter-name>trinidad</filter-name>
    <servlet-name>faces</servlet-name>
  </filter-mapping>
    <error-page>
    <exception-type>java.lang.Exception</exception-type>
    <location>/others/Error.xhtml</location>
</error-page>
    <error-page>
    <exception-type>java.lang.NullPointerException</exception-type>
    <location>/others/Error.xhtml</location>
</error-page>
</web-app> 
```

这是我的`faces-config.xml`

```
<?xml version="1.0" encoding="UTF-8"?>

<faces-config
    xmlns="http://java.sun.com/xml/ns/javaee"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-facesconfig_2_0.xsd"
    version="2.0">

<application>
    <locale-config>
        <default-locale>en</default-locale>
        <supported-locale>en</supported-locale>
    </locale-config>
    <resource-bundle>
            <base-name>messages</base-name>
            <var>msgs</var>
        </resource-bundle>
    <default-render-kit-id>
        org.apache.myfaces.trinidad.core
    </default-render-kit-id>  
  </application>

    <lifecycle>
        <phase-listener>com.others.LifeCycleListener</phase-listener>
    </lifecycle>

</faces-config> 
```

这是`Home.xhtml`我要访问的

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:tr="http://myfaces.apache.org/trinidad"
    xmlns:trh="http://myfaces.apache.org/trinidad/html">

<h:body>
<ui:composition template="../Templates/homelayout.xhtml">

    <ui:define name="pagetitle">Home</ui:define>

    <ui:define name="bodycontent">
        <h:outputText value="This is an output text"/>
        <h:outputText value="This is an output text"/>
        <h:outputText value="This is an output text"/>
        <h:outputText value="This is an output text"/>
        <h:outputText value="This is an output text"/>
    </ui:define>

</ui:composition>

</h:body> 
```

这是我的文件夹结构快照

![在此处输入图像描述](../Images/a7b9eefe474002eca87b012ffebeb06c.png)

有人可以解释一下 Nullpointer Exception 的原因吗？以及如何解决？

提前致谢。

更新：我删除了旧`MyFaces 2.0.2`罐子并添加了`MyFaces 2.0.14`罐子。我还在 中添加了一个错误页面`web.xml`以获取完整的错误信息。这是它现在抛出的异常消息。

```
java.lang.NullPointerException
    at java.util.concurrent.ConcurrentHashMap.get(ConcurrentHashMap.java:768)
    at org.apache.myfaces.trinidadinternal.application.ViewDeclarationLanguageFactoryImpl._getInternalView(ViewDeclarationLanguageFactoryImpl.java:104)
    at org.apache.myfaces.trinidadinternal.application.ViewDeclarationLanguageFactoryImpl.getViewDeclarationLanguage(ViewDeclarationLanguageFactoryImpl.java:79)
    at org.apache.myfaces.application.ViewHandlerImpl.getViewDeclarationLanguage(ViewHandlerImpl.java:158)
    at javax.faces.application.ViewHandlerWrapper.getViewDeclarationLanguage(ViewHandlerWrapper.java:128)
    at org.apache.myfaces.lifecycle.RestoreViewExecutor.execute(RestoreViewExecutor.java:151)
    at org.apache.myfaces.lifecycle.LifecycleImpl.executePhase(LifecycleImpl.java:171)
    at org.apache.myfaces.lifecycle.LifecycleImpl.execute(LifecycleImpl.java:118)
    at javax.faces.webapp.FacesServlet.service(FacesServlet.java:189)
    at weblogic.servlet.internal.StubSecurityHelper$ServletServiceAction.run(StubSecurityHelper.java:227)
    at weblogic.servlet.internal.StubSecurityHelper.invokeServlet(StubSecurityHelper.java:125)
    at weblogic.servlet.internal.ServletStubImpl.execute(ServletStubImpl.java:300)
    at weblogic.servlet.internal.TailFilter.doFilter(TailFilter.java:26)
    at weblogic.servlet.internal.FilterChainImpl.doFilter(FilterChainImpl.java:56)
    at com.others.CacheFilter.doFilter(CacheFilter.java:56)
    at weblogic.servlet.internal.FilterChainImpl.doFilter(FilterChainImpl.java:56)
    at weblogic.servlet.internal.RequestEventsFilter.doFilter(RequestEventsFilter.java:27)
    at weblogic.servlet.internal.FilterChainImpl.doFilter(FilterChainImpl.java:56)
    at weblogic.servlet.internal.WebAppServletContext$ServletInvocationAction.wrapRun(WebAppServletContext.java:3715)
    at weblogic.servlet.internal.WebAppServletContext$ServletInvocationAction.run(WebAppServletContext.java:3681)
    at weblogic.security.acl.internal.AuthenticatedSubject.doAs(AuthenticatedSubject.java:321)
    at weblogic.security.service.SecurityManager.runAs(SecurityManager.java:120)
    at weblogic.servlet.internal.WebAppServletContext.securedExecute(WebAppServletContext.java:2277)
    at weblogic.servlet.internal.WebAppServletContext.execute(WebAppServletContext.java:2183)
    at weblogic.servlet.internal.ServletRequestImpl.run(ServletRequestImpl.java:1454)
    at weblogic.work.ExecuteThread.execute(ExecuteThread.java:207)
    at weblogic.work.ExecuteThread.run(ExecuteThread.java:176) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T15:00:28.257

终于解决了。

感谢**BalusC**指出`web.xml`.

**解决方案：**

在将`faces servlet`映射更改为`.xhtml`.

```
http://hostname/contextname/faces/others/Home.xhtml 
```

现在我刚刚`faces`从网址中删除并开始像这样访问我的应用程序

```
http://hostname/contextname/others/Home.xhtml 
```

令我惊讶的是，它没有给出任何异常并显示了我的主页。

# php - SESSION 无法保留值 | PHP 代码中的逻辑错误

> ID：12554541
> 
> 赞同：0
> 
> 时间：2012-09-23T17:30:35.310
> 
> 标签：php, session

我的计划目标 1\. 在我的网站上显示 5-6 个圆圈，每个圆圈都是蓝色的。2\. 每当单击一个圆圈时，它应永久变为红色或绿色。

这是我的代码：

```
<?php session_start(); ?>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>Let's see !</title>
</head>
<body>
<?php 
define("SIZE", 5);

for ( $i = 0 ; $i < SIZE ; $i++ ) //Initializes all Color Blocks to BLUE if not clicked
    {
        //If Image has been clicked, it takes a Color RED or GREEN
            if ( isset($_POST[$i."form"]) ) 
        {
            if($i % 2 == 0)
            $_SESSION[$i] = "green.jpg";
            else
            $_SESSION[$i] = "red.jpg";
        }
        else
        {   //to check if image was previously clicked.
            if ( $_SESSION[$i] == "green.jpg")
                $_SESSION[$i] = "green.jpg";

            elseif ( $_SESSION[$i] == "red.jpg")
                $_SESSION[$i] = "red.jpg";  
            else    //if never clicked it will be made blue.
                $_SESSION[$i] = "blue.jpg";  
        }
    }

for ( $i = 0 ; $i < SIZE ; $i++ )
{
?>
<form method="POST" action="index.php">
<input type="image" width=120 src="<?php echo $_SESSION[$i]; ?>" name="mainin"/> 
<input type="hidden" name="<?php echo $i."form"; ?>" value="" /> 
</form>
<?php }
echo session_id(); //Sessions are working correctly. No issue with them.
?>
</body>
</html> 
```

**这个程序会发生什么？** 每当单击一个圆圈时，它就会变成红色。单击第二个圆圈时，它变为绿色，第一个圆圈显示为蓝色。然而，当单击第二个圆圈时，第一个圆圈应显示为红色，第二个圆圈应显示为绿色。

据我所知，这个程序存在逻辑或概念上的错误。如果有人能告诉我哪里出错了，我将不胜感激。几个小时以来，我一直试图弄清楚这一点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T17:41:42.723

$ *SESSION 不能以数字键开头，请在它们后面加上 circle 之类的东西*，例如：

```
$_SESSION['circle_'.$i] 
```

希望有帮助。我在我的系统上对其进行了测试，这解决了这个问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-23T17:44:36.747

一次只能提交一个表单。如果您单击您的第一张图片，其他图片的代码将进入 else 分支（“检查之前是否点击过图片”），并且颜色将重置为蓝色。顺便说一句：只有所述分支中的“蓝色”行有任何作用，您可以删除其余部分。此外，您应该在将会话字段设置为“蓝色”之前检查它是否为空。

# android - 告诉 ListView 适配器不要更新数据更改

> ID：12554546
> 
> 赞同：0
> 
> 时间：2012-09-23T17:31:04.763
> 
> 标签：android, list, listview

我在 ScrollView 中使用 LinearLayout。我用一组对象填充它，当用户单击其中一个时，它会加载另一个具有相同列表的另一个对象的活动。这些对象在应用程序中，每当我想获得一组新对象时，我都会清除它们。但是现在我想用 ListView 替换 ScrollView。我为列表编写了自己的适配器……但是当用户单击一个项目时，我清除了该集合并开始了另一个活动……但是以前的 ListView 得到了更新。

当数据发生变化时，我可以以某种方式告诉列表不要更新吗？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T17:34:01.300

您可以将对象列表的副本传递给适配器.. 这样它就不会改变。它不是很有效，但是您没有提供足够的信息让我们了解您要做什么

# java - Java 的三元/条件运算符 (?:) 可以用来调用方法而不是赋值吗？

> ID：12554547
> 
> 赞同：28
> 
> 时间：2012-09-23T17:31:18.023
> 
> 标签：java, conditional-operator

在像[http://en.wikipedia.org/wiki/?](http://en.wikipedia.org/wiki/%3F:)这样的页面中：三元/条件运算符`?:`似乎用于条件赋值。我尝试将它用于方法调用，如下所示：

```
(condition) ? doThis() : doThat(); 
```

两种方法都返回 void。Java 告诉我这不是一个声明。

所以，我猜我不能进行条件方法调用......或者我可以吗？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-09-23T17:44:08.713

在这种情况下，将三元运算符视为一种方法。说`a ? b : c`是（对于您正在考虑的意图和目的，请参阅 lasseespeholt 的评论）等同于调用伪代码方法：

```
ternary(a, b, c)
    if a
        return b
    else
        return c 
```

这就是为什么人们可以说这样的话`x = a ? b : c`；基本上就像在说`x = ternary(a, b, c)`。当你说 时`(condition) ? doThis() : doThat()`，你实际上是在说：

```
if condition
    return doThis()
else
    return doThat() 
```

看看如果我们尝试用方法替换它们返回的东西会发生什么

```
 if condition
    return ???
 else
    return ??? 
```

考虑它甚至没有意义。 `doThis()`并且`doThat()`不返回任何内容，因为`void`它不是可实例化的类型，因此该`ternary`方法也无法返回任何内容，因此 Java 不知道如何处理您的声明并抱怨。

有一些方法可以解决这个问题，但它们都是不好的做法（您可以修改您的方法以具有返回值但不对它们返回的内容做任何事情，您可以创建调用您的方法然后返回 null 的新方法等.)。在这种情况下，你最好只使用一个`if`语句。

**编辑** 此外，还有一个更大的问题。即使您正在返回值，Java 也不会`a ? b : c`在任何意义上考虑语句。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-23T18:39:53.367

三元运算符只是**语法糖**。
它使代码更容易读/写，但它没有添加真正的功能。
它的主要用途是将几行代码压缩成一行，并且在根据某些条件构建仅略有不同的字符串时非常有用。

例如。

```
Collection<?> col = ...
System.out.println("There " + (col.size()==1 ? "is" : "are") + " "
     + col.size() + " " + (col.size()==1 ? "element" : "elements")
     + " in the collection"); 
```

代替

```
Collection<?> col = ...
String message = "There ";
if(col.size()==1)
    message += "is";
else
    message += "are";
message += " "+col.size()
if(col.size()==1)
    message += " element";
else
    message += " elements";
message += " in the collection";
System.out.println(message); 
```

如您所见，它简化了代码。
（注意：在第二个示例中，最好使用`StringBuilder`字符串连接而不是字符串连接）

但是因为`(condition) ? doThis() : doThat();`（没有返回值）具有相同的含义，因为`if(condition) doThis(); else doThat();`有两种方法可以编写相同的东西，而无需添加功能。它只会使事情复杂化：

*   对于程序员：代码不统一
*   对于三元运算符的实现：它现在还必须支持`void`方法

* * *

所以**不**，三元运算不能用于条件方法调用。使用 if-else 代替：

```
if(condition)
    doThis();
else
    doThat(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-23T22:07:23.453

三元（条件）运算符返回一个值。如果您的方法不这样做，则它们不能用作运算符的一部分（它获取值的地方）。

为了更好地理解它，让我们考虑一个简单的二元运算符：`+`. 它是这样工作的：

```
<eval1> + <eval2>  -->  <value> 
```

它需要 2 个可评估的部分，并返回另一个。如果你输入

```
doThis() + doThat(); 
```

甚至

```
gimmeAValue = doThis() + doThat(); 
```

它会失败，因为既不`doThis()`也不`doThat()`评估任何东西（他们“返回” `void`）。当然，两者`<eval1>`和都`<eval2>`必须是某种“兼容”类型，以便`+`操作员可以处理它们并返回某种类型的值。

现在让我们看看三元运算符：

```
<evalBoolean> ? <eval1> : <eval2>  -->  <value> 
```

它需要 3 个可评估部分，并返回一个值。

第一个可评估部分必须可以被编译器理解（可转换）为布尔值。它将用于决定必须退回其他 2 个可评估部分中的哪一个。

其他两个可评估的部分必须是……可评估的。对某事。某种类型的。

换句话说：三元条件运算符旨在返回某些内容，而不是代码分支。这样使用：

```
gimmeAValue = testMe() ? returnThis() : returnThat(); 
```

# c - : C 中的运算符

> ID：12554553
> 
> 赞同：1
> 
> 时间：2012-09-23T17:31:38.430
> 
> 标签：c

> **可能重复：**
> ['unsigned temp:3' 是什么意思？](https://stackoverflow.com/questions/2950029/what-does-unsigned-temp3-mean)

“：”运算符在C中是什么意思。下面程序的输出是-1 -1 -3。如何？

```
#include<stdio.h>
struct emp
{
    int a:1;
    int b:2;
    int c:4;
} hey;

int main()
{
    hey.a=1;
    hey.b=3;
    hey.c=13;
    printf("%d",hey.a);
    printf("%d",hey.b);
    printf("%d",hey.c);
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T17:34:03.053

冒号指定字段的位宽。所以 a 有点宽，b 2 位宽，c 4 位宽。

# java - 数据库架构/事务提交

> ID：12554554
> 
> 赞同：0
> 
> 时间：2012-09-23T17:31:42.777
> 
> 标签：java, database, scala

事务提交通常是如何实现的？我的意思是我有一个事务日志（或更多不同页面类型的日志），它们根据一些缓冲区缓存策略（一个简单的 Guava 缓存）保存在 BerkeleyDB 数据库中。在事务提交期间，事务日志被读取并写入数据文件（当前仅允许单个写入事务）。

然而，这些提交是重量级的，因此似乎是一个瓶颈。

我的想法：事务日志首先在提交期间刷新到磁盘（但也保存在内存中），然后事务日志中的记录被一一读取并附加到“正常”数据文件中。之后从事务日志中删除条目。现在我应该能够基于以下事实重播崩溃的事务：如果事务日志仍然存在，则必须首先将剩余条目写入数据文件，然后才能继续进行新的写入事务。

然而，如前所述，除了重做操作不能按预期工作之外，提交本身就是一个瓶颈，因为除了实际的数据页之外，它还必须将 B+-tree 类页面结构的更改路径/页面写入磁盘。

也许人们也可以在线程池中的专用线程中发出提交，即将到来的事务首先检查事务日志中的一个标志，指示事务是否已提交，然后首先尝试从事务日志中读取，然后从数据中读取文件。

对于感兴趣的人：[https ://github.com/JohannesLichtenberger/sirix](https://github.com/JohannesLichtenberger/sirix)

我目前也在寻找其他可能会花一些空闲时间的开源开发人员 ;-)

我还没有找到很多关于如何实现交易系统的文献。请注意，系统支持版本控制，并且仅在提交后附加新版本。

您认为我的第二种方法有效吗？否则什么是“最先进的”？但是，如果实现起来太复杂，我想我首先会优先考虑其他任务。

或者也许提供一个异步提交...... trx.asynchCommit() 用于需要提供非常快速更新并最终允许读取存储修订的应用程序。但是写入可能不是顺序的，因为另一个事务也可以提交，但是好的，它设计用于闪存盘，特别是随机读取仍然发生，但写入通常是顺序的。

# java - Java中的值传递

> ID：12554560
> 
> 赞同：-1
> 
> 时间：2012-09-23T17:32:28.200
> 
> 标签：java

我是 Java 新手，目前正在尝试学习按值传递的工作原理。我有一个名为 Test 的主类和一个名为 TestMax 的第二个类。我在下面的代码中试图实现的是在主类中为类 TestMax 中的 2 个参数 i 和 j 设置值，并`max()`通过传递我之前刚刚传递的参数的值来调用该方法。

控制台的输出应该是这样的：

```
The maximum between 2 and 10 is 10. 
```

我知道我将值传递给方法的方式有问题，`(int res = max(i,j)`但我花了最后 2 小时来弄清楚为什么这不起作用，但我无法弄清楚。

```
package testproject;
public class Test {
    /** Main method */
    public static void main(String[] args) {
        TestMax pass = new TestMax();
        pass.setI(2);
        pass.setJ(10);
        int res = max(i,j);
        System.out.println("The maximum between " + pass.getI() +
                " and " + pass.getJ() + " is " + res);
    }
} 
```

**二等TestMax：**

```
package testproject;

public class TestMax {

    int i ;
    int j ;

public static int max(int num1, int num2) {

    int result;
    if (num1 > num2)
       result = num1;
    else
       result = num2;

    return result;

}

//Getters & Setters
public void setJ(int j) {
    this.j = j;
}

public int getJ() {
    return j;
}

public void setI(int i) {
    this.i = i;
}

public int getI() {
    return i;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-23T17:36:10.567

This has nothing to do with pass-by-value vs pass-by-reference. The problem is this line of code:

```
int res = max(i,j); 
```

The values `i` and `j` are out of scope, and `max()` is not in your current class, so you need to use getters to access the values and reference the method through the class, like so:

```
int res = TestMax.max(pass.getI(), pass.getJ()); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-23T17:35:40.703

这一行：

```
int res = max(i,j); 
```

没有意义：在该范围内既`max`没有`i`也没有`j`声明。你的编译器应该拒绝这个。

你一定是想写：

```
int res = TestMax.max(pass.getI(), pass.getJ()); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-23T18:20:37.243

`int res = max(i,j);`

在上面的行**中，该范围内既没有声明**也没有声明`max()`参数。所以它是一个编译错误。`i and j`

 ****你应该把它写成：**

`int res = TestMax.max(pass.getI(), pass.getJ());`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-23T18:04:14.137

您还可以更改 max 方法，使其不再是静态的，而是使用变量 i 和 j 作为其输入，如下面的代码：

```
 ...

    public int max() {
        int result;
        if (i > j)
           result = i;
        else
           result = j;

        return result;
    }

... 
```

现在您需要在 main 方法中省略以下行中的参数：

```
int res = max(i,j); 
```

更改为：

```
int res = max(); 
```

但是，如果您以这种方式更改 TestMax 类，则需要创建一个扩展 Exception 的类，以便在为 i 和 j 赋值之前有人调用 max() 方法时可以抛出它。避免这种情况的另一种方法是构建一个构造函数并在那里获取 i 和 j。**

# php - 获取所有错误以及错误连接到的字段

> ID：12554562
> 
> 赞同：5
> 
> 时间：2012-09-23T17:32:50.927
> 
> 标签：php, symfony, symfony-2.1

我正在使用 Symfony2 表单来验证对 API 的 POST 和 PUT 请求。表单处理将请求数据绑定到底层实体，然后验证实体。除了收集错误之外，一切都运行良好。我正在使用 FOSRestBundle，如果验证失败，我会抛出一个带有 400 状态代码的 Symfony\Component\HttpKernel\Exception\HttpException 和一条包含表单错误消息的消息。FOSRestBundle 处理将其转换为 JSON 响应。我必须执行所有这些操作的控制器方法如下所示（所有字段将它们的错误冒泡到表单中）：

```
protected function validateEntity(AbstractType $type, $entity, Request $request)
{
    $form = $this->createForm($type, $entity);
    $form->bind($request);
    if (! $form->isValid()) {
        $message = ['Invalid parameters passed.'];
        foreach ($form->getErrors() as $error) {
            $message[] = $error->getMessage();
        }
        throw new HttpException(Codes::HTTP_BAD_REQUEST, implode("\n", $message));
    }
} 
```

我遇到的问题是，当我通过 $form->getErrors() 收集表单级错误时，我只能访问错误消息，而不是错误连接到的字段的名称。当 POST 或 PUT 参数对应于相关实体的 id 时，这是一个特殊问题。如果提交了无效值，则错误消息只是“此值无效”，这在这种情况下不是很好。理想情况下，我想做以下任一项：

*   对于每个错误，获取它所连接的字段名称，以便我可以格式化消息，例如“字段名称：错误消息”
*   如果这不可能，是否可以为无效实体类型自定义错误消息，以便显示比“此值无效”更好的内容？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-07-24T07:57:05.550

对于 symfony >= 2.2

```
private function getErrorMessages(\Symfony\Component\Form\Form $form) {
    $errors = array();
    foreach ($form->getErrors() as $key => $error) {
        $template = $error->getMessageTemplate();
        $parameters = $error->getMessageParameters();

        foreach ($parameters as $var => $value) {
            $template = str_replace($var, $value, $template);
        }

        $errors[$key] = $template;
    }
    if ($form->count()) {
        foreach ($form as $child) {
            if (!$child->isValid()) {
                $errors[$child->getName()] = $this->getErrorMessages($child);
            }
        }
    }
    return $errors;
} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-12-07T12:24:40.830

使用此功能可获取绑定表单后的所有错误消息。

```
private function getErrorMessages(\Symfony\Component\Form\Form $form) {
    $errors = array();
    foreach ($form->getErrors() as $key => $error) {
        $template = $error->getMessageTemplate();
        $parameters = $error->getMessageParameters();

        foreach($parameters as $var => $value){
            $template = str_replace($var, $value, $template);
        }

        $errors[$key] = $template;
    }
    if ($form->hasChildren()) {
        foreach ($form->getChildren() as $child) {
            if (!$child->isValid()) {
                $errors[$child->getName()] = $this->getErrorMessages($child);
            }
        }
    }
    return $errors;
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-09-23T19:55:55.670

您可以以[getErrorsAsString](https://github.com/symfony/symfony/blob/master/src/Symfony/Component/Form/Form.php#L849)方法为例来获得您想要的功能。您还必须在表单字段上设置`invalid_message`选项以更改`This value is invalid`消息。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2018-09-11T18:38:14.437

尝试了一切，没有按我的意愿工作。
这是我对 Symfony 4 的尝试（这也是为什么框架中默认情况下不可用的原因，这超出了我的理解，就像他们不希望我们使用带有 ajax 的表单：thinking :)

它返回一个消息数组，键是 dom id，因为它将由 Symfony 生成（它也适用于数组）

```
//file FormErrorsSerializer.php
<?php

namespace App\Helper;

use Symfony\Component\Form\Form;
use Symfony\Component\Form\FormError;
use Symfony\Component\Form\FormErrorIterator;

class FormErrorsSerializer
{
    public function getFormErrors(Form $form): array
    {
        return $this->recursiveFormErrors($form->getErrors(true, false), [$form->getName()]);
    }

    private function recursiveFormErrors(FormErrorIterator $formErrors, array $prefixes): array
    {
        $errors = [];

        foreach ($formErrors as $formError) {
            if ($formError instanceof FormErrorIterator) {
                $errors = array_merge($errors, $this->recursiveFormErrors($formError, array_merge($prefixes, [$formError->getForm()->getName()])));
            } elseif ($formError instanceof FormError) {
                $errors[implode('_', $prefixes)][] = $formError->getMessage();
            }
        }

        return $errors;
    }
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2019-10-06T11:17:06.327

**对于 Symfony 4.x+（可能适用于较低版本）。**

```
// $form = $this->createForm(SomeType::class);
// $form->submit($data);
// if (!$form->isValid()) {
//     var_dump($this->getErrorsFromForm($form));
// }

private function getErrorsFromForm(FormInterface $form, bool $child = false): array
{
    $errors = [];

    foreach ($form->getErrors() as $error) {
        if ($child) {
            $errors[] = $error->getMessage();
        } else {
            $errors[$error->getOrigin()->getName()][] = $error->getMessage();
        }
    }

    foreach ($form->all() as $childForm) {
        if ($childForm instanceof FormInterface) {
            if ($childErrors = $this->getErrorsFromForm($childForm, true)) {
                $errors[$childForm->getName()] = $childErrors;
            }
        }
    }

    return $errors;
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-06-08T18:30:53.430

我创建了一个包来帮助解决这个问题。

你可以在这里得到它：

[https://github.com/Ex3v/FormErrorsBundle](https://github.com/Ex3v/FormErrorsBundle)

欢迎投稿。干杯。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2017-07-21T16:14:00.587

我需要一个解决方案来获取所有嵌套表单的所有错误的关联数组，其中键格式化，因此它表示相应表单字段元素的文档 ID：

```
namespace Services;

use Symfony\Component\Form\Form;
use Symfony\Component\Form\FormErrorIterator;

/**
 * Class for converting forms.
 */
class FormConverter
{
    /**
     * Gets all errors of a form as an associative array with keys representing the dom id of the form element.
     *
     * @param Form $form
     * @param bool $deep Whether to include errors of child forms as well
     * @return array
     */
    public function errorsToArray(Form $form, $deep = false) {
        return $this->getErrors($form, $deep);
    }

    /**
     * @param Form $form
     * @param bool $deep
     * @param Form|null $parentForm
     * @return array
     */
    private function getErrors(Form $form, $deep = false, Form $parentForm = null) {
        $errors = [];

        if ($deep) {
            foreach ($form as $child) {
                if ($child->isSubmitted() && $child->isValid()) {
                    continue;
                }

                $iterator = $child->getErrors(true, false);

                if (0 === count($iterator)) {
                    continue;
                } elseif ($iterator->hasChildren()) {
                    $childErrors = $this->getErrors($iterator->getChildren()->getForm(), true, $child);
                    foreach ($childErrors as $key => $childError) {
                        $errors[$form->getName() . '_' . $child->getName() . '_' .$key] = $childError;
                    }
                } else {
                    foreach ($iterator as $error) {
                        $errors[$form->getName() . '_' . $child->getName()][] = $error->getMessage();
                    }
                }
            }
        } else {
            $errorMessages = $this->getErrorMessages($form->getErrors(false));
            if (count($errorMessages) > 0) {
                $formName = $parentForm instanceof Form ? $parentForm->getName() . '_' . $form->getName() : $form->getName();
                $errors[$formName] = $errorMessages;
            }
        }

        return $errors;
    }

    /**
     * @param FormErrorIterator $formErrors
     * @return array
     */
    private function getErrorMessages(FormErrorIterator $formErrors) {
        $errorMessages = [];
        foreach ($formErrors as $formError) {
            $errorMessages[] = $formError->getMessage();
        }

        return $errorMessages;
    }
} 
```

# c# - 我无法从 DataSet 中删除 gridView 中的选定行

> ID：12554566
> 
> 赞同：-1
> 
> 时间：2012-09-23T17:33:06.433
> 
> 标签：c#, winforms, gridview, dataset

我的表单中有一个 gridView 和一个按钮，用于删除此 gridView 以及 DataSet 中的选定行。

这是我试过的代码：

```
DataRow row = gridView1.GetDataRow(gridView1.GetSelectedRows()[0]);

for (int i = 0; i < connexion.ds.Tables["Auteur"].Rows.Count; i++)
    if (row[0].ToString() == connexion.ds.Tables["Auteur"].Rows[i][0].ToString())
        connexion.ds.Tables["Auteur"].Rows[i].Delete();

for (int i = 0; i < connexion.ds.Tables["AuteurGV"].Rows.Count; i++)
    if (row[0].ToString() == connexion.ds.Tables["AuteurGV"].Rows[i][0].ToString())
        connexion.ds.Tables["AuteurGV"].Rows[i].Delete();

SqlCommandBuilder cmb = new SqlCommandBuilder(da);
da.Update(connexion.ds, "Auteur");

gridControl1.DataSource = connexion.ds.Tables["AuteurGV"]; 
```

但它在第 6 行给了我一个错误：

> *无法通过该行访问已删除的行信息。*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T17:38:11.600

改成

```
DataRow row = gridView1.GetDataRow(gridView1.GetSelectedRows()[0]); 

string valToDelete = row[0].ToString();

for (int i = 0; i < connexion.ds.Tables["Auteur"].Rows.Count; i++) 
    if (valToDelete == connexion.ds.Tables["Auteur"].Rows[i][0].ToString()) 
         connexion.ds.Tables["Auteur"].Rows[i].Delete(); 

for (int i = 0; i < connexion.ds.Tables["AuteurGV"].Rows.Count; i++) 
    if (valToDelete == connexion.ds.Tables["AuteurGV"].Rows[i][0].ToString()) 
         connexion.ds.Tables["AuteurGV"].Rows[i].Delete(); 

SqlCommandBuilder cmb = new SqlCommandBuilder(da); 
da.Update(connexion.ds); 
gridControl1.DataSource = connexion.ds.Tables["AuteurGV"]; 
```

问题出在第二个 for 循环中，您已经删除了从中提取键值以用于比较的行。这是不可能的，因为当 RowState 属性更改为 Delete 时，您不能使用该行中的任何值。
我还更改了 da.Update 调用以更新所有数据集，而不仅仅是 Auteur 表。

# cocoa - 如何在自定义视图中创建超链接...？

> ID：12554568
> 
> 赞同：0
> 
> 时间：2012-09-23T17:33:27.960
> 
> 标签：cocoa, nsview

如何在自定义视图中创建超链接.. 我创建了包含三个超链接的 nsview，但在我的情况下，它将调用方法而不是任何 weblink

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-25T15:43:28.983

子类 NSTextField。

通过将其 backgroundColor 属性设置为 NSColor.clearColor 来使其背景透明。

使用 Tracking Area 监视鼠标何时悬停在其上，以便您可以更改其颜色：

```
NSTrackingArea* pTrackingArea= [[NSTrackingArea alloc] initWithRect:self.bounds options:NSTrackingActiveAlways | NSTrackingMouseMoved | NSTrackingMouseEnteredAndExited owner:self userInfo:nil];
[self addTrackingArea:pTrackingArea]; 
```

跟踪区域为您调用某些鼠标操作方法。在这种情况下：

```
-(void)mouseEntered:(NSEvent *)theEvent
-(void)mouseExited:(NSEvent *)theEvent 
```

在这些中设置 NSTextField 子类的 textColor 属性。

要确定用户何时单击，请使用：

```
-(void)mouseUp:(NSEvent *)theEvent 
```

并从中调用您想要的任何方法。

# java - Java JVM中的指令重新排序

> ID：12554570
> 
> 赞同：33
> 
> 时间：2012-09-23T17:33:35.203
> 
> 标签：java, concurrency

我正在阅读[这篇](http://jeremymanson.blogspot.hk/2008/12/benign-data-races-in-java.html)博文。

而作者正在谈论`hashCode()`在`String`多线程环境中闯入。

有了：

```
public int hashCode() {
     int h = hash;
     if (h == 0) {
         int off = offset;
         char val[] = value;
         int len = count;

         for (int i = 0; i < len; i++) {
             h = 31*h + val[off++];
         }
         hash = h;
     }
     return h;
 } 
```

变成：

```
public int hashCode() {
     if (hash == 0) {
         int off = offset;
         char val[] = value;
         int len = count;

         int h = 0;
         for (int i = 0; i < len; i++) {
             h = 31*h + val[off++];
         }
         hash = h;
     }
     return hash;
 } 
```

作者说，我引用：

> “我在这里所做的是添加一个额外的读取：**在 return 之前第二次读取哈希**。听起来很奇怪，而且不太可能发生，第一次读取可以返回正确计算的哈希值， “

所以进一步浏览评论，有人说它可以重新排序

```
int h = hash;
if (hash == 0) {
  ...
}
return h; 
```

这怎么可能？我认为重新排序只涉及上下移动程序语句。它遵循什么规则？我在 Google 上搜索过，阅读了 JSR133 常见问题解答，查看了 Java 并发实践一书，但我似乎找不到一个可以帮助我理解特别是重新排序的地方。如果有人能指出我正确的方向，我将不胜感激。

**感谢 Louis 阐明了“重新排序”的含义，我并没有考虑“字节码”**

但是，我仍然不明白为什么允许将 2nd Read 移到前面，这是我将其转换为某种“字节码”格式的天真尝试。

为简化起见，用于计算哈希码的操作表示为`calchash()`. 因此，我将程序表示为：

```
if (hash == 0)  {       
    h = calchash();
    hash = h;
}
return hash; 
```

我尝试以“字节码”形式表达它：

```
R1,R2,R3 are in the operands stack, or the registers
h is in the array of local variables 
```

按节目顺序：

```
if (hash == 0)  {       ---------- R1 = read hash from memory (1st read)
                        ---------- Compare (R1 == 0)
    h = calchash();     ---------- R2 = calchash()
                        ---------- h = R2 (Storing the R2 to local variable h)
    hash = h;           ---------- Hash = h (write to hash)
}
return hash             ---------- R3 = read hash from memory again(2nd read)
                        ---------- return R3 
```

重新排序的转换（我的版本基于评论）：

```
 ---------- R3 = read hash from memory (2nd read) *moved*
if (hash == 0)  {       ---------- R1 = read hash from memory (1st read)
                        ---------- Compare (R1 == 0)
    h = calchash();     ---------- R2 = calchash()
                        ---------- h = R2 (Storing the R2 to local variable h)
    hash = h;           ---------- hash = h (write to hash)
}
return hash             ---------- return R3 
```

**再次查看评论，我发现作者回答了这个问题：**

重新排序的转换（来自博客）

```
r1 = hash;
if (hash == 0) {
  r1 = hash = // calculate hash
}
return r1; 
```

这种情况实际上适用于单线程，但多线程可能会失败。

似乎 JVM 正在根据

```
h = hash and it simplifies the use of R1, R2, R3 to single R1 
```

因此，JVM 所做的不仅仅是重新排序指令，它似乎还减少了正在使用的寄存器数量。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-09-23T17:39:49.323

在您修改的代码中：

```
public int hashCode() {
     if (hash == 0) { // (1)
         int off = offset;
         char val[] = value;
         int len = count;

         int h = 0;
         for (int i = 0; i < len; i++) {
             h = 31*h + val[off++];
         }
         hash = h;
     }
     return hash; // (2)
 } 
```

(1) 和 (2) 可以重新排序：(1) 可以读取非空值，而 (2) 将读取 0。这在 String 类的实际实现中不会发生，因为计算是在局部变量上进行的并且返回值也是那个局部变量，根据定义，它是线程安全的。

问题在于，Java 内存模型无法保证在`hash`没有适当同步的情况下访问共享变量 ( ) - 特别是它不能保证所有执行都将是顺序一致的。`hash`已经不稳定，修改后的代码不会有问题。

ps：我相信那个博客的作者是 JLS 第 17 章（Java 内存模型）的作者之一 - 所以无论如何我都会倾向于相信他 ;-)

* * *

**更新**

在各种编辑/评论之后 - 让我们使用这两种方法更详细地查看字节码（我假设哈希码始终为 1 以保持简单）：

```
public int hashcode_shared() {
    if (hash == 0) { hash = 1; }
    return hash;
}

public int hashcode_local() {
    int h = hash;
    if (h == 0) { hash = h = 1; }
    return h;
} 
```

我机器上的 java 编译器生成以下字节码：

```
public int hashcode_shared();
   0: aload_0                           //read this
   1: getfield      #6                  //read hash (r1)
   4: ifne          12                  //compare r1 with 0
   7: aload_0                           //read this
   8: iconst_1                          //constant 1
   9: putfield      #6                  //put 1 into hash (w1)
  12: aload_0                           //read this
  13: getfield      #6                  //read hash (r2)
  16: ireturn                           //return r2

public int hashcode_local();
   0: aload_0                           //read this
   1: getfield      #6                  //read hash (r1)
   4: istore_1                          //store r1 in local variable h
   5: iload_1                           //read h
   6: ifne          16                  //compare h with 0
   9: aload_0                           //read this
  10: iconst_1                          //constant 1
  11: dup                               //constant again
  12: istore_1                          //store 1 into h
  13: putfield      #6                  //store 1 into hash (w1)
  16: iload_1                           //read h
  17: ireturn                           //return h 
```

在第一个示例中，共享变量有 2 次读取`hash`：r1 和 r2。如上所述，因为没有同步并且变量是共享的，所以 Java 内存模型适用并且允许编译器/JVM 对两次读取重新排序：第 13 行可以插入到第 1 行*之前。

在第二个示例中，`h`由于线程内语义和对非共享变量的程序顺序保证，对局部变量 的所有操作都需要顺序一致。

注意：与往常一样，允许重新排序这一事实并不意味着它将被执行。这实际上不太可能发生在当前的 x86/热点组合上。但它可能发生在其他当前或未来的架构/JVM 上。

* * *

*这是一个捷径，在实践中可能发生的情况是编译器可能会`hashcode_shared`这样重写：

```
public int hashcode_shared() {
    int h = hash;
    if (hash != 0) return h;
    return (hash = 1);
} 
```

代码在单线程环境中是严格等价的（它总是返回与原始方法相同的值），因此允许重新排序。但是在多线程环境中，很明显如果`hash`在前两行之间被另一个线程从 0 更改为 1，这个重新排序的方法会错误地返回 0。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-18T00:21:14.093

用外行的话来说，我认为这个问题与读取（获取）重新排序有关。

每个线程，T1 和 T2，都希望获得所有“输入”来进行处理（并且没有严格的`volatile`标记），他们在如何/何时读取数据方面获得了一些自由。

**坏情况：**

每个线程需要读取（实例）变量**两次**，一次检查，一次检查`if`返回值。假设 T1 选择先`if`读取，T2 选择先`return`读取。

这会产生竞争条件，即在T1更新和 T2 的第二次读取（T2 用来检查条件）**之间**`hash`更改变量（由 T1 ）。所以现在 T2 的测试是假的，它什么也不做，并返回它为实例变量 0 读取的内容（最初）。**`hash``if`**

 ****固定案例：**

每个线程只需要读取**一次**（实例）变量，然后立即将其存储在自己的局部变量中。这可以防止发生重新排序读取问题（因为只有一次读取）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-23T18:29:01.507

我认为要注意的关键是，在得到错误答案（返回 0）的线程中，`if`语句的主体没有被执行——忽略它，可以是任何东西。

错误的读取线程两次读取非易失性字段，但从不写入。所以我们只讨论两次读取的顺序。声称这些不是订购的。在更复杂的情况下，可能存在别名，编译器检查这是否是相同的内存位置并非易事。采取保守路线可能会妨碍优化。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-17T23:05:44.407

首先是*坏*代码：

```
int hash = 0;

public int hashCode() {
     if (hash == 0) {
         int off = offset;
         char val[] = value;
         int len = count;

         int h = 0;
         for (int i = 0; i < len; i++) {
             h = 31*h + val[off++];
         }
         hash = h;
     }
     return hash;
 } 
```

显然，我们可以将其简化为：

```
int hash = 0;

public int hashCode() {
     if (hash == 0) {
         // Assume calculateHash does not return 0 and does not modify hash.
         hash = calculateHash();
     }
     return hash;
 } 
```

现在理论表明，以特定方式与第二个线程交错的一个线程上的重新排序可能会导致零返回。我能想象的唯一场景是：

```
// Pseudocode for thread 1 starts with <1>, thread 2 with <2>. 
// Rn are local registers.
public int hashCode() {
     <2> has not begun
     <1> load r1 with hash (==0) in preparation for return for when hash is != 0
     <2> begins execution - finds hash == 0 and starts the calculation
     <2> modifies hash to contain new value.
     <1> Check hash for zero - it is not so skip the contents of the if
     if (hash == 0) {
         // Assume calculateHash does not return 0 and does not modify hash.
         hash = calculateHash();
         <2> got here but at a time when <1> was up there ^^
     }
     <1> return r1 - supposedly containing a zero.
     return hash;
 } 
```

但是然后 - 对我来说 - 可以用好的代码进行类似的处理：

```
public int hashCode() {
     int h = hash;
     if (h == 0) {
         hash = h = calculateHash();
     }
     return h;
 } 
```

接着

```
public int hashCode() {
     <2> has not begun
     <1> load r1 with hash (==0) in preparation for return for when h is != 0
     <2> begins execution - finds h == 0 and starts the calculation
     <2> modifies hash to contain new value.
     <1> load r2 with hash - from now on r2 is h
     int h = hash;
     <1> Check r2 for zero - it is not so skip the contents of the if
     if (h == 0) {
         hash = h = calculateHash();
     }
     <1> we know that when hash/h are non-zero it doesn't matter where we get our return from - both r1 and r2 must have the same value.
     <1> return r1 - supposedly containing a zero.
     return h;
 } 
```

我不明白为什么一个是真正的可能性而另一个不是。**

# html - 具有更高 z-index 优先级的 div 置于包含 flash 的 div 下

> ID：12554571
> 
> 赞同：0
> 
> 时间：2012-09-23T17:33:41.440
> 
> 标签：html, css

我设计了一个生成一些 DIV 元素的页面，我在 CSS 中定义了 z-index 属性来管理元素的优先级问题是具有更高优先级的 div 总是落后于包含 flash swf 对象的 Div 元素，我能做什么做其他DIV下的make flash元素吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T17:49:57.513

Ad this to the Flash embed code

```
<param name="wmode" value="transparent"> 
```

ALso, ensure that both divs have postioning other than static (relative or absolute), or z-index won't work, but from your previous reply, I think you are doing that.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-23T17:50:05.777

Do the answers supplied by google not suffice?

[http://css-tricks.com/snippets/html/keep-flash-behind-other-elements/](http://css-tricks.com/snippets/html/keep-flash-behind-other-elements/)

# android - 以地区语言/不同语言开发应用程序

> ID：12554576
> 
> 赞同：0
> 
> 时间：2012-09-23T17:34:11.550
> 
> 标签：android

我们如何在 Android 中以区域语言/不同语言开发任何应用程序。我们可以用区域语言给出字符串的值吗？我们在android中使用了任何关键字吗

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T17:40:14.877

`strings.xml`您可以通过使用来存储字符串，并在文件夹中拥有语言的翻译文件来实现本地化`/res/values-(local-code)`。现在，当您在 Java 代码中引用字符串时，android 将自动使用该语言环境文件中的字符串（如果可用）。如果它不可用，则默认为`/res/values/strings.xml`

有关详细信息，请参阅[此](http://developer.android.com/guide/topics/resources/string-resource.html)和[此](http://developer.android.com/guide/topics/resources/localization.html)。

# c# - 实体框架 - 为什么选择导航属性？

> ID：12554577
> 
> 赞同：2
> 
> 时间：2012-09-23T17:34:12.047
> 
> 标签：c#, .net, entity-framework, navigation-properties

我有一个看起来像这样的基本存储库：

```
public class BaseRepository<T> : IBaseRepository<T> where T : class
{
    private DbContext _context;
    private IDbSet<T> _dbSet;

    protected DbContext Context
    {
        get
        {
            if (_context == null)
            {
                EFUnitOfWork currentUnitOfWork = (EFUnitOfWork)UnitOfWork.Current;
                _context = currentUnitOfWork.Context;
            }

            return _context;
        }
    }

    protected IDbSet<T> DbSet
    {
        get
        {
            if (_dbSet == null)
            {
                _dbSet = Context.Set<T>();
            }

            return _dbSet;
        }
    }

    public void Add(T entity)
    {
        DbSet.Add(entity);
    }

    public void Attach(T entity)
    {
        DbSet.Attach(entity);
    }

    public void Delete(T entity)
    {
        DbSet.Remove(entity);
    }

    public void Update(T entity)
    {
        Context.Entry(entity).State = System.Data.EntityState.Modified;
    }             

    public IQueryable<T> Get(string[] includes=null)
    {
        IQueryable<T> set = DbSet;
        if (includes != null)
        {
            foreach (string include in includes)
            {
                set = set.Include(include);
            }
        }
        return set;
    } 
```

1.  `User user = _usersRepository.Get().SingleOrDefault(u => u.Username == "gigi");` 这将返回没有 Roles 属性的用户，这没关系。

2.  `User user = _usersRepository.Get(new string[] { "Roles" }).SingleOrDefault(u => u.Username == "gigi");`这将返回用户和 Roles 属性，这没关系。

3.  `List<User> users = _usersRepository.Get().Where(u => u.Username.StartsWith("gi")).ToList();`

4.  `List<User> users = _usersRepository.Get(new string[] { "Roles" }).Where(u => u.Username.StartsWith("gi")).ToList();`

查询 3 和 4 都返回具有 Roles 属性的用户列表。为什么查询 3 返回角色？

LE：这是调用，我在上下文处理后检查用户集合。

```
 List<User> users = _usersRepository.Get().Where(u => u.Username.StartsWith("gi")).ToList();
            UnitOfWork.Current.Dispose(); 
```

LE2：我分别做了同样的事情：

1.  ```
     List<User> users;
            using (MyEntities ctx = new MyEntities ())
            {
                users= ctx.Users.ToList();
            } 
    ```

2.  ```
     List<User> users;
                using (MyEntities ctx = new MyEntities ())
                {
                    users= ctx.Users.Include("Roles").ToList();
                } 
    ```

在第一种情况下，没有加载角色，在第二种情况下，它们是可以的。

我没有看到我在存储库示例中做错了什么。

LE3：这是工作单元

```
 public class UnitOfWork
    {
        private const string HTTPCONTEXTKEY = "Repository.Key";

        private static IUnitOfWorkFactory _unitOfWorkFactory;
        private static readonly Hashtable _threads = new Hashtable();

        public static IUnitOfWork Current
        {
            get
            {
                IUnitOfWork unitOfWork = GetUnitOfWork();

                if (unitOfWork == null)
                {
                    _unitOfWorkFactory = ObjectFactory.GetInstance<IUnitOfWorkFactory>();
                    unitOfWork = _unitOfWorkFactory.Create();
                    SaveUnitOfWork(unitOfWork);
                }

                return unitOfWork;
            }
        }

        private static IUnitOfWork GetUnitOfWork()
        {
            if (HttpContext.Current != null)
            {
                if (HttpContext.Current.Items.Contains(HTTPCONTEXTKEY))
                {
                    return (IUnitOfWork)HttpContext.Current.Items[HTTPCONTEXTKEY];
                }

                return null;
            }
            else
            {
                Thread thread = Thread.CurrentThread;
                if (string.IsNullOrEmpty(thread.Name))
                {
                    thread.Name = Guid.NewGuid().ToString();
                    return null;
                }
                else
                {
                    lock (_threads.SyncRoot)
                    {
                        return (IUnitOfWork)_threads[Thread.CurrentThread.Name];
                    }
                }
            }
        }

        private static void SaveUnitOfWork(IUnitOfWork unitOfWork)
        {
            if (HttpContext.Current != null)
            {
                HttpContext.Current.Items[HTTPCONTEXTKEY] = unitOfWork;
            }
            else
            {
                lock (_threads.SyncRoot)
                {
                    _threads[Thread.CurrentThread.Name] = unitOfWork;
                }
            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T21:15:59.053

EF 将尝试填充尽可能多的属性。

如果您已将数据库行加载到 DbContext 中，EF 将在 DbContext 的生命周期内记住该行的数据。

然后，当您加载引用该行的任何实体时，EF 将使用或不使用 Include 子句填充该属性。

在您的情况下，您正在加载（一些）查询 2 中的角色表。
当您运行查询 3 时，这些行在没有包含的情况下填充，因为它们已经在 DbContext 中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-23T21:15:51.003

这条线看起来很像单例。

```
EFUnitOfWork currentUnitOfWork = (EFUnitOfWork)UnitOfWork.Current; 
```

如果是这样，并且您使用的是经典的 Singleton 模式，其中使用静态成员来维护实例，那么您就是在玩炸药。你永远不应该让你的数据上下文成为静态的。

原因很多。首先，这意味着您的上下文永远不会被破坏，并且将继续消耗内存以进行更改跟踪，直到您耗尽内存（或工作进程重新启动）。

第二个也是最大的原因是静态在进程的所有线程之间共享，这意味着多个用户将使用相同的上下文，他们很可能会互相踩踏，破坏任何形式的一致性。

EF 数据上下文不是线程安全的，它们也不是并发安全的（它们是两个不同的东西）。

这一行：

```
UnitOfWork.Current.Dispose(); 
```

也很糟糕。你不应该这样调用 dispose ，除非你非常小心。同样，如果您的上下文是静态的，那么您可以在另一个线程正在使用它时处理它。

总而言之，您的真正问题与将数据预加载到缓存中有关，有时则不然。我建议您认真重新考虑如何使用 UnitOfWork。理想情况下，您将使用依赖注入容器来管理上下文生命周期，因此您可以在需要时拥有更一致的上下文状态。

# javascript - JavaScript 是否有“短路”评估？

> ID：12554578
> 
> 赞同：133
> 
> 时间：2012-09-23T17:34:17.213
> 
> 标签：javascript, short-circuiting

我想知道 JavaScript 是否具有像 C# 中的 && 运算符这样的“短路”评估。如果没有，我想知道是否有一种可行的解决方法。

* * *

## 回答 #1

> 赞同：150
> 
> 时间：2012-09-23T17:36:17.600

Yes, JavaScript has "short-circuit" evaluation.

```
if (true == true || foo.foo){
    // Passes, no errors because foo isn't defined.
} 
```

[**Live DEMO**](http://jsfiddle.net/NLvbY/)

```
if (false && foo.foo){
    // Passes, no errors because foo isn't defined.
} 
```

[**Live DEMO**](http://jsfiddle.net/NLvbY/1/)

* * *

## 回答 #2

> 赞同：48
> 
> 时间：2019-05-09T10:23:22.657

这个答案非常详细地介绍了[短路](/questions/tagged/short-circuiting "显示标记为“短路”的问题")在 JavaScript 中的工作原理，包括所有的问题以及运算符优先级等相关主题，*如果您正在寻找一个快速定义并且已经了解短路的工作原理，我会推荐检查其他答案。*

* * *

## 到目前为止，我们（认为我们）知道的：

首先让我们检查一下我们都熟悉的行为，在`if()`块内部，我们`&&`用来检查两件事是否是`true`：

```
if (true && true) {
   console.log('bar');
} 
```

现在，您的第一直觉可能会说：*'是的，很简单，代码执行语句，如果两者`expr1`和`expr2`被评估为`true`'*

嗯，是的，也不是。您在技术上是正确的，这就是您描述的行为，**但这并不是代码的评估方式**，我们需要更深入地研究才能完全理解。

* * *

## `&&`和究竟是如何`||`解释的？：

是时候看看“在[javascript](/questions/tagged/javascript "显示标记为“javascript”的问题")引擎的底层”了。让我们考虑这个实际的例子：

```
function sanitise(x) {
  if (isNaN(x)) {
    return NaN;
  }
  return x;
}

let userinput = 0xFF; // as an example
const res = sanitise(userinput) && userinput + 5

console.log(res);
```

那么结果是`260`..但是为什么呢？为了得到答案，我们需要了解短路评估是如何工作的。

> 根据[MDN 定义](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Logical_Operators) ，`&&`运算符 in`expr1 && expr2`执行如下：
> 
> 如果`expr1`可以转换为`true`，则返回`expr2`；否则，返回`expr1`。

所以这意味着，在我们的实际示例中，`const res`按以下方式评估 ：

1.  调用`expr1`-`sanitise(0xFF)`
2.  `0xFF`是 250 的有效十六进制数，否则我会返回`NaN`
3.  返回一个“`expr1`真实”值，执行时间`expr2` *（否则我会因为`NaN`错误而停止）*
4.  既然`userinput`是真实的（一个数字），我可以添加`+5`它

> *   “真”意味着表达式可以被评估为真。这是一个 [真实](https://developer.mozilla.org/en-US/docs/Glossary/Truthy)和 [虚假](https://developer.mozilla.org/en-US/docs/Glossary/Falsy) 表达的列表。

所以在这里，我们能够通过简单地使用操作符来避免额外的`if`阻塞和进一步的检查。`isNaN``&&`

* * *

## 它是如何工作的：

到现在为止，我们至少应该了解一下[短路](/questions/tagged/short-circuit "显示标记为“短路”的问题")操作符是如何工作的。普遍的规则是：

*   **`(some falsy expression) && expr`将评估为虚假表达式**
*   **`(some truthy expression) || expr`将评估为真实的表达**

以下是一些进一步的示例，以便更好地理解：

```
function a() { console.log('a'); return false; }
function b() { console.log('b'); return true; }

if ( a() && b() ){
     console.log('foobar'); 
}

//Evaluates a() as false, stops execution.
```

```
function a() { console.log('a'); return false; }
function b() { console.log('b'); return true; }

if ( a() || b() ){
     console.log('foobar'); 
}

/* 1\. Evaluates a() as false
   2\. So it should execute expr2, which is `b()`
   3\. b() returned as true, executing statement `console.log('foobar');`
*/
```

* * *

## 最后一件令人讨厌但非常重要的事情[运算符优先级]：

很好，希望你能掌握它！我们需要知道的最后一件事是关于运算符优先级的规则，即：

*   **运算符总是在运算符`&&`之前执行`||`。**

考虑以下示例：

```
function a() { console.log('a'); return true;}
function b() { console.log('b'); return false;}
function c() { console.log('c'); return false;}

console.log(a() || b() && c());

// returns a() and stops execution
```

这将返回 as ，可能会让一些人感到困惑 as `a()`。原因很简单，只是我们的视力有点欺骗我们，因为我们习惯于从左到右阅读。让我们把`console.log()`重点放在评估上

```
true || false && false 
```

现在来解决这个问题：

1.  我们说`&&`运算符具有优先级，因此它首先被评估。为了帮助我们更好地想象评估，想想定义

    ```
    expr1 && expr2 
    ```

    在哪里：

    *   `expr2`是`false`
    *   `expr1`是`true || false`
2.  所以这是棘手的部分，现在`true || false`被评估（`expr1`- 的左侧`&&`）。

    *   如果in评估为真，则`||`运算符停止执行，则执行并且代码执行停止。`expr1 || expr2``expr1``expr1`
3.  返回值为`true`

嗯.. 这很棘手，都是因为很少有奇怪的规则和语义。但是请记住，您总是可以使用`()`-来逃避运算符优先级，*就像在数学中一样*

```
function a() { console.log('a'); return true;}
function b() { console.log('b'); return false;}
function c() { console.log('c'); return false;}

console.log((a() || b()) && c());

/* 1\. The () escape && operator precedence
   2\. a() is evaluated as false, so expr2 (c()) to be executed
   3\. c()  
*/
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-11-09T12:19:07.137

思路是从左到右读取逻辑表达式，如果左边条件的值足够得到总值，右边的条件就不会被处理和评估。一些非常简单的例子：

```
function test() {
    const caseNumber = document.querySelector('#sel').value;
    const userChoice = () => confirm('Press OK or Cancel');
    if (caseNumber === '1') {
        console.log (1 === 1 || userChoice());
    } else if (caseNumber === '2') {
        console.log (1 === 2 && userChoice());
    } else if (caseNumber === '3') {
        console.log (1 === 2 || userChoice());
    } else if (caseNumber === '4') {
        console.log (1 === 1 && userChoice());
    } else if (caseNumber === '5') {
        console.log (userChoice() || 1 === 1);
    } else if (caseNumber === '6') {
        console.log (userChoice() && 1 === 2);
    }
}
```

```
<label for="sel">Select a number of a test case and press "RUN!":</label>
<br><select id="sel">
  <option value="">Unselected</option>
  <option value="1">Case 1</option>
  <option value="2">Case 2</option>
  <option value="3">Case 3</option>
  <option value="4">Case 4</option>
  <option value="5">Case 5</option>
  <option value="6">Case 6</option>
</select>
<button onclick="test()">RUN!</button>
```

上面的前两种情况将分别打印到控制台结果`true`和`false`您甚至不会看到要求您按“确定”或“取消”的模式窗口，因为左侧条件足以定义总结果。相反，在案例 3-6 中，您将看到模态窗口询问您的选择，因为前两个取决于正确的部分（即您的选择），而后两个 - 不管聚合的事实如何这些表达式的值不取决于您的选择——因为首先读取左条件。因此，重要的是根据您希望首先处理的条件从左到右放置条件。

# sql - 无法在 Rails 中加入自联接表

> ID：12554579
> 
> 赞同：0
> 
> 时间：2012-09-23T17:34:30.023
> 
> 标签：sql, ruby-on-rails, ruby, activerecord, join

我有 2 个模型

```
class Category < ActiveRecord::Base
  belongs_to :parent, :class_name => "Category"
  has_many :children,  :class_name => "Category", :foreign_key => "parent_id"
  has_many :products
  attr_accessible :description, :title, :parent

end

class Product < ActiveRecord::Base
  belongs_to :category
end 
```

特别是，Category 有一个名为“tea”的父项，该项有许多子项：“红茶”、“白茶”......

我需要选择属于**父**类别“茶”的产品。这是我的做法：

```
Product.joins(:category=>:parent).where(:category=>{:parent=>{:id=>1}}).all 
```

它抛出一个异常（无法很好地格式化它）

```
Product Load (0.8ms)  SELECT `products`.* FROM `products` INNER JOIN `categories` ON `categories`.`id` = `products`.`category_id` INNER JOIN `categories` `parents_categories` ON `parents_categories`.`id` = `categories`.`parent_id` WHERE `parent`.`id` = 1

ActiveRecord::StatementInvalid: Mysql2::Error: Unknown column 'parent.id' in 'where clause': SELECT `products`.* FROM `products` INNER JOIN `categories` ON `categories`.`id` = `products`.`category_id` INNER JOIN `categories` `parents_categories` ON `parents_categories`.`id` = `categories`.`parent_id` WHERE `parent`.`id` = 1 
```

因为未知的 parent.id 列。

显然，查询应该是（它工作完美）：

```
 SELECT `products`.* FROM `products` 
    INNER JOIN `categories` ON `categories`.`id` = `products`.`category_id` 
INNER JOIN `categories` as `parents_categories` ON `parents_categories`.`id` = `categories`.`parent_id` WHERE `parents_categories`.`id` = 1 
```

我什至试过

```
Product.joins(:category=>:parent).where(:category.parent=>{:id=>1}).all 
```

它没有帮助

请，你的想法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T17:54:18.147

While the operation of `joins()` here is pretty smart, the `where()` part isn't so clever. AFAIK it doesn't know anything about the joins and really just converts its arguments to strings. As such, try this:

```
Product.joins(:category=>:parent).where(:parents_categories=>{:id=>1}) 
```

In order to avoid bleeding the name used internally by AR to your code, consider using AREL for your query. There have been some excellent railscasts on that subject recently.

# symfony - Symfony2 不同捆绑包中的不同配置？

> ID：12554580
> 
> 赞同：0
> 
> 时间：2012-09-23T17:34:39.270
> 
> 标签：symfony, symfony-2.1

我在`config.yml`Swiftmailer 中有这个配置：

```
swiftmailer:
    transport: gmail
    username: xxx@gmail.com
    password: xxx
    delivery_address: xxx@gmail.com
    spool:
        type: file
        path: %kernel.cache_dir%/swiftmailer/spool
    antiflood:
        threshold:            99
        sleep:                0 
```

但是我需要对一个捆绑包进行一种配置，对另一个捆绑包进行另一种配置。

我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T21:12:46.223

嗯...您实际上可以在您的捆绑包中获取邮件服务并以您需要的方式配置它们。只需获取传输实例，配置其处理程序并`mailer`在其中配置注入创建新实例`transport`：

```
 $transport = $this->get('swiftmailer.transport');
    $transport->setHost('smtp.gmail.com');
    $transport->setEncryption('ssl');

    $handlers = $transport->getExtensionHandlers();

    $handler = $handlers[0];
    $handler->setUsername('');
    $handler->setPassword('');
    $handler->setAuthMode('login');

    $mailer = \Swift_Mailer::newInstance($transport); 
```

假设您要使用`gmail`传输，我在上面设置了一些属性。对此`vendor/symfony/swiftmailer-bundle/Symfony/Bundle/SwiftmailerBundle/DependencyInjection/SwiftmailerExtension.php`运输有简单的检查：

```
 //...
    } elseif ('gmail' === $config['transport']) {
        $config['encryption'] = 'ssl';
        $config['auth_mode'] = 'login';
        $config['host'] = 'smtp.gmail.com';
        $transport = 'smtp';
    } else {
    //... 
```

您可以尝试`spool`通过获取其容器来进行配置（您必须在获取`mailer`服务之前执行此操作）：

```
$this->getContainer()
    ->setParameter('swiftmailer.spool.file.path, '%kernel.cache_dir%/swiftmailer/spool'); 
```

但是默认情况下应该使用这个文件路径。您只需要启用假脱机：

```
$this->getContainer()->setParameter('swiftmailer.spool.enabled', true); 
```

`antiflood`可以用类似的方式配置：

```
$this->getContainer()->setParameter('swiftmailer.plugin.antiflood.threshold', 99);
$this->getContainer()->setParameter('swiftmailer.plugin.antiflood.sleep', 0); 
```

希望能帮助到你

# python - 在 Python 中拆分

> ID：12554586
> 
> 赞同：0
> 
> 时间：2012-09-23T17:35:16.890
> 
> 标签：python, string, split

我有一个关于我正在阅读的字符串以及基于分隔符将其拆分并将其存储在列表中的问题。

我有这个输入 1.2.3.4。在哪里。是分隔符。现在，当我使用拆分时，最后会得到这个字符“”。这个角色是什么？

```
for element in data.split('.'):
    L.append(element)   
    print L  #prints out ["1","2","3","4",""] 
```

我的问题是最后一个数组元素“”是什么？我想摆脱这个元素不仅在这个数组中，而且在字符串数据中。我尝试使用`element.rstrip(element)`但它没有摆脱它。我认为我的大部分困惑来自python中的“”指的是什么。我也尝试过使用`L.remove("")`，但这似乎不起作用。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-23T17:39:10.810

你要求 Python`"1.2.3.4."`在`"."`. 最后一个之后没有任何内容，`.`因此您的列表中有一个空元素。

防止这种情况的最简单方法是在拆分之前将其剥离。

```
L = data.strip(".").split(".") 
```

（当您已经有一个列表时，我不确定您为什么要遍历列表并从中构建另一个列表。）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-23T17:37:32.247

用于`strip()`删除最后一个`.`,`data.strip(".")`会这样做，或者只是`rstrip(".")`，如果您只想删除`.`右侧的 。

```
In [35]: "1.2.3.4.".strip(".")
Out[35]: '1.2.3.4'
In [36]: "1.2.3.4.".strip(".").split(".")
Out[36]: ['1', '2', '3', '4'] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-23T18:32:39.330

正如其他人已经写的那样，您的最后一个结果中没有字符。`""`是空字符串。`split()`将在分隔符的*所有*出现处拆分，并且由于在最后一个分隔符之后没有任何内容，因此您会在结果中得到（什么都没有）。

我建议您编写代码以期望并丢弃空元素，而不是从您的数字中删除尾随点（这需要您知道有*尾随点）：*

```
for element in data.split('.'):
    if element:
        L.append(element) 
```

如果字符串中间有两个分隔符，这也会跳过空元素，如`"1.2..3."`

顺便说一句，您不需要循环。只需分配拆分的结果，或使用列表推导删除空元素：

```
L = data.split('.')                           # all parts: equivalent to your code
L = [ elt for elt in data.split('.') if elt ] # non-empty parts only 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-23T17:37:29.170

你得到是因为尾随点。尝试，在拆分之前：

```
L = L[:-1] 
```

例如：

```
>>> a = "1.2.3.4."
>>> b = a.split('.')
>>> b
['1', '2', '3', '4', '']
>>> b = a[:-1]
>>> b.split('.')
['1', '2', '3', '4'] 
```

# rdf - Dbpedia 上的“DESCRIBE”SPARQL 查询

> ID：12554587
> 
> 赞同：2
> 
> 时间：2012-09-23T17:35:23.970
> 
> 标签：rdf, sparql, dbpedia

我想使用“DESCRIBE”查询将 dbpedia 数据提取到 RDF。

例如，如果我输入：

```
PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
PREFIX db: <http://dbpedia.org/ontology/> 
PREFIX prop: <http://dbpedia.org/property/>
DESCRIBE ?movie ?author ?genre
WHERE { 
?movie rdf:type db:Film ;
prop:author ?author ;
prop:genre ?genre .
}
LIMIT 50
OFFSET 0 
```

一切正常。

但是，如果我添加演员和持续时间属性：

```
PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
PREFIX db: <http://dbpedia.org/ontology/> 
PREFIX prop: <http://dbpedia.org/property/>
DESCRIBE ?movie ?author ?genre ?actor ?duration
WHERE { 
?movie rdf:type db:Film ;
prop:author ?author ;
prop:genre ?genre;
prop:actor ?actor;
prop:duration ?duration .
}
LIMIT 50
OFFSET 0 
```

我得到空的RDF。

这是电影的架构：http: [//schema.org/Movie](http://schema.org/Movie)

任何人？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T22:52:54.813

我认为这是输入的问题。[假设您正在通过SPARQL Web 界面](http://live.dbpedia.org/sparql)测试 dbpedia ，您可以通过

*   标记`duration`和`genre`作为可选（因此不需要指定）
*   使用`dbpprop:starring`代替`dbpprop:actor`

所以下面的查询

```
DESCRIBE ?movie ?author ?genre ?actor ?duration
WHERE { 
  ?movie a dbpedia-owl:Film ;
    dbpprop:author ?author ;
    dbpprop:starring ?actor .
  OPTIONAL {
   ?movie dbpprop:duration ?duration ;
     dbpprop:genre ?genre
  }
}
LIMIT 5
OFFSET 0 
```

会给你[一些图表](http://live.dbpedia.org/sparql?default-graph-uri=http://dbpedia.org&query=DESCRIBE%20?movie%20?author%20?genre%20?actor%20?duration%0D%0AWHERE%20%7B%20%0D%0A%20%20?movie%20a%20dbpedia-owl%3aFilm%20;%0D%0A%20%20%20%20dbpprop%3aauthor%20?author%20;%0D%0A%20%20%20%20dbpprop%3astarring%20?actor%20.%0D%0A%20%20OPTIONAL%20%7B%0D%0A%20%20%20?movie%20dbpprop%3aduration%20?duration%20;%0D%0A%20%20%20%20%20dbpprop%3agenre%20?genre%0D%0A%20%20%7D%0D%0A%7D%0D%0ALIMIT%205%0D%0AOFFSET%200&should-sponge=&format=text/x-html%2btr&timeout=0&debug=on)。另请注意，我认为您应该引入`http://schema.org/`前缀以使用该电影模式（但它们在 dbpedia 数据集中似乎没有被如此深入地使用）

这是 a而不是的[结果](http://live.dbpedia.org/sparql?default-graph-uri=http%3A%2F%2Fdbpedia.org&query=SELECT+%3Fmovie+%3Fauthor+%3Fgenre+%3Factor+%3Fduration%0D%0AWHERE+%7B+%0D%0A++%3Fmovie+a+dbpedia-owl%3AFilm+%3B%0D%0A++++dbpprop%3Aauthor+%3Fauthor+%3B%0D%0A++++dbpprop%3Astarring+%3Factor+.%0D%0A++OPTIONAL+%7B%0D%0A+++%3Fmovie+dbpprop%3Aduration+%3Fduration+%3B%0D%0A+++++dbpprop%3Agenre+%3Fgenre%0D%0A++%7D%0D%0A%7D%0D%0ALIMIT+50%0D%0AOFFSET+0&should-sponge=&format=text%2Fhtml&timeout=0&debug=on)（为什么你想要结果格式？） - 我认为这是有道理的。`SELECT``DESCRIBE``DESCRIBE`

我想我也发现了一些有趣的东西。如果您查询

```
DESCRIBE dbpparam:starring 
```

您[收到一条有趣的错误消息](http://live.dbpedia.org/sparql?default-graph-uri=http://dbpedia.org&query=%20%20DESCRIBE%20%20%20%20%20%20%20%20dbpedia-owl%3astarring&should-sponge=&format=text/x-html%2btr&timeout=0&debug=on)

> 谓词“http://www.w3.org/2002/07/owl#equivalentProperty”的错误表达式：schema:actors

我认为这就是为什么`schema:actor`（也许`dbpprop:actor`也是）不起作用的原因。索引程序似乎有错误。

# list - 使用scala打印列表功能

> ID：12554608
> 
> 赞同：0
> 
> 时间：2012-09-23T17:37:38.567
> 
> 标签：list, scala, printing, recursion, functional-programming

我有一个问题：我在 scala 中有一个像这样的列表 (List("Entry1", "Entry2", "Entry3")) 并且我想打印这个列表功能。所以我不想使用任何类型的循环。

我知道可以使用某种代码：

```
def test(input:List[_])
input match
{
case //and what now?
case _ => //recursion I guess?

} 
```

我想使用这种方法打印这个列表，每个元素都换行。

有人可以帮我吗？

谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-23T17:38:27.637

标准方法是：

```
val xs = List("Entry1", "Entry2", "Entry3")
xs.foreach(println) 
```

或者，如果你想要它的索引：

```
xs.zipWithIndex.foreach { case (x,i) => println(i + ": " + x) } 
```

但是我从您的问题中得知，这是编写递归函数的练习，因此了解内置方式并不能真正帮助您。

所以，如果你想自己做，递归地，没有内置`foreach`方法，试试这个：

```
@tailrec
def printList[T](list: List[T]) {
  list match {
    case head :: tail =>
      println(head)
      printList(tail)
    case Nil =>
  }
}

printList(List("Entry1", "Entry2", "Entry3")) 
```

更新：关于您对拥有列表索引的评论，试试这个：

```
def printList[T](list: List[T]) {
  @tailrec
  def inner(list: List[T], i: Int) {
    list match {
      case head :: tail =>
        println(i + ": " + head)
        inner(tail, i + 1)
      case Nil =>
    }
  }
  inner(list, 0)
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-23T18:35:19.810

使用列表 API 的另一个解决方案：

```
List("Entry1", "Entry2", "Entry3").zipWithIndex.foreach(t => println(t._2 + ":" + t._1)) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-23T21:14:22.167

`List("LALA", "PEPE", "JOJO").map(println)`

# java - java.rmi.RemoteException：EJB 异常：；嵌套异常是：

> ID：12554610
> 
> 赞同：3
> 
> 时间：2012-09-23T17:37:41.343
> 
> 标签：java, ejb

我正在将信息输入数据库并且遇到一些 EJB 异常。信息的路径来自一个带有动作类的 JSP，它将值插入到远程 EJB 方法中，该方法之间（在该方法内）调用另一个方法来访问休眠，然后调用另一个方法来插入数据库。我已经在外部应用程序上使用了这种方法或插入方式，它工作正常。尽管在尝试将其与企业级应用程序集成时，我遇到了这些问题。它说

`java.lang.NoClassDefFoundError: com/multivision/cis/business/classes/DaoAccessor`

当我的`DaoAccessor`类在我的项目的构建路径中“明确”定义时，指向适当的 jar，以及在我的`Web-INF/lib`文件夹中。我不知道问题是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T19:17:36.163

嗯.. 并非所有应用程序服务器（至少旧版本）都支持 WAR 文件中的 EJB 部署。检查 JSR 220 谈论它的内容。您可能希望单独部署 EJB（EAR 中的 jar）并尝试一下

# c# - 创建 GridView 时“必须在与 DependencyObject 相同的线程上创建 DependencySource”

> ID：12554612
> 
> 赞同：3
> 
> 时间：2012-09-23T17:37:54.817
> 
> 标签：c#, wpf, multithreading, dispatcher

我的线程有问题。当我想将 GridView 设置为 ListView 作为另一个线程中的视图时。它会显示一条消息：

> 必须在与 DependencyObject 相同的线程上创建 DependencySource。

```
 // Create grid view
                GridView grid = new GridView();
                // Add column
                // Name
                grid.Columns.Add((GridViewColumn)myresourcedictionary["gridDirFileName"]);
                // Type
                grid.Columns.Add((GridViewColumn)myresourcedictionary["gridDirFileType"]);
                // Data Modified
                grid.Columns.Add((GridViewColumn)myresourcedictionary["gridDirFileDataModified"]);
                // Size
                grid.Columns.Add((GridViewColumn)myresourcedictionary["gridDirFileSize"]);
// Edit view
            Application.Current.Dispatcher.Invoke(new Action(() => ListViewOp.View = grid)); 
```

我在做什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-23T17:40:23.353

正如错误所说`Dependency Property and its corresponding binding have to be created on same thread`。它不能设置在不同的线程上。将网格的创建也放在 UI 调度程序上。由于您的 ListView `View`DP 是在 UI 线程上创建的，因此它的源属性，即`GridView`也应该在 UI 线程上。

```
Application.Current.Dispatcher.Invoke((Action)(delegate
   {
       GridView grid = new GridView();
       grid.Columns.Add((GridViewColumn)myresourcedictionary["gridDirFileName"]);
       grid.Columns.Add((GridViewColumn)myresourcedictionary["gridDirFileType"]);
       grid.Columns.Add((GridViewColumn)myresourcedictionary["gridDirFileDataModified"]);
       grid.Columns.Add((GridViewColumn)myresourcedictionary["gridDirFileSize"]);
       ListViewOp.View = grid
   })); 
```

# math - 颜色渐变的数学

> ID：12554614
> 
> 赞同：6
> 
> 时间：2012-09-23T17:38:07.590
> 
> 标签：math, colors, gradient

是否有任何数学用于制作（简单）颜色渐变？我正在寻找制作渐变的简单方法。不是特定的语言。只是颜色的数学。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-23T17:41:05.680

一般来说，颜色渐变是一种线性函数，用于从一种颜色缓和到另一种颜色。例如，如果您想产生从红色（100%、0%、0%）到蓝色（0%、0%、100%）的渐变，您可以将每个颜色值从其初始值扫描到其目标值。

![在此处输入图像描述](../Images/c3fcffd35b39db5fe2475d2c613eb8cd.png)

在渐变的中间，颜色值将等于第一种颜色的 50%，加上第二种颜色的 50%。在此示例中，您最终会得到 (50%, 0%, 50%) - 等于紫色。

# c++ - 临时绑定到引用参数的默认参数的生命周期是多少？

> ID：12554619
> 
> 赞同：14
> 
> 时间：2012-09-23T17:38:28.977
> 
> 标签：c++, language-lawyer, lifetime, temporary-objects

我认为引用只会将临时对象的生命周期延长到引用本身的生命周期，但以下代码段的输出似乎是矛盾的：

```
#include <iostream>

struct X{ ~X(){ std::cout << "Goodbye, cruel world!\n"; } };

X const& f(X const& x = X()){
  std::cout << "Inside f()\n";
  return x;
}

void g(X const& x){
  std::cout << "Inside g()\n";
}

int main(){
  g(f());
} 
```

[活生生的例子。](http://liveworkspace.org/code/9d23d2b39382ce671217c3707d9349aa)输出：

```
Inside f()
Inside g()
Goodbye, cruel world! 
```

所以看起来临时在`g()`被调用后被破坏了......什么给了？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-09-23T17:38:28.977

该标准在以下特殊情况下处理此问题`§12.2 [class.temporary]`：

> p4 有两种情况，其中临时对象在与完整表达式结尾不同的点被销毁。[...]
> 
> p5 第二个上下文是当一个引用绑定到一个临时的。引用绑定到的临时对象或作为引用绑定到的子对象的完整对象的临时对象在引用的生命周期内持续存在，但以下情况除外：
> 
> *   临时绑定到函数调用 (5.2.2) 中的引用参数将**持续存在，直到包含 call 的完整表达式完成**。

该标准还对完整表达式及其子表达式的评估与默认参数有一个方便的注释`§1.9 [intro.execution] p11`：

> [*注意：*完整表达式的评估可以包括对在词法上不属于完整表达式的子表达式的评估。例如，评估**默认参数（8.3.6）所涉及的子表达式被认为是在调用函数的表达式中创建的**，而不是在定义默认参数的表达式中创建的。*——尾注*]

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-23T18:16:14.437

有趣，+1。（我并不是要在这里与您的好自我回答竞争）。对任何感兴趣的人来说只是一个旁注。如果您想要类似的效果但允许非常量，您可以使用移动语义：

```
#include <iostream>

struct X{
   ~X(){ std::cout << "Goodbye, cruel world!\n"; }
   X(X && x){  std::cout << "moved "; }
   X(){}
};

X  f(X x = X()){
  std::cout << "Inside f()\n";
  return x;
}

void g(X x){
  std::cout << "Inside g()\n";
}

int main(){
   g(f());
} 
```

给

```
Inside f()
moved Inside g()
Goodbye, cruel world!
Goodbye, cruel world! 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2022-02-19T06:07:34.470

> 所以看起来临时在 g() 被调用后被破坏了。

这是真的，因为临时的生命周期在 f() 被调用后开始，在 g() 退出后结束。那是因为：

> 在函数调用 (5.2.2) 中对引用参数的临时绑定一直存在，直到包含调用的**完整表达式完成为止。**

这里的*完整表达式*`g(f())`不是`f()`因为您的 f() 函数实际上看起来像这样

```
void g(X const& x){
  std::cout << "Inside g()\n";
}

X const& f(X const& x){
  std::cout << "Inside f()\n";
  return x;
}

g(f( X() )); 
```

# iphone - iphone键盘按钮弹出

> ID：12554620
> 
> 赞同：1
> 
> 时间：2012-09-23T17:38:29.660
> 
> 标签：iphone, button, keyboard, popup

我有一个带有 iPhone 应用程序按钮的自定义视图，我将它用作 uitextfield 的输入视图。因此，当我单击按钮时，我希望弹出键，以便用户查看手指下的内容，非常类似于 iOS 中的默认键盘。有人已经问过类似的问题但没有答案，我做了一些研究但找不到任何东西，所以我恭敬地再次问这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T18:19:02.437

您必须通过代码创建您想要的行为，模仿默认的键盘设计。这意味着您必须创建一个方法，在用户触摸您的按钮/键时显示用户手指下的内容，然后创建一个方法，然后在用户释放您的按钮时传递您的键值并删除您的假视图。

```
underFingerImageView = [[UIImageView alloc] initWithImage:[UIImage imageNamed:THE_FAKE_IMAGE]];

// Call this at touchDownEvent
- (void)mimeDefaultKeyboardFirstPart
{
  underFingerImageView.frame = CGRectMake(x, y, width, height);
  [myKeyboard addSubview:underFingerImageView];
}

// call this at touchUpEvent
- (void)mimeDefaultKeyboardSecondPart
{
  [underFingerImageView removeFromSuperview];

  // Do what you want
} 
```

# android - 如何动态设置屏幕方向

> ID：12554623
> 
> 赞同：1
> 
> 时间：2012-09-23T17:39:06.743
> 
> 标签：android, user-interface

我最新的（也是第一个）android 应用程序让用户可以在首选项中选择将屏幕固定为纵向或横向，或者让传感器确定方向。为了对用户的偏好做出反应，我有类似的东西

```
public static void setOrientation(Activity a,int orientation) {

    switch (orientation) {
    case (1): {
        a.setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_SENSOR);
        break;
    }
    case (2): {
        a.setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_PORTRAIT);
        break;
    }
    case (3): {
        a.setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_LANDSCAPE);
        break;
    }
    }   
} 
```

我在 onCreate/onRestart 调用以相应地设置方向。

我现在面临的问题是，当用户从一个活动切换到下一个活动（选择固定方向）时，有时屏幕仍会根据传感器定向一秒钟，然后屏幕会按照请求的方向进行定向. 当用户选择固定方向时，有没有办法完全关闭传感器。我试图添加

```
a.setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_NOSENSOR); 
```

但到目前为止还没有成功。我很确定我监督了一些明显的事情，任何关于如何动态实现方向固定的启示都将受到高度赞赏。

非常感谢

马丁

**编辑：**

我在一个新帖子中重新表述了这个问题：

[android - 活动切换时意外的短暂方向变化](https://stackoverflow.com/questions/12558287/android-unexpected-brief-orientation-change-at-change-of-activity)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T17:52:39.090

Try this...

```
<activity android:name="com.myapp.MyActivity"
          android:label="@string/app_name"
          android:configChanges="orientation|screenSize"
          /> 
```

for more take a look here.....

[http://digitaldumptruck.jotabout.com/?p=897](http://digitaldumptruck.jotabout.com/?p=897)

This may help you.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T17:46:10.730

尝试将此添加到您的清单中：

```
android:configChanges="keyboardHidden|orientation|screenSize"> 
```

这可以防止方向改变`onPause`和`onResume`

# c# - 使用 HtmlAgilityPack 更改文档中 HtmlNode 值的正确方法

> ID：12554630
> 
> 赞同：1
> 
> 时间：2012-09-23T17:40:13.417
> 
> 标签：c#, html, parsing, xpath, html-agility-pack

我想在文档中更改节点的内部 html，但不幸的是以下代码不起作用：

```
HtmlNodeCollection sourceTables = _sourceDoc.DocumentNode.SelectNodes("//table");
sourceTables[0].InnerHtml = "lalala"; 
```

节点的内部 html 正确更改，但**不影响文档 html**。

而且这个方法不起作用，因为找不到节点：

```
_sourceDoc.DocumentNode.ReplaceChild(HtmlNode.CreateNode("<test></test>"), sourceTables[0]); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-25T10:29:54.290

这是库中的一个值得注意的错误 ( [http://htmlagilitypack.codeplex.com/workitem/32959](http://htmlagilitypack.codeplex.com/workitem/32959) )。它最近已被修复，至少在源代码中（它不在 1.4.6 版本中）。您可以获取最新版本并重新编译。

# javascript - 将渲染的输入值放在另一个输入字段中

> ID：12554636
> 
> 赞同：1
> 
> 时间：2012-09-23T17:41:30.797
> 
> 标签：javascript, input, field

我正在尝试将第一个输入字段的渲染值放入第二个输入字段，但我在输出时遇到了一些问题

这是代码：

```
<script>
   function displayNumber(){     
      var card = document.getElementById('credit').value;

      var str = "";
      for(var i=1; i <= card.length-4; i++) {
         str += "*";
      }

      ecard = str + card.substr(card.length-4);
      document.getElementById('out').innerHTML = ecard;
      $("#output").val(ecard);
   }

   window.onload = displayNumber; 
</script>

<form id="myform">
   <input type="text" id="credit"   value="123456789012">
   <br>
   <input type="text" id="output" > 
</form> 

<label id="out"></label> 
```

信用值为 123456789012

应该出现在输入字段“输出”中

```
********9012 
```

这是演示 [JSFIDDLE](http://jsfiddle.net/fdRTR/45/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T17:49:17.680

如果要将值推送到输出，它应该是：

```
document.getElementById('output').value = ecard; 
```

我刚刚更新了你的小提琴，应该可以工作。

在输入标签中，值不是通过做来设置的`<input>value</input>`。相反，值是使用“value”属性设置的，这就是为什么 innerHTML 属性不起作用，但 value 属性会起作用。

在您的 Fiddle 中，您使用的是 No-Library（纯 JS），这意味着您不能使用 jQuery 语法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-23T17:49:49.757

该代码应该可以工作，确保您使用的是 jQuery 库，我怀疑这是因为您同时使用了 javascript vanilla 语法和 jQuery 之一。因此，请确保您包含 jQuery 库以使其正常工作。

如果您不打算使用 jQuery，请替换以下行：

```
$("#output").val(ecard); 
```

对于这个：

```
document.getElementById('output').value = ecard; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-23T17:55:25.280

如果您打算使用 jQuery，则必须等到它加载完毕。而不是像这样使用`window.onload`尝试`$(document).ready()`

```
$(document).ready(function() {

    displayNumber();

}); 
```

如果您打算只`displayNumber`在您的文档上使用，那么执行此操作的速记方法是这样的

```
$(document).ready(displayNumber); 
```

# cakephp - 全局访问变量权限，在我的 CakePHP AppController 中设置

> ID：12554645
> 
> 赞同：0
> 
> 时间：2012-09-23T17:42:46.187
> 
> 标签：cakephp, cakephp-2.0

我在尝试使用我的 CakePHP 2.2.2 应用程序设置全局变量时遇到问题。我在 AppController 中定义了以下内容：

```
 App::uses('Controller', 'Controller');

 class AppController extends Controller {

  function beforeFilter() {

   $MenuTest = "MENU TEST";
   $this->set('Menu', $MenuTest);

  } //End of beforeFilter()
} 
```

这意味着将 $MenuTest 设置为全局变量对吗？所以我应该能够在我想要的任何控制器或视图上访问 $MenuTest 吗？少我错过了什么？

```
App::uses('AppController', 'Controller');

class PagesController extends AppController {

public $name = 'Pages';
public $uses = array();

 public function display() {
    debug( $Menu);
    die();
    $this->render('home');
 }//End of function display()

 function test () {
    echo $Menu;
    echo 'This is testing a new link';
    die();
 }//End of function test()
} 
```

当我加载我的页面时，所有调试给我的都是“空”。当我使用测试功能时再次相同？

请帮忙？我做错了什么？

谢谢，格伦

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-23T17:50:00.350

`Controller::set()` sets a view var, not a class var. If you want a class var inherited by all sub-classes you would do `$this->Menu = 'Some value';` and access with `$this->Menu`.

# delphi - 在 Delphi TEdit 中获取单词的像素坐标

> ID：12554646
> 
> 赞同：3
> 
> 时间：2012-09-23T17:42:52.853
> 
> 标签：delphi

问候互联网的集体奇才。

我试图在 TEdit 中强调特定的单词（实际上是来自 Berg NextSuite 的 TNxEdit - 但它是 TEdit 的派生词）。然而，为了做到这一点，我需要知道所说单词的像素坐标。

如果文本的开头可见，这很容易做到，但是如果文本的开头已经从结尾滚动，我不知道该怎么做。

有没有办法直接确定给定单词的确切坐标？如果做不到这一点，确定哪些文本在编辑中可见，哪些不可见？或者其他一些巧妙的方法。

**Edit1：**涵盖一些当前的答案：

要求是在 TNxGrid 组件的列上实现拼写检查器，这将我限制为 TNxEdit。如果我可以选择我使用的组件，我现在会切换 :(

我可以画线。TNxEdit 有一个画布，只要我能计算出正确的坐标，我就可以很高兴地绘制下划线。

如果编辑文本的开头是可见的，即前面没有滚动，那么我可以使用 TextExtent 确定正确的开始位置和行的长度。

问题出现在文本开头滚动到前面的场景中。无法确定从前面滚动了多少意味着我无法计算出该行的起始位置。如果要突出显示的单词也部分滚动，则行长会成为问题。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-23T18:10:06.857

尝试使用（发送消息）[EM_POSFROMCHAR](http://msdn.microsoft.com/en-us/library/windows/desktop/bb761631%28v=vs.85%29.aspx)来获取文本特定部分的坐标。例如：

```
pPoint: TPoint;
SendMessage(Wnd, EM_POSFROMCHAR, WPARAM(@pPoint), charIndex); 
```

但请记住，下划线很可能需要您对控件进行子类化并实现自定义绘制。所以@GolesTrol 提出的建议是值得的，那就是尝试从已经支持所需功能的现有控件中进行选择。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-23T18:08:41.353

TEdit 是系统 Win32 编辑类的 Delphi 包装器，它不提供任何功能来设置特定单词的下划线属性，TEdit 也没有添加这样的功能。我建议您考虑在 delphi 中使用更强大的类组件，正如 TRichEdit 所说，如果您喜欢面对复杂的任务，请尝试计算给定字体的字符串范围（参见 GetTextExtentExPoint 和类似内容）以获得 x 的开始/结束位置线，（还要考虑Edit的边框添加一些x偏移）并在HDC（TCanvas）上画一条线

# java - 超过一个用户在 HashMap 上操作时出现 ConcurrentModificationException

> ID：12554647
> 
> 赞同：1
> 
> 时间：2012-09-23T17:43:11.210
> 
> 标签：java, multithreading, jsp, hashmap

我有一个`HashMap`存储 ID 和名称对。对于这张地图的每个条目，有条件地，我将把它放在另一个`HashMap`. 最后，我将对第二个地图条目进行一些操作。所有这些代码都写在 JSP 文件中。

对于单用户请求，这工作正常。当多个用户一次尝试访问此文件时，只有一个请求成功并且对其他用户产生相同的结果。

我们可以在日志中看到以下异常：

```
org.apache.jasper.JasperException: java.util.ConcurrentModificationException 
```

地图是这种格式

```
Map<String, String> testmap= new HashMap<String, String>(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T17:46:38.603

来自[java.util.HashMap](http://docs.oracle.com/javase/7/docs/api/java/util/HashMap.html)的java文档：

> 所有此类的“集合视图方法”返回的迭代器都是快速失败的：如果在创建迭代器后的任何时间对映射进行结构修改，除了通过迭代器自己的 remove 方法之外，迭代器将抛出 ConcurrentModificationException . 因此，面对并发修改，迭代器快速而干净地失败，而不是在未来不确定的时间冒任意的、非确定性的行为。

正如已经建议的那样，对您来说最简单的解决方案是同步对`Map`同时迭代/修改的访问。

```
Map map = ... //the map object has to be the same for all users calling your jsp

synchronized(map) {
   //do work
} 
```

**另请参阅** [有关并发的 oracle java 教程](http://docs.oracle.com/javase/tutorial/essential/concurrency/index.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-25T15:20:03.947

如果您的地图将被多个线程同时访问和修改，请尝试使用更好的地图实现来解决您的问题：[ConcurrentHashMap 集合](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/concurrent/ConcurrentHashMap.html)可以为您解决问题。

```
final Map<String,String> map = new ConcurrentHashMap<String,String>(); 
```

如果您不能使用 Java 5：

```
final Map map = Collections.synchronizedMap(new HashMap()); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-23T17:45:38.470

那么不同的请求可能在不同的线程上运行。您必须在通用数据结构测试图上进行同步。

有几种方法可以实现这一点。@Tudor 建议使用锁。那将是一种可能的方式。如果这是一个练习，我建议阅读有关多线程中的一般同步和`synchronized`Java 中的方法的内容。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-23T17:46:03.673

如果在迭代集合时修改集合，无论是从同一个线程还是同时从多个线程发生，都会收到该错误。我怀疑这是第二种情况，因为它发生在多个用户请求中。确保使用锁保护访问（可能每个地图对象一个锁）。

# machine-learning - 梯度下降与 fminunc

> ID：12554656
> 
> 赞同：1
> 
> 时间：2012-09-23T17:44:15.360
> 
> 标签：machine-learning, octave, gradient-descent

当使用完全相同的数据时，我正在尝试运行梯度下降并且无法获得与内置 fminunc 八度音程相同的结果

我的代码是

```
%for 5000 iterations
for iter = 1:5000

%%Calculate the cost and the new gradient
[cost, grad] = costFunction(initial_theta, X, y);

%%Gradient = Old Gradient - (Learning Rate * New Gradient)
initial_theta = initial_theta - (alpha * grad);

end 
```

当给定示例 (X,y) 和参数 (theta) 时，costFunction 计算成本和梯度。

一个内置的 octave 函数 fminunc 也调用 costFunction 并使用相同的数据在更少的迭代中找到更好的答案。

鉴于 octave 使用相同的成本函数，我假设 costFunction 是正确的。

我已经尝试降低学习率，以防我达到局部最小值并增加迭代次数，成本停止下降，所以我认为它似乎找到了最小值，但最终的 theta 仍然有更大的成本并且是没有准确的地方

即使 fminunc 使用更好的 alogoritm，梯度下降最终是否应该通过足够的迭代和更小的学习率找到相同的答案？

或者谁能​​看到我做错了什么？

感谢您的任何帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T20:46:58.383

您的评论是错误的，但算法很好。

在梯度下降中很容易陷入数值问题，那么我建议进行特征归一化。

此外，如果您不确定自己的学习率，请尝试动态调整它。就像是：

```
best_cost = Inf;
best_theta = initial_theta;
alpha = 1;

for iter = 1:500
  [cost, grad] = costFunction(best_theta, X_reg, y);

  if (cost < best_cost)
    best_theta = best_theta - alpha * grad;
    best_cost = cost;
  else
    alpha = alpha * 0.99
  end
end 
```

此外请记住，不同的答案可以给出相同的决策边界。例如对于假设 h(x) = x(0) + theta(1) * x(1) + theta(2) * x(2) 这些答案给出了相同的边界：

```
theta = [5, 10, 10];
theta = [10, 20, 20]; 
```

# python - 在 python 3 中导入 win32com 时遇到问题

> ID：12554661
> 
> 赞同：1
> 
> 时间：2012-09-23T17:45:02.880
> 
> 标签：python, windows, import

我正在运行 64 位 Windows 7 和 64 位 python 3.2。我安装了pywin 32 AMD 64包，可以在IDLE中导入win32com，但在我的程序中不行。这是上下文中的错误：

代码：

```
import random
import time
from win32com.client import constants
import win32com.client
import pythoncom
import webbrowser
import os
import sys
from sys import exit

print('This is was just an add on to the imports...') 
```

错误：

```
Traceback (most recent call last):
  File "C:\Users\comp\Desktop\test.py", line 3, in <module>
    from win32com.client import constants
  File "C:\Python32\lib\site-packages\win32com\__init__.py", line 5, in <module>
    import win32api, sys, os
ImportError: DLL load failed: The specified module could not be found.
 >>> 
```

我真的不知道会缺少什么模块，因为 pywin32*应该*拥有一切。另外，虽然我之前确实有关于win32的问题，但我正在新计算机上做所有事情，尤其是这不起作用。顺便说一句，将我桌面上的所有包和模块放到我的另一台计算机上变得非常乏味。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-25T05:06:40.757

我倾向于更喜欢[Windows 的 Python 的 ActiveState 安装](http://www.activestate.com/activepython/downloads)，它消除了许多粗糙的边缘并捆绑了相关的 Windows 包。它也可能有助于您设置单调乏味。

# windows - 是否可以将两个调试器附加到一个进程？

> ID：12554664
> 
> 赞同：12
> 
> 时间：2012-09-23T17:45:20.180
> 
> 标签：windows, windows-8, microsoft-metro

是否可以将两个调试器附加到一个进程？

最近，我用 HTML5/CSS 开发了一个 Metro Style App，它调用了一个用 C# 编写的窗口运行时组件。我想做的是将两个调试器附加到同一个进程。一个在 JavaScript 中，另一个在 C# 代码中。

我遵循的步骤：

我打开了两个针对相同解决方案的 Visual Studio 实例。

*   我在 JavaScript 代码中放置了一个断点，并通过 VS 实例 1 执行 f5/运行应用程序。
*   但是，当我尝试通过 VS 实例 2 在 C# 窗口运行时组件中附加第二个调试器时，它给了我一个对话框，上面写着“调试器已附加到进程”。

我看过一个 Window Runtime 演示文稿，其中演讲者成功地做了同样的事情。请帮我解决这个问题。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-23T20:09:51.827

那是不可能的。

见[这里](http://blogs.msdn.com/b/jmstall/archive/2004/12/11/279869.aspx)：

> 对于仅托管和仅本机调试，您只能将 1 个调试器附加到进程。
> 
> **为什么？**
> 
> 本机调试器从托管调试器下方窃取调试事件。这会混淆托管调试器并导致其崩溃。本机调试器无法与此处的托管调试器协调。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-27T04:16:22.623

您不需要 2 个调试器来执行此操作。您可以使用相同的调试器来调试两者。只需确保您的解决方案包含两个项目，并将断点放在您需要的地方

# ios - NSMainbundle 到 NSDocumentsDirectory - 复制 PDF

> ID：12554680
> 
> 赞同：0
> 
> 时间：2012-09-23T17:47:12.273
> 
> 标签：ios, xcode, uiwebview, nsdocumentdirectory

我试图将 NSMainBundle 中的现有 pdf 文件复制到 NSDocumentsDirectory 中。该文件稍后会加载到 uiwebview 中。我似乎无法理解为什么它不复制文件。对此有什么帮助吗？

```
 NSFileManager *fileManager = [NSFileManager defaultManager];
NSError *error;
NSArray *paths = NSSearchPathForDirectoriesInDomains( NSDocumentDirectory,
                                                     NSUserDomainMask, YES);
NSString *documentsDirectory = [paths objectAtIndex:0];

NSString *resourceDBFolderPath = [[NSBundle mainBundle] pathForResource:@"document" ofType:@"pdf"];

[fileManager copyItemAtPath:resourceDBFolderPath toPath:documentsDirectory error:&error];

NSArray *path1 = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
NSString *basePath =  [path1 objectAtIndex:0];
NSString *fileLoc = [basePath stringByAppendingString:@"document.pdf"];
NSURL *url = [NSURL fileURLWithPath:fileLoc];
NSURLRequest *request = [NSURLRequest requestWithURL:url];
[webview loadRequest:request]; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T17:54:51.087

您的目标路径必须包含文件名。

从文档：

> dstPath
> 
> 放置 srcPath 副本的路径。此路径必须在其新位置包含文件或目录的名称。此参数不得为 nil。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-23T22:51:24.803

将您的代码源替换为以下内容：

```
NSFileManager *fileManager = [NSFileManager defaultManager];
NSError *error;
NSArray *paths = NSSearchPathForDirectoriesInDomains( NSDocumentDirectory,
                                                     NSUserDomainMask, YES);
NSString *documentsDirectory = [paths objectAtIndex:0];
NSString *documentDirectoryPath = [documentsDirectory stringByAppendingPathComponent:@"document.pdf"];
NSString *resourceDBBundlePath = [[NSBundle mainBundle] pathForResource:@"document" ofType:@"pdf"];

[fileManager copyItemAtPath:resourceDBBundlePath toPath:documentDirectoryPath error:&error]; 
```

正如 FD_ 所提到的，您的目标路径需要包含您的文件名。

# ios5 - 在 iOS 5 中为应用程序创建设置

> ID：12554686
> 
> 赞同：0
> 
> 时间：2012-09-23T17:47:47.653
> 
> 标签：ios5, appsettings

如何将设置添加到应用程序？我以前从未这样做过，我不知道从哪里开始。我想制作一个应用程序，用户可以在其中设置他/她的信息（如时间间隔、性别……）。谷歌叔叔给我的结果可以帮助 iOS 5 的用户而不是开发人员。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T17:49:44.467

关键字是：`Settings.bundle`和`NSUserDefaults`。谷歌上有很多信息。

另外，看看这个很棒的框架：[InAppSettingsKit](http://www.inappsettingskit.com/)。

祝你好运。

# google-maps - 如何在不擦除标记的情况下动态更改谷歌地图的中心？

> ID：12554688
> 
> 赞同：34
> 
> 时间：2012-09-23T17:48:08.903
> 
> 标签：google-maps, google-maps-api-3

最初，我的地图将指向用户的当前位置。我提供了一个选项，他可以从自动完成框中选择一个城市，一旦他从自动完成中选择了新位置，我将获得一个新的（纬度，经度）坐标，我想将地图聚焦到该坐标上。

根据我对 Maps API 的了解，我可以将其视为更改中心（但是，中心仅在加载地图时设置）。我想将此重点放在谷歌地图上用户选择的位置上。有人可以帮我吗。提前致谢。使用谷歌地图 js api v3。

* * *

## 回答 #1

> 赞同：77
> 
> 时间：2012-09-23T18:13:27.167

您可以简单地使用 移动地图`map.setCenter(LatLng)`。此方法不会使用任何其他标记，也不会擦除现有标记。您也可以通过该`panTo(LatLng)`功能移动地图。这两种方法在地图初始化后也可用。

[这是这些方法的文档](https://developers.google.com/maps/documentation/javascript/reference#Map)。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-09-23T18:32:52.840

**jOnes**是对的，你需要使用`setCenter()`

```
function initialize()
{
    var mapDiv = document.getElementById('MapDiv');
    var map;
    var address = "Vilnius, Lithuania";
    var geocoder = new google.maps.Geocoder();
    // Get LatLng information by name
    geocoder.geocode({
        "address": address
        }, function(results, status){
                map = new google.maps.Map(mapDiv, {
                // Center map (but check status of geocoder)
                center: results[0].geometry.location,
                zoom: 8,
                mapTypeId: google.maps.MapTypeId.ROADMAP,
            })
        });
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2018-05-05T08:02:16.883

```
map.setCenter(new google.maps.LatLng(LATITUDE, LONGITUDE)); 
```

或者

```
map.setCenter({lat: LATITUDE, lng: LONGITUDE}); 
```

此返回无值

# octave - 在 Windows 上以 octave 安装 liblinear

> ID：12554689
> 
> 赞同：1
> 
> 时间：2012-09-23T17:48:16.483
> 
> 标签：octave

我正在尝试在 Windows 7 上的 octave 3.6.2 中安装 liblinear 1.91。octave 是一个干净的 mingw 安装，除了 libsvm 3.12 之外没有额外的软件包。请注意通过从 octave 运行 make.m 安装的 libsvm 没有问题。但是，当我对 liblinear 尝试相同的操作时，我得到：

> ../blas.o: 在函数`dscal_': C:\Octave\liblinear-1.91\matlab/../blas/dscal.c:4: multiple definition of`dscal_' ../blas.o:C:\Octave\liblinear-1.91\matlab/../blas/dscal.c:4: 首先在这里定义 ../blas.o:在函数`dscal_': C:\Octave\liblinear-1.91\matlab/../blas/dscal.c:4: multiple definition of`dscal_' ../blas.o:C:\Octave\liblinear-1.91\matlab/../blas/dscal.c:4: 首先定义在这里 ../blas.o: 在函数`dscal_': C:\Octave\liblinear-1.91\matlab/../blas/dscal.c:4: multiple definition of`dscal_' ../ blas.o:C:\Octave\liblinear-1.91\matlab/../blas/dscal.c:4: 首先在这里定义...o:C:\Octave\liblinear-1.91\matlab/../tron。 cpp:35: `TRON::info(char const*, ...)' ...o:C:\Octave\liblinear-1.91\matlab/../tron.cpp:35: first defined here ...o: In function`TRON'的多重定义: C:\Octave\liblinear-1.91\matlab/../tron.cpp:44: `TRON::TRON(function const*, double, int)' ...o:C:\Octave\liblinear-1.91\matlab/../tron.cpp:44: first defined here ...o: In function`~TRON'的多重定义: C:\Octave\liblinear-1.91\matlab/.. /tron.cpp:54: 多重定义`TRON::~TRON()' ...o:C:\Octave\liblinear-1.91\matlab/../tron.cpp:54: first defined here ...o:C:\Octave\liblinear-1.91\matlab/../tron.cpp:161: multiple definition of`TRON::trcg(double, double*, double*, double e*)' ...o:C:\Octave\liblinear-1.91\matlab/../tron.cpp:161：首先在这里定义...o :C:\Octave\liblinear-1.91\matlab/../tron.cpp:57: 多重定义`TRON::tron(double*)' ...o:C:\Octave\liblinear-1.91\matlab/../tron.cpp:57: first defined here ...o:C:\Octave\liblinear-1.91\matlab/../tron.cpp:224: multiple definition of`TRON::norm_inf(int, double*)' ...o:C:\Octave\liblinear-1.91\matlab /../tron.cpp:224: 首先在这里定义 ...o:C:\Octave\liblinear-1.91\matlab/../tron.cpp:234: `TRON::set_print_string(void (*)(char const *))' ...o:C:\Octave\liblinear-1.91\matlab/../tron.cpp:234: first defined here ...o: In function`TRON'的多重定义: C:\Octave\liblinear -1.91\matlab/../tron.cpp:44: 多重定义`TRON::TRON(function const*, double, int)' ...o:C:\Octave\liblinear-1.91\matlab/../tron.cpp:44: first defined here ...o: In function`~TRON': C:\Octave\liblinear-1.91\matlab/../tron.cpp:54: 多重定义`TRON::~TRON()' ...o:C:\Octave\liblinear-1.91\matlab/../tron.cpp:54: first defined here train.o: In function`do_cross_validation': C:\ Octave\liblinear-1.91\matlab/train.c:86：对`cross_validation' train.o: In function`parse_command_line' 的未定义引用：C:\Octave\liblinear-1.91\matlab/train.c:212：对未定义的引用`set_print_string_function' train.o: In function`mexFunction': C:\Octave\liblinear-1.91\matlab/train.c:374: 未定义对`check_parameter' C:\Octave\liblinear-1.91\matlab/train.c:380: undefined reference to`destroy_param' C:\Octave\liblinear-1.91\matlab/train.c:368 的引用：未定义对`destroy_param' C:\Octave\liblinear-1.91\matlab/train.c:357: undefined reference to`destroy_param' C:\ 的引用Octave\liblinear-1.91\matlab/train.c:405: 未定义对`destroy_param' C:\Octave\liblinear-1.91\matlab/train.c:399: undefined reference to`train 的引用'C:\Octave\liblinear-1.91\matlab/train.c:403: 未定义对`free_and_destroy_model' ...o:tron.cpp:(.text+0x166): undefined reference to`dnrm2_' 的引用 ...o:tron.cpp: (.text+0x188): 对`ddot_' ...o:tron.cpp:(.text+0x1da): undefined reference to`ddot_' 的未定义引用 ...o:tron.cpp:(.text+0x209): 对 dnrm2_' 的未定义引用`daxpy_' ...o:tron.cpp:(.text+0x220): undefined reference to`...o:tron.cpp:(.text+0x261): 未定义引用`daxpy_' ...o:tron.cpp:(.text+0x279): undefined reference to`ddot_' ...o:tron.cpp:(.text+0x2c5): 未定义引用`daxpy_' ...o:tron.cpp:(.text+0x2dd): undefined reference to`dnrm2_' ...o:tron.cpp:(.text+0x368): 未定义引用`daxpy_' ...o:tron.cpp:(.text+0x387): undefined reference to`ddot_' ...o :tron.cpp:(.text+0x3aa): 未定义的引用`ddot_' ...o:tron.cpp:(.text+0x3c6): undefined reference to`ddot_' ...o:tron.cpp:(.text+0x440): 未定义引用`daxpy_' ...o:tron.cpp:(.text+0x46e): undefined reference to`daxpy_' ...o:tron.cpp:(.text+0x5df): 未定义引用`dnrm2_' ...o:tron.cpp:(.text+0x754): undefined reference to`daxpy_' ...o:tron .cpp:(.text+0x78f): 对`ddot_' ...o:tron.cpp:(.text+0x7ca): undefined reference to`ddot_' 的未定义引用 ...o:tron.cpp:(.text+0x828): 对`dnrm2_' ...o:tron.cpp:(.text+0xaf2): undefined reference to`dnrm2_' 的未定义引用 ...o:tron.cpp:(.text+0x166 ): 对`dnrm2_' ...o:tron.cpp:(.text+0x188): undefined reference to`ddot_' 的未定义引用 ...o:tron.cpp:(.text+0x1da): 对`ddot_' ...o:tron.cpp:(.text+0x209): undefined reference to`daxpy_' 的未定义引用 ...o:tron.cpp:(.text+0x220): 对 daxpy_' 的未定义引用`dnrm2_' ...o:tron.cpp:(.text+0x261): undefined reference to`。 ..o:tron.cpp:(.text+0x279): 未定义引用`ddot_' ...o:tron.cpp:(.text+0x2c5): undefined reference to`daxpy_' ...o:tron.cpp:(.text+0x2dd): 未定义引用`dnrm2_' ...o:tron.cpp:(.text+0x368): undefined reference to`daxpy_' ...o:tron.cpp: (.text+0x387): 未定义引用`ddot_' ...o:tron.cpp:(.text+0x3aa): undefined reference to`ddot_' ...o:tron.cpp:(.text+0x3c6): 未定义引用`ddot_' ...o:tron.cpp:(.text+0x440): undefined reference to`daxpy_' ...o:tron.cpp:(.text+0x46e): 未定义引用`daxpy_' ...o:tron.cpp:(.text+0x5df): undefined reference to`dnrm2_' ...o:tron.cpp:(.text+0x754): 未定义引用`daxpy_' ...o:tron.cpp:(.text+0x78f): undefined reference to`ddot_' ...o:tron .cpp:(.text+0x7ca): 未定义引用`ddot_' ...o:tron.cpp:(.text+0x828): undefined reference to`dnrm2_' ...o:tron.cpp:(.text+0xaf2): 未定义引用`dnrm2_' collect2: ld returned 1 exit status warning: unable to find mkoctfile in expected location:`C:\Octave\Octave3.6.2_gcc4.6.2\bin\mkoctfile- 3.6.2' 警告：mkoctfile exited with failure status ../blas.o: In function `dscal_': C:\Octave\liblinear-1.91\matlab/../blas/dscal.c:4: multiple definition of`dscal_' ../blas.o:C:\Octave\liblinear-1.91\matlab/../blas/dscal.c:4 : 首先在这里定义 ../blas.o: 在函数`dscal_': C:\Octave\liblinear-1.91\matlab/../blas/dscal.c:4: multiple definition of`dscal_' ../blas.o:C:\Octave\liblinear-1.91\matlab/../blas/dscal.c:4: 在这里首先定义 ../ blas.o：在函数中`dscal_': C:\Octave\liblinear-1.91\matlab/../blas/dscal.c:4: multiple definition of`dscal_' ../blas.o:C:\Octave\liblinear-1.91\matlab/../blas/dscal.c:4: 首先在这里定义 ...o:C:\Octave\liblinear-1.91\matlab/ ../tron.cpp:35: `TRON::info(char const*, ...)' ...o:C:\Octave\liblinear-1.91\matlab/../tron.cpp:35: first defined here ...o: In function`TRON'的多重定义: C:\Octave\liblinear-1.91\matlab/../tron.cpp:44: `TRON::TRON(function const*, double, int)' ...o:C:\Octave\liblinear-1.91\matlab/../tron.cpp:44: first defined here ...o: In function`~TRON'的多重定义: C:\Octave\liblinear-1.91 \matlab/../tron.cpp:54: `TRON::~TRON()' ...o:C:\Octave\liblinear-1.91\matlab/../tron.cpp:54: first defined here ...o:C:\Octave\liblinear-1.91\matlab/../tron.cpp:161: multiple definition of`TRON::trcg(double, double*, double*, double e*)' ...o:C:\Octave\liblinear-1.91\matlab/ 的多重定义。 ./tron.cpp:161: 首先在这里定义 ...o:C:\Octave\liblinear-1.91\matlab/../tron.cpp:57: `TRON::tron(double*)' ...o:C:\Octave\liblinear-1.91\matlab/../tron.cpp:57: first defined here ...o:C:\Octave\liblinear-1.91\matlab/../tron.cpp:224: multiple definition of`TRON::norm_inf(int, double*)' 的多重定义...o:C:\Octave\liblinear-1.91\matlab/../tron.cpp:224: 首先在这里定义 ...o:C:\Octave\liblinear-1.91\matlab/../tron.cpp :234: 多重定义`TRON::set_print_string(void (*)(char const *))' ...o:C:\Octave\liblinear-1.91\matlab/../tron.cpp:234: first defined here ...o: In function`TRON': C:\Octave\liblinear-1.91\matlab/../tron.cpp:44: 多重定义`TRON::TRON(function const*, double, int)' ...o:C:\Octave\liblinear-1.91\matlab/../tron.cpp:44: first defined here ...o: In function`~TRON': C:\Octave\liblinear-1.91\matlab/../tron.cpp:54: do_predict' 的多重定义`TRON::~TRON()' ...o:C:\Octave\liblinear-1.91\matlab/../tron.cpp:54: first defined here predict.o: In function`：C:\Octave\liblinear-1.91\matlab/predict.c:71: 未定义对`get_nr_class' C:\Octave\liblinear-1.91\matlab/predict.c:81: undefined reference to`get_nr_feature 的引用' C:\Octave\liblinear-1.91\matlab/predict.c:147: 未定义对 predict_values 的引用`predict_probability' C:\Octave\liblinear-1.91\matlab/predict.c:155: undefined reference to`' predict.o : 在函数`mexFunction': C:\Octave\liblinear-1.91\matlab/predict.c:288: undefined reference to`free_and_destroy_model' C:\Octave\liblinear-1.91\matlab/predict.c:312: undefined reference to `free_and_destroy_model' C:\Octave\liblinear-1.91\matlab/predict.c:295: undefined reference to`check_probability_model' ...o:tron.cpp:(.text+0x166): undefined reference to `dnrm2_' ...o:tron.cpp:(.text+0x188): undefined reference to`ddot_ ' ...o:tron.cpp:(.text+0x1da): 未定义引用`ddot_' ...o:tron.cpp:(.text+0x209): undefined reference to`daxpy_' ...o:tron.cpp:(.text+0x220): 未定义引用`dnrm2_' ...o:tron.cpp:(.text+0x261): undefined reference to`daxpy_' ...o:tron.cpp:(.text+0x279): 未定义引用`ddot_' ...o:tron.cpp:(.text+0x2c5): undefined reference to`daxpy_' ...o:tron.cpp:(.text+0x2dd): 未定义引用`dnrm2_' ...o:tron.cpp:(.text+0x368): undefined reference to`daxpy_' ...o:tron .cpp:(.text+0x387): 未定义引用`ddot_' ...o:tron.cpp:(.text+0x3aa): undefined reference to`ddot_' ...o:tron.cpp:(.text+0x3c6): 未定义引用`ddot_' ...o:tron.cpp:(.text+0x440): undefined reference to`daxpy_' ...o:tron.cpp:(.text+0x46e ): 对`daxpy_' ...o:tron.cpp:(.text+0x5df): undefined reference to`dnrm2_' 的未定义引用 ...o:tron.cpp:(.text+0x754): 对`daxpy_' ...o:tron.cpp:(.text+0x78f): undefined reference to`ddot_' 的未定义引用 ...o:tron.cpp:(.text+0x7ca): 对 dnrm2_' 的未定义引用`ddot_' ...o:tron.cpp:(.text+0x828): undefined reference to`。 ..o:tron.cpp:(.text+0xaf2): 未定义引用`dnrm2_' ...o:tron.cpp:(.text+0x166): undefined reference to`dnrm2_' ...o:tron.cpp:(.text+0x188): 未定义引用`ddot_' ...o:tron.cpp:(.text+0x1da): undefined reference to`ddot_' ...o:tron.cpp: (.text+0x209): 未定义引用`daxpy_' ...o:tron.cpp:(.text+0x220): undefined reference to`dnrm2_' ...o:tron.cpp:(.text+0x261): 未定义引用`daxpy_' ...o:tron.cpp:(.text+0x279): undefined reference to`ddot_' ...o:tron.cpp:(.text+0x2c5): 未定义引用`daxpy_' ...o:tron.cpp:(.text+0x2dd): undefined reference to`dnrm2_' ...o:tron.cpp:(.text+0x368): 未定义引用`daxpy_' ...o:tron.cpp:(.text+0x387): undefined reference to`ddot_' ...o:tron .cpp:(.text+0x3aa): 未定义引用`ddot_' ...o:tron.cpp:(.text+0x3c6): undefined reference to`ddot_' ...o:tron.cpp:(.text+0x440): 未定义引用`daxpy_' ...o:tron.cpp:(.text+0x46e): undefined reference to`daxpy_' ...o:tron.cpp:(.text+0x5df ): 对`dnrm2_' ...o:tron.cpp:(.text+0x754): undefined reference to`daxpy_' 的未定义引用 ...o:tron.cpp:(.text+0x78f): 对 ddot_' 的未定义引用...o:tron.cpp:(.text+0x828): 对dnrm2_'collect2 的`ddot_' ...o:tron.cpp:(.text+0x7ca): undefined reference to`未定义引用`dnrm2_' ...o:tron.cpp:(.text+0xaf2): undefined reference to`: ld 返回 1 个退出状态警告：无法在预期位置找到 mkoctfile：`C:\Octave\Octave3.6.2_gcc4.6.2\bin\mkoctfile-3.6.2' 警告：mkoctfile 以失败状态退出

请帮忙。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-24T09:17:40.117

从 liblinear-1.91/matlab 文件夹开始，它为我编译：

```
cd ..
mex   -c linear.cpp
mex   -c tron.cpp
cd blas
mex   -c *.c
cd ../matlab
mex libsvmread.c
mex libsvmwrite.c
mex train.c linear_model_matlab.c ../linear.o ../tron.o ../blas/*.o
mex predict.c linear_model_matlab.c ../linear.o ../tron.o ../blas/*.o 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-02-13T19:48:27.737

我在 Visual Studio 2010 中使用 octave 3.6.2。

我首先按照这里的说明让 libsvm 工作： http: [//flyingpies.wordpress.com/2012/11/20/getting-libsvm-to-work-with-octave-on-windows/](http://flyingpies.wordpress.com/2012/11/20/getting-libsvm-to-work-with-octave-on-windows/)

要编译 liblinear，请使用 Visual Studio 环境变量运行 octave（请参阅上面的链接），cd 到 liblinear 目录，然后运行以下命令：

```
mex -c 'linear.cpp' 
mex -c 'tron.cpp' 
cd blas
mex -c 'daxpy.c' 
mex -c 'ddot.c' 
mex -c 'dnrm2.c' 
mex -c 'dscal.c'
cd ..\matlab 
mex -DMX_API_VER=0x07030000 -c linear_model_matlab.c -I..\\ 
mex -DMX_API_VER=0x07030000 train.c -I..\\ '..\tron.o' '..\linear.o' 'linear_model_matlab.o' '..\blas\daxpy.o' '..\blas\ddot.o' '..\blas\dnrm2.o' '..\blas\dscal.o' 
mex -DMX_API_VER=0x07030000 predict.c -I..\\ '..\tron.o' '..\linear.o' 'linear_model_matlab.o' '..\blas\daxpy.o' '..\blas\ddot.o' '..\blas\dnrm2.o' '..\blas\dscal.o' 
mex -DMX_API_VER=0x07030000 libsvmread.c 
mex -DMX_API_VER=0x07030000 libsvmwrite.c 
```

# objective-c - How to make window active or have focus?

> ID：12554693
> 
> 赞同：1
> 
> 时间：2012-09-23T17:49:04.407
> 
> 标签：objective-c, macos, cocoa

I have the following code that creates a borderless overlay:

AppDelegate.m

```
NSRect frame = [[NSScreen mainScreen] frame];

self.overlay  = [[OverlayWindow alloc] initWithContentRect:frame
                                           styleMask:NSBorderlessWindowMask
                                             backing:NSBackingStoreBuffered
                                               defer:NO];

[self.overlay setAcceptsMouseMovedEvents:YES];
[self.overlay setOpaque:NO];
[self.overlay setLevel:CGShieldingWindowLevel()];
[self.overlay setBackgroundColor:[NSColor colorWithDeviceRed:0.0 green:0.0 blue:0.0 alpha:0.75]];

// Create the subview
OverlayView *subview = [[OverlayView alloc] initWithFrame:NSZeroRect];

[[self.overlay contentView] addSubview:subview];
[self.overlay setContentView:subview];

[self.overlay makeFirstResponder:subview];
[self.overlay orderFrontRegardless]; 
```

OverlayWindow.m

```
@implementation OverlayWindow
// need this so that we can accept mouse events in our view
// we want to use NSBorderlessWindowMask for this window, and that prevents us from
// becoming a key window and thus mouse events don't work
- (BOOL)canBecomeKeyWindow
{
  return YES;
}

- (BOOL)canBecomeMainWindow
{
  return YES;
}
@end 
```

OverlayView.m

```
@implementation OverlayView
- (BOOL)acceptsFirstResponder {return YES;}
- (BOOL)resignFirstResponder {
  self.needsDisplay = YES;
  return YES;
}
- (BOOL)becomeFirstResponder {return YES;}
- (BOOL)canBecomeKeyWindow {return YES;}
...

- (void)keyDown:(NSEvent *)theEvent {
    switch (theEvent.keyCode) {
      case 53:
        [[self window] close];
        break;

      default:
        break;
  }
}
@end 
```

And this all works well. The overlay is created, and I can capture keyboard events. However I have to click on the overlay first to give it focus or make it active, even though my app was in focus when I launched the overlay. Any ideas how to create the overlay such that it will be in focus so that the keyboard events will work without having to click on the overlay first?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T22:12:54.193

看起来你的`OverlayWindow`类继承自`NSWindow`.
所以你可以使用该[`makeKeyAndOrderFront:`](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/ApplicationKit/Classes/NSWindow_Class/Reference/Reference.html)方法。

实际上，您正在使用`orderFrontRegardless`. 它会有效地将窗口移到前面，但不会使其成为**关键**窗口。

所以替换：

```
[ self.overlay orderFrontRegardless ]; 
```

经过：

```
[ self.overlay makeKeyAndOrderFront: nil ]; 
```

# c - Does a byte oriented FILE stream contain `char`s or `unsigned char`s?

> ID：12554696
> 
> 赞同：2
> 
> 时间：2012-09-23T17:49:19.693
> 
> 标签：c, stdio

I have read through the C11 standard, section 7.21 where `<stdio.h>` is described. The standard first describes streams as:

7.21.2.2:

> A text stream is an ordered sequence of characters ...

7.21.2.3:

> A binary stream is an ordered sequence of characters ...

Which doesn't specify the type of the stream characters (since this depends on orientation). It later says:

7.21.3.12:

> ... The byte output functions write characters to the stream as if by successive calls to the fputc function.

From `fputc` (7.21.7.3.2):

> The `fputc` function writes the character specified by `c` (converted to an `unsigned char`) to the output stream pointed to by `stream` ...

Which indicates the `int c` argument of `fputc` is converted to an `unsigned char` before being written to the stream. A similar note is given for `fgetc`:

7.21.7.1.2:

> the `fgetc` function obtains that character as an `unsigned char` converted to an `int`

and `ungetc`, `fread` and `fwrite`.

Now this all hints that internally, a byte oriented stream is represented by `unsigned char`s.

However, looking at the internals of the Linux kernel, it seems like files are considered to be streams of `char`. One reason I am saying this is that the [file_operations](https://github.com/torvalds/linux/blob/v3.6-rc6/include/linux/fs.h#L1777) `read` and `write` callbacks get `char __user *` and `const char __user *` respectively.

In the implementation of `glibc`, `FILE` is a `typedef` of `struct _IO_FILE` which is defined in `libio/libio.h`. In this `struct` also, all read and write pointers are `char *`.

In C++, the [`basic_ostream::write`](http://en.cppreference.com/w/cpp/io/basic_ostream/write) function takes `const char *` as input and similarly `basic_istream::read` (but I'm not interested in C++ in this question).

My question is, **do the quotes above imply that FILE streams should be threated as streams of `unsigned char`? If so, why does the `glibc` and the Linux kernel implement them with `char *`? If not, why does the standard insist on converting the characters to `unsigned char`?**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-23T18:11:09.377

这并不重要。标准在某些选定的地方使用 unsigned char，因为它允许在这些地方进行精确的公式化：

*   `fgetc`指定返回一个转换为 int 的无符号字符，以便知道结果是正数或空值，当它是 EOF 时除外（因此 EOF 和有效字符之间不可能混淆，混淆是导致错误的原因之一将 fgetc 的结果直接存储在 char 中，而不事先检查 EOF）。

*   `fputc`指定为采用 int 并将其转换为 unsigned char，因为此转换已明确指定。如果您不小心，不使用 unsigned char 的公式可能会使 UB 像

    ```
    int c = fgetc(stdin);
    if (c != EOF)
        fputc(c, stdout); 
    ```

带符号的字符用于负字符。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-23T17:52:41.833

It doesn't really matter. A `char` is **`CHAR_BIT`** bits long (`limits.h` - usually 8 bits), whether it's signed or not.

Those functions work with `CHAR_BIT` bits chunks, so the sign does not make a difference here, for the writing or reading process.

You may then use signed or unsigned chars, depending on your application logic, by appropriately casting the result. Human representation will be different, depending on the sign, but for the processor, the representation does not change. It's still bytes.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-23T18:02:36.260

您唯一可以直接观察（无需检查来源）的是 API 返回的内容。它背后的任何东西都被黑盒抽象所隐藏，不应该是你关心的问题。

关于您问题的另一部分：标准*必须*注意，存在转换，因为参数/返回值是`int`并且流是字符序列。

# php - How to get the date of every monday in a month for a given year

> ID：12554697
> 
> 赞同：1
> 
> 时间：2012-09-23T17:49:31.680
> 
> 标签：php, date, strtotime

I'm trying to get the date of every Monday in a month. I previously did this for every first Monday and it worked.

```
$date = strtotime("second monday of $month[$i] $year[j]"); 
```

But this didn't work for every monday

```
$date = strtotime("every monday of $month [$i] $year[j]"); 
```

I'm getting the month and year from an array.

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-23T17:52:06.387

Why don't you get first monday, and do a loop adding 7 days to it until it is next year?

```
$first = strtotime("first monday of $year[$j]");
$lastday = mktime(0, 0, 0, 12, 31, $year[$j]);

$day = $first;
do {
    echo date('M d, Y', $day);
    $day += 7 * 86400;

} while ($day < $lastday); 
```

# sphinx4 - Sphinx 4 Integrate language model

> ID：12554699
> 
> 赞同：1
> 
> 时间：2012-09-23T17:49:42.830
> 
> 标签：sphinx4

I am new to Sphinx 4\. I have been reading about Sphinx 4 and have to implement it as a part of the project. I am building upon HelloNGram model. To improve accuracy I wish to include a language model I downloaded from [http://www.keithv.com/software/giga/](http://www.keithv.com/software/giga/) I have downloaded 64k NVP 3 gram.

I see these following files in the zip archive lm_giga_64k_nvp.hdecode.dic lm_giga_64k_nvp.hvite.dic lm_giga_64k_nvp.sphinx.dic lm_giga_64k_nvp.sphinx.filler lm_giga_64k_nvp_3gram.arpa phonelist wlist_giga_64k_nvp wlist_giga_64k_nvp_start_end

I want to integrate it in HelloNGram. How do I go about doing this? Please explain all the steps. I am very new to sphinx 4! Or if there is any other model you would suggest and can instruct as to how to integrate it in my project... Thanks!

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-23T21:50:33.963

步骤 1\. 使用 sphinxbase 中的 sphinx_lm_convert 将 lm_giga_64k_nvp_3gram.arpa 转换为 DMP 格式。

步骤 2\. 在配置文件中将语言模型组件的类型从 SimpleNGramModel 更改为 LargeTrigramModel

步骤 3\. 更新组件属性以加载转换后的 DMP 文件

要了解有关 Sphinx4 的更多信息，请阅读教程

[http://cmusphinx.sourceforge.net/wiki/tutorial](http://cmusphinx.sourceforge.net/wiki/tutorial)

它将帮助您回答您的问题

# javascript - count characters in textarea in specific line

> ID：12554701
> 
> 赞同：1
> 
> 时间：2012-09-23T17:49:46.433
> 
> 标签：javascript, jquery, html, textarea

How can i read total characters in specific line ?

i want user only will enter 75 chars in textarea with 5 lines only , means user can only use 5 enters or return, after 5 enter or return he will not be able to enter more chars. so 15 chars in one line.

i can get the current line number with following code, how about calculating total chars in that line onkeypress ?

```
function getLineNumber()
{
    var t = $("#textareaId")[0];
    console.log(t.value.substr(0, t.selectionStart).split("\n").length);
}​ 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-23T18:04:00.630

这是[**jsFiddle**](http://jsfiddle.net/sahil_kapoor/9c5Ag/)，这里是代码：

```
function getLineNumber()
{
    var t = $("#textareaId")[0];
    var lineIndex = t.value.substr(0, t.selectionStart).split("\n").length-1;

    //alert the characters in line
    alert(t.value.substr(0, t.selectionStart).split("\n")[lineIndex].length);
}

$("#textareaId").keypress(function() {
  getLineNumber();
}); 
```

另一种方法是在这个更新的[**jsfiddle1**](http://jsfiddle.net/sahil_kapoor/9c5Ag/1/)

```
function getLineNumber()
{
    var t = $("#textareaId").val().split("\n");
    var lineIndex = (t.length)-1
    alert(t[lineIndex].length);
}

$("#textareaId").keypress(function() {
  getLineNumber();
}); 
```

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T20:47:57.137

也许您可以添加一点 CSS 来解决您的问题？

选项 a：无滚动条，文本区域扩展：

```
textarea {
overflow:auto;
} 
```

选项 b：没有滚动条，文本区域保持不变：

```
textarea {
overflow:hidden;
} 
```

这有帮助吗？

# java - Java整数数组未知大小

> ID：12554712
> 
> 赞同：0
> 
> 时间：2012-09-23T17:51:52.460
> 
> 标签：java, arraylist

我正在寻找解决Java中数组问题的“正确”方法：我需要一个整数数组，而不知道最大值。

当前绕过声明限制的解决方案：

```
private ArrayList<Integer> myArray = new ArrayList<>(); 
```

此解决方案的问题：

```
myArray.get(i); 
```

想要返回一个字符串而不是一个 int，我需要这个 int 来进行进一步的计算......我应该使用 ArrayList 以外的东西还是我错过了其他东西？（我猜是最后一个选项......）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T17:55:41.320

是的，由于您不知道您希望数组容纳多少项目，因此您确实应该使用`ArrayList`. 此外`myArray.get(i)`确实会返回一个`int`，只需尝试

```
ArrayList<Integer> list = new ArrayList<Integer>();
list.add(3);
int a =  myArray.get(0);  // autoboxing
System.out.println(a); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T17:55:30.963

ArrayList 是正确的。它不会返回字符串，而是返回整数。由于自动装箱，您可以自动从中获取一个 int 值。

```
 int x = myArray.get(i); 
```

返回一个 Integer 对象，包含的 int 将传递给您的变量。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-23T17:56:24.277

首先，这在**java6中是错误的**

```
private ArrayList<Integer> myArray = new ArrayList<>(); 
```

应该

```
private ArrayList<Integer> myArray = new ArrayList<Integer>(); 
```

无论如何你都会得到一个编译器错误，所以我认为它是一个错字。如果你这样做，你的代码肯定会返回 Integer

```
myArray.get(i); 
```

# c# - Immediate execution with EF

> ID：12554713
> 
> 赞同：2
> 
> 时间：2012-09-23T17:51:56.837
> 
> 标签：c#, linq, entity-framework, lambda

I have this code that executes a Stored Procedure mapped via EF EDM.

```
meTest<MCTEntities, ObjectResult<retrieveMedia_Result>>(u => u.retrieveMedia(campaign_id: 1), ConnectionResolver.MCT_DB_Connection); 
```

The method:

```
public static TValue meTest<U, TValue>(Func<U, TValue> func, String connection)
            where U : ObjectContext, new()
        {
            using (U entitiesContext = (U)Activator.CreateInstance(typeof(U), new[] { connection }))
            {
                return func(entitiesContext);
            }
    } 
```

The issue is that retrieveMedia returns `ObjectResult<retrieveMedia_Result>` and this is done with deferred execution that results in error: `Calling 'Read' when the data reader is closed is not a valid operation.`

Now, I know that I can call ToList() or ToArray(), but is there any other way to force immediate execution?

**I am not sure that casting `ObjectResult<retrieveMedia_Result>` to `List<retrieveMedia_Result>` is the right thing to do.**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T19:38:38.413

ToList 和 ToArray 都枚举了导致执行查询的集合。AsEnumrable 完成了查询构建（即您不能再向查询添加位），但在枚举集合之前它不会实际执行。

在您的示例中，任何枚举您的集合的操作都将检索数据。例如一个foreach。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T19:58:33.573

当上下文被释放时，您将不得不添加`ToArray()`或`ToList()`防止对结果进行迭代。投射到 a`List<T>`将无济于事：这甚至是不可能的。

如果您之后可以迭代结果，您将冒着再次执行此操作的风险，这会引发异常。

# mongodb - MongoDB 中的“切换”查询

> ID：12554716
> 
> 赞同：5
> 
> 时间：2012-09-23T17:52:24.187
> 
> 标签：mongodb

> **可能重复：**
> [在 MongoDB 中，如何使用原子操作切换一个文档中的布尔字段？](https://stackoverflow.com/questions/9459789/in-mongodb-how-to-toggle-a-boolean-field-in-one-document-with-atomic-operation)

我需要更新一个文档值，“切换”它：

该集合是具有布尔标志“isAdmin”的“评论”。

我将更新给定的评论 ID，如果它是真的，则将 isAdmin 设置为 false，反之亦然。

但是，这不起作用：

```
db.comments.update( { "id": "xxx" }, { $set: { isAdmin: $not isAdmin } } ); 
```

什么是正确的语法？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-09-23T18:03:52.770

您无法引用在这样的更新中找到的文档。您需要进行查询以查找文档，然后在知道值是什么后进行更新。两步流程：

```
var doc = db.comments.findOne({id:"xxx"});
db.comments.update({id:"xxx"}, {$set: {isAdmin: !doc.isAdmin}}); 
```

更新：这个答案已经过时了一段时间（从 2.5.2 开始）： [https](https://jira.mongodb.org/browse/SERVER-4362) ://jira.mongodb.org/browse/SERVER-4362 现在可以通过`$bit`operator`xor`和使用`findOneAndUpdate`来避免两个单独的命令。

# c# - Attributes and XML Documentation for method/property

> ID：12554721
> 
> 赞同：35
> 
> 时间：2012-09-23T17:52:46.443
> 
> 标签：c#, wpf, syntax

When I want to have an attribute and XML documentation for a method/property - what is the correct order to write them above the method/property?

This sounds so trivial, but...

If I use:

```
/// <summary>
/// Something here
/// </summary>
[MyAttribute]
public void MyMethod() {} 
```

Build is successful and ReSharper is "happy", but I don't see the documentation in IntelliSense for `MyClass.MyMethod`.

When I use:

```
[MyAttribute]
/// <summary>
/// Something here
/// </summary>
public void MyMethod() {} 
```

Build is successful but ReSharper has a warning (*XML comment is not placed on a valid language element*), and I still don't see the documentation in IntelliSense for `MyClass.MyMethod`.

I've searched the internet and see only examples where attributes are used without documentation; or documentation without attributes.

Is there really no way to have attributes and XML documentation for the same method/property?

Info: WPF application, .NET 4.0, C#.

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-09-23T18:04:49.810

使用第一种情况，

```
/// <summary>
/// Something here
/// </summary>
[MyAttribute]
public void MyMethod() {} 
```

Resharper 喜欢它，它应该在 Intellisense 中为您提供*一些东西。*如果没有，那么还有另一个问题需要解决。

# android - Add Buttons to a RelativeLayout that's inside a ScrollView - NullPointerException

> ID：12554722
> 
> 赞同：0
> 
> 时间：2012-09-23T17:52:50.313
> 
> 标签：android, xml, android-relativelayout

After reading some similiar problem here, I'm still forced to post my question here.

I have an Activity that should add and show a certain amount of Buttons relative to an amount of games in my SQLite-database. This Activity must be scrollable.

So i have my basic layout-xml-file like this:

```
<?xml version="1.0" encoding="utf-8"?>
<ScrollView xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:paddingTop="5dp"
    android:paddingBottom="5dp"
    android:paddingLeft="15dp"
    android:paddingRight="15dp" >
    <RelativeLayout 
        android:id="@+id/rel_all_football" 
        android:orientation="vertical"
        android:layout_width="fill_parent" 
        android:layout_height="wrap_content"        
        >

        <TextView 
            style="@style/TextHeader"
            android:id="@+id/tv_all_football_header"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:text="@string/all_games"
            />
        <View   
            android:id="@+id/v_cond_line1"
            android:layout_below="@+id/tv_all_football_header"
            android:layout_height="1dp"
            android:layout_width="fill_parent"
            android:layout_marginBottom="10dp"
            android:background="#FFFFFF"
            />
    </RelativeLayout>

</ScrollView> 
```

Now for every entry in the database, I want to add a `Button` with the certain information in that `RelativeLayout` under the `TextView` (header) and the `View` (simple line).

So after reading some questions here, I tried something like this:

```
RelativeLayout layout = (RelativeLayout) findViewById(R.id.rel_all_football);

        LayoutInflater inflater = (LayoutInflater) this.getSystemService(Context.LAYOUT_INFLATER_SERVICE);

        Button button;
        for(int i=0; i<3; i++){
            button = new Button(this);
            button.setLayoutParams(
                    new LayoutParams(ViewGroup.LayoutParams.FILL_PARENT, 
                                     ViewGroup.LayoutParams.WRAP_CONTENT));
            button.setText("Hello " + i);

            layout.addView(button);
        } 
```

This is causing a `NullPointerException` at `layout.addView(button)`. To tell the truth, it's the first time I'm trying to add content from code and not directly in xml, so I have no clue if I'm doing this right. I know that a `View` must have at least the attributes `layout_width` and `layout_height` declared, so what is wrong here? Am I inflating wrong? Or do I find the error in the creation of the `Button`?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T17:59:50.053

我认为您在使用 id's sot 时遇到了一些问题试试这个

```
ScrollView scrollView = (ScrollView)getLayoutInflater().inflat(R.layout.filename)
        RelativeLayout layout = (RelativeLayout) scrollView.findViewById(R.id.rel_all_football);
        Button button;
        for(int i=0; i<3; i++){
            button = new Button(this);
            button.setLayoutParams( new LayoutParams(ViewGroup.LayoutParams.FILL_PARENT, ViewGroup.LayoutParams.WRAP_CONTENT));
            button.setText("Hello " + i);

            layout.addView(button);
        }

    setContentView(scrollView); 
```

# javascript - Zynga Scroller "Completed" Method?

> ID：12554724
> 
> 赞同：1
> 
> 时间：2012-09-23T17:53:22.460
> 
> 标签：javascript, html, scroller

I'm using Zynga Scroller ( [https://github.com/zynga/scroller](https://github.com/zynga/scroller)) to scroll a list and snap to middle. I need something to hook onto when the scrolling is complete to show an article based on that list item. My question is there a way to use "completed" (which is in the core)?

# django - Azure SDK + Django + Visual Studio 2012 - Publish to Azure succeeds, but I get 500 error

> ID：12554725
> 
> 赞同：1
> 
> 时间：2012-09-23T17:53:31.397
> 
> 标签：django, azure, python-2.7, visual-studio-2012

I followed the instructions here:
[https://www.windowsazure.com/en-us/develop/python/tutorials/django-with-visual-studio/](https://www.windowsazure.com/en-us/develop/python/tutorials/django-with-visual-studio/)

However, whenever I try to open the url to my web app in the cloud I get a 500 error.

The tutorial doesn't mention setting up the TEMPLATE_DIRS setting in the django application or doing any work on the cloud service machine to install python/django. Could these be the problem?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-25T15:36:15.310

这里的简单错误。我在本地安装了一个由 django 项目导入的 python 模块。此模块未作为自动部署到 Azure 的一部分添加。

修复是为 Azure 机器启用远程桌面，并安装 python 模块。

最有用的调试工具是我远程进入Azure机器后通过本地IP访问网站。该站点的链接位于 IIS 站点设置中。这冒泡了 python 错误而不是通用的 500 错误。

希望这对其他人有帮助！

# java - How can I capture SOAP request and response messages in Java?

> ID：12554730
> 
> 赞同：1
> 
> 时间：2012-09-23T17:54:24.053
> 
> 标签：java, tomcat, soap, axis2

```
SimpleCalculatorStub stub = new SimpleCalculatorStub(null, 
"http://localhost:8080/ControlSOAPMessage/services/SimpleCalculator");

MyAdd reqMyAdd = new MyAdd();
MySub reqMySub = new MySub();
reqMyAdd.setA(4);
reqMyAdd.setB(4);
reqMySub.setA(9);
reqMySub.setB(5);
MyAddResponse resMyAdd = stub.myAdd(reqMyAdd);
MySubResponse resMySub = stub.mySub(reqMySub);
// System.out.println(resMyAdd.get_return()+" :: "+resMySub.get_return());
Integer[] resParams = new Integer[2];
resParams[0]=resMyAdd.get_return();
resParams[1]=resMySub.get_return();
for (int i = 0; i < resParams.length; i++) {
    System.out.println(resParams[i]);
} 
```

I want to capture every request and response of SOAP messages (RAW) coming/going to/from client/server in XML format while interacting with Services.

Please guide me with program coding and where I should place that coding. I have made this service using Eclipse Axis2 plugins. Dynamic Web Project->Web Services (Java, Axis2, Tomcat 6)

I have attached client side program(simple one)

*   Addition and subtraction methods

*   Client accepts two arguments in each method

*   Add or subtract the numbers and provide results

Please guide me.

Many thanks.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T18:00:47.777

使用[Apache 的 TCPMon](http://ws.apache.org/commons/tcpmon/)或者如果你使用 eclipse ee，它集成在其中。只需转到 Window->Show View 并找到 TCP/IP Monitor。这两个作为*代理*工作，您的客户端将连接到 TCPMon，并且您配置 TCPMon 以连接到您的服务器。

您可以使用其他工具将它们放在客户端和服务器之间，以便您可以监控流量（例如 Wireshark）。

# jquery - jQuery 代码按键事件类似于 wallpost '@' 中的 facebook 标记

> ID：12554734
> 
> 赞同：0
> 
> 时间：2012-09-23T17:54:37.030
> 
> 标签：jquery, ajax, tagging

大家好，我实际上是 jquery 和 javascript 的新手，不过我学到了很多东西。当在文本区域输入“@”时，我实际上是在尝试在墙上的帖子中复制用户的 Facebook 标记。更具体地说，当用户输入“@”时，我有一个文本区域，它将激活我拥有的 ajax 功能。我已经能够列出用户了，我现在只需要 jquery 代码来激活 ajax 功能，当用户在文本区域输入'@'时。我会感谢您的所有帮助：D

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>FB TAG</title>
<style>
.namesearch {
    cursor: pointer;
}
</style>
<script src="http://code.jquery.com/jquery-latest.js"></script>
<script type="text/javascript">

function putin_livesearch(fname, lname) 
{

$('#searchbar').val($('#searchbar').val()+fname + " " + lname);

}

function showResult(str)
{
if (str.length==0)
  {
  document.getElementById("livesearch").innerHTML="";
  document.getElementById("livesearch").style.border="0px";
  return;
  } 
if (window.XMLHttpRequest)
  {// code for IE7+, Firefox, Chrome, Opera, Safari
  xmlhttp=new XMLHttpRequest();
  }
else
  {// code for IE6, IE5
  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
  }
xmlhttp.onreadystatechange=function()
  {
  if (xmlhttp.readyState==4 && xmlhttp.status==200)
    {
    document.getElementById("livesearch").innerHTML=xmlhttp.responseText;
    document.getElementById("livesearch").style.border="1px solid #A5ACB2";

    }
  }
xmlhttp.open("GET","getuser.php?q="+str,true);
xmlhttp.send();
}
</script>
</head>

<body>
<form>
  <textarea id ="searchbar" name="wallpost" type="text" rows="3" cols="80"  ></textarea>
  <div id="livesearch"></div>
</form>

</body> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T18:06:14.477

像这样？

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>FB TAG</title>
<style>
.namesearch {
    cursor: pointer;
}
</style>
<script src="http://code.jquery.com/jquery-latest.js"></script>
<script type="text/javascript">
function putin_livesearch(fname, lname) 
{

$('#searchbar').val($('#searchbar').val()+fname + " " + lname);

}

function showResult(str)
{
    if (str.length==0)
    {
        $("#livesearch").empty().css('border', 0);
    } 
    $.get("getuser.php?q="+str, function(txt) {
        $("#livesearch").html(txt).css('border', "1px solid #A5ACB2");;
    });
}
$(function() {
    $('#searchbar').keyup(function() {
        var val = $(this).val();
        if (val.indexOf('@') !== -1) {
            showResult(val);
        }
    });
});
</script>
</head>

<body>
<form>
  <textarea id ="searchbar" name="wallpost" type="text" rows="3" cols="80"  ></textarea>
  <div id="livesearch"></div>
</form>

</body> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-24T12:30:07.270

我能够自己解决它。谢谢“我自己”我爱你

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>FB TAG</title>
<style>
.namesearch {
    cursor: pointer;
}
#searchbar {
    width: 458px;
    height: 50px;
    border: solid 2px #333;
    font-family: Arial, Helvetica, sans-serif;
    font-size: 14px;
    margin-bottom: 6px;
    text-align: left;
}
</style>
<script src="http://code.jquery.com/jquery-latest.js"></script>
<script src="http://api.jquery.com/scripts/events.js"></script>
</head>

<body>
<form>
  <div id="searchbar" contenteditable="true"></div>
  <div id="livesearch"></div>
</form>
<script type="text/javascript">

function showResult(str)
{
if (str.length==0)
  {
  document.getElementById("livesearch").innerHTML="";
  document.getElementById("livesearch").style.border="0px";
  return;
  } 
if (window.XMLHttpRequest)
  {// code for IE7+, Firefox, Chrome, Opera, Safari
  xmlhttp=new XMLHttpRequest();
  }
else
  {// code for IE6, IE5
  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
  }
xmlhttp.onreadystatechange=function()
  {
  if (xmlhttp.readyState==4 && xmlhttp.status==200)
    {
    document.getElementById("livesearch").innerHTML=xmlhttp.responseText;
    document.getElementById("livesearch").style.border="1px solid #A5ACB2";

    }
  }
xmlhttp.open("GET","getuser.php?q="+str,true);
xmlhttp.send();
}

var start=/@/ig; // @ Match
var word=/@(\w+)/ig; //@abc Match

$("#searchbar").live("keyup",function() 
{
var content=$(this).text(); //Content Box Data
var go= content.match(start); //Content Matching @
var name= content.match(word); //Content Matching @abc

var searchname = name.toString().substr(1);

if(name.length>0)
{

alert(name);

$("#livesearch").show();

showResult(searchname);

}

return false();

});

function putin_livesearch(fname, lname) 
{

var old=$("#searchbar").html();
var content=old.replace(word," ");
$("#searchbar").html(content);

$('#searchbar').append("<a href ='#'>"+fname+" " +lname+ "</a>");

$("#livesearch").hide();

}

alert('asdasd');

</script>
</body>
</html> 
```

# django - How to test multiple sites in django project using sites framework/multiple settings

> ID：12554737
> 
> 赞同：0
> 
> 时间：2012-09-23T17:54:58.137
> 
> 标签：django, django-testing

I have a project that shares a database among many wsgi apps (sites framework from contrib is in heavy use). Each wsgi app has it's own module in project dir with it's own settings.py that extend `global_settings.py` in main project dir (each settings file simply imports * from global_settings). Also some sites have their own urls and extra views/templates that cannot be tested globally. All the sites share most apps though. Also due to customisations of views (subclassed cbl views) I need to test each site separately. Django expects `tests.py` only in app dirs so I can't issue:

```
./manage.py test first_site --settings=first_site.settings 
```

since `first_site` is just a python module not a django app. How can I overcome this?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T18:08:13.153

我发现了这个： http: [//pypi.python.org/pypi/django-discover-runner](http://pypi.python.org/pypi/django-discover-runner)

安装 django-discover-runner 后（例如在 pip 中）：

```
pip install -U django-discover-runner 
```

您只需在自定义站点设置中添加一行：

```
TEST_RUNNER = 'discover_runner.DiscoverRunner' 
```

这个命令将从名为的普通 python 模块运行测试`first_site`

```
./manage.py test first_site --settings=first_site.settings 
```

似乎是合法的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-03-31T13:19:06.397

我只是开始多站点测试，现在想出了一个原始的解决方案：

```
from django.test import override_settings

@override_settings(SITE_ID=1)
def test_multisite_one(self):
    from django.contrib.sites.models import Site
    self.assertEqual(1, Site.objects.get_current().id) 
```

# php - Copy BLOB data MySQL PHP

> ID：12554738
> 
> 赞同：-3
> 
> 时间：2012-09-23T17:55:19.963
> 
> 标签：php, mysql, sql

I am currently making an PHP script which is posting auctions for my marketplace. I use Ajax to post the $_POST variables, including: title, description, price, tags and SupportedOSes. The image as a blob in an external table called 'temp_images'.

The way I create the auction is by inserting a new auction into 'MarketDatas'. This is pretty straight forward for the most part. However; when I am trying to insert the BLOB it throws me an error:

> You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax near '?+Qi}'?m?Am............' at line 2

The PHP script for creating auctions looks following:

```
/*
    .... connect to database, etc!! I will spare you this and skip to the important part:
*/

// Get the posted variables
$title = $_POST["title"];
$descr = $_POST["description"];
$price = $_POST["price"];
$tagsx = $_POST["tags"];
$supOS = $_POST["SupportedOS"];

// Get our session variables
$Authenticated = ($_SESSION["LoggedIn"] == "1" ? true : false);
$User = $_SESSION["User"];
$Username = $_SESSION["username"];

// If we are authenticated, continue!
if ($Authenticated) {
    // Get our temporary image
    $ImgResult = mysql_query("SELECT * FROM temp_images WHERE User='$Username'");
    if (mysql_num_rows($ImgResult) < 1) { die("NoImage"); }

    // Get image blob
    $image = mysql_result($ImgResult, 0, 'Image');

    // Delete image
    if (!mysql_query("DELETE FROM temp_images WHERE User='$Username'")) { die("Error deleting temp image from DB"); }

    // Post auction on market
    if (!mysql_query("INSERT INTO MarketDatas (Description, Price, Tags, Title, SupportedOS, image)
    VALUES ('$descr', '$price', '$tagsx', '$title', '$supOS', '$image')")) { echo "Error posting auction [48]: syntax[" . mysql_error() . "]"; }

} 
```

As you can see, I try to store the BLOB as an string value. But it throws me an error.

How do I solve this?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T18:08:10.407

改变`POST`：

```
$title = mysql_real_escape_string($_POST["title"]);
$descr = mysql_real_escape_string($_POST["description"]);
$price = mysql_real_escape_string($_POST["price"]);
$tagsx = mysql_real_escape_string($_POST["tags"]);
$supOS = mysql_real_escape_string($_POST["SupportedOS"]); 
```

与查询：

```
mysql_query("INSERT INTO MarketDatas (Description, Price, Tags, Title, SupportedOS, image)
VALUES ('".$descr."', '".$price."', '".$tagsx."', '".$title."', '".$supOS."', '".mysql_real_escape_string($image)."')") 
```

您的二进制数据很可能包含`'`并破坏了您的 INSERT：

```
version for the right syntax near '?+Qi}'?m?Am............'
________________________________________^ 
```

# javascript - How do I position a div directly under a clicked on image?

> ID：12554739
> 
> 赞同：1
> 
> 时间：2012-09-23T17:55:23.580
> 
> 标签：javascript, jquery, html, css

I have a website with social icons listed across the page. When you click on one, I want a window to pop under with more information. Here is a picture of what I want it to look like after the user clicks on an icon.

![enter image description here](../Images/74ca5906355966bcc3b2c032e7df0a35.png)

That entire pop-over is self contained in it's own div.

I'm looking for a more dynamic method then just hard coding in different coordinates for each button.

Thanks in advance.

The Html

```
<div id='inset'>
    <div id='icon-gutter'>
        <div id='gutter-loader'>

        </div>
        <div id='icons'>
        <img src='images/facebook.png' id='facebook' />
        <img src='images/twitter.png' id='twitter' />
        <img src='images/google+.png' id='google+' />
        <img src='images/linkedin.png' id='linkedin' />
        <img src='images/reddit.png' id='reddit' />
        <img src='images/tumblr.png' id='tumblr' />
        <img src='images/pinterest.png' id='pinterest' />
        <img src='images/youtube.png' id='youtube' />
        <img src='images/lastfm.png' id='lastfm' />
        <img src='images/instagram.png' id='instagram' />
        <div id='pop-over-wrap'>
            <div id='arrow'>
            </div>
        <div id='pop-over-body'>
            Hello
        </div>
        </div>
        </div>

    </div>
</div> 
```

The CSS

```
#inset {
margin: 0;
padding: 0;
background: url(grey-fabric.png) repeat; /*#001121;*/
height: auto;
max-width: 100%;
position: relative;
padding: 14px 10px 10px 22px;

border-radius: 5px 5px 0px 0px; 
-moz-border-radius: 5px 5px 0px 0px; 
-webkit-border-radius: 5px 5px 0px 0px;

}
#icon-gutter {

    height: auto;
    min-height: 43px;
    position: relative;
    text-align: center;
}

#icons {
    opacity:0;
}
#icons img {

    height: 95px;
    position: relative;
    margin: 0 8px;
    cursor: pointer;

    transition: all .2s;
-moz-transition: all .2s; /* Firefox 4 */
-webkit-transition: all .2s; /* Safari and Chrome */
-o-transition: all .2s; /* Opera */

}
#pop-over-wrap {
    padding: 10px;
    position: absolute;
    width: 200px;
    height: 230px;
    background-color: white;
     border-radius: 5px 5px 5px 5px; 
    -moz-border-radius: 5px 5px 5px 5px; 
    -webkit-border-radius: 5px 5px 5px 5px;
    margin-top: 20px;
    margin-left: 300px;

    -moz-box-shadow: 3px 3px 4px #000;
    -webkit-box-shadow: 3px 3px 4px #000;
    box-shadow: 3px 3px 4px #000;
    /* For IE 8 */
    -ms-filter: "progid:DXImageTransform.Microsoft.Shadow(Strength=4, Direction=135, Color='#000000')";
    /* For IE 5.5 - 7 */
    filter: progid:DXImageTransform.Microsoft.Shadow(Strength=4, Direction=135, Color='#000000');

}
#arrow {
    position: relative;
    background: url(images/arrowup.png) no-repeat;
    background-position: top center;
    height: 40px;
    margin-top: -30px;

}
#pop-over-body {

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T18:16:27.147

Remove the margins on the `#pop-over-wrap` css rule, and handle the positioning through jQuery.

```
$(function(){

    var popup = $('#pop-over-wrap'),
        popupOffset = popup.outerWidth()/2,
        arrowExceed = 30; // how many pixel the arrow exceeds from the containing wrapper.

    $('#icons > img').click(function(){
        var icon = $(this),
            iconPos = icon.position(),
            iconW = this.width,
            iconH = this.height,
            popupTop = iconPos.top + iconH + arrowExceed,
            popupLeft = iconPos.left + iconW/2 - popupOffset;

        popup.css({left:popupLeft, top:popupTop});
        popup.show();
    });

}); 
```

**Demo at** [http://jsfiddle.net/ALFfs/1/](http://jsfiddle.net/ALFfs/1/)
*demo has hardcoded image widths because i have no access to the images..*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T18:15:49.773

看看这里：[CSS 工具提示和语音气泡](http://konigi.com/tools/css-tooltips-and-speech-bubbles)。

您不必完全计算这些框的坐标。有很多 CSS3 技巧可以做到这一点。嘿，你甚至不必使用 Javascript！但是，如果您考虑兼容性，请考虑使用这个[jQuery 插件](http://jquerytools.org/demos/tooltip/index.html)来帮助您做工具提示。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-23T18:17:29.967

What if you put each `img` in a `div` together with its pop over. Then you position the container div relative and position the pop over absolute?

Like this:

```
<div class="icon">
    <img src='images/facebook.png' id='facebook' />
    <div class="popover">
        <div id='arrow'>
        </div>
        <div id='pop-over-body'>
            Hello
        </div>
    </div>
</div> 
```

And then in css:

```
.icon{
    position:relative;
}
.popover{
    position:absolute;
    left:-30px;
    top:10px;
} 
```

You get the idea? It would be even nicer to put the icons in an unordered list.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-23T18:11:57.967

检查[这个](http://jquerytools.org/demos/tooltip/any-html.html)jquery 插件来完成你想要的

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-23T18:20:08.520

您可以将 div 用作图像的容器和带有信息的 div。例如：

```
<div id="container-1">
   <img src='images/facebook.png' id='facebook' />
   <div id="information-1" class="information-block hideElement"></div>
</div>
<div id="container-2">
   <img src='images/twitter.png' id='twitter' />
   <div id="information-2" class="information-block hideElement"></div>
</div> 
```

在哪里

```
.hideElement { display: none; }
.information-block { position: relative; top: 10px; left: -20px; width: 100px;} //for example 
```

使用 jQuery，您可以在单击第一个容器时显示第一个容器的信息块：

```
$("#container-1").click(function() {
   $("#information-1").removeClass("hideElement");
}); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-23T18:06:25.873

您可以像这样在每个 img 上创建事件：

```
$('#icons').find('IMG').each(function(){
    $(this).click(function(){  
       var idBlock = $(this).attr('id');
        //Code of showing popup window idBlock type
          var htmlBasedonIdBlock = GetBlockHtml(idBlock)
         $('#pop-over-wrap').html(htmlBasedonIdBlock)
   })
}) 
```

根据块类型获取 html 的 GetBlockHtml 函数

你使用tipsy，所以你只需要为body的内容制作html，所有的工作都将由一个人完成

如果你不为此使用tipsy，这里有很多其他jquery插件[http://www.1stwebdesigner.com/css/stylish-jquery-tooltip-plugins-webdesign/](http://www.1stwebdesigner.com/css/stylish-jquery-tooltip-plugins-webdesign/)

# java - Make ArrayList only show new data

> ID：12554745
> 
> 赞同：0
> 
> 时间：2012-09-23T17:55:45.267
> 
> 标签：java, android, arraylist, load

I have an app that shows images from an tumblr account. At the bottom of the list there is a "load more" button, when pressed loads 20 more images to the list. As it works now the app only appends to the new images to the list, so there is shown 40 images after the button has been pressed. How can i make it so the list only contains the new 20 images?

My code looks like this:

```
public class Example extends Activity {

static ArrayList<Tumblr> tumblrs;
Context context = null;
ListView listView = null;
TextView footer;
int offset = 0;
ProgressDialog pDialog;
public boolean isNew = false;

private String searchUrl = "http://api.tumblr.com/v2/blog/factsandchicks.com/posts?api_key=API_KEY&offset=0";

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    try {
        tumblrs = getTumblrs();
        listView = (ListView) findViewById(R.id.list);
        View v = getLayoutInflater().inflate(R.layout.footer_layout, null);
        footer = (TextView) v.findViewById(R.id.tvFoot);
        listView.addFooterView(v);
        listView.setAdapter(new UserItemAdapter(this, R.layout.listitem));

    } catch (ClientProtocolException e) {
        e.printStackTrace();
    } catch (IOException e) {
        e.printStackTrace();
    } catch (JSONException e) {
        e.printStackTrace();
    }

    footer.setOnClickListener(new View.OnClickListener() {

        @Override
        public void onClick(View v) {
            new loadMoreListView().execute();
        }
    });

}

public class UserItemAdapter extends ArrayAdapter<Tumblr> {

    public UserItemAdapter(Context context, int imageViewResourceId) {
        super(context, imageViewResourceId, tumblrs);

    }

    @Override
    public View getView(int position, View convertView, ViewGroup parent) {
        View v = convertView;
        if (v == null) {
            LayoutInflater vi = (LayoutInflater) getSystemService(Context.LAYOUT_INFLATER_SERVICE);
            v = vi.inflate(R.layout.listitem, null);
        }

        Tumblr tumblr = tumblrs.get(position);
        if (tumblr != null) {
            ImageView image = (ImageView) v.findViewById(R.id.avatar);
            if (image != null) {
                image.setImageBitmap(getBitmap(tumblr.image_url));
            }
        }
        return v;
    }
}

public Bitmap getBitmap(String bitmapUrl) {
    try {
        URL url = new URL(bitmapUrl);
        return BitmapFactory.decodeStream(url.openConnection()
                .getInputStream());
    } catch (Exception ex) {
        return null;
    }
}

public ArrayList<Tumblr> getTumblrs() throws ClientProtocolException,
        IOException, JSONException {
    searchUrl = "http://api.tumblr.com/v2/blog/factsandchicks.com/posts?api_key=API_KEY&offset=0";

    ArrayList<Tumblr> tumblrs = new ArrayList<Tumblr>();

    HttpClient client = new DefaultHttpClient();
    HttpGet get = new HttpGet(searchUrl);

    ResponseHandler<String> responseHandler = new BasicResponseHandler();

    String responseBody = null;
    try {
        responseBody = client.execute(get, responseHandler);
    } catch (Exception ex) {
        ex.printStackTrace();
    }

    JSONObject jsonObject = new JSONObject(responseBody);

    JSONArray posts = jsonObject.getJSONObject("response").getJSONArray(
            "posts");
    for (int i = 0; i < posts.length(); i++) {
        JSONArray photos = posts.getJSONObject(i).getJSONArray("photos");
        for (int j = 0; j < photos.length(); j++) {
            JSONObject photo = photos.getJSONObject(j);
            String url = photo.getJSONArray("alt_sizes").getJSONObject(0)
                    .getString("url");

            Tumblr tumblr = new Tumblr(url);
            tumblrs.add(tumblr);
        }
    }
    return tumblrs;
}

public class Tumblr {

    public String image_url;

    public Tumblr(String url) {
        this.image_url = url;
    }
}

private class loadMoreListView extends AsyncTask<Void, Void, Void> {

    @Override
    protected void onPreExecute() {
        // Showing progress dialog before sending http request
        pDialog = new ProgressDialog(Example.this);
        pDialog.setMessage("Please wait..");
        pDialog.setIndeterminate(true);
        pDialog.setCancelable(false);
        pDialog.show();
    }

    @Override
    protected Void doInBackground(Void... unused) {
        // TODO Auto-generated method stub
        runOnUiThread(new Runnable() {
            public void run() {
                // increment current page
                offset += 2;

                // Next page request

                searchUrl = "http://api.tumblr.com/v2/blog/factsandchicks.com/posts?api_key=API_KEY&offset="
                        + offset;

                HttpClient client = new DefaultHttpClient();
                HttpGet get = new HttpGet(searchUrl);

                ResponseHandler<String> responseHandler = new BasicResponseHandler();

                String responseBody = null;
                try {
                    responseBody = client.execute(get, responseHandler);
                } catch (Exception ex) {
                    ex.printStackTrace();
                }

                JSONObject jsonObject;
                try {
                    jsonObject = new JSONObject(responseBody);

                    JSONArray posts = jsonObject.getJSONObject("response")
                            .getJSONArray("posts");
                    for (int i = 0; i < posts.length(); i++) {
                        JSONArray photos = posts.getJSONObject(i)
                                .getJSONArray("photos");
                        for (int j = 0; j < photos.length(); j++) {
                            JSONObject photo = photos.getJSONObject(j);
                            String url = photo.getJSONArray("alt_sizes")
                                    .getJSONObject(0).getString("url");

                            Tumblr tumblr = new Tumblr(url);
                            tumblrs.add(tumblr);

                        }
                    }

                } catch (JSONException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                }

                // get listview current position - used to maintain scroll
                // position
                int currentPosition = listView.getFirstVisiblePosition();

                // Setting new scroll position
                listView.setSelectionFromTop(currentPosition + 1, 0);
            }
        });
        return null;
    }

    protected void onPostExecute(Void unused) {
        pDialog.dismiss();
    }

}
} 
```

Any help is appriciated.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T18:02:40.617

只需像这样重新初始化列表（这会在您的`loadMoreListView#doInBackground`方法中添加一行）。

```
tumblrs = new ArrayList<Tumblr> ();
for (int i = 0; i < posts.length(); i++) {
    JSONArray photos = posts.getJSONObject(i).getJSONArray("photos");
    for (int j = 0; j < photos.length(); j++) {
         JSONObject photo = photos.getJSONObject(j);
         String url =
             photo.getJSONArray("alt_sizes").getJSONObject(0).getString("url");
         Tumblr tumblr = new Tumblr(url);
         tumblrs.add(tumblr);
         }
} 
```

PS：您添加了太多不需要的代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T18:16:35.343

Its quite simple, and I usually use this in my projects.

Just call `clear()` method on your `ArrayList` which goes into your `ArrayAdpater`.

Calling `clear()` on your `ArrayList` **before** loading it with the new data, will empty your previous data, and fill it with the new 20 entries.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-23T18:24:03.270

利用

```
tumblrs.clear(); 
```

在你的 doInBackground() 方法中

# ruby-on-rails-3 - 如何防止未经授权的用户访问应用程序

> ID：12554747
> 
> 赞同：0
> 
> 时间：2012-09-23T17:56:01.623
> 
> 标签：ruby-on-rails-3, web-services, web-applications, web, ruby-on-rails-3.2

我想防止未经授权的用户访问基于 Web 的应用程序。我的应用程序是在 RoR 中开发的。它是一个丰富的互联网应用程序。当没有用户限制时，还有一件事同样要做。为此，请建议我的方式...通过桌面序列号/ mac no/用户电子邮件ID或任何其他方式...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T18:03:52.883

那么你让他们“登录”不是你，然后你授权。如果用户名/密码不是您想要的，客户端如何识别自己取决于您，只要它有效。

这样做的方法很多，例如 Authlogic 和 CanCan gems。

# ruby-on-rails - Associating Devise user with Stripe subscriptions

> ID：12554748
> 
> 赞同：0
> 
> 时间：2012-09-23T17:56:06.000
> 
> 标签：ruby-on-rails, ruby, devise, strip

The Railscast about Stripe uses a subscription model. When setting up Devise one sets up a user model. What should we do when using Stripe with Devise? Should I setup an association between the User (has_one) and the Subscription? Should I setup the subscription info in the User? Which option is better for the long term as an application grows?

Thank you

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T19:16:11.580

这取决于。（你知道这即将到来）

如果您想允许多个订阅，或者用户可以通过多种不同方式访问的复杂计费场景，那么让订阅成为它自己的对象。

如果每个用户都有 1 个计费设置，例如您的应用始终为每个用户提供 1 张信用卡，那么将其设置为您的用户的属性。

# java - Repetition in updating rows in MySQL table

> ID：12554749
> 
> 赞同：0
> 
> 时间：2012-09-23T17:56:18.703
> 
> 标签：java, mysql

I am trying to update a column in already exists MySQL table. The values must be read from a text file, and then they must be inserted into the specified column.

I have tried the following:

```
int counter=0;
        while((fileLine=in.readLine())!=null) 
        { 
            System.out.println("Line read is: "+fileLine);

                //execute db insertion
                try {
                    //insert in the database
                    Query= "update db.table set col4=?";    //database
                    preparedStmt3 = DBConnection.con.prepareStatement(Query); 
                    preparedStmt3.setString (1, fileLine);
                    preparedStmt3.executeUpdate();
                    System.out.println("Complete update statement for row: "+counter);
                    counter++;
                } catch (Exception e) {
                    System.out.println("DB_Error:_"+ e.toString());
                }

        } //end while loop 
```

I have tried to output `fileLine` value and it seems correct and change correctly with every loop round. But, after I run the program and check the database, I find that the value inserted is the last line only (and this repeated in all records, it is not what I am supposed to do, which is insert every line in records consequently). what is the cause for this problem ?

EDIT: The text file contains the following lines: aaa bbb ccc ddd eee fff

The run output after I added some `printline` statements to see debug is as the following:

![enter image description here](../Images/ad07de9572a8b45a008c939e2f93cfd1.png)

while the DB contains the last line inserted only

![enter image description here](../Images/a65c54f0216a703e0d3e5999db8b2730.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T18:00:33.160

您的 SQL 没有添加 WHERE 子句来指定要更新的行。因此，在每次迭代中，列中的所有记录都将其`col4`字段更新为值。最后一个是剩下的更新。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T18:10:23.870

您正在使用更新查询来插入值。利用

```
INSERT INTO db.table (col4) VALUES (?) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-23T18:02:46.550

try this,

```
Connection conn = ConnectionBean.getInstance().getDBConnection();
int counter=0;
String fileLine;
BufferedReader in;
String query1 = "select id from test"; // get all the id's from the table you wanna do  the update
ArrayList<Integer> al = new ArrayList<Integer>(); // store them in an arraylist
try {
PreparedStatement stmnt = conn.prepareStatement(query1);
ResultSet rs = stmnt.executeQuery();
while(rs.next()) {
    al.add(rs.getInt("id"));
}
}
catch(Exception ex) {
    ex.printStackTrace();
}

try {
    in = new BufferedReader(new FileReader("file1.txt"));
    int h=1;
    while((fileLine=in.readLine())!=null && al.size()>0)  
    {   

        String query="UPDATE chaitu.test SET col=? WHERE id="+h ;
        PreparedStatement statement = conn.prepareStatement(query);

        statement.setString(1, fileLine);
        statement.executeUpdate();
        h++;
    } //end while loo

} catch (IOException e) {
    // TODO Auto-generated catch block
    e.printStackTrace();
} catch (SQLException e) {
    // TODO Auto-generated catch block
    e.printStackTrace();
}
    } 
```

# c++ - Run fails without any exception

> ID：12554750
> 
> 赞同：1
> 
> 时间：2012-09-23T17:56:18.620
> 
> 标签：c++, vector, while-loop, runtime-error

please have a look at the following code

```
#include <iostream>
#include <iomanip>
#include <vector>

using namespace std;

int static carNumber = 1; //Counts the car number
static int vectorLocation = 0; // used to get the vector location
double total=0; // total amount of charges

vector<double>hoursVector; //tracks each car's parkes hour
vector<double>chargeVector; //tracks each charge
vector<int>carVector; //tracks each car number

double calculateCharge(double numberOfHours);
void printData();
void insertIntoVector(double hours, double charges);

int main()
{
    cout << "Start entering data. -1 to exit \n\n " << endl;
    double numberOfHours=0;

    while(true)
    {
        cout << "Enter Number Of Hours"<< endl;
        cin >> numberOfHours;

        if(numberOfHours==-1)
        {
            break;
        }
        else
        {
            total = total + calculateCharge(numberOfHours);
        }
    }

    printData();

}

//This code will calculate the charge values

double calculateCharge(double numberOfHours)
{

    double charge = 0;
    double extraHours = 0;
    double extraCharge = 0;

    if(numberOfHours<=3)
    {
        charge = 2;
        insertIntoVector( numberOfHours, charge);
    }
    else if(numberOfHours>3 && numberOfHours<24)
    {
        extraHours = numberOfHours-3;
        extraCharge = extraHours * 0.5;

        charge = 2+extraCharge;

        insertIntoVector( numberOfHours, charge);
    }
    else if(numberOfHours==24)
    {
        charge = 10;

        insertIntoVector( numberOfHours, charge);
    }
    else if(numberOfHours>24)
    {
        charge = 0;

        insertIntoVector( numberOfHours, charge);
    }

    return charge;

}

//This code is used to enter data into vectors
void insertIntoVector(double hours, double charges)
{
    hoursVector[vectorLocation] = hours;
    chargeVector[vectorLocation] = charges;
    carVector[vectorLocation] = carNumber++;

    vectorLocation++;
    carNumber++;
}

//This method is used to print data
void printData()
{
    cout << "Car"<< setw(6)<< "Hours" << setw(6) << "Charge" << endl;

    for(size_t i=0;i<hoursVector.size();i++)
    {
        cout << carVector[i] << setprecision(2) << fixed << setw(6) << hoursVector[i] << setw(6) << chargeVector[i] << endl;
    }
} 
```

In here, after giving 1 data inside the while loop, the program terminates giving the error

> RUN FAILED (exit value 1, total time: 5s)

I can't understand why. I am new to C++ and learning it by my self. Please help me to correct this code and run it without an issue.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-23T17:58:06.610

问题是

```
hoursVector[vectorLocation] = hours;
chargeVector[vectorLocation] = charges;
carVector[vectorLocation] = carNumber++; 
```

这些元素还不存在。您必须使用`push_back`动态增加向量的大小。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-23T18:06:18.503

```
hoursVector[vectorLocation] = hours;
chargeVector[vectorLocation] = charges;
carVector[vectorLocation] = carNumber++;
vectorLocation++; 
```

插入向量的方式无效。你应该这样做：

```
hoursVector.push_back( hours );
chargeVector.push_back( charges );
carVector.push_back( carNumber++ ); 
```

std::vector 本身包含有关他分配的内存块的信息；块的大小；当前存储的数据大小等。需要时，它会扩展内存块以允许您推送新值。因此，当您使用索引时，您只会用完分配的内存块（在这种情况下）。无论如何，将值添加到向量中都不是有效的方法，因此您必须使用匹配方法替换。请参阅[链接](http://www.cplusplus.com/reference/stl/vector/)以获取有关 std::vector 方法的帮助。

# android - 切换飞行模式所需的侵入性最小的权限是什么？

> ID：12554754
> 
> 赞同：0
> 
> 时间：2012-09-23T17:56:27.770
> 
> 标签：android

在 Android 中，切换飞行模式的权限是什么？我可以在没有“修改全局系统设置”(WRITE_SETTINGS) 权限的情况下执行此操作吗？

作为开发人员，我想让我的应用程序使用侵入性最小的权限，以便具有权限意识的安全意识的人可以对我的应用程序感到满意，并且知道我不会在幕后对他们的数据做一些可疑的事情或弄乱他们的手机设置向上。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T18:08:59.007

绕过 WRITE_SETTINGS 权限的唯一方法是要求用户通过启动设置活动来手动更改设置：

```
startActivityForResult(
        new Intent(android.provider.Settings.ACTION_AIRPLANE_MODE_SETTINGS), 0); 
```

# sql-server - 在 windows 2008 sp1 上使用 powershell 的故障转移集群

> ID：12554767
> 
> 赞同：0
> 
> 时间：2012-09-23T17:59:27.533
> 
> 标签：sql-server, powershell

我无法导入模块故障转移集群。有什么我需要做的吗？

i) 它的 x86 windows 2008 sp1 设置 ii) 安装了 powershell 2.0。iv) 故障转移管理器 gui 可访问且正常运行。

我错过了一些重要的步骤吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T08:38:00.023

您需要键入 Import-Module failoverclusters，这仅适用于 x64 环境。我在 Sapien Powershell studio 中尝试使用它时遇到了同样的问题，但它在 powershell_ise 中工作，在某些脚本编辑器中，您可以在 32 位和 64 位之间切换来测试脚本。

希望这可以帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T19:28:54.250

也许是错字？模块名称是`FailoverClusters`（注意尾随的“s”）。

# cuda - 共享内存上的原子操作是否按线程数增加的顺序执行？

> ID：12554769
> 
> 赞同：1
> 
> 时间：2012-09-23T17:59:37.950
> 
> 标签：cuda, atomic, gpgpu

我可以确定在这个例子中，原子操作将按照线程的数字顺序执行吗？或者如何以不同的方式做到这一点，不包括只使用一个线程？

```
__shared__ unsigned int cnt[MAXLEN], s[MAXLEN];

#pragma unroll
for (int i = 0; i < MAXLEN; i+= blockDim.x) 
   p[atomicSub(cnt + s[threadIdx.x + i], 1) - 1] = threadIdx.x + i;
__syncthreads(); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-23T18:24:23.703

如果按照线程的数字顺序，您的意思是线程 ID 号，或者线程启动的顺序，答案是否定的。这些因素在线程中事件的排序中*没有*可靠的作用。

# python - 如何从字符串初始化 datetime.time 对象？

> ID：12554774
> 
> 赞同：1
> 
> 时间：2012-09-23T18:00:22.627
> 
> 标签：python, datetime, time, strptime

有没有类似的方法`datetime.datetime.strptime()`，它接受类似的字符串`'16:00'`并返回一个`datetime.time(16,0)`对象（即，一个只保存时间而不是日期的对象）？

编辑：我可以使用 datetime.datetime.strptime()，但它会返回一个 datetime.datetime，我只想要时间，而不是日期。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-23T18:12:46.513

```
import time
time.strptime("16:00", "%H:%M") 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-23T18:51:23.773

```
import datetime
import time
def datetimestrptime(time_string,time_fmt):
     t = time.strptime(time_string,time_fmt)
     return datetime.time(hour=t.tm_hour,minute=t.tm_min,second=t.tm_sec)
print datetimestrptime("16:00","%H:%M")
16:00:00 
```

# android - Android LinearLayout 填充超过父级

> ID：12554777
> 
> 赞同：0
> 
> 时间：2012-09-23T18:00:39.777
> 
> 标签：android, android-layout, slidingdrawer

我没有让这个布局正确。

下面是一些图片，方便我解释：

![在此处输入图像描述](../Images/bb5679b42f0b002ccd476b1aa38e7396.png)

那个绿色的东西是 SlidingDrawer 的临时图标。如您所见，我希望它一直到另一个灰色字段，以便灰色背景变为一个，并且处理程序图标与顶部字段重叠。

这是xml现在的样子：

```
 <LinearLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:gravity="bottom"
    android:orientation="vertical" >

    <LinearLayout
        android:id="@+id/info_container"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:background="@drawable/drawer_bg"
        android:orientation="vertical"
        android:paddingBottom="5dip"
        android:paddingLeft="10dip"
        android:paddingRight="10dip"
        android:paddingTop="10dip" >

        <TextView
            android:id="@+id/info_ip"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:textSize="10dip"
            android:typeface="monospace" />

        <TextView
            android:id="@+id/info_in"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:text="@string/wifi_unknown"
            android:textSize="10dip"
            android:typeface="monospace" />

        <TextView
            android:id="@+id/info_mo"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:textSize="10dip"
            android:typeface="monospace" />
    </LinearLayout>

    <FrameLayout
        android:layout_width="fill_parent"
        android:layout_height="0dip"
        android:layout_weight="1" >

        <TextView
            android:id="@+id/list_empty"
            android:layout_width="wrap_content"
            android:layout_height="fill_parent"
            android:layout_gravity="center_horizontal"
            android:gravity="center_vertical"
            android:text="@string/discover_empty"
            android:textSize="10dip"
            android:typeface="monospace" />

        <!-- Slider -->
        <SlidingDrawer
            android:id="@+id/drawer"
            android:layout_width="fill_parent"
            android:layout_height="fill_parent"
            android:content="@+id/content"
            android:handle="@+id/handle" >

            <!-- Image for the handler to the slider -->
            <ImageView
                android:contentDescription="@string/desc"
                android:id="@id/handle"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:src="@drawable/drawer_handle" />

            <LinearLayout
                android:id="@id/content"
                android:layout_width="fill_parent"
                android:layout_height="fill_parent"
                android:background="@drawable/slider_bg"
                android:orientation="vertical" >

                <!-- Horisontal layout : wide as possible, but height is minimal -->
                <LinearLayout
                    android:layout_width="fill_parent"
                    android:layout_height="wrap_content"
                    android:layout_margin="5dip"
                    android:orientation="horizontal" >

                    <!-- Search button -->
                    <Button
                        android:id="@+id/btn_discover"
                        style="@style/ButtonTop"
                        android:drawableLeft="@drawable/discover"
                        android:text="@string/btn_discover" />

                    <!-- Option button -->
                    <Button
                        android:id="@+id/btn_options"
                        style="@style/ButtonTop"
                        android:drawableLeft="@drawable/settings"
                        android:text="@string/btn_options" />
                </LinearLayout>

                <!-- The list with network devices inside the slidingdrawer-->
                <ListView
                    android:id="@+id/output"
                    android:layout_width="fill_parent"
                    android:layout_height="fill_parent"
                    android:cacheColorHint="#00000000"
                    android:dividerHeight="0dip" />
            </LinearLayout>
        </SlidingDrawer>
    </FrameLayout>
 </LinearLayout> 
```

我试过RelativeLayout，但我做错了。抱歉我的解释不好。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T18:31:26.943

如果您想将信息窗格与滑动抽屉重叠，它（信息窗格布局）也需要位于框架布局内。

这个简单的改变应该让它像你想要的那样工作。

# wordpress - 如果子类别 wordpress 添加类

> ID：12554778
> 
> 赞同：0
> 
> 时间：2012-09-23T18:00:41.557
> 
> 标签：wordpress, categories

我有这个代码：

```
<?php
$terms = get_terms("category");
$count = count($terms);
$url= get_bloginfo("url");
 if ( $count > 0 ){
 echo "<ul class='spis_kate'>";
 foreach ( $terms as $term ) {
$nazwa = $term->name;
$wyswietl= strtolower($nazwa);
$przed = array ('ą', 'ę', 'ó', 'ś', 'ć', 'ń', 'ź', 'ż', 'ę', 'ł', ' ');
$po = array ('a', 'e', 'o', 's', 'c', 'n', 'z', 'z', 'e','l', '-');
$wynik= str_replace($przed, $po, $wyswietl);
   echo "<li><a href=".$url."/produkt/?category_name=" . $wynik. ">" . $term->name . "</a></li>";

 }
 echo "</ul>";
 }
?> 
```

如果类别是孩子，如何向 li 添加一个类（例如孩子）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T18:53:38.873

我建议改用内置的[wp_list_categories](http://codex.wordpress.org/Template_Tags/wp_list_categories)。它会给你一个嵌套列表。

```
<?php wp_list_categories(); ?> 
```

我还可以看到您正在生成自己的 slug。已经生成的 slug 可以在`$term->slug`.

但是，如果您出于任何原因需要知道特定术语是否有父项，则可以检查 的值`$term->parent`。如果未设置，则表示该术语处于顶层。

```
<li class="cat<?php if ( $term->parent ) echo " child"; ?>"> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T18:21:42.517

```
$li_class=($wynik==="child")?"child":"";
echo '<li class="'.$li_class.'"><a href=' ... 
```

# javascript - 动态创建的元素 - 如何制作正确的选择器和访问顶级对象

> ID：12554780
> 
> 赞同：-1
> 
> 时间：2012-09-23T18:00:47.230
> 
> 标签：javascript, jquery

> **可能重复：**
> [Jquery：选择中的选择](https://stackoverflow.com/questions/1266604/jquery-selection-within-a-selection)

考虑这段代码：

```
var $el = $('<div class="test"><div>Foor</div></div><div class="test"><div>Bar</div></div><div class="other">Leave it!</div>');

// won't work
$el.find('div.test').css('color','red');

$('body').append($el); 
```

jsFiddle：

*   [http://jsfiddle.net/bVJkR/2/](http://jsfiddle.net/bVJkR/2/)

如何`<div class="test">`使用 jQuery 访问元素？

请注意，我想`.test`在文档中使用元素之前访问它们。

我知道我可以为 div 创建包装器，但我真的很想避免它。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-23T18:05:42.587

在您的代码`.test`中是一个根级元素。因此，您应该使用`.filter`not `.find`。`.find`是给后代的。

```
$el.filter('.test').css('color','red'); 
```

# php - mysql加入组循环混乱

> ID：12554781
> 
> 赞同：0
> 
> 时间：2012-09-23T18:00:54.470
> 
> 标签：php, mysql

没有经验的mysql用户在这里:)

我有 2 张桌子

一个持有用户创建的事件列表。它还对事件进行了描述。

另一个表保存事件的日期。它还具有事件的唯一 ID。一个事件可以有多个与之关联的日期。

我的问题：

我希望返回一个包含事件和描述的列表。现在我为此使用 for each 循环。

例子：

```
[loop]
    $list .= '<tr><td>$date</td><td>$description</td><tr>';
[/loop]

return $list; 
```

现在我需要显示与一个事件具有相同日期但结合描述的事件

例子：

```
$list .= '
    <tr>
        <td>two-events-with-same-dates-here-but-shown-as-one</td>
        <td>$description 1<br />$description 2</td>
    </tr>
    ';
return $list; 
```

所以我的想法是按日期分组并使用新查询为每个组运行一个循环，并将描述组合成一个描述。

在循环中运行新查询对我来说听起来是错误的和低效的，我认为 mysql 有一些类似这样的智能内置函数。

想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T18:07:48.103

按日期对结果进行排序，然后在php中添加<br/>，直到日期发生变化？

另一种解决方案是使用 group_concat。例子：

```
select date, group_concat(description SEPARATOR '<br/>')
from events
group by date 
```

这将导致

```
'2012-01-01' | 'description1<br/> description2' 
```

# c# - C# XmlWriter.Create() - 访问路径被拒绝

> ID：12554782
> 
> 赞同：3
> 
> 时间：2012-09-23T18:00:57.393
> 
> 标签：c#

我想将一个新的 XML 文件写入磁盘，但以下代码出错。

```
static void Main(string[] args)
        {
            using (XmlWriter writer = XmlWriter.Create(@"C:\abc.xml"))
            {
                writer.WriteStartDocument();
                writer.WriteStartElement("Employees");
                writer.WriteEndElement();
                writer.WriteEndDocument();
            }            

            Console.ReadKey();       
       } 
```

有人可以帮我吗？

注意：abc.xml 尚不存在。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-23T18:04:07.743

**显然，**您无权访问`C:`. 选择您有权访问的路径或以更高权限运行应用程序。

附带说明一下，对于大多数情况，不建议再使用`System.Xml`，请改用 LINQ to XML ( `System.Xml.Linq`)：

```
new XElement("Employees").Save("abc.xml"); // and a path that you have access to. 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-23T18:08:32.360

根据系统，您需要管理员权限才能创建文件 @C:\

以管理员身份运行 VS instante 或将代码更改为

```
 using (XmlWriter writer = XmlWriter.Create("abc.xml"))
        {
            writer.WriteStartDocument();
            writer.WriteStartElement("Employees");
            writer.WriteEndElement();
            writer.WriteEndDocument();
        } 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-04-06T02:12:04.160

不想发布 necropost，但我刚看到这篇文章，我得到了同样的错误。

原来文件夹设置为：

*   只读

这不允许 C# 写入解决方案中的任何文件。

要解决此问题，请访问：

*   右键单击包含所有 C# .sln 文件的主文件夹
*   转到属性
*   在窗口的最底部将有一个名为：只读（仅适用于文件夹中的文件）的检查

这是上述文件夹的链接： [![特性](../Images/ee3d5f1d8c69fe7e24cdef255403b198.png)](https://i.stack.imgur.com/fcpxX.png)

真的很愚蠢，但很容易忘记一些事情！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-23T18:20:51.800

没有管理员模式，您无法`C:\`从 VS 写入文件。您需要在管理员模式下运行您的应用程序/VS 才能将文件写入`C:\`. 或者您可以在其中创建一个文件夹`C:\`并在该文件夹中写入文件。

**代码**

```
 using (XmlWriter writer = XmlWriter.Create(@"C:\folder\abc.xml"))
 {
           writer.WriteStartDocument();
           writer.WriteStartElement("Employees");
           writer.WriteEndElement();
           writer.WriteEndDocument();
  } 
```

在上面的代码中，您不需要在管理员模式下运行 application/VS。

**注意：** C:\folder 必须存在，否则会引发错误。

如果`C:\folder`不存在，请在写入文件之前添加以下代码。

```
if (System.IO.Directory.Exists(@"C:\folder") == false)
{
    System.IO.Directory.CreateDirectory(@"C:\folder");
} 
```

# android - 如何在不违反核心 OO 原则的情况下使用 Fragments？

> ID：12554783
> 
> 赞同：3
> 
> 时间：2012-09-23T18:01:06.230
> 
> 标签：android, oop, android-fragments, android-view

记录的Android片段示例（[FragmentBasics](http://developer.android.com/training/basics/fragments/fragment-ui.html)，[NewsReader](http://developer.android.com/training/multiscreen/adaptui.html)违反了面向对象设计的核心原则。建立当前显示的视图类型存在冗余条件，`FragmentActivity`与视图类型和片段类型紧密耦合。 `MainActivity`耦合到每个类（包括 XML） ：

![在此处输入图像描述](../Images/b2c5fa75ed906d21b0b21e05f453f008.png)

人们可能会为作者找借口说他们试图“保持简单”，或者读者可能会感到困惑。如果这是意图——我认为读者可以处理它；相反，它正在教授糟糕的编程实践，这将导致应用程序的可维护性降低。

如何`Fragments`实现视图和片段不紧密耦合到`FragmentActivity`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-23T18:01:06.230

从更简单的[FragmentBasics](http://developer.android.com/training/basics/fragments/fragment-ui.html)演示开始，`MainActivity`如下所示：

```
public class MainActivity extends FragmentActivity
      implements OnHeadlineSelectedListener {
   AbstractNewsView abstractNewsView;

   @Override public void onCreate(Bundle savedInstanceState) {
      super.onCreate(savedInstanceState);
      setContentView(R.layout.news_articles);
      abstractNewsView = new AbstractNewsViewProvider(this).get();
      abstractNewsView.onCreate(savedInstanceState);
   }

   @Override public void onArticleSelected(int position) {
      abstractNewsView.onArticleSelected(position);
   }
} 
```

现在它的依赖关系图是这样的。您现在可以`news_articles`为不同的设备类型添加您想要的所有视图变体，`MainActivity`而无需更改。

![在此处输入图像描述](../Images/5f18a34e83ba9b06e0eadeb3e9beffee.png)

添加一个新类`AbstractNewsViewProvider`，其唯一职责是确定用于给定设备的视图类型（单窗格或双窗格）。如果您使用 Guice 或 RoboGuice 进行依赖注入，这将是绑定模块中的[Provider](http://code.google.com/p/google-guice/wiki/ProvidesMethods)方法。

```
public class AbstractNewsViewProvider {
   private final FragmentActivity fragmentActivity;

   public AbstractNewsViewProvider(FragmentActivity activity) {
      this.fragmentActivity = activity;
   }

   public AbstractNewsView get() {
      if (fragmentActivity.findViewById(R.id.fragment_container) != null) {
           return new SinglePaneNewsView(fragmentActivity);
        } else {
           return new DoublePaneNewsView(fragmentActivity);
        }
   }
} 
```

添加两个新类`SinglePaneNewsView`并`DoublePaneNewsView`实现`AbstractNewsView`如下所示。这两个类负责在各自的视图类型中设置初始片段。他们还负责处理片段之间的转换（如果有的话）。

```
interface AbstractNewsView extends OnHeadlineSelectedListener {
   public void onCreate(Bundle savedInstanceState);
   @Override public void onArticleSelected(int position);
}

public class SinglePaneNewsView implements AbstractNewsView {

   private final FragmentActivity fragmentActivity;

   public SinglePaneNewsView(FragmentActivity fragmentActivity) {
      this.fragmentActivity = fragmentActivity;
   }

   @Override public void onCreate(Bundle savedInstanceState) {
      // However, if we're being restored from a previous state,
      // then we don't need to do anything and should return or else
      // we could end up with overlapping fragments.
      if (savedInstanceState != null) {
         return;
      }

      // Create an instance of ExampleFragment
      HeadlinesFragment firstFragment = new HeadlinesFragment();

      // In case this activity was started with special instructions from an
      // Intent,
      // pass the Intent's extras to the fragment as arguments
      firstFragment.setArguments(fragmentActivity.getIntent().getExtras());

      // Add the fragment to the 'fragment_container' FrameLayout
      fragmentActivity.getSupportFragmentManager().beginTransaction()
            .add(R.id.fragment_container, firstFragment).commit();
   }

   @Override public void onArticleSelected(int position) {
      // If the frag is not available, we're in the one-pane layout and must
      // swap frags...

      // Create fragment and give it an argument for the selected article
      ArticleFragment newFragment = new ArticleFragment();
      Bundle args = new Bundle();
      args.putInt(ArticleFragment.ARG_POSITION, position);
      newFragment.setArguments(args);
      FragmentTransaction transaction =
            fragmentActivity.getSupportFragmentManager().beginTransaction();

      // Replace whatever is in the fragment_container view with this fragment
      // Add the transaction to the back stack so the user can navigate back
      transaction.replace(R.id.fragment_container, newFragment);
      transaction.addToBackStack(null);

      // Commit the transaction
      transaction.commit();
   }

public class DoublePaneNewsView implements AbstractNewsView {

   private final FragmentActivity fragmentActivity;

   public DoublePaneNewsView(FragmentActivity fragmentActivity) {
      this.fragmentActivity = fragmentActivity;
   }

   @Override public void onCreate(Bundle savedInstanceState) {
   }

   @Override public void onArticleSelected(int position) {
      ((ArticleFragment) fragmentActivity.getSupportFragmentManager()
         .findFragmentById(R.id.article_fragment)).updateArticleView(position);
   }

} 
```

您可以在 Google 代码上 找到[完整的源代码。](http://code.google.com/p/android-oo-fragment-example/)

# c++ - LNK2019 针对 CArray Add、GetAt、GetSize，所有包含都存在

> ID：12554787
> 
> 赞同：0
> 
> 时间：2012-09-23T18:01:25.543
> 
> 标签：c++, visual-studio-2010, visual-c++, dll, linker

我在尝试编译 DLL 时遇到了一些问题，但我只是看不到这个链接错误来自哪里。

我的 LNK2019 是：

```
Exports.obj : error LNK2019: unresolved external symbol "__declspec(dllimport) public: int 
__thiscall CArray<struct HWND__ *,struct HWND__ *>::Add(struct HWND__ *)" (__imp_?Add@?
$CArray@PAUHWND__@@PAU1@@@QAEHPAUHWND__@@@Z) referenced in function "int __stdcall _Disable(struct 
HWND__ *,long)" (?_Disable@@YGHPAUHWND__@@J@Z) 
```

禁用（...）是...

```
static BOOL CALLBACK _Disable(HWND hwnd, LPARAM lParam)
{
  CArray<HWND, HWND>* pArr = (CHWndArray*)lParam;
  if(::IsWindowEnabled(hwnd) && ::IsWindowVisible(hwnd))
  {
    pArr->Add(hwnd);
    ::Enable(hwnd, FALSE);
  }
} 
```

这是 Exports.cpp 中的第一个函数；正上方是

```
#include <afxtempl.h> 
```

我安装了 Windows 7.1 SDK（并尝试重新安装它和 VS2010）。完全相同的项目在其他机器上编译得非常好，所以它不可能是代码本身。我花了无数的错误研究，这导致绝望地尝试改变解决方案文件中的随机值，包括不同的 Windows 头文件，等等。我最后的手段是完全重新安装操作系统（假设它实际上是 Windows SDK 不正确或其他问题）。

任何建议都会有很大的帮助。

编辑：我在 cpp 提供问题上添加了 /showIncludes，我确实看到 afxtempl.h 被包括在内。由于包含它的其他标头，它被多次包含，但它在那里（并且每次都来自同一个目录）：

```
1> Note: including file: C:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\atlmfc\include\afxtempl.h 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T00:11:30.563

只是为了回答这个问题——我最终从我们的 SVN 中重新检查了所有内容并重新编译了所有内容。我认为我们的一个项目出于某种原因搞砸了。

# c - 在 C 结构中初始化值

> ID：12554790
> 
> 赞同：2
> 
> 时间：2012-09-23T18:01:48.060
> 
> 标签：c, arrays, struct

我对C很陌生，我想知道这是否允许，如果允许，我该如何正确地做到这一点？

这段代码给了我大量的编译器错误。我正在尝试创建一个具有 3 个字符数组（初始化为空字符`'\0'`）的结构，并使用名称初始化这些结构之一`S`。

```
struct Structure{
    char array1[3] = { '\0' };
    char array2[30]= { '\0' };
    char array3[30]= { '\0' };
} S; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-23T18:08:52.587

不，这是不允许的。

C 中的类型（你`struct Structure`是一个类型）没有价值。具有价值的是对象。

您可以创建一个结构类型的对象，并使用我所说的*通用零初始化器将其全部初始化为 0，如果需要，可以递归地初始化*。

```
struct Structure {
    char array1[3];
    char array2[30];
    char array3[30];
} S = {0}; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-23T18:08:11.450

不。

有两个不同的东西：

1.  声明结构`struct`- 它由哪些部分组成。
2.  定义此结构的特定实例。这样做时，您还可以初始化部分或全部字段。

您的代码仅声明布局，并没有创建实际实例。所以无法初始化。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-23T18:11:09.123

你不能初始化结构元素中的值。正确的初始化是这样的——
`struct Structure s = {0};`
正确的声明是

```
struct Structure{
    char array1[3] ;
    char array2[30];
    char array3[30];
} S; 
```

# wpf - 尝试读取或写入受保护的内存。这通常表明其他内存已损坏

> ID：12554791
> 
> 赞同：0
> 
> 时间：2012-09-23T18:01:48.810
> 
> 标签：wpf, openfiledialog

您好，我在 WPF 中使用 OpenFileDialog 打开文件，当我第一次使用时它可以正常工作，但是当我再次单击时，它会给我错误，例如“尝试读取或写入受保护的内存。这通常表明其他内存已损坏“我的代码看起来像

```
 using System.Windows.Forms;

    OpenFileDialog oldg = new OpenFileDialog();

    oldg.Filter = "All files (*.*)|*.*|All files (*.*)|*.*";
    oldg.RestoreDirectory = true;
    oldg.Multiselect = true;

    oldg.ShowDialog();
    string file = oldg.FileName; 
```

请帮我解决这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T20:25:12.697

在我看来，好像您正在尝试在 WPF 应用程序中使用[控件的](http://msdn.microsoft.com/en-us/library/system.windows.forms.openfiledialog.aspx)[Windows 窗体版本。`OpenFileDialog`](http://msdn.microsoft.com/en-us/library/system.windows.forms.openfiledialog.aspx)[改用WPF 版本的控件](http://msdn.microsoft.com/en-us/library/microsoft.win32.openfiledialog.aspx)可能会更幸运。

换句话说，尝试替换

```
using System.Windows.Forms; 
```

和

```
using Microsoft.Win32; 
```

# c - 如何使用 libxml2 库在 c 中解析 XML 字符串而不是 XML 文档

> ID：12554792
> 
> 赞同：11
> 
> 时间：2012-09-23T18:02:03.493
> 
> 标签：c, xml, xml-parsing, libxml2

libxml2 文档[libxml 教程](http://www.xmlsoft.org/tutorial/ix01.html)中的所有示例均使用外部 XML 文件提及。如果我需要解析包含 XML 内容的字符串怎么办？在 libxml2 C 库中是否真的有可能，或者唯一的解决方案是将字符串保存到文件中并将该文件名作为参数发送给下面的函数。但是会严重影响性能。

```
doc = xmlParseFile(docname); 
```

libxml2 中是否有任何内置函数来解析字符数组？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-09-23T18:14:49.400

您可以使用[`xmlParseDoc()`](http://www.xmlsoft.org/html/libxml-parser.html#xmlParseDoc), 它将采用一个以空字符结尾的字符串（xmlChar / unsigned char）并完全解析它，就好像它是使用[`xmlParseFile()`](http://www.xmlsoft.org/html/libxml-parser.html#xmlParseFile).

# security - MVC 4 Authentication Using Forms and Azure ACS

> ID：12554796
> 
> 赞同：3
> 
> 时间：2012-09-23T18:02:42.567
> 
> 标签：security, asp.net-mvc-4, azure

I have made a MVC 4 Project, set up to authenticate using STS (Azure ACS). Everyhing works. People can sign in using Google,Facebook or Live ID.

My Question is now from a design point of view. Could i expect people to always have one of aboves to sign in with? Can i add Twitter to Azure ACS also?

Would it be a good idea to also add forms login and give people the option to register an user as in the old days and sign in? How do i do this ? Is it just to enable forms authentication again in web.config.

```
<!--Commented out by Identity and Access VS Package-->
<!--<authentication mode="Forms"><forms loginUrl="~/Account/Login" timeout="2880" /></authentication>--> 
```

Right now when i put Aothorize on a controller, it redirect me to :

```
http://localhost:48451/login.aspx?ReturnUrl=%2fHome%2fAbout 
```

How do i solve that? Im thinking that enabling the forms authentication again might solve it - but i would like some comments on the design first before just doing it.

# ios - 手动启动测试用例（SenTestCase）？测试前需要等待一些后台任务

> ID：12554798
> 
> 赞同：1
> 
> 时间：2012-09-23T18:02:44.647
> 
> 标签：ios, multithreading, sentestingkit

我在后台从磁盘加载了一些数据。

我的测试应该在运行时存储填充后运行，但现在测试与我的加载并行运行，这当然会导致空对象，因此测试失败。

加载数据后有什么方法可以运行测试？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T18:35:38.783

首先，尽量减少对同步任务的单元测试。逻辑测试的设计方式应尽量减少对其他组件的依赖。

也就是说，如果您坚持这样做，您可以构建异步测试，有时是有正当理由的（只是不经常这样做）。看看[SenAsyncTestCase](https://github.com/akisute/SenAsyncTestCase) - 它为此类测试提供了许多基类。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-26T10:10:35.820

我真的可以推荐我开源的项目。您可以像这样编写异步测试。

```
- (void)testSomethingAsync
{
    __block BOOL jobDone = NO;

    [CEO asyncFireAllEmployes:^{
        jobDone = YES; 
    }];

    WAIT_WHILE(!jobDone, 0.2); // stalls runloop until jobDone is true
} 
```

它可以在这里[https://github.com/hfossli/AGWaitForAsyncTestHelper](https://github.com/hfossli/AGWaitForAsyncTestHelper)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-09-23T18:22:11.440

只需在`setUp`测试用例的例程中获取数据。

# c++ - 为什么在这种情况下 C++ 模板参数推导失败？

> ID：12554800
> 
> 赞同：4
> 
> 时间：2012-09-23T18:03:00.217
> 
> 标签：c++, templates, boost, delegates, function-pointers

我正在尝试编写自己的委托系统来替代 boost::functions，因为后者做了很多我认为有问题的堆分配。
我已经将其编写为替代（简化，实际使用池化内存和放置新的，但这很简单，可以重现错误）：

```
template<class A, class B>
struct DelegateFunctor : public MyFunctor {
  DelegateFunctor(void (*fptr)(A, B), A arg1, B arg2) : fp(fptr), a1(arg1), a2(arg2) {}

  virtual void operator()() { fp(a1, a2); }

  void (*fp)(A, B);  // Stores the function pointer.
  const A a1; const B a2;  // Stores the arguments.
}; 
```

这个辅助函数：

```
template<class A, class B>
MyFunctor* makeFunctor(void (*f)(A,B), A arg1, B arg2) {
  return new DelegateFunctor<A,B>(f, arg1, arg2);
} 
```

奇怪的事情发生在这里：

```
void bar1(int a, int b) {
  // do something
}

void bar2(int& a, const int& b) {
  // do domething
}

int main() {
  int a = 0;
  int b = 1;

  // A: Desired syntax and compiles.
  MyFunctor* df1 = makeFunctor(&bar1, 1, 2);

  // B: Desired syntax but does not compile:
  MyFunctor* df2 = makeFunctor(&bar2, a, b);

  // C: Not even this:
  MyFunctor* df3 = makeFunctor(&bar2, (int&)a, (const int&)b);

  // D: Compiles but I have to specify the whole damn thing:
  MyFunctor* df4 = makeFunctor<int&, const int&>(&bar2, a, b);
} 
```

我得到的版本 C（B 类似）的编译器错误是：

```
error: no matching function for call to ‘makeFunctor(void (*)(int&, const int&), int&, const int&)’ 
```

这很奇怪，因为编译器在其错误消息中实际上正确推断了类型。

有什么方法可以让我编译 B 版吗？boost::bind 如何绕过这个限制？
我正在使用 GCC 4.2.1。请不要使用 C++11 解决方案。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-23T18:14:43.400

论据推论剥离参考。通过匹配 的函数指针签名`A`，我们想要得到`int &`，但是通过匹配实际参数，我们想要`int`，因此推导失败。

一种解决方案是使第二种类型不推导，如下所示：

```
#include <type_traits>

template <typename R, typename A, typename B>
R do_it(R (*func)(A, B),
        typename std::common_type<A>::type a,   // not deduced
        typename std::common_type<B>::type b)   // not deduced
{
    return func(a, b);
} 
```

现在`A`和`B`完全由函数指针的签名确定：

```
int foo(int &, int const &);

int main()
{
    int a = 0, b = 0;
    return do_it(foo, a, b);  // deduces A = int &, B = int const &
} 
```

[（请注意，这`std::common_type<T>::type`是“身份类型”的推荐习惯用法，其唯一目的是从参数推导中删除模板参数。这以前被称为`identity<T>::type`or `alias<T>`，但标准库 trait`std::common_type`很好地服务于这个目的。）]

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-23T19:17:43.093

当使用值参数推导模板参数时，您只会得到一个值类型。也就是说，当您使用函数模板时

```
template <typename T>
void f(T) {
} 
```

该类型`T`将始终是非引用类型。现在，当您尝试传递函数指针和值时，如果函数不采用值类型，编译器将无法使推导的类型保持一致：

```
template <typename T>
void f(void (*)(T), T) {}

void f0(int);
void f1(int const&);

int main() {
    f(&f0, 0); // OK
    f(&f1, 0); // ERROR
} 
```

处理这个问题的一种方法是适当地重载相应的函数模板。如果您将以下功能添加到组合中，则上述示例将再次起作用：

```
template <typename T>
void f(void (*)(T const&), T const&) {} 
```

显然，这很快成为维护的噩梦，可能**不是**您想要做的。另一种方法是为各个参数使用不同的模板参数：

```
template <typename T, typename S>
void f(void (*)(T), S) {} 
```

尽管这可行，但这会立即产生影响，即您不一定匹配您真正想要为第二个参数匹配的类型：即使您可能想要获取引用类型，它也会是一个值类型（就个人而言，我怀疑您做，但这是一个不同的问题）。如果您不希望这种情况发生，您可以阻止编译器形式尝试推断某些参数的参数。例如：

```
template <typename T>
struct helper {
    typedef T type;
};
template <typename T>
void f(void (*)(T), typename helper<T>::type) {} 
```

尽管上面的示例仅使用一个模板参数演示了手头的问题，但我确信这也适用于更多模板参数。这是否是 Boost 我既不知道也不关心的。

# c++ - Is it possible to get a pointer to two different frames in a video sequence at the same time with OpenCV?

> ID：12554802
> 
> 赞同：0
> 
> 时间：2012-09-23T18:03:11.607
> 
> 标签：c++, opencv

You can access a specific frame in a video sequence like this:

```
capture.set(CV_CAP_PROP_POS_FRAMES, frame_num);
capture >> frame; 
```

You can then access a separate frame like this:

```
capture.set(CV_CAP_PROP_POS_FRAMES, frame_num - 20);
capture >> frame2; 
```

However, when you set the capture property with `CV_CAP_PROP_POS_FRAMES`, it actually moves the first pointer and `frame` and `frame2` end up pointing to the same data, containing the same values.

I want a pointer to both, so I do not have to clone the data (expensive computation) but I can perform comparisons between the two frames. How can this be done with OpenCV?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T18:39:56.467

您可以复制第一帧：

```
Mat frame1 = frame.clone(); 
```

# .net - Hashtable.Synchronized 是否适合在多线程环境中用作简单缓存？

> ID：12554803
> 
> 赞同：1
> 
> 时间：2012-09-23T18:03:19.713
> 
> 标签：.net, collections, hashtable

我目前正在使用包装为 Hashtable 的 Hashtable。Synchronized 作为库中的简单缓存，可由多线程环境（例如 asp.net）使用 - 这是否适合用于此集合？我知道 .Net 4.0 中有更合适的结构可用，但我坚持使用 .Net 3.5。

如果有任何区别，则经常读取此缓存，并且很少写入（但需要保持线程安全）。

基本用法大致如下：

```
Private Shared ReadOnly ExpressionCache As Hashtable = Hashtable.Synchronized(New Hashtable())

..snip...

If Not ExpressionCache.ContainsKey(myKey) Then
      ExpressionCache(myKey) = myExpensiveOperationToInit()
End If
Return  ExpressionCache(myKey)

..snip.. 
```

我在这里做了一些潜在危险的事情，还是这是一个可以接受的用例？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-23T18:40:59.800

实际上，`Hashtable`（不像`Dictionary<,>`）已经具有非常好的线程语义，可用作缓存：它对*读取器*是线程安全的（但需要对写入器进行锁定） -[来自 MSDN](http://msdn.microsoft.com/en-us/library/system.collections.hashtable.aspx)：

> Hashtable 是线程安全的，可供多个读取线程和单个写入线程使用。当只有一个线程执行写入（更新）操作时，多线程使用是线程安全的，如果写入器序列化到哈希表，则允许无锁读取。

（它还提到`.Synchronized`支持多个作家，但坦率地说，自己控制这个通常会得到更好的结果）

但是，为避免幻读，您不应使用单独的“包含”/“获取”操作；标准使用可能是（以 C# 为例）：

```
public YourType Get(string key) {
    return (YourType) expressionCache[key];
}
public void Set(string key, YourType value) {
    lock(expressionCache) {
        expressionCache[key] = value;
    }
} 
```

关键点：

*   只有“集合”有任何锁定
*   “get”中只有一个操作
*   在集合中使用索引器，而不是`Add`（那么你不需要先检查“包含”）

在最常见的线程场景中，`.Synchronized`包装器实际上几乎没有价值。

# android - LinearLayout 视图中的 Hitarea

> ID：12554805
> 
> 赞同：0
> 
> 时间：2012-09-23T18:03:46.023
> 
> 标签：android, android-layout

我已经定义了一个带有一些 TextView 展开的 LinearLayout。我不想在每个特定的 TextView 上放置一个 setOnTouchListener，而是将我的 LinearLayout 划分为三个区域（hitareas）。如果我击中顶部区域，我会做一些事情（在中间做其他事情等）。即，我想为顶部、中间和底部设置三个侦听器，并且在每个区域中，我都布置了任意数量的 Android TextView（或可能的其他小部件）。

我该如何解决这个问题？

非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T18:09:44.373

您可以使用一个 OnTouchListener 并使用[getX()](http://developer.android.com/reference/android/view/MotionEvent.html#getX%28%29)或[getY()](http://developer.android.com/reference/android/view/MotionEvent.html#getY%28%29)从 MotionEvent 获取坐标，并计算他们触摸了 LinearLayout 的哪三分之一。

# jquery - 将新项目附加到 jquery mobile 中的导航栏时，重新格式化页面失败

> ID：12554812
> 
> 赞同：0
> 
> 时间：2012-09-23T18:04:20.960
> 
> 标签：jquery, jquery-mobile

我正在尝试使用以下代码将项目动态嵌入到导航栏

```
$('#addForm').live('click', function() {
    $('<li><a href="#" data-href="a" data-icon="grid">Form ' +   ($(this).parent().find('li').length) + '</a></li>').insertBefore($(this));
    $('#frmNav').navbar();
 });​ 
```

你也可以检查[这个](http://jsfiddle.net/3RJuX/398/)小提琴。到目前为止，我已经尝试了 SO 中给出的所有解决方案。没有一个对我有用..请帮助我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T19:23:41.403

***JS***

```
$('#addForm').live('click', function() {
     var textA = 'Form ' + $(this).parent().find('li').length;   

    var li = $("<li>");
    var a = $("<a>")
        .attr("data-href","a")
        .attr("data-icon","grid")
        .attr("href","#")
        .text(textA );

   $(a).appendTo(li)     

   $(li).insertBefore($(this));

   $(li).navbar();

});​ 
```

您需要调用`navBar()`新元素

# c# - 带有 ajax/javascript/proxy 和多线程支持的无头浏览器或浏览器控件？

> ID：12554817
> 
> 赞同：3
> 
> 时间：2012-09-23T18:05:05.577
> 
> 标签：c#, multithreading, .net-4.0, webbrowser-control, headless-browser

我在这里查看了很多消息，但还没有找到一个浏览器控件或无头浏览器，它允许我多线程和配置每个线程的代理以及支持 ajax/javascripts。

我试过很远：

*   awesomium - 如果我为我需要运行的每个线程生成一个单独的应用程序，但不是我正在寻找的线程，那么效果很好。
*   simplebrowser - 运行良好，但 js/ajax 操作太弱，无法考虑
*   nhtmlunit - 工作太复杂，无法在 c# 上启动和运行，而且效果不佳
*   watin - 不能实例化私人会话并且不能有每个实例的代理

我也尝试过其他人，但这些是我记得的主要测试。

如果 awesomium 能够做多线程，那将是很棒的，但我听说他们只会在以后的版本中这样做，这是迄今为止最好的。

任何人都可以推荐我其他人进行测试或能够完成上述要求吗？

我的主要目标是在本地网络网站上自动化测试。

**更新：**

如果我错了，请纠正我，但与 watin 不同，selenium webdriver（将尝试并测试几次）似乎需要一个在应用程序本身之外运行的远程服务器来控制浏览器，仍在寻找替代方案。

**更新2：**

已经能够使用 chromiumdriver + Selenium 和 c# 进行多线程，但是它在产生多个 cromiumdrivers + 浏览器的基础上只为几个线程使用了难以置信的内存量：

触发多个线程：

```
_tasks = new List<Task>();
foreach (ProxyList item in _proxy)
{
            // using it directly it doesnt get passed down to the function
    string proxy = item.Proxy;
    string host = item.Host;
    _tasks.Add(Task.Factory.StartNew(() =>
    {
        ChromeGetIp(proxy, host);
    }));
} 
```

铬合金

```
private void ChromeGetIp(string proxy, string host)
{
    string dir = Application.StartupPath + "\\" + host;
    ChromeOptions profile = new ChromeOptions();
    profile.AddArguments(new string[] { "-proxy-server=" + proxy, "-incognito", "--new-window", "-user-data-dir=" + dir });
    IWebDriver driver = new ChromeDriver(profile);
    driver.Navigate().GoToUrl("http://checkip.dyndns.com/");
    if (driver.PageSource.Contains("Current IP Address"))
        MessageBox.Show(driver.FindElement(By.TagName("body")).Text, host);
    else
        MessageBox.Show("Failed", host);
    driver.Quit();
} 
```

**使这个更轻的其他方法值得用于多个线程吗？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-25T11:27:00.023

我正在寻找一个类似的解决方案，使用无头 HttpWebRequest 找到驱动自动化对于任何使用 JS 的东西来说几乎是不可能的。即，99% 的互联网。

无论如何 - Selenium 不需要服务器，除非你想远程做事。如果你想在同一台机器上编写一些 C# 来驱动你的浏览器——你最好选择 Selenium。

在这里解释： http: [//seleniumhq.org/docs/03_webdriver.html](http://seleniumhq.org/docs/03_webdriver.html)

编辑：必须编辑这个答案，因为我无法发表评论（我回答时没有登录）。

如果您想进行无头浏览 - 或者至少在浏览器不可见的情况下，您可以将其设置为服务。这将作为系统执行，您将看不到浏览器。它确实会占用大量内存，但除非您要同时运行 100 个浏览器，否则对于任何现代计算机来说都不是问题。并确保在必要时/服务结束时退出（）浏览器。

至于代理 - 你不能用 IE 来设置它，但是 Firefox 会用 Capabilities 来接受它，这就是我正在做的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T18:08:56.837

有什么理由拒绝通常的 Selenium/Firefox 组合？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-30T06:44:37.013

到目前为止，我发现最好的解决方案是 using `awesomium`，它在使用 headless 时使用的内存非常少，与 selenium 和其他解决方案相比，它允许我生成大量进程，并且对 AJAX、JavaScript、代理等有很好的支持。

暂时我会留下我自己的答案，但是如果有人发布了符合我要求的更好的选择，我会改变它。

# qt - 重载qt属性

> ID：12554819
> 
> 赞同：2
> 
> 时间：2012-09-23T18:05:25.623
> 
> 标签：qt, properties, metaobject

我有一个自定义类型的属性。

```
class foo : public QObject {
    Q_OBJECT
    Q_PROPERTY(Custom x READ x WRITE set_x)

public: 
    void set_x(Custom &x) { /*whatnot*/}
} 
```

QJson 有效地调用了以下动态赋值：

```
((QObject*)&foo_instance)->setProperty("x", QVariant(QString("something-from-json"))) 
```

它返回 false，如 Qt 中所述：

*如果该值与属性的类型不兼容，则不会更改该属性，并返回 false。*

如何将其填充到我的自定义值中？明确定义一个副功能`void set_x(QString)`或`void set_x(QVariant)`不可能工作，因为属性系统将不知道这个访问器。

另外，类型兼容性在哪里检查？- 程序控制永远不会到达

`int foo::qt_metacall(QMetaObject::Call _c, int _id, void **_a)`

元对象编译器生成的函数..

我怎样才能使`Custom`这些类型兼容？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T19:55:58.517

[阅读财产系统](http://qt-project.org/doc/qt-4.8/properties.html)可能很有用

特别是*属性和自定义类型*部分。

简而言之，所有属性都保存为 QVariant。
您需要使用[Q_DECLARE_METATYPE](http://qt-project.org/doc/qt-4.8/qmetatype.html#Q_DECLARE_METATYPE)宏来使您的*自定义*类型与 Qt 属性兼容。
之后，您必须调用[qRegisterMetaType](http://qt-project.org/doc/qt-4.8/qmetatype.html#qRegisterMetaType)函数来注册您的类型。

# visual-studio-2010 - Qt 和 Visual Studio 2010 错误

> ID：12554820
> 
> 赞同：0
> 
> 时间：2012-09-23T18:05:28.440
> 
> 标签：visual-studio-2010, qt, qt4

使用 Visual Studio 命令提示符构建 Qt 后，我​​的配置字符串：configure.exe -release

我尝试测试我的第一个 hello world 应用程序

```
#include <QtCore/QCoreApplication>
#include <iostream>
int main(int argc, char *argv[])
{
    QCoreApplication a(argc, argv);
    std::cout<<"hello";
    return a.exec();
} 
```

但我收到了这个错误：

> 错误 1 ​​错误 LNK1112: 模块机器类型 'x64' 与目标机器类型 'X86' 冲突 c:\Users\Kato\documents\visual studio 2010\Projects\qhelloworld\qhelloworld\QtCore4.lib(QtCore4.dll) qhelloworld

有什么帮助吗？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T18:55:11.483

您必须将项目设置中的目标更改为 x64 机器。如何做到这一点取决于您使用的 IDE。

编辑

因此，如果您使用 MSVC 2010，您需要转到 Project->Properties->Linker->Advanced，在这里您应该有目标机器。将其更改为 X64（从列表中）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T19:12:29.077

如果您使用 Visual Studio 的 Qt 插件（您确实应该这样做），那么您的 Qt 版本的体系结构和您正在编译程序的体系结构必须达成一致。

查看“Qt -> Qt Project Settings”，查看您的项目正在使用的 Qt 版本，并将其与“Project -> Properties”中的平台条目进行比较。

# database - RDBMS 密钥混淆

> ID：12554821
> 
> 赞同：1
> 
> 时间：2012-09-23T18:05:37.323
> 
> 标签：database, primary-key, rdbms, candidate-key

我对候选键、主键、最小超键有些困惑。

根据定义：

**主键**：只有一个属性，所以它必须是最小超键，它也是一个候选键（因为它的最小超键）

第一个结论：如果一个键是主键，那么它也是一个候选键和一个最小超键

以下几点我认为是真的，但我不确定。有人可以和我一起确认吗？

1.  如果它是最小超键，并不意味着它是主键。但这意味着它是候选键。

2.  如果是候选键，不一定是最小键，也不一定是主键。

结论：

1.  **主键**：只有 1 个值，可以识别整行。它也是候选键和最小

2.  **最小超键**：1 个值或字段组合可以识别整行，因此它是候选键，但不是必需的主键。但是如果取出任何一个字段，那么它就不再是钥匙了

3.  **候选键**：1 个值或字段组合可以识别整行，但不必是最小的或主要的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-24T20:34:40.227

简短的答案比您描述的要简单得多。键（也称为*候选*键或*主*键或*辅助*键或*备用*键）是最小超键。换句话说，键是一*组*属性，它们被保证是不可约唯一的，并且永远不会为空。键可能包含一个或多个属性，有时包含零属性（零属性键相对不常见，不经常讨论，但仍可用作键）。

更长的解释：

按照惯例，为方便起见，每个关系的一个键通常被指定为“主”键，这意味着它被认为具有某种特殊意义。特殊意义可以是任何东西——通常它要么是在其他关系中被引用为外键的键，要么是作为该关系的“首选”标识符的键。

然而，重要的是要理解“主”键与任何其他键基本上没有什么不同，除非您选择这样做（或者由于 DBMS 软件的限制而被迫这样做）。因此，原则上没有绝对的理由必须始终指定一个“主”键。假设每个关系至少有一个候选键（根据定义它必须），那么您不妨将这些键中的一个或多个称为“主”。然而，指定一个且仅一个主键是一个非常严格的约定，这是基于 SQL 的 DBMS 语法所支持的约定。

作为历史细节，应该注意的是，关系模型的发明者 EFCodd 最初使用术语主键来表示关系的*任何*和*所有*键，而不仅仅是一个键。然而，在现代用法中，术语候选键用于最初称为主键的内容，而“主键”的名称以我上面描述的方式使用。不幸的是，在这一点上存在很多混淆，您经常会看到声称“主”键以某种任意方式与其他候选键不同的说法。

这是 Hugh Darwen 关于钥匙主题的：

> 一个 relvar 可以有多个键，但我们只选择一个作为下划线并将其称为主键。选择是任意的，因此从逻辑的角度来看，主要的概念并不是很重要。然而，密钥的一般概念非常重要！候选键一词的含义与键完全相同（即添加候选键没有实际意义——这是由 Ted Codd 提出的，因为他将每个键都视为被提名为主键的候选键）。

[http://www.dcs.warwick.ac.uk/~hugh/M359/What-Is-a-Key.html](http://www.dcs.warwick.ac.uk/~hugh/M359/What-Is-a-Key.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-23T18:30:07.850

根据[维基百科](http://en.wikipedia.org/wiki/Candidate_key)，**候选键**是关系的最小超键，它可以由多个属性组成。

您的关系可能有多个候选键；这些候选键中的每一个*都可以*是主键 - 这些候选键中的每一个都唯一且可靠地标识您关系中的每个元组。

从这些（可能是几个）候选键中，您选择**一个**作为**主键**（基于某些要求或其他因素）。

关系只能有**一个**主键 - 但该主键*可以*由多个属性（表列）组成。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-09-04T19:01:10.603

因此，我从您的问题中得出的结论是，您对 DBMS 中通常使用的基本 3 个键（或者更确切地说是 4 个）感到困惑。我将尝试用简短易懂的语言解释它们：

1)**超级钥匙**：

可用于唯一标识表中每个元组（行）的单个属性或属性集称为超级键（可以将其视为大量的键可以称为超级键，因为可能有很多使其唯一可识别的属性组合）-但只需记住超级键**“UNIQUENESS”的一件事。**

2)**候选键（最小超级键）**：

在我们得到的所有超级键中，我们开始识别最小的键，即。它不能被进一步分解（就属性的组成而言），如果它们被破坏，我们就会失去唯一性属于候选键的类别。 - 只需记住候选键 " **UNIQUENESS" +"IRREDUCIBILITY"**的一件事。

3)**主键**：

现在从所有剩余的候选键中，我们选择一个最优化的方式来搜索表中的任何行以使其成为主键。设计师可以选择他想要从所有其他候选键中作为主键的键，但是尽管如此，它还是更喜欢遵循一些规则，例如：

A）更喜欢用数字而不是文本作为PK的键。

B）更喜欢获取数据所有者对其具有控制权的密钥。

C）更喜欢长度较短的那个。

d) 并且，如果它们碰巧存在，则更喜欢非复合键。

我希望这可以帮助您弄清楚这个概念。

# php - 用于在字符串中搜索和替换的 php 循环

> ID：12554827
> 
> 赞同：1
> 
> 时间：2012-09-23T18:06:31.377
> 
> 标签：php, loops, str-replace

嘿！这是我在这里的第一个问题，如果我没有做对，请提前道歉。

我想通过在文本中使用#pic1#（#pic2#等）在描述文本中插入来自画廊的图片并将其替换为

这是代码：

```
<?
$myString =$art[0][page_text];
$pics=mysql_query_assoc("select * from pages_galerie where id_page='".$id_page."'");
$count= count($pics);
for ($i=0; $i < $count; $i++) {
$search='#pic'.$i+1.'#';
$img=$pics[$i][pic];
$newString = str_replace($search, "<img src=".SITE_URL."pics/medium/".$img.">", $myString);
}
?> 
```

它不起作用！我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T18:11:22.647

试试这个 [http://codepad.org/2NBlkDN9](http://codepad.org/2NBlkDN9)

```
<?
$myString =$art[0][page_text];
$myString = '#pic1# #pic2#';
//$pics=mysql_query_assoc("select * from pages_galerie where id_page='".$id_page."'");
$pics = array(
   array('pic' => 'TEST1'),
   array('pic' => 'TEST2'),
   array('pic' => 'TEST3'),
);
$count= count($pics);

$newString = $myString;
for ($i=0; $i < $count; $i++) {
$search='#pic'.($i+1).'#';
$img=$pics[$i][pic];

$newString = str_replace($search, "<img src=".SITE_URL."pics/medium/".$img.">", $newString);
}
echo $newString;
?> 
```

您每次都在执行替换`$myString`并存储它。`$newString`因此，只有最后一个替换对最终输出有任何影响。我已经初始化`$newString`并`$myString`在`$newString`.

# java - 在 gradle 中将参数传递给编译器和 javadoc

> ID：12554829
> 
> 赞同：7
> 
> 时间：2012-09-23T18:06:40.187
> 
> 标签：java, javadoc, gradle, javac

我正在尝试提供 Gradle 作为现有项目的替代构建系统。该项目利用`sun.misc.Unsafe`which 导致像这样的警告：

```
warning: Unsafe is internal proprietary API and may be removed in a future release
import sun.misc.Unsafe; 
```

在当前的 ant 脚本中，为了抑制这个警告`-XDignore.symbol.file`，将其作为参数传递给 javac 和 javadoc。

为了在 Gradle 中抑制这些警告，我不得不求助于我觉得不太舒服的“肮脏”黑客。

```
apply plugin: 'java'

compileJava {
    // I only managed to get this working when I forked 
    // and passed 'javac' as an executable
    options.compilerArgs << '-XDignore.symbol.file'
    options.fork = true
    options.forkOptions.executable = 'javac'
}

javadoc {
    // These get ignored
    // options.addStringOption('XDignore.symbol.file', null)
    // options.addStringOption('XDignore.symbol.file')

    // This one fails the build - I am assuming it's trying to parse ''
    // options.addStringOption('XDignore.symbol.file')

    // This works, but it's an ugly hack
    options.addStringOption('XDignore.symbol.file', '-quiet')
} 
```

当然，必须有一种我不知道的更优雅的方式来实现这一目标。

这里 ( [https://gist.github.com/3772416](https://gist.github.com/3772416) ) 是一个更完整的示例，附带一个 ant 脚本和一个导致问题的示例类。

谢谢

我正在运行 Gradle 1.1

```
------------------------------------------------------------
Gradle 1.1
------------------------------------------------------------

Gradle build time: Tuesday, 31 July 2012 13:24:32 o'clock UTC
Groovy: 1.8.6
Ant: Apache Ant(TM) version 1.8.4 compiled on May 22 2012
Ivy: 2.2.0
JVM: 1.7.0_07 (Oracle Corporation 23.3-b01)
OS: Linux 3.2.0-30-generic amd64 
```

目前看来，这是抑制这些特定警告的合理方法。见 - [http://forums.gradle.org/gradle/topics/passing_arguments_to_compiler_and_javadoc?rfm=1](http://forums.gradle.org/gradle/topics/passing_arguments_to_compiler_and_javadoc?rfm=1)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T18:44:53.140

关于 Javadoc，以下可能有效：

```
javadoc.options.jflags "-XDignore.symbol.file" 
```

关于 Java 编译，最好知道最近的 Gradle 版本（例如 1.2）是否需要`options.fork = true`并且 `options.forkOptions.executable = 'javac'`仍然需要。如果是，请在[http://forums.gradle.org](http://forums.gradle.org)提出问题。

# sql - 即使没有人注册，也可以按课程注册

> ID：12554830
> 
> 赞同：0
> 
> 时间：2012-09-23T18:06:46.997
> 
> 标签：sql, sql-server

我有一个任务，我有点挂在 SQL Server 上，想知道是否有人可以提供帮助。

任务：
在数据库中，我需要创建一个名为 的存储过程`ClassRegistration`。此存储过程的结果集的列需要如下所示：

1.  `[Class]`– 要教授的班级名称
2.  `[Teacher Name]`- 授课人的姓名
3.  `[Registrations]`- 已注册上课的学生人数
4.  `[Number Paid]`- 已支付课程费用的学生人数

表：

1.  `[Teacher]`: `Teacher_ID`(PK),`TeacherName`
2.  `[Class]`: `Class_ID`(PK), `ClassName`, `Teacher_ID`(FK)
3.  `[ClassRegistration]` `Student_ID`(FK), `Class_ID`(FK),`HasPaidFees`
4.  `[Student]` `Student_ID`(PK),`StudentName`

即使没有人注册，学院也需要了解每一门课程。

到目前为止我的 SQL：

```
Create  PROCEDURE ClassRegistration
AS
SELECT DISTINCT 
    c.ClassName, 
    t.TeacherName, 
    COUNT(cr.Student_ID) As Registrations, 
    COUNT(case when cr.HasPaidFees = 1 then 1 else null end) As NumberPaid
FROM 
    Class As c, 
    Teacher As t, 
    ClassRegistration As cr, 
    Student As s
WHERE
    (c.Class_ID = cr.Class_ID) 
AND (cr.Student_ID = s.Student_ID)
GROUP BY c.ClassName, t.TeacherName 
```

我可以很好地创建存储过程，但输出看起来不正确，任何帮助将不胜感激:)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T18:11:20.243

如果您需要在没有注册的情况下查找课程，则需要使用[`left outer join`](http://msdn.microsoft.com/en-us/library/ms187518%28v=sql.105%29.aspx)：

```
SELECT  Distinct c.ClassName, t.TeacherName, COUNT(cr.Student_ID) As Registrations, COUNT(case when cr.HasPaidFees = 1 then 1 else null end) As NumberPaid
FROM    Class As c
INNER JOIN Teacher As t
on c.Teacher_ID = t.Teacher_ID
LEFT OUTER JOIN ClassRegistration As cr
ON (c.Class_ID = cr.Class_ID)
INNER JOIN Student As s
ON  (cr.Student_ID = s.Student_ID)
GROUP BY c.ClassName, t.TeacherName 
```

（请注意，我已将您的其他联接重写为`INNER JOIN`）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-23T18:12:26.637

没有理由加入 Student，您有 4 个表，但只有 2 个加入条件。这是[使用旧的`table,table`连接语法而不是正确的显式连接](https://sqlblog.org/2009/10/08/bad-habits-to-kick-using-old-style-joins)的缺陷之一。我也：

*   首先列出您的“内部”表格
*   `dbo.`为表引用添加前缀
*   添加`SET NOCOUNT ON`到程序中
*   删除了不必要的`DISTINCT`
*   简化`CASE`表达式

```
CREATE PROCEDURE dbo.ClassRegistration
AS
BEGIN
  SET NOCOUNT ON;

  SELECT c.ClassName, t.TeacherName, 
    COUNT(cr.Student_ID) As Registrations, 
    COUNT(NULLIF(cr.HasPaidFees, 0)) As NumberPaid
  FROM dbo.Class As c
  INNER JOIN dbo.Teacher As t
  ON t.Teacher_ID = c.Teacher_ID
  LEFT OUTER JOIN dbo.ClassRegistration As cr
  ON c.Class_ID = cr.Class_ID
  GROUP BY c.ClassName, t.TeacherName;
END
GO 
```

# android - ViewPager中如何在每个页面上显示不同的文字，instantiateItem()混淆

> ID：12554831
> 
> 赞同：1
> 
> 时间：2012-09-23T18:06:54.760
> 
> 标签：android, android-viewpager

在 ViewPager 的 CustomPagerAdapter 中，在 instantiateItem() 方法中，我尝试创建一个 TextView，然后根据特定条件为每个页面设置不同的文本。文本从页面光标中读取。这是一个代码：

```
@Override
public Object instantiateItem(ViewGroup collection, int position) {

sc = new ScrollView(context);
sc.setLayoutParams(new LayoutParams(LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT));
sc.setFillViewport(true);
tv = new TextView(context);

if(position < count) {
  tv.setText(pages.getString(1));   
  pages.moveToPosition(position);

}else {
  tv.setText("LOCKED");
}          

  tv.setTag(TAG_PAGE + position);

  tv.setGravity(Gravity.CENTER);
  tv.setTextColor(Color.BLACK);
  tv.setTextSize(30);
  sc.addView(tv);

  ((ViewPager) collection).addView(sc);

  return sc;            
} 
```

但是 ViewPager 的行为并不像预期的那样。第一页和第二页具有相同的文本，其余页面按预期具有“锁定”标志。当我滑入第四页并返回第一页时，第一页包含假定在第二页中的文本。我也尝试使用 myViewPager.setOffscreenPageLimit(numberOfPages) 但它没有帮助。

我找到了这个答案：

"instantiateItem里面，position参数是需要渲染的位置，不是用户看到的当前焦点item的位置，当前显示的view左右的页面需要pre在内存中渲染，以便那些屏幕的动画将是平滑的。”

这对我来说很有意义，但是我怎样才能正确显示页面内容，然后在需要时更新它？请告知是否有不同的方法可以跳过 instantiateItem() 方法，这会给问题带来混乱和混乱。谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T21:09:42.240

我通过使用不同的实现解决了这个问题：

```
// Adapter class
private static class MyFragmentPagerAdapter extends FragmentPagerAdapter {
public MyFragmentPagerAdapter(FragmentManager fm)   {
    super(fm);
}

@Override
public Fragment getItem(int index) {
    return PageFragment.newInstance(pages[index]);  // Pages is an array of Strings
    }

@Override
public int getCount() {
    return numberOfPages;
    }
}

// PageFragment class
public class PageFragment extends Fragment {

TextView tv;

public static PageFragment newInstance(String page) {
    PageFragment pageFragment = new PageFragment();
    Bundle bundle = new Bundle();
    bundle.putString("pageContent", page);
    pageFragment.setArguments(bundle);

    return pageFragment;
}

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
}

@Override
public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState)   {
    View view = inflater.inflate(R.layout.fragment, container, false);
    tv = (TextView) view.findViewById(R.id.text_view);
    tv.setText(getArguments().getString("pageContent"));

    return view;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-14T18:07:45.450

您可以创建 ViewPager 对象，然后在此对象上设置侦听器。

```
 ViewPager myPager = (ViewPager) findViewById(R.id.yourPagerid);
            myPager.setAdapter(adapter);
                 myPager.setCurrentItem(0);

                    myPager.setOnPageChangeListener(new OnPageChangeListener() {

        @Override
        public void onPageSelected(int position) {
                      //You can change textview word according to current page

            switch (position) {
            case 0:

                break;
            case 1:

                break;
            case 2:

                break;
            }
        }

        @Override
        public void onPageScrolled(int arg0, float arg1, int arg2) {
            // Log.d("check","onPageScrolled");

        }

        @Override
        public void onPageScrollStateChanged(int arg0) {
            // Log.d("check","onPageScrollStateChanged");

        }
    }); 
```

# php - 我基于 PHP 的网站上的 Node.JS 通知

> ID：12554832
> 
> 赞同：4
> 
> 时间：2012-09-23T18:06:59.280
> 
> 标签：php, node.js, socket.io

我正在用 PHP 开发一个网站。现在，我想简单地添加一个通知系统。想象它就像 Facebook 的友谊：当我收到好友请求时，我也会收到通知。

我当然知道一点 Node.JS 和 Socket.IO，但棘手的部分似乎是 PHP 的实现。

到目前为止，我的想法是：

```
1\. user sends friend request
2\. in my PHP code, I cURL my Node.JS service: "/notification?friendid=9634963478"
3\. user with id 9634963478 should get a notification 
```

我面临的问题是：

如何在 Node.js 上使用相同的凭据“登录”？这样基本上除了我之外没有其他用户可以收到消息？

我不是在寻找代码，而是从那里的某个大师那里获得“启蒙”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T22:29:10.023

在您的 nodejs 应用程序中使用相同的会话存储后端并传递 cookie，它必须位于相同的子域上，例如 msg.example.com，其中 cookie 由 .example.com 上的 php 层设置

看`express.session`——这是一个使用redis的例子：

```
 var RedisStore = require('connect-redis')(express);

      app.use(express.session({
        store: new RedisStore({
          host: cfg.redis.host,
          db: cfg.redis.db
        }),
        secret: 'foobar'
      })); 
```

关于使用会话的视频：http: [//nodetuts.com/tutorials/13-authentication-in-express-sessions-and-route-middleware.html](http://nodetuts.com/tutorials/13-authentication-in-express-sessions-and-route-middleware.html)

# android - 通过 SQL 加入 Android 联系人表/数据库？

> ID：12554834
> 
> 赞同：0
> 
> 时间：2012-09-23T18:07:19.673
> 
> 标签：android, sqlite, contacts

我需要获取手机上的所有联系人及其关联的电话号码，因此我需要加入 Android 存储在其内部 contacts.db 中的一些联系人表。我认为仅通过 SQL 语句加入数据比使用所有内容提供者的东西要容易得多，或者有什么方法可以加入这些数据？另外，如果我写一个 SQL 语句，表名和字段是否有任何常量，以便我可以保持查询至少有点通用，这样它就不会在下一次 Android 更新时中断，以防它们发生变化表名？感谢您的任何提示！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-24T07:06:35.763

您可以[编写自己的内容提供程序来执行 join](https://stackoverflow.com/questions/6338802/can-i-perform-this-android-query-with-contentresolver-query-left-join-and-ca/6548733#6548733)，但无论如何您都将使用自己的 SQL 查询。

内置的联系人提供程序有几个[记录在案的列名](http://developer.android.com/guide/topics/providers/contacts-provider.html#RawContactBasics)。
表名似乎是一个实现细节，但如果它们发生变化，语义很可能也会发生变化，因此您的自定义查询无论如何都会中断。

# gridview - 如何在 ASP.net 的 Gridview 上显示会员信息和个人资料

> ID：12554835
> 
> 赞同：0
> 
> 时间：2012-09-23T18:07:28.440
> 
> 标签：gridview, asp.net-membership, asp.net-profiles

我可以在 Gridview 中显示用户配置文件的信息，但我无法显示用户的电子邮件。请在我的代码下方看到：

```
<asp:GridView ID="GridUser" runat="server" CellPadding="4" ForeColor="#333333" 
    GridLines="None" AutoGenerateColumns="False">
    <AlternatingRowStyle BackColor="White" />
    <Columns>
        <asp:BoundField DataField="FirstName" HeaderText="First Name" />
        <asp:BoundField DataField="LastName" HeaderText="Last Name" />
        <asp:BoundField DataField="UserName" HeaderText="UserName" />
        <%--<asp:BoundField DataField="EMail" HeaderText="E-Mail Address" />--%>
    </Columns>
</asp:GridView> 
```

在代码隐藏中：

```
List<object> profileList = new List<object>();
MembershipUserCollection muc = Membership.GetAllUsers();
foreach (MembershipUser mu in muc)
{
    profileList.Add(Profile.GetProfile(mu.UserName));         
}
GridUser.DataSource = profileList;
GridUser.DataBind(); 
```

现在，如何在 Gridview 中显示用户的电子邮件和用户的个人资料？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T18:15:08.283

创建您自己的从 MembershipUser 继承的实体，并通过添加将保存配置文件信息的属性来扩展它。填充新实体，然后将其绑定到 GridView。这是最干净的方法。

# android - “新的 ArrayAdapter （此“在对话框中使用时出错 null 异常

> ID：12554842
> 
> 赞同：0
> 
> 时间：2012-09-23T18:07:59.990
> 
> 标签：android, android-listview, nullpointerexception, android-arrayadapter, android-dialog

嗨，我一直在处理一个对话框，我需要在对话框中添加一个 ListView。问题是我不能使用 "this" "new ArrayAdapter(this"

有人能帮我吗？

```
ListView dialog_ListView = (ListView)dialog.findViewById(R.id.list);

ArrayAdapter<String> adapter = new ArrayAdapter<String>(this,android.R.layout.simple_list_item_1, comment11);

dialog_ListView.setAdapter(adapter); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T08:31:02.743

也许这种解决方法可以帮助您：

```
ListView dialog_ListView = (ListView)dialog.findViewById(R.id.list);

ArrayAdapter<String> adapter = new ArrayAdapter<String>(dialog_ListView.getContext(),android.R.layout.simple_list_item_1, comment11);

dialog_ListView.setAdapter(adapter); 
```

# c# - HtmlHelper 通用反射 - 获取非基于模型的表达式的元数据

> ID：12554851
> 
> 赞同：0
> 
> 时间：2012-09-23T18:08:34.787
> 
> 标签：c#, asp.net-mvc, reflection, data-annotations, linq-expressions

我有一个基于模型的`DescriptionFor`助手，如下所示：

```
public static HtmlString DescriptionFor<TModel, TProperty>(
    this HtmlHelper<TModel> htmlHelper,
    Expression<Func<TModel, TProperty>> expression) where TModel : class
{
    var metaData = ModelMetadata.FromLambdaExpression(expression, htmlHelper.ViewData);
    return new HtmlString(metaData.Description.ToStringOrEmpty());
} 
```

这会关闭`DataAnnotations.DisplayAttribute`（特别是`Description`参数）并且它可以流畅地工作。

我现在有一个案例，我的模型有一个`IEnumerable<foo>`我正在循环的模型，并且每个枚举成员`foo`都有一个带有s 的枚举。`DisplayAttribute`大多数（但不是全部）`DisplayAttribute`属性都提供了一个`Description`属性，我想在我的循环中公开它，如下所示：

```
@foreach(var fooObject in Model.foos){ 
    @Html.Description(fooObject, x=>x.fooEnumVal)
} 
```

...这将显示每个`foo`对象的枚举值描述。

我很快发现它与模型助手不太相似。有人可以为此指出正确的方向吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T20:38:49.110

您可以使用 for 循环而不是 foreach 并使用您的助手获取描述

```
@for(int i =0; i < Model.foos.Count(); i++){ 
    @Html.Description(x => x.foos[i].fooEnumVal)
} 
```

您还可以创建新的辅助方法，该方法将为指定模型创建新的 viewdatadictionary 并获取属性的元数据（我没有检查它，但它应该可以工作:)）

```
public static HtmlString DescriptionFor<TModel, TProperty>(this HtmlHelper<TModel> htmlHelper, TModel model, Expression<Func<TModel, TProperty>> expression) 
            where TModel : class
        {
            var metaData = ModelMetadata.FromLambdaExpression(expression, new ViewDataDictionary<TModel>(model));
            return new HtmlString(metaData.Description.ToStringOrEmpty());
        } 
```

希望能帮助到你

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T22:15:59.340

我最终做了这样的事情：

```
public static HtmlString DescriptionFor(this Enum theEnum)
{
    var theEnumType = theEnum.GetType();

    //the enum must inherit from Enum, but not actually *be* Enum.
    if (!(theEnum is Enum) || theEnumType.Equals(typeof(Enum))) throw new ArgumentException("Not a valid Enumeration.");

    var fi = theEnumType.GetField(theEnum.ToString());
    var displayAttribute = ((DisplayAttribute[])fi.GetCustomAttributes(typeof(DisplayAttribute), false))
        .FirstOrDefault();

    if (displayAttribute == null) return new HtmlString(theEnum.ToString());

    return new HtmlString(displayAttribute.Description ?? theEnum.ToString());
} 
```

我确信这不是最好的方法，但我能够有效地写出我的观点：

```
@fooObject.enumVal.DescriptionFor() 
```

其表现如我所愿。

# url - facebook open graph recipe action not working

> ID：12554853
> 
> 赞同：0
> 
> 时间：2012-09-23T18:08:36.197
> 
> 标签：url, facebook-graph-api

I have experienced a problem with facebook open graph (the cook action and recipe object).here is my url [http://www.webcoachbd.com/tester.html](http://www.webcoachbd.com/tester.html) When i click "Cook" it shows an alert "Error occurred [object Object]". I have seen the related topics and tried those,but problem not solved. This is my tester.html

```
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en-US"
  xmlns:fb="https://www.facebook.com/2008/fbml"> 
 <head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# rejoanxxxx: http://ogp.me/ns/fb/rejoanxxxx#">
<meta property="fb:app_id" content="12xxx" /> 
<meta property="og:type"   content="rejoanxxxx:recipe" /> 
<meta property="og:url"    content="http://www.webcoachbd.com/tester.html" /> 
<meta property="og:title"  content="Sample Recipe" /> 
<meta property="og:image"  content="http://www.webcoachbd.com/images/animl136.jpg" /> 

<script type="text/javascript">
function postCook()
{
  FB.api(       '/me/rejoanxxxx:cook?recipe:http://www.webcoachbd.com/tester.html',
    'post',
    function(response) {
       if (!response) {
          alert('Error occurred : No Response');
       } else if (response.error) {
          alert('Error occurred : ' + response.error);
       } else {
          alert('Cook was successful! Action ID: ' + response.id);
       }
    });
}
</script>
</head>
<body>
<div id="fb-root"></div>
<script>
window.fbAsyncInit = function() {
  FB.init({
    appId      : '[123xxxxxxxx]', // App ID
    status     : true, // check login status
    cookie     : true, // enable cookies to allow the server to access the session
    xfbml      : true  // parse XFBML
  });
};

// Load the SDK Asynchronously
(function(d){
  var js, id = 'facebook-jssdk'; if (d.getElementById(id)) {return;}
  js = d.createElement('script'); js.id = id; js.async = true;
  js.src = "//connect.facebook.net/en_US/all.js";
  d.getElementsByTagName('head')[0].appendChild(js);
}(document));
</script>

<h3>Stuffed Cookies</h3>
<p>
<img title="Stuffed Cookies" 
     src="http://www.webcoachbd.com/images/animl136.jpg" 
     width="550"/>
</p>

<br>
<form>
<input type="button" value="Cook" onclick="postCook()" />
</form> 
```

and application basic setting is App Domains:webcoachbd.com Site URL:http://webcoachbd.com

I check my url (http://www.webcoachbd.com/tester.html) with facebook debugger,do not show any error or warning. Is there are any solution to this problem?Please help.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-24T10:06:20.827

You have used a colon (:) instead of an equals sign (=) when posting.

**Change this:** /me/rejoanxxxx:cook?recipe**:**http...
**To this:** /me/rejoanxxxx:cook?recipe**=**http...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-24T08:13:49.647

> When i click "Cook" it shows an alert "Error occurred [object Object]".

The alert method can not display object structures, so you just get `[object Object]` in that debug attempt.

Use `console.log(response.error)` instead, and then have a look into your browser’s JavaScript console to see what the actual error is.

# android - 在弹出窗口之外单击以将其关闭

> ID：12554855
> 
> 赞同：2
> 
> 时间：2012-09-23T18:08:45.527
> 
> 标签：android

> **可能重复：**
> [如何通过单击对话框外部来关闭对话框？](https://stackoverflow.com/questions/8384067/how-to-dismiss-the-dialog-with-click-on-outside-of-the-dialog)

如何在弹出窗口之外单击以将其关闭？

这是我的代码：

```
cell.setOnClickListener(new OnClickListener(){

    /*This code is in a separate class so I needed to use ctx as context 
    *and the string "layout_inflater" because it was not recognizing 
    *LAYOUT_INFLATER_SERVICE*/

    @Override
    public void onClick(View arg0) {LayoutInflater layoutInflater  = 
    (LayoutInflater)ctx.getSystemService("layout_inflater");  
    View popupView = layoutInflater.inflate(R.layout.popup_window, null); 
    final PopupWindow popupWindow = new PopupWindow(popupView, 
          LayoutParams.WRAP_CONTENT,  LayoutParams.WRAP_CONTENT);
    popupWindow.showAtLocation(newParentLayout, Gravity.CENTER, 0, 0); 
    } 
```

我也尝试添加所有这些但没有结果。

```
 popupWindow.setTouchable(true);
 popupWindow.setFocusable(true);
 popupWindow.setOutsideTouchable(true);
 Drawable bg = ctx.getResources().getDrawable(R.drawable.popup_bg);
 popupWindow.setBackgroundDrawable(bg); 
```

我没主意了。有什么帮助吗？

编辑添加：主布局是 ViewPager/PagerAdapter 如果这会影响什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-23T18:19:33.163

请与背景一起设置 setOutsideTouchable(true)。这对我来说很好。我知道将背景可绘制对象设置为 null 会杀死 OnTouchListener。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T18:52:08.750

试试这个方法。

```
 cell.setOnClickListener(new OnClickListener() {

        @Override
        public void onClick(View v) {

            LayoutInflater layoutInflater  = 
                (LayoutInflater)ctx.getSystemService("layout_inflater");  
                View popupView = layoutInflater.inflate(R.layout.popup_window, null); 
                final PopupWindow popupWindow = new PopupWindow(ctx);

                popupWindow.setFocusable(true);
                popupWindow.setContentView(popupView);
                popupWindow.showAtLocation(b, Gravity.CENTER, 0, 0); 
                popupWindow.update(100, 100, 150, 150);
        }
    }); 
```

# c++ - 鼠标事件不会传递给 QGraphicsItemGroup 中添加的 QPushButton

> ID：12554862
> 
> 赞同：1
> 
> 时间：2012-09-23T18:09:15.463
> 
> 标签：c++, qt

我在 Windows 7 Ultimate x64 上使用 Qt 4.8.3（32 位）。

在`QGraphicsScene`子类的构造函数中，我有：

```
QGraphicsItemGroup *point_table = new QGraphicsItemGroup;
addItem(point_table); 
```

稍后在构造函数中：

```
QPushButton *button = new QPushButton("Call++");
QGraphicsProxyWidget *inc_button = addWidget(button);
connect(button, SIGNAL(clicked()), this, SLOT(onCallIncrease())); 
```

`onCallIncrease()`每当单击按钮时都会调用。但是，如果我添加`inc_button`到`point_table`,`onCallIncrease()`不会被调用。

```
QPushButton *button = new QPushButton("Call++");
QGraphicsProxyWidget *inc_button = addWidget(button);
point_table->addToGroup(inc_button);
connect(button, SIGNAL(clicked()), this, SLOT(onCallIncrease())); // doesn't work 
```

即使我手动设置为接受鼠标左键：

```
QPushButton *button = new QPushButton("Call++");
QGraphicsProxyWidget *inc_button = addWidget(button);
inc_button->setAcceptedMouseButtons(Qt::LeftButton);
point_table->setAcceptedMouseButtons(Qt::LeftButton);
point_table->addToGroup(inc_button);
connect(button, SIGNAL(clicked()), this, SLOT(onCallIncrease())); // doesn't work 
```

`onCallIncrease()`鼠标左键点击不会被调用。为什么会这样？

# php - 批量 bit.ly 创建者

> ID：12554863
> 
> 赞同：0
> 
> 时间：2012-09-23T18:09:29.237
> 
> 标签：php, mysql, ajax, file-get-contents

我正在尝试使批量 bit.ly 更短，从 txt 文件中读取链接列表输出缩短的链接

问题是我不知道该怎么做，如果你太快地建立链接，bit.ly 有一个 api 限制。我发现如果你每秒创建 5 个链接，它应该可以工作。

如何一次缩短 1200 个链接？

```
 <?php

    $sites = array(   
    'http://api.bit.ly/shorten?version=2.0.1&login=bitlyexample&apiKey=R_8b726077f3d5c6029700c29e529395d3&format=text&longUrl=http://link2.com',
    'http://api.bit.ly/shorten?version=2.0.1&login=bitlyexample&apiKey=R_8b726077f3d5c6029700c29e529395d3&format=text&longUrl=http://link1.com',
    );

    foreach ( $sites as $site ) {
        $shortened_url = file_get_contents($site);
        if($shortened_url)
            echo "$shortened_url <br/>";
    }
    die();
    ?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T18:13:02.980

在 5 个链接休眠 5 秒后使用`sleep()`（或 API 状态的秒数）：

```
<?php

$sites = array(   
'http://api.bit.ly/shorten?version=2.0.1&login=bitlyexample&apiKey=R_8b726077f3d5c6029700c29e529395d3&format=text&longUrl=http://link2.com',
'http://api.bit.ly/shorten?version=2.0.1&login=bitlyexample&apiKey=R_8b726077f3d5c6029700c29e529395d3&format=text&longUrl=http://link1.com',
);
$i = 0;
foreach ( $sites as $site ) {
    $shortened_url = file_get_contents($site);
    if($shortened_url) {
        echo "$shortened_url <br/>";
    }
    $i++;
    if($i%5 == 0){
         sleep(5);
    }
}
die();
?> 
```

# xcode - 在 StatusBar 应用程序中隐藏 NSView

> ID：12554864
> 
> 赞同：1
> 
> 时间：2012-09-23T18:09:39.327
> 
> 标签：xcode, nsview, statusbar

我的状态栏应用程序中有一个小的 NSView（HUD 样式）。如果我做对了，这个 NSView 没有超级视图。

我的问题是我只想在某些编程情况下显示此视图。

显示或隐藏此视图的最佳方式是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T18:20:18.650

一种方法是在无边框透明窗口 (NSBorderlessWindowMask) 中显示此视图。

# javascript - 如何在 MySQL 中使用 HTML5 Datalist

> ID：12554866
> 
> 赞同：2
> 
> 时间：2012-09-23T18:10:02.647
> 
> 标签：javascript, php, mysql, html, html-datalist

HTML5 引入了新的标签`datalist`，它连接到`<input list="datalistID">`提供自动完成功能。

问题是 - 将此数据列表建议连接到具有大量行（假设为 50K）的 MySQL 表的最佳方法是什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T19:17:38.223

连接它的最佳方法是通过`data`属性或`<datalist>`标签，它采用任何 URI 或 IRI 来获取 XML 格式的数据。

然后，您可以根据输入值更改 URI/IRI。而且你应该将你的结果集限制在一个有用的最大行数，你不想仅仅为了自动完成而传输兆字节。

# java - 为什么 Java 不打印行中的所有单词（将单词添加到 ArrayList 时）？

> ID：12554870
> 
> 赞同：2
> 
> 时间：2012-09-23T18:10:49.080
> 
> 标签：java, arraylist, println

当将用户输入打印为一行中的单个单词时，我会打印出该行中的所有单词。

```
System.out.println(userInput.next()); 
```

但是，当我将单个单词添加到 ArrayList 时，我似乎得到了随机单词：

```
 al.add(userInput.next()); 
```

有人可以向我解释发生了什么吗？

谢谢。

这是代码的完整副本：

```
import java.util.*;

public class Kwic {
    public static void main(String args[]){

        Scanner userInput = new Scanner(System.in);
        ArrayList<String> al = new ArrayList<String>();

        while(userInput.hasNext()){
            al.add(userInput.next());
            System.out.println(userInput.next());
        }

    }
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-23T18:12:13.590

```
while(userInput.hasNext()){
    al.add(userInput.next());   //Adding userInput call to ArrayList
    System.out.println(userInput.next());  //Printing another userInput call
} 
```

您**没有**打印存储在 ArrayList 中的值，但实际上是对 userInput.next() 的另一个调用

**修订**

@Sheldon这对我有用**。**

```
public static void main(String[] args) {
    Scanner userInput = new Scanner(System.in);
    ArrayList<String> al = new ArrayList<String>();
    while(userInput.hasNext()){
        al.add(userInput.next());
        System.out.println(al);  //LINE CHANGED FROM YOUR QUESTION
    }

} 
```

我用输入测试了你的代码 `1 2 3 4 5 6 7 8 9 0`

然后我按回车并得到：

`2 4 6 8 0`

userInput.next() 在添加到 ArrayList 的那个和你的 System.out.println 捕获的那个之间交替

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-23T18:15:18.563

因为[`next()`](http://docs.oracle.com/javase/7/docs/api/java/util/Scanner.html#next%28%29)消耗了扫描仪的*下一个*令牌。因此，当您有：

```
 al.add(userInput.next());
        System.out.println(userInput.next()); 
```

您实际上正在使用扫描仪中的*两个*令牌。第一个被添加到 中`ArrayList`，*另一个*被打印到`System.out`. 一种可能的解决方案是将令牌存储在局部变量中，然后将其添加到数组中并打印：

```
 while (userInput.hasNext()) {
        String token = userInput.next();
        al.add(token);
        System.out.println(token);
    } 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-23T18:13:38.430

我会这样写：

```
import java.util.*;

public class Kwic {
    public static void main(String args[]){

        Scanner userInput = new Scanner(System.in);
        List<String> al = new ArrayList<String>();

        while(userInput.hasNext()){
                al.add(userInput.next());
        }
    System.out.println(al);

    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-23T18:14:00.890

将所有值存储到第一个值中`ArrayList`，*然后将*它们打印出来对您来说会更有益。你现在正在做的是打印另一个调用`userInput.next()`，它可能存在也可能不存在。

```
while(userInput.hasNext()){
    al.add(userInput.next());
}

for(String s : al) {
    System.out.println(s);
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-23T18:15:22.003

```
al.add(userInput.next());   //Adding an Item call to ArrayList

System.out.println(userInput.next()); //Printing the next userInput with a call** 
```

**试试这个来打印 ArrayList 中的值**

```
for(String s : al){

     System.out.println(s);

 } 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-23T18:19:43.877

不仅您没有打印该行中的所有单词，您也没有将所有单词添加到`ArrayList`. 因为您编码的方式，它将每个替换词添加到`ArrayList`并打印替换词。

# javascript - 树形图：一页上多个

> ID：12554871
> 
> 赞同：0
> 
> 时间：2012-09-23T18:10:49.253
> 
> 标签：javascript, d3.js, tree-structure

我正在尝试将 2 个 d3.js 树图放在此处[http://bl.ocks.org/1249394](http://bl.ocks.org/1249394) 在一页上。两棵树都将加载来自 Javascript 对象的不同数据。第一个将出现在：

```
<div id="chart"></div> 
```

第二棵树将被加载到：

```
<div id="chart2"></div> 
```

#chart 和 #chart2 都在同一页面上，第一棵树 (#chart) 出现在页面顶部，第二棵树 (#chart2) 位于其下方，因为这就是图表 div 的排列方式。为此，我两次应用了来自[http://bl.ocks.org/1249394的相同代码。](http://bl.ocks.org/1249394)每个 div 一个，两段代码之间的唯一区别是树的位置，即树 1:#chart 和树 2:#chart2。

树1：

```
var vis = d3.select("#chart").append("svg:svg") 
```

树2：

```
var vis = d3.select("#chart2").append("svg:svg") 
```

其他一切都保持不变，包括变量和函数名称。这很好用，两个图表都按原样显示，除了 click 函数（代码中的最后一个函数：）只有第二棵树能够在点击树节点时折叠和展开，第一棵树不再能够这样做这个，第一个不再是交互的。

我该如何解决？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T19:24:12.197

`vis`当您绘制交互依赖的第二棵树时，您正在覆盖变量。如果要创建多个图表，则需要创建一个闭包，以便每棵树都在自己的范围内。这样他们就不会互相干扰。

[Mike 在http://bost.ocks.org/mike/chart/](http://bost.ocks.org/mike/chart/)上写了一篇关于创建可重用图表的好文章。他介绍了如何创建封闭和曲面属性。

# php - 在 PHP 5.4.4 中启用严格的错误报告

> ID：12554877
> 
> 赞同：-1
> 
> 时间：2012-09-23T18:11:33.683
> 
> 标签：php, session

我在本地主机上工作。我有 php 5.4.4。我刚刚在 php.net 上读到，从 5.4 版开始，E_STRICT 成为 E_ALL 的一部分。

所以，我在我的 php.ini 文件中看到了这个。

```
error_reporting = E_ALL 
```

所以，我认为，这是最严格的错误报告模式。所以，我故意犯了一个错误，看看这是否有效。

我将 $_SESSION 键设置为以我的代码中的数值开头。没有错误报告。该程序只是运行不正确。

我还设置了：`display_errors = On`

所以，我假设当脚本运行时，我的浏览器会报告任何错误。但是，什么也没有发生。

其中一位 Stackoverflow.com 会员正在检查我的代码并发现了错误，因为他的浏览器报告了错误。但是，在我的身上什么也没有发生。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T18:18:59.607

您可能已将 PHP 配置为不将错误输出到屏幕，而是将它们记录到日志文件中。

也就是说，您将[display_errors](http://php.net/manual/en/errorfunc.configuration.php#ini.display-errors)设置为`false`，并将[log_errors](http://php.net/manual/en/function.error-log.php)设置为`true`。

这是生产网站的常见配置，不是将错误回显到屏幕（这可能会为攻击者泄露重要信息），而是将它们写入 Web 服务器日志。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T18:20:13.993

我建议您安装一个全局错误处理程序，并在那里进行一些格式化，以获得一个不错的结果：

```
 set_error_handler( 'error_handler' );

  function error_handler( $errno, $errmsg, $filename, $linenum, $vars )
  {    
    // error was suppressed with the @-operator
    if ( 0 === error_reporting() )
      return false;

    printf( "Unrecoverable error in `%s' line %s: %s\n\n", $filename, $linenum, $errmsg );

    exit( $errno );
  } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-23T18:21:57.587

这个问题有点难以追踪。如果您想查看带有显示错误的实际错误消息，则必须牢记以下几点：

该[`display_errors`指令](http://php.net/manual/en/errorfunc.configuration.php#ini.display-errors)仅在它可以输出到某些显示器时才起作用。

通常，当您的脚本已经完成并且不再有与之关联的输出时，会话会保存在磁盘上。

因此，您无法使用该设置使以下通知可见：

> 注意：未知：在第 0 行的未知中跳过数字键 0

第*0 行的 Unknown*表示这不是正常的 PHP 代码。只是当 PHP 引擎关闭并保存会话数据时。

因此*，**除非*：_

 **   您跟踪错误日志或使用在关闭阶段仍有输出的 CLI 环境 (STDOUT)
*   您可以`session_write_close()`在脚本仍在运行时编写会话：

> 注意： session_write_close(): 在第 12 行跳过数字键 0 ...

希望这有助于并完全澄清它。*

# r - 如何将属于不同data.frame的同名列相乘

> ID：12554879
> 
> 赞同：0
> 
> 时间：2012-09-23T18:11:58.910
> 
> 标签：r

我有一个问题......我有两个数据。具有很多列的帧，这两个 data.frames 的长度不同，实际上一个有很多行，第二个 data.frame 只有一行....但是在两个数据帧中都有相同名称的列。现在，我想将匹配的列相互相乘。我无法解决它。请帮我。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-23T18:15:23.243

命令

```
mapply("*", DataFrame1, DataFrame2) 
```

如果您想将所有列相乘，应该可以工作。如果相关列只是数据框中所有列的子集，我们首先需要识别两个数据框中都存在的列。

```
mapply("*", DataFrame1[intersect(names(DataFrame1), names(DataFrame2))],
       DataFrame2[intersect(names(DataFrame1), names(DataFrame2))]) 
```

# android - Android保存自定义对象数组

> ID：12554880
> 
> 赞同：8
> 
> 时间：2012-09-23T18:11:59.853
> 
> 标签：android, object, arraylist, save

我有一个关于保存自定义对象数组列表的问题。我有一个名为 notiti 的课程：

```
public class Notitie implements Serializable{

private String titel = "";
private String type = "";
private String datum = "";

public void setTitel (String titel){
    this.titel = titel;
}
public String getTitel(){
    return titel;
}
public void setType (String type){
    this.type = type;
}
public String getType(){
    return type;
}
public void setDatum (String datum){
    this.datum = datum;
}
public String getDatum(){
    return datum;
}
} 
```

我创建了一些 Notitie 对象并将它们添加到我的名为 notities 的数组列表中

```
ArrayList<Notitie> notities = new ArrayList<Notitie>();

Notitie notitie1 = new Notitie();
notitie1.setTitel("Meting");
notitie1.setType("Watermeting");
notitie1.setDatum("22-09-12");
notities.add(notitie1);

Notitie notitie2 = new Notitie();
notitie1.setTitel("Meting2");
notitie1.setType("Watermeting2");
notitie1.setDatum("23-09-12");
notities.add(notitie2);

Notitie notitie3 = new Notitie();
notitie1.setTitel("Meting3");
notitie1.setType("Watermeting3");
notitie1.setDatum("24-09-12");
notities.add(notitie3); 
```

现在我想将填充的 Arraylist 保存在设备的存储中，以便随时访问它。我曾经将数据保存为字符串或一些带有共享首选项的整数，但我不能用它保存这个 Arraylist。有人有解决方案吗？

提前致谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-23T19:17:34.230

你确实有几个选择：

1.  使用序列化、XML 或 JSON，并将数据存储在文件中。如果您想实现序列化，请参阅[此解决方案。](https://stackoverflow.com/questions/4393889/how-can-i-store-an-arraylist-of-custom-objects)

2.  使用 SQLite 存储数据。查看[本教程](http://www.codeproject.com/Articles/119293/Using-SQLite-Database-with-Android)以开始使用。

**编辑：**您可能也想阅读[此](https://stackoverflow.com/questions/3580351/what-is-the-best-way-to-save-the-contents-of-an-arraylist)内容！

# javascript - Tinymce 双击插入新段落

> ID：12554881
> 
> 赞同：3
> 
> 时间：2012-09-23T18:12:00.337
> 
> 标签：javascript, tinymce

如果我有 2 个表格直接在彼此下方，边距底部，是否不可能通过创建一个临时段落将光标放在这个间隙中。

例如，我想在其他 2 之间插入一个新表。如果不直接更改 HTML，这是不可能的。

是否可以使用[双击](http://www.tinymce.com/wiki.php/API3%3aevent.tinymce.Editor.onDblClick)，使其与 MS word 类似，并在您单击的该区域创建一个空白段落，然后将其替换为表格等，类似于尾随插件的工作方式。

我目前使用' [trailing](http://sourceforge.net/tracker/?func=detail&aid=2818358&group_id=103281&atid=738747) '插件，它在页面底部修复了这个类似的问题。

我也在使用 jquery 版本的 tinymce，如果这样可以更容易地解决这个问题。

**tinymce 编辑器中的示例 HTML；**

```
<table style="margin: 15px 0; width: 100%;">
    <thead>
        <tr>
            <th scope="col">
                Product Name</th>
            <th scope="col">
                Description</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>Large product</td>
            <td><a href="http://example.com">Find out more</a></td>
        </tr>
        <tr>
            <td>Large product</td>
            <td><a href="http://example.com">Find out more</a></td>
        </tr>
    </tbody>
</table>
<table style="margin: 15px 0; width: 100%;">
    <thead>
        <tr>
            <th scope="col">
                Product Name</th>
            <th scope="col">
                Description</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>Large product</td>
            <td><a href="http://example.com">Find out more</a></td>
        </tr>
        <tr>
            <td>Large product</td>
            <td><a href="http://example.com">Find out more</a></td>
        </tr>
    </tbody>
</table> 
```

还创建了一个带有示例的 jsFiddle：http://fiddle.tinymce.com/Sicaab/2[我](http://fiddle.tinymce.com/Sicaab/2)希望能够在两个表之间插​​入额外的内容（段落、另一个表、列表等），而无需编辑 HTML。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T11:41:06.457

鼠标位置对您没有帮助，因为您不知道编辑器内容是否已滚动。

首先，我将向您展示如何使用 onDblClick。

这是一个有用的函数来获取编辑器 html 元素的段落（如果没有 html 元素未堆叠在段落下方（或更好）。

```
function table_of_click(node)
{
    while (node)
    {
      if (node.nodeName == 'BODY') { return null; }
      if (node.nodeName == 'TABLE')    { return node; }
      else { node = node.parentNode; }
    }
    return null;
}; 
```

这是捕获双击事件的必要调用。请注意，此解决方案将在您单击的段落之前添加一个段落。我假设您的表格每个都在一个段落中？

```
ed.onDblClick.add(function(ed, evt){

  // get tableof click event
  var table = table_of_click(evt.target);

  // if the click has not been inside a table return (nothing to do)
  if (!table) return;

  $(table).before("<p id='new_p'><br></p>");
  ed.selection.select( $(ed.getBody()).find('#new_p').get(0) );

  $('.new_p:first').remove();
  evt.preventDefault();
  evt.stopPropagation();
  return false;
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T13:20:42.020

有一种方法可以将插入符号（文本光标）位置放入
[textarea 中的文本插入符号位置，从一开始就以字符表示，](https://stackoverflow.com/questions/263743/how-to-get-caret-position-in-textarea#answer-263796)
这只是一个函数`getCaret(element);`

现在我们需要在 iframe 中捕获 tinymce 容器的主体`content_ifr`
iframe：`document.getElementById("content_ifr")`
tinymce 的主体：`...contentDocument.getElementById("tinymce")`

使用 jquery 我们监听`dblclick`事件：
`.dblclick(function(event){})`
找到插入符号并在其位置注入一个`<p>`元素。
`html.substr(0,position)+"<p></p>"+html.substr(position)`
即从开始到位置的所有文本，p元素和从位置到结束的文本。

整个代码将如下所示：

```
var editor = document.getElementById("content_ifr").contentDocument.getElementById("tinymce");

$(editor).dblclick(function(event){
    var position = getCaret(this);
    this.innerHTML = this.innerHTML.substr(0,position)+"<p></p>"+this.innerHTML.substr(position);
} 
```

这应该做的工作;）

# php - Jquery：编码和解码json到/从php

> ID：12554886
> 
> 赞同：0
> 
> 时间：2012-09-23T18:12:39.173
> 
> 标签：php, javascript, jquery, mysql, json

我有一个 jquery 函数如下：

```
$(document).on("click",".ball_link", function fetchLevels(){
     $.getJSON('fetch_level.php',{level: clicked_ball}, function(data) {
        $.each(data, function() {
        alert(data);
        });
    });
}); 
```

我的 fetch_level.php 文件如下所示：

```
$clicked_ball=$_GET["level"];
$sqlget="select * from level_flow where parent_level='$clicked_ball'";
$resultget=mysql_query($sqlget);

$response_array=array();
while($rowget=mysql_fetch_assoc($resultget)){
    $response_array[]=$rowget;
}

echo json_encode($response_array); 
```

该查询返回跨 5 列的 3 行（所有整数）。我希望能够访问这 15 个值中的每一个，但是 js 代码中的 alert(data) 给出了这个：

```
([object],[Object]),([object],[Object]),([object],[Object]) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T18:16:04.787

Treat as Object in jQuery, eg:

```
$(document).on("click",".ball_link", function fetchLevels(){
     $.getJSON('fetch_level.php',{level: clicked_ball}, function(data) {
        $.each(data, function(i, name) {
            alert(name.parent_level);
        });
    });
}); 
```

`data` contains all your database row names with values

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-23T18:16:24.767

Actually mysql_fetch_assoc returns an associative array, and you put that array inside another array

so in javascript you can try

```
alert(data[0].nameOfColumn); 
```

You could iterate on it

```
$.each(data,function(i, el) {
    alert(el.nameOfColumn);
} ); 
```

in any case to see the structure of data you can use chrome or Firefox (with Firebug) and console.log(data)

# c - 与 C 中的指针的区别

> ID：12554888
> 
> 赞同：1
> 
> 时间：2012-09-23T18:12:50.430
> 
> 标签：c, pointers, struct

我是 C 新手，我想知道这两者之间有什么区别：

```
char* name; 
struct book *abook; 
```

我知道 struct 构造了一本书，但是 char 怎么会`*`放在变量名之前？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-23T18:16:04.027

TYPE * variableName, TYPE* variableName and TYPE *variableName are all syntactically the same. It's a matter of notation how you use them.

Personally I prefer the last form. It's simply because the star operator works on the token to the right of it. In a declaration like

```
TYPE* foo, bar; 
```

only foo is a pointer but not bar. Therefore it looks more logical to put the star right next to the variable name.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-23T19:25:16.017

C 编译器将忽略符号之间的空格，因此：

```
char* name; 
```

是相同的

```
char *name;
char * name;
char*name; 
```

和

```
struct book *abook; 
```

是相同的

```
struct book* abook;
struct book * abook;
struct book*abook; 
```

星号可能最好放在变量名旁边，因为它只适用于它前面的变量，而不适用于类型。所以如果你这样做：

```
int* a1, b1; 
```

您已将 a1 定义为一个 int 指针，将 b1 定义为一个 int，所以这更清楚一点：

```
int  *a1,  b1; 
```

至于指向 char 的指针和指向 struct book 的指针之间的内部差异，它们都是 8 个字节（在 64 位系统上 - 在 32 位系统上为 4 个字节）。那是，

sizeof (char *) 与 sizeof(struct book *) 相同。

但是编译器保留了每个指向的信息，因此它知道如何处理诸如当您递增一（a++）或取消引用一（*b）时的事情。也就是说，除了指针变量中存储的第一个地址之外，它还需要知道涉及多少字节。

如果 a1 指向一个 int，a1++ 现在应该再指向四个字节（a1 中的地址整数值应该高 4）。如果 a1 指向一个字符，a1++ 现在应该只指向一个字节。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-23T18:26:46.917

如果要创建结构的多个实例，则需要标记结构的声明。如果声明被标记，则该标记可以稍后在结构实例的定义中使用。例如：

```
struct book b; 
```

定义了一个变量 pt，它是一个 struct point 类型的结构。
`struct book`是你的类型。现在您可以定义指向此类型的指针。

如果您仍然感到困惑，请使用`typedef`为此结构定义新类型：

```
typedef struct book Book;
typedef struct book* BookPtr; 
```

请记住，这`BookPtr`只会影响第一个变量。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-23T18:21:14.737

`struct book`并且`char`都是类型。`struct book* abook`指向 book 类型结构的指针也是如此，该指针被命名为 abook。

`char* name`声明是一样的。它是指向 char 类型的指针。

这种定义指针的方式通常用于将文本字符串传递给函数，而不会过多地填充本地堆栈堆。它也比复制整个 char 数组占用更少的 CPU 资源。所以大多数情况下，这个 char 指针将指向数组中的第一个 char（例如`char name[30];`：）

# servlets - 多个浏览器是否在同一个会话中运行

> ID：12554889
> 
> 赞同：-1
> 
> 时间：2012-09-23T18:12:52.143
> 
> 标签：servlets

我想知道我是否同时在 eclipse 中打开多个浏览器运行相同的 web -app 它们是在同一个会话上运行还是会话不同，因为会话属性值被共享。
另外更令人困惑的是，如果我尝试在同时打开的多个浏览器中打印 sessionid cookie 值，所有浏览器都会获取完全相同的值。这应该在所有会话都相同时发生。不是这样吗？？？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-25T19:29:38.860

如果您指的是同一浏览器的多个窗口或选项卡，例如 Internet Explorer 的三个窗口，则每个窗口共享相同的会话。

如果您指的是两个不同的浏览器应用程序，例如一个 Internet Explorer 窗口和一个 Firefox 窗口，那么每个应用程序将有不同的会话。

默认情况下，浏览器 cookie 用于保存将客户端浏览器与会话相关联的会话 ID。例如，Internet Explorer 的任何选项卡或窗口都可以访问相同的 Internet Explorer cookie，因此都将共享相同的会话 id cookie，因此都将共享相同的会话。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T18:20:57.513

在同一个会话上运行意味着在所有浏览器实例中都将使用同一个客户端套接字。因此，有根据的*猜测*是否定的，会话不会被共享，因为每个浏览器将使用不同的客户端连接。
但我不确定这一点，所以如果这里没有人回答你确切知道引擎盖下发生了什么，我建议在另一台机器上运行你的网络应用程序并使用网络监控工具，例如 wireshark 看看是否每个请求都通过不同的 TCP 连接。

# html - IE: 问题 :( 不正确的 webfont 显示

> ID：12554890
> 
> 赞同：0
> 
> 时间：2012-09-23T18:12:54.050
> 
> 标签：html, css, internet-explorer, cross-browser, webfonts

**嘿，堆垛人！** 所以我在这个网站上遇到了几个奇怪的 IE 错误，我正在为一个朋友编写代码。

**[网站链接](http://s433108212.onlinehome.us/)**| [完整的 CSS 文件](http://s433108212.onlinehome.us/css/style.css)

我正在使用 Google Webfont Raleway，字体大小：300,400,700,900。然而，IE 将所有字体粗细更改为 300，并且不使用任何其他字体粗细。

所有提示和反馈表示赞赏！

主要导航字体样式：

```
.nav_li { 
    float:left;
    margin: 0;
    list-style-type:none; 
    font-family: 'Raleway', sans-serif;
    font-weight: 700;
    line-height: 100px;
    color: #fff;
    cursor: pointer;
    -webkit-transition: background .5s; -moz-transition: background .5s; -ms-transition: background .5s; transition: background .5s;
} 
```

*附上截图：* ![在此处输入图像描述](../Images/c724f5e0472d112732a446816a6a631b.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T18:27:58.473

我~~想~~知道这是 Internet Explorer 的问题。

[http://help.typekit.com/customer/portal/articles/6855-using-multiple-weights-and-styles](http://help.typekit.com/customer/portal/articles/6855-using-multiple-weights-and-styles)

每个字体最多可以有 4 个字体粗细（你可以接受），但是如果你阅读了那篇文章，IE 也有其他关于字体粗细的错误。

希望它有所帮助:-)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-23T20:25:19.090

像这样的问题在 IE 中并不少见：一些谷歌字体，当以谷歌推荐的方式使用时（参考谷歌服务器上的代码），只是由于访问限制而失败。避免这种情况的方法是下载字体（使用“下载您的收藏”链接），使用[FontSquirrel](http://www.fontsquirrel.com/)处理它们，将它们上传到您的服务器（与托管您的 HTML 文档相同），并使用 CSS`@font-face`代码（由 FontSquirrel 给出）直接地。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-23T18:24:02.100

根据 Google 的*技术考虑*

> 更一般地说，Internet Explorer 的行为可能会因各种元素的位置和存在而异。如果您想在所有浏览器中提供一致的行为，请使用 WebFont Loader。例如，您可以选择让所有浏览器的行为都像 Firefox。

[https://developers.google.com/webfonts/docs/webfont_loader](https://developers.google.com/webfonts/docs/webfont_loader)

# java - 在应用程序启动时获取服务器上下文路径

> ID：12554893
> 
> 赞同：0
> 
> 时间：2012-09-23T18:13:09.960
> 
> 标签：java, servlets, jboss, seam, seam2

我试图在应用程序启动时从 ServletContext 获取服务器 URL（例如[http://www.mywebapp.com/myapp](http://www.mywebapp.com/myapp)），我通过在启动时调用 bean 方法（使用 @Startup）并获取servlet 上下文，

```
@Startup
@Name("startupActions")
@Scope(ScopeType.APPLICATION)
public class StartupActionsBean implements StartupActions,
Serializable {

@Logger private Log log;

/**
 * 
 */
private static final long serialVersionUID = 1L;

@Create
@Override
public void create(){
    ServletContext sc = org.jboss.seam.contexts.ServletLifecycle.getServletContext();
    String context = sc.getContextPath();
    String serverInfo = sc.getServerInfo();
    log.debug("__________________START__________________");
    log.debug("Context Path: "+context);
    log.debug("Server Info: "+serverInfo);
}

// Cleanup methods
@Remove
@BypassInterceptors
@Override
public void cleanUp(){}
} 
```

这项工作正常，但是 ServletContext 路径为空白，请参阅下面的控制台输出。

```
18:52:54,165 DEBUG [uk.co.app.actions.startup.StartupActionsBean] __________________START__________________
18:52:54,165 DEBUG [uk.co.app.actions.startup.StartupActionsBean] Context Path: 
18:52:54,165 DEBUG [uk.co.app.actions.startup.StartupActionsBean] Server Info: JBoss Web/3.0.0-CR1 
```

有谁知道如何通过这个或其他方式获得上下文路径？

附言。使用 SEAM 2.2.2、Jboss AS6 Final、Richfaces 3.3.3

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-24T23:18:19.733

不要使用`@Startup`，您的组件启动代码在上下文完全设置之前被调用，并且其他一些工厂尚未初始化。

观察`org.jboss.seam.postInitialization`事件并使用它`ServletLifecycle.getCurrentServletContext()`来获取所需的数据。一个简单的例子：

```
@Name("contextPath")
public class ContextPathInit implements Serializable {
    private String contextPath;

    @Observer("org.jboss.seam.postInitialization")
    public void init() {
        contextPath = ServletLifecycle.getCurrentServletContext().getContextPath();
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T18:25:27.120

您是否尝试过使用[getContextName方法从](http://javaserverfaces.java.net/nonav/docs/2.0/javadocs/javax/faces/context/ExternalContext.html#getContextName%28%29)[ExternalContext](http://javaserverfaces.java.net/nonav/docs/2.0/javadocs/javax/faces/context/ExternalContext.html)获取它？

```
FacesContext.getCurrentInstance().getExternalContext().getContextName() 
```

# c# - 文本框不能为空

> ID：12554895
> 
> 赞同：0
> 
> 时间：2012-09-23T18:13:19.930
> 
> 标签：c#, visual-studio-2010

我是 Visual Studio 2010 中 C# 编程的新手。我一直试图弄清楚当我单击保存按钮时，我的文本框不能为空或为空。如果你们能让我找到解决这个问题的方法，我将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T18:15:45.303

您需要测试文本框（`.Text`属性）的值以查看是否已填充。

在语句中使用`string.IsNullOrWhitespace`（.NET 4.0 及更高版本）或`string.IsNullOrEmpty`方法`if`是一个好的开始。

```
if(!string.IsNullOrWhitespace(aTextBox.Text))
{
  // it is not empty or null!
} 
```

# android - Android MapView 标记阴影在活动恢复后移动

> ID：12554905
> 
> 赞同：0
> 
> 时间：2012-09-23T18:14:16.677
> 
> 标签：android, android-mapview, itemizedoverlay, mapactivity

我有一个 MapView，上面有各种标记。第一次进入 MapActivity 时，我在标记上设置了可绘制对象的边界，一切看起来都很好。标记和阴影都显示正确。但是当我点击另一个活动并返回时，阴影或标记不再正确绑定。有时它只是受影响的一些标记。谁能告诉我这里发生了什么？这是一些代码。下面是我在可绘制标记上设置边界的地方：

```
InputStream is = assetManager.open(imageName);
drawable = Drawable.createFromStream(is, null);
int width = drawable.getIntrinsicWidth();
int height = drawable.getIntrinsicHeight();
drawable.setBounds(-width / 2, -height, width - (width / 2), 0); 
```

以下是我如何在地图中创建/添加叠加项目：

```
GeoPoint point = createGeoPoint(lat, lon);
OverlayItem overlayItem = new OverlayItem(point, character.get_id(), "");
Drawable image = drawable;
overlayItem.setMarker(image);
itemizedOverlay.addOverlay(overlayItem); 
```

据我所知，叠加层并没有被重新添加到地图中，这只是在 onResume() 事件之后的重绘。有任何想法吗？

更新：我实际上已经弄清楚，只有点击类型的图像会移动，而不是阴影，而是移动的图像。因此，在有 x 个 A 类型的图像和 y 个 B 类型的图像中，我点击任何 A 类型的图像，当我返回 MapActivity 时，所有 A 类型的图像都与其阴影未对齐，而所有类型的图像B 仍然正确对齐。

另一个更新：我正在将边界输出到日志，并在返回地图屏幕后看到边界正在发生变化。最初添加标记时，其边界为：

[矩形(-25, -48 - 25, 1)]

但是当返回地图屏幕时，边界已更改为：

[矩形（0, 0 - 50, 49）]

……为什么会这样？

另一个更新：我有一个解决方法......但我仍然想知道为什么会这样。解决方法是覆盖 draw 方法，并在调用 draw 方法时设置边界（到中心底部）。这是代码：

```
@Override
public void draw(Canvas canvas) {
  int dWidth = getIntrinsicWidth();
  int dHeight = getIntrinsicHeight();
  setBounds(-dWidth / 2, -dHeight, dWidth / 2, 0);
  super.draw(canvas);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-08T20:34:06.653

我发现了问题所在。您可以从问题中的代码中看到，我正在从 InputStream 中读取 BitmapDrawables。为了减少浪费，我将所有创建的图像放在一个享元中，并尽可能重复使用它们。这意味着，当我在地图上放置 3 个“阳光”时，所有三个都基于同一张图像。此外，当我通过 ItemizedOverlay 将它们放置在地图上时，我正在调用 boundCenterBottom()，以便阴影将显示在正确的位置。

当我打开一个不同的 Activity 时，该 Activity 有一个 ImageView，我用相同的图像填充。事实证明，那 ImageView 一定是在重置边界。我知道这一点是因为，在覆盖 draw() 方法并设置每次绘制的边界之后，我不再能够在 ImageViews 中看到图像。当我注释掉覆盖的 draw() 方法时，我可以在 ImageViews 中看到图像，但是当我返回地图时，图像会发生变化。这告诉我将图像添加到 ImageView 必须更新边界。

我的解决方案是为每种图像类型创建两个不同的图像；一个用于地图，一个用于其他活动上的 ImageView。我仍然可以将它们放在享元中，但它们具有单独的键，因此同一图像可以存在多个图像实例。

希望这可以帮助某人。我知道 StackOverflow 有另一个关于此的问题，但我找不到它可以链接或回答。

# ruby-on-rails-3 - 在 Rails 3 中使用 mailcatcher

> ID：12554909
> 
> 赞同：1
> 
> 时间：2012-09-23T18:14:39.730
> 
> 标签：ruby-on-rails-3, actionmailer

我想使用[mailcatcher](http://mailcatcher.me/)检查我的邮件是否已发送。他们不是，我想知道为什么，因为邮件是生成的并且肯定会被调用。

所以在我的 config/enviroment/development.rb 我写道：

```
config.action_mailer.raise_delivery_errors = true
config.action_mailer.delivery_method = :smtp
config.action_mailer.smtp_settings = { :address => "localhost", :port => 1025 } 
```

我的电话看起来像这样：

```
OrderMailer.send_new_order(@order).deliver 
```

最后生成的控制器是这样的：

```
class OrderMailer < ActionMailer::Base
  default from: "from@example.com"
  def send_new_order(order)
    @greeting = "Hi"
    mail to: "to@example.org", subject: "Test"
  end
end 
```

当然，mailcatcher 也会运行。那为什么邮件没有发送？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-09-26T09:20:24.477

我发现，我为开发环境使用了错误的 SMTP 地址。

它必须是

```
config.action_mailer.smtp_settings = { :address => "127.0.0.1", :port => 1025 } 
```

代替

```
config.action_mailer.smtp_settings = { :address => "localhost", :port => 1025 } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-09-21T22:43:47.333

[https://github.com/sj26/mailcatcher/issues/182](https://github.com/sj26/mailcatcher/issues/182)

```
$ mailcatcher -f -v
Starting MailCatcher
==> smtp://127.0.0.1:1025
==> http://127.0.0.1:1080
==> SMTP: Received message from '<donotreply@xxx.com>' (676 bytes) 
```

# python - 在 Python 中查找第一次出现的元音

> ID：12554917
> 
> 赞同：1
> 
> 时间：2012-09-23T18:15:33.930
> 
> 标签：python, string

我有一个`isvowel`返回`True`or的函数`False`，具体取决于字符`ch`是否为元音。

```
 def isvowel(ch):
          if "aeiou".count(ch) >= 1:
              return True
          else:
              return False 
```

我想知道如何使用它来获取字符串中任何元音第一次出现的索引。我希望能够获取第一个元音之前的字符并将它们添加到字符串的末尾。当然，我不能这样做，`s.find(isvowel)`因为`isvowel`给出了布尔响应。我需要一种方法来查看每个字符，找到第一个元音，并给出那个元音的索引。

我该怎么做呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T18:25:00.323

你总是可以尝试这样的事情：

```
import re

def first_vowel(s):
    i = re.search("[aeiou]", s, re.IGNORECASE)
    return -1 if i == None else i.start()

s = "hello world"
print first_vowel(s) 
```

或者，如果您不想使用正则表达式：

```
def first_vowel(s):
    for i in range(len(s)):
        if isvowel(s[i].lower()):
            return i
    return -1

s = "hello world"
print first_vowel(s) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-23T18:22:52.860

```
[isvowel(ch) for ch in string].index(True) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-23T18:40:05.183

```
(ch for ch in string if isvowel(ch)).next() 
```

或仅用于索引（按要求）：

```
(index for ch, index in itertools.izip(string, itertools.count()) if isvowel(ch)).next() 
```

这将创建一个迭代器并且只返回第一个元音元素。警告：没有元音的字符串会抛出`StopIteration`，建议处理。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-23T18:24:56.120

这是我的看法：

```
>>> vowel_str = "aeiou"

>>> def isVowel(ch,string):
...     if ch in vowel_str and ch in string:
...             print string.index(ch)
...     else:
...             print "notfound"
... 
>>> isVowel("a","hello")
not found

>>> isVowel("e","hello")
1
>>> isVowel("l","hello")
not found

>>> isVowel("o","hello")
4 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-23T19:01:01.583

将 next 用于生成器非常有效，这意味着您不会遍历整个字符串（一旦找到字符串）。

```
first_vowel(word):
    "index of first vowel in word, if no vowels in word return None"
    return next( (i for i, ch in enumerate(word) if is_vowel(ch), None)
is_vowel(ch):
    return ch in 'aeiou' 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-09-06T07:04:20.970

```
my_string = 'Bla bla'
vowels = 'aeyuioa'

def find(my_string):
    for i in range(len(my_string)):
        if my_string[i].lower() in vowels:
            return i
            break 

print(find(my_string)) 
```

# c++ - 为什么可选参数不适用于模板？

> ID：12554922
> 
> 赞同：2
> 
> 时间：2012-09-23T18:15:53.983
> 
> 标签：c++, templates, optional-parameters

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-23T18:18:49.310

你弄错了。默认参数不参与参数推导：

参数推导*首先*发生，作为选择所需重载的一部分，*然后*在必要时填充该重载的默认参数。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-23T18:59:32.240

Kerrek SB 所说的是正确的，编译器只是没有足够的能力来推断 T2 （通过标准允许做的事情）。

在这种特殊情况下，您可以通过对所有内容仅使用一个模板参数来修复它，即

```
template< class T > T inc( const T v, const T u = 1 ) { return v + u; } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-23T19:03:32.403

默认参数不参与演绎过程（仅用于重载解析，并且规则很难记住 - 始终保持简单）。

为了实现你想要的，你可以提供一个额外的重载：

```
template <class T1, class T2> T1 inc(T1 v, T2 u) { return v + u; }
template <class T> T inc(T v) { return v + T(1); } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-24T22:18:42.843

C++ 中的模板函数是在编译时生成的，并且仅在需要时才生成。所以你可以得到一个生成的函数，如：

```
inc( int, int ); 
```

这将是 T1 = int 和 T2 = int 版本。如果您为每个模板参数传入参数，编译器可以隐式确定类型，因此：

```
int a = 1;
int b = 2;
inc( a, b ); 
```

编译器可以在编译时生成与上述类似的函数，因为它可以推断出 T1 = int 和 T2 = int。但是，如果你做你正在做的事情：

```
inc( 5 ); 
```

编译器可以确定 T1 = int，但无法确定 T2 是什么。因此不会生成任何函数，并且您会收到有关该函数不存在的错误。如果您使用一个模板参数，这可能是可以修复的：

```
template<class T> T inc(T v, T u = 1) { return v + u; } 
```

或者，如果您提供重载：

```
template<class T> T inc(T v) { return v + 1; } 
```

还有第三种方式：

```
inc<int, int>( 5 ); 
```

但我想这不是你想要的......

# css - CSS Sprite generation in gradle build process?

> ID：12554926
> 
> 赞同：5
> 
> 时间：2012-09-23T18:16:07.490
> 
> 标签：css, build, build-process, css-sprites

I recently read an article about Javascript, where Build Tools like Grunt and Ender were mentioned. It was briefly stated, that such tools are capable of generating sprite images from individually provided files and that these build tools can be integrated into the build process.

Unfortunately my google searches didn't unveil more information on this. Does anybody here have experience on this topic and integration into gradle? Some web resources for further reading are highly welcome!

Many thanks in advance! Sascha.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T11:33:31.310

@Windwalker 您可能有兴趣在您的 gradle 中使用 SmartSprites Maven 存储库。它采用单个图像并使用它以及所需的 CSS 创建一个精灵图像。

可以在以下位置找到存储库的详细信息：http: [//mvnrepository.com/artifact/com.carrotsearch/smartsprites/0.2.8](http://mvnrepository.com/artifact/com.carrotsearch/smartsprites/0.2.8)

要将其安装到您的项目中，只需在您的 gradle 命令中添加以下行：

```
'com.carrotsearch:smartsprites:0.2.8' 
```

关于

正如 Smart Sprite [ [http://csssprites.org/](http://csssprites.org/) ] 的网站所说：

> SmartSprites 将让您轻松地在设计中引入和维护 CSS 精灵。SmartSprites 解析可以插入原始 CSS 的特殊指令，以标记要转换为 sprite 的单个图像。然后它从收集的图像中构建精灵图像，并自动将所需的 CSS 属性插入到您的样式表中，以便使用精灵而不是单个图像

我希望这能解决你的情况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-10T21:19:17.900

```
http://csssprites.com/
http://spritegen.website-performance.org/
http://css-sprit.es/ 
```

一些在线工具可以生成精灵以及 CSS 代码。

# c# - Get type name of object and property name?

> ID：12554927
> 
> 赞同：1
> 
> 时间：2012-09-23T18:16:07.653
> 
> 标签：c#, lambda, expression

I need function, that returns {obj type name}.{property name}.{property name}.. For example:

```
class City {
    public string Name {get;set;}
}

class Country {
    public string Name {get;set;}
    public City MyCity {get;set;}
}

var myCountry = new Country() { 
    Name="Ukraine",
    MyCity = new City() {
        Name = "Kharkov"
    }
} 
```

So my function should return **"{Country.Name}" or "{Country.MyCity.Name}"** depends on input parameter. What is the way to do it?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T18:26:00.007

使用 .net 反射

[http://www.codersource.net/microsoftnet/cbasicstutorials/cnettutorialreflection.aspx](http://www.codersource.net/microsoftnet/cbasicstutorials/cnettutorialreflection.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T18:40:26.250

创建一个 IPrintable 外观并使用递归函数 Print()。尝试抓住这个想法并为您的具体任务修改代码。希望我的例子对你有帮助。

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace StackOverflow
{
    interface IPrintable
    {
        string Name { get; }
    }

    class City : IPrintable
    {
        public string Name { get; set; }
    }

    class Country : IPrintable
    {
        public string Name { get; set; }
        public City MyCity { get; set; }
    }

    class Program
    {
        static void Main(string[] args)
        {
            var myCountry = new Country()
            {
                Name = "Ukraine",
                MyCity = new City()
                 {
                     Name = "Kharkov"
                 }
            };

            Console.WriteLine(Print(myCountry, @"{{{0}}}"));
            Console.WriteLine(Print(new City()
            {
                Name = "New-York"
            }, @"{{{0}}}"));
        }

        private static string Print(IPrintable printaleObject, string formatter)
        {
            foreach (var prop in printaleObject.GetType().GetProperties())
            {
                object val = prop.GetValue(printaleObject, null);
                if (val is IPrintable)
                {
                    return String.Format(formatter, printaleObject.Name) + Print((IPrintable)val, formatter);
                }
            }
            return String.Format(formatter, printaleObject.Name);
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-23T18:34:29.710

您没有发布太多有关要求的信息，但是，如果您知道您的对象类型，则无需使用反射，您可以`is`像这样进行测试：

```
if(returnCity && myObject is Country) //I'm assuming that the input value is boolean but, you get the idea...
{
    return myObject.City.Name;
}
else
{
    return myObject.Name;
} 
```

现在，如果你想使用反射，你可以在这些行中做一些事情：

```
public static string GetNameFrom( object myObject )
{
    var t = myObject.GetType();
    if( t == typeof(Country) )
    {
        return ((Country)myObject).City.Name;
    }

    return ((City)myObject).Name;
} 
```

或者，更通用的方法：

```
static string GetNameFrom( object myObject )
{
    var type = myObject.GetType();
    var city = myObject.GetProperty( "City" );
    if( city != null)
    {
        var cityVal = city.GetValue( myObject, null );
        return (string)cityVal.GetType().GetProperty( "Name" ).GetValue( cityVal, null );
    }

    return (string)type.GetProperty( "Name" ).GetValue( myObject, null );
} 
```

# android - 如何通过以下方法获取 facebook 用户 ID 以及电子邮件、姓名

> ID：12554929
> 
> 赞同：-1
> 
> 时间：2012-09-23T18:16:22.560
> 
> 标签：android, facebook-graph-api

如何在下面的 getProfileInformation() 中获取 facebook 用户 ID 以及电子邮件、名称，这里我想获取用户 ID，并希望在 run() 中与电子邮件和名称一起显示在 toast 消息中；

```
public void getProfileInformation() {
    mAsyncRunner.request("me", new RequestListener() {
        @Override
        public void onComplete(String response, Object state) {
            Log.d("Profile", response);
            String json = response;
            try {
                JSONObject profile = new JSONObject(json);
                // getting name of the user
                final String name = profile.getString("name");
                // getting email of the user
                final String email = profile.getString("email"); 
                runOnUiThread(new Runnable() {
                    @Override
                    public void run() { 
                        Toast.makeText(getApplicationContext(), "Name: " + name + "\nEmail: " + email , Toast.LENGTH_LONG).show();
                    }
                });
            } catch (JSONException e) {
                e.printStackTrace();
            }
        }

        @Override
        public void onIOException(IOException e, Object state) {
        }

        @Override
        public void onFileNotFoundException(FileNotFoundException e,
                Object state) {
        }

        @Override
        public void onMalformedURLException(MalformedURLException e,
                Object state) {
        }

        @Override
        public void onFacebookError(FacebookError e, Object state) {
        }
    });
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-23T18:42:20.023

您可以在请求中传递 Bundle 中的必填字段：

```
public void getProfileInformation() {
    Bundle params = new Bundle();
    params.putString("fields", "id,name,email");

    mAsyncRunner.request("me", params, new RequestListener() {
    @Override
    public void onComplete(String response, Object state) {
        Log.d("Profile", response);
        String json = response;
        try {
            JSONObject profile = new JSONObject(json);
            // getting name of the user
            final String name = profile.getString("name");
            // getting email of the user
            final String email = profile.getString("email"); 
            final Long id = profile.getLong("id");
            runOnUiThread(new Runnable() {
                @Override
                public void run() { 
                    Toast.makeText(getApplicationContext(), "ID:" + id + "\nName: " + name + "\nEmail: " + email , Toast.LENGTH_LONG).show();
                }
            });
        } catch (JSONException e) {
            e.printStackTrace();
        }
    }
... 
```

请注意，您将需要“电子邮件”权限。

# javascript - How do I stabilize the sound of a jquery volume - slider?

> ID：12554937
> 
> 赞同：2
> 
> 时间：2012-09-23T18:17:18.770
> 
> 标签：javascript, jquery, html

I have html5 webpage, with a slider and an audio track. I do not reffer to the sound tag property controls = "controls" (). I want my slider to control the volume from the audio file. If I use in my body tags , the following code it`s working perfectly. If I use in my body tags , the result is a deafening noise . This is my code:

HTML

```
<!doctype html>
<html lang="en">

<head>

<title>Rain</title>
<meta charset="utf-8">

<link rel="stylesheet" type="text/css" href="css/ui-lightness/jquery-ui-1.8.23.custom.css">
<link rel="stylesheet" type="text/css" href="css/style.css">

</head>

<body onLoad="run();">

<div id="slider"></div>

<script type="text/javascript" src="js/jquery.js"></script>
<script type="text/javascript" src="js/jquery-ui.js"></script>
<script type="text/javascript" src="js/ui.js"></script>
</body>
</html> 
```

JS

```
// Invoke new Audio object
var ad = new Audio('rainloop.mp3');

//default play audio
ad.play();

//volume slider
$('#slider').slider({
min:0,
max:100,
step:1,
value:50,
slide: function(){

    ad.volume = parseFloat(this.value / 10);
} 
```

} );

I think the problem it`s here : ad.volume = parseFloat(this.value / 10); I`ve tried also : ad.volume = parseFloat(this.value) and ad.volume = parseFloat(this.value / 100) and it`s still making a incomprehensible noise.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T22:20:23.493

尝试在 0 和 1 之间操作音量值，其中 0 是静音 (0%)，1 是最大音量 (100%) [http://www.w3schools.com/html5/av_prop_volume.asp](http://www.w3schools.com/html5/av_prop_volume.asp)

检查控制台日志您在这部分代码中得到的内容：

```
parseFloat(this.value / 100) 
```

# c# - 捕获异常，然后抛出/发送异常并继续

> ID：12554944
> 
> 赞同：4
> 
> 时间：2012-09-23T18:18:13.307
> 
> 标签：c#, winforms, exception, try-catch

所以标题可能有点误导，但我想要完成的是读取一组文件，然后将它们组合成一个，这就是我现在所处的位置。

问题是我有一个查找异常“FileNotFoundException”的捕获，当它被调用时，我想继续我的 try 语句（使用“继续”）但让用户知道文件丢失。

我的设置是一个从表单调用的类（它是应该显示错误的表单）

我想过创建一个可以从我的表单注册的事件，但这是正确的方法吗？

```
 public void MergeClientFiles(string directory)
    {
        // Find all clients
        Array clients = Enum.GetValues(typeof(Clients));

        // Create a new array of files
        string[] files = new string[clients.Length];

        // Combine the clients with the .txt extension
        for (int i = 0; i < clients.Length; i++)
            files[i] = clients.GetValue(i) + ".txt";

        // Merge the files into directory
        using (var output = File.Create(directory))
        {
            foreach (var file in files)
            {
                try
                {
                    using (var input = File.OpenRead(file))
                    {
                        input.CopyTo(output);
                    }
                }
                catch (FileNotFoundException)
                {
                    // Its here I want to send the error to the form
                    continue;
                }
            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-23T18:28:19.550

您希望该方法能够完成工作并向用户报告问题，对吗？然后 Oded 提出了正确的建议。稍加修改，代码可能如下所示：

```
 public List<string> MergeClientFiles( string path )
    {
        // Find all clients
        Array clients = Enum.GetValues( typeof( Clients ) );

        // Create a new array of files
        string[] files = new string[clients.Length];

        // Combine the clients with the .txt extension
        for( int i = 0; i < clients.Length; i++ )
            files[i] = clients.GetValue( i ) + ".txt";
        List<string> errors = new List<string>();

        // Merge the files into AllClientData
        using( var output = File.Create( path ) ) {
            foreach( var file in files ) {
                try {
                    using( var input = File.OpenRead( file ) ) {
                        input.CopyTo( output );
                    }
                }
                catch( FileNotFoundException ) {
                    errors.Add( file );
                }
            }
        }
        return errors;
    } 
```

然后，在调用者中，您只需检查 MergeClientFiles 是否返回非空集合。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-23T18:21:25.830

您可以将异常收集到 a`List<FileNotFoundException>`中，并且在迭代结束时，如果列表**不**为空，则抛出自定义异常，将此列表分配给相应的成员。

这将允许任何调用上述代码的代码捕获您的自定义异常，遍历`FileNotFoundException`s 并通知用户。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-23T18:24:27.040

您可以定义一个委托作为方法的参数传递。

```
public delegate void FileNotFoundCallback(string file);

public void MergeClientFiles(string directory, FileNotFoundCallback callback)
{
    // Find all clients
    Array clients = Enum.GetValues(typeof(Clients));

    // Create a new array of files
    string[] files = new string[clients.Length];

    // Combine the clients with the .txt extension
    for (int i = 0; i < clients.Length; i++)
        files[i] = clients.GetValue(i) + ".txt";

    // Merge the files into directory
    using (var output = File.Create(directory))
    {
        foreach (var file in files)
        {
            try
            {
                using (var input = File.OpenRead(file))
                {
                    input.CopyTo(output);
                }
            }
            catch (FileNotFoundException)
            {
                // Its here I want to send the error to the form
                callback( file );
                continue;
            }
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-23T18:33:44.047

如需一些灵感，请查看 c# 中新的并行结构的文档，例如 Parallel.For 和[Reactive Framework](http://msdn.microsoft.com/en-us/data/gg577609.aspx) (rx)。

首先，异常在[AggregateException](http://msdn.microsoft.com/en-us/library/system.aggregateexception.aspx)中收集，在 Rx 中，异常通过回调接口进行通信。

我认为我更喜欢 Parallel.For 中使用的方法，但请选择最适合您的场景的方法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-23T18:39:28.813

而不是捕获`FileNotFoundException`s 您应该主动检查文件是否存在，如果不存在则不要尝试打开它。

您可以更改方法以返回合并文件列表、丢失文件列表或所有文件列表以及是否合并或丢失的指示符。返回单个列表使调用者可以选择一次处理所有丢失的文件并知道丢失了多少文件，而不是像事件或回调那样逐个处理。

# javascript - 移动 Safari 渲染在 Canvas 上缩放？

> ID：12554947
> 
> 赞同：8
> 
> 时间：2012-09-23T18:18:22.313
> 
> 标签：javascript, image, canvas, safari, scaling

我尝试在 iOS6 上的 Safari Mobile 上的 Canvas 上渲染加载了 FileReader 对象的本地图像。但是每个带有 data-URL 的图像都会被垂直缩放。这是一个错误吗？在 Chrome 上它可以正确呈现。

*   [演示脚本](http://jsbin.com/aqirel/1/edit)

**[iOS6 的屏幕截图](http://i.stack.imgur.com/qLgmA.png)**（上图：画布，下图：原始图像）

有没有办法解决这个错误？这是一个错误吗？

如果我首先使用“PhotoWizard”应用程序调整设备上的图像大小（将其缩小到 720 像素宽度），Canvas 会正确呈现它。使用相机应用程序拍摄的图像大小或图像似乎有问题：

*   [工作演示脚本](http://jsbin.com/aqirel/2/edit)

尝试了[Jake Archibald](https://twitter.com/jaffathecake/status/249948116843917312)的建议，看起来好一点，但仍然可以垂直缩放：

*   [修改后的演示脚本](http://jsbin.com/aqirel/3/edit)
*   [iOS6 截图](https://dl.dropbox.com/u/6037571/Temp/ScreenShot-iOS6-Canvas-Render-Bug-2.png)

我今天在安装了 Android 4.1.1 的 Galaxy Nexus 上进行了尝试。像预期的那样工作，所以这看起来真的像一个移动 Safari 问题：

*   [Android 4.1.1 的屏幕截图](https://dl.dropbox.com/u/6037571/Temp/ScreenShot-Android-4.1.1-Canvas-Render-Bug.png)

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-09-27T06:33:08.333

这可能与 iOS Safari 资源限制中的限制有关。根据以下链接，将对超过 2M 像素的 JPEG 文件进行二次采样。

[https://developer.apple.com/library/content/documentation/AppleApplications/Reference/SafariWebContent/CreatingContentforSafarioniPhone/CreatingContentforSafarioniPhone.html#//apple_ref/doc/uid/TP40006482-SW15](https://developer.apple.com/library/content/documentation/AppleApplications/Reference/SafariWebContent/CreatingContentforSafarioniPhone/CreatingContentforSafarioniPhone.html#//apple_ref/doc/uid/TP40006482-SW15)

我怀疑 Safari 中的画布无法正确处理这种子采样。

我创建了一些解决方法来检测图像是否经过二次采样并将其拉伸到原始大小。

[https://github.com/stomita/ios-imagefile-megapixel](https://github.com/stomita/ios-imagefile-megapixel)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-04T14:23:50.850

```
var cnv = document.createElement("canvas");
        ctx = cnv.getContext("2d");

        image = new Image();

        image.src = src;

        image.onload = function() {

            var size = scaleSizeRatio(image.width,image.height);
            cnv.width = size[0];
            cnv.height = size[1];
            ctx.drawImage(image, 0, 0, image.width, image.height, 0, 0, image.width , image.height);

            var div = container;  
            div.appendChild(cnv);       

        } 
```

> ctx.drawImage(image, 0, 0, image.width, image.height, 0, 0, image.width, image.height); 此功能将修复超过 3Mb 的 iPod 中的挤压问题。首先，如果您的图像超过 3Mb，则计算图像的缩放宽度和高度，并将该宽度和高度设置为画布。然后调用drawImage函数。它将给出您所期望的最终图像......

# c++ - Socket set option explanation

> ID：12554948
> 
> 赞同：3
> 
> 时间：2012-09-23T18:18:25.740
> 
> 标签：c++, boost, boost-asio

I have small piece of code

```
boost::asio::ip::tcp::no_delay option(true);
boost::asio::ip::tcp::socket* sock = new boost::asio::ip::tcp::socket(ios);
sock->set_option(option);
_session_acceptor.async_accept(*sock, 
                boost::bind(&server::playerAccept, this, sock, boost::asio::placeholders::error)); 
```

If i call `set_option` on socket before accepting server dont accept any connections. But if i call `set_option` after connections are accepted. Is there any magic?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-23T18:56:14.880

您应该调用`set_option`接受器，而不是套接字。我的项目中的示例：

```
 Listener::Listener(int port)
            : acceptor(io, ip::tcp::endpoint(ip::tcp::v4(), port))
            , socket(io) {
    boost::asio::ip::tcp::no_delay opt_nodelay(true);
    acceptor.set_option(opt_nodelay);
    start_accept(); 
```

# python - 从列表中过滤 - Python

> ID：12554953
> 
> 赞同：0
> 
> 时间：2012-09-23T18:18:49.320
> 
> 标签：python, arrays, list, filter

我想知道是否有人可以帮助我解决家庭作业问题。

编写一个函数 func(a,x)，它接受一个数组 a, x 是两个数字，并返回一个仅包含 a 的值大于或等于 x 的数组

我有

```
def threshold(a,x):
    for i in a:
        if i>x: print i 
```

但这是错误的方法，因为我没有将它作为数组返回。有人可以提示我正确的方向。非常感谢提前

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-23T18:27:03.250

使用[列表推导](http://docs.python.org/tutorial/datastructures.html#list-comprehensions)：

```
[i for i in a if i>x] 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-23T18:23:21.010

使用内置功能[`filter()`](http://docs.python.org/library/functions.html#filter)：

```
In [59]: lis=[1,2,3,4,5,6,7]
In [61]: filter(lambda x:x>=3,lis)  #return only those values which are >=3
Out[61]: [3, 4, 5, 6, 7] 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-09-23T18:26:43.703

您可以使用[列表理解](http://docs.python.org/tutorial/datastructures.html#list-comprehensions)：

```
def threshold(a, x):
    return [i for i in a if i > x] 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-09-23T18:27:18.537

```
def threshold(a,x):
    vals = []
    for i in a:
        if i >= x: vals.append(i)
    return vals 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-23T18:28:36.013

我认为作业问题是实际实现一个过滤器功能。不只是使用内置的。

```
def custom_filter(a,x):
    result = []
    for i in a:
        if i >= x:
            result.append(i)
    return result 
```

# javascript - 设置默认值元素 我的网页中有一个表格，可以捕获之前订单历史记录的详细信息。该表包含以下列： 订单日期 审核 现在，对于审核，我想要一个带有一些选项的选择下拉列表。当用户首次启动页面时，我希望之前的评分在选择下拉列表中显示为默认值。这是我的代码的样子： tds.push( { content: '<select id="clientReview" name="clientReview" value=" + obj.get(&quot;client_review&quot;) + ">' + '< ID：12554956 赞同：3 时间：2012-09-23T18:19:03.610 标签：javascript, html 回答 #1 赞同：4 时间：2012-09-23T18:20:15.347 将 HTML 插入文档后如何设置值？ HTML： <select id="dropdown"> <option value="1">One</option> <option value="2">Two</option> <option value="3">Three</option> </select> <input id="textField" type="text" value="2" /> JavaScript： (function() { var dropdown$ = $('#dropdown'), textField$ = $('#textField'); function changeVal() { var val = parseInt(textField$.val()); if(!!val && val > 0 && val < 4) { dropdown$.val(val); } } textField$.on('keyup', changeVal); changeVal(); })();​ 演示 <option value="1" selected="selected">Text</option> 请参阅： http ://www.w3.org/wiki/HTML/Elements/option#HTML_Attributes http://www.w3schools.com/tags/att_option_selected.asp 根据您的代码示例，我可以假设您稍后将使用此 HTML 插入某处。在这种情况下，您可以使用下一个代码： tds.push( { content: '<select id="clientReview" name="clientReview" data-value="' + obj.get("client_review") + '">' + '<option value="1" >Hate it!</option>' + '<option value="2" >Don\'t love it but don\'t hate it.</option>' + '<option value="3" >Fantastic!</option>' + '</select>' });​ function insertDropdown(td$, dropdownHTML) { var dropdown$ = $(dropdownHTML); dropdown$.val(dropdown$.data('value')); td$.html(dropdown$); } for(var i = 0, l = tds.length; i < l; i++) { insertDropdown($('#td-' + i), tds[i].content); } 演示</select>

# deployment - Nginx：如何在 nginx 配置中为路径提供变量？

> ID：12554964
> 
> 赞同：3
> 
> 时间：2012-09-23T18:19:54.973
> 
> 标签：deployment, nginx, amazon-ec2

*   我有一个 Web 应用程序，我在本地测试并部署在 EC2 实例上
*   我正在使用**本地**nginx 配置，它看起来像

> ```
> location /static/ {       alias /home/me/code/p/python/myapp/static/;
>     # if asset versioning is used
>     if ($query_string) {
>         expires max;
>     }
> }     location /templates/ {      alias /home/me/code/p/python/app/templates/;
>     # if asset versioning is used
>     if ($query_string) {
>         expires max;
>     }
> } 
> ```

在 EC2 实例上，唯一会改变的是路径，例如

`/home/me/code/p/python/myapp/static/`至`/User/ubuntu/code/p/python/myapp/static/`

*   为了实现这一点，我将配置更改为

`~/code/p/python/myapp/static/`

但这不起作用，它显示了路径

`/etc/nginx/~/code/p/python/myapp/static/`

这是不对的

**问题** - 是否可以在 nginx conf 中包含环境变量？

**我想要什么** - Nginx conf，它可以读取特定机器上的变量来创建路径，这样我就不必在每台机器上更改它并且代码是可重用的

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-12T05:42:13.100

这样做的两种方法：

1.  如上所述，符号链接是一种在机器上匹配路径的非常好的方法，同时将代码保存在一个地方。符号链接基本上是别名；如果 /link 是 /file 的符号链接，当你请求 /link 时，你会得到 /file。

    ```
    ln -s /file /link 
    ```

2.  使用包含语句。在 nginx 中，您可以`include variables.conf;`. 例如

    nginx.conf：

    ```
    include variables.conf

    ...

    http {
       listen $port;
       ... 
    } 
    ```

    变量.conf：

    ```
    set $foo "Something";
    set $bar "Else";
    set $port 80; 
    ```

# html - How to minify Wordpress output html code on single line?

> ID：12554972
> 
> 赞同：-2
> 
> 时间：2012-09-23T18:20:51.393
> 
> 标签：html, wordpress, compression, minify

i need to speed up my Wordpress blog. I searched around the web, but no success. I want to minify or compress my output html code on one(single) line, like [Matt Cutt's blog](http://www.mattcutts.com/blog/). I tried W3TC, WP Minify and many others, but without result. I need script, plugin, function or something that works.

Thanks in advance.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T18:31:55.867

This is really not the best way to speedup your site. If you do it in the template it make the files unreadable and hard to maintain for less than 1% speedup. If you do it with a plugin that process the output, it will slow down the render.

Make sure :

*   You use as few plugins as possible, for example it's much faster to copy tracking code (google analytics or such) in footer.php than using a plugin
*   You have compiled, cleaned, minifyied CSS and JS that is on your server and properly compressed files.
*   You use CDN for all files that are on CDN like JQuery on [https://developers.google.com/speed/libraries/devguide](https://developers.google.com/speed/libraries/devguide)
*   Put mod_expire on your server and set expire date for media files far in future with .htaccess . This will prevent browsers from checking if files have changed (all the 200 status code you see in network traffic analysis)
*   Cache content using WP supercache or similar plugin
*   Install APC cache with enough memory (at least 32M for a single WP installation)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-12-14T17:31:16.220

Here is one solution what I give in WordPress.StackExchange.com

[https://wordpress.stackexchange.com/a/227896/82023](https://wordpress.stackexchange.com/a/227896/82023)

Generaly, in index.php you can place one code what will compress your HTML using regex. i made and use this on many places and work fine. Is not complete inline but do it's job.

```
<?php
/**
 * Front to the WordPress application. This file doesn't do anything, but loads
 * wp-blog-header.php which does and tells WordPress to load the theme.
 *
 * @package WordPress
 */

/**
 * Tells WordPress to load the WordPress theme and output it.
 *
 * @var bool
 */
define('WP_USE_THEMES', true);

/** Manualy compress WP by Ivijan-Stefan Stipic  **/

function compressorCF($str)
{
    // clear HEAD
    $str = preg_replace_callback('/(?=<head(.*?)>)(.*?)(?<=<\/head>)/s',
    function($matches) {
        return preg_replace(array(
            /* Fix HTML */
            '/\>[^\S ]+/s',  // strip whitespaces after tags, except space
            '/[^\S ]+\</s',  // strip whitespaces before tags, except space
            '/\>\s+\</',    // strip whitespaces between tags
        ), array(
            /* Fix HTML */
            '>',  // strip whitespaces after tags, except space
            '<',  // strip whitespaces before tags, except space
            '><',   // strip whitespaces between tags
        ), $matches[2]);
    }, $str);
    // clear BODY
    $str = preg_replace_callback('/(?=<body(.*?)>)(.*?)(?<=<\/body>)/s',
    function($matches) {
        return preg_replace(array(
            '/<!--(.*?)-->/s', // delete HTML comments
            '@\/\*(.*?)\*\/@s', // delete JavaScript comments
            /* Fix HTML */
            '/\>[^\S ]+/s',  // strip whitespaces after tags, except space
            '/[^\S ]+\</s',  // strip whitespaces before tags, except space
            '/\>\s+\</',    // strip whitespaces between tags
        ), array(
            '', // delete HTML comments
            '', // delete JavaScript comments
            /* Fix HTML */
            '>',  // strip whitespaces after tags, except space
            '<',  // strip whitespaces before tags, except space
            '><',   // strip whitespaces between tags
        ), $matches[2]);
    }, $str);
    return $str;
}

/** Loads the WordPress Environment and Template */
ob_start();
    require_once( dirname( __FILE__ ) . '/wp-blog-header.php' );
$content=ob_get_clean();
//echo $content;
echo compressorCF($content); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-06-30T04:00:22.333

If your plugin loads CSS and JS files properly there is no point to say that they will make your website slow. 1\. Another issue is how many database call these plugin make to render a particular task. 2\. Whether that plugin check data from a remote server to update something like akismat and jetpack, thus makes these two pluin the most resource hungry.

1.  Proper coded theme can help you to load your website properly. like my own site ( [http://www.binarynote.com](http://www.binarynote.com) ) score loads score is 99/100 in getmetrix.com

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-10-25T15:35:55.273

We have Just developed a code in C++ using that we can compress any code. The main function is given here for your ready reference.

```
//function to compress text files
void compress(char source[], char dest[])
{
  ifstream fin(source);
  ofstream fout(dest);
  char ch;
  int sp=0;
  while(fin.get(ch))
   {
      if(ch==' '||ch=='\t')
         sp++;
      else
         sp=0;
      if(ch=='\n' || ch=='\r')
         fout<<' ';
      else
          if(sp>=1)
             fout<<' ';
          else
             fout<<ch;
  } 
  fin.close();
  fout.close();
} 
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2015-04-29T13:12:07.747

Put this code to function.php:

```
class WP_HTML_Compression
{
  // Settings
  protected $compress_css = true;
  protected $compress_js = true;
  protected $info_comment = true;
  protected $remove_comments = true;
  // Variables
  protected $html;

  public function __construct($html)
  {
    if (!empty($html))
    {
      $this->parseHTML($html);
    }
  }

  public function __toString()
  {
    return $this->html;
  }

  protected function bottomComment($raw, $compressed)
  {
    $raw = strlen($raw);
    $compressed = strlen($compressed);
    $savings = ($raw-$compressed) / $raw * 100;
    $savings = round($savings, 2);
    return '<!--HTML compressed, size saved '.$savings.'%. From '.$raw.' bytes, now '.$compressed.' bytes-->';
  }

  protected function minifyHTML($html)
  {
    $pattern = '/<(?<script>script).*?<\/script\s*>|<(?<style>style).*?<\/style\s*>|<!(?<comment>--).*?-->|<(?<tag>[\/\w.:-]*)(?:".*?"|\'.*?\'|[^\'">]+)*>|(?<text>((<[^!\/\w.:-])?[^<]*)+)|/si';
    preg_match_all($pattern, $html, $matches, PREG_SET_ORDER);
    $overriding = false;
    $raw_tag = false;
    // Variable reused for output
    $html = '';
    foreach ($matches as $token)
    {
      $tag = (isset($token['tag'])) ? strtolower($token['tag']) : null;
      $content = $token[0];
      if (is_null($tag))
      {
        if ( !empty($token['script']) )
        {
          $strip = $this->compress_js;
        }
        else if ( !empty($token['style']) )
        {
          $strip = $this->compress_css;
        }
        else if ($content == '<!--wp-html-compression no compression-->')
        {
          $overriding = !$overriding;
          // Don't print the comment
          continue;
        }
        else if ($this->remove_comments)
        {
          if (!$overriding && $raw_tag != 'textarea')
          {
            // Remove any HTML comments, except MSIE conditional comments
            $content = preg_replace('/<!--(?!\s*(?:\[if [^\]]+]|<!|>))(?:(?!-->).)*-->/s', '', $content);
          }
        }
      }
      else
      {
        if ($tag == 'pre' || $tag == 'textarea')
        {
          $raw_tag = $tag;
        }
        else if ($tag == '/pre' || $tag == '/textarea')
        {
          $raw_tag = false;
        }
        else
        {
          if ($raw_tag || $overriding)
          {
            $strip = false;
          }
          else
          {
            $strip = true;
            // Remove any empty attributes, except:
            // action, alt, content, src
            $content = preg_replace('/(\s+)(\w++(?<!\baction|\balt|\bcontent|\bsrc)="")/', '$1', $content);
            // Remove any space before the end of self-closing XHTML tags
            // JavaScript excluded
            $content = str_replace(' />', '/>', $content);
          }
        }
      }
      if ($strip)
      {
        $content = $this->removeWhiteSpace($content);
      }
      $html .= $content;
    }
    return $html;
  }

  public function parseHTML($html)
  {
    $this->html = $this->minifyHTML($html);
    if ($this->info_comment)
    {
      $this->html .= "\n" . $this->bottomComment($html, $this->html);
    }
  }

  protected function removeWhiteSpace($str)
  {
    $str = str_replace("\t", ' ', $str);
    $str = str_replace("\n", '', $str);
    $str = str_replace("\r", '', $str);
    while (stristr($str, ' '))
    {
      $str = str_replace(' ', ' ', $str);
    }
    return $str;
  }
}

function wp_html_compression_finish($html)
{
  return new WP_HTML_Compression($html);
}

function wp_html_compression_start()
{
  ob_start('wp_html_compression_finish');
}

add_action('get_header', 'wp_html_compression_start'); 
```

on [https://photogrist.com](https://photogrist.com) it's works fine :)

# java - 创建一个变量来保存一个对象有时是多余的吗？

> ID：12554977
> 
> 赞同：2
> 
> 时间：2012-09-23T18:21:24.737
> 
> 标签：java

我已经看过很多次了：

```
public class MyApp extends SomeLibrary
{
  public static void main(String[] args)
  {
    MyApp app = new MyApp();
    app.run();
  }
} 
```

代替：

```
MyApp app = new MyApp();
app.run(); 
```

为什么不这样做：

```
(new MyApp()).run(); 
```

当 a) 垃圾收集存在时，b) 很明显内部不会运行其他任何东西`public static void main`，并且 c)`app`显然不会再次被引用？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-23T18:23:29.007

*   它没有任何区别（我怀疑字节码甚至可能是相同的 - 编辑：刚刚检查：它不是）
*   第一种形式通常更具可读性
*   当可读性不受影响时，第二个是有意义的 - 典型示例：

    ```
    new Thread(someRunnable).start(); 
    ```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-23T18:22:34.347

是的，如果您的应用程序中没有更多内容，您可以这样做

```
(new MyApp()).run(); 
```

但通常，应用程序稍微复杂一些，并且您将实例分配给一个变量，因为您需要进行初始化。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-23T18:24:41.207

除了可读性之外，这两种方式没有区别：一些 IDE 实际上建议用后者替换前者。我其实更喜欢`new MyApp().run();`自己。

# php - 记住输入字段

> ID：12554979
> 
> 赞同：0
> 
> 时间：2012-09-23T18:21:32.037
> 
> 标签：php

我的注册表中有这样的代码

```
$_POST['email'] = trim($_POST['email']);
        if($_POST['email']){
             if(!eregi("^[a-zA-Z0-9]+[a-zA-Z0-9_.-]*@[a-zA-Z0-9]+[a-zA-Z0-9_.-])*\.[a-z]{2,4}$", $_POST['email'])){
              $error['emailerror'] = "  <span class='Register_Tip'>Wrong Email</span>"; 
```

它告诉用户电子邮件是错误的

但在他看到错误后，表格被重置

我需要表格来记住用户写的值

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T18:32:45.403

您需要检查相应输入的 POST 数据是否存在，如下所示：

```
<input type='text' name='email' value ="<?php isset( $_POST['email'] ) ? $_POST['email'] : '' ?>" > 
```

# php - PHP htmlentities（指定了 UTF-8 编码）是否足以保护 XSS

> ID：12554980
> 
> 赞同：-2
> 
> 时间：2012-09-23T18:21:32.960
> 
> 标签：php, xss, security

假设 PHP 中的模板代码是

```
<div>
  <? echo htmlentities($unfiltered_text, ENT_QUOTES, "UTF-8");
</div> 
```

下面的代码安全`ALL possible XSS`吗？

不是，你能举个例子吗？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T18:24:03.660

是的，htmlentities 将转换所有在 HTML 中具有特殊含义的字符。

# javascript - 如何使用 javascript 获取此集合的总计数 id？

> ID：12554983
> 
> 赞同：0
> 
> 时间：2012-09-23T18:21:43.593
> 
> 标签：javascript, arrays, collections

我有这个收藏：[https ://graph.facebook.com/2playcz/albums](https://graph.facebook.com/2playcz/albums)

此集合包含 8 个 ID。如何使用 javascript 获取此集合的总计数 id？（*总计 = 8*）

**来源：**

```
 {
       "data": [
          {
             "id": "201936779932071",
             "from": {
                "name": "2play.cz - Tenisov\u00e1 \u0161kola",
                "category": "Sports league",
                "id": "190320081093741"
             },
             "name": "Tr\u00e9ninky",
             "link": "https://www.facebook.com/album.php?fbid=201936779932071&id=190320081093741&aid=41883",
             "cover_photo": "201937046598711",
             "count": 8,
             "type": "normal",
             "created_time": "2012-07-02T09:33:43+0000",
             "updated_time": "2012-09-15T12:05:44+0000",
             "can_upload": false,
             "likes": {
                "data": [
                   {
                      "id": "1788805921",
                      "name": "Edita Nov\u00e1"
                   },
                   {
                      "id": "100001449904219",
                      "name": "Mirka Brani\u0161ov\u00e1"
                   }
                ],
                "paging": {
                   "next": "https://graph.facebook.com/201936779932071/likes?limit=25&offset=25&__after_id=100001449904219"
                }
             }
          },
          {
             "id": "205206429605106",
             "from": {
                "name": "2play.cz - Tenisov\u00e1 \u0161kola",
                "category": "Sports league",
                "id": "190320081093741"
             },
             "name": "Turnaje a akce",
             "link": "https://www.facebook.com/album.php?fbid=205206429605106&id=190320081093741&aid=42900",
             "cover_photo": "205208716271544",
             "count": 14,
             "type": "normal",
             "created_time": "2012-07-10T19:36:53+0000",
             "updated_time": "2012-09-15T12:04:05+0000",
             "can_upload": false
          },
          {
             "id": "221784994613916",
             "from": {
                "name": "2play.cz - Tenisov\u00e1 \u0161kola",
                "category": "Sports league",
                "id": "190320081093741"
             },
             "name": "Tenisova \u0161kolka 2play",
             "description": "Tenisov\u00e1 \u0161kolka 2play",
             "link": "https://www.facebook.com/album.php?fbid=221784994613916&id=190320081093741&aid=49379",
             "cover_photo": "221785024613913",
             "count": 9,
             "type": "normal",
             "created_time": "2012-08-31T11:19:59+0000",
             "updated_time": "2012-09-14T15:17:53+0000",
             "can_upload": false
          },
          {
             "id": "203405996451816",
             "from": {
                "name": "2play.cz - Tenisov\u00e1 \u0161kola",
                "category": "Sports league",
                "id": "190320081093741"
             },
             "name": "Webov\u00e9 fotografie - Logo",
             "link": "https://www.facebook.com/album.php?fbid=203405996451816&id=190320081093741&aid=42285",
             "cover_photo": "203406586451757",
             "count": 11,
             "type": "normal",
             "created_time": "2012-07-05T10:12:40+0000",
             "updated_time": "2012-09-14T15:16:40+0000",
             "can_upload": false
          },
          {
             "id": "190332361092513",
             "from": {
                "name": "2play.cz - Tenisov\u00e1 \u0161kola",
                "category": "Sports league",
                "id": "190320081093741"
             },
             "name": "Cover Photos",
             "link": "https://www.facebook.com/album.php?fbid=190332361092513&id=190320081093741&aid=39232",
             "cover_photo": "225939404198475",
             "count": 2,
             "type": "normal",
             "created_time": "2012-06-09T13:52:38+0000",
             "updated_time": "2012-09-12T18:15:51+0000",
             "can_upload": false
          },
          {
             "id": "190802884378794",
             "from": {
                "name": "2play.cz - Tenisov\u00e1 \u0161kola",
                "category": "Sports league",
                "id": "190320081093741"
             },
             "name": "Wall Photos",
             "link": "https://www.facebook.com/album.php?fbid=190802884378794&id=190320081093741&aid=39324",
             "cover_photo": "190802891045460",
             "count": 2,
             "type": "wall",
             "created_time": "2012-06-10T13:19:48+0000",
             "updated_time": "2012-07-17T17:16:19+0000",
             "can_upload": false
          },
          {
             "id": "205207126271703",
             "from": {
                "name": "2play.cz - Tenisov\u00e1 \u0161kola",
                "category": "Sports league",
                "id": "190320081093741"
             },
             "name": "Ostatn\u00ed",
             "link": "https://www.facebook.com/album.php?fbid=205207126271703&id=190320081093741&aid=42902",
             "cover_photo": "205209679604781",
             "count": 4,
             "type": "normal",
             "created_time": "2012-07-10T19:40:05+0000",
             "updated_time": "2012-07-16T14:47:16+0000",
             "can_upload": false,
             "likes": {
                "data": [
                   {
                      "id": "100001449904219",
                      "name": "Mirka Brani\u0161ov\u00e1"
                   }
                ],
                "paging": {
                   "next": "https://graph.facebook.com/205207126271703/likes?limit=25&offset=25&__after_id=100001449904219"
                }
             }
          },
          {
             "id": "190320914426991",
             "from": {
                "name": "2play.cz - Tenisov\u00e1 \u0161kola",
                "category": "Sports league",
                "id": "190320081093741"
             },
             "name": "Profile Pictures",
             "link": "https://www.facebook.com/album.php?fbid=190320914426991&id=190320081093741&aid=39224",
             "cover_photo": "190327474426335",
             "count": 1,
             "type": "profile",
             "created_time": "2012-06-09T13:29:16+0000",
             "updated_time": "2012-06-09T13:43:08+0000",
             "can_upload": false
          },
          {
             "id": "190322704426812",
             "from": {
                "name": "2play.cz - Tenisov\u00e1 \u0161kola",
                "category": "Sports league",
                "id": "190320081093741"
             },
             "name": "Logo",
             "description": "Loga spole\u010dnosti",
             "link": "https://www.facebook.com/album.php?fbid=190322704426812&id=190320081093741&aid=39225",
             "type": "normal",
             "created_time": "2012-06-09T13:34:09+0000",
             "updated_time": "2012-07-05T10:16:58+0000",
             "can_upload": false
          }
       ]
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T18:22:46.547

如果您的意思是`data`数组中的项目数，那就是`data.length`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T18:46:03.990

首先，有**9个**ID。如果要计算数组中元素的数量，则有一个内置属性`length`。因此，如果您的对象被调用`x`，您可以通过访问来检索数据的长度`x.data.length`。

另一方面，如果您想计算唯一 ID 的数量（无论如何，ID 应该是唯一的，但如果您真的想要），您必须手动遍历数组并计算它们：

```
var countIds = function (arr) {
    var uniqueIds = {}, num = 0;
    if (!arr.data) return false;
    arr.data.forEach(function (val, i) {
      if (typeof uniqueIds[val.id] === "undefined") {
        ++num;
        uniqueIds[val.id] = true;
      }
    });
    return num;
}; 
```

# java - 跳到 for 循环中的下一个用户输入

> ID：12554984
> 
> 赞同：-1
> 
> 时间：2012-09-23T18:21:47.620
> 
> 标签：java, loops

如果我想更改一些数据，但保留一些原始名称，当我按 Enter 时如何跳到下一个用户输入？

```
 for (int i = 0; i < myVector.size(); i++)
{
    System.out.println("Press Enter to skip to next input");
    System.out.print("Enter Name: ");
//If user presses Enter/newline, go to the next part where it asks for Name2

    Name = keyboard.nextLine();
    System.out.println("You've entered: " + Name);
    myVector.elementAt(i).setName(Name);

    System.out.println("Press Enter to skip to next input");
    System.out.print("Enter Name2: ");

    Name2 = keyboard.nextLine();
    System.out.println("You've entered: " + Name2);
    myVector.elementAt(i).setName(Name2);

//...etc
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T18:23:36.807

使用 continue 关键字（[来自 oracle 文档](http://docs.oracle.com/javase/tutorial/java/nutsandbolts/branch.html)）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-23T18:24:34.590

```
loop: for (int i = 0; i < myVector.size(); i++)
{
    Scanner sc = new Scanner(System.in);
    if(user presses enter) {
        System.out.println("Press Enter to skip to next input");
        System.out.print("Enter Name: ");
        //If user presses Enter/newline, go to the next part where it asks for Name2

        continue loop;
    }    
    else {
        Name = keyboard.nextLine();
        System.out.println("You've entered: " + Name);
        myVector.elementAt(i).setName(Name);

        System.out.println("Press Enter to skip to next input");
        System.out.print("Enter Name2: ");

        Name2 = keyboard.nextLine();
        System.out.println("You've entered: " + Name2);
        myVector.elementAt(i).setName(Name2);

        //...etc
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-23T18:26:43.983

```
Name = keyboard.nextLine();
if (!Name.isEmpty()) {
  System.out.println("You've entered: " + Name);
  myVector.elementAt(i).setName(Name);
} 
```

即，如果`Name`为空，则跳至`Name2`。

# templates - Blogger，自定义模板的 tumblr 选项

> ID：12554985
> 
> 赞同：1
> 
> 时间：2012-09-23T18:21:52.407
> 
> 标签：templates, blogger

这些应用程序如何允许用户上传自己的模板？这怎么可能？

他们是否有某种自己的模板引擎或..？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T10:41:50.857

**Tumblr**为您提供了两个选项来包含您自己的主题：

1.  如果只是供个人使用：通过更改主题的html。如果你去你的 tumblr 网站并点击`customize`按钮，你可以编辑 html。在头文件中，您的 .css 内容必须粘贴在`<style type="text/css"> </style>`标签之间。你可以在那里添加一些javascript。对于 html，我建议阅读 Mirko Adari 建议的手册：[Tumblr Theme manual](http://www.tumblr.com/docs/en/custom_themes)
2.  如果您希望它本身成为一个主题：将您的主题提交到主题花园：[Tumblr 主题花园](http://www.tumblr.com/themes/new)

**Blogger**比较僵化。您还可以在那里更改您的 html 文件。请记住，它的帖子标记与 Tumblr 不同。还可以添加自定义 CSS 文件（[更多信息](http://support.google.com/blogger/bin/answer.py?hl=en&answer=176245)）。如果您对 css 和 html 不太熟悉，Blogger 提供了一些按钮，以便您可以根据自己的需要更改基础知识。Blogger 还提供了一种备份和恢复主题的方法。更详细的解释可以在[这里](http://www.bloggerbuster.com/2012/04/how-to-back-up-restore-and-upload-new.html)找到。此模板文件必须是`.xml`文件。可以在[此处](http://www.ourblogtemplates.com/2007/06/structure-of-blogger-template-code.html)找到有关此 xml 模板标记的更多信息。

# javascript - 在 Django 视图中解码查询字符串参数

> ID：12554991
> 
> 赞同：3
> 
> 时间：2012-09-23T18:22:16.213
> 
> 标签：javascript, python, django

我的应用中有一个使用 jQuery 自动完成插件的搜索表单。在运行查询字符串后，插件会发送建议的项目`encodeURI(q)`。

所以像**约翰尼的运动**这样的项目在我看来是`Johnny&#39;s sports`

如何将字符串解码回**Johnny's Sports**，以便查询数据库？

我已经尝试了`urllib`其他帖子中建议的几个功能，但我认为我严重误解了它们的工作原理，因为我没有看到它工作。

任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T19:51:56.673

Python 的标准库包含`HTMLParser`. 它可以执行转义 HTML 实体的解码，如本答案所述：[https ://stackoverflow.com/a/2087433/145400](https://stackoverflow.com/a/2087433/145400)

```
>>> import HTMLParser
>>> h = HTMLParser.HTMLParser()
>>> print h.unescape('Johnny&#39;s sports')
Johnny's sports 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T18:40:06.797

你可以试试这个[问题的答案。](https://stackoverflow.com/questions/57708/convert-xml-html-entities-into-unicode-string-in-python)似乎做你需要的。

# c# - AJAX HtmlEditorExtender 并从文本框中获取文本？

> ID：12554995
> 
> 赞同：2
> 
> 时间：2012-09-23T18:22:45.120
> 
> 标签：c#, asp.net, .net, ajax, htmleditorextender

我刚刚开始掌握 Web 开发并尝试积累一些经验。我正在我的网站中实现 HtmlEditorExtender。我已经添加了使用此控件所需的所有文件和引用，并且控件显示正确。我遇到的问题是在进行更改后我似乎无法获取文本框的内容。我已将控件附加到文本框，然后用我希望编辑的内容填充文本框。完成更改后，我有一个保存按钮，可以将当前内容保存在 HTML 编辑器中。我看到的是 Textbox 的 Text 属性与我进行更改之前完全相同。有什么明显的东西我失踪了。

代码如下：

用户控件中的标记：

```
<asp:ScriptManager ID="ScriptManager1" runat="server">
</asp:ScriptManager>
<asp:Panel ID="pnlPopup" runat="server" Style="display: none" CssClass="modalPopup">
    <asp:Panel ID="Panel3" runat="server" Style="background-color: #DDDDDD; border: solid 1px Gray;
     color: Black;">
        <p>
            Edit:
        </p>
    </asp:Panel>
        <asp:TextBox runat="server" ID="txtHTMLContent" CssClass="WhiteTextBox" TextMode="MultiLine"
            Columns="50" Rows="10" />
        <br />
        <ajaxToolkit:HtmlEditorExtender ID="htmlEditor" TargetControlID="txtHTMLContent" Runat="server" EnableSanitization="false" />
    <center>    
        <asp:Button ID="btnSave" runat="server" Text="Save" OnClick="btnSave_Click" />
        <asp:Button ID="btnCancel" runat="server" Text="Cancel" />
    </center>
</asp:Panel> 
```

代码隐藏：

```
protected void Page_Load(object sender, EventArgs e)
{
    string content = GetContent();
    txtHTMLContent.Text = content;
}

protected void btnSave_Click(object sender, EventArgs e)
{
    DatabaseManager dm = new DatabaseManager();
    dm.UpdateContent(txtHTMLContent.Text);
} 
```

我将不胜感激任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T18:50:34.807

在`if(!IsPostback)`检查 Page_Load 方法中包装 txtHTMLContent 初始化代码：

```
protected void Page_Load(object sender, EventArgs e)
{
    if (!IsPostBack)
    {
        string content = GetContent();
        txtHTMLContent.Text = content;
    }
} 
```

# asp.net - ASP.NET Response.BinaryWrite 在创建 Excel 文件时在 ie 中引发错误

> ID：12554998
> 
> 赞同：2
> 
> 时间：2012-09-23T18:22:52.800
> 
> 标签：asp.net, excel

我有一个返回字节数组的方法。然后我将此数组作为 excel 文件写入输出流。一些用户在 ie7 中报告“Internet Explorer 无法打开此 Internet 站点”错误。

在测试环境（使用 ie9）中运行它时，我没有收到此错误。但是，有时我第一次单击链接时，Excel 会打开，但我会收到一条错误消息，显示“将命令发送到程序时出现问题”并且文件不会加载到 Excel 中。如果我再次单击该链接，该文件将在 Excel 中正常打开。这是在用户单击页面上的链接后通过响应流发送字节数组的代码。

```
byte[] buffer = GetBinary();
Response.ContentType = "application/vnd.ms-excel";
Response.Buffer = true;
Response.Expires = 0;
Response.AddHeader("Content-Type", "application/vnd.ms-excel");
Response.AddHeader("Content-Length", buffer.Length.ToString());
Response.Cache.SetCacheability(HttpCacheability.NoCache);
Response.AddHeader("Content-Disposition", "attachment;filename=xx.xls");
Response.BinaryWrite(buffer);
Response.End(); 
```

如果有什么不同，他们点击的链接会打开一个新窗口，上面的代码块会在新页面的 page_load 事件中执行。什么可能导致这些错误？我之前使用过类似的代码，没有任何问题。