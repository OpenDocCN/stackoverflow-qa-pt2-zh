# StackOverflow 问答 13209000-13209999

# javascript - 尝试使用 jquery each() 函数将值放入数组时出错

> ID：13209003
> 
> 赞同：0
> 
> 时间：2012-11-03T12:05:55.083
> 
> 标签：javascript, jquery, each

我有这个代码：

```
$(".categoty-add").each(function(i) {
            categories[i][0] = $(this).val();
    }); 
```

在输出中我得到

```
TypeError: can't convert undefined to object    
categories[i][0] = $(this).val(); 
```

这是我的数组：

```
 var categories = new Array(2);
    for (i = 0; i < categories . length; ++ i)
    categories [i] = new Array (2); 
```

怎么了？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T15:57:33.470

要动态创建一个数组（第一次运行代码），然后更新它，您可以这样做：

```
/* create empty array, syntax is shortcut for new Array() and just as efficient*/
var categories=[];

$(".categoty-add").each(function(i) {
   if( categories[i] ){ /* if doesn't exist will be undefined and trigger "else"*/
        /* sub array exists, just update it*/
        categories[i][0] = $(this).val();
    }else{ 
        /* create new sub array and give value to first position */
        categories[i] =[ $(this).val()];
    }
}); 
```

演示：http: [//jsfiddle.net/FFQ2s/](http://jsfiddle.net/FFQ2s/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T12:22:08.140

必须有两个带有 class 的文本框`category-add`。如果它们超过两个，那么您的迭代器 i 将被分配一个值 >= 2，然后您的语句变为

```
categories[2][0] = $(this).val(); 
```

这超出了数组的范围。

# asp.net-mvc - 控制台应用程序 HttpClient 发布到 mvc web api

> ID：13209010
> 
> 赞同：6
> 
> 时间：2012-11-03T12:06:23.113
> 
> 标签：asp.net-mvc, asp.net-web-api, dotnet-httpclient

我有一个从 Visual Studio 2012 模板构建的默认 mvc web api 实例。它在默认的 ValuesController 中具有以下路由和 post 方法 - 除了 Post 方法的内容之外，MVC 站点在初始创建时未修改。此外，我正在使用 .NET 框架 4.0，因为我计划以 Azure 为目标。

注册方法

```
public static void Register(HttpConfiguration config)
{
    config.Routes.MapHttpRoute(
        name: "DefaultApi",
        routeTemplate: "api/{controller}/{id}",
        defaults: new { id = RouteParameter.Optional }
    );
} 
```

和 Post 方法

```
 // POST api/values
    public string Post([FromBody]string value)
    {
        if (value != null)
        {
            return "Post was successful";
        }
        else
            return "invalid post, value was null";
    } 
```

我创建了一个控制台应用程序，它使用 HttpClient 来模拟向服务发布，但不幸的是，进入 Post 的“值”始终为空。Post 方法在 HttpClient 上的 PostAsync 调用之后成功命中。

我不清楚如何映射我的请求以使值包含我传入的 StringContent ...

```
 static void Main(string[] args)
    {
        string appendUrl = string.Format("api/values");
        string totalUrl = "http://localhost:51744/api/values";
        HttpClient client = new HttpClient();
        client.DefaultRequestHeaders.Add("Accept", "application/xml");

        string content = "Here is my input string";
        StringContent sContent = new StringContent(content, Encoding.UTF8, "application/xml");

        HttpResponseMessage response = null;
        string resultString = null;

        client.PostAsync(new Uri(totalUrl), sContent).ContinueWith(responseMessage =>
            {
                response = responseMessage.Result;
            }).Wait();

        response.Content.ReadAsStringAsync().ContinueWith(stream =>
            {
                resultString = stream.Result;
            }).Wait();          
    } 
```

我是 MVC web api 和使用 HttpClient 的新手 - 任何为我指明正确方向的帮助将不胜感激。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-03T15:05:18.140

试试下面的代码：

```
class Program {

    static void Main(string[] args) {

        HttpClient client = new HttpClient();
        var content = new StringContent("=Here is my input string");
        content.Headers.ContentType = new MediaTypeHeaderValue("application/x-www-form-urlencoded");
        client.PostAsync("http://localhost:2451/api/values", content)
            .ContinueWith(task => {

                var response = task.Result;
                Console.WriteLine(response.Content.ReadAsStringAsync().Result);
            });

        Console.ReadLine();
    }
} 
```

查看此博客文章的*“发送简单类型”*部分：[http ://www.asp.net/web-api/overview/working-with-http/sending-html-form-data,-part-1](http://www.asp.net/web-api/overview/working-with-http/sending-html-form-data,-part-1)

# delphi - 如何使用自定义对齐程序创建组件？

> ID：13209011
> 
> 赞同：0
> 
> 时间：2012-11-03T12:06:22.950
> 
> 标签：delphi

我想创建一个组件，但我对 Align 的工作方式不满意，所以我想创建自己的属性以完全不同的方式重新定位组件。但是我不确定在哪里使用它-应该在哪里调用它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T13:37:40.983

一种快速访问是覆盖 SetBounds，以确保调用它，您必须设置除 alNone 之外的 Alignment

```
type
  TMyButton=Class(Tbutton)
      procedure SetBounds(ALeft, ATop, AWidth, AHeight: Integer); override;

  End;

//..............

procedure TForm3.Button1Click(Sender: TObject);
begin
  With TMyButton.Create(self) do
    begin
      Parent := self;
      Width := 200;
      top := 100;
      Height := 100;
      align := alCustom; // was alRight thanks to David Heffernan
    end;
end;

{ TMyButton }

procedure TMyButton.SetBounds(ALeft, ATop, AWidth, AHeight: Integer);
begin
   if Assigned(parent)  then
      begin // .. just e.g.
        ALeft :=  Parent.Width - Width -100 ;
        ATop := 100;
        AHeight := Parent.Height - Atop - 100 ;
      end;
   inherited;

end; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-07T13:03:13.067

这篇由前 Borland 开发人员 Steve Trefethen 撰写的[文章](http://cc.embarcadero.com/item/17340)展示了如何使用`alCustom`.

# sql-server - 如何获取合并推送订阅状态？

> ID：13209014
> 
> 赞同：-1
> 
> 时间：2012-11-03T12:06:29.667
> 
> 标签：sql-server, replication, merge-replication

我有合并复制设置与推送订阅。我阅读了以下文章：[实现复制代理进度条](http://www.sqlrepl.com/sql-server/implementing-a-replication-agent-progess-bar/) 如果我从订阅者启动代理，它工作正常，但 MergeSynchronizationAgent 类的状态事件仅显示客户端启动的会话的状态更新！简而言之：我正在寻找默认复制窗口显示的相同行为。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T16:12:51.463

我写这篇文章是为了演示如何使用 RMO 同步 Merge Pull 订阅，处理 MergeSynchronizationAgent 状态事件以实现带有代理状态消息的进度条。

要使此功能与合并推送订阅一起使用，您将需要使用[MergeSubscription](http://msdn.microsoft.com/en-us/library/microsoft.sqlserver.replication.mergesubscription.aspx)类。请参阅[如何：同步推送订阅（RMO 编程）](http://msdn.microsoft.com/en-us/library/ms146910.aspx)中*的将推送订阅同步到合并发布*部分。

# c - 使用 C 中的函数更改字符串数组内容

> ID：13209015
> 
> 赞同：3
> 
> 时间：2012-11-03T12:06:39.010
> 
> 标签：c, arrays, string, function, replace

因此，我对 C 编程非常陌生，并尝试将字符串替换为我读取的文件中的日期，然后将其写入另一个文件。但问题是当我将它写入文件时，字符串保持不变。

我想要的是从文件中读取这个：

```
<html>
<head>
<!--#include file=”date”-->
</head>
<body>
</body>
</html> 
```

输出文件

```
<html>
<head>
Sat Nov 3 14:43:53 2012
</head>
<body>
</body>
</html> 
```

我收到一个错误：从不兼容的指针类型传递 date_change 中的参数 1

代码

//系统日期替换函数

```
void *date_change(char** s, char* str, char* date){

    static char buffer[4096];
    char *p;

    if(!(p = strstr(*s, str)))  // <!--#echo var=\"date\"--> find this
       return *s;

    strncpy(buffer, *s, p-*s); //
    buffer[p-*s] = '\0';

    sprintf(buffer+(p-*s), "%s%s", date, p+strlen(str));

    return buffer;
} 
```

//主要的

```
int main(int argc, char *argv[]){
    int f;

    f = open(argv[1], O_RDONLY);

    if(errno != 0){
        perror("Hiba");
        exit(1);
    }

    //read from file
    char c[1000];
    while(read(f,&c, 1000)){

    } 
```

// --------------------------------// 获取系统日期并尝试用 date_change 函数替换它

```
 time_t mytime;
    mytime = time(NULL);
    struct tm *time = localtime(&mytime);
    char date[20];
    strftime(date, sizeof(date), "%c", time); //format time as string

    char* date_str;

    int g = open("data.txt", O_WRONLY | O_CREAT, 0600);

    //should replace all <!--#echo var=\"date\" --> to the system date
    while(date_str = strstr(c, "<!--#echo var=\"date\"-->")){
           date_change(&c, date_str, date);
    }
    write(g, c, strlen(c));

    close(g); 
```

// -------------------------------- //

```
 close(f);
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-03T12:09:57.100

您的代码不会尝试修改传递给它的缓冲区。相反，您创建了一个正在写入的静态数组，然后返回该静态数组（实际上不查看返回值）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T14:30:59.373

因为您使用的是文本文件，所以我会逐行阅读：

```
#include<stdio.h>
#include<stdlib.h>
#include<string.h>
#include<errno.h>
#include<time.h>

//System date replacement function

void *date_change(char* s, const char* str, const char* date) {

   static char new_line[2000];
   static char new_line2[2000];
   //should replace all <!--#echo var=\"date\" --> to the system date
   char *date_str = strstr(s,str);
   if ( date_str == NULL )
   {
      return s;
   }

   int prefix_length = date_str - s;
   strncpy(new_line,s,prefix_length);
   new_line[prefix_length] = '\0';
   strcat(new_line,date);
   strcat(new_line,s + prefix_length + strlen(str));
   strcpy(new_line2,new_line);
   while ( ( date_str = strstr(new_line,str) ) != NULL)  
   {
      prefix_length = date_str - new_line;
      strncpy(new_line2,new_line,prefix_length);
      new_line2[prefix_length] = '\0';
      strcat(new_line2,date);
      strcat(new_line2,new_line + prefix_length + strlen(str));
      strcpy(new_line,new_line2);
   }

   return new_line2;
}
//main

int main(int argc, char *argv[])
{
   (void) argc;
   FILE *f;

   f = fopen(argv[1], "r");

   if(errno != 0)
   {
      perror("Hiba");
      exit(1);
   }
   // --------------------------------
   // Get the System date and trying to replace it with the date_change function
   time_t mytime;
   mytime = time(NULL);
   struct tm *time = localtime(&mytime);
   char date[50];
   strftime(date, sizeof(date), "%c", time); //format time as string

   FILE *g = fopen("data.txt", "w");
   //read from file
   char c[1000];
   //const char *search_string = "<!--#echo var=\"date\" -->";
   const char *search_string = "<!--#include file=”date” -->";
   while(  fgets(c,sizeof(c),f) > 0  ){
      char *new_line = date_change(c, search_string, date);
      fputs(new_line, g);
   }

   fclose(g);
   fclose(f);
} 
```

输入文件：

```
<html>
<head>
<!--#include file="date"--> <p>this is important</p><!--#include file="date"--> the end
</head>
<body>
</body>
<!--#include file="date"-->
</html>
<!--#include file="date"--> <!--#include file="date"--> <!--#include file="date"--> <!--#include file="date"--> 
```

输出文件：

```
<html>
<head>
Sat Nov  3 10:22:06 2012 <p>this is important</p>Sat Nov  3 10:22:06 2012 the end
</head>
<body>
</body>
Sat Nov  3 10:22:06 2012
</html>
Sat Nov  3 10:22:06 2012 Sat Nov  3 10:22:06 2012 Sat Nov  3 10:22:06 2012 Sat Nov  3 10:22:06 2012 
```

# python - 为什么我得到错误不能将序列乘以'float' PYTHON 类型的非整数

> ID：13209016
> 
> 赞同：3
> 
> 时间：2012-11-03T12:06:41.403
> 
> 标签：python

我写了一个简单的程序来计算一些电气部件的税，它是这样的：

```
print "How much does it cost?",    
price = raw_input()    
print "Tax: %s" % (price * 0.25)    
print "Price including tax: %s" % (price * 1.25)    
raw_input ("Press ENTER to exit") 
```

我不断收到这个错误：

```
Traceback (most recent call last):
  File "moms.py", line 3, in <module>
    print "Tax: %s" % (price * 0.25)
TypeError: can't multiply sequence by non-int of type 'float' 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T12:09:20.680

您需要将返回的字符串转换为`raw_input()`第`float`一个：

```
price = float(raw_input("How much does it cost?")) # no need for extra print 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-03T12:09:06.243

这意味着这`price`不是一个数字。事实上，它是一个字符串，因为这就是`raw_input`返回的内容。你会想要使用 解析它`float`，或者使用`input`而不是`raw_input`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-03T12:09:17.077

基本上你不能将一个字符串乘以一个浮点数，也许你想要的是

```
price = float(raw_input()) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-03T12:11:20.417

是`price`一个字符串。您需要从输入的字符串创建一个浮点数：

```
>>> price_str = raw_input()
123.234
>>> print type(price)
<type 'str'>
>>> price = float(price_str)
>>> print type(price)
<type 'float'>
>>> print "Tax: %s" % (price * 0.25)   
Tax: 30.8085
>>> 
```

# mysql - 返回随机图片 SQL

> ID：13209021
> 
> 赞同：0
> 
> 时间：2012-11-03T12:07:23.320
> 
> 标签：mysql, sql

我有一个数据库，其中包含有关用户创建的项目的信息。每个项目可以有许多与之关联的图像，我希望有一个 SQL 查询，其中包含 4 个随机项目图像，但不应从同一项目返回图像两次。

这是对表结构的回顾（不完整，但包括相关信息）：

表 1：**item_images：**

```
+----------+--------------+
| item_id  |   filename   |
+----------+--------------+
|    1     |   test.jpg   | 
|    1     |   test2.jpg  |
|    5     |   testy.jpg  |
+----------+--------------+ 
```

表2：**item_link：**

```
+----------+-------------+
| item_id  | category_id |
+----------+-------------+
|    1     |      1      |
|    5     |      1      |
+----------+-------------+ 
```

因此，鉴于上述数据，我想为项目 #1 和 5 返回一个随机图像，因为它们都存在于类别 #1 中。

这是我已经尝试过的 SQL 查询，但由于某种原因，它总是返回相同的两个图像。我该如何修改它以从匹配的项目中返回随机图像？

```
SELECT `item_images`.`filename` AS `url` FROM `item_images`
  INNER JOIN `item_link` ON `item_images`.`item_id` = `item_link`.`item_id`
  WHERE `item_link`.`category_id` = 1 
  GROUP BY `item_link`.`item_id`
  ORDER BY RAND()
  LIMIT 4 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T12:16:03.013

要从表中查找随机图像，查询如下：

```
SELECT distinct `item_images`.`filename` AS `url` FROM `item_images`, `item_link` 
  WHERE `item_images`.`item_id` = `item_link`.`item_id` and `item_link`.`category_id` = 1 
  ORDER BY RAND()
  LIMIT 4 
```

它解决了你的问题

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-03T12:20:42.443

webduos 是对的，应该可以解决你的问题

这是[解释](http://www.w3schools.com/sql/sql_distinct.asp)

```
SELECT distinct `item_images`.`filename` AS `url` FROM `item_images`
INNER JOIN `item_link` ON `item_images`.`item_id` = `item_link`.`item_id`
WHERE `item_link`.`category_id` = 1 
GROUP BY `item_link`.`item_id`
ORDER BY RAND()
LIMIT 4 
```

# iphone - 了解崩溃报告

> ID：13209022
> 
> 赞同：0
> 
> 时间：2012-11-03T12:07:25.237
> 
> 标签：iphone, objective-c, ios, amazon-s3, amazon-web-services

当我使用 S3getObjectRequest 连接 iPhone 5 以连接其工作正常时，我有一个崩溃应用程序，但是当我断开电缆以将我的应用程序与 wifi 一起使用时，这里的应用程序崩溃是崩溃日志：

```
Incident Identifier: BFD481E9-114E-4676-AA36-CC544663BA8C
CrashReporter Key:   8187acf23ebe01b6678e473e051986b72bd0febd
Hardware Model:      iPhone5,2
Process:         friendsCam [1513]
Path:            /var/mobile/Applications/90A9B2A4-906E-48D3-8357-   1E23FB8ACD76/friendsCam.app/friendsCam
Identifier:      friendsCam
Version:         ??? (???)
Code Type:       ARM (Native)
Parent Process:  launchd [1]

Date/Time:       2012-11-03 12:59:38.706 +0100
OS Version:      iOS 6.0.1 (10A525)
Report Version:  104

Exception Type:  EXC_CRASH (SIGABRT)
Exception Codes: 0x0000000000000000, 0x0000000000000000
Crashed Thread:  9

Last Exception Backtrace:
0   CoreFoundation                  0x3bd2b3e2 __exceptionPreprocess + 158
1   libobjc.A.dylib                 0x3ad8495e objc_exception_throw + 26
2   CoreFoundation                  0x3bd2b302 +[NSException raise:format:] + 102
3   Foundation                      0x346b518e _NSFileHandleRaiseOperationException + 150
4   Foundation                      0x346938ee -[NSConcreteFileHandle writeData:] + 126
5   friendsCam                      0x000fbeb4 -[NSFileHandle(GTMFileHandleLogWriter) logMessage:level:] (GTMLogger.m:315)
6   friendsCam                      0x000fbd9e -[GTMLogger(PrivateMethods) logInternalFunc:format:valist:level:] (GTMLogger.m:292)
7   friendsCam                      0x000fbb00 -[GTMLogger logDebug:] (GTMLogger.m:199)
8   friendsCam                      0x000f190e -[AmazonS3Client invoke:] (AmazonS3Client.m:368)
9   friendsCam                      0x000f1024 -[AmazonS3Client getObject:] (AmazonS3Client.m:137)
10  friendsCam                      0x000b49b8 -[Home loadingImage] (Home.m:142)
11  Foundation                      0x346f5a3c __NSThread__main__ + 968
12  libsystem_c.dylib               0x350100dc _pthread_start + 304
13  libsystem_c.dylib               0x3500ffa4 thread_start + 4

Thread 0 name:  Dispatch queue: com.apple.main-thread
Thread 0:
0   libsystem_kernel.dylib          0x3ba84e30 mach_msg_trap + 20
1   libsystem_kernel.dylib          0x3ba84fd0 mach_msg + 48
2   CoreFoundation                  0x3bd002b6 __CFRunLoopServiceMachPort + 126
3   CoreFoundation                  0x3bcfefd6 __CFRunLoopRun + 814
4   CoreFoundation                  0x3bc72238 CFRunLoopRunSpecific + 352
5   CoreFoundation                  0x3bc720c4 CFRunLoopRunInMode + 100
6   GraphicsServices                0x3bdce336 GSEventRunModal + 70
7   UIKit                           0x3558f28c UIApplicationMain + 1116
8   friendsCam                      0x0003bbd8 main (main.m:16)
9   friendsCam                      0x0003a104 start + 36

Thread 1 name:  Dispatch queue: com.apple.root.default-priority
Thread 1:
0   libsystem_kernel.dylib          0x3ba956a4 __semwait_signal + 24
1   libsystem_c.dylib               0x350151be nanosleep + 138
2   libsystem_c.dylib               0x35075e4e sleep + 42
3   friendsCam                      0x000b7618 __20-[Home loadingImage]_block_invoke_0 (Home.m:119)
4   libdispatch.dylib               0x34b13790 _dispatch_call_block_and_release + 8
5   libdispatch.dylib               0x34b17652 _dispatch_root_queue_drain + 274
6   libdispatch.dylib               0x34b177d4 _dispatch_worker_thread2 + 88
7   libsystem_c.dylib               0x350057ee _pthread_wqthread + 358
8   libsystem_c.dylib               0x35005680 start_wqthread + 4

Thread 2 name:  Dispatch queue: com.apple.libdispatch-manager
Thread 2:
0   libsystem_kernel.dylib          0x3ba855d0 kevent64 + 24
1   libdispatch.dylib               0x34b18d22 _dispatch_mgr_invoke + 806
2   libdispatch.dylib               0x34b14374 _dispatch_mgr_thread + 32

Thread 3:
0   libsystem_kernel.dylib          0x3ba95d98 __workq_kernreturn + 8
1   libsystem_c.dylib               0x35005ad6 _pthread_workq_return + 14
2   libsystem_c.dylib               0x350057f2 _pthread_wqthread + 362
3   libsystem_c.dylib               0x35005680 start_wqthread + 4

Thread 4 name:  WebThread
Thread 4:
0   libsystem_kernel.dylib          0x3ba84e30 mach_msg_trap + 20
1   libsystem_kernel.dylib          0x3ba84fd0 mach_msg + 48
2   CoreFoundation                  0x3bd002b6 __CFRunLoopServiceMachPort + 126
3   CoreFoundation                  0x3bcff02c __CFRunLoopRun + 900
4   CoreFoundation                  0x3bc72238 CFRunLoopRunSpecific + 352
5   CoreFoundation                  0x3bc720c4 CFRunLoopRunInMode + 100
6   WebCore                         0x36b12a58 _ZL12RunWebThreadPv + 440
7   libsystem_c.dylib               0x350100de _pthread_start + 306
8   libsystem_c.dylib               0x3500ffa4 thread_start + 4

Thread 5 name:  com.apple.NSURLConnectionLoader
Thread 5:
0   libsystem_kernel.dylib          0x3ba84e30 mach_msg_trap + 20
1   libsystem_kernel.dylib          0x3ba84fd0 mach_msg + 48
2   CoreFoundation                  0x3bd002b6 __CFRunLoopServiceMachPort + 126
3   CoreFoundation                  0x3bcff02c __CFRunLoopRun + 900
4   CoreFoundation                  0x3bc72238 CFRunLoopRunSpecific + 352
5   CoreFoundation                  0x3bc720c4 CFRunLoopRunInMode + 100
6   Foundation                      0x34672098 +[NSURLConnection(Loader) _resourceLoadLoop:] + 304
7   Foundation                      0x346f5a3c __NSThread__main__ + 968
8   libsystem_c.dylib               0x350100de _pthread_start + 306
9   libsystem_c.dylib               0x3500ffa4 thread_start + 4

Thread 6:
0   libsystem_kernel.dylib          0x3ba95d98 __workq_kernreturn + 8
1   libsystem_c.dylib               0x35005ad6 _pthread_workq_return + 14
2   libsystem_c.dylib               0x350057f2 _pthread_wqthread + 362
3   libsystem_c.dylib               0x35005680 start_wqthread + 4

Thread 7:
0   libsystem_kernel.dylib          0x3ba95d98 __workq_kernreturn + 8
1   libsystem_c.dylib               0x35005ad6 _pthread_workq_return + 14
2   libsystem_c.dylib               0x350057f2 _pthread_wqthread + 362
3   libsystem_c.dylib               0x35005680 start_wqthread + 4

Thread 8 name:  com.apple.CFSocket.private
Thread 8:
0   libsystem_kernel.dylib          0x3ba95594 __select + 20
1   CoreFoundation                  0x3bd04474 __CFSocketManager + 676
2   libsystem_c.dylib               0x350100de _pthread_start + 306
3   libsystem_c.dylib               0x3500ffa4 thread_start + 4

Thread 9 Crashed:
0   libsystem_kernel.dylib          0x3ba95350 __pthread_kill + 8
1   libsystem_c.dylib               0x3502dfb2 pthread_kill + 54
2   libsystem_c.dylib               0x3506a366 abort + 90
3   libc++abi.dylib                 0x35125dda abort_message + 70
4   libc++abi.dylib                 0x35123094 _ZL17default_terminatev + 20
5   libobjc.A.dylib                 0x3ad84a58 _ZL15_objc_terminatev + 144
6   libc++abi.dylib                 0x35123118 _ZL19safe_handler_callerPFvvE + 76
7   libc++abi.dylib                 0x351231b0 std::terminate() + 16
8   libc++abi.dylib                 0x3512459a __cxa_throw + 118
9   libobjc.A.dylib                 0x3ad8499e objc_exception_throw + 90
10  CoreFoundation                  0x3bd2b302 +[NSException raise:format:] + 102
11  Foundation                      0x346b518e _NSFileHandleRaiseOperationException + 150
12  Foundation                      0x346938ee -[NSConcreteFileHandle writeData:] + 126
13  friendsCam                      0x000fbeb4 -[NSFileHandle(GTMFileHandleLogWriter) logMessage:level:] (GTMLogger.m:315)
14  friendsCam                      0x000fbd9e -[GTMLogger(PrivateMethods) logInternalFunc:format:valist:level:] (GTMLogger.m:292)
15  friendsCam                      0x000fbb00 -[GTMLogger logDebug:] (GTMLogger.m:199)
16  friendsCam                      0x000f190e -[AmazonS3Client invoke:] (AmazonS3Client.m:368)
17  friendsCam                      0x000f1024 -[AmazonS3Client getObject:] (AmazonS3Client.m:137)
18  friendsCam                      0x000b49b8 -[Home loadingImage] (Home.m:142)
19  Foundation                      0x346f5a3c __NSThread__main__ + 968
20  libsystem_c.dylib               0x350100de _pthread_start + 306
21  libsystem_c.dylib               0x3500ffa4 thread_start + 4

Thread 9 crashed with ARM Thread State (32-bit):
    r0: 0x00000000    r1: 0x00000000      r2: 0x00000000      r3: 0x3cd22524
    r4: 0x00000006    r5: 0x05ce9000      r6: 0x1f0bc854      r7: 0x05ce8344
    r8: 0x1f0bc830    r9: 0x00000300     r10: 0x1f09d770     r11: 0x00000004
    ip: 0x00000148    sp: 0x05ce8338      lr: 0x3502dfb7      pc: 0x3ba95350
  cpsr: 0x00000010 
```

谁能帮我修一下

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-03T14:23:47.477

在您拥有的控制台报告中

```
Exception Type:  EXC_CRASH (SIGABRT) 
```

这意味着您正在使用一些被释放的东西。

这里有一些教程如何在发生任何崩溃时调试代码，作者 raywenderlich。

[我的应用程序崩溃了——现在怎么办？1/2](http://www.raywenderlich.com/10209/my-app-crashed-now-what-part-1)

[我的应用程序崩溃了——现在怎么办？2/2](http://www.raywenderlich.com/10505/my-app-crashed-now-what-part-2)

# ember.js - 如何访问 Ember.View 中的上下文？

> ID：13209023
> 
> 赞同：3
> 
> 时间：2012-11-03T12:07:24.867
> 
> 标签：ember.js

我正在尝试从视图对象上设置的基础对象中获取记录 ID，因此我可以在视图的 HTML 包装器上设置它。这是我正在尝试的：

```
// Row in record editing table view.
views.RecordActionTableRowView = Ember.View.extend({
  // Does not work.
  attributeBindings: ['record_id:data-record-id'],
  templateName: 'pult-record-action-table-row',

  init: function () {
    console.log(this);
    // Does not work either. Undefined.
    console.log(this.get('record_id'));
    // Does not work either. Undefined.
    console.log(this.record);
    return this._super();
  }
}); 
```

这个视图是从模板调用的，所以它自己的模板包含正确的数据，但我在视图代码中找不到它。有什么建议么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T17:15:46.037

你可能想要`this.get('context')`或`this.get('content')`。在某些情况下，如果视图是在设置之前创建的，那么检查 this`didInsertElement`可能比 in 更好。`init``context`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-12-04T05:02:24.463

在我的情况下，我在尝试访问文档中描述为 templateVariables 的内容时遇到了同样的问题，以下工作

```
this.get("templateData.keywords.myvarname") 
```

# android - Android ActionBar 不可编辑

> ID：13209024
> 
> 赞同：0
> 
> 时间：2012-11-03T12:07:25.770
> 
> 标签：android, android-actionbar

我正在设计一个 Android 应用程序，但我的应用程序的操作栏有问题。我已经阅读了很多教程，我在 youtube 上观看了很多关于此的视频，但仍然无法找出问题所在。我想编辑我的操作栏，以便再添加 2 个按钮。有人能帮我吗？我使用了 actionbarsherlock，但我想在我的智能手机（Android 2.2 Froyo）上运行该应用程序并且无法正常工作......

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-11-28T00:30:54.253

您是否尝试过以下解决方案？ [http://developer.android.com/guide/topics/ui/actionbar.html](http://developer.android.com/guide/topics/ui/actionbar.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T13:13:14.073

您应该在代码或 xml 中将这两个 MenuItems 添加到您的选项菜单中，并确保它们的 android:showInActionBar="always" (或 "ifRoom") 然后它们出现在您的操作栏中

# android - Android 可绘制文件夹说明

> ID：13209027
> 
> 赞同：2
> 
> 时间：2012-11-03T12:07:51.380
> 
> 标签：android

我为 7 英寸和 10 英寸平板电脑准备了图像，现在我想将它们放入相应的可绘制文件夹中。我搜索了一些资源并获得了一些信息，即 7 英寸和 10 英寸平板电脑的密度都是**mdpi**。我不能将两个不同分辨率的图像放在同一个 mdpi 文件夹中。有人可以建议我一些关于如何解决问题的想法。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-03T12:13:37.353

选项 #1：`res/drawable-xlarge-mdpi/`用于 10 英寸`-mdpi`平板电脑图像和`res/drawable-large-mdpi/`5 到 10 英寸`-mdpi`平板电脑图像。

选项#2：不要根据屏幕大小使用不同的图标。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-03T12:17:52.610

7寸平板属于大屏，10寸平板属于超大屏。因此，请为这两个文件夹使用以下文件夹：

1`drawable-large`

2`drawable-xlarge`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-03T12:21:12.300

请参阅以下链接以获取您的解决方案。尝试使用

> 可绘制大
> 
> 可绘制的-xlarge

支持所有分辨率的不同类别。[参考这个](http://developer.android.com/training/basics/supporting-devices/screens.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-03T12:26:01.460

android 3.2 不推荐使用 large 和 xlarge 将 drawable-sw600dp-mdpi 用于 7" 选项卡，将 drawable-sw720dp-mdpi 用于 10" 选项卡。

# windows-mobile - 提高文本输出速度楔形扫描仪

> ID：13209029
> 
> 赞同：0
> 
> 时间：2012-11-03T12:08:10.133
> 
> 标签：windows-mobile, qr-code, barcode-scanner, symbols, pocketpc

我有一台 Symbol MC-50 掌上电脑，我正在尝试扫描包含大量数据的 QR 码。准确地说：256 个字符。

文本已经被压缩到最大，所以我不能减少数据量。当我扫描二维码时，扫描仪最多需要 3 秒才能在输入字段中输出文本。

我正在使用标准的楔形应用程序。如何提高文本输出速度？

期待您的回答！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T07:23:32.310

很抱歉，但我不知道 Motorola/Symbol 是否支持 DataWedge 的任何性能设置。我知道 Intermec 通过 VWconfig.ini 为 VirtualWedge 提供性能设置。

[我下载了http://support.symbol.com/support/search.do?cmd=displayKC&docType=kc&externalId=KB100417&sliceId=&dialogID=446344460&stateId=1%200%20446328342](http://support.symbol.com/support/search.do?cmd=displayKC&docType=kc&externalId=KB100417&sliceId=&dialogID=446344460&stateId=1%200%20446328342)的 DataWedge 包，遗憾的是文档中没有提到启用性能调整。

好的，输入缓慢的原因是应用程序无法在消息之间没有任何延迟的情况下使用 WM_KEY 消息填充消息队列。如果楔子必须“模拟”按键，它必须为每个键发送三个或更多消息。一键向下，一键字符和一键向上消息。如果消息之间有 2 毫秒的延迟，则 256 个低字母字符的输出将需要 256*3*2ms = 1536ms = 1.5 秒。如果字符串中有大字符或符号要楔入，最坏的情况是为 256*5*2ms=2.5 秒。上部字符或某些符号需要在每个字符之前/之后额外按下/释放 shift 键。

如果您联系摩托罗拉支持，请询问他们是否支持任何字符间延迟设置。我发现使用 Intermec VirtualWedge 可以在不使用字符的情况下降低 1 毫秒的延迟。

但是，如果您是编码员，最好的办法是重写您的应用程序以使用摩托罗拉 SDK 直接访问扫描仪。

问候

约瑟夫

# c++ - 如何在c++中计算两个数字的差？

> ID：13209032
> 
> 赞同：7
> 
> 时间：2012-11-03T12:08:26.250
> 
> 标签：c++

如果我只启用双精度和整数，那么它是 4 个函数。但我想启用所有数据类型（int long float double unsigned numbers 等）这怎么可能？

```
#include <iostream>

using namespace std;

double diff(int num1, int num2) {
    return double(num1-num2);
}

double diff(int num1, double num2) {
    return double(num1)-num2;
}

double diff(double num1, int num2) {
    return num1-double(num2);
}

double diff(double num1, double num2) {
    return num1-num2;
}

int main() {
    int a = 10;
    double b = 4.4;
    cout << diff(a, b) << endl;
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-03T12:10:38.240

```
template <typename T, typename U>
double diff(T a, U b) {
    return a - b;
} 
```

您不需要强制转换`double`- 如果任何一个参数都是 a `double`，并且在`return`两者都是整数时，这是为您完成的。然而，

```
double diff(double a, double b); 
```

也可以用`int`参数调用。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-11-03T12:10:49.167

使用模板函数：

```
template <typename T1, typename T2>
double diff(const T1& lhs, const T2& rhs)
{
  return lhs - rhs;
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-11-03T12:10:21.237

您不必“启用”操作，只需编写：

```
cout << (a - b) << endl; 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-11-03T12:17:31.333

与以前的所有答案不同，我将添加关于 C++11 的内容。在 C++11 中，您可以使用`decltype`.

```
#include <iostream>

template <typename T1, typename T2>
auto diff(T1 a, T2 b) -> decltype(a)
{
   return (a - b);
}

int main() {
   std::cout << diff(3.5, 1) << std::endl;
   std::cout << diff(3, 1.5) << std::endl;
} 
```

`diff`函数将始终返回类型的值，如第一个参数。请注意，在第一种情况下它是浮点数，但在第二种情况下它是整数。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-03T12:25:31.137

例如，您始终可以使用绝对值来计算差异

```
cout << abs(a - b) << endl; 
```

不过，您可能想使用以前的答案所说的模板。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-11-03T12:12:14.480

您可以为相同的定义一个模板

```
template <typename T, typename U>
T diff(const T& a, const U& b) {
    return a - b;
} 
```

这段代码做了很多假设，比如 operator - 是为 T 定义的，返回类型总是 T 类型等等......

# c# - 如何从C#中的数组元素中获取值

> ID：13209034
> 
> 赞同：-4
> 
> 时间：2012-11-03T12:09:04.800
> 
> 标签：c#, arrays

我有一个大小为 6 的数组，其中包含第零位的值作为字符串：

```
{"1111110"} 
```

现在我想`array[0]`从 0 到 1 读取 from last 的内容。

我如何阅读元素？C# 中是否有任何内置函数？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-03T12:12:12.280

```
var string0 = array[0];
foreach (char c in string0.Reverse()) {
  // do something with c
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-03T12:12:29.453

您可以使用 Array.Reverse 接受 char 数组

```
string reverString =new string(Array.Reverse( array[0].ToCharArray())); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-03T12:16:45.023

```
string value = array[0]; 
```

现在您可以使用：**[String.ToCharArray 方法 (Int32, Int32)](http://msdn.microsoft.com/en-us/library/2c7h58e5.aspx)**

例如。：

```
char[] arr;
arr = value.ToCharArray(0, 6); 
```

# ios - 将数据传递给 ViewController，这是 UIPopoverController 的内容

> ID：13209035
> 
> 赞同：0
> 
> 时间：2012-11-03T12:09:09.167
> 
> 标签：ios, ipad, uipopovercontroller

假设项目正在使用 ARC。ContentViewController 是 UIPopoverController 的内容

```
- (IBAction)showPop:(UIButton *)button 
{
    _pressDate = [NSDate date];
    ContentViewController *cvc = [[InfoViewController alloc] initWithNibName:@"ContentViewController" bundle:nil];
    self.popController = [[UIPopoverController alloc] initWithContentViewController:cvc];
    cvc.dateLabel.text = [_pressDate description];
    [self.popController presentPopoverFromRect:button.frame inView:self.view permittedArrowDirections:UIPopoverArrowDirectionDown animated:YES];
} 
```

上面的代码有效，没问题。但我注意到，如果我打电话

```
cvc.dateLabel.text = [_pressDate description]; 
```

前

```
self.popController = [[UIPopoverController alloc] initWithContentViewController:cvc]; 
```

标签没有得到更新。我只是想了解这是怎么回事？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T14:02:09.570

有一个拇指规则，你不应该在 viewDidLoad 运行之前编辑 ViewController 的 UI，因为`@Phillip Morris`描述的原因.. 而不是`cvc.dateLabel.text`直接在 viewDidLoad 被触发之前设置，声明一个属性`textForDateLabel`，然后设置`cvc.textForDateLabel = [_pressDate description];`。然后在`viewDidLoad`您的 ContentViewController 中，执行`self.dateLabel.text = textForDateLabel;`

# asp.net - 即使表有值，Petapoco 可为空的日期也返回 null

> ID：13209065
> 
> 赞同：0
> 
> 时间：2012-11-03T12:13:17.467
> 
> 标签：asp.net, petapoco

我使用 petaPoco 作为我的 ORM。

你能告诉我为什么`null`即使它在表中包含一个有效日期，它也会返回一个可以为空的日期字段。我是 ORM 和 C# 的新手

```
employee emp = db.SingleOrDefault<employee>(
       "SELECT * FROM tbl_employee WHERE id=@0", Id
       ); 
```

谢谢

编辑 ：

我的表架构

```
 CREATE TABLE `tbl_employee` (
`Id` INT(11) NOT NULL AUTO_INCREMENT,
`Name` VARCHAR(60) NOT NULL,
`Sex` VARCHAR(6) NOT NULL DEFAULT '0',
`dob` DATE NOT NULL COMMENT 'Date of Birth',
`DOJ` DATE NULL DEFAULT NULL COMMENT 'Date of join',
`Bank_ac_no` VARCHAR(20) NULL DEFAULT NULL,
`PAN_CARD_NO` VARCHAR(20) NOT NULL DEFAULT '',
`Home_Branch_ID` INT(11) NULL DEFAULT NULL,
`designation_id` INT(11) NULL DEFAULT NULL,
`Probationary_period` INT(11) NOT NULL DEFAULT '0' COMMENT 'Probationary Period in days',
`Appointment_refno` VARCHAR(15) NULL DEFAULT NULL,
`PF_Branch_ID` INT(11) NULL DEFAULT NULL COMMENT 'Branch _ID of the PF to be submitted',
`resigned` TINYINT(4) NOT NULL DEFAULT '0',
`mgrallowance` DOUBLE(15,2) NULL DEFAULT '0.00',
`comm_coef` DOUBLE(15,2) NOT NULL DEFAULT '1.00',
`emp_com_type` INT(11) NOT NULL DEFAULT '0'  ,
`Office_staff` INT(11) NULL DEFAULT '0',
`UID` VARCHAR(15) NULL DEFAULT '',
`desig_id` INT(11) NULL DEFAULT NULL,
`Working_branch_id` INT(11) NULL DEFAULT NULL,
`Rating` DOUBLE(10,2) NULL DEFAULT NULL,
`internal_ref_id` INT(11) NULL DEFAULT NULL ,
`approval_status` INT(11) NULL DEFAULT NULL,
`approved_id` INT(11) NULL DEFAULT NULL,
PRIMARY KEY (`Id`),
INDEX `desig_id` (`desig_id`)
 )
COLLATE='latin1_swedish_ci'
ENGINE=InnoDB
AUTO_INCREMENT=5054; 
```

我正在使用 MYSQL 5.5 和 Mysql.Data 6.5.4 poco： https: [//www.yousendit.com/download/WUJaTXRkOW5oeVpvSWNUQw](https://www.yousendit.com/download/WUJaTXRkOW5oeVpvSWNUQw)

# php - cakephp 从多个相关表中读取和显示

> ID：13209069
> 
> 赞同：0
> 
> 时间：2012-11-03T12:13:59.503
> 
> 标签：php, cakephp, cakephp-2.1, cakephp-model

我有 2 张表用户和艺术家。

```
User:
id
name
password
city_id
state_id
country_id

Artist:
id
user_id
description 
```

我希望创建添加和编辑表单（单个表单充当添加和编辑）。但是在单击编辑链接时，我希望填写用户和艺术家表的表单字段。我怎么做？下面是我的控制器代码：

```
public function artist_register() {
        $this->country_list();
        if ($this->request->is('post')) {
            $this->request->data['User']['group_id'] = 2;
            if ($this->{$this->modelClass}->saveAll($this->request->data)) {
                $this->redirect(array('controller' => 'Users', 'action' => 'login'));
            }
        }
        $this->render('artist_update');
    }

    public function artist_update($id) {
        $artist = $this->{$this->modelClass}->findByuser_id($id);
        $artist_id = $artist[$this->modelClass]['id'];

        if($this->request->is('get')) {
            $this->request->data = $this->{$this->modelClass}->read(null, $artist_id);
            $this->request->data = $this->{$this->modelClass}->User->read(null, $id);
        } else {
            if($this->{$this->modelClass}->save($this->request->data)) {
                $this->Session->setFlash('Your Profile has been updated');
                $this->redirect(array('action' => 'index'));
            }
        }
    } 
```

代码不起作用。我该如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T16:57:10.573

## 首先要做的事：

`User`您必须定义和之间的关系`Artist`。

`A user has one artist`
`A user has many artist`
`A artist belongs to an user`

在这种情况下，我认为您正在寻找的关系是：

`A artist belongsTo user`

## 编码时间：

知道了这一点，您现在可以定义关系。在您的`Artist`模型中，您需要声明`belongsTo`变量：

```
class Artist extends AppModel {
    public $belongsTo = 'User';
} 
```

或者您可以像这样设置关系：

```
class Artist extends AppModel {
    public $belongsTo = array(
        'User' => array(
            'className'    => 'User',
            'foreignKey'   => 'user_id'
        )
    );
} 
```

## 供您参考：

关联中还有另一个可能的键`belongsTo`：

*   **className**：与当前模型关联的模型的类名。如果您要定义“艺术家属于用户”关系，则 className 键应等于“用户”。</p>

*   **foreignKey**：在当前模型中找到的外键的名称。如果您需要定义多个 belongsTo 关系，这将特别方便。此键的默认值是另一个模型的带下划线的单数名称，后缀为 _id。

*   **conditions** : find() 兼容条件或 SQL 字符串的数组，例如 array('User.active' => true)

*   **type**：在 SQL 查询中使用的连接类型，默认为 LEFT，这可能无法满足您在所有情况下的需求，当您想要主模型和关联模型中的所有内容或什么都不想要时，INNER 可能会有所帮助！（当然在某些条件下使用时有效）。（注意：类型值是小写的 - 即左，内）

*   **fields**：获取关联模型数据时要检索的字段列表。默认返回所有字段。

*   **order** : find() 兼容的 order 子句或 SQL 字符串的数组，例如 array('User.username' => 'ASC')

## 会发生什么？

这是`$this->Artist->find()`定义我们的关系后调用的结果。

```
Array
(
    [Artist] => Array
    (
        [id] => 5
        [user_id] => 1
        [description] => I am an artist!
    )
    [User] => Array
    (
        [id] => 1
        [name] => Fuhrmann
        [passsword] => 1234
        [city_id] => 500
        [state_id] => 2020
        [country_id] => 223
    )

) 
```

## 所以呢？

毕竟，您可以`User`在查找时访问`Artist`：

```
public function artist_update($id) {
    // Read the artist and the user info
    $artist = $this->{$this->modelClass}->findByUserId($id);        
    $this->set(compact('artist'));
} 
```

在您看来，您可以获取用户名或`Users`表中的其他字段：

```
<input type="text" name="name" value="<?php echo $artist['User']['name'];?>"
<input type="text" name="user_id" value="<?php echo $artist['User']['id'];?>"
<input type="text" name="country_id" value="<?php echo $artist['User']['country_id'];?>" 
```

## 阅读更多

阅读有关[关联的更多信息：将模型链接在一起](http://book.cakephp.org/2.0/en/models/associations-linking-models-together.html)

# jsp - 是否可以制作强制性 JSP（在包含中）？

> ID：13209070
> 
> 赞同：0
> 
> 时间：2012-11-03T12:14:00.227
> 
> 标签：jsp, include

我正在制作一个需要设置参数才能有意义的 jsp(f)。

因此，如果没有提供它，我希望它出错，这样开发人员就不会犯错。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T12:36:16.417

我会将 JSP 片段转换为 JSP 标记文件，并带有一个必需的参数：

`/WEB-INF/tags/hello.tag`：

```
<%@ attribute name="name" required="true" %>
<h2>Hello, ${name}!</h2> 
```

这样，您的 JSP 编辑器将警告您缺少必需的参数，并且使用没有必需参数的标记的 JSP 将无法编译。

这样的标签将像这样使用：

```
<%@ taglib tagdir="/WEB-INF/tags" prefix="myTags" %>
<myTags:hello name="Stephen"/> 
```

有关详细信息，请参阅[http://docs.oracle.com/javaee/1.4/tutorial/doc/JSPTags5.html](http://docs.oracle.com/javaee/1.4/tutorial/doc/JSPTags5.html)。

# html - 使用 Flex Box 模型的两列输入

> ID：13209072
> 
> 赞同：1
> 
> 时间：2012-11-03T12:14:14.587
> 
> 标签：html, css

我正在尝试使用弹性盒模型创建输入机制。我知道并非所有浏览器都支持它，但在这种情况下并不重要。它真的只需要在 web-kit 浏览器上工作。

我正在尝试构建一个不错的两列布局，而不需要使用特定的宽度。我在标签和输入上都将 flex 属性设置为一个。但是，正如您所看到的，当标签元素变长时，它会弄乱它旁边的输入的宽度。

我希望标签和输入在列下的宽度相同，但我希望它们随着窗口/设备大小的变化而增长和缩小。

有没有办法做到这一点而不必`width`在任何一个元素上设置 a ？

**更新**

我可以将`max-width`标签元素上的 a 设置为 5%，我基本上得到了想要的效果。但是，我仍然想知道是否有一种方法可以在不设置任何宽度并仅使用弹性框的情况下做到这一点？

[这](http://jsfiddle.net/zero21xxx/XTa98/)是一个工作的jsFiddle。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T16:43:17.647

您提供的示例根本没有列，只是有列的外观。如果没有实际的列，您将不得不设置宽度以使这 3 个不相关的块看起来它们以某种方式连接。

您应该使用新的 CSS3 Flexible Box 语法，现在是 'flex' 而不是 'box'。请参阅规范：[http](http://www.w3.org/TR/css3-flexbox/) ://www.w3.org/TR/css3-flexbox/有了这个，您可以将元素设置`<grow>` `<shrink>` `<default width>`为 1 1 50%，因此它们将以相同的速度增长和收缩，并且每个都需要最多可用宽度的 50%（您可以调整它或使其为 60/40 或其他）。

示例 JSFiddle：http: [//jsfiddle.net/XTa98/4/](http://jsfiddle.net/XTa98/4/)

否则，如果您想要实际的列以便不必设置宽度，则需要将所有标签包装在它们自己的“列”div 中，并将所有输入包装在它们自己的“列”div 中。

JSFiddle：http: [//jsfiddle.net/XTa98/5/](http://jsfiddle.net/XTa98/5/)

这有实际的列并且没有设置宽度，但它不再优雅地降级，因为元素不在它们自己的行中。为了缓解这种情况，您可以随时提供`text-overflow: ellipses`截断文本。

在任何情况下，你都有一个权衡。如果您想要列的外观而不实际使用列，则需要设置某种类型的宽度。否则，您可以使用真正的列，但元素不再作为行连接，并且您需要在缩小浏览器宽度时考虑溢出。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-09T02:43:08.147

您不必将元素包装在列 div 中以避免设置宽度。只需将每个标签和输入设置为 flex:1，您就会让它们平均划分宽度。但是，在这种情况下，这实际上与将每个宽度设置为 50% 相同，所以我不确定它到底有什么优势。

# android - 无法将摄像头设置到前面进行录制

> ID：13209075
> 
> 赞同：0
> 
> 时间：2012-11-03T12:14:26.350
> 
> 标签：android, android-camera, android-capture

这是我的代码：

```
package eye.sight.test;

import java.io.IOException;

import android.app.Activity;
import android.hardware.Camera;
import android.media.CamcorderProfile;
import android.media.MediaRecorder;
import android.os.Bundle;
import android.view.SurfaceHolder;
import android.view.SurfaceView;
import android.view.View;
import android.widget.Button;

public class AndroidVideoCapture extends Activity implements SurfaceHolder.Callback{

    Button myButton;
    MediaRecorder mediaRecorder;
    SurfaceHolder surfaceHolder;
    boolean recording;
    Camera c;

    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        recording = false;
        setContentView(R.layout.main1);
        initMediaRecorder();

        SurfaceView myVideoView = (SurfaceView)findViewById(R.id.videoview);
        surfaceHolder = myVideoView.getHolder();
        surfaceHolder.addCallback(this);
        surfaceHolder.setType(SurfaceHolder.SURFACE_TYPE_PUSH_BUFFERS);

        myButton = (Button)findViewById(R.id.mybutton);
        myButton.setOnClickListener(myButtonOnClickListener);
    }

    private Button.OnClickListener myButtonOnClickListener
    = new Button.OnClickListener(){

        @Override
        public void onClick(View arg0) {
            // TODO Auto-generated method stub
            if(recording){
                mediaRecorder.stop();
                mediaRecorder.release();
                finish();
            }else{
                mediaRecorder.start();
                recording = true;
                myButton.setText("STOP");
            }
        }};

        @Override
        public void surfaceChanged(SurfaceHolder arg0, int arg1, int arg2, int arg3) {
            // TODO Auto-generated method stub

        }
        @Override
        public void surfaceCreated(SurfaceHolder arg0) {
            // TODO Auto-generated method stub
            prepareMediaRecorder();
        }
        @Override
        public void surfaceDestroyed(SurfaceHolder arg0) {
            // TODO Auto-generated method stub

        }

        private void initMediaRecorder(){

            mediaRecorder = new MediaRecorder();
        //  c.unlock();
        //  c = Camera.open(Camera.CameraInfo.CAMERA_FACING_FRONT);

    //      mediaRecorder.setCamera(c);

            mediaRecorder.setAudioSource(MediaRecorder.AudioSource.DEFAULT);
            mediaRecorder.setVideoSource(MediaRecorder.VideoSource.CAMERA);
            CamcorderProfile camcorderProfile_HQ = CamcorderProfile.get(CamcorderProfile.QUALITY_HIGH);
            mediaRecorder.setProfile(camcorderProfile_HQ);
            mediaRecorder.setOutputFile("/sdcard/myvideo.mp4");
            mediaRecorder.setMaxDuration(60000);
            //mediaRecorder.setMaxFileSize(5000000);
        }

        private void prepareMediaRecorder(){
            mediaRecorder.setPreviewDisplay(surfaceHolder.getSurface());
            try {
                mediaRecorder.prepare();
            } catch (IllegalStateException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            } catch (IOException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
        }
} 
```

我一直在谷歌上搜索如何使用前置摄像头，但没有任何运气。我在这里想念什么？默认情况下它工作得很好，但我不确定何时以及如何使用 Camera.open(Camera.CameraInfo.CAMERA_FACING_FRONT); 和 Came.unlock();。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T13:07:24.163

尝试这样做

```
private Camera FrontCamera() 
{
int cameraCount = 0;
Camera cam = null;
Camera.CameraInfo cameraInfo = new Camera.CameraInfo();
cameraCount = Camera.getNumberOfCameras();
for ( int camIdx = 0; camIdx < cameraCount; camIdx++ ) {
    Camera.getCameraInfo( camIdx, cameraInfo );
    if ( cameraInfo.facing == Camera.CameraInfo.CAMERA_FACING_FRONT  ) {
        try {
            cam = Camera.open( camIdx );
        } catch (RuntimeException e) {
            Log.e(TAG, "Camera failed to open: " + e.getLocalizedMessage());
        }
    }
}

return cam;
} 
```

还要在清单文件中添加以下内容

```
<uses-permission android:name="android.permission.CAMERA" />
<uses-feature android:name="android.hardware.camera" android:required="false" />
<uses-feature android:name="android.hardware.camera.front" android:required="false" /> 
```

# javascript - 无法删除子节点而不使子节点（消息）根本不显示

> ID：13209076
> 
> 赞同：1
> 
> 时间：2012-11-03T12:14:33.540
> 
> 标签：javascript

我已经尝试了很多不同的方法来移除孩子，但到目前为止没有任何效果，嗯，它在某种程度上，要么我没有消息，要么我不断收到消息，只是添加到跨度而不删除另一个

尝试阅读如何删除孩子，并尝试了我发现的所有不同方式来删除它，我的代码在创建孩子和附加它等方面可能是错误的，因为这是我第一次使用这种方式。一直在尝试使用 while 循环来删除，以及在代码中已经被注释掉的循环，以及 firstChild。并使用不同的名称而不是味精。

我的代码在我的脚本中如下所示：

```
function validateName(input, id)
{
    var res = true;
    var msg = document.getElementById(id);
    var error = document.createElement("span");
    var errorMsg = "";

    if (input == "" || input < 2) {
        res = false;
    //        removeChildren(msg);
            errorMsg = document.createTextNode("Input is to short!");
            error.appendChild(errorMsg);
            id.appendChild(error);
    }
    if (input >= 2 && input.match(/\d/)) {
        res = false;
    //        removeChildren(msg);
            errorMsg = document.createTextNode("Name contains a number!");
            error.appendChild(errorMsg);
            id.appendChild(error);
    }
    if (input >= 2 && !input.match(/\d/)) {
        res = true;
    //      removeChildren(msg);
    }
    return res;
} 
```

我的小测试页：

```
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <title>JSP Page</title>
        <script src="Validator.js"></script>
        <script>
            function v1(e,id) {           
                if(validateName(document.form1.namefield.value, id) == false) {
                    document.getElementById("be").src="NotOkSmall.jpg";
                }
                if(validateName(document.form1.namefield.value) == true) {
                   document.getElementById("be").src="OkSmall.jpg";    
                }
            }
        </script>
    </head>
    <body>
        <h1>Validation testing, HO!</h1>
        <form name="form1" action="submit">   
            <div id="div1">
                <input type="text" name ="namefield" id="f1" onkeydown="v1(be, div1)" >
                <image id="be" src="NotOkSmall.jpg" alt="OkSmall.jpg" />
            </div>
            <input type="button" value="GO" onClick="v1(be)">
        </form>
    </body> 
</html> 
```

如果有人有任何想法让它为我工作，那将是一个非常快乐的人:)，正如我之前所说，我什至不确定在这种情况下创建 child 是正确的方法。但是当我删除removeChildren时它可以工作，它确实写了正确的消息，只是不要删除它们中的任何一个。所以必须有一些工作..

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T13:48:51.197

您的代码中有一些错误，例如`id.appendChild(error);`您必须在哪里使用`msg.appendChild(error);`. 无论如何，在这种情况下，我认为不需要附加/删除子节点。只需使用隐藏的错误占位符并在您想要显示错误消息时显示它。

**HTML：**

```
<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <title>JSP Page</title>
        <script src="Validator.js"></script>
        <script>
            function v1(imgId) {
                var img = document.getElementById(imgId),
                    val = document.form1.namefield.value;
                img.src = img.alt = validateName(val) 
                    ? "OkSmall.jpg" 
                    : "NotOkSmall.jpg";
            }
        </script>
    </head>
    <body>
        <h1>Validation testing, HO!</h1>
        <form name="form1" action="submit">   
            <div id="div1">
                <input type="text" name ="namefield" id="f1" onkeyup="v1('be');" >
                <image id="be" src="NotOkSmall.jpg" alt="NotOkSmall.jpg" />
                <span id="error-message" class="invis"></span>
            </div>
            <input type="button" value="GO" onClick="v1('be');">
        </form>
    </body> 
</html>​​​​​​​​​ 
```

**CSS：**

```
​.invis {
    display: none;
}​ 
```

**JavaScript：**

```
function validateName(input) {
    var res = true,
        errorMsg,
        errorContainer = document.getElementById('error-message');

    if(input.length < 2) {
        res = false;
        errorMsg = "Input is to short!";
    }

    if(input.length >= 2 && /\d/.test(input)) {
        res = false;
        errorMsg = "Name contains a number!";
    }

    if(res) {
        errorContainer.style.display = 'none';
    } else {
        errorContainer.innerHTML = errorMsg;
        errorContainer.style.display = 'inline';
    }

    return res;
}​ 
```

**[演示](http://jsfiddle.net/f0t0n/TuUzW/)**

# git - 我可以进行真正的 git 合并，而不必将提交消息从分支推送到 master 吗？

> ID：13209077
> 
> 赞同：1
> 
> 时间：2012-11-03T12:14:34.900
> 
> 标签：git, merge, branch, message, squash

我正在将来自稳定分支的更改合并回开发分支。我希望它是一个“真正的”合并，我的意思是当我这样做时它应该显示一个合并`git --graph --oneline`。

问题是，我不想提交来自分支的所有消息，而只是提交我的合并提交消息。（我们开发人员的提交消息必须符合特定模式，由远程挂钩强制执行，但分支上的一些提交来自“发布”用户，不必符合也不需要。）

有没有一种方法可以在不从分支推送提交消息的情况下执行“真正的”合并？

这是我目前的合并方式（来自大师）：

```
git merge -s recursive -X ours --no-commit 1.0_BRANCH 
```

这是我提交后的（经过清理的）图表的样子，这正是我想要的：

```
*   b3492a7 - (HEAD, master) DEV-3: Merging patch fix onto master <graham>
|\  
| * eec2ef6 - (origin/1.0_BRANCH, 1.0_BRANCH) [maven-release-plugin] prepare for next development iteration <release>
| * c14dee4 - (application-1.1) [maven-release-plugin] prepare release application-1.1 <release>
| * 40687a4 - DEV-3: Fix to go into the patch <graham>
| * 4e71c98 - [maven-release-plugin] prepare for next development iteration <release>
| * c8828bb - (application-1.0) [maven-release-plugin] prepare release application-1.0 <release>
| * 46a9a59 - [maven-release-plugin]  copy for branch 1.0_BRANCH <release>
* | 5ca3ec6 - (origin/master, origin/HEAD) DEV-2: First feature commit of next release <graham>
* | bd797d3 - [maven-release-plugin] prepare for next development iteration <release>
|/  
* afff00f - [maven-release-plugin] prepare branch 1.0_BRANCH <release>
* b9329fb - DEV-1: Last feature commit before release <graham> 
```

我的问题是当我尝试推送时，我们的远程钩子拒绝推送，因为提交消息`eec2ef6`不符合并且我不是发布用户。我可以仅使用来自 的消息推送我的合并`b3492a7`，还是必须压缩合并（我相信这意味着图表不会将其显示为合并）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T12:19:19.927

如果远程不知道提交的所有父项，您就无法推送合并。

您要么必须压缩，正如您猜测的那样，这将破坏该分支的历史并合并，或者理想情况下，您可以更改远程 git 挂钩，使其对拒绝的内容更加智能。也许它可以忽略来自“发布”用户的所有提交。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-05T07:51:41.273

您当前的模型似乎意味着只有用户 ' `release`' 可以合并回一个功能分支`dev`；这是不切实际的，因为只有开发人员才能正确管理这样的合并。

如果您可以改进钩子，您可以使用类似于“让[远程 git 存储库拒绝在推送时合并提交](https://stackoverflow.com/a/2081349/6309)”中提出的算法：
通过使用`git rev-list --parents <OLD>..<NEW>`，您可以确定其中一个父级是否包含`<release>`在其中，并选择允许那。

# java - 使用 void 方法添加按钮

> ID：13209082
> 
> 赞同：2
> 
> 时间：2012-11-03T12:15:11.937
> 
> 标签：java, swing, static, add

我对编程电路很陌生，我正在尝试系统地学习 Java，目前最终在 Swing 结束。我想我知道 void 方法的作用和用途，但我无法理解这段示例代码（摘自[http://docs.oracle.com](http://docs.oracle.com) --BorderLayoutDemo）：

```
public class BorderLayoutDemo {

public static void addComponentsToPane(Container pane) {

    JButton button = new JButton("Button 1 (PAGE_START)");
    pane.add(button, BorderLayout.PAGE_START);

}

private static void createAndShowGUI() {

    JFrame frame = new JFrame("BorderLayoutDemo");
    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    **addComponentsToPane(frame.getContentPane());**
    frame.pack();
    frame.setVisible(true);
}

public static void main(String[] args) {
   createAndShowGUI();

}
} 
```

为什么这段代码有效，导致一个带有 1 个按钮的窗口（我预计这只会导致一个空窗口）。是否将 frame.getContentPane() 作为参数复制到 addComponentsToPane() 并在此 void 方法结束时销毁（未添加到框架）？为什么它不应该返回一个 Container 对象或 JPanel 对象，然后可以将其添加到框架中（即 frame.add()）。

（已编辑问题。pivot 关键字是无效的，而不是静态的。我看到我已经用原始类型教授了这个概念（无效方法），这使事情变得混乱）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T14:19:39.683

只是为了澄清@tzhechev，对象不是在Java中通过引用传递，而是在Java中对象引用是通过值传递的，Abu在答案中非常清楚地说明了这一点。为了更清楚地说明这个话题，请看这个例子。

```
class Employee
{
    String name;
    int age;
}

public class ValueOrReference
{
    public static void main(String... args)
    {
        Employee emp1 = new Employee();
        emp1.name = "Myself";
        emp1.age = 1;
        Employee emp2 = new Employee();
        emp2.name = "Yourself";
        emp2.age = 2;
        System.out.println("Before swapping values are : ");
        System.out.println("Employee 1 : ");
        System.out.println("Name : " + emp1.name);
        System.out.println("Age : " + emp1.age);
        System.out.println("Employee 2 : ");
        System.out.println("Name : " + emp2.name);
        System.out.println("Age : " + emp2.age);
        /*
         * Now if Objects are passed by Reference
         * then if I swap the two objects in a method, 
         * then the actual objects will reciprocate
         * to the said change. Lets find out.
         */
        swapObjects(emp1, emp2); 
        System.out.println("****************************************");
        System.out.println("Inside main after swap method.");
        System.out.println("After swapping values are : ");
        System.out.println("Employee 1 : ");
        System.out.println("Name : " + emp1.name);
        System.out.println("Age : " + emp1.age);
        System.out.println("Employee 2 : ");
        System.out.println("Name : " + emp2.name);
        System.out.println("Age : " + emp2.age);
        System.out.println("****************************************");
    }

    private static void swapObjects(Employee emp1, Employee emp2)
    {
        System.out.println("****************************************");
        System.out.println("Inside the swap method.");
        Employee temp = emp1;
        emp1 = emp2;
        emp2 = temp;
        System.out.println("After swapping values are : ");
        System.out.println("Employee 1 : ");
        System.out.println("Name : " + emp1.name);
        System.out.println("Age : " + emp1.age);
        System.out.println("Employee 2 : ");
        System.out.println("Name : " + emp2.name);
        System.out.println("Age : " + emp2.age);
        System.out.println("****************************************");
    }
} 
```

输出案例 1：

```
C:\Mine\JAVA\J2SE\classes>java ValueOrReference
Before swapping values are :
Employee 1 :
Name : Myself
Age : 1
Employee 2 :
Name : Yourself
Age : 2
****************************************
Inside the swap method.
After swapping values are :
Employee 1 :
Name : Yourself
Age : 2
Employee 2 :
Name : Myself
Age : 1
****************************************
****************************************
Inside main after swap method.
After swapping values are :
Employee 1 :
Name : Myself
Age : 1
Employee 2 :
Name : Yourself
Age : 2
**************************************** 
```

虽然如果我只使用一个对象并以某种方法修改它的内容，那么结果会令人惊讶。试试下面的代码以获得惊喜：

```
class Employee
{
    String name;
    int age;
}

public class ValueOrReference
{
    public static void main(String... args)
    {
        Employee emp1 = new Employee();
        emp1.name = "Myself";
        emp1.age = 1;
        System.out.println("Before swapping values are : ");
        System.out.println("Employee 1 : ");
        System.out.println("Name : " + emp1.name);
        System.out.println("Age : " + emp1.age);
        /*
         * Now if Objects are passed by Reference
         * then if I swap the two objects in a method, 
         * then the actual objects will reciprocate
         * to the said change. Lets find out.
         */
        modifyObject(emp1); 
        System.out.println("****************************************");
        System.out.println("Inside main after modify method.");
        System.out.println("After modifying values are : ");
        System.out.println("Employee 1 : ");
        System.out.println("Name : " + emp1.name);
        System.out.println("Age : " + emp1.age);
        System.out.println("****************************************");
    }

    private static void modifyObject(Employee emp1)
    {
        System.out.println("****************************************");
        System.out.println("Inside the modify method.");
        emp1.name = "Yourself";
        emp1.age = 2;
        System.out.println("After modifying values are : ");
        System.out.println("Employee 1 : ");
        System.out.println("Name : " + emp1.name);
        System.out.println("Age : " + emp1.age);
        System.out.println("****************************************");
    }
} 
```

输出案例 2：

```
C:\Mine\JAVA\J2SE\classes>java ValueOrReference
Before swapping values are :
Employee 1 :
Name : Myself
Age : 1
****************************************
Inside the modify method.
After modifying values are :
Employee 1 :
Name : Yourself
Age : 2
****************************************
****************************************
Inside main after modify method.
After modifying values are :
Employee 1 :
Name : Yourself
Age : 2
**************************************** 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-03T12:25:57.083

我认为您正在寻找 java 的按值传递的东西。查看这篇[文章](http://www.javaworld.com/javaworld/javaqa/2000-05/03-qa-0526-pass.html)，您可能会了解代码中发生的事情背后的内容，以及为什么它没有按照您的预期工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-03T12:28:26.937

对象是通过引用传递的，不会被复制。Java 通过引用而不是按值传递对象，正如您在 C 等语言中所习惯的那样。因此，您传递的`addComponentsToPane(frame.getContentPane());`是对框架内容窗格的实际引用。

然后静态方法使用该引用将按钮添加到实际内容窗格。没有充分的理由复制对象。例如，想象一下创建一个包含大量数据的类。每次将它传递给函数时都复制这个类是没有意义的。

对于 Java 中的“原始”类型，例如“int”或“double”，有一个例外。它们的处理方式与您在 C/C++ 中学习的方式相同。但是请记住，Integer 和 Double 是类。

希望有帮助！

# javascript - 在javascript中标记和扫描（上下文变量）

> ID：13209087
> 
> 赞同：0
> 
> 时间：2012-11-03T12:15:56.870
> 
> 标签：javascript, garbage-collection

我正在阅读*面向 Web 开发人员的专业 JavaScript*

我在阅读“当垃圾收集器运行时，它会标记存储在内存中的所有变量。然后它会清除**上下文中**的变量和上下文变量**引用的**变量的标记。”

我知道当任何变量都无法到达对象时，相关的内存将被回收。

“上下文中的变量”是什么意思？它们是可以在作用域链中找到的变量吗？但是“上下文变量引用的变量”呢？

我很困惑。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T13:00:05.717

我假设这是为了避免意外删除闭包中使用的变量。在 javascript 中，就像任何其他函数式语言一样，仅仅无法访问并不足以告诉您天气应该删除一个对象。

以下面的代码为例：

```
function a () {
    var x=0;
    return function () {
        alert(x++);
    }
}

var b = a();
// at this point, the instance of `x` created by calling `a` is
// no longer reachable but we are still using it in the closure. 
```

如果我们只遵循“不可达”规则，那么创建的闭包将丢失变量`x`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T13:24:59.630

考虑一下：

```
(function(){
    var sobriety = [];
    window.inception = function() {
        var i = 0, 
            j = 0,
            inner_level = { i: i }, 
            level       = { level: inner_level },
            food        = {};
        return function() { 
            var new_level = {
                level: level.level
            };
            new_level[i] = 'step ' + i;
            new_level.level.i = i;
            sobriety[i++] = new_level; 
        };
    };
    window.show_my_sobriety = function() { console.log(sobriety); };
})();

var agent = inception();
agent(); agent(); agent();
show_my_sobriety();​ 
```

[JS小提琴](http://jsfiddle.net/s6ym6/)。

*我承认这个例子有些复杂，但我只需要让它显示`i`（原始）和`inner_level`（引用类型）之间的区别。*

这里我们有一个带有一个`sobriety`局部变量的模块，以及两个全局函数（通过将它们分配给`window`对象的属性）。`sobriety`请注意，即使在定义了变量的模块完成（ ）之后，这些全局函数也可以访问变量`in-context`。

`inception`函数在调用时定义了五个变量：两个标量（`i`和`j`）和三个引用（`inner_level`、`level`和`food`），然后定义一个函数并返回它。

这个函数显然访问`i`and `level`（相同的上下文）和`sobriety`（外层上下文） - 但不是`j`and `food`。因此后者将在`window.inception`完成后由 GC 收集；但是，前者没有被收集——因为它们是由内部函数引用的。

现在是棘手的部分。虽然您`inner_level`在此函数中看不到访问权限，但它仍然可以访问 - 因为它是`level`同名对象的属性值。而且，当您检查结果时，您会看到所有三个元素都具有相同的`level.i`值 - 等于 2。这就是“由上下文变量引用的变量”所理解的。

# c - 如何在C中计算x天后的日期

> ID：13209097
> 
> 赞同：4
> 
> 时间：2012-11-03T12:17:33.153
> 
> 标签：c, date, days, real-time-clock

我正在用 C 语言编写一个具有内部 RTC 并自动递增日计数器（0-65536）的微控制器。因此，鉴于用户调整的初始日期（DD/MM/YYYY），我需要根据该计数器更新日历。也就是说，我需要知道如何计算 x 天后的日期。有谁知道这个算法？在网上找不到任何东西。

提前致谢。丹尼尔

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2016-09-06T05:30:23.980

正如@moooeeeep 在[他](https://stackoverflow.com/a/15669430/1316651)对同一问题的回答中所建议的那样，

> 为了清楚和正确起见，您应该坚持现有的解决方案。

```
#include <stdio.h>
#include <time.h>

int main()
{        
    /* initialize */
    int y=1980, m=2, d=5;    
    struct tm t = { .tm_year=y-1900, /* The number of years since 1900   */ 
                    .tm_mon=m-1,  /* month, range 0 to 11 */
                    .tm_mday=d };
    /* modify */
    t.tm_mday += 40;
    mktime(&t);
    /* show result */
    printf("%s", asctime(&t)); /* prints: Sun Mar 16 00:00:00 1980 */
    return 0;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T12:54:01.750

检查这个。也许它需要一些调整。有点蛮力，但即使对于微控制器，速度也应该足够了。

```
#include <stdio.h>

static int days_in_month[] = { 0, 31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31 };
int day, month, year;

unsigned short day_counter;

int is_leap(int y) {
    return ((y % 4 == 0 && y % 100 != 0) || y % 400 == 0);
}

next_day()
{
    day += 1; day_counter++;
    if (day > days_in_month[month]) {
        day = 1;
        month += 1;
        if (month > 12) {
            month = 1;
            year += 1;
            if (is_leap(year)) {
                days_in_month[2] = 29;
            } else {
                days_in_month[2] = 28;
            }
        }
    }
}

set_date(int d, int m, int y) 
{
    m < 1 ? m = 1 : 0;
    m > 12 ? m = 12 : 0;
    d < 1 ? d = 1 : 0;
    d > days_in_month[m] ? d = days_in_month[m] : 0;
    if (is_leap(y)){
        days_in_month[2] = 29;
    } else {
        days_in_month[2] = 28;
    }
    day = d;
    month = m;
    year = y;
}

skip_days(int x)
{
    int i;
    for (i=0;i<x;i++) next_day();
}

print_date()
{
    printf ("day: %d month: %d year: %d\n", day, month, year);
}

int main(int argc, char **argv)
{
    int i;

    set_date(5, 2, 1980);

    skip_days(10000);
    day_counter = 0;
    /* after this call next_day each day */

    print_date();

    return 0;
} 
```

# java - 使用 Java 生成 mp3/wav/ogg 波形

> ID：13209099
> 
> 赞同：6
> 
> 时间：2012-11-03T12:17:49.127
> 
> 标签：java, audio, waveform

像 soundcloud 和 zippyshare ¹一样，如何使用 java 生成音频波形图像？是否有任何框架或开源库可用于这种情况？

我想将音频波形生成为图像，并在加载轨道时，将加载波形图像。

1.  ![在此处输入图像描述](../Images/28dd88dc3118f9e9c1d514e25c47762c.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T14:24:53.797

[从这个答案](https://stackoverflow.com/a/12121808/418556)开始。在这种情况下，“进一步处理..”可能是将每个瞬时值添加到 a `GeneralPath`，然后（缩放该路径以适合绘画区域并）绘制它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T15:13:18.093

以下是关于 SO 的两个问题的答案：

[为音频文件创建 PNG 波形的 Java 程序](https://stackoverflow.com/questions/11017283/java-program-that-create-a-png-waveform-for-an-audio-file)

[如何从我的 wav 文件中提取声音数据？](https://stackoverflow.com/questions/12879210/how-can-i-draw-sound-data-from-my-wav-file)

我最喜欢我对第二个问题的回答，因为它解释了在所有情况下如何做到这一点，但它没有给出代码。

还有很多其他的答案。

# javascript - 存在时将类添加到最后一个 div

> ID：13209101
> 
> 赞同：0
> 
> 时间：2012-11-03T12:18:00.410
> 
> 标签：javascript, jquery

我有以下 HTML 结构，我想在最后`<div>`一个包含`<p>`标签的类中添加一个类，但只有当它存在时。

```
<div id="view">
  <div class="login">
  </div>
  <div>
    <p>Add a class to this parent DIV</p>
  </div>
</div> 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T12:21:44.910

简单的片段：

```
if($('#view div:last p').​​​​​​​​​​​length)
    $('#view div:last').addClass('myClass');​​​​​​​​​​​ 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-03T12:25:00.477

将获取所有具有 ap 标签的 div

```
p = $('#view div p');
if (p.length) {
  $(p[p.length - 1]).addClass("largerText");
}​ 
```

这是[小提琴](http://jsfiddle.net/bLLWg/2/)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-11-03T12:25:07.517

是的，Roaster 给出了正确的答案，这就是它的小提琴。[http://jsfiddle.net/sameerast/qhsXM/](http://jsfiddle.net/sameerast/qhsXM/)

```
<div id="view">
  <div class="login">
  </div>
  <div>
    <p>Add a class to this parent DIV</p>
  </div>
</div>​

if($('#view div:last p').length){
    $('#view div:last').addClass('myClass');
}
​
.myClass {
    border:red 1px solid;
}​ 
```

# php - php中的页面重定向

> ID：13209102
> 
> 赞同：1
> 
> 时间：2012-11-03T12:18:02.067
> 
> 标签：php

我创建了一个登录表单，它正在重定向到 validatelogin.php 并进行了验证。

```
 <tr>
        <td>Username / Email</td>
        <td><input name="usr_email" type="text" class="required" id="txtbox" size="25"></td>
      </tr>
      <tr>
        <td>Password</td>
        <td><input name="pwd" type="password" class="required password" id="txtbox" size="25"></td>
      </tr>

      <tr>
        <td colspan="2"> <div align="center">

                <input name="doLogin" type="submit" id="doLogin3" class="styled-button-1" value="Login" /> 
```

myvalidate.php 是：

```
if(empty($err)){

          header("Location: index.php?Page=defaultblog");
}
else
{
  $err[] = "Invalid Login. Please try again with correct user email and password.";
}
} else {
        $err[] = "Error - Invalid login. No such user exists";
}
} 
```

在本地机器中，如果没有错误，它会重定向到，`header("Location: index.php?Page=defaultblog");`但是当我将它上传到 inot 服务器时，它只会重定向到`validate.php` 请告诉我？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T13:10:55.027

将以下行添加到 php 代码的顶部某处，因为我认为没有调用您的重定向。

```
error_reporting(E_ALL); 
ini_set('display_errors', 'On'); 
```

关键问题可能是在此代码之前的某处有一个空格或空行，这会阻止重定向触发。解决后，根据需要重置错误报告。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-11-03T12:20:44.173

```
if(empty($err)){

       echo '<meta http=equiv="refresh" content="1;url=index.php?Page=defaultblog">';
     }

    else
    {

    $err[] = "Invalid Login. Please try again with correct user email and password.";

    }
} else {
    $err[] = "Error - Invalid login. No such user exists";
  } 
```

# javascript - 更高效地动画列表项

> ID：13209104
> 
> 赞同：0
> 
> 时间：2012-11-03T12:18:19.227
> 
> 标签：javascript, jquery

我想在悬停时增加一个 li 并让它在鼠标离开时恢复到原始状态。这可行，但是当鼠标离开时会再次悬停动画（向上），这给了我延迟和低效的代码。你们有什么建议让我提高效率吗？

```
function HoverListItem() {
    var menuItem = $('#menu > li')
    menuItem.on('hover', function(){
        console.log('up');
            $(this).animate({
                'marginTop': '-10px'
            }, 150);
        });

    menuItem.on('mouseleave', function(){
        console.log('down');
            $(this).animate({
                'marginTop': '0px'
            }, 150);
        })
    }; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T12:23:28.670

这是因为动画是排队的，在发出新动画之前清除队列。我自己也更喜欢使用 hover() 来注册 mouseenter 和 mouseleave。

```
$("#menu > li")
  .css("position", "relative")
  .hover(
    function() {
        $(this).clearQueue().animate({
            bottom: 10
        });
    },
    function() {
        $(this).clearQueue().animate({
            bottom: 0
        });
    } 
```

示例：http: [//jsfiddle.net/6xXGw/](http://jsfiddle.net/6xXGw/)

# android - 从 jni (ndk) 创建大数组并将它们返回给 android

> ID：13209107
> 
> 赞同：1
> 
> 时间：2012-11-03T12:18:30.067
> 
> 标签：android, android-ndk, java-native-interface

我正在开发一个应用程序，我需要读取大图像文件（6000x6000），然后应用一些过滤（如模糊和颜色效果），然后保存图像。过滤库是用 Java 编写的第 3 方库，并采用以下内容作为输入：

```
/**
* rgbArray : is an Array of pixels 
*/
public int[] ImageFiltering(int[] rgbArray,int Width,int Height); 
```

问题是，如果我将图像加载到内存中（6000 x 6000 x 4 = 137.33 MB），android 会抛出 OutOfMemory 错误。在阅读了一些[文档](http://blog.javia.org/how-to-work-around-androids-24-mb-memory-limit/)并知道从 NDK 分配的内存不是应用程序堆的一部分后，我有了一个有趣的想法：

1.  从 NDK 打开图像 读取它的内容并保存在一个数组中

2.  将数组传回 Java

3.  对数组数据应用过滤器

4.  将数组返回到 NDK

5.  将数据数组保存到新图像中并释放数组内存

这是一个返回大数组的 NDK 函数示例：

```
jint*
Java_com_example_hellojni_HelloJni_stringFromJNI( JNIEnv* env,jobject thiz,jint w,jint h)
{

    int* pixels = (int*)malloc(w * h * 4);
    read_image_into_array("image.jpg",pixels);

    return pixels;
} 
```

目标是在本机中保留内存以避免出现 OutOfMemory 错误，并将内存引用传递给 Java 以便使用它。由于我不是 C 开发人员，也从未接触过 JNI，所以这一切有意义吗？如何在 NDK 中实现它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T13:47:58.713

使用直接的 ByteBuffer，将分配的内存用作其后备缓冲区。您可以从 JNI 分配一个直接字节缓冲区（使用`NewDirectByteBuffer()`）并返回它。

您需要提供一种补充方法来处理内存或以其他方式向本机端指示它不再使用。

# java - 这个棋盘小程序有什么问题？

> ID：13209114
> 
> 赞同：0
> 
> 时间：2012-11-03T12:19:37.897
> 
> 标签：java, applet, java-7

我尝试使用小程序技术使用 Java 7 编写棋盘。但我得到的只是一个大而单一的“白色”单元板。那么怎么了？这是我的两个源文件：

ChessWebLauncher.java

```
/*
 * This file is part of ChessWeb.

ChessWeb is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

ChessWeb is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with ChessWeb.  If not, see <http://www.gnu.org/licenses/>
 */
package fr.loloof64.java_applet.chess_web.main;

import java.applet.Applet;

import fr.loloof64.java_applet.chess_web.views.BoardCanvas;

/**
 * The application applet.
 * @author laurent-bernabe
 *
 */
public class ChessWebLaucher extends Applet {

    @Override
    public void init() {
        /*
         * Here I add the board canvas.
         */
        add(boardCanvas);
    }

    private BoardCanvas boardCanvas = new BoardCanvas(this);

    /**
     * Multi-threading security id.
     */
    private static final long serialVersionUID = -7638783779678653225L;

} 
```

BoardCanvas.java

```
/*
 * This file is part of ChessWeb.

ChessWeb is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

ChessWeb is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with ChessWeb.  If not, see <http://www.gnu.org/licenses/>
 */

package fr.loloof64.java_applet.chess_web.views;

import java.awt.Color;
import java.awt.Container;
import java.awt.Dimension;
import java.awt.Graphics;
import java.awt.LayoutManager;
import java.awt.Panel;

public class BoardCanvas extends Panel {

    /**
     * Simple constructor accepting a parent Container (java.awt)
     * @param parent - {@link Container} - the parent Container.
     */
    public BoardCanvas(Container parent) {
        adjustSize(new Dimension(DEFAULT_SIZE_PX, DEFAULT_SIZE_PX));
    }

    /**
     * Adjust size with the least value (between width and eight).
     * @param parent - {@link Container} - the parent Container.
     * @param layout - {@link LayoutManager} - the layoutmanager.
     */
    public BoardCanvas(Container parent, LayoutManager layout) {
        super(layout);
        Dimension requestedDimensions = layout.preferredLayoutSize(parent);
        adjustSize(new Dimension(requestedDimensions.width, requestedDimensions.height));
    }

    @Override
    public void paint(Graphics graphics) {
        for (int rankFromTopIndex = 0; rankFromTopIndex < 8; rankFromTopIndex++){
            for (int fileFromLeftIndex = 0; fileFromLeftIndex < 8; fileFromLeftIndex++){
                Color cellColor = ((rankFromTopIndex+fileFromLeftIndex) % 2) == 0 ?
                    WHITE_CELL_COLOR : BLACK_CELL_COLOR;

                int xAbsCoordinate = currentCellsSizePx * fileFromLeftIndex;
                int yAbsCoordinate = currentCellsSizePx * rankFromTopIndex;

                /*
                 * Finally paints the current (loop) cell.
                 */
                graphics.setColor(cellColor);
                graphics.fillRect(xAbsCoordinate, yAbsCoordinate, currentCellsSizePx, currentCellsSizePx);
            }
        }
    }

    private void adjustSize(Dimension requestedDimensions){
        int requestedWidth = requestedDimensions.width;
        int requestedHeight = requestedDimensions.height;
        currentCellsSizePx = requestedWidth > requestedHeight ? requestedWidth : reqestedHeight;
        setPreferredSize(new Dimension(currentCellsSizePx, currentCellsSizePx));
    }

    /**
     * Current cells size (in pixels).
     */
    private int currentCellsSizePx;

    /**
     * Default cells size (in pixels).
     */
    private static final int DEFAULT_SIZE_PX = 256;

    /**
     * White cells colors.
     */
    private static final Color WHITE_CELL_COLOR = new Color(0xE9E441);

    /**
     * Black cells colors.
     */
    private static final Color BLACK_CELL_COLOR = new Color(0xEBAD39);

    /**
     * Multi-threading security code.
     */
    private static final long serialVersionUID = 7321516321051309085L;

} 
```

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T12:45:46.510

您似乎没有调用 paint() 方法。

据我所知，你只使用

```
public BoardCanvas(Container parent) {
    adjustSize(new Dimension(DEFAULT_SIZE_PX, DEFAULT_SIZE_PX));
} 
```

所以你有一个调整大小的正方形，默认为白色。

# c# - 如何使用文本框手动设置另一个表单的位置？

> ID：13209116
> 
> 赞同：0
> 
> 时间：2012-11-03T12:19:47.020
> 
> 标签：c#, winforms

在 Form1 我有 2 个文本框，我想用它们编辑 Form2 的位置。（文本框 1 = X，文本框 2 = Y）

非常感谢你！

这是我所做的代码：

```
 private void button8_Click(object sender, EventArgs e)
   {
       frm2 = new Form2();
       frm2.Top = int.Parse(textBox2.Text);
       frm2.Left = int.Parse(textBox3.Text);
   } 
```

它不起作用，我想我应该在 form2 中创建一个方法？对不起我的无知

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T12:44:54.267

每个 Form-Object 都有属性来定义它在屏幕上的位置和尺寸。

参考 MSDN 文档[http://msdn.microsoft.com/en-us/library/system.windows.forms.form.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.form.aspx)这些属性是

*   `int Form.Top`（获取或设置控件上边缘与其容器客户区上边缘之间的距离，以像素为单位。）

*   `int Form.Left`（获取或设置控件左边缘与其容器客户区左边缘之间的距离，以像素为单位。）

*   `int Form.Width`（获取或设置控件的宽度。）

*   `int Form.Height`（获取或设置控件的高度。）

假设您有两个名为 form1 和 form2 的表单对象，并且您想通过在 form1 上的文本字段中输入值来修改 form2 的属性，您只需执行类似的操作：

```
// inside form1
// assuming you have textfields for each position/dimension property

form2.Top = int.Parse(textfield_Top.Text);
form2.Left = int.Parse(textfield_Left.Text);
form2.Width = int.Parse(textfield_Width.Text);
form2.Height = int.Parse(textfield_Height.Text); 
```

请注意，您希望将整数值（数字）传递给 form2 的属性，但该`string TextBox.Text`属性是字符串类型。您可能希望将强制转换从字符串应用到 int，这是默认的执行方式 - 如上所示，使用

```
int int.Parse(string s) 
```

# python - 函数式python编程和条件

> ID：13209119
> 
> 赞同：4
> 
> 时间：2012-11-03T12:20:18.853
> 
> 标签：python, lambda, functional-programming, conditional-statements

我正在尝试以功能方式编写 python 函数。问题是我不知道如何将 if 条件转换为功能样式。我有两个变量：`A`和`C`，我想检查以下条件：

```
def function():
    if(A==0): return 0
    elif(C!=0): return 0
    elif(A > 4): return 0
    else: someOtherFunction() 
```

我查看了[lambda shortcircuiting](http://www.ibm.com/developerworks/linux/library/l-prog/index.html)，但我无法让它工作。

我提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-03T12:40:10.410

从[您发布的链接](http://www.ibm.com/developerworks/linux/library/l-prog/index.html)：

> FP 要么不鼓励要么完全禁止语句，而是使用表达式的评估

`if`因此，您可以使用[条件表达式](http://docs.python.org/reference/expressions.html#conditional-expressions)来代替-statements ：

```
def function():
    return (0 if ((A == 0) or (C != 0) or (A > 4)) else
            someOtherFunction()) 
```

或者，（如果有许多*不同*的值，则特别有用）：

```
def function():
    return (0 if A == 0 else
            0 if C != 0 else
            0 if A > 4 else
            someOtherFunction()) 
```

* * *

顺便说一句，链接的文章提出

```
(<cond1> and func1()) or (<cond2> and func2()) or (func3()) 
```

作为一个短期课程等价于

```
if <cond1>:   func1()
elif <cond2>: func2()
else:         func3() 
```

问题是它们不相等！`<cond1>`当为 True 但`func1()`为 Falsish（例如`False`or`0`或）时，布尔表达式无法返回正确的值`None`。（或者类似地，什么时候`<cond2>`是真但是`func2`假的。）

```
(<cond1> and func1()) 
```

编写的目的是评估`func1()`何时`<cond1>`为真，但何时`func1()`为假，`(<cond1> and func1())`评估为`False`，因此整个表达式被传递，Python 继续评估`(<cond2> and func2())`而不是短路。

所以这里有一段有趣的历史。2005 年， [Raymond Hettinger](http://mail.python.org/pipermail/python-dev/2005-September/056510.html)`type(z)==types.ComplexType and z.real or z`在when `z = (0+4j)`because `z.real`is Falsish中发现了一个类似的难以发现的错误。出于避免我们出现类似错误的愿望，使用[不易出错的语法](http://www.python.org/dev/peps/pep-0308/)（条件表达式）的想法诞生了。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-03T12:25:17.677

您当前的代码中没有任何非“功能样式”！谁说条件无论如何都*不起作用*？实际上，所有函数式语言都有某种条件运算符，例如`cond`Lisp 中的特殊形式。

如果代码使用赋值运算符或以某种方式改变状态（例如，附加到列表），我会对代码提出异议，但事实上，问题中的函数已经处于“函数式” - 那里没有状态变化。

也许你的意思是这样的？

```
return A != 0 and C == 0 and A <= 4 and someOtherFunction() 
```

`False`如果是`A == 0`or`C != 0`或，以上将返回`A > 4`，在所有其他情况下，它将返回 call 的值`someOtherFunction()`。顺便说一句，`False`可以假设评估为`0`（例如，`42 + False == 42`），因此从调用者的角度来看，问题中代码中的语义将被保留。

请注意，您将链接中的信息与上下文无关。绝对没有必要为此使用 a `lambda`，本文仅说明如何绕过`lambda`Python 中 s 的固有限制，即您不能在内部返回语句 (like `if-elif-else`) - 只允许使用表达式，但您可以伪造他们用布尔运算符。无论如何，在正常*函数*的上下文中，使用条件。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-03T13:06:38.890

尽管 Peter Norvig 是一个非常棒的人，但他的网站很难搜索。

我记得读过关于[我可以在 Python 中做相当于 (test ? result : alternative) 的文章吗？](http://norvig.com/python-iaq.html)在一次功能性 Python 演讲之前的一些研究期间，在他的网站上。

鉴于我的发现，我不会以某种方式左右你，但你仍然应该去阅读关于函数式三元条件运算符的部分。

```
def if_(test, result, alternative=None):
    "If test is true, 'do' result, else alternative. 'Do' means call if callable."
    if test:
        if callable(result): result = result()
        return result
    else:
        if callable(alternative): alternative = alternative()
        return alternative 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-03T23:55:37.593

只需按原样使用它。

Python 没有*内置*的语法和库，因此可以轻松地对所有函数进行编程以直接返回单个表达式。无论如何，这不是功能样式最重要的部分，最重要的部分是确保您的函数保持**引用完整性**。基本上，这意味着无论何时为它们提供相同的输入值，它们都会返回相同的输出。

因此，当尝试在 Python 中进行函数式编程时，我并*没有*完全避免使用语句。我使用一个局部变量赋值块作为`let ... in ...`来自 Haskell 的等价物。我使用 if/elif/else 链作为`case`Haskell 中的表达式的等效项。并且通常有一些内置类型没有提供足够的接口来创建它们的新“修改”版本而不是就地更新它们，因此您必须使用显式复制操作来实现此类操作，然后使用突变新副本。

Python 允许您直接实现函数式*设计*。您可以轻松地将您的程序构建为一组显式传递状态且没有副作用的函数，因此您可以以与函数式编程语言非常相似的方式设计高级*算法*。从这个意义上说，几乎每种编程语言都支持函数式编程，如果您准备好忍受伪造一流函数所必需的样板文件。由于 Python*具有*一流的功能，因此您甚至不必忍受样板文件。

但这就是 Python 在支持函数式编程方面的表现。它并不真正支持将函数实现为单个引用透明的表达式。但这并不重要。在不强制或不跟踪纯度的语言中，您可以获得函数式编程的几乎所有好处，您只需将程序*设计*为一堆引用透明的函数，然后如何实现这些函数实际上并不重要只要*接口*保持引用透明。

# sql-server-2008 - IIS偶尔无响应

> ID：13209120
> 
> 赞同：1
> 
> 时间：2012-11-03T12:20:22.837
> 
> 标签：sql-server-2008, iis

我正面临 3 层应用程序的问题。它使用 IIS 和 SQL Server。问题是有时（更长的请求导致更高的概率）客户端没有收到来自 IIS 的响应。当 SQL Server 上没有活动时，它会挂起，即使我杀死了一个 SQL 进程，我也没有得到异常响应。当我在这些挂起后检查数据时，我发现我的 SQL 请求已成功，因此问题似乎出在 IIS 上。不幸的是，我对托管应用程序的位置没有太多控制权，我无法重现该问题。这个问题可以有很多答案，但至少我需要一个提示，说明我应该研究什么方向。
**更新**：我还有一个在同一台服务器上运行的应用程序，它执行一项小工作：它将大约 100 行一行一行地插入到数据库中。我人为地让它运行了大约 10 分钟（通过将 xlock 放在桌子上）。删除 xlock 后，IIS 上的进程继续运行并成功插入了这 100 行。但是，此后控制权再也没有返回给客户端，它只是无限期地等待。在长时间运行的进程后向客户端返回响应时，这似乎是一个问题。
顺便说一句，这不是一个网站，而是一个使用 Remoting 的 WinForms 应用程序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T14:17:28.403

如果您确定 SQL Server 正在返回 IIS，那么您可能需要检查[IIS 日志](http://msdn.microsoft.com/en-us/library/ms525410.aspx)以了解请求可能发生的情况。这些日志的正常位置是`%SystemRoot%\system32\Logfiles\<service_name>`.

如果您不确定 SQL Server，您可以访问 SQL 日志、运行 Profiler 或检查 Windows 系统日志中的错误、在 Visual Studio 中调试运行您的站点或将您自己的日志记录添加到您的应用程序以确定哪个步骤它挂了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-25T08:02:32.623

我终于弄清楚问题出在哪里了。该应用程序在 Web 场上运行，并且在客户端和 IIS 之间有一个平衡器服务器。平衡器上的超时太小。由于某种原因，它对 .net 远程处理不太友好，并且它不会向客户端返回任何超时异常。该问题已通过增加超时得到解决。

# sql-server - 如果列是 Where 子句中值的一部分，则匹配

> ID：13209121
> 
> 赞同：0
> 
> 时间：2012-11-03T12:20:28.017
> 
> 标签：sql-server, tsql

我有个问题：

我正在尝试将值（url）与 dbtable 中的 UrlPart 列中的值进行匹配。

假设一行中的一列 UrlPart 具有值“id=12345”。

现在我有一个查询：

```
select * from products
where UrlPart [is part of] 
'http://www.domain.com/category/?id=12345&referrer=www.google.com&etcetera' 
```

我希望看到匹配 [id=12345 [is part of] 'http://www.domain.com/category/?id=12345& 为真，因此它将返回产品行。

当然 [Is part of] 不存在，但我想知道是否可以将列中的值与每个请求都会改变的 url 表达式相匹配。就像一个正常的 where 语句，但随后被撤销。

这样的事情可能`SQL 2008 Express Edition`吗？

[更新]

我已经测试了 like '%' + UrlPart '%' 和 CharIndex ，根据 MS SQL 的执行计划，它们是相同的。似乎 SQL 在水下做同样的事情，所以这两个选项都很好。

我认为 CharIndex 可能比 like 更原始（可能会被转换），所以我现在就选择那个。

谢谢你们。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T12:32:05.113

you can use `charindex` :

```
select * from products
where charindex('http://www.domain.com...',urlPart)<>0 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-03T12:30:26.367

```
select * 
from products
where 'http://www.domain.com/category/?id=12345&referrer=www.google.com&etcetera' like '%' + UrlPart + '%' 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-03T12:29:02.413

```
select * 
from products 
where 'http://www.domain.com/category/?id=12345&referrer=www.google.com&etcetera'  
      like '%'+UrlPart+'%' 
```

# c# - C#.Net 中 OnManipulationStarted(ManipulationStartedEventArgs e) 中 base.OnManipulationStarted(e) 的用途是什么？

> ID：13209125
> 
> 赞同：1
> 
> 时间：2012-11-03T12:21:02.407
> 
> 标签：c#, .net, visual-studio-2010, c#-4.0

我创建了一个程序，它使用

```
OnManipulationStarted(ManipulationStartedEventArgs e) 
```

然后我发现

```
base.OnManipulationStarted(e) 
```

它被自动插入到代码中......我已经评论了那行并检查了程序输出没有改变的程序......为什么这个代码存在于默认方法中？

```
OnManipulationStarted(ManipulationStartedEventArgs e) 
```

任何帮助请...在此先感谢..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T12:31:36.420

它调用您要**[覆盖](http://msdn.microsoft.com/en-us/library/aa645768%28v=vs.71%29.aspx)**的方法的基类实现。如果要保留 的基类行为`OnManipulationStarted`，则应将该行保留在覆盖的实现中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T12:32:59.767

它调用方法的基类实现。

特别是，如果你不打电话，我不希望[`ManipulationStartedEvent`](http://msdn.microsoft.com/en-us/library/system.windows.uielement.manipulationstarted.aspx)实际提出。我的猜测是您没有看到任何行为变化，因为没有人订阅该事件。

除非你*故意*压制事件（这听起来对我来说是一个非常糟糕的主意），否则你应该保持基本调用。

# c++ - 具有重载运算符的指针数组

> ID：13209138
> 
> 赞同：0
> 
> 时间：2012-11-03T12:22:36.940
> 
> 标签：c++

当我运行此代码时，我得到一个 bad_alloc 错误，我访问下标运算符是错误的还是什么？对我来说，我去适当的对象是有道理的，它被返回，然后下标运算符应该启动？顺便说一句，我想使用数组而不是向量:)

```
class A{
    public:
    A(int size)
    {
        array = new int[size];
    }
    int& operator[](const int &i)
    {
        return array[i]
    }
    private:
       int * array;
};

int main()  {
   A ** a = new A*[10];
   for(int i = 0; i < 10; i++)  {
      a[i] = new A(10);
      for(int l = 0; l < 10; l++)   {
         cout << a[i][l] << endl;
      }
   }
} 
```

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-03T12:41:07.537

您需要先取消引用指针，然后才能调用`operator[]`

```
cout << (*(a[i]))[l] << endl; 
```

这是需要发生的事情，一步一步：

```
A* pA = a[i];
A& rA = *pA;
int& val = rA[l];
cout << val; 
```

目前发生这种情况：

```
A* pA = a[i];
A& ra = *(pA + l); // pA is indexed as an array of As - this is wrong
cout << ra; // invalid memory 
```

# asp.net - 在 imageurl 的中继器中使用多个 Eval("Variable")

> ID：13209140
> 
> 赞同：1
> 
> 时间：2012-11-03T12:22:50.157
> 
> 标签：asp.net, webforms

我正在尝试通过使用中继器和 Eval 将多个值放入 imageurl。

这就是我现在得到的：

```
ImageUrl='/images/<%# Eval("OneId") %> + "/" + <%# Eval("TwoId") %> + "." + <%# Eval("Extension")%>' 
```

这就是 url 变成的样子：

```
 img src="/images/&lt;%#%20Eval(&quot;CarId&quot;)%20%&gt;%20+%20&quot;/&quot;%20+%20&lt;%#%20Eval(&quot;ImageId&quot;)%20%&gt;%20+%20&quot;.&quot;%20+%20&lt;%#%20Eval(&quot;Extension&quot;)%&gt;">` 
```

这就是我想要摆脱的：*`/images/4578/123478.png`*

有谁知道我应该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T12:26:41.177

它将起作用并使您的代码更具可读性

```
ImageUrl=<%# String.Format("'/images/{0}/{1}.{2}'", Eval("OneId"), Eval("TwoId"), Eval("Extension")) %> 
```

# scope - 不明显的模型变化

> ID：13209142
> 
> 赞同：0
> 
> 时间：2012-11-03T12:23:09.750
> 
> 标签：scope, angularjs, event-listener

在 angularjs/express/postgres 应用程序中，我想将 json 对象的大列表从数据库加载到客户端。每个 json 对象都是它自己很大。每个 on 都存储在单独的行中。所以我想在从数据库中读取每个 json 对象后立即显示它们。

我找到了 EventSource api，可以将 json 对象从服务器逐步发送到客户端。哪个工作正常。

然后我想尽快将它们显示在我的视图中。

使用事件源包括使用事件侦听器。

正如这里解释的那样[https://groups.google.com/forum/?fromgroups=#!topic/angular/xMkm81VkR9w](https://groups.google.com/forum/?fromgroups=#!topic/angular/xMkm81VkR9w) 角度不会注意到模型的变化，因为范围修改发生在角度世界之外，在事件侦听器内.

有一种方法可以通过调用 $scope.$apply() 来触发脏检查。但由于我的列表超过 200 个元素，因此触发了此错误：

```
Error: 10 $digest() iterations reached. Aborting! 
```

所以我想知道是否有另一种方法来触发脏检查？也许另一种方式来解决我的问题。

编辑：在对实际问题进行反思后更改了标题

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T15:31:19.120

事实上，问题来自部分，我在 ng-show 指令中添加过滤器表达式我不好

# css - 在 twitter 引导程序中使用 less

> ID：13209143
> 
> 赞同：3
> 
> 时间：2012-11-03T12:23:10.207
> 
> 标签：css, twitter-bootstrap, less, bootswatch

我正在尝试使用[http://bootswatch.com/](http://bootswatch.com/)中的一种样式。我想将他们样式的 .less 版本应用于 bootstrap.css。为此，我按照[http://lesscss.org/#usage](http://lesscss.org/#usage)中的描述执行以下操作：

```
<link href="bootstrap.css" rel="stylesheet" type="text/css">
<link href="variables.less" rel="stylesheet/less">
<link href="bootswatch.less" rel="stylesheet/less">
<script src="less.js" type="text/javascript"></script> 
```

但它不起作用，即我仍然有默认的引导主题。

为了简化我已经合并`variables.less`到`bootswatch.less`中，所以代码现在看起来像这样：

```
<link href="bootstrap.css" rel="stylesheet" type="text/css">
<link href="bootswatch.less" rel="stylesheet/less">
<script src="less.js" type="text/javascript"></script> 
```

但我仍然得到默认的引导主题。

我已经检查了调试器并且所有文件都正确链接，所以我想我在使用中做错了什么。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-03T13:00:07.960

如果您使用 bootswatch 中的 less 文件，我认为您还需要使用 bootstrap 中的 less 文件。该`variables.less`文件将覆盖原始文件中的值。

我所做的是下载引导程序较少的文件，将`bootswatch.less`和复制`variables.less`到同一个文件夹（我重命名`variables-bootswatch.less`为向前兼容，如果引导表不是最新的）。

然后我修改了`bootstrap.less`文件以包含上述文件：

```
// Header and everything before variables.less

@import "variables.less"; // Modify this for custom colors, font-sizes, etc
@import "variables-bootswatch.less";

// everything else, then at the end

@import "bootswatch.less"; 
```

最后，您只需要导入此文件（无 CSS）

```
<link href="bootstrap.less" rel="stylesheet/less">
<script src="less.js" type="text/javascript"></script> 
```

* * *

似乎 github 上有一个项目旨在为您构建样本主题：[github 上的 swatchmaker](https://github.com/thomaspark/bootswatch/tree/master/swatchmaker)。它应该生成适当的 CSS 文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T12:33:36.373

我认为您需要更改脚本文件的顺序如下

```
<link href="bootstrap.css" rel="stylesheet" type="text/css">
<script src="less.js" type="text/javascript"></script>
<link href="bootswatch.less" rel="stylesheet/less"> 
```

# c# - 在数据网格视图之间移动值

> ID：13209146
> 
> 赞同：0
> 
> 时间：2012-11-03T12:23:33.943
> 
> 标签：c#, .net, windows, winforms, sqlite

我有个问题。我在新创建的对象数据网格中创建选项卡（每个都有不同的信息，也计算平均值）。数据网格中的数据被写入 SQLite 数据库。读取 DGV 从算术平均值创建动态列后，我想移动而不必将数据库写入另一列。将数据存储在数组中是一个好方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T16:54:44.487

我不确定我是否正确理解了您的问题，但是如果您只是想将值移动到另一个 datagridview，那么您就在正确的轨道上，您可以将它们存储在数组或列表中。之后，您可以迭代数组并在另一个 dgv 中填充该列。
如果我没有正确理解，请编辑您的问题并添加更多详细信息。

# joomla - joomla 与 ajax

> ID：13209151
> 
> 赞同：0
> 
> 时间：2012-11-03T12:24:21.497
> 
> 标签：joomla, joomla2.5

我在一个菜单项中分配一个模块，我的模块调用这个函数

```
require JModuleHelper::getLayoutPath('mod_arquero', $params->get('layout', 'default')); 
```

我的 default.php 是这个

```
<script>
    window.addEvent('domready', function(){
        //función a ejecutar cuando esté listo el dom

        $('descripcion').addEvent('click', function(evento){
            var nuevoRequest = new Request({
                method: 'get',
                url: 'index.php?option=com_content&view=article&id=6',
                onRequest: function() { alert(' Ajax!'); },
                onSuccess: function(texto, xmlrespuesta){ $('arPrincipal').set('html',texto);}
            }).send();

        });

    });
</script>

<div id="contenedor">
    <div id="arqMenu">
        <ul id="menu">
            <li><a href="javascript:void(0)" title="descripcion" id="descripcion">Descripción</a></li>
            <li><a href="#" title="arquitectura">Arquitectura</a></li>
            <li><a href="#" title="integracion_ti">Integración con TI</a></li>
            <li><a href="#" title="instalaciones">Instalaciones tipo</a></li>
            <li><a href="#" title="especificaciones">Especificaciones</a></li>
        </ul>
    </div>
    <div id="arqPrincipal">aqui va todo el txto</div>
</div> 
```

我有四个静态页面，当我点击描述时，我想在这个 div=arqPrincipal 中显示页面描述

我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T06:45:49.980

您的代码有错字 error.div id 与您在 Ajax 调用中提到的不同。尝试这个-

[JSFIDDLE](http://jsfiddle.net/TcgE2/)

```
<script>
    window.addEvent('domready', function(){
        //función a ejecutar cuando esté listo el dom

        $('descripcion').addEvent('click', function(evento){
            var nuevoRequest = new Request({
                method: 'get',
                url: 'index.php?option=com_content&view=article&id=6',
                onRequest: function() { alert(' Ajax!'); },
                onSuccess: function(texto, xmlrespuesta){ $('arqPrincipal').set('html',texto);}
            }).send();

        });

    });
</script> 
```

让我知道它是否仍然不起作用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T05:13:52.887

```
jQuery.post('index.php',{
                        'option':'component_name',
                        'controller':'controller_name',
                        'task':'task_name',
                        'format':'raw',                   
                        'data': data
                },function(result){                     
                      //edit the result here

                    return;
       }); 
```

试试这个，让我知道。不要忘记根据需要更改变量。

# html - 为什么两个块需要向左浮动才能对齐？

> ID：13209152
> 
> 赞同：0
> 
> 时间：2012-11-03T12:24:22.820
> 
> 标签：html, css

假设我有这个 HTML：

```
​&lt;div class = "block1">hi</div>
<div class = "block2">hi</div> 
```

这个CSS：

```
​.block1 {
    width:100px;
    border:1px solid;
    float: left;
}

​.block2 {
    width:100px;
    border:1px solid;
} 
```

为什么 block2 必须要有`float:left;`才能位于 block1 的右侧？block1 (float:left) 的属性还不够吗？

[提琴手](http://jsfiddle.net/MrNYR/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-03T12:26:20.080

`block2`默认情况下显示为块级元素，这意味着它占据了一整行。

它不一定必须`float:left`出现在 ; 的右侧`block1`。如果通过`display:inline`, 或将其显示为内联级元素`display:inline-block`，它将出现在其兄弟元素旁边。

[http://jsfiddle.net/8GF4B/1/](http://jsfiddle.net/8GF4B/1/)

为了更详细地解释它，让我们假设您已经`float:left`开始`block2`：

```
.block1 {
    width:100px;
    border:1px solid;
}

​.block2 {
    width:100px;
    border:1px solid;
    float: left;
} 
```

将发生的第一件事是 block2 将被定位在它通常定位的位置。让我们找出在哪里。

*   block1 显示为块级元素
*   块级元素呈现为好像它们在元素之前和之后都有换行符
*   因此，block2 默认显示在第二行

现在 block2 被从正常流中取出，并尽可能向左移动......但它已经靠左边缘了！这导致块 2 显示在块 1 下方。

在这里查看内联元素和块级元素之间区别的一个很好的解释：[https ://developer.mozilla.org/en-US/docs/HTML/Block-level_elements](https://developer.mozilla.org/en-US/docs/HTML/Block-level_elements)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T12:28:16.113

`<div>`element 是块级元素，这意味着它将位于单独的行上，因此您需要它`float`，`block2`因为它是一个`div`元素。

# algorithm - 通过抛硬币创建随机数生成器

> ID：13209162
> 
> 赞同：18
> 
> 时间：2012-11-03T12:25:26.347
> 
> 标签：algorithm, random

昨天我有一个面试问题，我无法完全回答：

给定一个`f() = 0 or 1`具有完美 1:1 分布的函数，创建一个`f(n) = 0, 1, 2, ..., n-1`每个概率为 1/n的函数

如果 n 是 2 的自然幂，我可以提出一个解决方案，即用于`f()`生成`k=ln_2 n`. 但这显然不适用于例如 n=5，因为这会产生`f(5) = 5,6,7`我们不想要的结果。

有谁知道解决方案？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-11-03T12:30:13.660

`n`您可以为比您描述的更大的 2 的最小幂构建一个 rng 。然后，每当这个算法生成一个大于 的数字时`n-1`，就把那个数字扔掉，然后再试一次。这称为拒绝方法。

**添加**

该算法是

```
Let m = 2^k >= n where k is is as small as possible.
do
   Let r = random number in 0 .. m-1 generated by k coin flips
while r >= n
return r 
```

此循环最多`i`迭代停止的概率为`1 - (1/2)^i`。这非常迅速地变为 1：循环在 30 次迭代后仍在运行，概率小于十亿分之一。

您可以使用稍微修改的算法来减少预期的迭代次数：

```
Choose p >= 1
Let m = 2^k >= p n where k is is as small as possible.
do
   Let r = random number in 0 .. m-1 generated by k coin flips
while r >= p n
return floor(r / p) 
```

例如，如果我们尝试使用更简单的算法生成 0 .. 4 (n = 5)，我们将拒绝 5、6 和 7，这是结果的 3/8。使用`p = 3`（例如）, `pn = 15`，我们将有 m = 16 并且将仅拒绝 15 或 1/16 的结果。价格需要四次硬币翻转而不是 3 次和一次除法运算。您可以根据需要继续增加`p`和添加硬币翻转以减少拒绝。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-05-30T00:34:29.890

另一个有趣的解决方案可以通过马尔可夫链蒙特卡罗技术，Metropolis-Hastings 算法得出。如果需要大量样本，这将显着提高效率，但它只会接近极限内的均匀分布。

```
 initialize: x[0] arbitrarily    
 for i=1,2,...,N
  if (f() == 1) x[i] = (x[i-1]++) % n
  else x[i] = (x[i-1]-- + n) % n 
```

对于较大的 N，向量 x 将包含 0 和 n 之间的均匀分布数。此外，通过添加接受/拒绝步骤，我们可以模拟任意分布，但您需要在 [0,1] 上模拟均匀随机数作为子过程。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-12-10T04:44:40.753

```
def gen(a, b):
  min_possible = a
  max_possible = b

  while True:
    floor_min_possible = floor(min_possible)
    floor_max_possible = floor(max_possible)
    if max_possible.is_integer():
      floor_max_possible -= 1

    if floor_max_possible == floor_min_possible:
      return floor_max_possible

    mid = (min_possible + max_possible)/2
    if coin_flip():
      min_possible = mid
    else:
      max_possible = mid 
```

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2018-06-30T04:57:04.157

```
My #RandomNumberGenerator #RNG

/w any f(x) that gives rand ints from 1 to x,  we can get rand ints from 1 to k, for any k:

get ints p & q, so p^q is smallest possible, while p is a factor of x, & p^q >= k;

Lbl A
i=0 & s=1; while i < q {
s+= ((f(x) mod p) - 1) * p^i;
i++;
}
if s > k,  goto A, else return s

//** about notation/terms:
rand = random
int = integer
mod is (from) modulo arithmetic 
Lbl is a “Label”, from the Basic language, & serves as a coordinates for executing code.  After the while loop, if s > k, then “goto A” means return to the point of code where it says “Lbl A”, & resume.  If you return to Lbl A & process the code again, it resets the values of i to 0 & s to 1\.  
i is an iterator for powers of p, & s is a sum.  
"s+= foo" means "let s now equal what it used to be + foo".
"i++" means "let i now equal what it used to be + 1".
f(x) returns random integers from 1 to x. **//

I figured out/invented/solved it on my own, around 2008\.  The method is discussed as common knowledge here.  Does anyone know since when the random number generator rejection method has been common knowledge?  RSVP. 
```

# sql - PL/SQL : 遇到符号“END”

> ID：13209175
> 
> 赞同：3
> 
> 时间：2012-11-03T12:27:07.477
> 
> 标签：sql, oracle, stored-procedures, plsql, sqlplus

即使我仔细检查了代码，我也会收到以下错误。我不知道我错过了什么。

LINE/COL 错误

* * *

31/1 PLS-00103：在预期以下情况之一时遇到符号“END”：

代码：

```
CREATE OR REPLACE PROCEDURE sp_ssjm_newworkorder
(   workorderno IN NUMBER,
company     IN CHAR,
attention   IN CHAR,
datedue     IN DATE,
loggedby    IN CHAR
)

AS  id     NUMBER;
today         DATE:=SYSDATE;
BEGIN
SELECT  client_id   --grab client_id
INTO id 
FROM    ssjm_client
WHERE ssjm_client.name=company;

IF id IS NULL THEN  --check if client exists by checking if client_id is there
    dbms_output.put_line('Please create client first');
    GOTO the_end;
ELSE
    INSERT INTO ssjm_workorder      VALUES(workorderno,workorderno,company,loggedby,attention,'Received',today,datedue,id);
END IF;

EXCEPTION
    WHEN OTHERS THEN
    raise_application_error(-20999,'An error occured in' ||
        SQLCODE || '-ERROR-' || SQLERRM);

<<the_end>>

END sp_ssjm_newworkorder; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-03T12:40:56.677

您的代码中有几个地方需要注意：

1.  您出现该错误的原因是标签 `<<the_end>>`应该放在该`EXCEPTION`部分之前。
2.  标签后需要操作符。因此，如果您想跳转到存储过程的末尾并且不需要其他操作，`NULL`则应使用运算符。

为此，您的代码应如下所示：

```
IF id IS NULL THEN  --check if client exists by checking if client_id is there
    dbms_output.put_line('Please create client first');
    GOTO the_end;
ELSE
    INSERT INTO ssjm_workorder
 VALUES(workorderno,workorderno,company,loggedby
       ,attention,'Received',today,datedue,id);
END IF;

<<the_end>>
NULL;

EXCEPTION
    WHEN OTHERS THEN
    raise_application_error(-20999,'An error occured in' ||
        SQLCODE || '-ERROR-' || SQLERRM);
END sp_ssjm_newworkorder; 
```

一定要尽量避免无条件分支。使用`GOTO`运算符是非常非常不好的做法。它扼杀了可读性，这样的代码很难调试。这会让你和所有在你之后看那个代码的人都头疼。此外，如果查询

```
SELECT  client_id   --grab client_id
INTO id 
FROM    ssjm_client
WHERE ssjm_client.name=company; 
```

不返回任何行，`NO_DATA_FOUND`将立即引发异常并暂停代码的执行。所以`IF id IS NULL THEN`永远不会评估条件。您可以通过删除该条件并在代码部分添加`NO_DATA_FOUND`异常处理程序来重写您的代码。`EXCEPTION`当然，正如@Rob van Wijk 在评论中正确指出的那样

> 但代码可以进一步清理。today 变量可以被删除，而 WHEN OTHERS 绝对应该被删除。就像现在一样，它只是将错误转换为更长的错误消息，没有更多细节，最重要的是：它掩盖了发生真正错误的行号。

不需要`today`变量，`SYSDATE`可以直接在语句的`values`子句中使用`insert`，`WHEN OTHERS`也可以去掉。

```
CREATE OR REPLACE PROCEDURE sp_ssjm_newworkorder
(
workorderno IN NUMBER,
company     IN CHAR,
attention   IN CHAR,
datedue     IN DATE,
loggedby    IN CHAR
)
AS  
  id     NUMBER;
BEGIN
  SELECT client_id   --grab client_id
    INTO id
    FROM ssjm_client
   WHERE ssjm_client.name=company;

    INSERT INTO ssjm_workorder      
      VALUES(workorderno,workorderno,company,loggedby
            ,attention,'Received',SYSDATE,datedue,id);

EXCEPTION
    when NO_DATA_FOUND
    then dbms_output.put_line('Please create client first');
END sp_ssjm_newworkorder; 
```

# objective-c - NSDocumentDirectory 给出奇怪的目录作为输出

> ID：13209178
> 
> 赞同：1
> 
> 时间：2012-11-03T12:28:06.087
> 
> 标签：objective-c, sqlite, fmdb

我正在尝试从我的文档目录中打开 sqlite 数据库：

```
NSString *docDir = [NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES) objectAtIndex:0];
NSString *dbFileName = [docDir stringByAppendingPathComponent:@"DatabaseName.sqlite"];

self.db = [FMDatabase databaseWithPath:dbFileName];

self.db.logsErrors = YES;

self.db = _db;
if ([self.db open]) {
    NSLog(@"database opened");

}
NSLog(@"docDir = %@",[NSString stringWithFormat:@"%@%@",docDir,dbFileName]); 
```

NSLog 显示奇怪的路径`docDir`=`/Users/userName/Documents/Users/userName/Documents/DatabaseName.sqlite`而不是`/Users/userName/Documents/DatabaseName.sqlite`. 打开时没有错误或警告。

在此之后，我尝试从我的表中获取 count(*)

```
NSString *queryString = [NSString stringWithFormat:@"SELECT count(*) FROM histories"];
FMResultSet *result = [self.db executeQuery:queryString];
NSLog(@"count = %i", [result intForColumnIndex:0]); 
```

当 10k 行时数据库有更多，但 NSLog 显示为 0。应用程序不适用于 iOS，仅适用于命令行。我在哪里可以找到问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T12:39:54.173

你有

```
docDir = /Users/userName/Documents
dbFileName = /Users/userName/Documents/DatabaseName.sqlite 
```

因此在

```
NSLog(@"docDir = %@",[NSString stringWithFormat:@"%@%@",docDir,dbFileName]); 
```

the`docDir`被打印两次（`dbFileName`已经包含`docDir`）。

*备注：*该声明`self.db = _db;`看起来很可疑，您可能需要删除它。

**补充：** FMDB 文档指出：

> 在尝试访问查询中返回的值之前，您必须始终调用`-[FMResultSet next]`，即使您只期望一个。

所以你的代码可能应该是这样的：

```
FMResultSet *result = [self.db executeQuery:queryString];
if ([result next]) {
    NSLog(@"count = %i", [result intForColumnIndex:0]);
} 
```

# php - 每次按下按钮时变量增加一个（PHP）

> ID：13209181
> 
> 赞同：1
> 
> 时间：2012-11-03T12:28:11.333
> 
> 标签：php

我希望`$order`每次按下提交按钮时变量都会增加 1。

（页面名称是 study.php，所以每次我按下按钮都会刷新页面）：

```
 <?php 
 $order = $_GET['number']; 

 echo "<form action='study.php' method='GET'>
   <input type='hidden' name='number' value='$order++' />
   <input class='big_b' type='submit'  value='next' /> 
 </form>";

 echo "$order";
 ?> 
```

第一次 1 按下按钮 $order 是 1，第二次是 2，第三次是 3 ... 等等

谢谢你的帮助！

编辑：已解决

```
 <?php 
 session_start();
 if(empty($_SESSION['count'])) $_SESSION['count'] = 0;
 $order =  $_SESSION['count']+1;
 $_SESSION['count'] =  $order; 

 echo "<form action='study.php' method='GET'>
        <input class='big_b' type='submit'  value='next' /> 
    </form>";

 echo "$order";
 ?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T13:26:50.827

您目前如何拥有它，无论是否单击按钮，它都会在每次页面刷新时递增，您是否只需要在按下按钮时递增？

```
<?php
session_start();

// Reset to 1
if(isset($_POST['reset'])){unset($_SESSION['number']);}

// Set or increment session number only if button is clicked.
if(empty($_SESSION['number'])){
    $_SESSION['number']=1;
}elseif(isset($_POST['next'])){
    $_SESSION['number']++;
}

echo '
<form action="" method="POST">
   <input class="big_b" type="submit" name="next" value="Next" /> 
   <input type="submit" name="reset" value="Reset" /> 
</form>';

echo $_SESSION['number'];
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T12:30:51.400

您需要放在`$order++`引号之外进行操作（以 1 递增）。这是代码：

```
<?php 
 $order = $_GET['number']; 

 echo "<form action='study.php' method='GET'>
   <input type='hidden' name='number' value='".$order++."' />
   <input class='big_b' type='submit'  value='next' /> 
 </form>";

 echo "$order";
 ?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-03T12:44:56.367

```
<?php
session_start();
if(empty($_SESSION['order'])){

    $_SESSION['order'] = 1; 
}

 echo "<form action='study.php' method='GET'>
   <input type='hidden' name='number' value='".$_SESSION['order']++."' />
   <input class='big_b' type='submit'  value='next' /> 
 </form>";

 echo $_SESSION['order'];

?> 
```

# xcode - 如何使第二个 tabbarItem 在 iPhone 中被选为默认值？

> ID：13209183
> 
> 赞同：0
> 
> 时间：2012-11-03T12:28:15.753
> 
> 标签：xcode, uitabbarcontroller

我以编程方式添加了一个 UITabBarController（搜索，登录），我想设置第二个 tabbaritem（登录），并在登录凭据不正确时选择它的视图。但我无法这样做..不明白我在哪里出错了..？

```
 Search *first = [[Search alloc] initWithNibName:@"Search" bundle:nil];
    first.title=@"Search";
    Login *second=[[Login alloc]initWithNibName:@"Login" bundle:nil];
    second.title=@"Login";
    NSArray *viewArray= [NSArray arrayWithObjects:first,second, nil];
    tabBarController=[[UITabBarController alloc] init];
    [tabBarController setViewControllers:viewArray animated:NO]; 
    [tabBarController setSelectedIndex:2]; 
    [self presentModalViewController:tabBarController animated:NO]; 
```

但是在这里我的 SearchViewController 被选中并显示为默认值......我哪里出错了......？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T13:00:44.383

错误在这一行：

```
[tabBarController setSelectedIndex:2]; 
```

计数不是从 1 开始，而是从 0 开始，因此在您的情况下，您必须将其更改为：

```
[tabBarController setSelectedIndex:1]; 
```

# python - 基本列表理解

> ID：13209186
> 
> 赞同：0
> 
> 时间：2012-11-03T12:28:37.100
> 
> 标签：python

我正在尝试做一些基本的列表理解，例如...

```
abc = [1, 11, 123, 124, 1234, 1234, 2323124, 12, 1354, 235, 2345]
[ str(x) for x in abc if "1" in x ] 
```

谁能指出我正确的方向？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-03T12:29:38.240

像这样？：

```
[str(x) for x in abc if "1" in str(x)] 
```

当然，这会将每个数字转换为字符串两次，因此执行以下操作会更有效：

```
[x for x in map(str, abc) if "1" in x] 
```

# magento - 在 Magento 中添加 .js

> ID：13209187
> 
> 赞同：0
> 
> 时间：2012-11-03T12:28:52.887
> 
> 标签：magento, magento-1.7

我正在尝试将自己的 .js 添加到 Magento 项目中，但我做不到...

我已经按照 [这里](http://css-tricks.com/using-jquery-in-magneto/)的步骤操作了，但我仍然做不到。

我做了以下事情：

1.  **前端：**打开**page.xml**并在块内：**block type="page/html_head" name="head" as="head"**，我包含了我的 .js 文件：**lib/query.js**。
2.  **后端：**我修改了**main.xml**就像[这里](http://www.magentocommerce.com/boards/viewthread/268482/)说的那样，我将 .js 添加到名为*head*的块中。

但什么也没有发生。javascript 似乎无法正常工作。关于为什么或我需要遵循的任何步骤的任何想法？

我**编辑问题**是因为我发现**了一个不同的问题......**：

我按照答案中的建议做了一切。它没有用。但我认为这是因为剧本。

当我去火的时候，我看到了这些错误，我不知道它们是不是一开始的：

![错误](../Images/4c7f27105fa564c44ef45e112dd84496.png)

第一个错误位于**head.phtml**，当我拨打电话时：

```
<script type="text/javascript">
    $jQuery.noConflict();
</script> 
```

第二个和第三个位于我的 .js 文件的开头...

任何想法？也许解决这个问题，将解决我的其他问题......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T12:51:37.223

1）你是否删除了缓存和会话？： http: [//kb.siteground.com/article/How_to_clear_the_cache_in_Magento.html](http://kb.siteground.com/article/How_to_clear_the_cache_in_Magento.html)

2) 在您的网络浏览器中仔细检查页面来源。该文件可能已经正确包含，但可能是您的 javascript 文件本身就是问题所在。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-03T12:57:21.417

在 'block type="page/html_head" ' 内插入以下行

```
<action method="addJs"><script>lib/query.js</script></action> 
```

还将您的 query.js 文件放在“magento-root-direcory/js/lib/query.js”位置。当然，还要重新索引并删除您的缓存。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-03T13:32:49.923

jQuery：为 jQuery 创建一个不同的别名以在脚本的其余部分中使用。

```
 var $j = jQuery.noConflict();
 // Do something with jQuery
 $j("div p").hide();
 //then use magento prototype with
 $("content").style.display = 'none'; 
```

查看更多[http://api.jquery.com/jQuery.noConflict/](http://api.jquery.com/jQuery.noConflict/)

因为看起来您正在向管理员和前端添加相同的文件。将您的文件放入（根文件夹）/js/query.js（不是/lib/query.js）

将此添加到 page.xml

```
 <block type="page/html_head" name="head" as="head">
        <action method="addJs"><script>query.js</script></action>
        .... 
```

将此添加到 main.xml

```
<default>
    <block type="adminhtml/page" name="root" output="toHtml" template="page.phtml">
       <block type="adminhtml/page_head" name="head" as="head" template="page/head.phtml">
        <action method="addJs"><script>query.js</script></action>
        .... 
```

对核心文件进行更改不是一个明智的主意。查看管理文件的解决方法 [http://www.magentocommerce.com/boards/viewthread/17306/](http://www.magentocommerce.com/boards/viewthread/17306/)

# facebook - Facebook Connect - 将会话 ID 从 WebView 传输到应用程序回服务器

> ID：13209193
> 
> 赞同：2
> 
> 时间：2012-11-03T12:29:44.367
> 
> 标签：facebook, session, cookies, session-cookies

我的应用程序使用 Facebook 连接服务器端登录（使用 o-auth）。这意味着用户授权服务器代表他执行操作。

一旦服务器从 Facebook 接收到 TOKEN，它就会在用户请求上设置一个“SESSIONID”属性。

在客户端，我使用 WebView 实现了这一点，即当用户第一次打开应用程序时，有一个带有 facebook 连接按钮的 webview，当它点击按钮时，他将转到我的服务器，重定向到 facebook并启动整个服务器端登录链。

1.  将会话 ID 从 WebView 移动到其他控制器的最佳方法是什么？
2.  最好的存储方式在哪里（Android/iPhone）
3.  我应该如何在每个请求上附加这个 SESSION ID？每次向服务器发送请求时是否需要添加新标头？（由于会话是在 WebView“浏览器”上设置的，然后移动到本机客户端，我假设会话已关闭。对吗？）

# android - 在 ImageView 上绘制多个图层

> ID：13209195
> 
> 赞同：1
> 
> 时间：2012-11-03T12:29:49.217
> 
> 标签：android, android-canvas, android-imageview

我正在尝试按照 Android 开发人员网站的说明进行操作，但我一定是做错了什么。

我尝试创建自定义 ImageView 并在其上绘制 2 个位图。

**活动**

```
public class TestActivity extends Activity {    

    @Override
    protected void onCreate(Bundle savedInstanceState) {    
        super.onCreate(savedInstanceState);
        setContentView(R.layout.test_layout);       
        LinearLayout left = (LinearLayout) findViewById(R.id.container);

        ModuleImageView iv = new ModuleImageView(this);
        left.addView(iv);
        iv.invalidate();
    }
} 
```

**图像视图**

```
public class ModuleImageView extends ImageView{ 

    public ModuleImageView(Context context) {
        super(context); 

    }

    @Override
    protected void onDraw(Canvas canvas) {
        Bitmap b1 = BitmapFactory.decodeResource(getResources(), R.drawable.main_engine);
        Bitmap b2 = BitmapFactory.decodeResource(getResources(), R.drawable.energy);
        canvas.drawBitmap(b1, 0, 0, null);
        canvas.drawBitmap(b2, 5, 5, null);

        super.onDraw(canvas);
    }
} 
```

屏幕上没有任何显示，这可能是因为 onDraw 方法从未执行过。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T12:57:50.103

改用[LayerDrawable](http://developer.android.com/reference/android/graphics/drawable/LayerDrawable.html)。构造它并传递给普通的 ImageView

# html - 带角度的 div 在 FF 16 中无法正常工作

> ID：13209197
> 
> 赞同：0
> 
> 时间：2012-11-03T12:30:22.677
> 
> 标签：html, css

我用 45 度角测试了这个div 的[例子](http://codepen.io/JosephSilber/pen/bFfqn)。

这是我想要得到的最终结果：

![在此处输入图像描述](../Images/d86f0c8e22291040f39a1c90cf53d1e8.png)

这是我在浏览器中得到的结果：

![在此处输入图像描述](../Images/f6c4ab3eda522230558d27aed0c4abc9.png)

在 IE 中，我只得到没有绿色背景的测试。我该如何解决这个问题？我使用 FF 16.0.2

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T12:41:52.553

这是给你的修复（注意它不包括 IE 对渐变背景的修复）：

```
h1:after {
    content: '';
    background: linear-gradient(top left, #5FA309, #3B8018);
    background: -webkit-gradient(linear, left top, left bottom, from(#5FA309), to(#3B8018));
    background: -moz-linear-gradient(top left,  #5FA309,  #3B8018);
    position: absolute;
    top: 5px; right: -11px;
    width: 21px;
    height: 21px;
    transform: rotate(45deg);
} 
```

# android - 如何创建确切数量的 textview 并将它们放入 tableview？

> ID：13209199
> 
> 赞同：0
> 
> 时间：2012-11-03T12:30:33.613
> 
> 标签：android, textview, android-linearlayout, tablelayout

我有这个代码

```
public class MainActivity extends Activity {

    TextView textview;
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

    String hallo = "blabla " + "jojo " + "lol " + "\n" + "doj " + "drasl " + "\n"; 
    InputStream is = new ByteArrayInputStream(hallo.getBytes());
    BufferedReader in = new BufferedReader(new InputStreamReader(is));
    LinearLayout linearLayout = (LinearLayout) findViewById(R.id.linearLayout);

    String line;
    try {
        while ((line = in.readLine()) != null) {
            String[] RowData = line.split(" ");
            String eitt = RowData[0];
            String tvo = RowData[1];

            TextView textView = new TextView(this);
            textView.setText(line);

            linearLayout.addView(textView);
        }
    } catch (IOException e1) {
        e1.printStackTrace();
    }
}
} 
```

使用这个 xml 布局

```
<ScrollView xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:id="@+id/scrollView"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" >

    <LinearLayout
        android:id="@+id/linearLayout"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:orientation="vertical" >

        </LinearLayout>

</ScrollView> 
```

我想将字符串的这些部分插入到表格布局中，这样当我的文本被打印出来时，它们就会出现在漂亮的列中。这种工作方式，它只是逐行打印字符串，而不是将其放入列中。知道我不知道字符串中有多少行也很重要，所以我不能只制作 4 个 textview 框，因为可能有 50 og 一百行，所以我需要制作一个 i表格视图中文本视图框的数量，其中 i 是行数

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T12:37:34.600

尝试`setLayoutParams`添加`TextView`：

```
//Your code...
String line;
    try {
        while ((line = in.readLine()) != null) {
            String[] RowData = line.split(" ");
            String eitt = RowData[0];
            String tvo = RowData[1];

            TextView textView = new TextView(this);
            textView.setText(line);
            textView.setLayoutParams(new LayoutParams(LayoutParams.FILL_PARENT
           ,LayoutParams.WRAP_CONTENT));
            linearLayout.addView(textView);
        }
    } catch (IOException e1) {
        e1.printStackTrace();
    }

//Your code... 
```

# javascript - watch for dom element creation?

> ID：13209206
> 
> 赞同：2
> 
> 时间：2012-11-03T12:31:11.087
> 
> 标签：javascript, jquery, jquery-ui, dom

So, basically I have a plugin that I want called on an element if it is created in the dom,

E.g. let's say I have a plugin called domWatch that runs the function if the specified selector gets created inside the selector it was called on.

so:

```
$('#container').domWatch('.mySelector', function(element){
    $(element).myPlugin();
});

$('#container').append($('<div />', {class: 'mySelector'})); //the new element should now have the myPlugin plugin called on it. 
```

Is this possible to do?

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2014-03-31T19:51:58.923

您可以使用我为完全相同的目的开发的[到达.js库（在内部使用](https://github.com/uzairfarooq/arrive/)[Mutation Observers](https://developer.mozilla.org/en/docs/Web/API/MutationObserver)）。用法：

```
$('#container').arrive('.mySelector', function(){
    $(this).myPlugin();
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-03T12:47:12.157

看看这个聪明的黑客：[http](http://www.backalleycoder.com/2012/04/25/i-want-a-damnodeinserted/) ://www.backalleycoder.com/2012/04/25/i-want-a-damnodeinserted/ 。它使用 CSS3 动画来检测元素何时插入 DOM。

“侦听何时创建 DOM 元素”的问题是对性能的影响，因此也许您应该考虑使用不同的方法来解决您的问题。

我相信有很多更简单的方法可以实现您的目标。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-03T12:41:27.260

听起来很像[Live Query。](http://docs.jquery.com/Plugins/livequery)尽管这确实涉及连续轮询，但确实会影响性能。

这里有一些[演示](http://brandonaaron.net/code/livequery/demos)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-03T12:48:09.807

如果您只针对非常现代的浏览器，您可以查看专为该目标设计的*MutationObserver 。*

[https://developer.mozilla.org/en-US/docs/DOM/MutationObserver](https://developer.mozilla.org/en-US/docs/DOM/MutationObserver)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-08T09:42:22.117

它看起来像是[事件](http://api.jquery.com/on/)[委托形式的`.on()`](http://api.jquery.com/on/)工作：

> 委托事件的优点是它们可以处理来自 以后添加到文档的*后代元素的事件。*通过选择在附加委托事件处理程序时保证存在的元素，您可以使用委托事件来避免频繁附加和删除事件处理程序的需要。例如，此元素可以是模型-视图-控制器设计中视图的容器元素，或者`document`如果事件处理程序想要监视文档中的所有冒泡事件。在加载任何其他 HTML 之前，该 `document`元素在文档的头部可用，因此在此处附加事件是安全的，而无需等待文档准备好。

# opengl - Rendering texture to simple shape using QGLSceneNode

> ID：13209207
> 
> 赞同：2
> 
> 时间：2012-11-03T12:31:15.013
> 
> 标签：opengl, colors, textures, qt3d

I am attempting to render a texture to a simple shape using QBuilder and QGeometryData but I can not get the texture to display, what am I doing wrong?

I have created a QGLSceneNode which builds the texture and attempts to use generateTextureCoordinates to map the texture coordinates.

**EDIT** Mapping the texture coordinates by hand seems to work, but generateTextureCoordinates should work.

[My class is a child of QGLView]

```
vtkQtViewer::vtkQtViewer(QWidget *parent) :
QGLView(parent), scene(new QGLSceneNode(this))
{
// in the constructor construct a builder on the stack
QGLBuilder builder;
QGeometryData triangle;
QVector3D a(2, 2, 0);
QVector3D b(-2, 2, 0);
QVector3D c(2, -2, 0);
QVector3D d(-2, -2, 0);
triangle.appendVertex(a,b,c);
triangle.appendVertex(b,d,c);
triangle.generateTextureCoordinates();

// When adding geometry,
//QGLBuilder automatically creates lighting normals
builder << triangle;

// obtain the scene from the builder
QGLSceneNode* can = builder.finalizedSceneNode();

// apply effects at app initialization time
QGLMaterial *mat = new QGLMaterial;
mat->setDiffuseColor(Qt::red);
QUrl url;
url.setPath(QLatin1String("qtlogo.png"));
url.setScheme(QLatin1String("file"));
mat->setTextureUrl(url);
can->setMaterial(mat);

scene->addNode(can);
}

vtkQtViewer::~vtkQtViewer()
{
   delete scene;
}

void vtkQtViewer::initializeGL(QGLPainter *painter)
{
  painter->setStandardEffect(QGL::LitDecalTexture2D);
}

void vtkQtViewer::paintGL(QGLPainter *painter)
{
  scene->draw(painter);
}} 
```

# django - python sqlite use in terminal -django

> ID：13209209
> 
> 赞同：15
> 
> 时间：2012-11-03T12:31:32.583
> 
> 标签：django, ubuntu, sqlite

How can I see my databases in SQlite for Django.

I am following the [django tutorial](https://docs.djangoproject.com/en/dev/intro/tutorial01/) on ubuntu.

Now its working fine except. After running

```
python manage.py sql polls 
```

then

```
python manage.py syncdb 
```

So then I thought I would check out the daabase and tables but this is where the issue is:

```
sqlite> .databases
seq  name             file                                                      
---  ---------------  ----------------------------------------------------------
0    main                                                                       
1    temp 
```

There is no mysite database. How can i see the database?

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-11-03T13:04:57.363

您的`mysite`数据库将位于项目根目录中的文件系统本身（django 项目的最顶层文件夹），如果这是您的`settings.py`样子：-

```
DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.sqlite3', # Add 'postgresql_psycopg2', 'mysql', 'sqlite3' or 'oracle'.
        'NAME': 'mysite',                      # Or path to database file if using sqlite3.
        'USER': '',                      # Not used with sqlite3.
        'PASSWORD': '',                  # Not used with sqlite3.
        'HOST': '',                      # Set to empty string for localhost. Not used with sqlite3.
        'PORT': '',                      # Set to empty string for default. Not used with sqlite3.
    }
} 
```

如果您启用了 django 管理员，并为您的投票应用程序编写了适当的 admin.py 文件，您应该能够在 django 管理员中添加、编辑、删除或查看您的投票数据。

您当然可以`mysite`在您的 django 项目根目录（顶层文件夹）中加载您的数据库，并使用类似[http://sqlitebrowser.sourceforge.net/的方式查看其中的数据](http://sqlitebrowser.sourceforge.net/)

在 ubuntu 终端的命令行中，如果您确实正确执行了 syncdb，您应该会看到类似于以下内容：-

```
calvin$ ./manage.py syncdb
Creating tables ...
Creating table auth_permission
Creating table auth_group_permissions
Creating table auth_group
Creating table auth_user_user_permissions
Creating table auth_user_groups
Creating table auth_user
Creating table django_content_type
Creating table django_session
Creating table django_site

You just installed Django's auth system, which means you don't have any superusers defined.
Would you like to create one now? (yes/no): yes
Username (leave blank to use 'calvin'): calvin
E-mail address: myemail@myemail.com
Password: 
Password (again): 
Superuser created successfully.
Installing custom SQL ...
Installing indexes ...
Installed 0 object(s) from 0 fixture(s) 
```

你提到你已经`./manage.py syncdb`正确运行你的，所以你应该能够通过执行访问你的 sqlite 数据库`sqlite mysite`，如下所示： -

```
calvin$ sqlite3 mysite 
SQLite version 3.7.14.1 2012-10-04 19:37:12
Enter ".help" for instructions
Enter SQL statements terminated with a ";"
sqlite> 
```

您的 sqlite shell 中的`.tables`命令将为您提供：-

```
sqlite> .tables
auth_group                  auth_user_user_permissions
auth_group_permissions      django_content_type       
auth_permission             django_session            
auth_user                   django_site               
auth_user_groups          
sqlite> 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2016-06-24T05:51:39.583

如果已经同步，我已经使用了选项“dbshel​​l”：

`python manage.py dbshell`

SQLite 版本 3.8.2 2013-12-06 14:53:30 输入“.help”获取说明 输入以“;”结尾的 SQL 语句

`sqlite> .databases`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-10-25T11:29:02.647

只需转到您的项目文件夹，那里有 ds.sqlite3 文件

[从https://sqlitebrowser.org/](https://sqlitebrowser.org/)在工具中打开它

内部工具 > 浏览数据 > 在下拉列表中选择表格以查看表格

# javascript - 如何使用 JavaScript / jQuery 调整图像大小而不像浏览器那样像素化？

> ID：13209213
> 
> 赞同：5
> 
> 时间：2012-11-03T12:31:57.267
> 
> 标签：javascript, jquery, google-chrome, pixels, image-scaling

我正在为网页制作一个 javascript / jquery 程序，让用户从他们的计算机本地打开图像文件，然后程序将其调整为 16 x 16 图标大小并将其保存为数据 url。

一切正常，除了调整大小的图像非常像素化。我目前正在获取本地图像文件，并从中制作数据 url。然后创建一个 16 x 16 的画布元素，然后将图像绘制到画布上，并从中创建一个新的数据 URL。

我想要一些不同的方法来做到这一点，因为新调整大小的图像非常像素化且不平滑，并且似乎没有抗锯齿。当浏览器显示宽度和高度属性设置为 16 的原始图像时，它看起来非常漂亮和流畅。这就是我想要的。我不明白如何获得与浏览器执行时显示的结果相同的结果。我正在使用谷歌浏览器。

我在这里做了一个小例子：http: [//jsfiddle.net/5Pj8m/](http://jsfiddle.net/5Pj8m/)

在示例中，我使用了 jsFiddle 徽标，尽管您可以使用任何本地文件对其进行测试，并查看结果。也许这段代码可以帮助其他人学习如何做到这一点，但是，我认为生成的调整大小图像可能或应该看起来更好！

我希望我已经解释了我正在尝试做的事情，并且这在某种程度上是可能的。任何人都可以帮助我或解决这个问题吗？

这是代码。

HTML：

```
<input type='file' id='inputFile'>
<table border=1><tr><td>
<span id='spanDisplayOrigFull'>OrigFull:
<img src=http://doc.jsfiddle.net/_images/jsfiddle-logo-thumb.png>
</span>
</td><td>
<span id='spanDisplayOrigIcon'>OrigIcon:
<img src=http://doc.jsfiddle.net/_images/jsfiddle-logo-thumb.png width='16' height='16'>
</span>
</td></tr><tr><td>
<span id='spanDisplayNewFull'>NewFull: </span>
</td><td>
<span id='spanDisplayNewIcon'>NewIcon: </span>
</td></tr></table> 
```

JAVASCRIPT：

```
$('#inputFile').bind('change', function()
{

var file = inputFile.files[0];

var reader = new FileReader();
reader.readAsDataURL(file);

reader.onload = function()
{

var imageUrlFull = reader.result;

var imageLocalFull = new Image();
imageLocalFull.src = imageUrlFull;
imageLocalFull.id = 'imageLocalFull';

imageLocalFull.onload = function()
{

var canvas = document.createElement('canvas');
canvas.width = 16; canvas.height = 16;

var context = canvas.getContext('2d');
context.drawImage(imageLocalFull, 0, 0, 16, 16);

var imageUrlIcon = canvas.toDataURL(file.type);

var imageLocalIcon = new Image();
imageLocalIcon.src = imageUrlIcon;
imageLocalIcon.id = 'imageLocalIcon';

imageLocalIcon.onload = function()
{

spanDisplayNewFull.appendChild(imageLocalFull);
spanDisplayNewIcon.appendChild(imageLocalIcon);

};

};

};

}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-03T13:33:07.257

您可以使用 timthumb 脚本之类的 php 基础进行扩展。所以基本的想法是使用 js 检测浏览器或 div 或任何更改或调整大小。然后触发 php 脚本来调整图像大小。script.setAttribute('src', 'remote.php?value=my message'); remote.php 你有你的 php 代码。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-03T13:20:27.363

好吧，从您的代码看来，图像缩放工作实际上是留给您的浏览器实现的，所以我认为您将使用不同的浏览器获得不同的结果。有些可能会平滑它，有些可能不会。

我看到了两种尝试解决这个问题的方法。一种方法是使用活动内容，例如 Java 小程序/Flash，或者使用实际的后端来进行缩放。即，您收到文件，将其发送到服务器，然后服务器返回按比例缩小的图像，就像大多数图像缩放站点一样。

第二种方法是尝试 HTML5 并自己实现一个缩减算法。我能做的最好的指导就是把你指向[这个](http://www.html5canvastutorials.com/advanced/html5-canvas-transform-scale-tutorial/)，[这个](http://www.html5canvastutorials.com/advanced/html5-canvas-get-image-data-tutorial/)作为起点。

对不起，如果这没有帮助。

# javascript - document.location.href 在 Chrome 浏览器中不起作用

> ID：13209214
> 
> 赞同：1
> 
> 时间：2012-11-03T12:32:00.303
> 
> 标签：javascript, google-chrome, internet-explorer-9, location, href

命令：

```
document.location.href="www.google.com" 
```

不会更改 google chrome 浏览器中的当前网页。该命令会在 IE9 浏览器中传输页面。

为什么此命令适用于 IE9 而不适用于 chrome？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-03T12:33:29.383

您需要添加协议：

```
document.location.href="http://www.google.com"; 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-11-05T05:50:24.460

另一种解决方案是在之前添加此行`document.location.href`

```
window.event.returnValue = false; 
```

来源：[document.location 不改变IE9中的网页？](https://stackoverflow.com/questions/8245547/document-location-not-working-in-ie9)

# bash - /bin/sh does not drop privileges

> ID：13209215
> 
> 赞同：0
> 
> 时间：2012-11-03T12:32:01.833
> 
> 标签：bash, symlink, privileges, setuid

Hello stackoverflow guys,

I have written a C program that simply invokes a bash shell using system("/bin/bash")

If i enable the setuid permission bit and execute the program, the invoked shell does not have euid set to 0\. This is ok, because we know that bash shell drop privileges.

BUT if i change /bin/sh to point to /bin/bash using sudo ln -s /bin/bash /bin/sh

and then execute system with /bin/sh as an argument then the new invoked shell has euid=0\.

I am working on ubuntu 10.04

Why this happens?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-23T00:25:17.230

这是 debian 补丁的一个“奇怪”功能：bash_4.2-5.diff bash as /bin/sh 在 POSIX 模式下工作，并且 POSIX shell（如破折号）不会放弃特权（带有 -p 或 bash 的 bash在 debian/ubuntu 中符号链接为 /bin/sh）

# c++ - C++ 中的文本文件读取问题

> ID：13209218
> 
> 赞同：0
> 
> 时间：2012-11-03T12:32:11.113
> 
> 标签：c++, file-io, file-handling

我设计了一个基于链接列表的 BookStore，其中书籍的属性将存储在节点等中。另外，在程序结束时，我必须将所有数据库保存到文本文件中*（我尝试过二进制读取，但该死的我被杀了并且无法做到）*然后重新加载每本书的所有信息并将其存储在节点并重新制作链接列表。现在保存已完成，完全没有问题。但我在读取文本文件时遇到问题。

**在文件中保存结构是:::**

BookID(int) - BookName(string) - Author(string) - BookType(string) - Copies(long) - Price(long) - '\n'（转到下一行）

**示例：** 1 ObjectOrientedParadigm R.Lafore Coding 5 900 2 ObjectOrientedParadigm R.Lafore Coding 5 900 等等......

这里是保存功能。

```
bool BookStoreDataBase<mytype>::save_all_data()
{
    if(!is_Empty()) //if list is not empty
    {
        BOOK<mytype> *temp = head;   //created a copy of head
        ofstream file("database.txt", ios_base::app); //created file, to write at the end (append)
        while(temp != tail) //while list ends
        {
            file<<temp->ID<<' '<<temp->bookName<<' '<<temp->author<<' '<<temp->book_type<<' '<<temp->copies<<' '<<temp->price<<' ';  //write all info
            temp = temp->next; //move temp to next node
        }
        file<<temp->ID<<' '<<temp->bookName<<' '<<temp->author<<' '<<temp->book_type<<' '<<temp->copies<<' '<<temp->price<<' '; //for last book's info
        return true; //to confirm sucessfull writing
    }
    else //if list is empty
    {
        return false; //to confirm error in writing
    }
} 
```

**问题:: 当我开始阅读时，第一行被读取并存储在列表中，但是下一次，我不能让文件从下一行读取，因此是'\n'。＆这会产生问题。文件再次读取第一行并使用相同的数据创建第二个节点。**

加载功能：

```
void BookStoreDataBase<mytype>::load_all_data()
{
    int ID;         //variable to store ID of a book
    string bookName;//string to store name of a book
    string author;  //string to store name of author of book
    string book_type;//string to store type of a book
    long copies;    //variable to store no. of copies a book
    long price;     //variable to store price of a book
    string status;  //to store status of a book, either its in stock or not

    ifstream file("database.txt");
    while(file) //I have tried file.eof but its not working, don't know why
    {
        file>>ID>>bookName>>author>>book_type>>copies>>price>>status; //read file

        BOOK<mytype> *temp = new BOOK<mytype>(0, 0, bookName, author, book_type, copies, price);  //create a new node in memory and save all the data

        if(is_Empty()) //if list is empty, then make 1st node
        {
            head = tail = temp;
        }
        else //other wise make the next node
        {
            tail->next = temp;
            temp->prev = tail;
            tail = temp;
        }
    }
} 
```

*MOREOVER* 读数比实际记录少 1 倍。即如果 .txt 有 4 本书的记录，则创建 3 个节点，（每个节点中仅重复第 1 个的信息），而它应该读取并创建 4 个节点！

*我是初学者，任何好的帮助将不胜感激。*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T12:35:51.107

我建议您使用 获取整行`std::getline()`，然后使用`stringstream`class 将所有内容从该行读入相应的变量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-03T12:41:29.533

`while (!file.eof())`错了，`while (file)`错了。似乎每个新程序员都无法理解从文件中读取的正确方法。我希望我知道为什么，向新手提供建议会更容易。基本的误解似乎是新手认为您应该*先测试文件结尾，**然后*再阅读。什么时候你应该先阅读，然后看看第二次阅读是否失败。

这是从文件中读取的正确方法

```
while (file >> ID >> bookName >> author >> book_type >> copies >> price >> status)
{
} 
```

试试看，看看还有什么问题。

我刚刚注意到另一个问题，您尝试读取您所说的状态是一个字符串，但是在您对文件格式的描述中没有状态。我认为这是你真正的问题。

# mysql - Getting rank of a row in mysql query

> ID：13209227
> 
> 赞同：4
> 
> 时间：2012-11-03T12:34:03.397
> 
> 标签：mysql, sql, rank

I was using this query to assign rank to every name according to the votes they have got, but it returns with the error :

> 1248 - Every derived table must have its own alias

Here is my code:

```
SELECT @rownum:=@rownum+1 AS rank, name, vote 
FROM table, (SELECT @rownum:=0) ORDER BY vote DESC 
```

On modifying the query to this :-

```
SELECT @rownum:=@rownum+1 AS rank, name, vote 
FROM table ORDER BY vote DESC 
```

I get as expected rank of the queries as NULL. Any help , how to get rank at first place ?

**NOTE:** I am not looking for any alternative solution. Just trying to do it in the query itself.

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-03T12:45:04.993

错误很明显。每个派生表都必须有自己的别名。你需要这样别名`(SELECT @rownum := 0)`：

```
SELECT 
  @rownum := @rownum + 1 AS rank, 
  name,
  vote 
FROM table, (SELECT @rownum := 0) t --This what you were missing an alias
ORDER BY vote DESC 
```

## [SQL 小提琴演示](http://sqlfiddle.com/#!2/df2ec/1)

# opengl - 2D to 3D map OpenGL

> ID：13209228
> 
> 赞同：2
> 
> 时间：2012-11-03T12:34:34.123
> 
> 标签：opengl, 3d, 2d

I am trying to make a simple game engine but I got stuck at a point when I tried to map a 2D mouse coordinate to a 3D coordinate in my world. The basic game has a plane that serves as the ground as it is going to be (hopefully with time) an RTS gameengine.

My problem is that I can't really come up with anything useful. The plane is located at the 0,-100,-300 points and is about 1000x1000 in size. My camera is at 0,0,0 and the scene is rotated at 60 degreesto give the impression of a "bird eye" cam.

I was thinking about the trigonometric equations, using that I know the height of my camera and the angle and possibly calculating the distance will give me the right coords but this is just an idea.

Can somebody please give me some advice?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T13:35:31.660

您可以通过简单的光线投射来做到这一点。

首先，使用[gluUnProject](http://www.talisman.org/opengl-1.1/Reference/gluUnProject.html)可以获得`m`鼠标指针的 2D 窗口坐标对应的 3D 世界坐标。

给定相机位置`e = (0, 0, 0)`，您可以计算鼠标光线方向 `r = m - e`。

现在，给定`p`平面上的一个点和平面法线`n`，您可以计算[鼠标射线与平面的交点](https://en.wikipedia.org/wiki/Line-plane_intersection)。

# android - Tool to design Layout for Android -apps online?

> ID：13209236
> 
> 赞同：7
> 
> 时间：2012-11-03T12:35:56.530
> 
> 标签：android, user-interface

I am trying to use DroidDraw.org for designing the user-interface, [here](http://www.droiddraw.org/), but it does not allow copying it to the clipboard. Does there exist some tool to design and copy-paste things?

![enter image description here](../Images/55589015a16eda3b9a50a22f6518f272.png)

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-11-03T12:35:56.530

I cannot help with the copy-paste -ban but the following threads poped up in SO:

*   [Online GUI design tool](https://stackoverflow.com/questions/2224329/online-gui-design-tool)

*   [Is there a good tool for doing Android layout design?](https://stackoverflow.com/questions/2783586/is-there-a-good-tool-for-doing-android-layout-design)

*   [Layout design help Android](https://stackoverflow.com/questions/6958917/layout-design-help-android)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-05-27T11:03:28.850

在 Chrome 中打开它。右键单击要复制的文本。选择检查。您将在浏览器底部看到 html。右键单击相应的 html 并选择编辑为 html。从那里复制。

# cordova - phonegap 2.2 + jQuery + Mapkit plugin

> ID：13209238
> 
> 赞同：2
> 
> 时间：2012-11-03T12:36:00.737
> 
> 标签：cordova, jquery-mobile, ios6, mapkit, phonegap-plugins

I have created a PhoneGap app with jQuery Mobile. What I want to do is get mapkit in a tag.

The user should not have to click on any buttons to view the map. I want it to appear all the time in div.

Here is the entire example I use [https://github.com/phonegap/phonegap-plugins/blob/master/iPhone/MapKitPlug/example/index.html](https://github.com/phonegap/phonegap-plugins/blob/master/iPhone/MapKitPlug/example/index.html)

This works great but the user most click show map to show the map.

```
<script type="text/javascript" charset="utf-8">

                    function onBodyLoad() {
                        document.addEventListener("deviceready",onDeviceReady,false);
                    }

                    /* When this function is called, PhoneGap has been initialized and is ready to roll */
                    function onDeviceReady() {

                    }

                    var pins = [
                    { lat:58.389508,
                            lon:13.843042,
                            title:"place1",
                            subTitle:"placename",
                            pinColor:"purple", 
                            selected:true,
                            index:0
                        },
                                      ]

                     function showMap() {
                        // do your thing!
                        var mapOptions = {
                      height: 360,
                      diameter: 1000,
                      offsetTop: 25,
                      lat: pins[0].lat,
                      lon: pins[0].lon
                    };

                        window.plugins.mapKit.showMap();
                        window.plugins.mapKit.setMapData(mapOptions);
                        window.plugins.mapKit.addMapPins(pins);     
                    }

                </script>      

        </head>

        <body onload="onBodyLoad()">  

                    <button style="top:400px;position:absolute;" onclick="showMap()">Show</button> 
```

This works great. But I want to do the same thing but with mapKit plugin for phonegap instead of google maps.

```
 <script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script>

    <script src="http://code.jquery.com/jquery-1.6.2.min.js"></script>  
    <script type="text/javascript">

        $(document).ready(function(){
                    var initialLocation = new google.maps.LatLng(37.654,-77.980);
                        var myOptions = {
                                        zoom: 12,
                                        center: initialLocation,
                                        mapTypeId: google.maps.MapTypeId.ROADMAP
                        };
                        var map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);
            });
</script>   
</head> 
<body>
<div data-role="content">   
    <!--images go here -->
    <div class="img_shadow" style="padding:4px;">
                    <div id="map_canvas" style="height:130px;"></div>
    </div>
</div>      
</div><!-- /page -->

</body> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T10:20:20.370

如果您想在页面加载时自动显示地图。你可以这样做...

```
$(document).ready(function(){

   //Your map integration
   window.plugins.mapKit.showMap();

}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T18:16:27.940

如果您希望地图自动加载，只需在页面加载时调用 showMap()。

定义 showMap 函数后：

```
function showMap() {
  // do your thing!
  var mapOptions = {
  height: 360,
  diameter: 1000,
  offsetTop: 25,
  lat: pins[0].lat,
  lon: pins[0].lon
 };

 window.plugins.mapKit.showMap();
 window.plugins.mapKit.setMapData(mapOptions);
 window.plugins.mapKit.addMapPins(pins);   
}
showMap(); // call it 
```

# ruby-on-rails - Problems importing a CSV that has a filename as a string in Rails

> ID：13209239
> 
> 赞同：0
> 
> 时间：2012-11-03T12:36:06.700
> 
> 标签：ruby-on-rails, ruby-on-rails-3, csv, carrierwave

I'm trying to import a CSV file to my Rails app that's using CarrierWave to handle file uploads. I'm using the `CSV` gem and populating the Rails database via a seed data.

The issue I'm having is the import doesn't populate the image field of the database. The image column is a string that holds the filename eg. 'this-is-my-photo.jpg'.

I have a database table that has the following columns:

```
# ProductImage model, product_image table

id |     image    |     tile      | product_id | created_at | updated_at 
--------------------------------------------------------------------------
 1 | image-1.jpg  | Big shoe      |     11     | 2012-08-01 | 2012-08-01
 2 | 1-photo.png  | Small hat     |     12     | 2012-08-01 | 2012-08-01
 3 | jeansb1.gif  | Ankle socks   |     13     | 2012-08-01 | 2012-08-01

# Import product_image table backup
CSV.foreach(Rails.root.join("db/seeds/product_image.csv"), headers: true) do |row|
  ProductImage.create! do |product_image|
    product_image.id = row[0]
    product_image.title = row[1]
    product_image.image = row[2]
    product_image.product_id = row[3]
  end
end 
```

The results of `db:seed`

```
# ProductImage model, product_image table after population of seed data

id |     image    |     tile      | product_id | created_at | updated_at 
--------------------------------------------------------------------------
 1 |              | Big shoe      |     11     | 2012-11-01 | 2012-11-01
 2 |              | Small hat     |     12     | 2012-11-01 | 2012-11-01
 3 |              | Ankle socks   |     13     | 2012-11-01 | 2012-11-01 
```

Everything but the `image` column was populated.

I was wondering if anyone can give me tips on how to go about resolving this import/population issue. Has anyone experienced this problem before and is it because of the the filename type (eg. .jpg)?

Also, I have the same problem when restoring my user model that has an `avatar` column which is a string that holds the CarrierWave filename.

Thanks in advance.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T12:47:22.953

您不能使用该`image=`方法； 这是您在尝试直接设置字符串时误用的 CarrierWave 方法*（重载 ActiveRecord） 。*

您可以改为使用[`write_attribute`](http://api.rubyonrails.org/classes/ActiveRecord/AttributeMethods/Write.html#method-i-write_attribute)

```
product_image.raw_write_attribute(:image, row[2]) 
```

这在内部是 ActiveRecord 在其`image=`方法中使用的。

# jquery - Loading results via AJAX continously as user types in an input field

> ID：13209241
> 
> 赞同：1
> 
> 时间：2012-11-03T12:36:13.213
> 
> 标签：jquery

I am trying to achieve an Ajax search/autocomplete as user types in. Here is my code:

```
$('#productSearch').live('keyup',function(){
    var searchterm = encodeURIComponent($('#productSearch').val());
    $('.ajax-search-results').load('/ajax/search.php?type=product&s=' + searchterm);

}); 
```

The problem is that results are not consistent with the input value, I have no idea why, but when I type too fast (too fast for handling the .load() maybe?) the results at end are not consistent (not what I expect) if i type in slowly, it works perfectly.

Can someone tell me how can I come over this situation?

*   I thought about disabling function until the load is done, but that would mean also that i will lose what the user has typed until the operation is done?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T12:41:58.193

这通常通过一个小的超时来修复，以便在用户快速键入时不会将请求堆叠在一起并为每个键执行 ajax，如果执行常规 $.ajax 调用，则通过中止先前的调用（`abort()`XHR不太容易带负载（））：

```
var timer;

$(document).on('keyup', '#productSearch',function(){
    clearTimeout(timer);
    timer = setTimeout(function() {
        var searchterm = encodeURIComponent($('#productSearch').val());
        $('.ajax-search-results').load('/ajax/search.php?type=product&s=' + searchterm);
    }, 300);
}); 
```

# python - can this variable really be "referenced before assignment"

> ID：13209243
> 
> 赞同：4
> 
> 时间：2012-11-03T12:36:29.023
> 
> 标签：python, django, transactions, django-admin

I have a piece of code below (belongs to a Django admin view, slightly modified). My IDE (PyCharm) warns me at the last line that `Local variable 'ModelForm' might be referenced before assignment`.

I don't see how that can ever happen, but when I comment out line 6:

```
with transaction.commit_manually(): 
```

then the warning disappears.

Am I missing something, or is PyCharm missing something?

Here is the chunk of code. I striped it down to just a few lines and it still gives the warning. The original chunk of code is here (70 lines): [http://pastebin.com/4UT9hRPb](http://pastebin.com/4UT9hRPb)

```
 ModelForm = self.get_form(request, obj, form=form)

    formsets = []
    if request.method == 'POST':
        # commit only when all forms are valid
        with transaction.commit_manually():
            try:
                objects = queryset.all()
                transaction.commit()
                return self.response_change(request, new_object)

            finally:
                general_error = unicode(sys.exc_info()[1])
                transaction.rollback()

    form = ModelForm() 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T13:22:59.023

似乎这个警告不应该发生，至少我不明白为什么，也许 PyCharm 在确定`with`块的范围时有问题。但是您可以通过移动块`ModelForm`中的分配来消除此警告`with`。

# emacs - Emacs to autocomplete all imported module functions

> ID：13209244
> 
> 赞同：1
> 
> 时间：2012-11-03T12:36:34.677
> 
> 标签：emacs, elisp, rope, ropemacs, pymacs

I have been using rope, ropemacs and pymacs for my autocompletion. It does pretty well, but I noticed that there is some limitation to the amount of completion it aids in. It only seems to complete the classes for the modules imported not all of the functions available.

How can I get my pymacs, ropemacs, rope to look up all of the functions of an imported module?

# c++ - R6010：我可以将 int& 传递给接受 int 的函数吗？

> ID：13209245
> 
> 赞同：0
> 
> 时间：2012-11-03T12:36:34.537
> 
> 标签：c++, runtime-error

我有一个声明类似的函数

```
void func1(int& x) {
    func2(x); // func2 accepts an int
} 
```

我认为这就是程序崩溃的原因？我得到错误

> `R6010 - abort() has been called`

我需要做什么才能将 x 传递给接受 int 的函数？我希望它们能同样工作......因为我可以使用回显 x 的值`cout << x`

**更新**

只是一个测试：

```
cout << stmtNo << endl;
Node* n = ast->getNode(stmtNo);
cout << n->getNodeType() << " " << n->getStmtNo() << endl; 
```

以上失败...以下通过

```
cout << stmtNo << endl;
Node* n = ast->getNode(1);
cout << n->getNodeType() << " " << n->getStmtNo() << endl; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T12:46:02.020

没问题，您始终可以将整数引用作为整数的参数传递。

整数引用可以解释为自动取消引用自身的常量指针。

```
#include<iostream>
using namespace std;
void fun_2(int s)
{
   cout<<s<<endl;
}
void func(int &d)
{
    fun_2(d);
}

int main()
{
   int x=99;
   func(x);

   system("pause");
   return 0;
} 
```

上面的代码完美运行！

# animation - 不移动的精灵动画

> ID：13209250
> 
> 赞同：0
> 
> 时间：2012-11-03T12:37:00.493
> 
> 标签：animation, sprite, pygame

所以，我希望我的玩家精灵在不实际移动的情况下为运动设置动画，因为我希望它保持在屏幕中间，但它不能正确地设置动画。

```
import pygame, sys
from pygame.locals import *

# Game window setup
pygame.init()
screen=pygame.display.set_mode((0,0), FULLSCREEN)

# Colour setup
green=(0,255,0)
white=(255,255,255)
black=(0,0,0)

# Speed in pixels per frame
x_speed=0
y_speed=0

# Defining the character
class Player(pygame.sprite.Sprite):

    # This is a frame counter used to determing which image to draw
    frame = 0

    # Constructor
    def __init__(self):
        # Call the parent class (Sprite) constructor
        pygame.sprite.Sprite.__init__(self)

        # Lists that the character images will be saved in.
        self.images_moveright=[]
        self.images_moveleft=[]
        self.images_movedown=[]
        self.images_moveup=[]

        # Load default character image
        img=pygame.image.load("Player_images\character_default.png")

        for i in range(1,3):
            down = pygame.image.load("Player_images\character_movedown"+str(i)+".png").convert()
            down.set_colorkey(white)
            self.images_movedown.append(down)

            left=pygame.image.load("Player_images\character_moveleft"+str(i)+".png").convert
            #left.set_colorkey(white)
            self.images_moveleft.append(left)

            right=pygame.image.load("Player_images\character_moveright"+str(i)+".png").convert()
            right.set_colorkey(white)
            self.images_moveright.append(right)

            up=pygame.image.load("Player_images\character_moveup"+str(i)+".png").convert()
            up.set_colorkey(white)
            self.images_moveup.append(up)

        self.image=img
        self.rect=self.image.get_rect()

    def moveright(self):
        if self.frame<10:
            self.image=self.images_moveright[0]
            self.frame+=1
        if self.frame>=10:
            self.image=self.images_moveright[1]
            if self.frame==20:
                self.frame=0

player=Player()

# Current position of player and background
screen_width=screen.get_width()
screen_height=screen.get_height()

player_x_coord=screen_width/2
player_y_coord=screen_height/2

background_initial_coordx=0
background_initial_coordy=0

player.rect.x=player_x_coord
player.rect.y=player_y_coord

background=pygame.image.load("background0.png").convert()
all_sprites_list=pygame.sprite.RenderPlain()
all_sprites_list.add(player)

# Used to manage how fast the screen updates
clock=pygame.time.Clock()

# Main game loop
while 1:
    for event in pygame.event.get():
        if event.type==QUIT:
            pygame.quit()
            sys.exit() 

        # Control definition
        elif event.type == KEYDOWN:     
            if event.key == K_ESCAPE:
                pygame.quit()
                sys.exit()
            if event.key == pygame.K_LEFT:                
                x_speed=3    
            if event.key == pygame.K_RIGHT:
                player.moveright()
                x_speed=-3             
            if event.key == pygame.K_UP:                
                y_speed=3               
            if event.key == pygame.K_DOWN:                
                y_speed=-3

        if event.type == pygame.KEYUP:
            if event.key == pygame.K_LEFT:                
                x_speed=0                
            if event.key == pygame.K_RIGHT:
                x_speed=0                
            if event.key == pygame.K_UP:
                y_speed=0                
            if event.key == pygame.K_DOWN:
                y_speed=0

    # Update of game map
    background_initial_coordx += x_speed
    background_initial_coordy += y_speed

    screen.fill(black)
    time=pygame.time.get_ticks()
    screen.blit(background, [background_initial_coordx, background_initial_coordy])
    all_sprites_list.draw(screen)

    clock.tick(60)

    print(time)

    pygame.display.flip() 
```

到目前为止，我只设置了向右移动的控件，并且我有两个图像来为其设置动画（player_moveright1 和 player_moveright2，都在列表 self.images_moveright 中）。但是，它只显示第二张图像，而不是第一张，显然，我想要每 10 帧。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T20:02:31.543

我认为每次按右时，您唯一的一次迭代 self.frame 。这意味着您必须反复点击正确的按钮才能更改它。我会这样做：

```
def moveRight():
  self.image_list = self.images_moveright

// in your main loop call something like this, which is a method of your player

def playerTick(self):
  self.ticker += 1
  if self.ticker >= 10:
    self.ticker = 0
    self.frame += 1
    if self.frame >= 1: // i think you could use >= self.image_list.len() - 1
      self.frame = 0
      self.image = image_list[self.frame] 
```

我希望这会有所帮助，我还没有测试过，这只是我会怎么做......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T15:01:06.243

在你的功能

```
def moveright(self):
    if self.frame<10:
        self.image=self.images_moveright[0]
        self.frame+=1
    if self.frame>=10:
        self.image=self.images_moveright[1]
        if self.frame==20:
            self.frame=0 
```

你没有增加你的self.frame。

将 self.frame +=1 移动到函数的末尾以解决此问题。

# php - 我将如何使用 php 按字母顺序对这个类别列表进行排序？

> ID：13209257
> 
> 赞同：1
> 
> 时间：2012-11-03T12:38:07.220
> 
> 标签：php, database, list, sorting, alphabetical

我查看了其他示例并尝试使其工作，但对代码的修改仅返回错误。基本上，我有一个从我的数据库中提取并显示在 2 列上的类别列表。我希望按字母顺序列出类别，列表的前半部分在第 1 列中，后半部分在第 2 列中。我假设简单地按字母顺序列出它们会自动在我想要的类别中显示它们。谢谢你的帮助。我的代码是：

```
<ul class="links">
            <?php if($this->is_loged) { ?>
            <li><a href="./"><strong><?php echo $this->translate('Pinners you follow');?></strong></a></li>
            <?php } ?>
            <?php if($this->categories) { ?>
            <li>
                <a class="arrow" href="<?php echo $this->all_url;?>"><?php echo $this->translate('Everything');?><?php if($this->category_active) { ?>: <?php echo $this->category_active;?><?php } ?></a>
                <div class="dropdown columns-2">
                    <?php $total = count($this->categories); ?>
                    <?php for($r=$i=0; $i<2; $i++) { ?>
                    <ul>
                        <?php for($j=0; $j<ceil( $total/2 ); $j++, $r++) { ?>
                        <?php if(isset($this->categories[$r])) { ?>
                        <?php 
                            $class = $this->categories[$r]['active'] ? 'active' : '';
                            if($r==0 || ceil( $total/2 ) == $r) { $class .= ' first'; }
                            if($r==($total-1) || (ceil( $total/2 )-1) == $r) { $class .= ' last'; }
                            $class = trim($class);
                        ?>
                        <li<?php if($class) {?> class="<?php echo $class;?>"<?php } ?>><a href="<?php echo $this->categories[$r]['href'];?>"><?php echo $this->categories[$r]['title'];?></a></li>
                        <?php } ?>
                        <?php } ?>
                    </ul>
                    <?php } ?>
                    <div class="clear"></div>
                </div>
            </li>
            <?php } ?></ul> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T12:46:35.870

你可以用 MySQL 做到这一点`sort_by name ASC`，在 PHP 中你可以做到这一点：

1.  `sort($this->categories, SORT_STRING)`或 s `ort($this->categories)`;
2.  `ksort($this->categories)`用键排序；

# image - 如何查看 .img 文件？

> ID：13209258
> 
> 赞同：19
> 
> 时间：2012-11-03T12:38:08.030
> 
> 标签：image, image-processing, uiimageview

我正在尝试查找软件来查看 .img 文件。但它不是预期的。.img 文件不是所有的图像，它也包含一些值。所以我想查看 .img 文件。请告知任何类似的软件。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-11-03T12:47:27.480

如果要打开 .img 文件，可以使用 7-zip，它是免费软件...

[http://www.7-zip.org/](http://www.7-zip.org/)

安装后，右键单击相关的 img 文件，将鼠标悬停在“7-zip”上，然后单击“打开存档”。请记住，您需要一个单独的程序或 Windows 7 来将映像刻录到光盘！

希望这可以帮助！

编辑：[证明它有效](https://www.youtube.com/watch?v=uvockUCVwUM)（不是我的视频，归功于YouTube 上的[howtodothe ）。](https://www.youtube.com/channel/UCVXcHgub5YjkIXCM5wyP8BQ)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2017-06-25T17:09:39.693

`.img`太不具体了。此文件扩展名广泛用于各种（原始）文件格式。它是“图像”的缩写，可以是您能想象到的任何图像——或者根本无法想象的图像，因为您从未听说过。

例如，`.IMG`曾经是一个 GEM 位图图像文件。有人记得GEM吗？它是 Digital Research 的 Windows 竞争对手。Atari ST 版本被广泛使用，但也有 GEM 的 DOS 版本。DR DOS 3.41、5.0 和 6.0 以及 Novell DOS 7.0 中包含的精简版本之一（这是避免 Apple 提出版权主张所必需的）是 ViewMAX。它现在是开源的，可以作为[OpenGEM](https://en.wikipedia.org/wiki/OpenGEM)自由下载。仍然需要 DOS 并且包含在 FreeDOS 发行版中。为了查看 GEM 位图图像，当时的 Windows 程序（围绕基于 DOS 的 Windows 3.0）例如 Ventura Publisher 可以打开并因此将此类“GEM 图像”或“Atari ST 图像”转换为其他更广泛使用的格式。

但我怀疑这种`.img`-file 是你的意思。不过，你必须更具体。

最广泛地`.img`用作例如软盘的原始文件系统映像。正如其他人所提到的，这些图像可以由许多程序打开。或者直接挂载在类 Unix 系统下，如 BSD 和 Linux。[7-Zip](http://www.7-zip.org/)还能够为支持的文件系统（例如 FAT）从此类图像中提取文件。至少是命令行版本。只需键入`7z x image.img`，它将提取包含的文件。

但是请注意，还有其他图像格式，例如 IBM 的`.dsk`，有时使用不同的文件扩展名。此类文件*可以*是原始软盘映像，但也可以是 IBM`SAVEDSKF/LOADDSKF`格式。这些文件基本上是原始文件，末尾带零，但文件开头有标题。我怀疑 7-Zip 是否可以提取此类图像，即使只需要找到适当的偏移量。**无论如何，**由于通过标题的图像基本上是原始且未压缩的，因此使用`dd`您可以提取图像并使其成为原始图像`.img`软盘图像。假设标题是十六进制：291 字节长（您必须通过查看文件内部来弄清楚，例如使用十六进制编辑器）。这等于要跳过的 657 个字节，导致`dd if=image.dsk of=rawimage.img bs=1 skip=657`. 然而，生成的 rawimage.img 的大小将是非标准的。这可以通过使用 dd 再次修复。`dd if=/der/zero of=rawimage.img count=0 bs=1 seek=1474560`– 这将生成一个稀疏文件，从而为 1.44 MB 软盘映像生成正确的文件大小，并在未使用的位置返回零。适用于 Linux 下的大多数程序。

但一般来说，`.img`可以是任何归类为“图像”的文件，因此任何应用程序都可以包含具有此扩展名的（专有）文件。此类文件只能由所述应用程序使用（打开）。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-11-03T12:44:58.317

您可以使用 PowerISO 或 WinRAR

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2020-06-10T04:23:34.673

如果您使用 Linux 或 WSL，您可以使用取证应用程序[binwalk](https://github.com/ReFirmLabs/binwalk)来提取 .img 文件（通常是磁盘映像），如下所示：

1.  使用您的分发包管理器或[按照手册说明](https://github.com/ReFirmLabs/binwalk/blob/master/INSTALL.md)安装 binwalk。

2.  使用该命令`binwalk -e FILENAME.img`将识别的内容提取到自动生成的目录中。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2014-02-24T20:47:58.950

.IMG 文件通常是文件系统，而不是图片。访问它们的最简单方法是安装 VMWare，在 VMWare 中安装 Windows，然后将 .img 文件添加为某种磁盘设备（软盘、cdrom、硬盘）。如果您猜对了，Windows 可能会打开它。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2015-10-12T15:33:27.743

由于您没有提及您正在运行哪个操作系统，这里有一个针对 linux 的解决方案：使用[losttup](http://linux.die.net/man/8/losetup)

```
losetup /dev/loop0 /path/to/your/file.img 
```

然后就可以挂载了。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2019-01-16T13:16:31.543

首先，您应该使用[文件](https://en.wikipedia.org/wiki/File_(command))来识别图像：

`file foo.img`

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2015-10-10T16:06:22.527

文件扩展名`.img`没有说明其内容。

最常见的 .img 文件是软盘/CD/DVD/ISO 映像、文件系统映像、磁盘映像，甚至只是（自定义）二进制数据。

如果它是 CD/DVD 映像或特定文件系统映像（如 fat、ntfs、...），您可以使用[7-Zip](http://7-zip.org)打开这些文件。

在基于 *nix 的系统上，该`file`工具或 (libmagic) 也可以帮助您找出它是什么。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2015-10-12T15:46:18.913

使用 *nix，通常不需要软件即可查看 .img 文件。您可以使用循环设备来安装它，然后每个文件管理器来导航它。[在这里](https://unix.stackexchange.com/a/82315)你可以找到方法。有时你需要安装一些软件包来管理奇怪的文件系统，比如 squashfs。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2015-10-12T19:12:40.633

OSFMount、MagicDisc、Gizmo Director/Gizmo Drive、The Takeaway。

所有这些都适用于 .img 文件

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2021-05-13T21:55:54.860

## .img = .ico 的示例

这可能很少见，但我发现这个“视觉图片”.img 文件隐藏在 Edge 浏览器的主页上。Microsoft Edge 在新标签页上有一个指向 Amazon.ca 的快捷方式，以及亚马逊的图标。当我下载该图标时，它具有 .img 文件扩展名。

我的照片软件都不能自动预览这个 .img 文件，但我知道这是一张视觉图片。图片来源的 html 网页上下文让我想到了一个网站图标，所以我尝试使用 .ico 扩展名重命名 .img，它成功了！

## 详细说明

**“我**从 F12 控制台下载了图标”，请参见屏幕截图，因为无法从页面本身下载它。即使没有下载，在 html 代码中也可以看到 .img 扩展名，并且在新的 Edge 选项卡中打开图像时可以看到图像本身。（查看[带有 .img 图片文件的 Edge 浏览器中的 html 屏幕](https://i.stack.imgur.com/NSW6z.png)截图）

**“能够进行自动预览”**，这意味着我想在 Windows 10 文件资源管理器中以任意大小的图标（查看菜单）和预览窗格中查看图片内容。您仍然需要上述帖子中提到的一些其他 Windows 设置，例如：

*   文件资源管理器，查看菜单，选项，查看选项卡
    *   ⬜ 必须取消选中“始终显示图标，从不缩略图”
    *   ⬜ 不需要“在预览窗格中显示预览处理程序”
*   搜索“性能”，选择“调整 Windows 的外观和性能”：
    *   ☑ 必须勾选“显示缩略图而不是图标”

**“我的照片软件都无法提供自动预览”**，解决了如果 .img 文件类型与特定应用程序相关联，它会自动预览吗？请注意，大多数应用程序都能够将 .img 作为图片打开，但不能提供预览。例如：

*   免费软件，既不能预览也不能打开 .img：

    *   ❌ 油漆网
    *   ❌ 墨景
    *   （可能有一些可以做到的，如果你找到了请告诉我们！）
*   Microsoft 内置软件，无法预览，但可以打开 .img：

    *   ✔ 油漆
    *   ✔ 绘制 3D
    *   ✔ 照片

# if-statement - grep 文件并找到多个单词并采取相应措施

> ID：13209259
> 
> 赞同：0
> 
> 时间：2012-11-03T12:38:12.500
> 
> 标签：if-statement, grep

我对 Linux 很陌生，不懂编程。但是通过阅读一些我可以理解的东西，我可以提问。

我正在做类似下面的事情，

在一个文件中找到几个单词并在另一个文件中采取相应的行动。

```
find in log.txt
if "not found" 1 > notify.txt
if "reset by peer" 2 > notify.txt
if "Permission denied" 3 > notify.txt
if "Fetching" 0 > notify.txt
exit 
```

喜欢

```
if [it found] "not found" [text in the log.txt then it will write] 1 > notify.txt
if [it found] "reset by peer" [text in the log.txt then it will write] 2 > notify.txt
if [it found] "Permission denied" [text in the log.txt then it will write] 3 > notify.txt
if [it found] "Fetching" [text in the log.txt then it will write] 0 > notify.txt 
```

请帮我写剧本。

我想在 notify.txt 中写 0 或 1 或 2 或 3。现在脚本将决定写什么。脚本将通过读取 log.txt 文件来决定。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T13:09:52.020

您的问题有一些含糊不清，但我相信这就是您要寻找的：

```
#!/bin/bash

# Put the source file / output file in variables
# so they are easier to change
src_file=log.txt
outfile=notify.txt

# Look for the patterns in the source file with "grep":
not_found=$(grep "not found" $src_file)
reset_by_peer=$(grep "reset by peer" $src_file)
perm_denied=$(grep "Permission denied" $src_file)
fetching=$(grep "Fetching" $src_file)

# If the output file already exists, remove it
if [[ -f $outfile ]]; then
    rm -f $outfile
fi

# Create a blank output file
touch $outfile

# If any of the patterns are found, print a number accordingly:
if [[ -n $not_found ]]; then
    echo "1" >> $outfile
fi 

if [[ -n $reset_by_peer ]]; then
    echo "2" >> $outfile
fi 

if [[ -n $perm_denied ]]; then
    echo "3" >> $outfile
fi 

if [[ -n $fetching ]]; then
    echo "0" >> $outfile
fi 
```

由于您使用多个`if`块而不是一个`if-else if-...-else`块来构建您的问题，我假设源文件中可以存在多种模式，如果是这样，您希望在输出文件中显示多个数字。（尽管即使 src 文件中也只能存在一种模式，这仍然有效）

# sql-server - SQL Server 2008 与 2012

> ID：13209260
> 
> 赞同：0
> 
> 时间：2012-11-03T12:38:14.817
> 
> 标签：sql-server, ssms

在本地，当我打开 SQL Server Management Studio 2012 时，我通过服务器名称连接到我的数据库`{MyPCName}`。

时不时地，总是在机器关闭后发生变化，这会失败。如果我将服务器名称更改为`{MyPCName}/SQLExpress`.

看起来好像我安装了两个版本的 SQL Server。2010 年和 2011 年。

例如，昨天查看程序日志时，当我可以使用`{MyPCName}`SQL Server 登录时，日志似乎一直在更新文件夹中的日志`MSSQL11.MSSQLSERVER`。今天日志似乎正在更新文件夹中的日志`MSSQL10.SQLEXPRESS`。

查看已安装程序列表，我似乎安装了 SQL Server 2008 和 2012。

有没有办法可以选择连接/删除 2010 版？

顺便说一下，这些都是 Express 版本，以防万一。;-)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-03T12:48:33.870

实际上，您并没有运行两个 express 版本，除非您在安装过程中最终重命名了一个实例。SQL11 (SQ Server 2012) 安装的默认名称为`MSSQLSERVER`. `SQLEXPRESS`正如您在 2008 年版本中看到的那样，Express 版本通常会为其命名。

这也解释了为什么您可以只使用本地主机名进行连接。如果要连接到非默认命名实例，则必须添加实例名称 (Ie `localhost\SQLEXPRESS`)。

使用 SQL Server 安装程序，您可以完全卸载其中一个版本。

在这样做之前，请确保备份系统数据库（master、model 和 msdb），以防最终需要其中的任何内容。我还建议您从旧实例中分离您仍然需要的任何用户数据库，然后将它们附加到新实例。

# windows-8 - Windows phone 8 SDK 安装问题

> ID：13209261
> 
> 赞同：5
> 
> 时间：2012-11-03T12:38:43.833
> 
> 标签：windows-8, windows-phone-8

我正在尝试在 Windows 8 Box 上安装 Windows phone 8 SDK。它会安装，但 Windows 永远不会再次启动，永远卡在蓝色的 Windows 徽标上。让它启动的唯一方法是在安装 wp8 sdk 之前恢复

有人遇到过这个问题吗？我可以获得一些关于 Windows 启动的日志吗？

这是我的环境：

*   物理系统
*   Windows 8 Professional 64 位法语，法语区域设置
*   Visual Studio 2012 终极版
*   安装了 VmWare 工作站 9（它会与 hyperv 冲突吗？）
*   英特尔酷睿 i5 2500k CPU 与 8Go 内存

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-04T11:07:25.353

Ok I found a solution. My mother board is a Z68XP-UD3 from gigabyte. You can boot into windows after installing WP8SDK (or Hyper-v i think) with **disabling all USB3.0 controllers** into the Bios.

Disabling Virtualization technologies solve the issue without disabling USB3.0 but i need it for the WP8 SDK

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-03T12:39:47.807

> 安装了 VmWare 工作站 9（它会与 hyperv 冲突吗？）

是的。这很可能是你的问题。请尝试不安装 VMWare（或任何其他虚拟化软件）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-03T12:55:15.107

是的，它的 VMWare，实际上我必须关闭 Hyper-V 才能运行 VMWare Player，确保您的机器上还启用了二级地址转换“SLAT”。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-05T17:54:42.097

您不应该让 VMWare 在也启用了 HYPER-V 的机器上工作。那会给你带来麻烦。我建议您将 VMWare 机器迁移到 HYPER-V，并使用 HYPER-V 作为您机器上唯一的可视化解决方案。

# asp.net - 运行期间在 ASP.NET Web API 中控制 [JsonIgnore]

> ID：13209262
> 
> 赞同：4
> 
> 时间：2012-11-03T12:39:00.293
> 
> 标签：asp.net, entity-framework, json.net

众所周知，ASP.NET web api (ApiController) 通过 NewtonSoft.JSON 自动给出 JSON 响应。

我的三级**1:MANY:1** EF 数据模型以多种方式进行查询，并且可以很好地将 [JsonIgnore] 属性应用于某些虚拟属性以消除引用循环问题。[（我在这个（链接）](https://stackoverflow.com/questions/13060609/why-my-super-simple-asp-net-web-api-mvc4entity-framework-5-doesnt-work)答案中使用了第三种解决方案）

但我的问题是，我有时需要使用 json-ignored 属性来查询模型。

有什么方法可以在运行时控制**[JsonIgnore]**属性吗？或者，是否有任何方法可以在运行时切换 NewtonSoft.JSON 中要忽略的开关属性？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-12-08T17:53:52.253

我知道解决这个问题的两种方法：

1.  您可以在模型中添加额外的布尔属性（具有特定名称）。这是解决方案非常简单，但需要更改您的模型。
2.  你可以自己写`IContractResolver`。这种方法更复杂，但更灵活。

此处描述的两种解决方案：“条件属性序列化” [http://james.newtonking.com/json/help/index.html?topic=html/ConditionalProperties.htm](http://james.newtonking.com/json/help/index.html?topic=html/ConditionalProperties.htm)

# java - 在 Java 中应用 XSLT 在 XML 输出中获取输入 XML 标记名称

> ID：13209263
> 
> 赞同：0
> 
> 时间：2012-11-03T12:39:03.813
> 
> 标签：java, xml, xslt

我是 xslt 的新手。

我想要的是通过应用 xslt 从输入 xml 获取标签名称并将输出保存在 output.xml

我的 input.xml 是 -

```
<?xml version="1.0" encoding="UTF-8"?>
<productDetails>
<name>Mobile</name>
<price>999</price>
<stock>57</stock>
</productDetails> 
```

我的 input.xsl 是 -

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
<xsl:output method="xml"/>

<xsl:template match="/productDetails">
   <xsl:attribute name="name()"/>   
</xsl:template>
</xsl:stylesheet> 
```

我的Java代码是-

```
 Source xmlInput = new StreamSource("input.xml");
    Source xsl = new StreamSource(new File("input.xsl"));
    Result xmlOutput = new StreamResult(new File("output.xml"));

        Transformer transformer = TransformerFactory.newInstance().newTransformer(xsl);
        transformer.transform(xmlInput, xmlOutput); 
```

输出我想要的是 -

```
<?xml version="1.0" encoding="UTF-8"?>
 name
 price
 stock 
```

请任何人帮助

先感谢您。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T12:45:49.703

写一个模板

```
<xsl:template match="*">
  <xsl:value-of select="name()"/>
</xsl:template> 
```

如果要输出输入中所有元素的名称。如果您只需要叶子元素的名称，请使用

```
<xsl:template match="*[not(*)]">
  <xsl:value-of select="name()"/>
</xsl:template> 
```

您可能需要或想要添加空格以更好地格式化结果。并不是说您想要一个 XML 结果，但是您在主级别显示的带有纯文本节点的结果示例并不是格式良好的 XML 文档。然而，XSLT 允许输出此类片段，因此如果您希望我的建议应该采用这种格式。

# c# - Mono for Android HTML 带有特殊字符的源代码

> ID：13209267
> 
> 赞同：0
> 
> 时间：2012-11-03T12:39:57.840
> 
> 标签：c#, android, html, xamarin.android

我正在使用 Mono for Android (C#) 和 WebClient DownloadString 来获取 HTML 网站的源代码，该网站使用特殊字符 (č,š,ž - charset=windows-1250)。但是在显示代码时，它会显示 � 而不是字符。有没有办法显示正确的字符？我正在使用 MonoDevelop。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T12:55:39.267

当您使用`DownloadString`.NET（我想也是 Mono）时，会自动假定下载的数据以 UTF-8 编码。在您的情况下，情况并非如此，因此使用了 � 字符。

而不是`DownloadString`，用于`DownloadData`下载原始字节并将它们转换为 UTF-8：

```
byte[] win1250Bytes = webClient.DownloadData("http://whatever.com");
string utf8String = Encoding.GetEncoding("windows-1250").GetString(win1250Bytes); 
```

# mysql - 试图从mysql中的过程中获取几个值

> ID：13209269
> 
> 赞同：0
> 
> 时间：2012-11-03T12:40:10.740
> 
> 标签：mysql, procedure

我正在尝试使用这样的程序：

```
DELIMITER $$

CREATE
    /*[DEFINER = { user | CURRENT_USER }]*/
    PROCEDURE `godating`.`realnames`(OUT rnames VARCHAR)
    /*LANGUAGE SQL
    | [NOT] DETERMINISTIC
    | { CONTAINS SQL | NO SQL | READS SQL DATA | MODIFIES SQL DATA }
    | SQL SECURITY { DEFINER | INVOKER }
    | COMMENT 'string'*/
    BEGIN
    SELECT username INTO rnames FROM users GROUP BY username HAVING COUNT(*)>3
    END$$

DELIMITER ; 
```

我想在 rnames 输出中必须有几个用户名值。我怎样才能改进我的程序来实现这个目标？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T12:43:08.347

```
DELIMITER $$
CREATE    PROCEDURE `godating`.`realnames`(In rnames varchar)  
    BEGIN
    SELECT username FROM licenses GROUP BY licenses_key having count(*)>0;
    END//

DELIMITER ;
===================
This procedure call like mysql query usind "call sp_name(rnames_values)". 
```

# algorithm - 查找数组中最大的整数和但不大于 x

> ID：13209278
> 
> 赞同：1
> 
> 时间：2012-11-03T12:41:22.240
> 
> 标签：algorithm, sorting

假设我们有一个整数数组：

```
int array = {5, 7, 4, 4, 2}
int x=10 
```

输出将是：

```
10 //(4,4,2) 
```

实现此输出的最快方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T12:57:25.703

您正在处理**[子集和问题](http://en.wikipedia.org/wiki/Subset_sum_problem)**（假设您不想要连续的子数组）。

问题是[NP-Complete](http://en.wikipedia.org/wiki/NP-complete)，并且没有已知的多项式解决方案（一般假设是不存在，但[尚未证明](http://en.wikipedia.org/wiki/P_versus_NP_problem)）

但是，有一个[伪多项式解决方案，使用动态规划](http://en.wikipedia.org/wiki/Subset_sum_problem#Pseudo-polynomial_time_dynamic_programming_solution)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-03T12:48:21.903

你问的问题类似于

```
0-1 Knapsack problem 
```

其中利润与重量相同。

您可以谷歌它并轻松理解算法。这可能是最快的方法。

# haskell - 将 Map.lookup 映射到列表

> ID：13209282
> 
> 赞同：1
> 
> 时间：2012-11-03T12:41:33.413
> 
> 标签：haskell

我有 Data.Map (freqMap)，它看起来像：

```
"SO" -> "10"
"OM" -> "20"
... 
```

所以每两个字母我都会映射一些值。

我有一个字符串列表：

```
["SO", "OM", "ME", "ET" ...] 
```

我需要将此列表转换为另一个列表：

```
["10", 20", ...] 
```

其中每个元素都是我的地图（freqMap）中的一个值。

我使用递归创建了解决方案：

```
score_ngram :: [String] -> Map.Map String String -> [Int] -> [Int]
score_ngram [] scores result = result
score_ngram ngrams scores result = score_ngram (tail ngrams) scores (result ++ [value])
    where value = case (Map.lookup (head ngrams) scores) of
        Just v -> read v :: Int
        Nothing -> 0 
```

但我只是想知道是否可以使用地图功能获得它？

像这样的东西：

```
map (Map.lookup element_of_list freqMap) ["SO", "OM", "ME", "ET" ...] 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-03T12:51:03.483

假设您希望不存在的 ngram 得分为 0，您可以使用：

```
map (read . flip (Map.findWithDefault "0") freqMap) ["SO", "OM", "ME", "ET" ...] 
```

# java - 我需要帮助以递归方式比较目录中的文件以查找重复项

> ID：13209284
> 
> 赞同：7
> 
> 时间：2012-11-03T12:41:42.813
> 
> 标签：java, file-io

我正在开发一个程序，该程序将（希望）比较给定目录中的所有文件，识别重复项，将它们添加到列表中，然后将列表显示给用户，以便他们可以验证他们希望在删除这些文件之前删除它们，我'我严重卡住了。到目前为止，我已经能够递归地列出所有文件，并且我一直在比较它们以找到重复项。我很快意识到要完成我想要的，我需要比较多个文件属性。并非所有文件都是文本文件，就互联网上的示例代码而言，比较文本主要是我发现的，我正在尝试更多地了解二进制数据，因为比较字节数组和文件名是我能来的最好的跟上。具体来说我' 我询问哪些属性最好进行比较，以平衡查找重复项的准确性和能够处理合理大小的目录？如果你不介意我怎么能在我的代码中实现它？希望我的问题不是太糟糕，我非常感谢我能得到的任何帮助。这就是我所拥有的，是的，我在这里找到的一些方法和第二个文件，以防你想知道。PS如果我错过了任何无意义的变量，我真的很抱歉，我在发布之前尝试清理一下代码 如果您想知道的话，我确实在这里找到了一些方法和第二个文件。PS如果我错过了任何无意义的变量，我真的很抱歉，我在发布之前尝试清理一下代码 如果您想知道的话，我确实在这里找到了一些方法和第二个文件。PS如果我错过了任何无意义的变量，我真的很抱歉，我在发布之前尝试清理一下代码

ListFilesInDir.java

```
import java.io.*;
import java.nio.file.Files;
import java.nio.file.attribute.*;
import java.security.*;
import java.util.*;

public final class ListFilesInDir {

static File startingDir;

static List<File> files;
static List<File> dirs;
static TreeMap<Integer, File> duplicates;
static ArrayList<Integer> usedIndexes = new ArrayList<Integer>();
static ArrayList<File> duplicateList = new ArrayList<File>();

static File out = new File("ListDuplicateFiles.txt");
static PrintWriter output;

static int key = 0;
static String tabString;
static TreeMap<Integer, File> tMap = new TreeMap<Integer, File>();

static int num1 = 0;
static int num2 = 0;
static File value1 = null;
static File value2 = null;
static String path1 = null;
static String name1 = null;
static String path2 = null;
static String name2 = null;

public static void main(String[] args) throws FileNotFoundException {
    new ListFilesInDir(args[0]);
}

public ListFilesInDir(String string) throws FileNotFoundException {
    startingDir = new File(string);
    dirs = new ArrayList<File>();
    duplicates = new TreeMap<Integer, File>();
    output = new PrintWriter(out);

    getFiles(startingDir);
    compareFiles();
    writeDuplicateList();
}

public void getFiles(File root) throws FileNotFoundException {
    System.out.println("Adding files to list...");
    ListFilesInDir.files = getFileList(root);
    for (File file : files) {
        if (!file.isFile()) {
            System.out.println("Adding DIR: " + key + " name: " + file);
            dirs.add(file);
        } else {
            System.out.println("Adding FILE: " + key + " name: " + file);
            tMap.put(key, file);
        }
        key++;
    }
    System.out.println(dirs.size());
    System.out.println("Complete");
}

public static void compareFiles() throws FileNotFoundException {
    System.out.println("Preparing to compare files...");
    for (num1 = 0; num1 < files.size(); num1++) {
        for (num2 = 0; num2 < files.size(); num2++) {

            if (num1 != num2) {
                value1 = files.get(num1);
                value2 = files.get(num2);
                path1 = value1.getAbsolutePath();
                path2 = value2.getAbsolutePath();
                name1 = path1.substring(path1.lastIndexOf(File.separator));
                name2 = path2.substring(path2.lastIndexOf(File.separator));
                HashMap<Integer, File> testMap = new HashMap<Integer, File>();

                System.out.println(num1 + "|" + num2 + " : " + value1
                        + " - " + value2);
                if (CompareBinaries.fileContentsEquals(
                        value1.getAbsolutePath(), value2.getAbsolutePath()) == true) {
                    if (testMap.put(num1, value1) != null) {
                        TreeSet<File> fileTreeSet;
                    }
                    addDuplicate(num1, value1);
                    files.remove(num1);

                    System.out.println("added(binary): " + num1 + ":"
                            + value1);

                } else if (value1.getName().equalsIgnoreCase(
                        value2.getName())) {
                    addDuplicate(num1, value1);
                    files.remove(num1);
                    System.out.println("added(name): " + num1 + ":"
                            + value1);
                }
            }
        }
    }
    System.out.println("Complete");

}

public static void writeDuplicateList() {
    int printKey = 0;
    for (File file : duplicateList) {
        output.printf("%03d | %s\n", printKey, file);
        System.out.printf("%03d | %s\n", printKey, file);
        printKey++;
    }

    output.append(docsInfo());
    output.close();
    output.flush();

    System.out.println("\n"+files.size()+" files in "+startingDir.getAbsolutePath() +", "+duplicateList.size()+" duplicate files.");
}

static public String docsInfo() {
    String s = "\n\n" + files.size() + " files in "
            + startingDir.getAbsolutePath() + ", " + duplicates.size()
            + " duplicate files.";
    return s;
}

static public List<File> getFileList(File file)
        throws FileNotFoundException {
    List<File> result = getUnsortedFileList(file);
    Collections.sort(result);
    return result;
}

static private List<File> getUnsortedFileList(File file)
        throws FileNotFoundException {
    List<File> result = new ArrayList<File>();
    File[] filesAndDirs = file.listFiles();
    List<File> filesDirs = Arrays.asList(filesAndDirs);
    int dirKey = 0;

    for (File fileList : filesDirs) {
        result.add(fileList);
        if (!fileList.isFile()) {

            List<File> deeperList = getUnsortedFileList(fileList);
            result.addAll(deeperList);
        }
    }
    return result;
    }

        static private void validateDir(File dir) throws FileNotFoundException {
    if (dir == null)
        throw new IllegalArgumentException("Directory is null!");
    if (!dir.exists())
        throw new FileNotFoundException("Directory doesn't exist: " + dir);
    if (!dir.isDirectory())
        throw new IllegalArgumentException(dir + "is not a directory!");
    if (!dir.canRead())
        throw new IllegalArgumentException("Directory cannot be read: "
                + dir);
     }

         public static void addDuplicate(int i, File file)throws FileNotFoundException{
          if (!duplicates.containsKey(i)) {
           duplicates.put(i, file);
               duplicateList.add(file);

          }
     }
    } 
```

比较二进制文件.java

```
import java.io.File;
import java.io.FileInputStream;
import java.io.InputStream;
import java.util.Arrays;

public class CompareBinaries {

private final static int BUFFSIZE = 1024;
private static byte buff1[] = new byte[BUFFSIZE];
private static byte buff2[] = new byte[BUFFSIZE];

public static boolean inputStreamEquals(InputStream is1, InputStream is2) {
    if(is1 == is2) return true;

    if(is1 == null && is2 == null) {
        System.out.println("both input streams are null");
        return true;
    }

    if(is1 == null || is2 == null) return false;
    try {
        int read1 = -1;
        int read2 = -1;

        do {
            int offset1 = 0;
            while (offset1 < BUFFSIZE
                        && (read1 = is1.read(buff1, offset1, BUFFSIZE-offset1)) >= 0) {
                        offset1 += read1;
                }

            int offset2 = 0;
            while (offset2 < BUFFSIZE
                        && (read2 = is2.read(buff2, offset2, BUFFSIZE-offset2)) >= 0) {
                        offset2 += read2;
                }
            if(offset1 != offset2) return false;
            if(offset1 != BUFFSIZE) {
                Arrays.fill(buff1, offset1, BUFFSIZE, (byte)0);
                Arrays.fill(buff2, offset2, BUFFSIZE, (byte)0);
            }
            if(!Arrays.equals(buff1, buff2)) return false;
        } while(read1 >= 0 && read2 >= 0);
        if(read1 < 0 && read2 < 0) return true; // both at EOF
        return false;

    } catch (Exception ei) {
        return false;
    }
}

public static boolean fileContentsEquals(File file1, File file2) {
    InputStream is1 = null;
    InputStream is2 = null;
    if(file1.length() != file2.length()) return false;

    try {
        is1 = new FileInputStream(file1);
        is2 = new FileInputStream(file2);

        return inputStreamEquals(is1, is2);

    } catch (Exception ei) {
        return false;
    } finally {
        try {
            if(is1 != null) is1.close();
            if(is2 != null) is2.close();
        } catch (Exception ei2) {}
    }
}

public static boolean fileContentsEquals(String fn1, String fn2) {
    return fileContentsEquals(new File(fn1), new File(fn2));
} 
```

}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T12:52:13.870

您可以使用散列函数来比较两个文件——两个文件（在不同的文件夹中）可以具有相同的名称和属性（例如长度）但内容不同。例如，您可以创建一个文本文件，然后将其复制到不同的文件夹中，更改内容中的一个字母。

哈希函数对以数字结尾的文件内容进行了一些巧妙的数学运算，即使内容的微小差异也会以两个非常不同的数字结尾。

以 md5 哈希函数为例，它从任意长度的字节数组中生成一个 16 字节的数字。虽然理论上可以创建两个 md5 相同但内容不同的文件，但概率很低（而两个文件名称和大小相同但内容不同是一个相对较高的概率事件）

关键是，您可以建立一个文件内容的 md5 表，这只需计算一次并且可以快速比较 - 如果 md5 不同，则文件不同且有 100% 的置信度。只有在不太可能的情况下，md5 相同，您才必须采用逐字节比较来确定 100%。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-21T17:45:23.037

最近在处理我的项目工作时，我发现了一个关于使用 SHA 算法接收重复文件名和目录的好备忘录

看看它： [https ://jakut.is/2011/03/15/a-java-program-to-list-all/](https://jakut.is/2011/03/15/a-java-program-to-list-all/)

可能对你有用

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-08-14T12:08:18.777

我的建议：遍历一个目录树，按名称与另一个目录树进行比较。然后，对于每个匹配对，比较文件大小和最后修改时间，如果都相等，则进行直接的逐字节比较。

有两个步骤来实现这个（如果添加了示例代码的链接）：

1.  遍历两个目录以获取完整列表。Java 通过 Java 7 和[`Files.walkFileTree()`](http://docs.oracle.com/javase/tutorial/essential/io/walk.html). 您遍历一个目录树并将每个条目与另一个目录树进行比较。我在[这里](https://stackoverflow.com/a/18211580/2435872)发布了一些示例代码进行此类比较（我的示例代码应该可以帮助您完成此步骤，但并没有 100% 解决您的问题）
2.  比较两个文件是否相等。可以比较几件事：
    *   文件名。这很明显，因为无论如何都需要在第二棵树中找到文件。
    *   文件大小，上次修改时间：是`BasicFileAttributes`您在遍历树时获得的一部分。请参阅有关如何为第二个文件获取它的示例代码。
    *   内容。如上所述，您可以计算某种 crc、md5、sha。发生的情况是，您将阅读这两个文件的全部内容。所以，我的建议是，直接逐字节比较，例如与 [ `Arrays.equals()`]( [http://docs.oracle.com/javase/7/docs/api/java/util/Arrays.html#equals(byte []](http://docs.oracle.com/javase/7/docs/api/java/util/Arrays.html#equals(byte[]) , 字节 []))

# python - 基于正则表达式拆分字符串

> ID：13209288
> 
> 赞同：146
> 
> 时间：2012-11-03T12:41:57.340
> 
> 标签：python, regex, split

`"HELLO there HOW are YOU"`用大写单词（在 Python 中）分割字符串的最佳方法是什么？

所以我最终会得到一个像这样的数组：`results = ['HELLO there', 'HOW are', 'YOU']`

* * *

编辑：

我试过了：

```
p = re.compile("\b[A-Z]{2,}\b")
print p.split(page_text) 
```

不过，它似乎不起作用。

* * *

## 回答 #1

> 赞同：165
> 
> 时间：2012-11-03T13:02:14.190

我建议

```
l = re.compile("(?<!^)\s+(?=[A-Z])(?!.\s)").split(s) 
```

检查**[这个演示](http://ideone.com/qoaTqr)**。

* * *

## 回答 #2

> 赞同：68
> 
> 时间：2012-11-03T12:45:44.260

您可以使用前瞻：

```
re.split(r'[ ](?=[A-Z]+\b)', input) 
```

这将在每个空格处拆分，后跟一串以单词边界结尾的大写字母。

请注意，方括号只是为了便于阅读，也可以省略。

如果一个单词的第一个字母是大写就足够了（所以如果你也想在前面拆分`Hello`）它会变得更容易：

```
re.split(r'[ ](?=[A-Z])', input) 
```

现在，它在每个空格处拆分，后跟任何大写字母。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-06-04T18:29:48.347

您的问题包含字符串 literal `"\b[A-Z]{2,}\b"`，但这`\b`意味着退格，因为没有 r-修饰符。

试试：`r"\b[A-Z]{2,}\b"`。

# sqlite - 删除几乎重复的行

> ID：13209289
> 
> 赞同：2
> 
> 时间：2012-11-03T12:42:04.307
> 
> 标签：sqlite, duplicate-removal

我有一个带有如下表的 Sqlite3 数据库：

表（com1，com2）

```
A || B
B || A
C || D
D || B
B || D 
```

如果我有 2 行： A || B和B || A，我想删除其中一个（我不在乎哪一个）。

所以要获得：

```
A || B
C || D
D || B 
```

我读过很多关于重复行的问题，但我找不到这样的东西。谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T13:00:47.653

我认为您的问题的解决方案应如下所示：

```
SELECT
    t1.val1,t1.val2
FROM table AS t1
JOIN table AS t2 ON (
    (t1.val1=t2.val2) AND (t1.val2=t2.val1)
) WHERE t1.val1<=t1.val2 
```

其中*table*是表的名称，*val1*和*val2*是该表中列的名称。

# c# - 关于数据通过 LINQ 将一个对象传输到数组

> ID：13209295
> 
> 赞同：2
> 
> 时间：2012-11-03T12:43:20.960
> 
> 标签：c#, linq

```
class A
{
   public string[] X {get;set;}
   public string[] Y {get;set;}
}

class B
{
  public string X {get;set;}
  public string Y {get;set;}
} 
```

使用 Linq 将 A 对象的数据传输到 B 的数组？假设 A 的对象有 10-10 大小的 X 和 Y，我想转移到 B 数组`(B[] b = new B[10])`

```
A a = new A();
//put 10 items in both x and y
B[] b = new B[10];
//here I want to get a's data to b 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-03T12:48:44.830

您可以使用[`Zip`](http://msdn.microsoft.com/en-us/library/dd267698.aspx)LINQ 中的方法：

```
A a = new A();
B[] bs = a.X.Zip(a.Y, (x, y) => new B() { X = x, Y = y })
            .ToArray(); 
```

或`Select`与索引一起使用：

```
B[] bs = a.X.Select((x, i) => new B {X = x, Y = a.Y[i]})
            .ToArray(); 
```

`Enumerable.Range`如果您卡在 .NET 3.5 上，另一种使用方法：

```
B[] bs = Enumerable.Range(0, 10)
                   .Select(i => new B {X = a.X[i], Y = a.Y[i]})
                   .ToArray(); 
```

# java - Box2d蹦床，与精灵动画同步

> ID：13209296
> 
> 赞同：0
> 
> 时间：2012-11-03T12:43:23.567
> 
> 标签：java, box2d

我正在创建 2d 游戏，我决定在我的游戏中实现蹦床（物体在跳跃后会将玩家抛到空中）一开始我只是在玩家的脚与蹦床接触后为玩家设置一些线速度.. 但是因为它有点丑，我决定用适当的艺术和动画来描述这个动画，看看这个图像（仅示例！）

![在此处输入图像描述](../Images/7cc5dd5acb4876c7993498f695010d29.png)

我想用运动学的身体来做蹦床，在玩家和它接触后，蹦床身体会向下移动，而不是向上抛出玩家。假设我有 4 种蹦床状态的精灵表（在 2d 中）

1) 正常状态（标准状态下的蹦床） 2) 挤进 30% 3) 挤进 60% 4) 挤进 100%

现在我的问题是，如何处理这个问题，根据身体状态改变精灵动画瓦片。还有比我提到的（蹦床运动体）更好的选择来支持它吗？谢谢。

# c - gstreamer 显示视频信息

> ID：13209299
> 
> 赞同：0
> 
> 时间：2012-11-03T12:43:54.027
> 
> 标签：c, gstreamer

我正在尝试使用 gstreamer 来显示视频信息，例如频率、频道数、宽度和高度。我使用此代码来执行此操作，但它不起作用。我用C编码。

```
GstStructure *structure;
// guint32       fourcc;
const GValue *val;
GstPad     *audiopad;
GstCaps *caps;
gint    width;
gint    height;
int     fps_num = 1;
int     fps_den = 1;
audiopad = gst_element_get_pad (queuevideo, "tee");
caps = gst_pad_get_caps (audiopad);

structure = gst_caps_get_structure (GST_CAPS (caps), 0);
gst_structure_get_int (structure, "width", &width);
gst_structure_get_int (structure, "height", &height);
val = gst_structure_get_value (structure, "framerate");
if (val) {
    fps_num = gst_value_get_fraction_numerator (val);
    fps_den = gst_value_get_fraction_denominator (val);
}
printf("la taille est de  : %d*%d et la frequence de : %d/%d", width, height, fps_num, fps_den); 
```

# design-patterns - 基于 xsd 模式和数据创建 xml 文档的 xsl 样式表

> ID：13209301
> 
> 赞同：0
> 
> 时间：2012-11-03T12:44:20.940
> 
> 标签：design-patterns, xslt, xsd, code-generation

以下问题的建议方法是什么，这对我来说似乎很常见。

**我们需要生成xml 文档，我们有一个schema，xsd 文件。我们的应用程序生成要放入文档的数据。**应该使用什么样的 xsl 文件？我相信必须有所有此类任务通用的片段，因为 xsd 格式是恒定的。

例如，我想 xsd 首先经过预处理以生成数据模板。然后应用程序可以使用这个数据模板来生成真实的数据。最后是产生输出文件的主要处理。并且主处理的 xsl 样式表也可以从 xsd 自动生成。当然，在所有的自动处理之后，样式表的手动调整就完成了。

我看到了这样的特定常见任务：

*   `minOccurs=0`元素的处理。仅当数据包含给定元素时才会生成它们。
*   如果没有给出数据，则默认值，但该元素是强制性的。
*   使用参数或数据节点控制替代元素。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T16:20:36.687

一般来说，有无数的文档符合任何给定的 xml 模式。有些工具可以生成“典型”实例，但它们的输出永远无法预测。还有一些工具可以在给定源模式和目标模式的情况下指导您定义从一个到另一个的转换（最著名的可能来自 Altova）。同样，这仅适用于简单/特殊情况。但这可能正是您正在寻找的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T08:14:41.323

Jarekczek，尽管您的想法似乎很笼统，但也许仍然以过于狭隘的方式陈述？如何从您的问题中删除“xsl stylesheets to”字样？使用编写应用程序时所用的语言 X 而不使用 xslt 处理器不是更好吗？

其他人已经问过了，这些问题似乎涵盖了特定语言的主题：

*   [XML Schema 到 C++ 类](https://stackoverflow.com/q/445905/772981)
*   [xsd 代码生成器的比较（C#）](https://stackoverflow.com/q/386155/772981)

我还在调查这个问题。如果问题被正确标记，那么搜索`[xsd] [code-generation]`应该是一个很好的起点。

另请注意，您尝试实现的可能是基于 xsd 的*编组*，它是*XML 数据绑定*( [wiki](http://en.wikipedia.org/wiki/XML_data_binding) ) 的一部分。

# apache - RESTful 应用程序 .htaccess 错误

> ID：13209304
> 
> 赞同：2
> 
> 时间：2012-11-03T12:44:33.910
> 
> 标签：apache, .htaccess, rest, httprequest

我正在开发一个backbone.js 应用程序（仅供参考），我可以提交请求以`controller.php`进行处理。我有一个 switch 语句，`REQUEST_METHOD`它可以按预期使用`GET`,`POST`和.`PUT``DELETE`

但是，当我使用以下`.htaccess`文件时：

```
RewriteEngine On
RewriteCond  %{REQUEST_FILENAME} !-f
RewriteCond  %{REQUEST_FILENAME} !-d
RewriteRule ^/?controller/([^/]+)$ /controller.php?id=$1 [L] 
```

...并传递给`controller/5`而不是`controller.php?id=5`我得到一个 405 错误 - 不允许的方法。

我一直在通过谷歌挖掘并询问同事，但找不到解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T15:27:29.723

.htaccess 的最后一行看起来不对。

如果您只有方法 0 到 9，它将类似于：

```
RewriteRule ^/controller/([0-9])$ /controller.php?id=$1 [NC,QSA,L] 
```

或一般来说：

```
RewriteRule ^/controller/(.*)$ /controller.php?id=$1 [NC,QSA,L] 
```

在这种情况下，控制器 / 之后的所有内容都将作为 id 参数的值 ($1) 传递。

如果它在您调用时工作，`controller.php?id=5`它也应该在调用时工作`controller/5`

# xcode - 本地声明隐藏实例变量/未使用的变量警告

> ID：13209305
> 
> 赞同：1
> 
> 时间：2012-11-03T12:44:36.797
> 
> 标签：xcode, compiler-warnings, xcode4.5

对于“secondsLeft”和小时、分钟和秒的“未使用变量”，我有一个“本地声明隐藏实例变量”错误。提前感谢您对此提供的任何帮助。

.h 文件

```
#import <Foundation/Foundation.h>
#import <UIKit/UIKit.h>
#import "BT_viewController.h"

@interface BT_screen_blank : BT_viewController {

    NSTimer *timer;
    IBOutlet UILabel *myCounterLabel;
}

@property (nonatomic, retain) UILabel *myCounterLabel;
@property (nonatomic) int secondsLeft;
@property (nonatomic) int minutes;
@property (nonatomic) int hours;
@property (nonatomic) int seconds;

-(void)updateCounter:(NSTimer *)theTimer;
-(void)countdownTimer;

@end 
```

.m 文件

```
 @implementation BT_screen_blank
 @synthesize myCounterLabel;
 @synthesize secondsLeft, hours, minutes, seconds;

 //viewDidLoad
 -(void)viewDidLoad{
[BT_debugger showIt:self:@"viewDidLoad"];
[super viewDidLoad];

int hours, minutes, seconds;
int secondsLeft;

secondsLeft = 16925;
[self countdownTimer];
}

- (void)updateCounter:(NSTimer *)theTimer {
if(secondsLeft > 0 ){
    secondsLeft -- ;
    hours = secondsLeft / 3600;
    minutes = (secondsLeft % 3600) / 60;
    seconds = (secondsLeft %3600) % 60;
    myCounterLabel.text = [NSString stringWithFormat:@"%02d:%02d:%02d", hours, minutes,          seconds];
}
else{
    secondsLeft = 16925;
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T12:49:42.767

您必须使用 self 调用变量。例如：

```
self.hours = self.secondsLeft / 3600; 
```

此外，如果您想稍后声明具有相同名称的变量，请使用其他名称，例如：

```
int hours_tmp; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-03T12:53:23.763

从您的 " `viewDidLoad`" 函数中删除这些行：

```
int hours, minutes, seconds;
int secondsLeft; 
```

这两行正是产生`local declaration hides instance variable`您所看到的“”错误的原因。

就像 edzio 说的，`self.`在你引用的任何属性前面使用“”。给他+1！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-03T12:54:43.607

“secondsLeft”的“局部声明隐藏实例变量”错误</p>

您`int secondsLeft;`在 .m 文件中重新声明

因此，在这一行`secondsLeft = 16925;`上，编译器将 16925 存储在`-(void)viewDidLoad`方法中的局部变量中，而不是`int secondsLeft;`在 .h 文件中声明

您应该删除 `int hours, minutes, seconds;` `int secondsLeft;`.m 文件中的重新声明。或者，您可以使用其他变量名称

小时、分钟和秒的“未使用变量”。嗯，这只是一个警告，强调你永远不会使用这些在方法`int hours, minutes, seconds;`中声明的变量`-(void)viewDidLoad`

# javascript - javascript标识符查找

> ID：13209306
> 
> 赞同：-1
> 
> 时间：2012-11-03T12:44:42.483
> 
> 标签：javascript

我正在阅读*面向 Web 开发人员的专业 JavaScript*

有什么奇怪的。

```
var color = "blue";

function getColor() {
    var color = "red";
    return color;
}

getColor();   // "red" 
```

答案很明显。但是下面的解释很奇怪。“如果其中一个操作数是对象而另一个不是，则在对象上调用 valueOf() 方法以检索原始值以根据先前的规则进行比较。”

我只是不明白。很明显，无论发生什么，它都会返回本地颜色。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T12:50:23.743

你是绝对正确的，它总是会返回红色。这种解释虽然在技术上是正确的，但在这种情况下显得格格不入。哎呀，要记住所有这些东西而不会误入歧途已经够难的了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T12:51:08.073

当一个变量或函数参数在内部范围内定义时，与范围外的变量/参数同名时，该变量将覆盖另一个变量。但是一旦您返回外部范围，前一个变量仍将具有它的初始值。没有什么可以比较你的例子。它只是两个赋值和一个函数声明。

`var color = ...`表示正在制作一个新变量。如果我们没有*关键字*`var`，那么在调用函数时，外部作用域中的变量将`color`具有更改的值。但是我们只是创建了一个局部范围的变量，一个不会干扰另一个。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-12T06:07:34.560

**你的代码是这样的**

```
var color = "blue";

function getColor() {
    var color = "red";
    return color;
}

getColor();   // "red" 
```

**如果您从函数调用，**答案颜色变量将始终包含红色，因为它是本地声明和定义的。****

 **但是在调用函数之后，如果你想得到颜色的值，那么它的值就会变成蓝色。**

# java - 我们应该使用集合、获取和集合吗？

> ID：13209311
> 
> 赞同：1
> 
> 时间：2012-11-03T12:45:24.017
> 
> 标签：java, performance, getter-setter

我正在阅读一本 java 书，其中说在访问/修改不同类中的变量时，应该使用 get/set 方法来操作它们。

我的问题是，加班和在大型项目中使用gets/sets 不会危及应用程序性能？

类似的问题，通常我们应该更喜欢使用数组来损害更抽象的数据类型（例如实例列表），因为数组通常对缓存更友好。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-03T12:56:30.230

除非您正在编写必须在某些嵌入式设备中运行的高效算法的关键部分，否则您的首要目标应该是生成简单、可读、可维护的代码。OOP 在这方面通过封装等特性帮助我们。Getter 和 setter 允许封装一些行为。它们也是多种 Java 技术（如 JSP EL、各种脚本语言、IDE 等）使用的标准。一般来说，性能不应该是主要的设计因素。

Java 即时编译器非常聪明，并且会内联对 getter 和 setter 的调用。

Java 集合等高级抽象也有助于编写更简单、更安全的代码，并且已经过测试和优化。用数组重新实现它们提供的所有东西会导致难以维护、效率低下的代码。绝对使用 Java 集合，并且比数组更喜欢它们。

请记住，与速度较慢的正确代码相比，有效的错误代码是无用的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-03T12:59:32.950

> 我的问题是，加班和在大型项目中使用gets/sets 不会危及应用程序性能？

没有。它促进了数据封装，是一种很好的 OO 实践。

> 软件对象在概念上类似于现实世界的对象：它们也由状态和相关行为组成。对象将其状态存储在字段（某些编程语言中的变量）中，并通过方法（某些编程语言中的函数）公开其行为。方法对对象的内部状态进行操作，并作为对象到对象通信的主要机制。*隐藏内部状态并要求通过对象的方法执行所有交互被称为**数据封装**——面向对象编程的基本原则。*

来自[Java Trail](http://docs.oracle.com/javase/tutorial/java/concepts/object.html)。

> 我们是否应该更喜欢使用数组来损害更抽象的数据类型（例如实例列表），因为数组通常对缓存更友好。

这取决于您的用例。
我认为缓存友好意味着内存效率更高。删除元素时会涉及一些碎片，并且数组设计具有一定的初始容量。它从`ArrayList`10 开始，然后根据您的需要不断调整大小。

但是，使用 Array 的好处是您可以按索引访问元素。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-03T13:49:39.823

如果您正在构建一个数据对象，其唯一目的是获取和设置字段，那么 getter 和 setter 是一个好主意。它们允许您在必要时验证和同步，甚至可以在不破坏旧代码的情况下更改字段（只需更改字段并保持 API 不变）。

但是，在大多数情况下（如果不是所有其他情况），getter 和 setter 是一个*坏*主意。这个问题甚至与性能没有任何关系。问题在于，在上述数据对象之外，**getter 和 setter 破坏封装的程度几乎与直接暴露底层变量本身一样严重。** 如果*必须*有可见变量，则使用 get/set 方法；但是，在大多数情况下，您不必有可见的变量。

消费者不应该关心，或者在大多数情况下甚至不应该*知道*类包含的变量。这就是封装的本质——不是这种“将变量隐藏在 getter 后面”的误导概念，而是“隐藏变量，*周期*”。你绝对不应该*设置*它们；管理它的变量是类的责任，如果用户在使用它之前必须为它设置类的操作参数，那么类就坏了。如果调用者必须`getAnything()`在调用你的方法之后，那么方法签名是错误的；*他们得到的东西应该是一个返回值*。

完全公开成员变量，无论是通过 getter/setter 还是仅仅通过公开该字段，只有当该字段是数据时才应考虑。其他所有情况都需要更好的封装。

至于数组与集合，这取决于具体情况。我个人喜欢在两者都有意义的情况下使用集合，但这是个人偏好。在决定这一点时，诸如缓存位置之类的事情不应该是您的主要关注点。但请记住，`ArrayList`在大多数情况下，an 与普通的旧数组一样对缓存友好。如果您定义要获取和返回`List`的内容，那么您可以随意切换 List 子类型，因为您发现特定的子类型现在更适合您的需求。只需尝试在不破坏现有代码的情况下将 API 的数组返回值切换为链表即可。:)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-03T12:51:11.900

这个词是封装。使用`get`and`set`可以更容易地控制对变量的访问（例如，检查值是否在范围内、同步、控制它们何时被更改——对并发编程中的竞争条件很有用——、使用它们的线程是否有权这样做， ETC。）。特别是对于大型项目，这比微小的开销更重要。

此外，`get`and`set`也在 Java bean 的定义中，它们被许多框架（JPA、JSF 等）使用。

数组没问题，但是如果您不知道数组的确切大小，那么您要么将内存浪费在空单元格中，要么必须经常调整它们的大小，从而增加代码的复杂性。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-03T13:11:04.943

我不记得上次在 Java 中使用数组是什么时候了。我总是使用类似`ArrayList`或类似的集合。当您处理图像等原始字节时，更使用数组。在内部，集合是使用数组实现的，因此与附加方法（如`add`、`put`、`get`、 remove 等）基本相同。

回答这个`getter/setter`问题，如果你正在编写一个将被其他人使用的库，你必须使用 getter 和 setter。用户将使用的接口或层不应该通过简单的属性 ( `new A().property`) 访问，这是一个非常糟糕的设计，因为您没有封装任何东西。即使您的模块是私有的并且仅由您的应用程序使用，您也必须`getters/setters`在前端层使用。如果一个类是内部的并且不能从模块/包外部访问，那么可以通过属性访问它，但最好封装。我通过属性访问的唯一情况是当我在公共类中有一个私有类时。我使用属性从公众访问私有类。例子：

```
public class A{
    B b = new B ();

    private class B{
        String asd = "asd";
    }

    public String a (){
        return b.asd;
    }
} 
```

# hadoop - 开始使用 Hadoop 的最简单方法

> ID：13209321
> 
> 赞同：1
> 
> 时间：2012-11-03T12:46:22.137
> 
> 标签：hadoop, elastic-map-reduce

我正在寻找提交 MapReduce 作业的最简单方法。

我正在寻找一个复杂性（或简单性）类似的平台，例如 Heroku（对于 Ruby）或 picloud.com 是要映射的。

这个想法是初学者可以提交 MapReduce 作业，而无需处理设置 Hadoop 集群的复杂性。Elastic Map Reduce 已接近尾声，但设置实例的启动时间令人大跌眼镜。

所以基本上我一直在寻找完成 picloud 等价于 MapReduce 的人。

我还阅读了以下答案，但没有找到我要找的东西：[这个](https://stackoverflow.com/questions/10418632/what-is-the-easiest-way-to-get-started-with-hadoop-on-ec2-preferably-mapr)和[这个](http://answers.mapr.com/questions/2257/what-is-the-easiest-way-for-a-hadoop-newbie-to-get-started-with-mapr-on-one-ec2-box)

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-05T20:58:02.590

两个不错的入门资源：

使用 Amazon Elastic Mapreduce：[http ://aws.amazon.com/aws-training/elasticmapreduce/](http://aws.amazon.com/aws-training/elasticmapreduce/)

使用 Cloudera CDH 解决方案（更多涉及并依赖 Hive 而不是实际的 MapReduce 作业）： http: [//www.infoq.com/articles/BigDataBlueprint](http://www.infoq.com/articles/BigDataBlueprint)

编辑：如果您不喜欢 Elastic MapReduce，您可能想尝试一下 Sears MetaScale（我还没有尝试过）：[http ://www.metascale.com/services/big-data](http://www.metascale.com/services/big-data)

# php - 无法在 mysql 表中更新

> ID：13209330
> 
> 赞同：0
> 
> 时间：2012-11-03T12:47:46.287
> 
> 标签：php, mysql

我遇到了一个关于更新名为“answers”的数据库表中的值的问题。因为它没有更新表。所以，这是我的代码：

```
 if(isset($_POST['marked']))
            { $marked= $_POST['marked'];
            $command= "UPDATE Answers SET " .
          "SessionID=" . $_POST['SessionID'] . ", " .
          "TestID=" . $_POST['TestID'] . ", " .
          "QuesID=" . $_POST['QuesID'] . ", " .
          "A1=0, " .
          "A2=0, " .
          "A3=0, " .
          "A4=0, " .
          "A5=0, " .
          "A6=0, " .
          "AnswerText=\"\", " .
          "SortOrder='" . intval($_POST['Order']) . "' " .
          "marked=1".
          "WHERE SessionID=" . $_POST['SessionID'] .
          " AND QuesID=" . $_POST['QuesID'];
             $lolsql= mysql_query($command, $conn);

             } 
```

每当有人单击标记（提交按钮）时，我想将具有 0 值的“标记”字段更新为 1。请有人帮助我。提前致谢：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T12:55:41.563

您的代码极易受到注入攻击，因为您根本没有清理输入并直接更新数据库，其次开始使用`mysqli_()`or `PDO statements`，`mysql_()`社区不再维护。

至少用于`mysqli_real_escape_string()`清理您的输入

例子

```
if(isset($_POST['whatever'])) {
  $holder = mysqli_real_escape_string ($connection, $_POST['value']);
} 
```

你的查询一团糟，你为什么要使用连接？你不能像这样简单地写你的查询吗？

```
$query = "UPDATE table_name SET col_name = '$value', col_name2 = '$value2' ... WHERE ..."; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-03T13:30:23.807

**完整代码：**

```
<? if(isset($_POST['marked'])) {

    $answer_text = "something here";

    $marked = mysql_real_escape_string($_POST['marked']);
    $session = mysql_real_escape_string($_POST['SessionID']);
    $test = mysql_real_escape_string($_POST['TestID']);
    $ques = mysql_real_escape_string($_POST['QuesID']);
    $answer = mysql_real_escape_string($answer_text);
    $order = intval(mysql_real_escape_string($_POST['Order']));

    mysql_query("
    UPDATE
        `Answers`

    SET
        `SessionID` = '$session',
        `TestID` = '$test',
        `QuesID` = '$que',
        `A1` = 0,
        `A2` = 0,
        `A3` = 0,
        `A4` = 0,
        `A5` = 0,
        `A6` = 0,
        `AnswerText` = '$answer',
        `SortOrder` = '$order',
        `marked` = 1

    WHERE
        `SessionID` = '$session'
        AND
            `QuesID` = '$ques';
    ") or die("Error: " . mysql_error());

}?> 
```

**如果您希望将查询放在一行上：**

```
mysql_query("UPDATE `Answers` SET `SessionID` = '$session', `TestID` = '$test', `QuesID` = '$que', `A1` = 0, `A2` = 0, `A3` = 0, `A4` = 0, `A5` = 0, `A6` = 0, `AnswerText` = '$answer', `SortOrder` = '$order', `marked` = 1 WHERE `SessionID` = '$session' AND `QuesID` = '$ques';") or die("Error: " . mysql_error()); 
```

如果您仍然遇到问题，此脚本将返回以`Error:`. 您可能拼错了其中一列。

# sql - 如何拆分行值

> ID：13209331
> 
> 赞同：0
> 
> 时间：2012-11-03T12:47:49.213
> 
> 标签：sql, sql-server, sql-server-2000

表格1

```
value

100 x 200 x 300 x 400  `I want to split this row bcoz more than 2 values`
100 x 200
1300 x 1400
200 x 300 x 1200 x 2200  `I want to split this row bcoz more than 2 values`
.... 
```

值列不是固定长度的，它也可能包含`10 x 200 x 3000 x 5`

我想取前 2 个值，然后接下来的 2 个值将转到下一行`x`

我想像这样拆分行：

预期产出

```
100 x 200 
300 x 400
100 x 200
1300 x 1400
200 x 300 
1200 x 2200
.... 
```

**暗示：**

我们可以拆分每个 x 的值，然后我们可以连接 2 个值

例如`20 x 10 x 5 x 1`

像这样拆分`20, 10 5, 1`然后加入`20 x 10, 5 x 1`

上面的方法会成功，如果成功意味着我可以得到一些用于拆分和连接行的查询..

我怎样才能在 SQL 中做到这一点？

需要 SQL 查询帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T13:19:57.413

**[工作链接](http://sqlfiddle.com/#!3/2c1cc/4)**

```
SELECT Rtrim(Substring(value, 1, CHARINDEX( 'x' , value, CHARINDEX( 'x', value) + 1) - 2))
FROM (SELECT value
    FROM table1
    Where LEN(value) - LEN(REPLACE(value, 'x', '')) >= 2) as temp
UNION ALL 
SELECT Substring(value, CHARINDEX( 'x' , value, CHARINDEX( 'x', value) + 1) + 2, LEN(value))
FROM (SELECT value
FROM table1
Where LEN(value) - LEN(REPLACE(value, 'x', '')) >= 2) as temp1 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-03T13:45:03.087

好吧，如果您想要好的解决方案，那么我认为您需要创建用户定义的函数`split`，然后再次加入数据（`ntile`例如使用函数）。如果您真的只想按 2 个元素拆分，那么您可以使用这样的查询

```
select R.value
from table1 as t
   outer apply (select charindex(' x ', t.value) as c1) as c1
   outer apply (select right(t.value, len(t.value) - c1.c1 - 2) as s1) as s1
   outer apply (select charindex(' x ', s1.s1) as c2) as c2
   outer apply (select case when c2.c2 > 0 then right(s1.s1, len(s1.s1) - c2.c2 - 2) else null end as s2) as s2
   outer apply (
       select case when c2.c2 > 0 then left(t.value, c2.c2 + c1.c1 + 1) else t.value end as value
       union all
       select s2.s2
   ) as R
where R.value is not null 
```

[**SQL 提琴示例**](http://sqlfiddle.com/#!3/2c1cc/3)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-03T13:47:58.543

试试这个;

```
SELECT CASE CHARINDEX ('x',value, CHARINDEX('x',value,0)+1) 
        WHEN 0 THEN value 
        ELSE RTRIM(SUBSTRING(value,0, CHARINDEX ('x',value,
       CHARINDEX('x',value,0)+1))) END AS newValue
FROM table1
UNION ALL
SELECT LTRIM(SUBSTRING(value,
        CHARINDEX ('x',value, CHARINDEX('x',value,0)+1)+1,LEN(value))) AS newValue
WHERE CHARINDEX ('x',value, CHARINDEX('x',value,0)+1) >0
FROM table1 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-03T14:02:41.247

好的，首先你的表必须有 ID。假设 ypu 有这样的表编号：

```
NumberID Number
1        100 x 200 x 300 x 400
2        100 x 200
3        1300 x 1400    
4        200 x 200 x 200 x 200 
```

解决方案是这个查询：

```
select * from
    (
    select 
    NumberID AS 'NumberID',
    case when  CHARINDEX('X', Number, CHARINDEX ( 'X' ,Number ) +1)  = 0
                then Number
                else SUBSTRING(Number,   0, LEN(Number) -  CHARINDEX('X', Number, CHARINDEX ( 'X' ,Number ) +1 ))
                END AS Result
    from Numbers

    UNION ALL

    select 
    NumberID AS 'NumberID',
                SUBSTRING(Number,   CHARINDEX('X', Number, CHARINDEX ( 'X' ,Number ) +1 )  +2 , LEN(Number) -  CHARINDEX('X', Number, CHARINDEX ( 'X' ,Number ) +1 ))
                AS Result
    from Numbers
    WHERE CHARINDEX('X', Number, CHARINDEX ( 'X' ,Number ) +1)  <> 0
    ) t1
    ORDER BY t1.NumberID 
```

此查询的结果是：

```
1   100 x 200
1   300 x 400
2   100 x 200
3   1300 x 1400
4   200 x 200
4   200 x 200 
```

我相信这正是您要寻找的。

# java - java 位移

> ID：13209340
> 
> 赞同：0
> 
> 时间：2012-11-03T12:48:56.637
> 
> 标签：java

我的代码中有以下行：-

```
if (( checker & (1 << val)) ) return false; 
```

其中 checker 是 type `int`， val 是 type `int`。当我尝试编译相同的内容时，我得到以下信息：-

```
q11.java:38: incompatible types
found   : int
required: boolean
        if (( checker & (1 << val)) ) return false;
                      ^
1 error 
```

但是，如果我将代码修改为：-

```
if (( checker & (1 << val)) > 0 ) return false; 
```

然后我就可以编译源代码了。但是，我无法理解为什么代码最初不起作用。关于为什么会发生这种情况的一些指示？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-03T12:51:48.280

`&`是一个应用于两个整数的一元（在你的 if 条件下）产生另一个整数。但是，Java 需要`boolean`条件中的值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-03T12:51:11.060

在Java 中，您的条件必须是布尔值，即真或假。它不能是另一种类型。

如果 val == 31，您的测试应如下所示。

```
if ((checker & (1 << val)) != 0) return false; 
```

BTW C 本身没有布尔类型。它使用一个 int 值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-03T12:51:02.003

与 C 和 C++ 不同， where`if`接受整数（在许多其他类型中）并将零解释为`false`，Java 需要布尔表达式`if`,`while`等。由于`&`是产生整数的操作，因此您的第一个表达式在`if`.

当您在 Java 中重新编写 C 条件时，您需要添加`!= 0`，而不是`> 0`. 否则，最高有效位设置为的整数`1`将无法通过您的检查。

# javascript - 正确地从 javascript 中关闭 iframe 并且不隐藏 iframe

> ID：13209343
> 
> 赞同：0
> 
> 时间：2012-11-03T12:49:16.950
> 
> 标签：javascript, iframe

我想关闭一个 iframe ......当我点击关闭 btn 时，我使用了像使 iframe 可见为 false 或显示为无的代码......但这会影响我项目中的其他代码，因为 iframe 没有关闭我只是在隐藏......而且该代码在 Mozilla 和 Chrome 中也适用于隐藏 iframe 的概念。但是在 IE 中这根本不起作用......所以我尝试了一些其他方法，比如......在 ifame 页面中，在关闭 btn 点击时调用了这个函数：

```
 function closeiframecommt() {
        parent.closeiframefriends();
    } 
```

在包含 iframe 的页面中，我将代码编写为：

```
function closeiframefriends() 
{
    var friends = document.getElementById("IFriends");
    friends.style.display = "none";
} 
```

所以...这在 Mozilla 和 Chrome 中运行良好，但在 IE 中...我第一次关闭 iframe 时它会关闭，但下次我尝试打开 iframe 时会出错，并且 iframe 不能只打开...但是这个显示none 或 visible false 正在影响项目中的其他代码，所以我尝试 removechild 代码再次关闭 iframe IE 问题...所以请您帮助我使用正确的代码来关闭 iframe...当我尝试在单击 Esc 或时查找代码时iframe 之外的任何地方（iframe）都可以正常关闭，所以我想知道.. 当我们按 Esc 或单击 iframe 外部时会发生什么，iframe 会完美关闭而不会影响其他代码。

提前谢谢你！！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-03T13:01:10.937

您不会“关闭” iframe - 您将其隐藏或删除。因为隐藏它不是你的选择 - 你应该删除它。这适用于 chrome 和 IE。

```
<!DOCTYPE html>
<head>
    <title>test</title>
    <style type="text/css">
    .top {
        height:100px;
        width:200px;
        background-color:green;
    }
    </style>
    <script type="text/javascript">
    function removeIFrame() {
        var frame = document.getElementById("target");
        frame.parentNode.removeChild(frame);
    }
    </script>
</head>
<body>
    <div class="top" onclick="removeIFrame();"></div>
    <iframe id="target" src="http://www.disney.com" width="100" height="100"></iframe>
    <div class="top"></div>
</body> 
```

顶部绿色 div 的 onclick 处理从 DOM 中删除 iframe。

# java - Windows XP 进程生成器 CMD GUI

> ID：13209345
> 
> 赞同：0
> 
> 时间：2012-11-03T12:49:19.250
> 
> 标签：java, process, builder, processbuilder

我正在为 java 应用程序创建一个自动化过程。它是这样工作的。

*   应用程序运行
*   App 完成，启动 App2 并调用 System.exit
*   App2 运行
*   App2 对文件进行一些修改，然后启动 App 并调用 System.exit

所有“启动 AppX”都是使用 ProcessBuilder 完成的。

它工作正常，除了一个缺陷，即应用程序第一次关闭后 CMD 窗口丢失，这意味着我无法监控进度。

请注意，这只适用于 Windows XP SP3，因为它是唯一适用于它的系统。

# mysql - 导入数据库时 看不到表

> ID：13209349
> 
> 赞同：0
> 
> 时间：2012-11-03T12:49:51.857
> 
> 标签：mysql, sql, database, import

为什么我在 phpmyadmin 中导入数据库时​​看不到表。它向我展示了成功，但我仍然看不到任何表格。虽然如果我运行任何查询，它确实会显示结果。问题是什么？我曾尝试在网上寻找答案，但找不到任何东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T12:55:29.653

尝试单击另一个数据库以查看它是否刷新。还要检查文件 config.inc.php 以查看您的表是否被隐藏。搜索类似的行

$cfg['Servers'][$i]['hide_db'] = 'your-db-name';

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T12:47:47.923

这个问题没有答案。抱歉不得不写。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-30T18:09:27.043

您在正确的数据库中吗？您可以使用

```
show databases 
```

找出你的 MySQL 中的所有数据库。你可以使用

```
SELECT DATABASE() 
```

找出您当前的数据库。

我在想您可能在一个不是您的默认数据库的数据库中创建了数据库表。

希望这可以帮助。

# prolog - 比较计划

> ID：13209351
> 
> 赞同：1
> 
> 时间：2012-11-03T12:50:11.927
> 
> 标签：prolog, conditional, planning

我有一个项目旨在检查学生程序的正确性。我目前使用这样的方法：

1.  我指定了学生计划必须实现的目标。

2.  我将学生程序更改为一系列事实和行动（在 Prolog 中），并检查这些事实和行动是否能够满足目标。

例如，如果我要求学生编写一个程序来求 a + b 的总和，并将结果存储在 c 中，那么我将指定目标是这样的（Prolog 风格）：

```
goal:- hasVarName(VarA, a), hasVarValue(VarA, ValA),
       hasVarName(VarA, b), hasVarValue(VarB, ValB),
       hasVarName(VarC, c), hasVarValue(VarC, ValC),
       Total = ValA + ValB,
       isEqual(Total, ValC). 
```

这种方法可以很好地检查学生的顺序程序。然后，当我尝试检查包含条件的学生程序时，我才意识到可能我不能再使用这种方法了。

例如，如果我要求学生编写程序以使用以下公式从总购买中找到折扣（以美元为单位）：

. (总购买量 < 50) -> 客户获得 5% 折扣

. （50 <= 总购买量 < 100）-> 客户获得 10% 的折扣

. （总购买量 >= 100）-> 客户获得 20% 的折扣

那么我不能只写我的目标，折扣的价值（以美元计）只是总采购*百分比折扣。

我面临的一些问题：

1.  百分比折扣的值可能会根据总购买量的值而有所不同（所以我不能有一个谓词可以用来表示百分比折扣的值）

2.  Total purchase 的值是一个变量值（来自用户的输入） - 所以我永远不知道这个变量的值。因此，我也无法确定特定时间百分比折扣的价值。

3.  用户可以编写多种变体的 IF 语句，以及 IF 内的条件语句。

有人建议我使用条件规划的概念来解决这类问题。但是当我阅读一些关于条件规划的信息时，我们作为程序员指定了初始状态、计划和目标。就我而言，看起来我是必须指定目标的人，但初始状态和计划是由学生通过解析他们的代码提供的。

所以我想，这有点不同。但是，如果我的想法不正确，请告诉我，并请给我更正。

或者如果不是条件规划，我可以用什么样的方法来解决这种问题（检查学生代码的正确性）？任何信息，无论是理论上的观点还是实际实施中的信息，都非常感谢。

我有一个想法，可能我应该在学生的计划（通过解析他的代码）和我的预期计划之间做一些比较计划之类的事情。因此，如果学生的计划与我的预期计划相同或超集，那么我可以说学生计划/代码是正确的。但我想我应该以比模式匹配更好的方式进行比较（因为我猜，它只是行不通）。但是怎么做？请告诉我，如果这是我必须做的正确方法。

非常感谢。

注意：我之前在此链接中有一个相关但具体的问题： [如何在 Prolog 中编写一种条件规划？](https://stackoverflow.com/questions/13060456/how-to-write-kind-of-conditional-planning-in-prolog). 但是，我刚刚意识到那些特定的问题可能无法帮助我解决这个普遍问题。

# java - 将 C CRC16 转换为 Java CRC16

> ID：13209364
> 
> 赞同：8
> 
> 时间：2012-11-03T12:51:19.283
> 
> 标签：java, c, crc

我目前正在做一个项目，有一个嵌入式系统通过无线电将数据发送到 PC。数据包最后得到一个 crc16 校验和，它是根据这个算法计算的：

```
uint16_t crc16 (const uint8_t * buffer, uint32_t size) {
    uint16_t crc = 0xFFFF;

    if (buffer && size)
        while (size--)
        {
            crc = (crc >> 8) | (crc << 8);
            crc ^= *buffer++;
            crc ^= ((unsigned char) crc) >> 4;
            crc ^= crc << 12;
            crc ^= (crc & 0xFF) << 5;
        }

    return crc;
} 
```

现在我正在寻找 Java 中的等价物。我已经在这里找到了一个很好的：http: [//introcs.cs.princeton.edu/java/51data/CRC16CCITT.java.html](http://introcs.cs.princeton.edu/java/51data/CRC16CCITT.java.html)

```
public class CRC16CCITT { 

    public static void main(String[] args) { 
        int crc = 0xFFFF;          // initial value
        int polynomial = 0x1021;   // 0001 0000 0010 0001  (0, 5, 12) 

        // byte[] testBytes = "123456789".getBytes("ASCII");

        byte[] bytes = args[0].getBytes();

        for (byte b : bytes) {
            for (int i = 0; i < 8; i++) {
                boolean bit = ((b   >> (7-i) & 1) == 1);
                boolean c15 = ((crc >> 15    & 1) == 1);
                crc <<= 1;
                if (c15 ^ bit) crc ^= polynomial;
             }
        }

        crc &= 0xffff;
        System.out.println("CRC16-CCITT = " + Integer.toHexString(crc));
    }

} 
```

但这不适用于我的 C 代码。

是否有人能够为 C 和 Java 等效算法提供适应或解决方案？谢谢！

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-11-03T12:59:25.503

在这种情况下，java 和 c 之间的主要区别在于，在 c 中您使用无符号数字，而 java 只有有符号数字。虽然您可以使用带符号的数字实现相同的算法，但您必须意识到符号位在移位操作中被传递，需要额外的“与”。

这是我的实现：

```
static int crc16(final byte[] buffer) {
    int crc = 0xFFFF;

    for (int j = 0; j < buffer.length ; j++) {
        crc = ((crc  >>> 8) | (crc  << 8) )& 0xffff;
        crc ^= (buffer[j] & 0xff);//byte to int, trunc sign
        crc ^= ((crc & 0xff) >> 4);
        crc ^= (crc << 12) & 0xffff;
        crc ^= ((crc & 0xFF) << 5) & 0xffff;
    }
    crc &= 0xffff;
    return crc;

} 
```

# asp.net - 带有文件夹中的分页和图像的 ASP.Net Gridview

> ID：13209372
> 
> 赞同：0
> 
> 时间：2012-11-03T12:52:09.263
> 
> 标签：asp.net

我想知道它是一个gridview控件还是通过使用表来完成的？？？或者我知道此网格中使用的图像来自文件夹。我想开发同样的东西需要你的帮助。不知道该怎么做。我只知道如何使用gridview。感谢并等待您的回复。

[http://www.propertyguru.com.sg/singapore-property-listing?listing_type=sale&search_type=district&property_id=&interest=&distance=1&property_type=&freetext=&districts%5B%5D=&hdb_estate=&maxprice=&maxbed=&minbed=&minsize=&searchbtn=去](http://www.propertyguru.com.sg/singapore-property-listing?listing_type=sale&search_type=district&property_id=&interest=&distance=1&property_type=&freetext=&districts%5B%5D=&hdb_estate=&maxprice=&maxbed=&minbed=&minsize=&searchbtn=go)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T13:22:45.403

有很多方法可以做到这一点。您可以使用 ASP.NET MVC。如果您坚持使用 ASP.NET Web 窗体，您可以使用 GridView、ListView、Repeater 等。我建议使用 ListView。它结合了 GridView 和 Repeater 的许多最佳功能。

这是一个快速教程，介绍如何使用 ListView 显示产品列表，包括图像。它看起来与您的示例不一样，但想法是您可以使用一点 HTML/CSS 知识来设置您想要的样式。

[http://weblogs.asp.net/scottgu/archive/2007/08/10/the-asp-listview-control-part-1-building-a-product-listing-page-with-clean-css-ui。 aspx](http://weblogs.asp.net/scottgu/archive/2007/08/10/the-asp-listview-control-part-1-building-a-product-listing-page-with-clean-css-ui.aspx)

这是另一篇描述 ListView 控件以及为什么它可能比 GridView 更适合的文章：

[http://www.developerfusion.com/article/84471/new-trends-in-aspnet-data-binding-the-listview-control/](http://www.developerfusion.com/article/84471/new-trends-in-aspnet-data-binding-the-listview-control/)

如果您决定坚持使用 GridView，这里有一个关于从 GridView 显示图像的堆栈溢出问题。答案中有一些有用的链接：

[如何在gridview中显示文件夹中的图像？](https://stackoverflow.com/questions/4020739/how-to-display-images-from-a-folder-in-a-gridview?rq=1)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T13:24:22.650

要在 ASP.NET WebForms 中开发相同类型的网格，最简单的方法是使用 ListView 控件。它允许您为每一行定义一个模板，并像 gridview 一样创建一个寻呼机。可以在此处找到有关列表视图的文档：http: [//msdn.microsoft.com/en-us/library/bb398790%28v=vs.100%29.aspx](http://msdn.microsoft.com/en-us/library/bb398790%28v=vs.100%29.aspx)

# matlab - Matlab，2点之间的直线，n点之间

> ID：13209373
> 
> 赞同：2
> 
> 时间：2012-11-03T12:52:13.060
> 
> 标签：matlab, linear-interpolation

我想制作一个需要 2 个数据点的函数：`(x1, y1)`和`(x2, y2)`.

然后我想返回一个函数`f`，它是点之间的直线，`N`点之间有点。

如果我接受 2 个数据点的 x 和 y 坐标，那么我可以这样做：

```
step_size = (x2 - x1) / N;
range = x1:step_size:x2; 
```

接着：

```
f = ((y2 - y1)/(x2 - x1)) * range + ((y1/x1) * ((x2 - x1)/(y2 - y1))); 
```

这足够了吗？

此外，我一直在网上搜索，但找不到任何可以做到这一点的功能。但如果有那么请指教。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T13:05:49.963

你正在寻找`linspace`. 例如，定义

```
x1 = 0; y1 = 0; x2 = 4; y2 = 4; npoints=6; 
```

然后

```
[linspace(x(1),y(1),npoints);linspace(x(2),y(2),npoints)] 
```

评估为：

```
ans =

         0    0.8000    1.6000    2.4000    3.2000    4.0000
         0    0.8000    1.6000    2.4000    3.2000    4.0000 
```

这可能不是你想要的，但我想你可以弄清楚其余的。

此外，如果您键入，`edit linspace.m`您可以看到该函数是如何实现的，如果您想创建自己的版本，可能适用于 2 元素向量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-03T17:11:25.133

如果您想要一个返回另一个函数的函数来创建该行，请查看[匿名函数](http://www.mathworks.nl/help/matlab/matlab_prog/anonymous-functions.html)：

```
function fun = makelinefun(x1,y1,x2,y2)
    fun  = @(N) [linspace(x1,x2,N) ; linspace(y1,y2,N)];
end 
```

您用作：

```
f = makelinefun(0,0,6,9);
xy = f(4)

  xy =
      0     2     4     6
      0     3     6     9 
```

或具有[多个输出参数](http://blogs.mathworks.com/loren/2007/01/31/multiple-outputs/)：

```
function fun  = makelinefun(x1,y1,x2,y2)
    fun  = @(N) deal(linspace(x1,x2,N), linspace(y1,y2,N));
end 
```

您用作：

```
f = makelinefun(0,0,6,9);
[x,y] = f(4)

  x =
      0     2     4     6
  y =
      0     3     6     9 
```

# activerecord - Yii Model 类列属性不匹配

> ID：13209376
> 
> 赞同：0
> 
> 时间：2012-11-03T12:52:34.123
> 
> 标签：activerecord, model, yii

Active Record 属性与模型类中的属性有何不同？我有一个用户模型，其中有一个来自名为 dob 的数据库的列。我不会接受用户作为一个整体的 dob，因此规则功能不会有任何与 dob 相关的内容，而是“日期、月份、年份”

```
 array('date, month, year', 'validDate'), 
```

我正在这样做

```
public function afterValidate()
{
parent::afterValidate();
$this->date_of_birth = date("Y-m-d", strtotime($this->year."".$this->month."".$this->date));
} 
```

将记录的值保存在数据库中。我不太确定它是 Active Reocrd 事物还是模型，但存储的日期不是用户输入的内容，而是 1970-01-01 Unix 默认值，所以我肯定会做错事。PS我的日期月份和年份在规则中是安全的。验证日期代码

```
public function validDate($attributes, $params)
{
   if($this->scenario == 'registration-general')
   {
     if($this->month == 0)
        $this->addError('month','Month cannot be blank');
    elseif(0 > $this->month || $this->month > 12)
        $this->addError('month','Enter a valid month');
   }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T05:54:20.933

确保在模型中定义年、月和日。

```
public $year;
public $month;
public $date; 
```

如果未定义这些，则它们不会在大规模分配（或任何分配）期间被分配，并且您的代码（在我的系统上测试过）将返回 1970-01-01。

还将您的 strtotime 参数更改为：

```
$this->year."-".$this->month."-".$this->date 
```

使用连字符，您可以使用 1 或 2 位数的月份和日期格式。如果没有连字符，您需要使用 2 位数字，但在您的代码中注明建议您保证这一点。

上述任何一个问题都可能导致您的代码失败。确保这些是固定的，然后看看它是否有效。

编辑：除非您作为参数传递，否则该`save()`方法会调用该方法。如果在和之间未设置年、月和日期，则第二次运行验证将删除该属性。`validate()``false``validate``save``dob`

简而言之，`save(false)`如果您`validate()`在脚本的前面使用过，请调用保存。

# java - 当我面向较旧的 Android 设备时，我应该使用哪个版本的 Google API？

> ID：13209382
> 
> 赞同：0
> 
> 时间：2012-11-03T12:53:28.553
> 
> 标签：java, android, android-compatibility

我有一个为 API 15 及以上设备（即 ICS）设计的 Android 应用程序。现在我还想针对 API 10 设备，即 Gingerbread。为了做到这一点，我使用了 ActionBarSherlock。

好的，所以我按照文档找到了 Sherlock。我更新了我的代码。我有一项活动是`MapActivity`，这需要替换为`SherlockMapActivity`. 完毕。

在我的项目的构建目标中，我将目标指定为“Google APIs for API 15”。在我的应用程序清单文件中，我将最低 SDK 要求设置为 API 10。现在，当我创建 Gingerbread 模拟器并尝试启动我的应用程序时，我收到以下错误：

> 包 com.mridang.soemthing 需要不可用的共享库 com.google.android.maps；失败！

我知道这是因为 Gingerbread 缺少“适用于 API 15 的 Google API”，这是可以理解的，但如果我将项目的构建目标设置为“适用于 API 10 的 Google API”，那么我将无法使用我拥有的代码块使用`CalendarContract`仅在未来的 API 中出现的。

这似乎是 Catch-22 的情况，我似乎无法理解如何让我的应用程序在这两种设备上运行。有什么帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T13:21:50.163

> 您不能在运行低于 API 级别 14 的 Android 设备上使用**CalendarContract 。**

[您可以在Commonsware](http://commonsware.com/blog/2012/05/24/community-driven-compatibility-library.html) Blog Spot 上获得更多详细信息。

# php - 阻止不应该公开使用的 php 函数

> ID：13209383
> 
> 赞同：1
> 
> 时间：2012-11-03T12:53:28.880
> 
> 标签：php, security

> **可能重复：**
> [可利用的 PHP 函数](https://stackoverflow.com/questions/3115559/exploitable-php-functions)

我的问题是关于**disable_functions**。请问在线用户在使用在线 PHP 编辑器时容易受到攻击的函数列表。像[http://writecodeonline.com/php/](http://writecodeonline.com/php/)这个编辑器阻止了许多功能。我发现其中很少有

> disable_functions = “apache_child_terminate、apache_setenv、define_syslog_variables、escapeshellarg、escapeshellcmd、eval、exec、dl、fsocket、pfsockopen、fsockopen、fp、fput、ftp_connect、ftp_exec、ftp_get、ftp_login、ftp_nb_fput、ftp_put、ftp_raw、fttp_rawlist、highlight_getalfile、i , ini_restore, inject_code, mysql_pconnect, openlog, phpinfo, passthru, php_uname, phpAds_remoteInfo, phpAds_XmlRpc, phpAds_xmlrpcDecode, phpAds_xmlrpcEncode, popen, posix_getpwuid, posix_kill, posix_mkfifo, posix_setpgid, posix_setsid, posix_setuid, posix_setuid, posix_uname, proc_close, proc_get_status, proc_nice, proc_open, proc_terminate , shell_exec, syslog, system, system,proc_open, symlink, xmlrpc_entity_decode, popen, curl_exec, curl_multi_exec, parse_ini_file, show_source”

感谢[http://www.jonboy60.com/2010/05/04/disable_function-on-php-ini/](http://www.jonboy60.com/2010/05/04/disable_function-on-php-ini/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T13:00:56.297

我没有明确的列表 - 但任何使用的函数

*   网络
*   磁盘
*   干扰 Apache（或其他网络浏览器）
*   猜猜可能与数据库有关

可能被密码键盘挡住了。我还可以想象内存使用的上限非常严格。

只需将这些站点用于最少的内容，只是为了向其他人（例如本站点上的人）展示问题。

# ruby-on-rails - 两个表之间的连接在 Activerecord 中失败，出现未初始化的常量错误

> ID：13209384
> 
> 赞同：1
> 
> 时间：2012-11-03T12:53:31.660
> 
> 标签：ruby-on-rails, ruby, postgresql, activerecord, join

使用 Activerecord（在 postgresql 数据库上）该程序应该在表“cars”和“car_parts”之间进行简单的**内部连接。**两个表都存在于数据库中，都填充了数据，并且键由 activerecord 约定命名（即，两个表中的主键都命名为“id”；链接到“cars”的“car_parts”中的外键命名为“car_id” ）。我通过在 Activerecord 中使用“include”和“join”尝试了两种选择——不幸的是，两者都失败了，并显示以下消息。任何帮助表示赞赏，谢谢！我的程序：

```
require 'active_record'

ActiveRecord::Base.establish_connection(
    # details left out
)

class Car < ActiveRecord::Base
  has_many :car_parts
end

class Car_Part < ActiveRecord::Base
  belongs_to :car
end

results2 = Car.joins(:car_parts)
results2.each{|row|  puts row.id}

results3 = Car.find :all, :include => [:car_parts]
results3.each{|row|  puts row.id} 
```

对于 results2 和 results3，我都会收到错误消息：“/home/myname/.rvm/gems/ruby-1.9.3-p194@global/gems/activerecord-3.2.8/lib/active_record/inheritance.rb:111:在 `compute_type' 中：未初始化的常量 Car::CarPart (NameError)"

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-03T13:44:55.857

您正在混合命名约定。:car_parts 指的是一个名为 CarPart 的类，而您将其称为 Car_Part。尝试将其重命名为 CarPart。（并接受下一个问题！:-)）

Active Record 认为单词的驼峰式部分应该翻译成一个下划线。

# c# - 使用 C# 为 PokerStars 创建 HUD

> ID：13209385
> 
> 赞同：2
> 
> 时间：2012-11-03T12:53:34.947
> 
> 标签：c#, winforms, hud

我想为 PokerStars 创建一个类似于 Holdem Manager 的 HUD：

[截屏](http://www.winallpoker.com/wp-content/uploads/pokerstars-hud.jpg)

我正在使用 Visual Studio 和 C# 语言，以及 Windows 7 64 位。HUD 将显示一些带有一些信息的框。这些框必须是可拖动的和半透明的，并且用户可以设置它们的不透明度。当鼠标悬停在其中一个框上时，会显示附加信息。我无法控制拥有 HUD 的 PokerStars 窗口，即我无法在 Visual Studio 中对其进行编辑。我需要一些关于如何实现这一目标的建议，以及做到这一点的最佳方法是什么。

我的第一次尝试是通过 PInvoke 使用带有 SetParent 功能的 Windows 窗体，但透明度不起作用：

我的 HUD 只是一组半透明的盒子，它们必须为它们所连接的窗口提供额外的信息。问题是当我的 hud 元素位于另一个应用程序的表单中时，我无法使它成为半透明的。我的 hud 元素是一个继承自 Form 类的框。它只是一个无边框的表单（BorderStyle 设置为“无”，100% 不透明度），里面有一些彩色标签，创建时没有添加代码。所以，我有一个名为 Form1 的主窗体类和另一个名为 HUDBox 的窗体类，这是我想在 Form1 中显示的 hud 元素。两者都继承自 Form 类。如果我将 HUDBox 对象的不透明度设置为小于 100%，HUDBox 对象就不会显示在 Form1 对象内。我也尝试过使用 TransparencyKey，SetWindowLong 和 SetLayeredWindowAttributes 通过 PInvoke 但它使所有内容都透明，而不仅仅是 HUDBox 对象。这是代码：

程序.cs：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Windows.Forms;
using System.Diagnostics;
using System.Runtime.InteropServices;
using System.Text;

namespace MyHUD
{
    public static class Program
    {
        public static Form1 mainForm;

        [STAThread]
        static void Main()
        {
            Application.EnableVisualStyles();
            Application.SetCompatibleTextRenderingDefault(false);
            mainForm = new Form1();
            HUD psHUD = new HUD();
            Application.Run(mainForm);
        }
    }
} 
```

HUD.cs：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Runtime.InteropServices;
using System.Diagnostics;
using System.Drawing;

namespace MyHUD
{

    class HUD
    {
        private static int HOW_MANY_HUDBOXES = 4;

        [DllImport("user32.dll", SetLastError = true)]
        static extern IntPtr SetParent(IntPtr hWndChild, IntPtr hWndNewParent);

        private List<HUDBox> hudBoxes = new List<HUDBox>(HOW_MANY_HUDBOXES);

        public HUD()
        {
            initHudBoxes();
        }

        private void initHudBoxes()
        {
            for (int hb = 0; hb < HOW_MANY_HUDBOXES; hb++)
            {
                HUDBox newHudBox = new HUDBox();
                hudBoxes.Add(newHudBox);
                //SetParent(newHudBox.Handle, Program.mainForm.Handle);
                newHudBox.Show();
            }
            UserControl1 control = new UserControl1();
            SetParent(control.Handle, Program.mainForm.Handle);
            control.Show();
        }

    }
} 
```

HUDBox.cs 和 Form1.cs 的代码不相关，因为它们是简单的自动生成的表单。这个程序在主窗体中添加了 4 个我的 hud 元素的副本。我的 Form1 类仅用于测试，它将被外部 PokerStars 窗口所取代。当我不使用 SetParent 函数时，Opacity 对我的 hud 框效果很好，因为它们没有设置为 Form1 的子项。

我还尝试使用 UserControl 而不是我的 HUDBox 表单：UserControl1.cs：

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Drawing;
using System.Data;
using System.Linq;
using System.Text;
using System.Windows.Forms;

namespace MyHUD
{
    public partial class UserControl1 : UserControl
    {
        public UserControl1()
        {
            InitializeComponent();
            SetStyle(ControlStyles.SupportsTransparentBackColor, true);
            this.BackColor = Color.FromArgb(127, 0, 0, 255);
        }

        private void UserControl1_Load(object sender, EventArgs e)
        {

        }
    }
} 
```

我已经使用 VisualStudio 手动将此 UserControl1 添加到 Form1 中，并且它以正确的不透明度显示正常，但随后我通过 SetParent 添加了另一个 UserControl1 并且透明度不起作用：

[截屏](http://i.stack.imgur.com/VDchg.jpg)

我也尝试使用以下功能的组合，但没有任何效果，透明度应用于整个窗口，而不是其中的 hud 元素：

```
[DllImport("user32.dll")]
        static extern int SetWindowLong(IntPtr hWnd, int nIndex, int dwNewLong);
        [DllImport("user32.dll")]
        static extern bool SetLayeredWindowAttributes(IntPtr hwnd, uint crKey, byte bAlpha, uint dwFlags);
        [DllImport("user32.dll", SetLastError=true)]
        static extern int GetWindowLong(IntPtr hWnd, int nIndex);

        public const int GWL_EXSTYLE = -20;
        public const int WS_EX_LAYERED = 0x80000;
        public const int LWA_ALPHA = 0x2;
        public const int LWA_COLORKEY = 0x1;

        //set the window style to alpha appearance
        private void setWindowOpacity(IntPtr handle, byte opacity)
        {
            SetLayeredWindowAttributes(handle, 0, opacity, LWA_ALPHA);
        }

        private void setWindowLayered(IntPtr handle)
        {
            SetWindowLong(handle, GWL_EXSTYLE, GetWindowLong(handle, GWL_EXSTYLE) ^ WS_EX_LAYERED);
        } 
```

有没有办法让我的扑克之星窗口的 hud 元素保持正确的透明度？

有没有另一种方法来创建这个HUD，也许是使用GDI？

# php - 我在 Chrome 中看不到带有 onmessage 方法的 HTML5 EventSource 事件

> ID：13209386
> 
> 赞同：40
> 
> 时间：2012-11-03T12:53:39.677
> 
> 标签：php, javascript, html

我试着`EventSource`用一个小例子来使用这个对象

在客户端，我有这个页面，其中包含以下脚本：

```
<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8" />
        <title>Welcome!</title>
    </head>
    <body>
        <div id="result"></div>
        <script type="text/javascript">
        var sse = new EventSource('event-source.php');

        sse.onmessage = function(event) {
            console.log(event.data);
            document.getElementById("result").innerHTML+=event.data + "<br>";
        }

        sse.onerror = function(event) {
        console.log(event);
        }

        </script>
    </body>
</html> 
```

脚本在服务器上调用 event-source.php。这是 event-source.php ：

```
<?php
header('Content-type: text/event-stream');
echo 'data: '.time().PHP_EOL; 
```

当我在 Firefox 上尝试此配置时，“onMessage”方法被很好地调用，但在 Chrome 中却没有。当我放置“onError”方法时，它似乎被调用但我看不到错误原因。

我应该怎么办？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-01-20T00:12:01.350

客户

```
<script>
if(typeof(EventSource) !== "undefined") {
var source = new EventSource("/html/demo_sse.php");
source.onopen = function() {
document.getElementById("myH1").innerHTML = "Getting server updates";
};
source.onmessage = function(event) {
document.getElementById("myDIV").innerHTML += event.data + "<br>";
};        
} else {
document.getElementById("myDIV").innerHTML = "Sorry, your browser does not support server-sent events...";
}
</script> 
```

服务器

```
<?php
    header('Content-Type: text/event-stream');
    header('Cache-Control: no-cache');

    $time = date('r');
    echo "data: The server time is: {$time}\n\n";
    flush();
    ?> 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2014-02-03T11:11:19.290

在`onmessage`你调用想要的对象属性时，你为什么不这样做`onerror`呢？
我认为你`onerror`应该是这样的：

```
 sse.onerror = function(event) {
      console.log(event.message);
   } 
```

**说明：** [https](https://developer.mozilla.org/en-US/docs/Server-sent_events/Using_server-sent_events) ://developer.mozilla.org/en-US/docs/Server-sent_events/Using_server-sent_events - 此链接显示“发生问题时（...），会生成**错误事件。”**

因此，当自定义错误处理时，您应该了解**ErrorEvent**结构:) 它是这样的：

1.  **错误事件。*message***（只读）是一个 DOMString ，其中包含描述问题的人类可读错误消息。
2.  **错误事件。*filename***（只读）是一个 DOMString，其中包含发生错误的脚本文件的名称。
3.  **错误事件。*lineno***（只读）是一个整数，包含发生错误的脚本文件的行号。
4.  **错误事件。*column***（只读）是一个整数，包含发生错误的脚本文件的列号。
5.  **错误事件。*error***（只读）是事件所关注的 JavaScript 对象。

更多信息和来源：[https ://developer.mozilla.org/en-US/docs/Web/API/ErrorEvent](https://developer.mozilla.org/en-US/docs/Web/API/ErrorEvent)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2020-09-13T20:43:18.013

这个话题太老了。但即使在今天，我有时也会看到`onmessage`与 EventSource 一起使用时的混合行为。

到目前为止，我在以下变体方面取得了很大成功

```
<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8" />
        <title>Welcome!</title>
    </head>
    <body>
        <div id="result"></div>
        <script type="text/javascript">
        var sse = new EventSource('event-source.php');

        sse.addEventListener('message', function(event) {
            console.log(event.data);
            document.getElementById("result").innerHTML+=event.data + "<br>";
        });

        sse.addEventListener('error', function(event) {
            console.log(event);
        });

        </script>
    </body>
</html> 
```

# c# - 如何将 UTF-8 字符转换为字符串？

> ID：13209389
> 
> 赞同：0
> 
> 时间：2012-11-03T12:54:08.640
> 
> 标签：c#, html, utf-8, converter

以下网址：

> [http://www.thecage.co.il/online_users.json.js?r=](http://www.thecage.co.il/online_users.json.js?r=)

响应带有一些奇怪字符的字符串（您可以浏览并查看）我正在尝试将其转换为真正的字符串（我知道它应该是希伯来语）。

我的代码：

```
string html = client.DownloadString(SITE_URL).Replace("\"", string.Empty); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-03T13:03:01.943

将 webclient 的编码设置为 UTF-8：

```
WebClient client = new WebClient();
client.Encoding = System.Text.Encoding.UTF8;
string html = client.DownloadString(SITE_URL).Replace("\"", string.Empty); 
```

# ubuntu - 无法克隆 gloox 存储库

> ID：13209392
> 
> 赞同：-3
> 
> 时间：2012-11-03T12:54:43.663
> 
> 标签：ubuntu, repository

我想为 iOS 下载[gloox lib](http://code.google.com/p/gloox-for-ios/source/checkout)。而我不能。我在 Ubuntu 上。我已经下载了 SVN、Git 和其他 VCS。

我尝试输入他们的 SVN 结帐命令：

```
$ svn checkout http://gloox-for-ios.googlecode.com/svn/trunk/ gloox-for-ios-read-only 
```

但它因错误 400 或类似的错误而失败。

将其克隆为 Git 存储库也失败了：

```
$ git clone http://gloox-for-ios.googlecode.com/svn/trunk/ gloox-for-ios-read-only 
```

> 错误“致命：未找到[http://gloox-for-ios.googlecode.com/svn/trunk/info/refs](http://gloox-for-ios.googlecode.com/svn/trunk/info/refs)：您是否在服务器上运行了 git update-server-info？”

我想不出还有什么可做的！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T13:18:59.210

命令行：

```
svn checkout http://gloox-for-ios.googlecode.com/svn/trunk/ gloox-for-ios-read-only 
```

为我工作。您无法复制和粘贴，或者您有网络问题。

# c# - 使用 C# 启用/禁用 MSCONFIG 启动项

> ID：13209395
> 
> 赞同：1
> 
> 时间：2012-11-03T12:55:04.620
> 
> 标签：c#

```
RegistryKey HCU = Registry.CurrentUser.OpenSubKey("Software\\Microsoft\\Windows\\CurrentVersion\\Run", true);
        foreach (string Programs in HCU.GetValueNames())
        {
            row = dt.NewRow();
            row["Item Name"] = Programs;
            dt.Rows.Add(row);
        }

        RegistryKey HLM = Registry.LocalMachine.OpenSubKey("Software\\Microsoft\\Windows\\CurrentVersion\\Run", true);
        foreach (string Programs in HLM.GetValueNames())
        {

            row = dt.NewRow();
            row["Item Name"] = Programs;
            dt.Rows.Add(row);
        }

        DirectoryInfo di = new DirectoryInfo(@"C:\Users\DEV2\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup");
        FileInfo[] rgFiles = di.GetFiles("*.*");
        foreach (FileInfo fi in rgFiles)
        {
            if ((fi.Attributes & FileAttributes.Hidden) != FileAttributes.Hidden)
            {
                row = dt.NewRow();
                row["Item Name"] = fi.Name;
                dt.Rows.Add(row);
            }

        }

        RegistryKey HKLM = Registry.LocalMachine.OpenSubKey("SOFTWARE\\Microsoft\\Shared Tools\\MSConfig\\startupreg", true);
        foreach (string Programs in HKLM.GetSubKeyNames())
        {
            // string GetFilePath = HKCU.GetValue(Programs).ToString();

            row = dt.NewRow();
            row["Item Name"] = Programs;
           // row["Location"] = "HKLM\\SOFTWARE\\Microsoft\\Shared Tools\\MSConfig\\startupreg";
            dt.Rows.Add(row);
        }

        RegistryKey HKLM2 = Registry.LocalMachine.OpenSubKey("SOFTWARE\\Microsoft\\Shared Tools\\MSConfig\\startupfolder", true);
        foreach (string Programs in HKLM2.GetSubKeyNames())
        {

            RegistryKey productKey = HKLM2.OpenSubKey(Programs);
            if (productKey != null)
            {
                foreach (string value in productKey.GetValueNames())
                {
                    if (value == "item")
                    {
                        row = dt.NewRow();
                        row["Item Name"] = Convert.ToString(productKey.GetValue("item"));
                        // row["Location"] = "HKLM\\SOFTWARE\\Microsoft\\Shared Tools\\MSConfig\\startupreg";
                        dt.Rows.Add(row);
                    }
                }
            }
        }

        uxDgvStartupItems.DataSource = dt;

        DataGridViewColumn column = uxDgvStartupItems.Columns["Item Name"];
        column.Width = 600;

        foreach (DataGridViewRow ro in uxDgvStartupItems.Rows)
        {

                DataGridViewCheckBoxCell ch1 = (DataGridViewCheckBoxCell)ro.Cells[0];
                ch1.Value = true;

        }

        RegistryKey HKCU3 = Registry.LocalMachine.OpenSubKey("SOFTWARE\\Microsoft\\Shared Tools\\MSConfig\\startupfolder", true);
        foreach (string Programs in HKCU3.GetSubKeyNames())
        {

               RegistryKey productKey = HKLM2.OpenSubKey(Programs);
               if (productKey != null)
               {
                   foreach (string value in productKey.GetValueNames())
                   {
                       if (value == "item")
                       {
                           string txt = Convert.ToString(productKey.GetValue("item"));

                           foreach (DataGridViewRow ro in uxDgvStartupItems.Rows)
                           {
                               string txt1 = ro.Cells[1].Value.ToString();
                               if (txt == txt1)
                               {
                                   var ch2 = (DataGridViewCheckBoxCell) ro.Cells[0];
                                   ch2.Value = false;
                               }
                           }
                       }
                   }
               }
        }

        RegistryKey HKCU1 = Registry.LocalMachine.OpenSubKey("SOFTWARE\\Microsoft\\Shared Tools\\MSConfig\\startupreg", true);
        foreach (string Programs in HKCU1.GetSubKeyNames())
        {
            string txt = Programs;

            foreach (DataGridViewRow ro in uxDgvStartupItems.Rows)
            {
                string txt1 = ro.Cells[1].Value.ToString();
                //var txt1 = uxDgvStartupItems.Rows[uxDgvStartupItems.CurrentCell.RowIndex].Cells[1].FormattedValue.ToString();
                if (txt == txt1)
                {
                    var ch2 = (DataGridViewCheckBoxCell)ro.Cells[0];
                    ch2.Value = false;
                }
            }
        }
        HKCU1.Close(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T12:05:40.130

使用 C# 窗口应用程序启用或禁用 MSconfig 启动项的答案

```
private void uxSave_Click(object sender, EventArgs e)       
{
string username = Environment.UserName;
            if (MessageBox.Show("Are you sure to change startup of Item(s)?", "Confirm Startup", MessageBoxButtons.YesNo) == DialogResult.Yes)
            {

                for (int j = 0; j < list.Count; j++)
                {
                    if (j%2 == 0)
                        list1.Add(list[j]);

                }

               foreach (DataGridViewRow ro in uxDgvStartupItems.Rows)
                {
                    var cellname = (DataGridViewTextBoxCell) ro.Cells[1];
                    string x = Convert.ToString(cellname.Value);
                    foreach (string i in list1)
                    {
                       if (i == x)
                        {
                            string name = i;
                            var sourcee = (DataGridViewTextBoxCell)ro.Cells[2];
                            string source = Convert.ToString(sourcee.Value);
                            var CbxCell = (DataGridViewCheckBoxCell)ro.Cells[0];

                            if ((bool)CbxCell.Value == true)
                            {
                                int flag = 0;
                                string itemname = "";
                                RegistryKey HKLM2 =
                                    Registry.LocalMachine.OpenSubKey("SOFTWARE\\Microsoft\\Shared Tools\\MSConfig\\startupreg",
                                                                     true);
                                foreach (string Programs in HKLM2.GetSubKeyNames())
                                {

                                    RegistryKey productKey = HKLM2.OpenSubKey(Programs);
                                    if (productKey != null)
                                    {
                                        foreach (string value in productKey.GetValueNames())
                                        {
                                            if (value == "item")
                                            {
                                                string txt = Convert.ToString(productKey.GetValue("item"));

                                                if (txt == name)
                                                {
                                                    itemname = Convert.ToString(productKey.GetValue("command"));
                                                    HKLM2.DeleteSubKey(name, false);
                                                    flag = 1;

                                                }

                                            }
                                        }
                                    }
                                }

                                RegistryKey HKLM4 =
                                    Registry.LocalMachine.OpenSubKey(
                                        "SOFTWARE\\Microsoft\\Shared Tools\\MSConfig\\startupfolder", true);
                                foreach (string Programs in HKLM4.GetSubKeyNames())
                                {

                                    RegistryKey productKey = HKLM4.OpenSubKey(Programs);
                                    if (productKey != null)
                                    {
                                        foreach (string value in productKey.GetValueNames())
                                        {
                                            if (value == "item")
                                            {
                                                string txt = Convert.ToString(productKey.GetValue("item"));

                                                if (txt == name)
                                                {
                                                    HKLM4.DeleteSubKey(Programs, false);
                                                    flag = 2;
                                                }

                                            }
                                        }
                                    }
                                }

                                if (flag == 1)
                                {
                                    RegistryKey startupKey =
                                        Registry.LocalMachine.CreateSubKey("SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run");
                                    startupKey.SetValue(name, itemname);
                                    startupKey.Close();
                                }

                                if (flag == 2)
                                {
                                    string path = "C:\\Users\\" + username + "\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup";
                                    DirectoryInfo di = new DirectoryInfo(targetPath);
                                    FileInfo[] rgFiles = di.GetFiles("*.*");
                                    foreach (FileInfo fi in rgFiles)
                                    {
                                        string itemName = fi.Name;
                                        itemName = itemName.Substring(0, itemName.LastIndexOf('.'));

                                        if (itemName == name)
                                        {

                                            string sourceFile = Path.Combine(targetPath, name + ".lnk");
                                            string destFile = Path.Combine(path, name + ".lnk");

                                            File.Copy(sourceFile, destFile, true);
                                            fi.Delete();

                                            fi.Delete();

                                        }

                                    }

                                }

                            }
                            else
                            {

                                if (source == "registry")
                                {
                                    int flag = 0;
                                    string path = "";
                                    RegistryKey startupKey =
                                        Registry.LocalMachine.OpenSubKey("SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run",
                                                                         true);
                                    foreach (string Programs in startupKey.GetValueNames())
                                    {
                                        if (Programs == name)
                                        {
                                            path = Convert.ToString(startupKey.GetValue(name));
                                            startupKey.DeleteValue(name, false);
                                            startupKey.Close();
                                            flag = 1;
                                        }

                                    }

                                    if (flag == 0)
                                    {
                                        RegistryKey startupKey1 =
                                            Registry.CurrentUser.OpenSubKey(
                                                "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run", true);
                                        foreach (string Programs in startupKey1.GetValueNames())
                                        {
                                            if (Programs == name)
                                            {
                                                path = Convert.ToString(startupKey1.GetValue(name));
                                                startupKey1.DeleteValue(name, false);
                                                startupKey1.Close();
                                            }

                                        }
                                    }

                                    RegistryKey HKCU =
                                        Registry.LocalMachine.OpenSubKey(
                                            "SOFTWARE\\Microsoft\\Shared Tools\\MSConfig\\startupreg", true);
                                    RegistryKey HKCU1 = HKCU.CreateSubKey(name);
                                    HKCU1.SetValue("command", path);
                                    HKCU1.SetValue("hkey", "HKLM");
                                    HKCU1.SetValue("inimapping", "0");
                                    HKCU1.SetValue("item", name);
                                    HKCU1.SetValue("key", "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run");
                                    HKCU1.SetValue("DAY", DateTime.Now.Day);
                                    HKCU1.SetValue("MONTH", DateTime.Now.Month);
                                    HKCU1.SetValue("YEAR", DateTime.Now.Year);
                                    HKCU1.SetValue("HOUR", DateTime.Now.Hour);
                                    HKCU1.SetValue("MINUTE", DateTime.Now.Minute);
                                    HKCU1.SetValue("SECOND", DateTime.Now.Second);
                                }

                                if (source == "folder")
                                {
                                    string path = "C:^Users^" + username + "^AppData^Roaming^Microsoft^Windows^Start Menu^Programs^Startup";
                                    string path1 = "C:\\Users\\" + username + "\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup";

                                    DirectoryInfo di =
                                        new DirectoryInfo("C:\\Users\\" + username + "\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup");
                                    FileInfo[] rgFiles = di.GetFiles("*.*");
                                    foreach (FileInfo fi in rgFiles)
                                    {
                                        string itemName = fi.Name;
                                      itemName = itemName.Substring(0, itemName.LastIndexOf('.'));

                                        if (itemName == name)
                                        {
                                            string sourceFile = Path.Combine(path1, name + ".lnk");
                                            string destFile = Path.Combine(targetPath, name + ".lnk");

                                            File.Copy(sourceFile, destFile, true);
                                            fi.Delete();

                                        }

                                    }

                                    RegistryKey HKCU =
                                        Registry.LocalMachine.OpenSubKey(
                                            "SOFTWARE\\Microsoft\\Shared Tools\\MSConfig\\startupfolder", true);
                                    RegistryKey HKCU1 = HKCU.CreateSubKey(path + "^" + name);
                                    HKCU1.SetValue("path", path1 + "\\" + name);
                                    HKCU1.SetValue("location", path1);
                                    HKCU1.SetValue("item", name);
                                    HKCU1.SetValue("command", path1);
                                    HKCU1.SetValue("backupExtension", ".Startup");
                                    HKCU1.SetValue("backup", "C:\\Windows\\pss\\" + name + ".Startup");
                                    HKCU1.SetValue("DAY", DateTime.Now.Day);
                                    HKCU1.SetValue("MONTH", DateTime.Now.Month);
                                    HKCU1.SetValue("YEAR", DateTime.Now.Year);
                                    HKCU1.SetValue("HOUR", DateTime.Now.Hour);
                                    HKCU1.SetValue("MINUTE", DateTime.Now.Minute);
                                    HKCU1.SetValue("SECOND", DateTime.Now.Second);

                                }

                            }

                          }

                    }
                }

                if (
                    MessageBox.Show("Do you want to restart system to save these changes", "Confirm Restart",
                                    MessageBoxButtons.YesNo) == DialogResult.Yes)
                {
                    bool privilege;
                    WindowsIdentity identity = WindowsIdentity.GetCurrent();
                    WindowsPrincipal principal = new WindowsPrincipal(identity);
                    privilege = principal.IsInRole(WindowsBuiltInRole.Administrator);
                    if (privilege == true)
                    {
                        Process.Start("ShutDown", "/r");
                    }
                    else
                    {
                        MessageBox.Show("You have not sufficient privileges to restart computer");
                    }
                }

                 list.Clear();
                list1.Clear();
            }
        }

        private void uxDgvStartupItems_CurrentCellDirtyStateChanged(object sender, EventArgs e)
        {

            //string[] list = new string[100];
            string name = Convert.ToString(uxDgvStartupItems.Rows[uxDgvStartupItems.CurrentCell.RowIndex].Cells[1].FormattedValue);
            list.Add(name);

        } 
```

# c++ - C++ 'int x = (anyInt1, anyInt2);' 是什么意思 意思是？

> ID：13209399
> 
> 赞同：6
> 
> 时间：2012-11-03T12:55:10.833
> 
> 标签：c++, syntax, int

> **可能重复：**
> [为什么 3,758,096,384 << 1 给出 768](https://stackoverflow.com/questions/12878572/why-does-3-758-096-384-1-gives-768)

今天我发现下面的代码用 gcc 编译：

```
#include <iostream>

int main()
{
    int x = (23,34);

    std::cout << x << std::endl; // prints 34

    return 0;
} 
```

为什么会这样编译？是什么意思 （...， ...）？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-11-03T12:55:59.897

在表达式中，逗号运算符将计算其所有操作数并返回最后一个。这就是为什么在您的示例中，`x`等于 34。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-11-03T12:58:43.350

在 C++ 中，`,`is 是一个运算符，因此`(23,34)`是一个表达式，就像`(23+34)`是一个表达式一样。前者`,`是算子，后者`+`是算子。

因此，表达式`(23,34)`计算为最右边的操作数，`34`这就是您的代码输出的原因`34`。

我还想提一下，`,`它不是函数调用中的运算符：

```
int m = max(a,b); 
```

这里`,`充当参数的分隔符。它不充当操作员。因此，您将两个参数传递给函数。

然而，

```
int m = max((a,b), c); 
```

这里第一个`,`是运算符，第二个`,`是分隔符。所以你仍然向函数传递两个参数，而不是三个，它等价于：

```
int m = max(b, c); //as (a,b) evaluates to b 
```

希望有帮助。:-)

# mysql - MySQL 功能数据添加

> ID：13209402
> 
> 赞同：0
> 
> 时间：2012-11-03T12:55:34.717
> 
> 标签：mysql

我对 MySQL 相当陌生，并且正在使用 MySQL 来处理基于订购系统的项目。

我有一张桌子：

```
Session Table:
PK Session_ID
Date: Session_Date 

Delivery Table:
PK: Delivery_Type (eg. Firstclass, Secondclass)
Int: Delivery_TimeToDeliver (1, 2, 3, these represent the expected time to deliver)

Order Table: 
PK: Order_ID: autonum + 1
FK: Delivery Type
Date: Delivery_EstimatedTime 
```

添加订单我想做的是根据会话ID计算估计时间基本上是：

```
Delivery_EstimatedTime = (Session Date + Delivery_TimeToDeliver) 
```

解决此问题的最佳方法是什么？

我可以在记录中插入吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T13:18:56.053

您可以使用：

```
INSERT INTO Order(Delivery_Type, Delivery_EstimatedTime)
SELECT Delivery_Type, Session_Date + INTERVAL Delivery_TimeToDeliver DAY
FROM Session
LEFT JOIN Delivery ON (Delivery_Type = @Delivery_Type)
WHERE Session_ID = @Session_ID 
```

@Delivery_Type 和 @Session_ID 的值

# spring - Apache Camel 共享事务资源

> ID：13209406
> 
> 赞同：1
> 
> 时间：2012-11-03T12:55:42.257
> 
> 标签：spring, hibernate, activemq, apache-camel, spring-transactions

我在 Tomcat 上有一个带有 Mysql+Hibernate 的 Spring-Camel 应用程序。我正在尝试实现从嵌入式 ActiveMQ 队列消耗的[事务处理路由](http://camel.apache.org/transactional-client.html)，进行一些基于数据库的重复检查并生成到另一个嵌入式 ActiveMQ 队列。

为了提供事务性，我使用[了 Shared Transaction Resource pattern](http://www.javaworld.com/javaworld/jw-01-2009/jw-01-spring-transactions.html?page=4)。Hibernate sessionFactory 和 ActiveMQ BrokerService JDBCPersistenceAdapter 都使用相同的数据源。

Camel 端点使用 HibernateTransactionManager(PROPAGATION_REQUIRES_NEW)。它似乎有效，但我想澄清这是否是一种防弹方法，以防系统崩溃、故障、

我需要迁移到jta，2PC吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-17T15:20:36.263

我们将继续使用 XA (Atomikos)

# objective-c - 从 sprite cocos2d 中剪出自定义形状

> ID：13209408
> 
> 赞同：2
> 
> 时间：2012-11-03T12:56:15.367
> 
> 标签：objective-c, cocos2d-iphone, alpha, shape, ccsprite

我有一个图像和一个形状。我需要使用我的形状的 alpha 通道从图像中创建一个切口，这就是我的意思：

[样本](http://s10.postimage.org/as5fe9gzd/111.jpg)

我可以使用 CCMask，但我对结果印象不深。你能指出我的替代解决方案吗？非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T21:51:51.037

看看这些教程，

**Cocos2d 2.0：** [http ://www.raywenderlich.com/4428/how-to-mask-a-sprite-with-cocos2d-2-0](http://www.raywenderlich.com/4428/how-to-mask-a-sprite-with-cocos2d-2-0)

**Cocos2d 1.0：** [http ://www.raywenderlich.com/4421/how-to-mask-a-sprite-with-cocos2d-1-0](http://www.raywenderlich.com/4421/how-to-mask-a-sprite-with-cocos2d-1-0)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-24T12:31:54.620

**-=(W)=-**

*我有一个类似的问题。我阅读了教程并使用了 CCMask。CCMask 是好课，但有一个问题。当遮罩的大小大于纹理的大小时，我们可以看到遮罩的碎片，这是非常糟糕的。用我的决定，享受吧！*

```
-(CCSprite *)maskedSpriteWithSprite:(CCSprite *)textureSprite maskSprite:(CCSprite *)maskSprite
{
    CCSprite *maskSprite_ = [CCSprite spriteWithTexture:[maskSprite texture]];
    CCSprite *textureSprite_ = [CCSprite spriteWithTexture:[textureSprite texture]];

    maskSprite_.position = maskSprite.position;
    maskSprite_.rotation = maskSprite.rotation;
    maskSprite_.opacity = maskSprite.opacity;
    maskSprite_.scale = maskSprite.scale;
    maskSprite_.zOrder = maskSprite.zOrder;

    textureSprite_.position = textureSprite.position;
    textureSprite_.rotation = textureSprite.rotation;
    textureSprite_.opacity = textureSprite.opacity;
    textureSprite_.scale = textureSprite.scale;
    textureSprite_.zOrder = textureSprite.zOrder;

    [maskSprite_ setColor:ccc3(0.0, 0.0, 0.0)];

    //Start cutting sprite

    CCRenderTexture *rt;
    float dx;
    float dy;

    //Correct mask

    rt = [CCRenderTexture renderTextureWithWidth:maskSprite_.contentSize.width*maskSprite_.scale height:maskSprite_.contentSize.height*maskSprite_.scale];

    dx = textureSprite_.position.x - maskSprite_.position.x;
    dy = textureSprite_.position.y - maskSprite_.position.y;

    maskSprite_.position = ccp(maskSprite_.contentSize.width/2*maskSprite_.scale, maskSprite_.contentSize.height/2*maskSprite_.scale);
    textureSprite_.position = ccp(maskSprite_.position.x+dx, maskSprite_.position.y+dy);

    [textureSprite_ setBlendFunc:(ccBlendFunc){GL_ONE, GL_ZERO}];
    [maskSprite_ setBlendFunc:(ccBlendFunc){GL_DST_ALPHA, GL_ZERO}];

    [rt begin];
    [textureSprite_ visit];
    [maskSprite_ visit];
    [rt end];

    CCSprite *correctMaskSprite_ = [CCSprite spriteWithTexture:rt.sprite.texture];
    correctMaskSprite_.flipY = YES;

    correctMaskSprite_.position = maskSprite.position;
    correctMaskSprite_.rotation = maskSprite.rotation;
    correctMaskSprite_.opacity = maskSprite.opacity;
    correctMaskSprite_.scale = maskSprite.scale;
    correctMaskSprite_.zOrder = maskSprite.zOrder;

    //New sprite with correct mask

    [correctMaskSprite_ setBlendFunc:(ccBlendFunc){GL_ONE, GL_ZERO}];
    [textureSprite_ setBlendFunc:(ccBlendFunc){GL_DST_ALPHA, GL_ZERO}];

    [rt begin];
    [correctMaskSprite_ visit];
    [textureSprite_ visit];
    [rt end];

    CCSprite *retval = [CCSprite spriteWithTexture:rt.sprite.texture];
    retval.flipY = YES;

    return retval;
} 
```

# sql-update - hsqldb update failed throws 'assignment to generated column' Exception

> ID：13209409
> 
> 赞同：0
> 
> 时间：2012-11-03T12:56:21.737
> 
> 标签：sql-update, hsqldb

I have a update query. When i execute the below query it shows **assignment to generated column.**

Create Table Query :

```
CREATE TABLE  group1 (
  main_group varchar(20) GENERATED ALWAYS AS ('N/A'),
  group_name varchar(50) NOT NULL,
  group_id INTEGER GENERATED BY DEFAULT AS IDENTITY(start with 1)
); 
```

Update Query :

```
update group1 set main_group = 'Asset' where group_name = 'Current Assets' 
```

Error :

```
Error code -5513, SQL state 42513: assignment to generated column
Line 1, column 1 
```

I have checked with syntax is right.

Edit : Added Create table query for group1 table.

Help me out of this issue...

Thanks in advance..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T04:53:55.463

This table definition meas the value of main_group is ALWAYS generated as the string 'N/A'. It therefore cannot be updated. Obviously you do not want this. You should remove the `GENERATATED ALWAYS AS ('N/A')` clause.

If you want the default value of this column to be 'N/A' then use a DEFAULT clause. You should also define a primary key for your table.

```
CREATE TABLE  group1 (
  main_group varchar(20) DEFAULT 'N/A',
  group_name varchar(50) NOT NULL,
  group_id INTEGER GENERATED BY DEFAULT AS IDENTITY(start with 1) PRIMARY KEY
); 
```

# sql-server - SQL Server 2008 群集无法将可能的所有者添加到 SQL Server/SQL Server 代理资源

> ID：13209412
> 
> 赞同：1
> 
> 时间：2012-11-03T12:56:49.470
> 
> 标签：sql-server, windows, sql-server-2008, cluster-computing

在 Windows Server 2008 R2 上设置 SQL Server 2008 故障转移群集

创建集群（添加 2 个节点`Node1`, `Node2`）。在 .上安装 SQL Server 2008 `Node 1`。它安装成功，服务出现了。我可以使用虚拟 IP 通过管理工具进行连接。

现在，当我想添加时`Node 2`，安装过程中不会显示实例名称。

当我进一步分析时，我可以看到这两个资源的可能所有者 SQL Server、SQL Server 代理只是节点 1。而其他资源同时具有节点 1 和节点 2。

我尝试了下面的事情。

```
C:\Users\administrator.GENNEYS>cluster.exe res "SQL Server" /addowner:GEN-C7-181

Adding 'GEN-C7-181' to possible owners of 'SQL Server'... 
```

> *发生系统错误 5079 (0x000013d7)。指定的节点不支持这种类型的资源。这可能是由于版本不一致或此节点上缺少资源 DLL。*

我应该如何将另一个节点添加到 SQL Server 的可能所有者？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T14:28:46.827

SQL Server DLL (SQSRVRES.DLL)、SQL Server Agent (SQAGTRES.DLL) 仅存在于 NODE1 上的 Windows\systems32\ 文件夹下。将这些复制到 NODE 2 相同的文件夹。它将自动将节点 2 添加为所有者。

# html - Twitter 顶部菜单悬停更改颜色

> ID：13209413
> 
> 赞同：2
> 
> 时间：2012-11-03T12:56:53.683
> 
> 标签：html, css

我正在尝试制作一个类似于 twitter 的黑色菜单栏，但是在 twitter 中，当您将鼠标悬停在连接上或从顶部菜单中发现时，链接文本变为白色，并且照片图标也同时变为白色，到目前为止，它对我不起作用不知道为什么这里是 HTML 代码

```
 <div class="TopMenu">
     <div class="TopMenuCont">
      <ul>
      <li class="mainNav">
      <a href="#" class="Connect">
      <span>
      <i class="navCon"></i>
      </span>
      Connect
      </a>
      </li>
      </ul>
     </div>
  </div>
</body>
</html> 
```

这里是CSS

```
.TopMenuCont ul li a span .navCon
{
    background-position:-80px -50px;
}

.TopMenuCont ul li .Connect
{
 color: #BBBBBB;
    display: block;
    font-weight: bold;
    height: 12px;
    line-height: 1;
    padding: 13px 12px 15px;
    text-shadow: 0 -1px 0 rgba(0, 0, 0, 0.75);
    background:none;
    box-shadow:0 0 0 rgba(0, 0, 0, 0) inset
}

.TopMenuCont ul li a:hover
{
    color:#ffffff;
}

.TopMenuCont ul li a:hover > .TopMenu .TopMenuCont ul li a span .navCon
{
    background-position:-80px -80px;
} 
```

最后一行是问题

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T13:10:28.807

```
.TopMenuCont ul li a:hover > .TopMenu .TopMenuCont ul li a span .navCon 
```

should instead be

```
.TopMenuCont ul li a:hover span .navCon 
```

I think you misunderstand what the `>` selector does. `X > Y` selects an element `Y` that is a *direct descendant* of `X`.

Look here for more information on CSS Selectors:

[http://www.w3.org/TR/CSS2/selector.html](http://www.w3.org/TR/CSS2/selector.html)

# ruby - “if”中的动态条件符号

> ID：13209414
> 
> 赞同：1
> 
> 时间：2012-11-03T12:57:12.590
> 
> 标签：ruby, conditional-statements

我想创造一个动态的条件。它看起来像

```
Model.send("attr_name") > 0 ? true : false 
```

但是我怎样才能动态地写符号“>”呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T13:01:50.890

我不太明白你的问题是什么，但这可能是答案：

```
1.9.3p194 :004 > s = "<"
 => "<" 
1.9.3p194 :005 > 0.send :"#{s}", 1
 => true 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T05:09:26.633

您不需要三元运算符`? :`。它可以简单地写成：

```
Model.send("attr_name").send(condition,0) 
```

# php - 如何附加由 dompdf 生成的 pdf 并将其邮寄到 phpmailer？

> ID：13209415
> 
> 赞同：0
> 
> 时间：2012-11-03T12:57:13.010
> 
> 标签：php, phpmailer, dompdf

我正在使用 dompdf 生成 pdf，我需要将其附加到 phpmailer 并邮寄。帮助将不胜感激。

```
<?php
require_once("../../dompdf/dompdf_config.inc.php");

$templateFile = 'prog_report.php';
$content = file_get_contents($templateFile);
$dompdf = new DOMPDF();
$dompdf->load_html($content);

$dompdf->render();
$dompdf->stream("sample.pdf");

?> 
```

这是phpmailer附件模块..

```
$mail->AddAttachment("images/phpmailer.gif"); 
```

我想在此处附上生成的 pdf，并且不应将 pdf 保存在硬盘驱动器上。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2018-03-02T15:14:49.843

磁盘上没有保存文件：

```
$pdfString = $dompdf->output();
$mail->addStringAttachment($pdfString, 'name file.pdf'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T12:53:24.203

我查看了 DomPDF 的 wiki [http://code.google.com/p/dompdf/wiki/FAQ](http://code.google.com/p/dompdf/wiki/FAQ)上的常见问题解答

`$pdf = $dompdf->output();`

代替

```
$pdf = $dompdf->stream('name'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-03T13:01:48.590

首先在您的服务器中创建pdf文件

为什么不交换它们，首先将pdf创建为文件，然后将创建的文件流回？

```
$file_to_save = '/home/stsnew/public_html/pdf/file.pdf';
//save the pdf file on the server
file_put_contents($file_to_save, $dompdf->output()); 
```

然后附上邮件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-01-14T18:22:47.990

我只是使用下面的代码自己修复了它：

```
->attach(Swift_Attachment::fromPath($pass_doc_path)) 
```

它为我工作。

非常感谢

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-07T12:09:01.567

嗨，伙计，我使用了 fpdf 库和 php 邮件程序，它的工作原理就像魅力一样，试试这个。

```
require('fpdf.php');
$filename="bookingconfirmation.pdf";
//rest of pdf code here

$pdf->Output($filename);

include "libMail/class.phpmailer.php";
$m= new Mail; // create the mail
$m->IsSMTP(); // telling the class to use SMTP
$m->Host = "mail.connectingauthors.com"; // SMTP server
$m->SetFrom("susan@connectingauthors.com");    
$m->AddReplyTo("pixelart@optonline.net");
$m->AddAddress("pixelart@optonline.net");
$m->Subject( "Connecting Authors Booking Confirmation" );
$m->MsgHTML( "HellonnPlease find attached ..." ); // set the body
$m->AddAttachment( $filename ) ;
$m->Send(); // send the mail
exit(); 
```

# x86 - 如何解决 Windows 上的 GHC 错误“Unknown PEi386 section name `.idata$4'”？

> ID：13209425
> 
> 赞同：4
> 
> 时间：2012-11-03T12:58:30.293
> 
> 标签：x86, ghc, portable-executable, unix-ar, dlltool

我最近发现[我编写的在 Windows 上编译 HDBC-postgresql 的指令](https://github.com/hdbc/hdbc-postgresql/wiki/WindowsInstall)不再适用于 Haskell 平台 2012.2.0.0。该库构建正常，但是在尝试链接构​​建的库时，`cabal`失败并显示：

```
正在加载包 HDBC-postgresql-2.3.2.1 ... ghc.exe：未知的 PEi386 部分名称
 `.idata$4'（处理时：C:/PROGRA~1/POSTGR~1/9.2/lib\libpq.a）
ghc.exe：恐慌！（“不可能”发生了）
  （用于 i386-unknown-mingw32 的 GHC 版本 7.4.1）：
        loadArchive "C:/PROGRA~1/POSTGR~1/9.2/lib\\libpq.a": 失败

```

我尝试使用 重新制作`libpq.a`，`dlltool --no-idata4 --no-idata5`但随后错误消息更改为`Unknown PEi386 section name `.idata$7'`.

这似乎是[GHC 错误 7103](http://hackage.haskell.org/trac/ghc/ticket/7103)。

根据[PE 和 COFF 规范](http://msdn.microsoft.com/en-us/library/windows/hardware/gg463119.aspx)，美元符号包含在部分名称中时具有特殊含义，表示“分组部分”。链接器应该丢弃 "$" 和它后面的所有字符以创建一个合并的`.idata`部分，其中 "$" 后面的字符用于确定对合并部分的贡献的顺序。

有没有办法强制`dlltool`不输出分组部分？

或者，有没有办法获取 GNU 存档（A 文件），合并所有分组的部分，并输出生成的合并导入库（imlib）？

**编辑：** Haskell Platform 2012.4.0.0 也会发生同样的错误。

**EDIT2**查看[的源代码后`dlltool`](http://sourceware.org/git/?p=binutils.git;a=blob;f=binutils/dlltool.c)，似乎没有办法强制它不输出分组部分。此外，我还没有找到一个现成的实用程序，它将合并目标文件中的分组部分。

出于赏金和这个问题的目的，我将其更改为：如何在`.idata`给定模块定义 (DEF) 文件的情况下构造单个部分。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-11T16:23:51.650

> 链接器应该丢弃“$”及其后面的所有字符以创建合并的 .idata 部分

是的，但这只是 Microsoft 链接器的默认行为。我对你的工具链的速度不够快，所以只是一些提示。gcc 链接器需要显式配置才能将各种 .idata$x 部分合并到单个 .idata 部分中。这是由 SECTION 指令完成的。在似乎由脚本完成的 mingw 中，[此处](https://bitbucket.org/uric/pyneuron/src/d65f9c5cf37c/home/i686-pc-mingw32/lib/ldscripts/i386pe.xbn)提供了一个示例。请注意脚本的这一部分：

```
 .idata BLOCK(__section_alignment__) :
  {
    /* This cannot currently be handled with grouped sections.
        See pe.em:sort_sections.  */
    SORT(*)(.idata$2)
    SORT(*)(.idata$3)
    /* These zeroes mark the end of the import list.  */
    LONG (0); LONG (0); LONG (0); LONG (0); LONG (0);
    SORT(*)(.idata$4)
    __IAT_start__ = .;
    SORT(*)(.idata$5)
    __IAT_end__ = .;
    SORT(*)(.idata$6)
    SORT(*)(.idata$7)
  } 
```

非常神秘，但鞋子很合脚。确保您的链接器使用这样的脚本。

# android - setOnItemClickListener 没有响应

> ID：13209429
> 
> 赞同：1
> 
> 时间：2012-11-03T12:58:45.877
> 
> 标签：android

> **可能重复：**
> [未调用 setOnItemClickListener](https://stackoverflow.com/questions/13201363/setonitemclicklistener-not-getting-called)

我有一个扩展基本适配器的自定义适配器。当我在 onCreate 中设置 setOnItemClickListener 并实现 onItemClick 时，我单击一行时没有得到任何响应。

```
 ListView lv = (ListView)findViewById(R.id.list);
     adapter = new ModuleAdapter(this);
     lv.setAdapter(adapter);
     lv.setOnItemClickListener(this); 
```

在 onCreate 之后：

```
 @Override
     public void onItemClick(AdapterView<?> parent, View view, int position,
        long id) {

   Log.v(TAG, "clicked");

     } 
```

我的行中只有文本视图。有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T14:21:03.767

如果你想使用

> lv.setOnItemClickListener(this);

您必须为您的活动实现 OnItemClick 侦听器。

你也可以使用@user1597833 的答案。

如果您想单击 textview 而不是单元格，请尝试 @jeet 的答案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T13:01:43.727

似乎行项目视图中的视图具有可聚焦和可点击属性为true，因此项目的子项采用点击事件，而不是列表行项目，如果是这种情况，为了解决此问题，更改行项目的所有视图的焦点，并且可点击属性为假。

# ruby-on-rails - Web API 服务器应该使用 session id 和/或 auth-token 吗？

> ID：13209437
> 
> 赞同：2
> 
> 时间：2012-11-03T12:59:34.943
> 
> 标签：ruby-on-rails, web-services, api, rest, concurrency

根据@Veraticus 对此[问题](https://stackoverflow.com/questions/13197863/web-application-without-sql-query-for-current-user-authentication)的回答，Web 身份验证框架将 current_user 的 ID 保存在*会话 ID*中，以便快速轻松地从数据库中检索用户（无需每次都在数据库上进行新查询来获取用户） .

这很棒，因为这正是我想通过我正在编写的 API 对我自己的服务器执行的操作（出于性能原因）。

但我想知道*session id* ...我的意思是，如果服务器处理会话，客户端必须向他提供*session id*。

但是，我还想知道另一件事：通常，Web API 使用*API 密钥*（例如，[https://api-docs.heroku.com/](https://api-docs.heroku.com/)）。对于客户端来说，使用*API 密钥*和*会话 ID*可能会很复杂......

我希望 Heroku 不要在每个 HTTP 请求中使用收到的 auth-token 执行数据库查询。但如果他们不这样做，他们怎么能在没有*会话 id*的情况下对用户进行身份验证？

我很困惑。非常感谢您的任何想法。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-03T19:14:58.360

会话和身份验证令牌/API 密钥是非常不同的身份验证方法并服务于不同的用例。

**会话**最常用于 HTML 网站，例如，用户在服务器上进行一次身份验证（通常通过提供用户名和密码），然后浏览网站，而无需在每次请求时重新验证自己。这对服务器有要求，它需要能够维护会话状态并将其存储在内存中，以及客户端，它需要能够存储会话 ID（通常在 cookie 中）并在每个要求。

**身份验证令牌/API 密钥**可以被认为是更轻量级的，因为请求之间没有需要维护的状态（服务器是无状态的）。每个操作几乎都是原子的，客户端必须在每次请求时验证自己（使用令牌/密钥）。这种方法更适合通过“程序”而不是用户 Web 浏览器以编程方式访问服务器资源。

**IMO，客户**同时使用两者并没有什么意义。如果用户已经通过会话进行身份验证，则服务器已经知道是谁在调用它，并且不需要请求额外的 API 密钥。

OTOH，您的**服务器**Web API 可能足够聪明，可以接受来自客户端的两种形式的身份验证。调用时，它可以检查客户端是否已经建立了会话（在这种情况下，它知道谁在调用它），如果没有，则检查客户端是否正在传递一些 API 密钥/身份验证令牌并即时验证用户。

要回答您最后一个问题，由于受密钥或令牌保护的 API 是无状态的，因此每个调用都需要单独进行身份验证。这意味着它需要为每个请求加载有关客户端的信息以验证密钥。通常此信息存储在数据库中，因此这可能意味着每次请求都会命中数据库，除非服务器实现某种缓存以加快处理速度（Heroku 很可能就是这种情况）。

# c# - 我的 WP7 游戏无法正确读取或写入独立文件流

> ID：13209443
> 
> 赞同：0
> 
> 时间：2012-11-03T13:01:06.270
> 
> 标签：c#, windows-phone-7, file-io, xna-4.0, isolatedstoragefile

根据我在现实生活中认识的程序员和讲师以及互联网上的一些教程，我的代码应该可以正常工作正如我想要的那样，但是每当我开始我的游戏时，我的高分都没有加载，下面是我读取和写入文件的函数，我犯了什么愚蠢的错误吗？

```
public void ReadHighScore()
    {
        byte[] myByteArray = new byte[64]; // Creates a new local byte array with a length of 64
        using (var store = IsolatedStorageFile.GetUserStoreForApplication()) // Creates an IsolatedStorageFile within the User Storage
        using (var stream = new IsolatedStorageFileStream("highscore.txt", System.IO.FileMode.Create, System.IO.FileAccess.ReadWrite, store)) // Creates a new filestream attatched to the storage file
        {
            if (stream != null) // Checks to see if the filestream sucessfully read the file
            {
                int streamLength = (int)stream.Length; // Gets the length of the filestream
                stream.Read(myByteArray, 0, streamLength); // Parses the filestream to the byte array
            }
            else
                myState = (int)game_state.Terminate; // Temporary Error checking, the function gets though this without triggering the 'terminate' gamestate
        }

        string ScoreString = myByteArray.ToString(); // Parses the byte array to a string
        Int32.TryParse(ScoreString, out highScore.score); // Parses the string to an integer
    }

    public void SaveHighScore()
    {
        byte[] myByteArray = new byte[64]; // Creates a new local byte array with a length of 64
        using (var store = IsolatedStorageFile.GetUserStoreForApplication()) // Creates an IsolatedStorageFile within the User Storage
        using (var stream = new IsolatedStorageFileStream("highscore.txt", System.IO.FileMode.Create, System.IO.FileAccess.ReadWrite, store)) // Creates a new filestream attatched to the storage file
        {
            if (stream != null) // Checks to see if the filestream sucessfully read the file
            {
                int streamLength = (int)stream.Length; // Gets the length of the filestream
                stream.Write(myByteArray, 0, streamLength); // Parses the byte array to the filestream
            }
            else
                myState = (int)game_state.Terminate; // Temporary Error checking, the function gets though this without triggering the 'terminate' gamestate
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-03T14:07:56.077

首先，阅读部分有一个错误：您正在使用`FileMode.Create`.

并根据[文档](http://msdn.microsoft.com/en-us/library/system.io.filemode%28v=vs.95%29.aspx)：

> 指定操作系统应该创建一个新文件。如果文件已经存在，它将被覆盖。

所以基本上，你`ReadHighScore`正在删除旧文件并创建一个新文件。我相信，这不是你想做的。替换`FileMode.Create`为`FileMode.OpenOrCreate`（仅在`ReadHighScore`方法中），您应该有更好的结果。

* * *

此外，在这一行的 , 中有一个错误`SaveHighScore`：

```
stream.Write(myByteArray, 0, streamLength); 
```

由于您正在创建文件，`streamLength`因此应该等于 0。因此，您没有写任何东西。你真正想做的是：

```
stream.Write(myByteArray, 0, myByteArray.Length); 
```

您应该考虑使用`StreamReader`、`StreamWriter`、`BinaryReader`和`BinaryWriter`来读/写流，因为它们更容易使用。

* * *

最后但并非最不重要的一点是，您正在读取和写入的数据是错误的。在该`SaveHighScore`方法中，您试图保存一个空数组，实际的高分无处可寻。在该`ReadHighScore`方法中，情况更糟：您正在阅读`myByteArray.ToString()`，这将始终等于`System.Byte[]`。

* * *

最后，你的代码应该是这样的：（假设`highScore.score`被声明为`int`）

```
public void ReadHighScore()
{
    using (var store = IsolatedStorageFile.GetUserStoreForApplication())
    {
        using (var stream = new IsolatedStorageFileStream("highscore.txt", System.IO.FileMode.OpenOrCreate, System.IO.FileAccess.Read, store))
        {
            using (var reader = new BinaryReader(stream))
            {
                highScore.score = reader.ReadInt32();
            }
        }
    }
}

public void SaveHighScore()
{
    using (var store = IsolatedStorageFile.GetUserStoreForApplication())
    {
        using (var stream = new IsolatedStorageFileStream("highscore.txt", System.IO.FileMode.Create, System.IO.FileAccess.ReadWrite, store))
        {
            using (var writer = new BinaryWriter(stream))
            {
                writer.Write(highScore.score);
            }
        }
    }
} 
```

# jquery - 使用jquery从循环div中获取隐藏值

> ID：13209451
> 
> 赞同：3
> 
> 时间：2012-11-03T13:02:03.810
> 
> 标签：jquery, loops

我有一个搜索按钮。单击搜索按钮时，它将生成以下代码：

```
<div class = 'clickedResult' title = 'click to see details'>
 <table>the result will br written in this table </table>
 <input type = 'hidden' class = 'form_id' value = '$form_id' /> 
 <input type = 'hidden' class = 'status' value = '$status' />
 </div> <br/> 
```

这段代码在循环内，循环进行了两次，循环的结果是这样

```
<div class = 'clickedResult' title = 'click to see details'>
 <table>the result will br written in this table </table>
 <input type = 'hidden' class = 'form_id' value = '14' /> 
 <input type = 'hidden' class = 'status' value = 'latest' />
 </div> 

<div class = 'clickedResult' title = 'click to see details'>
 <table>the result will br written in this table </table>
 <input type = 'hidden' class = 'form_id' value = '48' /> 
 <input type = 'hidden' class = 'status' value = 'updated' />
 </div> 
```

如果单击其中一个表，它将执行此操作（我使用 jquery）

```
$(".clickedResult").click(function()
  {
  $('.clickedResult input.form_id').each(function() 
      {
     alert($(this).val());
  });
  }); 
```

它会提醒 14 和 48 ......如果我点击第一个表，如何只提醒 14 ？如果我点击第二个表，它会提醒 48 ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T13:04:25.243

```
$(".clickedResult").click(function() {
  alert($(this).find('input.form_id').val());
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-03T13:05:19.090

使用`$(this).children("input.form_id")`而不是`$('.clickedResult input.form_id')`仅通过作为您单击的 div 的后代的 form_id。

考虑到您的示例，代码如下所示：

```
$(".clickedResult").click(function() {
    console.log( $(this).children("input.form_id").val() );
}); 
```

还有人可能会争辩说，在您的情况下，使用`.children()`而不是`.find()`更快，因为您的输入仅比 div 低一个 dom 级别，并且`.children()`只搜索一层深，而`.find()`遍历整个树以查找所有可能的候选者。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-03T13:11:41.973

`event`在点击处理程序中使用参数，如下所示：http: [//jsfiddle.net/wE6JK/](http://jsfiddle.net/wE6JK/)

# c++ - 操作对 STL 容器中元素的引用（例如向量）

> ID：13209454
> 
> 赞同：1
> 
> 时间：2012-11-03T13:02:33.613
> 
> 标签：c++

直接操作指向 STL 容器中元素的引用/指针总是安全的吗？

例如，假设我们有

```
inline void swap(int &a, int &b){int temp=a;a=b;b=temp;} 
```

和

```
vector<int> array; 
```

其中包含 {1,2,3,4,5}

使用以下调用是一个好习惯吗？

```
swap(array[1],array[3]); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-03T13:06:01.433

是的，那会很好。

`std::swap`使用而不是您自己的功能会是更好的做法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-03T13:04:54.127

`std::vector::operator[]`如果您实际上无法对它执行任何操作，则返回引用将毫无意义。您的代码非常好。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-03T15:29:35.093

对于序列容器，这很好。另一方面，关联容器对具有特定值的元素所属的位置有自己的概念，因此不要混淆其元素的值。

# fonts - 是否可以调整字体的前导？

> ID：13209457
> 
> 赞同：1
> 
> 时间：2012-11-03T13:03:03.383
> 
> 标签：fonts, font-face, webfonts

我正在使用一种字体，由于某种原因，与其他字体相比，它浮动在基线之上。我想将它转换为 webfont 并使用 @font-face 嵌入它，但我需要一种方法来修复字体，或者以某种方式纠正 CSS 的奇怪引导。这可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T13:09:46.923

在 CSS 中更改字体前导的唯一方法是使用`line-height:12px;`设置为默认字体大小的字体（取决于您是否还更改了`font-size`CSS 中的字体大小。您可以输入负数，但不确定这是否看起来好的！

另一种选择是在标签或它嵌套的任何标签内使用`margin`和。`padding``p`

我相信 WebKit 浏览器有一个非常漂亮的样式，`-webkit-font-smoothing:antialiased;`这有助于创建更平滑的字体。

如果您谈论的是字体的外观，而不是前导，您可能会遇到一个 IE 问题，其中 @face-font 导入非常“jagerdy”。

我经常遇到这个问题，尤其是使用浅色字体。您可以在兼容模式下对此进行检查，看看字体是否已修复。如果不是这种情况，那么只有您的字体才是问题所在。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T16:56:42.700

我在最初的问题中有点误会，因为我正在从 cufon.js 转换为使用 @font-face。由于 cufon 渲染（不是实际的字体或 css），渲染有点古怪。尽管如此，在弄清楚这一点的过程中，我想我想出了有用的答案：

1.  要对实际字体进行调整，这项工作的首选（开源）工具似乎是：[fontforge](http://fontforge.org/)。界面很笨拙，但如果你能弄清楚如何使用它，它就是一个强大的工具。较新的 Mac 需要安装 XQuartz（或其他 X11 环境）才能运行它。

2.  至于对 css/webfont 的调整，[font squirrel](http://www.fontsquirrel.com/fontface/generator)似乎提供了最强大的生成器和最可定制的选项，例如 ex-height 匹配和字符子集，以及一堆其他让我头疼的高级选项。不利的一面是，许多字体代工厂已要求将其字体列入黑名单，因此生成器不会出于版权原因对其进行转换。

在这两个工具之间，以及对 css3 字体样式的熟悉，你应该为今天的网页排版做好准备。

ps：我知道 fontsquirrel 的许多替代品似乎用更少的选项做几乎相同的事情。但我不知道 fontforge 的任何合理替代方案。如果您知道任何替代方案，请随时发表评论。

# python - 仅限制带有地理标记的推文流向 mongodb

> ID：13209459
> 
> 赞同：1
> 
> 时间：2012-11-03T13:04:06.200
> 
> 标签：python, mongodb, twitter, pymongo, tweetstream

我目前正在使用[Tweetstream](http://pypi.python.org/pypi/tweetstream)在 MongoDB 中存储推文。
我已经设置了一个使用 python 2.7 运行的脚本：

```
extent =["144.715, -38.03", "145.219, -37.541"]

with tweetstream.FilterStream(username, password, locations=extent) as stream:
    for tweet in stream:
        db.tweets.save(tweet) 
```

这工作正常，并将推文存储到 mongoDb 中，但它也存储了根本没有地理位置的推文。即对于[坐标属性，](https://dev.twitter.com/docs/platform-objects/tweets)空白的也被存储。

对我来说，当前脚本应该只将指定范围内的推文保存到我的 mongoDb，但这并没有发生。

谁能建议如何修改我的脚本以捕获仅将我指定的地理标记推文发送`extent`到 mongoDb？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T14:57:51.937

Twitter 支持两种不同级别的地理定位准确性，以允许用户限制他们共享的信息。

[http://support.twitter.com/forums/26810/entries/78525](http://support.twitter.com/forums/26810/entries/78525)

> **为什么我看到某些推文的确切位置，而其他推文只能看到大致附近（社区或城市）？**
> 
> 默认显示为地点位置（如社区或城镇），但某些第三方应用程序可让您在推特上显示您的确切位置或地址。如果您选择通过第三方应用程序显示您的确切位置，则可以公开共享实际坐标。

tweetstream.FilterStream 返回的推文可以是任一精度。一些推文将仅具有位置级别的准确性，在这种情况下，“坐标”键将为无。

```
 u'coordinates': None,
 u'place': {u'attributes': {},
            u'bounding_box': {u'coordinates': [[[-122.51368188,
                                                 37.70813196],
                                                [-122.35845384,
                                                 37.70813196],
                                                [-122.35845384,
                                                 37.83245301],
                                                [-122.51368188,
                                                 37.83245301]]],
                              u'type': u'Polygon'},
            u'country': u'United States',
            u'country_code': u'US',
            u'full_name': u'San Francisco, CA',
            u'id': u'5a110d312052166f',
            u'name': u'San Francisco',
            u'place_type': u'city',
            u'url': u'http://api.twitter.com/1/geo/id/5a110d312052166f.json'}, 
```

其他推文将有一个确切的位置，在这种情况下，“坐标”键将被填充：

```
 u'coordinates': {u'type': 'Point', u'coordinates': [-122.51368188, 37.83245301]} 
```

您需要确定您是否对位置级别准确性推文感兴趣。如果是，您可以将它们的坐标存储为多边形，或计算质心。

# grails-orm - GORM多对多和反向引用是否有belongsTo混合语法

> ID：13209460
> 
> 赞同：3
> 
> 时间：2012-11-03T13:04:23.910
> 
> 标签：grails-orm, grails-2.0, grails-domain-class

我遇到了 GORM 映射的特殊性。

我对表格的期望是

```
models
designs (model_id -> models.id)
categories
categories_design (category_id, design_id) 
```

要在设计中获得 model_id，我会使用 map 语法

```
static belongsTo = [model:Model] 
```

所以现在，我在 Design 和 Category 之间也有一个 hasMany 关系，并且拥有方是 Design。

GORM 手册说使用非映射语法表示拥有方

```
static belongsTo = Category 
```

但是，我还需要从设计到使用地图符号的模型的反向引用。

我的问题是你如何混合这两种情况？

我在设计中尝试过：

```
static belongsTo = [model:Model, category:Category] 
```

这会出现运行时错误 - 在多对多关系中的域类 Category 和 Design 之间没有定义所有者。

```
static belongsTo = [model:Model, Category] 
```

这会产生编译错误。

```
static belongsTo = [Model, Category] 
```

在设计中没有创建预期的 model_id，而是创建了一个全新的 models_designs 表，这是不正确的。但一切都编译并运行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-05T19:29:07.903

如果您在 Design 和 Category 之间有 hasMany 关系，并且 Design 是拥有方，您是否应该没有

```
static hasMany = [category: Category] in Design class 
```

和

```
static belongsTo = Design in Category class. 
```

这样，你仍然可以保持

```
static belongsTo = [model:Model] 
```

在设计课上。

# php - DOMXpath 从带有特定文本的标签中获取

> ID：13209462
> 
> 赞同：0
> 
> 时间：2012-11-03T13:04:49.610
> 
> 标签：php, domdocument, domxpath

我有这样的事情：

```
<div class='date'>23/03/12</div>
    <div class='content'>
        <div class='rand2'> text </div>
         <p> text </p>
    </div>
<div class='date'>24/03/12</div>
    <div class='content'>
        <div class='rand2'> text </div>
         <p> text </p>
    </div> 
```

我想从日期为 23/03/12而不是其他日期的 div 中取出 div-content 中的文本（不在里面） ！有任何想法吗？

# vb.net - VB - 如何从在另一个线程（串行对象）上运行的类中访问数据

> ID：13209465
> 
> 赞同：2
> 
> 时间：2012-11-03T13:05:06.177
> 
> 标签：vb.net, multithreading, serial-port, invokerequired

我正在编写一个名为 Field 的类，它使用串行对象从 Arduino 获取一些值。我有一个由类引发的事件（当从串行端口接收到数据时，或多或少），当发生这种情况时，我需要从这个类中检索数据。下面的代码有效，但似乎没有按照我需要的方式这样做。我对线程如何工作的了解很少，我只知道串行端口对象在它自己的线程中运行，这使得使用它变得非常痛苦。

```
Private Sub Field_eScore() Handles Field.eScore

    If InvokeRequired Then
        Invoke(Sub() lbl_COM_data.Text = Field.GetComData())
    Else
        lbl_COM_data.Text = Field.GetComData()
    End If

End Sub 
```

有没有一种方法可以轻松访问在另一个线程中运行的数据，而不涉及这些“InvokeRequired”If-Then 条件？有关在这种情况下线程如何工作的更多信息也很棒。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T06:55:22.963

`InvokeRequired`是必需的，因为 UI 只能由创建控件的线程（通常是主线程）修改。

为了“避免”它，设计您的代码以分离职责——将 UI 修改与处理串行端口的代码保持在不同的层。

您仍然需要检查是否`InvokeRequired`在某些地方 - 您确实将后端与 UI 接口 - 但它应该只在一个“层”中。

# eclipse - 我的 java 文件中的代码不再出现在 Eclipse 中

> ID：13209469
> 
> 赞同：0
> 
> 时间：2012-11-03T13:06:00.963
> 
> 标签：eclipse

我的 java 文件中的代码不再出现在 Eclipse (Juno R1) 中，上周就在那里。代码在文件中，类出现在 Eclipse 的“项目”、“包”、“类型”和“成员”面板中，所以我知道它正在读取 java 文件，但代码面板中没有一个文件出现。有谁知道如何强制代码出现在代码面板中？Window 菜单上的 ShowView 项可以查看除代码之外的所有内容。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T13:15:19.923

如果您可以看到您的项目文件但文件的内容是错误的，请尝试更新文件，通过*右键单击项目注释*并选择*Refresh*，这将强制 eclipse 从您的文件系统重新加载所有文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T16:20:42.650

我想我想通了。当我从 File 菜单中单击 OpenFile 时，java 文件出现在 Eclipse 中。我之前没有这样做，因为我认为 Eclipse 不会理解该文件是上面引用的 SRC 文件。我将不得不进行更多实验，看看这是否真的有效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-03T13:09:39.883

确保您在正确的工作区中，我假设您刚刚升级到 Juno，因此您将不得不导入现有项目，我很确定。右键单击列表窗口，单击导入然后我认为导入现有项目或类似的东西在常规选项卡下。老实说，我开始在终端中使用 nano，自从我使用 Eclipse 以来已经有一段时间了，但我认为这会解决你的问题。

# matlab - Matlab将图像合并为一个并绘制线条

> ID：13209470
> 
> 赞同：0
> 
> 时间：2012-11-03T13:06:33.197
> 
> 标签：matlab, plot, line

我有一组来自图像 1、I1 的点 (x1,y1)，以及来自图像 2、I2 的另一组点 (x2,y2)。
我想首先将两个图像按 newI = [I1 I2] % 两倍宽
然后，在新图像上，我想从 (x1,y1) 到 (x2,y2) 绘制点。

问题是点集是基于其原始图像而不是相邻图像。
那么，如何将 (x1,y1) 和 (x2, y2) 中的点转换为新图像上的点？

然后，我如何在这些点之间画线。我不太确定如何使用 matlab 绘图

即 (x11,y11) -> (x21,y21) 一直到 (x1i,y1i) -> (x2i, y2i) 第 i 个点

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T13:59:50.457

如果我理解正确`(x1, y1)`是图像上的点索引`I1`。Matlab 以相同的顺序表示图像像素。因此，图像`x1`中从左`y1`到上的点位于 index 处`(x1, y1)`。

现在，当您通过 连接图像时`[I1 I2]`，它与将第二张图像定位在第一张图像的右侧相同。这会将第二张图片向左平移第一张图片的宽度，这是第一张图片的列数，可以通过`size(I1,2)`.

要考虑这种转变，您需要为第二张图像添加适当的转变。

```
(x2, y2) --> (( x2 + size(I1,2) ), y2 ) 
```

请注意，我们不需要移动`y2`，因为图像的高度相同。此外，如果您有多个需要绘制的点，建议将图像尺寸保存在单独的变量中。

我猜你正在使用符号`(x11, y11)`并`(x21, y21)`指代点`(x1, y1)`和`(x2, y2)`相邻的图像。

`(x1, y1)`从到画一条线`(x2, y2)`，假设`a1 = [x1, y1]`和`a2 = [x2, y2]`，那么你可以说`plot([a1(1), a2(1)], [a1(2), a2(2)])`。这可以改进，但我需要知道你如何存储积分。

# php - 在linux中定义可以在php中访问的变量

> ID：13209472
> 
> 赞同：5
> 
> 时间：2012-11-03T13:06:37.790
> 
> 标签：php, linux, variables, environment

我在整个 linux 变量中添加了一个变量`/etc/profile`

```
export MYNAME="My Value" 
```

在通过 apache Web 服务器运行期间，如何在 php 源代码中访问此值？在 $_SERVER 这个值不存在。

只是这个键出现在 $_ENV 上：

```
_ENV["APACHE_RUN_DIR"]  /var/run/apache2
_ENV["APACHE_PID_FILE"] /var/run/apache2.pid
_ENV["PATH"]            /usr/local/bin:/usr/bin:/bin
_ENV["APACHE_LOCK_DIR"] /var/lock/apache2
_ENV["LANG"]            C
_ENV["APACHE_RUN_USER"] www-data
_ENV["APACHE_RUN_GROUP"]    www-data
_ENV["APACHE_LOG_DIR"]  /var/log/apache2
_ENV["PWD"]                 / 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-03T13:08:59.843

假设变量是在正确的用户下导出的，`$_ENV`应该包含它们。

见：[http ://se.php.net/manual/en/reserved.variables.environment.php](http://se.php.net/manual/en/reserved.variables.environment.php)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-03T13:22:51.143

尝试为守护进程设置环境变量比听起来要棘手。只有交互式登录 bash shells source `/etc/profile`，这可能与您的 Web 服务器进程的条件不匹配。请参阅[此页面](http://www.gnu.org/software/bash/manual/html_node/Bash-Startup-Files.html)了解更多信息。

但是，您可以[在 Apache 和 PHP 中设置环境变量](http://docstore.mik.ua/orelly/webprog/pcook/ch08_22.htm)。

在 Apache 配置文件中：

```
SetEnv ENV_VAR var_value 
```

重启，服务器。然后你应该能够使用`$_ENV`PHP 来获取这个变量。

# .htaccess - .htaccess 即将推出的页面

> ID：13209473
> 
> 赞同：0
> 
> 时间：2012-11-03T13:07:04.937
> 
> 标签：.htaccess

我正在使用 .htaccess 将所有用户重定向到即将推出的页面，同时允许我的 IP 地址正常使用该应用程序进行测试。我正在使用这部分 .htaccess

```
<IfModule mod_rewrite.c>
Options +FollowSymlinks
RewriteEngine on
RewriteCond %{REMOTE_ADDR} !^1\.2\.3\.4
RewriteCond %{REQUEST_URI} !\.(css|gif|ico|jpg|js|png|swf|txt|html)$
RewriteRule (.*)$ /coming-soon.html [R=302,L]
</IfModule> 
```

它工作正常，并将除我的 ip 之外的每个人重定向到coming-soon.html 页面。但似乎 url_rewrites 不起作用，因此 MVC 路径似乎已被禁用。不知道出了什么问题。

谢谢你的帮助

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-11-04T08:43:00.903

```
Options -Indexes
<IfModule mod_rewrite.c>
   RewriteEngine on

   RewriteCond %{REMOTE_ADDR} !^1\.2\.3\.4
   RewriteCond %{REQUEST_URI} !\.(css|gif|ico|jpg|js|png|swf|txt|html)$
   RewriteRule (.*)$ /coming-soon.html [R=302,L]

   RewriteCond %{HTTP_HOST} ^domain.com$ 
   RewriteRule ^(.*)$ http://www.domain.com/$1 [R=301,L]
   RewriteRule    ^$ app/webroot/    [L]
   RewriteRule    (.*) app/webroot/$1 [L]
</IfModule> 
```

# perl - 为什么我的 Perl 程序使用 Tie::File 和 Unicode/UTF-8 编码失败？

> ID：13209474
> 
> 赞同：7
> 
> 时间：2012-11-03T13:07:19.417
> 
> 标签：perl, unicode, utf-8, tie

我正在从事一个处理外语数据的项目。我的 Perl 脚本运行良好。

然后我想使用 Tie::File，因为这是一个简洁的概念（并且可以节省时间和编码）。

似乎 Tie:File 在 Unicode/UTF-8 下失败（除非我遗漏了什么）。

这是一个描述问题的程序：（数据是英语、希腊语和希伯来语的混合体）：

```
use strict;
 use warnings;
 use 5.014; 
 use Win32::Console;
 use autodie; 
 use warnings qw< FATAL utf8 >;
 use Carp;
 use Carp::Always;
 use utf8;
 use feature        qw< unicode_strings>;
 use charnames      qw< :full>;
use Tie::File;

my ($i);
my ( $FileName);
my (@Tied);
binmode STDOUT, ':unix:utf8';
binmode STDERR, ':unix:utf8';
binmode $DB::OUT, ':unix:utf8' if $DB::OUT; # for the debugger
Win32::Console::OutputCP(65001);         # Set the console code page to UTF8

$FileName = 'E:\\My Documents\\Technical\\Perl\\Eclipse workspace\\Work\\'.
        'Tie File test res.txt';
tie @Tied, 'Tie::File', $FileName, recsep => "\x0D\x0A", discipline => ':encoding(utf8)'
            or confess 'tie @Tied failed';
$i =0;
while (<DATA>) {
    chomp;
    $Tied[$i] = $_;
    ++$i;
} # end while (<DATA>) 
$i =0;
foreach (@Tied) {
    say "$i $Tied[$i]";
    ++$i;
} # end foreach (@Tied)
untie $FileName;
__DATA__
τι κάνετε;
πάρτε το ή αφήστε το
שלום חברים
abc לא כןכן efg
מתי ולאן This is it
מעכשיו לעכשיו 
Σήμερα είναι Τρίτη
Θέλω να φάω
τι κάνετε;
שורה מס' 5 
```

这会产生大量的警告：这里有一些：

```
utf8 "\xCE" does not map to Unicode at F:/Win7programs/Dwimperl/perl/lib/Tie/File.pm line 917
        Tie::File::_read_record('Tie::File=HASH(0x24cb72c)') called at F:/Win7programs/Dwimper
l/perl/lib/Tie/File.pm line 175
        Tie::File::_fetch('Tie::File=HASH(0x24cb72c)', 0) called at F:/Win7programs/Dwimperl/p
erl/lib/Tie/File.pm line 210
        Tie::File::STORE('Tie::File=HASH(0x24cb72c)', 0, 'τι κάνετε;') called at tie file test
.pl line 31
utf8 "\xCF" does not map to Unicode at F:/Win7programs/Dwimperl/perl/lib/Tie/File.pm line 917
        Tie::File::_read_record('Tie::File=HASH(0x24cb72c)') called at F:/Win7programs/Dwimper
l/perl/lib/Tie/File.pm line 175
        Tie::File::_fetch('Tie::File=HASH(0x24cb72c)', 0) called at F:/Win7programs/Dwimperl/p
erl/lib/Tie/File.pm line 210
        Tie::File::STORE('Tie::File=HASH(0x24cb72c)', 0, 'τι κάνετε;') called at tie file test
.pl line 31
utf8 "\xD7" does not map to Unicode at F:/Win7programs/Dwimperl/perl/lib/Tie/File.pm line 917
        Tie::File::_read_record('Tie::File=HASH(0x24cb72c)') called at F:/Win7programs/Dwimper
l/perl/lib/Tie/File.pm line 175
        Tie::File::_fetch('Tie::File=HASH(0x24cb72c)', 0) called at F:/Win7programs/Dwimperl/p
erl/lib/Tie/File.pm line 210
        Tie::File::STORE('Tie::File=HASH(0x24cb72c)', 0, 'τι κάνετε;') called at tie file test
.pl line 31
utf8 "\xD7" does not map to Unicode at F:/Win7programs/Dwimperl/perl/lib/Tie/File.pm line 917
        Tie::File::_read_record('Tie::File=HASH(0x24cb72c)') called at F:/Win7programs/Dwimper
l/perl/lib/Tie/File.pm line 175
        Tie::File::_fetch('Tie::File=HASH(0x24cb72c)', 0) called at F:/Win7programs/Dwimperl/p
erl/lib/Tie/File.pm line 210
        Tie::File::STORE('Tie::File=HASH(0x24cb72c)', 0, 'τι κάνετε;') called at tie file test
.pl line 31 
```

然后它在 STDOUT 上打印：

```
0 τι κάνετε;
1 πάρτε το ή αφήστε το
2 שלום חברים
3 abc לא כןכן efg
4 מתי ולאן This is it
5 מעכשיו לעכשיו
6 Σήμερα είναι Τρίτη
7 Θέλω να φάω
8 τι κάνετε;
9 שורה מס' 5
10
11
12
13
14 \xA4\xΘέλω\xA8\x

15
16
17
18

19 
```

请注意，前 10 行没问题，但第 10 到 19 行不知从何而来！？此外，捆绑文件的输出包含损坏的数据：

```
 τι κάνϏN͏Ŏՠτήστε של חברءbc לؗܗࠗܗߠeמתולאן This is מעיו לעכ؎Ďώݎ֏ναι ΤρΘέώގѠφϏŎ٠κτε;שרה מס'

\xA4\xΘέλω\xA8\x 
```

这里有些不对劲。要么我遗漏了什么，要么 Tie:File 无法处理 Unicode/UTF-8？我在 Windows 7 系统上运行 Strawberry Perl 5.14。

许多 TIA - 海伦

注意：也发布在[http://perlmonks.org/?node_id=1002104](http://perlmonks.org/?node_id=1002104)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T22:45:04.070

我提出的建议很大程度上取决于您要解决的实际问题。*孤立地*看这个问题，我不会有那么多的编码/解码“魔法”，只会使用原始字节（因为脚本不需要知道任何关于这个任务的字符本身）。给定您描述的输入和输出，下面会产生预期的结果。

```
use v5.014;
use warnings;
use autodie;

use Carp::Always;
use Tie::File;

my $file_in = 'test_in.txt';
my $file_out = 'test_tie.txt';

unlink $file_out;

tie my @tied, 'Tie::File', $file_out, recsep => "\x0D\x0A" or die 'tie failed';

open my $fh, '<', $file_in;
while (my $line = <$fh>) {
    chomp $line;
    push @tied, $line;
}
close $fh;

my $i = 0;
say $i++ . ' ' . $_ foreach @tied;

untie @tied; 
```

**但是**，您可能确实想对中间的文本进行一些处理。在这种情况下，您需要解码字符。在我看来，有两种选择：

1.  在移交给绑定阵列之前手动编码
2.  找出 Tie::File 的问题所在

数字 2 可能很重要 - 快速扫描 Tie::File 源，看起来它假设它总是被赋予字节。您似乎可以影响的唯一部分是[https://metacpan.org/source/TODDR/Tie-File-0.98/lib/Tie/File.pm#L111](https://metacpan.org/source/TODDR/Tie-File-0.98/lib/Tie/File.pm#L111)上的 binmode -*您正在做的*。

Tie::File 做了很多`seek`调用，perldoc 在查找时有这样的说法（[http://perldoc.perl.org/functions/seek.html](http://perldoc.perl.org/functions/seek.html)）：

> 请注意*in bytes*：即使文件句柄已设置为对字符进行操作（例如，通过使用 :encoding(utf8) 开放层），tell() 将返回字节偏移量，而不是字符偏移量（因为实现它会呈现 seek( ) 和 tell() 相当慢）。

因此，似乎 Tie::File 正在使用字符长度来确定其记录的字节偏移量。因此，它可能会出现在 UTF-8 字符序列的中间。这似乎是您的错误的可能原因。

一般来说，我不会`binmode`依赖外部模块来读取/写入文件句柄 - 在这种情况下，我会`Encode::encode('UTF-8', ...)`在推送到 @tied 之前对数据进行简单的子调用。

例外情况是模块的文档清楚地说明了解码数据的行为，或者源足够简单，我可以验证行为。

# html - css :checked - 更改 id 的背景颜色

> ID：13209477
> 
> 赞同：2
> 
> 时间：2012-11-03T13:07:51.947
> 
> 标签：html, css

以下是选择器：

```
<label for="choise1" id="l1"></label>
<label for="choise2" id="l2"></label>
<input type="radio" id="choise1" name="navinp" checked="true" />
<input type="radio" id="choise2" name="navinp" /> 
```

和CSS：

```
#choise1:checked ~#l1 
{  background-color: #fff;  }

#choise2:checked ~#l2 
{  background-color: #fff;  } 
```

我认为这应该改变标签`bgcolor`，但点击标签时没有任何反应。怎么了？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-03T13:11:29.623

选择`~`器不适用于当前元素之前的元素。

如果要突出显示标签，则它们必须位于复选框**之后-**[**演示**](http://jsfiddle.net/RnbQ3/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T13:11:36.993

这可能是浏览器问题，因为 Internet Explorer 不支持 Psuedo 类选择器 :checked。

参考：[http ://reference.sitepoint.com/css/pseudoclass-checked](http://reference.sitepoint.com/css/pseudoclass-checked)

# hadoop - 带有 MapReduce 的 HBase

> ID：13209478
> 
> 赞同：2
> 
> 时间：2012-11-03T13:07:54.403
> 
> 标签：hadoop, hbase

我已经在 hadoop 集群上建立了一个 HBase 集群，其中 IPv6 在所有节点中都被禁用。

一切运行良好；我能够使用标准的 Put、Scan、Get 运行 java 客户端来访问 HBase...

我写了一个map-reduce程序来访问HBase，但是我得到了以下错误：

```
Exception in thread "main" java.lang.NullPointerException
at org.apache.hadoop.net.DNS.reverseDns(DNS.java:72)
at org.apache.hadoop.hbase.mapreduce.TableInputFormatBase.reverseDNS(TableInp...
at org.apache.hadoop.hbase.mapreduce.TableInputFormatBase.reverseDNS(TableInp... 
```

这是我在所有节点中的 /etc/hosts 文件：

```
127.0.0.1       localhost.localdomain   localhost
192.168.0.252   master.hadoop.com       master
192.168.0.251   slave.hadoop.com        slave 
```

这是我的 map-reduce 客户端程序：

```
import java.io.IOException;
import java.util.StringTokenizer;

import java.net.InetAddress;
import org.apache.hadoop.net.DNS.*;

import org.apache.hadoop.conf.Configuration;
import org.apache.hadoop.hbase.HBaseConfiguration;
import org.apache.hadoop.hbase.client.HTable;
import org.apache.hadoop.hbase.client.Put;
import org.apache.hadoop.hbase.util.Bytes;
import org.apache.hadoop.hbase.mapreduce.TableMapper;
import org.apache.hadoop.hbase.io.ImmutableBytesWritable;
import org.apache.hadoop.hbase.client.Result;
import org.apache.hadoop.hbase.KeyValue;
import org.apache.hadoop.hbase.client.Scan;
import org.apache.hadoop.hbase.mapreduce.TableMapReduceUtil;

import org.apache.hadoop.io.IntWritable;
import org.apache.hadoop.io.LongWritable;
import org.apache.hadoop.io.Text;

import org.apache.hadoop.mapreduce.Mapper;
import org.apache.hadoop.mapreduce.Reducer;
import org.apache.hadoop.mapreduce.Job;
import org.apache.hadoop.mapreduce.lib.input.FileInputFormat;
import org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;

import org.apache.hadoop.fs.Path;

public class HBaseAndMapReduceExample {

  public static class MyMapper extends TableMapper<ImmutableBytesWritable, Put> {
    public void map(ImmutableBytesWritable row, Result value, Context context) throws IOException, InterruptedException {
      // this example is just copying the data from the source table...
      context.write(row, resultToPut(row,value));
    }

    private static Put resultToPut(ImmutableBytesWritable key, Result result) throws IOException {
      Put put = new Put(key.get());
      for (KeyValue kv : result.raw()) {
        put.add(kv);
      }

      return put;
    }
  }

  public static void main(String[] args) throws Exception {
    Configuration config = HBaseConfiguration.create();
    Job job = new Job(config,"HBaseAndMapReduceExample");
    job.setJarByClass(HBaseAndMapReduceExample.class);  // class that contains mapper

    Scan scan = new Scan();
    scan.setCaching(500);  // 1 is the default in Scan, which will be bad for MapReduce jobs
    scan.setCacheBlocks(false);  // don't set to true for MR jobs
    // set other scan attrs

    TableMapReduceUtil.initTableMapperJob(
    "testtable",      // input table
    scan,             // Scan instance to control CF and attribute selection
    MyMapper.class,   // mapper class
    null,             // mapper output key
    null,             // mapper output value
    job);

    TableMapReduceUtil.initTableReducerJob(
    "testtable2",     // output table
    null,             // reducer class
    job);
    job.setNumReduceTasks(0);

    boolean b = job.waitForCompletion(true);
    if (!b) {
      throw new IOException("error with job!");
    }
  }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T12:56:21.307

还可以尝试添加您的动物园管理员地址：

```
Configuration config = HBaseConfiguration.create();
   conf.setStrings("hbase.zookeeper.quorum",
            "your-zookeeper-addr");
Job job = new Job(config,"HBaseAndMapReduceExample"); 
```

# c++ - 如何在多个文件中使用变量？

> ID：13209480
> 
> 赞同：1
> 
> 时间：2012-11-03T13:08:01.697
> 
> 标签：c++, c, static, include, makefile

我想在标题中定义一个变量并能够在多个文件中使用它。例如，在`a`某处定义了变量，并且能够在 p1.cpp 和 p2.cpp 中使用/更改它

这是一个示例，其中包含我正在尝试做的 3 个简单文件。

```
// vars.hpp
#ifndef VARS_HPP
#define VARS_HPP

int a = 1;
float b = 2.2;
void double_vars();

#endif

// vars.cpp
#include "vars.hpp"
void double_vars () {
    a *= 2;
    b *= 2;
}

// vars_main.cpp
#include <cstdio>
#include "vars.hpp"
int main () {
    printf("a: %d; b: %f\n", a, b);
    double_vars();
    printf("a: %d; b: %f\n", a, b);
} 
```

现在，编译上面的内容：

```
g++ -Wall -W -g vars.cpp vars_main.cpp -o vars && ./vars 
```

给我以下错误：

```
/tmp/ccTPXrSe.o:(.data+0x0): multiple definition of `a'
/tmp/ccnc1vof.o:(.data+0x0): first defined here
/tmp/ccTPXrSe.o:(.data+0x4): multiple definition of `b'
/tmp/ccnc1vof.o:(.data+0x4): first defined here 
```

有人可以向我解释为什么会这样吗？据我所知，我在头文件中有警卫，它应该只包含一次，所以不应该有多个声明

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-03T13:09:49.483

在头文件中，这样写：

```
extern int a;
extern float b; 
```

这将*声明*变量。

在其中一个 CPP 文件中，写入以下内容：

```
int a = 1;
float b = 2.2; 
```

这将*定义*变量。将定义放在哪个 CPP 文件中并不重要，只要变量只定义一次即可。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-03T13:12:33.987

首先，不要这样做。全局可变状态通常是一件坏事。

问题是，一旦链接器完成合并包含语句中的文件，它就会看到两次，一次在 main.cpp 中，一次在 vars_main.cpp 中：

```
int a = 1;
float b = 2.2; 
```

如果您只将它放在头文件中，它会显示在多个翻译单元中，每个`cpp`包含您的头文件的文件一次。编译器不可能知道您在谈论哪个 a 和 b。

解决此问题的方法是`extern`在标头中声明它们：

```
extern int a;
extern float b; 
```

这告诉编译器 a 和 b 是在某处*定义*的，不一定在这部分代码中。

然后，在您的一个 cpp 文件中，您将定义它们：

```
int a = 1;
float b = 2.2; 
```

这样，就有一个明确定义的存储`a`和`b`生存位置，编译器可以正确连接这些点。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-03T15:08:10.433

Collin 已经描述了问题和解决方案，但我想强调这是一种多么糟糕的风格。

正如您从这个简单的练习中发现的那样，以这种方式使用全局变量通常是一件坏事。除了您已经发现的编译器问题之外，使用全局变量在函数之间共享状态会导致以下问题：

*   它使函数本身更难在其他程序中重用，因为函数期望这些符号的存在；

*   对一个函数的更改可能会导致共享该状态的其他函数出现问题（即，更改未本地化到该函数）；

*   代码变得更难调试，因为任何人都可以随时`a`修改`b`。

*理想情况下*，函数应该只通过参数、返回值和异常（如果适用）进行通信；有时共享状态是正确的答案，但这种情况相对较少而且相差甚远。

由于您显然使用的是 C++ 编译器，因此我将以 C++ 的方式执行此操作，使用引用而不是指针。我还将使用 C++`iostream`例程而不是`cstdio`（编写 C 或 C++；尝试将两者混合只会导致胃灼热）。

变量.hpp：

```
#ifndef VARS_H  // Include guard to prevent multiple inclusion
#define VARS_H

void double_vars(int &, float &);

#endif 
```

变量.cpp：

```
#include "vars.hpp"

void double_vars(int &x, float &y)
{
  x *= 2;    
  y *= 2.0;  
} 
```

主.cpp：

```
#include <iostream>
#include "vars.hpp"

int main(void)
{
  int a = 1;
  float b = 2.2;

  std::cout << "a: " << a << "; b: " << b << std::endl;
  double_vars(a, b);
  std::cout << "a: " << a << "; b: " << b << std::endl;

  return 0;
} 
```

由于`x`and`y`被声明为*引用*类型（使用`&`），写入*表达式* `x`和`y`in`double_vars`等同于写入`a`和`b`in `main`。

这样做的 C 方法是使用指针而不是引用：

变量.h：

```
#ifndef VARS_H  // Include guard to prevent multiple inclusion
#define VARS_H

void double_vars(int *, float *); 
#endif 
```

变量.c：

```
#include "vars.h"

void double_vars(int *x, float *y)
{
  *x *= 2;    
  *y *= 2.0;  
} 
```

主.c：

```
#include <stdio.h>
#include "vars.h"

int main(void)
{
  int a = 1;
  float b = 2.2;

  printf("a: %d; b: %f\n", a, b);
  double_vars(&a, &b);
  printf("a: %d; b: %f\n", a, b);
  return 0;
} 
```

在这种情况下，我们使用指针而不是引用，因此我们需要将*表达式* `&a`的结果传递`&b`给`double_vars`; 在函数内，写入表达式`*x`and`*y`与写入`a`和`b`in相同`main`。

# php - 使用控制台安装 Zend Framework 2

> ID：13209481
> 
> 赞同：0
> 
> 时间：2012-11-03T13:08:13.970
> 
> 标签：php, ubuntu, console, zend-framework2

**编辑：** 它现在存在：ZFTool

我正在尝试在我的*ubuntu*系统上安装*Zend Framework 2 。*我已经安装了*ZF1.11.11*，但我想安装最新的*Zend Framework*，*ZF2*。**`apt-get install zend-framework`**

 ***我是 ZF 和 Ubuntu 的新手。所以，对我来说管理一个小项目真的很容易，比如：

```
zf create project
zf create model
zf create action
zf enable layout 
```

因此，如果我使用*composer*、*pyrus*等工具安装 zend，甚至只是将*Zend*提取到`Skeleton Project`中，项目应该可以工作，但我真的会想念控制台。让我的生活更轻松。

有办法吗？有人可以给我一些带有*zf*的控制台命令吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T13:48:27.710

通过命令行安装框架的最常见方法是使用 GIT 和 Composer。查看[官方文档的这一部分以](http://framework.zend.com/manual/2.0/en/user-guide/skeleton-application.html)获取安装指南。

正如 Jani 所提到的，ZF1 中的 CLI 尚未创建。它迟早会到来，但目前还没有。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-09T04:51:12.780

手动安装：

[1）从站点（ http://framework.zend.com/downloads/latest](http://framework.zend.com/downloads/latest)）下载 Zip 文件2）将其解压到 /var/www/ 目录 3）为该目录设置合适的权限

```
$ sudo chmod -R 0755  /var/www/ZendFramework-1.11.12/ 
```

4) 启用 Zend 框架工具或 zf 工具。zf 是一个命令行工具，用于为 zend 应用程序创建项目并执行其他操作。要启用 zf 工具，我们必须创建该工具的符号链接。将命令复制并运行到您的 shell

```
$ ln -s /var/www/ZendFramework-1.11.1/bin/zf.sh  /usr/bin/zf 
```

5) 启用 php.ini 的库路径。

```
include_path = ".:/usr/share/php :/var/www/ZendFramework-1.11.12/library" 
```

6）重启阿帕奇

7) $ zf 创建项目 `/var/www/example`***

# php - 如何在一个函数中存储一个值并在另一个函数中检索该值

> ID：13209486
> 
> 赞同：1
> 
> 时间：2012-11-03T13:09:33.390
> 
> 标签：php, function

我正在尝试在我的网站中实现类似 Twitter 的追随者功能。我的插件中有这样的功能：

```
function current_profile_user_id() {
   return "current profile user id";
}
function button( $args = '' ) {
        $defaults = array(
            'leaderid'   => current_profile_user_id(),
            'followerid' => 'logged in user id'
        );
        return "HTML button";
    } 
```

我可以通过使用函数参数从用户配置文件页面传递当前配置文件用户 ID 值的唯一方法。

假设`$currentuser->ID`返回当前配置文件页面用户值，但此变量仅在配置文件页面中可用。

谁能告诉我如何将该值传递给函数`current_profile_user_id()`、存储该值并返回 html 按钮？

**请注意：**我的许多其他函数也使用`current_profile_user_id()`.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T13:15:10.107

您最好将值保存在会话中。一个函数可能依赖于全局范围，但它不会在页面之间保存。

你可以做类似的事情

```
function currentProfile($profile = False)
{
    if ($profile)
        $_SESSION['curr_profile'] = $profile;
    else
        if (isset($_SESSION['curr_profile']))
            return $_SESSION['curr_profile'];
    return $profile;
}

function current_profile_user_id()
{
    return currentProfile()->ID;
} 
```

然后，尽快将配置文件保存在会话中

```
currentProfile($currentuser); 
```

...应该工作。这样，您可以根据需要更改持久性`curr_profile`，而无需重新访问所有代码。

## 在一个可能相关的笔记上

*（不太清楚你正在尝试做什么以及如何做，我希望这可能会变得有用）*

因此，您有一个用户列表，并希望为每个用户显示一个“关注”模板。用户列表是从某种数据库中检索的，所以你会有类似的东西

```
while($user = $st->fetch(PDO::FETCH_ASSOC))
{
    // Populate the template

    // Append template to display code
} 
```

在该模板中，您将拥有如下内容：

```
<a href="follow.php?id={$user['id']}">Follow {$user['name']}</a> 
```

或者可能是一个 AJAX 调用将该用户添加到登录用户的关注列表而不刷新页面。无论如何，将调用一个*服务器页面*，该页面将收到一个*会话 cookie*和用户选择的 ID。

因此，该页面必须注意新的关注/取消关注，并且它将拥有所需的一切：

1.  要关注的用户的ID，在`$_REQUEST['id']`
2.  追随者的所有数据，在`$_SESSION`.

然后它可以执行，例如，一个查询，例如

```
 INSERT IGNORE INTO followers (follower, followee) VALUES ($id1, $id2); 
```

持久化信息。

# ruby-on-rails - 增加购物车数量 RoR

> ID：13209490
> 
> 赞同：2
> 
> 时间：2012-11-03T13:09:49.983
> 
> 标签：ruby-on-rails, ruby-on-rails-3, if-statement

我正在尝试在我的购物车控制器中创建一个基本设置，如果项目记录已经存在，这将允许我逐步增加添加到购物车的产品的数量值。

我目前有：

```
class ItemsController < ApplicationController

def create  
    @product = Product.find(params[:product_id])

    if @item.new_record?
        @item = Item.create!(:cart => current_cart, :product => @product, :quantity => 1, :unit_price => @product.price)
    else
        @item.increment! :quantity
    end
    redirect_to cart_path(current_cart.id)
end

end 
```

但是我不断收到错误`undefined method`new_record？对于零：NilClass`

人们可以提供任何帮助来解决这个问题，我们将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T13:11:20.350

你还没有在任何地方声明@item。在此之前，这就是错误来的原因

试试这个代码

```
def create  
   @product = Product.find(params[:product_id])

if !current_cart.items.exists?(:product_id => @product.id)
    @item = Item.create!(:cart => current_cart, :product => @product, :quantity => 1, :unit_price => @product.price)
else
    current_cart.items.find(:first, :conditions =>{:product_id => @product.id}).increment! :quantity
end
redirect_to cart_path(current_cart.id)
end 
```

这应该可以解决您的问题

# javascript - 骨干应用程序保存到本地存储但没有 mongodb

> ID：13209492
> 
> 赞同：0
> 
> 时间：2012-11-03T13:10:05.847
> 
> 标签：javascript, mongodb, backbone.js, local-storage

我的应用程序在 localstorage 上成功运行，并且我已经在我的机器上设置了 mongodb 并且可以插入数据等。但是当我尝试将数据保存到 mongodb 时没有任何反应。我认为它没有连接但不确定。

这是我从 localstorage 更改为 mongodb 的地方

```
 bb.model.Items = Backbone.Collection.extend(_.extend({    
     model: bb.model.Item,
     // localStorage: new Store("items"),
    url: '/api/rest/todo', 
```

据我所知，这应该是主干应用程序中唯一的变化。此代码位于 C:\work\ToDo\site\public\js 中。

html 文件位于 C:\work\ToDo\site\public

I have my server code here [http://jsbin.com/akacif/2/watch](http://jsbin.com/akacif/2/watch) which I'm running from C:\work\ToDo\node\lib

Any thoughts?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T17:09:11.837

您是否正确设置了模型的[idAttribute](http://backbonejs.org/#Model-idAttribute)？

从文档中，

> 模型的唯一标识符存储在 id 属性下。如果您直接与使用不同唯一键的后端（CouchDB、MongoDB）通信，您可以设置模型的 idAttribute 以透明地从该键映射到 id。

```
var Meal = Backbone.Model.extend({
  idAttribute: "_id"
});

var cake = new Meal({ _id: 1, name: "Cake" });
alert("Cake id: " + cake.id); 
```

# android - 如何从 URI 获取完整的文件路径

> ID：13209494
> 
> 赞同：127
> 
> 时间：2012-11-03T13:10:33.130
> 
> 标签：android, path, get, uri

我想从 URI 获取完整的文件路径。URI 不是图像，而是音乐文件，但如果我像 MediaStore 解决方案那样做，如果应用程序用户选择例如 Astro 作为浏览器，而不是音乐播放器，它将不起作用。我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：89
> 
> 时间：2017-01-07T09:51:10.680

PathUtil 方法将仅在 oreo 下工作，如果它是 oreo，则可能会崩溃，因为在 oreo 中我们不会获取 id，而是获取 data.getData() 中的整个路径，所以你需要做的就是创建一个文件从 uri 并从 getPath() 获取其路径并将其拆分。下面是工作代码：-

```
Uri uri = data.getData(); 
File file = new File(uri.getPath());//create path from uri
final String[] split = file.getPath().split(":");//split the path.
filePath = split[1];//assign it to a string(your choice). 
```

上面的代码将在 oreo 中工作，如果它低于 oreo 则 PathUtil 将工作。谢谢！

```
String filePath=PathUtil.getPath(context,yourURI); 
```

PathUtil.java

```
import android.annotation.SuppressLint; 
import android.content.ContentUris; 
import android.content.Context; 
import android.database.Cursor; 
import android.net.Uri; 
import android.os.Build; 
import android.os.Environment; 
import android.provider.DocumentsContract;
import android.provider.MediaStore;

import java.net.URISyntaxException;

/**
 * Created by Aki on 1/7/2017.
 */

public class PathUtil {
    /*
     * Gets the file path of the given Uri.
     */
    @SuppressLint("NewApi")
    public static String getPath(Context context, Uri uri) throws URISyntaxException {
        final boolean needToCheckUri = Build.VERSION.SDK_INT >= 19;
        String selection = null;
        String[] selectionArgs = null;
        // Uri is different in versions after KITKAT (Android 4.4), we need to
        // deal with different Uris.
        if (needToCheckUri && DocumentsContract.isDocumentUri(context.getApplicationContext(), uri)) {
            if (isExternalStorageDocument(uri)) {
                final String docId = DocumentsContract.getDocumentId(uri);
                final String[] split = docId.split(":");
                return Environment.getExternalStorageDirectory() + "/" + split[1];
            } else if (isDownloadsDocument(uri)) {
                final String id = DocumentsContract.getDocumentId(uri);
                uri = ContentUris.withAppendedId(
                        Uri.parse("content://downloads/public_downloads"), Long.valueOf(id));
            } else if (isMediaDocument(uri)) {
                final String docId = DocumentsContract.getDocumentId(uri);
                final String[] split = docId.split(":");
                final String type = split[0];
                if ("image".equals(type)) {
                    uri = MediaStore.Images.Media.EXTERNAL_CONTENT_URI;
                } else if ("video".equals(type)) {
                    uri = MediaStore.Video.Media.EXTERNAL_CONTENT_URI;
                } else if ("audio".equals(type)) {
                    uri = MediaStore.Audio.Media.EXTERNAL_CONTENT_URI;
                }
                selection = "_id=?";
                selectionArgs = new String[]{ split[1] };
            }
        }
        if ("content".equalsIgnoreCase(uri.getScheme())) {
            String[] projection = { MediaStore.Images.Media.DATA };
            Cursor cursor = null;
            try {
                cursor = context.getContentResolver().query(uri, projection, selection, selectionArgs, null);
                int column_index = cursor.getColumnIndexOrThrow(MediaStore.Images.Media.DATA);
                if (cursor.moveToFirst()) {
                    return cursor.getString(column_index);
                }
            } catch (Exception e) {
            }
        } else if ("file".equalsIgnoreCase(uri.getScheme())) {
            return uri.getPath();
        }
        return null;
    }

    /**
     * @param uri The Uri to check.
     * @return Whether the Uri authority is ExternalStorageProvider.
     */
    public static boolean isExternalStorageDocument(Uri uri) {
        return "com.android.externalstorage.documents".equals(uri.getAuthority());
    }

    /**
     * @param uri The Uri to check.
     * @return Whether the Uri authority is DownloadsProvider.
     */
    public static boolean isDownloadsDocument(Uri uri) {
        return "com.android.providers.downloads.documents".equals(uri.getAuthority());
    }

    /**
     * @param uri The Uri to check.
     * @return Whether the Uri authority is MediaProvider.
     */
    public static boolean isMediaDocument(Uri uri) {
        return "com.android.providers.media.documents".equals(uri.getAuthority());
    }
} 
```

* * *

## 回答 #2

> 赞同：58
> 
> 时间：2020-03-11T19:10:26.643

当前页面上存在的答案之一（[this](https://stackoverflow.com/questions/13209494/how-to-get-the-full-file-path-from-uri#answer-55469368)）是正确的，但有一些错误。例如，它不适用于 API 29+ 的设备。我将更新上面的代码并发布它的新版本。我认为这篇文章应该被标记为最终答案。

您也可以从我的 GitHub 存储库下载代码：

[GitHub 存储库](https://github.com/saparkhid/AndroidFileNamePicker)

你可以派我更新代码。

更新代码：（**添加了 WhatsApp 支持**）

```
import android.annotation.SuppressLint;
import android.content.ContentUris;
import android.content.Context;
import android.content.Intent;
import android.database.Cursor;
import android.net.Uri;
import android.os.Build;
import android.os.Environment;
import android.provider.DocumentsContract;
import android.provider.MediaStore;
import android.provider.OpenableColumns;
import android.text.TextUtils;
import android.util.Log;
import android.webkit.MimeTypeMap;
import android.widget.Toast;

import java.io.File;
import java.io.FileOutputStream;
import java.io.InputStream;
import java.util.ArrayList;
import java.util.List;

public class FileUtils {
    private static Uri contentUri = null;

    Context context;

    public FileUtils( Context context) {
        this.context=context;
    }

    @SuppressLint("NewApi")
    public static String getPath( final Uri uri) {
        // check here to KITKAT or new version
        final boolean isKitKat = Build.VERSION.SDK_INT >= Build.VERSION_CODES.KITKAT;
        String selection = null;
        String[] selectionArgs = null;
        // DocumentProvider
        if (isKitKat ) {
            // ExternalStorageProvider

           if (isExternalStorageDocument(uri)) {
                final String docId = DocumentsContract.getDocumentId(uri);
                final String[] split = docId.split(":");
                final String type = split[0];

                String fullPath = getPathFromExtSD(split);
                if (fullPath != "") {
                    return fullPath;
                } else {
                    return null;
                }
            }

            // DownloadsProvider

            if (isDownloadsDocument(uri)) {

                if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.M) {
                    final String id;
                    Cursor cursor = null;
                    try {
                        cursor = context.getContentResolver().query(uri, new String[]{MediaStore.MediaColumns.DISPLAY_NAME}, null, null, null);
                        if (cursor != null && cursor.moveToFirst()) {
                            String fileName = cursor.getString(0);
                            String path = Environment.getExternalStorageDirectory().toString() + "/Download/" + fileName;
                            if (!TextUtils.isEmpty(path)) {
                                return path;
                            }
                        }
                    }
                    finally {
                        if (cursor != null)
                            cursor.close();
                    }
                    id = DocumentsContract.getDocumentId(uri);
                    if (!TextUtils.isEmpty(id)) {
                        if (id.startsWith("raw:")) {
                            return id.replaceFirst("raw:", "");
                        }
                        String[] contentUriPrefixesToTry = new String[]{
                                "content://downloads/public_downloads",
                                "content://downloads/my_downloads"
                        };
                        for (String contentUriPrefix : contentUriPrefixesToTry) {
                            try {
                                final Uri contentUri = ContentUris.withAppendedId(Uri.parse(contentUriPrefix), Long.valueOf(id));

                                return getDataColumn(context, contentUri, null, null);
                            } catch (NumberFormatException e) {
                                //In Android 8 and Android P the id is not a number
                                return uri.getPath().replaceFirst("^/document/raw:", "").replaceFirst("^raw:", "");
                            }
                        }

                    }
                }
                else {
                    final String id = DocumentsContract.getDocumentId(uri);

                    if (id.startsWith("raw:")) {
                        return id.replaceFirst("raw:", "");
                    }
                    try {
                        contentUri = ContentUris.withAppendedId(
                                Uri.parse("content://downloads/public_downloads"), Long.valueOf(id));
                    }
                    catch (NumberFormatException e) {
                        e.printStackTrace();
                    }
                    if (contentUri != null) {

                        return getDataColumn(context, contentUri, null, null);
                    }
                }
            }

            // MediaProvider
           if (isMediaDocument(uri)) {
                final String docId = DocumentsContract.getDocumentId(uri);
                final String[] split = docId.split(":");
                final String type = split[0];

                Uri contentUri = null;

                if ("image".equals(type)) {
                    contentUri = MediaStore.Images.Media.EXTERNAL_CONTENT_URI;
                } else if ("video".equals(type)) {
                    contentUri = MediaStore.Video.Media.EXTERNAL_CONTENT_URI;
                } else if ("audio".equals(type)) {
                    contentUri = MediaStore.Audio.Media.EXTERNAL_CONTENT_URI;
                }
                selection = "_id=?";
                selectionArgs = new String[]{split[1]};

                return getDataColumn(context, contentUri, selection,
                        selectionArgs);
            }

           if (isGoogleDriveUri(uri)) {
                return getDriveFilePath(uri);
            }

           if(isWhatsAppFile(uri)){
                return getFilePathForWhatsApp(uri);
            }

           if ("content".equalsIgnoreCase(uri.getScheme())) {

                if (isGooglePhotosUri(uri)) {
                    return uri.getLastPathSegment();
                }
                if (isGoogleDriveUri(uri)) {
                    return getDriveFilePath(uri);
                }
                if( Build.VERSION.SDK_INT >= Build.VERSION_CODES.Q)
                {

                    // return getFilePathFromURI(context,uri);
                    return copyFileToInternalStorage(uri,"userfiles");
                    // return getRealPathFromURI(context,uri);
                }
                else
                {
                    return getDataColumn(context, uri, null, null);
                }

           }
           if ("file".equalsIgnoreCase(uri.getScheme())) {
                return uri.getPath();
            }
        }
        else {

            if(isWhatsAppFile(uri)){
                return getFilePathForWhatsApp(uri);
            }

            if ("content".equalsIgnoreCase(uri.getScheme())) {
                String[] projection = {
                        MediaStore.Images.Media.DATA
                };
                Cursor cursor = null;
                try {
                    cursor = context.getContentResolver()
                            .query(uri, projection, selection, selectionArgs, null);
                    int column_index = cursor.getColumnIndexOrThrow(MediaStore.Images.Media.DATA);
                    if (cursor.moveToFirst()) {
                        return cursor.getString(column_index);
                    }
                } catch (Exception e) {
                    e.printStackTrace();
                }
            }
        }

        return null;
    }

    private  boolean fileExists(String filePath) {
        File file = new File(filePath);

        return file.exists();
    }

    private String getPathFromExtSD(String[] pathData) {
        final String type = pathData[0];
        final String relativePath = "/" + pathData[1];
        String fullPath = "";

        // on my Sony devices (4.4.4 & 5.1.1), `type` is a dynamic string
        // something like "71F8-2C0A", some kind of unique id per storage
        // don't know any API that can get the root path of that storage based on its id.
        //
        // so no "primary" type, but let the check here for other devices
        if ("primary".equalsIgnoreCase(type)) {
            fullPath = Environment.getExternalStorageDirectory() + relativePath;
            if (fileExists(fullPath)) {
                return fullPath;
            }
        }

        // Environment.isExternalStorageRemovable() is `true` for external and internal storage
        // so we cannot relay on it.
        //
        // instead, for each possible path, check if file exists
        // we'll start with secondary storage as this could be our (physically) removable sd card
        fullPath = System.getenv("SECONDARY_STORAGE") + relativePath;
        if (fileExists(fullPath)) {
            return fullPath;
        }

        fullPath = System.getenv("EXTERNAL_STORAGE") + relativePath;
        if (fileExists(fullPath)) {
            return fullPath;
        }

        return fullPath;
    }

    private String getDriveFilePath(Uri uri) {
        Uri returnUri = uri;
        Cursor returnCursor = context.getContentResolver().query(returnUri, null, null, null, null);
        /*
         * Get the column indexes of the data in the Cursor,
         *     * move to the first row in the Cursor, get the data,
         *     * and display it.
         * */
        int nameIndex = returnCursor.getColumnIndex(OpenableColumns.DISPLAY_NAME);
        int sizeIndex = returnCursor.getColumnIndex(OpenableColumns.SIZE);
        returnCursor.moveToFirst();
        String name = (returnCursor.getString(nameIndex));
        String size = (Long.toString(returnCursor.getLong(sizeIndex)));
        File file = new File(context.getCacheDir(), name);
        try {
            InputStream inputStream = context.getContentResolver().openInputStream(uri);
            FileOutputStream outputStream = new FileOutputStream(file);
            int read = 0;
            int maxBufferSize = 1 * 1024 * 1024;
            int bytesAvailable = inputStream.available();

            //int bufferSize = 1024;
            int bufferSize = Math.min(bytesAvailable, maxBufferSize);

            final byte[] buffers = new byte[bufferSize];
            while ((read = inputStream.read(buffers)) != -1) {
                outputStream.write(buffers, 0, read);
            }
            Log.e("File Size", "Size " + file.length());
            inputStream.close();
            outputStream.close();
            Log.e("File Path", "Path " + file.getPath());
            Log.e("File Size", "Size " + file.length());
        } catch (Exception e) {
            Log.e("Exception", e.getMessage());
        }
        return file.getPath();
    }

    /***
     * Used for Android Q+
     * @param uri
     * @param newDirName if you want to create a directory, you can set this variable
     * @return
     */
    private String copyFileToInternalStorage(Uri uri,String newDirName) {
        Uri returnUri = uri;

        Cursor returnCursor = context.getContentResolver().query(returnUri, new String[]{
                OpenableColumns.DISPLAY_NAME,OpenableColumns.SIZE
        }, null, null, null);

        /*
         * Get the column indexes of the data in the Cursor,
         *     * move to the first row in the Cursor, get the data,
         *     * and display it.
         * */
        int nameIndex = returnCursor.getColumnIndex(OpenableColumns.DISPLAY_NAME);
        int sizeIndex = returnCursor.getColumnIndex(OpenableColumns.SIZE);
        returnCursor.moveToFirst();
        String name = (returnCursor.getString(nameIndex));
        String size = (Long.toString(returnCursor.getLong(sizeIndex)));

        File output;
        if(!newDirName.equals("")) {
            File dir = new File(context.getFilesDir() + "/" + newDirName);
            if (!dir.exists()) {
                dir.mkdir();
            }
            output = new File(context.getFilesDir() + "/" + newDirName + "/" + name);
        }
        else{
            output = new File(context.getFilesDir() + "/" + name);
        }
        try {
            InputStream inputStream = context.getContentResolver().openInputStream(uri);
            FileOutputStream outputStream = new FileOutputStream(output);
            int read = 0;
            int bufferSize = 1024;
            final byte[] buffers = new byte[bufferSize];
            while ((read = inputStream.read(buffers)) != -1) {
                outputStream.write(buffers, 0, read);
            }

            inputStream.close();
            outputStream.close();

        }
        catch (Exception e) {

            Log.e("Exception", e.getMessage());
        }

        return output.getPath();
    }

    private String getFilePathForWhatsApp(Uri uri){
            return  copyFileToInternalStorage(uri,"whatsapp");
    }

    private String getDataColumn(Context context, Uri uri, String selection, String[] selectionArgs) {
        Cursor cursor = null;
        final String column = "_data";
        final String[] projection = {column};

        try {
            cursor = context.getContentResolver().query(uri, projection,
                    selection, selectionArgs, null);

            if (cursor != null && cursor.moveToFirst()) {
                final int index = cursor.getColumnIndexOrThrow(column);
                return cursor.getString(index);
            }
        }
        finally {
            if (cursor != null)
                cursor.close();
        }

        return null;
    }

    private  boolean isExternalStorageDocument(Uri uri) {
        return "com.android.externalstorage.documents".equals(uri.getAuthority());
    }

    private  boolean isDownloadsDocument(Uri uri) {
        return "com.android.providers.downloads.documents".equals(uri.getAuthority());
    }

    private  boolean isMediaDocument(Uri uri) {
        return "com.android.providers.media.documents".equals(uri.getAuthority());
    }

    private  boolean isGooglePhotosUri(Uri uri) {
        return "com.google.android.apps.photos.content".equals(uri.getAuthority());
    }

    public boolean isWhatsAppFile(Uri uri){
        return "com.whatsapp.provider.media".equals(uri.getAuthority());
    }

    private  boolean isGoogleDriveUri(Uri uri) {
        return "com.google.android.apps.docs.storage".equals(uri.getAuthority()) || "com.google.android.apps.docs.storage.legacy".equals(uri.getAuthority());
    }

} 
```

* * *

## 回答 #3

> 赞同：50
> 
> 时间：2012-11-03T13:13:16.920

利用：

```
String path = yourAndroidURI.uri.getPath() // "/mnt/sdcard/FileName.mp3"
File file = new File(new URI(path)); 
```

或者

```
String path = yourAndroidURI.uri.toString() // "file:///mnt/sdcard/FileName.mp3"
File file = new File(new URI(path)); 
```

* * *

## 回答 #4

> 赞同：50
> 
> 时间：2019-04-02T07:41:52.810

**从 URI 获取路径 使用下面的类用于 android 所有版本。访问任何类型的 File**。

```
package com.satya.filemangerdemo.common;

import android.annotation.SuppressLint;
import android.content.ContentUris;
import android.content.Context;
import android.database.Cursor;
import android.net.Uri;
import android.os.Build;
import android.os.Environment;
import android.provider.DocumentsContract;
import android.provider.MediaStore;
import android.provider.OpenableColumns;
import android.text.TextUtils;
import android.util.Log;
import java.io.File;
import java.io.FileOutputStream;
import java.io.InputStream;
import java.util.List;

public class FileUtils {
    private static Uri contentUri = null;

    /**
     * Get a file path from a Uri. This will get the the path for Storage Access
     * Framework Documents, as well as the _data field for the MediaStore and
     * other file-based ContentProviders.<br>
     * <br>
     * Callers should check whether the path is local before assuming it
     * represents a local file.
     *
     * @param context The context.
     * @param uri     The Uri to query.
     */
    @SuppressLint("NewApi")
    public static String getPath(final Context context, final Uri uri) {
        // check here to KITKAT or new version
        final boolean isKitKat = Build.VERSION.SDK_INT >= Build.VERSION_CODES.KITKAT;
        String selection = null;
        String[] selectionArgs = null;
        // DocumentProvider
        if (isKitKat && DocumentsContract.isDocumentUri(context, uri)) {
            // ExternalStorageProvider
            if (isExternalStorageDocument(uri)) {
                final String docId = DocumentsContract.getDocumentId(uri);
                final String[] split = docId.split(":");
                final String type = split[0];

                String fullPath = getPathFromExtSD(split);
                if (fullPath != "") {
                    return fullPath;
                } else {
                    return null;
                }
            }

            // DownloadsProvider
            else if (isDownloadsDocument(uri)) {
                if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.M) {
                    final String id;
                    Cursor cursor = null;
                    try {
                        cursor = context.getContentResolver().query(uri, new String[]{MediaStore.MediaColumns.DISPLAY_NAME}, null, null, null);
                        if (cursor != null && cursor.moveToFirst()) {
                            String fileName = cursor.getString(0);
                            String path = Environment.getExternalStorageDirectory().toString() + "/Download/" + fileName;
                            if (!TextUtils.isEmpty(path)) {
                                return path;
                            }
                        }
                    } finally {
                        if (cursor != null)
                            cursor.close();
                    }
                    id = DocumentsContract.getDocumentId(uri);
                    if (!TextUtils.isEmpty(id)) {
                        if (id.startsWith("raw:")) {
                            return id.replaceFirst("raw:", "");
                        }
                        String[] contentUriPrefixesToTry = new String[]{
                                "content://downloads/public_downloads",
                                "content://downloads/my_downloads"
                        };
                        for (String contentUriPrefix : contentUriPrefixesToTry) {
                            try {
                                final Uri contentUri = ContentUris.withAppendedId(Uri.parse(contentUriPrefix), Long.valueOf(id));

                         /*   final Uri contentUri = ContentUris.withAppendedId(
                                    Uri.parse("content://downloads/public_downloads"), Long.valueOf(id));*/

                                return getDataColumn(context, contentUri, null, null);
                            } catch (NumberFormatException e) {
                                //In Android 8 and Android P the id is not a number
                                return uri.getPath().replaceFirst("^/document/raw:", "").replaceFirst("^raw:", "");
                            }
                        }

                    }

                } else {
                    final String id = DocumentsContract.getDocumentId(uri);
                    final boolean isOreo = Build.VERSION.SDK_INT >= Build.VERSION_CODES.O;
                    if (id.startsWith("raw:")) {
                        return id.replaceFirst("raw:", "");
                    }
                    try {
                        contentUri = ContentUris.withAppendedId(
                                Uri.parse("content://downloads/public_downloads"), Long.valueOf(id));

                    } catch (NumberFormatException e) {
                        e.printStackTrace();
                    }
                    if (contentUri != null) {
                        return getDataColumn(context, contentUri, null, null);
                    }
                }

            }
            // MediaProvider
            else if (isMediaDocument(uri)) {
                final String docId = DocumentsContract.getDocumentId(uri);
                final String[] split = docId.split(":");
                final String type = split[0];

                Uri contentUri = null;

                if ("image".equals(type)) {
                    contentUri = MediaStore.Images.Media.EXTERNAL_CONTENT_URI;
                } else if ("video".equals(type)) {
                    contentUri = MediaStore.Video.Media.EXTERNAL_CONTENT_URI;
                } else if ("audio".equals(type)) {
                    contentUri = MediaStore.Audio.Media.EXTERNAL_CONTENT_URI;
                }
                  selection = "_id=?";
                 selectionArgs = new String[]{split[1]};

                return getDataColumn(context, contentUri, selection,
                        selectionArgs);
            } else if (isGoogleDriveUri(uri)) {
                return getDriveFilePath(uri, context);
            }
        }

        // MediaStore (and general)
        else if ("content".equalsIgnoreCase(uri.getScheme())) {

            if (isGooglePhotosUri(uri)) {
                return uri.getLastPathSegment();
            }

            if (isGoogleDriveUri(uri)) {
                return getDriveFilePath(uri, context);
            }
             if( Build.VERSION.SDK_INT == Build.VERSION_CODES.N)
             {
                // return getFilePathFromURI(context,uri);
                 return getMediaFilePathForN(uri, context);
                // return getRealPathFromURI(context,uri);
             }else
             {

                 return getDataColumn(context, uri, null, null);
             }

        }
        // File
        else if ("file".equalsIgnoreCase(uri.getScheme())) {
            return uri.getPath();
        }

        return null;
    }

    /**
     * Check if a file exists on device
     *
     * @param filePath The absolute file path
     */
    private static boolean fileExists(String filePath) {
        File file = new File(filePath);

        return file.exists();
    }

    /**
     * Get full file path from external storage
     *
     * @param pathData The storage type and the relative path
     */
    private static String getPathFromExtSD(String[] pathData) {
        final String type = pathData[0];
        final String relativePath = "/" + pathData[1];
        String fullPath = "";

        // on my Sony devices (4.4.4 & 5.1.1), `type` is a dynamic string
        // something like "71F8-2C0A", some kind of unique id per storage
        // don't know any API that can get the root path of that storage based on its id.
        //
        // so no "primary" type, but let the check here for other devices
        if ("primary".equalsIgnoreCase(type)) {
            fullPath = Environment.getExternalStorageDirectory() + relativePath;
            if (fileExists(fullPath)) {
                return fullPath;
            }
        }

        // Environment.isExternalStorageRemovable() is `true` for external and internal storage
        // so we cannot relay on it.
        //
        // instead, for each possible path, check if file exists
        // we'll start with secondary storage as this could be our (physically) removable sd card
        fullPath = System.getenv("SECONDARY_STORAGE") + relativePath;
        if (fileExists(fullPath)) {
            return fullPath;
        }

        fullPath = System.getenv("EXTERNAL_STORAGE") + relativePath;
        if (fileExists(fullPath)) {
            return fullPath;
        }

        return fullPath;
    }

    private static String getDriveFilePath(Uri uri, Context context) {
        Uri returnUri = uri;
        Cursor returnCursor = context.getContentResolver().query(returnUri, null, null, null, null);
        /*
         * Get the column indexes of the data in the Cursor,
         *     * move to the first row in the Cursor, get the data,
         *     * and display it.
         * */
        int nameIndex = returnCursor.getColumnIndex(OpenableColumns.DISPLAY_NAME);
        int sizeIndex = returnCursor.getColumnIndex(OpenableColumns.SIZE);
        returnCursor.moveToFirst();
        String name = (returnCursor.getString(nameIndex));
        String size = (Long.toString(returnCursor.getLong(sizeIndex)));
        File file = new File(context.getCacheDir(), name);
        try {
            InputStream inputStream = context.getContentResolver().openInputStream(uri);
            FileOutputStream outputStream = new FileOutputStream(file);
            int read = 0;
            int maxBufferSize = 1 * 1024 * 1024;
            int bytesAvailable = inputStream.available();

            //int bufferSize = 1024;
            int bufferSize = Math.min(bytesAvailable, maxBufferSize);

            final byte[] buffers = new byte[bufferSize];
            while ((read = inputStream.read(buffers)) != -1) {
                outputStream.write(buffers, 0, read);
            }
            Log.e("File Size", "Size " + file.length());
            inputStream.close();
            outputStream.close();
            Log.e("File Path", "Path " + file.getPath());
            Log.e("File Size", "Size " + file.length());
        } catch (Exception e) {
            Log.e("Exception", e.getMessage());
        }
        return file.getPath();
    }

    private static String getMediaFilePathForN(Uri uri, Context context) {
        Uri returnUri = uri;
        Cursor returnCursor = context.getContentResolver().query(returnUri, null, null, null, null);
        /*
         * Get the column indexes of the data in the Cursor,
         *     * move to the first row in the Cursor, get the data,
         *     * and display it.
         * */
        int nameIndex = returnCursor.getColumnIndex(OpenableColumns.DISPLAY_NAME);
        int sizeIndex = returnCursor.getColumnIndex(OpenableColumns.SIZE);
        returnCursor.moveToFirst();
        String name = (returnCursor.getString(nameIndex));
        String size = (Long.toString(returnCursor.getLong(sizeIndex)));
        File file = new File(context.getFilesDir(), name);
        try {
            InputStream inputStream = context.getContentResolver().openInputStream(uri);
            FileOutputStream outputStream = new FileOutputStream(file);
            int read = 0;
            int maxBufferSize = 1 * 1024 * 1024;
            int bytesAvailable = inputStream.available();

            //int bufferSize = 1024;
            int bufferSize = Math.min(bytesAvailable, maxBufferSize);

            final byte[] buffers = new byte[bufferSize];
            while ((read = inputStream.read(buffers)) != -1) {
                outputStream.write(buffers, 0, read);
            }
            Log.e("File Size", "Size " + file.length());
            inputStream.close();
            outputStream.close();
            Log.e("File Path", "Path " + file.getPath());
            Log.e("File Size", "Size " + file.length());
        } catch (Exception e) {
            Log.e("Exception", e.getMessage());
        }
        return file.getPath();
    }

    private static String getDataColumn(Context context, Uri uri,
                                        String selection, String[] selectionArgs) {
        Cursor cursor = null;
        final String column = "_data";
        final String[] projection = {column};

        try {
            cursor = context.getContentResolver().query(uri, projection,
                    selection, selectionArgs, null);

            if (cursor != null && cursor.moveToFirst()) {
                final int index = cursor.getColumnIndexOrThrow(column);
                return cursor.getString(index);
            }
        } finally {
            if (cursor != null)
                cursor.close();
        }

        return null;
    }

    /**
     * @param uri - The Uri to check.
     * @return - Whether the Uri authority is ExternalStorageProvider.
     */
    private static boolean isExternalStorageDocument(Uri uri) {
        return "com.android.externalstorage.documents".equals(uri.getAuthority());
    }

    /**
     * @param uri - The Uri to check.
     * @return - Whether the Uri authority is DownloadsProvider.
     */
    private static boolean isDownloadsDocument(Uri uri) {
        return "com.android.providers.downloads.documents".equals(uri.getAuthority());
    }

    /**
     * @param uri - The Uri to check.
     * @return - Whether the Uri authority is MediaProvider.
     */
    private static boolean isMediaDocument(Uri uri) {
        return "com.android.providers.media.documents".equals(uri.getAuthority());
    }

    /**
     * @param uri - The Uri to check.
     * @return - Whether the Uri authority is Google Photos.
     */
    private static boolean isGooglePhotosUri(Uri uri) {
        return "com.google.android.apps.photos.content".equals(uri.getAuthority());
    }

    /**
     * @param uri The Uri to check.
     * @return Whether the Uri authority is Google Drive.
     */
    private static boolean isGoogleDriveUri(Uri uri) {
        return "com.google.android.apps.docs.storage".equals(uri.getAuthority()) || "com.google.android.apps.docs.storage.legacy".equals(uri.getAuthority());
    }

} 
```

但现在根据 android 最新指南，您无法直接访问 getExternalStorageDirectory()。您需要为此实施解决方法

* * *

## 回答 #5

> 赞同：24
> 
> 时间：2012-11-03T13:12:04.687

尝试这个。

```
public String getRealPathFromURI(Uri contentUri) 
{
     String[] proj = { MediaStore.Audio.Media.DATA };
     Cursor cursor = managedQuery(contentUri, proj, null, null, null);
     int column_index = cursor.getColumnIndexOrThrow(MediaStore.Audio.Media.DATA);
     cursor.moveToFirst();
     return cursor.getString(column_index);
} 
```

* * *

## 回答 #6

> 赞同：21
> 
> 时间：2017-01-03T10:03:01.717

**您可以使用从不同的 SDK 版本获取文件路径**

使用 RealPathUtils

```
public class RealPathUtils {

@SuppressLint("NewApi")
public static String getRealPathFromURI_API19(Context context, Uri uri){
    String filePath = "";
    String wholeID = DocumentsContract.getDocumentId(uri);

    // Split at colon, use second item in the array
    String id = wholeID.split(":")[1];

    String[] column = { MediaStore.Images.Media.DATA };

    // where id is equal to
    String sel = MediaStore.Images.Media._ID + "=?";

    Cursor cursor = context.getContentResolver().query(MediaStore.Images.Media.EXTERNAL_CONTENT_URI,
            column, sel, new String[]{ id }, null);

    int columnIndex = cursor.getColumnIndex(column[0]);

    if (cursor.moveToFirst()) {
        filePath = cursor.getString(columnIndex);
    }
    cursor.close();
    return filePath;
}

@SuppressLint("NewApi")
public static String getRealPathFromURI_API11to18(Context context, Uri contentUri) {
    String[] proj = { MediaStore.Images.Media.DATA };
    String result = null;

    CursorLoader cursorLoader = new CursorLoader(
            context,
            contentUri, proj, null, null, null);
    Cursor cursor = cursorLoader.loadInBackground();

    if(cursor != null){
        int column_index =
                cursor.getColumnIndexOrThrow(MediaStore.Images.Media.DATA);
        cursor.moveToFirst();
        result = cursor.getString(column_index);
    }
    return result;
}

public static String getRealPathFromURI_BelowAPI11(Context context, Uri contentUri){
    String[] proj = { MediaStore.Images.Media.DATA };
    Cursor cursor = context.getContentResolver().query(contentUri, proj, null, null, null);
    int column_index
            = cursor.getColumnIndexOrThrow(MediaStore.Images.Media.DATA);
    cursor.moveToFirst();
    return cursor.getString(column_index);
}
} 
```

**现在从 URI 获取文件路径 **

```
 String path = null;
                if (Build.VERSION.SDK_INT < 11)
                    path = RealPathUtils.getRealPathFromURI_BelowAPI11(MainActivity.this, uri);

                    // SDK >= 11 && SDK < 19
                else if (Build.VERSION.SDK_INT < 19)
                    path = RealPathUtils.getRealPathFromURI_API11to18(MainActivity.this, uri);

                    // SDK > 19 (Android 4.4)
                else
                    path = RealPathUtils.getRealPathFromURI_API19(MainActivity.this, uri);
                Log.d(TAG, "File Path: " + path);
                // Get the file instance
                 File file = new File(path); 
```

* * *

## 回答 #7

> 赞同：13
> 
> 时间：2018-06-03T09:03:40.653

```
package com.utils;

import android.annotation.SuppressLint;
import android.content.ContentResolver;
import android.content.ContentUris;
import android.content.Context;
import android.database.Cursor;
import android.net.Uri;
import android.os.Build;
import android.os.Environment;
import android.provider.DocumentsContract;
import android.provider.MediaStore;
import android.support.annotation.RequiresApi;
import android.text.TextUtils;
import android.util.Log;

import org.apache.commons.io.IOUtils;

import java.io.File;
import java.io.FileOutputStream;
import java.io.InputStream;
import java.io.OutputStream;

public class FileUtils {

    /* Get uri related content real local file path. */
    public static String getPath(Context ctx, Uri uri) {
        String ret;
        try {
            if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.KITKAT) {
                // Android OS above sdk version 19.
                ret = getUriRealPathAboveKitkat(ctx, uri);
            } else {
                // Android OS below sdk version 19
                ret = getRealPath(ctx.getContentResolver(), uri, null);
            }
        } catch (Exception e) {
            e.printStackTrace();
            Log.d("DREG", "FilePath Catch: " + e);
            ret = getFilePathFromURI(ctx, uri);
        }
        return ret;
    }

    private static String getFilePathFromURI(Context context, Uri contentUri) {
        //copy file and send new file path
        String fileName = getFileName(contentUri);
        if (!TextUtils.isEmpty(fileName)) {
            String TEMP_DIR_PATH = Environment.getExternalStorageDirectory().getPath();
            File copyFile = new File(TEMP_DIR_PATH + File.separator + fileName);
            Log.d("DREG", "FilePath copyFile: " + copyFile);
            copy(context, contentUri, copyFile);
            return copyFile.getAbsolutePath();
        }
        return null;
    }

    public static String getFileName(Uri uri) {
        if (uri == null) return null;
        String fileName = null;
        String path = uri.getPath();
        int cut = path.lastIndexOf('/');
        if (cut != -1) {
            fileName = path.substring(cut + 1);
        }
        return fileName;
    }

    public static void copy(Context context, Uri srcUri, File dstFile) {
        try {
            InputStream inputStream = context.getContentResolver().openInputStream(srcUri);
            if (inputStream == null) return;
            OutputStream outputStream = new FileOutputStream(dstFile);
            IOUtils.copyStream(inputStream, outputStream); // org.apache.commons.io
            inputStream.close();
            outputStream.close();
        } catch (Exception e) { // IOException
            e.printStackTrace();
        }
    }

    @RequiresApi(api = Build.VERSION_CODES.KITKAT)
    private static String getUriRealPathAboveKitkat(Context ctx, Uri uri) {
        String ret = "";

        if (ctx != null && uri != null) {

            if (isContentUri(uri)) {
                if (isGooglePhotoDoc(uri.getAuthority())) {
                    ret = uri.getLastPathSegment();
                } else {
                    ret = getRealPath(ctx.getContentResolver(), uri, null);
                }
            } else if (isFileUri(uri)) {
                ret = uri.getPath();
            } else if (isDocumentUri(ctx, uri)) {

                // Get uri related document id.
                String documentId = DocumentsContract.getDocumentId(uri);

                // Get uri authority.
                String uriAuthority = uri.getAuthority();

                if (isMediaDoc(uriAuthority)) {
                    String idArr[] = documentId.split(":");
                    if (idArr.length == 2) {
                        // First item is document type.
                        String docType = idArr[0];

                        // Second item is document real id.
                        String realDocId = idArr[1];

                        // Get content uri by document type.
                        Uri mediaContentUri = MediaStore.Images.Media.EXTERNAL_CONTENT_URI;
                        if ("image".equals(docType)) {
                            mediaContentUri = MediaStore.Images.Media.EXTERNAL_CONTENT_URI;
                        } else if ("video".equals(docType)) {
                            mediaContentUri = MediaStore.Video.Media.EXTERNAL_CONTENT_URI;
                        } else if ("audio".equals(docType)) {
                            mediaContentUri = MediaStore.Audio.Media.EXTERNAL_CONTENT_URI;
                        }

                        // Get where clause with real document id.
                        String whereClause = MediaStore.Images.Media._ID + " = " + realDocId;

                        ret = getRealPath(ctx.getContentResolver(), mediaContentUri, whereClause);
                    }

                } else if (isDownloadDoc(uriAuthority)) {
                    // Build download uri.
                    Uri downloadUri = Uri.parse("content://downloads/public_downloads");

                    // Append download document id at uri end.
                    Uri downloadUriAppendId = ContentUris.withAppendedId(downloadUri, Long.valueOf(documentId));

                    ret = getRealPath(ctx.getContentResolver(), downloadUriAppendId, null);

                } else if (isExternalStoreDoc(uriAuthority)) {
                    String idArr[] = documentId.split(":");
                    if (idArr.length == 2) {
                        String type = idArr[0];
                        String realDocId = idArr[1];

                        if ("primary".equalsIgnoreCase(type)) {
                            ret = Environment.getExternalStorageDirectory() + "/" + realDocId;
                        }
                    }
                }
            }
        }

        return ret;
    }

    /* Check whether this uri represent a document or not. */
    @RequiresApi(api = Build.VERSION_CODES.KITKAT)
    private static boolean isDocumentUri(Context ctx, Uri uri) {
        boolean ret = false;
        if (ctx != null && uri != null) {
            ret = DocumentsContract.isDocumentUri(ctx, uri);
        }
        return ret;
    }

    /* Check whether this uri is a content uri or not.
     *  content uri like content://media/external/images/media/1302716
     *  */
    private static boolean isContentUri(Uri uri) {
        boolean ret = false;
        if (uri != null) {
            String uriSchema = uri.getScheme();
            if ("content".equalsIgnoreCase(uriSchema)) {
                ret = true;
            }
        }
        return ret;
    }

    /* Check whether this uri is a file uri or not.
     *  file uri like file:///storage/41B7-12F1/DCIM/Camera/IMG_20180211_095139.jpg
     * */
    private static boolean isFileUri(Uri uri) {
        boolean ret = false;
        if (uri != null) {
            String uriSchema = uri.getScheme();
            if ("file".equalsIgnoreCase(uriSchema)) {
                ret = true;
            }
        }
        return ret;
    }

    /* Check whether this document is provided by ExternalStorageProvider. */
    private static boolean isExternalStoreDoc(String uriAuthority) {
        boolean ret = false;

        if ("com.android.externalstorage.documents".equals(uriAuthority)) {
            ret = true;
        }

        return ret;
    }

    /* Check whether this document is provided by DownloadsProvider. */
    private static boolean isDownloadDoc(String uriAuthority) {
        boolean ret = false;

        if ("com.android.providers.downloads.documents".equals(uriAuthority)) {
            ret = true;
        }

        return ret;
    }

    /* Check whether this document is provided by MediaProvider. */
    private static boolean isMediaDoc(String uriAuthority) {
        boolean ret = false;

        if ("com.android.providers.media.documents".equals(uriAuthority)) {
            ret = true;
        }

        return ret;
    }

    /* Check whether this document is provided by google photos. */
    private static boolean isGooglePhotoDoc(String uriAuthority) {
        boolean ret = false;

        if ("com.google.android.apps.photos.content".equals(uriAuthority)) {
            ret = true;
        }

        return ret;
    }

    /* Return uri represented document file real local path.*/
    @SuppressLint("Recycle")
    private static String getRealPath(ContentResolver contentResolver, Uri uri, String whereClause) {
        String ret = "";

        // Query the uri with condition.
        Cursor cursor = contentResolver.query(uri, null, whereClause, null, null);

        if (cursor != null) {
            boolean moveToFirst = cursor.moveToFirst();
            if (moveToFirst) {

                // Get columns name by uri type.
                String columnName = MediaStore.Images.Media.DATA;

                if (uri == MediaStore.Images.Media.EXTERNAL_CONTENT_URI) {
                    columnName = MediaStore.Images.Media.DATA;
                } else if (uri == MediaStore.Audio.Media.EXTERNAL_CONTENT_URI) {
                    columnName = MediaStore.Audio.Media.DATA;
                } else if (uri == MediaStore.Video.Media.EXTERNAL_CONTENT_URI) {
                    columnName = MediaStore.Video.Media.DATA;
                }

                // Get column index.
                int columnIndex = cursor.getColumnIndex(columnName);

                // Get column value which is the uri related file local path.
                ret = cursor.getString(columnIndex);
            }
        }

        return ret;
    }

} 
```

**在 build.gradle 文件中添加这个**

```
implementation 'org.apache.commons:commons-lang3:3.4' 
```

现在`FileUtils.getPath(context, uri);`从你的主班打电话。

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2018-02-26T18:48:25.173

我知道这已经得到了回答。但是我在评论中发现了一些问题。[我从这里](https://github.com/iPaulPro/aFileChooser/blob/master/aFileChooser/src/com/ipaulpro/afilechooser/utils/FileUtils.java)找到了一个非常可靠的解决方案

**使用它** `File file=FileUtils.getFile(uri);`

```
public class FileUtils {

//replace this with your authority
public static final String AUTHORITY = "com.ianhanniballake.localstorage.documents";

private FileUtils() {
} //private constructor to enforce Singleton pattern

/**
 * TAG for log messages.
 */
static final String TAG = "FileUtils";
private static final boolean DEBUG = false; // Set to true to enable logging

/**
 * @return Whether the URI is a local one.
 */
public static boolean isLocal(String url) {
    if (url != null && !url.startsWith("http://") && !url.startsWith("https://")) {
        return true;
    }
    return false;
}

public static boolean isLocalStorageDocument(Uri uri) {
    return AUTHORITY.equals(uri.getAuthority());
}

/**
 * @param uri The Uri to check.
 * @return Whether the Uri authority is ExternalStorageProvider.
 * @author paulburke
 */
public static boolean isExternalStorageDocument(Uri uri) {
    return "com.android.externalstorage.documents".equals(uri.getAuthority());
}

/**
 * @param uri The Uri to check.
 * @return Whether the Uri authority is DownloadsProvider.
 * @author paulburke
 */
public static boolean isDownloadsDocument(Uri uri) {
    return "com.android.providers.downloads.documents".equals(uri.getAuthority());
}

/**
 * @param uri The Uri to check.
 * @return Whether the Uri authority is MediaProvider.
 * @author paulburke
 */
public static boolean isMediaDocument(Uri uri) {
    return "com.android.providers.media.documents".equals(uri.getAuthority());
}

/**
 * @param uri The Uri to check.
 * @return Whether the Uri authority is Google Photos.
 */
public static boolean isGooglePhotosUri(Uri uri) {
    return "com.google.android.apps.photos.content".equals(uri.getAuthority());
}

/**
 * Get the value of the data column for this Uri. This is useful for
 * MediaStore Uris, and other file-based ContentProviders.
 *
 * @param context       The context.
 * @param uri           The Uri to query.
 * @param selection     (Optional) Filter used in the query.
 * @param selectionArgs (Optional) Selection arguments used in the query.
 * @return The value of the _data column, which is typically a file path.
 * @author paulburke
 */
public static String getDataColumn(Context context, Uri uri, String selection,
                                   String[] selectionArgs) {

    Cursor cursor = null;
    final String column = "_data";
    final String[] projection = {
            column
    };

    try {
        cursor = context.getContentResolver().query(uri, projection, selection, selectionArgs,
                null);
        if (cursor != null && cursor.moveToFirst()) {
            if (DEBUG)
                DatabaseUtils.dumpCursor(cursor);

            final int column_index = cursor.getColumnIndexOrThrow(column);
            return cursor.getString(column_index);
        }
    } finally {
        if (cursor != null)
            cursor.close();
    }
    return null;
}

/**
 * Get a file path from a Uri. This will get the the path for Storage Access
 * Framework Documents, as well as the _data field for the MediaStore and
 * other file-based ContentProviders.<br>
 * <br>
 * Callers should check whether the path is local before assuming it
 * represents a local file.
 *
 * @param context The context.
 * @param uri     The Uri to query.
 * @author paulburke
 * @see #isLocal(String)
 * @see #getFile(Context, Uri)
 */
public static String getPath(final Context context, final Uri uri) {

    final boolean isKitKat = Build.VERSION.SDK_INT >= Build.VERSION_CODES.KITKAT;

    // DocumentProvider
    if (isKitKat && DocumentsContract.isDocumentUri(context, uri)) {
        // LocalStorageProvider
        if (isLocalStorageDocument(uri)) {
            // The path is the id
            return DocumentsContract.getDocumentId(uri);
        }
        // ExternalStorageProvider
        else if (isExternalStorageDocument(uri)) {
            final String docId = DocumentsContract.getDocumentId(uri);
            final String[] split = docId.split(":");
            final String type = split[0];

            if ("primary".equalsIgnoreCase(type)) {
                return Environment.getExternalStorageDirectory() + "/" + split[1];
            }

            // TODO handle non-primary volumes
        }
        // DownloadsProvider
        else if (isDownloadsDocument(uri)) {

            final String id = DocumentsContract.getDocumentId(uri);
            final Uri contentUri = ContentUris.withAppendedId(
                    Uri.parse("content://downloads/public_downloads"), Long.valueOf(id));

            return getDataColumn(context, contentUri, null, null);
        }
        // MediaProvider
        else if (isMediaDocument(uri)) {
            final String docId = DocumentsContract.getDocumentId(uri);
            final String[] split = docId.split(":");
            final String type = split[0];

            Uri contentUri = null;
            if ("image".equals(type)) {
                contentUri = MediaStore.Images.Media.EXTERNAL_CONTENT_URI;
            } else if ("video".equals(type)) {
                contentUri = MediaStore.Video.Media.EXTERNAL_CONTENT_URI;
            } else if ("audio".equals(type)) {
                contentUri = MediaStore.Audio.Media.EXTERNAL_CONTENT_URI;
            }

            final String selection = "_id=?";
            final String[] selectionArgs = new String[]{
                    split[1]
            };

            return getDataColumn(context, contentUri, selection, selectionArgs);
        }
    }
    // MediaStore (and general)
    else if ("content".equalsIgnoreCase(uri.getScheme())) {

        // Return the remote address
        if (isGooglePhotosUri(uri))
            return uri.getLastPathSegment();

        return getDataColumn(context, uri, null, null);
    }
    // File
    else if ("file".equalsIgnoreCase(uri.getScheme())) {
        return uri.getPath();
    }

    return null;
}

/**
 * Convert Uri into File, if possible.
 *
 * @return file A local file that the Uri was pointing to, or null if the
 * Uri is unsupported or pointed to a remote resource.
 * @author paulburke
 * @see #getPath(Context, Uri)
 */
public static File getFile(Context context, Uri uri) {
    if (uri != null) {
        String path = getPath(context, uri);
        if (path != null && isLocal(path)) {
            return new File(path);
        }
    }
    return null;
  }

} 
```

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2021-06-15T16:30:58.493

您可以使用此功能从新 android 和旧版本的 uri 中获取文件

```
fun getFileFromUri(uri: Uri): File? {
    if (uri.path == null) {
        return null
    }
    var realPath = String()
    val databaseUri: Uri
    val selection: String?
    val selectionArgs: Array<String>?
    if (uri.path!!.contains("/document/image:")) {
        databaseUri = MediaStore.Images.Media.EXTERNAL_CONTENT_URI
        selection = "_id=?"
        selectionArgs = arrayOf(DocumentsContract.getDocumentId(uri).split(":")[1])
    } else {
        databaseUri = uri
        selection = null
        selectionArgs = null
    }
    try {
        val column = "_data"
        val projection = arrayOf(column)
        val cursor = context.contentResolver.query(
            databaseUri,
            projection,
            selection,
            selectionArgs,
            null
        )
        cursor?.let {
            if (it.moveToFirst()) {
                val columnIndex = cursor.getColumnIndexOrThrow(column)
                realPath = cursor.getString(columnIndex)
            }
            cursor.close()
        }
    } catch (e: Exception) {
        Log.i("GetFileUri Exception:", e.message ?: "")
    }
    val path = if (realPath.isNotEmpty()) realPath else {
        when {
            uri.path!!.contains("/document/raw:") -> uri.path!!.replace(
                "/document/raw:",
                ""
            )
            uri.path!!.contains("/document/primary:") -> uri.path!!.replace(
                "/document/primary:",
                "/storage/emulated/0/"
            )
            else -> return null
        }
    }
    return File(path)
} 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2018-12-18T06:24:42.567

收到文件路径时的代码段。

```
 Uri fileUri = data.getData();
 FilePathHelper filePathHelper = new FilePathHelper();
 String path = "";
 if (android.os.Build.VERSION.SDK_INT >= android.os.Build.VERSION_CODES.KITKAT) {
       if (filePathHelper.getPathnew(fileUri, this) != null) {
              path = filePathHelper.getPathnew(fileUri, this).toLowerCase();
       } else {
              path = filePathHelper.getFilePathFromURI(fileUri, this).toLowerCase();
       }
 } else {
       path = filePathHelper.getPath(fileUri, this).toLowerCase();
 } 
```

Bellow 是一个可以通过创建新对象来访问的类。您还需要添加到 Gradel 中的依赖项`implementation 'org.apache.directory.studio:org.apache.commons.io:2.4'`

```
public class FilePathHelper {

    public FilePathHelper(){

    }

    public String getMimeType(String url) {
        String type = null;
        String extension = MimeTypeMap.getFileExtensionFromUrl(url.replace(" ", ""));
        if (extension != null) {
            type = MimeTypeMap.getSingleton().getMimeTypeFromExtension(extension);
        }
        return type;
    }

    public String getFilePathFromURI(Uri contentUri, Context context) {
        //copy file and send new file path
        String fileName = getFileName(contentUri);
        if (!TextUtils.isEmpty(fileName)) {
            File copyFile = new File(context.getExternalCacheDir() + File.separator + fileName);
            copy(context, contentUri, copyFile);
            return copyFile.getAbsolutePath();
        }
        return null;
    }

    public void copy(Context context, Uri srcUri, File dstFile) {
        try {
            InputStream inputStream = context.getContentResolver().openInputStream(srcUri);
            if (inputStream == null) return;
            OutputStream outputStream = new FileOutputStream(dstFile);
            IOUtils.copy(inputStream, outputStream);
            inputStream.close();
            outputStream.close();
        } catch (IOException e) {
            e.printStackTrace();
        }
    }

    public String getPath(Uri uri, Context context) {
        String filePath = null;
        final boolean isKitKat = Build.VERSION.SDK_INT >= Build.VERSION_CODES.KITKAT;
        if (isKitKat) {
            filePath = generateFromKitkat(uri, context);
        }

        if (filePath != null) {
            return filePath;
        }

        Cursor cursor = context.getContentResolver().query(uri, new String[]{MediaStore.MediaColumns.DATA}, null, null, null);

        if (cursor != null) {
            if (cursor.moveToFirst()) {
                int columnIndex = cursor.getColumnIndexOrThrow(MediaStore.MediaColumns.DATA);
                filePath = cursor.getString(columnIndex);
            }
            cursor.close();
        }
        return filePath == null ? uri.getPath() : filePath;
    }

    @TargetApi(19)
    private String generateFromKitkat(Uri uri, Context context) {
        String filePath = null;
        if (DocumentsContract.isDocumentUri(context, uri)) {
            String wholeID = DocumentsContract.getDocumentId(uri);

            String id = wholeID.split(":")[1];

            String[] column = {MediaStore.Video.Media.DATA};
            String sel = MediaStore.Video.Media._ID + "=?";

            Cursor cursor = context.getContentResolver().
                    query(MediaStore.Video.Media.EXTERNAL_CONTENT_URI,
                            column, sel, new String[]{id}, null);

            int columnIndex = cursor.getColumnIndex(column[0]);

            if (cursor.moveToFirst()) {
                filePath = cursor.getString(columnIndex);
            }

            cursor.close();
        }
        return filePath;
    }

    public String getFileName(Uri uri) {
        if (uri == null) return null;
        String fileName = null;
        String path = uri.getPath();
        int cut = path.lastIndexOf('/');
        if (cut != -1) {
            fileName = path.substring(cut + 1);
        }
        return fileName;
    }

    @RequiresApi(api = Build.VERSION_CODES.KITKAT)
    public String getPathnew(Uri uri, Context context) {
        final boolean isKitKat = Build.VERSION.SDK_INT >= Build.VERSION_CODES.KITKAT;

        // DocumentProvider
        if (isKitKat && DocumentsContract.isDocumentUri(context, uri)) {
            // ExternalStorageProvider
            if (isExternalStorageDocument(uri)) {
                final String docId = DocumentsContract.getDocumentId(uri);
                final String[] split = docId.split(":");
                final String type = split[0];

                if ("primary".equalsIgnoreCase(type)) {
                    return Environment.getExternalStorageDirectory() + "/" + split[1];
                }
                // TODO handle non-primary volumes
            }
            // DownloadsProvider
            else if (isDownloadsDocument(uri)) {
                final String id = DocumentsContract.getDocumentId(uri);
                final Uri contentUri = ContentUris.withAppendedId(Uri.parse("content://downloads/public_downloads"), Long.valueOf(id));
                return getDataColumn(context, contentUri, null, null);
            }
            // MediaProvider
            else if (isMediaDocument(uri)) {
                final String docId = DocumentsContract.getDocumentId(uri);
                final String[] split = docId.split(":");
                final String type = split[0];
                Uri contentUri = null;
                if ("image".equals(type)) {
                    contentUri = MediaStore.Images.Media.EXTERNAL_CONTENT_URI;
                } else if ("video".equals(type)) {
                    contentUri = MediaStore.Video.Media.EXTERNAL_CONTENT_URI;
                } else if ("audio".equals(type)) {
                    contentUri = MediaStore.Audio.Media.EXTERNAL_CONTENT_URI;
                }
                final String selection = "_id=?";
                final String[] selectionArgs = new String[]{split[1]};
                return getDataColumn(context, contentUri, selection, selectionArgs);
            }
        }
        // MediaStore (and general)
        else if ("content".equalsIgnoreCase(uri.getScheme())) {
            // Return the remote address
            if (isGooglePhotosUri(uri))
                return uri.getLastPathSegment();
            return getDataColumn(context, uri, null, null);
        }
        // File
        else if ("file".equalsIgnoreCase(uri.getScheme())) {
            return uri.getPath();
        }
        return null;
    }

    public String getDataColumn(Context context, Uri uri, String selection, String[] selectionArgs) {
        Cursor cursor = null;
        final String column = "_data";
        final String[] projection = {column};
        try {
            cursor = context.getContentResolver().query(uri, projection, selection, selectionArgs, null);
            if (cursor != null && cursor.moveToFirst()) {
                final int index = cursor.getColumnIndexOrThrow(column);
                return cursor.getString(index);
            }
        } catch (Exception e) {
            e.printStackTrace();
            System.out.println("Something with exception - " + e.toString());
        } finally {
            if (cursor != null)
                cursor.close();
        }
        return null;
    }

    public boolean isExternalStorageDocument(Uri uri) {
        return "com.android.externalstorage.documents".equals(uri.getAuthority());
    }

    /**
     * @param uri The Uri to check.
     * @return Whether the Uri authority is DownloadsProvider.
     */
    public boolean isDownloadsDocument(Uri uri) {
        return "com.android.providers.downloads.documents".equals(uri.getAuthority());
    }

    /**
     * @param uri The Uri to check.
     * @return Whether the Uri authority is MediaProvider.
     */
    public boolean isMediaDocument(Uri uri) {
        return "com.android.providers.media.documents".equals(uri.getAuthority());
    }

    /**
     * @param uri The Uri to check.
     * @return Whether the Uri authority is Google Photos.
     */
    public boolean isGooglePhotosUri(Uri uri) {
        return "com.google.android.apps.photos.content".equals(uri.getAuthority());
    }
} 
```

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2020-10-14T18:45:14.400

```
 public String getPath(Uri uri) {
    Cursor cursor = getContentResolver().query(uri, null, null, null, null);
    cursor.moveToFirst();
    String document_id = cursor.getString(0);
    document_id = document_id.substring(document_id.lastIndexOf(":") + 1);
    cursor.close();

    cursor = getContentResolver().query(
            android.provider.MediaStore.Images.Media.EXTERNAL_CONTENT_URI,
            null, MediaStore.Images.Media._ID + " = ? ", new String[]{document_id}, null);
    cursor.moveToFirst();
    String path = cursor.getString(cursor.getColumnIndex(MediaStore.Images.Media.DATA));
    cursor.close();

    return path;
} 
```

使用这种方法，我们可以从 Uri 获取字符串文件路径。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2019-05-29T07:52:34.133

To get any sort of file path use this (taken from [https://github.com/iPaulPro/aFileChooser](https://github.com/iPaulPro/aFileChooser))

```
package com.yourpackage;

import android.content.ContentResolver;
import android.content.ContentUris;
import android.content.Context;
import android.content.Intent;
import android.database.Cursor;
import android.database.DatabaseUtils;
import android.graphics.Bitmap;
import android.net.Uri;
import android.os.Build;
import android.os.Environment;
import android.provider.DocumentsContract;
import android.provider.MediaStore;
import android.util.Log;
import android.webkit.MimeTypeMap;

import java.io.File;
import java.io.FileFilter;
import java.text.DecimalFormat;
import java.util.Comparator;
import java.util.List;

/**
 * @author Peli
 * @author paulburke (ipaulpro)
 * @version 2013-12-11
 */
public class FileUtils {
    private FileUtils() {
    } //private constructor to enforce Singleton pattern

    /**
     * TAG for log messages.
     */
    static final String TAG = "FileUtils";
    private static final boolean DEBUG = true; // Set to true to enable logging

    public static final String MIME_TYPE_AUDIO = "audio/*";
    public static final String MIME_TYPE_TEXT = "text/*";
    public static final String MIME_TYPE_IMAGE = "image/*";
    public static final String MIME_TYPE_VIDEO = "video/*";
    public static final String MIME_TYPE_APP = "application/*";

    public static final String HIDDEN_PREFIX = ".";

    /**
     * Gets the extension of a file name, like ".png" or ".jpg".
     *
     * @param uri
     * @return Extension including the dot("."); "" if there is no extension;
     * null if uri was null.
     */
    public static String getExtension(String uri) {
        if (uri == null) {
            return null;
        }

        int dot = uri.lastIndexOf(".");
        if (dot >= 0) {
            return uri.substring(dot);
        } else {
            // No extension.
            return "";
        }
    }

    /**
     * @return Whether the URI is a local one.
     */
    public static boolean isLocal(String url) {
        if (url != null && !url.startsWith("http://") && !url.startsWith("https://")) {
            return true;
        }
        return false;
    }

    /**
     * @return True if Uri is a MediaStore Uri.
     * @author paulburke
     */
    public static boolean isMediaUri(Uri uri) {
        return "media".equalsIgnoreCase(uri.getAuthority());
    }

    /**
     * Convert File into Uri.
     *
     * @param file
     * @return uri
     */
    public static Uri getUri(File file) {
        if (file != null) {
            return Uri.fromFile(file);
        }
        return null;
    }

    /**
     * Returns the path only (without file name).
     *
     * @param file
     * @return
     */
    public static File getPathWithoutFilename(File file) {
        if (file != null) {
            if (file.isDirectory()) {
                // no file to be split off. Return everything
                return file;
            } else {
                String filename = file.getName();
                String filepath = file.getAbsolutePath();

                // Construct path without file name.
                String pathwithoutname = filepath.substring(0,
                        filepath.length() - filename.length());
                if (pathwithoutname.endsWith("/")) {
                    pathwithoutname = pathwithoutname.substring(0, pathwithoutname.length() - 1);
                }
                return new File(pathwithoutname);
            }
        }
        return null;
    }

    /**
     * @return The MIME type for the given file.
     */
    public static String getMimeType(File file) {

        String extension = getExtension(file.getName());

        if (extension.length() > 0)
            return MimeTypeMap.getSingleton().getMimeTypeFromExtension(extension.substring(1));

        return "application/octet-stream";
    }

    /**
     * @return The MIME type for the give Uri.
     */
    public static String getMimeType(Context context, Uri uri) {
        File file = new File(getPath(context, uri));
        return getMimeType(file);
    }

    /**
     * @param uri The Uri to check.
     * @return Whether the Uri authority is {@link LocalStorageProvider}.
     * @author paulburke
     */
    public static boolean isLocalStorageDocument(Uri uri) {
        return LocalStorageProvider.AUTHORITY.equals(uri.getAuthority());
    }

    /**
     * @param uri The Uri to check.
     * @return Whether the Uri authority is ExternalStorageProvider.
     * @author paulburke
     */
    public static boolean isExternalStorageDocument(Uri uri) {
        return "com.android.externalstorage.documents".equals(uri.getAuthority());
    }

    /**
     * @param uri The Uri to check.
     * @return Whether the Uri authority is DownloadsProvider.
     * @author paulburke
     */
    public static boolean isDownloadsDocument(Uri uri) {
        return "com.android.providers.downloads.documents".equals(uri.getAuthority());
    }

    /**
     * @param uri The Uri to check.
     * @return Whether the Uri authority is MediaProvider.
     * @author paulburke
     */
    public static boolean isMediaDocument(Uri uri) {
        return "com.android.providers.media.documents".equals(uri.getAuthority());
    }

    /**
     * @param uri The Uri to check.
     * @return Whether the Uri authority is Google Photos.
     */
    public static boolean isGooglePhotosUri(Uri uri) {
        return "com.google.android.apps.photos.content".equals(uri.getAuthority());
    }

    /**
     * Get the value of the data column for this Uri. This is useful for
     * MediaStore Uris, and other file-based ContentProviders.
     *
     * @param context       The context.
     * @param uri           The Uri to query.
     * @param selection     (Optional) Filter used in the query.
     * @param selectionArgs (Optional) Selection arguments used in the query.
     * @return The value of the _data column, which is typically a file path.
     * @author paulburke
     */
    public static String getDataColumn(Context context, Uri uri, String selection,
                                       String[] selectionArgs) {

        Cursor cursor = null;
        final String column = "_data";
        final String[] projection = {
                column
        };

        try {
            cursor = context.getContentResolver().query(uri, projection, selection, selectionArgs,
                    null);
            if (cursor != null && cursor.moveToFirst()) {
                if (DEBUG)
                    DatabaseUtils.dumpCursor(cursor);

                final int column_index = cursor.getColumnIndexOrThrow(column);
                return cursor.getString(column_index);
            }
        }catch (Exception e){
            e.printStackTrace();
        }finally {
            if (cursor != null)
                cursor.close();
        }
        return null;
    }

    /**
     * Get a file path from a Uri. This will quickGet the the path for Storage Access
     * Framework Documents, as well as the _data field for the MediaStore and
     * other file-based ContentProviders.<br>
     * <br>
     * Callers should check whether the path is local before assuming it
     * represents a local file.
     *
     * @param context The context.
     * @param uri     The Uri to query.
     * @author paulburke
     * @see #isLocal(String)
     * @see #getFile(Context, Uri)
     */
    public static String getPath(final Context context, final Uri uri) {

        if (DEBUG)
            Log.d(TAG + " File -",
                    "Authority: " + uri.getAuthority() +
                            ", Fragment: " + uri.getFragment() +
                            ", Port: " + uri.getPort() +
                            ", Query: " + uri.getQuery() +
                            ", Scheme: " + uri.getScheme() +
                            ", Host: " + uri.getHost() +
                            ", Segments: " + uri.getPathSegments().toString()
            );
        // DocumentProvider
        if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.KITKAT && DocumentsContract.isDocumentUri(context, uri)) {
            // LocalStorageProvider
            if (isLocalStorageDocument(uri)) {
                // The path is the id
                return DocumentsContract.getDocumentId(uri);
            }
            // ExternalStorageProvider
            else if (isExternalStorageDocument(uri)) {
                final String docId = DocumentsContract.getDocumentId(uri);
                final String[] split = docId.split(":");
                final String type = split[0];

//                if ("primary".equalsIgnoreCase(type)) {
//                    return Environment.getExternalStorageDirectory() + "/" + split[1];
//                }
                return Environment.getExternalStorageDirectory() + "/" + split[1];

                // TODO handle non-primary volumes
            }
            // DownloadsProvider
            else if (isDownloadsDocument(uri)) {
                try {
                    final String id = DocumentsContract.getDocumentId(uri);
                    Log.d(TAG, "getPath: id= " + id);
                    final Uri contentUri = ContentUris.withAppendedId(Uri.parse("content://downloads/public_downloads"), Long.valueOf(id));
                    return getDataColumn(context, contentUri, null, null);
                }catch (Exception e){
                    e.printStackTrace();
                    List<String> segments = uri.getPathSegments();
                    if(segments.size() > 1) {
                        String rawPath = segments.get(1);
                        if(!rawPath.startsWith("/")){
                            return rawPath.substring(rawPath.indexOf("/"));
                        }else {
                            return rawPath;
                        }
                    }
                }
            }
            // MediaProvider
            else if (isMediaDocument(uri)) {
                final String docId = DocumentsContract.getDocumentId(uri);
                final String[] split = docId.split(":");
                final String type = split[0];

                Uri contentUri = null;
                if ("image".equals(type)) {
                    contentUri = MediaStore.Images.Media.EXTERNAL_CONTENT_URI;
                } else if ("video".equals(type)) {
                    contentUri = MediaStore.Video.Media.EXTERNAL_CONTENT_URI;
                } else if ("audio".equals(type)) {
                    contentUri = MediaStore.Audio.Media.EXTERNAL_CONTENT_URI;
                }

                final String selection = "_id=?";
                final String[] selectionArgs = new String[]{
                        split[1]
                };

                return getDataColumn(context, contentUri, selection, selectionArgs);
            }
        }
        // MediaStore (and general)
        else if ("content".equalsIgnoreCase(uri.getScheme())) {

            // Return the remote address
            if (isGooglePhotosUri(uri))
                return uri.getLastPathSegment();

            return getDataColumn(context, uri, null, null);
        }
        // File
        else if ("file".equalsIgnoreCase(uri.getScheme())) {
            return uri.getPath();
        }

        return null;
    }

    /**
     * Convert Uri into File, if possible.
     *
     * @return file A local file that the Uri was pointing to, or null if the
     * Uri is unsupported or pointed to a remote resource.
     * @author paulburke
     * @see #getPath(Context, Uri)
     */
    public static File getFile(Context context, Uri uri) {
        if (uri != null) {
            String path = getPath(context, uri);
            if (path != null && isLocal(path)) {
                return new File(path);
            }
        }
        return null;
    }

    /**
     * Get the file size in a human-readable string.
     *
     * @param size
     * @return
     * @author paulburke
     */
    public static String getReadableFileSize(int size) {
        final int BYTES_IN_KILOBYTES = 1024;
        final DecimalFormat dec = new DecimalFormat("###.#");
        final String KILOBYTES = " KB";
        final String MEGABYTES = " MB";
        final String GIGABYTES = " GB";
        float fileSize = 0;
        String suffix = KILOBYTES;

        if (size > BYTES_IN_KILOBYTES) {
            fileSize = size / BYTES_IN_KILOBYTES;
            if (fileSize > BYTES_IN_KILOBYTES) {
                fileSize = fileSize / BYTES_IN_KILOBYTES;
                if (fileSize > BYTES_IN_KILOBYTES) {
                    fileSize = fileSize / BYTES_IN_KILOBYTES;
                    suffix = GIGABYTES;
                } else {
                    suffix = MEGABYTES;
                }
            }
        }
        return String.valueOf(dec.format(fileSize) + suffix);
    }

    /**
     * Attempt to retrieve the thumbnail of given File from the MediaStore. This
     * should not be called on the UI thread.
     *
     * @param context
     * @param file
     * @return
     * @author paulburke
     */
    public static Bitmap getThumbnail(Context context, File file) {
        return getThumbnail(context, getUri(file), getMimeType(file));
    }

    /**
     * Attempt to retrieve the thumbnail of given Uri from the MediaStore. This
     * should not be called on the UI thread.
     *
     * @param context
     * @param uri
     * @return
     * @author paulburke
     */
    public static Bitmap getThumbnail(Context context, Uri uri) {
        return getThumbnail(context, uri, getMimeType(context, uri));
    }

    /**
     * Attempt to retrieve the thumbnail of given Uri from the MediaStore. This
     * should not be called on the UI thread.
     *
     * @param context
     * @param uri
     * @param mimeType
     * @return
     * @author paulburke
     */
    public static Bitmap getThumbnail(Context context, Uri uri, String mimeType) {
        if (DEBUG)
            Log.d(TAG, "Attempting to quickGet thumbnail");

        if (!isMediaUri(uri)) {
            Log.e(TAG, "You can only retrieve thumbnails for images and videos.");
            return null;
        }

        Bitmap bm = null;
        if (uri != null) {
            final ContentResolver resolver = context.getContentResolver();
            Cursor cursor = null;
            try {
                cursor = resolver.query(uri, null, null, null, null);
                if (cursor.moveToFirst()) {
                    final int id = cursor.getInt(0);
                    if (DEBUG)
                        Log.d(TAG, "Got thumb ID: " + id);

                    if (mimeType.contains("video")) {
                        bm = MediaStore.Video.Thumbnails.getThumbnail(
                                resolver,
                                id,
                                MediaStore.Video.Thumbnails.MINI_KIND,
                                null);
                    } else if (mimeType.contains(FileUtils.MIME_TYPE_IMAGE)) {
                        bm = MediaStore.Images.Thumbnails.getThumbnail(
                                resolver,
                                id,
                                MediaStore.Images.Thumbnails.MINI_KIND,
                                null);
                    }
                }
            } catch (Exception e) {
                if (DEBUG)
                    Log.e(TAG, "getThumbnail", e);
            } finally {
                if (cursor != null)
                    cursor.close();
            }
        }
        return bm;
    }

    /**
     * File and folder comparator. TODO Expose sorting option method
     *
     * @author paulburke
     */
    public static Comparator<File> sComparator = new Comparator<File>() {
        @Override
        public int compare(File f1, File f2) {
            // Sort alphabetically by lower case, which is much cleaner
            return f1.getName().toLowerCase().compareTo(
                    f2.getName().toLowerCase());
        }
    };

    /**
     * File (not directories) filter.
     *
     * @author paulburke
     */
    public static FileFilter sFileFilter = new FileFilter() {
        @Override
        public boolean accept(File file) {
            final String fileName = file.getName();
            // Return files only (not directories) and skip hidden files
            return file.isFile() && !fileName.startsWith(HIDDEN_PREFIX);
        }
    };

    /**
     * Folder (directories) filter.
     *
     * @author paulburke
     */
    public static FileFilter sDirFilter = new FileFilter() {
        @Override
        public boolean accept(File file) {
            final String fileName = file.getName();
            // Return directories only and skip hidden directories
            return file.isDirectory() && !fileName.startsWith(HIDDEN_PREFIX);
        }
    };

    /**
     * Get the Intent for selecting content to be used in an Intent Chooser.
     *
     * @return The intent for opening a file with Intent.createChooser()
     * @author paulburke
     */
    public static Intent createGetContentIntent() {
        // Implicitly allow the user to select a particular kind of data
        final Intent intent = new Intent(Intent.ACTION_GET_CONTENT);
        // The MIME data type filter
        intent.setType("*/*");
        // Only return URIs that can be opened with ContentResolver
        intent.addCategory(Intent.CATEGORY_OPENABLE);
        return intent;
    }
} 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2021-06-03T10:48:53.460

唯一的问题是获取下载目录的路径或 msf 和 NumberFormat 异常，试试这个。它对我有用

```
 package com.example.bookingmelbourne;
    import android.content.ContentUris;
    import android.content.Context;
    import android.database.Cursor;
    import android.net.Uri;
    import android.os.Build;
    import android.os.Environment;
    import android.provider.DocumentsContract;
    import android.provider.MediaStore;
    import android.provider.OpenableColumns;
    import android.text.TextUtils;
    import android.util.Log;

    import androidx.annotation.Nullable;
    import androidx.annotation.WorkerThread;

    import java.io.File;
    import java.io.FileOutputStream;
    import java.io.IOException;
    import java.io.InputStream;
    import java.io.OutputStream;

    public class FileUtils {
        private static final String TAG = "FileUtils";
    @WorkerThread
    @Nullable
    public static String getReadablePathFromUri(Context context, Uri uri) {

        String path = null;
        if ("file".equalsIgnoreCase(uri.getScheme())) {
            path = uri.getPath();
        }

        if (Build.VERSION.SDK_INT > Build.VERSION_CODES.KITKAT) {
            path = getPath(context, uri);
        }

        if (TextUtils.isEmpty(path)) {
            return path;
        }

        Log.d(TAG, "get path from uri: " + path);
        if (!isReadablePath(path)) {
            int index = path.lastIndexOf("/");
            String name = path.substring(index + 1);
            String dstPath = context.getCacheDir().getAbsolutePath() + File.separator + name;
            if (copyFile(context, uri, dstPath)) {
                path = dstPath;
                Log.d(TAG, "copy file success: " + path);
            } else {
                Log.d(TAG, "copy file fail!");
            } 
        }
        return path;
    }

    public static String getPath(final Context context, final Uri uri) {
        final boolean isKitKat = Build.VERSION.SDK_INT >= Build.VERSION_CODES.KITKAT;
        if (isKitKat && DocumentsContract.isDocumentUri(context, uri)) {
            if (isExternalStorageDocument(uri)) {
                final String docId = DocumentsContract.getDocumentId(uri);
                Log.d("External Storage", docId);
                final String[] split = docId.split(":");
                final String type = split[0];

                if ("primary".equalsIgnoreCase(type)) {
                    return Environment.getExternalStorageDirectory() + "/" + split[1];
                }
            } else if (isDownloadsDocument(uri)) {

                String dstPath = context.getCacheDir().getAbsolutePath() + File.separator + getFileName(context,uri);

                 if (copyFile(context, uri, dstPath)) {
                    Log.d(TAG, "copy file success: " + dstPath);
                    return dstPath;

                } else {
                    Log.d(TAG, "copy file fail!");
                }

            } else if (isMediaDocument(uri)) {
                final String docId = DocumentsContract.getDocumentId(uri);
                final String[] split = docId.split(":");
                final String type = split[0];

                Uri contentUri = null;
                if ("image".equals(type)) {
                    contentUri = MediaStore.Images.Media.EXTERNAL_CONTENT_URI;
                } else if ("video".equals(type)) {
                    contentUri = MediaStore.Video.Media.EXTERNAL_CONTENT_URI;
                } else if ("audio".equals(type)) {
                    contentUri = MediaStore.Audio.Media.EXTERNAL_CONTENT_URI;
                }

                final String selection = "_id=?";
                final String[] selectionArgs = new String[]{split[1]};
                return getDataColumn(context, contentUri, selection, selectionArgs);
            }
        } else if ("content".equalsIgnoreCase(uri.getScheme())) {
            return getDataColumn(context, uri, null, null);
        } else if ("file".equalsIgnoreCase(uri.getScheme())) {
            return uri.getPath();
        }
        return null;
    }

    public static String getFileName(Context context, Uri uri) {

        Cursor cursor = context.getContentResolver().query(uri,null,null,null,null);
        int nameindex = cursor.getColumnIndex(OpenableColumns.DISPLAY_NAME);
        cursor.moveToFirst();

        return  cursor.getString(nameindex);
    }

    private static String getDataColumn(Context context, Uri uri, String selection,
                                        String[] selectionArgs) {
        Cursor cursor = null;
        final String column = "_data";
        final String[] projection = {column};

        try {
            cursor = context.getContentResolver().query(uri, projection, selection, selectionArgs,
                    null);
            if (cursor != null && cursor.moveToFirst()) {
                final int column_index = cursor.getColumnIndexOrThrow(column);
                return cursor.getString(column_index);
            }
        } finally {
            if (cursor != null)
                cursor.close();
        }
        return null;
    }

    private static boolean isExternalStorageDocument(Uri uri) {
        return "com.android.externalstorage.documents".equals(uri.getAuthority());
    }

    private static boolean isDownloadsDocument(Uri uri) {
        return "com.android.providers.downloads.documents".equals(uri.getAuthority());
    }

    private static boolean isMediaDocument(Uri uri) {
        return "com.android.providers.media.documents".equals(uri.getAuthority());
    }

    private static boolean isReadablePath(@Nullable String path) {
        if (TextUtils.isEmpty(path)) {
            return false;
        }
        boolean isLocalPath;
        if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.Q) {
            if (!TextUtils.isEmpty(path)) {
                File localFile = new File(path);
                isLocalPath = localFile.exists() && localFile.canRead();
            } else {
                isLocalPath = false;
            }
        } else {
            isLocalPath = path.startsWith(File.separator);
        }
        return isLocalPath;
    }

    private static boolean copyFile(Context context, Uri uri, String dstPath) {
        InputStream inputStream = null;
        OutputStream outputStream = null;
        try {
            inputStream = context.getContentResolver().openInputStream(uri);
            outputStream = new FileOutputStream(dstPath);

            byte[] buff = new byte[100 * 1024];
            int len;
            while ((len = inputStream.read(buff)) != -1) {
                outputStream.write(buff, 0, len);
            }
        } catch (Exception e) {
            e.printStackTrace();
            return false;
        } finally {
            if (inputStream != null) {
                try {
                    inputStream.close();
                } catch (Exception e) {
                    e.printStackTrace();
                }
            }

            if (outputStream != null) {
                try {
                    outputStream.close();
                } catch (Exception e) {
                    e.printStackTrace();
                }
            }
        }
        return true;
    }

  } 
```

之后，您可以调用此方法传递上下文和 uri 对象

```
FileUtils.getReadablePathFromUri(context,uri) 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2021-11-27T09:05:31.053

由于这里的大多数解决方案都不适用于 `Environment.getExternalStorageDirectory()`不推荐使用的 API 30+，或者解析作为系统内部信息的文档 id，因此值得一问：您真的*需要*路径吗？

如果您只需要一种访问项目数据的方法，那么在所有平台上都有一种直接的方法：

```
fun getInputStream(context: Context, uri: Uri): InputStream? {
    return context.contentResolver.openInputStream(uri)
} 
```

如果需要显示名称（如*test.jpg*），也可以使用内容解析器：

```
fun getDisplayName(context: Context, uri: Uri): String? {
    context.contentResolver.query(uri, arrayOf(OpenableColumns.DISPLAY_NAME), null, null, null)
        .use {
            if (it == null || !it.moveToFirst()) {
                return null
            }

            val columnIndex = it.getColumnIndex(OpenableColumns.DISPLAY_NAME)
            if (columnIndex == -1) {
                return null
            }

            return it.getString(columnIndex)
        }
} 
```

只是想我会提到它，因为它会帮助我。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2020-11-21T13:47:10.303

对于科特林：

只需创建一个名为**URIPathHelper.kt**的新文件。然后将以下实用程序类复制并粘贴到您的文件中。它涵盖了所有场景，适用于所有 Android 版本。其解释将在后面讨论。

```
package com.mvp.handyopinion

import android.content.ContentUris
import android.content.Context
import android.database.Cursor
import android.net.Uri
import android.os.Build
import android.os.Environment
import android.provider.DocumentsContract
import android.provider.MediaStore

class URIPathHelper {

    fun getPath(context: Context, uri: Uri): String? {
        val isKitKatorAbove = Build.VERSION.SDK_INT >= Build.VERSION_CODES.KITKAT

        // DocumentProvider
        if (isKitKatorAbove && DocumentsContract.isDocumentUri(context, uri)) {
            // ExternalStorageProvider
            if (isExternalStorageDocument(uri)) {
                val docId = DocumentsContract.getDocumentId(uri)
                val split = docId.split(":".toRegex()).toTypedArray()
                val type = split[0]
                if ("primary".equals(type, ignoreCase = true)) {
                    return Environment.getExternalStorageDirectory().toString() + "/" + split[1]
                }

            } else if (isDownloadsDocument(uri)) {
                val id = DocumentsContract.getDocumentId(uri)
                val contentUri = ContentUris.withAppendedId(Uri.parse("content://downloads/public_downloads"), java.lang.Long.valueOf(id))
                return getDataColumn(context, contentUri, null, null)
            } else if (isMediaDocument(uri)) {
                val docId = DocumentsContract.getDocumentId(uri)
                val split = docId.split(":".toRegex()).toTypedArray()
                val type = split[0]
                var contentUri: Uri? = null
                if ("image" == type) {
                    contentUri = MediaStore.Images.Media.EXTERNAL_CONTENT_URI
                } else if ("video" == type) {
                    contentUri = MediaStore.Video.Media.EXTERNAL_CONTENT_URI
                } else if ("audio" == type) {
                    contentUri = MediaStore.Audio.Media.EXTERNAL_CONTENT_URI
                }
                val selection = "_id=?"
                val selectionArgs = arrayOf(split[1])
                return getDataColumn(context, contentUri, selection, selectionArgs)
            }
        } else if ("content".equals(uri.scheme, ignoreCase = true)) {
            return getDataColumn(context, uri, null, null)
        } else if ("file".equals(uri.scheme, ignoreCase = true)) {
            return uri.path
        }
        return null
    }

    fun getDataColumn(context: Context, uri: Uri?, selection: String?, selectionArgs: Array<String>?): String? {
        var cursor: Cursor? = null
        val column = "_data"
        val projection = arrayOf(column)
        try {
            cursor = context.getContentResolver().query(uri, projection, selection, selectionArgs,null)
            if (cursor != null && cursor.moveToFirst()) {
                val column_index: Int = cursor.getColumnIndexOrThrow(column)
                return cursor.getString(column_index)
            }
        } finally {
            if (cursor != null) cursor.close()
        }
        return null
    }

    fun isExternalStorageDocument(uri: Uri): Boolean {
        return "com.android.externalstorage.documents" == uri.authority
    }

    fun isDownloadsDocument(uri: Uri): Boolean {
        return "com.android.providers.downloads.documents" == uri.authority
    }

    fun isMediaDocument(uri: Uri): Boolean {
        return "com.android.providers.media.documents" == uri.authority
    }
} 
```

**如何使用 URIPathHelper 类从 URI 获取路径**

```
val uriPathHelper = URIPathHelper()
val filePath = uriPathHelper.getPath(this, YOUR_URI_OBJECT) 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2021-01-20T12:45:04.500

这拯救了我的一天。从 URI 获取路径的最简单方法。

```
 //kotlin
  myuri = data.data
  val realPath = myuri.path
  Log.d(TAG, "path: $realPath") 
```

返回路径：

```
 path: /storage/emulated/0/Download/CutOFF - Escuro (Original Mix).mp3 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2021-05-14T06:16:59.043

如果您有权访问文件并希望避免使用`ContentResolver`或直接读取文件，请参阅答案：[https ://stackoverflow.com/a/67499473/6367262](https://stackoverflow.com/a/67499473/6367262)

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2020-12-11T11:41:43.153

我们都同意 SAF 的设计很糟糕而且*速度很慢*，但 Google 一直在推动我们这样做。鉴于它`getExternalStorageDirectory()`已被长期弃用，并且可能自 11 起就无法使用，我宁愿不使用这些解决方案，因为它距离崩溃只有一次更新......

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2021-02-10T12:07:09.450

**适用于所有 api 版本（在 Android 10 上测试）**

```
val returnCursor: Cursor? = context.contentResolver.query(uri, null, null, null, null)
            val columnIndex = returnCursor.getColumnIndexOrThrow(MediaStore.Images.Media.DATA);
            returnCursor.moveToFirst();
            val path = returnCursor.getString(columnIndex) 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2020-12-30T17:30:47.297

我更喜欢使用[简单存储](https://github.com/anggrayudi/SimpleStorage)：

```
// For document file
val documentFile = DocumentFileCompat.fromUri(context, uri)
val path = documentFile.absolutePath // e.g. /storage/emulated/0/Music/Torisetsu.mp3

// For media file
val mediaFile = MediaFile(context, uri)
val path = mediaFile.absolutePath // e.g. /storage/emulated/0/Music/My Love.mp3 
```

要检查 URI 是媒体文件还是文档文件，请使用`isMediaDocument`扩展功能：

```
val isMediaFile = uri.isMediaDocument 
```

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2021-11-08T10:39:57.323

如果您的目标是 android 11（api 级别 30）或更高版本，即使您从 uri 获取文件路径，您也无法访问该文件，您会发现 FileNotFoundException（权限被拒绝）

因为从 android 11 开始，应用程序只允许从自己的应用程序特定目录（例如：Android/data/packagename）访问文件。

但是有一个权限叫做

> MANAGE_EXTERNAL_STORAGE

这允许应用程序访问所有存储文件。但是，如果您想将您的应用发布到 Play 商店，根据商店政策，此权限不适用于所有类型的应用。检查这个[链接](https://developer.android.com/training/data-storage/manage-all-files)

那么解决方案是什么？

您可以从 URI 获取输入流并使用它，如果它适合您的用例（例如通过改造上传文件，转换为位图等）

如果您迫切需要 File 对象，那么您必须将输入流转换为文件并将其存储在您的应用程序特定目录中。

```
object FileUtils {

val cRes = BaseApplication.instance.contentResolver

@Throws(IOException::class)
fun getInputStream(uri:Uri): InputStream? {
    return if (isVirtualFile(uri)){
        getInputStreamForVirtualFile(uri, getMimeType(uri))
    }else{
        cRes.openInputStream(uri)
    }
}

fun getMimeType(uri: Uri): String? {
    return cRes.getType(uri)
}

private fun isVirtualFile(uri: Uri): Boolean {

    if (!DocumentsContract.isDocumentUri(BaseApplication.instance, uri)) {
        return false
    }

    val cursor: Cursor? = cRes.query(
        uri,
        arrayOf(DocumentsContract.Document.COLUMN_FLAGS),
        null,
        null,
        null
    )

    val flags: Int = cursor?.use {
        if (cursor.moveToFirst()) {
            cursor.getInt(0)
        } else {
            0
        }
    } ?: 0

    return if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.N) {
        flags and DocumentsContract.Document.FLAG_VIRTUAL_DOCUMENT != 0
    } else {
        return false
    }
}

@Throws(IOException::class)
private fun getInputStreamForVirtualFile(
    uri: Uri, mimeTypeFilter: String?): FileInputStream? {

    if (mimeTypeFilter==null){
        throw FileNotFoundException()
    }
    val openableMimeTypes: Array<String>? =
        cRes.getStreamTypes(uri, mimeTypeFilter)

    return if (openableMimeTypes?.isNotEmpty() == true) {
        cRes
            .openTypedAssetFileDescriptor(uri, openableMimeTypes[0], null)?.createInputStream()
    } else {
        throw FileNotFoundException()
    }
}

fun copyStreamToFile(inputStream: InputStream, outputFile: File) {
    inputStream.use { input ->
        val outputStream = FileOutputStream(outputFile)
        outputStream.use { output ->
            val buffer = ByteArray(4 * 1024) // buffer size
            while (true) {
                val byteCount = input.read(buffer)
                if (byteCount < 0) break
                output.write(buffer, 0, byteCount)
            }
            output.flush()
        }
    }
} 
```

}

在打开文件选择器时使用这个

```
 Intent intent = new Intent(Intent.ACTION_OPEN_DOCUMENT); 
```

不是

```
 Intent intent = new Intent(Intent.ACTION_GET_CONTENT); 
```

* * *

## 回答 #22

> 赞同：-1
> 
> 时间：2020-08-03T07:05:57.460

@SAParkhid 在 kotlin 上的回答。

```
class FileUtils @Inject constructor(private val context: Context) {

    private var selection: String? = null
    private var selectionArgs: Array<String>? = null

    fun getFile(uri: Uri): File? {
        val path = getPath(uri)
        return if (path != null) {
            File(path)
        } else {
            null
        }
    }

    fun getPath(uri: Uri): String? {
        // check here to KITKAT or new version
        return if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.KITKAT) {
            getPathForKitKatAndAbove(uri)
        } else {
            getPathBelowKitKat(uri)
        }
    }

    @SuppressLint("NewApi")
    private fun handleExternalStorage(uri: Uri): String? {
        val docId = DocumentsContract.getDocumentId(uri)
        val split = docId.split(":".toRegex()).toTypedArray()
        val fullPath = getPathFromExtSD(split)
        return if (fullPath !== "") {
            fullPath
        } else {
            null
        }
    }

    @SuppressLint("NewApi")
    private fun handleDownloads(uri: Uri): String? {
        if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.M) {
            handleDownloads23ApiAndAbove(uri)
        } else {
            handleDownloadsBelow23Api(uri)
        }
        return null
    }

    @SuppressLint("NewApi")
    private fun handleDownloadsBelow23Api(uri: Uri): String? {
        val id = DocumentsContract.getDocumentId(uri)
        if (id.startsWith("raw:")) {
            return id.replaceFirst("raw:".toRegex(), "")
        }
        var contentUri: Uri? = null
        try {
            contentUri = ContentUris.withAppendedId(
                Uri.parse("content://downloads/public_downloads"), id.toLong()
            )
        } catch (e: NumberFormatException) {
            log(e)
        }
        if (contentUri != null) {
            return getDataColumn(contentUri)
        }
        return null
    }

    @SuppressLint("NewApi")
    private fun handleDownloads23ApiAndAbove(uri: Uri): String? {
        var cursor: Cursor? = null
        try {
            cursor = context.contentResolver
                .query(uri, arrayOf(MediaStore.MediaColumns.DISPLAY_NAME), null, null, null)
            if (cursor != null && cursor.moveToFirst()) {
                val fileName = cursor.getString(0)
                val path: String =
                    Environment.getExternalStorageDirectory().toString() + "/Download/" + fileName
                if (path.isNotEmpty()) {
                    return path
                }
            }
        } finally {
            cursor?.close()
        }
        val id: String = DocumentsContract.getDocumentId(uri)
        if (id.isNotEmpty()) {
            if (id.startsWith("raw:")) {
                return id.replaceFirst("raw:".toRegex(), "")
            }
            val contentUriPrefixesToTry = arrayOf(
                "content://downloads/public_downloads",
                "content://downloads/my_downloads"
            )
            for (contentUriPrefix in contentUriPrefixesToTry) {
                return try {
                    val contentUri = ContentUris.withAppendedId(
                        Uri.parse(contentUriPrefix),
                        id.toLong()
                    )
                    getDataColumn(contentUri)
                } catch (e: NumberFormatException) {
                    //In Android 8 and Android P the id is not a number
                    uri.path.orEmpty().replaceFirst("^/document/raw:".toRegex(), "")
                        .replaceFirst("^raw:".toRegex(), "")
                }
            }
        }
        return null
    }

    @SuppressLint("NewApi")
    private fun handleMedia(uri: Uri): String? {
        val docId = DocumentsContract.getDocumentId(uri)
        val split = docId.split(":".toRegex()).toTypedArray()
        val contentUri: Uri? = when (split[0]) {
            "image" -> {
                MediaStore.Images.Media.EXTERNAL_CONTENT_URI
            }
            "video" -> {
                MediaStore.Video.Media.EXTERNAL_CONTENT_URI
            }
            "audio" -> {
                MediaStore.Audio.Media.EXTERNAL_CONTENT_URI
            }
            else -> null
        }
        selection = "_id=?"
        selectionArgs = arrayOf(split[1])
        return if (contentUri != null) {
            getDataColumn(contentUri)
        } else {
            null
        }
    }

    private fun handleContentScheme(uri: Uri): String? {
        if (isGooglePhotosUri(uri)) {
            return uri.lastPathSegment
        }
        if (isGoogleDriveUri(uri)) {
            return getDriveFilePath(uri)
        }
        return if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.Q) {
            copyFileToInternalStorage(uri, "userfiles")
        } else {
            getDataColumn(uri)
        }
    }

    @SuppressLint("NewApi")
    private fun getPathForKitKatAndAbove(uri: Uri): String? {
        return when {
            // ExternalStorageProvider
            isExternalStorageDocument(uri) -> handleExternalStorage(uri)
            // DownloadsProvider
            isDownloadsDocument(uri) -> handleDownloads(uri)
            // MediaProvider
            isMediaDocument(uri) -> handleMedia(uri)
            //GoogleDriveProvider
            isGoogleDriveUri(uri) -> getDriveFilePath(uri)
            //WhatsAppProvider
            isWhatsAppFile(uri) -> getFilePathForWhatsApp(uri)
            //ContentScheme
            "content".equals(uri.scheme, ignoreCase = true) -> handleContentScheme(uri)
            //FileScheme
            "file".equals(uri.scheme, ignoreCase = true) -> uri.path
            else -> null
        }
    }

    private fun getPathBelowKitKat(uri: Uri): String? {
        if (isWhatsAppFile(uri)) {
            return getFilePathForWhatsApp(uri)
        }
        if ("content".equals(uri.scheme, ignoreCase = true)) {
            val projection = arrayOf(
                MediaStore.Images.Media.DATA
            )
            var cursor: Cursor? = null
            try {
                cursor = context.contentResolver
                    .query(uri, projection, selection, selectionArgs, null)
                val columnIndex = cursor.getColumnIndexOrThrow(MediaStore.Images.Media.DATA)
                if (cursor.moveToFirst()) {
                    return cursor.getString(columnIndex)
                }
            } catch (e: IOException) {
                log(e)
            } finally {
                cursor?.close()
            }
        }
        return null
    }

    private fun fileExists(filePath: String): Boolean {
        val file = File(filePath)
        return file.exists()
    }

    private fun getPathFromExtSD(pathData: Array<String>): String {
        val type = pathData[0]
        val relativePath = "/" + pathData[1]
        var fullPath: String

        // on my Sony devices (4.4.4 & 5.1.1), `type` is a dynamic string
        // something like "71F8-2C0A", some kind of unique id per storage
        // don't know any API that can get the root path of that storage based on its id.
        //
        // so no "primary" type, but let the check here for other devices
        if ("primary".equals(type, ignoreCase = true)) {
            fullPath = Environment.getExternalStorageDirectory().toString() + relativePath
            if (fileExists(fullPath)) {
                return fullPath
            }
        }

        // Environment.isExternalStorageRemovable() is `true` for external and internal storage
        // so we cannot relay on it.
        //
        // instead, for each possible path, check if file exists
        // we'll start with secondary storage as this could be our (physically) removable sd card
        fullPath = System.getenv("SECONDARY_STORAGE").orEmpty() + relativePath
        if (fileExists(fullPath)) {
            return fullPath
        }
        fullPath = System.getenv("EXTERNAL_STORAGE").orEmpty() + relativePath
        return if (fileExists(fullPath)) {
            fullPath
        } else fullPath
    }

    private fun getDriveFilePath(uri: Uri): String? {
        context.contentResolver.query(
            uri, null, null, null, null
        )?.use { cursor ->
            /*
             * Get the column indexes of the data in the Cursor,
             *     * move to the first row in the Cursor, get the data,
             *     * and display it.
             * */
            val nameIndex = cursor.getColumnIndex(OpenableColumns.DISPLAY_NAME)
            cursor.moveToFirst()
            val name = cursor.getString(nameIndex)
            val file = File(context.cacheDir, name)
            try {
                val inputStream = context.contentResolver.openInputStream(uri)!!
                val outputStream = FileOutputStream(file)
                val bytesAvailable = inputStream.available()

                val bufferSize = min(bytesAvailable, MAX_BUFFER_SIZE)
                val buffers = ByteArray(bufferSize)
                var read: Int
                while (inputStream.read(buffers).also { read = it } != -1) {
                    outputStream.write(buffers, 0, read)
                }
                inputStream.close()
                outputStream.close()
            } catch (e: IOException) {
                log(e)
            } finally {
                cursor.close()
            }
            return file.path
        }
        return null
    }

    /***
     * Used for Android Q+
     * @param uri
     * @param newDirName if you want to create a directory, you can set this variable
     * @return
     */
    private fun copyFileToInternalStorage(uri: Uri, newDirName: String): String? {
        context.contentResolver.query(
            uri, arrayOf(OpenableColumns.DISPLAY_NAME, OpenableColumns.SIZE), null, null, null
        )?.use { cursor ->
            /*
             * Get the column indexes of the data in the Cursor,
             *     * move to the first row in the Cursor, get the data,
             *     * and display it.
             * */
            val nameIndex = cursor.getColumnIndex(OpenableColumns.DISPLAY_NAME)
            cursor.moveToFirst()
            val name = cursor.getString(nameIndex)
            val output: File = if (newDirName != "") {
                val dir = File(context.filesDir.toString() + "/" + newDirName)
                if (!dir.exists()) {
                    dir.mkdir()
                }
                File(context.filesDir.toString() + "/" + newDirName + "/" + name)
            } else {
                File(context.filesDir.toString() + "/" + name)
            }
            try {
                val inputStream = context.contentResolver.openInputStream(uri) ?: return null
                val outputStream = FileOutputStream(output)
                var read: Int
                val buffers = ByteArray(BUFFER_SIZE)
                while (inputStream.read(buffers).also { read = it } != -1) {
                    outputStream.write(buffers, 0, read)
                }
                inputStream.close()
                outputStream.close()
            } catch (e: IOException) {
                log(e)
            } finally {
                cursor.close()
            }
            return output.path
        }
        return null
    }

    private fun getFilePathForWhatsApp(uri: Uri): String? {
        return copyFileToInternalStorage(uri, "whatsapp")
    }

    private fun getDataColumn(uri: Uri): String? {
        var cursor: Cursor? = null
        val column = "_data"
        val projection = arrayOf(column)
        try {
            cursor = context.contentResolver.query(
                uri, projection,
                selection, selectionArgs, null
            )
            if (cursor != null && cursor.moveToFirst()) {
                val index = cursor.getColumnIndexOrThrow(column)
                return cursor.getString(index)
            }
        } finally {
            cursor?.close()
        }
        return null
    }

    private fun isExternalStorageDocument(uri: Uri): Boolean {
        return EXTERNAL_STORAGE_CONTENT == uri.authority
    }

    private fun isDownloadsDocument(uri: Uri): Boolean {
        return DOWNLOAD_DOCUMENT_CONTENT == uri.authority
    }

    private fun isMediaDocument(uri: Uri): Boolean {
        return MEDIA_DOCUMENT_CONTENT == uri.authority
    }

    private fun isGooglePhotosUri(uri: Uri): Boolean {
        return GOOGLE_PHOTOS_CONTENT == uri.authority
    }

    private fun isWhatsAppFile(uri: Uri): Boolean {
        return WHATS_APP_CONTENT == uri.authority
    }

    private fun isGoogleDriveUri(uri: Uri): Boolean {
        return GOOGLE_DRIVE_CONTENT == uri.authority || "com.google.android.apps.docs.storage.legacy" == uri.authority
    }

    companion object {
        private const val BUFFER_SIZE = 1024
        private const val MAX_BUFFER_SIZE = 1024 * 1024
        private const val GOOGLE_DRIVE_CONTENT = "com.google.android.apps.docs.storage"
        private const val WHATS_APP_CONTENT = "com.whatsapp.provider.media"
        private const val GOOGLE_PHOTOS_CONTENT = "com.google.android.apps.photos.content"
        private const val MEDIA_DOCUMENT_CONTENT = "com.android.providers.media.documents"
        private const val DOWNLOAD_DOCUMENT_CONTENT = "com.android.providers.downloads.documents"
        private const val EXTERNAL_STORAGE_CONTENT = "com.android.externalstorage.documents"
    }
} 
```

* * *

## 回答 #23

> 赞同：-2
> 
> 时间：2018-01-10T06:00:42.637

我很难在 Xamarin 上弄清楚这一点。根据上面的建议，我想出了这个解决方案。

```
private string getRealPathFromURI(Android.Net.Uri contentUri)
{
    string filename = "";
    string thepath = "";
    Android.Net.Uri filePathUri;
    ICursor cursor = this.ContentResolver.Query(contentUri, null, null, null, null);

    if (cursor.MoveToFirst())
    {
        int column_index = cursor.GetColumnIndex(MediaStore.Images.Media.InterfaceConsts.Data);//Instead of "MediaStore.Images.Media.DATA" can be used "_data"
        filePathUri = Android.Net.Uri.Parse(cursor.GetString(column_index));
        filename = filePathUri.LastPathSegment;
        thepath = filePathUri.Path;
    }

    return thepath;
} 
```

* * *

## 回答 #24

> 赞同：-28
> 
> 时间：2012-11-03T16:24:08.513

```
String uri_path = "file:///mnt/sdcard/FileName.mp3";
File f = new removeUriFromPath(uri_path));
public static String removeUriFromPath(String uri)
{
  return  uri.substring(7, uri.length());
} 
```

# webview - 在 WebView（Windows 应用商店应用）中与 HTML5 视频播放器交互

> ID：13209495
> 
> 赞同：0
> 
> 时间：2012-11-03T13:10:34.933
> 
> 标签：webview, windows-8, html5-video, code-behind, windows-store-apps

在我的 Windows Store 应用程序中，我有一个 WebView 来显示视频：

```
<WebView x:Name="MyWebView" /> 
```

然后在 Code-Behind (C#) 中导航到我的视频：

```
string EmbedUrl = "http://www.808.dk/pics/video/gizmo.mp4";
string EmbedCode = String.Format("<video id=\"Video1\" width=\"853\" height=\"480\" controls=\"controls\" autoplay=\"autoplay\"><source src=\"{0}\" type=\"video/mp4\" /></video>", EmbedUrl);
MyWebView.NavigateToString(EmbedCode); 
```

然后我得到一个不错的 HTML5 视频播放器：

![在此处输入图像描述](../Images/dc11f8a7b4dfda8471caefbb156f6f66.png)

现在我想用 C# 访问这个播放器来开始或停止视频。当用户切换到全屏模式时，我还希望在我的代码隐藏中收到通知。

有谁知道这是怎么做到的吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T21:20:44.487

在 webview 元素中创建“function pause(){}”和“function play()”的一部分。

然后只需在您的 xaml.cs 中调用此代码

```
webview.InvokeScript("pause", null); 
```

“暂停”是该 webview 元素中的 javascript 函数的名称。

# java - Spring MVC 国际化

> ID：13209496
> 
> 赞同：1
> 
> 时间：2012-11-03T13:10:35.970
> 
> 标签：java, spring, internationalization

我正在尝试在我的 spring mvc 应用程序中使用国际化。但我不知道如何将它用于输入。我想做这样的事情：

```
<input id="actionButton" type="submit" value='<spring:message code="LogIn"/>'/> 
```

但是按钮比标签'spring：message code =“LogIn”'，而不是.properties文件中这个常量的值。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T13:51:48.423

您是否考虑过将 spring:message 内容存储到 var，然后用 $ 引用该 var？

一个非常有用的教程在这里：[http ://springbyexample.org/examples/basic-webapp-internationalization.html](http://springbyexample.org/examples/basic-webapp-internationalization.html)

您必须在 applicationContext 中有一个拦截器，例如

```
<mvc:interceptors>
        <bean
            class="org.springframework.web.servlet.i18n.LocaleChangeInterceptor">
            <property name="paramName" value="lang" />
        </bean>
</mvc:interceptors> 
```

你还需要

```
<bean id="messageSource" class="org.springframework.context.support.ReloadableResourceBundleMessageSource">
        <property name="basename" value="classpath:messages" />
        <property name="defaultEncoding" value="UTF-8" />
    </bean>

    <bean id="localeResolver"
        class="org.springframework.web.servlet.i18n.SessionLocaleResolver"/> 
```

我还想在您的 xml 开头添加以下内容：

```
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:tx="http://www.springframework.org/schema/tx" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:p="http://www.springframework.org/schema/p" xmlns:mvc="http://www.springframework.org/schema/mvc"
    xmlns:context="http://www.springframework.org/schema/context"
    xmlns:util="http://www.springframework.org/schema/util"
    xmlns:security="http://www.springframework.org/schema/security"
    xsi:schemaLocation="http://www.springframework.org/schema/beans 
     http://www.springframework.org/schema/beans/spring-beans.xsd
     http://www.springframework.org/schema/context 
     http://www.springframework.org/schema/context/spring-context.xsd
     http://www.springframework.org/schema/tx
     http://www.springframework.org/schema/tx/spring-tx-3.0.xsd
     http://www.springframework.org/schema/mvc 
     http://www.springframework.org/schema/mvc/spring-mvc-3.0.xsd
     http://www.springframework.org/schema/util
     http://www.springframework.org/schema/util/spring-util-3.0.xsd
     http://www.springframework.org/schema/security
     http://www.springframework.org/schema/security/spring-security-3.0.xsd"> 
```

为了识别诸如 mvc 之类的前缀是必要的。确保你拥有它。

我的 messages_*.properties 文件位于源文件夹 src/main/resources 中，而不是 webapp 中，我不知道这是否重要。

# python - `hash` 方法的使用

> ID：13209501
> 
> 赞同：-1
> 
> 时间：2012-11-03T13:11:05.530
> 
> 标签：python, hash

您如何使用该`hash`方法？

```
>>> def foo():
>>>    return 'foo'
>>> f = foo()
>>>
>>> hash(f)
-4177197833195190597
>>>
>>> hash(foo)
1643374
>>>
>>> hash(foo())
-4177197833195190597 
```

我可以用它做什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T13:15:22.867

从[文档](http://docs.python.org/2/library/functions.html#hash)：

> 返回对象的哈希值（如果有的话）。哈希值是整数。**它们用于**在字典查找期间快速比较字典键。比较相等的数值具有相同的哈希值（即使它们是不同的类型，如 1 和 1.0 的情况）。

# java - 如何从 InputStream 中读取二进制协议？

> ID：13209502
> 
> 赞同：1
> 
> 时间：2012-11-03T13:11:09.410
> 
> 标签：java, serial-port, protocols, inputstream, binary-data

我尝试从我的 Java 串行端口读取二进制协议。我使用[RXTX 库](http://rxtx.qbang.org/wiki/index.php/Main_Page)从串口读取。

该协议是用于 GPS 接收器的 SiRF 二进制协议。结构是：

*   前两个字节是 0xA0 和 0xA2，它们定义了数据帧的开始
*   接下来的两个字节是有效载荷长度 n
*   接下来的 n 个字节是有效载荷
*   最后两个字节是 0xB0 和 0xB3，它们定义了一个数据帧的结束

虽然这个结构很简单，但我无法正确读取数据。我尝试了两种不同的方法：

1.  我写了一个线程，它从 0xA0 读取`InputStream`并将输入与 0xA0 进行比较。如果匹配，则线程读取下一个字节并与 0xA2 进行比较。如果再次匹配，它将读取接下来的两个字节并计算有效负载长度。之后，它读取长度为 n 字节的有效负载。最后，它读取最后两个字节并将它们与 0xB0 和 0xB3 进行比较。当一切都匹配时，它会从输入中创建一个十六进制字符串并将其保存到队列中。这是我的代码：

    ```
    try {
        byte[] size = new byte[2];
        byte[] checkSum = new byte[2];
        byte[] packet;
        int bytesRead = -1;
        while (in.available() > 0) {
            if (getInput() == 0xA0) {
                if (getInput() == 0xA2) {
                    System.out.print("160,162,");
                    bytesRead = in.read(size);
                    int payLoadLength = (size[0] << 8) | (size[1] & 0xFF);
                    byte[] payload = new byte[payLoadLength];
                    bytesRead = in.read(payload);
                    bytesRead = in.read(checkSum);
                    if (getInput() == 0xB0) {
                        if (getInput() == 0xB3) {
                    System.out.println("out");
                    packet = new byte[2 + 2 + payLoadLength + 2 + 2];
                    packet[0] = (byte) START_1;
                    packet[1] = (byte) START_2;
                    packet[2] = size[0];
                    packet[3] = size[1];
                    for (int i = 0; i < payload.length; i++) {
                        packet[i + 4] = payload[i];
                    }
                    packet[packet.length - 4] = checkSum[0];
                    packet[packet.length - 3] = checkSum[1];
                    packet[packet.length - 2] = (byte) END_1;
                    packet[packet.length - 1] = (byte) END_2;
                    StringBuffer hexString = new StringBuffer();
                    int[] output = new int[packet.length];
                    for (int i = 0; i < packet.length; i++) {
                        output[i] = 0xFF & packet[i];
                        hexString.append(Integer.toHexString(output[i]));
                    }
                    TransportMessage tm = new TransportMessage(hexString.toString());
                    boolean b = queue.offer(tm);
                    System.out.println(hexString.toString().toUpperCase());
                    if(!b)
                        System.err.println("TransportMessageQueue voll!");
                }
            } else {
                System.out.println();
            }
        }
    } 
        }
    } catch (IOException e) {
        System.out.println(e);
    } 
    ```

    `getInput()`只是从`InputStream`.

2.  我使用了`SerialPortEventListener`来自 RXTX 库的。每次串行端口上发生某些事情时，都会触发 SerialPortEvent 并且我以与第一种方法类似的方式读取数据。

出于调试原因，我添加了几个`System.out.println()`调用来显示线程究竟读取了什么，似乎我错过了通过`InputStream`.

我现在的问题是：从 中读取这样的协议的最佳方法是什么`InputStream`？在我看来，我必须让我的阅读工作与串行端口的数据同步，但我不知道如何在 Java 中做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T13:21:14.230

如果你使用 RXTX，你可以设置一个监听器，当数据可用时异步通知你：

```
serial.notifyOnDataAvailable(true);
serial.addEventListener(this);

public void serialEvent(final SerialPortEvent arg0) {
    try {
        if (arg0.getEventType() == SerialPortEvent.DATA_AVAILABLE) {
            //read from the input stream;
        }
    } catch (final Exception e) {
        e.printStackTrace();
    }
} 
```

通常，当您从输入流中读取数据时，您应该抽象“数据包”的概念，而不是使用“可用”功能 - 只需从数据包中读取足够的数据以确定其长度，然后只需使用“ read(byte[])" 将完整的数据包读入缓冲区。（在更高级的注释中，“读取”可以读取比需要更少的字节，因此应该在循环中使用）。

# delphi - 如何在设计时运行代码？

> ID：13209506
> 
> 赞同：1
> 
> 时间：2012-11-03T13:11:26.560
> 
> 标签：delphi

如何在设计时运行一些代码来更改表单上的某些内容？

我已经尝试过了，但这仅在运行时有效：

```
constructor TForm1.Create(AOwner: TComponent);
begin
  inherited;
  Form1.Font.Color := clRed;
end; 
```

我知道有像“注册”这样的“神奇”程序并且有“初始化”，但我认为这些在这里没有帮助。

请注意，我的观点不仅仅是将字体颜色更改为红色，而是对表单外观进行复杂的更改，我希望在设计时看到。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T13:22:30.397

如果您要进行大量此类操作或复杂操作，最好在运行时进行此设计工作。创建属性编辑器不是很多工作，在运行时操作小部件树也不是。

# ruby-on-rails - 清单中未定义的 HTML5 缓存清单缓存请求

> ID：13209507
> 
> 赞同：2
> 
> 时间：2012-11-03T13:11:28.073
> 
> 标签：ruby-on-rails, html, local-storage, html5-appcache

我正在处理需要缓存某些请求的应用程序

所以我在 HTML5 缓存中苦苦挣扎

这是我的清单文件

```
CACHE MANIFEST
# 2d25a26de3a1148a2fa5e534325f84cca2184090174c6ba451451c54f71f52d6
assets/application.js
assets/application.css
assets/glyphicons/png/glyphicons_064_lightbulb.png
assets/jquery-mobile/ajax-loader.gif
assets/jquery-mobile/icons-18-white.png
application.manifest

NETWORK:
/project_show
/application.manifest 
```

现在我的`/projects_show`页面内容看起来像这样

```
<div data-role="header" class="header">
</div>

<div data-role="content" class="content">
</div>  

<div data-role="footer" class="footer" style="text-align:center">   
</div>  

<script type="text/javascript">
    <%= store_key %>
</script>

<script id="header" type="text/template">
    <h1>Listing of {{ carName   }}</h1>
</script>

<script id="content" type="text/template">
    <span>{{ pageName }}</span>
</script>

<script id="footer" type="text/template">
    <span> CopyRight &copy; {{ user }} </span> 
</script>

<script type="text/javascript">

    $(document).ready(function() {
        if (window.navigator.onLine) {
                $.getJSON('/project/2.json',function(data) {

                   localStorage.setItem("acura",JSON.stringify(data));

                        var carTemplate = $('#header').html();
                        var pageTemplate = $('#content').html();
                        var footerTemplate = $("#footer").html();
                        $('div.header').html(Mustache.to_html(carTemplate, data));
                    $('div.content').html(Mustache.to_html(pageTemplate, data));
                $('div.footer').html(Mustache.to_html(footerTemplate,data));

                    })

      else {
            var data = JSON.parse(localStorage.getItem("acura"))
            var carTemplate = $('#header').html();
                var pageTemplate = $('#content').html();
                var footerTemplate = $("#footer").html();
            $('div.header').html(Mustache.to_html(carTemplate, data));
                $('div.content').html(Mustache.to_html(pageTemplate, data));
                $('div.footer').html(Mustache.to_html(footerTemplate,data));
      }             
    })
</script> 
```

您可以看到这里的想法是，如果用户在线，`json`则从服务器获取响应，如果没有，则从服务器获取数据`localStorage`

不幸的是，由于原因，上面的代码不起作用

a) 缓存清单文件`ajax`也在缓存请求

现在可以看到我没有要求 HTML 缓存清单来缓存`json`请求

IE`/projects/2.json`

谁能告诉我为什么会这样

`GET`如果将请求修改为`POST`请求即`a POST request to`/projects/2.json ，则上述代码可以正常工作`instead of GET`

但这不是我想要的任何建议

FYI Manifest 确实正确地遵循了清单文件，因为我也注意到我`/projects`的缓存即使没有在`manifest`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-25T22:10:09.693

这也让我发疯了。我发现有效的是添加到清单的网络部分“index.html#content”。你的工作方式我认为你还需要添加“index.html#header”和“index.html#footer” ”。

我认为发生了什么是 index.html 被缓存了。“内容”“页眉”和“页脚”是其中的一部分。因此，加载这些部分（或在我的情况下为页面）的调用被捕获，并且 ajax 调用没有运行，因为 index.html 被缓存。通过将 index.html#content 添加到 NETWORK 部分，它会强制调用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T23:04:05.050

尝试添加`/project/2.json`到`NETWORK`清单的部分。然后应该始终从服务器而不是从应用程序缓存提供对该 URL 的请求。

关于您的`/projects`页面被缓存：您是否将该页面绑定到此应用缓存（通过在页面元素中具有`manifest="..."`属性`<html>`）？如果将页面绑定到 appcache，则页面本身始终隐含地成为 appcache 的一部分（作为所谓的“主条目”）。

# jpeg - 如何处理奇怪的 jpgc 格式？

> ID：13209509
> 
> 赞同：-3
> 
> 时间：2012-11-03T13:11:33.440
> 
> 标签：jpeg

我一直在通过工作软件寻找一些文件来获取一些图像。我找到了它们，但它们是 .jpgc 格式的，声音也是 mp3c 格式的。

作为任何人，我都有删除“c”以获得正常 jpg 或 mp3 格式的想法，但是一旦我这样做，任何软件都无法读取或编辑文件。

有什么建议么？

谢谢 ：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T13:26:52.727

[您可以尝试使用诸如“文件” https://en.wikipedia.org/wiki/File_(command](https://en.wikipedia.org/wiki/File_(command) )之类的 unix 程序之类的东西来识别文件内容类型文件类型。该工具也可用于 Windows：[http://gnuwin32.sourceforge.net/packages/file.htm](http://gnuwin32.sourceforge.net/packages/file.htm) 如果文件只是“普通”的 .mp3 和 .jpg 文件，您可以将它们从 mp3c 重命名为 mp3 并将 jpgc 重命名为.jpg

# iphone - 在 iOS 6 中访问日历（隐私设置）时出现问题

> ID：13209510
> 
> 赞同：0
> 
> 时间：2012-11-03T13:11:35.120
> 
> 标签：iphone, ios, calendar, ios6, privacy

我刚刚发布了我的 iPhone 应用程序的更新，它将支持 iPhone 5 尺寸，并且也是第一个以 iOS 6 作为基础 SDK 的更新。更新后，有不少用户联系我，抱怨该应用程序无法使用设备的日历。他们还说，我的应用程序没有出现在 iOS6 的隐私设置下，因此无法启用日历访问。

提交更新时我不知道此隐私功能，因此我没有查看 SDK 以及是否需要针对 iOS 6 的这些隐私功能调整我的应用程序。所以问题是：

a) 我是否必须对我的应用程序进行任何修改才能使日历访问正常工作？b）对于当前（不工作）情况是否有任何解决方法，以便用户可以访问日历？

奇怪的是：我的 iPad 上有 iOS 6，并且我新安装了我的 (iPhone-) 应用程序。它不仅出现在隐私设置中（我可以在其中启用/禁用我的应用程序的日历访问），而且我还可以从应用程序内访问任何日历而不会出现任何问题。

由于我没有 iPhone 5，我不知道这个特定设备是否可能是问题（尽管不太可能）。

谁能帮帮我？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T19:27:27.980

我自己发现了：启动时调用`EKEventStore`'s`requestAccessToEntityType:completion:`方法将打开日历访问提示，并将我的应用程序添加到设备设置中。仍然很好奇为什么我没有在我的 iOS 6 iPad 3 上重现这个。

# categories - product.tpl 中的 prestashop 关联类别

> ID：13209513
> 
> 赞同：5
> 
> 时间：2012-11-03T13:12:03.173
> 
> 标签：categories, product, prestashop

我有一个产品属于两个类别“戒指”和“收藏->波浪”（类别->子类别）

我可以显示**默认类别**，它像这样链接

```
<a href="{$link->getCategoryLink($product->id_category_default,$product->category)}" title="{$product->category}">{$product->category}</a> 
```

但我无论如何都无法显示（非默认）**关联类别。**对象 $product 中是否有任何具有关联类别的数组？

因为我知道所有类别都在变量 $categories 中（不是子类别，这可能是个问题，因为 wave 是子类别）

感谢一切

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-03T20:44:31.490

看看 Product 类，它有很好的功能：

```
/**
 * getProductCategories return an array of categories which this product belongs to
 *
 * @return array of categories
 */
public static function getProductCategories($id_product = '')
{
    $ret = array();
    if ($row = Db::getInstance(_PS_USE_SQL_SLAVE_)->ExecuteS('
    SELECT `id_category` FROM `'._DB_PREFIX_.'category_product`
    WHERE `id_product` = '.(int)$id_product)
    )
        foreach ($row as $val)
            $ret[] = $val['id_category'];
    return $ret;
} 
```

问候

# android - 禁用某些活动的睡眠

> ID：13209518
> 
> 赞同：23
> 
> 时间：2012-11-03T13:12:30.643
> 
> 标签：android, sleep

当用户处于某些活动中时，有什么方法可以禁用 android 手机的睡眠。

我想在用户处于主要活动时禁用屏幕超时。

有什么办法吗？不知道有没有可能？

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2012-11-03T13:21:37.880

尝试这个。

```
 @Override
 protected void onCreate(Bundle icicle) 
 {
     super.onCreate(icicle);
     getWindow().addFlags(WindowManager.LayoutParams.FLAG_KEEP_SCREEN_ON);
 } 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2014-11-04T03:28:16.447

我正在使用这个：

```
@Override
protected void onCreate(Bundle icicle) 
{
      super.onCreate(icicle);
      getWindow().addFlags(WindowManager.LayoutParams.FLAG_KEEP_SCREEN_ON);
} 
```

不要忘记将权限放在清单中

```
<uses-permission android:name="android.permission.WAKE_LOCK" /> 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2018-07-19T05:12:50.760

最好的方法只是添加

```
android:keepScreenOn="true" 
```

到该活动的父布局。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2017-08-31T08:40:59.693

如果您只想阻止特定 View 的睡眠模式，只需在该 View 上调用[setKeepScreenOn(true)](https://developer.android.com/reference/android/view/View.html#setKeepScreenOn%28boolean%29)或将[keepScreenOn](https://developer.android.com/reference/android/view/View.html#setKeepScreenOn%28boolean%29)属性设置为 true。当视图在屏幕上时，这将防止屏幕关闭。**对此无需特别许可。**

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-09-22T10:29:06.493

You can use the following code to keep screen on in a certain function as :

```
PowerManager pm = (PowerManager) getSystemService(Context.POWER_SERVICE);
PowerManager.WakeLock wl = pm.newWakeLock(PowerManager.SCREEN_DIM_WAKE_LOCK, "My Tag");
wl.acquire();
   //..screen will stay on during this section..
wl.release(); 
```

This will get the power service and acquire its attention then release it after your code is done

# javascript - 如何从 youtube 上抓取单个剪辑的所有评论，超过 100 页

> ID：13209520
> 
> 赞同：5
> 
> 时间：2012-11-03T13:12:43.127
> 
> 标签：javascript, youtube, web-crawler

我需要从 YouTube 上抓取 PSY 的江南风格视频的所有评论（超过 2,600,000 条评论，超过 5000 页），请参阅： [http ://www.youtube.com/all_comments?v=9bZkp7q19f0](http://www.youtube.com/all_comments?v=9bZkp7q19f0)

**问题是：**

1) 如果我使用 gdata 服务，谷歌只提供不超过 1000 个评论提要

2）如果我直接从以下位置抓取html标签：

```
site(http://www.youtube.com/all_comments?v=9bZkp7q19f0&page=$(page)) 
```

通过增加 page 参数，它会在第 #101 页之后失败，该页面上没有显示评论。

所以请大家，我该如何解决这个问题？

PS：我的爬虫是使用javascript实现的chrome扩展，它检查加载页面的评论标签，然后加载下一页。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T13:22:25.117

您可以通过爬取页面并针对遇到的问题破解代码来提取数据，但这不是正确的方法。

您应该为此使用[youtube api](https://developers.google.com/youtube/2.0/developers_guide_protocol_comments#Retrieve_comments)并检查与此相关的其他[开发人员资源](https://developers.google.com/youtube/2.0/developers_guide_protocol_audience)。

# ios - TestFlight 说缺少 dSYM（以前：IPA 中缺少 CFBundleExecutable）。

> ID：13209524
> 
> 赞同：3
> 
> 时间：2012-11-03T13:13:33.943
> 
> 标签：ios, xcode, ipa, testflight

我有一个 iOS 应用程序（我的第一个）我正准备通过 TestFlight 进行 beta 测试。我按照 TestFlight 教程中的步骤创建 IPA，但随后 TestFlight 桌面上传器抱怨“找不到 dSYM”。在对此进行研究后，我在 SO 上看到了几个不同的问题，这些问题与仍然设置为在 Xcode 4.5 下构建 armv6 的目标有关。我检查了我的 Xcode 设置，对于产品和我的一个编译目标（我有 3 或 4 个脚本目标），“有效架构”设置为“armv7，armv7s”。我记得当我升级到 Xcode 4.5 时不得不搞砸这个，我想我当时改变了它。我正在将 Cocos2d 构建为子项目，并且我也对其进行了检查。我唯一拥有的其他存档是 libTestFlight.a，它当然是预先构建的。我解压了 IPA，查看了 Info.plist，并且 CFBundleExecutable 实际上丢失了，尽管 Bundle Name、Bundle Display Name 和 Executable File 都在那里并且正确。还有什么可能导致这种情况？协同设计或我的 Ad Hoc Provisioning Profile 是否存在问题？我进行了一些更改，以使我的包标识符与我在 iTunes Connect 上的 App ID 一致（区分大小写的问题）。

编辑：我确实有一个正确的 CFBundleExecutable。我正在使用 PListEdit Pro 查看 Info.plist，它报告为“可执行文件”的内容实际上是 CFBundleExecutable。我还拿了我的临时签名的 IPA 并使用 Xcode 管理器将它安装在我的设备上，它运行得很好，所以 IPA 没有问题，除了 TestFlight 桌面应用程序无法在其中找到 dSYM。我打开了 IPA 的包装，似乎 dSYM 不见了。我查看了构建 IPA 的 .xcarchive，dSYM 存在于其中，所以看起来它被代码设计步骤剥离了，也许？我从 xcarchive 中提取了 dSYM，并尝试将它与我的 IPA 一起上传到 TestFlight。IPA 已正确上传，但似乎未上传 dSYM。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-13T00:20:57.637

看来这是 TestFlight 桌面应用程序的 Beta 版本的问题。我可以使用 Web 界面上传相同的 IPA，但我必须单独上传 dSYM 文件。如果来自 TestFlight 的人能以一种或另一种方式对此发表评论，那就太好了。

# c# - 子窗口在第三个窗口上使用 ShowDialog 后，主窗口消失在其他应用程序的窗口后面

> ID：13209526
> 
> 赞同：16
> 
> 时间：2012-11-03T13:13:35.407
> 
> 标签：c#, wpf, dialog, window, modal-dialog

我在 WPF 应用程序中注意到了这种非常奇怪的行为。

我有一个`MainWindow`，使用`Show()`from显示`App.OnStartup`。说`MainWindow`可以打开一个（非模态）`SubWindow`，也可以使用`Show()`。`SubWindow`的`Owner`设置为`MainWindow`。

`SubWindow`关闭时，再次`MainWindow`可见（好）。

某些操作可能会导致`SubWindow`打开第三个窗口作为模式对话框，使用`ShowDialog()`(`Owner`设置为`SubWindow`)。当该模态对话框在 a 的生命周期中至少打开和关闭一次时`SubWindow`，就会发生奇怪的事情。

关闭后`SubWindow`，`MainWindow`不会出现。*相反，无论后面* 是什么随机窗口`MainWindow`都会进入视野。谁能向我解释为什么会发生这种情况，以及如何解决？

模态对话框是使用 显示的普通对话框`Window`，`ShowDialog()`还是使用 显示的消息框没有区别`MessageBox.Show()`。

* * *

这是一些重现此的*最小代码。*在 Visual Studio 中创建一个新的 WPF 应用程序，并将其粘贴到预先生成的 MainWindow.xaml.cs 中

然后，按键盘上的一个键只打开一个窗口，关闭它，行为如预期。按两个键，同时关闭，然后第一个窗口在 Visual Studio 后面（大概）。

```
public MainWindow()
{
    InitializeComponent();
    this.PreviewKeyDown += (sender, e) =>
    {
        if (this.Owner is MainWindow)
        {
            // we're the SubWindow

            MessageBox.Show("I am a modal dialog");

            // code below produces the exact same behavior as the message box

            //var dialog = new MainWindow();
            //dialog.Owner = this;
            //dialog.ShowDialog();
        }
        else
        {
            // we're the initial MainWindow created by App.
            var subWindow = new MainWindow();
            subWindow.Owner = this;
            subWindow.Show();
        }
    };
} 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-11-03T14:16:05.740

这是一个非常烦人的 WPF 错误，我从未在代码中找到导致它的缺陷，但在处理聚焦的源代码中存在大量“必须弄清楚”的注释。只是一种解决方法，一种不太理想的解决方法，您可以通过在窗口关闭时将焦点明确地赋予所有者来解决它。将此代码复制/粘贴到您的 SubWindow 类中；

```
 protected override void OnClosing(System.ComponentModel.CancelEventArgs e) {
        base.OnClosing(e);
        if (!e.Cancel && this.Owner != null) this.Owner.Focus();
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-26T15:43:24.653

仅在隐藏窗口时遇到相同的问题。在这种情况下，我看不到有与 Closing 等效的事件，但无论如何这有效：

```
 if (Owner != null) Owner.Focus();
        Hide(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-04-20T19:57:17.837

this.Owner.Focus(); 对我不起作用它仍然会转到后面的窗口我不得不玩一点并尝试使用 TopMost，TopMost 的问题是我需要在关闭后将其返回为 false。我同时使用了 OnClosing 和 OnClosed 事件。

```
protected override void OnClosing(System.ComponentModel.CancelEventArgs e)
{
    base.OnClosing(e);
    if (!e.Cancel && this.Owner != null) this.Owner.TopMost = true;
}

protected override void OnClosed(EventArgs e)
{
    base.OnClosed(e);
    if (this.Owner != null)
    {
        this.Owner.TopMost = false;
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-06-17T05:02:32.183

我在 WinFoms (.NET 4.7+) 中遇到了同样的问题。我的解决方法是先关闭第一个对话框（调用它的`Close`方法），然后再显示第二个对话框。

**例子**

1.  主窗体打开`FirstForm`
2.  `FirstForm`打开`SecondForm`并导致问题！

**解决方法**

里面的调用`Close`方法`FirstForm`将打开`SecondForm`：

```
// FirstForm.cs

using(var secondForm = new SecondForm())
{
    Close(); // <- this closes FirstForm instance
    secondForm.ShowDialog(owner: mainFormInstance);
} 
```

高温高压

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-07-10T21:26:06.230

老问题，但我想我会分享对我的 C# WinForms 应用程序有用的东西，因为 Owner.Focus() 对我不起作用。

这是 Daren 的 TopMost 修复的一个变体，但我发现我实际上不必将 TopMost 设置为 true 并返回。只需将其设置为自身就可以防止父窗口消失在其他应用程序后面。

```
protected override void OnClosing(CancelEventArgs e) {
    if (Owner != null)
        Owner.TopMost = Owner.TopMost;
    base.OnClosing(e);
} 
```

# css - HTML5 iframe 相对大小

> ID：13209531
> 
> 赞同：1
> 
> 时间：2012-11-03T13:14:45.080
> 
> 标签：css, html, iframe

似乎 HTML5 不支持 iframe 的相对高度。添加时

到我在 css 规则中的文档高度

```
#content{width:100%; height:100%;border:1px solid;} 
```

被火狐忽略。没有文档类型，它可以工作。

编辑：我发现我还需要添加 html 元素的大小。现在它起作用了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T13:21:54.340

尝试使 iframe 的位置绝对：

```
#content{
    position: absolute;
    width: 100%;
    height: 100%;
    border: 1px solid;
} 
```

# algorithm - 寻找均衡分布的好算法

> ID：13209538
> 
> 赞同：5
> 
> 时间：2012-11-03T13:15:44.473
> 
> 标签：algorithm

我正在开发一个应用程序，其中应将大量剪报随机“扔”在 y 桌子上。但是，如果使用真正的随机，则总是有可能所有剪辑都出现在一个地方。客户更喜欢更“平等”的随机分布。

我的解决方案之一是：如果我有 20 个剪辑，计算一个包含 20 个字段的网格，然后将每个剪辑放在一个字段中，该字段中具有随机 x/y 位置。

有人有更好/更聪明的解决方案吗？

多谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T14:16:23.773

您正在寻找的内容被称为准随机序列（或低差异序列）。有几个像这样的众所周知的序列，这里是[Wikipedia entry](http://en.wikipedia.org/wiki/Constructions_of_low-discrepancy_sequences)。根据您选择的语言，可能会提供现成的库（此问题中提到了几个示例：[Recommendations for Low Discrepancy (eg Sobol) quasi-random sequences in Python/SciPy?](https://stackoverflow.com/questions/9412339/recommendations-for-low-discrepancy-e-g-sobol-quasi-random-sequences-in-pytho)）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-03T13:25:47.440

在这里我会做什么......

因为它是关于剪报，我认为视觉部分也很重要......

我会将表格分为 4 个部分（表面相等）和一个代表表格中心的（重叠）部分。你总是可以玩 4 的数字，让它变成 6 或 8，但我不会高达 20。

现在，您将剪报在 5 个部分的随机 x/y 位置进行划分。

像这样，你的桌子总是有一个“坚固”的中心，但你保证不是所有的剪报都在一堆。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-17T21:04:23.810

也许解决这个问题的最简单方法是将其展平为线性对象。4 x 5 的网格可以变成 20 个列表。只需给每个“插槽”一个数字 (0 - 19) 并使用以下算法。希望你不介意Java。

```
private void randomSlotFiller(int numberOfSlots) {
    List<Integer> list = new ArrayList<Integer>();
    Random random = new Random();
    for (int i = 0; i < numberOfSlots; i++) {
        list.add(i);
    }
    while(!list.isEmpty()) {
        System.out.print(list.remove(random.nextInt(list.size())) + " ");
    }
} 
```

该算法以下列方式工作：

1.  创建一个空列表
2.  用我们的插槽号填写列表
3.  随机选择并删除一个插槽，直到没有剩余。

显然，仅仅打印出数字并没有多大用处，因此请根据需要修改代码。

一个示例输出可能是：

```
15 9 17 13 8 10 6 11 3 7 2 19 4 0 12 18 16 5 1 14 
```

注意：该算法在多次迭代中提供了跨所有“槽”的均匀分布。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-12-17T21:45:24.440

这是一个非常简单的蛮力方法：

*   保留您已经选择的点的列表。
*   选择 n 个随机点
*   在其中选择与列表中所有点的最小距离最大的点，丢弃其他点
*   将该点添加到您选择的点列表中
*   重复直到你有足够的分数

基本上，您总是尝试多个点，并且只选择与所有先前选择的点最远的一个。

运行时间为 O(n²)

# python - python中函数内的函数

> ID：13209539
> 
> 赞同：12
> 
> 时间：2012-11-03T13:16:03.047
> 
> 标签：python

我最近遇到了在 Python 中定义函数的想法。我有这段代码，它给出了这个错误：

* * *

```
def f1(a):
    def f2(x):
       return a+x
    return 2*a 
```

* * *

错误：在调用`f2(5)`

```
Traceback (most recent call last):
File "<pyshell#19>", line 1, in <module>
f2(5)
NameError: name 'f2' is not defined 
```

* * *

我很难理解全局变量在函数之间甚至在递归调用中的使用方式。如果有人能指出我的错误并在此过程中帮助我，我将不胜感激。谢谢！！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-03T13:19:19.097

您`f2`在本地命名空间中定义了`f1` *only* ; 它在全球范围内不可用。

如果您希望这样的嵌套函数在模块级别可用，则必须从函数中返回它，或者定义一个`global`变量来存储它：

```
def f1(a):
    def f2(x):
       return a+x
    return 2*a, f2 
```

然后将其称为`result, f2 = f1(somevariable_or_literal)`.

该`global`方法不推荐（使用`global`很少是），但看起来像：

```
f2 = None

def f1(a):
    global f2
    def f2_local(x):
         return a+x
    f2 = f2_local
    return 2*a 
```

当`f2`您调用`f1`.

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-11-03T13:18:28.510

`f2`在里面定义`f1`。因此，它的作用域只在函数内部扩展`f1`。在该空间之外，该功能`f2`甚至不存在，这就是您收到错误的原因。

如果你在定义之后`f2`从内部的某个地方调用，它会起作用。`f1``f2`

[Python 作用域规则的简短描述](https://stackoverflow.com/questions/291978/short-description-of-python-scoping-rules)很好地解释了作用域在 Python 中的工作原理。

# ruby-on-rails - Rails - 仅允许对服务器端的控制器操作进行访问

> ID：13209540
> 
> 赞同：1
> 
> 时间：2012-11-03T13:16:14.750
> 
> 标签：ruby-on-rails, controller

`users`我的 Rails 项目中有`projects`脚手架。我还有一个`admin`控制器和视图，只有管理员用户才能访问。我希望and模型的`index`and`create`控制器操作只能由视图访问（使用），但我不想让网站的访问者能够输入并获得部分渲染。我如何实现这一目标？`users``projects``admin``render :partial > 'index'``http://railsapp.host/users`

澄清一下，我的问题与用户角色无关。我有所有 require_admin 助手的 authlogic，但我什至不希望管理员用户能够直接从浏览器访问`index`路由。`users`实际上，我只想将`index`控制器操作限制为`admin#index`这样的视图代码：

```
<%= render '/users/index' %> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T13:28:46.287

最好的 rails 方法是在应用程序控制器中定义一个过滤器

```
 class UsersController < ApplicationController
   before_filter :check_isadmin?, :only => [:create, :index]
 end
 class ProjectsController < ApplicationController
   before_filter :check_isadmin?, :only => [:create, :index]
 end
 class ApplicationControlloller < ApplicationController
   def check_isadmin?
      current_user.admin?
    end
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T13:23:37.150

如果您为不同的用户使用角色，您可以检查管理员用户的角色，然后渲染部分，例如：

```
<% if user.isAdmin? %>
  <%= render 'index' %>
<% end %> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-03T13:56:15.637

好吧，我应该说我是一个相对的菜鸟。不过我想通了。我以为

```
<%= render '/users/index' %> 
```

实际上是通过`users#index`代码。我只是发现它只是在视图下调用部分而不通过控制器操作。所以我只是将它添加到`users`控制器中

```
def index
  redirect_to :controller=>'admin', :action=>'index'
end 
```

这似乎实现了我所寻求的目标。

感谢你的帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-06-13T06:02:39.760

补充对我有帮助的 Aayush Khandelwal 答案**before_filter 在 Rails 5 上已贬值**。请改用 before_action。

```
class UsersController < ApplicationController
   before_action :check_isadmin?, :only => [:create, :index]
end 
```

在 :check_isadmin? 如果为 false，则重定向到其他页面。

```
def check_isadmin?
  if current_user == nil || !current_user.admin?
    redirect_to root_path
  end
end 
```

# c#-4.0 - 如何以红色显示关闭按钮

> ID：13209542
> 
> 赞同：0
> 
> 时间：2012-11-03T13:16:45.913
> 
> 标签：c#-4.0, razor, telerik, telerik-grid, telerik-mvc

```
Html.Telerik().Window() 
```

默认情况下，窗口以浅蓝色显示**关闭 - 十字符号按钮。**我希望**关闭 - 十字符号**按钮以红色显示。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T19:32:43.260

您可以定义样式规则：

```
.t-window-actions .t-close { background-position:0px -288px; } 
```

# c++ - Objective-C 是否具有 C++11 右值引用和移动语义等价物或如何实现？

> ID：13209545
> 
> 赞同：5
> 
> 时间：2012-11-03T13:17:04.660
> 
> 标签：c++, objective-c, c++11, copy-constructor, move-semantics

我正在学习Objective-C。我有这样一个“学术”问题，是针对对现代 C++（C++11）有深入了解的 Objective-C 专家提出的。

在 C++11 中，我经常使用移动语义（使用对临时对象的引用，我们可以避免不必要的复制）：
[什么是移动语义？](https://stackoverflow.com/questions/3106110/can-someone-please-explain-move-semantics-to-me)
[http://www.cprogramming.com/c++11/rvalue-references-and-move-semantics-in-c++11.html](http://www.cprogramming.com/c++11/rvalue-references-and-move-semantics-in-c++11.html)

这些链接适用于不熟悉移动语义概念的 Objective-C 编码人员，我很感兴趣 Objective-C 是否有类似的东西，或者可能有一些方法可以实现/模拟这个？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-06T23:03:44.460

Objective-C 不像 C 那样具有这些特性，因为 Objective-C 是纯 C 之上的一组特定特性。Objective-C++ 确实具有这些特性，因为它与 C++ 之上的特性相同。

使移动语义在 C++ 中如此重要的原因之一是 C++ 对值语义的高度重视。通常，您不持有指向 C++ 对象的指针，而是按值持有 C++ 对象。如果没有移动语义，这会导致大量不必要的副本。

Objective-C 不仅没有同样强调值语义，而且完全禁止 Objective-C 对象的值语义；您只能动态创建 Objective-C 对象，不能像复制 C 结构那样复制对象，等等。

```
@interface Foo
@end
@implementation Foo
@end

int main() {
    Foo f;
    Foo *a, *b;
    *a = *b;
}

error: interface type cannot be statically allocated
Foo f;
    ^
    *
error: cannot assign to class object ('Foo' invalid)
*a = *b;
   ^ 
```

所以 C++ 的引用和移动的概念都是用 Objective-C 中的 C 方式完成的，带有指针。当然，这意味着 C++ 与 Objective-C 相比与 C 相比具有许多相同的性能优势，因为它具有相同的避免指针的能力。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-06T22:53:35.467

> Objective-C 是否有类似的东西，或者可能有一些方法可以实现/模拟这个？

没有。这不是一个大问题，一旦你消化了你正在使用 Objective-C 的抽象层。了解对象是引用计数的并且是堆分配。

现在有两种方法可以做到这一点：

a) 使用 Objective-C++——只需将语言特性与您的内容混合并匹配即可。

b) 使用惯用的 Objective-C。这要追溯到很久以前。一旦你接受对象是引用计数的堆分配并且没有办法解决这个问题（使用 clang），那么你就会学会以不同的方式处理程序。当然，对所有内容进行引用计数并将其放入堆中是有成本的，但在某些情况下您可以利用这些特征。最显着的用途是使用不可变对象和浅拷贝。复制`std::string`as 对象将导致 SSO 复制或堆分配。复制一个`NSString`可以简单地返回自身（在增加或不增加引用计数之后，取决于它是字符串的类型，它可能还需要在该点创建一个具体的副本）。同样，这些对象都只是指针，因此您无需积极关心如何传递对象（值/引用/常量引用/移动）。ObjC 中存在一个更简单的模型，可以利用它。所以这里的设计发生了转变：ObjC 中的“价值优势”减少了，而“支持不变性和共享”更多。

在某些情况下，您可以编写一个 move 方法。由于通用框架类不支持这一点，因此使用对象组合通常更有意义。

由于对象是在堆上分配的，因此移动并不那么重要。精心设计的类考虑了成本以最小化巨大/昂贵的副本，并在内部使用了一些有趣的优化。该成语只是建议您应该采用不同的方法来创建您的类——它们如何共享数据？什么是可变的？什么必须复制？有时，您可能正在处理大的、可变/昂贵的数据并且移动会很方便，但您通常可以将其放在共享容器对象中或重新考虑对象初始化的语义，以最大限度地减少物理复制（并避免奇怪的对象接口中的语义）。除此之外，我不认为移动在纯 Objective-C 中非常有用。当然，它们对于被设计为利用移动语义并能够在多个内存位置创建对象的 C++ 库变得很重要。如果您确实移动了，您通常希望保持该细节的私密性或使其非常明显（例如，我在渲染管道中完成了该操作，以最大程度地减少每个过滤器的大分配）。

您认为有益的示例也将有助于理解您的问题/理由。

# php - 当referer不为空时需要重定向到图片

> ID：13209547
> 
> 赞同：1
> 
> 时间：2012-11-03T13:17:48.980
> 
> 标签：php, referer

问题是当引用者不为空时，我仍然得到链接而不是图像。

```
<?php

if($_SERVER['HTTP_REFERER'] != " "){
  $goodreferer = 0;
}   
else {
  $goodreferer = 1;
}

$image = 'http://www.example.com/imglink.gif';
$url = 'http://example.net/';

if ($show = 1 && $goodreferer = 1) {
  header("Location: ".$url);
} 
else {
  header("Location: ".$image);
  exit;
}

?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-03T13:21:34.713

您正在为变量分配一个值，而不是进行比较。

*   `=`表示赋值，`$variable = 5`表示变量现在等于 5。
*   `==`表示比较，`$variable == 5`将返回变量是否等于5。

此外，PHP 有一个内置函数来检查字符串是否为空。`empty()`.

所以更正的版本：

```
<?php
if (!empty($_SERVER['HTTP_REFERER'])) {
    $goodreferer = 0;
}
else {
    $goodreferer = 1;
}

$image = 'http://www.imglink.gif';
$url   = 'http://link.com';

if ($show == 1 && $goodreferer == 1) {

    header("Location: " . $url);
}
else {
    header("Location: " . $image);
    exit;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T13:20:30.560

替换`$_SERVER['HTTP_REFERER'] != " "`为`!isset($_SERVER['HTTP_REFERER'])` 也使用`$show == 1 && $goodreferer == 1`马达拉指出。

# javascript - 对 Sinatra 应用程序的 Jquery Ajax 请求

> ID：13209548
> 
> 赞同：1
> 
> 时间：2012-11-03T13:18:01.423
> 
> 标签：javascript, jquery, ruby, ajax, sinatra

我已经有一段时间了，但我错过了一些东西。我刚刚设置了一个返回 JSON 的简单 Sinatra 应用程序：

```
get '/json' do
  content_type :json
  $data.to_json
end 
```

这工作正常，然后我用来执行跨域请求的 javascript 是

```
$.getJSON("http://domain.com/json?callback=?", function(data) {
   console.log(data);
}); 
```

不幸的是，我只是在控制台中不断收到错误，`Uncaught SyntaxError: Unexpected token :`尽管我已经尝试使用该`$.ajax`方法，但我仍然得到相同的结果。

这是我的服务器或客户端代码上的错误吗？任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T19:39:37.590

您提到您正在发出跨域请求。对于 JSONP，您需要包装 json 响应以模拟函数调用。有一个[Sinatra 助手](http://podtynnyi.com/2010/05/28/sinatra-jsonp-output-helper/)可以轻松完成。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-09-28T03:03:53.920

**这里有不同端口的工作示例**

Ruby 与 Sinatra

```
require 'rubygems'
require 'sinatra'
require "sinatra/jsonp"

get '/note/all/' do
  data = ["hello","hi","hallo"]
  JSONP data      # JSONP is an alias for jsonp method
End 
```

托管在 apache 上的 HTML

```
<head id="Head1" runat="server">
    <title> English </title>
    <link href="Styles/Site.css" rel="stylesheet" type="text/css" />
    <link rel="stylesheet" href="http://code.jquery.com/ui/1.10.3/themes/smoothness/jquery-ui.css" />
    <script src="http://code.jquery.com/jquery-1.10.2.js" type="text/javascript"></script>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js" type="text/javascript"></script>
<script type="text/javascript">
    $(function () {
        // to update alternative address
        $('#Updateprofile').click(function () {
        var key = "nickname"
            var details = $('#nickname').val();
        $.ajax({
            type: 'GET',
            url: 'http://localhost:4567/note/all/',
            crossDomain: true,
            data: '',
            dataType: 'jsonp',
            success: function(responseData, textStatus, jqXHR) {
            $('#controlstatus').html(+responseData);
            },
            error: function (responseData, textStatus, errorThrown) {
            alert('POST failed.'+textStatus);
            }
        });
        });
    });
</script>
</head>
<body>
    <form id="mstform" method="post" runat="server">
<input id="nickname" type="text" style="border: thin solid #C0C0C0; background-color: #EFEFEF;
        width: 300px;" />
   <br />
    <br />
    <img alt="update" id="Updateprofile" src="images/save.png" title="Clicking this button will update your profile" />
   <br />
    <br />
<div id="controlstatus"> details should be here
</div>
    </form>
</body> 
```

# c# - 在 xaml 中绑定 Click 方法

> ID：13209550
> 
> 赞同：0
> 
> 时间：2012-11-03T13:18:21.300
> 
> 标签：c#, xaml, binding, windows-8

在 Windows 8 中，C# + xaml 我有一些课程

```
Class ABC
{
 public string a {get; set;}
 public void someMethod()
 {
  **some code, changing a**
 }
} 
```

并在 xaml 中绑定

```
<ListBox x:Name="playlistBox">
     <ListBox.ItemTemplate>
          <DataTemplate>
               <StackPanel Orientation="Horizontal">
                     <TextBlock Text="{Binding a}"/>
                     <Button Name="removeAlbumBtn" Content="method" Click="**NEED BINDING TO SOMEMETHOD HERE**"/>
                </StackPanel>
           </DataTemplate>
      </ListBox.ItemTemplate>
  </ListBox> 
```

那么我必须输入什么才能调用 someMethod ？？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T13:39:03.003

您需要通过该 xaml 文件*后面*`Click`的代码中的处理程序方法来处理事件。例如，如果您显示的 xaml 位于. 您将有一个类似以下的方法：*`MyControl.xaml``MyControl.xaml.cs`*

 *```
private void removeAlbumBtn_Click(object sender, RoutedEventArgs e)
{
    var a = ((Button)sender).DataContext as ABC;

    if(a != null)
        a.someMethod();
} 
```

并将 xaml 更改为：

```
<Button Name="removeAlbumBtn" Content="method" Click="removeAlbumBtn_Click"/> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T14:19:49.457

您可以使用命令来完成。但是您要做的工作量不仅仅是编写一个绑定它的方法。这篇关于 WPF 和 Silverlight 中命令的帖子可能会帮助您理解和实施命令：[http ://tsells.wordpress.com/2010/06/23/command-binding-with-wpf-and-silverlight-net-4-0 -with-mv-vm/](http://tsells.wordpress.com/2010/06/23/command-binding-with-wpf-and-silverlight-net-4-0-with-m-v-vm/)

它也适用于 Windows 8，因为它是 XAML 的一项功能。*

# terminal - 为什么 pip 总是输出警告？

> ID：13209558
> 
> 赞同：4
> 
> 时间：2012-11-03T13:19:04.220
> 
> 标签：terminal, pip

为什么 pip 在安装软件包时总是输出警告？例如，我刚刚安装了 nodeenv 并得到了一堆：

```
warning: no previously-included files found matching '*.pyc'
warning: no previously-included files found matching '*.swp' 
```

这不是问题，我安装的软件包工作正常。我只是好奇为什么会出现这些警告，它们的含义以及它们是否可以以某种方式隐藏而不会导致重要错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-03-19T00:07:17.573

它对我没有这样做......并且看着源头，我认为它不会对未来的任何人有用。

正如您[在此处](https://github.com/pypa/pip/commit/320a07fce558f2ba126a34279c5ea11e80b08594)看到的，这些警告已于 2014 年 12 月被删除。似乎它们会在清单指令过于谨慎和排除实际上并未包含的文件的情况下被触发。

# java - Java：检查是否使用 int 和 Integer 设置了属性

> ID：13209559
> 
> 赞同：3
> 
> 时间：2012-11-03T13:19:11.703
> 
> 标签：java, types

假设我有一个像这样的对象：

```
Public Class Test{
    int a;
} 
```

在我的程序中的某个时刻，我想检查是否设置了属性 a。我知道如果我使用 Integer 而不是 int 作为属性的类型，我可以执行以下操作：

```
if(test.a!=null)
    ...; 
```

但是，如果我将 int 保留在那里并使用它来检查：

```
if(test.a!=0)
    ...; 
```

一个问题是我无法区分零值和未设置值，但在我的程序中它们是相同的，因为有效值都不同于 0。此外，使用 int 简化了我以后需要做的事情开启，例如使用 == 进行比较。

那么在这里使用 int 会很好，还是总是首选 Integer ？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-03T13:20:22.137

这完全取决于您，或者都可以（前提是“未设置”并且在您的程序中`0` **确实**意味着同样的事情）。我意识到这不是一个答案，但这是事实。:-) 如果“未设置”并且`0`不是同一件事，那会更强烈地争论，`Integer`以便您可以正确区分它们。

在下面回复您的评论：

> 我只是想确认未设置的 int 将始终等于`0`

是的，根据 JLS 的第 4.12.5 节，始终[初始化](http://docs.oracle.com/javase/specs/jls/se7/html/jls-4.html#jls-4.12.5)`int`为。`0`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-03T13:36:21.650

`0`当声明未指定值时（如上面的代码片段） ， int 原始类型将被初始化。

如果状态“设置/取消设置”（而不是值）对您的程序很重要，您可以使用整数（正如您提到的）、布尔脏标志或“幻数”。

如果您想与一个幻数进行比较，我建议不要使用与 default value 一样常见的东西`0`。使用你在程序中几乎找不到的东西，比如 Integer.MIN_VALUE 并在你的 setter 中提防它。

在这种情况下，您可以执行以下操作：

```
public class Test {
   private static final int MAGIC_NR = Integer.MIN_VALUE;
   private int var = MAGIC_NR; //set it to the magic nr at declaration time  

   public boolean isVarSet() {
      return var == MAGIC_NR;
   }

   public void setVar(int value) {
       if (value == MAGIC_NR) throw new IllegalArgumentException("Invalid value for VarX"); // guard against setting this value - otherwise you're in trouble
       var = value;
   }

   public int getVar() {
       return var;
   }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-03T13:23:47.790

从约定的角度来看这很好，尽管您可能希望使用一个常量来表示未设置的值：

```
public static final int UNSET = 0;
...
if(test.a == UNSET) {
....
} 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-11-03T13:33:14.647

这取决于你想如何访问它，我并不完全清楚它是如何工作的，但我的理解是一个静态变量不需要被实例化，它已经是一个对象，所以你可以尝试这样的事情。

```
 public class Test {
        public static int a;
    } 
```

然后通过引用Test类来引用它，

```
 if (Test.a != null) {} 
```

或者，当然您可以简单地在您想要引用变量的地方创建 Test 类的对象。

```
 Test test = new Test();
    if (test.a != null) {} 
```

最后我的第三个解决方案是将它传递给新类的构造函数。

```
 public class NewCLass {
         int newInt;  
         public NewClass(int num1) {
            this.newInt = num1;
         }
    } 
```

那么当您创建该类的对象时，您必须将一个 int 传递给构造函数，或者使用多个构造函数。至于你的最后一个问题，使用你想要的任何东西，我很少使用 Integer 类，除非我需要使用它的静态方法或类似的东西。我更喜欢使用int。希望有帮助。

# iphone - 如何最好地存储 SNMP 消息并将其发送到 ios？

> ID：13209568
> 
> 赞同：0
> 
> 时间：2012-11-03T13:20:29.850
> 
> 标签：iphone, linux, architecture, activemq, snmp

我的目标是从客户端（可能有防火墙）的后端服务器传输 SNMP 消息，将它们存储在一些快速的数据库服务器中，然后将它们推送到 iOS 设备 (http://bit.ly/vwBf5)。

我的选择是什么？

1.  封装一个 snmp 消息并通过 http 将其传输到数据库服务器，然后推送到 iOS 并存储在某个数据库中。SNMP 代理 -> 处理服务器（一些处理传入消息的引擎） -> 推送到 iOS

2.  然后使用一些 snmp 代理来捕获。使用自己的 ActiveMQ 服务器推送到 IOS 并使用一些快速的持久性数据库。代理 -> ActiveMQ 服务器（用于持久性的 Hadoop） -> iOS

在数据库中，我将存储登录名、时间、消息、来源、发送到苹果、服务器 ID 和用户名。大多数情况下，数据库只会写入，但有时它会读取（来自 Web 请求）。

我有哪些选择：Hadoop、Cassandra、Mongo？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T20:55:11.263

好吧，有点模糊的场景。但是，既然您已经考虑过 ActiveMQ，请也看看 Apache Camel，它可以满足您的需求（可能是因为它有点难以理解）：

[Camel 支持](http://camel.apache.org/components.html)读取 SNMP 陷阱（或轮询 SNMP 消息），并支持将消息发送到 APNS 以及多个数据库（包括 MongoDB、Hadoop 以及 JDBC 兼容的 SQL 服务器）。

只是它在 Camel 代码中的外观示例（请注意，您需要对消息进行一些自定义格式以及配置才能使其正常工作，因此请不要尝试按原样运行此代码）：

```
from("snmp:127.0.0.1:162?protocol=udp&type=TRAP")  // from SNMP trap
   .convertBodyTo(String.class)
   .setHeader(ApnsConstants.HEADER_TOKENS, constant(IOS_DEVICE_TOKEN))
   .to("apns:notify") // TO iOS
   .to("mongodb:myDb?database=mySnmp&collection=traps&operation=insert"); // To DB 
```

或者，如果您因为陷阱的峰值负载而觉得必须进行一些分段，您也可以这样做：

```
from("snmp:127.0.0.1:162?protocol=udp&type=TRAP")  // from SNMP trap
   .convertBodyTo(String.class)
   .to("seda:stagedProcess");  // 

from("sead:stagedProcess")
   .setHeader(ApnsConstants.HEADER_TOKENS, constant(IOS_DEVICE_TOKEN))
   .to("apns:notify") // TO iOS
   .to("mongodb:myDb?database=mySnmp&collection=traps&operation=insert"); // To DB 
```

# php - 为什么查询数据库时这条语句返回true

> ID：13209578
> 
> 赞同：-3
> 
> 时间：2012-11-03T13:21:34.580
> 
> 标签：php, mysql, pdo

### 我知道我应该使用准备语句并清理数据我只是检查 PDO 驱动程序

我只想知道为什么如果我只传递随机数据查询返回true？

## 请注意这个 PDO::query — 执行一条 SQL 语句，将结果集作为 PDOStatement 对象返回

```
 $dbuser = 'root';
$dbpass = 'root';
$formpost = false;
try
{
    $dbh = new PDO('mysql:host=127.0.0.1;dbname=loginexample', $dbuser, $dbpass);
} catch (PDOException $e) {
    print "Error!: " . $e->getMessage() . "<br/>";
    die();
}
if(!empty($_POST['username']) && !empty($_POST['password']))
{
    $formpost = true;
    $username = $_POST['username'];
    $password = $_POST['password'];
}

if($dbh && $formpost)
{
    $sql= "SELECT username, password FROM user WHERE username='$username' AND password='$password'";
    if($dbh->query($sql))
    {
        echo 'true';
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-03T13:25:51.440

`PDO::query`将*始终*返回一个`PDOStatement`对象，除非查询导致错误。（不返回任何行不是错误。）在 PHP 中，任何对象的计算结果都会为 boolean `true`，因此`if`条件会通过。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-03T13:26:09.593

因为`PDO::query()`返回一个**PDOStatement**对象来表示结果集。即使没有返回结果，查询仍然成功（即它不包含语法错误、表存在等）。

要检查是否为空，您可以使用`fetchAll()`并在其上运行一个`count()`函数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-03T13:26:17.867

这行：`if($dbh->query($sql))`可能不会返回包含任何找到的记录的对象，但它仍然返回一个对象。例如，可能会告诉您找到的行数为零的对象。

尝试根据找到的记录数返回真或假......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-03T13:25:32.090

> PDO::query() 返回一个 PDOStatement 对象，如果失败则返回 FALSE。

我的猜测是查询成功获取所有匹配的零行

# python - 按键上的精灵动画

> ID：13209581
> 
> 赞同：1
> 
> 时间：2012-11-03T13:21:42.363
> 
> 标签：python, animation, sprite, pygame

当您按下键盘上的按钮时，我正在尝试为 spritesheet 设置动画。我最初的想法是在按键上对图像进行 blit。我将动画代码从主循环移动到用户输入循环。这不起作用，因为游戏循环处理整个游戏的单个状态。使用什么技术从用户输入触发动画？我想要一个动画系统，既可以通过用户输入处理动画，也可以在后台自行处理动画。

```
 if __name__ == "__main__":
    print "the game"
    pygame.init()
    screen = pygame.display.set_mode((800,600))

    images = load_sliced_sprites(100, 71, "spinning_roundhouse_kick.png")
    spritesheet = AnimatedSprite(images, 20)
    #while pygame.event.poll().type != KEYDOWN:
    while True:
        screen.fill((255,255,255))
        event = pygame.event.poll()

        if event.type == KEYDOWN:
            #print "keydown"
            for image in images:
                screen.blit(image, (0,0))

        #time = pygame.time.get_ticks()
        #spritesheet.update(time)
        #screen.blit(spritesheet.image, (0,0))

        pygame.display.update() 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T13:37:24.923

看起来你应该做这样的事情..

```
sprite = AnimatedSprite(images, 20)
if event.type == KEYDOWN:
        sprite.update(pygame.time.get_ticks())
        screen.blit(sprite.getimage()) 
```

应该发生的是，您的精灵类应该使用时间增量进行更新，并在更改为新帧之前计算时间。每当按下键时绘制动画。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-03T22:00:21.673

我通过跟踪动画帧并使用另一个 while true 循环解决了这个问题。

```
import os
import pygame
from pygame.locals import *

def load_sliced_sprites(w, h, filename):
    '''
    Specs :
        Master can be any height.
        Sprites frames width must be the same width
        Master width must be len(frames)*frame.width
    Assuming you ressources directory is named "resources"
    '''
    images = []
    master_image = pygame.image.load(os.path.join('resources', filename)).convert_alpha()

    master_width, master_height = master_image.get_size()
    for i in xrange(int(master_width/w)):
        images.append(master_image.subsurface((i*w,0,w,h)))
    return images

class AnimatedSprite(pygame.sprite.Sprite):
    def __init__(self, images, fps = 10):
        pygame.sprite.Sprite.__init__(self)
        self._images = images

        # Track the time we started, and the time between updates.
        # Then we can figure out when we have to switch the image.
        self._start = pygame.time.get_ticks()
        self._delay = 1000 / fps
        self._last_update = 0
        self._frame = 0

        # Call update to set our first image.
        self.update(pygame.time.get_ticks())

    def update(self, t):
        # Note that this doesn't work if it's been more that self._delay
        # time between calls to update(); we only update the image once
        # then, but it really should be updated twice.

        if t - self._last_update > self._delay:
            self._frame += 1
            #if self._frame >= len(self._images): self._frame = 0
            if self._frame < len(self._images):
                self.image = self._images[self._frame]
                self._last_update = t

    def getimage(self):
        return self.image

    def isfinished(self):
        if self._frame == len(self._images):
            return True
        else:
            return False

    def reset(self):
        if self._frame >= len(self._images): self._frame = 0

if __name__ == "__main__":
    print "the game"
    pygame.init()
    screen = pygame.display.set_mode((800,600))

    images = load_sliced_sprites(100, 71, "spinning_roundhouse_kick.png")
    sprite = AnimatedSprite(images, 20)
    #while pygame.event.poll().type != KEYDOWN:
    while True:
        screen.fill((255,255,255))
        event = pygame.event.poll()
        if event.type == KEYDOWN and event.key == K_a:
            #print "keydown"
            #for image in images:
            while True:
                #print "frame"
                #print sprite._frame
                #print sprite.isfinished()
                time = pygame.time.get_ticks()
                sprite.update(time)
                screen.blit(sprite.getimage(), (0,0))
                pygame.display.update()
                #sprite.reset()
                if sprite.isfinished() == True:
                    sprite.reset()
                    break

        #time = pygame.time.get_ticks()
        #sprite.update(time)
        #screen.blit(sprite.image, (0,0))

        pygame.display.update() 
```

# python-sphinx - 覆盖特定 sphinx 文档的 html 页面模板

> ID：13209597
> 
> 赞同：15
> 
> 时间：2012-11-03T13:23:42.203
> 
> 标签：python-sphinx

我正在使用 Sphinx ( [https://github.com/fridge-project/dbal-docs](https://github.com/fridge-project/dbal-docs) ) 实现文档，并希望覆盖特定文档的 html 页面。我的兴趣是覆盖所有目录索引，不仅显示一个简单的 ul。

我已阅读 Sphinx 文档，但没有发现关于我的问题的有趣内容...有人知道解决方法吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-05-03T23:02:56.763

为了记录，这个解决方案更像是一个黑客而不是一个解决方案，但现在，我没有找到更好的东西......

首先，您需要了解我的解决方法是基于主题。在您的文档中，您使用主题（默认主题或自定义主题），但无论如何，您都使用主题。该主题分为不同的部分（页面，目录，...），可以单独覆盖。这种覆盖可以在不同的层次上完成：主题本身或项目的自定义模板目录（默认情况下`_templates`）（可在 中配置`conf.py`）。

我的解决方法是覆盖代表文档中所有页面`page.html`的目录中的模板。`_templates`在此模板中，您可以访问`pagename`（每个文件的相对文档路径）。知道了这一点，您可以在此模板中进行一些条件检查，以检测这是否是您要覆盖的文件，然后覆盖它。如果它不是需要被覆盖的文件，只需回退到默认行为：

```
{% extends "layout.html" %}
{% block body %}
    {% if pagename == 'index' %}
        {% include 'custom/index.html' %}
    {% else %}
        {{ body }}
    {% endif %}
{% endblock %} 
```

正如解释的那样，这听起来真的像一个黑客......

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2018-01-15T08:36:20.213

应该能够使用一个变量来定义[要扩展的模板](http://jinja.pocoo.org/docs/2.10/templates/#template-objects)。

这样一来，它可能就不那么“黑客”了。您可以完全控制生成的输出（不仅是`body`块）。

布局.html：

```
{% extends meta.page_template|default('basic/page.html') %} 
```

然后在您的 index.rst 中使用[页面级元数据](http://www.sphinx-doc.org/en/stable/markup/misc.html#file-wide-metadata)：

索引.rst：

```
:page_template: custom/index.html
<your normal index.rst content> 
```

# c# - 如何在 C# 表单中运行没有 FormBorderStyle 的程序？

> ID：13209599
> 
> 赞同：1
> 
> 时间：2012-11-03T13:24:13.793
> 
> 标签：c#

我想了解如何在我的 c# 表单中运行外部程序。具有这些规格：

```
FormBorderStyle = none 
```

大小和位置固定。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T13:28:07.863

您不能在自己的内部运行外部进程。您可以启动一个，但它会自行运行，您无法访问其内部行为。但是，如果您的目标是使用来自另一个 .exe 或 .dll 的类（如表单），则可以通过在解决方案中引用它并像其他任何实例一样创建该实例来实现。但是如果那个表单已经在控制它自己的位置、大小等等并且不允许被修改，那么你就有点卡住了。您可以通过一些反思来强制它，但行为可能是高度不可预测的。

# shell - 使用逻辑和 unix shell 脚本进行 switch case

> ID：13209600
> 
> 赞同：0
> 
> 时间：2012-11-03T13:24:19.700
> 
> 标签：shell, unix, switch-statement, logical-operators

是否可以在 unix shell 脚本切换案例中使用逻辑 AND。如果是这样，怎么做？

```
switch $var in
    1 AND $var2 EQUALS 2)
        some code 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T18:12:57.640

您可以使用：

```
case "$var1:$var2" in
(1:2) # $var1 = 1 && $var2 == 2
      ;;
...
esac 
```

在这种情况下，我添加了冒号（一个任意的非数字），因此您可以合理地确定这些值与所述值一致。但是，如果有人达到`var1="1:2"`and `var2=""`，那么测试将通过，但值不会达到要求。但是，如果您负责变量，这将是非常明智的。用于简单的值测试可能更干净`if`，但如果您需要范围测试，这可能比等效的更简洁，`if`但不太清楚：

```
case "$var1:$var2" in
([1-3]:[4-9]) # $var1 in {1,2,3} && $var2 in {4,5,6,7,8,9}
      ;;
...
esac

case "$var1:$var2" in
(*amber*:*gold*) # $var1 contains 'amber' && $var2 contains 'gold'
      ;;
...
esac 
```

它可能`bash`具有处理后者的内置功能；较旧的贝壳没有。`bash`如果您需要移植到默认安装的机器（可能是 AIX、HP-UX、Solaris），此技术可能很有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T13:26:41.620

您需要为此使用`if`语句。

看到[这个](http://tldp.org/LDP/Bash-Beginners-Guide/html/sect_07_03.html)。

> “每个案例都是一个匹配模式的表达式。执行第一个匹配的命令列表中的命令。“|”符号用于分隔多个模式，“）”运算符终止一个模式列表。“

因此，对于每种情况，您都需要有模式，而不是要评估的表达式。

# javascript - 当用户输入新数字或字符并开始输入 javascript 或 jquery 时如何删除以前的文本

> ID：13209605
> 
> 赞同：0
> 
> 时间：2012-11-03T13:25:06.477
> 
> 标签：javascript, asp.net

我有一个文本框，我希望每当用户开始在该文本框中输入一个数字时，应该删除以前的值。

假设有一个包含数字 23 的文本框，我希望每当用户开始在同一个文本框中输入时，都应该删除 23 并显示新的输入数字。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T13:27:07.733

您可以使用[text](http://www.w3.org/TR/html5/textFieldSelection.html#dom-textarea/input-select) [s](http://www.w3.org/TR/html5/textFieldSelection.html#dom-textarea/input-select)和[s](http://www.w3.org/TR/html5/textFieldSelection.html#dom-textarea/input-select)`select`上的功能来选择所有文本。然后当用户键入时，文本被替换。[`input`](http://www.w3.org/TR/html5/textFieldSelection.html#dom-textarea/input-select)[`textarea`](http://www.w3.org/TR/html5/textFieldSelection.html#dom-textarea/input-select)

例如，如果`input`or`textarea`有`id` `"target"`：

```
document.getElementById("target").select(); 
```

[实例](http://jsbin.com/umageq/1/)| [来源](http://jsbin.com/umageq/1/edit)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T13:41:34.097

也许你可以做这样的事情

```
<input type="text" onclick="clear(this);"> 
```

然后使名为 clear 的 javascript 函数（或您想要的任何名称）

```
<javascript type="text/javascript">

function clear(element)
{
    element.value = "";
}

</script> 
```

# javascript - 如何开发 Chrome 扩展程序来定期检查网站？

> ID：13209607
> 
> 赞同：1
> 
> 时间：2012-11-03T13:25:16.160
> 
> 标签：javascript, browser, google-chrome-extension

我想做一个小应用程序来检查某些网站上的特别优惠。此应用程序应定期访问此站点（每隔几个小时一次），解析 HTML 以找到报价并以某种方式通知我有关报价的信息。

我想用 JavaScript 开发它作为 Chrome 扩展。您知道我可以从中学习的此类扩展的任何示例吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T13:30:18.350

Chrome 扩展程序具有您所追求的可用功能：

*   请求您要获取的网站的权限。
*   创建一个[背景页面](http://developer.chrome.com/extensions/background_pages.html)，该页`setInterval`面向网站发出 ajax 请求并检查内容。
*   使用[通知](http://developer.chrome.com/extensions/notifications.html)来通知用户更新。通知后，将内容存储在本地，以便您知道直播内容何时再次更新。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-03T13:30:53.847

与其进行扩展，不如只订阅特定网站的 RSS 提要？您可以下载一个名为[RSS Live Links](https://chrome.google.com/webstore/detail/rss-live-links/hcamnijgggppihioleoenjmlnakejdph)的漂亮扩展程序来为您提供更新，并且您可以订阅他们的报价源。

# php - PHP：列出特定时期的未来日期

> ID：13209610
> 
> 赞同：0
> 
> 时间：2012-11-03T13:25:45.060
> 
> 标签：php, calendar

我正在尝试创建一个日历，使用户能够在六周内预订某些时间。

php 中是否有一种简单的方法可以做到这一点 - 目前我正在使用以下多个循环：

```
$end_of_month=cal_days_in_month(CAL_GREGORIAN, $this_month, $this_year); 
```

这看起来很笨拙，需要大量循环来确定月份、年份等的变化。

到目前为止，我对使用其他方法感到困惑，因为我确信有一种简单的方法可以做到这一点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T13:31:19.343

使用**[`DateTime`objects](http://il.php.net/datetime)**，将 the`DateTime::add()`与`DateInterval`objects 结合使用：

```
header("Content-type: text/plain");

$date = new DateTime("2012-01-01");
$one_day = new DateInterval("P1D");
echo $date->format("Y-m-d") . PHP_EOL;
for ($i = 0; $i < 42; $i++) {
    $date->add($one_day);
    echo $date->format("Y-m-d") . PHP_EOL;
} 
```

此示例将输出从初始日期开始的六周内的所有日期。但它非常灵活，可以为所欲为。

# android - 工具栏中的分段按钮左对齐

> ID：13209616
> 
> 赞同：1
> 
> 时间：2012-11-03T13:26:07.690
> 
> 标签：android, sencha-touch-2

工具栏中的分段按钮在 Android 设备中显示为左对齐，但在我的 chrome 浏览器和 iOS 设备中，它显示在中心。如何在 Android 中制作也出现在中心。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T14:45:52.517

你能告诉我一些代码吗？它在 Android 中也适用于我。

您唯一需要做的就是在分段按钮项目之前和之后添加 xtype:spacer。

```
items : [{ xtype : 'spacer'},

         {xtype : 'segmentedbutton', items:[]},

         {xtype : 'spacer'}] 
```

这应该可以工作，无论您使用什么浏览器。

# objective-c - 将 mp3 文件保存到 iphone 音乐库中

> ID：13209618
> 
> 赞同：0
> 
> 时间：2012-11-03T13:26:14.443
> 
> 标签：objective-c, iphone, mp3

我想与 iPhone 的 mp3 播放器进行交互：是否可以通过编程将 .mp3 文件保存到 Iphone 音乐库中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T13:31:59.857

如果您不打算通过 Cydia 分发它，那么答案是否定的，这是不可能的。但是，如果您要越狱，请查看 H2CO3 的[libiPodImport](https://github.com/H2CO3/libipodimport)。

# python - Python 库执行 UNIX 命令“对话框”的功能

> ID：13209620
> 
> 赞同：3
> 
> 时间：2012-11-03T13:26:16.027
> 
> 标签：python

我需要文本控制台交互式对话框。我正在将一个 shell 脚本移植到 Python。哪个 Python 工具几乎可以完成 UNIX 命令的`dialog`功能？（即即用型是/否、日历、文本、仪表等控件返回结果并且是类似 ncurses 的全屏 UI）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-03T13:28:21.820

你应该看看[Urwid](http://excess.org/urwid/)。

Urwid 在 curses 之上提供了一个更高级别的工具包，并包括一个事件循环来处理键盘和鼠标输入。它要么使用自己的基于选择的事件循环，要么可以挂接到 gevent 或 Twisted。

除了有效地处理键盘输入之外，您还可以使用许多选项来处理带有编辑框、列表控件等的用户输入。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-03T13:29:33.763

看看[诅咒](http://docs.python.org/2/library/curses.html)。它是低级的，但具有作为标准库一部分的优势。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2015-02-09T15:34:30.370

这些是对话框 Python 绑定： http: [//pythondialog.sourceforge.net/](http://pythondialog.sourceforge.net/)

# hadoop - Hadoop 的数值配方

> ID：13209627
> 
> 赞同：3
> 
> 时间：2012-11-03T13:27:03.333
> 
> 标签：hadoop, mapreduce, numerical-methods

[我正在整理我的《C 语言数字食谱》一书中](https://rads.stackoverflow.com/amzn/click/com/0521431085)的副本，并开始想知道是否存在类似的处理方法可以用于可以使用 MapReduce 和 Hadoop 进行颚化的算法。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-03T16:40:15.277

[atbrox](http://atbrox.com/2011/11/09/mapreduce-hadoop-algorithms-in-academic-papers-5th-update-%E2%80%93-nov-2011/)对不同领域的不同算法进行了很好的编译。对于文本处理来说[，这](http://lintool.github.com/MapReduceAlgorithms/index.html)是一个很好的选择。另外，搜索[@CiteSeerx](http://citeseerx.ist.psu.edu/index)。

# php - 从数组集合中查找具有共同值的数组。可能是 0 个或多个匹配项

> ID：13209628
> 
> 赞同：0
> 
> 时间：2012-11-03T13:27:03.993
> 
> 标签：php, arrays, reduce, array-intersect

我有以下数据结构：

```
array (size=3)
  0 => 
    array (size=4)
      0 => string 'apple' (length=5)
      1 => string 'colophon' (length=8)
      2 => string 'byo-fusion-drive' (length=16)
      3 => string 'scroll-targeting' (length=16)
  1 => 
    array (size=3)
      0 => string 'apply' (length=5)
      1 => string 'exploring-web-typography' (length=24)
      2 => string 'on-performance-content-management' (length=33)
  2 => 
    array (size=3)
      0 => string 'macbook' (length=7)
      1 => string 'colophon' (length=8)
      2 => string 'nifty-minidrive' (length=15) 
```

我试图找出我的数组集合中的哪些数组（如果有）共享一个共同的值。

例如：数组 0 和 2 共享字符串“colophon”。

我尝试过使用 array_intersect ，但这当然会返回 NULL，因为数组 1 与其他数组没有共同的值。

此外，在任何给定的集合中都可能（甚至可能）没有共同价值。数组的集合将始终包含至少两个数组。集合中可能有任意数量的附加数组。

有了上面描述的数据，最终结果应该是这样的：

```
array (size=2)
  0 => 
    array (size=4)
      0 => string 'apple' (length=5)
      1 => string 'colophon' (length=8)
      2 => string 'byo-fusion-drive' (length=16)
      3 => string 'scroll-targeting' (length=16)
  1 => 
    array (size=3)
      0 => string 'macbook' (length=7)
      1 => string 'colophon' (length=8)
      2 => string 'nifty-minidrive' (length=15) 
```

即：删除数组 1（从原始数组），因为它没有共同的价值。

我确信有一种简单的方法可以做到这一点，但我已经尝试了 8 个多小时，并决定寻求帮助。

任何人？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T13:46:10.650

尝试

```
$arr = array (
  array('apple', 'colophon', 'byo-fusion-drive', 'scroll-targeting', ),
  array('apply', 'exploring-web-typography', 'on-performance-content-management', ),
  array('macbook', 'colophon', 'nifty-minidrive', 'nifty-minidrive', ),
);

$repeated_values = array_keys(
  array_filter(
    array_count_values(
      array_reduce($arr, function ($res, $value) {
          return array_merge($res, array_unique($value));
        }, array()
      )
    ), function ($count) {
      return $count > 1;
  })
);

$result = array_filter($arr, function($value) use ($repeated_values) {
   if (sizeof(array_intersect($repeated_values, $value)) > 0) return true;
});

var_dump($result); 
```

输出

```
array (size=2)
  0 => 
    array (size=4)
      0 => string 'apple' (length=5)
      1 => string 'colophon' (length=8)
      2 => string 'byo-fusion-drive' (length=16)
      3 => string 'scroll-targeting' (length=16)
  2 => 
    array (size=4)
      0 => string 'macbook' (length=7)
      1 => string 'colophon' (length=8)
      2 => string 'nifty-minidrive' (length=15)
      3 => string 'nifty-minidrive' (length=15) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-03T13:42:05.453

您需要使用嵌套循环对其进行迭代。像这样：

```
$array = array(
    array(
        "apple",
        "colophon",
        "byo-fusion-drive",
        "scroll-targeting"
    ),
    array(
        "apply",
        "exploring-web-typography",
        "on-performance-content-management"
    ),
    array(
        "macbook",
        "colophon",
        "nifty-minidrive"
    )
);

for ($i = 0; $i < count($array); $i++) {
    for ($j = $i+1; $j < count($array); $j++) {
        var_dump(array_intersect($array[$i], $array[$j]));
    }
} 
```

哪个输出：

```
array (size=0)
  empty
array (size=1)
  1 => string 'colophon' (length=8)
array (size=0)
  empty 
```

* * *

对循环的简单修改给出了预期的行为：

```
$result = array();

for ($i = 0; $i < count($array); $i++) { //Start from the first array, and continue up to all of them.
    for ($j = $i+1; $j < count($array); $j++) { //Start with the current array of $i, +1\. So that collisions never occur.
        if (count(array_intersect($array[$i], $array[$j])) !== 0) { //If there are common values (the array_intersect() function returns a non-empty array
            if (!in_array($array[$i], $result)) $result[] = $array[$i]; //Add the first array (if it's not there already)
            if (!in_array($array[$j], $result)) $result[] = $array[$j]; //Add the second array (if it's not there already)
        }
    }
} 
```

哪个输出

```
array (size=2)
  0 => 
    array (size=4)
      0 => string 'apple' (length=5)
      1 => string 'colophon' (length=8)
      2 => string 'byo-fusion-drive' (length=16)
      3 => string 'scroll-targeting' (length=16)
  1 => 
    array (size=3)
      0 => string 'macbook' (length=7)
      1 => string 'colophon' (length=8)
      2 => string 'nifty-minidrive' (length=15) 
```

# c - 使用 write 系统调用打印整数

> ID：13209632
> 
> 赞同：0
> 
> 时间：2012-11-03T13:27:33.687
> 
> 标签：c

我想拥有相当于

```
void print3( char a, uint8_t b, int8_t c )
{
    printf("%c %" PRIu8 " %" PRIi8 "\n", a, b, c);
} 
```

使用`write`系统调用。问题是，我不知道如何使用 `write`. 只允许来自 ANSI C 的命令，并且`sprintf`禁止使用格式化字符串。

使用 write 的示例语法：

```
const char msg[] = "Hello World!";
write(STDOUT_FILENO, msg, sizeof(msg)-1); 
```

编辑：我不允许`sprintf`使用`itoa`.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T13:53:13.603

考虑这个数字`155`，如果你除以`100`百`1`，余数是`55`，除以`10`你得到`5`10，余数是`5`，除以`1`你得到`5`。现在连接这些数字 1-5-5 你得到最终的数字。这应该让你开始。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-03T13:52:34.947

要打印的数字的每个数字都表示为一个字符。

解决方案有两个部分：

*   计算所选基数中的数字位数，在这种情况下我假设为 10

*   将数字转换为字符并写入

对于计算数字的步骤，您将使用`/`and`%`运算符；这将以“反向”顺序给出数字，因此您需要在编写它们之前将它们松鼠。

要将数字转换为字符，请考虑两种方法：简单算术（使用 ASCII 字符值）或数组查找。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-03T13:56:03.020

您必须自己进行转换。下面的代码转换为 ASCIIZ（C 字符串），而不是简单的 ASCII，但它是可用的：

```
int ltoa(long x, char *str, size_t str_size)
{
    long y = 1;
    size_t i, s;
    for (s = 0; y < x; s++)
        y *= 10;
    if (str_size < s+1)
        return s+1;
    str[s--] = 0x0;
    while(s)
    {
            str[s--] = '0' + (x % 10);
            x /= 10;
    }
    str[0] = '0' + x;
    return 0;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-03T13:57:52.313

你知道吗`9(in ascii) == '0' + 9`：

```
char a =0;
a = '0';
printf("%c",a); //will print 0
a = '0' + 8; 
printf("%c",a);//will print 8 
```

![在此处输入图像描述](../Images/b40e4391e6d331e1861df71c3de1be57.png)

**编辑：**

```
int a = 1234; 
```

现在将其转换为`char* b`：算法：

```
for each digit in a:
   b.append(digit+'0') 
```

# 你必须明白它`char`是一个容器，`8 bits == byte`可以是一个数字、ASCII 中的一个字母或任何你想在 8 位内表示的东西

# nhibernate - Nhibernate 数据绑定外键查找编辑

> ID：13209633
> 
> 赞同：2
> 
> 时间：2012-11-03T13:27:37.477
> 
> 标签：nhibernate, data-binding, devexpress

我想将外键属性 Product.CategoryId 数据绑定到 Windows 窗体应用程序中的 Devexpess Lookupedit。所以

```
 lookEditCategory.DataBindings
       .Add(new Binding("EditValue", Product, "CategoryId ", true,
        DataSourceUpdateMode.OnPropertyChanged));

        lookEditCategory.Properties.Columns.Clear();
        lookEditCategory.Properties.NullText = "";
        lookEditCategory.Properties.DataSource = CatCol;
        lookEditCategory.Properties.ValueMember = "CategoryId";
        lookEditCategory.Properties.DisplayMember = "CategoryName";
        var col = new LookUpColumnInfo("CategoryName") { Caption = "Type" };
        lookEditCategory.Properties.Columns.Add(col); 
```

问题是 Nhibernate 没有公开外键 Product.CategoryId。相反，我的实体和映射是这样的

```
public partial class Product
{
public virtual int ProductId { get; set; }
[NotNull]
[Length(Max=40)]
public virtual string ProductName { get; set; }
public virtual bool Discontinued { get; set; }
public virtual System.Nullable<int> SupplierId { get; set; }

[Length(Max=20)]
public virtual string QuantityPerUnit { get; set; }
public virtual System.Nullable<decimal> UnitPrice { get; set; }
public virtual System.Nullable<short> UnitsInStock { get; set; }
public virtual System.Nullable<short> UnitsOnOrder { get; set; }
public virtual System.Nullable<short> ReorderLevel { get; set; }

private IList<OrderDetail> _orderDetails = new List<OrderDetail>();

public virtual IList<OrderDetail> OrderDetails
{
  get { return _orderDetails; }
  set { _orderDetails = value; }
}

public virtual Category Category { get; set; }

public class ProductMap : FluentNHibernate.Mapping.ClassMap<Product>
{
  public ProductMap()
  {
    Table("`Products`");
    Id(x => x.ProductId, "`ProductID`")
      .GeneratedBy
        .Identity();
    Map(x => x.ProductName, "`ProductName`")
;
    Map(x => x.Discontinued, "`Discontinued`")
;
    Map(x => x.SupplierId, "`SupplierID`")
;

    Map(x => x.QuantityPerUnit, "`QuantityPerUnit`")
;
    Map(x => x.UnitPrice, "`UnitPrice`")
;
    Map(x => x.UnitsInStock, "`UnitsInStock`")
;
    Map(x => x.UnitsOnOrder, "`UnitsOnOrder`")
;
    Map(x => x.ReorderLevel, "`ReorderLevel`")
;
    HasMany(x => x.OrderDetails)
      .KeyColumn("`ProductID`")
      .AsBag()
      .Inverse()
      .Cascade.None()
;
    References(x => x.Category)
      .Column("`CategoryID`");
  }
}
} 
```

我无法在我的产品实体和映射中添加属性 CategoryID，因为那样它将被映射两次。有什么解决办法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-05T20:48:03.133

是的。不要在 UI 中使用您的域实体。
有时您的 UI 不需要（也不应该知道）域对象的所有属性。
其他时候，它需要包含来自不同域源的数据的 DTO（例如 - 屏幕的`CourseName`s列表`Student`），或者，就像你的情况一样 - 它需要以稍微不同的方式表示数据。
因此，最好的方法是使用 UI 所需的所有（且仅）属性创建您的 DTO。
有关详细信息，请参阅[此 SO 问题](https://stackoverflow.com/questions/821276/why-should-i-isolate-my-domain-entities-from-my-presentation-layer)。

# android - 如何使用 Notifydataset changed 用于 android 中的列表适配器

> ID：13209634
> 
> 赞同：1
> 
> 时间：2012-11-03T13:27:42.443
> 
> 标签：android, listview, adapter, android-arrayadapter

我在 Google 上搜索了很多关于此 notifydataset 更改问题的信息，但我仍然无法找到答案，我有一个包含自定义对象的列表视图。

**我的实现看起来像这样**

1) 自定义对象列表 2) 我向其提供自定义对象列表的适配器

**我的问题：**

当我从列表中删除任何项目时，在后端我只是从自定义对象列表中调用删除。如果我调用notifyDatasetchanged，它不起作用:(..

它没有刷新列表，我不知道它在哪里丢失。请帮助我在这个 senarios 中更新列表的程序是什么

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T13:41:14.423

看看我在这个帖子中[的回答。](https://stackoverflow.com/questions/10455475/populating-listview-in-separate-thread/10508868#10508868)

如果您仍有问题，请告诉我。

干杯！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T13:36:57.953

像这样对自定义 ListView 使用 AsynkTask：-

```
 InboxTask.execute(); will call asynktask

class InboxTask extends AsyncTask<Uri, Integer, ArrayList<InboxField>> 
{
@Override
    protected void onPreExecute() 
   {
     pd=ProgressDialog.show(HomePage.this, "", "Please wail...",true,false);
    super.onPreExecute();
   }
@Override
    protected ArrayList<InboxField> doInBackground(Uri... params) 
    {
return ArrayList<InboxField>
}
  @Override
    protected void onPostExecute(ArrayList<InboxField> result) 
    {
        inboxAdapter=new InboxAdapter(HomePage.this,result);
        list.setAdapter(inboxAdapter);
                      adapter.notifyDataSetChanged();
            list.destroyDrawingCache();
        pd.dismiss();

    } 
```

将 adepter.notigyDataSetChanged 放在 onPostExecute 方法中

# powerbuilder - Powerbuilder 数据处理错误？

> ID：13209637
> 
> 赞同：1
> 
> 时间：2012-11-03T13:28:08.307
> 
> 标签：powerbuilder

我对 Powerbuilder 还很陌生，并且在运行时遇到了这个问题。当我运行我的程序时，它显示此错误：

```
999 Cannot connect!
DBMS is not supported in your current installation 
```

这是什么原因？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-03T16:41:49.547

您没有正确填充事务对象。在代码中的某处，您正在执行类似于`SQLCA.DBMS = "XXX"` XXX 是数据库接口的前三个字符的操作，例如，`SQLCA.DBMS = "ODB"`对于 ODBC 或`SQLCA.DBMS = "ORA"`Oracle。

消息读取的事实

```
DBMS is not supported in your current installation 
```

相对

```
DBMS XXX is not supported in your current installation 
```

表示 DBMS 属性被设置为空字符串。许多应用程序使用`ProfileString`从 INI 文件中获取此值，因此该值可能不在 INI 文件中，或者（更有可能）您的应用程序在运行时未找到 INI 文件。

# multithreading - 使用 android Application 类运行线程后台将一些数据发布到 webservice

> ID：13209639
> 
> 赞同：2
> 
> 时间：2012-11-03T13:28:33.023
> 
> 标签：multithreading, android

我可以在 Android Application 类中写一个线程吗？该线程每五分钟运行一次，以将数据发布到 Web 服务。

```
public class MyApplication  extends Application {
@Override
public void onCreate() {
    startUploadGPSTimer();
}

private void startUploadGPSTimer() {
    gpsTimerHandler.postDelayed(runnable, 5* 60 * 1000); // start Timer
}

private Handler gpsTimerHandler = new Handler();

private Runnable runnable = new Runnable() {
    public void run() {
        Map<String, String> params = new HashMap<String, String>();
        params.put("latitude", Global.CUR_LATITUDE);
        params.put("longitude", Global.CUR_LONGITUDE);
        WebServiceObj obj = new WebServiceObj("upload",
                WebServiceMethod.METHOD_UPLOAD_GPS,
                Utilly.getSoapParams(params));
        SoapService service = null;
        SoapObject result = null;
        service = new SoapService(obj.tag);
        result = service.LoadResult(obj);
        Log.i("post webservrce  ", result.toString());
        gpsTimerHandler.postDelayed(this, 5 * 60 * 1000);
    }
}; 
```

当我的应用程序进入后台时，这个线程就像不运行。由于我在线程中发布的数据最终输入到数据库，我在db中找不到它。

为什么？

我在将数据发布到 web 服务时写了一些日志。发现日志是随机生成的。很奇怪

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T13:46:13.920

```
Intent photosIntent = new Intent(this, MyService.class);
pendingIntent = PendingIntent.getBroadcast(getApplicationContext(), 0,photosIntent, PendingIntent.FLAG_UPDATE_CURRENT);
alarmManager = (AlarmManager)getSystemService(ALARM_SERVICE);
alarmManager.setRepeating(AlarmManager.RTC_WAKEUP, 5*60*1000,5*60*1000, pendingIntent); 
```

在 MyService 中是一个服务类，在 onstart 中写入您的内容以向 Web 服务发送请求。该服务将每 5 分钟调用一次。

希望这可以帮助。

谢谢

# java - Java 检测音频文件 (mp3)

> ID：13209644
> 
> 赞同：3
> 
> 时间：2012-11-03T13:29:09.583
> 
> 标签：java, audio, mp3, javasound, ogg

我有这个读取 mp3 文件的代码

```
import java.io.File;
import java.io.IOException;
import javax.sound.sampled.AudioSystem;
import javax.sound.sampled.UnsupportedAudioFileException;

    public class Sound {
        public static void main(String[] args) {
            File sampleFile = new File("test.mp3");
            try {
                AudioSystem.getAudioFileFormat(sampleFile);
            } catch (UnsupportedAudioFileException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            } catch (IOException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
        }
    } 
```

这里的问题是它返回文件不支持的异常，这里的文件是一个 mp3 文件。Java 不支持 mp3 文件？如果是这样，还有什么其他人可以验证音频文件？（如 ogg、wav）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-03T13:38:07.613

您可以查看[Apache Tika](http://tika.apache.org/)库。它可以通过文件的内容检测文件的类型并提取文件元数据。它[支持](http://tika.apache.org/1.2/formats.html#Audio_formats)mp3格式。

这是使用 Apache Tika 进行文件类型检测的[示例](http://jeszysblog.wordpress.com/2012/03/05/file-type-detection-with-apache-tika/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-03T13:41:52.860

您需要添加[MP3SPI](http://www.javazoom.net/mp3spi/mp3spi.html)库，以便 java 音频 api 可以识别和解码 mp3 文件。

# .htaccess - htaccess 在根目录和子文件夹上重写 index.php

> ID：13209647
> 
> 赞同：1
> 
> 时间：2012-11-03T13:29:30.347
> 
> 标签：.htaccess, mod-rewrite, indexing, rewrite, clean-urls

我试图将所有请求重定向到 ./index.php?site=$1 而我只想使用最后一个斜杠后面的部分。

所以我想`www.mydomain.com/firstpage`成为`www.mydomain.com/index.php?site=firstpage`和 www.mydomain.com/subfolder/anotherpage 成为`www.mydomain.com/subfolder/index.php?site=anotherpage`

但是现在`www.mydomain.com/subfolder/anotherpage`变成 `www.mydomain.com/index.php?site=subfolder/anotherpage`

这就是我所拥有的：

```
RewriteEngine on
Options +SymlinksIfOwnerMatch
RewriteBase /

RewriteCond %{HTTP_HOST} ^mydomain.com$ [NC]
RewriteRule ^(.*)$ http://www.mydomain.com/$1 [R=301,L]

RewriteCond %{REQUEST_FILENAME} !-f 
RewriteCond %{REQUEST_FILENAME} !-d 
RewriteRule ^(.*)$ /index.php?site=$1 [L] 
```

我能做些什么来只重定向最后一个斜杠之后的部分？
太感谢了！

* * *

### 解决方案：

```
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule (.*/)?([^/]+)$ $1index.php?site=$2 [L] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T13:30:06.580

找到了另一个，我认为更优雅的解决方案。这样，子文件夹的数量就无关紧要了。

* * *

### 解决方案：

```
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule (.*/)?([^/]+)$ $1index.php?site=$2 [L] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T15:16:00.923

终于自己想出了答案。
起初，我尝试将更多 RewriteRules 放在相同的 RewriteCond 行下，这给了我服务器错误。所以我复制了子目录的 RewriteCond 行：

```
RewriteCond %{REQUEST_FILENAME} !-f 
RewriteCond %{REQUEST_FILENAME} !-d 
RewriteRule ^(.*)/(.*)$ $1/index.php?site=$2 [L]

RewriteCond %{REQUEST_FILENAME} !-f 
RewriteCond %{REQUEST_FILENAME} !-d 
RewriteRule ^(.*)$ /index.php?site=$1 [L] 
```

# c++ - 是否可以从 C++ 文件中的一行中读取特定字符？

> ID：13209650
> 
> 赞同：2
> 
> 时间：2012-11-03T13:29:46.463
> 
> 标签：c++, string, fstream

嘿，所以我必须从文本文件中获取值，但是这些值并不独立，它们都写成这样：

人口规模：30

在'：'之后我可以从c ++中读取任何方法吗？我试过使用 >> 运算符，如：

```
string pop;
inFile >> pop; 
```

但是当然，空格会在语句到达数字之前终止语句，并且出于某种原因使用

```
inFile.getline(pop, 20); 
```

给了我很多错误，因为它出于某种原因不想直接写入字符串。我真的不想使用 char 数组，因为这样就不会那么容易测试数字并单独从中提取字符串。那么无论如何我可以将getline函数与字符串一起使用吗？是否可以从“：”字符之后读取？

```
#include <iostream>
#include <fstream>
#include <string>
#include <cstring>
#include <cstdlib>

using namespace std;
int main()
{
    string fname;
    cin >> fname;
    ifstream inFile;
    inFile.open(fname.c_str()); 
    string pop1;
    getline(inFile,pop1);
    cout << pop1;
    return 0;
} 
```

好的，这是我使用新 getline 的代码，但它仍然没有输出任何内容。它确实正确打开了文本文件，并且可以与 char 数组一起使用

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-03T13:33:46.680

您可能最好阅读整行然后操作字符串：-

```
std::string line;
std::getline(inFile, line);
line = line.substr(19);  // Get character 20 onwards... 
```

您可能也更好地寻找冒号：-

```
size_t pos = line.find(":");
if (pos != string::npos)
{
    line = line.substr(pos + 1);
} 
```

或类似的东西

完成后，您可能希望将其反馈到字符串流中，以便您可以读取整数和其他内容？

```
int population;
std::istringstream ss(line);
ss >> population; 
```

显然，这一切都取决于你想对数据做什么

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-03T13:56:14.563

假设你的数据是形式

```
 <Key>:<Value> 
```

每行一个。然后我会这样做：

```
std::string line;
while(std::getline(inFile, line))
{
    std::stringstream  linestream(line);

    std::string key;
    int         value;

    if (std::getline(linestream, key, ':') >> value)
    {
        // Got a key/value pair
    }
} 
```

# extjs - 在 extjs4 中绑定一个属性

> ID：13209651
> 
> 赞同：0
> 
> 时间：2012-11-03T13:30:15.760
> 
> 标签：extjs, extjs4

我只是使用以下配置参数创建基于“Ext.form.field.Trigger”的组件：

```
config: {
    selectedId: 0,
    selectedRecord: null,
    searchControl: '',
    displayField: '',
    autoSearch: true
}, 
```

如何绑定“selectedId”变量作为此类字段的值发送到服务器？

例如：

我的表中有一个字段：brand_id。

我的表单中有我的自定义控件，需要发送品牌记录的 id（就像组合框一样）。此 ID 在“selectedId”变量中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T10:48:13.167

您将需要覆盖您构建`getValue()`的自定义`triggerfield`组件的方法。根据调用提交方法的方式，预定义的方法在提交期间`form`使用`getValue() or`getRawValue() 方法。

如果您阅读了triggerfield 的`getValue()` [文档](http://docs.sencha.com/ext-js/4-1/#!/api/Ext.form.field.Base-method-getValue)，您将看到以下文档：

> 返回字段的当前数据值。返回值的类型特定于特定字段的类型（例如，Ext.form.field.Date 的 Date 对象），作为对字段的已处理字符串值调用 rawToValue 的结果。要返回原始字符串值，请参阅 getRawValue。

因此，覆盖该`getValue()`方法并返回您想要发送到服务器的任何内容。默认情况下，getValue() 将返回底层 html`input`字段的 value 属性。

# jquery - 在 jQuery 中反转“属性开始于”选择器

> ID：13209657
> 
> 赞同：0
> 
> 时间：2012-11-03T13:31:25.137
> 
> 标签：jquery, jquery-selectors

根据文档，Selector '`Attribute Starts With'` *选择具有指定属性的元素，其值恰好以给定的字符串开头。*我想做完全相反的事情 - 我想选择那些**指定属性的值位于给定字符串开头的**元素。

考虑以下示例：

```
<a href="/about-us/">About us</a>
<a href="/products/">Products</a>
<a href="/contact/">Contact</a> 
```

当前 URL 是`/products/some-catogory/sub-category/product/?x=y&z=x`，我想突出显示第二个菜单项。最好的方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-03T13:49:27.453

我建议：

```
var path = document.location.pathname;
$('a').filter(
    function(i,e){
        return $(this).attr('href').indexOf(path) == 0;
    }).addClass('highlight'); 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/pYwzF/)。

`highlight`类名适当地定义了突出显示。

这是使用以下 HTML 测试的：

```
<a href="/about-us/">About us</a>
<a href="/products/">Products</a>
<a href="/_display/">_display</a>
<a href="/contact/">Contact</a>​ 
```

请记住，这在 JS Fiddle 上得到了证明，因此它将匹配第三个`a`元素（因为那是匹配的元素。

编辑以提供更通用的解决方案，您可以在其中匹配给定的目录/子目录：

```
function directory(path) {
    if (!path) {
        return false;
    }
    else {
        var _tmp = path.split('/'),
            directories = [];
        for (var i = 0, len = _tmp.length; i < len; i++) {
            if (_tmp[i].length > 0 && _tmp[i].indexOf('?') == -1) {
                directories.push(_tmp[i]);
            }
        }
        return directories;
    }
}
// in the real world use:
// var path = document.location.pathname,
var path = '/products/some-catogory/sub-category/product/?x=y&z=x',
    dir = directory('/products/some-catogory/sub-category/product/?x=y&z=x')[0];
$('a').filter(
    function(i, e) {
        return $(this).attr('href').indexOf(dir) == 0 || $(this).attr('href').indexOf('/' + dir) == 0
    }).addClass('highlight');​ 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/pYwzF/1/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T13:35:31.803

我不确定您要做什么，但您可以选择第二项：

```
a:contains("Products") 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-03T14:18:34.767

您可以`:not`与“属性开始于”选择器一起使用来实现此目的。

*例如：* `$('a:not([href^="whetever"])')`

看这个**演示：http:** [//jsfiddle.net/XH7Ut/](http://jsfiddle.net/XH7Ut/)

# java - 使用 For-loop 在屏幕上绘制 ImageArray 时，继续在屏幕上绘制 / 将其制作为 .jar 时，它不会执行

> ID：13209659
> 
> 赞同：-1
> 
> 时间：2012-11-03T13:32:44.387
> 
> 标签：java, slick2d

我用 Java 和 Slick 制作了这个 2D 游戏。问题似乎出在这段代码中：

```
public void initRedAndBlueBall() throws SlickException
    {           
       //   Makes sure the red and the blue ball aren't too close
        for(int i = 0; i <= amountOfEatenBalls; i++)
        {
            // Get random cordinates for the red and blue ball.
            randomRedX[i] = random.nextInt(550) + 24;
            randomRedY[i] = random.nextInt(350) + 24;
            randomBlueX = random.nextInt(550) + 24;
            randomBlueY = random.nextInt(350) + 24;

    // Initialize the new Redball with a picture.
    redball[i] = new Image("res/RedBall.png");
    // Draws the red ball on the screen. 
    drawRedBall(randomRedX[i], randomRedY[i], redball[i]);

    if(isInTheRangeOf(randomRedX[i], randomBlueX, 30) == false)
    {
        System.out.println("The red and the blue ball have good positions");
            break;
            }
            else if(isInTheRangeOf(randomRedX[i], randomBlueX, 30) == true)
            {
                System.out.println("The red and the blue ball are to close!");
                System.out.println("Repositioning the red and blue ball");
            }  
        }
    } 
```

这是我的所有代码：

游戏.java

```
package javagame;

import org.newdawn.slick.*;
import org.newdawn.slick.state.*;

public class Game extends StateBasedGame
{

   public static final String gamename = "Mini Game";
   public static final int menu = 0;
   public static final int play = 1;
   public static final int gameOver = 2;
   public static final int windowX = 600;
   public static final int windowY = 400;

   public Game(String gamename)
   {
      super(gamename);
      this.addState(new Menu(menu));
      this.addState(new Play(play));
      this.addState(new GameOver(gameOver));
   }

   public void initStatesList(GameContainer gc) throws SlickException
   {
      this.getState(menu).init(gc, this);
      this.getState(play).init(gc, this);
      this.enterState(menu);
   }

   public static void main(String[] args) 
   {
      AppGameContainer appgc;
      try
      {
         appgc = new AppGameContainer(new Game(gamename));
         appgc.setDisplayMode(windowX, windowY, false);
         appgc.start();
      }
      catch(SlickException e)
      {
         e.printStackTrace();
      }
   }

} 
```

菜单.java

```
 package javagame;

    import org.lwjgl.input.Mouse;
    import org.newdawn.slick.*;
    import org.newdawn.slick.state.*;
    import org.newdawn.slick.MouseListener;

    public class Menu extends BasicGameState
    {
        Image PlayNow, PlayNowHover, ExitGame, ExitGameHover, PlayButton, ExitGameButton;
        int MousePosX;
        int MousePosY;

       public Menu(int state)  {}

       public void init(GameContainer gc, StateBasedGame sbg) throws SlickException
       {
           // Billederne er 125x26
           PlayNow = new Image("res/PlayNow.png");
           PlayNowHover = new Image("res/PlayNowHover.png");
           ExitGame = new Image("res/ExitGame.png");
           ExitGameHover = new Image("res/ExitGameHover.png");

           PlayButton = PlayNow;
           ExitGameButton = ExitGame;
       }

       public void render(GameContainer gc, StateBasedGame sbg, Graphics g) throws SlickException
       {
           // Framet er 600x400
           g.drawString(MousePosX + ", " + MousePosY, 500, 10);
           g.drawLine(0, 26, 600, 26);

           g.drawImage(PlayButton, 200, 100);
           g.drawImage(ExitGameButton, 200, 150);

           g.drawString("You move with the arrowkeys.", 200, 200);
           g.drawString("There's 1 rule:", 200, 215);
           g.drawString("Don't eat the red balls!", 200, 230);
           g.drawString("But you can enjoy the blue ones :- P", 200, 245);
       }

       public void update(GameContainer gc, StateBasedGame sbg, int delta) throws SlickException
       {
              Input input = gc.getInput();
              MousePosX = input.getMouseX();
              MousePosY = input.getMouseY();

              // PlayNow Hover or Normal
              if(MousePosX > 200 && MousePosX < 325     &&      MousePosY > 100 && MousePosY < 126)
              {
                  PlayButton = PlayNowHover;
              }
              else
              {
                  PlayButton = PlayNow;
              }
              //ExitGame Hover or Normal
              if(MousePosX > 200 && MousePosX < 325     &&      MousePosY > 150 && MousePosY < 176)
              {
                  ExitGameButton = ExitGameHover;
              }
              else
              {
                  ExitGameButton = ExitGame;
              }

              // Now the buttons have a function
              if(MousePosX > 200 && MousePosX < 325     &&      MousePosY > 100 && MousePosY < 126)
              {
                  if(Mouse.isButtonDown(0))
                  {
                      sbg.enterState(1);
                  }
              }
              if(MousePosX > 200 && MousePosX < 325     &&      MousePosY > 150 && MousePosY < 176)
              {
                  if(Mouse.isButtonDown(0))
                  {
                      System.exit(0);
                  }
              }

       } 

       public int getID()
       {
          return 0;
       }
    } 
```

播放.java

```
 package javagame;

import org.newdawn.slick.*;
import org.newdawn.slick.state.*;

import java.util.Random;

public class Play extends BasicGameState
{
    Image ball, blueball;
    Image[] redball;
    Animation roll;   

    int[] duration = {200, 200};
    float defBallPosX = 300; // DEFAULT
    float defBallPosY = 200; // DEFAULT
    float ballPosX = 300; 
    float ballPosY = 200; 
    int MousePosX;
    int MousePosY;
    Random random;
    float[] randomRedX; // X for the RedBall.png
    float[] randomRedY; // Y for the RedBall.png
    float randomBlueX; // X for the BlueBall.png
    float randomBlueY; // Y for the BlueBall.png

    static int amountOfEatenBalls;

    boolean blueAndRedAreNotToClose;

    public Play(int state)
    {

    }

    public void init(GameContainer gc, StateBasedGame sbg) throws SlickException
    {
        ball = new Image("res/PurpBallNorm.png"); // 25x25 px
        Image[] images = {ball, ball};

        redball = new Image[50];
        blueball = new Image("res/BlueBall.png");

        roll = new Animation(images, duration, false);

        random = new Random();

        randomRedX = new float[50];
        randomRedY = new float[50];

        amountOfEatenBalls = 0;
    }

    public void render(GameContainer gc, StateBasedGame sbg, Graphics g) throws SlickException
    {
       //   The Window is 600x400
        g.drawString(MousePosX + ", " + MousePosY, 500, 10);

        g.drawLine(0, 26, Game.windowX, 26); // Ceiling
        g.drawLine(1, 26, 1, Game.windowY); // Left Wall
        g.drawLine(Game.windowX - 2, 26, Game.windowX - 2, Game.windowY - 2); // Right Wall
        g.drawLine(1, Game.windowY - 2, Game.windowX - 2, Game.windowY - 2); // Floor

        roll.draw(ballPosX, ballPosY);

        initRedAndBlueBall(); 
    }

    public void update(GameContainer gc, StateBasedGame sbg, int delta) throws SlickException
    {
            Input input = gc.getInput();
            MousePosX = input.getMouseX();
            MousePosY = input.getMouseY();

            if(input.isKeyDown(Input.KEY_UP))
                ballPosY -= delta * .1f;
            else if(input.isKeyDown(Input.KEY_DOWN))
                ballPosY += delta * .1f;
            else if(input.isKeyDown(Input.KEY_LEFT))
                ballPosX -= delta * .1f;
            else if(input.isKeyDown(Input.KEY_RIGHT))
                ballPosX += delta * .1f;

            blueBallTouch(); 

            for(int i = 0; i <= amountOfEatenBalls; i++)
            {
                if(isInTheRangeOf(ballPosX, randomRedX[i], 25) == true && isInTheRangeOf(ballPosY, randomRedY[i], 25) == true)
                {
                    System.out.println("Player has eaten a red ball!");
                    sbg.enterState(2);
                }
            }

//          Makes sure the ball can't run out of the window
            if(ballPosX <= 2)
            {
                ballPosX += delta * .1f;
            }
            else if(ballPosX >= Game.windowX - 27)
            {
                ballPosX -= delta * .1f;
            }
            else if(ballPosY <= 26)
            {
                ballPosY += delta * .1f;
            }
            else if(ballPosY >= Game.windowY - 27)
            {
                ballPosY -= delta * .1f;
            }
    } 

    public int getID() 
    {
        return 1;
    }

    public boolean isInTheRangeOf(float x, float y, float range)
    {
            float a = 0;
            float b = 0;

            if(x > y)
            {
                a = x;
                b = y;
            }
            else if(y > x)
            {
                b = x;
                a = y;
            }   

            if((a - b) <= range)
            {
                return true;
            }
            else if((a - b) >= range)
            {
                return false;
            }
            return true;
    }

    public void initRedAndBlueBall() throws SlickException
    {           
       //   Makes sure the red and the blue ball aren't too close
        for(int i = 0; i <= amountOfEatenBalls; i++)
        {
            // Get random cordinates for the red and blue ball.
            randomRedX[i] = random.nextInt(550) + 24;
            randomRedY[i] = random.nextInt(350) + 24;
            randomBlueX = random.nextInt(550) + 24;
            randomBlueY = random.nextInt(350) + 24;

            // Initialize the new Redball with a picture.
            redball[i] = new Image("res/RedBall.png");
            // Draws the red ball on the screen. 
            drawRedBall(randomRedX[i], randomRedY[i], redball[i]);

            if(isInTheRangeOf(randomRedX[i], randomBlueX, 30) == false)
            {
                System.out.println("The red and the blue ball have good positions");
                break;
            }
            else if(isInTheRangeOf(randomRedX[i], randomBlueX, 30) == true)
            {
                System.out.println("The red and the blue ball are to close!");
                System.out.println("Repositioning the red and blue ball");
            }  
        }
    }

    public void drawRedBall(float x, float y, Image image)
    {
        Graphics g = new Graphics();
        g.drawImage(image, x, y);
    }

    public void blueBallTouch() throws SlickException
    {
        if(isInTheRangeOf(ballPosX, randomBlueX, 25) == true && isInTheRangeOf(ballPosY, randomBlueY, 25) == true)
        {
            amountOfEatenBalls++;

            initRedAndBlueBall();
        }
        else
        {

        }
   }

   public static int getAmountOfEatenBalls()
   {
       return amountOfEatenBalls;
   }

} 
```

GameOver.java

```
package javagame;

import org.lwjgl.input.Mouse;
import org.newdawn.slick.*;
import org.newdawn.slick.state.*;

public class GameOver extends BasicGameState
{
    Image ExitGame, ExitGameHover, ExitGameButton;
    int MousePosX;
    int MousePosY;

    public GameOver(int state)
    {

    }

    public void init(GameContainer gc, StateBasedGame sbg) throws SlickException
    {
        ExitGame = new Image("res/ExitGame.png");
        ExitGameHover = new Image("res/ExitGameHover.png");

        ExitGameButton = ExitGame;
    }

    public void render(GameContainer gc, StateBasedGame sbg, Graphics g) throws SlickException
    {
        g.drawImage(ExitGameButton, 200, 100);
        g.drawString("You've eaten: " + Play.getAmountOfEatenBalls() + " balls!", 200, 190);
    }

    public void update(GameContainer gc, StateBasedGame sbg, int delta) throws SlickException
    {
        Input input = gc.getInput();
        MousePosX = input.getMouseX();
        MousePosY = input.getMouseY();

         if(MousePosX > 200 && MousePosX < 325  &&      MousePosY > 100 && MousePosY < 126)
          {
              ExitGameButton = ExitGameHover;
          }
          else
          {
              ExitGameButton = ExitGame;
          }

         if(MousePosX > 200 && MousePosX < 325  &&      MousePosY > 100 && MousePosY < 126)
          {
              if(Mouse.isButtonDown(0))
              {
                  System.exit(0);
              }
          }
    }

    public int getID()
    {
        return 2;
    }

} 
```

- 这是我第一次使用stackoverflow，所以如果这完全不可读，请告诉我我应该做什么而不是上传所有代码..

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T13:35:29.190

问题很可能与资源加载有关。您将图像作为文件加载，当它们被解包时它可以工作，但是当它们在 jar 中时，您应该使用`Class.getResourceAsStream`

例如图像在 jar 文件中，可以通过以下方式访问，`res/image.jpg`那么您应该使用`getClass().getResourceAsStream("/res/image.jpg")`. 然后您可以使用此流读取图像内容。

# iphone - 在Objective C中将字典数组解析为SQLite

> ID：13209664
> 
> 赞同：2
> 
> 时间：2012-11-03T13:33:09.347
> 
> 标签：iphone, objective-c

我有 JSON 格式的数据，我正在尝试生成 SQL 插入语句，以便可以将数据加载到 SQLite 数据库的表中。

我的 JSON 看起来像这样：

```
{
    "data": [
        {
            "cities": [
                "Washington",
                "Washington"
            ],
            "num_buildings": 2,
            "building_ids": [
                "604159",
                "634589"
            ]
        },
        {
            "cities": [
                "Buffalo",
                "Buffalo",
                "Boston"
            ],
            "building_count": 3,
            "building_ids": [
                "652100",
                "676349",
                "652101"
            ]
        }
    ]
} 
```

我解析 JSON 并得到如下数据结构。

```
{
cities =         (
    Washington,
    Washington
);
"num_buildings" = 2;
"event_ids" =         (
    604159,
    634589
  );
},
{
cities =         (
     Buffalo,
     Buffalo,
     Boston
);
"num_buildings" = 3;
"building_ids" =         (
     652100,
     676349,
     652101
  );
} 
```

接下来我想生成 SQL 语句，以便将数据加载到表中。

```
NSDictionary *JSONDictionary = [self JSONDictionaryForClassWithName:@"myJSON"];
NSArray *records = [JSONDictionary objectForKey:@"data"];
  for (NSDictionary *record in records) {
  [self mergeRecordsForClassName:className forRecord:record] ;
};
NSLog(@"Initial sync recs are %@",records);
-(void)mergeRecordsForClassName:(NSString *)entityName forRecord:(NSDictionary *)record {
  NSString *insert_stmt2 =[NSString stringWithFormat:@"INSERT OR REPLACE INTO %@("
    "city,building_count,building_id") values("
    "'%@',%i,'%@') ",
    entityName,
    [record valueForKey:@"cities"],
    [[record valueForKey:@"building_count"]  intValue],
    [record valueForKey:@"building_id"]
    ];
    NSLog(@"The insert stmt2 is %@",insert_stmt2);
} 
```

它生成如下 SQL 语句，这显然是错误的。

```
INSERT OR REPLACE INTO building(building_id,building_count,city) 
values('
  ("604159",
    "634589"
   )',
   3,
'(Washington,
  Washington'
)
) 
```

如何每行生成一个 SQL 语句，如下所示：

```
INSERT OR REPLACE INTO building(building_id,building_count,city) values('604159',3,;Washington');
INSERT OR REPLACE INTO building(building_id,building_count,city) values('634589',3,;Washington'); 
```

等等

谢谢 ！

# jquery - 值无效时如何保持输入字段的焦点

> ID：13209667
> 
> 赞同：0
> 
> 时间：2012-11-03T13:33:18.503
> 
> 标签：jquery

我是 jQuery 的新手。我正在使用示例中说明的演示进行学习

[http://www.geektantra.com/projects/jquery-form-validate/advanced_demo/](http://www.geektantra.com/projects/jquery-form-validate/advanced_demo/)

应进行哪些更改以使焦点保持在尚未验证的输入字段中.....即，如果 I/P 字段不正确，则焦点应保留在该字段上，并且用户不应该能够移动到下一个字段，直到他正确输入了相关字段。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T14:23:18.103

TJ 克劳德说得对。

尽管如此，这可能是您正在寻找的：[http ://api.jquery.com/focus/](http://api.jquery.com/focus/)

# r - 降雪 sfApply() 比 apply() 慢

> ID：13209668
> 
> 赞同：1
> 
> 时间：2012-11-03T13:33:21.747
> 
> 标签：r, snowfall

我是 R 中的多核新手，正在尝试降雪包以测试是否可以加快应用功能。

不知道出了什么问题，但我的 sfApply() 的多核实现总是比 apply() 慢 2 倍

任何帮助是极大的赞赏！提前致谢。

单核示例 - 在我的 PC 中完成大约 1.3 秒：

```
x=2000
y=10000
startTime <- proc.time()

randomX <- sample(1:100,x*y, replace=T)/100+0.5
randomMatrix <- matrix(NA,x,y)
randomMatrix[,] <- randomX
randomRetX <- apply(randomMatrix,2,cumprod)

endTime <- proc.time()
endTime-startTime 
```

降雪实施 - 在我的 PC 中接近 3 秒：

```
library(snowfall)
sfInit( parallel=TRUE, cpus=4)
x=2000
y=10000

startTime <- proc.time()

randomX <- sample(1:100,x*y, replace=T)/100+0.5
randomMatrix <- matrix(NA,x,y)
randomMatrix[,] <- randomX
randomRetX <- sfApply(randomMatrix,2,cumprod)

endTime <- proc.time()

endTime-startTime
sfStop() 
```

# shell - line [: missing `]' 调试帮助请

> ID：13209669
> 
> 赞同：2
> 
> 时间：2012-11-03T13:33:24.393
> 
> 标签：shell

我已经将此脚本编写为安装 postgres 的模块，这是为了向用户显示数据库已创建并获取他/她的输入，以便他们看到数据库已创建。当我运行脚本时，我得到了错误

```
./dbtest: line 39: [: missing `]' 
```

我尝试在 yes 周围添加“”，在 yes 周围添加 ''，但我无法弄清楚缺少什么。脚本如下

```
#   
#
# Check to make sure the database was created and who is the owner
#
#
 if [ -f showdb ];

 then 
      cp showdb /home

 else
      echo " show database file is missing "

fi

if [ -f /home/showdb ];

 then
       su - postgres -c '/home/showdb'

       echo " Do you see the data name created listed above? "
       echo " "
       echo " Type yes or no (type out the whole word please) "
       echo " "
       read dbawr

            if [ $dbawr == yes && $dbawr == Yes ];

                then 

                     echo "Great!"
                     exit

                else
                     echo " Please contact tech support "
                     pause " Press [CTRL] [Z] to exit the program now " 
              fi

  else

         echo " File Missing!!"

fi 
```

我在这个脚本中缺少什么？

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-03T13:46:23.047

您不能使用`&&`带有单括号条件的布尔运算符`[ test = test ]`。如果您使用 bash（或类似的 shell），首选语法是使用双括号：

```
[[ this == this && that == that ]] 
```

如果你担心可移植性，那么你应该坚持使用单括号，但像这样使用它们：

```
[ this = this ] && [ that = that ] 
```

请注意，我没有使用双等号 ( `==`)。这也不符合posix。

# c# - 代码在每次属性调用时创建 cookie

> ID：13209670
> 
> 赞同：1
> 
> 时间：2012-11-03T13:33:43.457
> 
> 标签：c#, asp.net, debugging, session, cookies

我有一个网站，我想使用 cookie 为所有用户（甚至是匿名用户）存储用户记录。然后我可以跟踪他们的行为并向他们展示相关内容，即使他们回来了。

我目前调用用户的方式是使用以下代码。当我测试它时效果很好，但我可以在日志/数据库中看到，它有时会被垃圾邮件（同一个访问者有数百个匿名用户）。这段代码中可能会出现严重错误，所以我很快就得到了很多用户。

任何人都可以看到问题/解决方法吗？

```
 public SystemUser SystemUser
    {
        get
        {
            if(!HttpContext.Current.Request.Browser.Cookies)
            {
                logger.Info("Users browser did not allow cookies (crawler?)");
                return CreateEmptyUser();
            }
            var user = HttpContext.Current.Session[Constants.Sessions.LoginUser] as SystemUser;

            if(user == null)
            {
                logger.Info("User was null - first page visit");
                var httpCookie = HttpContext.Current.Request.Cookies[Constants.Cookies.AnonymousUser];
                if (httpCookie == null || httpCookie.Value == string.Empty)
                {
                    // totally new user - new anonymous user
                    var userFromId = SetupAnonymousUser();
                    logger.Info("We have a totally new visitor coming to our site. Userid: " + userFromId.UserId);
                }
                else
                {
                    logger.Info("User has been here before, as the anonymous user cookie wasn't null");

                    // anonymousUser - has been there before
                    var anonymousUser = httpCookie.Value;
                    int userid;
                    int.TryParse(anonymousUser, out userid);
                    if(userid > 0)
                    {
                        logger.Info("Getting user from id: " + userid);
                        var userFromId = UserManager.GetUser(userid);

                        if(userFromId != null)
                        {
                            HttpContext.Current.Session[Constants.Sessions.LoginUser] = userFromId;    
                        }
                        else
                        {
                            logger.Error("User has been here before, but couldnt find in database. Anonymous cookie deleted maybe?");
                            SetupAnonymousUser();
                        }

                    }
                    logger.Info("User has been there before: " + userid);
                }
            }
            var initializedUser =  HttpContext.Current.Session[Constants.Sessions.LoginUser] as SystemUser;

            if(initializedUser != null)
            {
                return initializedUser; 
            }
            else
            {
                logger.Info("Creating an empty user as initialized user was null");
                return CreateEmptyUser();
            }
        }
        set { HttpContext.Current.Session[Constants.Sessions.LoginUser] = value; }
    } 
```

还有我们的 SetupAnonymousUser()：

```
 private static SystemUser SetupAnonymousUser()
    {
        int userid = CreateAnonymousUser();

        var newCookie = new HttpCookie(Constants.Cookies.AnonymousUser)
                            {
                                Value = userid.ToString(),
                                Expires = DateTime.Now.AddDays(365)
                            };

        var userFromId = UserManager.GetUser(userid);
        HttpContext.Current.Session[Constants.Sessions.LoginUser] = userFromId;
        HttpContext.Current.Response.Cookies.Add(newCookie);
        return userFromId;
    } 
```

编辑：

这是出现问题的一些日志：

```
2012-11-04 13:58:40,298 [7] INFO  GKBusiness.Context.SystemContext [(null)] - User was null - first page visit
2012-11-04 13:58:40,313 [7] INFO  GKBusiness.Context.SystemContext [(null)] - Anonymous user created - with user id GKBusiness.Data.SystemUser
2012-11-04 13:58:40,313 [7] INFO  GKBusiness.Context.SystemContext [(null)] - We have a totally new visitor coming to our site. Userid: 4466
2012-11-04 13:58:40,391 [7] INFO  GKBusiness.Context.SystemContext [(null)] - User was null - first page visit
2012-11-04 13:58:40,391 [7] INFO  GKBusiness.Context.SystemContext [(null)] - Anonymous user created - with user id GKBusiness.Data.SystemUser
2012-11-04 13:58:40,391 [7] INFO  GKBusiness.Context.SystemContext [(null)] - We have a totally new visitor coming to our site. Userid: 4467 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T11:08:47.380

The code itself doesn't look flawed, but there are a few possibilities that might cause the problem you're facing (same user has multiple "anonymous user" entries).

To help pinpoint the problem I recommend adding some more `logger.Info` references in your code, more specifically when you get a cookie back from the user but for some reason it's malformed:

1.  When (userid <= 0)
2.  When userFromId == null
3.  When initializedUser == null

This way, when you're able to reproduce the problem you can check the logs and see what exactly is causing this problem.

I should also mention that since cookies can be modified by the client, you should consider using a [Guid](http://msdn.microsoft.com/en-us/library/system.guid.newguid.aspx) instead of a numeric UserId -this will make it harder for anyone who attempts to "impersonate" another user.

# java - 使用 Spring MVC 和 ajax 处理对象列表

> ID：13209673
> 
> 赞同：1
> 
> 时间：2012-11-03T13:34:23.937
> 
> 标签：java, javascript, jquery, ajax, spring-mvc

**使用 AJAX 和 spring MVC，如何从 Spring Controller 返回对象列表并使用 Jquery 显示它们。**

在下面发出 Ajax 请求：

```
$.ajax({
                    type: "POST",
                    url: "allUser.html",
                    dataType:'json',

                    data: "select=" + selectedCheckboxArray,
                    success: function(data){
                        var userListContent="";
                         var json =data.message;
                        $.each(json, function(i, obj) {

                            userListContent=userListContent+"<tr>";
                            userListContent=userListContent+"<td><input type='checkbox' value='"+obj.id+"'  id='select' name='select'/></td> ";
                            userListContent=userListContent+"<td id='NameColumn'>"+obj.firstName+" "+obj.lastName +"</td>";
                            userListContent=userListContent+"<td id='genderColumn'>"+ obj.gender +"</td>";
                            userListContent=userListContent+"<td id='userNameColumn'>"+ obj.userName +" </td>";
                            userListContent=userListContent+"<td id='userTypeColumn'> "+ obj.userType +"</td>";
                            userListContent=userListContent+"<td id='statusColumn'>"+ obj.status +"</td>";
                            userListContent=userListContent+"<td id='emailIdColumn'>"+ obj.emailId +"</td>";
                            userListContent=userListContent+"<td id='addressColumn'>"+ obj.address +"</td>";
                            userListContent=userListContent+"<td id='contactnoColumn'>"+ obj.contactNo +"</td>";
                            userListContent=userListContent+"</tr>";

                            });

                        $('#rounded-corner tbody').html(userListContent);

                        //console.log(userListContent);

                    },
                    error: function(e){

                    alert('Error: ' + e.responseText);
                    }
                    }); 
```

**MVC 控制器**

```
 @RequestMapping(value="/deleteUser",method= RequestMethod.POST)
     public @ResponseBody Map<String, Object> deleteUser(UserDetails user,HttpServletRequest request,HttpServletResponse response )throws ServletException,IOException
     {
         System.out.println("Ajax Request Received for delete User...............");
         Map<String, Object> model = new HashMap<String, Object>(); 

      JsonResponse js=new JsonResponse();
      js.setResult("pass");
      js.setStatus("active");
    // String operation=request.getParameter("operation");
     String[] selectedUserIdParameter = request.getParameterValues("select");
    System.out.println("Length:"+selectedUserIdParameter.length);
     /* Code Description:
      * Array "selectedUserIdParameter" above  has ID like {1,2,3,.....}, 
      * we need to use  array like {1 2 3 4 } without (,).so first we must convert.
      * Following code doing the same.
      * After Conversion Array  "selectedUserId" will have ID like {1 2 3 4 }
      * If You Know PHP explode()" function ,following is doing something like what explode() function does .
      */

     String msg="hello";
     List<UserDetails> usersList = userService.getAllUser();
     int no=usersList.size();
     System.out.println("Size:"+no);
     model.put("message", usersList);
     model.put("jso", js);

     return model;

 } 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-04T05:52:02.590

您将以 JSON 的形式接受和返回对象，因此在 spring dispatcher servlet xml 中添加 jackson mapper bean。杰克逊映射器做到了这一切。您无需手动进行映射或转换。

```
<beans:bean id="jacksonMessageChanger"  class="org.springframework.http.converter.json.MappingJacksonHttpMessageConverter">
    <beans:property name="supportedMediaTypes" value="application/json" />
</beans:bean>

<beans:bean class="org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter">
    <beans:property name="messageConverters">
        <util:list id="beanList">
            <beans:ref bean="jacksonMessageChanger" />
        </util:list>
    </beans:property>
</beans:bean> 
```

现在您的控制器将是这样的：

```
@RequestMapping(value = "/deleteUser", method = RequestMethod.POST)
public @ResponseBody
List<UserDetails> deleteUser(@RequestBody UserDetails userDetails) {
    // fetch the userid to be deleted from the userDetails
    // remebmer the id of user to be deleted will be set in the ajax call

    userService.deleteUser(userDetails.getUserId());

    // again populate the user list to display on page
    List<UserDetails> userList = userService.getAllUser();

    return userList;
} 
```

现在你的ajax调用将是这样的：

```
function deleteUser() {
    // set variables into javascript object which you need to send to spring controller
    // the variable name here should be same as it is in your java class UserDetails.java

    var user = new Object();
    user.userId = 120; // id of user to be deleted

    $.ajax({
        type : 'POST',
        url : '/${your project context path here}/deleteUser',
        dataType : 'json',
        data : JSON.stringify(user),
        contentType : 'application/json',
        success : function(data) {
           //here in data variable, you will get list of all users sent from 
           // spring controller in json format, currently its object
           // iterate it and show users on page

           showUsers(data);
        },
        error : function() {
            alert('error');
        }
    });
}

function showUsers(data) {
    // and here you show users on page
    //following code just example

    $('#allUsers').append("<option value='-1'>Select User</option>");
        for ( var i = 0, len = data.length; i < len; ++i) {
            var user = data[i];
            $('#allUsers').append("<option value=\"" + user.userId + "\">" + user.userName+ "</option>");
    }
} 
```

这将起作用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-03T16:08:10.707

直接返回 ArrayList 应该可以工作......

```
@RequestMapping(value="/deleteUser",method= RequestMethod.POST)
     public @ResponseBody ArrayList<UserDetails> deleteUser(UserDetails user,HttpServletRequest request,HttpServletResponse response )throws ServletException,IOException
     {
         System.out.println("Ajax Request Received for delete User...............");

    // String operation=request.getParameter("operation");
     String[] selectedUserIdParameter = request.getParameterValues("select");
    System.out.println("Length:"+selectedUserIdParameter.length);
     /* Code Description:
      * Array "selectedUserIdParameter" above  has ID like {1,2,3,.....}, 
      * we need to use  array like {1 2 3 4 } without (,).so first we must convert.
      * Following code doing the same.
      * After Conversion Array  "selectedUserId" will have ID like {1 2 3 4 }
      * If You Know PHP explode()" function ,following is doing something like what explode() function does .
      */

     String msg="hello";
     List<UserDetails> usersList = userService.getAllUser();
     int no=usersList.size();
     System.out.println("Size:"+no);

     return usersList;

 } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-28T06:54:59.917

现在可能为时已晚，但只是为了向您展示如何使用 jQuery Ajax 通过 spring 调用动作，我在这里提供了我在项目中所做的一切：（Ajax 调用用于用户验证）

**将 Ajax 函数写入 *.js 文件：**

```
function validateUserBeforeCreatingUser(email){ 
    var url='validateUser.htm?'&email='+email;
    $.ajax({
        url: url,
        cache: false,
        success: function(response){
            $("#errors").html(jQuery.trim(response));
            //if errors not present
            if(jQuery.trim(response)==''){
                createUser();
            }
        },
        error: function(response){
        }
    });
} 
```

这是我**在控制器中**编写的**操作**：（我创建了**errors.jsp**页面来呈现错误）

 ****```
public ModelAndView validateUser(HttpServletRequest request,
        HttpServletResponse response) throws Exception {

    /* write code to validate user, 
                 if user with specified email not found 
                      then create error 
                 else
                     keep errors page blank
            */                

    return new ModelAndView("partial", "errors", errors);
} 
```

希望这可以为您提供答案，并为缩进感到抱歉，我做不到 :-(****

# entity-framework - 是否可以在一个表格列中保留许多关系？

> ID：13209676
> 
> 赞同：1
> 
> 时间：2012-11-03T13:35:05.790
> 
> 标签：entity-framework, entity-relationship

我首先使用实体​​框架代码，但我遇到了问题，因为 EF`Event`使用两个引用键创建表，一个用于 class `ObjectOne`，另一个用于 class `ObjectTwo`。

是否可以将 Id 的值保留在一列中`Event.ObjectId`并保留属性中的关系类型`Event.Type`？

我可以进行以下映射（其中我只有一列用于 FK）。是否可以不在数据库中创建 FK，因为现在我必须添加`ObjectOne`表和`ObjectTwo`表中存在的值，这对我来说不是解决方案）：

```
 modelBuilder.Entity<ObjectOne>()
            .HasMany(c => c.Events).WithOptional().HasForeignKey(x => x.ObjectId);
        modelBuilder.Entity<ObjectTwo>()
            .HasMany(c => c.Events).WithOptional().HasForeignKey(x => x.ObjectId); 
```

示例类：

```
 public class ObjectOne
{
    public int ObjectOneId { get; set; }
    public ICollection<Event> Events { get; set; }
}

public class ObjectTwo
{
    public int ObjectTwoId { get; set; }
    public ICollection<Event> Events { get; set; }
}

public class Event
{
    public int EventId { get; set; }
    public int ObjectId { get; set; }
    public string Type { get; set; }
}

public class AddEvent : Event
{
}

public class Updated : Event
{
} 
```

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-03T18:22:52.310

这种*多态关联*通常被认为是一种反模式，请参阅 Bill Karwin 的[SQL](http://pragprog.com/book/bksqla/sql-antipatterns) Antipatterns 。但是，在某些情况下，它们可能会变得不可避免（或者过于实际而无法保持清教徒状态）。如果您仍然想使用它们，Bill Karwin 很乐意推荐一个实现。您应该阅读本书以了解所有细节，但问题的核心是这张图：

![](../Images/7f54b2a936466672cb3c3a0684c8f493.png)

（其中 Comment 具有您的 Event 表的作用，不要与图中的 Event 表混淆！！）。

`Event`在基表中，收集了与之关联的表的所有主键。

With Entity Framework another approach is possible (although not really feasible with the number of tables you wish to accommodate): you can subclass `Event` in `OneEvent`, `TwoEvent` etc., where `Type` is the discriminator, and associate `ObjectOne` with `OneEvent`s, `ObjectTwo` with `TwoEvent`s, etc.

# jquery - jQuery.getJSON 出现奇怪的语法错误

> ID：13209685
> 
> 赞同：0
> 
> 时间：2012-11-03T13:35:54.943
> 
> 标签：jquery, json, syntax

我有一个用于测试的 JSON 文件，如下所示：

```
[
    "http://lorempixel.com/g/1000/1000/fashion/",
    "http://lorempixel.com/g/1000/1000/nature/",
    "http://lorempixel.com/g/1000/1000/sports/",
    "http://lorempixel.com/g/1000/1000/technics/",
    "http://lorempixel.com/g/1000/1000/abstract/",
    "http://lorempixel.com/g/1000/1000/city/"
] 
```

据我所知，这应该代表一个字符串数组。

当我现在尝试加载这个数组时：

```
$.getJSON(fileURL, function(json) {myFunction(json)}); 
```

我第一次收到语法错误`[`。当我使用 JSON 对象尝试此操作时，它显示“格式不正确”。

我做错了吗？

**编辑**

现在整个相关代码是：

```
$('#input-button').click(function(){
    var url = $('#input-input').val();
    var json = $.getJSON(url);
    alert(json[0]);
}); 
```

从. `url`_ `<input>`URL 是正确的（“input.json”，而 JSON 和 HTML 在同一目录中），我检查了它。JSON 文件看起来与上面完全相同，并在评论中链接。

**编辑2**

当我尝试：

```
$.getJSON(
   "input.json",
   function(json) {
      alert(json[0]);
}); 
```

我得到了我的字符串，但也得到了错误。

**编辑3**

我相信这是一个浏览器/操作系统问题，现在。我在画布上下文中遇到了与 getImageData() 类似的问题，它在其他计算机上运行良好，但在我的计算机上运行良好......

# c - openMP：为什么当我使用“#pragma omp parallel num_threads(4)”时没有得到不同的线程 ID

> ID：13209686
> 
> 赞同：14
> 
> 时间：2012-11-03T13:35:56.740
> 
> 标签：c, multithreading, parallel-processing, openmp

为什么我在使用“#pragma omp parallel num_threads(4)”时没有得到不同的线程 ID。在这种情况下，所有线程 id 都是 0。但是当我评论该行并使用默认线程数时，我得到了不同的线程 ID。注意：- 变量我使用变量 tid 来获取线程 ID。

```
#include <omp.h>
#include <stdio.h>
#include <stdlib.h>

int main (int argc, char *argv[]) 
{
int nthreads, tid;
int x = 0;

#pragma omp parallel num_threads(4)
#pragma omp parallel private(nthreads, tid)
  {
  /* Obtain thread number */
 tid = omp_get_thread_num();
  printf("Hello World from thread = %d\n", tid);

  // /* Only master thread does this */
   if (tid == 0) 
     {
     nthreads = omp_get_num_threads();
     printf("Number of threads = %d\n", nthreads);
     }

  }

} 
```

上述代码的输出：-

```
Hello World from thread = 0
Hello World from thread = 0
Number of threads = 1
Hello World from thread = 0
Number of threads = 1
Hello World from thread = 0
Number of threads = 1
Number of threads = 1 
```

当我评论上述行时输出：-

```
Hello World from thread = 3
Hello World from thread = 0
Number of threads = 4
Hello World from thread = 1
Hello World from thread = 2 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-11-03T14:18:52.813

您正在创建两个嵌套的并行区域。这和这样做是一样的：

```
#pragma omp parallel num_threads(4)
{
  #pragma omp parallel private(nthreads, tid)
  {
    /* Obtain thread number */
    tid = omp_get_thread_num();
    printf("Hello World from thread = %d\n", tid);

    // /* Only master thread does this */
    if (tid == 0) 
    {
      nthreads = omp_get_num_threads();
      printf("Number of threads = %d\n", nthreads);
    }
  }
} 
```

`omp_get_num_threads()`返回最内层区域的线程数。所以你正在执行四个线程，每个线程都在执行一个线程。

内部并行区域只执行一个线程，因为您没有启用嵌套并行。您可以通过调用来启用它`omp_set_nested(1)`。

[http://docs.oracle.com/cd/E19205-01/819-5270/aewbi/index.html](http://docs.oracle.com/cd/E19205-01/819-5270/aewbi/index.html)

如果您想创建一个并行区域并指定两个属性，而不是创建两个嵌套的并行区域，则可以这样做：

```
#pragma omp parallel num_threads(4) private(nthreads,tid)
{
  .
  .
  .
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-07-19T22:40:31.977

也可以通过将环境变量 OMP_NESTED 设置为 true 来启用嵌套

# c# - C# 中的静态方法、静态字段和多标题

> ID：13209691
> 
> 赞同：4
> 
> 时间：2012-11-03T13:36:11.967
> 
> 标签：c#, .net, multithreading

我有 1 个静态类和 1 个字段以及其中的 2 个方法：

```
 static class MyClass{

       private static HttpClient client = new HttpClient();
       private static string SendRequestToServer(int id)
       {
          Task<HttpResponseMessage> response = client.GetAsync("some string");
          responseTask.ContinueWith(x => PrintResult(x));
          return "some new value";
        }

        private static void Print(Task<HttpResponseMessage> task)
        {
            Task<string> r = task.Result.Content.ReadAsStringAsync();
            r.ContinueWith(resultTask => Console.WriteLine("result is: " + resultTask.Result));
        }
 } 
```

问题是，如果很多线程开始使用`MyClass`及其方法，会不会引起一些问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T13:50:59.723

通过这些方法访问的所有资源都需要是线程安全的。在你的情况下，他们不是。如果您查看[HttpClient](http://msdn.microsoft.com/en-us/library/system.net.http.httpclient.aspx)文档，它会指出：

> 此类型的任何公共静态（在 Visual Basic 中为 Shared）成员都是线程安全的。**不保证任何实例成员都是线程安全**的。

您正在调用实例方法 ( `client.GetAsync`)，但不能保证它是线程安全的，因此可能会给您带来问题。

为了减轻这种情况，您可以：

*   `HttpClient`在每次通话时创建一个新的（本地） 。
*   同步访问`client`（例如使用锁）。

另外，我不能告诉你是否`PrintResult`会是线程安全的，但`Console.WriteLine`应该是线程安全的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T13:59:33.093

您可能会期望使用这种设置产生不可预知的结果。您需要让线程以同步的方式访问数据。在您的情况下需要使用[锁定](http://msdn.microsoft.com/en-us/library/c5kehkcz.aspx)语句来确保执行以同步和稳定的方式发生。

```
private static Object locker= new Object();

private static string SendRequestToServer(int id)
{ 
  lock(locker)
  {
    Task<HttpResponseMessage> response = client.GetAsync("some string");
    responseTask.ContinueWith(x => PrintResult(x));
    return "some new value";
  }
} 
```

# wpf - 为什么 AdornerLayers 总是最顶层？有没有办法改变它？

> ID：13209695
> 
> 赞同：4
> 
> 时间：2012-11-03T13:36:48.260
> 
> 标签：wpf, adorner, visual-tree, adornerlayer, adornerdecorator

1.  为什么装饰层总是呈现为应用程序中的最顶层（在 AdornerDecorator 下 - 参考屏幕截图）？
2.  有没有办法改变可以绘制装饰器的图层/级别？

在下面的屏幕截图中，AdornerLayer 被添加到 AdornerDecorator 并且 Adorner (MyAdorner) 被添加到这个 AdornerLayer。但是 AdornerLayer 是这样检索的，

```
 AdornerLayer layer1 = AdornerLayer.GetAdornerLayer(button1);
        layer1.Add(new MyAdorner(button1)); 
```

![AdornerLayer - 大纲](../Images/80cafee3f788d3c53fe4278ed6705c00.png)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-03T16:36:11.037

回答我的第二个问题，

> 有没有办法改变可以绘制装饰器的图层/级别？

我想我找到了解决办法。只需在需要渲染装饰器的级别周围放置一个 AdornerDecorator 元素。任何需要装饰层的控件都将使用此 AdornerDecorator 元素来放置其装饰器。

在这里，我使用以下代码片段将装饰器移动到了不同的级别。

```
<Window x:Class="CustomAdornerLayer.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="MainWindow" Height="350" Width="525" Loaded="Window_Loaded">
<Grid>
    <StackPanel Background="Yellow" Width="Auto">
        <Button>Button3</Button>
    </StackPanel>
    <AdornerDecorator>
        <Grid>
            <AdornerDecorator>
                <Button x:Name="button1" Margin="70,73,265,158">Button1</Button>
            </AdornerDecorator>
            <AdornerDecorator>
                <Button x:Name="button2" Margin="87,51,248,180">Button2</Button>
            </AdornerDecorator>
        </Grid>
    </AdornerDecorator>
</Grid> 
```

虽然仍然以同样的方式查询 AdornerLayer，

```
 AdornerLayer layer1 = AdornerLayer.GetAdornerLayer(button1);
        layer1.Add(new MyAdorner(button1));
        AdornerLayer layer2 = AdornerLayer.GetAdornerLayer(button2);
        layer2.Add(new MyAdorner(button2)); 
```

![装饰层 - 定制](../Images/ccbd34a1cf71bbc1bd18852d2a772052.png)

如果我错了，请纠正我。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-03T13:44:57.250

Adorner 层由 AdornerDecorator 提供。当您请求给定控件的层时，wpf 会查找 AdornerDecorator 上部可视化树。为什么你需要改变这个逻辑？Adorners 系统故意以这种方式使装饰物出现在装饰元素之上。

您可以使用 VisualTreeHelper 自己搜索 AdornerDecorator

# mysql - 如何从 MySQL 中找到最近的一周和一个月

> ID：13209696
> 
> 赞同：0
> 
> 时间：2012-11-03T13:36:51.647
> 
> 标签：mysql

[此演示](http://sqlfiddle.com/#!2/16955/2)按月显示。[这个演示](http://sqlfiddle.com/#!2/16955/1)按周显示。但是我想显示

Q1：每个学生只有这周。

Q2：每个学生仅限本月。

Q3：每个学生的最后一周。

Q4：每个学生只有最后一个月。

我怎样才能做到这一点？

```
CREATE TABLE `hw_homework` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `studentid` int(10) NOT NULL,
  `subjectid` int(10) NOT NULL,
  `assignment_name` varchar(255) COLLATE utf8_unicode_ci NOT NULL,
  `teacherid` int(10) NOT NULL,
  `date` datetime NOT NULL,
  PRIMARY KEY (`id`)
) ;

INSERT INTO `hw_homework` (`id`, `studentid`, `subjectid`, `assignment_name`, `teacherid`, `date`) VALUES
(1, 29, 5, '5E', 20, '2012-10-31 13:58:40'),
(2, 15, 5, '32B', 20, '2012-10-31 13:59:54'),
(3, 29, 4, 'Q2A', 20, '2012-10-30 17:53:46'),
(4, 29, 11, '6E', 20, '2012-10-02 20:06:39'),
(5, 29, 11, 'C15', 20, '2012-10-16 20:06:30'),
(6, 15, 11, '7A', 20, '2012-09-19 20:08:05'),
(7, 29, 5, '3B', 20, '2012-09-14 20:08:12'),
(8, 29, 13, '6E', 32, '2012-10-29 20:23:46'),
(9, 29, 11, '7E', 18, '2012-10-30 14:35:14'),
(10, 2, 5, '5E', 20, '2012-10-21 13:58:40'),
(11, 2, 5, '5E', 20, '2012-10-30 13:58:40'),
(12, 2, 5, '5E', 20, '2012-10-31 13:58:40'); 
```

按月

```
SELECT  studentID, 
        DATE_FORMAT(`date`, '%M') `month`,
        COUNT(studentID) totalMissed
FROM hw_homework
-- WHERE studentID = ''
GROUP BY studentID, DATE_FORMAT(`date`, '%M') 
```

按周

```
SELECT  studentID, 
        DATE_FORMAT(`date`, '%U') `WeekNo`,
        COUNT(studentID) totalMissed
FROM hw_homework
-- WHERE studentID = ''
GROUP BY studentID, DATE_FORMAT(`date`, '%U') 
```

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T14:55:42.260

**A1**：

```
SELECT  studentID, 
        DATE_FORMAT(`date`, '%U') `WeekNo`,
        COUNT(studentID) totalMissed
FROM hw_homework
WHERE DATE_FORMAT(`date`, '%U') = DATE_FORMAT(NOW(), '%U')
-- AND studentID = ''
GROUP BY studentID, DATE_FORMAT(`date`, '%U') 
```

**A2**：

```
SELECT  studentID, 
        DATE_FORMAT(`date`, '%M') `WeekNo`,
        COUNT(studentID) totalMissed
FROM hw_homework
WHERE DATE_FORMAT(`date`, '%M') = DATE_FORMAT(NOW(), '%M')
-- AND studentID = ''
GROUP BY studentID, DATE_FORMAT(`date`, '%M') 
```

**A3**：

```
SELECT  studentID, 
        DATE_FORMAT(`date`, '%U') `WeekNo`,
        COUNT(studentID) totalMissed
FROM hw_homework he
WHERE DATE_FORMAT(`date`, '%U') = (SELECT MAX(DATE_FORMAT(NOW(), '%U')) FROM hw_homework hi WHERE hi.studentID = he.studentID)
-- AND studentID = ''
GROUP BY studentID, DATE_FORMAT(`date`, '%U') 
```

**A4**：

```
SELECT  studentID, 
        DATE_FORMAT(`date`, '%M') `WeekNo`,
        COUNT(studentID) totalMissed
FROM hw_homework he
WHERE DATE_FORMAT(`date`, '%M') = (SELECT MAX(DATE_FORMAT(NOW(), '%M')) FROM hw_homework hi WHERE hi.studentID = he.studentID)
-- AND studentID = ''
GROUP BY studentID, DATE_FORMAT(`date`, '%M') 
```

# mysql - 什么时候在mysql中使用外键

> ID：13209701
> 
> 赞同：0
> 
> 时间：2012-11-03T13:37:22.570
> 
> 标签：mysql, rdbms, foreign-key-relationship

我目前正在构建一个数据库，但不确定何时在表上使用外键。大多数表用于事务、日志记录和历史记录。

在哪些表中放置外键是否有一般规则？我有这张表用于特定交易的一般细节，然后是另一个表用于特定细节。我应该在桌子上放一个外键以获取具体细节吗？

还有一个用于存储用户信息的表和另一个用于记录用户活动的表。我还应该在记录用户活动的表中放置一个外键吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-03T13:39:45.330

如果两个表之间存在关系，则应始终使用外键约束强制执行该关系。

我防止逻辑上“损坏”的数据（例如，实际不存在的事务的详细信息）并且 - 同样重要的是 - 它*记录*了您的数据库模型。

# xml - 制作唯一 XSD 元素时出错

> ID：13209706
> 
> 赞同：0
> 
> 时间：2012-11-03T13:37:43.777
> 
> 标签：xml, xsd, unique, categories

我为基于餐厅的系统制作了一个小的 xsd/xml 文件。

这是我的 XSD 文件的代码：

```
<xs:element name="table_cat">
    <xs:complexType>
      <xs:sequence>
        <xs:element name="category" maxOccurs="unbounded">
          <xs:complexType>
            <xs:sequence maxOccurs="unbounded">
              <xs:element name="category_id" type="CatID" />
              <xs:element name="catdescription" type="Length50"/>
            </xs:sequence>
          </xs:complexType>
        </xs:element>
      </xs:sequence>
    </xs:complexType>

    <xs:unique name="unique-catid">
      <xs:selector xpath="category" />
      <xs:field xpath="category_id"/>

    </xs:unique>

  </xs:element> 
```

但每当我在 XML 文件中有超过 1 个 Category_ID 字段时，我都会收到以下错误：

```
The field 'category_id' is expecting at the most one value. 
```

我尝试了不同的解决方案来使其工作，但似乎没有任何工作。

希望你能帮忙谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T20:15:57.490

您实际上并没有说出您要表达的约束 - 很难从不正确的代码中逆向工程您的需求。

无论如何，它给我的印象是一个糟糕的设计：你有一个重复的 (id, description) 对序列，而这对周围没有容器元素。这将使处理数据变得不必要地困难。

也许你想要

```
<xs:unique name="unique-catid">
  <xs:selector xpath="category_id" />
  <xs:field xpath="."/>
</xs:unique> 
```

但我无法确定这是否是你的意图。

# html - 浮动的混乱。为什么在第二个元素上设置宽度会影响浮动？

> ID：13209707
> 
> 赞同：2
> 
> 时间：2012-11-03T13:37:50.477
> 
> 标签：html, css, css-float

我有这个 HTML：

```
<div class = "block1">hi</div>
<div class = "block2">hi</div> 
```

在一种情况下，我有这个 CSS：

```
.block1 {
    width:100px;
    border:1px solid;
    float: left;
}

.block2 {
    width:100px;
    border:1px solid;
} 
```

这使得：

[提琴手](http://jsfiddle.net/MrNYR/1/)

第二种情况，我有这个 CSS：

```
.block1 {
    width:100px;
    border:1px solid;
    float: left;
}

.block2 {
    border:1px solid;
} 
```

这使得：

[提琴手](http://jsfiddle.net/b8QRe/12/)

为什么设置宽度会使第二个 div 不与第一个 div 并排？如果我希望第二个 div 并排并有 100px 怎么办？如果我设置 float:left; 它会这样做，但为什么呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-03T13:40:03.377

因为如果你指定一个宽度到你的第二个`div`你需要使用`float: left;`它，因为它`div`是一个块级元素，如果你不指定一个宽度，它会占用剩余的可用空间，如果你定义一个宽度，它会如果空间可用，则在其他浮动 div 之外浮动，为了使其正确浮动，您需要使用`float: right`

[**演示**](http://jsfiddle.net/b8QRe/1/)

编辑：更好的理解...

如果不定义宽度

```
------------------------------------------
               total space                     Legend (/ - empty space)

------------- Example 1 ----------------
div1(floated left) ///////////////////////
                   ^---------------------^
                     This space will be taken 
                by the div which is without width
------------- Example 2 ----------------
div1(floated left)
div2(same size as 1 wont float unless you give float: left;)

 ------------- Example 3 ----------------
 div1(floated left) div2(besides div 1 if widths are different without giving float left)
------------------------------------------ 
```

正如您所说，如果您指定宽度，它应该向左浮动，它与`div2`您给`div1` [Reference](http://w3.org/TR/CSS2/visuren.html#block-formatting)的宽度相同，因此如果您更改说`150px`第二个 div 它将起作用...[演示](http://jsfiddle.net/b8QRe/13/)

但是，如果您在浮动第二个 div 之前清除浮动，它不会使 div 除了其他 1 浮动，请参阅此[示例](http://jsfiddle.net/b8QRe/2/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T13:56:37.400

**Float**是一个 CSS 定位属性。

在第一个块中，您定义了向左浮动但没有关闭浮动。为此，您需要使用`clear:both;`

查看您的更新结果：

[左右浮动之间的差异](http://jsfiddle.net/b8QRe/10/)

[jsFiddleWithClearingFloat](http://jsfiddle.net/MrNYR/2/)

# utf-8 - UTF8 - 仍然显示奇怪的字符？

> ID：13209714
> 
> 赞同：1
> 
> 时间：2012-11-03T13:39:11.023
> 
> 标签：utf-8, character-encoding

我的网页的响应标题显示：

```
Content-Type:text/html; charset=UTF-8 
```

但是，对于像`é`. 我到底应该怎么做？设置 UTF-8 的是我的 .htaccess。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T13:42:35.453

如果是脚本或 HTML 文件，请检查文件本身的编码，应保存为 UTF-8。

在 Zend 中，它类似于：`Edit->Set encoding->Other: UTF-8,`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T13:44:02.657

如果您提供 HTML 页面，则需要在 HTML 文件中指明内容为 UTF-8。您可以通过在标题部分添加元 html 标记来做到这一点：

```
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"> 
```

# android - 导航栏上的主页按钮不起作用

> ID：13209724
> 
> 赞同：1
> 
> 时间：2012-11-03T13:40:21.540
> 
> 标签：android

有人知道，为什么我不能使用导航栏左上角的主页按钮？：

![我的 AVD 截图](../Images/4a87b59def0d5bed9949f7ac68996ccf.png)

我在互联网上搜索了很多，但不幸的是我找不到任何东西。

似乎Android不知道这是一个按钮，因为当我按下ist时没有调用方法“onOptionsItemSelected（MenuItem item）”。

我在右上角的图标工作得很好。

我使用安卓 4.0.3

请帮忙

亲切的问候克里斯

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-03T13:58:35.680

调用`setHomeButtonEnabled(true)`您`ActionBar`以启用该按钮被单击。

# android - Android jni读取路径相同，但不一样

> ID：13209728
> 
> 赞同：1
> 
> 时间：2012-11-03T13:41:40.113
> 
> 标签：android, java-native-interface

```
static void setIntField(JNIEnv* env, jobject obj, const char* path,
                        jfieldID fieldID) {
    const int SIZE = 128;
    char buf[SIZE] = "\0";
    jint value = 0;
    if (readFromFile(path, buf, SIZE) > 0) {
        value = atoi(buf);
    }
    env->SetIntField(obj, fieldID, value);
}

static int readFromFile(const char* path, char* buf, size_t size) {
    if (!path)
        return -1;
    int fd = open(path, O_RDONLY, 0);
    if (fd == -1) {
        LOGE("Could not open '%s'", path);
        return -1;
    }

    size_t count = read(fd, buf, size);
    if (count > 0) {
        count = (count < size) ? count : size - 1;
        while (count > 0 && buf[count - 1] == '\n')
            count--;
        buf[count] = '\0';
    } else {
        buf[0] = '\0';
    }

    close(fd);
    return count;
} 
```

这是我的 Android JNI 代码。为什么我读取的路径相同，但是两次的值不一样。我正在阅读这条路径`/sys/devices/system/cpu/cpu0/cpufreq/scaling_min_freq`。

如何解决？

`scaling_min_freq`值是51000。第一次得到51000。第二次得到150000。

# f# - 如果目标是 x64，为什么 Seq.iter 比 for 循环快 2 倍？

> ID：13209729
> 
> 赞同：10
> 
> 时间：2012-11-03T13:41:42.783
> 
> 标签：f#

声明：这是微基准，如果您对该主题感到不满意，请不要评论诸如“过早优化是邪恶的”之类的引用。

示例是针对 x64 的版本、.Net4.5 Visual Studio 2012 F# 3.0 并在 windows 7 x64 中运行

在分析之后，我缩小了我的一个应用程序的瓶颈，所以我想提出这个问题：

### 观察

`for in`如果循环或内没有循环`Seq.iter`，则很明显它们的速度相似。（更新 2 与更新 4）

`for in`如果循环或内部有一个循环`Seq.iter`，它似乎`Seq.iter`是 2 倍快`for in`。（更新与更新3）奇怪吗？（如果在 fsi 中运行，它们将是相似的）

如果是针对anycpu，运行在x64，时间上没有区别。所以问题变成了：**如果目标是 x64，Seq.iter (update3) 将提高 2 倍速度**

### 用的时间：

```
update:   00:00:11.4250483 // 2x as much as update3, why?
updatae2: 00:00:01.4447233
updatae3: 00:00:06.0863791
updatae4: 00:00:01.4939535 
```

### 源代码：

```
open System.Diagnostics
open System

[<EntryPoint>]
let main argv = 
    let pool = seq {1 .. 1000000}

    let ret = Array.zeroCreate 100

    let update pool =
        for x in pool do
            for y in 1 .. 200 do
                ret.[2] <- x + y

    let update2 pool =
        for x in pool do
            //for y in 1 .. 100 do
                ret.[2] <- x

    let update3 pool =
        pool
            |> Seq.iter (fun x ->
                                  for y in 1 .. 200 do
                                      ret.[2] <- x + y)

    let update4 pool =
        pool
            |> Seq.iter (fun x ->
                                  //for y in 1 .. 100 do
                                      ret.[2] <- x)

    let test n =
        let run = match n with
                  | 1 -> update
                  | 2 -> update2
                  | 3 -> update3
                  | 4 -> update4
        for i in 1 .. 50 do
            run pool

    let sw = new Stopwatch()
    sw.Start()
    test(1)
    sw.Stop()
    Console.WriteLine(sw.Elapsed);

    sw.Restart()
    test(2)
    sw.Stop()
    Console.WriteLine(sw.Elapsed)

    sw.Restart()
    test(3)
    sw.Stop()
    Console.WriteLine(sw.Elapsed)

    sw.Restart()
    test(4)
    sw.Stop()
    Console.WriteLine(sw.Elapsed)
    0 // return an integer exit code 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-07T16:04:23.193

*这不是一个完整的答案，但希望它可以帮助您走得更远。*

我可以使用相同的配置重现该行为。这是一个更简单的分析示例：

```
open System

let test1() =
    let ret = Array.zeroCreate 100
    let pool = {1 .. 1000000}    
    for x in pool do
        for _ in 1..50 do
            for y in 1..200 do
                ret.[2] <- x + y

let test2() =
    let ret = Array.zeroCreate 100
    let pool = {1 .. 1000000}    
    Seq.iter (fun x -> 
        for _ in 1..50 do
            for y in 1..200 do
                ret.[2] <- x + y) pool

let time f =
    let sw = new Diagnostics.Stopwatch()
    sw.Start()
    let result = f() 
    sw.Stop()
    Console.WriteLine(sw.Elapsed)
    result

[<EntryPoint>]
let main argv =
    time test1
    time test2
    0 
```

在这个例子中，`Seq.iter`and被执行了一次，但是and`for x in pool`之间仍然有 2 倍的时间差：`test1``test2`

```
00:00:06.9264843
00:00:03.6834886 
```

它们的 IL 非常相似，因此编译器优化不是问题。x64 抖动似乎无法优化，`test1`尽管它可以使用`test2`. 有趣的是，如果我将嵌套的 for 循环重构`test1`为一个函数，JIT 优化会再次成功：

```
let body (ret: _ []) x =
    for _ in 1..50 do
        for y in 1..200 do
            ret.[2] <- x + y

let test3() =
    let ret = Array.zeroCreate 100
    let pool = {1..1000000}    
    for x in pool do
        body ret x

// 00:00:03.7012302 
```

[当我使用此处描述](https://stackoverflow.com/questions/279582/switching-off-the-net-jit-compiler-optimisations)的技术禁用 JIT 优化时，这些函数的执行时间是相当的。

为什么 x64 抖动在特定示例中失败，我不知道。您可以[反汇编优化的 jitter 代码](http://blogs.msdn.com/b/vancem/archive/2006/02/20/535807.aspx)以逐行比较 ASM 指令。也许具有良好 ASM 知识的人可以发现它们的差异。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T12:48:36.803

当我在我的机器上运行实验时（在发布模式下使用 VS 2012 中的 F# 3.0），我没有得到你描述的时间。当您重复运行它时，您是否始终得到相同的数字？

我尝试了大约 4 次，我总是得到非常相似的数字。的版本`Seq.iter`往往会稍微快一些，但这可能在统计上并不显着。类似（使用`Stopwatch`）：

```
test(1) = 15321ms
test(2) = 5149ms
test(3) = 14290ms
test(4) = 4999ms 
```

我正在使用 64 位 Windows 7 的带有 Intel Core2 Duo (2.26Ghz) 的笔记本电脑上运行测试。

# mysql - 在 Ruby on Rails 中设置关联

> ID：13209733
> 
> 赞同：0
> 
> 时间：2012-11-03T13:42:41.060
> 
> 标签：mysql, ruby-on-rails, activerecord

我在 ruby​​ 中使用迁移来创建这些表和模型。

我有一个表信息和一个表详细信息，信息表中的每个条目在详细信息表中可以有一个关联。

所以我创建了它们：

```
create_table :details do |t|
      t.integer :id
      t.string :Bezeichnung
      t.binary :Koordinaten
    end

 create_table :informations do |t|
      t.integer :id
      t.integer :DetailID
      t.integer :Longitude
      t.integer :Latitude
    end 
```

在我的信息表中，我得到了一个 DetailID，它应该引用 Detail 表的 id。

现在我做了：

```
ALTER TABLE informations
      ADD CONSTRAINT fk_informations_details
      FOREIGN KEY (DetailID)
      REFERENCES details(id) 
```

它是否正确？我是否正确设置了 FOREIGN KEY？还是我必须将外键放在另一个表中！？

因为我想在我的信息模型中使用以下：

```
has_one :detail, :foreign_key => 'DetailID' 
```

在详细模型中：

```
belongs_to :main 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T14:00:48.670

一些注意事项：

1.  使用迁移对数据库执行各种更改，切勿手动进行。
2.  尽可能使用 Ruby on Rails 命名约定。这意味着使用`detail_id`而不是`DetailID`
3.  你的联想是错误的。

如果，Ruby on Rails 将在表中`Information has_one :detail`查找具有匹配项的实体。`information_id``details`

在您的模型中，情况正好相反 -`Information`包含一个`detail_id`. 换句话说，Ruby on Rails 会将其指定为`Information belongs_to :detail`and `Detail has_one :information`。

# php - PHP 错误：警告：ociparse() 参数 1 是资源

> ID：13209734
> 
> 赞同：4
> 
> 时间：2012-11-03T13:43:34.583
> 
> 标签：php, oracle, oracle-call-interface

由于 oracle 中没有现成的功能来验证这样创建的查询。所以我尝试了下面的代码来检查 QUERY 是否有效。

```
if(isset($_POST['btn_Submit_Query']))
            {
                $check_query=$_POST['txtQuery'];
                echo $check_query;
                $valid = false;
                $stmt = oci_parse($DB, $check_query);
                echo "Statement" . $stmt;
                //oci_define_by_name($stmt, 'NUMBER_OF_ROWS', $number_of_rows);
                oci_execute($stmt, OCI_DEFAULT);
                echo oci_num_rows($stmt);
            } 
```

我在执行中收到以下警告：

```
Warning: oci_parse() expects parameter 1 to be resource, object given in D:\xampp\htdocs\app\DashBoardSite\Admin\querybuilder.php on line 899
Statement
Warning: oci_execute() expects parameter 1 to be resource, null given in D:\xampp\htdocs\app\DashBoardSite\Admin\querybuilder.php on line 902

Warning: oci_num_rows() expects parameter 1 to be resource, null given in D:\xampp\htdocs\app\DashBoardSite\Admin\querybuilder.php on line 903 
```

我的错误在哪里？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T13:56:11.910

您必须首先连接到数据库。此连接必须是变量 $DB 的“资源”。

# c# - 继承 - 根据子值在初始化时更改变量

> ID：13209742
> 
> 赞同：0
> 
> 时间：2012-11-03T13:44:45.467
> 
> 标签：c#, inheritance, xna

我有一个基类：

```
class Tile{} 
```

很少有其他延伸瓷砖的

```
class Free : Tile{}
class Wall : Tile{} 
```

每个图块都有自己的纹理，它不是字符串，而是必须在初始化时加载的 Texture2D。我想代码看起来与此类似，但我不确定如何正确创建它：

```
class Tile{
    static Texture2D texture; //Static will use less ram because it will be same for inherited class?
    static string texture_path; //This is set by inherited class
    public Tile(){
        if(texture==null)
            texture = LoadTexture(texture_path);
    }
}

class Free : Tile{
    static string texture_path = "Content/wall.png";
} 
```

换句话说，所有免费瓷砖都有相同的纹理，所有墙瓷砖都有相同的纹理——这就是我认为我应该使用静态的原因。

如何正确执行此操作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T14:09:39.497

如果您希望您的基类能够访问 texture_path，您应该在您的基类中声明它。

基类对其子类中声明的字段、属性或方法一无所知。顺便说一句，这是设计使然...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T14:38:16.490

您需要做的是在基类中声明该属性并为子类提供覆盖它的选项。如果您愿意，这将允许您还提供默认值。

像这样的一些事情：

```
public class Tile
{
    private string _texturePath = String.Empty;
    private Texture2D _texture;
    protected virtual string TexturePath { private get { return _texturePath; } set { _texturePath = value; } }

    public Tile()
    {
        if (!string.IsNullOrWhiteSpace(TexturePath))
            _texture = LoadTexture(TexturePath);
    }
    private Texture2D LoadTexture(string texturePath)
    {
        throw new NotImplementedException();
    }
}

internal class Texture2D
{
}

public sealed class Free:Tile
{
    protected override string TexturePath
    {
        set
        {
            if (value == null) throw new ArgumentNullException("value");
            base.TexturePath = "Content/wall.png";
        }
    }
} 
```

如果您不想提供默认纹理路径，则可以计划使属性和基类抽象。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-04T05:47:38.613

根据您的问题，您希望所有实例`Free`共享纹理，所有实例`Wall`共享纹理。这意味着您希望这些`static`字段位于子类中，`texture`而`texture_path`不是父类中。

前任：

```
public class Tile { }

public class Free : Tile
{
    private static Texture2D texture;
    private static string texture_path;
}

public class Wall : Tile
{
    private static Texture2D texture;
    private static string texture_path;
} 
```

如果您希望`Tile`引用具有`texture`和`texture_path`属性，以便您可以从实例访问共享的`texture`或，您需要一个或属性。`texture_path``virtual``abstract`

前任：

```
public abstract class Tile
{
    public abstract Texture2D Texture { get; }
    public abstract string TexturePath { get; }
}

public class Free : Tile
{
   private static Texture2D texture;
   private static string texture_path;

   public override Texture2D Texture { get { return texture; } }
   public override string TexturePath { get { return texture_path; } }
}

// and similarly for Wall 
```

# xcode - Xcode 在运行 iOS 测试/模拟器后离开僵尸进程

> ID：13209743
> 
> 赞同：24
> 
> 时间：2012-11-03T13:44:48.650
> 
> 标签：xcode, zombie-process

在 iOS 应用程序上使用 Xcode 工作了几天后，我注意到周围有超过 100 个僵尸进程。似乎每次我运行单元测试都会有一个，每次我在模拟器中运行完整的应用程序时可能会有一个。这是一个示例（已清理和截断）：

```
> ps -efj | grep $PRODUCT_NAME
  502  2794   236   0 Wed12AM ??         0:00.00 (MyProduct)  me            2794      0    1 Z      ?? 
  502  2843   236   0 Wed01AM ??         0:00.00 (MyProduct)  me            2843      0    1 Z      ?? 
  502  2886   236   0 Wed01AM ??         0:00.00 (MyProduct)  me            2886      0    1 Z      ?? 
...
  502 13711   236   0 Thu11PM ??         0:00.00 (MyProduct)  me           13711      0    1 Z      ?? 
  502 13770   236   0 Thu11PM ??         0:00.00 (MyProduct)  me           13770      0    1 Z      ?? 
  502 14219   236   0 10:35AM ??         0:00.00 (MyProduct)  me           14219      0    1 Z      ?? 
  502 14280   236   0 10:38AM ??         0:00.00 (MyProduct)  me           14280      0    1 Z      ?? 
```

倒数第二列中的 Z 表示它们是僵尸进程。`launchd`第三列中的 236 是父 PID，在这种情况下属于我的用户。

请注意，某些过程已经存在数天了。在这段时间里，我已经退出并重新打开了几次 Xcode。

有谁知道为什么会发生这种情况，或者这是否应该引起警惕？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-03-24T17:36:48.073

在一些特别繁重的 Xcode 会话之后，我的 MBP 听起来像是被要求执行 STARNET 初始化程序，我决定花几分钟时间研究这个僵尸进程的废话......毕竟，一个不能 fork 的 Unix 机器是一个没用的 Unix 盒子。我*可能*有一些好消息。希望我们会看到。在此处在 10.8.2 上运行 Xcode 4.6。

无论 GDB 或 LLDB 的使用如何，僵尸问题似乎都会发生。在模拟器中运行的应用程序归调试进程所有——GDB 或 LLDB 的“调试服务器”。当您点击“停止”时，模拟器中运行的应用程序进程会变成僵尸。这听起来像是一个不干净的关机序列。

在预感而不是点击“停止”时，我暂停了应用程序，并在调试控制台（在我的情况下为 LLDB）中，我使用“进程分离”从正在运行的应用程序中分离出来。快速 ps 验证调试服务器不再运行......到目前为止一切顺利！现在，该应用程序仍在模拟器本身中运行，只是没有处于调试状态。事实上，现在点击停止按钮是无操作的。

在模拟器中点击主页按钮返回跳板，然后双击主页按钮并手动关闭应用程序。转到您的命令行并寻找僵尸......没有僵尸！耶。

所以......下一步是看看是否有一种合理的方法可以通过 python 脚本等执行这个或类似的关闭过程。'如果你在 GDB 上，这没有帮助。如果我可以通过单个调试控制台命令彻底关闭，那么只需习惯不点击损坏的停止按钮即可。也许有一个资源黑客可以完全禁用它...... :)

编辑＃1：几个有趣的花絮......

1.) 在 xcode 中点击停止按钮会直接终止调试和应用程序进程——没有任何尝试彻底关闭。应用程序委托 applicationWillTerminate 和 applicationDidEnterBackground 中的 Printf 调试显示正在运行的应用程序因偏见而被杀死——控制台中没有显示 NSLog。

2.）在调试控制台中调用 [UIApplication terminateWithSuccess] 将导致应用程序“正确”终止，但仍会留下僵尸......有趣的是，如果您设置了断点，应用程序将不会终止：

```
(lldb) expression
Enter expressions, then terminate with an empty line to evaluate:
[(UIApplication *)[UIApplication sharedApplication] terminateWithSuccess]

error: Execution was interrupted, reason: breakpoint 2.1.
The process has been returned to the state before execution.
(lldb) breakpoint disable 2.1
1 breakpoints disabled.
(lldb) expression
Enter expressions, then terminate with an empty line to evaluate:
[(UIApplication *)[UIApplication sharedApplication] terminateWithSuccess]

2013-03-25 01:28:00.186 iPhone Testbed[9481:c07] -[AppDelegate applicationWillTerminate:]
(lldb) 
```

所以应用程序经历了某种关闭过程，并且将终止在控制台中显示，但我们仍然有一个僵尸，所以它仍然不是一个干净的关闭。

我认为这整件事与应用程序在 iOS 运行时中进入后台有关。当直接修改进程时（通过停止按钮、kill 命令、调试控制台的东西等），iOS 运行时不允许进行正确的关闭和清理——事实上，即使当进程不再存在。碰巧我们的 iOS 和 OS X 运行时是同一个——因此启动时拥有僵尸。

所以我认为所有这一切的解决方案是在 iOS 级别确定一个干净的关闭程序，并且至少能够通过调试控制台执行该程序。将更多地研究 UIApplicationExitsOnSuspend 标志，看看我是否可以在运行时设置必要的位（而不是 plist），以便在调试分离时干净地关闭应用程序......

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-15T11:33:09.150

它们不会特别占用很多空间。

这似乎是 Xcode 机器不正确地杀死子进程的产物。

我有同样的问题，但我注意到，在我的情况下，僵尸属于 ppid 271，它是以我的名义调用 launchd，而不是整个系统。

我很好奇如果我杀死或停止该过程会发生什么。

无论如何，**注销*可能会*清除僵尸**。并且肯定会重新启动，但在我的书中，这是要避免的。

* * *

哦，那*很糟糕*。**不要杀死您的 launchd**，它会毫不客气地杀死您的会话，但不会让您恢复它，例如给您一个登录屏幕。

由于停止 Xcode，我将不得不看看我是否将僵尸留在了后面。似乎这里可能有一些愚蠢的事情。如果您的进程不等待一个孩子，它就会变得僵化。如果父母死了，我认为接下来会得到它，在这种情况下是launchd。Launchd 应该等待（）它，但也许那会让人感到困惑？

# java - 带有来自特殊哈希图的图像的 Android ListView

> ID：13209748
> 
> 赞同：1
> 
> 时间：2012-11-03T13:45:16.320
> 
> 标签：java, android, listview, imageview

我尝试处理哈希图以显示带有图像的列表视图。我在这里搜索答案：[如何在 ListView android 中显示图像](https://stackoverflow.com/questions/8411485/how-to-display-images-in-listview-android)。但它不起作用...

我的代码是：

```
for (int i = 0; i < nodes.getLength(); i++) {
Element e = (Element)nodes.item(i);
Map<String, Object> datum = new HashMap<String, Object>(2);
String img_url = getValue(e, "pic");
URL url = null;
                        try {
                            url = new URL(img_url);
                        } catch (MalformedURLException e1) {
                            // TODO Auto-generated catch block
                            e1.printStackTrace();
                        }
                        Bitmap bmp = null; 
                        try {
                            bmp=BitmapFactory.decodeStream(url.openConnection().getInputStream());
                        } catch (IOException e1) {
                            // TODO Auto-generated catch block
                            e1.printStackTrace();
                        }

                        datum.put("imgurl", bmp);
                        datum.put("title", getValue(e, "title"));
                        datum.put("date", getValue(e, "description"));
                        datum.put("ex", "Autor: "+getValue(e, "creator")+" · Datum: "+getValue(e, "pubDate"));
                        datum.put("id", getValue(e, "id"));

                        data.add(datum);
                }       

final ListView lv = (ListView)findViewById(R.id.listView1);
ada = new SimpleAdapter(getApplicationContext(), data, R.layout.vlistimage, new String[] {"imgurl", "title", "date", "ex", "id"}, new int[] {R.id.list_image, android.R.id.text1, android.R.id.text2, R.id.text3}); 
lv.setAdapter(ada); 
```

感谢您的提示/帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T13:51:42.050

这是一个非常常见的问题，你可以谷歌示例。我可以肯定地告诉你，将图像存储在内存中是**错误**的，因为你会得到**OutOfMemoryException**。

要了解如何使用图像和缓存，请访问[高效显示位图](http://developer.android.com/training/displaying-bitmaps/index.html)

# coldfusion - 如何在 Coldfusion 中格式化 Stripe 时间戳

> ID：13209751
> 
> 赞同：3
> 
> 时间：2012-11-03T13:45:44.053
> 
> 标签：coldfusion, stripe-payments

我从 Stripe 请求返回的字段之一是 created 字段，其中包含值“1351894331”。我曾尝试在 Coldfusion 中使用 DateFormat() 来格式化它，但这并没有成功。我想这是某种日期类型/时间戳，需要在 DateFormatting 之前进行转换，但是我需要使用什么？那是什么类型的日期格式？

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-03T14:20:34.980

那可能是从 1970-01-01 开始的几秒钟？这段代码：

```
<cfoutput>#dateAdd("s", 1351894331, createDateTime(1970, 1, 1, 0, 0, 0))#</cfoutput> 
```

输出：

```
{ts '2012-11-02 21:12:11'} 
```

那会是您期望的时间戳吗？

你读过“条纹”文档吗？如果我想知道某件事是如何运作的，我的第一个停靠点就是 RTFM。恰当地说，如果有点不雅。

一时兴起，我[为您搜索了“条带创建时间戳的格式是什么”](https://www.google.co.uk/search?q=what+format+is+stripe+created+timestamps+in)。第一个链接到这里。第二个链接指向[strip.com's docs 上的相关问题](https://answers.stripe.com/questions/in-what-format-are-stripe-timestamps)，其中说：

> 是的，所有 Stripe 时间都以 UTC 表示，表示为 Unix 纪元。

只是为了验证[Unix 纪元日期，我也用谷歌搜索了](https://www.google.co.uk/search?q=unix+epoch+date)。答案是：

> Unix 时间，[...] 是 [...] 定义为自 1970 年 1 月 1 日协调世界时 (UTC) 午夜以来经过的秒数

当然，如果您指的是其他类型的“条纹”，则必须详细说明。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-03T14:32:06.320

这是一个 unix 时间戳——自 1970 年 1 月 1 日以来的秒数——通常用作存储日期的方法。

但在 CFML 中不是这样，日期被处理为自 1899 年 12 月 30 日以来的浮动天数。

要将 unix 时间戳转换为 CF 日期数字，您需要除以一天中的秒数 (86400)，然后将两个日期之间的天数相加。

```
<cfset UnixTime = 1351894331 />

<!--- days between 1-Jan-1970 and 30-Dec-1899) --->
<cfset UnixTimeOffset = 25569 />

<cfset CfTime = UnixTimeOffset + UnixTime/86400 /> 
```

然后，您可以`CfTime`在任何日期函数中使用该变量，它们将照常工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-07-18T21:13:42.827

Stripe 是 CFPAYMENT（一个经过良好测试的库，可帮助您避免编写电子商务管道代码）中受支持的网关，并具有用于日期转换的辅助函数。您可以在此处查看方法：

[https://github.com/ghidilli/cfpayment/blob/master/api/gateway/stripe/stripe.cfc](https://github.com/ghidinelli/cfpayment/blob/master/api/gateway/stripe/stripe.cfc)

```
<cffunction name="dateToUTC" output="false" access="public" returntype="any" hint="Take a date and return the number of seconds since the Unix Epoch">
    <cfargument name="date" type="any" required="true" />
    <cfreturn dateDiff("s", dateConvert("utc2Local", "January 1 1970 00:00"), arguments.date) />
</cffunction>

<cffunction name="UTCToDate" output="false" access="public" returntype="date" hint="Take a UTC timestamp and convert it to a ColdFusion date object">
    <cfargument name="utcdate" required="true" />
    <cfreturn dateAdd("s", arguments.utcDate, dateConvert("utc2Local", "January 1 1970 00:00")) />
</cffunction> 
```

# javascript - 在页面加载时显示复选框状态

> ID：13209752
> 
> 赞同：0
> 
> 时间：2012-11-03T13:45:58.427
> 
> 标签：javascript

我组装了一些代码来检查复选框的状态，然后将相应的消息显示为字符串。复选框的默认状态是“未选中”，但是当我重新加载页面时，没有显示“未选中”的消息，一旦我选中复选框并取消选中，它将按预期工作。简而言之，我希望状态在页面加载时显示，而不是在更改时显示。这是代码：

```
<html>
<head>
</head>
<body>

<input type="checkbox" id="checkBox" />
<div id="text"></div>

<script type="text/javascript">
var getId = document.getElementById('text'),
    checkbox = document.getElementById('checkBox');

function checkState(){
    text.innerHTML = checkbox.checked ? "Checkbox is checked" : "Checkbox is empty";
}
checkbox.onchange = checkState;
</script>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T13:50:20.307

现在，您正在将函数作为`onchange`处理程序运行。如您所见，这是当复选框状态更改时触发的事件。你说：

> 简而言之，我希望状态在页面加载时显示，而不是在更改时显示。

然后修复应该*非常明显：*将 更改`checkbox.onchange`为`window.onload`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-03T13:50:30.143

您只需要调用自己的函数即可将其设置为复选框`onchange`事件。

由于您在正文的末尾执行脚本，因此只有在您已经可以访问 DOM 时才会执行它，您只需要`checkState()`在它的定义后调用。

```
<html>
<head>
</head>
<body>

<input type="checkbox" id="checkBox" />
<div id="text"></div>

<script type="text/javascript">
var getId = document.getElementById('text'),
    checkbox = document.getElementById('checkBox');

function checkState(){
    text.innerHTML = checkbox.checked ? "Checkbox is checked" : "Checkbox is empty";
}
checkbox.onchange = checkState;
checkState();
</script>

</body>
</html> 
```

# c# - 如何在接口类中设置正确的方法参数

> ID：13209753
> 
> 赞同：1
> 
> 时间：2012-11-03T13:46:03.063
> 
> 标签：c#, oop, interface

每个继承类的方法都需要不同类型的参数。在这种情况下，我应该如何在接口方法中定义参数以使所有子方法都可以接受？

```
public interface IPayment 
{
  void MakePayment(OrderInfo orderInfo); // !!
  void MakeRefund (OrderInfo orderInfo); // !!
}

public class OrderInfo 
{
  protected string OrderNo {get; set;}
  protected string CustomerNo { get; set;}
  protected decimal Amount {get; set;}
}

public class CreditCardPaymentInfo : OrderInfo
{
  string CCNum {get; set;}
  string ExpDate { get; set;}
}

public class GooglePaymentInfo : OrderInfo
{
  string GoogleOrderID {get; set;}
}

public class PaypalPaymentInfo : OrderInfo
{
  string PaypalID {get; set;}
}

public void MakePayment()
{
    IPayment paymentModule;
    // Get Order Info 
    if(orderType == "Paypal"){
        paymentModule = new PaypalPayment();

        PaypalPaymentInfo orderInfo = new PaypalPaymentInfo();
        orderInfo.PaypalID = "TEST";
    }else if(orderType == "Google"){
        paymentModule = new GooglePayment();

        GooglePaymentInfo orderInfo = new GooglePaymentInfo();
        orderInfo.GoogleOrderID = "TEST";
    }else{
        paymentModule = new CreditCardPayment();

        CreditCardPaymentInfo orderInfo = new CreditCardPaymentInfo();
        orderInfo.CCNum = "1111111111111111";
        orderInfo.ExpDate = "11/11";
    }

    orderInfo.OrderNo = "123";
    orderInfo.CustomerNo = "ABC";
    orderInfo.Amount = 12.20m;

    paymentModule.MakePayment();
} 
```

它发生错误：

> 错误 1 ​​'com.WebUI.Models.CreditCardPaymentInfo' 没有实现接口成员 'com.WebUI.Models.IPaymentProcess.makeRefund(WebUI.Models.RefundModel)'

***[编辑]***

哦，我忘记了我的模型代码，是这样的，

```
public class CreditCardPayment: IPayment 
{
  public void MakePayment(CreditCardPaymentInfo creditCardPaymentInfo ){...}
  //The parameter type is NOT OrderInfo 
  //public void MakePayment(OrderInfo orderInfo){...}
  public void MakeRefund(CreditCardPaymentInfo creditCardPaymentInfo ){...}
} 
```

但在 CreditCardPayment 案例中，我需要传递CreditCardPaymentInfo 参数而不是仅包含公共字段的**OrderInfo 。**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-03T13:47:22.133

```
public interface IPayment<T> 
    where T: OrderInfo
{
  void MakePayment( T orderInfo );
  void MakeRefund ( T orderInfo );
} 
```

然后：

```
public class CreditCardPayment
    : IPayment<CreditCardPaymentInfo>
{
    public void MakePayment( CreditCardPaymentInfo creditCardPaymentInfo ) {
        // ...
    }

    public void MakeRefund( CreditCardPaymentInfo creditCardPaymentInfo ) {
        // ...
    }
} 
```

和：

```
public class CreditCardPaymentInfo
    : OrderInfo
{
    public string CCNum { get; set; }
    public string ExpDate { get; set; }
} 
```

# javascript - 如何在 Selenium IDE 中处理数组

> ID：13209757
> 
> 赞同：0
> 
> 时间：2012-11-03T13:46:31.920
> 
> 标签：javascript, arrays, selenium, selenium-ide

我想将电子邮件从网页导出到 Selenium 以供以后测试。检查这些电子邮件是否与以后的电子邮件相同，显示在选择中。

我找到了一种在while循环中读取它们的方法。这就是为什么我必须在 IDE 中处理数组而我不知道该怎么做。

我试过这样，但它不起作用：

```
store | 0 |i
store | 17 | line
storeElementPresent | //html/body/div/div[4]/*/div[3]/table/tbody/tr/td/table/tbod/tr[${line}]/td[3]/a |adresseDa
while | ${adresseDa}!='0' 
storeEval | javascript{new Array()} | array
storeText | //html/body/div/div[4]/*/div[3]/table/tbody/tr/td/table/tbody/tr[${line}]/td[3]/a | mail
storeEval | storedVars.array[storedVars.i]=storedVars.mail 
echo | ${array}
storeEval | storedVars.line++
storeEval | storedVars.i++
storeElementPresent | //html/body/div/div[4]/*/div[3]/table/tbody/tr/td/table/tbod/tr[${line}]/td[3]/a | adresseDa
endWhile 
```

`echo | ${array}`重新`null`运行。所以显然它不是这样工作的。

如何将电子邮件存储在数组中，以后如何访问它们？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-05T21:21:29.323

我找到了一个解决方案:) 将邮件存储在一个数组中：

```
store   | 17    | line
storeElementPresent  |//html/body/div/div[4]/*/div[3]/table/tbody/tr/td/table/tbod /tr[${line}]/td[3]/a | adresseDa
while | ${adresseDa}!='0'   
storeText | //html/body/div/div[4]/*/div[3]/table/tbody/tr/td/table/tbody/tr[${line}]/td[3]/a  | tempMail
store   | javascript{storedVars['tempMail'].substring(7,100)} | mail
push    | ${mail}  | mailArray
echo    | ${mailArray} 
storeEval | storedVars.line++       
storeElementPresent | //html/body/div/div[4]/*/div[3]/table/tbody/tr/td/table/tbody/tr[${line}]/td[3]/a | adresseDa
endWhile 
```

要检查数组中的电子邮件是否与稍后网页上的 DropDownMenu 中的电子邮件相同：

```
verifySelectOptions |   //*[@id="mainForm:Emailadresses"] | ${mailArray} 
```

你可以从这里下载扩展`push`：`while`

[http://51elliot.blogspot.de/2012/07/sideflow-update-selenium-ide-flow.html](http://51elliot.blogspot.de/2012/07/sideflow-update-selenium-ide-flow.html)

# xml - 如何让 IF 语句读取多行文本框？

> ID：13209758
> 
> 赞同：0
> 
> 时间：2012-11-03T13:46:57.797
> 
> 标签：xml, vb.net, if-statement

我有一个多行文本框，它的文本包含这个

```
<?xml version="1.0" encoding="utf-8"?>
<version>6</version> 
```

我正在尝试执行这样的 if 命令

```
 If TextBox3.Text = "<?xml version=""1.0"" encoding=""utf-8""?>" + "<version>6</version>" Then
        msg = "No new updates"
    ElseIf "<?xml version=""1.0"" encoding=""utf-8""?>" + "<version>7</version>" Then
        msg = "New update available"
    End If 
```

但我似乎无法让文本框读取两行代码，它只是一直跳过它，我怎么能让 IF 命令读取这两行并说没有新的更新？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T13:55:36.543

```
 If TextBox3.Text.Contains("<version>6</version>") Then
        msg = "No new updates"
    ElseIf TextBox3.Text.Contains("<version>7</version>") Then
        msg = "New update available"
    End If 
```

将解决您的具体问题，但我确信如果您解释了您想要实现的目标，会有更好的方法。

# c# - 在gridview中显示多个图像，然后将在新选项卡中打开的gridview中的每个图像单独链接为大

> ID：13209761
> 
> 赞同：0
> 
> 时间：2012-11-03T13:47:20.207
> 
> 标签：c#, asp.net, gridview

如何在 asp.net c# 的 gridview 中显示所有图像。然后将在新选项卡中打开的gridview中的每个图像单独链接为大。

图像的数据类型是 varbinary(MAX)。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T14:21:57.433

看看这个问题的答案：

[如何使用 ASP.NET 从 SQL Server 显示图像？](https://stackoverflow.com/questions/11284217/how-can-i-display-an-image-from-sql-server-using-asp-net)

在这里，您将看到如何编写显示图像所需的 aspx 文件。

完成此操作后，您可以在其中创建包含图像/链接的非常简单的 gridview 代码。

为了让事情变得更漂亮，您可以调整您在 gridview 中显示的图像的大小。

[http://dzone.com/snippets/c-resize-image-while](http://dzone.com/snippets/c-resize-image-while)

# php - 用php转换网址

> ID：13209766
> 
> 赞同：-1
> 
> 时间：2012-11-03T13:48:26.110
> 
> 标签：php, url-rewriting

如何转换这样的字符串：

```
[www.example.com?type=PC&brand=Dell&id=2] 
```

到

```
[www.example.com/PC/Dell/2.html] 
```

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-03T13:58:58.253

***如果您想将第一个链接映射到第二个链接，以使您网站上的 URL 更漂亮，请使用`.htaccess`and `Mod_rewrite`！***

这是正确的解决方案：

```
$str = "[www.example.com?type=PC&brand=Dell&id=2]";

$str = trim($str,"[]"); //Remove square brackets, we'll add them back later
$url = parse_url($str); //Parse the URL into an array

$query = $url["query"]; //Part after the ?

$parts = explode("&", $query); //Have each GET variable into an array element
$parts = array_map(function($e) {
    return preg_replace("/[^=]+=/", "", $e);
}, $parts); //Remove the part before the =.

$parts = implode("/", $parts); //Implode it back into a string.
$result = $url["path"] . "/" . $parts . ".html"; //Putting it back together
$result = "[$result]"; //I promised I'll put it back!

var_dump($result); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-03T13:53:05.843

在你的 .htaccess 中试试这个

```
Options +FollowSymLinks
RewriteEngine on

RewriteRule /(.*)/(.*)/(.*)\.html www.example.com?type=$1&brand=$2&id=$3 
```

# android - “返回”按钮使用 WebView 关闭共享对话框和子活动

> ID：13209767
> 
> 赞同：3
> 
> 时间：2012-11-03T13:48:26.437
> 
> 标签：android, android-intent

我确实有 Activity (ListView)，它打开了带有 WebView 的子活动。然后我从 WebView 打开共享对话框。但是当我按下“返回”按钮时，它会关闭共享对话框和子活动。如何使“返回”按钮仅关闭共享对话框？

非常感谢！

```
public class Journal extends Activity {
    private ViewFlow viewFlow;
    int page = 0;
    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.circle_layout);
             page = getIntent().getExtras().getInt("new_page");
        viewFlow = (ViewFlow) findViewById(R.id.viewflow);
        viewFlow.setAdapter(new JournalAdapter(this, page), 0);
        CircleFlowIndicator indic = (CircleFlowIndicator) findViewById(R.id.viewflowindic);
        viewFlow.setFlowIndicator(indic);
    } 
}

public class JournalAdapter extends BaseAdapter {
...
    @Override
    public View getView(int position, View convertView, ViewGroup parent) {
        int _id = 0, rid = 0;
        int N = num;
        String url = "http://lookuper.ru/LookuperServer/journal/URL/index.html";
        if (position == 0) {
            _id = R.id.wv1;
            rid = R.layout.webview_1;
        } 

        url = url.replace("URL", String.valueOf(num - position));

        Tools.messageToLog("  =~=  getView() :: num = " + (num + position) + "; pos = " + position + ";  URL = " + url);
        convertView = mInflater.inflate(rid, null);

        final WebView wv = (WebView) convertView.findViewById(_id);
        wv.setWebChromeClient(new WebChromeClient());
        wv.setPadding(0, 0, 0, 0);
        wv.setScrollBarStyle(WebView.SCROLLBARS_OUTSIDE_OVERLAY);
        wv.requestFocus(View.FOCUS_DOWN|View.FOCUS_UP);
        wv.getSettings().setLightTouchEnabled(true);        

        // wv.getSettings().setLayoutAlgorithm(LayoutAlgorithm.NORMAL);
        wv.getSettings().setUseWideViewPort(true);
        wv.getSettings().setLoadWithOverviewMode(true);
        wv.getSettings().setJavaScriptEnabled(true);
        wv.addJavascriptInterface(new Object() {
            public void performClick() {
                showShare("Product", "http://product.com");
            }
        }, "share");
        wv.addJavascriptInterface(new Object() {
            public void performClick() {
                ((Activity) context).finish();
            }
        }, "closeActivity");
        wv.loadUrl(url);
        final Activity MyActivity = (Activity) context;
        final ProgressBar v = (ProgressBar) MyActivity.findViewById(R.id.ProgressBar01);
        wv.setWebChromeClient(new WebChromeClient() {
            public void onProgressChanged(WebView view, int progress) {
                v.setProgress(progress * 100);
                if (progress == 100)
                    v.setVisibility(ProgressBar.GONE);
            }
        }); 

        wv.setOnTouchListener(new View.OnTouchListener() { 
            @Override
            public boolean onTouch(View v, MotionEvent event) {
                switch (event.getAction()) { 
                           case MotionEvent.ACTION_DOWN: 
                           case MotionEvent.ACTION_UP: 
                               if (!v.hasFocus()) { 
                                   v.requestFocus(); 
                               } 
                               break; 
                       } 
                       return false; 
                    }
            });
        return convertView;
    }

    private void showShare(String subject, String URL) {
        List<Intent> targetedShareIntents = new ArrayList<Intent>();
        Intent shareIntent = new Intent(android.content.Intent.ACTION_SEND);
        shareIntent.setType("text/plain");
        shareIntent.setFlags(Intent.FLAG_ACTIVITY_RESET_TASK_IF_NEEDED | Intent.FLAG_ACTIVITY_CLEAR_WHEN_TASK_RESET);
        Intent vk = null, tw = null, wa = null, gm = null, mms = null, mail = null, fb = null;

        List<ResolveInfo> resInfo = context.getPackageManager().queryIntentActivities(shareIntent, 0);
        if (!resInfo.isEmpty()) {
            for (ResolveInfo resolveInfo : resInfo) {
                String packageName = resolveInfo.activityInfo.packageName;
                Intent targetedShareIntent = new Intent(android.content.Intent.ACTION_SEND);
                targetedShareIntent.setType("text/plain");
                targetedShareIntent.putExtra(android.content.Intent.EXTRA_SUBJECT, subject);
                if (packageName.contains("com.facebook.katana")) {
                    targetedShareIntent.putExtra(android.content.Intent.EXTRA_TEXT, URL);
                    targetedShareIntent.setPackage(packageName);
                    fb = targetedShareIntent;
                } else if (packageName.contains("com.vkontakte.android")) {
                    targetedShareIntent.putExtra(android.content.Intent.EXTRA_TEXT, URL);
                    targetedShareIntent.setPackage(packageName);
                    vk = targetedShareIntent;
                } else if (packageName.equalsIgnoreCase("com.google.android.gm")) {
                    targetedShareIntent.putExtra(android.content.Intent.EXTRA_TEXT, URL);
                    targetedShareIntent.setPackage(packageName);
                    gm = targetedShareIntent; 
                } else if (packageName.contains("com.whatsapp")) {
                    targetedShareIntent.putExtra(android.content.Intent.EXTRA_TEXT, URL);
                    targetedShareIntent.setPackage(packageName);
                    wa = targetedShareIntent;
                } else if (packageName.contains("mail")) {
                    targetedShareIntent.putExtra(android.content.Intent.EXTRA_TEXT, URL);
                    targetedShareIntent.setPackage(packageName);
                    mail = targetedShareIntent;
                } else if (packageName.contains("com.android.mms")) {
                    targetedShareIntent.putExtra(android.content.Intent.EXTRA_TEXT, URL);
                    targetedShareIntent.setPackage(packageName);
                    mms = targetedShareIntent;
                } else if (packageName.contains("com.twitter.android")) {
                    targetedShareIntent.putExtra(android.content.Intent.EXTRA_TEXT, URL);
                    targetedShareIntent.setPackage(packageName);
                    tw = targetedShareIntent;
                } 
            }

            Intent chooserIntent = Intent.createChooser(mms, "VK");

            Parcelable [] parcelable = new Parcelable [6];
            parcelable[0] = new LabeledIntent(vk, "com.vkontakte.android", "VK", 0);
            parcelable[1] = fb;
            parcelable[2] = tw;
            parcelable[3] = wa;
            parcelable[4] = gm;
            parcelable[5] = mail;

            Parcelable p [] = targetedShareIntents.toArray(new Parcelable[] {});
            for (int i = 0; i < p.length; i++) {
                Tools.messageToLog(" >=< PN = " + p[i].toString());
            }

            chooserIntent.putExtra(Intent.EXTRA_INITIAL_INTENTS, parcelable);
            chooserIntent.setAction("android.intent.action.MAIN");

            ((Activity) context).startActivityForResult(shareIntent, 0);

            // context.startActivity(shareIntent);

        }
    }
} 
```

XML:

```
cyrcle_layout.xml
<?xml version="1.0" encoding="utf-8"?>
<FrameLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" >

    <ProgressBar
        android:id="@+id/ProgressBar01"
        android:layout_width="fill_parent"
        android:layout_height="3dp"
        android:indeterminateDrawable="@android:drawable/progress_indeterminate_horizontal"
        android:indeterminateOnly="false"
        android:maxHeight="20dip"
        android:minHeight="20dip"
        android:progressDrawable="@android:drawable/progress_horizontal" >
    </ProgressBar>

    <com.postuchat.lookuper.UI.custom.viewflow.CircleFlowIndicator
        android:id="@+id/viewflowindic"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_gravity="center_horizontal"
        android:paddingTop="10dp" />

    <com.postuchat.lookuper.UI.custom.viewflow.ViewFlow
        android:id="@+id/viewflow"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent" />

    <ImageButton
        android:id="@+id/ib1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_gravity="center_horizontal"
        android:paddingTop="10dp" 
        android:src="@drawable/smiley_button"
        android:contentDescription="tests"
        />

</FrameLayout>

web_view1.xml
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:orientation="vertical"
    android:paddingTop="20dp" >

    <WebView
        android:id="@+id/wv1"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:animationCache="false"
        android:soundEffectsEnabled="false" 
        />

</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T13:57:06.523

在您的活动类中覆盖 onKeyDown 事件并执行您想要的操作。

```
@Override
public boolean onKeyDown(int keyCode, KeyEvent event) {
    if ((keyCode == KeyEvent.KEYCODE_BACK)) {
       // close dialoge here
     return true;
    }
    return super.onKeyDown(keyCode, event);
} 
```

# sql - 在 Oracle 中创建表

> ID：13209775
> 
> 赞同：-1
> 
> 时间：2012-11-03T13:49:30.860
> 
> 标签：sql, oracle, oracle11g

我的要求是该列`accno`没有空值并且没有重复。name 列没有空值，只接受 A 到 Z（没有其他类似的数字或 * $）。列`acctype`是一个只允许 ('S', 'C','R') 的字符，并且该`balance`列没有空值。如果`acctype`是 S 那么余额应该 >= 5000，当 C 余额应该 > 10000 并且当它是 R >= 5000 时。

我正在尝试将此应用于：

```
create table kcb_acc_tab
 (accno varchar2(20)
    constraint kcb_acc_Pk
      primary key, 
  name varchar2(20)
    constraint kcb_name_NN
      Not null
    constraint kcb_name_CK 
      check((name =upper(name)) and (name like '[(A-Z)]')),
  Acctype char
    constraint kcb_acctype_ck
      check (acctype in('S' ,'C' ,'R')) ,
  Doo timestamp
    default sysdate ,
  bal number(7,2) kcb_bal_NN
    constraint kcb_bal_ck
      check((aacctype ='S' and bal >=5000) or
            (acctype = 'C' and bal >=10000) or
            (acctype ='R' and bal >=5000)); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-03T14:22:26.623

这听起来像是[正则表达式](http://docs.oracle.com/cd/E11882_01/server.112/e26088/conditions007.htm#SQLRF00501)`like`的完美用例，我认为这是您在约束中的意图。

我已经大大清理了您的陈述，您在定义中缺少逗号`kcb_bal_ck`，并且我已将约束放在末尾并添加了空格。对我来说，这使我更容易看到发生了什么以及可能出现的错误。

```
create table kcb_acc_tab(
   accno varchar2(20) not null
 , name varchar2(20) not null
 , acctype char(1) not null -- missing size of column
 , doo timestamp default sysdate not null -- missing not null
 , bal number(7,2) not null
 , constraint kcb_acc_pk primary key (accno)
 , constraint kcb_name_ck check ( regexp_like(name, '[A-Z]', 'c' ) )
 , constraint kcb_acctype_ck check ( acctype in ( 'S' ,'C' ,'R' ) )
   -- acctype was spelled incorrectly. 
 , constraint kcb_bal_ck check( ( acctype ='S' and bal >= 5000 ) 
                             or ( acctype = 'C' and bal >= 10000 ) 
                             or ( acctype ='R' and bal >= 5000 )
                                ) -- this parenthesis was missing
   ) 
```

这是一个要演示的[SQL Fiddle 。](http://www.sqlfiddle.com/#!4/35afb/2)

这个和你自己的主要区别是`regexp_like(name, '[A-Z]', 'c' )`。这确保了列`name`中的字符仅包含在组 AZ 中，即大写拉丁字母的集合。match_parameter`'c'`指定匹配应该区分大小写。默认区分大小写由您的 NLS_SORT 参数确定，因此您可能不需要明确指定，但这样做是明智的。

# python - 在 Debian 上获得 Python 3 机械化的最简单方法是什么？

> ID：13209778
> 
> 赞同：4
> 
> 时间：2012-11-03T13:50:11.553
> 
> 标签：python, python-3.x, mechanize

我最近想将我使用的爬虫移植`mechanize.Browser`到 Python 3。我还没有找到任何`python3-mechanize`包或类似的东西。我还不熟悉使用一些特殊程序构建 Python 模块，所以我不知道如何在那里使用`2to3`。有什么建议么？

**@edit：我接受 Sibi 的回答，因为它目前是最好的。如果只是指出更好的解决方案，我将很高兴以这种方式授予任何其他答案。**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-03T14:02:09.903

这是 Mechanize 的实验性 Python 3 分支：[https ://github.com/adevore/mechanize/tree/python3](https://github.com/adevore/mechanize/tree/python3)

另请参阅此处了解更多详细信息：[http ://web.cecs.pdx.edu/~adevore/mechanize/](http://web.cecs.pdx.edu/~adevore/mechanize/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-07-26T13:21:48.590

几年来， [Mechanize 存储库](https://github.com/jjlee/mechanize)中没有任何活动。尽管建议了实验性 Python 3 分支，但它尚未合并，也没有[对支持请求的](https://github.com/jjlee/mechanize/issues/96)官方回应。

如果您正在寻找一个活跃的项目，您可能希望寻找其他地方。与 Python 3 兼容的两个类似项目是

*   [MechanicalSoup](https://github.com/hickford/MechanicalSoup) -“用于自动与网站交互的 Python 库。”
*   [RoboBrowser](https://github.com/jmcarp/robobrowser) - “一个简单的 Pythonic 库，用于在没有独立 Web 浏览器的情况下浏览 Web。”

两者都使用 Requests 和 BeautifulSoup。截至 2015 年年中，后者的活动略多一些。

# android - 3 个线程 + 3 个处理程序不起作用

> ID：13209783
> 
> 赞同：1
> 
> 时间：2012-11-03T13:50:35.523
> 
> 标签：android, multithreading, handlers

我在每个线程中有 3 个线程和 1 个处理程序。但它只适用于一个，其他 2 个处理程序完全清除 textview。

代码：

```
 Thread getServerStatus = new Thread() {                     
        public void run() {                                                                         
            Document doc;
            try {
                doc = dereference("my url");
                String text = doc.select("div#serverstatus").toString();
                Message msg = handler_serverstatus.obtainMessage();
                msg.obj = text;
                handler_serverstatus.sendMessage(msg);
            } catch (IOException e) {
                e.printStackTrace();
            }

        }

        Handler handler_serverstatus = new Handler()
        {
            public void handleMessage(Message msg)
            {
                 String text = (String)msg.obj;
                 TextView tv = (TextView)findViewById(R.id.server_status);
                 if(text.contains("online")) {
                     //tv.setTextColor(2);
                     tv.setText("online");
                 } else if(text.contains("offline")) {
                     tv.setText("offline");
                 } else {
                     tv.setText("Error #1");
                 }
            }

        };
    };

    Thread getPlayersOnline = new Thread() {                     
        public void run() {                                                                         
            Document doc;
            try {
                doc = dereference("my url");
                String text = doc.select("div#players_on").toString();
                Message msg = handler_players.obtainMessage();
                msg.obj = text;
                handler_players.sendMessage(msg);
            } catch (IOException e) {
                e.printStackTrace();
            }

        }

        Handler handler_players = new Handler()
        {
            public void handleMessage(Message msg)
            {
                 String text = (String)msg.obj;
                 TextView tv = (TextView)findViewById(R.id.players_online);
                 text = text.replace("<div id=\"players_on\">", "");
                 text = text.replace("</div>", "");
                 tv.setText(text);
            }

        };
    };

    Thread getPlayersMax = new Thread() {                     
        public void run() {                                                                         
            Document doc;
            try {
                doc = dereference("url");
                String text = doc.select("div#players_max").toString();
                Message msg = handler_players_max.obtainMessage();
                msg.obj = text;
                handler_players_max.sendMessage(msg);
            } catch (IOException e) {
                e.printStackTrace();
            }

        }

        Handler handler_players_max = new Handler()
        {
            public void handleMessage(Message msg)
            {
                 String text = (String)msg.obj;
                 TextView tv = (TextView)findViewById(R.id.players_max);
                 text = text.replace("<div id=\"players_max\">", "");
                 text = text.replace("</div>",  "");
                 tv.setText(text);
            }

        };
    };

    public void ButtonClick(View view) throws IOException {
        getServerStatus.start();
        getPlayersOnline.start();
        getPlayersMax.start();
    }

    private Document dereference(String uri) throws IOException {
        Connection connection = Jsoup.connect(uri);
        return connection.get();
    } 
```

这可能是完全错误的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T14:05:09.603

利用

```
ExecutorService newFixedThreadPool = Executors.newFixedThreadPool(1); // number of working thread 
Runnable getServerStatus = new Runnable() {
        @Override
        public void run() {
             Document doc;
                try {
                    doc = dereference("my url");
                    String text = doc.select("div#serverstatus").toString();
                    Message msg = handler_serverstatus.obtainMessage();
                    msg.obj = text;
                    handler_serverstatus.sendMessage(msg);
                } catch (IOException e) {
                    e.printStackTrace();
                }
        }

           Handler handler_serverstatus = new Handler()
            {
                public void handleMessage(Message msg)
                {
                     String text = (String)msg.obj;
                     TextView tv = (TextView)findViewById(R.id.server_status);
                     if(text.contains("online")) {
                         //tv.setTextColor(2);
                         tv.setText("online");
                     } else if(text.contains("offline")) {
                         tv.setText("offline");
                     } else {
                         tv.setText("Error #1");
                     }
                }

            };

    };
    Runnable getPlayersOnline = new Runnable() {
        @Override
         public void run() {                                                                         
                Document doc;
                try {
                    doc = dereference("my url");
                    String text = doc.select("div#players_on").toString();
                    Message msg = handler_players.obtainMessage();
                    msg.obj = text;
                    handler_players.sendMessage(msg);
                } catch (IOException e) {
                    e.printStackTrace();
                }

            }

            Handler handler_players = new Handler()
            {
                public void handleMessage(Message msg)
                {
                     String text = (String)msg.obj;
                     TextView tv = (TextView)findViewById(R.id.players_online);
                     text = text.replace("<div id=\"players_on\">", "");
                     text = text.replace("</div>", "");
                     tv.setText(text);
                }

            };
    }

    Runnable getPlayersMax = new Runnable() {

          public void run() {                                                                         
                Document doc;
                try {
                    doc = dereference("url");
                    String text = doc.select("div#players_max").toString();
                    Message msg = handler_players_max.obtainMessage();
                    msg.obj = text;
                    handler_players_max.sendMessage(msg);
                } catch (IOException e) {
                    e.printStackTrace();
                }

            }

            Handler handler_players_max = new Handler()
            {
                public void handleMessage(Message msg)
                {
                     String text = (String)msg.obj;
                     TextView tv = (TextView)findViewById(R.id.players_max);
                     text = text.replace("<div id=\"players_max\">", "");
                     text = text.replace("</div>",  "");
                     tv.setText(text);
                }

            };
    };
    newFixedThreadPool.submit(getServerStatus);
    newFixedThreadPool.submit(getPlayersOnline);
    newFixedThreadPool.submit(getPlayersMax); // submit all your targets
}

 public void ButtonClick(View view) throws IOException {
        newFixedThreadPool.shutdown();// shutdown and execute it 
    } 
```

内部可运行 3 个；阅读有关 ThreadPools的 [教程](http://www.caveofprogramming.com/java/java-multithreading-thread-pools-video-tutorial-part/)[http://www.vogella.com/articles/JavaConcurrency/article.html，http://www.caveofprogramming.com/java/java-multithreading-thread-pools-video-tutorial-part/](http://www.vogella.com/articles/JavaConcurrency/article.html)

或用同步块{}包装你的 run() 目标；

# delphi - 在 Delphi 设计时检测新组件的插入

> ID：13209787
> 
> 赞同：0
> 
> 时间：2012-11-03T13:51:00.363
> 
> 标签：delphi, components, delphi-xe2, design-time

我的 Delphi 组件如何在设计时检测是否有任何其他组件被拖放到表单上？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-03T14:04:38.097

您应该覆盖`Notification`组件的方法；类似的东西：

```
type
  TMyComponent = class(TComponent)
//..
  protected
    procedure Notification(AComponent: TComponent;
      Operation: TOperation); override;
  end;

procedure TMyComponent.Notification(AComponent: TComponent;
  Operation: TOperation);
begin
  inherited Notification(AComponent, Operation);
  if (Operation = opInsert) and (csDesigning in ComponentState) then begin
// AComponent was dropped on the form
  end;
end; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-03T17:12:09.353

如果您的意思是放置控件而不是组件，并且如果您的意思是放置在组件上而不是放置在表单上，​​那么：

*   添加`CM_CONTROLLISTCHANGE`消息处理程序以在插入控件之前跟踪控件，或者
*   添加`CM_CONTROLCHANGE`消息处理程序以在控件插入后跟踪控件（`WParam`指向控件），
*   在 IDE 创建表单期间不要执行此`csLoading`操作，`ComponentState`以防止跟踪。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-07-14T12:00:13.213

只是一个提示，如果它有帮助......我有一个类似的问题：

*   当我将非可视组件图标（对于我的`TMyLabel=class(Classes.TComponent)`组件）从 IDE 拖放到表单、面板等中时，我想隐藏它...

我已经超载了：`Loaded`并且`ReadState`让这样的图标看不见（在设计时）......`Loaded`我`ReadState`把`DesignInfo`指向（-100，-100），所以图标没有显示

我已经超载：`WriteState`为了避免 Left & Top 被保存到 .dfm（在设计时）......`WriteState`我把它放在点（0,0）上，所以它没有保存在 .dfm 中

注意：我使用相同的技术/技巧来不保存我不想要的属性等......我真的只让 Caption 保存在 .dfm 中

问题/提示是：

*   当我将一个新的“控件”（我的组件）放到表单中时，这样的图标就在我放置它的地方可见......如何隐藏它？

也许`user1580348`正在尝试类似的东西......或者与自动对齐这些非视觉“控件”/“组件”相关的东西。

换句话说：

*   在表单、面板等上放置新的（我们的组件）控件时，我们如何控制图标位置...

我知道我的问题要容易得多，但我还没有解决它......我只想隐藏 IDE 为非可视组件显示的图标（仅适用于我的组件的控件）......但也许知道如何它也会有所帮助`user1580348`。

正如我所说，这只是一个提示/线索。

# django - 如何将自定义部分添加到 admin/auth/user/(x) 页面？

> ID：13209794
> 
> 赞同：0
> 
> 时间：2012-11-03T13:51:57.223
> 
> 标签：django, django-admin

我说的不仅仅是表单或静态数据的自定义字段，我说的是添加一个实际上有自己代码的部分。字段集中的一种新条目，但它引入的不是新字段，而是一些关于用户活动的小报告。

实际上这个问题代表任何模型的更改页面。Django 文档向您展示了如何覆盖此页面的模板，但是不添加一些 python 代码有什么好处呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T14:57:38.463

您可以覆盖默认模板和默认视图。

Django 有两种不同的视图和模板用于管理记录显示。一个用于创建一个新的，一个用于显示现有的并对其进行编辑。相关方法有：

*   [添加表单模板](https://docs.djangoproject.com/en/1.4/ref/contrib/admin/#django.contrib.admin.ModelAdmin.add_form_template)和[添加视图](https://docs.djangoproject.com/en/1.4/ref/contrib/admin/#django.contrib.admin.ModelAdmin.add_view)以添加新记录
*   [更改表单模板](https://docs.djangoproject.com/en/1.4/ref/contrib/admin/#django.contrib.admin.ModelAdmin.change_form_template)和[更改视图](https://docs.djangoproject.com/en/1.4/ref/contrib/admin/#django.contrib.admin.ModelAdmin.change_view)以显示和更改现有记录

这是如何准备相关覆盖视图的示例（取自[添加/更改视图](https://docs.djangoproject.com/en/1.4/ref/contrib/admin/#django.contrib.admin.ModelAdmin.change_view)链接）

```
class MyModelAdmin(admin.ModelAdmin):

    # A template for a very customized change view:
    change_form_template = 'admin/myapp/extras/openstreetmap_change_form.html'

    def get_osm_info(self):
        # ...
        pass

    def change_view(self, request, object_id, form_url='', extra_context=None):
        extra_context = extra_context or {}
        extra_context['osm_data'] = self.get_osm_info()
        return super(MyModelAdmin, self).change_view(request, object_id,
            form_url, extra_context=extra_context) 
```

您必须检查 django 源代码中的默认 django 添加和更改模板（可能将其复制为新模板并在之后进行编辑），以了解如何准备自定义模板。

最后一点，**永远不要**直接从源代码编辑 django 模板或查看代码，因为它们被许多不同的应用程序使用，并且更新到 django 源代码可能会覆盖您的编辑或可能导致问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T15:00:53.667

除了覆盖模板之外，Django 管理员具有很强的可扩展性。

确保查看文档中的[ModelAdmin 方法](https://docs.djangoproject.com/en/1.4/ref/contrib/admin/#modeladmin-methods)部分。您几乎可以修改 ModelAdmin 的任何行为。

您还应该查看[自定义表单验证](https://docs.djangoproject.com/en/1.4/ref/forms/validation/)和[ModelForms](https://docs.djangoproject.com/en/1.4/topics/forms/modelforms/)文档，因为附加到 ModelAdmin 的模型的自定义表单为您提供了另一个（在大多数情况下更深）级别的自定义。

# bash - 进程环境变量的当前值

> ID：13209796
> 
> 赞同：3
> 
> 时间：2012-11-03T13:52:15.673
> 
> 标签：bash, unix, process, procfs

我想知道是否有办法从 bash 进程设置环境变量并从另一个进程读取它。

由于环境变量的值对于进程来说是本地的（除了继承），因此不能只`export FOO="bar"`在终端中执行并从另一个终端中读取它。然后我试图让他们通过`/proc/environ`，但这就是我得到的：

```
etuardu@subranu:~$ FOO="foo" bash
etuardu@subranu:~$ strings /proc/$$/environ | grep FOO
FOO=foo
etuardu@subranu:~$ export FOO="bar"
etuardu@subranu:~$ strings /proc/$$/environ | grep FOO
FOO=foo
etuardu@subranu:~$ echo $FOO
bar 
```

看来我可以得到该环境变量在进程开始时所具有的值。
它现在的价值如何？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-03T14:28:30.903

由于环境变量的工作方式，这通常是不可能的。

当一个进程第一次被`exec`编辑时，内核向它提供它的初始环境变量集以及其他一些东西（主要是它的`argv`向量，即它的命令行）。此后，此列表（如`argv`向量）只是进程内的常规 C 字符指针数组。该过程可以随意管理它们，包括完全回收保存字符串的内存以供其他用途（如果需要）。一个进程窥视任何其他进程的内存空间以查找其环境变量是不安全的。

大多数类型的进程确实或多或少地按原样使用内核提供的环境变量列表，可能会使用 和 之类的 C 库函数对其进行查询和`getenv()`修改`putenv()`。如果这些进程轮流运行任何其他可执行文件，它们会将相同的环境向量传递给`execve`它们在自己执行开始时收到的系统调用，这意味着新的可执行文件获得相同的环境（可能通过一些调用来增强`putenv()`） .

贝壳是另一回事。因为环境变量在 shell 脚本中非常重要，一些 shell 使用提供给它们的环境向量仅作为“起始值”，然后忽略它。他们使用自己的、更有能力的数据结构来管理他们的环境变量。当他们执行他们自己的子进程时，他们将一个全新的环境向量传递给新进程，由这些内部数据结构构建。这意味着即使您按照上面的建议查看 shell 的内存空间以查找其环境变量，您也只会找到初始设置，而不是 shell 实际使用的环境！

您*可以*做的是查询进程的初始环境变量集，即在启动时传递给可执行文件的同一向量。但这不是可移植的，即使在支持它的操作系统之间也存在相当大的差异。例如，在历史上的 UNIX 中，它仍然有点难看，因为它仍然涉及窥探进程的内存空间（尽管是一个称为“用户区”的特殊内存区域）。Linux 更优雅地使这成为可能：向量可以作为文本字符串在`/proc/<pid>/environ`. 在大多数可以获得此信息的系统上，`ps`都有一个`e`能够显示它的选项。

# javascript - 每次单击每个链接或网址时如何更改网站的背景图片？

> ID：13209798
> 
> 赞同：0
> 
> 时间：2012-11-03T13:52:21.007
> 
> 标签：javascript, html, css, background-image

好吧，我在网上看到了很多关于这个的问题，但似乎其中很多都在使用 PHP、ASP、JQUERY 和任何其他语言。对我来说，我只对 CSS 和 Java Script 有点熟悉，那是我只知道的语言。那么有人可以向我展示一些针对该问题的 CSS 和 Java Script 代码吗？

无论如何，我也对网站上的背景感兴趣，每次刷新都会改变！

提前致谢！

嘿，我找到了示例代码，它运行良好！

本论坛的致谢：[http ://www.daniweb.com/web-development/web-design-html-and-css/threads/228324/load-different-background-image-when-user-refresh](http://www.daniweb.com/web-development/web-design-html-and-css/threads/228324/load-different-background-image-when-user-refresh)

```
<html>
<head>
<title>Untitled</title>
<script type="text/javascript">
function changeImg(imgNumber)   {
var myImages = ["Background/Background.jpg", "Background/Background2.jpg", "Background/Background3.jpg", "Background/Background4.jpg", "Background/Background5", "Background/Background6", "Background/Background7"];
var imgShown = document.body.style.backgroundImage;
var newImgNumber =Math.floor(Math.random()*myImages.length);
document.body.style.backgroundImage = 'url('+myImages[newImgNumber]+')';
}
window.onload=changeImg;
</script>
<style type="text/css">
.bg {background-attachment:fixed; background-repeat: no-repeat; background-position:top right;}
</style>
</head>
<body class="bg">
<p>Some text</p>
<!-- put a lot text lines here to see that the background stays fixed. -->
<p>Some text</p>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T14:28:51.403

大量的解决方案：

将所有文件存储在一个文件夹中。

1.  使用索引号索引数据库表中的图像。生成一个特定范围的随机数，并显示该随机数对应的图像

2.  将文件夹中的所有图像从 (1 - n) 重命名。生成随机数并附加 /。

获得随机图像后，您可以轻松地使用 javascript 覆盖背景或任何其他 dom 组件，例如

```
document.getElementByTag('body').setAttribute('style','background-image:url('+<your image>+')); 
```

你也可以用 jQuery 来简化它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T15:16:59.580

您可以使用 JQuery 轻松地做到这一点 - 只需为每个链接定义点击事件 -

```
$(function(){
    $("link1").click(function(){
        $("body").css({background-image:"url('link1_image.gif')"}); 
    });
});​ 
```

对于每次刷新时的随机图像加载，您可以直接调用 onload 函数并设置随机图像。

```
$(function(){        
    var images = ['image1.jpg', 'image2.jpg', 'image3.jpg'];
    $('body').css({'background-image': 'url(images/' + images[Math.floor(Math.random() * images.length)] + ')'});
});​ 
```

希望它会奏效。谢谢。

# google-chrome - Chrome 扩展程序桌面通知中未显示图标

> ID：13209799
> 
> 赞同：2
> 
> 时间：2012-11-03T13:52:30.970
> 
> 标签：google-chrome, google-chrome-extension, notifications, icons, desktop

我正在构建一个具有桌面通知功能的 Chrome 扩展程序。以下是我使用的代码：

```
var notification = webkitNotifications.createNotification(
  '48.png',  
  'Hello!',  
  'Lorem ipsum...'  
); 
```

48.png位于**扩展** 文件**夹***和*. **但图标不显示**。**`manifest.json`**

 ****你能帮助我吗？我正在使用最新的 Chrome 版本（Apple 版本，22.0.1229.94）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T16:27:11.430

也许你应该试试这个：

```
var notification = webkitNotifications.createNotification(
  chrome.extension.getURL('48.png'),  
  'Hello!',  
  'Lorem ipsum...'  
); 
```

使用 chrome.extension.getURL 获取资源的扩展路径

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-11T07:30:44.713

问题可能是网络可访问性问题吗？

尝试将您的图像列入清单文件中的[Web 可访问资源](http://code.google.com/chrome/extensions/manifest.html#web_accessible_resources "WAR 的 Google 文档")中的白名单。[Rob W](https://stackoverflow.com/users/938089/rob-w)在这里提供了更彻底的答案：

[在 chrome 扩展中插入图像](https://stackoverflow.com/questions/11804332/insert-an-image-in-chrome-extension)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-06-20T13:54:36.717

桌面通知中的图像不适用于 OS X。仅适用于 Windows 和 ChromeOS。****

# jquery - jquery第二个交替没有在（点击）上运行 - 打开/关闭按钮

> ID：13209801
> 
> 赞同：1
> 
> 时间：2012-11-03T13:52:49.297
> 
> 标签：jquery

我总是对打开/关闭按钮感到困惑。

这可能是错误的方式 - 但我似乎无法让第二次交替运行。

还有什么我应该使用的吗？谢谢

```
$(currentSlideHtmlObject).find('.openSpec').on('click',

    function (e){

        e.preventDefault();

        $techSpec.animate({
            left : '-' + $techSpec.outerWidth() + 'px'
        });

    },
    function (e) {

        e.preventDefault();

        $techSpec.animate({
            left : '0px'
        });

    }

); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T13:57:17.673

您正在寻找[`toggle`](http://api.jquery.com/toggle-event/)，而不是`on`：

```
$("#target").toggle(
  function() {
    console.log("On");
  },
  function() {
    console.log("Off");
  }
); 
```

[实例](http://jsbin.com/ozelox/1)| [资源](http://jsbin.com/ozelox/1/edit)

# javascript - 替换所有非单词字符，如 ?*+#

> ID：13209802
> 
> 赞同：6
> 
> 时间：2012-11-03T13:53:01.797
> 
> 标签：javascript, regex, character, match

我需要一些帮助来替换字符串中的所有非单词字符。

作为一个例子`(stadtbezirkspräsident'`应该成为`stadtbezirkspräsident`.

这个正则表达式应该适用于所有语言，所以它有点棘手，因为我不知道如何匹配像`ñ`or之类的字符`œ`。我试着用

```
string.replace(/[&\/\\#,+()$~%.'":*?<>-_{}]/g,' '); 
```

但仍有许多特殊字符，`Ø`如左。

也许有一个通用的选择器，或者以前有人解决过这个问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-03T14:03:16.093

尝试使用技巧

```
str.replace(/(?!\w)[\x00-\xC0]/g, '') 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-11-03T14:04:06.663

如果您自己定义了所有 Unicode 范围，那将是很多工作。

[`XRexExp`将 Steven Levithan 的包与 Unicode 附加组件一起](http://xregexp.com/plugins/)使用并利用其 Unicode 属性快捷方式可能更有意义：

```
var regex = new XRegExp("\\P{L}+", "g")
string = XRegExp.replace(string, regex, "") 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-03T14:43:27.473

这更像是对 Tim Pietzcker 的回答的评论，但在评论中呈现代码很尴尬......这是使用 XRexExp 包的简单示例：

```
<p id=orig>Bundespräsident / ß+ð/ə¿α!</p>
<p id=new></p>
<script src="http://cdnjs.cloudflare.com/ajax/libs/xregexp/2.0.0/xregexp-min.js">
</script>
<script src="http://xregexp.com/addons/unicode/unicode-base.js">
</script>
<script>
var regex = new XRegExp("\\P{L}+", "g");
var string = document.getElementById('orig').innerHTML;
string = XRegExp.replace(string, regex, "");
document.getElementById('new').innerHTML = string;
</script> 
```

对于生产用途，您可能需要下载一些版本的基本包和 Unicode 插件并在您的服务器上使用它们。

注意：代码检查未分类为 Unicode 中字母（字母）的字符。我想这与您所说的“单词字符”相对应，尽管自然语言中的单词可能包含连字符、撇号和其他非字母。

请注意，字符会添加到 Unicode 中，并且字符的类别可能（很少）发生变化。不过，该软件包维护得很好；它对应于 Unicode 6.1（6.2 版已经发布，但没有新字母）。

# algorithm - 基于列标准的累积和的单独矩阵（MATLAB）

> ID：13209805
> 
> 赞同：0
> 
> 时间：2012-11-03T13:53:13.720
> 
> 标签：algorithm, matlab, sorting

我有一个类似于以下的数据集：

```
a = [1 11; 2 16; 3 9; 4 13; 5 8; 6 14]; 
```

我希望通过以下标准分成几个矩阵：从第一列开始，构造第二行的总和在`19`-to-范围内的集合`25`。

所以输出会是这样的：

```
a1 = [1 11; 3 9]
a2 = [2 16; 5 8]
a3 = [6 14] 
```

其中a1=20，a2=24，a3 不满足条件，是最后一个。

这可以包含在 FOR 循环中并输出吗？

编辑：如何组合的标准：我希望从头开始（第一行）并添加到下一行。如果总和大于 25，则该行将被跳过，直到下一次迭代。每次迭代都应该输出一个单独的矩阵（a1，a2，a3）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T18:24:17.703

我想我有一些有用的伪代码给你。

一方面，我不会通过删除列来修改矩阵。相反，我会保留已用列的列表。

我会像这样使用求和：

```
used = false(1,num lines)
for i=1:num lines
  if used(i) continue
  curr_use = i
  for j=i+1
     if used(j) continue
     if cant_add(j) continue
     Concat j to curr_use
  end
  used(curr_use) = true
end 
```

# php - YII - 单元测试不起作用

> ID：13209812
> 
> 赞同：4
> 
> 时间：2012-11-03T13:53:50.317
> 
> 标签：php, unit-testing, yii

当我使用 YII 框架运行 PHP 单元测试时，出现以下错误：

```
PHP Fatal error:  Uncaught exception 'LogicException' with message 'Function 'phpunit_autoload' not found (function 'phpunit_autoload' not found or invalid function name)' in /var/www/yii/framework/YiiBase.php:628 
```

有谁知道如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T14:48:55.407

这是 YII CTestCase.php(yii/framework/test/CTestCase.php) 的问题。有一个解决方案，现在它就像一个魅力。这里是：

利用：

```
require_once('PHPUnit/Runner/Version.php');
require_once('PHPUnit/Autoload.php'); 
```

代替：

```
require_once('PHPUnit/Util/Filesystem.php'); // workaround for PHPUnit <= 3.6.11
require_once('PHPUnit/Autoload.php');
spl_autoload_unregister('phpunit_autoload');
Yii::registerAutoloader('phpunit_autoload'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T18:41:19.210

该错误在 Yii 1.1.13 中得到修复

请参阅此 Github 问题： [https ://github.com/yiisoft/yii/issues/1563](https://github.com/yiisoft/yii/issues/1563)

这是 CHANGELOG 中的一行： [https ://github.com/yiisoft/yii/blob/1.1.13/CHANGELOG#L119](https://github.com/yiisoft/yii/blob/1.1.13/CHANGELOG#L119)

# android - 当 ListItem 中的项目处于保留状态时，如何膨胀上下文菜单？

> ID：13209814
> 
> 赞同：2
> 
> 时间：2012-11-03T13:54:08.287
> 
> 标签：android, contextmenu, listitem

我的 Android 项目上有一个 ListView，当单击该项目时，它将转到“选定项目详细信息”活动。当一个项目被搁置时，我希望它膨胀或弹出一个上下文菜单，就像某些音乐播放器列表中的那个一样。我不知道应该重写哪个事件方法来捕获该 listItem 的 onHold 事件。请有人给我指路。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T14:17:51.453

你应该设置你`ListView`的[`OnItemLongClickListener`](http://developer.android.com/reference/android/widget/AdapterView.OnItemLongClickListener.html).

如果您正在使用，在选择项目时`ActionBar`设置它也很好。如需快速教程，您可以查看[Vogella 的列表教程](http://www.vogella.com/articles/AndroidListView/article.html)。`ActionBar`[`ActionMode`](http://developer.android.com/reference/android/view/ActionMode.html)`ActionMode`

# mysql - 更新mysql中的日期列

> ID：13209815
> 
> 赞同：0
> 
> 时间：2012-11-03T13:54:25.727
> 
> 标签：mysql, adapter

我正在努力更新 mysql 中的日期格式。在此之前，虽然使用适配器从 Mysql（使用 netbeans）检索日期，但格式是这样的

**"Birth_Date": "1990-10-11T00:00:00.000Z",**

现在我想将 Birthdate 列修改为 **1990-10-11**

我不想要其余的性格..指导我如何实现这一目标

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T13:58:32.143

实际上，我认为您无法更改 MySql 存储日期类型的方式。

[这是](http://cookbooks.adobe.com/post_Format_dates_stored_in_MySQL-16641.html)一篇关于它的好文章

> MySQL 仅以一种格式存储日期和时间戳：YYYY-MM-DD hh:mm:ss。这是国际标准化组织 (ISO) 推荐的格式。

相反，您可以做的是在执行 select 语句时使用`Date_Format`

```
SELECT DATE_FORMAT(birthDate, '%Y %m, %d') AS reg_formatted FROM yourtable 
```

在上一个链接上，您拥有所有可能的格式

# objective-c - 我要区分 b2Body

> ID：13209817
> 
> 赞同：1
> 
> 时间：2012-11-03T13:55:02.713
> 
> 标签：objective-c, cocos2d-iphone, objective-c++, game-physics, box2d-iphone

我在 World 中有很多带有 Box2d.(B2Body) 的尸体。我想区分这个身体。

例如我有

```
b2Body *ball;
b2Body *person1;
b2Body *person2;
b2Body *Person3; 
```

我要打哪个人的球？

这个 b2body 有**id**、**name**或其他东西来区分吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T14:41:46.270

您可以只使用`==`运算符，例如：

```
void ContactListener::PostSolve(b2Contact* contact, b2ContactImpulse* impulse) {
    b2Body *bodyA = contact->GetFixtureA()->GetBody();
    b2Body *bodyB = contact->GetFixtureB()->GetBody();

    if ((bodyA == ball && bodyB == person1) || (bodyB == ball && bodyA == person1)) {
        // do something
    }
} 
```

或者您也可以使用`b2Body`用户数据（但您需要确保为所有主体分配同一类的用户数据：

```
void ContactListener::PostSolve(b2Contact* contact, b2ContactImpulse* impulse) {
    BodyUserData *bodyA_data = (BodyUserData *)contact->GetFixtureA()->GetBody()->GetUserData();
    BodyUserData *bodyB_data = (BodyUserData *)contact->GetFixtureB()->GetBody()->GetUserData();

    if ((bodyA_data.type == TYPE_BALL && bodyB_data == TYPE_PERSON1) || (bodyB_data.type == TYPE_BALL && bodyA_data == TYPE_PERSON1)) {
        // do something
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T16:09:36.947

谢谢@Lukman。这是正确的。我在我的代码中添加了

这段代码->>>>>

```
- (void)beginContact:(b2Contact *)contact {

    b2Body *bodyB = contact->GetFixtureB()->GetBody();
    b2Body *bodyB = contact->GetFixtureB()->GetBody();

    if ((bodyA == ball && bodyB == person1) || (bodyB == ball && bodyA == person1)) 
    {
        // do something

        [[SimpleAudioEngine sharedEngine] playEffect:@"whine.wav"];

    }
} 
```

# java - 给定旋转角度，如何计算圆柱“顶部”圆心？

> ID：13209832
> 
> 赞同：8
> 
> 时间：2012-11-03T13:57:10.433
> 
> 标签：java, math, 3d, geometry, java-3d

我有一个长度为 2f 的圆柱体，以及用户给出的 RotX 和 RotZ 的数据。我也知道我的圆柱体的“底部”位于（0,0,0）（形成“底部”的圆的中心）

我需要的是计算“顶部”点（另一端的圆心），将数据暴露在上面的行中。

在我的第二张图片中，A 点的计算方式如下 (sin(zAngle),cos(zAngle),sin(xAngle)，其中 zAngle=PI/4（α 角）和 xAngle=0。
点 B 计算为 (sin( xAngle),cos(xAngle),sin(zAngle)) 其中 xAngle=PI/4（β 角）和 zAngle=0；
C 点是圆柱的“顶部”，其中 xAngle=PI/4 和 zAngle=PI/4 .
我需要找到一种算法来确定任何给定 xAngle 和 zAngle 的“顶”点。

如果有人可以帮助我，我将非常感激。

![RotZ 和 RotX 解释](../Images/7533103b8ddb1b35089d15bc75727b2a.png) ![例子](../Images/93f292f514d9cd699588e12bb7248492.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T21:11:57.837

在旋转之前，顶部位于 2f*(0,1,0)。

围绕 z 轴将圆柱体旋转角度 alpha 后，顶部位于 2f*(sin alpha, cos alpha, 0)。

如果您现在将圆柱体绕 x 轴旋转角度 beta，则顶部变为 2f*(sin alpha, cos alpha*cos beta, cos alpha*sin beta)。

# java - 从字符串实例化 BigDecimal 的最快方法

> ID：13209833
> 
> 赞同：3
> 
> 时间：2012-11-03T13:57:10.777
> 
> 标签：java, performance, instantiation, bigdecimal

考虑一个应用程序

1.  `String`从文本文件中读取数千个值。
2.  选择（通过正则表达式匹配）那些表示数字的值（从简单的整数到用尾数用科学计数法编写的非常大的值）。
3.  对于表示数字的每个`String`值，实例化一个`BigDecimal`对象（以每秒数千个 Bigdecimal 对象的总速率）。
4.  使用每个实例化`BigDecimal`的对象进行进一步处理。

鉴于上述情况，显然每个`BigDecimal`对象的实例化都会对性能产生影响。

`BigDecimal`从非空 String实例化这些对象的一种方法`str`是：

```
BigDecimal number = new BigDecimal(str.toCharArray(), 0, str.length())); 
```

这正是[BigDecimal 的 String 构造](http://docs.oracle.com/javase/6/docs/api/java/math/BigDecimal.html#BigDecimal%28java.lang.String%29)`Oracle`函数在`JDK`.

有没有更快的方法`BigDecimal`从这些字符串中实例化对象，或者通过另一种方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-03T14:32:54.833

我会用

```
BigDecimal number = new BigDecimal(str); 
```

哪个更简单，并且差异不太重要。

如果您需要性能并且不需要超过 15 位的准确度，则可以使用`double`。

您需要性能我会在微优化之前查看整个应用程序的性能。您提到使用正则表达式，这可以使用比创建字符串或 BigDecimal 更多的 CPU。你能描述你的应用程序吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-03T14:54:23.960

我同意差异不太可能重要，但是我会使用[valueOf](http://docs.oracle.com/javase/7/docs/api/java/math/BigDecimal.html#valueOf%28double%29)，因为未来的 java 版本可能会缓存很多常见的数字。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-26T20:12:42.240

如果有很多可能相同的数字，那么值的`HashMap<String, BigDecimal>`“缓存”`BigDecimal`可能会更快。

# objective-c - 将数据传输回原始视图

> ID：13209835
> 
> 赞同：1
> 
> 时间：2012-11-03T13:57:25.410
> 
> 标签：objective-c, ios, xcode, data-transfer

所以我能够将数据从第一个视图传输到第二个视图，如下所示：

```
- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
{
   if ([segue.identifier isEqualToString:@"Check Mark Segue"])
      {
        NSLog(@"Transfering Data");
        AutoRenewDrop *controller = segue.destinationViewController;
        controller.transferData = self.renewDate.text;
      }
} 
```

但是，当用户点击完成并且 transferData 工作正常但 renewDate.text 没有改变时，我尝试将新值传输回 renewDate.text 。这是我用来传回数据的代码：

```
-(IBAction)done:(UIStoryboardSegue *)segue {

[self.navigationController popViewControllerAnimated:YES];
AddR *add = [[AddR alloc] init];
add.renewDate.text = transferData;

} 
```

有人可以告诉我如何解决这个问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-03T14:18:59.707

您需要将包含第一个视图引用的属性添加到第二个视图中：

```
@interface AutoRenewDrop
@property(weak, nonatomic) AddR *callerView;
@end 
```

然后在第二个视图的 done 方法中，您可以在调用者视图中更新变量：

```
-(IBAction)done:(UIStoryboardSegue *)segue {
[self.navigationController popViewControllerAnimated:YES];
callerView.renewDate.text = transferData;
} 
```

当然，当您实例化第二个视图时，您必须以这种方式设置引用：

```
- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
{
   if ([segue.identifier isEqualToString:@"Check Mark Segue"])
      {
        NSLog(@"Transfering Data");
        AutoRenewDrop *controller = segue.destinationViewController;
        controller.transferData = self.renewDate.text;
        controller.callerView = self; //Here, you are passing the reference to this View
      }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T14:23:22.847

您应该使用委托。[您可以在此处](http://www.theappcodeblog.com/2011/04/15/passing-data-between-views-tutorial-using-a-protocol-delegate-in-your-iphone-app/)阅读有关协议和委托的非常好的教程。

假设您有 2 个 ViewController - VC1 和 VC2，假设 VC1 显示 VC2。

在 VC2.h

```
@protocol VC2Delegate <NSObject>
- (void)updateData:(id)theData;
@end

@interface
@property (nonatomic, weak) id<VC2Delegate> delegate;
@end 
```

在 VC2.m

```
@syntesize delegate;

- (void)done
{
    [delegate updateData:myData];
} 
```

在 VC1.h

```
@interface VC1 : UIViewController<VC2Delegate> 
```

在 VC1.m

```
- (void)goToVC2
{
    VC2 *vc2 = [[VC2 alloc] init];
    vc2.delegate = self;
    // present vc2
}

- (void)updateData:(id)data
{
    // update what you need
} 
```

# c# - c# json读取没有发生

> ID：13209846
> 
> 赞同：0
> 
> 时间：2012-11-03T13:58:42.330
> 
> 标签：c#, json, file

这不起作用（文件存在，读取正常，然后没有任何循环触发）而且我不知道为什么..

```
if (File.Exists("my.json"))
{
    var response = System.IO.File.ReadAllText("my.json");
    var domains = JsonConvert.DeserializeObject<List<jsonRead>>(response);
    foreach (jsonRead domain in domains)
    {
        MessageBox.Show(domain.Password);
        var folders = JsonConvert.DeserializeObject<List<jsonReadDeep>>(domain.Folders);

        foreach (jsonReadDeep folder in folders)
        {
            MessageBox.Show(folder.localServer);                    
        }
    }
} 
```

班级

```
class jsonRead
{
    public string Folders;
    public string Name;
    public string User;
    public string Password;
    public string Url;
}

class jsonReadDeep
{
    public string localFolder;
    public string serverFolder;
} 
```

json

```
[   
  {
    "Folders": [
      {
        "localFolder": "C:\\test",
        "serverFolder": "Default/"
      }
    ],
    "Name": "hi",
    "User": "there",
    "Password": "secret",
    "Url": "https://mydomain.com"
  } 
] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T14:10:58.517

您应该定义`jsonRead`如下：

```
class jsonRead
{
    public jsonReadDeep[] Folders;
    public string Name;
    public string User;
    public string Password;
    public string Url;
} 
```

你的代码：

```
var response = System.IO.File.ReadAllText("my.json");
var domains = JsonConvert.DeserializeObject<List<jsonRead>>(response);

foreach (jsonRead domain in domains)
{
    MessageBox.Show(domain.Password);

    foreach (jsonReadDeep folder in domain.Folders)
    {
        MessageBox.Show(folder.localFolder);
    }
} 
```

# ruby-on-rails - rails + omniauth：检查基本信息

> ID：13209848
> 
> 赞同：0
> 
> 时间：2012-11-03T13:59:04.130
> 
> 标签：ruby-on-rails, ruby, facebook, authorization, omniauth

这是我授权后获取用户基本信息的代码：

```
basic_info = request.env['omniauth.auth'].extra.raw_info

first = basic_info.first_name
last = basic_info.last_name 
email = basic_info.email 
id = basic_info.id 
```

四个变量获取数据，所以它起作用了。
但是当我尝试`basic_info.inspect`命令时，我得到：

> “#”

这是为什么？它不应该转储所有值吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T22:48:10.987

就像 Singh 在他的评论中建议的那样，您应该使用该`to_yaml`方法来查看嵌套散列的散列中的内容。我通常将以下代码放在适用的控制器中：

```
raise request.env['omniauth.auth'].to_yaml 
```

现在，当尝试登录控制器时，只会呈现 yaml。

编辑：现在 Rails 4 使用了 better_errors gem，这种检查omniauth 哈希的方法不再那么有效。现在更好的方法是：

```
render :text => "<pre>" + env["omniauth.auth"].to_yaml and return 
```

# java - 如何在 JButton 边框内放置 ImageIcon

> ID：13209850
> 
> 赞同：3
> 
> 时间：2012-11-03T13:59:18.880
> 
> 标签：java, swing, icons, border, jbutton

我想为一些 JButton 着色，这里向我展示了一些其他问题，画一个小图像（用 gimp 完成）并将其设置为 JButton 的图标会更容易。

按钮的数量和大小应该是可变的（它们在网格中），所以我想要一个高分辨率图像，我可以根据需要缩放它。

现在的问题是，我不知道如何“切割”图标的边缘，因为按钮的边缘是圆角的。

![图片不在按钮的边框内](../Images/684dda3f66f657ba5e1c818809781aab.png)

在这里您可以看到图像不在按钮边框内。

这是我在扩展 JButton 的类中的方法。

```
public void setYellow() {
    URL u = getClass().getResource("/img/yellow.png");
    ImageIcon i = new javax.swing.ImageIcon(u);
    //Image img = i.getImage();
    //img = img.getScaledInstance(size, size, java.awt.Image.SCALE_SMOOTH); 
    //i = new ImageIcon(img);
    setIcon(i);
} 
```

**编辑**

```
package test;
import java.awt.Dimension;
import java.awt.GridLayout;
import java.awt.Image;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.net.URL;
import javax.swing.ImageIcon;
import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JLabel;
import control.Control;
import view.Field;
import view.View;

public class HelloWorldSwing {

  /**
     * @param args
     */
    public static void main(String[] args) {
        javax.swing.SwingUtilities.invokeLater(new Runnable() {
            public void run() {
                TestView.initialize();
            }
        });
    }    

}

class TestView {
private static TestView view = new TestView();
public static TestView getView() {
    return view;
}

private TestView() {
    JFrame frame = new JFrame("HelloWorldSwing");
    frame.setLayout(new GridLayout(0,3));
    int buttonSize = 40;

    frame.getContentPane().add(new MyButton(buttonSize));
    frame.getContentPane().add(new MyButton(buttonSize));
    frame.getContentPane().add(new MyButton(buttonSize));

    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    frame.pack();
    frame.setVisible(true);
}

public static void initialize() {
}
}

class MyButton extends JButton {

int size;
public MyButton(int size) {
    this.size = size;
    setPreferredSize(new Dimension(size, size));
    this.addActionListener(new ButtonHandler());
    setBorder(LineBorder.createGrayLineBorder());
    setOpaque(true);
}

public void setYellow() {
    //URL u = getClass().getResource("/img/test.png"); // 64x64 png pic
        URL u1 = null;
    try {
        u1 = new URL("http://assets1.qypecdn.net/uploads/users/0195/7210" 
                       + "/calvin_yellow_original_thumb.jpg");         
    } catch (MalformedURLException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }
    ImageIcon i = new javax.swing.ImageIcon(u1);
//      Image img = i.getImage();
//      img = img.getScaledInstance(size, size, java.awt.Image.SCALE_SMOOTH); 
//      i = new ImageIcon(img);
    setIcon(i);
//      setBorderPainted(false);
//      setContentAreaFilled(false); did not help
}
}

class ButtonHandler implements ActionListener {

@Override
public void actionPerformed(ActionEvent e) {
    MyButton mb = (MyButton) e.getSource();
    mb.setYellow();
}
} 
```

**编辑 2**

这是 setYellow() 中的线条的图片

```
setBorderPainted(false);
setContentAreaFilled(false); 
```

没有被注释掉（不幸的是没有区别）

单击按钮之前：

![在此处输入图像描述](../Images/ded46a54f5334bedea29cc5b8355336c.png)

点击按钮后：

![在此处输入图像描述](../Images/89740ab6794af212b10ee80ad4dcd932.png)

**更新**

我在 MyButton 构造函数中添加了边框

```
setBorder(LineBorder.createGrayLineBorder()); 
```

现在图标位于按钮边框内。我添加了图片。

![在此处输入图像描述](../Images/db175eaed1265faf2c55e8e90f7f2620.png)

![在此处输入图像描述](../Images/518bf8bfb861be50a8eee88e3da8944d.png)

但是正如你所看到的，我们不再有这些圆形按钮边缘了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T14:14:45.877

```
button.setBorderPainted(false);
button.setContentAreaFilled(false); 
```

正如在[这个答案](https://stackoverflow.com/a/6743726/418556)中看到的那样。

![](../Images/e70015c172a5705298550149241e0629.png)

## 更新

如果不是这个，我不太明白你想要达到的目标。

![12 个带橙色翻转图标的黄色按钮](../Images/0ed36044f06e180520975c95fb5fd1f5.png)

我将翻转图标设置为橙色，以便我们可以轻松看到一个按钮的大小，但除此之外，我将 4 个放在一行中，以确保最小框架宽度不会在一行按钮之间插入额外的空间。

```
import java.awt.*;
import java.awt.Image;
import java.awt.event.*;
import java.awt.image.BufferedImage;
import javax.swing.*;

public class HelloWorldSwing {

    public static void main(String[] args) {
        javax.swing.SwingUtilities.invokeLater(new Runnable() {
            public void run() {
                TestView.getView();
            }
        });
    }    
}

class TestView {

    private static TestView view = new TestView();

    public static TestView getView() {
        return view;
    }

    private TestView() {
        JFrame frame = new JFrame("HelloWorldSwing");
        frame.setLayout(new GridLayout(3,4));
        int buttonSize = 40;

        for (int i=0; i<12; i++) {
            frame.getContentPane().add(new MyButton(buttonSize));
        }

        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.pack();
        frame.setVisible(true);
    }

    public static void initialize() {
    }
}

class MyButton extends JButton {

    int size;

    public MyButton(int size) {
        this.size = size;
        setPreferredSize(new Dimension(size, size));
        this.addActionListener(new ButtonHandler());
        setOpaque(true);
        setYellow();
    }

    public Image getImage(int sz, Color color) {
        BufferedImage bi = new BufferedImage(sz,sz,BufferedImage.TYPE_INT_RGB);
        Graphics2D g = bi.createGraphics();
        g.setColor(color);
        g.fillRect(0, 0, sz, sz);

        g.dispose();
        return bi; 
    }

    public void setYellow() {
        Image img = getImage(64, Color.YELLOW).getScaledInstance(size, size, java.awt.Image.SCALE_SMOOTH); 
        setIcon(new ImageIcon(img));
        Image rollover = getImage(64, Color.ORANGE).getScaledInstance(size, size, java.awt.Image.SCALE_SMOOTH);
        setRolloverIcon(new ImageIcon(rollover));
        setBorderPainted(false);
        setContentAreaFilled(false); 
    }
}

class ButtonHandler implements ActionListener {

    @Override
    public void actionPerformed(ActionEvent e) {
        MyButton mb = (MyButton) e.getSource();
        mb.setYellow();
    }
} 
```

# c++ - 如何正确地对程序进行版本控制？

> ID：13209853
> 
> 赞同：6
> 
> 时间：2012-11-03T13:59:35.163
> 
> 标签：c++, winapi, visual-c++, visual-studio-2012, version

我总是看到程序说诸如，之类`Version: 1.5.6`的东西。我的问题是，如何正确确定版本？

我是一名 C++ 程序员，所以我认为这很重要。我还使用 Visual Studio Ultimate 2012。

编辑：如何在代码中添加版本？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T14:06:42.540

没有真正的标准或任何东西，但这是一般做法：

*   最左边的数字代表“最重要”的数字，这意味着当软件更改很多时它会增加，总是在发生重大更改时。

*   最右边的数字代表“最次要”的数字，这意味着每次发布程序时它都会增加。这对于错误修复之类的更改很有用。

*   中间的数字简单地涵盖了中等重要性的变化，例如非破坏性的，但像主要错误修复这样的大变化。

*   每当更改数字时，右侧的数字将重置为 0

*   1.X 标志着第一个可用版本，0.X 可以看作是 beta/alpha 版本

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-03T16:29:38.263

通常，您将版本放在项目的.rc 中的[VersionInfo](http://msdn.microsoft.com/en-us/library/windows/desktop/aa381058%28v=vs.85%29.aspx)记录中，这样系统就会知道版本号，例如在复制文件时。

如果您还需要程序中的版本号，那么最简单的方法是创建一个标头，您已在其中定义了版本号

```
#define VER_FILEVERSION             1,0,0,0
#define VER_FILEVERSION_STR         "1.0.0.0\0"

#define VER_PRODUCTVERSION          1,0,0,0
#define VER_PRODUCTVERSION_STR      "1.0\0" 
```

然后将该标头包含在 .rc 文件以及您需要的文件中。

# toad - 在 Toad Data Modeler 中将主键更改为外键

> ID：13209854
> 
> 赞同：0
> 
> 时间：2012-11-03T13:59:43.087
> 
> 标签：toad

我在 Toad Data Modeler 4.3 中对 MySQL 数据库进行了逆向工程，但没有导入外键。

将主键更改为外键的最简单方法是什么？

我知道的唯一方法是创建新的外键并删除旧的外键，但我想知道是否有更好的方法，尤其是字段名称相同的情况下（例如 UserID 是 Users 表中的主键，UserID 是外键来自模板表中的用户的键）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-09T08:49:43.963

最简单的方法是使用 SQL。这样的事情应该为你做：

```
ALTER TABLE Templates
ADD CONSTRAINT <name of foreign key> FOREIGN KEY (UserID )
REFERENCES Users (UserID ); 
```

# jpa-2.0 - 在 XA 事务中执行工作

> ID：13209856
> 
> 赞同：0
> 
> 时间：2012-11-03T13:59:58.740
> 
> 标签：jpa-2.0, eclipselink, jta

我有一种情况，我需要在全局 tx 中执行一些工作。

出于这个原因，我在我的 persistence.xml 中定义了以下 PersistenceUnit 来获得一个 jta entityManager。

```
<persistence-unit name="resubEclipselink" transaction-type="JTA">
    <jta-data-source>jdbc/XADataSource</jta-data-source>
    ...
</persistence-unit> 
```

现在坚持下去，我尝试按照以下步骤进行＃1：

```
 if(isXA()){
        mXAEntityManager.persist(entity);
        mXAEntityManager.flush(); 
    } 
```

事情因异常而失败

```
javax.persistence.TransactionRequiredException: 
Exception Description: No transaction is currently active
    at       
org.eclipse.persistence.internal.jpa.transaction.EntityTransactionWrapper.throwCheckTransactionFailedException(EntityTransactionWrapper.java:113) 
```

在继续之前开始用户事务时，我得到了同样的原因。

所以我尝试了另一种方法#2：

```
// get the transactional unit of work or null.
UnitOfWork uow = mEntityManager.getUnitOfWork();
    uow.registerObject(entity);
uow.writeChanges(); 
uow.commit(); 
```

这种工作，但我不确定这是否是正确的方法。

如果有人可以帮助我解决为什么在第一种情况下无法正常工作以及第二种方法是否可行，我将不胜感激？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T15:59:11.673

第一种方法应该可以工作，配置设置可能会丢失告诉 Eclipselink 事务。检查您是否指定了此处描述的目标服务器属性 [http://eclipse.org/eclipselink/documentation/2.4/jpa/extensions/p_target_server.htm](http://eclipse.org/eclipselink/documentation/2.4/jpa/extensions/p_target_server.htm) 因为这将用于获取事务管理器并注册活动事务。

一旦在事务中正确注册，就不需要直接在 UnitOfWork 上调用 commit。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T04:54:19.857

我假设在您的代码中，您之前以 SE 方式实例化了 mXAEntityManager，如下所示：

> EntityManagerFactory entityManagerFactory = Persistence.createEntityManagerFactory("resubEclipselink");
> 
> EntityManager mXAEntityManager = entityManagerFactory.createEntityManager();

这在部署在应用程序服务器中的 EE 应用程序中不起作用。您应该像这样用依赖注入替换这两行：

> @PersistenceContext(unitName = "resubEclipselink")
> 
> 实体管理器 mXAEntityManager;

这样您就可以让容器注入一个持久性上下文 (mXAEntityManager) 以及您需要的所有事务管理。因此，不再需要 flush() no begin() no commit() 调用，只要您不弄乱已经设置为这样的默认值：

> @PersistenceContext(unitName = "resubEclipselink", type= PersistenceContextType.TRANSACTION)
> 
> 实体管理器 mXAEntityManager;

以及已经为您的会话 bean 设置的另一个默认值，如下所示：

> @TransactionAttribute(TransactionAttributeType.REQUIRED)

请记住，这些默认值使得开发 EE 应用程序遵循范式“异常配置”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-05T07:29:34.550

我的场景以我需要根据其他一些条件决定事务边界的方式运行。

所以基本上我需要让我的应用程序管理的实体管理器登记到全局 tx 并执行一些工作单元作为全局 tx 的一部分。所以我实际上得到了一个实体管理器并将其设置为使用 ExternalTransactionController。

```
 if(isXA){
                    this.mEntityManager = JpaHelper.getEntityManager(Persistence.createEntityManagerFactory(XA_PU).

                                            createEntityManager());

                    this.mServerSession = this.mEntityManager.getServerSession();
                    this.mServerSession.getLogin().setUsesExternalTransactionController(true);
                    this.mServerSession.getLogin().setUsesExternalConnectionPooling(true);
            }else{
                   this.mEntityManager = JpaHelper.getEntityManager(Persistence.createEntityManagerFactory(RESORUCE_LOCAL_PU).
                                                                                                                            createEntityManager());

                    this.mEntityTransaction = this.mEntityManager.getTransaction();
                    this.mServerSession = this.mEntityManager.getServerSession();
            } 
```

然后获取并执行工作单元...

```
 // get the transactional unit of work or null.
  UnitOfWork uow = mEntityManager.getUnitOfWork();

  // resource-local em
  if(uow == null){
          mEntityTransaction.begin(); 
          mEntityManager.persist(entity); 
          mEntityTransaction.commit();
  }else{                  
          uow.registerObject(entity);
          uow.writeChanges(); 
          uow.commit();                   
  } 
```

正如我之前提到的，我对这种方法不太有信心，因此如果有人可以对此进行审查并让我知道这种方法是否存在一些缺陷，我将非常感激......

# javascript - 我的代码中没有触发事件？

> ID：13209859
> 
> 赞同：0
> 
> 时间：2012-11-03T14:00:22.090
> 
> 标签：javascript, javascript-events

我正在尝试向 中添加一些事件侦听器`document`，但由于某种原因，它看起来`click`从未触发过该事件，因为从未调用过回调：

```
function NotJquery(element) {
    this.element = element;

    return this;
}

NotJquery.prototype.eventFired = function(event, callback) {
    console.log('in NotJquery prototype');
    return function (event, callback) {
        element.addEventListener(event, callback, true);
    };
};

var $ = function(element) {
    return new NotJquery(element);
};

function Test() {
}

Test.prototype.addListener = function() {
    console.log('in Test prototype');
    $(document).eventFired('click', function() {
        console.log('click event fired');
    });
};

(function() {
    var test= new Test();
    test.addListener();
}()); 
```

两个消息：“在测试原型中”和“在 NotJquery 原型中”都记录在控制台中，但是当我单击文档中的某个位置时，控制台中不会输出消息“单击事件触发”。我看不出我的代码有什么问题。有人有想法让它工作吗？

[http://jsfiddle.net/Nn3tZ/1/](http://jsfiddle.net/Nn3tZ/1/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T14:03:14.223

`element`未在您的`eventFired`函数中定义（但这不是唯一的问题）。这是一个最小的更新：

```
NotJquery.prototype.eventFired = function(event, callback) {
    var self = this; // <== Change 1 of 2

    console.log('in NotJquery prototype');
    return function () {
        self.element.addEventListener(event, callback, true);
    //  ^-- Change 2 of 2
    };
}; 
```

与其他一些语言（Java、C#）不同，在引用当前对象的属性时`this`不是**可选的。**另外，您在其中创建的函数`eventFired`没有 right `this`，所以这就是为什么我将它作为`self`然后`self`在生成的函数（这是一个*闭包*）中使用的原因。

另外，您正在传递`event`和`callback`进入`eventFired`，但随后*也在*生成的函数上声明它们（我根本不清楚为什么要在那里生成函数），因此您传递的那些`eventFired`永远不会被使用。

更多阅读*（在我贫血的博客上）*：

*   [*神话方法*](http://blog.niftysnippets.org/2008/03/mythical-methods.html)
*   [*你必须记住`this`*](http://blog.niftysnippets.org/2008/04/you-must-remember-this.html)
*   [*闭包并不复杂*](http://blog.niftysnippets.org/2008/02/closures-are-not-complicated.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-03T14:04:21.340

您的客户端代码需要这样的东西：

```
NotJquery.prototype.eventFired = function(event, callback) {
    this.element.addEventListener(event, callback, false);
}; 
```

工作演示：http: [//jsfiddle.net/Nn3tZ/2/](http://jsfiddle.net/Nn3tZ/2/)

# linux - Arch Linux KDE 不保存显示器设置

> ID：13209860
> 
> 赞同：4
> 
> 时间：2012-11-03T14:00:32.433
> 
> 标签：linux, kde, multiple-monitors

我正在尝试设置 2 台显示器。

我有 Radeon HD 4800，使用开源驱动程序。64位。当我在 KDE 中更改监视器设置时，它会更改，但是当我重新启动时：监视器将返回重复状态（尚未保存屏幕设置）。

这是我想要的设置： ![在此处输入图像描述](../Images/430468194dff92a1be760e84c5c0752d.png)

如何让系统在启动时自动使用这些设置？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-03T15:33:07.473

我解决了。在 /etc/X11 中制作了一个脚本 1920x2.sh。

```
xrandr --output DVI-0 --auto --output DVI-1 --auto --right-of DVI-0 
```

将此脚本添加到 Alt + F2：自动启动。也许不是最好的解决方案，但我工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-03T14:22:58.043

首先，运行 display in`console`并检查正在写的内容`stdout/stderr`。接下来是检查`xorg`日志。如果所有这些想法都不起作用，您可以手动编辑 conf 文件。当然，您也可以尝试`display settings`以 root 身份运行。

# php - 使用计算变量更新多行

> ID：13209864
> 
> 赞同：1
> 
> 时间：2012-11-03T14:01:04.170
> 
> 标签：php, pdo

table_calc 结构（最小化）是：

| 编号 | 值_1 | 值_2 |

行数在 70 到 250 之间或更多。

我想用其他计算（$value_update_1 和 2，...）产生的值更新“table_calc”中的字段，这些值应用于表中的字段不同。

在我在网页上使用表格并从那里更新表格之前。现在我想直接更新这些值，而不必在页面中使用它们，因为它应该可以工作。

我开始写下面的代码：

```
$stmt_update = $conn_bd->prepare('select * from table_calc');
$stmt_update->execute(array());
$result_stmt_update = $stmt_update->fetchAll();
foreach($result_stmt_update as $rrows_update) {
  $cal_id = $rrows_update[id];
  $cal_value_1 = $rrows_update['value_1'];
  $cal_value_2 = $rrows_update['value_2'];
}

$value_update_1 = 100.25;
$value_update_2 = 150.25;

$count_id = count($cal_id);
$stmt = $conn_bd->prepare('UPDATE table_calc SET value_1 = :value_1, value_2 = :value_2 WHERE id = :id');
$i = 0;
while($i < $count_id) {
  $stmt->bindParam(':value_1', '.$cal_value_1[$i].' * '.$value_update_2.');
  $stmt->bindParam(':value_2', '.$cal_value_2[$i].' * '.$value_update_1.');
  $stmt->bindParam(':id', $cal_id[$i]);
  $stmt->execute();
  $i++;
} 
```

但它不起作用

你能帮我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T14:15:09.057

我可以在您的代码中发现一些问题：

*   第 8 行：

    ```
    $cal_id = $rrows_update[id];
                            ^^ 
    ```

    你需要那里的报价。

*   在第 20 行，您将变量称为数组，但您没有在第 9-10 行将其设置为这样。
*   同样在第 20 行，您应该将最终值绑定到参数，而不是让 MySQL 对其进行评估。

所以更正的版本是：

```
$stmt_update = $conn_bd->prepare('select * from table_calc');
$stmt_update->execute(array());
$result_stmt_update = $stmt_update->fetchAll();
foreach ($result_stmt_update as $rrows_update) {
    //Added array push operators. To make them arrays.
    $cal_id[]      = $rrows_update["id"];
    $cal_value_1[] = $rrows_update['value_1'];
    $cal_value_2[] = $rrows_update['value_2'];
}

$value_update_1 = 100.25;
$value_update_2 = 150.25;

$count_id = count($cal_id);
$stmt     = $conn_bd->prepare('UPDATE table_calc SET value_1 = :value_1, value_2 = :value_2 WHERE id = :id');
$i        = 0;
while ($i < $count_id) {
    //Altered the binding so that you bind the final value.
    //Also changed to bindValue.
    $stmt->bindValue(':value_1', $cal_value_1[$i] * $value_update_2);
    $stmt->bindValue(':value_2', $cal_value_2[$i] * $value_update_1);
    $stmt->bindValue(':id', $cal_id[$i]);
    $stmt->execute();
    $i++;
} 
```

此外，在对数据库进行批量更改时，您可能需要使用**[Transactions](http://php.net/manual/en/pdo.transactions.php)**来确保所有更改都按预期注册。

# c++ - 如何指向另一个类中的向量？

> ID：13209865
> 
> 赞同：-2
> 
> 时间：2012-11-03T14:01:05.997
> 
> 标签：c++

我有一个包含向量的类，它还继承了另一个类：

```
class txtExt : public extention
{
private:
   string  openedFile_;
public:
   vector<string> txtVector; //the vector i want to call
}; 
```

我将向量填充到类中的方法中：

```
class Manager : public extention
{
   // there is some other code here that I know does work
   // and it calls this function:
   void organizeExtention(string filename, string ext)
   {
      if(ext == "txt")
      {
         txtExt txtExt;
         txtExt.txtVector.pushback(filename);
      }
   }
} 
```

这是我尝试调用向量的主要课程：

```
int main()
{
   // some code here that does previous operations like getting the path
   // and filling the vector

   // I've tried many ways of trying to call the vector
   // here is an example of one:
   vector<txtExt*> testVector;
   for(int i = 0; i < testVector.size(); ++i)
   {
      cout << testVector[i] << endl;
   }
   return 0;
} 
```

我有几个问题：

1.  我把向量叫错了吗？
2.  我的向量是空的吗？
3.  我是否必须使我的向量全局化，以便其他类可以看到它？

注意：我已经能够使用非常简单的 for 循环打印出加载向量的向量

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T14:12:43.530

好吧，正如已经说过的，您在发布的代码中有一些错误，您可能也有一些误解。但要回答所提出的问题，这

```
testVector[i]->txtVector 
```

是访问`txtVector`每个对象内部的`txtExt`对象的方法。

如果这对您不起作用，那是因为您的代码中存在其他错误/误解之一。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T14:05:38.440

总结一下：

**重读一本好 C++ 书籍的第一章（[The Definitive C++ Book Guide and List](https://stackoverflow.com/questions/388242/the-definitive-c-book-guide-and-list)），然后尝试修复你的程序并同时处理每个错误。**

您的代码中有几个错误。

*   首先，没有`<<`用于打印 txtExt* 类型实体的运算符。
*   即使是类型的对象`txtExt`也不能像那样打印。
*   此外，您创建的 testVector 是空的，因此没有 .size() 将为零，并且不会有循环。
*   你真的确定你喜欢从 'extension' 继承你的两个类吗？
*   你不能调用向量，你可以访问它。
*   公开一个数据成员（如向量）不是一个好主意。
*   调用与类同名的变量是一个非常糟糕的主意。

我很难猜测你的代码应该做什么。这是您需要了解的简单示例：

```
#include <iostream>
#include <vector>
#include <string>

class TxtExt 
{
public:
  std::vector<std::string> txtVector; 
};

int main(){
  TxtExt oneTxtExt;

  oneTxtExt.txtVector.push_back("hello");
  oneTxtExt.txtVector.push_back("world");
  for( auto &i : oneTxtExt.txtVector ){
    std::cout << i <<std::endl;
  }
} 
```

以下代码是正确的，但绝对没有效果。你也可以写`{}`：

```
{
  TxtExt TxtExt;
  TxtExt.txtVector.pushback(filename);
} 
```

您在这里创建一个新对象，然后推回它（顺便说一句，它被称为`push_back`），但随后该对象在作用域的末尾被销毁。另外，不要将对象命名为与类相同的名称，这会变得非常混乱。

# java - Java替换方法，用空字符替换

> ID：13209866
> 
> 赞同：31
> 
> 时间：2012-11-03T14:01:26.987
> 
> 标签：java, string

假设我有以下`String`格式：

`2.2`

我想用空格替换小数点，使其看起来像这样：

`22`

我该怎么做呢？我以为`replace`会成功的，但是当我这样尝试时：

`string.replace('.', '');`

我得到一个错误，`''`因为它应该不是一个字符。这是有道理的，那么我还能如何完成我想要的呢？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2012-11-03T14:02:59.297

如果您只是将单引号交换为双引号，这将起作用，因为空字符串是合法值，而不是“空字符”，并且存在重载`replace(CharSequence, CharSequence)`。请记住，这`CharSequence`是`String`.

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2012-11-03T14:02:37.007

尝试 ：

```
string.replace(".", ""); 
```

其他方法是使用`replaceAll`：

```
string.replaceAll("\\.",""); 
```

# c# - Mono for Android 从 HTML 网站获取表值

> ID：13209876
> 
> 赞同：0
> 
> 时间：2012-11-03T14:02:53.307
> 
> 标签：c#, android, html

我正在使用 MonoDevelop (Android C#)。有没有办法从指定 URL 的 HTML 表中获取值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T08:53:12.597

是的，您必须为此使用[HtmlAgilityPack](http://htmlagilitypack.codeplex.com/)，我制作了一个 android 版本，您可以根据需要使用它。

你可以在这里得到它：[https ://docs.google.com/folder/d/0ByhrKT_k_LiXMVNhazJOUTkwZXc/edit](https://docs.google.com/folder/d/0ByhrKT_k_LiXMVNhazJOUTkwZXc/edit)

# android - URL 类呈现 - 带有 next_page_token 的 Invalid_Request

> ID：13209882
> 
> 赞同：5
> 
> 时间：2012-11-03T14:03:42.733
> 
> 标签：android, google-maps, google-places-api, google-places

在我的 Android 应用程序中，用户可以选择他想看的地方的类别（咖啡厅、餐厅……）。

当我使用以下网址时，我从 google-places-api 获得带有 next_page_token 的结果：

```
https://maps.googleapis.com/maps/api/place/textsearch/json?query=cafe+in+Elfde-Liniestraat%2C+Hasselt%2C+Belgium&pagetoken=ClRHAAAAqYa7IpwMQH3q1DyinfsMnkuOaZg8wQrp0pvzarv13pwqruqT2YfaEry6v_d-L4d_TC13G6iHuPz-rc1KbI6XRE01rB5CuXcHISu-CI_CaKESEMUxSjHhHDNee4xbr2tPEZcaFPvO6xlRDjs-5AixyD9vamWwTGlU&sensor=true&key=<mykey> 
```

或这个网址：

```
https://maps.googleapis.com/maps/api/place/textsearch/json?pagetoken=ClRHAAAAqYa7IpwMQH3q1DyinfsMnkuOaZg8wQrp0pvzarv13pwqruqT2YfaEry6v_d-L4d_TC13G6iHuPz-rc1KbI6XRE01rB5CuXcHISu-CI_CaKESEMUxSjHhHDNee4xbr2tPEZcaFPvO6xlRDjs-5AixyD9vamWwTGlU&sensor=true&key=<mykey> 
```

我收到一个 INVALID_REQUEST。

这是我用来运行和获取结果的代码：

```
@Override
    protected ArrayList<String> doInBackground(String... params) {
        // When more then one category is selected, this character needs to be after it.
        final String DELIMITINGCHARACTER = "|";

        // Add all the categories to a variable to put later on in the URL.
        String myTypes = "";
        for (String category : params){
            // A category must be lowercase letters only.
            category = category.toLowerCase();
            // A category may not display a whitespace.
            // The whitespace(s) must be replaced with a '_'.
            category = category.replaceAll(" ", "_");

            myTypes += category + DELIMITINGCHARACTER;
        }   

        // Delete if the string ends with the delimitingcharachter the delimitingcharacter!
        if (myTypes.endsWith("|")){
            myTypes = myTypes.substring(0, myTypes.length() - 1);
        }

        ArrayList<String> myPointsOfInterest = new ArrayList<String>();
        try{ 
            String urlString;
            String urlData;
            //String urlApi = "&sensor=true&key=<myKey>"; // Key 1
            String urlApi = "&sensor=true&key=<myKey>"; // Key 2

            if (_txtFindLocation.getText().length() > 0){
                urlString = "maps.googleapis.com/maps/api/place/textsearch/json?";
                urlData = "query=" + URLEncoder.encode(myTypes, "UTF-8") + "+in+" 
                        + URLEncoder.encode(_txtFindLocation.getText().toString(), "UTF-8");
            }
            else{
                urlString = "maps.googleapis.com/maps/api/place/search/json?";
                urlData = "location=" + _myCurrentPosition.getLatitudeE6() / 1e6 + "," + _myCurrentPosition.getLongitudeE6() / 1e6
                        + "&radius=5000&types=" + URLEncoder.encode(myTypes, "UTF-8");
            }

            ArrayList<String> myJsonString = new ArrayList<String>();

            myJsonString.add(getDataOfUrl(urlString, urlData, urlApi, null));

            for (String jsonString : myJsonString){
                // Turn String into a JSON Object.
                JSONObject jsonPredictionsObject = new JSONObject(jsonString);

                String urlToken = jsonPredictionsObject.optString("next_page_token");

                if (urlToken != ""){
                    myJsonString.add(getDataOfUrl(urlString, urlData, urlApi, "&pagetoken=" + urlToken));
                }
            }
            Log.d("MainActivity", "size of myJsonString " + String.valueOf(myJsonString.size()));
            for (String jsonString : myJsonString){
                Log.d("MainActivity", jsonString);
                // Turn String into a JSON Object.
                JSONObject jsonPredictionsObject = new JSONObject(jsonString);

                // Get a JSON Array that is inside the JSON Object.
                JSONArray jsonPredictionsArray = jsonPredictionsObject.getJSONArray("results");

                for (int i = 0; i < jsonPredictionsArray.length(); i++){
                    jsonPredictionsObject = (JSONObject) jsonPredictionsArray.get(i);

                    final String name = jsonPredictionsObject.getString("name");
                    final String vicinity = jsonPredictionsObject.optString("vicinity").compareTo("") != 0 ? jsonPredictionsObject.optString("vicinity") : jsonPredictionsObject.optString("formatted_address");
                    final JSONObject geometryObject = jsonPredictionsObject.getJSONObject("geometry");
                    final JSONObject locationObject = geometryObject.getJSONObject("location");
                    final JSONArray typesArray = jsonPredictionsObject.getJSONArray("types");
                    final double latitude = locationObject.getDouble("lat");
                    final double longitude = locationObject.getDouble("lng");

                    String types = "";
                    for (int t = 0; t < typesArray.length(); t++){
                        String type = typesArray.getString(t);

                        type = type.toLowerCase();
                        type = type.replaceAll("_", " ");

                        types += type + " - ";
                    }

                    types = types.substring(0, types.length() - 2);

                    myPointsOfInterest.add(String.valueOf(latitude) + DELIMITINGCHARACTER + 
                            String.valueOf(longitude) + DELIMITINGCHARACTER + types + 
                            DELIMITINGCHARACTER + name + DELIMITINGCHARACTER + vicinity);
                }
            }
        }
        catch (IOException e){
            Log.e("Search points of interest", "GetPointsOfinterest: doInBackGround", e);
        }
        catch (JSONException e){
            Log.e("Search points of interest", "GetPointsOfinterest: doInBackGround", e);
        }

        return myPointsOfInterest;
    }

public String getDataOfUrl(String urlString, String urlData, String urlApi, String urlToken){
    try{
        URL myURL;

        if (urlToken == null) {
            myURL = new URL("https://" + urlString + urlData + urlApi);
        }
        else {
            Log.d("URL INPUT", "https://" + urlString + urlData + urlToken + urlApi);
            myURL = new URL("https://" + urlString + urlData + urlToken + urlApi);
        }

        URLConnection myURLConnection = myURL.openConnection();         
        BufferedReader myBufferReader = new BufferedReader(new InputStreamReader(myURLConnection.getInputStream()));

        String strLine;
        StringBuffer strBuffer = new StringBuffer();
        // Take Google's legible JSON and turn it into on big String.
        while((strLine = myBufferReader.readLine()) != null){
            strBuffer.append(strLine);
        }           
        Log.d("URL OUTPUT", strBuffer.toString());
        return strBuffer.toString();
    }
    catch (IOException e){
        Log.e("getDataOfUrl", "Error: ", e);
    }

    return null;
} 
```

这是 logcat 的输出：

```
11-03 14:47:13.832: D/URL OUTPUT(19532): {   "html_attributions" : [],   "next_page_token" : "ClRHAAAAqYa7IpwMQH3q1DyinfsMnkuOaZg8wQrp0pvzarv13pwqruqT2YfaEry6v_d-L4d_TC13G6iHuPz-rc1KbI6XRE01rB5CuXcHISu-CI_CaKESEMUxSjHhHDNee4xbr2tPEZcaFPvO6xlRDjs-5AixyD9vamWwTGlU",   "results" : [      {         "formatted_address" : "Meldertstraat 42, Hasselt, België",         "geometry" : {            "location" : {               "lat" : 50.9311660,               "lng" : 5.3423240            }         },         "icon" : "http://maps.gstatic.com/mapfiles/place_api/icons/cafe-71.png",         "id" : "e6ba73e5b439dddb83aaefc94c71954da0cb0268",         "name" : "Café Café",         "rating" : 4.40,         "reference" : "CnRpAAAAdVZpUI4NKwsAiQTOjbYG9psNbU7awZkS6_8Ee4r3AvCKhpqWeiDqdof7zYmoUZWKj0A8rOwtncSa1YFVNNo6RxFmmHvuNdWCaucTqkuSSDw8E2o0pf5E6EiMj-7-Hd5xBzDtC0j9d5lLcVWW3AQy1xIQRwgfWwrZkyK65blCeGqhFhoUB9kTW5QVD9sNNuF75MvVewYTcxA",         "types" : [ "cafe", "food", "establishment" ]      },      {         "formatted_address" : "Kempischesteenweg 27, Hasselt, België",         "geometry" : {            "location" : {               "lat" : 50.9350770,               "lng" : 5.3397760            }         },         "icon" : "http://maps.gstatic.com/mapfiles/place_api/icons/cafe-71.png",         "id" : "dc66d311b3c4f5d1a87d5959dfdbc7616ad10b24",         "name" : "Oberonn",         "opening_hours" : {            "open_now" : true         },         "reference" : "CnRlAAAA5q-rz_aOTWsFGQIJz_6zyLbXIczXOTq4PVFxniOjxsCwnw7uIfY8tu7Jk-QbJ-arMWgdClnSpX28q2SqxD8021LGWcaf4Sgo9MaXWpoD6c4TSagyVO9_l_HUXgMoOFJzhHG_NH6z-t1DPxT1zD19PhIQ2gBP9cLazKeB96ZDTpFdsxoUVGB2Ddhrq6JUoTJgrHGL-SINOWk",         "types" : [ "cafe", "food", "establishment" ]      },      {         "formatted_address" : "Willekensmolenstraat 41, Hasselt, België",         "geometry" : {            "location" : {               "lat" : 50.9316830,               "lng" : 5.3470750            }         },         "icon" : "http://maps.gstatic.com/mapfiles/place_api/icons/cafe-71.png",         "id" : "04937541c2bf71ebec7ac13d506dbbd2727e1ce3",         "name" : "Den Drossaerd",         "reference" : "CnRqAAAA0cPmuMx0_J4x-o-yn0oT1D3kD-IHYAQPotAPPeDD3DWh2FXkD89kCsYoUGDLBlH2mKY6ju18JyCHvc4W_izLcd6TUOIoXrbUCyrtxOL4sTAFb41kH1aFT4dOBgvigYrGIcV8Qbzq-K4YGL3t7pnf1hIQKmUp-LLqtGHb4waYi2nq8hoU3VgwykpytoSUUPe2Ue1HmPrMRtE",         "types" : [ "cafe", "food", "establishment" ]      },      {         "formatted_address" : "Leopoldplein 1, Hasselt, België",         "geometry" : {            "location" : {               "lat" : 50.9275810,               "lng" : 5.3363830            }         },         "icon" : "http://maps.gstatic.com/mapfiles/place_api/icons/lodging-71.png",         "id" : "cc30d6f4e6b0db1ed6dfd17bac118bbf78f194ae",         "name" : "Century (Hotel)",         "rating" : 3.80,         "reference" : "CnRsAAAAfw4ucOBllDjMCtRU9epYQelpKHRx3u8JR8jr4I5jFzJsktNn3Un-3LjKKWtXCk3Unofi_6RhPFw9Tp8VU_Z7i-WOa00P-pirtCDjQPxg7sp470Mgh6_6PQspGG39H3k-VIMuUz9HWmoP3sPjump6SRIQTp1LZghfi-_HVaMfQArGPxoU-6ogK2IGMiueMEXP9mFiHlGJmo8",         "types" : [ "lodging", "establishment" ]      },      {         "formatted_address" : "Maastrichterstraat 30, Hasselt, België",         "geometry" : {            "location" : {               "lat" : 50.9295410,               "lng" : 5.3391230            }         },         "icon" : "http://maps.gstatic.com/mapfiles/place_api/icons/cafe-71.png",         "id" : "352f9da4642588aba419353487b210baeb30ddd3",         "name" : "In De Kleine Hal",         "reference" : "CnRuAAAAAlnMpdiL4Kluiw1T0-QgKWFv9wwWvrSY4w-B7SLI7gvpqT0FYaMTl6DhxncPLqRyxOTWxw3DP3r1XvNHDKXnAb3eRM-gZYwIqbvzVq62zEZgGw0usQgf48mAWOrDpegdNLnEFRYkIduRwlDMDyIOyBIQlDs9BozH4m_gE-dZKZf7yxoUqw0H_HT_IQnLaVm0YwG1QV7o3kg",         "types" : [ "cafe", "food", "establishment" ]      },      {         "formatted_address" : "Fruitmarkt 32, Hasselt, België",         "geometry" : {            "location" : {               "lat" : 50.9299760,               "lng" : 5.3393550            }         },         "icon" : "http://maps.gstatic.com/mapfiles

11-03 14:47:13.864: D/URL INPUT(19532): https://maps.googleapis.com/maps/api/place/textsearch/json?query=cafe+in+Elfde-Liniestraat%2C+Hasselt%2C+Belgium&pagetoken=ClRHAAAAqYa7IpwMQH3q1DyinfsMnkuOaZg8wQrp0pvzarv13pwqruqT2YfaEry6v_d-L4d_TC13G6iHuPz-rc1KbI6XRE01rB5CuXcHISu-CI_CaKESEMUxSjHhHDNee4xbr2tPEZcaFPvO6xlRDjs-5AixyD9vamWwTGlU&sensor=true&key=<myKey>

11-03 14:47:13.989: D/URL OUTPUT(19532): {   "html_attributions" : [],   "results" : [],   "status" : "INVALID_REQUEST"} 
```

PS：当我通过浏览器中的代码（使用 next_page_token）时，两种方式都是正确的，只有我的 Android 应用程序我没有得到有效数据。是的，我有一个 API 密钥，但我在这里从代码和我的 logcat 输出中删除了它。

有人知道我在这里做错了什么吗？

**编辑** 当我在 Android 中硬编码我的网址（带有下一页令牌）时，后记让它运行。我得到了我期望的数据，所以没有返回 Invalid_Request。问题在于在 Android 中构建 url 或 URL 类的使用。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-03T16:32:56.030

在我自己的问题上找到了答案：过了一会儿，我只需要更好地检查我的 logcat 输出。

请求的时间和从谷歌发回数据的时间。

*   请求1的输出时间：14:47:13:832

*   请求2的输入时间：14:47:13:864

*   请求2的输出时间：14:47:13:989

这些时间彼此接近，在我看来，谷歌认为我是垃圾邮件发送者/黑客或其他东西，并在第二次请求时拒绝我访问服务器。

我的解决方案是如果有 next_page_token 则等待 1 秒，然后发送后续请求。

# apache-camel - 使用文件作为单元测试的输入

> ID：13209889
> 
> 赞同：0
> 
> 时间：2012-11-03T14:04:27.380
> 
> 标签：apache-camel

我想我已经看到了一种优雅的方式来使用文件作为 apache camel 中单元测试的输入，但是我的谷歌技能让我失望了。

我想要的是而不是：

```
String xml = "<?xml version=\"1.0\" encoding=\"UTF-8\"?>" +
    <snip>...long real life xml that quickly fills up test files.</snip>";
template.sendBody("direct:create", xml); 
```

我想我看到的是类似的

```
template.sendBody("direct:create", someCamelMetod("/src/data/someXmlFile.xml")); 
```

任何人都知道在哪里/是否记录在案？

编辑：

*   交叉发布到[http://camel.465427.n5.nabble.com/Use-a-file-as-input-to-unit-tests-td5722069.html](http://camel.465427.n5.nabble.com/Use-a-file-as-input-to-unit-tests-td5722069.html)
*   我最终做的只是创建一个

    private void readFile(String fileName) throws ...函数

如果有人知道更好的方法，仍然很感兴趣。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-05T07:34:06.353

如果我正确理解您的问题，您希望将 xml 文件作为输入发送到您要测试的路线。我的解决方案是使用作为 Camel 测试支持的一部分的 advisorWith 策略。在这里阅读： http: [//camel.apache.org/testing.html](http://camel.apache.org/testing.html)

因此，假设正在测试的路线是这样的：

```
from("jms:myQueue")
   .routeId("route-1")
   .beanRef(myTransformationBean)
   .to("file:outputDirectory"); 
```

在您的测试中，您可以通过从文件轮询使用者替换它来将 xml 发送到此路由。

```
context.getRouteDefinitions().get(0).adviceWith(context, new AdviceWithRouteBuilder() {
   @Override
   public void configure() throws Exception {
       replaceRouteFromWith("route-1", "file:myInputDirectory");
   }
});
context.start(); 
```

然后，您可以将输入的 xml 文件放在 myInputDirectory 中，它将被拾取并用作路由的输入。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T20:39:50.177

不是真的，你必须自己做一些小工作。您知道，读取文本文件并不是那么简单，因为您可能想知道编码。在您的第一种情况（内联字符串）中，您始终使用 UTF-16。一个文件可以是任何东西，你必须知道它，因为它不会告诉你它是什么编码。鉴于您有 UTF-8，您可以执行以下操作：

```
public String streamToString(InputStream str){
   Scanner scanner = new Scanner(is, "UTF-8").useDelimiter("\\A"); 
   if (scanner.hasNext()) 
      return scanner.next(); 
   return "";
}

// from classpath using ObjectHelper from Camel.
template.sendBody("direct:create", streamToString(ObjectHelper.loadResourceAsStream("/src/data/someXmlFile.xml"))); 
```

# mingw - Clang++ 通过命令行工作，但不能通过 SublimeClang (Win8x64) 在 SublimeText 上工作

> ID：13209891
> 
> 赞同：3
> 
> 时间：2012-11-03T14:04:39.923
> 
> 标签：mingw, clang, sublimetext2

使用 MinGW 4.7.0，MSYS 编译的 Clang 3.2。

我通过自动安装程序/下载器获得了 MinGW，并按照以下说明构建了 Clang：http: [//bencode.net/clangonwindows](http://bencode.net/clangonwindows)

* * *

在 PowerShell 上调用“g++ --version”会返回：`enter code here`

在 PowerShell 上调用“clang -v”会返回：`clang version 3.2 (trunk 167353) Target: i686-pc-mingw32 Thread model: posix`

* * *

我创建了一个小测试文件来检查 clang 是否正常工作，“test.cpp”：

```
#include <iostream>

class clangIsCool
{
    public:
        int x;
        int y;
};

int main() 
{
    clangIsCool *c; 
    std::cout << c->x * 10;

    return 0;
} 
```

调用“clang++ test.cpp”没有错误。

* * *

然后我使用包控制为 SublimeText2 获得了 SublimeClang。

SublimeClang 可以在这里找到：[https ://github.com/quarnster/SublimeClang](https://github.com/quarnster/SublimeClang)

在 SublimeText2 中加载“test.cpp”并尝试编译给了我这些错误：

```
C:/MinGW/include\wctype.h:99,33 - Error - definition of variable with array type needs an explicit size or an initializer
C:/MinGW/lib/gcc/mingw32/4.7.0/include/c++\cwchar:145,11 - Error - no member named 'fgetws' in the global namespace
C:/MinGW/lib/gcc/mingw32/4.7.0/include/c++\cwchar:147,11 - Error - no member named 'fputws' in the global namespace
C:/MinGW/lib/gcc/mingw32/4.7.0/include/c++\cwchar:151,11 - Error - no member named 'getwc' in the global namespace
C:/MinGW/lib/gcc/mingw32/4.7.0/include/c++\cwchar:152,11 - Error - no member named 'getwchar' in the global namespace
C:/MinGW/lib/gcc/mingw32/4.7.0/include/c++\cwchar:157,11 - Error - no member named 'putwc' in the global namespace
C:/MinGW/lib/gcc/mingw32/4.7.0/include/c++\cwchar:158,11 - Error - no member named 'putwchar' in the global namespace
C:/MinGW/include\ctype.h:112,33 - Error - redefinition of '_ctype'
C:/MinGW/include\ctype.h:112,33 - Error - definition of variable with array type needs an explicit size or an initializer
C:/MinGW/include\ctype.h:117,34 - Error - redefinition of '_pctype_dll' 
```

我检查了 SublimeClang 的设置，这是 clang 使用的选项：

```
"options":
[
    "-isystem", "/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.7.sdk/usr/include/",
    "-isystem", "/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.7.sdk/usr/include/c++/4.2.1",
    "-F/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.7.sdk/System/Library/Frameworks/",
    "-isystem", "C:\\MinGW\\lib\\gcc\\mingw32\\4.7.0\\include",
    "-isystem", "C:\\MinGW\\lib\\gcc\\mingw32\\4.7.0\\include\\c++",
    "-isystem", "C:\\MinGW\\lib\\gcc\\mingw32\\4.7.0\\include\\c++\\mingw32",
    "-isystem", "C:\\MinGW\\include",
    "-Wall"
], 
```

我尝试弄乱包含路径（即使它们看起来对我来说是正确的），但错误仍然存​​在。

我应该在 SublimeClang 的选项中包含任何其他路径吗？

有没有办法查看默认情况下clang使用的路径（因为它可以从命令行工作），以便我可以将它们与默认的SublimeClang进行比较？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-17T10:25:52.067

我 从. `#include <iostream>`_ `__GNUC__=4`_`__GNUC_MINOR__=7``__MSVCRT__=1`

不幸的是， `#include <vector>`给我带来了一大堆其他错误：

```
C:/MinGW/lib/gcc/mingw32/4.7.0/include/c++\bits/alloc_traits.h:56,35 - Error - in-class initializer for static data member is not a constant expression
C:/MinGW/lib/gcc/mingw32/4.7.0/include/c++\bits/alloc_traits.h:86,24 - Error - type 'int' cannot be used prior to '::' because it has no members
C:/MinGW/lib/gcc/mingw32/4.7.0/include/c++\ext/alloc_traits.h:105,11 - Error - using declaration refers into '_Base_type::', which is not a base class of '__alloc_traits<int>'
C:/MinGW/lib/gcc/mingw32/4.7.0/include/c++\ext/alloc_traits.h:106,11 - Error - using declaration refers into '_Base_type::', which is not a base class of '__alloc_traits<int>'
C:/MinGW/lib/gcc/mingw32/4.7.0/include/c++\ext/alloc_traits.h:107,11 - Error - using declaration refers into '_Base_type::', which is not a base class of '__alloc_traits<int>'
C:/MinGW/lib/gcc/mingw32/4.7.0/include/c++\ext/alloc_traits.h:108,11 - Error - using declaration refers into '_Base_type::', which is not a base class of '__alloc_traits<int>'
C:/MinGW/lib/gcc/mingw32/4.7.0/include/c++\ext/alloc_traits.h:109,11 - Error - using declaration refers into '_Base_type::', which is not a base class of '__alloc_traits<int>'
C:/MinGW/lib/gcc/mingw32/4.7.0/include/c++\bits/stl_vector.h:81,16 - Error - base specifier must name a class
C:/MinGW/lib/gcc/mingw32/4.7.0/include/c++\bits/stl_vector.h:235,13 - Error - using declaration refers into '_Base::', which is not a base class of 'vector<int, std::allocator<int> >'
C:/MinGW/lib/gcc/mingw32/4.7.0/include/c++\bits/stl_vector.h:236,13 - Error - using declaration refers into '_Base::', which is not a base class of 'vector<int, std::allocator<int> >'
C:/MinGW/lib/gcc/mingw32/4.7.0/include/c++\bits/stl_vector.h:237,13 - Error - using declaration refers into '_Base::', which is not a base class of 'vector<int, std::allocator<int> >'
C:/MinGW/lib/gcc/mingw32/4.7.0/include/c++\bits/stl_vector.h:238,13 - Error - using declaration refers into '_Base::', which is not a base class of 'vector<int, std::allocator<int> >'
C:/MinGW/lib/gcc/mingw32/4.7.0/include/c++\bits/stl_vector.h:527,13 - Error - using declaration refers into '_Base::', which is not a base class of 'vector<int, std::allocator<int> >' 
```

我只能假设这也是由于更多的缺失或错误定义。但是，我尝试添加 g++ 提供的每个定义（[http://stackoverflow.org/wiki/What_are_the_default_defines_in_my_Gnu_compiler?](http://stackoverflow.org/wiki/What_are_the_default_defines_in_my_Gnu_compiler?)）但它似乎没有任何效果（除了添加大量宏重新定义的警告之外）。

我的 SublimeClang 项目设置如下（默认设置不变）：

```
"sublimeclang_additional_language_options":
{
  "c++" : ["-std=c++11"]
},

"sublimeclang_options":
[
  "-D__GNUC__=4",
  "-D__GNUC_MINOR__=7",
  "-D__MSVCRT__=1",
  "-IC:\\project-specific-source",
  "-IC:\\project-specific-library\\include",
  "-isystem", "C:\\MinGW\\lib\\gcc\\mingw32\\4.7.0\\include",
  "-isystem", "C:\\MinGW\\lib\\gcc\\mingw32\\4.7.0\\include\\c++",
  "-isystem", "C:\\MinGW\\lib\\gcc\\mingw32\\4.7.0\\include\\c++\\mingw32",
  "-isystem", "C:\\MinGW\\include",
  "-Wall",
  "-ferror-limit=0"
] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-16T17:57:33.500

我有同样的错误，这是因为 llvm 是用不同版本的 mingw+gcc 构建的。我尝试自己构建clang，但没有帮助。今天我通过从这里安装 mingw+gcc 解决了这个问题：

```
http://sourceforge.net/projects/mingw-w64/files/Toolchains%20targetting%20Win32/Personal%20Builds/rubenvb/gcc-dw2-4.6-release/i686-w64-mingw32-gcc-dw2-4.6.3-2-release-win32_rubenvb.7z/download 
```

从这里发出叮当声：

```
http://sourceforge.net/projects/mingw-w64/files/Toolchains%20targetting%20Win32/Personal%20Builds/rubenvb/clang-3.2-release/i686-w64-mingw32-clang-3.2-release-win32_rubenvb.7z/download 
```

将所有内容放在同一个文件夹中，以便 bot g++.exe 和 clang++.exe 位于同一个 bin 文件夹中，并将该 bin 文件夹放在您的 PATH 中。

这是我现在的 sublimeclang 配置：

```
{
    "additional_language_options":
    {
        "c++" : ["-std=c++11",
                 "-ID:\\Apps\\mingw32-gcc-dw2-4.6.3-2-clang-3.2-win32\\i686-w64-mingw32\\include"]
    },

    "options":
    [
        "-g",
        "-O2",
        "-Wall",
        "-Wextra"
    ],

    "debug_options": false,

    "dont_prepend_clang_includes": true,

    "analyzer_commandline":
    [
        "clang.exe",
        "--analyze",
        "-o",
        "-"
    ]
} 
```

该`-I`部分是必需的，因为`dont_prepend_clang_includes`.

# algorithm - 将英文风格名称拆分为名字和姓氏的最佳策略

> ID：13209894
> 
> 赞同：6
> 
> 时间：2012-11-03T14:05:07.640
> 
> 标签：algorithm, split, pseudocode

我有一个名字列表，我需要将它们分成名字和姓氏。由于某些名称中有 2-3 个空格，因此对空格进行简单拆分是行不通的。

人们使用什么样的启发式方法来执行拆分？

请注意，这不是有效地询问如何在空格处拆分的问题的重复；我正在寻找启发式和算法，而不是实际的代码帮助。

*更新*：我将问题限制为英文风格的名称。这就是我需要解决的所有问题，并且可能是任何接近这个（英语）问题的人都需要解决的问题。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-03T14:19:20.137

我读过一篇关于这个主题的非常有趣和全面的帖子：

[http://www.w3.org/International/questions/qa-personal-names](http://www.w3.org/International/questions/qa-personal-names)

它甚至建议问问自己是否真的需要单独的名字和姓氏字段。它似乎取决于您的应用程序的目标区域。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-03T14:24:22.420

有两种方法可以提供帮助，但不能完全解决这个问题。

1.  以编程方式将容易的分开，不容易的被推到不同的列表中，“仍有待拆分”。手动对该列表进行排序。当您手动排序时，可能会出现一些可以编码的启发式方法，从而进一步减小剩余列表的大小。如果这是一次性的事情，并且列表不是超级庞大，那么这将完成工作。
2.  一个密切相关的问题是当一个名称被拆分时，但您不知道哪个是第一个，哪个是最后一个。一些系统通过模糊查找来解决这个问题，如果第一次尝试没有找到匹配项，则翻转名字和姓氏并重试。您没有说*为什么*需要拆分名称。如果要查找参考数据，请考虑某种类似的模糊查找启发式算法，它允许尝试不同的拆分，而不是尝试预先获得正确的拆分。

不是真正的答案，但在这种情况下，确实没有完美的答案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-03T14:08:06.713

不同的国家和地区有不同的名称格式。例如，亚洲通常首先是姓氏，然后是名字。西方，你有名字和姓氏的约定，但是当人们双管齐下或包含中间名时会变得复杂。然后有些地区的人只有一个名字。

就个人而言，恐怕没有一种算法可以为您提供 100% 准确的结果。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-03T14:18:40.660

以下假设是英式姓氏。如果不是这种情况，请更新您的问题。

通常可以安全地假设最后一个空格字符表示一个人的姓氏的开始。但由于有例外，一种策略是从其他来源编译一个包含已知多字姓氏的大型数据库。然后，您可以测试这些姓氏，并将它们视为例外。

# android - SherlockActivity 中的 MenuInflater

> ID：13209896
> 
> 赞同：3
> 
> 时间：2012-11-03T14:05:23.467
> 
> 标签：android, actionbarsherlock

我试图让菜单充气机在我的 SherlockActivity 类中充气菜单 xml。

我的 onCreateOptionsMenu 方法是这样的 -

```
@Override
public boolean onCreateOptionsMenu(com.actionbarsherlock.view.Menu menu) {
    MenuInflater inflater = this.getSupportMenuInflater();
    inflater.inflate(R.menu.messagespagemenu, menu);
    return true;
} 
```

我的messagespagemenu.xml 看起来像这样-

```
<menu xmlns:android="http://schemas.android.com/apk/res/android" >
<item
    android:id="@+id/text"
    android:title="@string/deleteall">
</item> 
```

我的活动类扩展了 SherlockActivity。

谁能指出我正在做的错误。

编辑：

菜单不显示。当我在另一个类中尝试相同的代码扩展 SherlockListActivity 时，它可以工作。所以我想知道我是否在这门课上遗漏了什么

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T14:20:13.857

可能您正在预 Honeycom 设备上运行它，`MenuItem`只要您单击硬件`menu`键，就会显示它。你应该在你`android:showAsAction:always`的.`android:showAsAction:ifRoom``<item>`

**编辑：** 你也应该打电话给`super.onCreateOptionsMenu()`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T14:49:18.183

试试这个，看看这是否有效：

```
@Override
public boolean onCreateOptionsMenu(Menu menu) {

    MenuInflater inflate = getSupportMenuInflater();
    inflate.inflate(R.menu.messagespagemenu, menu);

    return super.onCreateOptionsMenu(menu);
} 
```

此外，请确保这部分看起来与上面的示例完全相同：

```
public boolean onCreateOptionsMenu(Menu menu) 
```

你目前有这个：

```
public boolean onCreateOptionsMenu(com.actionbarsherlock.view.Menu menu) 
```

我不确定这是否有任何区别，但看看它是否有效。对应的`import`应该是`import com.actionbarsherlock.view.Menu;`

# php - 使用 AJAX 和 Jquery 创建使用 FPDF 的 pdf

> ID：13209897
> 
> 赞同：9
> 
> 时间：2012-11-03T14:05:26.787
> 
> 标签：php, jquery, ajax, pdf

我正在尝试使用 FPDF 创建 pdf 文件。

我现在拥有的是一个带有多行数据的 HTML 页面，旁边有一个打印按钮。当有人点击打印时，我通过 AJAX 调用使用 Jquery 发送相应的数据。

这是我的 JQUERY 代码：

```
$('.printbtn').live('click', function(){
    var printdata = 'name=' + name_t + '&address=' + address_t;        
    $.post('print.php', printdata, function(){
    });
    return false;
 }); 
```

这是 print.php

```
 $name = $_POST['name'];
 $address = $_POST['address'];

 require ("fpdf17/fpdf.php");

 $pdf = new FPDF('P','mm',array(90,100));

 $pdf->AddPage();

 $pdf->SetFont('Arial','B',12);

 $pdf->Cell(0,10,'name: '.$name);
 $pdf->Cell(0,10,'address: '.$address);

 $pdf->Output();

 ?> 
```

但我没有得到 PDF 作为回报。怎么了？？事实上，什么都没有发生..我想检索 pdf 文件并将其发送到打印

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-03T17:30:22.887

`<a>`您应该使用带有变量的 PHP 页面的标签打开一个新页面`print.php`。

`<a href="print.php?data" target="_blank">click me to download the file</a>`

在 PHP 页面中，添加标题

```
// Send Headers
header('Content-type: application/pdf');
header('Content-Disposition: attachment; filename="myPDF.pdf');

// Send Headers: Prevent Caching of File
header('Cache-Control: private');
header('Pragma: private');
header('Expires: Mon, 26 Jul 1997 05:00:00 GMT'); 
```

尝试使用标题`header('Content-type: application/force-download');`自动下载您的文件。

您还可以显示您的 PDF 数据，例如文件是否已保存`readfile('original.pdf');`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-03T14:54:37.023

要通过 ajax 加载 PDF，您可以尝试：

*   使用一些 PDF javascript 库直接从 javascript 渲染 PDF，无需插件，例如[mozilla pdf.js](http://mozilla.github.com/pdf.js/)或[jspdf](http://jspdf.com/)。并尝试查看这些库是否允许您直接从二进制数据（您在 ajax 中收到的内容）设置 pdf。

*   另一种选择是将 pdf 数据作为 base64 编码接收，并使用[数据 URI](http://en.wikipedia.org/wiki/Data_URI_scheme)设置`window.location.href`为该数据 uri，尽管在这种情况下，PDF 可能作为下载对话框提供，而不是直接加载到页面中，您必须测试. 此外，对于 IE 8 和更早版本中的 pdf，数据 uri 支持非常有限，请参阅维基百科[数据 uri 页面](http://en.wikipedia.org/wiki/Data_URI_scheme)了解更多详细信息。

*   另请参阅[此答案](https://stackoverflow.com/a/4750685/352672)，了解如何无法直接从 ajax 加载 pdf 以及您必须尝试做的其他选项（主要将 pdf 保存为服务器上的临时文件并与`window.location.href`or`<iframe>`或一起使用`window.open`）

# java - SWT 应用程序在 Linux 上的 sun java javaws 上崩溃

> ID：13209906
> 
> 赞同：2
> 
> 时间：2012-11-03T14:06:54.830
> 
> 标签：java, linux, swt, java-web-start

我在 java 中使用 SWT 编写了小型应用程序，它随机崩溃而没有记录错误。这只发生在带有 Sun Java 1.6.xx 的 Ubuntu 10.04 上。应用程序在同一台机器上的 Open-JDK 中运行良好。它在带有 Sun Java 6 或 Sun Java 7 的 windows xp 和 windows 7 上运行良好。主要问题是，如果我在没有 javaws 的情况下运行它并且当它崩溃时没有记录任何内容，则应用程序运行正常。

我尝试添加：**-Djavaplugin.logging=true J** ​​ava 运行时环境设置，并且在我的主目录中有一些跟踪文件，但其中没有错误。

我尝试使用以下命令在终端中运行应用程序：**java -verbose -wait wnclient.jnlp**，只有在应用程序崩溃后我得到的是：

```
Java Web Start splash screen process exiting .....
Error encountered while invoking Java Web Start (execv) 
/usr/lib/jvm/jre1.6.0_33/bin/java: No such file or directory 
```

我尝试了几个版本的 swt，无论我使用什么版本的 swt 或者我在 linux 上使用什么 Sun Java，行为几乎都是一样的。

由于没有错误，我不知道要发布哪段代码。

如果有人有任何建议，我可以追查到这个错误，我将非常感激。

**编辑1：**

```
tihomir@pila:~$ ls -l /usr/lib/jvm/
total 20824
drwxr-xr-x  4 root root     4096 2010-05-30 10:58 java-1.5.0-gcj-4.4
lrwxrwxrwx  1 root root       14 2010-05-15 18:03 java-1.6.0-openjdk -> java-6-openjdk
drwxr-xr-x  7 root root     4096 2012-09-04 19:56 java-6-openjdk
lrwxrwxrwx  1 root root       19 2011-08-14 09:36 java-6-sun -> java-6-sun-1.6.0.26
drwxr-xr-x 10 root root     4096 2010-12-04 11:42 java-6-sun-1.6.0.20
drwxr-xr-x  8 root root     4096 2012-01-08 19:53 java-6-sun-1.6.0.26
drwxr-xr-x  8 root root     4096 2012-08-21 18:47 jre1.6.0_33
-rwxr-xr-x  1 root root 21300793 2012-08-21 18:46 jre-6u33-linux-x64.bin

tihomir@pila:~$ ls -l /usr/lib/jvm/jre1.6.0_33/bin/java
-rwxr-xr-x 1 root root 50794 2012-06-22 01:59 /usr/lib/jvm/jre1.6.0_33/bin/java 
```

# jquery - 为什么我的动画效果不起作用？

> ID：13209907
> 
> 赞同：1
> 
> 时间：2012-11-03T14:07:00.280
> 
> 标签：jquery, jquery-effects

初学者问题：

我加载->

```
<script type="text/javascript" src="http://code.jquery.com/jquery-latest.min.js"></script> 
```

之后mt js文件

全部在头部。

html:

```
<li class="form-row" id="req-shake">
  <label class="requried-field"> *</label>
  <label>some label</label>
  <input id="input-email" name="email" type="text" class="text-input required email default"  value="" title="example@example.com" />
</li> 
```

js错误：

![js错误：](../Images/00084a475a4314e7cdc1827df060c1a1.png)

难道我做错了什么？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T14:08:30.720

正如控制台中的错误消息告诉您的那样，[没有`.effect()`jQuery 方法](http://api.jquery.com/effect)。
除了 jQuery 之外，您还应该包含 jQuery UI 以[从`.effect()`jQuery UI 获取方法](http://api.jqueryui.com/effect/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T14:09:48.753

也包括这三个文件

```
 <link href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8/themes/base/jquery-ui.css" rel="stylesheet" type="text/css"/>
  <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.5/jquery.min.js"></script>
  <script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8/jquery-ui.min.js"></script> 
```

# preg-replace - php preg_replace html 菜单，页脚

> ID：13209908
> 
> 赞同：0
> 
> 时间：2012-11-03T14:07:07.147
> 
> 标签：preg-replace, simple-html-dom

我正在使用简单的 html 解析 html 并删除页面菜单和页脚（例如，我选择[http://codex.buddypress.org/developer-docs/the-bp-global/](http://codex.buddypress.org/developer-docs/the-bp-global/)，然后可能是其他 url。）。但是我的代码返回`Fatal error: Call to a member function find() on a non-object`，哪里错了？谢谢。

```
require('simple_html_dom.php');
$webch = curl_init();
curl_setopt($webch, CURLOPT_URL, "http://codex.buddypress.org/developer-docs/the-bp-global/");
curl_setopt($webch, CURLOPT_RETURNTRANSFER, 1);
curl_setopt($webch, CURLOPT_USERAGENT, 'Mozilla/5.0 (Windows; U; Windows NT 6.1; en-US; rv:1.9.1.2) Gecko/20090729 Firefox/3.5.2 GTB5');
$htmls = curl_exec($webch);
curl_close($webch);
$html = str_get_html($htmls);
$html = preg_replace('#<div(.*?)id="(.*?)head(.*?)"(.*?)>.*</div>#is', '', $html);
$html = preg_replace('#<div(.*?)class="(.*?)head(.*?)"(.*?)>.*</div>#is', '', $html);
$html = preg_replace('#<div(.*?)id="(.*?)menu(.*?)"(.*?)>.*</div>#is', '', $html);
$html = preg_replace('#<div(.*?)class="(.*?)menu(.*?)"(.*?)>.*</div>#is', '', $html);
$html = preg_replace('#<div(.*?)id="(.*?)foot(.*?)"(.*?)>.*</div>#is', '', $html);
$html = preg_replace('#<div(.*?)class="(.*?)foot(.*?)"(.*?)>.*</div>#is', '', $html);
foreach($html->find('a') as $element){
   echo $element.'<hr />';
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T14:17:13.420

`str_get_html`似乎它是来自[HTML DOM Parser](http://simplehtmldom.sourceforge.net/manual.htm)的函数。它返回的不是字符串，这就是您要处理的内容。`preg_replace`期望一个字符串作为输入并返回一个字符串，然后将其设置为`$html`.

你的问题是你然后调用`$html->find`，这意味着你期望`$html`成为一个对象，作为返回的对象，`str_get_html`但这不是因为你刚刚将它分配给一个字符串，返回的`preg_replace`。

您可能想要的是以下两件事之一：

*   `preg_replace`在做之前做字符串处理（使用） `$html = str_get_html($htmls);`。在该语句之后，它不再是一个字符串，您所做的任何处理都将是无用和错误的。
*   使用您正在使用的库中可用的实际工具（据 Google 所知，简单的 HTML DOM 解析器）执行您正在做的任何事情。例如，类似的东西`$html->find('div.menu')->class = '';`。

我会推荐第二点（如果它是你想要的），因为[使用正则表达式处理 HTML 并不是一个好主意](https://stackoverflow.com/a/1732454/1043456)。

# python - Python 中的类型化 JSON 序列化/反序列化

> ID：13209909
> 
> 赞同：1
> 
> 时间：2012-11-03T14:07:07.690
> 
> 标签：python, json, serialization

```
class Person:
    first_name = superjson.Property()
    last_name = superjson.Property()
    posts = superjson.Collection(Post)

class Post:
    title = superjson.Property()
    description = superjson.Property()

# ^^^ this approach is very similar to Django models/forms 
```

然后，给定这样的 JSON：

```
{
  "first_name": "John", 
  "last_name": "Smith",
  "posts": [
    {"title": "title #1", "description": "description #1"},
    {"title": "title #2", "description": "description #2"},
    {"title": "title #3", "description": "description #3"}
  ]
} 
```

我希望它建立一个适当的`Person`对象，其中包含所有内容：

```
p = superjson.deserialize(json, Person) # note, root type is explicitly provided
print p.first_name # 'John'
print p.last_name # 'Smith'
print p.posts[0].title # 'title #1'
# etc... 
```

*   当然它也应该有助于序列化
*   默认情况下，它应该序列化/反序列化与 ISO-8601 之间的时间，或者很容易在几行代码中实现这一点。

所以，我在找这个`superjson`。有没有人看到类似的东西？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-03T14:09:39.913

[Colander](http://docs.pylonsproject.org/projects/colander/en/latest/)与[limone](http://pypi.python.org/pypi/limone)结合起来就是这样做的。

您使用以下方式定义架构`colander`：

```
import colander
import limone

@limone.content_schema
class Characteristic(colander.MappingSchema):
    id = colander.SchemaNode(colander.Int(),
                             validator=colander.Range(0, 9999))
    name = colander.SchemaNode(colander.String())
    rating = colander.SchemaNode(colander.String())        

class Characteristics(colander.SequenceSchema):
    characteristic = Characteristic()

@limone.content_schema
class Person(colander.MappingSchema):
    id = colander.SchemaNode(colander.Int(),
                             validator=colander.Range(0, 9999))
    name = colander.SchemaNode(colander.String())
    phone = colander.SchemaNode(colander.String())
    characteristics = Characteristics()

class Data(colander.SequenceSchema):
    person = Person() 
```

然后传入你的 JSON 数据结构：

```
deserialized = Data().deserialize(json.loads(json_string)) 
```

# javascript - 试图在文本框中的 Enter 键上更改 IE 触发器

> ID：13209911
> 
> 赞同：2
> 
> 时间：2012-11-03T14:07:31.380
> 
> 标签：javascript, jquery, internet-explorer

在 Chrome 和 FF 中，当在文本框中按 Enter 时会触发更改，而不是在 IE 中，所以我试图让它做同样的事情

这就是我目前所拥有的：http: [//jsfiddle.net/nV4SA/8/](http://jsfiddle.net/nV4SA/8/)

```
//fix for IE to trigger change on enter
    $("input[type=text]")
        .on("change", function(e) {
            $.data(this, "value", this.value);
        }).on("keyup", function(e) {
            if (e.which === 13 && this.value != $.data(this, "value")) {
                $(this).change();
            }
        }); 
```

此代码的唯一缺点是在 IE 用户点击输入时会发生更改，但是当文本框失去焦点时更改会再次发生

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T15:05:27.347

如果您仅在 IE中触发`change`，它似乎不会触发它。`blur`用于`$.support`测试 IE。

```
/* false in IE.. see jQuery APU */
var changeBubble=$.support.changeBubbles;

$("input[type=text]").on("change", function(e) {
    $.data(this, "value", this.value);
}).on("keyup", function(e) {
    if (e.which === 13 && this.value != $.data(this, "value") && !changeBubble) {
        e.preventDefault();
        $(this).trigger('blur');
    }
}) 
```

演示：http: [//jsfiddle.net/nV4SA/10/](http://jsfiddle.net/nV4SA/10/)

`$.support`API 文档：[http ://api.jquery.com/jQuery.support/](http://api.jquery.com/jQuery.support/)

编辑：请注意，这`$.support.changeBubbles`在 IE9 中是正确的，但不是 IE <9。解决方案可能不是万无一失的。尽管不赞成您可能需要使用浏览器嗅探或尝试`$.support`在所有版本的 IE 中查找其他支持属性

# php - PHP 变量需要等于从 sql 查询中获得的值

> ID：13209913
> 
> 赞同：-1
> 
> 时间：2012-11-03T14:08:01.573
> 
> 标签：php, sql

我正在尝试使用 php 绘制图表。我想绘制从表中的结果计数返回的值：

```
SELECT COUNT(*) FROM tAnswer WHERE Answer1 = '1'; 
```

查询返回 3。我现在希望将这 3 存储在 php 变量中。

我该怎么办？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T14:10:33.677

别名 COUNT(*) 的名称如下，

`SELECT COUNT(*) AS C FROM ...`

然后您可以像访问任何返回的列一样访问它，即。`$row['C']`

# c# - 带有地铁的C＃，密封关键字是绝对要求吗？

> ID：13209917
> 
> 赞同：1
> 
> 时间：2012-11-03T14:08:12.643
> 
> 标签：c#, .net, microsoft-metro

我知道你可以用 C# 编写 Metro 应用程序。我的问题是是否每个类都需要密封关键字。我试图编译一个 Metro 应用程序，并从类中删除了 seal 关键字。它仍然编译。

那么在 Metro 应用程序和 C# 中，sealed 关键字究竟是如何使用的。背后的原因是什么。仅当您希望类以 .net 语言以外的另一种语言显示时才需要？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T14:32:25.470

是的，这是绝对要求。但仅适用于*某些*类，即您向在 WinRT 上运行的其他语言公开的那种。换句话说，当您创建自己想要使用的组件时，例如 Javascript 或 C++。

此类类有许多限制，其技术原因是 WinRT 运行在 COM 之上，而 COM 不支持实现继承。*看起来*确实如此，就像 XAML 类似乎使用继承一样。但这是 CLR 中内置的语言投影造成的错觉。这种错觉不是双向的。

一般来说，想要这样做是相当罕见的，您需要牢记一些限制。对于您自己的 C# 类，您编写的用于实现自己的商店应用程序的类没有此类限制，并且不需要*密封*。

# android - setOnItemClickListener 没有响应基本适配器

> ID：13209919
> 
> 赞同：1
> 
> 时间：2012-11-03T14:08:30.663
> 
> 标签：android

> **可能重复：**
> [未调用 setOnItemClickListener](https://stackoverflow.com/questions/13201363/setonitemclicklistener-not-getting-called)

setOnItemClickListener 没有响应我的基本适配器。此尝试试图在 baseadapter 的 getView 中处理侦听器。

我的适配器：

```
import java.io.Serializable;
import java.util.ArrayList;

import android.content.Context;
import android.util.Log;
import android.view.LayoutInflater;
import android.view.View;
import android.view.View.OnClickListener;
import android.view.ViewGroup;
import android.widget.BaseAdapter;
import android.widget.TextView;

public  class ModuleAdapter extends BaseAdapter implements Serializable, OnClickListener{
    private static final String TAG = "myAdapter";

    private static final long serialVersionUID = 1L;
    private LayoutInflater modInflater;

    static class ViewHolder{
        TextView moduleCode;
        TextView firstLetter;
        TextView day;
        TextView startTime;
        TextView location;

    }

//  insert holding arrays
    private ArrayList<String> moduleCodeItems = new ArrayList<String>();
    private ArrayList<String> module_name = new ArrayList<String>();
    private ArrayList<String> moduleType = new ArrayList<String>();
    private ArrayList<String> weekDay = new ArrayList<String>();
    private ArrayList<String> classTime = new ArrayList<String>();
    private ArrayList<String> classLocation = new ArrayList<String>();
    private ArrayList<String> commentsField = new ArrayList<String>();

//  setter for the array lists
    public void setModules(String modCode, String modName, String modT, String weekD, String classT, String classL, String commentsF){
        moduleCodeItems.add(modCode);
        module_name.add(modName);
        moduleType.add(modT);
        weekDay.add(weekD);
        classTime.add(classT);
        classLocation.add(classL);
        commentsField.add(commentsF);
//      Log.v(TAG, moduleCodeItems.get(0));
    }

//  getters for the module array list items
    public ArrayList<String> getModuleCodeItems(){
        return moduleCodeItems;
    }

    public ArrayList<String> getModuleNames(){
        return module_name;
    }

    public ArrayList<String> getModuleTypes(){
        return moduleType;
    }

    public ArrayList<String> getWeekDays(){
        return weekDay;
    }

    public ArrayList<String> getClassTimes(){
        return classTime;
    }

    public ArrayList<String> getClassLocations(){
        return classLocation;
    }

    public ArrayList<String> getComments(){
        return commentsField;
    }
//  end of getter methods

//  setter for module array list items
    @SuppressWarnings("unchecked")
    public void setModuleCodeItemsArrayList(Object modCodeArray){
        moduleCodeItems = (ArrayList<String>) modCodeArray;
    }

    @SuppressWarnings("unchecked")
    public void setModuleNameArrayList(Object nameArray){
        module_name = (ArrayList<String>) nameArray;
    }

    @SuppressWarnings("unchecked")
    public void setModuleTypeArrayList(Object typeArray){
        moduleType = (ArrayList<String>) typeArray;
    }

    @SuppressWarnings("unchecked")
    public void setWeekDayArrayList(Object weekArray){
        weekDay = (ArrayList<String>) weekArray;
    }

    @SuppressWarnings("unchecked")
    public void setClassTimeArrayList(Object classArray){
        classTime = (ArrayList<String>) classArray;
    }

    @SuppressWarnings("unchecked")
    public void setClassLocationArrayList(Object locationArray){
        classLocation = (ArrayList<String>) locationArray;
    }

    @SuppressWarnings("unchecked")
    public void setCommentsFieldArrayList(Object commentsArray){
        commentsField = (ArrayList<String>) commentsArray;
    }

//   constructor
    public ModuleAdapter(Context context){

        modInflater = LayoutInflater.from(context);
    }

    @Override
    public int getCount() {
//      determine how many objects there are for displaying
        return moduleCodeItems.size();
    }

    @Override
    public View getView(int position, View convertView, ViewGroup parent) {

        ViewHolder holder;

        if(convertView == null){
            convertView = modInflater.inflate(R.layout.row, null);

            holder = new ViewHolder();
            holder.moduleCode = (TextView)convertView.findViewById(R.id.module_code_numberRow);
            holder.firstLetter = (TextView)convertView.findViewById(R.id.firstLetterRow);
            holder.day = (TextView)convertView.findViewById(R.id.dayRow);
            holder.startTime = (TextView)convertView.findViewById(R.id.startTimeRow);
            holder.location = (TextView)convertView.findViewById(R.id.locationRow);

            convertView.setTag(holder);
        }else{
            holder = (ViewHolder)convertView.getTag();
        }
        holder.moduleCode.setText(moduleCodeItems.get(position));
        holder.firstLetter.setText(moduleType.get(position));
        holder.day.setText(weekDay.get(position));
        holder.startTime.setText(classTime.get(position));
        holder.location.setText(classLocation.get(position));
//      Log.v(TAG,(moduleCodeItems.get(position))); 

        holder.moduleCode.setOnClickListener(new View.OnClickListener() {
               public void onClick(View v){  
                   Log.v(TAG, "clicked"); 
                }
             });

        return convertView;
    }

    @Override
    public Object getItem(int position) {
        // TODO Auto-generated method stub
        return null;
    }

    @Override
    public long getItemId(int position) {
        // TODO Auto-generated method stub
        return position;
    }

    @Override
    public void onClick(View v) {
        // TODO Auto-generated method stub

    }

}
//  end of module adapter 
```

我的活动设置了适配器：

```
public class MainActivity extends Activity {
    private static final String TAG = "someTag";
//  boolean to check if data has been added to the string arrays
    boolean modulesHaveBeenSet;
//  boolean to check to see if the correct module code has been entered for deletion
    boolean newOutputs;
    public String MODULES_FILE = "modules_file";
    Context context = this;
    File file;

//  identifiers for strings to be passed to the next activity via intents
    public final static String TIME_MESSAGE = "timeMessageForNextActivity";
    public final static String DAY_MESSAGE = "dayMessageForNextActivity";

    private static final int MENU_ADD = Menu.FIRST+1;
    private static final int MENU_REMOVE = Menu.FIRST+2;

    ModuleAdapter adapter;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

       ListView lv = (ListView)findViewById(R.id.list);
       adapter = new ModuleAdapter(this);
       lv.setAdapter(adapter);

       file = new File(context.getFilesDir(), MODULES_FILE);

    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        // TODO Auto-generated method stub
        super.onCreateOptionsMenu(menu);
        menu.add(Menu.NONE,MENU_ADD,Menu.NONE,"add module");
        menu.add(Menu.NONE,MENU_REMOVE,Menu.NONE,"delete module");
        return true;

    }

//    forces menu to display when the application launches
//    taken from stack overflow
    @Override
    public void onWindowFocusChanged(boolean hasFocusFlag) {
        super.onWindowFocusChanged(hasFocusFlag);       
        if (hasFocusFlag) {
            openOptionsMenu();
        }
    }
//    end of on window focus

    @Override
        public boolean onOptionsItemSelected(MenuItem item) {
           switch (item.getItemId()) {
        case MENU_ADD:
            add();
            break;
        case MENU_REMOVE:
            remove();
        default:
            break;
        }

            return super.onOptionsItemSelected(item);
        }
//    end of on options selected

    private void add(){
        final View addView = getLayoutInflater().inflate(R.layout.add, null);

        new AlertDialog.Builder(this)
        .setTitle("Enter Module Information")
        .setView(addView)
        .setPositiveButton("OK", new DialogInterface.OnClickListener(){
            public void onClick(DialogInterface dialog, int whichButton){

//          add whatever is in the text fields to the array lists
            EditText moduleEdit = (EditText)addView.findViewById(R.id.module_edit);
            EditText nameEdit = (EditText)addView.findViewById(R.id.module_name_edit);
            EditText typeEdit = (EditText)addView.findViewById(R.id.module_type_edit);
            EditText dayEdit = (EditText)addView.findViewById(R.id.week_day_edit);
            EditText timeEdit =(EditText)addView.findViewById(R.id.time_edit);
            EditText locationEdit = (EditText)addView.findViewById(R.id.location_edit);
            EditText commentsEdit = (EditText)addView.findViewById(R.id.comments_edit);

            try {
                adapter.setModules(moduleEdit.getText().toString(),
                                    nameEdit.getText().toString(),
                                    typeEdit.getText().toString().substring(0, 1).toUpperCase(),
                                    dayEdit.getText().toString().substring(0, 2),
                                    timeEdit.getText().toString(),
                                    locationEdit.getText().toString(),
                                    commentsEdit.getText().toString());
                modulesHaveBeenSet = true;

//          tell the adapter to refresh itself 
                adapter.notifyDataSetChanged();
            } catch (StringIndexOutOfBoundsException e) {
//              recall add method if all edit fields not used
                add();
            }
//              end of try catch
            }
        }).setNegativeButton("Cancel", null).show();

    }
//  end of add  

    public void remove(){
        final View removeView = getLayoutInflater().inflate(R.layout.remove, null);

        new AlertDialog.Builder(this)
        .setTitle("Enter Module to Delete")
        .setView(removeView)
        .setPositiveButton("OK", new DialogInterface.OnClickListener(){
            public void onClick(DialogInterface dialog, int whichButton){
//          get whatever module code was entered in edit text
                EditText removeModCode = (EditText)removeView.findViewById(R.id.remove_mod_code_edit);
                String rm = removeModCode.getText().toString();

                int lengtOfModCodeArrayList = adapter.getModuleCodeItems().size();
                Log.v(TAG,"" + lengtOfModCodeArrayList);
                for(int i =0; i< lengtOfModCodeArrayList; i++){

                    if(adapter.getModuleCodeItems().get(i).equals(rm)){
                        adapter.getModuleCodeItems().remove(i);
                        adapter.getModuleNames().remove(i);
                        adapter.getModuleTypes().remove(i);
                        adapter.getWeekDays().remove(i);
                        adapter.getClassTimes().remove(i);
                        adapter.getClassLocations().remove(i);
                        adapter.getComments().remove(i);
                        Log.v(TAG,"" + lengtOfModCodeArrayList);
                        newOutputs = true;
                    }
//                  if
                }
//              for

//              delete the file and recreate
                boolean deleted = context.deleteFile(MODULES_FILE);
                if(deleted){
                Log.v(TAG, "file deleted");
                }
                file = new File(context.getFilesDir(), MODULES_FILE);

//              update file
                try {

                    ObjectOutputStream moduleOutputs = new ObjectOutputStream(new FileOutputStream(file));
                    moduleOutputs.writeObject(adapter.getModuleCodeItems());
                    moduleOutputs.writeObject(adapter.getModuleNames());
                    moduleOutputs.writeObject(adapter.getModuleTypes());
                    moduleOutputs.writeObject(adapter.getWeekDays());
                    moduleOutputs.writeObject(adapter.getClassTimes());
                    moduleOutputs.writeObject(adapter.getClassLocations());
                    moduleOutputs.writeObject(adapter.getComments());

                    moduleOutputs.flush();
                    moduleOutputs.close();

                } catch (FileNotFoundException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                } catch (IOException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                }
//              update adapter
                adapter.notifyDataSetChanged();

//              raise toast message confirming module removal
                if(newOutputs){
                Context apContext = getApplicationContext();
                CharSequence text = "module " + rm + " deleted";
                int duration = Toast.LENGTH_SHORT;
                Toast toast = Toast.makeText(apContext, text, duration);
                toast.setGravity(Gravity.CENTER, 0, 0);
                toast.show();}
                else{
                    Context apContext = getApplicationContext();
                    CharSequence text = "module does not exist";
                    int duration = Toast.LENGTH_SHORT;
                    Toast toast = Toast.makeText(apContext, text, duration);
                    toast.setGravity(Gravity.CENTER, 0, 0);
                    toast.show();
                }

            }
        }).setNegativeButton("Cancel", null).show();

    }
//    end of remove

    @Override
        protected void onPause() {
            // TODO Auto-generated method stub
            super.onPause();
            Log.v(TAG, "on pause called");
            if(modulesHaveBeenSet){

                try {
                    ObjectOutputStream moduleOutputs = new ObjectOutputStream(new FileOutputStream(file));
                    moduleOutputs.writeObject(adapter.getModuleCodeItems());
                    moduleOutputs.writeObject(adapter.getModuleNames());
                    moduleOutputs.writeObject(adapter.getModuleTypes());
                    moduleOutputs.writeObject(adapter.getWeekDays());
                    moduleOutputs.writeObject(adapter.getClassTimes());
                    moduleOutputs.writeObject(adapter.getClassLocations());
                    moduleOutputs.writeObject(adapter.getComments());

                    moduleOutputs.flush();
                    moduleOutputs.close();

                } catch (FileNotFoundException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                } catch (IOException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                }

            }
//          end if
        }
//    end on pause

    @Override
        protected void onResume() {
            // TODO Auto-generated method stub
            super.onResume();
            Log.v(TAG, "on resume called");

            try {
                ObjectInputStream moduleInputs = new ObjectInputStream(new FileInputStream(file));
                adapter.setModuleCodeItemsArrayList(moduleInputs.readObject());
                adapter.setModuleNameArrayList(moduleInputs.readObject());
                adapter.setModuleTypeArrayList(moduleInputs.readObject());
                adapter.setWeekDayArrayList(moduleInputs.readObject());
                adapter.setClassTimeArrayList(moduleInputs.readObject());
                adapter.setClassLocationArrayList(moduleInputs.readObject());
                adapter.setCommentsFieldArrayList(moduleInputs.readObject());
                adapter.notifyDataSetChanged();

            } catch (StreamCorruptedException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            } catch (FileNotFoundException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            } catch (IOException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            } catch (ClassNotFoundException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }

        } 
```

# iphone - NSUserDefaults - 保存滚动视图偏移量

> ID：13209920
> 
> 赞同：0
> 
> 时间：2012-11-03T14:08:48.747
> 
> 标签：iphone, ios, xcode, cocoa-touch, nsuserdefaults

这是我的代码：

```
-(void)scrollViewDidScroll:(UIScrollView *)scrollView{
    NSLog(@"scrolled!");
    [[NSUserDefaults standardUserDefaults] setFloat:self.mainTableView.contentOffset.y forKey:@"grTableCOy"];
} 
```

正如您在每次用户滚动时看到的那样，我在 NSUserDefaults 中设置了一些值。只是一个问题-这有效吗？

NSUserDefaults 是否会在我每次设置新值时将内容保存到磁盘，或者仅在调用同步方法时才保存？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T14:17:37.797

> 这有效率吗？

你真的是说高效吗？或者说“有效”？我认同。让我们来看看：

> NSUserDefaults 是否会在我每次设置新值时将内容保存到磁盘，或者仅在调用同步方法时才保存？

两者都不。它会定期保存它的数据，所以不是每次你设置它的时候，也不仅仅是当你调用`- synchronize`. 但是，如果您想 100% 绝对确定您的更改已保存，您可以：

*   `- synchronize`每次设置一组数据后调用，或者

*   `- synchronize`仅调用在您的应用程序即将进入后台或终止时调用的方法。这样，您的数据将永远是安全的。

**编辑：**所以你问的是真正的效率。好吧，由于`NSUserDefaults`行为如我所述，您不必担心，它不会每秒对磁盘执行 100 次写入，并且由于您声明您`synchronize`在应用程序终止之前调用，因此您的数据也是安全的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-03T14:17:42.550

[NSUserDefaults 手册](https://developer.apple.com/library/ios/#documentation/Cocoa/Reference/Foundation/Classes/NSUserDefaults_Class/Reference/Reference.html)有一些关于缓存的信息，这部分应该回答你的问题；

> NSUserDefaults 缓存信息以避免每次需要默认值时都必须打开用户的默认数据库。同步方法会定期自动调用，它使内存中的缓存与用户的默认数据库保持同步。

换句话说，您的更改只是有效地存储*在内存中*，除非您`synchronize`手动调用，否则不会在每次更改值时保留数据，而是定期保存。

如果你真的想确保值被写入和存储，你可以调用`synchronize`手动实现。当应用程序即将终止时，这可能是一个好主意。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-03T14:20:08.187

我真的无法谈论你正在做的事情的性能方面。获得明确答案的唯一方法是启动工具，并在使用和不使用 NSUserDefaults 的情况下测量滚动视图的响应。

对于它是否保存的问题？好吧，在这种情况下，访问文档应该可以回答这个问题。这是同步方法的一个片段：

```
Writes any modifications to the persistent domains to disk 
and updates all unmodified persistent domains to what is on disk. 
```

同样，确定性能问题的唯一方法是使用仪器进行测量。

祝你好运！

# image - 用于从 gnuplot 中的数据文件创建图像的脚本

> ID：13209923
> 
> 赞同：1
> 
> 时间：2012-11-03T14:09:08.113
> 
> 标签：image, gnuplot

我有几个按顺序命名为“1.dat”、“2.dat”...、“100.dat”的数据文件。我想为 Gnuplot 中的每个数据文件创建一个 png（或任何其他类型）图像。我的最终目的是从这样生成的图像中创建一部电影，但我发现有一些软件包可以解决这个问题，我更愿意一步一步地做。如何编写脚本以从数据文件中创建图像？谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-03T14:55:22.090

如果你有 gnuplot 4.6，这变得很容易：

```
do for [i=1:100] {
   str_num=sprintf('%d',i)  #Write integer to string
   str_num2=sprintf('%03d',i) #integer as a 0 padded string
   set term png
   set output 'my_output.'.str_num2.'.png'
   plot str_num.'.txt' ...
} 
```

请注意，我有两个版本的数字作为字符串：例如`'1'`，用于创建输入数据文件的名称和`'001'`用于输出数据文件。这样，输出文件将按字典顺序排序，这使得以后制作电影更容易。

* * *

如果您没有 gnuplot 4.6，则需要使用旧的`if`/`reread`技巧：

```
if (! exists('i')) i=1

#Contents of previous `for` loop here...

if (i<=100) reread 
```

最初，我认为您可能能够摆脱情节迭代，但我不这么认为。这会将所有数据放在一个图上。

# html - 图片海报视频标签在 IE9 中拉伸

> ID：13209930
> 
> 赞同：0
> 
> 时间：2012-11-03T14:10:00.173
> 
> 标签：html, video, poster

我有以下代码，使用 Flowplayer，配置如下：

```
<div class="flowplayer" style="width:800px; height:450px;">
<video preload="none" poster="cover.png">
<source type="video/mp4" src="video.mp4" />
</video>
</div> 
```

cover.png 的大小为 800x450，它适合 div 容器视频标签的宽度和高度。在火狐和Chrome上看起来不错，但是当我在IE9中看到它时，获取封面图像，所以在IE9上显示不正确，可能是放大，更大，所以只显示图像的中心，其他周围是隔断。

我该如何解决这个问题？因为我认为，海报的大小与容器相吻合，不需要拉伸使其适合，为什么 IE9 显示为这样。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T11:06:01.323

您还需要将背景图像添加到 div

# java - 在外部集合中查找，从内部集合中添加

> ID：13209934
> 
> 赞同：0
> 
> 时间：2012-11-03T14:10:44.143
> 
> 标签：java, collections, for-loop

我想寻求帮助。

1.  我有对象。
2.  对象有“房间”和“人”的集合。
3.  我需要从选定的“建筑物”中将每个“人”添加到额外列表中

代码更清晰：

```
 public void findPeopleInRoom(String selectedWord) {

    List <String> listPeople= new ArrayList<>();

    //school.subordinateBuildings() return List of buildings
    //b.people() return List of people

        for(IBuilding b: school.subordinateBuildings()) { 
            if(b.getName().equals(selectedWord)) {
                for(Person p1: b.people() ) {
                    listPeople.add(p1.getName());
                }
            }
            else {
                for(IBuilding b2: b.subordinateBuildings()) {
                    if(b2.getName().equals(selectedWord)) {
                        for(Person p2: b2.people() ) {
                            listPeople.add(p2.getName());
                        }
                    }
                }
            }
            System.out.println(listPeople);
            return;
        }
    } 
```

示例（结构）：

*   学校（“名称”）（每个对象都有人员列表和建筑物列表）：
    *   “一种”
    *   **“乙”**
        *   “B1”
        *   **“B2” -> 人员列表**
    *   “C”

但这对我来说不太好用，有点随机。大多数时候不会打印任何东西，有时是正确的。

谢谢大家。

嗯...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T14:31:03.573

您的`return;`语句在 for 循环中。因此它将在第一次迭代后执行，并退出该方法。要在所有建筑物上运行循环，请摆脱该`return;`语句，无论如何您都不需要在`void`方法中使用它。

# mysql - SQL 功能错误

> ID：13209935
> 
> 赞同：0
> 
> 时间：2012-11-03T14:10:51.933
> 
> 标签：mysql, function

我对 MySQL 相当陌生，并且正在使用 MySQL 来处理基于订购系统的项目。

我有一张桌子：

```
Session Table:
PK Session_ID
Date: Session_Date 

Delivery Table:
PK: Del_Type (eg. Firstclass, Secondclass)
Int: Del_TimeToDeliver (1, 2, 3, these represent the expected time to deliver)

Order Table: 
PK: Order_ID: autonum + 1
FK: Order_Delivery_ID
Date: Order_EstDelivery 
```

添加订单我想做的是根据会话ID计算估计时间基本上是：

```
Order_EstDelivery = (Session Date + Delivery_TimeToDeliver) 
```

我有这个代码：

```
INSERT INTO rbickers.order(Del_Type, Order_EstDelivery)
SELECT Del_Type, Ses_Date + INTERVAL Del_TimeToDeliver DAY
FROM Session
LEFT JOIN rbickers.delivery ON Del_Type = ("SecondClass")
WHERE Ses_ID = 2 
```

但它返回错误：字段列表中的未知列“Del_Type”。

我不明白这个错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T14:15:19.010

据我所知，订单表中不存在 Del_Type 列。您不能向表架构中不存在的列插入值。

```
INSERT INTO rbickers.order(Del_Type, Order_EstDelivery) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T14:26:12.183

“Session”表不包含“Del_Type”列，因此您无法在其上运行“Join”

# biztalk - BizTalk 正在向 WCF 服务和 WCF 服务请求发送请求，对象中包含 NULL 字段

> ID：13209937
> 
> 赞同：1
> 
> 时间：2012-11-03T14:11:32.337
> 
> 标签：biztalk, biztalk-wcf

我在 BizTalk 中使用该服务并使用它创建了一个架构。使用该架构，我做了一些映射和映射的 XML 输出，我发送到 WCF 服务。从地图中，我在 XML 中正确获取要发送到 WCF 服务的值。但是在 WCF 服务请求对象中，我得到一些字段 NULL。

如果有人对此问题有解决方案，请帮助我。由于这个问题，我被困住了。

# ios5 - 在 iOS 5 中自定义 UINavigationBar 的奇怪行为

> ID：13209938
> 
> 赞同：1
> 
> 时间：2012-11-03T14:11:37.720
> 
> 标签：ios5, uinavigationcontroller, ios6, uinavigationbar, uiappearance

这是一个非常奇怪的 iOS 5 行为（在 iOS 6 中也是如此）。我正在使用 UIImage 自定义 UINavigationBar 的外观，如下所示。 ![UIImage 用于自定义 UINavigationBar](../Images/523feea6b506de8f87317d090c17508b.png) 以下代码在应用程序启动时使用：

```
// Customize the UINavigation and UITabbar appearance here
[[UINavigationBar appearance] setBackgroundImage:[UIImage imageNamed:@"NavigationTitleBackground.png"]
                              forBarMetrics:UIBarMetricsDefault];
[[UITabBar appearance] setBackgroundImage:[UIImage imageNamed:@"CustomTabbar.png"]]; 
```

最终结果是我对 UITabbar 项目的前 4 个选项卡的期望，如下所示： ![选择了一个标签栏](../Images/8e52337519d28c159a7b3974d3a3b0ed.png)

灯光来自应用程序的顶部。But, when selecting the More tab and all the other sections, the UINavigationBar look becomes flipped upside down like this:

![颠倒的图像](../Images/5e90d9829c2431166c8ee4d35d6e4030.png)

有人知道为什么吗？这可能是什么原因？If you look carefully, the UIImage I'm using is actuallty flipped upside down in order to get the desired result... but when selecting the More UITabbar item and the following section, it gets displayed as it is really in the .png file但这不是理想的结果，因为我希望照明来自应用程序的顶部。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T01:21:33.463

我很想回答您的问题，但是当我使用您使用的图像创建一个新项目时，我得到的正是我所期望的。所有五个 UINavigationController 的 UINavigationBar 都具有与您拥有的图像完全一样的背景。

如果您想要来自顶部的光，您应该垂直反射用于自定义它的图像。

# jvm - 在单个 JVM 中托管多个 Java 应用程序

> ID：13209939
> 
> 赞同：2
> 
> 时间：2012-11-03T14:12:03.173
> 
> 标签：jvm

如果我在单个 JVM 中托管多个 Java 应用程序，我将面临什么问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T14:15:21.743

这样做的问题在于，您不会从使用单独的 JVM 获得的地址空间和进程上下文的分离中受益。如果一个应用程序线程以错误的 System.exit(0) 终止应用程序或抛出致命的 RuntimeException，那么所有应用程序都会死掉。此外，除非您明确强制每个应用程序使用不同的 ClassLoader，否则每个应用程序将共享相同的 ClassLoader。

# oauth - 获取 oauth_token_secret DotNetOpenAuth

> ID：13209940
> 
> 赞同：0
> 
> 时间：2012-11-03T14:12:26.487
> 
> 标签：oauth, dotnetopenauth

我正在使用 dotnetopenauth 库通过linkedin 连接和授权我的用户。

在我的用户经过身份验证/授权后，是否可以从 dnoa 库中获取 oauth_token_secret？

在获得访问令牌后，我需要 oauth_token_secret 来签署我的请求，并使用来自 oauth 站点的 oAuthBase.cs 自己执行该部分。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T14:23:09.040

刚看到ITokenManager界面。

仅供参考：[界面](https://github.com/AArnott/dotnetopenid/blob/master/src/DotNetOpenAuth.OAuth/OAuth/ChannelElements/ITokenManager.cs "令牌管理器界面")

需要实现它才能保存到持久存储。

# javascript - LiveChart 的 HighCharts 错误

> ID：13209942
> 
> 赞同：1
> 
> 时间：2012-11-03T14:12:44.563
> 
> 标签：javascript, highcharts, highstock

我对 HighCharts、HighStock 和实时数据/实时图表有一个大问题。

请检查 ：

[http://jsfiddle.net/5RutC/160/](http://jsfiddle.net/5RutC/160/)

并尝试删除第一个系列（随机数据）。图表将停止更新。如果您重新选择该系列的第一个，它将继续更新所有值。

是否有可能以某种方式克服这个问题，或者是 HighCharts/HighStock 的错误？

谢谢

**HTML 代码：**

```
<script src="http://code.highcharts.com/stock/highstock.js"></script>
<script src="http://code.highcharts.com/stock/modules/exporting.js"></script>

<div id="container" style="height: 500px; min-width: 500px"></div>​ 
```

**Javascript代码：**

```
$(function() {

    Highcharts.setOptions({
        global : {
            useUTC : false
        }
    });

    // Create the chart
    window.chart = new Highcharts.StockChart({
        chart : {
            renderTo : 'container',
            events : {
                load : function() {

                    // set up the updating of the chart each second
                    var series = this.series[0];
                    var series1 = this.series[1];
                    var chart = this;
                    setInterval(function() {
                        var x = (new Date()).getTime(), // current time
                        y = Math.round(Math.random() * 100);
                        y1 = Math.round(Math.random() * 100);
                        series.addPoint([x, y], false, true);
                        series1.addPoint([x, y1], false, true);
                        chart.redraw();
                    }, 1000);
                }
            }
        },

        rangeSelector: {
            buttons: [{
                count: 1,
                type: 'minute',
                text: '1M'
            }, {
                count: 5,
                type: 'minute',
                text: '5M'
            }, {
                type: 'all',
                text: 'All'
            }],
            inputEnabled: false,
            selected: 0
        },

        title : {
            text : 'Live random data'
        },
        legend: {
                align: 'right',
                layout: 'vertical',
                verticalAlign: 'top',
                y: 45,
                enabled: 'true'
            },

        exporting: {
            enabled: false
        },

        series : [{
            name : 'Random data',
            data : (function() {
                // generate an array of random data
                var data = [], time = (new Date()).getTime(), i;

                for( i = -999; i <= 0; i++) {
                    data.push([
                        time + i * 1000,
                        Math.round(Math.random() * 100)
                    ]);
                }
                return data;
            })()
        },{
            name : 'Random data2',
            data : (function() {
                // generate an array of random data
                var data = [], time = (new Date()).getTime(), i;

                for( i = -999; i <= 0; i++) {
                    data.push([
                        time + i * 1000,
                        Math.round(Math.random() * 100)
                    ]);
                }
                return data;
            })()
        }]
    });

}); 
```

​</p>

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T15:19:23.113

看起来 highcharts 处理第一个系列有点不同。一种解决方法可以使用[`highstock#Axis.setExtremes()`](http://api.highcharts.com/highstock#Axis.setExtremes%28%29)如下方式显式设置 xAxis 的极值

```
var xAxis=chart.xAxis[0];
xAxis.setExtremes(xAxis.min,x,true,false); // Set extreme and redraw ! 
```

[在实时图表上隐藏第一个系列 | 海图和海图](http://jsfiddle.net/jugal/84q6B/)

# java - 如何扩展 sun.awt.windows 以提取非标准剪贴板格式，以便支持从本机应用程序拖放？

> ID：13209945
> 
> 赞同：1
> 
> 时间：2012-11-03T14:12:59.693
> 
> 标签：java, reflection, drag-and-drop, awt, clipboard

我正在尝试支持从本机 Windows 应用程序拖放到 Java 应用程序中。我的问题是我没有文档，所以我一直在对其进行逆向工程。我的第一个问题是我不知道剪贴板格式的名称。在调试器中工作，我能够找到应用程序使用系统调用注册的自定义剪贴板格式的标识符`RegisterClipboardFormat()`。在 中`sun.awt.windows.WDataTransferer`，有一个系统调用的本机接口`GetClipboardFormatName()`，通过它我设法提取了注册名称。（作为参考，虽然它不直接涉及问题，但应用程序是Eudora 7.1，名称是`EudoraTransferClipboardFormat`。）

现在我预计需要再次执行此操作，我宁愿现在编写一个小实用程序，因为我肯定会在以后需要时忘记库的内部数据结构。问题是相关的剪贴板格式标识符被隐藏在`SunDropTargetContextPeer`as private member的子类实例中`currentT`。从拖放事件到该对象的导航同样通过受保护的成员。并且系统调用接口同样被声明为私有的。这在调试器中都是可见的，但在普通代码中不可见。

我的目标是提取 的值`currentT`（因为这是拖放子系统实际看到的）并在其中显示已注册剪贴板格式的名称。我怀疑类加载器和安全系统的各种滥用对于让它作为一个用 Java 编写的可发布实用程序工作是必要的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T01:06:47.530

我通过使用 Java 反射调用来获取相关的内部成员解决了这个问题。这其中的关键部分是对象`setAccessible`上的功能`Field`。此函数关闭 Field 对象的访问控制，允许公共访问，尽管不是通过普通语法。（注意实际的函数名称；它不是`subvertAccessControls`.) 此调用在普通 JRE 环境中成功，并且可能无法在例如 applet 中工作。我没有费心检查这个，因为这是一个开发工具来检查原生类型的拖动事件，因为 (1) 应用程序不知道原生类型和 (2) 没有数据将本机数据传输转换为 Java 对象。因此，对于每个具有拖动类型的应用程序，我只需要它运行一次，我是逆向工程；我只需要在普通的 JRE 中运行。

谢天谢地，我不必突破`java.lang.instrument`甚至 JVMTI。然而，我确实不得不滥用安全系统。

测试代码片段如下。变量`long native_types[]`是输出。`DropTargetDragEvent dtde`是输入；它是事件处理程序的参数。

```
long native_types[];
try {
    /*
     * Retrieve the drop target context.
     *
     * We can retrieve this member directly, because it's a public field.
     */
    DropTargetContext dtc = ( ( DropTarget ) dtde.getSource() ).getDropTargetContext();
    /*
     * Retrieve the drop target context peer.
     *
     * We cannot retrieve this member without reflection, because it's a private field. We get the class
     * object from the public class declaration. The field "dropTargetContextPeer" is private, so we
     * have to retrieve with a reflection call and then set it to be accessible so that we don't get
     * IllegalAccessException when we call get() on the field. Since we're only going to use reflection
     * on the drop target context peer, we don't bother trying to cast it and just leave it declared
     * as Object.
     */
    Class<DropTargetContext> DTC_class = DropTargetContext.class;
    Field DTCP_field = DTC_class.getDeclaredField( "dropTargetContextPeer" );
    DTCP_field.setAccessible( true );
    Object dtcp = DTCP_field.get( dtc );
    /*
     * Retrieve the array of native types.
     *
     * This is almost exactly analogous to the previous retrieval, but with the exception that the field
     * is defined in the superclass, not the class itself. Because the field is declared private, we can't
     * simply use getField(), since that only works on public fields. So we get the class object for the
     * parent class and proceed as before.
     *
     * As a bonus, this routine is cross-platform. The class sun.awt.windows.WDropTargetContextPeer is
     * the implementation class for sun.awt.dnd.SunDropTargetContextPeer for Windows. The type identifiers,
     * though, all fit into a long for every platform.
     */
    Class<?> DTCP_class = dtcp.getClass();
    Class<?> DTCP_superclass = DTCP_class.getSuperclass();
    Field CT_field = DTCP_superclass.getDeclaredField( "currentT" );
    CT_field.setAccessible( true );
    native_types = ( long[] ) CT_field.get( dtcp );
} catch ( Exception e ) {
    throw new RuntimeException( "Did not retrieve native types.", e );
} 
```

# r - R中的简单绘图功能

> ID：13209950
> 
> 赞同：0
> 
> 时间：2012-11-03T14:14:49.633
> 
> 标签：r, plot, lattice

我在 R 中的绘图功能有问题。这是我到目前为止得到的。

```
countries <- c("CHINA ", "UNITED STATES", "UNITED KINGDOM", "GERMANY")
KeyItems <- c("Pretax Income", "Total Liabilities", "Total Assets")
datA <- mean_values[mean_values$Country %in% countries & mean_values$KeyItem %in% KeyItems, ]
datA$KeyItem <- factor(datA$KeyItem, levels = KeyItems, order = TRUE)
p <- xyplot(mn_value ~ Year | KeyItem, datA, groups = datA$Country[, drop = TRUE],
            auto.key = list(space = "right"), par.settings = simpleTheme(pch = 1:5),
            type = c("p", "l"), as.table = TRUE)
print(p) 
```

我的数据框如下所示：

```
 KeyItem         Year     Country                                      mn_value
172 Pretax Income   1980    SWITZERLAND                                 2.091623e+08
173 Pretax Income   1980    IRELAND                                     3.597619e+07
174 Pretax Income   1980    GERMANY                                     2.301015e+07
175 Pretax Income   1980    SWEDEN                                      4.980680e+07 
```

它返回此错误：

```
Error in dat$Year == Year : 'Year' is missing 
```

我在 R 方面几乎没有任何经验。我只是找不到解决问题的方法。先感谢您。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T17:24:08.720

正如其他人所提到的，您的代码显然不完整，并且您似乎试图以`mean`不正确的方式在类别中构造值。因此，这是一个导致 xyplot 的工作示例，它在某些（但不是全部）方面类似于您的问题：

```
Values <- rpois(100*4*3, 200)
datA=data.frame(Values=Values, countries=countries, KeyItems=KeyItems)
datAaggr <- with( datA, aggregate(Values , list(KeyItems, countries) , FUN=mean)) 
# At this point you could rename the Group variables,
#    or you could have done that in the aggregate call with:
datAaggr <- with( datA, aggregate(Values , list(KeyItems=KeyItems, countries=countries) , FUN=mean)) 
# This then succeeds using the aggregated dataframe with the re-named mean values as input:

p <- xyplot(x ~ countries | KeyItems, data=datAaggr, 
             auto.key = list(space = "right"), par.settings = simpleTheme(pch = 1:5),
             type = c("p", "l"), as.table = TRUE)
print(p) 
```

它需要对标签进行一些进一步的工作，但这可能会被推迟，直到您学会了如何使用 data.frames 进行数据转换，这是一个在绘图任务之前的学习任务。Lattice 绘图系统严重依赖于正确的 data.frame 输入。

# apache - .htaccess 将 imgname.jpg 重写为 image.php?img=imgname

> ID：13209954
> 
> 赞同：4
> 
> 时间：2012-11-03T14:15:09.430
> 
> 标签：apache, .htaccess, mod-rewrite, url-rewriting

我正在尝试重写如下 URL：

```
domain.com/news/12/imgname.jpg 
```

至

```
domain.com/image.php?img=12/imgname 
```

我在我的 .htaccess 文件中使用以下内容，但它似乎不起作用：

```
RewriteCond %{REQUEST_FILENAME} -f
RewriteRule ^news/([0-9]+\/.*)\.jpg$ image.php?img=$1 [L] 
```

谁能帮我看看我做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T16:32:19.010

你不应该逃避正斜杠。尝试这个：

```
RewriteRule ^news/([0-9]+/.*)\.jpg$ /image.php?img=$1 [L] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T16:40:02.037

您的 .htaccess 文件是否包含适当的[`RewriteBase`](http://httpd.apache.org/docs/current/mod/mod_rewrite.html#rewritebase)指令？如果没有，请在重写规则之前添加以下行：

```
RewriteBase / 
```

您还应该确保已启用 mod_rewrite 引擎：

```
RewriteEngine On 
```

# .net - WPF如何过滤数据绑定元素？MVVM相关

> ID：13209959
> 
> 赞同：1
> 
> 时间：2012-11-03T14:15:57.387
> 
> 标签：.net, wpf, validation, mvvm

我有一个文本框，它的 Text 属性绑定到一个字符串（在视图模型中）

问题：我如何才能使该文本框中的内容正好是 10 个字符长（或仅用英文字母，只是一个示例）。

问题是它被直接写入 viewModel 的字符串变量。所以我唯一的想法是为此配备一个转换器。但即使转换器没有返回任何内容，我如何通知用户出现问题？（以“错误 - 长度！= 10”为例）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-03T14:47:43.857

我建议看看[`IDataErrorInfo`界面](http://msdn.microsoft.com/en-us/library/system.componentmodel.idataerrorinfo.aspx)。你可以让你的视图模型实现这个接口来定义验证逻辑。例如：

```
public class ViewModel : IDataErrorInfo
{
    public string MyText { get; set; }

    #region IDataErrorInfo Members

    public string Error
    {
        get { return null; }
    }

    public string this[string columnName]
    {
        get
        {
            if (columnName == "MyText")
            {
                if (MyText.Length != 10)
                {
                    return "Text should be exactly 10 letters.";
                }
            }

            return null;
        }
    }

    #endregion
} 
```

一个很好的例子和进一步的定制可以在[这里](http://codeblitz.wordpress.com/2009/05/08/wpf-validation-made-easy-with-idataerrorinfo/)找到。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T14:20:23.880

您必须使用[WPF 数据验证](http://wpftutorial.net/DataValidation.html)

# sql - 具有多条记录的表上的内部联接

> ID：13209962
> 
> 赞同：1
> 
> 时间：2012-11-03T14:16:11.017
> 
> 标签：sql, oracle, oracle11g, top-n

我有两个表如下

### 表格1

```
column1|column2
----------------
a1     | c1
----------------
a2     | c2 
```

### 表2

```
column1|column2|column3
----------------------
1      | a1    | x
-----------------------
2      | a1    | y
-----------------------
3      | a1    | z
-----------------------
4      | a2    | ab
-----------------------
5      | a2    | cd
-----------------------
6      | a2    | ef 
```

Table1 是父表，table2 是子表。

table1 的 Column1 映射到 table2 的 column2。

对于 table1 中 column1 的每个条目，Table2 可以包含多个记录，如下所示。

我想将table1加入table2，但我只想要table2所有条目的第一条记录。

所以我的结果集将是

```
column1|column2|column3
----------------------
1      | a1    | x
-----------------------
2      | a2    | ab 
```

如何在 oracle 11 g 中进行连接以实现此目的。我使用 sql 导航器 +

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T14:22:42.393

```
select
  x.column1,
  x.column2,
  x.column3
from
    (select
      t2.column1,
      t2.column2,
      t2.column3,
      dense_rank() over (partition by t2.column1, t2.column2 order by t2.column3) as rank
    from
      table1 t1
      inner join table2 t2 on t2.column2 = t1.column1) x
where
  x.rank = 1 
```

但是由于您没有使用 t1 中的任何字段，因此您可以省略连接。它可以用于过滤（也可以通过 using 来完成`exists`，但是由于 t1 是父表，因此 t2 中的所有记录无论如何都应该具有匹配的 t1 记录。

# algorithm - 距离矢量路由算法

> ID：13209963
> 
> 赞同：2
> 
> 时间：2012-11-03T14:16:14.453
> 
> 标签：algorithm, router

任何人都可以从基础解释距离矢量路由算法吗？过去几个小时以来，我一直在互联网上搜索材料，但没有任何地方以初学者可以理解的方式进行解释。要么用非常小的例子来解释（试图将算法应用于不同的例子似乎非常困难），要么解释得非常模糊。如果可能的话，请用一个“好”的例子来解释。

PS：我在理解路由器交换信息的确切时间和顺序方面存在很大的问题。我必须为此算法实现一个 C 或 C++ 程序。所以我试图完全理解它。提前致谢 。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-04T12:40:21.757

```
Start with distance-vector:
    0 for self,
    D for neighbor at distance D.

Every 30 seconds,
    For each neighbor,
        Send the current distance vector, with entries that pass trough
            that neighbor set to 16.

When receiving a distance-vector from a neighbor,
    Save the received distance vector.
    If any estimated distance, trough this neighbor, has changed,
        Update the current vector, but cap at 16.

When 180 seconds has passed since the last message from some neighbor,
    Set it's distance to 16.
    Send the updated distance vector as above. 
```

180 秒是标准超时值。16 的距离被认为是无穷大。

由于节点不会立即知道网络中的每个其他节点，因此它不能立即添加所有列。最简单的方法是使用表格：

```
(Neighbor, Destination, Distance) 
```

当前向量将是每个目的地的最小距离加一。

上面的伪代码实现了*水平分割*和*中毒反向*，但没有*触发更新*

* * *

**阅读更多：**

*   [http://www.ietf.org/rfc/rfc2453.txt](http://www.ietf.org/rfc/rfc2453.txt)

# asp.net-mvc - 使用自己的模型视图控制器文件夹创建组件。并为他们改变路线？

> ID：13209964
> 
> 赞同：1
> 
> 时间：2012-11-03T14:16:14.797
> 
> 标签：asp.net-mvc, asp.net-mvc-4, asp.net-mvc-routing

我的问题是我有一个 MVC4 项目，我想创建一些组件，我想使用部分视图在某些视图中添加这些组件。我将向您展示我想在我的 MVC 项目中创建的文件夹逻辑的图片。

![在此处输入图像描述](../Images/47ab992e64a64fddb4657bca1174735a.png)

从这里我如何添加这个部分视图，因为当我尝试访问它们时，它们首先在我的应用程序的主 Views 文件夹中查看，有没有办法为我的应用程序创建自定义路由？

```
@{ Html.RenderPartial("Components\\Chart\\View\\Index.cshtml");  } 
```

这给出了这样的错误。

> 未找到部分视图“组件\图表\视图\索引.cshtml”或没有视图引擎支持搜索的位置。搜索了以下位置：~/Views/Home/Conmponents\Chart\View\Index.cshtml.aspx ~/Views/Home/Conmponents\Chart\View\Index.cshtml.ascx ~/Views/Shared/Conmponents\Chart\ View\Index.cshtml.aspx ~/Views/Shared/Conmponents\Chart\View\Index.cshtml.ascx ~/Views/Home/Conmponents\Chart\View\Index.cshtml.cshtml ~/Views/Home/Conmponents\Chart \View\Index.cshtml.vbhtml ~/Views/Shared/Conmponents\Chart\View\Index.cshtml.cshtml ~/Views/Shared/Conmponents\Chart\View\Index.cshtml.vbhtml

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T14:23:04.067

您可以指定使用`~`作为项目目录的路径。

```
Html.RenderPartial("~/Components/Chart/View/Index.cshtml",model) 
```

这个问题也与路由无关。路由是将传入请求映射到您的操作方法。ASP.NET MVC 尝试使用控制器和操作名称来定位您的视图。如果它不存在，它还会检查共享文件夹。您可以通过指定确切路径来覆盖此行为，如上例所示。

**更新：**

您还必须对 View 文件夹进行一些配置。将您的 Web.config 复制**到默认 Views 文件夹中**或将所有视图配置移动到项目的 Web.config 文件应该可以解决问题。

# javascript - Texarea onfocus，使用 javascript 进行模糊处理

> ID：13209965
> 
> 赞同：0
> 
> 时间：2012-11-03T14:16:17.203
> 
> 标签：javascript, html, forms, textarea

我正在寻找一种使用 JavaScript 控制 textarea 的默认值、onfocus 和 onblur 的方法

*（我知道：
- textarea 中的默认值是：`<textarea name="text"> Default value </textarea>`
- 有一些使用 html5 和 jQuery 的解决方案。但在这里我正在寻找一个纯 JavaScript 解决方案）*

我可以将此应用于 textarea 吗？：

```
form name="form1" action="comprovar.php" method="post">
    <input type="text" name="name" value="name" 
        onfocus="if (this.value=='name') this.value = '';" 
        onblur="if (this.value=='') this.value = 'name';"   
    />
 </form> 
```

我怎样才能在这里获得焦点和模糊？：

```
<textarea name="text">  Write here </textarea> 
```

这个例子住在这里：http: [//jsfiddle.net/sKvMa/](http://jsfiddle.net/sKvMa/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T14:22:51.037

您可以像从输入中一样拥有*和*在`onfocus`文本`onblur`区域上。看到这个演示：http: [//jsfiddle.net/sKvMa/1/](http://jsfiddle.net/sKvMa/1/)

 *```
<textarea name="text" 
    onfocus="if (this.value=='Write here') this.value = '';" 
    onblur="if (this.value=='') this.value = 'Write here';" >Write here</textarea> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-03T14:25:24.430

您实际上可以完全不使用 JavaScript 来实现这一点，尽管它是 HTML5 的一个特性，因此它适用于现代浏览器。

```
<textarea name="text" placeholder="Write here"></textarea> 
```

根据您使用占位符的目的，这可能适合您，因为实现和维护脚本解决方案要简单得多。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-03T14:26:55.573

在新浏览器中，您可以使用`placeholder`属性。[jsfiddle](http://jsfiddle.net/sKvMa/7/) 对于不支持 placeHolder 的浏览器

```
 if( !'placeholder' in document.createElement("input") ){

        var input =  document.getElementsByTagName("input"),
            textArea = document.getElementsByTagName("textarea");
    for(var k = 0; k < input.length; k++){
         input[k].value= "name";
        input[k].onblur = function(){
            if(this.value == "") this.value = "name"
        }
        input[k].onfocus = function(){
            if(this.value == "name") this.value = ""
        }
    }
    for(var k = 0; k < textArea .length; k++){
          textArea [k].value= "name";
        textArea [k].onblur = function(){
            if(this.value == "") this.value = "name"
        }
        textArea [k].onfocus = function(){
            if(this.value == "name") this.value = ""
        }
    }
}
​​ 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-03T14:24:34.613

或者你可以像这样从 jQuery 定位

```
var mytext = $("textarea[name='text']").val(); 
```

然后你可以比较文本

```
if (mytext == 'Write here')
  //do this
else
  //do that 
```*

# jquery - 为周计划计划建立完整的日历

> ID：13209966
> 
> 赞同：0
> 
> 时间：2012-11-03T14:16:17.673
> 
> 标签：jquery, ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.2

我正在尝试为 Rails 上 1 周的日程安排制定计划。

现在我正在研究 jquery 插件[FullCalendar](http://arshaw.com/fullcalendar/)。

它提供了具有不同时间段和可拖动事件的每周视图，这是我需要的功能。但是，当我只需要一个星期时，它确实计划了一个完整的时间范围。

我是 jQuery 的新手，所以如果有人能指导我在我的应用程序中使用这个插件是否是一个好主意，我将不胜感激。如果是，我应该怎么做，如果不是，还有其他更好的建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T14:23:17.083

我在这个插件上工作以添加新标签以及月、周和日。在这种情况下，您可以删除月份和日期选项卡，因此它仅适用于当前一周。

然后你改变源，它会显示你想要的星期。

例如，如果您查看日历初始化，它看起来像

```
header: {
            left: 'prevYear,prev,next,nextYear today',
            center: 'title',
            right: 'month,agendaWeek,agendaDay'
        } 
```

如果你看到属性`right`，你可以看到月份、议程周、议程日（都是关键字）。尝试删除月份和议程日，您将只看到议程周。fullCalendar 还支持其他类型的周显示。打开插件或阅读文档。如果幸运的话，它可能已经可用，或者编辑插件没什么大不了的。毕竟它的javascript

# android - 更改 TextView 颜色

> ID：13209977
> 
> 赞同：2
> 
> 时间：2012-11-03T14:17:26.860
> 
> 标签：android, textview

如何更改单个 TextView 的 R、G、B？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T14:25:30.877

TextViews 没有亮度属性。它们的前景色和背景色使用 ARGB 值设置，例如：0xff000000 用于不透明的黑色背景，0xffffffff 用于不透明的白色前景。

要增加亮度，只需将所有 R、G 和 B 增加相同的量。

要更改 TextView 的颜色，可以使用`android:background`和`android:textColor`xml 属性。

# android - 列出文件并获取它们的路径（位置）

> ID：13209981
> 
> 赞同：1
> 
> 时间：2012-11-03T14:17:42.973
> 
> 标签：android, client, sftp

我创建了一个 Android ftp 客户端，我在 Ubuntu 中创建了一个 stfp 服务器，我连接了服务器，但是我需要一个代码来列出文件并从列表中选择一个文件，最后学习所选文件的路径。这是连接代码：

```
 try {
    JSch jsch = new JSch();
    Session session = null;
    session = jsch.getSession("***", "***.***.***.***",22);
    session.setConfig("StrictHostKeyChecking", "no");
    session.setPassword("****");
    session.connect();                  
    Channel channel = session.openChannel("sftp");
    channel.connect();
    ChannelSftp sftpChannel = (ChannelSftp) channel;
    sftpChannel.exit(); 
    session.disconnect();                   
} catch (JSchException e) {
    writeToSDFile(" "+e.toString());    
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T07:07:00.650

您必须使用`ls`命令列出指定文件夹中的文件。[你可以在这里](http://epaul.github.com/jsch-documentation/javadoc/)找到 JSCH API javadoc

```
 sftpChannel .ls(filesPath); 
```

我不明白你所说的“学习所选文件的路径”是什么意思？当您只有路径时，您可以列出该文件夹的所有文件。

# objective-c - 从自定义按钮更改为另一个视图

> ID：13209989
> 
> 赞同：0
> 
> 时间：2012-11-03T14:18:40.537
> 
> 标签：objective-c, ios, cocoa-touch

刚开始为 Xcode 和 iphone dev 提供了一个不错的小教程。我创建了一个简单的单视图项目。我在 ViewDidLoad (ViewController.m)which*the button) 中添加了自定义按钮的代码，它指向 showAboutPage 函数

```
[aboutBtn addTarget:self action:@selector(showAboutPage) forControlEvents:(UIControlEventTouchUpInside)]; 
```

我的按钮显示正确，并且具有突出显示、颜色、字体的所有必要代码。

我应该在里面实现什么代码

```
- (void) showAboutPage
{

} 
```

为了推入第二个视图（redView.xib）。玩故事板很容易，我可以通过“连接线”/拖放来做到这一点，但是我想要以编程方式学习，所以我可以学习正确的方法。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T15:42:30.777

您的视图的第一个字母应该大写，redView=>RedView。另一个建议是我认为使用 IBAction 比将目标添加到按钮更好。添加 RedView.h、RedView.m 和 RedView.xib 后，您应该在 Interface Builder 中将 RedView.xib 的类设置为 RedView。然后你可以像这样使用它：

```
- (void) showAboutPage
{
    RedView *redView = [[[NSBundle mainBundle] loadNibNamed:@"RedView" owner:self options:nil]] objectAtIndex:0];
    [self.view addSubview:redView];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T14:31:16.740

假设您在视图控制器类中执行所有这些操作（这是我从您的描述中推断出来的）：

```
- (void)showAboutPage
{
    AboutPageViewController *about = [[AboutPageViewController alloc] init];
    [self presentViewController:about animated:YES];
    // If you're not using ARC:
    [about release];
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-03T15:44:19.940

虽然@H2CO3 提供了非常正确的答案，但我想补充一点，只要您喜欢使用 Interface Builder，您也可以使用更少的代码和更多的结构来做到这一点。在 IB 中进行从 ViewController1 到 ViewController 2 的 segue，将其标识符设置为唯一的，比如说`ToViewController2`. 那么您的方法可能如下所示：

```
- (void) showAboutPage {
    [self performSegueWithIdentifier:@"ToViewController2" sender:self];
} 
```

假设您也想传递一些变量，您可以这样做：

```
- (void) prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender {
    if ([segue.identifier isEqualToString:@"ToViewController2"]) {
        [segue destinationViewController setYourVariable:variable];
        // Pass your variables on to the next view here.
    }
} 
```

这样做的好处是，应该传递给下一个 ViewControllers 的所有东西，假设你有几个来自那个 ViewController 的 segue，都在这个方法中传递。

# clojure - clojure 中的解构映射——未使用的键

> ID：13209994
> 
> 赞同：7
> 
> 时间：2012-11-03T14:19:14.813
> 
> 标签：clojure, destructuring

我已经定义了一个带有地图的函数。我想使用解构来访问这些值。但是，我还想检查是否有任何使用过的键。

所以，例如像......

```
 (defun func1 [{:keys [a b c] :rest rest}]
    (println a b c)
    (println rest))

 (func1 {:a 1 :b 2 :c 3 :d 4}) 
```

这将打印

```
 1 2 3
 4 
```

我想要这个的原因是，如果 rest 不为空，这可能是一个错误，我想发出信号。我知道 :as，我可以使用它。但是我需要将有效密钥列表存储两次。

我错过了什么吗？

菲尔

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-03T14:40:08.733

我真的不明白为什么你会想知道是否有一些你不关心的事情。如果您正在尝试执行诸如“使用这些键执行特定操作，并使用其他键执行通用操作”之类的操作，则可以执行以下操作：

```
(defn func [& {:keys [a b] :as args}]
  (println a b c)
  (println (dissoc args :a :b)))

(func :a 3 :b :c 5) =>
  3 4
  {:c 5}
  nil 
```

如果您对必须两次提及关键字感到偏执，您可能也可以为此做点什么，但我无法想象这会是值得的。

> > 我想要这个的原因是，如果 rest 不为空，这可能是一个错误，我想发出信号。

如果您担心用户传入的数据不*完全*符合您的要求，那么地图可能不是正确使用的数据结构。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-10-30T16:40:22.273

如果您关心对给定地图强制执行结构，[`Schema`](https://github.com/Prismatic/schema)可能是一个不错的选择（来自 的第一个示例`README`）：

```
(ns schema-examples
  (:require [schema.core :as s
             :include-macros true ;; cljs only
             ]))

(def Data
  "A schema for a nested data type"
  {:a {:b s/Str
       :c s/Int}
   :d [{:e s/Keyword
        :f [s/Num]}]})

(s/validate
  Data
  {:a {:b "abc"
       :c 123}
   :d [{:e :bc
        :f [12.2 13 100]}
       {:e :bc
        :f [-1]}]})
;; Success!

(s/validate
  Data
  {:a {:b 123
       :c "ABC"}})
;; Exception -- Value does not match schema:
;;  {:a {:b (not (instance? java.lang.String 123)),
;;       :c (not (integer? "ABC"))},
;;   :d missing-required-key} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-03-17T18:47:53.563

（菲尔勋爵，毫无疑问，OP 已经转向了其他问题，但对于任何有类似问题的人来说，这是一个可能的解决方案。）

您可以`count`用来测试地图是否具有正确数量的键：

```
(count {:a 1 :b 2 :c 3 :d 4}) ;=> 4 
```

这将返回 key/val 对的数量。只要您单独测试地图是否具有*所需*的键，知道键太多就会告诉您是否还有其他键。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-03-10T11:18:22.543

我喜欢[管道](https://github.com/plumatic/plumbing)如何做到这一点：

```
(use '[plumbing.core])
(defnk f1 [a b c & rest]
    (prn [a b c])
    (prn rest))
(f1 {:a 1 :b 2 :c 66 :z "fake"})

[1 2 66]
{:z "fake"}
=> nil 
```

# asp.net-mvc-3 - asp.net mvc 虚拟视图和 web 配置

> ID：13209998
> 
> 赞同：1
> 
> 时间：2012-11-03T14:19:28.507
> 
> 标签：asp.net-mvc-3, razor, virtualpathprovider

有很多例子展示了如何从文件或数据库中存储和检索虚拟视图，但没有一个例子展示了如何配置 root web.config 以便应用程序正常工作，当视图的内容从文件中检索并包含例如`@ViewBag.Title = "Some Title"`线。

在这种情况下，我得到*CS0103: The name 'ViewBag' does not exist in the current context*错误，就像我从 ~/Views 项目文件夹中删除 web.config 的情况一样。

那么，为了修复上述错误，从 ~/Views/web.config 到 root web.config 的哪些配置元素？

是否可以在运行时将配置元素加载到程序集中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T14:55:41.433

问题与以下事实有关：在虚拟视图的情况下，从文件或数据库中检索内容的视图继承自`System.Web.Mvc.ViewStartPage`包含 Html 和 Url，但不包含 ViewBag 或 Ajax 属性的视图。虚拟视图引用如下

```
public class DynamicViewsController : Controller
{
    public ActionResult GetView()
    {
        //SomeModel model = new SomeModel() { Count = 1 };
        return View("/Virtual/VirtualViewToShow.cshtml");
    }
} 
```

位于 ~/Views/ 文件夹中的视图继承自 System.Web.Mvc.WebViewPage，其中定义了 ViewBag 和 ViewData 以及 Ajax 属性。

更改操作方法的解决方法如下

```
public PartialViewResult GetView()
{
    //SomeModel model = new SomeModel() { Count = 1 };
    return PartialView("/Virtual/VirtualViewToShow.cshtml");
} 
```

并添加

```
 @{
        Layout = "~/Views/Shared/_Layout.cshtml";
   } 
```

到虚拟视图的文本，以便也加载布局。我不知道虚拟视图继承自的原因`System.Web.Mvc.ViewStartPage`，但我会尝试在另一个线程中找到原因，并在创建线程时发布链接。

**已编辑**

所以说新创建的线程的链接在[这里](https://stackoverflow.com/questions/13363273/virtual-view-inheriting-from-system-web-mvc-viewstartpage)

附上“显示完整编译源”截图![在此处输入图像描述](../Images/3d90f79f13ab92d580ec018753531f82.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-09T17:33:12.723

按照上面提到的步骤，你就完成了！

*   **将 ~/views/web.config 的<configSections>**部分与根级别 web.config合并
*   现在只需将**<system.web.webPages.razor>**部分从 ~/views/web.config 移动到根级别 web.config
*   干杯:) 它完成了。
*   您还应该将**<appSettings>、<system.web> 和 <system.webServer>**与根级别的 web.config 合并。

# emacs - 如何注释掉paredit中的当前行？

> ID：13209999
> 
> 赞同：1
> 
> 时间：2012-11-03T14:19:28.180
> 
> 标签：emacs, comments, paredit

在遇到 paredit 模式之前，我使用`M-;`注释掉当前行或注释掉带有标记集的区域。

但是在paredit模式下，除非我手动`C-a`插入或在我之前标记行，否则我似乎无法注释掉当前行，因为在这种模式下，在行首使用将插入行上方和中间或末尾of line 将插入一个行尾注释。`;``M-;``M-;``;;;`

所以我的问题是如何以更优雅的方式注释掉当前行？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-07-16T13:17:24.243

我不认为 paredit 提供任何命令来注释掉一行，所以我将分享一个无论是否使用 paredit 都有效的提示。

假设您有以下代码：

```
(defun my-hi ()
  (dotimes (_ 2)
    (print "hello")
    (print (+ 1
              2))
    (print "world"))
  (print "the end")) 
```

如果要注释掉第三行，只需选择表达式，然后按`M-;`。也就是说，您将点移动到表达式之前的任何空白处`(print "hello")`，然后按`C-M-SPC`选择表达式，然后按`M-;`注释掉表达式。

如果你想注释掉两行，例如，如果你想注释掉`(print (+ 1 2))`跨越两行的表达式怎么办？同理，将点移动到表达式开头之前的任意空白处，然后按`C-M-SPC M-;`。

现在，如果您想注释掉包含表达式的行`(print "world")`怎么办？但这是个坏主意。相反，您只想注释掉表达式`(print "world")`。怎么做？又是一样的。

如果你想注释掉循环中除了第一个语句之外的所有语句，也就是说，如果你想注释掉`(print (+ 1 2))`and`(print "hello")`怎么办？将点移到要注释掉的第一个表达式的开头，然后按`C-M-SPC` **两次**选择两个表达式，然后按`M-;`。

选择表达式（相对于选择行）不仅更安全（在不引入不匹配括号的意义上），而且更方便。例如，您将如何注释掉 dotimes 表单？使用`C-M-SPC`全选dotimes表格比一选一选五行更方便。

这里故事的寓意类似于 Vim 的以下寓意：“在 Vim 中，诀窍是你使用文本对象（单词、行、句子、代码块等），而不是字母。”

在 Lisp 编辑中，诀窍是您使用表达式（sexps），而不是使用线条或字母。

为了使事情更方便，您可能希望定义一个命令，注释掉点后面的前 N ​​个表达式，其中 N 由命令连续调用的次数或前缀参数指定。或者一个命令，它在点之后注释掉一个表达式并将点移动到下一个表达式的开头，如果有的话。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-03T19:16:35.447

如果你真的想注释掉当前行，输入 Cq ；在行的开头。

问题是那几乎从来都不是你想要的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-06-13T18:20:51.767

只需键入`;`以注释掉从该点开始可以在该行上注释的所有内容。（后面的任何结束分隔符都将移到下一行。）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-01-19T02:52:44.933

如果试图评论一个空行或一个行的结尾，只需使用`;`光标所在的`;`位置。在注释掉*代码*时，应该考虑注释掉一个*s 表达式*而不是一行。这样可以保持括号的平衡。Paredit 为此提供了一个有用的界面。

该`;`键可用于较低级别的表单，它们将由paredit*自动平衡*，尽管我觉得它更难看：（光标是`|`但不是`#|`or `|#`）

```
(foo (bar | baz) quuz) 
```

变成：

```
(foo (bar ; baz
  ) quuz) 
```

但

```
|(blah bla bl a) 
```

**产生错误**。

如果安装了 SLIME，那么`slime-insert-balanced-comments`可以使用它会很高兴地插入注释**，同时保持平衡的括号**。这条评论恰好是一个使用`#|`and的读取宏`|#`。总是受欢迎的，`C-q ;`但这**会使他们不平衡**。paredit的全部意义在于保持它们的平衡。

```
(|defun (blah) blah) -> #|(defun (blah) blah)|# 
```

它注释掉可能的最低级别的形式：

```
(foo (bar | fuux) duux) -> (foo #|(bar | fuux)|# duux) 
```

我的`.emacs.el`文件中有这个，因为`slime-insert-balanced-comments`默认情况下没有绑定到键。

```
(global-set-key (kbd "C-c ;") 'slime-insert-balanced-comments) 
```