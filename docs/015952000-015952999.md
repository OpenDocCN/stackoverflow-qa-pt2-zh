# StackOverflow 问答 15952000-15952999

# javascript - 如何在不传输值的情况下克隆字段集

> ID：15952003
> 
> 赞同：0
> 
> 时间：2013-04-11T14:51:57.777
> 
> 标签：javascript, jquery, hidden-field, cloning

我正在尝试克隆具有选择而不克隆输入的字段集。（我需要空白）。我在表单的正文中创建了一个隐藏的字段集，但不是表单本身，但我似乎无法让它工作

```
 <div id="analyte" style="display: none">
 <div class="_40">
 <label class="analyte-label" for="analyte">Analyte:</label>
    <input class="analyte" type="text" id="analyte1" name="analyte" value=""> </div>
 <div class="_30">
     <label class="preserved-label" for="preserved">Preserved</label>
 <select class="select_preserved" id="preserved1" name="preserved" data-iconpos="left" data-icon="grid" data-native-menu="false" >
        <option value = ""></option>
           <option value = "HNO3">HNO&#8323;</sub></option>
           <option value = "H2SO4">H&#8322;SO&#8324;</option>
           <option value = "H3PO4">H&#8323;PO&#8324;</option>
           <option value = "HCL">HCL</option>
           <option value = "None1">None</option>
    </select></div></div> 
```

然后我在表格中使用此代码

```
 <input type="button" id="add_Analyte" onclick="add_Analyte" value="ADD ANALYTE" /></div>
<script>
$(document).ready(function() {
var _counter = 0;
function add_Analyte() {
_counter++;
var newFields = document.getElementById("Analyte").cloneNode(true);
newFields.id = "";
newFields.style.display = "block";
var newField = newFields.childNodes;
for (var i=0;i<newField.length;i++) {
var theName = newField[i].name
    if (theName)
        newField[i].name = theName + counter;
}
var insertHere = document.getElementById("addAnalyte");
insertHere.parentNode.insertBefore(newFields,insertHere);
}
})
</script> 
```

# javascript - 编写一个遍历未知深度的嵌套循环的递归函数

> ID：15952005
> 
> 赞同：0
> 
> 时间：2013-04-11T14:52:03.690
> 
> 标签：javascript, recursion, iteration

给定一个值数组：

```
var values = new Array(); 

array.push(2);
array.push(3);
array.push(4); 
```

我想创建一个迭代函数，它可以存储任何可能的值组合，用于任何长度的数组。

例如，在这种情况下，可能的值为 (1,1,1)(1,1,2)(1,1,3)(1,1,4)(1,2,1)(1,2 ,2)(1,2,3)(1,2,4)(2,1,1)(2,1,2)(2,1,3)(2,1,4)(2,2, 1)(2,2,2)(2,2,3)(2,2,4)

我知道要做到这一点，我需要使用递归函数，如果没有达到最大深度，它将更深一层并再次调用该函数......

我知道从哪里开始（可能，我想）

```
function iterativeLoop(level, depth) {
    for(var i = 0; i < values.length; i++) {
        if(level < depth) {
            iterativeloop(level+1, depth);
        }
        else if (level=depth) {
        }
   }
} 
```

我不确定一旦函数被调用得更深，我如何才能访问“上层”......即我不确定如何访问 (1,2,4) 而不仅仅是 (?,?,4)

我希望这是有道理的？

（对不起，我知道我的标题不是很好，我想不出如何简洁地解释它）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T15:47:03.863

> 我不确定一旦函数被调用得更深，我如何才能访问“上层”......即我不确定如何访问 (1,2,4) 而不仅仅是 (?,?,4)

您将需要传递它们，例如在一个数组中。

> ```
> for(var i = 0; i < values.length; i++) 
> ```

这不应该是要执行的外部迭代，除非您想在一个简单的嵌套循环中构造一个二维结果数组（见下文）。相反，您希望`value.length`成为递归的深度。在每个递归级别上，您将从 1 迭代到`values[level]`那时。而不是传递 a `level`，我们将传递一个当前状态的数组（上面的问号），其长度是级别。

```
var values = [2,3,4];
function recurse(state) {
    var level = state.length;
    var depth = values.length;
    if (level == depth) {
        console.log.apply(console, state); // or whatever you want to do
    } else {
        for (var i=1; i<=values[level]; i++) {
            state.push(i); // save current question mark
                           // notice state.length = level + 1 now
            recurse(state); // enter next level
            state.pop(); // delete it after we're so state doesn't grow infinitely :-)
        }
    }
}
recurse([]); 
```

* * *

如果要对值使用迭代，可以通过向结果数组添加越来越多的状态（每级增长一个值）来实现，最终将包含所有可能的组合：

```
var values = [2,3,4];
var result = [[]]; // one empty state at level 0
for (var i=0; i<values.length; i++) {
    var reslen = result.length,
        val = values[i];
    var mult = []; // will become the new result with a length of (reslen * val)
    for (var j=0; j<reslen; j++) {
        for (var k=1; k<=val; k++) {
            var state = result[j].slice(); // make a copy
            state.push(k);
            mult.push(state);
        }
    }
    result = mult;
}

// logging the `result` on each level will show us
// 0 - [[]]
// 1 - [[1],[2]]
// 2 - [[1,1],[1,2],[1,3],[2,1],[2,2],[2,3]]
// 3 - [[1,1,1],[1,1,2],[1,1,3],[1,1,4],[1,2,1],[1,2,2],[1,2,3],[1,2,4],[1,3,1],[1,3,2],[1,3,3],[1,3,4],[2,1,1],[2,1,2],[2,1,3],[2,1,4],[2,2,1],[2,2,2],[2,2,3],[2,2,4],[2,3,1],[2,3,2],[2,3,3],[2,3,4]] 
```

您可以看到这与@Jason 的方法有何相似之处。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T15:26:17.580

您不需要递归，因为任意数据集的长度是在运行时开始时定义的：

```
var numbers = [2,3,4];
var result_array = [];
var num_product = 1;
var i=0, j=0, k=0; // iterators

for (i=0; i<numbers.length; i++) {
    num_product *= numbers[i];
}
for (i=0; i<num_product; i++) {
    result_array.push([]);
}
for (i=0; i<result_array.length; i++) {
    product = 1;
    for (j=0; j<numbers.length; j++) {
        k = (Math.floor(i/product)%numbers[j]) + 1;
        product *= numbers[j];
        result_array[i][j] = k;
    }
} 
```

经过测试并适用于任意数量的数组元素。

[并行基准测试](http://jsperf.com/recursive-vs-non-recursive-so)显示此代码比递归代码快得多 - 如果您*能够*避免递归（例如，您预先知道足够的信息以能够定义整个问题），那么最好这样做，当前定义的问题允许您这样做。如果您只是想学习递归，那么这对您没有太大帮助:)

# ios - 为什么 KVO 观察者在观察无序对多关系时会看到一个空的 NSKeyValueChangeNewKey？

> ID：15952006
> 
> 赞同：0
> 
> 时间：2013-04-11T14:52:04.167
> 
> 标签：ios, cocoa-touch, key-value-observing

`UIViewController`当视图变得可见时，子类上有一个属性会发生变化。（一组不再为空。）我已经实现了 KVC/KVO，如下所示：

```
- (void)viewWillAppear:(BOOL)animated {
    [self willChangeValueForKey:@"anticipatedIndexPaths" withSetMutation:NSKeyValueSetSetMutation usingObjects:_anticipatedIndexPaths];

    [super viewWillAppear:animated];
}

- (void)viewDidAppear:(BOOL)animated {
    [super viewDidAppear:animated];

    assert([_anticipatedIndexPaths count]);
    [self didChangeValueForKey:@"anticipatedIndexPaths" withSetMutation:NSKeyValueSetSetMutation usingObjects:_anticipatedIndexPaths];
} 
```

该类的一个子类正在观察自身 for `@"anticipatedIndexPaths"`，但`NSKeyValueChangeNewKey`观察时的值`NSKeyValueChangeReplacement`始终是一个空集。是什么赋予了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T16:07:31.847

知道了。两件事情：

首先，至少对于无序对多关系，KVO 基础设施会在`willChange-:`通话中记录您的财产价值。On `didChange-:`，它只传递给定的集合*减去*前一个值。其次，在`viewWillAppear:`，甚至在`[super viewWillAppear:]`通话之前，`hidden == NO`。

就我而言，这意味着属性是返回非空集。KVO 减法的结果是空集。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T15:01:22.413

当你打电话时`addObserver:...`，你是否`NSKeyValueObservingOptionNew`作为一个选项通过？默认情况下，您不会获得此值。

# c++ - 插入和提取运算符不起作用

> ID：15952007
> 
> 赞同：0
> 
> 时间：2013-04-11T14:52:03.993
> 
> 标签：c++

只是在玩运算符重载，无法找出下面的代码有什么问题-

```
#include <iostream>

class Holder
{
public:
    std::string name;
    int data;
};

std::istream operator>>(std::istream& is, Holder &h)
{
    std::cout<<"Enter name = "<<std::endl;
    std::cin>>h.name;

    std::cout<<"Enter data = "<<std::endl;
    std::cin>>h.data;

    return is;
}

std::ostream operator<<(std::ostream& os, Holder const &h)
{
    std::cout<<"Name = "<<h.name<<std::endl;
    std::cout<<"Data = "<<h.data<<std::endl;

    return os;
}

int main(int argc, char **argv) {
    Holder h;
    std::cin>>h;
    std::cout<<h;
} 
```

我的 MinGW 编译器给出的错误是 -

```
In file included from c:\mingw\bin\../lib/gcc/mingw32/4.6.1/include/c++/ios:45:0,
                 from c:\mingw\bin\../lib/gcc/mingw32/4.6.1/include/c++/ostream:40,
                 from c:\mingw\bin\../lib/gcc/mingw32/4.6.1/include/c++/iostream:40,
                 from ..\src\Main.cpp:1:
c:\mingw\bin\../lib/gcc/mingw32/4.6.1/include/c++/bits/ios_base.h: In copy constructor 'std::basic_ios<char>::basic_ios(const std::basic_ios<char>&)':
c:\mingw\bin\../lib/gcc/mingw32/4.6.1/include/c++/bits/ios_base.h:788:5: error: 'std::ios_base::ios_base(const std::ios_base&)' is private
c:\mingw\bin\../lib/gcc/mingw32/4.6.1/include/c++/bits/basic_ios.h:64:11: error: within this context
In file included from c:\mingw\bin\../lib/gcc/mingw32/4.6.1/include/c++/iostream:41:0,
                 from ..\src\Main.cpp:1:
c:\mingw\bin\../lib/gcc/mingw32/4.6.1/include/c++/istream: In copy constructor 'std::basic_istream<char>::basic_istream(const std::basic_istream<char>&)':
c:\mingw\bin\../lib/gcc/mingw32/4.6.1/include/c++/istream:57:11: note: synthesized method 'std::basic_ios<char>::basic_ios(const std::basic_ios<char>&)' first required here 
..\src\Main.cpp: In function 'std::istream operator>>(std::istream&, Holder&)':
..\src\Main.cpp:18:9: note: synthesized method 'std::basic_istream<char>::basic_istream(const std::basic_istream<char>&)' first required here 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T14:54:26.877

通过引用返回：

```
std::istream& operator>>(std::istream& is, Holder &h)
std::ostream& operator<<(std::ostream& os, Holder const &h)
          //^ 
```

因为流是不可复制的。

# time-series - Java 中的时间序列预测

> ID：15952012
> 
> 赞同：1
> 
> 时间：2013-04-11T14:52:25.267
> 
> 标签：time-series, weka, forecasting

我正在尝试通过在 Java 中提供 2 个月的数据来运行 TimeseriesExample 代码来预测（预测）未来 6 个月的数据。我需要使用`WekaForecaster`对象。但我无法导入这两个文件：

```
import weka.classifiers.timeseries.WekaForecaster; 
import weka.classifiers.timeseries.core.TSLagMaker; 
```

这两个都显示错误。我已经导入了以下 jar 文件：

```
weka.jar,
pdm-timeseriesforecasting-ce-TRUNK-SNAPSHOT.jar,
jcommon-1.0.14.jar ,
jfreechart-1.0.13.jar 
```

但是上面的文件仍然没有导入，我缺少哪个 jar？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-07-01T07:31:46.553

使用“包管理器”（weka >=3.7）并安装 timeSeries 插件。然后将 weka-37.jar 添加到您的构建路径中。这里有一些关于插件的信息。

[Weka TimeSeries 插件](http://wiki.pentaho.com/display/DATAMINING/Time+Series+Analysis+and+Forecasting+with+Weka)

顺便说一句，我认为 2 个月的数据不足以预测 6 个月。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-11T20:39:20.537

您必须先安装 timeseriesForecasting 包，然后才能在代码中使用它。

包（jar 文件）可以在您的用户文件夹的 wekafiles 文件夹中找到。

您必须使用包管理器来执行此操作。

最好的，

# python - 在 Python 中使用 ReportLab 创建 PDF 时出错

> ID：15952014
> 
> 赞同：1
> 
> 时间：2013-04-11T14:52:25.940
> 
> 标签：python, reportlab

数据：

```
['<p>Work! please work.img:0\xc3\x82\xc2\xa0Will you?img:1</p>img:2img:3\xc3\x82\xc2\xa0ascasdacasdadasdaca HAHAHAHAHA! BAND!\n', '\n', "<p>Random test.</p><p><br />If you want to start a flame war, mention lines of code per day or hour in a developer\xc3\xa2&euro;&trade;s public forum. At least that is what I found when I started investigating how many lines of code are written per day per programmer. Lines of code, or loc for short, are supposedly a terrible metric for measuring programmer productivity and empirically I agree with this. There are too many variables involved starting with the definition of a line of code and going all the way up to the complexity of the requirements. There are single lines that take a long time to get right and there many lines which are mindless boilerplate code. All the same this measurement does have information encoded in it; the hard part is extracting that information and drawing the correct conclusions. Unfortunately I don\xc3\xa2&euro;&trade;t have access to enough data about software projects to provide a statistically sound analysis but I got a very interesting result from measuring two very different projects that I would like to share.</p><p>The first project is a traditional client server data mining tool for a vertical market mostly built in VB.NET and WinForms. This project started in 2003 and has been through several releases and an upgrade from .NET 1.1 to .NET 2.0\. It has server components but most of the half a million lines of code lives in the client side. The team has always had around four developers although not always the same people. The average lines of code for this project came in at around ninety lines of code per day per developer. I wasn\xc3\xa2&euro;&trade;t able to measure the SQL in the stored procedures so this number is slightly inflated.</p><p><em>The second project is much smaller adding up to ten thousand lines of C# plus seven thousand lines of XAML c</em>reated by a team of four that also worked on the first project. This project lasted three months and it is a WPF point of sale application thus very different in scope from the first project. <strong>It was built around a number of web services in SOA fashion and does not have a database per se. Its average came up around seventy lines of code per developer per day.</strong></p><p>I am very surprised with the closeness of these numbers, especially given the difference in size and scope of the products. The commonality between them are the .NET framework and the team and one of them may be the key. Of these two, I am leaning to the .NET framework being the unifier because although the developers worked on both projects, three of elements on the team of the second project have spent less than a year on the first project and did not belong to the core team that wrote the vast majority of that first product. Or maybe there is something more general at work here?</p><p>The first step in using the WP_Filesystem is requesting credentials from the user. The normal way this is accomplished is at the time when you're saving the results of a form input, or you have otherwise determined that you need to write to a file.</p><p>The credentials form can be displayed onto an admin page by using the following code:</p><pre>$url = wp_nonce_url('themes.php?page=example','example-theme-options');\n</pre>", "if (false === ($creds = request_filesystem_credentials($url, '', false, false, null) ) ) {\n", '\treturn; // stop processing here\n', '}\n', '<p>The request_filesystem_credentials() call takes five arguments.</p><ul><li>The URL to which the form should be submitted (a nonced URL to a theme page was used in the example above)</li><li>A method override (normally you should leave this as the empty string: "")</li><li>An error flag (normally false unless an error is detected, see below)</li><li>A context directory (false, or a specific directory path that you want to test for access)</li><li>Form fields (an array of form field names from your previous form that you wish to "pass-through" the resulting credentials form, or null if there are none)</li></ul><p>The request_filesystem_credentials call will test to see if it is capable of writing to the local filesystem directly without credentials first. If this is the case, then it will return true and not do anything. Your code can then proceed to use the WP_Filesystem class.</p><p>The request_filesystem_credentials call also takes into account hardcoded information, such as hostname or username or password, which has been inserted into the wp-config.php file using defines. If these are pre-defined in that file, then this call will return that information instead of displaying a form, bypassing the form for the user.</p><p>If it does need credentials from the user, then it will output the FTP information form and return false. In this case, you should stop processing further, in order to allow the user to input credentials. Any form fields names you specified will be included in the resulting form as hidden inputs, and will be returned when the user resubmits the form, this time with FTP credentials.</p><p>Note: Do not use the reserved names of hostname, username, password, public_key, or private_key for your own inputs. These are used by the credentials form itself. Alternatively, if you do use them, the request_filesystem_credentials function will assume that they are the incoming FTP credentials.</p><p>When the credentials form is submitted, it will look in the incoming POST data for these fields, and if found, it will return them in an array suitable for passing to WP_Filesystem, which is the next step.</p><p><a id="Initializing_WP_Filesystem_Base" name="Initializing_WP_Filesystem_Base"></a>'] 
```

我使用 ReportLab 将其转换为 pdf，但它失败了。这是我的 ReportLab 代码：

```
for page in self.pagelist:
            self.image_parser(page)
            print page.content
            for i in range(0,len(page.content)):
                bogustext = page.content[i]
                while (len(re.findall(r'img:?',bogustext)) > 0):
                    for m in re.finditer( r'img:?', bogustext ):
                        image_tag = bogustext[m.start():m.end()+1]
                        print (image_tag.split(':')[1])
                        im = Image(page.images[int(image_tag.split(':')[1])],width=2*inch, height=2*inch)
                        Story.append(Paragraph(bogustext[0:m.start()], style))
                        bogustext = bogustext.replace(bogustext[0:m.start()],'') 
                        Story.append(im)
                        bogustext = bogustext.replace(image_tag,'')
                        break
                p = Paragraph(bogustext,style)
                Story.append(p)
                Story.append(Spacer(1,0.2*inch)) 
```

page 是哪个 page.content 包含我上面提到的数据的类。

self.image(page) 是一个删除 page.content(Data) 中所有图片 url 的函数。

错误：

```
xml parser error (invalid attribute name id) in paragraph beginning
'<p>The request_filesystem_cred' 
```

如果我为列表中的每个元素生成一个 PDF，我不会收到此错误，但如果我尝试从中制作完整的 PDF，我会得到一个。我哪里错了？

# c# - pdf输出上的iTextSharp短语字符串加倍

> ID：15952017
> 
> 赞同：0
> 
> 时间：2013-04-11T14:52:34.483
> 
> 标签：c#, winforms, itextsharp

我对使用 iTextSharp 生成 pdf 非常陌生。我有以下代码将表单中的文本放置到 pdf 输出中。我正在使用 Phrase & ColumnText 将特定文本框中的文本定位到我的 pdf 输出中。我将一个变量以及文本框的文本属性绑定为短语字符串，但它将两组相同的文本放在一起（屏幕截图）。 ![在此处输入图像描述](https://i.stack.imgur.com/wb3EK.jpg)

```
string oldFile = Path.GetTempPath() + "invoice.pdf";
string newFile = Path.GetTempPath() + "NewInvoice.pdf";
PdfReader reader = new PdfReader(oldFile);
iTextSharp.text.Rectangle size = reader.GetPageSize(1);
Document doc = new Document(size);
FileStream fs = new FileStream(newFile, FileMode.Create, FileAccess.Write, FileShare.ReadWrite);
PdfWriter writer = PdfWriter.GetInstance(doc, fs);
doc.Open();
PdfContentByte cb = writer.DirectContent;
BaseFont bf = BaseFont.CreateFont(BaseFont.HELVETICA, BaseFont.CP1252, true);
cb.SetColorFill(BaseColor.BLACK);
cb.SetFontAndSize(bf, 12);
cb.BeginText();
cb.ShowTextAligned(PdfContentByte.ALIGN_LEFT, invoiceDate, 480, 603, 0);
cb.EndText();
PdfImportedPage page = writer.GetImportedPage(reader, 1);
cb.AddTemplate(page, 0, 0);

ColumnText ct = new ColumnText(cb);
Phrase phrase = new Phrase(textBox1.Text);
ct.SetSimpleColumn(phrase, 65, 375, 540, 300, 16, Element.ALIGN_LEFT);
ct.Go();
doc.Close();
fs.Close();
writer.Close();
reader.Close();
Process.Start(newFile); 
```

如果我分配一个字符串（字符串任何内容=“这里的一些文本...”；）并将其放在短语字符串中（..new Phrase（whatever）；它工作正常。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T15:03:45.753

首先让我说我是 iText 的原始开发者。

当我说你应该使用`PdfReader`/`PdfStamper`组合而不是`Document`/组合时，我希望你会相信我`PdfWriter`。这在我的书的[第 6 章中有记录。](http://www.manning.com/lowagie2/samplechapter6.pdf)您可能在外观上看不到任何差异，但 PDF 的内部感觉要好得多。

您在绝对位置添加文本有点奇怪。使用在需要文本的位置有一些 AcroForm 字段的模板不是更好吗？您的代码将更容易维护。

我还看到您正在使用`HELVETICA`as 字体，其中嵌入的参数等于 true。您肯定知道`embedded`参数将被忽略，因为`HELVETICA`它是标准类型 1 字体之一。

最后是您的问题：我认为您的代码不会两次添加该短语。我认为您一直在尝试，并且您正在在原始文件“invoice.pdf”中已经存在的短语上添加一个新短语。如果您 100% 认为情况并非如此，那么您应该共享您的 PDF，以便我（或 iText 的其他人）可以检查它。

# c++ - 如何将 d3dx9_43.dll 打包到我的应用程序中？

> ID：15952018
> 
> 赞同：2
> 
> 时间：2013-04-11T14:52:40.997
> 
> 标签：c++, dll

我做了一个小游戏，我需要带它去学校进行一些测试。

不幸的是，作为一个学校系统，我需要打包所有尚未安装的 DLL 以便它运行。在计算机上安装任何东西都是不可能的。几天前当我下线时，我注意到由于缺少 d3dx9_43.dll 文件，应用程序无法启动。

我已经静态链接了我使用过的库，并且对为什么不包括在内感到困惑。我引用了我使用的所有 Direct3D 9 库（或者我认为是这样）。

谁能帮我吗？

我正在使用 Visual Studio C++ 2010 并使用 Direct3D 9。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T15:13:48.240

遵守许可的唯一选择是安装可再发行包。

早期版本的 D3DX 确实支持静态链接，但出于安全原因，MS 更改了规则以禁止静态链接。他们希望能够通过 WINdows Update 为这些 DLL 提供服务，而这只有在使用官方可再发行包安装时才有可能。

一种可能的选择是查看是否可以避免链接到 D3DX。可能是您使用的该库的占用空间足够小，您可以绕过它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-11T15:01:08.990

它应该通过在应用程序安装程序中包含 DirectX 9.0 Redistributable 包来完成，但是由于您无法安装任何东西，您必须将所有 dll 与您的可执行文件一起发送（这违反 SDK 许可证）或静态链接到 DirectX运行时（这也可能是不允许的）。

静态链接到 DirectX 运行时不是一个好主意，而且并不像看起来那么简单，我什至不确定它是否可能，但你必须拥有实际的静态库（而不是自己实际链接的静态库） dll）。

因此，最简单的解决方案是将所有需要的 DLL 与 exe 一起保存，如果您担心缺少一个依赖项，您可以使用[Dependency Walker](http://www.dependencywalker.com)。**请注意，SDK 许可不允许此解决方案，并且不能用于将应用程序实际分发给最终用户。**

# c# - 使用 IP 欺骗对 TCP 进行负载测试

> ID：15952029
> 
> 赞同：1
> 
> 时间：2013-04-11T14:53:13.803
> 
> 标签：c#, tcp, ip, load-testing

我试图想出一种方法来负载测试以下架构：

我们有一个应用服务器，它从多个服务器上接收数据，这些服务器上有数据收集代理。

但是，我们的测试环境只有一个带有代理的服务器，我们希望模拟从同一服务器传出到应用程序服务器的多个 (100) 连接。

我已经为代理机器上的 NIS 卡分配了广泛的 IP，但是我无法找到一种方法来使从机器到应用服务器的每个传出连接都使用不同的 IP，从而打开一个新的连接。

我知道在遇到此问题时，对 HTTP 协议的 Web 测试可以轻松使用虚拟用户和 IP 欺骗工具，但由于代理服务器连接使用 TCP - 我找不到任何能够实现此功能的工具。

我还考虑过可能通过代码编辑每个数据包，并每次用不同的 IP 替换它的标头 - 但这种方法似乎太令人费解且不切实际，因为它会使每个请求延迟太久以使负载测试相关。

欢迎任何想法和解决方案！

提前致谢 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-27T08:29:55.560

您可以使用 winpcap 或其 .net 包装器 pcap.Net ( [http://pcapdotnet.codeplex.com/](http://pcapdotnet.codeplex.com/) ) 来完全控制发送的 IP/TCP 数据包。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T14:56:43.887

`Socket.Bind`您可以在连接服务器之前使用设置IP地址。

它在这里描述：http: [//msdn.microsoft.com/en-us/library/system.net.sockets.socket.localendpoint (v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/system.net.sockets.socket.localendpoint(v=vs.100).aspx)

# javascript - jQuery 中的多个 beforeunload 处理程序

> ID：15952034
> 
> 赞同：0
> 
> 时间：2013-04-11T14:53:23.447
> 
> 标签：javascript, jquery, cross-browser, onbeforeunload

我正在为将在客户端站点上使用的插件编写 JavaScript，并且需要使用`beforeunload`处理程序将一些信息存储到用户的 cookie 或本地存储中以进行跟踪。

然而，由于我不控制客户的网站，我担心客户的页面在我们设置之前已经定义了一个 beforeunload 处理程序。特别是，我担心客户端的 JavaScript 创建一个“beforeunload”处理程序，该处理程序返回一个字符串以创建一个`'Are you sure you want to leave this page?'`-style 弹出窗口，以及在此之后添加我们的处理程序可能会破坏或以其他方式干扰此功能的可能性。

根据 Chromium 控制台中的一些实验，***似乎如果我使用 添加处理程序`jQuery(window).on('beforeunload', handler)`，那么所有处理程序都会按照添加的顺序执行，然后任何确认对话框的存在和内容仅由最终的`undefined`返回值***。因此，如果最后一个添加了显式 return 的处理程序`null`，则不会显示任何消息，并且如果它返回一个字符串，则会显示一个以该字符串作为其内容的确认对话框。这是我想要的行为；这意味着只要我`undefined`从*我*`beforeunload`添加的处理程序返回，我就不应该破坏任何客户的代码。

 ****但是，我可以在所有浏览器中依赖这种行为吗？如果客户端`beforeunload`通过 jQuery 以外的机制添加他们的原始处理程序，比如显式分配给`window.onbeforeunload`或使用，`window.addEventListener`怎么样？***jQuery 如何在幕后处理多个处理程序的分配？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T16:36:18.030

如果你这样做怎么办

```
 var x = window.onbeforeunload
 window.onbeforeunload = function() { 
       // do your stuf
       if (x) return x();
 } 
```

因此，这样您将返回初始事件处理程序应该返回的任何内容。*

# visual-c++ - OpenCV/C++ 矩形掩码不能覆盖原始帧的所有区域

> ID：15952040
> 
> 赞同：0
> 
> 时间：2013-04-11T14:53:34.107
> 
> 标签：visual-c++, opencv, computer-vision

有我用于创建蒙版的代码和屏幕截图，蒙版的大小没有覆盖所有原始帧似乎很奇怪。请问这里有什么提示吗？

```
 *cap >> frame1;
    Rect roi(100,100,100,100);
    for(int i =0; i<frame1.rows; i++)
    {
        for(int j=0; j<frame1.cols;j++)
        {
            if(!roi.contains(Point(i,j)))
            {
                frame1.at<uchar>(i,j) = 0;
            }
        }
    } 
```

![在此处输入图像描述](https://i.stack.imgur.com/PQZYh.jpg)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T15:48:25.257

我的假设是这`frame1`是一个彩色图像并且有 type `CV_8UC3`。尝试`frame1`按照`frame_gray`以下代码片段创建和填写：

```
cv::Mat3b frame_color;
*cap >> frame_color;
cv::Mat1b frame_gray;
cv::cvtColor(frame_color, frame_gray, CV_BGR2GRAY) 
```

或者如果您不喜欢更改类型，请`frame1`使用以下代码：

```
*cap >> frame1;
Rect roi(100,100,100,100);
for(int i =0; i<frame1.rows; i++)
{
    for(int j=0; j<frame1.cols;j++)
    {
        if(!roi.contains(Point(i,j)))
        {
            frame1.at<cv::Vec3b>(i,j) = cv::Vec3b::all(0);
        }
    }
} 
```

或者哪个更短（未经测试，但想法应该很清楚）：

```
*cap >> frame1;
Rect roi(100,100,100,100);
cv::Mat3b color_mask = cv::Mat3b::ones(frame1.size());
color_mask(roi) = cv::Mat3b::zeros(roi.size());
frame1 = frame1.mul(color_mask); 
```

# princexml - 如何创建没有分页符的 Prince PDF？

> ID：15952041
> 
> 赞同：0
> 
> 时间：2013-04-11T14:53:35.533
> 
> 标签：princexml

是否可以指示 Prince XML 从 HTML 转换并创建一个完全没有分页符的输出文件，一个只有一个连续页面的 PDF 文件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-27T18:16:13.160

手动指定一个非常高的纸张尺寸，如下所示：

```
@page 
{
    size: 210mm 1485mm
} 
```

# visual-c++ - 调用 DLL 时，是否会从 DLL 分配额外的堆栈/堆......？

> ID：15952048
> 
> 赞同：0
> 
> 时间：2013-04-11T14:53:53.767
> 
> 标签：visual-c++, memory, dll, stack

...或者它是否与调用进程共享内存？换句话说，C++ 编译器选项“堆栈保留大小”在编译 DLL 时是否有任何影响？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-11T15:01:05.820

函数使用其调用者的堆栈（最终在线程创建时确定）。初始线程的堆栈保留大小由主可执行文件的 PE 头设置。附加线程的堆栈大小由 的参数指定`CreateThread`。DLL 的 PE 标头不会影响这些。

C++ 编译器无论如何都没有这样的选项——许多编译单元中的哪一个将控制初始线程的堆栈大小。这是一个链接器选项。

# python - 如何使用 Webdriver 和 Python 与此模式对话框进行交互？

> ID：15952049
> 
> 赞同：4
> 
> 时间：2013-04-11T14:54:00.780
> 
> 标签：python, google-chrome, webdriver, modal-dialog, lettuce

我想要的只是关闭一个模式对话框，理想情况下通过执行以下操作：

```
browser.find_element_by_link_text("OK").click() 
```

给出`NoSuchElementException: Message: u'The element could not be found'`OK 链接文本。

当我这样做时，xpath 也一样：

```
browser.find_element_by_xpath("//*[@id=\"modal\"]/div/div[2]/div/a").click() 
```

我怀疑这是因为我需要把重点放在对话上。为此，我尝试过：

```
for handle in browser.window_handles:
    browser.switch_to_window(handle)
    if browser.find_element_by_class_name('popUp123')
        browser.find_element_by_link_text("OK").click() 
```

给`NoSuchElementException: Message: u'The element could not be found'`班级。

也试过`browser.switch_to_frame(ID OR NAME)`，但也找不到它作为框架。

请告诉我我遗漏了一些明显的东西。

相关框架来源（总结）：

```
<body id="modal">
    <div class="popUp123">
    <div class="button">
        <div class="centerbutton">
            <a href="#" class="close" onclick=parent.close">
                <span>OK</span> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-12-02T00:17:18.233

这是python语法

```
from selenium.webdriver.remote.webdriver import WebDriver

browser = WebDriver()

# do other stuff here

browser.switch_to_alert().accept()

# continue with other stuff here 
```

警报 api 位于 selenium.webdriver.common.alert

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-16T07:50:55.050

以下代码使用 Java，您可以尝试使用以下代码将其转换为 Python 语法。对不起，我是 Webdriver - Java Tester，我不能给你 Python 代码。希望这能解决您的要求。

```
Alert alertDialog = driver.switchTo().alert();
//Get the alert text
String alertText = alertDialog.getText();
//Click the OK button on the alert.
alertDialog.accept(); 
```

干杯，

马赫什

# codeigniter - 新手 - 使用 CodeIgniter 和 mPDF 的空白 pdf

> ID：15952052
> 
> 赞同：0
> 
> 时间：2013-04-11T14:54:03.100
> 
> 标签：codeigniter, view, mpdf

我是 CodeIgniter 的新手，甚至是 mPDF 的新手，我在尝试从现有视图创建单页发票时遇到了一些大脑问题。代码如下：

```
$this->load->library('mpdf');

$to_convert = $this->load->view('test_pdf_view',TRUE);

$this->mpdf->WriteHTML($to_convert);

$this->mpdf->Output(); 
```

任何帮助将不胜感激。

谢谢 ：-）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T14:59:54.310

您需要`TRUE`作为第三个参数传递给视图：

```
$to_convert = $this->load->view('test_pdf_view', NULL, TRUE); 
```

# wordpress - 使用 add_rewrite_rule 删除（问号）的正确方法是什么？

> ID：15952053
> 
> 赞同：4
> 
> 时间：2013-04-11T14:54:04.107
> 
> 标签：wordpress, url-rewriting, rewrite

我有一个名为“People”的页面，其中包含一个自定义模板，该模板接受一个名为 name 的变量：

example.com/people/?name=FirstLast

我想要的是这样的：

example.com/people/FristLast

我知道我需要使用 add_rewrite_rule 和 add_rewrite_tag 调用，但我不确定如何达到我想要的结果。我试过这个，但我得到一个 php 错误：

```
add_rewrite_rule('^people/([^/]*)/?','index.php?name=$matches[1]','top');
add_rewrite_tag('%name%','([^&]+)'); 
```

我得到的错误是：“致命错误：在非对象上调用成员函数 add_rule()”

我认为我走在正确的道路上。我对 WP 非常了解，但这是我第一次尝试重写规则。

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-07-09T11:24:58.543

尝试

```
add_action( 'init', 'addMyRules' );
function addMyRules(){
    add_rewrite_rule('^people/([^/]*)/?','index.php?name=$matches[1]','top');
    add_rewrite_tag('%name%','([^&]+)');
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-07-08T13:15:15.280

您应该`add_rewrite_rule`按如下方式调用动作挂钩：

```
add_action('init', 'wpa8715_intit');

function wpa8715_intit() {
    add_rewrite_rule('^people/([^/]*)/?','index.php?name=$matches[1]','top');
    add_rewrite_tag('%name%','([^&]+)');
} 
```

# perl - Perl 中的“//”是什么意思？

> ID：15952061
> 
> 赞同：4
> 
> 时间：2013-04-11T14:54:12.203
> 
> 标签：perl, logical-operators

我在很多 Perl 书籍中搜索，但找不到答案。我有这个代码，我想它所做的是将参数的票分配给 $ticket 如果它存在，如果不存在，则分配 0。

```
my $ticket   = $params->{ticket} // 0; 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-11T14:56:10.477

`//`表示[已定义或](http://perldoc.perl.org/perlop.html#Logical-Defined-Or)。如果已定义`$ticket`则赋值，否则为 0。`$params->{ticket}`

> 尽管它在 C 中没有直接的等价物，但 Perl 的`//`运算符与其 C 风格的或有关。实际上，它与 完全相同`||`，只是它测试的是左侧的定义性而不是其真实性。因此，如果定义了则`EXPR1 // EXPR2`返回 的值`EXPR1`，否则`EXPR2`返回 的值。

它是[在 5.10 中添加的](http://perldoc.perl.org/5.10.0/perldelta.html#Defined-or-operator)。

在上面的代码中，`$params->{ticket}`仍然可以有垃圾，所以在使用它之前确保值符合预期的模式。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-11T14:56:56.453

Perl[文档](http://perldoc.perl.org/perlop.html)说：

"EXPR1 // 如果 EXPR2 已定义，则返回 EXPR1 的值，否则返回 EXPR2 的值。"

它类似于逻辑或，但测试定义性。

# android - Android-App：从 SD 卡中选择带有 ACTION_PICK 的音频文件并将其保存到 Apps 文件夹

> ID：15952062
> 
> 赞同：1
> 
> 时间：2013-04-11T14:54:22.200
> 
> 标签：android, audio, sd-card

我得到了这个使用图像，如：

```
Intent intent = new Intent(Intent.ACTION_PICK, null);
                intent.setType("image/*");
                image = new File(projectPathFull,"testapp_"+imageCounter+".jpg");
                intent.putExtra(MediaStore.EXTRA_OUTPUT, Uri.fromFile(image));
                startActivityForResult(intent, REQUEST_PICK_IMAGE); 
```

这会在我的文件夹 testapp 中创建选择的图像，但它不适用于 Audiofiles。这是我的代码：

```
Intent toAudioSelect = new Intent(Intent.ACTION_PICK,android.provider.MediaStore.Audio.Media.EXTERNAL_CONTENT_URI);
                audio = new File(projectPathFull,"testapp_"+imageCounter+".mp3");
                toAudioSelect.putExtra(MediaStore.EXTRA_OUTPUT, Uri.fromFile(audio));
                startActivityForResult(toAudioSelect, REQUEST_PICK_AUDIO); 
```

有任何想法吗？

# jquery - jquery 追加而不是警告消息

> ID：15952067
> 
> 赞同：-3
> 
> 时间：2013-04-11T14:54:41.283
> 
> 标签：jquery, forms, hide, prepend

我想在 div 中显示一条消息而不是警告它，然后将其隐藏在`click/blur` 由于键入错误而弹出警告。我需要在 div 中显示消息而不是警报。

**就像是：**

```
$('form.form-calculator input').on('change click', function() {
        if ($(this).val() == 0) {
            var div = $("#AlertMessage");
            div = $("<div id='AlertMessage' onclick='$(this).hide();'></div>");
            $("body").prepend(div);
            this.value=0;
        }
        calc_total();
    }); 
```

**随着警报**

```
 $(function () {
       $('.form input').on('change click focus', function () {
          if ($(this).val() == 0) {
            alert('HELLO');
            this.value = 0;
          }
          calc_total();
       });
    }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T14:57:38.283

假设您的两段代码都有效（因为您没有要求对它们进行故障排除），您可以像这样将它们组合成一个：

```
 $(function () {
       $('.form input').on('change click focus', function () {
          if ($(this).val() == 0) {
            div = $("<div id='AlertMessage' onclick='$(this).hide();'>HELLO</div>");
            $("body").prepend(div);
            this.value = 0;
          }
          calc_total();
       });
    }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T15:00:33.870

```
$(function () {
    $('.form input').on('focusout', function () {
        if ($(this).val() == 0) {
            showError('Hello');
        } else {
            $("#AlertMessage").remove();
        }
        calc_total();
    });

    function showError(text) {
        $("#AlertMessage").remove();
        $('<div/>', {
            id: 'AlertMessage',
            text: "Alert! It can't be 0"
        }).prependTo('body');
        // Close on click
        $('body').delegate('#AlertMessage', 'click', function () {
            $(this).hide();
        });
    }
}); 
```

# javascript - 报告 SVG 中左键单击（并按住）鼠标的坐标

> ID：15952069
> 
> 赞同：0
> 
> 时间：2013-04-11T14:54:43.813
> 
> 标签：javascript, jquery, svg

首先，我什至不知道我正在尝试做的事情是否可能，所以请在这方面原谅我。

我创建了一个程序，允许在 SVG 中显示图形。作为其中的一部分，我希望用户能够用鼠标绘制笔记。

如果按住鼠标左键，有没有办法使用 javascript（或 jQuery）捕获鼠标坐标？我正在努力解决的是如何捕获一系列位置以生成路径。据我了解，如果位置发生变化，我需要在设定的时间步长获取坐标（下面的伪代码）。

```
if (leftClicked)
{
   var positionArray[];
   var MC = getMouseCoordinates();
   positionArray[0] = MC;
   var i = 1;
   while(leftClicked)
   {
      if getMouseCoordinates() != MC
      {
         MC = getMouseCoordinates();
         positionArray[i] = MC;
      }
      i++;
   }
} 
```

但是尽管阅读了几个小时，我还是找不到在 JavaScript 中实现这一点的方法。

我的 SVG 也嵌入在 HTML 页面中。我不知道如何将坐标报告本地化到该 SVG 而不是整个页面？

抱歉，我知道这是一个相当模糊的问题，但我什至不知道从哪里开始...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T15:14:00.750

你应该反过来做，而不是寻找按钮按下然后尝试跟踪鼠标，跟踪鼠标并检查鼠标是否移动是否按下按钮。即附加一个[mousemove](https://developer.mozilla.org/en-US/docs/DOM/Mozilla_event_reference/mousemove)事件处理程序并检查 button = 0

此[示例](https://developer.mozilla.org/samples/svg/swarm-of-motes.xhtml)跟踪 mousemove 事件，虽然它不检查按钮是否被按下，但您必须使用[此处的信息自行添加](https://developer.mozilla.org/en-US/docs/DOM/Mozilla_event_reference/mousemove)

# wordpress - 登录时的 Wordpress 重定向

> ID：15952073
> 
> 赞同：0
> 
> 时间：2013-04-11T14:54:59.770
> 
> 标签：wordpress, redirect, login, preg-replace, preg-match-all

我们有一个双语 Wordpress 主题。英文版位于**mydomain.com ，捷克语版位于****mydomain.com/cs/**的虚拟目录中

 **当用户在**mydomain.com/login**登录时，他们将被重定向到**mydomain.com/dashboard**，如下面的代码中所指定（即页面名称）。我需要使用**mydomain.com/cs/login**登录的用户登录到**mydomain.com/cs/dashboard**

该函数使用的代码在这里：

`<?php wp_login_form( apply_filters( 'atcf_shortcode_profile_login_args', array( 'redirect' => isset ( $edd_options[ 'profile_page' ] ) ? get_permalink( $edd_options[ 'profile_page' ] ) : home_url() ) ) ); ?>`

**home_url**是返回站点的完整 URL。有什么想法可以通过转义当前目录（/登录）来实现重定向吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T16:57:54.840

您可以检查该`$_SERVER["REQUEST_URI"]`值以查看它是否以开头，`/cs/`然后相应地动态更新配置文件页面值。

```
// The current URI (does not incude host/domain)
$uri = $_SERVER["REQUEST_URI"];
// The home URL
$redirect = home_url();

// $edd_options[ 'profile_page' ] must return the page ID for get_permalink to work
if ( isset( $edd_options[ 'profile_page' ] ) ) {

    // The profile URL. 
    $profile_page_id = $edd_options[ 'profile_page' ];
    $redirect = get_permalink( $profile_page_id );

    // Check if the URI starts with /cs/
    if ( strpos( $uri, '/cs/' ) == 0 ){
        // Explode into an array
        $url_array = explode( '/', $profile_page );

        // Insert /cs/ into array
        $url_array = array_slice($url_array, 0, 3, true) +
                 array("x"=>"cs") +
                 array_slice($url_array, 3, count($url_array)-3, true);

        // Implode back to a string
        $redirect = implode( '/', $url_array );
    }
}

// Set up params to send to login form
$args = apply_filters( 'atcf_shortcode_profile_login_args', array( 'redirect' => $redirect ) );
wp_login_form( $args ); 
```**

# sql - 数据的交叉连接拆分

> ID：15952074
> 
> 赞同：1
> 
> 时间：2013-04-11T14:54:59.793
> 
> 标签：sql, sql-server, sql-server-2008, cross-join

我有一个表 Employee、另一个表 Department 和一个关系表：

```
Employee Table
id  Name
1   A
2   B
3   C
4   D
5   E
6   F

Department Table
id  Name
1   Accounting
2   Finance

Relation Table
id   EmployeeId   DepartmentId 
```

我想进行一个动态查询，以便能够在我的关系表中为每个部门分配相同数量的员工，我知道我可以使用交叉连接，但会将所有员工放在每个部门中。我只想要分配，例如 3 名员工用于帐户，另外 3 名用于财务，但这个数量可能会改变。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T15:16:39.097

这很有趣，它似乎工作得很好，员工随机分布在每个部门：

```
select EmployeeId, DepartmentId
from 
(  select 
    ROW_NUMBER() OVER(ORDER BY NEWID()) as RankEmployee
  , Id as EmployeeId
    from Employee
 ) e , 
(  select 
    ROW_NUMBER() OVER(ORDER BY NEWID()) as RankDepartment
  , (select count(1) from Department) as CountDepartment
  , Id as DepartmentId
    from Department
 ) d
where (RankEmployee + RankDepartment) % CountDepartment = 0 
```

条件

```
(RankEmployee + RankDepartment) % CountDepartment = 0 
```

将为每个员工只检索一行。
并且排名是随机计算的`OVER(ORDER BY NEWID())`。[有关详细信息，请参阅此答案。](https://stackoverflow.com/questions/19412/how-to-request-a-random-row-in-sql)

[SQLFiddle 在这里。](http://sqlfiddle.com/#!3/4de9f/1/0)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-04-05T13:03:37.240

```
declare @columns varchar(max)='',@str varchar(maX) = '',@columns1 varchar(max)=''

select   @columns = @columns+category+',' from piv group by category
set @columns= left(@columns,len(@columns)-1)

select   @columns1 = @COLUMNS1+'ISNULL(['+category+'],0) AS ['+category+'],' from piv group by category
set @columns1= left(@columns1,len(@columns1)-1)

set @str = 
'select date,'+@columns1+'  from 
(
    select date,category, amount as amounts from piv
)res
pivot
(
    max(amounts)
    for category in ('+@columns+')
)pv'
--print @str
exec(@str) 
```

# android - 来自 textview 的 img

> ID：15952075
> 
> 赞同：1
> 
> 时间：2013-04-11T14:55:04.733
> 
> 标签：android, json

我有一个问题，我有一个来自 json 的文本，我解析它，但我需要从这个文本中获取图片，这是 json 文本：

```
"posts": [
{
"id": 22201,
"type": "post",
"slug": "basket-le-wac-simpose-65-a-42-face-au-cmc",
"url": "http://www.wydadnews.com/?p=22201",
"status": "publish",
"title": "Basket: Le WAC s&rsquo;impose 65 à 42 face au CMC",
"title_plain": "Basket: Le WAC s&rsquo;impose 65 à 42 face au CMC",
"content": "<p><img alt=\"null\" src=\"http://dl.dropboxusercontent.com/u/60787184/basket8373.jpg\" align=\"left\" />Le Wydad a battu, ce soir, le CMC 65 à 42 en match comptant pour la 8e journée du championnat. Les Wydadis enchainent ainsi leur 7e victoire consécutive en championnat, sur 7 matchs disputés.  <a href=\"http://www.wydadnews.com/?p=22201#more-22201\" class=\"more-link\">Read more</a></p>\n",
"excerpt": "Le Wydad a battu, ce soir, le CMC 65 à 42 en match comptant pour la 8e journée du championnat. Les Wydadis enchainent ainsi leur 7e victoire consécutive en championnat, sur 7 matchs disputés.",
"date": "2013-04-10 21:38:41",
"modified": "2013-04-11 11:23:26", 
```

我们已经进入“内容”的网址

```
<p><img alt=\"null\" src=\"http://dl.dropboxusercontent.com/u/60787184/basket8373.jpg\" align=\"left\" /> 
```

我想从这个文本图片中显示图片并与文本一起显示，如果有人可以帮助我，我不知道该怎么做，我尝试但没有任何反应。

这是我的 pars json 代码，

```
public static Article parseArticle(JSONObject jsonArticle) {

        Article article = new Article();

        try {
            article.setTitle(ArabicUtilities.reshape(Html.fromHtml(
                    jsonArticle.getString("title")).toString()));
            article.setExcerpt(ArabicUtilities.reshape(Html.fromHtml(
                    jsonArticle.getString("excerpt")).toString()));
            article.setContent(ArabicUtilities.reshape(Html.fromHtml(
                    jsonArticle.getString("content")).toString()));
            article.setDate(jsonArticle.getString("date"));

            return article;
        } catch (JSONException e) {
            e.printStackTrace();
            return null;
        }
    }

    public static ArrayList<Article> parseArticles(String str) {
        JSONObject json = null;
        ArrayList<Article> list = new ArrayList<Article>();
        if (str == null)
            return list;

        try {
            JSONArray array;
            json = new JSONObject(str);
            array = json.getJSONArray("posts");

            for (int i = 0; i < array.length(); i++) {
                Article node = parseArticle(array.getJSONObject(i));
                list.add(node);

            }

            return list;

        } catch (JSONException e) {
            e.printStackTrace();
            return null;
        }
    } 
```

这是我的适配器

```
 @Override
    public View getView(int position, View convertView, ViewGroup parent) {

        LayoutInflater inflater = (LayoutInflater) 

getContext().getSystemService(Context.LAYOUT_INFLATER_SERVICE);
    View view = inflater.inflate(R.layout.list_item, null);

    TextView txtArticleTitle = (TextView) view.findViewById(R.textviews.txtArticleTitle);

    TextView txtArticleExcerpt = (TextView) view.findViewById(R.textviews.txtArticleExcerpt);
    TextView txtArticleDate = (TextView) view.findViewById(R.id.textArticleDate);

    Article article = getItem(position);

    txtArticleTitle.setText(ArabicUtilities.reshape(article.getTitle()));
    txtArticleExcerpt.setText(ArabicUtilities.reshape(article.getExcerpt()));
    txtArticleDate.setText(article.getDate().toGMTString());

    return view;
} 
```

这只是显示文本。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T15:20:27.627

> ```
> <img alt=\"null\" src=\"http://dl.dropboxusercontent.com/u/60787184/basket8373.jpg\" align=\"left\" /> 
> ```
> 
> 我想从这个文本图片中获取图片并与文本一起显示

目前您正在使用：

```
article.setContent(ArabicUtilities.reshape(Html.fromHtml(
        jsonArticle.getString("content")).toString())); 
```

但是`Html.fromHtml()`非常基础，我不相信它支持从网络上提取图像。`<img>`但是，您可以使用 XMLPullParser 或 SAX 包中的 DefaultHandler轻松解析标记，然后将其显示在 ImageView、TextView 或其他 CompoundDrawable 中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T15:41:35.477

当您提取字符串的一小部分时，您可以使用正则表达式。

```
String imageSrc = "";

Pattern pattern = Pattern.compile("src=.\"(.*?)\"");
Matcher matcher = pattern.matcher(str);
if (matcher.find()) {
    imageSrc = matcher.group(1);
} 
```

一旦你有了你的字符串，就有很多选项可以显示它——因为你似乎在使用 ListView，我建议你查看[Universal Image Loader](https://github.com/nostra13/Android-Universal-Image-Loader)。它将异步下载和加载图像。

Universal Image Loader 使用起来非常简单，看看这个例子：

```
imageLoader.displayImage(imageSrc, imageView); 
```

注意：我在开发 regex 模式时提到了[这个优秀的 StackOverFlow 问题。](https://stackoverflow.com/questions/4962176/java-extract-part-of-a-string-between-two-special-characters)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-11T15:35:40.607

```
 //your string
    String yourString="<p><img alt=\"null\" src=\"http://dl.dropboxusercontent.com/u/60787184/basket8373.jpg\" align=\"left\" />Le Wydad a battu, ce soir, le CMC 65 à 42 en match comptant pour la 8e journée du championnat. Les Wydadis enchainent ainsi leur 7e victoire consécutive en championnat, sur 7 matchs disputés.  <a href=\"http://www.wydadnews.com/?p=22201#more-22201\" class=\"more-link\">Read more</a></p>\n"; 

    //space is divider so
    String[] stringsArray = yourString.split(" ");

    for (String item : stringsArray) {
        if(item.startsWith("src=")){

            //here is your picture url
            String url = item.replace("src=\"", "").replaceAll("\"", "");
            System.out.println(url);    
        }
    } 
```

# c - emacs open 包含在代码文件、多个目录中

> ID：15952078
> 
> 赞同：1
> 
> 时间：2013-04-11T14:55:12.577
> 
> 标签：c, emacs, header-files, libraries, include-path

欧洲央行，cscope，xcscope。都在工作。需要cedet吗？

MSVS，日食，代码：：块，xcode。所有这些都允许轻松单击包含的源文件并将您带到它。现在，通过上述设置，emacs 也可以。除了 emacs 不会将您带到 std:: 库之外，不会假定它们在 /src/linux 或类似位置中的位置。Emacs 有点盲目，需要你手动设置。

但是我找不到任何解释如何设置 ff-find-other-file 来搜索项目目录之外的任何其他目录的东西，更不用说标准的主要库了。

那么，我该怎么做呢？

编辑; 最重要的是能够请求文件名（.h、.c、.cpp、.anything）或库（iostream）并打开代码所在的文件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T08:06:30.750

`ff-find-other-file`要查看的其他目录位于`ff-search-directories`变量中，默认情况下使用 的值`cc-search-directories`，因此您应该能够自定义两者中的任何一个以指定其他搜索路径。

至于关于请求文件名和查找相应文件的第二个问题，类似的事情会做：

```
(defun ff-query-find-file (file-name)
  (interactive "sFilename: ")

  ;; dirs expansion is borrowed from `ff-find-the-other-file` function    
  (setq dirs
        (if (symbolp ff-search-directories)
            (ff-list-replace-env-vars (symbol-value ff-search-directories))
          (ff-list-replace-env-vars ff-search-directories)))

  (ff-get-file dirs file-name)) 
```

调用它`M-x ff-query-find-file`或将其绑定到您喜欢的键。

# sql-server - SQL 查询分组和计数

> ID：15952085
> 
> 赞同：0
> 
> 时间：2013-04-11T14:55:48.300
> 
> 标签：sql-server, tsql

我有以下 SQL 查询，我想逐列获取行数。

```
 SELECT COL1, COL2
  FROM TABLE-A 
  GROUP BY COL1, COL2 
```

这是我为上述查询获得的结果集。谢谢你的任何建议。

```
Col1            Col2
-------------------
Atlanta         122
Atlanta         133
Atlanta         323
Boston          44
Boston          99
LA              3323 
```

这是我需要查询帮助的结果集。

```
Col1            Col2
-------------------
Atlanta         3
Boston          2
LA              1 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-11T14:57:49.510

你只需要使用聚合函数，不要按你需要计算的那个分组，在这种情况下是 col2

```
 SELECT COL1, count(COL2)
  FROM TABLE-A 
  GROUP BY COL1 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-11T15:01:37.477

尝试这个

```
SELECT COL1,COUNT(COL1) as Col2
FROM TABLE-A 
GROUP BY COL1 
```

# python - 在 ctypes 回调函数中使用线程锁

> ID：15952086
> 
> 赞同：4
> 
> 时间：2013-04-11T14:55:49.927
> 
> 标签：python, multithreading, callback, ctypes

我想使用扭曲应用程序中的 ctypes dll。此处编造的最小示例：

```
from ctypes import *
from threading import Lock

lock = Lock()

dll = windll.LoadLibrary('mydll.dll')

l = [1,2,3]

def callback():
    lock.acquire()
    l.pop()
    lock.release()
    return 0

C_CALLBACK = CFUNCTYPE(c_int)
c_callback = C_CALLBACK(callback)

# this is a non blocking function call starts a hardware task that fires a callback upon completion
dll.registerCallback(c_callback)

while(True):
    # in reality this block gets called from a twisted server application
    lock.acquire()
    l.append(l.pop() + 1)
    lock.release() 
```

dll 有一个函数 ( `dll.registerCallback`)，它接收 ctypes 回调函数，启动硬件事件，并在硬件指示硬件任务完成时触发回调。

从 API 文档：

> 回调函数在 DAQmx 线程中调用。

在网络上的某个地方，他们试图解释什么是“DAQmx 线程”：

> ...您的回调将被调用并在 DAQmx 驱动程序线程中运行，并将与您的程序异步运行（不在同一个线程中）。

完整的文档可以在[这里](http://zone.ni.com/reference/en-XX/help/370471W-01/daqmxcfunc/daqmxregisterdoneevent/)找到。为简单起见，我在示例中更改了函数签名。

所以我想我们可以安全地假设 dll 正在产生一个线程。

我拥有的锁是否会确保回调函数在主循环`l`的操作中间时不会尝试访问列表`pop`，反之亦然？还是仅当您使用使用`threading`库创建的线程时，此方案才有效？这里推荐的做法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-11T19:53:26.973

ctypes 做的第一件事[`_CallPythonObject`](http://hg.python.org/cpython/file/70274d53c1dd/Modules/_ctypes/callbacks.c#l201)是 call [`PyGILState_Ensure()`](http://hg.python.org/cpython/file/70274d53c1dd/Python/pystate.c#l583)，如果需要，它会调用`PyThreadState_New`来创建一个新的线程状态。除此之外，它是普通的 Python 线程代码，所以你的锁应该可以正常工作。它在下面的示例中对我有用（Linux，Python 2.7.3）：

```
from ctypes import *
import threading

lock = threading.Lock()
lib = CDLL('./tmp.so')
callback_t = CFUNCTYPE(c_int)

def f():
  with lock:
    print threading.current_thread()
  return 21

callback = callback_t(f)
lib.registerCallback(callback) 
```

```
>>> lock.acquire()
True
>>> t = threading.Thread(target=lib.event)
>>> t.start()
>>> lock.locked()
True
>>> lock.release()
>>> <_DummyThread(Dummy-2, started daemon -1230402704)>
res: 21 
```

`DummyThread`输出来自在回调中打印当前线程。在 Python 之外创建的线程有一个“虚拟”名称。

**tmp.c:**

```
#include <stdio.h>
#include <pthread.h>

typedef int (*callback_t)(void);
callback_t callback = NULL;

void *doCallback(void *arg)
{
    int res = callback();
    printf("res: %d\n", res);
    pthread_exit(0);
}

int event(void)
{
    pthread_t callback_thread;
    pthread_create(&callback_thread, NULL, doCallback, NULL);
    pthread_join(callback_thread, NULL);
    return 0;
}

int registerCallback(callback_t foo)
{
    callback = foo;
    return 0;
} 
```

# file - 批处理文件将包含 % 的行回显到文本文件

> ID：15952089
> 
> 赞同：0
> 
> 时间：2013-04-11T14:56:04.253
> 
> 标签：file, batch-file, command, dos, prompt

我将以下行添加到批处理文件中，使用：

```
ECHO enter.php?login=%s&pass=%s >>textfile.txt 
```

输出为

```
enter.php?login=s 
```

这是我的第一个批处理文件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T14:58:10.160

加倍`%`- 通常会`^`像这样转义尴尬的字符，`>`以便从字面上复制它们，你会使用`^>`. `%`是不同的 - 你需要`%%`每个`%`你想“打印”的

# php - 带有 PHP 的动态 jQuery 函数

> ID：15952090
> 
> 赞同：0
> 
> 时间：2013-04-11T14:56:04.367
> 
> 标签：php, jquery, loops

我有一个 jQuery 函数，可以缩放图片，以便最大尺寸为 350 像素，无论原始大小如何。

jQuery：

```
function Scale(){
    var img = new Image();
img.onload = function () {
    alert('Orignal width:'+img.width+', height:'+img.height);
    var width, height;
    if (img.width > img.height) {
        width = (img.width > 350 ? 350 : img.width);
        height = img.height * (350 / img.width);
    } else {
        height = (img.height > 350 ? 350 : img.height);
        width = img.width * (350 / img.height);
    }
    img.width=width;
    img.height=height;
    $("#img-holder").append(img);
}

img.src = "picture.jpg"
} 
```

我正在使用 PHP 循环从我的数据库中检索图片链接。

PHP：

```
$q = "SELECT * FROM `items`";
$row = mysqli_query($con, $q) or die(mysqli_error());
while($r = mysqli_fetch_assoc($row))
{
  //do stuff
} 
```

然后，`$r['picture']`每次循环运行时都会存储图片链接。

**我的问题：**如何为使用循环检索的每张图片运行 jQuery 脚本？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T15:01:45.253

为所有此类图像分配`max-width`和`max-height`在您的 CSS 中。无需 JavaScript。

```
#img-holder img {
   max-width: 350px; 
   max-height: 350px;
} 
```

或者，为了保持比例：

```
#img-holder img {
    max-width: 350px;
    max-height: 350px;
    width: auto;
    height: auto;
} 
```

[http://jsfiddle.net/mblase75/FKsL8/](http://jsfiddle.net/mblase75/FKsL8/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T15:24:43.697

有很多方法可以实现您的需求。其中之一是您创建一个类模型“ShowImage”，包括两个属性宽度、高度，或者只是简单地创建从 SQL 获得并传递给视图的图像数组。然后您可以获取每张图片并以您的预期尺寸显示它们。

但我建议你不要这样做。只需将服务器端的东西放在服务器端，客户端的东西放在客户端。

你可以用 php 做一些事情，就像你的函数 Scale 所做的那样，因为 php 有函数来获取给定图像的尺寸[getimagesize](http://php.net/manual/en/function.getimagesize.php)。

最好的是您只需要一个生成具有给定最大尺寸的缩略图的功能，因此您可以重复使用它，您将不再担心图像周围的这些东西。

您可以找到很多处理缩略图的函数，例如[这里](https://stackoverflow.com/questions/2686000/use-php-to-create-thumbnails-cropped-to-square) <<

我不鼓励使用 CSS 制作，在实践中，您真的不希望您的页面加载所有大图像并仅以 350 像素显示它们。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-04-11T15:02:03.260

您将不得不为此使用[Ajax](http://api.jquery.com/jQuery.ajax/)。您可以设置一个按钮，通过 ajax 请求链接到您的 php 文件。然后，当您取回链接时，您将随心所欲地显示它。

# mysql - 为什么这个 MySQL Select 需要永远

> ID：15952091
> 
> 赞同：-1
> 
> 时间：2013-04-11T14:56:05.803
> 
> 标签：mysql, sql-server, forever

晚上好，我有这个查询，我无法解决它。它永远不会完成，但它会在 MSSQL 2000 上完成，我想在 MySQL 上拥有它。有什么建议吗？

```
SELECT T_Coll.Nom_REGION AS Region_Col,
       T_Coll.Nom_STE AS Societe_Col,
       T_Coll.Nom_ETS AS Ets_Col,
       T_Coll.Nom_CDP AS CDP_Col,
       T_Coll.ID_Coll,
       T_Coll.NomColl AS NomColl,
       T_Coll.Nom_Coll AS NOM,
       T_Coll.Prenom_Coll AS Prenom,
       T_Coll.Trig_Coll,
       T_Coll.EXTERN,
       T_DETAIL.AN,
       T_DETAIL.Mois_Modif,
       T_DETAIL.T_AFFAIRE_ID,
       T_DETAIL.T_LOT_ID,
       T_DETAIL.T_SOUS_LOT_ID,
       T_Type.NomType,
       T_DETAIL.AUTRE_LIBELLE,
       T_DETAIL.JOUR01 + T_DETAIL.JOUR02 + T_DETAIL.JOUR03 + T_DETAIL.JOUR04 + T_DETAIL.JOUR05 + T_DETAIL.JOUR06 + T_DETAIL.JOUR07 + T_DETAIL.JOUR08 + T_DETAIL.JOUR09 + T_DETAIL.JOUR10 + T_DETAIL.JOUR11 + T_DETAIL.JOUR12 + T_DETAIL.JOUR13 + T_DETAIL.JOUR14 + T_DETAIL.JOUR15 + T_DETAIL.JOUR16 + T_DETAIL.JOUR17 + T_DETAIL.JOUR18 + T_DETAIL.JOUR19 + T_DETAIL.JOUR20 + T_DETAIL.JOUR21 + T_DETAIL.JOUR22 + T_DETAIL.JOUR23 + T_DETAIL.JOUR24 + T_DETAIL.JOUR25 + T_DETAIL.JOUR26 + T_DETAIL.JOUR27 + T_DETAIL.JOUR28 + T_DETAIL.JOUR29 + T_DETAIL.JOUR30 + T_DETAIL.JOUR31 AS Total_Jours,
       T_DETAIL.JOUR01 + T_DETAIL.JOUR02 + T_DETAIL.JOUR03 + T_DETAIL.JOUR04 + T_DETAIL.JOUR05 + T_DETAIL.JOUR06 + T_DETAIL.JOUR07 + T_DETAIL.JOUR08 + T_DETAIL.JOUR09 + T_DETAIL.JOUR10 + T_DETAIL.JOUR11 + T_DETAIL.JOUR12 + T_DETAIL.JOUR13 + T_DETAIL.JOUR14 + T_DETAIL.JOUR15 + T_DETAIL.JOUR16 + T_DETAIL.JOUR17 + T_DETAIL.JOUR18 + T_DETAIL.JOUR19 + T_DETAIL.JOUR20 + T_DETAIL.JOUR21 + T_DETAIL.JOUR22 + T_DETAIL.JOUR23 + T_DETAIL.JOUR24 + T_DETAIL.JOUR25 + T_DETAIL.JOUR26 + T_DETAIL.JOUR27 + T_DETAIL.JOUR28 + T_DETAIL.JOUR29 + T_DETAIL.JOUR30 + T_DETAIL.JOUR31 + T_DETAIL.REGUL AS Total_Jours_et_Reg,
       T_DETAIL.REGUL,
       T_Cam.ID AS ID_Cram,
       T_Cam.STATUT,
       T_Cam.T_COLLABORATEUR_ID AS ID_Cram_Coll,
       T_DETAIL.ID AS ID_Cram_Detail,
       T_DETAIL.MOIS,
       T_DETAIL.JOUR01,
       T_DETAIL.JOUR02,
       T_DETAIL.JOUR03,
       T_DETAIL.JOUR04,
       T_DETAIL.JOUR05,
       T_DETAIL.JOUR06,
       T_DETAIL.JOUR07,
       T_DETAIL.JOUR08,
       T_DETAIL.JOUR09,
       T_DETAIL.JOUR10,
       T_DETAIL.JOUR11,
       T_DETAIL.JOUR12,
       T_DETAIL.JOUR13,
       T_DETAIL.JOUR14,
       T_DETAIL.JOUR15,
       T_DETAIL.JOUR16,
       T_DETAIL.JOUR17,
       T_DETAIL.JOUR18,
       T_DETAIL.JOUR19,
       T_DETAIL.JOUR20,
       T_DETAIL.JOUR21,
       T_DETAIL.JOUR22,
       T_DETAIL.JOUR23,
       T_DETAIL.JOUR24,
       T_DETAIL.JOUR25,
       T_DETAIL.JOUR26,
       T_DETAIL.JOUR27,
       T_DETAIL.JOUR28,
       T_DETAIL.JOUR29,
       T_DETAIL.JOUR30,
       T_DETAIL.JOUR31,
       T_Supr.Suppression,
       T_Coll.TYPE
FROM T_Coll
INNER JOIN T_Cam ON  T_Cam.T_COLLABORATEUR_ID = T_Coll.ID_Coll
INNER JOIN T_DETAIL ON  T_DETAIL.T_Cam_ID = T_Cam.ID
INNER JOIN T_Type ON T_Type.TYPE = T_DETAIL.TYPE 
LEFT OUTER JOIN T_Supr ON T_Supr.ID_Cram_Detail = T_DETAIL.ID

WHERE (T_Supr.Suppression IS NULL)

ORDER BY T_Coll.NomColl,
         T_DETAIL.AN,
         T_DETAIL.Mois_Modif,
         T_DETAIL.T_AFFAIRE_ID,
         T_DETAIL.T_LOT_ID,
         T_DETAIL.T_SOUS_LOT_ID 
```

我只是无法在 MySQL 下完成这项工作！

提前致谢 ！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T15:35:35.293

连接中使用的所有列、where 子句和 order by 可能都应该被索引。在没有索引的任何数据库中，您不能期望任何类型的体面性能。您的查询没有什么非常复杂的，所以这是最有可能的问题。

不要返回任何您不需要的列。例如，当基于 where 子句的值始终为 nulll 时，为什么要返回 T_Supr.Suppression？

在 mysql 中，您应该查看解释计划，以了解慢查询问题出在哪里。在 SQL Server 中查看执行计划。您需要学习如何阅读这些以有效地使用 SQL 进行编程。

# html - div对齐

> ID：15952095
> 
> 赞同：0
> 
> 时间：2013-04-11T14:56:10.053
> 
> 标签：html

a 的默认行为是`div`什么？

我注意到，即使为 div 设置一个宽度，比如说 100px，如果我将第二个具有相同宽度的 div 放在第二行。所以默认情况下，宽度无关紧要。它把它放在不同的线上？在这种情况下，我理解浮动的需要。我认为我在 html 页面中放入的任何元素，除非我添加中断元素或段落或具有该角色的东西，否则它们将并排放置。或者也许我没有正确使用它来`div`进行这种对齐，但我真的很想澄清这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T15:05:08.510

Divs are *block-level* elements which mean they stack...like blocks. Although it sounds reasonable that since the width would allow them to fit side-by-side without a float, this is not how they are designed to behave.

If an element is an *inline* element as opposed to a *block*, its behavior is to fit side-by-side. You can force this behavior on a div if you would like by tying the two ideas together. You can do something like:

```
<div style="display:inline-block"></div> 
```

This will allow the div to maintain its other block properties but allow it to fit inline as text and images would and, if this the your desired goal, avoid the use of *float*.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-11T15:00:58.130

默认情况下，div 元素是[`display: block`](http://www.w3.org/TR/CSS21/visuren.html#display-prop).

> 该值导致元素生成块框。

此处描述了它们的[渲染](http://www.w3.org/TR/CSS21/visuren.html#block-boxes)

> 块级元素是源文档的那些在视觉上被格式化为块（例如，段落）的元素。'display' 属性的以下值使元素成为块级：'block'、'list-item' 和 'table'。
> 
> 块级框是参与块格式化上下文的框。

然后[在这里](http://www.w3.org/TR/CSS21/visuren.html#block-formatting)

> 在块格式化上下文中，框从包含块的顶部开始一个接一个地垂直排列。

要停止这种渲染，您可以使用`float`使块级元素在彼此旁边冒泡。您还可以修改 div 的显示属性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-11T15:01:05.007

默认情况下，DIV 占据屏幕的 100%，即使你设置它的宽度，右边的空间也不能被任何东西占据。

尝试这个：

在同一行上有两个 div 的方法是让它们浮动：

```
<div style = 'float:left;width:500px;background-color:red;color:white;'>Hey</div>

<div style = 'float:left;width:100px;'> There</div> 
```

# objective-c - 如何在 xCode 中向表格单元格显示缩略图？

> ID：15952097
> 
> 赞同：1
> 
> 时间：2013-04-11T14:56:12.313
> 
> 标签：objective-c, uitableview

作为一个 Xcode 初学者，我想在我的应用程序的表格单元格中显示一个缩略图。现在，我有这段代码可以解析 JSON 数据并将其发布在单元格的标题和副标题中。

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:@"MainCell"];

    if(cell == nil){
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleSubtitle reuseIdentifier:@"MainCell"];
    }

    cell.textLabel.text = [[news objectAtIndex:indexPath.row] objectForKey:@"receta"];
    cell.detailTextLabel.text = [[news objectAtIndex:indexPath.row] objectForKey:@"koha"];

    return cell;
} 
```

如何在单元格右侧显示缩略图？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-11T16:22:18.487

如果您不想制作自定义单元格，您可以`UIImageView`使用所需的图像创建一个并将其设置为单元格的`accessoryView`，这将显示在单元格的右边缘。您还需要确保单元格的高度足够高以适合图像的高度。

```
- (CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath {
    return 100;
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {
    static NSString *CellIdentifier = @"Cell";

    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
    if (cell == nil) {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];
    }

    cell.accessoryView = [[UIImageView alloc] initWithImage:[UIImage imageNamed:@"some-image-name"]];

    return cell;
} 
```

`100`如果图像始终是固定大小，您可以返回一个常量（我选择了），或者您可以检查`UIImage`'s`size`并返回类似`size.height + 10`一些额外填充的内容。

# xamarin.android - 如何使视图模型将数据返回给另一个？

> ID：15952101
> 
> 赞同：0
> 
> 时间：2013-04-11T14:56:22.610
> 
> 标签：xamarin.android, mvvmcross

当我调用 DoClose() 时，我正在尝试找到将数据从视图模型传递回另一个视图模型的解决方案

我有一个视图，用户可以在 edittext 中添加信息，还有一个按钮可以打开一个新视图，用户可以在其中输入其他信息。然后他需要返回 ( `DoClose()`) 到第一个视图，然后单击按钮保存信息。

我试图制作一个`RequestNavigate<>`，但它在堆栈中创建了一个新视图。

我不知道如何从第二个视图取回信息。有人可以帮助我吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-11T15:17:37.913

@gshackles 的这篇文章提供了一种执行此操作的机制 - [http://www.gregshackles.com/2012/11/returning-results-from-view-models-in-mvvmcross/](http://www.gregshackles.com/2012/11/returning-results-from-view-models-in-mvvmcross/)

# jquery - 使用 jquery 的响应式多列弹出菜单

> ID：15952105
> 
> 赞同：1
> 
> 时间：2013-04-11T14:56:27.777
> 
> 标签：jquery, menu, flyout

我想创建一个响应式多列菜单，就像[http://www.indochino.com](http://www.indochino.com)上使用的那样，有人知道该怎么做吗？我的出发点应该是这个脚本：[http ://codepen.io/bradfrost/pen/IEBrz](http://codepen.io/bradfrost/pen/IEBrz)

非常感谢，乔治

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T15:08:12.010

看看jQuery方法`.hover`、、、、`.mousein`和`.mouseout`。`.mouseenter``.mouseleave`

`.css`当用户的鼠标经过导航链接时，您将要做的是使用 jQuery 的 '.animate` 等方法之一来显示/隐藏菜单。当他们的鼠标离开导航链接和菜单时，您将需要再次使用一种方法（可能与以前相同）来隐藏菜单。

这是一个例子：

```
$(document).ready(function() {
    var $navLink = $("#navLink"); //for sake of ease, I will assume you have only one menu, as in the example site
    var $subMenu = $("#subMenu"); // see the above comment

    //global flags
    var overLink = false; 
    var overMenu = false;

    function checkAndHide() {
        if (!overLink && !overMenu) {
            $subMenu.css("display", "none");  

            $subMenu.off("mouseleave.hide");
            $navLink.off("mouseleave.hide");

            $navLink.on("mouseenter.show", function() { 
                overLink = true;
                displayMenu();
            });

        }
    }

    function displayMenu() {
        $subMenu.css("display", "inline-block");

        $navLink.off("mouseenter.show");
        //this is where you have some major implementation decisions
        //for sake of ease, I will simply use some global flags

        $navLink.on("mouseleave.hide", function() { 
            overLink = false;
            checkAndHide(); 
        });
        $subMenu.on("mouseleave.hide", function() {
            overMenu = false; 
            checkAndHide(); 
        });
    };

    $subMenu.on("mouseenter.updateFlag", function() { 
        overMenu = true;
    });

    $navLink.on("mouseenter.updateFlag", function() {
        overLink = true;
    });

}); 
```

以上是可能解决方案的非常非常粗略的草案。这不是你应该简单地复制和粘贴的东西，但它应该让你知道你应该尝试做什么。我使用了很多`.on`and`.off`调用，你也应该这样做，以节省调用不再需要的处理程序的开销。然而，最重要的是打开和关闭 的`.mouseenter`处理程序`$navLink`，因为您可能决定使用（或将来更改为）可能在元素上明显重复的效果（如滑动，然后再次向下滑动）。在我的示例中，这不是很重要，但根据您的实现可能很重要。

祝你好运！:)

# bash - 在 bash 脚本中设置变量

> ID：15952113
> 
> 赞同：0
> 
> 时间：2013-04-11T14:56:41.763
> 
> 标签：bash, shell

我有以下命令：

```
echo "exec [loc_ver].[dbo].[sp_RptEmpCheckInOutMissingTime_2]" |
  /home/mdland_tool/common/bin/run_isql_prod_rpt_2.sh |
  grep "^| Row_2" |
  awk '{print $15 }' 
```

仅适用`echo`于前面。我试图将此行设置为变量。我试过引号、括号和反引号，但没有成功。

谁能告诉我将其设置为变量的正确语法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T14:59:36.240

```
$result=$(exec [loc_ver].[dbo].[sp_RptEmpCheckInOutMissingTime_2]" | /home/mdland_tool/common/bin/run_isql_prod_rpt_2.sh | grep "^| Row_2" | awk '{print $15 }) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T15:14:09.680

如果你想在一个数组中存储更多列，你应该使用这种语法（如果你只有一个结果也很好）：

```
#!/bin/bash
result=( $( echo "exec [loc_ver].[dbo].[sp_RptEmpCheckInOutMissingTime_2]" |
/home/mdland_tool/common/bin/run_isql_prod_rpt_2.sh |
grep "^| Row_2" |
awk '{print $15 }' ) ) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-11T16:06:25.410

由于您询问了问题的[两种含义](https://stackoverflow.com/questions/15952113/setting-variables-in-bash-script?noredirect=1#comment22732290_15952113)：

首先，想象一个更简单的情况：

```
echo asdf 
```

如果要执行此命令并将结果存储在某处，请执行以下操作：

```
$(echo asdf) 
```

例如：

```
variable=$(echo asdf)
# or
if [ "$(echo asdf)" == "asdf" ]; then echo good; fi 
```

所以一般来说，`$(command)`执行`command`并返回输出。

如果你想存储命令本身的文本，你可以这样做：

```
variable='echo asdf'
# or
variable="echo asdf"
# or
variable=echo\ asdf 
```

不同的格式取决于您的命令内容。因此，现在一旦有了存储命令的变量，就可以简单地使用`$(command)`语法执行命令。但是，请注意命令本身是在一个变量中。因此，您将通过以下方式执行命令：

```
$($variable) 
```

作为一个完整的例子，让我们将两者结合起来：

```
command="echo asdf"
result=$($command)
echo $result 
```

# excel - Excel/Excel VBA 剪切和复制重置单元格名称

> ID：15952117
> 
> 赞同：3
> 
> 时间：2013-04-11T14:56:50.780
> 
> 标签：excel, vba

情况很简单，如果我将 cell 命名`A1`为`MY_CELL`，然后**CUT AND PASTE**从 cell`A2`到 cell `MY_CELL`，那么`MY_CELL`将失去该名称并`A1`再次命名。

但是，当我从to**复制和粘贴**时，不会发生这种情况。`A2``MY_CELL`

如何防止 Excel 重置**CUT AND PASTE**上的单元格名称？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T15:24:29.787

**逻辑**`A1`：使用事件捕获对 Cell 的更改，`Worksheet_Change`并在丢失时重新创建名称。

**代码**：

```
Private Sub Worksheet_Change(ByVal Target As Range)
    Dim DoesRngNameExists As Boolean
    Dim sName As String

    On Error GoTo Whoa

    Application.EnableEvents = False

    '~~> You named range
    sName = "MY_CELL"

    If Not Intersect(Target, Range("A1")) Is Nothing Then
        '~~> Check if the Range exists
        On Error Resume Next
        DoesRngNameExists = Len(Names(sName).Name) <> 0
        On Error GoTo 0

        '~~> If not then recreate it
        If DoesRngNameExists = False Then _
        ThisWorkbook.Names.Add Name:=sName, RefersToR1C1:="=Sheet1!R1C1"
    End If

Letscontinue:
    Application.EnableEvents = True
    Exit Sub
Whoa:
    MsgBox Err.Description
    Resume Letscontinue
End Sub 
```

**注意**：相关工作表的工作表代码区域中的代码。请参阅下面的屏幕截图。

![在此处输入图像描述](https://i.stack.imgur.com/hQdQh.png)

# visual-studio-2010 - Visual Basic - 将最近修改的文件复制到另一个文件夹

> ID：15952120
> 
> 赞同：0
> 
> 时间：2013-04-11T14:57:01.440
> 
> 标签：visual-studio-2010

我听到的以下代码将提取某个文件夹中的所有文件，然后将它们全部复制并放入另一个文件夹中。我今天的问题是如何修改此代码，以便最近修改了从原始文件夹中提取的文件。即使你能告诉我如何只提取从今天起修改过的文件，那也很棒。感谢所有帮助的人！

```
Imports System.IO

Public Class frmExtractionator

Dim txtFiles1 As Control

Private Sub btnStart_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnStart.Click

    Dim sourceDirectory As String = "E:\CopierFolderforTestDriveCapstone"
    Dim archiveDirectory As String = "E:\FilesExtracted"

    Try
        'DeleteUnmodifiedFiles(sourceDirectory, -14)

        Dim txtFiles = Directory.EnumerateFiles(sourceDirectory)

        If (Not System.IO.Directory.Exists(archiveDirectory)) Then
            System.IO.Directory.CreateDirectory(archiveDirectory)
        End If

        For Each currentFileLoc As String In txtFiles
            Dim fileName = currentFileLoc.Substring(sourceDirectory.Length + 1)
            File.Move(currentFileLoc, Path.Combine(archiveDirectory, fileName))
        Next
    Catch eT As Exception
        Console.WriteLine(eT.Message)
    End Try
End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T15:17:07.867

您可以使用[`Directory.GetLastWriteTime`](http://msdn.microsoft.com/en-us/library/system.io.directory.getlastwritetime%28v=vs.100%29.aspx)Method 来确定上次写入文件的时间。

来自链接：

> 返回上次写入指定文件或目录的日期和时间。

```
Dim checkDate As Date = Date.Parse("01/1/2013")

For Each currentFileLoc As String In txtFiles
    Dim fileName = currentFileLoc.Substring(sourceDirectory.Length + 1)
    If Directory.GetLastWriteTime(Path.Combine(sourceDirectory, fileName)) > checkDate Then
        File.Move(currentFileLoc, Path.Combine(archiveDirectory, fileName))
    End If
Next 
```

# mysql - 具有大量字段的本地 infile

> ID：15952122
> 
> 赞同：0
> 
> 时间：2013-04-11T14:57:03.673
> 
> 标签：mysql

我有一个文本文件，其矩阵为 4000 X 4000（行 X 列）我想将其导入表中

这样做的最佳方法是什么：

1.  将数据本地加载到整个文件中，然后将其分解为较小的表
2.  首先将文本文件分成字段数较少的块，然后加载数据本地infile
3.  load data local infile 完整文件，然后不加修改地使用这个表

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T15:36:13.097

我想我找到了我的问题的答案。#1118 - 行大小太大。所用表类型的最大行大小（不包括 BLOB）为 65535。您必须将某些列更改为 TEXT 或 BLOB。我将不得不选择第二个选项。

# java - 来自 Guava 或 Java 枚举的 ImmutableSet

> ID：15952128
> 
> 赞同：3
> 
> 时间：2013-04-11T14:57:20.170
> 
> 标签：java, enums, guava

[我在这里](https://code.google.com/p/guava-libraries/wiki/ImmutableCollectionsExplained)读到了一个关于使用`ImmutableSet`Guava的好例子。为了完整起见，此处报告示例：

```
public static final ImmutableSet<String> COLOR_NAMES = ImmutableSet.of(
  "red",
  "orange",
  "yellow",
  "green",
  "blue",
  "purple");

class Foo {
  Set<Bar> bars;
  Foo(Set<Bar> bars) {
    this.bars = ImmutableSet.copyOf(bars); // defensive copy!
  }
} 
```

问题是，**我可以通过使用 Java 枚举获得相同的结果吗？**

PS：[这个问题](https://stackoverflow.com/questions/11227990/store-an-ordering-of-enums-in-java)让我的脑子更乱了！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-11T15:10:28.940

> 我可以使用 Java 枚举获得相同的结果吗？

是的你可以。你试过了吗？

仅供参考，还有专门的版本，`ImmutableSet`其中包含枚举的常量- [`Sets.immutableEnumSet`](http://google.github.io/guava/releases/23.0/api/docs/com/google/common/collect/Sets.html#immutableEnumSet-java.lang.Iterable-)（在内部它使用`EnumSet`）。

一些示例（解释 Wiki 示例）：

```
public class Test {

  enum Color {
    RED, ORANGE, YELLOW, GREEN, BLUE, PURPLE;
  }

  static class Baz {
    ImmutableSet<Color> colors;

    Baz(Set<Color> colors) {
      this.colors = Sets.immutableEnumSet(colors); // preserves enum constants 
                                                   // order, not insertion order!
    }
  }

  public static void main(String[] args) {
    ImmutableSet<Color> colorsInInsertionOrder = ImmutableSet.of(
        Color.GREEN, Color.YELLOW, Color.RED);
    System.out.println(colorsInInsertionOrder); // [GREEN, YELLOW, RED]
    Baz baz = new Baz(colorsInInsertionOrder);
    System.out.println(baz.colors); // [RED, YELLOW, GREEN]
  }
} 
```

**编辑（在OP的评论之后）：**

你想要 ImmutableSet 中的所有枚举常量吗？做就是了：

```
Sets.immutableEnumSet(EnumSet.allOf(Color.class)); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-11T15:20:34.740

不，不完全是。相比

```
public enum Color {
    RED, ORANGE, YELLOW, GREEN, BLUE, PURPLE;
}

Set<Color> colors = EnumSet.allOf(Color.class); 
```

和

```
Set<String> colors = ImmutableSet.of(
  "red", "orange", "yellow", "green", "blue", "purple"
); 
```

由于 Java 是静态类型的，因此您将`Set<Color>`在第一个示例中使用 a `Set<String>`，在后一个示例中使用 a。

**编辑 1**

另一个区别是您可以`ImmutableSet`在运行时创建任意大小的（前提是没有`equals()`任何其他元素的单个元素）。相反，an`EnumSet`也可以在运行时创建，但它包含的元素永远不能超过枚举值的数量。

**编辑 2**

An`ImmutableSet`可以包含不同类的元素，只要它们实现相同的接口即可。An`EnumSet`只能包含枚举类型。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-10-20T11:51:34.537

如果您没有所有这些花哨的实用程序库作为依赖项，则可以使用标准方式：

```
enum Furniture{SOFA, CHAIR, TABLE};
Set<Furniture> set = Collections.unmodifiableSet(new HashSet<>(Arrays.asList(Furniture.values()))); 
```

BTW：这不是最有效的方法吗？我在那些库的方法中看到了很多代码，可能是矫枉过正？无论如何，这取决于上下文。我的方法有点冗长，不做缓存等一些优化，但它是独立的，正是 OP 所要求的。

# javascript - 正则表达式匹配 _ 或没有字符

> ID：15952132
> 
> 赞同：-3
> 
> 时间：2013-04-11T14:57:25.993
> 
> 标签：javascript, regex

我对 JavaScript 正则表达式有一个小问题。我想匹配 html 类的一部分，例如：

```
req_password_sameAs-myid_min-6 
```

A 只想匹配`sameAs-myid`，但考虑到在此字符串之后可能没有其他字符，例如：

```
req_password_sameAs-myid 
```

也是一种选择。我用这个表达

```
detectCase[i].match(/sameAs-.*?(_|)/g) 
```

但不知道如何分辨正则表达式`_`或没有字符，如您所见。先感谢您

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T14:59:30.840

[正则表达式量词](http://www.regular-expressions.info/repeat.html)。`_?`与 相同`_{0,1}`，表示“下划线或什么都没有”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-11T15:02:31.973

你应该比`.*?`. *那是*您的问题，而不是使下划线可选的语法正确（但丑陋）的方式。

尝试

```
/sameAs-[a-zA-Z]*/g 
```

# ruby - ruby selenium-webdriver 等待元素“确保”不起作用

> ID：15952142
> 
> 赞同：2
> 
> 时间：2013-04-11T14:57:55.327
> 
> 标签：ruby, selenium-webdriver

尝试使用“begin ..ensure”方法单击 element1 后等待 element2 出现在网页上。如果 element2 不存在，我想退出并记录错误。但是 element2 会在几秒钟内出现，但以下代码会确保阻止并使驱动程序退出。不知道是什么问题。提前致谢：

```
$driver.find_element(:id, "element1").click
wait = Selenium::WebDriver::Wait.new(:timeout => 10) # seconds
begin
  wait.until {$driver.find_element(:id, "element2")}
ensure
  #Logger login error to text error log file
  $driver.quit #---------------------------> always goes to ensure and quits
end   
$driver.find_element(:id, "element2").click -->> never gets here 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T15:39:21.347

当找不到元素时，该方法`find_element`会引发 a （请参阅[doc](http://oc.info/gems/selenium-webdriver/0.0.28/Selenium/WebDriver/Find)）。该块不会停止异常，它只会在异常进一步传播之前执行块中的代码。所以永远不会到达结束之后的代码。`NoShuchElementException``begin ... ensure ... end``ensure`

无论如何，我不明白你为什么要打电话`$driver.quit`和 next `$driver.find_element(...)`。似乎也`wait`没用，您可以使用由`driver`（请参阅[隐式等待](http://docs.seleniumhq.org/docs/04_webdriver_advanced.jsp)）管理的超时

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T15:44:08.457

您想使用`rescue`而不是`ensure`.

*   `ensure`总是运行。
*   `rescue`仅在发生异常时运行（即仅在未找到元素时才退出）

尝试：

```
begin
  wait.until {$driver.find_element(:id, "element2")}
rescue
  #Logger login error to text error log file
  $driver.quit #---------------------------> always goes to ensure and quits
end 
```

# iphone - 在来自 JSON 的 NSDictionary/NSArray 中保持 KEYS 的正确顺序

> ID：15952147
> 
> 赞同：2
> 
> 时间：2013-04-11T14:58:04.667
> 
> 标签：iphone, ios, objective-c

我有一个从请求返回的 JSON 数组。
数据是这样的（它来自外部来源，不能从服务器更改）：

```
[{"clients":
{"name":"Client name here","telephone":"00000","email":"clientemail@hotmail.com","website":"www.clientname.com"}
}] 
```

我按此顺序接收 JSON 数组。

我有以下Objective-C：

```
//jsonString is the json string inside type NSString.
NSMutableDictionary *tempDict = [jsonString JSONValue];
NSMutableDictionary *clients = [tempDict objectForKey:@"clients"];

for(NSString *key in clients) {
        id value = [tempDict objectForKey:key]; 
            for(NSString *itemKey in key) {
                NSLog(@"ITEM KEY %@: ",itemKey);

            }
} 
```

它打印密钥的顺序是：
电话
电子邮件
名称
网站

我需要它来打印它是如何接收的（例如）：
姓名
电话
电子邮件
网站

我读过字典没有按定义排序，所以很高兴使用数组而不是字典。

但是我在 StackOverflow 上看到了几个关于可能的解决方案的线程（使用`keysSortedByValueUsingSelector`）：
[Getting NSDictionary keys sorted by their different values](https://stackoverflow.com/questions/9708742/getting-nsdictionary-keys-sorted-by-their-respective-values)
[我可以根据 Objective-C 中的键对 NSDictionary 进行排序吗？](https://stackoverflow.com/questions/3583020/can-i-sort-the-nsdictionary-on-basis-of-key-in-objective-c)
[按字典值将 NSDictionary 键排序到 NSArray](https://stackoverflow.com/questions/11217421/sort-nsdictionary-keys-by-dictionary-value-into-an-nsarray)
[我可以根据 Objective-C 中的键对 NSDictionary 进行排序吗？](https://stackoverflow.com/questions/3583020/can-i-sort-the-nsdictionary-on-basis-of-key-in-objective-c?lq=1)

我已经尝试过了，但一无所获。不确定是否只是我的实现是错误的。

我试过（尝试1）：

```
NSArray *orderedKeys = [clients keySortedByValueUsingComparator:^NSComparisonResult(id obj1, id obj2){
    return [obj1 compare:obj2];
}];

for(NSString *key in orderedKeys) {
        id value = [tempDict objectForKey:key]; 
            for(NSString *keyThree in key) {
                NSLog(@"API-KEY-ORDER %@: ",keyThree);

            }
} 
```

接收错误：`[__NSArrayM keySortedByValueUsingComparator:]: unrecognized selector sent to instance`。

也尝试过（尝试2）：

```
NSArray *sortedKeys = [[clients allKeys] sortedArrayUsingSelector: @selector(compare:)];
NSMutableArray *sortedValues = [NSMutableArray array];
for (NSString *key in sortedKeys){
    [sortedValues addObject: [tempDict objectForKey: key]];
    //[sortedValues addObject: [all objectForKey: key]]; //failed
} 
```

但是即使客户端是 NSMutableDictionary，选择器上的另一个错误。

```
[__NSArrayM allKeys]: unrecognized selector sent to instance 0x4b6beb0 
```

我正处于我认为我将迭代并以正确的顺序`NSMutableDictionary`手动将它们放入新的位置的地步。`NSMutableArray`

任何想法将不胜感激？
或者任何人尝试解决我的问题的代码片段将同样受到赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-04-04T17:53:39.977

不仅 NSDictionary 原则上是无序的，JSON 对象也是如此。这些 JSON 对象是*相同*的：

```
[{"clients":
{"name":"Client name here","telephone":"00000","email":"clientemail@hotmail.com","website":"www.clientname.com"}
}]

[{"clients":
{"website":"www.clientname.com","name":"Client name here","telephone":"00000","email":"clientemail@hotmail.com"}
}] 
```

如果服务器想要有序的键，它需要发送一个数组。当然，您可以使用 keysSortedByValueUsingComparator: 方法按排序顺序获取键。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-11T15:34:27.937

首先，您看到的异常是因为选择器名称不正确。你应该使用`keysSortedByValueUsingComparator`. 其次，您无法对密钥进行排序，因为您从服务器获取它们的顺序似乎没有任何特定的顺序。如果您必须按该顺序排列它们，则使用标签（“索引”）从服务器发送它们，然后按此标签排序。

# php - 订单插入，同一订单中的多个项目

> ID：15952149
> 
> 赞同：1
> 
> 时间：2013-04-11T14:58:11.817
> 
> 标签：php, mysql, orders

我有一个购物车，它在 Sessions 中存储每件商品的 itemId 和数量，直到我们结账。

客户付款后，我继续将信息插入数据库的 ORDERS 表中。

我的问题是：我应该如何处理来自有多个项目的客户的一个订单？多个数量很简单，因为我的 ORDERS 表有一个“数量”字段。但是多个项目呢？推荐什么？我应该为同一个订单的每件商品插入不同的行吗？

目前我有这个：

```
$query = "INSERT INTO orders (itemId, quantity, clientPrice, firstName, lastName, email, phoneNumber, address, city, zip) 
VALUES (:itemId, :quantity, :clientPrice, :firstName, :lastName, :email, :phoneNumber, :address, :city, :zip)"; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T15:02:59.973

在我看来，您应该创建 2 个至少包含以下字段的表：

**订单**

`id | user_id | date`

**ordered_items** - 除了这个表，你还必须有完整的项目表，其中包含关于你的产品的所有信息。`Price`之所以需要这里，是因为您的商品价格可能会发生变化，并且您不得更改已创建订单的“花费金额”。

`item_id | order_id | quantity | price`

因此，您可以使用连接并计算您需要的所有内容 - 表连接将完成所有工作。

# java - 创建多对多关系后“无法构建 EntityManagerFactory”

> ID：15952154
> 
> 赞同：3
> 
> 时间：2013-04-11T14:58:30.460
> 
> 标签：java, hibernate, many-to-many

我刚刚在我的数据库中创建了多对多关系，我的程序停止运行。这是我得到的错误：

```
759 [JavaFX Application Thread] DEBUG org.hibernate.cfg.Configuration  - Processing fk mappings (*ToOne and JoinedSubclass)
767 [JavaFX Application Thread] DEBUG org.hibernate.cfg.Configuration  - Processing extends queue
767 [JavaFX Application Thread] DEBUG org.hibernate.cfg.Configuration  - Processing extends queue
767 [JavaFX Application Thread] DEBUG org.hibernate.cfg.Configuration  - Processing collection mappings
776 [JavaFX Application Thread] DEBUG org.hibernate.cfg.CollectionSecondPass  - Second pass for collection: gear7.partyrock.model.Atividade.convidados
777 [JavaFX Application Thread] ERROR gear7.partyrock.utils.JPAUtils  - Não conseguiu carregar a EntityManagerFactory: [PersistenceUnit: PartyRockPU] Unable to build EntityManagerFactory 
```

这是我的第一个实体：

```
@Entity
@Table(name = "convidados")
public class Convidado implements AbstractEntity, Serializable {
...
    @OneToMany(fetch = FetchType.LAZY, mappedBy = "pk.convidado", cascade = CascadeType.ALL)
    private List<Atividade> atividades; 
```

这是我的第二个实体：

```
@Entity
@Table(name = "atividades")
public class Atividade implements AbstractEntity, Serializable {
...
    @OneToMany(fetch = FetchType.LAZY, mappedBy = "pk.atividade", cascade = CascadeType.ALL)
    private List<Convidado> convidados; 
```

这是我的关系表：

```
@Entity
@AssociationOverrides({
    @AssociationOverride(name ="pk.convidado", joinColumns = @JoinColumn(name ="convidado_id")),
    @AssociationOverride(name ="pk.atividade", joinColumns = @JoinColumn(name ="atividade_id"))
})
public class ConvidadoAtividade implements Serializable {
    private ConvidadoAtividadePk pk = new ConvidadoAtividadePk();
    private Date dataCheckIn;

    @EmbeddedId
    public ConvidadoAtividadePk getPk() {
        return pk;
    }

    private void setPk(ConvidadoAtividadePk pk) {
        this.pk = pk;
    }

    @Transient
    public Atividade getAtividade() {
        return getPk().getAtividade();
    }

    public void setAtividade(Atividade atv) {
        getPk().setAtividade(atv);
    }

    @Transient
    public Convidado getConvidado() {
        return getPk().getConvidado();
    }

    public void setConvidado(Convidado conv) {
        getPk().setConvidado(conv);
    }

    @Temporal(TemporalType.DATE)
    @Column(name = "dataCheckIn", nullable = false)
    public Date getDataCheckIn() {
        return this.dataCheckIn;
    }

    public void setDataCheckIn(Date dataCheckIn) {
        this.dataCheckIn = dataCheckIn;
    }

    @Override
    public boolean equals(Object o) {
        if (this == o)
            return true;

        if (o == null || getClass() != o.getClass())
            return false;

        ConvidadoAtividade that = (ConvidadoAtividade) o;

        if (getPk() != null ? !getPk().equals(that.getPk()) : that.getPk() != null)
            return false;

        return true;
    }

    @Override
    public int hashCode() {
        return (getPk() != null ? getPk().hashCode() : 0);
    }
} 
```

我真的不知道为什么它一直给我显示“收集第二遍”消息以及为什么它无法构建 PU。谁能帮我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T18:10:47.157

那是因为你把`@OneToMany`两边都放了。您需要在一侧（“一”侧）放置`@OneToMany`，而在另一侧（“多”侧）放置`@ManyToOne`。

或者，如果两边确实有一个列表，您可能需要使用`@ManyToMany`注释。

# c# - 编译时由设计器重置的属性

> ID：15952165
> 
> 赞同：2
> 
> 时间：2013-04-11T14:59:01.740
> 
> 标签：c#, winforms, properties

任何人都知道如何在使用自定义用户控件时停止重置属性？

类似于问题：[如何避免在设计时在紧密绑定的用户控件中重置属性？](https://stackoverflow.com/questions/1056080/how-can-i-avoid-properties-being-reset-at-design-time-in-tightly-bound-user-cont)

我已经尝试了链接问题中的解决方案，但他们一直在重置。

下面的示例属性：注意我尝试使用一个简单的属性，但每次编译包含的表单时，它们都会继续重置为 false。

```
[DefaultValue(true)]
[DesignerSerializationVisibility(DesignerSerializationVisibility.Visible)]
[Description("Appearance")]
[EditorBrowsable(EditorBrowsableState.Always)]
public bool ImportFilenameShown
{
    get { return txtImportFile.Visible; }
    set
    {
        txtImportFile.Visible = value;
        lblImportFile.Visible = value;
        btnImportMappings.Visible = value;
        btnImportFileBrowse.Visible = value;
    }
} 
```

任何帮助都会很好。这真让我抓狂。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T15:13:01.380

如果`txtImportFile`'s 的父母之一被隐藏，`txtImportFile.Visible`将始终返回 false。

因此，设计者会序列化错误的值。

相反，您应该将值存储在单独的支持字段中

# windows-phone-7 - 使用 Cordova/Phonegap 保存从手机摄像头拍摄的图像 Windows Phone 7

> ID：15952171
> 
> 赞同：0
> 
> 时间：2013-04-11T14:59:18.247
> 
> 标签：windows-phone-7, cordova, camera, save

我正在使用 Visual Studio 2010 和 Windows Phone 7 模拟器来创建一个应用程序，该应用程序允许用户拍照，然后将其保存到文件系统上的文件夹中，并在数据库中创建它的引用，以便所有数据库中的图像可以显示在应用程序上。但是我无法保存相机拍摄的图像，我花了很长时间浏览 Cordova 文档和其他网站。看起来我需要相机拍摄的图像的文件位置，但无法打开 consol.log，我已经通过注册表编辑器，但无法显示。我想要一个示例，它可以向我展示如何获取相机图像并将其保存到本地存储或创建副本以将其保存到文件夹中。提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T19:55:46.953

将 FILE_URI 用于 Camera.DestinationType 选项。它将使捕获的图像存储在设备的图像库中。

参考：[http ://docs.phonegap.com/en/2.6.0/cordova_camera_camera.md.html#cameraOptions](http://docs.phonegap.com/en/2.6.0/cordova_camera_camera.md.html#cameraOptions)

# vb.net - Report Builder 3.0，如何对计算字段进行排序

> ID：15952173
> 
> 赞同：0
> 
> 时间：2013-04-11T14:59:19.630
> 
> 标签：vb.net, visual-studio-2008, reporting-services, reportbuilder3.0

我在 SQL Server 商业智能开发工作室中将 Report Builder 3.0 与 SharePoint 列表一起使用。

我在 Tablix 上有一个文本框，它使用表达式中的 VB.Net 函数计算来自多个字段的数据。此文本框显示从该函数生成的日期。

我希望我的报告按该日期排序，升序 - 到目前为止，我找不到任何有用的信息。它不是数据集中的一个字段，因此没有一个固定选项可以工作。

提前感谢您的任何帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T13:49:26.413

答案是在 Grouping 属性的 Sort 属性中的字段后面使用相同的表达式，选择 AZ 作为排序顺序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T07:57:03.240

计算字段将在 tablix 中显示为正常字段，应输入为`Fields!cal.Value`

# clojure - 分组和数据获取

> ID：15952176
> 
> 赞同：0
> 
> 时间：2013-04-11T14:59:30.827
> 
> 标签：clojure

我想我误解了 clojure 中的 GET - 我试图从另一个数据集从下面的 A 到 B 塑造 1 个数据集。

A
ID REGION MIN
10346 GLBL 106
10346 ASPAC 106
10346 NA 106
10346 LATAM 106
10346 EMEA 106
10347 GLBL 32
10347 ASPAC 32
10347 NA 32
10347 LATAM 32
10347 EMEA 32
10349 NA 10
10327 NA
10344 EMEA 8
10342 ASPAC 292
10342 EMEA 292
10348 ASPAC 15
10422 欧洲、中东和非洲 37
10438 不适用 0

B
ID EMEA NA ASPAC GLBL LATAM
10346 106 106 106 106 106 106 106 10347 32 32 32 32 32 32 32 32
10349 0 10 0 0 0 0 0 0 0 0 0
10327 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0
10342 292 292 0 292 0 292 0 0
10348 0 0 0 15 0 0 15 0 0 15 0 0
1042222222 37 0 0 0 0
10438 0 0 0 0 0

group by 正在工作，但我得到所有区域的空值，我虽然过滤了我可以使用 get 获取该记录中 MIN 的值并将其映射到新区域字段的区域 - 任何关于我的建议在这里做错了吗？或者我应该使用什么来代替 GET？

```
(defn- create-summary [data]
(->> data

     (group-by :ID
     vals
     (map 
        (fn [recs]
            (let [a (fn [priority](get :MIN (filter #(= priority (:REGION %)) recs)))]
                {:ID (:ID (first recs))
                 :EMEA (a "EMEA")
                 :NA (a "NA")
                 :GLBL (a "GLBL") 
                 :LATAM (a "LATAM")
                 :ASPAC (a "ASPAC")
                 })))

    )) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T15:13:44.513

这个：

```
(let [a (fn [priority](get :MIN (filter #(= priority (:REGION %)) recs)))] 
```

应该

```
(let [a (fn [priority](get (first (filter #(= priority (:REGION %)) recs)) :MIN))] 
```

# php - Codeigniter 2.1，MySQL - 两个左连接

> ID：15952183
> 
> 赞同：0
> 
> 时间：2013-04-11T14:59:40.097
> 
> 标签：php, mysql, codeigniter

我有这样的查询：

```
$q = " SELECT C.*, count(K.id_komentar) broj_komentara FROM clanak C
        LEFT JOIN kategorija KAT
            ON C.kategorija_id = KAT.id_kategorija
        LEFT JOIN komentari K
            ON C.id_clanak = K.clanak_id
        GROUP BY C.id_clanak
        ORDER BY datum_kreiranja DESC ";
  return  $this->db->query($q)->result_array(); 
```

计数部分正在工作，但第一个**LEFT JOIN**（使用**kategorija**）不起作用。我没有从表**kategorija**得到任何东西。如何加入表**categorija**并从该表中获取数据？

**编辑（表格）**

```
kategorija
    id_kategorija
    naziv
    word

clanak
    id_clanal
    naslov
    opis
    kategorija_id
    autor

komentari
    id_komentar
    clanak_id
    tekst 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-11T15:14:22.270

您只是选择 C ​​- clanak 和您的计数，而不是 KAT - 分类。

所以，它会是这样的：

```
SELECT KAT.*, C.*, count(K.id_komentar) broj_komentara FROM... 
```

# java - Eclipse WindowBuilder (swing) - 某些组件无法在代码中访问？

> ID：15952184
> 
> 赞同：1
> 
> 时间：2013-04-11T14:59:40.477
> 
> 标签：java, eclipse, swing, windowbuilder

编辑 - [@Heuster](https://stackoverflow.com/users/2095090/heuster)链接[了另一个](https://stackoverflow.com/questions/11803107/how-to-make-windowbuilder-create-fields-that-are-not-nested-in-eclipse-java)回答这个问题的问题。

我刚刚发现了 WindowBuilder，我正在制作一个简单的聊天客户端，用它来自学。现在我已经完成了基本的聊天框架，但只有我添加的一些组件可以在代码中访问。具体来说，我无法访问我的输入 JTextArea，taInput。我需要做些什么才能引用它（以获取其中的文本以进行发送等）？

这是设计视图的图片：

![](https://i.stack.imgur.com/n1KuP.png)

这是生成的代码：

```
import java.awt.BorderLayout;
import java.awt.EventQueue;
import java.awt.event.MouseAdapter;
import java.awt.event.MouseEvent;

import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JMenu;
import javax.swing.JMenuBar;
import javax.swing.JMenuItem;
import javax.swing.JPanel;
import javax.swing.JScrollPane;
import javax.swing.JTextArea;
import javax.swing.ScrollPaneConstants;
import javax.swing.border.EmptyBorder;

public class frame extends JFrame
{

    private JPanel contentPane;
    private JButton btnSend;
    private JTextArea taDisplay;

    /**
     * Launch the application.
     */
    public static void main(String[] args)
    {
        EventQueue.invokeLater(new Runnable()
        {
            public void run()
            {
                try
                {
                    frame frame = new frame();
                    frame.setVisible(true);
                }
                catch (Exception e)
                {
                    e.printStackTrace();
                }
            }
        });
    }

    /**
     * Create the frame.
     */
    public frame()
    {
        setResizable(false);
        setTitle("Client");
        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        setBounds(100, 100, 440, 316);

        JMenuBar menuBar = new JMenuBar();
        setJMenuBar(menuBar);

        JMenu mnFile = new JMenu("File");
        menuBar.add(mnFile);

        JMenuItem mntmConnect = new JMenuItem("Connect...");
        mnFile.add(mntmConnect);

        JMenuItem mntmSaveChatLog = new JMenuItem("Save chat log...");
        mnFile.add(mntmSaveChatLog);

        JMenuItem mntmSettings = new JMenuItem("Settings...");
        mnFile.add(mntmSettings);

        JMenuItem mntmClose = new JMenuItem("Close");
        mnFile.add(mntmClose);

        JMenu mnEdit = new JMenu("Edit");
        menuBar.add(mnEdit);

        JMenu mnView = new JMenu("View");
        menuBar.add(mnView);

        JMenu mnHelp = new JMenu("Help");
        menuBar.add(mnHelp);
        contentPane = new JPanel();
        contentPane.setBorder(new EmptyBorder(5, 5, 5, 5));
        contentPane.setLayout(new BorderLayout(0, 0));
        setContentPane(contentPane);

        JPanel panel = new JPanel();
        contentPane.add(panel, BorderLayout.CENTER);
        panel.setLayout(null);

        btnSend = new JButton("Send");
        btnSend.addMouseListener(new MouseAdapter()
        {
            @Override
            public void mouseClicked(MouseEvent arg0)
            {
                taDisplay.append("Send clicked.\n");
            }
        });
        btnSend.setBounds(314, 197, 100, 50);
        panel.add(btnSend);

        taDisplay = new JTextArea();
        taDisplay.setLineWrap(true);
        taDisplay.setEditable(false);
        taDisplay.setBounds(10, 11, 404, 180);
        panel.add(taDisplay);

        JScrollPane spInput = new JScrollPane();
        spInput.setHorizontalScrollBarPolicy(ScrollPaneConstants.HORIZONTAL_SCROLLBAR_NEVER);
        spInput.setVerticalScrollBarPolicy(ScrollPaneConstants.VERTICAL_SCROLLBAR_ALWAYS);
        spInput.setBounds(10, 197, 294, 49);
        panel.add(spInput);

        JTextArea taInput = new JTextArea();
        taInput.setLineWrap(true);
        spInput.setViewportView(taInput);
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T15:08:34.293

从设计选项卡中，您可以右键单击项目（taInput），然后单击上下文菜单上的重命名，在对话框中，在名称右侧有 2 个按钮，单击（f）按钮（字段），然后确定.

![在此处输入图像描述](https://i.stack.imgur.com/EqY9R.jpg)

# ruby - 在 Ruby 中使用拆分时保留变音符号

> ID：15952189
> 
> 赞同：2
> 
> 时间：2013-04-11T14:59:56.027
> 
> 标签：ruby, split

为什么此代码（包含变音符号）：

```
text = "Some super text with a german umlaut Wirtschaftsprüfer"
words = text.split(/\W+/)
words.each do |w|
  puts w
end 
```

返回此结果（不保留先前给出的变音符号）：

```
=> Some
=> super
=> text
=> with
=> a
=> german
=> umlaut
=> Wirtschaftspr
=> fer 
```

在 Ruby 1.9+ 中拆分字符串时，有没有办法可以保留变音符号？

编辑：我使用 ruby​​ 1.9.3p286（2012-10-12 修订版 37165）[x86_64-darwin11.4.2]

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-11T15:10:59.160

`[\W]`只匹配非单词字符，即它等同于`[^a-zA-Z0-9_]`，因此不包括（排除？）特殊字符和变音符号。您可以使用

```
words = text.split(/[^[:word:]]/) 
```

匹配所有 Unicode“单词”字符，或

```
words = text.split(/[^\p{Latin}]/) 
```

匹配 Unicode 拉丁脚本中的字符。
请注意，这两者都将匹配来自其他语言的特殊字符，而不仅仅是德语。

请参阅[http://www.ruby-doc.org/core-1.9.3/Regexp.html](http://www.ruby-doc.org/core-1.9.3/Regexp.html)并查找（1）“字符类”和（2）“字符属性”。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-11T15:06:02.020

You could replace `/\W+/` by `/\s+/` (`\s` matches space characters: space, tabs, new lines)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-11T20:12:20.833

> 为什么此代码 [...] 不保留先前给出的变音符号

因为`\W`匹配一个非单词*ASCII*字符（即 not `a-z`、 not `A-Z`、 not`0-9`和 not `_`）并且`ü`是这样的字符。

> 在 Ruby 1.9+ 中拆分字符串时，有没有办法可以保留变音符号？

当然，例如，您可以按空格分隔，如果没有给出模式，这是默认设置：

```
"Müllmann Straßenverkehr Wirtschaftsprüfer".split
=> ["Müllmann", "Straßenverkehr", "Wirtschaftsprüfer"] 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-11T15:14:53.230

来自[Ruby 文档](http://ruby-doc.org/core-1.9.3/Regexp.html)：

> /\W/ - 非单词字符 ([^a-zA-Z0-9_])

`ü`不是单词字符，因此`\W`在那里匹配和拆分。`\p{Lu}`并且`\p{Ll}`是 unicode 大写和小写字符的 ruby​​ 速记，所以你可以这样做：

```
text.split /[^\p{Ll}\p{Lu}]/ 
```

...并且应该拆分即使是最奇特的字符串。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-11T15:05:57.287

because you used /\W/ to split text which means anything not in this list: a-zA-Z0-9

try split

[^\w\ü]

which is

^ not in \w a-zA-Z0-9 \ü

(alternatively look at creating your own pattern which you can reuse)

[http://ruby-doc.org/core-1.9.3/Regexp.html](http://ruby-doc.org/core-1.9.3/Regexp.html) ref

# ios - 如何在特定线程上锁定 NSLock

> ID：15952190
> 
> 赞同：6
> 
> 时间：2013-04-11T15:00:02.777
> 
> 标签：ios, objective-c, multithreading, grand-central-dispatch, nslock

我有财产`@property NSLock *myLock`

我想写两种方法：

```
- (void) lock 
```

和

```
- (void) unlock 
```

`myLock`这些方法分别锁定和解锁**，**无论是什么线程或队列调用它们，它们都需要执行此操作。例如，线程 A 可能已经调用`lock`，但队列 B 可能是调用的那个`unlock`。这两种方法都应该正常工作，而不会报告我正在尝试从锁定它的不同线程/队列中解锁锁。此外，他们需要同步执行此操作。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2013-04-11T15:24:37.743

`NSLock`适合这项工作的工具已经很少见了。现在有更好的工具，尤其是 GCD；以后再说。

正如您可能已经从[文档](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSLock_Class/Reference/Reference.html)中知道的那样，但我会为那些阅读的人重复一遍：

> 警告： NSLock 类使用 POSIX 线程来实现其锁定行为。向 NSLock 对象发送解锁消息时，您必须确保该消息是从发送初始锁定消息的同一线程发送的。从不同的线程解锁锁可能会导致未定义的行为。

如果您尝试在不同的线程上锁定和解锁，那么在没有死锁的情况下很难实现。根本问题是，如果`lock`阻塞线程，那么后续线程就无法在`unlock`该线程上运行，并且您不能`unlock`在不同的线程上运行。`NSLock`不是为了这个问题。

而不是`NSLock`，您可以使用 实现相同的模式`dispatch_semaphore_create()`。这些可以在您喜欢的任何线程上安全地更新。您可以使用 锁定`dispatch_semaphore_wait()`，也可以使用 解锁`dispatch_semaphore_signal()`。也就是说，这通常*仍然*不是正确的答案。

大多数资源争用最好通过操作队列或调度队列来管理。这些提供了很好的方法来并行处理工作、管理资源、等待事件、实现生产者/消费者模式，以及做几乎所有你过去会做的`NSLock`事情`NSThread`。我强烈推荐[并发编程指南](http://developer.apple.com/library/ios/#documentation/General/Conceptual/ConcurrencyProgrammingGuide/Introduction/Introduction.html)作为如何使用队列而不是锁进行设计的介绍。

# c++ - 围绕具有给定偏移量的对象旋转

> ID：15952191
> 
> 赞同：1
> 
> 时间：2013-04-11T15:00:14.113
> 
> 标签：c++, math, sfml

我正在尝试创建一个效果，其中两个射弹将以给定的实体在给定的玩家偏移处射出。一个快速的实现是这样的；

```
sf::Vector2f offset = m_owner->GetSprite().getPosition();

offset.y -= 5;
createProjectile(offset, m_owner->GetSprite().getRotation());
offset.y += 10;
createProjectile(offset, m_owner->GetSprite().getRotation()); 
```

如果您的实体只想在 .x 轴上发射，这非常有效，但是一旦您旋转播放器，它就会中断，因为偏移量没有脱离播放器当前的旋转。

我尝试了很多实现，但似乎都没有奏效，而且由于我的数学非常糟糕，我自己无法解决。

```
void Weapon::createProjectile(const sf::Vector2f& position, float angle)
{
        m_owner->_state->addEntity(new Projectile(m_owner, position, angle,*m_texture, m_velocity, m_damage));
}

Projectile::Projectile(Entity* emitter, const sf::Vector2f& position, float angle,
    const sf::Texture& image, int speed, int damage) :
    Entity(emitter->_state, true, entityName::entityBullet, speed)
{
        Load(_state->getApp()->gettextureManager().Get("Content/ball.png"));
    GetSprite().setRotation(angle);

        SetPosition(position.x,position.y);
        GetSprite().setScale(0.4f,0.4);
} 
```

回答：

```
float rad;
offset = m_owner->GetSprite().getPosition();

rad = math::to_rad(m_owner->GetSprite().getRotation());

offset.x += 5*sin(rad);
offset.y += -5*cos(rad);

createProjectile(offset,m_owner->GetSprite().getRotation());

offset = m_owner->GetSprite().getPosition();

offset.x += -5*sin(rad);
offset.y += 5*cos(rad);

createProjectile(offset,m_owner->GetSprite().getRotation()); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T15:04:55.603

The math you need to study up on is trigonometry. It is very useful!

If your character is rotated `theta` radians from "straight up" going clockwise, your top offset will be:

```
offset.x += 5*sin(theta);
offset.y += -5*cos(theta); 
```

and the other will be

```
offset.x += -5*sin(theta);
offset.y += 5*cos(theta); 
```

This is "circle math" (trigonometry) the 5 is the offset you speak of, also called the radius of the circle. A quick sanity check when doing this kind of math is to consider what will happen at 0 radians. Some quick facts of `sin` and `cos`:

```
sin(0) = 0
cos(0) = 1
sin'(0) = 1
cos'(0) = 0 
```

(the second ones are derivatives: sin is initially increasing, cos is flat at the start. Check their graphs.) This and a bit more intuition is helpful for writing graphics code - if we consider the case when `theta = 0` we get back your original code. One exception: you are getting the second offset relative to the first offset: I'd avoid doing that and instead make two copies of `m_owner->GetSprite().getPosition();` or reset `offset` after creating the first projectile.

# sql - 添加新表或扩展表

> ID：15952192
> 
> 赞同：0
> 
> 时间：2013-04-11T15:00:18.023
> 
> 标签：sql, oracle

我有三个事务表，用户可以在其中更新事务的状态。这些表在上次更新状态时捕获用户详细信息、数据时间等。

我有一个要求，如果用户将交易状态更新为 'X' ，则应在第二天选择这些交易。现在的问题是.. 如果用户“A”将状态更新为“X”，该表将捕获用户“A”的详细信息，现在如果用户“B”将状态从“X”更改为“Y”，则表将捕获用户“B”的详细信息（最后更新状态的人），用户“A”的详细信息将丢失。第二天，由于状态已更改，我无法选择该交易。

添加包含状态和用户详细信息的列的新表是否更好？当有人将状态更改为“X”时，将在其中插入一条记录。或者当状态更新为“X”时，最好在现有事务表中添加新列来捕获用户详细信息？

```
-------------------------
Existing Table  design
-------------------------
------------------------------------------------------------------------
Key | Status | User name | User ID | Update_Dt |Other Columns.........
-------------------------------------------------------------------------
1   |    Y   |      B    |    2    |  2013-01-10

-------------------------
Adding new Table
-------------------------
------------------------------------------------
Key | Status | User name | User ID | Update_Dt |
------------------------------------------------
1   |    X   |      A    |     1   |  2013-01-10 
```

或者

```
----------------------------------
Extending Existing Table  design
---------------------------------
--------------------------------------------------------------------------------------
Key| Status|User_name|User_ID|Update_Dt|X_Stat_User_Name|X_Stat_User_ID| X_Stat_Upd_Dt|other columns....
---------------------------------------------------------------------------------------
1  |   Y   |   B     |    2  |2013-01-10|    A          |       1      | 2013-01-10 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T19:42:22.933

我会添加另一个表。这还有一个好处是您可以查看交易的历史记录。

相信我——“他们”说他们有一天不需要它，他们会来找你，“这个值是错误的。谁改变了它？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T15:11:27.350

我建议添加另一个表调用 Transaction ，您可以在其中记录到它。因此，获得对其进行的所有修改可能会更容易。

# php - 贝宝 REST API

> ID：15952193
> 
> 赞同：2
> 
> 时间：2013-04-11T15:00:19.640
> 
> 标签：php, paypal

我有点困惑。抱歉这个愚蠢的问题，只是无法弄清楚它的工作原理。

正如我从 developer.paypal.com 上的文档中看到的那样，REST API**不需要**在网站上使用任何 iframe？因此显示了来自[http://paypal.github.io/](http://paypal.github.io/)的示例（PHP SDK 中的/sample/payments/CreatePayment.php）：只需创建适当的对象，使用信用卡数据（+计费信息）进行调用，一切就完成了；或重定向到 PayPal 以使用 paypal 帐户结帐。沙盒帐户一切正常。据我了解，现在我可以输入我的实时凭据，添加我的银行账户，获取新的 client_id 和密钥，在 API 调用中更改它们，一切都应该在真实环境中运行，对吧？

我们现在使用带有 iframe（自定义布局）的 PayPal Payments Advanced 来处理带有一些奇怪 SDK 的付款，并希望迁移到这个新的 API。但是 paypal 的电话支持说这个 REST API 是“*一种 iframe 技术*”，这意味着我们无论如何都应该使用 iframe。真相在哪里？

我认为 PayPal 中有 3 种支付解决方案——标准、高级和专业。Advanced 允许您使用 iframe，使用 Pro，您可以使用自己的表单，然后只需调用 API 即可继续进行交易。所以我认为 REST API 是经典 API 的这些解决方案的替代品。现在我觉得我错了。

简而言之.. 如果有人解释这些解决方案和不同 API 的要点，我会很困惑并且非常感谢。谢谢

* * *

## 回答 #1

> 赞同：-3
> 
> 时间：2013-04-12T04:46:00.807

是的，您对新 REST API 的理解是正确的，如在第 1 段中进行 API 调用以开始接受付款。

除了您提到的示例之外，您可能还想查看我们拥有的参考示例应用程序 @ [https://github.com/paypal/rest-api-sample-app-php](https://github.com/paypal/rest-api-sample-app-php)

如果遇到问题，请打开问题@GitHub。谢谢。

# ios - 单元格内带有 UITextField 的 UITableViewCell

> ID：15952196
> 
> 赞同：1
> 
> 时间：2013-04-11T15:00:28.377
> 
> 标签：ios, xcode, uitableview

我正在为 iOS 的本地联系人应用程序创建一个类似于“新联系人”的表单。

我发现的唯一方法是创建一个表格视图并创建一个自定义表格视图单元格。

到目前为止，一切都很好...

现在，我的 TextField 只有在单击它时才会获得焦点，但是当我单击我创建的 Table View Cell 类的任何位置时，我想将焦点设置为 TextField。

我试过了：

```
- (void)setSelected:(BOOL)selected animated:(BOOL)animated
{
    [super setSelected:selected animated:animated];
    [self.txtInputer becomeFirstResponder];
    // Configure the view for the selected state
} 
```

但它并没有像我希望的那样工作，焦点被设置到表格的最后一个字段。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-12T07:26:48.697

使用 UITextField 作为类的 .h（我称之为 textField）中的属性创建一个自定义单元格。（我称它为 TextFieldCell）

然后在 didSelectRowAtIndexPath 中有下面的代码。当一个单元格被点击时，您将获得对 TextFieldCells 的引用，然后您可以从中查找 textField 属性并在其上调用 becomeFirstResponder。注意我已经包含了你应该在这个例子中使用的枚举。如果您不知道这些是什么，请将它们放在您的#includes 下方并用谷歌搜索。喜欢枚举！！

```
//table view sections
enum
{
    TableViewSectionUsername = 0,
    TableViewSectionPassword,
        TableViewSectionLogin,
    TableViewSectionCount
};

- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
    TextFieldCell *usernameCell = (TextFieldCell*)[_tableView cellForRowAtIndexPath:[NSIndexPath indexPathForRow:0 inSection:TableViewSectionUsername]];
    TextFieldCell *passwordCell = (TextFieldCell*)[_tableView cellForRowAtIndexPath:[NSIndexPath indexPathForRow:0 inSection:TableViewSectionPassword]];

    //switch section
    switch(indexPath.section)
    {
        case TableViewSectionUsername:
        {
            [[usernameCell textField] becomeFirstResponder];
            break;
        }

        case TableViewSectionPassword:
        {
            [[passwordCell textField] becomeFirstResponder];
            break;
        }

        case TableViewSectionLogin:
        {
            if([[[usernameCell textField] text] isEqualToString:@""])
            {
                NSLog(@"Please enter a username");
                [[usernameCell textField] becomeFirstResponder];
                return;
            }

            if([[[passwordCell textField] text] isEqualToString:@""])
            {
                NSLog(@"Please enter a username");
                [[passwordCell textField] becomeFirstResponder];
                return;
            }

            [self dismissViewControllerAnimated:YES completion:nil];
            break;
        }

        default:
        {
        break;
        }
    }

    //deselect table cell
    [_tableView deselectRowAtIndexPath:indexPath animated:YES]; 
```

}

# c++ - 在 union 中使用 char 数组

> ID：15952204
> 
> 赞同：7
> 
> 时间：2013-04-11T15:01:00.287
> 
> 标签：c++

我可以打印整数的地址和值，但不能打印联合的字符。为什么会这样

```
#include <iostream>

using namespace std;

union Endian
{
    int i;
    char c[sizeof(int)];
    int j;
};

int main(int argc, char *argv[]) {
    Endian e;
    e.i = 20;
    cout << &e.j;
    cout << &e.i;
    cout << &e.c[0]; //Why can't I print this address
    cout << e.c[1]; // Why can't I print this value

} 
```

O/P:0x7fff5451ab68 0x7fff5451ab68

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-04-11T16:07:48.033

**免责声明：OP的标签很模糊，所以这个答案使用代码作为参考框架，即C++（使用`iostream`，拉入`std`命名空间，`cout`）。**

您正在`union`以不适当的方式使用。但我们稍后再谈。

```
e.i = 20; 
```

您的代码首先使用 union as `i`，一个整数。没关系。但是你后来的所作所为真的不是一个好主意。首先，您做了两件可以接受的事情：

```
cout << &e.j;
cout << &e.i; 
```

您在 union 中查询了两个`int`s 的地址，这很好，因为它们都共享存储，因此第一个字节的地址是共享的。

```
cout << &e.c[0]; //Why can't I print this address
cout << e.c[1]; // Why can't I print this value 
```

现在，这就是你越界的地方。您现在正在执行隐式指针算术和取消引用，以索引到`char[]`数组，即使您尝试获取第一个元素的地址，也可能评估一个不是联合中最后一个集合的元素。所以，这是一个很大的禁忌。

此外，`&e.c[0]`基本上是`char*`哪个将被“拦截”并被`cout`视为 C 风格的字符串。它不会将其视为简单地址。

```
cout << e.c[1]; // Why can't I print this value 
```

未定义的行为。**“可是，可是！”** ，我能听到你们中的一些人说。是的，它是 C++ 中的 UB。在 C99 (6.5/7) 中有效，仅通过脚注和一些胶带。这是一件简单的事情，LightnessRacesInSpace 和 Mysticial 在这个答案和其他人的评论中已经解释过。

是的，您可以将任何类型的变量转换为 char 数组，并出于您的任何目的而将其弄乱。但是在 C++ 中通过联合进行类型双关是非法的，没有任何理由和借口。是的，它可能会起作用。是的，如果您不介意，您可以继续使用它。但根据 C++ 标准，这显然是非法的。

**除非该成员是您为其分配值的联合的最后一个成员，否则您不得检索其值。就这么简单。**

C++ 中的联合有一个目的，如下所述。它们还可以具有成员函数和访问说明符。它们不能有虚函数或静态成员。它们也不能用作基类或从某些东西继承。而且它们不能用于类型双关语。这在 C++ 中是非法的。

进一步阅读！

## 了解工会

工会是：

*   一种允许内存重用的方法。
*   而已。

工会不是：

*   **一种在工会元素之间进行牛仔表演的方法**
*   **一种欺骗严格别名的方法。**

*甚至 MSDN 都做对了*：

> 联合是一种用户定义的数据或类类型，在任何给定时间，它只包含其成员列表中的一个对象（尽管该对象可以是数组或类类型）。

这是什么意思？这意味着您可以按照以下方式定义一些东西：

```
union stuff {

    int i;
    double d;
    float f;    

} m; 
```

这个想法是所有这些都坐在内存中的同一个空间中。联合的存储是从给定实现中的最大数据类型推断出来的。平台在这里有很大的自由度。规范无法涵盖的自由。不是 C。不是 C++。

您**不能**将其作为 an 写给 union `int`，然后将其作为 a `float`（或其他任何东西）作为某种奇怪的牛仔 reinterpret_cast 的一种方式来阅读。

**的使用`std::cout`是出于示例目的和简单性。**

## 这是非法的：

```
m.i = 5;
std::cout << m.f; // NO. NO. NO. Please, no. 
```

## 这是合法的：

```
m.i = 5;
std::cout << m.i;

// Now I'm done with i, I have no intention of using it
// If I do, I'll make sure I properly set it.

m.f = 3.0f;
std::cout << m.f; // No "cowboy-interpreting", defined.

// I've got an idea, but I need it to be an int.

m.i = 3; // m.f and m.d are here-by invalidated.
int lol = 5;
m.i += lol; 
```

注意没有“交叉火力”。这是预期的用途。用于三个不同时间使用的三个变量的超薄内存存储，无需争吵。

误解是如何产生的？一些非常糟糕的人有一天醒来，我敢打赌其中一个是 3D 程序员并考虑这样做：

```
// This is wrong on so many different levels.
union {

    float arr[4];
    struct {
        float x,y,z,w;
    };

}; 
```

毫无疑问，他有一个“高尚的想法”，即以浮点数组和单个 xyzw 成员的形式访问 4 元组。现在，您知道为什么在联合方面这是错误的，但这里还有一个失败：

**C++ 没有匿名结构**。它确实具有匿名联合，出于上述目的，使其更接近预期用途（删除`m.`“前缀”），因为您肯定可以看到这对联合背后的一般理念有何好处。

不要这样做。请。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-11T15:02:32.960

~~严格来说，[您的代码的行为是 undefined](https://stackoverflow.com/questions/1812348/a-question-about-union-in-c)。~~与我之前所说的相反，代码的行为不是未定义的（我认为它是*实现定义*的）。有关说明，请参阅[https://stackoverflow.com/a/1812932/367273](https://stackoverflow.com/a/1812932/367273)。

发生的是`&e.c[0]`type `char*`，因此被打印为 C 字符串，而不是指针。该字符串为空白或由不可打印的字符组成，因此您看不到任何输出。类似的事情发生在`e.c[1]`，除了它是一个单一的`char`而不是一个字符串。

当我初始化`e`如下：

```
e.i = 0x00424344; 
```

最后两行分别打印`DBC`和`B`（这利用了在我的机器上，`int`32 位宽并且是小端序的事实）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-11T15:06:02.833

It's *Undefined Behaviour* to access field of the `union` with a type other than the last set one, at least in C++.

Whilst taking an address is legal in theory, that's not what the unions are for.

# iphone - 在没有 App Store iPhone 的情况下下载并安装应用程序

> ID：15952206
> 
> 赞同：0
> 
> 时间：2013-04-11T15:01:03.327
> 
> 标签：iphone, ios, xcode4.5

我希望从服务器下载我的应用程序而不去 App Store。我有一个临时分发版本，那么如何将它部署到服务器并通过使用 QR 码扫描链接来下载应用程序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T15:04:04.210

除非您希望作为企业开发人员计划的一部分在内部进行分发，否则这对于您的应用程序的广泛分发实际上并不适用。如果您希望分发给 beta 测试人员，您可以查看以下内容：

[http://shinydevelopment.com/blog/over-the-air-ios-provisioning-and-distribution/](http://shinydevelopment.com/blog/over-the-air-ios-provisioning-and-distribution/)

此外，还提供了一些服务，例如 TestFlight 或 HockeyApp，这使得执行此操作更加容易。

# java - 使用 mockito 存根具有依赖泛型参数的方法

> ID：15952207
> 
> 赞同：3
> 
> 时间：2013-04-11T15:01:04.507
> 
> 标签：java, mockito

我试图用像这样的依赖泛型参数来存根一个方法：

```
<T extends Foo> void exampleMethod(Type<T> arg1, T arg2); 
```

使用 Mockito。但是当我尝试这样做时

```
verify(mock).exampleMethod(isA(Type.class), any()); 
```

它不起作用，但给了我一个无限的泛型错误。（我知道这不是存根，但这样的例子更容易，它归结为我认为的同一件事。）

如果有人可以提供帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-13T18:55:06.907

这里的错误是`any()`返回一个类型 Object，它对 type 无效`T`。泛型只负责警告。改用`any(Foo.class)`：

```
public class MockTest {
  public static void main(String[] args) {
    MockTest sandbox = Mockito.mock(MockTest.class);

    // gives a type safety warning suppressable with @SuppressWarnings
    verify(sandbox).exampleMethod(isA(Class.class), any(Foo.class));

    // gives an unchecked cast warning suppressable with @SuppressWarnings
    verify(sandbox).exampleMethod((Class<Foo>) isA(Class.class), any(Foo.class));

    // gives no warnings because the cast in the helper method below
    verify(sandbox).exampleMethod(isAClassOf(Foo.class), any(Foo.class));
  }

  @SuppressWarnings("unchecked")
  private static <T> Class<T> isAClassOf(Class<T> clazz) {
    return isA(Class.class);
  }

  <T extends Foo> void exampleMethod(Class<T> arg1, T arg2) { }
} 
```

# c# - 调用 RadWindow 客户端的 VisibleOnPageLoad

> ID：15952208
> 
> 赞同：0
> 
> 时间：2013-04-11T15:01:04.583
> 
> 标签：c#, asp.net, .net, telerik, radwindow

我有一个使用带有内容页面和用户控件的 MasterPage 的应用程序。在其中一个用户控件中，我们有另一个用户控件（我知道，这是一种 Inception 类型的东西）。此用户控件使用 RadAjaxManagerProxy 并具有生成 RadWindow 的控件。一切正常：窗口显示了一些填充了数据库字段的 RadGrid，然后我关闭了窗口。

所有这些都是`RadWindow1.VisibleOnPageLoad = true`在一些服务器端事件中完成的。关闭窗口后，我无法进行设置`RadWindow1.VisibleOnPageLoad = false;`，因此当我单击另一个触发 AJAX 事件的控件（在本例中显示不同的 RadWindow）时，之前的 RadWindow 会弹出。

在我们应用程序的其他部分，我们通过 RadWindow 的 OnClientClose 方法将参数传递给服务器，该方法用于调用 RadAjaxManager 的服务器端 OnAjaxRequest 事件。这会触发服务器端事件，我可以设置属性，如下所示：

JS：

```
function WindowClose(sender, args) {
    SendRequest("ArgumentName");
}

function SendRequest(requestName) {
    var ajaxManager = $find("<%= RadAjaxManagerMain.ClientID %>");

    ajaxManager.ajaxRequest(requestName);
} 
```

C＃：

```
protected void RadAjaxManagerMain_AjaxRequest(object sender, AjaxRequestEventArgs args)
{
    if (args.Argument == "ArgumentName")
    {
        RadWindow1.VisibleOnPageLoad = false;
    }
} 
```

但由于我使用的是 RadAjaxManagerProxy，因此不支持 RadAjaxManager 的 OnAjaxRequest 方法。

我为此提出了一些选择：

*   在客户端设置 VisibleOnPageLoad，我在任何论坛或文档的任何地方都找不到。
*   将某种不同的事件传递给服务器，以便我可以设置属性。

或者，也许有一些我不知道或没有想到的完全不同的东西。我愿意接受任何选择。我已经有一个 Javascript 方法在我关闭窗口时被触发，我只是想不出一种方法来让窗口保持关闭而不进行完整的回发。

如何防止我的 RadWindow 在另一个 AJAX 请求时打开？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T15:12:43.860

刚刚找到解决方案。它就在我的面前。RadWindowManager`EnableViewState="false"`上的设置阻止了此问题的发生。很简单。希望它对将来的人有所帮助。

# php - Doctrine DBAL 和 Oracle 关键字

> ID：15952209
> 
> 赞同：2
> 
> 时间：2013-04-11T15:01:04.927
> 
> 标签：php, oracle, doctrine-orm, dbal

我在没有 ORM 的情况下独立使用 DBAL，因为我不需要它。但是，我现在在查询中使用 oracle 关键字时遇到了一些问题。例如我有以下代码：

```
$journal = array(
    'LGM_ID'        => 'SEQ_JOURNAL.NEXTVAL',
    'LGM_USER_LOGIN'    => "a user",
    'LGM_DATE'      => 'CURRENT_TIMESTAMP'
);
$db->insert('JOURNAL', $journal); 
```

这不起作用，我收到以下错误：

```
ORA-01722: invalid number 
```

我认为这是因为使用了序列。用整数替换数组中的第一项后，出现以下错误：

```
ORA-01858: a non-numeric character was found where a numeric was expected 
```

这次我认为是因为 CURRENT_TIMESTAMP 关键字。

我认为在传递查询关键字时最后会转换为字符串并且它不起作用。有没有办法使用序列或其他关键字而不使用像 ORM 这样的额外东西？

对于序列，我认为我可以在获取 nextval 之前运行另一个请求。但是，对于 CURRENT_TIMESTAMP，我真的不想使用 php 日期时间，因为我的日期是分时的，它会为 oracle 完美处理的函数添加太多额外代码。

我的最后一个解决方案是将完整的查询编写为字符串并使用 $db->query(...) 但这不是抽象层的目标。

非常感谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-01-30T16:25:48.993

我不确定`CURRENT_TIMESTAMP`行为如何，但我可以肯定的是序列的字符串会产生错误。

Doctrine（或 PDO 的价值）将简单地将字符串绑定`SEQ_JOURNAL.NEXTVAL`到`LGM_ID`列。

据我所知，你有两种方法来处理这个问题。

**第一种方法**

先增加序列的值，得到：

```
$id = (int) $db->fetchColumn('SELECT SEQ_JOURNAL.NEXTVAL FROM dual'); 
```

在插入语句中使用检索到的 ID：

```
$journal = array(
    'LGM_ID' => $id,
    'LGM_USER_LOGIN' => "a user",
    'LGM_DATE' => 'CURRENT_TIMESTAMP'
);

$db->insert('JOURNAL', $journal); 
```

这种方法的缺点是它涉及两个查询。

**第二种方法**

这是基于准备好的语句，而不是 DBAL 的快捷方式（insert() 是 DBAL 对真正的准备好的语句的快捷方式，executeUpdate()）：

```
$db->executeUpdate("
    INSERT INTO JOURNAL (
        LGM_ID,
        LGM_USER_LOGIN,
        LGM_DATE
    ) VALUES (
        SEQ_JOURNAL.NEXTVAL,
        :userLogin,
        CURRENT_TIMESTAMP
    )
", array(
    :userLogin => 'a user',
)); 
```

在我看来，它比第一个更好，您可以使用 CURRENT_TIMESTAMP 函数（我不确定第一个用例）。

如果要以不同方式处理 CURRENT_TIMESTAMP，可以将列的默认值设置为当前日期。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T11:45:09.853

我正在回答最后一条评论，因为我无法根据需要格式化新评论。

我可以使用 DBAL 记录的所有内容是：请求和参数：

```
INSERT INTO JOURNAL (LGM_TYPE, LGM_SUBTYPE, LGM_OBJECT_ID, LGM_OBJECT_TABLE, LGM_DATA, LGM_ID, LGM_USER_LOGIN, LGM_DATE) VALUES (?, ?, ?, ?, ?, ?, ?, ?)  

Array  
(  
    [0] => 3  
    [1] => 0  
    [2] => 245  
    [3] => ENTITY  
    [4] => Deletion of specific entity  
    [5] => 1  
    [6] => user  
    [7] => CURRENT_TIMESTAMP  
) 
```

我不确定我们能否将确切的查询作为字符串获取。

# javascript - ASP.NET Google Maps API v2 工作，而不是 v3

> ID：15952222
> 
> 赞同：1
> 
> 时间：2013-04-11T15:01:34.510
> 
> 标签：javascript, asp.net, google-maps

我一直在尝试将谷歌地图上的地图（和标记）添加到 asp.net 网络应用程序中，并让它工作。然后我发现我使用的是 GMap API v2 而不是 v3。然后我在 v3 中再次创建了地图，但现在它不会显示。

这是我的 v3 代码：

```
<script type="text/javascript">
    function initialize() {
        var homeLatlng = new new google.maps.LatLng(57.048909, 9.921521); //McDonald's

        var mapOptions = {
            zoom: 10,
            center: homeLatlng,
            mapTypeId: google.maps.MapTypeId.ROADMAP
        };

        var map = new google.maps.Map(document.getElementById("map-canvas"), mapOptions);
    }

    google.maps.event.addDomListener(window, 'load', initialize);
</script> 
```

和 v2：

```
<script type="text/javascript">
function initialize() {
    if (GBrowserIsCompatible()) {
        var map = new GMap2(document.getElementById("map"));
        map.setCenter(new GLatLng(57.05, 9.92), 14);
        map.setUIToDefault();
    }
}
</script> 
```

如果这是重复的帖子，我很抱歉，但我无法通过搜索找到答案。

亲切的问候，莫温克尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T15:10:59.900

你有错字`new new`。这是我的使用方法。

```
<script src="http://www.google.com/jsapi" type="text/javascript"></script>
<script type="text/javascript">

    // Load google map
    google.load("maps", "3", { other_params: "sensor=false" });

    function initialize() {
        var homeLatlng = new google.maps.LatLng(57.048909, 9.921521);

        var mapOptions = {
            zoom: 10,
            center: homeLatlng,
            mapTypeId: google.maps.MapTypeId.ROADMAP
        };

        var map = new google.maps.Map(document.getElementById("map-canvas"), 
           mapOptions);
    }

    google.setOnLoadCallback(initialize);
</script> 
```

## 原始问题的解决方案

```
<script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?sensor=true"></script>
<script type="text/javascript">
    function initialize() {
        var homeLatlng = new google.maps.LatLng(57.048909, 9.921521); //McDonald's

        var mapOptions = {
            zoom: 10,
            center: homeLatlng,
            mapTypeId: google.maps.MapTypeId.ROADMAP
        };

        var map = new google.maps.Map(document.getElementById("map-canvas"), mapOptions);
    }

    google.maps.event.addDomListener(window, 'load', initialize);
</script>
<div id="map-canvas" style="width: 300px; height: 300px">
</div> 
```

# c# - 如何在 EntityObject 列表上执行 Distinct

> ID：15952227
> 
> 赞同：1
> 
> 时间：2013-04-11T15:01:39.883
> 
> 标签：c#, .net, linq, entity-framework

Distinct() 不能应用于某些实体，因为某些字段不能被散列（作为文本字段）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T15:01:39.883

毕竟，当 EntityObject 需要 Distinct 时，我们只需要对实体键进行比较。IEqualityComparer 可以这样实现：

```
public class EntityObComparer : IEqualityComparer<EntityObject>
{
    public bool Equals(EntityObject x, EntityObject y)
    {
        return x.EntityKey.Equals(y.EntityKey);
    }

    public int GetHashCode(EntityObject obj)
    {
        return obj.GetHashCode();
    }
} 
```

然后 distinct 可以像这样执行：

```
var foo = MyListOfEntityObjects.Distinct(new EntityObComparer()); 
```

# php - 无法通过图形 api php sdk 发布

> ID：15952231
> 
> 赞同：0
> 
> 时间：2013-04-11T15:01:51.727
> 
> 标签：php, facebook, facebook-graph-api

我的范围参数中有以下内容 -> 'email,publish_stream'; 并且权限由用户授予。但是，我无法通过图形 api 发布到用户的墙上。

**这是我的代码：**

```
<?php
if(isset($_POST['publish'])){
    try{
        $publishStream = $facebook->api("/$user/feed", 'post', array(
            'message'       => 'Example',
            'link'          => 'http://example.com',
            'picture'       => 'http://example.com/75x75.png',
            'name'          => 'Example website',
            'caption'       => 'example.com',
            'description'       => 'A Technology Laboratory. Highly   
Recomented technology blog.',
            ));
    }catch(FacebookApiException $e){
        error_log($e);
    }
}

// Update user's status using graph api
if(isset($_POST['status'])){
    try{
        $statusUpdate = $facebook->api("/$user/feed", 'post',             
array('message'=> $_POST['status']));
    }catch(FacebookApiException $e){
        error_log($e);
    }
}

?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T15:17:48.383

通常我会这样做：

```
$response = $facebook->api('/'.$fanpage.'/feed?access_token='.$fanpage_token, 'POST',
                                array(
                                  'message' => $result['message'],
                                  'link' => $result['link']
                             )); 
```

尝试将访问令牌直接传递到 $_GET。

**阅读详细信息：** $response - 这存储了 facebook api $facebook 的响应，这来自以下内容：

```
$facebook = new Facebook(array(
      'appId'  => YOUR_APP_ID,
      'secret' => YOUR_SECRET_KEY,
)); 
```

$fanpage - 这是我要发布到的粉丝页面 ID

$fanpage_token - 这是我正在使用的粉丝页面访问令牌（能够管理页面）

$result['message'] - 这是来自数据库的结果，带有要在页面上发布的消息

$result['link'] - 这是我附加到要发布的消息的链接

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-18T08:01:38.263

[http://developers.facebook.com/roadmap/completed-changes/](http://developers.facebook.com/roadmap/completed-changes/)

API 发生了变化。无法使用图形 api 在墙上发布。使用提要对话框。

# jquery - jqGrid 未初始化。这是正确的方法吗？

> ID：15952233
> 
> 赞同：0
> 
> 时间：2013-04-11T15:02:01.683
> 
> 标签：jquery, asp.net, jqgrid

感谢您花时间帮助我迈出 jqGrid 的第一步。我有一个关于如何处理我需要部署的网格的问题。

要在 Grid 中显示的数据来自 DataSet。我将表格解析为已验证的 Json 字符串。所以，逻辑是使用 datatype: 'jsonstring' 但我也读过 jsonstring 和 datastr 在分页方面有点不是最新的。那么你的建议是什么？

在第一个草图中，jqGrid 没有被初始化。空白页。为了缩小错误，我将 <%=jsonString%> 替换为包含 jsonstring: 相同结果的局部变量。

```
<link rel="stylesheet" href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.9.1/themes/south-street/jquery-ui.css" type="text/css" media="all" />    
<link href="css/ui.jqgrid.css" rel="stylesheet" type="text/css" />

<script src="js/jquery-1.8.2.js" type="text/javascript"></script>
<script src="js/jquery-ui-1.9.1.custom.min.js" type="text/javascript"></script>
<script src="js/i18n/grid.locale-es.js" type="text/javascript"></script>
<script src="js/jquery.jqGrid.min.js" type="text/javascript"></script>

<script type="text/javascript">
jQuery(document).ready(function () {
    $(function () {
        $("#Grid").jqGrid({
            datatype: 'jsonstring',
            datastr: <%=jsonString%>;
            mtype: 'POST',
            height: 100,
            width: 500,
            colNames: ['Name', 'LastName', 'Qty', 'Yold', 'Address'],
            colModel: [
                    { name: 'Name', index: 'PCRC', width: 100, sortable: true },
                    { name: 'LastName', width: 100, sortable: true },
                    { name: 'Qty', width: 100, sortable: true },
                    { name: 'Yold', width: 100, sortable: true },
                    { name: 'Address', width: 100, sortable: true }

                ],
            rowNum: 10,
            rowList: [10, 20, 30],
            pager: '#GridPager',
            sortname: 'Name',
            viewrecords: true,
            sortorder: 'asc',
            caption: 'Test Grid'
        });

        $("#Grid").jqGrid('navGrid', '#GridPager', { edit: false, add: false, del: false });
    });
});
</script> 
```

网格根本不显示。

```
 <table id="Grid" ></table>
<div id="GridPager"></div> 
```

你看到我可能遗漏的东西了吗？提前致谢。

**更新**

版本：jquery-1.8.2.js 奥列格：没有服务。

这是我用于可变数据的 jsonstring 示例。

```
var data =  {"Tables":[{"Rows":[{"Name":"Alex","LastName":"Grey","Qty":3,"Yold":20,"Address":"27 rd"},{"Name":"Sebastian","LastName":"Wallace","Qty":78,"Yold":27,"Address":"33 xx"},{"Name":"Rose","LastName":"Garner","Qty":1,"Yold":33,"Address":"1111 rtd."},{"Name":"Carole","LastName":"Stewart","Qty":45,"Yold":18,"Address":"122 dr."}]}]};       
        $("#GridCantidadPendientes").jqGrid({
            datatype: 'jsonstring',
            datastr: data,
            //and so on 
```

如前所述，为网格提供的数据来自 DataSet。我将数据集解析为 jsonstring，但如果为了使网格工作，我需要构建 JSON 对象而不是字符串，我可以这样做。但据我尝试，我无法使网格正常工作。再次感谢。

**更新 2。**

经过几次更正后，网格现在已启动。但它是空白的。无法从后面的代码或 js 变量中获取数据。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T15:32:32.913

在您的更新中，`data`不是 JSON 字符串，它只是一个变量。您可能想`datatype: local`改用。

数据也没有按照 jqGrid 期望的方式格式化。您需要修复格式或编写自定义`jsonReader`（或`localReader`）函数。查看[有关检索数据的文档以获取](http://www.trirand.com/jqgridwiki/doku.php?id=wiki%3aretrieving_data#json_data)详细信息。

# math - 您可以从 n 长度的唯一字符列表中生成多少 m 长度的唯一字符串

> ID：15952237
> 
> 赞同：-2
> 
> 时间：2013-04-11T15:02:06.020
> 
> 标签：math

想象一个长度为 n 的字符列表，没有重复的字符。使用数学公式，您如何找到可以从该字符列表中生成的唯一 m 长度字符串的数量？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T15:46:44.407

这是一个[排列](http://en.wikipedia.org/wiki/Permutation)：`n!/((n - m)!)`- 不同的顺序，没有重复。

`(n * (n - 1) * (n - 2) * ... * 1)`除以`((n - m) * (n - m - 1) * (n - m - 2) * ... * 1)`。' **!** ' 是[阶乘](http://en.wikipedia.org/wiki/Factorial)符号。

# excel - 将特定文本文件复制到特定单元格

> ID：15952238
> 
> 赞同：0
> 
> 时间：2013-04-11T15:02:11.163
> 
> 标签：excel, vba

我正在处理 .txt 文件，我想将某些特定数据复制到我的 Excel 工作表中。我是使用 VBA 编程的新手。

文件里面有：

```
METAR LPAZ 012300Z 27003KT 9999 FEW020 13/09 Q1008=
 METAR LPAZ 012200Z 24008KT 7000 FEW025 14/09 Q1009=
 METAR LPAZ 012100Z 26005KT 9999 FEW026 14/09 Q1008=
```

但我只想在工作表上添加特定信息，例如：

21 260 05 9999 026（012100 的 21、26005KT 的 260、26005KT 的 05、FEW026 的 026）
22 240 08 7000 025
23 270 03 9999 020

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T15:51:12.813

导入您的文本文件（数据 > 获取外部数据 - 从文本）并使用固定宽度集解析，如下所示：

![SO15952238 示例](https://i.stack.imgur.com/M3MFr.gif)

然后对 AZ 进行排序。

如果您希望每行 5 个值（假设从 开始`A1`）在同一个单元格中使用空格分隔`=A1&" "&B1&" "&C1&" "&D1&" "&E1`（省略所有`&" "`如果不是空格分隔的）。

请注意，对于那些以 开头的元素，导入格式必须是文本`0`。

# php - 如何计算列中的相似词

> ID：15952239
> 
> 赞同：0
> 
> 时间：2013-04-11T15:02:14.170
> 
> 标签：php, csv

我有 CSV 文件，想计算一列 9000 行中的重复单词。

> 文件的例子
> 谢谢
> 好的
> 好的
> 谢谢
> 好的
> 谢谢

所需的结果将类似于

> 谢谢=3，好的=1，不错=2。

我找到了以下 PHP 代码，但我无法让它工作，并将 CSV 文件的内容复制到`file.txt`我做错了什么吗？

```
<?php
$file = (''C:\Users\wnmb4793\Desktop\Test\file.txt'');

$fh = fopen($file, 'rb');

$tag = array();
while($col = fgetcsv($fh)) {

if (isset($tag[$col[2]])) {
$tag[$col[2]]++;
}
else {
$tag[$col[2]] = 1;
}
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T15:06:26.000

First problem I can see is:

```
 $file = (''C:\Users\wnmb4793\Desktop\Test\file.txt''); 
```

Should be

```
 $file = ('C:\Users\wnmb4793\Desktop\Test\file.txt'); 
```

**The next step**

You need to loop through each word in the file. Something like:

```
while we are not at the end of the file.
     if( we have seen this word before ) // Think about the isset() method.
         find it's entry and add one to it's value
     else
         add a new entry, and set it's value to 1.
end while 
```

I've given you the pseudo-code. Now turn it into PHP! :)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-11T15:12:23.590

只是几个错误。您的代码有效。

```
$file = 'C:\Users\wnmb4793\Desktop\Test\file.txt';

$fh = fopen($file, 'rb');

$tag = array();
while($col = fgetcsv($fh)) 
{
  $value = $col[0]; // change 0 to column number you need, 0 - first 
  if ( isset($tag[$value]) ) 
    $tag[$value]++;
    else 
    $tag[$value] = 1;
}

print_r($tag); 
```

结果：

```
Array
(
    [thanks] => 3
    [ok] => 1
    [nice] => 2
) 
```

# asp.net-mvc - 你如何覆盖 Html.ActionLink？

> ID：15952240
> 
> 赞同：5
> 
> 时间：2013-04-11T15:02:24.600
> 
> 标签：asp.net-mvc

通常我会想用数据库中的内容渲染一个 ActionLink（想象一个 Id/Name 组合），所以我会在我的视图中添加以下内容：

```
 @foreach (var row in Model)
        {
            <li>@Html.ActionLink(row.Name, "Action", "Controller", new { id = row.Id })</li>
        } 
```

但是，如果 Name 为空字符串，则会引发异常。有什么办法可以防止这种情况。我想覆盖 ActionLink，但它是一个扩展，所以我无法覆盖。

有什么建议么？

**编辑：**

首先，我不控制数据，否则我会确保 Name 字段是必需的并且始终填充。不幸的是，这种情况并非如此。

其次，我意识到用户将没有什么可以点击的，但我相信呈现一个空链接比给他们一个 YSOD 更好的选择。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-11T15:31:19.180

事实证明，实例方法总是优于具有相同签名的扩展方法。

我能够加载 CustomHtmlHelper 并将实例方法 ActionLink 方法放入新类中：

```
public abstract class CustomWebViewPage<T> : WebViewPage<T>
{
    public new CustomHtmlHelper<T> Html { get; set; }

    public override void InitHelpers()
    {
        Ajax = new AjaxHelper<T>(ViewContext, this);
        Url = new UrlHelper(ViewContext.RequestContext);

        //Load Custom Html Helper instead of Default
        Html = new CustomHtmlHelper<T>(ViewContext, this);
    }
} 
```

并且 HtmlHelper 如下（从 Reflector 复制的 ActionLink 方法没有 LinkText 错误检查：

```
public class CustomHtmlHelper<T> : HtmlHelper<T>
{
    public CustomHtmlHelper(ViewContext viewContext, IViewDataContainer viewDataContainer) :
        base(viewContext, viewDataContainer)
    {
    }

    //Instance methods will always be called instead of extension methods when both exist with the same signature...

    public MvcHtmlString ActionLink(string linkText, string actionName)
    {
        return ActionLink(linkText, actionName, null, new RouteValueDictionary(), new RouteValueDictionary());
    }

    public MvcHtmlString ActionLink(string linkText, string actionName, object routeValues)
    {
        return ActionLink(linkText, actionName, null, new RouteValueDictionary(routeValues), new RouteValueDictionary());
    }

    public MvcHtmlString ActionLink(string linkText, string actionName, string controllerName)
    {
        return ActionLink(linkText, actionName, controllerName, new RouteValueDictionary(), new RouteValueDictionary());
    }

    public MvcHtmlString ActionLink(string linkText, string actionName, RouteValueDictionary routeValues)
    {
        return ActionLink(linkText, actionName, null, routeValues, new RouteValueDictionary());
    }

    public MvcHtmlString ActionLink(string linkText, string actionName, object routeValues, object htmlAttributes)
    {
        return ActionLink(linkText, actionName, null, new RouteValueDictionary(routeValues), AnonymousObjectToHtmlAttributes(htmlAttributes));
    }

    public MvcHtmlString ActionLink(string linkText, string actionName, RouteValueDictionary routeValues, IDictionary<string, object> htmlAttributes)
    {
        return ActionLink(linkText, actionName, null, routeValues, htmlAttributes);
    }

    public MvcHtmlString ActionLink(string linkText, string actionName, string controllerName, object routeValues, object htmlAttributes)
    {
        return ActionLink(linkText, actionName, controllerName, new RouteValueDictionary(routeValues), AnonymousObjectToHtmlAttributes(htmlAttributes));
    }

    public MvcHtmlString ActionLink(string linkText, string actionName, string controllerName, RouteValueDictionary routeValues, IDictionary<string, object> htmlAttributes)
    {
        return MvcHtmlString.Create(GenerateLink(ViewContext.RequestContext, RouteCollection, linkText, null, actionName, controllerName, routeValues, htmlAttributes));
    }

    public MvcHtmlString ActionLink(string linkText, string actionName, string controllerName, string protocol, string hostName, string fragment, object routeValues, object htmlAttributes)
    {
        return ActionLink(linkText, actionName, controllerName, protocol, hostName, fragment, new RouteValueDictionary(routeValues), AnonymousObjectToHtmlAttributes(htmlAttributes));
    }

    public MvcHtmlString ActionLink(string linkText, string actionName, string controllerName, string protocol, string hostName, string fragment, RouteValueDictionary routeValues, IDictionary<string, object> htmlAttributes)
    {
        return MvcHtmlString.Create(GenerateLink(ViewContext.RequestContext, RouteCollection, linkText, null, actionName, controllerName, protocol, hostName, fragment, routeValues, htmlAttributes));
    }
} 
```

最后，在文件中设置 pageBaseType`Views/Web.config`以使用新的自定义 WebViewPage：

```
 <system.web.webPages.razor>
    ...
    <pages pageBaseType="Fully.Qualified.Namespace.CustomWebViewPage">
    ...
    </pages>
  </system.web.webPages.razor> 
```

希望这对其他人有帮助。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-11T15:06:19.973

The issue you are going to have is if the name is blank, there is nothing to click on for the user in the UI. Example: `<a href="someUrl"></a>` gives no clickable object.

What may be better is if you could provide a default "No Name" string to those rows that have an empty string.

```
@foreach (var row in Model)
        {
            <li>@Html.ActionLink(string.isNullOrEmpty(row.Name) ? "No Name" : row.Name, "Action", "Controller", new { id = row.Id })</li>
        } 
```

**EDIT**

If you do not want to put a condition in every @Html.ActionLink, you can create your own @Html.Helper

```
 public static IHtmlString ActionLinkCheckNull(this HtmlHelper htmlHelper, string linkText, string action, string controller, object routeValues, object htmlAttributes)
        {
            var urlHelper = new UrlHelper(htmlHelper.ViewContext.RequestContext);
            var anchor = new TagBuilder("a") { InnerHtml = string.IsNullOrEmpty(linkText) ? "No Name", linktext };
            anchor.Attributes["href"] = urlHelper.Action(action, controller, routeValues);
            anchor.MergeAttributes(new RouteValueDictionary(htmlAttributes));
            return MvcHtmlString.Create(anchor.ToString());
        } 
```

Then in your Views folder web.config, add a reference to the namespace that you place this extension so you don't have to have a using statement at the top of every view. Example:

```
<add namespace="Core.Extensions"/> 
```

Then in your views, use

```
 @Html.ActionLinkCheckNull(row.Name, "Action", "Controller", new { id = row.Id }) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-11T15:11:37.350

为了更具体地说明 Tommy 的意思，我想包含受保护的最终调用方法：

```
private static string GenerateLinkInternal(RequestContext requestContext, RouteCollection routeCollection, string linkText, string routeName, string actionName, string controllerName, string protocol, string hostName, string fragment, RouteValueDictionary routeValues, IDictionary<string, object> htmlAttributes, bool includeImplicitMvcValues)
{
    string value = UrlHelper.GenerateUrl(routeName, actionName, controllerName, protocol, hostName, fragment, routeValues, routeCollection, requestContext, includeImplicitMvcValues);
    TagBuilder tagBuilder = new TagBuilder("a")
    {
        InnerHtml = (!string.IsNullOrEmpty(linkText)) ? HttpUtility.HtmlEncode(linkText) : string.Empty
    };
    tagBuilder.MergeAttributes<string, object>(htmlAttributes);
    tagBuilder.MergeAttribute("href", value);
    return tagBuilder.ToString(TagRenderMode.Normal);
} 
```

因此，由于您正在构建链接，因此外部方法会引发异常，因为**它不会在屏幕上显示任何文本。**该代码如下所示：

```
public static MvcHtmlString ActionLink(this HtmlHelper htmlHelper, string linkText, string actionName, string controllerName, RouteValueDictionary routeValues, IDictionary<string, object> htmlAttributes)
{
    if (string.IsNullOrEmpty(linkText))
    {
        throw new ArgumentException(MvcResources.Common_NullOrEmpty, "linkText");
    }
    return MvcHtmlString.Create(HtmlHelper.GenerateLink(htmlHelper.ViewContext.RequestContext, htmlHelper.RouteCollection, linkText, null, actionName, controllerName, routeValues, htmlAttributes));
} 
```

从技术上讲，代码不必**受到**保护，但它是一种*特性*。

* * *

这是适合您的解决方法，但您需要`ActionLink`像这样构建自己的扩展方法并将其放在项目中某处的代码文件中：

```
using System;
using System.Collections.Generic;
using System.Web.Mvc.Resources;
using System.Web.Routing;
namespace System.Web.Mvc.Html
{
    public static class MyLinkExtensions
    {
        public static MvcHtmlString ActionLink(this HtmlHelper htmlHelper, string linkText, string actionName, string controllerName, int identifier)
        {
            return htmlHelper.ActionLink(string.IsNullOrEmpty(linkText) ? "some default text" : linkText, actionName, controllerName, new { id = identifier });
        }
    }
} 
```

所以现在你的标记看起来像这样：

```
@foreach (var row in Model)
{
    <li>@Html.ActionLink(row.Name, "Action", "Controller", row.Id)</li>
} 
```

并且您已经封装了 turnary 以确定状态，`linkText`但仍然在一行中呈现您的链接。

# java - GWT，列表处理程序 > columnSortHandler 没有正确排序

> ID：15952241
> 
> 赞同：0
> 
> 时间：2013-04-11T15:02:28.687
> 
> 标签：java, gwt, sorting, celltable

我得到了这些代码：

```
 ListHandler<List<String>> columnSortHandler = new ListHandler<List<String>>(
                    list);
            columnSortHandler.setComparator(nameColumn,
                    new Comparator<List<String>>() {
                      public int compare(List<String> o1, List<String> o2) {
                        if (o1 == o2) {
                          return 0;
                        }

                        // Compare the name columns.
                        if (o1 != null) {
                          return (o2 != null) ? o1.get(0).compareTo(o2.get(0)) : 1;
                        }
                        return -1;
                      }
                    });

                table.addColumnSortHandler(columnSortHandler); 
```

当排序列包含 iPhone 1、iPhone 2、iPhone 3... 时，它会正确排序，即 iPhone 1、iPhone 2、iPhone 3 用于升序和 iPhone 3、iPhone 2、iPhone 1 用于降序

但是当排序列包含：

1.92 MP
3.15 MP AF 0.31 MP
3.2 MP
5 MP AF 和闪光灯
1.3 MP
1.3 MP
2 MP（后置）；0.3 MP（前）
1.92 MP AF 带闪光灯（后）

它没有遵循正确的顺序，甚至没有将 2 个“1.3 MP”单元并排放置。上述列表的正确顺序应该是：
1.3 MP
1.3 MP
1.92 MP
1.92 MP AF 带闪光灯（后置）
2 MP（后置）；0.3 MP（正面）
3.15 MP AF 0.31 MP
3.2 MP
5 MP AF 和闪光灯

上面的代码有什么问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T15:31:40.987

正如网站的作者所说，它`java sorting algorithm`是基于 .`ASCII`它永远不会像人类想象的那样工作。:) 粗鲁但事实。

**人们对带有数字的字符串进行排序的方式与软件不同。**

使用[Alphanum 算法](http://www.davekoelle.com/alphanum.html)

在上面的链接中[下载](http://www.davekoelle.com/alphanum.html) `AlphanumComparator.java`并使用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T17:29:40.647

我也`o1.get(0).compareTo(o2.get(0))==0`按照 Any King 的建议添加到代码中，但排序仍然非常混乱。

```
ListHandler<List<String>> columnSortHandler = new ListHandler<List<String>>(
                list);
        columnSortHandler.setComparator(nameColumn,
                new Comparator<List<String>>() {
                  public int compare(List<String> o1, List<String> o2) {
                    if (o1.get(0).compareTo(o2.get(0))==0) {
                      return 0;
                    }

                    // Compare the name columns.
                    if (o1 != null) {
                      return (o2 != null) ? o1.get(0).compareTo(o2.get(0)) : 1;
                    }
                    return -1;
                  }
                });

            table.addColumnSortHandler(columnSortHandler); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-11T17:54:42.263

我认为问题是

```
ListHandler<List<String>> 
```

而不是 java 排序算法，请查看 Gwt 示例[http://gwt.googleusercontent.com/samples/Showcase/Showcase.html#!CwCellTable](http://gwt.googleusercontent.com/samples/Showcase/Showcase.html#!CwCellTable)，它对地址进行了精美的排序，并且代码使用非常简单的比较。查看用于排序地址的示例 gwt 代码

```
 addressColumn.setSortable(true);
addressColumn.setDefaultSortAscending(false);
sortHandler.setComparator(addressColumn, new Comparator<ContactInfo>() {
  @Override
  public int compare(ContactInfo o1, ContactInfo o2) {
    return o1.getAddress().compareTo(o2.getAddress());
  }
}); 
```

# list - 在Scala中的任意嵌套列表中“替换”与谓词匹配的元素

> ID：15952244
> 
> 赞同：1
> 
> 时间：2013-04-11T15:02:34.540
> 
> 标签：list, scala, recursion, nested, tail-recursion

我有以下列表（只是一个例子 - 列表可以是任意深度）；

```
val foo = List(1, List(2, List(3, 4)), List(5, List(6, List(7, List(8,9,10))))) 
```

我想遍历列表，并用谓词中的某个值“替换”和元素。大意是什么

```
map(case 4 => 42 case x => x) 
```

我希望它产生一个如下所示的新列表；

```
List(1, List(2, List(3, 42)), List(5, List(6, List(7,List(8,9,10))))) 
```

我正在尝试通过下面的递归函数来做到这一点；

```
def copyListReplace(tree: List[Any], p: Any => Any): List[Any] = {
  tree.map(x =>
    x match {
      case y: List[Any] => copyList(y.tail, p)
      case t => p(t)
    }
  )
} 
```

但我没有得到想要的结果；

```
scala>println(copyListReplace(foo, (x => x match{ case 4 => 42 case _ => t})))    
List(1, List(List(42)), List(List(7))) 
```

在此先感谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T15:08:49.903

您必须`y.tail`从递归函数中删除并使用`y`（映射整个嵌套列表 - 不要跳过第一个元素）。

```
def copyListReplace(tree: List[Any], p: Any => Any): List[Any] = {
  tree.map(x =>
    x match {
      case y: List[Any] => copyListReplace(y, p)
      case t => p(t)
    }
  )
} 
```

# android - 将 JSON 解析为 Android 应用程序

> ID：15952245
> 
> 赞同：-2
> 
> 时间：2013-04-11T15:02:40.233
> 
> 标签：android, json, parsing

那是我的 JSON，我必须解析它并在应用程序中显示它

```
{
"idUsuario":20,
"nomeUsuario":"Barbara Trzaskos",
"CPF":"978824029-15",
"email":"barbaratrzaskos@ufpr.br",
"sigla":"BTR",
"senha":"safira",
"instuicao":"Universidade Federal do Paraná",
"listaDePontos":[
{
"idPonto":"BTR0001",
"pontoNome":"BTR-0001",
"dtCampo":"2011-04-29T00:00:00",
"projeto":2,
"UTMEste":547276.0,
"UTMNorte":7285137.0,
"UTMFuso":22,
"UTMHemisferio":"S",
"latDec":-24.5469,
"longDec":-50.5332,
"altitude":0,
"descPonto":"Arenito mal selecionado. Apresenta fina banda de deformação, como um suave ressalto no relevo e coloração mais clara. Exibe plano subvertical com padrão anastomosado e cinemática aparente sinistral",
"complement":"Coleta de amostra orientada.",
"analiseCampo":{
"nomeEstrutura":"-",
"idAnCampo":"BTR0001",
"descEstrutura":"",
"ehBrunton":true,
"analiseEstruturais":[
{
"idEstrutura":"BTR0001001",
"ordem":0,
"tipo":"Plano",
"codigo":"F",
"brunton":"N42W/86SW",
"clar":"228/86",
"azimute":"228",
"direcao":"42",
"quadrante":"SW",
"sentido":"Sinistral",
"descricao":"",
"mergulho":"86",
"familia":""
}
]
},
"arquivos":[
],
"idUnigadeGeologica":[
{
"idUnidade":816
},
{
"idUnidade":2295
}
]
}
]
} 
```

我该如何编译它？因为这在数组和其他东西中有数组，我不知道该怎么做。对不起，代码是葡萄牙语，但我没有时间翻译。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T15:08:31.417

首先用您的 JSON 字符串构造一个 JSON 对象：

```
JSONObject jObject = new JSONObject(JSONString); 
```

然后你可以使用它从中获取一个字段

```
jObject.getString("nomeUsuario"); 
```

如果你想得到一个数组使用

```
JSONArray jArr = new JSONArray(jObject.getString("listaDePontos")); 
```

然后以这种方式遍历数组

```
for (int i = 0; i < jArr.length(); i++) {
    JSONObject temp = jArr.getJSONObject(i);
    //get everything from 'temp' here just like above

} 
```

# sql - 涉及外键的 SQL 查询

> ID：15952246
> 
> 赞同：0
> 
> 时间：2013-04-11T15:02:44.250
> 
> 标签：sql, count, foreign-keys

我正在阅读[http://www.w3schools.com/sql/sql_foreignkey.asp](http://www.w3schools.com/sql/sql_foreignkey.asp)上的 SQL 教程，并且想知道如果我们有多个表引用相同的主键，将如何构造查询。例如，在上述链接中，如果我们有一个 Orders2、Orders3 和 Orders4 表，它们都具有相似的功能（表“Orders”），它们有一个名为 P_Id 的列。

如何创建一个查询，列出客户在“Orders”、“Orders2”、“Orders3”和“Orders4”表中列出的次数以及相应的客户姓名？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-11T15:06:40.243

使用 LEFT JOIN 连接每个表，以防在其中一些表中不存在该人的订单：

```
SELECT p.P_Id, p.LastName, p.FirstName, 
       COUNT(a.P_Id) AS OrdersCount, 
       COUNT(b.P_Id) AS Orders2Count, 
       COUNT(c.P_Id) AS Orders3Count, 
       COUNT(d.P_Id) AS Orders4Count
FROM Persons p
LEFT JOIN Orders a ON p.P_Id = a.P_Id
LEFT JOIN Orders2 b ON p.P_Id = b.P_Id
LEFT JOIN Orders3 c ON p.P_Id = c.P_Id
LEFT JOIN Orders4 d ON p.P_Id = d.P_Id
GROUP BY p.P_Id, p.LastName, p.FirstName 
```

# django - 在 Django 中保存 MultipleChoiceField

> ID：15952249
> 
> 赞同：2
> 
> 时间：2013-04-11T15:03:00.247
> 
> 标签：django, save, multiple-choice

我正在尝试在 Django 中保存一个 MultipleChoiceField。模型.py

```
choices_for_field  = 
    (('A','A'),
     ('B','B'),
     ('C','C'),
     ('D','D'),)

class names(models.Model):
    c_name = models.CharField(max_length=50, null=False, blank=False, choices=choices_for_field)

class formForm(ModelForm):    
    c_name = forms.MultipleChoiceField(label='alphabets', choices=choices_for_field, widget=CheckboxSelectMultiple) 
```

当我保存它时，我收到一个错误，即“不是有效的选择”。我不知道我哪里错了。我已经检查了与此相关的所有其他问题。但没有什么对我有用。有谁能够帮我。

视图.py

```
bf = formForm(request.POST)
    if bf.is_valid():
        temp = bf.save(commit=False)
        temp.stud_user_id = userid
        temp.save() 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-11T15:35:34.433

您不能将多项选择字段保存到 CharField。CharField 是单个元素。MulitpleChoiceField 是多个。

我怀疑您想要做的是将一系列选择连接到 CharField 中的单个（逗号分隔？）值。您可以使用标准的forms.TextField（使用MultipleChoiceWidget）和执行连接的自定义clean 方法来做到这一点，但是您需要从目标CharField 中删除choices 属性。

# c# - 带有 FormClosingEventArgs 的 EventHandler

> ID：15952256
> 
> 赞同：1
> 
> 时间：2013-04-11T15:03:25.190
> 
> 标签：c#, forms, events, eventargs

我的 Form.cs 中有这个结束表单代码

```
 public void label7_Click(object sender, FormClosingEventArgs e)
    {
        MessageBox.Show("Are you sure you want to exit?", "Confirmation", MessageBoxButtons.YesNo, MessageBoxIcon.Question);
        if (MessageBox.Show("Are you sure you want to exit?", "Confirmation", MessageBoxButtons.YesNo, MessageBoxIcon.Question) == DialogResult.No)
        {
            e.Cancel = true;
        }
        else { 
            Application.Exit(); 
        }
    } 
```

以及我的 Form.designer.cs 中的这段代码

```
 this.label7.Click += new System.EventHandler(this.label7_Click); 
```

但是它一直显示错误“'label7_Click'没有重载匹配委托'System.EventHandler'”

我应该怎么办？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T15:44:19.137

你的代码有点混乱。用户想退出应用时点击label7？您订阅的 Click 事件在引发时不提供 FormClosingEventArgs。Click 是一个 EventHandler 事件，这意味着它在引发时会提供一个 EventArgs 对象。EventArgs 类中没有 Cancel 属性。

当用户单击 label7 时，您似乎想显示一个 MessageBox。MessageBox 将询问用户，“您确定要退出吗？”，如果用户单击“是”，则应用程序将关闭。如果是这样，请尝试：

```
private void label7_Click(object sender, EventArgs e)
{
    var result = MessageBox.Show("Are you sure you want to exit?", "Confirmation", MessageBoxButtons.YesNo, MessageBoxIcon.Question);
    if (result == DialogResult.Yes)
    {
       Application.Exit();
    }
}

label7.Click += label7_Click; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T15:13:10.733

似乎`label7_Click`方法不存在

```
 this.label7.Click += new System.EventHandler(this.label7_Click);

    void label7_Click(object sender, EventArgs e)
    {

    if (MessageBox.Show("Are you sure you want to exit?", "Confirmation", MessageBoxButtons.YesNo, MessageBoxIcon.Question) == DialogResult.No)
    {
        //
    }
    else { 
        Application.Exit(); 
    }
    } 
```

`No overload for 'label7_Click' matches delegate`

```
public void label7_Click(object sender, FormClosingEventArgs e)//this method de is incorrect 
```

# excel - Excel Web 查询中的参数

> ID：15952257
> 
> 赞同：1
> 
> 时间：2013-04-11T15:03:27.310
> 
> 标签：excel, web, parameters

我正在尝试从网络导入数据，它适用于静态 URL。URL 如下所示：[http://www.foo.com/api/v0.9/csv/items/3/1](http://www.foo.com/api/v0.9/csv/items/3/1) 最后一个数字（此处为“1”）控制页数。由于总共大约有 200 页，我宁愿不重新制作 200 个静态查询，所以我的问题是如何参数化它？

我搜索了互联网，唯一的解决方案是我发现它更改了类似[http://www.foo.com/api/v0.9/json/items/3.html?page=1](http://www.foo.com/api/v0.9/json/items/3.html?page=1)的 URL 但我的 URL 只是工作方式不同，因此解决方案不适用。

谁能告诉我如何在我的情况下对其进行参数化或为我指明正确的方向？

感谢您的时间

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T17:52:04.733

您可以更改 QueryTable.Connection 属性以指向不同的 URL。这是一个例子

```
Dim i As Long
Dim qt As QueryTable

For i = 1 To 200
    Set qt = Sheet1.QueryTables(1)
    qt.Connection = "URL;http://www.foo.com/api/v0.9/csv/" & i
    qt.Refresh False

    'Do some stuff with the data
Next i 
```

# java - CodeModel 如何添加 @Pattern.List 注释 com.sun.codemodel

> ID：15952259
> 
> 赞同：1
> 
> 时间：2013-04-11T15:03:30.347
> 
> 标签：java, bean-validation, sun-codemodel

我正在使用 com.sun.codemodel 生成我的类并添加 JSR303 注释。这工作正常，除非我想添加 @Pattern.List 注释。

```
field.annotate(Pattern.class).param("regexp", "some_expression"); 
```

这是当前生成的：

```
@Pattern(regexp = "first_expression", message = "first.Pattern.message")
@Pattern(regexp = "second_expression", message = "second.Pattern.message")
@Pattern(regexp = "third_expression", message = "third.Pattern.message") 
```

这就是我想要生成的

```
@Pattern.List({
  @Pattern(regexp = "first_expression", message = "first.Pattern.message")
  @Pattern(regexp = "second_expression", message = "second.Pattern.message")
  @Pattern(regexp = "third_expression", message = "third.Pattern.message")
}) 
```

有人知道这是怎么做到的吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-11T17:22:25.170

假设您想要 @PatternList(list = {@Pattern...}) 而不是您需要使用该`paramArray()`方法：

```
JDefinedClass testme = codeModel._class("Testme");

JAnnotationUse patternListAnnotation = testme.annotate(Pattern.List.class);
JAnnotationArrayMember list = patternListAnnotation.paramArray("value");

list.annotate(Pattern.class).param("regexp", "first_expression").param("message", "first.Pattern.message");
list.annotate(Pattern.class).param("regexp", "second_expression").param("message", "second.Pattern.message");
list.annotate(Pattern.class).param("regexp", "third_expression").param("message", "third.Pattern.message"); 
```

输出以下内容：

```
@Pattern.List({
    @Pattern(regexp = "first_expression", message = "first.Pattern.message"),
    @Pattern(regexp = "second_expression", message = "second.Pattern.message"),
    @Pattern(regexp = "third_expression", message = "third.Pattern.message")
})
public class Testme {
} 
```

这应该与示例代码中提示的字段相同。

# postgresql - 根据字段值决定调用哪个过程

> ID：15952261
> 
> 赞同：0
> 
> 时间：2013-04-11T15:03:34.333
> 
> 标签：postgresql, stored-procedures, postgresql-9.2

我的 PostgreSQL 9.2 DB 中有大约 20 个（并且还会有更多）特定存储过程。它们用于进行一些计算，一些财务“报告”（不幸的是，我不能只将数据存储在表格中并在程序代码中实现算法）。

过程彼此非常不同，它们在不同的表、列上运行，实现不同的算法等。

每个过程都返回相同的数据类型（数值）。

现在，我的客户想要创建功能，用户可以在其中选择特定的过程（或它们的组合，例如过程 1 返回值的 10% + 过程 2 返回值的 90%），并将其用作“基础”后期建模。他还希望我的用户以后能够更改他的选择，而无需每次都调用程序员。;-)

我想过制作一些表格：

```
Table: base_models
id <PK>,
user_id, <FK from users table>
model_name (varchar, or sth.)

Table: base_models_algorithms
base_model_id <FK from base_models>
algorithm_id <FK from algorithms>
percent_value (percent value of specific algorithm in model, eg. 10) 
```

...然后，我还需要将我的算法名称（= 存储过程）存储在某个表中：

```
Table: algorithms
name: (stored procedure name, varchar?) 
```

...这就是问题所在。

当然，我稍后可以创建一些视图，其中包含由另一个过程计算的列（model_current_value :-)），并根据存储在我的算法表中的名称决定调用哪个过程，但这对我来说看起来很糟糕。:(

将没有数据控制（您可以向算法表中写入任何内容，并且无法确保该字符串是过程名称，返回正确的数据类型等）。

当然我可以自己填表，不会让任何人改变它的数据:-)

但也许有更优雅的方式来完成整个事情？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T01:40:42.357

听起来您想要 PL/PgSQL`EXECUTE`语句。您可以使用它来调用动态 SQL，例如对于具有动态名称的 2 参数过程：

```
EXECUTE format('SELECT %I($1,$2)', func_name) USING arg1, arg2; 
```

这是一个 PL/PgSQL 语句。它在常规 SQL 中不可用。您当然可以创建一个简单的 PL/PgSQL 过程来执行此语句并从 SQL 中调用它。

# java - Selenium WebDriver manager().getCookies() 总是返回 0

> ID：15952262
> 
> 赞同：20
> 
> 时间：2013-04-11T15:03:35.250
> 
> 标签：java, cookies, selenium, selenium-webdriver

Selenium WebDriver **总是**`manager().getCookies()`返回 0个元素！PS 版本 2.32.0.0`InternetExplorerDriver`

 *** * *

## 回答 #1

> 赞同：13
> 
> 时间：2014-02-16T12:45:57.493

如果 cookie 是[HTTPOnly](http://www.codinghorror.com/blog/2008/08/protecting-your-cookies-httponly.html)，您无法从 Javascript/Selenium 读取它们

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2017-05-08T10:18:37.907

```
Set<Cookie> allcookies = driver.manage().getCookies();
System.out.println(allcookies); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2019-03-11T11:42:23.453

我不明白为什么`driver.manage().getCookies();`在 FF 和 IE 中总是返回大小为 0。

但我找到了这个解决方法，使用`executeScript`

```
Set<Cookie> cookies = driver.manage().getCookies();

if (cookies.size() == 0) { // To support FF and IE
    String cookiesString = (String) driver.executeScript("return document.cookie");
    cookies = parseBrowserCookies(cookiesString);
}

private Set<Cookie> parseBrowserCookies(String cookiesString) {
    Set<Cookie> cookies = new HashSet<>();

    if (StringUtils.isBlank(cookiesString)) {
        return cookies;
    }

    Arrays.asList(cookiesString.split("; ")).forEach(cookie -> {
        String[] splitCookie = cookie.split("=", 2);
        cookies.add(new Cookie(splitCookie[0], splitCookie[1], "/"));
    });

    return cookies;
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-09-10T12:24:04.780

您确定您的网络驱动程序位于您希望设置 cookie 的域上吗？ `getCookies`只返回当前域的 cookie。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-02-07T14:03:17.273

问题似乎与 64 位驱动程序有关。我尝试过使用 32 位驱动程序，它可以工作。如果使用 WebDriverManager，只需执行以下操作：

```
WebDriverManager.iedriver().arch32().setup(); 
```

另一件事可能相关（不太确定）是 Internet Explorer 11 在注册表级别的设置，请参阅[Selenium IE 驱动程序信息](https://github.com/SeleniumHQ/selenium/wiki/InternetExplorerDriver#required-configuration)：

> 仅对于 IE 11，您需要在目标计算机上设置一个注册表项，以便驱动程序可以保持与它创建的 Internet Explorer 实例的连接。对于 32 位 Windows 安装，您必须在注册表编辑器中检查的项是 HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Internet Explorer\Main\FeatureControl\FEATURE_BFCACHE。对于 64 位 Windows 安装，密钥是 HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Microsoft\Internet Explorer\Main\FeatureControl\FEATURE_BFCACHE。请注意，FEATURE_BFCACHE 子项可能存在也可能不存在，如果不存在，则应创建它。重要提示：在此键中，创建一个名为 iexplore.exe 且值为 0 的 DWORD 值。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-12T13:31:01.740

也许您需要先设置 cookie，AFAIK webdriver 总是从新会话开始。相反，您可以尝试像这样设置用户配置文件： [如何使 FirefoxDriver 使用现有配置文件？](https://stackoverflow.com/questions/7771592/how-to-make-firefoxdriver-use-existing-profile)

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2013-04-11T16:11:13.707

这是获取所有 cookie 的方法

```
allCookies = driver.manage().getCookies(); 
```**

# excel - 在另一个单元格中输入数据并按 Enter 选项后转到特定单元格

> ID：15952263
> 
> 赞同：6
> 
> 时间：2013-04-11T15:03:36.860
> 
> 标签：excel, vba

我有一张 Excel 表格，我在 A2、B2 和 C2 中输入数据；按回车后，我希望光标选择下一行，这样我就可以输入 A3、B3 和 C3 等信息

我找到了这个信息

```
Private Sub Worksheet_Change(ByVal Target As Excel.Range)
If Range("C2").Value <> "" Then
Range("A3").Select
End If
End Sub 
```

但它只能工作一次，我怎么能一遍又一遍地重复这个过程

谢谢你的帮助.....

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-11T16:08:02.013

另一种方式。

1.  如果您在 Col A 的任何位置键入，选择将移至 Col B。
2.  如果您在 Col B 的任何位置键入，则选择将移至 Col C。
3.  如果您在 Col C 中的任何位置键入，选择将移回 Col A（下一行）。

**代码**：这在相关的工作表代码区域中。

```
Private Sub Worksheet_Change(ByVal Target As Range)
    On Error GoTo Whoa

    Application.EnableEvents = False

    If Not Target.Cells.CountLarge > 1 Then
        If Not Intersect(Target, Columns(1)) Is Nothing Then
            Target.Offset(, 1).Select
        ElseIf Not Intersect(Target, Columns(2)) Is Nothing Then
            Target.Offset(, 1).Select
        ElseIf Not Intersect(Target, Columns(3)) Is Nothing Then
            Target.Offset(1, -2).Select
        End If
    End If
Letscontinue:
    Application.EnableEvents = True
    Exit Sub
Whoa:
    MsgBox Err.Description
    Resume Letscontinue
End Sub 
```

**截屏**

![在此处输入图像描述](https://i.stack.imgur.com/jdVb2.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-11T15:21:46.070

如果您需要涉及 VBA，则有分别设置方向和状态的属性：

```
Application.MoveAfterReturnDirection = xlToRight 
Application.MoveAfterReturn = True 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-11T15:10:48.520

**在您的工具>选项对话框中，输入后移动选择**的设置是什么？：

![在此处输入图像描述](https://i.stack.imgur.com/L0Nxv.png)

有关[Tech Republic 的更多信息：在数据输入期间控制 Excel 光标移动的三种方法](http://www.techrepublic.com/blog/msoffice/three-ways-to-control-excels-cursor-movement-during-data-entry/8292)将向您展示如何准确地执行您想要的操作...

基本上，选择要在其中输入数据的范围单元格，Excel 选择第一个单元格，然后在每个条目之后，按 {Tab} 键。*Excel 会将克拉移动到您选择的下一个空单元格*

瞧！

# file - 在 JBoss AS 7 上读取日志文件

> ID：15952266
> 
> 赞同：2
> 
> 时间：2013-04-11T15:03:48.330
> 
> 标签：file, logging, jboss, jboss7.x

我有一个在 JBoss AS 7 上运行的应用程序并在`/standalone/log`.

出于安全原因，我不允许浏览 JBoss 目录。是否有任何内置应用程序可以从浏览器读取这些日志文件？

注意：我也不能使用管理控制台。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T15:06:05.327

不，没有任何内置功能。您可以让管理员[配置日志记录服务](https://logging.apache.org/log4j/2.x/manual/configuration.html)以将日志放在您可以访问它们的位置，或者您可以配置记录器以捕获日志并发布到数据库或其他。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-07T05:00:22.203

还没有，但是有一些要求（我的一个，顺便说一句；-），它可能会出现在 WildFlz 8 中。希望如此。（如果您愿意，请为他们投票。）

*   [WFLY-1048](https://issues.jboss.org/browse/WFLY-1048)允许通过管理 API 连接到日志子系统
*   [WFLY-1144](https://issues.jboss.org/browse/WFLY-1144)提供通过 Web 界面查看服务器日志的能力
*   [WFLY-280](https://issues.jboss.org/browse/WFLY-280)提供从日志中检索最近 10 个错误的操作

在那之前，我建议让管理员允许访问那个特定的日志文件。

如果没有通过，您可以声明您的部署依赖于日志服务的模块 ( `Dependencies: ...`in `MANIFEST.MF`) 和 JVM 中的日志管理器。除非有一些额外的障碍，比如安全管理器等等。

# mysql - 错误 1054 子句与子查询加入 id 分组

> ID：15952268
> 
> 赞同：0
> 
> 时间：2013-04-11T15:03:52.910
> 
> 标签：mysql, sql, mysql-error-1054, mysql-5.5

得到这个查询：

```
select 
T.id_empresa, max(periodo) as ultimoPeriodo, ( 
                        select sum(monto) from cuotasindical.pagos
                        where id_empresa = T.id_empresa and periodo = max(T.periodo)
                       ) as ultimoMonto, 
min(periodo) as periodoAnterior, (
                  select sum(monto) from cuotasindical.pagos
                  where id_empresa = T.id_empresa and periodo = min(T.periodo)
                   ) as anteriorMonto
from 
  (
    select 
    P1.id_empresa, P1.periodo, sum(monto) as monto
    from cuotasindical.pagos P1
    where P1.id_empresa in (select id_empresa from cuotasindical.empresa where id_delegacion = 5)
    group by P1.id_empresa, P1.periodo
    having P1.periodo in (
                select * from (
                                select periodo
                                from cuotasindical.pagos  
                                where P1.id_empresa = id_empresa order by periodo desc limit 2
                            ) as L
               )
    and count(distinct P1.periodo) > 1
  ) T
group by id_empresa
having (abs(max(monto) - min(monto))*100/
                    (
                      select sum(monto) from cuotasindical.pagos T2
                      where T2.id_empresa = id_empresa and T2.periodo = max(periodo)
                    ) > 10); 
```

需要比较，对于每个 empresa，最后两个 pagos（按 periodo 排序），看看它们的差异是否大于或小于百分比（在本例中为 10）

我越来越

> 错误代码：1054。“where 子句”中的未知列“P1.id_empresa”

唯一具有该比较的 where 子句是具有限制的子查询

```
having P1.periodo in (
                select * from (
        select periodo
        from cuotasindical.pagos  
        where P1.id_empresa = id_empresa 
        order by periodo desc limit 2
        ) as L
               )
    and count(distinct P1.periodo) > 1 
```

双子查询是为了避免 IN 子句中的限制 2（在[此](https://stackoverflow.com/questions/7124418/mysql-subquery-limit)链接上获取）

为什么我会收到那个错误？我认为我可以在具有子句的子查询中加入 group by 之后（就像 where 子句）

还是我遗漏了一个错误？

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T15:55:35.127

问题是 mysql 在子查询中只有一个深层次的范围。

我也有子查询限制的问题，所以，我所做的是

```
 ..having P1.periodo in 
    (
       select max(periodo) as periodo
       from cuotasindical.pagos H
       where P1.id_empresa = id_empresa 
    ) OR
    P1.periodo in (
       select max(periodo) as periodo
       from cuotasindical.pagos H
       where P1.id_empresa = id_empresa and periodo != P1.periodo
    )
and count(distinct P1.periodo) > 1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T15:56:40.317

关于特定错误，id_empresa 实际上是 cuotasindical.pagos 中的一列吗？

如果不是，我认为优化器可能会感到困惑，因为having子句通过...“在（）中具有P1.periodo”具有组中某些内容的信息。P1.periodo也是一个group by。

据我了解，分组依据是针对非聚合的字段。where 用于非聚合的字段。

有一个奇怪的......“根据你聚合的内容过滤”>你没有聚合 P1.periodo，但如果这是错误消息有点欺骗的问题。

如果您的数据库支持，我会考虑调试和查看 CTE（公用表表达式）。（不确定最新的 MySQL）。

如果它不支持它，请尝试使用视图...您有相当多的代码都引用了相同的两个表。也许生成一个数据集然后根据需要连接它是一个好主意。我认为这会使事后过滤更容易。

凝灰岩告诉没有与数据库的实际连接，但可能是这样的。另外，我会为*所有内容*设置别名，因为它很难告诉哪些列在哪些表中......

```
with temp as ( 
/* Setup common table expression with basically all the info we need If your
 * DBMS doesn't support common table expressions (CTE's) then put this in a
 * view, or a temp table? */  
select 
    t1.id_empresa    as id_empresa    , 
    t1.periodo       as periodo       , 
    t2.id_delegacion as id_delegacion ,
    t2.monto         as monto
from 
    cuotasindical.pagos   as t1 inner join 
    cuotasindical.empresa as t2 on t1.id_empresa = t2.id_empresa and t2.id_delegacion = 5 
)
select 
    t1.id_empresa           as id_empresa   ,
    max(t1.ultimoPeriodo)   as ultimoPeriodo,
    min(t2.anteriorPeriodo) as anteriorPeriodo,
    sum(t3.ultimoMonto  )   as ultimoMonto , 
    sum(t4.anteriorMonto)   as anteriorMonto 
from 
    (select id_empresa, max(periodo)        as ultimoPeriodo   from temp) as t1 inner join 
    (select id_empresa, min(periodo)        as anteriorPeriodo from temp) as t2 on t1.id_empresa = t2.id_empresa inner join 
    (select id_empresa, periodo, sum(monto) as ultimoMonto     from temp) as t3 on t1.id_empresa = t3.id_empresa and t1.ultimoPeriodo = t3.periodo  inner join  
    (select id_empresa, periodo, sum(monto) as anteriorMonto   from temp) as t4 on t1.id_empresa = t4.id_empresa and t2.anteriorMonto = t4.periodo  inner join  
where 
    .....
group by 
    t1.id_empresa           
having 
    ..... 
```

# performance - 如何加快组合 ldap 查询？

> ID：15952270
> 
> 赞同：2
> 
> 时间：2013-04-11T15:03:58.697
> 
> 标签：performance, ldap, edirectory

此 ldap 查询是即时的：

```
"Find all groups which user1 is not member"
(&
    (objectclass=groupOfNames)
    (!(member=cn=user1))
) 
```

就像这个：

```
"Find these groups"
(&
    (objectclass=groupOfNames)
    (|(cn=group1) (cn=group2) (cn=group3) ...  )
) 
```

但是，像这样*组合它们*会导致几分钟的处理！

```
"From these groups, find all which the user1 is not a member"
(&
    (objectclass=groupOfNames)
    (!(member=cn=user1))
    (|(cn=group1) (cn=group2) (cn=group3) ...  )
) 
```

我不知道为什么 ldap 服务器在组合查询中阻塞。有什么想法可以做什么？

如果有帮助，服务器是 Novell eDirectory。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2017-07-14T12:30:51.987

奇怪的是需要几分钟才能得到结果。你有超过几百万个对象吗？

一种可能性可能是，搜索 1 仅在树的一个分区内查找，在另一个分区中搜索 2，然后两者结合起来显然会同时查看两者，这应该没问题，只要您询问的服务器至少读取这些分区上的副本。

另外，您能否尝试以下变体：

```
(&

  (&
    (objectclass=groupOfNames)(!(member=cn=user1))
  )

  (&
    (objectclass=groupOfNames)(|(cn=group1) (cn=group2) (cn=group3) ...  )
  )

) 
```

它应该为您提供最初查询的答案，但方式有点简单。

如果这没有帮助，您应该在查询的服务器上执行 ndstrace 并查看他对查询所做的确切操作。

简而言之：

1.  很明显：确保您的 NDS 是健康的（ndsrepair，TID 3564075 等等）
2.  检查两个查询是否在同一个分区中
3.  检查服务器是否至少有分区的只读副本
4.  尝试按照建议修改查询
5.  在查询时执行 ndstrace 以查看花费了这么长时间

# cocos2d-x - CocosBuilder 中自定义 CCTableViewCell 的 CCBMemberVariableAssigner 回调不起作用

> ID：15952273
> 
> 赞同：0
> 
> 时间：2013-04-11T15:04:03.447
> 
> 标签：cocos2d-x, cocosbuilder

我的目标是通过 CocosBuilder 设计一个 CCTableViewCell 并通过 CCBReader 加载它。

到目前为止我的步骤：

我在 cocosbuilder 中添加了一个新的非全屏 CCNode **TestCell.ccb**，将根的自定义类设置为`TestCell` 并添加了一个 CCSprite 作为根子级，同时将其*doc-root-var*设置为`bg`.

我的问题：在实现加载器`TestCellLoader` 以及 Cell之后，根本没有调用`TestCell`回调函数 。`TestCell::onAssignCCBMemberVariable`

我尝试了什么：到目前为止，使用 a`CCLayerLoader`而不是 a对我有用，这是我第一次使用 a所以也许我错过了一个关键点。`CCNodeLoader``CCNodeLoader`

谢谢你，曹！本

以下是代码：

**TestCellLoader.h**

```
#include <cocos2d.h>
#include "cocos-ext.h"

#include "TestCell.h"

using namespace cocos2d;
using namespace cocos2d::extension;

    class TestCellLoader : public CCNodeLoader
    {
    public:
        CCB_STATIC_NEW_AUTORELEASE_OBJECT_METHOD(TestCellLoader, create);

    protected:
        CCB_VIRTUAL_NEW_AUTORELEASE_CREATECCNODE_METHOD(TestCell);

        virtual CCNode* loadCCNode(CCNode *, CCBReader * pCCBReader);
    }; 
```

**TestCellLoader.cpp**

```
#include "TestCellLoader.h"

CCNode * TestCellLoader::loadCCNode(CCNode * pParent, CCBReader * pCCBReader)
{
    CCLOG("TestCell::loadCCNode");
    CCNode * ccNode = this->createCCNode(pParent, pCCBReader);
    return ccNode;
} 
```

**测试细胞.h**

```
class TestCell : public CCTableViewCell, public CCNodeLoaderListener, public CCBMemberVariableAssigner
    {
    public:
        TestCell();
        virtual ~TestCell();

        static TestCell *create();

        virtual bool init();
        virtual bool initWithBG(CCSprite* bg);

        static TestCell* cellWithBG(CCSprite* bg);

        // ccbuilder callbacks

        virtual bool onAssignCCBMemberVariable(cocos2d::CCObject * pTarget, const char * pMemberVariableName, cocos2d::CCNode * pNode);

        virtual void onNodeLoaded(cocos2d::CCNode * pNode, cocos2d::extension::CCNodeLoader * pNodeLoader);

    private:
        CC_PROPERTY(CCSprite*, bg, Bg);
    }; 
```

**测试细胞.m**

```
 #include "TestCell.h"

    using namespace cocos2d;
    using namespace cocos2d::extension;

        TestCell::TestCell(){}
        TestCell::~TestCell(){}

    #pragma mark creation

        TestCell* TestCell::create(){
            TestCell *pRet = new TestCell();
            pRet->init();
            pRet->autorelease();
            return pRet;
        }

        bool TestCell::init(){
            return true;
        }

        bool TestCell::initWithBG(CCSprite* bg){
            return true;
        }

        TestCell* TestCell::cellWithBG(CCSprite* bg){
            return new TestCell;
        }

    #pragma mark - synthesize

        void TestCell::setBg(cocos2d::CCSprite *sprite){
            this->bg = sprite;
        }

        CCSprite* TestCell::getBg(){
            return this->bg;
        }

    #pragma mark - ccbuilder callbacks

        void TestCell::onNodeLoaded(cocos2d::CCNode * pNode,  cocos2d::extension::CCNodeLoader * pNodeLoader)
        {
            CCLOG("TestCell::onNodeLoaded");
        }

         bool TestCell::onAssignCCBMemberVariable(CCObject* pTarget, const char* pMemberVariableName, CCNode* pNode)
         {
             CCLOG("TestCell::onAssignCCBMemberVariable %s", pMemberVariableName);
             return false;
         } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-27T12:33:18.827

我猜你使用 a`CCLayer`作为**TestCell.ccb**的*Root 对象类型*。因为当您创建一个新的 ccb 文件时，`CCLayer`它是默认选项。

这就是为什么你使用 a`CCLayerLoader`而不是`CCNodeLoader`工作的原因。

因此，将您的**TestCell.ccb**的*Root 对象类型*更改为`CCNode`，这可能有效。

# javascript - 缩放时保持建议框 div 相对于输入

> ID：15952275
> 
> 赞同：3
> 
> 时间：2013-04-11T15:04:10.427
> 
> 标签：javascript, jquery, html, css

我在表格中有这个表格，其中一个文本输入有一个建议框。当页面缩小到 90% 时，建议框 div 会向下和向右移动大约 6 个像素。缩放时有什么方法可以使 div 保持在相同的位置？谢谢。这是一个演示的[jsfiddle](http://jsfiddle.net/xLw4b/)

html:

```
table {
        border:1px solid grey;
      }

#box {
       border:1px solid red; 
       width:150px; 
       position:absolute; 
       top:35px; 
       left:41px; 
       background-color:white;
     }

<table>
  <tr>
    <td>one</td>
    <td><input></td>
  </tr><tr>
    <td>two</td>
    <td><input type = "button" id = "showBox" value = "click then zoom out"></td>
  </tr>
</table>

<div id = "box" style = "display:none;">
  <ul>
    <li>now zoom out</li>
  </ul>
</div> 
```

javascript:

```
$('#showBox').click(function(){
   $('#box').show();
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T21:59:41.197

我已经更新了你的[小提琴](http://jsfiddle.net/xLw4b/1/)

移动了相应的方框`<td>`。虽然还是有一些闪烁，但比以前好多了。希望它符合你的标准:)

# spring-mvc - Spring MVC 控制器自定义参数名称

> ID：15952279
> 
> 赞同：0
> 
> 时间：2013-04-11T15:04:25.870
> 
> 标签：spring-mvc, controller

我有一个 Spring MVC 控制器。我在方法中有 50 个参数。所有参数都有非常具体的名称，例如：**FOO[]**。我不想像这样在方法签名中写 50 个参数：

```
@RequestMapping(value = "/test", method = RequestMethod.POST)
@ResponseBody
public String test(
    @RequestParam(value = "FOO[]") String foo,
    @RequestParam(value = "BAR[]") String bar,
// Other 48 parameters
)
{
    return "test";
} 
```

我想将所有参数映射到一个对象上，我的意思是，我想用 getter/setter 编写一个简单的 bean 类，并像方法参数一样使用它。但是如何为我的类字段设置自定义名称？

例如：

```
class FooBar {
    @SomeAnnotation_for_binding_the_field_to_my_field_FOO[]
    private String foo;
    private String bar;
    // Other 48 fields
    // getters/setters
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T23:18:15.057

我知道注释有点酷，但要理性思考。您必须在代码中枚举所有映射。将 FOO[] 映射到 foo 没有任何隐含意义，它似乎超出了您的控制范围。只需将参数作为映射（您始终可以要求 Spring 为您提供所有参数的映射）并执行以下操作：

```
@RequestMapping
public String test(@RequestParam Map<String, Object> map) {
    MyObject mo = new MyObject();
    mo.setFoo(map.get("FOO[]").toString());
    mo.setBar(map.get("WOBBLE13[][]").toString);
    return "whatever";
} 
```

如果您想让这个过程更加自动化，并且如果存在将参数名称映射到属性名称的算法，您可以使用 Spring 的 bean 包装器：

```
@RequestMapping
public String test(@RequestParam Map<String, String> map) {
   BeanWrapper bw = new BeanWrapperImpl(new MyObject);
   for (Entry<String, Object> entry : map.entrySet()) {
       bw.setProperty(entry.getKey(), entry.getValue());
   }
}

private static String decodeName(String n) {
    return n.toLowerCase().substring(0,n.length() - 2);
} 
```

您可以通过使用不同的 Binder 使该过程更加自动化，您可以（真的，这不是问题）添加一些自定义注释......但实际上，如果您只有一个 50 个参数的案例，那么没有意义。如果您坚持，请添加评论。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T15:13:33.317

这听起来像是使用哈希映射的好时机，其中键作为 var 名称，值作为值。将其包装在表单支持对象中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-11T15:22:59.983

您可以拥有一个资源类，即 FooBarResource.jave 并在您的控制器中将其用作请求主体，如下所示：

```
@ResponseBody
@RequestMapping(value = "/test", method = RequestMethod.POST)
@Secured({"ROLE_ADMIN"})
    public ResponseEntity<ModelMap> createTest(@Valid @RequestBody FooBarResource body, UriComponentsBuilder builder) { 
```

# android - This string cannot be converted to a JSONArray

> ID：15952282
> 
> 赞同：0
> 
> 时间：2013-04-11T15:04:39.000
> 
> 标签：android, json

The following string cannot be converted to a JSONArray for some reason. I do not know why: This is the string:

```
[{"article_number":"2.","article_title":"Supremacy of this Constitution","chapter_id":"1","part_id":"0","article_id":"2"},
{"article_number":"3.","article_title":"Defence of this Constitution","chapter_id":"1","part_id":"0","article_id":"3"}] 
```

This is the code:

```
try{
            //Load the sqlite DB here:ARTICLES TABLE
            json_array=new JSONArray(response_articles.trim());
            int len=json_array.length();
            for(int i=0;i<len;i++){
                JSONObject json_obj=json_array.getJSONObject(i);
                String article_id=json_obj.getString("article_number");
                String part_no=json_obj.getString("article_title");
                System.out.println(article_id+"........................................................................,"+part_no);
                //String chapter_id=json_obj.getString("chapter_number");
                //String chapter=json_obj.getString("constitutionChapters");

            }
        }catch(Exception e){
            e.printStackTrace();
        } 
```

# c++ - 获得真正的可用空间

> ID：15952283
> 
> 赞同：2
> 
> 时间：2013-04-11T15:04:45.587
> 
> 标签：c++, ubuntu, diskspace

我遇到了一个程序问题，该程序应该将任何用户都可以使用的可用磁盘空间发回给我。

我的目标是让没有 sudo 权限的任何人都可以使用我的硬盘驱动器的每个分区的所有可用磁盘空间。

所以我尝试了这个：

```
int main() {
    struct statvfs diskData;
    statvfs("/", &diskData);
    unsigned long long available = (diskData.f_favail + diskData.f_bavail) * diskData.f_frsize) / (1024 * 1024)
    std::cout << "Free Space : " << available << std::endl;
} 
```

这给了我总共2810 ...

但是，当我输出时`df -h`，我可以读到可用空间是`25G`for`sda3`和`30G`for`sda1`

这似乎完全不准确。

我一直在 Stackoverflow 上运行帖子，混合我看到的解决方案，但没有一个令人满意。如何获得可用可用空间的正确值（以 MB 为单位）？

编辑：完整`statvfs`和`df /`输出

`statvfs`：

```
Block Size            : 4 096
Fragment Size         : 4 096
Blocks                : 9 612 197
Free Blocks           : 7 009 166
Non Root Free Blocks  : 6 520 885
Inodes                : 2 444 624
Free Inodes Space     : 2 137 054
Non Root Free Inodes  : 2 137 054
File System ID        : 4 224 884 198
Mount Flags           : 4 096
Max Filename Length   : 255 
```

`df /`：

```
Filesystem     1K-Blocks      Used           Available      Use%     Mounted on
/dev/sda3      38 448 788     10 412 112     26 083 556     29%      / 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-11T15:50:44.347

这似乎是对可用磁盘空间的更准确测量：

```
unsigned long long available = (diskData.f_bavail * diskData.f_bsize) / (1024 * 1024); 
```

它与我系统上的输出`df`非常匹配（`df`以演出为单位显示大小，并可能四舍五入）。

如果你想在演出中输出，`df`你可以使用这个：

```
#include <sys/statvfs.h>
#include <stdio.h>

unsigned long rounddiv(unsigned long num, unsigned long divisor) {
    return (num + (divisor/2)) / divisor;
}

int main() {
    struct statvfs diskData;
    statvfs("/home", &diskData);
    unsigned long available = diskData.f_bavail * diskData.f_bsize;
    printf("Free Space : %luG\n", rounddiv(available, 1024*1024*1024));
    return 0;
} 
```

这个在我的系统上的输出：
`Free Space : 31G`

如果我运行`df -h /home`：

```
Filesystem            Size  Used Avail Use% Mounted on
                      181G  141G   31G  83% /home 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-12T09:10:13.397

似乎要使用的正确值是片段大小，而不是块大小（即 f_frsize）

你试过吗

```
diskData.f_bavail * diskData.f_frsize 
```

反而 ？

# python - 如何根据列表中的项目复制熊猫中的行

> ID：15952291
> 
> 赞同：16
> 
> 时间：2013-04-11T15:05:14.443
> 
> 标签：python, pandas

我有一个看起来像这样的熊猫数据框：

```
COL     data
line1   [A,B,C] 
```

其中数据列中的项目可以是列表，也可以只是逗号分隔的元素。有没有*简单*的获取方式：

```
COL     data
line1   A
line1   B
line1   C 
```

我可以遍历列表并通过 python 手动复制行，但是这样做有什么*神奇*的 pandas 技巧吗？关键是如何自动复制行。

谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-11T16:40:48.747

您可以编写一个简单的清理函数来使其成为一个列表（假设它不是逗号列表，并且您不能简单地使用[`ast.literal_eval`](http://docs.python.org/2/library/ast.html#ast.literal_eval)）：

```
def clean_string_to_list(s):
    return [c for c in s if c not in '[,]']  # you might need to catch errors

df['data'] = df['data'].apply(clean_string_to_list) 
```

遍历行似乎是一个合理的选择：

```
In [11]: pd.DataFrame([(row['COL'], d)
                       for d in row['data']
                       for _, row in df.iterrows()],
                       columns=df.columns)
Out[11]:
     COL data
0  line1    A
1  line1    B
2  line1    C 
```

*恐怕我不认为熊猫专门迎合这种操纵。*

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2020-10-04T19:07:36.597

您可以使用`df.explode()`选项。请参阅[文档](https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.explode.html)。我相信这正是您需要的功能。

# javascript - How do I split words in a String with JavaScript regex?

> ID：15952294
> 
> 赞同：1
> 
> 时间：2013-04-11T15:05:21.823
> 
> 标签：javascript, regex

I have the String "Edit[user]", but I need get "Edit" and later "user".

How can I do it? Any help would be useful.

Of course I need do it with JavaScript regex.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-11T15:12:03.943

```
var regex = /(.+)\[(.+)\]/;
var str = "Edit[user]";
regex.exec(str); // will return ["Edit[user]", "Edit", "user"] 
```

或者您可以使用以下`String#split`方法这样做：

```
var str = "Edit[user]";
str.split(/\[(.+)\]/); // will return ["Edit", "user"] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T15:12:46.683

您正在寻找的是分组。我将快速解释这些在 JavaScript 中是如何工作的，并将实际的正则表达式留给你。

```
var myString = "cat dog frog";
var myRegexp = /(cat).*(frog)/g;
var match = myRegexp.exec(myString); 
```

match 将是一个数组，索引 0 将具有整个匹配项，任何其他将具有组的内容。

```
match[0] = "cat dog frog"
match[1] = "cat"
match[2] = "frog" 
```

# android - EditTextPreference，如何将值保存为浮点数

> ID：15952297
> 
> 赞同：-2
> 
> 时间：2013-04-11T15:05:31.173
> 
> 标签：android, preferences

如何将值保存为来自 EditTextPreference 的浮点数？

我遵循这个[PreferenceActivity: save value as integer](https://stackoverflow.com/questions/3721358/preferenceactivity-save-value-as-integer) 但我没有为我工作。我的偏好文件是

```
<?xml version="1.0" encoding="utf-8"?>
<PreferenceScreen xmlns:android="http://schemas.android.com/apk/res/android">
<PreferenceCategory 
    android:title="Taxes"
    android:key="first_category">

    <CheckBoxPreference 
        android:key="include_taxes"
        android:summary="Include or Exclude taxes"
        android:title="Include Taxes" 
        android:defaultValue="true"
    />
<PreferenceScreen 
    android:key="Entering_Taxes"
    android:title="Enter the Values"
    android:dependency="include_taxes"
    android:persistent="false">

        <EditTextPreference
            android:key="ED_tax"
            android:title="E.D Tax" 
            android:summary="Define E.D Tax"
            android:dialogTitle="Set E.D Tax"
            android:dialogMessage="Enter the value" 
            android:defaultValue='7.30'/>

    </PreferenceScreen> 
</PreferenceCategory> 
```

我必须添加所有税值。

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2013-04-11T15:08:35.870

说你可以得到这样的editTextPreference字符串，

```
SharedPreferences preferences = PreferenceManager.getDefaultSharedPreferences(this);
String value = preferences.getString("SomeKey", ""); 
```

所以将该字符串转换为像这样浮动：

```
float f = Float.valueOf(value); 
```

# camera - Phonegap 相机 API 将拍摄的照片保存到相机胶卷

> ID：15952310
> 
> 赞同：2
> 
> 时间：2013-04-11T15:06:05.550
> 
> 标签：camera, save, cordova

是否可以使用 Cordova 相机 API 拍照，然后将其本地存储在 iOS 和 Android 上的相机胶卷中？我知道它是可能的，但它是否以某种方式涉及本机代码，还是可以用纯 HTML 完成？文档没有说明这一点。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-07-25T04:47:48.043

只需添加参数`saveToPhotoAlbum: true`。`cameraOptions`

例如

```
navigator.camera.getPicture(onPhotoDataSuccess, onFail,
{
  quality: 50,
  destinationType: destinationType.FILE_URI,
  saveToPhotoAlbum: true
}); 
```

`saveToPhotoAlbum`默认设置为`false`。

[参考](http://docs.phonegap.com/en/3.0.0/cordova_camera_camera.md.html#cameraOptions)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-11T19:52:48.690

你是说设备的图库吗？

如果是这样，只需将 FILE_URI 用于 Camera.DestinationType 选项。

参考：[http ://docs.phonegap.com/en/2.6.0/cordova_camera_camera.md.html#cameraOptions](http://docs.phonegap.com/en/2.6.0/cordova_camera_camera.md.html#cameraOptions)

# iphone - Mika Tuupola 的 LazyLoad 插件不适用于 Iphone 5/4s，但适用于使用 iOS 6.1 的 ipad 3

> ID：15952313
> 
> 赞同：-1
> 
> 时间：2013-04-11T15:06:07.673
> 
> 标签：iphone, ios, jquery-plugins, iphone-5, lazy-loading

我在 iphone 5 和 4s 上遇到了延迟加载问题。出于某种原因，当我向下滚动页面时，它在视口中加载了两个图像，当视口中有 9 个时，我向下滚动，只加载了另外 2 个图像，等等。当我单击主页按钮时并返回 iphone 5 上的 safari，然后将所有图像加载到视口中。我没有iphone 5，但我在苹果商店测试过，我有一个ipad 3，它可以正常工作。如果有人对此有任何经验，任何帮助将不胜感激。我希望 Mika 能参与进来，而且他也很活跃。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T21:12:42.027

在修复了一些错误后，它似乎正在工作。视口有一些其他小的 css 错误，现在它可以完美运行了。

# heroku - Heroku Rails 应用程序 R11 错误

> ID：15952317
> 
> 赞同：0
> 
> 时间：2013-04-11T15:06:19.530
> 
> 标签：heroku, ruby-on-rails-3.2

我正在 Heroku 上部署 Rails 3.2.11 应用程序，并使用 Thin 作为我的服务器。当我推送到 Heroku 时，它启动 Thin 就好了，但它似乎也尝试启动 WEBrick。

我的Procfile如下：

> 网络：捆绑 exec rails server -p $PORT thin -e $RACK_ENV

我的 Heroku 日志：

```
2013-04-11T14:52:28.276634+00:00 heroku[api]: Release v21 created by XXXXXX@gmail.com
2013-04-11T14:52:28.331285+00:00 heroku[api]: Deploy 6f63ed4 by XXXXXX@gmail.com
2013-04-11T14:52:28.432372+00:00 heroku[web.1]: State changed from crashed to starting
2013-04-11T14:52:28.965697+00:00 heroku[slugc]: Slug compilation finished
2013-04-11T14:52:30.218480+00:00 heroku[web.1]: Starting process with command `bundle exec rails server -p 9009 thin -e $RACK_ENV`
2013-04-11T14:52:32.898285+00:00 app[web.1]: DEPRECATION WARNING: You have Rails 2.3-style plugins in vendor/plugins! Support for these plugins will be removed in Rails 4.0\. Move them out and bundle them in your Gemfile, or fold them in to your app as lib/myplugin/* and config/initializers/myplugin.rb. See the release notes for more on this: http://weblog.rubyonrails.org/2012/1/4/rails-3-2-0-rc2-has-been-released. (called from <top (required)> at /app/config/environment.rb:5)
2013-04-11T14:52:32.897830+00:00 app[web.1]: DEPRECATION WARNING: You have Rails 2.3-style plugins in vendor/plugins! Support for these plugins will be removed in Rails 4.0\. Move them out and bundle them in your Gemfile, or fold them in to your app as lib/myplugin/* and config/initializers/myplugin.rb. See the release notes for more on this: http://weblog.rubyonrails.org/2012/1/4/rails-3-2-0-rc2-has-been-released. (called from <top (required)> at /app/config/environment.rb:5)
2013-04-11T14:52:34.350938+00:00 app[web.1]: [2013-04-11 14:52:34] INFO  WEBrick::HTTPServer#start: pid=2 port=2010
2013-04-11T14:52:34.350132+00:00 app[web.1]: [2013-04-11 14:52:34] INFO  WEBrick 1.3.1
2013-04-11T14:52:34.350707+00:00 app[web.1]: [2013-04-11 14:52:34] WARN  TCPServer Error: Address already in use - bind(2)
2013-04-11T14:52:34.350132+00:00 app[web.1]: [2013-04-11 14:52:34] INFO  ruby 1.9.2 (2011-07-09) [x86_64-linux]
2013-04-11T14:52:34.407830+00:00 heroku[web.1]: Stopping process with SIGKILL
2013-04-11T14:52:34.407675+00:00 heroku[web.1]: Error R11 (Bad bind) -> Process bound to port 2010, should be 9009 (see environment variable PORT)
2013-04-11T14:52:35.572955+00:00 heroku[web.1]: State changed from starting to crashed
2013-04-11T14:52:35.560772+00:00 heroku[web.1]: Process exited with status 137 
```

为什么要这样做？我错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T17:00:20.060

事实证明，我使用的一个插件 SyntaxHighlighter 在它的测试目录中有一些文件可以启动 WEBrick。我刚刚删除了那些，提交，推送，并且效果很好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T15:44:01.207

尝试使用 Thin 而不是 WEBrick。您可以通过简单地将其添加到您的 gemfile 来做到这一点：

```
gem 'thin' 
```

然后运行`bundle install`，提交新的 Gemfile 和 Gemfile.lock，然后推送到 Heroku。

WEBrick 不适合生产使用。

# python - 用于信号处理的 Python 包

> ID：15952322
> 
> 赞同：9
> 
> 时间：2013-04-11T15:06:28.170
> 
> 标签：python, numpy, signal-processing, fft, scikits

我正在寻找一个 Python 包来执行高效的常量 Q 变换（即使用 FFT 来加速该过程）。我找到了一个名为 CQ-NSGT/sliCQ Toolbox 的工具箱，但出现以下错误：

```
File "build\bdist.win32\egg\nsgt\__init__.py", line 37, in <module>
File "build\bdist.win32\egg\nsgt\audio.py", line 7, in <module>
File "C:\Python27\lib\site-packages\scikits\audiolab\__init__.py", line 25, in <module>
    from pysndfile import formatinfo, sndfile
File "C:\Python27\lib\site-packages\scikits\audiolab\pysndfile\__init__.py", line 1, in <module>
    from _sndfile import Sndfile, Format, available_file_formats, \
File "numpy.pxd", line 30, in scikits.audiolab.pysndfile._sndfile (scikits\audiolab\pysndfile\_sndfile.c:9632)
ValueError: numpy.dtype does not appear to be the correct type object 
```

Numpy（我怀疑）或者更可能是 scikit audiolab 似乎存在问题。你知道问题出在哪里吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-22T20:16:49.387

我在 yaafe 中使用 CQT 工具：http: [//perso.telecom-paristech.fr/~essid/tp-yaafe-extension/features.html](http://perso.telecom-paristech.fr/~essid/tp-yaafe-extension/features.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-08T19:52:07.607

查看 PYO，这是一个用 C 语言实现的用于 python 的 DSP 模块。对信号进行数学运算，应包括傅立叶变换。

[http://code.google.com/p/pyo/](http://code.google.com/p/pyo/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-10-09T01:32:17.830

PyMIR 实现了一些音频和音乐处理例程，例如将 NumPy 的 FFT 应用于 wav 或 mp3 数据，或将 CQT（恒定 Q 变换）或 DCT（离散余弦变换，使用 NumPy 构建）应用于相同类型的音频数据：

*   [https://github.com/jsawruk/pymir](https://github.com/jsawruk/pymir)

PyMIR 已获得 MIT 许可。

# php - 如何将数据拆分为数组？

> ID：15952323
> 
> 赞同：0
> 
> 时间：2013-04-11T15:06:30.347
> 
> 标签：php

我已将数据存储在 mysql 数据库中，我想知道如何在将数据输出到 php 之前将数据拆分到每个不同的数组中？

```
<?php
  define('DB_HOST', 'localhost');
  define('DB_USER', 'myusername');
  define('DB_PASSWORD', 'mypassword');
  define('DB_DATABASE', 'mydbname');   

  $errmsg_arr = array();
  $errflag = false;
  $link = mysql_connect(DB_HOST, DB_USER, DB_PASSWORD);

   if(!$link)
  {
    die('Failed to connect to server: ' . mysql_error());
  }
  $db = mysql_select_db(DB_DATABASE);

  if(!$db)
  {
    die("Unable to select database");
  }

  if($errflag)
  {
    $_SESSION['ERRMSG_ARR'] = $errmsg_arr;
    echo implode('<br />',$errmsg_arr);
  }
  else
  {
    $qrytable1="SELECT id, mydata FROM mydb ";
    $result1=mysql_query($qrytable1) or die('Error:<br />' . $qry . '<br />' . mysql_error());

     while ($row = mysql_fetch_array($result1))
    {
      echo "<tr><td>".$row['mydata']."</td></tr>";
    }
  }
?> 
```

在我的 PHP 页面上，它显示如下内容：

```
<tr><td>my data 1</td></tr><tr><td>my data 2</td></tr><tr><td>my data 3</td></tr><tr><td>my data 4</td></tr> 
```

我想将它们拆分为数组并将它们与每个不同的数组一起输出到如下所示：

```
mydata1

mydata2

mydata3

mydata4 
```

如何在我的 php 中输出数据之前将它们拆分为数组？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T15:20:27.257

如果我是对的，除了在数组中获取数据之外，您还想删除数据之间的空间，试试这个

```
while ($row = mysql_fetch_array($result1))
{
  echo "<tr><td>".$row['mydata']."</td></tr>";
  $myArr[] = $row['mydata']; 
}

foreach($myarr as $key=>$value)
{
   $myArr[$key] = str_replace(" ","",$value);
} 
```

[str_replace](http://php.net/manual/en/function.str-replace.php)将删除空格。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-11T15:11:11.480

你在寻找这样的东西吗？

（将其视为示例，但作为@BenM，请考虑使用 PDO）

```
$sql = 'SELECT * FROM country';
$query = mysql_query($sql);
$countries = array();
while ($country = mysql_fetch_assoc($query)){ $countries[] = $country; } 
```

这将允许您使用

```
foreach ($countries as $country) {
    echo $country['name'];
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-11T15:14:31.293

您的数据已经在一个数组中。这就是这条线的作用：

```
 while ($row = mysql_fetch_array($result1))
{
  echo "<tr><td>".$row['mydata']."</td></tr>";
} 
```

如果您需要在 while 循环之外访问数组，您可以这样做..

```
$myArray = array();
    while ($row = mysql_fetch_array($result1)){
    echo "<tr><td>".$row['mydata']."</td></tr>";
    foreach($row as $key=>$val){
        $myArray[$key] = $val;
    }
} 
```

实际上..假设您的查询返回多行，它将是一个多维数组..

```
$myArray = array();
$i = 0;
    while ($row = mysql_fetch_array($result1)){
    echo "<tr><td>".$row['mydata']."</td></tr>";
    foreach($row as $key=>$val){
        $myArray[$i][$key] = $val;
        $i++;
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-11-23T05:48:16.290

你可以用这个，

```
 $db->setQuery($query);
$rows = $db->loadObjectList();

$i=0;
foreach($rows as $row){
        //$row; 
        $image = json_decode($row->images);
// split code
     $str     = utf8_encode($row->introtext);
     $order   = array("<p>", "</p>", "\n", "\r");
     $replace = '';
    $introtext = str_replace($order, $replace, $str);

    $introtext_split = explode("|", $introtext);

     $data[0]->designation  =  preg_replace('#<br />?#', "\n", $introtext_split[0]);

     $data[0]->description  =  preg_replace('#<br />?#', "\n\n", $introtext_split[1]);

     $data[0]->small_description  =  preg_replace('#<br />?#', "\n\n", $introtext_split[2]);
} 
```

在使用任何标签的数据中，或者使用以下部分替换此标签：

```
$str     = utf8_encode($row->introtext);
 $order   = array("<p>", "</p>", "\n", "\r"); 
```

我认为它对你有用。

# actionscript-3 - AS3 播放影片剪辑并导航到主时间轴上的另一帧

> ID：15952324
> 
> 赞同：1
> 
> 时间：2013-04-11T15:06:33.690
> 
> 标签：actionscript-3, flash

我有一个按钮，您将鼠标悬停在一个帧上 - 它与位于下一帧的影片剪辑一起使用（这两个都在同一个关键帧中）并在第 134 帧播放它。在那个影片剪辑之后播放完毕，我希望时间线将您带到下一帧。

我不能使用这个：

```
stop(); 
if( MovieClip(root).currentFrame < MovieClip(root).totalFrames ) {
    MovieClip(root).nextFrame();
} 
```

我试图将该代码放在 mc 的最后一帧中，但它不起作用。

现在即使使用停止命令它仍然循环。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T19:03:02.693

尝试`this.parent`而不是`root`像这样，

```
stop(); 

if(MovieClip(this.parent).currentFrame < MovieClip(this.parent).totalFrames)
{  
    MovieClip(this.parent).nextFrame(); 
} 
```

好运。

# hibernate - Hibernate 无法解析大写值名称的属性

> ID：15952326
> 
> 赞同：0
> 
> 时间：2013-04-11T15:06:34.890
> 
> 标签：hibernate

我有两节课：

```
public class User {

    private int id;
    private String Name;
    private Set<Contact> Contacts = new HashSet<Contact>();

    @Id
    @GeneratedValue
    public int getId() {
        return id;
    }

    ...

    @OneToMany(mappedBy = "owner", cascade = CascadeType.ALL)
    public Set<Contact> getContacts() {
        return
    }
} 
```

和

```
public class Contact {

    private int id;
    private String nick;
    private int age;
    private User owner;

    ...

    @ManyToOne(cascade = CascadeType.ALL)
    @JoinColumn(name = "UserId")
    public User getOwner() {
        return owner;
    }
} 
```

当我打电话时：

```
session.createCriteria(Contact.class).add(Restrictions.eq("owner.id", 2)).list(); 
```

一切都很好，但是如果我将用户的“id”属性名称更改为“Id”，代码编译但是：

```
session.createCriteria(Contact.class).add(Restrictions.eq("owner.Id", 2)).list(); 
```

将向我抛出“无法解析 property owner.Id”异常。

我知道在 Java 中我应该以小写字母开头变量名，但我只想知道为什么 Hibernate 会以这种方式运行。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T01:53:49.860

因为您在任何 Criteria、Restriction 或 HQL 中添加的字符串并不是真正的脚本语言（例如 SQL）。Hibernate 有一个复杂的机制，它将根据您的输入进行反射调用。

所以，如果你有：

```
session.createCriteria(Contact.class).add(Restrictions.eq("owner.Id", 2)).list(); 
```

Hibernate 确实会为类创建一个对象，因为您在方法上添加了注释，所以`Contact`该对象将具有一个调用`owner`和调用`Id`（区分大小写）的对象。`getId()`

简而言之，这就是为什么...

# c++ - 读取“\n”字符串并写入文本文件？

> ID：15952331
> 
> 赞同：2
> 
> 时间：2013-04-11T15:06:48.737
> 
> 标签：c++, string, escaping

我正在努力解决以下问题：我正在从 XML 文件中读取以下 std::stringstream

```
"sigma=0\nreset" 
```

经过一些复制和处理后，它被写入文本文件。我希望以下

```
sigma=0
reset 
```

但遗憾的是我只得到

```
sigma=0\nreset 
```

但是当我直接流式传输时

```
out << "sigma=0\nreset" 
```

我得到：

```
sigma=0
reset 
```

我目前怀疑在“复制和处理”期间丢失了“\n”的一些限定符......这可能吗？如何在不再是换行符的流中追踪“\n”？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-11T15:09:58.410

这是因为输出函数不处理转义序列，如`'\n'`，它是编译器，然后只处理文字。编译器对字符串的内容一无所知，因此在字符串内部时无法转换`"\n"`为换行符。

您必须解析字符串本身，并在适当的时候写出换行符。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-11T18:54:04.987

假设`std::stringstream`实际包含相当于文字`"sigma=0\\nreset"`（长度 = 14 个字符）而不是`"sigma=0\nreset"`（长度 = 13 个字符）的内容，您必须自己替换它。这样做不是很困难，要么使用boost `replace_all` （[http://www.boost.org/doc/libs/1_53_0/doc/html/boost/algorithm/replace_all.html](http://www.boost.org/doc/libs/1_53_0/doc/html/boost/algorithm/replace_all.html)），`std::string::find`要么`std::string::replace`：

```
std::stringstream inStream;
inStream.str ("sigma=0\\nreset");
std::string content = inStream.str();

size_t index = content.find("\\n",0);

while(index != std::string::npos)
{
   content.replace(index, 2, "\n");
   index = content.find("\\n",index);
}

std::cout << content << '\n'; 
```

注意：您可能需要考虑系统行尾不是其他情况的情况`"\n"`

如果`std::stringstream`实际包含`"sigma=0\nreset"`，请发布执行复制/处理和写入文本文件的代码。

# c# - 更改样式颜色后刷新 WPF UI

> ID：15952334
> 
> 赞同：0
> 
> 时间：2013-04-11T15:06:54.010
> 
> 标签：c#, wpf, xaml, templates, user-interface

我在`ResourceDictionary`. 我创建了一个窗口来更改 ThemeColor。这种颜色绑定到我的`ResourceDictionary`.

**这是我的资源字典：**

```
<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:ns="clr-namespace:Phoenix_CRM" >

    <LinearGradientBrush x:Key="DegradeCouleurTheme" StartPoint="0,0" EndPoint="0,1" >
        <GradientStop Offset="0" Color="{x:Static ns:CParametres.ColorBegin}" />
        <GradientStop Offset="1" Color="{x:Static ns:CParametres.ColorEnd}"/>
    </LinearGradientBrush>
</ResourceDictionary> 
```

我创建了一个 CParameters 类来设置颜色参数。构成渐变的两种颜色保存在数据库中。此类旨在加载/保存颜色并应用它。

**这是我更改颜色的课程：**

```
 public class CParametres : INotifyPropertyChanged
    {

        private  Color m_ThemeColorGradientBegin;
        public  Color ThemeColorGradientBegin
        {
            get { return m_ThemeColorGradientBegin; }
            set
            {
                m_ThemeColorGradientBegin = value;
                ColorBegin = m_ThemeColorGradientBegin;
                FirePropertyChangedEvent("ColorBegin");
            }
        }

        private  Color m_ThemeColorGradientEnd;
        public  Color ThemeColorGradientEnd
        {
            get { return m_ThemeColorGradientEnd; }
            set
            {
                m_ThemeColorGradientEnd = value;
                ColorEnd = m_ThemeColorGradientEnd;
                FirePropertyChangedEvent("ColorEnd");
            }
        }

        public static Color ColorBegin;
        public static Color ColorEnd;

        public CParametres()
        {
            ....
            ....
        }

        public void LoadGradientDefault()
        {
            ThemeColorGradientBegin   =   (Color)ColorConverter.ConvertFromString("#00b6e7");
            ThemeColorGradientEnd     =   (Color)ColorConverter.ConvertFromString("#0086d6");
        }

        public void LoadParams()
        {
            if (ReadParamFromDB() == true)
            {
                setThemeGradient(m_ThemeColorGradientBegin, m_ThemeColorGradientEnd);
            }
        }

        public void setThemeGradient(Color ColorBegin, Color ColorEnd)
        {
            this.ThemeColorGradientBegin = ColorBegin;
            this.ThemeColorGradientEnd = ColorEnd;
        }

        public event PropertyChangedEventHandler PropertyChanged;

        private void FirePropertyChangedEvent(string propertyName)
        {
            if (PropertyChanged != null)
            {
                PropertyChanged(this, new PropertyChangedEventArgs(propertyName));
            }
        }

    } 
```

当我更改颜色时，我需要退出并重新运行我的应用程序才能看到更改。请问有人知道强制直接应用新颜色吗？

任何人都可以向我解释一下刷新 UI 的提示是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T15:11:22.150

您需要对所有资源颜色和样式使用 DynamicResource 而不是 StaticResource。

使用 DynamicResource，您的所有更改样式都将反映在 UI 中。

更新：

当你使用Brush时，你需要以这种方式给Brush

```
<Setter Property="Foreground">
    <Setter.Value>
        <SolidColorBrush Color="{DynamicResource AccentColor}" />
    </Setter.Value>
</Setter> 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-11T15:13:00.860

您需要实现 INotifyPropertyChanged 接口才能发生属性更改事件。不幸的是，这意味着您需要一个实例来操作而不是静态的。

如果您创建一个返回单例实例的静态属性，您可以执行以下操作

```
<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:ns="clr-namespace:Phoenix_CRM" >

    <LinearGradientColor x:Key="DegradeCouleurTheme" StartPoint="0,0" EndPoint="0,1" >
        <GradientStop Offset="0" Color="{Binding ColorBegin, Source={x:Static ns:CParametres.Instance}}" />
        <GradientStop Offset="1" Color="{Binding ColorEnd, Source={x:Static ns:CParametres.Instance}}" />
    </LinearGradientColor>
</ResourceDictionary> 
```

单例示例

```
public class CParameters : INotifyPropertyChanged {

  public event PropertyChangedEventHandler PropertyChanged;

  private void OnPropertyChanged(string propertyName) {
    var handle = PropertyChanged;
    if (handle != null) handle(this, new PropertyChangedEventArgs(propertyName));
  }

  private static readonly CParameters instance = new CParameters();

  public static CParameters Instance {
     get { return instance; }
  }

  private Color colorBegin;

  private Color colorEnd;

  public Color ColorBegin {
    get { return colorBegin; }
    set {
      if (value != colorBegin) {
        colorBegin=value;
        OnPropertyChanged("ColorBegin");
      }
    }
  }

  public Color ColorEnd {
    get { return colorEnd; }
    set { 
     if (value != colorEnd) {
       colorEnd = value;
       OnPropertyChanged("ColorEnd");
     }
   }
  }
} 
```

# c - C - 指针和内存

> ID：15952338
> 
> 赞同：2
> 
> 时间：2013-04-11T15:06:58.317
> 
> 标签：c, arrays, pointers, memory

我有点困惑，在这个示例代码中说；

```
ptrMem = createSharedMemory();  

ptrTemp = ptrMem; 
```

`ptrMem`指向由创建的共享内存位置`SHMGET`

指向它有什么意义，`ptrTemp`我如何利用两者？

我想遍历内存并分配随机数，例如；

```
ptrTemp = ptrMem;       
for(nCount = 0; nCount < 24; nCount++)
        {   
            x = rand() % 10000;
            *ptrTemp++ = x;
        } 
```

这种情况是有一个客户端和一个服务器通过共享内存进行通信。需要有一个字符或类似的东西向其他进程表明他们可以进行处理。例如，在上述循环完成后；`*ptrMem='*'`.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T15:14:23.220

这是因为在循环中您*更改*了指针`ptrTemp`。做完后`ptrTemp++`指针不再指向原来的内存。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-11T15:19:18.637

> *   让 ptrTemp 也指向它有什么意义，我如何利用两者？

这与链表中的“头”指针相同。

```
ptrTemp = ptrMem;     // here both pointers point to the start
                      //  of your shared memory location 
```

当你运行你的循环时，你一次又一次地执行这个：

```
*ptrTemp++ = x; 
```

现在`ptrTemp`不再指向共享内存位置的开始。在这个特定的例子中，你知道你循环了 24 次（你的指针增加了 24 次），所以你可以使用指针算术并“回退”地址，但为什么要麻烦呢？对于一些额外的字节，您可以只使用一个新指针，并且始终可以方便地引用缓冲区的开头，这很可能需要传递/引用。

请记住，名称`ptrTemp`中包含“Temp”，这意味着它用于某种临时存储。

* * *

**编辑：**操作`*`员要取消引用一个指针（或这样声明）。所以在你的代码中：

```
ptrTemp = ptrMem; // Assigning one pointer to another, no need for the * here since
                  // they are both pointers.

*ptrTemp++ = x; // here you are assigning a value to the memory pointed to by ptrTemp
                // to assign a value you need to dereference, then we increment ptrTemp 
```

> *   如果我想打印内存，我必须这样做；ptrTemp = ptrMem，对吧？

不是真的，那只会将临时指针设置回共享内存缓冲区的开头。如果您想打印内存的*内容*，您可以简单地执行以下操作：

```
for(nCount = 0; nCount < 24; nCount++)
    printf("%p: %d\n", ptrMem+nCount, *(ptrMem+nCount)); 
```

这不会改变 ptrMem 所指出的内容（因为我们从不覆盖它）我们想知道哪个内存地址 (ptrMem+nCount) 具有什么值（它的取消引用版本）所以我们打印一个`"%p"`（指针格式字符串）和一个`"%d"`(int 格式字符串)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-11T15:17:00.427

这是一个品味问题。

如果您想通过增加一个指针来遍历内存，那么您需要保留一个指向开头的指针，以便可以正确释放它。

您也可以使用索引来遍历内存，而不是使用临时指针。

```
for(nCount = 0; nCount < 24; nCount++)
{   
    x = rand() % 10000;
    ptrMem[nCount] = x;
} 
```

在使用指针迭代内存缓冲区而不是仅使用索引时，我见过（或自己做过）的大多数情况是指针前进的量不一致。例如，如果您的缓冲区在每个元素中始终具有相同的数据类型，则编译器可以知道要为您增加多少指针（或计算索引偏移量）。

```
struct mystruct* ptrMem;
ptrMem[0]; // first element
ptrMem[1]; // second element

struct mystruct* ptrTemp = ptrMem;
*ptrTemp; // first element
ptrTemp++; // increments ptrTemp by sizeof(struct mystruct) bytes
*ptrTemp; // second element 
```

在这种情况下，您希望使用哪一个是个人喜好问题。

例如，如果编译器无法知道缓冲区中包含的数据的结构，例如处理命令具有可变长度的 midi 文件，则一次迭代一个字节的指针会更容易（更具可读性）。尽管如此，编译器仍然知道字节的大小，因此您也可以在此处使用索引。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-11T15:14:27.867

`prtTemp`如果我需要更改他的值来访问共享内存的不同内存区域，我会使用。

如果我需要指向共享内存区域的第一个字节，我可以使用 untouched`ptrMem`

# jquery - jquery ui对话框标题栏行为不规律

> ID：15952340
> 
> 赞同：1
> 
> 时间：2013-04-11T15:07:01.717
> 
> 标签：jquery, html, css, jquery-ui, jquery-dialog

我有一个非常标准的 HTML 页面，我正在尝试使用 jQuery UI 的对话框。我以前多次使用过这个对话框，通常它再简单不过了。但是，由于某种原因，我现在遇到了一个问题，即在`<div id="upload_only_dialog"></div>`显示对话框时调用对话框是

1.使对话框的标题栏大约 700px 高

2.将样式[moderizer.js .placeholder](http://webdesignerwall.com/tutorials/cross-browser-html5-placeholder-text)应用于对话框中的所有文本

我不知道将占位符样式应用于对话框的情况（所有内容均为浅灰色文本），但真正令人困惑的是标题栏。我已将有问题的 HTML 缩小到文档的这一部分。当我删除它时，标题栏的大小合适。当我更换它时，它的尺寸大得惊人。这似乎完全无害。这里是：

```
<div class="triple_col_container secondary_panel" style="display:block">
    <div class="trip_col secondary_panel_copy">
        <p class="trip_col">
            Get in touch with us to get your project rolling!
        </p>
    </div>
    <div class="secondary_panel_content_wrapper">
        <div class="col_header secondary_panel_header">
            <h2 class="columns">
                Question or comment?
            </h2>
        </div>
        <div class="secondary_panel_col1">
            <p class="secondary_panel_label">
                First name:
                <span class="required_ast">
                    *
                </span>
            </p>
            <div class="secondary_panel_input_container">
                <input type="text" id="mail_first_name_input" class="secondary_panel_input pr"
                />
            </div>
        </div>
        <div class="secondary_panel_col2">
            <p class="secondary_panel_label">
                Last name:
                <span class="required_ast">
                    *
                </span>
            </p>
            <div class="secondary_panel_input_container">
                <input type="text" id="mail_last_name_input" class="secondary_panel_input pr"
                />
            </div>
        </div>
        <div class="tbc">
        </div>
        <div class="secondary_panel_col1">
            <p class="secondary_panel_label">
                Company name:
            </p>
            <div class="secondary_panel_input_container">
                <input type="text" id="mail_company_name_input" class="secondary_panel_input secondary_panel_long_input"
                />
            </div>
        </div>
        <div class="tbc">
        </div>
        <div class="secondary_panel_col1">
            <p class="secondary_panel_label">
                Email:
                <span class="required_ast">
                    *
                </span>
            </p>
            <div class="secondary_panel_input_container">
                <input type="text" id="mail_email_input" class="secondary_panel_input secondary_panel_long_input pr re"
                />
            </div>
        </div>
        <div class="tbc">
        </div>
        <div class="secondary_panel_col1">
            <p class="secondary_panel_label">
                Your message:
                <span class="required_ast">
                    *
                </span>
            </p>
            <div class="secondary_panel_input_container">
                <textarea id="mail_message_input" class="secondary_panel_input secondary_panel_long_input pr"></textarea>
            </div>
        </div>
        <div class="tbc">
        </div>
        <a id="mail_submit" class="hover_button">Submit</a>
    </div>
</div> 
```

我知道我可以添加一些`max-height`CSS 来解决这个问题。但这似乎很草率。我首先需要了解是什么让它表现得像这样。有什么想法可以让我`dialog()`采取行动吗？非常感谢。[地点](http://www2.iscotest.com/)

用于对话框的HTML 用于对话框的 `<div id="upload_only_dialog" title="Upload a file without placing an order"> </div>` JS

```
$(document).ready(function () {

    $("body").on("click", "#upload_only_trigger", function () {

        $("#upload_only_dialog").dialog({
            width: 380,
            height: 523,
            modal: true,
            position: 'center',
            closeOnEscape: false,
            open: function (event, ui) {
                //$('body').css('overflow', 'hidden');
            },
            beforeClose: function (event, ui) {
                //$('body').css('overflow', 'auto');
            }
        });
    });
}); 
```

![非常大的标题栏...](https://i.stack.imgur.com/M3IuU.png)

# spring - 用于基于静态属性值进行测试的骆驼路线设置

> ID：15952343
> 
> 赞同：0
> 
> 时间：2013-04-11T15:07:09.820
> 
> 标签：spring, apache-camel

我正在尝试在接口层中引入单元测试。
在我们提供的代码中`<from:sedaQueueName>`，camel 解析消息并将其发送到外部系统。我想将路线更改`<to:ExternalSystem>`为`<to:PrintMessageOnScreen>`.
我已经在使用静态全局值`isUnitTest` 来获取容器外的数据库连接。
有没有办法可以在应用程序上下文中使用相同的变量值来决定我的路线？
我可以像这样使用 Spring SL 访问属性值：

```
<bean id="forTesting" class="test.UnitTest">
        <property name="isUnitTest">
            <value>#{T(test.UnitTest).isUnitTest}</value>
        </property>
    </bean> 
```

我不确定如何在骆驼路线中读取此属性并根据其值决定我的路线。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T22:52:35.360

您可以使用`dynamic router`只是检查[文档](http://camel.apache.org/dynamic-router.html)，或者您可以使用基于内容的路由器here its [documentation](http://camel.apache.org/content-based-router.html)

# c++ - 将容器 value_type 作为模板参数传递？

> ID：15952353
> 
> 赞同：3
> 
> 时间：2013-04-11T15:07:50.650
> 
> 标签：c++, templates, stl

是否可以将容器的 value_type 作为模板参数传递？

就像是：

```
template<typename VertexType>
class Mesh
{
    std::vector<VertexType> vertices;
};

std::vector<VertexPositionColorNormal> vertices;

// this does not work, but can it work somehow?
Mesh<typename vertices::value_type> mesh;

// this works, but defeats the purpose of not needing to know the type when writing the code
Mesh<typename std::vector<VertexPositionColorNormal>::value_type> mesh; 
```

创建网格（第一个）时，我得到一个“无效的模板参数”，但它应该可以正常工作吗？我在编译时传递了一个已知类型，为什么它不起作用？有什么选择？

谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-11T15:13:34.597

在 C++11 中，您可以使用`decltype`：

```
 Mesh<decltype(vertices)::value_type> mesh;
//       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ 
```

一个完整的编译示例是：

```
#include <vector>

struct VertexPositionColorNormal { };

template<typename VertexType>
class Mesh
{
    std::vector<VertexType> vertices;
};

int main()
{
    std::vector<VertexPositionColorNormal> vertices;

    Mesh<decltype(vertices)::value_type> mesh;
//       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
} 
```

[活生生的例子](http://liveworkspace.org/code/3kW04t$164)。

另一方面，如果您仅限于 C++03，那么您能做的最好的事情可能就是定义一个类型别名：

```
int main()
{
    std::vector<VertexPositionColorNormal> vertices;

    typedef typename std::vector<VertexPositionColorNormal>::value_type v_type;

    // this does not work, but can it work somehow?
    Mesh<v_type> mesh;
} 
```

# android - 如何在单个 android.mk 文件中生成两个 .so 文件

> ID：15952354
> 
> 赞同：1
> 
> 时间：2013-04-11T15:08:00.183
> 
> 标签：android, makefile, java-native-interface, gnu-make

我想在一个 .mk 文件中创建两个 .so 文件。但以下代码失败，因为 LOCAL_MODULE 中不应有空格。那么有出路吗？

```
LOCAL_PATH := $(call my-dir)

include $(CLEAR_VARS)

LOCAL_MODULE    := gpio hello-jni
LOCAL_CFLAGS    := -Werror    
LOCAL_SRC_FILES := gpio.c hello-jni.c
LOCAL_LDLIBS    := -llog 

include $(BUILD_SHARED_LIBRARY) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T15:15:00.253

我刚刚使用以下代码使其工作。

```
LOCAL_PATH := $(call my-dir)

include $(CLEAR_VARS)

LOCAL_MODULE    := gpio 
LOCAL_CFLAGS    := -Werror    
LOCAL_SRC_FILES := gpio.c
LOCAL_LDLIBS    := -llog 

include $(BUILD_SHARED_LIBRARY)

include $(CLEAR_VARS)

LOCAL_MODULE    := h ello-jni
LOCAL_CFLAGS    := -Werror 
LOCAL_SRC_FILES := hello-jni.c
LOCAL_LDLIBS    := -llog 

include $(BUILD_SHARED_LIBRARY) 
```

# emacs - 在 hexl-mode emacs 中配置颜色

> ID：15952355
> 
> 赞同：2
> 
> 时间：2013-04-11T15:08:00.823
> 
> 标签：emacs, hex

当使用 hexl-mode 显示时，我想配置不同数据部分的颜色。

例如，我希望地址范围为白色背景，黄色字节和红色 ASCII（无论如何）。

00000000：2550 4446 2d31 2e34 0a25 c7ec 8fa2 0a35 %PDF-1.4.%.....5 00000010：2030 206f 626a 0a3c 3c2f 4c65 6e67 7468 0 对象。

我尝试像这样更新我的颜色主题：

```
 (hexl-address-region ((t (:background "#252525"))))
 (hexl-ascii-region ((t (:foreground "#cfbfad")))) 
```

但这显然行不通。颜色没有改变:(

我的全彩主题：

```
(eval-when-compile
   (require 'color-theme))

(defun sublime-text-2 ()
   "Color theme that looks like the Sublime Text 2 editor."
   (interactive)
   (color-theme-install
    '(sublime-text-2
      ((background-color . "#171717")
       (background-mode . light)
       (border-color . "#1a1a1a")
       (cursor-color . "#fce94f")
       (foreground-color . "#cfbfad")
       (mouse-color . "black"))
       (fringe ((t (:background "#1a1a1a"))))
       (mode-line ((t (:foreground "#eeeeec" :background "#555753"))))
       (region ((t (:foreground "#404040" :background "#CC9900"))))
       (font-lock-builtin-face ((t (:foreground "#52e3f6"))))
       (font-lock-comment-face ((t (:foreground "#ffffff"))))
       (font-lock-function-name-face ((t (:foreground "#edd400"))))
       (font-lock-keyword-face ((t (:foreground "#ff007f"))))
       (font-lock-string-face ((t (:foreground "#ece47e"))))
       (font-lock-type-face ((t (:foreground"#8ae234"))))
       (font-lock-variable-name-face ((t (:foreground "#8ae234"))))
       (minibuffer-prompt ((t (:foreground "#729fcf" :bold t))))
       (font-lock-warning-face ((t (:foreground "Red" :bold t))))
       (hexl-address-region ((t (:background "#252525"))))
       (hexl-ascii-region ((t (:foreground "#cfbfad"))))
       (speedbar-directory-face ((t (:foreground "light blue"))))
       (speedbar-tag-face ((t (:foreground "#cfbfad"))))
 ))) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T18:26:15.353

我能够复制您的问题。hexl-mode 似乎有一个问题，它在模式启动时没有字体化缓冲区。

要强制`hexl-mode`字体化缓冲区，请将其添加到您的 .emacs

```
(require 'hexl)
(add-hook 'hexl-mode-hook 'font-lock-fontify-buffer) 
```

我还提交了有关该问题的错误报告。

# segmentation-fault - 可以在此函数中使用未初始化的结构分配，然后在运行时进行分段

> ID：15952357
> 
> 赞同：0
> 
> 时间：2013-04-11T15:08:04.777
> 
> 标签：segmentation-fault

我在为结构元素赋值时遇到问题。当我尝试为其赋值时，在编译期间收到上面的警告消息，我收到上面的警告消息。我该如何摆脱它..这只是初始化的问题吗？以及如何在使用之前初始化结构。

我尝试使用警告消息运行它，但出现分段错误错误

C中的新手..请多多包涵

```
struct outrec {
    char *cny_cd;
    char *region_cd;
    char *region_name;
    char *city_name;
    char *postal_code;
    float latitude;
    float longitude;
    int metro_code;
    int area_code;
    char *out_time_zone;
    char *cityrangeip_start;
    char *cityrangeip_end;
    char *orgname;
    int  orgnetmask;
    char *orgrangeip_start;
    char *orgrangeip_end;
    char *isporgname;
    char *domainname;
    int  domainnetmask;
    char *domainrangeip_start;
    char *domainrangeip_end;
};

in the main program i called an instance of it 
```

结构 outrec result_outrec;

```
 printf("Storing values in struct \n" ); 
        strcpy(result_outrec.cny_cd, _mk_NA(gir->country_code));
        strcpy(result_outrec.region_cd, _mk_NA(gir->region));
        strcpy(result_outrec.region_name,_mk_NA(GeoIP_region_name_by_code(gir->country_code, gir->region)));
        strcpy(result_outrec.city_name,_mk_NA(gir->city));
        strcpy(result_outrec.postal_code,_mk_NA(gir->postal_code));
        result_outrec.latitude=gir->latitude;
        result_outrec.longitude=gir->longitude;
        result_outrec.metro_code=gir->metro_code;
        result_outrec.area_code=gir->area_code;
        strcpy(result_outrec.out_time_zone,_mk_NA(time_zone));
        strcpy(result_outrec.cityrangeip_start,(ret[0]));
        strcpy(result_outrec.cityrangeip_end,(ret[1])); 
```

c的新手。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-07T11:50:14.120

如果您在 Google 中输入了警告信息，您会发现 [this](https://stackoverflow.com/questions/12958931/c-warning-x-may-be-used-uninitialized-in-this-function)和[this](https://stackoverflow.com/questions/11618671/jpg-name-may-be-used-uninitialized-in-this-function-werror-uninitialized) question 基本相同，并且有一个非常体面的答案。基本上，您要声明指针，但不要让它们指向实际的内存块（初始化它们），这会导致警告。之后，您将数据复制到它们指向的不存在的内存中，这会导致段错误。

# javascript - 在具体类别中隐藏产品标题

> ID：15952365
> 
> 赞同：-3
> 
> 时间：2013-04-11T15:08:32.630
> 
> 标签：javascript, conditional, opencart

我只想在我的 Opencart 商店中隐藏其中一个类别的产品名称。

名称与以下代码一起显示：

```
html += '<div class="name">' + $(element).find('.name').html() + '</div>'; 
```

我想告诉 javascript 是这样的：

“如果您不属于该路线的类别，请`index.php?route=product/category&path=59`向我显示该行。”。

以便在除 ID 59 的类别之外的所有类别中显示产品名称。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T15:31:20.240

可能是这样的？编辑：

```
 if (window.location.pathname.indexOf("index.php?route=product/category&path=59")<0){
        html += '<div class="name">' + $(element).find('.name').html() + '</div>';
    } 
```

评估错误，因此编辑 - 代码的作用：如果当前地址不包含给定路径执行第二行，请告诉我这是否解决了您的问题；）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-22T20:16:30.847

好吧，我倾向于使用 PHP，而不是使用 JavaScript ......

假设需要隐藏（不显示）产品名称的类别 ID 是`45`；

编辑模板文件`catalog/view/theme/<YOUR_THEME>/template/product/category.tpl`：

*   搜索这样的一行：

`<a href="<?php echo $products[$j]['href']; ?>"><?php echo $products[$j]['name']; ?></a>`

*   用。。。来代替：

```
<?php if($_GET['path'] != 45) { ?>
    <a href="<?php echo $products[$j]['href']; ?>"><?php echo $products[$j]['name']; ?></a>
<?php } ?> 
```

这是使用 just`$_GET`和 manualy 设置`category_id`为的最简单的解决方案`45`。最好以编程方式并从控制器内部进行此设置。

# sql-server - SQL Server中的数据库图很重要吗？

> ID：15952373
> 
> 赞同：-1
> 
> 时间：2013-04-11T15:08:48.453
> 
> 标签：sql-server, diagrams

我有一个包含表格、FK 等的数据库。我还创建了一个图表。当我将表格添加到图表中时，表格会显示其他表格之间的关系。

我想知道哪个是功能或者图表是否有用。我问这个是因为当我创建一个脚本时，如果我在这个脚本中添加表格或新关系，我看不到创建或更新图表的选项。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T15:22:39.123

SQL Server 中的图表功能对 SQL 引擎没有任何帮助。只有当您的流程（或人员）需要它们时，它们才重要。但根据我的经验，大多数数据库都没有初始化图表组件，并且图表在需要时保存在数据库外部。

# asp.net-mvc - 基于部分视图的网站 - Asp.Net MVC 4

> ID：15952374
> 
> 赞同：1
> 
> 时间：2013-04-11T15:08:49.137
> 
> 标签：asp.net-mvc, asp.net-mvc-4, razor-2, asp.net-mvc-partialview

我正在做一个项目，我必须为我处理一些不寻常的设计。我的目标是使用 2 个不同的同时工作区域。左边应该在 2 个不同的局部视图之间改变它的值。第二个（中间和右侧区域）应独立于左侧更改其视图。

所以，最后，我最终得到了 2 个不同的 div，左右一个和 Jqueryiu Tab 插件......单击其中一个标签后，我在其中加载了部分视图。

```
<div id="conteudo">
    <div class="container-abas-laterais">
        <div id="abas-laterais" style="width: 100%; height: 100%">
            <ul>
                <li><a href="@Url.Action("Pendencia", "AcessoRapido")">Pendências</a></li>
                <li><a href="@Url.Action("Requerimento", "AcessoRapido")">Requerimentos</a></li>
            </ul>
        </div>
    </div>

    <div class="container-abas">
        <div id="abas">
            <ul>
                <li><a href="#aba-1">Chamados</a></li>
                <li><a href="#aba-2">Cadastros</a></li>
                <li><a href="#aba-3">Pesquisa</a></li>
                <li><a href="@Url.Action("Index", "Configuracao")">Configuração</a></li>
            </ul>
            <div class="container-abas-conteudo">
                <div id="aba-1">
                    <p>Conteúdo da aba um.</p>
                </div>
                <div id="aba-2">
                    <p>Conteúdo da aba dois.</p>
                </div>
                <div id="aba-3">
                    <p>Conteúdo da aba três.</p>
                </div>                    
            </div>
        </div>
    </div>
</div>

<script type="text/javascript">        
    $(function () { $("#abas").tabs(); });
    $(function () { $("#abas-laterais").tabs(); });
</script> 
```

好吧，直接从选项卡单击加载的部分视图效果非常好，正如我想要的那样......问题是那些初始视图也应该调用的......我需要将所有视图和函数保留在这些 div 中。 ..它应该像一个iFrame ..哇，有时，我在左边做的事情应该发生在右边......

所以我想知道在 asp.net mvc 中实现这种行为的一些技巧或方法。请，如果我的想法令人困惑或不够详细，请告诉我...

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T15:33:12.540

如果我对您的解释正确：您想根据第一组中的链接加载第二组选项卡吗？如果是这样，您的链接将是这样的：

```
@Ajax.ActionLink("Requerimentos", "Requerimento", "AcessoRapido", null, new AjaxOptions{ UpdateTargetId = "aba-1", OnSuccess = "changeTabs(1)" }, null) 
```

链接调用的操作需要返回一个 PartialView 作为您的操作结果。然后在成功返回时，您将看到它在成功时调用了一个函数，您可以在其中将选项卡更改为您想要的选项卡。

```
function changeTabs(index){
    $("#abas").tabs("select", index);
} 
```

如果所有假设都是正确的，请不要忘记您需要在页面中包含不显眼的 ajax 以及 web.config 中的正确键：

```
 <appSettings>
    <add key="UnobtrusiveJavaScriptEnabled" value="true" />
  </appSettings>

<script src="/Scripts/jquery.unobtrusive-ajax.min.js" type="text/javascript"></script> 
```

如果我误解了你的问题，请原谅我。我希望这有帮助。

# mysql - MySQL：更多“where”条件会提高速度吗？

> ID：15952376
> 
> 赞同：1
> 
> 时间：2013-04-11T15:08:51.623
> 
> 标签：mysql

我有一张桌子：

```
ID | Name  | Status 
```

拥有数百万个条目。如果我选择：

```
SELECT * from table where ID = 949442 
```

此查询是否会比此查询更快：

```
SELECT * from table where ID = 949442 AND status = "OPEN" 
```

假设该行可能具有 OPEN 或 CLOSED 状态？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-11T15:12:16.480

通常，仅添加更多`WHERE`条件不会使您的查询更快。例如，有时添加`OR`条件会使事情变慢。通常使用添加更多条件`AND`将使查询更快，即使只是因为结果集更小，因此必须通过线路传输的数据更少。

使查询更快的是当您编写`WHERE`与索引匹配的条件时：
[8.3。优化和索引](http://dev.mysql.com/doc/refman/5.5/en/optimization-indexes.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-11T15:12:46.683

如果`ID`是一个独特的列（看起来是这样），那么额外的约束不太可能以任何可衡量的方式（正面或负面）影响性能。数据库引擎已经可以在 O(log n) 时间内找到该特定行，并且检查您已经找到的行中的列的值是一个 O(1) 操作。

# web-services - 从 cxf Web 服务访问托管 bean

> ID：15952377
> 
> 赞同：1
> 
> 时间：2013-04-11T15:08:52.983
> 
> 标签：web-services, jsf-2, cxf

```
@WebService(endpointInterface = "login")
public class LoginService{
 loginCredentials.login();
 } 
```

公共类登录凭据{

```
@ManagedProperty(name = "applicationBD", value = "#{applicationBD}")
private IApplication applicationBD; //This class is application scoped

    How to access applicationBD in this layer?  

     //facescontext is null while calling this service from SOAP UI
    ServletContext servletContext = (ServletContext)FacesContext.getCurrentInstance().getExternalContext()
            .getContext();
    servletContext.getAttribute("applicationStartupBD");
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T20:24:39.423

我不相信你想做的是明智的，最好的设计。甚至是合法的:)。您可以`ServletContext`从以`WebServiceContext`

1.  将引用注入`WebServiceContext`到您的 SIB

    ```
    @Resource
    WebServiceContext ctxt; 
    ```

2.  从 中`WebServiceContext`，检索`MessageContext`（比之前的上下文更接近于 Web 服务的 SOAP 负载处理结构）。从此，您将获得`ServletContext`

    ```
    MessageContext msgContext = ctxt.getMessageContext();
    ServletContext servletContext = (ServletContext)msgContext.get(MessageContext.SERVLET_CONTEXT);
    IApplication app = (IApplication)  servletContext.getAttribute("applicationStartupBD"); //You can do whatever you please at this point 
    ```

这是推荐的方法吗？不，您已切换依赖项。webapp 应该依赖于 web 服务，而不是相反。IMO，webapp 更容易发生变化，并且是堆栈中的第一层。我建议您坚持两层之间的松散耦合

# php - php会话在导入mysql时冻结整个服务器

> ID：15952381
> 
> 赞同：4
> 
> 时间：2013-04-11T15:08:56.787
> 
> 标签：php, session

标题可能有点奇怪，但我真的无法以任何其他方式描述它。我有以下代码：

```
error_reporting (E_ALL ^ E_NOTICE);

require_once("required/config.php");

$mysqli = new mysqli($db_server, $db_username, $db_password, $db_database);
for ($i = 1; $i < 1001; $i++) {
    if ($insertItem = $mysqli->prepare("INSERT INTO testtable (dummyfield) VALUES (?)")) {
        $insertItem->bind_param('s', $value);

        $value      = "Just some data #$i";

        $insertItem->execute();
        $gebruikersId = $mysqli->insert_id;
        $insertItem->close();

        echo $value . "<br />";
    }
}
$mysqli->close(); 
```

当我运行此代码时，大约需要 20 - 30 秒。没关系。我打开第二个窗口，我可以浏览网站上的所有其他页面。这里没问题。

但是，当我添加**session_start();** 在for循环/导入完成之前，error_reporting其他页面不会加载。

有任何想法吗？我试过谷歌，但找不到任何相关结果。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-11T15:12:05.400

只要一个脚本“使用”会话，会话文件就会被锁定——其他想要使用同一会话的脚本必须等到锁定被释放。

`session_write_close()`通过在长时间运行的脚本中尽早调用来避免这种情况。

# scala - ScalaTest：将命令行参数传递给 ScalaTest maven 目标

> ID：15952384
> 
> 赞同：15
> 
> 时间：2013-04-11T15:09:19.237
> 
> 标签：scala, maven, scalatest

如何使用 Maven 插件将命令行参数传递给 ScalaTest？我一直在寻找类似 TestNG 的配置，但我在[ScalaTest 文档](http://www.scalatest.org/user_guide/using_the_scalatest_maven_plugin)`delegateCommandSystemProperties`中能找到的最接近的是：

*   `argLine`: 指定附加 JVM 选项以传递给分叉进程的选项
*   `environmentVariables`：要传递给分叉进程的附加环境变量
*   `systemProperties`：要传递给分叉进程的附加系统属性

但这不是多余的吗？例如，如果我想通过`environment=development`，我需要在中指定以下内容`pom.xml`：

```
<plugin>
  <groupId>org.scalatest</groupId>
  <artifactId>scalatest-maven-plugin</artifactId>
  <configuration>
    <argLine>-Denvironment=${env}</argLine>
  </configuration>
</plugin> 
```

然后运行`mvn test -Denv=development`。有没有更简单的方法可以直接将命令行参数传递给 ScalaTest？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2015-05-11T07:11:44.017

不需要`<argLine>`在 pom 中定义。但这肯定不直观，也没有很好的记录，只需要在文档中添加一个简单的示例用法即可。

将系统属性传递给 Maven 测试所需的只是：`test -Dsuites=com.company.somepackage.SomeSpec "-DargLine=-Denv=env001 -Dgroup=default -DmaxTests=10"`.

对于`environmentVariables`和`systemProperties`- 必须有一个简单的语法也可以工作。如果有人感兴趣，应该可以通过反复试验或阅读源代码来计算。满足我的需求`argLine`就足够了。

# regex - 如何动态增加或减少视觉块中的数字？

> ID：15952386
> 
> 赞同：1
> 
> 时间：2013-04-11T15:09:30.643
> 
> 标签：regex, vim, numbers

我经常发现自己在数字列表中添加数字。

体育

```
 38
    12 x
   215 x
    98 x
    03 x
    23 
```

我想要做的是选择一个可视的数字块（上例中的 x）并用另一个数字增加或减少数字。

我尝试使用两个宏来做到这一点（我想一个宏是不可能的）：
@a 增加数字 --> 5@a --> 增加每个数字 5 (@a = '^Aj')
@ x 减少数字 --> 5@x --> 减少每个数字 5 (@x = '^Xj')
但是......

我不知道
1）如何仅在我的选择中使用宏（不计算行）
2）如何在不创建全新宏的情况下即时更改增加/减少数量。
3）如何解决这个问题：当我将上述数字加 100 时，数字`12`,`98`和`03`向右移动 1 个字符。

另一种解决方案是创建一个函数，但是每次在输入框中为我必须更改的几个数字添加一个值时，这很复杂。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-11T15:18:59.047

选择所有行后，您可以执行以下操作：

```
:'<,'>norm 5<C-v><C-a> <-- inserts ^A 
```

添加`5`到每个数字。

AFAIK 无法避免对齐问题，是的，vimscript 可能是适合这项工作的工具。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-11T20:31:25.940

增加数字还不错。你有很多选择，但我个人建议使用 Tim Pope 的[快速约会](https://github.com/tpope/vim-speeddating)插件。它将提供一个很好的`<c-a>`视觉模式映射。

但是，如果你想要一个快速而肮脏的映射，你可以去：

```
xnoremap <silent> <c-a> :<c-u>exe "'<,'>norm! ".min([col("'<"),col("'>")]).'<bar>'.v:count1."\<c-a>"<cr> 
```

既然你提到了对齐，你可能还想看看 godlygeek 的[Tabular](https://github.com/godlygeek/tabular)插件。在[vimcasts](http://vimcasts.org)上画了一个[关于使用 tabular 的截屏视频](http://vimcasts.org/episodes/aligning-text-with-tabular-vim/)。

如果您决定制作自己的映射/功能/插件，我还建议您查看以下内容：

```
:h :s
:h /\%V
:h sub-replace-expression
:h printf( 
```

# xcode - 找不到 ShinobiCharts 头文件？

> ID：15952390
> 
> 赞同：1
> 
> 时间：2013-04-11T15:09:57.643
> 
> 标签：xcode, graph, charts, header, shinobi

我正在为我正在制作的应用程序使用 ShinobiCharts 框架，而 Xcode 找不到要使用它的标题。

我按照以下说明包含了框架： [在 Xcode 4 中添加框架](https://stackoverflow.com/questions/6334966/adding-framework-in-xcode-4)

我还尝试将整个文件夹复制到我项目的框架目录中。

这两种方法都无法让我包含这些文件

这是设置指南，我还没有通过第一步： [http ://www.shinobicontrols.com/shinobicharts/quickstartguide/drawing-a-simple-chart/](http://www.shinobicontrols.com/shinobicharts/quickstartguide/drawing-a-simple-chart/)

这是我的代码：

```
#import <UIKit/UIKit.h>
#import <ShinobiCharts/ShinobiChart.h>
#import "SChartDatasource.h"
#import "ShinobiChartsDataSource.h"

@interface ViewController : UIViewController
ShinobiChart * chart;
@end 
```

尽管在设置指南中，但显然 ShinobiChartsDataSource 并不是真实的东西。也只是为了测试，我在框架中导入了一些类似的声音，这也引发了错误。我认为这是一个 XCode 问题。帮助？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T10:35:36.013

`<ShinobiCharts/ShinobiChart.h>`除了这些天，您实际上不需要导入任何东西。快速入门指南看起来已经过时，我相信目前正在更新。

你应该能够做到`<ShinobiCharts/ShinobiChart.h>`。这就是您完成第一步所需的全部导入！

免责声明：我为 Shinobi 团队工作。

# coldfusion - 对带有前导零的数字使用什么条件逻辑？

> ID：15952393
> 
> 赞同：1
> 
> 时间：2013-04-11T15:10:19.133
> 
> 标签：coldfusion, coldfusion-9, cfml

我在带有 Java 1.6.0_22 的 Windows Server 2008 R2 上运行 ColdFusion Enterprise 9.0.1.274733。

我正在调用向我返回各种数据的 SOAP Web 服务。其中一个数据元素包含由带前导零的数字组成的代码。我正在尝试将该代码转换为文本描述，但前导零有问题。我尝试过使用`cfswitch`标签以及带有`cfif`标签的各种东西。他们的行为有点不同。我正在寻找一些关于如何最好地处理这些代码的建议。

以下是描述查找的代码示例：

```
Code     Description
 01      Automobile
 010     Personal Automobile
 011     Commercial Automobile
 02      Home
 03      Boat
 10      Life
 11      Umbrella 
```

我最初尝试使用`cfswitch`块来处理此问题，但发现它将代码视为整数。就目前`cfswitch`而言；`010`等于`10`。我也尝试过使用`cfif`. 它似乎也在比较过程中转换了值。因此，就`cfif`目前而言，情况正好相反。 `10`等于`010`。

大家是怎么处理这个问题的？

这是一些示例代码，显示了正在发生的事情：

```
<html>
    <head><title>Test</title></head>
<body>
    <h3>Test</h3>
    <cfset testvals = "01,010,011,10,11,12" />
    <cfoutput>
    <div>
        <cfloop list="#testvals#" index="testval">
            <p>testval = [#testval#]
            <cfswitch expression="#testval#">
                <cfcase value="01">    <cfset desc="matches 01" />    </cfcase>
                <!---<cfcase value="010">    <cfset desc="matches 010" /></cfcase> --->
                <!---<cfcase value="011">    <cfset desc="matches 011" /></cfcase> --->
                <cfcase value="02">    <cfset desc="matches 02" />    </cfcase>
                <cfcase value="03">    <cfset desc="matches 03" />    </cfcase>
                <cfcase value="04">    <cfset desc="matches 04" />    </cfcase>
                <cfcase value="08">    <cfset desc="matches 08" />    </cfcase>
                <cfcase value="09">    <cfset desc="matches 09" />    </cfcase>
                <cfcase value="10">    <cfset desc="matches 10" />    </cfcase>
                <cfcase value="11">    <cfset desc="matches 11" />    </cfcase>
                <cfcase value="12">    <cfset desc="matches 12" />    </cfcase>
                <cfdefaultcase>        <cfset desc="no match" />    </cfdefaultcase>
            </cfswitch>
            <br />cfswitch: #desc#

            <cfif testval EQ "01">
                <cfset desc="matches 01" />
            <cfelseif testval EQ "010">
                <cfset desc="matches 010" />
            <cfelseif testval EQ "011">
                <cfset desc="matches 011" />
            <cfelseif testval EQ "02">
                <cfset desc="matches 02" />
            <cfelseif testval EQ "03">
                <cfset desc="matches 03" />
            <cfelseif testval EQ "04">
                <cfset desc="matches 04" />
            <cfelseif testval EQ "08">
                <cfset desc="matches 08" />
            <cfelseif testval EQ "09">
                <cfset desc="matches 09" />
            <cfelseif testval EQ "10">
                <cfset desc="matches 10" />
            <cfelseif testval EQ "11">
                <cfset desc="matches 11" />
            <cfelseif testval EQ "12">
                <cfset desc="matches 12" />
            <cfelse>
                <cfset desc="no match" />
            </cfif>
            <br />cfif: #desc#

            <cfif toString(testval) EQ "01">
                <cfset desc="matches 01" />
            <cfelseif toString(testval) EQ "010">
                <cfset desc="matches 010" />
            <cfelseif toString(testval) EQ "011">
                <cfset desc="matches 011" />
            <cfelseif toString(testval) EQ "02">
                <cfset desc="matches 02" />
            <cfelseif toString(testval) EQ "03">
                <cfset desc="matches 03" />
            <cfelseif toString(testval) EQ "04">
                <cfset desc="matches 04" />
            <cfelseif toString(testval) EQ "08">
                <cfset desc="matches 08" />
            <cfelseif toString(testval) EQ "09">
                <cfset desc="matches 09" />
            <cfelseif toString(testval) EQ "10">
                <cfset desc="matches 10" />
            <cfelseif toString(testval) EQ "11">
                <cfset desc="matches 11" />
            <cfelseif toString(testval) EQ "12">
                <cfset desc="matches 12" />
            <cfelse>
                <cfset desc="no match" />
            </cfif>
            <br />tostring: #desc#
            </p>
        </cfloop>
    </div>
    </cfoutput>
</body>
</html> 
```

请注意，我必须注释掉和`cfcase`的值的标签以避免错误。如果那些在然后我得到这个错误：`010``011``cfswitch``Context validation error for the cfcase tag. The cfswitch tag has a duplicate cfcase tag for value 10.0\. The error occurred on line -1.`

以下是示例代码的输出：

```
Test

testval = [01] 
cfswitch: matches 01 
    cfif: matches 01 
tostring: matches 01

testval = [010] 
cfswitch: matches 10     // trying to avoid this
    cfif: matches 010 
tostring: matches 010

testval = [011] 
cfswitch: matches 11     // trying to avoid this
    cfif: matches 011 
tostring: matches 011

testval = [10] 
cfswitch: matches 10 
    cfif: matches 010    // trying to avoid this
tostring: matches 010    // trying to avoid this

testval = [11] 
cfswitch: matches 11 
    cfif: matches 011    // trying to avoid this
tostring: matches 011    // trying to avoid this

testval = [12] 
cfswitch: matches 12 
    cfif: matches 12 
tostring: matches 12 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-11T15:35:46.700

我经常使用`compare()`来避免不希望的隐式转换问题：

```
 <cfif compare("010", testVal) EQ 0>
       matches 010
   </cfif> 
```

但是，如果您只是返回一个值，您是否考虑过使用结构来进行简单的查找呢？

```
 <cfset lookup = { "010"="matches 010", ...} > 
 <cfif structKeyExists(lookup, testVal)>
     do something with #lookup[ testVal ]# ...
 </cfif> 
```

> 因此，就 cfswitch 而言；010 等于 10

**编辑：**这听起来有点马车海事组织。该文档提到了与[vs](http://help.adobe.com/en_US/ColdFusion/9.0/CFMLRef/WSc3ff6d0ea77859461172e0811cbec22c24-7fe5.html)[类似的问题，`0``00`](http://help.adobe.com/en_US/ColdFusion/9.0/CFMLRef/WSc3ff6d0ea77859461172e0811cbec22c24-7fe5.html)并指出它已得到修复。但是 CF 9 中仍然会出现错误。因此您可能需要提交错误报告。

> 值“00”也被评估为值 0。这导致异常“标签 CFCASE 的上下文验证错误。CFSWITCH 有一个重复的 CFCASE 值“0.0”。该标签现在返回预期的结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T19:22:43.307

为什么不直接使用 val() 然后执行 cfswitch ？？？Val() 将从值中删除所有前导零：

```
<cfset a = "010">
<cfset b = val(a)>

<cfdump var="#a#">
<cfdump var="#b#">
<cfdump var="#b eq 10#"> 
```

# java - 将 .jar 转换为 .app

> ID：15952394
> 
> 赞同：0
> 
> 时间：2013-04-11T15:10:19.097
> 
> 标签：java, macos, deployment, app-bundle

尝试使用 App Bundler 将我的 .JAR 转换为 .APP 但文档很难理解。

有人知道任何教程或如何做吗？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2016-05-17T06:57:00.987

**3 步回答肯定有效**

1.在mac中下载并安装netbeans：[https](https://netbeans.org/downloads/) ://netbeans.org/downloads/ for mac

2.在mac的netbeans环境中导入你现有的项目。

3.右键导入项目-->打包为---->选择dmg

**它将使用 .app 文件和应用程序快捷方式创建 dmg 容器**。

# jquery - 禁用按钮

> ID：15952398
> 
> 赞同：0
> 
> 时间：2013-04-11T15:10:25.457
> 
> 标签：jquery, button

当幻灯片中的两个按钮（右/左）到达各自的边界时，我需要帮助来禁用它们 -[小提琴](http://jsfiddle.net/xkUYm/)；将背景颜色和光标类型更改为默认值就足够了。这是 jQuery 代码：

```
var menuItem_place = 0;
var menuItem_position = 0;
var menuItem_limit = parseInt($('.menuItem').length) - 1;

$('.menuItem:first .content').css({margin: 0, height: '100%', lineHeight: '99px'})

$('#rightBtn').on('click', function(){
    if (menuItem_place < menuItem_limit) {
        menuItem_place++;
    }
    menu_animate();
});

$('#leftBtn').on('click', function(){
    if (menuItem_place > 0){
        menuItem_place--;
    }
    menu_animate();
});

var menuitems = $('.menuItem');
var contents = $('.content', menuitems);

menuitems.click(function(){
    menuItem_place = $(this).index();
    menu_animate()
});

function menu_animate() {
    contents.animate({margin: 20, height: '64%', lineHeight: '63px'}, 300);
    $(contents.get(menuItem_place)).stop().animate({margin: 0, height: '100%', lineHeight: '99px'}, 100)
    menuItem_position = 0 - (menuItem_place * 200);
    $('#menuContainer').stop().animate({left: menuItem_position + 'px'}, 300);
} 
```

代码不是我的，超出了我的能力范围。任何帮助，将不胜感激。谢谢。

佩德罗

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T15:22:19.327

只需检查`menuItem_place`它是否为零（第一个元素）或等于`$('.menuItem').length - 1`（最后一个元素）。我创建了一个`.disabled`基于这些条件应用或删除的类 ( )。

**[jsFiddle 示例](http://jsfiddle.net/j08691/xkUYm/2/)**

```
var menuItem_place = 0;
var menuItem_position = 0;
var menuItem_limit = parseInt($('.menuItem').length) - 1;
if (menuItem_place == 0) $('#leftBtn').addClass('disabled'); // <-- NEW
$('.menuItem:first .content').css({
    margin: 0,
    height: '100%',
    lineHeight: '99px'
})

$('#rightBtn').on('click', function () {
    if (menuItem_place < menuItem_limit) {
        menuItem_place++;
    }
    menu_animate();
});

$('#leftBtn').on('click', function () {
    if (menuItem_place > 0) {
        menuItem_place--;
    }
    menu_animate();
});

var menuitems = $('.menuItem');
var contents = $('.content', menuitems);

menuitems.click(function () {
    menuItem_place = $(this).index();
    menu_animate()
});

function menu_animate() {
    contents.animate({
        margin: 20,
        height: '64%',
        lineHeight: '63px'
    }, 300);
    $(contents.get(menuItem_place)).stop().animate({
        margin: 0,
        height: '100%',
        lineHeight: '99px'
    }, 100)
    menuItem_position = 0 - (menuItem_place * 200);
    $('#menuContainer').stop().animate({
        left: menuItem_position + 'px'
    }, 300);
    $('#rightBtn,#leftBtn').removeClass('disabled'); // <-- NEW
    if ($('.menuItem').length - 1 == menuItem_place) $('#rightBtn').addClass('disabled'); // <-- NEW
    if (menuItem_place == 0) $('#leftBtn').addClass('disabled');  // <-- NEW
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T15:14:56.983

我不确定您所说的禁用 2 个按钮是什么意思，但我只能假设您的意思是左右按钮。

我已经更新了您的 jsfiddle 代码，请参见下文。

[http://jsfiddle.net/xkUYm/1/](http://jsfiddle.net/xkUYm/1/)

我所做的只是`display:none`在 css中告诉他们

或者

您可以将它们一起从 HTML 中删除。

# haskell - 为什么我的 Haskell 程序以内存不足错误结束？

> ID：15952400
> 
> 赞同：5
> 
> 时间：2013-04-11T15:10:32.273
> 
> 标签：haskell, memory

我正在尝试编写一个 Haskell 程序来解析巨大的文本文件（大约 14Gb），但我不明白如何让它从内存中释放未使用的数据或在 foldr 期间不使堆栈溢出。下面是程序源：

```
import qualified Data.ByteString.Lazy.Char8 as LBS
import qualified Data.ByteString.Lex.Lazy.Double as BD
import System.Environment

data Vertex = 
    Vertex{
     vertexX :: Double,
     vertexY :: Double,
     vertexZ :: Double}
    deriving (Eq, Show, Read)

data Extent = 
    Extent{
     extentMax :: Vertex,
     extentMin :: Vertex}
    deriving (Eq, Show, Read)

addToExtent :: Extent -> Vertex -> Extent
addToExtent ext vert = Extent vertMax vertMin where
                        (vertMin, vertMax) = (makeCmpVert max (extentMax ext) vert, makeCmpVert min (extentMin ext) vert) where
                            makeCmpVert f v1 v2 = Vertex(f (vertexX v1) (vertexX v2))
                                                        (f (vertexY v1) (vertexY v2))
                                                        (f (vertexZ v1) (vertexZ v2))

readCoord :: LBS.ByteString -> Double
readCoord l = case BD.readDouble l of
                Nothing -> 0
                Just (value, _) -> value

readCoords :: LBS.ByteString -> [Double]
readCoords l | LBS.length l == 0 = []
             | otherwise = let coordWords = LBS.split ' ' l 
                            in map readCoord coordWords

parseLine :: LBS.ByteString -> Vertex
parseLine line = Vertex (head coords) (coords!!1) (coords!!2) where
    coords = readCoords line 

processLines :: [LBS.ByteString] -> Extent -> Extent
processLines strs ext = foldr (\x y -> addToExtent y (parseLine x)) ext strs

processFile :: String -> IO()
processFile name = do
    putStrLn name
    content <- LBS.readFile name
    let (countLine:recordsLines) = LBS.lines content
    case LBS.readInt countLine of
        Nothing -> putStrLn "Can't read records count"
        Just (recordsCount, _) -> do
                                    print recordsCount
                                    let vert = parseLine (head recordsLines)
                                    let ext = Extent vert vert
                                    print $ processLines recordsLines ext

main :: IO()
main = do
        args <- getArgs
        case args of
            [] -> do
                putStrLn "Missing file path"                    
            xs -> do
                    processFile (head xs)
                    return() 
```

文本文件包含用空格字符分隔的三个浮点数的行。该程序总是试图占用计算机上的所有可用内存并因内存不足错误而崩溃。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-11T15:29:57.663

你太懒了。`Vertex`并且`Extent`有非严格的字段，并且你所有的函数都返回一个`Vertex`返回值

```
Vertex thunk1 thunk2 
```

无需强制评估组件。也`addToExtent`直接返回一个

```
Extent thunk1 thunk2 
```

不评估组件。

因此，`ByteString`实际上没有一个 s 会提前释放以进行垃圾收集，因为`Double`尚未从它们中解析出 s。

当通过使`Vertex`和`Extent`严格的字段或返回`Vertex`相应的函数来解决此问题时。`Extent`强制他们输入的所有部分，你遇到的问题是

```
processLines strs ext = foldr (\x y -> addToExtent y (parseLine x)) ext strs 
```

在到达行列表末尾之前无法开始组装结果，因为那时

```
(\x y -> addToExtent y (parseLine x)) 
```

在第二个论点中是严格的。

但是，除了`NaN`s 和 undefined 值，如果我没有遗漏任何东西，如果您使用（严格！）左折叠，结果将是相同的，所以

```
processLines strs ext = foldl' (\x y -> addToExtent x (parseLine y)) ext strs 
```

如果`Vertex`并`Extent`获得严格的字段，则应该在不保留数据的情况下产生所需的结果。

* * *

啊，我确实错过了一些东西：

```
addToExtent ext vert = Extent vertMax vertMin
  where
    (vertMin, vertMax) = (makeCmpVert max (extentMax ext) vert, makeCmpVert min (extentMin ext) 
```

如果这不是一个错字（我所期望的），那么修复它会有些困难。

我认为应该是

```
 (vertMax, vertMin) = ... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-11T15:31:33.720

`addToExtent`太懒了。一个可能的替代定义是

```
addToExtent :: Extent -> Vertex -> Extent
addToExtent ext vert = vertMax `seq` vertMin `seq` Extent vertMax vertMin where
  (vertMin, vertMax) = (makeCmpVert max (extentMax ext) vert, makeCmpVert min (extentMinext) vert) where
    makeCmpVert f v1 v2 = Vertex(f (vertexX v1) (vertexX v2))
                      (f (vertexY v1) (vertexY v2))
                      (f (vertexZ v1) (vertexZ v2))

data Vertex = 
    Vertex{
     vertexX :: {-# UNPACK #-} !Double,
     vertexY :: {-# UNPACK #-} !Double,
     vertexZ :: {-# UNPACK #-} !Double}
    deriving (Eq, Show, Read) 
```

问题是直到整个文件被处理`vertMin`后才`vertMax`被评估 - 导致两个巨大的`Extent`.

我还建议更改`Extent`to的定义

```
data Extent = 
    Extent{
     extentMax :: !Vertex,
     extentMin :: !Vertex}
    deriving (Eq, Show, Read) 
```

（尽管有了这些更改，`seq`调用`addToExtent`变得多余）。

# ios - 根据派生值对 NSArray 进行排序……有问题吗？

> ID：15952401
> 
> 赞同：0
> 
> 时间：2013-04-11T15:10:37.803
> 
> 标签：ios, objective-c, nsarray, nssortdescriptor

我希望能够根据标签值对对象的 NSArray 进行排序。问题是如果标签为 0，我希望它被推到数组的末尾。

```
NSSortDescriptor *sortDescriptor = [[NSSortDescriptor alloc] initWithKey:@"tag" ascending:TRUE];
NSArray *sortDescriptors = [NSArray arrayWithObject:sortDescriptor];

NSArray *sortedArray = [self.array sortedArrayUsingDescriptors:sortDescriptors]; 
```

这将返回索引前面带有标签的所有对象（就像它应该的那样）。

我希望标签值 > 0 位于前面，所有标签值 0 位于末尾。

我虽然块会起作用，类似于：

```
NSArray *sortedArray;
sortedArray = [drinkDetails sortedArrayUsingComparator:^NSComparisonResult(id a, id b) {
    NSDate *first = [(Person*)a birthDate];
    NSDate *second = [(Person*)b birthDate];
    return [first compare:second];
}]; 
```

我[在另一个 SO question](https://stackoverflow.com/questions/805547/how-to-sort-an-nsmutablearray-with-custom-objects-in-it)中找到，但不确定如何添加条件

```
if (obj.tag == 0) {
    // push to end of array
} 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-11T15:19:06.237

您已经找到了比较器块的想法；在那个块中你需要做的就是说一个带有标签 0 的对象在其他任何东西之后排序。

```
sortedArray = [self.array sortedArrayUsingComparator:^NSComparisonResult(id a, id b) {
    NSInteger first = [a tag];
    NSInteger second = [b tag];
    if (first == 0) {
        return (second == 0 ? NSOrderedSame : NSOrderedDescending);
    }
    if (second == 0) {
        return NSOrderedAscending;
    }
    if (first < second) {
        return NSOrderedAscending;
    }
    if (first > second) {
        return NSOrderedDescending;
    }
    return NSOrderedSame;
}]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T19:15:22.220

```
// sort the part without tag = 0
NSPredicate* p = [NSPredicate predicateWithFormat: @"tag != 0"];
NSSortDescriptor* sort = [NSSortDescriptor sortDescriptorWithKey: @"tag" ascending: YES];
NSMutableArray* result = [[[videos filteredArrayUsingPredicate: p]
                           sortedArrayUsingDescriptors: @[ sort ]] mutableCopy];

// append the part with tag = 0;
p = [NSPredicate predicateWithFormat: @"tag = 0"];
[result addObjectsFromArray: [videos filteredArrayUsingPredicate: p]]; 
```

另一种方法，将原始数组拼接成两部分，对没有 0 的部分进行排序，然后将有 0 的部分附加到末尾。

# sql-server - 如何从 SQL Server 维度获取数据到 mongoDB

> ID：15952403
> 
> 赞同：0
> 
> 时间：2013-04-11T15:10:41.070
> 
> 标签：sql-server, mongodb

我试图将我的维度从 SQL 服务器导入 MongoDB，我可以这样做，但是我必须为每个维度编写代码，这有点费时。部分代码：

```
Mongo mongo = new Mongo();
DB db = mongo.getDB("Nelly");
DBCollection facil = db.getCollection("Facilities");   

while (r.next()) {
BasicDBObject facObj = new BasicDBObject();

String faccKey = (r.getString("dim_Facilities_dKey"));
if (faccKey != null && !faccKey.trim().isEmpty()
&& faccKey.length() != 0)
facObj.append("dKey", faccKey);

facil.insert(facObj); 
```

但是我希望能够通过某种循环和列表更快地完成它，但我无法弄清楚如何解决它，我已经尝试了一切！

```
while(r.next()){

for (int i = 1; i < columnCount + 1; i++ ) {

HashMap<String, ArrayList<String>> hashmap =  new HashMap<String, ArrayList<String>>();
ArrayList<String> arr=new ArrayList<String>();       
arr.add(r.getString(i));

BasicDBObject facObj = new BasicDBObject();
String name = rsmd.getColumnName(i);
int varde=1;
String data =r.getString(varde);
varde++;
arr.add(data);

hashmap.put(name, arr);

facObj.append(name, hashmap.values().toString());
facil.insert(facObj); 
```

有人可以给我关于如何继续前进的建议吗？

提前致谢

我解决了它：

```
ResultSet r = s.executeQuery();
ResultSetMetaData rsmd = s.getMetaData();
int columnCount = rsmd.getColumnCount();

while (r.next()) {
BasicDBObject facObj = new BasicDBObject();
for (int i = 1; i < columnCount + 1; i++) {

String name = rsmd.getColumnName(i);

String faccKey = (r.getString(i));
if (faccKey != null && !faccKey.trim().isEmpty() && faccKey.length()!= 0)
facObj.append(name, faccKey); 

}
facil.insert(facObj);} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T21:48:13.580

此类任务通常由 ETL 工具完成，该工具旨在完成此任务，并且可以为您提供更好的性能和可管理性。

问候， 莫西

> ID：15952406
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

# c++ - Performance degradation due to default initialisation of elements in standard containers

> ID：15952412
> 
> 赞同：29
> 
> 时间：2013-04-11T15:11:07.150
> 
> 标签：c++, multithreading, c++11, containers

*(Yes, I know there is a [question](https://stackoverflow.com/questions/7218574/avoiding-default-construction-of-elements-in-standard-containers) with almost the same title, but the answer was not satisfactory, see below)*

*EDIT Sorry, the original question didn't use compiler optimization. This is now fixed, but to avoid trivial optimization and to come closer to my actual use case, the test has been split into two compilation units.*

The fact that the constructor of `std::vector<>` has linear complexity is a nuisance when it comes to performance-critical applications. Consider this simple code

```
// compilation unit 1:
void set_v0(type*x, size_t n)
{
  for(size_t i=0; i<n; ++i)
    x[i] = simple_function(i);
}

// compilation unit 2:
std::vector<type> x(n);                     // default initialisation is wasteful
set_v0(x.data(),n);                         // over-writes initial values 
```

when a significant amount of time is wasted by constructing `x`. The conventional way around this, as explored by [this question](https://stackoverflow.com/questions/96579/stl-vectors-with-uninitialized-storage), seems to be to merely reserve the storage and use `push_back()` to fill in the data:

```
// compilation unit 1:
void set_v1(std::vector<type>&x, size_t n)
{
  x.reserve(n);
  for(size_t i=0; i<n; ++i)
    x.push_back(simple_function(i));
}

// compilation unit 2:
std::vector<type> x(); x.reserve(n);        // no initialisation
set_v1(x,n);                                // using push_back() 
```

However, as indicated by my comment, the `push_back()` is inherently slow, making this second approach actually *slower* than the first one for sufficiently simply constructible objects, such as `size_t`s, when for

```
simple_function = [](size_t i) { return i; }; 
```

I get the following timings (using gcc 4.8 with -O3; clang 3.2 produced ~10% slower code)

```
timing vector::vector(n) + set_v0();
n=10000 time: 3.9e-05 sec
n=100000 time: 0.00037 sec
n=1000000 time: 0.003678 sec
n=10000000 time: 0.03565 sec
n=100000000 time: 0.373275 sec

timing vector::vector() + vector::reserve(n) + set_v1();
n=10000 time: 1.9e-05 sec
n=100000 time: 0.00018 sec
n=1000000 time: 0.00177 sec
n=10000000 time: 0.020829 sec
n=100000000 time: 0.435393 sec 
```

The speed-up actually possible if one could elide the default construction of elements can be estimated by the following cheating version

```
// compilation unit 2
std::vector<type> x; x.reserve(n);          // no initialisation
set_v0(x,n);                                // error: write beyond end of vector
                                            // note: vector::size() == 0 
```

when we get

```
timing vector::vector + vector::reserve(n) + set_v0();          (CHEATING)
n=10000 time: 8e-06 sec
n=100000 time: 7.2e-05 sec
n=1000000 time: 0.000776 sec
n=10000000 time: 0.01119 sec
n=100000000 time: 0.298024 sec 
```

So, my **first question**: Is there any legal way to use a standard library container which would give these latter timings? Or do I have to resort to manage the memory myself?

Now, what I really want, is to use **multi-threading** to fill in the container. The naive code (using openMP in this example for simplicity, which excludes clang for the moment)

```
// compilation unit 1
void set_v0(type*x, size_t n)
{
#pragma omp for                       // only difference to set_v0() from above 
  for(size_t i=0; i<n; ++i)
    x[i] = simple_function(i);
}

// compilation unit 2:
std::vector<type> x(n);               // default initialisation not mutli-threaded
#pragma omp parallel
set_v0(x,n);                          // over-writes initial values in parallel 
```

now suffers from the fact that the default initialization of all elements is not multi-threaded, resulting in an potentially serious performance degradation. Here are the timings for `set_omp_v0()` and a equivalent cheating method (using my macbook's intel i7 chip with 4 cores, 8 hyperthreads):

```
timing std::vector::vector(n) + omp parallel set_v0()
n=10000 time: 0.000389 sec
n=100000 time: 0.000226 sec
n=1000000 time: 0.001406 sec
n=10000000 time: 0.019833 sec
n=100000000 time: 0.35531 sec

timing vector::vector + vector::reserve(n) + omp parallel set_v0(); (CHEATING)
n=10000 time: 0.000222 sec
n=100000 time: 0.000243 sec
n=1000000 time: 0.000793 sec
n=10000000 time: 0.008952 sec
n=100000000 time: 0.089619 sec 
```

Note that the cheat version is ~3.3 times faster than the serial cheat version, roughly as expected, but the standard version is not.

So, my **second question**: Is there any legal way to use a standard library container which would give these latter timings in multi-threaded situations?

**PS.** I found [this question](https://stackoverflow.com/questions/7218574/avoiding-default-construction-of-elements-in-standard-containers), where `std::vector` is tricked into avoiding the default initialization by providing it with a `uninitialized_allocator`. This is no longer standard compliant, but works very well for my test case (see my own answer below and [this question](https://stackoverflow.com/questions/15967293/how-to-make-my-uninitialised-allocator-safe) for details).

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-04-11T15:48:08.413

使用 g++ 4.5，通过使用生成器直接构造，我能够实现从 v0（1.0s 到 0.8s）的运行时间减少大约 20% 并且从 v1 的 0.95s 到 0.8s 稍微减少一点：

```
struct Generator : public std::iterator<std::forward_iterator_tag, int>
{
    explicit Generator(int start) : value_(start) { }
    void operator++() { ++value_; }
    int operator*() const { return value_; }

    bool operator!=(Generator other) const { return value_ != other.value_; }

    int value_;
};

int main()
{
    const int n = 100000000;
    std::vector<int> v(Generator(0), Generator(n));

    return 0;
} 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-04-12T08:41:31.320

好的，这是我问这个问题后学到的。

**Q1**（*是否有任何合法的方法可以使用标准库容器来提供后面的时间？*）在某种程度上**是的，如 Mark 和 Evgeny 的回答所示。**向构造函数提供生成器的方法`std::vector`省略了默认构造。

**Q2**（*是否有任何合法的方法可以使用标准库容器来在多线程情况下提供这些后一种计时？*）**不**，我不这么认为。原因是在构造时，***任何符合标准的容器都必须初始化其元素***，以确保对元素析构函数的调用（在容器的销毁或调整大小时）格式正确。由于 std 库容器不支持使用多线程来构造它们的元素，所以这里不能复制*Q1的技巧，所以我们不能省略默认构造。*

因此，如果我们想**使用 C++ 进行高性能计算**，在管理大量数据时，我们的选择会受到一定限制。我们可以

**1**声明一个容器对象，并在同一个编译单元中立即填充它（同时），当编译器希望优化构造时的初始化时；

**2**诉诸`new[]`and`delete[]`甚至`malloc()`and `free()`，当所有的内存管理，在后一种情况下，元素的构造是我们的责任，我们对 C++ 标准库的潜在使用非常有限。

**3**技巧 a不使用省略默认构造`std::vector`的自定义来初始化其元素。**`unitialised_allocator`**遵循[Jared Hoberock的](https://stackoverflow.com/users/722294/jared-hoberock)[想法](https://stackoverflow.com/questions/7218574/avoiding-default-construction-of-elements-in-standard-containers)，这样的分配器可能如下所示（另请参见[此处](https://stackoverflow.com/questions/15967293/how-to-make-my-uninitialised-allocator-safe)）：

```
// based on a design by Jared Hoberock
// edited (Walter) 10-May-2013, 23-Apr-2014
template<typename T, typename base_allocator = std::allocator<T> >
struct uninitialised_allocator
  : base_allocator
{
  static_assert(std::is_same<T,typename base_allocator::value_type>::value,
                "allocator::value_type mismatch");

  template<typename U>
  using base_t =
    typename std::allocator_traits<base_allocator>::template rebind_alloc<U>;

  // rebind to base_t<U> for all U!=T: we won't leave other types uninitialised!
  template<typename U>
  struct rebind
  {
    typedef typename
    std::conditional<std::is_same<T,U>::value,
                     uninitialised_allocator, base_t<U> >::type other; 
  }

  // elide trivial default construction of objects of type T only
  template<typename U>
  typename std::enable_if<std::is_same<T,U>::value && 
                          std::is_trivially_default_constructible<U>::value>::type
  construct(U*) {}

  // elide trivial default destruction of objects of type T only
  template<typename U>
  typename std::enable_if<std::is_same<T,U>::value && 
                          std::is_trivially_destructible<U>::value>::type
  destroy(U*) {}

  // forward everything else to the base
  using base_allocator::construct;
  using base_allocator::destroy;
}; 
```

然后`unitialised_vector<>`可以像这样定义模板：

```
template<typename T, typename base_allocator = std::allocator<T>>
using uninitialised_vector = std::vector<T,uninitialised_allocator<T,base_allocator>>; 
```

我们仍然可以使用几乎所有标准库的功能。虽然必须说 ，`uninitialised_allocator`因此暗示`unitialised_vector`不符合标准，因为它的元素不是默认构造的（例如 a`vector<int>`不会`0`在构造后全部具有）。

当使用这个工具来解决我的小测试问题时，我得到了很好的结果：

```
timing vector::vector(n) + set_v0();
n=10000 time: 3.7e-05 sec
n=100000 time: 0.000334 sec
n=1000000 time: 0.002926 sec
n=10000000 time: 0.028649 sec
n=100000000 time: 0.293433 sec

timing vector::vector() + vector::reserve() + set_v1();
n=10000 time: 2e-05 sec
n=100000 time: 0.000178 sec
n=1000000 time: 0.001781 sec
n=10000000 time: 0.020922 sec
n=100000000 time: 0.428243 sec

timing vector::vector() + vector::reserve() + set_v0();
n=10000 time: 9e-06 sec
n=100000 time: 7.3e-05 sec
n=1000000 time: 0.000821 sec
n=10000000 time: 0.011685 sec
n=100000000 time: 0.291055 sec

timing vector::vector(n) + omp parllel set_v0();
n=10000 time: 0.00044 sec
n=100000 time: 0.000183 sec
n=1000000 time: 0.000793 sec
n=10000000 time: 0.00892 sec
n=100000000 time: 0.088051 sec

timing vector::vector() + vector::reserve() + omp parallel set_v0();
n=10000 time: 0.000192 sec
n=100000 time: 0.000202 sec
n=1000000 time: 0.00067 sec
n=10000000 time: 0.008596 sec
n=100000000 time: 0.088045 sec 
```

当作弊版本和“合法”版本之间不再有区别时。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-04-11T20:20:39.637

# `boost::transformed`

对于单线程版本，您可以使用[`boost::transformed`](http://www.boost.org/libs/range/doc/html/range/reference/adaptors/reference/transformed.html). 它有：

> 返回范围类别：rng的范围类别。

这意味着，如果您愿意`Random Access Range`，`boost::transformed`它会返回`Random Access Range`，这将允许`vector`' 的构造函数预先分配所需的内存量。

您可以按如下方式使用它：

```
const auto &gen = irange(0,1<<10) | transformed([](int x)
{
    return exp(Value{x});
});
vector<Value> v(begin(gen),end(gen)); 
```

# [**现场演示**](http://liveworkspace.org/code/1rrboy%241)

```
#define BOOST_RESULT_OF_USE_DECLTYPE 
#include <boost/range/adaptor/transformed.hpp>
#include <boost/container/vector.hpp>
#include <boost/range/irange.hpp>
#include <boost/progress.hpp>
#include <boost/range.hpp>
#include <iterator>
#include <iostream>
#include <ostream>
#include <string>
#include <vector>
#include <array>

using namespace std;
using namespace boost;
using namespace adaptors;

#define let const auto&

template<typename T>
void dazzle_optimizer(T &t)
{
    auto volatile dummy = &t; (void)dummy;
}

// _______________________________________ //

using Value = array<int,1 << 16>;
using Vector = container::vector<Value>;

let transformer = [](int x)
{
    return Value{{x}};
};
let indicies = irange(0,1<<10);

// _______________________________________ //

void random_access()
{
    let gen = indicies | transformed(transformer);
    Vector v(boost::begin(gen), boost::end(gen));
    dazzle_optimizer(v);
}

template<bool reserve>
void single_pass()
{
    Vector v;
    if(reserve)
        v.reserve(size(indicies));
    for(let i : indicies)
        v.push_back(transformer(i));
    dazzle_optimizer(v);
}

void cheating()
{
    Vector v;
    v.reserve(size(indicies));
    for(let i : indicies)
        v[i]=transformer(i);
    dazzle_optimizer(v);
}

// _______________________________________ //

int main()
{
    struct
    {
        const char *name;
        void (*fun)();
    } const tests [] =
    {
        {"single_pass, no reserve",&single_pass<false>},
        {"single_pass, reserve",&single_pass<true>},
        {"cheating reserve",&cheating},
        {"random_access",&random_access}
    };
    for(let i : irange(0,3))
        for(let test : tests)
            progress_timer(), // LWS does not support auto_cpu_timer
                (void)i,
                test.fun(),
                cout << test.name << endl;

} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-12-30T08:14:50.343

在这种情况下，我实际上会建议推出您自己的容器或寻找替代品，因为按照我的看法，您的固有问题不在于标准容器的默认构造元素。这是尝试为容量可以在构造时确定的容器使用可变容量容器。

没有标准库不必要地默认构造元素的情况。`vector`仅对其填充构造函数和 这样做`resize`，这两者在概念上都是通用容器所必需的，因为它们的目的是调整容器的大小以包含有效元素。同时，这样做很简单：

```
T* mem = static_cast<T*>(malloc(num * sizeof(T)));
for (int j=0; j < num; ++j)
     new (mem + j) T(...); // meaningfully construct T
...
for (int j=0; j < num; ++j)
     mem[j].~T();         // destroy T
free(mem); 
```

...然后从上面的代码中构建一个异常安全的符合 RAII 的容器。这就是我在您的情况下的建议，因为如果默认构造浪费到足以在填充构造函数上下文中不可忽略到替代`reserve`和`push_back`或`emplace_back`同样不足的程度，那么即使是容器也可能将其容量和大小视为变量是不可忽略的开销，此时您完全有理由寻找其他东西，包括从上面的概念中滚动您自己的东西。

标准库非常高效，因为它在苹果与苹果的比较中难以匹配，但在这种情况下，您需要的是橙子而不是苹果。在这种情况下，直接伸手去拿一个橙子比试图把一个苹果变成一个橙子变得更容易了。

# knockout.js - How to create a custom Knockout binding that augments the native value binding

> ID：15952421
> 
> 赞同：3
> 
> 时间：2013-04-11T15:11:26.763
> 
> 标签：knockout.js

I'm creating a custom binding that sets up focus and blur behavior in the init method. Otherwise, I'd like this custom binding to operate exactly like the native Knockout value binding.

```
 ko.bindingHandlers.currencyValue = {

init: function (element, valueAccessor) {
    $(element).focus(function () {
        //focus behavior here...
    });

    $(element).blur(function () {
        //blur behavior here...
    });

   //what do I put here to get the native value binding behavior?
},
update: function (element, valueAccessor) {
    //what do I put here to get the native value binding behavior?
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T15:19:29.033

你应该调用`ko.bindingHandlers.value.init`和`ko.bindingHandlers.value.update`函数：

```
ko.bindingHandlers.currencyValue = {
init: function (element, valueAccessor, allBindings, viewModel, context) {
    $(element).focus(function () {
        //focus behavior here...
    });

    $(element).blur(function () {
        //blur behavior here...
    });

   return ko.bindingHandlers.value.init(element, valueAccessor, allBindings, viewModel, context);
},
update: function (element, valueAccessor, allBindings, viewModel, context) {
    return ko.bindingHandlers.value.update(element, valueAccessor, allBindings, viewModel, context);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-09-27T16:57:10.377

一个比**[@Artem](https://stackoverflow.com/a/15952625/3345644)****的****解决方案更易于维护和可读的解决方案**- 以防有一天 KO 将额外的参数传递给`init`and`update`函数并且需要更少的击键：

```
ko.bindingHandlers.currencyValue = {
init: function (element, valueAccessor, allBindings, viewModel, context) {
    $(element).focus(function () {
        //focus behavior here...
    });

    $(element).blur(function () {
        //blur behavior here...
    });

   return ko.bindingHandlers.value.init.apply(this, arguments);
},
update: function (element, valueAccessor, allBindings, viewModel, context) {
    return ko.bindingHandlers.value.update.apply(this, arguments);
} 
```

# javascript - Javascript - change SQL datetime format

> ID：15952425
> 
> 赞同：0
> 
> 时间：2013-04-11T15:11:41.753
> 
> 标签：javascript, sql, datetime, format

I'm still new to programming, and am having trouble converting this date. I'm using ajax with a chat application, and pull the date from SQL Server database record but can't seem to convert it. The line of code getting the date is simply:

```
var timeStart = results.d[i].CreateDate; 
```

the result I get is: /Date(1365692153250)/

I tried adding 'new Date( )' before, and/or '.format(MMMM ...)' after. This is probably an easy one, but I've looked all over. Please let me know if any additional info is needed. Thanks.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T15:16:02.173

我认为这个问题和答案会对您有所帮助： [Convert a Unix timestamp to time in JavaScript](https://stackoverflow.com/questions/847185/convert-a-unix-timestamp-to-time-in-javascript)

你只需要转换你的时间戳。

祝你好运。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-11T15:16:12.420

您将需要构造 a`Date()`并使用 getter 来构建格式。 [https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Date](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Date)

对于传递格式，您需要包含自己的库，这是生成它的一种解决方案：http: [//blog.stevenlevithan.com/archives/date-time-format](http://blog.stevenlevithan.com/archives/date-time-format)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-18T15:46:27.643

感谢@mattmanser 的这个线程，它回答了我的问题......[将.NET DateTime 转换为 JSON](https://stackoverflow.com/questions/1016847/converting-net-datetime-to-json)

解决方案：

```
var timeStart = results.d[i].CreateDate.replace(/\/Date\((-?\d+)\)\//, '$1');
var d = new Date(parseInt(timeStart)); 
```

我讨厌“回答我自己的问题”，但想为可能需要它的其他人提供解决方案。

# java - JPanel 上的组件不显示

> ID：15952439
> 
> 赞同：1
> 
> 时间：2013-04-11T15:12:18.157
> 
> 标签：java, swing, jpanel, paintcomponent, preferredsize

我创建了一个 JPanel 并对其进行了一些修改。我将它的背景更改为渐变色，这里是类。

```
public class JGradientPanel extends JPanel {
     private static final int N = 32;
     private Color color1, color2;
        public JGradientPanel(Color color1, Color color2) {
            this.setBorder(BorderFactory.createEmptyBorder(N, N, N, N));

            this.color1 = color1;
            this.color2 = color2;
        }

        @Override
        public void paintComponent(Graphics g) {
            super.paintComponent(g);
            Graphics2D g2d = (Graphics2D) g;
            //Color color1 = getBackground();
            //Color color2 = color1.darker();
            int w = getWidth();
            int h = getHeight();
            GradientPaint gp = new GradientPaint(
                0, 0, color1, 0, h, color2);
            g2d.setPaint(gp);
            g2d.fillRect(0, 0, w, h);
        }
} 
```

现在我在面板中添加了一些组件，但它没有显示任何内容，这是代码

```
public JPanel getMenu() {
        JGradientPanel menu = new JGradientPanel(Color.WHITE, Color.white.darker());
        int menuHeight = (int) ((int) getHeight() * 0.07);
        menu.setPreferredSize(new Dimension(screenWidth,menuHeight));
        menu.setLayout(new GridLayout(1,10));
        menu.setBackground(Color.LIGHT_GRAY);

        //test
        JGradientButton test = new JGradientButton("test",Color.GREEN, Color.BLUE);
        menu.add(test);

        JLabel space = new JLabel(); // first blank space on the menu
        space.setBounds(0, 0, menu.getPreferredSize().width - 50, menu.getPreferredSize().height);
        space.setBorder(BorderFactory.createMatteBorder(0, 0, 0, 1, Color.GREEN));
        menu.add(space);
        JLabel moreSpaces[] = new JLabel[6];
        buttons = new JButton[buttonLabels.length];
        for(int counter = 0; counter < moreSpaces.length + buttonLabels.length; counter ++ ) {
            if(counter < 3) {
                buttons[counter] = new JButton(buttonLabels[counter]); //menu buttons

            } else {
                moreSpaces[counter - 3] = new JLabel(); // the rest of the blank in the menu
            }
        }
        // adding components to menu panel
        for(int counter = 0; counter < moreSpaces.length + buttonLabels.length; counter ++){
            if(counter < 3) {
                buttons[counter].setFocusPainted(false);
                menu.add(buttons[counter]); 
            } else {
                menu.add(moreSpaces[counter - 3]);
            }

        }
        return menu;
    } 
```

我错过了什么或者我做错了吗？我的代码有什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T15:19:31.177

*   覆盖[`getPreferredSize`](https://stackoverflow.com/a/11071471/714968)_`public class JGradientPanel extends JPanel {`

*   `public void paintComponent(Graphics g) {`默认情况下在 Swing 中绘画永远不会将PreferredSize[返回](http://docs.oracle.com/javase/tutorial/2d/index.html)[到 JPanel](http://docs.oracle.com/javase/tutorial/uiswing/components/panel.html)，

*   `JPanel`返回`Dimension[0, 0];`

编辑

*   看到[关于 GradientPaint 的非常有用和有趣的线程](https://stackoverflow.com/questions/13748810/gradient-problems-in-java)

# python - 如何维护 PhotoImage 对象的多个引用

> ID：15952445
> 
> 赞同：1
> 
> 时间：2013-04-11T15:12:32.277
> 
> 标签：python, python-2.7, tkinter

我正在尝试在我的 Text 小部件中显示两个图像对象。最初，两个对象都显示为空图像。经过一番研究，我了解到我需要保留对图像的引用。我在我的代码中添加了额外的一行。我现在看到第二张图像正确显示，但是第一张图像仍然是空白的。

我怀疑我的“参考”在 for 循环期间被覆盖了。是这样吗？如果是这样，如果我需要在 Text 小部件中显示多个图像对象，我将如何维护多个引用？

到目前为止，这是我的代码：

```
from Tkinter import *
from PIL import Image, ImageTk
import os

class TestApp:
    def __init__(self, parent):
        self.myParent = parent
        self.main_container = Frame(parent)
        self.main_container.pack()

        self.text_box = Text(self.main_container, height=50, width=80)
        self.text_box.pack()

        image_names = ['img1.jpg', 'img2.jpg']

        for name in image_names:
            img = Image.open(os.getcwd() + '\\' + name)
            img_obj = ImageTk.PhotoImage(img)
            self.text_box.image_create(INSERT, image=img_obj)
            self.text_box.insert(END, "\n")
            # Added this extra reference
            self.text_box.image = img_obj

root = Tk()
root.title("This is a test app")
mainapp = TestApp(root)
root.mainloop() 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T17:50:30.200

是的，您的参考资料正在被覆盖。

最简单的可能是将引用添加到列表中。例如：

```
class TestApp:
    def __init__(...):
        ...
        self.images = []
        ...
        for name in image_names:
            ...
            img_obj = ImageTk.PhotoImage(img)
            self.images.append(img_obj) 
```

# c# - How to mark quantity to invoice on Purchase Order Line? Can I use 'Finished' field?

> ID：15952446
> 
> 赞同：1
> 
> 时间：2013-04-11T15:12:35.950
> 
> 标签：c#, web-services, navision, dynamics-nav

I am trying to count `Qty_to_invoice` in `Purchase_Order_Line`, but the value of this field is 0 at the very beginning, so I have to initialize it with Purchase Order Line's `Quantity` field. Problem is when it goes back to 0\. How can I mark that all the invoices for this line are received?

I have found 'Finished' field in the Purchase_Order_Line, but I am not sure if I can use it. Can I? Can I? I am not sure what the system will use it for later...

Or just point me to the API documentation, if there is any, please. Something with description of all this fields would be great to read.

//ETDI: I use Web Services(Page) to access NAV.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T09:32:50.887

> 但是这个字段的值一开始是0，所以我要初始化它

我猜不出你到底想用采购线做什么，但是像数量这样的字段。到发票和数量。在大多数情况下接收验证数量时自动填写。两个集合都等于 Quantity。当用户通过调用在表单上或从 C/AL 代码中输入内容时验证触发器`PurcaseLine.VALIDATE("Quantyity", number);`

> 问题是当它回到 0 时。如何标记该行的所有发票都已收到？

当您过帐发票时，过帐数量会添加到字段中`Qty. Invoiced`，而收到的数量会添加到字段中`Qty. Received`。因此，您随时都知道收到和支付了多少物品。*这两个字段对用户都是只读的，因为只有过帐程序才能并且必须更改它们。*

所以如果你有数量。= 10，然后您发布其中的 4 个（数量到发票 = 4）和数量。已开票 = 0。您将获得数量。= 10，数量。到发票 = 6，数量。已开票 = 4。数量。在这种情况下，发票是剩余的数量。要开发票。

如果您不知道它们的用途，则不应使用任何字段。例如，“已完成”字段是生产订单功能的一部分，与数量无关。发票。

要找出字段的含义，您可以参考帮助（站在表格中的字段上按 F1）。这并不适用于所有领域。另一种方法（如果您是开发人员并拥有许可证）是使用开发人员工具包（可以在安装 CD 或[此处找到](http://www.mibuso.com/dlinfo.asp?FileID=1107 "这里")）。此实用程序允许搜索导航对象之间的依赖关系。

* * *

关于网络服务。不要尝试直接使用这些表。它确实造成了很多麻烦和不便。创建新的操作表。命名它们`Purchase Order Import`和`Purchase Line Import`. 为他们创建页面并作为网络服务发布。以任何您喜欢的格式将您的数据导入其中。我的意思是这些表可以是真实表的克隆，或者只是您需要的几个字段。将一些代码放入`OnModify`页面的触发器中，这些代码将在导入结束时调用或发布代码单元，其功能将创建或更新来自导入表的采购订单和行。毕竟清除导入表。

如果您的任务是根据外部系统的数量部分过帐收据，那么您的步骤将是：

1.  假设已创建采购订单和行，数量为 100，您需要分批发布此数量
2.  导入数量通过网络服务发布到采购行导入表通过页面
3.  将触发页面的 OnModify，将一些代码放入该触发器以更新 Purchase Line 的`Qty. to Invoice` **-**或 -通过 Web 服务调用一些代码单元并更新 Purchase Line 的`Qty. to Invoice`。将所有关于创建和更新采购线的业务逻辑放在此处，而不是在您的外部应用程序中。
4.  现在您有数量 = 100，发票数量 = 5。
5.  通过网络服务调用发布代码单元。当然不要发布发布代码单元本身。通过另一个发布的代码单元调用它。
6.  现在您有 Qty = 100，Qty to Invoice = *don't really care*，Invoiced Qty = 5，您可以再次重复步骤 2-5。

您不应该关心发票数量，这就是为什么：下次您导入数量的下一部分时，您需要检查的是 Import_Qty < (Qty - Invoiced Qty)。如果是真的你可以发帖，否则你不能。

# hadoop - How do I force a reducer in cascading?

> ID：15952448
> 
> 赞同：1
> 
> 时间：2013-04-11T15:12:37.280
> 
> 标签：hadoop, mapreduce, cascading

To gain some of the benefits only possible with reducers and not mappers.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-06T13:52:37.440

在 Google Groups 中找到了我的答案：

在执行分组时使用`GroupBy`which invariable 将使用 reducer：

```
previousPipe = new GroupBy(previousPipe); //this does a Group on Fields.All 
```

减少文件数量（另一种耦合较少的替代方案）

```
previousPipe = new GroupBy(previousPipe, new Fields("rand"), 
               new RandonNumGen(Fields.Args)); 
```

其中 new RandonNumGen(Fields.Args) 是您构建的一个函数，`Function`用于创建一个新的 Fields("rand") 来创建临时随机数（临时意味着您稍后删除该字段）。

有关更多信息，请查看此[Google Groups](https://groups.google.com/forum/?hl=en&fromgroups=#!topic/cascading-user/_wI55ppa5zE)线程：

# java - 用两个字符串计算，Android

> ID：15952449
> 
> 赞同：1
> 
> 时间：2013-04-11T15:12:37.497
> 
> 标签：java, android, string, integer

我正在尝试使用 Eclipse 为 Android 创建一个计算器。这是我的函数“cal”的代码，单击按钮时会执行“cal”，但是单击按钮会关闭应用程序，我尝试了另一个具有不同功能的按钮，它工作正常。谁能指出我犯的错误？

```
 public void cal( View view ){
            EditText op = (EditText) findViewById(R.id.editText2);
            EditText n1 = (EditText) findViewById(R.id.editText1);
            EditText n2 = (EditText) findViewById(R.id.editText3);
            EditText res = (EditText) findViewById(R.id.textView1);

             String sn1 = n1.getText().toString();
             String sn2 = n2.getText().toString();
             String sres;
             String sop;

            int in1 = Integer.parseInt(sn1);
            int in2 = Integer.parseInt(sn2);
            int ires;

                 sop = op.getText().toString();
                     if(sop == "+"){
                                  ires = in1 + in2;
                                  sres = Integer.toString(ires);
                                  res.setText(sres);

        }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T15:16:03.133

这一点也不例外。

我认为您忘记设置导致应用程序强制关闭的活动布局。

或者

问题在这里

```
EditText res = (EditText) findViewById(R.id.textView1); 
```

您确定您的 editText 名称`textView1`在您的布局中。

如果它是 textView 然后这样做。

```
TextView res = (TextView) findViewById(R.id.textView1); 
```

# xml - XSLT & XPath very complex data transformation

> ID：15952453
> 
> 赞同：0
> 
> 时间：2013-04-11T15:12:43.967
> 
> 标签：xml, xslt, serialization, xpath

I am working on something where data is delivered in various XML formats, and although I can figure out most of the pieces of how to parse it, I do not know enough about XSLT and XPath to know where to begin putting together this type of multiple transform, where some data is obviously just looked up, some data is repeating, elements have to be renamed, some data is in attributes and some in values, and templates probably have to be processed in specific order or be called with variables. I don't think there is this type example present here, and if we could get one, it might solve a lot of issues for people.

The goal is to take input from several sources which provide similar data in different forms, translate them to a common XML form, and write only ONE (1) progam processing path, instead of the four (4) that we now have to maintain. Also, the translation should be easy to deserialize.

Any way, here is a fair example of an INPUT file:

```
<?xml version="1.0" encoding="utf-8"?>
<PackageName TransmissionID="0792d49a-c09b-4094-9f4e-2357a042865c">
  <Version>1.0</Version>
  <DateReported>04/12/2010</DateReported>
  <TimeReported>10:16:46.9385105</TimeReported>
  <!-- Status=Disposition -->
  <ReportPackage Status="Disposition1">
    <Addresses>
      <Address>
        <!-- PersonAddress -->
        <Name>Stephen Stipulate</Name>
        <Address>1200 Any Street</Address>
        <City>Some City</City>
        <State>XX</State>
        <Zip>12345</Zip>
        <Phone>800-555-1212</Phone>
      </Address>
    </Addresses>
    <Parts packageID="APackageId">
      <packageClientAccount>00000000</packageClientAccount>
      <DiscardedIdentifier id="NothingOfInterest">
        <AssemblyId>
          <IdValue>0547224801-0908</IdValue>
        </AssemblyId>
        <!-- Status -->
        <AssemblyStatus>
          <Status>OutOfStock</Status>
          <DateReOrderReceived>2009-09-24T06:09:00</DateReOrderReceived>
        </AssemblyStatus>
        <PartVendor>
          <!-- VendorAddress -->
          <VendorName>Roger Refactor</VendorName>
          <VendorAddress>
            <IdValue name="Address">100 An Avenue Suite 13</IdValue>
            <IdValue name="City">A Different City</IdValue>
            <IdValue name="State">YY</IdValue>
            <IdValue name="Zip">54321</IdValue>
            <IdValue name="Phone">866-555-1212</IdValue>
          </VendorAddress>
        </PartVendor>
        <PartsMainSegment>
          <AdditionalSegment>
            <PartSpecs>
              <Spec>
                <PartId>123456</PartId>
                <Name>Widget1</Name>
                <ThresholdLevel>000500</ThresholdLevel>
              </Spec>
              <Spec>
                <PartId>234567</PartId>
                <Name>Widget2</Name>
                <ThresholdLevel>000200</ThresholdLevel>
              </Spec>
            </PartSpecs>
          </AdditionalSegment>
        </PartsMainSegment>
        <AdditionallPartsSegment>
          <Spec>
            <PartId>123456</PartId>
            <PartType>ABC</PartType>
          </Spec>
          <Spec>
            <PartId>234567</PartId>
            <PartType>CBA</PartType>
          </Spec>
        </AdditionallPartsSegment>
        <AdditionalItems type="RawData" qualifier="mode" vendor="rogerRefactor">
          <Text>AModeValue</Text>
        </AdditionalItems>
        <AdditionalItems type="RawData" qualifier="indicator" vendor="rogerRefactor">
          <Text>AnIndicator</Text>
        </AdditionalItems>
      </DiscardedIdentifier>
    </Parts>
  </ReportPackage>
</PackageName> 
```

And the desired OUTPUT file:

```
<?xml version="1.0" encoding="utf-8"?>
<Package>
  <TransmissionID>0792d49a-c09b-4094-9f4e-2357a042865c</TransmissionID>
  <PackageType>PackageName</PackageType>
  <Version>1.0</Version>
  <DateReported>1/03/2011</DateReported>
  <TimeReported>16:25:35.1293170</TimeReported>
  <Disposition>Disposition1</Disposition>>
  <packageID>APackageId</packageID>
  <packageClientAccount>00000000</packageClientAccount>
  <Addresses>
    <PersonAddress>
      <Name>Stephen Stipulate</Name>
      <Address>1200 Any Street</Address>
      <City>Some City</City>
      <State>XX</State>
      <Zip>12345</Zip>
      <Phone>800-555-1212</Phone>
    </PersonAddress>
    <VendorAddress>
      <Name>Roger Refactor</Name>
      <Address>100 An Avenue Suite 13</Address>
      <City>A Different City</City>
      <State>YY</State>
      <Zip>54321</Zip>
      <Phone>866-555-1212</Phone>
    </VendorAddress>
  </Addresses>
  <Parts>
    <AssemblyId id="0547224801-0908">
      <Status>OutOfStock</Status>
      <DateReOrderReceived>2009-09-24T06:09:00</DateReOrderReceived>
      <Part>
        <PartId>123456</PartId>
        <PartName>Widget1</PartName>
        <Level>000500</Level>
        <PartType>ABC</PartType>
      </Part>
      <Part>
        <PartId>234567</PartId>
        <PartNameName>Widget2</PartNameName>
        <Level>000200</Level>
        <PartType>CBA</PartType>
      </Part>
    </AssemblyId>
  </Parts>
  <AdditionalData>
    <Vendor>TheVendor</Vendor>
    <Mode>AModeValue</Mode>
    <Indicator>AnIndicator</Indicator>
  </AdditionalData>
</Package> 
```

We actually get XML similar to this reporting to a web service. Notice the required re-names, movement of data to different parts of the tree, and also in particular the different segments which have to be joined to make a list of part records, which do not have a parent/child relation. I am not offering any bad starting attempt, as I am at a loss as to where to start on this since I simply don't understand how to sequence the processing, and I am certain that somebody out there (Dimitre!), while not on purpose, would make me look like an idiot! :)

Well thanks for any and all help - cheers! :)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T21:26:27.183

像这样的东西非常简单，主要是编写一个模板并使用 XPath 选择器从 XML 树中提取信息。

目前尚不清楚某些项目是否可以多次出现 -`VendorAddress`例如 - 但这种转换至少会根据您提供的输入创建您需要的输出。

有一个问题`Package/AdditionalData/Vendor`，正如您所说，您想要一个 的值，`TheVendor`但此字符串未出现在源数据中。我已经从`PartVendor/VendorName`. 也没有任何东西可以将该名称与 的`vendor="rogerRefactor"`属性联系起来`AdditionalItems`，但我相信你会得到这些东西的排序。

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">

    <xsl:output method="xml" indent="yes" encoding="UTF-8"/>
    <xsl:strip-space elements="*"/>

    <xsl:template match="/PackageName">
        <Package>
            <TransmissionID><xsl:value-of select="@TransmissionID"/></TransmissionID>
            <PackageType>PackageName</PackageType>
            <xsl:copy-of select="Version"/>
            <xsl:copy-of select="DateReported"/>
            <xsl:copy-of select="TimeReported"/>
            <Disposition><xsl:value-of select="ReportPackage/@Status"/></Disposition>
            <packageID><xsl:value-of select="ReportPackage/Parts/@packageID"/></packageID>
            <packageClientAccount><xsl:value-of select="ReportPackage/Parts/packageClientAccount"/></packageClientAccount>
            <Addresses>
                <PersonAddress>
                    <xsl:apply-templates select="ReportPackage/Addresses/Address"/>
                </PersonAddress>
                <VendorAddress>
                    <xsl:apply-templates select="ReportPackage/Parts//PartVendor"/>
                </VendorAddress>
            </Addresses>
            <xsl:apply-templates select="ReportPackage/Parts"/>
            <AdditionalData>
                <Vendor><xsl:value-of select=".//PartVendor/VendorName"/></Vendor>
                <Mode><xsl:value-of select=".//AdditionalItems[@qualifier='mode']/Text"/></Mode>
                <Indicator><xsl:value-of select=".//AdditionalItems[@qualifier='indicator']/Text"/></Indicator>
            </AdditionalData>
        </Package>
    </xsl:template>

    <xsl:template match="Parts">
        <Parts>
            <AssemblyId>
                <xsl:attribute name="id">
                    <xsl:value-of select=".//AssemblyId/IdValue"/>
                </xsl:attribute>
                <Status><xsl:value-of select=".//AssemblyStatus/Status"/></Status>
                <DateReOrderReceived><xsl:value-of select=".//AssemblyStatus/DateReOrderReceived"/></DateReOrderReceived>
                <xsl:for-each select=".//PartsMainSegment/AdditionalSegment/PartSpecs/Spec">
                    <Part>
                        <xsl:variable name="part-id" select="PartId"/>
                        <PartId><xsl:value-of select="PartId"/></PartId>
                        <PartName><xsl:value-of select="Name"/></PartName>
                        <Level><xsl:value-of select="ThresholdLevel"/></Level>
                        <PartType><xsl:value-of select="//AdditionallPartsSegment/Spec[PartId = $part-id]/PartType"/></PartType>
                    </Part>
                </xsl:for-each>
            </AssemblyId>
        </Parts>
    </xsl:template>

    <xsl:template match="Address">
        <Name><xsl:value-of select="Name"/></Name>
        <Address><xsl:value-of select="Address"/></Address>
        <City><xsl:value-of select="City"/></City>
        <State><xsl:value-of select="State"/></State>
        <Zip><xsl:value-of select="Zip"/></Zip>
        <Phone><xsl:value-of select="Phone"/></Phone>
    </xsl:template>

    <xsl:template match="PartVendor">
        <Name><xsl:value-of select="VendorName"/></Name>
        <Address><xsl:value-of select="VendorAddress/IdValue[@name='Address']"/></Address>
        <City><xsl:value-of select="VendorAddress/IdValue[@name='City']"/></City>
        <State><xsl:value-of select="VendorAddress/IdValue[@name='State']"/></State>
        <Zip><xsl:value-of select="VendorAddress/IdValue[@name='Zip']"/></Zip>
        <Phone><xsl:value-of select="VendorAddress/IdValue[@name='Phone']"/></Phone>
    </xsl:template>

</xsl:stylesheet> 
```

**输出**

```
<?xml version="1.0" encoding="UTF-8"?>
<Package>
   <TransmissionID>0792d49a-c09b-4094-9f4e-2357a042865c</TransmissionID>
   <PackageType>PackageName</PackageType>
   <Version>1.0</Version>
   <DateReported>04/12/2010</DateReported>
   <TimeReported>10:16:46.9385105</TimeReported>
   <Disposition>Disposition1</Disposition>
   <packageID>APackageId</packageID>
   <packageClientAccount>00000000</packageClientAccount>
   <Addresses>
      <PersonAddress>
         <Name>Stephen Stipulate</Name>
         <Address>1200 Any Street</Address>
         <City>Some City</City>
         <State>XX</State>
         <Zip>12345</Zip>
         <Phone>800-555-1212</Phone>
      </PersonAddress>
      <VendorAddress>
         <Name>Roger Refactor</Name>
         <Address>100 An Avenue Suite 13</Address>
         <City>A Different City</City>
         <State>YY</State>
         <Zip>54321</Zip>
         <Phone>866-555-1212</Phone>
      </VendorAddress>
   </Addresses>
   <Parts>
      <AssemblyId id="0547224801-0908">
         <Status>OutOfStock</Status>
         <DateReOrderReceived>2009-09-24T06:09:00</DateReOrderReceived>
         <Part>
            <PartId>123456</PartId>
            <PartName>Widget1</PartName>
            <Level>000500</Level>
            <PartType>ABC</PartType>
         </Part>
         <Part>
            <PartId>234567</PartId>
            <PartName>Widget2</PartName>
            <Level>000200</Level>
            <PartType>CBA</PartType>
         </Part>
      </AssemblyId>
   </Parts>
   <AdditionalData>
      <Vendor>Roger Refactor</Vendor>
      <Mode>AModeValue</Mode>
      <Indicator>AnIndicator</Indicator>
   </AdditionalData>
</Package> 
```

# c# - 使用 Linq 减去两个数组

> ID：15952457
> 
> 赞同：-1
> 
> 时间：2013-04-11T15:12:58.320
> 
> 标签：c#, linq

我有以下类型的两个数组*arr1*和*arr2*

```
class Data
{
  public int IdProduct;
  public double Price;
} 
```

我需要将*arr2*的价格减去*arr1*但数组的项目是不同查询的结果，因此***arr1*****中的产品数量不一定与*arr2*中的产品数量匹配，并且数组中没有重复的产品。**

 **我需要在每个数组中按产品做减法乘积，即。

```
var total =
  from a1 in arr1
  join a2 in arr2 on a1.IdProducto equals a2.IdProducto
  select new
  {
    Product = a1.IdProduct,
    Price = a1.Price - a2.Price
  }; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T15:20:35.033

像这样的东西？

```
var q = from a in arr1
                  join b in arr2 on a.IdProduct equals b.IdProduct into c
              from x in c.DefaultIfEmpty()
              select new Data {
                IdProduct = a.IdProduct,
                Price = x == null ? a.Price : a.Price - x.Price
              };

arr1 = q.ToArray(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-11T15:35:38.090

```
var result = arr1.Concat(arr2)
            .GroupBy(d => d.IdProduct)
            .Select(x => new Data
            {
                IdProduct = x.Key,
                Price = x.Select((y,i) => i == 0 ? y.Price : -y.Price).Sum()
            }).ToList(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-11T15:19:33.733

你有两个*总价差*`Data`的数组？

 *```
arr1.Sum(d => d.Price) - arr2.Sum(d => d.Price); 
```

基本上这段代码*总结了两个数组*并在之后减去。因此，总工作量随着数组的长度*线性增长*`O(n+m)`： .***

# ios - UILocalNotification 声音

> ID：15952461
> 
> 赞同：0
> 
> 时间：2013-04-11T15:13:03.747
> 
> 标签：ios, objective-c, xcode, uilocalnotification, geofencing

当用户通过地理围栏进入某个区域时，我会发出本地通知。但是当我按下主页按钮查看本地通知时，它确实会显示但没有声音。我试图在mac设置中禁用和启用“播放用户界面声音..”，关闭并重新打开xcode，清理项目，最后重新启动mac。没有任何效果..我错过了什么？

```
- (void)locationManager:(CLLocationManager *)manager didEnterRegion:(CLRegion *)region {
    NSLog(@"Entered Region - %@", region.identifier);
    UILocalNotification *localNotification = [[UILocalNotification alloc] init];
    [localNotification setAlertBody:@"You are about to enter.."];
    [localNotification setSoundName:@"Voicemail.caf"];

    UIApplication *application = [UIApplication sharedApplication];
    [application presentLocalNotificationNow:localNotification];
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-12-03T06:53:05.210

在这里你可以传递你的声音文件名

```
UILocalNotification *notifThreshold = [[UILocalNotification alloc]init];
    if(notifThreshold)
    {
        notifThreshold.alertBody = statusMsg;
        notifThreshold.alertAction= @"Open";
        notifThreshold.userInfo = userInfo;
        notifThreshold.soundName = UILocalNotificationDefaultSoundName;

        UIApplicationState state = [[UIApplication sharedApplication] applicationState];
        if (state == UIApplicationStateBackground)
        {

        notifThreshold.applicationIconBadgeNumber = [[UIApplication sharedApplication]
                                                     applicationIconBadgeNumber]+1;
        }
        [[UIApplication sharedApplication] presentLocalNotificationNow:notifThreshold];
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-03T07:10:05.577

请确保您的应用程序在通知中心的声音已启用，而不是使用 cap 扩展尝试使用 wav 扩展，例如“beep.wav”或“Default.wav”......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-03T06:41:36.680

转到 Build Phases 并将您的 .caf 文件添加到 Copy Bundle Resources。它帮助了我

# shell - 在 shell 中重命名文件

> ID：15952463
> 
> 赞同：0
> 
> 时间：2013-04-11T15:13:07.813
> 
> 标签：shell, rename

我有像这样的文件夹和文件结构

```
 Folder/1/fileNameOne.ext
Folder/2/fileNameTwo.ext
Folder/3/fileNameThree.ext
... 
```

如何重命名文件以使输出变为

```
 Folder/1_fileNameOne.ext
Folder/2_fileNameTwo.ext
Folder/3_fileNameThree.ext
... 
```

如何在 linux shell 中实现这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T15:19:24.390

你想用多少种不同的方式来做到这一点？

如果名称不包含空格或换行符或其他有问题的字符，并且中间目录始终是单个数字，并且如果您将要重命名的文件列表放在`file.list`每行一个名称的文件中，那么可以使用多种可能的方法之一重命名是：

```
sed 's%\(.*\)/\([0-9]\)/\(.*\)%mv \1/\2/\3 \1/\2_\3%' file.list | sh -x 
```

在确定它会执行您想要的操作之前，您应该避免通过 shell 运行命令；只需查看生成的脚本，直到正确为止。

还有一个命令叫做`rename`——不幸的是，有几个实现，并不是所有的都同样强大。如果你有一个基于 Perl 的（使用 Perl 正则表达式将旧名称映射到新名称），你可以使用：

```
rename 's%/(\d)/%/${1}_%' $(< file.list) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-11T15:34:49.240

使用循环如下：

```
while IFS= read -d $'\0' -r line
do
    mv "$line" "${line%/*}_${line##*/}"
done < <(find Folder -type f -print0) 
```

此方法处理文件名中的空格、换行符和其他特殊字符，中间目录不一定必须是个位数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-11T15:16:13.927

如果名称始终相同，即“文件”，这可能会起作用：

```
for i in {1..3};
do
    mv $i/file ${i}_file
done 
```

如果您在数字范围内有更多目录，请更改`{1..3}`为`{x..y}`.

我使用`${i}_file`而不是`$i_file`因为它会考虑`$i_file`name 的变量`i_file`，而我们只想`i`成为变量和`file`附加到它的文本。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-11T15:50:56.003

**[AskUbuntu](https://askubuntu.com/questions/280333/rename-files-in-group/280348?noredirect=1#280348)的这个解决方案对我有用。**

这是一个执行此操作的 bash 脚本：

***注意：如果任何文件名包含空格，则此脚本不起作用。***

```
#！/bin/bash

# 只遍历当前目录中的目录。
对于 $(find ./ -type d) 中的目录
做
    # 删除前两个字符。
    # 最初，$dir = "./directory_name"。
    # 这一步之后，$dir = "directory_name".
    dir="${dir:2}"

    # 如果 $dir 为空则跳过。仅在 $dir = "./" 最初发生时发生。
    如果 [ ！$目录]
    然后
        继续
    菲

    # 遍历目录中的所有文件。
    对于 $(ls -d $dir/*) 中的文件
    做
        ＃ 用。。。来代替 _
        # 例如，如果 $file = "dir/filename"，那么 $new_file = "dir_filename"
        # 其中 $dir = 目录
        new_file="${file/\//_}"

        # 移动文件。
        mv $file $new_file
    完毕

    # 删除目录。
    rm -rf $目录
完毕

```

*   将脚本复制粘贴到文件中。
*   使其可执行使用

```
chmod +x 文件名

```

*   将脚本移动到目标目录。在你的情况下，这应该在里面`Folder/`。
*   使用`./file_name`.

# json - Is is possible to Post a file and json body with RestSharp?

> ID：15952466
> 
> 赞同：1
> 
> 时间：2013-04-11T15:13:13.140
> 
> 标签：json, post, restsharp

I'd like to post one file and a json object to my server. Posting as a Parameter works fine, so this works:

```
request.AddFile ("MyPic", organisation.Pic, "Pic.png", "image/png");
request.AddParameter ("name", "test name"); 
```

But if my JSON object is something with a nested structure like:

```
{organisation:{
   'name':'test',
   'address':{
     'line1':'foo',
     'line2':'foo2'
   }
 }} 
```

How do I post this, while maintaining the json structure.

If I set it in the content body i.e.:

```
request.AddBody (organisation); 
```

the content is posted, but the file is not posted.

Is it possible to post both a json body and file?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-26T13:31:48.843

所以，我想出了一个适合我目的的解决方法。我一直在寻找的是对文件和相关元数据进行一次发布。在这种情况下，我将对象序列化为 JSON 字符串，将其设置为我的参数并在服务器上反序列化。这适用于我的情况，但我接受这对其他人可能并不理想。认为它可能会帮助某人。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-25T21:28:19.500

不，当您使用 AddFile 时，您实际上是在向您的请求添加正文。您不能发送带有 2 个正文的请求。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-10-17T18:08:20.273

Actually this will be possible very soon. There's a pull request on the RestSharp library that addresses this. I've started maintaining the project and will be merging it into master in the next day or so. Once there's enough stuff, I'll release a new NuGet package as well.

# visual-studio-2012 - How Do I Draw 3D Primitives in WP

> ID：15952467
> 
> 赞同：0
> 
> 时间：2013-04-11T15:13:15.237
> 
> 标签：visual-studio-2012, 3d, xna, windows-phone

I'm a green horn with XNA and I've been trying to get past this issue for several days but every time I try to get it done I get an exception or the application just plain exits and it has been very irritating.

I want to be able to draw a 3D primitive without having to have a model premade for it. I had this code first:

```
VertexPositionColor[] primitiveList = { new VertexPositionColor(
                    new Vector3(1,1,0), Color.White), new VertexPositionColor(
                    new Vector3(0,1,-1), Color.White) };

short[] lineListIndices = { 0, 1 };

Controller.CurrentGame.GraphicsDevice.DrawUserIndexedPrimitives<VertexPositionColor>(
    PrimitiveType.LineList,
    primitiveList,
    0,  // vertex buffer offset to add to each element of the index buffer
    2,  // number of vertices in pointList
    lineListIndices,  // the index buffer
    0,  // first index element to read
    1   // number of primitives to draw
); 
```

And I get an InvalidOperationException with the following

> Message "Both a vertex shader and pixel shader must be set on the device before any draw operations may be performed."

So then I try following the instructions on [http://msdn.microsoft.com/en-us/library/bb203926.aspx](http://msdn.microsoft.com/en-us/library/bb203926.aspx) and end up with the following code:

```
BasicEffect basicEffect = new BasicEffect(Controller.Graphics.GraphicsDevice);

basicEffect.World = Matrix.Identity;
basicEffect.View = Controller.Cam.view;
basicEffect.Projection = Controller.Cam.projection;

// primitive color
basicEffect.AmbientLightColor = new Vector3(0.1f, 0.1f, 0.1f);
basicEffect.DiffuseColor = new Vector3(1.0f, 1.0f, 1.0f);
basicEffect.SpecularColor = new Vector3(0.25f, 0.25f, 0.25f);
basicEffect.SpecularPower = 5.0f;
basicEffect.Alpha = 1.0f;

basicEffect.LightingEnabled = true;
if (basicEffect.LightingEnabled)
{
    basicEffect.DirectionalLight0.Enabled = true; // enable each light individually
    if (basicEffect.DirectionalLight0.Enabled)
    {
        // x direction
        basicEffect.DirectionalLight0.DiffuseColor = new Vector3(1, 0, 0); // range is 0 to 1
        basicEffect.DirectionalLight0.Direction = Vector3.Normalize(new Vector3(-1, 0, 0));
        // points from the light to the origin of the scene
        basicEffect.DirectionalLight0.SpecularColor = Vector3.One;
    }

    basicEffect.DirectionalLight1.Enabled = true;
    if (basicEffect.DirectionalLight1.Enabled)
    {
        // y direction
        basicEffect.DirectionalLight1.DiffuseColor = new Vector3(0, 0.75f, 0);
        basicEffect.DirectionalLight1.Direction = Vector3.Normalize(new Vector3(0, -1, 0));
        basicEffect.DirectionalLight1.SpecularColor = Vector3.One;
    }

    basicEffect.DirectionalLight2.Enabled = true;
    if (basicEffect.DirectionalLight2.Enabled)
    {
        // z direction
        basicEffect.DirectionalLight2.DiffuseColor = new Vector3(0, 0, 0.5f);
        basicEffect.DirectionalLight2.Direction = Vector3.Normalize(new Vector3(0, 0, -1));
        basicEffect.DirectionalLight2.SpecularColor = Vector3.One;
    }
}

VertexDeclaration vertexDeclaration = new VertexDeclaration(new VertexElement[]
    {
        new VertexElement(0, VertexElementFormat.Vector3, VertexElementUsage.Position, 0),
        new VertexElement(12, VertexElementFormat.Vector3, VertexElementUsage.Normal, 0),
        new VertexElement(24, VertexElementFormat.Vector2, VertexElementUsage.TextureCoordinate, 0)
    }
);

Vector3 topLeftFront = new Vector3(-1.0f, 1.0f, 1.0f);
Vector3 bottomLeftFront = new Vector3(-1.0f, -1.0f, 1.0f);
Vector3 topRightFront = new Vector3(1.0f, 1.0f, 1.0f);
Vector3 bottomRightFront = new Vector3(1.0f, -1.0f, 1.0f);
Vector3 topLeftBack = new Vector3(-1.0f, 1.0f, -1.0f);
Vector3 topRightBack = new Vector3(1.0f, 1.0f, -1.0f);
Vector3 bottomLeftBack = new Vector3(-1.0f, -1.0f, -1.0f);
Vector3 bottomRightBack = new Vector3(1.0f, -1.0f, -1.0f);

Vector2 textureTopLeft = new Vector2(0.0f, 0.0f);
Vector2 textureTopRight = new Vector2(1.0f, 0.0f);
Vector2 textureBottomLeft = new Vector2(0.0f, 1.0f);
Vector2 textureBottomRight = new Vector2(1.0f, 1.0f);

Vector3 frontNormal = new Vector3(0.0f, 0.0f, 1.0f);
Vector3 backNormal = new Vector3(0.0f, 0.0f, -1.0f);
Vector3 topNormal = new Vector3(0.0f, 1.0f, 0.0f);
Vector3 bottomNormal = new Vector3(0.0f, -1.0f, 0.0f);
Vector3 leftNormal = new Vector3(-1.0f, 0.0f, 0.0f);
Vector3 rightNormal = new Vector3(1.0f, 0.0f, 0.0f);

VertexPositionNormalTexture[] cubeVertices = new VertexPositionNormalTexture[6];

// Front face.
cubeVertices[0] =
    new VertexPositionNormalTexture(
    topLeftFront, frontNormal, textureTopLeft);
cubeVertices[1] =
    new VertexPositionNormalTexture(
    bottomLeftFront, frontNormal, textureBottomLeft);
cubeVertices[2] =
    new VertexPositionNormalTexture(
    topRightFront, frontNormal, textureTopRight);
cubeVertices[3] =
    new VertexPositionNormalTexture(
    bottomLeftFront, frontNormal, textureBottomLeft);
cubeVertices[4] =
    new VertexPositionNormalTexture(
    bottomRightFront, frontNormal, textureBottomRight);
cubeVertices[5] =
    new VertexPositionNormalTexture(
    topRightFront, frontNormal, textureTopRight);

RasterizerState rasterizerState1 = new RasterizerState();
rasterizerState1.CullMode = CullMode.None;
Controller.Graphics.GraphicsDevice.RasterizerState = rasterizerState1;
foreach (EffectPass pass in basicEffect.CurrentTechnique.Passes)
{
    pass.Apply();

    Controller.Graphics.GraphicsDevice.DrawPrimitives(
        PrimitiveType.TriangleList,
        0,
        12
    );
} 
```

And I get the following Exception

> Message "A valid vertex buffer (and a valid index buffer if you are using indexed primitives) must be set on the device before any draw operations may be performed."

I know I shouldn't have all of this code in the same place, but I just want to be able to get something to draw so I can see how it works but nothing works and I can't seem to load any examples into VS.

As I've said I'm rather new and beyond the question I would also greatly appreciate any kind of reading material that would point in the right direction for 3D XNA. Thank you for reading.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T15:27:12.147

在您的第一个示例中，您正确地绘制了一个顶点列表，但正如错误所说，它没有着色器。关于着色器的快速说明：由于 WP7 上没有自定义着色器，这意味着您没有应用任何`Effect`; WP7 仅限于`Effect`可以在[此处](http://msdn.microsoft.com/en-us/library/microsoft.xna.framework.graphics.aspx)找到的子类。它们本质上包含内置着色器。

在第二个示例中，您设置了一个着色器，但现在您没有从任何列表或缓冲区中绘制。`DrawUserIndexedPrimitves`采用索引和顶点数组。它使用那些来绘制。`DrawPrimitives`没有；它依赖于绑定到图形设备的顶点缓冲区。

要么将第二个示例更改为`DrawUserIndexedPrimitives`并传入您的数组（`cubeVertices`并且......等等，您没有索引数组，请创建一个），或者`VertexBuffer`使用相同的信息设置 a 并将其绑定如下：

`Controller.Graphics.GraphicsDevice.SetVertexBuffer(vb);`

# adobe-indesign - 确定故事和页面之间的关系

> ID：15952469
> 
> 赞同：2
> 
> 时间：2013-04-11T15:13:20.740
> 
> 标签：adobe-indesign

开始之前的一些背景知识：我绝不是 InDesign 专家，但我的任务是从我们公司的 InDesign 文件中提取一些文本信息来进行一些分析。我正在使用的每个 InDesign 文件都有多个页面，并且每个页面都使用母版页中的故事（如果我使用了错误的术语，请原谅我，我对 InDesign 对象模型的理解有限） . 使用默认的导出所有文本脚本作为起点，我能够扩展该功能以转储其他有用的信息；比如几何边界。我在下面发布了一些代码：

```
myFileName = "StoryID" + myID + myExtension;
myFilePath = myFolder + "/" + myFileName;
myFile = new File(myFilePath);

myFile.encoding='text';
myFile.open('w');

containers = myStory.textContainers;

if (containers[0].overridden) {
    for (i = 0; i < myStory.words.length; i++) {
        myFile.write(myStory.words[i].contents);
        myFile.write(" ");
    }
    myFile.write("\n");
}
else {
    myFile.write(myStory.contents + '\n');
}

var geometry = containers[0].geometricBounds
myFile.write("++" + containers[0].parent.name + '\n');
myFile.write("$$" + geometry[0] + "\t" + geometry[1] + "\t" + geometry[2] + "\t" + geometry[3] + "\n");

pageitems = myStory.allPageItems;
for (j = 0; j < pageitems.length; j++){
    myFile.write("--" + pageitems[0]);
}
myFile.close(); 
```

我的问题是，我如何确定一个故事出现的所有页面？例如，假设我有 4 个页面：{Master, Region 1, Region 2, Region 3}。区域 1 - 3 都从 Master 继承了一个故事块。当我运行这个脚本时，我只得到一个 Story 块的实例，即属于 Master 的实例。但是，我很想知道有问题的故事块属于所有 4 页。我尝试访问 allPageItems 属性，但我一直得到 0 个结果。

任何帮助，将不胜感激。如果有帮助，我正在开发 InDesign CS 6

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-12T13:35:31.583

当您访问元素时，您将访问锚定在该故事中`allPageItems`的`Story`所有页面项目，我认为这不是您想要的。

当您访问该`allPageItems`属性时，您会得到 0 个结果，因为您`Story`不包含任何`textFrames`. 该`Story`元素由`textContainers`not包含`textFrames`。我知道这很混乱！

如果要确定故事是否在特定页面上，可以访问`textContainers`'`parentPage`属性。

A`Story`流经多个`textContainers`. 例如：

```
 link                         link
TextContainer      -->      TextContainer2      -->      TextContainer3
|_____________________________________________________________________|
                                   |
                                 Story 
```

A`Story`还可以包含`textFrames`, `rectangles`,`words`等。例如：

```
 Story
___________________________________|__________________________________
|                                                                     |
Word  -->  Word2  -->  TextFrame  -->   Word3  -->   Word4  -->   Word5 
```

# c# - 重新定义查看现有模块 Dotnetnuke 7

> ID：15952482
> 
> 赞同：0
> 
> 时间：2013-04-11T15:13:42.980
> 
> 标签：c#, asp.net, .net, dotnetnuke, dotnetnuke-module

Dotnetnuke 7 的基本安装中存在的“帐户登录”模块有一个显示登录表单的视图。

我的问题是：我必须做什么才能在我自己的皮肤中重新定义该视图（更改登录表单）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T10:40:24.787

DotNetNuke 期望开箱即用的登录模块出现在设置为登录页面的页面上。这意味着，即使您使用自定义模块进行登录，您也必须退出该页面内的框模块并将安全性设置为仅允许经过身份验证的用户。

如果这不是您想知道的，请添加有关“重新定义”含义的更多详细信息。

# android - Titanium webview.reload() 无法正常工作

> ID：15952485
> 
> 赞同：0
> 
> 时间：2013-04-11T15:13:51.360
> 
> 标签：android, titanium, android-webview

当我尝试重新加载钛 webview true webview.reload() 时，视图无法正确重新加载。相反，如果加载页面，它会给我一个找不到页面。

我在做什么：在 Titanium 中，我使用 webviews 来显示数据。这些 webviews 使用存储在 Titanium 提供的本地文件系统中的 HTML。webview 被称为 url 由以下设置：

```
webview.setUrl( Ti.Filesystem.applicationDataDirectory.toString() + 'index.html'); 
```

这为 webview 设置了正确的 url，它让我看到了正确的 html 页面。当我使用 webview.reload() 时，它似乎丢失了......有没有办法重新加载 webview，或者我应该删除然后再次添加 webview？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T15:36:11.950

为 WebView 设置 URL，资源通常从`Resources`文件夹中加载。因此，尝试将所有 HTML 文件移到那里（到`Resources`所在的同一文件夹中`app.js`）并简单地使用。

```
webview.setUrl('index.html'); 
```

这对我在 iOS 和 Android 上都有效。

（有一个与 Android 相关的关于 WebView 和按`html`属性设置其内容的问题，但这在这里无关紧要）

# c# - 菜单设计和事件 wpf

> ID：15952487
> 
> 赞同：2
> 
> 时间：2013-04-11T15:13:55.673
> 
> 标签：c#, wpf, xaml, mouseevent, menuitem

![在此处输入图像描述](https://i.stack.imgur.com/pDz4b.png)我有一个 WPF 应用程序，其中包含类似[www.google.com](http://www.google.com)中的菜单。

```
<MenuItem Header="_Paramètres"
          Height="60"
          Width="188"
          FontWeight="Bold"
          FontSize="16"
          HorizontalContentAlignment="Center"
          MouseMove="MenuItem_MouseMove_1"
          Name="param">
  <MenuItem.Background>
    <LinearGradientBrush EndPoint="0.5,1"
                         StartPoint="0.5,0">
      <GradientStop Color="Black"
                    Offset="0" />
      <GradientStop Color="White"
                    Offset="1" />
    </LinearGradientBrush>
  </MenuItem.Background>
  <MenuItem Header="_Régler"
            Height="30"
            Width="188"
            FontWeight="Bold"
            FontSize="16"
            Click="regler_Click_1"
            x:Name="regler"
            Background="#FF150202"
            HorizontalContentAlignment="Right" />
</MenuItem> 
```

我的问题是当鼠标在菜单`param`中的焦点控件变成蓝色时，表示焦点是他们的。我想避免这种情况，并在鼠标在菜单上时在文本中添加灯光（就像在 google.com 的菜单中一样）

我该怎么做？我必须在代码中做哪些更改？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T17:47:53.597

您需要为 Menu 控件定义 ItemContainerStyle，这样您就可以更改 IsSelected 状态的外观。一种更简单的方法是制作 ItemContainerStyle 的副本，然后对其进行修改。（如果您在 Blend 或 VS2012 上，右键单击容器菜单，编辑其他模板，ItemContainerStyle，复制）。希望这会有所帮助，我认为它会...

# javascript - Extjs 4.1 树加载

> ID：15952492
> 
> 赞同：0
> 
> 时间：2013-04-11T15:14:12.147
> 
> 标签：javascript, extjs, extjs4, extjs4.1, extjs-mvc

我创建了一个带有 json 响应的 extjs 树，即从 php 函数创建的。我一次获取完整数据并转换为 json ，然后将响应发送到 extjs 。但是一次获取数十万条记录并获得响应将是一个漫长的过程，并且可能会发生 ajax 超时。所以我打算做的是让根节点在第一次加载树时列出。然后单击父节点，子节点将通过发送父节点 id 来加载。（使用 extjs 代理 ajax）。这将有助于服务器减少负载。我不想加载要加载一次的数十万数据。这个逻辑的结论是在树形网格上进行分页。所以我的问题是当前版本的 extjs 4.1 树是否支持此功能。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T15:23:15.250

是的，只需不要发送您不希望立即加载的任何节点的“子节点”属性。当您尝试扩展没有任何子节点的非叶节点时，ExtJS 会自动发出另一个请求。

这是[Sencha](http://dev.sencha.com/deploy/ext-4.0.0/examples/tree/reorder.html)的一个很好的官方示例。

# asp.net - ASP.NET 会话对象在尝试执行“有效”强制转换时生成 InvalidCastException

> ID：15952493
> 
> 赞同：0
> 
> 时间：2013-04-11T15:14:12.977
> 
> 标签：asp.net, session, casting

在一个方法中，我将一个结构存储到 HttpSession 中：

```
 HttpContext.Current.Session["search_headers"] = ra; 
```

其中 ra 是我的“replySearchAjax”类型的自定义结构。

在属于同一名称空间的网络方法中，我正在尝试执行以下操作：

```
 [WebMethod(EnableSession = true)]
    public replySearchAjax RestorePhenSearchTable()
    {
        if (HttpContext.Current.Session["search_headers"] != null)
        {
            replySearchAjax aa =  (replySearchAjax) HttpContext.Current.Session["search_headers"];
            return aa;
        } 
```

但是类型转换的行返回

```
{"Message":"Specified cast is not valid." 
 "ExceptionType":"System.InvalidCastException"} 
```

在产生异常的行的断点处检查会话变量表明其中包含有效的replySearchAjax 字段。

我将如何使它工作？提前致谢！

# javascript - 使用 Ajax 调用接收数据记录的问题

> ID：15952494
> 
> 赞同：1
> 
> 时间：2013-04-11T15:14:18.930
> 
> 标签：javascript, jquery, ajax, vb.net, asp.net-mvc-4

我在进行 ajax 调用以接收数据库对象时遇到一些问题。我正在视图中进行 ajax 调用，以将视图中 HTML 元素之一的值传递给控制器​​中的方法，该方法使用该值搜索并返回现有数据记录。

我的ajax调用：

```
$.ajax({
  url: "/MyController/MyFunction/",
  data: {Value: myvalue},
  type: 'GET',
  success: function (result) {
      //do something...
  } 
```

我的控制器方法：

```
 Function MyFunction(Value as String) As MyClass
   Dim record = SearchFunction(Value)

   Return record
 End Function 
```

我的数据类：

```
Public Class MyClass

  Property Name As String
  Property Age As Integer
  Property DOB As Date
End Class 
```

我遇到的问题是调用中收到的“结果”返回一个带有我的模型名称的字符串，即“MyClass”，即使控制器工作正常并且“记录”已成功设置为正确的数据记录。

在搜索互联网后，我尝试了各种不同的潜在解决方案，包括 ajax 调用中的不同数据类型以及 $.getJSON() 等不同的 ajax 调用，但到目前为止没有任何效果。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T15:18:22.650

在将对象返回给客户端之前，您需要将其转换为 JSON。

```
return Json(record); 
```

我现在无法测试它，所以我不知道它是否会自动解析整个对象或者您需要手动进行映射。

顺便说一句：您可能还需要使用**JsonResult类型而不是****ActionResult**
编辑：我刚刚注意到您没有在那里使用 ActionResult。我不懂VB，所以我不确定你的语法是否正确。您可能肯定会尝试返回 JsonResult 而不是字符串（这也可能是问题的一部分）。

顺便说一句：我会在你的 ajax 调用中使用 POST :)

# ios - 本机应用程序中的精灵表（不是 cocos2d）

> ID：15952497
> 
> 赞同：1
> 
> 时间：2013-04-11T15:14:24.740
> 
> 标签：ios, plist, sprite, sprite-sheet

Short Q. 主要是为了帮助我，这可以为我指明正确的方向。

我在寻找有关如何在带有情节提要的“普通”本机应用程序中使用和实现 spritesheets（加载单独的 icon.png）的帮助时遇到问题。

到目前为止，我发现的只是如何在 cocos2d 中进行游戏。而且我知道我必须以编程方式而不是通过情节提要来实现它。

到目前为止，我只有一个 spriteSheet.png 和一个生成的 spriteSheet.plist tnx 到[http://www.Zwoptex.com](http://www.Zwoptex.com)

任何帮助或指针表示赞赏

tnx

# javascript - 删除数字时如何解决NaN？

> ID：15952498
> 
> 赞同：2
> 
> 时间：2013-04-11T15:14:25.207
> 
> 标签：javascript, dom, sum

这是我在所有文本框中添加时的代码，它工作正常，但在删除数字后它显示 NaN：

```
function sumVal()
{
    var total = 0;
    var coll = document.getElementsByTagName("input")
    for ( var i = 0; i<coll.length; i++)
    {
        var ele = coll[i];
        total += parseInt(ele.value);
    }
    var Display = document.getElementById("Display");
    Display.innerHTML = total;
}

<input onkeyup="sumVal()" />
<input onkeyup="sumVal()" />
<input onkeyup="sumVal()" /> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-11T15:16:50.917

在将其添加到总数之前尝试检查您的值是否为 NaN：

```
total += (isNaN(parseInt(ele.value, 10)) ? 0 : parseInt(ele.value, 10)); 
```

另外，不要忘记基数[`parseInt`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/parseInt)（或[`parseFloat`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/parseFloat)在有小数位的情况下使用）：

**基数**

> 一个整数，表示上述字符串的基数。 **始终指定此参数**以消除读者混淆并保证可预测的行为。当未指定基数时，不同的实现会产生不同的结果。

```
var nums = [10, "sads", 44, 16];
var numsLen = nums.length;
var total = 0;

while(numsLen--){
    total += (isNaN(parseInt(nums[numsLen], 10)) ? 0 : parseInt(nums[numsLen], 10));
} 
```

在此[**示例**](http://jsfiddle.net/9DWMf/)中，由于“sads”**不是数字 (NaN)**，我们将 0 添加到总数中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-11T15:18:08.683

您应该首先确保元素的值是有效数字：

```
if (isNumber(ele.value))
    total += parseInt(ele.value, 10);
} 
```

您将需要此功能：

```
function isNumber(n) {
  return !isNaN(parseFloat(n)) && isFinite(n);
} 
```

[上面的函数就是这里](https://stackoverflow.com/questions/18082/validate-numbers-in-javascript-isnumeric)的著名`isNumber`函数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-11T15:16:57.043

`0`如果不是数字，只需添加：

```
var theInt = parseInt(ele.value, 10);
total += (isNaN(theInt)) ? 0 : theInt; 
```

# drools - JBPM 5 - RESOURCE_LOCAL 持久性

> ID：15952499
> 
> 赞同：0
> 
> 时间：2013-04-11T15:14:27.710
> 
> 标签：drools, jbpm

环境：

jbpm v5.4.0.Final，drools 5.5.0.Final，spring v3.0.6.RELEASE，Oracle，Hibernate EM v4.0.0.Final，JPA v2

我已将我的 Web 应用程序配置为将 JBPM 与 RESOURCE_LOCAL 事务一起使用。

我面临3个问题：

1）表workiteminfo没有得到持久化

2) JPAWorkingMemoryDbLogger 的日志没有被持久化到数据库中。

3）当人工任务完成时，会话不会执行实例中的其他节点，即使`Session.getWorkItemManager().completeWorkItem`在任务完成后被调用。因此不会创建新任务。

我已将persistence.xml 配置为使用“RESOURCE_LOCAL”事务。我已将 DroolsSpringJPAManager 配置为非 JTA。

在为 Session 创建 Environment 时，是否应该显式创建命令范围的 EntityManager ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-22T00:31:00.950

以下是 jBPM 5.4.0.Final 的示例：

```
package com.sample;

import java.util.List;

import javax.persistence.EntityManagerFactory;

import org.drools.KnowledgeBase;
import org.drools.SystemEventListenerFactory;
import org.drools.container.spring.beans.persistence.DroolsSpringJpaManager;
import org.drools.container.spring.beans.persistence.DroolsSpringTransactionManager;
import org.drools.impl.EnvironmentFactory;
import org.drools.persistence.PersistenceContextManager;
import org.drools.persistence.TransactionManager;
import org.drools.persistence.jpa.JPAKnowledgeService;
import org.drools.runtime.Environment;
import org.drools.runtime.EnvironmentName;
import org.drools.runtime.StatefulKnowledgeSession;
import org.drools.runtime.process.ProcessInstance;
import org.jbpm.process.audit.JPAProcessInstanceDbLog;
import org.jbpm.process.audit.JPAWorkingMemoryDbLogger;
import org.jbpm.process.audit.ProcessInstanceLog;
import org.jbpm.process.workitem.wsht.SyncWSHumanTaskHandler;
import org.jbpm.task.TaskService;
import org.jbpm.task.identity.UserGroupCallback;
import org.jbpm.task.identity.UserGroupCallbackManager;
import org.jbpm.task.query.TaskSummary;
import org.jbpm.task.service.local.LocalTaskService;
import org.jbpm.task.service.persistence.TaskSessionSpringFactoryImpl;
import org.jbpm.test.JBPMHelper;
import org.springframework.context.support.ClassPathXmlApplicationContext;
import org.springframework.transaction.TransactionStatus;
import org.springframework.transaction.support.AbstractPlatformTransactionManager;
import org.springframework.transaction.support.DefaultTransactionDefinition;

/**
 * This is a sample file to launch a process.
 */
public class TestSpringLocalEMF {

    public static final void main(String[] args) throws Throwable {
        JBPMHelper.startH2Server();

        UserGroupCallbackManager.getInstance().setCallback(new UserGroupCallback() {
            public boolean existsGroup(String arg0) {
                return true;
            }
            public boolean existsUser(String arg0) {
                return true;
            }
            public List<String> getGroupsForUser(String arg0,
                    List<String> arg1, List<String> arg2) {
                return arg2;
            }
        });

        ClassPathXmlApplicationContext context =
            new ClassPathXmlApplicationContext("spring-conf.xml");

        EntityManagerFactory emf = (EntityManagerFactory) context.getBean("jbpmEMF");

        Environment env = EnvironmentFactory.newEnvironment();  
        env.set(EnvironmentName.ENTITY_MANAGER_FACTORY, emf);       

        AbstractPlatformTransactionManager aptm = (AbstractPlatformTransactionManager) context.getBean( "jbpmTxManager" );      
        TransactionManager transactionManager = new DroolsSpringTransactionManager( aptm );
        env.set(EnvironmentName.TRANSACTION_MANAGER, transactionManager);

        PersistenceContextManager persistenceContextManager = new DroolsSpringJpaManager(env);
        env.set(EnvironmentName.PERSISTENCE_CONTEXT_MANAGER, persistenceContextManager);

        KnowledgeBase kbase = (KnowledgeBase) context.getBean("kbase");
        StatefulKnowledgeSession ksession = JPAKnowledgeService.newStatefulKnowledgeSession( kbase, null, env );
        new JPAWorkingMemoryDbLogger(ksession);

        org.jbpm.task.service.TaskService internalTaskService = new org.jbpm.task.service.TaskService();
        internalTaskService.setSystemEventListener(SystemEventListenerFactory.getSystemEventListener());
        TaskSessionSpringFactoryImpl springFactory = new TaskSessionSpringFactoryImpl();
        springFactory.setEntityManagerFactory(emf);     
        springFactory.setTaskService(internalTaskService);
        springFactory.setTransactionManager(transactionManager);
        springFactory.setUseJTA(true);
        springFactory.initialize();
        TaskService taskService = new LocalTaskService(internalTaskService);

        SyncWSHumanTaskHandler humanTaskHandler = new SyncWSHumanTaskHandler(taskService, ksession);
        humanTaskHandler.setLocal(true);
        humanTaskHandler.connect();
        ksession.getWorkItemManager().registerWorkItemHandler("Human Task", humanTaskHandler);

        ProcessInstance processInstance = ksession.startProcess("com.sample.bpmn.hello");

        System.out.println("Process started");

        List<TaskSummary> tasks = taskService.getTasksAssignedAsPotentialOwner("john", "en-UK");
        System.out.println("Found " + tasks.size() + " task(s) for user 'john'");
        if (tasks.size() != 1) {
            throw new IllegalArgumentException("Incorrect amount of tasks");
        }
        long taskId = tasks.get(0).getId();
        taskService.start(taskId, "john");
        taskService.complete(taskId, "john", null);

        tasks = taskService.getTasksAssignedAsPotentialOwner("mary", "en-UK");
        System.out.println("Found " + tasks.size() + " task(s) for user 'mary'");
        if (tasks.size() != 1) {
            throw new IllegalArgumentException("Incorrect amount of tasks");
        }
        taskId = tasks.get(0).getId();
        taskService.start(taskId, "mary");
        taskService.complete(taskId, "mary", null);

        processInstance = ksession.getProcessInstance(processInstance.getId());
        if (processInstance == null) {
            System.out.println("Process instance completed");
        }

        System.out.println("******************************************************************");

        DefaultTransactionDefinition def = new DefaultTransactionDefinition();
        TransactionStatus status = aptm.getTransaction(def);

        processInstance = ksession.startProcess("com.sample.bpmn.hello");
        long processInstanceId = processInstance.getId();

        aptm.rollback(status);

        processInstance = ksession.getProcessInstance(processInstanceId);

        if (processInstance == null) {
            System.out.println("Process instance rolled back");
        } else {
            throw new IllegalArgumentException("Process instance not rolled back");
        }

        tasks = taskService.getTasksAssignedAsPotentialOwner("john", "en-UK");
        System.out.println("Found " + tasks.size() + " task(s) for user 'john'");
        if (tasks.size() != 0) {
            throw new IllegalArgumentException("Incorrect amount of tasks");
        }

        JPAProcessInstanceDbLog.setEnvironment(env);
        ProcessInstanceLog log = JPAProcessInstanceDbLog.findProcessInstance(processInstanceId);
        if (log != null) {
            throw new IllegalArgumentException("Log not rolled back");
        }

        System.exit(0);
    }

} 
```

使用persistence.xml

```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<persistence version="1.0"
             xsi:schemaLocation="http://java.sun.com/xml/ns/persistence
                                 http://java.sun.com/xml/ns/persistence/persistence_1_0.xsd
                                 http://java.sun.com/xml/ns/persistence/orm 
                                 http://java.sun.com/xml/ns/persistence/orm_1_0.xsd"
             xmlns:orm="http://java.sun.com/xml/ns/persistence/orm"
             xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
             xmlns="http://java.sun.com/xml/ns/persistence">

  <persistence-unit name="org.jbpm.persistence.jpa.local" transaction-type="RESOURCE_LOCAL">
    <provider>org.hibernate.ejb.HibernatePersistence</provider>
    <jta-data-source>jdbc/jbpm-ds</jta-data-source>

    <mapping-file>META-INF/JBPMorm.xml</mapping-file>
    <mapping-file>META-INF/ProcessInstanceInfo.hbm.xml</mapping-file>
    <mapping-file>META-INF/Taskorm.xml</mapping-file>

    <class>org.jbpm.persistence.processinstance.ProcessInstanceInfo</class>
    <class>org.drools.persistence.info.SessionInfo</class>
    <class>org.drools.persistence.info.WorkItemInfo</class>
    <class>org.drools.persistence.info.SessionInfo</class>
    <class>org.drools.persistence.info.WorkItemInfo</class>

    <class>org.jbpm.process.audit.ProcessInstanceLog</class>
    <class>org.jbpm.process.audit.NodeInstanceLog</class>
    <class>org.jbpm.process.audit.VariableInstanceLog</class>

    <class>org.jbpm.task.Attachment</class>
    <class>org.jbpm.task.Content</class>
    <class>org.jbpm.task.BooleanExpression</class>
    <class>org.jbpm.task.Comment</class>
    <class>org.jbpm.task.Deadline</class>
    <class>org.jbpm.task.Comment</class>
    <class>org.jbpm.task.Deadline</class>
    <class>org.jbpm.task.Delegation</class>
    <class>org.jbpm.task.Escalation</class>
    <class>org.jbpm.task.Group</class>
    <class>org.jbpm.task.I18NText</class>
    <class>org.jbpm.task.Notification</class>
    <class>org.jbpm.task.EmailNotification</class>
    <class>org.jbpm.task.EmailNotificationHeader</class>
    <class>org.jbpm.task.PeopleAssignments</class>
    <class>org.jbpm.task.Reassignment</class>
    <class>org.jbpm.task.Status</class>
    <class>org.jbpm.task.Task</class>
    <class>org.jbpm.task.TaskData</class>
    <class>org.jbpm.task.SubTasksStrategy</class>
    <class>org.jbpm.task.OnParentAbortAllSubTasksEndStrategy</class>
    <class>org.jbpm.task.OnAllSubTasksEndParentEndStrategy</class>
    <class>org.jbpm.task.User</class>

    <properties>
      <property name="hibernate.max_fetch_depth" value="3"/>
      <property name="hibernate.hbm2ddl.auto" value="create" />
      <property name="hibernate.show_sql" value="true" />   
      <property name="hibernate.dialect" value="org.hibernate.dialect.H2Dialect"/>
    </properties>

  </persistence-unit>

</persistence> 
```

和 spring-conf.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:jbpm="http://drools.org/schema/drools-spring"       
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.0.xsd
                           http://drools.org/schema/drools-spring org/drools/container/spring/drools-spring-1.5.0.xsd">

  <bean id="dataSource" class="org.springframework.jdbc.datasource.DriverManagerDataSource">
    <property name="driverClassName" value="org.h2.Driver"/>
    <property name="url" value="jdbc:h2:tcp://localhost/~/jbpm-db"/>
    <property name="username" value="sa"/>
    <property name="password" value=""/>
  </bean>

  <bean id="jbpmEMF" class="org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean">
    <property name="dataSource" ref="dataSource"/>
    <property name="persistenceUnitName" value="org.jbpm.persistence.jpa.local"/>
  </bean>

  <bean id="jbpmTxManager" class="org.springframework.orm.jpa.JpaTransactionManager">
    <property name="entityManagerFactory" ref="jbpmEMF"/>
    <property name="nestedTransactionAllowed" value="false"/>
  </bean>

  <jbpm:kbase id="kbase">
    <jbpm:resources>
      <jbpm:resource type="BPMN2" source="classpath:sample.bpmn"/>
    </jbpm:resources>
  </jbpm:kbase>

</beans> 
```

和 sample.bpmn

```
<?xml version="1.0" encoding="UTF-8"?> 
<definitions id="Definition"
             targetNamespace="http://www.jboss.org/drools"
             typeLanguage="http://www.java.com/javaTypes"
             expressionLanguage="http://www.mvel.org/2.0"
             xmlns="http://www.omg.org/spec/BPMN/20100524/MODEL"
             xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
             xsi:schemaLocation="http://www.omg.org/spec/BPMN/20100524/MODEL BPMN20.xsd"
             xmlns:g="http://www.jboss.org/drools/flow/gpd"
             xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI"
             xmlns:dc="http://www.omg.org/spec/DD/20100524/DC"
             xmlns:di="http://www.omg.org/spec/DD/20100524/DI"
             xmlns:tns="http://www.jboss.org/drools">

  <process processType="Private" isExecutable="true" id="com.sample.bpmn.hello" name="Hello World" >

    <!-- nodes -->
    <startEvent id="_1" name="Start" />
    <endEvent id="_3" name="End" >
        <terminateEventDefinition/>
    </endEvent>
    <userTask id="_4" name="Task 1" >
      <ioSpecification>
        <dataInput id="_4_CommentInput" name="Comment" />
        <dataInput id="_4_SkippableInput" name="Skippable" />
        <dataInput id="_4_TaskNameInput" name="TaskName" />
        <dataInput id="_4_ContentInput" name="Content" />
        <dataInput id="_4_GroupIdInput" name="GroupId" />
        <dataInput id="_4_PriorityInput" name="Priority" />
        <inputSet>
          <dataInputRefs>_4_CommentInput</dataInputRefs>
          <dataInputRefs>_4_SkippableInput</dataInputRefs>
          <dataInputRefs>_4_TaskNameInput</dataInputRefs>
          <dataInputRefs>_4_ContentInput</dataInputRefs>
          <dataInputRefs>_4_GroupIdInput</dataInputRefs>
          <dataInputRefs>_4_PriorityInput</dataInputRefs>
        </inputSet>
        <outputSet>
        </outputSet>
      </ioSpecification>
      <dataInputAssociation>
        <targetRef>_4_CommentInput</targetRef>
        <assignment>
          <from xsi:type="tFormalExpression"></from>
          <to xsi:type="tFormalExpression">_4_CommentInput</to>
        </assignment>
      </dataInputAssociation>
      <dataInputAssociation>
        <targetRef>_4_SkippableInput</targetRef>
        <assignment>
          <from xsi:type="tFormalExpression">false</from>
          <to xsi:type="tFormalExpression">_4_SkippableInput</to>
        </assignment>
      </dataInputAssociation>
      <dataInputAssociation>
        <targetRef>_4_TaskNameInput</targetRef>
        <assignment>
          <from xsi:type="tFormalExpression">Task1</from>
          <to xsi:type="tFormalExpression">_4_TaskNameInput</to>
        </assignment>
      </dataInputAssociation>
      <dataInputAssociation>
        <targetRef>_4_ContentInput</targetRef>
        <assignment>
          <from xsi:type="tFormalExpression"></from>
          <to xsi:type="tFormalExpression">_4_ContentInput</to>
        </assignment>
      </dataInputAssociation>
      <dataInputAssociation>
        <targetRef>_4_GroupIdInput</targetRef>
        <assignment>
          <from xsi:type="tFormalExpression"></from>
          <to xsi:type="tFormalExpression">_4_GroupIdInput</to>
        </assignment>
      </dataInputAssociation>
      <dataInputAssociation>
        <targetRef>_4_PriorityInput</targetRef>
        <assignment>
          <from xsi:type="tFormalExpression"></from>
          <to xsi:type="tFormalExpression">_4_PriorityInput</to>
        </assignment>
      </dataInputAssociation>
      <potentialOwner>
        <resourceAssignmentExpression>
          <formalExpression>john</formalExpression>
        </resourceAssignmentExpression>
      </potentialOwner>
    </userTask>
    <userTask id="_5" name="Task 2" >
      <ioSpecification>
        <dataInput id="_5_CommentInput" name="Comment" />
        <dataInput id="_5_SkippableInput" name="Skippable" />
        <dataInput id="_5_TaskNameInput" name="TaskName" />
        <dataInput id="_5_ContentInput" name="Content" />
        <dataInput id="_5_GroupIdInput" name="GroupId" />
        <dataInput id="_5_PriorityInput" name="Priority" />
        <inputSet>
          <dataInputRefs>_5_CommentInput</dataInputRefs>
          <dataInputRefs>_5_SkippableInput</dataInputRefs>
          <dataInputRefs>_5_TaskNameInput</dataInputRefs>
          <dataInputRefs>_5_ContentInput</dataInputRefs>
          <dataInputRefs>_5_GroupIdInput</dataInputRefs>
          <dataInputRefs>_5_PriorityInput</dataInputRefs>
        </inputSet>
        <outputSet>
        </outputSet>
      </ioSpecification>
      <dataInputAssociation>
        <targetRef>_5_CommentInput</targetRef>
        <assignment>
          <from xsi:type="tFormalExpression"></from>
          <to xsi:type="tFormalExpression">_5_CommentInput</to>
        </assignment>
      </dataInputAssociation>
      <dataInputAssociation>
        <targetRef>_5_SkippableInput</targetRef>
        <assignment>
          <from xsi:type="tFormalExpression">false</from>
          <to xsi:type="tFormalExpression">_5_SkippableInput</to>
        </assignment>
      </dataInputAssociation>
      <dataInputAssociation>
        <targetRef>_5_TaskNameInput</targetRef>
        <assignment>
          <from xsi:type="tFormalExpression">Task2</from>
          <to xsi:type="tFormalExpression">_5_TaskNameInput</to>
        </assignment>
      </dataInputAssociation>
      <dataInputAssociation>
        <targetRef>_5_ContentInput</targetRef>
        <assignment>
          <from xsi:type="tFormalExpression"></from>
          <to xsi:type="tFormalExpression">_5_ContentInput</to>
        </assignment>
      </dataInputAssociation>
      <dataInputAssociation>
        <targetRef>_5_GroupIdInput</targetRef>
        <assignment>
          <from xsi:type="tFormalExpression"></from>
          <to xsi:type="tFormalExpression">_5_GroupIdInput</to>
        </assignment>
      </dataInputAssociation>
      <dataInputAssociation>
        <targetRef>_5_PriorityInput</targetRef>
        <assignment>
          <from xsi:type="tFormalExpression"></from>
          <to xsi:type="tFormalExpression">_5_PriorityInput</to>
        </assignment>
      </dataInputAssociation>
      <potentialOwner>
        <resourceAssignmentExpression>
          <formalExpression>mary</formalExpression>
        </resourceAssignmentExpression>
      </potentialOwner>
    </userTask>

    <!-- connections -->
    <sequenceFlow id="_5-_3" sourceRef="_5" targetRef="_3" />
    <sequenceFlow id="_1-_4" sourceRef="_1" targetRef="_4" />
    <sequenceFlow id="_4-_5" sourceRef="_4" targetRef="_5" />

  </process>

  <bpmndi:BPMNDiagram>
    <bpmndi:BPMNPlane bpmnElement="com.sample.bpmn.hello" >
      <bpmndi:BPMNShape bpmnElement="_1" >
        <dc:Bounds x="16" y="16" width="48" height="48" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="_3" >
        <dc:Bounds x="360" y="16" width="48" height="48" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="_4" >
        <dc:Bounds x="96" y="16" width="100" height="48" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="_5" >
        <dc:Bounds x="228" y="16" width="100" height="48" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge bpmnElement="_5-_3" >
        <di:waypoint x="278" y="40" />
        <di:waypoint x="384" y="40" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="_1-_4" >
        <di:waypoint x="40" y="40" />
        <di:waypoint x="146" y="40" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="_4-_5" >
        <di:waypoint x="146" y="40" />
        <di:waypoint x="278" y="40" />
      </bpmndi:BPMNEdge>
    </bpmndi:BPMNPlane>
  </bpmndi:BPMNDiagram>

</definitions> 
```

# python - 成功或失败时返回值的线程？

> ID：15952500
> 
> 赞同：0
> 
> 时间：2013-04-11T15:14:28.087
> 
> 标签：python

我有一个函数可以打开一个进程并发送命令、获取结果并在此基础上运行更多命令。在任何阶段它都可能失败并返回，或者在最后打印出成功声明。现在这一切都发生在主线程上，所以我的程序在发生这种情况时停止了（大约需要 6 分钟）。您如何更改此代码以在后台运行但最后打印出我需要的一行？

这是一个片段：

```
def ran_network_listen(access_point_id):
    # "read hnb" command, check if location has IP set.
    proc = subprocess.Popen(cmd_rancli, stdin=subprocess.PIPE, stdout=subprocess.PIPE)
    proc_stdout  = proc.communicate(ran_opt_read_hnb)[0]

    parse = proc_stdout.split('\n')
    list_of_aps = ""
    for item in parse:
        if  access_point_id in item:
            if "n/c" in item:
                print "AP has no ip."
                #return
            else:    
                print item
        list_of_aps += item      

    if not access_point_id in list_of_aps:
        print "AP not registered"
        return
    //etc 
```

首先，我只是尝试了这个：

```
 t = Thread(target=ran_network_listen, args=(args.ap_id,))
  t.start() 
```

然而，不仅仅是在前台运行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T15:57:29.977

您已经在 Python 进程中创建了一个后台*线程*，但您似乎希望在您的 shell 中有一个后台*进程。*

在所有非守护线程完成之前，Python 进程不会退出（它会在关闭时加入它们）。

您可以将整个脚本放入 shell 的后台：

```
bash$ nohup python your_script.py &>output & 
```

或者在[屏幕](http://www.gnu.org/software/screen/)[tmux](http://tmux.sourceforge.net/)内运行它。

Python 进程可以使用包作为[守护进程](http://www.python.org/dev/peps/pep-3143/#correct-daemon-behaviour)[`python-daemon`](https://pypi.python.org/pypi/python-daemon/)，但守护进程通常不用于一次性任务。

# c# - 如何在 SharePoint 2013 中使用 REST API 将附件文件附加到列表项

> ID：15952502
> 
> 赞同：3
> 
> 时间：2013-04-11T15:14:28.757
> 
> 标签：c#, rest, sharepoint, sharepoint-2013

我想请教专家。

有谁知道如何使用 SharePoint 2013 中的 REST API 将附件文件附加到列表项？我搜索了下面的文件。但是没有关于将文件作为列表项的附件上传的信息。

[http://msdn.microsoft.com/en-us/library/fp142386.aspx](http://msdn.microsoft.com/en-us/library/fp142386.aspx)

附加信息：

我找到了下面的文章。

[http://chuvash.eu/2013/02/20/rest-api-add-a-plain-text-file-as-an-attachment-to-a-list-item/](http://chuvash.eu/2013/02/20/rest-api-add-a-plain-text-file-as-an-attachment-to-a-list-item/)

根据这篇文章，可以使用下面的 Javascript 代码将附件文件上传到列表项。我想使用 C#。我现在正在尝试，但我仍然没有成功。

```
var content = "Hello, this text is inside the file created with REST API";
var digest = $("#__REQUESTDIGEST").val();
var composedUrl = "/_api/web/lists/GetByTitle('List1')/items(1)/AttachmentFiles/add(FileName='readme.txt')";
$.ajax({
    url: composedUrl,
    type: "POST",
    data: content,
    headers: {        
        "X-RequestDigest": digest
    }
}) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-10-29T12:18:28.350

有几种方法可以使用 .NET 使用 SharePoint REST API，下面列出了其中一些方法：

*   [HttpClient](http://msdn.microsoft.com/en-us/library/system.net.http.httpclient(v=vs.118).aspx) - 提供用于发送 HTTP 请求和从 URI 标识的资源接收 HTTP 响应的基类。( `.NET Framework 4.5`)
*   [WebClient](http://msdn.microsoft.com/en-us/library/system.net.webclient(v=vs.110).aspx) - 提供向由 URI 标识的资源发送数据和从其接收数据的常用方法。( `.NET Framework 1.1`)
*   [HttpWebRequest](http://msdn.microsoft.com/en-us/library/system.net.httpwebrequest(v=vs.110).aspx) - 提供 WebRequest 类的特定于 HTTP 的实现，比之前的更底层

所有这些都允许使用 REST 接口在 SharePoint Online/SharePoint 2013 中执行 CRUD 操作。

[SPWebClient 类](https://gist.github.com/vgrem/7eff63ad7d001d0e4c8f)演示了如何使用[WebClient](http://msdn.microsoft.com/en-us/library/system.net.webclient(v=vs.110).aspx)执行 CRUD 操作。

## 如何通过 SharePoint REST API 添加附件文件

以下示例演示如何将附件文件添加到 SharePoint Online 中的列表：

```
var credentials = new SharePointOnlineCredentials(userName, securePassword);
AddAttachmentFile(webUrl, credentials, "Nokia Offices", 1, @"c:\upload\Nokia Head Office in Espoo.jpg");

public static void AddAttachmentFile(string webUrl,ICredentials credentials,string listTitle,int itemId,string filePath)
{
        using (var client = new SPWebClient(new Uri(webUrl),credentials))
        {
            var fileContent = System.IO.File.ReadAllBytes(filePath);
            var fileName = System.IO.Path.GetFileName(filePath);
            var endpointUrl = string.Format("{0}/_api/web/lists/GetByTitle('{1}')/items({2})/AttachmentFiles/add(FileName='{3}')", webUrl,listTitle,itemId,fileName);
            client.UploadFile(new Uri(endpointUrl), fileContent);
        }
} 
```

依赖项：

*   利用代表[WebClient包装器的](http://msdn.microsoft.com/en-us/library/system.net.webclient(v=vs.110).aspx)[SPWebClient 类](https://gist.github.com/vgrem/7eff63ad7d001d0e4c8f)
*   [Json.NET 库](http://james.newtonking.com/json)依赖

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-02T02:38:17.107

尝试使用这个：

```
var executor = new SP.RequestExecutor(appweburl);
var digest = $("#__REQUESTDIGEST").val();
var content = "Hello, this text is inside the file created with REST API";

executor.executeAsync(
{
url: appweburl +           "/_api/web/lists/getbytitle('List1')/items(1)/AttachmentFiles/add(FileName='readme.txt)",
method: "POST",
body: content,
headers: {
          "X-RequestDigest": digest
         },
success: function(data) {
         toastr.success('Document attached successfully.');
         },
error: function(err) {
         toastr.error('Oops! Document attached created fail.');
         }
}
); 
```

# php - 映射的教义错误

> ID：15952505
> 
> 赞同：2
> 
> 时间：2013-04-11T15:14:42.207
> 
> 标签：php, symfony, doctrine-orm, mapping

我正在 Symfony2 中创建一个项目，我正在创建实体并且我有一个 ManyToOne 关联，当我尝试从数据库中获取数据时，我收到了这个错误：

```
The association Ueb\Creator\Bundle\ModuleBundle\Entity\GenericBlock#fields refers to the owning side field Ueb\Creator\Bundle\ModuleBundle\Entity\GenericField#idGenericBlock which is not defined as association.
The association Ueb\Creator\Bundle\ModuleBundle\Entity\GenericBlock#fields refers to the owning side field Ueb\Creator\Bundle\ModuleBundle\Entity\GenericField#idGenericBlock which does not exist. 
```

我有这个类的：

通用字段

```
 /**
  * GenericField
  *
  * @ORM\Table(name="crt_generic_field")
  * @ORM\Entity(repositoryClass="Ueb\Creator\Bundle\ModuleBundle\Entity\Repository\GenericFieldRepository")
 */
 class GenericField
 {
 /**
 * @var integer
 *
 * @ORM\Column(name="id", type="integer")
 * @ORM\Id
 * @ORM\GeneratedValue(strategy="AUTO")
 */
private $id;

/**
 * @var integer
 *
 * @ORM\Column(name="id_generic_block")
 * @ORM\ManyToOne(targetEntity="Ueb\Creator\Bundle\ModuleBundle\Entity\GenericBlock", inversedBy="fields")
 * @ORM\JoinColumn(name="id_generic_block", referencedColumnName="id",nullable=false)
 */
private $idGenericBlock;

/**
 * @var integer
 *
 * @ORM\Column(name="id_field_type")
 * @ORM\ManyToOne(targetEntity="Ueb\Creator\Bundle\ModuleBundle\Entity\FieldTypes")
 * @ORM\JoinColumn(name="id_field_type", referencedColumnName="id",nullable=false)
 */
private $idFieldType;

/**
 * @var integer
 *
 * @ORM\Column(name="isRequired", type="integer")
 */
private $isRequired;

/**
 * @var string
 *
 * @ORM\Column(name="field_name", type="string", length=40)
 */
private $fieldName;

/**
 * @var integer
 *
 * @ORM\Column(name="position", type="integer")
 */
private $position;

/**
 * @var string
 *
 * @ORM\Column(name="field_description", type="string", length=255)
 */
private $fieldDescription;

/**
 * @var array
 *
 * @ORM\Column(name="adicional_info", type="array")
 */
private $adicionalInfo; 
```

还有我的班级 GenericBlock

```
/**
 * GenericBlock
 *
 * @ORM\Table(name="crt_generic_block")
 * @ORM\Entity(repositoryClass="Ueb\Creator\Bundle\ModuleBundle\Entity\Repository\GenericBlockRepository")
 */
 class GenericBlock
 {

/**
 * @var integer
 *
 * @ORM\Column(name="id", type="integer")
 * @ORM\Id
 * @ORM\GeneratedValue(strategy="AUTO")
 */
private $id;

/**
 * @var string
 *
 * @ORM\Column(name="blockName", type="string", length=40)
 * 
 */
private $blockName;

/**
 * @var string
 *
 * @ORM\Column(name="itemBlockName", type="string", length=40)
 */
private $itemBlockName;

/**
 * @var string
 *
 * @ORM\Column(name="blockDescription", type="string", length=255)
 */
private $blockDescription;

/**
 * @var \DateTime
 *
 * @ORM\Column(name="createdAt", type="date")
 */
private $createdAt;

/**
 * @var integer
 *
 * @ORM\Column(name="createdBy")
 * @ORM\ManyToOne(targetEntity="Ueb\Accounts\Bundle\UserBundle\Entity\User")
 * @ORM\JoinColumn(name="createdBy", referencedColumnName="id",nullable=true)
 *
 */
private $createdBy;

/**
 * @var ArrayCollection
 * 
 * @ORM\OneToMany(targetEntity="Ueb\Creator\Bundle\ModuleBundle\Entity\GenericField", mappedBy="idGenericBlock", cascade={"all"})
 */
private  $fields; 
```

我已经看到了一些具有相同错误的问题，并尝试了建议的答案，但没有一个有效，所以我不知道还能做什么，这一定是一个愚蠢的错误。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-11T16:16:50.257

这是前段时间，但我得出结论，`@Column`不能`@JoinColumn`一起使用。如果您提交的是关系，则应`@Column`在此处省略。例如：

```
/**
 * @var integer
 *
 * @ORM\Column(name="id_generic_block") <--- ***remove this***
 * @ORM\ManyToOne(targetEntity="Ueb\Creator\Bundle\ModuleBundle\Entity\GenericBlock", inversedBy="fields")
 * @ORM\JoinColumn(name="id_generic_block", referencedColumnName="id",nullable=false)
 */
private $idGenericBlock; 
```

希望这可以帮助...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-11T17:01:37.347

非常重要的是，当您使用 Doctrine 2 时，您需要映射与对象的关系，您需要以面向对象的方式（而不是关系方式）来考虑实体的设计，使用组合和聚合来制作对象关系. 我强烈建议您阅读 Doctrine 2 文档。

例如，`GenericField`应该如下所示：

```
/**
 * GenericField
 *
 * @ORM\Table(name="crt_generic_field")
 * @ORM\Entity(repositoryClass="Ueb\Creator\Bundle\ModuleBundle\Entity\Repository\GenericFieldRepository")
 */
class GenericField
 {
     /**
     * @var integer
     *
     * @ORM\Column(name="id", type="integer")
     * @ORM\Id
     * @ORM\GeneratedValue(strategy="AUTO")
     */
    private $id;

    /**
     * @var Ueb\Creator\Bundle\ModuleBundle\Entity\GenericBlock
     *
     * @ORM\ManyToOne(targetEntity="Ueb\Creator\Bundle\ModuleBundle\Entity\GenericBlock", inversedBy="fields")
     * @ORM\JoinColumn(name="id_generic_block", referencedColumnName="id",nullable=false)
     */
    private $genericBlock;

    /**
     * @var Ueb\Creator\Bundle\ModuleBundle\Entity\FieldTypes
     *
     * @ORM\ManyToOne(targetEntity="Ueb\Creator\Bundle\ModuleBundle\Entity\FieldTypes")
     * @ORM\JoinColumn(name="id_field_type", referencedColumnName="id",nullable=false)
     */
    private $fieldType;

    /**
     * @var integer
     *
     * @ORM\Column(name="isRequired", type="integer")
     */
    private $isRequired;

    /**
     * @var string
     *
     * @ORM\Column(name="field_name", type="string", length=40)
     */
    private $fieldName;

    /**
     * @var integer
     *
     * @ORM\Column(name="position", type="integer")
     */
    private $position;

    /**
     * @var string
     *
     * @ORM\Column(name="field_description", type="string", length=255)
     */
    private $fieldDescription;

    /**
     * @var array
     *
     * @ORM\Column(name="adicional_info", type="array")
     */
    private $adicionalInfo;
    ...
} 
```

非常重要的是，您要了解它`GenericField`没有`idGenericBlock`整数属性，而是`GenericBlock`名为`genericBlock`映射在列上的类的对象`id_generic_block`（与 相同`fieldType`）。

哦，我注意到您的实体的另一个问题：应该`isRequired`映射为`boolean`？应该`adicionalInfo`是`additionalInfo`（我想你和我一样是西班牙裔:)）？

同样，我建议您仔细阅读[Doctrine 2 文档](http://docs.doctrine-project.org/en/latest/)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-12T04:44:51.770

理想情况下，您应该将关系映射放在两个实体上。

例子

我的类别实体

```
/**
 * @ORM\OneToMany(targetEntity="Product", mappedBy="category")
 */
protected $products;

public function __construct()
{
   $this->products = new ArrayCollection();
} 
```

我的产品实体

```
/**
 * @ORM\ManyToOne(targetEntity="Category", inversedBy="products")
 * @ORM\JoinColumn(name="category_id", referencedColumnName="id")
 */
protected $category; 
```

你甚至应该在产品类别实体中有方法

```
public function __toString() 
```

尝试遵循这个

[http://symfony.com/doc/current/book/doctrine.html](http://symfony.com/doc/current/book/doctrine.html)

查看实体关系/关联。它会帮你解决

# python - Python + SSL + 需要 SSL IIS 选项

> ID：15952506
> 
> 赞同：1
> 
> 时间：2013-04-11T15:14:43.150
> 
> 标签：python, iis, ssl

我正在尝试解决以下问题：

我的生产服务器上有带有有效通配符 ssl 证书的 IIS。该站点同时绑定到 somedomain.com:80 和 somedomain.com:443。

另外，我有从站点获取数据的 Python (2.6.4) 应用程序。

在我检查 Require SSL IIS 选项之前，我没有任何问题。之后我遇到了以下麻烦：

```
import requests
r = requests.get('https://somedomain.com/api/list') 
```

返回 403 错误。

urllib2、httplib2 会发生这样的事情。

但！最奇怪的是：

```
import httplib
con = httplib.HTTPSConnection('somedomain.com')
con.request('GET', '/api/list')
r1 = con.getresponse() 
```

它分叉很好！它返回带有 200 状态码的正确数据。

会是什么？

当然，浏览器（Chrome、Epiphany）在开发主机上运行良好。

# matplotlib - 代表matplotlib中稳态的迭代发展

> ID：15952514
> 
> 赞同：0
> 
> 时间：2013-04-11T15:15:06.307
> 
> 标签：matplotlib, iteration

我想使用 matplotlib 生成一个类似于这个的图形：

![http://imgur.com/Pa254yn](https://i.stack.imgur.com/DcQyS.png)

在我的例子中，我实际上有两个方程，一个是线性的，一个是大致矩形的双曲线，我想展示一个迭代过程，通过该迭代过程，第二周期的稳定状态会演变。我可以很容易地绘制这两个函数，但是添加带有箭头的线段，通过对角线 x=y 演示曲线之间的振荡随时间的稳定状态。

字典引用是指确定函数确切形状的变量。我特别想知道如何绘制如下图中的线段，假设我可以生成必要的坐标。

此外，在第一个 y 轴正下方附加第二个 y 轴（但也许这应该是一个单独的问题）。

```
def rot_time_series(self):
    fig = plt.figure(figsize=(10, 10), frameon = False)
    ax1 = fig.add_subplot(211)
    ax2 = fig.add_subplot(212)

    x_vals = np.arange(0,100,0.1)
    values = np.empty([len(x_vals), 3])

    for i in range(len(x_vals)):
        y_A = self.mp['cA']['a'] * x_vals[i] + self.mp['cA']['b'] * x_vals[i] / (self.mp['cA']['c'] + x_vals[i])
        y_B = self.mp['cB']['a'] * x_vals[i]
        values[i,0] = x_vals[i]
        values[i, 1] = y_A
        values[i, 2] = y_B

    #mplot.rc('text', usetex=True)
    mplot.rc('font', family='serif')
    ax1.set_xlabel(r'$N_t$')
    ax1.set_ylabel(r'$N_{t+1}$')
    ax1.plot(values[:,0], values[:,0], color="black", linewidth=2, linestyle="-")
    ax1.plot(values[:,0], values[:,1], color="blue", linewidth=2, linestyle="--")
    ax1.plot(values[:,0], values[:,2], color="red", linewidth=2, linestyle="-.")
    plt.show() 
```

# regex - 正则表达式：删除非字母数字，但有一个例外

> ID：15952515
> 
> 赞同：15
> 
> 时间：2013-04-11T15:15:09.400
> 
> 标签：regex, postgresql

要删除所有非字母数字字符，正则表达式将是

```
x = regexp_replace(somestring, '[^a-zA-Z0-9]+', '', 'g') 
```

但是如果我想保持下划线不变呢？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-04-11T15:19:49.170

然后你需要使用：

```
x = regexp_replace(somestring, '\W+', '', 'g') 
```

`\W`是相同的`[^a-zA-Z0-9_]`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-11T15:18:53.473

如何使用 '\W+' 替换所有非 az 和 0-9 留下 _

所以

```
x = regexp_replace(somestring, '\W+', '', 'g') 
```

# c# - 将屏幕转换为客户端坐标问题

> ID：15952517
> 
> 赞同：2
> 
> 时间：2013-04-11T15:15:18.060
> 
> 标签：c#, .net, winforms

我有一个名为 RackViewer 的控件，其中包含另一个名为 ItemViewer 的控件。RackViewer 控件被动态添加到另一个父控件。在父控件中，我希望创建一个拖放事件，这样当用户将项目拖动到 RackViewer 中的 ItemViewer 控件上时，该事件就会触发。目前我正在这样做：

```
private void RackView_DragEnter(object sender, DragEventArgs e)
{
    RackViewer rackView = (RackViewer)sender;
    if (rackView.IsMouseOnItemViewer(rackView.PointToClient(new Point(e.X, e.Y))))
    {
        //content goes here
    }
}

private void RackView_DragDrop(object sender, DragEventArgs e)
{
    RackViewer rackView = (RackViewer)sender;
    if(rackView.IsMouseOnItemViewer(rackView.PointToClient(new Point(e.X, e.Y))))
    {
        //content goes here
    }
}

private void listbox_MouseDown(object sender, MouseEventArgs e)
{
    ListBox dragDropSender = (ListBox)sender;
    int index = dragDropSender.IndexFromPoint(new Point(e.X, e.Y));
    if (index >= 0)
    {
        dragDropSender.SelectedIndex = index;
        dragDropSender.DoDragDrop(dragDropSender.SelectedItem, DragDropEffects.Move);
    }
} 
```

请注意 IsMouseOnItemViewer 方法。此方法包含在 rackViewer 类中，并在继续拖放事件序列之前确认用户正在将项目拖动到 ItemViewer 上。我这样做的原因是因为我无法从 RackViewer 的父控件访问 ItemViewer，因为它是层次结构中更高的 2 个控件。“IsMouseOnItemViewer”方法如下所示：

```
 public ItemViewer View { get {return itemViewer; } }

/// <param name="mousePoint"> The coordinates of the mouse in client coordinates. </param>
    /// <returns> True if the user is hovering over the ItemViewer control and false otherwise.</returns>
    public bool IsMouseOnItemViewer(Point mousePoint)
    {
        if (View.Bounds.Contains(mousePoint))
            return true;
        else
            return false;
    } 
```

但是，由于某种原因，此事件永远不会返回 true！无论我将鼠标拖动到 RackViewer 控件上的哪个位置，它似乎都不会检测到它位于 ItemViewer 上。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T15:57:08.627

好的，我发现了错误。我的问题是dragEnter 事件只触发一次，并且当鼠标将项目拖到rackviewer 上时它会立即触发。因此，鼠标将永远没有时间真正到达 ItemViewer。谢谢你的帮助。我将不得不使用比 DragEnter 更动态的东西。

# javascript - dojo 自定义小部件不会调用 postCreate

> ID：15952518
> 
> 赞同：0
> 
> 时间：2013-04-11T15:15:19.053
> 
> 标签：javascript, widget, dojo, amd

我有一个无法正常工作的自定义小部件。它正在被实例化，但它不会调用该`postCreate`函数。我没有收到任何错误消息。

出于测试目的，我从小部件中删除了任何额外的代码，这是生成的代码：

```
define(["dojo/_base/declare",
        "dojo/_base/lang",
        "dijit/_WidgetBase",
        "dijit/_TemplatedMixin",
        "dijit/_WidgetsInTemplateMixin",
        "dojox/mobile/Button",
        "dojo/text!pgonline/widgets/AttributeInspector/templates/AttributeInspector.html"],

    function(declare,
             lang,
             _WidgetBase,
             _TemplatedMixin,
             _WidgetsInTemplateMixin,
             Button,
             template) {

        return declare("AttributeInspector2", [_WidgetBase, _TemplatedMixin, _WidgetsInTemplateMixin], {

            templateString : template,
            baseClass : "AttributeInspector2",
            postCreate : function() {
                dojo.connect(this, "onBeforeTransitionIn", lang.hitch(this, this.onPageLoad));
            },

            onPageLoad : function() {
            }
        });
    }); 
```

我可以说它正在被实例化，因为当我在 Chrome 中调试时，我可以在该行设置一个断点：`templateString : template`它会在该断点处停止，但它不会在`postCreate`函数内部代码的断点处停止。模板本身是一个简单的 HTML 文件，其中包含几个`div`'s 和一个`dojox.mobile.button`.

**更新：**

下面是实例化代码：

```
require(["pgonline/widgets/AttributeInspector2"], function(AttributeInspector) {

    var att = new AttributeInspector({});

att.placeAt("attributeInspector");
att.startup();

}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T16:42:03.513

这可能不符合实际，但根据您的[fiddle](http://jsfiddle.net/dgtGs/)，控制台中的错误是`Uncaught Error: Invalid template`

您的模板如下所示：

```
<div>
    <button data-dojo-attach-point='prevButton' data-dojo-type='dojox.mobile.Button'></button>
    <button data-dojo-attach-point='nextButton'></button>
</div>
<div data-dojo-attach-point='attributes'></div> 
```

Dijit 要求模板具有单个根节点——作为修复，只需在模板中添加一个包含 div

```
<div>
    <div>
        <button data-dojo-attach-point='prevButton' data-dojo-type='dojox.mobile.Button'></button>
        <button data-dojo-attach-point='nextButton'></button>
    </div>
    <div data-dojo-attach-point='attributes'></div>
</div> 
```

# dynamic - Go 接口：静态与动态绑定

> ID：15952519
> 
> 赞同：3
> 
> 时间：2013-04-11T15:15:21.777
> 
> 标签：dynamic, binding, interface, static, go

Go 使用动态和静态绑定。据我了解，如果您需要使用类型断言，那么它是动态的。我想验证我的假设。

```
type Xer interface { 
  X()
}

type XYer interface {
  Xer
  Y()
}

type Foo struct{}
func (Foo) X() { println("Foo#X()") }
func (Foo) Y() { println("Foo#Y()") } 
```

**假设：**

```
foo := Foo{}

// static: Foo -> XYer
var xy XYer = foo

// static: XYer -> Xer
var x Xer = xy

// static: Xer -> interface{}
var empty interface{} = x

// dynamic: interface{} -> XYer
xy2 := empty.(XYer)

// dynamic: XYer -> Foo
foo2 := xy2.(Foo) 
```

因此，从`type A`->转换时`interface B`，如果`A`满足，`B`则不需要断言，并且可以在编译时生成 itable。如果您在不需要的地方使用断言，情况会怎样：

```
var x Xer = Foo{}
empty := x.(interface{}) 
```

在这种情况下会发生什么？如果有人可以为我澄清这一点，那就太好了。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-11T15:41:53.370

为了扩展 jnml 的答案，`6g`仍然会生成一个类型断言。

```
empty := x.(interface{}) 
```

扩展为：

```
0034 (dumb.go:19) MOVQ    $type.interface {}+0(SB),(SP)
0035 (dumb.go:19) LEAQ    8(SP),BX
0036 (dumb.go:19) MOVQ    x+-32(SP),BP
0037 (dumb.go:19) MOVQ    BP,(BX)
0038 (dumb.go:19) MOVQ    x+-24(SP),BP
0039 (dumb.go:19) MOVQ    BP,8(BX)
0040 (dumb.go:19) CALL    ,runtime.assertI2E+0(SB)
0041 (dumb.go:19) MOVQ    24(SP),BX
0042 (dumb.go:19) MOVQ    BX,empty+-16(SP)
0043 (dumb.go:19) MOVQ    32(SP),BX
0044 (dumb.go:19) MOVQ    BX,empty+-8(SP) 
```

为了澄清这里发生了什么，在第 34 行中，[`InterfaceType`](https://code.google.com/p/go/source/browse/src/pkg/runtime/type.h?name=go1.0.3#99)of`interface{}`被加载到堆栈的第一个值。第 35-36 和 37-38 行将[选项卡和数据值](https://code.google.com/p/go/source/browse/src/pkg/runtime/runtime.h?name=go1.0.3#135)放入`x` 堆栈。然后堆栈准备好调用[runtime.assertI2E](https://code.google.com/p/go/source/browse/src/pkg/runtime/iface.c?name=go1.0.3#345)，它只是将基础类型和数据分配给返回值。编译器知道您分配给一个空接口，因此调用`assertI2E`:`I2E`代表接口到[Eface](https://code.google.com/p/go/source/browse/src/pkg/runtime/runtime.h?name=go1.0.3#140)（空接口），因此不需要检查方法。唯一的限制`assertI2E`是断言的值必须是一个接口。

但是，如果您正在执行`x.(Xer)`,[`runtime.assertI2I`](https://code.google.com/p/go/source/browse/src/pkg/runtime/iface.c?name=go1.0.3#420)将被调用，然后[检查](https://code.google.com/p/go/source/browse/src/pkg/runtime/iface.c?name=go1.0.3#416)方法是否实现了接口。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-11T15:31:36.580

我不知道什么是接口的静态绑定或接口的动态绑定。语言规范从未提及此类术语。让我假设您的意思是编译时的类型检查和运行时的类型检查。有了这个假设，你所有的例子，A​​FAICS，都是正确的。它归结为一个简单的模式（相关语言规范部分的浓缩版本）：

*   所有的赋值都在编译时进行类型检查。
*   所有类型断言 ( `.(T)`) 在运行时都经过类型检查。

这也回答了*“在这种情况下会发生什么？”* .

也就是说，编译器可以自由优化可以在编译时证明类型已知且分配兼容的情况。但这只是一个不能依赖的实现细节——因为它可能不是其他符合规范的实现的情况。

实际上 gc 编译器具有（IINM）这样的优化，甚至在相反的意义上。它可以说“不可能的类型断言”，它可以在编译时证明类型断言将失败。

# vim - vimdiff：在“蓝色”行之间跳转（文件中没有相应文本的行进行比较）

> ID：15952521
> 
> 赞同：1
> 
> 时间：2013-04-11T15:15:23.397
> 
> 标签：vim, string-matching, vimdiff

我必须比较两个（汇编）文件，看看指令不匹配的地方。

在我使用的 vimdiff 中，有两种颜色来标记文本的差异。1\. 蓝色：当其他文件中没有要比较的文本时。2\. 粉红色：当两个文件具有相似的文本但它们在几个字符上有所不同时。

完全匹配的线条具有黑色背景。

我正在寻找从一个“蓝色”区域跳到下一个区域的捷径。 ![样本](https://i.stack.imgur.com/gCmHf.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T15:28:21.437

用于`[c`跳转到上一个更改并`]c`跳转到下一个更改。

并阅读`:h diff`。

# algorithm - 布隆过滤器：评估误报率

> ID：15952524
> 
> 赞同：0
> 
> 时间：2013-04-11T15:15:28.777
> 
> 标签：algorithm, math, data-structures, probability, bloom-filter

给定固定数量的比特（例如槽）（m）和固定数量的散列函数（k），如何计算理论误报率（p）？

根据 Wikipedia [http://en.wikipedia.org/wiki/Bloom_filter](http://en.wikipedia.org/wiki/Bloom_filter)，对于误报率 (p) 和项目数 (n)，所需的位数 (m)`m = - n * l(p) / (l(2)^2)` 由散列函数 (k) 由 给出`k = m / n * l(2)`。

根据维基百科页面中给出的公式，我想我可以通过以下方式评估理论误报率（p）：`p = (1 - e(-(k * n/m)))^k`

但是维基百科有另一个公式 (p) ：`p = e(-m/n*(l(2)^2))`我想，假设 (k) 是散列函数的最佳数量。

在我的示例中，我采用`n = 1000000`和`m = n * 2`，(k) 的最佳值为 1.386，根据前面的公式，理论误报率 (p) 将为 0.382。让我们选择函数的数量，计算给定固定值 (k) 的理论误报率 (p) 并计算所需的理论位数 ​​(m')：

```
for k = 1, p = .393 and m' = 1941401
for k = 2, p = .399 and m' = 1909344
for k = 3, p = .469 and m' = 1576527
for k = 4, p = .559 and m' = 1210636 
```

过滤器中填充的位越多，我们得到的误报就越多。似乎合乎逻辑。

**但是，在给定固定 (k)、(m) 和 (n) 的情况下，是否可以确认该公式`p = (1 - e(-(k * n/m)))^k`对于获得理论上的误报率是正确的？**

注意：这里似乎已经提出了这个问题：[使用固定数量的函数，在给定误报概率的情况下，我如何计算布隆过滤器的大小？](https://stackoverflow.com/questions/8556432/with-fixed-number-of-functions-how-can-i-calculate-the-size-of-a-bloom-filter-g)但没有与我的确切问题相匹配的答案。 [我的布隆过滤器需要多少个哈希函数？](https://stackoverflow.com/questions/658439/how-many-hash-functions-does-my-bloom-filter-need)可能很有趣，但又不完全相同。

问候

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-06-05T23:00:05.387

m – 位数组中的元素数 n – 集合中的项目数 p – 误报概率 // 0.0 – 1.0 ^ – 幂

p = e^(-(m/n) * (ln(2)^2));

我写了一个关于 Bloom Filters 的数学友好教程：http: [//techefigy.wordpress.com/2014/06/05/bloom-filter-tutorial/](http://techeffigy.wordpress.com/2014/06/05/bloom-filter-tutorial/)

# html - 如何使 Facebook 评论具有 100% 的流体宽度？

> ID：15952527
> 
> 赞同：1
> 
> 时间：2013-04-11T15:15:37.123
> 
> 标签：html, css, facebook

[http://developers.facebook.com/docs/reference/plugins/comments/](http://developers.facebook.com/docs/reference/plugins/comments/)

这是我在页面上包含 Facebook javascript SDK 后生成评论区域的方式：

```
<div class="fb-comments fb-comments-update" data-href="http://site.com" data-width="600" data-colorscheme="light" data-num-posts="10" data-order-by="social" data-mobile="auto-detect"></div> 
```

如您所见，facebook 根据您提供的此数据属性设置评论区域的宽度：

```
data-width="600" 
```

在这种情况下，我告诉 facebook 我希望该区域为 600 像素。但我目前正在构建一个响应式站点，并且需要评论部分以 100% 适应屏幕的宽度。不做这些工作：

```
data-width="100"
data-width="100%" 
```

有什么方法可以让 facebook 评论的宽度变宽吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-12-15T20:13:46.133

试试这个代码：

```
<style>.fb-comments, .fb-comments iframe[style], .fb-like-box, .fb-like-box iframe[style] {width: 100% !important;}
.fb-comments span, .fb-comments iframe span[style], .fb-like-box span, .fb-like-box iframe span[style] {width: 100% !important;}
</style> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-11T15:47:35.120

第一个尺寸适用于小于 1200 像素和大于 979 像素的设备。有时唯一的问题是 IE，但您可以使用类似的东西：`width: 1200px\9;`- IE 8 及更高版本

此示例来自我经常使用的[bootstrap 。](http://twitter.github.io/bootstrap/)要使用它，您需要更少的[win 版本](http://winless.org/)。但是这段代码可以在浏览器中运行（旧的 IE 除外）。

```
.fb-comments { width: 490px; /* or width: 50%; */ }

/* Large desktop */
@media (min-width: 1200px) {
    .fb-comments { width: 600px; /* or width: 50%; */ }
}

/* Portrait tablet to landscape and desktop */
@media (min-width: 768px) and (max-width: 979px) {
    .fb-comments { width: 400px; /* or width: 50%; */ }
}

/* Landscape phone to portrait tablet */
@media (max-width: 767px) {
    .fb-comments { width: 30px; /* or width: 50%; */ }
}

/* Landscape phones and down */
@media (max-width: 480px) {
    .fb-comments { width: 200px; /* or width: 50%; */ }
} 
```

也尝试使用百分比，而不是像素，即使有填充，例如：

```
.fb-comments { width: 90%; height: auto; padding: 0 5%; } 
```

# android - 在原生 Android 应用中使用 WebGL

> ID：15952538
> 
> 赞同：2
> 
> 时间：2013-04-11T15:16:08.983
> 
> 标签：android, ios, webgl

我需要在 web、android 和 iOS 平台上制作 3D 动画。我的问题是，是否可以使用 WebGL 在原生 android 和 iOS 应用程序中制作动画？因为我会编写一次动画，理论上它可以毫无问题地移植到 android 和 iOS，或者我将不得不简单地使用 OpenGL ES 来制作移动设备的动画和 web 的 webGL。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-19T05:48:54.850

免责声明：我在路德工作

所以，这正是[一家名为 ludei 的公司准备推出的产品](http://thenextweb.com/insider/2013/03/25/ludei-to-add-webgl-3d-support-this-summer-as-it-opens-up-its-html5-game-platform-to-more-titles/)；）

我们让它在 Android 2.3（甚至在 Nexus One 上！）到 4.2 和 iOS 4（我认为？）及更高版本上运行。我们不依赖系统浏览器或 webviews，因此不存在“私有库”问题，并且我们支持其他不能有 WebGL 的 Android 版本。

我们现在正在对其进行最后的润色，但我们应该能够在几周内发布它 :)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T16:09:30.627

并非所有浏览器都完全支持 WebGL，但是 Android 和 iOS 都有可以使用的原生 OpenGL 视图（并且将提供比 WebGL 更快的体验）。为每个平台设置好环境后，使用相同的代码将非常简单。

虽然 cocos2d-x 不支持 3D 动画，但它的[文档](http://www.cocos2d-x.org/projects/cocos2d-x/wiki)可以帮助您开始使用 openGL 的跨平台应用程序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-12T17:07:10.210

查看[http://impactjs.com/](http://impactjs.com/)对于 iOS，他们现在允许您使用 threeJS //asmallgame.com/labsopen/webgl_impact/ 对于 Android 它仅在 Chrome Beta 上受支持，您必须启用标志[http:/ /thenextweb.com/google/2013/01/25/google-finally-makes-it-easy-to-enable-webgl-support-in-latest-chrome-for-android-beta/](http://thenextweb.com/google/2013/01/25/google-finally-makes-it-easy-to-enable-webgl-support-in-latest-chrome-for-android-beta/)我希望 webGL 能够完全支持关键的石灰派版本的 android 即将推出。您也可以破解 iAd 平台以在 iOS 上支持它，但由于使用私有库，您将无法通过应用商店获得它。github.com/benvanik/WebGLBrowser 也请注意 github.com/kripken/emscripten，因为 firefox 最近在 odin monkey techcrunch.com/2013/03/21/firefox-nightly-now-includes-odinmonkey-brings-上推出了 asmJS javascript-performance-closer-to-running-at-native-speeds/ 这使得 firefox 能够在上一次 GDC 的几天内将虚幻引擎移植到 webgl，因此希望 chrome 和其他浏览器开始支持 asmJS 以获得明显的速度提升。techcrunch.com/2013/03/27/mozilla-and-epic-games-bring-unreal-engine-3-to-the-web-no-plugin-needed/

# python - 这两个python函数有什么区别？

> ID：15952554
> 
> 赞同：1
> 
> 时间：2013-04-11T15:16:40.907
> 
> 标签：python, if-statement, python-2.7, return

我无法理解我在 Python 中看到的一些简写符号。请问有人可以解释这两个功能之间的区别吗？谢谢你。

```
def test1():
   first = "David"
   last = "Smith"
   if first and last:
      print last

def test2():
   first = "David"
   last = "Smith"
   print first and last 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-11T15:17:21.787

第一个函数总是返回`None`（打印`Smith`），而第二个函数总是返回`"Smith"`*

**快速题外话`and`：**

python`and`运算符返回它遇到的第一个“假”值。如果它没有遇到“假”值，则返回最后一个值（即“true-y”）这解释了原因：

```
"David" and "Smith" 
```

总是返回`"Smith"`。由于两者都是非空字符串，它们都是“真-y”值。

```
"" and "Smith" 
```

会返回`""`，因为它是一个虚假值。

* * *

* OP 发布的原始函数实际上是这样的：

```
def test2():
   first = "David"
   last = "Smith"
   return first and last 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-11T15:49:08.530

`test1()`函数和之间的区别在于，只要表达式的结果为真，就会显式打印 的值，并`test2()`打印`test1()`表达式的结果。打印的字符串是相同的，因为表达式的结果是 - 的值，但仅仅是因为计算结果为真。`last``first and last``test2()``first and last``first and last``last``first`

在 Python 中，如果表达式的左侧`and`计算结果为真，则表达式的结果是该表达式的右侧。由于布尔运算符的短路，如果`and`表达式的左侧计算为假，则返回表达式的左侧。

`or`在 Python 中也会短路，返回表达式最左边的值，它决定了整个表达式的真值。

所以，看看更多的测试功能：

```
def test3():
    first = ""
    last = "Smith"
    if first and last:
        print last

def test4():
    first = ""
    last = "Smith"
    print first and last

def test5():
    first = "David"
    last = "Smith"
    if first or last:
        print last

def test6():
    first = "David"
    last = "Smith"
    print first or last

def test7():
    first = "David"
    last = ""
    if first or last:
        print last

def test8():
    first = "David"
    last = ""
    print first or last 
```

`test3()`不会打印任何东西。
`test4()`将打印`""`。

`test5()`将打印`"Smith"`。
`test6()`将打印`"David"`。

`test7()`将打印`""`。
`test8()`将打印`"David"`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-11T15:57:20.063

你问，这两个片段之间有什么区别？

```
if first and last:
  print last 
```

和

```
print first and last 
```

在第一种情况下，代码要么打印 last 的值，要么不打印。

在第二种情况下，代码将打印 的值`first and last`。如果您习惯于 C，那么您可能会认为 的值`a and b`是布尔值 True 或 False。但你错了。

`a and b`评估`a`；如果`a`为真，则表达式的值为`b`。如果`a`是错误的，则表达式的值为`a`：

```
"David" and "Smith" -> "Smith"
0 and "Smith" -> 0
1 and "Smith" -> "Smith" 
"David" and 0 -> 0
"David" and 1 -> 1 
```

一般来说：

*   第一个有时会打印一些东西，而其他时候不打印一些东西。
    *   第二个总是打印一些东西。
*   第一个打印`last`，如果它打印任何东西
    *   根据 的真实性，第二个打印要么`first`要么。`last``first`

具体来说，如果`first`is ever `""`，则第二个示例将打印`""`，而第一个示例根本不会打印任何内容。

# string - 从Perl中的拆分中过滤数组中的空字符串？

> ID：15952555
> 
> 赞同：0
> 
> 时间：2013-04-11T15:16:44.307
> 
> 标签：string, perl, split

我最初对此感到困惑：当我注意到这一点时，我正在研究 Perl 中的字符分割功能：

```
 DB<56> map(print("-", $_, "\n"), split( //, "test")  );
-t
-e
-s
-t

  DB<57> map(print("-", $_, "\n"), split( /./, "test")  );

  DB<58> map(print("-", $_, "\n"), split( /(.)/, "test")  );
-
-t
-
-e
-
-s
-
-t 
```

我已经知道，[如果使用空的正则表达式 // ，字符串会被分割成单独的字符](http://perldoc.perl.org/perlrequick.html)；但我不清楚`/(.)/`正则表达式中的那些空字符串是从哪里来的——但仅仅几句话之后，页面就会指出“*如果正则表达式有分组，那么生成的列表也包含来自分组的匹配子字符串.. . 由于 $x 的第一个字符与正则表达式匹配，因此 split 在列表中添加了一个空的初始元素。* “所以，这是预期的行为。（althgouh，我仍然不清楚为什么未分组的点`/./`不做任何事情）

但是，我也在 Python 中工作，遇到了类似的问题（拆分结果中的空字符串）-在那里我找到了一个`filter(None, list)`函数，在这个调用中，它只是从列表中删除空字符串。在 Perl 中使用什么来实现相同的功能？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-11T15:20:39.820

的第一个参数[`split`](http://perldoc.perl.org/functions/split.html)定义了您正在解析的列表中的术语的区别。在最后两个片段中，您告诉`split`任何字符都是有效的分隔符，因此`split`返回输入字符之间的内容：五个空字符串。

```
>perl -E"say qq{<$_>} for split /./, 'test', -1;"
<>
<>
<>
<>
<> 
```

（默认情况下会过滤掉尾随的空字符串。）

解决方案不是开始过滤掉您要求`split`生产的东西。要么修复你的分隔符

```
my @chars = split /(?<=.)|(?=.)/s;
my @chars = split //; 
```

或使用更好的工具

```
my @chars = /(.)/s;
my @chars = unpack '(a)*', $_; 
```

# apache - 根据国家和用户代理限制访问

> ID：15952565
> 
> 赞同：2
> 
> 时间：2013-04-11T15:17:07.427
> 
> 标签：apache, .htaccess, mod-rewrite

我只想允许访问我的国家（使用 cloudflare）和用户代理（对于 SEO 机器人）。所以实际上我的国家和用户代理（对于 SEO）将有权访问 allow/index.html，而其他所有人都被重定向到 others.html

我在 .htaccess 中使用它：

```
RewriteCond %{HTTP:CF-IPCountry} ^(IT)$

RewriteCond $1 !^(allow)

RewriteRule ^(.*)$ /allow/index.html [L]

DirectoryIndex others.html

SetEnvIfNoCase User-Agent .*google.* search_robot
SetEnvIfNoCase User-Agent .*yahoo.* search_robot
SetEnvIfNoCase User-Agent .*bot.* search_robot
SetEnvIfNoCase User-Agent .*ask.* search_robot

Allow from env=search_robot 
```

我需要知道它是否正确，尤其是用户代理访问。

# android - 使屏幕可滚动？

> ID：15952567
> 
> 赞同：0
> 
> 时间：2013-04-11T15:17:08.273
> 
> 标签：android, scrollable

我试图让我的屏幕可滚动，我在这个网站上看了很长一段时间没有任何成功。我只需要知道我哪里出错了。我试过没有滚动视图，不同的网站告诉我做不同的事情。本质上，我希望较小设备的屏幕可滚动以适应所有内容。

```
<ScrollView  xmlns:android="http://schemas.android.com/apk/res/android" 
    xmlns:tools="http://schemas.android.com/tools"
    android:id="@+id/SonucScrollView"   
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"   
    android:isScrollContainer="true"
    android:scrollbars="vertical"
    android:layout_gravity="center"          
    android:orientation="vertical"
    android:background="@color/white"
     >          

<LinearLayout       
    android:id="@+id/linearLayout1"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:fillViewport="true"
    android:background="@color/white" 
    android:orientation="horizontal"
    android:weightSum="1.75"
    android:baselineAligned="false"
    tools:context=".TourismActivity" 
    >  

    <LinearLayout       
        android:id="@+id/linearLayout3"
        android:layout_width="0dp"
        android:layout_height="match_parent"
        android:layout_weight=".15"
        android:orientation="horizontal" > 

    <TextView
        android:id="@+id/button6"
        android:textIsSelectable="true"
        android:layout_width="0dp"
        android:layout_weight=".15"        
        android:layout_height="fill_parent"
        android:background="@color/grey"/>

    </LinearLayout> 

    <LinearLayout
        android:id="@+id/linearLayout10"
        android:layout_width="0dp"
        android:layout_height="match_parent"
        android:layout_weight=".6"
        android:orientation="vertical"
        android:weightSum="1.2" >

        <ImageView
            android:id="@+id/imageView1"
            android:layout_width="match_parent"        
            android:layout_height="0dp"
            android:layout_weight=".3"
            android:src="@drawable/abbeyleix" />

        <ImageView
            android:id="@+id/imageView2"
            android:layout_width="match_parent"
            android:layout_height="0dp"
            android:layout_weight=".3"
            android:src="@drawable/longford" />

        <ImageView
            android:id="@+id/imageView3"
            android:layout_width="match_parent"
            android:layout_height="0dp"
            android:layout_weight=".3"
            android:src="@drawable/tullamore" />

        <ImageView
            android:id="@+id/imageView4"
            android:layout_width="match_parent"
            android:layout_height="0dp"
            android:layout_gravity="left"
            android:layout_weight=".3"
            android:src="@drawable/athlone" />

        </LinearLayout>

        <LinearLayout
            android:id="@+id/linearLayout11"
            android:layout_width="0dp"
            android:layout_height="match_parent"
            android:layout_weight=".9"
            android:orientation="vertical"
            android:weightSum="3.7" >

            <Button
                android:id="@+id/buttonTourism"
                android:layout_width="fill_parent"
                android:layout_height="0dp"
                android:layout_weight=".5"
                android:layout_marginLeft="10dp"
                android:layout_marginTop="20dp"
                android:text="@string/laois"
                android:textColor="@color/blue" />
             <TextView
                android:id="@+id/editText1"
                android:layout_width="fill_parent"
                android:layout_height="0dp"
                android:layout_weight=".5"
                android:background="@color/white"
                android:paddingLeft="@dimen/activity_horizontal_margin"
                android:text="Located in the heart of Ireland, Laois showcases the raw beauty of nature long forgotten."
                android:textColor="@color/black"
                android:textSize="12sp" >
            </TextView>

            <Button
                android:id="@+id/buttonTourism1"
                android:layout_width="fill_parent"
                android:layout_height="0dp"
                android:textSize="13sp"
                android:layout_marginLeft = "10dp"
                android:layout_weight=".5"
                android:textColor="@color/blue"
                android:text="@string/longford" />
             <TextView
                android:id="@+id/editText2"
                android:layout_width="fill_parent"
                android:layout_height="0dp"
                android:layout_weight=".5"
                android:background="@color/white"
                android:gravity="fill_vertical"
                android:paddingLeft="@dimen/activity_horizontal_margin"
                android:text="Located in the heart of the lakelands, the endless beauty and rural charm of Longford makes for a great desination"
                android:textColor="@color/black"
                android:textSize="12sp" >

            </TextView>

            <Button
                android:id="@+id/buttonTourism2"
                android:layout_width="fill_parent"
                android:layout_height="0dp"
                android:layout_weight=".5"
                android:textSize="13sp"
                android:textColor="@color/blue"
                android:layout_marginLeft = "10dp"
                android:text="@string/offaly" />
            <TextView
                android:id="@+id/editText3"
                android:layout_width="fill_parent"
                android:layout_height="0dp"
                android:layout_weight=".5"
                android:background="@color/white"
                android:gravity="fill_vertical"
                android:paddingLeft="@dimen/activity_horizontal_margin"
                android:text="Nestled in the bosom of Slieve Bloom Mountains and the Shannon River, Offaly offers a vast plethora of beauty."
                android:textColor="@color/black"
                android:textColorHint="@color/red"
                android:textColorLink="@color/red"
                android:textSize="12sp" >

            </TextView>

            <Button
                android:id="@+id/buttonTourism3"
                android:layout_width="fill_parent"
                android:layout_height="0dp"
                android:textSize="13sp"
                android:layout_marginLeft = "10dp"
                android:layout_weight=".5"
                android:textColor="@color/blue"

                android:text="@string/westmeath" />

             <TextView
                android:id="@+id/editText4"
                android:layout_width="fill_parent"
                android:layout_height="0dp"
                android:layout_weight=".5"
                android:background="@color/white"
                android:gravity="fill_vertical"
                android:paddingLeft="@dimen/activity_horizontal_margin"
                android:text="Follow the tranquil Royal Canal as it meanders through Westmeath where the vast majesty of beauty knows no bounds."
                android:textColor="@color/black"
                android:textColorHint="@color/red"
                android:textColorLink="@color/red"
                android:textSize="12sp" >

            </TextView>

        </LinearLayout>

    <LinearLayout

        android:id="@+id/linearLayout4"
        android:layout_width="0dp"
        android:layout_height="match_parent"
        android:layout_weight="1"
        android:orientation="horizontal"
        android:weightSum="1" >

        <TextView
            android:id="@+id/button7"
            android:layout_width="0dp"
            android:textIsSelectable="true"
            android:layout_height="match_parent"
            android:layout_weight="0.15"
            android:background="@color/grey" />

    </LinearLayout>

</LinearLayout>
</ScrollView> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T15:23:01.700

从“垂直”元素中删除`layout_weight`and 。它导致布局缩放到屏幕的高度，因此没有什么可以滚动的。`weightSum``LinearLayout`

啊，可能还需要@Selvin 的评论，以使`linearLayout1`高度为“wrap_content”。

# ffmpeg - 使用 ffmpeg 将 FLV 转码为 MP4 非常慢

> ID：15952574
> 
> 赞同：4
> 
> 时间：2013-04-11T15:17:24.233
> 
> 标签：ffmpeg, mp4

我正在尝试支持在我们的网站上录制网络摄像头视频，然后我需要将其转码为 MP4 和 WebM 以支持 HTML5 播放。我在我们的服务器上安装了 ffmpeg 1.2，并且整个过程运行得相当好。

我确实遇到的一个问题是将 FLV 转码为 MP4。它的速度慢得令人无法接受，例如，8 秒的 FLV 需要大约 2.5 分钟来转码！

`ffmpeg`我正在使用的命令是：

```
ffmpeg -y -i webcam.flv -c:a libfaac -ac 2 -b:a 64k -ar 44100 -c:v libx264 \
  -b:v 350k 网络摄像头.mp4

```

有这么多`ffmpeg`参数，我对解决这个问题的最佳方法有点迷茫。你可以从这里下载一个测试flv：

[`dropbox.com/s/hhd6uhdiuhk800w/webcam.flv`](http://dropbox.com/s/hhd6uhdiuhk800w/webcam.flv)

相比之下，转码到 WebM 大约需要 5 秒：

```
ffmpeg -y -i webcam.flv -c:a libvorbis -ac 2 -b:a 64k -ar 44100 -c:v libvpx \
  -b:v 350k -metadata:s:v:0 旋转=0 webcam.webm

```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-12T07:47:40.940

好的，我找到了答案。我仔细查看了 ffmpeg 输出，并注意到：

```
[mp4 @ 0xa0060c0] Frame rate very high for a muxer not efficiently supporting it.
Please consider specifying a lower framerate, a different muxer or -vsync 2 
```

多哈。所以我在输出文件之前添加了“-vsync 2”作为最后一个参数，它很有魅力，将转码时间缩短到大约 10 秒！很高兴。

为所有类型的 a/v 输入制定“通用”ffmpeg 设置对我来说仍然像是黑魔法......

# php - 使用 hasMany 制作多个表格以进行复杂的查找

> ID：15952581
> 
> 赞同：0
> 
> 时间：2013-04-11T15:17:57.227
> 
> 标签：php, cakephp, cakephp-2.0, has-many

我在组装表格时遇到了麻烦，我将在其中搜索几家公司的授权书。

在哪里：

检察官将属于几家公司（X、Y、Z）
公司有几个分支机构（欧盟、巴西、美国等......）
分支机构将有多个单位。（能源、石油等..）

代理人还将拥有各种权力（签字、交易等）。

**目的是最终我能找到一个律师，例如能够签署巴西子公司 X 的能源部门的合同。**

有人可以帮助我处理和 hasMany 表和逻辑吗？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T15:44:18.213

只需像往常一样创建这些表，然后您将不得不创建关系表。

**`prosecutors_to_companies`**（他们可能属于几家公司，对吧？）

```
prosecutor_id | company_id
       1            2
       1            4
       2            6 
```

然后创建下一个关系表： **`companies_to_branches`**

```
company_id | branch_id
      1         4
      1         3 
```

然后在`JOINs`检索所需数据的帮助下。

这个例子可以帮助你 - [http://www.sitepoint.com/understanding-sql-joins-mysql-database/](http://www.sitepoint.com/understanding-sql-joins-mysql-database/)

# c# - C# 复制资源/制作安装程序

> ID：15952583
> 
> 赞同：0
> 
> 时间：2013-04-11T15:18:07.373
> 
> 标签：c#, file, io, foreach, resources

我想制作一个安装程序，将资源（来自 Resources.resx）复制到特定位置。
它可以工作，它复制文件，但没有文件扩展名。这是代码： ResourceSet ResSet = Mining.Properties.Resources.ResourceManager.GetResourceSet(CultureInfo.CurrentCulture, true, true);

```
foreach (DictionaryEntry file in ResSet)
{
    using (var stream = assembly.GetManifestResourceStream(file.Key.ToString()))
    {
    File.WriteAllBytes(@"C:\Programme\Special\" + file.Key.ToString() ,
                        ObjectToByteArray(file));
    File.WriteAllBytes(@"C:\Programme\Special\target\" + file.Key.ToString(),
                        ObjectToByteArray(file));
    File.WriteAllBytes(@"C:\Programme\Special\target\libs\" + file.Key.ToString(),
                        ObjectToByteArray(file));
    File.WriteAllBytes(@"C:\Programme\Special\target\libs\natives\" +
                        file.Key.ToString(), 
                    ObjectToByteArray(file));
    Console.WriteLine("Continuing...");

    }
} 
```

另外，我不知道如何将正确的文件放入正确的文件夹中，所以我将每个文件放入每个文件夹中...

# python - 如何在多索引数据框中选择第一级最后一个键中的行？

> ID：15952586
> 
> 赞同：4
> 
> 时间：2013-04-11T15:18:10.480
> 
> 标签：python, pandas

我有一个如下所示的 Pandas DataFrame：

```
 data
date       signal                     
2012-11-01 a           0.04
           b           0.03
2012-12-01 a          -0.01
           b           0.00
2013-01-01 a          -0.00
           b          -0.01 
```

我试图根据多索引的第一级仅获取最后一行，在这种情况下是日期。

```
2013-01-01 a          -0.00
           b          -0.01 
```

第一级索引是日期时间。选择最后一行的最优雅的方式是什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-11T16:11:58.960

一种方法是直接访问 MultiIndex 的级别（并使用最后一个）：

```
In [11]: df.index.levels
Out[11]: [Index([bar, baz, foo, qux], dtype=object), Index([one, two], dtype=object)]

In [12]: df.index.levels[0][-1]
Out[12]: 'qux' 
```

并选择这些行`ix`：

```
In [13]: df.ix[df.index.levels[0][-1]]
Out[13]:
            0         1         2         3
one  1.225973 -0.703952  0.265889  1.069345
two -1.521503  0.024696  0.109501 -1.584634

In [14]: df.ix[df.index.levels[0][-1]:]
Out[14]:
                0         1         2         3
qux one  1.225973 -0.703952  0.265889  1.069345
    two -1.521503  0.024696  0.109501 -1.584634 
```

*（使用[@Jeff 的示例 DataFrame](https://stackoverflow.com/a/15953049/1240268)。）*

也许更优雅的方式是使用[`tail`](http://pandas.pydata.org/pandas-docs/dev/generated/pandas.DataFrame.tail.html)（如果你知道总会有两个）：

```
In [15]: df.tail(2)
Out[15]:
                0         1         2         3
qux one  1.225973 -0.703952  0.265889  1.069345
    two -1.521503  0.024696  0.109501 -1.584634 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-11T15:37:30.777

在 0.11（本周即将推出）中，这是一种合理的方法

```
In [50]: arrays = [np.array(['bar', 'bar', 'baz', 'baz', 'foo', 'foo', 'qux', 'qux']),
   .....:           np.array(['one', 'two', 'one', 'two', 'one', 'two', 'one', 'two'])]

In [51]: df = pd.DataFrame(np.random.randn(8, 4), index=arrays)

In [52]: df
Out[52]: 
                0         1         2         3
bar one -1.798562  0.852583 -0.148094 -2.107990
    two -1.091486 -0.748130  0.519758  2.621751
baz one -1.257548  0.210936 -0.338363 -0.141486
    two -0.810674  0.323798 -0.030920 -0.510224
foo one -0.427309  0.933469 -1.259559 -0.771702
    two -2.060524  0.795388 -1.458060 -1.762406
qux one -0.574841  0.023691 -1.567137  0.462715
    two  0.936323  0.346049 -0.709112  0.045066

In [53]: df.loc['qux'].iloc[[-1]]
Out[53]: 
            0         1         2         3
two  0.936323  0.346049 -0.709112  0.045066 
```

这将适用于 0.10.1

```
In [63]: df.ix['qux'].ix[-1]
Out[63]: 
0    0.936323
1    0.346049
2   -0.709112
3    0.045066
Name: two, dtype: float64 
```

还有另一种方式（这适用于 0.10.1）以及

```
In [59]: df.xs(('qux','two'))
Out[59]: 
0    0.936323
1    0.346049
2   -0.709112
3    0.045066
Name: (qux, two), dtype: float64 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-11T15:39:29.373

如果您有一个`df`已经定义了 MultiIndex 的数据框，那么：

```
df2 = df.ix[df.index[len(df.index)-1][0]] 
```

也可以。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-07-24T18:59:54.223

你可以得到最后一行`iloc`：

```
 df.iloc[-1] 
```

# metadata - 使用基本事实元数据渲染文本

> ID：15952587
> 
> 赞同：0
> 
> 时间：2013-04-11T15:18:13.093
> 
> 标签：metadata, text-rendering

我正在研究光学字符识别。在我们的工作中，我们需要自动生成一些渲染的单词图像，并且我们需要渲染单词图像中的每个字符位置（边界）。这个关于渲染图像的元数据称为ground truth。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T08:38:43.317

我发现了一个名为 Pango 的渲染 c api，它有一个名为 pango_layout_Iter_get_char_extent() 的函数，可用于此目的。

[https://developer.gnome.org/pango/stable/pango-Layout-Objects.html#pango-layout-iter-get-char-extents](https://developer.gnome.org/pango/stable/pango-Layout-Objects.html#pango-layout-iter-get-char-extents)

# java - java代码和oracle db服务器上的查询结果不同：但没有连接错误

> ID：15952590
> 
> 赞同：3
> 
> 时间：2013-04-11T15:18:27.663
> 
> 标签：java, oracle

我有连接到远程 oracle 11g EE db 服务器的 java 代码。如果我在 sqlplus 中运行特定查询，它会返回一个结果

```
SQL> SELECT COURSENAME from COURSES where skillID=1;

COURSENAME
--------------------
basic 
```

但是，如果我从下面的 java 代码运行相同的查询，它不会返回任何结果。我可以从 java 调试器中的变量中复制查询语法`query`并在 oracle 上运行它，所以我知道查询没有语法问题。此外，它不是 SQL 异常或类未找到异常，因此它似乎正在成功运行查询——只返回零结果。

可能会发生什么？

```
 private String getCourseForSkill(int skillID){
    try{
        Class.forName("oracle.jdbc.OracleDriver"); 
        String query="SELECT COURSENAME from COURSES where skillID=" + skillID ; 
        con = DriverManager.getConnection(url, user, password);
        Statement stmt = con.createStatement();
        rs = stmt.executeQuery(query);
        rs.next();
        return rs.getString("COURSENAME");
    }
    catch (ClassNotFoundException ex){
        System.out.println(ex.getMessage());
    }
    catch (SQLException ex) {
         System.out.println(ex.getMessage());
    }
    return null;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-19T04:25:22.833

1.  我认为您正在连接到不同的 Oracle 实例，或者更有可能在这两种情况下作为不同的 Oracle 用户

    > *@GreyBeardedGeek URL 看起来像“jdbc:oracle:thin:@website:port:orcl 我通过执行 ssh@website、身份验证然后运行 ​​command=sqlplus 来手动查询*

    运行更安全**`sqlplus <username>/<password>@<orainstancename>`**，因为您可以显式指定 oracle 实例 ID。在您的情况下，您的程序似乎正在使用 jdbc 连接**`jdbc:oracle:thin:@website:port:orcl`**，因此您的 orainstancename 将是“ **orcl** ” - 只需确保您的**tnsnames.ora**文件具有实例“ **orcl** ”，并且与jdbc 连接使用的“**端口”相同**

2.  如何调试更多

    运行以下代码：

    ```
    con = DriverManager.getConnection(url, user, password);
    con.setAutoCommit(false);
    String insert="INSERT INTO COURSES (SKILLID, COURSE)"+ // can add other columns
                 "values (?, ?) );"                       // add ? for other columns    
    PreparedStatement ps = con.createPreparedStatement();
    ps.setInt(1, 999);
    ps.setString(2, "Complete Bullwarks");
    // can set other columns
    ps.executeUpdate(insert);
    con.commit(); 
    ```

    现在手动连接，重新运行原始选择语句并查看添加的行是否存在。如果 java 中没有错误并且 Oracle 中没有新行：您很可能正在使用 2 个不同的 Oracle 实例/模式。

    还重新运行您原来的 java 选择代码，但使用 SkillID=999 - 极有可能它会工作。

干杯

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-23T14:59:09.283

我必须提交才能添加行。当我输入`commit;`sql plus 终端时，远程 jdbc 连接可以“看到”这些行。我习惯使用 linq-to-sql 或 sql management studio 时不必显式执行此类提交的 SQL Server。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-23T21:42:19.780

可以是三个问题。

1）skillID <> 1 在您的 Java 代码中。添加调试和检查。

2a) 您正在连接到另一个数据库。

2b）您正在连接到同一个数据库，但从另一个模式中的表中进行选择。

要检查 2a 和 2b：

从双重中选择用户；-- 连接用户名

从 v$database 中选择名称； - 数据库名称

从 v$instance 中选择主机名；-- 主机名数据库正在运行

此查询将所有三个返回到一个结果中。

选择用户 || ' *' || d.name || '* ' || i.host_name 来自 v$database d, v$instance i;

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-24T08:21:20.043

假设您实际上连接到同一个数据库，这是由于未`INSERT`在 sql*plus 连接中提交。

默认情况下，通过 OCI（sql*plus 用于连接）连接时，Oracle**不会在自动提交模式下运行。**在 sql*plus 中执行的任何[DML](https://en.wikipedia.org/wiki/Data_Manipulation_Language) ( `INSERT ...`) 在提交之前对任何其他会话都是不可见的。这是因为 Oracle 默认提供了已[提交读](https://en.wikipedia.org/wiki/Isolation_%28database_systems%29#Read_committed)隔离级别。跨会话的其他用户唯一可见的是写锁。

如果您通过 JDBC 或 OCI 连接第二个连接并不重要，在您提交第一个连接之前它不会看到更改。

* * *

要对此进行测试，请尝试打开 2 个 sql*plus 连接并运行以下命令：

```
-- Executing DDL in Oracle causes an implicit commit before and after the
-- command so the second connection will see the existence of this table:
CREATE TABLE foobar ( x VARCHAR(1) ); 
```

在连接 #1 中执行这个 - 你应该得到零（我们还没有插入任何东西）：

```
SELECT COUNT(*) FROM foobar; 
```

在连接 #2 中执行此操作：

```
INSERT INTO foobar ( x ) VALUES ( 'A' ); 
```

在连接 #1 中执行此操作 - 您仍然应该得到零（`INSERT`未提交，因此连接 #1 看不到它）：

```
SELECT COUNT(*) FROM foobar; 
```

在连接 #2 中执行此操作：

```
COMMIT; 
```

在连接 #1 中执行此操作 - 你应该得到 1（它现在已提交）：

```
SELECT COUNT(*) FROM foobar; 
```

# wpf - WPF将绑定值从整数更改为图像

> ID：15952592
> 
> 赞同：2
> 
> 时间：2013-04-11T15:18:29.977
> 
> 标签：wpf, vb.net, xaml, bitmapimage, ivalueconverter

我正在尝试加载绑定到带来项目列表的数据库的 ListView。在 ListView 中，我显示了两个列，“Items”和“Status”。我能够带来值，但现在我想将状态中的值替换为图像。

例子：

```
1 = images/green.png
2 = images/red.png
3 = images/orange.png 
```

我想在列表中显示图像，以便用户导航时，他们会自动看到所有图像。我在另一个问题中发现了类似的东西，但它内置了我无法在 ListView 中执行的图像标签。 [WPF将整数转换为图像而无需数据库绑定](https://stackoverflow.com/questions/921184/wpf-convert-integer-to-image-without-db-binding)

感谢帮助。

编辑

```
Partial Class ImgConverter
    Implements IValueConverter

    Public Function Convert(value As Object, targetType As Type, parameter As Object, culture As Globalization.CultureInfo) As Object
        Dim imageIndex As Integer
        If Integer.TryParse(value.ToString(), imageIndex) Then
            Select Case imageIndex
                Case 1
                    Return BitmapSource = "Images/green.png"
                Case 2
                    Return BitmapSource = "Images/red.png"
            End Select
        End If
    End Function

    Public Function ConvertBack(value As Object, targetType As Type, parameter As Object, culture As System.Globalization.CultureInfo) As Object
        Throw New NotImplementedException()
    End Function

End Class 
```

使用此代码，我得到一个 IntelliSense 错误 BitmapSource 并实现 IvalueConverter，说我需要实现一个 ConvertBack，我做到了，但它仍然困扰着我。

编辑#3

好的 BITMAPSOURCE 错误是 BC 我没有声明变量。解决了。

IValueConverter 错误说：错误 2 类“ImgConverter”必须为接口“System.Windows.Data.IValueConverter”实现“函数 ConvertBack（值作为对象，targetType 作为类型，参数作为对象，文化作为 Globalization.CultureInfo）作为对象”。...\Config (ABM,20)\RangoPage.xaml.vb 14 有说服力

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-11T15:28:15.353

使用 IValueConverter，

它将一个整数作为参数，并返回一个 BitmapSource

```
<ListView ItemsSource="{Binding Collection}">
   <ListView.ItemTemplate>
      <DataTemplate>
         <StackPanel Orientation="Horizontal">
            <Textblock Text="{Binding Item}" />
            <Image Source="{Binding Status, Converter={StaticResource ValueConverter}}" />
         </StackPanel>
      </DataTemplate>
   </ListView.ItemTemplate>
</ListView>

public class IntToImageConverter : IValueConverter
{
          public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
        {
            int imageIndex;
            if(int.TryParse(value.ToString(), out imageIndex))
            {
               switch(imageIndex)
               {
                 case 1:
                  return new ImageSource("images/red.png")

                 etc...
               }
            }

            return null;
        }

        public object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture)
        {
            throw new NotImplementedException();
        }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-01-29T03:51:31.143

以防万一您需要在**UWP**应用程序中使用它，有工作方法。

**C＃**

```
 public sealed class IntStateToImageConverter : IValueConverter
    {
        public object Convert(object value, Type targetType, object parameter, string language)
        {
            try
            {
                var imagePath = "ms-appx:///Assets/Buttons/";
                DeviceNodeTechStateEnum state = value.ObjectToEnums<DeviceNodeTechStateEnum>();
                switch (state)
                {
                    case DeviceNodeTechStateEnum.OK:
                        imagePath += "correct.png";
                        break;
                    case DeviceNodeTechStateEnum.BAD:
                        imagePath += "incorrect.png";
                        break;
                    default:
                        imagePath += "unknown.png";
                        break;
                }

                Uri imageUri = new Uri(imagePath, UriKind.Absolute);
                BitmapImage imageBitmap = new BitmapImage(imageUri);
                return imageBitmap;
            }
            catch (Exception)
            {
            }

            return null;
        }

        public object ConvertBack(object value, Type targetType, object parameter, string language)
        {
            return !(value is bool && (bool)value);
        }
    } 
```

`ms-appx:///Assets/Buttons/`您保存图像的项目文件夹在哪里。

**用户控件的 XAML**

```
 <Image  Source="{Binding State, Converter={StaticResource intStateToImageConverter}}" Width="20" Height="20" ></Image> 
```

哪里是`State`类的一个字段有类型`DeviceNodeTechStateEnum`。

**APP的XAML**

```
<Application.Resources>
  <ResourceDictionary>
    <common:IntStateToImageConverter x:Key="intStateToImageConverter" /> 
```

**C# 枚举**

```
public enum DeviceNodeTechStateEnum
{
        Undefined = 1,
        OK = 2,
        BAD = 3,
} 
```

转换`object`为的方法`enums`。

```
public static class Extensions
{
        public static T ObjectToEnums<T>(this object o)
        {
            T enumVal = (T)Enum.Parse(typeof(T), o.ToString());
            return enumVal;
        }
} 
```

# sql - SQL如何只删除单元格开头的空格

> ID：15952596
> 
> 赞同：-2
> 
> 时间：2013-04-11T15:18:36.093
> 
> 标签：sql

我有一个包含 2000 行的列，其中一些在开头有空格 例如：TR 如何让所有单元格在开头清除空格？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T15:19:44.343

```
UPDATE YOUR_TABLE SET YOUR_COLUMN = LTRIM(YOUR_COLUMN); 
```

# excel - 在列 = 值的电子表格之间导入数据？

> ID：15952598
> 
> 赞同：-1
> 
> 时间：2013-04-11T15:18:38.370
> 
> 标签：excel, spreadsheet, google-sheets, google-docs, google-drive-api

注意：我的问题类似于 Googe Spreadsheets 的[ImportRange](http://support.google.com/drive/bin/answer.py?hl=en&answer=155183)函数。

是否可以在 Google 电子表格或 Microsoft Excel 中根据单元格值导入数据？

例如，我可以将 Sheet1 的内容复制到 B == "foo" 列的另一张表吗？

目标（表 1）：

![在此处输入图像描述](https://i.stack.imgur.com/IW9Kg.png)

目标表应该只复制第 2 行和第 4 行，因为它们是唯一包含“foo”的

编辑：

对于 Google Docs，我正在寻找这样的东西：

`=ImportRange("spreadsheetkey", QUERY('sheetname'!A6:E10, "SELECT A, B = 'foo'"))`但是我无法让它工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-07-09T22:37:32.823

您可以按照您所说的方式执行此操作，但不是在 ImportRange 中使用 Query，而是在 Query 中使用 ImportRange，因此：

=QUERY((ImportRange("spreadsheetkey", "sheetname!A6:E10")), "Select *columnnumbers like Col1,Col2 etc* where _Criteria for select, such as (B contains 'foo') order by *which column if you want to* ")

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T20:18:28.770

你可以这样做：

首先，在额外的列（例如 D 列）中标识要复制的行/单元格：

```
range("D" & range("A" & activesheet.rows.count).end(xlup).row).formula= "=IF(B:B=""foo"", NA(),"""") 
```

接下来，使用**SpecialCells**选择 A 列和 B 列中的单元格，其中 D 列显示 NA#

```
range("D1:D6").specialcells(xlcelltypeformulas, xlerrors).offset(0,-2).copy
othersheet.range("A1").pastespecial xlpasteall 
```

这应该让你开始使用一些代码来玩

当然，你也可以不使用 VBA，只需将公式粘贴进去，使用 F5，SpecialCells 对话框...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-12-15T05:12:11.843

您需要使用其中的 importrange 包装查询，如下所示：

```
=QUERY(importrange("spreadsheet key","sheetname!A6:E10"), "SELECT A where B='foo'") 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-05-31T05:36:32.547

您可以使用 FILTER 功能来做到这一点：

```
=FILTER(IMPORTRANGE("spreadsheet_url", "'sheet_name'!A6:E10"),
IMPORTRANGE("spreadsheet_url", "'sheet_name'!B6:B10")="foo") 
```

# objective-c - 建立一对多关系的最佳方式是什么？

> ID：15952599
> 
> 赞同：0
> 
> 时间：2013-04-11T15:18:39.230
> 
> 标签：objective-c, performance, algorithm

我有一组`Videos`对象，其中包括属性`id`和`tags`.

我想建立一个字典，它`key`是一个`tag`并且`value`是一个数组`id`。

例如，某些`Video`对象可能如下所示：

`Video{ id:1, tags:[funny,political,humor] }`

`Video{ id:2, tags:[political,america] }`

我希望结果字典看起来像这样：

`VideosWithTags["funny":[1]; "political":[1,2]; "humor":[1]; "america":[2]]`

有没有标准的算法来完成这个？

目前我正在做这样的事情：

```
for (NSDictionary *video in videos)
{
    NSNumber *videoId = [video objectForKey:@"id"];
    NSArray *tags = [video objectForKey:@"tags"];

    for (NSString *tag in tags)
    {
        NSMutableArray *videoIdsForTag = nil;

        if ([videosAndTags objectForKey:tag] != nil) //same tag with videoIds already exists
        {
            videoIdsForTag = [videosAndTags objectForKey:tag];
            [videoIdsForTag addObject:videoId];

            //add the updated array to the tag key
            [videosAndTags setValue:videoIdsForTag forKey:tag];
        }
        else //tag doesn't exist yet, create it and add the videoId to a new array
        {
            NSMutableArray *videoIds = [NSMutableArray array];
            [videoIds addObject:videoId];

            //add the new array to the tag key
            [videosAndTags setObject:videoIds forKey:tag];
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T15:40:09.407

您可以使用新的文字语法使这看起来更简洁。

我认为您可以通过`if`减少分支机构的工作而受益。`videoIds`例如，如果数组不存在，您最好尝试检索数组 - 创建它并将其添加到`videosAndTags`对象中，然后在此之后的代码可以与没有重复的逻辑一致

```
for (NSDictionary *video in videos) {
  NSNumber *videoId = video[@"id"];
  NSArray  *tags    = video[@"tags"];

  for (NSString *tag in tags) {
    NSMutableArray *videoIds = videosAndTags[tag];
    if (!videoIds) {
      videoIds = [NSMutableArray array];
      videosAndTags[tag] = videoIds;
    }

    // This is the only line where I manipulate the array
    [videoIds addObject:videoId]; 
  }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-11T18:41:54.203

```
NSArray* videos =
    @[@{ @"id" : @1, @"tags" : @[ @"funny", @"political", @"humor" ] },
      @{ @"id" : @2, @"tags" : @[ @"political", @"america" ] } ];
NSMutableDictionary* videosAndTags = [NSMutableDictionary new];

// find distinct union of tags
NSArray* tags = [videos valueForKeyPath: @"@distinctUnionOfArrays.tags"];

// for each unique tag
for( NSString* tag in tags )
{
    // filter array so we only have ones that have the right tag
    NSPredicate* p = [NSPredicate predicateWithFormat: @"tags contains %@", tag];
    videosAndTags[ tag ] = [[videos filteredArrayUsingPredicate: p] valueForKeyPath: @"id"];
} 
```

这是使用 NSPredicate 和 valueForKeyPath 的另一种方法。

我不经常使用它们，但有时它们可​​以证明是有用的。

（我认为他们称之为函数式编程风格，但我不太确定）

[NSPredicate 参考](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSPredicate_Class/Reference/NSPredicate.html)
[键值编码](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/KeyValueCoding/Articles/KeyValueCoding.html)

# java - 如何根据条件拆分正则表达式模式

> ID：15952600
> 
> 赞同：1
> 
> 时间：2013-04-11T15:18:40.543
> 
> 标签：java, regex, annotations

我想匹配文本中所有单位为 nm 或 µm 的值。下面是匹配 20 nm 或 20nm 的正则表达式模式

```
public Pattern Value = Pattern.compile("\\d*\\.?\\d*(\\s?[nNμµ][mM])"); 
```

如果它的单位为 nm 或 µm，我如何对其进行编程以仅匹配该值

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T15:24:29.540

您可以使用捕获组来捕获值：

```
public Pattern Value = Pattern.compile("(\\d*\\.?\\d*)(?:\\s?[nNμµ][mM])"); 
```

此处的值将包含在第一组中。

您还可以使用[环视](http://www.regular-expressions.info/lookaround.html)：

```
public Pattern Value = Pattern.compile("\\d*\\.?\\d*(?=\\s?[nNμµ][mM])"); 
```

在这里，您只会匹配该值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T15:24:40.753

使用[前瞻断言](http://www.regular-expressions.info/lookaround.html)：

```
public Pattern Value = Pattern.compile("(?i)\\d+\\.?\\d*(?=\\s*[nµ]m)"); 
```

此外，请至少指定一个数字。

# c++ - 重载运算符的返回值

> ID：15952603
> 
> 赞同：2
> 
> 时间：2013-04-11T15:18:46.060
> 
> 标签：c++, templates, pointers, reference, iterator

如果这是一个非常基本的问题，我很抱歉，我对 C++ 很陌生。我正在尝试为它定义自己的向量类和迭代器。但是，每当我重载运算符时，返回的值始终是地址。

例如，以下代码`0x7fb6dbc000e0 0x7fb6dbc000e0`在我想要打印时打印`1 0`

由于我一直在搞乱语法，一些运算符看起来有点不同，这只是为了让您可以看到我尝试过的一些东西。

测试.cc

```
#include <iostream>
#include "TwoWayVector.cc"
int main(){
    TwoWayVector<int> numbers;
    numbers.push_back(3);
    numbers.push_back(2);
        TwoWayVectorIterator<int>* beginning = numbers.begin();
    TwoWayVectorIterator<int>* beginning2 = numbers.begin();
    cout << beginning==beginning2;
    cout << beginning != beginning2;
    cout << endl;
return 0;
} 
```

双向矢量.cc

```
using namespace std;
#include "TwoWayVectorIterator.cc"
template <class T> class TwoWayVector{
public:

T* data;
int capacity;
int nextFree;

TwoWayVector(){
    capacity = 10;
    nextFree = 0;
    data = new T[capacity];
}

~TwoWayVector(){
    delete data;
}

T& operator[](const int index){
    if( index >= capacity || capacity + index < 0){
        string number = static_cast<ostringstream*>( &(ostringstream() << index) )->str();
        string error = "index " + number + " is out of bounds";
        throw error;
    }
    else if(index < 0){
        return data[nextFree+index];
    }
    return  data[index];
}
bool operator==(const TwoWayVector* vector2){
    if(capacity != vector2->capacity){
        return false;
    }
    if(nextFree != vector2->nextFree){
        return false;
    }
    for(int i=0; i<nextFree ; i++){
        if(data[i] != vector2[i]){
            return false;
        }
    }
    return true;
}
 //memory leaks?
void push_back(T object){
    if(capacity <= nextFree){
        capacity = capacity*2;
        T* tmp = new T[capacity];
        for(int i=0; i<capacity; i++){
            tmp[i] = data[i];
        }
        delete data;
        data = tmp;
    }
    data[nextFree] = object;
    nextFree++;
}

T pop_back(){
    nextFree--;
    T result = data[nextFree];
    data[nextFree] = NULL;
    return result;
}

int size(){
    return nextFree;
}

TwoWayVectorIterator<T>* begin(){
    TwoWayVectorIterator<T>* i = new TwoWayVectorIterator<T>(0,this);
    return (i);
}
TwoWayVectorIterator<T>* end(){
    TwoWayVectorIterator<T>* i = new TwoWayVectorIterator<T>(nextFree,this);
    return(i);
}

}; 
```

TwoWayVectorIterator.cc

```
template<typename T> class TwoWayVector;

template <class T> class TwoWayVectorIterator{
public:
TwoWayVector<T>* vector;
int currentPosition;
TwoWayVectorIterator(TwoWayVector<T>& vec){
    currentPosition = 0;
    vector = vec;
}
TwoWayVectorIterator( int pos , TwoWayVector<T>* vec){
    currentPosition = pos;
    vector = vec;
}

bool operator==(const TwoWayVectorIterator* vector2){
    bool contents, position;
    contents = (vector == vector2) ? true : false;
    cout << contents << endl;
    position =(currentPosition == vector2->currentPosition) ? true : false;
    return (contents && position);
}

bool& operator!=(const TwoWayVectorIterator* vector2){
    bool contents, position;
    contents = (vector == vector2) ? false : true;
    position=(currentPosition == vector2->currentPosition) ? false : true;
    return (contents || position);
}

TwoWayVectorIterator& operator++(){
    return *this;
    currentPosition = (currentPosition+1);

}
TwoWayVectorIterator& operator++(int){
    currentPosition = (currentPosition+1);
    return *this;
}
TwoWayVectorIterator& operator=(TwoWayVectorIterator* vector2){
    &vector = vector2;
    currentPosition = vector2->currentPosition;
    return *this;
}
TwoWayVectorIterator& operator+(int n){
    currentPosition = currentPosition+n;
    return *this;
}
TwoWayVectorIterator& operator-(int n){
    currentPosition = currentPosition-n;
    return *this;
}
bool& operator<(TwoWayVectorIterator* vector2){
    return (currentPosition<vector2->currentPosition);
}
T& operator*(){
    return vector[currentPosition];
}
}; 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-11T15:23:14.753

```
cout << beginning==beginning2; 
```

并不意味着**_**

```
cout << (beginning==beginning2); 
```

这**确实**意味着

```
(cout << beginning) == beginning2; 
```

[http://en.cppreference.com/w/cpp/language/operator_precedence](http://en.cppreference.com/w/cpp/language/operator_precedence)

因此，您正在打印 a `TwoWayVectorIterator<int>*`，而不是`bool`.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-11T15:23:53.233

<< 运算符的[优先级](http://msdn.microsoft.com/en-us/library/126fe14k%28v=vs.80%29.aspx)高于== 和 != 运算符的优先级。所以

```
cout << beginning==beginning2;
cout << beginning != beginning2; 
```

真正意思

```
(cout << beginning)==beginning2;
(cout << beginning) != beginning2; 
```

试试 cout << (beginning==beginning2); cout << (开始) != 开始2);

# c# - 如何在 NServiceBus 中配置构造函数注入

> ID：15952605
> 
> 赞同：1
> 
> 时间：2013-04-11T15:18:47.853
> 
> 标签：c#, dependency-injection, nservicebus

我有一个似乎相对常见的情况。我需要注入一个需要构造函数的依赖项。

我有一个如下所示的存储库：

```
public class ApprovalRepository : IApprovalRepository
{
    private readonly MongoCollection<Approval> _collection;

    public ApprovalRepository(MongoDatabase database)
    {
        this._collection = database.GetCollection<Approval>("Approvals");
    }

    // ...
} 
```

如下所示的端点配置：

```
public class EndpointConfig : IConfigureThisEndpoint, 
    AsA_Server, IWantCustomInitialization
{
    public void Init()
    {
        NServiceBus.Configure.With().DefaultBuilder().JsonSerializer();
    }
} 
```

还有一个看起来像这样的处理程序：

```
public class PlaceApprovalHandler : IHandleMessages<PlaceApproval>
{
    public IApprovalRepository ApprovalRepository { get; set; }

    public void Handle(PlaceApproval message)
    {
        //
        ApprovalRepository.Save(
            new Approval
                {
                    Id = message.Id, 
                    Message = message.MessageText, 
                    ProcessedOn = DateTime.UtcNow
                });
    }
} 
```

然后我有一个类来进行自定义初始化：

```
public class ConfigureDependencies : IWantCustomInitialization
{
    public void Init()
    {
        // configure Mongo
        var client = new MongoClient("mongodb://localhost:27017/?safe=true");
        var server = client.GetServer();
        var database = server.GetDatabase("ServiceBusTest");

        Configure.Instance.Configurer.RegisterSingleton<IApprovalRepository>(new ApprovalRepository(database));
    }
} 
```

结果是一个错误：

```
2013-04-11 17:01:03,945 [Worker.13] WARN  NServiceBus.Unicast.UnicastBus [(null)] <(null)> - PlaceApprovalHandler failed handling message.
Autofac.Core.DependencyResolutionException: Circular component dependency detected: Server.PlaceApprovalHandler -> Server.ApprovalRepository -> Server.ApprovalRepository.
   at Autofac.Core.Resolving.CircularDependencyDetector.CheckForCircularDependency(IComponentRegistration registration, Stack`1 activationStack, Int32 callDepth) in :line 0
   at Autofac.Core.Resolving.ResolveOperation.GetOrCreateInstance(ISharingLifetimeScope currentOperationScope, IComponentRegistration registration, IEnumerable`1 parameters) in :line 0 
```

我对Autofac不太熟悉。我还尝试了以下方法，结果也类似：

```
Configure.Instance.Configurer.ConfigureComponent(() => new ApprovalRepository(database), DependencyLifecycle.SingleInstance) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-15T11:13:05.007

在我看来，您尝试注入处理程序的具体类型对于端点本身来说应该是未知的。

[https://code.google.com/p/autofac/wiki/Scanning](https://code.google.com/p/autofac/wiki/Scanning)

我喜欢通过在类上放置自定义属性来通过“选择加入”来选择我的类型：

```
[AttributeUsage(AttributeTargets.Class)]
public class RegisterServiceAttribute : Attribute {} 
```

然后选择这样的类型：

```
builder.RegisterAssemblyTypes(assemblies)
    .Where(t => t.GetCustomAttributes(typeof (RegisterServiceAttribute), false).Any())
    .AsSelf()
    .AsImplementedInterfaces(); 
```

作为我所做的一个例子：

```
public class EndpointConfig : IConfigureThisEndpoint, IWantCustomInitialization, AsA_Server, UsingTransport<SqlServer>
{
    public void Init()
    {
        var builder = new ContainerBuilder();

        builder.RegisterAssemblyTypes(GetAllAssemblies())
            .Where(t => t.GetCustomAttributes(typeof(ProviderAttribute), false).Any())
            .AsSelf()
            .AsImplementedInterfaces();

        Configure
            .With()
            .UseTransport<SqlServer>()
            .AutofacBuilder(builder.Build())
            .UseNHibernateTimeoutPersister()
            .UseNHibernateSagaPersister()
            .UnicastBus();
    }

    private static Assembly[] GetAllAssemblies()
    {
        var path = Path.GetDirectoryName(Assembly.GetExecutingAssembly().Location);

        return Directory.GetFiles(path, "*.dll").Select(Assembly.LoadFile).ToArray();
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T08:52:21.227

在我的 ApprovalRepository 中，出现了一些奇怪的代码，即：

```
#region Public Properties

public IApprovalRepository Repository { get; set; }

#endregion 
```

NServiceBus 然后试图自动注入该属性。结果，ApprovalRepository 采用了 IApprovalRepository。哎呀。我的错。这现在解释了错误：

```
Server.PlaceApprovalHandler -> Server.ApprovalRepository -> Server.ApprovalRepository 
```

# python - python，参数数量麻烦

> ID：15952607
> 
> 赞同：-1
> 
> 时间：2013-04-11T15:18:51.807
> 
> 标签：python, types, arguments

我已经看到很多这个问题，但我仍然无法看到我做错了什么。

我有几个滑块，我想要我正在移动的滑块的值，以及正在移动哪个滑块。

要做到这一点：

```
def reading(self,value):
    sender=self.sender()
    slider=sender.objectName()[6:]
    value_slider=value

    return slider, value_slider 
```

这似乎可行，问题在于下一个功能。现在，我想通过移动滑块的值来做一些事情：

```
def prsn(self,slider,value_slider):
    wv=np.linspace(380,780,401)
    leds=np.genfromtxt('led_psd.txt')
    leds_norm=leds/leds.max()
    Pot_ajust=0
    for i in range(0,leds_norm.shape[1]):
        Pot_ajust=Pot_ajust+value_slider*leds_norm[:,slider]; 
```

而且我有错误：prsn() 正好需要 3 个参数（1 个给定）

为什么我不“给予” prsn() 3 个参数？就像它没有读取 value_slider 和 slider

我应该如何将 value_slider 和 slider 传递给其他函数？

非常感谢您的任何提示

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T15:35:48.057

以下是您应该如何调用 prsn：

```
s = stuff
vs = other_stuff
thingy.prsn(s,vs) 
```

或者

```
thingy.prsn(slider=s,value_slider=vs) 
```

这意味着在 prsn 的范围内：

```
self = thingy
slider = s
value_slider = vs 
```

现在，当您提出问题时，请包括导致异常的代码行。

# javascript - 如何在javascript中获取html表的行数据

> ID：15952617
> 
> 赞同：0
> 
> 时间：2013-04-11T15:19:10.183
> 
> 标签：javascript, jquery, html

我有一张这样的桌子

```
<tr class="odd">
    <td class="  sorting_1">opps</td>
    <td class="center "> <a href="#" onclick="tst(this)" class="btn btn-warning">
    <i class="icon-edit icon-white">      
    </i> Edit</a>

    </td>
</tr> 
```

单击该超链接时，我需要该行的 td 值。

我试过的这个 javascript

```
 $(document).ready(function () {
     $("#tblTest td:nth-child(2)").click(function (event) {
         //Prevent the hyperlink to perform default behavior
         event.preventDefault();
         var $td = $(this).closest('tr').children('td');
         var sr = $td.eq(0).text();
         alert(sr);
     });
 }); 
```

如果我放入 Table click 事件，这个可以工作。我需要点击它应该发生的超链接。如何做到这一点？提前致谢。

如果有任何方法可以得到它，而无需逐行迭代？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T15:20:51.923

您正在绑定`click`事件以`td`将其绑定到`a`

*改变*

```
$("#tblTest td:nth-child(2)").click(function (event) { 
```

*到*

```
$("#tblTest td:nth-child(2) a").click(function (event) { 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-11T15:23:25.313

试试这个：

```
$("a.btn").click(function (event) {
    //Prevent the hyperlink to perform default behavior
    event.preventDefault();
    var $td = $(this).parent().closest('tr').children('td');
    var sr = $td.eq(0).text();
    alert(sr);
}); 
```

[**在这里演示**](http://jsfiddle.net/Rat8e/)

# java - Java字符串加密

> ID：15952618
> 
> 赞同：6
> 
> 时间：2013-04-11T15:19:10.297
> 
> 标签：java, android, ios, encryption

我正在为我的 iPhone 应用程序使用 Objective C 中的加密类，但我正在努力从我的 android 应用程序中获得在 JAVA 中工作的相同功能。我的加密代码如下：

```
NSString * _secret = @"password";
NSString * _key = @"1428324560542678";

StringEncryption *crypto = [[StringEncryption alloc] init];
NSData *_secretData = [_secret dataUsingEncoding:NSUTF8StringEncoding];
CCOptions padding = kCCOptionPKCS7Padding;
NSData *encryptedData = [crypto encrypt:_secretData key:[_key dataUsingEncoding:NSUTF8StringEncoding] padding:&padding]; 
```

我试图在 JAVA 中复制它，但是当我对相同的数据进行编码时，我得到了一个不同的字符串。所以我做错了什么，但我无法弄清楚。这是我的 JAVA 代码：

```
byte[] key = "1428324560542678".getBytes();

Cipher c = null;
            try {
                c = Cipher.getInstance("AES/ECB/PKCS7Padding");
            } catch (NoSuchAlgorithmException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            } catch (NoSuchPaddingException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }

SecretKeySpec k =  new SecretKeySpec(key, "AES");
            try {
                c.init(Cipher.ENCRYPT_MODE, k);
            } catch (InvalidKeyException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }

    try {
        EditText tv1passwordText = (EditText) findViewById(R.id.password);
        String password = URLEncoder.encode(tv1passwordText.getText().toString(), "UTF-8");

            byte[] encryptedData = c.doFinal( password.getBytes()); 
```

谁能看到我哪里出错了？

根据下面的评论，我添加了 getBytes 但生成的字符串仍然不同：

```
byte[] key = null;
            try {
                key = "1428324560542678".getBytes("UTF-8");
            } catch (UnsupportedEncodingException e2) {
                // TODO Auto-generated catch block
                e2.printStackTrace();
            }

            Cipher c = null;
            try {
                c = Cipher.getInstance("AES/ECB/PKCS7Padding");
            } catch (NoSuchAlgorithmException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            } catch (NoSuchPaddingException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }

            SecretKeySpec k =  new SecretKeySpec(key, "AES");
            try {
                c.init(Cipher.ENCRYPT_MODE, k);
            } catch (InvalidKeyException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }

            try {
                EditText tv1passwordText = (EditText) findViewById(R.id.password);

                byte[] password = tv1passwordText.getText().toString().getBytes("UTF-8");

                byte[] encryptedData = c.doFinal(password); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-11T16:51:41.030

下面是一个加解密示例：

```
public static SecretKey generateKey() throws NoSuchAlgorithmException, InvalidKeySpecException {
    return secret = new SecretKeySpec(password.getBytes(), "AES");
}

public static byte[] encryptMsg(String message, SecretKey secret) throws NoSuchAlgorithmException, NoSuchPaddingException, InvalidKeyException, InvalidParameterSpecException, IllegalBlockSizeException, BadPaddingException, UnsupportedEncodingException {
/* Encrypt the message. */
    Cipher cipher = null;
    cipher = Cipher.getInstance("AES/ECB/PKCS5Padding");
    cipher.init(Cipher.ENCRYPT_MODE, secret);
    byte[] cipherText = cipher.doFinal(message.getBytes("UTF-8"));
    return cipherText;
}

public static String decryptMsg(byte[] cipherText, SecretKey secret) throws NoSuchPaddingException, NoSuchAlgorithmException, InvalidParameterSpecException, InvalidAlgorithmParameterException, InvalidKeyException, BadPaddingException, IllegalBlockSizeException, UnsupportedEncodingException {

    /* Decrypt the message, given derived encContentValues and initialization vector. */
    Cipher cipher = null;
    cipher = Cipher.getInstance("AES/ECB/PKCS5Padding");
   cipher.init(Cipher.DECRYPT_MODE, secret);
    String decryptString = new String(cipher.doFinal(cipherText), "UTF-8");
    return decryptString;
} 
```

加密：

```
 SecretKey secret = EncUtil.generateKey();
    EncUtil.encryptMsg(<String to Encrypt>, secret)) 
```

解密

```
 EncUtil.decryptMsg(<byte[]>, secret)) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T15:25:42.403

如果可能，您应该使用 CBC 或 CTR，而不是使用 ECB。 [欧洲央行是不安全的](http://bobnalice.wordpress.com/2009/01/28/friends-don%E2%80%99t-let-friends-use-ecb-mode-encryption/)。

看起来您的 Objective-C 代码正在使用 UTF-8 编码，但您没有在 Java 代码中指定它。使用`getBytes("UTF-8")`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-11T15:26:49.313

我注意到过去引起问题的一件事是被加密的 iOS 字符串实际上是`"Hello World\0"`，例如，要加密的字符串末尾有一个额外的 null 。因此，请尝试`\0`在 Java 中将 a 添加到字符串的末尾，看看它是否会产生相同的结果。

此外，`URLEncoder`java 上的步骤可能会引入额外的控制字符和其他在 iOS 端不存在的东西。将之后的文本与进入 iOS 加密步骤的文本进行比较可能是值得的，以确保它们完全相同

# json - 如何在 ASP.NET Webforms Like (webapi) 上生成 jsonResult

> ID：15952621
> 
> 赞同：0
> 
> 时间：2013-04-11T15:19:23.780
> 
> 标签：json, webforms, asp.net-web-api, jsonresult

我有一个 asp.net 网站（webforms），现在我需要在客户端添加一些行为，这将使用 ajax 进行简单操作。

在 asp.net mvc webapi 中，很容易以 json 格式返回特定的内容类，我只需要返回对象，webapi 就会为我完成工作。

我过去用处理程序做过类似的事情，但这需要做很多工作。

是否有一些建议可以让我的“jsonResults”与 asp.net webforms 一起使用？

# oracle - 带有查找表的 Oracle Apex 4.2 交互式报告

> ID：15952628
> 
> 赞同：1
> 
> 时间：2013-04-11T15:19:39.357
> 
> 标签：oracle, oracle-apex, oracleapplications

我在其中创建了一个名为 NAMES 的表，其中有一个名为 Status 的列。

在 STATUS 上，我创建了一个查找表，这创建了一个名为 Status_lookup 的新表，它有 2 列（STATUS_ID 和 Status）

所以 NAMES 表列更改为 STATUS_ID

当我做交互式报告时，数据确实来自 STATUS_ID 这是数字，我需要存储在状态中的文本。

有人可以解释一下我是如何做到的。我认为这很容易，但我不知道该怎么做。我不是 Oracle 应用程序的新手，所以一步一步会有所帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T08:52:09.740

示例：`select * from emp`
我想`DEPTNO`显示`DNAME`可以在`DEPT`
我通常做的是：
转到“共享组件 > 值列表”，然后从头开始创建一个新的，键入动态。

我将我的 LOV 称为“部门”，它有以下 SQL：

```
select dname d, deptno r
from   dept
order by 1 
```

然后要将其映射到 IR 中的列，请转到包含 IR 的页面并对其进行编辑。转到报告属性。从那里您可以看到 IR 中的列，并通过单击铅笔图标来编辑它们的属性。 ![报告属性](https://i.stack.imgur.com/1W5Ac.png) 在列属性中，您可以更改列的显示类型。将其设置为“显示为文本（基于 LOV，转义特殊字符）”。
然后转到“值列表”部分，并从“值的命名列表”选择列表中选择 LOV。（在我的示例中，这是“部门”）。
然后 Apex 会将 IR sql 中的值映射到 LOV 的显示值。 ![列属性](https://i.stack.imgur.com/50Cf9.png)

或者，您当然也可以只更改报表的 SQL 以映射显示值，例如：

```
SELECT empno, ename, depto, (select dname from dept where deptno  = e.deptno) dname
from emp 
```

# arrays - VBA修改数组内部

> ID：15952631
> 
> 赞同：-1
> 
> 时间：2013-04-11T15:19:48.003
> 
> 标签：arrays, vba

我确信这是一个非常简单的问题，但是将数组中的所有内容乘以 100 或取数组中所有内容的平方根而不复制它或 for 循环的最佳方法是什么？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T15:53:07.153

在 VBA 中没有办法做到这一点。

# java - 调试“打开的文件过多”问题

> ID：15952635
> 
> 赞同：16
> 
> 时间：2013-04-11T15:20:06.150
> 
> 标签：java, ioexception

我正在处理的应用程序突然崩溃了

```
java.io.IOException: ... Too many open files 
```

据我了解，这意味着文件已打开但未关闭。

Stacktrace 当然是在事后发生的，只能帮助了解发生什么事件错误之前。

什么是搜索代码库以查找此问题的智能方法，该问题似乎仅在应用程序处于高压力负载下时才会发生。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-04-11T15:30:27.047

1.  用于 `lsof -p pid`检查导致文件引用泄漏的原因；

2.  用于`ulimit -n`查看单个进程打开文件引用的限制；

3.  检查你项目中的任何IO资源，是否及时释放？ ，注意`File`，，，，（和Http连接）都是IO资源。`Process``Socket`

4.  有时，太多的线程也会导致这个问题。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2013-04-11T15:24:26.663

我认为使用专门为此目的设计的工具的最佳方法，例如[这个](http://file-leak-detector.kohsuke.org/)：

> 这个小型 Java 代理是一个工具，可以跟踪在 JVM 中打开文件的位置/时间/人员。您可以让代理跟踪这些操作以了解访问模式或处理泄漏，并转储当前打开的文件列表以及打开它们的位置/时间/谁。
> 
> 此外，在“打开的文件过多”异常时，此代理将转储列表，让您找出大量文件描述符正在使用的位置。

我似乎记得[YourKit](http://www.yourkit.com/overview/index.jsp)在这方面也有一些设施，但目前找不到任何具体信息。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-04-11T15:23:35.413

什么操作系统？如果是 linux/mac，那么[/proc 下的信息](http://man7.org/linux/man-pages/man5/proc.5.html)应该会有所帮助。在 Windows 上，使用[Process Explorer](http://technet.microsoft.com/en-us/sysinternals/bb896653.aspx)。

至于搜索代码库，也许寻找捕获或引发的代码`IOException`- 我认为已经捕获/引发这个的 I/O 方法很可能需要`close()`调用。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-04-11T15:48:31.680

您是否尝试过使用 jvisualvm（Java 5.0 及更高版本在 JDK bin 目录中）附加到正在运行的进程。您可以打开正在运行的进程并进行堆转储（如果您有较旧的 JDK，则需要使用 eclipse 或 intellij 或 netbeans 等进行分析）。

在 JDK 7 中，堆转储按钮位于“监视器”选项卡下。它将创建一个堆转储选项卡，“类”子选项卡，您可以检查并查看是否存在大量打开文件的任何类。另一个非常有用的功能是堆转储比较，因此您可以获取一个参考堆转储，让您的应用程序运行一下，然后再获取另一个堆转储并比较两者（比较链接在您获得的“[heapdump]”选项卡上当你拿一个时。java中还有一个标志用于在崩溃或OOM异常时进行堆转储，如果比较堆转储没有给你一个导致问题的明显类，你可以沿着这条路线走。另外，“实例”堆转储差异中的子选项卡将向您显示两个堆转储之间的时间分配的内容，这也可能有所帮助。

jvisualvm 是一个很棒的工具，但没有得到足够的提及。

# asp.net - 如何在 HTML5 代码块中保留换行符？

> ID：15952643
> 
> 赞同：0
> 
> 时间：2013-04-11T15:20:31.740
> 
> 标签：asp.net, html

我在 Default.aspx 页面中有这个：

```
 <code>
        $(document).ready(function () {
            $("#clickThis").click(function () {
                alert("Hallo die Welt!");
            });
        });
   </code> 
```

然而它显示为：

```
 $(document).ready(function () { $("#clickThis").click(function () { alert("Hallo die Welt!"); }); }); 
```

...当房地产是一个问题时，这很好，但为了便于阅读，我希望它能够完全显示标签中包含的代码。如何？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T15:23:20.233

像这样

```
<pre>
<code>
    $(document).ready(function () {
        $("#clickThis").click(function () {
            alert("Hallo die Welt!");
        });
    });
</code>
</pre> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-11T15:25:52.070

在 <code> 标签周围放置 <pre> 标签。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-11T16:12:50.527

如果您不介意`<code>`标签内所有关于空格的内容，请使用以下 CSS：

```
code {
    white-space: pre;
} 
```

[演示](http://jsfiddle.net/robertc/yDNA5/)。

# c# - 使用 naudio 将 Mp3 转换为 WAV，无需写入磁盘。（仅限流）

> ID：15952646
> 
> 赞同：2
> 
> 时间：2013-04-11T15:20:36.853
> 
> 标签：c#, mp3, wav, naudio

我想将 mp3 文件转换为 WAV。在 DirectX.DirectSound 中，辅助缓冲区仅支持 WAV。我正在使用 naudio 转换文件，这工作正常。

```
using (Mp3FileReader reader = new Mp3FileReader(mp3File))
{
    WaveFileWriter.CreateWaveFile(outputFile, reader);
} 
```

问题是我无法将文件保存在磁盘上，所以我必须将它们与流一起使用。

```
 Mp3FileReader mp3reader = new Mp3FileReader(filenamePathMp3);
 var stream=WaveFormatConversionStream.CreatePcmStream(mp3reader); 
```

抛出异常值不在预期范围内。如何在不写入磁盘的情况下将音频转换为 WAV 或 Raw 音频的音频流制作为 secondaryBuffer？

先感谢您，

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-11T15:29:00.443

`WaveFileWriter`可以写入 a`Stream`而不是文件，因此您只需传入 a `MemoryStream`。此外，`Mp3FileReader.Read`已经返回 PCM，因此您可以读取到 a`byte[]`中，然后根据需要将其插入到您的内存流中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2021-04-24T01:10:27.453

我已经实现了将 MP3 转换为 WAV 而无需通过使用将其写入磁盘`MemoryStream`，`WaveFileWriter.WriteWavFileToStream` 您还可以使用设置 sampleRate 比特率和通道`RawSourceWaveStream`

```
public static byte[] ConvertMp3ToWav(byte[] mp3File)
{
    using (var retMs = new MemoryStream())
    using (var ms = new MemoryStream(mp3File))
    using (Mp3FileReader reader = new Mp3FileReader(ms))
    {
        var rs = new RawSourceWaveStream(reader, new WaveFormat(16000, 1));
        using (WaveStream pcmStream = WaveFormatConversionStream.CreatePcmStream(rs))
        {
            WaveFileWriter.WriteWavFileToStream(retMs,pcmStream);
            return retMs.ToArray();
        }
    }
} 
```

# c# - Windows Phone 8 上的应用程序之间的 UniqueDeviceID 不同

> ID：15952647
> 
> 赞同：2
> 
> 时间：2013-04-11T15:20:38.710
> 
> 标签：c#, xaml, windows-phone-8, uniqueidentifier

我们有两个为 Windows Phone 8 开发的应用程序。我将 WMAppManifest 中的 Publisher ID 设置为相同的 GUID，但出于某种原因，每个应用程序都声明了它自己的 UDID。

为什么？我错过了什么？

我找到[了这个问题](https://stackoverflow.com/questions/15367492/windows-phone-8-find-out-imei-device-name-manufacturer)和[这个问题](https://stackoverflow.com/questions/13975315/get-unique-device-id-udid-under-windows-phone-8)，但他们似乎没有再说什么。

每个应用程序都通过 Web 服务进行通信并需要设备标识符，如果我们公司购买的 500 多台设备中的每台设备在中央数据库中都有两行，那将非常烦人。

任何线索任何人？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-11T15:27:01.167

显然，这是微软“[为了保护用户隐私](http://msdn.microsoft.com/en-us/library/windows/apps/jj553431.aspx)”的一个有意识的决定。因此，我认为通过另一个 API 是不可能的。

# php - 我无法使用 PHP 从 mysqli 查询中获取结果（从 mysql_result 转换）

> ID：15952648
> 
> 赞同：0
> 
> 时间：2013-04-11T15:20:39.730
> 
> 标签：php, mysql, mysqli, procedural

我有一个 PHP 函数，我正在从使用 mysql 扩展名转换为 mysqli 扩展名。

一切顺利，直到这里。我以前使用 mysql_result 来获取单条数据。mysqli中没有直接的等价物，所以我尝试了以下但仍然不起作用。

```
function getdbvalue($table,$value,$idfield,$id) {
  $qrytext = "SELECT $value FROM $table WHERE $idfield LIKE '$id'";
  $valueqry = mysqli_query($dbh,$qrytext);
  if (FALSE === $valueqry) die("Select failed: ".mysqli_error);
  $result = mysqli_fetch_row($valueqry);
  $returnvalue = $result[0];
  return $returnvalue;
} 
```

我已经验证变量可以正常传递给函数，并且函数实际上正在被触发。如果我返回 $id 我会看到 ID 号。

我没有收到查询错误。

解决了：

我需要在函数中将数据库连接变量添加为全局变量：

工作代码：

```
function getdbvalue($table,$value,$idfield,$id) {
  global $dbh; // This was missing!
  $qrytext = "SELECT $value FROM $table WHERE $idfield LIKE '$id'";
  $valueqry = mysqli_query($dbh,$qrytext);
  if (FALSE === $valueqry) die("Select failed: ".mysqli_error);
  $result = mysqli_fetch_row($valueqry);
  $returnvalue = $result[0];
  return $returnvalue;
} 
```

感谢大家的帮助。:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T15:30:21.180

尽管自动化简单的选择是个好主意，但这种实现是**非常不安全**的，永远不应该使用。

使其接受 SQL 查询和参数。它将使其安全。
而且你还必须使用[**PDO**](https://stackoverflow.com/tags/pdo/info)而不是 mysqli

```
function getdbvalue() {
  global $pdo;
  $args = func_get_args();
  $sql  = array_shift($args);
  $stm  = $pdo->prepare($sql);
  $stm->execute($args);
  return $stm->fetchColumn();
} 
```

必须像这样使用（你必须先连接到 PDO）：

```
$name = getdbvalue("SELECT name FROM users WHERE id=?", $is); 
```

这是唯一正确的方法

# jsf-2 - 多个 ui 的缓慢性：包括

> ID：15952650
> 
> 赞同：4
> 
> 时间：2013-04-11T15:20:40.233
> 
> 标签：jsf-2, primefaces, mojarra

我们有一个页面，其中主要内容区域由 控制`ui:includes`，基本上我们有`h:panelGroup`一个`rendered`条件和`ui:include`它的内部。

像这样：

```
<h:panelGroup rendered="#{bean.page.id eq bean.page1ID}">
        <ui:include src="page.xhtml"/>
</h:panelGroup> 
```

我们有大约 10 个。每个页面都非常复杂，有一些自己的 bean。我们使用渲染技巧而不是动态`ui:include`的原因是因为存在一个错误，其中在`@ViewScoped`外部使用的 bean 在`ui:include`内部重新实例化，`ui:include`从而导致各种问题。

每当我们执行某个动作时，都需要几秒钟（通常是 7 到 15 秒）才能执行该动作。例如，当我们更改`bean.page`属性并请求渲染时。即使我们做一些简单的事情，比如保存一个几乎不涉及其他任何东西的值，它也真的很慢。如果我删除除一个之外的所有内容`h:panelGroups`，`ui:includes`则该站点非常快（1 到 2 秒响应）。据我所知，`ui:includes`他们使用的所有页面和 bean 都被实例化了。

我们能做些什么来加快这个速度？我们在树脂 4.0.32 和 primefaces 3.5 上使用 mojarra 2.1.13。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-27T07:39:18.723

您有任何自定义上下文参数吗？错误的值会显着影响性能。

您可以尝试在以下内容中禁用 facelets 刷新`web.xml`：

```
<context-param>
  <param-name>facelets.REFRESH_PERIOD</param-name>
  <param-value>-1</param-value>
</context-param> 
```

将此值设置为 -1 将禁用对视图声明更改的内部检查。这意味着您无法在不重新部署的情况下重新加载您的 xhtml 页面，但这也意味着更高的性能。

或者，您也可以尝试将项目阶段设置为`Production`（这应该包括其他参数）。这禁用了许多额外的检查和开发的东西：

```
<context-param>
    <param-name>javax.faces.PROJECT_STAGE</param-name>
    <param-value>Production</param-value>
</context-param> 
```

这两个设置应**始终**在生产环境中使用。

# php - 将数据插入到购物车的数据库中

> ID：15952651
> 
> 赞同：0
> 
> 时间：2013-04-11T15:20:43.397
> 
> 标签：php, shopping-cart, sql-insert

我正在做一个购物车，但我不确定我在哪里或更确切地说是在哪个页面上编写我的 INSERT INTO 语句。

查看产品.php

```
 <?php
            if (isset($_SESSION['cartCity'])) {
                $sql = "SELECT * FROM productsc WHERE id_product IN (";
                foreach ($_SESSION['cartCity'] as $id => $value) {
                    $sql .= $id . ",";
                }
                $sql = substr($sql, 0, -1) . ") ORDER BY id_product ASC";
                $query = mysql_query($sql);
                if (!empty($query)) {
                    while ($row = mysql_fetch_assoc($query)) {
                        ?>
                        <p><?php echo $row['name']; ?><?php echo " x " . $_SESSION['cartCity'][$row['id_product']]['quantity']; ?></p>

                        <?php
                    }
                   } else {
                    echo "<i>You need to add an item to your cart for it to be visible here</i><br />";
                }
            } else {
                echo "<p>Your cart is empty. <br/> Please add some products</p>";
            }
            echo "<a href='viewProductsCity.php?page=cartCity'>Go to Cart</a>";
            echo "<a href='checkout.php'>Checkout</a>";
            ?> 
```

还是我应该添加到购物车或 viewAdd（这是客户点击添加到购物车按钮时运行的代码）页面？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T15:24:05.443

我会创建一个单独的页面来做到这一点。

然后，我将通过将用户重定向到那里或使用 AJAX 调用它来包含它。当用户拿到购物车时，是的，我们会将他重定向到结账处，并询问他是否想现在购买或继续购物。

# html - 移动网站的后退按钮

> ID：15952655
> 
> 赞同：0
> 
> 时间：2013-04-11T15:20:50.603
> 
> 标签：html, mobile, web

我的移动网站只有 HTML 和 css。我想要一个后退按钮，用户可以在其中返回上一页。

history.go(-1) 这种方法在我的手机上不起作用。如何编码这个后退按钮。请帮我

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T15:24:10.600

首先，您应该在手机的浏览器上启用 javascript，然后这应该可以正常工作：

```
<a href="history.go(-1)">Back to Results</a> 
```

重要的是，它不在“onclick”中，而是在“href”中

# window - 在查找器窗口中显示某些内容

> ID：15952658
> 
> 赞同：0
> 
> 时间：2013-04-11T15:20:55.927
> 
> 标签：window, applescript, show, finder

好的，我正在尝试制作一个脚本，您可以在其中输入内容，然后会出现一个新的查找器窗口，其中包含您输入的内容。类似于聚光灯搜索，但在脚本中。

```
set theFind to text returned of (display dialog "What do you want to find?" default answer "" buttons {"Cancel", "Ok"} default button 2)
    tell application "Finder"
        reveal theFind
    end tell 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-11T19:04:06.140

有一个 AppKit 方法可以完全满足您的要求（我认为）：`-[NSWorkspace showSearchResultsForQueryString:]`这意味着您可以使用 AppleScriptObjC 来使用它。因此，在 AppleScript 编辑器中，文件 > 从模板新建 > Cocoa-AppleScript Applet，然后：

```
property NSWorkspace : class "NSWorkspace"
NSWorkspace's sharedWorkspace()'s showSearchResultsForQueryString_(theFind) 
```

或者，您可以跳过 AppleScriptObjC 并使用该方法使用的隐藏 Finder 命令：

```
tell application "Finder" to «event aevtspot» theFind 
```

# qt - Qt 委托未调用 createEditor()

> ID：15952660
> 
> 赞同：1
> 
> 时间：2013-04-11T15:20:58.430
> 
> 标签：qt, delegates, qcombobox, model-view, qcheckbox

当打开 ComboBox 时，我的 ComboBox 填充了 CheckBox，第一个项目的委托 createEditor 未被调用，但是当您移至第二个项目时，它被调用并正确创建了委托。在此之后，当您移回第一项时，代表正在工作。问题仅在于第一次选择第一个项目。如果您在组合框中只有一个项目，则该项目是不可选择的。

这是我的代表的代码：

```
#include "checkboxlistdelegate.h"

CheckBoxListDelegate::CheckBoxListDelegate(QObject *parent)
  : QItemDelegate(parent) {
}

void CheckBoxListDelegate::paint(QPainter *painter,
                                 const QStyleOptionViewItem &option,
                                 const QModelIndex &index) const {
  //Get item data
  bool value = index.data(Qt::UserRole).toBool();
  QString text = index.data(Qt::DisplayRole).toString();
  // fill style options with item data
  const QStyle *style = QApplication::style();
  QStyleOptionButton opt;
  opt.state |= value ? QStyle::State_On : QStyle::State_Off;
  opt.state |= QStyle::State_Enabled;
  opt.text = text;
  opt.rect = option.rect;
  opt.palette = QPalette(Qt::white);
  // draw item data as CheckBox
  style->drawControl(QStyle::CE_CheckBox,&opt,painter);
}

QWidget* CheckBoxListDelegate::createEditor(QWidget *parent,
                                        const QStyleOptionViewItem& option,
                                        const QModelIndex & index ) const {
  QCheckBox *editor = new QCheckBox(parent);
  editor->setStyleSheet("QCheckBox {background-color: #aaaaaa; color: white;}");
  return editor;
}

void CheckBoxListDelegate::setEditorData(QWidget *editor,
                                         const QModelIndex &index) const {
  QCheckBox *myEditor = static_cast<QCheckBox*>(editor);
  myEditor->setText(index.data(Qt::DisplayRole).toString());
  myEditor->setChecked(index.data(Qt::UserRole).toBool());
}

void CheckBoxListDelegate::setModelData(QWidget *editor,
                                        QAbstractItemModel *model,
                                        const QModelIndex &index) const {
  //get the value from the editor (CheckBox)
  QCheckBox *myEditor = static_cast<QCheckBox*>(editor);
  bool value = myEditor->isChecked();
  //set model data
  QMap<int,QVariant> data;
  data.insert(Qt::DisplayRole,myEditor->text());
  data.insert(Qt::UserRole,value);
  model->setItemData(index,data);
  emit indexChanged(index);
}

void CheckBoxListDelegate::updateEditorGeometry(QWidget *editor,
                                            const QStyleOptionViewItem &option,
                                            const QModelIndex &index ) const {
  Q_UNUSED(index);
  editor->setGeometry(option.rect);
} 
```

这是我的 QComboBox 子类的代码：

```
CheckBoxList::CheckBoxList(QWidget *widget)
  : QComboBox(widget),title(""),selection() {
  // set delegate items view
  view()->setItemDelegate(new CheckBoxListDelegate(this));
  view()->setStyleSheet("QAbstractItemView {background-color:white;}");
  // Enable editing on items view
  view()->setEditTriggers(QAbstractItemView::AllEditTriggers);
  connect(view()->model(), SIGNAL(dataChanged(QModelIndex,QModelIndex)),
          this, SLOT(onItemClicked(QModelIndex)));
}

void CheckBoxList::paintEvent(QPaintEvent *) {
  QStylePainter painter(this);
  painter.setPen(palette().color(QPalette::Text));
  QStyleOptionComboBox opt;
  initStyleOption(&opt);
  opt.currentText = title;
  painter.drawComplexControl(QStyle::CC_ComboBox, opt);
  painter.drawControl(QStyle::CE_ComboBoxLabel, opt);
}

void CheckBoxList::setDisplayText(QString text) {
  title = text;
}

QString CheckBoxList::getDisplayText() const {
  return title;
}

bool CheckBoxList::isChecked(const QModelIndex& index) const {
  return view()->model()->itemData(index).value(Qt::UserRole).toBool();
} 
```

谢谢你。

# port - 查找在 Windows 上使用端口的进程的 PID

> ID：15952663
> 
> 赞同：129
> 
> 时间：2013-04-11T15:21:17.447
> 
> 标签：port

我的服务在经典启动时崩溃：

```
java.rmi.server.ExportException: Listen failed on port: 9999 
```

我怎样才能找到杀死它的过程？

* * *

## 回答 #1

> 赞同：247
> 
> 时间：2013-04-11T15:24:06.663

只需打开一个命令外壳并输入（假设您的端口是 123456）：

```
netstat -a -n -o | find "123456" 
```

你会看到你需要的一切。

标题是：

```
 Proto  Local Address          Foreign Address        State           PID
 TCP    0.0.0.0:37             0.0.0.0:0              LISTENING       1111 
```

* * *

## 回答 #2

> 赞同：100
> 
> 时间：2016-05-13T16:40:14.537

**查找在 Windows 上使用端口的进程的 PID** *（例如端口：“9999”）*

```
netstat -aon | find "9999" 
```

`-a`显示所有连接和侦听端口。

`-o`显示与每个连接关联的拥有进程 ID。

`-n`以数字形式显示地址和端口号。

*输出：*

```
TCP    0.0.0.0:9999       0.0.0.0:0       LISTENING       15776 
```

**然后通过PID杀死进程**

```
taskkill /F /PID 15776 
```

`/F`- 指定强制终止进程。

*注意：您可能需要额外的权限（由管理员运行）才能杀死某些进程*

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2018-05-25T07:10:42.003

**命令：**

```
netstat -aon | findstr 4723 
```

**输出：**

```
TCP    0.0.0.0:4723           0.0.0.0:0                LISTENING       10396 
```

`for`现在使用Windows中的命令剪切进程 ID“10396” 。

**命令：**

```
for /f "tokens=5" %a in ('netstat -aon ^| findstr 4723') do @echo %~nxa 
```

**输出：**

10396

如果你想削减第 4 个数值的意思是“LISTENING”，那么在 Windows 中使用命令。

**命令：**

```
for /f "tokens=4" %a in ('netstat -aon ^| findstr 4723') do @echo %~nxa 
```

**输出：**

聆听

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2017-11-09T13:19:37.273

如果您想以编程方式执行此操作，您可以使用 PowerShell 脚本中提供的一些选项，如下所示：

```
$processPID =  $($(netstat -aon | findstr "9999")[0] -split '\s+')[-1]
taskkill /f /pid $processPID 
```

然而; 请注意，您越准确，您的 PID 结果就越精确。如果您知道端口应该在哪个主机上，则可以缩小很多范围。`netstat -aon | findstr "0.0.0.0:9999"`只会返回一份申请，而且很可能是正确的一份。仅搜索端口号可能会导致您返回恰好包含`9999`在其中的进程，如下所示：

```
TCP    0.0.0.0:9999                        0.0.0.0:0       LISTENING       15776
UDP    [fe80::81ad:9999:d955:c4ca%2]:1900  *:*                             12331 
```

最有可能的候选人通常首先结束，但如果进程在您运行脚本之前结束，您可能会以 PID 12331 结束并杀死错误的进程。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2016-06-24T07:52:08.857

在摆弄了一些脚本之后，我开始了这个动作。将其复制并保存在 .bat 文件中：

```
FOR /F "usebackq tokens=5" %%i IN (`netstat -aon ^| find "3306"`) DO taskkill /F /PID %%i 
```

在需要空闲的端口号中更改“查找“3306”。然后以管理员身份运行该文件。它将杀死在该端口上运行的所有进程。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2019-10-26T17:58:41.970

PowerShell（与核心兼容）单行来简化复制粘贴场景：

```
netstat -aon | Select-String 8080 | ForEach-Object { $_ -replace '\s+', ',' } | ConvertFrom-Csv -Header @('Empty', 'Protocol', 'AddressLocal', 'AddressForeign', 'State', 'PID') | ForEach-Object { $portProcess = Get-Process | Where-Object Id -eq $_.PID; $_ | Add-Member -NotePropertyName 'ProcessName' -NotePropertyValue $portProcess.ProcessName; Write-Output $_ } | Sort-Object ProcessName, State, Protocol, AddressLocal, AddressForeign | Select-Object  ProcessName, State, Protocol, AddressLocal, AddressForeign | Format-Table 
```

输出：

```
ProcessName State     Protocol AddressLocal AddressForeign
----------- -----     -------- ------------ --------------
System      LISTENING TCP      [::]:8080    [::]:0
System      LISTENING TCP      0.0.0.0:8080 0.0.0.0:0 
```

相同的代码，对开发人员友好：

```
$Port = 8080

# Get PID's listening to $Port, as PSObject
$PidsAtPortString = netstat -aon `
  | Select-String $Port
$PidsAtPort = $PidsAtPortString `
  | ForEach-Object { `
      $_ -replace '\s+', ',' `
  } `
  | ConvertFrom-Csv -Header @('Empty', 'Protocol', 'AddressLocal', 'AddressForeign', 'State', 'PID')

# Enrich port's list with ProcessName data
$ProcessesAtPort = $PidsAtPort `
  | ForEach-Object { `
    $portProcess = Get-Process `
      | Where-Object Id -eq $_.PID; `
    $_ | Add-Member -NotePropertyName 'ProcessName' -NotePropertyValue $portProcess.ProcessName; `
    Write-Output $_;
  }

# Show output
$ProcessesAtPort `
  | Sort-Object    ProcessName, State, Protocol, AddressLocal, AddressForeign `
  | Select-Object  ProcessName, State, Protocol, AddressLocal, AddressForeign `
  | Format-Table 
```

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2018-04-10T03:54:15.587

这有助于使用端口号查找 PID。

```
lsof -i tcp:port_number 
```

# android - Android - DialogFragment（AlertDialog）内的ListFragment：Fragment没有视图

> ID：15952665
> 
> 赞同：6
> 
> 时间：2013-04-11T15:21:33.617
> 
> 标签：android, android-fragments, android-dialog, android-listfragment, android-dialogfragment

我正在尝试使用嵌套在其中的 ListFragment 创建一个 DialogFragment。我正在使用在 4.2.2 中添加的嵌套片段，我将它与支持库一起使用，所以我的 api 版本应该无关紧要（为了记录，我的 os 版本也是 4.2.2）。

我正在尝试添加的列表片段现在只显示字符串，因为我正在尝试添加它，在我这样做之后，列表将包含图像等。所以请将字符串列表传递给对话框的任何想法对我不好，我的列表会更复杂.. 另外，我正在尝试将此片段重用于平板电脑模式。该列表应始终以该模式显示。所以复用很重要。

我的问题是当我尝试将 listfragment 添加到对话框的 FrameLayout 时，找不到它：

> java.lang.IllegalStateException：片段在 android.support.v4.app.FragmentManagerImpl.moveToState(FragmentManager.java:901 的 android.support.v4.app.Fragment$1.findViewById(Fragment.java:1425) 没有视图) 在 android.support.v4.app.FragmentManagerImpl 的 android.support.v4.app.BackStackRecord.run(BackStackRecord.java:682) 的 android.support.v4.app.FragmentManagerImpl.moveToState(FragmentManager.java:1088)。 execPendingActions(FragmentManager.java:1444) 在 android.support.v4.app.Fragment.performStart(Fragment.java:1481) 在 android.support.v4.app.FragmentManagerImpl.moveToState(FragmentManager.java:941) 在 android.support .v4.app.FragmentManagerImpl.moveToState(FragmentManager.java:1088) 在 android.support.v4.app.BackStackRecord.run(BackStackRecord.java:682) 在 android.support.v4。app.FragmentManagerImpl.execPendingActions(FragmentManager.java:1444) 在 android.support.v4.app.FragmentManagerImpl$1.run(FragmentManager.java:429) 在 android.os.Handler.handleCallback(Handler.java:725) 在 android。 os.Handler.dispatchMessage(Handler.java:92) 在 android.os.Looper.loop(Looper.java:137) 在 android.app.ActivityThread.main(ActivityThread.java:5041) 在 java.lang.reflect.Method .invokeNative(Native Method) at java.lang.reflect.Method.invoke(Method.java:511) at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:793) at com.android.internal .os.ZygoteInit.main(ZygoteInit.java:560) 在 dalvik.system.NativeStart.main(Native 方法)在 android.os.Handler.dispatchMessage(Handler.java:92) 在 android.os.Handler.handleCallback(Handler.java:725) 在 android.os.Looper.loop(Looper.java) 运行(FragmentManager.java:429) :137) 在 android.app.ActivityThread.main(ActivityThread.java:5041) 在 java.lang.reflect.Method.invokeNative(Native Method) 在 java.lang.reflect.Method.invoke(Method.java:511) 在com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:793) 在 com.android.internal.os.ZygoteInit.main(ZygoteInit.java:560) 在 dalvik.system.NativeStart.main(Native Method )在 android.os.Handler.dispatchMessage(Handler.java:92) 在 android.os.Handler.handleCallback(Handler.java:725) 在 android.os.Looper.loop(Looper.java) 运行(FragmentManager.java:429) :137) 在 android.app.ActivityThread.main(ActivityThread.java:5041) 在 java.lang.reflect.Method.invokeNative(Native Method) 在 java.lang.reflect.Method.invoke(Method.java:511) 在com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:793) 在 com.android.internal.os.ZygoteInit.main(ZygoteInit.java:560) 在 dalvik.system.NativeStart.main(Native Method )reflect.Method.invokeNative(Native Method) at java.lang.reflect.Method.invoke(Method.java:511) at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:793) at com. dalvik.system.NativeStart.main（本机方法）上的 android.internal.os.ZygoteInit.main(ZygoteInit.java:560)reflect.Method.invokeNative(Native Method) at java.lang.reflect.Method.invoke(Method.java:511) at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:793) at com. dalvik.system.NativeStart.main（本机方法）上的 android.internal.os.ZygoteInit.main(ZygoteInit.java:560)

## **添加：**

也许这个新信息很重要，DialogFragment 显示在 SupportMapFragment 中。当我尝试在 SupportMapFragment 中显示 ListFragment 时，它可以工作。此外，当我尝试仅在 SupportMapFragment 中显示 DialogFragment 时 - 它可以工作。

就在我尝试在 DialogFragment 中显示 ListFragment 时，它失败了。所以它看起来像这样：FragmentActivity -> SupportMapFragment -> DialogFragment -> ListFragment。

SupportMapFragment 中的 DialogFragment 显示如下：

```
// DialogFragment.show() will take care of adding the fragment
// in a transaction.  We also want to remove any currently showing
// dialog, so make our own transaction and take care of that here.
FragmentTransaction ft = getChildFragmentManager().beginTransaction();
SherlockDialogFragment prev =(SherlockDialogFragment)getChildFragmentManager().findFragmentByTag("dialog");
if (prev != null) {
    ft.remove(prev);
}
ft.addToBackStack(null);

// Create and show the dialog.
SherlockDialogFragment newFragment = new CategoriesDialogFragment();
newFragment.show(ft, "dialog"); 
```

请帮忙 ：-）

* * *

**我的 DialogFragment 类是这样的：**

```
public class CategoriesDialogFragment extends SherlockDialogFragment {

// {{ Events

@Override
public Dialog onCreateDialog(Bundle savedInstanceState) {
    LayoutInflater inflater = getSherlockActivity().getLayoutInflater();
    View dialogView = inflater.inflate(R.layout.fragment_categories_dialog_fragment, null, false);

    Dialog diag = new AlertDialog.Builder(getSherlockActivity())
            .setTitle("Hello")
            .setCancelable(false)
            .setView(dialogView)
            .setPositiveButton("ok",
                new DialogInterface.OnClickListener() {
                    public void onClick(DialogInterface dialog, int whichButton) {                          

                    }
                }
            )
            .setNegativeButton("Cancel",
                new DialogInterface.OnClickListener() {
                    public void onClick(DialogInterface dialog, int whichButton) {

                    }
                }
            )
            .create();

    FragmentTransaction transaction = getChildFragmentManager().beginTransaction();
    SherlockDialogFragment prev = (SherlockDialogFragment)getChildFragmentManager().findFragmentByTag("fragment_list_categories");
    if (prev != null) {
        transaction.remove(prev);
    }

    SherlockListFragment listCategoriesFragment = new CategoriesListFragment();
    transaction.add(R.id.fragment_list_categories, listCategoriesFragment, "fragment_list_categories").commit();

    return diag;
}
} 
```

**我的对话框布局是这样的：**

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:orientation="vertical">
<TextView 
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:text="sjrdflksjlksjfkldsjflkjsdflksd"/>
<FrameLayout
    android:id="@+id/fragment_list_categories"
    android:layout_width="wrap_content"
    android:layout_height="match_parent" />
</LinearLayout> 
```

**我的 ListFragment 类是这样的：**

```
public class CategoriesListFragment extends SherlockListFragment {
public static final String[] TITLES = 
    {
            "Henry IV (1)",   
            "Henry V",
            "Henry VIII",       
            "Richard II",
            "Richard III",
            "Merchant of Venice",  
            "Othello",
            "King Lear"
    };

// {{ Events

@Override
public void onActivityCreated(Bundle savedInstanceState) {
    Log.w("ListFragment", "insideeeeeeeeeeeeeeeeeeeee");
    super.onActivityCreated(savedInstanceState);
    setListAdapter(new ArrayAdapter<String>(getSherlockActivity(),
            android.R.layout.simple_list_item_1, TITLES));

    // setHasOptionsMenu(true);
}

@Override
public void onListItemClick(ListView l, View v, int position, long id) {
    // TODO: Kazaz - implement category pressed
    super.onListItemClick(l, v, position, id);
}

// }}
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-09T19:06:33.637

不确定这是否对您有用，但也许尝试将该代码嵌套在 onCreateView 中。我有一个类似的问题，它对我有用。

基本上删除你在 onCreateDialog 中的内容，可能是这样的：

```
@Override
public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {
    View view = inflater.inflate(R.layout.fragment_categories_dialog_fragment, container, false);

    // And so on...
    getDialog().setTitle("");

    FragmentTransaction transaction = getChildFragmentManager().beginTransaction();
    SherlockListFragment listCategoriesFragment = new CategoriesListFragment();
    transaction.add(R.id.fragment_list_categories, listCategoriesFragment, "fragment_list_categories").commit();

    return view;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T17:14:49.813

尝试使用类似的东西： -

getSupport(Child)FragmentManager().beginTransaction().detach(mFragment1).replace(R.id.main, mFragment2).attach(mFragment2).addToBackStack(null).commit();

如以下链接所述

[谷歌错误](https://code.google.com/p/android/issues/detail?id=42601)

# c# - C#字符串比较不起作用

> ID：15952666
> 
> 赞同：1
> 
> 时间：2013-04-11T15:21:34.907
> 
> 标签：c#, asp.net, visual-studio, encoding, string-comparison

我在对 Request.queryString 接收的字符串和文件 .resx 中的一行进行字符串比较时遇到一些问题。

代码接收`Request.queryString`到一个名为 的变量`q`，然后它转到一个函数来比较一行中是否有`q`值：

```
 while ((line = filehtml.ReadLine()) != null)
        {
            if (line.ToLower().Contains(q.ToLower().ToString()))
                HttpContext.Current.Response.Write("<b>Content found!</b>");
            else
                HttpContext.Current.Response.Write("<b>Content not found!</b>");
        } 
```

由于它是在静态文件中的搜索，因此必须考虑特殊字符并搜索：`Iberê`例如，不返回 true，因为`.Contains`,`.IndexOf`或`.LastindexOf`正在比较: `iber&ecirc;`，即来自`q`，与`iber&#234;`来自该行。

考虑到我已经尝试使用 ResXResourceReader（Visual Studio 找不到）、ResourceReader 和 ResourceManager（这些我无法通过要读取的路径设置静态文件）。

* * *

编辑：

问题解决了。有一个实例，用方法`SpecialChars`覆盖`q`值`EntitiesEncode`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-11T15:27:50.053

问题是`ê`字符在两个字符串中都被转义了。所以如果你做了这样的事情，它就行不通了：

```
 string line = "sample iber&ecirc; text";
        string q = "iber&#234;";
        if (line.Contains(q)) {
            // do something
        } 
```

您需要取消转义字符串。`HttpUtility`在`System.Web`装配中使用。这将起作用：

```
 line = System.Web.HttpUtility.HtmlDecode(line);
        q = System.Web.HttpUtility.HtmlDecode(q);
        if (line.Contains(q)) {
            // do something
        } 
```

正如下面@r3bel 所建议的，如果您使用.net 4 或更高版本，您也可以使用`System.Net.WebUtility.HtmlDecode`，因此您不需要额外的程序集参考。

# symfony - 基于 FOSUserBundle 和引导程序的登录模式窗口无法正常工作

> ID：15952669
> 
> 赞同：3
> 
> 时间：2013-04-11T15:21:42.917
> 
> 标签：symfony, modal-dialog, bootstrap-modal

我正在使用 FOSUserBundle 来管理我的网站用户。我的目标是让登录表单显示在基于 boostrap 框架的模式窗口中。Down是我的模态窗口代码

```
<div class="modal hide" data-backdrop="static" id="login">
    <div class="modal-header"> <a class="close" data-dismiss="modal">×</a>
        <h3>Connexion</h3>
    </div>
    <div class="modal-body" >

    </div>
</div>
<a class="btn btn-primary" data-toggle="modal" data-target="#login" 
   href="{{ path('fos_user_security_login') }}">Sign in</a> 
```

如果用户在输入用户名和密码时没有犯任何错误，则此代码运行良好。如果出现错误，symfony2 会将我直接重定向到`/login`页面，这是捆绑 FOSUserBundle 提供的极简主义树枝页面。

为了摆脱这个问题，我的想法是监听将再次显示窗口的 javascript 事件。这是通过 window.hashchange 事件完成的。建议的代码是：

```
<script type="text/javascript" src="{{ asset('jquery/1.9.1/jquery.ba-hashchange.min.js')}}"></script>
<script>
        $(function() {

            // Bind the event.
            $(window).hashchange(function() {
                // Alerts every time the hash changes!
                alert(location.hash);
                if(location.hash === "#login"){
                  $('#login').modal();  
                }
            });

            // Trigger the event (useful on page load).
            $(window).hashchange();

        });
    </script> 
```

这太棒了：通过这段代码，如果我到达这个 url，我就可以显示到登录模式窗口`/#login`。

但是，问题还没有解决，因为symfony中存在路由问题。我害怕必须重写所有捆绑包以在 FOSUserBundle 的控制器中进行重定向。

任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T12:07:17.100

您可以在登录后使用以下命令检查是否有错误：

```
{% if error %}
    {# do something #}
{% endif %} 
```

这意味着您可以检查是要隐藏模式还是要在页面加载中显示它，如下所示：

```
<div class="modal{% if not error %} hide{% endif %}">
    <!-- model window -->
</div> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-06T13:29:07.813

我解决了覆盖 login.twig.html 并将其放在开头附近的问题

```
{% if error %}
    <script>
        $('.modal').modal("show");
    </script>
    <div>{{ error|trans }}</div>
{% endif %} 
```

但是当用户单击安全操作并重定向到他单击的链接而不是包含该链接的页面时，我仍然想念如何使此模式出现（$request->headers->get('referer ') 尽管首先从安全操作所在的地方重定向)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2016-10-03T09:41:25.670

我认为这是使用 FOSUserBundle 登录成功/失败后管理重定向的最佳方法：

Stackoverflow 问题：[登录 fos 用户捆绑 symfony 后重定向](https://stackoverflow.com/questions/16020508/redirect-after-login-fos-user-bundle-symfony)

基本上，添加一个实现 AuthenticationSuccessHandler 接口的[LoginSuccessHandler](http://www.reecefowell.com/2011/10/26/redirecting-on-loginlogout-in-symfony2-using-loginhandlers/)来对 loginAction 的成功或失败执行不同的操作

# android - ViewPager、片段和适配器

> ID：15952672
> 
> 赞同：1
> 
> 时间：2013-04-11T15:21:53.557
> 
> 标签：android, android-viewpager

我在 ViewPager 中有 20 个页面，每个页面都是一个 Fragment，包含 5 个视图。现在，我从服务器获取一些东西并将视图添加到这个 ViewPager。我调用 notifyDataSetChanged()，但有时会导致错误，之后视图被错误地移动。我已阅读此[http://android-developers.blogspot.com/2011/08/horizo](http://android-developers.blogspot.com/2011/08/horizontal-view-swiping-with-viewpager.html) ​​ntal-view-swiping-with-viewpager.html但找不到如何实现 POSITION_CHANGED。当我们添加/移动元素时，谁能指出我关于 FragmentPagerAdapter 实现的好教程？

谢谢。

# jaxb - Jaxb eclipse moxy Nullable in element 和 XmlAdapter with Map

> ID：15952673
> 
> 赞同：1
> 
> 时间：2013-04-11T15:22:00.733
> 
> 标签：jaxb, moxy

这是我根据示例的代码：我正在寻找格式化 Map 中的 Date 字段，但它抛出了这个异常：

```
The object [{birthDate=1963-07-16 00:00:00.0}], of class [class org.hibernate.collection.internal.PersistentMap], could not be converted to [class it.cineca.jaxb.adapter.MyMapType]. 
```

例子

```
import java.text.SimpleDateFormat;
import java.util.Date;
import java.util.HashMap;
import java.util.Map;
import java.util.Map.Entry;

import javax.xml.bind.annotation.adapters.XmlAdapter;

public final class MyMapAdapter extends

   XmlAdapter<MyMapType,Map<String, Date>> {

   private SimpleDateFormat dateFormat = new SimpleDateFormat("dd/MM/yyyy");

   @Override
   public MyMapType marshal(Map<String, Date> arg0) throws Exception {
      MyMapType myMapType = new MyMapType();
      for(Entry<String, Date> entry : arg0.entrySet()) {
         MyMapEntryType myMapEntryType =
            new MyMapEntryType();
         myMapEntryType.key = entry.getKey();
         myMapEntryType.value = dateFormat.parse(entry.getValue().toString());
         myMapEntryType.value = entry.getValue();
         myMapType.entry.add(myMapEntryType);
      }
      return myMapType;
   }

   @Override
   public Map<String, Date> unmarshal(MyMapType arg0) throws Exception {
      HashMap<String, Date> hashMap = new HashMap<String, Date>();

      for(MyMapEntryType myEntryType : arg0.entry) {
         hashMap.put(myEntryType.key, myEntryType.value);
      }
      return hashMap;
   }

}

import java.util.Date;

import javax.xml.bind.annotation.XmlAttribute;
import javax.xml.bind.annotation.XmlValue;

public class MyMapEntryType {

   @XmlAttribute
   public String key;

   @XmlValue
   public Date value;

}

import java.util.ArrayList;
import java.util.List;

public class MyMapType {

   public List<MyMapEntryType> entry = 
      new ArrayList<MyMapEntryType>();

} 
```

这是人员绑定文件

```
 <?xml version="1.0"?>
     <xml-bindings
        xmlns="http://www.eclipse.org/eclipselink/xsds/persistence/oxm"
        package-name="it.model"  xml-mapping-metadata-complete="true">
        <xml-schema
            element-form-default="QUALIFIED"/>
        <java-types>
            <java-type name="Person"  xml-accessor-type="NONE">
                <xml-root-element/>
                <xml-type prop-order="firstName lastName stringMap "/>
                <java-attributes>
nillable="true"/>
                    <xml-element java-attribute="stringMap" name="string-map" nillable="true"/>
                    <xml-element java-attribute="dateMap" name="date-map" nillable="true">
                        <xml-java-type-adapter value="it.cineca.jaxb.adapter.MyMapAdapter" />
                    </xml-element>                  
          <xml-element java-attribute="positionCurrentSet" name="position-current-set" nillable="true">
       <!-- UNLIKELY THIS DOESN'T PRODUCE EMPTY NODE -->
       <xml-null-policy xsi-nil-represents-null="true" empty-node-represents-null="true" null-representation-for-xml="EMPTY_NODE" is-set-performed-for-absent-node="true" />
                    </xml-element>                  
                </java-attributes>
            </java-type>
    </java-types>
    </xml-bindings> 
```

那么我该如何解决呢？我尝试按照[http://blog.bdoughan.com/2010/07/xmladapter-jaxbs-secret-weapon.html](http://blog.bdoughan.com/2010/07/xmladapter-jaxbs-secret-weapon.html) 帖子进行操作，但我没有找到相同逻辑的错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T19:03:36.797

我认为您在 MyMapAdapter 中颠倒了参数类型。来自 JAXB javadocs：

> 公共抽象类 XmlAdapter<ValueType,BoundType>
> 
> BoundType - JAXB 不知道如何处理的类型。编写了一个适配器以允许通过 ValueType 将此类型用作内存中的表示。
> 
> ValueType - JAXB 知道如何开箱即用处理的类型。

尝试将您的类签名更改为`MyMapAdapter extends XmlAdapter<Map<String, Date>, MyMapType>`，并交换您的编组和解组方法。

希望这可以帮助，

瑞克

# node.js - 如何在 Node/Express.js 中禁用 HTTP 请求日志

> ID：15952674
> 
> 赞同：32
> 
> 时间：2013-04-11T15:22:03.090
> 
> 标签：node.js

我目前正在开发基于 Node/Express.js 的应用程序。

我有很多不同的资源文件（图像、css、js ......），我不想在执行我的应用程序时记录这些文件......

**示例：**我的节点应用程序日志：

```
GET /stylesheets/bootstrap.min.css 200 0ms
GET /js/lib/jquery-1.8.2.min.js 200 0ms
GET /stylesheets/bootstrap-responsive.2.1.1.min.css 200 0ms
GET /stylesheets/font-awesome.css 200 0ms
GET /stylesheets/bootstrapSwitch.css 200 0ms
GET /js/lib/jquery-ui-1.8.23.effects.min.js 200 0ms
GET /js/lib/knockout-2.1.0.js 200 0ms
GET /js/src/messages.manage.js 200 0ms
GET /js/lib/bootstrap.2.1.1.min.js 200 0ms
GET /js/lib/bootstrapSwitch.js 200 0ms
... 
```

我的问题是：

我可以根据文件的扩展名删除这些日志吗？示例： *.js ， *.css 等...

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2013-04-11T18:31:37.727

将日志插件移到应用初始化中的资源插件下方。完毕。

哇哦连接！

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2015-04-24T20:38:25.230

在 express.js 4 上，

评论：`//app.use(morgan('dev'));`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-04-19T13:37:33.827

也许这有帮助

```
app.use((req, res, next) => {
  if (
    [
      ".css",
      ".js",
      ".jpg",
      ".jpeg",
      ".gif",
      ".ico",
      ".png",
      ".bmp",
      ".pict",
      ".csv",
      ".doc",
      ".pdf",
      ".pls",
      ".ppt",
      ".tif",
      ".tiff",
      ".eps",
      ".ejs",
      ".swf",
      ".midi",
      ".mid",
      ".ttf",
      ".eot",
      ".woff",
      ".woff2",
      ".otf",
      ".svg",
      ".svgz",
      ".webp",
      ".docx",
      ".xlsx",
      ".xls",
      ".pptx",
      ".ps",
      ".class",
      ".jar"
    ].indexOf(path.extname(req.path)) == -1
  ) {
    logger("dev")(req, res, next);
  } else {
    next();
  }
}); 
```

# xslt - 将文本与编码的链接文本匹配 (XSLT)

> ID：15952675
> 
> 赞同：1
> 
> 时间：2013-04-11T15:22:08.263
> 
> 标签：xslt

我正在尝试处理具有 xml 编码的 url 并且是当前节点的属性的文档。我想将标签的内容与静态字符串匹配。到目前为止，我能做的最好的就是使用包含：

```
<xsl:when test="contains(@Activity,'&gt;stringToMatch&lt;/a&gt;')" > 
```

有没有更好的办法？

# javascript - roundabout js - 仅显示 5 个元素

> ID：15952676
> 
> 赞同：1
> 
> 时间：2013-04-11T15:22:08.820
> 
> 标签：javascript, jquery, css, jquery-plugins, carousel

我用roundabout.js 创建了一个轮播。我有一个带有 10-20 锂元素的旋转木马。但我只想显示其中的 5 个。（重点关注的元素，2 prev & 2 next 元素）

第二个问题：设置元素之间的边距是否有任何变化？（我不希望它们覆盖

截屏：

![在此处输入图像描述](https://i.stack.imgur.com/3I1Tf.jpg)

我的代码（我使用“泪珠”形状从图像中获取位置效果）

```
$(document).ready(function() {
  $('#slider').roundabout({
    minOpacity : 1,
    minScale : 0,
    startingChild : 2,
    shape: "tearDrop"
  });
}); 
```

# javascript - Phonegap：window.location 忘记了我的 CSS 和我的风格

> ID：15952678
> 
> 赞同：0
> 
> 时间：2013-04-11T15:22:11.513
> 
> 标签：javascript, jquery, iphone, cordova

感谢这个网站；）

我正在使用 phonegap 和 jquery mobile 开发一个 iPhone 应用程序。

在我的第一页上，我重定向到 login.html 页面。我只把它放在我的 index_bis.js 文件中：window.location.href ='login.html';

重定向有效，但我的页面上没有样式。当我不重定向时，该样式有效！:(

一个主意 ？非常感谢！

这是我的 index.html 的一部分：

```
<head>
    <title>...</title>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <link rel="stylesheet" href="css/jquery.mobile-1.3.0.css" />
    </head>   

<body>

    <script src="js/jquery.js"></script>
    <script src="js/jquery.mobile-1.3.0.js"></script>
    <script src="js/login.js"></script>
    <script src="js/index_bis.js"></script>

</body> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T15:38:44.903

当您执行 window.location 时，当前页面将替换为调用页面，因此您的所有样式引用都将丢失。

您应该查看使用 JQM 的单页应用程序体系结构。第一个 html 页面加载和所有其他页面使用添加到 DOM 的 ajax 异步加载。请仔细阅读[本文档](http://jquerymobile.com/demos/1.2.0-alpha.1/docs/pages/page-links.html)，您会有所了解。

多页链接是您需要链接页面的方式。

如果你想以编程方式导航，你需要使用[$.mobile.changePage()](http://api.jquerymobile.com/jQuery.mobile.changePage/)方法

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-11T15:27:16.247

也许是愚蠢的问题，但是您在 login.html 中是否包含相同的样式和库？他们有正确的路径吗？

试着指出可能的问题:)

# arrays - 尝试使用 cURL 从 urls 数组中获取信息，收到错误请求

> ID：15952679
> 
> 赞同：0
> 
> 时间：2013-04-11T15:22:12.627
> 
> 标签：arrays, curl

我的 urls 数组包含大约 100 个 url，并且正在从为类似的东西设计的 API 中获取信息。无论如何，就像 50% 的网址返回

```
400 Bad Request

Your browser sent a request that this server could not understand.
GET /player/euw/Wolves Deficio/ingame HTTP/1.1
User-Agent: Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.8.1.1) Gecko/20061204 Firefox/2.0.0.1
Host: api.captainteemo.com
Accept: */* 
```

网址是 100% 正确的，因为当我将它们复制到浏览器时，我确实得到了信息。

这是我的代码：

```
function get_data($urls) {
    // spoofing FireFox 2.0
    $useragent = "Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.8.1.1) Gecko/20061204 Firefox/2.0.0.1";

    $ch = curl_init();

    // set user agent
    curl_setopt($ch, CURLOPT_USERAGENT, $useragent);
    if(is_array($urls)) {
        $output = array();
        foreach($urls as $url) {
            // set the rest of your cURL options here
            curl_setopt($ch, CURLOPT_URL, $url); 
            //return the transfer as a string 
            curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1); 
            // $output contains the output string 
            array_push($output, curl_exec($ch));
        }
    }
    else {
        // set the rest of your cURL options here
        curl_setopt($ch, CURLOPT_URL, $urls); 
        //return the transfer as a string 
        curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1); 
        // $output contains the output string 
        $output = curl_exec($ch);

    }
    // close curl resource to free up system resources 
    curl_close($ch);    

    return $output;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T16:38:34.350

我在重定向的情况下添加了 CURLOPT_FOLLOWLOCATION

```
curl_setopt($ch, CURLOPT_FOLLOWLOCATION, true); 
```

尝试这个：

```
<?php

function get_data($urls) 
{
    if ( !is_array( $urls ) ) 
        $urls = array( '0' => $urls );

    $useragent = "Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.8.1.1) Gecko/20061204 Firefox/2.0.0.1";

    $ch = curl_init();

    curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
    curl_setopt($ch, CURLOPT_USERAGENT, $useragent);
    curl_setopt($ch, CURLOPT_FOLLOWLOCATION, true);

    $output = array();

    foreach($urls as $url)
    {
        curl_setopt($ch, CURLOPT_URL, $url); 
        $output[$url] = curl_exec($ch);
    }

    curl_close($ch);

    return $output;
}

$urls = array(
                'http://www.wikipedia.org/',
                'http://www.stackoverflow.com'
             );

//or single url
//$urls = 'http://www.stackoverflow.com';

print_r ( get_data($urls) ); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T10:40:19.173

问题是我欺骗了用户代理而不是使用真实的，也没有用“+”替换“”。

# wpf - WPF DataGrid - 如果存在无效单元格，如何停止用户继续操作？(MVVM)

> ID：15952688
> 
> 赞同：2
> 
> 时间：2013-04-11T15:22:28.347
> 
> 标签：wpf, mvvm, wpfdatagrid

我正在我的 DataGrid 中实现编辑功能。一个典型的`CellEditingTemplate`细胞看起来像这样：-

```
<DataGridTemplateColumn.CellEditingTemplate>
    <DataTemplate>
        <TextBox Grid.Column="0" 
                 Text="{Binding Concentration, ValidatesOnDataErrors=True, NotifyOnValidationError=True, UpdateSourceTrigger=LostFocus}"
                 Validation.ErrorTemplate="{StaticResource errorTemplate}" />
    </DataTemplate>
</DataGridTemplateColumn.CellEditingTemplate> 
```

在此示例中，有一个 TextBox 绑定到名为“Concentration”的属性，该属性是 double 类型的属性，通过验证以确保它在给定范围内。绑定到网格的模型是`IDataErrorInfo`顺便实现的。

问题是，尽管输入无效值时错误模板会突出显示单元格，但没有什么可以阻止我将焦点从该单元格（或行）移开。使用数据网格编辑处理验证的首选方法是什么？我想知道是否可以阻止用户在输入有效值之前离开单元格，但这可能很危险——在输入有效值之前，他们将无法做任何事情（甚至关闭应用程序）。

如果数据网格包含任何无效行，另一个选项可能是阻止用户继续。但是测试这个的最好方法是什么？IDataErrorInfo 没有提供我可以在每个行的模型上检查的“IsValid”属性。

最后，如果用户输入的内容无效，我可以将模型的属性恢复为之前的“好”值（或默认值）。

有什么建议么？顺便说一句，我正在使用 MVVM。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T17:49:11.057

我用它来查看 IDataerrorInfo 对象是否有任何错误，实现的一小段：

```
protected Dictionary<string, string> _propertyErrors = new Dictionary<string, string>();
public bool HasErrors {
    get { return (_propertyErrors.Count) > 0; }
} 
```

然后我可以处理评估此属性后要做什么的逻辑。您是否要阻止导航、关闭应用程序等。然后您需要评估该代码中的错误，然后取消该操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T17:27:04.747

我过去曾使用此方法来确定数据网格是否有错误：

```
private bool HasError(DataGrid dg,)
{
   bool errors = (from c in
                    (from object i in dg.ItemsSource
                     select dg.ItemContainerGenerator.ContainerFromItem(i))
                  where c != null
                  select Validation.GetHasError(c)
                 ).FirstOrDefault(x => x);
   return errors;
} 
```

然后，如果方法返回 true，则只需阻止下一步操作。

# networking - 调制解调器 3G - 两个不同的 IP

> ID：15952690
> 
> 赞同：1
> 
> 时间：2013-04-11T15:22:33.433
> 
> 标签：networking, ip, port, 3g, modem

我刚刚看到了一些我以前从未见过的东西。我从 Nextel（通信公司）拿到了一张新的 SIM 卡。我尝试在 3G 调制解调器 E3131 上使用它，我之前在 VIVO（另一家通信公司）有一个成功的案例。现在不同了，我得到了两个不同的 IP，而不是只有一个外部 IP。

例如：

当我访问 whatismyip.com 之类的服务时，我看到一个 IP 200.xxx.xxx.xxx，但是当我在 ipconfig /all 上查看它时，我看到另一个 IP 10.xxx.xxx.xxx。

我的问题是我无法从另一台计算机连接到我的应用程序，因为没有端口重定向到内部 IP。我必须连接到一些特定的端口。

有谁知道如何解决这个问题？

提前致谢！

# vb.net - 在linq中获取基于客户端的用户登录名？

> ID：15952695
> 
> 赞同：-3
> 
> 时间：2013-04-11T15:22:40.067
> 
> 标签：vb.net, linq, linq-to-sql

如何使用 LINQ 查询根据用户名表检索客户端？ ![在此处输入图像描述](https://i.stack.imgur.com/u7sGM.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T15:33:54.583

搜索具有所需用户名的用户并获取关联的客户端。

```
Dim username = "Bob"
Dim clients =
    From user In db.App_Users
    Where user.Username = username
    Select user.Dim_Client 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T15:29:39.460

要根据用户名获取客户端，这样的事情应该可以工作。

```
dim client = ( _
    From client In Dim_Client
    Where client.App_Users.Any(Function(user) user.Username = "foo")
    Select client).Single 
```

# c - GTK非标准输入

> ID：15952703
> 
> 赞同：-1
> 
> 时间：2013-04-11T15:23:08.340
> 
> 标签：c, gtk

我正在尝试将钢琴键解释为键盘输入。我在 Raspberry Pi 上通过 UART 接收钢琴键号。我有一个使用 GTK 用 C 语言制作的 GUI，当我检测到某些钢琴键时，我需要将它们作为键盘输入或箭头键发送以导航 GUI。有人知道怎么做吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T15:36:07.060

据我所知，您不希望将钢琴键解释为键盘输入；相反，您希望以与键盘输入相同的方式处理钢琴键。在接收到指定的钢琴键事件时，让它调用与相应键盘键相同的函数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-11T15:45:30.690

在 Linux 中，最简单的方法是使用 X11 的 XTest 扩展，尤其是函数`XTestFakeKeyEvent`.

但不要忘记调用`XTestQueryExtension`初始化扩展！这是一个常见的陷阱：如果您不调用此函数，其他`XTest*`函数将根本不起作用！

您还可以让您的钢琴成为一个真正的键盘，编写用户空间驱动程序：您可以创建输入设备并将输入事件发送到内核使用`uinput`内核驱动程序：基本上它创建一个`/dev/uinput`您可以使用`ioctl`s 操作的设备以执行您需要的任何操作.

# php - 使用 PHP 在 MySQL 中插入电子邮件地址

> ID：15952704
> 
> 赞同：2
> 
> 时间：2013-04-11T15:23:14.360
> 
> 标签：php, mysql

在过去的几个小时里，我一直在与一个非常荒谬的错误作斗争。只是我正在制作注册表单。用户需要输入电子邮件，邮件将存储在 mysql 表中。（我必须警告你 - 请忽略安全问题，整个事情只是一个练习）。但是我经常从 sql 中得到以下错误：

> 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 1 行的“@gmail.com,blqh2@gmail.com,1)”附近使用正确的语法

html如下：

```
 <form method="post" action="createnew.php">
            <label >user name</label>
            <input name="login_id"></br>
            <label>password</label>
            <input name="password" password></br>
                    ...some more stuff...
            <label>Privet e-mail</label>
            <input name="prv_email"></br>
            <label>Public e-mail</label>
            <input name="pub_email"></br>
            <label>Are you a reseller</label>
            <input type="checkbox" name="reseller"></br>
            <input type="submit">
        </form> 
```

然后是PHP：

```
$login_id=$_POST['login_id'];
$password=$_POST['password'];
...some more stuff...
$pub_email=$_POST['pub_email'];
echo $prv_email;
echo $pub_email;
if (array_key_exists('reseller',$_POST)) {
    $reseller=1;
}
else {
    $reseller=0;
}
$sql="INSERT INTO users".
    "(login_id,password,usr_phone,region,prv_email,pub_email,reseller)".
    "VALUES".
"($login_id,$password,$usr_phone,$region,$prv_email,$pub_email,$reseller)" 
```

最后是邮件字段的 MySQL 格式（实际上它们 prv_email 和 pub_email 具有相同的格式）

```
 Field     | Type         | Collation
    ----------|--------------|-------------------  
    pub_email | varchar(255) | utf8_general_ci 
```

我确实尝试了很多东西，但似乎没有任何效果。它总是在@处粉碎。还有一件事——我在 localhost 上运行这个代码（使用 WAMP），不确定这是否有任何问题可以解决。如果您需要任何其他信息，请告诉我，非常感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-11T15:25:46.453

以下：

```
"($login_id,$password,$usr_phone,$region,$prv_email,$pub_email,$reseller)" 
```

将被解析为文字，将其呈现为您在上面看到的错误。您需要将每个变量括在单引号中，以便将其视为字符串值。

我建议你看看[PDO & Prepared Statements](http://php.net/manual/en/pdo.prepare.php)，因为 PDO 提供了一个对数据库的抽象层，以及很好的安全性（例如通过 Prepared Statements）。

此外，您正在插入到 field `pub_email`，但是从帖子中给定的输出来看，它应该是`pub_mail`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-11T15:26:04.713

您必须将值括在单引号 (') 中更改此代码段：

```
$sql="INSERT INTO users".
    "(login_id,password,usr_phone,region,prv_email,pub_email,reseller)".    "VALUES".
    "($login_id,'$password','$usr_phone','$region','$prv_email','$pub_email','$reseller')" 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-11T15:28:02.850

您至少需要`'`在字符串周围添加 's[`mysql-real-escape-string()`](http://www.php.net/manual/en/function.mysql-real-escape-string.php)并对所有传递的参数执行 a 。更好的是使用带有 PDO 或 mysqli 的准备好的语句

# sharepoint-2010 - 如何从 SharePoint 2010 中的现有 excel 文件创建 excel 文件

> ID：15952707
> 
> 赞同：1
> 
> 时间：2013-04-11T15:23:16.877
> 
> 标签：sharepoint-2010

我将在其中一个 SP 列表中存储一个主 excel 文件。在按钮上单击我必须通过读取主模板来创建新的 excel 文件，并且需要修改一些单元格并将新文件存储在单独的 SP 列表中。

任何帮助或指导将不胜感激..

# java - 寻找绝对路径

> ID：15952711
> 
> 赞同：1
> 
> 时间：2013-04-11T15:23:29.657
> 
> 标签：java, file, relative-path, absolute-path

我在看代码`new FileInputStream("config.properties")`。

我在我的项目（进行 Windows 文件搜索）的多个地方都有相同的文件“config.properties”，现在我很困惑这个函数调用是指哪个文件。我如何知道文件的**绝对路径**？

我在互联网上找到了这个，但这个位置看起来不像是正确的答案。

`"ClassName".class.getProtectionDomain().getCodeSource().getLocation().getPath()`但这看起来不像。如果我错了，你能纠正吗

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-11T15:25:05.973

您可以使用`File`：

```
File f = new File("config.properties");
System.out.println(f.getAbsolutePath()); 
```

返回的路径将从当前工作目录推导出来。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-11T15:26:03.510

```
File f = new File("config.properties");
String dirPath = file.getParentFile().getAbsolutePath() 
```

# c# - 无法使用 REST 重命名 SharePoint 2013 中的文件夹

> ID：15952717
> 
> 赞同：6
> 
> 时间：2013-04-11T15:23:44.537
> 
> 标签：c#, rest, sharepoint, sharepoint-2013

我在使用 SharePoint 2013 提供的 REST api 重命名文档库中的文件夹时遇到问题。这是我在下面使用的代码。

```
string digest = String.Empty;
using (var response = await connector.HttpClient.PostAsync("_api/contextinfo", null, token)) 
{
    response.EnsureSuccessStatusCode();
    var obj = await response.ReadObject("d");
    digest = obj["GetContextWebInformation"].Value<string>("FormDigestValue");
}

using (var request = new HttpRequestMessage(HttpMethod.Post, String.Format("/_api/Web/GetFolderByServerRelativeUrl('{0}')", operation.Path.FullName))) 
{
    request.Headers.Add("X-HTTP-Method", "MERGE");
    request.Headers.Add("IF-MATCH", "*");
    request.Headers.Add("X-RequestDigest", digest);

    //{ '__metadata': { 'type': 'SP.Folder' }, 'Name': 'New name' }
    dynamic obj = new JObject();
    obj.__metadata = new JObject();
    obj.__metadata.type = "SP.Folder";
    obj.Name = operation.DesiredName;

    request.Content = new ODataJObjectContent(obj);

    using (var response = await connector.HttpClient.SendAsync(request, token)) 
    {
        response.EnsureSuccessStatusCode();
        await response.ReadText();
    }
} 
```

在提琴手这里是请求：

```
POST http://2013.blah.com/_api/Web/GetFolderByServerRelativeUrl('/Shared%20Documents/Test') HTTP/1.1
X-HTTP-Method: MERGE
IF-MATCH: *
X-RequestDigest: 0xA7C057B3AECE805B7313909570F64B8EACD7A677014B8EBE7F75CC5A7C081F87973D94E7CC22346964ECAB1FE3C6B326DA3B67DF7A646FE6F47E9B1E686C3985,11 Apr 2013 15:13:05 -0000
Accept: application/json; odata=verbose
Content-Type: application/json; odata=verbose
Host: 2013.skysync.com
Content-Length: 50
Expect: 100-continue

{"__metadata":{"type":"SP.Folder"},"Name":"Test2"} 
```

然后是回应：

```
HTTP/1.1 204 No Content
Cache-Control: private, max-age=0
Expires: Wed, 27 Mar 2013 15:13:15 GMT
Last-Modified: Thu, 11 Apr 2013 15:13:15 GMT
Server: Microsoft-IIS/8.0
X-SharePointHealthScore: 0
SPClientServiceRequestDuration: 15
X-AspNet-Version: 4.0.30319
SPRequestGuid: 53bd109c-43bb-2064-4a1b-82298b670ece
request-id: 53bd109c-43bb-2064-4a1b-82298b670ece
X-RequestDigest: 0x9CDB4F31CC5F3877C4383657C12BEC6CFF10FC28AB6A0BB2D9D38B4279187CBD1450359BDFF07F0E63FF550BFF96C46E0476FB895CDA104348AC066D86246BC6,11 Apr 2013 15:13:15 -0000
X-FRAME-OPTIONS: SAMEORIGIN
X-Powered-By: ASP.NET
MicrosoftSharePointTeamServices: 15.0.0.4420
X-Content-Type-Options: nosniff
X-MS-InvokeApp: 1; RequireReadOnly
Date: Thu, 11 Apr 2013 15:13:15 GMT 
```

在我返回 SharePoint 之前，一切看起来都很好，并且 Test 文件夹的名称仍然相同。我正在遵循[此处](http://msdn.microsoft.com/en-us/library/jj164022.aspx#Folders)的指南，并且我还看到了其他非常相似的示例。我可以通过界面重命名它，没有任何问题。

提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-10-01T22:06:16.060

以下示例演示如何通过 SharePoint 2013 REST 服务重命名文件夹

> 场景：将`Archive`文件夹重命名为`2015`位于`Documents` 库中

```
using (var client = new SPHttpClient(webUri, userName, password))
{
    RenameFolder(client, webUri.ToString(),"Documents/Archive","2015");
} 
```

在哪里

```
 private static void RenameFolder(SPHttpClient client, string webUrl,string folderUrl,string folderName)
    {
        var folderItemUrl = webUrl + "/_api/web/GetFolderByServerRelativeUrl('" + folderUrl + "')/ListItemAllFields";
        var data = client.ExecuteJson(folderItemUrl);

        var itemPayload = new {
            __metadata = new { type = data["d"]["__metadata"]["type"] },
            Title = folderName,
            FileLeafRef = folderName,

        };
        var  itemUrl = data["d"]["__metadata"]["uri"];
        var headers = new Dictionary<string, string>();
        headers["IF-MATCH"] = "*";
        headers["X-HTTP-Method"] = "MERGE";
        client.ExecuteJson((string)itemUrl, HttpMethod.Post, headers, itemPayload);
    } 
```

> 笔记：
> 
> *   [SPHttpClient 类](https://gist.github.com/vgrem/ee202adf8f730ecd24a1#file-sphttpclient-cs)- 继承自`HttpClient`并提供一些额外的 SharePoint 特定功能，例如获取请求摘要
> *   [SPHttpClientHandler 类](https://gist.github.com/vgrem/658e3553befba9ed85b6)- 隐藏与 SharePoint Online 身份验证相关的所有复杂问题

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T10:34:53.793

尝试在清单文件中添加列表。这似乎是一个权限问题，当您必须“信任”一个应用程序时，请选择您要操作的列表。

# entity-framework - Entity Framework 5 复杂类型

> ID：15952730
> 
> 赞同：3
> 
> 时间：2013-04-11T15:24:16.287
> 
> 标签：entity-framework, ef-code-first, entity-framework-5

即使我在谷歌上搜索了一个多小时，任何人都知道在 EF5 中复杂类型是否可以参与关联？

我知道在 EF4.x 之前这是不可能的，但是现在呢？有关于此的官方文件声明吗？

我的需要是映射一个具有地址复杂类型的类人，它指的是一个城市

```
public class Person
{
    public int ID {get;set;}
    public string Name {get;set;}
    public Address Address {get; set;}
}

public class Address
{
    public string Street {get; set;}
    public City City {get; set;}
}

public class City
{
        public int ID {get;set;}
        public string Name {get;set;}
} 
```

我需要通过`EntityTypeConfiguration<T>`指定复杂类型关联来进行映射。EF5 有可能吗？提前致谢

**编辑：**即使它引用实体数据模型， 我也看到了链接[复杂类型](http://msdn.microsoft.com/en-us/library/ee382831.aspx)，它表示无法将关联映射到复杂类型。这仍然是真的吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-18T14:17:43.637

即使从 Entity Framework 6 开始，复杂类型也不能包含导航属性。

# javascript - “动态”创建元素 ID 在 jQuery 中不起作用

> ID：15952732
> 
> 赞同：0
> 
> 时间：2013-04-11T15:24:22.707
> 
> 标签：javascript, jquery

我有以下 HTML 结构：

```
<div class='message_top' id='top_7' style='cursor:pointer;'>
    <div class='top_ime'>From: official</div>
    <div class='top_status' id='status_7'>
        <img src='images/message_new.png' height='26' title='New message' />
    </div>
</div> 
```

除此之外，还有很多其他结构相同的DIV，但是ID号不同，例如：

```
<div class='message_top' id='top_15' style='cursor:pointer;'>
    <div class='top_ime'>From: official</div>
    <div class='top_status' id='status_15'>
        <img src='images/message_new.png' height='26' title='New message' />
    </div>
</div> 
```

现在，我有一个 jQuery 函数，它获取一个 div 的 ID，它应该使用属于它`.message_top`的 div 的内容执行一个操作。`.top_status`但是，由于某种原因，在语法中它似乎无法识别`.top_status`div 的 ID。我知道我不会很好地解释这一点，但这里有一个可以帮助你理解的小提琴（代码和评论在那里）：

[http://jsfiddle.net/gMy2f/1/](http://jsfiddle.net/gMy2f/1/)

```
$(function () {
    $('.message_top').click(function(){
        var id = this.id;
        status_id = id.replace("top","status");
        status = $("#"+status_id).html();
        alert(status_id+" "+status);    //status variable is empty, but...
        status2 = $("#status_7").html();
        alert(status2);                 //status2 has the expected value
    });
}); 
```

因此，如您所见，如果我调用`.html()`使用`$("#status_7").html();`它的方法可以正常工作，但如果我使用`$("#"+status_id).html();`（status_id 为“status_7”）调用它，则它不起作用。这里发生了什么事？我用过很多次类似的代码，从来没有遇到过任何问题。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-11T15:32:39.487

使用**局部**变量而不是全局变量。`window.status`是预定义的并且可能是只读的。

我今天刚刚回答了这个问题：[Javascript / jQuery 有系统变量吗？](https://stackoverflow.com/questions/15946978/does-javascript-jquery-have-system-vars/15947073#15947073)

[**更新了 jsFiddle。**](http://jsfiddle.net/gMy2f/8/)

# python - SQLAlchemy 记录日期和用户的更改

> ID：15952733
> 
> 赞同：12
> 
> 时间：2013-04-11T15:24:24.807
> 
> 标签：python, sqlalchemy, pyramid

这与另一个超过 3 年的问题非常相似：[查看 SQLAlchemy 事务、完成身份验证的用户等的一般方法是什么？](https://stackoverflow.com/questions/1862029/whats-a-good-general-way-to-look-sqlalchemy-transactions-complete-with-authent/)

我正在开发一个应用程序，我想在其中记录对特定表的所有更改。目前有一个[非常好的“配方”可以进行版本控制](http://www.sqlalchemy.org/docs/orm/examples.html#versioning-objects)，但我需要对其进行修改以记录更改发生的日期时间和进行更改的用户 ID。我采用了与 SQLAlchemy 打包的 history_meta.py 示例，并使其记录时间而不是版本号，但我无法弄清楚如何传递用户 ID。

我上面提到的问题建议在会话对象中包含用户 ID。这很有意义，但我不知道该怎么做。我尝试了一些简单的方法，`session.userid = authenticated_userid(request)`但在 history_meta.py 中，该属性似乎不再位于会话对象上。

我在 Pyramid 框架中执行所有这些操作，并且我使用的会话对象定义为`DBSession = scoped_session(sessionmaker(extension=ZopeTransactionExtension()))`. 在一个视图中我这样做`session = DBSession()`然后继续使用`session`. （我不确定这是否有必要，但这就是正在发生的事情）

这是我修改后的 history_meta.py，以防有人发现它有用：

```
from sqlalchemy.ext.declarative import declared_attr
from sqlalchemy.orm import mapper, class_mapper, attributes, object_mapper
from sqlalchemy.orm.exc import UnmappedClassError, UnmappedColumnError
from sqlalchemy import Table, Column, ForeignKeyConstraint, DateTime
from sqlalchemy import event
from sqlalchemy.orm.properties import RelationshipProperty
from datetime import datetime

def col_references_table(col, table):
    for fk in col.foreign_keys:
        if fk.references(table):
            return True
    return False

def _history_mapper(local_mapper):
    cls = local_mapper.class_

    # set the "active_history" flag
    # on on column-mapped attributes so that the old version
    # of the info is always loaded (currently sets it on all attributes)
    for prop in local_mapper.iterate_properties:
        getattr(local_mapper.class_, prop.key).impl.active_history = True

    super_mapper = local_mapper.inherits
    super_history_mapper = getattr(cls, '__history_mapper__', None)

    polymorphic_on = None
    super_fks = []
    if not super_mapper or local_mapper.local_table is not super_mapper.local_table:
        cols = []
        for column in local_mapper.local_table.c:
            if column.name == 'version_datetime':
                continue

            col = column.copy()
            col.unique = False

            if super_mapper and col_references_table(column, super_mapper.local_table):
                super_fks.append((col.key, list(super_history_mapper.local_table.primary_key)[0]))

            cols.append(col)

            if column is local_mapper.polymorphic_on:
                polymorphic_on = col

        if super_mapper:
            super_fks.append(('version_datetime', super_history_mapper.base_mapper.local_table.c.version_datetime))
            cols.append(Column('version_datetime', DateTime, default=datetime.now, nullable=False, primary_key=True))
        else:
            cols.append(Column('version_datetime', DateTime, default=datetime.now, nullable=False, primary_key=True))

        if super_fks:
            cols.append(ForeignKeyConstraint(*zip(*super_fks)))

        table = Table(local_mapper.local_table.name + '_history', local_mapper.local_table.metadata,
           *cols
        )
    else:
        # single table inheritance.  take any additional columns that may have
        # been added and add them to the history table.
        for column in local_mapper.local_table.c:
            if column.key not in super_history_mapper.local_table.c:
                col = column.copy()
                col.unique = False
                super_history_mapper.local_table.append_column(col)
        table = None

    if super_history_mapper:
        bases = (super_history_mapper.class_,)
    else:
        bases = local_mapper.base_mapper.class_.__bases__
    versioned_cls = type.__new__(type, "%sHistory" % cls.__name__, bases, {})

    m = mapper(
            versioned_cls,
            table,
            inherits=super_history_mapper,
            polymorphic_on=polymorphic_on,
            polymorphic_identity=local_mapper.polymorphic_identity
            )
    cls.__history_mapper__ = m

    if not super_history_mapper:
        local_mapper.local_table.append_column(
            Column('version_datetime', DateTime, default=datetime.now, nullable=False, primary_key=False)
        )
        local_mapper.add_property("version_datetime", local_mapper.local_table.c.version_datetime)

class Versioned(object):
    @declared_attr
    def __mapper_cls__(cls):
        def map(cls, *arg, **kw):
            mp = mapper(cls, *arg, **kw)
            _history_mapper(mp)
            return mp
        return map

def versioned_objects(iter):
    for obj in iter:
        if hasattr(obj, '__history_mapper__'):
            yield obj

def create_version(obj, session, deleted = False):
    obj_mapper = object_mapper(obj)
    history_mapper = obj.__history_mapper__
    history_cls = history_mapper.class_

    obj_state = attributes.instance_state(obj)

    attr = {}

    obj_changed = False

    for om, hm in zip(obj_mapper.iterate_to_root(), history_mapper.iterate_to_root()):
        if hm.single:
            continue

        for hist_col in hm.local_table.c:
            if hist_col.key == 'version_datetime':
                continue

            obj_col = om.local_table.c[hist_col.key]

            # get the value of the
            # attribute based on the MapperProperty related to the
            # mapped column.  this will allow usage of MapperProperties
            # that have a different keyname than that of the mapped column.
            try:
                prop = obj_mapper.get_property_by_column(obj_col)
            except UnmappedColumnError:
                # in the case of single table inheritance, there may be
                # columns on the mapped table intended for the subclass only.
                # the "unmapped" status of the subclass column on the
                # base class is a feature of the declarative module as of sqla 0.5.2.
                continue

            # expired object attributes and also deferred cols might not be in the
            # dict.  force it to load no matter what by using getattr().
            if prop.key not in obj_state.dict:
                getattr(obj, prop.key)

            a, u, d = attributes.get_history(obj, prop.key)

            if d:
                attr[hist_col.key] = d[0]
                obj_changed = True
            elif u:
                attr[hist_col.key] = u[0]
            else:
                # if the attribute had no value.
                attr[hist_col.key] = a[0]
                obj_changed = True

    if not obj_changed:
        # not changed, but we have relationships.  OK
        # check those too
        for prop in obj_mapper.iterate_properties:
            if isinstance(prop, RelationshipProperty) and \
                attributes.get_history(obj, prop.key).has_changes():
                obj_changed = True
                break

    if not obj_changed and not deleted:
        return

    attr['version_datetime'] = obj.version_datetime
    hist = history_cls()
    for key, value in attr.items():
        setattr(hist, key, value)
    session.add(hist)
    print(dir(session))
    obj.version_datetime = datetime.now()

def versioned_session(session):
    @event.listens_for(session, 'before_flush')
    def before_flush(session, flush_context, instances):
        for obj in versioned_objects(session.dirty):
            create_version(obj, session)
        for obj in versioned_objects(session.deleted):
            create_version(obj, session, deleted = True) 
```

**更新：** 好的，似乎在 before_flush() 方法中，我得到`sqlalchemy.orm.session.Session`的会话是我附加`user_id`到的会话的类型`sqlalchemy.orm.scoping.scoped_session`。因此，在某些时候，对象层被剥离。将 user_id 分配给 scoped_session 内的 Session 是否安全？我可以确定它不会用于其他请求吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2019-10-01T17:24:12.650

老问题，但仍然非常相关。

您应该避免尝试将 Web 会话信息放在数据库会话中。它结合了不相关的关注点，每个关注点都有自己的生命周期（不匹配）。这是我在带有 SQLAlchemy 的 Flask 中使用的一种方法（不是 Flask-SQLAlchemy，但它也应该有效）。我试图评论 Pyramid 的不同之处。

```
from flask import has_request_context  # How to check if in a Flask session
from sqlalchemy import inspect
from sqlalchemy.orm import class_mapper
from sqlalchemy.orm.attributes import get_history
from sqlalchemy.event import listen

from YOUR_SESSION_MANAGER import get_user  # This would be something in Pyramid
from my_project import models  # Where your models are defined

def get_object_changes(obj):
    """ Given a model instance, returns dict of pending
    changes waiting for database flush/commit.

    e.g. {
        'some_field': {
            'before': *SOME-VALUE*,
            'after': *SOME-VALUE*
        },
        ...
    }
    """
    inspection = inspect(obj)
    changes = {}
    for attr in class_mapper(obj.__class__).column_attrs:
        if getattr(inspection.attrs, attr.key).history.has_changes():
            if get_history(obj, attr.key)[2]:
                before = get_history(obj, attr.key)[2].pop()
                after = getattr(obj, attr.key)
                if before != after:
                    if before or after:
                        changes[attr.key] = {'before': before, 'after': after}
    return changes

def my_model_change_listener(mapper, connection, target):
    changes = get_object_changes(target)
    changes.pop("modify_ts", None)  # remove fields you don't want to track

    user_id = None
    if has_request_context():
        # Call your function to get active user and extract id
        user_id = getattr(get_user(), 'id', None)

    if user_id is None:
        # What do you want to do if user can't be determined
        pass

    # You now have the model instance (target), the user_id who is logged in,
    # and a dictionary of changes.

    # Either do somthing "quick" with it here or call an async task (e.g.
    # Celery) to do something with the information that may take longer
    # than you want the request to take.

# Add the listener
listen(models.MyModel, 'after_update', my_model_change_listener) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T16:54:04.833

经过一堆摆弄后，我似乎能够通过执行以下操作在 scoped_session 内的会话对象上设置值：

```
DBSession = scoped_session(sessionmaker(extension=ZopeTransactionExtension()))
session = DBSession()
inner_session = session.registry()
inner_session.user_id = "test"
versioned_session(session) 
```

现在`session`在 history_meta.py 中传递的对象有一个`user_id`我设置的属性。我有点担心这是否是正确的做法，因为注册表中的对象是一个线程本地对象，并且线程被重新用于不同的 http 请求。

# manifest - Change class member once it is loaded in puppet

> ID：15952737
> 
> 赞同：0
> 
> 时间：2013-04-11T15:24:29.790
> 
> 标签：manifest, puppet

Here's the scenario: I'm using the same 3rd party parameterized class in 2 different places in my manifests.

I don't know where the 3rd party class will be included first and in both places, I need to pass a different parameter to the class.

Right now, I only `include` the class in both places since I don't know how to resolve my situation.

Any help appreciated :)

Thanks

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T04:40:18.433

You can only declare a class once when you are using the syntax with Parameters.

```
include classname 
```

can be used multiple times, but

```
class { 'classname':
   parameter => 'yada',
} 
```

only once.

# hashmap - 使用哈希集分解 .txt 文件

> ID：15952742
> 
> 赞同：0
> 
> 时间：2013-04-11T15:24:38.400
> 
> 标签：hashmap, hashset

我正在尝试编写一个简单的抄袭程序，方法是获取一个文件并将其与其他文件进行比较，方法是每六个字拆分每个文件，然后与其他文件进行比较，这些文件也以相同的方式拆分。我正在阅读哈希集，我想我可以尝试用哈希集将它们分开，但我不知道如何。任何意见，将不胜感激。

# java - PipeInputStream 和 PipeOutputStream 是同步的还是异步的？

> ID：15952745
> 
> 赞同：0
> 
> 时间：2013-04-11T15:24:41.770
> 
> 标签：java, multithreading, asynchronous, io, blocking

我正在阅读一本 Java 书籍，我发现一个句子似乎不正确：

> 读取时，如果没有可用数据，线程将被**阻塞**，直到有新数据可用。请注意，这是一种典型的**异步**行为，线程通过通道（管道）进行通信。

为什么作者称操作为“异步”？异步不应该暗示线程在收到新数据之前不会被阻塞？

后期编辑：

我运行这段代码，它从输出中看起来行为是异步的。

这是输出的一部分：http: [//ideone.com/qijn0B](http://ideone.com/qijn0B)

代码如下。你怎么看？

```
import java.io.*;
import java.util.logging.Level;
import java.util.logging.Logger;

/*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */

/**
 *
 * @author dragos
 */

class Consumator extends Thread{
    DataInputStream in;

    public Consumator(DataInputStream in){
        this.in = in;
    }

    public void run(){
        int value = -1;
        for(int i=0;i<=1000;i++){
            try {
                value = in.readInt();
            } catch (IOException ex) {
                Logger.getLogger(Consumator.class.getName()).log(Level.SEVERE, null, ex);
            }
            System.out.println("Consumator received: "+ value);
        }
    }
}

class Producator extends Thread{
    DataOutputStream out;

    public Producator(DataOutputStream out){
        this.out = out;
    }

    public void run(){

        for(int i=0;i<=1000;i++){
            try {
                out.writeInt(i);
            } catch (IOException ex) {
                Logger.getLogger(Producator.class.getName()).log(Level.SEVERE, null, ex);
            }
            System.out.println("Producator wrote: "+i);
        }
    }
}

public class TestPipes {

    /**
     * @param args the command line arguments
     */
    public static void main(String[] args) throws IOException {
        PipedInputStream pipeIn = new PipedInputStream();
        PipedOutputStream pipeOut = new PipedOutputStream(pipeIn);

        DataInputStream in = new DataInputStream(pipeIn);
        DataOutputStream out = new DataOutputStream(pipeOut);

        Consumator c = new Consumator(in);
        Producator p = new Producator(out);

        p.start();
        c.start();

    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T15:29:46.830

> 为什么作者称操作为“异步”？异步不应该暗示线程在收到新数据之前不会被阻塞？

要么这是不正确的，要么作者正在谈论消费者线程将如何阻塞但生产者线程仍将运行。至少这个措辞肯定是令人困惑的。

在任何情况下，`PipeInputStream`和`PipeOutputStream`流共享一个内部缓冲区，但在其他方面是“同步的”。如果缓冲区已满，则写入器将阻塞，如果缓冲区为空，则读取器将阻塞。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T16:47:32.427

是的，您没有显示整个文本。如果作者说生产者没有被阻塞，那么它是异步的。消费总是阻塞。（好的，有时您可以检查答案的可用性，但同步/异步的区别在于发送者的行为）。当缓冲区长度为 0 时它将阻塞，然后写入器将始终阻塞并发生同步。所以，我们可以说阻塞/非阻塞（同步/异步）是通道的一个特性。

# java - 通过 DatagramChannel 发送消息

> ID：15952746
> 
> 赞同：0
> 
> 时间：2013-04-11T15:24:42.040
> 
> 标签：java, string

我通过 DatagramChannel 发送消息如下：

```
ByteBuffer buf = ByteBuffer.allocate(48);
buf.clear();
String request_message = "request";
buf.put(request_message.getBytes());
buf.flip();

int bytesSent = udpserver.send(buf, successor_port_1); // udpserver is a DatagramChannel 
```

然后我阅读了服务器上的消息：

```
ByteBuffer buf = ByteBuffer.allocate(48);
buf.clear();

String message = new String(buf.array(), Charset.forName("UTF-8"));
System.out.println(message); //print message for testing purposes

if (message == "request"){
    //code here does not get executed
 } 
```

问题是，我的代码没有输入“if”语句，即使 message = “request” 似乎也得到了我的 print 语句的确认。

任何帮助，将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T15:27:54.880

原因是`String`java中的s需要和比较`.equals`，所以你的测试应该是：

```
if (message.equals("request")){ 
```

这是因为，在 Java 中，`==`测试两个对象是否是同一个*实例*（它测试引用是否相等——两个引用是否都指向同一个内存）而不是相等。

您可以进行快速测试：

```
System.out.println("request" == new String("request")); 
```

输出：

```
false 
```

有关更多信息，请阅读[此](https://stackoverflow.com/a/513839/2071828)SO 答案。

# c# - 替换使用 excel 互操作

> ID：15952753
> 
> 赞同：0
> 
> 时间：2013-04-11T15:24:55.273
> 
> 标签：c#, .net, excel, office-interop, excel-interop

我有一个大量使用 excel 互操作的系统。这是有问题的，因为它部署在许多客户端站点，每个站点都有自己独特的操作系统、办公版本、区域设置等……这让我很头疼： [OleDB 和混合 Excel 数据类型：缺少数据](https://stackoverflow.com/questions/3232281/oledb-mixed-excel-datatypes-missing-data/5721521#5721521)

很难重现或解决此错误。此外，由于在 Windows 服务中使用互操作的已知问题，我无法将我的系统作为 Windows 服务运行。

所以我正在寻找的是一个工具，它允许我在不使用互操作的情况下进行 excel 导入\导出。理想情况下，它应该：

1.  支持 excel 2003 - 2013 和希望即将推出的版本
2.  支持获取值并将值写入excel（当然）
3.  支持样式操作（字体、单元格范围、边框等...）
4.  支持在excel中使用图表
5.  支持宏激活。
6.  支持csv文件

这就是我现在能想到的:-)

将不胜感激任何帮助。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T15:29:49.637

Office Interop 可能会导致兼容性问题，您需要安装有效的 Office 许可证并且......速度很慢......

可能最好的 Open 解决方案是使用[Open XML SDK](http://msdn.microsoft.com/en-us/office/bb265236.aspx)。它有据可查，Microsoft 鼓励开发人员在 Interop 上使用这种方法。

# angularjs - 在 Angular 表达式中解码 HTML

> ID：15952754
> 
> 赞同：24
> 
> 时间：2013-04-11T15:24:56.413
> 
> 标签：angularjs

解码传递给 Angular 表达式的字符串中包含的 HTML 的最佳方法是什么？

例子：

如果我从服务器返回一个字符串，如下所示：

```
var some_val = "Hello <strong>World</strong>!" 
```

如何让它呈现 HTML 而不是将其显示为文本？

```
<!-- Renders to Hello <strong>World</strong>! -->
<span>{{ some_val }}</span> 
```

*更新*：这是中继器中的实际用例：

**作品（未消毒）**

```
<div ng-repeat="category in some_list">
   <p>{{ category.name }}</p>
   <p ng-repeat="bullet in category.bullets">{{ bullet.desc }}</p>
</div> 
```

**根本不起作用**

```
<div ng-repeat="category in some_list">
   <p ng-bind-html="category.name"></p>
   <p ng-repeat="bullet in category.bullets" ng-bind-html="bullet.desc"></p>
</div> 
```

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2013-04-11T15:28:28.630

如此处所述[，在文档中](http://docs.angularjs.org/api/ngSanitize.directive%3angBindHtml)：

```
<span ng-bind-html="some_val"></span> 
```

请记住 some_val 必须是一个角度模型（基本上，a`$scope.some_val`必须存在于您的应用程序的某处）

**编辑：**

我应该澄清一下：ng-bind-html 是 module 中的一项服务`ngSanitize`，**它不包含在 angularJS core**中。`ng-bind-html-unsafe`是核心`ng`模块的一部分，但它包含您提供的字符串而不对其进行清理（请参阅[ngBindHtmlUnsafe 文档](http://docs.angularjs.org/api/ng.directive%3angBindHtmlUnsafe)中的示例）。

如果您想/需要使用 ngBindHtml，则需要包含 ngSanitize -[可在此处获得](http://code.angularjs.org/1.0.6/)

# watch - 可以将 grunt-regard 配置为运行监视任务的子集而不是所有任务吗？

> ID：15952760
> 
> 赞同：0
> 
> 时间：2013-04-11T15:25:13.873
> 
> 标签：watch, gruntjs

我正在使用 gruntjs 构建我的 js 应用程序。我的 grunt 文件设置为运行两个单独的构建，其中 80% 的代码对于两者都是相同的，并且根据构建我们包含其他文件并排除一些文件。

我有 grunt setup 可以正确运行两个不同的构建，除非我不能告诉 grunt-regard 运行多次。

```
regarde:
  coffeeScripts:
    files: ['app/scripts/kiosk/*.coffee', 'app/scripts/*.coffee'],
    tasks: ['coffee:compileKiosk', 'livereload']
  stylusScripts:
    files: ['app/css/kiosk/*.styl', 'app/css/*.styl'],
    tasks: ['stylus:compileKiosk', 'livereload']
  coffeeScriptsWeb:
    files: ['app/scripts/web/*.coffee', app/scripts/*.coffee],
    tasks: ['coffee:compileWeb', 'livereload']
  stylusScriptsWeb:
    files: ['app/css/web/*.styl', 'app/css/*.styl],
    tasks: ['stylus:compileWeb', 'livereload'] 
```

我希望能够执行类似于以下任务的操作，但只有第一个受关注的任务运行，第二个被忽略。

```
grunt.registerTask 'watchKiosk', ['livereload-start', 'regarde:coffeeScripts', 'regarde:stylusScripts']
grunt.registerTask 'watchWeb', ['livereload-start', 'regarde:coffeeScriptsWeb', 'regarde:stylusScriptsWeb'] 
```

我的文件夹结构看起来像

```
app       (application root)
  scripts (contains common script files)
    kiosk (contains script files only for kiosk build)
    web   (contains script files only for web build)
  css     (contains common css files)
    kiosk (contains css files only for kiosk build)
    web   (contains css files only for web build) 
```

理想情况下，在使用 web 构建时，我不想在文件更改时重新编译所有 kiosk 文件和 web 文件。

有什么方法可以设置 grunt 以定义多个相关任务并运行我想要为我正在处理的构建的特定任务？

如果我运行这些 grunt 任务，手表可以工作，但会重建不属于我正在使用的特定构建的文件

```
grunt.registerTask 'watchKiosk', ['livereload-start', 'regarde']
grunt.registerTask 'watchWeb', ['livereload-start', 'regarde'] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T22:28:15.113

感谢[asgoth](https://stackoverflow.com/users/1916258/asgoth)的链接，从链接的答案中，我能够找到一种方法来做到这一点。这可能不是最好的方法，但它确实有效。

我为我的相关任务添加了两种不同的配置（一种用于 kiosk 构建，一种用于 web 构建）到 grunt 文件中：

```
regardeKiosk:
  coffeeScripts:
    files: ['app/scripts/kiosk/*.coffee', 'app/scripts/*.coffee'],
    tasks: ['coffee:compileKiosk', 'livereload']
  stylusScripts:
    files: ['app/css/kiosk/*.styl', 'app/css/*.styl'],
    tasks: ['stylus:compileKiosk', 'livereload'] 
```

和

```
regardeWeb:
  coffeeScriptsWeb:
    files: ['app/scripts/web/*.coffee', app/scripts/*.coffee],
    tasks: ['coffee:compileWeb', 'livereload']
  stylusScriptsWeb:
    files: ['app/css/web/*.styl', 'app/css/*.styl],
    tasks: ['stylus:compileWeb', 'livereload'] 
```

然后我创建了一个多任务，在开始关注任务之前选择正确的配置并更新相关配置。

```
#startWatch config
startWatch:
  web: 'Web'
  kiosk: 'Kiosk'

grunt.registerMultiTask 'startWatch', 'refreshing the changed file(s)', () ->
  #read regarde config and regarde template config. @data comes from startWatch config
  regardeConfig = grunt.config('regarde')
  correctConfig = grunt.config('regarde' + @data)

  #replace regarde config with the correct config
  grunt.config('regarde', correctConfig)

  #run regarde task
  grunt.task.run('regarde') 
```

然后我可以定义我的两个 grunt 任务并根据构建选择要运行的任务

```
grunt.registerTask 'watchKiosk', ['livereload-start', 'startWatch:kiosk']
grunt.registerTask 'watchWeb', ['livereload-start', 'startWatch:web'] 
```

# entity-framework - 实体框架代码首先在 WebAPI 项目中缺少外键实体

> ID：15952766
> 
> 赞同：1
> 
> 时间：2013-04-11T15:25:30.263
> 
> 标签：entity-framework, asp.net-web-api, repository, code-first

我担心如果我包含我的代码，这篇文章会变得太长太复杂，所以我会尝试解释我的问题。但是，如果您希望看到一些说明此问题的代码，我很乐意在之后添加它。

我有一个项目，MVC4 项目（Website.Web），它首先使用实体​​框架代码。我的实体类在一个单独的项目中：Website.Domain

我有一个 NewsPost 课程：

```
public virtual int Id { get; set; }
public virtual string Subject { get; set; }
public virtual string Content { get; set; }
public virtual string ImageName { get; set; }
public virtual DateTime CreateTime { get; set; }
public virtual int CreatedById { get; set; }
public virtual ICollection<Comment> Comments { get; set; } 
```

我的评论类看起来像这样：

```
public virtual int Id { get; set; }
public virtual int CreatedById { get; set; }
public virtual DateTime CreatedTime { get; set; }
public virtual string Content { get; set; } 
```

现在在我的 MVC 项目中，我设置了带有一些存储库类的实体框架，并 ninject 将所有内容与我的控制器分开。当我在我的新闻帖子上执行“GetAll()”时。NewsPost.Comments 将填充与此新闻帖子相关的评论。这一切都完美无缺。

现在我有了想使用webapi的想法，所以我建立了一个新的MVC基础项目。我删除了视图文件夹，并删除了模型文件夹。然后我在这里设置所有存储库以及我的实体框架 dbcontext 类。并在项目上启用了迁移，以允许我首先以与 Website.Web 项目相同的方式使用实体框架代码。我还引用了与 Web 项目相同的域类。

现在问题来了。我尝试在新闻帖子上执行 GetAll()，但是当我检查 GetAll() 返回的列表时，我发现虽然它获取了数据库中的所有新闻，但 COMMENTS 为空。我很确定我的 Website.API 设置方式与我的 Website.Website.Web 相同 - 那么我错过了什么？

我希望我已经解释得足够好。同样，如果您需要任何额外的代码或者我需要澄清一些观点，我会很乐意这样做，我只是不想让问题变得比现在的代码更复杂。

# c# - 查找填充了多少位数的数组？

> ID：15952768
> 
> 赞同：2
> 
> 时间：2013-04-11T15:25:42.210
> 
> 标签：c#, arrays, list, count

假设我有字节数组

```
byte[] arr = new byte[16]; 
```

我只填充了这 16 个字节中的 10 个

```
arr[0] = 1;
arr[1] = 1;
arr[2] = 2;
arr[3] = 3;
arr[4] = 4;
arr[5] = 5;
arr[6] = 6;
arr[7] = 7;
arr[8] = 8;
arr[9] = 9;
arr[10] = 1; 
```

问题是用户最多可以输入10位数字，最后一位数字可能是0

我怎样才能找到我的数组包含多少位数，因为 arr.Length 和 arr.Count() 将给出 16，但我需要知道它是 10？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-11T15:31:43.580

我认为您最好使用通用[List](http://msdn.microsoft.com/en-us/library/6sh2ey19.aspx)。然后您可以使用该`Count`属性来获取正确数量的项目。

```
List<byte> arr = new List<byte>();

arr.Add(1);
arr.Add(2);
arr.Add(3);
arr.Add(4);
arr.Add(5);

int count = arr.Count; // returns 5;
byte[] myArray = arr.ToArray(); // returns byte array 
```

**更新**

如果数组是您唯一的选择并且您无法切换到数组，那么您就不`List<T>`走运了。问题是，默认情况下，C# 会将数组中的每个字节初始化为`0`. 因此，一旦编译器开始`new byte[16];`初始化，整个字节数组就会被 0 填充。一旦发生这种情况，就无法知道 0 是默认值还是有效值。如果在 0 到 255 之间有一个您 100% 知道不会被使用的数字，您可以使用该数字初始化数组并获取每个元素的计数 != 到该数字。

您可以做的另一件事是您可以将数组初始化为一个字节（例如`new byte[1]`），并且每次需要更多元素时，[将数组的大小调整为](http://msdn.microsoft.com/en-us/library/bb348051.aspx)一个额外的字节。然后你可以使用标准`Length`属性来查看填充了多少。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-11T15:29:06.023

好吧，如果`"0"`意味着该项目未填写（这意味着您不能`0`用作有效条目），您可以使用：

```
int numFilled = arr.Count(b => b != 0); 
```

否则，您将不得不使用“神奇”数字（例如`255`）来表示“未使用”项目。

无论哪种方式，它都不是万无一失的。如果没有理由使用固定长度的数组，那么我建议使用不同的结构，例如`List<byte>`可以动态填充并轻松*转换*为数组的结构。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-11T15:28:55.100

```
int count = arr.Where(item => item != 0).Count(); 
```

或者

```
int count = arr.Count(item => item != 0); 
```

[编辑] 正如 Jon Skeet 上面所说，这假设您没有用 0 填充任何条目。

# c# - UTF-8 与 BarcodeLib

> ID：15952771
> 
> 赞同：1
> 
> 时间：2013-04-11T15:25:51.527
> 
> 标签：c#, winforms, barcode

我正在尝试使用 BarcodeLib.dll 制作一个小型 WinForm 应用程序，它工作正常，但是当我尝试输入阿拉伯语（UTF-8）文本时，BarcodeLib 无法生成所需的图像并给了我 "Invalid Setting" 。

任何人都可以帮忙吗？谢谢！

# sql - 限制 SQL 查询

> ID：15952773
> 
> 赞同：2
> 
> 时间：2013-04-11T15:25:53.857
> 
> 标签：sql, sql-server, sql-limit

如何在以下查询中将结果限制为 10？我使用 SQLSRV。

```
SELECT Id, Firstname, Surname FROM Person WHERE Firstname LIKE ? 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-11T15:27:31.550

使用[`TOP`](http://technet.microsoft.com/en-us/library/ms189463.aspx)：

`SELECT TOP 10 Id, Firstname, Surname FROM Person WHERE Firstname LIKE ?`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-11T15:29:35.657

利用

`select top(10) Id, Firstname, Surname ....`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-11T15:47:20.237

[kevingessner](https://stackoverflow.com/a/15952811/300863)的答案当然是最简单的方法。

我只是想我会为了好玩而扔一些替代品。

```
SET ROWCOUNT 10

 SELECT Id, Firstname, Surname FROM Person WHERE Firstname LIKE ?

SET ROWCOUNT 0 
```

或者更复杂的方式：

```
With q 
as 
(
Select ROW_NUMBER() Over(Order by Id) as rn,
        Id,
        Firstname,
        Surname 
FROM Person WHERE Firstname LIKE ?
)
Select * 
From q
where q.rn <= 10 
```

# optimization - 使用 svg 库和 javascript 优化拖放

> ID：15952779
> 
> 赞同：1
> 
> 时间：2013-04-11T15:26:03.370
> 
> 标签：optimization, svg, event-handling, user-experience

目前大多数 SVG 框架都提供拖放功能。我使用过 RaphaelJs、Extjs Drawing 和 SVG.js( [http://www.svgjs.com/](http://www.svgjs.com/) )。所有框架都通过将其与元素本身绑定来提供事件处理方法。例如：

```
dragStart: function(event){
    //'this' refers to the element itself
    this.doSomething();
    this.moveTo(event.x,event.y);
}; 
```

然而这样做的后果是浏览器性能大大下降，当有超过一百个元素和一些逻辑处理时。我的元素将是复合元素，这意味着可能是矩形中的一些文本或路径，但矩形应该是拖动时事件的目标（或 this）。元素将有其他事件要监听，例如 onclick、onDblClick、onHover 等。

我的问题是，有没有办法优化这个？在应用程序显示了我上面提到的大量复合元素后，用户体验很差。

更新：

我已经使用上面提到的方法构建了一个应用程序。将事件处理程序绑定到每个对象。当元素正在监听 onhover 和 onmousedown 事件时，结果不是非常用户友好。我正在考虑优化应用程序，但不确定如何。FF中效果更明显，chrome更好。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-11-05T19:51:17.420

你确定你需要SVG吗？[Fabric.js](http://fabricjs.com/)是一个很棒的 AP​​I，用于基于 Canvas 元素进行缩放、旋转、拖放和分组。

# ios - iAd 和其他横幅

> ID：15952786
> 
> 赞同：0
> 
> 时间：2013-04-11T15:26:27.860
> 
> 标签：ios, objective-c, iad, banner

在我的应用程序中，我想展示自行车 iAd 横幅和我自己制作的另一种“横幅”。
问题是我不知道哪个可能是最佳实践。
我想以 5:1 的比例显示 iAd 横幅，这意味着对于我的五个横幅，我将显示 1 次 iAd 横幅，每次更改都将由 10 秒的计时器触发。这意味着 iAd 横幅将隐藏 50 秒，显示 10 秒，依此类推。
苹果会抱怨吗？这会影响我在 iAd 网络中的收入吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T15:59:47.703

如果您人为地限制 iAd 展示的时间（通常超过 10 秒），我相信您不会为该展示次数付费。

更好的解决方案是听取横幅视图的委托并*仅在它告诉您找不到广告时才*隐藏它。

# java - 使用 HttpClient 的智能卡 (CAC) 身份验证

> ID：15952787
> 
> 赞同：2
> 
> 时间：2013-04-11T15:26:28.993
> 
> 标签：java, keystore, smartcard, cac

每天我都需要连接到需要使用 CAC 进行身份验证的网站。我连接这个网站，然后检查是否有任何通知给我。

我想自动化这个程序。我打算使用`HttpClient`，但我不确定如何执行服务器所需的实际检查。远程服务器未使用 SSL，而是使用 SEAM 框架。

关于如何做到这一点的任何提示？我不需要 Java 代码，只需要关于如何开始这个开发的想法。我已经知道如何加载卡和证书，但不知道如何使用此信息通过身份验证。

# php - 带问号的 HTML href 链接

> ID：15952791
> 
> 赞同：1
> 
> 时间：2013-04-11T15:26:45.067
> 
> 标签：php, apache, mod-rewrite

我的 href 链接和引号有问题

我应该生成这样的链接

```
<a class="vk_share__a" href = "http://vk.com/share.php?url=http://vita-plant.ru<?=$arResult["DETAIL_PAGE_URL"] ?>&title=<?=$arResult[NAME]?>&description=<?=$arResult[PREVIEW_TEXT]?>&image=http://vita-plant.ru<?=$social_img_link;?>" id="vk_share_button<?=$social_id?>"></a> 
```

当我在 chrome 开发人员工具中检查并单击它时，它工作正常，带有 cyrillyc 字母

```
<a href="http://vk.com/share.php?url=Привет мир" title="">клик</a> 
```

但是当我将鼠标悬停并在页面上单击它时，会得到类似的东西

```
http://vk.com/share.php?url=%CF%F0%E8%E2%E5%F2%20%EC%E8%F0 
```

当我需要的时候

```
http://vk.com/share.php?url=Привет%20мир 
```

![在此处输入图像描述](https://i.stack.imgur.com/ajEDK.png)

如何在 chrome 开发人员工具和悬停单击事件中获取西里尔字母？

Mb 是 php mod_rewrite 还是 htaccess？

谢谢你！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T15:28:40.523

这实际上工作正常。

URL 不能包含非 ASCII 字符，因此浏览器将西里尔字母转换为[punycode](http://en.wikipedia.org/wiki/Punycode)以确保其正确性。

# php - 如何在没有哈希或 php 变量的情况下基于 URL 加载内容？

> ID：15952793
> 
> 赞同：0
> 
> 时间：2013-04-11T15:26:49.613
> 
> 标签：php, ajax, url, web, frontend

让我知道这个问题是否需要更多澄清。

我是一名前端开发人员，我通常使用带有大量自定义字段的 Wordpress 为客户组合一个 CMS。

当前的客户想要一个设计组合站点，该站点最初显示链接到项目的图像网格，但不是在单击时加载新页面，而是新内容会顺利加载和淡入。

我认为做这种事情的最简单方法是使用 ajax 将所有内容预先加载到一个页面上（加载屏幕可以），然后使用 jQuery 显示/隐藏/移动内容。

我遇到问题的请求是能够为不同的项目和图像提供特定的 URL。客户想要一个这样的 URL 方案：http: [//collins1.com/work/bp-helios-house/3](http://collins1.com/work/bp-helios-house/3)

末尾的数字会导致特定图像加载到给定项目中。使用php变量似乎很简单，例如：

[http://www.whatever.com?project=3&image=2](http://www.whatever.com?project=3&image=2)

并使用它们来操纵初始 AJAX 负载。

但是，如何使用更传统（漂亮）的 URL 结构（如示例）来实现呢？如果我将站点构建为一个页面加载内容，浏览器不会尝试将其加载为一个页面并仅提供 404 吗？

奖励：当用户在不重新加载页面的情况下浏览网站时，如何更改地址栏中的 URL 以创建这些链接？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T15:31:09.323

您在此处看到的内容称为 url 路由。基本上，某些服务器规则会以适当的方式重写 url，具体取决于使用的服务器和脚本语言。

例如，网址

```
http://server.com/foo/bar 
```

可以重定向到

```
http://server.com/index.php?foo=bar 
```

如果您需要一个轻量级框架来处理这个问题，请查看[www.slimframework.com](http://www.slimframework.com "超薄框架")

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T00:04:47.453

如果您想要真正漂亮的 url，您将需要一个用于 url 路由的服务器端框架，并且需要您使用 php 或 ruby​​ on rails。如果您想要一个纯前端解决方案，您可以使用哈希片段在 javascript 中伪造它。有关如何执行此操作，请参见

[http://backbonejs.org/#Router](http://backbonejs.org/#Router)

[http://www.asual.com/jquery/address/](http://www.asual.com/jquery/address/)

[http://benalman.com/projects/jquery-hashchange-plugin/](http://benalman.com/projects/jquery-hashchange-plugin/)

# jquery - 如何通过 span id 触发操作？

> ID：15952800
> 
> 赞同：0
> 
> 时间：2013-04-11T15:27:13.717
> 
> 标签：jquery

如何`<span id=`在 jquery 中触发操作？

我的html：

```
<span id="span-1"></span>
<span id="span-2"></span>
<span id="span-3"></span>
<span id="span-4"></span> 
```

我试过的

```
$('[id^="span-"]').click(function () {
        alert("this_id");
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T15:28:44.767

您需要`this.id`确保包含所需的 jQuery 库并将代码放入 document.ready

**[现场演示](http://jsfiddle.net/rdcPW/)**

```
$('[id^="span-"]').click(function () {
        alert(this.id);
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T15:27:51.113

```
$('#spanid').click(function () {
     alert(this.id);
}); 
```

IE

```
$('#span-2').click(function () {
     alert(this.id);
}); 
```

# linux - 当端口 25 上 Telnet 时，aws 上的连接超时

> ID：15952805
> 
> 赞同：1
> 
> 时间：2013-04-11T15:27:21.193
> 
> 标签：linux, amazon-web-services, timeout, postfix-mta, mail-server

谢谢你的时间。

我刚刚设置了一个 Postfix 邮件服务器，它在我的一个 aws 实例中作为 MTA 运行。我可以通过“telnet localhost 25”成功连接到本地主机，并且在本地主机上连接时，我可以向外部和内部电子邮件帐户发送电子邮件，但是每当我尝试通过“telnet zwitch.it 25”或“telnet 邮件”连接时。 zwitch.it 25' 我得到一个连接超时。

我已经设置了所有记录，包括 MX 记录和 SPF 记录，其值为“v=spf1 include:amazonses.com include:zwitch.it -all”和“spf2.0/pra include:amazonses.com include: zwitch.it ~all”。

我真的找不到这里的问题，如果有防火墙，或者端口被阻止，或者我的后缀配置有问题......如果你能帮助我，我将不胜感激。

为了设置我的 postfix 邮件服务器，我按照[http://flurdy.com/docs/postfix/](http://flurdy.com/docs/postfix/)上的说明进行操作，其中提到了安装一个简单的 postfix 服务器。

我提前感谢您的帮助。

编辑：感谢下面的答案，问题得到了解决。我只需要继续我的 aws 安全组并将 SMTP 添加到列表中！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-11T15:32:05.080

这是三件事之一：

1.) 您需要在 AWS 中编辑您的安全组以允许来自所有外部 IP 地址的端口 25。

2.) 您的 mail.zwitch.it 的 DNS 条目不指向 AWS 实例的外部 IP 地址。

3.) 您没有为实例配置静态 IP（弹性）地址。

# python - 如何让 doxygen 忽略 Python 脚本的第一行？

> ID：15952807
> 
> 赞同：2
> 
> 时间：2013-04-11T15:27:23.177
> 
> 标签：python, doxygen

我在 Doxygen 完美解析的 Python 脚本的开头有一个文档字符串。但是，如果我`#!/usr/bin/env python`在文件的开头添加（以使脚本可执行），则 Doxygen 无法识别整个文档字符串。

那么，我怎样才能让 Doxygen 忽略第一行呢？

工作文档字符串的示例：

```
"""@package HelloWorld
This is a docstring and it's recognized by doxygen.""" 
```

非工作文档字符串的示例：

```
#!/usr/bin/env python
"""@package HelloWorld
This is a docstring and it's not recognized by doxygen because of the first line.""" 
```

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T14:45:53.453

好的，我找到了：我需要先使用解析器。我尝试[了 doxypy](http://code.foosel.org/doxypy)并且效果非常好。您只需在 doxy_conf 文件中进行以下更改：

```
FILTER_SOURCE_FILES = YES
INPUT_FILTER = "python path/to/doxypy.py" 
```

# c# - 多个命令参数 wpf 按钮对象

> ID：15952812
> 
> 赞同：19
> 
> 时间：2013-04-11T15:27:37.463
> 
> 标签：c#, wpf, button, mvvm, icommand

如何从`Button`in发送多个参数`WPF`？我能够发送`TextBox`正确的值的单个参数。这是代码。

`XAML`

```
<TextBox Grid.Row="1" Height="23" HorizontalAlignment="Left" Margin="133,22,0,0"     Name="textBox1" VerticalAlignment="Top" Width="120" />
<Button Content="Button" Grid.Row="1" Height="23" Command="{Binding Path=CommandClick}" CommandParameter="{Binding Text,ElementName=textBox1}" HorizontalAlignment="Left" Margin="133,62,0,0" Name="button1" VerticalAlignment="Top" Width="75" /> 
```

`Code behind`

```
public ICommand CommandClick { get; set; }

this.CommandClick = new DelegateCommand<object>(AddAccount);

private void AddAccount(object obj)
{
    //custom logic
} 
```

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2013-07-06T16:43:33.347

除了使用在你的类中定义属性的方法（我们称之为你的 ViewModel）被你的视图绑定之外，有时（不常见）我们不想这样做，这是一个重要的工具来了解这些情况是 MultiBinding，所以为了完整起见，即使您对第一个选项感到满意，我也会介绍另一种方法。

所以回答你的问题：

**1\. MVVM 方法：**

使用 MVVM 方法并定义由视图绑定的属性，并在 ViewModel 的命令中使用这些属性，而无需 CommandParameters。

**2\. MultiBinding :** *(可以用 MVVM 方法愉快地生活)*

将命令参数作为多绑定参数传递，如下所示：

```
 <Button Content="MultiBindingExample" Command="{Binding MyCommand}">
     <Button.CommandParameter>
         <MultiBinding Converter="{StaticResource MyMultiConverter}">
             <Binding Path="..." ElementName="MyTextBox"/>
             <Binding Path="..." ElementName="MySomethingElse"/>
         </MultiBinding>
     </Button.CommandParameter>
 </Button> 
```

使用`IMultiValueConverter`接口定义转换器：

```
public class MyMultiConverter: IMultiValueConverter
{
    public object Convert(object[] values, ...)
    {
        return values.Clone();
    }
} 
```

并提取值：只需将命令中的参数称为 an`Object[]`并以与 MultiBinding 中相同的顺序使用参数。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2013-04-11T15:29:35.200

> 如何从 wpf 中的按钮发送多个参数。

您只能将一个参数作为`CommandParameter`.

更好的解决方案通常是将`TextBox`和其他控件绑定到 ViewModel 中的多个属性。然后该命令将可以访问所有这些属性（因为它在同一个类中），根本不需要命令参数。

# google-app-engine - 将大型数据存储类型 (1TB+) 备份到谷歌云存储

> ID：15952813
> 
> 赞同：0
> 
> 时间：2013-04-11T15:27:39.727
> 
> 标签：google-app-engine, google-cloud-storage, google-cloud-datastore, database-backups

有没有人成功地将大型数据存储类型备份到云存储？这是一项实验性功能，因此在 google 端的支持非常粗略。

我们想要备份到云存储（最终的目标是从云存储中提取到大查询中）的问题目前大小为 1.2 TB。

```
- description: BackUp
  url: /_ah/datastore_admin/backup.create?name=OurApp&filesystem=gs&gs_bucket_name=OurBucket&queue=backup&kind=LargeKind
  schedule: every day 00:00
  timezone: America/Regina
  target: ah-builtin-python-bundle 
```

我们不断遇到以下错误消息：

```
Traceback (most recent call last):
  File "/base/data/home/apps/s~steprep-prod-hrd/prod-339.366560204640641232/lib/mapreduce/handlers.py", line 182, in handle
    input_reader, shard_state, tstate, quota_consumer, ctx)
  File "/base/data/home/apps/s~steprep-prod-hrd/prod-339.366560204640641232/lib/mapreduce/handlers.py", line 263, in process_inputs
    entity, input_reader, ctx, transient_shard_state):
  File "/base/data/home/apps/s~steprep-prod-hrd/prod-339.366560204640641232/lib/mapreduce/handlers.py", line 318, in process_data
    output_writer.write(output, ctx)
  File "/base/data/home/apps/s~steprep-prod-hrd/prod-339.366560204640641232/lib/mapreduce/output_writers.py", line 711, in write
    ctx.get_pool("file_pool").append(self._filename, str(data))
  File "/base/data/home/apps/s~steprep-prod-hrd/prod-339.366560204640641232/lib/mapreduce/output_writers.py", line 266, in append
    self.flush()
  File "/base/data/home/apps/s~steprep-prod-hrd/prod-339.366560204640641232/lib/mapreduce/output_writers.py", line 288, in flush
    f.write(data)
  File "/python27_runtime/python27_lib/versions/1/google/appengine/api/files/file.py", line 297, in __exit__
    self.close()
  File "/python27_runtime/python27_lib/versions/1/google/appengine/api/files/file.py", line 291, in close
    self._make_rpc_call_with_retry('Close', request, response)
  File "/python27_runtime/python27_lib/versions/1/google/appengine/api/files/file.py", line 427, in _make_rpc_call_with_retry
    _make_call(method, request, response)
  File "/python27_runtime/python27_lib/versions/1/google/appengine/api/files/file.py", line 250, in _make_call
    rpc.check_success()
  File "/python27_runtime/python27_lib/versions/1/google/appengine/api/apiproxy_stub_map.py", line 570, in check_success
    self.__rpc.CheckSuccess()
  File "/python27_runtime/python27_lib/versions/1/google/appengine/api/apiproxy_rpc.py", line 133, in CheckSuccess
    raise self.exception
DeadlineExceededError: The API call file.Close() took too long to respond and was cancelled. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T09:53:00.987

从 gae 到云存储的写入操作似乎有 30 秒的*未记录*时间限制。这也适用于在后端进行的写入操作，因此您可以从云存储中的 gae 创建的最大文件大小取决于您的吞吐量。我们的解决方案是拆分文件；每次 writer-task 接近 20 秒时，它会关闭当前文件并打开一个新文件，然后我们在本地加入这些文件。对我们来说，这会产生大约 500KB（压缩）的文件，因此这可能不是您可以接受的解决方案...

# java - Android 到 JAVA SSL

> ID：15952814
> 
> 赞同：3
> 
> 时间：2013-04-11T15:27:40.363
> 
> 标签：java, android, ssl

我是 Android 的相对新手，并且在将简单的 SSL 连接连接到 java 服务器时遇到了问题。

我知道 java 服务器可以正常工作，因为我使用与服务器和 java 客户端相同的密钥库对其进行了测试。

Android 客户端确实发送了一些东西，因为 java 服务器接受了一个连接，并为 readline 变量显示了一个空值，并且没有错误消息。

我有我的密钥库和 bks 格式的信任库，并添加到 res/raw 文件夹中。

安卓客户端：

```
 SSLContext sslContext = SSLContext.getDefault();

    KeyStore trustSt = KeyStore.getInstance("BKS");
    TrustManagerFactory trustManagerFactory = TrustManagerFactory.getInstance(TrustManagerFactory.getDefaultAlgorithm());
    InputStream trustStoreStream = this.getResources().openRawResource(R.raw.truststore);
    trustSt.load(trustStoreStream, "password".toCharArray());
    trustManagerFactory.init(trustSt);

    KeyStore keyStore = KeyStore.getInstance("BKS");
    KeyManagerFactory keyManagerFactory = KeyManagerFactory.getInstance(KeyManagerFactory.getDefaultAlgorithm());
    InputStream keyStoreStream = this.getResources().openRawResource(R.raw.keystore);
    keyStore.load(keyStoreStream, "password".toCharArray());
    keyManagerFactory.init(keyStore, "password".toCharArray());

    sslContext.init(keyManagerFactory.getKeyManagers(), trustManagerFactory.getTrustManagers(), null);
    }
    catch (NoSuchAlgorithmException nsae){Log.d("SSL", nsae.getMessage());}
    catch (KeyStoreException kse){Log.d("SSL", kse.getMessage());}
    catch (IOException ioe){Log.d("SSL", ioe.getMessage());}
    catch (CertificateException ce){Log.d("SSL", ce.getMessage());}
    catch (KeyManagementException kme){Log.d("SSL", kme.getMessage());}
    catch(AccessControlException ace){Log.d("SSL", ace.getMessage());}
    catch(UnrecoverableKeyException uke){Log.d("SSL", uke.getMessage());}

    try{
         //error catch
         String error = "test";

         sslsocketfactory = (SSLSocketFactory) SSLSocketFactory.getDefault();
         s = (SSLSocket) sslsocketfactory.createSocket("192.168.2.101", port);

            outStream = s.getOutputStream();
            outStreamWriter = new OutputStreamWriter(outStream);
            bufferedWriter = new BufferedWriter(outStreamWriter);

            bufferedWriter.write(error + "\n");
            bufferedWriter.flush();          

              } //end try
              catch (UnknownHostException e) {e.printStackTrace();} 
              catch (IOException e) {e.printStackTrace();}

              finally{
                     if (s != null){
                     try {s.close();} 
                     catch (IOException e) {e.printStackTrace();}
                     }
                     }//end finally 
 } 
```

我已经指定了一个信任库，但没有指定如何在套接字上初始化信任库。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T15:40:52.513

我想改变这条线

```
sslsocketfactory = (SSLSocketFactory) SSLSocketFactory.getDefault(); 
```

使用[`SSLSocketFactory(KeyStore truststore)`构造函数](https://developer.android.com/reference/org/apache/http/conn/ssl/SSLSocketFactory.html#SSLSocketFactory%28java.security.KeyStore%29)可能会解决您的问题。

```
sslsocketfactory = new SSLSocketFactory(trustSt); 
```

# zeromq - 检测何时达到 ZMQ_RATE 限制或 ZMQ_SNDHWM

> ID：15952816
> 
> 赞同：6
> 
> 时间：2013-04-11T15:27:46.197
> 
> 标签：zeromq

有没有办法以编程方式知道 pgm zeromq 套接字何时因为已达到 ZMQ_RATE 限制而停止转发信息，或者是否因为已达到 ZMQ_SNDHWM 限制而正在丢弃数据。有一个 zmq_socket_monitor 函数调用允许用户查看客户端连接和客户端断开连接等事件。我认为应该有一个类似的速率限制结构。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2022-01-09T08:52:38.613

> **问：**
> [*“有没有办法以编程方式知道...... zeromq 套接字何时停止转发......因为......”？*]

**答：**
据我所知和所知[范围](https://stackoverflow.com/tags/zeromq/topusers)，目前还没有这种方式实施。

如果赌在没有办法的推理上，我会花我的几分钱

(a)
这种特性对 ZeroMQ 的主要目标具有零（如果不是负面的话）影响，即最大性能、最小化资源需求以实现性能和最小延迟

(b)
任何能够在核心和 c-API 中提供此功能的稳定且可接受的实现的人都可能会受到热烈欢迎来实现它，但到目前为止还没有人努力开发、测试和接受它，所以我们在 2022 年第一季度仍然处于第一方位

# ruby - 在带有 Ruby 的 HAML 中，如何在单个表列中“循环”重复图像？

> ID：15952820
> 
> 赞同：0
> 
> 时间：2013-04-11T15:27:52.100
> 
> 标签：ruby, haml

我有一个表格的这个 HAML 代码。

```
%table
  %thead
    %th Job
    %th Uptime
  %tbody
    - @hw.each do |k,v|
      %tr
        %td=k
        %td
        - v.each do |z|
          - if z=="1"
            %img{src: "images/blue.png"}
          - else
            %img{src: "images/red.png"} 
```

问题是它没有像我想要的那样在单个列中打印它。我希望在伪代码中，每个表列都有

工作 | {重复图像}

重复图像部分工作正常，列也打印得很好，问题是图像没有在匹配列内打印出来。我猜答案是 %td= ??? 但我不知道如何将这些重复的图像放在列中并将它们“添加”到前面的每个图像中（在换行符之前）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-11T15:29:19.213

你的缩进是关闭的，它需要是这样的：

```
 %td
      - v.each do |z|
        - if z=="1"
          %img{src: "images/blue.png"}
        - else
          %img{src: "images/red.png"} 
```

之后您的打印的是空`<td>`的和图像。

# bash - 如何复制文件夹并删除重复文件夹中的点文件和 PSD？

> ID：15952823
> 
> 赞同：0
> 
> 时间：2013-04-11T15:28:04.300
> 
> 标签：bash

我是一个命令行菜鸟，所以我没有起点代码，但我知道我想在哪里结束。我想获取当前工作目录并将其复制到其父目录中（当然是重命名），然后获取副本并找到所有 dotfiles、psds 和 zip 文件并删除它们。最后我想压缩重复的文件夹。我该怎么做？我知道如何通过命令行将这些步骤中的每一个作为单独的步骤执行，而不是作为一个脚本。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T15:55:10.373

> 我知道如何通过命令行将这些步骤中的每一个作为单独的步骤执行，而不是作为一个脚本。

你只是把它们放在一起，或者加入它们，`&&` 例如，

```
parent/working 
```

你在父母之下，你可以

```
 cp -r working bak \
&& find bak/ -name ".*" -o -name "*.psd" -o -name "*.zip"|xargs rm \
&& tar czf working.tar.gz bak \
&& rm -r bak 
```

以上只是将您的问题“翻译”为答案。

实际上有更简单的方法：

您可以`tar`使用您的工作目录，`--exclude=PATTERN`然后保存`cp, find/remove, and rm -r bak`步骤。

# objective-c - 如何获取以 &abc 开头并以 & 结尾的字符串

> ID：15952825
> 
> 赞同：0
> 
> 时间：2013-04-11T15:28:09.873
> 
> 标签：objective-c, nsstring

我想知道如何获取以 &abc 开头并以 & 结尾的特定字符串。我尝试使用 had prefix 和 sufix 。但这不是新线，

&xyz;123:183:184:142&
&abc;134:534:435:432&
&qwe;323:535:234:532&

我的代码：

```
NSMutableArray *substrings = [NSMutableArray new];
NSScanner *scanner = [NSScanner scannerWithString:s];
[scanner scanUpToString:@"&abc" intoString:nil]; //
NSString *substring = nil;
[scanner scanString:@"&abc" intoString:nil]; // Scan the # character
if([scanner scanUpToString:@"&" intoString:&substring]) {
   // If the space immediately followed the &, this will be skipped
   [substrings addObject:substring];
   NSLog(@"substring is :%@",substring);
}
// do something with substrings
[substrings release]; 
```

* * *

如何制作“scanner scanUpToString:@"&abc" 并计算 ":"==3 直到 "#"???? 可以帮助我

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-11T15:45:28.040

```
 NSArray *arr = [NSArray arrayWithObjects:@"&xyz;123:183:184:142&",
                    @"&abc;134:534:435:432&",
                    @"&qwe;323:535:234:532&",
                    @"& I am not in it",
                    @"&abc I am out &" ,nil];

    NSPredicate *predicate = [NSPredicate predicateWithFormat:@"self BEGINSWITH[cd] %@ AND self ENDSWITH[cd] %@",@"&abc",@"&"];

    NSLog(@"Sorted Array %@",[arr filteredArrayUsingPredicate:predicate]);
    NSArray *sortedArray = [arr filteredArrayUsingPredicate:predicate];

    NSMutableArray *finalResult = [NSMutableArray arrayWithCapacity:0];
    for(NSString *string in sortedArray)
    {
        NSString *content = string;
        NSRange range1 = [content rangeOfString:@"&abc"];
        if(range1.length > 0)
            content = [content stringByReplacingCharactersInRange:range1 withString:@""];

        NSRange range2 = [content rangeOfString:@"&"];
        if(range2.length > 0)
            content = [content stringByReplacingCharactersInRange:range2 withString:@""];

        [finalResult addObject:content];
    }

    NSLog(@"%@",finalResult); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T15:52:38.850

尝试使用[NSRegularExpression](https://developer.apple.com/library/ios/#documentation/Foundation/Reference/NSRegularExpression_Class/Reference/Reference.html)：

```
- (BOOL)isValidString:(NSString *)string
{
    NSRegularExpression *regularExpression = [NSRegularExpression regularExpressionWithPattern:@"^&abc.*&$" options:0 error:NULL];
    NSTextCheckingResult *result = [regularExpression firstMatchInString:string options:0 range:NSMakeRange(0, [string length])];
    return (result != nil);
} 
```

# php - php strtotime 给出了奇怪的结果

> ID：15952826
> 
> 赞同：2
> 
> 时间：2013-04-11T15:28:09.953
> 
> 标签：php, strtotime

有人可以解释为什么

```
echo date("Y-m-d",strtotime("Wednesday, 1 January, 2014")); 
```

返回

```
2013-01-02 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T15:32:43.727

一月后去掉逗号：

```
date_default_timezone_set('America/New_York');

echo date("Y-m-d",strtotime("Wednesday, 1 January 2014")); 
```

`strtotime()`虽然灵活，但仍有严格的格式标准。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T15:32:12.207

给出正确的格式

```
strtotime("Wednesday, January 1, 2014") 
```

# jquery - jQuery秒表，毫秒和空格键作为触发器

> ID：15952829
> 
> 赞同：-1
> 
> 时间：2013-04-11T15:28:16.773
> 
> 标签：jquery, timer, space, stopwatch, milliseconds

我刚刚开始“学习”jQuery，所以我几乎一无所知。但是，我想要一个秒表，显示分钟、秒和毫秒。我想通过按空格键启动计时器，并通过再次按空格键停止计时器。有谁知道如何做到这一点？请记住，我对 jQuery 还很陌生，所以一个好的描述会很棒。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T15:54:25.003

一种方法是使用`new Date().getTime()` 和在间隔内比较我们存储的初始时间与当前时间来检索当前时间：

`currentTime - startTime = difference in MS`

现在有了 MS 的差异，我们可以轻松地做一些基本的数学运算：

`**[LIVE DEMO](http://jsbin.com/enaxaq/2/edit)**`

```
var int, ms=0, s=0, m=0;

function swatch(){

  var startTime = new Date().getTime();
  int = setInterval(function(){
      var time = new Date().getTime(); 
      var dif = time-startTime;
      ms= dif%1000;
      s = Math.floor(dif/1000)%60;
      m = Math.floor(dif/1000/60)%60;
      $('#swatch').text( m+':'+s+':'+ms); 
  },1);

}

$(document).on('keydown', function( e ){
   if(e.keyCode == 32 && !int){
        swatch();
   }else{
     clearInterval(int);
     int=0;
   }
}); 
```

`**[OR THIS WAY (Read Rick's comments below)](http://jsbin.com/enaxaq/5/edit)**`用于前导“0”

```
 s = ('0'+ Math.floor(dif/1000)%60 ).slice(-2);
  m = ('0'+ Math.floor(dif/1000/60)%60 ).slice(-2); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T15:32:09.933

JQuery秒表示例可以在这里找到：[http ://www.jquery4u.com/jquery-date-and-time-2/online-jquery-stopwatch/](http://www.jquery4u.com/jquery-date-and-time-2/online-jquery-stopwatch/)

对于您使用空格键的开始/停止，请使用：

```
$('body').keyup(function(e){
   if(e.keyCode == 32){
       // user has pressed space
       ss();
   }
}); 
```

# php - 如何在PHP中使用mysql表的并发访问

> ID：15952832
> 
> 赞同：1
> 
> 时间：2013-04-11T15:28:23.333
> 
> 标签：php, mysql, concurrency, xampp

我有两个 PHP 文件（a.php，b.php）。在 a.php 中，我从表中检索一个值并在 PHP 中显示它并将其发送到 b.php。在 b.php 中，我将该值增加 1 并在表上更新它，（但由于许多操作，b.php 将花费更多时间）。现在的问题是在b.php中执行操作时，如果我单击a.php执行另一个任务，我需要获取增量值以显示在a.php中，但它只会显示以前的值，因为b。 php 没有完全执行。帮我解决这个问题。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-11T15:35:12.953

一个`INSERT`, `UPDATE`, or`DELETE`操作会锁定相关的表 [myISAM] 或行 [InnoDB] 直到操作完成。如果 a`SELECT`试图读取锁定的对象，它将等待操作完成。

值得注意的是，除非您的服务器严重超载，或者您的//`INSERT`操作数在数千行中，或者两者兼而有之，否则您甚至不会注意到等待。`UPDATE``DELETE`

简而言之：甚至不必担心您所描述的内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-11T15:54:01.737

您正在描述竞争条件。如果脚本 A 必须等待脚本 B 的所有操作完成以确保计数列的正确含义，那么您必须通过表锁阻塞脚本 A（无论引擎是 MyIsam 还是 InnoDB，这都是正确的）。但是，如果脚本 A 不需要等待 B 的*所有*操作完成以赋予计数列正确的含义（即只需要等待递增操作），那么您无需做任何特别的事情。

话虽如此，脚本 A 可能不是您需要担心的。**需要增加计数列的脚本 B 的其他调用更有可能创建您的竞争条件。**确保您通过 SQL 代码执行增量，而不是将值拉入 PHP，然后重新保存到数据库。

最后，您需要确保不会无缘无故地创建聚合列。如果计数列仅仅是满足特定条件集的行数，只需使用查询而不是创建保存计数的列（聚合列/表仅应在分析显示有必要且应该用于缓存工作时）明确命名以表示这一点）。

# ruby - 这个 Ruby 代码和 shell 代码有什么区别？

> ID：15952833
> 
> 赞同：2
> 
> 时间：2013-04-11T15:28:23.463
> 
> 标签：ruby, bash, shell, cpu, cpu-usage

我有一个以百分比计算 CPU 使用率的 shell 脚本。因为我想扩展功能，并且想在 Ruby 中执行此操作，而不是从 Ruby 调用 shell 脚本。

我尝试用 Ruby 重写代码，但最终输出存在差异。

shell 代码的输出在 5% 到 10% 之间，而 Ruby 代码的输出在 97.5% 到 97.8% 之间。

这是红宝石代码：

```
result = `cat /proc/stat | grep '^cpu '`.split(" ")
result.delete("cpu")
idle_time0 = result[4].to_i
total_time0 = 0

result.each do |partial_time|
  total_time0 += partial_time.to_i
end

sleep 0.5

result = `cat /proc/stat | grep '^cpu '`.split(" ")
result.delete("cpu")
idle_time = result[4].to_i
total_time = 0

result.each do |partial_time|
  total_time += partial_time.to_i
end

diff_idle = idle_time - idle_time0
diff_total = total_time - total_time0

diff_usage = (1000*(diff_total - diff_idle)/(diff_total+5).to_f)/10.0

p diff_usage 
```

这是外壳脚本：

```
#!/bin/bash

CPU=(`cat /proc/stat | grep '^cpu '`) # Get the total CPU statistics.
unset CPU[0]                          # Discard the "cpu" prefix.
IDLE=${CPU[4]}                        # Get the idle CPU time.

# Calculate the total CPU time.
TOTAL=0
for VALUE in "${CPU[@]}"; do
  let "TOTAL=$TOTAL+$VALUE"
done

# Remember the total and idle CPU times for the next check.
PREV_TOTAL="$TOTAL"
PREV_IDLE="$IDLE"

# Wait before checking again.
sleep 0.5

CPU=(`cat /proc/stat | grep '^cpu '`) # Get the total CPU statistics.
unset CPU[0]                          # Discard the "cpu" prefix.
IDLE=${CPU[4]}                        # Get the idle CPU time.

# Calculate the total CPU time.
TOTAL=0
for VALUE in "${CPU[@]}"; do
  let "TOTAL=$TOTAL+$VALUE"
done

# Calculate the CPU usage since we last checked.
let "DIFF_IDLE=$IDLE-$PREV_IDLE"
let "DIFF_TOTAL=$TOTAL-$PREV_TOTAL"
let "DIFF_USAGE=(1000*($DIFF_TOTAL-$DIFF_IDLE)/$DIFF_TOTAL+5)/10"

echo -en "\rCPU: $DIFF_USAGE%  \b\b" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T17:11:35.110

ProGNOMmers 已经指出了您的索引错误，但我想指出，像您所做的那样翻译成 ruby​​ 几乎没有任何好处。您的 ruby​​ 代码读起来和 bash 一样难看，但您仍然要花两次钱来获取`/proc/stat`. 通过使用 ruby​​ 作为高级语言，您可以使其更具可读性、更不容易出错且更高效。

这是一个示例重写。我做了一个小方法，将 /proc/stat 行转换为具有有意义名称的结构，因此不会出现更多的数组索引问题，并且始终清楚您引用的是哪个计时器值。我已经使用[`File::readlines`](http://www.ruby-doc.org/core-2.0/IO.html#method-c-readlines)并[`Enumerable#grep`](http://ruby-doc.org/core-2.0/Enumerable.html#method-i-grep)读取了 proc 文件系统，而无需掏空。我使用 printf 格式来获得您似乎正在寻找的百分位舍入效果。

```
#!/usr/bin/env ruby

# http://man7.org/linux/man-pages/man5/proc.5.html
CpuTimes = Struct.new :user, :nice, :system, :idle, :iowait, :irq,
                      :softirq, :steal, :guest, :guest_nice, :total

def get_cpu_times
  parts = File.readlines('/proc/stat').grep(/^cpu /).first.split
  times = parts[1..-1].map(&:to_i)
  CpuTimes[ *times ].tap { |r| r[:total] = times.reduce(:+) }
end

c0 = get_cpu_times
sleep 0.5
c1 = get_cpu_times

idle  = c1.idle - c0.idle
total = c1.total - c0.total
usage = total - idle
printf "CPU: %.1f%%", 100.0 * usage / total 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-11T16:16:09.127

问题是在 bash 中取消设置数组值会产生奇怪的效果：

```
CPU=(`cat /proc/stat | grep '^cpu '`) # Get the total CPU statistics.

let COUNT=0
while [ $COUNT -lt "${#CPU[@]}" ]; do
  echo "value at $COUNT: ${CPU[$COUNT]}"
  let "COUNT=$COUNT+1"
done

unset CPU[0]                          # Discard the "cpu" prefix.

let COUNT=0
while [ $COUNT -lt "${#CPU[@]}" ]; do
  echo "value at $COUNT: ${CPU[$COUNT]}"
  let "COUNT=$COUNT+1"
done 
```

这输出：

```
value at 0: cpu
value at 1: 763993
value at 2: 116443
value at 3: 179513
value at 4: 22344343
value at 5: 536446
value at 6: 5
value at 7: 640
value at 8: 0
value at 9: 0
value at 10: 0
value at 0:          # This should be 763993
value at 1: 763993   # and so on...
value at 2: 116443
value at 3: 179513
value at 4: 22344343
value at 5: 536446
value at 6: 5
value at 7: 640
value at 8: 0
value at 9: 0        # ...and the last 0 value is vanished! 
```

无论如何，解决方案是减少 ruby​​ idle_time 索引：

```
...
idle_time0 = result[3].to_i
...
idle_time = result[3].to_i
... 
```

# windows - WiX：将值设置为多个属性的组合

> ID：15952834
> 
> 赞同：0
> 
> 时间：2013-04-11T15:28:27.177
> 
> 标签：windows, installation, wix

是否有可能，如果可以，我如何从 WiX 安装项目中的多个属性创建单个值？

具体来说，我有一些这样的对话框......

```
<Dialog Id="ConnectionStringDlg" Width="370"
         Height="270" Title="Database Settings - [ProductName]" NoMinimize="yes">
    <!-- Connection String -->
    <Control Id="TitleLabel" Type="Text" X="45" Y="60" Width="100" Height="15" TabSkip="yes" Text="Connection String" />
    <Control Id="DSLabel" Type="Text" X="45" Y="77"
      Width="100" Height="15" TabSkip="no" Text="&amp;Data Source: " />
    <Control Id="DSEdit" Type="Edit" X="45" Y="92"
      Width="220" Height="18" Property="CONNECTION_STRING_DS" Text="{200}" />
    <Control Id="ICLabel" Type="Text" X="45" Y="107"
      Width="100" Height="15" TabSkip="no" Text="&amp;Initial Catalog: " />
    <Control Id="ICEdit" Type="Edit" X="45" Y="122"
      Width="220" Height="18" Property="CONNECTION_STRING_IC" Text="{200}" />
    <Control Id="UIDLabel" Type="Text" X="45" Y="137"
      Width="100" Height="15" TabSkip="no" Text="&amp;User ID: " />
    <Control Id="UIDEdit" Type="Edit" X="45" Y="152"
      Width="220" Height="18" Property="CONNECTION_STRING_UI" Text="{200}" />
    <Control Id="PassLabel" Type="Text" X="45" Y="167"
      Width="100" Height="15" TabSkip="no" Text="&amp;Password: " />
    <Control Id="PassEdit" Type="Edit" X="45" Y="182" Password="yes"
      Width="220" Height="18" Property="CONNECTION_STRING_PASS" Text="{200}" />
    <!-- Back button -->
    <!--<Control Id="Back" Type="PushButton" X="180" Y="243"
             Width="56" Height="17" Text="&amp;Back">
      <Publish Event="NewDialog" Value="PoolSettingsDlg">1</Publish>
    </Control>-->
    <Control Id="Next" Type="PushButton" X="236" Y="243"
           Width="56" Height="17" Default="yes" Text="&amp;Next">
      <Publish Event="NewDialog" Value="CustomizeDlg">
        <!--if settings are correct, allow next dialog-->
        <![CDATA[CONNECTION_STRING <> ""]]>
      </Publish>
    </Control>
    <Control Id="Cancel" Type="PushButton" X="304" Y="243"
      Width="56" Height="17" Cancel="yes" Text="Cancel">
      <Publish Event="SpawnDialog" Value="CancelDlg">1</Publish>
    </Control>
    <Control Id="BannerBitmap" Type="Bitmap" X="0" Y="0"
      Width="370" Height="44" TabSkip="no" Text="WixUI_Bmp_Banner" />
    <Control Id="Description" Type="Text" X="25" Y="23"
           Width="280" Height="15" Transparent="yes" NoPrefix="yes">
      <Text>Please enter database configuration</Text>
    </Control>
    <Control Id="BottomLine" Type="Line" X="0" Y="234" Width="370" Height="0" />
    <Control Id="Title" Type="Text" X="15" Y="6"
            Width="200" Height="15" Transparent="yes" NoPrefix="yes">
      <Text>{\WixUI_Font_Title}Database Settings</Text>
    </Control>
    <Control Id="BannerLine" Type="Line" X="0" Y="44" Width="370" Height="0" />
  </Dialog> 
```

我用它以用户友好的方式从最终用户那里获取连接字符串信息。然后，我在安装时使用...在 web.config 文件中设置此值...

```
<Component Id="cmp623DDF82F0F7645ADAAF0E7573713162" Guid="{8CFDC325-BC71-4A2F-AB22-68B0AE56C98B}">
                <File Id="fil5B0B918C0DAF7B2ECC5EB9C7CC0B9FFC" KeyPath="yes" Source="Publish\Web.config" />
              <util:XmlFile Id="ModifyConnectionString"
                  Action="setValue"
                  Permanent="yes"
                  ElementPath="//configuration/connectionStrings/add[\[]@name='RawConnection'[\]]"
                  Name="connectionString"
                  File="[#fil5B0B918C0DAF7B2ECC5EB9C7CC0B9FFC]"
                  Value="[CONNECTION_STRING]"
                  SelectionLanguage="XSLPattern"
                  Sequence="1"/>
            </Component> 
```

我的问题是，如何通过从对话框中设置的多个属性进行组合来设置连接字符串值？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T16:50:21.333

您可以为此使用[MSI 社区扩展](http://code.dblock.org/msi-community-extensions-deploying-databases)，因为它为您提供了一个很好的界面，并会为您格式化字符串。

但是，如果您想手动构建它，您可以在`Value`属性中构建字符串：

```
<util:XmlFile Id="ModifyConnectionString"
              Action="setValue"
              Permanent="yes"
              ElementPath="//configuration/connectionStrings/add[\[]@name='RawConnection'[\]]"
              Name="connectionString"
              File="[#fil5B0B918C0DAF7B2ECC5EB9C7CC0B9FFC]"
              Value='Server=[CONNECTION_STRING_DS];Database=[CONNECTION_STRING_IC];User Id=[CONNECTION_STRING_UI];Password=[CONNECTION_STRING_PASS];'
              SelectionLanguage="XSLPattern"
              Sequence="1"/> 
```

或者，如果您需要设置一个属性以在多个地方使用，您可以使用 CustomAction 或 SetProperty 元素（它们都做同样的事情）：

```
<CustomAction Id='SetConnectionString'
              Property='CONNECTION_STRING'
              Before='ExecXmlFile'
              Value='Server=[CONNECTION_STRING_DS];Database=[CONNECTION_STRING_IC];User Id=[CONNECTION_STRING_UI];Password=[CONNECTION_STRING_PASS];' />

<SetProperty Id='CONNECTION_STRING'
             Before='ExecXmlFile'
             Value='Server=[CONNECTION_STRING_DS];Database=[CONNECTION_STRING_IC];User Id=[CONNECTION_STRING_UI];Password=[CONNECTION_STRING_PASS];' /> 
```

# xml - 是否可以在 XSLT 中将整个源 XML 作为 CDTA 获取？

> ID：15952835
> 
> 赞同：1
> 
> 时间：2013-04-11T15:28:26.990
> 
> 标签：xml, xslt

我想在 XSLT 中得到这个。这可能吗？

源 XML

```
<Parent>
   <Child></Child>
   <Child></Child>
   <Child></Child>
   <Child></Child>
</Parent> 
```

输出 XML

```
<Issue>
  <Node1>Something happening here</Node1>
   <Node2>Something happening here</Node2>
<Node3><![CDATA[
<Parent>
       <Child></Child>
       <Child></Child>
       <Child></Child>
       <Child></Child>
    </Parent>
]]>
</Issue> 
```

我希望整个输入 xml 作为 CDATA`<Node3>`

这可能吗？

我的 XSLT 如下所示（片段）

```
 <xsl:template match="/">

      <xsl:call-template name="Issue"/>
    </xsl:template>

    <xsl:template name="Issue">
      <xsl:call-template name="Node1"/> 
      <xsl:call-template name="Node2"/> 
      <xsl:call-template name="Node3"/> 
    </xsl:template>
    ....
   <xsl:template name="Node3">
   <!-- Here as CDATA i want the input xml content-->
    </xsl:template> 
```

谁能帮我解决这个问题？我正在使用 XSLT 1.0

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T15:43:36.007

在 XSLT 1.0 中，您可以尝试这种肮脏的技术（不保证有效）：

```
<xsl:template name="Node3">
  <Node3>
    <xsl:text disable-output-escaping="yes">&lt;![CDATA[</xsl:text>
    <xsl:copy-of select="/" />
    <xsl:text>]]></xsl:text>
  </Node3>
</xsl:template> 
```

我说“脏”是因为`disable-output-escaping`通常意味着您正在尝试使用锤子来驱动螺钉；即，您使用工具的目的不是为了服务。它不能保证工作，特别是如果 XSLT 处理器无法控制序列化。

您也许可以避免这种肮脏的技术。我首先要问，**为什么**输出 XML 应该在 CDATA 部分中？几乎可以肯定 CDATA 要求背后有不同的要求（否则 CDATA 要求是任意的）。

也许真正的要求是您希望输入 XML 在输出中进行转义，以便任何 XML 解析器接下来读取它都会将其作为文本读取，而不是将其解析为树？

归功于：[https ://stackoverflow.com/a/1364884/423105](https://stackoverflow.com/a/1364884/423105)

# apache - nginx - 如何为每个托管网站进行服务器范围的配置

> ID：15952838
> 
> 赞同：1
> 
> 时间：2013-04-11T15:28:37.933
> 
> 标签：apache, nginx, webserver

对于我使用 nginx 托管的每个网站，我都有一个不同的文件，其中包含 server {} 块`/etc/nginx/conf.d/`

例如...
`/etc/nginx/conf.d/website1.co.uk`
`/etc/nginx/conf.d/website2.org`
`/etc/nginx/conf.d/website3.com`

我发现自己在每个 server {} 块中重复相同的代码，并且想知道是否可以制作一个“catch all” server {} 块来容纳可重用代码。

这个新的“包罗万象”文件将包括诸如...

```
# Redirect all www. attempts to non-www.
server {
  server_name www.$anything; hmm?
  return 301 $scheme://$hostname$request_uri;
}

server {
  server_name _; hmm?

  # Add expires to static files
  location ~* \.(?:ico|css|js|gif|jpe?g|png|bmp)$ {
    expires max;
    access_log off;
  }

  # Pass PHP files to PHP
  location ~ \.php$ {
    try_files $uri =404;
    fastcgi_split_path_info ^(.+\.php)(/.+)$;
    fastcgi_pass unix:/var/run/php5-fpm.sock;
    fastcgi_index index.php;
    include fastcgi_params;
  }

} 
```

有没有人这样做过？
我们是否必须为我们托管的每个网站重复这些类型的通用代码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T17:44:57.120

你只需要`include`. 将所有样板文件放在单独的文件中，没有服务器块。`include fastcgi_params`示例配置中提到的就是一个很好的例子。如果没有前导斜杠，nginx 将在主配置文件所在的目录中查找。所以：

```
include fastcgi_params;
include /etc/nginx/fastcgi_params; 
```

是等价的，如果 nginx.conf 在`/etc/nginx`.

# aspectj - AspectJ：如何选择给定类的子类的非注释方法的执行？

> ID：15952839
> 
> 赞同：3
> 
> 时间：2013-04-11T15:28:39.070
> 
> 标签：aspectj, java, aop

我想拦截给定类的任何子类的非注释方法的执行。

例如，假设我有课`Base`：

```
public class Base {
   public void baseMethod() { //shouldn't be intercepted
      // do whatever...
   }
} 
```

并且，最终，有人扩展了`Base`. 不管新的类名是什么，它的带有一些注解的方法`@LeaveItAlone`都不应该被截取。子类的所有其他方法都应该。

```
public class Sub extends Base {
   public void interceptedMethod1() {
      // ...
   }

   public void interceptedMethod2() {
      // ...
   }

   @LeaveItAlone
   public void NOTinterceptedMethod1() {
      // ...
   }

   @LeaveItAlone
   public void NOTinterceptedMethod2() {
      // ...
   } 
```

我想像：

```
pointcut sub_nonannotated() : !execution(@LeaveItAlone * Base+.*(..)); 
```

但我确定以上是错误的。

附带问题：如何专门拦截子类的构造函数？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-11T16:38:03.843

实际上，我只是尝试过，您显然几乎正确。这对我有用：

```
package com.snaphop.ats.util;

public aspect Blah {
    pointcut sub_nonannotated() : !execution(@LeaveItAlone * Base+.*(..));

    pointcut sub() : execution(* Base+.*(..));

    pointcut notBase() : ! execution(* Base.*(..));

    pointcut cons() : execution(public Base+.new(..)) && ! execution(public Base.new(..));

    //advice sub class methods but not annotation or parent
    Object around() : sub_nonannotated() && sub() && notBase() {
        return proceed();
    }

    //Advice subclass constructors but not Base's constructor
    Object around() : cons() {
        return proceed();
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-12-03T22:56:03.647

Adam Gent 的解决方案太复杂了。这个切入点更简单明了：

```
execution(!@LeaveItAlone * Base+.*(..)) 
```

或者，也许您更喜欢它（口味问题）：

```
execution(* Base+.*(..)) && !@annotation(LeaveItAlone) 
```

PS：这只涉及方法，而不是构造函数，这是您在第一句话中要求的。我还包括`Base`其自身的方法，而不仅仅是子类，这可能是有道理的。如果您想要更复杂的东西，您仍然可以将我的解决方案与亚当的元素结合起来。

# android - 复选框不能动态创建

> ID：15952845
> 
> 赞同：-3
> 
> 时间：2013-04-11T15:28:46.923
> 
> 标签：android, android-checkbox

有谁能够帮我？复选框不能动态创建。就像有时我使用程序创建 6 个复选框一样。有时我会创建 8 个复选框。我想为每个复选框设置一个事件以捕捉它被选中的时间。通过以下方式，我得到一个错误：不能引用在不同方法中定义的内部类中的非最终变量 i。更改“i”的修饰符“到最后。是`mCheckTime`一个长数组。

```
 for(int i=0;i<optionsNum;i++){
            mCheckBox[i]=new CheckBox(this);
            mCheckBox[i].setOnCheckedChangeListener(new CheckBox.OnCheckedChangeListener(){
                public void onCheckedChanged(CompoundButton buttonView, boolean isCheck){
                    if (mCheckBox[i].isChecked()) {
                        mCheckTime[i] = System.currentTimeMillis();
                    }
                }
            }; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T15:43:01.263

如果您的内容视图是 LinearLayout，请尝试

```
final CheckBox mCheckBox = new CheckBox(this);
    mCheckBox
            .setOnCheckedChangeListener(new CheckBox.OnCheckedChangeListener() {
                public void onCheckedChanged(CompoundButton buttonView,
                        boolean isCheck) {
                    if (mCheckBox.isChecked()) {
                        mCheckBox.setText(System.currentTimeMillis() + "");
                    }
                }
            });
    LayoutParams params = new LinearLayout.LayoutParams(
            LinearLayout.LayoutParams.WRAP_CONTENT,
            LinearLayout.LayoutParams.WRAP_CONTENT);
    addContentView(mCheckBox, params); 
```

**======编辑======**

或试试这个

```
LinearLayout layout = new LinearLayout(this);
    layout.setOrientation(LinearLayout.VERTICAL);
    setContentView(layout);
    CheckBox[] mCheckBox = new CheckBox[6];
    for (int i = 0; i < 6; i++) {
        mCheckBox[i] = new CheckBox(this);
        mCheckBox[i].setText(i + "");
        mCheckBox[i]
                .setOnCheckedChangeListener(new CheckBox.OnCheckedChangeListener() {
                    public void onCheckedChanged(CompoundButton buttonView,
                            boolean isCheck) {
                        if (isCheck) {
                            Toast.makeText(MainActivity.this,
                                    System.currentTimeMillis() + "",
                                    Toast.LENGTH_SHORT).show();
                        }
                    }
                });
        layout.addView(mCheckBox[i]);
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T09:32:05.383

非常感谢。我使用最终变量 j 来替换内部类中的 i 。

```
for(int i=0;i<optionsNum;i++){
        final int j = i;
        mCheckBox[i]=new CheckBox(this);
        mCheckBox[i].setOnCheckedChangeListener(new CheckBox.OnCheckedChangeListener(){
            public void onCheckedChanged(CompoundButton buttonView, boolean isCheck){
                if (mCheckBox[i].isChecked()) {
                    mCheckTime[i] = System.currentTimeMillis();
                }
            }
        }; 
```

# distributed - Paxos 选票号码复用

> ID：15952846
> 
> 赞同：1
> 
> 时间：2013-04-11T15:28:50.943
> 
> 标签：distributed, paxos

在收到来自提议者的准备消息后，接受者会以承诺或拒绝进行响应。

如果提议者没有收到足够的承诺和超时，提议者应该丢弃收到的承诺/拒绝，并以更大的选票开始新的准备轮次。

如果重启只是因为超时而不是收到拒绝，我们可以重复使用相同的选票号码吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-12T17:28:22.170

简短的回答：**不要这样做**。

在发现 Paxos Lampor 时，假设消息可以被丢弃或复制。所以在任何时候你都可以再次发送相同的消息，算法会处理它。因此，从技术上讲，只要有效负载完全相同，您就可以重复使用相同的选票号码。以下是一些你不应该这样做的即兴理由。

首先，该算法要求使用更高的选票号码。如果要更改这样的分布式算法，您必须*真正知道自己在做什么。*关于分布式系统的推理可能非常非常困难。即使你确实知道自己在做什么，你也有办法知道追随你的维护者是否知道*他们*在做什么。

其次，基本算法实际上没有任何关于拒绝/nack 的内容；它们只是优化。（请记住，它们可能随时被丢弃。）因此，*没有*收到准备应被视为拒绝。

第三，可能还有另一个提议者。如果您决定重新使用相同的选票号码，您实际上是在放弃并让另一个人获胜。但是如果其他提议者使用相同的算法点缀，它也正在放弃。您实际上是在事先选择领导者。

第四，没有收到法定人数的响应意味着您的系统有问题：网络分区；一半的主机响应不够快。这些都是需要考虑的重要事项。发送完全相同的消息将如何解决问题？

最后，重复使用选票号码不会给你带来任何好处，但它确实会使事情复杂化。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-20T03:38:09.443

您之前的提议很可能没有被接受，因为与其他副本提出的提议相比，它的投票数较小。因此，如果您在下一个提案中坚持旧的选票号码，您将很有可能再次被拒绝。

# xcode4.3 - 在 Xcode 上运行 Fortran

> ID：15952848
> 
> 赞同：0
> 
> 时间：2013-04-11T15:28:55.160
> 
> 标签：xcode4.3, fortran90

我正在尝试使用 64 位编译器在 Xcode 4.3 上运行示例 Fortran 代码，但它不会正确构建。主要问题是，尽管我尽了最大努力，但我无法让单独的 .f90 文件相互交互，因此代码如下

> 仅使用 ElementModule：ElementType

不管用。有人对如何让单独的 .f90 文件相互读取有任何答案吗？我知道您必须包含特定模块，但我的搜索并没有给我任何关于这些特定模块是什么的直接答案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T21:10:40.857

通常当 F90 代码编译时，它会生成 2 个文件：一个目标文件和一个 mod 文件。在编译后续模块时，mod 文件用于 USE 语句。

如果你有循环依赖，那么你必须构建两次或更多次。如果可以避免，最好避免循环依赖。

mod文件通常由告诉编译器包含文件在哪里的相同指令拾取。

# c# - 为什么会抛出异常

> ID：15952866
> 
> 赞同：1
> 
> 时间：2013-04-11T15:29:38.990
> 
> 标签：c#, rhino-mocks

考试：

```
[TestMethod]
public void TestStringWithValidAndInvalid()
{
    MockRepository mocks = new MockRepository();
    ICentipedeCore mockCore = mocks.DynamicMock<ICentipedeCore>();
    IPythonEngine pythonEngine = mocks.StrictMock<IPythonEngine>();
    IPythonByteCode mockPythonByteCode = mocks.Stub<IPythonByteCode>();

    mockCore.Stub(c => c.PythonEngine)
            .Return(pythonEngine);

    pythonEngine.Expect(e => e.Compile(Arg<String>.Is.Equal("\"String\""),
                                       Arg<PythonByteCode.SourceCodeType>.Is.Anything))
                .Return(mockPythonByteCode);

    pythonEngine.Expect(e => e.Evaluate(Arg<IPythonByteCode>.Is.Equal(mockPythonByteCode),
                                        Arg<PythonScope>.Is.Anything))
                .Return(3);

    pythonEngine.Expect(e => e.Compile(Arg<String>.Is.Equal("this is invalid python"),
                                       Arg<PythonByteCode.SourceCodeType>.Is.Anything))
                .Throw(new PythonParseException(mocks.Stub<Exception>()));

    ActionWrapper testAction = new ActionWrapper(mockCore);

    var original = @"{1+2} with {invalid python}";
    var expected = "3 with {invalid python}";
    var result = testAction.ParseStringForVariable(original); // ActionTest.cs: line 267

    mocks.VerifyAll();
    Assert.AreEqual(expected, result);
} 
```

被测方法（由包装器公开）：

```
protected String ParseStringForVariable([NotNull] String str)
{
    IPythonEngine pythonEngine = GetCurrentCore().PythonEngine;

    for (int i = 0; i < str.Length; i++)
    {
        if (str[i] != '{')
        {
            continue;
        }

        int opening = i;
        foreach (var expression in from closing in str.IndexesWhere('}'.Equals)
                                   where closing > opening
                                   select new
                                          {
                                              Template = str.Substring(opening, closing - opening + 1),
                                              Code = str.Substring(opening + 1, closing - opening - 1)
                                          })
        {
            IPythonByteCode compiled;
            try
            {
                compiled = pythonEngine.Compile(expression.Code, PythonByteCode.SourceCodeType.Expression);
            }
            catch (PythonParseException)
            {
                // not valid python, try next expression
                continue;
            }
            dynamic r = pythonEngine.Evaluate(compiled);
            String result = r.ToString(); //  Action.cs: line 217, wrapped at  ActionTest.cs: line 96
            str = str.Replace(expression.Template, result);
            break;
        }
    }

    return str;
} 
```

例外：

> Microsoft.CSharp.RuntimeBinder.RuntimeBinderException：无法对空引用执行运行时绑定

异常在为null之后`dynamic r = pythonEngine.Evaluate(compiled);`被`r`抛出。但我不知道为什么 -`compiled`与 mockPythonByteCode 具有相同的值，pythonEngine 是在测试中创建的模拟，并且相同的调用在不同的方法中工作。这里唯一的区别是，`pythonEngine.Compile`有两个期望，在不同的输入上，有不同的结果。

问题是，我有`TestStringWithValidCode()`and `TestStringWithInvalidCode()`，两者都工作正常，我合并为 form `TestStringWithValidAndInvalid()`，所以每一半**都应该**工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-07-25T01:18:34.593

对 null 的检查会更加谨慎，因为由于代码的结构，当 a`catch`发生并且`compiled`为 null 时，它会运行*恰好*期望`compiled`不会为 null 的代码。

所以

改变：

```
 catch (PythonParseException)
        {
            // not valid python, try next expression
            continue;
        }
        dynamic r = pythonEngine.Evaluate(compiled); 
```

到

```
 catch (PythonParseException)
        {
            // not valid python, try next expression
            continue;
        }
       if (compiled != null)
       {
        dynamic r = pythonEngine.Evaluate(compiled);
        String result = r.ToString(); //  Action.cs: line 217, wrapped at  ActionTest.cs: line 96
        str = str.Replace(expression.Template, result);
       }
       else
       {
           str="Exception Caught";
       }
       break; 
```

# php - PHP 如果值，那么其他电子邮件？

> ID：15952876
> 
> 赞同：1
> 
> 时间：2013-04-11T15:30:16.543
> 
> 标签：php, email, if-statement, header, carbon-copy

我的活动页面有一个 PHP 表单。现在它可以完美地通过电子邮件发送给自己，我可以毫无问题地将它抄送给我喜欢的任何人。但是，如果从我的表单上的下拉框中选择了某个事件，我只想将其发送给特定的人，并将其抄送给我。这样，举办活动的组织就可以收到一份完整表格的副本。如果可能的话，我还想向收件人发送自定义消息。例如：

如果填写表格的人选择了“Heart Walk”活动，那么表格结果应通过“bob@email.com”发送给“Bob”，并附上一条消息：“嗨，Bob，您收到了一位新志愿者为您的 Heart Walk 活动。以下是注册副本。”

当然，我会得到一份副本。

我可以为 $sendtoemail 命令执行 if/then 语句或数组吗？然后通过输入以下内容将其复制给我：

```
$headers .= "Cc: me@myemail.com\r\n"; 
```

最好的方法是什么？谢谢你的帮助！:)

**编辑 ：**

这是我的代码：

```
<?php
if (get_magic_quotes_gpc()) {
function stripslashes_deep($value)
{
    $value = is_array($value) ?
                array_map('stripslashes_deep', $value) :
                stripslashes($value);

    return $value;
}

$_POST = array_map('stripslashes_deep', $_POST);
$_GET = array_map('stripslashes_deep', $_GET);
$_COOKIE = array_map('stripslashes_deep', $_COOKIE);
$_REQUEST = array_map('stripslashes_deep', $_REQUEST);
}

//send an email from the server TO YOUR EMAIL
$fromname = $_REQUEST['firstname'];
$fromemail = $_REQUEST['email'];
$subject = "NMVN EVENT REGISTRATION";

$message = " <b>EVENT:</b> ".$_REQUEST['pickevent'];
$message .= " <br><br> <b>First Name:</b> ".$_REQUEST['firstname'];
$message .= " <br> <b>Last Name:</b> ".$_REQUEST['lastname'];
$message .= " <br> <b>Cell Phone:</b> ".$_REQUEST['cellphone'];
$message .= " <br> <b>Alternative Phone:</b> ".$_REQUEST['altphone'];

//This is the person who is going to receive the email
$sendtoname = "Mike Gandy";
$sendtoemail = "me@myemail.com";

//Email header stuff
$headers = "MIME-Version: 1.0\r\n";
$headers .= "Content-type: text/html; charset=iso-8859-1\r\n";
$headers .= "From: $fromname <$fromemail>\r\n";
$headers .= "To: $sendtoname <$sendtoemail>\r\n";
$headers .= "Reply-To: $fromname <$fromemail>\r\n";
$headers .= "X-Priority: 3\r\n";
$headers .= "X-MSMail-Priority: Normal\r\n";
$headers .= "X-Mailer: Created by Mike Gandy";

//this next line creates and sends the email
mail($sendtoemail, $subject, $message, $headers);

?> 
```

我正在考虑替换这个：

```
$sendtoname = "Mike Gandy";
$sendtoemail = "me@myemail.com"; 
```

有了这个：

```
if ($_REQUEST['pickevent'] == 'HeartWalk'))
//if "HeartWalk" is filled out, send to email
  {
  //send email
  $sendtoname = "Bob";
  $sendtoemail = "bob@email.com";
  }
elseif ($_REQUEST['pickevent'] == 'RaceCure'))
//if "RaceCure" is filled out, send to email
  {
  //send email
  $sendtoname = "Susan";
  $sendtoemail = "susan@email.com";
  }  
elseif ($_REQUEST['pickevent'] == 'Bowling'))
//if "Bowling" is filled out, send to email
  {
  //send email
  $sendtoname = "John";
  $sendtoemail = "john@email.com";
  } 
```

但另外我需要要求选择一个事件，所以“其他”将是一个弹出窗口，上面写着“选择一个事件！”。这有帮助吗？

**最后编辑：**

好的，所以我得到了验证。谢谢你。我正在替换这个：

```
$sendtoname = "Mike Gandy";
$sendtoemail = "me@myemail.com"; 
```

有了这个：

```
switch(strtolower($event){
    case 'HeartWalk':
        $sendtoname('Bob')
        $sendtoemail('bob@email.com');
        break;
    case 'RaceCure':
        $sendtoname('Susan')
        $sendtoemail('susan@email.com');
        break;
    case 'Bowling':
        $sendtoname('John')
        $sendtoemail('john@email.com');
        break;
} 
```

添加这个：

```
$headers .= "Cc: somebody@domain.com" . "\r\n"; 
```

并将我的消息的开头更改为：

```
$message = "Dear $sendtoname, <br><br>A new volunteer has registered for your "$_REQUEST['pickevent'];
$message .= " event. Below is a copy of their registration: ".$_REQUEST['blank'];
$message .= " <br><br> <b>First Name:</b> ".$_REQUEST['firstname']; 
```

并将其包含在我的表格中：

```
<input type="hidden" name="blank" value=""> 
```

是的？不？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T15:40:46.953

1.  使用`select`HTML 标签创建下拉菜单：

    ```
    <select name="event">
    <option value="heartwalk">Heart Walk</option>
    <option value="other">Other</option>
    </select> 
    ```

2.  处理帖子时，请使用`$_REQUEST["event"]`for 决策，例如：

    ```
    switch ($_REQUEST["event"])
    {
    case 'heartwalk':
        $sendtoemail = "heartwalk@example.com";
        break;
    default:
        $sendtoemail = "other@example.com";
        break;
    } 
    ```

3.  对于验证，您可以在提交表单时从客户端的 JavaScript 验证开始。例如参考： [https ://www.tutorialspoint.com/javascript/javascript_form_validations.htm](https://www.tutorialspoint.com/javascript/javascript_form_validations.htm)

当然，也建议在服务器端进行一些验证。根据您希望系统的健壮程度，您可以从不做任何事情开始将浏览器重定向回表单并在页面上显示消息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-11T15:37:59.613

你可以试试switch语句。

```
switch(strtolower($event){
    case 'heart walk':
        $sendtoemail('bob@email.com');
        break;
    case 'some other walk':
        $sendtoemail('theotherguy@email.com');
        break;
    default:
        $sendtoemail('info@email.com');
        break;
} 
```

# internet-explorer - 与适用于 Windows 7 的 IE 10 的兼容性

> ID：15952878
> 
> 赞同：0
> 
> 时间：2013-04-11T15:30:23.643
> 
> 标签：internet-explorer, cross-browser

我是 IE 兼容性的新手。我最近接到了我公司的一个项目，需要解决昨天刚刚开始的问题。Microsoft 为 Windows 7 创建了 IE10，出于某种原因，兼容性视图现在不再在我们的页面上运行。在 IE 9 和 IE10 for Window 8 中，兼容性很好。

当前有问题的页面正在引用此 DOCTYPE

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"> 
```

我知道这不是最好的 DOCTYPE，因为它甚至没有使用严格的标准，但是现在将其更改为严格会导致页面显示不正确。我正在重新编码整个页面，以使其与当前版本的 IE 更好地兼容，并最终与其他浏览器兼容。

请注意，该页面由coldfusion、Javascript、HTML 组成，并且是一个表单。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T15:36:44.477

我不熟悉 Cold Fusion，但您可以通过确保您的响应标头包含以下内容来告诉 IE 使用渲染模式：

```
X-UA-Compatible: IE=8 
```

上面告诉 IE 使用 IE8 模式进行渲染。

或者，您可以根据[指定遗留文档模式](http://msdn.microsoft.com/en-us/library/jj676915%28v=vs.85%29.aspx)使用元标记指定上述信息：

```
<html>
<head>
  <!-- Use Internet Explorer 9 Standards mode -->
  <meta http-equiv="x-ua-compatible" content="IE=9">
  <title>My webpage</title>
</head> 
```

# javascript - JQuery .change - 获取事件源

> ID：15952881
> 
> 赞同：1
> 
> 时间：2013-04-11T15:30:28.513
> 
> 标签：javascript, jquery

我在 HTML 表单上有许多元素，类似于以下内容：

```
<div class="area">
    First Area
    <select class="area_select" name="area_25" id="form_area_25">
        <option value="0" selected="selected">No</option>
        <option value="1" >Don't Mind</option>
        <option value="2" >Yes</option>
    </select>
</div>

<div class="area">
    Second Area
    <select class="area_select" name="area_13" id="form_area_13">
        <option value="0" selected="selected">No</option>
        <option value="1" >Don't Mind</option>
        <option value="2" >Yes</option>
    </select>
</div>
    .... and many more 
```

它们都有一个 area_select 类和 form_area_id 的 id，其中 id 是唯一的整数。

我正在尝试使用 jQuery 为用户更改选择框时编写事件处理程序。

到目前为止，我设法做到的是：

```
$(".area_select").change(function() {
  alert('select changed, but no idea which one');
}); 
```

有没有办法让事件处理程序确切地知道哪个选择是事件的来源？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T15:32:02.653

`this`在 even 中是指触发事件的控件：

```
$('.area_select').change(function(){
  // this = the control
}); 
```

这就是你的目的吗？或者您可以`e`在回调中接受并查看`e.target`.

```
$('.area_select').change(function(e){
  // e.target = the control (unless bubbling occurred)
}); 
```

[event.target](http://api.jquery.com/event.target/)上的文档

如果您想获取选择的 ID（只是数字），您可以使用：

```
$(".area_select").change(function() {
    var selectid = this.id.match(/(\d+)$/)[1];
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-11T15:31:41.280

您可以使用`this`for source object 和`this.id`for source object `id`。

**[现场演示](http://jsfiddle.net/8vtKA/)**

```
$(".area_select").change(function(event) {
  alert(this.id);
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-11T15:33:39.023

您可以使用`$(this)`来获取触发事件的控件

```
$(".area_select").change(function() {
   alert($(this).attr("id") + " changed");
}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-11T15:37:05.653

`this`是源。实际上，您绑定到事件的函数是在事件发生的项目的上下文中调用的。所以很简单：

```
$(".area_select").change(function() {
  alert('select ' + $(this).attr("id") + " changed");
}); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-04-11T15:42:27.570

我认为你需要`this`：

```
$(".area_select").change(function() {
      alert('select changed: '+$(this).val()+' , but no idea which one: '
      +$(this).attr('id').replace('form_area_',''));
}); 
```

# php - 带有谷歌图表 api 的 Html2pdf：无法加载图像

> ID：15952882
> 
> 赞同：1
> 
> 时间：2013-04-11T15:30:29.353
> 
> 标签：php, google-visualization, html2pdf

我有一个在线报告工具，它使用 html2pdf 生成 pdf 和 google chart api 生成该 pdf 中使用的图表。从今天早上开始出现错误：

```
ERROR n°6
File : /public_html/beta/html2pdf/html2pdf.class.php
Line : 1319

Impossible to load the image https://chart.googleapis.com/chart?cht=pc&chs=150x90&chd=t:0|10,10,10,10,10,10&chco=FFFFFF,00ff3c|00ff3c|00ff3c|00ff3c|00ff3c|00ff3c&chl=|0|0|0|0|0|0 
```

我试图单独打开链接以检查错误，但这就像一个魅力。我尝试使用谷歌故障排除站点的 chof=validate ，这表明我的图表脚本没有问题。我没有更改我网站上可能导致任何中断的任何内容。

我已经用完了调试解决方案，期待您的回复！希望你能帮我 ：）

问候，

巴布

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-28T19:40:18.450

问题出在图像请求中...... HTML2PDF 有一个加载远程 PNG 图像的错误（可能是我怀疑的任何 PNG），请求图像为 JPG 或 GIF

在您的情况下，图表 API 支持 GIF

[https://chart.googleapis.com/chart?cht=pc&chs=150x90&chd=t:0|10,10,10,10,10,10&chco=FFFFFF,00ff3c|00ff3c|00ff3c|00ff3c|00ff3c|00ff3c&chl=|0 |0|0|0|0|0&chof=gif](https://chart.googleapis.com/chart?cht=pc&chs=150x90&chd=t:0|10,10,10,10,10,10&chco=FFFFFF,00ff3c|00ff3c|00ff3c|00ff3c|00ff3c|00ff3c&chl=|0|0|0|0|0|0&chof=gif)

问候

# javascript - loadspeed.js 计时：onload、DomContentLoaded 还是其他？

> ID：15952883
> 
> 赞同：2
> 
> 时间：2013-04-11T15:30:33.910
> 
> 标签：javascript, phantomjs, headless

loadspeed.js 时间是否正确？

因为我在 Chrome 中的 loaspeed.js 和 developerpor 工具栏之间有不同的结果。

```
var page = require('webpage').create(),
    system = require('system'),
    t, address;

page.viewportSize = { width: 1024, height: 768 };

if (system.args.length === 1) {
    console.log('Usage: loadspeed.js <some URL>');
    phantom.exit(1);
} else {
    t = Date.now();
    address = system.args[1];
    page.open(address, function (status) {
        if (status !== 'success') {
            console.log('FAIL to load the address');
        } else {
            t = Date.now() - t;
            console.log('#1 Loading time ' + t + ' msec');
            t = Date.now();
             page.open(address, function (status) {
            if (status !== 'success') {
                console.log('FAIL to load the address');
            } else {
                t = Date.now() - t;
                console.log('#2 Loading time ' + t + ' msec');  
            }
            phantom.exit();
        });
        }
    });
} 
```

运行脚本给我

```
>phantomjs.exe loadspeed.js http://www.google.com
#1 Loading time 348 msec
#2 Loading time 202 msec 
```

在私有模式下使用 Chrome 开发人员工具栏，我可以看到这一点（两次运行几乎相同） ![工具栏结果](https://i.stack.imgur.com/xavTm.png)

如您所见，我没有相同的结果（注意：每次），它最终建议 loadspeed**测量 DOMContentLoaded Event**。

该脚本中是否有任何“未配置”功能？

也许我错了，但简单地说，我怎样才能测量页面加载时间？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T20:48:17.627

在调用 page.open 之前试试这个：

```
page.onInitialized = function() {
    page.evaluate(function() {
        document.addEventListener('load', function() {
            t = Date.now() - t;
            console.log('#1 Loading time ' + t + ' msec');
        }, false);
    });
}; 
```

# firebase - Firebase JSON 安全性和数组

> ID：15952885
> 
> 赞同：7
> 
> 时间：2013-04-11T15:30:38.840
> 
> 标签：firebase, firepad

我们想在我们的（主要是非 Firebase 托管的）项目中使用 Firepad，但我们在找出解决问题的最佳方法时遇到了一些麻烦。

基本上，我们有很多用户，每个用户都可以是多个组的成员。这些“组”每个都有自己的 Firepad，用户可以对其进行编辑。我们已经有了一个使用 MySQL 的深度开发的数据库结构，现在并不想将我们的用户数据迁移到 Firebase，所以我们认为我们会更有创意。

我们不希望用户能够编辑他们不属于的组的 Firepad。因此，作为我们的身份验证令牌的一部分，我们认为我们会尝试发送用户 ID 和他们所属的组列表。然后，使用 Firebase JSON 安全系统，我们可以验证当前正在编辑的 Firepad 是否在用户所属的组列表中。

问题是，JSON 系统似乎不接受很多命令。没有 indexOf，我无法调用`hasChild`该`auth`变量。

我们如何确保用户只能编辑他们所属组的 Firepad，而不将我们所有的数据迁移到 Firebase？（或维护数据库的两份副本——一份在 MySQL 上，一份在 Firebase 上）

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-11T15:57:57.563

这里的技巧是使用对象而不是数组来存储组（我知道有点尴尬。我们将尝试使这更容易/更直观）。因此，在您的身份验证令牌中，您将存储以下内容：

```
{ userid: 'blah', groups: { 'group1': true, 'group2': true, ... } } 
```

然后在你的安全规则中，你可以有类似的东西：

```
{
    ...
    "$group": {
        ".read": "auth.groups[$group] == true",
        ".write": "auth.groups[$group] == true"
    }
} 
```

然后，仅当 <group> 在其身份验证令牌中时，用户才具有对 /groups/<group> 的读/写访问权限。

# html - 菜单 css html5 -> 可见和隐藏，屏幕大小

> ID：15952888
> 
> 赞同：0
> 
> 时间：2013-04-11T15:30:52.343
> 
> 标签：html, css, ajax

我只想在屏幕大小为 320px 时隐藏菜单......现在菜单总是隐藏的，我需要调用它们。

当屏幕大小为 320px 时，就可以了，当我需要调用#main-nav，但默认大小必须可见

```
 * {
    box-sizing: border-box;
}

html, body {
    min-height: 100%;
    font-size: 11pt;
    font-family: 'PT Sans', Arial, sans-serif;
}

.main-header {
    background: linear-gradient(#3F94BF, #246485);
    padding: 5px;
    text-align: center;
    color: white;
    text-shadow: #222 0px -1px 1px;
    position: relative;
    width: 100%;
    transition: all 0.3s ease;
}

.page-wrap {
    float: right;
    width: 100%;
    transition: width 0.3s ease;
}

nav a {
    color: #fff;
    display: block;
    text-align: center;
    text-decoration: none;
    line-height: 40px;
    text-shadow: 1px 1px 0px #283744;
}

nav a:hover, nav a:active {
    background-color: #8c99a4;
}

.main-nav {
    position: fixed;
    width: 0;
    height: 100%;
    font-weight: bold;
    background: linear-gradient(#3F94BF, #246485);
    overflow: hidden;
    transition: width 0.3s ease;
}

.content {
    overflow: hidden;
    padding: 20px 20px 20px 20px;
}

#close-menu {
    display: none;
}

#open-menu {
        display: block;
    }

#main-nav:target {
    width: 20%;
}

#main-nav:target + .page-wrap {
    width: 80%;

    .open-menu {
        display: block;
    }
    .close-menu {
        display: none;
    }
    .main-header {
        width: 80%;
        left: 20%;
    }
}

/*Styles for screen 515px and lower*/
@media only screen and (max-width: 480px) {

} 
```

html

```
<html>
    <head>
        <title>Test</title>
        <meta http-equiv="Content-Language" content="de" />
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <link rel="stylesheet" type="text/css" href="css/main.css" media="screen" />
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>

    </head>

    <body>
        <nav class="main-nav" id="main-nav">
            <a href="#details">Details</a>
            <a href="#adresses">Adresses</a>
            <a href="#kontakt">Kontakt</a>
        </nav>

        <div class="page-wrap">

            <header class="main-header">
                <a href="#main-nav" class="open-menu"> ☰&lt;/a>
                <a href="#close-menu" class="close-menu">close</a>

                <h1>VIGOUI</h1>
            </header>

            <div class="content">
                It’s all about playing four quarters. I think we played well but the other team played well too. They took advantage of certain circumstances that arose. It’s a physical game.
            </div>

        </div>
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T15:43:18.853

首先你需要媒体查询（[http://jsfiddle.net/3X8Tq/](http://jsfiddle.net/3X8Tq/)）

```
@media all and (min-width: 320px) {
    #main-nav {
    width: 20%;
}
    .page-wrap {
        width: 80%;
    }
} 
```

这适用于小窗口，但对于大屏幕，关闭按钮不起作用。这是因为关闭按钮从未起作用。它之所以有效，是因为 CSS 仅应用了 open :target。因此，让关闭按钮起作用。我们在页面上没有打开菜单或关闭菜单 ID，但您确实有它们的 CSS。

`#main-nav`请参阅指向导航的 HREF 。没有`#close-menu`身份证。让我们添加一个。

```
<div id="close-menu"></div> 
```

我们会把它放在导航之前。我们还将为`#close-menu`

```
#close-menu:target + #main-nav {
    width: 0;
}
#close-menu:target ~ .page-wrap {
    width: 100%;
    left: 0;
} 
```

解决方案：http: [//jsfiddle.net/3X8Tq/1/](http://jsfiddle.net/3X8Tq/1/)

看着你的 css，我相信你对它的工作原理有误解。您的 css 中的子类仅适用于[较少的 css](http://lesscss.org/)库。和页面`#close-menu`上`#open-menu`不存在。我建议一般阅读 :target 和 css 选择器。

# oracle - 如何为多列显示显式空值

> ID：15952889
> 
> 赞同：0
> 
> 时间：2013-04-11T15:30:57.677
> 
> 标签：oracle, null

如何为 Oracle SQL 中的多个列显示显式空值？更具体地说，我想在列包含空值时使用 SET XXXXXX OFF/ON 来显示空值，而不是对每一列都使用 NVL。提前感谢您的建议。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-11T15:38:31.797

如果您使用的是 SQL*Plus，它有一个`SET NULL`命令。例如，要将每个`NULL`值显示为星号 ( `*`)，只需执行以下操作：

```
SET NULL '*' 
```

SQL*Plus 默认设置是一个空字符串，因此要将其设置回默认设置，只需执行以下操作：

```
SET NULL '' 
```

# .net - 回发按钮刷新页面？

> ID：15952890
> 
> 赞同：0
> 
> 时间：2013-04-11T15:30:58.707
> 
> 标签：.net, events, button, click, refresh

我现在有非常简单的带有 Button 和 onclick 事件的代码。

问题是单击按钮会导致页面重新加载，并且不会触发单击事件中定义的操作。

这是我的代码：

```
<asp:CheckBoxList ID="chkContact" CssClass="panel-login" runat="server">
            </asp:CheckBoxList>
<asp:Button ID="btnUpdate" Text=" Update " CssClass="button" runat="server" /> 
```

和事件：

```
protected void Page_Init(object sender, EventArgs e)
{
    btnUpdate.Click += new EventHandler(btnUpdate_Click);
}
protected void btnUpdate_Click(object sender, EventArgs e)
{
    Response.Write("a" + chkContact.Items.Count.ToString());
} 
```

这很奇怪。我已经做过很多次了，以前从来没有遇到过按钮问题。

我在这里错过了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T16:32:36.737

页面上有任何验证控件吗？如果这些不属于特定的验证组，那么任何回发都会触发它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T09:46:49.997

我找到了导致问题的原因。我在更新按钮下方有一个链接按钮：

```
<asp:LinkButton ID="btnCancel" Text="Back / Cancel" runat="server" /> 
```

当我将 postbackurl 分配给链接按钮时，即使我单击更新按钮而不是链接按钮，它也会导致页面重新加载。

很奇怪，将 AutoPostBack="false" 添加到 Update 和 LinkBut​​ton 并没有帮助，所以我需要将 LinkBut​​ton 更改为我认为的其他内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-11T15:59:46.170

为什么不使用 onclick 事件：

```
<asp:Button ID="btnUpdate" Text=" Update " CssClass="button" runat="server" onclick="btnupdate_Click"/> 
```

# c++ - 在 Windows 的 GUI 应用程序中使用控制台，仅当它从控制台运行时

> ID：15952892
> 
> 赞同：6
> 
> 时间：2013-04-11T15:31:09.213
> 
> 标签：c++, windows, console, cout, cin

我的应用程序是一个 GUI 应用程序，它通过终端（通过 cout）提供有用的（尽管是可选的）信息。

在 Windows 中，我要么出现控制台（通过编译为控制台应用程序，或动态分配它），要么没有。

我的意图是使用控制台，如果它是从控制台运行的，但如果不是，则完全忽略控制台。（基本上是在 Linux 和 OS X 中发生的事情）。

我不希望重定向到文件（并且在使用 cin 的情况下，无论如何这不是一个可行的解决方案）。

有没有办法将 Windows 中的 GUI 应用程序附加到运行它的控制台，当且仅当它是从控制台运行的？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-04-11T17:36:51.913

> 在使用 cin 的情况下，无论如何这不是一个可行的解决方案

这是您问题中的杀手级细节。这在纸上很简单，只需首先调用 AttachConsole(ATTACH_PARENT_PROCESS) 来尝试附加到现有控制台。当您的程序从诸如资源管理器之类的 GUI 程序或桌面快捷方式启动时，这将失败。因此，如果它返回 FALSE，则调用 AllocConsole() 来创建您自己的控制台。

然而，使用*cin*是一个问题。命令处理器会注意您的 EXE 并检查它是控制台模式应用程序还是 GUI 应用程序。它会在您的情况下检测 GUI 应用程序，然后**不**等待该过程完成。它再次显示提示并等待输入。然后，您还将等待输入，但您会输，命令处理器首先到达那里。您的输出还与命令提示符混合在一起，这是很容易解决的问题。

有一个简单的解决方法，您的用户应该启动您的程序，`start /wait yourapp`告诉命令处理器等待该过程完成。问题是：没有人使用它。并且用户不会意识到当他们键入输入时会发生什么，打算将其输入您的程序，但它实际上是由命令处理器解释的。产生神秘的错误信息或格式化硬盘。

只有两种好方法可以解决这个无法解决的问题。将您的程序构建为控制台模式应用程序，并在您发现要显示 GUI 时调用 FreeConsole()。或者总是调用 AllocConsole()。这些都不是很好的选择。第一种方法是 Java JVM 在 Windows 上使用的方法。针对 JVM 提出的最古老的错误之一，使 Java 程序员完全无法从闪烁的控制台窗口中获取信息。

第三种选择是唯一不错的选择，并且您不想要的选择创建另一个始终使用控制台的 EXE。像 Java 一样，javaw.exe 与 java.exe。

一个技巧是可能的，您可以将该文件从“yourapp2.exe”重命名为“yourapp.com”。当用户在命令行提示符下键入“yourapp”时，它将首先被选中，桌面快捷方式仍然可以指向“yourapp.exe”。Visual Studio 使用了这个技巧，devenv.com vs devenv.exe。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-11T15:35:35.627

您可以在启动时检查[`CONSOLE_SCREEN_BUFFER_INFO`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms682093%28v=vs.85%29.aspx)（通过[`GetConsoleScreenBufferInfo`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms683171%28v=vs.85%29.aspx)）以确定您是否已从现有控制台中运行。如果缓冲区的位置是 0,0，那么您是从控制台外部运行的。有关详细信息，请参阅描述该过程的[Microsoft 知识库文章。](http://support.microsoft.com/kb/99115)

为了使其工作，您需要将您的应用程序编译为控制台应用程序（使用`/SUBSYSTEM:CONSOLE`），然后如果应用程序启动了一个新控制台（0,0 处的缓冲区），则将您自己与控制台分离。这将导致程序在从命令行启动时正确“附加”到调用控制台。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-13T12:00:39.437

正如其他人指出的那样，您必须创建一个控制台应用程序和一个窗口应用程序。所以，你最终会得到`console.exe`and `app.exe`。为了使其在命令行中不那么明显，您可以像[devenv](http://www.hanselman.com/blog/DevEnvcomSairamasTipOfTheDay.aspx)一样利用 PATHEXT 技巧。如果文件的扩展名在 PATHEXT 环境变量中，则 cmd.exe 将文件视为命令。COM 默认情况下存在，因此您可以将 console.exe 重命名为 app.com，从而允许该命令`app`启动附加到当前控制台的控制台应用程序。

注意：当然，如果需要，控制台应用程序可以显示 GUI。

app.com 和 app.exe 之间的构建差异取决于您的构建系统，但它可能只是设置输出类型的一个属性。使用 msbuild（对于 .vcxproj 文件），这只是另一个构建配置的问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-07-31T10:56:09.643

您可以在控制台中创建一个应用程序，使用 argc 获取一行并打印它；

```
////
int main(int argc, char *argv[])
{
    //here print argv....using cout or printf
} 
```

将文件保存为应用程序文件夹中的 console.exe。现在在您的应用程序中，如果您想在控制台中查看任何行，您可以调用命令

```
system("console.exe this is the line i want to print and see in console"); 
```

# knockout.js - 如何停止 durandal / jquery 从视图中剥离脚本标签？

> ID：15952893
> 
> 赞同：4
> 
> 时间：2013-04-11T15:31:09.270
> 
> 标签：knockout.js, requirejs, durandal

我知道有更好的模式，但在这种情况下，我们希望将一些遗留代码移到视图中。这个 html 有一个

```
<script src="binding.js"></script> 
```

需要在页面呈现和显示后运行。

我希望用`<script src="">`标签来做到这一点，但标签似乎被剥离了。

我们如何获取要渲染的脚本标签，或者使用 durandal 解决问题？

示例 html：

```
<div>
    <link rel="stylesheet" href="/Content/stylesheet1.css"/>
    <link rel="stylesheet" href="/Content/stylesheet2.css"/>
    <header>
        <h1>heading</h1>
        <h2>sub heading</h2>
    </header>

    <section>
    </section>

    <footer>              
    </footer>
    <script src="dobinding.js"></script>    
</div> 
```

这很有帮助：

```
http://knockoutjs.com/documentation/custom-bindings.html 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-11T20:38:33.407

您*可以*为此使用自定义的 KnockOut 绑定。

这是一个非常简单的绑定 - 请记住，这只是一个想法：

```
ko.bindingHandlers.script = {
    update: function (element, valueAccessor, allBindingsAccessor, viewModel, bindingContext) {
        var scriptName = ko.utils.unwrapObservable(valueAccessor());
        $(element).html("<script src='" + scriptName + "'></script>");
    }
}; 
```

在您看来（.html 文件）：

```
<div data-bind="script:'dobinding.js'"></div> 
```

我对此进行了测试，我发现脚本确实被注入、解析和执行，但它并没有在 DOM 中保持加载状态。这对你来说可能是也可能不是问题。

似乎剥离标签可能是杜兰达尔特有的事情。我还没有弄清楚原因，但如果我有机会深入研究它，我会更新。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-11T16:47:33.803

I believe that the durandal view composition engine only uses the first html element in a view and ignores everything else. So if your script tag is outside the main container in your view I think it gets dropped.

Can you post some html/js for review?

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-26T09:58:39.807

如果还没有，您可以将脚本中发生的任何事情包装在一个函数中（我们称之为 doBindings），然后将脚本与 Knockout、JQuery 等一起嵌入到您的 index.html 文件（或等效文件）中。

然后，在需要运行该代码的任何视图中，将 viewAttached 方法添加到视图模型并调用 doBindings：

```
activate: function() {
   ...
}
viewAttached: function() {
   doBindings();
} 
```

这将在加载视图并且 DOM 可访问时调用该函数。

此处的解决方案：[在 Durandal 中插入 script 标签](https://stackoverflow.com/questions/16398383)，但此处的答案会为我节省一些额外的搜索，因此也添加了此处。

# maven - 您如何调试使用 maven-invoker-plugin 执行的 Maven 插件测试？

> ID：15952900
> 
> 赞同：6
> 
> 时间：2013-04-11T15:31:27.240
> 
> 标签：maven

我想附上一些使用`maven-invoker-plugin`. 如何做到这一点？我似乎找不到任何资源，而且似乎不是简单地做：

```
MAVEN_OPTS="-Xdebug -Xnoagent -Xrunjdwp:transport=dt_socket,server=y,suspend=y,address=9001" mvn clean install 
```

我的意思是——我可以通过这种方式连接，但是当`maven-invoker-plugin`开始时，它就在那里。永远...

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-11T19:36:32.913

您必须知道 maven-invoker-plugin 调用一个单独的 Maven 实例来运行集成测试，例如使用适当的配置选项手动调用**mvn 。**这就是maven坚持的原因......

您可以将适当的选项放入*[invoker.mavenOpts](http://maven.apache.org/plugins/maven-invoker-plugin/integration-test-mojo.html#mavenOpts)*或**invoker.properties**文件中。另一种选择是更改*[mavenExecuteable](http://maven.apache.org/plugins/maven-invoker-plugin/integration-test-mojo.html#mavenExecutable)*并使用 mvnDebug 而不是 mvn。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-11T16:10:06.043

显然，（在进一步检查之后`build.log`）使用上述方式，它冻结只是因为 Maven 正在等待您第二次与远程调试器连接——这次是分叉进程。

# javascript - SCRIPT438: Object doesn't support property or method 'formatCurrency'"

> ID：15952906
> 
> 赞同：0
> 
> 时间：2013-04-11T15:31:37.550
> 
> 标签：javascript, jquery, asp.net, jquery-plugins

I am getting an "SCRIPT438: Object doesn't support property or method 'formatCurrency'"" error when trying to format the currency for cells in a jQuery datatable using the jQuery formatCurrency library.

Code: jQuery DataTable initialisation:

```
var oTable = $('#tblTest').dataTable({
"bFilter": false,
"bInfo": false,
"aoColumns": [{ "bVisible": false }, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null],
"aaSorting": [[0, 'desc', 1]],
"bScrollInfinite": true, //this property disables pagination
"sScrollY": "230px",
"sScrollX": "940px",
"fnCreatedRow": function (nRow, aData, iDataIndex) {
 RefreshGrid();
  }
});

function RefreshGrid() {
        var nRow = $('#tblTest').dataTable().fnGetNodes();
        for (var i = 0; i < nRow.length; i++) {
            var Total = (nRow[i].children[6].children[0].innerHTML * nRow[i].children[7].children[0].innerHTML).toFixed(2);
            $("input[id$='hfFormat']").val(Total);
            var unformatted = $("input[id$='hfFormat']").val();
            var formatted = $("input[id$='hfFormat']").val(unformatted).formatCurrency().val();
            nRow[i].children[8].children[0].innerHTML = formatted; //Total;
            var Veriance = Total - nRow[i].children[11].children[0].value;
            nRow[i].children[13].children[0].innerHTML = Veriance.toFixed(2);

            nRow[i].children[9].children[0].disabled = true; //CrNo
            nRow[i].children[10].children[0].disabled = true; //Allocate
            nRow[i].children[11].children[0].disabled = true; //CrAmount
            nRow[i].children[14].children[0].disabled = true; //Accept Veriance
            nRow[i].children[15].children[0].disabled = true; //Edit

            nRow[i].children[10].children[0].checked = false; //Allocate
            nRow[i].children[14].children[0].checked = false; //Accept Veriance
            nRow[i].children[15].children[0].checked = false; //Edit
            nRow[i].style.backgroundColor = "";

            if (nRow[i].children[12].children[0].defaultValue == "RejectedReturn") {
                nRow[i].style.backgroundColor = "#FFEDE6";
            }
            else if (nRow[i].children[12].children[0].defaultValue == "CompleteWithVariance") {
                nRow[i].children[15].children[0].disabled = false; //Edit
                nRow[i].children[14].children[0].checked = true; //Accept Verianc
                nRow[i].style.backgroundColor = "#D1D1D1";
            }
            else if (nRow[i].children[12].children[0].defaultValue == "Complete") {
                nRow[i].children[15].children[0].disabled = false; //Edit
                nRow[i].children[10].children[0].checked = true; //Allocate
                nRow[i].style.backgroundColor = "#D1D1D1";
            }
            else if (nRow[i].children[12].children[0].defaultValue == "Outstanding") {
                nRow[i].children[9].children[0].disabled = false; //CrNo
                nRow[i].children[10].children[0].disabled = false; //Allocate
                nRow[i].children[11].children[0].disabled = false; //CrAmount
                nRow[i].children[14].children[0].disabled = false; //Accept Veriance
            }
            else if (nRow[i].children[12].children[0].defaultValue == "Partial") {
                nRow[i].children[9].children[0].disabled = false; //CrNo
                nRow[i].children[10].children[0].disabled = false; //Allocate
                nRow[i].children[11].children[0].disabled = false; //CrAmount
                nRow[i].children[14].children[0].disabled = false; //Accept Veriance

            }
        }
    } 
```

The same approach worked in other web pages but the only difference here is that RefreshGrid() is being called from the fnCreatedRow function whereas in the other instances it was called from the fnRowCallback and fnFooterCallback functions. The "unformatted" value will be present in the hidden field.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T15:41:06.407

I am unfamiliar with the formatCurrency library, but it looks like you may be attempting to call it on a string in this line:

```
var formattted = $("input[id$='hfFormat']").val(unformatted).formatCurrency().val(); 
```

This line also has a typo in it that I believe is a bug:

`var formattted = ...`

should be

`var formatted = ...`.

Try changing this like to:

```
$("input[id$='hfFormat']").val(unformatted);
$("input[id$='hfFormat']").formatCurrency();
var formatted = $("input[id$='hfFormat']").val(); 
```

Generally speaking, and though it is not required, it is usually better to NOT chain your method calls, as it gets harder to read, harder to debug, and easier to make mistakes.

Also, consider setting your reused jQuery objects (selected elements) to variables, either globally or locally in a function, based on the scope in which they are to be used. Everytime jQuery hits a selector, it has to search the document to re-find the element(s) to add to the object/collection. This requires a LOT of overhead, which you can cut down by setting selectors that you have already found to be variables. The same goes for the use of `$(this)`, as wrapping it with `$()` makes it a jQuery object, which is, essentially, a selector, causing jQuery to search the document for the element that matches `this`.

**UPDATE:**

Also, check out [this answer](https://stackoverflow.com/a/9673695/1506793) which demonstrates and explains the calling of the `toNumber` method (included in the formatCurrency plugin), before calling `.formatCurrency()`. I have repeated this example, below:

```
// removes invalid characters, then formats currency
$(selector).toNumber().formatCurrency(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T15:42:48.437

This is because val() returns you string value, but you should pass input to format function ()

```
//wrong
var formattted = $("input[id$='hfFormat']").val(unformatted).formatCurrency().val(); 

//right
var input = $("input[id$='hfFormat']");
input.val(unformatted);
var formatted = input.formatCurrency().val(); 
```

[This fiddle](http://jsfiddle.net/mQNzy/) demonstrate my point

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-11T17:23:44.770

Retrieve the calculated value, store it to the input field, format it, retrieve it back to a new variable.

```
var Total = (nRow[i].children[6].children[0].innerHTML * nRow[i].children[7].children[0].innerHTML).toFixed(2);
$("input[id$='hfFormat']").val(Total);
$("input[id$='hfFormat']").formatCurrency();
var formatted = $("input[id$='hfFormat']").val(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-15T11:06:46.043

Turns out the problem was with duplicated jquery library scripts: on the page and a user control on the page. I moved the script reference to the Master page and removed from the Child pages and controls to avoid the duplication. Thanks for the assistance guys!

# python - 一次计算匹配不同模式的行

> ID：15952913
> 
> 赞同：1
> 
> 时间：2013-04-11T15:31:58.033
> 
> 标签：python

我有一个 python 脚本，给定的模式遍历文件，并且对于与该模式匹配的每一行，它会计算该行在文件中出现的次数。

脚本如下：

```
#!/usr/bin/env python

import time
fnamein = 'Log.txt'

def filter_and_count_matches(fnamein, fnameout, match):
  fin = open(fnamein, 'r')
  curr_matches = {}
  order_in_file = [] # need this because dict has no particular order
  for line in (l for l in fin if l.find(match) >= 0):
    line = line.strip()
    if line in curr_matches:
      curr_matches[line] += 1
    else:
      curr_matches[line] = 1
      order_in_file.append(line)
  #
  fout = open(fnameout, 'w')
  #for line in order_in_file:
  for line, _dummy in sorted(curr_matches.iteritems(),
      key=lambda (k, v): (v, k), reverse=True):
    fout.write(line + '\n')
    fout.write(' = {}\n'.format(curr_matches[line]))
  fout.close()

def main():
  for idx, match in enumerate(open('staffs.txt', 'r').readlines()):
    curr_time = time.time()
    match = match.strip()
    fnameout = 'm{}.txt'.format(idx+1)
    filter_and_count_matches(fnamein, fnameout, match)
    print 'Processed {}. Time = {}'.format(match, time.time() - curr_time)

main() 
```

所以现在我每次想检查不同的模式时都会检查文件。这样做可以只检查一次文件（文件很大，所以需要一段时间来处理）。如果能够以一种优雅的“简单”方式做到这一点，那就太好了。谢谢！

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T15:36:59.400

看起来像[`Counter`](http://docs.python.org/2/library/collections.html#collections.Counter)会做你需要的：

```
from collections import Counter
lines = Counter([line for line in myfile if match_string in line]) 
```

例如，如果`myfile`包含

```
123abc
abc456
789
123abc
abc456 
```

和`match_string`是`"abc"`，那么上面的代码给你

```
>>> lines
Counter({'123abc': 2, 'abc456': 2}) 
```

对于多种模式，这个怎么样：

```
patterns = ["abc", "123"]
# initialize one Counter for each pattern
results = {pattern:Counter() for pattern in patterns}  
for line in myfile:
   for pattern in patterns:
       if pattern in line:
           results[pattern][line] += 1 
```

# tree - 值表/树

> ID：15952918
> 
> 赞同：1
> 
> 时间：2013-04-11T15:32:07.767
> 
> 标签：tree, wolfram-mathematica

**我的问题：**

有没有办法创建一棵价值树？类似于命令 TreeForm 的输出，但在节点中有值？

**我为什么要这个？**

我正在尝试做一个完整的程序来分析我的实验室课程的输出。每列数据作为一个符号赋值。一般来说，每一列都是有意义的：它不仅仅是一堆不同的变量。我想说的是，总的来说，计算是“按列”完成的。我的问题是，当我需要进行需要更复杂的“水平”结构的计算时：将变量分配给列缺乏“水平灵活性”。（在某种程度上，这是在 Excel 中使用`$$`和数组公式解决的问题）

让我用一个例子来说明：

```
y={1,2,3,4,5,6,7,8,9};
x={-1,-2,-3}; 
```

我想将 y 的 1;;3, 4;;8, 9;;9 部分与 x 的每个元素相关联。我所说的关联的意思是，对于某些计算，函数的输入将作为每个集合的参数。

我知道 Map、Apply、Thread 和 MapThread 等功能。我一直在使用它们来解决这类问题，但有时它会变得有点混乱。

我也知道分区，如果我想在相同长度的子数组中分隔 y，它将解决我的问题。

正如我在我的问题中所说，我想要的是构建一个类似于网络/树的东西，它在我的计算的每个步骤中“归档”参数的结构。就像在网络理论中一样，当每个节点作为它与网络其余部分的连接的关联列表时。请注意，此列表不应包含值，而是包含连接节点的某种坐标

**示例：**`n={3,2,5}`计算列表 长度不规则分区的均值和均方差

```
 y={3,5,8,7,9,4,6,2,1,5}; 
```

**我非常概念性的方法：**

我的表/树的第一列将是数据 y。要引用某个列上的某个值，我将使用一对坐标 i,j：i 代表列，j 代表内部位置。我将为 y 分配坐标 i=1。

对于均值计算，我有什么样的“计算连接”？

```
Yav=F1[y]=Mean[y] 
```

均值列 Xav i=2 将包含 3 个元素。我为每个人分配一个连接列表给 y：

（“”的连接是用一个 C“”来表示的）

```
 CYav[[1]]: {1,{1,2,3}}
    CYav[[2]]: {1,{4,5}};
    CYav[[3]]: {1,{6,7,8,9,10}} 
```

连接写成 {i,{j's of the elements of i}} 的形式

现在，让我们计算均方偏差。那是 ，

```
 Ymsd=F2[y,Yav]=Mean[(y-Yav)^2] 
```

此列`i=3`也是 3 个元素。

对于这个计算，我想使用 i=1,2 列。与 y 的计算连接与用于计算 Yav 的连接相同。但现在，我需要将 Ymsd 连接到 Yav。

```
 CYmsd[[1]]: {{1,{1,2,3}},{2,1}}
    CYmsd[[2]]: {{1,{4,5}},{2,2}}
    CYmsd[[3]]: {{1,{6,7,8,9,10}},{2,3}} 
```

现在连接是前一种类型的一对连接，每列连接一个。

分配连接后，我将使用一个函数来获取正确的值，由创建的地图引导，并应用 F1、F2。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T04:50:10.260

您想做的大部分事情要么是非常特定于应用程序，要么是一种面向对象的数据结构和代码视图。

但首先，为了帮助你，这里有一个小工具，多年来一直在我的技巧包中，可以补充 Map、MapThread 和 Partition 来解决你的问题：

```
PartitionAs[k_List, c_List] := 
    Map[Take[k, #] &, 
         FoldList[Last[#1] + {1, #2} &, {1, First[c]}, Rest@c]]

PartitionAllAs[k_List, c_List] := 
    Map[Take[k, #] &, 
       If[Last[Last[#]] < Length[k], 
           Append[#, {Last[Last[#]] + 1, Length[k]}], #] &@
                 FoldList[Last[#1] + {1, #2} &, {1, First[c]}, Rest@c]] 
```

这是他们所做的一个例子

```
PartitionAs[{a, b, c, d, e, f, g, h, i, j, k}, {1, 2, 5}]

{{a}, {b, c}, {d, e, f, g, h}}

PartitionAllAs[{a, b, c, d, e, f, g, h, i, j, k}, {1, 2, 5}]

{{a}, {b, c}, {d, e, f, g, h}, {i, j, k}} 
```

它们没有内置检查（它们不会测试您发送给它们的零件长度列表是否与列表大小兼容等），因此是否正确取决于调用代码，但它们可能对您的应用程序很方便. 他们也只能指定一个分区深度。可以想象其他指定分区的方法，并且从平面列表构建更通用的树制作例程并不是很困难。告诉我们你是否需要这种东西。

# java - 如何反编译一个java包？

> ID：15952920
> 
> 赞同：-3
> 
> 时间：2013-04-11T15:32:10.050
> 
> 标签：java, eclipse

如何反编译包含 Java 类的整个包？确实该文件是 .war 并且在 src/ 下有一些我无法打开的包。有没有像 JadClipse 这样的插件用于包？谢谢你 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T15:36:36.897

[如何反编译整个Jar文件？](https://stackoverflow.com/questions/647116/how-to-decompile-a-whole-jar-file)

JavaDecompiler 可以很好地使用 jar：从 0.2.5 开始，显示 JAR 文件中的所有文件。

# javascript - Javascript Object.defineProperty 在 FireFox 19.02 (MacOS) 中产生 TypeError

> ID：15952926
> 
> 赞同：3
> 
> 时间：2013-04-11T15:32:31.357
> 
> 标签：javascript, defineproperty

就在今天，我尝试将我的一个使用`Object.defineProperty()`javascript 中的方法的旧库包含到 HTML 文档中。我很确定在以前版本的 FireFox 中它工作得很好。但是，如果我现在在 MaxOS 10.6.8 上的 FF 19.02 中使用它，如下例所示：

```
var nuArray = function (values) {
    for (var i in values) {this[i] = values[i]}
}
nuArray.prototype = Array.prototype;

var defaultProperties = {configurable: true, writable: true, enumerable: false, get: undefined, set: undefined, value: undefined};

Object.defineProperty(nuArray, "grep", defaultProperties) 
```

我收到以下错误

```
TypeError: property descriptors must not specify a value or be writable when a getter or setter has been specified @ .... 
```

我后来才添加了`value`,`get`和部分，以便将它们显式设置为（默认情况下它们应该是，但由于这种行为一开始就相当奇怪，我想确保我已经涵盖了所有基础）。它在 Safari 5.1.7 中运行没有问题，正如我之前已经提到的，我非常确定它在以前的 FF 版本中也是如此。奇怪的是，即使是现在，如果我只是将代码行复制到 FF 的控制台中，也不会抛出任何错误，并且一切正常。如果我定义,或.没有任何区别。有什么明显我忽略的东西，还是我在这里遇到了浏览器不兼容的新问题？`set``undefined``value``get``set`

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2015-12-27T08:25:00.660

在属性描述符中，使用属性 'set' 或 'get' 时忽略 'writable' 属性。

# ios - OCMockito 使用任何参数进行验证

> ID：15952927
> 
> 赞同：4
> 
> 时间：2013-04-11T15:32:33.643
> 
> 标签：ios, objective-c, tdd, ocmockito

我正在尝试验证模拟对象上的函数根本没有使用任何参数调用。

我正在模拟的对象的功能是......

```
- (void)registerUserWithUsername:(NSString*)username password:(NSString*)password; 
```

如果用户名为空，我想验证该函数是否未被调用。

IE

```
[mockService registerUserWithUsername:@"" password:@"Password"];

[verify(mockService, never()) registerWithUsername:....... password:.......]; 
```

我只是不确定在......位中放什么？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-04-14T03:41:26.103

要指定它从不使用任何参数调用，请使用`anything()`匹配器：

```
[verify(mockService, never()) registerWithUsername:(id)anything() password:(id)anything()]; 
```

# jquery - 如何检查客户端下拉列表的 Guid.Empty Id

> ID：15952930
> 
> 赞同：6
> 
> 时间：2013-04-11T15:32:39.900
> 
> 标签：jquery, asp.net-mvc-4

我有以下`ViewResult()`填充模型（包含两个下拉列表），然后将其发送到强类型 View()。请注意我如何在两个下拉列表中添加一个新的“<em>---VIEW ALL---”值，**ID**为`Guid.Empty.`

```
[HttpGet]
public ViewResult ManageUsers()
{
    var applicationList = _facade.Value.GetApplications().OrderBy(a => a.Name).ToList();
    applicationList.Add(new Application() { Id = Guid.Empty, Name = "---VIEW ALL---" });

    var roleList = _facade.Value.GetRoles(applicationList.First().Id).OrderBy(a => a.Name).ToList();
    roleList.Add(new Role() { Id = Guid.Empty, Name = "---VIEW ALL---" });

    var model = new ManageUsersModel();
    model.ApplicationList = new SelectList(applicationList, "Id", "Name", applicationList.First().Id);
    model.RoleList = new SelectList(roleList, "Id", "Name");

    return View(model);
} 
```

一旦进入 View() 我`jquery .change()`为第一个下拉菜单创建一个事件，我希望检测所选值。

根据选择的值，我需要采取不同的行动。例如，如果`Guid.Empty`选择了该值，则执行此操作...如果没有，则执行此操作...</p>

到目前为止，我在 .change() 事件中的代码如下所示：

```
$('#ApplicationId').change(function () {
    if ($(this).val() === "00000000-0000-0000-0000-000000000000") {
        alert("aaa");
    }
    else {
        alert("xxx");
    }
}); 
```

该代码有效，但我发现检查我的操作方式很难看**。**`Guid.Empty`

有没有人有不同/更好的方法来实现这一目标？

提前致谢！

真诚的

PS：由于这将是一个多语言应用程序，我不能使用`selected text`下拉菜单的 if(...) 比较。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T15:42:52.723

我假设 Model.ApplicationList 和 Model.RoleList 是 List 的一种类型， `List<SelectListItem>`而不是 IEnumerable。如果是这样，为什么不在创建 SelectList 并使用空字符串作为值时附加空的“---查看全部---”。

```
[HttpGet]
public ViewResult ManageUsers()
{
    var applicationList = _facade.Value.GetApplications().OrderBy(a => a.Name).ToList();
    var roleList = _facade.Value.GetRoles(applicationList.First().Id).OrderBy(a => a.Name).ToList();

    var model = new ManageUsersModel();
    model.ApplicationList = new SelectList(applicationList, "Id", "Name", applicationList.First().Id);
    model.RoleList = new SelectList(roleList, "Id", "Name");

    var defaultChoice = new SelectListItem("", "---VIEW ALL---")
    model.ApplicationList.InsertAt(0, defaultChoice);
    model.RoleList.InsertAt(0, defaultChoice);
    return View(model);
} 
```

还有你的 Javascript

```
$('#ApplicationId').change(function () {
    if ($(this).val() === "") {
        alert("aaa");
    }
    else {
        alert("xxx");
    }
}); 
```

# html - 我可以使用 Template Toolkit 找出变量是否是数组吗？

> ID：15952935
> 
> 赞同：3
> 
> 时间：2013-04-11T15:32:54.647
> 
> 标签：html, template-toolkit

我将多选框的结果传递到页面，以便可以在屏幕上显示选择。由于它是多选的，因此结果可以是标量或数组引用。有没有办法找出来？我在网上找不到任何东西，但我认为可能有一个`.array`或`.array_ref`令牌可用于验证。我正在使用模板工具包、Perl 和 Dancer。

所以这是我得到的标量：

```
<% IF multitext %>
    Text: <% multitext %>
<% END %> 
```

我想要的是...

```
<% IF multitext %>
    <% IF multitext.array_ref %> <!-- whatever works! -->
        <% FOREACH text IN multitext %>
            Text: <% text %>
        <% END %>
    <% ELSE %>
        Text: <% multitext %>
    <% END %>
<% END %> 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-12T07:39:56.453

如果`<%- multitext.0 -%>`返回一个非零值，它是一个数组引用。

如果`<%- multitext.keys.size -%>`返回一个非零值，它就是一个 hashref。

我通常处理它的方式是强制它是一个数组，如果它是一个标量，例如：

```
<%- SET items = multitext.0 ? multitext : [ multitext ];
    FOREACH item IN items;
        ...
    END; -%> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-04-14T18:54:39.070

几年后...

您可以使用`.list`vmethod 来保证它是一个数组，例如

```
 <% FOREACH text IN multitext.list %>
        Text: <% text %>
    <% END %> 
```

请参阅[http://template-toolkit.org/docs/manual/VMethods.html#section_list](http://template-toolkit.org/docs/manual/VMethods.html#section_list)

# c# - 识别相同 OleDbException 类型的异常

> ID：15952936
> 
> 赞同：3
> 
> 时间：2013-04-11T15:33:00.673
> 
> 标签：c#, exception

我有以下代码来验证 MSAccess 2003 数据库是否由另一个应用程序以独占模式打开（数据库已经有密码）：

```
OleDbConnectionStringBuilder conString = new OleDbConnectionStringBuilder();
conString.Provider = "Microsoft.Jet.OLEDB.4.0";
conString.DataSource = "some path to some mdb file";
// I don't care about the password, 
// I just whant to know if it is opened in Exclusive Mode
conString["Jet OLEDB:Database Password"] = String.Empty;
conString["Mode"] = "Share Deny None";
string completeConnStr = conString.ConnectionString;

using (OleDbConnection con = new OleDbConnection(completeConnStr))
{
      try
      {
         con.Open();
         con.Close();
      }
      catch (Exception ex)
      {
         string s = ex.Message;
      }
} 
```

当数据库以独占模式打开时，它不关心密码，它会抛出 OleDbException 并显示以下消息：“文件已在使用中”。当数据库未处于独占模式并收到错误的密码时，它会抛出 OleDbException 并显示一条消息：“它不是有效的密码”。

如何识别这两个异常？密码验证是用另一种方法进行的，所以我只想知道数据库是否以独占模式打开，然后再用“请输入密码”对话框打扰用户。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-11T19:36:58.887

该类`OleDbException`提供了`Errors`实际上是 a 的属性`OleDbErrorCollection`。此集合包含`OleDbError`提供有关错误信息的对象。

您可以使用类的`SQLState`属性`OleDbError`来区分这两种情况：

```
try
{
  con.Open();
  con.Close();
}
catch (OleDbException dbException)
{
  switch (dbException.Errors[0].SQLState)
  {
    case "3031": // Authentication failed...
      MessageBox.Show("Authentication failed...");
      break;
    case "3045": // File already in use...
      MessageBox.Show("Database already in use...");
      break;
    default:
      break;
  }          
} 
```

有关可能的错误的更多信息，请参阅此[链接](http://msdn.microsoft.com/en-us/library/office/bb221208%28v=office.12%29.aspx)。

# android - 在 Android SQLite 中选择 NULL 值

> ID：15952937
> 
> 赞同：6
> 
> 时间：2013-04-11T15:33:05.137
> 
> 标签：android, sqlite

由于 selectArgs 不正确，我正在执行以下方法但没有成功（至少这是我所相信的。

**找到所有：**

```
public Collection<Object> findAllByCodigoSetorOrderByStatusWhereDataAgendamentoIsNull(Integer vendedor) {
    Collection<Object> objects = null;
    String selection = Object.FIELDS[20] + "=?" + " OR " + Object.FIELDS[20] + "=?" + " OR " + Object.FIELDS[20] + "=?" + " AND " + Object.FIELDS[6] + "=?";
    String[] selectionArgs = new String[] { "''", "'null'", "NULL", String.valueOf(vendedor) };
    Collection<ContentValues> results = findAllObjects(Object.TABLE_NAME, selection, selectionArgs, Object.FIELDS, null, null, Object.FIELDS[4]);
    objects = new ArrayList<Object>();
    for (ContentValues result : results) {
        objects.add(new Object(result));
    }
    return objects;
} 
```

**查找所有对象：**

```
protected Collection<ContentValues> findAllObjects(String table, String selection, String[] selectionArgs, String[] columns, String groupBy, String having, String orderBy) {
        Cursor cursor = null;
        ContentValues contentValue = null;
        Collection<ContentValues> contentValues = null;
        try {
            db = openRead(this.helper);
            if (db != null) {
                cursor = db.query(table, columns, selection, selectionArgs, groupBy, having, orderBy);
                contentValues = new ArrayList<ContentValues>();
                for (int i = 0; i < cursor.getCount(); i++) {
                    cursor.moveToPosition(i);
                    contentValue = new ContentValues();
                    for (int c = 0; c < cursor.getColumnCount(); c++) {
                        contentValue.put(cursor.getColumnName(c), cursor.getString(c));
                    }
                    contentValues.add(contentValue);
                    cursor.moveToNext();
                }
            }
            return contentValues;
        } finally {
            close(db);
        }
    } 
```

如何使用 db.query 正确选择列并将其与 - null、'null' 和 '' 进行比较？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-04-11T17:02:47.927

Android 的数据库 API 不允许将`NULL`值作为参数传递；它只允许字符串。（这是一个可怕的设计错误。更糟糕的是，[SQLiteStatement](http://developer.android.com/reference/android/database/sqlite/SQLiteStatement.html) *确实*允许所有类型的参数，但仅适用于返回单个值的查询。）

您别无选择，只能将查询字符串更改为`blah IS NULL`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-12-20T04:47:33.943

老问题，但我仍然坚持了几个小时，直到我找到了这个答案。无论出于何种原因，这种奇怪的行为（或错误）仍然存在于 android sdk 中，如果您想查询空值，只需执行

```
SQLiteDatabase db = getReadableDatabase();
ContentValues contentValues = new ContentValues();

contentValues.put("columnName", newValue);

String nullSelection = "columnName" + " IS NULL";

db.update("tableName", contentValues, nullSelection, null);
db.close(); 
```

在此示例中，我正在更新值，但仅在选择值时这是一个类似的概念

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-05-11T15:44:25.520

正如在其他答案中提到的，对于 null，需要使用“IS NULL”。这是一些同时具有 null 和字符串的便利代码（我在示例中使用 delete，但对于其他方法也可以这样做，例如查询）：

```
public void deleteSomething(String param1, String param2, String param3) {
    ArrayList<String> queryParams = new ArrayList<>();

    mDb.delete(TABLE_NAME,
            COLUMN_A + getNullSafeComparison(param1, queryParams) + "AND " +
                    COLUMN_B + getNullSafeComparison(param2, queryParams) + "AND " +
                    COLUMN_C + getNullSafeComparison(param3, queryParams),
            queryParams.toArray(new String[0]));
}

private String getNullSafeComparison(String param, List<String> queryParams) {
    if (param == null) {
        return " IS NULL ";
    } else {
        queryParams.add(param);
        return " = ? ";
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-12-10T20:55:45.420

您可以将**NULL**值绑定到*SQLiteStatement*：

```
 SQLiteDatabase db = getWritableDatabase();
    SQLiteStatement stmt = db.compileStatement("UPDATE table SET " +
            "parameter=? WHERE id=?");
    if (param == null)
        stmt.bindNull(1);
    else
        stmt.bindString(1, param);
    stmt.execute();
    stmt.close();
    db.close(); 
```

# java - Netty 在 Java 游戏服务器上转储线程时出现太多“java.lang.Thread.State: WAITING (parking)”

> ID：15952941
> 
> 赞同：1
> 
> 时间：2013-04-11T15:33:14.523
> 
> 标签：java, multithreading, netty, state

我正在运行基于 Netty 框架的 Socket 游戏服务器。这一次，服务器出现了一个严重的问题：CPU 使用率 0% 并且突然不再接受连接。

平均CCU约为100

我转储了 java 线程并意识到有太多的线程有状态

```
java.lang.Thread.State: WAITING (parking) 
```

这对于 Netty 框架是正常的还是我做了一些愚蠢的事情？

这是我的[转储文件](https://dl.dropboxusercontent.com/u/55451598/dump_jstack.txt)

# php - Mod_rewrite - 创建干净的 URL

> ID：15952942
> 
> 赞同：0
> 
> 时间：2013-04-11T15:33:17.500
> 
> 标签：php, apache, mod-rewrite

我们想为我们的网站创建干净的 URL。我已经搜索了如何做到这一点，并且找到了一个代码片段，但是它不符合我的要求。在这里，我将解释我们基本上想要什么。

这是基本网站的 URL：**[http ://www.test.com](http://www.test.com)**

我们有一个“页面”菜单，其中列出了用户可以看到的特定页面。如下所示：**[http ://www.test.com/pages.php](http://www.test.com/pages.php)**

我们基本上希望当有人访问这个**/pages.php**时，它应该将他们重定向到**/pages**（或使用完整的 URL：**test.com/pages**）或不重定向，只显示未找到的页面。

它还应该适用于以下任何可能的配置：

*   /页
*   /页/
*   /page.php

我查看了 Stackowerflow 的系统，它按照我们实际想要的方式工作。所以每次我都在看：

*   stackoverflow.com/questions
*   stackoverflow.com/questions/
*   stackoverflow.com/questions.php - 显示页面未找到站点

这基本上是我需要的。我已经尝试过这段代码，但它不能完全满足我的需要：

```
Options +FollowSymlinks
RewriteEngine On
RewriteBase /
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME}.php -f
RewriteRule ^(.+)$ /$1.php [L,QSA] 
```

如果有人能清楚地解释如何实现这一点，我会很高兴。另外，如果您发现此帖子重复，请将 EXACT 帖子链接给我，因为我一直在寻找这个确切的问题，但没有找到任何答案。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T19:07:22.970

好的，写这样的东西。

```
<VirtualHost *:80>
    ServerAdmin webmaster@localhost
    ServerName deli.localhost

    DocumentRoot /var/www/deli/
    <Directory /var/www/deli/>
        Options -Indexes FollowSymLinks MultiViews
        AllowOverride None
        Order allow,deny
        allow from all

                RewriteEngine on

                ## Externally redirect clients directly requesting .(php|aspx|html|htm|pl|cgi|asp)+ page 
                ## URIs to extensionless URIs
                ## If client request header contains php,aspx,html or htm file extension, redirect
                ## It avoids an infinite loop since "THE_REQUEST" is what the UA asks for, not what the 
                ## server translates it to on the second pass.
                ## THE_REQUEST syntax is something like: GET /page.html HTTP/1.0
                RewriteCond %{THE_REQUEST} ^[A-Z]{3,9}\ /([^.]+)\.(php|aspx|html|htm|pl|cgi|asp)+(/.*)?\ HTTP [NC]
                RewriteRule ^([^.]+)\.(php|aspx|html|htm|pl|cgi|asp)+(/.*)?$ http://xyz.com/$1$3 [NC,R=301,L]

                FileETag none

                ErrorDocument 401 /401.php
                ErrorDocument 403 /403.php
                ErrorDocument 404 /404.php
                ErrorDocument 500 /500.php
                ErrorDocument 503 /503.php
    </Directory>

    ErrorLog /var/log/apache2/error.log

    # Possible values include: debug, info, notice, warn, error, crit,
    # alert, emerg.
    LogLevel warn

    CustomLog /var/log/apache2/access.log combined
</VirtualHost> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T16:06:07.437

下面，第一条规则将 301 重定向 *.php 到没有 .php 的 URL，第二条规则将通过添加“.php”来处理所有其他 url：

```
 RewriteCond %{REQUEST_URI} ^/(.*?)\.php$
    RewriteRule ^/.*$ /%1 [R=301,QSA,L]

    RewriteRule ^/(.*)$ /$1.php 
```

例如，

`/page.php`将重定向到`/page`并处理`page.php`.

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-04-11T15:46:57.063

在另一个帖子上找到了这个。它显然从 url 中去除了扩展名 .php、.html、.cgi。

```
RewriteCond %{REQUEST_URI} (.*)/$
RewriteCond %{REQUEST_FILENAME}\.html -f
RewriteRule (.*)/$ $1.html [L]

RewriteCond %{REQUEST_URI} (.*)/$
RewriteCond %{REQUEST_FILENAME}\.php -f
RewriteRule (.*)/$ $1.php [L]

RewriteCond %{REQUEST_URI} (.*)/$
RewriteCond %{REQUEST_FILENAME}\.cgi -f
RewriteRule (.*)/$ $1.cgi [L]

RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME}\.html -f [OR]
RewriteCond %{REQUEST_FILENAME}\.php -f [OR]
RewriteCond %{REQUEST_FILENAME}\.cgi -f
RewriteRule .* %{REQUEST_FILENAME}/ [R=301,L] 
```

# javascript - IE attachEvent 调用返回 true，但处理程序显示“null”

> ID：15952943
> 
> 赞同：1
> 
> 时间：2013-04-11T15:33:19.850
> 
> 标签：javascript, html, internet-explorer, dom, attachevent

我有一个相当简单的 ASP.NET 页面，它呈现一个 HTML 输入（文本框）。在生成的 HTML 中，我将处理程序附加到几个事件，包括 onfocus、onkeypress 和 onkeyup。因为这是针对不支持 addEventListener 的 IE 版本（我无能为力的情况）的解决方案，所以我被迫使用 attachEvent。

对 attachEvent 的典型调用如下 - 为了简洁/清晰起见，我从原文中摘录了此源代码，因此它不*完全*是有问题的代码：

```
var hostControl = document.getElementById('mytextbox');
var attachResult = hostControl.attachEvent('onfocus', function(){
    hostControl.select();
});

if (!attachResult)
{
    alert('Attach failed.');
}

attachResult = hostControl.attachEvent('onblur', function(){
    if (hostControl.value=='') 
    {
        alert('Warning - no entry.');
    }
});

if (!attachResult)
{
    alert('Attach failed.');
} 
```

当我在 IE 调试器中单步执行此代码时，attachEvent 在两个实例中都返回“true”，这应该表明事件附件尝试成功。但是，当我查看调试器中控件的 [Event] 处理程序时，所有事件都显示为“null”，没有附加处理程序。

我尝试过/研究过的事情：

*   我已经阅读了几篇关于 IE 中事件附件变幻莫测的不同文章，所以我似是而非地避免了任何“this”引用。
*   我尝试了一个使用 addEvent 包装器块之一的版本，该包装器块尝试使用 addEventListener（如果可用），即使我知道这将是一个 IE 解决方案。

当我针对 FireFox 尝试该版本时，事件附件通过 addEventListener 正常工作，但在 IE 中使用 attachEvent 失败（attachEvent 仍然返回 true）。

*   然后我选择消除包装器可能引入的任何可能的问题，并直接对控件使用 attachEvent，这将我带到现在的位置。问题仍然存在。

我想我只是忽略了一些非常简单的事情，因为我之前已经毫无困难地连接了一些事件，但是这里的一些东西给了我一个我不认识的曲线球。欣赏额外的眼球，看看我错在哪里。

# .net - LINQtoSql - 如何基于字符串数组进行通配符搜索

> ID：15952944
> 
> 赞同：1
> 
> 时间：2013-04-11T15:33:20.693
> 
> 标签：.net, vb.net, linq, linq-to-sql

在我们的一个表中，有一个逗号分隔的关键字字段，是否有任何直接的 LINQtoSQL 方法可以从字符串数组中搜索每个关键字？

以下仅在字段中有一个关键字时返回

```
 Dim q = (From l In db.ListingViews
             Where keywordsarray.Contains(l.Keywords)
             Select l).ToList 
```

我发现解决这个问题的唯一方法是获取整个表，然后搜索它 - LINQtoSQL 不支持 .any ，并且 .contains 只会采用一个字符串。

```
 Dim q = (From l In db.ListingViews
                     Select l).ToList

            Dim q2 = (From b In q
                      Where keywordsarray.Any(Function(s) b.Keywords.Contains(s))
                     Select b).ToList

            Return q2 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T12:23:44.310

您可以使用`SqlMethods.Like`方法：http:
[//msdn.microsoft.com/en-us/library/bb355235.aspx](http://msdn.microsoft.com/en-us/library/bb355235.aspx)

# java - 如何使用eclipse在java中的类中添加默认字符串

> ID：15952945
> 
> 赞同：2
> 
> 时间：2013-04-11T15:33:21.820
> 
> 标签：java, eclipse

有什么方法可以配置 eclipse 以创建具有默认字符串的类作为第一行

```
public static Logger logger = Logger.getLogger(MyClass.class.getName()); 
```

每当我在eclipse中创建一个新的java文件时

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-11T15:35:40.027

属性 -> Java 代码样式 -> 代码模板。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-11T15:36:28.030

您可以使用经过调整的新类模板来做到这一点。

您可以在**Java->Code Style->Code Templates**下的 Preferences 中找到它，然后切换到对话框的右侧并选择**Code->New Java files**

# asp.net - 用户控件中的 DropDownList - 如何获取它以便可以在设计时添加列表项？

> ID：15952947
> 
> 赞同：1
> 
> 时间：2013-04-11T15:33:24.510
> 
> 标签：asp.net

我有一个用户控件，其中基本上只有一个下拉列表（显然比这更多，但下拉列表就是你所看到的）。

在 Visual Studio 中，您可以将项目添加到设计器中的常规下拉列表中。如何将此功能扩展到我的用户控件？

如果我像下面这样手动输入项目，它在浏览器中测试时有效，但在设计器中出现错误

```
<uc2:Input_DropDownList ID="Input_DropDownList1" runat="server">
    <ListItems>
        <asp:ListItem Text="Apples" Value="0" />
        <asp:ListItem Text="Oranges" Value="1" />
        <asp:ListItem Text="Grapes" Value="2" />
        <asp:ListItem Text="Strawberries" Value="3" />
    </ListItems>
</uc2:Input_DropDownList> 
```

错误：

```
 Error Creating Control - Input_DropDownList1
    Type 'System.Web.UI.UserControl' does not have a public property named 'ListItems' 
```

代码隐藏：

```
<PersistenceMode(PersistenceMode.InnerProperty)> _
    Public ReadOnly Property ListItems() As ListItemCollection
        Get
            Return InputField.Items
        End Get
    End Property 
```

我明白问题是什么......但我不知道如何解决它。任何帮助表示赞赏。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T16:41:15.243

公开 ListItems() 的控件属性应具有以下属性：

```
<DesignerSerializationVisibility(DesignerSerializationVisibility.Content),
NotifyParentProperty(True),
PersistenceMode(PersistenceMode.InnerDefaultProperty)>
Public ReadOnly Property ListItems() As ListItemCollection
    Get
        Return InputField.Items
    End Get
End Property 
```

# sql - 在 SQL 中查询表列的正确方法？

> ID：15952949
> 
> 赞同：0
> 
> 时间：2013-04-11T15:33:28.320
> 
> 标签：sql

我有大约 6 个表，其中一些列是相同的。我是否必须知道哪些表包含我正在查询的列，或者是否有办法编写 SQL 查询以便我可以引用列并且数据库将扫描表以查找特定列？

例如，假设 table1、table3 和 table5 都包含“人口”列。我是否必须在查询中指定我想从表 table1、table2 和 table3 中的“人口”中检索信息，或者有没有办法只指定我想要“人口”列中的信息而不指定任何表?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T15:58:06.443

```
select table1.population as pop1, table2.population as pop2, table5.population as pop3
from table1, table2, table5; 
```

这将返回 3 列，显示每个表中的人口。

```
select population
from table1
union
select population
from table2
union
select population
from table5; 
```

这将在一列中返回一长串人口。

# applet - 小程序：SocketException 未知代理类型：HTTP

> ID：15952950
> 
> 赞同：3
> 
> 时间：2013-04-11T15:33:27.953
> 
> 标签：applet, httpclient, signed-applet

我在 Eclipse 中运行我的小程序没有问题，但是如果我在浏览器中签名并运行它，就会发生这种情况

```
10-abr-2013 19:54:37 org.apache.http.impl.client.DefaultHttpClient tryConnect
INFO: I/O exception (java.net.SocketException) caught when connecting to the target host: Unknown proxy type : HTTP
10-abr-2013 19:54:37 org.apache.http.impl.client.DefaultHttpClient tryConnect
INFO: Retrying connect
…
java.net.SocketException: Unknown proxy type : HTTP
    at java.net.SocksSocketImpl.connect(Unknown Source)
    at java.net.Socket.connect(Unknown Source) 
```

我在这里尝试使用 org.apache.http.client.HttpClient 上传一些文件

```
public static String executeMultiPartRequest(String urlString, File file,
        String fileName, String fileDescription) {

    System.out.println("SET URI " + urlString);
    HttpPost postRequest = new HttpPost(urlString);
    try {

        MultipartEntity multiPartEntity = new MultipartEntity();

        // The usual form parameters can be added this way
        multiPartEntity.addPart("fileDescription", new StringBody(
                fileDescription != null ? fileDescription : ""));
        multiPartEntity.addPart("fileName", new StringBody(
                fileName != null ? fileName : file.getName()));

        /*
         * Need to construct a FileBody with the file that needs to be
         * attached and specify the mime type of the file. Add the fileBody
         * to the request as an another part. This part will be considered
         * as file part and the rest of them as usual form-data parts
         */
        FileBody fileBody = new FileBody(file, "application/octect-stream");
        multiPartEntity.addPart("attachment", fileBody);

        // multiPartEntity.addPart("path", Charset.forName("UTF-8"));

        postRequest.setEntity(multiPartEntity);
    } catch (UnsupportedEncodingException ex) {
        ex.printStackTrace();
    }

    return executeRequest(postRequest);
}

private static String executeRequest(HttpRequestBase requestBase) {
    String responseString = "";

    InputStream responseStream = null;
    HttpClient client = new DefaultHttpClient();
    try {
        System.out.println("LISTO PARA ENVIAR A" + requestBase.getURI());
        HttpResponse response = client.execute(requestBase);
        if (response != null) {
            HttpEntity responseEntity = response.getEntity();

            if (responseEntity != null) {
                responseStream = responseEntity.getContent();
                if (responseStream != null) {
                    BufferedReader br = new BufferedReader(
                            new InputStreamReader(responseStream));
                    String responseLine = br.readLine();
                    String tempResponseString = "";
                    while (responseLine != null) {
                        tempResponseString = tempResponseString
                                + responseLine
                                + System.getProperty("line.separator");
                        responseLine = br.readLine();
                    }
                    br.close();
                    if (tempResponseString.length() > 0) {
                        responseString = tempResponseString;
                    }
                }
            }
        }
    } catch (UnsupportedEncodingException e) {
        e.printStackTrace();
    } catch (ClientProtocolException e) {
        e.printStackTrace();
    } catch (IllegalStateException e) {
        e.printStackTrace();
    } catch (IOException e) {
        e.printStackTrace();
    } finally {
        if (responseStream != null) {
            try {
                responseStream.close();
            } catch (IOException e) {
                e.printStackTrace();
            }
        }
    }
    client.getConnectionManager().shutdown();

    return responseString;
} 
```

它有什么问题？

小程序使用java 1.6，httpclient-4.1.3.jar 签名和编译

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-12T00:33:18.103

对于那些有这个问题的人，解决方案在这里[http://hc.apache.org/httpcomponents-client-ga/tutorial/html/connmgmt.html#d5e571](http://hc.apache.org/httpcomponents-client-ga/tutorial/html/connmgmt.html#d5e571)获取 JRE 代理。

```
DefaultHttpClient client = new DefaultHttpClient () ;
ProxySelectorRoutePlanner routePlanner = new ProxySelectorRoutePlanner(
                client.getConnectionManager().getSchemeRegistry(), 
                ProxySelector.getDefault());  
client.setRoutePlanner(routePlanner);
HttpResponse response = client.execute(requestBase) ; 
```

然后我签署了所有图书馆 `httpcore-4.2.3.jar`，`httpmime-4.2.3.jar`并且`httpclient-4.2.3.jar`。

# javascript - 当输入类型=“文件”被隐藏时，如何表示该文件已被选中？

> ID：15952951
> 
> 赞同：0
> 
> 时间：2013-04-11T15:33:26.777
> 
> 标签：javascript, html, forms, input

我已经对我的文件输入表单进行了一些样式设置，以便它看起来表单的其余部分看起来如何，一切工作正常，但我只是注意到你无法判断何时选择了文件。有没有办法可以设置`<p>`我用作掩码的标签来显示给定的文件名/路径？下面是我使用的代码的 js fiddle。

[**演示**](http://jsfiddle.net/6xATE/1)

出于某种奇怪的原因..即使我已经复制了代码，它也无法在小提琴中工作..无论如何，有没有办法在“选择曲目：”字段中显示所选曲目？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T15:50:04.267

只需这样做：（[jsFiddle](http://jsfiddle.net/6xATE/3/)）

```
$('.fileinput').change(function() {
    $('.fileInputMask').text($(this).val());
}); 
```

# ios - UICollectionViewCell 中的 UITableView

> ID：15952955
> 
> 赞同：1
> 
> 时间：2013-04-11T15:33:37.753
> 
> 标签：ios, uitableview, uicollectionview, uicollectionviewcell

我有一个`UICollectionView`其所有单元格都包含一个`UITableView`. 我的`UICollectionView`委托/数据源方法由视图控制器（假设`TTCollectionViewController`）处理，并由( )`tableViews`直接处理。`collection view cells``TTCollectionViewCell`

为了更改一些标签颜色，我需要跟踪我的 tableViews 上的每个选定行，所以我做了类似的事情：

```
//
// TTCollectionViewCell.m
//
[...]
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
    // keep track of selected drugs
    if (![self.selectedDrugIndexPaths containsObject:indexPath])
    {
        [self.selectedDrugIndexPaths addObject:indexPath];
    }
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {
        TTTableViewCell *contentCell = [tableView dequeueReusableCellWithIdentifier:@"test"];
        if (contentCell == nil)
            contentCell = [[TTTableViewCell alloc] init];

        [...]

        // test
        if ([self.selectedDrugIndexPaths containsObject:indexPath]) {
            contentCell.drugLabel.textColor = [UIColor grayColor];
        } else {
            contentCell.drugLabel.textColor = [UIColor blackColor];
        }
}
[...] 
```

但事情是这样的：使用 dequeue 可重用的东西，我`collectionView`搞砸了我的所有曲目（例如，在滚动时，表 1 上的选定行在表 3 上被选中）。

我知道不使用是个坏主意`dequeuereusable`（我什至不知道是否可以不使用它），但是我可以做类似的事情吗？

有没有人已经实施过这种案例？

提前谢谢。

编辑 ：

这`cellForRow...`是您要求的我的collectionView的方法：

```
///
/// TTCollectionController.m
///
- (UICollectionViewCell *)collectionView:(UICollectionView *)collectionView cellForItemAtIndexPath:(NSIndexPath *)indexPath
{
    TTCollectionCell *cell = [collectionView dequeueReusableCellWithReuseIdentifier:@"cell" forIndexPath:indexPath];

    cell.data = [self.data objectAtIndex:indexPath.row];

    return cell;
} 
```

# entity-framework - 使用 Linq 选择与列表匹配的表项

> ID：15952959
> 
> 赞同：0
> 
> 时间：2013-04-11T15:33:47.777
> 
> 标签：entity-framework, c#-4.0, linq-to-entities

我有一个“字符串，DeviceInfo”字典，其中 DeviceInfo 是一个包含一些属性的类，如下所示：

```
 public string Name { get; set; }
    public string Id { get; set; }
    public bool Actioned { get; set; } 
```

我需要使用 Linq to Entities 从表中选择设备详细信息，其中表中的 deviceId 存在于字典中的 DeviceInfo“名称”属性中。像下面这样的东西是我所追求的。不幸的是，我的代码不起作用。有人告诉我我要去哪里错了吗？

```
from t in _context.Devices where list.Select(x => x.Value.Name).Contains(t.DeviceId) select t 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T18:16:53.220

使用字典中的 s`List<string>`变得简单：`Name`

```
var names = list.Select(x => x.Value.Name).ToList(); 
```

然后在您的 LINQ to Entities 查询中使用它：

```
from t in _context.Devices
where names.Contains(t.DeviceId)
select t 
```

或者`SqlFunctions.StringConvert`如果你的`DeviceId`is 和`int`：

```
from t in _context.Devices
where names.Contains(SqlFunctions.StringConvert((double)t.DeviceId))
select t 
```

它应该`IN`在 SQL 查询中生成语句。

# mysql - 用于用户和组访问控制的 MySQL 数据库模式

> ID：15952963
> 
> 赞同：9
> 
> 时间：2013-04-11T15:33:55.893
> 
> 标签：mysql, access-control

几天来，我一直试图找到解决这个问题的方法，但我似乎无法想出可行的方法。问题如下：

我目前正在开发一个统计工具，它显示了几个应用程序的一些图表和数据。显然需要限制对这些数据的访问，因为用户 A 拥有应用程序“一”和“二”，并且不能看到“三”或“四”。

现在，每个用户可以是多个组的成员并从该组继承权限，但也可以拥有单独的权限。必须为每个应用程序设置这些权限。在以下情况下，授予对一个应用程序的一组数据的访问权限：

*   用户本人有权访问本应用的这条数据
*   用户所属的任何一个组都有权访问该应用程序的这条数据

![http://i.stack.imgur.com/y4W6E.png](https://i.stack.imgur.com/Cdx25.png)

目标是拥有一个表，该表存储每个用户当前对每个应用程序拥有的实际权限，根据组成员资格和个人权限计算得出，并且由于与其他表的关系，该信息始终保持一致。

我不知道这是否有助于找到解决方案，但这是获取 id 为 1 的用户当前活动权限的 SQL：

```
(
SELECT u.perm_id AS perm, u.user_id AS uid, u.app_id AS app
FROM daUsers_has_daPermissions AS u
WHERE u.user_id = 1
)
UNION
(
SELECT g.perm_id AS perm, u.user_id AS uid, g.app_id AS app
FROM daUsers_has_daPermissions AS u, daUsergroup_has_daPermissions AS g, daUsergroup_has_daUsers AS g_has_u
WHERE u.user_id = 1
AND u.user_id = g_has_u.user_id
AND g.group_id = g_has_u.group_id
); 
```

这就是我想要存储在额外表中的内容（仅适用于所有用户）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-12T06:48:42.273

在我看来，您应该使用视图。您已经有了查询，使用查询来创建视图。

# jquery - 使用 jquery 1.9 显示隐藏的 inline-block 元素

> ID：15952965
> 
> 赞同：1
> 
> 时间：2013-04-11T15:33:58.960
> 
> 标签：jquery, show, hidden

如果隐藏块是 css: inline-block，我在显示隐藏块时遇到问题。

```
div.profile{
    display: inline-block;
}

<div class='profile' style='display: none;'>profile info</div> 
```

但是当我做 $('.profile').show() 它变成 style='display: block' （我可以在萤火虫中看到它）并覆盖我的css风格......

我怎样才能解决这个问题？

顺便说一句，在 jquery 1.4 中它可以正常工作。

谢谢。

UPD

$.css('display', 'inline-block'), imo 不是通用解决方案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-11T15:35:12.253

您应该更改 css 样式而不是使用将`show`其更改为`block`.

```
$('.profile').css('display', 'inline-block'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T15:35:38.387

```
$('.profile').css('display', 'inline-block') 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-11T15:38:45.870

虽然`inline-block`在这种情况下将其显式设置为有效，但理想情况下，您应该将其设置`''`为应用来自 CSS 的任何内容，be it`inline`或`inline-block`or`block`

```
$('.profile').css('display', ''); // switch it back to whats specified in the CSS 
```

# html - 如何将样式表的内容包含在 ?</a></h1> <div class="ml12 aside-cta flex--item print:d-none sm:ml0 sm:mb12 sm:order-first sm:as-end"> <a href="https://stackoverflow.com/questions/ask" target="_blank" class="ws-nowrap s-btn s-btn__primary">问问题</a></div> </div> <div class="d-flex fw-wrap pb8 mb16 bb bc-black-075"> <div class="flex--item ws-nowrap mr16 mb8"> <span class="fc-light mr2"></span> </div> <div class="flex--item ws-nowrap mr16 mb8" title="2022-04-17 15:46:40Z"> <span class="fc-light mr2">问问题</span> <time itemprop="dateCreated" datetime="2013-04-11T15:34:06.880">2013-04-11T15:34:06.880</time> </div> <div class="flex--item ws-nowrap mb8" title="Viewed 6 times"> <span class="fc-light mr2"></span> 219 次 </div> </div> <div id="mainbar" role="main" aria-label="question and answers"> <div class="question" data-questionid="4" data-position-on-page="0" data-score="763" id="question"> <div class="post-layout"> <div class="votecell post-layout--left"> <div class="js-voting-container d-flex jc-center fd-column ai-stretch gs4 fc-black-200" data-post-id="4"> <button class="js-vote-up-btn flex--item s-btn s-btn__unset c-pointer " data-controller="s-tooltip" data-s-tooltip-placement="right" aria-pressed="false" aria-label="Up vote" data-selected-classes="fc-theme-primary" data-unselected-classes="" aria-describedby="--stacks-s-tooltip-peeufs8c"> <svg aria-hidden="true" class="svg-icon iconArrowUpLg" width="36" height="36" viewBox="0 0 36 36"><path d="M2 25h32L18 9 2 25Z"></path></svg> </button> <div id="--stacks-s-tooltip-peeufs8c" class="s-popover s-popover__tooltip pe-none" aria-hidden="true" role="tooltip">This question shows research effort; it is useful and clear<div class="s-popover--arrow"></div></div> <div class="js-vote-count flex--item d-flex fd-column ai-center fc-black-500 fs-title" itemprop="upvoteCount" data-value=""> 3 </div> <button class="js-vote-down-btn flex--item s-btn s-btn__unset c-pointer " data-controller="s-tooltip" data-s-tooltip-placement="right" aria-pressed="false" aria-label="Down vote" data-selected-classes="fc-theme-primary" data-unselected-classes="" aria-describedby="--stacks-s-tooltip-04106eqn"> <svg aria-hidden="true" class="svg-icon iconArrowDownLg" width="36" height="36" viewBox="0 0 36 36"><path d="M2 11h32L18 27 2 11Z"></path></svg> </button><div id="--stacks-s-tooltip-04106eqn" class="s-popover s-popover__tooltip pe-none" aria-hidden="true" role="tooltip">This question does not show any research effort; it is unclear or not useful<div class="s-popover--arrow"></div></div> <div id="--stacks-s-tooltip-tgvwendx" class="s-popover s-popover__tooltip pe-none" aria-hidden="true" role="tooltip">Bookmark this question.<div class="s-popover--arrow"></div></div> <a class="js-post-issue flex--item s-btn s-btn__unset c-pointer py6 mx-auto" data-shortcut="T" data-ks-title="timeline" data-controller="s-tooltip" data-s-tooltip-placement="right" aria-label="Timeline" aria-describedby="--stacks-s-tooltip-abwmy15k"><svg aria-hidden="true" class="mln2 mr0 svg-icon iconHistory" width="19" height="18" viewBox="0 0 19 18"><path d="M3 9a8 8 0 1 1 3.73 6.77L8.2 14.3A6 6 0 1 0 5 9l3.01-.01-4 4-4-4h3L3 9Zm7-4h1.01L11 9.36l3.22 2.1-.6.93L10 10V5Z"></path></svg></a><div id="--stacks-s-tooltip-abwmy15k" class="s-popover s-popover__tooltip pe-none" aria-hidden="true" role="tooltip">Show activity on this post.<div class="s-popover--arrow"></div></div> </div> </div> <div class="postcell post-layout--right"> <div class="s-prose js-post-body" itemprop="text"> <p>I have a JSF 2.0 page that uses this:</p>&#xA;&#xA;<pre><code>&lt;h:head&gt;&#xA;&lt;h:outputStylesheet name="screen.css" library="css" /&gt;&#xA;&lt;/h:head&gt;&#xA;</code></pre>&#xA;&#xA;<p>Which very nicely generates this HTML:</p>&#xA;&#xA;<pre><code>&lt;head&gt;&#xA;&lt;link type="text/css" rel="stylesheet" &#xA; href="/myapp/javax.faces.resource/screen.css.jsf?ln=css" /&gt;&#xA;&lt;/head&gt;&#xA;</code></pre>&#xA;&#xA;<p>This is great when the page is being viewed in a browser. However, I want to use this stylesheet embedded in an HTML page that will be emailed to the user. I don't want their email client to load the stylesheet from the server. I want the document emailed to them to be self-sufficient and not be influenced by changes in (or even the absence of) the stylesheet on the website.</p>&#xA;&#xA;<p>I want the HTML output to be like this:</p>&#xA;&#xA;<pre><code>&lt;head&gt;&#xA;&lt;style type="text/css"&gt;&#xA; ...contents of screen.css here...&#xA;&lt;/style&gt;&#xA;&lt;/head&gt;&#xA;</code></pre>&#xA;&#xA;<p>I tried to achieve that by using this:</p>&#xA;&#xA;<pre><code>&lt;h:head&gt;&#xA;&lt;style type="text/css"&gt;&#xA;&lt;ui:include src="/resources/css/screen.css"&gt;&lt;/ui:include&gt;&#xA;&lt;/style&gt;&#xA;&lt;/h:head&gt;&#xA;</code></pre>&#xA;&#xA;<p>But I received this error:</p>&#xA;&#xA;<pre><code>javax.servlet.ServletException: Error Parsing /resources/css/screen.css: &#xA;Error Traced[line: 1] Content is not allowed in prolog.&#xA;javax.faces.webapp.FacesServlet.service(FacesServlet.java:325)&#xA;</code></pre>&#xA;&#xA;<p>How can I get the contents of the stylesheet to appear in the head of the document?</p>&#xA; </div> <div class="mt24 mb12"> <div class="post-taglist d-flex gs4 gsy fd-column"> <div class="d-flex ps-relative fw-wrap"> <a href="/tags/html" class="post-tag js-gps-track" title="show questions tagged 'html'" rel="tag">html</a><a href="/tags/css" class="post-tag js-gps-track" title="show questions tagged 'css'" rel="tag">css</a><a href="/tags/jsf" class="post-tag js-gps-track" title="show questions tagged 'jsf'" rel="tag">jsf</a><a href="/tags/jsf-2" class="post-tag js-gps-track" title="show questions tagged 'jsf-2'" rel="tag">jsf-2</a> </div> </div> </div> </div> <span class="d-none" itemprop="commentCount">4</span> </div> </div> <div class="js-zone-container zone-container-responsive"> <div id="dfp-isb" class="everyonelovesstackoverflow everyoneloves__inline-sidebar mx-auto" style="min-height: auto; height: auto; display: none;"></div> <div class="js-report-ad-button-container mx-auto" style="width: 300px"></div> </div> <div id="answers"> <a name="tab-top"></a> <div id="answers-header"> <div class="answers-subheader d-flex ai-center mb8"> <div class="flex--item fl1"> <h2 class="mb0" data-answercount=""> 1 回答 <span style="display:none;" itemprop="answerCount">1</span> </h2> </div> </div> </div> <a name="7"></a> <div id="answer-7" class="answer js-answer accepted-answer" data-answerid="7" data-parentid="4" data-score="506" data-position-on-page="1" data-highest-scored="1" data-question-has-accepted-highest-score="1" itemprop="suggestedAnswer" itemscope="" itemtype="https://schema.org/Answer"> <div class="post-layout"> <div class="votecell post-layout--left"> <div class="js-voting-container d-flex jc-center fd-column ai-stretch gs4 fc-black-200" data-post-id="7"> <button class="js-vote-up-btn flex--item s-btn s-btn__unset c-pointer " data-controller="s-tooltip" data-s-tooltip-placement="right" aria-pressed="false" aria-label="Up vote" data-selected-classes="fc-theme-primary" data-unselected-classes="" aria-describedby="--stacks-s-tooltip-dgvag2l3"> <svg aria-hidden="true" class="svg-icon iconArrowUpLg" width="36" height="36" viewBox="0 0 36 36"><path d="M2 25h32L18 9 2 25Z"></path></svg> </button><div id="--stacks-s-tooltip-dgvag2l3" class="s-popover s-popover__tooltip pe-none" aria-hidden="true" role="tooltip">This answer is useful<div class="s-popover--arrow"></div></div> <div class="js-vote-count flex--item d-flex fd-column ai-center fc-black-500 fs-title" itemprop="upvoteCount" data-value="5"> 5 </div> <button class="js-vote-down-btn flex--item s-btn s-btn__unset c-pointer " data-controller="s-tooltip" data-s-tooltip-placement="right" aria-pressed="false" aria-label="Down vote" data-selected-classes="fc-theme-primary" data-unselected-classes="" aria-describedby="--stacks-s-tooltip-gn8ppsfv"> <svg aria-hidden="true" class="svg-icon iconArrowDownLg" width="36" height="36" viewBox="0 0 36 36"><path d="M2 11h32L18 27 2 11Z"></path></svg> </button> </div> </div> <div class="answercell post-layout--right"> <div class="s-prose js-post-body" itemprop="text"> <p>不适用于标准 JSF 组件。</p> <p>JSF 实用程序库<a href="http://omnifaces.org" rel="nofollow">OmniFaces</a>的<a href="http://showcase.omnifaces.org/components/resourceInclude" rel="nofollow"><code>&lt;o:resourceInclude&gt;</code></a>目的是在 JSF 页面中包含非 JSF webapp 资源的原始输出。</p> <pre><code>&lt;h:head&gt; &lt;style type="text/css"&gt; &lt;o:resourceInclude path="/resources/css/screen.css" /&gt; &lt;/style&gt; &lt;/h:head&gt; </code></pre> <p>请注意，这不支持资源本地化和版本控制，也不像之前那样评估 CSS 文件中的 EL 表达式<code>&lt;h:outputStylesheet&gt;</code>。</p> </div> <div class="mt24"> <div class="user-action-time" style="color:#999;text-align:right;">于 2013-04-11T15:40:26.183 回答</div> </div> </div> </div> </div></div> </div> <div id="sidebar" class="show-votes" role="complementary" aria-label="sidebar"> <div class="module sidebar-related"> <h4 id="h-related">Related</h4> <div class="related js-gps-related-questions" data-tracker="rq=1"> <div class="spacer"> <a href="/questions/13663774" title="Question score (upvotes - downvotes)"> <div class="answer-votes large">1</div> </a> <a href="/questions/13663774" class="question-hyperlink">c++ - 向量到 const uint16_t * 类型</a> </div><div class="spacer"> <a href="/questions/13663782" title="Question score (upvotes - downvotes)"> <div class="answer-votes large">3</div> </a> <a href="/questions/13663782" class="question-hyperlink">ios - 本机 ios 和 android 中 signalR 的客户端</a> </div><div class="spacer"> <a href="/questions/13663788" title="Question score (upvotes - downvotes)"> <div class="answer-votes large">1</div> </a> <a href="/questions/13663788" class="question-hyperlink">security - 使用手头的加密和未加密文件恢复 AES 加密密钥</a> </div><div class="spacer"> <a href="/questions/13663792" title="Question score (upvotes - downvotes)"> <div class="answer-votes large">5</div> </a> <a href="/questions/13663792" class="question-hyperlink">c# - 在 JavaScript / TypeScript 中实现 IEnumerable</a> </div><div class="spacer"> <a href="/questions/13663796" title="Question score (upvotes - downvotes)"> <div class="answer-votes large">2</div> </a> <a href="/questions/13663796" class="question-hyperlink">.htaccess - htaccess 重定向和 ExpressionEngine</a> </div><div class="spacer"> <a href="/questions/13663798" title="Question score (upvotes - downvotes)"> <div class="answer-votes large">1</div> </a> <a href="/questions/13663798" class="question-hyperlink">core-data - 从分支到主干的核心数据迁移</a> </div><div class="spacer"> <a href="/questions/13663804" title="Question score (upvotes - downvotes)"> <div class="answer-votes large">1</div> </a> <a href="/questions/13663804" class="question-hyperlink">iphone - 与 CAEmitterLayer 一起使用的代码问题</a> </div><div class="spacer"> <a href="/questions/13663811" title="Question score (upvotes - downvotes)"> <div class="answer-votes large">2</div> </a> <a href="/questions/13663811" class="question-hyperlink">assembly - 为什么 MS-DOS 不初始化 DS 和 ES 寄存器？</a> </div><div class="spacer"> <a href="/questions/13663814" title="Question score (upvotes - downvotes)"> <div class="answer-votes large">1</div> </a> <a href="/questions/13663814" class="question-hyperlink">c++ - 如何访问 32 位寄存器数组和读/写 16 位上下段作为单独的操作</a> </div><div class="spacer"> <a href="/questions/13663815" title="Question score (upvotes - downvotes)"> <div class="answer-votes large">1</div> </a> <a href="/questions/13663815" class="question-hyperlink">ios6 - 带有 RestKit 0.10.1 和简单返回类型的 HTTP PUT</a> </div> </div> </div> <div class="module js-gps-related-tags" id="related-tags"> <h4 id="h-related-tags">Reference</h4> <div data-name="javascript"> <a href="https://php.github.net.cn" class="post-tag no-tag-menu js-gps-track" target="_blank">php</a>&nbsp;<span class="item-multiplier"><span class="item-multiplier-x">×</span>&nbsp;<span class="item-multiplier-count">1429865</span> </span> </div> <div data-name="javascript"> <a href="https://c-cpp.com" class="post-tag no-tag-menu js-gps-track" target="_blank">c/c++</a>&nbsp;<span class="item-multiplier"><span class="item-multiplier-x">×</span>&nbsp;<span class="item-multiplier-count">756500</span> </span> </div> <div data-name="javascript"> <a href="https://nginx.github.net.cn" class="post-tag no-tag-menu js-gps-track" target="_blank">nginx</a>&nbsp;<span class="item-multiplier"><span class="item-multiplier-x">×</span>&nbsp;<span class="item-multiplier-count">49975</span> </span> </div> <div data-name="javascript"> <a href="https://mongodb.net.cn" class="post-tag no-tag-menu js-gps-track" target="_blank">mongodb</a>&nbsp;<span class="item-multiplier"><span class="item-multiplier-x">×</span>&nbsp;<span class="item-multiplier-count">159057</span> </span> </div> <div data-name="javascript"> <a href="https://mybatis.net.cn" class="post-tag no-tag-menu js-gps-track" target="_blank">mybatis</a>&nbsp;<span class="item-multiplier"><span class="item-multiplier-x">×</span>&nbsp;<span class="item-multiplier-count">3233</span> </span> </div> <div data-name="javascript"> <a href="https://anaconda.org.cn" class="post-tag no-tag-menu js-gps-track" target="_blank">anaconda</a>&nbsp;<span class="item-multiplier"><span class="item-multiplier-x">×</span>&nbsp;<span class="item-multiplier-count">13410</span> </span> </div> <div data-name="javascript"> <a href="https://pycharm.net.cn" class="post-tag no-tag-menu js-gps-track" target="_blank">pycharm</a>&nbsp;<span class="item-multiplier"><span class="item-multiplier-x">×</span>&nbsp;<span class="item-multiplier-count">14671</span> </span> </div> <div data-name="javascript"> <a href="https://python.github.net.cn" class="post-tag no-tag-menu js-gps-track" target="_blank">python</a>&nbsp;<span class="item-multiplier"><span class="item-multiplier-x">×</span>&nbsp;<span class="item-multiplier-count">1902243</span> </span> </div> <div data-name="javascript"> <a href="https://vscode.github.net.cn" class="post-tag no-tag-menu js-gps-track" target="_blank">vscode</a>&nbsp;<span class="item-multiplier"><span class="item-multiplier-x">×</span>&nbsp;<span class="item-multiplier-count">56040</span> </span> </div> <div data-name="javascript"> <a href="https://dockerdocs.cn" class="post-tag no-tag-menu js-gps-track" target="_blank">docker</a>&nbsp;<span class="item-multiplier"><span class="item-multiplier-x">×</span>&nbsp;<span class="item-multiplier-count">110988</span> </span> </div> <div data-name="javascript"> <a href="https://github.net.cn" class="post-tag no-tag-menu js-gps-track" target="_blank">github</a>&nbsp;<span class="item-multiplier"><span class="item-multiplier-x">×</span>&nbsp;<span class="item-multiplier-count">49000</span> </span> </div> <div data-name="javascript"> <a href="https://flask.github.net.cn" class="post-tag no-tag-menu js-gps-track" target="_blank">flask</a>&nbsp;<span class="item-multiplier"><span class="item-multiplier-x">×</span>&nbsp;<span class="item-multiplier-count">49129</span> </span> </div> <div data-name="javascript"> <a href="https://ffmpeg.github.net.cn" class="post-tag no-tag-menu js-gps-track" target="_blank">ffmpeg</a>&nbsp;<span class="item-multiplier"><span class="item-multiplier-x">×</span>&nbsp;<span class="item-multiplier-count">24037</span> </span> </div> <div data-name="javascript"> <a href="https://jmeter.net" class="post-tag no-tag-menu js-gps-track" target="_blank">jmeter</a>&nbsp;<span class="item-multiplier"><span class="item-multiplier-x">×</span>&nbsp;<span class="item-multiplier-count">16910</span> </span> </div> <div data-name="javascript"> <a href="https://matplotlib.net" class="post-tag no-tag-menu js-gps-track" target="_blank">matplotlib</a>&nbsp;<span class="item-multiplier"><span class="item-multiplier-x">×</span>&nbsp;<span class="item-multiplier-count">63493</span> </span> </div> <div data-name="javascript"> <a href="https://getbootstrap.net" class="post-tag no-tag-menu js-gps-track" target="_blank">bootstrap</a>&nbsp;<span class="item-multiplier"><span class="item-multiplier-x">×</span>&nbsp;<span class="item-multiplier-count">54641</span> </span> </div> </div> </div> </div> </div> </div> </div> <footer id="footer" class="site-footer js-footer" role="contentinfo"> <div class="site-footer--container"> <div class="site-footer--logo"> <a href="https://stackoverflow.com"><svg aria-hidden="true" class="native svg-icon iconLogoGlyphMd" width="32" height="37" viewBox="0 0 32 37"><path d="M26 33v-9h4v13H0V24h4v9h22Z" fill="#BCBBBB"/><path d="m21.5 0-2.7 2 9.9 13.3 2.7-2L21.5 0ZM26 18.4 13.3 7.8l2.1-2.5 12.7 10.6-2.1 2.5ZM9.1 15.2l15 7 1.4-3-15-7-1.4 3Zm14 10.79.68-2.95-16.1-3.35L7 23l16.1 2.99ZM23 30H7v-3h16v3Z" fill="#F48024"/></svg></a> </div> <nav class="site-footer--nav"> <div class="site-footer--col"> <h5 class="-title"><a href="https://stackoverflow.org.cn" class="js-gps-track" data-gps-track="footer.click({ location: 3, link: 15})">Stack Overflow 中文网</a></h5> <p>遵从 CC BY-SA 知识共享许可协议。</p> </div> </nav> </div> </footer> <script> var _hmt = _hmt || []; (function() { var hm = document.createElement("script"); hm.src = "https://hm.baidu.com/hm.js?709ff2ad9744e86b5b0eee677fc13ede"; var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s); })(); </script> <!-- Google tag (gtag.js) --> <script async src="https://www.googletagmanager.com/gtag/js?id=G-1MW5BV8G8E"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-1MW5BV8G8E'); </script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6117966252207595" crossorigin="anonymous"></script> </body> </html>

> ID：15952968
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

# sql - 2 forms, 1 page - WebMatrix/Razor

> ID：15952971
> 
> 赞同：1
> 
> 时间：2013-04-11T15:34:11.083
> 
> 标签：sql, post, razor, http-post, webmatrix

i want to have 2 forms on one page, an each one updates different data in my database. How do i get one Submit Button to run one UPDATE query, and the other form to run another?

I've created a test page, but i'm having no luck. I'm guessing i need to name each form, and then create 2 if(ispost) statements for each one?

Here's what i have so far:

```
@{
Layout = "~/_template1.cshtml";
Page.Title = "Add Property";

var db = Database.Open("StayInFlorida");

var propertyinfo = "SELECT * FROM PropertyInfo WHERE PropertyID='8'";
var propinfo = db.QuerySingle(propertyinfo);

if (IsPost){
    var form1 = "UPDATE PropertyInfo SET PropertyName = @0, PropertyWebSite = @1 WHERE PropertyID='8'";
    db.Execute(form1, Request["PropertyName"], Request["PropertyWebsite"]);
}
if (IsPost){
    var form2 = "UPDATE PropertyInfo SET NumBedrooms = @0, NumBathrooms = @1 WHERE PropertyID='8'";
    db.Execute(form2, Request["NumBedrooms"], Request["NumBathrooms"]);
}
}

<hr>
<div class="tabbable">
<ul class="nav nav-tabs">
    <li class="active"><a href="#tab1" data-toggle="tab">Tab1</a></li>
    <li><a href="#tab2" data-toggle="tab">tab2</a></li>
</ul>

<!--Tab Content-->
<div class="tab-content">

<div id="tab1" class="tab-pane active">
<form method="post" action="">
<fieldset>
<label>Property Name:</label>
<input class="input-xlarge" type="text" name="PropertyName" placeholder=".input-xlarge" value="@propinfo.PropertyName">
<br>
<label>Property Website:</label>
<input class="input-xlarge" type="text" name="PropertyWebsite" placeholder=".input-xlarge" value="@propinfo.PropertyWebsite">
<br>
<button type="submit" class="btn btn-success">Update</button>
</fieldset>
</form>
</div>

<div id="tab2" class="tab-pane">
<form method="post" action="">
<fieldset>
<label>Number of Bedrooms:</label>
<input class="input-xlarge" type="text" name="NumBedrooms" placeholder=".input-xlarge" value="@propinfo.NumBedrooms">
<br>
<label>Number of Bathrooms:</label>
<input class="input-xlarge" type="text" name="NumBathrooms" placeholder=".input-xlarge" value="@propinfo.NumBathrooms">
<br>
<button type="submit" class="btn btn-success">Update</button>
</fieldset>
</form>
</div>
</div>
</div>

<hr> 
```

Thanks, Gavin

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T15:46:34.243

为每个按钮添加一个名称属性以及一个值，例如：

```
<button type="submit" class="btn btn-success" name="Action" value="Update1">Update</button> 
```

然后检查服务器代码是点击了哪一个：

```
if (Request["Action"] == "Update1"){
    //button 1 was clicked
} 
```

# sql - Is it possible to group unlike items and count them together?

> ID：15952977
> 
> 赞同：1
> 
> 时间：2013-04-11T15:34:42.320
> 
> 标签：sql, ms-access

Given the following table:

```
Chain    Name
123      Company 1
124      Other Company 1
123      Whatever Company
125      This One
126      That One
125      Another One
127      Last One 
```

I get the following results when I do a `Count` on the Chain column:

```
123      2
124      1
125      2
126      1
127      1 
```

Is it possible to group Chain 123 and 124 so they're counted together? Also group 125 and 126? The modified results would look like this:

```
123/124  3
125/126  3
127      1 
```

My SQL looks like this:

```
SELECT Table1.Chain, Count(*) as [Count]
FROM Table1 LEFT JOIN Table2 on Table1.Chain = Table2.Chain
WHERE (((Table1.Chain) IN (Table2.Chain)))
GROUP BY Table1.Chain
ORDER BY Table1.Chain; 
```

Thank you!

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-11T15:48:00.910

根据您的需要，这可能有点小技巧，但我可能会添加一个表来存储您正在寻找的 Chain 和 ChainGroup。像这样的东西：

```
Chain  ChainGroup
123      123/124
124      123/124
125      125/126
126      125/126
127      127/128 
```

然后，在查询中，我将加入该表，而不是按 Chain 分组，而是按 ChainGroup 分组。

我更喜欢嵌套 IIF 语句之类的东西，因为它们很难调试，而且将来您可能会有额外的分组，这些分组很容易添加到表中，并且新分组会自动出现在查询中.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-11T15:45:17.923

是的你可以：

```
SELECT min(Table1.Chain) & '/' & max(Table1.Chain) as chain, Count(*) as [Count]
FROM Table1 LEFT JOIN Table2 on Table1.Chain = Table2.Chain
WHERE (((Table1.Chain) IN (Table2.Chain)))
GROUP BY int((Table1.Chain-1)/2)
ORDER BY min(Table1.Chain); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-11T15:39:57.047

您可以使用嵌套`Iif`语句。希望我的括号都在下面！:-)

```
SELECT Iif(Table1.Chain="123", "123/124",
         Iif(Table1.Chain="124", "123/124",
           Iif(Table1.Chain="125", "125/126",
             Iif(Table1.Chain="126", "125/126", Table1.Chain)))) as [Chain]
 , Count(*) as [Count]
FROM Table1 LEFT JOIN Table2 on Table1.Chain = Table2.Chain
WHERE (((Table1.Chain) IN (Table2.Chain)))
GROUP BY Iif(Table1.Chain="123", "123/124",
           Iif(Table1.Chain="124", "123/124",
             Iif(Table1.Chain="125", "125/126",
               Iif(Table1.Chain="126", "125/126", Table1.Chain))))
ORDER BY Table1.Chain; 
```

如果您不想在查询中写两次，您也可以将`case`语句移动到子句中的子查询或公用表表达式中。`from`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-11T16:02:30.353

考虑类似的事情：

```
SELECT
chain_group, COUNT(*) FROM (
SELECT 
Table1.Chain, 
switch(Table1.Chain IN("123","124"), "123/124",
Table1.Chain IN("125","126"),"125/126",
Table1.Chain) AS chain_group
FROM 
Table1 INNER JOIN 
Table2 ON 
Table1.Chain = Table2.Chain) t
GROUP BY chain_group
ORDER BY chain_group 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-11T16:33:28.247

您可以看到以下示例 ----- 制作主表

```
CREATE TABLE #test 
( id int , Name varchar(100))

INSERT #test(id,Name)
values (123,'Company 1'),
(124,'Other Company 1'),
(123,      'Whatever Company'),
(125,      'This One'),
(126 ,     'That One'),
(125,      'Another One'),
(127,      'Last One')

CREATE TABLE #temp
(rowID INT IDENTITY(1,1) , ID INT ,cnt INT )

CREATE TABLE #tempResult
(ID VARCHAR(20) ,cnt INT )

INSERT INTO #temp(ID,cnt)
SELECT  ID ,COUNT(1) cnt FROM  #test GROUP BY ID 

DECLARE @rowCnt INT , @TotalCnt INT , @even INT , @odd INT , 
@idNum VARCHAR(20) , @valueCnt INT , @inStart INT = 1

SET @rowCnt  = 1
SET @even = 1 
SET @odd = 2

SELECT @TotalCnt = COUNT(1) FROM #temp

WHILE @rowCnt <= @TotalCnt
BEGIN
    SET @inStart = 1
    SET @odd = @rowCnt 
    SET @even = @rowCnt + 1
    SET @idNum = ''
    SET @valueCnt = 0

    WHILE @inStart <= 2
    BEGIN

    IF @inStart = 1
    Begin
     SELECT @idNum = Convert(VARCHAR(5),ID) , @valueCnt = cnt 
     FROM #temp WHERE rowID = @odd
    End 
    ELSE
    BEGIN
    SELECT @idNum = @idNum + '/' + Convert(VARCHAR(5),ID) , @valueCnt = @valueCnt  + cnt 
FROM #temp WHERE rowID = @even  
    END
        SET @inStart = @inStart + 1
    END
    INSERT INTO #tempResult (ID, Cnt) 
    VALUES (@idNum,@valueCnt)

    SET @rowCnt = @rowCnt + 2
END

SELECT *
FROM #tempResult 
```

# c# - 无法加载文件或程序集，Oracle.DataAccess v 2.112.3.0

> ID：15952978
> 
> 赞同：3
> 
> 时间：2013-04-11T15:34:43.203
> 
> 标签：c#, oracle, .net-assembly

我在我的 win7 笔记本电脑上创建了 ac# 应用程序并将其传输到服务器上运行，但收到​​“无法加载文件或程序集 'Oracle.DataAccess，版本 = 2.112.3.0，文化 = 中性，PublicKeyToken = longnumber。

我查看了 WINDOWS/Assembly，确实看到 Oracle.DataAccess 具有相同的版本、文化和 publictokenkey。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-11T16:51:51.010

这是答案，从任何 cpu 更改为 x86，现在可以使用 [https://forums.oracle.com/forums/thread.jspa?messageID=10472469](https://forums.oracle.com/forums/thread.jspa?messageID=10472469)

# iphone - 在通用应用程序中获取主故事板

> ID：15952979
> 
> 赞同：7
> 
> 时间：2013-04-11T15:34:43.340
> 
> 标签：iphone, ios, ipad, storyboard, ios-universal-app

在一个通用项目中尝试我的手，我想通过故事板中的标识符加载一个 vc。有没有办法在访问情节提要时避免对成语进行显式检查。

这个丑陋的代码有效....

```
UIStoryboard *storyboard;

if (UI_USER_INTERFACE_IDIOM() == UIUserInterfaceIdiomPad) {
    storyboard = [UIStoryboard storyboardWithName:@"MainStoryboard_iPad" bundle:nil];
}
else {
    storyboard = [UIStoryboard storyboardWithName:@"MainStoryboard_iPhone" bundle:nil];
}

UIViewController *vc = [storyboard instantiateViewControllerWithIdentifier:@"MyViewController"]; 
```

但是很糟糕。字符串文字主情节提要很难看（不知道为什么项目不能保存主情节提要设置，以便应用程序可以说 [UIStoryboard mainStoryboard];），但是显式的成语检查是一个太过分的桥梁。

是否有任何隐藏的智能（类似于支持视网膜显示器的“@2x”图像后缀）可以清除此代码？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-04-11T15:46:16.127

假设您正在从另一个视图控制器中执行发布的代码，您始终可以通过 获取当前情节提要`[self storyboard]`，其中 self 是 UIViewController 的任何实例。

# c# - 字典作为带有复选框的列表

> ID：15952980
> 
> 赞同：0
> 
> 时间：2013-04-11T15:34:46.187
> 
> 标签：c#, wpf, checkbox, converter, itemscontrol

我正在尝试使用 CheckBoxes 实现 List，但是在将 Dictionary 的值绑定到`IsChecked`XAML 中的属性时遇到了一些问题。

我的列表模板：

XAML

```
<ItemsControl Name="lb" ItemsSource="{Binding Movies}" BorderThickness="0">
    <ItemsControl.Style>
        <Style TargetType="ItemsControl">
            <Setter Property="ItemsPanel">
                <Setter.Value>
                    <ItemsPanelTemplate>
                        <StackPanel Orientation="Horizontal"/>
                    </ItemsPanelTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </ItemsControl.Style>

    <ItemsControl.ItemTemplate>
        <DataTemplate>
            <Grid>
                <CheckBox Content="{Binding Key.MovieId}" IsChecked="{Binding Converter={StaticResource DictConvert}, ConverterParameter=Key}" Command="{Binding DummyCommand}"/>
            </Grid>
        </DataTemplate>
    </ItemsControl.ItemTemplate>
</ItemsControl> 
```

转换器

```
public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
{
    KeyValuePair<Movie, bool> bla = (KeyValuePair<Movie, bool>)value;
    var dict = value as Dictionary<Movie, bool>;
    List<KeyValuePair<Movie,bool>> list = new List<KeyValuePair<Movie, bool>>();
    list.Add(bla);
    dict = list.ToDictionary(k => k.Key, k => k.Value);

    if (dict != null)
    {
        return true;
    }

    throw new NotImplementedException();
} 
```

调试器点击了这个“return true”行，所以它应该可以工作，但我得到`XamlParseException`. 任何人都可以帮助我吗？，我试图创建 ObservableDictionary 但放弃了 - 这是唯一的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T15:45:53.660

我认为您不能`ConverterParameter`像尝试那样设置数据绑定值（语法也不正确）。将您的转换器重做为 a `IMultiValueConverter`，并将 Key 和 Value 作为单独的绑定传递，您应该一切顺利。

此外，删除`throw new NotImplementedException()`代码中的行 - 这将使其崩溃。

# email - 无法使用 javamail 检索文件名中带有空格的附件

> ID：15952982
> 
> 赞同：0
> 
> 时间：2013-04-11T15:34:50.510
> 
> 标签：email, jakarta-mail, content-type, email-attachments

当文件名中有空格且没有扩展名时，我在使用 javamail 下载附件时遇到问题。

这是由于 BodyPart 的内容类型。对于文件`example.pdf`，`example`我的内容类型分别等于 `APPLICATION/PDF; name=example.pdf` 和`APPLICATION/OCTET-STREAM; name=example`，而如果我有文件，`example 2`我有`APPLICATION/OCTET-STREAM;`. 这使我无法使用 javamail 检索文件。

这对我来说很奇怪，有人知道为什么吗？或者一些解决方法？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T03:59:24.307

我不知道“下载附件的问题”到底是什么意思。是否抛出异常？

如果消息格式正确，则文件名中的空格不应有任何区别。

如果消息的格式不正确（例如，“name”参数在包含空格时没有被引用），您可能需要设置一些属性来让 JavaMail 解决发送程序中的该错误。有关详细信息，请参阅 javax.mail.internet 包的 javadocs。

# ios - 离线时如何通过 FB App 分享链接

> ID：15952987
> 
> 赞同：0
> 
> 时间：2013-04-11T15:34:58.147
> 
> 标签：ios, objective-c, facebook-ios-sdk

我正在为 iPhone 开发一个移动应用程序。该应用程序将主要由在不同国家/地区度假的人使用，并且由于互联网流量的高成本，大部分时间将处于离线状态。

但是，我正在为其开发应用程序的公司希望用户能够在人们未连接到互联网时也能够使用“Facebook Share”功能。

它应该以他们单击应用程序中的共享链接按钮的方式工作，但随后会收到一条消息，表明他们处于离线状态，并且一旦他们再次在线，链接就会被共享。

我试图弄清楚如何做到这一点。我可以通过 fb:// 协议（或其他任何方式）将我想要分享的链接传递给官方 FB 应用程序，并且 FB 应用程序在再次在线后立即处理发布/分享？

还是我必须自己做，把我想分享的链接放在内部数据库中，然后当我再次在线时将它们发布到墙上？

还是其他方式？？

欢迎任何建议，我更喜欢一个非常快速的解决方案，并希望有人可能知道如何做到这一点。我希望我可以将分享链接传递给官方 FB 应用程序，当它再次上线时，这个应用程序会处理所有事情！？

谢谢你的想法！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T16:00:13.033

您的方法应该是让您的链接共享代码自动缓存请求，直到它们被发送。然后，应用程序不需要关注细节 - 它可以发布链接并从您的 API 获得“失败”、“成功”或“延迟”响应，并相应地通知用户。

然后，您的链接共享代码可以在内部检查它当前是否可以发布到 FB，如果不能（因为用户当前离线或 Facebook 令牌已过期），它将存储它以备后用。然后，此类将定期重新检查（例如，当应用程序进入前台时或在下次应用程序启动时初始化类时）以检查连接性，然后它将检查令牌是否仍然有效并在需要时执行 FB 登录. 一旦它拥有一个有效的令牌，它就可以遍历待处理的请求并对其采取行动。

如果你真的想让它变得干净整洁，你可以分离出接受传入请求的代码来做某事，检查它现在是否可以执行，是否可以执行或存储它以供以后使用，并定期检查待处理队列中的任何请求. 这个类不会知道请求做什么或它们是如何执行的，它将与另一个实现协议的类一起工作以完成实际工作并了解 facebook 等。甚至可能存在这样的设计模式设置，但我不知道如果有它叫什么。

更新：我做了一些研究，发现这与“即发即弃模式”非常相似。

# php - php REGEX to match custom url structure issue

> ID：15952988
> 
> 赞同：1
> 
> 时间：2013-04-11T15:35:05.853
> 
> 标签：php, regex, url, preg-match, match

I tried the pattern below with a lot of variations of `(` `)` and `[` `]` but I couldn't achieved my aim.

```
$pattern = '/^http:\/\/www.mydomain.p.ht\/?[\p{L}\p{N}\-]{0,36}\/?[\p{L}\p{N}\-]{0,51}\/?[\p{L}\p{N}\-]{0,101}$/'; 
```

My aim is: to match my needed url structure

1.  `http://www.mydomain.p.ht`
2.  0 or 1 `/` slash character
3.  utf-8 aware letters, numbers and dash character. Total length is min 0, max 36
4.  0 or 1 `/` slash character
5.  utf-8 aware letters, numbers and dash character. Total length is min 0, max 51
6.  0 or 1 `/` slash character
7.  utf-8 aware letters, numbers and dash character. Total length is min 0, max 101\. there mustn't exist `/` slash character at the very end.

currently `http://www.mydomain.p.ht/1234561-234561234561234-56123456123456şğ` matches but it shouldn't since `1234561-234561234561234-56123456123456şğ` part has more than 36 characters.

Can you please correct my pattern?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T15:40:53.670

只是纠正正则表达式本身

```
/^http:\/\/www.mydomain.p.ht(\/|\/[\p{L}\p{N}\-]{1,36}(\/|\/[\p{L}\p{N}\-]{1,51}(\/|\/[\p{L}\p{N}\-]{1,101})?)?)?$/ 
```

问题是使`/`可选允许正则表达式组合多个 [\p{L}\p{N}-] 组以匹配超过 36 或 51 个字符等等。我做了一个假设，你不能有`http://www.mydomain.p.ht//1234561-234561234561234-56123456123456şğ`，注意双`/`

有关更多信息，我强烈推荐[http://www.regular-expressions.info/](http://www.regular-expressions.info/)

# javascript - 为什么 jQuery Mobile 不适用于 1.9.1？

> ID：15952989
> 
> 赞同：-6
> 
> 时间：2013-04-11T15:35:08.747
> 
> 标签：javascript, jquery, jquery-mobile

对不起。我无法单独使用 Google 找到答案。如何在我的项目中包含 jQuery 1.9.1 和 jquery Mobile？

**编辑**

我知道如何包含 javascript 文件。我的意思是说，jquery mobile 与 jQuery 1.9.1 不兼容。

请参阅[**此小提琴**](http://jsfiddle.net/3wzTr/)进行演示。

在上面的 jsFiddle 中包含 1.9.1 的 jQuery Mobile 框架会导致点击不起作用。jQuery 1.8.3 及以下的作品。

小提琴中的代码：

```
<div id='box'>TAP ME</div> 
```

```
$(document).ready(function() {
    $('#box').bind('tap',function(event) {
        alert('Thanks!');
    });    
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T16:03:48.287

你真的应该在发布这个问题之前检查官方网站。

每个 jQuery Mobile 版本都被锁定到特定的 jQuery 版本范围。

例如：

*   [jQuery Mobile 1.1](http://jquerymobile.com/blog/2012/04/13/announcing-jquery-mobile-1-1-0/)支持 jQuery 1.6.4 或 1.7.1
*   [jQuery Mobile 1.2](http://jquerymobile.com/demos/1.2.0/)支持 jQuery 1.7.0 到 1.8.2，而我可以确认它也适用于 jQuery 1.8.3。并且不适用于大于 1.8.3 的任何版本

*   [jQuery Mobile 1.3](http://api.jquerymobile.com/)支持 jQuery 1.7.0 到 1.9.1，而我可以确认它也适用于 jQuery 2

# c# - 如何跟踪电脑的启动、关机和严重关机

> ID：15952994
> 
> 赞同：0
> 
> 时间：2013-04-11T15:35:18.247
> 
> 标签：c#, windows

我知道移动推车上大约有 250 台笔记本电脑没有得到充分利用。我正在编写一个程序，该程序编写一个日志文件来捕获开机和关机事件。但是，当我尝试捕获立即关闭事件（用户按住电源按钮）时，我没有将数据写入文本文件。

任何输入都会有所帮助。提前致谢。

代码：

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using System.IO;
using Microsoft.Win32;

    namespace Log
    {
        public partial class Form1 : Form
        {
            public Form1()
            {
                InitializeComponent();
            }

            string CrLf = System.Environment.NewLine;
            private static int WM_QUERYENDSESSION = 0x11;
            private static int WM_ENDSESSION_CRITICAL = 0x40000000;

            private static bool systemShutdown = false;

            private void Form1_Load(object sender, EventArgs e)
            {
                Write_Data("[" + DateTime.Now.ToString() + "] " + "Power on");            
            }

            protected override void WndProc(ref System.Windows.Forms.Message m)
            {

                if (m.Msg == WM_QUERYENDSESSION)
                {
                    Write_Data("[" + DateTime.Now.ToString() + "] " + "Power off");
                    systemShutdown = true;
                }
                // If this is WM_QUERYENDSESSION, the closing event should be
                // raised in the base WndProc.

                    if (m.Msg == WM_ENDSESSION_CRITICAL)
                    {
                        Write_Data("[" + DateTime.Now.ToString() + "] " + "Critical power down");
                        systemShutdown = true;
                    }

                    base.WndProc(ref m);
            }       

            private void Write_Data(string str_Data)
            {
                using (StreamWriter output = new StreamWriter("../Log.txt", true))
                {
                    output.WriteLine(str_Data);
                }
            }
        }

    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T15:45:30.510

[阅读系统的事件日志http://msdn.microsoft.com/en-us/library/system.diagnostics.eventlog.aspx](http://msdn.microsoft.com/en-us/library/system.diagnostics.eventlog.aspx)可能更有意义 ，只需找出这些事件发生的时间

或者，如果这不理想，而不是侦听关闭事件，而是连接到程序的终止，并假设程序正在关闭，计算机正在关闭，并在那里调用您的 Write_Data。请注意，[控制台应用程序的此 SO 线程“退出时”中的](https://stackoverflow.com/questions/4646827/on-exit-for-a-console-application)某些解决方案在 Windows7 上不起作用，并且在控制台/表单应用程序关闭时表现不同

# android - AsyncTask 仅在使用 get() 方法后返回值

> ID：15952999
> 
> 赞同：0
> 
> 时间：2013-04-11T15:35:27.243
> 
> 标签：android, android-asynctask

我已经创建了活动，它应该在用户单击按钮后返回 GeoPoint 数组。执行 http 请求和解析答案的代码被提取到 AsyncTask。在`onPostExecute()`我分配`overlayList`了方法返回的值的`doInBackground()`方法中，但它不起作用并且

```
overlayList.size() 
```

抛出 NullPointerException。这是我的原始代码：

```
public class MyActivity extends Activity {

Button bt;
TextView tv1;
List<GeoPoint> overlayList;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    bt = (Button) findViewById(R.id.button);
    tv1 = (TextView) findViewById(R.id.textView);

    bt.setOnClickListener(new View.OnClickListener() {
        @Override
        public void onClick(View v) {

            String query = "http://maps.googleapis.com/maps/api/directions/json?origin=bla-bla&destination=bla-bla&sensor=false";

            Request mat =  new Request();
            mat.execute(query);

            if (overlayList.size() > 0){
                tv1.setText("List is OK!");
            }

        }
    });
}

private class Request extends AsyncTask<String, Void, ArrayList<GeoPoint>> {

    @Override
    protected ArrayList<GeoPoint> doInBackground(String... params) {
        return parse(connect(params[0]));
    }

    @Override
    protected void onPostExecute(ArrayList<GeoPoint> geoPoints) {
        super.onPostExecute(geoPoints);
        overlayList = geoPoints;
    }

    public JSONObject connect(String url) {
        ...    
    }

    public ArrayList<GeoPoint> parse(JSONObject jsonObject) {
        ...
    }

} 
```

但是，如果我`OnClickListener`以这种方式修改我的：

```
HttpRequest mat =  new HttpRequest();
mat.execute(query);

try {
    overlayList = mat.get();
} catch (InterruptedException e) {
    e.printStackTrace();
} catch (ExecutionException e) {
    e.printStackTrace();
} 
```

一切正常并`overlayList.size()`返回列表的大小。所以，我的问题 - 为什么`onPostExecute()`方法不初始化我的列表？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T15:45:36.063

An`AsyncTask`正是它的名字所暗示的 - 该`doInBackground(...)`方法在单独的线程上异步运行，而代码`onCreate(...)`继续运行。

在您的代码中...

```
mat.execute(query);

if (overlayList.size() > 0){
    tv1.setText("List is OK!");
} 
```

...在您致电后*立即*`if`检查情况。换句话说，您没有机会执行它的方法。*`mat.execute(query)``AsyncTask``doInBackground(...)`*

 *移动此代码...

```
if (overlayList.size() > 0){
    tv1.setText("List is OK!");
} 
```

...进入`onPostExecute(...)`您的`AsyncTask`.

编辑：正如 triggs 在下面的评论中指出的那样，调用 的`get()`方法`AsyncTask`将阻塞主线程并等待返回结果。这有效地使使用`AsyncTask`成为同步操作，在这种情况下使用`AsyncTask`.

我能想到使用该`get()`方法的唯一原因是来自主（UI）线程以外的线程，尽管我想不出很多理由这样做。*