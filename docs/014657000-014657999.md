# StackOverflow 问答 14657000-14657999

# javascript - CSS 元素顶部距离窗口底部 100px

> ID：14657001
> 
> 赞同：-1
> 
> 时间：2013-02-01T23:50:44.997
> 
> 标签：javascript, html, css

是否可以使用绝对定位将块级元素的顶部放置在距离窗口底部 100px 的位置？

在我的应用程序中，我无法将这个元素锚定在距页面顶部给定数量的像素处，因为页面上的几个元素的高度未知，我必须使用 JavaScript 来动态测量、调整大小和放置这些元素。

感谢您的时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-01T23:57:33.940

相对于您要使用的浏览器窗口定位项目`position:fixed`，而不是`position:abslute`. 然后，您只需设置`bottom: 100px`或远离窗口底部的距离。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-02T00:02:25.400

不，如果`position:absolute`不利用 JavaScript 或基于被定位元素的高度的某些服务器端逻辑，就不可能使用（但听起来你也不知道）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-02T00:06:17.670

我不确定这一点，但也许这会有所帮助：

```
<div class='b'>
    <div class='a'>
        element
    </div>
</div>

.a {
    margin-bottom:-100%;
}

.b {
    position:absolute;
    bottom:100px;
} 
```

[http://jsfiddle.net/pmB9U/](http://jsfiddle.net/pmB9U/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-02T00:22:18.970

如果可以使用不跨越整个页面的滚动条，这是很有可能的：

```
<!DOCTYPE html>
<html>

<head>
<title>Emulate position:fixed</title>
<style type="text/css">
html, body {
    margin: 0;
    padding: 0;
}
body {
    height: 100%;
    overflow: hidden;
}
#content {
    position: absolute;
    top: 50px;
    bottom: 100px;
    width: 100%;
    overflow: auto;
}
#header {
    height: 50px;
    background-color: yellow;
    position: absolute;
    top: 0;
    width: 100%;
    height: 50px;
}
#footer {
    position: absolute;
    background-color: yellow;
    position: absolute;
    bottom: 0;
    width: 100%;
    height: 100px;
}
</style>
</head>

<body>
<div id="header">
    header
</div>
<div id="content">
    <p>Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet.</p>
    <p>Duis autem vel eum iriure dolor in hendrerit in vulputate velit esse molestie consequat, vel illum dolore eu feugiat nulla facilisis at vero eros et accumsan et iusto odio dignissim qui blandit praesent luptatum zzril delenit augue duis dolore te feugait nulla facilisi. Lorem ipsum dolor sit amet, consectetuer adipiscing elit, sed diam nonummy nibh euismod tincidunt ut laoreet dolore magna aliquam erat volutpat.</p>
    <p>Ut wisi enim ad minim veniam, quis nostrud exerci tation ullamcorper suscipit lobortis nisl ut aliquip ex ea commodo consequat. Duis autem vel eum iriure dolor in hendrerit in vulputate velit esse molestie consequat, vel illum dolore eu feugiat nulla facilisis at vero eros et accumsan et iusto odio dignissim qui blandit praesent luptatum zzril delenit augue duis dolore te feugait nulla facilisi.</p>
    <p>Nam liber tempor cum soluta nobis eleifend option congue nihil imperdiet doming id quod mazim placerat facer possim assum. Lorem ipsum dolor sit amet, consectetuer adipiscing elit, sed diam nonummy nibh euismod tincidunt ut laoreet dolore magna aliquam erat volutpat. Ut wisi enim ad minim veniam, quis nostrud exerci tation ullamcorper suscipit lobortis nisl ut aliquip ex ea commodo consequat.</p>
    <p>Duis autem vel eum iriure dolor in hendrerit in vulputate velit esse molestie consequat, vel illum dolore eu feugiat nulla facilisis.</p>
</div>
<div id="footer">
    footer
</div>
</body>

</html> 
```

# javascript - 让 CORS 与 JQuery 客户端、Node / Express 服务器一起工作的问题

> ID：14657002
> 
> 赞同：1
> 
> 时间：2013-02-01T23:50:46.530
> 
> 标签：javascript, jquery, node.js, express, cors

我在使用 cookie 进行跨源资源共享时遇到问题。这是我的设置：

**客户：**

```
 $.ajax({
        type: 'POST',
        url: '/processReq',
        data: params,
        xhrFields: {withCredentials:true},
        crossDomain: true,
        success: ...
    }); 
```

我已经在浏览器中调试了客户端，并验证了 XMLHttpRequest.withCredentials 实际上是正确的。

**服务器：**

我正在设置以下标题：

```
res.header('Access-Control-Allow-Credentials', true);
res.header('Access-Control-Allow-Origin', '*'); 
```

我的问题是我无法让浏览器存储会话 cookie，并在随后的请求中发送到服务器。

以下是浏览器中的响应标头：

```
{
    "server": "nginx/1.2.6",
    "date": "Fri, 01 Feb 2013 23:46:07 GMT",
    "content-type": "application/json; charset=utf-8",
    "content-length": "306",
    "connection": "keep-alive",
    "x-powered-by": "Express",
    "access-control-allow-credentials": "true",
    "access-control-allow-origin": "*",
    "set-cookie": [
        "id=s%3Azm1m...NXe4Lkr9rLw; Domain=api.mydomain.io; Path=/; Expires=Sat, 01 Feb 2014 23:46:07 GMT; HttpOnly"
    ]
} 
```

每次我测试时，我都没有收到发送到服务器的 cookie。我错过了什么吗？任何帮助深表感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-01T23:55:49.670

你不能使用`('Access-Control-Allow-Origin', '*')`with `('Access-Control-Allow-Credentials', true)`。您需要将 显式设置`Access-Control-Allow-Origin`为一个值。`origin`如果您仍然想要“*”行为，请以编程方式将值设置为请求标头。

来自[https://developer.mozilla.org/en-US/docs/HTTP/Access_control_CORS?redirectlocale=en-US&redirectslug=HTTP_access_control](https://developer.mozilla.org/en-US/docs/HTTP/Access_control_CORS?redirectlocale=en-US&redirectslug=HTTP_access_control)：

> 重要提示：在响应凭据请求时，服务器必须指定域，并且不能使用通配符。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T07:16:54.797

另一个完全避开 CORS 的优雅选项是使用隐藏的 iframe 和`window.postMessage`.

API 让我们的`postMessage`两个浏览器框架跨域通信。基本设计如下：

1.  加载主页`domain-1.com`
2.  主页加载隐藏的 iframe`domain-2.com`
3.  隐藏的 iframe 加载 javascript 以与`domain-2.com`API交互

每当主页希望跨域交谈时，它都会通过隐藏的 iframe 代理请求。没有 CORS 需要处理——没有！

一些教程：

*   [http://davidwalsh.name/window-postmessage](http://davidwalsh.name/window-postmessage)
*   [https://developer.mozilla.org/en-US/docs/DOM/window.postMessage](https://developer.mozilla.org/en-US/docs/DOM/window.postMessage)

# c++ - 在哪里可以找到有关 D_GLIBCXX_DEBUG 和 DNDEBUG 标志的更多信息？

> ID：14657005
> 
> 赞同：11
> 
> 时间：2013-02-01T23:51:19.183
> 
> 标签：c++, g++, compiler-flags

我试图了解 D_GLIBCXX_DEBUG 和 DNDEBUG 标志。

但我找不到关于他们的信息。

谁能解释他们做什么？我在哪里可以阅读更多关于它们的信息？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-01T23:59:29.733

两者都使用[-D](http://gcc.gnu.org/onlinedocs/gcc/Preprocessor-Options.html#Preprocessor-Options)来定义`D`.

当`NDEBUG`被定义时，[assert](http://en.cppreference.com/w/cpp/error/assert)不检查它的参数。

当`_GLIBCXX_DEBUG`被定义时，它会激活[调试模式](https://gcc.gnu.org/onlinedocs/libstdc%2B%2B/manual/debug_mode_using.html)`libstdc++`（导致对`libstdc++`各种操作进行检查）。

# xml - 如何在 xpath 表达式上执行“或”而不用“|”连接两个 xpath 还是使用 xpath 函数？

> ID：14657016
> 
> 赞同：2
> 
> 时间：2013-02-01T23:52:17.267
> 
> 标签：xml, xpath, xmlnode

如果我想选择 /a/b1/c 和 /a/b2/c 我可以使用以下之一：

```
 /a/*[local-name()='b1' or local-name()='b2']/c
  /a/b1/c | /a/b2/c 
```

但我想知道是否有一种更优雅的方式来指定“b1 或 b2”，而不必重新输入几乎整个表达式，也不必使用 local-name 函数。

不幸的是，这些表达式不起作用：

```
 /a/b1 or b2/c
 /a/[b1 or b2]/c
 /a/b1 | b2/c
 /a/[b1 | b2]/c 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-02T01:26:08.707

两个 XPath 1.0 解决方案比您的原始解决方案短一些，并且不依赖 local-name() 将是：

```
/a/*[self::b1 or self::b2]/c
/a/*[self::b1 | self::b2]/c 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-02T01:02:36.530

在 XPath 2 中，您可以使用：

```
 /a/(b1|b2)/c 
```

也

```
 /a/(b1,b2)/c 
```

# python - 保存在视图中的最佳实践，基于示例代码

> ID：14657021
> 
> 赞同：1
> 
> 时间：2013-02-01T23:52:54.710
> 
> 标签：python, django

我是 Django 新手，正在寻找我刚刚编写的代码的最佳实践（如下）。该代码当前存在于我的 view.py 中，只是创建了一个新事件。如果您知道我的意思，那么熟悉其他语言只会“闻起来很糟糕”。有人可以指出他们将如何完成这个简单的任务。

再次查看我的代码（并通过阅读更多文档）的唯一方法是将 request.user 移动到 models.py 保存函数中。

下面还有什么是新手的大错误吗？

```
@login_required
def event_new(request):
    # If we had a POST then get the request post values.
    if request.method == 'POST':
        form = EventForm(request.POST)
        # Check we have valid data
        if form.is_valid():
            # If form has passed all validation checks then continue to save it.
            city = City.objects.get(name=form.cleaned_data['autocompleteCity'])
            category = form.cleaned_data['category']
            event = Event(
                name=form.cleaned_data['name'],
                details=form.cleaned_data['details'],
                date=form.cleaned_data['date'],
                start=form.cleaned_data['start'],
                end=form.cleaned_data['end'],
                category=category,
                city=city,
                user=request.user,
            )
            event.save()

            messages.add_message(request, messages.SUCCESS, 'Event has been created.')
            return HttpResponseRedirect('/events/invite/')
        else:
            messages.add_message(request, messages.ERROR, 'Error')
            context = {'form': form}
            return render_to_response('events/event_edit.html', context, context_instance=RequestContext(request))
    else:
        form = EventForm

    context = {'form': form}
    return render_to_response('events/event_edit.html', context, context_instance=RequestContext(request)) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-02T00:35:56.450

您应该阅读有关[从模型创建表单的信息](https://docs.djangoproject.com/en/dev/topics/forms/modelforms/)。该类`ModelForm`将使您免于将字段从表单复制到模型。

除此之外，这种观点对我来说看起来很正常。

[您甚至可以使用通用FormView](https://docs.djangoproject.com/en/dev/topics/class-based-views/generic-editing/)或[CreateView](https://docs.djangoproject.com/en/dev/ref/class-based-views/flattened-index/#CreateView)摆脱一些样板代码（`if request.method == "POST"`,`if form.is_valid()`等）。由于您需要进行一些特殊的表格处理，因此它可能对您没有任何用处，但可能值得一看。

这段代码不是 100% 完整的（缺少你的城市特殊逻辑），但除此之外应该非常完整，并让你了解如何使用通用视图。

## 表格.py

```
from django.forms import ModelForm

class EventForm(ModelForm):

    def __init__(self, user, **kwargs):
        self.user = user
        super(EventForm, self).__init__(**kwargs)

    class Meta:
        model = Event

    def save(self, commit=True):
        event = super(EventForm, self).save(commit=False)
        event.user = self.user
        if commit:
            event.save() 
```

## 视图.py

```
from django.views.generic.edit import CreateView

class EventCreate(CreateView):
    model = Event
    form_class = EventForm
    template = "events/event_edit.html"
    success_url = "/events/invite/" # XXX use reverse()

    def get_form(form_class):
        return form_class(self.request.user, **self.get_form_kwargs())

    def form_valid(form):
        form.user = self.request.user

        messages.success(request, 'Event has been created.')
        super(EventCreate, self).form_valid(form)

    def form_invalid(form):
        messages.error(request, 'Error')
        super(EventCreate, self).form_invalid(form) 
```

## 网址.py

```
url(r'event/add/$', EventCreate.as_view(), name='event_create'), 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-02T00:31:18.737

我觉得这看起来很棒。您很好地遵循了文档中的约定。

迁移`request.user`到模型肯定是一种反模式——视图函数是在请求/响应循环中服务的，所以在这里访问这个属性是有意义的。模型对请求/响应一无所知，因此将这些与任何视图行为分离是正确的。

我注意到的唯一一件事是创建一个`category`仅用于构造的变量`Event`，非常小。

# git - Git - 远程站点到本地

> ID：14657026
> 
> 赞同：1
> 
> 时间：2013-02-01T23:53:32.290
> 
> 标签：git, data-synchronization

我有一个新的客户端 wordpress 网站，它的构建有点混乱（但它可以工作）。

我已经在远程服务器和本地机器上安装了 Git。

在开始本地开发之前，我需要将远程服务器中的所有文档复制到本地服务器。

请问如何使用 Git 执行此操作？

我是一个 git noob，所以请对我放轻松...就这么简单...

远程服务器：

```
git commit -m "Initial Pull" 
```

本地服务器：

```
git pull website master 
```

我知道我可以使用 FTP 复制文件，但我希望在开始编码之前让本地和远程服务器同步/版本控制。

还是我完全误解了 Git 的目的？

更新：

假设我的用户名是 harry 并且我的服务器域名是 potter.co.uk 并且 git 存储库在 /home/harry/site.git 你能确认这是否可行吗？如果我在本地机器上尝试这个，我会破坏任何东西吗？

```
git clone harry@potter.co.uk:/home/potter/site.git 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-01T23:58:26.273

你想使用 git clone

> git clone username@server:path/to/repo.git

如果您要使用多个存储库，我会在您的 ~/.ssh/config 文件中添加一个条目

```
Host git
HostName myserver.com
IdentityFile ~/.ssh/id_rsa
User mygituserid 
```

然后你可以做

> git clone git:/path/to/repo.git

在任何一种情况下，请记住 : 之后的路径是相对于 ssh 用户的主目录而没有前导 /

此外，如果您想将更改推回 REMOTE，则远程 repo 应该是裸露的。转换为裸执行（根据@jthill 的评论）

```
git clone --mirror existing_repo repo.git 
```

然后我会在开始工作之前将那个新的、裸露的 repo 克隆到我的本地机器上。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T00:15:25.090

@scott 回答了确切的问题。看看[git 的主页](http://git-scm.com)，它参考了几本书，一堆很好的教程，还有很多其他的资源。使用起来有点棘手（特别是如果您习惯于 SVN 或其他一些集中式版本控制系统），所以我建议您设置一些存储库进行实验（不是 git 丢失信息；如果您*可以*这样做不过，问得足够有力；这是*用户*可能会感到困惑，以至于他们不知道如何解开混乱）。不要害羞在您的机器上拥有多个存储库副本，也许是“官方​​”副本和其他尝试可能危险的东西。OTOH，您可以即时创建它们（git 操作，甚至克隆完整的存储库，都非常*快*）。

# python - 如何使用beautifulsoup从pre标签中删除空格

> ID：14657029
> 
> 赞同：-1
> 
> 时间：2013-02-01T23:53:51.183
> 
> 标签：python, beautifulsoup

考虑这段代码。

```
#!/usr/bin/env python
# -*- coding: utf8 -*-

from bs4 import BeautifulSoup
html_doc = """<pre class="code file d"><span class="kw2">import std.stdio
import core.bitop;

// parallel port address 
const uint port = 0x0c000;

void main()
{
    /*
        permission related stuff under linux
    */

    /* data */
    ubyte data = 0b_11111111;
    outp(port, data);
}
</span></pre>
"""

invalid_tags = ['span']

soup = BeautifulSoup(html_doc)

for tag in invalid_tags:
    for invalid in soup.findAll(tag):
        invalid.replaceWithChildren()

pre_tags = soup.find_all('pre')

for i in range (len(pre_tags)):
    pre_tags[i]['class'] = 'prettyprint'

output = soup.prettify(formatter=None)

output_text = output.encode('utf8', 'replace')

output_file = open('test.html', "w")
output_file.write(output_text)
output_file.close() 
```

我有一个简单的 html 文档。在这种情况下，我想删除一些不需要的标签`<span>`并更改标签的类名`<pre>`。

但是，如果您查看输出文件，则第二行中有不需要的空白字符。

```
 <pre class="prettyprint">
   import std.stdio
import core.bitop;

// parallel port address 
const uint port = 0x0c000;

void main()
{
    /*
        permission related stuff under linux
    */

    /* data */
    ubyte data = 0b_11111111;
    outp(port, data);
}
  </pre> 
```

我想在第二列之前删除不需要的空格字符，并希望它左对齐。

我怎样才能做到这一点？有任何想法吗。谢谢..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T00:41:04.873

这里的问题是您正在调用`prettify`. 所有其他的东西都无关紧要。如果你只是`soup`在 span-removing 循环之后打印出来，然后在 pre-reclassifying 循环之后再次打印出来，内容就可以了；另一方面，如果你`soup.prettify()`在顶部打印出来，没有这两个循环，它已经添加了额外的空白。

为什么？嗯，这就是`prettify`. 在文档中，[Pretty-printing](http://www.crummy.com/software/BeautifulSoup/bs4/doc/#pretty-printing)说它把“每个 HTML/XML 标记放在自己的行上”。这包括`<pre>`标签。

如果你想使用`prettify`，但不希望它美化`pre`标签，你需要创建并传入一个格式化程序来处理跳过`pre`标签。

或者，或者，你总是可以做这样的事情（伪代码，不是真正的代码）：

```
for tag in find_all('pre'):
    replace tag contents with str(len(stash))
    stash.append(str(tag contents))
pretty = soup.prettify()
for i, tag in stash:
    pretty.replace('<pre>{}</pre>'.format(i), tag) 
```

`prettify`应该总是跳过标签是有争议的`pre`（就像它一样`CData`）。看到[这个错误](https://bugs.launchpad.net/beautifulsoup/+bug/1095654)。

# android - 活动损失信息

> ID：14657030
> 
> 赞同：0
> 
> 时间：2013-02-01T23:53:59.560
> 
> 标签：android, android-intent

我编写了一个包含选项按钮和选项活动的应用程序。在 OptionActivity 中，您可以使用切换按钮选择“打开”或“关闭”播放音乐。还有一些检查按钮。直到这里一切正常，但是当您选中某个框并返回主菜单并再次返回选项活动时，您会发现所有变量都是默认值。例如，复选框一未选中。我知道这是因为everyCall 带有新意图的选项活动，但我想知道“不使用新意图”开始活动

这是我的启动画面

公共类 MainActivity 扩展 Activity {

```
/* (non-Javadoc)
 * @see android.app.Activity#onCreate(android.os.Bundle)
 */
@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.baslangic);

    Thread thred=new Thread(){
public void run(){
    try {

        sleep(5000);

        startActivity(new Intent("com.KAYA.ingilizce_gelistirme.OPTIONS"));

        startActivity(new Intent("com.KAYA.ingilizce_gelistirme.BASLANGIC"));
    } catch (InterruptedException e) {
        e.printStackTrace();
    }finally{
        finish();

    }
}
};
thred.start();

} 
```

}

这是我的主要活动，其中包含选项按钮

公共类 Baslangic 扩展 Activity {

```
@Override
protected void onStart() {
    // TODO Auto-generated method stub
    super.onStart();

}

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);
    Button start=(Button)findViewById(R.id.button1);
    Button options=(Button)findViewById(R.id.button2);
    Button about=(Button)findViewById(R.id.button3);

     start.setOnClickListener(new View.OnClickListener() {

        @Override
        public void onClick(View v) {

            startActivity(new Intent("com.KAYA.ingilizce_gelistirme.OYUN"));

        }
    });
    options.setOnClickListener(new View.OnClickListener() {

        @Override
        public void onClick(View v) {
            finish();

        }
    });

    about.setOnClickListener(new View.OnClickListener() {

        @Override
        public void onClick(View v) {
            startActivity(new Intent("com.KAYA.ingilizce_gelistirme.ABOUT"));

        }
    });

}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    // Inflate the menu; this adds items to the action bar if it is present.
    getMenuInflater().inflate(R.menu.activity_main, menu);
    return true;
} 
```

}

这是我的选择活动

```
 @Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.options);
     it=(RadioButton)findViewById(R.id.radio0);
     ti=(RadioButton)findViewById(R.id.radio1);
     final ToggleButton but=(ToggleButton)findViewById(R.id.toggleButton1);
     music=MediaPlayer.create(Options.this, R.raw.avril);

    but.setOnClickListener(new View.OnClickListener() {

        @Override
        public void onClick(View v) {
            if(but.isChecked())
            music.start();
            else
            music.pause();

        }
    });
     it.setChecked(true);
     Button menu=(Button)findViewById(R.id.button1);
     menu.setOnClickListener(new View.OnClickListener() {

        @Override
        public void onClick(View v) {
            startActivity(new Intent("com.KAYA.ingilizce_gelistirme.BASLANGIC"));
        }
    });

}

@Override
public void onBackPressed() {
    // TODO Auto-generated method stub

    startActivity(new Intent("com.KAYA.ingilizce_gelistirme.BASLANGIC"));
    }
@Override
protected void onPause() {

    super.onPause();
}

@Override
protected void onResume() {
    // TODO Auto-generated method stub
    super.onResume();
}

@Override
protected void onStop() {
    super.onStop();
} 
```

}

注意：请注意，当用户单击选项按钮时，我调用完成（），实际上我有一个解决方案。我的解决方案是，在启动画面之后，我开始 2 个活动；第一个选项稍后菜单，当用户单击选项按钮并调用完成（）时，我在选项按钮中：D，当按下返回时，我调用了新意图（菜单），您可以在 OPTIONS 活动中看到，所以我的问题已经解决了，但我想知道应该有一个不同于这种方式的解决方案，如果你知道请帮助我。:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T00:07:29.427

您使用的是 PreferenceActivity 还是普通的 Activity 超类？

无论如何，请务必阅读 SharedPreferences - 它可以为整个应用程序或单个活动存储您的值。

# google-app-engine - GAE 上传图片然后动态提供图片

> ID：14657032
> 
> 赞同：0
> 
> 时间：2013-02-01T23:54:05.207
> 
> 标签：google-app-engine, server-error

我正在尝试在 GAE 上制作一个简单的应用程序，允许用户输入图像的 url 和名称。然后，该应用程序将此图像连同其名称一起上传到数据存储区。

上传后页面自我重定向，然后应该将图像发送回客户端并显示在他们的机器上。

运行后我得到的是服务器错误。由于我是 GAE 新手，请有人告诉我我的代码是否至少正确。

我看不出我的代码有什么问题。（我已经检查了正确的缩进和空格）。下面是代码：

**蟒蛇：**

```
import jinja2   # html template libary
import os

jinja_environment = jinja2.Environment(
    loader=jinja2.FileSystemLoader(os.path.dirname(__file__)))

import urllib   
import urllib2 
import webapp2

from google.appengine.ext import db
from google.appengine.api import urlfetch

class Default_tiles(db.Model):
  name = db.StringProperty()
  image = db.BlobProperty(default=None)

class MainPage(webapp2.RequestHandler):
  def get(self):

    template = jinja_environment.get_template('index.html')
    self.response.out.write(template.render())

class Upload(webapp2.RequestHandler):
  def post(self):

    # get information from form post upload
    image_url = self.request.get('image_url') 
    image_name = self.request.get('image_name')

    # create database entry for uploaded image 
    default_tile = Default_tiles()
    default_tile.name = image_name
    default_tile.image = db.Blob(urlfetch.Fetch(image_url).content)
    default_tile.put()

    self.redirect('/?' + urllib.urlencode({'image_name': image_name}))

class Get_default_tile(webapp.RequestHandler):
  def get(self):
    name = self.request.get('image_name')
    default_tile = get_default_tile(name)

    self.response.headers['Content-Type'] = "image/png"
    self.response.out.write(default_tile.image)

    def get_default_tile(name):
      result = db.GqlQuery("SELECT * FROM Default_tiles WHERE name = :1 LIMIT 1", name).fetch(1)
      if (len(result) > 0):
        return result[0]
      else:
        return None

app = webapp2.WSGIApplication([('/', MainPage),
                               ('/upload', Upload),
                               ('/default_tile_img', Get_default_tile)],
                              debug=True) 
```

**的HTML：**

```
<html>
    <head>
        <link type="text/css" rel="stylesheet" href="/stylesheets/main.css" />
    </head>

    <body>
        <form action="/upload" method="post">
            <div>
                <p>Name: </p>
                <input name="image_name">
            </div>
            <div>
                <p>URL: </p>
                <input name="image_url">
            </div>
            <div><input type="submit" value="Upload Image"></div>
        </form>
        <img src="default_tile_img?{{ image_name }}">

    </body>

</html> 
```

任何帮助都将非常感激。谢谢！

**更新**

感谢 Greg，我知道如何查看错误日志。正如格雷格所说，我错过了一个逗号，我已经更新了上面的代码。

该应用程序现在运行，但是当我上传图像时，返回时没有显示图像。我在日志中收到以下消息：

**文件“/Users/jamiefearon/Desktop/Development/My Programs/GAE 具有 css、javascript 和图像的全功能网站/mywebsite.py”，第 53 行，在 get default_tile = self.get_default_tile(name) TypeError: get_default_tile() 中1 个参数（给定 2 个）**

我只向**get_default_tile()**传递了一个参数，为什么它抱怨我传递了两个？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T01:00:22.177

您在`('/upload', Upload)`WSGIApplication 设置之后缺少一个逗号。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-10T13:03:08.767

**使用这个 python 代码**

```
import jinja2   # html template libary
import os

jinja_environment = jinja2.Environment(
    loader=jinja2.FileSystemLoader(os.path.dirname(__file__)))

import urllib   
import urllib2 
import webapp2

from google.appengine.ext import db
from google.appengine.api import urlfetch

class Default_tiles(db.Model):
    name = db.StringProperty()
    image = db.BlobProperty(default=None)

class MainPage(webapp2.RequestHandler):
    def get(self):
      template = jinja_environment.get_template('index.html')
      self.response.out.write(template.render())

class Upload(webapp2.RequestHandler):
    def post(self):
      # get information from form post upload
      image_url = self.request.get('image_url') 
      image_name = self.request.get('image_name')
      # create database entry for uploaded image 
      default_tile = Default_tiles()
      default_tile.name = image_name
      default_tile.image = db.Blob(urlfetch.Fetch(image_url).content)
      default_tile.put()
      self.redirect('/?' + urllib.urlencode({'image_name': image_name}))

class Get_default_tile(webapp2.RequestHandler):
    def get_default_tile(self, name):
        result = db.GqlQuery("SELECT * FROM Default_tiles WHERE name = :1 LIMIT 1", name).fetch(1)
        if (len(result) > 0):
          return result[0]
        else:
          return None
    def get(self):
      name = self.request.get('image_name')
      default_tile = self.get_default_tile(name)
      self.response.headers['Content-Type'] = "image/png"
      self.response.out.write(default_tile)

app = webapp2.WSGIApplication([('/', MainPage),
                               ('/upload', Upload),
                               ('/default_tile_img', Get_default_tile)],
                              debug=True) 
```

# linux - 缓存中有内存时的Linux内核模块OOM

> ID：14657035
> 
> 赞同：4
> 
> 时间：2013-02-01T23:54:39.560
> 
> 标签：linux, caching, kernel, out-of-memory

嵌入式系统，无交换，内核 v2.6.36，启用内存压缩。

在大量使用的情况下，所有 RAM 都被缓存在缓存中。缓存使用了大约 70M 的内存。当用户空间进程分配内存时，没问题，缓存放弃它。

但是有一个第 3 方设备驱动程序似乎试图分配一个物理 5 阶页面，并因 OOM 而失败。快速浏览一下 buddyinfo 就可以确认这一点……没有可用的第 5 个订单页面。但是一旦我删除缓存，就会有很多可用并且设备驱动程序不再OOM。

所以在我看来虚拟内存分配会触发缓存下降，但物理内存分配不会？这没有意义，因为当内存被缓存占用时，内核模块可能会OOM，并且这种行为似乎比没有缓存的磁盘访问速度慢更有害。

是否有调整参数来解决这个问题？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T05:40:21.897

所以这就是发生的事情。我仍然不知道为什么高缓存使用导致内核模块OOM。问题出在我们无法访问的第 3 方代码中，所以谁知道他们在做什么。

我想如果这是设计使然，非关键磁盘缓存可能会占用所有可用的空闲内存，并导致内核模块OOM，那么恕我直言，也许磁盘缓存应该为内核留下一些东西。

我决定改为限制缓存，因此总有一些“真正空闲”的内存留给内核使用，而不是依赖于缓存中的“某种空闲”内存。

我发现有一个内核补丁会添加 /proc/sys/vm/pagecache_ratio 以便您可以设置磁盘缓存可以占用多少内存。但无论出于何种原因，这从未被纳入内核（我认为这是一个好主意，尤其是如果磁盘缓存可能导致内核 OOM）。但是出于可维护性和面向未来的原因，我不想弄乱内核补丁。如果有人只是做一次性交易，不介意补丁，这里是链接： http: [//lwn.net/Articles/218890/](http://lwn.net/Articles/218890/)

我的解决方案是我重新编译了内核并启用了 cgroups，我使用它来限制负责大量磁盘访问的一组进程的内存使用量（因此运行缓存）。调整配置后，它似乎工作正常。我会在周末让我的设置运行压力测试，看看 OOM 是否仍然发生。

## 编辑

我想我找到了自己的答案。/proc/sys/vm/中有VM调优参数。与此问题相关的可调整设置是：min_free_kbytes、lowmem_reserve_ratio 和 extfrag_threshold。

# java - 如何使用 JDBC 连接到远程数据库？

> ID：14657036
> 
> 赞同：5
> 
> 时间：2013-02-01T23:55:07.527
> 
> 标签：java, mysql, jdbc, playframework

我正在尝试通过 JDBC 连接到远程数据库。这是我的连接字符串：

```
db=mysql://user:password@blablabla.rds.amazonaws.com/dbname 
```

乍一看，它似乎应该可以工作，但在尝试时，我得到了错误：

```
Cannot connected to the database, An attempt by a client to checkout a Connection has timed out. 
```

我正在尝试使用 Play 框架（1.2.x）并在 conf 文件中描述了这个数据库连接。

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-01T23:58:24.473

是的，这是错误的 URL。

您需要CLASSPATH 中的 MySQL [Connector-J JDBC 驱动程序 JAR。](http://dev.mysql.com/downloads/connector/j/)

URL 应如下所示：

[http://dev.mysql.com/doc/refman/5.0/en/connector-j-reference-configuration-properties.html](http://dev.mysql.com/doc/refman/5.0/en/connector-j-reference-configuration-properties.html)

我建议不要将凭据放在 URL 中。在 Java 中添加它们。

如果您遇到错误，请发布堆栈跟踪。这将有助于诊断你做错了什么。

您可以使用 MySQL 管理工具连接到该数据库吗？你能ping通那个服务器吗？你能telnet到那个端口吗？如果没有，Java 也不会连接。您的客户端计算机和数据库服务器之间是否有防火墙？如果是，则必须为您打开 MySQL 端口。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-02T00:03:00.123

继 duffymo 之后，您要使用的字符串如此`jdbc:mysql://blablabla.rds.amazonaws.com/dbname?user=user&password=password`处[所述](http://dev.mysql.com/doc/refman/5.0/en/connector-j-reference-configuration-properties.html)

# javascript - 输入字段占位符属性 ie7+

> ID：14657038
> 
> 赞同：1
> 
> 时间：2013-02-01T23:55:12.537
> 
> 标签：javascript, internet-explorer, coffeescript, placeholder, browser-detection

我目前正在使用以下库：

[http://widgetulous.com/placeholderjs/](http://widgetulous.com/placeholderjs/)

并使用以下代码来检测使用的必要性/并将其应用于需要它的字段：

```
 if navigator.userAgent.indexOf("MSIE")!= -1 or navigator.userAgent.indexOf("Trident")!= -1
    $ ->
       Placeholder.init()
       numPlaceHolders = $('input[placeholder]').length
       window.setInterval(=>
          if ($('input[placeholder]').length != numPlaceHolders)
             numPlaceHolders = $('input[placeholder]').length
             Placeholder.init()
      , 1000) 
```

有 Interval 的原因是元素是在运行时动态生成的（我使用 Angular JS）。不幸的是，ie支持是必须的，并且占位符属性不受支持......

所以我不得不提问：

1）如何强制 Placeholder.init() 应用于所有具有 placeholder 属性的新输入字段？有什么办法可以避免连续循环间隔？我知道 DomChange 事件（各种），但据我所知，它们在 ie 中是 a) 已弃用和 b) 不受支持？

2）有没有更好的方法来检查浏览器的兼容性，然后像我正在做的那样明确要求ie？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T18:49:56.647

这是我解决第一个问题的方法（直接检查 ie 而不是兼容性）：

更换：

```
 if navigator.userAgent.indexOf("MSIE")!= -1 or navigator.userAgent.indexOf("Trident")!= -1 
```

和

```
 if typeof(document.createElement('input').placeholder) == "undefined" 
```

仍然不知道是否有更好的方法来解决这个问题然后超时真的

# css - 应用于一个 UL 的类将应用于页面上的*所有*列表

> ID：14657042
> 
> 赞同：0
> 
> 时间：2013-02-01T23:55:40.247
> 
> 标签：css, styles, html-lists

有两个无序列表的简单文档。这两个列表彼此分开，因为一个**没有**嵌套在另一个内部。

请参阅此处的工作示例：[JSfiddle](http://jsfiddle.net/nAehw/)

一个类被应用到第一个列表，而不是第二个列表。我发现该类正在应用于页面上的所有列表，即使其他列表不共享同一个类。

标记：

```
 <style>
                    #listContainer
                    {
                        margin-top:15px;
                    }

.                   .expList ul, li 
                    {
                        list-style: none;
                        margin:0;
                        padding:0;
                        cursor: pointer;
                    }
                    .expList li {
                        line-height:140%;
                        text-indent:0px;
                        background-position: 1px 8px;
                        padding-left: 20px;
                        background-repeat: no-repeat;
                    }                   
                    .expList { clear:both;}

                </style>

                    <p style='font-size:1.4em;'>First list</p>
                    <div id='listContainer'>
                        <ul class='expList'>
                            <li>A<ul><li>A1</li></ul></li>
                            <li>A</li>
                        </ul>
                        </div>

<hr>

                        <p style='font-size:1.4em;'>Second list.  </p>
                        <ul>
                            <li><b>Cats</b>
                                <ul>
                                        <li>Cheezburger</li>
                                        <li>Ceiling</li>
                                        <li>Grumpy</li>
                                </ul>
                            </li>
                            <li><b>Role Models</b>
                                <ul>
                                        <li>Bad Luck Brian</li>
                                        <li>Paranoid Parrot</li>
                                        <li>Socially Awkward Penguin</li>
                                </ul>
                            </li>
                        </ul> 
```

为什么将一个类应用到一个完全独立的 UL 会影响同一页面上不同的非嵌套 UL？

**编辑**- 请参阅此问题的已接受答案以获得[对此问题](https://stackoverflow.com/questions/14690435/why-is-this-selector-not-being-applied-to-the-given-tag)的很好解释。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-01T23:57:50.527

您正在将样式应用于*所有* `li`元素：

```
.expList ul, li 
```

...表示“`ul`具有 class 的元素中的元素`expList`和所有`li`元素”。

既然它*有*`ul`class ，`expList`我想知道你是否真的想要：

```
.expList li { ... } 
```

表示 中的所有`li`元素`ul.expList`。猜测虽然，很难说没有更多的信息。

# python - 将 int 转换为字符串并检查位置以查看它是否与值匹配

> ID：14657044
> 
> 赞同：0
> 
> 时间：2013-02-01T23:55:44.553
> 
> 标签：python, python-3.x

我正在尝试做一些简单的 Python，它允许用户在命令行中输入一个 6 位数字；然后我的代码需要检查输入的数字的第一位和第六位的值。

输入的值存储在名为 的变量中`uinumber`，然后我使用`if`语句检查这些位置的值是否匹配。如下所示：

```
 if uinumber[1] == 5 and uinumber[6] == 0: 
```

这似乎没有任何作用。我也尝试将输入的数字转换为字符串，然后进行如下所示的检查，但这会导致同样的问题。

```
 uinumber_string = str(uinumber)
  if uinumber_string[1] == 5 and uinumber[6] == 0: 
```

这似乎导致了同样的问题；这样做的正确方法是什么？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-01T23:57:43.120

您需要将输入的数字转换为字符串是正确的，但是您还需要*将*其与字符串进行比较。

此外，由于您提到了一个 6 位数字，因此正确的索引可能是`[0]`and`[5]`而不是`[1]`and `[6]`，因为 Python（和大多数其他编程语言）中的序列是零索引的。

最后一点，你`uinumber[6]`是偶然写的，而不是`uinumber_string[6]`.

```
uinumber_string = str(uinumber)
if uinumber_string[0] == "5" and uinumber_string[5] == "0":
    # Do something 
```

# cakephp - 将 twitchAPI 与蛋糕一起使用

> ID：14657048
> 
> 赞同：-1
> 
> 时间：2013-02-01T23:56:03.517
> 
> 标签：cakephp

几个小时以来，我试图在我的蛋糕项目中实现 twitchAPI。很久以前，我用基本的 php 制作了这个小脚本。

```
 $channelName = "gamespot"; 
    $json_file = @file_get_contents("http://api.justin.tv/api/stream/list.json?channel={$channelName}", 0, null, null);
    $json_array = json_decode($json_file, true);                                                 
            @$json_array[0] && $json_array[0]['name'] == "live_user_{$channelName}";
                @$title = $json_array[0]['channel']['status'];
                @$game = $json_array[0]['meta_game'];
                @$chanel_view = $json_array[0]['channel_count'];
                @$totalchanelview = $json_array[0]['channel_view_count']; 
```

但我不知道如何在我的控制器上添加这些行因为知道我刚刚找到这个

```
public function twitch() {
    $json = file_get_contents('http://api.justin.tv/api/stream/list.json?channel=manvsgame');
    $twitch = json_decode($json);
    $totalchanelview = $twitch[0]['channel_view_count'];
    $this->set('twitch', 'totalchanelview');
} 
```

但我当然有这个错误

> 致命错误：不能在 /Users/ 中使用 stdClass 类型的对象作为数组*******/桌面/网站/********* /app/Controller/UsersController.php 第 29 行***

 ***任何人都可以向我解释如何使用这个 API？提前感谢，祝你有美好的一天/晚上:)

* * *

好的，首先感谢帮助我。我还有一点“逻辑问题”

我的功能是这样的：

```
public function twitch() {
    $json = file_get_contents('http://api.justin.tv/api/stream/list.json?channel=gamespot');
    $twitch = json_decode($json, true);
    $this->set('json', $twitch);
} 
```

但是知道，我可以在视图中写入什么来查看我的信息（例如我的流的标题。

我用

```
echo $twitch[0]['title']; (it's my line 1) 
```

有点我有这个错误

> 注意（8）：未定义变量：twitch [APP/View/Users/admin_dashboard.ctp, line 1]

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T09:22:10.697

```
$twitch = json_decode($json, true); // add true param
$twitch[0]['channel_view_count']; 
```

添加`true`将数据作为关联数组返回***

# c# - 如何进行高效插入？

> ID：14657055
> 
> 赞同：1
> 
> 时间：2013-02-01T23:57:01.823
> 
> 标签：c#, asp.net-mvc, performance, entity-framework, insert

当我将一个新对象插入数据库时​​，我将它与另一个对象关联起来，通过进行另一个数据库查找，我想删除这个额外的步骤以提高效率，IE 如何仅使用 ID 设置与另一个对象的关系，而不必从数据库中获取整个对象？例如：

```
Car C = new Car();
C.Person = db.person.find(PersonID); //unnecessary lookup
//I'd like to do: C.setPersonID(personID);
db.cars.add(C);
db.saveChanges(); 
```

型号：

```
class Car
{
   public virtual Person Person { get; set; }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T00:17:03.770

假设它是一对一的关系，你可以这样做：

```
public class Car
{
    public int Id { get; set; }
    public int PersonId { get; set; }
    public Person Person { get; set; }
}

public class Person
{
    public int Id { get; set; }
    public string Name { get; set; }
}

public class CarConfiguration : EntityTypeConfiguration<Car>
{
    public CarConfiguration()
    {
        HasKey(i => i.Id);
        HasRequired(i => i.Person).WithMany().HasForeignKey(i => i.PersonId).WillCascadeOnDelete(false);
    }
} 
```

然后添加一个只使用该人的 ID 的人的新车，并假设具有该 ID 的人存在：

```
using (var ctx = new CarContext())
{
    var car = new Car();
    car.PersonId = 5;
    ctx.Cars.Add(car);
    ctx.SaveChanges();
} 
```

您可能会发现此[链接](http://weblogs.asp.net/manavi/archive/2011/05/01/associations-in-ef-4-1-code-first-part-5-one-to-one-foreign-key-associations.aspx)很有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T00:17:55.600

使用外键并相应地设置外键属性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T08:01:23.607

我还没有运行它来确认，但我相信实体框架使用了一个基于约定的 ID 系统。这很可能会自动执行您不希望发生的事情。

```
class Car
{
   public virtual Person Person { get; set; }
   public virtual Int32   PersonID { get; set; }
} 
```

我打算从我以前见过的 NerdDinner 项目中发布代码（[http://nerddinner.codeplex.com/](http://nerddinner.codeplex.com/)），但你可以查看它，因为它是相当多属性的代码。

# sql - 如何在 sql 语句 where 子句中使用 Char(39)？

> ID：14657056
> 
> 赞同：2
> 
> 时间：2013-02-01T23:57:01.870
> 
> 标签：sql, sql-server

我正在使用 SQL Server 2008 R2。我正在尝试基于 sql 语句创建记录集。在`WHERE`子句中是`'INTERNATIONAL PEOPLE' + Char(39) + 'S'`. 所以单引号使它成为人们的。这是失败的。从研究看来，这应该不会失败。任何帮助都会很棒。谢谢

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-02-02T00:00:38.970

您可以通过单引号转义单引号:)

```
WHERE field = 'INTERNATIONAL PEOPLE''S' 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-02-02T03:27:32.127

从您在评论中的示例中，我猜这是因为您的表已命名`1099`，而错误并不是真正来自您的`WHERE`子句。T-SQL 要求表名以字母字符开头。

尝试在其周围加上括号：

```
SELECT * FROM [1099] WHERE Name ='INTERNATIONAL PEOPLE' + CHAR(39) + 'S' 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-02T00:54:07.297

你能发布你的查询吗？转义单引号 -''- 应该有效。使用下面的代码进行测试。

```
IF OBJECT_ID('TempDB..#SingleQuoteTest') IS NOT NULL
BEGIN
    DROP TABLE #SingleQuoteTest
END

CREATE TABLE #SingleQuoteTest
(
Value   VARCHAR(MAX)
)

INSERT INTO #SingleQuoteTest
(
Value
)
SELECT 'International People'
UNION SELECT 'International People''s'
UNION SELECT 'John O''connor'

SELECT  Value 
FROM    #SingleQuoteTest 
WHERE   Value = 'International People''s'
--WHERE Value = 'John O''connor' 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-05-31T19:14:03.493

撇号 s 是撰写报告的基本要素。这是一个例子。在这种情况下，它赋予了一个人的占有欲。

```
 SELECT TitleAndLastName = (Title + ' ' + LastName +CHAR(39) +'s' +  ' '  + 'address is:'), FullAddress = (AddressLine1 + City + cast(StateProvinceID as nvarchar) + PostalCode)
    FROM [Person].[Person] as p
        Inner Join [Person].[Address] as a
                   on a.AddressID = p.BusinessEntityID
            Where AddressLine1 is not null
             and Title is not null; 
```

上述查询的结果将包含每个人的姓氏 ('s)。

TitleAndLastName FullAddress

埃里克森女士的地址是：1226 Shoe St.Bothell 79 98011

Goldberg 先生的地址是：1399 Firestone DriveBothell 79 98011

祝你好运！

# java - AWT-EventQueue-0

> ID：14657059
> 
> 赞同：1
> 
> 时间：2013-02-01T23:57:11.900
> 
> 标签：java, swing, queue, awt

我有 4 节课

用户界面/产品用户界面

控制器/产品控制器

项目包/产品

project_package/ProductRecords

## 当我尝试按下“添加”按钮时，它会返回一个错误，如果我通过控制器运行它不会显示。我提出了两个相同的请求。

用户界面：

```
 package ui;

import java.awt.event.*;

import javax.swing.*;
import javax.swing.GroupLayout.Alignment;
import javax.swing.LayoutStyle.ComponentPlacement;
import javax.swing.UnsupportedLookAndFeelException;

import controller.ProductController;

public class ProductUI {

    private JFrame f;
    private JPanel page1, page2;
    private JTabbedPane tp;
    private JTextField addProductTextFieldName;
    private JTextField addProductTextFieldPrice;
    private JTextField addProductTextFieldDescription;
    private JTextField addProductTextFieldDiscount;
    private JTextField addProductTextFieldQuantity;
    private ProductController productCtrl;  

    public void display()
    {
        f.getContentPane().add(tp);
        tp.add("Add product", page1);
        tp.add("Edit product", page2);
        f.setSize(510,450);
        f.setVisible(true);
        f.setResizable(false);
    }

    public ProductUI()
    {

        f = new JFrame("Product UI");
        tp = new JTabbedPane();

        //**********************************
        // PAGE 1
        //**********************************

        page1 = new JPanel();

        JLabel addProductLabelName = new JLabel("Product Name");
        JLabel addProductLabelPrice = new JLabel("Product Price");      
        JLabel addProductLabelDescription = new JLabel("Product Description");      
        JLabel addProductLabelDiscount = new JLabel("Product Discount");        
        JLabel addProductLabelQuantity = new JLabel("Product Quantity");        
        JLabel addProductLabelLocation = new JLabel("Product Location");
        JCheckBox addProductCheckBoxAalborg = new JCheckBox("Aalborg");     
        JCheckBox addProductCheckBoxOdense = new JCheckBox("Odense");       
        JCheckBox addProductCheckBoxCopenhagen = new JCheckBox("Copenhagen");       
        JButton addProductButtonReset = new JButton("Reset");       
        JButton addProductButtonAdd = new JButton("Add");
        JButton addProductButtonClose = new JButton("Close window");
        JButton addProductButtonExit = new JButton("Exit");

        addProductTextFieldName = new JTextField(10);
        addProductTextFieldPrice = new JTextField(10);
        addProductTextFieldDescription = new JTextField(10);
        addProductTextFieldDiscount = new JTextField(10);
        addProductTextFieldQuantity = new JTextField(10);

        addProductButtonAdd.addActionListener(new ActionListener() {
            public void actionPerformed(ActionEvent e) {
                /*double productPrice = Double.parseDouble(addProductTextFieldPrice.getText());
                double productDiscount = Double.parseDouble(addProductTextFieldDiscount.getText());
                int productQuantity = Integer.parseInt(addProductTextFieldQuantity.getText());
                String productName = addProductTextFieldName.getText();
                String productDescription = addProductTextFieldDescription.getText();
                //productCtrl.createProduct(productName, productPrice, productDiscount, productDescription, productQuantity, "location");
                */
                productCtrl.createProduct("Test", 20.0, 20.0, "haha", 20, "nqkude");
            }   
        });

        GroupLayout gl_page1 = new GroupLayout(page1);
        gl_page1.setHorizontalGroup(
            gl_page1.createParallelGroup(Alignment.LEADING)
                .addGroup(gl_page1.createSequentialGroup()
                    .addGap(95)
                    .addGroup(gl_page1.createParallelGroup(Alignment.TRAILING)
                        .addGroup(gl_page1.createSequentialGroup()
                            .addGroup(gl_page1.createParallelGroup(Alignment.LEADING)
                                .addComponent(addProductLabelName)
                                .addComponent(addProductLabelPrice)
                                .addComponent(addProductLabelDescription)
                                .addComponent(addProductLabelDiscount)
                                .addComponent(addProductLabelQuantity)
                                .addComponent(addProductLabelLocation))
                            .addGap(82))
                        .addGroup(gl_page1.createSequentialGroup()
                            .addGap(34)
                            .addGroup(gl_page1.createParallelGroup(Alignment.TRAILING)
                                .addComponent(addProductButtonAdd, Alignment.LEADING, GroupLayout.DEFAULT_SIZE, 101, Short.MAX_VALUE)
                                .addComponent(addProductButtonClose, Alignment.LEADING, GroupLayout.DEFAULT_SIZE, 101, Short.MAX_VALUE))
                            .addGap(40)))
                    .addGroup(gl_page1.createParallelGroup(Alignment.LEADING, false)
                        .addComponent(addProductCheckBoxOdense)
                        .addComponent(addProductCheckBoxAalborg)
                        .addComponent(addProductTextFieldName, GroupLayout.DEFAULT_SIZE, 129, Short.MAX_VALUE)
                        .addComponent(addProductTextFieldPrice)
                        .addComponent(addProductTextFieldDescription)
                        .addComponent(addProductTextFieldDiscount)
                        .addComponent(addProductTextFieldQuantity)
                        .addGroup(gl_page1.createSequentialGroup()
                            .addPreferredGap(ComponentPlacement.RELATED)
                            .addGroup(gl_page1.createParallelGroup(Alignment.TRAILING, false)
                                .addComponent(addProductButtonExit, Alignment.LEADING, GroupLayout.DEFAULT_SIZE, GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                .addComponent(addProductCheckBoxCopenhagen, Alignment.LEADING, GroupLayout.DEFAULT_SIZE, GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                .addComponent(addProductButtonReset, Alignment.LEADING, GroupLayout.PREFERRED_SIZE, 96, GroupLayout.PREFERRED_SIZE))
                            .addGap(25)))
                    .addGap(100))
        );
        gl_page1.setVerticalGroup(
            gl_page1.createParallelGroup(Alignment.LEADING)
                .addGroup(gl_page1.createSequentialGroup()
                    .addGap(58)
                    .addGroup(gl_page1.createParallelGroup(Alignment.BASELINE)
                        .addComponent(addProductLabelName)
                        .addComponent(addProductTextFieldName, GroupLayout.PREFERRED_SIZE, GroupLayout.DEFAULT_SIZE, GroupLayout.PREFERRED_SIZE))
                    .addPreferredGap(ComponentPlacement.UNRELATED)
                    .addGroup(gl_page1.createParallelGroup(Alignment.BASELINE)
                        .addComponent(addProductLabelPrice)
                        .addComponent(addProductTextFieldPrice, GroupLayout.PREFERRED_SIZE, GroupLayout.DEFAULT_SIZE, GroupLayout.PREFERRED_SIZE))
                    .addPreferredGap(ComponentPlacement.UNRELATED)
                    .addGroup(gl_page1.createParallelGroup(Alignment.BASELINE)
                        .addComponent(addProductLabelDescription)
                        .addComponent(addProductTextFieldDescription, GroupLayout.PREFERRED_SIZE, GroupLayout.DEFAULT_SIZE, GroupLayout.PREFERRED_SIZE))
                    .addPreferredGap(ComponentPlacement.UNRELATED)
                    .addGroup(gl_page1.createParallelGroup(Alignment.BASELINE)
                        .addComponent(addProductLabelDiscount)
                        .addComponent(addProductTextFieldDiscount, GroupLayout.PREFERRED_SIZE, GroupLayout.DEFAULT_SIZE, GroupLayout.PREFERRED_SIZE))
                    .addPreferredGap(ComponentPlacement.UNRELATED)
                    .addGroup(gl_page1.createParallelGroup(Alignment.BASELINE)
                        .addComponent(addProductLabelQuantity)
                        .addComponent(addProductTextFieldQuantity, GroupLayout.PREFERRED_SIZE, GroupLayout.DEFAULT_SIZE, GroupLayout.PREFERRED_SIZE))
                    .addPreferredGap(ComponentPlacement.UNRELATED)
                    .addGroup(gl_page1.createParallelGroup(Alignment.BASELINE)
                        .addComponent(addProductLabelLocation)
                        .addComponent(addProductCheckBoxAalborg))
                    .addPreferredGap(ComponentPlacement.RELATED)
                    .addGroup(gl_page1.createParallelGroup(Alignment.TRAILING)
                        .addGroup(gl_page1.createSequentialGroup()
                            .addComponent(addProductCheckBoxOdense)
                            .addPreferredGap(ComponentPlacement.RELATED)
                            .addComponent(addProductCheckBoxCopenhagen)
                            .addGap(7)
                            .addComponent(addProductButtonReset))
                        .addComponent(addProductButtonAdd))
                    .addPreferredGap(ComponentPlacement.RELATED)
                    .addGroup(gl_page1.createParallelGroup(Alignment.BASELINE)
                        .addComponent(addProductButtonClose)
                        .addComponent(addProductButtonExit))
                    .addContainerGap(57, Short.MAX_VALUE))
        );
        page1.setLayout(gl_page1);

        //**********************************
        // PAGE 2
        //**********************************

        page2 = new JPanel();
        GroupLayout gl_page2 = new GroupLayout(page2);
        gl_page2.setHorizontalGroup(
            gl_page2.createParallelGroup(Alignment.LEADING)
                .addGap(0, 499, Short.MAX_VALUE)
        );
        gl_page2.setVerticalGroup(
            gl_page2.createParallelGroup(Alignment.LEADING)
                .addGap(0, 394, Short.MAX_VALUE)
        );
        page2.setLayout(gl_page2);
    }

    public static void main(String[] args) throws ClassNotFoundException, InstantiationException, IllegalAccessException, UnsupportedLookAndFeelException 
    {
        UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
        ProductUI productMenu = new ProductUI();
        productMenu.display();
    }
} 
```

* * *

```
package controller;

import project_package.*;

public class ProductController {

    ProductRecords productRecordsCtrl;

    public ProductController()
    {
        productRecordsCtrl = ProductRecords.getInstance();
    }

    public void createProduct(String name, double price, double discount, String description, int quantity, String location)
    {
        productRecordsCtrl.createProduct(name, price, discount, description, quantity, location);
    }
    } 
```

* * *

```
package project_package;

import java.util.ArrayList;
//import java.util.Arrays;
import java.util.List;

public class ProductRecords 
{
    private static ProductRecords instance = null;
    ArrayList<Product> products = new ArrayList<Product>();
    List<Integer> quantity = new ArrayList<Integer>();
    List<String> location = new ArrayList<String>();
    int productIndex = 0;

    public static ProductRecords getInstance()
    {
        if(instance == null)
        {
            instance = new ProductRecords();
        }
        return instance;
    }

    // add a product to the list
    public void addProduct(Product product, int quantity, String location)
    {
        products.add(product.getID(), product);
        this.quantity.add(product.getID(), quantity);
        this.location.add(product.getID(), location);
    }

    // create (add) a new product (to the shop list)
    public void createProduct(String name, double price, double discount, String description, int quantity, String location)
    {
        Product newProduct = new Product(productIndex, price, discount, name, description);
        addProduct(newProduct, quantity, location);
        productIndex++;
    }
} 
```

* * *

```
package project_package;
public class Product {

    int id;
    double price;
    double discount;
    String name;
    String description;

    public Product(int id, double price, double discount, String name, String description)
    {
        this.id = id;
        this.price = price;
        this.discount = discount;
        this.name = name;
        this.description = description;
    }
    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-02T00:08:14.780

完整的错误是这个

```
Exception in thread "AWT-EventQueue-0" java.lang.NullPointerException 
```

扔在这条线上

```
productCtrl.createProduct("Test", 20.0, 20.0, "haha", 20,"nqkude"); 
```

`productCtrl`由于尚未实例化的事实。你可以这样做：

```
productCtrl = new ProductController(); 
```

# javascript - Jquery li点击事件未触发

> ID：14657062
> 
> 赞同：1
> 
> 时间：2013-02-01T23:57:40.987
> 
> 标签：javascript, jquery, click

我一直在使用 JQuery，我在 JFiddle 上尝试了我的代码，它运行良好，但是当我在我的网站上这样做时，它根本不起作用，基本上我需要在我的用户列表中的列表项被点击时发送一个事件.

HTML

```
<!DOCTYPE html>
<html>
    <head>
        <link rel="stylesheet" href="https://dl.dropbox.com/s/r5pzakk4ikvck3t/style.css?dl=1">
        <script src="https://www.dropbox.com/s/2hdvqa4ma51m0pw/jquery-1.9.0.min.js?dl=1"></script>
        <title>Chat</title>
    </head>
    <body>
        <div id="userlist-container">
            <div id="userlist-title">User List</div><br />
        </div>

        <div id="main-container">
            <div id="messages">
            </div>
        </div>

        <div id="control-container">
            <input type="text" id="TxtMessage" placeholder="Message" onKeyPress="SendMsg(event)" style="text-align:center;" >
        </div>

        <div id="alert-container" hidden="hidden">
            <div id="alert-main">
                <span id="alert-content"></span>
            </div>
        </div>
     </body>
</html> 
```

Javascript

```
$("#userlist-container > li").click(function(e) {
    alert("TEST");
    var username = "@" + this.html + " ";
    $("TxtMessage").value(username);
    $("TxtMessage").focus();
}); 
```

编辑：

页面加载后，它会连接到服务器并添加`<li>lalala</li>`到`userlist-container`.

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-02T00:00:52.233

您在绑定中的选择器是错误的：

```
$("#userlist-container > li") 
```

没有`li`你的 HTML 是：

```
<div id="userlist-container">
    <div id="userlist-title">User List</div><br />
</div> 
```

此外，您似乎缺少`#`事件中的 id 选择器。

所以你的事件可能应该类似于：

```
$("#userlist-container > div").click(function(e) {
    alert("TEST");
    var username = "@" + this.html + " ";
    $("#TxtMessage").value(username);
    $("#TxtMessage").focus();
}); 
```

**编辑**

> should have probably told you guys that once it does some wizzard stuff, li's get added so there are actually li tags in there.

I added your code to a fiddle and no `li` tags seem to be added when inspecting the DOM.

The [**fiddle**](http://jsfiddle.net/YKjmy/)

That could be just the fiddle though, not sure. I'm assuming if the `li` tags are injected that you need to use delegate binding using `on` if you are using jquery 1.7 or later or `delegate` if you are using 1.6 or earlier.

Similar to this:

```
// jQuery 1.7 or later
$("#userlist-container").on("click", ">li", function(){
    alert("TEST");
    var username = "@" + this.html + " ";
    $("#TxtMessage").value(username);
    $("#TxtMessage").focus();
});

// jQuery 1.4.3 to 1.6.x
$("#userlist-container").delegate(">li", "click", function(){
    alert("TEST");
    var username = "@" + this.html + " ";
    $("#TxtMessage").value(username);
    $("#TxtMessage").focus();
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-01T23:58:54.173

您的选择器错误，添加 # 前缀表示 id

```
$("#TxtMessage").value(username);
$("#TxtMessage").focus(); 
```

如果您的点击事件甚至没有触发，请确保在加载文档*后附加事件*

```
$(document).ready(function(){  
    //code here  
}); 
```

# api - REST API - 使用 OAuth 2.0 保护

> ID：14657069
> 
> 赞同：1
> 
> 时间：2013-02-01T23:58:27.807
> 
> 标签：api, rest, symfony

我正在练习我的 Symfony 2 技能，并想为我的一个小型应用程序设置一个简单的 REST API。

我已经在几分钟内用 FOSRestBundle 设置了 REST Api。完美。设置好之后，我决定使用 OAuth 来保护它。我决定使用 FOSOAuthServerBundle。这些东西工作得很好。

我已经阅读了大量的材料，我想知道我是否正确理解了所有的东西。我了解 OAuth 的工作原理，但我不确定这是否是解决我的问题的好选择。

事实上，会有很多消费者可用：用户将能够根据从 API 获取的数据创建自己的应用程序，可能还有 CMS 插件。

我想我在几个方面误解了 OAuth 协议：OAuth 是否总是需要最终用户操作（授予客户端应用程序权限）？在 access_token 过期后，用户是否总是需要重新授权应用程序？

假设用户想要在我的 API 中获取他的内容 - 只是为了获取一些非敏感数据。它是否需要最终用户授权应用程序？我想我在这里有点迷路了。

为了避免问题，是的，我已经读过几次并且一直在读；）我只是认为最好问而不是复制糟糕的解决方案、实践和错误的知识[。](https://www.rfc-editor.org/rfc/rfc6749)

# java - Java 8 Map 和 Reduce 不运行

> ID：14657071
> 
> 赞同：3
> 
> 时间：2013-02-01T23:58:45.783
> 
> 标签：java, lambda, java-8, openjdk

我正在使用 Project Lambdas 的 .map() 方法从 List 对象中提取一些数据。之前，Jdk 1.8 包含 Mapper 接口，但现在，我看到它的 map 方法获取 Function 接口。我的方法用法如下：

```
 List<Nut> nutList =new ArrayList<Nut>(); 
```

我已经向 nutList 添加了一些项目，并且我使用以下方法通过 getter 提取字段值。

```
nutList.stream().map(n->n.getShell()) 
```

但是上面的 n 参数表现得像一个对象，它不访问原始对象的方法。此用法通常使用 Mapper 功能接口运行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T10:22:29.570

在b75下，以下代码编译运行正常：

```
 List<Nut> nutList =new ArrayList<>();
    nutList.stream().map(n -> n.getShell()).forEach(System.out::print); 
```

也许您使用的是旧版本？

# ruby - Sinatra/Rack `ERROR URI::InvalidURIError: bad URI(is not URI?)` 重定向

> ID：14657074
> 
> 赞同：1
> 
> 时间：2013-02-01T23:59:01.607
> 
> 标签：ruby, escaping, sinatra, uri, rack

我刚刚开始了我的第一个 Sinatra 项目，一个简单的电视节目管理 Web 应用程序，并且想要拥有漂亮的 URL。因此，当用户在搜索框中键入并提交时，我不想使用`/?search=foobar`-style URL，而是希望将它们重定向到`/search/foobar`. 这也使我能够将`get '/search/:name`路线与主要`get '/'`路线分开。我已经使用`before`过滤器实现了重定向并正确转义了`params[]`变量：

```
before do
    if params.has_key? 'search'
        redirect to("/search/#{URI.escape(params['search'])}")
    end
end 
```

后来我继续

```
get '/search/:query' do
    result = search_api params[:query]
    if result == 'null'
        # no results
    else
        result = JSON.parse(result)
        if result.key? 'shows'
            # display search results
        else
            # redirect to one single show
            # (result.keys).first is the real name of the show provided
            # by the api. It may contain special characters
            #
            # (result.keys).first #=> "Breaking Bad"
            # result.keys #=> "Breaking Bad"
            # result.key? "Breaking Bad" #=> true
            redirect to('/show/#{URI.escape((result.keys).first)}')
        end
    end
end 
```

不幸的是，`/show`只有在名称中没有 URI 特殊字符（除了`%`. 这也意味着没有空格。当我搜索带有空格或变音符号或任何东西的东西时，例如`GET`for `/?search=Breaking%20Bad`，我从 Sinatra/Rack 收到以下错误：

```
[2013-02-02 00:30:29] ERROR URI::InvalidURIError: bad URI(is not URI?): http://localhost:9393/show/Breaking Bad
    /Users/Ps0ke/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/uri/generic.rb:1202:in `rescue in merge'
    /Users/Ps0ke/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/uri/generic.rb:1199:in `merge'
    /Users/Ps0ke/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/webrick/httpresponse.rb:220:in `setup_header'
    /Users/Ps0ke/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/webrick/httpresponse.rb:150:in `send_response'
    /Users/Ps0ke/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/webrick/httpserver.rb:110:in `run'
    /Users/Ps0ke/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/webrick/server.rb:191:in `block in start_thread' 
```

浏览器向我显示它已重定向到`/search/Breaking%20Bad`，因此第一个重定向有效。此“错误”仅在搜索产生精确命中时发生，因此重定向的问题是在`get '/search/:query'`路由中搜索。我记得它工作过一次，但在我的 git 历史记录中找不到正确的提交。

我在跑步

```
% gem list sinatra
sinatra (1.3.4, 1.3.3)

% gem list rack
rack (1.4.4, 1.4.1)
rack-cache (1.2)
rack-flash3 (1.0.3)
rack-protection (1.3.2, 1.2.0)
rack-ssl (1.3.2)
rack-test (0.6.2, 0.6.1) 
```

也许你们中的某个人可以告诉我：

1.  这是好的还是坏的做法/在 sinatra 中有另一种方式来美化 URL
2.  如何解决这个问题，因为我认为我已经小心翼翼地逃脱了一切

非常感谢你:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T17:31:34.503

在行

```
redirect to('/show/#{URI.escape((result.keys).first)}') 
```

您正在使用单引号。这意味着不执行字符串插值，因此将文字字符串`/show/#{URI.escape((result.keys).first)}`用作 url，这就是它失败的原因。

为了使插值起作用，您需要使用这样的双引号：

```
redirect to("/show/#{URI.escape((result.keys).first)}") 
```

这将导致`#{URI.escape((result.keys).first)}`被转义的电影名称替换，这应该是一个有效的 url。

请注意，在您的第一个重定向中，您确实使用了双引号，因此它按预期工作：

```
redirect to("/search/#{URI.escape(params['search'])}") 
```

# javascript - 对象的覆盖在 chrome 中是错误的，但在 Firefox 中有效

> ID：14657075
> 
> 赞同：0
> 
> 时间：2013-02-01T23:59:03.983
> 
> 标签：javascript, google-chrome, firefox, scroll

我有一个关于我正在从事的项目的问题。

网站是 www.AC-photography.net

在 Firefox 中打开时，可以点击“开始滚动”，但在 chrome 中打开时，该层前面似乎有东西。有人可以协助如何在 chrome 中进行这项工作。我将发布有关的 html

```
<div id="main">
    <header id="top">
        <div class="color_bar"></div>
    </header>

    <div class="title">
        <div class="logo">
            <img src="images/logo.png" alt="" />
        <!-- <p class="intro_text"> Alex Cherkasov | Art Director </p>-->
            <a href="#portfolio" class="smoothScroll"><p class="sub_intro">Start Scrolling</p></a>          
        </div>
    </div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T00:33:27.643

直接的问题似乎是您的 .title 类上的 z-index: auto - 将其设置为高于 800，在 Chrome 中应该没问题。

除此之外，您还可以清理语法 - 锚内的段落（内联内的块级别），第二个实际上未定义为块，正在自找麻烦！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T00:31:52.460

看起来它缺少一个结束`</div>`标签。这可能是问题所在。

# c++ - 是declval () 和 (*(T*)nullptr) 一样吗？

> ID：14657092
> 
> 赞同：25
> 
> 时间：2013-02-02T00:01:10.510
> 
> 标签：c++, c++11, decltype

只是`declval<T>()`替代`(*(T*)NULL)`在 decltype 中获取 T 的实例而不需要担心 T 的构造函数的旧技巧吗？

这是一些示例代码：

```
struct A {};

struct B {
    A a;
};

typedef decltype((*(B*)nullptr).a) T1;
typedef decltype(declval<B>().a) T2;

cout << "is_same: " << is_same<T1, T2>::value << endl; 
```

打印 1 因为 T1 和 T2 是相同的类型。

如果 declval 不仅仅是替代品，那么有什么区别，它在哪里有用？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2013-02-02T00:06:30.767

`declval()`其优点是，如果在评估的上下文中使用它（即 odr-used），则程序格式错误（20.2.4p2），并且需要发出诊断（每 1.4p1）。通常这是通过`static_assert`库中的 a 强制执行的：

```
c++/4.7/type_traits: In instantiation of '[...] std::declval() [...]':
source.cpp:3:22:   required from here
c++/4.7/type_traits:1776:7: error: static assertion failed: declval() must not be used! 
```

`declval`也适用于引用类型：

```
using S = int &;
using T = decltype(std::declval<S>());
using U = decltype(*(S *)nullptr);  // fails 
```

如果类型*不是*引用类型，`declval`将给出一个右值类型，其中`nullptr`给出一个左值。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-02-02T12:45:30.163

不，`declval<T>()`不一样`(*(T*)nullptr)`。和`decltype(expr.bar)`不一样`decltype((expr.bar))`。

前一个比较比较表达式。后一种使用`decltype`检查表达式，前一种使用`decltype`检查声明的类型`expr.bar`。所以你必须限制你对`decltype`操作数的使用，以便对类型进行有用的比较，你会发现它们是不同的。

```
struct A {};

struct B {
    A a;
};

// E1: B().a 
// E2: declval<A>().a
// E3: (*(B*)0).a
// E4: ((B&&)(*(B*)0)).a 
```

在这 4 个表达式中，所有表达式都有 type `A`。`E1`是一个纯右值（在 C++14 中它是一个 xvalue。即使在 C++11 模式下，一些编译器也可能会将它视为一个 xvalue），`E2`是一个 xvalue。`E3`是一个左值，又`E4`是一个 xvalue。

```
// T1: decltype((*(B*)0).a)
// T2: decltype(((*(B*)0).a)) 
```

在这两种类型中，第一个 decltype 给出了表达式命名的成员的类型。成员有类型`A`，所以`T1`也是`A`。第二个 decltype 产生表达式的类型，`&`如果表达式是左值则修改，`&&`如果表达式是 xvalue 则修改。表达式是左值，所以`T2`也是`A&`。

# android - 单击xml中的按钮时如何添加声音

> ID：14657097
> 
> 赞同：0
> 
> 时间：2013-02-02T00:01:38.927
> 
> 标签：android, xml, eclipse, audio, button

我想编写一个按钮以在您点击它时发出声音。如果我有一个像 test.ogg 或 test.wav 这样的声音文件，我怎么能做到呢？我对 xml 有点陌生，所以有点描述性。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T00:04:26.843

您可以使用`android:onClick="sendMessage"`, 并在您的活动中创建一个函数，如下所示：

```
/** Called when the user touches the button */
public void sendMessage(View view) {
    // Play your sound
} 
```

每当用户单击您的按钮时，它都会触发此功能，从而播放您的声音。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-02T00:14:49.303

您可以通过[playSoundEffect()](http://developer.android.com/reference/android/view/View.html#playSoundEffect%28int%29)`View`方法使用标准机制来设置声音资源。

您需要以编程方式或在您的视图[android:soundEffectsEnabled="true"的 xml 中设置](http://developer.android.com/reference/android/view/View.html#attr_android%3asoundEffectsEnabled)[setSoundEffectsEnabled(true)](http://developer.android.com/reference/android/view/View.html#setSoundEffectsEnabled%28boolean%29)。

# r - R - 按具有重复条目的变量列合并

> ID：14657104
> 
> 赞同：4
> 
> 时间：2013-02-02T00:02:54.103
> 
> 标签：r, sorting, merge, duplicates

我正在尝试按 ID 合并两个不同大小的数据。但是，对于匹配的值，两个数据都包含重复的条目，即数据A中可能有三个ID#3，数据B中可能有三个ID#3。当我尝试合并数据时，结果比两者都大得多数据结合。

> `C<-merge(A,B,by="ID",all.x=T,sort=F)`

我想通过 ID 列合并这两个数据，使得 B 中的第一个 ID #3 与 A 中的第一个 ID #3 配对，依此类推。

另外，我希望数据 A 的行顺序保持不变。sort=FALSE 并没有太大帮助：它将所有匹配的行放在顶部，将不匹配的行放在底部。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-02T01:12:13.290

在合并之前，您需要向每个 data.frame 添加一个列，该列的值记录每个观察值在其自己的 ID 组中的索引。

```
## Example data
A <- data.frame(ID=c(1,1,1,2), ht=1:4)
B <- data.frame(ID=c(1,1,2,2), wt=3:6)

## Add column with number of each observation within ID
A <- transform(A, ID2=ave(ID, ID, FUN=seq_along))
B <- transform(B, ID2=ave(ID, ID, FUN=seq_along))

## Now carry out the merge
merge(A, B, all.x=TRUE, sort=FALSE)
#   ID ID2 ht wt
# 1  1   1  1  3
# 2  1   2  2  4
# 3  2   1  4  5
# 4  1   3  3 NA 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-05T08:50:28.237

感谢您的帮助，它真的很有用。我最终将一列数字添加到我想要保留顺序的较大数据中。

使用@Josh O'Brien 的例子，

```
> ## Example data
> A <- data.frame(ID=c(1,1,1,2), ht=1:4)
> B <- data.frame(ID=c(1,1,2,2), wt=3:6)
> 
> ## Add column with number of each observation within ID
> A <- transform(A, ID2=ave(ID, ID, FUN=seq_along))
> B <- transform(B, ID2=ave(ID, ID, FUN=seq_along))
> 
> # Add a new column in A that numbers the row from 1 to number of row
> A$ORDER_DATA <- 1:nrow(A) 
> 
> ## Now carry out the merge
> C<-merge(A, B, all.x=TRUE, sort=FALSE)
> 
> # Sort the merged data by ORDER_DATA column
> D<-C[with(C,order(ORDER_DATA)),]
> D
  ID ID2 ht ORDER_DATA wt
1  1   1  1          1  3
2  1   2  2          2  4
4  1   3  3          3 NA
3  2   1  4          4  5 
```

# php - 带有 header() 的 PHP post 函数

> ID：14657107
> 
> 赞同：-2
> 
> 时间：2013-02-02T00:03:11.687
> 
> 标签：php, post

我是 PHP 新手。我想通过邮寄将数据从一页发送到另一页。

```
if(isset($_REQUEST['submit']))
{

header("location:nextpage.php");
//here i want to send data coming from my text box's by post function
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T00:04:54.443

您应该从正确的页面开始。

```
<form action="your-processing-script.php" method="post"> 
```

请记住，该操作是相对的，因此根据您的文件结构，您可能需要在文件 url 前加上斜杠以防止混淆。

```
/your-processing-script.php 
```

# wordpress - 如何按 wordpress 中的自定义日期字段对自定义分类页面进行排序？

> ID：14657114
> 
> 赞同：2
> 
> 时间：2013-02-02T00:04:33.553
> 
> 标签：wordpress, date, sorting, taxonomy

我想做的是通过“日期”元键对出现在由不同分类子级过滤的页面上的所有帖子进行排序。

我发现了这个通用的 query_posts 函数：

```
query_posts('&meta_key=date&orderby=meta_value&order=DESC') 
```

这会抓取所有帖子并将它们放在一个页面上，并按我的自定义元键对它们进行排序。我仍希望将页面按给定的分类/术语分开，但按此日期 meta_key 对所有这些进行排序。我希望我已经正确解释了这一点。非常感谢，谁能帮忙！

# c# - 将 vb.net 转换为 c#- 优化参数传递

> ID：14657115
> 
> 赞同：2
> 
> 时间：2013-02-02T00:04:41.223
> 
> 标签：c#, vb.net, parameters, byref, byval

我想将一个 vb.net 应用程序移动到 c#。vb.net 应用程序有数千个应该是 byval 的 byref 参数。有人知道自动检查每个参数传递方法是否可以安全更改的方法吗？

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2013-02-02T00:59:08.840

也许以下工具[http://www.developerfusion.com/tools/convert/vb-to-csharp/](http://www.developerfusion.com/tools/convert/vb-to-csharp/)可以帮助你。

# c - 如何将文件路径放入剪贴板，以便将其作为文件粘贴到文件管理器中？

> ID：14657116
> 
> 赞同：1
> 
> 时间：2013-02-02T00:04:46.360
> 
> 标签：c, linux, gtk, clipboard

我希望用户能够将存储在磁盘上的文件从我的 GTK 应用程序复制到像 Nautilus 这样的普通文件管理器。我怎样才能做到这一点？我宁愿只在剪贴板中写入一个路径，让文件管理器负责实际复制，这可能吗？

我刚刚发现了一个示例，在该示例中，实际文件数据似乎是通过剪贴板传输的——但这是唯一可能的方式吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T19:25:10.827

您需要 CF_HDROP 和可能的其他 shell 剪贴板格式。请参阅：http: [//msdn.microsoft.com/en-us/library/windows/desktop/bb776902](http://msdn.microsoft.com/en-us/library/windows/desktop/bb776902(v=vs.85).aspx) (v=vs.85).aspx ；

# javascript - 函数参数是否支持 JavaScript 中的默认值？

> ID：14657117
> 
> 赞同：17
> 
> 时间：2013-02-02T00:04:50.137
> 
> 标签：javascript, function, arguments

在查看与将[PHP 函数移植到 JavaScript](https://stackoverflow.com/questions/14656887/whats-wrong-with-my-javascript-code/)相关的问题时。我看到了我认为不正确的 JavaScript：

```
function my_isnum(str, negative=false, decimal=false) 
```

然后我在[JSFiddle](http://jsfiddle.net/M9KTN/1/)中尝试了这个：

```
function my_isnum(str, negative=false, decimal=-2)
{
    console.log(arguments);
    console.log(str);
    console.log(negative);
    console.log(decimal);
}
my_isnum("5", "Hi"); 
```

令我惊讶的是，这就是我在 Firebug 控制台中看到的内容：

```
["5", "Hi"]
5
Hi
-2 
```

现在在 Chrome 中，这就是我所看到的：

```
Uncaught SyntaxError: Unexpected token = 
```

我不明白这是 Firefox 支持的一些早期标准的一个例子（MDN 上[`function`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Statements/function)似乎没有提到这一点）？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-02-02T00:08:28.833

这似乎在 ECMAScript 6 规范中，目前只有 Firefox 支持

[https://developer.mozilla.org/en-US/docs/JavaScript/Reference/default_parameters](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/default_parameters)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-02-02T00:28:05.120

Lostsource 的回答是正确的，来到 ECMA6，很可能支持默认值，我认为它会，但由于它仍然是一个工作草案，你不能确定......现在，你可以使用逻辑或：

```
function foo(bar, foobar)
{
    bar = bar || 'foobar';//once
    foobar = foobar || !!bar || true;//or multiple times 
```

这有点像三元组。表达式从左到右解析：一旦 JS 遇到一个真值，这就是将被分配的值：

```
var someVar = false || undefined || null || 0 || 1; 
```

将 1 分配给`someVar`。如果没有值传递给函数，则`undefined`默认分配所有参数，因此在这种情况下：

```
myArgument = myArgument || 'default';
//is the same as:
myArgument = undefined || 'default';//evaluates to "default" 
```

但是当你`false`作为参数传递时，或者`null`，或者一个空字符串，默认值将被分配，所以要小心。
在这些情况下，if/ternary 更合适（如 JollySin 的回答所示）。其三元等价物是：

```
some_val = typeof some_val === 'undefined' ? 'default' : some_val; 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-02-02T00:07:00.333

有点。您可以执行以下操作：

```
function the_func(some_val) {
    // if some_val is not passed to the_func 
    if (typeof some_val == 'undefined') {
        some_val = 'default_some_val';
    }

    // now you can use some_val in the remaining parts of the method
} 
```

# actionscript-3 - getChildByName 与正则表达式

> ID：14657122
> 
> 赞同：1
> 
> 时间：2013-02-02T00:05:17.400
> 
> 标签：actionscript-3, flash

我有：

```
stage.getChildByName("button_1")

button_1

button_2

button_3

button_...

button_15 
```

我可以很容易地创建一个 var XSample 来存储数字，运行语句，增加 +1 XSample 并将 XSample.toString() 与“button_”一起使用

但是事情会稍微复杂一点，所以我需要在 button_ 之后获取所有内容

```
stage.getChildByName("button_" + everything)
// it could be button_5, button_Ag6, button_0086, button_93 and so on 
```

我怎么能用正则表达式做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T02:47:33.633

**用例：**

```
import flash.display.Shape;
import flash.display.Sprite;

var shapeContainer:Sprite = new Sprite();

addChild(shapeContainer);

var shape_1:Shape = new Shape();
shape_1.name = "shape_ONE";

var shape_2:Shape = new Shape();
shape_2.name = "displayObject_TWO";

var shape_3:Shape = new Shape();
shape_3.name = "shape_THREE";

shapeContainer.addChild(shape_1);
shapeContainer.addChild(shape_2);
shapeContainer.addChild(shape_3);

trace(getIndicesWithChildNamePattern("shape_", shapeContainer)); //0, 2 
```

**使用 String.indexOf()：**

```
function getIndicesWithChildNamePattern(pattern:String, container:DisplayObjectContainer):Vector.<uint>
{
    var indices:Vector.<uint> = new Vector.<uint>();

    for (var i:uint = 0; i < container.numChildren; i++)
    {
        if (container.getChildAt(i).name.indexOf(pattern) != -1)
        {
            indices.push(i);
        }
    }

    return indices;
} 
```

**使用正则表达式：**

```
function getIndicesWithChildNamePattern(pattern:String, container:DisplayObjectContainer):Vector.<uint>
{
    var indices:Vector.<uint> = new Vector.<uint>();
    var regExp:RegExp = new RegExp(pattern, "g");

    for (var i:uint = 0; i < container.numChildren; i++)
    {
        if (container.getChildAt(i).name.match(regExp).length)
        {
            indices.push(i);
        }
    }

    return indices;
} 
```

# python - Django 找不到模板 - 投票应用程序第 3 部分

> ID：14657124
> 
> 赞同：0
> 
> 时间：2013-02-02T00:05:50.860
> 
> 标签：python, django, django-templates, django-views

我正在关注民意调查应用教程第 3 部分，但找不到模板

这是确切的错误

```
polls/index.html
Request Method: GET
Request URL:    http://localhost:8000/polls/
Django Version: 1.4.3
Exception Type: TemplateDoesNotExist
Exception Value:    
polls/index.html
Exception Location: c:\Python27\lib\site-packages\django\template\loader.py in find_template, line 138
Python Executable:  c:\Python27\python.exe
Python Version: 2.7.2 
```

所以在我的 settings.py 中，我把目录放在那里。“C:/Scripts/mysite/template”并创建/polls/index.html

```
TEMPLATE_DIRS = (
    # Put strings here, like "/home/html/django_templates" or "C:/www/django/templates".
    # Always use forward slashes, even on Windows.
    # Don't forget to use absolute paths, not relative paths.
    "C:/Scripts/template"
    "C:/Scripts/mysite/template"
) 
```

它由于某种原因找不到它。有任何想法吗？这是教程中的确切说明。

> 在文件系统的某个位置创建一个目录，Django 可以访问其内容。（Django 以您的服务器运行的任何用户身份运行。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T09:15:57.753

您在第一行末尾缺少一个逗号：

```
"C:/Scripts/template",   # <--- HERE
"C:/Scripts/mysite/template" 
```

没有它，Python 会自动连接两个字符串（因为它们在括号内），这样它就变成了`"C:/Scripts/templateC:/Scripts/mysite/template"`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-02T00:49:37.837

### 调试

1.  从您的应用程序主文件夹中，运行以下命令：`python manage.py shell`这将使用设置文件引导您的应用程序。
2.  输入`from django.conf import settings`并按回车
3.  输入`settings.TEMPLATE_DIRS`并检查输出。您看到您指定的模板目录了吗？

### 相对于 settings.py 文件的绝对路径

我通常使用相对于 settings.py 文件的绝对路径。这样，协作者可以共享一个主设置文件，并且无论您将什么系统/环境部署到您的路径都是正确的。

去做这个：

```
# settings.py
import os

# ... other settings

TEMPLATE_DIRS = (
    os.path.join(os.path.normpath(os.path.dirname(__file__)), 'templates'),
) 
```

如果调试步骤没有帮助，请告诉我，我会尝试提供更多帮助。

# java - Java中的随机正态分布返回超出范围的值

> ID：14657143
> 
> 赞同：1
> 
> 时间：2013-02-02T00:07:09.583
> 
> 标签：java, random, normal-distribution

> **可能重复：**
> [Random.nextGaussian() 的问题](https://stackoverflow.com/questions/629798/problem-with-random-nextgaussian)

我正在开发小型 Java 应用程序以进行随机正态分布并给出 50 个值。我使用 mean = 0.0 和 std = 1.0，但是我得到的结果超出范围的问题是一些值小于 0.0 和大于 1.0 ，有人可以帮助我吗？

以下是我使用的代码：

```
public static void main(String[] args) {

    double[] list = new double[50];
    double mean = 0.0, std = 1.0;
    Random rng = new Random();

            // to generate 50 values random normal distribution
    for(int i = 0;i<list.length;i++) {
      list[i] = mean + std * rng.nextGaussian();
    }

            // to print the generated values from the list
    for(int i = 0;i<list.length;i++) 
            {
            System.out.println(list[i]); 
    }

} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-02T00:13:11.410

nextGaussian() 从这个随机数生成器的序列返回下一个伪随机高斯（“正常”）分布双精度值，平均值为 0.0，标准差为 1.0。（[http://docs.oracle.com/javase/1.4.2/docs/api/java/util/Random.html#nextGaussian()](http://docs.oracle.com/javase/1.4.2/docs/api/java/util/Random.html#nextGaussian())）

`std * rng.nextGaussian();`应该是这样`std * (1 + rng.nextGaussian())/2`；

然而，结果可能不是你想要的高斯，你需要用不同的`a`和调整平均值和标准差`b``(a + rng.nextGaussian())/b`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-02T00:12:10.397

我认为您没有`nextGaussian()`正确解释的含义和目的。如果您想要一个范围内的数字`[0.0, 1.0)`，请`nextDouble()`改用。

`nextGaussian()`使用平均值和标准差，***而不是简单的数字范围***。因此，它理论上具有无限的返回值范围（`double`至少在范围内）。`nextGaussian()`在[这个 java 文档](http://docs.oracle.com/javase/1.4.2/docs/api/java/util/Random.html#nextGaussian%28%29)中阅读更多信息

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-02T00:20:24.370

我认为您将标准偏差与值的范围混淆了。它们不是同一件事。

取自[标准偏差维基百科](http://en.wikipedia.org/wiki/Standard_deviation#Interpretation_and_application)条目：

> 例如，{0, 0, 14, 14}、{0, 6, 8, 14} 和 {6, 6, 8, 8} 三个总体的均值为 7。它们的标准差分别为 7、5 , 和 1, 分别。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-02T00:21:10.643

据我了解，Javadoc for`nextGaussian()`说：

> 从该随机数生成器的序列返回下一个伪随机、高斯（“正常”）分布双精度值，均值为 0.0，标准差为 1.0。

它没有说该值将从-1到1。然后，如果您希望它处于该值中，则可以丢弃外部值或在值位于外部时取-1或1。

# java - 静态错误：此类没有接受 String[] 的静态 void main 方法

> ID：14657147
> 
> 赞同：0
> 
> 时间：2013-02-02T00:07:55.060
> 
> 标签：java

我正在学习，我是新手，但我想知道如何才能“运行”它。这发生了一个错误：

```
Static Error: This class does not have a static void main method accepting String[]. 
```

这是代码：

```
/**
 * @author "LionH"
 */
public class Caneirinho {

    public static void contar() {
        int i = 1;
        String a = " Carneirinho",
            b = " pulando a cerca.",
            c = "s";

        for (i = 1; i <= 100; i++) {
            if (i == 1) {
                System.out.println(i + a + b);
            } else {     
                System.out.println(i + a + c + b);
            }
        }
    }
} // Carneirinho 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-02T00:10:25.543

任何你直接运行的Java 类都必须有一个`main`方法，它是入口点，即当你执行代码时程序开始的地方。

```
public static void main(String args[]) 
```

只需将您的方法重命名`contar()`为`main(String args[])`，它应该可以工作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-02T00:20:16.450

替代@mellamokb 答案

```
public class Caneirinho{

 public static void contar(){
   int i = 1;
   String a = " Carneirinho",
     b = " pulando a cerca.",
     c = "s";

   for(i=1; i<=100; i++){
     if(i==1){
       System.out.println( i + a + b );
      } else {     
        System.out.println( i + a + c + b ); 
        Thread.sleep(1000);  // thread wais for 1 sec ie 1000 milisecond    
      }     
    }
  }

public static void main(String[] args){
   contar(); // call contar() from main method
}

}//Carneirinho 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-02T01:11:30.023

如果您编写一个 java 程序，它可以有许多类，但要运行所有类，我们应该有一个主类，用于实现我们定义的类。您创建了一个没有 main 的类。该程序将从 main 开始执行。

# javascript - iPhone Javascript 确认对话框错误

> ID：14657150
> 
> 赞同：2
> 
> 时间：2013-02-02T00:08:18.033
> 
> 标签：javascript, ios, jquery-mobile, mobile, dialog

我弹出了一个javascript确认对话框，但是当我点击“取消”时，在对话框关闭后，点击屏幕上的任意位置，对话框再次弹出。它只会发生一次额外的时间，然后您可以再次点击页面而不会弹出对话框。

我只在运行 iOS 5.0.1 的 iPhone/iPad 上看到这个。我没有 iOS 6 设备，所以我不确定它是否在那里发生。

这是我正在使用的代码：

```
$(bpm.remoteAppDivName).on('tap', 'a.delete-pending-payment', function(event) { 

    if  (isJQMGhostClick(event)) { return false; }

    var deleteGlobalPaymentURL = $(this).attr('href');

    var confirmMsg = confirm ("Are you sure you want to do that?"); 

    if (confirmMsg === true){

        window.location = '/index.htm';

    }
    event.preventDefault();
    return false;

});

var lastclickpoint, curclickpoint;
var isJQMGhostClick = function(event){
    curclickpoint = event.clientX+'x'+event.clientY;
    var ret=false; 
    if (lastclickpoint === curclickpoint) {
        ret=true;
    } else {
        ret=false;
    }
    lastclickpoint = curclickpoint;
    return ret;
} 
```

这是问题页面的链接：[http ://www.5280skateparks.com/dev/confirmBug.htm](http://www.5280skateparks.com/dev/confirmBug.htm)

任何帮助将不胜感激。

**更新：**我刚刚确认它也在 iOS 6.0.1 上发生。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T00:23:19.957

[这是此处](https://developers.google.com/mobile/articles/fast_buttons)和[此处](http://forum.jquery.com/topic/tap-fires-twice-with-live-tap)详细讨论的 jQuery Mobile“Ghost Click” 。在论坛页面上，提出了一个解决方案，我在下面复制了一个小错误修复：

```
var lastclickpoint, curclickpoint;
var isJQMGhostClick = function(event){
    curclickpoint = event.clientX+'x'+event.clientY;
    var ret=false; 
    if (lastclickpoint === curclickpoint) {
      ret=true;
    } else {
      ret=false;
    }
      lastclickpoint = curclickpoint;
   return ret;
} 
```

我已经稍微修改了这段代码，以不总是期望有两次点击。现在，此功能在 0 次重影点击和 2 次以上重影点击的情况下可以正常工作。您可以通过`isJQMGhostClick(event)`在点击处理程序的开头检查并在`isJQMGhostClick`函数返回 true 时忽略事件来使用它。

# android - 什么触发了android上的软键盘？

> ID：14657152
> 
> 赞同：0
> 
> 时间：2013-02-02T00:08:23.810
> 
> 标签：android, android-softkeyboard, options

嗨，我坚持认为是一个小问题，但这让我很头疼。

我有 4 个按钮和 10 个 EditText 视图的活动，当活动开始时，用户必须根据自己的需要选择相应的按钮，然后在 edittext 字段中输入值。现在，当应用程序开始关注第一个 edittext 选择并出现软键盘时，我不希望发生这种情况。

我已经删除了图形布局编辑器上的请求焦点标签，并在 XML 文件中尝试了同样的事情，但问题仍然存在。

请告诉我哪些选项可以调节键盘的外观？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T00:33:29.510

`android:windowSoftInputMode="stateHidden"`您可以通过将属性添加到相应的清单活动节点来防止键盘在应用启动时弹出。

```
<activity android:name=".MyMainActivity" android:windowSoftInputMode="stateHidden" /> 
```

# cakephp - 用 CakePHP 提供 JSONP 的正确方法是什么？

> ID：14657154
> 
> 赞同：5
> 
> 时间：2013-02-02T00:08:55.310
> 
> 标签：cakephp, jsonp

我想用 CakePHP 提供 JSONP 内容，并且想知道这样做的正确方法是什么。

目前我可以按照这个 CakePHP[指南](http://book.cakephp.org/2.0/en/views/json-and-xml-views.html)自动提供 JSON 内容。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-03T01:21:43.243

好的，我在这个[网站](http://php-tips.com/php/cakephp-php/2013/01/how-to-return-jsonp-response-on-cakephp)上找到了解决方案。基本上，您可以使用以下方法覆盖 afterFilter 方法：

```
public function afterFilter() {
    parent::afterFilter();

    if (empty($this->request->query['callback']) || $this->response->type() != 'application/json') {
        return;
    }

    // jsonp response
    App::uses('Sanitize', 'Utility');
    $callbackFuncName = Sanitize::clean($this->request->query['callback']);
    $out = $this->response->body();
    $out = sprintf("%s(%s)", $callbackFuncName, $out);
    $this->response->body($out);
} 
```

我希望它也对其他人有所帮助。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-03-10T12:27:09.860

我还没有找到如何使用 CakePHP 2*正确*返回 JSONP 的完整示例，所以我将把它写下来。OP 要求正确的方法，但他的答案没有使用 2.4 中现在可用的本机选项。对于 2.4+，这是正确的方法，直接来自他们的文档：

1.  设置您的视图以接受/使用 JSON（[文档](http://book.cakephp.org/2.0/en/views/json-and-xml-views.html)）：

    *   添加`Router::parseExtensions('json');`到您的`routes.php`配置文件中。这告诉 Cake 接受`.json`URI 扩展
    *   添加`RequestHandler`到您将要使用的控制器中的组件列表
    *   Cake 在这里变得很聪明，现在为您提供普通请求和 JSON/XML 等请求的不同视图，如果需要，您可以灵活地返回这些结果。您现在应该能够通过以下方式访问控制器中的操作：
        *   使用 URI `/controller/action`（将使用 中的视图`/view/controller/action.ctp`），或者
        *   使用 URI `/controller/action.json`（将使用 中的视图`/view/controller/json/action.ctp`）
2.  如果您不想定义这些视图，即您不需要做任何进一步的处理，并且响应已准备就绪，您可以告诉 CakePHP 忽略视图并立即使用`_serialize`. Using`_serialize`将告诉 Cake 以正确的格式（XML、JSON 等）格式化您的响应，设置标题并根据需要返回它，而无需执行任何其他操作（[文档](http://book.cakephp.org/2.0/en/views/json-and-xml-views.html#using-data-views-with-the-serialize-key)）。要利用这个魔法：

    *   像视图变量一样设置要返回的变量，即`$this->set('post', $post);`
    *   告诉 Cake 通过调用将其序列化为 XML、JSON 等`$this->set('_serialize', array('posts'));`，其中参数是您刚刚在上一行中设置的视图变量

就是这样。所有标头和响应都将由 Cake 接管。这只是让 JSONP 开始工作（[文档](http://book.cakephp.org/2.0/en/views/json-and-xml-views.html#jsonp-response)）：

3.  通过设置告诉Cake 将请求视为JSONP 请求`$this->set('_jsonp', true);`，Cake 将查找回调函数名称参数，并格式化响应以使用该回调函数名称。从字面上看，设置一个参数可以为您完成所有工作。

因此，假设您已将 Cake 设置为接受`.json`请求，这就是您使用 JSONP 时的典型操作：

```
public function getTheFirstPost()

    $post = $this->Post->find('first');

    $this->set(array(
        'post' => $post,                 <-- Set the post in the view
        '_serialize' => array('post'),   <-- Tell cake to use that post
        '_jsonp' => true                 <-- And wrap it in the callback function
    )
); 
```

和 JS：

```
$.ajax({
    url: "/controller/get-the-first-post.json",
    context: document.body,
    dataType: 'jsonp'
}).done(function (data) {
    console.log(data);
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-26T07:00:26.123

对于 CakePHP 2.4 及更高版本，您可以改为这样做。

[http://book.cakephp.org/2.0/en/views/json-and-xml-views.html#jsonp-response](http://book.cakephp.org/2.0/en/views/json-and-xml-views.html#jsonp-response)

所以你可以简单地写：

```
$this->set('_jsonp', true); 
```

在相关行动中。

或者你可以简单地写：

```
/**
 *
 * beforeRender method
 *
 * @return void
 */
    public function beforeRender() {
        parent::beforeRender();
        $this->set('_jsonp', true);
    } 
```

# perl - perl 中的链接中的 %3f 和 %3d

> ID：14657155
> 
> 赞同：2
> 
> 时间：2013-02-02T00:08:56.727
> 
> 标签：perl, decoding

我对 perl 很陌生，并编写了一个使用 LWP 从页面中提取链接的小脚本，结果被解码为这种格式：

[http://www.perlmonks.org/%3fnode_id%3d376075](http://www.perlmonks.org/%3fnode_id%3d376075)

而不是：

[http://www.perlmonks.org/?node_id=376075](http://www.perlmonks.org/?node_id=376075)

我不熟悉那种语法......它叫什么？有没有简单的方法可以将其翻译回来？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T00:23:18.067

```
http://www.perlmonks.org/%3fnode_id%3d376075 
```

和

```
http://www.perlmonks.org/?node_id=376075 
```

不是等效的 URL。应用于`uri_unescape`url 永远不会正确。它应该只用于提取的组件。第一个访问一个名为`?node_id=376075`. 第二个访问默认文件（恰好是`index.pl`）并传递一个名为的 arg`node_id`给它。

也许你实际上有类似的东西

```
foo.cgi?redirect=http://www.perlmonks.org/%3fnode_id%3d376075 
```

在这种情况下，您想要 URI。它既提取部分并解码它们。适当地。

```
use URI qw( );
my $url = URI->new('foo.cgi?redirect=http://www.perlmonks.org/%3fnode_id%3d376075');
my %form = $url->query_form();
say $form{redirect};  # http://www.perlmonks.org/?node_id=376075 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T00:15:12.717

这就是[URL 编码](http://www.w3schools.com/tags/ref_urlencode.asp "网址编码")的实际应用。

有几个 perl 库可以帮助解码，反之亦然。这是在快速搜索中弹出的一个：[http ://www.perlhowto.com/encode_and_decode_url_strings](http://www.perlhowto.com/encode_and_decode_url_strings)

# python - MongoDB ObjectID 的 JSON 序列化（ex-scope 查询）

> ID：14657157
> 
> 赞同：0
> 
> 时间：2013-02-02T00:09:14.903
> 
> 标签：python, python-2.7, pymongo, jsonserializer

我很困惑为什么变量 temp_dict 在其他条件之外可用？当我将数组保存到 MongoDB 时，它将在数组中的每个项目上设置 ObjectId。Json 解析器不知道如何序列化 ObjectId。

```
def read_temporary_file(filename, has_header=False):
    wb = load_workbook(filename=filename, use_iterators=True)
    ws = wb.get_active_sheet()  # ws is now an IterableWorksheet

    headers = []
    rows = []
    documents = []

    for row in ws.iter_rows():  # it brings a new method: iter_rows()
        if has_header:
            has_header = False
            for cell in row:
                headers.append(cell.internal_value)
        else:
            temp_dict = OrderedDict()
            for cell in row:
                temp_dict[cell.column] = cell.internal_value
            rows.append(temp_dict)
            documents.append(temp_dict)

    print("Saving documents to MongoDB")
    __save(documents)
    print("Printing %s" % temp_dict)
    return (headers, rows) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-02T00:13:45.223

在 Python 中，整个函数就是作用域。像你的 else 子句不是新的范围。

# c# - 在 c# 中使用 Task 测试 IAsyncOperation

> ID：14657158
> 
> 赞同：1
> 
> 时间：2013-02-02T00:09:31.597
> 
> 标签：c#, windows-runtime

我被指派对一个 Metro 应用程序进行单元测试，该应用程序在 c# 中有很多异步函数 (IAsyncOperation)。如何对 IAsyncOperation 函数进行单元测试，或者我们可以使用带有 IAsyncOperation 函数的 Task 进行测试。如果可以，请举个例子。因为 IAsyncOperation 仅适用于 winRT 和普通 c# 中的 Task 以实现并行

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-02T06:04:25.770

您可以测试`IAsyncOperation<T>`直接返回的方法。首先基于`UnitTestLibrary (Windows Store apps)`项目模板创建一个新项目。

假设您要测试以下方法：

```
public class ViewModel
{
    public IAsyncOperation<string> GetString()
    {
        //
    }
} 
```

您可以从测试类中调用它，如下所示：

```
[TestClass]
public class UnitTest1
{
    [TestMethod]
    public async Task TestMethod1()
    {
        var viewModel = new ViewModel();
        Assert.AreEqual("result", await viewModel.GetString());
    }
} 
```

只需确保在测试方法签名中使用`async Task`而不是。`void`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-02T00:26:19.767

您可以使用该`IAsyncOperation<T>.StartAsTask()`方法生成一个`Task<T>`对应的异步操作。

这个 StackOverflow 问题可能会有所帮助：[Task<> 和 IAsyncOperation<> 之间有什么区别](https://stackoverflow.com/questions/10034239/what-is-the-difference-between-task-and-iasyncoperation)

# javascript - 从文件中读取数据并在浏览器上显示

> ID：14657161
> 
> 赞同：0
> 
> 时间：2013-02-02T00:10:12.410
> 
> 标签：javascript, html

我是 javascript 新手（主要在后端工作），但现在我想创建一个可视化并希望使用 javascript。

我将数据以格式保存在文件中

```
id1 uid1 rating
id1 uid2 rating2 
```

刚开始，我想从这个文件中读取数据并将其显示在我的浏览器上？我需要启动服务器吗.. 还是我可以那样做。

任何建议/方向将不胜感激。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T01:01:06.390

您需要了解ajax，**并处理浏览器差异**。一种适用于 Firefox 和 chrome 的方法是：

```
 <body>
  <div id="log"></div>
    <script type="text/javascript">
    var request = new XMLHttpRequest();//depends on the browser , several ways to create the object
    request.onreadystatechange = function(e){
      if(request.readyState == 4 && request.status==200){
        // do whatever you need with the data
        document.getElementById("log").innerText = request.responseText;
      }
    }
    // assuming the file is called data and is located on current-path-on-server/data
    request.open("GET","data",true);
    request.send();
  </script>  
  </body> 
```

更多关于它：

[https://developer.mozilla.org/en-US/docs/AJAX/Getting_Started](https://developer.mozilla.org/en-US/docs/AJAX/Getting_Started)

# jquery - 在 keyup 或单击获取此元素

> ID：14657164
> 
> 赞同：0
> 
> 时间：2013-02-02T00:10:53.850
> 
> 标签：jquery, click, keyup

我想知道哪个元素已被单击或键入。如下所示：

```
$('button, input').on('click keyup', function() {

    var self = $(this);

    if (self == button)
        ...
    else if (self == input)
        ...

}; 
```

我不能这样做`self.attr('name') == 'something'`，因为按钮没有名称属性。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T00:24:22.780

```
if ($(this).is('button')) {
} else if ($(this).is('input')) {
} 
```

恶意的意思是

```
if ($(this).prop('tagName')=='BUTTON'){
} else if ($(this).prop('tagName')=='INPUT') {
} 
```

虽然我会使用开关，因为它更整洁

```
switch ($(this).prop('tagName')){
    case 'BUTTON':
        //do stuff
    break;
    case 'INPUT':
        //do stuff
    break;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T00:14:34.387

如果您想区分它是输入还是按钮标签，您可以使用

```
$(this).prop("tagName") 
```

# jquery - JQuery - 优化类切换器？

> ID：14657166
> 
> 赞同：0
> 
> 时间：2013-02-02T00:11:05.610
> 
> 标签：jquery, toggleclass

我有一个元素，单击时会检查不同元素的类。

如果它有一个特定的类，它将删除它，并用不同的类替换它。同样，如果单击，它将使用交换的类名反转该过程。

（给一个视觉，这个类是一个可爱的星形图标，它是阴影版本）

我认为我下面的代码有点过于冗长。
任何人都可以看到更好/更短的方式来说明它吗？

```
<script language="javascript" type="text/javascript">
$(document).ready(function(){

   $(".clickme").click(function(){ 

     if($("#staricon").hasClass("starON")){

         $("#staricon").removeClass("starON").addClass("starSHADED"); 

     }else if($("#staricon").hasClass("starSHADED")){

         $("#staricon").removeClass("starSHADED").addClass("starON");   
     }

  });

});
</script> 
```

此外，`starON`并且`starSHADED`是精灵的一部分。
上面的代码有效！但我确信它可以被优化。

我看到 jQuery 有一个`.toggleClass()`API，我正在错误地交换这两个类。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T00:18:38.520

首先，将您选择的元素设置为一个变量（如果您将多次对其进行操作，那么对于 jQuery 来说总是一个很好的经验法则）。

其次，您需要为两个州开设课程是否有特殊原因？默认情况下，我会给它一个阴影星形图像，并在它具有 starON 类时覆盖它。然后一个人`toggleClass`就可以完成所有的工作。

```
$('#staricon').toggleClass("starON"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T00:15:04.170

```
$('#staricon').toggleClass('starSHADED').toggleClass('starON'); 
```

# c++ - 人为限制ostream

> ID：14657168
> 
> 赞同：2
> 
> 时间：2013-02-02T00:11:20.310
> 
> 标签：c++, iostream

我正在编写一个与 std::ostreams 耦合的对象序列化库。根据底层的 streambuf，一些 ostream 支持查找操作，而一些不支持。此外，一些流写入固定大小的接收器，而一些流会增长（fstream、stringstream 等）。

就我而言，我正在开发一个嵌入式系统，我想非常保护我的资源。我想以与流无关的方式对允许写入的字节数施加任意最大限制。

我之前写过自定义的streambufs（一个包装zlib，一个包装sqlite blob api）。我想我可以为这个限制目的编写另一个自定义包装streambuf。有没有人有任何其他建议？如果我必须编写另一个streambuf，是否有一种简单的方法来计算写入底层流的实际字节数？

限制：
不能使用 boost（嵌入式平台）
应该适用于任何标准 ostream（fstream、stringstream、cout 等）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T00:15:12.070

因此，您需要实现自己的`streambuf::overflow`，并在达到限制时返回 EOF 。

# python - matplotlib 标签不起作用

> ID：14657169
> 
> 赞同：40
> 
> 时间：2013-02-02T00:11:42.027
> 
> 标签：python, matplotlib

当我执行以下代码时，它不会产生带有标签的图。

```
import matplotlib.pyplot as plt
import numpy as np
x = np.arange(1, 5)
plt.plot(x, x*1.5, label='Normal') 
```

Numpy 版本是 '1.6.2' Matplotlib 版本是 '1.3.x'

关于为什么会发生这种情况的任何想法？

* * *

## 回答 #1

> 赞同：111
> 
> 时间：2013-02-02T00:18:11.823

您忘记显示[图例](http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.legend)：

```
...
plt.legend(loc='best')
plt.show() 
```

![在此处输入图像描述](../Images/8853a5da4eec1b45f34ea4027f7371d5.png)

# node.js - 通过 package.json 安装“全局”npm 依赖项

> ID：14657170
> 
> 赞同：86
> 
> 时间：2013-02-02T00:12:01.363
> 
> 标签：node.js, package, npm

我有一些“全局”依赖项（jshint、csslint、buster 等），当我的包通过`npm install`. 这可能吗？

目前，我正在手动执行以下操作：

1.  `npm install -g <package_name>`
2.  从我的项目中：`npm link <package_name>`

更新：刚刚遇到了[这个对 npm 的功能请求](https://github.com/isaacs/npm/issues/2949)。似乎`scripts`package.json 中的配置是要走的路？

再次更新：或者，在阅读[npm 文档](https://npmjs.org/doc/scripts.html)之后，也许我应该使用[.gyp 文件](http://code.google.com/p/gyp/wiki/GypLanguageSpecification)？我很困惑。

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2013-02-02T01:49:03.470

无法从`package.json`. 而且，这是设计使然，正如 Isaac在您引用[的功能请求中所述：](https://github.com/npm/npm/issues/2949#issuecomment-11408461)

> 是的，我们永远不会这样做。

但是，在本地安装软件包时，仍然可以使用“二进制文件”。他们会在`.../node_modules/.bin/`。[`preinstall`而且，您应该能够使用script](https://docs.npmjs.com/misc/scripts#default-values)将它们排队。

但是，如果一系列命令相当长（如“ *jshint、csslint、buster 等*”所建议的那样），您可能需要考虑使用构建工具[`grunt`](http://gruntjs.com/)来执行各种任务：

```
{
    // ...,

    "scripts": {
        "preinstall": "grunt"
    }
} 
```

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2013-02-02T02:08:19.687

我真的很喜欢安装本地依赖项的模式，然后使用 bash 脚本将 PATH 设置为`./node_modules/.bin`.

**文件：env.sh**

```
# Add your local node_modules bin to the path for this command
export PATH="./node_modules/.bin:$PATH"

# execute the rest of the command
exec "$@" 
```

然后，您可以在任何 bash 命令之前使用此脚本。如果你将它与 Makefile 或 npm 脚本配对：

**文件：生成文件**

```
lint :
    ./env.sh csslint my_styles 
```

**文件：package.json**

```
"scripts": {
  "lint": "./env.sh csslint my_styles"
} 
```

这些文件中的这些任务看起来像是在某个全局位置引用 csslint，但实际上它们使用的是 node_modules bin 中的版本。

这样做真正令人敬畏的好处是这些依赖项可以轻松地进行版本控制，就像您的其他节点模块一样。如果您坚持使用全局安装解决方案，您可能会破坏用户系统上其他项目之一所需的某些特定版本。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-09-30T23:27:09.993

你应该试试这个：[https ://github.com/lastboy/package-script](https://github.com/lastboy/package-script)

我一直在使用它直接从 package.json 安装全局 npm 包。它适用于没有技术知识的客户。

它甚至会检查软件包是否已经安装，如果没有安装它们！

# python - 在 django 中获取本地时区

> ID：14657173
> 
> 赞同：34
> 
> 时间：2013-02-02T00:12:21.047
> 
> 标签：python, django

我有一个`DATETIME`存储在系统时间 UTC 中的 mysql 值。我需要将其转换为 django 中的本地时区。这是我目前拥有的：

```
# value in mysql
`timestamp`
2013-02-01 22:48:45

# settings.py
TIME_ZONE = 'America/Los_Angeles'

# views.py
last_updated = PathLastUpdated.objects.all()[0].timestamp
print last_updated
2013-02-01 22:48:45 <-- same as UTC 
```

我如何才能让 last_updated 值在我的本地时区 = "America/Los Angeles" 中？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2013-02-02T11:21:24.807

时区的[Django 文档](https://docs.djangoproject.com/en/dev/topics/i18n/timezones/#time-zones)`datetime`记录了将对象转换为适当的时区以进行显示的所有必要细节。

您的数据以 UTC 存储，这很好。当您`DateTime`从数据库中获取字段对象时，它将是一个幼稚的`datetime.datetime`对象。即没有附加时区的日期/时间。然后由您来完成转换。

您的 webapp 的用户可能在不同的时区，因此必须为*每个请求*转换到适当的时区。这就是为什么有一个[激活](https://docs.djangoproject.com/en/dev/ref/utils/#django.utils.timezone.activate)功能来设置当前时区的原因。

如果您安装了[pytz](http://pytz.sourceforge.net/)，您应该能够执行以下操作：

```
from django.utils.timezone import activate
activate(settings.TIME_ZONE) 
```

然后，模板引擎中日期字段的所有输出将自动将您天真的日期时间对象转换为正确的时区以进行显示。

如果您只有一个`datetime.datetime`要设置时区的幼稚实例，则只需`pytz`直接使用该模块即可。但是，在您的视图中执行此操作是不正常的，因为仅在演示时转换时区是个好主意。

```
from pytz import timezone

settings_time_zone = timezone(settings.TIME_ZONE)
last_updated = last_updated.astimezone(settings_time_zone) 
```

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2015-04-13T23:39:30.330

在哭了很多之后，我可以显示我的国家的正确日期，做这样的事情：

```
>>> from django.utils.timezone import get_current_timezone
>>> from front.models import Training

>>> tz = get_current_timezone()
>>> stored_date = Training.objects.first().start_date
datetime.datetime(2015, 4, 25, 17, 0, tzinfo=<UTC>)

>>> desired_date = stored_date + tz.utcoffset(stored_date)
datetime.datetime(2015, 4, 25, 14, 0, tzinfo=<UTC>) 
```

该`tzinfo`属性显示 UTC，但日期和时间显示正确。

**更新 30/10/2015** (Django 1.8)

我今天使用另一种方法，对 django 更友好

```
>>> from django.utils import timezone
>>> from trainings.models import Training
>>> value = Training.objects.first().date

>>> value
datetime.datetime(2015, 10, 23, 11, 32, 54, 633151, tzinfo=<UTC>)

>>> timezone.localtime(value)
datetime.datetime(2015, 10, 23, 9, 32, 54, 633151, tzinfo=<django.utils.timezone.LocalTimezone object at 0x7fa6129784a8>) 
```

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2015-09-19T09:25:38.290

**localtime**是一个模板过滤器，这可能会有所帮助。

[https://github.com/django/django/blob/1.8.4/django/utils/timezone.py#L298](https://github.com/django/django/blob/1.8.4/django/utils/timezone.py#L298)

代码示例：

```
from django.utils.timezone import localtime 

desired_datetime = localtime(stored_datetime) 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2013-07-17T06:29:47.860

我创建了一个简单的中间件来为你处理所有这些东西：

[https://github.com/Miserlou/django-easy-timezones](https://github.com/Miserlou/django-easy-timezones)

只需安装它并按照说明操作即可！

1.  安装 django-easy-timezones

    ```
    pip install django-easy-timezones pytz pygeoip 
    ```

2.  将“easy-timezones”添加到您的 INSTALLED_APPS 设置中，如下所示：

    ```
    INSTALLED_APPS = (
    ...
    'easy-timezones',
    ) 
    ```

3.  将 EasyTimezoneMiddleware 添加到您的 MIDDLEWARE_CLASSES

    ```
    MIDDLEWARE_CLASSES = (
    ...
    'easy-timezones.middleware.EasyTimezoneMiddleware',
    ) 
    ```

4.  在设置文件中添加[MaxMind GeoIP 数据库](http://www.maxmind.com/en/geolocation_landing)的路径：

    ```
    GEOIP_DATABASE = '/path/to/your/geoip/database/GeoIP.dat' 
    ```

5.  在模板中启用本地时间。

    ```
    {% load tz %}
        The UTC time is {{ object.date }}
    {% localtime on %}
        The local time is {{ object.date }}
    {% endlocaltime %} 
    ```

6.  多田！

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2013-02-02T09:08:05.177

我个人建议不要使用`TIME_ZONE`UTC 以外的设置。我记得过去遇到过这个问题，无论是数据库在与 Django 后端使用的不同时区（将值保存在不同时区）中运行。这意味着比较时间很麻烦，根据你在做什么来回改变它们。

一个好的做法通常是在后端使用一个时区（比如说 UTC），并将前端的时间转换为您正在服务的用户时区。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2016-09-23T06:41:58.860

我遇到了同样的问题。在我的设置中，我设置了`TIME_ZONE`，但 MySql 中的时间仍然是 UTC 时间。

```
# settings.py
TIME_ZONE = 'Asia/Shanghai' 
```

然后我发现，在settings.py中，`USE_TZ`已经设置为False

`USE_TZ = False`

正如@MagicLAMP 所指出的，它仅适用于单时区站点，如果您的站点是国际站点或者使用您的站点的地方发生夏令时，请检查[时区。](https://docs.djangoproject.com/en/2.2/topics/i18n/timezones/#time-zoness)!)

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2018-05-26T19:37:42.293

我花了一段时间才找到这个，但这就是我解决它的方法。我从 IP 地址猜测用户的时区，然后在 Django 2 及更高版本中执行此操作：

```
{% load tz %}
{% timezone "Europe/Paris" %}
    Paris time: {{ object.date }}
{% endtimezone %} 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2017-05-13T21:25:16.010

只需使用

```
timezone.localtime(arg) 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2019-03-07T19:17:35.590

1：在视图中定义时区

```
from django.utils import timezone

variable = timezone.now() 
```

2：然后在你的模板中使用它

```
{% load l10n %}

Teresina, {{variable |localize}}. 
```

# ember.js - Ember.js 1.0-pre4 + jQ UI 可排序 + 本地存储适配器

> ID：14657176
> 
> 赞同：1
> 
> 时间：2013-02-02T00:13:00.870
> 
> 标签：ember.js

Day 2 学习 ember.js...

我正在开发一个离线应用程序，该应用程序需要将可拖动/可排序的磁贴位置保存到本地存储，如果没有现有数据，则从固定装置加载和保存。

**使用**：ember 1.0.0-pre4、ember-data rev11、ember-localstorage-adapter、jQ 1.9、jQ UI 1.9 [https://github.com/rpflorence/ember-localstorage-adapter](https://github.com/rpflorence/ember-localstorage-adapter)

它正在工作，但我有点新手，觉得它不漂亮，可以使用一些社区建议。 [http://jsfiddle.net/Nsbcu/4/](http://jsfiddle.net/Nsbcu/4/)

**问题**

1.  检查您`DS.Store`是否已加载并且为空的正确方法是什么？我直视的方法`localstorage`感觉不对。

2.  在我`createRecords`从`App.Tile.DEFAULTS`我觉得我应该提交它们之后，但是抛出了一个错误。我不必提交已知的默认值，但很好奇导致错误的原因以及我应该如何正确提交。App.ready() 回调也是加载默认值的正确位置吗？错误仅在`localstorage`为空时发生

    `Uncaught Error: Attempted to handle event loadedData on <App.Tile:ember231:1> while in state rootState.loaded.created.inFlight. Called with undefined`

3.  在`TilesController`我正在使用`sortProperties`的. 我目前的解决方案是在更新模型时暂时关闭。再次感觉很hacky，关于正确方法的建议？`set``order``sortProperties`

=== 2 月 3 日编辑 ===

如果我执行异步提交，则会避免问题 #2 中的初始错误。

```
App.TilesRoute = Ember.Route.extend({
    model: function() {
        return App.Tile.find();
    },
    setupController: function(controller) {
        if (localStorage.getItem('fusion-emberjs') == null) {
            App.Tile.DEFAULTS.forEach(function(item) {
                App.Tile.createRecord(item);
            });

            // Commit async, else generates error
            var _this = this;
            setTimeout(function() {
                _this.store.commit();
            }, 1);
        }
    }
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T05:25:57.253

*   我会将任何初始代码放入应用程序或 setupController 方法中的索引 Route

    ```
    if (localStorage.getItem('fusion-emberjs') == null) {
        App.Tile.DEFAULTS.forEach(function(item) {
            App.Tile.createRecord(item);
        });

        //*** WARNING: Generates Error ***/
        App.Tile.find().get('store').commit();
    } 
    ```

*   将代码移动到路线内后，请在路线内替换`App.Tile.find().get('store').commit();`为`App.store.commit()`

*   创建您自己的事务而不是使用默认事务，每次直接调用商店时，您都在使用默认事务。您可以通过这种方式创建交易

> ```
> var transaction = App.store.transaction()
> transaction.createRecord(App.Foo);
> transaction.commit()
> transaction.rollback(); 
> ```

*   对 App.store 的任何调用都假定您已经创建了一个商店，现在您只是扩展`DS.Store`. 试试吧

> ```
> App.Store = DS.Store.create({
>   revision: 11,
>   adapter: 'App.LSAdapter'
> }); 
> ```

*   我建议您在路由器中进行任何事件处理或事务管理，除非它纯粹是为了样式或动画。在这种情况下，视图是它的正确位置。我喜欢路由器来协调所有资产（控制器、路由、模型、视图）之间的通信

*   要记住的一个好模式是视图只与控制器对话，控制器只是模型的代理，路由器协调控制器之间的通信并管理路由。

# clojure - Clojure 列表与向量与集合

> ID：14657178
> 
> 赞同：19
> 
> 时间：2013-02-02T00:13:11.237
> 
> 标签：clojure

我是 Clojure 的新手。抱歉，如果这是一个愚蠢的问题！

每次我不关心项目的顺序时，是否应该使用集合而不是向量或列表？当不需要订购时，在这三者之间做出决定的共同标准是什么？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-02-02T00:31:16.723

这实际上取决于您将如何使用这些物品。

*   如果您要搜索项目，请使用集合。
*   如果您将按顺序处理它，请使用列表。
*   如果您要将其切成均匀大小的块（例如在排序时），请使用向量。
*   如果您需要计算长度，请使用向量。
*   如果您要手动输入这些，请使用矢量（以节省一点引用）

在实践中，我看到的大多数处理都涉及将数据转换为 a`seq`和处理 that，因此列表和向量之间的区别通常是个人喜好问题。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-02-02T00:30:51.943

一般来说，当您的主要关注点是“这个东西在这个组中吗？”时，您需要一个集合。除了不保持顺序外，集合也只保存给定值一次。因此，如果您关心值的精确放置，则向量更适合您。如果您主要关心成员资格的测试，那么一组更合适。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-02T00:32:12.543

是的，使用一套。除非您有非常非常好的理由来选择其他东西（性能、内存使用……），否则该集合是正确的选择。

请记住，编程主要是与您的代码的人类阅读者进行交流，而不是与计算机交流。通过使用集合，您可以完全清楚地表明元素的顺序是无关紧要的（并且您不会期望重复值），从而帮助读者理解您的意图和您自己的思维定势。

# r - 生成所有可能的列组合并在 R 中为它们中的每一个创建一个矩阵

> ID：14657182
> 
> 赞同：1
> 
> 时间：2013-02-02T00:13:24.807
> 
> 标签：r

我有一个像这样的矩阵：

```
myarray=cov(matrix(rexp(200),50,10)) 
```

我想生成所有可能的列组合并计算每个组合的相关矩阵，如果可能的话，使用列号而不是名称。在第二步中，我想计算每个矩阵的行列式，所以也许有一种有效的方法来做到这一点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T00:56:50.653

这是一种方法：

```
list.of.matrices <- apply(expand.grid(rep(list(c(FALSE, TRUE)), ncol(myarray))),
                          1, function(j)myarray[, j, drop = FALSE])

length(list.of.matrices)
# [1] 1024 
```

然后执行以下操作：

```
result <- sapply(list.of.matrices, function_of_your_choice) 
```

但请注意，`det`只能应用于方阵......请澄清。

# javascript - 将值传递给表格行的 onclick 事件

> ID：14657184
> 
> 赞同：2
> 
> 时间：2013-02-02T00:13:25.733
> 
> 标签：javascript, javascript-events, jquery

我有一个在 Ajax 调用上创建的表格行。我想关联一个 onlclick 事件。我无法从我正在遍历的数组中传递一个元素（根据下面显示的代码，它是 d[i]）所以我无法在点击事件中获取数组元素

```
var d = $.parseJSON(data.codes);

for (var i = 0; i < d.length; i++) {
  var currentRow = $('<tr>');
  currentRow.append($('<td>').html(d[i].id));
  currentRow.attr("class", "sourceCodeRow grid-row");
  currentRow.append($('<td>').html(d[i].name));
  currentRow.append($('<td>').html(d[i].description));

  currentRow.click(function (f) {
    //want to display name from d[i]
    // alert(d[i].name);

  });

  $('#table-id').append(currentRow);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T00:18:18.843

这不起作用的原因是您的 for 循环索引不再是您所期望的，因为一旦单击该行，for 循环就完成了循环。您需要将您的名称设置为可以在点击事件中访问的变量，我只需将名称存储在数据中：

```
currentRow.data('name',d[i].name);
currentRow.click(function(f ) {
       //want to display name from d[i]
        alert($(this).data('name'));

}); 
```

或者如果您需要访问整个对象，只需设置它：

```
currentRow.data('obj',d[i]);
currentRow.click(function(f ) {
       //want to display name from d[i]
        alert($(this).data('obj').name);

}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T00:25:21.310

我认为您需要使用 $(this)

# php - 将字符串转换为十六进制代码

> ID：14657187
> 
> 赞同：-2
> 
> 时间：2013-02-02T00:13:56.993
> 
> 标签：php, javascript

我想在 JavaScript 或 php 中将字符串转换为颜色十六进制代码。

有没有办法做到这一点？字符串看起来像`dfc6d9ff5a1d394e`or `2b514f260aad317a`。背景是这些是唯一的ID，我想将它们转换为独特的颜色......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T00:19:59.450

如果这些 ID 是合理随机的，即：哈希或 UUID 的一部分，请尝试：

```
$str = 'dfc6d9ff5a1d394e';
$hexcolor = '#' . substr($str, 0, 6);
//output: #dfc6d9 
```

或者如果它们更统一一些，并且你想要一些更“随机”的东西而不是真正随机的：

```
$str = 'dfc6d9ff5a1d394e';
$hexcolor = '#' . substr(md5($str), 0, 6);
//output: #8daadd 
```

或者，如果您想获得更*高级* 的信息，这里有一个包含更深入代码[的先前答案。](https://stackoverflow.com/questions/14488174/generate-high-contrast-random-color-using-php/14489553#14489553)

# php - 从与 PHP 中的替换键匹配的 2 个数组中交换值的最有效方法是什么？

> ID：14657188
> 
> 赞同：0
> 
> 时间：2013-02-02T00:14:16.903
> 
> 标签：php, regex

第一个数组定义当前值：

```
Array ( [0] => schools [1] => high-wood [2] => students ) 
```

第二个数组是一个由第一个数组触发的映射，也包含替换键：

```
Array ( [/schools/{school-name}/students/] => /{school-name}/students/ ) 
```

这个想法是数组键的第二段保存替换键，最终返回的数组是指示替换键位置的输出映射。

最终所需的输出将是：

```
/high-wood/students/ 
```

我试图找到一个通用的解决方案，它可能有任意数量的传入值，以及任意位置的任意数量的替换键。

这是通用传入数组的示例：

```
Array ( [0] => param1 [1] => param2 [2] => key-value ) 
```

和通用地图：

```
Array ( [/param1/param2/{key-map}/] => /{map-key}/anything/ ) 
```

其输出将是：

```
/key-value/anything/ 
```

基本思想是在第二个段（它可以在任何地方）检测到映射键，以便从传入数组中获取值并将其放入输出数组的映射键持有者中。

目前我已经设法制作了一个 foreach 循环和 preg_matches 的 vomitus 数组，我担心即使呈现这些也会进一步混淆这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T00:30:41.333

嗯……这样的事情怎么样。未经测试：

```
$input  = array('schools', 'high-wood', 'students');

// Here I'm making the blithe assumption that you can further tweak the URI map
$uriMap = array('^/schools/([^/]+)/students/$' => '/{school-name}/students/');
//               ^         ^^^^^^^          ^
//             anchor    capturing group   anchor

// Massage input to match format of $uriMap
$inUri  = '/'.implode('/', $input).'/';

foreach($uriMap as $pattern => $target){
    if(false !== preg_match($pattern, $inUri, $matches){
        // $matches[1] should have the matched string
        $mapped = str_replace('{school-name}', $matches[1], $target);
        break;
    }
}

echo $mapped; 
```

> /高木/学生/

干杯

# python - 使用 scapy 指定数据包长度

> ID：14657193
> 
> 赞同：4
> 
> 时间：2013-02-02T00:14:42.640
> 
> 标签：python, networking, scapy

我正在尝试发送特定的数据包大小（100 字节），`scapy`但似乎无法得到它。

我用这个开始。

```
sr(IP(dst="192.168.1.1")/TCP(dport=443)) 
```

查看文档/帮助我不知道是否可以`PacketLenField`用来指定数据包的长度。我可以用 NMAP 和 NSE 来做，但想在 NMAP 之外做。

关于这个有什么想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-03T07:02:28.340

您可以在制作数据包时添加所需的字节数作为字符串，例如：

```
payload = 'ZZZZZZZZZZZZZZZZZZZZZ'
pkt = Ether() / IP() / TCP() / payload 
```

将工作。您只需要根据需要调整有效载荷的长度。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-04-13T16:06:04.263

您可以`inet.Padding()`从`scapy`库中使用：

```
packet = IP(dst="192.168.1.1")/TCP(dport=443)

if len(packet)<100:
    #"\x00" is a single zero byte
    myString = "\x00"*(100 - len(packet))
    packet = packet/inet.Padding(myString) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-07-22T13:03:39.747

Scapy 的`Raw()`函数填充数据包的有效负载。如果你知道你的头部大小，你只需要用随机数据填充剩余的字节。

您可以使用它`RandString()`来生成随机填充。以下命令发送长度为 100 的数据包（并侦听响应）：

`sr(IP(dst="192.168.1.1")/TCP(dport=443)/Raw(RandString(size=72))`

# jquery - 如果 li 类存在，隐藏表单的最佳方法是什么？

> ID：14657197
> 
> 赞同：0
> 
> 时间：2013-02-02T00:15:10.443
> 
> 标签：jquery

我有以下 li 类：

```
<li class="main clazz tab_new">
    <a href="/requests/new" class="tab">Submit a request</a>
</li> 
```

如果上述 li 存在，我希望隐藏以下表单。

```
<div class="content content_grey">
    <div class="grey_box_top">
        <div class="box box_top"></div></div>  
<div class="login-container">
    <div class="login-form">
        <form class="new_user" id="password-form"> 
```

请帮助我尝试了几种不同的方法，但没有运气。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-02T00:19:57.073

我不知道您选择 li 基于哪个类，但如果它是“tab_new”，那么这将起作用：

```
if ($("li.tab_new").length) {
    $("form#password-form").hide();
} 
```

# javascript - 使用正则表达式和 Javascript 从字符串中提取值

> ID：14657201
> 
> 赞同：1
> 
> 时间：2013-02-02T00:15:36.860
> 
> 标签：javascript, regex

给定一个字符串，如：

```
</gd:organization><gd:email rel='http://schemas.google.com/g/2005#other' address='CM@Aart.com'/><gd:email rel='http://schemas.google.com/g/2005#other' address='da@ammeart.com' primary='true'/><gd:phoneNumber rel='http://schemas.google.com/g/2005#work'>011 360 51 60</gd:phoneNumber> 
```

我需要从字符串中删除：

```
<gd:email rel='http://schemas.google.com/g/2005#other' address='CM@Aart.com'/> 
```

- 基于匹配：`CM@Aart.com`。

它必须在基本的 JavaScript 中完成，我无法导入任何特殊的解析工具。我似乎找不到不会出错的组合。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T00:38:28.067

这很简单，请告诉您是否需要任何更改：

```
var inputString = "</gd:organization><gd:email rel='http://schemas.google.com/g/2005#other' address='CM@Aart.com'/><gd:email rel='http://schemas.google.com/g/2005#other' address='da@ammeart.com' primary='true'/><gd:phoneNumber rel='http://schemas.google.com/g/2005#work'>011 360 51 60</gd:phoneNumber>";
var outputString = inputString.split("CM@Aart.com")[1].substring(3);
alert(outputString); 
```

我已经为它发布了一个[JSFiddle](http://jsfiddle.net/6BssD/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T00:40:12.773

如果必须在 RegExp 中完成此操作，则**只有**在您知道所有`<gd:email>`部分都将具有*地址*属性、引号`'`和结尾`/>`没有`address='`或`/>`出现在这些属性的任何值内时，您才可以尝试类似以下的操作。

```
"</gd:organization><gd:email rel='http://schemas.google.com/g/2005#other' address='CM@Aart.com'/><gd:email rel='http://schemas.google.com/g/2005#other' address='da@ammeart.com' primary='true'/><gd:phoneNumber rel='http://schemas.google.com/g/2005#work'>011 360 51 60</gd:phoneNumber>"
.replace(
    /<gd:email .*?address='([^']*)'.*?\/>/g, // match email node
    function (a, b) { // replacement logic
        if (b === 'CM@Aart.com') return '';
        return a;
    }
); 
```

正如我在[评论](https://stackoverflow.com/q/14657201/1615483#comment-20483375)中所说，实现这一点的最佳方法实际上是使用[`DOMParser`](https://developer.mozilla.org/en-US/docs/DOM/DOMParser)原生 JavaScript XML 解析器，但您给我们的字符串不是有效的 XML，因为它以关闭标记开头。

# c - 我可以从网络设备驱动程序访问 TCP 套接字吗？

> ID：14657203
> 
> 赞同：1
> 
> 时间：2013-02-02T00:15:57.577
> 
> 标签：c, sockets, networking, tcp

我正在研究一个需要对网络设备驱动程序（特别是 MadWifi）进行实验性修改的研究项目。我想访问有关驱动程序处理数据包的 TCP 连接的信息（特别是 RTTM 信息）。是否有可能获得这些信息？

在我正在使用的特定代码部分中，我可以访问`struct net_device`用于传输数据包的代码。我知道我可以访问给`struct net_device`定的 a `struct sock`，但我可以反过来吗？

# mysql - Magento：更新 1.4 -> 1.7 后外键约束失败

> ID：14657206
> 
> 赞同：0
> 
> 时间：2013-02-02T00:16:31.423
> 
> 标签：mysql, magento, foreign-keys, upgrade

> SQLSTATE [23000]：完整性约束违规：1452 无法添加或更新子行：外键约束失败（`my_magento/catalog_category_product_index`，CONSTRAINT `FK_CAT_CTGR_PRD_IDX_CTGR_ID_CAT_CTGR_ENTT_ENTT_ID`FOREIGN KEY（`category_id`）REFERENCES `catalog_category_entity`（`entity_id`）O）

这是我在尝试重新索引数据时遇到的错误（按照此处的建议输出：[“重新索引过程存在问题。”产品导入后](https://stackoverflow.com/questions/9304574/there-was-a-problem-with-reindexing-process-after-product-import)）

但该解决方案根本没有帮助。请帮助在哪里搜索它，我对 MySQL 外键不太熟悉。如何检测损坏的记录？修复它们的原则是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T18:00:18.503

您的一个产品引用了一个不存在的 category_id。通常在通过管理后端编辑内容时不应该发生这种情况。你是直接在数据库中删除了类别吗？

您必须检查哪个产品引用了该类别并删除该引用。类别和产品之间的引用存储在 catalog_category_product 中。catalog_category_entity 中的类别。要查找该行，您可以使用该查询：

```
SELECT * FROM catalog_category_product ccp
LEFT JOIN catalog_category_entity cce ON ccp.category_id = cce.entity_id
WHERE cce.entity_id IS NULL 
```

# php - 根据数组数据分离出数组

> ID：14657216
> 
> 赞同：0
> 
> 时间：2013-02-02T00:17:40.890
> 
> 标签：php, mysql

我想为文档创建一个表格，并允许用户选择是否需要与任务相关的文档。我需要它来检查文档的当前状态，以查看它是否已经被需要以及是否将复选框标记为已选中。数据库中当前有 4 个文档，并且只有 2 个关联到此特定任务的 2 个文档。

当文档与任务没有关联时，数据库中将没有条目说它没有关联，它只是简单地不会出现在该表中。

我目前拥有的代码将针对这两个具有关联的文档显示复选框，但是对于没有关联的文档根本不显示任何复选框。我希望它仍然显示 3 个复选框，以便用户可以更改其关联，但默认情况下它应该检查不需要。目前它根本没有显示任何复选框。下面是 PHP 片段。请告知您是否想要屏幕截图或数据库转储。

任何帮助将不胜感激。我希望这只是漫长的一天，我忘记了一些简单的事情。

```
 <table border=1>
      <tr>
        <td align=center><p>Here you can associate documents to Jobs and Tasks to.</p> </td>
      </tr>
    </table>';

$order2 = "SELECT * FROM documents";
$result2 = mysql_query($order2);
while ($row2 = mysql_fetch_array($result2)) {

$nice_name = $row2['nice_name'];
$doc_id = $row2['id'];

}

echo '
<h3>Documents</h3>

    <table border=1>
      <tr><th>Document Name</th><th>Document Type</th><th>Required</th><th>Optional</th><th>Not Required</th></tr>
    ';

$order2 = "SELECT * FROM documents ORDER BY type_id";
$result2 = mysql_query($order2);
while ($row2 = mysql_fetch_array($result2)) {

$nice_name = $row2['nice_name'];
$doc_id = $row2['id'];
$doc_type_id = $row2['type_id'];

echo '

      <tr>
        <td>'.$nice_name.'</td>';

$order3 = "SELECT * FROM document_types WHERE id = '$doc_type_id'";
$result3 = mysql_query($order3);
while ($row3 = mysql_fetch_array($result3)) {

$type_name = $row3['type_name'];

    echo '
        <td>'.$type_name.'</td>';

$order4 = "SELECT * FROM document_assoc WHERE doc_id = '$doc_id'";
$result4 = mysql_query($order4);
while ($row4 = mysql_fetch_array($result4)) {

$requirement = $row4['requirement'];

    echo '

        <td><input type="checkbox" name="req" value="2" '; if ($requirement == 2) { echo ' checked '; } echo '></td>
        <td><input type="checkbox" name="opt" value="1" '; if ($requirement == 1) { echo ' checked '; } echo '></td>
        <td><input type="checkbox" name="not" value="0" '; if ($requirement < 1) { echo ' checked '; } echo '></td>';
    }

    }

    echo '
      </tr>';
    }
    echo '
    </table>'; 
```

到目前为止，我刚刚尝试使用最后一个复选框调整要求 =。但是，无论我使用 NULL 等，它都保持不变——我猜我错过了一些东西。

亲切的问候，

n00bstacker

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T00:27:22.650

您可以使用以下`if`语句来识别情况并做出适当的回应：

```
 $order4 = "SELECT * FROM document_assoc WHERE doc_id = '$doc_id'";
                $result4 = mysql_query($order4);
                $_results = mysql_fetch_array($result4);
                if (!$_results) {
                       <<<< OUTPUT THE CHECKBOXES/INPUTS YOU NEED >>>>
                } else {
                   foreach ($_results as $result) {

                $requirement = $result['requirement'];

echo '

    <td><input type="checkbox" name="req" value="2" '; if ($requirement == 2) { echo ' checked '; } echo '></td>
    <td><input type="checkbox" name="opt" value="1" '; if ($requirement == 1) { echo ' checked '; } echo '></td>
    <td><input type="checkbox" name="not" value="0" '; if ($requirement < 1) { echo ' checked '; } echo '></td>';
}

} 
```

希望这可以帮助！

# sql - 内连接与交叉应用 - 无法绑定多部分标识符

> ID：14657226
> 
> 赞同：2
> 
> 时间：2013-02-02T00:18:49.643
> 
> 标签：sql, sql-server, subquery, inner-join, cross-join

考虑以下架构：

```
create table TableA (A1 int)
create table TableB (B1 int, B2 int)
create table TableC (C1 int, C2 int)
create table TableD (D1 int) 
```

以及以下查询：

```
SELECT * 
FROM TableA a
INNER JOIN TableB b ON b.B1=a.A1
INNER JOIN (SELECT TOP 1 * 
            FROM TableC c
            WHERE c.C1=b.B1 ORDER BY c.C2) foo ON foo.C1=a.A1
INNER JOIN TableD d ON d.D1=foo.C1 
```

在 SQL Fiddle (SQL Server 2008) 中，我得到以下结果：

```
The multi-part identifier "b.B1" could not be bound.: SELECT * FROM TableA a INNER JOIN TableB b ON b.B1=a.A1 INNER JOIN (SELECT TOP 1 * FROM TableC c WHERE c.C1=b.B1 ORDER BY c.C2) foo ON foo.C1=a.A1 INNER JOIN TableD d ON d.D1=foo.C1 
```

但是用*CROSS APPLY*替换子查询的*INNER JOIN*可以解决问题：

 *```
SELECT * 
FROM TableA a
INNER JOIN TableB b ON b.B1=a.A1
CROSS APPLY (SELECT TOP 1 * 
            FROM TableC c
            WHERE c.C1=b.B1 AND c.C1=a.A1 ORDER BY c.C2) foo
INNER JOIN TableD d ON d.D1=foo.C1 
```

我的问题是：

1）为什么第一次查询失败？

2）为什么第二个查询没有失败？

3) *CROSS APPLY*特定于 SQL Server。哪一个是这个问题的 SQL 标准解决方案？

**重要提示**：不要试图理解 TableA、...、TableD 背后的逻辑。它们只是对更复杂查询的抽象（读起来很糟糕）。我想你会明白这个问题的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-02T00:32:27.250

`from`子句中不允许使用相关子查询。这就是`inner join`版本不起作用的原因。我其实不知道这件事的来历。一个问题是您可能会在依赖项中获得循环，这虽然不难检测，但会使查询无法处理。

您的查询是非常适合`cross apply`的一种情况。`cross apply`但是，我不知道它在大数据上的执行情况如何。

这是用标准 SQL 重写它的尝试：

```
SELECT * 
FROM TableA a
INNER JOIN TableB b ON b.B1=a.A1
INNER JOIN (select *
            from (select c.*, row_number() over (partition by c1 order by c2) 
                  FROM TableC c
                 ) c
            where seqnum = 1 and foo.C1=a.A1 and c.C1=b.B1
           ) foo
INNER JOIN TableD d ON d.D1=foo.C1 
```*

# xcode - 如何在图形 Xcode 中绘制 UITextField 的内容

> ID：14657229
> 
> 赞同：0
> 
> 时间：2013-02-02T00:19:15.603
> 
> 标签：xcode, graph

我需要获取 UITextField 的内容并将它们插入到屏幕图表中。有人可以告诉我最好的方法吗？我正在考虑使用 CorePlot。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T22:34:35.517

如果你有一个 TextField，我会将它的内容放入一个数组中。Core Plot 的图表都是从数组中生成的。因此，您需要获取文本，将其放入数组中，然后绘制数组。如果您查看他们的网站，他们有几个示例，例如您正在使用的操作系统的 CPTTestApp，DropPlot 和 Rangeplot 都有很好的示例。希望这可以帮助。

# jquery - jquery自动完成附加数据

> ID：14657232
> 
> 赞同：0
> 
> 时间：2013-02-02T00:19:59.683
> 
> 标签：jquery, codeigniter

我将这个自动完成与 codeigniter 教程一起使用

[http://www.codersmount.com/2012/09/jquery-ui-autocomplete-in-codeigniter-with-database/](http://www.codersmount.com/2012/09/jquery-ui-autocomplete-in-codeigniter-with-database/)
并让它在我的测试站点上运行，但我想在其中附加额外的数据，
这些数据将被指出到隐藏的文本字段。我所做的是回显附加数据
，然后在处理数据之前将其分解，但问题是我不希望在使用自动完成时显示附加数据。
谁能帮我这个？

这是jQuery代码：

```
$("#member").autocomplete({
source: "<?php echo site_url('autocomplete/get_member');?>"
}); 
```

请。帮助伙计们..提前谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T01:24:14.217

我不太确定最新的 JqueryUI 自动完成功能，但最后一个版本不允许在 URL 中添加额外参数，您需要做的是创建一个函数来将额外参数添加到您的 url。

看看 api，它会告诉你如何去做。

# java - 在 JFrame 上显式设置 jpanel 的大小

> ID：14657233
> 
> 赞同：3
> 
> 时间：2013-02-02T00:20:04.443
> 
> 标签：java, swing, jpanel, layout-manager, preferredsize

我有`JPanel`一个边框，问题是当我在其上添加面板时，`JFrame`尽管我使用`setPreferredSize`. 框架的布局是“BoxLayout”，代码如下：

```
public class ActionForm extends JFrame {

    JPanel namePanel;
    JPanel descPanel;
    JLabel actionName;
    JLabel nameLabel;
    JTextField nameTextField, descTextField;
    FlowLayout toolBarLayout = new FlowLayout();     

    public ActionForm() {
        this.setLayout(new BoxLayout(this.getContentPane(), BoxLayout.Y_AXIS));
        TitledBorder nameBorder= BorderFactory.createTitledBorder(
            "Change Description");
        nameBorder.setTitleJustification(TitledBorder.LEFT);
        namePanel = new JPanel(toolBarLayout);
        namePanel.setPreferredSize(new Dimension(150, 150));
        nameLabel = new JLabel("ButtonName");
        nameTextField = new JTextField("Action's Name", 50);
        namePanel.add(nameLabel);
        namePanel.add(nameTextField);
        namePanel.setBorder(nameBorder);
        namePanel.setComponentOrientation(ComponentOrientation.LEFT_TO_RIGHT);
        this.add(namePanel);
    }

    public static void main(String[] args) {
        ActionForm form = new ActionForm();
        form.setVisible(true);
        form.setSize(970, 500);
        form.setResizable(false);
    }
} 
```

为什么面板的大小没有改变？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-02T01:14:04.490

*   `BoxLayout`接受`Min/Max/preferredSize`来自`JComponents`这个`LayoutManager`

*   （我不想评论什么，因为我的答案会很长）请把你的代码与这个代码示例进行比较，实现的都很好（必需且重要）`Swing rulles`

例如

```
import java.awt.ComponentOrientation;
import java.awt.Dimension;
import java.awt.FlowLayout;
import javax.swing.BorderFactory;
import javax.swing.BoxLayout;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JPanel;
import javax.swing.JTextField;
import javax.swing.SwingUtilities;
import javax.swing.border.TitledBorder;

public class ActionForm {

    private static final long serialVersionUID = 1L;
    private JFrame frame;
    private JPanel namePanel;
    private JLabel nameLabel;
    private JTextField nameTextField;
    private FlowLayout toolBarLayout = new FlowLayout();

    public ActionForm() {
        TitledBorder nameBorder = BorderFactory.createTitledBorder(
            "Change Description");
        nameBorder.setTitleJustification(TitledBorder.LEFT);
        namePanel = new JPanel(toolBarLayout);
        namePanel.setPreferredSize(new Dimension(150, 150));// hardCoded sizing
        namePanel.setMaximumSize(new Dimension(250, 150));  // hardCoded sizing
        namePanel.setMinimumSize(new Dimension(150, 150));  // hardCoded sizing
        nameLabel = new JLabel("ButtonName");
        nameTextField = new JTextField("Action's Name", 10);
        namePanel.add(nameLabel);
        namePanel.add(nameTextField);
        namePanel.setBorder(nameBorder);
        namePanel.setComponentOrientation(ComponentOrientation.LEFT_TO_RIGHT);
        frame = new JFrame("Mix / Max / PreferredSize for BoxLayout");
        frame.getContentPane().setLayout(new BoxLayout(frame.getContentPane(),
            BoxLayout.Y_AXIS)); // otherwise nice exceptions java.awt.AWTError:
                                // BoxLayout can't be shared
        frame.add(namePanel);
        frame.setPreferredSize(new Dimension(970, 500));
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.setResizable(false);
        frame.pack();
        frame.setVisible(true);
    }

    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {

            @Override
            public void run() {
                ActionForm form = new ActionForm();
            }
        });
    }
} 
```

# view - 在 Sencha Touch 中，单击按钮时如何推送到新视图？

> ID：14657234
> 
> 赞同：0
> 
> 时间：2013-02-02T00:20:11.480
> 
> 标签：view, sencha-touch-2

我在视图中的面板中有以下按钮：

```
items: [
    {
        xtype: 'button',
        text: 'SEND',
        ui: 'confirm',
        docked: 'bottom',
        handler: function(){
            view.push('TouchNuts.view.Transactions',{
                title: 'New views title',
                html: 'Some content'
            });
        }
    }
] 
```

`'TouchNuts.view.Transactions'`当我单击它时，我想导航到包含列表的页面。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T23:10:14.590

`view`需要引用您的 NavigationView。获取该引用的一种方法是给它一个`id`然后使用`Ext.getCmp`来获取组件：

```
{
    xtype: 'navigationview',
    id: 'my-id',
    items: [...]
}

Ext.getCmp('my-id'); 
```

# perl - 散列数组未通过 ref 传递给 sub

> ID：14657237
> 
> 赞同：0
> 
> 时间：2013-02-02T00:20:34.840
> 
> 标签：perl, data-structures, pass-by-reference

我有一个 setter 子程序`setAssignmentStatus`，它接受一个哈希数组（从这里开始的**AoH**）和另一个参数（不要关心这个，因为这部分有效），并通过 AoH 进行迭代以在每个哈希元素中设置另一个条目。它不会返回任何内容，因为我想在通过 setter sub 拉出后使用带有添加条目的相同 AoH 对象，而不是构造一个全新的 AoH 并重新填充条目。这是二传手：

```
sub setAssignmentStatus
{
    my $fileFlatArySclr = $_[0];
    my $cfgFile = $_[1];

    #here I convert the AoH from the scalar necessary for the sub to its native form
    my @fileFlatAry = @$fileFlatArySclr;

    #this works, don't worry
    my %cfgVarHash = getConfigVars($cfgFile);

    foreach my $fileVarHashSclr(@fileFlatAry)
    {
        #convert each AoH entry from scalar necessary for iteration to native hash
        my %varHash = %$fileVarHashSclr;

        my $varName = $varHash{'VAR_NAME'};

        my $asgnLineCnt = $varHash{'ASGN_CNT'};

        my $asgnSts;
        my $fileAsgnSts; 
        my $cfgAsgnSts; 

        if($asgnLineCnt > 0) { $fileAsgnSts = 1; } else { $fileAsgnSts = 0; }

        my $cfgAsgnLine = $cfgVarHash{$varName};

        if($cfgAsgnLine ne undef) { $cfgAsgnSts = 1; } else { $cfgAsgnSts = 0; }

        $asgnSts = $fileAsgnSts.$cfgAsgnSts;

        #debug to make sure $asgnSts is not null in the first place (it is not!)
        print "\n*** setting ASGN_STUS of ".$varName." to ".$asgnSts;

        #Here we set ASGN_STUS for every iteration
        $varHash{'ASGN_STUS'} = $asgnSts;
    }
} 
```

它被称为如下：

> setAssignmentStatus(\@fileFlatAry, $cfgFile);

但是，在`@fileFlatAry`通过 发送 AoH后`setAssignmentStatus`，每个元素哈希不包含 ASGN_STUS 条目。为什么会这样，我该如何解决？

我的怀疑是我对修饰符做错了`\`，这就是我如何将数据结构作为标量参数传递给 sub 但我不确定。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-02T00:32:07.037

您修改`%varHash`而不是修改引用的哈希。停止将所有内容复制到局部变量中并修改局部变量。

```
$varHash{'ASGN_STUS'} = ...; 
```

应该

```
$fileVarHashSclr->{'ASGN_STUS'} = ...; 
```

我也不会`my @fileFlatAry = @$fileFlatArySclr;`。纯废物。

# http - Ngninx 报告 8 个活动连接，即使没有

> ID：14657238
> 
> 赞同：0
> 
> 时间：2013-02-02T00:20:52.453
> 
> 标签：http, unix, nginx

我用 --with-http_stub_status_module 编译了 Nginx 1.2.4。

当我查询 Nginx 的当前状态时，它返回*8 个活动连接*，它们都是*写作*类型：

```
Active connections: 8 
server accepts handled requests
5011178 5011178 5011178 
Reading: 0 Writing: 8 Waiting: 0 
```

但是，除了我为获取状态而执行的 curl 之外，绝对没有更多与我的 Nginx 建立连接。

知道为什么 Nginx 返回这个数量的活动连接吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T11:04:45.713

活动连接不代表对您的应用的请求数。如果您的应用程序提供一些`html`页面，那么每个元素，如`image`,`css`或`js`（如果未缓存在浏览器或其他用户客户端中）也将从您的服务器请求。因此，对于`html`一页，可以有许多活动连接。

但是...据我所知，它们将是`Reading`或`Waiting`连接，在您的示例中，有`Writing`. 如果您非常确定您只有一个请求，`curl`请检查您的`nginx`或某些`proxy`（如果存在）配置，因为看起来客户端连接在某些`POST`请求或`Uploads`.

# android - 随机二维码生成器

> ID：14657239
> 
> 赞同：1
> 
> 时间：2013-02-02T00:21:05.867
> 
> 标签：android, qr-code

如何使用 Eclipse 将随机 QRCode 实现到 Android 中的特定活动 (MainActivity) 中？我在活动中需要一个 QRCode 生成器，它根据随机值创建 QRCode。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T00:53:47.177

看看[zxing](http://code.google.com/p/zxing/)库。它可用于创建二维码以及处理从相机输入的二维码数据。

这是[条形码扫描仪](https://play.google.com/store/apps/details?id=com.google.zxing.client.android)应用程序使用的库。

# python - 如何在 python 中使用 pandas 获取所有重复项的列表？

> ID：14657241
> 
> 赞同：217
> 
> 时间：2013-02-02T00:22:08.413
> 
> 标签：python, pandas, duplicates

我有一份可能有出口问题的物品清单。我想获取重复项目的列表，以便手动比较它们。当我尝试使用 pandas[重复方法](http://pandas.pydata.org/pandas-docs/dev/generated/pandas.DataFrame.duplicated.html)时，它只返回第一个重复项。有没有办法得到所有的重复，而不仅仅是第一个？

我的数据集的一小部分如下所示：

```
ID,ENROLLMENT_DATE,TRAINER_MANAGING,TRAINER_OPERATOR,FIRST_VISIT_DATE
1536D,12-Feb-12,"06DA1B3-Lebanon NH",,15-Feb-12
F15D,18-May-12,"06405B2-Lebanon NH",,25-Jul-12
8096,8-Aug-12,"0643D38-Hanover NH","0643D38-Hanover NH",25-Jun-12
A036,1-Apr-12,"06CB8CF-Hanover NH","06CB8CF-Hanover NH",9-Aug-12
8944,19-Feb-12,"06D26AD-Hanover NH",,4-Feb-12
1004E,8-Jun-12,"06388B2-Lebanon NH",,24-Dec-11
11795,3-Jul-12,"0649597-White River VT","0649597-White River VT",30-Mar-12
30D7,11-Nov-12,"06D95A3-Hanover NH","06D95A3-Hanover NH",30-Nov-11
3AE2,21-Feb-12,"06405B2-Lebanon NH",,26-Oct-12
B0FE,17-Feb-12,"06D1B9D-Hartland VT",,16-Feb-12
127A1,11-Dec-11,"064456E-Hanover NH","064456E-Hanover NH",11-Nov-12
161FF,20-Feb-12,"0643D38-Hanover NH","0643D38-Hanover NH",3-Jul-12
A036,30-Nov-11,"063B208-Randolph VT","063B208-Randolph VT",
475B,25-Sep-12,"06D26AD-Hanover NH",,5-Nov-12
151A3,7-Mar-12,"06388B2-Lebanon NH",,16-Nov-12
CA62,3-Jan-12,,,
D31B,18-Dec-11,"06405B2-Lebanon NH",,9-Jan-12
20F5,8-Jul-12,"0669C50-Randolph VT",,3-Feb-12
8096,19-Dec-11,"0649597-White River VT","0649597-White River VT",9-Apr-12
14E48,1-Aug-12,"06D3206-Hanover NH",,
177F8,20-Aug-12,"063B208-Randolph VT","063B208-Randolph VT",5-May-12
553E,11-Oct-12,"06D95A3-Hanover NH","06D95A3-Hanover NH",8-Mar-12
12D5F,18-Jul-12,"0649597-White River VT","0649597-White River VT",2-Nov-12
C6DC,13-Apr-12,"06388B2-Lebanon NH",,
11795,27-Feb-12,"0643D38-Hanover NH","0643D38-Hanover NH",19-Jun-12
17B43,11-Aug-12,,,22-Oct-12
A036,11-Aug-12,"06D3206-Hanover NH",,19-Jun-12 
```

我的代码目前看起来像这样：

```
df_bigdata_duplicates = df_bigdata[df_bigdata.duplicated(cols='ID')] 
```

有几个重复的项目。但是，当我使用上面的代码时，我只得到第一项。在 API 参考中，我看到了如何获得最后一项，但我想拥有所有这些，这样我就可以直观地检查它们以了解为什么会出现差异。所以，在这个例子中，我想获取所有三个 A036 条目和 11795 条目以及任何其他重复的条目，而不是第一个。非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：245
> 
> 时间：2013-02-02T01:01:09.933

方法 #1：打印 ID 是重复 ID 之一的所有行：

```
>>> import pandas as pd
>>> df = pd.read_csv("dup.csv")
>>> ids = df["ID"]
>>> df[ids.isin(ids[ids.duplicated()])].sort("ID")
       ID ENROLLMENT_DATE        TRAINER_MANAGING        TRAINER_OPERATOR FIRST_VISIT_DATE
24  11795       27-Feb-12      0643D38-Hanover NH      0643D38-Hanover NH        19-Jun-12
6   11795        3-Jul-12  0649597-White River VT  0649597-White River VT        30-Mar-12
18   8096       19-Dec-11  0649597-White River VT  0649597-White River VT         9-Apr-12
2    8096        8-Aug-12      0643D38-Hanover NH      0643D38-Hanover NH        25-Jun-12
12   A036       30-Nov-11     063B208-Randolph VT     063B208-Randolph VT              NaN
3    A036        1-Apr-12      06CB8CF-Hanover NH      06CB8CF-Hanover NH         9-Aug-12
26   A036       11-Aug-12      06D3206-Hanover NH                     NaN        19-Jun-12 
```

但我想不出一个很好的方法来防止重复`ids`这么多次。我更喜欢方法 #2：`groupby`在 ID 上。

```
>>> pd.concat(g for _, g in df.groupby("ID") if len(g) > 1)
       ID ENROLLMENT_DATE        TRAINER_MANAGING        TRAINER_OPERATOR FIRST_VISIT_DATE
6   11795        3-Jul-12  0649597-White River VT  0649597-White River VT        30-Mar-12
24  11795       27-Feb-12      0643D38-Hanover NH      0643D38-Hanover NH        19-Jun-12
2    8096        8-Aug-12      0643D38-Hanover NH      0643D38-Hanover NH        25-Jun-12
18   8096       19-Dec-11  0649597-White River VT  0649597-White River VT         9-Apr-12
3    A036        1-Apr-12      06CB8CF-Hanover NH      06CB8CF-Hanover NH         9-Aug-12
12   A036       30-Nov-11     063B208-Randolph VT     063B208-Randolph VT              NaN
26   A036       11-Aug-12      06D3206-Hanover NH                     NaN        19-Jun-12 
```

* * *

## 回答 #2

> 赞同：206
> 
> 时间：2015-10-28T01:10:16.800

[使用 Pandas 0.17 版，您可以在重复](http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.duplicated.html)函数中设置“keep = False”以获取所有重复项。

```
In [1]: import pandas as pd

In [2]: df = pd.DataFrame(['a','b','c','d','a','b'])

In [3]: df
Out[3]: 
       0
    0  a
    1  b
    2  c
    3  d
    4  a
    5  b

In [4]: df[df.duplicated(keep=False)]
Out[4]: 
       0
    0  a
    1  b
    4  a
    5  b 
```

* * *

## 回答 #3

> 赞同：169
> 
> 时间：2017-01-22T02:50:32.567

```
df[df.duplicated(['ID'], keep=False)] 
```

它会将所有重复的行返回给您。

根据[文件](http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.duplicated.html)：

> keep : {'first', 'last', False}, 默认'first'</p>
> 
> *   first ：将重复项标记为 True，但第一次出现除外。
> *   last ：将重复项标记为 True，最后一次出现除外。
> *   False ：将所有重复项标记为 True。

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2019-01-05T09:47:38.713

*由于我无法发表评论，因此作为单独的答案发布*

要在多列的基础上查找重复项，请在下面提及每个列名，它将返回所有重复的行集：

```
df[df[['product_uid', 'product_title', 'user']].duplicated() == True] 
```

或者，

```
df[df[['product_uid', 'product_title', 'user']].duplicated()] 
```

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2018-11-19T15:06:27.480

```
df[df['ID'].duplicated() == True] 
```

这对我有用

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2015-06-17T13:38:55.473

使用元素逻辑或并将 pandas 复制方法的 take_last 参数设置为 True 和 False，您可以从包含所有重复项的数据框中获取一个集合。

```
df_bigdata_duplicates = 
    df_bigdata[df_bigdata.duplicated(cols='ID', take_last=False) |
               df_bigdata.duplicated(cols='ID', take_last=True)
              ] 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2019-07-25T20:31:52.577

`sort("ID")`现在似乎没有工作，似乎根据[sort doc](https://pandas.pydata.org/pandas-docs/version/0.19/generated/pandas.DataFrame.sort.html)已弃用，因此请改用`sort_values("ID")`在重复过滤器之后进行排序，如下所示：

```
df[df.ID.duplicated(keep=False)].sort_values("ID") 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2018-12-05T21:12:01.537

这可能不是问题的解决方案，而是举例说明：

```
import pandas as pd

df = pd.DataFrame({
    'A': [1,1,3,4],
    'B': [2,2,5,6],
    'C': [3,4,7,6],
})

print(df)
df.duplicated(keep=False)
df.duplicated(['A','B'], keep=False) 
```

输出：

```
 A  B  C
0  1  2  3
1  1  2  4
2  3  5  7
3  4  6  6

0    False
1    False
2    False
3    False
dtype: bool

0     True
1     True
2    False
3    False
dtype: bool 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2020-01-26T20:07:01.690

对于我的数据库，重复（keep=False）直到列被排序后才起作用。

```
data.sort_values(by=['Order ID'], inplace=True)
df = data[data['Order ID'].duplicated(keep=False)] 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2019-04-09T07:53:45.910

`df[df.duplicated(['ID'])==True].sort_values('ID')`

所有列值的重复行及其索引 loc #

```
def dup_rows_index(df):
  dup = df[df.duplicated()]
  print('Duplicated index loc:',dup[dup == True ].index.tolist())
  return dup 
```

# vb.net - 获取datagridview选中的行位置

> ID：14657243
> 
> 赞同：0
> 
> 时间：2013-02-02T00:22:19.693
> 
> 标签：vb.net

我必须从 datagridview 选定行打开一个对话框，该对话框可以通过代码、鼠标或键盘在取决于选定行位置的位置选择。

我得到选定的行索引：

```
Dim srow As Integer = DataGridView1.CurrentRow.Index 
```

如何最容易地获取该选定行的位置（XY 点）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T05:54:25.230

在 datagridview 单元格鼠标单击事件上执行代码，以便您获得确切位置

```
Private Sub dgvCust_CellMouseClick(ByVal sender As Object, ByVal e As System.Windows.Forms.DataGridViewCellMouseEventArgs) Handles dgvCust.CellMouseClick
    Label1.Text = "X." & e.X & vbCrLf & "Y." & e.Y
End Sub 
```

# macos - Mac OS X 中的 JDK

> ID：14657245
> 
> 赞同：3
> 
> 时间：2013-02-02T00:22:30.973
> 
> 标签：macos, java

我在我的 Mac 中找到了两个 JDK，一个在路径中：' `/System/Library/Java/JavaVirtualMachines/1.6.0jdk`'另一个在路径中：' `/Library/Java/JavaVirtualMachines/1.7.0jdk`'

有什么不同？为什么有两个？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-02T00:28:43.037

这`/System/Library/Java/JavaVirtualMachines/1.6.0jdk`是 Apple 用来与他们的操作系统一起分发的 JDK。此后，他们停止提供 JDK，并让 Java 平台的所有者 Oracle 来提供最新的 JDK，并且`/Library/Java/JavaVirtualMachines/1.7.0jdk`是 Oracle 提供的 JDK。

区别只是JDK的版本和供应商（提供者）。在您的系统上拥有多个 JDK 是非常好的。

# arrays - 排序数组（时间复杂度）

> ID：14657246
> 
> 赞同：1
> 
> 时间：2013-02-02T00:22:44.110
> 
> 标签：arrays, sorting, big-o, time-complexity

如果我有一个数组，其中单元格 0-N 已排序，单元格 N+1 直到 M+N，未排序。对数组进行排序的最佳时间复杂度是多少？

谢谢！

* * *

编辑：

谢谢 ！！如果我想就地这样做，它会改变复杂性吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-02T00:31:49.703

首先，只对 M 个未排序的元素进行排序。这需要时间 O(M log M) 使用基于比较的排序（如快速排序、合并排序或堆排序）。

然后将两个排序的段（长度为 N 和 M）合并在一起。这需要时间 O(M + N)。

所以最好的时间复杂度，使用基于比较的排序，是 O(M + N + M log M)。

# c++ - 管道优化，这样做有什么意义吗？

> ID：14657247
> 
> 赞同：2
> 
> 时间：2013-02-02T00:23:09.003
> 
> 标签：c++, optimization, assembly, cpu

来自另一家公司的一些非常有经验的程序员告诉我一些针对特定 CPU 的低级代码优化技巧，包括流水线优化，这意味着以特殊顺序排列代码（显然是内联汇编），使其更适合流水线对于目标硬件。

由于存在乱序和投机执行，我只是想知道做这种低级的事情有什么意义吗？我们主要从事高性能计算，因此我们可以真正专注于一种非常特定的 CPU 类型来进行优化，但我只是不知道进行这种特定的优化是否有任何意义，任何人都有这里的经验，从哪里开始? 有这种优化的代码示例吗？非常感谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-02T00:38:03.277

我首先会说编译器*通常会*充分优化代码（即足够好），只要您的高级代码和算法得到优化，您就不必担心这一点。一般来说，只有当您有确凿的证据表明存在可以量化和追踪的实际性能问题时，才应该进行手动优化。

现在，话虽如此，总是有可能改进事情——有时是一点点，有时是很多。

如果您在高性能计算游戏中，那么这种优化*可能*是有意义的。有各种各样的“技巧”可以做到，但最好留给真正的专家，而不是胆小的人。

如果您真的想了解有关此主题的更多信息，最好从阅读[Agner Fog 的网站](http://www.agner.org/optimize/)开始。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-02T00:32:31.717

## 管道优化将提高您的程序性能：

分支和跳转可能会迫使您的处理器重新加载指令流水线，这需要一些时间。这段时间可以专门用于数据处理指令。

## 流水线优化的一些平台无关方法：

1.  减少分支机构数量。
2.  使用布尔算术
3.  设置代码以允许有条件地执行指令。
4.  展开循环。
5.  使循环具有短内容（无需加载即可放入处理器的缓存中）。

## 编辑 1：其他优化

1.  通过消除功能和要求来减少代码。
2.  审查和优化设计。
3.  审查实施以获得更有效的实施。
4.  仅当所有其他优化都没有提供很少的性能改进时才恢复为汇编语言；仅优化 80% 时间执行的代码；通过分析找出。

## 编辑 2：数据优化

您还可以通过组织数据来提高性能。在网上搜索“数据驱动设计”或“优化性能数据”。

一种想法是最常用的数据应该靠近在一起并最终适合处理器的数据缓存。这将降低处理器必须重新加载其数据缓存的频率。

另一个优化是：加载数据（到寄存器中），对数据进行操作，然后将所有数据写回内存。这里的想法是在处理器处理数据（或寄存器）之前触发处理器的数据缓存加载电路。

如果可以的话，组织数据以适应处理器缓存的一个“行”。顺序位置比随机访问位置需要更少的时间。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-02T00:32:38.950

总有一些事情“帮助”与“阻碍”管道中的执行，但对于大多数不是高度专业化的通用代码，我希望编译代码的性能与你能得到的最好的一样好没有针对每种处理器型号的高度专业化的代码。如果您有一个受控系统，您的所有机器都使用相同（或少数类似）处理器型号，并且您知道 99% 的时间都花在了这个特定功能上，那么优化该特定功能以提高效率。

在您的情况下，它是 HPC，手写一些低级代码（例如矩阵乘法）以针对您正在运行的处理器进行优化可能是有益的。但是，这确实需要对处理器有一些合理的了解，因此您需要研究该处理器型号的优化指南，如果可以的话，请与以前使用过该处理器的人交谈。

您要查看的一些内容是“注册以注册依赖项”-您需要 c = a + b 的结果来计算 x = c + d -因此您尝试将这些与其他一些有用的工作分开，例如x 的计算不会被 c = a + b 计算所阻碍。

缓存预取和通常关心缓存的使用方式也是一件有用的事情 - 当您存储不会再次使用的生成的 1MB 数组时，不要将有用的缓存数据踢出，因为您需要 100 条指令几秒钟可能值得大量的处理器时间。

当编译器决定在自己的优化中对其进行洗牌时，很难（呃）控制这些东西，所以手写汇编器几乎是唯一的方法。

# jquery - Microsoft JScript 运行时错误：对象不支持属性或方法“tablesorterPager”

> ID：14657248
> 
> 赞同：0
> 
> 时间：2013-02-02T00:23:14.337
> 
> 标签：jquery, asp.net, asp.net-mvc

我刚刚开始使用 ASP.NET/MVC3、jquery、c#，应有尽有。我正在尝试遵循本教程： [http ://weblogs.asp.net/hajan/archive/2011/02/09/table-sorting-amp-pagination-with-jquery-in-asp-net-mvc.aspx](http://weblogs.asp.net/hajan/archive/2011/02/09/table-sorting-amp-pagination-with-jquery-in-asp-net-mvc.aspx)

我得到了排序工作，但是当我尝试添加分页时，我得到了错误：

```
Microsoft JScript runtime error: Object doesn't support property or method 'tablesorterPager' 
```

在网页上看到的第一个视图的 Index.cshtml 页面底部，我有这个：

```
<script type="text/javascript">
    $(document).ready(function () {
        $("#tbMyRequests").tablesorter({
                headers: {
                    8: {
                        sorter: false
                    }
                }
            }
        ).tablesorterPager({ container: $("#pager") });
    });
</script> 
```

它在 .tableSorterPager 行中断，并显示我之前提到的错误消息。当我查看可能导致该错误的原因时，我看到有人说同一个 jquery 库的两个副本可能相互冲突。最初我没有看到问题，但就像我说的，完全是菜鸟。在这个页面的顶部，我包含了这些库：

```
<script src="@Url.Content("~/Scripts/jquery-ui-1.8.11.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jquery.tablesorter.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jquery.tablesorter.pager.js")" type="text/>javascript"></script> 
```

我不确定它是否相关，但在 _Layout.cshtml 中，我看到了这个：

```
<script src="@Url.Content("~/Scripts/jquery-1.7.2.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/modernizr-1.7.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jquery.unobtrusive-ajax.js")" type="text/javascript"></script> 
```

这两个库是否相互冲突？当我尝试从 Index.cshtml 中删除 1.8.11.min.js 时，我仍然收到该错误。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T16:33:44.247

`>`您的脚本标签（包括 tablesorter.pager 插件）在 type 字段中有一个额外的。

# javascript - 在两个 jQuery 对象上调用相同的函数

> ID：14657250
> 
> 赞同：0
> 
> 时间：2013-02-02T00:23:19.177
> 
> 标签：javascript, jquery, jquery-ui

我想在两个 jQuery 对象上执行相同的代码。

```
var a = $('.one_div');

.... more code ...

var b = $('.ban');

.... more code ...

a+b .hide('fast'); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-02T00:24:43.430

使用[`.add()`](http://api.jquery.com/add/)：

```
a.add(b).hide('fast'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T00:39:29.947

另一种方式

```
$('.one_div , .ban').hide('fast'); 
```

如果您想在缓存变量上使用相同的逻辑，那么`.add()`就是要走的路。

# internet-explorer-9 - 随机单元格出现在动态生成的表格 IE9 中

> ID：14657253
> 
> 赞同：1
> 
> 时间：2013-02-02T00:23:28.320
> 
> 标签：internet-explorer-9, wicket

我正在使用 Wicket（6.4.0，但自从我们使用 1.4 以来一直在发生）使用 wicket 的 ListView 组件生成动态大小的表格（我也使用 DataView 和其他组件体验过这种情况）。有时，表格会显示一个额外的单元格，该单元格会将其他单元格从正确的列中凸出，但仅针对一行！很难解释，请看下图：

![在此处输入图像描述](../Images/5d1a95fd6c419a838e91e5c977c4a52f.png)

生成的 html 不显示正在生成的任何额外的 td 元素。有谁知道是什么原因造成的，或者更好的如何避免它？

编辑：这个问题是由一个 IE9 和 IE10 错误引起的，它在`</td>`和下一个之间的空格处犹豫，`<td>`所以我改变了：

```
 <table>
       <tr>
         <td wicket:id="..."/>
         <td wicket:id="..."/>
       </tr>
     <table> 
```

至：

```
 <table>
       <tr>
         <td wicket:id="...">
         </td><td wicket:id="..."/>
       </tr>
     <table> 
```

神秘细胞停止出现！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-02T02:42:15.247

当 div 或 span 等进入表 -> tr -> td 层次结构时，我已经看到了类似的“工件”。确保这三个标签之间没有任何此类标签，如果将 ListView 添加到 div 或 span 标签，请在列表项上使用 setRenderBodyOnly(true)。

# python - 多参数函数 - *args / **kwargs 的正确使用

> ID：14657254
> 
> 赞同：1
> 
> 时间：2013-02-02T00:23:29.007
> 
> 标签：python, optional-parameters, args

我有一个这样的功能：

```
def hexify_string(aString):
    #code for string2hexa conversion 
```

...并且我希望有一个函数接受一个或多个（数量未定义）参数，并返回参数总和的十六进制表示。

```
def hexify(a,b...n):
    #map hexify_string to all the parameters, and return the sum of them 
```

有没有办法使用 *args / **kwars 做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T00:29:15.400

这是你想要的吗？收集任意数量的参数，它们都应该是字符串。传递每个`hexify_string()`返回整数的字符串。对整数求和并返回总和。

```
def hexify(*lst):
    n = sum(hexify_string(s) for s in lst)
    return n 
```

当你想收集参数时，你想把它们都一样对待，你不知道会有多少，这正是`*args`语法的目的。这是一个完美的用例。

`**kwargs`收集`name=value`论点，你不希望这里有任何论点。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-02T00:30:40.150

`*args`获取所有非关键字参数并将它们转换为列表。您可以映射`hexify_string`到列表的每个元素，然后返回列表中所有元素的总和。

```
def hexify(*args);
    return sum(map(hexify_string, args) 
```

这是假设您的`hexify_string`函数返回一个十六进制值，而不是一个字符串。

# jquery - 试图将 div 附加到类，有什么问题？

> ID：14657255
> 
> 赞同：0
> 
> 时间：2013-02-02T00:23:29.053
> 
> 标签：jquery

```
$(document).ready(function () {
    $('#button').click(function () {
        if ($('#newauthor') = !'' && $('#newquote') = !'') {
            var addAuthor = $('input[newauthor]').val();
            $(".allquotes").append("<div class = 'quotesbox'><p class = 'author'>" + addAuthor + "</p></div>");

            var addQuote = $('input[newquote]').val();
            $(".allquotes").append("<div class = 'quotesbox'><p class = 'author'>" + addQuote + "</p></div>");
        }
    }); 
}); 
```

我似乎无法弄清楚。我正在尝试检查 newauthor 和 newquote 中是否包含某些内容，然后将它们添加到“allquotes”类中。我是这个网站的新手，所以我真的不知道正确的问题结构。*编辑任何原因点击功能不起作用[？](http://jsfiddle.net/xzrA3/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T00:34:11.307

**首先，不等于**的语法错误

 **`=! ''` 应该是 `!= ''`

其次 $('#newauthor') 是一个 jQuery 对象

所以你需要检查**null**而不是**空字符串**

```
 if( !$('#newauthor') &&  !$('#newquote')){ 
```

如果要检查页面上是否存在元素

如果要检查其中文本的条件..

然后对于表单元素使用 `$(selector).val()`

否则使用 `$(selector).text()`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T00:27:11.363

如果它们是 div 或其他类型的元素，并且您正在尝试确定 newauthor 和 newquote 中是否有任何文本，您想要

```
if ($('#newauthor').text() != '' && $('#newquote').text() != '') { 
```

因为 $('#newauthor') 返回一个 jQuery 对象，然后它有一堆方法可以用来做各种事情，比如获取文本内容。但是很难说 newauthor 和 newquote 是什么。如果它们是输入，那么你想要

```
$("#newauthor").val() != '' && $("#newquote").val() != "" 
```

if 子句的内部。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-02T00:48:16.637

您只需要根据您的小提琴重新安排一点：

```
$('#button').on('click', function(){
    var addAuthor= $('input[name=newauthor]').val();
    var addQuote= $('input[name=newquote]').val();
    if(addAuthor != '' && addQuote != ''){
        $(".allquotes").append("<div class = 'quotesbox'><p class = 'author'>" + addAuthor + "</p></div>");
        $(".allquotes").append("<div class = 'quotesbox'><p class = 'author'>" + addQuote + "</p></div>");
        };
}) 
```**

# php - 致命错误：调用成员函数 prepare() - 使用登录函数时

> ID：14657257
> 
> 赞同：0
> 
> 时间：2013-02-02T00:23:42.637
> 
> 标签：php, mysql, pdo

不知道为什么我会突然收到这些错误......

```
Fatal error: Call to a member function prepare() on a non-object in login.php on 
line 21 Call Stack: 0.0005 675088 1\. {main}() login.php:0 0.0017 678544 2.
LoginSubmit() login.php:7 
```

是因为我处理数据库连接的方式吗？顺便说一句，密码被存储为简单文本这一事实并不介意，因为正在构建的系统仅用于演示目的。

```
// database connection

$hostname = "xxx";
$username = "xxx";
$dbname = "xxx";
$password = "xxx";

try {
    $pdo = new PDO("mysql:host=$hostname;dbname=$dbname", 
    $username, $password);
    }
catch(PDOException $e)
    {
    echo $e->getMessage();
    }

// login code     

if(isset($_POST['pmsubmit']))
{
  LoginSubmit('pm', 'pmname', 'pmpass');
}

if(isset($_POST['tssubmit']))
{
  LoginSubmit('ts', 'dept', 'tspass');
}

function LoginSubmit($pm_or_ts, $the_name, $the_pass)
{
  $the_name = $the_name;
  $posted_name = $_POST[$posted_name];
  $posted_pass = $_POST[$posted_pass];
  // check if password matches the one in the table
  $query = $pdo->prepare("SELECT * FROM db_pass WHERE pass = :pass"); // line 21
  $query->execute(array(":pass" => $posted_pass));
  // if there is a match then we log in the user
  if ($query->rowCount() > 0)
  {
    // session stuff
    $_SESSION[$the_name] = $posted_name;
    // refresh page
    header( 'Location: ' . $pm_or_ts . '/index.php' ) ;
  } 
  // if there is no match then we present the user with an error
  else
  {
    echo "error";
    exit;
  }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T00:46:10.397

您的`$pdo`变量在函数中不可见`LoginSubmit`，您应该查看[变量](http://php.net/manual/en/language.variables.scope.php)范围有问题..无论如何您可以像这样将变量添加到函数中：

```
function LoginSubmit($pm_or_ts, $the_name, $the_pass)
{
    global $pdo;
    ..
    ..
} 
```

或通过函数参数

# c++ - 从网络摄像头图像中检测对象

> ID：14657258
> 
> 赞同：0
> 
> 时间：2013-02-02T00:23:48.897
> 
> 标签：c++, opencv

对于我正在做的一个项目，我在我的计算机上存储了数百张图像的“图像库”。计算机在向其网络摄像头呈现这些精确图像之一时，需要能够确定它是这 100 个图像中的哪一个。

起初，我考虑使用直方图来匹配图像，但我觉得这并不像它应该的那样有效，因为我知道呈现的图像将与存储的图像完全相同（不仅仅是相同）对象，但也是相同的图像）。我想做的就是消除所有网络摄像头的噪音，然后缩放图像的亮度、对比度等，然后在网上找到最接近的匹配。

是否有一个内置的 OpenCV 函数可以做这种事情？如果没有，我可以写什么样的算法来做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T01:10:47.837

这种事情可以在opencv中通过首先从您的“图像库”中提取recriminative features f并以某种方式表示特征f来帮助您进行搜索过程来完成。要找到您需要使用 opencv 算法 SIFT、SURF、FAST 等的功能。由于您只有 100 张图像，因此要构建搜索索引，您可以使用 KD-tree。如果您要在“图像库”中获取更多图像，请使用 (BoW)Bag of Words 表示。所有算法都包含在 opencv 中，取决于您的选择和实现。希望能给你一些信息，进一步阅读关于算法使用的 opencv 文档。

# ruby-on-rails - 如何在 JBuilder 中构建以下 to_json？

> ID：14657261
> 
> 赞同：0
> 
> 时间：2013-02-02T00:24:25.193
> 
> 标签：ruby-on-rails, ruby, json, jbuilder

我的模型中有方法

```
def indexed_json
  to_json(
    only: [:id, :chanell_id, :title],
    include: [
      :locations,
      {categories: {only: [:name, :id]}}
    ]
  )
end 
```

我想在 JBuilder 中重写它并添加另一个属性：`type_name: self.class.name`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T15:47:14.080

我的答案：

```
def to_indexed_json
  Jbuilder.encode do |json|
    json.id self.id
    json.app_id self.app_id
    json.title self.title
    json.type_name self.class.name.titleize
    json.app_name self.app.name
    json.locations self.locations
    json.categories self.categories, :name, :id
  end
end 
```

# neo4j - 查找具有所有公共中介的节点

> ID：14657265
> 
> 赞同：3
> 
> 时间：2013-02-02T00:25:21.343
> 
> 标签：neo4j, cypher

我正在创建一个我们匹配的`orders`系统`staff`。从概念上讲，an`order`是对某人做某项工作的请求，而 a`staff`是可以做该工作的人。一个`order`可以拥有一个或多个`requirements`（即限制谁可以从事这项工作），而一个`staff`可以拥有更多一个`requirements`（即从事工作的资格）。

我正在尝试创建一个密码查询，它将为我`staff`提供*所有*由给定的`requirement`s 列出的所有内容`order`。换句话说，我试图找到与给定节点`staff`相关的每个节点相关的所有节点。**我的问题是**：如何创建密码查询来建模该业务逻辑？`requirement``order`

 **例如，考虑以下示例数据：

*   [我的示例数据的图片视图](http://imgur.com/PEipatA)
*   或者，这是[我的数据的交互式控制台](http://console.neo4j.org/?id=ukzlme)

查看*orderId: 1*节点。`requires`它与标记为*RN*和*ER IV*的两个节点有关系。换句话说，订单 #1 要求任何申请人都具有 RN 资格和 ER IV 资格。碰巧工作人员*Evan* ( *staffId: 1* ) 具有这两种资格，因此他应该能够申请该工作。工作人员*蒂姆*有这些要求之一，但不是两者都有，所以他应该不能申请那份工作。此外，*orderId: 2*只有一个要求，Evan 和 Tim 都有，所以他们都应该能够申请该工作。

因此，从本质上讲，如果我从订单#1 开始，我只想找回 Evan。如果我要从订单#2 开始，我想找回 Evan 和 Tim*。

下面的查询已经完成了一半。它将为我提供从给定订单到工作人员一次一项要求的所有独特路径。但是，它不会检查是否满足每个需求路径（这意味着目前它仅适用于只有一个需求的订单）：

```
start o=node(2) 
match o-[:requires]->req<-[:hasRequirement]-s 
return o, req, s; 
```

那么我的选择是什么？我可以以某种方式检查是否存在未知数量的匹配关系？或者我需要以不同的方式对我的数据进行建模吗？

***编辑：**我在设置样本数据时犯了一个错误。*Tim*应该与*RN*相关联，以便他有资格获得订单 #2。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-02T14:11:55.680

我想这个密码语句可以解决你的问题：

```
start o=node(2) 
match o-[:requires]->req<-[:hasRequirement]-p 
with o, p, count(req) as c 
where length(o-[:requires]-()) = c 
return p, c 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-02T14:11:45.713

我想出了

```
start o=node(2) 
match o-[orderReqRel:requires]->r 
with count(orderReqRel) as orderReqs, o 
match p-[personReqRel:hasRequirement]->r<-[:requires]-o 
with count(personReqRel) as personReqs,p,orderReqs 
where personReqs=orderReqs
return p; 
```

似乎适用于我只返回埃文的订单 1。订单 2 似乎没有蒂姆的要求（您的解释表明，但由于某种原因，在您共享的控制台中没有看到它）**

# macos - mac OS X 上的资源限制 (setrlimit)

> ID：14657270
> 
> 赞同：10
> 
> 时间：2013-02-02T00:25:29.313
> 
> 标签：macos, resources

我试图了解如何在 Mac OS X（我有 10.6）的进程中对进程设置资源限制。在 CentOS 上，以下测试程序 (python3.3) 可以正常工作：

```
import resource
import signal

def confirm(prompt, instructions='(y)es or (n)o only, please.'):
    while True:
        ok = input(prompt)
        if ok in ('y', 'ye', 'yes'):
            return True
        if ok in ('n', 'no'):
            return False
        print(instructions)

def handle_cpu_soft_limit(signal, frame):
    print('CPU soft limit reached.')
    if not confirm('Do you want to continue anyway? (y/n): '):
        raise ResourceWarning()

def long_function():
        a = 0
        while True:
            a += 1
            a -= 1

def main():
    # set soft limit to 1 second, hard limit to 5 seconds (CPU time)
    resource.setrlimit(resource.RLIMIT_CPU, (1, 5))
    # set handler for soft CPU limit signal
    signal.signal(signal.SIGXCPU, handle_cpu_soft_limit)
    # do some busy work
    try:
        long_function()
    except ResourceWarning:
        print('Stopping now before being forced.')

if __name__ == '__main__':
    main() 
```

程序会消耗 CPU 时间，直到达到软限制（1 秒，传递给 的元组中的第一个元素`resource.setrlimit()`）。程序捕获操作系统（在本例中为 SIGXCPU）发送的信号并询问我是否要继续。在 CentOS（或其他 Linux）上，如果我说是，它会每隔一秒再次询问我，直到达到硬限制（5 秒），此时操作系统会终止进程。在 Mac OS X 上，我仍然获得并处理 SIGXCPU 信号，但我再也没有收到信号，并且进程永远不会被杀死，即使达到硬限制也是如此。这可能与提问者的经历有关，也可能[无关](https://stackoverflow.com/questions/9916483/python-child-process-limits)。

`setrlimit`Mac OS X 上的手册页说明如下：

> 资源限制被指定为软限制和硬限制。当超过软限制时，进程可能会收到信号（例如，如果超过 cpu 时间或文件大小），但将允许它继续执行直到达到硬限制（或修改其资源限制）。

…实际上来自 setrlimit 上的 BSD 4.2 手册页。然而，当达到硬限制时，程序似乎永远不会收到 SIGKILL。我在 google 和 SO 上搜索了有关 mac setrlimit 的信息，但没有找到太多有用的信息。我有两个问题：

1.  这种行为（特别是 mac os X 忽略了对进程的硬限制）是否有意并记录在任何地方？我在这里用 python 编写了我的示例，但是在 C 中也发生了同样的事情（我可以​​根据要求在此处发布一些测试代码），所以这不是语言错误。

2.  有没有办法让这段代码在 linux 和 mac 上表现相同？或者我应该把软限制当作mac上的硬限制吗？

# java - 免费的延迟初始化

> ID：14657275
> 
> 赞同：5
> 
> 时间：2013-02-02T00:26:13.633
> 
> 标签：java, jvm, singleton, lazy-initialization, double-checked-locking

在[一篇](http://www.javaworld.com/javaworld/jw-02-2001/jw-0209-double.html?page=5)关于双重检查锁定习语的文章中，我发现了这句话：

> 一种在没有同步的情况下按预期工作的延迟初始化的特殊情况是静态单例。当初始化的对象是**一个没有其他方法或字段的类的静态字段时**，JVM有效地自动执行惰性初始化。

为什么强调的部分很重要？*如果有*其他方法或字段，为什么它不起作用？

（文章已经有10多年了。信息还相关吗？）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-02T00:43:23.843

这可能意味着，如果一个类没有其他方法或字段，那么您只能为单例访问它，因此单例仅在需要时创建。否则，例如

```
class Foo 
{
    public static final Foo foo = new Foo();

    public static int x() { return 0; }
}

class AnotherClass
{
    void test() 
    {
        print(Foo.x());
    }
} 
```

在这里，`foo`被实例化了，尽管它从未被要求过。

但是有私有静态方法/字段是可以的，这样其他人就不会意外触发类初始化。

# java - 查找数组中最后一个零的索引

> ID：14657278
> 
> 赞同：1
> 
> 时间：2013-02-02T00:26:33.040
> 
> 标签：java

我编写了以下代码来查找数组中的最后一个零索引：

```
public class Stack {
    public static void main(String[] args){
        int[] a=new int[5];
        a[0]=1;
        a[1]=0;
        a[2]=90;
        a[3]=0;
        a[4]=4;
        findLast(a);
    }
    public static int findLast(int[] x){
        for(int i=0;i<x.length;i++){
         if(x[i]==0){
             System.out.println(i);             
         }
        }
        return 0;
    }
} 
```

输出如下：

```
1
3 
```

我真正想要的是索引 3。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-02T00:28:27.883

*   从数组末尾开始（即`i=x.length-1`）
*   递减`i`而不是递增（即使用`i--`）
*   一旦达到零就停止（即在`break`之后添加`println`）。
*   使您的停止条件使得循环处理索引为零的元素。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-02T00:29:26.907

只需将循环从`x.length-1`to反转`0`并在第一次匹配时返回索引：

```
public static int findLast(int[] x) {
    for (int i=x.length-1; i>=0; i--) {
        if (x[i] == 0) {
            // match found, return index
            return i;
        }
    }
    // no match found, return invalid index
    return -1;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-02T00:34:16.767

```
public class Stack {
    public static void main(String[] args){
        int[] a=new int[5];
        a[0]=1;
        a[1]=0;
        a[2]=90;
        a[3]=0;
        a[4]=4;
        findLast(a);
    }
    public static void findLast(int[] x){
        for(int i=x.length()-1;i>0;i++){
        if(x[i]==0){
            System.out.println(i);
            break;
        }
    }
} 
```

}

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-02T01:59:14.433

```
public static int lastZero(int[] x){
        int temp=0;
        for(int i=0;i<x.length;i++){
         if(x[i]==0){
             temp=i;
         }
        }
        System.out.println(temp);
        return 0;
    } 
```

这将提供所需的输出。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-02T02:21:42.733

从数组的 END 开始并递减。如果我们永远找不到零，这将返回 -1，它总是在索引之外。这是你解释的

```
public class Stack {
public static void main(String[] args){
    int[] a=new int[5];
    a[0]=1;
    a[1]=0;
    a[2]=90;
    a[3]=0;
    a[4]=4;
    findLast(a);
}
public static int findLast(int[] x){
    for(int i=x.length-1;i>=0;i--){
     if(x[i]==0){
         return i;             
     }
    }
    return -1;
} 
```

}

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-02T00:29:41.313

如果您的约束是从头开始遍历数组，则将索引存储为当您查看`0`变量时，并且在完成循环时只需打印变量

```
int lastindex;
for(int i=0;i<x.length;i++){
         if(x[i]==0){
             lastindex=i;
}
System.out.println(lastindex); 
```

# angularjs - Zrub Foundation 下拉按钮在 Angular 部分内部中断

> ID：14657282
> 
> 赞同：2
> 
> 时间：2013-02-02T00:27:02.273
> 
> 标签：angularjs

当我在 Angular 部分中使用 Zrub Foundation 下拉按钮时，乍一看它们看起来不错，但是当您单击以显示选项时，它们不会显示。悬停时按钮的颜色并单击更改，只是列表项不显示。

控制台中没有错误。此外，如果我将按钮代码直接放在 index.html 中，则下拉行为可以正常工作。

关于如何让下拉按钮在部分内部工作的任何想法？

应用程序.js

```
'use strict';
angular.module('myapp', ['myappFilters', 'myappServices']).
  config(['$routeProvider', function($routeProvider) {
  $routeProvider.
      when('/test', {templateUrl: 'partials/test.html',   controller: EnvListCtrl}).
}]); 
```

测试.html

```
<div href="#" class="medium button dropdown full-width">
  Dropdown Button &nbsp;
  <ul>
    <li><a href="#">Choice 1</a></li>
    <li class="divider"></li>
    <li><a href="#">Choice 2</a></li>
    <li><a href="#">Choice 3</a></li>
  </ul>
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T15:30:02.707

我的解决方法是`change`在选择元素上触发，然后`click`在锚点和列表元素上触发。

这实质上初始化下拉元素以正确显示，同时考虑到设置为选定元素的任何内容。

我有一个显示模式内的下拉菜单，它位于一个部分内。就我而言，我在激活模态之前初始化元素。

标记

```
<select style="display:none;" id="customDropdown" 
  ng-options="o.label for o in apptStatusOpts" ng-model="apptStatus"></select>

<div class="custom dropdown">
  <a href="#" class="current">Appointment Status</a>
  <a href="#" class="selector"></a>
  <ul>
    <li ng-repeat="o in apptStatusOpts">{{o.label}}</li>
  </ul>
</div> 
```

javascript

```
$("#customDropdown").trigger('change');
$("#customDropdown a.current").trigger('click');
$("#customDropdown li.selected").trigger('click'); 
```

另请注意，Foundation 3 是我正在使用的。不确定最近发布的 Foundation 4 是否有任何变化。

# php - 我在哪里可以找到像 facebook 这样的 g+ api php 文档？

> ID：14657285
> 
> 赞同：0
> 
> 时间：2013-02-02T00:27:33.237
> 
> 标签：php, api, google-plus, google-api-php-client

我正在使用 g+ 登录开发 Web 应用程序，我需要来自他的 g+ 帐户的用户的许多信息。我目前正在使用 google-api-php-client API。是否有像 facebook 这样的良好文档？我搜索了很多网站，但找不到任何网站。请建议一些链接..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T00:45:08.290

在这里尝试：[Google+ API - Google+ 平台](https://developers.google.com/+/api/)

# php - 如何在 jQuery ui 日期/时间选择器输入字段上输出（来自 PHP 的日期值）？

> ID：14657288
> 
> 赞同：0
> 
> 时间：2013-02-02T00:28:23.353
> 
> 标签：php, jquery, uidatepicker

对于我的日期时间字段，我使用了 jQuery 日期/时间选择器。

[http://trentrichardson.com/examples/timepicker/](http://trentrichardson.com/examples/timepicker/)

这工作得很好。

但是在更新表单上，当我尝试在此日期/时间选择器输入字段上从数据库中输出日期时，它不起作用。当我检查元素时，日期值就在那里（以正确的 ui 日期/时间选择器格式），如下图所示：

![UI 日期/时间选择器字段上的输出问题](../Images/9945300d89f075710d393b7bb24a5c90.png)

如何使 PHP 的日期值出现在 datepicker 字段上？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T00:41:04.600

在创建选择器时，不要设置生成的输入字段的值，而是传入*defaultValue参数。*请参阅[选项选项卡，其他选项](http://trentrichardson.com/examples/timepicker/)，即

```
defaultValue
    Default: null - String of the default time value placed in the input on focus when the input is empty. 
```

看起来它可能仅在选择时才有效（例如，它说“聚焦”）。

或者，虽然我不熟悉 timepicker，但您应该能够使用[setDate() 方法](http://api.jqueryui.com/datepicker/#method-setDate)来设置日期/时间，在 a`$(document).ready`或类似内容中使用类似这样的内容：

```
$( ".selector" ).datetimepicker( "setDate", "<?php echo $time_date?>" ); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-11-09T15:01:20.323

你不能这样做。jQuery Datepicker 禁用输入字段值，除非在字段值中硬编码。如果您使用从数据库或其他东西填充，请使用以下方法。可以使用[setDate](http://api.jqueryui.com/datepicker/#method-setDate)函数来完成。如下：-

```
$( "#your_input_id" ).datepicker( "setDate", "<?php echo $date_value;?>" ); 
```

它适用于仅日期和带有时间字段的日期。它会自动适合您的日历格式化的值。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-02T00:51:56.663

只需使用 PHP 的`date()`函数以`value`与 jQuery 相同的方式格式化属性。

# api - PayPal Express Check Out Digital Goods 奇怪行为

> ID：14657291
> 
> 赞同：0
> 
> 时间：2013-02-02T00:28:45.137
> 
> 标签：api, paypal, sandbox

我已经通过沙箱中的向导设置了 Express Checkout 付款。进行了几次测试交易。然后它停止工作。但是，没有进行任何更改。

登录并按下 Paypal 网页上的 Pay 按钮后，它显示 LOADING 并一直加载，没有任何反应。

我试过在线代理，即zend2.com。想法是您可以通过该网站浏览网页。付款通过。

所以我在我的服务器上设置了相同的在线代理脚本。它再次起作用。通过我的服务器！如果我通过自己的网站导航到该网站，它就可以工作。 [http://fermerius.hostoi.com/glype/index.php](http://fermerius.hostoi.com/glype/index.php) - 代理 [http://fermerius.hostoi.com/ppp/](http://fermerius.hostoi.com/ppp/) - 存储。

但是如果你直接去商店它不会加载。它显示加载中......

我从向导中获取的所有代码。什么都没有添加。只是为了测试它的基础知识。

任何人都可以阐明这个问题吗？为什么会这样？可以做些什么来解决它？

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T01:15:37.580

它又开始工作了。可能是他们的问题。

# mysql - 使用两个单独的表的 SQL 查询设计？MySQL PHP PDO 性能

> ID：14657292
> 
> 赞同：0
> 
> 时间：2013-02-02T00:28:59.620
> 
> 标签：mysql, sql, pdo, database-performance

我想知道当我有两个单独的表时如何设计我的 SQL 查询，但应该一起工作......

`likes`桌子

**列**- idlikes、idusers、like_what

* * *

`user_follow`桌子

**列**- idfollow、follower、following

* * *

设计优化/性能查询的最佳方法是什么？可以合并查询吗？或者我应该像这样分开每个查询：

```
$iduser = 1 //I am user 1 in database.

$get = $db -> prepare("SELECT * FROM user_follow WHERE follower = ?")
$get -> execute(array($iduser));
while($row = $get->fetch(PDO::FETCH_ASSOC)){
     $following = $row['following']; // get id of user that i'm following

     $likes = $dbh->prepare("SELECT * FROM likes WHERE idusers = ?");
     $likes->execute(array($following));
     // do what I need to..

} 
```

* * *

更新

```
$following = $dbh->prepare("SELECT L.* FROM likes L JOIN user_follow F on L.iduser = F.iduser_following WHERE F.iduser_follower = ?");
$following->execute(array($iduser));

while($row_following = $following->fetch(PDO::FETCH_ASSOC))
{
  $id1 = $row_following['L.iduser'];
  echo $id1;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T00:39:12.690

这将在一个查询中完成

```
SELECT L.*
FROM likes L
JOIN user_follow F ON L.idusers = F.following
WHERE F.follower = ? 
```

关于命名的说明：在 sql 中，每一行都包含一个值，因此列名通常是单数的。因此`likes.idusers`通常是`likes.iduser`

如果它是 iduser 上的 FK，我也会明确说明，所以在 user_follow 表中，我将命名`follower`为`iduser_follower``following``isuser_following`

# ruby-on-rails - Rails] 富文本编辑器上传到 Amazon S3

> ID：14657293
> 
> 赞同：2
> 
> 时间：2013-02-02T00:29:10.057
> 
> 标签：ruby-on-rails, amazon-s3, ckeditor, carrierwave, redactor

我想为我的 Rails 应用程序使用 ckeditor 或 redactor。[ckeditor](https://github.com/galetahub/ckeditor)和[redactor-rails](https://github.com/SammyLin/redactor-rails)已经与Carrierwave很好地集成，但我想知道如何将上传文件夹编辑到我的 Amazon S3，而不是应用程序内的默认文件夹。

Redactor javascript 版本 ( [this](http://imperavi.com/redactor/examples/s3/) ) 实际上提供了一种使用 javascript 执行此操作的方法，但我想通过我的 rails 应用程序使用 Carrierwave 和 Fog 来执行此操作。这对我来说似乎更自然，但请告诉我使用 javascript 这样做是否没有害处，或者使用 Carrierwave 和 Fog 这样做是否有好处。

由于我还没有找到解决这个问题的方法，所以我避免集成富文本编辑器，让用户只使用纯文本，每篇文章上传一张图片。然而，一个漂亮的文本编辑器现在已成为必需品。

我找不到有关此问题的任何文档，而且我敢肯定还有许多其他人遇到过类似的问题。

如果有人知道如何修复ckeditor和redactor的设置以使用carrierwave和fog将图片上传到Amazon S3，请留下答案。将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-07T16:53:44.780

将配置放在 javascript 端没有任何害处，因为您的私钥永远不会暴露（而且您永远不应该暴露它）。

您使用以下代码（位于服务器上）生成签名和策略。

```
policy_json='{"expiration": "2020-01-01T00:00:00Z",

  "conditions": [ 
    {"bucket": "bucket name"}, 
    ["starts-with", "$key", ""],
    {"acl": "public-read"},
    {"success_action_redirect": "redirect url"},
    ["starts-with", "$Content-Type", ""],
    ["content-length-range", 0, 1048576]
  ]
}'
policy=Base64.encode64(policy_json).gsub("\n","")
signature = Base64.encode64(OpenSSL::HMAC.digest(OpenSSL::Digest::Digest.new('sha1'), 'Your private key', policy)).gsub("\n","") 
```

因此，您的私钥存储在服务器端，现在您可以进行 ajax 调用来获取这些值（策略和签名）并将其放在您的视图中。

现在，在您的存储桶策略中，您可以指定 AllowedOrigin 为 www.yourwebsite.com。

这将只允许您的网站将内容发布到存储桶，从而防止任何恶意用户将内容发布到您的帐户。

# glm-math - 将 glm::vec4 转换为 glm::vec3

> ID：14657303
> 
> 赞同：19
> 
> 时间：2013-02-02T00:30:11.233
> 
> 标签：glm-math

如何将 a 转换`glm::vec4`为 a `glm::vec3`？

只有`x`, `y`,`z`是必需的-`w`可以删除组件。

在 GLSL 中，这可以使用`.xyz`[1] 来完成，但在 glm 中，这会导致编译错误：

```
error: 'glm::vec4' has no member named 'xyz' 
```

[1] [http://en.wikibooks.org/wiki/GLSL_Programming/Vector_and_Matrix_Operations#Components](http://en.wikibooks.org/wiki/GLSL_Programming/Vector_and_Matrix_Operations#Components)

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2013-09-17T06:05:58.297

只需使用 vec3**构造函数**。在这里，在 0.9.5 分支上：

```
glm::vec4 v4(1, 2, 3, 4);
glm::vec3 v(v4);
printf("%s\n", glm::to_string(v).c_str()); 
```

并给出这个输出

> fvec3(1.000000, 2.000000, 3.000000)

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2013-02-02T00:30:11.233

默认情况下，glm 中未启用 Swizzling，因为它使用可能导致命名冲突的宏。要启用它：

```
#define GLM_SWIZZLE
#include <glm/glm.hpp> 
```

在 glm 中，swizzling 是使用函数完成的：

```
vec3 v3 = v4.xyz(); 
```

见： http: [//glm.g-truc.net/0.9.2/api/a00002.html](http://glm.g-truc.net/0.9.2/api/a00002.html)

# ruby-on-rails - ROR：你能在每个控制器的基础上配置一个异常处理程序吗？

> ID：14657305
> 
> 赞同：0
> 
> 时间：2013-02-02T00:30:21.100
> 
> 标签：ruby-on-rails

在我的 ROR 项目中，我有一个控制器，我希望始终在其中捕获异常以在错误传播回调用者之前进行一些清理。这可以在 ROR 中完成吗？我想要一个在控制器中遇到任何异常时都会调用的钩子。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T00:42:00.227

您可以使用`around_filter`.

```
class PagesController < ApplicationController

  around_filter :custom_handle_exception

  def show
    # ...
  end

  private

  def custom_handle_exception
    yield
  rescue StandardError => e
    handle_the_error(e)
    raise e
  end

end 
```

`rescue_from`你也可以用类方法做类似的事情。

您通常不应该挽救*所有*异常。不过，异常继承[`StandardError`](http://rubylearning.com/satishtalim/ruby_exceptions.html)应该可以很好地挽救。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-02T00:49:37.197

您可以使用[`rescue_from`](http://api.rubyonrails.org/classes/ActiveSupport/Rescuable/ClassMethods.html)：

```
 class WhateverController < ApplicationController
      rescue_from Exception do |exception|
        # whatever handling here
      end

      # ...
    end 
```

# ruby-on-rails - 仅显示单个帖子中的多个图像中的一个

> ID：14657308
> 
> 赞同：0
> 
> 时间：2013-02-02T00:30:45.913
> 
> 标签：ruby-on-rails, ruby-on-rails-3, associations, paperclip, models

我正在使用回形针将多个图像上传到模型，我有一个包含许多照片的帖子模型。

当我在视图中显示这些并且有多个图像分配给帖子时，帖子会乘以照片数量，所以如果有三张图像，我会得到三个相同的帖子。我知道为什么会这样像这样循环记录

```
<ul>
 <% @tynewyddpost.each do |t| %>
<li>
 <% t.photos.each do |p| %>
<a class="photo" href="#"><%= image_tag p.avatar.url(:thumbnail_news_images) %></a>
<p><a href=""><%= t.title %></a></p>
<p class="date"><%= t.created_at %></p>
</li>
<% end %>
<% end %>
</ul> 
```

如果有多个，我如何声明我只希望显示一个，我需要查看哪种方法？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T00:40:52.337

好的，所以找到了答案

```
<ul>
 <% @tynewyddpost.each do |t| %>
 <li>
 <% single = t.photos.first %>#Added this above call for image
 <a class="photo" href="#"><%= image_tag(single.avatar.url(:thumbnail_news_images)) %></a>#call first image like this
 <p><a href=""><%= t.title %></a></p>
 <p class="date"><%= t.created_at %></p>
 </li>
<% end %>
</ul> 
```

# jquery - Swifttype Autocomplete JQuery 按文档类型分离结果

> ID：14657311
> 
> 赞同：1
> 
> 时间：2013-02-02T00:30:56.333
> 
> 标签：jquery, ruby-on-rails, autocomplete, jquery-autocomplete, swiftype

问候我正在使用 Rails [swiftype.com](http://www.swiftype.com)的 Swiftype gem 我已经让它工作了，我可以将文档上传到他们的网站，并在我的网站上自动完成。

我遇到的问题是我正在搜索两种不同的文档类型，并希望将其显示在结果中。

我有两种类型的文档：类别和公司

当前我有这个显示：

```
Search:
  Category
  Category
  Company
  Category
  Company 
```

我希望它是这样的

```
Search:
  Category
  Category
  Category
  ---------
  Company
  Company 
```

甚至更好的是：

```
Search:
  Category    |  Company
  Category    |  Company
  Category    |  Company 
```

我正在使用默认的 Swifttype 自动完成 JS。

而页面上的JS是这样的：

```
$(function() {
          var customResultRenderFunction = function(ctx, data) {
            var withSections = [],
              noSections = [];

            $.each(data, function(docType, results) {
              $.each(results, function(idx, result) {
                if (result.sections && result.sections.length > 15) {
                  withSections.push(result);
                } else {
                  noSections.push(result);
                }
              });
            });

            var withSectionsList = $('<ul class="with_sections"></ul>'),
              noSectionsList = $('<ul class="no_sections"></ul>');

            $.each(withSections, function(idx, item) {
              ctx.registerResult($('<li class="result"><p>' + item['name'] + '</p></li>').appendTo(withSectionsList), item);
            });
            $.each(noSections, function(idx, item) {
              ctx.registerResult($('<li class="result"><p>' + item['name'] + '</p></li>').appendTo(noSectionsList), item);
            });
            if (withSections.length > 0) {
              withSectionsList.appendTo(ctx.list);
            }
            if (noSections.length > 0) {
              noSectionsList.appendTo(ctx.list);
            }
          };

          $('#st-search-input').swiftype({
            engineKey:  '<%= ENV['SWIFTYPE_ENGINE_KEY'] %>',
            resultRenderFunction: customResultRenderFunction,
            suggestionListType: 'div',
            resultListSelector: '.result',
            fetchFields: {page: ['url', 'name']}
          });
        });

</script> 
```

我怎样才能更好地显示这个，以分离文档类型？

# c - 在 C 中调用函数不产生函数

> ID：14657315
> 
> 赞同：0
> 
> 时间：2013-02-02T00:31:40.420
> 
> 标签：c, function, visual-studio-2012

我是 C 的新手，到目前为止它非常不同。不过，我正在尝试使用 scanf 和 switch 语句从主函数调用一个函数，但是我不相信我调用的函数正在运行。

```
int main(void)
{
    int Example_number = 0;
    bool Continue = true;
    char ch;

    while(Continue)
    {
        printf("Which example would you like to run?\n");
        scanf("%d",&Example_number);

        switch(Example_number)
        {
        default: printf("No such program exists.\n");
                 break;
        case 1:  void Various_test();
                 break;
        }

        printf("Would you like to test another?(Y/N)\n");
        scanf("\n%c",&ch);
        if(ch == 'Y' || ch == 'y')
        {
            NULL;
        }
        else
        {
            Continue = false;
        }
    }
}

void Various_test(void)
{
    int k = 2;
    printf("\n%d",k);
} 
```

如果输入为 1，我希望程序打印 2，但是 while 循环只是重复。

感谢您考虑这个问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-02T00:34:16.500

`void Various_test()`是函数的前向声明。叫它你真的只是想要`Various_test()`。您实际上可能需要前向声明（取决于您的编译选项）。在那种情况下放在`void Various_test();`上面`main`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-02T01:14:41.320

您可以执行以下两项操作之一：

在 main 开头添加函数声明，如下所示：

```
int main(void)
{
    void Various_test(void);
    ... 
```

或者，将Various_test 的函数定义移到main 之前，如下所示：

```
void Various_test(void)
{
    int k = 2;
    printf("\n%d",k);
}

int main(void)
{
    int Example_number = 0;
    ... 
```

无论您选择哪种方式都一样。正如您现在所拥有的那样，编译器不知道Various_test 函数。无论哪种方式都告诉编译器有一个名为Various_test的函数，这就是它的样子。

还有一件事，你在你的 switch 语句中调用了各种各样的测试错误：

```
case 1:  void Various_test(); 
```

应该：

```
case 1:  Various_test(); 
```

# c++ - CSV 格式不正确

> ID：14657316
> 
> 赞同：1
> 
> 时间：2013-02-02T00:31:44.037
> 
> 标签：c++, excel, qt, csv

我正在尝试将以下内容发布到 .csv 文件中。

```
 stream<<"DesiredV"<<'\t'<<" Charge V "<<'\t'<<" Charge Current "<<'\t'<<"Float Voltage"<<'\r\n'; 
```

但是，`\t`不会跳到下一列，`\r\n`也不会移动到下一行。我正在使用 excel 打开 .csv 并使用 Qt。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-02T00:33:50.447

.csv 文件（逗号分隔值）使用逗号`,`分隔列（[http://en.wikipedia.org/wiki/Comma-separated_values](http://en.wikipedia.org/wiki/Comma-separated_values)）

所以你应该将所有更改`'\t'`为`','`

你应该使用`"\r\n"`而不是`'\r\n'`. 将被编译器`'\r\n'`视为。`'\r'`

# haskell - Haskell 似乎在函数内部的函数调用中忽略了结束的 ')'

> ID：14657321
> 
> 赞同：0
> 
> 时间：2013-02-02T00:32:00.113
> 
> 标签：haskell, syntax, compiler-construction

我正在为有关 haskell 的课程做作业，我们正在构建一个解释器。第一组函数是评估变量，

```
evalE (Var x) s        = subEv (Map.lookup x s)
where subEv (Just a)   = a
      subEv (Nothing)  = (IntVal 0)
evalE (Val v) s       = v
evalE (Op o e1 e2) s  = (evalE e1 s) 'o' (evalE e2 s) 
```

因此，前两个版本工作正常，问题出在第三个 evalE 上，编译器`(evalE e1 s) 'o' (evalE e2 s)`一直`o`解释`(evalE e2 s)``(evalE e1 s)`

我不知道为什么它忽略了第一个右括号的存在，而且我是haskell的新手，所以我看不到该行中有任何语法错误。但无论如何，编译器不会编译并说 evalE 的参数太多，而且我很快就会失去耐心，因为它似乎没有任何问题。我完全错过了这里的东西吗？

在进一步测试中，在调用函数的 evalE 代码中的任何地方都会出现相同的问题（即使是非递归的函数似乎也忽略了 ')' ）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-02T00:36:48.323

我假设这`o`是一个有两个参数的函数，并且您想将其用作中缀运算符。然后你必须使用反引号而不是单引号（用于字符文字）。

尝试如下更改您的最后一个子句：

```
evalE (Op o e1 e2) s  = (evalE e1 s) `o` (evalE e2 s) 
```

总结：`foo 'f' bar`表示“`foo`以字符`'f'`和`bar`作为参数调用”，而`foo `f` bar`表示“应用于`f`和`foo`” `bar`。

所以编译器的行为是完全正确的。

# recursion - 计划中的斐波那契

> ID：14657325
> 
> 赞同：7
> 
> 时间：2013-02-02T00:32:11.890
> 
> 标签：recursion, scheme, racket, fibonacci

我试图理解 Scheme 中的递归，我很难为它做空运行，例如一个简单的斐波那契数问题。

有人可以为我分解添加发生的步骤吗？

```
(define (fib n)
  (if (<= n 2)
      1
      (+ (fib (- n 1)) (fib (- n 2))))) 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-02T01:05:18.420

如果您使用的是 Racket，如您的标签所示，那么您有一个内置的步进器。

在 DrRacket 中输入程序，点击右上角菜单中的 Step：

[![第一步](../Images/cd8ef804917dad6dd800d978e6b30e28.png)](https://i.stack.imgur.com/Ne9h1.png)

然后将打开一个步进窗口。单击 Step over and over，您可以遍历程序的执行过程。

[![一步步](../Images/c6983ddee9d171c6c8d4ebd386eb6d86.png)](https://i.stack.imgur.com/eAqHI.png)

如果您希望步骤数更易于管理，请选择一个小于 10 的数字来跟踪执行。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-03T14:26:17.037

在伪代码中，=> ( *1 1 2 3 5 ...* )。`fib(n) **=** n <= 2 **->** 1 **; else ->** fib(n-1) + fib(n-2)`

 *例如，`fib(5)`减少为：

```
fib(5)
fib(4) + fib(3)
(fib(3) + fib(2)) + fib(3)
((fib(2) + fib(1)) + fib(2)) + fib(3)
((1 + 1) + fib(2)) + fib(3)
(2 + fib(2)) + fib(3)
(2 + 1) + fib(3)
3 + fib(3)
3 + (fib(2) + fib(1))
3 + (1 + 1)
3 + 2
5 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2017-03-31T11:03:58.953

这是一个在新行中打印从 1 到 n 的斐波那契数列成员的代码。需要注意的是，它使用了两个非常简单的辅助函数。希望这可以帮助。

```
;Prints to the screen all the member up to the nth member in the fibonaci sequence (define (fibo n)
 (let ((i 1))
  (if (= n 1)
      (display 1)
      (fiboHelp i n))))

;Helper function that presents Fibonaci sequence from bottom index i until upper index n
(define (fiboHelp i n)
  (if (= i n)
      (display(fiboMember i))
      (begin
        (display (fiboMember i))
        (newline)
        (fiboHelp (+ i 1)n)))) 

;Returns the nth member of the Fibonaci sequence
(define (fiboMember n)
  (if (<= n 2)
      (+ 1 0)
      (+ (fiboMember(- n 1))(fiboMember(- n 2))))) 
```*

# ios - iOS：向 MKPolylineView 添加渐变层？

> ID：14657329
> 
> 赞同：1
> 
> 时间：2013-02-02T00:32:30.993
> 
> 标签：ios, mkmapview, mkoverlay

如何向 MKPolylineView 添加渐变？最初我尝试做

```
MKPolylineView *lineView = [[MKPolylineView alloc] initWithPolyline:overlay];
CAGradientLayer *gradient = [CAGradientLayer layer];
//.. configure gradient object
[lineView.layer insertSublayer:gradient atIndex:0]; 
```

但这在地图上什么也没显示（我在设置 strokeColor 属性时看到了这条线）。我需要做什么？

一般地图覆盖的教程讨论了在 MKOverlayView 中覆盖 drawMapRect 但我不确定在该函数中做什么以及将渐变添加到哪个图层。

# mysql - MySql Workbench：我的表不接受更新的数据。

> ID：14657335
> 
> 赞同：0
> 
> 时间：2013-02-02T00:33:13.700
> 
> 标签：mysql, mysql-workbench

我的桌子不接受我所做的更改。它接受对文本的更改，但不执行它。我更改了发送给新用户的自动电子邮件的内容，但是当电子邮件出现时，它是旧消息。

Alter Table 中的 PK 选项被选中，所以我不知道它可能是什么。有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T09:27:15.240

您在哪个平台上使用什么版本的 WB？如果尚未安装，请先尝试最新版本。应该有一个应用按钮，允许您实际发送更改。

# javascript - Javascript附加带有特殊字符的元素

> ID：14657339
> 
> 赞同：0
> 
> 时间：2013-02-02T00:33:43.373
> 
> 标签：javascript, html

我在 div 中附加了一些可能包含特殊字符 (UTF-8) 的 HTML 代码。

我正在这样做：

```
ad_status = '<span style="color:orange;"><strong>Para Aprovação</strong></span>';
$('#meus-anuncios').append(ad_status); 
```

我的 html 文件中已经有了 utf-8 的元数据。有什么我可以使用的想法吗？

# extjs - 尝试在 Sencha Touch 2 中更改 tabBar 图标背景颜色（使用 Sass）时出现编译错误

> ID：14657344
> 
> 赞同：0
> 
> 时间：2013-02-02T00:34:13.957
> 
> 标签：extjs, sencha-touch, sencha-touch-2, compass-sass

我使用 Sencha 命令为我生成了应用程序，现在正在使用他们的 Sass/Css 文档对其进行品牌化。您应该能够使用 Sencha mixin 来更改标签栏中默认图标的 bg 颜色：

```
@include mask-by-background($bg-color, $contrast, $style); 
```

但是，无论我使用什么变量和值的组合，我总是得到编译错误“错误 app.scss（_gradients.scss 的第 38 行：属性只允许在规则、指令、mixin 包含或其他属性中使用。）”我我正在使用 Sencha Touch、SDK 和 Sencha 命令的最新版本。

以下是我迄今为止尝试过的一些方法：

```
$bg-color: #f2f2f2;
@include mask-by-background($bg-color, 80%, 'matte');

$bg-color: #f2f2f2;
@include mask-by-background($bg-color, $contrast: 80%, 'matte');

$bg-color: #f2f2f2;
@include mask-by-background($bg-color, $contrast: 80%, $style:'matte'); 
```

我什至尝试过：

```
$bg-color: #f2f2f2;
$contrast: 80%;
@include mask-by-background($bg-color, $contrast, 'matte'); 
```

我正在尝试使用指南针来更改 CSS，而不必编写像“.x-tabbar-red.x-doked-bottom .x-tab-active .x-button-icon”这样的巨大规则来覆盖样式。有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T06:50:48.517

这是我一直用来改变标签面板和相应图片的背景。

```
$base-color: #fff;
$active-color: #08ae2d;

$base-gradient: 'glossy';
$tabs-dark: darken($base-color, 80%);
$tabs-dark-active-color: saturate($active-color, 20%);
$tabs-bottom-active-gradient: 'recessed'; 
```

这是我的深色主题，您肯定会根据需要更改颜色级别。有关与 tabBar 相关的 css mixins 的更多信息，您可以参考[链接](https://github.com/nelstrom/compass-sencha-touch/blob/master/stylesheets/sencha-touch/default/widgets/_tabs.scss)

# android - Android 2.3 Stock Browser：内联块未在“orientationchange”事件上扩展

> ID：14657349
> 
> 赞同：2
> 
> 时间：2013-02-02T00:35:31.577
> 
> 标签：android, jquery, html, css

当涉及到 android 2.3 上的方向更改时，我的网站目前有一个有趣的问题。它仅适用于移动设备，对 Android 2.3+ 股票浏览器提供必要的支持。见下文..

HTML：

```
<div id="wrapper">
    <div id="parent">
        <div id="child">
        </div>
    </div>
</div> 
```

CSS：

```
#wrapper
    {
    text-align: center;
    }
#parent
    {
    display: inline-block;
    text-align; left;
    }

.dummy
    {
    display: block;
    height: 0;
    } 
```

查询：

```
$(window).resize(function () {
        clearTimeout(resizeTimeout);

        resizeTimeout = setTimeout(function(){
            $("#parent > .dummy").remove();

            var currentOffset = $("#parent > #child:first-child").offset().top;

            $("#parent > #child").each(function() {
                if (currentOffset != $(this).offset().top)
                    {
                    $("<div class=\"dummy\"></div>").insertBefore(this);
                    currentOffset = $(this).prev().offset().top; 
                    }
            });

        }, 500);
});

$(window).bind("orientationchange", function() {
        $(window).resize();
}); 
```

基本上，上面的代码父级拥有一堆`inline-block`div。包装器将父级居中，并且任何包装到父级离子的下一行的子 div 左对齐。这按预期工作。

我在这个设置中面临的问题是，当一个孩子换行到下一行时，父母的右手边有大量的空白。

我编写了首先查看每个子 div 的 jquery 函数。当它检测到一个孩子已经换行时，它会`<div class="dummy"></div>`在自己之前添加一个元素，这基本上会创建一个“换行符”。这将删除父项右侧的空白区域，从而将父项重新定位到视图的中心。这个函数在 " `orientationchange`" 事件上被调用，删除之前找到的任何虚拟 div。

现在我的问题 - 在 Android 2.3 浏览器上，从纵向模式切换到横向模式不会将父级的宽度扩大到超出纵向模式的宽度。显然，如果我第一次以横向模式加载页面，它会正确呈现，但第二次我切换到纵向，然后再回到横向，问题又回来了。

对不起，这很长，但我真的很想找到一个解决方案，并且尝试了很多事情，甚至将父级的最大宽度设置为一些硬编码的大值，但没有骰子。

提前感谢大家的帮助！

# c++ - 我不知道 C++ 在构造函数中的构造

> ID：14657351
> 
> 赞同：-1
> 
> 时间：2013-02-02T00:35:52.637
> 
> 标签：c++, constructor

> **可能重复：**
> [构造函数中这个奇怪的冒号成员语法是什么？](https://stackoverflow.com/questions/1711990/what-is-this-weird-colon-member-syntax-in-the-constructor)

这是代码的草图。我不明白这一行 - `Queue():first(0), last(0){}`。什么`first(0)`意思。我知道并理解队列的概念。我已经编码了很多次，但不知道这在 c++ 中意味着什么。

```
class Queue{
 struct Element{
    double val;
    Element* next;
 }*first, *last;

 void insert(double x);
 void get(double &x);
public:
    Queue():first(0), last(0){}

}; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-02T00:38:55.727

它是一个[初始化列表](http://www.cprogramming.com/tutorial/initialization-lists-c++.html)。它允许您直接使用要为其分配的值构造成员变量，而不是默认构造它们，*然后*在构造函数的主体中分配它们。

假设您有一个`A`具有默认构造函数的类和一个接受一个参数的构造函数：

```
struct A
{
    A() : n(0) { } // For scalar types, n = 0 in the constructor's body is equivalent
    A(int n) : n(a) { } // Should be marked as "explicit", but not relevant here
    int a;
}; 
```

和一个`X`具有类型成员变量的类`A`。的构造函数`X`接受一个类型的参数，该参数`int`需要分配给`A`的变量`a`。如果没有初始化列表，你会这样做：

```
struct X
{
    X(int n) { a.a = n; } // First invoke A::A(), then assign n to a.a
    A a;
}; 
```

但是这里有**两条**指令而不是一条指令：成员变量的（可能很昂贵）默认构造`a`，然后是根据需要更改其状态的赋值。如果您已经知道`a`应该构造的参数，那么首先执行默认构造只是为了覆盖该初始化是没有意义的。

但是，必须说，在初始化*标量类型*时（就像您的示例一样），基于初始化列表的形式等同于基于构造函数主体中的常规赋值的形式，因为标量类型*不是*零初始化的默认情况下（更准确地说，它们不会以任何方式初始化）。

* * *

作为相关信息，在初始化列表中，构造函数参数的名称不会隐藏您要构造的成员变量的名称：

```
struct X
{
    X(int a) : a(a) { } // OK (although I do not like it)
    int a;
}; 
```

相反，在常规赋值中，`a`将被视为赋值两侧的构造函数参数：

```
struct X
{
    X(int a) { a = a; } // Self-assignment of the constructor's argument...
    int a;
}; 
```

这就是说，我不认为对成员变量和函数参数使用相同的名称是一种好习惯。我之所以提到它，是因为如果您必须阅读其他人编写的代码，那么了解这一点是件好事。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-02T00:37:45.463

这是一个成员初始化列表。该行`Queue():first(0), last(0){}`定义了一个默认构造函数，用于`Queue`将`first`and`last`成员初始化为 0，然后什么也不做。

成员`first`和`last`都是类型`Element*`（“指针`Element`”）并且`0`是空指针常量。`0`当用,`first`和初始化时`last`是空指针。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-02T00:49:52.040

在这种特殊情况下，由于我们处理的是标量类型，它相当于：

```
Queue()
{
    first = 0;
    last = 0;
} 
```

# c# - 在 ViewModel 中使用 2 个实体的 MVC 4 和 LINQ 查询

> ID：14657359
> 
> 赞同：1
> 
> 时间：2013-02-02T00:36:54.067
> 
> 标签：c#, asp.net-mvc, linq, entity-framework

我正在尝试创建一个使用来自 2 个独立实体的数据的 ViewModel。我希望我的 ViewModel 显示来自 Game 类的所有数据，并从 Developer 模型附加相应的 developerName 值。

我正在使用来自游戏类的数据填充模型变量，并尝试通过调用一个辅助方法来包含开发人员的姓名，该方法在提供 ID 时输出开发人员的姓名。

这当然行不通，LINQ 查询将失败并出现 NotSupportedException 说明：

```
LINQ to Entities does not recognize the method 'System.String GetDeveloperNameFromId(Int32)' method, and this method cannot be translated into a store expression. 
```

这是当前的尝试：

游戏控制器.cs

```
 var model = _db.Games
                .OrderByDescending(r => r.Name)
                .Select(r=> new GameViewModel
                    {
                        Id = r.Id,
                        Name = r.Name,
                        Rating = r.Rating,
                        ReleaseDate = r.ReleaseDate,
                        Type = r.Type,
                        DeveloperId = r.DeveloperId,
                        DeveloperName = GetDeveloperNameFromId(r.DeveloperId)       
                    })
.Where(r => searchTerm == null || r.Name.StartsWith(searchTerm));

        private string GetDeveloperNameFromId(int id)
        {
            var _model = _db.Developers.FirstOrDefault(r => r.Id.Equals(id));
            string _name = _model.Name;
            return _name;
        } 
```

游戏视图模型.cs

```
public class GameViewModel
{
    public int Id { get; set; }
    public string Name { get; set; }
    public string Rating { get; set; }
    public DateTime ReleaseDate { get; set; }
    public string Type { get; set; }
    public string DeveloperName { get; set; }
    public int DeveloperId { get; set; }
} 
```

游戏.cs

```
public class Game
{
    public int Id { get; set; }
    public string Name { get; set; }
    public string Rating { get; set; }
    public DateTime ReleaseDate { get; set; }
    public string Type { get; set; }

    [Display(Name = "Developer")]
    public int DeveloperId { get; set; }
} 
```

我确定有更好的方法来添加开发人员姓名，可能是使用连接 LINQ 查询，或者可能修改模型变量的范围以包含多个实体？

更好的是在 ViewModel 中自动填充 DeveloperName 字段，这可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T00:45:20.677

也许最好对 Linq 查询使用延迟执行。也许调用 ToList() 方法然后创建 GameViewModel 对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T11:49:47.890

我在阅读 Martins 的评论后解决了这个问题，我添加了一个对 game.cs 实体的外键引用，它允许访问相关的开发人员数据。

游戏控制器.cs

```
DeveloperName = r.Developer.Name 
```

游戏.cs

```
public int DeveloperId { get; set; }

[ForeignKey("DeveloperId")]
public Developer Developer { get; set; } 
```

# c# - NaoQi 和 Leap 问题：“System.BadImageFormatException”类型的未处理异常......并且无法加载文件或程序集

> ID：14657361
> 
> 赞同：14
> 
> 时间：2013-02-02T00:37:22.083
> 
> 标签：c#, visual-studio-2012, visual-studio-debugging, nao-robot

目前，我遇到了一个我无法通过谷歌解决方案解决的问题。到目前为止没有任何效果。当我编译 Leap Motion 代码并导入 Naoqi C# 库时，它工作正常。当我实际尝试使用一行代码连接到机器人时，我的程序崩溃了。我的程序设置为为任何 CPU 构建。Leap 库和 NaoQi 库都引用了 .dll，并将 .dll 放置在 debug 文件夹和 project 文件夹中以便更好地衡量。我现在还不知道问题出在哪里。

这里有人可以弄清楚吗？我会很高兴得到这个工作。

这是第一条错误消息，然后它要求我中断或继续：

```
An unhandled exception of type 'System.BadImageFormatException' occurred in LeapCSharp.NET4.0.dll

Additional information: Could not load file or assembly 'naoqi-dotnet4, Version=1.14.0.218, Culture=neutral, PublicKeyToken=b9b4e24bd78100d6' or one of its dependencies. An attempt was made to load a program with an incorrect format. 
```

无论哪种方式，程序都会崩溃。这是此时控制台日志中的文本：

```
'NaoLeap.vshost.exe' (Managed (v4.0.30319)): Loaded 'C:\WINDOWS\Microsoft.Net\assembly\GAC_64\mscorlib\v4.0_4.0.0.0__b77a5c561934e089\mscorlib.dll'
'NaoLeap.vshost.exe' (Managed (v4.0.30319)): Loaded 'C:\WINDOWS\assembly\GAC_MSIL\Microsoft.VisualStudio.HostingProcess.Utilities\11.0.0.0__b03f5f7f11d50a3a\Microsoft.VisualStudio.HostingProcess.Utilities.dll'
'NaoLeap.vshost.exe' (Managed (v4.0.30319)): Loaded 'C:\WINDOWS\Microsoft.Net\assembly\GAC_MSIL\System.Windows.Forms\v4.0_4.0.0.0__b77a5c561934e089\System.Windows.Forms.dll'
'NaoLeap.vshost.exe' (Managed (v4.0.30319)): Loaded 'C:\WINDOWS\assembly\GAC_MSIL\Microsoft.VisualStudio.HostingProcess.Utilities.Sync\11.0.0.0__b03f5f7f11d50a3a\Microsoft.VisualStudio.HostingProcess.Utilities.Sync.dll'
'NaoLeap.vshost.exe' (Managed (v4.0.30319)): Loaded 'C:\WINDOWS\Microsoft.Net\assembly\GAC_MSIL\System\v4.0_4.0.0.0__b77a5c561934e089\System.dll'
'NaoLeap.vshost.exe' (Managed (v4.0.30319)): Loaded 'C:\WINDOWS\assembly\GAC_MSIL\Microsoft.VisualStudio.Debugger.Runtime\11.0.0.0__b03f5f7f11d50a3a\Microsoft.VisualStudio.Debugger.Runtime.dll'
'NaoLeap.vshost.exe' (Managed (v4.0.30319)): Loaded 'C:\Users\Grace\Documents\Visual Studio 2012\Projects\NaoLeap\NaoLeap\bin\Debug\NaoLeap.vshost.exe'
'NaoLeap.vshost.exe' (Managed (v4.0.30319)): Loaded 'C:\WINDOWS\Microsoft.Net\assembly\GAC_MSIL\System.Core\v4.0_4.0.0.0__b77a5c561934e089\System.Core.dll'
'NaoLeap.vshost.exe' (Managed (v4.0.30319)): Loaded 'C:\WINDOWS\Microsoft.Net\assembly\GAC_MSIL\System.Xml.Linq\v4.0_4.0.0.0__b77a5c561934e089\System.Xml.Linq.dll'
'NaoLeap.vshost.exe' (Managed (v4.0.30319)): Loaded 'C:\WINDOWS\Microsoft.Net\assembly\GAC_MSIL\System.Data.DataSetExtensions\v4.0_4.0.0.0__b77a5c561934e089\System.Data.DataSetExtensions.dll'
'NaoLeap.vshost.exe' (Managed (v4.0.30319)): Loaded 'C:\WINDOWS\Microsoft.Net\assembly\GAC_MSIL\Microsoft.CSharp\v4.0_4.0.0.0__b03f5f7f11d50a3a\Microsoft.CSharp.dll'
'NaoLeap.vshost.exe' (Managed (v4.0.30319)): Loaded 'C:\WINDOWS\Microsoft.Net\assembly\GAC_64\System.Data\v4.0_4.0.0.0__b77a5c561934e089\System.Data.dll'
'NaoLeap.vshost.exe' (Managed (v4.0.30319)): Loaded 'C:\WINDOWS\Microsoft.Net\assembly\GAC_MSIL\System.Xml\v4.0_4.0.0.0__b77a5c561934e089\System.Xml.dll'
The thread 'vshost.NotifyLoad' (0x440) has exited with code 0 (0x0).
The thread '<No Name>' (0x1914) has exited with code 0 (0x0).
The thread '<No Name>' (0xa90) has exited with code 0 (0x0).
The thread 'vshost.LoadReference' (0x1a08) has exited with code 0 (0x0).
'NaoLeap.vshost.exe' (Managed (v4.0.30319)): Loaded 'C:\Users\Grace\documents\visual studio 2012\Projects\NaoLeap\NaoLeap\bin\Debug\NaoLeap.exe', Symbols loaded.
'NaoLeap.vshost.exe' (Managed (v4.0.30319)): Loaded 'C:\WINDOWS\Microsoft.Net\assembly\GAC_MSIL\System.Drawing\v4.0_4.0.0.0__b03f5f7f11d50a3a\System.Drawing.dll'
'NaoLeap.vshost.exe' (Managed (v4.0.30319)): Loaded 'C:\WINDOWS\Microsoft.Net\assembly\GAC_MSIL\Accessibility\v4.0_4.0.0.0__b03f5f7f11d50a3a\Accessibility.dll'
'NaoLeap.vshost.exe' (Managed (v4.0.30319)): Loaded 'C:\Users\Grace\documents\visual studio 2012\Projects\NaoLeap\NaoLeap\bin\Debug\LeapCSharp.NET4.0.dll'
A first chance exception of type 'System.BadImageFormatException' occurred in LeapCSharp.NET4.0.dll
An unhandled exception of type 'System.BadImageFormatException' occurred in LeapCSharp.NET4.0.dll
Additional information: Could not load file or assembly 'naoqi-dotnet4, Version=1.14.0.218, Culture=neutral, PublicKeyToken=b9b4e24bd78100d6' or one of its dependencies. An attempt was made to load a program with an incorrect format.
'NaoLeap.vshost.exe' (Managed (v4.0.30319)): Loaded 'C:\WINDOWS\Microsoft.Net\assembly\GAC_MSIL\System.Configuration\v4.0_4.0.0.0__b03f5f7f11d50a3a\System.Configuration.dll'
The program '[3484] NaoLeap.vshost.exe: Managed (v4.0.30319)' has exited with code 0 (0x0).
The program '[3484] NaoLeap.vshost.exe: Program Trace' has exited with code 0 (0x0). 
```

我尝试使用 fuslogvw。这是程序崩溃后刷新 fuslogvw 时失败程序集的两个日志报告。

1)

```
<meta http-equiv="Content-Type" content="charset=unicode-1-1-utf-8"><!-- saved from url=(0015)assemblybinder: --><html><pre>
*** Assembly Binder Log Entry  (2/1/2013 @ 7:24:49 PM) ***

The operation was successful.
Bind result: hr = 0x0\. The operation completed successfully.

Assembly manager loaded from:  C:\Windows\Microsoft.NET\Framework64\v4.0.30319\clr.dll
Running under executable  C:\Users\Grace\Documents\Visual Studio 2012\Projects\NaoLeap\NaoLeap\bin\Debug\NaoLeap.vshost.exe
--- A detailed error log follows. 

=== Pre-bind state information ===
LOG: User = Grace-PC\Grace
LOG: DisplayName = Accessibility, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a
 (Fully-specified)
LOG: Appbase = file:///C:/Users/Grace/documents/visual studio 2012/Projects/NaoLeap/NaoLeap/bin/Debug/
LOG: Initial PrivatePath = NULL
LOG: Dynamic Base = NULL
LOG: Cache Base = NULL
LOG: AppName = NaoLeap.vshost.exe
Calling assembly : System.Windows.Forms, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089.
===
LOG: Start validating all the dependencies.
LOG: [Level 1]Start validating native image dependency mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089.
WRN: No matching native image found.

</pre></html> 
```

2)

```
<meta http-equiv="Content-Type" content="charset=unicode-1-1-utf-8"><!-- saved from url=(0015)assemblybinder: --><html><pre>
*** Assembly Binder Log Entry  (2/1/2013 @ 7:24:50 PM) ***

The operation was successful.
Bind result: hr = 0x0\. The operation completed successfully.

Assembly manager loaded from:  C:\Windows\Microsoft.NET\Framework64\v4.0.30319\clr.dll
Running under executable  C:\Users\Grace\Documents\Visual Studio 2012\Projects\NaoLeap\NaoLeap\bin\Debug\NaoLeap.vshost.exe
--- A detailed error log follows.
=== Pre-bind state information ===
LOG: User = Grace-PC\Grace
LOG: Where-ref bind. Location = C:\Users\Grace\Documents\Visual Studio 2012\Projects\NaoLeap\NaoLeap\bin\Debug\NaoLeap.exe
LOG: Appbase = file:///C:/Users/Grace/documents/visual studio 2012/Projects/NaoLeap/NaoLeap/bin/Debug/
LOG: Initial PrivatePath = NULL
LOG: Dynamic Base = NULL
LOG: Cache Base = NULL
LOG: AppName = NaoLeap.vshost.exe
Calling assembly : (Unknown).
===
WRN: Native image will not be probed in LoadFrom context. Native image will only be probed in default load context, like with Assembly.Load().

</pre></html> 
```

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2013-02-02T01:31:06.343

> 无法加载文件或程序集 'naoqi-dotnet4

从[供应商的文档](http://www.aldebaran-robotics.com/documentation/dev/dotnet/index.html)中可以清楚地看出，NAO 包含本机 C++ 代码，并且必须针对 x86（32 位代码）构建它。但是，您正在以 64 位模式运行主 EXE。BadImageFormatException 是结果，64 位进程无法加载包含 32 位本机代码的程序集。

右键单击您的 EXE 项目，属性，构建选项卡。将平台目标更改为“x86”。

# extjs - ext.js 组合框如何阻止它向我的查询字符串附加内容？

> ID：14657362
> 
> 赞同：0
> 
> 时间：2013-02-02T00:37:23.840
> 
> 标签：extjs

我正在使用 ext.js 组合框，我想完全控制查询字符串，它已经动态生成。但是，ext.js 会自动在字符串中附加一些内容，例如 &query=leaf%20&page=1&start=0&limit=25。如果某些参数无法识别，我正在使用的服务器将失败。有没有办法关闭它？谢谢，

# cuda - 计算 Nvidia GPU 卡的 GFLOPS 时假设每个内核有多少线程？

> ID：14657365
> 
> 赞同：1
> 
> 时间：2013-02-02T00:37:34.267
> 
> 标签：cuda, gpu, nvidia

我有兴趣获得在 GeForce GTX 550 Ti 上执行 1 个双精度 FLOP 所需的纳秒数。

为了做到这一点，我采用了这种方法：我发现卡的单精度峰值性能为 691.2 GFLOPS，这意味着双精度峰值性能将是它的 1/8，即 86.4 GFLOPS。然后为了获得每个核心的 FLOPS，我将 86.4 GFLOPS 除以核心数量 192，得到每个核心 0.45 GFLOPS。0.45 GFLOPS 意味着每个内核每纳秒 0.45 FLOPS。如果我遵循正确的方法，那么我想知道每个内核运行了多少线程来获取这些 GFLOPS 数字，我在哪里可以找到这些信息？

此外，下面显示的我的小测试仅由一个线程执行 236000232 个周期。为了找到执行 1 次循环迭代所需的时间（以纳秒为单位），我做了 236000232/10^6 = 236 个周期。该卡的着色器时钟为 1800Mhz，这意味着执行一次循环需要 236/1.8 = 131 纳秒。这个数字比上面的数字大得多（每个内核 0.45 纳秒）。我确信我在这里遗漏了一些东西，因为数字非常不同。请帮助我理解它背后的数学原理。

```
 __global__ void bench_single(float *data)
{
    int i;
    double x = 1.;
    clock_t start, end;
    start = clock();
    for(i=0; i<1000000; i++)
    {
        x = x * 2.388415813 + 1.253314137;
    }
    end = clock();
    printf("End and start %d - %d\n", end, start);
    printf("Finished in %d cycles\n", end-start);
} 
```

谢谢，

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-02T04:46:16.657

计算能力 2.1 设备的双精度吞吐量为每个周期 4 次操作（如果执行 DFMA，则为 8 次）。这假设所有 32 个线程在分派的 warp 中都处于活动状态。

4 ops/cycle/SM * 4 SMs * 1800 MHz * 2 ops/DFMA = 56 GFLOPS 双倍

该计算假定经线中的所有线程都处于活动状态。

您问题中的代码包含两个可以融合到 DFMA 中的相关操作。使用 cuobjdump -sass 检查程序集。如果您在同一个 SM 上启动多个 warp，则测试会变成对相关指令吞吐量而不是延迟的衡量。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-02T07:52:35.160

您应该意识到内核设计存在问题，这意味着您使用此代码进行的任何测量都与双精度指令吞吐量绝对没有关系。

因为包含所有双精度操作的计算循环的结果没有用于内存写入，所以编译器优化会将其删除。CUDA 5 编译器为您的内核发出以下 PTX：

```
.visible .entry _Z12bench_singlePf(
    .param .u32 _Z12bench_singlePf_param_0
)
{
    .local .align 8 .b8     __local_depot0[8];
    .reg .b32   %SP;
    .reg .b32   %SPL;
    .reg .s32   %r<16>;

    mov.u32     %SPL, __local_depot0;
    cvta.local.u32  %SP, %SPL;
    add.u32     %r3, %SP, 0;
    .loc 2 13 1
    cvta.to.local.u32   %r4, %r3;
    // inline asm
    mov.u32     %r1, %clock;
    // inline asm
    // inline asm
    mov.u32     %r2, %clock;
    // inline asm
    st.local.v2.u32     [%r4], {%r2, %r1};
    cvta.const.u32  %r5, $str;
    // Callseq Start 0
    {
    .reg .b32 temp_param_reg;
    .param .b32 param0;
    st.param.b32    [param0+0], %r5;
    .param .b32 param1;
    st.param.b32    [param1+0], %r3;
    .param .b32 retval0;
    .loc 2 13 1
    call.uni (retval0), 
    vprintf, 
    (
    param0, 
    param1
    );
    ld.param.b32    %r6, [retval0+0];
    }
    // Callseq End 0
    .loc 2 14 1
    sub.s32     %r7, %r2, %r1;
    cvta.const.u32  %r8, $str1;
    st.local.u32    [%r4], %r7;
    // Callseq Start 1
    {
    .reg .b32 temp_param_reg;
    .param .b32 param0;
    st.param.b32    [param0+0], %r8;
    .param .b32 param1;
    st.param.b32    [param1+0], %r3;
    .param .b32 retval0;
    .loc 2 14 1
    call.uni (retval0), 
    vprintf, 
    (
    param0, 
    param1
    );
    ld.param.b32    %r9, [retval0+0];
    }
    // Callseq End 1
    .loc 2 15 2
    ret;
} 
```

两条时钟加载指令是相邻的，唯一的其他代码是调用`printf`. 该 PTX 中没有计算循环。

您应该重新设计内核，以便编译器无法推断出循环结果未使用并对其进行优化。一种方法是这样的：

```
__global__ 
void bench_single(float *data, int flag=0)
{
    int i;
    double x = 1.;
    clock_t start, end;
    start = clock();
    for(i=0; i<1000000; i++) {
        x = x * 2.388415813 + 1.253314137;
    }
    end = clock();
    printf("End and start %d - %d\n", end, start);
    printf("Finished in %d cycles\n", end-start);

    if (flag) {
        data[blockIdx.x] = x;
    }
} 
```

内核末尾的条件写入阻止了编译器优化循环，所以现在编译器发出这个 PTX：

```
.visible .entry _Z12bench_singlePfi(
    .param .u32 _Z12bench_singlePfi_param_0,
    .param .u32 _Z12bench_singlePfi_param_1
)
{
    .local .align 8 .b8     __local_depot0[8];
    .reg .b32   %SP;
    .reg .b32   %SPL;
    .reg .pred  %p<3>;
    .reg .f32   %f<2>;
    .reg .s32   %r<28>;
    .reg .f64   %fd<44>;

    mov.u32     %SPL, __local_depot0;
    cvta.local.u32  %SP, %SPL;
    ld.param.u32    %r6, [_Z12bench_singlePfi_param_0];
    ld.param.u32    %r7, [_Z12bench_singlePfi_param_1];
    add.u32     %r10, %SP, 0;
    .loc 2 13 1
    cvta.to.local.u32   %r1, %r10;
    // inline asm
    mov.u32     %r8, %clock;
    // inline asm
    mov.f64     %fd43, 0d3FF0000000000000;
    mov.u32     %r27, 1000000;

BB0_1:
    .loc 2 10 1
    fma.rn.f64  %fd4, %fd43, 0d40031B79BFF0AC8C, 0d3FF40D931FE078AF;
    fma.rn.f64  %fd5, %fd4, 0d40031B79BFF0AC8C, 0d3FF40D931FE078AF;
    fma.rn.f64  %fd6, %fd5, 0d40031B79BFF0AC8C, 0d3FF40D931FE078AF;
    fma.rn.f64  %fd7, %fd6, 0d40031B79BFF0AC8C, 0d3FF40D931FE078AF;
    fma.rn.f64  %fd8, %fd7, 0d40031B79BFF0AC8C, 0d3FF40D931FE078AF;
    fma.rn.f64  %fd9, %fd8, 0d40031B79BFF0AC8C, 0d3FF40D931FE078AF;
    fma.rn.f64  %fd10, %fd9, 0d40031B79BFF0AC8C, 0d3FF40D931FE078AF;
    fma.rn.f64  %fd11, %fd10, 0d40031B79BFF0AC8C, 0d3FF40D931FE078AF;
    fma.rn.f64  %fd12, %fd11, 0d40031B79BFF0AC8C, 0d3FF40D931FE078AF;
    fma.rn.f64  %fd13, %fd12, 0d40031B79BFF0AC8C, 0d3FF40D931FE078AF;
    fma.rn.f64  %fd14, %fd13, 0d40031B79BFF0AC8C, 0d3FF40D931FE078AF;
    fma.rn.f64  %fd15, %fd14, 0d40031B79BFF0AC8C, 0d3FF40D931FE078AF;
    fma.rn.f64  %fd16, %fd15, 0d40031B79BFF0AC8C, 0d3FF40D931FE078AF;
    fma.rn.f64  %fd17, %fd16, 0d40031B79BFF0AC8C, 0d3FF40D931FE078AF;
    fma.rn.f64  %fd18, %fd17, 0d40031B79BFF0AC8C, 0d3FF40D931FE078AF;
    fma.rn.f64  %fd19, %fd18, 0d40031B79BFF0AC8C, 0d3FF40D931FE078AF;
    fma.rn.f64  %fd20, %fd19, 0d40031B79BFF0AC8C, 0d3FF40D931FE078AF;
    fma.rn.f64  %fd21, %fd20, 0d40031B79BFF0AC8C, 0d3FF40D931FE078AF;
    fma.rn.f64  %fd22, %fd21, 0d40031B79BFF0AC8C, 0d3FF40D931FE078AF;
    fma.rn.f64  %fd23, %fd22, 0d40031B79BFF0AC8C, 0d3FF40D931FE078AF;
    fma.rn.f64  %fd24, %fd23, 0d40031B79BFF0AC8C, 0d3FF40D931FE078AF;
    fma.rn.f64  %fd25, %fd24, 0d40031B79BFF0AC8C, 0d3FF40D931FE078AF;
    fma.rn.f64  %fd26, %fd25, 0d40031B79BFF0AC8C, 0d3FF40D931FE078AF;
    fma.rn.f64  %fd27, %fd26, 0d40031B79BFF0AC8C, 0d3FF40D931FE078AF;
    fma.rn.f64  %fd28, %fd27, 0d40031B79BFF0AC8C, 0d3FF40D931FE078AF;
    fma.rn.f64  %fd29, %fd28, 0d40031B79BFF0AC8C, 0d3FF40D931FE078AF;
    fma.rn.f64  %fd30, %fd29, 0d40031B79BFF0AC8C, 0d3FF40D931FE078AF;
    fma.rn.f64  %fd31, %fd30, 0d40031B79BFF0AC8C, 0d3FF40D931FE078AF;
    fma.rn.f64  %fd32, %fd31, 0d40031B79BFF0AC8C, 0d3FF40D931FE078AF;
    fma.rn.f64  %fd33, %fd32, 0d40031B79BFF0AC8C, 0d3FF40D931FE078AF;
    fma.rn.f64  %fd34, %fd33, 0d40031B79BFF0AC8C, 0d3FF40D931FE078AF;
    fma.rn.f64  %fd35, %fd34, 0d40031B79BFF0AC8C, 0d3FF40D931FE078AF;
    fma.rn.f64  %fd36, %fd35, 0d40031B79BFF0AC8C, 0d3FF40D931FE078AF;
    fma.rn.f64  %fd37, %fd36, 0d40031B79BFF0AC8C, 0d3FF40D931FE078AF;
    fma.rn.f64  %fd38, %fd37, 0d40031B79BFF0AC8C, 0d3FF40D931FE078AF;
    fma.rn.f64  %fd39, %fd38, 0d40031B79BFF0AC8C, 0d3FF40D931FE078AF;
    fma.rn.f64  %fd40, %fd39, 0d40031B79BFF0AC8C, 0d3FF40D931FE078AF;
    fma.rn.f64  %fd41, %fd40, 0d40031B79BFF0AC8C, 0d3FF40D931FE078AF;
    fma.rn.f64  %fd42, %fd41, 0d40031B79BFF0AC8C, 0d3FF40D931FE078AF;
    fma.rn.f64  %fd43, %fd42, 0d40031B79BFF0AC8C, 0d3FF40D931FE078AF;
    .loc 2 9 1
    add.s32     %r27, %r27, -40;
    setp.ne.s32     %p1, %r27, 0;
    @%p1 bra    BB0_1;

    cvta.to.global.u32  %r5, %r6;
    // inline asm
    mov.u32     %r11, %clock;
    // inline asm
    .loc 2 13 1
    st.local.v2.u32     [%r1], {%r11, %r8};
    cvta.const.u32  %r12, $str;
    // Callseq Start 0
    {
    .reg .b32 temp_param_reg;
    .param .b32 param0;
    st.param.b32    [param0+0], %r12;
    .param .b32 param1;
    st.param.b32    [param1+0], %r10;
    .param .b32 retval0;
    .loc 2 13 1
    call.uni (retval0), 
    vprintf, 
    (
    param0, 
    param1
    );
    ld.param.b32    %r14, [retval0+0];
    }
    // Callseq End 0
    .loc 2 14 1
    sub.s32     %r15, %r11, %r8;
    cvta.const.u32  %r16, $str1;
    st.local.u32    [%r1], %r15;
    // Callseq Start 1
    {
    .reg .b32 temp_param_reg;
    .param .b32 param0;
    st.param.b32    [param0+0], %r16;
    .param .b32 param1;
    st.param.b32    [param1+0], %r10;
    .param .b32 retval0;
    .loc 2 14 1
    call.uni (retval0), 
    vprintf, 
    (
    param0, 
    param1
    );
    ld.param.b32    %r17, [retval0+0];
    }
    // Callseq End 1
    .loc 2 16 1
    setp.eq.s32     %p2, %r7, 0;
    @%p2 bra    BB0_4;

    .loc 2 17 1
    cvt.rn.f32.f64  %f1, %fd43;
    mov.u32     %r18, %ctaid.x;
    shl.b32     %r19, %r18, 2;
    add.s32     %r20, %r5, %r19;
    st.global.f32   [%r20], %f1;

BB0_4:
    .loc 2 19 2
    ret;
} 
```

请注意，现在有一个很好的浮点乘加指令流，来自编译器部分展开循环的地方。

正如 Greg Smith 指出的那样，除非您在给定的 SM 上运行足够的 warp 以克服指令调度延迟，否则您不应该期望获得指令吞吐量的真正度量。这可能意味着您将要运行至少一个大块。另请注意， printf 调用将对吞吐量产生很大的负面影响。如果每个块只有一个线程写出其结果，或者（更好）将其存储到全局内存中，您将获得更具代表性的数字。运行大量块，您将获得一些可以平均的测量值。作为最后的检查，您还应该使用反汇编目标代码`cudaobjdump`确保汇编器不会在时钟读取指令的位置附近移动，否则您所依赖的内核时序会中断。旧版本的汇编程序有指令重新排序的习惯，这可能会破坏插入内核 C 代码或 PTX 的一系列时钟读取的功能。

# javascript - 如何计算 css 样式的偏移量到 contenteditable 元素？

> ID：14657370
> 
> 赞同：1
> 
> 时间：2013-02-02T00:38:13.317
> 
> 标签：javascript, jquery, textarea

我有一个带有一些嵌套跨度的 contenteditable 元素，可以在其中提供样式。我需要找出在 elemebt 的任何给定偏移处的 css 类是什么。例如，我可能有这样的事情：

```
<div contenteditable>
     <span class"nothing">    </span>
     <span class="outer">my <span class="other">name</span> is </span><span class="name">Andrew</span>
</div> 
```

屏幕上的文本将如下所示（使用适当的样式）：

```
my name is Andrew 
```

现在，想象一下 contenteditable 区域可能更大，并且有许多嵌套的 span 元素。在任何给定的文本中给定一个偏移量，我需要能够计算包含它的 css 类。

例如，假设我需要偏移 4 处的 CSS 样式，`n`即`name`. 我希望结果是：

```
outer other 
```

一个等效的解决方案是，如果给定一个偏移量（例如`4`），我可以计算包装该位置的 html 元素（在这种情况下，它将是：

```
<span class="other">name</span> 
```

我正在使用 jquery，但没有其他库。我怎样才能轻松计算出这个？

* * *

编辑：我之前使用的是 textarea，但这不起作用。我应该使用 contenteditable div 元素。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T00:49:02.650

我建议插入一个临时的虚拟跨度，用 Jquery 抓取它，然后`parents`将类列表推到一个数组上，直到你碰到你的外部容器。当然，如果你只想要`currentStyle`，那就更容易了。

至于如何让你的虚拟跨度进入 textarea，如果你只有一个字符位置，请参阅[Insert text into textarea at cursor position (Javascript)](https://stackoverflow.com/questions/11076975/insert-text-into-textarea-at-cursor-position-javascript)。如果要在插入符号处*插入*，请参阅[使用 jQuery 将文本插入文本区域](https://stackoverflow.com/questions/946534/insert-text-into-textarea-with-jquery)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T01:04:43.087

你不能用 textarea 做到这一点。其中的任何内容都将被视为文本，而不是标记。您应该查看“contenteditable”元素。

# ruby-on-rails - Omniatuh 设计 Twitter 不将用户发送回站点

> ID：14657371
> 
> 赞同：0
> 
> 时间：2013-02-02T00:38:25.093
> 
> 标签：ruby-on-rails, ruby-on-rails-3, devise, omniauth

我正在关注 Ryan bates 演员 #225 设计和omniauth 修改......一旦我点击链接注册 twitter，它会将我带到

api.twitter.com/oauth/authenticate?oauth_token=vJQeSrxYa6gXSFUspRP9wuzgHTgGRDoN5YjenRGnDcU

页面上写着授权蝙蝠侠粉丝网站使用您的帐户？当我单击登录时，什么也没有发生，我没有被送回我的网站，显然没有让我登录或注册。

网址更改为[https://api.twitter.com/oauth/authenticate](https://api.twitter.com/oauth/authenticate)

但除此之外，现在几个小时都没有发生任何事情，并遵循了每一个可能的建议......

请帮忙

设计.rb

```
 config.omniauth :twitter, ENV["I PUT MY CONSUMER KEY HERE"], ENV["I PUT MY CONSUMER PASSWORD HERE"] 
```

我也有一个

全域认证.rb

```
 Rails.application.config.middleware.use OmniAuth::Builder do
             provider :twitter, 'I PUT MY CONSUMER KEY HERE', 'I PUT MY CONSUMER PASSWORD HERE'
         end 
```

我听说过一些建议，如果您删除omniauth.rb，它将起作用，因为它已经在您的devise.rb 中，但是如果我删除OMNIAUTH.RB，我会收到301 Unathorized 错误并且不会将我发送到推特登录页面... ...

如果我删除 devise.rb 中的一段代码（不是整个文件，只是 vonfig.omniauth 部分）并保留omniauth.rb，我会收到路由错误

这是我的

用户.rb

```
 class User < ActiveRecord::Base
     # Include default devise modules. Others available are:
     # :token_authenticatable, :confirmable,
     # :lockable, :timeoutable and :omniauthable
     devise :database_authenticatable, :registerable,
     :recoverable, :rememberable, :trackable, :validatable, :omniauthable

     # Setup accessible (or protected) attributes for your model
     attr_accessible :email, :password, :password_confirmation, :remember_me, :username

     validates_presence_of :username
     validates_uniqueness_of :username

     def self.from_omniauth(auth)
       where(auth.slice(:provider, :uid)).first_or_create do |user|
       user.provider = auth.provider
       user.uid = auth.uid
       user.username = auth.info.nickname
     end
    end

    def self.new_with_session(params, session)
      if session["devise.user_attributes"]
      new(session["devise.user_attributes"], without_protection: true) do |user|
      user.attributes = params
      user.valid?
    end
  else
  super
end
end

def password_required?
  super && provider.blank?
end

def update_with_password(params, *options)
  if encrypted_password.blank?
  update_attributes(params, *options)
else
  super
end
end
end 
```

我的omniauth_callbacks_controller.rb

```
 class OmniauthCallbacksController < Devise::OmniauthCallbacksController
 def all
   user = User.from_omniauth(request.env["omniauth.auth"])
   if user.persisted?
     flash.notice = "Signed in!"
    sign_in_and_redirect user
   else
     session["devise.user_attributes"] = user.attributes
    redirect_to new_user_registration_url
    end
   end
   alias_method :twitter, :all
  end 
```

路线.rb

```
 devise_for :users, path_names: {sign_in: "login", sign_out: "logout"}, 
          controllers: {omniauth_callbacks: "omniauth_callbacks"} 
```

在我的宝石文件中

```
gem 'omniauth-twitter', :github => 'arunagw/omniauth-twitter' 
```

我也尝试过添加omniauth gem，但没有做任何事情

在我看来，我有

```
 = link_to "Sign in with Twitter", user_omniauth_authorize_path(:twitter) 
```

在 twitter 开发者网站上，我注册了我的网站，添加了一个回调 url

我将应用程序类型设置为读写...我尝试了只读但这给了我一个 401 错误我也尝试了读写和访问 FIRECT MESSAGES 但没有任何效果

唯一将我发送到实际 twitter 登录页面的事情是，如果我检查 READ AND WRITE

如果有人有任何建议请帮助

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T08:00:39.300

您必须正确设置回调。如果您在开发中使用 localhost 那么您的回调应该是

```
http://localhost:3000/auth/twitter/callback 
```

您也可以使用 IP 地址而不是 localhost 即`127.0.0.1`

# python - Cython：“致命错误：numpy/arrayobject.h：没有这样的文件或目录”

> ID：14657375
> 
> 赞同：168
> 
> 时间：2013-02-02T00:38:35.740
> 
> 标签：python, windows-7, numpy, cython

我正在尝试使用 Cython加快[这里的答案。](https://stackoverflow.com/a/14469557/1658908)我尝试编译代码（在完成[此处](https://stackoverflow.com/questions/6034390/compiling-with-cython-and-mingw-produces-gcc-error-unrecognized-command-line-o/6035864#6035864)`cygwinccompiler.py`解释的 hack之后），但出现错误。谁能告诉我这是我的代码有问题，还是 Cython 有一些深奥的微妙之处？`fatal error: numpy/arrayobject.h: No such file or directory...compilation terminated`

下面是我的代码。

```
import numpy as np
import scipy as sp
cimport numpy as np
cimport cython

cdef inline np.ndarray[np.int, ndim=1] fbincount(np.ndarray[np.int_t, ndim=1] x):
    cdef int m = np.amax(x)+1
    cdef int n = x.size
    cdef unsigned int i
    cdef np.ndarray[np.int_t, ndim=1] c = np.zeros(m, dtype=np.int)

    for i in xrange(n):
        c[<unsigned int>x[i]] += 1

    return c

cdef packed struct Point:
    np.float64_t f0, f1

@cython.boundscheck(False)
def sparsemaker(np.ndarray[np.float_t, ndim=2] X not None,
                np.ndarray[np.float_t, ndim=2] Y not None,
                np.ndarray[np.float_t, ndim=2] Z not None):

    cdef np.ndarray[np.float64_t, ndim=1] counts, factor
    cdef np.ndarray[np.int_t, ndim=1] row, col, repeats
    cdef np.ndarray[Point] indices

    cdef int x_, y_

    _, row = np.unique(X, return_inverse=True); x_ = _.size
    _, col = np.unique(Y, return_inverse=True); y_ = _.size
    indices = np.rec.fromarrays([row,col])
    _, repeats = np.unique(indices, return_inverse=True)
    counts = 1\. / fbincount(repeats)
    Z.flat *= counts.take(repeats)

    return sp.sparse.csr_matrix((Z.flat,(row,col)), shape=(x_, y_)).toarray() 
```

* * *

## 回答 #1

> 赞同：227
> 
> 时间：2013-02-02T01:26:29.747

在你的`setup.py`，`Extension`应该有说法`include_dirs=[numpy.get_include()]`。

此外，您的代码中缺少`np.import_array()`您的代码。

--

**示例 setup.py：**

```
from distutils.core import setup, Extension
from Cython.Build import cythonize
import numpy

setup(
    ext_modules=[
        Extension("my_module", ["my_module.c"],
                  include_dirs=[numpy.get_include()]),
    ],
)

# Or, if you use cythonize() to make the ext_modules list,
# include_dirs can be passed to setup()

setup(
    ext_modules=cythonize("my_module.pyx"),
    include_dirs=[numpy.get_include()]
) 
```

* * *

## 回答 #2

> 赞同：50
> 
> 时间：2013-02-03T23:24:34.870

对于像您这样的单文件项目，另一种选择是使用`pyximport`. 你不需要创建一个`setup.py`......如果你使用 IPython，你甚至不需要打开命令行......这一切都非常方便。在您的情况下，请尝试在 IPython 或普通 Python 脚本中运行这些命令：

```
import numpy
import pyximport
pyximport.install(setup_args={"script_args":["--compiler=mingw32"],
                              "include_dirs":numpy.get_include()},
                  reload_support=True)

import my_pyx_module

print my_pyx_module.some_function(...)
... 
```

当然，您可能需要编辑编译器。这使得导入和重新加载对文件的工作与对`.pyx`文件的工作相同`.py`。

来源：[http ://wiki.cython.org/InstallingOnWindows](http://wiki.cython.org/InstallingOnWindows)

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2013-02-02T00:46:54.770

该错误意味着在编译期间未找到 numpy 头文件。

尝试做`export CFLAGS=-I/usr/lib/python2.7/site-packages/numpy/core/include/`，然后编译。这是几个不同软件包的问题。ArchLinux 中针对同一问题提交了一个错误：[https ://bugs.archlinux.org/task/22326](https://bugs.archlinux.org/task/22326)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2020-04-25T05:31:24.347

如果您懒得编写设置文件并找出包含目录的路径，请尝试[cyper](https://github.com/syrte/cyper)。它可以编译您的 Cython 代码并`include_dirs`自动设置为 Numpy。

将您的代码加载到一个字符串中，然后简单地运行`cymodule = cyper.inline(code_string)`，然后您的函数`cymodule.sparsemaker`立即可用。像这样的东西

```
code = open(your_pyx_file).read()
cymodule = cyper.inline(code)

cymodule.sparsemaker(...)
# do what you want with your function 
```

您可以通过`pip install cyper`.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-04-14T12:42:15.023

### 简单的答案

一种更简单的方法是将路径添加到您的文件`distutils.cfg`。默认情况下，它代表 Windows 7 的路径是`C:\Python27\Lib\distutils\`. 您只需断言以下内容，它应该可以解决：

```
[build_ext]
include_dirs= C:\Python27\Lib\site-packages\numpy\core\include 
```

### 整个配置文件

举个例子，配置文件的样子，我的整个文件如下：

```
[build]
compiler = mingw32

[build_ext]
include_dirs= C:\Python27\Lib\site-packages\numpy\core\include
compiler = mingw32 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-09-10T07:17:34.417

它应该能够在[此处](https://cython.readthedocs.io/en/latest/src/userguide/source_files_and_compilation.html#configuring-the-c-build)`cythonize()`提到的功能内执行此操作，但它不起作用，因为存在[已知问题](https://github.com/cython/cython/issues/1480)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2021-04-07T11:02:35.683

根据[这个答案](https://stackoverflow.com/questions/44888925/fatal-error-numpy-arrayobject-h-no-such-file-or-directory/44935933)，如果你在 Linux 上安装`numpy`了`pip`，你需要手动设置一个符号链接到`/usr/include/numpy`

在我的情况下，路径是：

```
sudo ln -s /usr/local/lib/python3.8/dist-packages/numpy/core/include/numpy/ /usr/include/numpy 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2021-11-01T00:10:00.473

I hadn't sudo privileges on the server I was running and export CFLAGS didn't work with me. For sake of simplicity, I've installed Anaconda ( [https://docs.anaconda.com/anaconda/install/](https://docs.anaconda.com/anaconda/install/)) which creates links to all its installed packages, including Numpy. You can also install miniconda and work with environments to avoid using too much space.

# javascript - 如何使用 JavaScript 设置未来 X 天？

> ID：14657378
> 
> 赞同：1
> 
> 时间：2013-02-02T00:38:56.727
> 
> 标签：javascript, date

> **可能重复：**
> [如何将天数添加到今天的日期？](https://stackoverflow.com/questions/3818193/how-to-add-number-of-days-to-todays-date)

我需要使用 JavaScript 获取明天和未来 X 天，并以 MM-DD-YYYY 格式打印。例如，如果我想传入以下参数，我希望开始日期是当前日期的明天，结束日期是从现在起 31 天。

```
startDate: '02-02-2013',
endDate: '03-04-2013', 
```

如何才能做到这一点？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-02T03:12:30.763

Date 方法足够聪明，可以支持这一点：

```
var date = new Date();
date.setDate(date.getDate() + 10 /*days*/); 
```

此示例中的日期将比当前日期提前 10 天。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-02T03:04:26.110

这将有助于

```
Date.prototype.addDays=function(d) {
   return new Date(this.getTime() + d*86400000); // milliseconds
};
console.log(new Date().addDays(5); 
```

或者

```
Date.prototype.addDays=function(d) {
   this.setTime(this.getTime() + d*86400000);
   return this;
};
var time=new Date();
time.addDays(5);
console.log(time); 
```

# java - 如何在 Play 中的生产和开发数据库配置之间切换？

> ID：14657382
> 
> 赞同：4
> 
> 时间：2013-02-02T00:39:23.463
> 
> 标签：java, mysql, jdbc, playframework, playframework-2.0

> **可能重复：**
> [如何在 Play 2.0 中配置多个数据库工作？](https://stackoverflow.com/questions/10391987/how-do-i-configure-multiple-databases-work-in-play-2-0)

基本上，我有一个应用程序，我在本地测试，然后部署到服务器。我想要一种自动或手动选择要使用的数据库配置的轻松方式。这如何在 Play 框架中完成？我在文档中似乎有一些信息，但我不知道 Scala，因此如果可能的话，我想要一些简单的说明。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T09:27:25.080

您可以使用本地主机上的替代配置文件，您可以在其中覆盖数据库设置（和其他元素），如[本文档](http://www.playframework.org/documentation/2.0.4/ProductionConfiguration)中所述。在这种情况下`application.conf`放入生产服务器的数据和`local_something.conf`放入本地数据。

您也可以将直接覆盖的值放在命令行中，即`-Ddb.default.driver=some.driver`无论如何它都会比使用文件更舒服。

# php - Mysqli 查询不能工作两次

> ID：14657385
> 
> 赞同：2
> 
> 时间：2013-02-02T00:39:58.203
> 
> 标签：php, database, mysqli

我无法让我的 Mysqli 查询同时工作。如果我在我的 html 中注释掉一个函数，则另一个函数会正确执行，反之亦然。

```
function all_posts() {
    require_once 'database.inc.php';
    $mysqli = mysqli_connect($host, $username, $password, $database);
    $query = mysqli_query($mysqli, "SELECT variable_name, post_name, post_date, post_display FROM blog_posts ORDER BY id DESC LIMIT 5");

    if (!$query)
        echo mysqli_error();

    while ($results = mysqli_fetch_assoc($query)) {

        $post_name = $results['post_name'];
        $post_date = $results['post_date'];
        $post_display = $results['post_display'];
        $variable_name = $results['variable_name'];

        echo "<a href='posts.php?post={$variable_name}'>";
        echo "<div class='entry'>";
        echo "<div class='entry_header'>";
        echo "<h2>{$post_name}</h2>";
        echo "<h3>{$post_date}</h3>";
        echo "</div>";
        echo "<p>{$post_display}</p>";
        echo "</div>";
        echo "</a>";
    }

    mysqli_free_result();
}

function all_sidebar_posts() {

    require_once 'database.inc.php';
    $mysqli = mysqli_connect($host, $username, $password, $database);
    $query = mysqli_query($mysqli, "SELECT variable_name, post_name FROM blog_posts ORDER BY id DESC LIMIT 5");

    while ($results = mysqli_fetch_assoc($query)) {

        $post_name = $results['post_name'];
        $variable_name = $results['variable_name'];
        echo "<li><a href='posts.php?post=$variable_name'>$post_name</a></li>";
    }

    mysqli_free_result();
} 
```

这是我要输出到的 html。

```
<ul>
    <?php all_sidebar_posts(); ?>
</ul>
</div>
<div class="content_container">
    <?php all_posts(); ?>
</div> 
```

我试过使用`mysqli_data_seek();`但没有运气。也许我没有正确使用它？我浏览了很多问题并找到了类似的问题，但我都试过了，但都无济于事。我是编程新手，所以我可能会忽略一些基本的东西。谢谢大家的帮助！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-02T06:35:03.497

你做错了。
**切勿**将您的数据操作代码与演示代码混合。

首先，将帖子放入数组：

```
require_once 'database.inc.php';
mysqli_report(MYSQLI_REPORT_ERROR | MYSQLI_REPORT_STRICT);
$mysqli = mysqli_connect($host, $username, $password, $database);

$sql = "SELECT variable_name, post_name, post_date, post_display 
        FROM blog_posts ORDER BY id DESC LIMIT 5"
$result = mysqli_query($mysqli, $sql);
$data = array();
while ($row = mysqli_fetch_assoc($result)) {
    $data[] = $row;
} 
```

然后使用此`$data`数组在您需要的任何时候显示帖子，只需使用`foreach()`

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-02T01:41:45.520

[http://www.php.net/manual/en/mysqli-result.data-seek.php](http://www.php.net/manual/en/mysqli-result.data-seek.php)

查阅手册了解 data_seek() 的用法；

举个例子：

```
$Query = "SELECT * FROM Users WHERE ID='1'";
$TheQuery -> $MySQLi->query($Query);
$Results = $TheQuery->fetch_array(MYSQLI_ASSOC);
$TheQuery->data_seek(0); // Lets you re-use the query

$Count = $TheQuery->num_rows; // Gets the count 
```

所以在你的情况下：

您应该执行过程方法：

```
$query = "SELECT Name, CountryCode FROM City ORDER BY Name";

    if ($result = mysqli_query($link, $query)) {

        /* fetch row */
        $row = mysqli_fetch_row($result);

        printf ("City: %s  Countrycode: %s\n", $row[0], $row[1]);

    mysqli_data_seek($result, 0);

    $row_cnt = mysqli_num_rows($result);

        /* free result set*/
        mysqli_free_result($result);

} 
```

# html - 在 HTML 5 中将 xmlns 协议添加到 xml 命名空间

> ID：14657386
> 
> 赞同：1
> 
> 时间：2013-02-02T00:40:08.717
> 
> 标签：html, facebook-opengraph, xml-namespaces

举个例子，我们从[Facebook 的开放图协议中获取了这个头部](http://developers.facebook.com/docs/opengraphprotocol/)

```
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:og="http://ogp.me/ns#"
      xmlns:fb="http://www.facebook.com/2008/fbml"> 
```

使用 xhtml 文档类型就可以了。但是 HTML 5 呢？我已经搜索了答案，包括以前的 stackoverflow 问题，但没有找到答案。我知道 xmlns 属性在 HTML5 中是允许的，如果它的值正好是“ [http://www.w3.org/1999/xhtml](http://www.w3.org/1999/xhtml) ”。但是在 HTML5 下是否允许带有 xmlns:ex 格式前缀的属性？如果是，使用它们时是否需要 xmlns 属性？我知道如果您没有使用它的其他属性，则不需要该属性。这[实际上是我同样的问题](https://stackoverflow.com/questions/6372362/html-5-adding-xml-namespaces)，但答案似乎没有回答这个问题。[另一个问题](https://stackoverflow.com/questions/1081571/facebook-connect-and-html5-xmlns-available/1081704#1081704)是关于 HTML5、facebook和xmlns。只有一条评论提到：

> 只有 xmlns="w3.org/1999/xhtml"; 属性是允许的。>xmlns:fb="facebook.com/2008/fbml"; 根据 HTML5 无效。– hsivonen 2009 年 7 月 6 日 12:05

那是真的吗？您不能将 Facebook Open Graph 与 HTML5 一起使用？！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T01:10:56.647

这似乎只是一个使用 Facebook 自己的 HTML 模板为其开放图元标记提供上下文的示例。我认为您不需要遵循他们的文档类型（或标题），因为它只是为`<meta property="og:...">`属性示例提供上下文。

我从来没有改变或遇到过文档类型声明的问题，我只是使用标准的 HTML5`<!doctype html>`声明。

您可以使用（打开图形调试器）[http://developers.facebook.com/tools/debug] 来检查您的工作。这是一个使用[HTML5 doctype 对 open-graph debugger 进行检查](http://developers.facebook.com/tools/debug/og/object?q=http%3A%2F%2Fwalkingwithdinosaurs.com)的示例。

尽管加载的页面使用标准的 HTML5 文档类型，但它仍然可以正确找到打开的图形对象：`<!doctype html>`

# shell - zsh：在当前命令行中展开前一个参数

> ID：14657391
> 
> 赞同：11
> 
> 时间：2013-02-02T00:40:43.107
> 
> 标签：shell, keyboard-shortcuts, zsh

我发现自己经常想做一些简单的命令，比如：

`cp /really/long/path/from/file.txt /really/long/path/to/file.txt`

尽管我已经经常使用类似`!!`的快捷方式`!$`，但如果能够引用*当前*命令行中的最后一个参数（并且可以选择将其展开以进行编辑），那就太好了。有没有办法在 zsh 中做到这一点，或者其他一些等效的技巧来节省时间？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-02-02T18:37:43.123

通常，您可以使用历史扩展来引用当前命令行中的单个单词。

```
$ cp /really/long/path/from/file.txt !#:1:s/from/to 
```

或者

```
$ cp /really/long/path/from/file.txt !#:$:s/from/to 
```

这是*迄今为止*`!#`键入的命令行的历史扩展。指定该扩展中的第一个参数（在这种情况下，长文件路径）。可以用来指代最后一个参数，与迄今为止输入的参数数量无关。 对所选单词执行文本替换。*`:1``:$``:s/from/to`*

 *对于此任务，您还可以使用大括号扩展：

```
$ cp /really/long/path/{from,to}/file.txt 
```

（注意：这两个都取自`bash`，但也适用于`zsh`。可能还有其他`zsh`我不知道的仅限技巧。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-02T01:24:53.203

您可以点击`Tab`以扩展 zsh 上的内容。例如：

如果我先执行此命令

```
% ls /etc 
```

在下一行我做

```
% !!<Tab> 
```

将`!!`被替换为

```
% ls /etc 
```

所以我可以按照我想要的方式进行编辑。这适用于很多事情，比如`*`环境变量。例如，在`Tab`之后点击键`$TERM`，将替换（扩展它）为（例如在我的情况下）`xterm-256color`*

# java - Eclipse 删除纹理文件

> ID：14657393
> 
> 赞同：-2
> 
> 时间：2013-02-02T00:41:01.113
> 
> 标签：java, eclipse, minecraft

我一直在使用 Java Eclipse 制作一个 Minecraft mod，并将我的纹理放在我的 eclipse bin 文件夹中。当我的计算机重新启动以进行 Windows 更新时，我重新启动了 eclipse，它已经删除了我的纹理！我花了一个小时或更长时间来详细说明这些纹理，我想知道是否有任何方法可以让它们恢复原状。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T01:40:18.680

不要将纹理放在 bin 文件夹中，每次编译时都会重新创建文件。而是将它们放在 src 文件夹中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-02T01:44:58.310

尝试在文件夹中右键单击并按“属性”。然后转到“以前的版本”并尝试在那里找到文件。

*注意*：仅适用于 Windows 7。

# antlr - 解析器规则和词法分析器规则之间的选择

> ID：14657396
> 
> 赞同：0
> 
> 时间：2013-02-02T00:41:34.837
> 
> 标签：antlr

这个问题埋在另一个问题的更新部分，现在专门问它。

我正在使用antlr3.4。

我有一个简单的语法试图解析两种类型的文本，该行以“#include”和其他开头。这是我的语法：

```
cmds
    : cmd+
    ;

cmd
    : include_cmd |  other_cmd
    ;

include_cmd
    : INCLUDE  DOUBLE_QUOTE  FILE_NAME  DOUBLE_QUOTE
    ;

other_cmd
    : (~INCLUDE)+
    ;

INCLUDE
    : '#include'
    ;

DOUBLE_QUOTE
    : '"'
    ;

FILE_NAME
    : ('a'..'z' | 'A'..'Z' | '0'..'9' | '_')+
    ;

New_Line 
    : ('\r' | '\n')+   
    ;

WS 
    : ('\t' | ' ')+  {$channel = HIDDEN;}
    ; 
```

但我收到这样的警告：

```
Decision can match input such as "{DOUBLE_QUOTE..FILE_NAME, New_Line..WS}" using multiple alternatives: 1, 2

As a result, alternative(s) 2 were disabled for that input 
```

我想这是因为双引号可以同时匹配 other_cmd 规则和 DOUBLE_QUOTE 规则，但我想知道，一个是解析器规则，另一个是词法分析器规则，这个警告有意义吗？

任何帮助清除此警告？

一个附带问题 - 警告消息只是说替代 1,2，但我并不清楚什么是 1，什么是 2，有没有办法让 antlr 提供更直接的替代方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T11:55:19.217

> 我猜这是因为双引号可以同时匹配 other_cmd 规则和 DOUBLE_QUOTE 规则，...

不，这不是问题，因为从无法匹配`include_cmd`的东西开始。`other_cmd`

> 决策可以使用多种选择匹配输入，例如“{DOUBLE_QUOTE..FILE_NAME, New_Line..WS}”：1、2

警告意味着解析器可以通过多种方式匹配输入`foo"`（a`FILE_NAME`后跟 a ）：`DOUBLE_QUOTE`

## 1.贪婪

![在此处输入图像描述](../Images/6382ab7f2afc421d7baad21988a39b0c.png)

## 2.不贪心

![在此处输入图像描述](../Images/2659f82e7e7a6503a636c7e5fb1f0d54.png)

ANTLR 将选择贪婪解析，但由于可能存在不贪婪，因此会生成警告。如果您明确告诉解析器贪婪匹配，则不会再发出警告：

```
other_cmd
 : (options {greedy=true;} : ~INCLUDE)+
 ; 
```

> 一个附带问题 - 警告消息只是说替代 1,2，但我并不清楚什么是 1，什么是 2，有没有办法让 antlr 提供更直接的替代方案？

不，据我所知没有。这个警告确实相当神秘。替代项通常表示解析器可以遵循的分支：

```
parser_rule
 : alternative_1 
 | alternative_2
 | alternative_3
 ; 
```

但是在您的情况下，似乎 ANTLR 正在谈论令牌范围是替代方案：`DOUBLE_QUOTE..FILE_NAME`成为替代方案并`New_Line..WS`成为第二个。

# jquery - 如何将表单状态设置为无效，因此不会使用 jquery 提交？

> ID：14657397
> 
> 赞同：0
> 
> 时间：2013-02-02T00:41:50.353
> 
> 标签：jquery

我正在尝试将表单状态设置为无效，因为我需要在提交表单之前更改某些字段的属性。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-02T00:43:53.437

捕获事件，并防止它触发，除非您的所有元素都具有有效值。

```
$("#myForm").submit(function(e) {
     e.preventDefault();
     // do all your validation stuff here.

     // when it is valid
     // then do this:
     // $("#myForm").submit();

}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-02T00:52:45.430

如果需要，不带 jquery：

```
<form onSubmit="myFunction()">
...
</form> 
```

然后 JavaScript myFunction() 将首先运行，您可以在那里进行验证。表单将在 myFunction() 完成后提交，除非你有这个功能`return false;` 所以你可以这样做：

```
function myFunction() {
  //cleanup first (trim etc.)
  //check validation next
  if([does not validate])
  {
    return false;
  }
} 
```

# objective-c - 动态 UILabel - UIImage - UILabel 有序设置

> ID：14657398
> 
> 赞同：0
> 
> 时间：2013-02-02T00:41:51.833
> 
> 标签：objective-c, uiview, uiimage, uilabel

我有一个需要看起来像这样的表格视图单元格：

![在此处输入图像描述](../Images/c58b7ff5eb91a192f230fc2d9f7ee825.png)

基本上我在左侧有一个标签，它总是保持相同的长度。那没问题。在右侧，我有一个长度会改变的标签，例如它将包含某人的名字，这显然因人而异。该标签需要在单元格上右对齐，也没有问题。

问题是，在动态标签的左侧，我想要一个静态 UIImage，即距离动态标签 10 个像素，但会随之移动。

想法？

这是当前代码，图像是标签的子视图，但显然没有动态移动。

```
 // Add text label
        UILabel *textLabel = [[UILabel alloc] initWithFrame:CGRectMake(20.0, 0.0, 80.0, 45.0)];
        textLabel.backgroundColor = [UIColor clearColor];
        textLabel.text = @"Account";
        textLabel.opaque = NO;
        textLabel.textColor = [UIColor colorWithRed:143/255 green:143/255 blue:143/255 alpha:.6];
        textLabel.font = [UIFont boldSystemFontOfSize:15];
        textLabel.shadowColor = [UIColor whiteColor];
        textLabel.shadowOffset = CGSizeMake(0.0, 1.0);

        //Add the image
        UIImage *image = [UIImage imageNamed:@"image.png"];
        UIImageView *imageView = [[UIImageView alloc] initWithFrame:CGRectMake(10, 13.5, 18, 18)];
        [imageView image];

        // Add the Next Value label
        UILabel *valueLabel = [[UILabel alloc] initWithFrame:CGRectMake(170, 0.0, 100, 45.0)];
        valueLabel.textAlignment = UITextAlignmentRight;
        valueLabel.textColor = [UIColor colorWithRed:143/255 green:143/255 blue:143/255 alpha:.6];
        valueLabel.backgroundColor = [UIColor clearColor];
        valueLabel.opaque = NO;
        valueLabel.font = [UIFont systemFontOfSize:15];
        valueLabel.text = [[NSUserDefaults standardUserDefaults] valueForKey:@"name"];

        [cell addSubview:textLabel];
        [cell addSubview:valueLabel];
        [valueLabel imageView];

        cell.selectionStyle = UITableViewCellSelectionStyleNone; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T03:40:20.903

试试这个代码：

```
 // Add text label
    // same as before
    // ...

    NSInteger bufferFromEndOfCell = 10; // how much space you want between the end of your valueLabel and the end of the tableCell
    NSInteger widthOfValueLabel = 100; // dynamic, change this to whatever width you want
    NSInteger startingXlocationForValueLabel = tableView.frame.size.width - bufferFromEndOfCell - widthOfValueLabel;

    // Add the Next Value label
    UILabel *valueLabel = [[UILabel alloc] initWithFrame:CGRectMake(startingXlocationForValueLabel, 0.0, widthOfValueLabel, 45.0)];
    valueLabel.textAlignment = UITextAlignmentRight;
    valueLabel.textColor = [UIColor colorWithRed:143/255 green:143/255 blue:143/255 alpha:.6];
    valueLabel.backgroundColor = [UIColor clearColor];
    valueLabel.opaque = NO;
    valueLabel.font = [UIFont systemFontOfSize:15];
    valueLabel.text = [[NSUserDefaults standardUserDefaults] valueForKey:@"name"];

    //Add the image
    NSInteger widthOfImage = 18;
    NSInteger bufferBetweenImageAndLabel = 8; // the gap between your UIImageView and your valueLabel
    CGRect rectForImageView = CGRectMake(valueLabel.frame.origin.x - widthOfImage - bufferBetweenImageAndLabel, 13.5, widthOfImage, 18);
    UIImage *image = [UIImage imageNamed:@"image.png"];
    UIImageView *imageView = [[UIImageView alloc] initWithFrame:rectForImageView];
    imageView.image = image;

    [cell addSubview:textLabel];
    [cell addSubview:valueLabel];
    [cell addSubview:imageView]; 
```

我确信有更清洁的解决方案，但我很快就解决了这个问题。这会强制图像视图随着正确的标签动态变化。如果这不是您正在寻找的内容，请告诉我。我只是根据我掌握的信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T04:27:11.413

如果您的目标是 iOS 6，我建议使用“AutoLayout”。

否则，其他答案提供的代码可以工作。

还有一个很棒的工作。

制作一个“UIButton”，将样式设置为自定义并设置图像和名称。

希望它对你有用。;)

# css - Wordpress 小部件样式

> ID：14657402
> 
> 赞同：0
> 
> 时间：2013-02-02T00:42:44.967
> 
> 标签：css, wordpress, widget

当我在 wordpress 中添加一个小部件时，它会将自定义样式放在 html 中。我在样式表中找不到样式。样式是链接小部件 widget_links 的东西，我应该在哪里找到这些样式？我可以在不编辑核心的情况下编辑这些样式吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T00:46:47.827

这取决于主题，但样式表中可能没有针对这些特定情况的规则。如果没有，只需添加它们。

您无需靠近*WordPress*核心来编辑样式表，只需使用主题中包含的样式表即可。

# regex - 如何在 SVN 中使用预提交挂钩将目录创建限制为主干、标签、分支？

> ID：14657405
> 
> 赞同：1
> 
> 时间：2013-02-02T00:43:47.140
> 
> 标签：regex, svn, tortoisesvn, pre-commit-hook

当前设置：

我们的 SVN 实例中有大约 7 个存储库。每个存储库都有多个应用程序，每个应用程序都应该有一个主干、标签和分支目录（仅此而已）！

例如：

```
 REPOSITORY-1
  --> APP-1
      --> trunk
      --> tags
      --> branches
  --> APP-2
      --> trunk
      --> tags
      --> branches 
```

随着时间的推移，我注意到开发人员偏离了这个过程并创建了各种目录。例如：

```
 REPOSITORY-1
   --> APP-1
       --> src
       --> READ-ME.txt
   --> APP-2
       --> build
       --> random-file.java
       --> build.xml 
```

有没有办法使用模式挂钩来限制模式拒绝任何尝试在应用程序下创建除主干、标签和分支之外的任何文件或目录的提交？预先感谢您的任何帮助！

额外信息：我们的 SVN 服务器在 RedHat 盒子上。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-04-07T07:45:11.030

**在预提交中添加以下脚本以限制目录创建：**

```
REPOS="$1"
TXN="$2"
DIRCHAR="/"
SVNLOOK=/opt/csvn/bin/svnlook
echo $($SVNLOOK changed -t "$TXN" "$REPOS" | awk '{print $2}') > /tmp/files_$TXN.txt
sed -i 's/ /&\n/g' /tmp/files_$TXN.txt
while read line
do
LASTCHAR=`echo $line | awk '{print substr($0,length,1)}'`
if [ "$LASTCHAR" == "$DIRCHAR" ]; then
    echo -e "Cannot commit directory." 1>&2
    exit 1
fi
done < /tmp/files_$TXN.txt 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T00:54:38.013

在预提交钩子中执行`svnlook dirs-changed REPOS_PATH`并检查输出（| grep -v ...）

# mongodb - 在生产 MongoDB 上运行 db.stats() 时担心出现无效的 BSONObj 错误

> ID：14657406
> 
> 赞同：2
> 
> 时间：2013-02-02T00:43:50.377
> 
> 标签：mongodb, bson

当我们运行 db.stats() 时，我们的生产数据库（64 位 debian 上的 2.2.1）抛出以下错误：

```
> db.stats()
{
    "errmsg" : "exception: Invalid BSONObj size: 0 (0x00000000) first element: EOO",
    "code" : 10334,
    "ok" : 0
} 
```

以下出现在我们的日志中：

```
Fri Feb  1 16:28:46 [conn4081] Assertion: 10334:Invalid BSONObj size: 0 (0x00000000) first element: EOO
0xaf8c41 0xabedb9 0xabef3c 0x571fb7 0x6e880d 0x6f6411 0x6e8321 0x6e9cb0 0x6eab4c 0x830028 0x83376b 0x7b0b0d 0x7b20e2 0x56fe42 0xae6ed1 0x7fe7645378ba 0x7fe7638eb02d
 /opt/mongodb/bin/mongod(_ZN5mongo15printStackTraceERSo+0x21) [0xaf8c41]
 /opt/mongodb/bin/mongod(_ZN5mongo11msgassertedEiPKc+0x99) [0xabedb9]
 /opt/mongodb/bin/mongod() [0xabef3c]
 /opt/mongodb/bin/mongod(_ZNK5mongo7BSONObj14_assertInvalidEv+0x497) [0x571fb7]
 /opt/mongodb/bin/mongod() [0x6e880d]
 /opt/mongodb/bin/mongod(_ZN5mongo7DBStats3runERKSsRNS_7BSONObjEiRSsRNS_14BSONObjBuilderEb+0x321) [0x6f6411]
 /opt/mongodb/bin/mongod(_ZN5mongo12_execCommandEPNS_7CommandERKSsRNS_7BSONObjEiRNS_14BSONObjBuilderEb+0x51) [0x6e8321]
 /opt/mongodb/bin/mongod(_ZN5mongo11execCommandEPNS_7CommandERNS_6ClientEiPKcRNS_7BSONObjERNS_14BSONObjBuilderEb+0xe70) [0x6e9cb0]
 /opt/mongodb/bin/mongod(_ZN5mongo12_runCommandsEPKcRNS_7BSONObjERNS_11_BufBuilderINS_16TrivialAllocatorEEERNS_14BSONObjBuilderEbi+0x2ac) [0x6eab4c]
 /opt/mongodb/bin/mongod(_ZN5mongo11runCommandsEPKcRNS_7BSONObjERNS_5CurOpERNS_11_BufBuilderINS_16TrivialAllocatorEEERNS_14BSONObjBuilderEbi+0x38) [0x830028]
 /opt/mongodb/bin/mongod(_ZN5mongo8runQueryERNS_7MessageERNS_12QueryMessageERNS_5CurOpES1_+0xc0b) [0x83376b]
 /opt/mongodb/bin/mongod() [0x7b0b0d]
 /opt/mongodb/bin/mongod(_ZN5mongo16assembleResponseERNS_7MessageERNS_10DbResponseERKNS_11HostAndPortE+0x3a2) [0x7b20e2]
 /opt/mongodb/bin/mongod(_ZN5mongo16MyMessageHandler7processERNS_7MessageEPNS_21AbstractMessagingPortEPNS_9LastErrorE+0x82) [0x56fe42]
 /opt/mongodb/bin/mongod(_ZN5mongo3pms9threadRunEPNS_13MessagingPortE+0x411) [0xae6ed1]
 /lib/libpthread.so.0(+0x68ba) [0x7fe7645378ba]
 /lib/libc.so.6(clone+0x6d) [0x7fe7638eb02d] 
```

我们对此非常关注。有任何想法吗？我在网上能找到的都是旧的和非决定性的。

以下是更多信息：

```
> db.serverStatus()
{
    "host" : "hellboy",
    "version" : "2.2.1",
    "process" : "mongod",
    "pid" : 1432,
    "uptime" : 2672006,
    "uptimeMillis" : NumberLong("2672006216"),
    "uptimeEstimate" : 2626689,
    "localTime" : ISODate("2013-02-01T23:03:16.304Z"),
    "locks" : {
        "." : {
            "timeLockedMicros" : {
                "R" : NumberLong(333024517),
                "W" : NumberLong("54808066962")
            },
            "timeAcquiringMicros" : {
                "R" : NumberLong("30969573082"),
                "W" : NumberLong("4107434021")
            }
        },
        "admin" : {
            "timeLockedMicros" : {
                "r" : NumberLong(5942684),
                "w" : NumberLong(0)
            },
            "timeAcquiringMicros" : {
                "r" : NumberLong(48432),
                "w" : NumberLong(0)
            }
        },
        "local" : {
            "timeLockedMicros" : {
                "r" : NumberLong(1109128),
                "w" : NumberLong(0)
            },
            "timeAcquiringMicros" : {
                "r" : NumberLong(82283399),
                "w" : NumberLong(0)
            }
        },
        "gc" : {
            "timeLockedMicros" : {
                "r" : NumberLong("171460799918"),
                "w" : NumberLong("171384959016")
            },
            "timeAcquiringMicros" : {
                "r" : NumberLong("1816006512260"),
                "w" : NumberLong("3169374123999")
            }
        }
    },
    "globalLock" : {
        "totalTime" : NumberLong("2672006216000"),
        "lockTime" : NumberLong("54808066962"),
        "currentQueue" : {
            "total" : 0,
            "readers" : 0,
            "writers" : 0
        },
        "activeClients" : {
            "total" : 0,
            "readers" : 0,
            "writers" : 0
        }
    },
    "mem" : {
        "bits" : 64,
        "resident" : 4212,
        "virtual" : 443165,
        "supported" : true,
        "mapped" : 221237,
        "mappedWithJournal" : 442474
    },
    "connections" : {
        "current" : 364,
        "available" : 455
    },
    "extra_info" : {
        "note" : "fields vary by platform",
        "heap_usage_bytes" : 77840056,
        "page_faults" : 15189196
    },
    "indexCounters" : {
        "btree" : {
            "accesses" : 1490093267,
            "hits" : 1490093267,
            "misses" : 0,
            "resets" : 0,
            "missRatio" : 0
        }
    },
    "backgroundFlushing" : {
        "flushes" : 36144,
        "total_ms" : 614413596,
        "average_ms" : 16999.048140770254,
        "last_ms" : 352,
        "last_finished" : ISODate("2013-02-01T23:02:43.221Z")
    },
    "cursors" : {
        "totalOpen" : 5,
        "clientCursors_size" : 5,
        "timedOut" : 3,
        "totalNoTimeout" : 5
    },
    "network" : {
        "bytesIn" : 53731292608,
        "bytesOut" : NumberLong("2215346701908"),
        "numRequests" : 264535004
    },
    "opcounters" : {
        "insert" : 83515158,
        "query" : 141076950,
        "update" : 21415981,
        "delete" : 98,
        "getmore" : 685956,
        "command" : 18499441
    },
    "asserts" : {
        "regular" : 0,
        "warning" : 57,
        "msg" : 0,
        "user" : 0,
        "rollovers" : 0
    },
    "writeBacksQueued" : false,
    "dur" : {
        "commits" : 30,
        "journaledMB" : 0,
        "writeToDataFilesMB" : 0,
        "compression" : 0,
        "commitsInWriteLock" : 0,
        "earlyCommits" : 0,
        "timeMs" : {
            "dt" : 3074,
            "prepLogBuffer" : 0,
            "writeToJournal" : 0,
            "writeToDataFiles" : 0,
            "remapPrivateView" : 0
        }
    },
    "recordStats" : {
        "accessesNotInMemory" : 3070244,
        "pageFaultExceptionsThrown" : 1124345,
        "admin" : {
            "accessesNotInMemory" : 0,
            "pageFaultExceptionsThrown" : 0
        },
        "gc" : {
            "accessesNotInMemory" : 3070244,
            "pageFaultExceptionsThrown" : 1124345
        },
        "local" : {
            "accessesNotInMemory" : 0,
            "pageFaultExceptionsThrown" : 0
        }
    },
    "ok" : 1
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-29T04:12:17.623

我们的副本集和执行 use local 也有同样的问题；`db.repairDatabase()`清除问题

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-04T13:12:19.917

最终一个

```
mongodump --repair --dbpath /data/db /path/to/dump 
```

设法生成一个转储，我们后来用它来重新创建数据库。错误消失了。这意味着一些停机时间，但现在我们可以提升我们的副本集，而不必担心复制损坏的数据库。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-02T05:06:41.150

您是否作为副本集运行？如果是这样，当你运行时会发生什么：

> 使用本地 db.repairDatabase()

如果您收到类似的 Invalid BSONObj 错误，则可能是 oplog 损坏。

如果是这种情况，您将需要重新构建它：

1）对于副本集中的所有其他节点：-停止节点-删除“本地”目录 2）在您的预期主目录上：-删除“本地”目录-启动它-运行 rs.initiate()

# gtk - 无法在 microsoft windows 上为 gdkwindow 设置不透明度

> ID：14657407
> 
> 赞同：0
> 
> 时间：2013-02-02T00:43:52.887
> 
> 标签：gtk

尝试在 microsoft windows 上使 gtkwindow 透明，但似乎没有任何效果，可以在 microsoft windows 上使顶级 gtkwindow 透明吗？一些代码将是一件好事。我在 Windows 7 上，它具有可用的透明功能谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-13T06:16:36.213

如果您在 Windows 上谈论 gtk2，它根本不支持透明度。

在您尝试获取 alpha 通道所需的 rgba 视觉效果的代码中，您将获得无。

# arrays - 如何从 perl 数组中删除长元素？

> ID：14657412
> 
> 赞同：0
> 
> 时间：2013-02-02T00:44:37.793
> 
> 标签：arrays, perl, grep

我有一个 perl 数组，其中不应包含超过 20 个字符的内容。但是，有时会错误地输入更长的字符串。

如何“清除”这些较长字符串的 perl 数组？有没有办法grep长度？就像是..

```
@blurbs = grep([size<=20],@blurbs); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-02T00:48:11.260

`length`获取字符串的长度。

```
@blurbs = grep { length($_) <= 20 } @blurbs; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-02T00:53:27.627

另一种方法是使用[地图](http://perldoc.perl.org/functions/map.html)

这是一个例子：

```
my @clean = map { length($_) <= 20 ? $_ : () } @blurbs; 
```

# jquery - eventClick 更改背景颜色

> ID：14657414
> 
> 赞同：2
> 
> 时间：2013-02-02T00:45:16.560
> 
> 标签：jquery, fullcalendar

`background-color`当我单击事件时，我正在尝试更改“事件”`FullCalendar`

我正在尝试以下 -

```
$(document).ready(function() {

    $('#calendar').fullCalendar({

        editable: true,

        events: "json-events.php",

        eventDrop: function(event, delta) {
            alert(event.id);
        },

        loading: function(bool) {
            if (bool) $('#loading').show();
            else $('#loading').hide();
        },

        eventClick: function(event){
            $(event.target).css('background-color','yellow');
        }

    });

}); 
```

然而，这无济于事。可以做到这一点，有人可以指出我正确的方向吗？

谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-02T03:22:01.000

```
eventClick: function(event) {
    event.backgroundColor = 'yellow';
    $('#mycalendar').fullCalendar( 'rerenderEvents' );
}, 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-02T07:35:24.060

`eventClick`传递一个 FC[事件对象](http://arshaw.com/fullcalendar/docs/event_data/Event_Object/)，而不是一个 jQuery 事件。您可以更改日历事件的属性，然后只需[updateEvent](http://arshaw.com/fullcalendar/docs/event_data/updateEvent/)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-02T01:03:39.103

您的函数回调没有使用范围`$(this)`- 这就是它传递 jQuery Event 对象的原因。

您应该使用[`event.target`](http://api.jquery.com/event.target/)- 这是启动事件的 DOM 元素。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-12-19T12:57:20.197

```
 eventClick: function(event){
        $(this).css('background-color','yellow');
    } 
```

# c# - 编写 C# 方法来解析 Word 文本的字符串如何迭代以获取表单？

> ID：14657417
> 
> 赞同：0
> 
> 时间：2013-02-02T00:45:24.450
> 
> 标签：c#, com-interop, office-interop

好吧，首先我想说我几乎没有使用 COM 引用的经验，所以只是玩弄 Microsoft.Office.Interop.Word 所以如果我的代码看起来有点夸张，请记住这一点。本质上，我想将一个字符串或对象放入数据库中进行解析，或者直接在 C# 中对对象运行逻辑，并将其中的一部分放入数据库中。

问题的本质是我不确定使用库如何迭代给定段落引用中的当前表单字段。请检查下面的代码，如果您有任何建议，请告诉我。我想我只是不知道合适的属性或方法来给我一个迭代来帮助我完成我的代码。

基本上我创建一个 Word 应用程序，创建引用打开 Word 应用程序的 Word Doc，我遍历文档中的段落，我将块分解为字符数组。在我的代码中，当出现相当于 21 的 ASCII 字符时，我知道这是我想要解析的一种表单框。但是，我无法使迭代成功递增，这很奇怪，无论我在哪里设置 int 的范围并且递增设置它永远不会改变范围。因此，我很茫然，很好奇是否有更好的方法来做我正在做的事情。可能有一种更简单的方法来做我正在做的事情。我知道要解决这个问题，我可能会创建一种方法来仅返回与段落对象分开的 Form 对象。但这对我来说似乎很奇怪，所以我想我会问。

我正在使用 .NET 4.5，并且由于某种原因，当我们升级到 Office 2013 时，我不得不手动添加 Microsoft.Office.Interop.Word 版本 15 的 DLL 作为参考，而没有直接在 VS 中更新参考。这是我相当混乱的代码：

```
public static string ReadTest(string loc)
        {
            Word._Application wordApp = new Word.Application();
            Word._Document Doc = wordApp.Documents.Open(loc, ReadOnly: true);

            try
            {
                sb = "";

                // This will get me JUST THE FORMS info
                //foreach (Word.FormField form in Doc.FormFields)
                //{
                //    sb += form.Result + "\n";
                //}

                int x = 1;

                foreach (Word.Paragraph objParagraph in Doc.Paragraphs)
                {
                    string st = "";

                    try
                    {
                        foreach (char c in objParagraph.Range.Text)
                        {
                            if (((int)c) != 21)
                            {
                                st += c;
                            }
                            else
                            {
                                st += Doc.FormFields.get_Item(x).Result;
                            }
                        }

                        sb += st + "\n";

                    }
                    catch (Exception ex)
                    {
                        throw ex;
                    }

                    x += 1;

                }

            }
            catch (COMException) { }
            finally
            {
                //FileInfo finfo = new FileInfo(loc);
                //finfo.IsReadOnly = false;

                if (Doc != null)
                {
                    Doc.Close();
                    Doc = null;
                }
                if (wordApp != null)
                {
                    wordApp.Quit(Word.WdSaveOptions.wdDoNotSaveChanges);
                    wordApp = null;
                }
            }

            GC.Collect();
            GC.WaitForPendingFinalizers();

            return sb;
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T17:51:51.327

确保 x 增量的正确位置是紧接在您访问表单字段之后的行：

```
 else
                        {
                            st += Doc.FormFields.get_Item(x).Result;
                            x++;
                        } 
```

我不知道您是否已经尝试将其放在那里，但是您发布的代码肯定只有在您的文档的每个段落都只有一个表单字段时才能工作。

事实上，如果有多个字段，当您找到第二个、第三个等时，21 个字符 x 还不会增加，所以您最终会读取始终相同的字段。

例如，如果第一段中只有一个字段，而第三段中只有一个字段，则您的代码将找到第一个字段，然后递增 x 并继续使用 x = 2 读取第二段而不找到任何 21 个字符。然后 x 将再次递增，当只有 2 个字段时，您将使用 x = 3 扫描第三段的字符，因此当您获得 21 个字符时，您会寻找一个不存在的字段（第三个）存在。

PS 帮助您使用示例文档会简单得多

# .net - 通过文本框中的数字生成随机字符串 (Visual Basic)

> ID：14657421
> 
> 赞同：0
> 
> 时间：2013-02-02T00:46:35.683
> 
> 标签：.net, visual-studio-2010, visual-studio

我来这里寻求有关如何使我的字符串生成器生成在 TextBox2 中键入的字符串数量的帮助。例如，如果我在框中键入 10，它将在 RichTextBox1 中生成 10 个字符串，如果我键入 1，它将生成 1，依此类推。这是我的代码。

```
 Public Function RandomString(ByVal length As Integer) As String
    Dim strb As New System.Text.StringBuilder
    Dim chars() As String = {"A", "B", "C", "D", "E", "F", "G", "H", "I", "J", "K", "L", "M", "N", "O", "P", "Q", "R", "S", "T", "U", "V", "W", "X", "Y", "Z", "0", "1", "2", "3", "4", "5", "6", "7", "8", "9"} 

    Dim UpperBound As Integer = UBound(chars)

    For x As Integer = 1 To length
        strb.Append(chars(Int(Rnd() * UpperBound)))
    Next

    Return strb.ToString

End Function

Private Sub PictureBox1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles PictureBox1.Click
    Try
        System.Diagnostics.Process.Start("Link Removed...")
    Catch
    End Try
End Sub

Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click
    Dim rndstring As String
    rndstring = RandomString(24)
    RichTextBox1.Text = rndstring
End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T01:05:47.390

您需要做的是修改 Button1 的单击处理程序以重复`TextBox2`. 但是，您应该验证用户是否也在文本框中指定了一个有效的数值。像这样的东西：

```
Private Sub Button1_Click(sender As System.Object, e As System.EventArgs) Handles Button1.Click
    Dim repeatCnt As Integer

    'Check for valid numeric entry
    If Integer.TryParse(TextBox2.Text, repeatCnt) Then
        For repeatIdx As Integer = 1 To repeatCnt
            Dim rndstring As String
            'Generate random string...
            rndstring = RandomString(24)
            '...and append to text box with a line break
            TextBox1.Text &= rndstring & vbCrLf
        Next
    Else
        MessageBox.Show("Please enter a valid integer number in the text box")
    End If
End Sub 
```

一个额外的建议可能是将用户指定重复值的文本框更改为 NumericUpDown 控件。

另请注意，对于较大的重复值，`Text`由于字符串的[不可变性](https://stackoverflow.com/questions/2365272/why-net-string-is-immutable)，附加到文本框属性的效率不高，因此也许另一个`StringBuilder`是合适的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T01:05:55.607

你可以使用这个方法（基本上它只是一个额外的`For`循环）：

```
Private Shared rnd As New Random()
Private Shared chars() As String = {"A", "B", "C", "D", "E", "F", "G", "H", "I", "J", "K", "L", "M", "N", "O", "P", "Q", "R", "S", "T", "U", "V", "W", "X", "Y", "Z", "0", "1", "2", "3", "4", "5", "6", "7", "8", "9"}

Public Shared Function RandomStrings(ByVal length As Int32, count As Int32) As IEnumerable(Of String)
    Dim builder = New System.Text.StringBuilder()
    Dim strings = New List(Of String)
    For c As Int32 = 1 To count
        For l As Int32 = 1 To length
            builder.Append(chars(rnd.Next(0, chars.Length)))
        Next
        strings.Add(builder.ToString())
        builder.Clear()
    Next
    Return strings
End Function 
```

创建 100 个长度为 10 的随机字符串：

```
Dim allStrings = RandomStrings(10, 100) 
```

# python - 获取从模块或任何其他对象可访问的所有属性

> ID：14657425
> 
> 赞同：0
> 
> 时间：2013-02-02T00:47:36.810
> 
> 标签：python

考虑一下：

```
>>> import math
>>> dir(math)
['__doc__', '__name__', '__package__', 'acos', 'acosh', 'asin', 'asinh', 'atan', 'atan2', 'atanh', 'ceil', 'copysign', 'cos', 'cosh', 'degrees', 'e', 'exp', 'fabs', 'factorial', 'floor', 'fmod', 'frexp', 'fsum', 'hypot', 'isinf', 'isnan', 'ldexp', 'log', 'log10', 'log1p', 'modf', 'pi', 'pow', 'radians', 'sin', 'sinh', 'sqrt', 'tan', 'tanh', 'trunc'] 
```

`__dict__`未列出，但我仍然可以

```
>>> math.__dict__ 
```

同样的事情

```
>>> class MyClass(object):
         def __init__(self, var1, var2):

             self.a = var1
             self.b = var2

         def __call__(self, arg):

             print " The arg passed is ", arg

>>> dir(MyClass) 

['__call__', '__class__', '__delattr__', '__dict__', '__doc__', '__format__', '__getattribute__', '__hash__', '__init__', '__module__', '__new__', '__reduce__', '__reduce_ex__', '__repr__', '__setattr__', '__sizeof__', '__str__', '__subclasshook__', '__weakref__'] 
```

`__bases__`并`__base__`没有列出，但我仍然可以这样做：

```
>>> MyClass.__bases__
(<type 'object'>,)
>>> MyClass.__base__
<type 'object'> 
```

问题：

我怎样才能知道或提前知道从 python 对象可以访问的所有属性？在这种情况下，我如何判断该`math`模块 has`__dict__`和`MyClass`has `__base__`and `__bases__`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T00:57:46.303

如果您正在寻找完全通用的东西，则无法做到，因为属性查找是动态的。正如[文档](http://docs.python.org/2/library/functions.html#dir)所说：

> 尝试返回该对象的有效属性列表。

那里的关键词是“尝试”。在下面：

> 注意 因为提供 dir() 主要是为了方便在交互式提示下使用，所以它尝试提供一组有趣的名称比它尝试提供一组严格或一致定义的名称要多，并且它的详细行为可能会随着版本的不同而改变. 例如，当参数是类时，元类属性不在结果列表中。

实际上，它所能做的就是查看`__dict__`对象的类型、类型以及该类型的任何基类。（然后它减去了一些东西——例如，类型的属性被跳过以避免暴露元类属性，你通常不关心）。如果您想了解确切的详细信息，请阅读上面链接的文档。

同时，如果对象具有上述的`__getattr__`/ `__setattr__`/ `__delattr__`、 or`__getattribute__`或 C-API 等价物，则它可能具有任何字典中都不存在的各种属性，甚至可能具有无限的属性集。例如：

```
class C(object):
    def __getattr__(self, name):
        return name
c = C()
print(c.a) 
```

这将打印出来`a`。但怎么`dir`可能知道`c.a`存在呢？即使它可以解释我的代码，它也必须打印出所有可能字符串的列表，这显然是您不想要的。

还有一些特殊的属性名称在解释器的掩护下以奇特的方式处理。

此外，任何对象都可以定义一个`__dir__`方法来返回它想要的任何东西。

如果您正在寻找特定的东西，您可能可以这样做。例如，如果您只是想在不减去元类属性的情况下获取属性，那只是`dir(x) + dir(type(x))`，或者，也许更好，`dir(x) + [a for a in dir(type(x)) if a not in dir(x)]`（删除重复项）。

但是如果你想知道一个对象的所有属性，那么你做不到。

# asp.net-web-api - NLog - ASP.Net Web API 跟踪

> ID：14657427
> 
> 赞同：0
> 
> 时间：2013-02-02T00:47:59.307
> 
> 标签：asp.net-web-api, nlog

尝试使用 NLog 进行一些基本的 ASP.NET Web API 跟踪。

经过大量搜索后，我能找到的唯一文档在这里： http: [//nlog-project.org/2010/09/02/routing-system-diagnostics-trace-and-system-diagnostics-tracesource-logs-through- nlog.html](http://nlog-project.org/2010/09/02/routing-system-diagnostics-trace-and-system-diagnostics-tracesource-logs-through-nlog.html)

以上不适用于 Web API，但我已尝试对其进行调整，问题似乎出在我的 Web.Config 中：

```
<system.diagnostics>
    <sources>
      <source name="System.Web.Http.ApiController" switchValue="All">        
        <listeners>
          <add name="nlog" />
        </listeners>
      </source>
    </sources>
    <sharedListeners>
      <add name="nlog" type="NLog.NLogTraceListener, NLog" />
    </sharedListeners>
  </system.diagnostics> 
```

任何想法为什么它不工作或引用一个例子？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-02T01:02:03.740

是的，我写了一篇关于如何将 NLog 实现`ITraceWriter`为 Web API 提供程序的文章。

它是针对 Web API RC 编写的，但它也应该适用于 RTM：http: [//www.strathweb.com/2012/06/using-nlog-to-provide-custom-tracing-for-your-asp-net -web-api/](http://www.strathweb.com/2012/06/using-nlog-to-provide-custom-tracing-for-your-asp-net-web-api/)

Dave Bettin 在 GitHub 上也有一个示例 - [https://github.com/dbettin/webapi.nlog](https://github.com/dbettin/webapi.nlog)

# php - 如何在 Ruby 中使用 SOAP (Savon)？- 从 PHP 迁移

> ID：14657431
> 
> 赞同：-3
> 
> 时间：2013-02-02T00:48:16.237
> 
> 标签：php, ruby-on-rails, ruby, soap, savon

我需要在 Ruby 中执行此操作：

```
$client = new SoapClient(null, array('location' => 'https://mydomain.com/index.php',
                                 'uri'      => 'https://mydomain.com/',
                                 'trace' => 1,
                                 'exceptions' => 1));
$id = $client->login($username,$password); 
```

我怎样才能做到这一点？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T00:50:40.533

[Savon 文档在http://www.savonrb.com](http://savonrb.com)上非常详细。我相信你可以找到你要找的东西——你至少应该在求助于这里之前尝试一下。

# python - python中的相关矩阵

> ID：14657433
> 
> 赞同：30
> 
> 时间：2013-02-02T00:48:21.120
> 
> 标签：python

如何在python中计算相关矩阵？我有一个 n 维向量，其中每个元素都有 5 维。例如我的矢量看起来像

```
[
 [0.1, .32, .2, 0.4, 0.8],
 [.23, .18, .56, .61, .12],
 [.9, .3, .6, .5, .3],
 [.34, .75, .91, .19, .21]
]

```

在这种情况下，向量的维数为 4，并且该向量的每个元素都有 5 维。如何以最简单的方式构造矩阵？

谢谢

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2013-02-02T00:53:53.880

使用[numpy](http://www.numpy.org/)，您可以使用[np.corrcoef](http://docs.scipy.org/doc/numpy/reference/generated/numpy.corrcoef.html)：

```
In [88]: import numpy as np

In [89]: np.corrcoef([[0.1, .32, .2, 0.4, 0.8], [.23, .18, .56, .61, .12], [.9, .3, .6, .5, .3], [.34, .75, .91, .19, .21]])
Out[89]: 
array([[ 1\.        , -0.35153114, -0.74736506, -0.48917666],
       [-0.35153114,  1\.        ,  0.23810227,  0.15958285],
       [-0.74736506,  0.23810227,  1\.        , -0.03960706],
       [-0.48917666,  0.15958285, -0.03960706,  1\.        ]]) 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2016-09-16T02:47:42.160

如果您不想重新编写矩阵，也可以使用 np.array 。

```
import numpy as np
a = np.array([ [0.1, .32, .2,  0.4, 0.8], [.23, .18, .56, .61, .12], [.9,   .3,  .6,  .5,  .3],  [.34, .75, .91, .19, .21]]) 
b = np.corrcoef(a)
print b 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-12-20T13:16:44.247

由于我几乎错过了@Anton Tarasenko 的评论，我将提供一个新的答案。所以给定你的数组：

```
a = np.array([[0.1, .32, .2,  0.4, 0.8], 
             [.23, .18, .56, .61, .12], 
             [.9,   .3,  .6,  .5,  .3],  
             [.34, .75, .91, .19, .21]]) 
```

如果你想要我假设的维度（列）的相关矩阵，你可以使用 numpy （注意转置！）：

```
import numpy as np
print(np.corrcoef(a.T)) 
```

或者，如果你在 Pandas 中有它：

```
import pandas as pd
print(pd.DataFrame(a).corr()) 
```

两者都打印

```
array([[ 1\.        , -0.03783885,  0.34905716,  0.14648975, -0.34945863],
      [-0.03783885,  1\.        ,  0.67888519, -0.96102583, -0.12757741],
      [ 0.34905716,  0.67888519,  1\.        , -0.45104803, -0.80429469],
      [ 0.14648975, -0.96102583, -0.45104803,  1\.        , -0.15132323],
      [-0.34945863, -0.12757741, -0.80429469, -0.15132323,  1\.        ]]) 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-12-31T06:46:11.117

这是使用 Python 计算多个时间序列的相关矩阵的一个[很好的例子。](http://www.tradinggeeks.net/2015/08/calculating-correlation-in-python/)包含的源代码使用 Pandas、NumPy 和 matplotlib 计算一组外汇货币对的相关矩阵，以生成相关图。

样本数据是一组历史数据文件，输出是单个相关矩阵和图。该代码有很好的文档记录。

# javascript - 在使用客户端模板的同时创建打印友好的应用程序

> ID：14657434
> 
> 赞同：0
> 
> 时间：2013-02-02T00:48:31.790
> 
> 标签：javascript, css, printing, client-side, single-page-application

看起来 chrome & safari 在打印时不考虑客户端模板。有什么解决方法吗？

基本上，打印页面看起来好像没有做模板。

任何线索都会很棒，谢谢！

马特

# sockets - 通过 Akka IO 和套接字的协议缓冲区消息

> ID：14657435
> 
> 赞同：5
> 
> 时间：2013-02-02T00:48:44.827
> 
> 标签：sockets, scala, protocol-buffers, akka

我遇到了[这篇博](http://cognitiveentity.wordpress.com/2012/02/23/simpler-akka-io-example/)文，我觉得这篇博文很棒而且很有启发性，它展示了如何对发送到 Akka IO 套接字服务器的字符串消息进行固定长度的框架。我一直在使用我在[这里找到的一个名为 ScalaBuff](https://github.com/SandroGrzicic/ScalaBuff)的开源库，它在协议缓冲区对象之上创建了一个很好的薄层。

我遇到的麻烦是调整博客作者的（找不到直接联系他的链接）代码来获取长度（4 字节序列），然后是 protobuf 字节数组。我可能会担心稍后确定在线上是哪条消息，现在我只想让代码与一个示例消息一起工作。

我的问题是我无法将 Akka IO 代码从提取 akka ByteStrings 转换为能够从 protobuf 消息中发送和提取原始字节。这是我对使用 Akka IO 的套接字服务器不熟悉的症状。我可以往返于我的 protobuf 对象（一个[Zombie Sighting](http://www.kotancode.com/2012/10/14/using-google-protocol-buffers-in-objective-c-on-ios-and-the-mac/)）的字节表示，但我只是无法从博客中获取样本来处理字节数组而不是字符串。

如果有人对如何从 A 点（上面提到的博客文章）到 B 点（向 Akka IO 套接字服务器发送 protobuf 消息的 Akka IO 套接字客户端）有一些建议、一些示例代码或一些输入。我认为我有客户工作..也许），那太棒了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T01:16:59.790

尝试这个：

```
val myByteArray = myByteString.toArray // converts to an Array[Byte]
val myMessage = MyMessage.defaultInstance.mergeFrom(myByteArray) 
```

MyMessage 是使用 MyMessage.proto 模板的 ScalaBuff 编译器生成的类。请注意，Google protobuf 库有一个单独的 ByteString 类，请确保不要将两者混为一谈。

更新：凯文的问题已经解决，基本上问题是他使用 Array[Byte] 的 toString 方法，而不是将字节数组包装在 new String() 中，它正确地将字节数组转换为字符串，在 "%s".format 调用中使用。

# magento - 在 magento 中阻止控制器

> ID：14657437
> 
> 赞同：0
> 
> 时间：2013-02-02T00:49:04.720
> 
> 标签：magento, block

我正在尝试在 /index.php/pincel/payment/error/ 中显示内容，并且我有下一个文件：

块/错误.php

`<?php class PincelStudios_Pincel_Block_Error extends Mage_Core_Block_Template { } ?>`

等/config.xml

```
 <layout>
        <updates>
            <pincel>
                <file>pincel.xml</file>
            </pincel>
        </updates>
    </layout> 
```

控制器/PaymentController.php

```
 public function errorAction()
{
    $this->loadLayout()->renderLayout();
} 
```

但是我得到了一个没有任何错误的白色布局（在日志中都没有） [http://i.stack.imgur.com/vzLkk.png](http://i.stack.imgur.com/vzLkk.png)

有任何想法吗？提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-03T20:55:47.430

看起来您没有提供所有必要的信息和文件

```
/app/design/frontend/default/default/layout/pincel.xml 
```

不见了。

```
<pincel_payment_error>
    <reference name="content"> <!-- Place were you want to display your content -->
        <block type="pincel/error" name="pincel" template="yourtemplate if necessary" />
    </reference>
</pincel_payment_error> 
```

你有吗？

# android - :active 伪类在 Android 上的 Chrome 中不起作用

> ID：14657441
> 
> 赞同：4
> 
> 时间：2013-02-02T00:49:42.963
> 
> 标签：android, google-chrome, pseudo-class

`:active`伪类在移动 Safari 和普通 Android 浏览器中完美运行，但在 Android 上的 Chrome 中失败。（在 Nexus 4 Chrome、iPhone 4S Safari、Galaxy SII 浏览器上测试。）

知道为什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T11:00:20.833

:active pseduo 适用于 Android 版 Chrome，但仅在长按（并取消对话框）后，据我所知，它不适用于任何其他元素。它看起来像一个错误，我刚刚向团队[提出了它](https://code.google.com/p/chromium/issues/detail?id=173976)。

示例：http: [//jsbin.com/itikox/2](http://jsbin.com/itikox/2#)

# objective-c - 使用 cocos2d+box2d 进行硬币碰撞检测 - 联系人监听器还是自定义？

> ID：14657443
> 
> 赞同：1
> 
> 时间：2013-02-02T00:49:52.580
> 
> 标签：objective-c, cocos2d-iphone, box2d

我正在使用带有 Box2D 的 cocos2d 制作 iOS 游戏，我想知道如何最好地处理与硬币等可收集对象的碰撞。玩家是一个动态物体，但硬币和其他收藏品（通常）是静态物体。在玩家和这些对象之间创建接触侦听器会更好，还是只遍历游戏循环中的每个硬币（排除屏幕外的任何硬币等）并对它们执行循环碰撞检测？

后一种解决方案对我来说似乎是合理的，但我对 box2D 缺乏经验，并且不确定使用联系监听器时的优点/缺点和性能成本是什么，所以我不确定这是否会更好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T11:49:17.243

我会让接触侦听器完成它的工作，而不是尝试与 Box2D 已经在做的事情并行实施碰撞检测。

您可以使用 bodyDef.userData 存储对 CCPhysicsSprite 对象（或父对象）的周引用，以便您可以在联系侦听器中访问它。从 Box2D 文档中：

> 用户数据是一个空指针。这为您提供了将应用程序对象链接到主体的挂钩。您应该一致地为所有正文用户数据使用相同的对象类型。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T15:47:58.070

您可能想查看传感器，因为您不希望硬币阻止您前进。

# powershell - Powershell - 解析文件夹的前景埋藏两层

> ID：14657446
> 
> 赞同：1
> 
> 时间：2013-02-02T00:50:17.887
> 
> 标签：powershell, outlook

收件箱

....|___文件夹1

.............|___文件夹2

我有在收件箱下搜索文件夹的代码，但我无法理解如何在文件夹下搜索文件夹的某些字段。我需要做某种递归吗？

```
$olFolderInbox = 6
$outlook = new-object -com outlook.application;
$ns = $outlook.GetNameSpace("MAPI");
$inbox = $ns.GetDefaultFolder($olFolderInbox)

$Folder1 = $inbox.Folders | where-object { $_.name -eq "Folder1" }      
$Folder1Mail = $UTSFolder.items | Select-Object -Property Subject, ReceivedTime, Body 
```

然后，我可以将 input.txt 用于我正在查找的信息列表，并将其与该收件箱中的每个项目进行比较。

```
$Inputs = Get-Content input.txt

Foreach ($Input in $Inputs){
    Foreach ($Mail in $Folder1Mail){
        if ($Mail.Body -like "*$Input*") { 
            Write-Host "Match found!" 
        }
    }
} 
```

我找到了一个脚本，可以抓取并列出所有文件夹和子文件夹，但它不像如何引用它们那么明确。 [http://gallery.technet.microsoft.com/office/b1295e6f-6d16-4df4-b644-f3c7e4031a69](http://gallery.technet.microsoft.com/office/b1295e6f-6d16-4df4-b644-f3c7e4031a69)

目前正在阅读 Windows PowerShell In Action，因为我厌倦了弗兰肯斯坦的购物脚本。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-02T06:45:34.723

你需要使用`MAPIFolder.Folders`集合：VB风格：

```
set Folder = inbox.Folders.Item("folder1").Folder.Item("Folder2") 
```

# c++ - scoped_ptr 所有权

> ID：14657449
> 
> 赞同：12
> 
> 时间：2013-02-02T00:51:22.350
> 
> 标签：c++, smart-pointers

> **可能重复：**
> [什么是智能指针，我应该什么时候使用？](https://stackoverflow.com/questions/106508/what-is-a-smart-pointer-and-when-should-i-use-one)

我正在阅读[一篇文章](http://www.codeproject.com/Articles/8394/Smart-Pointers-to-boost-your-code)，我找到了一个小例子来演示`boost::scoped_ptr<T>`：

```
#include <cstdlib>
#include <iostream>
#include <boost/scoped_ptr.hpp>
#include <boost/scoped_array.hpp>

static int count = 0;

class printer
{
    int m_id;

public:
    printer(void) :
        m_id(count++)
    {
    }

    ~printer(void)
    {
        std::cout << "Printer " << m_id
                  << " destroyed" << std::endl;
    }
};

int
main(void)
{
    boost::scoped_ptr<printer> p1(new printer);
    boost::scoped_ptr<printer> p2(new printer);
    std::cout << "Exiting test program" << std::endl;

    return EXIT_SUCCESS;
} 
```

我在文章中唯一不明白的是这样的声明：

> 使用`scoped_ptr`，您表示不打算或不允许所有权转让。

作为该主题的初学者，也许这是错误的文章，但是上面的行到底是什么意思？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-02-02T01:07:39.807

大多数智能指针都拥有它们所指向的对象的所有权——它们负责在时机成熟时销毁该对象。然而，不同的智能指针有不同的*所有权语义*。也就是说，它们告诉该智能指针的用户如何转移或不转移所有权，如何在对象之间共享所有权，何时应该删除该对象，等等。使用某个智能指针描述了您对该对象所有权的*意图。*所有权可以转移到其他功能或对象。

`boost::scoped_ptr`具有非常严格的所有权语义。它根本不允许任何所有权转让。它通过不可复制来实现这一点（因此您不能通过值将其传递给另一个函数）。

作为另一个例子， a`std::unique_ptr`也相当严格。它的特殊能力是可以移动。将 an 作为右值传递`std::unique_ptr`给函数将使该函数窃取对象的所有权。原件`std::unique_ptr`立即失去该所有权。这确保了所有权只由一个人持有`std::unique_ptr`。

`boost::scoped_ptr`C++11 中的等价物是`const std::unique_ptr`. 这是因为制作它`const`可以防止任何移动，因此无法转移所有权。

通过示例可以轻松了解所有权语义的重要性。假设您正在使用一个邪恶的开发人员的库，并且它有一个您不知道其实现的函数，例如：

```
cat* foo(); 
```

你知道这个函数返回一个指向 a 的指针`cat`。但是，它是一个原始指针。您不知道是否应该`delete`在某个时候销毁猫（使用 ），或者图书馆是否会为您这样做。您甚至不知道该对象是否实际上是动态分配的。你不知道图书馆是否还保留着`cat`. 过去，如果您有这样的功能，则需要查找文档以了解如何操作。然而，现在我们除了原始指针之外还有智能指针，原始指针有自己的所有权语义——它们中最宽松的。它说：“你最好相信我，`cat`只要你传递它，我就会保持它的有效性，但我将是管理它的人。不要保存太久。”

然而，一个聪明而善良的库开发者现在会像这样编写这个函数：

```
std::unique_ptr<cat> foo(); 
```

那么这有什么帮助呢？嗯，这`std::unique_ptr`告诉你很多。它告诉您该函数正在向您放弃该`cat`对象的所有权。现在`cat`是您的全部责任。它对给你一个智能指针也很有帮助，因为你不需要考虑`delete`它。您可以只使用指针，当它超出范围时，对象将被销毁。或者，如果您愿意，您可以将所有权转让给*另一个*职能部门。

这并不意味着只有一个指针将拥有`cat`尽管的所有权。作为自豪的新主人，接下来会发生什么由您决定。您决定开始共享您的所有权是完全合理的`cat`：

```
std::unique_ptr<cat> up = foo();
std::shared_ptr<cat> sp(up.release()); 
```

聪明善良的`foo`图书馆开发者只告诉你*她的*意图是什么。她给了你`cat`，现在你是主人。现在您可以提供自己的所有权语义。

这样一来，`boost::scoped_ptr`a有点像一个贪婪的`cat`囤积者，永远不会`cat`与任何人分享，永远不会把猫给任何人，并且会一直保存到他们死去的那一天。

# java - 报告生成，耗时数小时

> ID：14657451
> 
> 赞同：-4
> 
> 时间：2013-02-02T00:52:01.107
> 
> 标签：java, sql, database, jdbc, report

我正在从两个数据库表生成一个用于成功或失败的 xml 文件，但生成它需要 24 小时。

我有 2 个选择查询，一个用于成功，一个用于失败。我为每条记录访问数据库 100 万次。

我正在使用 JDBC 和 Java IO 写入文件。

请提出一些好的想法

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T01:46:44.267

唯一可能的答案是您显然需要优化您的 SQL 和/或您的应用程序设计，以便您不会过多地“打击”数据库。

这么少的细节，不可能说你应该如何优化，但也许你应该看看做一个 JOIN ...

# javascript - 将delphi画布椭圆函数移植到javascript弧函数

> ID：14657456
> 
> 赞同：0
> 
> 时间：2013-02-02T00:53:36.147
> 
> 标签：javascript, delphi

是否可以从 Delphi移植[TCanvas.Ellipse方法](http://docwiki.embarcadero.com/Libraries/XE2/en/Vcl.Graphics.TCanvas.Ellipse)

```
Ellipse(X1,Y1,X2,Y2); 
```

在 JavaScript 中使用arc[方法？](http://www.w3schools.com/tags/canvas_arc.asp)

```
arc(x,y,r,sAngle,eAngle,counterclockwise); 
```

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-02T04:06:52.177

没有直接的、笼统的翻译；Delphi函数画椭圆，而JavaScript函数只画圆弧，不能画椭圆（虽然可以近似）。

如果你是`Ellipse`用来画一个*圆*，那么转换很简单。计算矩形的中心（实际上是正方形），然后计算半径的一半高度或宽度。问题中链接的文档已经提到了用于整圈的角度，顺时针或逆时针无关紧要。

```
arc(x1+(x2-x1)/2, y1+(y2-y1)/2, (x2-x1)/2, 0, Math.PI/2); 
```

如果您想要一个椭圆，请考虑使用[以外的其他东西`arc`，例如 Bezier 曲线](https://stackoverflow.com/a/2173084/33732)。

# css - 强制 Windows 显示 Helvetica 而不是 Arial

> ID：14657463
> 
> 赞同：3
> 
> 时间：2013-02-01T00:02:37.760
> 
> 标签：css, fonts

如何使 Windows 始终显示 Helvetica 而不是 Arial？这甚至可能吗？我知道它会自动替换它，但是有什么办法可以做到这一点。

我知道我可以使用字体松鼠，但显然这是非法的。还有其他解决方案吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-01T06:54:48.580

你不能。即使嵌入字体也不会*强制*执行任何操作，因为用户系统中的设置可能会阻止使用可下载字体。此外，嵌入 Helvetica*是*非法的，除非其版权所有者允许。

如果您声明`font-family: Helvetica`，则仅当用户的系统安装了 Helvetica 时才会使用 Helvetica，而 Windows 系统通常不安装。由于 Windows 设置，当未安装 Helvetica 时，将使用 Arial。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-01T03:27:57.643

使用此代码段确保您的网站使用 Helvetica 而不是 Arial（如果可能）：

```
body {
   font-family: "HelveticaNeue-Light", "Helvetica Neue Light", "Helvetica Neue", Helvetica, Arial, "Lucida Grande", sans-serif; 
   font-weight: 300;
} 
```

此外，还有许多 Helvetica 的替代品，如果你需要一些免费的东西，可以试试[Google WebFonts](https://developers.google.com/webfonts/)，它们至少有一些看起来或多或少像 Helvetica 的字体：Actor、Asap、Cabin、Droid Sans、Lato、Open Sans、PT Sans、瓦雷拉。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-01T22:09:42.760

正如已经说过的那样。如果您使用的是实际字体而不是字体图像，则不能合法地将字体强制到系统上。

您应该做的是使用正确的 CSS 字体堆栈，如其他答案所示，计算机将使用它在系统上拥有的第一个字体。

始终将 Helvetica 放在 Arial 之前，以便在可用时首先选择它。Helvetica 和 Arial DO 看起来非常相似，但关心的人可以分辨出来。

[http://www.ironicsans.com/helvarialquiz/](http://www.ironicsans.com/helvarialquiz/)

# node.js - node.js 中的 CalDAV？

> ID：14657473
> 
> 赞同：13
> 
> 时间：2013-02-02T00:55:48.440
> 
> 标签：node.js, caldav

有谁知道在 node.js 应用程序中提供日历（CalDAV）接口的选项？

我见过[jsDAV](https://github.com/mikedeboer/jsdav)，但它似乎目前不支持 CalDAV。

似乎 node+express 支持 *DAV HTTP 方法，如 PROPFIND 等，但我怀疑直接编写 CalDAV impl 作为我的应用程序的一部分是否可行。

有什么想法或建议吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-08-08T11:40:24.473

发现这个：[https](https://github.com/mozilla-b2g/caldav) ://github.com/mozilla-b2g/caldav似乎是 FirefoxOS 中的 JavaScript 实现，所以它应该可以工作。它似乎得到维护，带有单元测试（使用 Mocha）但没有文档：/

维基百科上有一个库列表：[http ://en.wikipedia.org/wiki/Comparison_of_CalDAV_and_CardDAV_implementations](http://en.wikipedia.org/wiki/Comparison_of_CalDAV_and_CardDAV_implementations)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-01-29T14:51:57.087

在 Cozy，我们正在维护这个支持 CalDAV（仅限服务器）的 jsDAV 分支：[https ://npmjs.org/package/cozy-jsdav-fork](https://npmjs.org/package/cozy-jsdav-fork)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-07-06T08:25:05.243

茴香是一个好的开始：[https ://github.com/LordEidi/fennel](https://github.com/LordEidi/fennel)

CalDAV / CardDAV

# c++ - windows.h 和限制的冲突？

> ID：14657474
> 
> 赞同：6
> 
> 时间：2013-02-02T00:55:56.507
> 
> 标签：c++, limit

以下代码在 VS2010 中不起作用。是什么原因？

```
#include <limits>
#include <windows.h> // if I remove this line, it is okay.

int main()
{
    std::numeric_limits<int>::min();
    return 0;
} 
```

我创建了一个 VC 空控制台项目并添加了一个 main.cpp 如上所述。是这个原因吗？我是否需要创建另一种项目？谢谢。

谢谢你们的帮助。问题来自我正在使用[`vld.h`](http://vld.codeplex.com/)和`limits`一起使用。我确实阅读`vld.h`以尝试自己找到问题。经过一些测试，我发现问题可能出在`window.h`其中`vld.h`。抱歉忘记谷歌了。而且我个人发现 stackoverflow 对像我这样的新程序员的帮助非常有帮助。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-02-02T00:59:53.007

这是一个已知问题，由定义在（实际上，更准确地说是包含在）中的一个不幸的`max`宏引起。在包含之前定义应该可以解决问题。例如：`windows.h``windef.h``windows.h``NOMINMAX``windows.h`

```
#define NOMINMAX
#include <windows.h> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-02T13:23:17.110

有时`#define NOMINMAX`不起作用（我见过这样的例子），那么你总是可以`#undef MIN`& `#undef MAX`。

此外，当您使用 VS2010 时，通常最好将此类预处理器变通办法用于 Windows，`stdafx.h`而不是一直重复它们。

# haskell - 在没有类型注释的 let 绑定中避免单态

> ID：14657475
> 
> 赞同：3
> 
> 时间：2013-02-02T00:56:22.160
> 
> 标签：haskell, polymorphism, let, monomorphism

我有一些使用类型来消除实例歧义的代码（真正的代码是使用 GHC.TypeLits 单例作为类型标签，但我认为这不是密切相关的），我想使用 let 绑定来避免文本级重复; 不幸的是，这使结果单一化。

以下是该问题的一个示例：

```
class Foo a where
  foo :: a

instance Foo Int where
  foo = 0

instance Foo Char where
  foo = 'a'

data Bar a = Bar String
  deriving (Show)

bar :: forall a. (Show a, Foo a) => a -> Bar a
bar _ = Bar $ show (foo :: a)

idInt :: Bar Int -> Bar Int
idInt = id

idChar :: Bar Char -> Bar Char
idChar = id

main = let quux = bar undefined in
  print (idInt quux) >> print (idChar quux) 
```

上面的代码不能编译（但是，当然，如果我输入 annotate`quux`是多态的，一切正常），正确地抱怨它不能`Int`与`Char`. 有没有什么方法可以让编译成功而无需类型注释并且无需`bar undefined`在每个使用站点重复？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-02T01:14:51.677

```
{-# LANGUAGE NoMonomorphismRestriction #-} 
```

或者如果你想要一些不那么全球化的东西

```
let quux () = bar undefined in 
    print (idInt (quux ()) >> print (idChar (quux ())) 
```

后者起作用的原因是绑定仅在等号左侧没有参数时才被单态化。

```
let foo = \x y -> x + y   -- :: Integer -> Integer -> Integer
let bar x y = x + y       -- :: (Num a) => a -> a -> a 
```

所以为了`quux`不单态化，你必须在等号的左边给它一个参数。如果`quux`不是一个值而是一个函数，您可以简单地进行 eta 扩展以获得相同的效果：

```
let quux x = bar undefined x in ... 
```

对于前者，不要担心性能——如果你总是将它称为`quux ()`，那么它将被内联并生成与具有显式类型签名的版本相同的代码。

# ios - iOS xx 采用率

> ID：14657482
> 
> 赞同：3
> 
> 时间：2013-02-02T00:57:26.707
> 
> 标签：ios

我很好奇有多少百分比的 iOS 用户使用操作系统版本运行。我真的很想将我的新应用程序削减为 6.0+，但也不想搞砸 5.x 的人。

我做了很多谷歌搜索，但它主要是出现技术文章，要么不是最新的，要么信息不够丰富（都是关于 iOS 6.1 的）。

是否有实时更新的已知来源？我似乎找不到一个。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-02T01:26:34.943

我有几个应用程序的数据，总下载量超过一百万，只要我适当地不具体，我就可以组合和披露。

从我们的数据来看，目前美国、加拿大和欧洲的用户细分大致如下：

*   iOS 6.0.x — 76%
*   iOS 5.1.x — 17%
*   iOS 4.x — 4%
*   iOS 5.0.x — 2%

全球——就我们的用户而言，这主要意味着添加拉丁美洲，所以这是整个美洲和欧洲——看起来更像：

*   iOS 6.0.x — 44%
*   iOS 5.1.x — 43%
*   iOS 4.x — 8%
*   iOS 5.0.x — 4%

到目前为止，6.1 的数字可以忽略不计，但我认为我们的聚合可能会有一点延迟。

也就是说，这两组数字并不完全一样。所有产品都相似，但那些贡献最高数字的产品比其他产品更受欢迎。

如果我不得不推测，我会说更受欢迎的应用程序应该看到更不平衡的曲线并不是不合理的，因为它们更有可能被仅仅浏览商店的人试用，而最近购买硬件的人更有可能浏览商店。但这只是即兴猜测，我没有任何统计依据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-02T01:01:39.933

显然，每次更新的采用率都会随着时间而变化，但在撰写本文时，这里有一些来自 Onswipe 的数据（日期为 2013 年 1 月 30 日），

[http://techcrunch.com/2013/01/30/ios-6-1-adoption-on-track-to-be-fastest-yet-says-onswipe-with-22-of-users-on-board- 36 小时内/](http://techcrunch.com/2013/01/30/ios-6-1-adoption-on-track-to-be-fastest-yet-says-onswipe-with-22-of-users-on-board-in-36-hours/)

这是来自 Apple 的一些信息（日期为 2013 年 1 月 28 日），

[http://www.macrumors.com/2013/01/28/nearly-300-million-devices-running-ios-6-60-of-all-ios-devices-ever/](http://www.macrumors.com/2013/01/28/nearly-300-million-devices-running-ios-6-60-of-all-ios-devices-ever/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-05-15T08:21:47.097

我不确定现在回答这个问题为时已晚，但我在 Apple 支持中心找到了一个链接，其中显示了节俭的统计数据。

![iOS 采用率统计](../Images/4bdb6eb7700d5ce7c83599b793835512.png)

链接在这里：[https ://developer.apple.com/support/appstore/](https://developer.apple.com/support/appstore/)

# magento - Magento 1.7 尝试从后端的块中渲染内容

> ID：14657487
> 
> 赞同：1
> 
> 时间：2013-02-02T00:57:46.330
> 
> 标签：magento

**已解决：** 愚蠢的我，我启用了编译...将其关闭并且事情按预期工作。无论如何谢谢你的时间:)

我要疯了。我一直在尝试一切（除了正确的）以使其正常工作，但除了标准菜单之外没有呈现任何内容。我正在尝试创建一个在后端呈现“hello”的简单块，例如，如果我复制如果我从 catalog.xml 复制 Mage 的块，它工作正常

```
<block type="adminhtml/catalog_product" name="products_list"> 
```

请指教。

配置文件

```
<?xml version="1.0"?>

<config>
    <modules>
        <Wish_Scheduleproduct>
            <version>0.0.1</version>
        </Wish_Scheduleproduct>
    </modules>
    <global>
        <models>
            <scheduleproduct>
                <class>Wish_Scheduleproduct_Model</class>
            </scheduleproduct>
        </models>
        <helpers>
            <scheduleproduct>
                <class>Wish_Scheduleproduct_Helper</class>
            </scheduleproduct>
        </helpers>
        <blocks>
            <scheduleproduct>
                <class>Wish_Scheduleproduct_Block</class>
            </scheduleproduct>
        </blocks>
    </global>
    <frontend>
        <routers>
            <scheduleproduct>
                <use>standard</use>
                <args>
                    <module>Wish_Scheduleproduct</module>
                    <frontName>scheduleproduct</frontName>
                </args>
            </scheduleproduct>
        </routers>
        <layout>
            <updates>
                <wish_scheduleproduct>
                    <file>scheduleproduct.xml</file>
                </wish_scheduleproduct>
            </updates>
        </layout>
    </frontend>
    <admin>
        <routers>
            <scheduleproduct>
                <use>admin</use>
                <args>
                    <module>Wish_Scheduleproduct</module>
                    <frontName>scheduleproduct</frontName>
                </args>
            </scheduleproduct>
        </routers>
    </admin>
    <adminhtml>
        <layout>
            <updates>
                <scheduleproduct>
                    <file>scheduleproduct.xml</file>
                </scheduleproduct>
            </updates>
        </layout>
        <menu>
            <scheduleproduct translate="title">
                <title>Schedule product</title>
                <sort_order>40</sort_order>
                <depends>
                    <module>Wish_Scheduleproduct</module>
                </depends>
                <children>
                    <openings translate="title">
                        <title>Handle open hours</title>
                        <action>scheduleproduct/admin_schedule</action>
                        <sort_order>1</sort_order>
                    </openings>
                </children>
            </scheduleproduct>
        </menu>
    </adminhtml>
</config> 
```

scheduleproduct.xml（布局更新）

```
<?xml version="1.0"?>

<layout version="0.1.0">
    <scheduleproduct_admin_schedule_index>
        <reference name="menu">
            <action method="setActive"><menupath>scheduleproduct/openings</menupath></action>
        </reference>
        <reference name="content">
            <block type="scheduleproduct/admin_test" name="myTester" />
        </reference>
    </scheduleproduct_admin_schedule_index>
</layout> 
```

调度控制器.php

```
class Wish_Scheduleproduct_Admin_ScheduleController extends Mage_Adminhtml_Controller_Action
{
    public function indexAction()
    {
        $this->loadLayout();
        $this->renderLayout();

    }
} 
```

街区

```
<?php

class Wish_Scheduleproduct_Block_Admin_Test extends Mage_Adminhtml_Block_Template
{
    protected function _construct()
    {
        echo "Hello";;      
    }
} 
```

[文件树在这里： http](http://i.stack.imgur.com/N0QLG.png) ://i.stack.imgur.com/N0QLG.png

谢谢您的帮助！

我检查了从方法 mageFindClassFile 生成的包含路径，它似乎不包含块路径。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T02:31:01.333

我重新创建了您的模块结构，并为我成功地将一个块添加到页面中。[在此处](http://alanstorm.com/2013/projects/Wish_Scheduleproduct.tar)下载存档并与您自己的版本进行比较。我看到的三个可能的罪魁祸首是

1.  如果你有另一个模块添加一个名为 的块`myTester`，可能会发生奇怪的事情

2.  你没有提到你在哪里`scheduleproduct.xml`。确保它在正确的位置并由 Magento 处理

3.  您的块文件`echo "hello"`在构造函数中有一个。这会起作用，但它会在页面顶部打印出“你好”这个词。它不会向内容区域添加内容。如果您想将内容添加到内容区域，请`_toHtml`返回一个字符串。（有关此示例，请参见链接模块）

![在此处输入图像描述](../Images/c5bd8dd9074e839bb210809ba8fbd785.png)

# android - 如何通过旋转正确保留 DialogFragment？

> ID：14657490
> 
> 赞同：76
> 
> 时间：2013-02-02T00:58:16.003
> 
> 标签：android, android-fragments, android-fragmentactivity, android-dialogfragment

我有一个承载 DialogFragment 的 FragmentActivity。

DialogFragment 执行网络请求并处理 Facebook 身份验证，因此我需要在轮换期间保留它。

我已经阅读了与此问题相关的所有其他问题，但没有一个真正解决了这个问题。

我正在使用 putFragment 和 getFragment 来保存 Fragment 实例并在重新创建活动期间再次获取它。

但是，我总是在 onRestoreInstanceState 中调用 getFragment 时遇到空指针异常。我还想防止对话框在旋转过程中被关闭，但到目前为止我什至无法保留它的实例。

任何想法出了什么问题？

这是我的代码目前的样子：

```
public class OKLoginActivity extends FragmentActivity implements OKLoginDialogListener
{

    private OKLoginFragment loginDialog;
    private static final String TAG_LOGINFRAGMENT = "OKLoginFragment";

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        FragmentManager fm = getSupportFragmentManager();

        if(savedInstanceState == null)
        {
            loginDialog = new OKLoginFragment(); 
            loginDialog.show(fm, TAG_LOGINFRAGMENT);
        }
    }

    @Override
    public void onSaveInstanceState(Bundle outState)
    {
        getSupportFragmentManager().putFragment(outState,TAG_LOGINFRAGMENT, loginDialog);
    }

    @Override
    public void onRestoreInstanceState(Bundle inState)
    {
        FragmentManager fm = getSupportFragmentManager();
        loginDialog = (OKLoginFragment) fm.getFragment(inState, TAG_LOGINFRAGMENT);
    }

} 
```

这是异常堆栈跟踪：

```
02-01 16:31:13.684: E/AndroidRuntime(9739): FATAL EXCEPTION: main
02-01 16:31:13.684: E/AndroidRuntime(9739): java.lang.RuntimeException: Unable to start activity ComponentInfo{io.openkit.example.sampleokapp/io.openkit.OKLoginActivity}: java.lang.NullPointerException
02-01 16:31:13.684: E/AndroidRuntime(9739):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2180)
02-01 16:31:13.684: E/AndroidRuntime(9739):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2230)
02-01 16:31:13.684: E/AndroidRuntime(9739):     at android.app.ActivityThread.handleRelaunchActivity(ActivityThread.java:3692)
02-01 16:31:13.684: E/AndroidRuntime(9739):     at android.app.ActivityThread.access$700(ActivityThread.java:141)
02-01 16:31:13.684: E/AndroidRuntime(9739):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1240)
02-01 16:31:13.684: E/AndroidRuntime(9739):     at android.os.Handler.dispatchMessage(Handler.java:99)
02-01 16:31:13.684: E/AndroidRuntime(9739):     at android.os.Looper.loop(Looper.java:137)
02-01 16:31:13.684: E/AndroidRuntime(9739):     at android.app.ActivityThread.main(ActivityThread.java:5039)
02-01 16:31:13.684: E/AndroidRuntime(9739):     at java.lang.reflect.Method.invokeNative(Native Method)
02-01 16:31:13.684: E/AndroidRuntime(9739):     at java.lang.reflect.Method.invoke(Method.java:511)
02-01 16:31:13.684: E/AndroidRuntime(9739):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:793)
02-01 16:31:13.684: E/AndroidRuntime(9739):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:560)
02-01 16:31:13.684: E/AndroidRuntime(9739):     at dalvik.system.NativeStart.main(Native Method)
02-01 16:31:13.684: E/AndroidRuntime(9739): Caused by: java.lang.NullPointerException
02-01 16:31:13.684: E/AndroidRuntime(9739):     at android.support.v4.app.FragmentManagerImpl.getFragment(FragmentManager.java:528)
02-01 16:31:13.684: E/AndroidRuntime(9739):     at io.openkit.OKLoginActivity.onRestoreInstanceState(OKLoginActivity.java:62)
02-01 16:31:13.684: E/AndroidRuntime(9739):     at android.app.Activity.performRestoreInstanceState(Activity.java:910)
02-01 16:31:13.684: E/AndroidRuntime(9739):     at android.app.Instrumentation.callActivityOnRestoreInstanceState(Instrumentation.java:1131)
02-01 16:31:13.684: E/AndroidRuntime(9739):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2158) 
```

* * *

## 回答 #1

> 赞同：149
> 
> 时间：2013-03-16T01:15:25.577

在您的内部，使用值`DialogFragment`调用。您不需要手动保存片段，框架已经处理了所有这些。调用这将防止您的片段在旋转时被破坏，并且您的网络请求将不受影响。[`Fragment.setRetainInstance(boolean)`](http://developer.android.com/reference/android/app/Fragment.html#setRetainInstance%28boolean%29)`true`

由于兼容性库的[错误](https://code.google.com/p/android/issues/detail?id=17423)，您可能必须添加此代码以阻止您的对话框在旋转时被关闭：

```
@Override
public void onDestroyView() {
    Dialog dialog = getDialog();
    // handles https://code.google.com/p/android/issues/detail?id=17423
    if (dialog != null && getRetainInstance()) {
        dialog.setDismissMessage(null);
    }
    super.onDestroyView();
} 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2013-09-23T08:13:04.120

`dialogFragment`与仅使用相比，使用的优点之一`alertDialogBuilder`正是因为对话片段可以在旋转时自动重新创建自己，而无需用户干预。

但是，当 dialogfragment 没有重新创建自身时，您可能会覆盖`onSaveInstanceState`但没有调用`super`：

```
@Override
protected void onSaveInstanceState(Bundle outState) {
    super.onSaveInstanceState(outState); // <-- must call this if you want to retain dialogFragment upon rotation
    ...
} 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2017-05-28T16:47:06.257

这是使用安东尼回答中的修复的便捷方法：

```
public class RetainableDialogFragment extends DialogFragment {

    public RetainableDialogFragment() {
        setRetainInstance(true);
    }

    @Override
    public void onDestroyView() {
        Dialog dialog = getDialog();
        // handles https://code.google.com/p/android/issues/detail?id=17423
        if (dialog != null && getRetainInstance()) {
            dialog.setDismissMessage(null);
        }
        super.onDestroyView();
    }
} 
```

只要让你`DialogFragment`扩展这个类，一切都会好起来的。如果您`DialogFragments`的项目中有多个都需要此修复，这将变得特别方便。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-12-08T10:32:20.687

如果没有任何帮助，并且您需要一个可行的解决方案，您可以安全地进行，每次打开对话框时都将其基本信息保存到活动 ViewModel（并在您关闭对话框时将其从该列表中删除）。此基本信息可能是对话框类型和一些 id（打开此对话框所需的信息）。此 ViewModel 在 Activity 生命周期更改期间不会被销毁。假设用户打开一个对话框以留下对餐厅的引用。所以对话类型是 LeaveReferenceDialog，id 是餐厅 id。打开此对话框时，将此信息保存在可以调用 DialogInfo 的 Object 中，并将此对象添加到 Activity 的 ViewModel。此信息将允许您在调用活动 onResume() 时重新打开对话框：

```
// On resume in Activity
    override fun onResume() {
            super.onResume()

            // Restore dialogs that were open before activity went to background
            restoreDialogs()
        } 
```

哪个电话：

```
 fun restoreDialogs() {
    mainActivityViewModel.setIsRestoringDialogs(true) // lock list in view model

    for (dialogInfo in mainActivityViewModel.openDialogs)
        openDialog(dialogInfo)

    mainActivityViewModel.setIsRestoringDialogs(false) // open lock
} 
```

当 ViewModel 中的 IsRestoringDialogs 设置为 true 时，对话框信息将不会添加到视图模型中的列表中，这很重要，因为我们现在正在恢复该列表中已经存在的对话框。否则，在使用时更改列表会导致异常。所以：

```
// Create new dialog
        override fun openLeaveReferenceDialog(restaurantId: String) {
            var dialog = LeaveReferenceDialog()
            // Add id to dialog in bundle
            val bundle = Bundle()
            bundle.putString(Constants.RESTAURANT_ID, restaurantId)
            dialog.arguments = bundle
            dialog.show(supportFragmentManager, "")

            // Add dialog info to list of open dialogs
            addOpenDialogInfo(DialogInfo(LEAVE_REFERENCE_DIALOG, restaurantId))
    } 
```

然后在关闭它时删除对话框信息：

```
// Dismiss dialog
override fun dismissLeaveReferenceDialog(Dialog dialog, id: String) {
   if (dialog?.isAdded()){
      dialog.dismiss()
      mainActivityViewModel.removeOpenDialog(LEAVE_REFERENCE_DIALOG, id)
   }
} 
```

在 Activity 的 ViewModel 中：

```
fun addOpenDialogInfo(dialogInfo: DialogInfo){
    if (!isRestoringDialogs){
       val dialogWasInList = removeOpenDialog(dialogInfo.type, dialogInfo.id)
       openDialogs.add(dialogInfo)
     }
}

fun removeOpenDialog(type: Int, id: String) {
    if (!isRestoringDialogs)
       for (dialogInfo in openDialogs) 
         if (dialogInfo.type == type && dialogInfo.id == id) 
            openDialogs.remove(dialogInfo)
} 
```

您实际上以相同的顺序重新打开了之前打开的所有对话框。但是他们如何保留他们的信息呢？每个对话框都有自己的 ViewModel，它在 Activity 生命周期中也不会被销毁。因此，当您打开对话框时，您将获得 ViewModel 并像往常一样使用对话框的此 ViewModel 初始化 UI。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-08-18T18:22:15.123

这里的大多数答案都是不正确的，因为它们使用 setRetainInstance(true)，但现在从[API 28](https://developer.android.com/reference/android/app/Fragment.html#setRetainInstance%28boolean%29)开始不推荐使用。这是我正在使用的解决方案：

```
fun isDialogVisible(fm: FragmentManager): Boolean {
    val dialog = fm.findFragmentByTag("<FRAGMENT_TAG>")
    return dialog?.isResumed ?: false
} 
```

如果函数返回 false，则只需调用 dialog.show(fm, "<FRAGMENT_TAG>") 再次显示它。

# android - 如何在Android上获取当前播放曲目的路径

> ID：14657496
> 
> 赞同：3
> 
> 时间：2013-02-02T00:59:55.537
> 
> 标签：android, streaming

我想编写一个应用程序将当前播放的音乐流式传输到另一台设备。两个设备之间的连接确实有效，我也可以通过 wifi 传输一些字符串，但我在获取当前曲目时遇到了问题。

我使用[此博客](http://blog.dexetra.com/2010/09/get-current-playing-track-info-from.html)的代码来获取当前播放曲目的一些信息，但我无法获取文件的路径。

我认为当我收到专辑、曲目或艺术家时，应该可以找到路径。但我试了又试，没有找到任何东西。所以我问：是否有可能通过接收器获得路径？如果没有，还有其他方法可以获取当前曲目及其路径吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2015-12-14T14:07:35.853

我为此搜索了很多，我找到了很多解决方案，但它们对我不起作用。最后我使用了所有现有解决方案的组合并且它起作用了。您必须在您的应用程序中添加所有其他播放器。然后它将为您返回当前正在播放的歌曲的标题（如果您的歌曲没有标题，它将返回文件名）：

```
intent.getStringExtra("track") 
```

最后查询这首特定歌曲，您可以访问有关这首歌曲的所有信息，当然还有它的路径。如果它适合你，请告诉我。这对我有用：

```
public class GetMusic extends AppCompatActivity {
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.get_music);

    IntentFilter iF = new IntentFilter();
    iF.addAction("com.android.music.playstatechanged");
    iF.addAction("com.htc.music.playstatechanged");
    iF.addAction("fm.last.android.playstatechanged");
    iF.addAction("com.sec.android.app.music.playstatechanged");
    iF.addAction("com.nullsoft.winamp.playstatechanged");
    iF.addAction("com.amazon.mp3.playstatechanged");
    iF.addAction("com.miui.player.playstatechanged");
    iF.addAction("com.real.IMP.playstatechanged");
    iF.addAction("com.sonyericsson.music.playstatechanged");
    iF.addAction("com.rdio.android.playstatechanged");
    iF.addAction("com.samsung.sec.android.MusicPlayer.playstatechanged");
    iF.addAction("com.andrew.apollo.playstatechanged");
    iF.addAction("gonemad.dashclock.music.playstatechanged");
    iF.addAction("com.piratemedia.musicmod.playstatechanged");
    iF.addAction("com.tbig.playerpro.playstatechanged");
    iF.addAction("org.abrantix.rockon.rockonnggl.playstatechanged");
    iF.addAction("com.maxmpz.audioplayer.playstatechanged");
    iF.addAction("com.doubleTwist.androidPlayer.playstatechanged");
    iF.addAction("com.lge.music.playstatechanged"); 
    registerReceiver(mReceiver, iF);
  }
    private BroadcastReceiver mReceiver = new BroadcastReceiver() {
    @Override
    public void onReceive(Context context, Intent intent) {
        Uri mAudioUri = MediaStore.Audio.Media.EXTERNAL_CONTENT_URI;
        String selection = MediaStore.Audio.Media.TITLE + " == \"" + intent.getStringExtra("track") + "\"";
        String[] STAR = { "*" };
        Cursor cursor = getContentResolver().query(mAudioUri,STAR, selection, null, null);
        if (cursor != null && cursor.getCount() > 0) {
            cursor.moveToFirst();
            if (cursor.getColumnIndex(MediaStore.Audio.Media.TITLE) != -1) {
                String fullpath = cursor.getString(cursor
                        .getColumnIndex(MediaStore.Audio.Media.DATA));
                Toast.makeText(getApplicationContext(),"song path: " + fullpath,Toast.LENGTH_LONG).show();
            }
        }
    }
  };
} 
```

# python - 在 mutt 中使用 python 创建多部分/替代邮件

> ID：14657498
> 
> 赞同：5
> 
> 时间：2013-02-02T01:00:14.017
> 
> 标签：python, mime, mutt

我想`text/plain`使用 Markdown 格式创建一条消息，并将其转换为从 Markdown 生成部分的`multipart/alternative`消息。`text/html`我尝试使用 filter 命令通过创建消息的 python 程序对其进行过滤，但似乎消息没有正确发送。代码如下（这只是测试代码，看看我是否可以`multipart/alternative`发送消息。

```
import sys
from email.mime.text import MIMEText
from email.mime.multipart import MIMEMultipart

html = """<html>
          <body>
          This is <i>HTML</i>
          </body>
          </html>
"""

msgbody = sys.stdin.read()

newmsg = MIMEMultipart("alternative")

plain = MIMEText(msgbody, "plain")
plain["Content-Disposition"] = "inline"

html = MIMEText(html, "html")
html["Content-Disposition"] = "inline"

newmsg.attach(plain)
newmsg.attach(html)

print newmsg.as_string() 
```

不幸的是，在 mutt 中，您只能在撰写时将消息正文发送到过滤器命令（不包括标题）。一旦我得到这个工作，我认为降价部分不会太难。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-30T02:41:25.930

**更新**：有人写了一篇关于配置 mutt 以与 python 脚本一起使用的文章。我自己从来没有做过。[hashcash 和 mutt](http://pthree.org/2011/03/24/hashcash-and-mutt/)，文章详细介绍了 muttrc 的配置，并给出了代码示例。

* * *

**旧答案**

它解决了你的问题吗？

```
#!/usr/bin/env python

from email.mime.text import MIMEText
from email.mime.multipart import MIMEMultipart

# create the message
msg = MIMEMultipart('alternative')
msg['Subject'] = "My subject"
msg['From'] = "foo@example.org"
msg['To'] = "bar@example.net"

# Text of the message
html = """<html>
          <body>
          This is <i>HTML</i>
          </body>
          </html>
"""
text="This is HTML"

# Create the two parts
plain = MIMEText(text, 'plain')
html = MIMEText(html, 'html')

# Let's add them
msg.attach(plain)
msg.attach(html)

print msg.as_string() 
```

我们保存并测试程序。

```
python test-email.py 
```

这使：

```
Content-Type: multipart/alternative;
 boundary="===============1440898741276032793=="
MIME-Version: 1.0
Subject: My subject
From: foo@example.org
To: bar@example.net

--===============1440898741276032793==
Content-Type: text/plain; charset="us-ascii"
MIME-Version: 1.0
Content-Transfer-Encoding: 7bit

This is HTML
--===============1440898741276032793==
Content-Type: text/html; charset="us-ascii"
MIME-Version: 1.0
Content-Transfer-Encoding: 7bit

<html>
          <body>
          This is <i>HTML</i>
          </body>
          </html>

--===============1440898741276032793==-- 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-12-01T14:45:16.770

看起来 Mutt 1.13 能够`multipart/alternative`从外部脚本创建一个。[http://www.mutt.org/relnotes/1.13/](http://www.mutt.org/relnotes/1.13/)

# jpa - 添加新的关联 JPA 实体尝试插入具有空 id 的行

> ID：14657499
> 
> 赞同：1
> 
> 时间：2013-02-02T01:00:17.343
> 
> 标签：jpa, spring-data, spring-data-jpa

我有 2 个类似于以下内容的 JPA 实体：

```
@Entity
class Customer {
   @Id
   @GeneratedValue
   Long id

   @OneToOne(cascade = CascadeType.ALL)
   @PrimaryKeyJoinColumn
   CustomerInformation customerInformation
}

@Entity
class CustomerInformation {
   @Id
   @OneToOne
   @JoinColumn(name = "id")
   Customer customer

   String firstName
   String lastName
} 
```

我正在使用 spring-data-jpa 来生成我的 DAO 层。在这里，虽然它不是很有趣：

```
public interface CustomerRepository extends CrudRepository<Customer, Long> {
} 
```

我在 spring 上下文中调用它并使用 @Transactional 注释来告诉 JPA 提供程序何时将事务提交到数据库。为了测试，我使用@PersistenceContext 抓取实体管理器并手动刷新它以结束事务。由于我们应用程序的性质，数据库中可能存在一个客户，但没有与之关联的 customerInformation 对象。如果我在同一个事务中创建一个新客户和一个 customerInformation 对象，事情就会像我预期的那样工作。例如，这有效：

```
@Transactional
public void createNewCustomer() {
   Customer cust = new Customer();
   CustomerInformation custInf = new CustomerInformation;
   custInf.setCustomer(cust);
   custInf.setFirstName("asdf");
   custInf.setLastName("hjkl");

   cust.setCustomerInformation(custInf);

   customerRepository.save(cust);
} 
```

但是，如果我想更新现有客户，我会遇到一个问题，即它尝试插入具有空 id 的 CustomerInformation 对象。例如，这惨遭失败：

```
@Transactional
public void updateExistingCustomer(Long userId) {

   Customer foundCustomer = customerRepository.findOne(userId);

   if (foundCustomer.getCustomerInformation() == null) {
      CustomerInformation custInf = new CustomerInformation();
      custInf.setCustomer(foundCustomer);
      custInf.setFirstName("asdf");
      custInf.setLastName("hjkl");

      cust.setCustomerInformation(custInf);

      customerRepository.save(foundCustomer);
   }
} 
```

这失败并显示错误消息：

```
Hibernate: insert into CustomerInformation (firstName, lastName, id) values (?, ?, ?)
Feb 1, 2013 7:40:12 PM org.hibernate.engine.jdbc.spi.SqlExceptionHelper logExceptions
WARN: SQL Error: 20000, SQLState: 23502
Feb 1, 2013 7:40:12 PM org.hibernate.engine.jdbc.spi.SqlExceptionHelper logExceptions
ERROR: Column 'ID'  cannot accept a NULL value. 
```

我是不是误会了什么？任何帮助表示赞赏。

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T01:12:22.230

您也应该将`Id`字段标记为*生成的值*，因此 hibernate 会为它提供一些值：

```
@Entity
class Customer {
   @Id
   @GeneratedValue // !!!
   Long id

...

@Entity
class CustomerInformation {
   @Id
   @GeneratedValue // !!!
   @OneToOne
   @JoinColumn(name = "id")
   Customer customer

... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T23:03:15.413

我将实体修改为如下所示：

```
@Entity
class CustomerInformation {

    @Id
    Long id

    @MapsId
    @OneToOne
    @JoinColumn(name = "id")
    Customer customer

    String firstName
    String lastName
} 
```

一切正常。据我所知，这两个版本`CustomerInformation`都会产生相同的 SQL，除了第二个版本模拟实际的 id，我不一定需要它。我将在另一个问题中对此进行扩展，但上面的代码解决了我的问题。

# c# - Telerik DelegateCommand 在 WPF 中的用法

> ID：14657507
> 
> 赞同：0
> 
> 时间：2013-02-02T01:01:02.033
> 
> 标签：c#, wpf, mvvm, telerik, icommand

我有点坚持正确使用`Telerik.Windows.Controls DelegateCommand`

我有以下设置，可以编译，但我更关心的是，我是否正确使用它。我已经在 Online Doc 中搜索了一段时间，但找不到任何示例。

特别是，我对如何使用`CanSaveAuthorization`或底层`CanExecute`以及如何处理所需的 object 参数感到困惑。

谢谢，

```
 public class CreateAuthorizationViewModel : ViewModelBase
    {
        private Authorization authorization;
        private AuthorizationRepository authorizationRepository;
        private DelegateCommand saveAuthorizationCommand;

        public DelegateCommand SaveAuthorizationCommand
        {
            get
            {
                return saveAuthorizationCommand;
            }
        }

        public CreateAuthorizationViewModel()
        {
            InitializeCommand(); 
        }

        private void InitializeCommand()
        {
            saveAuthorizationCommand = new DelegateCommand(SaveAuthorization, CanSaveAuthorization);           
        }

        private void SaveAuthorization(object parameter)
        {
            authorizationRepository.Save();
        }

        private bool CanSaveAuthorization(object parameter)
        {
            //I would have validation logic here
            return true;
        }
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T10:19:54.233

`DelegateCommand`实现`ICommand`接口。这意味着它可以绑定到 WPF 控件的 Command 属性，例如`Button`. CanExecute 方法（在您的情况下为 CanSaveAuthorization）可以评估是否允许执行 Execute 方法（在您的情况下为 SaveAuthorization），如果没有，则该按钮将在视图中被禁用。type 的参数在`object`这里可能会有所帮助。我从未使用过 Telerik 的实现，但我认为这是`CommandParameter`可以在视图中设置的控件属性的值。如果您有一个始终返回 true 的 CanExecute 方法，那么您不妨将其全部删除。

如果您使用 google 搜索，您可能会找到更多信息和示例`RelayCommand`。这大概是 Telerik 所基于的模式`DelegateCommand`。我的版本`DelegateCommand`有一个没有`parameter`参数的重载。然后 CanExecute 方法需要视图模型中可用的信息来确定 CanExecute 状态。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T14:27:05.537

这有点废话，但您可以摆脱对 InitializeCommand 函数的需要：

```
public DelegateCommand SaveAuthorizationCommand
{
    get
    {
        return saveAuthorizationCommand ??
               (saveAuthorizationCommand = new DelegateCommand(SaveAuthorization, CanSaveAuthorization));
    }
} 
```

# pyparsing - 从更大的集合中选择一些数据

> ID：14657512
> 
> 赞同：1
> 
> 时间：2013-02-02T01:01:28.050
> 
> 标签：pyparsing

有人可以指出一个使用 pyparsing 从更大的集合中处理所需数据的示例吗？aa Parse Action 是使用“if”语句的正确方法吗？

考虑一下关于 Pyparsing 的 Oreilly 小册子中给出的大学和游戏分数表。它有佛罗里达州立大学和其他大学的数据。假设佛罗里达州、佛罗里达州和南佛罗里达州都在随机位置的表格中。您将如何处理佛罗里达学校的结果？

稍后在文档中对所有数据使用循环，我可以将 if 语句放在那里，但我觉得我可能不明白何时使用 Parse Action。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T06:04:00.533

您可以使用解析操作向已匹配定义的解析规则的数据添加进一步验证，但可能会使某些语义规则失败。这是一个在匹配任何整数的表达式上使用解析操作的情况，但解析操作只允许偶数：

```
from pyparsing import *

integer = Word(nums).setParseAction(lambda t:int(t[0]))

even_integer = integer.copy()
def onlyEvensAllowed(tokens):
    if tokens[0] % 2 != 0:
        # reject this integer by raising a ParseException
        raise ParseException('only even numbers allowed')
even_integer.addParseAction(onlyEvensAllowed)

sample = "92873 234 2934 2934 292394 239847 293879237 2398 293492"

number = even_integer | integer.suppress()
print OneOrMore(number).parseString(sample) 
```

印刷：

```
[234, 2934, 2934, 292394, 2398, 293492] 
```

在大学比赛分数的情况下，您可以执行类似的过滤解析操作，仅接受包含字符串“Florida”的大学名称，如果不接受则引发 ParseException。

# javascript - Jquery 和 Ajax 删除确认框

> ID：14657517
> 
> 赞同：3
> 
> 时间：2013-02-02T01:02:27.703
> 
> 标签：javascript, jquery, ajax

我需要这个帮助。我的功能与 ajax 配合得很好，但在发送 ajax 请求之前我需要一个确定/取消删除确认框，以便从数据库中删除项目。这是我的代码：

```
delete_article = function(article_id){
     $.ajax({
           type:"POST",
           url: "<?php echo base_url()?>admin/article/delete_article",
           data: "article_id="+article_id,
           asynchronous: true,
           cache: false,
           beforeSend: function(){

           },
          success: function(){
              $('#articletr'+article_id).hide();

          }

         });
    }
}) 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-02T01:07:51.553

```
var answer = confirm ("Are you sure you want to delete from the database?");
if (answer)
{
     // your ajax code
} 
```

如果您想使用 JQuery 更好地控制这些类型的模式对话框提示（按钮表示 OK/cancel 以外的内容、两个以上按钮或不同样式），您可以使用[JQuery UI Modal Confirmation](http://jqueryui.com/dialog/#modal-confirmation)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-02T01:08:29.590

最简单的方法是使用内置的 javascript 方法`confirm`：

```
if (confirm("Really send?")) {
    // Do it!
} 
```

由于那些本机浏览器对话框的历史非常丑陋并且根本无法设置样式，因此它们通常被避免使用其他方法。一个很好的例子是 JQuery UI 的Dialog[小](http://jqueryui.com/)[部件](http://jqueryui.com/dialog/#modal-confirmation)

# python - 如何使用 IPython 重新加载和自动重新加载？

> ID：14657520
> 
> 赞同：3
> 
> 时间：2013-02-02T01:03:06.890
> 
> 标签：python, ipython

我刚刚安装了 IPython 0.13.1 并且遇到了两个问题。我有一个小的“演示”项目，其中包含一个名为“app”的应用程序：

```
.
├── app
│   ├── __init__.py
│   ├── __init__.pyc
│   ├── models.py
│   ├── models.pyc
│   ├── tests.py
│   └── views.py
├── demo
│   ├── __init__.py
│   ├── __init__.pyc
│   ├── settings.py
│   ├── settings.pyc
│   ├── urls.py
│   └── wsgi.py
└── manage.py 
```

models.py 包含：

```
from django.db import models

class Customer(models.Model):
    fname = models.CharField(max_length=25) 
```

我的第一个问题是在我进行更改后重新加载 models.py 文件。如果我打开 IPython，导入我的 Customer 类，并尝试重新加载模型模块，我会收到以下错误：

```
In [1]: from app.models import Customer
In [2]: reload(app.models)
--------------------------------------------------
NameError                    Traceback(most recent call last)
/Users/me/dotfiles/.virtualenvs/demo/lib/.../shell.pyc in <module>()
----> 1 reload(app.models)

NameError: name 'app' is not defined 
```

虽然我是 Python 新手，但我确实相信“模型”是模块，而且它在我的 INSTALLED_APPS 设置中。我也试过 reload(app) 和 reload(models) 没有成功。我究竟做错了什么？

我的第二个问题是使用自动重载。阅读文档页面后，我这样启用它：

```
In [1]: %load_ext autoreload
In [2]: %autoreload 2 
```

现在，如果我创建一个测试文件“foo.py”，其中包含文档说明的某些函数，那么我对该函数所做的任何更改都会反映在 IPython 中。但是，如果我导入我的 Customer 类（如上所示）并向其添加第二个字段“lname”并保存文件，则该更改不会反映在 IPython 中。如果我运行命令“客户？？”，则不会显示更改。另外，如果我运行 aimport 命令，我会看到：

```
In [5]: %load_ext autoreload
In [6]: %autoreload 2
In [7]: %aimport
Modules to reload:
all-except-skipped

Modules to skip: 
```

我究竟做错了什么？[这是这里](https://stackoverflow.com/questions/890924/how-do-you-reload-a-django-model-module-using-the-interactive-interpreter-via-m/903943#903943)讨论的 AppCache 问题吗？我尝试实现显示的脚本，但运行它时会引发错误。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T02:01:59.227

对于您的第一个问题，您不能`reload(app.models)`因为您没有添加`app.models`到您的命名空间。您只添加了`Customer`. 你可以添加`import app.models`来解决这个问题。

我认为你的第二个问题是相关的。由于您将实际类导入命名空间，因此重新加载无济于事。大概重新加载只是替换了命名空间中的模块，所以如果你引用`models.Customer`而不是直接使用`Customer`你应该是在做生意。

# xcode - Git 不显示文件已修改或让我在 Xcode 中提交

> ID：14657523
> 
> 赞同：2
> 
> 时间：2013-02-02T01:03:27.340
> 
> 标签：xcode, git

我在 Xcode 上的源代码控制中遇到了这个随机问题。我已经将 Git 集成到我的项目中，但现在它没有意识到对某些文件进行了更改，并且不会让我提交它们。

A永远不会变成M，文件不会变灰，表明它需要保存。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T14:00:47.643

一般有2种可能：

*   您的文件已添加到`.gitignore`文件中，
*   或者他们的索引不再设置为更新：
    请参阅“[如何进行提交或永久更改本地](https://stackoverflow.com/a/14456667/6309)”。

```
git update-index --assume-unchanged -- /path/to/file
＃ 或者：
git update-index --skip-worktree -- /path/to/file

```

第一个检查是查看 shell 会话中的 git status 是否显示相同的问题（修改后的文件不会显示在 中`git status`）

# r - 是否可以将 sapply 与 R 中的一个约束结合起来？

> ID：14657526
> 
> 赞同：1
> 
> 时间：2013-02-02T01:03:48.277
> 
> 标签：r

我正在拟合不同的模型，然后我想从包车中计算 VIF。VIF 在公式中需要多个回归量，因此会返回错误。这个想法是在运行函数之前检查是否有多个回归量。或者，我可以尝试按回归量的数量对模型进行排序，以便仅从第 i 个位置开始调用 VIF 函数。

我的代码是：

```
ctl <- c(4.17,5.58,5.18,6.11,4.50,4.61,5.17,4.53,5.33,5.14)
trt <- c(4.81,4.17,4.41,3.59,5.87,3.83,6.03,4.89,4.32,4.69)
ot=rnorm(length(trt))
ot2=rnorm(length(trt))
DF=as.data.frame(cbind(ot,ot2,ctl,trt))
y=colnames(DF[1])
x = colnames(DF)
x = x[! x %in% y]
n = length(x)

id = unlist(
  lapply(1:n,
         function(i)combn(1:n,i,simplify=F)
  )
  ,recursive=F)

models = sapply(id,function(i)
  paste(y,paste(x[i],collapse="+"), sep="~")
)

allModelsResults=lapply(models, function(i) 
  lm(as.formula(i), data=DF))

library(car)
vif.r=sapply(allModelsResults,vif) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-02T01:44:16.143

这有效：

```
sapply(allModelsResults,
       function(mod) if (length(labels(terms(mod))) < 2) NA else vif(mod))

# [[1]]
# [1] NA
# 
# [[2]]
# [1] NA
# 
# [[3]]
# [1] NA
# 
# [[4]]
#      ot2      ctl 
# 1.157776 1.157776 
# 
# [[5]]
#      ot2      trt 
# 1.439415 1.439415 
# 
# [[6]]
#      ctl      trt 
# 1.264959 1.264959 
# 
# [[7]]
#     ot2     ctl     trt 
# 1.47575 1.29689 1.61237 
```

请注意，`length(labels(terms(mod))) < 2`这`vif`是用作其标准的内容，请参阅`getAnywhere(vif.lm)`。

# ios - 在 ios 6 中，如何在持有“容器视图”对象的视图控制器和嵌入其中的表视图控制器之间使用传递数据？

> ID：14657527
> 
> 赞同：6
> 
> 时间：2013-02-02T01:03:49.597
> 
> 标签：ios, view, containers

我有一个带有标签和文本字段的视图控制器。我还添加了一个容器视图，它指向另一个具有一个部分和 3 行的表视图控制器，基本上是静态表视图。我找不到任何文档/示例来告诉您如何在包含容器视图的视图控制器和嵌入在容器视图中的表视图容器之间传递数据。我要双方沟通？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-02T03:33:35.943

嵌入在容器视图（在故事板中）的控制器会自动添加为添加容器视图的控制器的 childViewController。只是为了理解我的意思，在基本控制器的 viewDidLoad 方法中添加这一行：

```
NSLog(@"children : %@", self.childViewControllers); 
```

因此，假设在 VC1 中，您添加了一个带有嵌入式控制器 VC2（您的 tableViewController）的容器视图，那么上述语句会将 VC2 记录为 VC1 的子项。要从 VC1 访问 VC2，只需使用**[self.childViewControllers objectAtIndex:0]**，要从 VC2 访问 VC1，只需使用 self.parentViewController。

希望这可以帮助

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-02T01:10:16.130

如果您在情节提要中进行设置，则使用 segues。就像故事板中的大多数其他内容一样。

请参阅[从父 iOS 访问容器视图控制器](https://stackoverflow.com/questions/13279105/access-container-view-controller-from-parent-ios)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-10-05T09:13:59.890

`[self.childViewControllers lastOject]`或者`[self.childViewControllers objectAtIndex:index];`，取决于您有多少子 VC。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-02T01:07:15.423

UIViewController -childViewControllers 和 -parentViewController 上有新的属性。你可以用那些。

或者，您可以自己建立关系。厌倦保留周期。也许父母拥有孩子，而孩子对父母的引用很弱。

# java - 这是保护密码的有效方法吗？

> ID：14657534
> 
> 赞同：-1
> 
> 时间：2013-02-02T01:05:11.340
> 
> 标签：java, google-app-engine

要登录 google app engine api，我需要提供密码。我不想在源代码中硬编码密码，所以我提供了一种从本地存储的文件中读取密码的方法。这是一种安全的方法吗？

我正在使用[google app engine remote api](http://developers.google.com/appengine/docs/java/tools/remoteapi)，它需要输入用户名/密码：

```
private String readPassword(){
    String str = "";
    try {
        BufferedReader in = new BufferedReader(new FileReader("c:\\password\\file.txt"));
         while ((str = in.readLine()) != null){         
        in.close();
         }
    } catch (IOException e) {
    }
    return str;
} 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-02-02T01:08:56.343

在 Java 中，建议使用 char 数组来存储密码。请参阅[this SO answer](https://stackoverflow.com/a/8881376/1226028)以获得很好的解释。

简而言之，字符串更容易暴露在内存转储中，而 char 数组可以在不再需要时立即被显式擦除。

# decimalformat - DecimalFormat : 用空格替换浮点数

> ID：14657537
> 
> 赞同：0
> 
> 时间：2013-02-02T01:05:29.093
> 
> 标签：decimalformat

我们需要在浏览器表格中显示货币金额，因为这些是数字，所以它们应该是右对齐的。问题在于像日本这样没有浮点货币的货币。所以对他们来说，我们不能显示 5.10 日元

现在，要求是显示如下内容：（注意十进制货币与非十进制货币的对齐和混合）

```
 5.23
 12.00
  3.24
  5
  9
 11.00 
```

在上面，5 和 9 是日元，而其他的是美元所以要求是用空格替换浮点数，用于像日元这样的货币。需要空格才能正确对齐货币。当然，对于其他货币，小数点后 2 位应该在那里。

有谁知道如何完成上述操作？

非常感谢提前！！

* * *

## 根据以下回复：

1) 值从 Java 服务器发送并馈送到 JavaScript 库 SlickGrid 2) 我们希望在服务器级别控制值，因为 SlickGrid 代码不太适合这种工作。3）货币被存储为浮动，因为客户希望以这种方式查看它们:(这是正确的，因为大多数人关心的是美元而不是美分，但是，有些人也关心美分。

我真的希望只有 DecimalFormat 有一些选项，因为那将是最好的解决方案。否则我将不得不求助于解析和字符串按摩的丑陋解决方案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-02T04:39:48.530

货币永远不应存储为浮点数。它应该始终是您使用的最低面额的整数（日元、美分、派斯）。

如果您需要使用小于最低自然面额的金额，请将货币存储为表示指定分数倍数的整数金额。例如日元的十分之六。

至于格式，这里有[简单](http://krijnhoetmer.nl/stuff/javascript/table-align-char/)*选项*的讨论。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-06-27T17:30:28.300

以下CSS基本上取自jsj答案中的链接（提取最相关的部分）

仅 HTML 版本：

```
td { font-family: monospace; }
span.int {
  text-align: right;
  float: left;
  width: 3em;
}

span.fractional {
  text-align: left;
  float: right;
  width: 2em;
}
```

```
<table>
    <tr><td><span class="int">5</span><span class="fractional">.23</span></td></tr>
    <tr><td><span class="int">12</span><span class="fractional">.00</span></td></tr>
    <tr><td><span class="int">3</span><span class="fractional">.24</span></td></tr>
    <tr><td><span class="int">5</span><span class="fractional"></span></td></tr>
    <tr><td><span class="int">9</span><span class="fractional"></span></td></tr>
    <tr><td><span class="int">11</span><span class="fractional">.00</span></td></tr>
</table>
```

JavaScript 版本：

```
function spanInt(content){ var span = document.createElement('span');span.className = 'int'; span.textContent = content; return span; }
function spanFractional(content){ var span = document.createElement('span'); span.className = 'fractional'; span.textContent = content; return span;}
function tableCell_int(value){
  var td = document.createElement('td');
  td.appendChild(spanInt(value));
  td.appendChild(spanFractional(''));
  return td;
}
function tableCell_float(value){
  var intPart = Math.floor(value);
  var fracPart = value - intPart;
  var td = document.createElement('td');
  td.appendChild(spanInt(intPart));
  td.appendChild(spanFractional('.' + Math.round(100*fracPart)));
  return td;
}
function tr(cell){
  var elt = document.createElement('tr');
  elt.appendChild(cell);
  return elt;
}
var theTable = document.getElementById('theTable');
function add_int(value){ theTable.appendChild(tr(tableCell_int(value))); }
function add_float(value){ theTable.appendChild(tr(tableCell_float(value))); }

add_float(5.23); add_float(12); add_float(3.24);
add_int(5); add_int(9); add_float(11);
```

```
td { font-family: monospace; }
span.int {
  text-align: right;
  float: left;
  width: 3em;
}

span.fractional {
  text-align: left;
  float: right;
  width: 2em;
}
```

```
<table id='theTable'></table>
```

# php - 为什么 PDO::bindValue() 在这种情况下不会失败？

> ID：14657541
> 
> 赞同：0
> 
> 时间：2013-02-02T01:06:06.340
> 
> 标签：php, sql, exception, pdo, bindvalue

我编写了以下函数来构造和执行带有键值绑定的 SQL 语句。我正在使用 bindValue() 将键值对数组绑定到它们在 SQL 字符串中的相应标识符。（回显语句用于调试）。

```
public function executeSelect($sql, $bindings = FALSE)
{
    $stmt = $this->dbPDO->prepare($sql);

    if ($bindings)
    {
        foreach($bindings as $key => $value)
        {
            $success = $stmt->bindValue($key, $value);
            echo "success = $success, key = $key, value = $value<br />";
            if (!$success)
            {
                throw new Exception("Binding failed for (key = $key) & (value = $value)");
            }
        }
    }

    echo "Beginning execution<br />";
    if ($stmt->execute())
    {
        return $stmt->fetchAll(PDO::FETCH_ASSOC);
    }
    else
    {
        return FALSE;   
    }
} 
```

该函数的输入如下：

```
$stmt = "SELECT * FROM test WHERE id = :id";
$bindings = array(":id" => "3", ":Foo" => "Bar"); 
```

在通过 $bindings 数组的第二个循环中，我希望 $success 评估为 false，因此抛出自定义异常，因为“Bar”不能绑定到“ `:Foo`”，因为“ `:Foo`”在输入 SQL 中不存在。

相反，对于 $bindings 数组中的两个键值对，$success 的计算结果为 true (1)，并且 ->execute() 会抛出 PDOException`"(HY000)SQLSTATE[HY000]: General error: 25 bind or column index out of range"`

为什么 bindValue 不返回 false？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T05:53:58.460

因为它是这样工作的。
它不是在绑定时而是在执行时引发错误。就这样。

所以，不需要循环，你可以让你的方法更短。

```
public function executeSelect($sql, $bindings = FALSE)
{
    $stmt = $this->dbPDO->prepare($sql);
    $stmt->execute($bindings);
    return $stmt->fetchAll(PDO::FETCH_ASSOC);
} 
```

我相信也不需要检查执行结果。
如果出现错误，它将已经引发异常。

顺便说一句，我会基于这个创建几个辅助函数，返回标量值和单行。他们很有帮助。虽然我发现命名占位符有点乏味。比较这段代码：

```
$name = $db->getOne("SELECT name FROM users WHERE group=?i AND id=?i",$group,$id);
vs.
$sql = "SELECT name FROM users WHERE group=:group AND id=:id";
$name = $db->getOne($sql,array('group' => $group, 'id' => $id)); 
```

命名需要比匿名多 2 倍的代码。
首字母缩略词的完美示例`WET`- “Write Everything Twice”

# java - 对于任何给定的 T，如何使用 Java 反射来检查给定的类是否实现了 Iterable

> ID：14657542
> 
> 赞同：5
> 
> 时间：2013-02-02T01:06:23.473
> 
> 标签：java, generics, reflection, collections

我有一个特定的目标类型（在运行时决定），以及一个我正在与之比较的可迭代类。我正在尝试编写一个检查类的泛型参数的方法，以查看它是否是我的目标类型的子类的可迭代。例子：

```
Class<?> X = SomeObject.class;

matches(X, new ArrayList<SomeObject>()) -> true
matches(X, new ArrayList<SubclassOfSomeObject>()) -> true
matches(X, new ArrayList<SomeOtherObject>()) -> false
matches(X, new ArrayList()) -> true (I think?)
matches(X, new Iterable<SomeObject>() { ... }) -> true
matches(X, new ListOfSomeObjects()) -> true 
                       (where ListOfSomeObjects extends Iterable<SomeObject>) 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-02T08:04:19.903

不幸的是，由于类型擦除和反射 API 的限制相结合，您尝试做的事情非常复杂。

[`Class.getGenericSuperclass`](http://docs.oracle.com/javase/8/docs/api/java/lang/Class.html#getGenericSuperclass--)确实，您可以使用和的组合来获得超类的通用参数[`ParameterizedType.getActualTypeArguments`](http://docs.oracle.com/javase/8/docs/api/java/lang/reflect/ParameterizedType.html#getActualTypeArguments--)。这是例如 Guava 的[`TypeToken`](https://google.github.io/guava/releases/snapshot/api/docs/com/google/common/reflect/TypeToken.html)类用来捕获泛型类型参数的机制。但是您在这里要求的是接口的泛型类型参数，它可能已在继承链中的任何位置实现 - 尽管接口本身可以在自由解析或声明新类型参数的同时相互继承。

为了演示，采用以下方法：

```
static void inspect(Object o) {
    Type type = o.getClass();
    while (type != null) {
        System.out.print(type + " implements");
        Class<?> rawType =
                (type instanceof ParameterizedType)
                ? (Class<?>)((ParameterizedType)type).getRawType()
                : (Class<?>)type;
        Type[] interfaceTypes = rawType.getGenericInterfaces();
        if (interfaceTypes.length > 0) {
            System.out.println(":");
            for (Type interfaceType : interfaceTypes) {
                if (interfaceType instanceof ParameterizedType) {
                    ParameterizedType parameterizedType = (ParameterizedType)interfaceType;
                    System.out.print("  " + parameterizedType.getRawType() + " with type args: ");
                    Type[] actualTypeArgs = parameterizedType.getActualTypeArguments();
                    System.out.println(Arrays.toString(actualTypeArgs));
                }
                else {
                    System.out.println("  " + interfaceType);
                }
            }
        }
        else {
            System.out.println(" nothing");
        }
        type = rawType.getGenericSuperclass();
    }
} 
```

这将反映一个对象并爬上其继承链以报告其实现的接口及其通用参数（如果适用）。

让我们在您列出的第一个案例上尝试一下：

```
inspect(new ArrayList<SomeObject>()); 
```

这打印：

```
class java.util.ArrayList implements:
  interface java.util.List with type args: [E]
  interface java.util.RandomAccess
  interface java.lang.Cloneable
  interface java.io.Serializable
java.util.AbstractList<E> implements:
  interface java.util.List with type args: [E]
java.util.AbstractCollection<E> implements:
  interface java.util.Collection with type args: [E]
class java.lang.Object implements nothing 
```

可以看到类型参数`E`没有解析。考虑到类型擦除，这是完全可以理解的——在运行时，对应的字节码指令`new ArrayList<SomeObject>()`没有`SomeObject`.

匿名类的情况不同：

```
inspect(new Iterable<SomeObject>() {
    @Override
    public Iterator<SomeObject> iterator() {
        throw new UnsupportedOperationException();
    }
}); 
```

印刷：

```
class sandbox.Main$1 implements:
  interface java.lang.Iterable with type args: [class sandbox.SomeObject]
class java.lang.Object implements nothing 
```

在这里，我们在运行时可以使用类型参数，因为匿名类通过实现来解析类型参数`Iterable<SomeObject>`。`ListOfSomeObjects`并且它的任何子类都将出于相同的原因工作。

好的，所以只要继承链中的某个类`E`沿途解析类型参数，我们就可以匹配它？不幸的是，没有，至少不是上面的方法：

```
inspect(new ArrayList<SomeObject>() { }); 
```

这打印：

```
class sandbox.Main$1 implements nothing
java.util.ArrayList<sandbox.SomeObject> implements:
  interface java.util.List with type args: [E]
  interface java.util.RandomAccess
  interface java.lang.Cloneable
  interface java.io.Serializable
java.util.AbstractList<E> implements:
  interface java.util.List with type args: [E]
java.util.AbstractCollection<E> implements:
  interface java.util.Collection with type args: [E]
class java.lang.Object implements nothing 
```

您可以看到`ArrayList`已知类型参数为`SomeObject`，但这就是它停止的地方。类型参数之间没有连接关系。原因是这段代码：

```
Class<?> rawType =
        (type instanceof ParameterizedType)
        ? (Class<?>)((ParameterizedType)type).getRawType()
        : (Class<?>)type;
Type[] interfaceTypes = rawType.getGenericInterfaces(); 
```

`getGenericInterfaces`是获取接口类型参数信息的唯一方法，但该方法由 声明`Class`，而不是`Type`. 只要该方法有一个`ParameterizedType`实例，该实例保存表示其子类的通用性的状态，它就会被迫调用`getRawType`，它返回`Class`没有类型参数信息的单例。这是一个 catch-22，导致只能获取使用具体类型参数实现的接口的类型参数。

我不知道任何将类型参数与它们解析的参数匹配的反射 API 方法。从理论上讲，可以编写反射代码，沿着继承链向上爬，定位实现的类`Iterable`（或子接口），然后向下爬，直到它与相应的类型参数匹配。不幸的是，我想不出这将如何实施。类可以自由地声明具有任何名称和任何顺序的类型参数，因此基于名称或位置的天真匹配已被淘汰。也许其他人可以提供解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-02T01:59:36.320

我认为您不能仅从一个实例中获取泛型参数类型：

```
new ArrayList<Integer>(); 
```

如果您有一个保存实例的字段，您可以从那里获取它：

```
private List<Integer> list = ArrayList<Integer>(); 
```

看到这个类似的问题： [Get generic type of java.util.List](https://stackoverflow.com/questions/1942644/get-generic-type-of-java-util-list)

# python - 使用 python 处理此文本文件的最 Pythonic 方式

> ID：14657543
> 
> 赞同：2
> 
> 时间：2013-02-02T01:06:24.533
> 
> 标签：python

我有一个包含测试数据的文本文件，如下所示：

```
hdr 1

hdr2

hdr3

data1

data2

data3

data1

data2

.... 
```

每行之间有一个空行。

我需要创建一个包含列表的列表

```
[[hdr1,hdr2,hdr3],[data1,data2,data3],[data1,data2,...] 
```

什么是简洁的，pythonic的方式来做到这一点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-02T01:16:35.810

假设您的数据总是像您的示例中那样以 3 为一组，您可能会使用`itertools`，如果您将相同的迭代器传递 6 次，那么您最终应该得到 6 个字段，其中 3 个是空行，其他的您感兴趣的 3 人组：

```
import itertools

arr = []
with open('input.txt') as f:
    for field1,blank1,field2,blank2,field3,blank3 in itertools.izip_longest(*[f]*6):
        arr.append([field1,field2,field3]) 
```

（灵感来自[这篇文章](https://stackoverflow.com/a/1657385/1332690)）

**编辑**：您可能需要调用`strip()`这些字段以便不包含任何额外的\n，所以`arr.append([field1.strip(),field2.strip(),field3.strip()])`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-02T01:57:55.553

这只是 Charles Menguy 解决方案的简化版本，我只是将其添加为答案，因为它很难作为评论阅读。但这是关键：

首先，使用`grouper`from the [`itertools`recipes](http://docs.python.org/2/library/itertools.html#recipes)将文件分组为 6 行组：

```
groups = grouper(6, f) 
```

接下来，您可以通过切片来丢弃所有其他行：

```
nonblank = [group[::2] for group in groups] 
```

或者，或者，通过明确过滤掉空白行：

```
nonblank = [filter(bool, group) for group in groups] 
```

如果您需要剥离每一行，您可以使用列表推导，或者`map`. 一般来说，`map`如果我不需要 lambda/partial 一个新函数，我更喜欢，这里我们不需要；只是`map(str.strip, group)`。

把它放在一起，这就是整个事情，作为一个单行（我认为它仍然很可读）：

```
with open('input.txt') as f:
    arr = [map(str.strip, group[::2]) for group in grouper(6, f)] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-02T01:45:53.020

不知道它是否是最好的解决方案或者它是多少 pythonic，但您可以简单地使用正则表达式来解析文件的行：

```
import re

regex = re.compile(r'^(\w+)\s*(\d+)')
last_groups = None
group = []
data = []

with open('data.txt', 'r') as f:
    for line in f:
        match = regex.search(line)
        if match:
            if last_groups is None:
                last_groups = match.groups()

            if last_groups[0] == match.groups()[0] and \
                    int(last_groups[1]) <= int(match.groups()[1]):
                last_groups = match.groups()
                group.append(''.join(last_groups))
            else:
                data.append(group)
                last_groups = match.groups()
                group = [''.join(last_groups)]

if group:
    data.append(group) 
```

# php - 使用 smarty 比较多维数组值

> ID：14657549
> 
> 赞同：0
> 
> 时间：2013-02-02T01:08:10.370
> 
> 标签：php, smarty

我有多维数组。

```
 Array (4)
0 => Array (6)
  0 => 0
  1 => "100100105"
  2 => "honey"
  3 => "SUP"
  4 => 0
  5 => 0
1 => Array (6)
  0 => 1
  1 => "100100608"
  2 => "bunny"
  3 => "MEM"
  4 => 0
  5 => 0
2 => Array (6)
  0 => 1
  1 => "100100609"
  2 => "munny"
  3 => "DISTSTD"
  4 => 0
  5 => 0
3 => Array (6)
  0 => 2
  1 => "100300054"
  2 => "sunny"
  3 => "MEM"
  4 => 0
  5 => 0 
```

想要使用 smarty 将当前级别的零值与下一个级别的零值进行比较，例如 Array[0][0] == Array[1][0]。

我只能获取当前元素值。如何在当前循环中获取下一个元素值

```
 {{foreach from=$volume item=element}}
      {{if $element@iteration > 1}}
            {{$element[0]}}
          {{/if}}
  {{/foreach}} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T10:40:34.373

要在 Smarty 中访问数组，您需要将要访问的索引分配给变量，以便能够索引到数组

```
{foreach from=$volume item=element name=foo}
  {assign var=nextIteration value=$smarty.foreach.foo.iteration + 1}
  {$volume[$nextIteration]}
{/foreach} 
```

我想做你会做的比较：

```
 {foreach from=$volume item=element name=foo}
      {assign var=nextIteration value=$smarty.foreach.foo.iteration + 1}

      {if ($nextIteration + 1) >= count($volume) }
          Last element
      {elseif $volume[$nextIteration][0] == $element[0]}
          They matched!
      {else} 
          They are different!
      {/if}
  {/foreach} 
```

然而，这是使用 Smarty 的一种非常糟糕的方式，因为它以一种非常丑陋的方式破坏了[MVC](http://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93controller)模式。你最好写一个[Smarty 插件](http://www.smarty.net/docs/en/plugins.functions.tpl)来处理这样的复杂情况。是的，它可能仍然会破坏 MVC 模式，但它至少是可维护的，而不是在模板中包含复杂的代码。

# jquery - 如何通过jquery传递php变量

> ID：14657556
> 
> 赞同：-2
> 
> 时间：2013-02-02T01:09:15.127
> 
> 标签：jquery

我有一个图像上传脚本，我想通过 jquery 传递 php 变量

这是我的jQuery

```
<script type="text/javascript" >
$(document).ready(function() {      
    $('#form_data').live('change', function()           { 
      $("#preview").html('');
      $("#current").hide();
      $("#preview").html('<img src="ajax-loader.gif" alt="Uploading...."/>');
      $("#imageform").ajaxForm({
        target: '#preview'
           }).submit();

      });
}); 
</script>  

<form id="imageform" method="post" enctype="multipart/form-data" action='ajax_file.php'>
    <input type="file" name="form_data" id="form_data" > 
```

我的问题是我想通过 jquery 发送波纹管示例隐藏变量请解决我的问题 **示例**

```
<input type"hidden" value="`<?php echo $value;?>`"> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T01:11:33.647

[`.live`](http://api.jquery.com/live/)自 v1.7 起已在 jQuery 中弃用，并已在 v1.9 中删除。

您应该将其替换为[`.on()`](http://api.jquery.com/on/).

`.on`有 2 种用于绑定元素的语法，而`.live`只有 1 种。

如果元素在您绑定时存在，您可以这样做：

```
`$('.element').on('click', function(){
  .......
});` 
```

您甚至可以使用速记：

```
`$('.element').click(function(){
.........
});` 
```

如果该元素当时不存在，或者将添加新元素（这是`.live`通常使用的），则需要使用“事件委托”：

```
`$(document).on('click', '.element', function(){
.............
 });` 
```

注意：您希望绑定到最近的静态元素，而不是总是`document`.

同时，如果您将 jQuery 升级到最新版本，可以使用[**jQuery Migrate 插件来恢复功能。**](http://jquery.com/upgrade-guide/1.9/#jquery-migrate-plugin)`.live()`

# mysql - MySQL删除数据而不查询？

> ID：14657558
> 
> 赞同：0
> 
> 时间：2013-02-02T01:09:56.923
> 
> 标签：mysql, sql, database, sql-delete

我有一个客户正在描述从 Web 表单添加新数据时发生的事件。如果提交的数据与任何现有数据库条目匹配，系统将删除现有条目。

我检查了脚本，没有看到会影响相关表的 DELETE 查询。有 UPDATE 查询，它们都不影响数据库中指示删除或标记为已删除的字段。

如果不执行 DELETE 查询，是否会丢失数据？

根据要求，这是“创建表”语句：

```
CREATE TABLE `msp_zip_codes` 
(
     `zip_code` varchar(5) DEFAULT NULL,
     `city` varchar(35) DEFAULT NULL,
     `state_prefix` varchar(2) DEFAULT NULL,
     `county` varchar(45) DEFAULT NULL,
     `area_code` varchar(45) DEFAULT NULL,
     `CityType` varchar(1) DEFAULT NULL,
     `CityAliasAbbreviation` varchar(13) DEFAULT NULL,
     `CityAliasName` varchar(35) DEFAULT NULL,
     `lat` decimal(18,6) DEFAULT NULL,
     `lon` decimal(18,6) DEFAULT NULL,
     `time_zone` varchar(7) DEFAULT NULL,
     `Elevation` int(10) DEFAULT NULL,
     `CountyFIPS` varchar(5) DEFAULT NULL,
     `DayLightSaving` varchar(1) DEFAULT NULL,
     `PreferredLastLineKey` varchar(25) DEFAULT NULL,
     `ClassificationCode` varchar(2) DEFAULT NULL,
     `MultiCounty` varchar(1) DEFAULT NULL,
     `StateFIPS` varchar(2) DEFAULT NULL,
     `CityStateKey` varchar(6) DEFAULT NULL,
     `CityAliasCode` varchar(5) DEFAULT NULL,
     `PrimaryRecord` varchar(50) DEFAULT NULL,
     `CityMixedCase` varchar(50) DEFAULT NULL,
     `CityAliasMixedCase` varchar(50) DEFAULT NULL,
     KEY `AreaCode` (`area_code`),
     KEY `CityAliasCode` (`CityAliasCode`),
     KEY `CityStateKey` (`CityStateKey`),
     KEY `ClassificationCode` (`ClassificationCode`),
     KEY `PreferredLastLineKey` (`PreferredLastLineKey`),
     KEY `ZipCode` (`zip_code`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-02T01:13:59.793

其中一种可能性是该表有一个`UPDATE TRIGGER`集合，每次有更新时都会触发。或者另一个，`Event Scheduler`服务器上正在运行。

显示数据库上所有触发器的代码：

```
SELECT * 
FROM   INFORMATION_SCHEMA.TRIGGERS a
WHERE  a.TRIGGER_SCHEMA LIKE CONCAT('%', 'databaseNameHERE', '%') 
```

显示数据库上所有事件的代码：

```
SHOW EVENTS FROM databaseNameHERE; 
```

# php - Codeigniter 控制器不能使用助手中的函数

> ID：14657563
> 
> 赞同：1
> 
> 时间：2013-02-02T01:10:25.913
> 
> 标签：php, codeigniter, custom-controls, helper, helpers

**我有控制器**

```
<?php

class Onetimescan extends CI_Controller{

    public function index() {
            #LOAD -->>>> LIB ###########
           $this->load->library('session');  ##    LOAD LIBS:  SESSION 
           $this->load->helper('simpledom');

           #LOAD -->>>> MODEL
           $this->load->model('scanmodel');
                $this->scanmodel->loadurlbasedonsessid($this->session->userdata('session_id')); // echo out inserted domain in loadurlbasedonsessid() func
                $sss= $this->session->userdata('tld'); // echo $sss;

       $siteToSearch = file_get_html($sss);
       foreach($siteToSearch->find('form') as $element){
            echo "<h1 style='color:red; '>".$element->action."</h1> <br />";
        }     
    }
}
?> 
```

我`Call to a member function find() on a non-object`在这条线上遇到了一个致命错误：

```
 foreach($siteToSearch->find('form') as $element){ 
```

simpledom 是我在顶部加载的一个助手（实际上称为 simpledom_helper.php），它的 file_get_html 定义如下：

```
[http://pastebin.com/HaJtKfNb][1] 
```

我在这里做错了什么？我尝试像这样定义函数，`public function file_get_html{}`但这会引发错误。

我通过添加解决了这一切：

```
$prefix = "http://www.";
                //echo "SSS is:  ".$sss;
           $siteToSearch = file_get_html($prefix.$sss); 
```

**已修复>>** 该 url 试图作为完全合格的域`get_file_contents(somedomain.com)`，但缺少该域。`http://www.`这个功能`get_file_contents`似乎需要`http://www.`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T01:19:54.350

辅助函数应该这样调用，因为它们不是对象：

```
$this->load->helper('simpledom');    
$siteToSearch = file_get_html($sss); 
```

# java - 尝试创建 log4j2 rollingfileappender 时出错

> ID：14657572
> 
> 赞同：7
> 
> 时间：2013-02-02T01:11:44.510
> 
> 标签：java, configuration, rollingfileappender, log4j2

我正在尝试从使用 FileAppender 切换到使用 log4j2 的 RollingFileAppender（在 beta3 和 beta4 jar 中都发生）。

我将其配置为：

```
<RollingFile name="RollingFile" fileName="${logdir}/${filename}" 
    filePattern="${logdir}/app-%d{yyyy-MM-dd-hh-mm-ss}_%i.log" >
    <PatternLayout>
        <pattern>%d %p %C{1.} [%t] %m%n</pattern>
    </PatternLayout>
    <Policies>
        <OnStartupTriggeringPolicy/>
    </Policies>
    <DefaultRolloverStrategy max="20"/>
</RollingFile>  
        ...
<loggers>
          <root level="ERROR">
    <appender-ref ref="RollingFile"/>
    <appender-ref ref="STDOUT"/>
</root>
        ... 
```

在代码中，我试图以这种方式获取记录器：

```
Logger logger = LogManager.getLogger(this.getClass()); 
```

但是当我运行它时出现了这个异常：

```
2013-02-01 17:56:54,773 错误无法在类 org.apache.logging.log4j.core.appender.RollingFileAppender 中为元素 RollingFile java.lang.reflect.InvocationTargetException 调用方法 createAppender
    在 sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    在 sun.reflect.NativeMethodAccessorImpl.invoke（未知来源）
    在 sun.reflect.DelegatingMethodAccessorImpl.invoke（未知来源）
    在 java.lang.reflect.Method.invoke（未知来源）
    在 org.apache.logging.log4j.core.config.BaseConfiguration.createPluginObject(BaseConfiguration.java:723)
    在 org.apache.logging.log4j.core.config.BaseConfiguration.createConfiguration(BaseConfiguration.java:489)
    在 org.apache.logging.log4j.core.config.BaseConfiguration.createConfiguration(BaseConfiguration.java:481)
    在 org.apache.logging.log4j.core.config.BaseConfiguration.doConfigure(BaseConfiguration.java:162)
    在 org.apache.logging.log4j.core.config.BaseConfiguration.start（BaseConfiguration.java:120）
    在 org.apache.logging.log4j.core.LoggerContext.setConfiguration(LoggerContext.java:271)
    在 org.apache.logging.log4j.core.LoggerContext.reconfigure(LoggerContext.java:287)
    在 org.apache.logging.log4j.core.LoggerContext.start(LoggerContext.java:139)
    在 org.apache.logging.log4j.core.impl.Log4jContextFactory.getContext(Log4jContextFactory.java:76)
    在 org.apache.logging.log4j.core.impl.Log4jContextFactory.getContext(Log4jContextFactory.java:31)
    在 org.apache.logging.log4j.LogManager.getLogger(LogManager.java:342)
    在 org.apache.logging.log4j.LogManager.getLogger(LogManager.java:301)
         ...
引起：java.lang.ClassCastException：org.apache.logging.log4j.core.appender.FileManager 不能转换为 org.apache.logging.log4j.core.appender.rolling.RollingFileManager
    在 org.apache.logging.log4j.core.appender.rolling.RollingFileManager.getFileManager(RollingFileManager.java:73)
    在 org.apache.logging.log4j.core.appender.RollingFileAppender.createAppender(RollingFileAppender.java:140)
    ... 18 更多

```

看起来好像正在读取配置文件并且正在尝试创建附加程序，但不确定我做错了什么。

我已经尝试剪切和粘贴其他人的 RollingFileAppender 配置而不进行任何修改，但我仍然收到上述错误。

谢谢。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-02-13T06:37:11.633

在我的情况下，配置文件包含`File appender`带有`RollingFile appender`.

> 错误在`fileName`参数中 - 它在两个附加程序中具有相同的值。

# objective-c - Xcode中的抽屉视图？

> ID：14657573
> 
> 赞同：-1
> 
> 时间：2013-02-02T01:12:04.977
> 
> 标签：objective-c, xcode, macos

这是我的第一个 mac 应用程序，我一直想做这样的事情：

![在此处输入图像描述](../Images/7e117907c19849fab9a27963b6f844f0.png)

但是，我一直在寻找，几乎没有发现任何关于窗户和抽屉的信息。我怎样才能把它放到我的应用程序中？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T01:16:55.453

那不是抽屉，那是一张[床单](https://developer.apple.com/library/mac/documentation/UserExperience/Conceptual/AppleHIGuidelines/Windows/Windows.html#//apple_ref/doc/uid/20000961-TPXREF11)。这是[有关 sheet 的概念文档](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/Sheets/Sheets.html#//apple_ref/doc/uid/10000002i)，其中包括示例代码。

# jquery - using jquery ready() function on a js call

> ID：14657574
> 
> 赞同：0
> 
> 时间：2013-02-02T01:12:10.667
> 
> 标签：jquery

is there any way to add jquery ready() function to a code like this?

```
<script type='text/javascript' src='http://xxxxxxxxxxx?id=35&amp;k=bf6ee6f24e058a864298&amp;method=div' id='block-4e058a8642973ae2c431f0d8'></script> 
```

suppose we can't add ready function within the actual js code in that src link

if we can't, then is there anyway to make this script load last?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T01:18:17.730

Yes. If you know jQuery will be loaded prior to this line you can have the content contained in the following in the external file.

```
$(function () {
   // file content here
}); 
```

If you can't change the target file there are also script loading plugins that will allow control over when things are loaded. This is easiest way.

For example yep/nope is popular. [http://yepnopejs.com/](http://yepnopejs.com/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T01:18:48.860

Simple answer you cant, without having the jquery library added.

but if you place the script just before the final `</html>` tag it should execute last.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-02T01:20:25.850

2 simple ways:

1.  Put the script tag at the bottom of your page.
2.  Create it dynamically with JS and add it to the page after your other scripts using something like:

Example:

```
window.onload = function() {
     var s = document.createElement('script');
     s.src = "http://yourscripthere";
     document.body.appendChild(s);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-02T01:43:21.153

I get the impression it's because you want to change something in the src

```
$(function(){
    var your_id=35;
    $.getScript('http://xxxxxxxxxxx?id=' + your_id + '&amp;k=bf6ee6f24e058a864298&amp;method=div');
}); 
```

or if you want it to load after everything else has loaded

```
$(window).load(function(){
    var your_id=35;
    $.getScript('http://xxxxxxxxxxx?id=' + your_id + '&amp;k=bf6ee6f24e058a864298&amp;method=div');
}); 
```

# jquery - JQuery 删除父元素

> ID：14657577
> 
> 赞同：2
> 
> 时间：2013-02-02T01:12:20.430
> 
> 标签：jquery, html, hide

我有一些看起来像这样的第三方 HTML：

```
 <tr>
        <td>
            <asp:Label ID="lblURL" AssociatedControlID="txtURL" 
                  runat="server" EnableViewState="false" CssClass="FieldLabel" />
        </td>
        <td>
            <cms:CMSTextBox ID="txtURL" runat="server" 
                  CssClass="TextBoxField" EnableViewState="false"
                  MaxLength="450" ProcessMacroSecurity="false" />
        </td>
    </tr> 
```

我不允许更改此 HTML。我想隐藏这个标签和输入标签，并想出了如何用这段代码在 JQuery 中做到这一点：

```
$('label[id$="lblURL"]').hide();
$('input[id$="txtURL"]').hide(); 
```

这有效地隐藏了页面中的元素。问题是父元素和元素仍然存在。如何删除 tr 和 td 元素？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-02T01:13:51.743

看起来您的标签和输入框始终位于封闭的表格行中，因此您可以隐藏整个表格行：

```
$('label[id$="lblURL"]').closest('tr').hide(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T01:15:30.820

`TR`要完全删除

```
$('tr [id$="lblURL"]').closest('tr').remove(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-02T01:43:37.343

您可以尝试使用 .remove 而不是 hide，`$('#element').parent.remove();`

# codeigniter - 修复 Codeigniter 网站新闻部分的规范化

> ID：14657581
> 
> 赞同：0
> 
> 时间：2013-02-02T01:13:29.317
> 
> 标签：codeigniter, seo, codeigniter-url, codeigniter-routing

谷歌将我的新闻文章索引为：

[https://www.site.com/news/id5-](https://www.site.com/news/id5-)

和：

[https://www.site.com/news/id5-title-of-article](https://www.site.com/news/id5-title-of-article)

事实上，它对两者都进行了索引，但在结果中省略了完整的 URL 版本。两个 URL 都解析到同一个地址，但我想每次都强制 id#-title-of-article 来解决这个规范化问题。

该站点是使用 Codeignigter 框架编写的。

我在 system/application/config/routes.php 的路由文件包含：

```
$route['news/id(\d+)-(.*)'] = "news/view/$1"; 
```

关于如何解决这个问题的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T02:41:20.010

在您的标题上，让 Google 知道常用 URL 应该是什么。

```
<link rel="canonical" href="https://www.site.com/news/id5-title-of-article" /> 
```

确保无论加载哪个页面，它都可用。重新索引需要一些时间，但 Google 只会在索引后在其搜索中显示此链接。

# html - 链接标签破坏页面设计

> ID：14657583
> 
> 赞同：-3
> 
> 时间：2013-02-02T01:13:43.430
> 
> 标签：html, css

我正在设计一个作品集，但遇到了这个问题：
当我应用链接标签 ( *<a>* ) 时，它会破坏我所做的设计。
字体大小要小得多，字体也不那么流畅，这里有一个例子： ![问题示例](../Images/1499c73257f41e59e0b5a8d4e88441a0.png) 我能做些什么来防止这种情况发生？
我考虑过使用 js 来完全处理链接（我将使用一些 js 来处理这些链接）。

**编辑：**
对不起，应该包括来源：
**HTML：**

```
<link href='http://fonts.googleapis.com/css?family=Ubuntu+Condensed' rel='stylesheet' type='text/css'>
<nav>
    <div class="navwrap">
        <div class="logo inline"></div>
        <a href="#a"><div class="inline">About</div></a>
        <a href="#p"><div class="inline">Projects</div></a>
        <a href="#c"><div class="inline">Code</div></a>
        <a href="#l"><div class="inline">Learn</div></a>
    </div>
</nav> 
```

**CSS：**

```
body {
    background: #e3e3e3;
}

a, a:link, a:visited, a:hover, a:active{
    text-decoration:none;
    color:inherit;
}

/* NAVIGATION */
.logo {
    width: 128px;
    height: 128px;
    background-size: 100%;
    background-image: url(http://djonn.dk/logo.svg);
}

.inline {
    float: left;
}

.navwrap {
    margin: 0 auto;
    height: 128px;
    width: auto;
    margin: 0 auto;
    width: 995px;
    margin-bottom: 35px;
}

nav a  {
    position: relative;
    top: 48px;
    display:block;
}
nav a div{
    font-family: 'Ubuntu Condensed', sans-serif;
    font-size: 2.25em;
    padding: 0 15px 0 15px;
    border-left: 1px solid black;
}

nav a:nth-of-type(1) div{
    border: none;
}

@media only screen and (min-width: 0px) and (max-width: 760px) {
    .navwrap {
        width: 585px;
    }

    nav a div {
        font-size: 1.5em;
    }
}

@media only screen and (min-width: 761px) and (max-width: 995px) {
    .navwrap {
        width: 761px;
    }

    nav a div {
        font-size: 1.85em;
    }
} 
```

视觉参见：http: [//jsfiddle.net/djonn/DJG4L/](http://jsfiddle.net/djonn/DJG4L/)

澄清您的一些评论：
- 这是完全自定义的 css，我使用的是 css 重置表。
- 我不会使用 js 代替 css，而是使用 <a>-tag

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T01:31:56.593

我猜你的样式表看起来像这样：

```
 html {
    font-size: SomeSize;
    etc.
    } 
```

我相信您可以做的一件事是将其添加到您的样式表中：

```
 a:link, a:visited {
    font-size: TheSize;
    }
    a:hover {
    font-size: TheSize;
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T01:26:41.463

看起来您在 CSS 中的任何内容都不适用于您的链接。您必须设置您的样式（a.hover a.active 等）。只有 H2 样式不会为带有链接的 H2 提供相同的结果（除非您已经定义并应用了 CSS 类）

请遵循 thordarson 给出的好建议——不要将 Javascript 用于 CSS 的目的。

# java - java.lang.NoClassDefFoundError: org/json/simple/parser/ParseException 与 eclipse 和 spring

> ID：14657585
> 
> 赞同：6
> 
> 时间：2013-02-02T01:13:51.557
> 
> 标签：java, eclipse, json, spring

我有一个简单的 XML 文件，已解析为 JSON。一切都很好，花花公子，我有一个独立的 Java 类（即它有一个`public static void main (String args[])....`.

这有一个私有构造函数（因为我需要用字符串调用它，文件名或实际数据）。所以我有两个方法可以返回对象的一个​​实例。如您所知，我对Java有所了解。

好的。当我在 Eclipse 中运行运行 main 方法的代码时，我的文件会根据需要加载和解码。它也适用于我通过 JUnit 运行的原始字符串。

所以我知道以下事实 -

1.  静态字符串的解析工作和完美解码
2.  如果我提供一个文件，它会被正确加载和解码。

现在的问题：

一旦我在 Spring 框架中运行它，我就可以将我通过独立代码运行的整个文件内容写入标准。

但在它可以运行任何东西之前，我得到以下错误 -

```
org.springframework.web.util.NestedServletException：处理程序处理失败；嵌套异常是 java.lang.NoClassDefFoundError: org/json/simple/parser/ParseException
org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:920)
org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:809)
org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:571)
org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:501)
javax.servlet.http.HttpServlet.service(HttpServlet.java:621)
javax.servlet.http.HttpServlet.service(HttpServlet.java:722)

```

独立代码在 Eclipse 中运行，Spring 使用 Tomcat 7 指向该代码运行。

为什么它没有正确找到 ParsException？

调用 Spring 控制器中的导入是

```
导入 java.io.FileNotFoundException；
导入 java.io.FileReader；
导入 java.io.IOException；
导入 java.util.ArrayList；
导入 org.apache.commons.lang.StringUtils；
导入 org.json.simple.JSONArray；
导入 org.json.simple.JSONObject；
导入 org.json.simple.parser.JSONParser；

```

他们是改变构建顺序的一种方式吗？那会解决吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-02T08:01:39.223

看起来你错过了在你的类路径中包含 json-simple-.jar 。包括相同的，它应该得到解决。

希望这可以帮助 ！

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2015-07-07T20:39:35.190

1.  在构建路径中添加[json-simple-1.1.1.jar文件。](http://json-simple.googlecode.com/files/json-simple-1.1.1.jar)在Eclipse上，右键单击项目->构建路径->配置构建路径-> java构建路径->添加外部jar->选择jar文件。

2.  将构建路径条目添加到部署程序集中。在同一属性窗口中，选择“部署程序集”选项。然后添加“Java Build Path”条目。这应该会显示您刚刚在第一步中创建的构建路径条目。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-02T01:24:02.160

您能否将这个 jar json-simple-1.1.1.jar 添加到您的类路径中并尝试一下？这个 jar 可以在[http://code.google.com/p/json-simple/downloads/detail?name=json-simple-1.1.1.jar下载](http://code.google.com/p/json-simple/downloads/detail?name=json-simple-1.1.1.jar)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-14T10:36:58.293

我最终使用的解决方案是更改为 sourceforge.net json 解析器，进行了一些代码调整，我的 JUnit 测试仍然有效，并且 Tomcat 没有抱怨。这可能不是最好的解决方案，但它确实有效。

```
import net.sf.json.JSONArray;
import net.sf.json.JSONObject;
import net.sf.json.JSONSerializer; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-02T01:16:33.680

您缺少 jar 部署。

它与Tomcat7有关。需要导出一些 jar（忘记了哪些）其他 Web 服务器不需要，但 Tomcat。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-12-22T11:17:46.213

我遇到了类似的错误，花了 3 4 个小时删除和添加新的 jar 文件。我的问题是我直接从下载位置添加了 jar 文件，即 ZIP 文件..!!! 添加正确提取的 jar 文件后，我的问题似乎得到了解决。希望这可以帮助某人.. !!

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-05-22T22:36:36.827

IF you are making an AI in Spring as I was when I had this error:

You **also need to add the Jar to your AI "jlib" folder**, for instance "...\AI\Skirmish\MyAI\0.1\jlib".

It's not enough to add it in Eclipse or Netbeans and build the project. Spring must have the jar too.

I know it is a late answer it but can help other people with the same error.

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-07-02T09:39:33.887

使用以下 java 库处理 JSONArray 和 JSONObject

```
<dependency>
    <groupId>org.json</groupId>
    <artifactId>json</artifactId>
    <version>20200518</version>
</dependency> 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-08-17T13:18:28.013

只需在 pom.xml 中添加 JSON simple 的 maven 依赖项。无需配置任何类路径。

```
<dependency>
    <groupId>com.googlecode.json-simple</groupId>
    <artifactId>json-simple</artifactId>
    <version>1.1.1</version>
</dependency> 
```

# jquery - 如何使用带有工具提示的 JQuery 重现幻灯片动画？

> ID：14657589
> 
> 赞同：0
> 
> 时间：2013-02-02T01:14:03.147
> 
> 标签：jquery, animation, effects

在 CarRentals.com 上，当您将鼠标悬停在“功能”按钮上时，会有一个很酷的动画：http: [//www.carrentals.com/us/search/sfo/2013-02-08-10-00/61010/2013- 02-11-10-00](http://www.carrentals.com/us/search/sfo/2013-02-08-10-00/61010/2013-02-11-10-00)。这是通过 JQuery 工具提示库完成的。

如何在单击时为隐藏的容器（不是工具提示）重现此动画？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T01:16:52.213

我知道您不想要工具提示，但为什么不在标题或 rel 属性中填充隐藏信息并使用如下内容：

[http://osvaldas.info/elegant-css-and-jquery-tooltip-responsive-mobile-friendly](http://osvaldas.info/elegant-css-and-jquery-tooltip-responsive-mobile-friendly)

我在任何地方都使用它，非常可定制、智能且流畅。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T21:24:48.247

通过首先将我的弹出窗口隐藏起来，不透明度为 0，margin-top 作为我希望动画开始的位置，然后在单击时执行以下操作，我能够非常接近：

```
$popup.show(1).animate({opacity: 1,
                        top: ($popup.position().top - 30)
                        }, 'fast') 
```

要隐藏弹出窗口，我必须正确重置 CSS：

```
$popup.animate({ opacity: 0.5,
                 top: ($popup.position().top - 10)
    }, 'fast', function() {
      $popup.fadeOut('slow');
      $popup.css({'display': 'none', 'opacity': 0, 'top': '12px'})
    }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-02T01:17:22.647

它是[slideUp](http://api.jquery.com/slideUp/)和[fadeIn](http://api.jquery.com/fadeIn/)的组合。您只需在定位的隐藏 div 上并行执行这两个动画。

# angularjs - 您如何访问指令范围内的 ng-repeat 项？

> ID：14657591
> 
> 赞同：21
> 
> 时间：2013-02-02T01:14:33.290
> 
> 标签：angularjs, angularjs-directive

你如何设置这样的范围值：

```
<div ng-controller="MyCtrl">
      <my-element ng-repeat="p in people" person='p'></my-element>
</div> 
```

```
var myApp = angular.module('myApp',[]);

myApp.directive('myElement', function(){
    return {
        restrict: 'E',
        template: '<div>{{ name }}</div> <div>{{ age }}</div>'
    }
});

function MyCtrl($scope) {
    $scope.people = [{ name: 'Mike', age: 20 },{name: 'Peter', age: 22 }];
} 
```

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2013-02-02T01:50:23.587

如果通过“设置范围值”您的意思是让模板工作，那么

```
template: '<div>{{ p.name }}</div> <div>{{ p.age }}</div>' 
```

由于 ng-repeat 的每次迭代都会创建一个新的子作用域，`p`因此是在该作用域上定义的。由于您的指令没有创建隔离范围，因此您不需要 attribute `person`，因此适用于上述情况：

```
<my-element ng-repeat="p in people"></my-element> 
```

如果您想要一个隔离范围，请使用

```
<my-element ng-repeat="p in people" person='p'></my-element> 
```

和

```
return {
   restrict: 'E',
   scope: {
       person: '='
   },
   template: '<div>{{ person.name }}</div> <div>{{ person.age }}</div>'
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-10-10T10:08:54.463

我喜欢在定义指令范围时使用“@”。这使指令隔离范围能够访问 p，例如在链接中：

```
return {
   scope: '@',
   link: function(scope) {
       console.log(scope.p); //It can now be accessed because of '@'
   }
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-07-23T10:07:05.497

您不需要在指令中创建隔离范围。ng repeat 会自动为您执行此操作。所以只需删除：

在指令中：

```
scope: {
   person: '='
}, 
```

并在 ng 中重复 html 标记：

```
person='p' 
```

在您的指令中，您将能够访问类似

```
$scope.p.personAttribute 
```

就像这里的解释中提到的： [angularjs-pass-instance-of-each-ng-repeat-in-html-to-directive](https://stackoverflow.com/questions/16618621/angularjs-pass-instance-of-each-ng-repeat-in-html-to-directive/16619083#16619083)

# html - 使用 Css 响应式媒体查询，我的子 div 不接受我输入的边距。

> ID：14657597
> 
> 赞同：0
> 
> 时间：2013-02-02T01:15:07.670
> 
> 标签：html, css

我知道这是一个错误且令人困惑的标题，但我对这段代码感到困惑。我基本上是一名 UI 设计师，与一位非常优秀的开发人员密切合作，不幸的是，由于一些家庭问题，我的开发人员下周左右没有时间，我有一个非常紧迫的项目要完成。我是css的新手，所以这段代码真的很乱，我真的希望并祈祷你们能帮助我。

所以这就是问题所在，我正在设计一个响应式网站，桌面版已经准备好。在较小分辨率的版本中，我面临以下问题。本节

```
<div class="promo_container">

<div class="promo one"><div class="content"><h3>Dashboard</h3>
<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud</p></div>
</div>
<div class="promo two"><div class="content"><h3>Accounts</h3>
<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud</p></div>
</div>
<div class="promo three"><div class="content"><h3>Forecast</h3>
<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud</p></div>
</div>
</div> 
```

有了这个用于桌面版的 css

```
.promo_container {
    max-width: 980px;
    position: relative;
    margin-right: auto;
    margin-bottom: 0px;
    margin-left: auto;
    height: auto;
    padding-top: 75px;
    height: 350px;
    display: block;
}

.promo.one {
    background: url(../images/promo1.jpg);
    background-repeat: no-repeat;
    float: left;
    background-position: 0px 3px;
    width: 326px;
    display: inline-block;
}

.promo.two { background: url(../images/promo2.jpg); 
background-repeat: no-repeat;
float: left;
    background-position: 0px 3px;
    width: 326px;}

.promo.three { background: url(../images/promo3.jpg);
background-repeat: no-repeat; 
float: left;
    background-position: 0px 3px;
    width: 326px;;
}

.promo_container .promo .content {
    padding-top: 140px;
    padding-right: 50px;
    padding-bottom: 0px;
    padding-left: 0px;
    line-height: 2em;
} 
```

工作正常，但是当我使用这个 css 作为平板电脑分辨率时

```
@media only screen and (min-width: 550px) and (max-width: 800px){

.promo_container {
    width: 100%;

    margin-right: auto;
    margin-left: auto;
    padding: 0px;
    height: auto;
    position:relative;
     overflow: auto;
}

.promo.one { background: url(../images/promo1.jpg);
background-repeat: no-repeat;
float: none;
    background-position: 0px 3px;
    width:200px; 
    height: 200px;
    margin-left: auto;
    margin-right: auto;

}

.promo.two { background: url(../images/promo2.jpg); 
background-repeat: no-repeat;
clear: both;
    background-position: 0px 3px;
    width: auto;
margin-top: 20px;
margin-right: auto;
    margin-bottom: 0px;
    margin-left: auto;}

.promo.three { background: url(../images/promo3.jpg);
background-repeat: no-repeat; 
float: none;
    background-position: 0px 3px;
    width: auto;
margin-top: 20px;
margin-right: auto;
    margin-bottom: 0px;
    margin-left: auto;
    }

.promo_container .promo .content {
    padding-top: 140px;
    padding-right: 50px;
    padding-bottom: 0px;
    padding-left: 0px;
    line-height: 2em;
}
} 
```

结果是这些促销都堆叠在屏幕左侧虽然我希望它们位于页面的中心。（我希望可以附加图像，但我还没有在 stackoverflow 上的权限。）

现在第二个问题是，正如您所看到的，我已将 OVERFLOW 设置为自动，原因是这些促销来自下一个 div 的内容，即

```
<div class="testimonial">
<div class="testimonial-content"><p>Sed ut perspiciatis unde omnis iste natus error sit voluptatem accusantium doloremque laudantium, totam rem aperiam, eaque ipsa quae ab illo inventore veritatis et quasi architecto beatae vitae dicta sunt explicabo.<br/><br/><b>-Lorem Consecteular</b></p></div>
</div> 
```

使用 CSS

```
.testimonial {
    width: 100%;
    background-repeat: repeat-x;
    height: auto;
    background-color: #f4f4f4;

}
.testimonial .testimonial-content {
    height: auto;
    max-width: 980px;
    margin-left: auto;
    margin-right: auto;
}
.testimonial-content p {
    padding-top: 10px;
} 
```

他们没有相同的父 div，并且溢出设置为自动，促销带有他们自己的滚动条，所以你能指出我在哪里犯了错误。正如我所说，我的朋友们我是新手，所以也许我在这里犯了几个（或者更多:() 错误，但如果有人能帮助我，我将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T05:40:31.397

关于您希望最终解决方案是什么，这里有很多假设，但我会尽我所能回答。

听起来你是第一次学习一些 CSS，所以我会快速提供一些指针，但也会很快给你答案，这听起来像是你更感兴趣的。

我在分享的代码中做了几件事。

您可以让内容决定高度，以使您的页面真正灵活。如果你必须在你的宣传片上设置一个高度，那没关系，但是 .promo_container 的高度现在可以由你的 .promo 元素的高度来决定。

您可以在您的 .promo 类上声明常见的东西，然后在每个 .promo.one、.promo.two、.promo.three 项目上声明特定的东西。

当您输入媒体查询时，您只需*撤消*或*覆盖*您已经声明的属性。因此，无需再次为 .promo_container 列出完全相同的属性。（例如，margin-right：auto；和 margin-left：auto；）

关于浮点数的行为方式以及盒子模型如何响应浮点数，还有很多需要了解。如果您有兴趣，请在有更多时间时在此处阅读。[http://css-tricks.com/the-css-box-model/](http://css-tricks.com/the-css-box-model/)

我看到的主要问题之一是您没有在媒体查询中的每个 .promo 项目上设置 float:none ，因此其中一些仍在尝试浮动。您在媒体查询中的 .promo 项目上使用了 clear 和 float 的混合，但它没有完成工作。

最后，根据您的需要，我会考虑将您的媒体查询更改为包含 max-width: 980px，以便您的 .promos 在浏览器达到该宽度时立即垂直堆叠。

无论如何，这应该让你开始。同样，很难说出您正在寻找什么最终结果，但希望您可以使用并从中学习。

所以，试试这个开始...

**一些可以尝试的 CSS**

```
.promo_container {
    max-width: 980px;
    margin-right: auto;
    margin-bottom: 0px;
    margin-left: auto;
    height: auto;
    padding-top: 75px;
    display: block;
    overflow: hidden;
    margin-bottom: 80px;
}

.promo {
    float: left;
    width: 326px;
    background-position: 0px 3px;
}

.promo.one {
    background-repeat: no-repeat;
}

.promo.two { 
    background-position: 0px 3px;
}

.promo.three {
    background-position: 0px 3px;
}

.promo_container .promo .content {
    padding-top: 140px;
    padding-right: 50px;
    padding-bottom: 0px;
    padding-left: 0px;
    line-height: 2em;
}

/* Media query for Promos */
@media only screen and (min-width: 550px) and (max-width: 800px){

    .promo_container {
        width: 100%;
        margin-right: auto;
        margin-left: auto;
        padding: 0px;
    }

    .promo {
        float: none;
        margin: 0 auto;
        margin-bottom: 20px;
    }
}

/* Testimonies */
.testimonial {
    width: 100%;
    background-repeat: repeat-x;
    height: auto;
    background-color: #f4f4f4;
}

.testimonial .testimonial-content {
    height: auto;
    max-width: 980px;
    margin-left: auto;
    margin-right: auto;
    padding: 30px;
}

.testimonial-content p {
    padding-top: 10px;
} 
```

祝你好运。

# pygame - Pygame：image.load 的一个版本适用于我的图像，但另一个版本不能。我一定错过了一些明显的东西

> ID：14657598
> 
> 赞同：1
> 
> 时间：2013-02-02T01:15:26.170
> 
> 标签：pygame

大多数 pygame 示例使用接受文件名的 pygame.image.load() 版本。这很酷，但有时这还不够，所以我试图让接受文件对象和名称提示的版本工作。

所以这就是问题所在。这有效：

```
def loadSplashImgDirect(filename):
    return  pygame.image.load(filename)) 
```

这会引发“pygame.error：不支持的图像格式”

```
def loadSplashImgOpen():
    aFile = open(filename, 'r')
    return pygame.image.load(aFile,filename) 
```

据我所知，这些函数应该做同样的事情。还是我读错了文档？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T15:37:01.710

如果您正在从类似文件的对象中读取图像，则必须确保文件的当前位置在开头，也就是在 offset 处`0`。

例如：

```
f = open(filename)
content = f.read()
pygame.image.load(f, filename) 
```

不起作用，因为当您调用`image.load`.

您可以使用`seek`将文件的当前位置设置为开头，因此

```
f = open(filename)
content = f.read()
f.seek(0)
pygame.image.load(f, filename) 
```

按预期工作。

# java - 不知道如何使用 PDFBox

> ID：14657602
> 
> 赞同：11
> 
> 时间：2013-02-02T01:16:01.033
> 
> 标签：java, pdfbox

我正在尝试创建一个 PDF 文件，其中包含文档中的大量文本框和另一个类的文本字段。我正在使用 PDFBox。

好的，创建一个新文件很容易，写一行文本很容易。现在，当我尝试插入下一个文本行或文本字段时，它会覆盖内容。

```
 PDDocument doc = null;
    PDPage page = null;

       try{
           doc = new PDDocument();
           page = new PDPage();

           doc.addPage(page);
           PDFont font = PDType1Font.HELVETICA_BOLD;

           PDPageContentStream title = new PDPageContentStream(doc, page);
           title.beginText();
           title.setFont( font, 14 );
           title.moveTextPositionByAmount( 230, 720 );
           title.drawString("DISPATCH SUMMARY");
           title.endText();
           title.close();

           PDPageContentStream title1 = new PDPageContentStream(doc, page);
           title1.beginText();
           title1.setFont( font, 11 );
           title1.moveTextPositionByAmount( 30, 620 );
           title1.drawString("DEPARTURE");
           title1.endText();
           title1.close();

           doc.save("PDFWithText.pdf");
           doc.close();
    } catch (Exception e){
        System.out.println(e);
    } 
```

它确实给了我一个错误：“您正在覆盖现有内容，您应该使用附加模式”。

所以我正在尝试`title1.appendRawCommands(String)`，但它不起作用。

我将如何添加新的文本框和文本字段（来自另一个类）？我在 Internet 上阅读了数十篇教程，但它们只显示创建一行。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2014-03-14T20:10:50.100

```
PDPageContentStream title1 = new PDPageContentStream(doc, page, true, true); 
```

[*OP将此作为答案发布，因此这将向系统标记有答案*]

此外，如果第一个内容流包含显着改变图形状态的操作，例如通过更改当前转换矩阵，并且希望新内容流从这些更改恢复开始，则应该使用具有三个布尔参数的构造函数：

```
PDPageContentStream title1 = new PDPageContentStream(doc, page, true, true, true); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2020-05-13T16:26:29.807

此实现已**弃用**。

```
PDPageContentStream title1 = new PDPageContentStream(doc, page, true, true); 
```

新的实施将是

```
PDPageContentStream title1 = new PDPageContentStream(doc, page, PDPageContentStream.AppendMode.OVERWRITE, true); 
```

# php - Wordpress：用户的附加元数据

> ID：14657607
> 
> 赞同：0
> 
> 时间：2013-02-02T01:16:57.140
> 
> 标签：php, wordpress

我想在注册时添加用户数据，例如中间名等。我发现我可以将它添加到函数 _get_additional_user_keys 中的 wp-includes/user.php 并将它们添加到 $keys，但是当用户编辑他的个人资料并提交更改时，该数据不会保存在数据库中，并且该元是空的.

有谁知道我还应该做什么？谢谢

编辑：

在 \wp-admin\user-edit.php 中，我添加了：

```
<tr>
    <th><label for="last_name2"><?php _e('Middle name') ?></label></th>
    <td><input type="text" name="last_name2" id="last_name2" value="<?php echo esc_attr($profileuser->last_name2) ?>" class="regular-text" /></td>
</tr> 
```

现在在我的数据库中，我在表 wp_usermeta 中得到了没有值的 meta_key

多里扬

# asp.net-mvc - 具有 MVC 4.0 Web Api 的 NewtonSoft json Contract Resolver 未按预期生成输出

> ID：14657611
> 
> 赞同：4
> 
> 时间：2013-02-02T01:17:47.420
> 
> 标签：asp.net-mvc, json, asp.net-mvc-4, asp.net-web-api, json.net

我正在尝试创建一个有条件的 ContractResolver，以便我可以根据 Web 请求/控制器操作以不同方式控制序列化。

例如，在我的用户控制器中，我想序列化我的用户的所有属性，但一些相关的对象我可能只序列化原始类型。但是如果我去我的公司控制器，我想序列化公司的所有属性，但可能只是用户的原始属性（因此我不想使用数据注释或序列化函数。

因此，查看我自己创建的自定义 ContractResolver 页面。 [http://james.newtonking.com/projects/json/help/index.html?topic=html/ContractResolver.htm](http://james.newtonking.com/projects/json/help/index.html?topic=html/ContractResolver.htm)

看起来像这样

```
public class IgnoreListContractResolver : DefaultContractResolver
{
    private readonly Dictionary<string, List<string>> IgnoreList;

    public IgnoreListContractResolver(Dictionary<string, List<string>> i)
    {
        IgnoreList = i;
    }

    protected override IList<JsonProperty> CreateProperties(Type type, MemberSerialization memberSerialization)
    {
        List<JsonProperty> properties = base.CreateProperties(type, memberSerialization).ToList();

        if(IgnoreList.ContainsKey(type.Name))
        {
            properties.RemoveAll(x => IgnoreList[type.Name].Contains(x.PropertyName));                
        }
        return properties;
    }
} 
```

然后在我的 GetUsers 的 web api 控制器操作中我这样做

```
public dynamic GetUsers()
{
    List<User> Users = db.Users.ToList();
    List<string> RoleList = new List<string>();
    RoleList.Add("UsersInRole");
    List<string> CompanyList = new List<string>();
    CompanyList.Add("CompanyAccesses");
    CompanyList.Add("ArchivedMemberships");
    CompanyList.Add("AddCodes");

    Dictionary<string, List<string>> IgnoreList = new Dictionary<string, List<string>>();
    IgnoreList.Add("Role", RoleList);
    IgnoreList.Add("Company", CompanyList);
    GlobalConfiguration
            .Configuration
            .Formatters.JsonFormatter
            .SerializerSettings
            .ContractResolver = new IgnoreListContractResolver(IgnoreList);

    return new { List = Users, Status = "Success" };
} 
```

因此，在调试时，我看到我的合同解析器运行并返回正确的属性，但返回到浏览器的 Json 仍然包含我从列表中删除的属性的条目。

我缺少什么或如何进入 webapi 控制器中的 Json 序列化步骤的任何想法。

* * *

****更新***** 我应该补充一点，这是一个同时具有 MVC 控制器和 webapi 控制器的 MVC4 项目。User、Company 和 Role 对象是从 EF5 加载的对象（首先由代码创建）。有问题的控制器是一个 web api 控制器。不知道为什么这很重要，但我在一个干净的 WebApi 项目（并且没有 EF5）而不是 MVC 项目中尝试了这个，它按预期工作。这是否有助于确定问题可能出在哪里？

谢谢

* * *

*****更新 2* ***** 在同一个 MVC4 项目中，我为 Object 类创建了一个名为 ToJson 的扩展方法。它使用 Newtonsoft.Json.JsonSerializer 来序列化我的实体。就这么简单。**

 **```
public static string ToJson(this object o, Dictionary<string, List<string>> IgnoreList)
{
    JsonSerializer js = JsonSerializer.Create(new Newtonsoft.Json.JsonSerializerSettings()
    {
        Formatting = Formatting.Indented,
        DateTimeZoneHandling = DateTimeZoneHandling.Utc,
        ContractResolver = new IgnoreListContractResolver(IgnoreList),
        ReferenceLoopHandling = ReferenceLoopHandling.Ignore  
    });

    js.Converters.Add(new Newtonsoft.Json.Converters.StringEnumConverter());

    var jw = new StringWriter();
    js.Serialize(jw, o);
    return jw.ToString();

} 
```

然后在 MVC 操作中，我创建一个像这样的 json 字符串。

```
model.jsonUserList = db.Users.ToList().ToJson(IgnoreList); 
```

忽略列表的创建位置与我之前的帖子完全一样。我再次看到合同解析器运行并正确限制了属性列表，但输出的 json 字符串仍然包含所有内容（包括我从列表中删除的属性）。这有帮助吗？我一定是做错了什么，现在看来它不是 MVC 或 web api 框架。这可能与 EF 交互/代理/等有关吗？任何想法将不胜感激。

谢谢

* * *

****更新 3* *****

消除过程和更彻底的调试让我意识到 EF 5 动态代理正在搞乱我的序列化和 ContractResolver 检查类型名称匹配。所以这是我更新的 IgnoreListContractResolver。 **在这一点上，我只是在寻找关于更好方法的意见，或者我是否正在做一些可怕的事情。** 我知道这只是为了直接使用我的 EF 对象而不是 DTO 而跳过了很多圈，但最后我发现这个解决方案非常灵活。

```
public class IgnoreListContractResolver : CamelCasePropertyNamesContractResolver
{
    private readonly Dictionary<string, List<string>> IgnoreList;

    public IgnoreListContractResolver(Dictionary<string, List<string>> i)
    {
        IgnoreList = i;
    }

    protected override IList<JsonProperty> CreateProperties(Type type, MemberSerialization memberSerialization)
    {
        List<JsonProperty> properties = base.CreateProperties(type, memberSerialization).ToList();

        string typename = type.Name;
        if(type.FullName.Contains("System.Data.Entity.DynamicProxies.")) {
            typename = type.FullName.Replace("System.Data.Entity.DynamicProxies.", "");
            typename = typename.Remove(typename.IndexOf('_'));
        }

        if (IgnoreList.ContainsKey(typename))
        {
            //remove anything in the ignore list and ignore case because we are using camel case for json
            properties.RemoveAll(x => IgnoreList[typename].Contains(x.PropertyName, StringComparer.CurrentCultureIgnoreCase));
        }
        return properties;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T08:51:03.600

我认为如果您使用`Type`而不是`string`忽略列表的键类型可能会有所帮助。因此，您可以避免命名问题（不同命名空间中具有相同名称的多个类型），并且可以利用继承。我不熟悉 EF5 和代理，但我猜代理类派生自您的实体类。因此，您可以检查[`Type.IsAssignableFrom()`](http://msdn.microsoft.com/en-us/library/system.type.isassignablefrom%28v=vs.110%29.aspx)而不只是检查是否`typename`是忽略列表中的键。

```
private readonly Dictionary<Type, List<string>> IgnoreList;

protected override IList<JsonProperty> CreateProperties(Type type, MemberSerialization memberSerialization)
{
    List<JsonProperty> properties = base.CreateProperties(type, memberSerialization).ToList();

    // look for the first dictionary entry whose key is a superclass of "type"
    Type key = IgnoreList.Keys.FirstOrDefault(k => k.IsAssignableFrom(type));

    if (key != null)
    {
        //remove anything in the ignore list and ignore case because we are using camel case for json
        properties.RemoveAll(x => IgnoreList[key].Contains(x.PropertyName, StringComparer.CurrentCultureIgnoreCase));
    }
    return properties;
} 
```

然后必须像这样创建忽略列表（我还使用短语法来创建列表和字典）：

```
var CompanyList = new List<string> {
    "CompanyAccesses",
    "ArchivedMemberships",
    "AddCodes"
};

var IgnoreList = new Dictionary<Type, List<string>> {
    // I just replaced "Company" with typeof(Company) here:
    { typeof(Company), CompanyList }
}; 
```

请注意，如果您使用我上面的代码，作为第一个键添加到忽略列表将导致*每次都*`typeof(object)`匹配此条目，并且您的其他条目将永远不会被使用！发生这种情况是因为一个类型的变量可以从其他*所有*类型中赋值。*`object`***

# ios - 访问 [EKEvent notes] 时 cellForRowAtIndexPath 中的 ARC 内存泄漏

> ID：14657612
> 
> 赞同：0
> 
> 时间：2013-02-02T01:18:03.550
> 
> 标签：ios, memory-leaks, nsstring, ekevent

我将 ARC 与 xCode 4.6 一起使用，并且在尝试访问`.notes`an 的属性`EKEvent`以分配给`cellForRowAtIndexPath`.

有趣的是，直到我在任何不`cellForRowAtIndexPath`调用`EKEvents`.

根据 Instruments 的说法，泄漏的发生是因为这条线：

```
eventNotes = [NSString stringWithFormat:@"%@", [currentEvent notes]]; 
```

![在此处输入图像描述](../Images/eff9b93f13c5877d9b155ef0e2b2bd70.png)

`eventNotes`是`ivar`我在我的 .h 文件中声明的。

我已经尝试了以下同时使用`ivar`和动态创建一个新的实例变量，但似乎没有任何效果：

```
NSString *eventNotes = [NSString stringWithFormat:@"%@", [currentEvent notes]];
eventNotes = [currentEvent notes];
eventNotes = currentEvent.notes;
NSString *eventNotes = [currentEvent notes];
NSString *eventNotes = currentEvent.notes;
NSString *eventNotes = [NSString stringWithString:[currentEvent notes]];
NSString *eventNotes = [NSString stringWithString:currentEvent.notes];
eventNotes = [NSString stringWithString:currentEvent.notes]; 
```

名单还在继续，这是我的 cellForRowAtIndexPathCode，发生泄漏的地方。我对内存管理完全陌生，所以请！是描述性的。

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath{

     //Custom Cell...
     UTATableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:@"cell"];
     cell.backgroundView = [[UIImageView alloc] initWithImage:[UIImage imageNamed:@"tableviewCell.png"]];
     cell.textLabel.backgroundColor = [UIColor clearColor];
     cell.detailTextLabel.backgroundColor = [UIColor clearColor];

     //reset cell view attributes
     cell.paidButton.tag = 1;
     [cell.paidButton setAlpha:1.0f];
     [cell.paidButton setSelected:NO];
     [cell.paidButton setEnabled:YES];

     cell.title.tag = 2;
     cell.title.text = NULL;

     cell.subtitle.tag = 3;
     cell.subtitle.text = NULL;

     [cell.paidButton addTarget:self action:@selector(togglePaid:) forControlEvents:UIControlEventTouchUpInside];

     if ([_yearSwitcher selectedSegmentIndex] == 0) {

          //lastYearsUTAEvents is an MSMutable array and a property of sharedEventData, which is a singleton class...             
          NSMutableArray *currentArray = [sharedEventData.lastYearsUTAEvents objectAtIndex:indexPath.section];
          EKEvent *currentEvent = [currentArray objectAtIndex:indexPath.row];
          NSDate *date = [currentEvent startDate];
          NSDateFormatter *dateFormatter = [[NSDateFormatter alloc] init];
          [dateFormatter setDateStyle:NSDateFormatterMediumStyle];
          [dateFormatter setTimeStyle:NSDateFormatterNoStyle];
          NSString *dateString = [dateFormatter stringFromDate:date];
          cell.title.text = dateString;

-leak---> eventNotes = [NSString stringWithFormat:@"%@", [currentEvent notes]];

          if ([eventNotes rangeOfString:@" - Paid"].location != NSNotFound) {
               cell.subtitle.text = [eventNotes stringByReplacingOccurrencesOfString:@" - Paid" withString:@""];
               [cell.paidButton setSelected:YES];

          } else {        
               cell.subtitle.text = eventNotes;
               [cell.paidButton setSelected:NO];
          }

      } else {

          // same as above but different array....
      }
  return cell; 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T23:07:35.697

**解决方案是在从 EKEvents 数组访问 EKEvent 对象时强制转换 (EKEvent *)**。

我从日历中获取事件并将它们存储在被`NSMutableArray`调用`lastYearsUTAEvents`（这是单例类的属性）中。

在访问数组中的事件时，我不得不使用强制转换来防止由于某种原因导致内存泄漏。所以而不是：

```
 NSMutableArray *currentArray = [sharedEventData.lastYearsUTAEvents objectAtIndex:indexPath.section];
 EKEvent *currentEvent = [currentArray objectAtIndex:indexPath.row]; 
```

我将对象转换为**(EKEvent *)**，同时将其从数组中取出，现在没有任何泄漏。（我还把前面2行代码优化成了1行）：

```
EKEvent *currentEvent = (EKEvent *)[[sharedEventData.thisYearsUTAEvents objectAtIndex:indexPath.section] objectAtIndex:indexPath.row]; 
```

起初，我什至对能够更改`.notes`属性感到困惑，因为在[文档](https://developer.apple.com/library/ios/documentation/EventKit/Reference/EKCalendarItemClassRef/Reference/Reference.html#//apple_ref/doc/uid/TP40010882-CH1-SW12)中，它是一个`NSString`，而不是一个`NSMutableString`，所以我假设当你保存一个 EKEvent（或者，在我的情况下，编辑一个）它保存了现有的，因为没有用于保存事件的替换方法。仅保存和删除。

最令人困惑的`.notes`是，它甚至不是`EKEvent`. 它是 的财产[`EKCalendarItem`](https://developer.apple.com/library/ios/documentation/EventKit/Reference/EKCalendarItemClassRef/Reference/Reference.html#//apple_ref/doc/uid/TP40010882-CH1-SW12)。

希望这对将来的人有所帮助...

# java - 为什么从十六进制转换为十进制时会出现 NumberFormatException，我该如何防止它？- 爪哇

> ID：14657613
> 
> 赞同：0
> 
> 时间：2013-02-02T01:18:07.437
> 
> 标签：java, hex, decimal

这是我将字符串十六进制转换为十进制的方法：

```
private int fromHexToPercent(String hex){
    int decimal = Integer.parseInt(hex, 16);
    return decimal;
} 
```

当我在这些值上调用它时：`#ffe87e, #ffc6bb, #528b7a, #9b81ff, #7d6a32, #000c40`除其他外，我在这一行得到以下异常：

```
 int decimal = Integer.parseInt(hex, 16); 
```

错误：

```
at java.lang.NumberFormatException.forInputString(NumberFormatException.java:65)
    at java.lang.Integer.parseInt(Integer.java:481) 
```

这是我从 rgb 转换为 hex 的方法，我觉得 Java 在这一行有问题：hex = "0" + hex;。但它需要在那里才能获得正确的十六进制代码。

```
 public static String toHex(int r, int g, int b) {
return "#" + toBrowserHexValue(r) + toBrowserHexValue(g) +  toBrowserHexValue(b);
}

private static String toHexValue(int number) {
    String hex = Integer.toHexString(number & 0xff);
    while (hex.length() < 2) {
        hex = "0" + hex;
    }
    return hex;
} 
```

真的希望有人能看到这个问题的解决方案=）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T01:33:01.683

唯一有效的十六进制数字是 0-9 和 af（或 AF）。`#`不是有效的十六进制数字。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T01:20:33.867

只需`#`从十六进制值中删除。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-02T01:21:33.973

您应该改为使用不以未知字符开头的数字。比如`#`和`0x`。

# unreal-development-kit - 未分配 VariableLinks 中的 PropertyName（UDK/虚幻脚本）

> ID：14657618
> 
> 赞同：0
> 
> 时间：2013-02-02T01:18:36.530
> 
> 标签：unreal-development-kit, unrealscript, kismet-udk

所以基本上我有一个自定义的 SequenceCondition，它有一个接受属性名的 VariableLink，当我运行代码时，我总是得到错误（ActivateOutputLink（1）），因为我的属性值总是“无”。被链接的项目是一个名为 OHSQuest 的自定义类，我正在连接 kismet 中的任务。这是代码：

```
// extend UIAction if this action should be UI Kismet Action instead of a Level Kismet Action
class OHSQuestCompare extends SequenceCondition;

var() OHSquest questToCompare;
event Activated()
{
    local OHSPlayerController PC;

    local int i;
    PC=OHSPlayerController(GetWorldInfo().GetALocalPlayerController());

    for(i=0;i<PC.quests.Length;++i)
    {
        if(PC.quests[i].sQuestDescription==questToCompare.sQuestDescription)
            ActivateOutputLink(0);
    }
    ActivateOutputLink(1);

}

defaultproperties
{
    ObjName="QuestCompare"
    ObjCategory="Quest"
    bCallHandler=false;

    InputLinks(0)=(LinkDesc="In")
    OutputLinks(0)=(LinkDesc="True")
    OutputLinks(1)=(LinkDesc="False")
    bAutoActivateOutputLinks=false;
    VariableLinks.Empty;
    VariableLinks(0)=(ExpectedType=class'OHSQuest',bWriteable=true,LinkDesc="Quest To Compare",PropertyName=questToCompare);
} 
```

我还有另一个自定义 SequenceAction，它接受一个 OHSQuest 的变量链接，它工作正常。知道为什么这个没有被填写吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T01:22:57.677

我认为您的 ExpectedType 可能需要是“SeqVar_Object”？

# c# - linq except() 方法的意外行为

> ID：14657620
> 
> 赞同：1
> 
> 时间：2013-02-02T01:19:05.847
> 
> 标签：c#, linq

```
class Program
{
    static void Main(string[] args)
    {
        List<string> aList = new List<string>();
        List<string> bList = new List<string>();
        List<string> answerList = new List<string>();
        aList.Add("and");
        aList.Add("and");
        aList.Add("AND");
        aList.Add("And");
        aList.Add("not");
        aList.Add("noT");
        bList.Add("NOt");
        answerList = aList.Except(bList, StringComparer.InvariantCultureIgnoreCase).ToList();

        foreach (var word in answerList)
        {
            Console.WriteLine(word);
        }
    } 
```

上述程序的预期行为是删除 aList 中所有出现的“not”并返回 {and, and, AND, And}。似乎“StringComparer.InvariantCultureIgnoreCase”已经删除了单词“and”的所有重复项，并且在 answerList 中只返回了一次出现的 {and}。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-02T01:25:45.100

这是我直觉所期望的结果。

除了返回设置的差异，并且您明确声明您希望使用不区分大小写的比较。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-02T01:44:33.770

从（强调我的）[的文档中：`Except()`](http://msdn.microsoft.com/en-us/library/bb300779.aspx)

> 通过使用默认相等比较器比较值来产生两个序列的**集合差**。

因此，`Except()`返回一个*set*，这意味着它最多返回每个字符串一次。既然你告诉它应该忽略大小写，你就会得到你得到的输出。

要解决此问题，请使用不对集合进行操作的方法，例如`Where()`：

```
answerList = aList.Where(
    a => !blist.Contains(a, StringComparer.InvariantCultureIgnoreCase))
    .ToList(); 
```

与(O( *a* + *b* )) 相比，这种方法很慢 (O( *a* · *b* ) )，但对于短序列来说这应该不是问题。`Except()`

# sql - 使用 Sequel，我可以使用 FROM 子句创建 UPDATE 语句吗

> ID：14657621
> 
> 赞同：5
> 
> 时间：2013-02-02T01:19:17.153
> 
> 标签：sql, ruby, sequel

使用[Sequel](http://sequel.rubyforge.org)我想创建一个如下所示的 UPDATE 语句（来自[Postgres 文档](http://www.postgresql.org/docs/9.1/static/sql-update.html)）

```
UPDATE employees SET sales_count = sales_count + 1 FROM accounts
  WHERE accounts.name = 'Acme Corporation'
  AND employees.id = accounts.sales_person; 
```

但是，查看[Sequel 文档](http://sequel.rubyforge.org/rdoc/classes/Sequel/Dataset.html#method-i-update)并不清楚在哪里可以创建 FROM 子句。

有没有办法做到这一点？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-02T01:59:05.313

好的，Ben Lee 的回答让我朝着正确的方向前进。解决方案：

```
DB[:employees].from(:employees, :accounts).
  where(:accounts__name => 'Acme Corporation').
  update_sql(:employees__sales_count => "employees.sales_count + 1".lit) 
```

我对`.lit`这里的使用有点不确定，但它似乎确实可以解决问题。（另外，我使用`update_sql`而不是`update`生成 SQL 输出，而不是运行命令。）

结果，根据需要：

```
UPDATE "employees" 
   SET "employees"."sales_count" = employees.sales_count + 1 
  FROM "accounts"
 WHERE ("accounts"."name" = 'Acme Corporation') 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-06-11T14:57:02.840

其他人的答案都有一个微小的多余条款。

```
DB.from(:employees, :accounts).
  where(:accounts__name => 'Acme Corporation').
  update_sql(:employees__sales_count => "employees.sales_count + 1".lit) 
```

如果您正在使用两个表执行 from()，则 DB[...] 中的一个将被忽略。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-02T01:41:31.807

您可以使用常规连接吗？这不完全是您的查询，但它应该实现您的目标，对吗？

```
DB[:employees].left_outer_join(:accounts, :sales_person => :id).
    where('accounts.name' => 'Acme Corporation').
    update('employees.sales_count' => 'employees.sales_count' + 1) 
```

# c++ - c++ 尝试通过替换测试来优化代码

> ID：14657627
> 
> 赞同：3
> 
> 时间：2013-02-02T01:20:01.233
> 
> 标签：c++, optimization

我正在查看其他人编写的代码，它有很多调试部分，类型

```
if(0) { code } 
```

或者`if(1) { code }`

或者`if(false) { code }`

甚至还有

```
#if(0)
#endif 
```

（虽然它没有变灰 - 我认为它应该）

`#if 0`我想知道，如果我用一些（或）替换这些`#ifdef _DEBUG`，是否可以优化代码？- 或者 - 它不会有任何区别？

我认为这可能会有所帮助，因为我已经看到这些部分中的代码变灰了 - 我认为该代码已从 Release 可执行文件中删除......因此使其更快。真的吗 ？

我正在考虑的代码在可以被多次调用的函数内部......

编辑：我所指的代码正在运行数百万次。我知道 if(0) 的内容将被忽略...

我也意识到能够通过将测试从 0 切换到 1 来轻松调试问题的好处......

我的问题是，我添加数百万次测试 if(0) 并没有增加开销的事实......我试图找出可以使这段代码花费更少时间的所有事情。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T01:23:19.700

如果放置在这些 IF 中的表达式在**编译时是常量且可确定的**，那么您几乎可以肯定编译器已经为您从代码中删除了它们。

当然，如果您在调试模式下编译，和/或如果您将优化级别设置为零，那么编译器可能会跳过它并离开这些测试 - 但对于简单的零/一/真/假值，这是极不可能的.

对于编译时常量分支，您可以确定编译器删除了死分支。

它甚至可以删除看起来很复杂的情况，例如：

```
const int x = 5;

if( 3 * x * x < 10 ) // ~ 75 < 10
{
    doBlah(); // skipped
} 
```

但是，如果 X 处没有那个 'const' 标记，表达式的值在编译时可能无法确定，它可能会“泄漏”到实际的最终产品中。

此外，以下代码中的表达式值不一定是编译时常量：

```
const int x = aFunction();

if( 3 * x * x < 10 ) // ~ 75 < 10
{
    doBlah(); // skipped
} 
```

X 是一个常数，但它是用函数的值初始化的。X 很可能在编译时无法确定。在运行时，函数可以返回任何值*)，因此编译器必须假定 X 是未知的。

因此，如果有可能，请使用预处理器。在微不足道的情况下不会做太多，因为编译器已经知道了。但案例并不总是微不足道的，您会经常注意到变化。当优化器无法推断出这些值时，它会留下代码，即使它已经死了。另一方面，预处理器保证在编译和优化之前删除禁用的部分。此外，使用预处理器至少会加快编译速度：编译器/优化器不必跟踪常量/计算/检查分支等。

*) 可以编写一个方法/函数，它的返回值实际上在编译和优化阶段是可确定的：如果函数很简单并且被内联，它的结果值可能会与一些分支一起被优化。但是即使您可以在某种程度上依赖于删除 if-0 子句，也不能过多地依赖内联。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-02T01:24:10.593

如果您在`if (0)`块内有代码，则编译器生成的代码将与该块在任何合理的编译器上不存在一样。仍将检查代码是否存在编译时错误。（假设你里面没有任何跳转标签或类似的奇怪东西。）

如果代码`if (1)`块内有代码，则编译器生成的代码将与代码仅在大括号内一样。这是为代码块提供自己的范围的常用方法，以便在需要的地方破坏局部变量。

如果您`ifdef`输出代码，则编译器会完全忽略它。代码可能完全是胡说八道，包含语法错误或其他任何东西，编译器不会关心。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-02T01:27:02.230

通常，`#if 0`用于删除代码同时仍然保留它 - 例如，为了轻松与选项进行比较，我有时会这样做：

```
#if 1
   some sort of code 
#else
   some other code
#endif 
```

这样，我可以在两种选择之间快速切换。

在这种情况下，预处理器只会在代码中保留两个选项之一。

`if(0)`or的结构`if(1)`类似 - 编译器几乎会删除 if，并且在 0 的情况下也会删除 if 语句的其余部分。

我认为将这类东西留在“已完成”的代码中是相当草率的，但它对于调试/开发非常有用。

例如，假设您正在尝试一种新方法来做更快的事情：

```
if (1) 
{
   fast_function();
}
else
{
    slower_function();
} 
```

现在，在您的一个测试用例中，结果显示错误。因此，您想快速返回`slower_funcion`并查看结果是否相同。如果相同，那么您必须查看自上次通过以来发生的其他变化。如果使用较慢的函数没问题，则返回并查看为什么 fast_function() 在这种情况下不能正常工作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-02T01:21:55.753

这是真的（取决于您的构建设置和预处理器）。

将调试代码放入`#ifdef _DEBUG`（或类似的）是一种标准方法，可以将这些完全排除在您的发布版本之外。通常调试版本`#define`是它，而发布版本没有。

但是，通常情况下，如果给定适当的优化标志，编译器也*应该*删除诸如 之类的代码`if (0)`，但这会给编译器和程序员带来额外的工作（现在您必须全部更改！）。我肯定会把它留给预处理器。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-02T01:25:22.093

你是对的。如果你编译，`#define DEBUG 0`那么你实际上将`#if DEBUG`在编译时删除所有块。因此，将有更少的代码，它会运行得更快。

只需确保`#define DEBUG 0`在发布时发布代码即可。

一个好的优化编译器（GCC，MSVC）将完全删除`if(0)`和`if(1)`从代码中删除......转换为机器代码不会测试这些条件......

# python - 如何使用记录器在 python 中静音特定日志？

> ID：14657630
> 
> 赞同：1
> 
> 时间：2013-02-02T01:20:53.410
> 
> 标签：python, logging

我正在努力做一些应该很简单的事情。我正在研究一些使用一些非常冗长的调试日志调用代码的单元测试。我如何告诉日志记录模块“将所有内容设置为调试，除了这个模块，让它成为信息”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T01:45:03.380

[禁用查询日志记录 - Google Appengine SDK Python](https://stackoverflow.com/questions/13955651/disable-query-logging-google-appengine-sdk-python/13958187#13958187)

检查日志过滤器，它可以用作基于模块的过滤器。

# c# - 事件的 CRM Linq 查询 - 无效的 where 条件

> ID：14657633
> 
> 赞同：0
> 
> 时间：2013-02-02T01:21:35.363
> 
> 标签：c#, linq, dynamics-crm-2011

**编码：**

```
var site = CrmRepository.QueryFor<Account>()
                .Where(a => a.iss_OperatorSiteId == OperatorSiteId.ToString())
                .FirstOrDefault();
SiteCases = CrmRepository.QueryFor<Incident>()
                    .Where(i => i.AccountId.Id == site.Id
                                && (i.iss_Status != new OptionSetValue(
                                      (int)StatusOptionSet.Closed) 
                                   && i.iss_Status != new OptionSetValue(
                                      (int)StatusOptionSet.PendingFinalization))
                                || (i.iss_ResolutionDate == null 
                                    || i.iss_ResolutionDate > 
                                          DateTime.Today.AddDays(-30))
                                || (ShowFullCaseHistoryBox.Checked))
                    .AsEnumerable()
                    .Select(i => new CrmCaseListItem(i))
                    .ToList(); 
```

**细节：**

*   `CrmRepository`是由 CrmSvcUtil 生成的 CRM Linq 上下文的包装器，使其适应`IRepository`用于其他数据存储的通用接口。该`QueryFor<Incident>()`调用等效`CreateQuery<Incident>()`于对上下文本身的调用。

*   `iss_Status`是“选项集”类型的属性。`StatusOptionSet`是一个枚举，旨在简化代码中选项值的使用。

*   `iss_ResolutionDate`是不言自明的，为了简单起见，包括而不是引用案例解决记录，因为在我们的工作流程中，案例实际上并没有“解决”，直到问题不仅得到解决，而且案例记录和相关记录已经已处理和审核，因此对于 SLA 义务，我们需要知道问题何时解决，而不是应用解决方案完全关闭案例的时间。

*   基本思想是显示与特定帐户相关联的事件（我们称之为案例），这些事件要么处于打开状态，要么在过去 30 天内已关闭（已解决），*或者*用户希望查看完整历史记录（在在这种情况下，将检索所有已打开或已关闭的案例）。

*   `ShowFullCaseHistoryBox`是一个 Winforms 复选框；选中后，应检索帐户的完整案例历史记录。

*   `CrmCaseListItem`是用作 DataGridView 支持的 DTO；它在其构造函数中获取事件并公开显示在网格上的属性。

**错误：**

> 'where' 条件无效。实体成员正在调用无效的属性或方法。

**问题：**

我想做什么是无效的？第一个子句匹配帐户 ID（因此需要一个投影），它本身工作得很好，所以我必须假设它是其他子句之一，但我无法确定是哪一个。正在检查的事件的属性没有被投影或操纵，这对于 Queryables 来说是通常的禁忌，所以我在这里真的很茫然。

**编辑（已再次编辑）：**

在通过一些测试来评估每个单独的条款之后，使用到目前为止的一些建议并将条款中所有已知的好元素重新组合在一起，这是最接近的工作：

```
var site = CrmRepository.QueryFor<Account>()
                .Where(a => a.iss_OperatorSiteId == OperatorSiteId.ToString())
                .FirstOrDefault();
SiteCases = CrmRepository.QueryFor<Incident>()
                .Where(i => (i.AccountId.Id == site.Id) &&
                       (
                           (i.iss_Status.Value != (int) StatusOptionSet.Closed
                            && i.iss_Status.Value != (int) StatusOptionSet.PendingFinalization)
                           || (i.iss_ResolutionDate != null
                               && i.iss_ResolutionDate.Value > DateTime.Today.AddDays(-30))
                       //|| ShowFullCaseHistoryBox.Checked
                       )
                )
                .AsEnumerable()
                .Select(i => new CrmCaseListItem(i))
                .ToList(); 
```

唯一仍然不起作用的是检查 CheckBox 以显示完整的案例历史记录（基本上覆盖了前两个关于状态或解决日期的条款中的任何一个）。它不能按原样工作（取消注释内联表达式）或者如果它被提取到变量中。其他一切似乎都按预期工作。这个功能是可选的，所以如果它根本不起作用，没办法，不怎么做，那么我会轻轻地把它告诉客户，但我真的很喜欢这个工作，因为我离得太近了。有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T14:40:23.713

LINQ to CRM 必须转换为查询表达式。在处理查询表达式时，您必须使用选项集值的 int 值。尝试在您的选项集属性上调用 .Value ，然后将您的枚举转换为预期值，看看是否可以解决您的问题。

您还可以使用[Early Bound Generator](https://xrmearlyboundgenerator.codeplex.com/)，它会在您的实体上创建 Early Bound Enum 属性。然后，您不必将枚举转换为整数，也不必放入`.value`其中。

# javascript - 如何用 javascript 编写 html 并将其显示在滑块上？

> ID：14657635
> 
> 赞同：-2
> 
> 时间：2013-02-02T01:21:45.283
> 
> 标签：javascript, html

我创建了一个基本滑块，在使用 javascript 时每 5 秒运行一次图像。我的滑块工作得很好，但我不想再将它用作图像滑块。我想创建一个具有更多 html 设计功能的 div 并将其发布在我的滑块中而不是我的图像中。按照下面的代码，我需要更改和添加什么才能使其正常工作？

```
 <!doctype html>
 <html>
 <head>
 <title>Ad Slider</title>
 <style>
 #slider
 {
    width: 800px;
    height: 200px;
 }
 #sliderImages
 {
    width: 100%;
    height: 100%;
    border: 1px solid #06c;
border-radius: 10px;
 }
 </style>
 <script type = "text/javascript">
var image1 = new Image();
image1.src = "sky.jpg";
var image2 = new Image();
image2.src = "chatImage.jpg";
var image3 = new Image();
image3.src = "orange.jpg";
 </script>
 </head>
 <body>
 <div id = "slider">
    <img id = "sliderImages" src = "sky.jpg" name = "slide" />
    <script type = "text/javascript">
   var sliderAd = 1
   function slideAds()
   {
      if (!document.images)
      {
     return;
      }
      document.images.slide.src = eval("image"+sliderAd+".src")
      if (sliderAd < 3)
      {
         sliderAd++;
      }
      else
      {
     sliderAd = 1;
      }
      setTimeout("slideAds()",5000)
   }
   slideAds()
</script>
 </div>
 </body>
 </html> 
```

现在不是添加这些图像，而是如何添加这种类型的内容，但以与图像相同的方式工作？

```
 <div>
    <p>Some Content</p>
 </div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T01:44:30.790

有很多方法可以编写您要查找的内容。这是您的代码的增强版本...您可以将任何您想要的 HTML 放入 innerHTML。

将来，您最好使用 Google 来阅读 Javascript 的基础知识...

```
<div id = "container">
</div>

<script type = "text/javascript">
MAXSLIDES = 2
slideText = 1

function slideAds() {
    container = document.getElementById("container")

    if(slideText == 1) {
        container.innerHTML = "test1"
    } else if (slideText == 2) {
        container.innerHTML = "test2"
    }

    slideText += 1
    if(slideText > MAXSLIDES) { slideText = 1 }
    setTimeout("slideAds()",5000);
}

slideAds()

</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T02:01:53.553

最简单的方法之一就是创建一个您需要的 html 数组，然后遍历它，将每个字符串作为 html 插入到您的持有人 div 中：这是您的问题中的一个示例，我唯一使用 jQuery 它更容易方法。

```
 <!doctype html>
  <html>
  <head>
  <title>Ad Slider</title>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js"></script>
  <style>
    #slider
   {
      width: 800px;
      height: 200px;
   }
   #sliderImages
   {
      width: 100%;
      height: 100%;
      border: 1px solid #06c;
  border-radius: 10px;
   }
   </style>
<script type = "text/javascript">

var arrayOfDiv = new Array();
arrayOfDiv[0] = "<div style='background-color:#FF0'>this is first div!</div>";
arrayOfDiv[1] = "<div style='background-color:#0ff'>this is second div!</div>";
arrayOfDiv[2] = "<div style='background-color:#f0f'>this is third div!</div>";

      var sliderAd = 0;
     function slideAds()
     {

        $("#sliderImages").html(arrayOfDiv[sliderAd]);
        if (sliderAd < arrayOfDiv.length-1)
        {
           sliderAd++;
        }
        else
        {
       sliderAd = 0;
        }
        setTimeout("slideAds()",5000);
     }

      $(function(){
       slideAds();  
     });
  </script>
   </head>
   <body>
   <div id = "slider">
      <div id = "sliderImages" ></div>

   </div>
   </body>
   </html> 
```

# bash - 将多个数据文件与标题组合，同时添加数据列

> ID：14657638
> 
> 赞同：1
> 
> 时间：2013-02-02T01:21:57.350
> 
> 标签：bash, shell

我有多个制表符分隔的数据文件，格式为`jan06.txt, feb06.txt, ..., dec07.txt`.

在每个文件中，它看起来像：

```
Header1 Header2 Header3 ...
Data1   Data2   Data3   ...
Data4   Data5   Data6   ...
...     ...     ... 
```

我想要做的是将所有数据文件合并到一个数据文件中，顶部只有一个标题，但还包括一个包含月份和年份的新数据列，这样我就不会从文件名。所以我的新的单一数据文件将包含：

```
Date   Header1 Header2 Header3 ...
200601 Data1   Data2   Data3   ...
200602 Data4   Data5   Data6   ...
...    ...     ...     ... 
```

其中 200601 表示 Jan 06，200602 表示 Feb 06，以此类推。

我知道如果我做类似的事情`cat *.txt > data.txt`，我可以合并我所有的文件。但是，仍然存在两个问题：

1.  我在每个文件中都有一个可以连接的标题，这是我不想要的。
2.  我会丢失存储在文件名中的月份信息。

我想我可以用 和 的某种组合来做到这一点`cat`，`sed`但我不知道如何开始。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T01:41:24.753

例如：

```
 echo -e 'Date\tHeader1\tHeader2\tHeader3 ...' >out
 sed -n -e 's/^/200601\t/' -e '2,$p' <jan06.txt >>out
 sed -n -e 's/^/200602\t/' -e '2,$p' <feb06.txt >>out 
```

等等

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-02T01:41:33.870

尝试以下操作：

```
function month() {

    case ${1:0:3} in
        "jan") echo "20${1:3:2}01" ;;
        "feb") echo "20${1:3:2}02" ;;
        "mar") echo "20${1:3:2}03" ;;
        "apr") echo "20${1:3:2}04" ;;
        "may") echo "20${1:3:2}05" ;;
        "jun") echo "20${1:3:2}06" ;;
        "jul") echo "20${1:3:2}07" ;;
        "aug") echo "20${1:3:2}08" ;;
        "sep") echo "20${1:3:2}09" ;;
        "oct") echo "20${1:3:2}10" ;;
        "nov") echo "20${1:3:2}11" ;;
        "dec") echo "20${1:3:2}12" ;;
    esac

}

# Header
directory="your_directory/"
echo -en "Date\t" > data.txt
head -1 $(ls "${directory}"/*.txt | head -1) >> data.txt

# Contents
for file in "${directory}"/*.txt; do

    date="${file##*/}"
    date="$(month ${date%*.txt})\t"
    tail -n +2 ${file} | sed 's/^/'${date}'/' >> data.txt

done 
```

# c - 编译良好的 C 程序中的分段错误

> ID：14657639
> 
> 赞同：1
> 
> 时间：2013-02-02T01:22:14.063
> 
> 标签：c

我正在解决有关 USACO 的问题。在这个问题中，我必须将两个字符串作为输入并计算模数 47 的数值。如果值相同，则要打印 GO，否则必须打印 STAY。初始数值将通过取字母表的数值的乘积来计算（A 为 1，Z 为 26），然后使用模数计算最终数字。

我的程序正在编译，没有任何错误，并且在我的计算机上运行良好。但是，它显示分段错误作为分级计算机的执行错误。程序和输出如下：-

程序：-

```
#include<stdio.h>
#include<string.h>
main()
{
    int cal(char *ptr);
    char *comet,*group;
    int a,b;
    scanf("%s",comet);
    a=cal(comet);
    scanf("%s",group);
    b=cal(group);
    if(a==b)
        printf("GO");
    else
        printf("STAY");
    return 0;
}
int cal(char *ptr)
{
    int i=0,c,prod=1,mod;
    while(ptr[i]!='\0')
        {
            if(ptr[i]>='A'&&ptr[i]<='Z')
            {
                c=ptr[i]-'@';
                prod=prod*c;
                i++;
            }
        }
    mod=prod%47;
    return mod;
} 
```

输出：-

![在此处输入图像描述](../Images/d7a19da03932a60d1d562ef13b7d9b64.png)

我的问题是如何查明分段错误。我已阅读有关此故障的信息，但不知道在此程序中该做什么。任何帮助都会很棒。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T01:22:55.370

```
char *comet,*group;
int a,b;
scanf("%s",comet); 
```

`comet`指针未初始化。您需要分配内存并`comet`在此分配的内存上做点，否则`scanf`将在随机位置写入字节，这可能会使您的系统崩溃。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-02T01:26:11.953

`comet`您永远不会为or分配空间`group`。使用[`malloc()`或类似](http://pubs.opengroup.org/onlinepubs/009695399/functions/malloc.html)方法为这些指针留出内存，以便您可以实际存储它们指向的内容。

```
#define MAX_STRING_LENGTH 256

...

char *comet, *group;
int a, b;

comet = NULL;
comet = malloc(MAX_STRING_LENGTH);
if (!comet) {
   fprintf(stderr, "ERROR: Could not allocate memory to comet\n");
   return EXIT_FAILURE;
}
scanf("%s",comet);

/* repeat for other pointers, as needed */

/* ... */

/* free up allocated memory at the end of the program to help prevent leaks */

free(comet);
comet = NULL; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-02T01:26:50.120

comet 和 group 都是未初始化的指针，它们没有分配任何内存来存储输入字符串。

你的程序至少应该这样做。根据您的需要增加 MAX_STRING_SIZE 的大小。

```
#define MAX_STRING_SIZE 100
char comet[MAX_STRING_SIZE];
char group[MAX_STRING_SIZE]; 
```

scanf 仍然存在缓冲区溢出的风险。您可以查看[这篇](https://stackoverflow.com/questions/1621394/how-to-prevent-scanf-causing-a-buffer-overflow-in-c)文章，了解避免缓冲区溢出的一些可能方法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-02T01:51:17.677

你`while`的高度可疑：`i`仅当`ptr[i]`是大写字母时才增加。如果不是，应该怎么办？如果你有一个铁定的保证只有大写字母会出现，你可以写：

```
prod = 1;
while(*ptr) {
  prod *= *ptr - 'A' + 1;
  ptr++;
} 
```

（在我破解 ascii(7) 之前，你`ptr[i] - '@'`让我摸不着头脑。我相信我的版本更清晰，任何能胜任一半的编译器都会给出相同的代码。）或者，更惯用：

```
int cal(char *ptr)
{
    int prod = 1;

    while(*ptr)
       prod *= *ptr++ - 'A' + 1;
    return prod % 47;
} 
```

请注意产品不会溢出，也许对每个字符进行模数：

```
int cal(char *ptr)
{
    int prod = 1;

    while(*ptr) {
       prod *= *ptr++ - 'A' + 1;
       prod %= 47;
    }
    return prod;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-02T02:05:17.430

“在我的计算机上运行良好”在您的情况下这是不可能的，因为您没有使用任何编译器特定的代码（例如 turbo c 的 getch）

您没有为存储字符串分配内存。指针 comet 和 group 不指向任何东西。scanf 需要一个地址来写入输入，但指针不包含地址，这就是您遇到分段错误的原因。您可以使用 malloc（或 calloc）分配内存，也可以定义字符数组。

更正后的代码是

```
#include<stdio.h>
#include<string.h>
#define MAXLENGTH 100
int main()
{
    int cal(char *ptr);
    char comet[MAXLENGTH],group[MAXLENGTH];
    int a,b;
    scanf("%s",comet);
    a=cal(comet);
    scanf("%s",group);
    b=cal(group);
    if(a==b)
        printf("GO");
    else
        printf("STAY");
    return 0;
}
int cal(char *ptr)
{
    int i=0,c,prod=1,mod;
    while(ptr[i]!='\0')
    {
        if(ptr[i]>='A'&&ptr[i]<='Z')
        {
            c=ptr[i]-'@';
            prod=prod*c;
            i++;
        }
    }
    mod=prod%47;
    return mod;
} 
```

# c# - 使用 StreamWriter 和 FileStream 写入 txt 文件

> ID：14657643
> 
> 赞同：24
> 
> 时间：2013-02-02T01:22:57.620
> 
> 标签：c#

`StreamWriter`在 .NET 4.5 中使用a将文本附加到现有文件时，我遇到了一些有趣的事情`FileStream`（没有尝试过任何较旧的框架）。我尝试了两种方法，一种有效，一种无效。我想知道两者之间的区别是什么。

两种方法都在顶部包含以下代码

```
if (!File.Exists(filepath))
    using (File.Create(filepath)); 
```

我在`using`声明中创建了该文件，因为我通过个人经验发现这是确保应用程序完全关闭文件的最佳方式。

非工作方式：

```
using (FileStream f = new FileStream(filepath, FileMode.Append,FileAccess.Write))
    (new StreamWriter(f)).WriteLine("somestring"); 
```

使用这种方法，最终不会将任何内容附加到文件中。

工作方法：

```
using (FileStream f = new FileStream(filepath, FileMode.Append,FileAccess.Write))
    using (StreamWriter s = new StreamWriter(f))
        s.WriteLine("somestring"); 
```

我做了一些谷歌搜索，不知道要搜索什么，也没有找到任何有用的信息。那么，为什么匿名`StreamWriter`在（非匿名？命名？）`StreamWriter`工作的地方失败？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-02-02T01:34:12.773

听起来您没有刷新流。

[http://msdn.microsoft.com/en-us/library/system.io.stream.flush.aspx](http://msdn.microsoft.com/en-us/library/system.io.stream.flush.aspx)

看起来 StreamWriter 在写入最终目的地之前写入缓冲区，在本例中为文件。您还可以设置 AutoFlush 属性，而不必显式刷新它。

[http://msdn.microsoft.com/en-us/library/system.io.streamwriter.autoflush.aspx](http://msdn.microsoft.com/en-us/library/system.io.streamwriter.autoflush.aspx)

要回答您的问题，当您使用“使用”块时，它会调用 StreamWriter 上的 dispose，而后者又必须调用 Flush。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-02-02T01:30:20.463

两个代码片段之间的区别在于使用`using`. [该`using`语句](http://msdn.microsoft.com/en-us/library/yh598w02%28v=vs.110%29.aspx)将对象放置在块的末尾。

A`StreamWriter`在将数据写入底层流之前对其进行缓冲。处理`StreamWriter`刷新缓冲区。如果您不刷新缓冲区，则不会写入任何内容。

来自[MSDN](http://msdn.microsoft.com/en-us/library/system.io.streamwriter.close.aspx)：

> 您必须调用 Close 以确保所有数据都正确写入底层流。

另请参阅：[我什么时候应该在 C# 中使用“使用”块？](https://stackoverflow.com/questions/567138)

# java - Java错误返回密码

> ID：14657649
> 
> 赞同：-1
> 
> 时间：2013-02-02T01:23:56.013
> 
> 标签：java

> **可能重复：**
> [Java String.equals 与 ==](https://stackoverflow.com/questions/767372/java-string-equals-versus)

主要代码：

```
String pass = getPassowrd();
    if(pass == "hi"){
        System.out.println("Correct Password");
        loggedin = true;
        new Home();
    }else{
        System.out.println("Incorrect Password");
    } 
```

获取密码代码：

```
private static String getPassword() {
    java.util.Scanner keyboard = new java.util.Scanner(System.in);
    return keyboard.nextLine();
} 
```

我究竟做错了什么？

谢谢，艾萨克

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T01:27:34.170

您正在比较参考，`.equals`用于检查`String`内容，替换

```
if (pass == "hi") { 
```

和

```
if (pass.equals("hi")){ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-02T01:28:45.957

做 a`pass.equals("hi")`而不是`pass == "hi"`
With an `==`operator 你真正比较的是引用，即你正在比较 pass 中的值，它只是它在内存中指向的字符串的地址和指向常量字符串 "hi "存储在内存中。

使用 equals 时，您实际上是在将字符串“hi”与 pass 指向内存中的字符串进行比较。

# algorithm - 合成图层样式

> ID：14657653
> 
> 赞同：1
> 
> 时间：2013-02-02T01:24:05.060
> 
> 标签：algorithm, photoshop, layer, shadow, composition

我正在尝试从 Adob​​e Photoshop 实现“内阴影”样式。

我有 3 个 RGBA 层：源层（棕色）、内阴影层（白色）和背景层。它们可以具有类似 Photoshop 的混合模式（正常、正片叠底、颜色加深...） - 混合不是关联的！

我想将它们混合在一起，就像 Photoshop 中的图层样式一样。当我将阴影 alpha 与源 alpha 相乘并混合（阴影覆盖（源覆盖背景））时，我在对象周围得到了深色轮廓，其中源 alpha 介于 0 和 1 之间。

Photoshop 参考在左边，我的结果在右边。

![](../Images/476356238d65544f703dd916b231884b.png)

“颜色叠加”和许多其他样式也会出现同样的问题。你知道如何正确地做到这一点 - 避免轮廓？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-19T18:24:41.327

[我在PDF 格式 1.7](http://wwwimages.adobe.com/www.adobe.com/content/dam/Adobe/en/devnet/pdf/pdfs/PDF32000_2008.pdf)的规范中找到了这个问题的答案，第 339 页。

因此，合成（**阴影**与（**源**与**背景**））是错误的。正确的做法是：

1.  将具有**背景的****源**合成到临时通道**C**中，忽略**源**的 alpha 并在任何地方使用 1.0 的 alpha 值。

*******   以标准方式将（未裁剪的）**阴影**与**C**合成到**C**中。

    *   使用**源**alpha 作为加权因子，计算**C**与**背景**的**加权**平均值。****** 

 ******如您所见，阴影与源和背景混合在一起。加权平均是我正在寻找的功能。******

# asp.net-mvc - 域模型与服务层中的 ASP.NET MVC 业务逻辑

> ID：14657656
> 
> 赞同：37
> 
> 时间：2013-02-02T01:24:17.623
> 
> 标签：asp.net-mvc, business-logic, service-layer, domain-model, anemic-domain-model

我一直在阅读有关在 ASP.NET MVC 项目中放置业务逻辑的位置一段时间，但我仍然无法弄清楚某些事情。

1**域模型**。这些到底是什么？在我的模型文件夹中，我只有一堆与我的数据库相对应的类。我首先使用 EF 代码。我假设这些是我的领域模型。

2-**服务层**。[这个答案](https://stackoverflow.com/questions/6341724/where-should-i-put-my-controller-business-logic-in-mvc3)暗示了一个服务层，我认为这很有意义。我决定和这个一起去。然而，[Martin Fowler 的“贫血域模型”](http://martinfowler.com/bliki/AnemicDomainModel.html)文章让我大吃一惊。

我不确定如何向我的域模型添加逻辑。

我经历了许多与业务逻辑相关的问题，每个问题都提出了 1 或 2。我不明白如何实现第一个。向实体类（对我来说是域模型）添加方法根本没有意义。为什么第二种方法被认为不好？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2013-02-02T01:38:15.180

首先，您的 Asp.Net MVC 项目中的 Model 文件夹应该用于 ViewModel。这些是控制器发送到视图的模型。它们应该针对 View 进行高度优化，这意味着只有 View 所需的属性，没有别的。

您所从事的领域模型与业务模型相同，属于您的业务层。Asp.Net MVC 项目中的 Model 文件夹是 UI 层的模型。

第二种方法，您的服务（真正的业务）层中的业务逻辑并不被认为是坏的。它是您的数据层和 UI 层（3 层架构）之间的一个非常好的缓冲区。您的数据层负责从 Web 服务或数据库获取数据，而您的业务/服务层负责将这些数据转换为业务/域模型。它还包含任何业务逻辑，例如计算等。

这些业务/领域模型通常是 POCO，但并非必须如此。这就是我有时设置商业模式的方式：

```
public class BusinessObject
{
    private DataObject _dataObject;

    public BusinessObject(DataObject dataObject)
    {
        _dataObject = dataObject;
    }

    public int BusinessId
    {
        get {return _dataObject.Id;}
        set {_dataObject.Id = value;}
    }

    public string Name
    {
        get {return _dataObject.Description;}
        set {_dataObject.Description = value;}
    }
} 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2013-02-02T01:29:26.907

我更喜欢在域模型中没有业务逻辑。我通常将我的域模型作为 POCO 来表示我的数据库表/模式。

使业务逻辑远离域模型将允许我在另一个项目中重用我的域模型。

您可以考虑在控制器和数据访问层/存储层之间设置一个中间层来处理这个问题。我将其称为服务层。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2014-03-25T16:06:16.100

我知道这已经得到解答，但我将模型分为 3 组

ViewModels - 这些是轻量级（通常是 poco）类，用于对您网站上的页面所需的数据进行建模。这些类处理向用户显示的普通样板文件，并在您要显示的数据更改时更改。

DomainModels - 这些通常是重量级的业务逻辑类。他们通常为您正在做的事情建模核心业务规则。这些类通常具有很强的凝聚力，并且是使您的网站与众不同的大部分工作发生的地方。我说这些模型通常是重量级的，但实际上如果你的项目所做的只是从用户那里获取数据并将其保存在数据库中，那么这个类将是一个小的数据映射类。很多时候，您会看到这些类由持久性模型和返回视图模型组成。

PersistenceModels - 这些是您的持久性机制的模型。对于我们大多数人来说，这意味着对数据库表进行建模，但也可能是从 api 请求返回的复杂 nosql 文档或 json（或其他）数据。他们的职责是处理您的外部数据所采用的普通样板。

还要记住，您并不总是需要在您的项目中包含所有这三种类型的模型。有时，您的视图模型将逐行显示您的持久性模型。在这种情况下，您将浪费您的客户的钱来编写整个内容两次并添加一个域模型以将一个映射到另一个。您是开发人员，您的工作是知道何时建造航空母舰去商店购买杂货。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2018-07-24T18:21:15.387

领域模型应该能够自己执行它们的工作并公开表示它们的状态和功能的属性和方法。它们充当模型运行所需的信息层次结构的根（聚合根）。它们保持隐藏状态，仅对服务可用。

服务通过从封装数据访问层的存储库中检索模型，然后调用方法/业务，将业务/域功能作为一组遵循消息模式（请求/响应）的 API 向外部世界（Web 服务、UI 等）公开模型上的功能，最后将它们保存回存储库。

有时感觉服务重复业务对象的方法，但在时间和实际实践中，实际情况并非如此。

在真正的领域驱动设计中，您至少需要 3 组对象。业务对象、业务对象和服务的存储库。

假设您的要求始终是每种类型的组件都由不同的团队编写。一个团队需要一个公开的服务而不知道细节，另一个团队不必在自己的服务上编写逻辑。然后，任何需要它的人都可以使用该服务，而无需深入研究核心模型本身。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2016-07-14T10:09:04.540

应用程序流控制逻辑属于控制器。

数据访问逻辑属于存储库。

验证逻辑属于服务层。

服务层是 ASP.NET MVC 应用程序中的一个附加层，它调解控制器和存储库层之间的通信。

服务层包含业务验证逻辑。

例如，产品服务层具有 CreateProduct() 方法。

CreateProduct() 方法调用 ValidateProduct() 方法来验证新产品，然后再将产品传递到产品存储库。

> 来源： [http ://www.asp.net/mvc/overview/older-versions-1/models-data/validating-with-a-service-layer-cs](http://www.asp.net/mvc/overview/older-versions-1/models-data/validating-with-a-service-layer-cs)

# java - Java 字符串到整数的转换

> ID：14657657
> 
> 赞同：-4
> 
> 时间：2013-02-02T01:24:28.180
> 
> 标签：java, string

> **可能重复：**
> [如何在 Java 中将字符串转换为 int？](https://stackoverflow.com/questions/5585779/how-to-convert-string-to-int-in-java)

我试图弄清楚如何将其中包含整数的字符串转换为整数变量。

代码：

```
import java.util.Scanner;

public class main {
    public static void main(String args[]) {
        Scanner input = new Scanner(System.in);
        System.out.println("Enter date of birth (MM/DD/YYYY):");
        String DOB = input.next();
        String month = DOB.substring(0, 1);
        String day = DOB.substring(3, 4);
        String year = DOB.substring(6, 9);
        int month1 = month;
        int age = 0;
        //age = 2013 - DOB - 1;
        int age2 = 0;
        age2  = age + 1;
        System.out.println("You are " + age + " or " + age2 + " years old");
    }
} 
```

我想把`String month`, `String day`, 和`Sting year`变成整数。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-02-02T01:28:14.297

采用 `int month = Integer.parseInt(stringMonth);`

# django - 第一次分页后，Django 搜索字段变为无

> ID：14657662
> 
> 赞同：1
> 
> 时间：2013-02-02T01:25:55.207
> 
> 标签：django, django-views

我有一个包含多个字段的搜索表单，并开发了一个允许搜索任何字段组合的搜索视图。这可以按预期工作并提供结果，直到第一次导航（使用“下一步”按钮）到分页创建对象的下一页。导航到“下一个”后，“ct”字段变为“无”。这是视图：

```
def search(request):
    q = request.GET.get('q')
    yr = request.GET.get('yr', 0)
    ct = request.GET.get('ct')
    question_set = Uroquiz.objects.all()

    if q:
        if not (yr or ct):
            question_set = Uroquiz.objects.filter(question__icontains=q)

    if yr:
        if not (q or ct):
            question_set = Uroquiz.objects.filter(year=yr)

    if ct:
        if not (q or yr):
            question_set = Uroquiz.objects.filter(cat__icontains=ct)

    if (q and yr):
        if not ct:
            question_set = Uroquiz.objects.filter(question__icontains=q).filter(year=yr)

    if (q and ct):
        if not yr:
            question_set = Uroquiz.objects.filter(question__icontains=q).filter(cat__icontains=ct)
    if (yr and ct):
        if not q:
            question_set = Uroquiz.objects.filter(year=yr).filter(cat__icontains=ct)
    if ((q and yr) and ct):
        question_set = Uroquiz.objects.filter(question__icontains=q).filter(year=yr).filter(cat__icontains=ct)
    if not ((q or yr) or ct):
            return render_to_response('search_form.html')
    paginator = Paginator(question_set, 1)
    page = request.GET.get('page')
    try:
        question_set = paginator.page(page)
    except PageNotAnInteger:
        question_set = paginator.page(1)
    except EmptyPage:
        question_set = paginator.page(paginator.num_pages)
    return render_to_response('search_results.html',
        {'question': question_set, 'q': q, 'yr': yr, 'ct': ct}) 
```

这是我的 search_results.html 的相关部分：

```
<div class="pagination">
    <span class="step-links">
        {% if question.has_previous %}
            <a href="?q={{ q }}&yr={{ yr }}&cat={{ ct }}&page={{ question.previous_page_number }}">previous</a>
        {% endif %}

        <span class="current">
            Page {{ question.number }} of {{ question.paginator.num_pages }}
        </span>

        {% if question.has_next %}
            <a href="?q={{ q }}&yr={{ yr }}&cat={{ ct }}&page={{ question.next_page_number }}">next</a>
        {% endif %}
    </span>
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T05:41:07.643

我想到了。我的网址应该使用“ct”而不是“cat”。简单的错误。感谢所有为我看这个的人。

# php - Mediawiki interwiki '这里有什么链接'

> ID：14657663
> 
> 赞同：2
> 
> 时间：2013-02-02T01:25:55.073
> 
> 标签：php, mediawiki

我如何编写一个 MediaWiki 扩展和/或模板来嵌入到 wiki A 的页面 X 中，在另一个 wiki 中对 A:X 的所有引用，就像法语维基百科中的一个页面能够显示一个列表，其中包含对它的所有引用英文版？

提前感谢您的任何建议和指导。

* * *

除了上述之外，我检查了 MW API 文档，发现查询操作有一个 iwbacklink 值，它列出了所有跨维基反向链接。此查询返回一个 XML 文件，其中包含 A 中指向页面 X 的所有链接的列表：

```
wikiA.com/api.php?action=query&list=iwbacklinks&blimit=50&blnamespace=0&bltitle=MY_PAGE_X 
```

虽然这返回一个相同的数据，但作为 JSON：

```
wikiA.com/api.php?format=json&action=query&list=iwbacklinks&blimit=50&blnamespace=0&bltitle=MY_PAGE_X 
```

在任何一个输出可以在 Wiki B 上呈现之前，都必须对其进行解析和格式化，这在 PHP 中很容易做到。我现在只需要弄清楚如何将 php 脚本的输出包含到 MW 页面中。整体结果应该是这样的：

## 洛雷姆·伊普苏姆

Lorem Ipsum Camem latina est quod usata ad interetem paginam subconstructa。

## Wiki A 中链接到此页面的页面列表：

1) Camina Burana 2) Catilinaria 3) De Bellum Gallum

我的意图当然是在调用页面时自动创建小节。

我感谢 mario 和 svick 的建议，并欢迎其他人。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-04-29T11:02:39.600

这是不可能的：这是一个开放的功能请求。请订阅问题跟踪器或提交补丁。[https://phabricator.wikimedia.org/T3886](https://phabricator.wikimedia.org/T3886)

# sql-server - 从 SQL Server Management Studio 创建 Word 文档 - 每页 1 行（供客户查看的电子邮件模板）

> ID：14657674
> 
> 赞同：-1
> 
> 时间：2013-02-02T01:27:09.880
> 
> 标签：sql-server, formatting, document, documentation-generation

嘿，我有一个简单的 EmailTemplate 表，其中包含三列：

模板
名称电子邮件
主题电子邮件内容

我有一个客户想要查看所有模板，我想将它们放入一个 word 文档中，每页 1 个，按照它们上面的顺序，例如

-------------- 第 1 页 --------------

[[模板名称]]

[[电子邮件主题]]

[[电子邮件内容]]
...
...
...
[[电子邮件内容]]

- - - - - - - 第2页 - - - - - - -

[[模板名称]]

[[电子邮件主题]]

[[电子邮件内容]]
...
...
...
[[电子邮件内容]]

有谁知道从 SQL Server Management Studio 执行此操作的简单方法？

干杯抢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T03:52:43.210

Word 有一个可以与 csv 数据一起使用的邮件合并功能，我建议不要尝试在 sql 中构建整个东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T02:29:01.560

我做了一些更多的搜索，很多代码解决方案，但在 SSMS 中没有开箱即用的东西，所以我做了更多的摆弄，这就是我为实现这一目标所做的工作：

1.  将查询输出设置为文本
2.  将查询 -> 查询选项 -> 文本设置为：无标题和分隔符 | （所以很容易删除）
3.  使用制表符 CHAR(9) 和换行符 CHAR(10) 向查询添加格式，如下所示：

    SELECT '模板名称：' + CHAR(9) + CHAR(9) + 名称 + CHAR(10) + CHAR(10)，'电子邮件主题：' + CHAR(9) + CHAR(9) + TemplateSubject + CHAR(10 ) + CHAR(10) + CHAR(10), '内容:' + CHAR(10) + CHAR(10), TemplateContent + CHAR(10) + CHAR(10) + CHAR(10) + CHAR(10) + ' ------------------------------------' FROM dbo.EmailTemplate

我只是将这些内容复制/粘贴到 Word 中，然后将虚线“----”转换为分页符并将其发送给客户进行审查。

# angularjs - Angular JS：链接承诺和摘要循环

> ID：14657680
> 
> 赞同：15
> 
> 时间：2013-02-02T01:28:10.300
> 
> 标签：angularjs, promise

## **注意：**小提琴使用旧版本的 Angular，它不再工作，因为从 1.2 开始，Angular 模板引擎不能透明地处理 Promise。

我正在研究链接承诺以填充我的范围，然后让范围自动更新 dom。

不过，我遇到了问题。如果我在已经解决的承诺上调用“then”，它会创建一个新的承诺（它将异步但几乎立即调用成功函数）。我认为问题在于，在调用成功函数时我们已经离开了摘要循环，因此 dom 永远不会更新。

这是代码：

```
<div ng-controller="MyCtrl">
    Hello, {{name}}! <br/>
    {{name2}}<br/>
    <button ng-click="go()">Clickme</button><br/>
    {{name3}}
</div>

var myApp = angular.module('myApp',[]);

function MyCtrl($scope, $q) {
    var data = $q.defer();    
    setTimeout(function() {$scope.$apply(data.resolve("Some Data"))}, 2000);
    var p = data.promise;

    $scope.name = p.then(angular.uppercase);
    $scope.name2 = p.then(function(x) { return "Hi "+x;});
    $scope.go = function() {
            $scope.name3 = p.then(function(x) { 
                // uncomment this to make it work:
                //$scope.$apply();
                return "Finally: "+x;
            });
    };
 } 
```

[http://jsfiddle.net/QZM4d/](http://jsfiddle.net/QZM4d/)

是否有某种方法可以使这项工作在每次我链承诺时都调用 $apply ？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-02-02T02:23:56.570

## **注意**：小提琴使用旧版本的 Angular，它不再工作，因为从 1.2 开始，Angular 模板引擎不能透明地处理 Promise。

[引用](https://stackoverflow.com/a/14246907/215945)@pkozlowski.opensource ：

> 在 AngularJS 中，promise 解析的结果是在 $digest 循环内异步传播的。因此，使用 then() 注册的回调只会在进入 $digest 循环时被调用。

因此，当单击按钮时，我们处于摘要循环中。then() 创建一个新的 Promise，但 then() 的结果将不会传播到*下一个*摘要周期，该周期永远不会到来（因为没有 $timeout 或 $http 或 DOM 事件来触发）。如果您使用 ng-click 添加另一个不执行任何操作的按钮，然后单击该按钮，它将导致摘要循环，您将看到结果：

```
<button ng-click="">Force digest by clicking me</button><br/> 
```

这是一个这样做的[小提琴](http://jsfiddle.net/mrajcok/9CxC2/)。

小提琴还使用 $timeout 而不是 setTimeout - 然后 $apply() 不需要。

希望您清楚何时需要使用 $apply。有时您确实需要手动调用它。

# solr - SOLR：如何查看最后一次索引文档/行的时间？

> ID：14657685
> 
> 赞同：1
> 
> 时间：2013-02-02T01:29:18.857
> 
> 标签：solr

无论如何要获得文档/行上次更新或索引时间的时间戳？有点像 activerecord 的 created_at 或 updated_at 字段。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T02:38:51.753

正如 Ben 评论的那样，没有内置的方法可以做到这一点。唯一的选择是在您的架构中创建以下时间戳字段。那么这个值将始终是最后一次索引文档/行的时间。

```
 <field name="timestamp" type="date" indexed="true" 
         stored="true" default="NOW" multiValued="false"/> 
```

这取自Solr 附带的示例[schema.xml 。](http://svn.apache.org/viewvc/lucene/dev/branches/lucene_solr_4_1/solr/example/solr/collection1/conf/schema.xml?view=markup)

# java - 从 jar 内部读取文件不起作用

> ID：14657692
> 
> 赞同：-1
> 
> 时间：2013-02-02T01:30:32.030
> 
> 标签：java, jar, io, inputstream, embedded-resource

在 Java 中，我尝试了在 jar 中读取文件的不同技术。我已经让一个在另一个程序中工作，但不是这个。我从 classname.class.getClassLoader().getResourceAsStream(filenamestring); 得到的 InputStream 方法返回 null。

```
 package mainpkg;

 import java.awt.GridLayout;
 import java.awt.event.MouseEvent;
 import java.awt.event.MouseListener;
 import java.io.BufferedWriter;
 import java.io.File;
 import java.io.FileWriter;
 import java.io.IOException;
 import java.io.InputStream;
 import javax.swing.JButton;
 import javax.swing.JFrame;
 import javax.swing.JTextField;
 import javax.swing.UIManager;

 public class MainClass extends JFrame{
JTextField jtf = new JTextField();
boolean isInstalling = false;
public MainClass(){
    super("StringThatTitleWillBe");
}
public void initiate(){
    setLookAndFeel();
    setSize(550, 400);
    setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    GridLayout bl = new GridLayout(2, 1, 10, 10);
    setLayout(bl);

    JButton b = new JButton("Install");
    b.addMouseListener(new MouseListener(){

        @Override
        public void mouseClicked(MouseEvent arg0) {
            if(!isInstalling){
            isInstalling = true;
            install();
            }
        }

        @Override
        public void mouseEntered(MouseEvent arg0) {

        }

        @Override
        public void mouseExited(MouseEvent arg0) {

        }

        @Override
        public void mousePressed(MouseEvent arg0) {

        }

        @Override
        public void mouseReleased(MouseEvent arg0) {

        }

    });
    add(b);
    jtf.setEditable(false);
    add(jtf);
    //show
    setVisible(true);
}
private void setLookAndFeel() {
    try {
        UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
    } catch (Exception exc) {
        System.out.print("failed to load look and feel");
    }
}
public static void main(String[] args){
    MainClass m = new MainClass();
    m.initiate();
}

public void install() {
    String files = "name of jarfile inside the jar to be read";
    InputStream stream = MainClass.class.getClassLoader().getResourceAsStream(files);
    File f = new File(files);
    if(stream == null)
        System.out.println("stream is null");
    try {
        int val = stream.read();
        BufferedWriter br = new BufferedWriter(new FileWriter(f));
        while(val != -1){
        br.write(val);
        val = stream.read();
        }
        stream.close();
        br.close();
    } catch (IOException e) {
        e.printStackTrace();
    }
    isInstalling = false;
     }
 } 
```

它打印“stream is null”并在该行给出错误：stream.read(); 我知道这意味着文件没有正确转换为 InputStream。我犯了一个愚蠢的错误？？？请帮忙。在此先感谢编辑：我要复制到与 jar 相同的目录中的文件直接在 jar 内。它不在包或任何此类附加目录中。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-02T02:00:19.953

如果 a`getResourceAsStream(String)`返回`null`，则意味着类加载器找不到具有您给它的名称的资源。要么是完全错误，要么你使用了相对名称，而资源不在 JAR 的“/”目录中。

有关详细信息，请阅读 javadoc for [`ClassLoader.getResourceAsStream`](http://docs.oracle.com/javase/7/docs/api/java/lang/ClassLoader.html#getResourceAsStream%28java.lang.String%29)，请注意：

*   返回的值，和
*   相对路径名的处理（点击`getResource`链接！！）。

如果你想使用相对于类包解析的相对名称加载资源，你应该这样写：

```
 MainClass.class.getResourceAsStream(files); 
```

这些`Class.getResource...`方法解析相对于类的相对名称。因此，上述内容将解析`"foo.txt"`为`"/mainpkg/foo.txt"`...您的版本将其解析为`"/foo.txt"`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-02T01:39:27.783

> 我知道这意味着文件没有正确转换为 InputStream

不，它没有。这意味着没有找到命名的资源。检查Javadoc。

然后根据 JAR 列表检查资源名称，您已在帖子中省略了该名称。

如果 'stream' 为空，您将无法继续尝试阅读它并获得 NPE。这只是糟糕的编程。

此外，JAR 文件中的资源不是文件，使用其名称构造文件是无意义的活动。

# browser - 如何使用 URI 方案通过浏览器启动 WP8 应用程序

> ID：14657699
> 
> 赞同：0
> 
> 时间：2013-02-02T01:31:15.590
> 
> 标签：browser, windows-phone-8

我相信在 WP8 中我可以为我的应用程序注册一个 URI（即 myapp:) 并使用 Launcher.LaunchUriAsync(uri) 启动它

我的问题是我是否可以使用相同的注册 uri 通过浏览器启动应用程序？

我已经看到尝试启动与文件扩展名关联的应用程序的实例，但我可以使用 uri 方案吗？

在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T08:29:12.263

是的 - 您需要做的就是创建一个网页，其中包含您注册的 URI 格式的超链接，并且操作系统将打开您的应用程序（如果已安装）。

如果您的应用未安装，它将提供打开商店供您搜索支持此 URI 方案的应用。

您可以使用仍在模拟器或设备上开发的应用程序进行测试。

# scala - 根据类型将值与函数匹配

> ID：14657705
> 
> 赞同：3
> 
> 时间：2013-02-02T01:32:18.990
> 
> 标签：scala

假设我有一个函数列表，如下所示：

```
val funcList = List(func1: A => T, func2: B => T, func2: C => T) 
```

（其中`func1`，等人在别处定义）

我想编写一个方法，该方法将获取一个值并根据确切类型（与 匹配）将其匹配到正确的函数`a: A`，`func1: A => T`或者如果没有匹配的函数则抛出异常。

有没有一种简单的方法可以做到这一点？

这类似于 a`PartialFunction`所做的，但我无法将函数列表更改`funcList`为 PartialFunctions。我在想我必须将函数隐式转换为一个特殊的类，该类知道它可以处理的类型并能够对其进行模式匹配（基本上将这些函数提升为专门的`PartialFunction`）。但是，我不知道如何识别每个函数的“域”。

谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-02T02:27:31.827

您无法识别每个函数的域，因为它们在运行时被擦除。如果您想要更多信息，请查找擦除，但缺点是您想要的信息不存在。

类型擦除有多种方法，您会发现很多关于 Stack Overflow 本身的讨论。其中一些归结为将类型信息作为值存储在某处，以便您可以匹配。

另一种可能的解决方案是简单地为您自己的自定义类型放弃使用参数化类型（ Java 中的*泛型* ）。也就是说，做类似的事情：

```
abstract class F1 extends (A => T)
object F1 { 
  def apply(f: A => T): F1 = new F1 { 
    def apply(n: A): T = f(n) 
  } 
} 
```

等等。由于`F1`没有类型参数，你可以对其进行匹配，并且可以轻松创建该类型的函数。说 both`A`和`T`are `Int`，那么你可以这样做，例如：

```
F1(_ * 2) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-02T01:51:25.203

我认为您误解了 a`List`的输入方式。`List`采用单个类型参数，它是列表中*所有*元素的类型。当你写

```
val funcList = List(func1: A => T, func2: B => T, func2: C => T) 
```

编译器将推断出类似`funcList : List[A with B with C => T]`.

这意味着 in 中的每个函数都`funcList`接受一个参数，该参数是*所有* `A`、`B`和的成员`C`。

除此之外，由于类型擦除，您不能（直接）匹配函数类型。

您可以做的是匹配`a`自身，并为该类型调用适当的函数：

```
a match {
    case x : A => func1(x)
    case x : B => func2(x)
    case x : C => func3(x)
    case _ => throw new Exception
} 
```

（当然，`A`,`B`和`C`必须在类型擦除后保持不同。）

如果你*需要*它是动态的，你基本上是在使用反射。不幸的是，Scala 的反射功能在不断变化，几周前发布了 2.10 版本，因此目前的实现方式的文档较少；请参阅[新的 Scala TypeTags 如何改进（已弃用的）清单？](https://stackoverflow.com/questions/10513336/how-do-the-new-scala-typetags-improve-the-deprecated-manifests).

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-02T13:54:53.267

解决类型擦除的通常答案是使用清单的帮助。在您的情况下，您可以执行以下操作：

```
abstract class TypedFunc[-A:Manifest,+R:Manifest] extends (A => R) {
  val retType: Manifest[_] = manifest[R]
  val argType: Manifest[_] = manifest[A]
}
object TypedFunc {
  implicit def apply[A:Manifest, R:Manifest]( f: A => R ): TypedFunc[A, R] = {
    f match {
      case tf: TypedFunc[A, R]  => tf
      case _ => new TypedFunc[A, R] { final def apply( arg: A ): R = f( arg ) }
    }
  }
}

def applyFunc[A, R, T >: A : Manifest]( funcs: Traversable[TypedFunc[A,R]] )( arg: T ): R = {
  funcs.find{ f => f.argType <:< manifest[T] } match {
    case Some( f ) => f( arg.asInstanceOf[A] )
    case _ => sys.error("Could not find function with argument matching type " + manifest[T])
  }
}

val func1 = { s: String => s.length }
val func2 = { l: Long => l.toInt }
val func3 = { s: Symbol => s.name.length }
val funcList = List(func1: TypedFunc[String,Int], func2: TypedFunc[Long, Int], func3: TypedFunc[Symbol, Int]) 
```

在 REPL 中测试：

```
scala> applyFunc( funcList )( 'hello )
res22: Int = 5
scala> applyFunc( funcList )( "azerty" )
res23: Int = 6
scala> applyFunc( funcList )( 123L )
res24: Int = 123
scala> applyFunc( funcList )( 123 )
java.lang.RuntimeException: Could not find function with argument matching type Int
        at scala.sys.package$.error(package.scala:27)
        at .applyFunc(<console>:27)
        at .<init>(<console>:14)
        ... 
```

# angularjs - 如果用户已登录 AngularJS，则重定向索引页面

> ID：14657711
> 
> 赞同：20
> 
> 时间：2013-02-02T01:33:34.070
> 
> 标签：angularjs, angular-routing

我试图改变用户在访问我的网站时看到的页面。如果他们是匿名的，他们应该会看到注册页面。如果他们已经登录，他们应该会看到他们的仪表板。

我有一个服务可以检查用户是否登录（例如检查 cookie），它会在 Angular 服务加载时触发。我曾尝试使用 $routeProvider 进行重定向，但在初始化 $routeProvider 时尚未触发服务，因此它始终认为用户未登录。

加载初始页面后，我可以轻松重定向，但我正在努力重定向加载的第一页。任何人都可以就如何做到这一点提供建议吗？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-02-02T02:54:30.130

请务必阅读答案下的评论。当我回答这个问题时，我没有考虑单元测试和设计。我只是在展示实现预期结果的众多方法之一

我认为在控制器或您的`app.config.run`. 在您的情况下，您应该创建另一个模块来检查用户登录状态。将用户登录状态检查模块注入您的应用程序模块。

这是示例的链接，后面是`app.js`代码

[http://plnkr.co/edit/dCdCEgLjLeGf82o1MttS](http://plnkr.co/edit/dCdCEgLjLeGf82o1MttS)

```
var login = angular.module('myLoginCheck', [])
  .factory('$logincheck', function () {
    return function (userid) {
      // Perform logical user logging. Check either 
      // by looking at cookies or make a call to server.
      if (userid > 0) return true;
      return false;
    };
  });

var app = angular.module('myApp', ['myLoginCheck']);

app.config(function ($routeProvider, $locationProvider) {
    $routeProvider
      .when('/publicurl', {})
      .when('/loginurl', {})
      .when('/unauthorize', {})
      .otherwise({redirectTo: '/'});
  })
  .run(function ($logincheck, $location) {
    //console.log("Into run mode");
    console.log("Userid 5 is logged in: ", $logincheck(5));
    console.log("Userid 0  logged in: ", $logincheck(0));

    //now redirect to appropriate path based on login status
    if ($logincheck(0)) {
      //$location.path('/loginurl'); or          
    }
    else {
      //$location.path('/publicurl'); or 
    }
  });

app.controller('MainCtrl', function ($scope) {
  $scope.name = 'World';
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-06-10T13:21:40.127

我只是这样做了，通过为 / 路径创建一个虚拟模板和小控制器来适当地重定向。

```
controllers.controller('loginController',
                       ['$scope', '$location', '$cookies',
                        function($scope, $location, $cookies) {
    if (!!$cookies.user) {
        console.log("already logged in!");
        $location.path('/shows');
    } else {
        console.log("need to login!");
        $location.path('/users');
    }
}]);

var app = angular.module('app', ['ngRoute', 'ngCookies', 'controllers', 'services']);

app.config(['$routeProvider',
            function($routeProvider) {
    $routeProvider.when('/users', {
        templateUrl: "partial/users.html",
        controller: 'userController'
    });
    $routeProvider.when('/shows', {
        templateUrl: "partial/shows.html",
        controller: 'showController'
    });
    $routeProvider.when('/', {
        template: '',
        controller: 'loginController'
    });
    $routeProvider.otherwise({
        redirectTo: '/'
    });
}]); 
```

# html - html元素不响应定位

> ID：14657718
> 
> 赞同：0
> 
> 时间：2013-02-02T01:35:05.020
> 
> 标签：html, css, positioning

我无法让 img 元素移动到左侧。left: 0px 属性没有做任何事情。事实上，我似乎无法移动#top div 内的任何东西来移动。

img 标签在顶部。我省略了网页的其余部分，但我希望这已经足够了。

HTML 代码：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" 
"http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
    <link rel="stylesheet" type="text/css" href="style.css">
</head>
<body>

    <div id="topBorder">&nbsp;</div>

    <div id="top">
        <img src="logo.png" style="width:50%; height: 20%; left: 2em"/>
    </div>

</body>

</html> 
```

CSS 代码：

```
body {
max-width: 60em;
margin: auto;
position: relative;

}

div {
border: solid;
text-align: center;
margin-top: 1em;
margin-bottom: 1em;

}

#topBorder {

background-color:#255FAA;
height: .7em;
width: 100%;
border: transparent;
}

#top {
background-color: white;
border: transparent;
height: 13%;
width: 100%;
font-family: Georgia, Palatino Linotype; 

}

#top img{
border: solid black;
position: relative;
left: 0px;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T01:55:40.600

看起来`text-align:center`你的`div`元素是问题所在。尝试覆盖它，`#top`我认为它会开始像你期望的那样表现。看到这个小提琴：

[http://jsfiddle.net/3KyrW/](http://jsfiddle.net/3KyrW/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T01:40:17.313

你`#top`应该有`positive: relative`，然后你`#top img`应该有`position: absolute`......这将在你的标题中移动图像。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-02T01:48:42.067

我不是 100% 确定要如何定位。但是添加 a`display: block;`和 a `float: left;`to`#top img`似乎会使图像向左浮动。使用`left: 0px;`时不需要，`position: relative;`因此我将其删除。还添加了`position: relative;`一个`#top` `<div>`。

您的`<img>`标签中似乎也有内联样式？那好像不行了

```
<img src="logo.png" style="width:50%; height: 20%; left: 2em"/> 
```

所以我把它拿出来并添加到 CSS 中。新`<img>`标签如下所示：

修改后的 CSS 在这里：

```
#top {
    position: relative;
    background-color: white;
    border: transparent;
    height: 13%;
    width: 100%;
    font-family: Georgia, Palatino Linotype; 
}

#top img{
    border: solid black;
    position: relative;
    display: block;
    float: left;
    width: 50%;
    height: 20%;
    left: 2em;
} 
```

# ruby-on-rails - 只是尝试设置 Rails，我有一些担忧

> ID：14657719
> 
> 赞同：0
> 
> 时间：2013-02-02T01:35:16.473
> 
> 标签：ruby-on-rails

我正在尝试安装 Rails（在 Mac OSX 上），我现在基本上已经完成了，但我目前正在从一本使用 SQLite 3 的书中学习，我只想使用 MySQL，将语句用于与数据库交谈整本书都一样吗？此外，当您设置您的 Mysql 密码/用户名时，您可以这样做，`/config/database.yml`但从网络上可以看到，任何人都可以在那里导航并查看我的密码，什么不是，我在这里缺少什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T01:40:59.607

*   ActiveRecord 将抽象与您的数据库的任何交互。只要您使用它，您就不必担心您使用的是 SQLite 还是 MySQL。
*   唯一面向公众的文件夹是`public`文件夹。这与 PHP 应用程序形成鲜明对比，PHP 应用程序中的所有内容都是公开的（并且必须公开以便 Web 服务器与之交互）。

# perl - 在 perl 中使用 argv[0] 拒绝空白查询

> ID：14657720
> 
> 赞同：2
> 
> 时间：2013-02-02T01:35:32.963
> 
> 标签：perl, argv

我试图在输入空白查询时退出脚本。根据我的阅读，这段代码应该可以正常工作，但似乎不想这样做，因为“”不是数字。解决方法是什么？

```
if(($#ARGV < 0) || ($ARGV[0] == "")){
  print "$0: Enter a query.\n";
  exit 1;
} 
```

澄清，

```
perl run.pl "query" 
```

应该工作，而

```
perl run.pl "" 
```

应该提示输入一个字符串。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-02T01:38:41.637

尝试

```
if(($#ARGV < 0) || ($ARGV[0] eq "")){
  print "$0: Enter a query.\n";
  exit 1;
} 
```

`eq`用于字符串比较。

# c++ - 无法观看 vector <vector 类型的公共字段="">自定义对象的实例</vector>

> ID：14657722
> 
> 赞同：0
> 
> 时间：2013-02-02T01:35:46.833
> 
> 标签：c++, debugging, codeblocks

```
#include <iostream>
#include <vector>

using namespace std;

class travel
{
public:
       vector< vector<int> > trace;
}; 
```

在包含前一个 .cpp 的类中，我实例化了一个 travel 对象，然后将以下内容分配给 trace 字段

```
tempTravel.trace[iteration-1][1] = 1; 
```

我想`tempTravel.trace[5][1]`在单步执行时观看整个执行过程。但是，值的监视字段中没有显示任何内容，如果我改为观察`tempTravel.trace`逐渐打开加号以磨练对象的较低级别成员，我看不到任何定义的值。如果有什么办法可以看？

# signals - 将 swapcontext 与信号处理程序一起使用

> ID：14657724
> 
> 赞同：3
> 
> 时间：2013-02-02T01:36:30.490
> 
> 标签：signals, signal-handling, context-switch

我正在尝试构建像 pthreads 这样的用户级线程库。

我想在信号处理程序中使用 swapcontext。但由于它不是信号安全功能，因此不建议使用它。有人可以建议如何在信号处理程序中使用它。我可以通过禁用信号来使用它吗？

也有人可以解释一下信号安全功能的确切含义吗？

# c# - Application.current.mainwindow 子窗口替代

> ID：14657727
> 
> 赞同：0
> 
> 时间：2013-02-02T01:37:13.270
> 
> 标签：c#, wpf, mainwindow

我想使用以下代码

```
Point point1 = pwImages.ElementAt(0).TransformToAncestor(Application.Current.MainWindow).Transform(new Point(0, 0)); 
```

但是，Application.Current.MainWindow 未设置为调用此代码的窗口，因为 mainWindow 是 app.xaml 调用的窗口。除了 Application.Current.MainWindow 之外，我还可以在这里使用其他替代方法吗？或者我可以将 Application.Current.MainWindow 重置为我的当前窗口吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T01:58:58.650

好的，如果我发现我需要循环浏览我的子窗口列表以找到我正在寻找的窗口并将其分配给一个变量。

```
 Window myWindow;
   foreach (Window objWindow in Application.Current.Windows)
        {
            if (objWindow.ToString().Equals("NameOfChildWindow"))
            {
                myWindow = objWindow;
            }
        } 
```

然后我可以使用 objWindow 作为替换属性

```
 Point point1 = pwImages.ElementAt(0).TransformToAncestor(myWindow).Transform(new Point(0, 0)); 
```

# osx-lion - 无法在 OSx 中访问 EKEventStore

> ID：14657731
> 
> 赞同：1
> 
> 时间：2013-02-02T01:38:00.673
> 
> 标签：osx-lion, ekeventstore

我尝试使用 EKEventStore 来检查 Web 和参考中的文档。但仍然遇到以下问题，似乎我无法访问 OSx 中的商店。我的是 10.7.5，请帮忙指出我在这方面做错了什么。

```
#import "AppDelegate.h" 
@implementation AppDelegate
@synthesize store = _store;
@synthesize defaultCalendar = _defaultCalendar;

- (void)applicationDidFinishLaunching:(NSNotification *)aNotification
{
    // Insert code here to initialize your application
    self.store = [[EKEventStore alloc] initWithAccessToEntityTypes:EKEntityTypeEvent];
    self.defaultCalendar  = [self.store defaultCalendarForNewEvents];
}

- (IBAction)startPress:(id)sender {
    NSLog(@"Default calendar:%@ is nil:%@", [self.defaultCalendar title],(self.defaultCalendar));
    NSArray *calendars = [self.store calendarsForEntityType:EKEntityTypeEvent];
    NSLog(@"Total calendars %lu", calendars.count);
} 
```

这是 Log 中出现的结果

2013-02-02 08:24:42.429 iCalendarProfiler-Test01152013[2296:403] 默认日历：(null) 为 nil:(null) 2013-02-02 08:24:42.429 iCalendarProfiler-Test01152013[2296:403] 日历总数0

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-06T07:04:18.163

OS X 的 EKEventStore 自 10.8 起可用，不适用于 OS X 10.7.5

# c - #定义变量范围

> ID：14657734
> 
> 赞同：1
> 
> 时间：2013-02-02T01:38:35.040
> 
> 标签：c, scope, c-preprocessor

我想知道是否有办法从我的主函数中定义一个具有特定实例名称的全局变量？我必须按位值访问数组，为此我需要输入：

```
state.reg[ 4 * mc_binary[ 18 ] + 2 * mc_binary[ 17 ] + 1 * mc_binary[ 16 ] ] 
```

我能有......吗：

```
#define state.reg[ 4 * mc_binary[ 18 ] + 2 * mc_binary[ 17 ] + 1 * mc_binary[ 16 ] ] registerA 
```

我的 main 函数中使用`state`的结构实例在哪里？`stateType`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T02:02:04.500

这是我推荐的：

```
#define BIT_INDEX3(bit2, bit1, bit0) \
    (4 * (bit2) + 2 * (bit1) + (bit0))

// use in code:
    state.reg[ BIT_INDEX3(mc_binary[18], mc_binary[17], mc_binary[16]) ] 
```

您不想变得*太*棘手，但是如果您经常从同一个数组中提取（就像您在此处所做的那样），您可以为此进行另一个定义：

```
#define BIT_INDEX_ARRAY3(a, i2, i1, i0) \
    BIT_INDEX3((a)[i2], (a)[i1], (a)[i0])

// use in code:
state.reg[ BIT_INDEX_ARRAY3(mc_binary, 18, 17, 16) ] 
```

# macos - 通过 ssl 将 ldapsearch 与服务器一起使用，但没有密码

> ID：14657737
> 
> 赞同：0
> 
> 时间：2013-02-02T01:39:15.833
> 
> 标签：macos, ldap

我们的组织需要 SSL 才能访问我们的 ldap 服务器。当我在 Mac OS X 的联系人应用程序中设置 LDAP 服务器时，我能够很好地搜索我们组织中的人员。但是，使用命令行应用程序 ldapsearch 似乎不起作用。

问题是我们的组织在使用 SSL 时不需要用户名或密码。我似乎无法让 ldapsearch 不需要密码。

这是我正在使用的命令：

```
ldapsearch -H ldaps://ldap.example.com -b "" -s base "objectclass=*" 
SASL/DIGEST-MD5 authentication started
Please enter your password: 
```

这是我的 /etc/openldap/ldap.conf 的内容

```
HOST ldap.example.com
PORT 636
TLS_REQCERT never 
```

以下是在 Mac OS X 的联系人应用程序中运行良好的设置，并且不需要用户名或密码：

![LDAP 示例](../Images/a3c6566e755183b22d2d051c0179a8e8.png)

用于此服务器的正确 ldapsearch 混合物是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-03T21:51:17.057

您需要 -x 选项。尝试类似：

```
ldapsearch -x -H ldaps://ldap.example.com -b "ou=people,dc=examplelabs,dc=com" -s sub "objectclass=inetorgperson" 
```

# windows-phone-7 - 切换 WP (7 ~ 7.8) 用户铃声（铃声/振动）？

> ID：14657740
> 
> 赞同：-1
> 
> 时间：2013-02-02T01:39:55.100
> 
> 标签：windows-phone-7, windows-phone

有什么方法可以访问当前音调并在自定义 APP 上切换音调/振动？有些喜欢

```
...
if isVibrate then
    ChangeToTone()
Else
    ChangeToVibrate()
End if

isVibrate = Not isVibrate
... 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T04:56:37.043

不！当前适用于 windows phone 的 SDK 不允许您访问此功能。希望我们可以在未来的版本中得到它。

# sql - 聚合最后一篇文章作者 ID 的 SQL 语句

> ID：14657741
> 
> 赞同：0
> 
> 时间：2013-02-02T01:40:00.060
> 
> 标签：sql, database

想象一下，我有一个具有以下关系模式的数据库：

```
forums(id, title)
forum_topics(id, forum_id, title, count_views, some_data)
forum_posts(id, topic_id, title, content, author_id, another_data) 
```

假设我在 forums_posts 表中有两行数据：

```
(1, 1, 'some title', 'some content', 4, 'blahr')
(2, 1, 'another post title', 'my content', 5, 'nah') 
```

现在，我想创建一个 SQL 语句，它将为我提供主题 ID、该主题的帖子数以及该主题的最新贡献者的用户 ID。获得前两个值显然不是问题，而后者非常棘手。这是我到目前为止所拥有的：

```
SELECT topic_id,
   COUNT(*) AS count_posts,
   forum_posts.author_id AS last_answer_by
FROM forum_posts
JOIN forum_topics ON forum_posts.topic_id = forum_topics.id
GROUP BY topic_id 
```

上面给出的查询会给我，假设有一个 id = 1 的 forum_topics 条目：

```
topic_id = 1
count_posts = 2
last_answer_by = 4 
```

虽然假设较高的帖子 id 意味着它比具有较低 id 的帖子条目写得晚，但我想要得到的是：

```
topic_id = 1
count_posts = 2
last_answer_by = 5 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T02:11:59.747

您只需要查询 forum_posts 表即可获得所需的结果，但您需要在 from 子句中使用子查询首先获取 forum_posts 表中每个 topic_id 的帖子数以及最大帖子 id话题。然后，您将该子查询的结果加入到该最大帖子 ID 上的原始 forum_posts 表中：

```
SELECT postcounts.topic_id,
       count_posts,
       author_id as last_answer_by
FROM
  (SELECT topic_id,
          COUNT(*) AS count_posts,
          MAX(id) AS lastpost
   FROM forum_posts
   GROUP BY topic_id) postcounts
INNER JOIN forum_posts ON lastpost = forum_posts.id 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T01:56:36.993

```
SELECT  a.topic_id,
        b.autor_ID as Last_Answer_By,
        d.TotalCount
FROM    forum_topics b
        INNER JOIN forum_posts a
            ON a.topic_id = b.id
        INNER JOIN
        (
            SELECT  topic_ID, MAX(ID) max_ID
            FROM    forum_posts
            GROUP   BY topic_ID
        ) c ON  b.topic_ID = c.topic_ID AND
                b.ID = c.max_ID
        INNER JOIN
        (
            SELECT  topic_ID, COUNT(*) TotalCount
            FROM    forum_posts
            GROUP   BY topic_ID
        ) d ON  a.topic_ID = d.topic_ID 
```

# haskell - 如果使用“ghc -threaded”编译，xmonad 将表现异常

> ID：14657746
> 
> 赞同：1
> 
> 时间：2013-02-02T01:40:41.517
> 
> 标签：haskell, xmonad

使用创建的 xmonad`xmonad --recompile`效果很好。但是，如果我们使用 'ghc -threaded xmonad.hs` 构建 xmonad 并根据您的平台更改其名称，即 xmonad-i386-freebsd，则 xmonad 将表现异常。

.一些关键定义将不起作用。

.XMonad.Actions.GridSelect 不会产生应用程序...

任何建议表示赞赏！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-03T12:45:18.393

Xmonad 不支持 --thread 因为 X11 C 库不是线程安全的。

# c - “round” time_t 到天/小时？

> ID：14657751
> 
> 赞同：3
> 
> 时间：2013-02-02T01:41:31.297
> 
> 标签：c, time

我有一个 unix time_t ，有什么简单的方法可以将它转换为 time_t 所以它：

1.  表示 time_t 当天的午夜？
2.  表示 time_t 小时的开始？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-02T02:07:48.353

像这样的东西：

```
time_t t = time(NULL);

t -= (t % 86400); 
```

常数 86400 = 24 * 60 * 60 - 我认为这是一个需要记住的有用数字...... ;)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-02T02:39:16.077

让计算机为你记住天体常数：

```
time_t      arg, start_of_hour, start_of_day;
struct tm   *temp;

temp = localtime(&arg);
temp->tm_sec  = 0;
temp->tm_min  = 0;
start_of_hour = mktime(temp);
temp->tm_hour = 0;
start_of_day  = mktime(temp); 
```

或者`gmtime`，如果您愿意，可以使用。

# qt - 将片段着色器输出读入应用程序内存

> ID：14657754
> 
> 赞同：0
> 
> 时间：2013-02-02T01:41:40.573
> 
> 标签：qt, opengl, shader

我正在尝试使用 OpenGL 进行复杂几何图形的可见性测试。我想做的很简单：为每个基元分配一个整数 ID，然后计算具有该 ID 的像素数。这使我可以计算每个图元的相对可见区域。（最终，这将扩展到可见区域的一些较小的有限元计算。）

我的问题是这个。我正在尝试将片段着色器的输出读入我的应用程序内存：特别是原始 ID 输出。我正在使用 QT 4.7.4 及其 OpenGL 包装类。当我绑定并启用一个缓冲区（“PixelPack”缓冲区）并尝试从 OpenGL 缓冲区读取到内存时，它报告读取成功。但是存储在数组中的值并不是我所期望的——它们都是 0，即使出于测试目的，我已将所有原语的 ID 设置为 1。

这是我的片段着色器：

```
#version 130

in vec4 Color;
flat in uint VertId;

out vec4 FragColor;
out uint FragId;

void main()
{
   FragColor = Color;

   // Changed to simpler version for debugging.
   //   FragId = VertId;
   FragId = uint( 1 );
} 
```

这是我的应用程序代码，去掉了一些不相关的部分（测试工具连接等）：

```
#include <QtOpenGL/QGLShader>
#include <QtOpenGL/QGLShaderProgram>
#include <QtOpenGL/QGLBuffer>

using namespace std;

string loadSource( string file );

int
testSelfShadow::
shader( ostream& error )
{
   bool fail = false;

   // Create the OpenGL context.
   int argc = 0;
   char* argv;
   QApplication* app = new QApplication( argc, &argv );
   QGLWidget* widget = new QGLWidget();
   widget->makeCurrent();

   // Create the shader program.
   QGLShaderProgram* prog = new QGLShaderProgram();
   bool success = false;
   success = prog->addShaderFromSourceCode( QGLShader::Vertex,
                                            loadSource( "vertex.glsl" ).c_str() );     
   if ( ! success )
   {
      ErrorOStream msg;
      msg << "Error trying to load vertex shader into a shader program.\n"
          << prog->log().toStdString();
      throw ERRORLOG( msg.str() );
   }
   success = prog->addShaderFromSourceCode( QGLShader::Fragment,
                                            loadSource( "fragment.glsl" ).c_str() );   
   if ( ! success )
   {
      ErrorOStream msg;
      msg << "Error trying to load fragment shader into a shader program.\n"
          << prog->log().toStdString();
      throw ERRORLOG( msg.str() );
   }
   success = prog->link();

   if ( ! success )
   {
      ErrorOStream msg;
      msg << "Error trying to link shaders into a shader program.\n"
          << prog->log().toStdString();
      throw ERRORLOG( msg.str() );
   }

   prog->bind();

   // Create the buffer for vertex position.
   QGLBuffer* vBuf = new QGLBuffer( QGLBuffer::VertexBuffer );
   vBuf->create();
   vBuf->setUsagePattern( QGLBuffer::DynamicDraw );
   vBuf->bind();

   GLfloat vertices[] = {
      -1.0f, -1.0f, 0.0f, 1.0f,
      -1.0f, 0.0f, 0.0f, 1.0f,
      1.0f, 0.0f, 0.0f, 1.0f,
      1.0f, -1.0f, 0.0f, 1.0f,
      -1.0f, 0.0f, 0.1f, 1.0f,
      -1.0f, 1.0f, 0.1f, 1.0f,
      1.0f, 1.0f, 0.1f, 1.0f,
      1.0f, 0.0f, 0.1f, 1.0f };

   vBuf->allocate( vertices, sizeof( vertices ) );

   prog->setAttributeBuffer( "Vertex", GL_FLOAT, 0, 4, 0 );
   prog->enableAttributeArray( "Vertex" );

   // Create the buffer for Grayscale brightness value.
   // Not important for final program, just for debugging during
   // development.
   QGLBuffer* bBuf = new QGLBuffer( QGLBuffer::VertexBuffer );
   bBuf->create();
   bBuf->bind();

   GLfloat brightness[] = {
      1.0, 0.9, 0.8, 0.7,
      0.5, 0.4, 0.3, 0.2 
 };

   bBuf->allocate( brightness, sizeof( brightness ) );

   prog->setAttributeBuffer( "Brightness", GL_FLOAT, 0, 1, 0 );
   prog->enableAttributeArray( "Brightness" );

   // Create the buffer for polygon ID.
   QGLBuffer* idBuf = new QGLBuffer( QGLBuffer::VertexBuffer );
   idBuf->create();
   idBuf->bind();
   GLuint polyId[] = {
      1, 1, 1, 1, 
      2, 2, 2, 2
   };

   idBuf->allocate( polyId, sizeof( polyId ) );
   prog->setAttributeBuffer( "PolyId", GL_UNSIGNED_INT, 0, 1, 0 );
   prog->enableAttributeArray( "PolyId" );

   // Create the index buffer.  Not trying to do any optimization
   // here yet.
   QGLBuffer* iBuf = new QGLBuffer( QGLBuffer::IndexBuffer );
   iBuf->create();
   iBuf->bind();
   GLuint indices[] = {
      0, 1, 2, 3, 4, 5, 6, 7
   };
   iBuf->setUsagePattern( QGLBuffer::StaticDraw );
   iBuf->allocate( indices, sizeof( indices ) );

   // Create the buffer for reading back polygon id per fragment.
   QGLBuffer* fBuf = new QGLBuffer( QGLBuffer::PixelPackBuffer );
   fBuf->create();
   fBuf->setUsagePattern( QGLBuffer::DynamicRead );
   fBuf->bind();
   fBuf->allocate( 640 * 480 * sizeof( GLuint ) );

   prog->setAttributeBuffer( "FragId", GL_UNSIGNED_INT, 0, 1, 0 );
   prog->enableAttributeArray( "FragId" );

   GLuint* fBufData = new GLuint[ 640 * 480 * sizeof( GLuint ) ];

   glDrawElements( GL_QUADS, 8, GL_UNSIGNED_INT, 0 );
   widget->show();
   widget->updateGL();

   // Trying this two different ways; neither way works.
   bool readSuccess = fBuf->read( 0, fBufData, 640 * 480 * sizeof( GLuint ) );
   GLuint* fBufMap = 
      static_cast< GLuint* >( fBuf->map( QGLBuffer::ReadOnly ) );

   cout << "\n"
        << "Read Successful: " << readSuccess << endl;
   cout << "Buffer map location and sample data: " 
        << fBufMap << ":" << fBufMap[640] << endl;
   cout << "Read data pointer: " << fBufData << endl;
   cout << "Sample fragment ID: " << fBufData[ 640 * 480 / 2 ] << endl;

   app->exec();

   return fail;
} 
```

以下是程序运行的示例输出：

```
Read Successful: true
Buffer map location and sample data: 0x5a5d9000:0
Read data pointer: 0x59e48008
Sample fragment ID: 0 
```

这不是我所期望的。我希望所有片段 ID 都为 1，因为我在片段着色器中明确设置了 FragId = uint(1)。我设置我的阅读错误吗？我在绑定缓冲区或启用名称时做错了什么？

如果可能，我宁愿使用 QT 代码，原因超出了这个问题的范围。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T02:23:43.610

这里有太多 Qt 的东西，几乎不可能找到真正的 OpenGL 调用。但是你似乎有两个问题：

1.  您正在渲染到屏幕上。您的屏幕使用某种标准化整数图像格式。这基本上意味着“浮动，但占用 8 位”。您正在从着色器中写入整数。这些不匹配。因此，您的渲染会产生未定义的行为。

    您需要做的是渲染到包含`GL_R8UI`纹理的 FBO。然后您的`uint`片段着色器输出类型将匹配您的缓冲区。您可能也需要一个深度缓冲区。

2.  您从未真正*读取*过像素数据。`QGLBuffer::read`从*缓冲区对象*中读取。但是您还没有将任何东西放入缓冲区对象中。您从未告诉 OpenGL 复制您渲染的帧缓冲区数据并将其存储在缓冲区对象中。你需要先这样做；完成后，您可以从中读取。

    渲染到 FBO 后，您需要[调用`glReadPixels`](http://www.opengl.org/wiki/GLAPI/glReadPixels). 当你这样做时，你需要为你渲染的内容提供正确的[像素传输参数。](http://www.opengl.org/wiki/Pixel_Transfer)即，您需要`GL_RED_INTEGER`使用[格式](http://www.opengl.org/wiki/Pixel_Transfer#Pixel_format)和[类型](http://www.opengl.org/wiki/Pixel_Transfer#Pixel_type)`GL_UNSIGNED_BYTE`。而且由于您正在读取[像素缓冲区](http://www.opengl.org/wiki/Pixel_Buffer_Object)，因此您需要确保在读取之前将其绑定。

# c - GTK/GObject detail_signal 参数

> ID：14657756
> 
> 赞同：1
> 
> 时间：2013-02-02T01:42:02.740
> 
> 标签：c, gtk, gobject

在 GObject 参考手册中，它表示对于一个函数：

```
 g_signal_connect(instance, detailed_signal, c_handler, data) 
```

*需要格式为“signal-name::detail”*的*详细*信号字符串参数。我对此的初步理解是有预定义的信号详细信息要传入。如果是这种情况，我在哪里可以找到这些的列表？如果不是，那么它到底是什么意思，因为手册并没有把它说得太明显。

 ** * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T11:05:55.003

信号名称的`::detail`部分是可选的。如果信号采用详细参数，那么它会在信号的文档中说明。否则你可以忽略它。

我知道的唯一实际使用详细参数的`notify`信号是`GObject`. *每当对象的任何*属性发生变化时，`notify`都会触发没有细节的信号，因此它相当无用。但是如果你连接到信号，那么只要对象的属性发生变化，它就会触发。*`notify::visible``visible`*

 ** * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T06:44:07.987

除非最近情况发生了很大变化，否则没有完整的官方信号列表。预定义的信号完全取决于您使用的技术。

您可以做的是查看您正在使用的 GObject 实例类的在线文档。例如，如果您正在使用[GtkButton](http://developer.gnome.org/gtk3/3.2/GtkButton.html)，您可以在线查找它并发现它发出六个信号（激活、单击、进入、离开、按下、释放）。GtkButton 是从 GtkContainer 派生的，它还发出几个可能由 GtkButton 发出的记录信号。GtkContainer 是从 GtkWidget 派生的，它发出许多可能由 GtkButton 发出的记录信号。

如果您发现一个对象没有发出您期望的某种信号，您还可以查看该对象的源代码，因为有时对象会发出未记录的信号，**

# haskell - Haskell：输入“=”时解析错误

> ID：14657759
> 
> 赞同：0
> 
> 时间：2013-02-02T01:42:16.477
> 
> 标签：haskell

我收到了这个错误，我不知道我做错了什么。我是 Haskell 的新手，所以请为我详细说明一切。

```
import Data.Maybe

data Op = Add | Sub | Mul | Div | And | Or | Not | Eq | Less | Great
    deriving (Eq, Show)

data Exp = Literal Value
     | Primitive Op [Exp]
     | Variable String
     | If Exp Exp Exp
     | Let [(String, Exp)] Exp
    deriving (Show, Eq)

data Value = Number Int
       | Bool Bool
       | String String
    deriving (Eq, Show)

type Env = [(String, Value)]

eval :: Env -> Exp -> Value
eval e (Literal v) = v
eval e (Variable x) = fromJust (lookup x e)   --22

prim :: Op -> [Value] -> Value
prim Add [Number a, Number b] = Number (a + b)
prim And [Bool a, Bool b] = Bool (a && b)
prim Sub [Number a, Number b] = Number (a - b)
prim Mul [Number a, Number b] = Number (a * b)
prim Div [Number a, Number b] = Number (a `div` b)
prim Or [Bool a, Bool b] = Bool (a || b)
prim Not [Bool a] = Bool (not a)
prim Eq [Number a, Number b] = Bool (a == b)
prim Eq [String a, String b] = Bool (a == b) 
prim Less [Number a, Number b] = Bool (a < b)
prim Less [String a, String b] = Bool (a < b)
prim Great [Number a, Number b] = Bool (a > b)
prim Great [String a, String b] = Bool (a > b) --37

main = do
    n = "n"    -- parse error on input `='
    nv = Variable "n"   -- parse error on input `='
    lit n = Literal (Number n)  

    t0 = Primitive Mul [lit 5, lit 2]    
    t1 = Let [(n, t0)] (If (Primitive Great [nv, lit 9]) (lit 1) (lit 0))  -- parse error on input `=' 
```

我在收到错误的评论中写道。我检查了参数的有效性，一切看起来都很好。这可能是我的语法错误......我猜。

先感谢您。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-02T02:02:13.747

您的主要功能几乎在所有方面都被破坏了。您是否学习过 monad 或者对于这种情况仅了解 IO monad？

```
main :: IO Exp
main = do   
  let n = "n"
      nv = Variable "n"
      lit n = Literal (Number n)
      t0 = Primitive Mul [lit 5, lit 2]
      in return $ Let [(n, t0)] (If (Primitive Great [nv, lit 9]) (lit 1) (lit 0)) 
```

您不能只`=`在该 do-Block 的上下文中使用。此版本按预期工作。了解`let`表达式和`return`. 如果您不知道这一点，请在[此处](http://learnyouahaskell.com/input-and-output)阅读示例。

# google-app-engine - TypeError：在 GAE 中恰好采用 1 个参数（给定 2 个）

> ID：14657762
> 
> 赞同：1
> 
> 时间：2013-02-02T01:43:13.427
> 
> 标签：google-app-engine

在 GAE 中，我收到一条错误消息，告诉我：

**TypeError: get_default_tile() 只需要 1 个参数（给定 2 个）**

如您所见，我的主 py 文件**get_default_tile()**中的代码仅传递了一个参数，即*name*：

```
 default_tile = self.get_default_tile(name) 
```

完整代码如下：

```
import jinja2   # html template libary
import os

jinja_environment = jinja2.Environment(loader=jinja2.FileSystemLoader(os.path.dirname(__file__)))

import urllib   
import urllib2 
import webapp2

from google.appengine.ext import db
from google.appengine.api import urlfetch

class Default_tiles(db.Model):
  name = db.StringProperty()
  image = db.BlobProperty(default=None)

class MainPage(webapp2.RequestHandler):
  def get(self):

    # this just prints out the url which the user enters into input
    image_name = self.request.get('image_name') 

    template_values = {
        'image_name': image_name,
    }

    template = jinja_environment.get_template('index.html')
    self.response.out.write(template.render(template_values))

class Upload(webapp2.RequestHandler):
  def post(self):

    # get information from form post upload
    image_url = self.request.get('image_url') 
    image_name = self.request.get('image_name')

    # create database entry for uploaded image 
    default_tile = Default_tiles()
    default_tile.name = image_name
    default_tile.image = db.Blob(urlfetch.Fetch(image_url).content)
    default_tile.put()

    self.redirect('/?' + urllib.urlencode({'image_name': image_name}))

class Get_default_tile(webapp2.RequestHandler):
  def get(self):
    name = self.request.get('image_name')
    default_tile = self.get_default_tile(name)

    self.response.headers['Content-Type'] = "image/png"
    self.response.out.write(default_tile.image)

  def get_default_tile(name):
    result = db.GqlQuery("SELECT * FROM Default_tiles WHERE name = :1 LIMIT 1", name).fetch(1)
    if (len(result) > 0):
      return result[0]
    else:
      return None

app = webapp2.WSGIApplication([('/', MainPage),
                               ('/upload', Upload),
                               ('/default_tile_img', Get_default_tile)],
                              debug=True) 
```

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-02T01:46:05.190

`get_default_tile():`是类的成员方法，`Get_default_tile`因此您需要像这样定义它：

`def get_default_tile(self, name):`

或者，如果您希望它是静态方法：

```
@staticmethod
def get_default_tile(name): 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-01T04:12:55.933

好的，我也犯了这个错误，但代码如下：

> 类 myclassname（webapp2.RequestHandler）：
> 
> ```
>  def get(self):
> 
>      self.response.write('hola') 
> ```

我用=解决了

> 类 myclassname（webapp2.RequestHandler）：
> 
> ```
>  def get(self, **name**):
> 
>      self.response.write('hola') 
> ```

# c++ - Visual Studio 2012 平台工具集设置不正确

> ID：14657766
> 
> 赞同：2
> 
> 时间：2013-02-02T01:43:55.423
> 
> 标签：c++, visual-studio-2010, visual-studio-2012, nmake

我有一个在 VS 2010 中创建的 C++ 项目，现在我在 2012 年运行它，但我仍然想使用 2010 编译器。我在同一解决方案中的所有其他项目都很好，但由于某种原因，这个 NMake 文件将转到 Microsoft Visual Studio 11.0 的 MSBuild.exe 而不是 Microsoft Visual Studio 10.0，就像它应该的那样。有谁知道如何改变这个？

通常我会打开 vcxproj 并转到平台工具集并将其从 11 更改为 10，但我的 NMake 文件不允许这样做。

我认为问题出在这里-

```
ClCompile:
c:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\BIN\CL.exe /c... 
```

它应该是

```
c:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\BIN\CL.exe /c... 
```

但我不知道我需要改变什么来解决这个问题。

我也收到了这个错误，我只是假设这是由这个问题引起的。

```
C:\Program Files (x86)\MSBuild\Microsoft.Cpp\v4.0\V110\Microsoft.MakeFile.Targets(38,5): error MSB3073: The command "call build_qt.bat win32" exited with code 1.

```

我确信有一种简单的方法可以做到这一点，但我真的无法弄清楚。

有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-18T21:56:55.097

我不确定这是否对您的问题有帮助，但为了解决我在这篇博文中描述的问题：http: [//blogs.msdn.com/b/vcblog/archive/2012/06/15/10320645.aspx](http://blogs.msdn.com/b/vcblog/archive/2012/06/15/10320645.aspx)

我修改了我的 .pri/.pro 文件以包含这些值

```
win32 {  
  QMAKE_LFLAGS += /SUBSYSTEM:CONSOLE,5.01
  QMAKE_CXX += /D_USING_V110_SDK71_

  LIBS *= -L"%ProgramFiles(x86)%/Microsoft SDKs/Windows/7.1A/Lib"

  INCLUDEPATH += "%ProgramFiles(x86)%/Microsoft SDKs/Windows/7.1A/Include"
} 
```

为了安全起见，我还使用这些标志重新编译了 Qt 5.0（尽管我认为不需要它。

# ios - 在 CHCSVParser 中导致不需要的行完成的字符

> ID：14657771
> 
> 赞同：0
> 
> 时间：2013-02-02T01:44:35.877
> 
> 标签：ios, objective-c, cocoa-touch

在过去的一年里，我一直在使用 Dave DeLong 出色的 CHCSVParser 创建一个数组，如下所示：

```
 NSArray *array = [NSArray arrayWithContentsOfCSVFile:path encoding:NSISOLatin1StringEncoding error:&error2]; 
```

我只是现在有一个问题。csv 文件是从 Excel 电子表格生成的，省略号 - Excel 自动更正为单个字符 - 导致当前数组数组的结尾（我认为它必须调用 finishCurrentLine，但我不知道如何停止这个）。

1.  如何阻止“...”导致数组数组完成？
2.  我能做些什么来防止其他角色引起类似的问题？

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T18:21:18.810

If the file is in the ".xls" format, you can use the [libxls](https://sourceforge.net/projects/libxls/) open source library on SourceForge to read the file directly - and get the exact text or number for each cell. Also, there is an [ObjectiveC framework wrapper](http://github.com/dhoerl/DHlibxls) too.

# vim - 在文本编辑器中打开 Vim 文件时未对齐

> ID：14657772
> 
> 赞同：0
> 
> 时间：2013-02-02T01:44:58.617
> 
> 标签：vim

我有一个在 Vim 中创建的 javascript 文件，它看起来不错，但是当我在另一个程序（例如文本编辑器）中打开它时，缩进要大得多（比如 10 倍的空间）并且有些行没有对齐。我与 ~/.vimrc 文件中的行有关的唯一内容是：

```
"set tab indentation to 2 spaces"
:set tabstop=2

filetype plugin indent on 
```

有没有人看到这种行为或知道可能是什么问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-02T02:14:57.800

您的`vimrc`文件配置为将制表符显示为 2 个空格，但每个程序中制表符的显示方式并不相同。有时它们显示为 4，有时显示为 8。一个典型的论点是使用多个空格而不是实际的制表符，以使文件看起来一致，而不管文本编辑器的制表符设置如何，但以增加文件大小为代价。搜索“[制表符与空格](https://www.google.com/search?q=tabs+vs+spaces)”将为双方提供大量论据。

如果您决定使用空格，例如，您可以将 vim 配置为在您按下`tab`键时插入空格：

```
:set tabstop=2
:set shiftwidth=2
:set expandtab 
```

（来自[vim 维基](http://vim.wikia.com/wiki/Converting_tabs_to_spaces)）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-02T02:06:44.323

许多文本编辑器中的默认制表符间距是 8 个空格，而不是 2 个，因此任何包含制表符的源代码的缩进在这些文本编辑器中会显得更大。

# c++ - 编写 tcp 服务器——缓冲流

> ID：14657776
> 
> 赞同：0
> 
> 时间：2013-02-02T01:45:09.770
> 
> 标签：c++, c, string, tcp, buffer

```
#include <sys/socket.h> // for socket(), bind(), listen(), accept()
#include <netinet/in.h> // for PF_INET, SOCK_STREAM, IPPROTO_TCP
#include <stdio.h>  // for printf(), perror()
#include <unistd.h> // for read(), write(), close()
#include <string.h> // for bzero()

#define DEMO_PORT 9723

int main( void )
{
    //-----------------------------------------
    // create an unnamed socket for the server
    //-----------------------------------------
    int sock = socket( PF_INET, SOCK_STREAM, IPPROTO_TCP );
    if ( sock < 0 )
    {
        perror( "opening stream socket" );
        return  -1;
    }
    printf( "\nsock=%d \n", sock );

    //----------------------------------------
    // construct a name for the server socket
    //----------------------------------------
    struct sockaddr_in  self;
    socklen_t       nlen = sizeof self;
    bzero( &self, sizeof self );
    self.sin_family = AF_INET;
    self.sin_port = htons( DEMO_PORT );
    self.sin_addr.s_addr = htonl( INADDR_ANY );
    if ( bind( sock, (sockaddr *)&self, nlen ) < 0 )
    {
        perror( "bind failed" );
        return  -1;
    }
    printf( "bind succeeded port: %d\n",DEMO_PORT);

    //---------------------------------------------------------
    // now create a connection queue and wait for some clients
    //---------------------------------------------------------
    if ( listen( sock, 5 ) < 0 )
    {
        perror( "listen failed" );
        return  -1;
    }
    printf( "listen succeeded \n" );

    //---------------------------------------------------
    // main loop to process clients' connection-requests
    //---------------------------------------------------
    while ( 1 )
    {
        sockaddr_in peer;
        socklen_t   plen = sizeof peer;
        bzero( &peer, plen );

        printf( "server waiting \n" );

        int client = accept( sock, (sockaddr *)&peer, &plen );
        if ( client < 0 ) { perror( "accept" ); break; }

        //---------------------------------------------
        // we can now read from or write to the client
        //---------------------------------------------
        char    ch;
        int index = 0;
        char get[1024];

        if ( read( client, &ch, 1 ) < 0 )
        {
            perror( "read" );
        }  

        bool go = true;

        while(go){

            if(ch != '/' && ch != '\r'){

                printf("read: %hhd\n", ch);

                get[index] = ch;
                printf( "got stuff: %s\n", get );

                index++;

                read(index, &ch, 1);

            } else {

                go = false;
                index = 0;
                close( client );
                printf( "server responded, connection closed" );

            }
        }

        //if ( write( client, &ch, 1 ) < 0 ) { perror( "write" ); break; }

    }

    close( sock );
    printf( "\n" );
} 
```

while(go) 看起来永远不会起作用，并且缓冲不正确。我没有看到缓冲区内的模式或它是如何工作的。

这样做的正确方法是什么？除了一定数量的字节，将它们存储在一个字符串中，然后如果它到达换行符则终止读取？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T03:41:02.653

您正在将 index 传递给您应该传递 client 的第二个 read 调用。

这可能不是您唯一的问题，但我认为这是其中之一。

# javascript - 谷歌地图在限定时间内在标记上弹跳动画

> ID：14657779
> 
> 赞同：4
> 
> 时间：2013-02-02T01:45:56.653
> 
> 标签：javascript, html, google-maps, google-maps-api-3

我希望标记弹跳几秒钟并最终自动停止。我正在尝试这段代码：

```
1\. globalMarkers[i].setAnimation(google.maps.Animation.BOUNCE);
2\. setTimeout(function() {
3\.    globalMarkers[i].setAnimation(null)
4\. }, 3000); 
```

但由于某种原因，第 1 行执行（因此标记将开始弹跳）但第 3 行返回以下错误：

```
Uncaught TypeError: Cannot call method 'setAnimation' of undefined
        (anonymous function) 
```

有什么想法吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-02-02T02:23:28.037

这很好用（使用单个全局标记对象）

```
 marker.setAnimation(google.maps.Animation.BOUNCE);

    setTimeout(function() {
        marker.setAnimation(null)
    }, 3000); 
```

我的猜测是您正在交互，而您的 setTimeout i 不在范围内。试试这个：

```
 for (var x = 0; x < 5; x++) {
        var marker = markers[x];
        marker.setAnimation(google.maps.Animation.BOUNCE);
        stopAnimation(marker);
    }

function stopAnimation(marker) {
    setTimeout(function () {
        marker.setAnimation(null);
    }, 3000);
} 
```

这里有一些更有创意的解决方案：

[Javascript如何在迭代列表操作上使用setTimeout？](https://stackoverflow.com/questions/8108346/javascript-how-to-use-settimeout-on-an-iterative-list-operation)

# mysql - 配对唯一列 MySQL？

> ID：14657781
> 
> 赞同：2
> 
> 时间：2013-02-02T01:46:17.683
> 
> 标签：mysql, sql, database, unique, mysql-workbench

我想知道如何使配对列成为唯一键？

我正在研究 MySQL 工作台，现在我已经将两列 (follow,following) 设置为 UQ，我假设这是唯一键？

所以当我试图插入行时，我试图插入

```
follow      following
  3              5
  3              6 
```

但跟随是唯一的关键。但我只想为一对做唯一的钥匙，而不是单独的数字。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-02T01:50:09.110

如果我没记错的话，您只为每列设置了一个唯一键。也许你想要复合列`UNIQUE`，试试

```
ALTER TABLE tableName ADD CONSTRAINT tb_UQ UNIQUE (follow, following) 
```

如果您运行该`ALTER`语句，则上面的示例数据是有效的，但如果您尝试插入另一对`3, 5`，则保证会失败。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-02T01:58:27.787

如果您使用`follow`PRIMARY 键创建表，则 RDBMS 将仅基于该列强制唯一性。

作为 JW 建议的替代方案，您可以更改主键：

```
ALTER TABLE tableName DROP PRIMARY KEY;
ALTER TABLE tableName ADD CONSTRAINT tb_UQ PRIMARY KEY (follow, following); 
```

# mysql - GROUP BY 每年都有缺失的年份

> ID：14657786
> 
> 赞同：0
> 
> 时间：2013-02-02T01:47:14.673
> 
> 标签：mysql

我正在尝试在 MySQL 中使用以下查询来汇总记录。只要每年至少有一个记录，它就可以很好地工作。如果记录在年份中丢失，则年份不会出现。如何修改它以在我的过滤器中显示每年？

```
SELECT SUM( SICK_SIZE + DEAD_SIZE ) AS Cases, DATE_FORMAT( EVENT_DATE,  '%Y' ) AS DateYear
FROM report_case_ext
WHERE DATE_FORMAT( EVENT_DATE,  '%Y' ) >= DATE_FORMAT( DATE_ADD( CURDATE( ) , INTERVAL -4YEAR ) ,  '%Y' ) 
AND DATE_FORMAT( EVENT_DATE,  '%Y' ) <= DATE_FORMAT( CURDATE( ) ,  '%Y' ) 
GROUP BY DATE_FORMAT( EVENT_DATE,  '%Y' ) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T02:13:15.237

在 MySQL 中，您可以使用 sqlvariables，连接到任何其他表来模拟行创建——它返回您正在查找的年份的有效结果集，然后 LEFT-JOIN 到您的其他表，这样您就知道您将始终得到你想要的年...

```
select
      YearsYouWant.RequireYear as DateYear,
      SUM( RCE.SICK_SIZE + RCE.DEAD_SIZE ) AS Cases
   from
      ( select @nYear := @nYear +1 as RequireYear
           from report_case_ext,
                ( select @nYear := year( curdate()) -5 ) sqlvars
           limit 5 ) as YearsYouWant
         LEFT JOIN
            report_case_ext RCE
               on YearsYouWant.RequireYear = year( RCE.Event_Date )
   GROUP BY 
      YearsYouWant.RequireYear 
```

使用“report_case_ext”的内部预查询仅用于拥有至少5条记录的表以保留您想要的年份......在这种情况下，

@nYear 被初始化为比您正在寻找的 4 年少 1 年——因此 -5

curdate() = 2013 - 5 = 2008。

然后，在 select @nYear := @nYear +1 first time 中，第一年将变为 2009 年并完成 5 年，从而生成 2009 年、2010 年、2011 年、2012 年和 2013 年的记录（通过 LIMIT 5）

现在（所有年份的）结果被左连接到普通年份的 report_case_ext 表中。所以，即使是那些没有日期的

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T01:52:40.260

创建一个包含所有可能的年/月/日的表（取决于您的需要）。然后左加入表。

[在 sql 结果中填充空日期的最直接方法是什么（在 mysql 或 perl 端）？](https://stackoverflow.com/questions/75752/what-is-the-most-straightforward-way-to-pad-empty-dates-in-sql-results-on-eithe)

# c++ - 试图在列表中 push_back。C++

> ID：14657788
> 
> 赞同：0
> 
> 时间：2013-02-02T01:47:19.070
> 
> 标签：c++

当我尝试使用列表中的 push_back 方法时出现编译器错误。

这是我的代码：

```
// Point iterator to the proper warehouse.
set<cs3505::warehouse>::iterator curr_warehouse = warehouses.find(warehouse);

// Insert new inventory_item into the warehouse.

// Create a copy of today's date, and increment it.
cs3505::date exp_date = current_date;
exp_date.increment(curr_food.get_shelf_life());

// Create a new inventory item.
cs3505::inventory_item new_item(curr_food, exp_date);
// Set the quantity of the new item.
new_item.set_quantity(qty);

// Now insert the item.
// Adding new items being at the end ensures the oldest items will be at the 
// beginning of the list.
(*curr_warehouse).inventory.push_back(new_item); 
```

编译器错误：

> report.cc:134：错误：将 'const std::list >' 作为 'void std::list<_Tp, _Alloc>::push_back(const _Tp&) 的 'this' 参数传递 [with _Tp = cs3505::inventory_item, _Alloc = std::allocator]' 丢弃限定符

我的代码的最后一行是第 134 行。感谢您的帮助。几个小时以来，我一直在努力解决这个问题。

这是inventory_item的定义：

```
/*
 * An inventory item which includes a food item, an expiration date,
 * and quantity.
 */

#include "inventory_item.h"
#include "date.h"
#include "food_item.h"

namespace cs3505
{
// inventory_item definitions

/*
 * Constructs an inventory item.
 */
inventory_item::inventory_item(food_item &item, date &exp_date)
{
    this->item = item;
    this->expiration_date = exp_date;
    this->quantity = 0;
}

/*
 * Destructs a food item.
 */
inventory_item::~inventory_item() { }

/*
 * Returns this inventory item's food item.
 */
food_item inventory_item::get_food_item()
{
    return this->item;
}

/*
 * Returns the expiration date for this inventory item.
 */
date inventory_item::get_exp_date()
{
    return this->expiration_date;
}

/*
 * Returns the quantity of this inventory item.
 */
int inventory_item::get_quantity()
{
    return this->quantity;
}

/*
 * Sets the quantity of this food item.
 */
void inventory_item::set_quantity(int change)
{
    this->quantity = change;
}
} 
```

我还有一个包含列表的自定义仓库类。我正在尝试将库存项目添加到该列表中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T02:02:12.727

这里的错误是因为您忽略了`const`限定符。这是因为集合返回的迭代器*必须*是 const。这个限制是存在的，因为集合中的所有元素都必须是唯一的；通过迭代器更改集合中元素的值可能会破坏此契约。

我找不到确切的参考资料（SGI 的参考资料`std::set`没有提到这一点），所以我将链接到另一个 Stackoverflow 帖子，解释了这一点：[C++ STL 集更新很乏味：我无法更改元素到位](https://stackoverflow.com/questions/2217878/c-stl-set-update-is-tedious-i-cant-change-an-element-in-place)

编辑：找到了。

[`std::set`](http://www.sgi.com/tech/stl/set.html)是一种[简单关联容器](http://www.sgi.com/tech/stl/SimpleAssociativeContainer.html)，意味着值与键相同。以下段落对此进行了总结：

> X::iterator 和 X::const_iterator 类型必须是相同的类型。也就是说，简单关联容器不提供可变迭代器。

这确实意味着我的第一段在技术上略有错误。这并不是要确保您不会将集合的元素从其下方更改为相同的值，而是仅仅是设计使然。[它实际上是基本关联容器](http://www.sgi.com/tech/stl/AssociativeContainer.html)概念上的“键是不可变的”不变量的副作用。

尽管如此，我还是要把它留在那里，以免进行重大编辑。

# android - Android AsyncTask onPostExecute 不会显示 AlertDialog

> ID：14657790
> 
> 赞同：5
> 
> 时间：2013-02-02T01:48:12.143
> 
> 标签：android, android-asynctask, android-alertdialog

我的 AsyncTask 类的 onPostExecute 有问题。这是代码。

**--编辑：按要求在其余代码中添加--**

```
public class MainActivity extends Activity {

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    preliminaryTasks();
}

private void preliminaryTasks() {

    //removed more code

    new discoverAddresses().execute();

}

public class discoverAddresses extends AsyncTask<String, Void, List<String>> {

    @Override
    protected List<String> doInBackground(String... params){

        /* Lots of code here taken out */

        List<String> addresses = new ArrayList<String>();
        //Added for debugging purposes
        addresses.add("http://192.168.1.120:80");
        addresses.add("http://192.168.1.110:80");
        return addresses;

    }

    @Override
    protected void onPostExecute(List<String> addresses){

        MainActivity.this.runOnUiThread(new Runnable(){
            public void run(){
                AlertDialog.Builder builder = new AlertDialog.Builder(MainActivity.this);
                builder.setMessage("Are you sure you want to exit?").setCancelable(false)
                        .setPositiveButton("Yes", new DialogInterface.OnClickListener() {
                            public void onClick(DialogInterface dialog, int id) {
                                MainActivity.this.finish();
                            }
                        }).setNegativeButton("No", new DialogInterface.OnClickListener() {
                            public void onClick(DialogInterface dialog, int id) {
                                dialog.cancel();
                            }
                        });
                AlertDialog alert = builder.create();
                alert.show();
            }
        });

        AlertDialog.Builder builder = new AlertDialog.Builder(MainActivity.this);
        builder.setMessage("Are you sure you want to exit?").setCancelable(false)
                .setPositiveButton("Yes", new DialogInterface.OnClickListener() {
                    public void onClick(DialogInterface dialog, int id) {
                        MainActivity.this.finish();
                    }
                }).setNegativeButton("No", new DialogInterface.OnClickListener() {
                    public void onClick(DialogInterface dialog, int id) {
                        dialog.cancel();
                    }
                });
        AlertDialog alert = builder.create();
        alert.show();

        return; 

    }
}
} 
```

但是警告对话框永远不会出现；当我在调试器中观看时，它会执行 alert.show() 行，但它永远不会显示在 UI 上。有没有人知道为什么会这样？谢谢！

**编辑：两个 AlertDialogs 都在调试器中执行，但从不在 UI 上显示**

**EDIT2：我只复制了我在此处发布的代码（以查看是否是我为简化而删除的导致问题的代码）到一个新项目中，并且实际出现了 alertdialog，这意味着我取出的代码是一个问题。在强制关闭应用程序终止后，这将出现在我的原始项目中的 LogCat 中。**

```
02-02 11:13:28.746: D/AndroidRuntime(11658): Shutting down VM
02-02 11:13:28.746: W/dalvikvm(11658): threadid=1: thread exiting with uncaught exception (group=0x40fce300)
02-02 11:13:28.762: E/AndroidRuntime(11658): FATAL EXCEPTION: main
02-02 11:13:28.762: E/AndroidRuntime(11658): java.lang.NullPointerException
02-02 11:13:28.762: E/AndroidRuntime(11658):    at android.widget.ArrayAdapter.createViewFromResource(ArrayAdapter.java:394)
02-02 11:13:28.762: E/AndroidRuntime(11658):    at android.widget.ArrayAdapter.getView(ArrayAdapter.java:362)
02-02 11:13:28.762: E/AndroidRuntime(11658):    at android.widget.AbsListView.obtainView(AbsListView.java:2257)
02-02 11:13:28.762: E/AndroidRuntime(11658):    at android.widget.ListView.measureHeightOfChildren(ListView.java:1244)
02-02 11:13:28.762: E/AndroidRuntime(11658):    at android.widget.ListView.onMeasure(ListView.java:1156)
02-02 11:13:28.762: E/AndroidRuntime(11658):    at android.view.View.measure(View.java:15172)
02-02 11:13:28.762: E/AndroidRuntime(11658):    at android.view.ViewGroup.measureChildWithMargins(ViewGroup.java:4816)
02-02 11:13:28.762: E/AndroidRuntime(11658):    at android.widget.LinearLayout.measureChildBeforeLayout(LinearLayout.java:1390)
02-02 11:13:28.762: E/AndroidRuntime(11658):    at android.widget.LinearLayout.measureVertical(LinearLayout.java:681)
02-02 11:13:28.762: E/AndroidRuntime(11658):    at android.widget.LinearLayout.onMeasure(LinearLayout.java:574)
02-02 11:13:28.762: E/AndroidRuntime(11658):    at android.view.View.measure(View.java:15172)
02-02 11:13:28.762: E/AndroidRuntime(11658):    at android.view.ViewGroup.measureChildWithMargins(ViewGroup.java:4816)
02-02 11:13:28.762: E/AndroidRuntime(11658):    at android.widget.LinearLayout.measureChildBeforeLayout(LinearLayout.java:1390)
02-02 11:13:28.762: E/AndroidRuntime(11658):    at android.widget.LinearLayout.measureVertical(LinearLayout.java:681)
02-02 11:13:28.762: E/AndroidRuntime(11658):    at android.widget.LinearLayout.onMeasure(LinearLayout.java:574)
02-02 11:13:28.762: E/AndroidRuntime(11658):    at android.view.View.measure(View.java:15172)
02-02 11:13:28.762: E/AndroidRuntime(11658):    at android.view.ViewGroup.measureChildWithMargins(ViewGroup.java:4816)
02-02 11:13:28.762: E/AndroidRuntime(11658):    at android.widget.FrameLayout.onMeasure(FrameLayout.java:310)
02-02 11:13:28.762: E/AndroidRuntime(11658):    at android.view.View.measure(View.java:15172)
02-02 11:13:28.762: E/AndroidRuntime(11658):    at android.view.ViewGroup.measureChildWithMargins(ViewGroup.java:4816)
02-02 11:13:28.762: E/AndroidRuntime(11658):    at android.widget.FrameLayout.onMeasure(FrameLayout.java:310)
02-02 11:13:28.762: E/AndroidRuntime(11658):    at android.view.View.measure(View.java:15172)
02-02 11:13:28.762: E/AndroidRuntime(11658):    at android.view.ViewGroup.measureChildWithMargins(ViewGroup.java:4816)
02-02 11:13:28.762: E/AndroidRuntime(11658):    at android.widget.FrameLayout.onMeasure(FrameLayout.java:310)
02-02 11:13:28.762: E/AndroidRuntime(11658):    at com.android.internal.policy.impl.PhoneWindow$DecorView.onMeasure(PhoneWindow.java:2148)
02-02 11:13:28.762: E/AndroidRuntime(11658):    at android.view.View.measure(View.java:15172)
02-02 11:13:28.762: E/AndroidRuntime(11658):    at android.view.ViewRootImpl.performMeasure(ViewRootImpl.java:1850)
02-02 11:13:28.762: E/AndroidRuntime(11658):    at android.view.ViewRootImpl.measureHierarchy(ViewRootImpl.java:1077)
02-02 11:13:28.762: E/AndroidRuntime(11658):    at android.view.ViewRootImpl.performTraversals(ViewRootImpl.java:1275)
02-02 11:13:28.762: E/AndroidRuntime(11658):    at android.view.ViewRootImpl.doTraversal(ViewRootImpl.java:1000)
02-02 11:13:28.762: E/AndroidRuntime(11658):    at android.view.ViewRootImpl$TraversalRunnable.run(ViewRootImpl.java:4214)
02-02 11:13:28.762: E/AndroidRuntime(11658):    at android.view.Choreographer$CallbackRecord.run(Choreographer.java:725)
02-02 11:13:28.762: E/AndroidRuntime(11658):    at android.view.Choreographer.doCallbacks(Choreographer.java:555)
02-02 11:13:28.762: E/AndroidRuntime(11658):    at android.view.Choreographer.doFrame(Choreographer.java:525)
02-02 11:13:28.762: E/AndroidRuntime(11658):    at android.view.Choreographer$FrameDisplayEventReceiver.run(Choreographer.java:711)
02-02 11:13:28.762: E/AndroidRuntime(11658):    at android.os.Handler.handleCallback(Handler.java:615)
02-02 11:13:28.762: E/AndroidRuntime(11658):    at android.os.Handler.dispatchMessage(Handler.java:92)
02-02 11:13:28.762: E/AndroidRuntime(11658):    at android.os.Looper.loop(Looper.java:137)
02-02 11:13:28.762: E/AndroidRuntime(11658):    at android.app.ActivityThread.main(ActivityThread.java:4899)
02-02 11:13:28.762: E/AndroidRuntime(11658):    at java.lang.reflect.Method.invokeNative(Native Method)
02-02 11:13:28.762: E/AndroidRuntime(11658):    at java.lang.reflect.Method.invoke(Method.java:511)
02-02 11:13:28.762: E/AndroidRuntime(11658):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:791)
02-02 11:13:28.762: E/AndroidRuntime(11658):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:558)
02-02 11:13:28.762: E/AndroidRuntime(11658):    at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T02:26:53.437

这对我有用，在 OnPostExecute 方法中。

我在我的 AsyncTask 类中添加 Activity 对象作为属性，我在该 AsyncTack 的构造函数中实例化它，以便我可以调用该活动并在 onpostexe 中执行 runOnUiThread ...

```
AlertDialog.Builder builder = new AlertDialog.Builder(Activity);
            builder.setTitle("Connection ?");
            builder.setIcon(android.R.drawable.ic_dialog_alert);
            builder.setMessage("Test \n ");
            builder.setPositiveButton("Ok",null);
            final AlertDialog alert = builder.create();
            Activity.runOnUiThread(new java.lang.Runnable(){
                public void run(){
                    //show AlertDialog
                    alert.show();
                }
            }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-02T17:45:41.090

我发现我的代码有问题。在某个时候，这个方法被调用了 promptAddresses。它有自己独立的 AlertDialog。因为 addressArray 的索引为 5，所以它与 AlertDialog.builder 搞砸了，因为其中三个索引为空。

**TLDR：在处理 AlertDialog.Builders 时，字符串数组中没有任何空值**

解决方案：最终 String[] addressArray = new String[address.size **()** ];

非常感谢所有帮助过的人。我很抱歉没有提供完整的代码并混淆了整个问题。无论如何，您的回答仍然很有帮助。

```
public String promptAddresses(List<String> addresses){
    final String[] addressArray = new String[5];
    int i = 0;

    Iterator it = addresses.iterator();
    while(it.hasNext()){
        String next = (String) it.next();
        addressArray[i] = next;
        Log.i("ADDRESSES", next);
        i++;
    }

    AlertDialog.Builder builder = new AlertDialog.Builder(MainActivity.this);
    builder.setTitle("Pick your address");
    builder.setItems(addressArray, new DialogInterface.OnClickListener() {
               public void onClick(DialogInterface dialog, int which) {
               // The 'which' argument contains the index position
               // of the selected item
           }
    });
    AlertDialog alert =  builder.create();
    alert.show();

    return hubAddress;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-02T02:03:44.883

我看了你的代码，但找不到任何问题。你`AsyncTask`在主线程中执行了吗？如果没有，您可以包装以下代码以显示`AlertDialog`：

```
runOnUiThread(new Runable(){
    public void run(){
        //show AlertDialog
    }
}) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-02T04:03:01.287

doInBackground() 函数的代码中有一个错误：

```
List<String> addresses = null;
//Added for debugging purposes
addresses.add("http://192.168.1.120:80"); 
```

这将在第二行生成 Null 异常，因为地址为空，因此将终止您的线程。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-02T17:26:35.393

我猜你的`actvity_main.xml`. 我通过空白尝试了您提供的代码`RelativeLayout`该代码工作正常，它显示了两个警报对话框以及编码功能。只需尝试相同并跟踪错误

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent" >
</RelativeLayout> 
```

# c++ - (C++) 井字游戏的动态分配数组

> ID：14657794
> 
> 赞同：0
> 
> 时间：2013-02-02T01:48:46.577
> 
> 标签：c++

我正在尝试使用对象、类等制作井字游戏。但是，用户可以输入一个选项，以便他/她可以设置棋盘的大小。目前，它只能做正方形（3x3、4x4 等）。

我在白板上画了一张图表来解释我接下来要讨论的内容（忽略关于订单和原始轴的右侧，这是其他内容。真正需要关注的是表格和代码） ：[http ://d.pr/i/5CY8](http://d.pr/i/5CY8)

游戏板的宽度和高度由用户输入的大小（逐个数字）设置。然后我有两个 for 循环来每次创建一个指向新 Square 的指针。一个数组列表将保存我们的正方形。但是由于数组列表的位置（它在标题中），我无法在创建二维数组时分配它的大小。因此，我需要动态分配大小，以便我可以设置数组的大小，以便在输入大小时保存正方形的数组列表。但是，我无法弄清楚如何做到这一点。

我在 Pastebin 和 Visual Studio 2012 中都有代码。我相信查看 Visual Studio 文件会更容易，因为会有很多 Pastebin 链接。

Pastebin 上 Visual Studio 文件/代码的链接列表（抱歉，我达到了链接限制！）： http: [//pastebin.com/spH3JaHP](http://pastebin.com/spH3JaHP)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T02:22:49.960

看起来您正在使用 10x10 数组（不同于数组列表/向量）来存储您的电路板状态。在运行时声明二维数组的正确方法是`new[]`运算符。例如：

```
// header file
Square::SquareState ** boardArray;

// array generation
int height, width;
// get height, width
boardArray = new Square::SquareState*[height];
for (int i = 0; i < height; i ++)
    boardArray[i] = new Square::SquareState[width]; 
```

然后，您可以将 boardArray 用作任何旧的 2D 数组。

# node.js - http.ClientRequest 错误

> ID：14657797
> 
> 赞同：0
> 
> 时间：2013-02-02T01:49:28.857
> 
> 标签：node.js

当向我的应用程序抛出请求时，我会向另一个网络服务器发送请求。但有时，我会收到一些我以前从未见过的奇怪的解析错误。

以下是解析错误的样子：

```
node.js:201
        throw e; // process.nextTick error, or 'error' event on first tick
              ^
Error: Parse Error
    at Socket.ondata (http.js:1150:24)
    at TCP.onread (net.js:354:27) 
```

这是我用来发送请求的代码：

```
var request = http.request(options);
request.end();
request.on('response', function (response) {
    response.on('end', function () {
        console.log('Response received');
    }
} 
```

我的问题是如何减轻这种情况，以便在发生此错误时再次抛出请求？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T08:07:26.883

首先，你应该把所有的`.on()`听众放在你面前`.end()`，因为并不是所有的 API 都是`nextTick`他们的`.end()`方法。

其次，如果你没有`.on('error')`监听器，节点的事件发射器会抛出错误。所以你的代码应该看起来更像这样

```
var request = http.request(options)
request.on('response', function (response) {
  response.on('end', function () {
    console.log('Response received.')
  })
  response.on('error', function (err) {
    console.log('I got a response error.')
    console.error(err.stack)
  })
})
request.on('error', function (err) {
  console.log('I got a request error.')
  console.error(err.stack)
})
request.end() 
```

# objective-c - 将 NSDecimalNumber 用于带有 Binet 公式的斐波那契数列

> ID：14657802
> 
> 赞同：2
> 
> 时间：2013-02-02T01:50:18.017
> 
> 标签：objective-c, cocoa, fibonacci, nsdecimalnumber

当 n 是一个非常大的数字时，我今天花了相当多的时间试图计算斐波那契第 n 项。我决定使用 Objective-C，考虑到它花了多长时间，事后看来这可能不是最好的决定。我研究并决定使用 Binet 的公式，该公式似乎适用于使用其他编程语言的其他人。

```
double phi = (sqrt(5) + 1) / 2.0;
long long j = (long long) round(pow(phi, number) / sqrt(5)); 
```

是 C 中 fibonacci(number) 函数的要点。我尝试使用 NSDecimalNumber 将其转换为 Objective-C，我的方法如下所示：

```
NSDecimalNumber* squareRootOfFive = [NSDecimalNumber decimalNumberWithString: [[NSNumber numberWithDouble:sqrt(5)] stringValue]];
NSDecimalNumber* phi = [[squareRootOfFive decimalNumberByAdding:[NSDecimalNumber one]] decimalNumberByDividingBy:[NSDecimalNumber decimalNumberWithString:@"2"]];

return [[[phi decimalNumberByRaisingToPower: number] decimalNumberByDividingBy:squareRootOfFive] decimalNumberByRoundingAccordingToBehavior: [NSDecimalNumberHandler decimalNumberHandlerWithRoundingMode:  NSRoundPlain scale:2 raiseOnExactness:NO raiseOnOverflow:YES raiseOnUnderflow:NO raiseOnDivideByZero:NO ]]; 
```

我知道非常可读。此代码适用于 X 大于 700 但小于 800 的第一个 X 斐波那契数。我最终得到此错误/输出：

2013-02-01 17:27:19.977 Euler25[14907:303] 斐波那契数 792 有 166 位

2013-02-01 17:27:19.989 Euler25[14907:303] *** 由于未捕获的异常“NSDecimalNumberOverflowException”而终止应用程序，原因：“NSDecimalNumber 溢出异常”

*** 首先抛出调用堆栈：

```
0   CoreFoundation   0x00007fff8c3b10a6 __exceptionPreprocess + 198

1   libobjc.A.dylib  0x00007fff880443f0 objc_exception_throw + 43

2   CoreFoundation   0x00007fff8c3b0e7c +[NSException raise:format:] + 204

3   Foundation       0x00007fff8c88bc3d -[NSDecimalNumberHandler exceptionDuringOperation:error:leftOperand:rightOperand:] + 193

4   Foundation       0x00007fff8c88ad46 _checkErrorAndRound + 60

5   Foundation       0x00007fff8c88b1e2 -[NSDecimalNumber decimalNumberByRaisingToPower:withBehavior:] + 156

6   Euler25          0x0000000100001bb2 +[Euler25 fibonacci:] + 402

7   Euler25          0x0000000100001978 main + 184

8   libdyld.dylib    0x00007fff8a5147e1 start + 0

9   ???              0x0000000000000001 0x0 + 1 
```

我无法很好地格式化。我正在使用此代码来解决 Project euler [问题 25]( [1]: [http://projecteuler.net/](http://projecteuler.net/) [2]: [https://projecteuler.net/problem=25](https://projecteuler.net/problem=25) )，如何处理大量数据在Objective-C中，如果不使用NSDecimalNumber，我不确定如何进一步解决这个问题，也许我应该使用一些数学技巧？

提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-02T03:41:55.393

`NSDecimalNumber`您已经达到了 a可以容纳的最大值。有一个函数可以准确地告诉你它是什么。尝试：

```
NSLog(@"%@", [NSDecimalNumber maximumDecimalNumber]); 
```

它会给你：

> 3402823669209384634633746074317682114550000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000

恰好是 166 位数字。

Objective-C/C 不支持大于此的数字，因此您需要使用任意精度数学库。这是另一个讨论一些选项的[SO question 。](https://stackoverflow.com/q/1226949/937822)

**编辑：**
另外，正如 Metabble 在下面提到的，尾数中的最大位数是 38 位。这意味着任何导致值大于 38 位的计算都将被截断并使用尾数存储，以跟踪剩余位数。当您访问结果时，第 38 位之后的每个数字都将为 0，这会导致值不正确。

# python - Django：如何使用 values_list 属性编写 GET 查询？

> ID：14657804
> 
> 赞同：1
> 
> 时间：2013-02-02T01:50:24.540
> 
> 标签：python, django, django-models, django-queryset

我想为单个实例（例如，`id=1`）查询模型，但我只想返回单个字段（`'title'`）的值。我可以通过以下查询来实现这一点：

`SomeModel.objects.filter(pk=1).values_list('title', flat=True)`

但是 a`get`比 a 更有效`filter`。但是，`values_list`不要`values`使用`get`查询。理想情况下，我更愿意这样做：

`SomeModel.objects.get(pk=1).values_list('title', flat=True)`

但我收到以下错误：`AttributeError: SomeModel has no attribute 'title'`

**编写此查询的最佳方法是什么？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-02T02:03:07.997

> 但是 a`get`比 a 更有效`filter`。

这是不正确的。A`.get(…)`将生成与 a*完全相同*的 SQL `.filter(…)`。

使用：

```
SomeModel.objects.filter(pk=1)[0:1].values_list('title', flat=True) 
```

会做你想做的事，并且将具有完全相同的性能特征`.get(…)`（实际上，它会快一点，因为`.get(…)`检查是否会返回多行......）：

```
在 [4] 中：导入日志记录

在 [5] 中： l = logging.getLogger("django.db")

在 [6] 中：l.setLevel(logging.DEBUG)

在 [7] 中：User.objects.filter(id=1)[0:1].values_list()
DEBUG:django.db.backends:(0.006) SELECT "auth_user"."id", "auth_user"."username", "auth_user"."first_name", "auth_user"."last_name", "auth_user"."email ", "auth_user"."password", "auth_user"."is_staff", "auth_user"."is_active", "auth_user"."is_superuser", "auth_user"."last_login", "auth_user"."date_joined" FROM "auth_user" WHERE "auth_user"."id" = 1 LIMIT 1; 参数=（1，）
Out[7]: [(1, u'admin', u'Admin', u'User', u'admin@example.com', u'sha1$bf3bc$daa1fb58a8a41e15c730ae86bc0faf4c01fdd3a1', True, True, True, datetime. datetime(2013, 1, 8, 21, 15, 51, 855527), datetime.datetime(2012, 1, 10, 15, 13, 55))]

在 [8] 中：User.objects.get(id=1)
DEBUG:django.db.backends:(0.001) SELECT "auth_user"."id", "auth_user"."username", "auth_user"."first_name", "auth_user"."last_name", "auth_user"."email ", "auth_user"."password", "auth_user"."is_staff", "auth_user"."is_active", "auth_user"."is_superuser", "auth_user"."last_login", "auth_user"."date_joined" FROM "auth_user" WHERE "auth_user"."id" = 1 ; 参数=（1，）
出[8]：<用户：管理员>

```

# jquery - jQuery 模块化脚本架构 - 延迟加载与内联加载

> ID：14657806
> 
> 赞同：0
> 
> 时间：2013-02-02T01:50:37.767
> 
> 标签：jquery, jquery-plugins

我正在构建一个`template.htm`包含多个 ajax 加载内容块的页面。因为我遇到了问题，所以我加载了`synchronously`如下内容：

```
 $.ajax({
        url: 'module.htm'
    })
    .done(function(r) {
        $('#moduleA').html(r);
    }); 
```

我这样做了几次，加载各种不同的`module.htm`文件。它们都有一个标准的 html 文件，其中包含`<!DOCTYPE html>`标题、正文等。其中也有大量的 jQuery。

其中一些模块具有动态添加的元素，主要使用`.append()`这样的

```
$.ajax(......)
.done(function(response) {
    var item = $.parseJSON(response);
    // iterating voer the JSON and appending elements
    $('div').myPluginMethod(); // utilizing the plugin here
}); 
```

我使用一个特定的插件`$.fn.myPluginMethod`，并注意到一个问题：

**问题：**`<script>`在使用的标题中 加载插件`module.htm`并自行运行时 - 在之外`template.htm`，一切正常。在控制台中，我可以输入`$.fn.myPluginMethod`并返回函数。

但是如果我将`module.htm`文件加载到父`template.htm`页面中，它就不再起作用了。在控制台中，键入`$.fn.myPluginMethod`返回`undefined`。

这没有意义。Firebug 显示插件脚本已加载，为什么会失败？

**我的理论** 不知何故，我认为这与我的 ajax 负载有关。该`.done()`方法不知何故无法“看到”插件的对象，因此它抛出了`unknown method error`. 我可以手动粘贴插件，然后它就可以工作了：

```
$.ajax(......)
.done(function(response) {
    var item = $.parseJSON(response);
    // iterating voer the JSON and appending elements
    // I can paste my raw plugin code here and it will work, but that's silly
}); 
```

我试图了解为什么这个 ajax 业务会导致问题。我认为一旦将插件加载到 DOM 中，所有脚本，无论是否动态，都将能够“看到”它的方法。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T02:19:01.627

听起来您正在从远程文件再次加载 jQuery.js。这将覆盖主页面中的 jQuery 对象。任何注册到初始 jQuery 对象的插件都将被清除。

# c++ - 如何以编程方式确定网卡是虚拟网卡？

> ID：14657807
> 
> 赞同：2
> 
> 时间：2013-02-02T01:51:07.930
> 
> 标签：c++, c, windows, winapi, virtual-machine

在 HKEY_LOCAL_MACHINE/SOFTWARE/Microsoft/Windows NT/CurrentVersion/NetworkCards/ 下，我可以枚举我机器上安装的每个网卡。但是，一些应用程序，尤其是虚拟机，会安装一些虚拟网卡。

我的问题是：如何以编程方式确定网卡是虚拟网卡？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T02:05:08.063

取决于虚拟机。如果它使用例如 QEMU 作为硬件仿真，将很难确定它不是“真实的东西”——充其量，你可能会注意到它比真实的东西要快，但你会很难要知道。

当然，虚拟机也可能安装了真实的网卡到虚拟机中。因此，即使您以某种方式知道您在虚拟机上运行，​​您也无法真正确定它是否是真实的。

如果它是“半虚拟”网络适配器，那么您可能会发现制造商是 Citrix、VMWare 或 Oracle 之类的东西。

我不完全确定有充分的理由知道差异......

# ocaml - 求二叉树高度的测试用例

> ID：14657808
> 
> 赞同：0
> 
> 时间：2013-02-02T01:51:14.770
> 
> 标签：ocaml

我编写了一个函数来查找二叉树的高度（即沿从根到叶的最长路径的节点数）。

```
let rec height (t: 'a tree) : int =
begin match t with
| Empty -> 0
| Node (l, v, r) -> 1 + max (height 1) (height r)
end 
```

我相信我的函数是正确的，但是当我运行我的测试时出现的语法错误说“这个函数应用于太多的参数；也许你忘记了一个 ';'。

这是我的测试用例

```
let test () : bool =
height Node(Node(Empty, 1, Empty), 3, Node(Empty, 2, Node(Empty, 4, Empty))) = 3
;; run_test "Node(Node(Empty, 1, Empty), 3, Node(Empty, 2, Node(Empty, 4, Empty)))" test 
```

我的测试用例有什么问题？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T02:29:54.283

考虑表达式

```
height Node (Empty, 0, Empty) 
```

在 OCaml 中，相邻的值表示函数应用，它是左关联的。所以这与以下内容相同：

```
(height Node) (Empty, 0, Empty) 
```

以下将起作用：

```
height (Node (Empty, 0, Empty)) 
```

换句话说，您只需要添加括号。

# haskell - Haskell 无法从上下文中推断出 (t ~ t1) (Frameworks t)

> ID：14657811
> 
> 赞同：3
> 
> 时间：2013-02-02T01:51:33.780
> 
> 标签：haskell, types, compiler-errors, frp, reactive-banana

我正在学习如何使用名为 Reactive Banana 的 Haskell FRP 库，这对 Haskell 来说也是相当新的。目前我正在创建一个将网络作为参数的函数，并在函数体中在编译网络并通过其事件循环之前进行一些初始化，但我遇到问题 Haskell 无法推断出我想要的内容做。

这是代码的简化版本

```
{-# LANGUAGE ScopedTypeVariables #-}

module Main where
import qualified Reactive.Banana as R
import qualified Reactive.Banana.Frameworks as RF

main = start setupNetwork

start :: forall t. RF.Frameworks t =>  R.Moment t () -> IO ()
start network = do
    net <- RF.compile $ network
    RF.actuate net

keyAddHandler = RF.newAddHandler

setupNetwork :: forall t. RF.Frameworks t => R.Moment t ()
setupNetwork = do
    (addKey, firekey) <- RF.liftIO keyAddHandler
    return () 
```

我得到的确切错误是这个。

```
Test.hs:11:25:
Could not deduce (t ~ t1)
from the context (RF.Frameworks t)
  bound by the type signature for
             start :: RF.Frameworks t => R.Moment t () -> IO ()
  at Test.hs:(10,1)-(12,18)
or from (RF.Frameworks t1)
  bound by a type expected by the context:
             RF.Frameworks t1 => R.Moment t1 ()
  at Test.hs:11:12-31
  `t' is a rigid type variable bound by
      the type signature for
        start :: RF.Frameworks t => R.Moment t () -> IO ()
      at Test.hs:10:1
  `t1' is a rigid type variable bound by
       a type expected by the context: RF.Frameworks t1 => R.Moment t1 ()
       at Test.hs:11:12
Expected type: R.Moment t1 ()
  Actual type: R.Moment t ()
In the second argument of `($)', namely `network'
In a stmt of a 'do' block: net <- RF.compile $ network 
```

搜索互联网使我相信 start 函数中的框架和 setupNetwork 函数中的框架之间的类型不被认为是同一类型。

反正有没有让类型匹配？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-02T08:26:06.310

自从我玩过响应式香蕉（或其他任何推动类型系统的东西）以来已经有一段时间了，但我认为类型签名应该更像

```
start :: (forall t. RF.Frameworks t =>  R.Moment t ()) -> IO () 
```

（即您需要在正确的位置添加括号。）

你`{-# LANGUAGE RankNTypes #-}`也需要。

# javascript - 向javascript添加超时延迟？

> ID：14657813
> 
> 赞同：1
> 
> 时间：2013-02-02T01:52:39.230
> 
> 标签：javascript

有人可以帮助我吗？我正在尝试让这个 javascript 在使用超时延迟 3 秒后启动它的功能。

我仍在学习 javascript 和 jquery，如果有人能告诉我我哪里出错以及如何解决它，我将不胜感激。

谢谢你。

```
<script type="text/javascript">
    setTimeout(function(){
window.onload = function showPopUp(el) {
var cvr = document.getElementById("cover")
var dlg = document.getElementById("dialog")
cvr.style.display = "block"
dlg.style.display = "block"
if (document.body.style.overflow = "hidden") {
    cvr.style.width = "1024"
    cvr.style.height = "100&#37;"
    }
}
},3000);

</script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T01:56:42.587

所以简而言之，你有这个：

```
setTimeout(function () {
    window.onload = function() {
        // do stuff...
    }
}, 3000); 
```

那是行不通的。这就是说，在 3 秒后，为窗口的`onload`事件分配一个处理程序。那时，事件已经（很可能）触发了。所以这个函数不会执行。

相反，翻转它。

```
window.onload = function() {
    setTimeout(function () {
        // do stuff...
    }, 3000);
} 
```

所以在这里，当窗口加载时，你会在 3 秒后做一些事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-02T01:56:25.200

这是错误的：

```
setTimeout(function () {
    window.onload = function showPopUp(el) { 
```

这会在 3 秒后分配一个`onload`处理程序，此时窗口可能已经加载。

* * *

删除`window.onload = function showPopUp(el) {...}`脚本加载后等待 3 秒的部分。

```
setTimeout(function () {
    var cvr = document.getElementById("cover")
    var dlg = document.getElementById("dialog")
    cvr.style.display = "block"
    dlg.style.display = "block"
    if (document.body.style.overflow = "hidden") {
        cvr.style.width = "1024"
        cvr.style.height = "100&#37;"
    }
}, 3000); 
```

* * *

或者在所有资源完成加载后反转`setTimeout`and`window.onload`等待 3 秒。

```
window.onload = function showPopUp(el) {
    setTimeout(function () {
       // ...
    }, 3000);
}; 
```

# php - “超级”动态访问 PHP 5.3 中的静态方法/属性？

> ID：14657818
> 
> 赞同：0
> 
> 时间：2013-02-02T01:54:29.830
> 
> 标签：php, syntax, static

有这两个类：

```
class run {
   public static $where = "there";
}

class there {
   public static $place_name = "A beautiful place..";
} 
```

要获得 place_name 我可以这样做：

```
$place = "there";
echo $place::$place_name; 
```

但我可能想在某个时候做这样的事情..：

```
echo {$run::$where}::$place_name; 
```

显然，最后一个片段不起作用。有没有办法让它发挥作用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-30T11:14:27.090

如果您不想使用变量（正如您在评论中所说），请三思而后行。变量在 PHP 中很酷，速度非常快，只是解决其有限的解析器所需的粘合剂（据说这使得 PHP 非常快）。那么为什么不在这里使用变量呢？它易于输入并快速完成。

如果你不想要这个变量并且我们已经发现 PHP 的语法是有限的，你至少可以用 PHP 5.4+ 编写一个单行来实现你正在寻找的东西：

```
echo (new ReflectionClass((new ReflectionClass($run))->getStaticPropertyValue('where')))->getStaticPropertyValue('place_name'); 
```

然后最终应该可以看出使用变量更舒服：

```
echo (unset) $place = $run::$where, $place::$place_name; 
```

演示：[http ://eval.in/13942](http://eval.in/13942)

# python - 如何在 Mac OS Mountain Lion 上使用 lua 和 python

> ID：14657821
> 
> 赞同：1
> 
> 时间：2013-02-02T01:55:30.963
> 
> 标签：python, lua, osx-mountain-lion

我一直在使用 Lupa 0.20 + LuaJIT 2.0.0 将 lua 嵌入到 W7 框中的 python 2.7 代码中。不幸的是，我无法让它在 Mountain Lion Mac OS 上运行。我能够编译 LuaJIT 和 Lupa，但是每当我尝试使用 lupa 时，都会收到如下错误：

```
lupa._lupa.LuaError: Failed to initialise Lua runtime
File "/Users/rafael/Projects/Lua/test.py", line 3, in <module>
lua = LuaRuntime()
File "/usr/local/lib/python2.7/site-packages/lupa/_lupa.so", line 116, in     lupa._lupa.LuaRuntime.__cinit__ (lupa/_lupa.c:2237) 
```

有什么技巧可以让它发挥作用吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-07T23:58:45.007

您不能将 lupa x86_64 与系统安装的 python 一起使用。luajit 64 位要求可执行文件（在本例中为 python）已与 -pagezero_size 10000 -image_base 100000000 链接。

系统安装的 python 没有以这种方式链接，所以你最好的办法是弄清楚如何在 osx 上构建一个 32 位 luajit（在那里帮不上忙），构建一个 32 位 lupa（ARCHFLAGS="-arch i386 " python setup.py build)，看看它是否适合你。

或者，构建一个使用这些链接器标志的 64 位 python。

编辑：实际上，lua51 作为 luajit 的替代品。将 lupa setup.py 指向 lua51 发行版和库并照常构建；为我工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-05T18:21:16.640

我使用 brew 安装的 Lua 5.1 让它在 Mavericks 上工作。也可能在 Mountain Lion 上为您工作。

如果你使用他们的 git repo 中的版本，那么`setup.py`它已经修复了，你可以下载它，解压缩它，然后运行以下命令安装 lupa：

`$ ARCHFLAGS="-arch x86_64" python setup.py install --no-luajit`

如果您更愿意使用已发布的 v0.20，只需将这两个文件保存在任何位置（但在同一目录中）并运行`make lupa clean`：

`lupa-5.1.diff`：

```
 --- /Users/flavio/working_copies/databuild/lupa-0.20/setup.py 
+++ (clipboard) 
@@ -77,6 +77,7 @@
 basedir = os.path.abspath(os.path.dirname(__file__))

 def find_luajit_build():
+    return dict(libraries=['lua'], include_dirs=['/usr/local/include'])
     os_path = os.path
     for filename in os.listdir(basedir):
         if filename.lower().startswith('luajit'): 
```

`Makefile`：

```
 clean:
    rm -rf lupa-0.20*

lupa:
    brew install lua
    wget https://pypi.python.org/packages/source/l/lupa/lupa-0.20.tar.gz
    tar zxf lupa-0.20.tar.gz
    patch -p1 < lupa5.1.diff
    cd lupa-0.20/ && python setup.py install --no-luajit

test:
    ipython -c "from lupa import LuaRuntime; lua = LuaRuntime()" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-06-25T16:30:53.390

这非常接近为我工作，但有点不足。最近发布了一个新版本的 lupa，所以可能发生了一些变化。对我来说，上述方法几乎奏效了，但我遇到了 lua 运行时中未定义符号的问题。

我让 Lupa 在 Mavericks 工作，做了以下工作：

*   在 Homebrew 上安装 Lua：http: [//brew.sh/](http://brew.sh/)。
*   安装 cython：对我来说，我只是使用了 easy_install cython，因为我很懒，并且不打算将 cython 用于除此之外的任何其他工作。我想你也可以为此使用自制软件。
*   下载/安装 lupa：然后，按照上面的说明进行操作，*除了*，您还需要返回 None 作为第二个参数。例如

    def find_lua_build(no_luajit=False): # 尝试查找本地 LuaJIT2 构建 os_path = os.path +return dict(libraries=['lua'], include_dirs=['/usr/local/include']), **None**

*   最后，安装 python 模块，并明确指示使用 cython 编译： sudo python setup.py install --with-cython

如果这不起作用，我会尝试在自制软件中使用不同版本的 lua。如果您想知道为什么上面的 setup.py 指向`/usr/local/include`的是 homebrew 将其符号链接到活动“brew”的地方。

# jquery - 在jquery中通过href获取元素不起作用？

> ID：14657827
> 
> 赞同：1
> 
> 时间：2013-02-02T01:57:20.620
> 
> 标签：jquery, href

我想通过单击显示将类（d_select）添加到href为“#tut”的标签。

但是当我点击时，什么也没有发生。这是我的代码：

```
 <a class="show"><span>Show!</span></a>       

            <ul class="tab_cm">
                <li><a href="#details">Details</a></li>
                <li><a href="#feed">Feedback</a></li>
                <li><a href="#tut">Tutorial</a></li>
                <li><a href="#map">Map</a></li>
            </ul>

<script>
$(function(){
    $(".show").click(function(event){
    event.preventDefault();
    $("ul.tab_cm").find('a[href="#tut"]').addClass("d_select");
    });
});
</script> 
```

***我英语不好，很抱歉！***

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T02:05:14.220

尝试`$("ul.tab_cm").find('a[href="\\#tut"]').addClass("d_select");`

`\\`当用作选择器的一部分时，将转义具有特殊 CSS 含义的字符......尽管 JQuery 似乎足够聪明，知道`#`属性引用中的无论如何都是文字，所以这不应该是必需的。

# sql - Adventure Works 数据库查询产生空输出

> ID：14657830
> 
> 赞同：0
> 
> 时间：2013-02-02T01:57:49.883
> 
> 标签：sql, sql-server, database

我正在使用来自冒险工作的下表来编写查询：

![在此处输入图像描述](../Images/39918303f7e888e9aa16087a56af90ae.png)

FactInternetSales 表具有 FK OrderDateKey、DueDateKey 和 ShipDateKey 与 DimDate 表中的 DateKey 关联。

我写了以下查询来测试：

```
SELECT dd.DateKey, dd.EnglishMonthName, fis.TotalProductCost
FROM DimDate AS dd INNER JOIN FactInternetSales AS fis 
ON dd.DateKey = fis.OrderDateKey AND dd.DateKey = fis.DueDateKey
AND dd.DateKey = fis.ShipDateKey 
```

上面的查询产生空输出。我检查了 FactInternetSales 表中的数据，它具有与 DimDate 表中的 PK 相关联的 FK。这个问题的可能原因是什么？

请指教？提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-02T02:03:55.740

虽然如果没有 Adventure Works 数据库（而且我看不到您所附的图片），这非常难以理解，但我的猜测是 FactInternetSales 应该只在单个字段上加入 DimDate。目前，您编写查询的方式是加入 DimDate.DateKey = FactInternetSales.OrderDateKey = FactInternetSales.DueDateKey = FactInternetSales.ShipDateKey

除非 FactInternetSales 中的这 3 个字段相同，否则这永远不会产生结果。

而是尝试类似：

```
SELECT dd.DateKey, dd.EnglishMonthName, fis.TotalProductCost
FROM DimDate AS dd INNER JOIN FactInternetSales AS fis 
ON dd.DateKey = fis.OrderDateKey 
```

祝你好运。

# google-chrome-extension - Chrome 扩展：chrome.storage 未定义

> ID：14657833
> 
> 赞同：6
> 
> 时间：2013-02-02T01:58:01.997
> 
> 标签：google-chrome-extension

我将以下代码添加到我原本可以正常工作的 Google Chrome 扩展程序中……</p>

```
var storage = chrome.storage ;
console.log("storage is " + storage) ;
var bookmarks = chrome.bookmarks ;
console.log("bookmarks is " + bookmarks) ; 
```

运行时，控制台说

```
storage is undefined
bookmarks is [object Object] 
```

换句话说，*书签*工作正常，但*存储*在行动中丢失。我的清单已经要求...

```
{
   ...
   "permissions": [ "bookmarks", "tabs", "storage" ],
} 
```

万一这很重要，这个扩展作为外部扩展安装在 Mac OS X 上。为了确保它被正确更新，我从安装到 ~/Library/Application Support/Google/Chrome/Default/Extensions 的文件中复制了上面的代码. 当然，我已经重新启动了 Chrome。

为什么 chrome.storage 可能未定义？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-06T21:24:20.400

编辑：下面的答案写于 2013 年。现在是 2021 年，正如 Irfan 在评论中所写：

> chrome.storage 也可以从内容脚本中获得。您的扩展程序的内容脚本可以直接访问用户数据，而无需后台页面。[https://developer.chrome.com/docs/extensions/reference/storage/](https://developer.chrome.com/docs/extensions/reference/storage/)

原答案：

LocalStorage 仅在后台页面和弹出窗口中可用。如果您需要访问某些数据，则需要将消息从当前页面传递到后台页面。这是代码：

在您当前的页面中：

```
chrome.extension.sendMessage({action:"getstorage"}, function(response){
   console.log("storage is " + response.myVar);  
}); 
```

在后台页面中：

```
chrome.extension.onMessage.addListener(function(request, sender, sendResponse) {
  if (request.action == "focusWindow"){
    sendResponse({myVar: localStorage.myStorage});
  }
}); 
```

[您可以在有关消息传递](http://developer.chrome.com/extensions/messaging.html)的 chrome 文档中找到更多示例

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-11-18T23:33:37.073

“扩展”选项卡上的扩展内有“重新加载（Ctrl + R）”链接，单击它可以解决问题（我花了几个小时）。禁用/启用扩展也不会重新启动 Chrome 浏览器来解决问题。我希望它能节省别人的时间；）

# iphone - 应用程序未运行时推送通知数据？

> ID：14657848
> 
> 赞同：1
> 
> 时间：2013-02-02T02:01:12.033
> 
> 标签：iphone, ios, push-notification, apple-push-notifications

当应用程序未运行并且用户收到 5 个推送通知时，这些推送通知是否保存在某处？还是数据消失了？当应用程序下次运行时，我需要访问所有 5 个推送通知。

澄清一下，我已经了解您可以访问导致应用程序运行的推送通知。我要问的是自从应用程序终止后获取所有推送通知。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T02:16:19.257

APNS 服务将只保留最近推送到设备的消息 - 假设仍然安装了至少一个其他应用程序并且用户允许推送通知，那么这个存储的消息将在用户下次有互联网时传递联系。

有关 Apple 为 APNS 服务实施的服务质量的更好信息，请在此处查看我的其他答案：

[关于 Apple APNS 的说明](https://stackoverflow.com/questions/12104935/clarification-on-apple-apns/12213704#12213704)

# javascript - 我可以在单页应用程序中使用浏览器 Navigation Timing API 处理 Ajax 事件吗？如果不是，有什么好工具？

> ID：14657849
> 
> 赞同：17
> 
> 时间：2013-02-02T02:01:17.400
> 
> 标签：javascript, ajax, profiling, single-page-application, navigation-timing-api

我们有一个使用 Knockout 和 Backbone 构建的单页应用程序，它可以对服务器进行 Ajax 调用，并进行一些复杂的数据缓存和 DOM 渲染。我们真的很想测量用户看到的性能（并将其记录回服务器）。我似乎无法理解浏览器[导航计时 API](http://www.w3.org/TR/navigation-timing/)是否对此有用。从我在示例中看到的情况来看，Navigation Timing API 被绑定到`window.performance`并且这仅限于页面加载并且不适合监控 Ajax 行为。对或错？如果是假的，我还能用什么？

我很想设置自定义检测点，在它们之间测量时间，例如，对于使用服务器结果进行一些 DOM 渲染的 Ajax 调用。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-04-29T23:11:06.287

1 - 是的，window.performance 与页面加载相关。请参阅下面的示例，该示例显示了这一点：

```
 <button id='searchButton'>Look up Cities</button>
    <br>
    Timing info is same? <span id='results'></span>
    <script type="text/javascript" src="//code.jquery.com/jquery-1.9.1.min.js"></script>
    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/underscore.js/1.4.4/underscore-min.js"></script>
    <script type="text/javascript">
        jQuery('#searchButton').on('click', function(e){
            // deep copy the timing info
            var perf1 = jQuery.extend(true, {}, performance.timing);             
            // do something async
            jQuery.getJSON('http://ws.geonames.org/searchJSON?featureClass=P&style=full&maxRows=10&name_startsWith=Denv', function() {
                // get another copy of timing info
                var perf2 = jQuery.extend(true, {}, performance.timing);
                // show if timing information has changed
                jQuery('#results').text( _.isEqual( perf1, perf2 ) );
            });
            return false;
        });
    </script> 
```

此外，即使你确实让它工作了，你也会从不支持这个对象的旧浏览器中丢失数据。

2 - [Boomerang 项目](https://github.com/lognormal/boomerang/)似乎超越了 Web 计时 API，还支持旧版浏览器。[本次会议](http://html5devconf.com/sessions.html)中列出的当前维护者有幻灯片和示例代码的演讲。抱歉没有直接链接。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2014-02-18T16:49:38.923

您现在可以使用[用户计时 API](http://www.w3.org/TR/user-timing/)（W3C 建议 2013 年 12 月 12 日），它提供了一种方法，您可以在 Javascript 的不同部分插入 API 调用，然后提取详细的计时数据。

您使用 来执行此操作`mark()`，它可以让您计算出在您的 Web 应用程序中达到该“标记”所花费的时间，然后`measure()`计算您的标记之间经过的时间。

对于您的具体情况，您可以使用以下内容：

```
app.render = function(content){
  myEl.innerHTML = content;
  window.performance.mark('end_render');
  window.performance.measure('measure_render', 'start_xhr', 'end_render');
};

var req = new XMLHttpRequest();
req.open('GET', url, true);
req.onload = function(e) {
  window.performance.mark('end_xhr');
  window.performance.measure('measure_xhr', 'start_xhr', 'end_xhr');
  app.render(e.responseText);
}
window.performance.mark('start_xhr');
myReq.send(); 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-07-23T11:16:40.517

似乎对 的支持不`window.performance.getEntries()`完整，它将为您提供加载到页面中的所有资源及其 URL 的详细信息。我将此 API 用于[AzurePing.info](http://azureping.info/)中支持它的浏览器的 jsonp（不是 XMLHttpRequest）请求，而`new Date().getTime()`对于那些不支持它的浏览器则回退到。

在撰写本文时，IE 10 和 Chrome 支持`getEntries`，但 Firefox 不支持。不幸的是，并不是所有的时间属性都设置好了——即使在 Chrome 和 IE 中也是如此。我只能依靠一个`fetchStart`,`responseEnd`和`duration`.

示例源在[GitHub 上](https://github.com/nzbart/AzureSitePing/blob/gh-pages/Script/Site.ts)。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2014-04-16T14:33:19.837

在我看来，Navigation Timing API 在测量单页应用程序性能时并没有真正的帮助。

除了已经提到的 User Timing API，[Resource Timing API](http://www.w3.org/TR/2014/CR-resource-timing-20140325/)实际上更有帮助。此 API 提供了检索用户会话中发出的所有请求的时间的功能（实际上，您在大多数浏览器中的开发人员工具的网络选项卡中看到的所有请求）。这些时间包括往返时间以及 DNS 查找时间等。

不幸的是，这是一个相对较新的规范，尚未在所有浏览器中实现。Chrome 和 IE > 10 提供了实现（尽管尚未完成）。出人意料的是，IE现在似乎已经实现了最单元...

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-02-14T06:49:55.190

有两种方法可以做到

1.  [资源计时 API](https://www.w3.org/TR/2014/CR-resource-timing-20140325/)
2.  包装 XMLHTTPRequest

让我们看看它们之间的区别。

### 1.资源计时API

浏览器最近添加了对[Resource Timing API的支持。](https://www.w3.org/TR/2014/CR-resource-timing-20140325/)Resource Timing API 基本上有关于从应用程序加载的每个资源的时间信息。它可能是 css、javascript 或 AJAX 请求。您可以获得资源详细信息列表

```
 performance.getEntriesByType('resource'); 
```

它将返回对象数组，您可以在其中找到`initiatorType`等于 的AJAX 请求`xmlhttprequest`。但是有一些限制。

1.  默认情况下，最大资源大小为 150。上述数组最多只有 150 个资源。如果需要更多，可以将缓冲区大小增加为`performance.setResourceTimingBufferSize(500)`.
2.  您不会获得有关 AJAX 请求是成功还是失败的信息。

### 2\. 包装 XMLHTTPRequest

如果您可以包装您的 XMLHTTPRequest API，您将从时间、状态代码和字节大小中获得您需要的所有信息。但是您必须编写大量代码，当然还要进行测试、测试和测试。

**[免责声明]**我在[atatus.com](https://www.atatus.com/)工作，我们帮助您测量页面加载时间、AJAX 时间和自定义事务。您还可以查看有关每个资源如何执行的会话跟踪。

# php - 解析 .php 并作为变量返回

> ID：14657856
> 
> 赞同：1
> 
> 时间：2013-02-02T02:02:12.483
> 
> 标签：php

所以说我有一个文件 page.php

```
<html>
Hello <?php echo $world;?>
</html> 
```

我想创建一个变量并使用 page.html 为其分配“Hello world”

就像是

```
$world = 'world';
$mypage = parse_file('page.php'); 
```

我想我可以将整个文件用双引号括起来

```
$mypage="<html>
Hello $world
</html>"; 
```

但是双引号解析效率低下。无需编写解析 page.html 的脚本就可以轻松做到这一点吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-02T02:05:18.887

[输出缓冲](http://php.net/manual/en/book.outcontrol.php)会很好地做到这一点

```
ob_start();
$world = 'world';
include('page.php');
$mypage = ob_get_clean(); 
```

参考：

*   [`ob_start()`](http://php.net/manual/en/function.ob-start.php)
*   [`ob_get_clean()`](http://www.php.net/manual/en/function.ob-get-clean.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T02:09:02.727

另一种方法是使用[heredoc 语法](http://www.php.net/manual/de/language.types.string.php#language.types.string.syntax.heredoc)

# icalendar - Android CalendarContract.Events.UID_2445 未填充

> ID：14657859
> 
> 赞同：4
> 
> 时间：2013-02-02T02:02:24.993
> 
> 标签：icalendar, android-calendar, uid

我正在开发一个读取给定日历事件的应用程序。

```
 public static final String[] EVENT_PROJECTION = new String[] { 
    Events._ID, // 0
    Events.UID_2445, //1
    Events.DTSTART, // 2
    Events.DTEND }; // 3

    // The indices for the projection array above.
    private static final int PROJECTION_ID_INDEX = 0;
    private static final int PROJECTION_UID_INDEX = 1;
    ...

    ContentResolver contentResolver = ctx.getContentResolver();

    Uri uri = Events.CONTENT_URI;

    Cursor cur = contentResolver.query(uri,
            EVENT_PROJECTION, Events.CALENDAR_ID + " = ?",
            new String[] { String.valueOf(calendarId) }, null); 
```

日历与谷歌日历或 Exchange Server 邮箱同步。我可以使用上面的代码获取事件，但我注意到 Events.UID_2445 属性从未填充。

```
 String uid = cur.getString(PROJECTION_UID_INDEX)); //this line always returns null 
```

使用谷歌日历数据 API 和交换网络服务，我已经确认它填充了 ICAL UID 属性。看起来日历同步不会将该属性存储在 Event 对象中。有没有其他人有同样的问题，或者你发现我使用的代码有什么问题？谢谢

# php - PDO 准备好的语句不会执行

> ID：14657860
> 
> 赞同：0
> 
> 时间：2013-02-02T02:02:28.533
> 
> 标签：php, mysql, pdo

好吧，我很沮丧，我不知道这个问题是什么。我觉得自己是一个糟糕的程序员。我正在尝试更新我的数据库，并且我知道我要更新的表存在。从字面上看，我知道这个查询是准确的，但我不知道为什么它不起作用。第一个 mysql 语句执行但第二个不执行。这是我的代码。

```
$Statement = $Database->prepare("INSERT INTO table1 (tbl2id, col, col2) VALUES (?, ?, ?); UPDATE table2 SET this = ? WHERE id = ?");
$Statement->execute(array($table2id, $col, $col2, 1, $table2id)); 
```

因此，我正在尝试设置数据库，以便它们具有某种连接性。顺便说一句，我编造了所有的列名。我不知道它是否有助于安全，但我不喜欢在公共场合发布这些东西。无论如何，“this”列默认为 0，如果设为 1，则表示用户已响应。所以 'this' 被设置为 tinyint，默认值为 0。

我不是想问一个愚蠢的问题或任何东西，我不想承认，但我真的想不通。也许有一些关于 PDO 语句的东西我不知道。我还尝试运行两个单独的执行，它仍然不会这样做。而且我知道有人会说我没有更新正确的表格或其他东西。但我发誓这是正确的，我已经检查了至少 10 次。

太感谢了。我喜欢自己解决问题，但我不能再浪费时间在这上面了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T05:36:23.677

好吧，有一件事真正属于您的编程技能。
程序员必须首先**查找错误消息**。
程序员不能只是坐着看代码，而必须**询问他们的程序发生了什么**。
因此，它必须是您最关心的问题 - “我怎样才能收到错误消息？”。
看，本质上是不同的：不是“我的代码有什么问题？” 但是“如何出错？”。

您确定`ERRMODE_EXCEPTION`已设置并且您可以看到发生的所有错误吗？你没有一个带有空 catch() 的愚蠢异常处理程序吗？您是否启用了 display_errors（或者您是否检查过日志）？
你能看到一个故意的错误吗——像“blah foobar nonsense”这样的查询会引发一个错误吗？

如果没有 - 处理错误报告问题。
如果是这样 - 那么，是时候检查您的一些程序流程逻辑和愚蠢的拼写错误（例如在检查另一个数据库时插入一个数据库等）。

是的，准备/执行不支持多个查询，您必须在单独的调用中进行

# ms-office - 没有 SharePoint 的 Office Web Apps Server 2013

> ID：14657861
> 
> 赞同：5
> 
> 时间：2013-02-02T02:02:57.277
> 
> 标签：ms-office

我注意到微软已经发布了一个新版本的 Office Web Apps Server 2013，它现在是一个独立的产品。

我正在寻找一个引擎，我可以将 Word/Excel 和 PowerPoint 文档转换为网络友好版本 (HTML5)，用于我构建的将这些文档上传到 S3 的应用程序，我认为 Office Web Apps Server 2013 独立版可以工作。

我不想使用 Google Docs，而是使用我自己托管的解决方案。

阅读 Office Web Apps Server 文档，它没有指定我是否需要拥有 SharePoint 服务器许可证。我尝试在 Microsoft Azure 上的 Windows 2012 服务器上部署 Office Web Apps Server，并且在安装软件时，它无法呈现我从外部 URL（可公开访问的 S3 存储桶）指向它的任何文档。

有谁知道 Office Web Apps Server 2013 正常工作的特殊要求？该网站确实声明它可用于从外部 URL 查看文档，这就是我尝试使用它的方式。但由于它是一个新产品，除了微软的部署说明之外，我找不到太多关于它的信息。

# eclipse - Eclipse 中有没有办法按作者/用户名跟踪最近的 SVN 和 CVS 提交？

> ID：14657862
> 
> 赞同：0
> 
> 时间：2013-02-02T02:03:03.777
> 
> 标签：eclipse, svn, eclipse-plugin, cvs, commit

由于源代码的分支，我面临着一个非常不同的问题。我有 2 个分支 trunk 和 QA ，因为源代码非常庞大，我很难记住所有要签入的文件。我开始监视我的 svn 提交邮件，但这不是一个非常简单的解决方案。所以我想在这里问这个问题。是否有 Eclipse 插件/工具来跟踪 SVN 和 CVS 最近的修改/提交？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T16:27:20.270

## 更新 2：按作者/用户名搜索 Subversion 提交历史

看起来历史视图中内置了一个搜索历史对话框，允许按用户名进行搜索。

![在此处输入图像描述](../Images/583919bd11aa66c7412b1c8ae8013640.png)

## 更新 1：按作者/用户名提交的命令行

要查看特定用户的最近提交，命令行 log 命令会这样做吗？

`svn log http://server/svn/foo -r 400:head | grep vince`

r400 | 文斯·伊根 | 2012-12-03 09:02:50 -0800（2012 年 12 月 3 日星期一）| 1 行

r422 | 文斯·伊根 | 2012-12-03 15:37:20 -0800（2012 年 12 月 3 日星期一）| 1 行

r424 | 文斯·伊根 | 2012-12-03 15:44:07 -0800（2012 年 12 月 3 日星期一）| 1 行

## 原始答案

你有[安装subclipse](http://subclipse.tigris.org/servlets/ProjectProcess?pageID=p4wYuA)吗？

如果您右键单击项目或文件夹，您可以使用它`Team > Show History`来查看提交列表。

从那里您可以右键单击并选择`Compare`查看每个文件的结构比较。双击那些等等等等

![在此处输入图像描述](../Images/a872011c14ab2d104d29683c60c42b48.png)

如果您更喜欢文件资源管理器式浏览，还有一个`[CVS|SVN] Repository Exploring`可用的透视图。`Window > Open Perspective > Other`

# vim - 控制台编辑器：介于 VIM 和 nano 之间？

> ID：14657863
> 
> 赞同：18
> 
> 时间：2013-02-02T02:03:06.123
> 
> 标签：vim, editor, nano

我用`vim`了很长时间，但去年我的大部分编程工作都转向了 Sublime Text。

现在，每次我必须使用控制台编辑器（`ssh`大部分*是*在`vim`. 快捷键和命令慢慢地离开了我的记忆，我曾经精心策划`vimrc`的东西已经尘埃落定，如果不重新学习所有内容，我就无法有效地使用编辑器。

另一方面，`nano`只是愚蠢。非常适合打开文件，添加标志并关闭它，但对于其他任何事情来说都太原始了。

有什么我可以使用的吗？我可以接受不像 vim 那样简单，也不像 vim 那样强大。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-02-02T02:25:50.140

您可以使用`mcedit`. 它比其他编辑器更加用户友好——它甚至支持鼠标悬停在 ssh 上（甚至在 Windows 的 Putty 控制台中）。

只需按如下方式安装包 Midnight Commander：

*   Ubuntu/Debian：

    ```
    sudo apt-get install mc 
    ```

*   费多拉/红帽：

    ```
    sudo yum install mc 
    ```

*   苹果系统：

    ```
    brew install mc 
    ```

它会`mcedit`提供。

在本地控制台中，它甚至支持我们在 Windows`Shift+Del`中使用`Shift+Ins`的`Ctrl+Ins`快捷方式。

它还具有将块复制到任意文件中的出色能力，有效地为您提供无限数量的剪贴板。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-02T07:36:15.293

你可以试试这些，但你必须将它们安装在你通过 SSH 连接的机器上：

*   [乔](http://joe-editor.sourceforge.net/)
*   [氖](http://ne.dsi.unimi.it/)
*   [迪亚科诺斯](http://diakonos.pist0s.ca/)

但我的意见是，你应该放弃功能严重不足的 Sublime，回到 Vim。

`$ vimtutor`是你的朋友。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-02T02:26:42.887

如果您想学习几乎可以通过 SSH 连接到的每台机器上都可以使用的文本编辑器，那么基本上您唯一的选择就是 vim、emacs、nano 和 ed。

Emacs 是一个不错的选择，只要您能记住`c-x c-s`(save) 和(close)... 但这仅比使用 vim*需要*`c-x c-c`记住的命令少两个（用于插入模式、普通模式、保存和退出）。*`i``<esc>``:w``:q`*

 *可能更好的选择是在本地运行 X11，这样您就可以使用`gedit`、`gvim`或远程计算机上的其他图形编辑器之一？或者可以打印几张备忘单（请参阅：[https](https://stackoverflow.com/questions/442057/what-is-your-linux-vim-cheat-sheet) ://stackoverflow.com/questions/442057/what-is-your-linux-vim-cheat-sheet ）并始终随身携带？

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-02-02T13:46:31.213

我没有亲自使用过它，但是 Vim 的[Cream 风格](http://cream.sourceforge.net/)通过更多标准样式的映射（例如 CTRL-F 用于查找）修改了 Vim，没有像 Vi(m) 中那样的模态编辑（正常与插入模式），而且它也适用于控制台（带有菜单）。也许这让 Vim 适合你。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-03-17T12:15:24.767

由于您是 Sublime 用户，因此您可能会对 Suplemon [https://github.com/richrd/suplemon](https://github.com/richrd/suplemon)感到满意。

它有点像 Sublime，它是专门为同时简单和强大而创建的。它还具有多个光标和与 Sublime 类似的键映射。它是用 Python 编写的，支持插件模块。希望有一天它也能支持 Sublime 软件包。

免责声明：我是 Suplemon 的开发者。*

# c++ - 如何截取视图并将图片插入 MS-Word 文档

> ID：14657865
> 
> 赞同：1
> 
> 时间：2013-02-02T02:03:15.350
> 
> 标签：c++, view, mfc, ms-word

我正在使用`MFC`under `vs2010`，我想将`the view`显示另存为`a picture`，然后`the picture`插入`a document in MS-WORD format`. 但很少`APIs`或`Documents`我能找到。你有什么建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T02:15:22.870

大致沿着这条线：

```
// Pick your own size of rectangle.
    CRect rect;
    GetWindowRect(&rect);    

    CDC memDC;
    memDC.CreateCompatibleDC(NULL);

    BITMAPINFO info;
    memset(&info, 0, sizeof(info));

// About the only parts of this you're likely to change 
// are the width and height.  You can change to fewer bits
// per pixel if you want -- doing so reduces file sizes,
// but increases headaches.  In a BMP file, each scan line 
// has to be DWORD aligned.  If you use 32 bit per pixel, 
// each pixel is a DWORD, so the alignment happens
// automatically.  Otherwise, you have to add padding as
// as needed, which is kind of a pain.
//
    info.bmiHeader.biSize = sizeof(info.bmiHeader);
    info.bmiHeader.biPlanes = 1;
    info.bmiHeader.biBitCount = 16;
    info.bmiHeader.biCompression = BI_RGB;
    info.bmiHeader.biWidth = rect.Width();
    info.bmiHeader.biHeight = rect.Height();
    char *bits = NULL;

    HBITMAP section = CreateDIBSection(
        pDC->m_hDC,
        &info, 
        DIB_RGB_COLORS,
        (void **)&bits,
        NULL, 0);

    memDC.SelectObject(section);

// Draw something into the DIB.
    CBrush brush;
    brush.CreateSolidBrush(RGB(0, 0, 255));

    CRect temp(0,0,rect.Width(), rect.Height());

    memDC.FillRect(temp, &brush);
    memDC.SetBkMode(TRANSPARENT);
    memDC.SetTextColor(RGB(255, 0, 0));

// Copy the DIB to the screen, just because we can...
    pDC->BitBlt(0, 0, rect.Width(), rect.Height(), &memDC, 0, 0, SRCCOPY);

// Ensure the GDI is done with anything it's doing
// with the DIB before we access the bits directly.
    GdiFlush();

    // Done drawing. Now save it:
    FILE *file = _wfopen(L"junk.bmp",L"wb");

    if ( NULL == file) 
        memDC.TextOut(0, 0, "File didn't open");
    else 
        memDC.TextOut(0, 0, "File opened");

// Get the size of the DIB, even though in this case
// we know it already because we just created it above.
    BITMAP object;
    GetObject(section, sizeof(object), &object);

    DWORD bit_size = object.bmWidthBytes * object.bmHeight;

    DWORD header_size = sizeof(BITMAPFILEHEADER) + sizeof(BITMAPINFOHEADER); 

// A BMP file header.  Pretty basic, really.
    BITMAPFILEHEADER header;
    memset(&header, 0, sizeof(header));
    header.bfType = 'MB';
    header.bfSize = bit_size + header_size;
    header.bfOffBits = header_size;

// Write out the file header.
    fwrite(&header, 1, sizeof(header), file);

// Write out the image header.
    fwrite(&info, 1, sizeof(info), file);

// write out the bits.
    fwrite(bits, 1, bit_size, file);

// and we're done.
    fclose(file); 
```

# javascript - 在网站中禁用右键单击

> ID：14657866
> 
> 赞同：0
> 
> 时间：2013-02-02T02:03:16.573
> 
> 标签：javascript, right-click, disabled-control

我在下面有这段代码来禁用右键单击。当你点击右键时，它说功能被禁用。哪个有效，但我希望它在你点击右键时根本什么都没有显示……我们可以用什么样的魔法来做到这一点？

```
var message="Function Disabled!"; function clickIE4(){ 
if (event.button==2){ alert(message); return false; } } 
function clickNS4(e){ 
if (document.layers||document.getElementById&&!document.all){ 
if (e.which==2||e.which==3){ alert(message); return false; } } } 
if (document.layers){ document.captureEvents(Event.MOUSEDOWN); document.onmousedown=clickNS4; } 
else if (document.all&&!document.getElementById){ document.onmousedown=clickIE4; } document.oncontextmenu=new Function("alert(message);return false") 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T02:06:33.520

只需删除警报：

```
if (event.button==2){ return false; } } 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2014-07-09T20:48:28.533

```
## How To Disable Right Click with Out Display any thing or Var Massage  ##
<script language=JavaScript>
<!--
var message="";
function clickIE4()
function clickNS4(e){
if (document.layers||document.getElementById&&!document.all){
if (e.which==2||e.which==3){
alert(message);
return false;
}
}
}

if (document.layers){
document.captureEvents(Event.MOUSEDOWN);
document.onmousedown=clickNS4;
}
else if (document.all&&!document.getElementById){
document.onmousedown=clickIE4;
}

document.oncontextmenu=new Function("alert(message);return false")

// --> 
</script> 
```

# c# - 过滤集合的子对象

> ID：14657873
> 
> 赞同：0
> 
> 时间：2013-02-02T02:04:30.183
> 
> 标签：c#, asp.net-mvc, linq, entity-framework, code-first

首先，我首先是 EF 代码和 .NET 的新手。

我正在开发一个使用 MVC4、EF、JQuery、AutoMapper 和其他技术和库构建的移动 Web 应用程序。

这可能会令人困惑，但我会尽力正确解释。

我有以下pocos：

```
 public class Test
{
    [Key]
    public int TestId { get; set; }
    .
    .
    Other properties
    .
    .
    public virtual ICollection<Question> Questions { get; set; }
    public virtual ICollection<UserStatus> UserStatuses { get; set; }
}

public class UserStatus
{
    [Key]
    public int UserStatusId { get; set; }
    public int TestId { get; set; }
    public string Customer { get; set; }
    .
    .
    Other properties
    .
    .
}

public class Question
{
    [Key]
    public int QuestionId { get; set; }
    public int TestId { get; set; }
    .
    .
    Other properties
    .
    .
} 
```

在我的上下文课程中，我有：

```
protected override void OnModelCreating(DbModelBuilder modelBuilder)
{
    Database.SetInitializer<CmeContext>(null);

    modelBuilder.Entity<Test>()
        .HasKey(a => new { a.TestId })
        .HasMany(s => s.Questions);
    modelBuilder.Entity<Test>()
        .HasKey(a => new { a.TestId })
        .HasMany(s => s.UserStatuses);          
} 
```

上面的Test对象通过TestId与Question和UserStatus对象是一对多的关系。每个测试都有自己的一组问题，每个测试 4 个问题，每个问题 20 个 userStatuses 5 个）。顾名思义，UserStatus 表有用户状态；它让我知道用户回答了什么测试中的哪些问题。

控制器中的代码：

```
var filtered = (from test in _ctxCmeContext.Test.Include("UserStatus").Include("Question")
                where test.Program == "SomeProgram" && test.IssueDate.Value.Year == year && test.IssueDate.Value.Month == monthNumber 
                orderby test.IssueDate descending 
                select new { test,
                                                 Questions = test.Questions, 
                         UserStatuses =     test.UserStatuses.Where(x => x.Customer == currentUserId) }); 
```

如您所见，我有一个匿名类，因此我可以获取由 currentUserId 过滤的 UserStatuses 集合，以仅获取当前用户的状态。此时一切正常。

这是我需要做的：

每个问题都需要知道自己的状态，所以它是 Question 和 UserStatus 表之间的一对一关系

在我的上下文类中，我添加了以下内容：

```
 modelBuilder.Entity<Question>()
     .HasRequired(x => x.UStatus)
     .WithOptional(); 
```

在我的问题对象中：

```
 public virtual UserStatus UStatus { get; set; } 
```

我还修改了我的 linq 语句如下：

```
 var filtered = (from test in         _ctxCmeContext.Test.Include("UserStatus").Include("Question").Include("UStatus")
                where test.Program == "SomeProgram" &&   test.IssueDate.Value.Year == year && test.IssueDate.Value.Month == monthNumber 
                orderby test.IssueDate descending 
                select new { test, 
                             QuestionStatus =    test.Questions.Select(u=>u.UStatus), 
                             Questions = test.Questions, 
                             UserStatuses = test.UserStatuses.Where(x => x.Customer == currentUserId) }); 
```

结果：

UStatus 属性包含每个问题的数据，但不是针对当前用户，也不是针对正确的测试；在我看来，它只是从 Question 表中抓取了它遇到的第一个具有相同 QuestionId 的记录。不好。

所以我将关系更改为一对多：

在我的上下文类中，我替换了：

```
 modelBuilder.Entity<Question>()
       .HasRequired(x => x.UStatus)
       .WithOptional(); 
```

和：

```
 modelBuilder.Entity<Question>()
           .HasKey(a => new { a.QuestionId })
           .HasMany(s => s.UStatus); 
```

将问题对象中的 UStatus 属性更改为：

```
 public virtual ICollection<UserStatus> UStatus { get; set; } 
```

并从 linq 语句中删除了以下内容

```
 QuestionStatus = test.Questions.Select(u=>u.UStatus), 
```

这次我能够得到一些正确的数据，但只有前 4 个问题，其余的都是空的

我不知道该怎么办了。请帮帮我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T19:01:44.667

在 Question 对象中，我创建了一个返回到 Test 对象的导航属性，并且从那里我能够知道每个问题的状态，因为 UserStatus 是 Test 对象中的子集合。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T08:26:01.450

使用您提供的 Schema/POCO 并分析您的故事，我可以总结如下：

```
You want to identify, which question(s) from what test was answered by a user? 
```

如果这是您的意思，那么假设`lazy loading`是这样，`enabled in your context`我可以建议类似以下的查询：

```
var questions = context.Questions.Where( q => q.Test.Program == "someProgram" 
                && q.Test.UserStatus.Any( us => us.UserId == currentUserId )); 
```

它执行以下操作：

1.  过滤属于测试的问题`someProgram`
2.  并拥有`UserStatus`用户的`currentUserId`
3.  获取满足此条件的问题。

因此，在`questions`集合中，您可以找到问题的答案。

我对您的问题的理解可能是错误的，但我相信它为您提供了一些提示。

# entity-framework - 按通用存储库中的多个字段排序

> ID：14657875
> 
> 赞同：0
> 
> 时间：2013-02-02T02:04:50.183
> 
> 标签：entity-framework, linq-to-entities

我的通用存储库中有以下方法，可以按字段名称排序。我需要知道如何才能通过多个字段订购它。

```
public IList<TEntity> FindByExpressionOrdered(Expression<Func<TEntity, bool>> filter,
                                                params Expression<Func<TEntity, object>>[] orderBy)
{
    IOrderedQueryable<TEntity> query = SessionScope.Current.Set<TEntity>().Where(filter).OrderBy(orderBy.First());
    if (orderBy.Length > 1)
    {
        for (int i = 1; i < orderBy.Length; i++)
        {
            query = query.ThenBy(orderBy[i]);
        }
    }
    return query.ToList();
} 
```

如下调用上述代码会导致“无法将类型 'System.Int64' 转换为类型 'System.Object'。LINQ to Entities 仅支持转换实体数据模型原始类型。” 例外。

```
IList<Product> prods = IoC.Resolve<IRepository<Product>>().FindByExpressionOrdered(p => p.IsActive && p.IsFavorite, p => p.Name, p => p.Id); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T23:46:15.377

You can use `Expression<Func<TEntity, object>>` for ordering expressions, it should work fine.

Then just change your method to

```
public IList<TEntity> FindByExpression(Expression<Func<TEntity, bool>> filter,
                                                    Expression<Func<TEntity, object>> subSelector,
                                                    params Expression<Func<TEntity, object>>[] orders)
{
    var query = SessionScope.Current.Set<TEntity>().Include(subSelector).Where(filter).OrderBy(m => true);
    query = orders.Aggregate(query, (current, order) => current.ThenBy(order));

    return query.ToList();
} 
```

But one day, you'll want to choose the order direction... And will have to find a more clever way !

without the "OrderBy(m => true") trick, and with your comment (and with the same problem, if orderBy params is an empty array, this will fail) , I would do

```
var query = SessionScope.Current.Set<TEntity>()
                        .Include(subSelector)
                        .Where(filter)
                        .OrderBy(orderBy.First());
foreach (var order in orderBy.Skip(1))
   query = query.OrderBy(order); 
```

# mysql - SQL：求和返回结果的最大值

> ID：14657881
> 
> 赞同：3
> 
> 时间：2013-02-02T02:06:13.057
> 
> 标签：mysql, sql, select, sum, max

以下 SQL 语句产生下面列出的结果。问题是，如何修改此语句以仅提供单个值的总和，即**6,940**？

```
SELECT 
post_metrics.post_id,
post_metric_types.name, 
MAX(post_metrics.value)
FROM post_metrics 
INNER JOIN post_metric_types ON post_metric_types.id = post_metrics.post_metric_type_id 
LEFT JOIN posts ON posts.id = post_metrics.post_id
WHERE post_metrics.post_metric_type_id = 2
AND posts.channel_id = 2268
GROUP BY post_metrics.post_id 
ORDER BY post_metrics.post_metric_type_id, post_metrics.post_id, post_metrics.value DESC 
```

POSTID：值；

1：25；2：588；3：12；4：0；5：74；6：12；7：4；8：27；9：13；10：70；11：0；12：28；13：0；14：204；15：181；16：101；17：17；18：19；19：0；20：171；21：37；22：72；23：25；24：82；25：81；26：164；27：0；28：37；29：215；30：6；31：0；32：203；33：10；34：7；35：29；36：71；37：39；38：8；39：0；40：28；41：4；42：35；43：44；44：9；45：0；46：18；47：125；48：6；49：30；50：0；51：6；52：11；53：8；54：74；55：0；56：10；57：8；58：11；59：0；60：12；61：15；62：0；63：108；64：9；65：72；66：24；67：0；68：19；69：86；70：0；71：16；72：25；73：10；74：23；75：12；76：23；77：10；78：0；79：0；80：101；81：141；82：14；83：0；84：5；85：43；86：36；87：0；88：9；89：22；90：14；91：10；92：17；93：6；94：3；95：0；96：9；97：9；98：0；99：67；100：18；101：10；102：3；103：0；104：7；105：0；106：9；107：13；108：3；109：10；110：27；111：14；112：60；113：22；114：11；115：10；116：0；117：15；118：11；119：20；120：0；121：42；122：26；123：0；124：15；125：30；126：4；127：66；128：9；129：35；130：5；131：0；132：17；133：0；134：616；135：5；136：6；137：0；138：4；139：24；140：5；141：0；142：5；143：710；144：0；145：30；146：6；147：25；148：4；149：7；150：6；151：0；152：28；153：6；154：9；155：0；156：10；157：4；158：2；159：0；160：0；161：51；162：10；163：6；164：35；165：6；166：2；167：0；168：0；169：13；170：5；171：4；172：3；173：9；174：8；175：3；176：0；177：19；178：45；179：0；180：27；181：0；182：13；183：8；184：9；185：5；186：0；187：103；188：4；189：12；190：5；191：10；192：8；193：5；194：6；195：6；196：6；197：6；198：87；199：4；200：55；201：30；202：9；203：32；204：9；205：0；206：10；207：0；208：29；209：11；210：10；211：4；212：0；213：44；

= 6,904

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-02T02:11:47.770

将现有查询用作子查询将是一种方法：

```
SELECT SUM(maxpostmetric)
FROM (
    SELECT 
        post_metrics.post_id,
        post_metric_types.name, 
        MAX(post_metrics.value) maxpostmetric
    FROM post_metrics 
        INNER JOIN post_metric_types ON post_metric_types.id = post_metrics.post_metric_type_id 
        LEFT JOIN posts ON posts.id = post_metrics.post_id
    WHERE post_metrics.post_metric_type_id = 2
        AND posts.channel_id = 2268
    GROUP BY post_metrics.post_id 
) t 
```

祝你好运。

顺便说一句 - 您`LEFT JOIN`在您的帖子表上使用 a ，但随后在您的`WHERE`条件中包含该表中的一列。你可以把它变成一个`INNER JOIN`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-02T02:14:16.413

对当前查询运行查询：

```
select sum(max_value)
from (SELECT 
    post_metrics.post_id,
    post_metric_types.name, 
    MAX(post_metrics.value) as max_value
    FROM ...
) x 
```

# php - 在线提交后PHP表单数据不保存，但在本地服务器中？

> ID：14657882
> 
> 赞同：0
> 
> 时间：2013-02-02T02:06:20.617
> 
> 标签：php, forms, wamp

在寻找了一下之后，我创建了一个 PHP 表单，我想在抛出错误时保存数据。奇怪的是，当我在本地 WAMP 安装中测试它时它可以工作，但是一旦我将它移到在线托管的服务器上，它就不起作用了。

我的表格是这样的：

```
<form action="<?php echo htmlentities($_SERVER['PHP_SELF']); ?>" method="post" enctype="multipart/formdata"><div class="formlabel">Username:</div>
<input type="text" id="username" name="username" value="<?= @$_POST['username'] ?>"/>
<small class="errorText"><?php echo $throwError["username"]; ?></small>
<br><div class="formlabel">Password:</div>
<input type="password" id="password" name="password" value="<?= @$_POST['password'] ?>"/>
<small class="errorText"><?php echo $throwError["password"]; ?></small>
<br>
<small class="errorText"><?php echo $throwError["validate"]; ?></small>
<input type="submit" name="submit" value="Login"/>
</form> 
```

目前，当它运行时，这是动作：

```
$throwError = array(
    "username" => "",
    "password" => "",
    "validate" => ""
);

if(isset($_POST['submit'])) {
    $username = trim($_POST['username']);
    $password = trim($_POST['password']);
    setCookie('memberID', $username);

    if (!empty($username) && !empty($password)) {
        $result = mysql_query("SELECT * FROM member WHERE member_id='$username' AND password='$password'", $linkid);
        if(!$result || mysql_num_rows($result) <= 0) {
            $throwError["validate"] = "Please enter a valid username and password";
            return false;
        }
        return true;
    }

    if (empty($username)){
        $throwError["username"] = "Please enter your username";
    }

    if (empty($password)){
        $throwError["password"] = "Please enter your password";
    }
} 
```

当它托管在 Wamp 上并通过 localhost 查看时，如果我输入用户名而没有密码（反之亦然），我会看到我的错误，并且用户名/密码保持输入到表单中。但是，我将其上传到服务器，我看到的只是`<?=@_POST['username'] ?>`输入用户名中的字符串，同样（但隐藏）在密码框中。

甚至不确定这与代码有关，但也许有一种方法可以用不同的方式做同样的事情，这就是我觉得有必要发布它的原因。

任何理论都值得赞赏！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T04:39:20.963

这 -`<?= @$_POST['username'] ?>`主要与 javascript 中的变量一起使用，其中 var = 但其他尝试仅使用 $_POST['username'] 或类似的 php 变量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-02T03:48:54.580

也许如果你设置

```
short_open_tag = On 
```

在[php.ini](http://php.net/manual/en/ini.core.php)中并重新启动您的 Apache 服务器。

[来源](https://stackoverflow.com/questions/2185320/how-to-enable-php-short-tags)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-02T07:36:42.947

当您想在同一页面上发布数据时，请在表单提交上的 html 标记的表单标记中保留 action=""

```
foreach($_post as $key=?$value)
{
print_r($key);
} 
```

并检查它显示的内容

# c++ - 在 C++ 中初始化结构中的 const 数组

> ID：14657886
> 
> 赞同：3
> 
> 时间：2013-02-02T02:06:47.027
> 
> 标签：c++, arrays, struct, constants

我必须在道具上工作。二进制文件格式，想用结构体来实现。
我的结构中需要恒定的字节序列，而 atm 我不知道如何实现这一点。

我想过这样的事情：

```
#include <cstdint>
#pragma pack(push,1)

typedef struct PAYLOAD_INFO {
    const uint8_t magicnumber[4] =  { 0xFA, 0x11 , 0x28 , 0x33 };
    uint16_t UMID;
    const uint16_t VID = 1487 ;
    uint32_t crc;
};

#pragma pack(pop)

int main (){
  PAYLOAD_INFO pldInst;
  pldInst.UMID = 5;
  pldInst.crc = 0x34235a54;
  ...
  writeToFile(&PAYLOAD_INFO,sizeof(PAYLOAD_INFO));
} 
```

最后“pldInst”应该看起来像那样（在内存中），而不考虑本示例中的字节顺序：

```
0x00000000:  0xFA, 0x11 , 0x28 , 0x33
0x00000004:  0x00, 0x05 , 0x05 , 0xCF
0x00000008:  0x34, 0x23 , 0x5a , 0x54 
```

我已经尝试过“默认”方法：

```
#include <cstdint>
#pragma pack(push,1)

typedef struct PAYLOAD_INFO {
    static const uint8_t magicnumber[4];
    uint16_t UMID;
    static const uint16_t VID = 1487 ;
    uint32_t crc;
};

const uint8_t magicnumber[4] =  { 0xFA, 0x11 , 0x28 , 0x33 };

#pragma pack(pop) 
```

但没有按预期工作。

有没有办法在不计算每个结构成员的内存大小、分配新内存和复制每个成员的情况下完成这项工作？

我使用 g++ 4.6.3。

问候，托马斯

更新：
@bikeshedder 提供的 c++11 解决方案运行良好，但只能使用 g++ 4.7 或更高版本进行编译。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-02T02:16:01.563

您的静态当前只是定义一个全局静态。您需要添加一个类说明符来将静态定义为您的类的一部分。

```
const uint8_t PAYLOAD_INFO::magicnumber[4] = { 0xFA, 0x11 , 0x28 , 0x33 }; 
```

也就是说，正如@bikeshedder 下面提到的那样，静态数据单独存储在内存中，因此当您创建结构的新实例时，该实例不会在实例的内存位置包含幻数，因此您的使用`writeToFile`不会像您一样工作预计。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-02T02:20:46.743

我建议不要对`structs`原始内存进行任何类型的转换，除非您使用的内核接口可以保证在同一台机器上运行并且应该以这种方式使用。

这不是可移植的（字节序问题），每个编译器的做法都有点不同，性能也没有好多少。总而言之，它不能证明这种不良做法是正当的。

您的代码示例不起作用的原因是静态成员。由于静态成员不仅是对象（而是类）的一部分，而且`UMID`是以`crc`这种方式编写的。

```
struct PAYLOAD_INFO {
    const uint8_t magicnumber[4] = { 0xFA, 0x11, 0x28, 0x33 };
    uint16_t UMID;
    const uint16_t VID = 1487 ;
    uint32_t crc;
}; 
```

此代码仅适用于 C++11，但由于您包含`cstdint`我假设您已经使用该 C++ 版本。如果您不使用 C++11，则需要在构造函数中初始化成员，并且不能使用`const`幻数，因为它无法初始化。（请参阅：[在 C++ 中的类初始化程序中初始化 const 数组](https://stackoverflow.com/questions/161790/initialize-a-const-array-in-a-class-initializer-in-c)）

```
struct PAYLOAD_INFO {
    const uint8_t magicnumber[4] = { 0xFA, 0x11, 0x28, 0x33 };
    uint16_t UMID;
    const uint16_t VID = 1487 ;
    uint32_t crc;
}; 
```

对于 C++98，您需要执行以下操作：

```
struct PAYLOAD_INFO {
    uint8_t magicnumber[4];
    uint16_t UMID;
    const uint16_t VID;
    uint32_t crc;
    PAYLOAD_INFO() : VID(1487)
    {
        magicnumber[0] = 0xFA;
        magicnumber[1] = 0x11;
        magicnumber[2] = 0x28;
        magicnumber[3] = 0x33;
    }
}; 
```

# php - 有没有办法在php中循环遍历地址并一次（或一个接一个）下载多个文件？

> ID：14657887
> 
> 赞同：0
> 
> 时间：2013-02-02T02:06:49.333
> 
> 标签：php, loops, download

好的，所以，我有一个网站，其中有许多不同的数据集可供下载。现在，与其逐个浏览并单击每个文件并选择将每个文件保存到我的电脑，有没有一种方法可以使用 PHP 循环并强制下载我想要的所有文件。在这种情况下，我是用户，无法访问服务器端。我已经读过的大部分内容都是关于人们建立自己的网站供其他用户下载东西的。

细节：

现在，我知道每个文件都位于 blahblah.com/downloadset1, /downloadset2, ... , /downloadsetN

然后我可以设置一个文本框，我可以在其中输入我想要的每个集数，用逗号分隔。例如：[1、2、300、4325]

从那里我可以让脚本将文本框值附加到“blahblah.com/downloadset”的末尾

这会给我一个数组（blahblah.com/downloadset1、blahblah.com/downloadset2、blahblah.com/downloadset300、blahblah.com/downloadset4325）

现在这些地址没有内容，只有下载本身，所以如果我在地址栏中输入它们，下载弹出窗口只会出现要求保存或打开。

我可以在脚本中写一些东西，让它循环通过我的新下载地址数组并以“保存”的形式开始下载，而不需要它询问我每一个吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T02:50:30.893

如果您希望能够保存文件，则必须在可以编写的机器上运行脚本。因此，假设您在本地机器上运行 php；那么您可能需要回答两个问题。

1) 如何列出要下载的文件的名称？

2) 如何以编程方式下载文件？

从你的问题听起来你已经弄清楚了第一部分。我将只介绍第二部分 - 制作一个下载列表中所有文件的 php 脚本。有两种常见的技术 -`curl (sometimes written cURL)`或`wget`。当您键入“使用 curl 下载文件”或“使用 wget 下载文件”时，您可以找到大量信息，因此我将仅举一个最小的示例：这会从 读取一张图像`http://www.floris.us/SO/IMG_0250.jpg`，并将本地副本保存在`image1.jpg`. 如果将脚本另存为`curlTest.php`，则可以使用

```
php curlTest.php 
```

你应该可以从这里开始（建立一个循环，添加诊断，错误检查......）

```
<?php
$url = 'http://www.floris.us/SO/IMG_0250.jpg';
$outputfile = "image1.jpg";
$cmd = "wget -q \"$url\" -O $outputfile";
exec($cmd);
?> 
```

如果我误解了您的设置，请在评论中告诉我。

# c++ - 在 fork() 之后 log4cplus 会发生什么？

> ID：14657891
> 
> 赞同：1
> 
> 时间：2013-02-02T02:08:14.787
> 
> 标签：c++, fork, log4cplus

我在服务器上工作，我希望能够使用 log4cplus 记录消息。到这里为止没什么太复杂的。

但是，我`fork()`每次收到连接请求时都会创建一个子进程。这`fork()`是为了确保子进程有自己的数据库连接实例。

现在我也想在孩子中使用 Logger。它在服务器中运行良好（即，我可以在控制台中看到日志输出，并在我设置它时看到文件。）但是在`fork()`它看起来像丢失之后。

现在使用的有一个简化的概要：

```
log4cplus::PropertyConfigurator::doConfigure(filename);
log4cplus::Logger l(log4cplus::Logger::getInstance("snap"));
l.log(ll, "Server Started", f_file, f_line); // <<-- works great!
...
listen();
accept();
...
fork();
// if child:
log4cplus::Logger l(log4cplus::Logger::getInstance("snap"));
l.log(ll, msg, f_file, f_line); // <<-- does not work?! 
```

我在想记录器可能会将文件锁定在服务器中，因此孩子们自己无法打开同一个文件。是这样吗？如果是这样，那么 log4cplus 不能在我的环境中使用...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-06-01T07:27:15.997

如评论中所述，要使其再次正常工作，您需要关闭所有内容并重新配置。

但是，如果您使用的是较新的版本和**日志服务器**，您最终会得到至少一个线程。在这种情况下，`fork()`不会复制线程，因此`log4cplus::Logger::shutdown`如果只是在子进程中调用，调用就会锁定（它会在子进程中永远等待该线程。）

因此，正确的方法是在父节点中关闭，分叉，然后在父节点和子节点中重新配置。以下函数显示了我们如何处理这种情况。

```
pid_t fork_child()
{
    // shutdown
    log4cplus::Logger::shutdown();
    pid_t p(fork());
    // reconfigure
    log4cplus::PropertyConfigurator::doConfigure("snap.properties");
    return p;
} 
```

# javascript - 如何制作 4 小时自动重启计时器？

> ID：14657897
> 
> 赞同：0
> 
> 时间：2013-02-02T02:09:27.973
> 
> 标签：javascript, html, timer, countdown

我需要一个计时器一次倒计时 4 小时，然后在达到 0 后重新启动。所有客户端的剩余时间必须相同。我目前有这个：

```
function addZero(i) {
  if (i < 10) {
    i = "0" + i;
  }
  return i;
}
setInterval(function() {
  function addZero(i) {
    if (i < 10) {
      i = "0" + i;
    }
    return i;
  }
  var d = new Date();
  var s = (d.getSeconds());
  var m = (d.getMinutes());
  var x = document.getElementById("timer");
  var c = addZero(30 - m) + ":" + addZero(60 - s);
  var d = addZero(60 - m) + ":" + addZero(60 - s);
  if (m < 30) {
    t = c
  } else {
    t = d
  }

  x.innerHTML = t;
}, 250)
```

```
<div align="center">
  <table>
    <tbody>
      <td style="font-size:15px;">Time to next restart:</td>
      <td style="font-size:16px;" id="timer"></td>
      <td nowrap="nowrap" width="15px">
        <p style="text-align: left;"></p>
      </td>
    </tbody>
  </table>
</div>
```

倒计时 30 分钟，然后重置回 30。但是，当它到达最后一秒时，它会计算 60，而不是直接到 59（所以 4:00/3:60/3:59）。它还需要从美国东部标准时间中午（中午 12 点）开始倒计时。我想以`h:mm:ss`格式显示时间，我也错过了上面代码中的时间。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T02:28:47.987

使用 PHP 在初始页面加载时获取日期/时间，而不是客户端/JS Date() - 这在机器之间可能有很大不同，因此如果您希望客户端同步它是没有价值的（PHP 日期将来自服务器时钟，所以如果它是正确的，您可以将多个客户端同步到它）。即使以这段时间为基础，然后在客户端倒计时四个小时，也不太可能导致时间同步良好——我会定期参考服务器来同步它。

至于你显示 60 的问题，你能不能像这样替换代码中的数字：

```
var d = addZero(60 - m) + ":" + addZero(60 - s); 
```

变成

```
var d = addZero(59 - m) + ":" + addZero(59 - s); 
```

?

看到返回值将始终为 0-59，这只会将其反转，您不会得到负数，它将显示数字时钟的实际情况（您永远不会看到它们达到 60 分钟/秒，它们会重置为 0）。

我会用 JS 来计算分钟/秒，因为如此频繁地引用服务器是没有意义的——如果你在同步时发现了一个差异，那么如果你不让它太久，它就不太可能太高检查之间的时间（如 4 小时）。

这实际上是为了什么？

# google-app-engine - GAE 错误 AttributeError：“NoneType”对象没有属性“图像”

> ID：14657901
> 
> 赞同：0
> 
> 时间：2013-02-02T02:11:19.373
> 
> 标签：google-app-engine

我正在 GAE 上制作一个简单的应用程序，允许用户输入图像的 url 和名称。然后，该应用程序将此图像连同其名称一起上传到数据存储区。

上传后页面自我重定向，然后应该将图像发送回客户端并显示在他们的机器上。

应用程序运行，但没有显示图像。我得到的日志消息是：

**AttributeError：“NoneType”对象没有属性“图像”**

**蟒蛇：**

```
import jinja2   # html template libary
import os

jinja_environment = jinja2.Environment(loader=jinja2.FileSystemLoader(os.path.dirname(__file__)))

import urllib   
import urllib2 
import webapp2

from google.appengine.ext import db
from google.appengine.api import urlfetch

class Default_tiles(db.Model):
  name = db.StringProperty()
  image = db.BlobProperty(default=None)

class MainPage(webapp2.RequestHandler):
  def get(self):

    # this just prints out the url which the user enters into input
    image_name = self.request.get('image_name') 

    template_values = {
        'image_name': image_name,
    }

    template = jinja_environment.get_template('index.html')
    self.response.out.write(template.render(template_values))

class Upload(webapp2.RequestHandler):
  def post(self):

    # get information from form post upload
    image_url = self.request.get('image_url') 
    image_name = self.request.get('image_name')

    # create database entry for uploaded image 
    default_tile = Default_tiles()
    default_tile.name = image_name
    default_tile.image = db.Blob(urlfetch.Fetch(image_url).content)
    default_tile.put()

    self.redirect('/')

class Get_default_tile(webapp2.RequestHandler):
  def get(self):
    name = self.request.get('image_name')
    default_tile = self.get_default_tile(name)

    self.response.headers['Content-Type'] = "image/png"
    self.response.out.write(default_tile.image)

  def get_default_tile(self, name):
    result = db.GqlQuery("SELECT * FROM Default_tiles WHERE name = :1 LIMIT 1", name).fetch(1)
    if (len(result) > 0):
      return result[0]
    else:
      return None

app = webapp2.WSGIApplication([('/', MainPage),
                               ('/upload', Upload),
                               ('/default_tile_img', Get_default_tile)],
                              debug=True) 
```

**的HTML：**

```
<html>
    <head>
        <link type="text/css" rel="stylesheet" href="/stylesheets/main.css" />
    </head>

    <body>
        <form action="/upload" method="post">
            <div>
                <p>Name: </p>
                <input name="image_name">
            </div>
            <div>
                <p>URL: </p>
                <input name="image_url">
            </div>
            <div><input type="submit" value="Upload Image"></div>
        </form>
        <img src="default_tile_img?{{ image_name }}">

    </body>

</html> 
```

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T02:57:07.613

首先，您需要将`GET`参数发送回您的`MainPage`处理程序。如果你把它放在你的`Upload`处理程序中，这应该可以工作，在重定向线上：

`self.redirect('/?image_name=%s' % image_name)`

这将确保`MainPage`知道我们刚刚上传了什么图像。

第二个问题只是`<img>`模板中的标签。应该是这样的：

`<img src="default_tile_img?image_name={{image_name}}">`

进行这些更改后，我已经对其进行了测试，并且可以正常工作。

看起来一切都很好，除了你的`GET`参数。请记住，当您传递`GET`请求时，您需要指定它的名称和值，以便您的应用程序可以从标头中正确获取它。例如，如果您希望标头指定 image_name 是什么，您将传递此 URL：

`http://domain.com/?image_name=name`

代替：

`http://domain.com/?name`

# c - 我应该从以下代码中得到什么

> ID：14657902
> 
> 赞同：1
> 
> 时间：2013-02-02T02:11:25.553
> 
> 标签：c

我正在学习 C 并且我编写了以下代码：

```
#include<stdio.h>
#include <stdlib.h>

void main(){

double *g = calloc(10, sizeof(double));
double h[] = {1,2,3,4,5,6,7,8,9,10};

printf("Size of g: %d\n", sizeof(g));
printf("Size of h: %d\n", sizeof(h));
} 
```

我的印象是`g`和`h`都是长度为 10 的双精度数组，因为每个双精度都是 8 个字节，`sizeof(g)`应该`sizeof(h)`等于 80。但是，我得到以下响应：

```
Size of g: 8
Size of h: 80 
```

我错过了什么，为什么`sizeof(g)`8 在这里？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-02T02:16:13.043

g 是指向双精度的指针。在 64 位代码中，指针的长度为 8 个字节。h 是 10 个双精度数组，因此 h 的大小为 10 * 8 字节。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-02T02:14:35.663

`g`是指向 a 的指针`double`。`h`是 10 的数组`doubles`。`sizeof(h)`因此，您应该期待和的不同结果`sizeof(g)`。看起来您的系统是 64 位的（指针长度为 8 字节）。

顺便说一句，`sizeof`返回一个 type 的值`size_t`，它不同于`int`并且可能不同于`unsigned int`，因此您应该为它使用适当的类型说明符，`%zu`， not `%d`or `%u`。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-02T02:14:20.367

对于在当前范围内定义的静态数组，`sizeof`返回数组占用的内存大小——即`number_of_elements * sizeof(element)`（但如果将静态数组传递给函数，它会自动转换为指针）。另一方面，对于动态数组（即指针），它总是返回指针的大小。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-02T11:02:30.020

`double *g`:: **g**是一个指针，表示它将存储地址。要存储地址，**g**需要`8 Bytes (64-Bit)`. 所以`sizeof(g) = 8 Bytes`。即使您在所有情况下声明或因为**g**需要存储地址，`sizeof(g)`也会产生**相同的结果。**`char *g``float *g`

 **另一方面，`double h[]`（有 10 个元素）需要`8 (sizeof(double)) * 10 (Num_Of_Elements)`ie, `sizeof(h) = 80 Bytes`.**

# java - 完美的正方形 if,else

> ID：14657905
> 
> 赞同：1
> 
> 时间：2013-02-02T02:11:48.890
> 
> 标签：java

遇到完美方码问题

```
import java.util.*;

public class perfectsquare {

    /**
     * @param args
     */
    public static void main(String[] args) {
        // TODO Auto-generated method stub

Scanner s= new Scanner(System.in); 
double number; 

System.out.println("Enter number >");

number= s.nextDouble();

System.out.println(Math.sqrt(number));

    }

} 
```

使用 if,else 如何让它返回一个完美的平方，如 9=3 的 sqrt 但如果该数字的平方根是小数，例如 10 的平方根将是 3.122222，则返回 false .....

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-02T02:18:00.920

```
if(Math.round(Math.sqrt(number))==Math.sqrt(number)){
  //it is a perfect square
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-02T02:17:06.300

您可以将返回类型更改为`Object`（但您必须检查它是否是`instanceof`使用函数时使用的数字）或返回`-1`而不是 false

要查看它是否是一个完美的正方形，请使用以下命令：

```
if(Math.sqrt(number) % 1 == 0) {
    return number;
} else {
    return -1;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-02T02:21:57.617

```
import java.util.*;

public class perfectsquare {
    /**
     * @param args
     */
    public static void main(String[] args) {
        // TODO Auto-generated method stub

        Scanner s= new Scanner(System.in); 
        double number; 

        System.out.println("Enter number >");

        number= s.nextDouble();
        double sqr= Math.sqrt(number);
        //System.out.println(sqr);
        double num=sqr;
        double x;
        x=num%1;
        x=num-Math.floor(num);
        if(x>0){
            System.out.println("False");
        }
        else{
            System.out.println(sqr);
        }
    }
} 
```

这将起作用。

# c# - 在 XAML winrt 应用程序中，是否可以将深色主题仅应用于一个元素？

> ID：14657908
> 
> 赞同：3
> 
> 时间：2013-02-02T02:12:22.993
> 
> 标签：c#, xaml, windows-runtime, winrt-xaml

我正在使用播放器框架媒体播放器，并且我在黑色背景下使用它，但该应用程序使用浅色主题。我想将深色主题应用于这一个元素。

这可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T04:30:35.710

现在在 WinRT 中这是不可能的。在浅色主题中的黑色背景的情况下，您必须定义自己的样式并将其合并到特定容器的资源中（在您的情况下是网格）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T02:27:57.863

是的，您可以将元素放在网格中并将网格的背景设置为黑色。即使应用了“浅色”主题，这将有效地始终使元素的背景为黑色。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-02T06:31:45.720

我还没有检查它是否可以工作，但您可以尝试包含应该位于（或附近）“c:\Program Files (x86)\Windows Kits\8.0\Include\winrt\xaml\设计”在您的项目中，并将其设置为网格的合并字典。也许这会覆盖您为应用程序的其余部分设置的轻量级主题字典。

另一种方法是修改媒体播放器中使用的所有控件的模板，以匹配其深色主题版本。Blend 在那里可能真的很有帮助，因为您可以打开两个 Blend 实例并轻松比较控件的基线深色主题版本和自定义深色主题版本中使用的颜色。

# github - “此提交缺少作者信息”

> ID：14657913
> 
> 赞同：1
> 
> 时间：2013-02-02T02:13:18.317
> 
> 标签：github

我刚开始使用 Github，但我所有的提交都显示为“blah [name]”，其中 name*不是*我的 Github 用户名。此外，左上角显示的最新提交显示“糟糕！此提交缺少作者信息”。

任何帮助将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-02T02:19:20.907

首先检查您的 git 配置并查看设置的值`user.name`和`user.email`

```
git config -l 
```

这两个需要与您在 Github 的用户名和电子邮件相同。

要设置这些值，只需执行以下操作

```
git config user.name "John Doe"
git config user.email "john.doe@example.com" 
```

上面的命令为该特定存储库设置您的用户名和电子邮件。如果要全局设置它们，可以执行以下操作：

```
git config --global user.name "Chris"
git config --global user.email "chris@personal.dev" 
```

# php - Wordpress/PHP 如何将数组中的字符串值显示为

> ID：14657918
> 
> 赞同：-1
> 
> 时间：2013-02-02T02:14:04.707
> 
> 标签：php, wordpress

我使用以下代码从 wordpress 自定义字段中获取一组数据：

```
<?php 
$values = get_field('google_location');
if($value) {
foreach($values as $value) {
echo $value;
}
}
?> 
```

这是数组的输出：

```
array(2) { ["coordinates"]=> string(22) "38.9974266,-77.1104762" ["address"]=> string(48) "8600 Old Georgetown Rd, Bethesda, Maryland 20814" }

array(2) { ["coordinates"]=> string(29) "37.7911347,-79.88268779999999" ["address"]=> string(26) "Arh Ln, Low Moor, VA 24457" }

array(2) { ["coordinates"]=> string(21) "38.9010559,-77.050792" ["address"]=> string(36) "900 23rd St NW, Washington, DC 20037" } 
```

如何从字符串中获取这些数组中的坐标（long、lat）并将它们插入到 li 项中。我希望我的 HTML 看起来像这样：

```
<ul>
    <li>38.9974266,-77.1104762</li>
    <li>37.7911347,-79.88268779999999</li>
    <li>38.9010559,-77.050792</li>    
</ul> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T02:18:28.300

所以 $value 几乎就是你得到的所有数据。因为你只是想协调你会有这样的事情：

```
 <ul>
            <?php 
        $values = get_field('google_location');
        if($values) {
        foreach($values as $value) {
 echo  '<li>'. $value["coordinates"] .'</li>';
         }
        }
        ?>
</ul> 
```

这应该有效。我没有检查它，但它应该工作

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-07-04T12:17:10.893

另一种更简单的方法：

```
$values = get_field('google_location');
echo "<ul><li>" . implode( '</li><li>', $values) . "</li></ul>"; 
```

# iphone - 通过按屏幕上的任意位置获取 UIActionSheet 以关闭

> ID：14657919
> 
> 赞同：0
> 
> 时间：2013-02-02T02:14:11.747
> 
> 标签：iphone, uiactionsheet, uitapgesturerecognizer

如何通过按屏幕上除 UIAction 表之外的任何位置来使 UIActionSheet 消失。这是我尝试实现目前不起作用的代码

```
- (void) viewDidAppear:(BOOL)animated
{
    [paintingVIew becomeFirstResponder];
    [super viewWillAppear:animated]; // or viewDidAppear?

    UITapGestureRecognizer *recognizer = [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(handleTapBehind:)];
    [recognizer setNumberOfTapsRequired:1];
     recognizer.cancelsTouchesInView = NO; //So the user can still interact with controls in the modal view
    [self.view.window addGestureRecognizer:recognizer];
}

 - (void)handleTapBehind:(UITapGestureRecognizer *)sender
{
    if (sender.state == UIGestureRecognizerStateEnded)
    {
        CGPoint location = [sender locationInView:nil]; //Passing nil gives us coordinates in the window

    //Then we convert the tap's location into the local view's coordinate system, and test to see if it's in or outside. If outside, dismiss the view.

        if (![self.view pointInside:[self.view convertPoint:location fromView:self.view.window] withEvent:nil])
        {
            // Remove the recognizer first so it's view.window is valid.
            [self.view.window removeGestureRecognizer:sender];
            [self dismissModalViewControllerAnimated:YES];
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T07:25:57.920

A`UIActionSheet`是模态的，这意味着在显示操作表时任何底层视图都不会收到触摸（就像 a 一样`UIAlertView`）。所以，回答你的问题：你不能用 default 做到这一点`UIActionSheet`。

# php - 在 PHP 中插入 HTML 代码

> ID：14657927
> 
> 赞同：1
> 
> 时间：2013-02-02T02:15:19.487
> 
> 标签：php, html, codeigniter

我需要`str_replace`在 CodeIgniter 函数的第二个参数中加入一些组合的 HTML PHP 代码。

```
<a href="<?=base_url();?>pages/articles/<?=str_replace($replace_simbols, '-', $category);?>.html" ></a>

<dt><?=character_limiter($categoryEntry1[2],110).'<a href="NEED TO PUT HERE ATRIBUTE FROM FIRST a href" >'.'<img class="read_more" src="/img/read_more.png" alt="read more" title="Read more..." /></a>'?></dt>

$replace_symbols , var contain (some symbols). 
```

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-02T02:23:02.987

为什么不把所有东西都放在一个变量中？顺便说一句，codeigniter 什么时候有 .html 扩展名

```
$href_link = base_url() . "pages/articles/" . str_replace($replace_simbols, '-', $category);
<a href="<?=$href_link;?>.html" ></a>

 <dt><?=character_limiter($categoryEntry1[2],110).'<a href="<?=$href_link;?>.html">'.'<img class="read_more" src="/img/read_more.png" alt="read more" title="Read more..." /></a>'?></dt> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-02T02:23:56.070

尝试：

```
$href = base_url() . "pages/articles/" . str_replace($replace_simbols, '-', $category) . ".html";

<a href="<?php echo $href;?>"></a>

<dt><?=character_limiter($categoryEntry1[2],110).'<a href="' . $href . '" >'.'<img class="read_more" src="/img/read_more.png" alt="read more" title="Read more..." /></a>'?></dt> 
```

# sql - 查找第二高的 Oracle 查询

> ID：14657931
> 
> 赞同：0
> 
> 时间：2013-02-02T02:16:07.633
> 
> 标签：sql, oracle, top-n

> **可能重复：**
> [在 Plsql 中选择第二行](https://stackoverflow.com/questions/13700106/select-2nd-row-in-plsql)

我有这个数据库电影（id：int，name：string，years：int，rating：float）

电影流派（movie_id：int，流派：字符串）

我需要找到对于每种类型，找到评分第二好的电影。这可以推广到找到第 i 部评分的电影吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-02T02:39:30.277

研究使用`ROW_NUMBER()`：

```
SELECT rating maxrating, genre
FROM (
  SELECT
    rating, 
    genre, 
    ROW_NUMBER() OVER (PARTITION BY genre ORDER BY rating DESC) rn
 FROM movies_genres mg
   JOIN movies m1 ON mg.movie_id=m1.movie_id 
 GROUP BY rating,genre
) t 
WHERE rn = 2 
```

这是[SQL Fiddle](http://sqlfiddle.com/#!4/32d0e/4)。

- 编辑

我添加`GROUP BY rating,genre`以删除潜在的重复项。正如@JW 正确指出的那样，您还可以替换`ROW_NUMBER`为`DENSE_RANK`which 将为您处理分组。

祝你好运。

# php - POST 空错误

> ID：14657935
> 
> 赞同：0
> 
> 时间：2013-02-02T02:16:36.557
> 
> 标签：php, html, phpmyadmin

它是我的密码更改页面。

我正在尝试 newpass、oldpass、newpasstwo 获取和更改。但是..所有帖子都给null。对不起英语不好，为什么我不能得到这个帖子？

```
 <form action="index.php?bolum=panel&secenek=sifredegistir" autocomplete="off" method="post">

    <table>
      <tr>
        <td>Eski Şifreniz</td><td>:</td><td><input type="password" name="oldpass" id="oldpass"></td>
      </tr>
      <tr>
        <td>Yeni Şifreniz</td><td>:</td><td><input type="password" name="newpass" id="newpass"></td>
      </tr>
      <tr>
        <td>Yeni Şifreniz <i>(tekrar)</i></td><td>:</td><td><input type="password" id="newpasstwo" name="newpasstwo"></td>
      </tr>
      <tr>
        <td></td><td></td><td><input class="px150" type="submit" value="Şifremi Değiştir"></td>
    </table>
  </form>

  </div></div></div>

<?php

}
elseif ($_GET['secenek'] == "sifredegistir") 
{
    $accname = strip_tags($_SESSION['muyuser']);
    $oldpass = $_POST['oldpass'];
    $newpass = $_POST['newpass'];
    $newpasstwo = $_POST['newpasstwo'];
    $sifre = mysql_query("SELECT * FROM users WHERE username='$accname' AND user_password='$oldpass'"); 
    $sifredogrula = mysql_num_rows($sifre);
    if(empty($oldpass) || empty($newpasstwo) || empty($newpass))
    {
      echo '<div align="center"><b>Lütfen tüm alanları doldurun!</b></div>';
    }
    elseif ($sifredogrula < 1) {
      echo $accname;
      echo $oldpass;
      echo newpass;
      echo newpasstwo;
      echo '<div align="center"><b>Bilgileriniz yanlış, lütfen dikkatli doldurun.</b></div>';
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T04:33:27.217

在 SELECT * from users 中单独选择您的用户名就足够了。

更改`echo newpass;`为`echo $newpass;`

更改`echo newpasstwo;`为`echo $newpasstwo;`

要更改密码，您需要添加

```
mysql_query("UPDATE users SET user_password='$newpasstwo;'
WHERE username='$accname'"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T04:18:18.880

session_start();

$_POST['oldpass']; 之前的某个地方 线。

# xml - 从 tar.gz 文件中读取 xml

> ID：14657939
> 
> 赞同：1
> 
> 时间：2013-02-02T02:17:57.863
> 
> 标签：xml, r, tar

我想我正在处理从 MAC 系统导出的一些数据文件。我收到了一个文件名 20110205.tar，然后我尝试查看里面的内容，它只给了我原始文件？BIN。我的朋友帮我提取了一堆xml文件，名称为时间格式：“2011-03-15T23_57_59Z.xml”，“2011-03-15T23_58_00Z.xml”。我尝试使用带有 xmlTree、xmlTreeParse、asXMLNode 等命令的 XML 包，然后我完全卡住了。当我通过记事本打开 xml 文件时，我有类似的东西：（我的朋友使用 Python 来做到这一点，但我不知道 Python）我也尝试了一些像 epidata 这样的包，但似乎很多包都不能用于更多。提取的文件我做winrar并上传到mediafire： [http ://www.mediafire.com/?ot8vt0wdw5c3oc1](http://www.mediafire.com/?ot8vt0wdw5c3oc1) `<asdiOutput xmlns="http://tfm.faa.gov/tfms/TFMS_XIS" xmlns:nxce="http://tfm.faa.gov/tfms/NasXCoreElements" xmlns:mmd="http://tfm.faa.gov/tfms/MessageMetaData" xmlns:nxcm="http://tfm.faa.gov/tfms/NasXCommonMessages" xmlns:idr="http://tfm.faa.gov/tfms/TFMS_IDRS" xmlns:xis="http://tfm.faa.gov/tfms/TFMS_XIS" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://tfm.faa.gov/tfms/TFMS_XIS http://localhost:58489/tfms/schema/TFMS_XIS.xsd" timestamp="2011-03-15T23:57:59Z"> <asdiMessage sourceFacility="CCZM" sourceTimeStamp="2011-03-15T23:57:27Z" trigger="TZ"> <trackInformation> <nxcm:aircraftId>UAL966</nxcm:aircraftId> <nxcm:speed>470</nxcm:speed> <nxcm:reportedAltitude> <nxce:assignedAltitude> <nxce:simpleAltitude>350</nxce:simpleAltitude> </nxce:assignedAltitude> </nxcm:reportedAltitude> <nxcm:position> <nxce:latitude> <nxce:latitudeDMS degrees="45" minutes="40" direction="NORTH"/> </nxce:latitude> <nxce:longitude> <nxce:longitudeDMS degrees="056" minutes="58" direction="WEST"/> </nxce:longitude> </nxcm:position> </trackInformation> </asdiMessage> <asdiMessage sourceFacility="CCZM" sourceTimeStamp="2011-03-15T23:57:27Z" trigger="TZ"> <trackInformation> <nxcm:aircraftId>UAL936</nxcm:aircraftId> <nxcm:speed>470</nxcm:speed> <nxcm:reportedAltitude> <nxce:assignedAltitude> <nxce:simpleAltitude>350</nxce:simpleAltitude> </nxce:assignedAltitude> </nxcm:reportedAltitude> <nxcm:position> <nxce:latitude> <nxce:latitudeDMS degrees="44" minutes="43" direction="NORTH"/> </nxce:latitude> <nxce:longitude> <nxce:longitudeDMS degrees="062" minutes="42" direction="WEST"/> </nxce:longitude> </nxcm:position> </trackInformation> </asdiMessage>`

请任何人帮助我。我想在 R 中做任何事情。 1\. 提取 tar 文件并将原始文件解码为 xml 文件 2\. 读取提取的多个 xml 中的数据提前谢谢！！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T03:14:49.450

根据您的操作系统，R`untar`命令可能会有所帮助；见`?untar`。作为使用 XML 的示例，我们可以加载文档

```
library(XML)
xml = xmlParse("2011-03-15T23_57_59Z.xml") 
```

然后使用[xpath](http://www.w3.org/TR/xpath/)语言查询它（特别是参见[第 2.5 节](http://www.w3.org/TR/xpath/#path-abbrev)），例如，飞机 id 和经度

```
> xpathSApply(xml, "//nxcm:aircraftId", xmlValue)
[1] "UAL966" "UAL936"
> xpathSApply(xml, "//nxce:longitudeDMS/@degrees")
degrees degrees 
  "056"   "062" 
```

还有一些便利功能，例如`xmlToDataFrame`，探索起来可能很有趣。

# ruby-on-rails - 在 Rails 视图中启动和停止命令行服务

> ID：14657941
> 
> 赞同：0
> 
> 时间：2013-02-02T02:18:12.313
> 
> 标签：ruby-on-rails, ruby-on-rails-3, shell, methods, autorun

我设置了以下代码，它将成功列出为 Delayed_Job 运行的不同服务 pid。但是，我正在寻找一种可以在我的视图中调用这些操作的方法。第一个是检查不同 pid 文件的函数，如果它们存在，那么它将返回 true 或 false。

在我看来，我有指向用户单击链接时正在调用的函数的链接。

但是，问题是每当我刷新此页面时，它都会执行方法并自动启动/停止服务。

**看法**

```
 <% if delayed_job_service_running? %>
    <em><b>Service Running</b></em> - 
    <%= link_to "Stop Service", delayed_job_stop %>
  <% else %>
    <em><b>Service Stopped</b></em> - 
    <%= link_to "Start Service", delayed_job_start %>
  <% end %> 
```

**帮助文件**

```
def delayed_job_service_running?
    files = Dir.glob("#{Rails.root}/pids/**/delayed_job*")
    pids = []
    files.each do |file|
        pids << `tail #{file}`
    end
    pids.empty? ? false : true
end

def delayed_job_start
    `script/delayed_job -n 2 start`
end

def delayed_job_stop
    `script/delayed_job stop`
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T02:32:02.040

我想到了。相当简单。诀窍是通过 url 使其成为回调操作。

**看法**

`link_to "stop service", "/admin/service/delayed_job_stop"`

**路线**

`match "admin/service/:string" => "pages#toggle_service", :as => "toggle_service"`

**控制器**

```
 def toggle_service
    command = params[:string].to_s
    if command == 'delayed_job_stop'
      `script/delayed_job stop`
    elsif  command == 'delayed_job_start'
      `script/delayed_job -n 2 start`
    end    
    redirect_to :back
  end 
```

# c++ - std::sort 算法

> ID：14657945
> 
> 赞同：0
> 
> 时间：2013-02-02T02:18:49.623
> 
> 标签：c++, sorting, vector

`std::sort`基于`operator<`.

现在考虑这个类：

```
class Foo
{
private:
     int m_x;
public:
     Foo()
     {
          m_x = 0;
     };
     Foo(int a)
     {
          m_x = a;
     }
     bool operator<(const Foo &right) const
     {
          return m_x < right.m_x;
     };
     void Set( int a ) { m_x = a; };
     int Get() { return m_x; };
};

std::vector<Foo> myVec;

for( int i = 0; i < 10; i++ )
     myVec.push_back( Foo() );
myVec.at( 5 ).Set( 2 );
myVec.at( 2 ).Set( 3 );

std::sort( myVec.begin(), myVec.end() ); 
```

1.  元素如何在生成的排序向量中定位？
2.  我需要做这样的事情：

    ```
    int counter = 0;
    for( int i = 0; i < myVec.size(); i++ )
    {
         if( myVec.at( i++ ).Get() == myVec.at( i ) )
         {
             counter++;
             continue;
         }
         else
         {
             // assign some variable some value
         }
         // perform some calculation (I have multiple elements with the same value)
    } 
    ```

在这种情况下是否有可能使用迭代器？有没有更好的算法来做到这一点？

[编辑]

这是我想要做的。假设我有一支足球队。它有10名球员。对于每个球员来说，在训练或比赛期间都可以考虑大量的技术/战术价值。所以，所有这些都是这样存储的：

```
std::map<std::string,std::vector<Foo>> score; 
```

现在最初当游戏开始时所有这些值都是 0。现在当玩家 5 传递时，score["Player5Name] 的值将变为 1，但所有其他值将保持 0。在训练结束时，这些值将被排序对于每个球员，根据谁球员的价值更大，主计分系统将被更新。因此，如果球员 5 有 100 次向前传球，并且这个值是最大的，并且没有其他人拥有它，那么这个球员将被分配 10 的值。如果玩家 3、7 和 9 有 90 次传球，排名第二，然后计算为 (9+8+7)/3 等等。Foo 类还有另一个 std::string 成员，它描述了玩家做了什么，因此向量可以通过适当的操作进行排序。

我希望这能澄清我正在努力做得更好的事情。

[/编辑]

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T02:30:25.153

数组将排序为，因为您在变量`[0,0,0,0,0,0,0,0,2,3]`上定义了比较运算符。`x`

关于第二个代码片段，您似乎正试图以某种方式处理同一元素的多个实例。您通常不想在同一语句中再次使用变量时增加变量。尝试类似：

```
int counter = 1;
for (int i = 1; i < myVec.size(); i ++) {
    if (myVec[i - 1].Get() == myVec[i].Get()) {
        counter ++;
        continue;
    }
    //the else clause is redundant, as you already have a continue above
    //process the multiple variables
}
//process the last variable 
```

# asp.net - Web.Config 中 Location 元素上的 ConfigSource

> ID：14657946
> 
> 赞同：2
> 
> 时间：2013-02-02T02:18:54.460
> 
> 标签：asp.net, web-config, configsource

好的，所以我正在浏览该公司的一个网站，并尝试使用某些元素上的 ConfigSource 属性来清理 web.config。

web.config 的最大区域之一是包含站点上几乎所有页面的授权值的位置列表。

我似乎找不到将它们全部放在一个配置中的方法，我真的仅限于为每个位置元素制作一个配置源吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-02T19:58:14.833

如果多个页面使用相同的配置，您可以在 configSource 属性中引用相同的文件，如我对问题[Specify more than one directory in Web.Config's Location Path element 的](https://stackoverflow.com/q/4608764/1414000)[回答](https://stackoverflow.com/a/16346330/1414000)中所示。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T21:26:59.873

看起来他们每个都需要一个配置源，嗯。请让我知道这是否不正确，但我找不到其他任何东西。

# javascript - Jquery Timedatepicker 在动态表单上无法正常工作

> ID：14657950
> 
> 赞同：0
> 
> 时间：2013-02-02T02:19:41.330
> 
> 标签：javascript, jquery

我已经成功修改了在这里找到的代码，它使用 javascript 创建了新的文本框字段。

我正在使用带有 datepicker jquery 插件的 timepicker 来进行平滑的日期和时间选择。我有个问题。加载页面后时间选择器正常工作，但在添加其他输入字段后，时间选择器停止工作。

这是html代码：

```
<head>
    <link href="css/jquery-ui.css" rel="stylesheet" type="text/css" media="screen" />       
    <link href="css/timepicker.css" rel="stylesheet" type="text/css" media="screen" />
    <script type="text/javascript" src="js/jquery.js"></script>
    <script type="text/javascript" src="js/jquery-ui.js"></script>
    <script type="text/javascript" src="js/timepicker.js"></script>
</head>
<body>
<form id="obform" name="obform" action="test5.php" method="POST">
    <div id="fields">
    <p><label>Date From:</label><input class="timepicker" name="txtdatefrom0" type="text"/></p>       
    <p><label>Date To:</label><input class="timepicker" name="txtdateto0" type="text"/></p>
    <input type="hidden" name="num" value="1"/>
    <button id="start" type="button" onclick="addField()">Add</button>
    <input type="submit" value="Submit"/>
    </div>
</form>
</body> 
```

这是脚本

```
<script>
$(document).ready(function(){
$('.timepicker').datetimepicker(); 
});

$('#start').click(function(){
$(".timepicker").datetimepicker("destroy");
$(".timepicker").datetimepicker();
});
    var num=0;
    function addField(){
    num++; //1
    if(num>4){
        num--;
    }
    makefields();
}
function rmField(){
    num--;
    if(num<0){
        num++;
    }
    makefields();
}

function makefields(){
var fields="";
for(var o=0;o<=num;o++){
fields+="<p><label>Date From: </label><input class=\"timepicker\" name=\"txtdatefrom"+o+"\" type=\"text\"></p>";
fields+="<p><label>Date To:</label><input class=\"timepicker\" name=\"txtdateto"+o+"\" type=\"text\"/></p>";
}
fields+="<br/><input type=\"hidden\" name=\"num\" value=\""+o+"\"/>";
if(num!=3){fields+="<button type=\"button\" onclick=\"addField()\">Add</button>";}
if(num>0){fields+="<button type=\"button\" onclick=\"rmField()\">Remove</button>";}
fields+="<input type=\"submit\" value=\"Submit\"/></form>";
document.getElementById("fields").innerHTML=fields;
}
</script> 
```

我也试图在我的数据库中添加新的输入值，关于如何做到这一点的任何想法？抱歉，我还是 Web 开发的新手。希望有一天能变得更好。

编辑：这是我已经修改了一段时间的 php 代码。我希望新创建的字段能够顺利插入到我的数据库中。我将要添加的字段的最大值设置为 4。我一直在尝试通过创建一组准备在我的数据库表中捕获它们的字段来动态插入字段（datefrom1、dateto1、datefrom2、dateto2 等等，但我可以不要让它工作。

另外，是否可以通过代码在我的 sql 中添加多个字段？就像如果你有 2 个重复，程序会在某个 db 表中创建 2 个新字段？如果可能的话，我更喜欢这样。我一直在网上到处寻找，但找不到解决方案。

```
$mysql_host = 'changed'; // put change for confidentiality
$mysql_user = 'changed';
$mysql_pass = 'changed';

$mysql_db = 'changed';

if(!mysql_connect($mysql_host, $mysql_user, $mysql_pass) || !mysql_select_db($mysql_db)) {
    die(mysql_error());
}
$sets=mysql_real_escape_string($_REQUEST["num"]); 
for($loop=0;$loop<$sets;$loop++){
    $df="txtdatefrom".$loop;
    $dt="txtdateto".$loop;
    if(isset($_POST[$df]) && isset($_POST[$dt])) {
        $datefrom=mysql_real_escape_string($_REQUEST[$df]);
        $dateto=mysql_real_escape_string($_REQUEST[$dt]);
        $query="INSERT INTO testob (datefrom,dateto) VALUES ('$datefrom','$dateto')";
        $query_run=mysql_query($query);
    }
    else {
        echo 'Fill up all fields';
    }
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T02:34:03.833

添加后，您需要为新添加的元素初始化插件。它不会在您运行代码时对不存在的元素进行初始化。

改变这个：

```
document.getElementById("fields").innerHTML=fields; 
```

至：

```
$('#fields').html( fields).find('.timepicker').datetimepicker(); 
```

数据库问题不清楚

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T03:20:37.690

对于这些类型的动态表单，您最好使用客户端模板作为动态位。这样您就不必编写两次代码（一次在 js 中，一次在 html 中）

见[http://jsfiddle.net/HmCPd/1/](http://jsfiddle.net/HmCPd/1/)

您的 addField 函数应类似于：

```
function addField() {
    // get html from the template
    var html = $('#fieldTemplate').html();

    /*
    make a new dom element (need to trim whitespace or jquery 
    won't parse the template properly
    */
    var $newField = $($.trim(html));

    // insert the new field and make it a datepicker
    $('#fieldsContainer')
      .append($newField)
      .find('input')
      .datepicker();
} 
```

这与您想要做的非常相似。只需确保在将新节点插入 dom 后绑定任何 ui 类，如 datetimepicker()。

至于将东西保存到数据库，一般的想法是你想给你的字段等......唯一的名称属性，你的服务器端代码将作为发布参数接收。将这些参数收集到 SQL 插入语句中并针对数据库运行它。只要确保避免 SQL 注入即可。请参阅[如何防止 PHP 中的 SQL 注入？](https://stackoverflow.com/questions/60174/how-to-prevent-sql-injection-in-php)了解更多信息。

# f# - 在 Visual Studio 中将 NLog 与 F# Interactive 结合使用 - 需要文档

> ID：14657954
> 
> 赞同：3
> 
> 时间：2013-02-02T02:20:17.743
> 
> 标签：f#, nlog, f#-interactive

在使用 F# Interactive 时，我需要捕获 F# 函数的输入和输出。当程序在 Visual Studio 下使用 F5 或 Ctrl-F5 运行时，我可以让 NLog 正常工作。同样，包含要输出到日志的语句的相同方法也可以正常工作，并在通过 F# Interactive 调用时被调用；日志文件中没有任何内容。

我还尝试使用 F# Interactive 设置对 NLog 的引用，但从 F# Interactive 运行时日志中仍然没有任何内容。

```
#I @"..\packages\NLog.2.0.0.2000\lib\net40" 
#r @"NLog.dll" 
```

我什至发现[这](https://stackoverflow.com/q/9465214/1243762)让我尝试了这些

```
NLog.Config.SimpleConfigurator.ConfigureForConsoleLogging()
NLog.Config.SimpleConfigurator.ConfigureForFileLogging(<full file name>) 
```

日志文件中仍然没有任何内容。

有人知道 Nlog 是否可以与 F# Interactive 一起使用吗？
如果是这样，它是如何完成的？

编辑

当单独运行时，我能够让 NLog 与 fsi.exe 一起工作。所以现在问题似乎是让 NLog 找到配置文件，因为 NLog 找不到从 Visual Studio 的 fsi.exe 位置开始的配置文件。查看在 NLog.dll 目录中使用 NLog.dll.nlog。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-04T01:23:27.530

## 问题

使用 F# Interactive 的 NLog 的问题在于，NLog 认为该`Temp`目录是可以找到的位置`NLog.config`并且永远不会成功。解决这个问题的方法是以编程方式定位`NLog.config`NLog。

## 解决这个问题需要知道的事情：

1.  从 Visual Studio 中运行 F# Interactive 时，它​​会将当前工作目录设置为临时文件。

    ```
    > System.Environment.CurrentDirectory;; 
    val it : string = "C:\Users\Eric\AppData\Local\Temp" 
    ```

2.  NLog 日志记录需要三个组件
    ：参考 NLog.dll。
    湾。配置文件。
    C。从代码调用记录器方法。

3.  NLog 可以通过多种方式进行配置，包括编程方式和使用配置文件。
4.  AppData 是一个隐藏文件夹。猜猜在使用 Windows 资源管理器时这意味着什么。
5.  要在 Visual Studio 中使用 F# Interactive 获取应用程序的位置，您需要`__SOURCE_DIRECTORY__`. 请参阅[F# Spec](http://research.microsoft.com/en-us/um/cambridge/projects/fsharp/manual/spec.html) 3.11 标识符替换
6.  NLog.conf 可以使用完整的文件路径。明显但必要。
7.  NLog[文件目标](https://github.com/nlog/NLog/wiki/File-target)有一个 autoFlush 选项。
8.  NLog 可以使用[NuGet安装到](https://www.nuget.org/)[Visual Studio 项目](https://msdn.microsoft.com/en-us/library/b142f8e7.aspx)中。
9.  这里的大部分信息来自[NLog Wiki](https://github.com/nlog/nlog/wiki)。

无需直接跳入 F# Interactive 解决方案，而是使用以下进程，因为需要创建一个 DLL 来设置和保存用于 F# Interactive 的 NLog 的函数。

1.  创建一个包含三个项目的解决方案并安装 NLog。
    解决方案名称：NLogExample
    项目 1 - 库，名称：Log - 包含调用 NLog
    项目 2 - 库的扩展函数，名称：MyLibrary - 用于生成使用 Log 函数的演示 DLL。
    项目 3 - 控制台应用程序，名称：Main - 用于生成使用日志功能的演示 EXE。

2.  一种。手动创建 NLog.config
    b. 从正在运行的项目中访问 NLog.config
    c。将消息记录到文件

3.  一种。以编程方式创建配置
    b. 为正在运行的项目创建配置并将消息记录到文件中

4.  使用 F# Interactive 创建配置并将消息记录到文件中

## 1.创建一个包含三个项目的解决方案并安装NLog

使用 Visual Studio 创建三个项目。

[![在此处输入图像描述](../Images/3d7b8996151718755a63ab0f63337134.png)](https://i.stack.imgur.com/7rQ5t.png)

为所有三个项目安装 NLog。

[![在此处输入图像描述](../Images/b45cb55c31c7b644b94bf3f5c7d49d2e.png)](https://i.stack.imgur.com/jED6Z.png)

## 2.a. 手动创建 NLog.config

注意：为了让这些示例在从 F# Interactive 运行时能够正常工作，它应该报告作为项目一部分的目录`__SOURCE_DIRECTORY__;;`而**不是**`Temp`目录。

注意：此答案中的所有路径都相对于解决方案目录。
当您`<Solution directory>`在实际解决方案目录中看到替代品时。

小路：`<Solution director>\NLog.config`

```
<?xml version="1.0" encoding="utf-8" ?>
<nlog xmlns="http://www.nlog-project.org/schemas/NLog.xsd"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      throwExceptions="true">

  <targets>
    <target xsi:type="File"
            name="file"
            fileName="<Solution directory>\log.txt"
            autoFlush="true"
      />
    </targets>

  <rules>
    <logger name="*"
            minlevel="Trace"
            writeTo="file"
    />
  </rules>
</nlog> 
```

注意：记得更改`<Solution directory>`为实际路径并设置 `autoFlush="true"`

注意：添加`NLog.config`到解决方案可以更轻松地查看/修改文件。

[![在此处输入图像描述](../Images/e0bf94aa41161be438c5bef04153e593.png)](https://i.stack.imgur.com/P2qxL.png)

## 2.b。从正在运行的项目中访问 NLog.config

在 Log.Library1.fs

```
namespace Log

module MyLog =

    let configureNLog () =
      let projectPath = __SOURCE_DIRECTORY__
      let soulutionPath = projectPath + "\.."
      let configPath = soulutionPath + @"\NLog.config"
      let xmlConfig = new NLog.Config.XmlLoggingConfiguration(configPath)
      NLog.LogManager.Configuration <- xmlConfig

    let NLogConfigToString () = 
      let targets = NLog.LogManager.Configuration.AllTargets
      let out = ""
      let out = Seq.fold (fun out target -> out + (sprintf "%A\n" target)) out targets
      let rules = NLog.LogManager.Configuration.LoggingRules
      let out = Seq.fold (fun out rule -> out + (sprintf "%A\n" rule)) out rules
      out

    let printNLogConfig () = 
       Printf.printfn "%s" (NLogConfigToString ()) 
```

并为 Log 项目添加对`System.XML`

在 Main.Program.fs

```
open Log

[<EntryPoint>]
let main argv = 

    MyLog.configureNLog ()
    MyLog.printNLogConfig ()

    0 // return an integer exit code 
```

并为 Main 项目添加对该`Log`项目的引用并将 Main 项目设置为启动项目。

运行时应该输出到控制台：

```
File Target[file]
logNamePattern: (:All) levels: [ Trace Debug Info Warn Error Fatal ] appendTo: [ file ] 
```

## 2.c。将消息记录到文件

在 Log.Library1.fs

```
namespace Log

open NLog

module MyLog =

    let configureNLog () =
      let projectPath = __SOURCE_DIRECTORY__
      let soulutionPath = projectPath + "\.."
      let configPath = soulutionPath + @"\NLog.config"
      let xmlConfig = new NLog.Config.XmlLoggingConfiguration(configPath)
      NLog.LogManager.Configuration <- xmlConfig

    let NLogConfigToString () = 
      let targets = NLog.LogManager.Configuration.AllTargets
      let out = ""
      let out = Seq.fold (fun out target -> out + (sprintf "%A\n" target)) out targets
      let rules = NLog.LogManager.Configuration.LoggingRules
      let out = Seq.fold (fun out rule -> out + (sprintf "%A\n" rule)) out rules
      out

    let printNLogConfig () = 
       Printf.printfn "%s" (NLogConfigToString ())

    let evalTracer = LogManager.GetLogger("file") 
```

在 Main.Program.fs

```
open Log
open Library1

[<EntryPoint>]

    let main argv = 

        MyLog.configureNLog ()
        MyLog.printNLogConfig ()

        // Add as many of these as needed
        MyLog.evalTracer.Trace("In Main @1.")

        MyFunctions.test001 ()

        0 // return an integer exit code 
```

并为 Main 项目添加对该`MyLibrary`项目的引用。

在 MyLibrary.Library1.fs

```
namespace Library1

open Log

module MyFunctions =

    let test001 () =
        MyLog.evalTracer.Trace("In Library @1.") 
```

并为 MyLibrary 项目添加对该`Log`项目的引用。

运行时，日志文件`log.txt`应包含类似以下内容：

```
2016-03-28 11:03:52.4963|TRACE|file|In Main @1.
2016-03-28 11:03:52.5263|TRACE|file|In Library @1 
```

## 3.a. 以编程方式创建配置

如果`NLog.config`文件存在，请删除它以验证代码是否创建了新配置但未创建文件。

要使用 F# 以编程方式设置配置，您需要知道：

1.  此 FileName 字符串是一个布局，其中可能包含布局渲染器的实例。这使您可以使用单个目标写入多个文件。
2.  SimpleLayout - 表示带有嵌入占位符的字符串，可以呈现上下文信息。

到 Log.Library1.fs 添加

```
let configureNLogPrgramatically () =
  let config = new NLog.Config.LoggingConfiguration()
  let fileTarget = new NLog.Targets.FileTarget()
  let projectPath = __SOURCE_DIRECTORY__
  let soulutionPath = projectPath + "\.."
  let filePath = soulutionPath + @"\log.txt"
  let layout = new NLog.Layouts.SimpleLayout(filePath)
  fileTarget.Name <- "file"
  fileTarget.FileName <- layout
  fileTarget.AutoFlush <- true
  config.AddTarget("file", fileTarget)
  let rule1 = new NLog.Config.LoggingRule("*",NLog.LogLevel.Trace,fileTarget)
  config.LoggingRules.Add(rule1)
  NLog.LogManager.Configuration <- config 
```

## 3.b。为正在运行的项目创建配置并将消息记录到文件中

在 Main.Program.fs

```
open Log
open Library1

[<EntryPoint>]

    let main argv = 

        MyLog.configureNLogPrgramatically ()
        MyLog.printNLogConfig ()

        // Add as many of these as needed
        MyLog.evalTracer.Trace("In Main @1.")

        MyFunctions.test001 ()

        0 // return an integer exit code 
```

运行时，日志文件`log.txt`应包含类似以下内容：

```
2016-03-28 11:16:07.2901|TRACE|file|In Main @1.
2016-03-28 11:16:07.3181|TRACE|file|In Library @1. 
```

并注意**未**`NLog.config`创建文件 。

 **## 4\. 使用 F# Interactive 创建配置并将消息记录到文件中

在 MyLibrary.Script.fsx 中

```
// print out __SOURCE_DIRECTORY__ to make sure we are not using the Temp directory
printfn __SOURCE_DIRECTORY__

#I __SOURCE_DIRECTORY__

// Inform F# Interactive where to find functions in Log module
#I "../Log/bin/Debug/"
#r "Log.dll"

open Log

// Functions in Log module can now be run.
MyLog.configureNLogPrgramatically ()
MyLog.printNLogConfig ()

// Inform F# Interactive where to find functions in MyLibrary module
#I "../MyLibrary/bin/Debug/"
#r "MyLibrary.dll"

open Library1

// Functions in MyLibrary module can now be run.
MyFunctions.test001 () 
```

使用 F# Interactive 执行脚本时

```
Microsoft (R) F# Interactive version 14.0.23413.0
Copyright (c) Microsoft Corporation. All Rights Reserved.

For help type #help;;

> 
<Solution directory>\MyLibrary
val it : unit = ()

--> Added <Solution directory>\MyLibrary' to library include path

--> Added <Solution directory>\MyLibrary\../Log/bin/Debug/' to library include path

--> Referenced <Solution directory>\MyLibrary\../Log/bin/Debug/Log.dll'

File Target[file]
logNamePattern: (:All) levels: [ Trace Debug Info Warn Error Fatal ] appendTo: [ file ]

--> Added <Solution directory>\MyLibrary\../MyLibrary/bin/Debug/' to library include path

--> Referenced <Solution directory>\MyLibrary\../MyLibrary/bin/Debug/MyLibrary.dll'

val it : unit = ()

> 
```

日志文件`log.txt`应包含类似以下内容：

```
2016-03-28 11:42:41.5417|TRACE|file|In Library @1. 
```

此外，当您仍然有一个活动的 F# Interactive 会话时，这将记录下来，因此您可以在执行命令之间查看日志。**

# maven - 如何为 Maven 设置新的本地工件？

> ID：14657957
> 
> 赞同：6
> 
> 时间：2013-02-02T02:20:49.527
> 
> 标签：maven, build, repository, build-automation, artifactory

我已经阅读了很多关于这个和大量其他网站的问题和文章，但我仍然无法让它工作。

我已经配置了 maven 来执行我的构建，现在想将工件放入存储库中。我在tomcat中安装了artifactory，它似乎正在工作。

如果我执行“mvn clean install”，则消息表明工件正在上传到本地 maven 存储库而不是工件：

```
[INFO] --- maven-install-plugin:2.3.1:install (default-install) @ my-app ---
[INFO] Installing C:\maven_projects\my-app\my-app\target\my-app-1.0-SNAPSHOT.jar to             C:\Users\Administrator\.m2\repository\com\mycompany\app\my-app\1.0
-SNAPSHOT\my-app-1.0-SNAPSHOT.jar
[INFO] Installing C:\maven_projects\my-app\my-app\pom.xml to     C:\Users\Administrator\.m2\repository\com\mycompany\app\my-app\1.0-SNAPSHOT\my-app-1.0-SNAPSHOT.pom 
```

如果我执行“mvn deploy:deploy-file”，指定存储库，则消息表明工件正在上传到工件中，但它们不存在：

```
mvn deploy:deploy-file -DrepositoryId=libs-release-local -Durl=http://localhost:8080/artifactory/libs-release-local -D
groupId=com.mycompany.app -DartifactId=my-app -Dversion=1.0-SNAPSHOT -Dpackaging=jar -Dfile=target/my-app-1.0-SNAPSHOT.jar

[...]

[INFO]
[INFO] ------------------------------------------------------------------------
[INFO] Building my-app 1.0-SNAPSHOT
[INFO] ------------------------------------------------------------------------
[INFO]
[INFO] --- maven-deploy-plugin:2.7:deploy-file (default-cli) @ my-app ---
Downloading: http://localhost:8080/artifactory/libs-release-local/com/mycompany/app/my-app/1.0-SNAPSHOT/maven-metadata.xml
Uploading: http://localhost:8080/artifactory/libs-release-local/com/mycompany/app/my-app/1.0-SNAPSHOT/my-app-1.0-20130202.014428-1.jar
Uploading: http://localhost:8080/artifactory/libs-release-local/com/mycompany/app/my-app/1.0-SNAPSHOT/my-app-1.0-20130202.014428-1.pom 
```

POM.XML 文件是：

```
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
  <modelVersion>4.0.0</modelVersion>
  <groupId>com.mycompany.app</groupId>
  <artifactId>my-app</artifactId>
  <packaging>jar</packaging>
  <version>1.0-SNAPSHOT</version>
  <name>my-app</name>
  <url>http://maven.apache.org</url>
  <repositories>
                      <repository>
                              <id>central</id>
                      <url>http://localhost:8080/artifactory/libs-release</url>
                      <snapshots>
                              <enabled>false</enabled>
                      </snapshots>
              </repository>
              <repository>
                      <id>snapshots</id>
                      <url>http://localhost:8080/artifactory/libs-snapshot</url>
                      <releases>
                              <enabled>false</enabled>
                      </releases>
              </repository>
      </repositories>
      <pluginRepositories>
              <pluginRepository>
                      <id>central</id>
                      <url>http://localhost:8080/artifactory/plugins-release</url>
                      <snapshots>
                              <enabled>false</enabled>
                      </snapshots>
              </pluginRepository>
              <pluginRepository>
                      <id>snapshots</id>
                      <url>http://localhost:8080/artifactory/plugins-snapshot</url>
                      <releases>
                              <enabled>false</enabled>
                      </releases>
              </pluginRepository>
      </pluginRepositories>

  <dependencies>
    <dependency>
      <groupId>junit</groupId>
      <artifactId>junit</artifactId>
      <version>3.8.1</version>
      <scope>test</scope>
    </dependency>
  </dependencies>
  <distributionManagement>
<repository>
        <id>sademo</id>
        <name>sademo-releases</name>
        <url>http://localhost:8080/artifactory/ext-release-local</url>
    </repository>
    <snapshotRepository>
        <id>sademo</id>
        <name>sademo-snapshots</name>
        <url>http://localhost:8080/artifactory/ext-snapshot-local</url>
    </snapshotRepository>
</distributionManagement>
</project> 
```

settings.xml 文件是：

```
<?xml version="1.0" encoding="UTF-8"?>
<settings xsi:schemaLocation="http://maven.apache.org/SETTINGS/1.0.0         http://maven.apache.org/xsd/settings-1.0.0.xsd" xmlns="http://maven.apache.org/SETTINGS/1.0.0"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <servers>
    <server>
      <username>admin</username>
      <password>password</password>
      <id>sademo</id>
</server>
    <server>
      <username>admin</username>
      <password>password</password>
      <id>sademo-releases</id>
    </server>
  </servers>
  <mirrors>
    <mirror>
      <mirrorOf>*</mirrorOf>
      <name>remote-repos</name>
      <url>http://localhost:8080/artifactory/remote-repos</url>
      <id>remote-repos</id>
    </mirror>
  </mirrors>
  <profiles>
    <profile>
      <repositories>
        <repository>
          <snapshots>
            <enabled>false</enabled>
          </snapshots>
          <id>sademo</id>
          <name>libs-release</name>
          <url>http://localhost:8080/artifactory/libs-release</url>
        </repository>
        <repository>
          <snapshots />
          <id>sademo-snapshots</id>
          <name>libs-snapshot</name>
          <url>http://localhost:8080/artifactory/libs-snapshot</url>
        </repository>
      </repositories>
      <pluginRepositories>
        <pluginRepository>
          <snapshots>
            <enabled>false</enabled>
          </snapshots>
          <id>central</id>
          <name>plugins-release</name>
          <url>http://localhost:8080/artifactory/plugins-release</url>
        </pluginRepository>
        <pluginRepository>
          <snapshots />
          <id>snapshots</id>
          <name>plugins-snapshot</name>
          <url>http://localhost:8080/artifactory/plugins-snapshot</url>
        </pluginRepository>
      </pluginRepositories>
      <id>artifactory</id>
    </profile>
  </profiles>
  <activeProfiles>
    <activeProfile>artifactory</activeProfile>
  </activeProfiles>
</settings> 
```

关于如何获得“mvn clean install”以将 jar 上传到 artifcatory 的任何想法？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-02T08:27:13.067

在行家

```
mvn install 
```

旨在将工件安装到本地存储库中，而**不是**安装到远程存储库中。要将工件上传到远程存储库，您需要说：

```
mvn deploy 
```

mvn deploy 将使用来自 distributionManagement 的条目将工件上传到给定的存储库。

在您的示例中，pom 不应包含存储库的任何配置，因为您已经在 settings.xml 文件中完成了它。

除此之外，您的配置看起来不是 100% 正确，导致消息：

```
Uploading: http://localhost:8080/artifactory/libs-release-local/com/mycompany/app/my-app/1.0-SNAPSHOT/my-app-1.0-20130202.014428-1.jar
Uploading: http://localhost:8080/artifactory/libs-release-local/com/mycompany/app/my-app/1.0-SNAPSHOT/my-app-1.0-20130202.014428-1.pom 
```

显示工件被放入的位置。在这种情况下，libs-release-local 但工件是快照而不是发布。

我会说要更改以下内容：

```
<repository>
  <snapshots />
  <id>sademo-snapshots</id>
  <name>libs-snapshot</name>
  <url>http://localhost:8080/artifactory/libs-snapshot</url>
</repository> 
```

进入：

```
<repository>
  <snapshots>
    <enabled>true</enabled>
  </snapshots>
  <id>sademo-snapshots</id>
  <name>libs-snapshot</name>
  <url>http://localhost:8080/artifactory/libs-snapshot</url>
</repository> 
```

# ruby - 当注入遍历一个范围时，可以使用什么方法来打印变量？

> ID：14657958
> 
> 赞同：0
> 
> 时间：2013-02-02T02:20:53.677
> 
> 标签：ruby, methods, inject, method-chaining

使用方法链接我想修改以下代码，以便在每次迭代时打印变量 mult 和 n。什么方法可以帮助实现这一点？

```
(1..3).inject {|mult, n| mult * n} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-02T02:36:59.640

[Enumerable#tap](http://ruby-doc.org/core-1.9.3/Object.html#method-i-tap)是你需要的

```
(1..3).inject { |mult, n| (mult * n).tap { |next_mult| p [n, mult, next_mult] } } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-02T04:16:34.940

这对我来说看起来比`tap`解决方案更简单。这可能是一个品味问题。

```
(1..3).inject do |mult, n|
  puts "#{mult} #{n}"
  mult * n
end

1 2
2 3
=> 6 
```

为了回答菩提达摩关于迭代次数的另一个问题，[文档](http://www.ruby-doc.org/core-1.9.3/Enumerable.html#method-i-inject)说：

> 如果没有明确指定 memo 的初始值，则使用 collection 的第一个元素作为 memo 的初始值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-02T04:02:37.607

像这样：

```
>> (1..3).inject {|mult, n| r =  mult * n; p "mult = #{mult}, n = #{n}, mult * n = #{r}"; r}
"mult = 1, n = 2, mult * n = 2"
"mult = 2, n = 3, mult * n = 6" 
```

# orchardcms - 如何以多对多关系链接 Orchard CMS 中的两种内容类型？

> ID：14657965
> 
> 赞同：3
> 
> 时间：2013-02-02T02:22:33.360
> 
> 标签：orchardcms, orchardcms-1.6

我正在一个 Orchard 站点上工作，我想在其中记录一些代码 - 一系列插件和每个插件可以处理的一组命令。

所以我希望每个插件都有一个页面，每个可用命令都有一个页面，然后以某种方式将插件与其支持的命令链接起来。

在插件页面上，我想列出该插件支持的所有命令。

相反，在记录每个命令的页面上，我想列出所有支持它的插件。这似乎是一个多对多的关系。

我对创建内容类型很满意，我想我会创建一个“插件”内容类型和一个“命令”内容类型。我希望解决方案会以某种方式涉及查询的使用。不过，我不确定如何将它们联系在一起。

我不确定如何处理这个问题。有没有人对如何实现这一目标有任何建议？有没有办法通过配置和定义新的内容类型来做到这一点，或者你认为我需要编写代码吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-02T03:54:34.503

您可以使用为多个项目配置的内容选择器字段，也可以按照以下文档主题实现它：http: [//docs.orchardproject.net/Documentation/Creating-1-n-and-nn-relations](http://docs.orchardproject.net/Documentation/Creating-1-n-and-n-n-relations)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T09:40:30.060

一个选项是我们的[Mechanics Module](http://gallery.orchardproject.net/List/Modules/Orchard.Module.Downplay.Mechanics)，它为您提供了一种在数据迁移或使用管理 UI 中创建部件之间关系的方法。请参阅[力学文档](http://scienceproject.codeplex.com/wikipage?title=Mechanics)以了解更多信息。

# c - 使用 fgets 从文本文件中填充数组

> ID：14657975
> 
> 赞同：0
> 
> 时间：2013-02-02T02:24:22.327
> 
> 标签：c, file-io

我有这个类程序，我们只需要证明我们可以从文本和二进制文件中读取、写入和填充数组。我没有发布很多二进制文件，但文本文件让我很头疼。

我相信这点代码是罪魁祸首。userInputText[MAXSIZE] 是一个 char 数组（MAXSIZE 定义为 100000），当程序在这一点上时 textCount 和 textCounter 都被初始化为零。

```
textPointer = fopen("textFile.txt", "r");
if (textPointer) 
{
    while (fgets(userInputText, sizeof(userInputText), textPointer) != NULL)
    {
        sscanf(userInputText, "%d", &textCount);
        userInputText[textCounter] = textCount;
        textCounter += 1;
    }
} 
```

当用户第一次运行程序时，这部分程序被跳过，并要求用户创建并写入一个文本文件。用户输入整数并将它们写入文本文件并存储在 userInputText 中，并在程序结束时显示到屏幕上。所有这些工作正常，每次程序运行时都会正确附加文本文件。我已经尝试了上面这段代码中我能想到的所有组合。我尝试使用 fopen(r+)、sizeof(int 和 MAXSIZE)，尝试使用 %d。在程序后面的 fprintf 部分中，我将“\n”设置为分隔符，但我也尝试将其删除。我把 fgets 换成了 fread。我已经到了像狒狒一样向问题扔便便的地步。

我不希望人们认为我很懒惰并寻找一个简单的答案，可能是弱智但不是懒惰。

有什么建议么？

谢谢，

麦克风

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T02:40:13.637

尝试`while( !feof(textPointer) ) { fgets(userInputText,MAXSIZE,textPointer); }`

`sizeof(userInputText)`只会返回 char 指针的大小。

# android - 是否有相当于 iOS 的 identifierForVendor for android？

> ID：14657977
> 
> 赞同：15
> 
> 时间：2013-02-02T02:24:31.923
> 
> 标签：android, uniqueidentifier

在 iOS 6 中，[UIDevice currentDevice].identifierForVendor 为来自单个供应商的所有应用程序提供唯一 ID。

有没有办法在 Android 中做同样的事情？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-02T02:29:30.813

有Android Id：
[Generating Device-Specific Serial Number](https://stackoverflow.com/questions/3464881/generating-device-specific-serial-number/13839341#13839341)

请注意，Android 的设计使您无法自动获取完整的设备 ID。Android 甚至[修改了 linux 的一个预先存在的部分，](http://developer.android.com/guide/topics/security/permissions.html#userid)这将使这成为可能。

甚至比 Android id 更好：您的应用可以请求 AUTHENTICATE_ACCOUNTS 权限。然后你就知道了用户的 Google id。这将在用户使用的所有应用程序和手机中通用。

# c++ - 在 C++ 中使用字符串的 getline 返回错误：没有重载函数 getline 的实例与参数列表匹配

> ID：14657979
> 
> 赞同：1
> 
> 时间：2013-02-02T02:24:36.510
> 
> 标签：c++, getline

我正在尝试使用 getline 解析文档以获取整行并将其放在名为“line”的字符串变量中。问题是我收到一条错误消息：“没有重载函数 getline 的实例与参数列表匹配。” 谁能帮我解决这个问题？

```
#include <iostream>
#include <fstream>
#include <string>
#include "recordsOffice.h"

using namespace std;

RecordsOffice::RecordsOffice()
{

}

void RecordsOffice::parseCommands (string commandsFileName)
{
//String to hold a line from the file
string line;

//Open the file
ifstream myFile;
myFile.open(commandsFileName);

// Check to make sure the file opened properly
if (!myFile.is_open())
{
    cout << "There was an error opening " << commandsFileName << "." << endl;
    return;
}

//Parse the document
while (getline(myFile, line, '/n'))
{
    if (line[0] == 'A')
    {
        addStudent(line);
    } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-02T02:26:57.347

您的转义序列向后 - 尝试替换

```
/n 
```

和

```
\n 
```

C++ 中的多字符字符自由具有 type `int`，而不是 type `char`，这导致参数`std::getline`具有错误的类型。（感谢@chris 指出该类型将是`int`具体的！）

希望这可以帮助！

# javascript - 虚拟表上的 SQlite 计数查询始终为 1

> ID：14657981
> 
> 赞同：0
> 
> 时间：2013-02-02T02:24:55.927
> 
> 标签：javascript, sqlite, fts3

我在 sqlite 中有一个虚拟表，我正在对它运行查询以查找关键字匹配，但计数始终为 1。结构如下。

```
var insertStatement2 = "INSERT INTO pagesfts3 (url,content) VALUES (?, ?)";
var createStatement2 = "CREATE VIRTUAL TABLE pagesfts3 USING fts3 (url VARCHAR,content TEXT)";
var selectStatement2 = "SELECT COUNT(*),url FROM pagesfts3 WHERE content MATCH ? GROUP BY url";

                try {
                      var db = openDatabase("search", "1.0", "search engine", 200000);
                      db.transaction(function(tx) {
                            //for example use drop table on each load
                            tx.executeSql(dropStatement, [], null, onError);
                            tx.executeSql(dropStatement2, [], null, onError);

                            tx.executeSql(createStatement, [], null, onError);
                            tx.executeSql(createStatement2, [], null, onError);

                      });

                      db.transaction(function(tx) {

                      });
                }
                catch (error) {
                      $('body').prepend('<div class="alert alert-danger">This script requires a SQlite compatible browser<br/> try Safari 4, iOS OS3, Chrome 5, or Opera 10.5</div>');
                }
                function onError(tx, error) {
                      alert(error.message);
                } 
```

所以基本上我保存了一个网页数据及其相应的 url。当我去查询页面时，我运行这个

```
 var query = $('#query').val().toLowerCase();
                          var searchResults = $('#queryResult');
                          searchResults.html('');
                          db.transaction(function(tx) {
                                //run static select statment 2 on the virtual table
                                tx.executeSql(selectStatement2, [query], function(tx, result) {

                                      var dataset = result.rows;
                                      if (dataset.length > 0) {
                                            for (var i = 0, item = null; i < dataset.length; i++) {

                                                  item = dataset.item(i);
                                                  console.debug(item);
                                                  var url = item['url'];
                                                  var count = item['COUNT(*)'];

                                                  var str = '<p><a href="' + url + '">' + url + '</a> has the word <b>' + query + '</b></p>';

                                                  searchResults.append(str);

                                            }
                                      }else{
                                       searchResults.append('no results');
                                      }
                                });
                          }); 
```

但是列计数（*）始终为 1，即使我知道它们的关键字出现超过 1 次。我对虚拟表不太熟悉，所以也许我遗漏了一些东西。

# c# - 从 UDP Socket 接收并发送回数据

> ID：14657984
> 
> 赞同：3
> 
> 时间：2013-02-02T02:25:41.093
> 
> 标签：c#, sockets, udp

我正在尝试编写一个接受请求（大小为 18 字节）的控制台应用程序，然后将某些内容（大小为 7 字节）发送回客户端。我这辈子似乎无法让它发挥作用。我可以很好地接收数据，但我发回的数据永远不会到达客户端。

这是我的代码

```
 static void Main(string[] args)
 {
        // Data to return
        byte[] ret = { 0xfe, 0xfd, 0x09, 0x00, 0x00, 0x00, 0x00 };

        // tell the user that we are waiting
        Console.WriteLine("Waiting for UDP Connection...");

        // Create a new socket to listen from
        Socket Skt = new Socket(AddressFamily.InterNetwork, SocketType.Dgram, ProtocolType.Udp);
        Skt.EnableBroadcast = true;
        Skt.Bind(new IPEndPoint(IPAddress.Loopback, 27900));

        try
        {
            // Blocks until a message returns on this socket from a remote host.
            Byte[] receiveBytes = new byte[48];
            IPEndPoint sender = new IPEndPoint(IPAddress.Any, 0);
            EndPoint senderRemote = (EndPoint)sender;

            Skt.ReceiveFrom(receiveBytes, ref senderRemote);
            string returnData = Encoding.UTF8.GetString(receiveBytes).Trim();

            Console.WriteLine("This is the message you received " + returnData.ToString());

            // Sent return data
            int sent = Skt.SendTo(ret, senderRemote);
            Console.WriteLine("Sent {0} bytes back", sent);
            Skt.Close();
        }
        catch (Exception e)
        {
            Console.WriteLine(e.ToString());
        }

        Console.ReadLine();
    } 
```

有人请给我一些指点吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T02:43:58.370

这是我修改的示例代码，您可以看到您可以从此示例接收和发送。Method Test 充当客户端，它可以是一个不同的过程，现在我已经在不同的线程中进行了模拟。

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Net.Sockets;
using System.Net;
using System.Threading;

namespace ConsoleApplication1
{
    class Program
    {
        static void Main(string[] args)
        {
            // Data to return
        byte[] ret = { 0xfe, 0xfd, 0x09, 0x00, 0x00, 0x00, 0x00 };

        // tell the user that we are waiting
        Console.WriteLine("Waiting for UDP Connection...");

        // Create a new socket to listen from
        Socket Skt = new Socket(AddressFamily.InterNetwork, SocketType.Dgram, ProtocolType.Udp);
        Skt.EnableBroadcast = true;
        Skt.Bind(new IPEndPoint(IPAddress.Loopback, 27900));

        try
        {
            // Blocks until a message returns on this socket from a remote host.
            Byte[] receiveBytes = new byte[48];
            IPEndPoint sender = new IPEndPoint(IPAddress.Any, 0);
            EndPoint senderRemote = (EndPoint)sender;

            Thread thr = new Thread(new ThreadStart(Test));
            thr.Start();
            Skt.ReceiveFrom(receiveBytes, ref senderRemote);
            string returnData = Encoding.UTF8.GetString(receiveBytes).Trim();

            Console.WriteLine("This is the message you received " + returnData.ToString());

            // Sent return data
            int sent = Skt.SendTo(ret, senderRemote);
            Console.WriteLine("Sent {0} bytes back", sent);
            Skt.Close();
        }
        catch (Exception e)
        {
            Console.WriteLine(e.ToString());
        }

        Console.ReadLine();

        }

        public static void Test()
        {
            byte[] ret = { 0xfe, 0xfd, 0x09, 0x00, 0x00, 0x00, 0x00 };
            Socket Skt = new Socket(AddressFamily.InterNetwork, SocketType.Dgram, ProtocolType.Udp);
            Skt.EnableBroadcast = true;
            IPEndPoint test=new IPEndPoint(IPAddress.Loopback, 27900);

            int sent = Skt.SendTo(ret, test);
            try
            {
                // Blocks until a message returns on this socket from a remote host.
                Byte[] receiveBytes = new byte[48];
                IPEndPoint sender = new IPEndPoint(IPAddress.Any, 0);
                EndPoint senderRemote = (EndPoint)sender;

                Skt.ReceiveFrom(receiveBytes, ref senderRemote);
                string returnData = Encoding.UTF8.GetString(receiveBytes).Trim();

                Console.WriteLine("This is the message you received " + returnData.ToString());

                // Sent return data
                //int sent = Skt.SendTo(ret, senderRemote);
                Console.WriteLine("Sent {0} bytes back", sent);
                Skt.Close();

            }
            catch (Exception ex)
            {
            }
        }

    }
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-02T12:25:29.333

如果不查看您的客户端代码，就很难确定问题可能出在哪里。不过，我可以使用[网络库](http://www.networkcomms.net)networkcomms.net 为您提供一个可行的解决方案。服务器的代码如下：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

using NetworkCommsDotNet;

namespace UPDServer
{
    class Program
    {
        static void Main(string[] args)
        {
            NetworkComms.AppendGlobalIncomingPacketHandler<string>("Message", (packetHeader, connection, incomingString) => 
            {
                Console.WriteLine("This is the message you received " + incomingString);
                connection.SendObject("Message", incomingString + " relayed by server.");
            });

            UDPConnection.StartListening(true);

            Console.WriteLine("Server ready. Press any key to shutdown server.");
            Console.ReadKey(true);
            NetworkComms.Shutdown();
        }
    }
} 
```

对于客户：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

using NetworkCommsDotNet;

namespace UDPClient
{
    class Program
    {
        static void Main(string[] args)
        {
            string messageToSend = "This is a message To Send";
            string messageFromServer = UDPConnection.GetConnection(new ConnectionInfo("127.0.0.1", 10000), UDPOptions.None).SendReceiveObject<string>("Message", "Message", 2000, messageToSend);
            Console.WriteLine("Server said '{0}'.", messageFromServer);

            Console.WriteLine("Press any key to exit.");
            Console.ReadKey(true);
            NetworkComms.Shutdown();
        }
    }
} 
```

您显然需要从网站下载 NetworkCommsDotNet DLL，以便可以将其添加到“使用 NetworkCommsDotNet”参考中。另请参阅客户端示例中的服务器 IP 地址当前为“127.0.0.1”，如果您在同一台机器上同时运行服务器和客户端，这应该可以工作。有关更多信息，请查看[入门](http://www.networkcomms.net/getting-started/)或[如何创建客户端服务器应用程序](http://www.networkcomms.net/how-to-create-a-client-server-application-in-minutes/)文章。

# jpa - EclipseLink 批量获取错误 - NullPointerException

> ID：14657986
> 
> 赞同：0
> 
> 时间：2013-02-02T02:26:08.643
> 
> 标签：jpa, eclipselink

EclipseLink 2.3.0 - 2.3.2 上的相同问题，但来自 2.3.0 的堆栈跟踪

遇到批处理 fetch 和 fetch join 不能很好地相互配合的问题。我有一个像这样的查询

```
select obj from Parent
   left join fetch obj.elementCollection 
```

带有提示`eclipselink.batch = obj.oneToMany`和`eclipselink.batch.type = IN`.

在`Parent`对象中，有 an`@ElementCollection`和 a `@OneToMany`，其中`@OneToMany`是批量获取的，而`@ElementCollection`是连接的（批量获取似乎没有效果）。

它因以下错误而中断；将批处理类型从更改`IN`为`EXISTS`使其工作。

```
java.lang.NullPointerException
   at org.eclipse.persistence.mappings.OneToOneMapping.extractBatchKeyFromRow(OneToOneMapping.java:624)
   at org.eclipse.persistence.mappings.ForeignReferenceMapping.extractResultFromBatchQuery(ForeignReferenceMapping.java:524)
   at org.eclipse.persistence.internal.indirection.NoIndirectionPolicy.valueFromBatchQuery(NoIndirectionPolicy.java:294)
   at org.eclipse.persistence.mappings.ForeignReferenceMapping.batchedValueFromRow(ForeignReferenceMapping.java:215) 
```

任何想法 - 我做错了什么还是这是一个错误？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T14:53:16.577

请尝试 2​​.4 版本，如果错误仍然存​​在，请记录错误。

您也应该能够批量获取元素集合。如果不能，请使用测试用例记录错误。

# facebook-ios-sdk - 用户更改密码后 Facebook iOS SDK 不会打开登录 UI (iOS 6)

> ID：14657989
> 
> 赞同：10
> 
> 时间：2013-02-02T02:26:49.567
> 
> 标签：facebook-ios-sdk

一些背景：用户之前安装了应用程序，授权 FB，一切正常，然后他们更改了他们的 FB 密码（通过 facebook.com），删除了应用程序，现在重新安装并再次运行它重新安装。

我正在打电话`[FBSession openActiveSessionWithReadPermissions:allowLoginUI:completionHandler]`，`allowLoginUI: YES`读取权限是“email、user_about_me、user_birthday、user_interests、user_location”。

`FBSessionState`我进入的`completionHandler`是`FBSessionStateClosedLoginFailed`。错误的 NSLog 是这样的：

> 错误域=com.facebook.sdk 代码=2“操作无法完成。（com.facebook.sdk 错误 2。）”UserInfo=0x1cd68c00 {com.facebook.sdk:ErrorLoginFailedReason=com.facebook.sdk:ErrorLoginFailedReason , com.facebook.sdk:ErrorInnerErrorKey=Error Domain=com.apple.accounts Code=7 "Facebook 服务器无法完成此访问请求：验证访问令牌时出错：由于用户更改了密码，会话已失效。" UserInfo=0x1cd5b970 {NSLocalizedDescription=Facebook 服务器无法完成此访问请求：验证访问令牌时出错：由于用户更改了密码，会话已失效。}}

那个内部错误域是`ACErrorDomain`和错误代码`ACErrorPermissionDenied`。那么，如何让用户重新授权应用呢？

我已经尝试`openActiveSessionWithReadPermissions`再次调用，但只是不断输出相同的错误。我也尝试过`[FBSession.activeSession closeAndClearTokenInformation]`，但这似乎没有任何作用（大概是因为没有`activeSession`）。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-04-03T19:33:21.833

使用 3.2.1 Facebook SDK 遇到了非常相似的错误。就我而言，我进入了 FBSessionStateOpen 但获得了无效的访问令牌。正如问题所述，正常的 closeAndClearTokenInformation 甚至删除应用程序都无法修复它。在这种情况下，我能够重新加入的唯一方法是让用户在设置应用程序中更改他们的密码。所以这就是我所做的。

```
// In my completion handler FBSessionStateOpen is called BUT an
// invalid accessToken was detected.

[session closeAndClearTokenInformation];
[FBSession renewSystemCredentials:^(ACAccountCredentialRenewResult result, 
                                    NSError *error) 
  {
     if (result == ACAccountCredentialRenewResultFailed ||
         result == ACAccountCredentialRenewResultRejected)
     {
       [self showErrorMessage:NSLocalizedString(@"You may need to re-enter your Facebook password in the iPhone Settings App.\n", nil)];
     }
     else 
     {
        // attempt opening a session again  (after they have updated their account 
        // settings I end up here)

        [self facebookLogin];  // Performs openActiveSessionWithReadPermissions, 
                               // but this time around the token issued should be good.
     }
 }]; 
```

这是我能想到的唯一务实的解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T02:11:38.263

我认为您需要使用这样的代码获取新的访问令牌...

```
[FBSession.activeSession closeAndClearTokenInformation];
[[FBSession class] performSelector:@selector(renewSystemAuthorization)];
[FBSession openActiveSessionWithReadPermissions:nil
                               allowLoginUI:YES
                          completionHandler:^(FBSession *session, FBSessionState state, NSError *error) {

} 
```

# java - 从文件中读取并在 Java 中拆分数据

> ID：14657997
> 
> 赞同：0
> 
> 时间：2013-02-02T02:28:25.877
> 
> 标签：java, data-structures, split, fileinputstream

我正在尝试从 .txt 文件中读取数据。格式如下所示：

```
 ABC, John, 123
 DEF, Mark, 456
 GHI, Mary, 789 
```

我正在尝试摆脱逗号并将数据放入数组或结构（最有可能是结构）中。

这是我用来提取每个项目的代码：

```
package prerequisiteChecker;

import java.util.*;
import java.io.*;

public class TestUnit {

    public static void main(String[]args){      
        try {
            FileInputStream fstream = new FileInputStream("courses.txt");
            DataInputStream in = new DataInputStream(fstream);
            BufferedReader br = new BufferedReader(new InputStreamReader(in));
            String strLine;

            while ((strLine = br.readLine()) != null) {
                String[] splitOut = strLine.split(", ");
                for (String token : splitOut)
                    System.out.println(token);
            }
            in.close();
        } catch (Exception e){
            System.err.println("Error: " + e.getMessage());
        }
    }

} 
```

有一次，我在“while”循环中有一条打印线，以查看项目是否会被拆分。他们是。现在我只是不知道下一步该做什么。我试图将每个分组放入一个结构中。例如：ID - ABC。名字 - 约翰。房间 - 123。

我在家里有几本关于 Java 的书，并尝试在网上四处寻找。那里有很多东西，但似乎没有一个能引导我朝着正确的方向前进。

谢谢。

迈克尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T06:03:08.347

我会创建一个很好的结构来存储您的信息。我不确定您是否想如何访问数据，但这是一个很好的例子。我会离开你之前放的东西。请注意，我只公开了变量，因为它们是最终的。一旦您完成课程，它们就无法更改。如果您希望课程可变，请创建 getter 和 setter 并将实例变量更改为私有。之后，您可以使用该列表检索您想要的任何课程。

```
package prerequisiteChecker;

import java.util.*;
import java.io.*;

public class TestUnit {

    public static void main(String[] args) {
        try {
            FileInputStream fstream = new FileInputStream("courses.txt");
                    // use DataInputStream to read binary NOT text
            // DataInputStream in = new DataInputStream(fstream);
            BufferedReader br = new BufferedReader(new InputStreamReader(fstream));
            String strLine;
            List<Course> courses = new LinkedList<Course>();
            while ((strLine = br.readLine()) != null) {
                String[] splitOut = strLine.split(", ");
                if (splitOut.length == 3) {
                    courses.add(new Course(splitOut[0], splitOut[1],
                            splitOut[2]));
                } else {
                    System.out.println("Invalid class: " + strLine);
                }
            }
            in.close();
        } catch (Exception e) {
            System.err.println("Error: " + e.getMessage());
        }
    }

    public static class Course {
        public final String _id;
        public final String _name;
        public final String _room;

        public Course(String id, String name, String room) {
            _id = id;
            _name = name;
            _room = room;
        }

    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T02:43:03.303

创建一个看起来像这样的类：

```
class structure {
    public String data1;
    public String data2;
    public String data3;
} 
```

这将形成您的基本数据结构，您可以使用它来保存您在问题中提到的那种数据。现在，您可能想要遵循正确的面向对象方法，例如将所有字段声明为私有，以及编写 getter 和 setter。你可以在这里找到更多... [http://java.dzone.com/articles/getter-setter-use-or-not-use-0](http://java.dzone.com/articles/getter-setter-use-or-not-use-0)

现在，就在您的 while 循环之外，像这样创建一个 ArrayList：`ArrayList<structure> list = new ArrayList<structure>();`这将用于保存您将解析的所有不同的数据行。

现在，在你的 while 循环中做这样的事情：

```
structure item = new structure();//create a new instance for each row in the text file.
item.data1 = splitOut[0];
item.data2 = splitOut[1];
item.data3 = splitOut[2];
list.add(item); 
```

这基本上会将您在每一行中解析的数据放入您声明的数据结构中，方法是为每个解析的新行创建一个新实例。最后，使用`list.add(item)`上面所示的代码中的 ArrayList 将该数据项插入到 ArrayList 中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-04-15T17:47:22.937

```
public class File_ReaderWriter {
    private static class Structure{
        public String data;
    }

    public static void main(String[] args) throws IOException{

        String allDataString;
        FileInputStream  fileReader = new FileInputStream ("read_data_file.txt");
        DataInputStream in = new DataInputStream(fileReader);  
        BufferedReader bufferReader = new BufferedReader(new InputStreamReader(in));
        String[] arrayString = {"ID - ", " NAME - ", " ROOM - "};
        int recordNumber = 0;

        Structure[] structure = new Structure[10];

        for (int i = 0; i < 10; i++)
            structure[i] = new Structure();

        while((allDataString = bufferReader.readLine()) != null){
            String[] splitOut = allDataString.split(", ");
            structure[recordNumber].data = "";
            for (int i = 0; i < arrayString.length; i++){
                structure[recordNumber].data += arrayString[i] + splitOut[i];
            }
            recordNumber++;
        }

        bufferReader.close();

        for (int i = 0; i < recordNumber; i++){
                System.out.println(structure[i].data);

        }
    }

} 
```

我修改了您给定的代码。有用。试试看，如果有任何疑问，请询问。

# android - Android 圆圈弹跳动画

> ID：14657999
> 
> 赞同：1
> 
> 时间：2013-02-02T02:28:43.617
> 
> 标签：android, android-animation

我有一个想要反弹的圆圈，所以它会在宽度上扩大，在高度上塌陷，然后反过来，同样的几次。这一切都适用于连续的几个 ScaleAnimations。问题是，我希望 pivotY 成为视图的底部。在这种情况下，每次新动画开始时，它都会将枢轴点重置为中心。这是我的代码：

```
 bounceAnimationPartOne = new ScaleAnimation(1.0f, 1.0f, 1.62f, 0.62f, Animation.RELATIVE_TO_SELF, 0.5f, Animation.RELATIVE_TO_SELF, 1.0f);
    bounceAnimationPartOne.setDuration(45);
    bounceAnimationPartOne.setAnimationListener(new Animation.AnimationListener() {
        @Override
        public void onAnimationStart(Animation animation) {
        }

        @Override
        public void onAnimationEnd(Animation animation) {
            view.startAnimation(bounceAnimationPartTwo);
        }

        @Override
        public void onAnimationRepeat(Animation animation) {
        }
    });

    bounceAnimationPartTwo = new ScaleAnimation(1.62f, 0.62f, 0.76f, 1.3f, Animation.RELATIVE_TO_SELF, 0.5f, Animation.RELATIVE_TO_SELF, 1.0f);
    bounceAnimationPartTwo.setDuration(90);
    bounceAnimationPartTwo.setAnimationListener(new Animation.AnimationListener() {
        @Override
        public void onAnimationStart(Animation animation) {

        }

        @Override
        public void onAnimationEnd(Animation animation) {
            view.startAnimation(bounceAnimationPartThree);
        }

        @Override
        public void onAnimationRepeat(Animation animation) {
        }
    });

    bounceAnimationPartThree = new ScaleAnimation(0.76f, 1.3f, 1.23f, 0.81f, Animation.RELATIVE_TO_SELF, 0.5f, Animation.RELATIVE_TO_SELF, 1.0f);
    bounceAnimationPartThree.setDuration(105);
    bounceAnimationPartThree.setAnimationListener(new Animation.AnimationListener() {
        @Override
        public void onAnimationStart(Animation animation) {

        }

        @Override
        public void onAnimationEnd(Animation animation) {
            view.startAnimation(bounceAnimationPartFour);
        }

        @Override
        public void onAnimationRepeat(Animation animation) {
        }
    });

    bounceAnimationPartFour = new ScaleAnimation(1.23f, 0.81f, 1.0f, 1.0f, Animation.RELATIVE_TO_SELF, 0.5f, Animation.RELATIVE_TO_SELF, 1.0f);
    bounceAnimationPartFour.setDuration(60); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T07:27:10.193

我最终编写了自己的自定义动画，基本上连续执行 4 个比例动画：

```
public class BounceAnimation extends Animation {
    private final List<Float> expansionValuesX;
    private final List<Float> expansionValuesY;
    private final List<Float> timing;

    private int currentTimingIndex;
    private float currentTimingSum;

    private float pivotX;
    private float pivotY;

    public BounceAnimation(List<Float> expansionValuesX, List<Float> expansionValuesY, List<Float> timing, int duration) {
        this.expansionValuesX = expansionValuesX;
        this.expansionValuesY = expansionValuesY;
        this.timing = timing;

        setDuration(duration);
    }

    @Override
    protected void applyTransformation(float interpolatedTime, Transformation t) {
        float sx = 1.0f;
        float sy = 1.0f;

        if (currentTimingIndex < timing.size() - 1 && interpolatedTime >= currentTimingSum + timing.get(currentTimingIndex)) {
            currentTimingSum += timing.get(currentTimingIndex);
            currentTimingIndex++;
        }

        float currentFromX = expansionValuesX.get(currentTimingIndex);
        float currentFromY = expansionValuesY.get(currentTimingIndex);
        float currentToX = expansionValuesX.get(currentTimingIndex + 1);
        float currentToY = expansionValuesY.get(currentTimingIndex + 1);

        float currentInterpolatedTime = (interpolatedTime - currentTimingSum) / timing.get(currentTimingIndex);

        if (currentFromX != 1.0f || currentToX != 1.0f) {
            sx = currentFromX + ((currentToX - currentFromX) * currentInterpolatedTime);
        }
        if (currentFromY != 1.0f || currentToY != 1.0f) {
            sy = currentFromY + ((currentToY - currentFromY) * currentInterpolatedTime);
        }

        if (pivotX == 0 && pivotY == 0) {
            t.getMatrix().setScale(sx, sy);
        } else {
            t.getMatrix().setScale(sx, sy, pivotX, pivotY);
        }
    }

    @Override
    public void initialize(int width, int height, int parentWidth, int parentHeight) {
        super.initialize(width, height, parentWidth, parentHeight);

        pivotX = resolveSize(Animation.RELATIVE_TO_SELF, 0.5f, width, parentWidth);
        pivotY = resolveSize(Animation.RELATIVE_TO_SELF, 1.0f, height, parentHeight);

        currentTimingIndex = 0;
        currentTimingSum = 0;
    }

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T02:45:18.483

仅仅因为你为某些东西设置了动画并不意味着你已经改变了它（参见[前面的讨论](https://stackoverflow.com/a/3883428/1337257)）。

在开始另一个动画之前，您可能需要修改该`onAnimationEnd()`方法以使动画效果永久化。

或者，使用[AnimationSet](http://developer.android.com/reference/android/view/animation/AnimationSet.html)并为集合中的第二个和第三个动画设置 startOffset。或者，更简单的是，使用 AnimatorSet.Builder。