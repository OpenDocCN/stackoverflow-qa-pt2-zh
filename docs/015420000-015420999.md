# StackOverflow 问答 15420000-15420999

# windows - 编写带有连字符参数的批处理文件

> ID：15420004
> 
> 赞同：0
> 
> 时间：2013-03-14T20:55:43.870
> 
> 标签：windows, batch-file, command-line-arguments

我需要编写一个批处理脚本，我们称之为script.bat。我希望它有选项，我们称它们为选项 1 和选项 2。就像我们随处可见的著名的 --help 一样。

根据用户的需要，我希望以下 4 行成为启动脚本的 4 个可能命令：

```
script.bat -option1 value1 -option2 value2
script.bat -option2 value2 -option1 value1
script.bat -option1 value1 
script.bat -option2 value2 
```

现在开始脚本编码：我想要一种处理选项读取的巧妙方法。我知道参数读数（程序名称为 %0，参数 1 为 %1 等）。但这不是很灵活，因为选项，顾名思义，可以是可选的并且可以任意顺序（参见代码块第 2 行的上述命令）。

你们会怎么做呢？

谢谢 ！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-14T21:10:31.777

不是 100% 你所追求的，但怎么样：

```
@echo off

setlocal

set OPTION1=
set OPTION2=
set OPTION3=

:ARGS_LOOP
if {%1} == {} goto END_OF_ARGS
set ARG=%1

if /i "%ARG:~0,9%" == "/OPTION1:" set OPTION1=%ARG:~9%
if /i "%ARG:~0,9%" == "/OPTION2:" set OPTION2=%ARG:~9%
if /i "%ARG:~0,9%" == "/OPTION3:" set OPTION3=%ARG:~9%

shift

goto ARGS_LOOP

:END_OF_ARGS

echo Option 1 was set to [%OPTION1%]
echo Option 2 was set to [%OPTION2%]
echo Option 3 was set to [%OPTION3%]

endlocal 
```

例如，这可以保存为 TEST.CMD，然后运行如下：

TEST.CMD /option1:xxx /option2:yyy

等等。命令行中指定的选项顺序无关紧要。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-15T01:02:10.203

```
@ECHO OFF
SETLOCAL
SET options=option1 option2 anotheroption
SET switches=switch1 switch2 anotherswitch
CALL :readoptions %*
FOR %%i IN (%options% %switches% badoptions) DO IF DEFINED %%i (SET %%i) ELSE (ECHO %%i NOT set)
GOTO :eof

:readoptions
FOR %%i IN (%options% %switches% badoptions) DO (SET %%i=)
:optlp
SET _parm1=%1
IF NOT DEFINED _parm1 GOTO :EOF
FOR %%i IN (%switches%) DO IF %_parm1%==-%%i SET %%i=Y&(SET _parm1=)
IF NOT DEFINED _parm1 shift&GOTO :optlp
FOR %%i IN (%options%) DO IF %_parm1%==-%%i (
SET %%i=%2
IF DEFINED %%i shift&shift&(SET _parm1=)
)
IF DEFINED _parm1 SET badoptions=%badoptions% %1&SHIFT
GOTO :optlp 
```

如果您想要 /options 或 /switches，更改应该很明显

对于任何一组开关，将开关名称放在 er 中，`switches`类似的选项名称放在`options`. 如果`-switchname`在命令行中找到，则将变量`switchname`设置为 Y，否则不设置。同样，如果`-optionname`找到则将后面的参数设置为变量的值`optionname`，否则`optionname`不设置。

任何既不是指定的 switchname 也不是 optionname 或 optionvalue 的参数都将被收集到`badoptions`

所以 - 使用如图所示的一组选项和开关，命令

```
thisbatch -switch2 -option2 optionvalue -invalid 
```

将清除变量`option1`,`anotheroption`和`switch1`; `anotherswitch`设置`switch2`= **Y** ; 设置`option2`= **optionvalue**和`badoptions`= **-invalid**

# ruby-on-rails - Rails在模块中缓存Time.zone.now？

> ID：15420006
> 
> 赞同：1
> 
> 时间：2013-03-14T20:55:50.463
> 
> 标签：ruby-on-rails

我有一个奇怪的错误，生产中的范围不能反映当前时间。

```
module TimeFilter
  # Provides scopes to filter results based on time.
  def self.included(base)
    base.extend(ClassMethods)
    base.class_eval do
      scope :today, where(end_time: Time.zone.now.midnight..Time.zone.now)
      scope :this_week, where(end_time: Time.zone.now.beginning_of_week..Time.zone.now)
      scope :this_month, where(end_time: Time.zone.now.beginning_of_month..Time.zone.now)
      scope :older_than_this_month, where("end_time < ?", Time.zone.now.beginning_of_month)
      scope :last_month, where(end_time: Time.zone.now.beginning_of_month..Time.zone.now.beginning_of_month - 1.month)
    end
  end
end 
```

Time.zone.now 似乎与 rails 控制台中的时间相同。

如果我将范围从库中移到我的模型中，它可以正常工作。难道我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T21:02:51.350

是的，您的范围正在评估一次，在`class_eval`. 要更正此问题，请为您的范围使用 lambda，如下所示：

```
 scope :today, lambda {where(end_time: Time.zone.now.midnight..Time.zone.now)}
  scope :this_week, lambda {where(end_time: Time.zone.now.beginning_of_week..Time.zone.now)}
  scope :this_month, lambda {where(end_time: Time.zone.now.beginning_of_month..Time.zone.now)}
  scope :older_than_this_month, lambda {where("end_time < ?", Time.zone.now.beginning_of_month)}
  scope :last_month, lambda {where(end_time: Time.zone.now.beginning_of_month..Time.zone.now.beginning_of_month - 1.month)} 
```

这将导致时间在调用实际范围时进行评估，而不是在调用 eval 时进行评估。

# sql-server-2008 - 将 csv 文件的问题导入 SQL Server 2008 表

> ID：15420008
> 
> 赞同：0
> 
> 时间：2013-03-14T20:55:56.303
> 
> 标签：sql-server-2008, ssis, sql-import-wizard

我正在使用 SQL Server 导入和导出向导从 csv 文件导入数据以附加到我已经存在的 SQL Server 表中。

因此，要将 csv 文件中的数据附加到我的 SQL Server 表中，在`Choose a Data Source`窗口中，我要确保 csv 数据源中的每一列都具有与我的 SQL Server 表列相同的数据类型。

但是，我在进行导入时总是会出错。

> *错误 0xc02020a1：数据流任务 1：数据转换失败。列“成熟度（小时）”的数据转换返回状态值 2 和状态文本“由于可能丢失数据，无法转换该值。”。（SQL Server 导入和导出向导）*
> 
> *错误 0xc0209029：数据流任务 1：SSIS 错误代码 DTS_E_INDUCEDTRANSFORMFAILUREONERROR。“输出列“成熟度（小时）”（42）失败，因为发生了错误代码 0xC0209084，并且“输出列“成熟度（小时）”（42）上的错误行处置指定错误失败。指定组件的指定对象发生错误。在此之前可能会发布错误消息，其中包含有关失败的更多信息。（SQL Server 导入和导出向导）*

我的 SQL Server 表有`Maturity`（小时）作为`int`数据类型。

对于我的 csv 文件，在 SQL Server 导出/导入向导中，我选择`DT_I4`了`Maturity`（小时），这相当于 SQL Server 中的 int 数据类型。在过去的 3 个小时里，我仍然无法摆脱这个错误。

有关如何解决此问题的任何线索？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T10:05:39.197

如果任何字段有任何逗号，只需查看 csv 文件（如果您使用逗号作为列分隔符或双引号（如果您使用双引号作为文本限定符）。您的问题应该属于上述两种情况。

注意：我将此作为答案，因为我无法评论您的问题。

# php - PHP MYSQL 日期格式输出零

> ID：15420011
> 
> 赞同：1
> 
> 时间：2013-03-14T20:56:06.843
> 
> 标签：php, mysql, variables, date

这个变量被插入到我的`mysql`数据库中：

```
$n_date = date('d-m-Y'); 
```

在数据库中我总是看到这个：

`0000-00-00 00:00:00`

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-14T20:57:45.777

因为你的格式不对。MySQL 期望日期为`YYYY-MM-DD`格式。所以：

```
$n_date = date('d-m-Y'); 
```

应该

```
$n_date = date('Y-m-d'); 
```

或者，为了完整性：

```
$n_date = date('Y-m-d H:i:s'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-14T20:58:07.000

您需要将日期格式化为 yyyy-mm-dd 以插入 MySQL。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-14T20:59:32.587

你的格式不正确。为什么不只是`INSERT` `NOW()`？

```
INSERT INTO tbl (dateCol) VALUES (NOW()) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-14T20:58:26.160

```
$n_date = date('YYYY-mm-dd hh:ii:ss'); 
```

那样插入。

# c - 尝试将两个浮点数相除时，Xcode 会自动转到 lldb

> ID：15420015
> 
> 赞同：-1
> 
> 时间：2013-03-14T20:56:14.657
> 
> 标签：c, division, lldb

我有一个用 C 编写的程序，在 Xcode 4.6 中运行，其中一个函数根据用户输入将两个浮点数相除。出于某种原因，当我尝试以正确的顺序进行除法（代码示例 1）时，程序会暂停并以看似无休止的循环打开`lldb`调试器，并且当我尝试反转除法时，结果始终为零（代码示例 2）。

示例 1 代码：

```
float num2, num1;
int main() {
    scanf("%f",&num1);
    scanf("%f",&num2);

    num2 = num1/num2;

    printf("%f",num2);
} 
```

样本 1 输出：

```
4
2      // user inputs calculation

(lldb)   // program keeps printing this indefinitely 
```

示例 2 代码：

```
float num2, num2
int main() {
    scanf("%f",&num1);
    scanf("%f",&num2);

    num2 = num2/num1;

    printf("%f",num2);
} 
```

样本 2 输出：

```
4
2        // user inputs calculation

0        // since calculation is inverted, input was interpreted as 2/4, but rather than returning 0.5, the program returns 0. 
```

不知道为什么会发生这种情况，或者如何解决它。这里的任何人都有类似的问题并找到了解决方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T20:58:09.957

请不要再说一遍……这是C，不是C++。您需要将指向变量的指针作为参数传递`scanf()`，以便它能够修改（即写入）它们：

```
scanf("%f", &num1);
            ^
          This! 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T08:57:10.820

您看不到示例 1 中的输出的原因是您在字符串末尾`printf`缺少添加新行的 。`\n`在该行完成之前，lldb 不会向您打印该输出。

# jquery - anySlider - 字幕不再动画

> ID：15420016
> 
> 赞同：0
> 
> 时间：2013-03-14T20:56:15.980
> 
> 标签：jquery, anythingslider

我已经开始将anythingSlider 蒙皮、配置和实现到一个jsFiddle 项目中，我注意到一旦我实现了缩略图/滑块系统，我的字幕在转换/加载时不再动画。jQuery 可能在 javaScript 框中相互冲突。

你可以在这里查看小提琴：http: [//jsfiddle.net/jodriscoll/fKCFE/](http://jsfiddle.net/jodriscoll/fKCFE/)。

理论上，标题应该从图像下方滑入并在幻灯片加载/从一张幻灯片转换到另一张幻灯片时显示自己。

这是一个我喜欢的工作方式的例子：http: [//jsfiddle.net/jodriscoll/fKCFE/51/](http://jsfiddle.net/jodriscoll/fKCFE/51/)

```
// caption toggle animation time
var toggleTime = 500,
// always show caption when slide comes into view
showCaptionInitially = true,

updateCaption = function(slider, init) {
    if (init && showCaptionInitially) {
        setTimeout(function() {
            slider.$targetPage.find('.caption').animate({
                bottom: 0
            }, toggleTime);
        }, slider.options.delayBeforeAnimate + toggleTime);
    } else if (!init) {
        var cap = slider.$lastPage.find('.caption');
        cap.css('bottom', -cap.innerHeight());
    }
};

$('#slider').anythingSlider({
//  buildNavigation : false,
// *********** Callbacks ***********
// Callback when the plugin finished initializing
onInitialized: function(e, slider) {
    slider.$items.each(function() {
        var cap = $(this).find('.caption');
        cap.css('bottom', -cap.innerHeight()).click(function() {
            cap.animate({
                bottom: (cap.css('bottom') === "0px" ? -cap.innerHeight() : 0)
            }, toggleTime);
        });
    });
    updateCaption(slider, true);
},

// Callback before slide animates
onSlideBegin: function(e, slider) {
    updateCaption(slider, true);
},

// Callback after slide animates
onSlideComplete: function(slider) {
    updateCaption(slider, false);
}
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T01:43:15.470

问题是该滑块被初始化了两次。第二个实例中的任何代码都将被忽略。这是一个[更新的演示](http://jsfiddle.net/Mottie/fKCFE/56/)，其中结合了两者的代码。

```
// ******************
// Thumnail Slider
// ******************
var fadeTime = 0,
    fadeDelay = 0,
    timer,
    hideControls = function (slider) {
        clearTimeout(timer);
        setTimeout(function () {
            slider.$controls.fadeOut(fadeTime);
            $('.tooltip').fadeOut(fadeTime);
        }, fadeDelay);
    },
    // ******************
    // Caption animation
    // ******************
    toggleTime = 500,
    showCaptionInitially = true,
    updateCaption = function (slider, init) {
        if (init && showCaptionInitially) {
            setTimeout(function () {
                slider.$targetPage.find('.caption').animate({
                    bottom: 0
                }, toggleTime);
            }, slider.options.delayBeforeAnimate + toggleTime);
        } else if (!init) {
            var cap = slider.$lastPage.find('.caption');
            cap.css('bottom', -cap.innerHeight());
        }
    };

$('#slider').anythingSlider({
    navigationSize: 3,
    navigationFormatter: function (i, panel) {
        var url = 'http://www.massgeneral.org/international/dev/assets/slideshow/slideshow-',
            thumbs = [
                ['01', 'This is the tooltip for the first thumbnail'],
                ['02', 'This is the tooltip for the second thumbnail'],
                ['03', 'This is the tooltip for the third thumbnail'],
                ['04', 'This is the tooltip for the fourth thumbnail'],
                ['05', 'This is the tooltip for the fifth thumbnail'], ];
        return '<img title="' + thumbs[i - 1][1] + '" src="' + url + thumbs[i - 1][0] + '.jpg">';
    },
    onInitialized: function (e, slider) {
        slider.$items.each(function () {
            var cap = $(this).find('.caption');
            cap.css('bottom', -cap.innerHeight()).click(function () {
                cap.animate({
                    bottom: (cap.css('bottom') === "0px" ? -cap.innerHeight() : 0)
                }, toggleTime);
            });
        });
        updateCaption(slider, true);
        slider.$controls.find('img').tooltip();
    },
    onSlideBegin: function (e, slider) {
        updateCaption(slider, true);
    },
    onSlideComplete: function (slider) {
        updateCaption(slider, false);
    }
}); 
```

# nginx - Nginx rewrite triggers download

> ID：15420018
> 
> 赞同：2
> 
> 时间：2013-03-14T20:56:24.280
> 
> 标签：nginx, rewrite

I'm struggling with creating a simple rewrite url on nginx.
My configuration looks like this:

```
location /foo/bar {
    rewrite ^/(.+)$ /index.php?p=$1 break;
} 
```

E.g. `/foo/bar/baz` should become `/foo/bar/index.php?p=baz` (internally of course)

However, everything accessed through `/foo/bar/` triggers a download of an index.php located at the root. How do I get this to work ?

I've also tried using `try_files` but can't figure out how to exclude the `/foo/bar/` path from `$uri`.

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-14T21:52:51.613

改变

```
rewrite ^/(.+)$ /index.php?p=$1 break; 
```

至

```
rewrite ^/(.+)$ /index.php?p=$1 last; 
```

基于[http://wiki.nginx.org/HttpRewriteModule#rewrite](http://wiki.nginx.org/HttpRewriteModule#rewrite)，

> last - 完成当前重写指令的处理并重新启动该过程（包括重写），并从所有可用位置搜索 URI 上的匹配项。

[编辑] 使用 break 将留在同一个位置块内。在您的情况下，该位置块内没有其他规则。因此，默认情况下，nginx 会将其作为文件请求提供服务。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-14T21:05:52.657

PHP 文件不会被解释和视为常规文件。您将需要设置一个像 FPM 这样的 CGI 服务器并将连接传递给这些进程。

有关详细信息，请参阅[http://wiki.nginx.org/Configuration](http://wiki.nginx.org/Configuration)

**更新**

我不确定你的例子为什么会中断。但我的猜测是你需要将 更改`rewrite`为`try_files`.

```
location /foo/bar {
    try_files $uri $uri/ /index.php?p=$uri;
} 
```

# node.js - Asyncjs：绕过瀑布链中的函数

> ID：15420019
> 
> 赞同：7
> 
> 时间：2013-03-14T20:56:24.307
> 
> 标签：node.js, asynchronous, callback, waterfall

我想从 in 的瀑布函数链中跳转一个`asyncjs`函数`nodejs`。

我的代码如下所示：

```
async.waterfall([
    function(next){
        if(myBool){
            next(null);
        }else{
            // Bypass the 2nd function
        }
    },

    // I want to bypass this method if myBool is false in the 1st function
    function(next){
    },

    // Always called
    function(next){
    }
]); 
```

您是否知道不使用 put 的正确方法：

```
if(!myBool){
    return next();
} 
```

在我想绕过的功能中。

谢谢 ！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2014-08-14T05:48:49.677

我认为这应该有效：

```
var finalCallback = function(err, result){
  if(err)
     // handle error..
  else
     console.log('end! :D');
}

async.waterfall(
  [
    function step1(callback){
       // stuff
       callback(null, someData);
    },
    function step2(someData, callback){
       if(skip_step_3)
          finalCallback(null, someData);
       else
          callback(null, someData);
    },
    function step3(moreData, callback){
       // more stuff
       callback(null, moreData);
    }
  ],
  finalCallback
) 
```

async 的创建者在 github repo ( [https://github.com/caolan/async/pull/85](https://github.com/caolan/async/pull/85) )中推荐这个

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-03-14T21:02:10.683

另一种选择可能是：

```
var tasks = [f1];

if(myBool){
    tasks.push(f2);
}

tasks.push(f3);

async.waterfall(tasks, function(err, result){
}); 
```

其中`f1`,`f2`和`f3`是您的函数。

除此之外，你最好明确地这样做，避免让你的代码过于复杂，简单通常更好

更新：

```
function f1(done){
    if(myBool){
        f2(done);
    }else{
        done();
    }
}

function f2(done){
    async.nextTick(function(){
        // stuff
        done();
    });
}

async.waterfall([f1,f3],function(err,result){
    // foo
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-01-29T00:35:42.517

使用[if-async](https://github.com/kessler/if-async)模块，您的代码将如下所示：

```
var async = require('async')
var ifAsync = require('if-async')

async.waterfall([
    foo,
    ifAsync(p1).then(c1).else(c2),
    bar
], function(err) {}) 
```

完整示例请看这里：[https ://github.com/kessler/if-async#example-2-using-with-asyncjs-waterfall](https://github.com/kessler/if-async#example-2-using-with-asyncjs-waterfall)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-09-26T07:09:41.170

我迟到了，但[async-if-else](https://www.npmjs.com/package/async-if-else)可能会对你有所帮助。

示例代码

```
 var async = require('async-if-else')(require('async'));

  function emailExists(user, callback) {
    user.find(user.email, function(err, dbUser){
      if (err)
        return callback(error);

      if(!dbUser)
     return callback(null, false); // does not exist, predicate will be false 

   callback(null, true);  
  });
  }

  function updateAccount(user, callback) { 
    user.update( ..., callback);
  }

  function importFromLegacyByEmail(user, callback) { 
    remoteClient.get(user, callback);
  }

  async.waterfall([
    async.constant({email: 'thiago@email.com', dogs: 2, money: 0, fun: 100 }),
    async.if(emailExists, updateAccount).else(importFromLegacyByEmail),
    sendEmail
  ], handler); 
```

* * *

## 回答 #5

> 赞同：-4
> 
> 时间：2015-08-27T13:36:18.547

我会推荐使用[clojurescript](http://www.mase.io/code/clojure/node/2015/01/24/getting-started-with-clojurecript-and-node/)，它有一个很棒的[核心异步](http://clojure.github.io/core.async/)库，它在处理异步调用时让生活变得超级简单。

在你的情况下，你会写这样的东西：

```
(go
  (when-let [res1 (<! (asyncFunc1))]
    (<! (asyncFunc2 res1)))
  (<! (asyncFunc3))) 
```

请注意`go`将导致主体异步运行的宏，以及`<!`将阻塞直到异步函数返回的函数。

代码将首先阻塞第一个异步函数。然后，如果结果为真，它也会在该块上运行第二个异步函数。最后，它将运行第三个异步函数并阻止它。

# kdb - Q/kdb+ 分块读取日志文件

> ID：15420025
> 
> 赞同：1
> 
> 时间：2013-03-14T20:56:51.900
> 
> 标签：kdb, ticker, chunks, q-lang

我有一项任务需要我加载对我的内存来说太大而无法立即加载的日志文件。因此我需要通过不同的块加载文件的方法..

我知道：

```
-11!(n; filename) 
```

从文件中加载第一个 n 块，但是如何加载其余的块？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-15T12:08:24.557

如果是典型的tickerplant 设置，您的日志文件可能会调用函数upd。覆盖该函数以在第二次运行时忽略初始值，而不将它们插入表中，从而允许您将加载拆分为多个部分。

```
upd:{i+:1; if[i within 100000 200000; ignore x; storeSomewhere x]}; 
```

然后播放整个文件`-11!`。通过更改 if 子句中的条件来控制实际存储的部分。

# xaml - Windows 应用商店应用布局差异

> ID：15420026
> 
> 赞同：6
> 
> 时间：2013-03-14T20:56:52.223
> 
> 标签：xaml, canvas, microsoft-metro, windows-runtime, windows-store-apps

我正在使用 Viewbox 来缩放固定大小的画布（包含一起形成有意义的图片的各种路径）。

```
<StackPanel Background="Red" Width="400" UseLayoutRounding="True">
    <StackPanel.Resources>
        <Style TargetType="Viewbox">
            <Setter Property="Height" Value="400" />
            <Setter Property="Margin" Value="0,0,0,50" />
        </Style>
        <Style TargetType="Path">
            <Setter Property="Stroke" Value="Blue" />
            <Setter Property="StrokeThickness" Value="2" />
        </Style>
    </StackPanel.Resources>
    <Viewbox>
        <Canvas Width="5" Height="5">
            <Path Data="M 1,1 h 3 v 3 h -3 z" />
        </Canvas>
    </Viewbox>
    <Viewbox>
        <Canvas Width="6" Height="6">
            <Path Data="M 1,1 h 4 v 4 h -4 z" />
        </Canvas>
    </Viewbox>
</StackPanel> 
```

此 xaml 在我的 PC 上本地呈现时显示在顶部，在模拟器上呈现时显示在底部。由于模拟器正在产生所需的结果，有人可以向我解释为什么第二条路径超出了红色面板吗？

![在我的电脑上原生渲染](../Images/18fd2af2ba21273209ad7b8e5c07aae2.png) ![在模拟器上渲染](../Images/21b159da082695ae80a636b671d512e8.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-11T15:37:14.027

真的没有差异......正在发生的事情是你正在采取一些渲染非常小的东西（你的路径非常小）：

![截屏](../Images/2419846f7f5083395562db413c0e30a3.png)

*看看那些小盒子*

...并将其放大到非常大，并通过以下方式告诉布局四舍五入到最接近的整个像素`UseLayoutRounding`

结果不可靠的原因是`Path`s 独立于 s 进行缩放，`Canvas`因为它实际上并没有布局其内容。因此，当您的路径点之一落在不均匀的像素边界上（这可能发生在某些屏幕分辨率而不是其他屏幕分辨率上）时，它会四舍五入到未缩放的画布内最近的虚拟像素，并且从 缩放`Viewbox`然后再次四舍五入到最近的整个像素（使用`Viewbox`由 的缩放确定的相同比例`Canvas`）加剧了舍入误差。如果我们关闭`StackPanel.Background`（默认为透明）设置`Canvas.Background`为绿色并调低笔画颜色的不透明度，您可以更容易地看到这个图示：

![截屏](../Images/4e9aabe0098a9aee8cd4350b197fc0e2.png)

*您可以看到路径舍入与画布不同*

因此，您要么必须关闭，`UseLayoutRounding`以便在操作中包含小数点，要么简化您的布局，以免发生错误。

例如，如果您通过删除不合适和多余的固定大小画布来让路径自行扩展，并设置`Path.Stretch = Uniform`您最终得到：

```
 <StackPanel Background="Red" Width="400" UseLayoutRounding="True">
        <StackPanel.Resources>
            <Style TargetType="Viewbox">
                <Setter Property="Height" Value="400" />
                <Setter Property="Margin" Value="0,0,0,50" />
            </Style>
            <Style TargetType="Path">
                <Setter Property="Stroke" Value="Blue" />
                <Setter Property="StrokeThickness" Value="2" />
                <Setter Property="Stretch" Value="Uniform" />
            </Style>
        </StackPanel.Resources>
        <Viewbox>
            <Path Data="M 1,1 h 3 v 3 h -3 z" />
        </Viewbox>
        <Viewbox>
            <Path Data="M 1,1 h 4 v 4 h -4 z" />
        </Viewbox>
    </StackPanel> 
```

**导致：** ![截屏](../Images/ae66f49162a5fa3deba5fc12102fdb31.png)

*可能是您真正想要的*

但是，如果这是一个过度简化，并且您实际上有多个路径打算放入您的`Canvas`.`Grid`让`Grid`他们保持同步（`Canvas`s 不会布置他们的孩子）。代码如下所示：

```
 <StackPanel Background="Red" Width="400" UseLayoutRounding="True">
        <StackPanel.Resources>
            <Style TargetType="Viewbox">
                <Setter Property="Height" Value="400" />
                <Setter Property="Margin" Value="0,0,0,50" />
            </Style>
            <Style TargetType="Path">
                <Setter Property="Stroke" Value="Blue" />
                <Setter Property="StrokeThickness" Value="2" />
                <Setter Property="Stretch" Value="Uniform" />
            </Style>
        </StackPanel.Resources>
        <Viewbox>
            <Grid Width="5" Height="5">
                <Path Data="M 1,1 h 3 v 3 h -3 z" />
            </Grid>
        </Viewbox>
        <Viewbox>
            <Grid Width="6" Height="6">
                <Path Data="M 1,1 h 4 v 4 h -4 z" />
            </Grid>
        </Viewbox>
    </StackPanel> 
```

**结果与没有辅助容器的结果相同**

希望这会有所帮助-ck

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-09T06:12:28.497

我可以用模拟器在我的机器上重现这个问题，显示分辨率为 2560x1440，画布如下。

```
<Canvas Width="4" Height="4">
    <Rectangle Width="4" Height="4" Fill="Blue" ></Rectangle>
</Canvas> 
```

对于上面的片段 - 画布溢出/超出红色面板。

```
<Canvas Width="6" Height="6">
    <Rectangle Width="6" Height="6" Fill="Blue" ></Rectangle>
</Canvas> 
```

对于上面的片段 - 画布下溢/不适合红色面板，并在红色面板的右边距上留下一些空间。

如果画布大小保持为 5 的倍数，则它适合红色面板。

Path 似乎不是问题，因为它也可以使用 rect 进行复制。ViewBox 缩放似乎有问题。我发现`UseLayoutRounding="False"`在 stackpanel 上 - 问题不会重现。在寻找 ViewBox 缩放问题时，我还发现了一个[相关的线程。](https://stackoverflow.com/questions/1857289/why-does-uselayoutrounding-not-seem-to-work-with-viewbox)它建议使用`SnapsToDevicePixels`属性，但这不适用于 Windows 商店 xaml 应用程序。

总而言之，这似乎是 ViewBox 缩放的一个问题，尽管我不是具有内部视图框缩放算法知识的专业人士。可能的解决方法是如果 UseLayoutRounding 在另一台机器上通过测试，则将其设置为 false。5 的倍数看起来不是很好的解决方法，但您可以检查一下。在单独的说明中 - 如果您只是想知道它为什么会发生，您会得到答案，并且可能是几个像素的下溢/溢出可能对您的应用程序很重要。

# twitter-bootstrap - 我的模态中没有显示任何内容

> ID：15420027
> 
> 赞同：-1
> 
> 时间：2013-03-14T20:56:53.997
> 
> 标签：twitter-bootstrap, modal-dialog, remoteobject

[我的问题也很相似，如果与关于 modals](https://stackoverflow.com/questions/12153503/twitter-bootstrap-modal-external-urls-are-not-working)的问题不完全相同的话。问题似乎是，我的 .txt 文件不会加载到模态体中：

```
<p><a data-toggle="modal" href="http://adambalan.com/aisis/aisis_version_notes.txt" data-target="#modal" class="updateNotes">READ MORE ABOUT IT!</a></p>

    <div class="modal hide fade" id="modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
    <h3 id="myModalLabel">Modal header</h3>
  </div>
  <div class="modal-body">
  </div>
</div>  

<script>
$(document).ready(function(){  
    $('a.updateNotes').on('click', function(e) {
        e.preventDefault();
        var url = $(this).attr('href');
        $('.modal-body').html(url);
    });​    
});
</script> 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T22:41:24.560

如果您不尝试获取跨域内容，我认为您的代码是正确的。由于您使用的是`data-api`语法，实际上您不需要编写任何 JS 来从链接中获取内容。Bootstrap modal javascript 会为你做这件事。您是否包含“bootstrap.js”文件？

# java - 带有动态列和相关 JTextFields 的 java swing JTable

> ID：15420028
> 
> 赞同：1
> 
> 时间：2013-03-14T20:56:55.453
> 
> 标签：java, swing, layout, jtable

我想要一些关于如何解决以下两个问题的提示（不是解决方案，我想自己找到）

1.  如何创建和维护一个 JTable，其列数及其宽度是可变的，并且用户可以在运行时进行配置。我已经尝试了一些事情并设法在创建表单（使用 tablemodel）时做到这一点，但我更喜欢在表单已经显示时也能够做到这一点。

2.  一旦不碍事，我想在表格顶部有一个 JPanel，它带有模仿表格列的 JTextFields。我还没有找到允许我创建具有不同宽度和正确位置的文本字段的布局......尽管 FlowLayout 似乎最有希望。同样，如果表格布局发生变化，文本字段也应该发生变化。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-14T22:27:45.993

对于第 2 点，如果我理解正确，您可能需要考虑一个单行表。如果你不把它放在 JScrollPane 中，你就不会得到标题，这就是我认为你想要的。

然后，您可以在主表的 TableColumnModel 上放置一个 TableColumnModelListener，这样您就可以在用户调整列大小时进行拾取，并相应地调整单行表的列宽。

# c# - C# 方法默认是密封的还是虚拟的？

> ID：15420029
> 
> 赞同：7
> 
> 时间：2013-03-14T20:57:05.513
> 
> 标签：c#, inheritance

我知道 `virtual`和`sealed`关键字的定义，但是如果您不将它们中的任何一个与方法一起使用，默认情况下可以覆盖该方法吗？

我来自 vb.net 背景。在 vb.net（来自 MSDN）中是这样的：

> 如果未指定 Overridable 或 NotOverridable 修饰符，则默认设置取决于属性或方法是否覆盖基类属性或方法。如果属性或方法覆盖了基类属性或方法，则默认设置为 Overridable；否则，它是 NotOverridable。

我只是想知道这在 C# 中是否也是如此。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-14T20:58:34.640

默认情况下，C# 中的方法*不是*虚拟的。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-03-14T21:01:30.260

不，它不能。您需要将方法显式标记为虚拟方法，以允许在派生类中覆盖它。

但是，您可以做的是使用 new 关键字隐藏方法。（MSDN 文档）

sealed 关键字用于类定义和方法。它不允许从类继承或覆盖方法。默认情况下，如果您不使用此关键字，其他人将能够从您的类继承。（[MSDN 文档](http://msdn.microsoft.com/en-us/library/88c54tsw%28v=vs.110%29.aspx)）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-14T20:59:10.543

不。与 Java 不同，C# 中的方法不是`virtual`默认的。它们都不是`sealed`，但你不能覆盖它们，因为它们是普通方法。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-03-14T21:00:56.190

不，您不能覆盖非虚拟方法。new 关键字只隐藏了基类实现，并不是一个好的做法。

在此与 Anders Hejlsberg 讨论此[问题](http://www.artima.com/intv/nonvirtualP.html)

# javascript - 从按钮中的 onClick(this) 获取此 ID？

> ID：15420033
> 
> 赞同：-5
> 
> 时间：2013-03-14T20:57:26.800
> 
> 标签：javascript

抱歉复制粘贴错误，功能现在匹配

我有一些简单的代码，我似乎无法获得点击项目的 id？

```
<input type="button" name="remove_grouping" value=Remove Group" onClick="removeGrouping(this);"/>'; 
```

然后是一个简单的 JS 函数

```
function removeGrouping(src)
{
alert(src.id);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T20:59:41.707

你不应该在IMG中添加ID参数吗？

```
<img id="some-id" onclick="removeRow(this)" src="someimage"> 
```

而且您在 onclick 中调用了不同的函数。

# php - 带撇号的 PHP 正则表达式字符串

> ID：15420034
> 
> 赞同：2
> 
> 时间：2013-03-14T20:57:37.790
> 
> 标签：php, regex

我正在尝试`[number].word word word`在文本中搜索格式的字符串，例如：`1.Test number one` 我正在使用的模式`$pattern = '~\d+[.][\s]*[A-Z]{1}[\w\d\s]+~'`，但问题是模式找不到带撇号的字符串，例如`5.That's a valid string` 我也尝试过使用`$pattern = '~\d+[.][\s]*[A-Z]{1}[\w|\d|\s|\']+~'`但它也不起作用.

我怎样才能修复正则表达式，以便它也可以检测带有撇号的字符串？

谢谢 ！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T21:07:21.520

使用以下正则表达式：

```
/^\d+\.\s*(?:[\w']+ *)+$/ 
```

### 现场演示：[http ://www.rubular.com/r/0CBEb8jbnK](http://www.rubular.com/r/0CBEb8jbnK)

### 解释：

```
^  -> Start of match
$  -> End of match
?: -> Non capturing group 
```

**PS：**如果您的正则表达式字符串使用单引号，您可能需要在 PHP 引号中转义单引号。

# objective-c - 在类型的对象上找不到属性（类别不可见）

> ID：15420035
> 
> 赞同：1
> 
> 时间：2013-03-14T20:57:40.667
> 
> 标签：objective-c, implementation

**已解决：原来我导入了包含该类别的错误头文件。**

我收到此错误：`Property 'xx_store' not found on object of type 'XXFeedback *'`

然而`XXFeedback`是一个子类`NSManagedObject`，我添加了一个添加`xx_store`方法的类别。

我已确保该类别的实现文件包含在我的目标的编译源构建阶段。

我还尝试在我的目标的构建设置中添加这些“其他链接器标志”设置：`-ObjC`并且`-all_load`，根据[构建具有类别的 Objective-C 静态库](http://developer.apple.com/library/mac/#qa/qa1490/_index.html)

我还做了一个项目清理和重建。

**编码**

在`XXFoundation/FileA.h`：

```
@interface NSManagedObject (MyCategory)
@property (readonly, nonatomic) XXStore *xx_store;
@end 
```

在`XXFoundation/FileA.m`：

```
@implementation NSManagedObject (MyCategory)

- (XXStore *)xx_store
{
  ...
} 
```

在 FileB.m 中：

```
#import <XXFoundation/FileA.h>

...
XXStore *store = _feedback.xx_store;
... 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T22:00:22.423

事实证明，我导入了包含该类别的错误头文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-14T21:21:02.050

我想你正在研究一些静态库。如果是这样，则在链接到包含类别的 Objective-C 静态库时会出现问题。查看此技术问答了解更多信息：[使用类别构建 Objective-C 静态库](http://developer.apple.com/library/mac/#qa/qa1490/_index.html)

# jquery - jQuery .hide() 之后 jQuery 解除绑定？

> ID：15420043
> 
> 赞同：0
> 
> 时间：2013-03-14T20:58:22.673
> 
> 标签：jquery

我试图在使用 jQuery 隐藏图标并滑入另一个 div 后显示一个图标。这是[jsfiddle](http://jsfiddle.net/CU8cv/ "这是小提琴")。基本上我想做的就是在用户单击搜索框并且输入框滑回原始宽度后重新显示初始图标。我试过这个：

```
 $('#display_search_two').hide();
    $(".search_icon").click(function() {
    $(".search_icon").hide(300);
    $("#display_search_two").slideDown(1000); 
    $(this).off().hide().show(".search_icon"); 
```

但它似乎不起作用，我也研究了 unbind 选项，但也无法让它工作。亲切的问候克里斯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-14T21:18:20.040

使用你的代码我想出了这个：http: [//jsfiddle.net/CU8cv/1/](http://jsfiddle.net/CU8cv/1/)

```
/* lookup the original width */
var w = $(this).attr('data-default');
$(this).animate({ width: w, left: 92 }, 'slow');

$("#display_search_two").slideUp();
$(".search_icon").show(300); 
```

希望能帮助到你。

# jquery - 具有动态内容的 HTML5 Navigation Timing API

> ID：15420052
> 
> 赞同：1
> 
> 时间：2013-03-14T20:58:43.400
> 
> 标签：jquery, html, navigation-timing-api

我想知道动态内容是否对 loadEnd 等计时值有任何影响。例如，在加载页面后，我使用 jquery 有条件地更改代码中图像的“src”属性。这是如何处理的？我尝试通过检查加载图像之前和之后的值来测试它，加载该图像后值看起来没有变化。这是否意味着导航计时 API 不包括动态内容加载？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-17T19:39:06.393

[NavigationTiming](http://www.w3.org/TR/navigation-timing/)属性的值在文档事件触发并返回后设置：[`loadEventEnd`](http://www.w3.org/TR/navigation-timing/#dom-performancetiming-loadend) `load`

> loadEventEnd 属性
> 
> 该属性必须返回当前文档的加载事件完成的时间。当加载事件未触发或未完成时，它必须返回零。

从你的陈述中：

> **...加载页面后**，我有条件地使用 jquery 在代码中更改图像的“src”属性...

听起来您在主体事件触发`src`期间或之后更改 a 属性。`load`由于该`load`事件仅在页面上触发一次，因此`window.performance.timing.loadEventEnd`一旦将其设置为非零值，该属性将永远不会更改。因此它不会反映下载新的`img src`.

如果您想包括下载要更改的附加图像所需的`src`时间，您可以挂钩该图像的`load`事件。一旦该事件触发，比较`Date.now()`而[`navigationStart`](http://www.w3.org/TR/navigation-timing/#dom-performancetiming-navigationstart)不是`loadEventEnd`获取总经过的页面加载时间。

# jquery - 根据无线电值显示/隐藏 div（自定义无线电，Foundation 4）

> ID：15420053
> 
> 赞同：0
> 
> 时间：2013-03-14T20:58:46.283
> 
> 标签：jquery, html

我将[Foundation 4](http://foundation.zurb.com/docs/)用于自定义单选按钮。

我的单选按钮如下所示：

```
<label for="cat"><input name="cat" value="jersey" type="radio" id="jersey" style="display:none;"><span class="custom radio"></span></label>
<label for="cat"><input name="cat" value="shorts" type="radio" id="shorts" style="display:none;"><span class="custom radio"></span></label>
<label for="cat"><input name="cat" value="shirts" type="radio" id="shirts" style="display:none;"><span class="custom radio"></span></label> 
```

我的 jquery 看起来像这样：

```
$('input[type=radio]').click(function(){
    $('.area').hide();
    $('#' + $(this).val()).show(); 
}); 
```

显示 div 的 html 如下所示：

```
<div class='area' id="jersey">jersey</div>
<div class='area' id="shorts">shorts</div>
<div class='area' id="shirts">shirts</div>
<div class='area' id="reversible">reversible</div>
<div class='area' id="outerwear">outerwear</div>
<div class='area' id="helmets">helmets</div>
<div class='area' id="other">other</div> 
```

它以前使用普通的单选按钮，但我没有运气让它与这些自定义单选按钮一起使用。谁能帮我吗？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T21:15:23.433

ID 必须是唯一的，jQuery 仅选择具有特定 ID 的第一个元素，因此您试图显示单击的输入元素，该元素实际上是隐藏的并且不会触发更改/单击事件。您应该收听由元素`click`触发的事件。`span`

```
$(function(){
    var $divs = $('.area');

    $('label').on('click', 'span.radio', function() {
        var val = $(this).prev('input').val();
        $divs.hide().filter('#' + val).show();  
    });
}) 
```

# ms-access - MS Access：如何从日期字段中删除时间？

> ID：15420060
> 
> 赞同：5
> 
> 时间：2013-03-14T20:59:08.363
> 
> 标签：ms-access

例如，字段中的值可能是

```
8/5/2010 11:18:22 AM 
```

我想把它剥离到

```
8/5/2010 
```

它是日期/时间字段格式

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-03-14T21:10:17.313

使用 DateValue() 解决了这个问题

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-03-28T10:47:12.330

`Time`是小数位，因此如果您不想要时间，请使用以下方法更新字段：

```
round(number,NumDigitsAfterDecimal as long) 
```

# php - 网络爬虫是否受到 CPU、RAM 或 IO 的限制？

> ID：15420067
> 
> 赞同：-2
> 
> 时间：2013-03-14T20:59:37.087
> 
> 标签：php, web-scraping, screen-scraping

当一个网络爬虫是用 PHP 编写的（运行 nginx、ubuntu），并且我们希望有很多爬虫一次爬取多个不同的站点，那么限制因素是什么？

CPU、RAM 还是磁盘 IO？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T21:05:29.920

RAM 和磁盘 IO 可能会在 CPU 之前很久就受到限制，具体取决于您同时运行的进程的数量。每个爬虫可能会维护一个访问过的 URL 和找到的资源的关联数组。对于大型网站，这将是......很大，特别是如果您允许每个 URL 使用 4k 并将其存储为原始数据。

您可能会散列 URL（40 字节 GUID，或更小的二进制表示），以便/可以节省大量 RAM。

尽可能避免磁盘 I/O，仅在绝对必要时才写入以减轻其影响，并考虑写入数据库而不是写入可能是网络挂载的磁盘文件。

# sql - 忽略重复项？

> ID：15420069
> 
> 赞同：0
> 
> 时间：2013-03-14T20:59:38.460
> 
> 标签：sql, sql-server-2008, duplicate-removal, duplicates, on-duplicate-key

```
Column1
1
1
2
3
4
4
4
5 
```

有没有办法查询该列并且只返回

```
2
3
5 
```

如果我使用 Select Distinct 它会返回

```
1
2
3
4
5 
```

我如何编写一个选择语句，如果存在重复，不要只选择一个，而是完全忽略具有该值的两个/所有行？但这是在左连接右侧的表中选择的单个列

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-14T21:01:01.587

我认为这就是你想要的：

```
SELECT a.column1 
FROM   (SELECT column1, 
               Count(*) cnt 
        FROM   tbl 
        GROUP  BY column1 
        HAVING Count(*) = 1) a 
```

**结果**

```
| 第 1 列 |
------------
| 2 |
| 3 |
| 5 |
```

[查看演示](http://sqlfiddle.com/#!3/6fb00/1)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-14T21:01:10.097

```
SELECT Column1
FROM YourTable
GROUP By Column1
HAVING COUNT(*) = 1 
```

## [Sql 小提琴](http://sqlfiddle.com/#!2/36875/1)

# django - Django 会话丢失数据（空）

> ID：15420071
> 
> 赞同：1
> 
> 时间：2013-03-14T20:59:45.010
> 
> 标签：django, session-cookies

我想在我的站点中使用会话。我在 settings.py 文件中设置了以下设置：

```
 'django.contrib.sessions', #in the installed apps 
```

和

```
SESSION_ENGINE = 'django.contrib.sessions.backends.signed_cookies' 
```

和

```
'django.contrib.sessions.middleware.SessionMiddleware', # in the midlleware classes 
```

# 查看代码

```
def apartamente(request):
    form = SearchFormApartamente()
    execute_form_process = 0
    if request.method == 'POST':
        form = SearchFormApartamente(request.POST)
        execute_form_process = 1
        request.session['apartamente'] = form
        request.session['vasea'] = True
        request.session.set_expiry(300)
        request.session.modified = True
    elif 'apartamente' in request.session:
        form = searchFormApartamente(request.session['apartamente'])
        execute_form_process = 1

# forms.py
class SearchFormApartamente(forms.Form):
    thewidget = ColumnCheckboxSelectMultiple()
    category = forms.ModelMultipleChoiceField(
        queryset=Categorie_Oferta.objects.filter(id__in=[1,2,3,4]),
        required=False)
    sector = forms.ModelMultipleChoiceField(queryset=Sector.objects.all(),
        widget=forms.widgets.CheckboxSelectMultiple, required=False)
    min_price = forms.IntegerField(required=False,
        widget=forms.widgets.Input(attrs={'class': 'rounded'}))
    max_price = forms.DecimalField(required=False) 
```

但是，问题是我尝试在会话中存储一个表单，当我第二次进入视图并尝试从 sessiom 读取值时，会话是空的......可能是什么问题？提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T11:02:29.507

我将重写视图代码，如下所示，假设这`apartamente`是表单上的一个字段。

```
# I know it doesn't affect scoping, but I don't like having the view name
# the same as a model or anything else for sanity

def apartamente_view(request):
    apartamente = request.session.get('apartamente', None)
    form = SearchFormApartamente(request.POST or None,
        initial={'apartamente': apartamente})

    execute_form_process = 0
    if request.method == 'POST':
        if form.is_valid():
            execute_form_process = 1
            request.session['apartamente'] = form.cleaned_data['apartamente']
            request.session['vasea'] = True
            request.session.set_expiry(300)

            # do you really need this?
            request.session.modified = True
            ... 
```

# java - Play Framework 2.1.0 - 使用Ebean查询现有数据库表

> ID：15420073
> 
> 赞同：0
> 
> 时间：2013-03-14T20:59:50.877
> 
> 标签：java, playframework, playframework-2.0, ebean

我无法从现有数据库表 (SQL Server 2008 R2) 返回数据。我可以成功地进行身份验证并连接到数据库，我创建了一个模型，我试图映射到一个特定的表，然后作为一个测试试图返回一个行数，行数总是返回 0。我想也许我不明白Play/Ebean 数据库连接如何工作。目前我有以下内容：

模型 - Data.java：

```
package models;

import javax.persistence.*;

import play.db.ebean.*;

@Entity
@Table(name="someTable")  
public class Data extends Model {

    private static final long serialVersionUID = 1L;

    @Id
    public int someKey;

    public String someCol;

    public static Finder<Integer,Data> find = new Finder<Integer,Data>( Integer.class, Data.class );

} 
```

控制器 - Index.java

```
package controllers;

import java.util.*;
import models.Data;
import play.mvc.*;

public class Index extends Controller {

    static int rowCount = Data.find.getMaxRows();

    public static Result index() {
        Result res = ok(rowCount);
        return res;
    }
} 
```

Application.conf（相关片段）：

```
db.default.driver=net.sourceforge.jtds.jdbc.Driver
db.default.url="jdbc:jtds:sqlserver://server.domain.local/someDB;instance=SQL"
db.default.user=someUser
db.default.password="password"

evolutionplugin=disabled

ebean.default="models.*" 
```

我不自称了解 Evolutions 的工作原理，但我在 SQL 中单独进行数据库开发工作，即 DDL 和模式创建/修改。

任何帮助将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-15T00:43:56.123

您要做的事情是通过[`findRowCount()`](http://www.avaje.org/static/javadoc/pub/com/avaje/ebean/Query.html#findRowCount%28%29)返回查询影响的行数来完成。基本上一个`COUNT(*)`.

[`getMaxRows()`](http://www.avaje.org/static/javadoc/pub/com/avaje/ebean/Query.html#getMaxRows%28%29)相当于[`setMaxRows(int)`](http://www.avaje.org/static/javadoc/pub/com/avaje/ebean/Query.html#setMaxRows%28int%29)是对查询返回的行数的限制（例如`LIMIT`在 MySQL 中）。

# javascript - jquery插件可拖动滑块，具有多个区域，如堆栈图

> ID：15420080
> 
> 赞同：0
> 
> 时间：2013-03-14T21:00:24.450
> 
> 标签：javascript, jquery, charts, slider, draggable

我一直在寻找一个可以做到这一点的 jquery 插件，但似乎没有多少这样的插件。

基本上我想提供一个小部件，它具有通过拖动分配百分比的句柄。它更像是一个可以拖动线条的水平堆栈图。换言之，水平“管”或饼图被分成​​不同的部分，但用户可以拖动以确定每个部分的所需百分比。新部分也应该能够即时添加和删除。

有什么 jquery 小部件插件可以做到这一点吗？我找到了很多不错的拖放插件，很多不错的堆栈图，饼图插件，但似乎我还没有找到两者兼得的插件。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T21:50:51.407

我想对于上述情况，具有固定最小值的滑块都可以正常工作。这个jquery的链接是[http://jqueryui.com/slider/#rangemin](http://jqueryui.com/slider/#rangemin) 这里所说的例子可以根据需要在这种情况下改变%。

# jsf-2 - JSF2.0 - 具有可选方法表达式的复合组件

> ID：15420081
> 
> 赞同：8
> 
> 时间：2013-03-14T21:00:26.477
> 
> 标签：jsf-2, java-ee-6, composite-component

我正在实现一个复合组件，但我发现了一个我没有找到解决方案的问题。

我指定了页面作者可以或不可以传递的属性，但我无法指定方法属性（Action 的方法表达式），如果未传递，则复合组件不使用方法属性在复合：实现标签中。

这是我的代码：

```
<composite:interface>
    <composite:attribute name="namePrompt" required="true"/>
    <composite:attribute name="actionMethod" method-signature="java.lang.String  action()" required="false"/>
    <composite:attribute name="showComponent" default="false"/>
</composite:interface>

<composite:implementation>
    <div>
       <p:commandLink actionListener="#{cc.attrs.actionMethod}"
                      rendered="#{cc.attrs.showComponent}"
                      >
            <h:outputText value="#{cc.attrs.namePrompt}"/>    
       </p:commandLink>
    </div>
</composite:implementation> 
```

使用时，我没有指定“actionMethod”属性。像这样：

```
<util:foo namePrompt="SomeName" showComponent="true"/> 
```

但我收到错误消息：

```
javax.faces.FacesException: Unable to resolve composite component from using page using EL expression '#{cc.attrs.actionMethod}' 
```

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-15T19:42:00.307

您将必须创建两个`p:commandLink`元素并根据参数的定义有条件地渲染它们：

```
<p:commandLink actionListener="#{cc.attrs.actionMethod}" rendered="#{!empty cc.getValueExpression('actionMethod') and cc.attrs.showComponent}">
  <h:outputText value="#{cc.attrs.namePrompt}"/>
</p:commandLink>
<p:commandLink rendered="#{empty cc.getValueExpression('actionMethod')}">
  <h:outputText value="#{cc.attrs.namePrompt}"/>
</p:commandLink> 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2016-08-09T08:56:18.207

将方法签名返回类型更改为 java.lang.Object 并添加“null”作为默认值。

```
<composite:interface>
    <composite:attribute name="namePrompt" required="true"/>
    <composite:attribute name="actionMethod" method-signature="java.lang.Object action()" required="false" default="null"/>
    <composite:attribute name="showComponent" default="false"/>
</composite:interface>

<composite:implementation>
    <div>
       <p:commandLink actionListener="#{cc.attrs.actionMethod}"
                      rendered="#{cc.attrs.showComponent}"
                      >
            <h:outputText value="#{cc.attrs.namePrompt}"/>    
       </p:commandLink>
    </div>
</composite:implementation> 
```

没有方法：

```
<util:foo namePrompt="SomeName" showComponent="true"/> 
```

用方法：

```
<util:foo actionMethod="#{someBean.someMethod()}" namePrompt="SomeName" showComponent="true"/> 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-01-22T13:56:16.240

另一种解决方案是使用操作方法创建自己的组件类型。例子：

```
<composite:interface componentType="myButton">
    <composite:attribute name="namePrompt" required="true"/>
    <composite:attribute name="actionMethod" method-signature="java.lang.String  action()" required="false"/>
    <composite:attribute name="showComponent" default="false"/>
</composite:interface>

<composite:implementation>
    <div>
       <p:commandLink actionListener="#{cc.action()}" rendered="#{cc.attrs.showComponent}">
          <h:outputText value="#{cc.attrs.namePrompt}"/>    
      </p:commandLink>
   </div>
</composite:implementation> 
```

并且 componentType 必须看起来像：

```
@FacesComponent("myButton")
public class MyButton extends UINamingContainer {

    public MyButton () {
    }

    public String action() {
        MethodExpression me = (MethodExpression) this.getAttributes().get("actionMethod");
        if (me != null) {
            try {
                Object result = me.invoke(FacesContext.getCurrentInstance().getELContext(),     null);
                if (result instanceof String) {
                    return (String) result;
                }
            } catch (ValidatorException ve) {
                throw ve;
            }
        }
        return null;
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-06-30T10:59:43.350

有同样的错误，也需要在我的组件上有一个可选的操作方法。

因此，我尝试使用方法签名在复合属性上添加默认参数，指向相应 FacesComponent 类上的方法，效果很好！

零件：

```
<composite:interface componentType="myButton">
    <composite:attribute name="namePrompt" required="true"/>
    <composite:attribute name="actionMethod" method-signature="java.lang.String  action()" required="false" default="#{cc.dummyAction}"/>
    <composite:attribute name="showComponent" default="false"/>
</composite:interface>

<composite:implementation>
    <div>
       <p:commandLink action="#{cc.attrs.actionMethod}"
                      rendered="#{cc.attrs.showComponent}"
                      >
            <h:outputText value="#{cc.attrs.namePrompt}"/>    
       </p:commandLink>
    </div>
</composite:implementation> 
```

FacesComponent 类：

```
@FacesComponent("myButton")
public class MyButton extends UINamingContainer {

    public MyButton () {
    }

    public String dummyAction() {
       return "";
    }

} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-07-24T16:31:55.490

避免将方法放在复合材料中。如果您需要这样做，请将具有该方法的类放在组合内，并像这样使用它：

```
<composite:interface>
   <composite:attribute name="classWithMethod" 
                        method-signature="java.lang.String"/>
</composite:interface> 
```

和实施：

```
<composite:implementation>
   <div>
      <p:commandLink 
         actionListener="#{cc.attrs.classWithMethod.actionMethod}">    
      </p:commandLink>
   </div>
</composite:implementation> 
```

为我工作！:D

# excel - Excel 宏最近邻

> ID：15420082
> 
> 赞同：0
> 
> 时间：2013-03-14T21:00:32.110
> 
> 标签：excel, nearest-neighbor, vba

我有一个包含 4 张纸的 Microsoft Excel 文档。每张纸有 21 行和大约 500 列。我正在尝试编写一个最近邻函数来填充这些工作表中具有特定值的所有单元格。

行数据布局示例：

> 1.  25 41 54 54 XX 41 54 XX XX XX 54 14
> 2.  23 88 33 XX 41 54 XX 87 48 65 77 14

我需要检查所有数据并将 XX 替换为最近的行邻居。我认为这可以`for`通过遍历每个值（每行中的每一列）并查看当前单元格是否为 XX 的嵌套循环来完成。如果是这样，它应该抓取没有 XX 值的最近邻居。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T03:22:18.060

我会对此进行尝试...但请记住，由于您没有回应澄清请求，因此这可能与您的想法不完全一致。此外，我在没有访问运行 VBA 的机器的情况下执行此操作，因此可能存在一两个微不足道的错误。

```
Option Explicit
sub fillNN()
' we know there are five rows; number of columns is "approximate".
dim thisRow as Integer
dim s, c
dim r, rLast as range

for each s in WorkBook.WorkSheets
  s.Activate
  set r = Range("A1")

  For thisRow = 1 To 5
    set r = Range("A1").Offset(thisRow-1,0)
    set rLast = r.End(xlToRight) ' find the last cell in the row

    for each c in Range(r, rLast).cells
      if c.Value = "XX" Then
        c.Value = nearestNeighbor(c)
      end if
    next c
  Next thisRow

  ' the nearestNeighbor() function left the "XX" on the value
  ' now we have to strip it:
  For thisRow = 1 To 5
    set r = Range("A1").Offset(thisRow-1,0)
    set rLast = r.End(xlToRight) ' find the last cell in the row

    for each c in Range(r, rLast).cells
      if Left(c.Value, 2) = "XX" Then
        c.Value = MID(c.Value, 3, len(c.Value)-2)
      end if
    next c
  Next thisRow

Next s
End Sub

Function nearestNeighbor(c as Range)
' find the nearest "valid" cell:
' look to the left and to the right; if nothing found, extend the range by 1 and repeat
Dim rc, cc , dr, cs, s as Integer
Dim lastCol as Integer
Dim flag as Boolean
flag = true
s = 1 ' size of step

lastCol = c.End(xlToRight).column

' if c is the last cell, then the above will go to the end of the spreadsheet
' since we know there are "about 500" columns, we can catch that easily:
if lastCol > 1000 Then lastCol = c.column

' make sure there is always a return value:
nearestNeighbor = "XX"
While (flag)
  For dr = -1 To 1 Step 2
    cs = c.column + dr * s
    If Not(cs < 1 Or cs > lastCol) Then
      If Not c.offset(dr * s, 0).Value = "XX" Then
        flag = false
        ' keep the "XX" in front so it won't become a "valid nearest neighbor" on next pass
        nearestNeighbor = "XX" + c.offset(dr * s, 0).Value
        Exit For
      End If
    End If
  Next dr
  s = s + 1
  if s > lastCol Then flag = false
End While

End Function 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T04:58:23.470

试试下面的代码：

假设您的数据如下图所示。

![在此处输入图像描述](../Images/9c911fb9e765c5c68fa0600b7a5e5861.png)

代码 ：

```
Sub Sample()
    Dim rng As Range
    Set rng = Cells.Find("XX")

    Do Until rng Is Nothing
        rng.Value = rng.Offset(0, -1) 'Offset(0, -1) for left neighbour  , Offset(0, 1) for right
        Set rng = Cells.Find("XX")
    Loop
End Sub 
```

# c# - 从文本文件中删除一些特殊单词

> ID：15420083
> 
> 赞同：1
> 
> 时间：2013-03-14T21:00:34.073
> 
> 标签：c#, regex

我编写以下代码从文本文件中删除一些像 (is|are|am|could|will|i|we|you) 等的词，但它给出了错误的结果..

```
 Regex replacer = new Regex("\b(?:is|are|am|could|will)\b");
        using (TextWriter writer = new StreamWriter("C:\\output.txt"))
        {
            using (StreamReader reader = new StreamReader("C:\\input.txt"))
            {
                while (!reader.EndOfStream)
                {
                    string line = reader.ReadLine();
                    replacer.Replace(line, "");
                    writer.WriteLine(line);
                }
            }
            writer.Flush();
        } 
```

任何人帮助我......

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-14T21:06:04.300

输入行不会被正则表达式更改，您应该写入文件替换结果：

```
 string line = reader.ReadLine();
 writer.WriteLine(replacer.Replace(line, "")); 
```

也使用`@`字符来转义模式中的斜杠

```
Regex replacer = new Regex(@"\b(is|are|am|could|will)\b"); 
```

# jakarta-ee - servlet 在浏览器上工作但在 eclipse 上不工作

> ID：15420085
> 
> 赞同：0
> 
> 时间：2013-03-14T21:00:41.820
> 
> 标签：jakarta-ee

我正在制作一个简单的 servlet，它获取名称和密码并将消息返回给 browser.my servlet 在浏览器上工作但在 eclipse 中不工作。实际上它是在浏览器中调用**NewClass** ?user=vibhu&pass=mishra 。在 Eclipse 中它调用**Login** ?user=vibhu&pass=mishra

```
<form action ="NewClass" method ="get">
---
</form>
web xml
 <servlet-name>NewClass</servlet-name>
  <servlet-class>NewClass</servlet-class>
  </servlet>
  <servlet-mapping>
  <servlet-name>NewClass</servlet-name>
  <url-pattern>/NewClass</url-pattern> 
```

# c++ - 带有 std::pair 键的 std::map ，其中对元素没有顺序重要性

> ID：15420086
> 
> 赞同：3
> 
> 时间：2013-03-14T21:00:42.583
> 
> 标签：c++, stl

正如问题所说，我需要以这种方式使用 std::map 。

```
std::map<std::pair<int, int>, int*> m;

int* a_ptr = new int;
*a_ptr = 15;
m[std::make_pair(1, 2)] = a_ptr;
std::cout << *m[std::make_pair(2, 1)] << std::endl; //should output 15 
```

现在，在我的实际实现中，所有的键和值实际上都是指针。我应该如何解决这个问题？

我想到了两个想法。

1.  一个是我应该写一个函数，每次我`m[]`用来访问或写入地图时，我还应该`m.find()`检查另一对组合并按照它行事。

2.  其他是使用带有自定义哈希的 std::unordered_map ，这 **在切换元素位置****时以某种方式没有区别。`pair`（我不知道该怎么做，如果我将两个指针相乘或相加，结果将不相等。如果这是要走的路，需要一些帮助。）**

如果您能想到更好的方法，我会很高兴听到它，否则我在第二条中说明了我需要帮助的内容。（我认为效率更高，第一个看起来不太好）

谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-14T21:05:10.833

你能简单地确保这些对总是按相同的顺序排列吗？使用辅助函数，例如：

```
std::pair<int,int> my_make_pair(int a, int b) 
{
    if ( a < b ) return std::pair<int,int>(a,b);
    else return std::pair<int,int>(b,a);
} 
```

并始终使用它来访问地图：

```
m[my_make_pair(1,2)] = a_ptr;
std::cout << m[my_make_pair(2, 1)] << std::endl; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-14T21:09:59.843

只需使用自定义比较器

```
[](std::pair<int, int> const& lhs, std::pair<int, int> const& rhs) {
   int lhs_min = std::min(lhs.first, lhs.second);
   int lhs_max = std::max(lhs.first, lhs.second);
   int rhs_min = std::min(rhs.first, rhs.second);
   int rhs_max = std::max(rhs.first, rhs.second);

   return lhs_min < rhs_min || (!(rhs_min < lhs_min) && lhs_max < rhs_max)
} 
```

### 这是如何运作的？

前几行确定性地对一对中的 2 个元素进行排序；也就是说，您可以按任意顺序提供它们，并且`lhs_min`&`lhs_max`将是相同的。然后，我们对结果使用标准等效技术。所有整数副本都将由编译器优化并且`min`/`max`将被内联。

请注意，我使用 C++11 的 lambdas 是为了方便输入，但后来发现没有很好的方法可以将它们用作 a 的比较器`std::map`，因此您必须正确编写一个仿函数。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-14T21:09:39.937

```
template<typename T, typename PairCmp = std::less<std::pair<T,T>> >
struct symmetric_pair_sort {
  bool operator()( std::pair<T,T> const& left, std::pair<T,T> const& right ) const {
    if (left.second<left.first) {
      return (*this)(std::make_pair( left.second, left.first ), right );
    }
    if (right.second<right.first) {
      return (*this)(left, std::make_pair( right.second, right.first ) );
    }
    return PairCmp()(left, right);
  }
};

// or, the far bulkier yet more efficient:
template<typename T, typename PairCmp = std::less<std::pair<T&, T&>> >
struct symmetric_pair_sort {
  template<bool left_reversed, bool right_reversed>
  bool Helper( std::pair<T,T> const& left, std::pair<T,T> const& right ) const {
    std::pair<T&, T&> left_ordered( left_reversed?left.first:left.second, left_reversed?left.second:left.first );
    std::pair<T&, T&> right_ordered( right_reversed?right.first:right.second, right_reversed?right.second:right.first );
    return PairCmp()( left_ordered, right_ordered );
  }
  bool operator()( std::pair<T,T> const& left, std::pair<T,T> const& right ) const {
    if (left.second<left.first) {
      if (right.second<right.first) {
        return Helper<true, true>(left, right);
      } else {
        return Helper<true, false>(left, right);
      }
    } else {
      if (right.second<right.first) {
        return Helper<false, true>(left, right);
      } else {
        return Helper<false, false>(left, right);
      }
  }
};

std::map<std::pair<int, int>, int*, symmetric_pair_sort<int> > m; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-14T21:10:13.650

另一种解决方案是使用`std::set<int>`而不是`std::pair<int,int>`. 集合存储有序的数据，因此无需订购您的配对，因此准确地满足您的要求。

另一方面，使用明确排序对的比较包装器的其他答案可能更实用。

# workflow-foundation-4 - 使用 WorkflowApplication 调用的调试工作流有时不会在 Workflow 的断点处中断

> ID：15420087
> 
> 赞同：0
> 
> 时间：2013-03-14T21:00:43.033
> 
> 标签：workflow-foundation-4

是否有人在 WorkflowApplication 中调试工作流时遇到问题，有时它不会在 Execute 方法的断点处中断？这种情况并非一直发生，但相当频繁。我试过删除 .suo 文件并重新打开 VS2012，但通常没有帮助。

如果您遇到过这种情况，您通常会怎么做才能让它再次在断点处中断？

此外，是否有可以附加到调试的 WorkflowApplication 进程，类似于我附加到 IIS 进程（w3wp.exe）的方式？如果是，WorkflowApplication 进程的名称是什么？

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-30T16:56:54.027

您可以尝试删除 bin 和 obj 文件夹并重新构建所有文件夹。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T19:04:37.457

看起来我发现了我的问题。这是我在尝试调试的 Activity 类中遇到的程序集加载问题。我能够通过附加到 IIS 进程来调试 Activity，但是一旦我将代码添加到 Activity 的执行方法中以实例化日志程序集，它就无法中断执行方法。

Activity 编译得很好，但是当我使用 WorkflowApplication 运行 Activity 时，我必须处理 WorkflowApplication 的 Aborted 或 OnUnhandledException 事件才能发现 Activity 无法加载或找不到日志程序集。

感谢大家花时间帮助我解决问题！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-15T14:10:21.810

WorkflowApplication 不是实际的应用程序，它是一个承载工作流的组件。要使用 WorkflowApplication 执行工作流，您必须拥有将保存 WorkflowApplication 并执行工作流的应用程序（控制台、win 服务等）。您可以附加该过程。

# html - 如何使用 HTTP 流式传输音频

> ID：15420096
> 
> 赞同：0
> 
> 时间：2013-03-14T21:01:06.507
> 
> 标签：html, http, audio

我正在处理一个遗留的播客服务，现在似乎是利用 HTML5 的好时机。我们的用户从我们的网站访问此服务，如果这些匿名用户能够无缝体验我们的过渡，那就太好了。我打算使用[Media Element](http://mediaelementjs.com/)。

我担心我不知道的事情……似乎一切。可以用这个论坛询问背景信息吗？

甚至连“流媒体”的定义都不清楚。有些人专门用这个词来指代非持久性数据的直播。我们的播客服务使用静态 MP3 文件。因此，它的重要价值在于强制客户端在下载数据时“播放”数据。实现这种期望的客户行为的后台有什么魔力？

我刚刚注意到 Firefox 现在自动执行了这个魔法。为什么花了 20 年才添加这个相当明显的功能？

流式静态数据与传统数据传输的最大区别在于搜索能力：如果我将 10 首音乐曲目组合成一个播放列表文件（我的老派想法的专辑），那么用户应该能够跳到最后一个在没有干预数据的情况下进行跟踪。这需要一个请求，在中途发出，改变原始响应。这些机制与 HTML 无关（如在 HTML5 中）。我猜 Flash、RealAudio 等除了任何专有编解码器之外，肯定还创建了 HTTP 专有扩展。HTML5 如何在不对 HTTP 标准进行相应升级的情况下实现媒体流标准化？

我觉得有点像彼得希格斯定义假设玻色子的性质。显然，有一些协议可以处理完成这种形式的流式传输所需的请求/响应。但是由于我什至无法确认它们的存在，因此询问有关服务器操作的问题似乎是推测性的。尽管如此，兼容 HTML5 的浏览器会以某种方式与我的旧服务器兼容，这似乎是一种信念的飞跃。

应该很简单。我错过了什么？

谢谢！吉姆

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-16T01:28:32.353

You're correct that "Streaming Media" is a bit of an overloaded term. I tend to think that the vast majority of streaming media content is delivered via vanilla HTTP requests.

*"I just noticed that Firefox now performs this magic automatically. Why did it take 20 years to add this rather obvious feature?"*

I think that many browsers have had the capability to play at least simple audio formats natively for sometime (I think versions of Netscape from 1995 would handle some plain PCM WAV, AIFF, and SND files). About being able to handle MP3 natively, there were longstanding legal, licensing, and patent battles that are still in process. That adds to the friction. By now, I think most of the major browsers can handle MP3 audio natively via the audio tag.

Regarding seeking: A sufficiently intelligent client can do that via plain HTTP. If the user issues a seek request and the portion has not been downloaded yet, the client could close the HTTP connection, create a new one, and request a certain range of bytes. And that's only if the entire file hasn't been downloaded already. It's possible that Media Element already does something like this.

In your playlist example, the 10 tracks should be separate files, rather than squashed together into one big file. Once playback finished on the first track, the JavaScript can receive a signal that tells it to update the UI and request the second file for playback. If the user elects to skip to track 10 while playing track 1, then the client just requests track 10.

I hope I've helped. I know the feeling you're expressing-- not sure about the right question to ask in the first place.

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-16T20:05:26.813

我不知道如何回答我自己的问题。也许我能做的最好的事情就是取消任何荒谬的猜测。

我的原帖摘要：

1.  实现这种期望的客户端行为（即时处理多媒体数据）的后台魔法是什么？
2.  Firefox 发生了什么变化，现在它可以“即时”播放 MP3 音频？
3.  什么协议用于通过 HTTP 完成流式传输？

根据我对**多媒体迈克**回答的理解，如果浏览器可以访问适当的编解码器，则它会“即时”处理数据。所以 Q1 的答案是提供一个包含编解码器的插件客户端，例如 FlashPlayer 或 SilverStream。换句话说，一切都归结为专有或开放的编解码器。同样，Q2 的回答是，为了符合 HTML5，Firefox 现在包括（通过欺骗或钩子）一个 MP3 编解码器。

**多媒体 Mike**将播放列表曲目作为单独文件加载的建议并未具体回答有关底层协议的问题。在我的特定项目中，谨慎搜索将是功能降级，并且可能不可接受。

我目前的假设是，在处理搜索请求时，客户端在 TCP 级别不雅地切断了他们的连接。然后只需发出一个指定“HTTP Range”的新请求。有趣的是，这种解释与我所经历的笨拙和不可靠的反应是一致的。虽然与其他程序员的一些对话已经足够热烈，但我仍然没有权威的答案。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-03-25T15:09:06.080

我能想到的最通用的应用程序是 YouTube 中的 Flash Player。我使用[WireShark](http://www.wireshark.org/)检查 HTTP 请求。出乎意料的是，所有内容都作为 URL 搜索参数而不是 HTTP 标头传递。以下是参数列表：

*   资源
*   ipbits
*   ip
*   cpn
*   范围
*   MV
*   速率旁路
*   新闻碎片
*   钥匙
*   因素
*   公吨
*   小姐
*   活着
*   ID
*   fexp
*   算法
*   爆裂
*   垃圾邮件
*   cp
*   服务器
*   伊塔格
*   签名
*   上一页
*   到期

对于检查的所有数据包：

```
burst=40
algorithm=throttle-factor 
```

只有 range 参数似乎因请求而异：

```
range=13-1781759
range=1781760-3563519
range=3563520-5345279
range=5345280-7127039
range=7127040-8908799 
```

总而言之，这些发现似乎与该线程中讨论的所有内容一致。因此，虽然我知道这个协议是由拥有 flash 的公司编写的专有扩展，但 HTML 5 应该创建一个标准化的替代品。我仍然希望有人能回答这个基本问题：模拟 Flash 的这些功能的底层协议是什么？HTML5 可能不会包含所有这些功能。但这个答案也很重要。

-吉姆

# css - CSS需要为跟随滑块的jquery滑块制作标签

> ID：15420099
> 
> 赞同：0
> 
> 时间：2013-03-14T21:01:08.293
> 
> 标签：css, jquery-ui, uislider

我正在制作一个 jquery 滑块，我需要在滑块下方跟随一个框，其中包含滑块的值。我现在拥有的代码将滑块的值放在滑块的顶部，那么我需要添加什么 CSS 才能使此信息位于滑块下方？

`$（函数（）{

```
 $("#slider").slider({
    orientation: "horizontal",
    min: 0,
  max: 60,
  value: 60,
  slide: function(event, ui) {
    var monthYear = numberToDate(ui.value);
    var tooltip = document.createElement("span");
    tooltip.style.position = "absolute";
    tooltip.innerHTML = dateString(monthYear);
    $('.ui-slider-handle').html(tooltip);
      //$("#amount").val(dateString(monthYear));
    },
    change: function(event, ui) {
      changeColor(ui.value);    
    }
  })

  //$("#amount").val($("#slider").slider("value")); 
```

}); `

跨度`tooltip`包含我试图在滑块下方显示的信息，我只需要知道我可以使用什么 CSS 来做到这一点。

这是我到目前为止的滑块的 jsfiddle：http: [//jsfiddle.net/azrosen92/cPQan/](http://jsfiddle.net/azrosen92/cPQan/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T00:03:09.527

你可以发布一个链接吗？或者也许设置一个jsFiddle？否则不容易解决..

我要在您的代码中更改的唯一内容是：

```
$('.ui-slider-handle').html(tooltip); 
```

至

`$('.ui-slider-handle').append(tooltip);`

否则我看不到问题

# css - 如何用css隐藏多余的文字？

> ID：15420102
> 
> 赞同：1
> 
> 时间：2013-03-14T21:01:20.537
> 
> 标签：css

我有一个像这样的输入元素：

```
<input value="hello world" class="my-input"/> 
```

但是在 UI 中我只想显示没有 'world' 的 'hello' （也就是说，我想显示值的前 5 个字母）

我有可能使用 my-input 类实现这一点吗？我应该怎么做？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-14T21:03:01.883

你不能纯粹在 CSS 中做到这一点，但使用 jQuery 相当简单：

```
var myInputVal = $(".my-input").val();
$(".my-input").val(myInputVal.substr(0, 5)); 
```

见[演示](http://jsfiddle.net/MWstj/1/)。

如果需要保留输入的原始值（这样在提交表单时，它发送的是“hello world”而不是“hello”），可以使用 HTML 数据属性来“存储”原始值，然后提交表单时检索它，如下所示：

```
var myInput = $(".my-input");
var myInputVal = myInput.val();

myInput.data("original-value", myInputVal);
myInput.val(myInputVal.substr(0, 5));

$("form").submit(function(e) {
  e.preventDefault();
  myInput.val(myInput.data("original-value"));
  $(this).submit();
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-14T22:20:38.277

这是一个**[纯 CSS 解决方案](http://jsfiddle.net/DbvCu/)**

```
HTML:
<input value="1234567890" class="my-input" />

CSS:
input {
    font-family: monospace;
    font-size: 1em;
    width: 3.2em;
    padding: 0;
} 
```

使用`width`以`em`单位表示但：

*   你必须使用等宽字体（或者 an`m`会大于 an `i`）
*   `1em`等于用户最终将在其系统中看到的特定等宽字体的**高度**，而不是宽度。`M`在我当前的 Windows Vista 中，我使用默认等宽设置了 3.2em 的宽度，但您的里程可能会有所不同。

因此，您必须特别谨慎地选择您选择的字体集，并在各种 Windows 操作系统（XP、Vista、Win7 和 Win8 都安装了它们的特定字体）上进行测试，这也取决于是否安装了 MS Office 和 Adob​​e Reader，如果是 web设计师/开发人员是目标，Visual thing 和 Creative 等工具）、OS X 和 Linux 风格。和手机。或者您可以从`font-family`下载的字体开始`@font-face`，然后继续在每个操作系统上使用具有相似宽度的字体...

如果 CSS 被用户禁用或自定义，那是失败的，所以你不应该依赖输入的宽度来传达*意义*或做某种技巧。这还不够健壮（盲人用户显然既不关心也不认为您的输入在视觉上仅限于显示 5 个字符，但仍包含更多字符）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-14T21:07:37.847

我认为仅使用 CSS 是不可能做到这一点的。您可以使用 maxlength HTML 属性或在 JavaScript 中执行某些操作。我意识到这不是你要的，但我认为这是不可能的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-14T21:08:26.873

有一个新的 HTML5 属性`maxlength`可以限制输入中的字符数。( [jsFiddle](http://jsfiddle.net/LCHTw/) )

```
<input value="hello" class="my-input" maxlength="5" /> 
```

[显然对此的支持非常好。](http://www.wufoo.com/html5/attributes/03-maxlength.html)

如果您的意思是要保留有关原始字符串“hello world”的信息，则需要使用 JavaScript，纯粹使用 CSS 无法实现。`width`您可以通过使用/属性来接近，`overflow`但它会因设备而异。

# python - scrapy，无效的 xpath，起始位置

> ID：15420104
> 
> 赞同：0
> 
> 时间：2013-03-14T21:01:24.527
> 
> 标签：python, xpath, scrapy

我正在尝试使用scrapy，并且我正在尝试使用这个荒谬的html。使用 Xpath Checker firefox 插件，这是表中的第一行：

`id('page')/x:table/x:tbody/x:tr[1]/x:td[2]/x:table/x:tbody/x:tr/x:td/x:table/x:tbody/x:tr[1]`

如果我将该 xpath 复制到：

```
def parse(self, response):
      hxs = HtmlXParseSelector(response)
      data = hx.select("id('page')/x:table/x:tbody/x:tr[1]/x:td[2]/x:table/x:tbody/x:tr/x:td/x:table/x:tbody/x:tr[1]") 
```

`raise ValueError("Invalid XPath: %s" % xpath)`

为什么它不能识别这个 xpath？

另外，scrapy 有没有办法从第 3 行及以后获取所有数据？前两行只是标题和图例。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T23:53:49.687

Firefox 添加了一个 html 标签“tbody”，但真正的 html 可以没有它。尝试使用您的程序获取 html 页面并查看标记“tbody”的位置。我在Firefox中遇到了同样的问题。

# html - 为什么我的设计元素在所有浏览器中看起来都不同？更新

> ID：15420109
> 
> 赞同：-7
> 
> 时间：2013-03-14T21:01:36.213
> 
> 标签：html, css, cross-browser, responsive-design

忘了这是一个问答网站，而不是帮助论坛。我因这条消息被禁止了:(

> 我有四个内容框，但它们在 chrome 和 safari 中看起来并不相似。我用过这些盒子。如果有人可以看看这里，看看我做错了什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-14T21:10:57.640

我在 main.css 的第 544 行注意到了这一点：

```
542    .ca-menu li:hover .ca-icon {
543      color: #Fff;
544*     animation: 300ms ease 0s normal none 1 moveFromBottom;
545    } 
```

您正在使用 . 的非供应商前缀变体`animation`。Firefox 识别此属性，但 WebKit（chrome、safari 等）不识别（[有关 caniuse.com 的更多信息](http://caniuse.com/#feat=css-animation)）。添加动画属性的供应商前缀变体或将其完全删除以使其一致。

# html - 在asp中使用iframe单击锚链接时如何更改浏览器url

> ID：15420121
> 
> 赞同：0
> 
> 时间：2013-03-14T21:02:12.480
> 
> 标签：html, asp-classic

此安全网站使用 IFrame [https://www.said.net/secure/mcrostie/index-shop.asp](https://www.said.net/secure/mcrostie/index-shop.asp)。我的要求是只保证交易页面的安全。我将登录页面更改为[http://www.said.net/secure/mcrostie/index-shop.asp](http://www.said.net/secure/mcrostie/index-shop.asp)但保持“帐户”、“购物车”、“结帐”链接安全（将鼠标悬停在帐户、购物车和结帐链接）。一切似乎都运行良好，但由于安全页面是通过 IFrame 链接的，因此当用户单击这些链接时，着陆 URL 不会更改为 Https。我们如何强制浏览器显示 https 而不是 http

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T21:34:41.110

只需将指向您的交易页面的所有链接更改为使用 https，并将您网站其余部分的所有其他链接更改为使用 http。

# javascript - 具有客户端加密的 Web 应用程序

> ID：15420122
> 
> 赞同：6
> 
> 时间：2013-03-14T21:02:19.593
> 
> 标签：javascript, encryption, ssl

我正在开发一个 Web 应用程序，它将在客户端加密数据，然后将数据发送到服务器。服务器将存储加密数据，但*不*具备解密数据的能力。关键是要保证客户端数据的安全，这样即使服务器主机也无法访问数据。这可以通过服务器只接收加密数据而从不接收密钥的事实来保证。

我计划在客户端使用 Javascript 进行加密和解密。此外，连接将使用 SSL 保护。

我在这里阅读了这篇文章：http: [//www.matasano.com/articles/javascript-cryptography/](http://www.matasano.com/articles/javascript-cryptography/)这表明 Javascript 不应该用于加密，但它没有解决我的用例。

这是一个安全的解决方案吗？有没有办法让它更安全？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-04-20T21:24:19.160

查看[Host-Proof Hosting](http://ajaxpatterns.org/Host-Proof_Hosting)模式（从 2005 年 7 月开始）。

> **在眨眼草图中：**
> 
> 锁定在数据云内部，在浏览器上键入。
> 
> **解决方案**
> 
> 以加密形式托管敏感数据，以便客户端只能通过提供永远不会传输到服务器的密码来访问和操作它。服务器仅限于保存和检索浏览器发送给它的任何加密数据，并且从不实际访问纯格式的敏感数据。它。所有加密和解密都在浏览器本身内部进行。

关键点是您仍然需要使用 TLS/SSL 并完全信任将 HTML 作为 JavaScript 资源提供的主机。

此外，[个人健康信息的网络浏览器加密](http://www.biomedcentral.com/1472-6947/11/70)具有与您正在寻找的解决方案类似的解决方案。

![加密数据流](../Images/b429efc6d25afed106bc1dc9bf2cf1c5.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-14T21:31:27.483

尽管此设置本身没有任何问题，但由于客户有责任维护自己机器的安全性，我认为您可能会遇到可能导致更多问题的情况。

一是用户希望无论如何都能够访问他们的数据。如果他们在另一个关闭了 JS 的系统上，那么他们将无法访问他们的数据。

另一个，如果用户忘记了他们的密码/密钥怎么办？由于您没有存储它，因此您无法恢复数据并且它实际上已经丢失了。您将无能为力，即使这不是您的错，用户也不会那样看。

只是一些思考的食物。

# c - 没有 va_list 的自定义 printf

> ID：15420127
> 
> 赞同：0
> 
> 时间：2013-03-14T21:02:31.470
> 
> 标签：c

我正在尝试创建 printf() 的简化版本，但不使用 va_list、va_start、va_arg 和 va_end。

我最初的想法是：

> > void my_printf (char *format, ...);

然后，检查格式，并计算 % （参数）的数量，以找出传递给我的函数的变量的数量。从那里开始，我正在考虑根据有多少参数创建一个缓冲区，然后组合并使用 write() 最终输出它们。

有没有更好的方法来解决这个问题？我的计划会遇到问题吗？

任何帮助将不胜感激。

我的一些头脑风暴代码是：

```
// Count arguments
int cnt_s, cnt_c, cnt_d, cnt_u, cnt_x;
for (; *format; format++) {
    switch(format[0]) {
        case '%':
            switch(format[1]) {
                case 'd':
                    cnt_d++;
            }
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-14T21:06:15.223

您**需要** `va_list`, `va_start`, `va_arg`, 和`va_end`来访问由`...`

除非你想用`void*`和工会----- UGH！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-02-28T00:34:47.357

我能想到的最好方法（注意：这可能不安全）是获取格式字符串的地址并从中递增以找到参数。

这是我一起破解的一个工作示例（假设实现了其他打印功能）

```
int my_printf(char *format, ...) {
    void *beg = &format;
    int i;
    beg += sizeof(char*);
    for (i = 0; i < strlen(format); i++) {
        if (format[i] == '%') {
            switch (format[i+1]) {
                case 's':
                    print_s(*((char**)beg)); 
                    beg += sizeof(char*);
                    break;
                case 'd':
                    print_d(*((int*)beg)); 
                    beg += sizeof(int);
                    break;
                case 'f':
                    print_f(*((float*)beg)); 
                    beg += sizeof(float);
                    break;
            }
            i++;
        } else {
            putchar(format[i]);
        }
    }
} 
```

如果您没有提供足够的参数，这可能会导致一些意想不到的副作用，并且可能需要进行一些调整。但这就是想法。

说明：这是有效的，因为所有函数参数都按顺序推入堆栈。因此，由于您有第一个参数（格式字符串），您可以根据所需的参数获取其地址并递增，以直接访问堆栈上的参数，而无需任何 VA_ARGS 魔法。

# c# - 如何在不指定列表元素的情况下将c#中的嵌套列表序列化为XML？

> ID：15420128
> 
> 赞同：1
> 
> 时间：2013-03-14T21:02:32.113
> 
> 标签：c#, xml, xml-parsing

我有两个课程：

```
public class Foo
{
    public string FooName{get;set;}
    public List<Bar> Bars{get;set;}
}

public class Bar
{
    public string BarName{get;set;}
} 
```

如果我使用我想出的 XML 解析器序列化它：

```
<Foo>
    <FooName>ExampleFooName</FooName>
    <Bars>
        <Bar>
             <BarName>ExampleBarName</BarName>
        </Bar>
        <Bar>
             <BarName>AnotherExampleBarName</BarName>
        </Bar>
    </Bars>
<Foo> 
```

有没有办法收到这个结果：

```
<Foo>
    <FooName>ExampleFooName</FooName>

    <Bar>
         <BarName>ExampleBarName</BarName>
    </Bar>
    <Bar>
         <BarName>AnotherExampleBarName</BarName>
    </Bar>
<Foo> 
```

我希望重组 Foo 和 Bar 类，或者将一些参数传递给 XMLSerializer 以接收结果。我真的很想避免编写自己的 XML 解析器。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-14T21:16:31.140

```
public class Foo
{
    public string FooName{get;set;}
    [XmlElement("Bar")]
    public List<Bar> Bars{get;set;}
} 
```

# php - 我怎样才能重写这个仅限 PHP 成员的页面脚本？

> ID：15420129
> 
> 赞同：0
> 
> 时间：2013-03-14T21:02:35.160
> 
> 标签：php, include

我有这段代码，它向登录用户显示特定内容。但是使用这个我不能在页面上包含其他 php 文件。反正有没有重写这个，所以我可以使用包含函数。

```
<?php
   if($_SESSION['id'])
      echo '<div id="center" class="column">center here</div>
            <div id="left" class="column">leftbar here</div>
            <div id="right" class="column">rightbar here</div>';
   else
      echo '<h1>Staff please, <a href="index.php">login</a> 
            before accessing this page,   no access to students.</h1>';
?> 
```

目前我无法在上面写着“center here”、“leftbar here”和“rightbar here”的地方输入：

```
`<?php include("center.php"); ?>` 
```

我对所有这些东西都是新手，所以不要太复杂，谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T21:08:09.087

如果我理解正确应该是这样的：

```
<?php
       if($_SESSION['id'])
          echo '<div id="center" class="column">';
               include("center.php");
          echo'</div>
                <div id="left" class="column">';
              include("leftbar.php");
         echo'</div>
                <div id="right" class="column">';
             include("rightbar.php");
          echo '</div>';
       else
          echo '<h1>Staff please, <a href="index.php">login</a> 
                before accessing this page,   no access to students.</h1>';
?> 
```

# java - 应用程序上的按钮间距相等

> ID：15420131
> 
> 赞同：0
> 
> 时间：2013-03-14T21:02:40.103
> 
> 标签：java, android, xml

我的应用程序上有 2 个按钮，当前位置如下所示：

![在此处输入图像描述](../Images/3e7c6631f7e3b54d7b5c05654b0ef285.png) 我已经更改了我的 xml，以便将高度属性设置为“0dp”，并将重量设置为“1”。这为我提供了正确的等间距，但按钮现在展开以填充此空间，如下所示：

![在此处输入图像描述](../Images/abc55714dd7c982e7026654a53629b64.png)

如何修改我的布局，以便实现所需的布局？（注意：我在paint中创建了这个布局）

![在此处输入图像描述](../Images/503ae973211cb9249eb64fb0143eae99.png)

当前 XML 布局：

```
Here is my current XML code:

<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="wrap_content"
android:orientation="vertical" >

<LinearLayout
android:layout_width="match_parent"
android:layout_height="84dp"
android:orientation="horizontal" >

<ImageView
    android:id="@+id/imgLink"
    android:layout_width="78dp"
    android:layout_height="wrap_content"
    android:layout_gravity="center_vertical"
    android:src="@drawable/appointmentmanimenuicon" />

<TextView
    android:id="@+id/textView1"
    android:layout_width="match_parent"
    android:layout_height="75dp"
    android:gravity="center"
    android:text="Appointments"
    android:textAppearance="?android:attr/textAppearanceLarge"
    android:textSize="30sp" />
</LinearLayout>

<LinearLayout
android:layout_width="match_parent"
android:layout_height="400dp"
android:orientation="vertical" >

<Button
    android:id="@+id/btnaddAppoint"
    android:layout_width="match_parent"
    android:layout_height="0dp"
    android:layout_margin="20dp"
    android:drawableLeft="@drawable/appointmentmenu"
    android:src="@drawable/appointmentmenu"
    android:text="Add Appointment"
    android:layout_weight="1" />

<Button
    android:id="@+id/btnviewAppoint"
    android:layout_width="match_parent"
    android:layout_height="0dp"
    android:layout_margin="20dp"
    android:drawableLeft="@drawable/appointviewicon"
    android:src="@drawable/appointviewicon"
    android:text="View Appointments"
    android:layout_weight="1" />
</LinearLayout>

</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T21:07:47.783

您可以使用 layout_height="yourvalue" 为您的布局提供所需的高度，并使用 layout_margin="yourvalue" 安排间距...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-14T21:22:37.493

一个相当简单的解决方案是使用“虚拟”视图在按钮之间创建所需的间距。然后，您可以通过调整不同的权重来调整间距。不妨也摆脱`LinearLayout`包装两个按钮的那个 - 通常没有必要嵌套多个具有相同方向的 LinearLayouts。

尝试将`LinearLayout`两个按钮换成如下所示：

```
<View
    android:layout_width="0dp"
    android:layout_height="0dp"
    android:layout_weight="1" />

<Button
    android:id="@+id/btnaddAppoint"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:layout_marginLeft="20dp"
    android:layout_marginRight="20dp"
    android:drawableLeft="@drawable/appointmentmenu"
    android:src="@drawable/appointmentmenu"
    android:text="Add Appointment" />

<View
    android:layout_width="0dp"
    android:layout_height="0dp"
    android:layout_weight="1" />

<Button
    android:id="@+id/btnviewAppoint"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:layout_marginLeft="20dp"
    android:layout_marginRight="20dp"
    android:drawableLeft="@drawable/appointviewicon"
    android:src="@drawable/appointviewicon"
    android:text="View Appointments" />

<View
    android:layout_width="0dp"
    android:layout_height="0dp"
    android:layout_weight="1" /> 
```

# java - 无锁：将复合的非原子操作拆分为更简单的原子操作

> ID：15420136
> 
> 赞同：2
> 
> 时间：2013-03-14T21:02:54.027
> 
> 标签：java, multithreading, lock-free, atomic

作为我的 MS 项目的一部分，我正在编写一个金融市场数据分发应用程序。该应用程序即将完成，但该应用程序无法很好地扩展。

这就是它的工作原理，我订阅了一个“假”交易所来获取市场数据。订阅后，我得到一个初始快照，然后我不断收到增量......

```
1) Subscribe for IBM.
2) Snapshot : Buy:50|Size:1400||Sell:49|Size:1000
(At buy price of 50, 1400 shares and at sell price of 49, 1000 shares available)
3) Update1: -1|10||-2|25
(Buy price is now 49 (50-1), buy Size is 1410\. Sell price is 47 and sell size is 1025)
4) Update2 ...
.
.
. 
```

我有一个处理市场数据的类，下面的 dataUpdate() 是“假”交换应用程序在一个线程中调用的回调方法。

```
class MarketDataProcessor:
Map<String, MarketData> marketDataMap      = new HashMap<String, MarketData>(1000);
ConcurrentMap<String, MarketData> distMap  = new ConcurrentHashMap<String, MarketData>();

//**Always called by one thread (MarketDataThread)**
    public void dataUpdate( MarketDataUpdate dataUpdate ){

            try{
                 //IBM
                 String symbol   = dataUpdate .getSymbol();             
                 MarketData data = marketDataMap.get( symbol );

                 if ( data = null ){
                    data = new MarketData( dataUpdate );
                 }else{
                    //Apply the delta here and save it ...
                    marketDataMap.put( symbol, data );
                 }

                 distMap.put( symbol, data );

            }catch( Exception e ){
               LOGGER.warn("Exception while processing market data.");
               LOGGER.warn("Exception: {}", e);
            }
    } 
```

从交易所获取市场数据后，我需要以线程安全的方式分发它。**这是不能很好扩展的方法，因为它可以被 20 多个线程调用，并且它使用外部锁来确保原子性。**

```
public final double[] getData( String symbol, Side side ){
     double[] dataArray = {0.0, 0.0};

     synchronized( LOCK ){
        MarketData data = distMap.get( symbol );
        dataArray       = ( side == BUY ) ? getBuyData(data) : getSellData(data); 
     }

  return dataArray;
} 
```

**这是我提出的解决方案是将上述方法一分为二。**

```
//No external lock as it uses a ConcurrentHashMap
public final MarketData getData( String symbol ){
       return distMap.get( symbol );
}

//State of this method is now confimed to the
//stack of the calling thread, therefore thread safe.
public final double[] getData( MarketData data, Side side ){
       return ( side == BUY ) ? getBuyData(data) : getSellData(data); 
} 
```

承认这会改变 api 并使用户调用两种方法而不是一种方法，如果不使用外部锁，它不是线程安全的吗？

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-14T21:29:14.680

将许多线程转储到一个需要时间的同步线程中并不是一个好主意。

您能否将这些结果转储到同步队列中以供稍后分析？单个线程可以将项目从队列中拉出，而许多线程将其放入。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-15T03:09:25.363

首先，我不知道您的 LOCK 控制访问的资源是什么。你的代码的哪一部分是不安全的，为什么你认为使用 LOCK 有帮助？您的新方法也没有提供与原始方法相同的签名。您是否希望人们像使用它一样使用它

```
getData(getData(symbol), side) 
```

?

如果没有锁的原始代码不是线程安全的，那么您的新方法与此没有什么不同。

回到你原来的实现：你在 LOCK 保护的代码段中访问的唯一资源是 distMap。没有其他地方正在使用LOCK。因此，您在这里所做的是您只需要 1 个线程从 distMap***获取数据。***但是我看不出这样做的理由：首先 distMap 是一个 ConcurrentMap，它是线程安全的，可以被多个线程访问。其次，对于每一种 Map，简单地获取数据总是线程安全的，因为没有人改变状态。通常你需要执行同步控制的应该包括状态改变逻辑，这是你在地图中放置数据的地方（尽管在这段特定的代码中，没有理由添加额外的同步控制），但你没有这样做. 我根本无法理解您的 LOCK 的全部目的。

对您的一些评论：只是盲目地使用同步/锁定等不会自动将您的代码更改为线程安全的。您需要知道什么不是线程安全的，并相应地进行同步控制。另一条评论是：将非原子方法分解为原子片段不会使您的代码成为线程安全的。换一种方式想一想：Java 中几乎所有最低级别的操作都是原子的。这是否意味着您的代码是自动线程安全的，因为您正在调用一堆原子操作？明显不是。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-15T03:33:54.723

虽然其他答案提供了很好的建议，但还有另一个可用的选项是无锁的：使用持久映射（如来自 pcollections）。读取器线程将始终拥有一致的数据快照；编写器线程将创建地图的新版本，但不会复制所有数据。

# jquery - Rails 4：如何将表单构建器对象传递给使用 javascript (jQuery) 更新的嵌套表单

> ID：15420137
> 
> 赞同：3
> 
> 时间：2013-03-14T21:02:54.110
> 
> 标签：jquery, ruby-on-rails, ujs, ruby-on-rails-4

我正在将一个工作应用程序从 Rails 2.3 更新（并重构）到 Rails 4.0。这个应用程序包括一个名为“智能组”的功能。一个智能组建立一个搜索查询，可以保存并重新用于查找一组“人”记录。

一个智能组有_many 个智能组规则，每个智能组规则属于具有零个或多个运算符的属性。

创建智能组的表单还处理添加智能组规则。选择规则的属性后，应更新表单以显示所选属性的关联运算符和用于输入规则值的字段。

问题是在选择属性时需要动态更新表单，以便显示所选属性的运算符。这是我在 Rails 4.0 中似乎无法弄清楚的部分。

```
class SmartGroup < ActiveRecord::Base
  has_many :rules, :class_name => "SmartGroupRule", :foreign_key => "smart_group_id"

  accepts_nested_attributes_for :rules, reject_if: :all_blank, allow_destroy: true
end

class SmartGroupRule < ActiveRecord::Base
  belongs_to :smart_group
  belongs_to :smart_group_property
  belongs_to :operator 
end

class SmartGroupProperty < ActiveRecord::Base
  has_many :smart_group_rules
  has_many :property_operators
  has_many :operators, through: :property_operators  
end

class Operator < ActiveRecord::Base
  has_many :property_operators
  has_many :smart_group_properties, through: :property_operators  
end 
```

一个例子是：

智能组：所有 30 多岁的人。规则 1：年龄大于 29 岁的人。规则 2：年龄小于 40 岁的人。

属性是“年龄”。“年龄”属性有 3 个可选运算符：小于、大于和精确。规则 1 的“值”是 29，规则 2 的“值”是 31。

我正在使用 Ryan Bate 的技术向 Railscast 第 196 集“嵌套模型表单（修订版）”中的表单添加多个规则。

```
#smart_groups/_form.html.erb
<%= simple_form_for(@smart_group) do |f| %>
  <%= f.error_notification %>

 <%= f.input :name %>
 <%= f.input :definition %>

 <%= f.simple_fields_for :rules do |rule_form| %>
  <%= render 'rule_fields', f: rule_form %>
 <% end %>

 <%= link_to_add_fields "Add Rule", f, :rules %>
    <%= f.button :submit %>
<% end %>

#smart_groups/_rule_form.html.erb
 <%= field_set_tag 'Smart Group Rule' do %>
  <%= f.association :smart_group_property, label_method: :prose, input_html: {class: "property_selector"} %>
  <span id="property-fields">

  </span>
  <%= f.hidden_field :_destroy %>
  <%= link_to "remove this rule", '#', class: "remove_fields" %>
 <% end %>

<script type="text/javascript" charset="utf-8">
 $(".property_selector").observe_field(1, function( ) {
  var data = {'property_id' : $(this).val()};
  var url = '/smart_groups/property_selected';
  $.get(url, data, function(html) {
   $("#property_operator").html(html);
  });
 });
</script>
#this is inline because I can't figure out how to do it unobtrusively. 
```

Railscast 中的辅助方法。

```
# ApplicationHelper
  def link_to_add_fields(name, f, association)
      new_object = f.object.send(association).klass.new
      id = new_object.object_id
      fields = f.fields_for(association, new_object, child_index: id) do |builder|
        render(association.to_s.singularize + "_fields", f: builder)
      end
      link_to(name, '#', class: "add_fields", data: {id: id, fields: fields.gsub("\n", "")})
  end

# js.coffee
  $('form').on 'click', '.add_fields', (event) ->
    time = new Date().getTime()
    regexp = new RegExp($(this).data('id'), 'g')
    $(this).before($(this).data('fields').replace(regexp, time))
    event.preventDefault() 
```

这个助手，连同这个咖啡脚本，成功地向页面添加了多个智能组规则表单。

现在的问题是：在规则表单中选择属性值时，需要使用所选属性的运算符更新表单的其余部分。我正在使用上面的内联 js，它使用 jQuery.observe_field 插件来观察属性选择器。调用控制器操作，并将所选属性的 id 作为 property_id 发送到控制器。

```
class SmartGroupsController < ApplicationController
  def property_selected
    @property = SmartGroupProperty.find(params[:property_id])
    @partial_name = @property.short + "_fields"
  end
end 
```

这允许设置变量@partial_name。

然后使用所选属性的操作符的部分更新视图（或“应该”更新）：

```
#property_selected.js.erb
$("#property-fields").html("<%= j render partial: @partial_name, locals: {f: f} %>"); 
```

…但我不知道如何将表单构建器对象发送到表单…或者是否有可能使用 Rails 4 以这种方式接近它。

我收到此错误：

```
ActionView::Template::Error (undefined local variable or method `f' for #< <Class:0x007f9884088120>:0x007f98824c9e98>):
    1: $("#property-fields").html("<%= j render partial: @partial_name, locals: {f: f} %>");
  app/views/smart_groups/property_selected.js.erb:1:in                                _app_views_smart_groups_property_selected_js_erb__2922231718460238483_70146499765020' 
```

如何通过 property_selected 操作从 _rule_form 获取表单的构建器对象，并将其传递到表单的更新部分？有没有更好的方法来解决这个问题？

感谢您的任何输入/方向。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-11-04T18:45:37.910

I would prefer you to use a dynamic form generating gems. Those gems have js to event observer for forms dom changes.

You may have a look at this gem. [https://github.com/nathanvda/cocoon](https://github.com/nathanvda/cocoon)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-19T22:21:43.893

我认为，您不能在此部分中传递表单构建器变量......但您并不真正需要它。如果您只使用`fields_for`它将创建一个单独的参数并且您可以在控制器中使用此参数集，那就更好了。

```
<%=fields_for 'properties' do |extra_fields| %>
  <% ... %>
<% end %> 
```

检查你的 development.log 当你提交表单时传递了什么样的参数......

# wso2 - WSO2 身份服务器停用用户帐户

> ID：15420138
> 
> 赞同：0
> 
> 时间：2013-03-14T21:02:58.347
> 
> 标签：wso2

通过查看用户帐户的日志，我看到有一个名为“ [http://wso2.org/claims/accountStatus](http://wso2.org/claims/accountStatus) ”的声明显示为一个复选框。我已经启用了该声明，现在我设置了它的值。然而，除了保持价值之外，它什么也不做。有没有办法阻止禁用帐户的用户登录（尤其是通过 SAML SSO 登录）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T05:16:29.537

您可以通过更改用户用户组的权限来禁用登录。（因此，如果您需要阻止登录，请将他添加到该用户组）。您可以在用户权限树 [http://docs.wso2.org/wiki/display/IS410/Editing+User+Roles中取消选中它](http://docs.wso2.org/wiki/display/IS410/Editing+User+Roles)

# java - ActiveMQ 实际上并不尊重内存限制

> ID：15420143
> 
> 赞同：0
> 
> 时间：2013-03-14T21:03:15.640
> 
> 标签：java, jms, activemq

我正在尝试将 ActiveMQ 设置为使用内存限制和生产者流控制，以便在内存不足时尝试发送消息时看不到挂起行为。我遵循了[Producer Flow Control](http://activemq.apache.org/producer-flow-control.html)、[My producer blocks](http://activemq.apache.org/my-producer-blocks.html)和[Connection Configuration URI](http://activemq.apache.org/connection-configuration-uri.html)的文档，但运气不佳。

我遇到的问题是这些设置实际上并没有得到适当的尊重。

我的 ActiveMQ 代理在我的 Spring 配置中是这样设置的（我已经稍微清理了一下，所以可能不是 100% 有效的 Spring 配置）：

```
<bean id="broker" class="org.apache.activemq.broker.BrokerService"
    init-method="start">
    <property name="brokerName" value="broker" />
    <property name="persistent" value="false" />
    <property name="useJmx" value="true" />
    <property name="managementContext" ref="mgmtContext" />
    <property name="transportConnectorURIs">
        <list>
            tcp://localhost:1234?jms.prefetchPolicy.queuePrefetch=0&jms.useAsyncSend=false&jms.alwaysSyncSend=true
        </list>
    </property>
        <property name="destinations">
            <list>
                <bean class="org.apache.activemq.command.ActiveMQQueue">
                    <property name="physicalName" value="requests"></property>
                </bean>
                <bean class="org.apache.activemq.command.ActiveMQQueue">
                    <property name="physicalName" value="responses"></property>
                </bean>
            </list>
    </property>
</bean> 
```

然后在我的一个代码初始化方法中，我设置了以下内容：

```
broker.getSystemUsage().setSendFailIfNoSpace(true);
broker.getSystemUsage().setSendFailIfNoSpaceAfterTimeout(5000);

// Limit memory usage to 10MB
broker.getSystemUsage().getMemoryUsage().setLimit(10 * 1024 * 1024); 
```

然而，当我运行我的代码时，我仍然在我的日志中看到如下内容：

```
2013-Mar-14 14:47:31.538 GMT-06:00 DEBUG [ActiveMQ Transport: tcp:///127.0.0.1:45846@18086] [org.apache.activemq.usage.Usage:fireEvent] [Usage.java:245] [] [] [] - Main:memory: usage change from: 5640% of available memory, to: 0% of available memory 
```

所以 ActiveMQ 似乎公然无视设置的内存限制。

如果将足够大的消息放入队列，我仍然会看到可能发生的阻塞行为，如果我将非常大的消息放入队列，甚至会出现 OOM 错误。

如何可靠地配置 ActiveMQ 以限制其内存使用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2019-06-21T22:09:47.273

对于希望以编程方式管理代理限制的任何人，这里有一个示例：

```
 @Bean
    public BrokerService broker()
            throws Exception {
        final BrokerService broker = new BrokerService();
        broker.addConnector("tcp://localhost:61616");
        broker.addConnector("vm://localhost");
        broker.setPersistent(false);
        broker.getConsumerSystemUsage().getMemoryUsage().setLimit(100 * 1024);
        broker.getConsumerSystemUsage().getStoreUsage().setLimit(1024 * 1024);
        broker.getConsumerSystemUsage().getTempUsage().setLimit(100 * 1024);
        return broker;
    } 
```

感谢这篇文章的起点： [如何在 Spring Boot 中设置 ActiveMQ 端口？](https://stackoverflow.com/questions/42681595/how-to-set-activemq-port-in-spring-boot/44669417#44669417)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-22T06:55:47.043

您是否尝试过直接使用 xml 文件配置您的代理？您可以这样做（摘自[官方 Java 示例](https://svn.apache.org/repos/asf/activemq/trunk/assembly/src/test/java/org/apache/activemq/config/BrokerXmlConfigStartTest.java)）：

BrokerService 代理 = BrokerFactory.createBroker(configUrl);

稍后我将尝试获取一个正在运行的 Spring 示例

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-08-13T04:19:48.687

我已经尝试过了，但我无法解决我正在寻找的问题，但我终于得到了下面的链接，它有完整的信息

[http://blogs.sourceallies.com/2014/10/activemq-memory-tuning/](http://blogs.sourceallies.com/2014/10/activemq-memory-tuning/)

感谢上面的线程，我得到了解决方案。上面的线程有大量的信息。我已将 activemq.xml 更改如下

```
<systemUsage>
            <systemUsage>
                <memoryUsage>
                    <memoryUsage limit="2048 mb"/>
                    <!--Earlier it use to be 
                    <memoryUsage limit="64 mb"/>
                    -->
                </memoryUsage>
                <storeUsage>
                    <storeUsage limit="100 gb"/>
                </storeUsage>
                <tempUsage>
                    <tempUsage limit="50 gb"/>
                </tempUsage>
            </systemUsage>
        </systemUsage> 
```

# configuration - 在 EWL 中，如何配置电子邮件以使用需要用户名/密码的 SMTP 服务器？

> ID：15420148
> 
> 赞同：1
> 
> 时间：2013-03-14T21:03:26.833
> 
> 标签：configuration, smtp, enterprise-web-library

我知道我可以在 Standard.xml 中更改 SMTP 服务器。但是我看不到在哪里可以为该 SMTP 服务器指定用户名和密码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T13:56:09.940

配置架构当前不支持指定 SMTP 服务器凭据。当然可以添加对此的支持，但还没有人这样做。

# sql-server - 使用/CTE 语句进行调整

> ID：15420149
> 
> 赞同：0
> 
> 时间：2013-03-14T21:03:29.060
> 
> 标签：sql-server, with-statement

使用 SQL Server 2012 .... 此代码作为独立脚本工作，但我需要在`iif(...)`嵌套在 a中返回的值`Case...when`作为更大脚本的一部分：

```
with GroupedValues (Value, Frequency, SelectingCriteria) AS
(Select
    Table1.Cost as Value,
    Count(*) as Frequency,
Table2.AccountNumber as SelectingCriteria

from Table1, Table 2 
)

Group by Table1.Cost, Table2.AccountNumber) 

Select
    Max(Value) as Value
From GroupedValues a INNER JOIN
    (select Max(Frequency) AS MaxFrequency
     from GroupedValues) b
on a.Frequency=b.MaxFrequency 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T21:14:51.537

我相信你只是这样做：

```
select top 1 
  Value
from (
  select
    Table1.Cost, Table2.AccountNumber
    Count(*) as Frequency,
    Table1.Cost as Value
  from Table1 cross join Table2 
  group by Table1.Cost, Table2.AccountNumber, Table1.Cost 
) T
order by 
  Frequency desc, 
  Value desc 
```

# javascript - 为响应式布局重新调整大小时操作 jquery 菜单

> ID：15420151
> 
> 赞同：17
> 
> 时间：2013-03-14T21:03:36.237
> 
> 标签：javascript, jquery, html, css, responsive-design

有带有列表项目的简单菜单。UL LI。LI 的宽度和数量是动态的。悬停/单击时会出现“更多”下拉菜单，它将显示剩余的 LI ，这不适合可用空间。

我尝试在用户从右到左调整窗口大小时使用 jquery，它会隐藏最后一个可见的菜单项。执行此操作的可能方法是什么，并在“更多”链接中添加 LI。

尝试了一些选项，因为当我们调整大小时宽度较小，然后列表项移动到下方并增加 UL 的高度，所以使用这种方法我可以隐藏最后一个可见的。代码

[http://jsbin.com/flexmenu/2/edit](http://jsbin.com/flexmenu/2/edit)

**步骤1**

![调整窗口大小](../Images/639bb50035b0bf550167d2000355d2e5.png)

**第2步**![在此处输入图像描述](../Images/89ee8dca67382ceaa241ed41e56c4136.png)

**第 3 步**![在此处输入图像描述](../Images/2c0121b5c287e99e25ca1e1ddf3a835f.png)

当用户重新调整大小（增加宽度）时，这些步骤将相反

标记

```
<div class="twelve columns filter-wrapper">
    <ul class="nav-bar-filter" id="nav-bar-filter">
        <li><a href="#">All</a></li>
        <li><a href="#">Small</a></li>
        <li><a href="#">Medium</a></li>
        <li><a href="#">Extra large</a></li>
        <li><a href="#">Text</a></li>
        <li><a href="#">Small-1</a></li>
        <li><a href="#">Medium-1</a></li>
        <li><a href="#">Extra large text</a></li>
        <li><a href="#">Large text</a></li>
        <li><a href="#">Text</a></li>
    </ul>
<ul id="more-nav">
  <li><a href="#">More > </a>
    <ul class="subfilter"><li><a href="#">Text</a></li></ul>
  </li>    
</ul>
</div> 
```

基本上这个菜单将用于响应式布局菜单。这方面的任何帮助都会有所帮助。编辑 1：添加标记

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-03-19T12:49:06.453

好吧，我已经尝试构建一些脚本来执行此操作，这就是我所拥有的：

```
$().ready(function () { 

    //we reconstruct menu on window.resize
    $(window).on("resize", function (e) {                                                   
        var parentWidth = $("#nav-bar-filter").parent().width() - 40;
        var ulWidth = $("#more-nav").outerWidth();                  
        var menuLi = $("#nav-bar-filter > li");                 
        var liForMoving = new Array();      
        //take all elements that can't fit parent width to array
        menuLi.each(function () {                       
            ulWidth += $(this).outerWidth(); 
            if (ulWidth > parentWidth) {
                console.log(ulWidth);
                liForMoving.push($(this));
            }
        });                         
        if (liForMoving.length > 0) {   //if have any in array -> move them to "more" ul
            e.preventDefault();                     
            liForMoving.forEach(function (item) {
                item.clone().appendTo(".subfilter");
                item.remove();
            });                         
        }
        else if (ulWidth < parentWidth) { //check if we can put some 'li' back to menu
            liForMoving = new Array();
            var moved = $(".subfilter > li");
            for (var i = moved.length - 1; i >= 0; i--) { //reverse order
                var tmpLi = $(moved[i]).clone();
                tmpLi.appendTo($("#nav-bar-filter"));
                ulWidth += $(moved[i]).outerWidth();
                if (ulWidth < parentWidth) {                                
                    $(moved[i]).remove();
                }
                else {
                    ulWidth -= $(moved[i]).outerWidth();
                    tmpLi.remove();
                }                           
            }                       
        }                       
        if ($(".subfilter > li").length > 0) { //if we have elements in extended menu - show it
            $("#more-nav").show();
        }
        else {
            $("#more-nav").hide();
        }
    });

    $(window).trigger("resize"); //call resize handler to build menu right
}); 
```

和[JSFiddle 示例](http://jsfiddle.net/3AU2N/1/)

必须更改您的 css 样式以使其正常工作。我们所做的是：

1.  获取父容器的宽度，`width`主菜单的初始值为零，但我们可能必须显示附加菜单，所以我们也得到它的大小。
2.  `window.resize`我们循环遍历主菜单（水平）中的所有元素，在变量中累积每个元素的宽度`ulWidth`。
3.  一旦`width`主菜单超过`width`父容器 -> 我们需要将其余菜单项移动到子菜单（垂直） - 所以我们将这些元素推送到数组`liForMoving`。
4.  如果数组`liForMoving` **不为**空 - 我们克隆它的元素，将它们附加到子菜单并从主菜单中删除它们。
5.  如果`width`所有元素中的所有元素`mainMenu`都小于其容器的宽度，我们需要检查是否可以将某些元素从子菜单移动到主菜单
6.  我们遍历子菜单元素，抓取每个项目，附加到主菜单（如果菜单中有不同的字体和填充 - 元素的最终大小会有所不同），检查它的大小是否适合父容器。如果**是**- 我们从子菜单 ( `$(moved[i]).remove()`) 中删除元素，如果**不是**- 我们删除附加元素 ( `tmpLi.remove()`)
7.  最后我们检查子菜单是否有任何项目，并显示/隐藏它。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-03-23T21:35:52.080

```
$(document).ready(function () {
    var menu = $("#nav-bar-filter"),
        subMenu = $(".subfilter"),
        more = $("#more-nav"),
        parent = $(".filter-wrapper"),
        ww = $(window).width(),
        smw = more.outerWidth();

    menu.children("li").each(function () {
        var w = $(this).outerWidth();
        if (w > smw) smw = w + 20;
        return smw
    });
    more.css('width', smw);

    function contract() {
        var w = 0,
            outerWidth = parent.width() - smw - 50;
        for (i = 0; i < menu.children("li").size(); i++) {
            w += menu.children("li").eq(i).outerWidth();
            if (w > outerWidth) {
                menu.children("li").eq(i - 1).nextAll()
                    .detach()
                    .css('opacity', 0)
                    .prependTo(".subfilter")
                    .stop().animate({
                    'opacity': 1
                }, 300);
                break;
            }
        }
    }

    function expand() {
        var w = 0,
            outerWidth = parent.width() - smw - 20;
        menu.children("li").each(function () {
            w += $(this).outerWidth();
            return w;
        });
        for (i = 0; i < subMenu.children("li").size(); i++) {
            w += subMenu.children("li").eq(i).outerWidth();
            if (w > outerWidth) {
                var a = 0;
                while (a < i) {
                    subMenu.children("li").eq(a)
                        .css('opacity', 0)
                        .detach()
                        .appendTo("#nav-bar-filter")
                        .stop().animate({
                        'opacity': 1
                    }, 300);
                    a++;
                }
                break;
            }
        }
    }
    contract();

    $(window).on("resize", function (e) {
        ($(window).width() > ww) ? expand() : contract();
        ww = $(window).width();
    });

}); 
```

[演示](http://jsfiddle.net/arcm111/XabcS/)

必须修改 CSS 才能使其工作。我没有为任何元素提供静态尺寸，以便菜单无论其内容如何都能做出响应。

它是如何工作的：只有两个函数`contract()`，`expand()`当页面加载`contract()`将被调用以将额外的项目移动到子菜单时，当窗口被调整大小时，如果它正在扩展`expand()`将被调用，如果它正在收缩`contract()`将被调用。

更新：在右侧添加了动画和固定子菜单位置，请参阅演示。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-14T21:25:17.577

试试这个：让你的 jQuery 检测栏中有多少项`nav`必须被截断。然后，使用JavaScript 方法根据截断的术语数`li`向 中添加元素。例如，如果您的 jQuery 检测到 5 个术语已被截断，则使用以下代码：`ul``document.createElement()`

```
var truncated_elements = 5;
for (i=1; i<truncated_elements; i++){
    var new_li = document.createElement('li');
    new_li.innerHTML = "truncated_term";
    document.getElementsByTagName('ul')[0].appendChild(new_li);
} 
```

在上面的代码中，jQuery 会计算出需要截断 5 个元素，并运行一个`for`循环，在循环中它会`li`为每个截断的元素创建 s。的`innerHTML`将`new_li`设置为被截断元素的内容（可能使用数组），然后`new_li`将附加到`ul`“更多”子菜单中的 。

如有必要，我可以提供 JSFiddle/JSBin。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-04-06T12:17:43.013

我认为下拉菜单应该颠倒，以使选项卡序列以相同的顺序保持在可聚焦项目中。

对于可访问性，您还可以设置集合大小和集合中的位置。出于可访问性的原因，当移动的元素具有焦点并添加 setWaiAria 以设置 setsize 和设置位置时，我将焦点重置为克隆项目。当更多链接具有焦点并消失时，将焦点设置到最后一项。见[小提琴](http://jsfiddle.net/frontendplace/rvx26j1c/1/)

```
$().ready(function () { 

  var setWaiAria = function(menuLi){
    menuLi.each(function (i,el) {
      var $el = $(el);
      $el.attr('aria-setsize',menuLi.length);
      $el.attr('aria-posinset',i+1);
    });
  }

  // set wai aria aria-setsize and aria-posinset before cloning elements in other list
  setWaiAria($("#nav-bar-filter > li"));

  //we reconstruct menu on window.resize
  $(window).on("resize", function (e) {                         
    var parentWidth = $("#nav-bar-filter").parent().width() - 40;
    var ulWidth = $("#more-nav").outerWidth();          
    var menuLi = $("#nav-bar-filter > li");         
    var liForMoving = new Array();
    var activeElement = $(document.activeElement)[0];

    // before remove item check if you have to reset the focus
    var removeOriginal = function(item,clone){
      // check focused element
      if(item.find('a')[0] === activeElement){
        activeElement = clone.find('a')[0];
      }

      item.remove();
    }

    //take all elements that can't fit parent width to array
    menuLi.each(function () {
      var $el = $(this);            
      ulWidth += $el.outerWidth(); 
      if (ulWidth > parentWidth) {
        liForMoving.unshift($el);
      }
    }); 

    if (liForMoving.length > 0) { //if have any in array -> move em to "more" ul
      e.preventDefault(); 

      liForMoving.forEach(function (item) {
        var clone = item.clone();
        clone.prependTo(".subfilter");

        removeOriginal(item, clone);
      });

    }
    else if (ulWidth < parentWidth) { //check if we can put some 'li' back to menu
      liForMoving = new Array();

      var moved = $(".subfilter > li");
      for (var i=0, j = moved.length ; i < j; i++) { 
        var movedItem = $(moved[i]);

        var tmpLi = movedItem.clone();
        tmpLi.appendTo($("#nav-bar-filter"));

        ulWidth += movedItem.outerWidth();
        if (ulWidth < parentWidth) {
          removeOriginal(movedItem, tmpLi);
        }
        else {
          // dont move back
          ulWidth -= movedItem.outerWidth();
          tmpLi.remove();
        }

      }
    }           
    if ($(".subfilter > li").length > 0) { //if we have elements in extended menu - show it
      $("#more-nav").show();
    }
    else {
      // check if 'more' link has focus then set focus to last item in list
      if($('#more-nav').find('a')[0] === $(document.activeElement)[0]){
        activeElement = $("#nav-bar-filter > li:last-child a")[0];
      }

      $("#more-nav").hide();
    }

    // reset focus
    activeElement.focus();
  });

  $(window).trigger("resize"); //call resize handler to build menu right
}); 
```

# facebook - 在 AJAX 调用 Facebook Open Graph 对象后使用 jQuery 提交表单

> ID：15420153
> 
> 赞同：0
> 
> 时间：2013-03-14T21:03:43.867
> 
> 标签：facebook, jquery, coffeescript, facebook-opengraph

我创建了一个 Facebook Open Graph 对象和操作。它工作得很好，并且已经过全面测试。问题是我想在返回数据时提交不同的表单。

为了清楚起见，用户可以使用两个按钮：

1.  通过单击提交表单的“发布”按钮发布项目或
2.  单击“使用 Facebook 发布”，它将打开图形对象请求发送到 Facebook，然后在返回时从另一个按钮提交相同的发布表单。

**这是代码：**

```
$(".publish_with_fb_action").click ->
$form = $("form.publish_item")
$.post "https://graph.facebook.com/me/my_app_name:add?item=" + app.showUrl + "&access_token=" + FB.getAccessToken(), (data) ->
$form.submit() 
```

同样，此代码将项目放在 Facebook 上没有问题。奇怪的是，当我在我的应用程序中使用另一个 URL 测试相同的代码（jQuery AJAX 帖子）时，它实际上可以工作并提交表单，但是对于这个特定的代码，它不起作用。

我研究了其他解决方案，例如更改`$form`为 just`form`或 even `form[0]`，但仍然没有运气。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T22:26:55.703

整体解决方案涉及将**成功**回调子句更改为**always**。

```
$(".publish_with_fb_action").click ->
  $this = $(this)
  $form = $(".publish_item")
  $.post( "https://graph.facebook.com/me/<my_app>:add?item=" + app.showUrl + "&access_token=" + FB.getAccessToken()
  ).always (data) ->
    $form.submit()
    $this.html "added to facebook" 
```

# ruby - Amazon OpsWorks 自定义说明书 RVM

> ID：15420155
> 
> 赞同：4
> 
> 时间：2013-03-14T21:03:46.313
> 
> 标签：ruby, amazon-web-services, rvm, chef-infra

我正在尝试使用以下食谱[https://github.com/fnichol/chef-rvm](https://github.com/fnichol/chef-rvm)使用 Amazon OpsWorks 安装 RVM 。我希望 rvm 在用户 tomcat6 下运行，所以我包含了具有正确属性的配方 rvm::user。

我得到的错误是：

> 2013 年 3 月 6 日星期三 20:05:05 +0000 错误：运行异常处理程序 2013 年 3 月 6 日星期三 20:05:05 +0000 错误：异常处理程序完成 2013 年 3 月 6 日星期三 20:05:05 +0000 调试：重新引发异常：LoadError - 没有要加载的文件 - rvm /opt/aws/opsworks/current/site-cookbooks/rvm/recipes/default.rb:29:in `require' /opt/aws/opsworks/current/site-cookbooks/rvm/recipes/default.rb:29:in`from_file'

引发异常的代码是：

```
chef_gem 'rvm' do
action :install
version '>= 1.11.3.6'
end

ruby_block "require rvm" do
    block do
        require 'rvm'
        create_rvm_shell_chef_wrapper
        create_rvm_chef_user_environment
     end
     action :create
end 
```

收到错误后，我使用 ssh 登录实例并检查是否安装了 rvm gem。我看不到*** LOCAL GEMS ***下列出的 rvm 。

然后我用 gem_package 替换了方法 chef_gem ，仍然得到同样的错误。但是这次当我检查 gem list rvm 时列出了。

有什么帮助吗？提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-25T02:44:46.117

问题在这里突出显示：[https ://forums.aws.amazon.com/thread.jspa?threadID=118646](https://forums.aws.amazon.com/thread.jspa?threadID=118646)

OpsWorks 的厨师实施受到亚马逊的严格限制。当 chef 在节点上运行时，它实际上是通过一个包运行的。由于 rvm 食谱正在将一个新的 gem (rvm) 安装到系统中并尝试使用它，因此它失败了，因为 rvm gem 还不*是*捆绑包的一部分（在 Gemfile 中列出）。

在撰写本文时，当前的解决方法是 opsworks 已经实现了一种方法来支持自定义 gem 的使用。

我已经能够更新您提到的行：

```
if defined?(OpsWorks) && defined?(OpsWorks::InternalGems)
  OpsWorks::InternalGems.internal_gem_package('rvm', :version => node['rvm']['chef_internal_rvm_gem_version'])
else
  chef_gem 'rvm' do
    action :install
    version '>= 1.11.3.6'
  end
end 
```

让我知道这是否适合您！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T18:55:39.843

您确定您使用的是最新的 rvm 食谱吗？查看给您错误的[recipes/default.rb](https://github.com/fnichol/chef-rvm/blob/master/recipes/default.rb) - 此文件的内容与您在描述中发布的内容不同。

# c# - 在 for (each) 循环中设置多个buttons.Content

> ID：15420157
> 
> 赞同：0
> 
> 时间：2013-03-14T21:03:51.147
> 
> 标签：c#, wpf, list, foreach

编辑：

8年后，不要使用这种方法！

花时间学习 WPF 和数据绑定。

想知道这个问题是从哪里来的吗？单击编辑按钮。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T08:19:02.943

If your Buttons Named like Button1,Button2,Button3....

you could use `FindChild<T>()`
[here you get the method](https://stackoverflow.com/a/1759923/1993545)

```
for(int i =0; i< SPItems.Count;i++) // iterates for each item in your SPItems
{
     Button foundButton =  UIHelper.FindChild<Button>(Application.Current.MainWindow, "Button"+i);

     if(foundButton != null) //Protecteted agains trying to use Null-Reference
     {
          var foundButtonTextBlock =foundButton .Content as TextBlock

          if(foundButtonTextBlock != null)//Protecteted agains trying to add Text by Null-Reference
               foundButtonTextBlock.Text  = SPItems[i];
     }
} 
```

## Edit

**as normal way:**

```
 for(int i =0; i< SPItems.Count;i++) // iterates for each item in your SPItems
    {
         TextBlock foundTextBlock =  UIHelper.FindChild<TextBlock>(this, "SubItem"+1+i+"txt");

         if(foundTextBlock != null) //Protecteted agains trying to add Text by Null-Reference
         {
              foundTextBlock .Text  = SPItems[i];
         }
    } 
```

**as Painful way:**

```
int i =0;
if(SPItems.Count >0)
{
    SubItem1txt.Text = SPItems[i]; 
    i++;
}
if(SPItems.Count >1)
{
    SubItem2txt.Text = SPItems[i];
    i++;
}
if(SPItems.Count >2)
{
    SubItem3txt.Text = SPItems[i];
    i++;
}
if(SPItems.Count >3)
{
    SubItem4txt.Text = SPItems[i]; 
    i++;
}
if(SPItems.Count >4)
{
    SubItem5txt.Text = SPItems[i]; 
    i++;
}
if(SPItems.Count >0)
{
    SubItem6txt.Text = SPItems[i];
    i++;
}
if(SPItems.Count >5)
{
    SubItem7txt.Text = SPItems[i];
    i++;
}
if(SPItems.Count >6)
{
    SubItem8txt.Text = SPItems[i];
    i++;
}
//..... never ever do this 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-14T21:21:27.170

不要在代码中为这些简单任务操作 UI 元素。这是执行您所要求的 WPF 方式：

```
<Window x:Class="WpfApplication4.Window18"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Window18" Height="300" Width="300">
    <ItemsControl ItemsSource="{Binding}">
        <ItemsControl.ItemTemplate>
            <DataTemplate>
                <Button Content="{Binding}" Margin="2"/>
            </DataTemplate>
        </ItemsControl.ItemTemplate>
    </ItemsControl>
</Window> 
```

代码背后：

```
using System.Windows;
using System.Linq;

namespace WpfApplication4
{
    public partial class Window18 : Window
    {
        public Window18()
        {
            InitializeComponent();

            DataContext = Enumerable.Range(0, 20).Select(x => "Item" + x);
        }
    }
} 
```

这是它在我的屏幕上的样子：

![在此处输入图像描述](../Images/3c315a463afcb4fd050cce55ce2e7fb8.png)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-15T15:22:57.400

感谢[WiiMaxx](https://stackoverflow.com/users/1993545/wiimaxx) ，我找到了解决方案！

通过使用[这种方法](https://stackoverflow.com/a/1759923/1993545)，我成功地使用从我的数据库中检索到的数据设置了我的按钮文本。

它变成了一个`foreach`循环，但现在它完全按照需要工作。**编辑：找到`for`版本**

我有一个`WrapPanel`，其中包含 my `buttons`，其中又包含 my `TextBlock's`。

因为我`TextBlock's`不是从（例如：）开始，`0`所以我需要创建一个额外的. 我希望这对某人有用。`1``SubItem1txt``int`

谢谢大家 ：） ！

### foreach 版本：

```
int i = 1;
int a = 0;
foreach (string spi in SPItems)
    {
        WrapPanel pnl = UIHelper.FindChild<WrapPanel>(this, "SubItems");
        Button btn = UIHelper.FindChild<Button>(pnl, "SubItem" + i);
        TextBlock tb = UIHelper.FindChild<TextBlock>(btn, "SubItem" + i + "txt");
        btn.Visibility = Visibility.Visible;
        tb.Text = SPItems[a];
        a++;
        i++;
    } 
```

### 对于版本：

```
 int i = 1;
    for (int a = 0; a < SPItems.Count; a++)
    {
        WrapPanel pnl = UIHelper.FindChild<WrapPanel>(this, "SubItems");
        Button btn = UIHelper.FindChild<Button>(pnl, "SubItem" + i);
        TextBlock tb = UIHelper.FindChild<TextBlock>(btn, "SubItem" + i + "txt");
        btn.Visibility = Visibility.Visible;
        tb.Text = SPItems[a];
        i++;
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-14T21:07:27.550

这是一种肮脏的解决方案，但如果您要操作表单上的所有按钮，那么它是值得的。我所知道的最简单的方法是将所有按钮添加到一个`ArrayList`（是的，手动，这是痛苦的部分），然后循环遍历该列表。

# django - Django Celery Task how to know it run?

> ID：15420160
> 
> 赞同：0
> 
> 时间：2013-03-14T21:04:04.267
> 
> 标签：django, django-celery

I have the following task for Django Celery (using Amazon SQS).

```
@task
def upload_task(request, **kwargs):
    file = request.FILES['file']
    ContactCSVModel.import_from_file(file)
    return True 
```

This appears to work i.e. the file is successfully added it to my database, but I'm not sure it's using Celery at all. How do I know if this worked. Should I see something? In the terminal I ran...

manage.py `celery worker --loglevel=info`, which states I have one task called `contacts.tasks.upload_task`, but I never see anything happen it just states...

> [2013-03-14 20:52:47,947: INFO/MainProcess] consumer: Connected to sqs://AJSUQJZKNSJA81JM@localhost//

Any idea's if my task has run and was completed (yes I know it completed due to it being in the database, but was that via Celery?)

this is where the task gets run from

views.py

```
@login_required
def upload(request):
    # If we had a POST then get the request post values.
    if request.method == 'POST':
        form = ContactUploadForm(request.POST, request.FILES)
        # Check we have valid data
        if form.is_valid():
            upload_task(request)
            #file = request.FILES['file']
            #ContactCSVModel.import_from_file(file)
            messages.add_message(request, messages.SUCCESS, 'Items have been added')
        else:
            messages.add_message(request, messages.ERROR, ' Cannot upload CSV file.')

            return render_to_response('contacts/home.html', context_instance=RequestContext(request))
    else:
        form = ContactUploadForm()
        # Do this part no matter the outcome above.
    context = {'form': form}
    return render_to_response('contacts/home.html', context, context_instance=RequestContext(request)) 
```

like I said this works the csv data in loaded into the database, but I don't think Celery is doing anything.

this is my Celery settings....

```
# Celery
BROKER_TRANSPORT_OPTIONS = {'queue_name_prefix': 'celery-'}
BROKER_TRANSPORT = 'sqs'
BROKER_TRANSPORT_OPTIONS = {
    'region': 'eu-west-1',
    }
BROKER_USER = 'xyz'
BROKER_PASSWORD = 'xyz' 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-14T21:14:14.693

The reason you're not seeing evidence of the task in your Celery worker log is because you're not actually calling your task asynchronously. In your views.py, instead of `upload_task(request)`, try `upload_task.delay(request)`, and then check out the worker log. In order to have a task-decorated function run asynchronously, you must use either the .delay() or .apply_async() methods. Amongst other places in the documentation, this is covered [here](http://docs.celeryproject.org/en/latest/getting-started/first-steps-with-celery.html#calling-the-task).

More generally, if you're looking for a more visually appealing way to track and manage tasks, check out [celery flower](https://pypi.python.org/pypi/flower).

# ember.js - Ember.js 默认选择文本未显示在 Ember.Select in '1.0.pre';

> ID：15420177
> 
> 赞同：0
> 
> 时间：2013-03-14T21:04:49.907
> 
> 标签：ember.js

我正在使用 Ember.js '1.0.pre' 版本。

我正在尝试使用：

```
{{view Ember.Select prompt="Select one option..."}} 
```

其渲染为：

```
<select id="ember2531" class="ember-view ember-select"> 
Select one option... 
<script id="metamorph-41-start" type="text/x-placeholder"></script> 
<script id="metamorph-41-end" type="text/x-placeholder"></script> </select> 
```

我没有看到 <option>Select one option...</option> 正在呈现。

这是 Ember.js '1.0.pre' 版本中的错误吗？

# javascript - 将数据字符串转换为对象？

> ID：15420187
> 
> 赞同：0
> 
> 时间：2013-03-14T21:05:36.437
> 
> 标签：javascript, jquery

考虑到使用语言资源（尤其是在 SharePoint 中），我想将我的 HTML 标记文本绑定到我的一个资源 JavaScript 对象中的一个值（SharePoint 有一个可以执行此操作的处理程序）。我想做这样的事情：

HTML：

`<div id="helloMessage" data-stringResource="helloString" />`

JS：

```
 $('div').each(function() {
      $(this).text(SP.Publishing.Resources. + $(this).attr('data-stringResource'));
  }); 
```

理想情况下，我想要的是在那个文本函数中传递`SP.Publishing.Resources.helloString`. 我想我可以用它`eval()`来做到这一点，但我到处都读到它是邪恶的。有什么我可以做的吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-14T21:06:27.943

使用成员运算符的方括号形式。

```
$(this).text(SP.Publishing.Resources[$(this).attr('data-stringResource')]); 
```

它使用`toString()`括号中表达式返回的任何值作为属性名称。

# linux - 搜索带有字母“o”和数字 6 的文件

> ID：15420189
> 
> 赞同：0
> 
> 时间：2013-03-14T21:05:40.690
> 
> 标签：linux, bash

我有一个目录，其中包含大约 2,000 个文件名不同的文件。

我需要打印出所有包含字母 o 并在 o 右侧有 6 个两个空格的文件名。例如：

flow6，tro168，arrow6ish。

我会使用类似的东西：

```
find -name 'o*6' 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-14T21:11:11.800

请不要解析`ls`输出（如线程前面所建议的那样），而是试试这个：

```
printf '%s\n' *o?6* 
```

例子 ：

```
$ ls -1
arrow6ish
flow6
o6
oaaaaaaaaa6
tro168

$ printf '%s\n' *o?6*
arrow6ish
flow6
tro168 
```

如果您需要对结果运行命令，[最简单的是](http://partmaps.org/era/unix/award.html#ls)：

```
commandX *o?6* 
```

这就是全局魔法。

如果您需要递归，请使用

```
find . -type f -name '*o?6*' 
```

* * *

`ls`是一种交互式查看文件信息的工具。它的输出是为人类格式化的，并且会导致脚本中的错误。使用 glob 或 find 代替。了解原因： http: [//mywiki.wooledge.org/ParsingLs](http://mywiki.wooledge.org/ParsingLs)

* * *

了解有关[glob](http://mywiki.wooledge.org/glob)的更多信息

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-14T21:16:39.297

```
find . -name "*o?6*" 
```

应该达到你想要的。`printf`如果文件包含在嵌套的子目录中，这比解决方案更可取。

# javascript - 使用 JQuery 基于鼠标位置定位标签

> ID：15420190
> 
> 赞同：0
> 
> 时间：2013-03-14T21:05:52.100
> 
> 标签：javascript, jquery, html

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-14T21:23:03.660

**使用 CSS3：（** `**[CSS3 LIVE DEMO](http://jsbin.com/obagel/3/edit)**` 不会跟随鼠标...但是嘿！）

* * *

**使用 jQuery：**

*   您可以使用以下方法跟踪`a`具有`b`内部的元素`.has()`

*   比你只是在你的 CSS 中准备一个`#tooltip`元素并用 jQuery 将它附加到 DOM

*   比跟踪`mouseenter`, `mouseleave`, 和`mousemove`你做你的工具提示的外观和动作

`**[LIVE DEMO](http://jsbin.com/obagel/2/edit)**`

```
$(function(){ // DOM ready

    $('body').prepend('<div id="tooltip" />');
    $tool = $('#tooltip');
    var toolW = $tool.outerWidth(true) / 2; // w/2 to make it always horiz. centered

    $('.controller a').has('b').on('mouseenter mouseleave', function( e ){

      var opac = e.type=='mouseenter' ? 1 : 0 ;
      var text = $('b', this).text();
      $tool.text(text).stop().fadeTo(300,opac, function(){
          if(opac===0)$tool.hide(); // if mouseleave make sure to hide tooltip
      });

    }).on('mousemove', function( e ){

       var mPos = {X: e.clientX, Y:e.clientY};
       $tool.css({left: mPos.X-toolW, top: mPos.Y+15});

    });

}); 
```

CSS：

```
.controller a b {      
  display:none;      
}

#tooltip{
  z-index:1000;
  width:180px;
  padding:10px;
  border-radius:10px;
  box-shadow:0 0 3px #666;
  display:none;
  position:absolute;
  background:rgba(255,255,255,0.7)
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-14T21:19:01.593

你为什么不使用[jQuery UI Tooltips](http://jqueryui.com/tooltip/)例如，一个你想要的自定义它，[API](http://api.jqueryui.com/tooltip/)允许你做几乎所有的事情，比如[效果](http://jqueryui.com/tooltip/#custom-animation)和[鼠标跟踪](http://jqueryui.com/tooltip/#tracking)。

它真的很容易使用：

在您的属性上设置标题：

```
<a href="#about" class="arrows" id="aboutarrow" title="about">
    <b id="aboutarrow">About</b>
</a> 
```

而不是抛出工具提示事件：

```
$(function() {
    $( document ).tooltip({
      track: true
    });
}); 
```

看到这个[小提琴](http://jsfiddle.net/soyuka/9c9a7/)并尝试一些东西！

# html - 基于标签而不是输入框css的填充

> ID：15420195
> 
> 赞同：1
> 
> 时间：2013-03-14T21:06:04.127
> 
> 标签：html, css

我目前有一个设置很像以下小提琴的表单：http: [//jsfiddle.net/8bbaF/2/](http://jsfiddle.net/8bbaF/2/)

我试图让每个输入框在它们之间有一定数量的空白。目前，格式基于每个标签的长度。我希望格式与标签长度无关。标签当前位于输入框的顶部，它们必须保留在那里。任何帮助将不胜感激。

```
<div class="inputForm">
<form id="newInput">

    <div class="inputFields">
        <label for="lists">Lists<input name="lists"/></label>
        <label for="new1">New Field 1<input name="new1"/></label>

    </div>
    <div class="inputFields">
        <label for="lists">Listswqwerqwer<input name="lists"/></label>
        <label for="new1">New Field 1<input name="new1"/></label>

    </div>

</form> 
```

CSS：

```
.inputForm label{
    display:inline-block;
}
div.inputFields{
    display:inline-block;
}
.inputFields input{
    padding-right:3%;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-14T21:24:52.100

不要将输入字段放在标签内。它造成了很多问题。看看这个：http: [//jsfiddle.net/8bbaF/6/](http://jsfiddle.net/8bbaF/6/)

```
<div class="inputForm">
<form id="newInput">

    <div class="inputFields">
        <label for="lists">Lists</label><input name="lists"/>
        <label for="new1">New Field 1</label><input name="new1"/>

    </div>
    <div class="inputFields">
        <label for="lists">Lists</label><input name="lists"/>
        <label for="new1">New Field 1</label><input name="new1"/>

    </div>

</form> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-14T21:21:00.023

为每个`inputFields`容器设置一个边距并稍微调整您的 CSS：

**CSS**

```
.inputFields {
    display: inline-block;
    margin-right: 15px;
}

.inputFields label,
.inputFields input {
    display: block;
} 
```

**[演示](http://jsfiddle.net/4svcA/2/)**

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-14T21:35:11.543

这是一种方法：

```
<div class="inputForm">
    <form id="newInput">
        <div class="inputFields">
            <label for="lists">Lists</label>
            <input name="lists" />
        </div>
        <div class="inputFields">
            <label for="new1">New Field 1</label>
            <input name="new1" />
        </div>
        <div class="inputFields">
            <label for="lists">Listswqwerqwer</label>
            <input name="lists" />
        </div>
        <div class="inputFields">
            <label for="new1">New Field 1</label>
            <input name="new1" />
        </div>
    </form>
</div> 
```

使用 CSS

```
div.inputFields {
    display: inline-block;
    margin-right: 20px;
    width: 40%;
    margin: 10px;
    border: 1px solid gray;
}

.inputForm label {
    display: block;
}
.inputFields input {
    display: block;
    width: 90%;
} 
```

还有小提琴：http: [//jsfiddle.net/audetwebdesign/pg8Kh/](http://jsfiddle.net/audetwebdesign/pg8Kh/)

我看到其他人首先带着基本相同的想法来到这里。根据您希望如何在布局网格上放置字段，存在一些变化。

但是，关键是将 保留`<label>`为单独的元素。

# ruby-on-rails - 在 Rails Admin 中保存后重定向到自定义操作

> ID：15420199
> 
> 赞同：0
> 
> 时间：2013-03-14T21:06:09.437
> 
> 标签：ruby-on-rails, redirect, custom-action, rails-admin

我一直在使用 Rails Admin，我想在模型的创建和更新操作之后自定义重定向。

我创建了一个新插件，并在后端设置了它。我可以单击选项卡，它会将我带到查看页面。我想做的是重写编辑并创建操作以在保存/更新后重定向到此页面。

我在谷歌上搜索过，但由于某种原因，我尝试的一切都不起作用。欢迎任何见解。

谢谢你。

=====

之后我试图重定向到裁剪页面。我不确定我会把代码放在哪里。我是否将其放入下面的 RailsAdminCrop 模块中？如果是这样，怎么做？文档没有提到这一点。

配置：

```
require 'rails_admin/config/actions'
require 'rails_admin/config/actions/base'
require "rails_admin_crop/engine"

module RailsAdminCrop
end

module RailsAdmin
  module Config
    module Actions
      class Crop < RailsAdmin::Config::Actions::Base

        register_instance_option :member do
          true
        end

        register_instance_option :link_icon do
          'icon-th-large'
        end

        register_instance_option :controller do
         Proc.new do
           flash.now[:notice] = ": #{@object.title}." 
         end
       end

      end
    end
  end
end 
```

还是通过将块传递给编辑操作将其放入 rails_admin.rb 初始化程序？如果是这样，我应该放什么配置？

```
 module RailsAdmin
    module Config
      module Actions
        class Crop < RailsAdmin::Config::Actions::Base
          RailsAdmin::Config::Actions.register(self)
        end
      end
    end
  end

 config.actions do
    dashboard
    index
    new

    crop

    show
    edit
    delete
  end 
```

在 rake 路由之后（这是默认路由）：

```
Routes for RailsAdmin::Engine:
    dashboard GET         /                                      rails_admin/main#dashboard
        index GET|POST    /:model_name(.:format)                 rails_admin/main#index
          new GET|POST    /:model_name/new(.:format)             rails_admin/main#new
       export GET|POST    /:model_name/export(.:format)          rails_admin/main#export
  bulk_delete POST|DELETE /:model_name/bulk_delete(.:format)     rails_admin/main#bulk_delete
history_index GET         /:model_name/history(.:format)         rails_admin/main#history_index
  bulk_action POST        /:model_name/bulk_action(.:format)     rails_admin/main#bulk_action
         show GET         /:model_name/:id(.:format)             rails_admin/main#show
         edit GET|PUT     /:model_name/:id/edit(.:format)        rails_admin/main#edit
       delete GET|DELETE  /:model_name/:id/delete(.:format)      rails_admin/main#delete
 history_show GET         /:model_name/:id/history(.:format)     rails_admin/main#history_show
  show_in_app GET         /:model_name/:id/show_in_app(.:format) rails_admin/main#show_in_app 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-22T00:28:36.660

我不相信你可以通过配置来做到这一点，你需要扩展插件。此外，您只能使用一个 redirect_to 或每个操作呈现，因此您需要将操作分配给一个变量，然后在最后调用它。

```
register_instance_option :controller do
  Proc.new do

    flash.now[:notice] = ": #{@object.title}."

    if request.post? || request.put?
      some_action = "do_something"
    else
      some_action =  @action.template_name
    end

    render :action => some_action
  end
end 
```

# c# - 将变量值交易到网络浏览器的最安全方法？

> ID：15420201
> 
> 赞同：1
> 
> 时间：2013-03-14T21:06:14.890
> 
> 标签：c#, security

示例代码

```
WebBrowser wb = new WebBrowser();
string securedKey = "1ed9f7e4"; 
```

我想将变量“securedKey”传输到同一表单上的 WebBrowser 对象。我可以通过 POST 或 GET 来完成，但它并不安全。

我可以加密变量然后发送到 Web，但它很容易调试应用程序并查看我如何加密以及将其发送到何处。

做这样的事情最安全的方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T21:09:31.560

使用 HTTPS 而不是 HTTP。还有其他方法，但由于您特别要求最安全，这是您唯一的选择。

# java - 不审核 OneToMany 关系的缺点是什么？

> ID：15420205
> 
> 赞同：2
> 
> 时间：2013-03-14T21:06:26.673
> 
> 标签：java, hibernate, jpa, hibernate-envers, auditing

我正在使用 Hibernate Envers 记录对数据库的所有更改。我注意到，当我添加一个与另一个实体具有 ManyToOne 关系的实体时，也对一侧实体进行了修订。外键位于关系的多方面，因此当在多方面添加实体时，映射一侧的实体不会更新。但仍在为映射一侧的实体插入修订。

我使用此处建议的方法禁用了 OneToMany 映射的审核： [Whats the difference between @NotAudited and RelationTargetAuditMode.NOT_AUDITED in Hibernate EnVers?](https://stackoverflow.com/questions/5661682/whats-the-difference-between-notaudited-and-relationtargetauditmode-not-audited)

现在这个答案表明，当我检索关系时，它总是会返回当前实体。这是否意味着我无法获得旧版本映射一侧的信息？

目前我不确定如何查询已审核的日志，但从表结构看来，我可以随时获取实体的当前状态。

假设我选择不审计 OneToMany 映射，那么下面的表结构会发生什么？

审核 OneSideEntity 修订版 1 的 OneSideEntity 修订版 5 的 OneSideEntity

审核 ManySideEntity1 ManySideEntity1 at revision 2 ManySideEntity1 at revision 3 ManySideEntity1 ManySideEntity1 at revision 2

审核 ManySideEntity2 版本 6 的 ManySideEntity2 版本 7 的 ManySideEntity2 版本 8 的 ManySideEntity2 版本 9 的 ManySideEntity2

两个 ManySideEntity 对象都指向 OneSideEntity。

当我在修订版 5 - [ManySideEntity1] 或 [ManySideEntity1, ManySideEntity2] 查询一对多映射时，我将获得哪些实体。

上述问题表明我会得到后者，但在修订版 5 中我更喜欢第一个。我在这里错过了什么吗？

同样对于给定的时间戳，我认为我可以找到小于该时间戳的所有修订。这可以确保我在 AUDITING 日志中有准确的表信息。如果答案是 [ManySideEntity1, ManySideEntity2] 为什么会丢失信息？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-15T12:22:29.970

也许你想设置`org.hibernate.envers.revision_on_collection_change`为`false`？（见[http://docs.jboss.org/hibernate/core/4.1/devguide/en-US/html/ch15.html#d5e3937](http://docs.jboss.org/hibernate/core/4.1/devguide/en-US/html/ch15.html#d5e3937)）

在双向一对多关系中改变关系的一侧是否会改变双方是有争议的，并且取决于用例。在数据库中，没有任何变化，但另一方面，Java 对象发生了变化（集合中有一个新元素）。

# android-ndk - 在 Cygwin 中使用 NDK 的 gdb，我如何中断（闯入）调试对象

> ID：15420208
> 
> 赞同：4
> 
> 时间：2013-03-14T21:06:30.433
> 
> 标签：android-ndk, cygwin

我在 Windows 上使用 NDK，这意味着我必须从 cygwin 中运行 gdb 才能进行本机调试。它有效，但有一件事我无法弄清楚：

一旦附加了调试器并且进程自由运行（例如，我给 gdb “继续”命令并且没有断点），我如何中断被调试进程？我的理解是，对于普通 Linux 环境中的 gdb，您可以使用 Ctrl-c 执行此操作。但是在 Cygwin 环境中，这似乎会杀死（？） gdb 进程。

当然，大多数人可能不会在 Windows 中进行 NDK 调试，但它是受支持的……如果您不能异步中断，调试器几乎无法使用。任何人都可以调试吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T19:06:49.127

MS-Windows 上的 gdb 支持`Ctrl-BREAK`作为替代中断键序列，即使它忽略`Ctrl-c`. 这个技巧对 Android gdb 也不起作用吗？

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-27T21:40:28.687

当 Cygwin 在 windows 上运行 ndk-gdb 时，没有办法中断 gdb 附加到的 Android 进程。Ctrl-C 和 Ctrl-Break 都退出 gdb。

# python - numexpr.evaluate("a+b",out=a)

> ID：15420213
> 
> 赞同：20
> 
> 时间：2013-03-14T21:06:47.433
> 
> 标签：python, numpy, numexpr

在 python numexpr 中将值分配给您正在操作的同一数组以避免创建临时数组是否安全？

从[项目主页](https://github.com/pydata/numexpr)上对内存使用情况的描述来看，它看起来还不错，但如果不深入研究源代码，这几乎不是一个可靠的答案。

我尝试了以下工作正常，但我希望得到更熟悉这个包的人的确认：

```
import numpy as np
import numexpr as ne
a = np.ones(5)
b = a.copy()
ne.evaluate("a+b",out=a)
array([ 2.,  2.,  2.,  2.,  2.]) 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-22T02:52:50.037

它可以工作，因为 numexpr 仍然在内部使用临时数组，尽管块大小为 1024 个元素（如果使用 VML，则为 4096 个）。您可以将这些输入块视为切片，尽管它们在评估期间存储为适当的 C 数据类型以提高速度和内存紧凑性。每一个chunk计算完成后，结果会存入out参数，否则必须分配一个与输入大小相同的数组。

查看numexpr 如何评估矢量化算术的伪代码部分[为什么它有效。](https://code.google.com/p/numexpr/#Why_It_Works)

# python - 当我向 python 服务器发送“无效命令”时，TCL 客户端挂起

> ID：15420218
> 
> 赞同：2
> 
> 时间：2013-03-14T21:07:16.207
> 
> 标签：python, sockets, tcl

我的设置中有一个 python 服务器和一个 TCL 客户端，它们都使用端口 8020 在同一台机器上运行。

我基本上在python服务器中实现了一些功能来执行一些操作。

我正在尝试在 python 服务器中添加一些异常处理，尤其是当 TCL 客户端尝试在 python 中调用一些尚不可用的函数时。python 服务器应该提醒 TCL 客户端该功能尚不可用。

我在下面复制粘贴了我的代码：-

# Python 服务器代码

```
import socket
import sys
import os

DUT_Browser = ""
host = 'localhost'
port = 8020
print 'Current working Directory:',os.getcwd()

def LogError(message):
    try:
        logfile = open("log.txt", "a")
        try:
            logfile.write(message)
        finally:
            logfile.close()
    except IOError:
        pass

def GetParam(sParams, i):
    params = sParams.split(",")
    p = params[i].strip()
    p = p.strip("\"")

    return p

def Login(sParams):
    print "In method Login with parameters:", sParams

    return 0

def ExecuteKeyword(sCommand):
    vals = sCommand.partition("(")
    sKeyword = vals[0].strip()
    sParams = vals[2].strip()
    # Remove the trailing ")" from the parameters string
    sParams = sParams[:-1]
    #print "KEYWORD: ", sKeyword, "PARAMETERS: ", sParams
    func = getattr(sys.modules[__name__],sKeyword)
    failed = 1
    failed=func(sParams)
    if failed:
        return 1
    else:
        return 0

def clientthread(conn):
    while True:
        keyword = conn.recv(1024)
        errorMsg = 'none'
        failed = 1
        try:
           failed=ExecuteKeyword(keyword)
        except (Exception, FindFailed), err:
        #except Exception, err:
            errorMsg=str(err)
            LogError(errorMsg)
        if failed:
            reply = 'FAIL START' + errorMsg + 'FAIL END'
            print 'ERROR MSG:',reply
        else:
            reply = 'PASS: ' + keyword
        if not keyword:
           break
        print 'SERVER REPLY',reply
        conn.sendall(reply)
        print 'SERVER REPLY SENT'
    conn.close()

sdServer = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
print 'TCP (SOCK_STREAM) Socket created'

try:
    sdServer.bind((host, port))
except socket.error , msg:
    print 'Bind failed. Error Code : ' + str(msg[0]) + ' Message ' + msg[1]
    sys.exit()

print 'Socket bind to port:',port,'on host:',host,'is complete'

#Start listening on socket
sdServer.listen(10)
print 'Socket now listening for 10 connections'
while 1:
    #wait to accept a connection - blocking call
    conn, addr = sdServer.accept()
    print 'Connected with ' + addr[0] + ':' + str(addr[1])
    #try:
    clientthread(conn)
    #except socket.error , err:
    #    print str(err)

sdServer.close() 
```

# TCL客户端代码

```
set port 8020
set host localhost
set ntoIP "http://10.218.164.58/"
set sdClient [socket $host $port]
fconfigure $sdClient -buffering line
set ntoGuiCmd start
while {$ntoGuiCmd != "end"} {
    puts "Enter some command for $sdClient"
    set ntoGuiCmd [gets stdin]
    puts $sdClient $ntoGuiCmd
    if {[eof $sdClient]} {close $sdClient}
    gets $sdClient serverMessage
    puts "From Server : $serverMessage"
} 
```

当我从客户端输入以下命令时，它会传递并按预期运行，并打印来自服务器的消息。

```
Login("10.218.164.58",admin,admin,\"FALSE\") 
```

但是，当我使用以下尚未实现的命令时，客户端只是挂起并且不打印来自服务器的异常，表明它尚未实现。

```
Logout("10.218.164.58") 
```

我什至尝试使用wireshark并注意到服务器确实发送了消息，而且TCL客户端似乎也发送了一个ACK作为响应。所以不太确定为什么“gets”应该挂起。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T21:42:49.240

我不太确定出了什么问题，但我怀疑问题出在 Tcl 代码中。可能存在许多问题（是否有换行符被传回？）但关键是代码实际上并不是特别惯用的。这是一个更惯用的版本：

```
set port 8020
set host localhost
set sdClient [socket $host $port]
fconfigure $sdClient -buffering line
while true {
    puts "Enter some command for $sdClient"
    gets stdin ntoGuiCmd
    if {[eof stdin] || $ntoGuiCmd eq "end"} {
        break
    }
    if {[catch {puts $sdClient $ntoGuiCmd}]} {
        break
    }
    ### Replacement discussed below starts here
    gets $sdClient serverMessage
    if {[eof $sdClient]} {
        break
    }
    puts "From Server: $serverMessage"
    # If multiline messages are possible, extra work is required here!
    ### Replacement ends here
}
close $sdClient 
```

如果您有多行响应，则需要更加小心。最好的方法是读取它们，直到您知道您已经到达响应的末尾（例如，因为服务器告诉您字节数或行数），但这并不总是可能的。如果您***假设***响应始终适合单个数据包，则可以使用它来读取可用的行（它通过在有未读字节时以非阻塞模式从套接字读取来工作）：

```
fconfigure $sdClient -blocking 0
while {[gets $sdClient serverMessage] >= 0} {
    puts "From Server: $serverMessage"
}
fconfigure $sdClient -blocking 1
if {[eof $sdClient]} {
    break
} 
```

如果响应足够大（取决于操作系统缓冲区等），那么它不会被写入一个数据包。那时您确实*需要*在消息传递协议中明确标记响应结束的位置。（在相反的方向上也是如此，除了大请求会导致问题。）

* * *

如果这都是我自己的代码，我会很想做一个完全异步的非阻塞客户端：

```
proc transfer {from to} {
    if {[gets $from line] >= 0} {
        puts $to $line
    } elseif {[eof $from]} {
        exit
    }
}

set sock [socket "localhost" 8020]
fconfigure stdin -blocking 0
fconfigure $sock -blocking 0
fileevent stdin readable [list transfer stdin $sock]
fileevent $sock readable [list transfer $sock stdout]
vwait forever 
```

然而，这是一种*非常*不同的客户端风格（并且不容易包装到前端 API 中）。

# sql - MDX 查询如何获取参数以按事实表日期时间属性进行过滤

> ID：15420220
> 
> 赞同：1
> 
> 时间：2013-03-14T21:07:18.037
> 
> 标签：sql, ssas, mdx, cube, sql-server-data-tools

我们有一个具有日期时间字段 [Log Entry].[Time Entry] 的事实表。

我们想根据日期范围过滤以下查询： [日志条目].[时间条目] 在两个提供的日期之间（2 个参数：即 startdate 和 enddate）

```
SELECT 
  NON EMPTY { [Measures].[Average Total Time] } ON COLUMNS, 
  NON EMPTY { ([User Property].[UserProperty].[Id].ALLMEMBERS * [Log Entry].[Time Entry].[Logged On].ALLMEMBERS ) } 
DIMENSION PROPERTIES MEMBER_CAPTION, MEMBER_UNIQUE_NAME ON ROWS 
FROM [MyCube] 
```

我希望避免创建时间表/维度并能够将这些日期（通过参数传入）与 [日志条目].[时间条目] 进行比较。

SQL 的概念介于（somedate 介于 date1 和 date2 之间）。

我们应该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T09:09:16.517

您应该使用范围表达式。请看这里：http: [//msdn.microsoft.com/en-us/library/ms146001%28v=sql.105%29.aspx](http://msdn.microsoft.com/en-us/library/ms146001%28v=sql.105%29.aspx)

您的 WHERE 子句应如下所示：

```
 WHERE (
    [Time].[Month Name].&[August 2009]
    :
    [Time].[Month Name].&[June 2012]
    ) 
```

**更新** 要在其中过滤轴，您应该使用 EXISTS 子句：

```
 * {EXISTS
   (
      {[Log Entry].[Time Entry].[Logged On].ALLMEMBERS}
    ,
    {[Log Entry].[Time Entry].&[20120101]:[Log Entry].[Time Entry].&[20130101]}
    ) 
```

# javascript - HTML Javascript中的动态输入表到动态标签表

> ID：15420221
> 
> 赞同：0
> 
> 时间：2013-03-14T21:07:20.330
> 
> 标签：javascript, html, dynamic, rows

我正在尝试制作我之前在我的程序中使用过的这个函数，但是我需要它来显示数据的标签或文本，而不是让输入字段显示数据，以便我可以将其复制并粘贴到 Excel 中。

这是方法：

```
 cnt=0;
function addRowReporte(tableID,nroColumna) {
    var table = document.getElementById(tableID);
    var rowCount = table.rows.length;
    var row = table.insertRow(rowCount);

    for(c=0;c<nroColumna;c++){

        var cell = row.insertCell(c);
        var element = document.createElement("input");
        element.type = "text";

        element.name = ct+"0"+c;
        element.size = "16";
        element.id = ct+"0"+c;

        cell.appendChild(element);
    }
    cnt++;
} 
```

我尝试更改`createElement("input")`to 标签，但没有用

稍后使用以下方法调用该字段的文本或“值”：

```
document.getElementById(id).value = rs.Fields(colu).Value; 
```

一如既往，非常感谢任何帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T21:17:09.973

您可以使用文本节点将文本直接插入表格单元格，就像这样......

```
cnt=0;
function addRowReporte(tableID,nroColumna) {
    var table = document.getElementById(tableID);
    var rowCount = table.rows.length;
    var row = table.insertRow(rowCount);

    for(c=0;c<nroColumna;c++){
        var cell = row.insertCell(c);
        var element = document.createTextNode("text goes here");

        cell.appendChild(element);
    }
    cnt++;
} 
```

# nsis - 我怎样才能让这个功能在 NSIS 中真正起作用？

> ID：15420224
> 
> 赞同：0
> 
> 时间：2013-03-14T21:07:24.213
> 
> 标签：nsis

我正在尝试找出我的 NSIS 安装程序中所有的代码片段。片段如下：

```
nsExec::ExecToStack 'Dism.exe /Online /Enable-Feature /FeatureName:NetFx3'
Pop $0

${If} $0 != 0
   Pop $0
   Push ".NET 3.5 failed to install: $\n$0"
   Call DetailPrintTS
   StrCpy $Errors "$Errors Errors From .NET 3.5 install:$\n$0$\n$\n"
${EndIf} 
```

所以我想把这个因素考虑到：

```
Function LoggedExec
   Pop $0
   Pop $1

   nsExec::ExecToStack $0
   Pop $0

   ${If} $0 != 0
      Pop $0
      Push "$1 failed to install: $\n$0"
      Call DetailPrintTS
      StrCpy $Errors "$Errors Errors From $1 install:$\n$0$\n$\n"
   ${EndIf}
FunctionEnd 
```

然后按如下方式调用它：

```
Push 'Dism.exe /Online /Enable-Feature /FeatureName:NetFx3'
Push '.NET 3.5'
Call LoggedExec 
```

请注意，DetailPrintTS 是我制作的另一个函数，它在 DetailPrint 中包含时间戳：

```
Function DetailPrintTS
   Pop $7

   ${GetTime} "" "L" $0 $1 $2 $3 $4 $5 $6

   DetailPrint "$4:$5:$6 -- $7$\n"
FunctionEnd 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T13:20:46.660

请记住`Push`/`Pop`正在作用于堆栈（换句话说，一个 lifo：后进先出）。

从您的片段中，您似乎以与它们被编辑的顺序相同的顺序排列`Pop`参数。相反，如果您在命令和日志文本之后，则需要以相反的顺序：`LoggedExec``Push``Push``Pop`

```
Push 'Dism.exe /Online /Enable-Feature /FeatureName:NetFx3'
Push '.NET 3.5'
Call LoggedExec

;in LoggedExec
pop $1
pop $0 
```

# django - 如何让 Django Admin 显示与外键连接的字段？

> ID：15420226
> 
> 赞同：0
> 
> 时间：2013-03-14T21:07:27.130
> 
> 标签：django

如何让 Django 在后端将 AnotherAim.aimid.code 的外键显示到 AnotherAimAdmin 的一个表中？

这是一个经典的管理“视图”，在后端由两个不同的表格分隔：

```
class AimAdmin(admin.ModelAdmin):
    list_display = ('code')

# AnotherAim and AIM are connected via a foreight key

class AnotherAimAdmin(admin.ModelAdmin):
    list_display = ('name','sur_name', 'email')
    search_fields = ['name','sur_name']

admin.site.register(Aim,AimAdmin)
admin.site.register(AnotherAim, AnotherAimAdmin) 
```

我的模型如下所示：

```
class AnotherAim(models.Model):

    email=models.EmailField(null=True)
    name= models.CharField(max_length=100)
    sur_name= models.CharField(max_length=100)
    code = models.OneToOneField(Aim,null=True)

class Aim(models.Model):

     code = models.CharField(max_length=5, null=False)
     ....
     .... 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T21:38:18.707

我会这样构建我的模型：

```
class Aim(models.Model):
     code = models.CharField(max_length=5)

     def __unicode__(self):
         return self.code

class AnotherAim(models.Model):
    email = models.EmailField(blank=True)
    name = models.CharField(max_length=100)
    sur_name = models.CharField(max_length=100)
    aim = models.OneToOneField(Aim, null=True)

    def __unicode__(self):
        return self.name  # or another field 
```

# asp.net - 对列名使用 C# SQL 参数化

> ID：15420228
> 
> 赞同：1
> 
> 时间：2013-03-14T21:07:32.067
> 
> 标签：asp.net, sql, sqldatasource

我有问题。我希望这个工作，但它没有：

```
SqlDataSource.SelectCommand = "SELECT blah1, blah2 FROM myTable WHERE @ColumnName = @Value";

SqlDataSource.SelectParameters.Add("ColumnName", System.Data.DbType.String, "one");
SqlDataSource.SelectParameters.Add("Value", System.Data.DbType.String, "two"); 
```

它不会替换第一个参数“ColumnName”。如果我删除该参数并像这样将列名放入其中，它将起作用：

```
SqlDataSource.SelectCommand = "SELECT blah1, blah2 FROM myTable WHERE one = @Value";

SqlDataSource.SelectParameters.Add("Value", System.Data.DbType.String, "two"); 
```

我有一个用户界面，用户可以在其中选择要搜索的数据库列名。我想保护自己免受任何形式的注射攻击。有什么想法可以让我完成这项工作吗？

我读到的一个想法是使用查找表从索引中获取索引`DropDownList`并以这种方式提取列名。我可以完成这项工作，但如果可能的话，我宁愿让参数化工作，因为这对我来说似乎更自然。

提前感谢您提供的任何帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-14T21:25:08.043

由于查询参数是在解析完 SQL 并生成执行计划*后才*解析的，因此实际上无法动态构建带参数的 SQL。当然，我建议以安全的方式构建 SQL 字符串本身。也许首先创建一个`enum`有效的列名：

```
enum DbColumns { One, Two, Three }; 
```

然后像这样构建 SQL 字符串：

```
DbColumns colName = (DbColumns)Enum.Parse(typeof(DbColumns), "One");
SqlDataSource.SelectCommand = String.Format("SELECT blah1, blah1 FROM myTable WHERE {0} = @Value", colName); 
```

另一个想法是使用正则表达式验证列名，可能只允许`[a-z]`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-14T21:11:10.653

恐怕你不能这样做，你可以做的是一个小技巧：

```
SELECT blah1, blah1 FROM myTable 
WHERE (@blah1 is null or blah1 = @blah1)
   or (@blah2 is null or blah2 = @blah2) 
```

并提供所有参数@blah1、@blah2，但只分配您需要的参数。

Mike Christensen 为您提供的 NB 解决方案基本上是在正确的条件下构建字符串，在最简单的情况下是

```
public bool BuildQueryWithCondition(string fieldName, string fieldValue) {
   var queryTemplate = "SELECT blah1, blah1 FROM myTable WHERE {0} = @Value"
     , query = string.Format(queryTemplate, fieldName)
   SqlDataSource.SelectCommand = query;
   SqlDataSource.SelectParameters.Add("Value", System.Data.DbType.String, fieldValue);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-25T15:14:27.763

I have figured out a way to include a work around for parametrized column names. I had the same problem but came up with a different way and since I would be the only one using the column names then I believe this is still a safe bet.

```
 String sqlcomm = "SELECT * FROM Asset WHERE " + assetColName + " = ";
            command.CommandText = sqlcomm + "$assetColValue";

            //command.CommandText = @"SELECT * FROM Asset WHERE $assetColName = '$assetColValue'";
            //command.Parameters.AddWithValue("$assetColName", assetColName);

            command.Parameters.AddWithValue("$assetColValue", assetColValue); 
```

As you can see from the code above. I tried almost what you did which I then had to comment out. I then concatenated strings together and was able to use my paramterized column name and value which then the value is securely added. The column name however is not secured but this is a method that only I will be using so its still somewhat safe. You can add regular expressions if you want to be more secure but you get the idea of the fix.

# php - 使用链接 php 回显行

> ID：15420230
> 
> 赞同：0
> 
> 时间：2013-03-14T21:07:42.210
> 
> 标签：php, mysql, post

我试图从我的数据库中呼出一行。

代码如下所示：

```
echo '<a href="#">" . $row["contact"] . "</a><br />'; 
```

所以，我想要的是，当该行出现在屏幕上时，联系线路（邮件地址）应该是与填写的联系线路的链接线路。我的代码不起作用。屏幕只是白色的。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T21:10:17.033

你的报价混淆了：

```
echo '<a href="#">" . $row["contact"] . "</a><br />';
     ^            ^                     ^          ^ 
```

应该：

```
echo "<a href=\"#\">" . $row["contact"] . "</a><br />"; 
```

或者：

```
echo '<a href="#">' . $row["contact"] . '</a><br />'; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-14T21:09:04.330

尝试这个...

```
 echo '<a href="#">' . $row["contact"] . '</a><br />' ; 
```

# c# - 在客户端和服务器同步场景中实现 SqliteClientSyncProvider？

> ID：15420231
> 
> 赞同：2
> 
> 时间：2013-03-14T21:07:42.723
> 
> 标签：c#, sql-server, sqlite, synchronization

我想使用 MS Sync Framework 和 SqliteClientSyncProvider ( [http://sourceforge.net/projects/sqliteclientsyn/](http://sourceforge.net/projects/sqliteclientsyn/) )实现客户端（SQLite）和服务器（SQL Server）同步应用程序

```
syncOrchestrator = new SyncOrchestrator();
syncOrchestrator.LocalProvider = new SqliteClientSyncProvider(clientSqlConn);
syncOrchestrator.RemoteProvider = new SqlSyncProvider("filtered_customer", serverConn, null, "Sync");
syncOrchestrator.Direction = SyncDirectionOrder.UploadAndDownload;

syncStats = syncOrchestrator.Synchronize(); 
```

在 Synchronize() 执行后得到一个 InvalidCastExcpetion ：

```
InvalidCastExcpetion : Microsoft.Synchronisation.KnowledgeSyncProvider 
```

有什么建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T23:48:51.513

您必须使用 SyncAgent 而不是 SyncOrchestrator。SqlLiteClientSyncProvider 是一个较旧的基于锚的离线提供程序，它不使用更新的基于知识的对等类型的同步提供程序。

在上面的示例中，您也不能混合和匹配提供者。因此，如果您将 SQL Server 用于远程提供程序部分，则还必须使用较旧的 DBServerSyncProvider。

# sql-server - 数据库中所有用户定义函数的 SQL 列表

> ID：15420235
> 
> 赞同：50
> 
> 时间：2013-03-14T21:08:06.807
> 
> 标签：sql-server, sql-server-2008-r2

我正在寻找一个 SQL 查询，它输出数据库目录中所有用户定义函数的函数定义。

我发现

```
SELECT OBJECT_DEFINITION (OBJECT_ID(N'dbo.UserFunctionName')) AS [Object Definition] 
```

和

```
SELECT ROUTINE_NAME FROM information_schema.routines WHERE routine_type = 'function' 
```

但我想不出或找不到将 ROUTINE_NAME 列表提供给 OBJECT_ID 的方法。

这里的目的是用于数据库更改分析的数据库中用户定义的函数定义的可搜索文本，如果像完整的 SQL 过程或有目的的帮助程序这样的东西更容易，我会这样做并发布它。

* * *

## 回答 #1

> 赞同：81
> 
> 时间：2013-03-14T21:26:47.073

```
SELECT name, definition, type_desc 
  FROM sys.sql_modules m 
INNER JOIN sys.objects o 
        ON m.object_id=o.object_id
WHERE type_desc like '%function%' 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-03-14T21:16:35.453

您可以使用 CTE：

```
with functions(routine_name) as 
  (SELECT ROUTINE_NAME FROM information_schema.routines WHERE routine_type = 'function')
select 
  OBJECT_DEFINITION(OBJECT_ID(routine_name)) AS [Object Definition] 
from 
  functions 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2017-06-06T15:12:27.407

```
SELECT O.name, M.definition, O.type_desc, O.type
FROM sys.sql_modules M
INNER JOIN sys.objects O ON M.object_id=O.object_id
WHERE O.type IN ('IF','TF','FN') 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2020-02-25T15:45:55.487

与此解决方案类似： [查询以列出所有存储过程](https://stackoverflow.com/questions/219434/query-to-list-all-stored-procedures)

```
SELECT * 
  FROM DIDS0100.INFORMATION_SCHEMA.ROUTINES
 WHERE ROUTINE_TYPE = 'FUNCTION' 
    AND LEFT(ROUTINE_NAME, 3) NOT IN ('fn_') 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-06-14T13:36:41.160

这是一个包含模式的版本，其格式允许大量删除不需要的标量值函数：

```
SELECT ('DROP FUNCTION [' + SCHEMA_NAME(o.schema_id) + '].[' + o.name + ']') AS ObjectName 
FROM sys.sql_modules m INNER JOIN sys.objects o ON m.object_id = o.object_id 
WHERE o.type_desc = 'SQL_SCALAR_FUNCTION' 
ORDER BY ObjectName 
```

# java - 如何在 Spring 应用程序中检索 InMemoryUserDetailsManager 实例？

> ID：15420243
> 
> 赞同：1
> 
> 时间：2013-03-14T21:08:34.673
> 
> 标签：java, spring-security

假设在应用程序中使用 Spring 的默认内存安全性，如何`InMemoryUserDetailsManager`在代码中检索实例？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-14T21:18:49.300

你可以简单地注入它`@Autowire`：

```
@Autowired
private InMemoryUserDetailsManager userDetailsManager; 
```

# jquery - 如何将类添加到最后两个 TR 并将样式应用于这些 TR 内的 TD

> ID：15420244
> 
> 赞同：0
> 
> 时间：2013-03-14T21:08:34.753
> 
> 标签：jquery

我正在尝试 1) 在第 2 页上的每个表格的最后两个 TRs 中添加一个类，并且还设置这两个 TRs 的第一个、第二个、第五个和第八个 TD 的样式。

下面的一段代码似乎不起作用。

```
 var rowCount = $('table tr').length;
$('table tr').eq(rowCount - 1).addClass('myClass');
$('table tr').eq(rowCount - 2).addClass('myClass'); 
```

谢谢

BB

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-14T21:16:32.867

要将类添加到每个表的最后两行，您可以使用：

```
$('table').each(function () {
    $(this).find('tr').last().addClass('red').prev().addClass('red');
}); 
```

并将一个类添加到每个表的最后两行以及您将使用的每一行的特定列：

```
$('table').each(function () {
    $(this).find('tr').last().addClass('myClass')
    .find(':nth-child(1)').addClass('myClass').parent()
    .find(':nth-child(2)').addClass('myClass').parent()
    .find(':nth-child(5)').addClass('myClass').parent()
    .find(':nth-child(8)').addClass('myClass').parent()
    .prev().addClass('myClass')
    .find(':nth-child(1)').addClass('myClass').parent()
    .find(':nth-child(2)').addClass('myClass').parent()
    .find(':nth-child(5)').addClass('myClass').parent()
    .find(':nth-child(8)').addClass('myClass').parent();
}); 
```

最后一点似乎有点乱。我认为有更好的方法可以做到这一点，但这有效。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-14T21:10:52.100

试试切片？

```
$(function() {
    $('table tr').slice(-2).addClass('last_two');

    $('table tr').eq(0).addClass('first')
           .end().eq(1).addClass('second')
           .end().eq(4).addClass('fifth')
           .end().eq(7).addClass('eight');
}); 
```

# ios5 - UIButton 需要 2 秒来识别触摸

> ID：15420247
> 
> 赞同：0
> 
> 时间：2013-03-14T21:08:52.283
> 
> 标签：ios5, uibutton

非常好奇——XIB 中的标准圆角录制 UIButton。已将 touchUpInside 链接到视图控制器中的方法。在模拟器上，它按预期工作，但在 iOS 5 iPad 上，必须按住按钮 2 秒钟，然后才能调用链接方法 (cancelButtonPressed:)。

提取并记录按钮的目标操作表明它确实在寻找正确的目标对象和方法的 touchUpInside 事件。

为新目标方法添加的（在 viewDidAppear 中）操作会产生相同的行为 - 仅当按下按钮 2 秒（然后释放）时才会调用新方法。它在原始方法之后立即被调用。

警告：当然，这个设置很麻烦。这是浮动在主屏幕上的模态视图。为了到达这里，在加载 VC 的视图之后，在 VC 和它的原始视图之间插入了一个视图。

但当然它在模拟器上效果很好。（也可能在 iOS6 硬件上，虽然我没有尝试过。）

那么知道什么会导致需要按住按钮 2 秒钟吗？按钮在被触摸时立即“动画”（变成颜色），因此它不仅仅是花费很长时间来传播触摸。

**更多信息：**操作顺序

*   创建一个比较正常的视图控制器
*   创建一个新的 UIView，使视图控制器的视图成为这个新视图，将 VC 的原始视图作为子视图添加到这个新视图中
*   在两个视图中添加触摸手势识别器，这样就可以识别VC原始视图之外的触摸。（一个被添加到 VC 的原始视图中，以便可以忽略那里的触摸。）
*   创建一个UIWindow，设置为“普通窗口”
*   将新窗口的根视图控制器设置为上述视图控制器
*   `makeKeyAndVisible`在新窗口上。

（这（几乎）成功地使用选定的 VC 创建了一个“弹出窗口”。）

**观察：**

*   按钮立即响应触摸（通过更改颜色），因此触摸信息过滤到视图中没有延迟。
*   但是，按钮触摸仅在按住按钮约 2 秒后才有效，因此不仅仅是触摸事件被延迟传递。
*   因此，一定有什么东西影响了决定是否发生触摸的特定于按钮的逻辑。

**啊哈！**

在写这篇文章时，我突然想到手势识别器可能会以某种方式参与其中。禁用它们，不再有问题。这些是 UITapGestureRecognizers，并且不应该（人们会认为）影响按钮响应（因为在其他地方提倡使用相同的方案来检测框“外部”的触摸）。（立即调用手势识别器处理程序。）

（并不是说这些知识对我有多大好处，除了我可以通过禁用 iOS 5 上的“开箱即用”功能而侥幸逃脱。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-15T08:28:41.560

这样做可以在 iOS5 中避免它：

```
- (void)tappedAction:(UIGestureRecognizer *)sender  {
    float version = [[[UIDevice currentDevice] systemVersion] floatValue];
    if (version < 6.0) {
        CGPoint pt = [sender locationInView:_button];
        NSLog(@"%@", NSStringFromCGPoint(pt));
        if (CGRectContainsPoint( _button.bounds, pt)) {
            [self buttonAction:_button];
            return;
        }
    }          
    // do some Tapped Action
    NSLog(@"tappedAction:");
} 
```

# javascript - nodejs XML <-> JSON 的多种内容类型支持

> ID：15420250
> 
> 赞同：0
> 
> 时间：2013-03-14T21:08:56.630
> 
> 标签：javascript, xml, json, node.js, content-type

对于对我的服务器的所有 Rest API 请求，我想同时支持 XML 和 JSON Content-Type。有什么想法吗？

我正在考虑添加中间件来检查请求的`Content-Type`/`Accept`以及它的 XML 是否将其转换为 JSON 并将其传递给路由，并确保在发送之前将这些响应转换回 XML。

所以我的问题是：

*   最好的方法是什么？
*   是否有任何现有的库可以做到这一点？

我不想在每个端点中添加额外的逻辑，也不想为它创建新的端点。必须有更好的方法来做到这一点。

PS：我用的是快递。

编辑：要求改变了，我不只使用一种方式翻译（json到xm）：[this]（[http://goessner.net/download/prj/jsonxml/](http://goessner.net/download/prj/jsonxml/)）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T21:28:42.210

使用[Accept 标头来](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html)确定客户端是否更喜欢 JSON 或 XML 而不是查询参数。语义是`Accept`标头的意思是“我希望接收以下 MIME 类型”并且仅用于请求。标`Content-Type`头表示“此消息正文采用此 MIME 类型格式化”，可用于响应和请求（当它们是消息正文时）。我会使用这种模式：

*   在您的大多数路由处理程序中，将规范响应数据表示组装为`res.body`. 这应该只是普通的 javascript 对象数据。完成后打电话`next()`。
*   在路由器之后添加一个中间件，该中间件使用 set 查找未发送的响应`res.body`，然后基于`Accept`标头，格式化`res.body`为 XML，或者`res.send(res.body)`如果客户端需要 JSON，则仅执行此操作。您可以使用`res.headerSent`布尔值来测试是否发送了响应，或者只是确保`res.body`在发送时未设置。

# ruby - Paypal Adaptive Payments 移动应用程序在完成或取消时挂起

> ID：15420254
> 
> 赞同：0
> 
> 时间：2013-03-14T21:09:07.440
> 
> 标签：ruby, mobile, paypal, payment

我有一个 Ruby On Rails 移动应用程序，它使用带有迷你浏览器的 PayPal Adaptive Payments。该应用程序在 iPhone 上的 Safari 中运行时运行良好：完成支付（或取消支付）后，将执行*returnFromPaypal*回调函数并将用户重定向到预订页面。

但是，当我以全屏模式运行应用程序时（从保存到主屏幕的图标，这是预期的操作模式），当我取消付款或完成付款时，应用程序会挂在 PayPal 页面上，并且消息“请稍等 - 此窗口将自动关闭”和“返回”分别。

下面是我的付款页面的 .haml 视图（抱歉，我没有 HTML 版本）。

有人知道发生了什么吗？谢谢！

```
= javascript_include_tag  src="https://www.paypalobjects.com/js/external/apdg.js"
#edit_payment.current
  .scroll
    %ul
      %li
        = form_tag "https://www.sandbox.paypal.com/webapps/adaptivepayment/flow/pay", :method=>'get', :target=>"PPDGFrame", :class=>"standard" do
          = hidden_field_tag :type, "mini", :name=>"expType"
          = hidden_field_tag :paykey, @pay_key, :name=>"paykey"
          = image_submit_tag "paypal_button.jpg", :id=>"submitBtn", :class=>"submit"
    :javascript
      var returnFromPayPal = function(){
          window.location.href = get_full_url("#{room_reservation_path(@room,@reservation)}");
      };                                                                                                                                  
      var dgFlowMini = new PAYPAL.apps.DGFlowMini({trigger: 'submitBtn',expType: 'mini', callbackFunction: 'returnFromPayPal'}); 
```

[截图完成 http://ec2-23-21-163-203.compute-1.amazonaws.com/images/scrn_complete.png](http://ec2-23-21-163-203.compute-1.amazonaws.com/images/scrn_complete.png) [截图取消 http://ec2-23-21-163-203.compute-1.amazonaws .com/images/scrn_canceled.png](http://ec2-23-21-163-203.compute-1.amazonaws.com/images/scrn_canceled.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-06-03T18:53:06.723

据我了解，这是“按设计工作”。只需在您的 WebView 中捕获[https://www.sandbox.paypal.com/webapps/adaptivepayment/flow/closewindow?execution=e7s1](https://www.sandbox.paypal.com/webapps/adaptivepayment/flow/closewindow?execution=e7s1)之类的重定向，然后在您的服务器上调用付款检查方法。

在***apdg.js***你可以找到检查：

```
if (ua.match(/iPhone|iPod|Android|Blackberry.*WebKit/i)) {
    win = window.open('', this.name);
    winOpened = true;
} 
```

所以你当前的窗口被完全替换了。没有回调的机会。

或者您可以在 WebView 本身中支持**多个窗口。**例如安卓：

```
mWebView.getSettings().setSupportMultipleWindows(true);
mWebView.getSettings().setUserAgentString("web browser"); 
```

和@Override

```
public boolean onCreateWindow(WebView view, boolean dialog, boolean userGesture, Message resultMsg) { 
```

不确定 iOS WebView 中的多个窗口。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-18T16:44:06.983

I was experiencing this same issue until I changed my code to redirect to PayPal in a new window. Then when the user completes the payment or cancels, the page doesn't hang, it automatically closes.

More information regarding the mini browser experience (expType=mini) can be found here:

[Adaptive Payments without modal box or popups?](https://stackoverflow.com/questions/17283272/adaptive-payments-without-modal-box-or-popups/17729106)

# objective-c - 在Objective-c中从模数和指数以字节为单位生成RSA公钥

> ID：15420259
> 
> 赞同：3
> 
> 时间：2013-03-14T21:09:14.720
> 
> 标签：objective-c, openssl, rsa, modulus, exponent

我搜索了许多网站，试图了解 RSA 是如何工作的。

I have a modulus "A89F25A56FA6DA258C8CA8B40427D927B4A1EB4D7EA326BBB12F97DED70AE5E4480FC9C5E8A972177110A1CC318D06D2F8F5C4844AC5FA79A4DC470BB11ED635699C17081B90F1B984F12E92C1C529276D8AF8EC7F28492097D8CD5BECEA16FE4088F6CFAB4A1B42328A1B996F9278B0B7E3311CA5EF856C2F888474B83612A82E4E00D0CD4069A6783140433D50725F" and exponent "03" and i have to decrypt information formated in hex bytes. 我的问题是：

如何创建公钥？一旦我有了公钥，我是否必须在 base64 中编码或公钥准备好解密？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-23T23:19:19.627

经过几天的研究，我终于用 OpenSSL 做到了。我不是 C++ 专家，所以我不确定是否正确声明了所有字符、常量字符和无符号字符，所以如果有人有更好的主意，请编辑它 =)。你必须有 lybcrypto.a 和 libssl.a（在这里你可以找到它们[https://github.com/x2on/OpenSSL-for-iPhone](https://github.com/x2on/OpenSSL-for-iPhone)）。我用 EMV VISA 密钥测试了几次，它工作正常。

```
#include <openssl/opensslv.h>
#include <openssl/rsa.h>
#include <openssl/evp.h>
#include <openssl/bn.h>

@implementation ViewController

-(NSData*) decryptIPKC:(NSString*)ipkc modulus:(NSString*)mod exponent:(NSString*)exp{

NSString * hexString = ipkc;
int hexStringLength= [hexString length] / 2;

//unsigned char enc_bin[144];
unsigned char dec_bin[hexStringLength];
//int enc_len;
int dec_len;
RSA * rsa_pub = RSA_new();

const char *N=[mod UTF8String] ;
const char *E=[exp UTF8String];

char * myBuffer = (char *)malloc((int)[hexString length] / 2 + 1);
bzero(myBuffer, [hexString length] / 2 + 1);
for (int i = 0; i < [hexString length] - 1; i += 2) {
unsigned int anInt;
NSString * hexCharStr = [hexString substringWithRange:NSMakeRange(i, 2)];
NSScanner * scanner = [[NSScanner alloc] initWithString:hexCharStr];
[scanner scanHexInt:&anInt];
myBuffer[i / 2] = (char)anInt;
}

printf("Mybuffer: %s",myBuffer);

if (!BN_hex2bn(&rsa_pub->n, N)) {
printf("NO CARGO EL MODULO");
}
printf(" N: %s\n", N);
printf(" n: %s\n", BN_bn2hex(rsa_pub->n));

if (!BN_hex2bn(&rsa_pub->e, E)) {
printf("NO  CARGO EL EXPONENTE");
}
printf(" E: %s\n", E);
printf(" e: %s\n", BN_bn2hex(rsa_pub->e));

printf("public key size : %d bits\n", RSA_size(rsa_pub));    

/* decrypt */
if ((dec_len = RSA_public_decrypt(hexStringLength, (unsigned char*)myBuffer, dec_bin, rsa_pub,RSA_NO_PADDING))<0) {
printf("NO\n ");
}
printf("decrypted data:\n %s", dec_bin);
print_hex(dec_bin, dec_len);

NSData* data = [NSData dataWithBytes:dec_bin length:sizeof(dec_bin)];

free(myBuffer);

return data;
}
- (void)viewDidLoad {
[super viewDidLoad];
NSString *m= @"Your HEX modulus here";
NSString *e=@"Your HEX exponent";
NSString * hexString= @"Your HEX message here";

NSData *decryptedIPKC= [self decryptIPKC:hexString modulus:m exponent:e];
NSLog(@"ESTE ES EL NSDATA %@", decryptedIPKC.description);
}

@end 
```

# ruby-on-rails - 将 ruby 对象嵌入到咖啡脚本中

> ID：15420263
> 
> 赞同：0
> 
> 时间：2013-03-14T21:09:22.970
> 
> 标签：ruby-on-rails, ruby, html, coffeescript

我将尝试简化上一个问题：我在[http://pants.telegraphbranding.com/t/women/long-sleeve](http://pants.telegraphbranding.com/t/women/long-sleeve)有一个产品页面。当您将鼠标悬停在产品的缩略图列表上时，该产品的主图像应该会发生变化。但是现在，页面上的每个产品都在尝试改变。要获得我正在使用的产品的唯一 ID：

```
<div id="main-image" data-productid="<%= product.id %>">
  <%= link_to large_image(product, :itemprop => "image", :class => "product-image"), product, :itemprop => 'url' %>
</div><!-- main-image--> 
```

如何将 data-productid="<%= product.id %> 合并到我的咖啡脚本文件中？

```
add_image_handlers = ->

thumbnails = ($ '#product-images ul.thumbnails')
($ '#main-image').data 'selectedThumb', ($ '#main-image img').attr('src')
thumbnails.find('li').eq(0).addClass 'selected'
thumbnails.find('a').on 'click', (event) ->
  ($ '#main-image').data 'selectedThumb', ($ event.currentTarget).attr('href')
  ($ '#main-image').data 'selectedThumbId', ($ event.currentTarget).parent().attr('id')
  ($ this).mouseout ->
    thumbnails.find('li').removeClass 'selected'
    ($ event.currentTarget).parent('li').addClass 'selected'
false

thumbnails.find('li').on 'mouseenter', (event) ->
  ($ '#main-image img').attr 'src', ($ event.currentTarget).find('a').attr('href')

thumbnails.find('li').on 'mouseleave', (event) ->
  ($ '#main-image img').attr 'src', ($ '#main-image').data('selectedThumb')

show_variant_images = (variant_id) ->
  ($ 'li.vtmb').hide()
  ($ 'li.vtmb-' + variant_id).show()
  currentThumb = ($ '#' + ($ '#main-image').data('selectedThumbId'))
  if not currentThumb.hasClass('vtmb-' + variant_id)
    thumb = ($ ($ 'ul.thumbnails li:visible.vtmb').eq(0))
    thumb = ($ ($ 'ul.thumbnails li:visible').eq(0)) unless thumb.length > 0
    newImg = thumb.find('a').attr('href')
    ($ 'ul.thumbnails li').removeClass 'selected'
    thumb.addClass 'selected'
    ($ '#main-image img').attr 'src', newImg
    ($ '#main-image').data 'selectedThumb', newImg
    ($ '#main-image').data 'selectedThumbId', thumb.attr('id')

update_variant_price = (variant) ->
  variant_price = variant.data('price')
  ($ '.price.selling').text(variant_price) if variant_price

$ ->
 add_image_handlers()
 show_variant_images ($ '#product-variants input[type="radio"]').eq(0).attr('value') if 
($ '#product-variants input[type="radio"]').length > 0
($ '#product-variants input[type="radio"]').click (event) ->
show_variant_images @value
update_variant_price ($ this) 
```

显然，我希望咖啡脚本提取每个主图像的唯一 ID，以便仅针对该特定图像发生图像更改。

我很感激。对不起，长度。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T21:49:44.427

首先，应该枚举所有具有`data-productid`属性的元素。

对于这个页面`var elements = $(".main-image")`应该足够了。*（请记住这里的类选择器。原始页面包含 id 选择器，并造成卢布和破坏。现在修复。）*

然后应该迭代实现的值：`$.each(elements, function(index, element){...})`应该做的伎俩。

最后可以`data-productid`从元素中检索值（`$.each`我的意思是在循环中）：`$(element).data("productid")`将返回所需的值。*（请注意`$(element)`这里的部分。`element.data(...)`因为我们枚举了 jQuery 访问器，而不是实际的元素，所以它不起作用——并且它们需要在使用前被取消引用。）*

将其组合成类似的东西`$.each($(".main-image"), function(index,elem){console.log($(elem).data("productid"))})` *（在 Chrome DevTools 中针对实际页面进行测试，似乎有效）* ——瞧，问题解决了！

# javascript - Mailchimp 切换显示无/阻止

> ID：15420267
> 
> 赞同：0
> 
> 时间：2013-03-14T21:09:31.590
> 
> 标签：javascript, mailchimp

这可能有点晦涩难懂，但我正在与一个使用 mailchimp 活动来接触一组用户的小组打交道。他们希望能够向用户发送文章集，这些文章可以从 display:none 切换到 display:block onclick。文章正文以 display:none 开头，然后单击文章标题以显示它们。

使用 Jscript（显然）很容易做到这一点，但 Mailchimp 似乎在我们发送电子邮件后将所有 jscript 从我的电子邮件中删除。

任何人都知道向 mailchimp 活动添加未定义数量的文章（可能是 5 到 65 篇）并启用这种切换功能的方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T21:14:21.043

不幸的是，尝试在电子邮件中发送 JavaScript 可能不是一个好主意。这既是出于安全考虑……也是出于实用性（因为您不知道电子邮件收件人将使用什么浏览器或客户端。）[*（如本线程中所述。）*](http://forums.mozillazine.org/viewtopic.php?p=4622645)

但是谁知道呢……也许将来在电子邮件中发送 JavaScript 的实用性会发生变化。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-14T21:14:28.013

出于安全原因，所有邮件客户端都会删除嵌入式脚本。

大多数会去除可能导致电子邮件从其容器中分离出来的 CSS 形式（例如`position`等`display`）。请参阅：[Campaign Monitor CSS 指南](http://www.campaignmonitor.com/css/)。

除了包含链接之外，电子邮件不能是交互式的，因此电子邮件实际上只能将人们引导到执行您想要的操作的网页。

# php - 存储过程的 LAST_INSERT_ID() 结果

> ID：15420273
> 
> 赞同：2
> 
> 时间：2013-03-14T21:09:55.870
> 
> 标签：php, mysql, stored-procedures, last-insert-id

我在 mysql 中有一个存储过程，它正在更新很多行，然后插入一个（具体来说是分层数据结构）。除了我设置@insert_id 变量的最后一个代码外，不要看太多代码。

```
CREATE DEFINER=`root`@`localhost` PROCEDURE `addTaskNextTo`(IN `prev_id` INT, IN `pid` INT, IN `name` VARCHAR(100), IN `type` TINYINT, IN `uid` INT, IN `starting_date` DATE, IN `description` TEXT, OUT `insert_id` INT)
MODIFIES SQL DATA
BEGIN
    SELECT @myRight := rgt FROM tasks WHERE id = prev_id;
    UPDATE tasks SET rgt = rgt + 2 WHERE rgt > @myRight AND pid = pid;
    UPDATE tasks SET lft = lft + 2 WHERE lft > @myRight AND pid = pid;
    INSERT INTO tasks(pid, name, lft, rgt, type, uid, starting_date, description)
          VALUES(pid, name, @myRight + 1, @myRight + 2, type, uid, starting_date, description);
    SET @insert_id = LAST_INSERT_ID();
END 
```

现在，当我从 phpMyAdmin 执行此过程时，它返回正确的最后一个 id，但是当我从 php 调用它时，它返回上一个插入行的 id ？？？可能是什么问题，有没有更好的方法你建议我应该这样做。

这是我从 PHP 中调用它的方式：

```
$sql = "CALL addTaskNextTo($last_tid, $pid, '$task_name', 0, $uid, '$task_start', '$task_desc', @insert_id)"; 
```

这本身就充当了一个 SELECT 查询，我得到 1 列“insert_id”，其中一行的值例如“120”，它是前一个非当前插入行的 ID。

这是接收 sql 字符串并返回单个值的函数：

```
public static function get_single_value($sql) {
    global $db;
    $rez = $db->query($sql);
    return !empty($rez) ? mysql_result($rez,0) : false;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T23:07:18.510

我不确定你是怎么做的，但你应该这样做

```
$dbh->query("CALL addTaskNextTo($last_tid, $pid, '$task_name', 0, $uid, '$task_start', '$task_desc', @insert_id)");
$dbh->query("SELECT @insert_id"); 
```

请注意，您需要一个单独的 SELECT 查询来获取插入 ID 的更新值。否则你只会得到旧的。

或者，更好的是，类似：

```
$stmt = $dbh->prepare("CALL addTaskNextTo(?, ?, ?, ?, ?, ?, ?, @insert_id)");
$stmt->execute(array($last_tid, $pid, $task_name, 0, $uid, $task_start, $task_desc));
$dbh->query("SELECT @insert_id"); 
```

也可以使用 bind 将输出参数直接放在 PHP 变量中（参见[手册中的第三个示例](http://php.net/manual/en/pdostatement.bindparam.php)）。

* * *

编辑：如果您收到消息“命令不同步；您现在无法运行此命令”，这意味着您已打开无缓冲查询。这意味着您要么需要在两者之间读取结果，要么使用缓冲查询。为了帮助解决这个问题，您可以 `$stmt->store_result()`在第一个查询之后但在运行下一个查询之前使用。[在此线程](https://stackoverflow.com/questions/614671/commands-out-of-sync-you-cant-run-this-command-now)中查看更多详细信息。

# facebook-graph-api - 如何将 CDN HTTP 链接映射到 HTTPS？

> ID：15420276
> 
> 赞同：0
> 
> 时间：2013-03-14T21:10:08.250
> 
> 标签：facebook-graph-api, facebook-fql

问题：

我已经完成了图形搜索并存储了指向幻灯片应用程序的各种图片的 http 链接。问题是现在我需要安全的 https 链接。在线搜索会说只需在请求中使用 return_ssl_resources=1 在图形 API 中重新执行请求。

长话短说这是不可能的，因为数据已经存储，并且这些用户不再经过身份验证（没有重新请求的权限）。

FQL / Graph API 中是否有一种方法可以在不通过用户权限的情况下从 http:// 照片链接获取有效的 https:// 链接（因为我们已经可以访问照片并且只需要安全地返回它）？

# asp.net-mvc - 如何更改 IIS Express 8.0 安装目录使其不使用“我的文档”？

> ID：15420287
> 
> 赞同：5
> 
> 时间：2013-03-14T21:10:40.853
> 
> 标签：asp.net-mvc, visual-studio, iis, visual-studio-2012, iis-express

是否可以更改`IIS Express 8.0`以使其安装和配置目录不在“我的文档”下？

在我们的环境中，“我的文档”映射到网络共享。

问题是这使得本地开发`Visual Studio .NET 2012`依赖于网络。

当我在其中运行我的`ASP.NET MVC 4`应用程序时`Visual Studio .NET 2012`，它会启动`IIS Express 8.0`。

老实说，我不确定我`IIS Express 8.0`最初是如何进入我的开发机器的。我没有直接安装。但是，我已经安装了两者`Visual Studio .NET 2012`，`Microsoft WebMatrix 2.0`并且怀疑它带有其中一个（或两个）。

我尝试`IIS Express 8.0`从卸载`Programs and Features`，转到[Microsoft 下载中心 - IIS 8.0 Express](http://www.microsoft.com/en-us/download/details.aspx?id=34679)，下载`iisexpress_8_0_RTM_x64_en-US.msi`并重新安装它。

但是，在安装过程中，我没有看到任何选择安装目录的选项。

如果有人有任何改变这一点的经验，我将非常感谢您的建议或见解。非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-20T15:44:39.487

可悲的是，我认为答案是：这还做不到……还做不到。

我自己也想要这个，所以我深入研究了进程监视器，看看是否有一些可以控制它的键或文件配置。看起来该键是：HKCU\Software\Microsoft\IISExpress\CustomUserHome (REG_SZ)。您可以在本地驱动器上将其设置为您自己的自定义路径，IISExpress 将完美地支持它。

唉，Visual Studio 没有正确使用它。我认为这是一个错误。ProcMon 展示了 Visual Studio（简要）使用 CustomUserHome 条目，但随后仍在 %UserProfile%\IISExpress\config\ 文件夹中寻找必要的配置文件。

因此，如果您要尝试此修复程序（至少使用目前最新的 Visual Studio 2012 Update 2），它可能看起来像是在工作，但实际上它仍在使用相同的 %UserProfile%\IISExpress\config \ 文件夹。如果您删除或移动该文件夹，您的项目甚至根本不会打开。

如果有办法告诉 Visual Studio 使用哪个 IISExpress 用户目录，我还没有找到，但很高兴得到启发。

此博客文章显示了受相同错误影响的类似情况：http: [//areaofinterest.wordpress.com/2012/11/13/vs2012-iisexpress-migration-of-domainuser-and-network-share-wtf/](http://areaofinterest.wordpress.com/2012/11/13/vs2012-iisexpress-migration-of-domainuser-and-network-share-wtf/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-27T08:01:41.277

> 问题是这使得 Visual Studio .NET 2012 中的本地开发依赖于网络。

您可能想尝试不同的方法来解决此问题。

使`Documents\IIS Express`文件夹在网络上共享`"Always available offline"`。这使用 Windows 的脱机存储功能在本地缓存网络文件夹，并在网络共享可用时双向同步更改。

事实上，创建整个 Documents 文件夹可能会更好，`"Always available offline"`以避免其他应用程序在其中存储用户数据并期望这些数据始终可用的潜在问题。

# android - 从滑动视图打开弹出窗口

> ID：15420288
> 
> 赞同：0
> 
> 时间：2013-03-14T21:10:41.267
> 
> 标签：android, popup, swipe

我正在尝试从我的一个滑动视图（扩展 Fragment 的 LayoutTwo 类）中打开一个弹出窗口。我有下面的代码，但是当我按下按钮时，什么也没有发生。我认为传递我的观点有问题，但我不确定..有什么想法吗？

```
@Override
public View onCreateView(LayoutInflater inflater, ViewGroup container,Bundle savedInstanceState) {
    root = (ViewGroup) inflater.inflate(R.layout.layout_two, null); 
    this.container = container;
    Button test = (Button) root.findViewById(R.id.bButton);
    test.setOnClickListener(new OnClickListener() {

        @Override
        public void onClick(View v) {

            initiatePopupWindow();

        }
    });

    return root;
}
private void initiatePopupWindow() {
    try {

        LayoutInflater inflater = (LayoutInflater) container.getContext()
                .getSystemService(Context.LAYOUT_INFLATER_SERVICE);

        View layout = inflater.inflate(R.layout.popup_layout,
                (ViewGroup) container.findViewById(R.id.popup_element));

        pw = new PopupWindow(layout, 300, 470, true);

        pw.showAtLocation(layout, Gravity.CENTER, 0, 0);

        TextView mResultText = (TextView) layout.findViewById(R.id.server_status_text);
        Button cancelButton = (Button) layout.findViewById(R.id.end_data_send_button);

        cancelButton.setOnClickListener(cancel_button_click_listener);

    } catch (Exception e) {
        e.printStackTrace();
    }
} 
```

**编辑**

```
public class LayoutTwo extends Fragment {

    private PopupWindow pw;
    private ViewGroup root;
    private Context C;
    private ViewGroup container;

    public static Fragment newInstance(Context context) {
        LayoutTwo f = new LayoutTwo();  

        return f;
    }

    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container,Bundle savedInstanceState) {
        root = (ViewGroup) inflater.inflate(R.layout.layout_two, null); 
        this.container = container;
        Button test = (Button) root.findViewById(R.id.bButton);
        test.setOnClickListener(new OnClickListener() {

            @Override
            public void onClick(View v) {

                initiatePopupWindow();

            }
        });

        return root;
    }
    private void initiatePopupWindow() {
        try {

            LayoutInflater inflater = (LayoutInflater) container.getContext()
                    .getSystemService(Context.LAYOUT_INFLATER_SERVICE);

            View layout = inflater.inflate(R.layout.popup_layout,
                    (ViewGroup) container.findViewById(R.id.popup_element));
            View mainLayout = container.findViewById(R.id.linear);
            pw = new PopupWindow(mainLayout, 300, 470, true);

            pw.showAtLocation(mainLayout, Gravity.CENTER, 0, 0);

            TextView mResultText = (TextView) layout.findViewById(R.id.server_status_text);
            Button cancelButton = (Button) layout.findViewById(R.id.end_data_send_button);

            cancelButton.setOnClickListener(cancel_button_click_listener);

        } catch (Exception e) {
            e.printStackTrace();
        }
    }

    private OnClickListener cancel_button_click_listener = new OnClickListener() {
        public void onClick(View v) {
            pw.dismiss();
        }
    };

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T21:26:45.413

当您调用[PopupWindow.showAtLocation](http://developer.android.com/reference/android/widget/PopupWindow.html#showAtLocation%28android.view.View,%20int,%20int,%20int%29)时，第一个参数应该是它的**父**视图，而不是它自己的视图。

尝试这样做：

```
// assuming R.id.linear is the 'android:id' of your main view
View mainLayout = container.findViewById(R.id.linear);
pw.showAtLocation(mainLayout, Gravity.CENTER, 0, 0); 
```

编辑：为了将来参考，请记住，您还可以通过执行以下两项操作之一来获取根视图：

**包括**状态栏

```
getWindow().getDecorView().findViewById(android.R.id.content) 
```

**不包括**状态栏

```
((ViewGroup)findViewById(android.R.id.content)).getChildAt(0) 
```

# c# - Linq 有两个表

> ID：15420289
> 
> 赞同：0
> 
> 时间：2013-03-14T21:10:42.127
> 
> 标签：c#, asp.net, linq, asp.net-mvc-4

我正在使用项目 asp.net`MVC 4` 在我的控制器中，我需要返回一个`Json`函数。这是我的功能：

```
public JsonResult DatosVehiculo(GridSettings grid, string IdReclamo){
...
List<cSindVehiculo> lDvehiculo = Servicio.RetornaDatos<cSindVehiculo>(ref Mensaje, "crdsis.sin_dvehiculo", dvehiculo.Where(), dvehiculo);
var count = DatosVehiculo.Count();
var data = DatosVehiculo.Skip((grid.PageIndex - 1) * grid.PageSize).Take(grid.PageSize).ToArray();
var jsonData = new{
    total = (int)Math.Ceiling((double)count / grid.PageSize),
    page = grid.PageIndex,
    records = count,
    rows = (
           from m in data
           select new {
                id = m.sdv_idreclamo,
                cell = new object[] {
                  m.sdv_idreclamo,
                  m.sdv_parpieza,
                  m.sdv_parcodclase
                }
           });.ToArray()
});
return Json(jsonData, JsonRequestBehavior.AllowGet);
} 
```

以这种格式返回，例如：

```
sdv_idreclamo  sdv_parpieza  sdv_parcodclase
LP13000394         001           AC
LP13000394         002           CR 
```

但在烤架上不明白我需要这个显示它的最终用户：

```
sdv_idreclamo  sdv_parpieza  sdv_parcodclase
LP13000394     AMORTIGUADOR    ACCESORIOS
LP13000394    BOMBA DE ACEITE  CARROCERIA 
```

但此描述在其他表`"crdsis.cfg_parametros"`中，其中：

```
cp_idparametro    cp_descparametro    cp_tipoparametro
0001              AMORTIGUADOR        PIEZA
0002              BOMBA DE ACEITE     PIEZA
AC                ACCESORIOS          CODCLASE
CR                CARROCERIA          CODCLASE 
```

通过选择，我可以获得：

```
SELECT
   crdsis.sin_dvehiculo.sdv_idreclamo,
   (select crdsis.cfg_parametros.cp_descparametro from crdsis.cfg_parametros where (crdsis.sin_dvehiculo.sdv_parpieza = crdsis.cfg_parametros.cp_idparametro) and crdsis.cfg_parametros.cp_tipoparametro = 'PIEZA') as sdv_parpieza,
   (select crdsis.cfg_parametros.cp_descparametro from crdsis.cfg_parametros where (crdsis.sin_dvehiculo.sdv_parcodclase = crdsis.cfg_parametros.cp_idparametro) and crdsis.cfg_parametros.cp_tipoparametro = 'CODCLASE') as sdv_parcodclase
from crdsis.sin_dvehiculo
where sdv_idreclamo = 'LP13000394' 
```

我需要修改我的函数`public JsonResult DatosVehiculo`以返回这种格式。我如何修改`Linq`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T21:20:12.430

我相信根据您发布的内容，LINQ 语句属于：

`Servicio.RetornaDatos<cSindVehiculo>(ref Mensaje, "crdsis.sin_dvehiculo", dvehiculo.Where(), dvehiculo)`

没有更多细节，很难回答你的问题。您当然可以`ReturnoDatos`在您的页面中使用 LINQ 语句中的结果，但我认为这是此功能的错误层。

# ios - 将 Cordova 框架从 2.0.0 升级到 2.5.0

> ID：15420293
> 
> 赞同：0
> 
> 时间：2013-03-14T21:10:59.270
> 
> 标签：ios, xcode, cordova, cordova-2.0.0

我想按照本[教程](http://docs.phonegap.com/en/2.4.0/guide_upgrading_ios_index.md.html)升级我的 iOS 项目中的 Cordova 框架。

当前版本是 2.0.0，我从[网站](http://cordova.apache.org/)下载最新版本 2.5.0 。

但是，该教程似乎相当复杂。我想知道是否有办法将 Cordova 框架直接从 2.0.0 升级到 2.5.0。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-14T22:28:07.597

最好的方法是从 2.0.0 升级到 2.1.0 然后 2.2.0 .... 2.5.0

只需按照说明进行操作

- 或者 -

使用 phonegap 2.5.0 创建一个新项目并复制您的文件、插件并编辑配置文件以匹配之前的项目

# oracle - Oracle where 子句外连接

> ID：15420294
> 
> 赞同：1
> 
> 时间：2013-03-14T21:11:00.950
> 
> 标签：oracle, oracle11g

我无法理解如何使用特定查询的 where 子句进行外部联接。我可以使用 JOIN 关键字完成连接。我要完成的查询是：
-- 在 books 表中显示所有图书的列表。如果客户订购了一本书，请列出相应的订单号并说明客户来自

这是表结构

```
 desc customers
Name      Null     Type         
--------- -------- ------------ 
CUSTOMER# NOT NULL NUMBER(4)    
LASTNAME  NOT NULL VARCHAR2(10) 
FIRSTNAME NOT NULL VARCHAR2(10) 
ADDRESS            VARCHAR2(20) 
CITY               VARCHAR2(12) 
STATE              VARCHAR2(2)  
ZIP                VARCHAR2(5)  
REFERRED           NUMBER(4)    
REGION             CHAR(2)      
EMAIL              VARCHAR2(30) 

desc orders
Name       Null     Type         
---------- -------- ------------ 
ORDER#     NOT NULL NUMBER(4)    
CUSTOMER#           NUMBER(4)    
ORDERDATE  NOT NULL DATE         
SHIPDATE            DATE         
SHIPSTREET          VARCHAR2(18) 
SHIPCITY            VARCHAR2(15) 
SHIPSTATE           VARCHAR2(2)  
SHIPZIP             VARCHAR2(5)  
SHIPCOST            NUMBER(4,2)  

desc orderitems
Name     Null     Type         
-------- -------- ------------ 
ORDER#   NOT NULL NUMBER(4)    
ITEM#    NOT NULL NUMBER(2)    
ISBN              VARCHAR2(10) 
QUANTITY NOT NULL NUMBER(3)    
PAIDEACH NOT NULL NUMBER(5,2)  

desc books
Name     Null     Type         
-------- -------- ------------ 
ISBN     NOT NULL VARCHAR2(10) 
TITLE             VARCHAR2(30) 
PUBDATE           DATE         
PUBID             NUMBER(2)    
COST              NUMBER(5,2)  
RETAIL            NUMBER(5,2)  
DISCOUNT          NUMBER(4,2)  
CATEGORY          VARCHAR2(12) 
```

使用 join 我可以让它显示我认为正确的结果，如下所示：

```
SELECT b.title, c.state, order#
FROM customers c JOIN orders o USING (customer#)
JOIN orderitems oi USING (order#)
RIGHT OUTER JOIN books b USING (isbn);

TITLE                          STATE     ORDER#
------------------------------ ----- ----------
HOW TO GET FASTER PIZZA                         
THE WOK WAY TO COOK                             
REVENGE OF MICKEY              MI          1012 
REVENGE OF MICKEY              GA          1019 
REVENGE OF MICKEY              WA          1009 
REVENGE OF MICKEY              TX          1014 
BODYBUILD IN 10 MINUTES A DAY  FL          1003 
HANDCRANKED COMPUTERS          MI          1012 
SHORTEST POEMS                 GA          1005 
PAINLESS CHILD-REARING         GA          1001 
PAINLESS CHILD-REARING         NJ          1004 
PAINLESS CHILD-REARING         FL          1016 
PAINLESS CHILD-REARING         MI          1012 
PAINLESS CHILD-REARING         GA          1011 
COOKING WITH MUSHROOMS         WY          1020 
COOKING WITH MUSHROOMS         ID          1008 
COOKING WITH MUSHROOMS         FL          1003 
COOKING WITH MUSHROOMS         WA          1000 
COOKING WITH MUSHROOMS         WA          1009 
COOKING WITH MUSHROOMS         FL          1018 
COOKING WITH MUSHROOMS         NJ          1015 
HOLY GRAIL OF ORACLE           TX          1007 
BUILDING A CAR WITH TOOTHPICKS                  
BIG BEAR AND LITTLE DOVE       FL          1017 
BIG BEAR AND LITTLE DOVE       TX          1007 
BIG BEAR AND LITTLE DOVE       MI          1012 
DATABASE IMPLEMENTATION        IL          1002 
DATABASE IMPLEMENTATION        TX          1007 
DATABASE IMPLEMENTATION        FL          1003 
DATABASE IMPLEMENTATION        WY          1013 
DATABASE IMPLEMENTATION        FL          1018 
DATABASE IMPLEMENTATION        NJ          1010 
HOW TO MANAGE THE MANAGER      GA          1001 
E-BUSINESS THE EASY WAY        TX          1007 
E-BUSINESS THE EASY WAY        FL          1006 

 35 rows selected 
```

这是我为 where 子句加入所尝试的：

```
-- using where clause
SELECT b.title,  c.state, oi.order#
FROM customers c, orders o, orderitems oi, books b
WHERE c.customer# = o.customer#
AND o.order# = oi.order#
AND oi.isbn(+) = b.isbn; 
```

但是当我执行此查询时，我得到以下信息

```
TITLE                          STATE     ORDER#
------------------------------ ----- ----------
BODYBUILD IN 10 MINUTES A DAY  FL          1003 
REVENGE OF MICKEY              GA          1019 
REVENGE OF MICKEY              TX          1014 
REVENGE OF MICKEY              MI          1012 
REVENGE OF MICKEY              WA          1009 
DATABASE IMPLEMENTATION        FL          1018 
DATABASE IMPLEMENTATION        WY          1013 
DATABASE IMPLEMENTATION        NJ          1010 
DATABASE IMPLEMENTATION        TX          1007 
DATABASE IMPLEMENTATION        FL          1003 
DATABASE IMPLEMENTATION        IL          1002 
COOKING WITH MUSHROOMS         WY          1020 
COOKING WITH MUSHROOMS         FL          1018 
COOKING WITH MUSHROOMS         NJ          1015 
COOKING WITH MUSHROOMS         WA          1009 
COOKING WITH MUSHROOMS         ID          1008 
COOKING WITH MUSHROOMS         FL          1003 
COOKING WITH MUSHROOMS         WA          1000 
HOLY GRAIL OF ORACLE           TX          1007 
HANDCRANKED COMPUTERS          MI          1012 
E-BUSINESS THE EASY WAY        TX          1007 
E-BUSINESS THE EASY WAY        FL          1006 
PAINLESS CHILD-REARING         FL          1016 
PAINLESS CHILD-REARING         MI          1012 
PAINLESS CHILD-REARING         GA          1011 
PAINLESS CHILD-REARING         NJ          1004 
PAINLESS CHILD-REARING         GA          1001 
BIG BEAR AND LITTLE DOVE       FL          1017 
BIG BEAR AND LITTLE DOVE       MI          1012 
BIG BEAR AND LITTLE DOVE       TX          1007 
HOW TO MANAGE THE MANAGER      GA          1001 
SHORTEST POEMS                 GA          1005 

 32 rows selected 
```

这是一个链接到将在需要时构建结构的 sql [https://www.dropbox.com/s/7tpbpz1hbufj3qn/JLDB_Build_8.sql](https://www.dropbox.com/s/7tpbpz1hbufj3qn/JLDB_Build_8.sql)

我很难弄清楚 where 子句加入我做错了什么/不同。任何帮助或方向表示赞赏。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T21:17:42.793

试试这个：

```
SELECT b.title,  o.state, o.order#
FROM books b
, (select o.order#, oi.isbn, o.customer#, c.state
   from orders o, orderitems oi, customers c
   where o.order# = oi.order#
   and   c.customer# = o.customer#
) o
WHERE 
AND o.isbn(+) = b.isbn; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-14T21:17:53.087

使用连接时，我建议进行显式左/右连接。例如..

```
Select A.*, B.*, C.*
from TableA A 
 left outer join TableB B
 on A.field1 = B.fkfield1
 and A.field2 0 B.fkfield2
 ...

 left outer join TableC C
 on A.field1 = C.fkfield1
 and A.field2 0 C.fkfield2
 ... 
```

在这种情况下，表 A 的记录将与表 B 上的记录匹配。如果表 B 上没有匹配项，则表 B 中的列将为空。第二个连接的工作方式与第一个连接相似，如果表 C、fkfield1 中的 field1（在表 A 上）没有匹配值，这种情况也将显示 null。

另一方面，如果您需要匹配第二个表而不是第一个表的所有记录，则需要执行“内连接”。只需将上面示例中的“左外连接”替换为“内连接”即可。

谢谢！

@leo

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-15T01:09:55.267

经过更多的挖掘，我发现了这个

这是来自[http://docs.oracle.com/cd/B19306_01/server.102/b14200/queries006.htm](http://docs.oracle.com/cd/B19306_01/server.102/b14200/queries006.htm)

> 如果 A 和 B 通过多个连接条件连接，则必须在所有这些条件中使用 (+) 运算符。如果您不这样做，那么 Oracle 数据库将仅返回由简单连接产生的行，但不会发出警告或错误来告知您没有外部连接的结果。
> 
> 如果您在外部查询中指定一个表而在内部查询中指定另一个表，则 (+) 运算符不会生成外部联接。

我能够使它与以下内容一起工作：

`SELECT b.title, c.state, o.order# FROM customers c, orders o, orderitems oi, books b WHERE c.customer#(+) = o.customer# AND o.order#(+) = oi.order# AND oi.isbn(+) = b.isbn;`

# ruby-on-rails - 在 postgres 和 sqlite3 中取布尔列的平均值

> ID：15420301
> 
> 赞同：2
> 
> 时间：2013-03-14T21:11:52.730
> 
> 标签：ruby-on-rails, postgresql, activerecord, sqlite, rails-activerecord

我有很多 ActiveRecord 查询使用表达式的平均值找到百分比，例如：

```
def self.undergraduate_degree_percentage
  self.average("undergrad_college_name != ''")
end 
```

这些是为 sqlite3（开发数据库）构建的，但在 postgres（生产数据库）中分解，因为 pg 处理布尔值的方式不同。生成的错误类似于`ERROR: function avg(boolean) does not exist at character 8`. 有没有一种优雅的方法可以使这种类型的查询同时适用于 sqlite3 和 PG？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-14T22:00:21.910

数据库中的布尔值很难以便携方式使用：

1.  MySQL 和 SQLite 原生使用 C 风格的布尔值。
2.  SQLite 的 ActiveRecord 驱动程序有时会错误地[将`'t'`和`'f'`字符串用作布尔值](https://stackoverflow.com/a/6013177/479863)。这可能会在较新的版本中得到修复。
3.  PostgreSQL 有一个原生的布尔类型。
4.  其他数据库做其他事情。
5.  有时会自动转换为数值，有时则不会。
6.  ?
7.  [利润。](http://en.wikipedia.org/wiki/Underpants_gnomes)

如果您想以便携方式执行此操作，则应手动转换布尔值。在您的情况下，您很幸运拥有一个产生本机布尔值的表达式，因此您不必担心 AR 的 SQLite 脑损伤。一个简单的 CASE 应该让事情在任何地方都一样：

```
self.average(%q{
  case
    when undergrad_college_name != '' then 1.0
    else 0.0
  end
}) 
```

这将为您提供浮点结果（可能是 Float 或 BigDecimal），然后您可以从那里决定如何处理它。

# c - 在 Linux 上使用共享内存进行低延迟数据包处理？

> ID：15420302
> 
> 赞同：4
> 
> 时间：2013-03-14T21:11:56.677
> 
> 标签：c, linux, performance, udp, latency

如果我要在 Linux 上接收 UDP 数据包（并且我不介意更改一些源代码），我的应用程序读取数据包的最快方法是什么？

我是否想修改网络堆栈，以便在收到 UDP 数据包后将其写入共享内存并让应用程序访问该内存？

堆栈是否有办法通知应用程序做出反应，而不是让应用程序不断轮询共享内存？

欢迎任何建议/进一步的资源 - 我只见过：

[http://www.kegel.com/c10k.html](http://www.kegel.com/c10k.html)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T08:06:26.793

如果延迟是一个问题并且默认的 UDP 网络堆栈没有按照您的意愿执行，那么请尝试使用不同的现有（可安装）网络堆栈。

例如，尝试[UDP Lite](https://en.wikipedia.org/wiki/UDP_Lite)，与标准 UDP 堆栈相比，此特定堆栈不对 UDP 数据报执行任何校验和，从而以向应用层提供损坏的数据报为代价来减少延迟。

旁注：您不需要有“轮询”机制。阅读`select`（可能是类似`pselect`or的派生词`ppoll`）的手册，使用这样的 API，一旦在管道中有要读取或写入的内容，内核就会“唤醒”您的应用程序。

# php - 将 HTML 段落转换为换行符

> ID：15420303
> 
> 赞同：2
> 
> 时间：2013-03-14T21:12:06.487
> 
> 标签：php, content-management-system, preg-replace, newline, preg-match-all

我正在为我的博客改进我的基本 CMS。今天我添加了一个新功能，它将数据库中的（双）换行符转换为段落标签。

```
function nl2p($str) {
    $pattern = '/\n\n/';
    $replacement = '</p><p>';
    return preg_replace($pattern, $replacement, $str);
} 
```

这很好用，除了我不想`<p>`在我的标签中添加任何`<pre>`标签。所以我想我会扩展我的功能以将所有这些`<p>`标签重新转换为换行符，但它不起作用。关于为什么的任何想法？

```
function nl2p($str) {
    $pattern = '/\n\n/';
    $replacement = '</p><p>';
    $par = preg_replace($pattern, $replacement, $str);

    preg_match_all('/\<pre\>(.*?)\<\/pre\>/', $par, $pre_content);
    return preg_replace($replacement, $pattern, $pre_content[0]);
} 
```

**编辑：**由于这似乎很难破解，也许我应该在我的代码中添加一些上下文。我正在使用[语法荧光笔](http://alexgorbatchev.com/SyntaxHighlighter/)在我的博客上以原始格式显示代码。荧光笔是用 Javascript 编写的，并利用 HTML 中预先格式化的标签来显示代码。

另外，我上面的 nl2p 函数是我博客类的一个方法。问题是它使用我的预格式化标签以原始格式（即可见）放置预格式化标签。

**编辑 2：**这是一些示例代码。首先是数据库中的原始代码，然后是格式化的 HTML 代码。另一个奇怪的细节是，下面代码中的最后一个`</p>`在源代码中实际上是不可见的。它出现在结束的 pre 标记之后。

```
<pre name="code" class="brush: javascript">
var data = [10, 20, 30];

var svg = d3.select("body")
.append("svg")
.attr("width", 500)
.attr("height", 500);

var circle = svg.selectAll("circle")
          .data(data)
          .enter()
            .append("circle")
            .attr("cx", function (d) { return d * 10; })
            .attr("cy", 50)
            .attr("r", function (d) { return d; })
            .style("fill", "red");</pre>

----------

var data = [10, 20, 30];<p></p><p>var svg = d3.select("body")
.append("svg")
.attr("width", 500)
.attr("height", 500);

var circle = svg.selectAll("circle")
          .data(data)
          .enter()
            .append("circle")
            .attr("cx", function (d) { return d * 10; })
            .attr("cy", 50)
            .attr("r", function (d) { return d; })
            .style("fill", "red");</p> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T21:18:09.980

假设您的正则表达式没问题，它应该是：

```
return preg_replace($pattern,$replacement,$pre_content[1]);//note the second element of the array [1] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-14T22:58:26.690

根据要求，这应该将双换行符转换为段落标签，除了那些在预格式化标签内的双换行符：

```
$sourcestring="your source string";
echo preg_replace('#\n\n(?!((?!<pre>).)*</pre>)#is','</p><p>',$sourcestring); 
```

在这里进行了测试，稍微修改了模式以解释换行符，该工具包括：[http ://www.myregextester.com/?r=a24b18cf](http://www.myregextester.com/?r=a24b18cf)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-14T21:20:16.710

尝试这个：

```
/**
 * Converts a new-line delimited string (with embedded HTML PRE tags) to
 * HTML paragraphs, preserving the newline delimiters within the PRE.
 * @param string $str
 * @return string
 */
function pFormat( $str )
{
    $a = explode( "\n", $str );
    $out = array();
    $isPre = FALSE;
    $lastBlank = FALSE;
    for( $i = 0, $l = count( $a ); $i < $l; $i++ )
    {
        $line = trim( $a[$i] );
        if( empty( $line ) )
        {
            if( $isPre )
            {
                $out[] = "";
            }
            continue;
        }
        if( substr( $line, 0, 4 ) == '<pre' )
        {
            $isPre = TRUE;
            $out[] = $line;
            continue;
        }
        if( substr( $line, 0, 5 ) == '</pre' )
        {
            $out[] = $line;
            $isPre = FALSE;
            continue;
        }
        $out = '<p>' . $line . '</p>';
    }
    return implode( "\n", $out );
} 
```

# c - 从主函数外部调用 pthread_create

> ID：15420307
> 
> 赞同：2
> 
> 时间：2013-03-14T21:12:20.553
> 
> 标签：c, pthreads, pthread-join

我想做这样的事情：

```
void *do_work_son(void *data)
{            
    mystruct *d = (mystruct*)data;
    while(true)
    {
        // d->whatever is corrupt
    }
}

void start_thread(pthread_t *mt)
{
    mystruct data = ...;
    pthread_create(&(*mt), NULL, do_work_son, (void *)&data);
}

int main()
{
    pthread mt;
    start_thread(&mt);
    // do more stuff here
    pthread_join(mt, NULL);
} 
```

这个想法是产生一些线程并继续做更多的工作`main`......然后当完成更多的工作时，等待线程完成。

它编译得很好，但是`data`当它在内部被访问时结构被破坏了`do_work_son`。我认为这是因为线程正在退出，即使我正在调用 join in `main`。如果我将`pthread_{create,join}`调用都移到 start_thread，它可以正常工作，但是我的 main 函数被 while 循环阻塞。我这样做是不是疯了？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-14T21:15:48.500

> 我认为这是因为线程正在退出，

不，那是因为`data`是`start_thread()`函数中的一个自动变量，返回时无效`start_thread()`，所以之后使用它的地址会调用未定义的行为。

要么`malloc()`为它吃一些内存，要么让它成为静态的，或者其他什么。只要确保它在`start_thread()`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-14T21:16:14.360

答案很简单：你传递了一个局部变量的引用，然后离开了作用域。用堆上分配的数据替换它，它就像一个魅力

```
void start_thread(pthread_t *mt)
{
    mystruct *data = malloc(sizeof(*data));
    ...;
    pthread_create(mt, NULL, do_work_son, data);
} 
```

编辑：

关于预习题：

```
void start_thread(pthread_t *mt)
{
    mystruct local_data = {...};
    mystruct *data = malloc(sizeof(*data));
    *data = local_data;
    ...;
    pthread_create(mt, NULL, do_work_son, data);
} 
```

# selenium - Selenium 测试本地字符串

> ID：15420311
> 
> 赞同：0
> 
> 时间：2013-03-14T21:12:28.493
> 
> 标签：selenium

我没有从服务器获取 HTML，而是在内存中已经有了 HTML 字符串，我想使用 Selenium 来检查它的内容。那可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T11:03:04.003

如果您愿意，可以将本地 html 文件作为字符串或本地 txt 文件进行操作。

以下是如何在 Ruby 中执行此操作：

```
require 'open-uri'
require 'nokogiri'

# *** open a URL as a string or as a local txt file 
# *** strip the file out of unnecessary html tags and encode chars ***

$url = driver.current_url    
$txt_file = open($url)

$raw_contents = $txt_file.read    
$html = Nokogiri::HTML(CGI.unescapeHTML($raw_contents)).content
#here we strip the web page fetched out of all hmtl tags and encoded chars

$txt_file = File.new('c:\ruby193\bin\web-content\web_read.txt', "w") 
#web_read.txt should now contain a stripped, pure txt file

$txt_file.write($html)
$txt_file.close 
```

# css - html 列表更改某些列表文本颜色和背景颜色

> ID：15420312
> 
> 赞同：0
> 
> 时间：2013-03-14T21:12:28.943
> 
> 标签：css, html-lists

我的html：

```
<ul class="tech">
  <li>JavaScript</li>
  <li>HTML / CSS</li>
  <li>PHP + MYSQL</li>
  <li>C#</li>
  <li class="software">PhotoShop</li>
  <li class="software">Brackets</li>
  <li class="software">Notepad++</li>
  <li class="software">Sony Vegas</li>
  <li class="software">eBay BlackThorne Pro</li>
  <li class="software">Senuke XCr</li>
  <li class="software2">X-Cart</li>
  <li class="software2">EKM PowerShop</li>
  <li class="software2">WordPress</li>
  <li class="software2">phpBB</li>
</ul>
</div> 
```

这个 html 的 Css 部分：

```
.tech ul {
    padding: 0px 0px 0px 0px;
    margin-bottom: 10px;
    margin-top: 10px;
    list-style:none;
    list-style-position:outside;
}
.tech li{
  display:inline-block;
  text-align: center;
  background-color: #cccccc;
  color: #222222;
  margin: 5px 0px 5px 0px;

  border-radius: 3px;
  -moz-border-radius: 3px;
  box-shadow: 2px 3px 5px #000000;
  border: #969696 1px dashed;
}

.sofware {
    background-color:#646464;
    color: #ff7225;
}

.sofware2 {
    background-color:#4d4d4d;
    color: #fd205e; 
} 
```

问题：列出软件和software2 ids 不改变颜色的项目。有什么问题？应该是这样的，我想我应该用“UL Li:nth-child”设置这些颜色，但我不知道该怎么做。

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-14T21:13:47.377

jsfiddle 说它有效：http: [//jsfiddle.net/nLWAE/1/](http://jsfiddle.net/nLWAE/1/)

```
<ul class="tech">
  <li>JavaScript</li>
  <li>HTML / CSS</li>
  <li>PHP + MYSQL</li>
  <li>C#</li>
  <li class="software">PhotoShop</li>
  <li class="software">Brackets</li>
  <li class="software">Notepad++</li>
  <li class="software">Sony Vegas</li>
  <li class="software">eBay BlackThorne Pro</li>
  <li class="software">Senuke XCr</li>
  <li class="software2">X-Cart</li>
  <li class="software2">EKM PowerShop</li>
  <li class="software2">WordPress</li>
  <li class="software2">phpBB</li>
</ul>

.tech ul {
    padding: 0px 0px 0px 0px;
    margin-bottom: 10px;
    margin-top: 10px;
    list-style:none;
    list-style-position:outside;
}
.tech li{
  display:inline-block;
  text-align: center;
  background-color: #cccccc;
  color: #222222;
  margin: 5px 0px 5px 0px;

  border-radius: 3px;
  -moz-border-radius: 3px;
  box-shadow: 2px 3px 5px #000000;
  border: #969696 1px dashed;
}
.software {
    background-color:#646464;
    color: #ff7225;
}

.software2 {
    background-color:#4d4d4d;
    color: #fd205e; 
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-14T21:21:41.940

首先，您的 CSS 选择器与您的 s 不匹配`id`。您的 id 中有“软件”，但 CSS 选择器中有“软件”。但是你也有重复`id`的 s，这是错误的。

改变你的

```
<li id="software"></li>
<li id="software2"></li> 
```

到

```
<li class="software"></li>
<li class="software2"></li> 
```

然后将您的 CSS 更改为：

```
.tech li.software {
    background-color:#646464;
    color: #ff7225;
}

.tech li.software2 {
    background-color:#4d4d4d;
    color: #fd205e; 
} 
```

# css - 如何在所有浏览器中显示自定义滚动条？

> ID：15420314
> 
> 赞同：22
> 
> 时间：2013-03-14T21:12:43.747
> 
> 标签：css, scrollbar

我正在为颜色自定义滚动条使用一个简单的代码：

```
<style type="text/css">  
<!--
BODY
{
    scrollbar-face-color: #000000;
    scrollbar-highlight-color: #000000;
    scrollbar-3dlight-color: #000000;
    scrollbar-darkshadow-color: #000000;
    scrollbar-shadow-color: #000000;
    scrollbar-arrow-color: #FF99FF;
    scrollbar-track-color: #FFCCFF;
}
-->
</style> 
```

它在chrome中不起作用，但它在IE中起作用并且不确定其他浏览器。我使用 chrome 作为我的主要浏览器，我在其他网站上也看到过这个问题，但想知道是否有任何解决方法？

现在有一种方法可以使用特殊脚本创建可在所有浏览器中使用的半透明 div/box，所以想知道是否有类似的滚动条解决方案？

谢谢！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-14T21:16:54.910

这里有一些适用于所有浏览器的插件：

1.  [http://jscrollpane.kelvinluck.com/](http://jscrollpane.kelvinluck.com/)
2.  [http://www.hesido.com/web.php?page=customscrollbar](http://www.hesido.com/web.php?page=customscrollbar)
3.  [http://www.script-tutorials.com/custom-scrollbars-cross-browser-solution/](http://www.script-tutorials.com/custom-scrollbars-cross-browser-solution/)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2018-03-29T09:51:31.403

```
::-webkit-scrollbar {
    width: 15px;
    background:lightgray;
}

::-webkit-scrollbar-track {
    -webkit-box-shadow: inset 0 0 6px rgba(0,0,255,1); 
    border-radius: 15px;
}

::-webkit-scrollbar-thumb {
    border-radius: 15px;
    -webkit-box-shadow: inset 0 0 6px rgba(0,0,0,0.5); 
    background:cyan;
} 
```

这将在 Chrome 中运行。Firefox 不支持滚动样式。希望能帮助到你！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-14T21:17:37.437

`scrollbar`不是 CSS 标准。在 Chrome 或 Safari (WebKit) 中，您可以使用以`-webkit-` [Read more here](https://www.webkit.org/blog/363/styling-scrollbars/)为前缀的扩展。

FireFox 不支持滚动条样式。

所以可能你只能在 IE 和 WebKit 浏览器中支持这种效果，或者像 Iwo Kucharski 所说的那样使用 JavaScript 库。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2020-09-04T22:31:37.690

```
/*! Firefox */    
html{
    scrollbar-color: #128612 #004E00;
}

/*! Other Browser */
html {
    --scrollbarBG: #128612;
    --thumbBG: #004E00;
  }
  body::-webkit-scrollbar {
    width: 11px;
  }
  body {
    scrollbar-width: thin;
    scrollbar-color: var(--thumbBG) var(--scrollbarBG);
  }
  body::-webkit-scrollbar-track {
    background: var(--scrollbarBG);
  }
  body::-webkit-scrollbar-thumb {
    background-color: var(--thumbBG) ;
    border-radius: 6px;
    border: 3px solid var(--scrollbarBG);
  } 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-03-14T21:16:05.677

这些属性在 Internet Explorer 之外根本不起作用。它们是一种有点奇怪的微软混合物，从来没有任何标准。

如果你想伪造它，你需要一些 Javascript。我不认为纯 CSS 会给你带来这种效果。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-12-29T18:00:21.980

支持现代浏览器的自定义滚动条示例 **将鼠标拖到测试上**

```
 (function (n, t) { function u(n) { n.hasOwnProperty("data-simple-scrollbar") || Object.defineProperty(n, "data-simple-scrollbar", new SimpleScrollbar(n)) } function e(n, i) { function f(n) { var t = n.pageY - u; u = n.pageY; r(function () { i.el.scrollTop += t / i.scrollRatio }) } function e() { n.classList.remove("sc-grabbed"); t.body.classList.remove("sc-grabbed"); t.removeEventListener("mousemove", f); t.removeEventListener("mouseup", e) } var u; n.addEventListener("mousedown", function (i) { return u = i.pageY, n.classList.add("sc-grabbed"), t.body.classList.add("sc-grabbed"), t.addEventListener("mousemove", f), t.addEventListener("mouseup", e), !1 }) } function i(n) { for (this.target = n, this.bar = '<div class="sc-scroll">', this.wrapper = t.createElement("div"), this.wrapper.setAttribute("class", "sc-wrapper"), this.el = t.createElement("div"), this.el.setAttribute("class", "sc-content"), this.wrapper.appendChild(this.el); this.target.firstChild;)this.el.appendChild(this.target.firstChild); this.target.appendChild(this.wrapper); this.target.insertAdjacentHTML("beforeend", this.bar); this.bar = this.target.lastChild; e(this.bar, this); this.moveBar(); this.el.addEventListener("scroll", this.moveBar.bind(this)); this.el.addEventListener("mouseenter", this.moveBar.bind(this)); this.target.classList.add("sc-container") } function f() { for (var i = t.querySelectorAll("*[sc-container]"), n = 0; n < i.length; n++)u(i[n]) } var r = n.requestAnimationFrame || n.setImmediate || function (n) { return setTimeout(n, 0) }; i.prototype = { moveBar: function () { var t = this.el.scrollHeight, i = this.el.clientHeight, n = this; this.scrollRatio = i / t; r(function () { n.bar.style.cssText = "height:" + i / t * 100 + "%; top:" + n.el.scrollTop / t * 100 + "%;right:-" + (n.target.clientWidth - n.bar.clientWidth) + "px;" }) } }; t.addEventListener("DOMContentLoaded", f); i.initEl = u; i.initAll = f; n.SimpleScrollbar = i })(window, document)
```

```
 /* custom scrollbar */
.sc-wrapper {
    overflow : hidden;
    height   : 100%;
    position : relative;
    z-index  : 1;
    float: left;
}

.sc-content {
    height          : 100%;
    width           : 100%;
    padding         : 0 32px 0 0;
    position        : relative;
    right           : -18px;
    overflow        : auto;
    -moz-box-sizing : border-box;
    box-sizing      : border-box;
}

.sc-scroll {
  position            : relative;
  background          : rgba(0, 0, 0, .1);
  width               : 9px;
  border-radius       : 4px;
  top                 : 0;
  z-index             : 2;
  cursor              : pointer;
  opacity: 0;
  transition: opacity 0.25s linear;
}

.sc-container:hover .sc-scroll {
  opacity: 1;
}

.sc-grabbed {
     user-select: none;
     -o-user-select: none;
     -moz-user-select: none;
     -khtml-user-select: none;
     -webkit-user-select: none;
}
.msg-page {
  height: 500px;
  width: 400px;
}
```

```
 <div class="container">
        <div class="msg-page" sc-container>
test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>test test <br/>
        </div>
    </div>
```

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2020-01-11T19:52:44.057

如果我们禁用 javascript，滚动将不起作用，是不是也没有人有代码`<noscript>`。

# php - PHP中的反斜杠字符

> ID：15420316
> 
> 赞同：-1
> 
> 时间：2013-03-14T21:12:46.917
> 
> 标签：php, styles, inline, backslash

我不明白以下行中两个反斜杠的功能...

```
echo "<p style=\"font-family: $font; font-size: {$size}em;\">Hello, world!</p>"; 
```

这段代码：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
    <head>
        <title>Saying hello with style</title>
        <link rel="stylesheet" type="text/css" href="common.css" />
    </head>
    <body>
        <h1>Saying hello with style</h1>

<?php

function helloWithStyle( $font, $size ) {
    echo "<p style=\"font-family: $font; font-size: {$size}em;\">Hello, world!</p>";
}

helloWithStyle( "Helvetica", 2 );
helloWithStyle( "Times", 3 );
helloWithStyle( "Courier", 1.5 );

?>

    </body>
</html> 
```

删除两个反斜杠会导致“预期，或；” 上面粘贴的代码行出错。为什么是这样？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-14T21:14:13.350

反斜杠`\`是转义字符，允许字符串无错误地输出。

如果你用双引号开始一个字符串`"`，下次你使用双引号时，它会有效地结束这个字符串。这同样适用于单引号`'`来开始一个字符串。

如果你用双引号开始一个字符串，`"`你可以在字符串中使用单引号`'`而不转义引号，反之亦然。

以您的代码段为例，这些都是等效的：

```
echo "<p style=\"font-family: $font; font-size: {$size}em;\">Hello, world!</p>";

echo '<p style="font-family: $font; font-size: {$size}em;">Hello, world!</p>';

echo "<p style='font-family: $font; font-size: {$size}em;'>Hello, world!</p>"; 
```

[**PHP：字符串文档**](http://php.net/manual/en/language.types.string.php)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-14T21:14:26.487

它们对引号进行转义，因此它们不计为实际引号 - 否则它们标记字符串的结尾，并且 HTML 的其余部分被视为 PHP 代码，这显然不起作用。

请参阅[文档](http://php.net/string)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-14T21:14:52.943

因为`"`标记标记了字符串的开始和结束。如果要在字符串中包含引号，则必须使用反斜杠字符对其进行转义，否则它将被视为字符串的结尾，并且后面的内容在编码上下文中没有意义，因此会出现错误。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-14T21:15:11.400

这是因为您只使用双引号。\ 是一个转义字符，它将允许 php 打印 " 而不假设它是引号的结尾。编写该行的更好方法可能是

```
 echo '<p style="font-family: $font; font-size: {$size}em;">Hello, world!</p>'; 
```

# php - 脸书获取用户。它总是返回零

> ID：15420318
> 
> 赞同：2
> 
> 时间：2013-03-14T21:12:53.877
> 
> 标签：php, facebook, facebook-graph-api

请看一下我的代码..

```
 <?php
 require_once 'src/facebook.php';

// Create our Application instance (replace this with your appId and secret).
$facebook = new Facebook(array(
  'appId'  => 'apppID',
  'secret' => 'sercretCode',
  'cookie' =>'true'
));

?>
<!DOCTYPE html>
<html xmlns:fb="http://www.facebook.com/2008/fbml">
<head>
    <meta charset="utf-8" />
    <title>Facebook PHP</title>
</head>
<body>
<h1>Hello World</h1>
<?php
    //get user from facebook object
    $user = $facebook->getUser();

    if ($user): //check for existing user id
        echo '<p>User ID: ', $user, '</p>';
    else: //user doesn't exist
        $loginUrl = $facebook->getLoginUrl(array(
            'diplay'=>'popup',
            'redirect_uri' => 'http://apps.facebook.com/returnpath/'
        ));
        echo '<p><a href="', $loginUrl, '" target="_top">login</a></p>';
    endif; //check for user id
?>
</body>
</html> 
```

现在，getUser() 方法总是返回 0 并进入 else。我总是得到“登录”之类的，即使我登录也是一样。如果有任何问题，请告诉我。我已经看到了很多这样的问题，但没有一个能完全解决问题。我的 appid 和密钥是正确的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T08:07:45.593

根据[SDK 文档](http://developers.facebook.com/docs/reference/php/facebook-getUser/)`$facebook->getUser()`，如果用户尚未登录，您将获得零值。

*   尝试在 facebook 中以该用户身份登录，然后调用 getUser() 方法。
*   'cookie' => 'true' 是可选的吗？如果是这样，请尝试删除该配置参数。确保正在创建您的 facebook 对象。
*   检查您的日志以查看代码是否未生成任何错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T15:47:04.913

出色地！！包括我在内的大多数人都对在注册应用程序后立即制作他们的应用程序感到好奇。我没有对上面的代码做任何改动。

**默认情况下，访问应用程序 FB 需要 24 小时**。因此，您将无法获得用户 ID 或有关用户的任何详细信息。请等待24小时。

# jquery - 获取字符串并将其包装

> ID：15420319
> 
> 赞同：-2
> 
> 时间：2013-03-14T21:13:06.783
> 
> 标签：jquery, regex, string, hyperlink

 我有一些动态生成的 HTML，所以我无法编辑 HTML。HTML 看起来像 (1)。我希望它看起来像（2）。`li`所以基本上，应该将 's末尾的字符串剪切并粘贴到一个`<a>`然后包裹在其他文本周围的字符串中。尾随`-`也应该被删除。

**HTML** (1)

```
<ul>
  <li>Jovanotti – L'ombelico Del Mondo - http://youtu.be/mMNPUw2bUhM</li>
  <li>The Police – Roxanne - http://youtu.be/3T1c7GkzRQQ</li>
</ul> 
```

它应该是什么样子 (2)

```
<ul>
  <li><a href="http://youtu.be/mMNPUw2bUhM" title="">Jovanotti – L'ombelico Del Mondo</a></li>
  <li><a href="http://youtu.be/3T1c7GkzRQQ" title="">The Police – Roxanne</a></li>
</ul> 
```

这是一个与已经在 SO 上提出的问题不同的问题。我不知道“url”的内容，只知道它总是以`http://youtu.be`. 

这是一个可以玩的[小提琴。](http://jsfiddle.net/7EhhS/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-14T21:30:39.697

循环遍历元素，使用`.split`' - '分解字符串，然后弹出最后一个元素（url）和`.join`字符串的其余部分与元素之间的' - '一起弹出。

```
$('ul li').each(function () {
    var li = $(this),
        parts = li.text().split(' - ');
    li.html('<a href="' + parts.pop() + '">' + parts.join(' - ') + '</a>');
}); 
```

[http://jsfiddle.net/rustyjeans/89whD/](http://jsfiddle.net/rustyjeans/89whD/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-14T21:45:19.810

我会使用[`.wrapInner()`](http://api.jquery.com/wrapInner)和的组合[`.each()`](http://api.jquery.com/each)：

```
$('ul li').wrapInner('<a>').find('a').each(function(i,el) {
    var arrCont = $(el).text().split(/\s*-\s*http/),
        strText = arrCont[0],
        strUrl = "http"+arrCont[1];
    $(el).attr('href',strUrl).attr('title','').text(strText);
}); 
```

[http://jsfiddle.net/mblase75/Ax8QU/](http://jsfiddle.net/mblase75/Ax8QU/)

# javascript - 悬停另一个 div 时隐藏 div

> ID：15420327
> 
> 赞同：1
> 
> 时间：2013-03-14T21:13:56.607
> 
> 标签：javascript, css, html, hover, hidden

所以我在这样的 div 中有一些 div：

```
 <div class="flip-container">
        <div class="flipper">
            <a href="#" data-reveal-id="pc1">
                <div class="inner" style="background-color:#ea6524;">
                    <p class="text">title</p>
                    <img src="1.png" class="img" />
                </div>
            </a>
        </div>
   </div> 
```

描述：现在使用翻转容器和翻转器，因为当我悬停这个 div 时，我触发了一个 css 转换，它翻转了 div。当单击内部 div 时，href 只允许打开一个带有描述的 div，内部 div 是一个带有文本和图像的正方形。

我想做什么：当我悬停翻转容器时，我想隐藏文本“标题”和 img“1.png”。

我怎样才能做到这一点？

我尝试将 display:hidden 添加到类文本中，但它仅在我悬停实际文本时有效，而不是在我悬停翻转容器背景时有效。

谢谢您的帮助

如果可能的话，我更喜欢纯 css 解决方案，如果不是 javascript 解决方案也可以。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-14T21:16:23.270

这应该可以解决问题：

```
.flip-container:hover .text, .flip-container:hover img {
    display: none;
} 
```

或者，您可以使用`visibility: hidden`，因为这会将元素保留在文档流中，而不是一起删除它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-14T21:31:26.000

操作，

在这种情况下，我建议`visibility:hidden`over `display:none;`。这是这种方法的一个小提琴：http: [//jsfiddle.net/wEr3T/1/](http://jsfiddle.net/wEr3T/1/)。

简而言之，`visibility:hidden`实际上**只是**隐藏元素——仍然占用它之前所做的空间，因此不会影响布局。

相反，`display:none;`导致它不被渲染，因此它以前占用的空间现在下落不明。因此，悬停以显示/隐藏已设置为的元素`display:none`可能会导致一些不希望的闪烁。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-14T21:32:09.910

`#flip-container`通过设置在悬停时隐藏文本和图像`display: none`可能会导致闪烁和更改父容器的布局。所以改为通过 set 使它们透明`visibility: hidden`。

```
.flip-container:hover img {
visibility:hidden
}
.flip-container:hover .text {
visibility:hidden
} 
```

我为你创建了[jsFiddle](http://jsfiddle.net/akrambe/ASxV5/)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-11-29T18:00:00.800

> 试试这个...

```
.flip-container:hover .text, .flip-container:hover img {
    visibility: hidden;
}
```

```
 <div class="flip-container">
        <div class="flipper">
            <a href="#" data-reveal-id="pc1">
                <div class="inner" style="background-color:yellow;">
                    <p class="text" style="color:red">title</p>
                    <img src="//placehold.it/100x100" class="img" />
                </div>
            </a>
        </div>
   </div>
```

# php - symfony2 使用 3 个参数（用户名、密码和公司）登录

> ID：15420328
> 
> 赞同：0
> 
> 时间：2013-03-14T21:13:57.313
> 
> 标签：php, symfony

这一天我一直让自己头疼，

过去几天我一直在学习 Symfony，我的问题很简单，我需要能够使用 3 个参数（用户名、密码和公司）登录

此处提出了相同的问题，但提问者从未提供解决方案： [使用第三个参数的自定义登录](https://stackoverflow.com/questions/9652290/custom-login-using-a-third-parameter)

我尝试通过实现令牌、侦听器、提供程序和工厂来克隆 Symfony 的内置登录，但是每当我将密钥插入 security.yml 并尝试登录时，它都会将我带到 /login（找不到“GET /login”的路由")

有人愿意让我开心吗？

编辑：

好的，我又试了一次，现在我有这个错误： Catchable Fatal Error: "Argument 1 passed to Test\SampleBundle\Security\Authentication\Provider\MyProvider::__construct() must be an instance of Symfony\Component\Security\Core \User\UserCheckerInterface，Symfony\Bridge\Doctrine\Security\User\EntityUserProvider 的实例给定”

同样，我要做的就是复制 Symfonys 当前用户/密码登录功能

MyToken.php：

```
namespace Test\SampleBundle\Security\Authentication\Token;

use Symfony\Component\Security\Core\Authentication\Token\AbstractToken;

class MyToken extends AbstractToken
{
private $credentials;
private $providerKey;

public function __construct($user, $credentials, $providerKey, array $roles = array())
{
    parent::__construct($roles);

    if (empty($providerKey)) {
        throw new \InvalidArgumentException('$providerKey must not be empty.');
    }

    $this->setUser($user);
    $this->credentials = $credentials;
    $this->providerKey = $providerKey;

    parent::setAuthenticated(count($roles) > 0);
}

public function setAuthenticated($isAuthenticated)
{
    if ($isAuthenticated) {
        throw new \LogicException('Cannot set this token to trusted after instantiation.');
    }

    parent::setAuthenticated(false);
}

public function getCredentials()
{
    return $this->credentials;
}

public function getProviderKey()
{
    return $this->providerKey;
}

public function eraseCredentials()
{
    parent::eraseCredentials();

    $this->credentials = null;
}

public function serialize()
{
    return serialize(array($this->credentials, $this->providerKey, parent::serialize()));
}

public function unserialize($serialized)
{
    list($this->credentials, $this->providerKey, $parentStr) = unserialize($serialized);
    parent::unserialize($parentStr);
}
} 
```

MyListener.php：

```
<?php

namespace Test\SampleBundle\Security\Firewall;

use Symfony\Component\Security\Http\Firewall\AbstractAuthenticationListener;
use Symfony\Component\Form\Extension\Csrf\CsrfProvider\CsrfProviderInterface;
use Symfony\Component\HttpFoundation\Request;
use Psr\Log\LoggerInterface;
use Symfony\Component\Security\Http\Authentication\AuthenticationFailureHandlerInterface;
use Symfony\Component\Security\Http\Authentication\AuthenticationSuccessHandlerInterface;
use Symfony\Component\Security\Http\Session\SessionAuthenticationStrategyInterface;
use Symfony\Component\Security\Http\HttpUtils;
use Symfony\Component\Security\Core\Authentication\AuthenticationManagerInterface;
use Test\SampleBundle\Security\Authentication\Token\MyToken;
use Symfony\Component\Security\Core\Exception\InvalidCsrfTokenException;
use Symfony\Component\Security\Core\SecurityContextInterface;
use Symfony\Component\EventDispatcher\EventDispatcherInterface;

class MyListener extends AbstractAuthenticationListener
{
private $csrfProvider;

public function __construct(SecurityContextInterface $securityContext, AuthenticationManagerInterface $authenticationManager, SessionAuthenticationStrategyInterface $sessionStrategy, HttpUtils $httpUtils, $providerKey, AuthenticationSuccessHandlerInterface $successHandler, AuthenticationFailureHandlerInterface $failureHandler, array $options = array(), LoggerInterface $logger = null, EventDispatcherInterface $dispatcher = null, CsrfProviderInterface $csrfProvider = null)
{
    parent::__construct($securityContext, $authenticationManager, $sessionStrategy, $httpUtils, $providerKey, $successHandler, $failureHandler, array_merge(array(
        'username_parameter' => '_username' . 'b',
        'password_parameter' => '_password',
        'csrf_parameter'     => '_csrf_token',
        'intention'          => 'authenticate',
        'post_only'          => true,
    ), $options), $logger, $dispatcher);

    $this->csrfProvider = $csrfProvider;
}

protected function requiresAuthentication(Request $request)
{
    if ($this->options['post_only'] && !$request->isMethod('POST')) {
        return false;
    }

    return parent::requiresAuthentication($request);
}

protected function attemptAuthentication(Request $request)
{
    if (null !== $this->csrfProvider) {
        $csrfToken = $request->get($this->options['csrf_parameter'], null, true);

        if (false === $this->csrfProvider->isCsrfTokenValid($this->options['intention'], $csrfToken)) {
            throw new InvalidCsrfTokenException('Invalid CSRF token.');
        }
    }

    if ($this->options['post_only']) {
        $username = trim($request->request->get($this->options['username_parameter'], null, true));
        $password = $request->request->get($this->options['password_parameter'], null, true);
    } else {
        $username = trim($request->get($this->options['username_parameter'], null, true));
        $password = $request->get($this->options['password_parameter'], null, true);
    }

    $request->getSession()->set(SecurityContextInterface::LAST_USERNAME, $username);

    return $this->authenticationManager->authenticate(new MyToken($username, $password, $this->providerKey));
}
} 
```

MyProivder.php：

```
namespace Test\SampleBundle\Security\Authentication\Provider;

use Symfony\Component\Security\Core\User\UserInterface;
use Symfony\Component\Security\Core\User\UserCheckerInterface;
use Symfony\Component\Security\Core\Exception\UsernameNotFoundException;
use Symfony\Component\Security\Core\Exception\AuthenticationException;
use Symfony\Component\Security\Core\Exception\BadCredentialsException;
use Symfony\Component\Security\Core\Exception\AuthenticationServiceException;
use Symfony\Component\Security\Core\Authentication\Token\TokenInterface;
use Test\SampleBundle\Security\Authentication\Token\MyToken;
use Symfony\Component\Security\Core\Authentication\Provider\AuthenticationProviderInterface;

class MyProvider implements AuthenticationProviderInterface
{
private $hideUserNotFoundExceptions;
private $userChecker;
private $providerKey;

    public function __construct(UserCheckerInterface $userChecker, $providerKey, $hideUserNotFoundExceptions = true)
{
    if (empty($providerKey)) {
        throw new \InvalidArgumentException('$providerKey must not be empty.');
    }

    $this->userChecker = $userChecker;
    $this->providerKey = $providerKey;
    $this->hideUserNotFoundExceptions = $hideUserNotFoundExceptions;
}

 public function authenticate(TokenInterface $token)
{
    if (!$this->supports($token)) {
        return null;
    }

    $username = $token->getUsername();
    if (empty($username)) {
        $username = 'NONE_PROVIDED';
    }

    try {
        $user = $this->retrieveUser($username, $token);
    } catch (UsernameNotFoundException $notFound) {
        if ($this->hideUserNotFoundExceptions) {
            throw new BadCredentialsException('Bad credentials', 0, $notFound);
        }
        $notFound->setUsername($username);

        throw $notFound;
    }

    if (!$user instanceof UserInterface) {
        throw new AuthenticationServiceException('retrieveUser() must return a UserInterface.');
    }

    try {
        $this->userChecker->checkPreAuth($user);
        $this->checkAuthentication($user, $token);
        $this->userChecker->checkPostAuth($user);
    } catch (BadCredentialsException $e) {
        if ($this->hideUserNotFoundExceptions) {
            throw new BadCredentialsException('Bad credentials', 0, $e);
        }

        throw $e;
    }

    $authenticatedToken = new MyToken($user, $token->getCredentials(), $this->providerKey, $user->getRoles());
    $authenticatedToken->setAttributes($token->getAttributes());

    return $authenticatedToken;
}

    public function supports(TokenInterface $token)
{
    return $token instanceof MyToken && $this->providerKey === $token->getProviderKey();
}

/**
 * {@inheritdoc}
 */
protected function checkAuthentication(UserInterface $user, MyToken $token)
{
    $currentUser = $token->getUser();
    if ($currentUser instanceof UserInterface) {
        if ($currentUser->getPassword() !== $user->getPassword()) {
            throw new BadCredentialsException('The credentials were changed from another session.');
        }
    } else {
        if ("" === ($presentedPassword = $token->getCredentials())) {
            throw new BadCredentialsException('The presented password cannot be empty.');
        }

        if (!$this->encoderFactory->getEncoder($user)->isPasswordValid($user->getPassword(), $presentedPassword, $user->getSalt())) {
            throw new BadCredentialsException('The presented password is invalid.');
        }
    }
}

/**
 * {@inheritdoc}
 */
protected function retrieveUser($username, MyToken $token)
{
    $user = $token->getUser();
    if ($user instanceof UserInterface) {
        return $user;
    }

    try {
        $user = $this->userProvider->loadUserByUsername($username);

        if (!$user instanceof UserInterface) {
            throw new AuthenticationServiceException('The user provider must return a UserInterface object.');
        }

        return $user;
    } catch (UsernameNotFoundException $notFound) {
        $notFound->setUsername($username);
        throw $notFound;
    } catch (\Exception $repositoryProblem) {
        $ex = new AuthenticationServiceException($repositoryProblem->getMessage(), 0, $repositoryProblem);
        $ex->setToken($token);
        throw $ex;
    }
}
} 
```

我的工厂.php

```
<?php

namespace Test\SampleBundle\DependencyInjection\Security\Factory;
use Symfony\Component\Config\Definition\Builder\NodeDefinition;
use Symfony\Component\DependencyInjection\DefinitionDecorator;
use Symfony\Component\DependencyInjection\ContainerBuilder;
use Symfony\Component\DependencyInjection\Reference;
use Symfony\Bundle\SecurityBundle\DependencyInjection\Security\Factory\SecurityFactoryInterface;

class MyFactory implements SecurityFactoryInterface
{

public function __construct()
{
    $this->addOption('username_parameter', '_username');
    $this->addOption('password_parameter', '_password');
    $this->addOption('csrf_parameter', '_csrf_token');
    $this->addOption('intention', 'authenticate');
    $this->addOption('post_only', true);
}

  public function getPosition()
{
    return 'pre_auth';
}
  public function getKey()
{
    return 'mylogin';
}

public function create(ContainerBuilder $container, $id, $config, $userProvider, $defaultEntryPoint)
{
    $providerId = 'security.authentication.provider.mylogin.'.$id;
    $container
        ->setDefinition($providerId, new DefinitionDecorator('mylogin.security.authentication.provider'))
        ->replaceArgument(0, new Reference($userProvider))
    ;

    $listenerId = 'security.authentication.listener.mylogin.'.$id;
    $listener = $container->setDefinition($listenerId, new DefinitionDecorator('mylogin.security.authentication.listener'));

    return array($providerId, $listenerId, $defaultEntryPoint);
}

   public function addConfiguration(NodeDefinition $node)
{
}

protected function createEntryPoint($container, $id, $config, $defaultEntryPoint)
{
    $entryPointId = 'security.authentication.form_entry_point.'.$id;
    $container
        ->setDefinition($entryPointId, new DefinitionDecorator('security.authentication.form_entry_point'))
        ->addArgument(new Reference('security.http_utils'))
        ->addArgument($config['login_path'])
        ->addArgument($config['use_forward'])
    ;

    return $entryPointId;
}
    final public function addOption($name, $default = null)
{
    $this->options[$name] = $default;
}
} 
```

服务.yml：

```
services:

mylogin.security.authentication.provider:
class:  Test\SampleBundle\Security\Authentication\Provider\MyProvider
arguments: ['', %kernel.cache_dir%/security/nonces]

mylogin.security.authentication.listener:
class:  Test\SampleBundle\Security\Firewall\MyListener
arguments: [@security.context, @security.authentication.manager] 
```

最后是注射器：

```
namespace Test\SampleBundle;

use Test\SampleBundle\DependencyInjection\Security\Factory\MyFactory;
use Symfony\Component\HttpKernel\Bundle\Bundle;
use Symfony\Component\DependencyInjection\ContainerBuilder;

class TestSampleBundle extends Bundle
{
public function build(ContainerBuilder $container)
{
    parent::build($container);

    $extension = $container->getExtension('security');
    $extension->addSecurityListenerFactory(new MyFactory());
}
} 
```

上面的代码中可能有一些错误，因为我一直在玩弄一些东西来让它工作

# ios - 当应用程序状态从后台返回时，Apple-mobile-web-app 使用 Web Audio API 系统无响应

> ID：15420332
> 
> 赞同：1
> 
> 时间：2013-03-14T21:14:15.897
> 
> 标签：ios, html, web-audio-api, web-clips

我使用 Web Audio API 开发了一个简单的 HTML 5 Web 应用程序。该页面保存为 Web Clip，并添加了支持 apple-mobile-web-app-capable 的元标记以启用全屏。在 Safari 中一切正常，声音按预期播放。但是，如果按下 Home 按钮并将应用程序发送到后台状态然后恢复，则 Home 按钮将变得无响应，解决此问题的唯一方法是进行硬重置。

这是我的代码：

```
<head>
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <script>
        var context;
        var buffer;

        function init() {
            if ('webkitAudioContext' in window) {
                context = new webkitAudioContext();
                var request = new XMLHttpRequest();
                request.open('GET', 'sounds/sound.mp3', true);
                request.responseType = 'arraybuffer';
                request.addEventListener('load', function () {
                    var request = event.target;
                    buffer = context.createBuffer(request.response, false);
                }, false);
                request.send();
            }
        }

        function play() {
            var source = context.createBufferSource();
            source.buffer = buffer;
            source.connect(context.destination);
            source.start(0);
        }
    </script>
</head>

<body onload="init()">
    <button onclick="play()">Play</button>
</body> 
```

# python - 在 Maya 中使用 GUI 和 Pymel/Python 时出现运行时错误

> ID：15420343
> 
> 赞同：1
> 
> 时间：2013-03-14T21:14:46.870
> 
> 标签：python, maya

所以我正在尝试制作一个 GUI，允许用户将任何指定的 polyShapes（用复选框选择）构建到他们需要的任何属性（在滑块中设置）。此外，当每个复选框被选中时，它会取消选择其他框并将用户不需要的某些属性变灰。

我正在努力使用定义每个复选框被选中时会发生什么的功能。选择复选框后，按下属性和创建按钮，该过程正常工作（我希望结果），但我会收到以下错误，除了最后一个复选框外，所有其他复选框：

```
RuntimeError: Object 'window1|formLayout46|checkBox3' not found. # 
```

我被告知这是一个错误，因为函数运行在旧/以前版本的窗口中，并且将滑块等作为参数传递给函数将修复错误。但是，这并不能解决问题，当然我不能在创建复选框之前将它们作为参数传递，如下面的代码所示。它也没有解释为什么最后一个复选框（checkBoxCylinder）工作得很好——我假设这工作得很好，因为在它之前一切都已经完成了。

任何关于此事的建议/解释都将不胜感激，因为我现在觉得我在绕圈子。为下面的长代码道歉，我不能使用摘录，因为它们都链接在一起！！

```
import pymel.core as pm

class MakeLightDome(object):

def __init__(self):
    sel = []

def checkSelection(self):
    sel = pm.ls(selection = True)
    length = len(sel)

#Check Selection    
    if length == 0:
        print "Please create a PolySphere."

        def show():
            global win
            try:
                win.delete()
            except:
                pass
            win = pm.window(title = "Dome Generator")

            mainLayout = pm.verticalLayout()
            mainLayout.setHeight(400)

            def buttonPressed(*args):
                #Create Sphere
                if checkBoxSphere.getValue():
                    radiusSet = rSlider.getValue()
                    xSubDivs = xSubDSlider.getValue()
                    ySubDivs = ySubDSlider.getValue()
                    pm.polySphere(r = radiusSet, sx = xSubDivs, sy = ySubDivs)
                #Move on to create lights        
                    win.delete()

                if checkBoxCube.getValue():
                #CreateCube
                    xDime = xSlider.getValue()
                    yDime = ySlider.getValue()
                    zDime = zSlider.getValue()
                    xSubDivs = xSubDSlider.getValue()
                    ySubDivs = ySubDSlider.getValue()
                    zSubDivs = zSubDSlider.getValue()
                    pm.polyCube(w = xDime, h = yDime, d = zDime, sx = xSubDivs, sy = ySubDivs, sz = zSubDivs)
                #Move on to create lights        
                    win.delete()

                if checkBoxCone.getValue():
                #Create Cone
                    yDime = ySlider.getValue()
                    radiusSet = rSlider.getValue()
                    xSubDivs = xSubDSlider.getValue()
                    ySubDivs = ySubDSlider.getValue()
                    zSubDivs = zSubDSlider.getValue()
                    pm.polyCone(h = yDime, r = radiusSet, sx = xSubDivs, sy = ySubDivs, sz = zSubDivs)
                #Move on to create lights        

                    win.delete()

                if checkBoxCylinder.getValue():
                #Create Cylinder 
                    yDime = ySlider.getValue()
                    radiusSet = rSlider.getValue()
                    xSubDivs = xSubDSlider.getValue()
                    ySubDivs = ySubDSlider.getValue()
                    zSubDivs = zSubDSlider.getValue()
                    pm.polyCylinder(h = yDime, r = radiusSet, sx = xSubDivs, sy = ySubDivs, sz = zSubDivs)
                #Move on to create lights        
                    win.delete()

            def sphereBoxChecked(*args):
                xSlider = args[0]
                ySlider = args[1]
                zSlider = args[2]
                rSlider = args[3]
                xSubDSlider = args[4]
                ySubDSlider = args[5]
                zSubDSlider = args[6]
                checkBoxCube = args[7]
                checkBoxCone = args[8]
                checkBoxCylinder = args[9]
            #Checkbox off
                checkBoxCube.setValue(False)
                checkBoxCone.setValue(False)
                checkBoxCylinder.setValue(False)
             #Slider enable
                xSlider.setValue(en = False)
                ySlider.setValue(en = False)
                zSlider.setValue(en = False)
                rSlider.setValue(5, en = True)
                xSubDSlider.setValue(10, en = True)
                ySubDSlider.setValue(10, en = True)
                zSubDSlider.setValue(en = False)

            def cubeBoxChecked(*args):
                xSlider = args[0]
                ySlider = args[1]
                zSlider = args[2]
                rSlider = args[3]
                xSubDSlider = args[4]
                ySubDSlider = args[5]
                zSubDSlider = args[6]
                checkBoxSphere = args[7]
                checkBoxCone = args[8]
                checkBoxCylinder = args[9]
            #Checkbox off
                checkBoxSphere.setValue(False)
                checkBoxCone.setValue(False)
                checkBoxCylinder.setValue(False)
            #Slider enable
                xSlider.setValue(10, en = True)
                ySlider.setValue(10, en = True)
                zSlider.setValue(10, en = True)
                rSlider.setValue(en = False)
                xSubDSlider.setValue(5, en = True)
                ySubDSlider.setValue(5, en = True)
                zSubDSlider.setValue(5, en = True)

            def coneBoxChecked(*args):
                xSlider = args[0]
                ySlider = args[1]
                zSlider = args[2]
                rSlider = args[3]
                xSubDSlider = args[4]
                ySubDSlider = args[5]
                zSubDSlider = args[6]
                checkBoxSphere = args[7]
                checkBoxCube = args[8]
                checkBoxCylinder = args[9]
            #Checkbox off
                checkBoxSphere.setValue(False)
                checkBoxCube.setValue(False)
                checkBoxCylinder.setValue(False)
            #Slider enable
                xSlider.setValue(en = False)
                ySlider.setValue(10, en = True)
                zSlider.setValue(en = False)
                rSlider.setValue(5, en = True)
                xSubDSlider.setValue(15, en = True)
                ySubDSlider.setValue(10, en = True)
                zSubDSlider.setValue(5, en = True)

            def cylinderBoxChecked(*args):
            #Checkbox off
                checkBoxSphere.setValue(False)
                checkBoxCube.setValue(False)
                checkBoxCone.setValue(False)
            #Slider enable
                xSlider.setValue(en = False)
                ySlider.setValue(15, en = True)
                zSlider.setValue(en = False)
                rSlider.setValue(5, en = True)
                xSubDSlider.setValue(15, en = True)
                ySubDSlider.setValue(5, en = True)
                zSubDSlider.setValue(5, en = True)

        #Slider settings
            #Dimensions
            xSlider = pm.floatSliderGrp(label = "x Dimension", field = True, parent = mainLayout, en = False)
            xSlider.setValue(10)
            ySlider = pm.floatSliderGrp(label = "y Dimension", field = True, parent = mainLayout, en = False)
            ySlider.setValue(10)
            zSlider = pm.floatSliderGrp(label = "z Dimension", field = True, parent = mainLayout, en = False)
            zSlider.setValue(10)
            rSlider = pm.floatSliderGrp(label = "Radius", field = True, parent = mainLayout, en = False)
            rSlider.setValue(10)
            #SubDivisions
            xSubDSlider = pm.intSliderGrp(label = "x SubDivs",field = True, parent = mainLayout, en = False)
            xSubDSlider.setValue(10)
            ySubDSlider = pm.intSliderGrp(label = "y SubDivs", field = True, parent = mainLayout, en = False)
            ySubDSlider.setValue(10)
            zSubDSlider = pm.intSliderGrp(label = "z SubDivs", field = True, parent = mainLayout, en = False)
            zSubDSlider.setValue(10)

        #Check Box Settings
            checkBoxSphere = pm.checkBox(label = "Sphere", value = False, parent = mainLayout, onc = pm.Callback(sphereBoxChecked, xSlider, ySlider, zSlider, rSlider, xSubDSlider, ySubDSlider, zSubDSlider, checkBoxCube, checkBoxCone, checkBoxCylinder))
            checkBoxCube = pm.checkBox(label = "Cube", value = False, parent = mainLayout, onc = pm.Callback(cubeBoxChecked, xSlider, ySlider, zSlider, rSlider, xSubDSlider, ySubDSlider, zSubDSlider, checkBoxSphere, checkBoxCone, checkBoxCylinder))
            checkBoxCone = pm.checkBox(label = "Cone", value = False, parent = mainLayout, onc = pm.Callback(coneBoxChecked, xSlider, ySlider, zSlider, rSlider, xSubDSlider, ySubDSlider, zSubDSlider, checkBoxSphere, checkBoxCube, checkBoxCylinder))
            checkBoxCylinder = pm.checkBox(label = "Cylinder", value = False, parent = mainLayout, onc = pm.Callback(cylinderBoxChecked))

            btn = pm.button(label = "Create", parent = mainLayout, command = pm.Callback(buttonPressed))
            mainLayout.redistribute()

            win.show()
        show()
dome = MakeLightDome()
dome.checkSelection() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-03-12T20:09:20.740

您可能不想为此使用全局，这会使您的状态管理复杂化。执行此操作的通常“正确”方法（故意使用引号）是将 GUI 包装在一个类中并将所有状态存储在该类中，因此很容易知道所有这些都将相同的状态数据连接到相同的小部件。除了使代码更整洁之外，它还可以打开同一个对话框的多个副本（例如，如果您需要那种东西，每个对象一个）。

这是一个非常简单的例子。由于所有小部件（至少是您关心的所有小部件）都包含在对话框的“自我”中，因此在响应按钮单击时获取所需信息很简单

```
import pymel.core as pm

class SliderDialog(object):

     def __init__(self):
        self.SomeSpecialData = "Hello world"
        self.Window = pm.window(width = 300)
        with pm.columnLayout():
           self.XSlider = pm.floatSliderGrp(label  = 'x', field = True)
           self.YSlider = pm.floatSliderGrp(label  = 'y', field = True)
           self.ZSlider = pm.floatSliderGrp(label  = 'z', field = True)
           with pm.rowLayout(nc= 2):
               self.Cancel = pm.button("cancel", width = 150, command = self.cancel_button)
               self.Go = pm.button("go", width = 150, c=self.go_button)
     def show(self):
         self.Window.show()

     def go_button(self, *_):
         # your actual work goes here
         print "Special Data = ", self.SomeSpecialData 
         x, y, z = self.XSlider.getValue(), self.YSlider.getValue(),  self.ZSlider.getValue()          

         print "do something with XYZ (%i, %i, %i)" % (x, y, z)

     def cancel_button(self, *_):
         print "cancelling"
         pm.deleteUI(self.Window)

SliderDialog().show() 
```

[这是有关将 python 函数挂钩到 Maya GUI 回调的详细参考。](http://theodox.com/2014/maya_callbacks_cheat_sheet)

# .htaccess - htaccess 重写以更改 gif url

> ID：15420344
> 
> 赞同：0
> 
> 时间：2013-03-14T21:14:48.310
> 
> 标签：.htaccess

我希望你能帮忙。我正在尝试进行 htaccess 重写更改

文件.gif 到图像/文件.gif

我翻遍了这个网站，但找不到。任何帮助将非常感激。

谢谢马克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T21:48:06.753

通过启用 mod_rewrite 和 .htaccess `httpd.conf`，然后将此代码放在您`.htaccess`的`DOCUMENT_ROOT`目录下：

```
Options +FollowSymLinks -MultiViews
# Turn mod_rewrite on
RewriteEngine On
RewriteBase /

RewriteRule (?!^images/)^([^.]+\.gif)$ /images/$1 [L,NC] 
```

# php - 你在哪里放置 the_content(); 在 wordpress 中启用主页上的 Youtube 视频？

> ID：15420360
> 
> 赞同：0
> 
> 时间：2013-03-14T21:15:53.447
> 
> 标签：php, html, wordpress

如果你访问[这个网站](http://vecnamusic.com)，你会发现它只是帖子，登陆的是 YouTube 视频。但是，我希望 YouTube 视频出现在主页上，我之前在使用 WordPress 时遇到过这个问题。我会进去`the_excerpt();`换成`the_content();`。但是，这些页面不需要`the_excerpt();`，所以我认为我需要添加`the_content();`到特定页面和编码中的位置。有熟悉的地方可以打电话`the_content()`吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T22:10:29.400

`the_content();`必须从[循环](http://codex.wordpress.org/The_Loop)内部调用。否则，没有要求将其放置在页面上。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-14T21:27:05.840

我真的不知道你在找什么，因为你的问题对我来说似乎很困惑，但是你可以在你的主题中添加一个 front-page.php 文件，这将使你能够专门为你的主页定制你的布局.

# c# - 我应该在子视图模型中存储对父视图模型的引用吗？

> ID：15420362
> 
> 赞同：7
> 
> 时间：2013-03-14T21:16:00.240
> 
> 标签：c#, .net, wpf, mvvm

因此，如果我将父 ViewModel 的引用存储在子 ViewModel 中，那会是犯罪吗？我会违反 MVVM 规则吗？我的子视图是一个带有上下文菜单的窗口。When the appropriate menu item is selected a new child view needs to be created. 父级仅负责创建子视图。所以保持对父视图模型的引用对我有很多好处。同时我不想打破模式规则。

```
class MainViewModel
{
    List<ChildViewModel> _childrenViewModels = new List<ChildViewModel>();

    public AddChild(ChildViewModel childViewModel)
    {
        _childrenViewModels.Add(childViewModel);
        childViewModel.Owner = this;
    }
}

class ChildViewModel
{
    private Child _child;
    public MainViewModel Owner { get; set; }

    public ChildViewModel(Child child)
    {
        _child = child;
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-14T23:11:01.273

不。一般来说，如果您多次使用这种技术，尝试将其隐藏在抽象之后，实际上这就是著名的[Caliburn.Micro](http://caliburnmicro.codeplex.com) [我喜欢它] 项目使用其[IChild 接口](http://caliburnmicro.codeplex.com/wikipage?title=Screens,%20Conductors%20and%20Composition&referringTitle=Documentation)所做的事情。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-14T21:42:45.940

答案是否定的，但出于您的目的，如果父级所做的只是创建子视图模型，为什么还需要此参考。建立这种联系的目的是什么？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-03-02T01:28:40.737

虽然这种模式根本不是犯罪或“代码异味”，但在许多情况下，以接口实现者的形式而不是作为其自己的类传递对父级的引用可能会更好。因此，接口中只定义了子类需要在父类中访问的属性或方法，而子类没有访问父类的其他公共方法或属性的权限，如果使用不当可能会导致错误。这可能涉及更多代码，但类之间更松散的连接可能会带来好处。如果仅此而已，它有助于使孩子和父母之间的联系更加自我记录，并且让阅读代码的人更容易理解。

# c# - .ascx.cs 文件是如何存储在 .ascx 的文本框中输入的数据的

> ID：15420364
> 
> 赞同：0
> 
> 时间：2013-03-14T21:16:09.183
> 
> 标签：c#, .net, sharepoint

我是.Net 开发的新手，所以我事先为这样的愚蠢问题道歉。

我正在尝试理解和学习 .Net 开发，所以我正在查看这个在 .ascx 文件中有文本框的项目，我相信它背后的代码应该将在这些文本框中输入的数据保存到数据库中。但我不明白这些数据是如何存储或去哪里的。基本上文件后面的代码看起来像这样，

```
public partial class registration : System.Web.UI.UserControl
    {
        protected global::System.Web.UI.WebControls.Label lblDisclosure;

        private ResourceManager rm = null;

        protected void Page_Load(object sender, EventArgs e)
        {
           lblFirstName.Text = rm.GetString("FirstName");
        }                            
    } 
```

有人可以帮我吗？或者给我一些资源来继续阅读。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T21:30:00.223

通常可以在 Web.config 中找到与数据库的连接设置。

在这样的 ASP.Net WebForms 项目中，捕获已保存数据的代码可能位于此 .ascx 恰好使用的页面的 .aspx.cs 代码隐藏中。此代码的外观因它们的方式而异重新与数据库交谈——他们可能使用普通 SQL、LINQ to SQL、实体框架、NHibernate，他们自己创造的东西，谁知道呢——但我敢打赌，无论哪种方式，它都是从代码隐藏开始的。

通常像这样的数据只是以普通表单提交的形式发回，所以通常会看到类似

```
if (IsPostBack.... 
```

在代码隐藏中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-14T21:33:07.037

本教程提供了一个您尝试完成的示例：[Working with Databases in ASP.NET 2.0 and Visual Studio 2005](http://www.4guysfromrolla.com/articles/110905-1.aspx)

虽然很老了，但它讲了如何通过 a 建立数据库连接`SqlDataSource`，以及如何将其绑定到`SELECT`、`UPDATE`和`DELETE`语句。然后，介绍了如何通过控件绑定将页面中的数据获取到数据库中。

话虽如此，我还是建议学习 ASP.NET MVC。您将获得利用 .NET 框架的相同功能，而无需学习 ASP.NET 页面生命周期，这并非易事。

# c# - 提供对超大 (50GB+) ASCII 文件的随机读取访问

> ID：15420369
> 
> 赞同：1
> 
> 时间：2013-03-14T21:16:27.137
> 
> 标签：c#, io, bigdata, memory-mapped-files

我的任务是以 C# 控制台应用程序的形式提供对非常大 (50GB+) ASCII 文本文件（处理第 n 行/第 n 行中的第 n 个单词的请求）的随机读取访问。

经过几天的谷歌搜索和阅读，我得出了这样的实现愿景：由于**StreamReader**擅长顺序访问，因此使用它来建立文件中行/单词的索引（`List<List<long>>`map，`map[i][j]`第 i 个单词的位置在哪里行开始）。然后使用索引通过[**MemoryMappedFile**](http://msdn.microsoft.com/en-us/library/dd997372.aspx)访问文件，因为它擅长提供随机访问。

解决方案中是否存在一些明显的缺陷？对于给定的任务，它是否是最佳的？

**UPD**：它将在 64 位系统上执行。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-14T21:20:38.777

看起来不错，但是如果您使用 MemoryMapping，那么您的程序将只能在 64 位系统上运行，因为您超出了可用的 2GB 有效地址空间。

只需使用 a`FileStream`和调用`.Seek()`来适当地跳转到选定的偏移量就可以了，所以我认为不需要使用 MemoryMapped 文件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-14T21:22:32.790

我相信您的解决方案是一个好的开始 - 即使您的 List 容器不是最好的 Map 容器 - 列表读取任意元素的速度非常慢。

我会测试`List<List<long>>`在内存/速度权衡方面是否做映射是最好的 - 因为操作系统在页面边界缓存内存映射（x86/x64 上为 4096 字节），实际上只查找每个开始的地址可能会更快行，然后扫描该行寻找单词。

显然，这种方法仅适用于 64 位操作系统，但 MMap 的性能优势非常显着 - 这是使用 64 位非常重要的少数几个地方之一 - 数据库应用程序 :)

# java - 对集合中的对象进行排序

> ID：15420373
> 
> 赞同：-2
> 
> 时间：2013-03-14T21:16:33.740
> 
> 标签：java, collections, compare

假设我有一个 Employee 类

```
Employee {
    int id;
    String name;
    Date DOB;
} 
```

我创建了 100 个对象并将它们放入 Set 中，但希望它们今天按 DOB 排序，其他一天按 name 排序，其他一天按 id 排序。我可以创建三个比较器，但不确定我应该在哪里传递这些比较器，因为 Collections.sort 将 List 作为第一个参数。
**TreeSet（接受 Comparator 作为构造函数）是唯一的解决方案吗？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T21:23:20.130

`Set`s 没有订单。它们就像数学集。

如果你想要一个订单，你需要一个`List`，例如。然后你可以对它们进行排序，或者给它们你想要的任何顺序。

`List`您应该从中创建一个`Set`，然后应用`Comparator`您想要的。如果您想对它们重新排序，只需`sort()`再次申请，使用不同的`Comparator`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-14T21:18:39.323

`TreeSet`是一个总是根据一些比较器排序的集合。所以你可以有三个不同的集合，每个集合都有自己的比较器。

# ember.js - Ember js 单例模型实现

> ID：15420377
> 
> 赞同：0
> 
> 时间：2013-03-14T21:16:37.933
> 
> 标签：ember.js

当用户更改 URL 参数（哈希）时 - 创建新模型并同时呈现多个视图（每个视图用于不同的模型实例）。
制作模型单例的最佳方法是什么？这是我的代码：

```
Exam.TestModel = null;

Exam.TestRoute = Ember.Route.extend({

model: function(params) {

    // trying to remove old model
    if ( Exam.TestModel ) {
        Exam.TestModel.destroy();
        Exam.TestModel = null;
    }

    console.log(Exam.TestModel);
    Exam.TestModel = Exam.Test.create(params);

    return  Exam.TestModel;
}
});
Exam.Test = Ember.Object.extend({

init: function() {
    this._super();

    if ( this._validate() ) {
     this._loadQuestionNumbers();
    }
},
//... 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T23:46:54.937

无需重新创建模型，只需更新属性即可：

```
Exam.TestModel = null;

Exam.TestRoute = Ember.Route.extend({

// NOTE  autogenerated
//    setupController: function(controller, test) {
//        controller.set('content', test);
//    },
model: function(params) {

    if ( Exam.TestModel != null ) {
        Exam.TestModel.setProperties(params);
    } else {
        Exam.TestModel = Exam.Test.create(params);
    }

    return  Exam.TestModel;
}
}); 
```

# jquery - 从 Fancybox 播放 Youtube 视频 onClosed 事件

> ID：15420381
> 
> 赞同：0
> 
> 时间：2013-03-14T21:16:42.210
> 
> 标签：jquery, youtube, fancybox

我们需要帮助找出要生成的代码来执行以下操作：

1.  该网站的主页上有一个 jquery 滑块，第一张幻灯片上有一个 Youtube 视频。但是视频不会自动播放，我们希望它仅在 Fancybox 弹出关闭被触发时播放。
2.  Fancybox v2x 首先会自动显示在同一页面上。这个 Fancybox 将有一个链接到外部 URL 的图像
3.  如果我们关闭 Fancybox 窗口，我们希望 Youtube 视频（来自 jquery 滑块）自动播放。

我们还没有生成代码，但是因为通常情况相反（让视频在 Fancybox 上播放，而不是让 Fancybox 从另一个 div 触发 Youtube 自动播放，这变得很复杂。

您的帮助将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T21:45:48.737

尚未对此进行测试，但您可以在 Fancybox 关闭时声明回调

```
$('#fancybox').fancybox({
    //options,
    'onClose': playYoutubeVideo()
});

function playYoutubeVideo() {
    //code to play video
    //depends if it's html5 or flash
} 
```

# ios - 使用 Objective C 在运行时获取属性名称

> ID：15420388
> 
> 赞同：0
> 
> 时间：2013-03-14T21:17:11.727
> 
> 标签：ios, memory-management, objective-c-runtime

随着 MBaas 服务变得非常实惠且易于使用，我想知道是否有人可以就以下设计选择给我一个建议？

上下文：发送 NSDictionary 的内容以进行远程存储。所以这个想法是动态地建立一个键/值关系。

如何：使用[此处](https://stackoverflow.com/a/6616013/1772468)的代码，可以检索实例变量的名称。因此，键/值关系来自[{ivar_name =“我对此ivar感兴趣的值”}等......]

我理解所提议代码的局限性，但我认为它们的好处超过了它们。

就我而言，字典不会超出类的生命周期，所以当视图从堆栈中删除时，我不应该在 ivars 上保留强引用。此外，它将是取自 TextFields 的 NSString。

但是，有一个问题我无法真正回答：如果我正在查看的 ivars 是可重用 UITableViewCells 的一部分（例如：UItableviewCell 中的 IBOutlet textField），我应该复制 textField.text 还是可以保留textField.text 指向的字符串的引用？或者没关系？

谢谢 ！

# twitter-bootstrap - 简单的 twitter 引导示例未按预期显示

> ID：15420391
> 
> 赞同：2
> 
> 时间：2013-03-14T21:17:19.263
> 
> 标签：twitter-bootstrap

我在此页面中粘贴了示例“流体嵌套”：http: [//twitter.github.com/bootstrap/scaffolding.html](http://twitter.github.com/bootstrap/scaffolding.html)

```
 <!DOCTYPE html>
    <html>
        <head>
        <title>Bootstrap 101 Template</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <!-- Bootstrap -->
        <link href="css/bootstrap.min.css" rel="stylesheet" media="screen">
        </head>
      <body>
        <h1>Hello, world!</h1>
        <script src="http://code.jquery.com/jquery.js"></script>
        <script src="js/bootstrap.min.js"></script>
        <div class="row-fluid">
        <div class="span12">
        Fluid 12
        <div class="row-fluid">
        <div class="span6">
          Fluid 6
          <div class="row-fluid">
          <div class="span6">Fluid 6</div>
          <div class="span6">Fluid 6</div>
        </div>
      </div>
      <div class="span6">Fluid 6</div>
    </div>
  </div>
</div>
  </body>
</html> 
```

这就是我得到的：

[![http://s4.postimage.org/wpnf9zxbh/Untitled.png](../Images/41de9e192faa37129945aa7e97d6d3cc.png)](https://i.stack.imgur.com/CtZB4.jpg)

我的 html 页面与 bootstrap 的 css 和 js 文件夹位于同一目录中，因此“css/bootstrap.min.css”链接是正确的。

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T22:30:42.253

我认为您正在为您包含的资源获得正确的渲染。可能是您在 Bootstrap 文档页面中没有获得相同的样式。

在 Bootstrap 文档页面中，他们包含了另一个用于样式的资源文件。（您可以通过查看页面来源找到这一点）

[http://twitter.github.com/bootstrap/assets/css/docs.css](http://twitter.github.com/bootstrap/assets/css/docs.css)

页面中的特定样式是通过将类附加到带有类`show-grid`的`div`元素来实现的`row-fluid`。

编辑代码如下。

```
<!DOCTYPE html>
<html>
    <head>
        <title>Bootstrap 101 Template</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <!-- Bootstrap -->
        <link href="css/bootstrap.min.css" rel="stylesheet" media="screen">
        <link href='http://twitter.github.com/bootstrap/assets/css/docs.css' rel='stylesheet'>
    </head>
    <body>
        <h1>Hello, world!</h1>
        <script src="http://code.jquery.com/jquery.js"></script>
        <script src="js/bootstrap.min.js"></script>
        <div class="row-fluid show-grid">
            <div class="span12">
                Fluid 12
                <div class="row-fluid show-grid">
                    <div class="span6">
                        Fluid 6
                        <div class="row-fluid show-grid">
                            <div class="span6">Fluid 6</div>
                            <div class="span6">Fluid 6</div>
                        </div>
                    </div>
                    <div class="span6">Fluid 6</div>
                </div>
            </div>
        </div>
    </body>
</html> 
```

# php - Zend Framework 2 设置自定义布局和 setTerminate 问题

> ID：15420392
> 
> 赞同：1
> 
> 时间：2013-03-14T21:17:19.710
> 
> 标签：php, zend-framework2, zend-view

我不知道这是 ZF2 的错误还是我不太了解它，但我很兴奋为什么会发生这种情况。

我正在使用一种解决方案，通过附加 Dispatch 事件来全局更改每个模块的布局。（例如来自[http://framework.zend.com/manual/2.1/en/modules/zend.view.quick-start.html#dealing-with-layouts](http://framework.zend.com/manual/2.1/en/modules/zend.view.quick-start.html#dealing-with-layouts)，最后一个例子）

它运行良好，但问题是，在某些操作中我想**setTerminate(true);** （对于 Ajax 调用）它不会只显示*控制器/动作*模板的内容，而是只显示没有内容的布局模板！这是我没有预料到的。

这是如何模拟这一点，在调度函数中设置布局（而不是附加事件，以使其更清晰），然后在控制器的操作中设置终止。

```
public function dispatch(Request $request, Response $response = null)
{
    parent::dispatch($request, $response);
    $this->layout('layout/new');
}   

public function indexAction()
{
    $model = new ViewModel();
    $model->setTerminal(true);
    return $model;
} 
```

同样，我希望这将只显示*控制器/索引*模板的内容，但不是那样，它只显示*布局/新*的内容而没有内容。

我试图设置布局，它按我的预期工作。

```
public function indexAction()
{
    $this->layout('layout/new');

    $model = new ViewModel();
    $model->setTerminal(true);

    return $model;
} 
```

这是有效的，它只显示*控制器/索引*模板的内容而不是布局。

因此，如果我正在为每个控制器更改全局布局（通过附加调度事件），它会一直工作，直到我想使用这些控制器之一进行 Ajax 调用并使用 setTerminate。

感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-01-29T20:11:50.973

当您将视图模型标记为终端时，调度事件的侦听器将布局视图模型替换为您返回的视图模型。

因此，`$this->layout('layout/new');`在调度后为时已晚，您正在更改视图模型的模板。

你应该做的是附加监听器。例如，从控制器本身：

```
protected function attachDefaultListeners()
{
    //do not forget to call parent
    parent::attachDefaultListeners();

    $events = $this->getEventManager();
    //attach before action
    $events->attach(MvcEvent::EVENT_DISPATCH, array($this, 'changeLayout'), 10);
}

public function changeLayout(MvcEvent $event)
{
    $this->layout('layout/new');
} 
```

这将为您的控制器设置布局，但您将能够从操作中更改它`setTerminal()`并按预期工作

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T11:38:39.753

如果您只想显示操作视图文件中的内容，则可以使用此方法而不会出现问题：

1）为ajax调用创建一个新布局。这将替换 layout.phtml

应用程序/布局/ajax-layout.phtml

```
<?php echo $this->content ?> 
```

2) 在 Ajax 调用期间修改您的操作以覆盖默认布局

在您的控制器/动作内部：

```
// Don't render base layout if Ajax call
if($this->getRequest()->isXmlHttpRequest()) {
    $this->layout('application/layout/ajax-layout');
}

$model = new ViewModel();
return $model; 
```

这只会呈现您的操作内容，并覆盖您的基本布局:)

# gcc - 使用 DWARF 的类型安全链接

> ID：15420393
> 
> 赞同：0
> 
> 时间：2013-03-14T21:17:20.053
> 
> 标签：gcc, linker, ld, type-safety, dwarf

当 DWARF 格式包含我们需要的所有类型信息时，为什么 GCC 和 GNU ld 不支持类型检查链接？我们在公司试图让 Ada 和 C 安全通信上浪费了很多时间。问题是我们没有来自编译器的帮助，也没有链接来确保这些绑定保持同步。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T04:12:54.647

> 当 DWARF 格式包含我们需要的所有类型信息时，为什么 GCC 和 GNU ld 不支持类型检查链接？

这个问题比你想象的要复杂得多。

> 我们在公司试图让 Ada 和 C 安全通信上浪费了很多时间。

然后将对此的代码支持写入 GNU`ld`或`gold`（后者更快，更容易破解），并将其贡献给上游。问题解决了？

# android - 纺纱机无法正常工作，如何解决？

> ID：15420395
> 
> 赞同：0
> 
> 时间：2013-03-14T21:17:28.473
> 
> 标签：android

嘿伙计们，我的代码如下所示，它应该从第一个微调器中选择项目 - 诗人，然后根据输入诗 1,2 或 3 显示另一个微调器。一旦从第二个微调器中选择了一个项目，它应该显示文本视图。

我的问题是，有时它可以工作，有时它会随机选择要显示的微调器，几乎每次当我从微调器 2 中选择一个项目时，文本视图几乎从不显示，而当它通常是标题为树的文本视图时.

谁能帮忙？我没有看到任何错误，所以我很困惑

代码：

```
public class Poets extends Activity implements  OnItemSelectedListener{

//defining variables
Spinner PoetSpinner, PoemSpinner1, PoemSpinner2, PoemSpinner3;
String Poets[] = {"","Robert Burns", "James Beattie", "Duncan MacGregor Crerar"};
String Poems1[] ={"", "Tam O Shanter", "Auld Lang Syne"};
String Poems2[] ={"", "Judgement Of Paris", "The Minstrel"};
String Poems3[] ={"", "A Poem Commemorating Robbie Burns", "My Bonnie Rowan Tree"};

TextView Tam, Auld, Judge, TheMin, rob, tree ;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    //set to fullscreen mode
    requestWindowFeature(Window.FEATURE_NO_TITLE);
    getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN,WindowManager.LayoutParams.FLAG_FULLSCREEN );
    //set content view 
    setContentView(R.layout.poet);

    initialize(); //call this method
}

public void initialize(){

    //initializing items that are in the class
    PoetSpinner = (Spinner) findViewById(R.id.spPoet);
    PoemSpinner1 = (Spinner) findViewById(R.id.spPoem1);
    PoemSpinner2 = (Spinner) findViewById(R.id.spPoem2);
    PoemSpinner3 = (Spinner) findViewById(R.id.spPoem3);
    Tam = (TextView) findViewById(R.id.tvSelectPoem1);
    Auld = (TextView) findViewById(R.id.tvSelectPoem2);
    Judge = (TextView) findViewById(R.id.tvSelectPoem3);
    TheMin = (TextView) findViewById(R.id.tvSelectPoem4);
    rob = (TextView) findViewById(R.id.tvSelectPoem5);
    tree = (TextView) findViewById(R.id.tvSelectPoem6);
    //setting up array adapters
    //
    //for each spinner
    ArrayAdapter<CharSequence> adapter = ArrayAdapter.createFromResource(this, R.array.poet_arrays, android.R.layout.simple_spinner_item);
    ArrayAdapter<CharSequence> adapter2 = ArrayAdapter.createFromResource(this, R.array.poem_arrays1, android.R.layout.simple_spinner_item);
    ArrayAdapter<CharSequence> adapter3 = ArrayAdapter.createFromResource(this, R.array.poem_arrays2, android.R.layout.simple_spinner_item);
    ArrayAdapter<CharSequence> adapter4 = ArrayAdapter.createFromResource(this, R.array.poem_arrays3, android.R.layout.simple_spinner_item);
    // Specify the layout to use when the list of choices appears
    adapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
    adapter2.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
    adapter3.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
    adapter4.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
    // Apply the adapter to the spinner
    PoetSpinner.setAdapter(adapter);
    PoetSpinner.setOnItemSelectedListener(this);

    PoemSpinner1.setAdapter(adapter2);
    PoemSpinner1.setOnItemSelectedListener(this);

    PoemSpinner2.setAdapter(adapter3);
    PoemSpinner2.setOnItemSelectedListener(this);

    PoemSpinner3.setAdapter(adapter4);
    PoemSpinner3.setOnItemSelectedListener(this);

}

@Override
public void onItemSelected(AdapterView<?> parent, View view, int pos, long id) {

      String val = Poets[pos];
      String val2 = Poems1[pos];
      String val3 = Poems2[pos];
      String val4 = Poems3[pos];
       if (val.equals("Robert Burns")) {
          PoemSpinner2.setVisibility(Spinner.GONE);
          PoemSpinner1.setVisibility(Spinner.VISIBLE);
          PoemSpinner3.setVisibility(Spinner.GONE);
       }
       if (val.equals("James Beattie")) {
              PoemSpinner2.setVisibility(Spinner.VISIBLE);
              PoemSpinner1.setVisibility(Spinner.GONE);
              PoemSpinner3.setVisibility(Spinner.GONE);
           }
       if (val.equals("Duncan MacGregor Crerar")) {
            PoemSpinner2.setVisibility(Spinner.GONE);
            PoemSpinner1.setVisibility(Spinner.GONE);
            PoemSpinner3.setVisibility(Spinner.VISIBLE);
           }
       if (val2.equals("Tam O Shanter")) {
            Tam.setVisibility(View.VISIBLE);

            Auld.setVisibility(View.GONE);
            Judge.setVisibility(View.GONE);
            TheMin.setVisibility(View.GONE);
            tree.setVisibility(View.GONE);
            rob.setVisibility(View.GONE);
           }
       if (val2.equals("Auld Lang Syne")) {
            Auld.setVisibility(View.VISIBLE);

            Judge.setVisibility(View.GONE);
            TheMin.setVisibility(View.GONE);
            tree.setVisibility(View.GONE);
            Tam.setVisibility(View.GONE);
            rob.setVisibility(View.GONE);
           }
       if (val3.equals("Judgment Of Paris")) {
            Judge.setVisibility(View.VISIBLE);

            TheMin.setVisibility(View.GONE);
            tree.setVisibility(View.GONE);
            Tam.setVisibility(View.GONE);
            Auld.setVisibility(View.GONE);
            rob.setVisibility(View.GONE);
           }
       if (val3.equals("The Minstrel")) {
            TheMin.setVisibility(View.VISIBLE);

            tree.setVisibility(View.GONE);
            Tam.setVisibility(View.GONE);
            Auld.setVisibility(View.GONE);
            Judge.setVisibility(View.GONE);
            rob.setVisibility(View.GONE);
           }
       if (val4.equals("A Poem Commemorating Robbie Burns")) {
            rob.setVisibility(View.VISIBLE);

            tree.setVisibility(View.GONE);
            Tam.setVisibility(View.GONE);
            Auld.setVisibility(View.GONE);
            Judge.setVisibility(View.GONE);
            TheMin.setVisibility(View.GONE);
           }
       if (val4.equals("My Bonnie Rowan Tree")) 
            tree.setVisibility(View.VISIBLE);

            Tam.setVisibility(View.GONE);
            Auld.setVisibility(View.GONE);
            Judge.setVisibility(View.GONE);
            TheMin.setVisibility(View.GONE);
            rob.setVisibility(View.GONE);
           }

@Override
public void onNothingSelected(AdapterView<?> parent) {

}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T21:47:32.377

我有一种感觉，你把事情复杂化了一点。你可以用 2 个微调器和一个 textview 来制作你想要的东西。第一个微调器将包含诗人，根据在此微调器中选择的诗人，您可以修改第二个微调器的内容，您可以在其中拥有所选诗人的诗歌。然后，当在第二个微调器中选择诗歌时，您可以在文本视图中显示所选诗歌的名称。我会尝试这样的事情：

```
 public class Poets extends Activity implements
OnItemSelectedListener {

  // defining variables
  Spinner PoetSpinner, PoemSpinner;
  String Poets[] = { "", "Robert Burns", "James Beattie",
  "Duncan MacGregor Crerar" };
  String Poems1[] = { "", "Tam O Shanter", "Auld Lang Syne" };
  String Poems2[] = { "", "Judgement Of Paris", "The Minstrel" };
  String Poems3[] = { "", "A Poem Commemorating Robbie Burns",
  "My Bonnie Rowan Tree" };

  TextView selectedPoem;

  @Override
  protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    // set to fullscreen mode
    requestWindowFeature(Window.FEATURE_NO_TITLE);
    getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN,
      WindowManager.LayoutParams.FLAG_FULLSCREEN);
    // set content view
    setContentView(R.layout.poet);

    initialize(); // call this method
  }

  public void initialize() {

    // initializing items that are in the class
    PoetSpinner = (Spinner) findViewById(R.id.spPoet);
    PoemSpinner = (Spinner) findViewById(R.id.spPoem);
    // Hide the second spinner
    PoemSpinner.setVisibility(View.GONE);
    selectedPoem = (TextView) findViewById(R.id.tvSelectPoem1);
    // setting up array adapters
    //
    // for each spinner
    ArrayAdapter<CharSequence> adapter = ArrayAdapter
    .createFromResource(this, R.array.poet_arrays,
      android.R.layout.simple_spinner_item);
    // Specify the layout to use when the list of choices appears
    adapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
    // Apply the adapter to the spinner
    PoetSpinner.setAdapter(adapter);
    PoetSpinner.setOnItemSelectedListener(this);

    PoemSpinner.setOnItemSelectedListener(new OnItemSelectedListener() {

      public void onItemSelected(AdapterView<?> parent, View view,
        int position, long id) {
        Object poem = parent.getItemAtPosition(position);
        selectedPoem.setText(poem.toString());
      }

      public void onNothingSelected(AdapterView<?> arg0) {
        // TODO Auto-generated method stub

      }
    });
  }

  public void onItemSelected(AdapterView<?> parent, View view, int pos,
    long id) {
    ArrayAdapter<CharSequence> adapter = null;
    switch (pos) {
      case 1:
      adapter = ArrayAdapter.createFromResource(this,
        R.array.poem_arrays1, android.R.layout.simple_spinner_item);
      break;
      case 2:
      adapter = ArrayAdapter.createFromResource(this,
        R.array.poem_arrays2, android.R.layout.simple_spinner_item);
      break;
      case 3:
      adapter = ArrayAdapter.createFromResource(this,
        R.array.poem_arrays3, android.R.layout.simple_spinner_item);
      break;
      default:
      // Hide the poem spinner
      PoemSpinner.setVisibility(View.GONE);
      break;
    }

    if (adapter != null) {
      // Set the poem spinners content and show the spinner
      adapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
      PoemSpinner.setAdapter(adapter);
      PoemSpinner.setVisibility(View.VISIBLE);
    }
  }

  public void onNothingSelected(AdapterView<?> parent) {

  }

} 
```

当然，您必须从 xml 中删除未使用的视图。我希望我足够清楚，并且代码可以按照您的意愿工作。

# java - 如何管理调用另一个 JInternalFrame 的 JInternalFrame？

> ID：15420401
> 
> 赞同：3
> 
> 时间：2013-03-14T21:17:48.043
> 
> 标签：java, swing, jinternalframe, jdesktoppane

我有一个带有此代码的 JDesktopPane。

```
public class Menu extends JFrame implements ActionListener{
/**
 * Creates new form Portada
 */
public static JDesktopPane desktop;

public JDesktopPane getDesktop() {
    return desktop;
}

public Menu() {
    desktop = new JDesktopPane();
    setContentPane(desktop);

    desktop.setDragMode(JDesktopPane.OUTLINE_DRAG_MODE);
    initComponents();
}
} 
```

然后我像这样添加新组件

```
desktop.add(orden); 
```

当我想打电话给他们时，我会使用

```
if(e.getSource()==jMenuItem1_1){
        orden.setVisible(true);
        desktop.setSelectedFrame(orden);
        desktop.moveToFront(orden);
        try {
            orden.setSelected(true);
        } catch (PropertyVetoException e1) {
            // TODO Auto-generated catch block
            e1.printStackTrace();
        }
    } 
```

我遇到的问题是，当“orden”想要弹出另一个 JInternalFrame 时，我使用下一个代码。

```
searchSupplier.setVisible(true);
    Main.getInstance().getPortada().getDesktop().add(searchSupplier);
    Main.getInstance().getPortada().getDesktop()
            .moveToFront(searchSupplier);
    try {
        searchSupplier.setSelected(true);
    } catch (PropertyVetoException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } 
```

当我执行该事件超过 2 次时，我得到下一个错误：

```
Exception in thread "AWT-EventQueue-0" java.lang.IllegalArgumentException: illegal component position 
```

我应该在哪里将新的 JInternalFrame 添加到 DesktopPane？或到 Orden？，或者我能做些什么来解决这个错误？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-14T21:39:04.977

如果 searchSupplier 框架已经在桌面上，您不太可能再次添加它。尝试使用`getParent`确定是否需要添加框架

```
if (searchSupplier.getParent() == null) {
    Main.getInstance().getPortada().getDesktop().add(searchSupplier);
}
searchSupplier.setVisible(true);
Main.getInstance().getPortada().getDesktop().moveToFront(searchSupplier);
try {
    searchSupplier.setSelected(true);
} catch (PropertyVetoException e) {
    // TODO Auto-generated catch block
    e.printStackTrace();
} 
```

# java - 链表中的比较器

> ID：15420404
> 
> 赞同：1
> 
> 时间：2013-03-14T21:17:58.467
> 
> 标签：java, linked-list, comparator

我正在编写一个链表程序，试图按顺序插入一些东西，我在我的代码中使用了它，但它一直说这是一个 NullPointerException，我不知道为什么。

```
 public SortedLinkedList<T> add(T element) {
 Node insert = new Node(element); 
```

然后我检查以确保 curr 不为空。

```
if (comparator.compare(curr.data, insert.data) <= 0 
    && comparator.compare(curr.next.data, insert.data) > 0){ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T23:04:52.650

我不知道 的主体是什么`comparator.compare`，但是该方法中没有空检查，您应该这样做。

```
if (curr != null && curr.data!=null && comparator.compare(curr.data, insert.data) <= 0 
&& comparator.compare(curr.next.data, insert.data) > 0){ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-14T22:00:37.150

> 然后我检查以确保 curr 不为空。

您发布的代码不是检查是否`curr`为空，而是进行比较，并且可能试图对不存在的对象进行比较。

在尝试访问之前，您应该检查以确保`curr.next`链表中的下一个元素 ( ) 存在。

# java - 将连接从 Java 应用程序传递到 Birt 报告

> ID：15420407
> 
> 赞同：2
> 
> 时间：2013-03-14T21:18:08.157
> 
> 标签：java, connection, datasource, birt

我是Birt的新手。

我正在尝试将连接从我的 java 应用程序传递给报告，但出现错误：

> 以下项目有错误：
> 
> ReportDesign (id = 1): + 评估脚本“importPackage(Packages.it.lfiammetta.birt); var conn = new ReportRenderer(); reportContext.getAppContext().put("OdaJDBCDriverPassInConnection", conn);”时出错：在函数 __bm_beforeOpen() 中执行脚本失败。资源：
> 
> " + importPackage(Packages.it.lfiammetta.birt); var conn = new ReportRenderer(); reportContext.getAppContext().put("OdaJDBCDriverPassInConnection", conn); + "
> 
> 发生 BIRT 异常。有关详细信息，请参阅下一个例外。评估 Javascript 表达式时出错。脚本引擎错误：ReferenceError：未定义“ReportRenderer”。(/report/data-sources/oda-data-source[@id="43"]/method[@name="beforeOpen"]#2) 脚本来源：/report/data-sources/oda-data-source[ @id="43"]/method[@name="beforeOpen"]，行：0，文本：__bm_beforeOpen()。（元素 ID：1）

这是我创建和启动报告的 java 代码：

```
package it.lfiammetta.birt;

public class ReportRenderer {
        public void executeReport() {
                code...

                Map<String, Object> appContext = task.getAppContext();
                appContext.put("OdaJDBCDriverPassInConnection", myConnection);
                appContext.put("OdaJDBCDriverPassInConnectionCloseAfterUse", false);
                task.setAppContext(appContext);

                task.run();

                code...
        }
} 
```

这是我在脚本“beforeOpen”数据源中编写的代码：

```
importPackage(Packages.it.lfiammetta.birt);

var conn = new ReportRenderer(); 
reportContext.getAppContext().put("OdaJDBCDriverPassInConnection", conn); 
```

我设置了类路径。

我使用的Birt版本是4.2.1。

提前感谢您的帮助，我为我的英语道歉。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T09:25:57.130

我正在从 Java 代码中执行此操作（`IJDBCParameters`- 实际上是 JDBC 连接的参数，我正在按名称查找连接 - `OdaDataSourceHandle.getName()`）：

```
@SuppressWarnings("rawtypes")
private static void substituteJDBCConnections(IReportRunnable pReportRunnable) {
    final Map<String, IJDBCParameters> jdbcConnections = reportParameters.getJdbcConnections();
    if (jdbcConnections != null ){
        for (Iterator iter = pReportRunnable.getDesignHandle().getModuleHandle().getDataSources().iterator(); iter.hasNext();){
            // http://wiki.eclipse.org/Java_-_Execute_Modified_Report_(BIRT)
            Object element = iter.next();
            if (element instanceof OdaDataSourceHandle){
                OdaDataSourceHandle dsHandle = (OdaDataSourceHandle) element;
                String key = dsHandle.getName();
                if (key == null){
                    continue;
                }
                IJDBCParameters jdbcParams = jdbcConnections.get(key);
                if (jdbcParams == null){
                    continue;
                }
                try {
                    dsHandle.setProperty( "odaDriverClass", jdbcParams.getDriverName());
                    dsHandle.setProperty( "odaURL", jdbcParams.getConnectionString());
                    dsHandle.setProperty( "odaUser", jdbcParams.getUserName());
                    dsHandle.setProperty( "odaPassword", jdbcParams.getPassword());
                } catch (SemanticException e) {
                    throw new UncheckedException(e);
                }
            }
        }
    } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-07-02T14:22:12.560

可能您已经解决了您的问题，但也许将来有人会寻找这个。首先，4.2.x 版本在传递连接方面存在问题。我在 4.4.2 中没有观察到同样的错误。

另一件事，我不明白您为什么要尝试`ReportRenderer`作为连接传递：

```
var conn = new ReportRenderer();
reportContext.getAppContext().put("OdaJDBCDriverPassInConnection", conn); 
```

这里传入的对象应该是一个`java.sql.Connection`对象。

所以，

```
Map<String, Object> appContext = task.getAppContext();
appContext.put("OdaJDBCDriverPassInConnection", myConnection);
appContext.put("OdaJDBCDriverPassInConnectionCloseAfterUse", false);
task.setAppContext(appContext); 
```

看起来是正确的，只要`myConnection`是一个实现`java.sql.Connection`

# java - java深度优先搜索

> ID：15420409
> 
> 赞同：1
> 
> 时间：2013-03-14T21:18:12.413
> 
> 标签：java, depth-first-search

这是我使用深度优先搜索实现图的reachable()。它寻找从顶点 1 (v1) 到另一个顶点 (v2) 的可能路径，我得到了一些正确的结果，有些结果是错误的。我已经尝试了尽可能多的方法来调试，但我无法弄清楚哪里出了问题。任何帮助表示赞赏。谢谢

```
public boolean isReachable(V v1, V v2) {
            Stack<V> path = new Stack<V>();
            return isReachableHelper(v1, v2, path);
        }

}

public boolean isReachableHelper(V v1, V v2, Stack<V> path){
        path.push(v1);
        v1.setVisited(true); //set the vertex as being visited

        if (v1.vertex().equals(v2.vertex())){ //check whether vertex' values are equal
            return true;
        }

            //loop through all vertex that are neighbors of v1
        for (V neighbor : super.neighbors(v1)){ 
            if (!neighbor.visited ){ //if the neighbor is not visited before
                return isReachableHelper(neighbor, v2, path); //recursive call
            }
        }

        path.pop(); //no path was found
        return false;
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-14T21:32:55.207

问题：在你的`for`循环中，你只会扩展第一个未访问的邻居节点，然后立即返回该递归调用的值。即，如果无法通过 的第一个邻居找到路径`v1`，您就“放弃”而不看其他邻居。

相反，您必须尝试*所有*相邻节点，直到找到递归调用为其返回的节点`true`。在这种情况下，您已经找到了一条路径，您可以返回`true`；否则，您的方法会正确弹出路径中的最后一个节点并返回`false`（回溯）。

```
for (V neighbor : super.neighbors(v1)){ 
    if (!neighbor.visited ){ //if the neighbor is not visited before
        if (isReachableHelper(neighbor, v2, path)) { //recursive call
            return true; // we found a path!
        }
    }
} 
```

# java - 扫描仪回车溢出

> ID：15420411
> 
> 赞同：0
> 
> 时间：2013-03-14T21:18:18.870
> 
> 标签：java, loops, runtime-error, java.util.scanner, stack-overflow

如果有人能看到我的代码哪里出错了，我将永远感激不尽。我承认这是大量的代码，但在过去的几天里，我一直在用它来抓头发，根本无法理解如何处理它。我在课堂上向其他人寻求帮助，但他们看不到我哪里出错了。这与回车扫描仪问题有关。

```
java.util.NoSuchElementException: No line found
at java.util.Scanner.nextLine(Unknown Source)
    at PropertyMenu.runMenu(PropertyMenu.java:109)
    at PropertyMenu.main(PropertyMenu.java:7)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
    at java.lang.reflect.Method.invoke(Unknown Source)
    at 
```

edu.rice.cs.drjava.model.compiler.JavacCompiler.runCommand(JavacCompiler.java:272)

任何想法将不胜感激。

乔。

//房间类

```
import java.util.Scanner;
public class Room{

  private String description;
  private double length;
  private double width;

  public Room (String description, double length, double width) {
    this.description = description;
    this.length = length;
    this.width = width;     
   }
  public Room(){
    Scanner scan = new Scanner(System.in);
    scan.useDelimiter("\n");

    System.out.println("Enter description of room:");
    description = scan.next();

    System.out.println("Enter length of room:");
    length = scan.nextDouble();

    System.out.println("Enter width of room:");
    width = scan.nextDouble();
   }

   public double getArea () {
     return length*width;
   }

   @Override
   public String toString() {
     String result = ("***********************************\n");
            result +=("            Room Viewing            \n");
            result +=("************************************\n");
            result +=("The width of the room is " + width + "m.\n");
            result +=("the length of the room is " + length + "m.\n");
            result +=("the name of the room is: " + description +".\n");
     return result;
   }   
} 
```

//家庭类

```
import java.util.*;
public class House {
  private ArrayList<Room> abode;
  private int idNum, numRooms;
  private double totalArea;
  private static int internalCount = 1;
  private String address, roomInfo, houseType;

  public House (String address, String houseType, int numRooms){
    System.out.println("THIS IS THE START OF MY 3 ARGUMENT CONSTRUCTOR");
    idNum = internalCount++;
    this.address = address;
    this.houseType = houseType; 
    this.numRooms = numRooms;
    System.out.println("THIS IS THE END OF MY 3 ARGUMENT CONSTRUCTOR");
  }
  public House (String address, String houseType, int numRooms,  String roomInfo){
    System.out.println("THIS IS THE START OF MY 4 ARGUMENT CONSTRUCTOR");
    idNum = internalCount++;
    this.address = address;
    this.houseType = houseType; 
    this.numRooms = numRooms;
    this.roomInfo = roomInfo;

    Scanner scan = new Scanner(roomInfo);

    String desc;
    Double l;
    Double w;

    while (scan.hasNext()){
    desc= scan.next();
    l = Double.parseDouble(scan.next());
    System.out.println("the length from here"+l);
    w = Double.parseDouble(scan.next());
    System.out.println("the width from here"+w);

    new Room (desc,l,w);
    }
    System.out.println("THIS IS THE END OF MY 4 ARGUMENT CONSTRUCTOR");
  }
  public void addRoom (){
     totalArea=0;
     abode.add(new Room ());
     for (int i=0; i<abode.size(); i++){
       totalArea += abode.get(i).getArea();
     }
   }
  public House () {
    totalArea = 0;
    abode = new ArrayList<Room>();
    idNum = ++internalCount;
    Scanner scan = new Scanner(System.in);
    scan.useDelimiter("\n");

    System.out.println("Enter address of house:");
    address = scan.next();

    System.out.println("Enter number of rooms:");
    numRooms = scan.nextInt();

    System.out.println("Enter type of house:");
    houseType = scan.next();

    for (int i=1; i<=numRooms; i++){
      addRoom();
    }
  }
  int getIdNum() {
    return idNum;
  }

    @Override
   public String toString() {
      String result =("************************************\n");
            result +=("            House Viewing           \n");
            result +=("************************************\n");
            result +=("The house ID is " + idNum +".\n");
            result +=("The house address is " + address +".\n");
            result +=("The number of rooms here is " + numRooms +".\n");
            result +=("The house type is " + houseType +".\n");
            result +=("The total area of the house is " + totalArea +".\n");
            result +=(abode);
     return result;
   }   
} 
```

//司机

```
import java.util.*;
import java.io.*;
public class PropertyMenu {
  private ArrayList<House> properties =new ArrayList<House>();
  public static void main (String[] args) throws IOException{
    PropertyMenu menu = new PropertyMenu();
    menu.runMenu();
  }

  public void runMenu() {

    House h = null;
    char selection = ' ';
    Scanner s = new Scanner(System.in);

    while (selection != 'e') {
    System.out.println();
    System.out.println("~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~");
    System.out.println("Welcome to my Property database");
    System.out.println("~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~");
    System.out.println("What do you want to do?");
    System.out.println("~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~");
    System.out.println("To ADD a house enter......A");
    System.out.println("To VIEW a house enter.....V");
    System.out.println("To DELETE a house enter...D");
    System.out.println("To USE a file.............F");
    System.out.println("To QUIT enter.............E");
    selection = s.next().toLowerCase().charAt(0);

      switch (selection) {
        case 'a':
          properties.add(new House());
          break;
        case 'v':
          System.out.println("Do you want to view all houses (y/n)?");
          String all = "";
          all = s.next();

          if (all.equalsIgnoreCase("y")){
            for (int i=0; i<properties.size(); i++){
              System.out.println("Property ID: "+ (properties.get(i)));
            }
          }
          else if(all.equalsIgnoreCase("n")){
            System.out.println(""+ properties.size() +" houses have been created, choose the id of the house you wish to view.. (1/2/3 etc...)");
            System.out.println("List of property ID's: ");  
            for (int i=0; i<properties.size(); i++){
              System.out.println("Property ID: "+ (properties.get(i)).getIdNum());
            }
            System.out.println("Enter ID of the house you wish to view:");
            int viewHouse = s.nextInt();
            if (viewHouse <= properties.size() && viewHouse >= 1){
              System.out.println(properties.get(viewHouse-1));
            }
            else{
              System.out.println("~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~");
              System.out.println("       House Not Present       ");
              System.out.println("~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~");
            }
          }
          else{
            System.out.println("Do you want to view all houses (y/n)?");
            all = s.next();
          }
          break;
        case 'd':
          System.out.println(""+ properties.size() +" houses have been created, choose the id of the house you wish to delete.. (1/2/3 etc...)");
          System.out.println("List of property ID's: ");  
          for (int i=0; i<properties.size(); i++){
            System.out.println("Property ID: "+ (properties.get(i)).getIdNum());
          }
          System.out.println("Enter ID of the house you wish to delete:");
          int deleteHouse = s.nextInt();
          if (deleteHouse <= properties.size() && deleteHouse >= 1){
            properties.remove(deleteHouse -1);
          }
          else{
            System.out.println("~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~");
            System.out.println("       House Not Present       ");
            System.out.println("~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~");
          }
          break;
        case 'e':
          System.out.println("~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~");
          System.out.println("         Goodbye               ");
          System.out.println("~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~");
          break;

//*********************************THIS IS WHERE MY PROBLEM IS, FROM HERE*************

        case 'f':
          try{
          Scanner fileScan = new Scanner (new File("property.txt"));
          while (fileScan.hasNext()){
            System.out.println("THIS IS A FRESH LOOP");

            String a;
            String ht;
            String rms1;
            int rms;
            String yn;
            String rmInfo;

            a = fileScan.nextLine();
            System.out.println("ADDRESS"+a);
            ht = fileScan.nextLine();
            System.out.println("HOUSE TYPE"+ht);
            rms1 = fileScan.next();
            rms = Integer.parseInt(rms1);
            System.out.println("HOUSEROOMs"+rms);
            yn = fileScan.next();
            String overflow = fileScan.nextLine();
            System.out.println("Yes/no"+yn);

            if (yn.equalsIgnoreCase("Y")){
              System.out.println("THIS IS THE START OF CHOICE = Y");
              rmInfo = fileScan.nextLine();
              properties.add(new House(a, ht, rms, rmInfo));
              System.out.println("THIS IS THE END OF CHOICE = Y");
            }
            else{
              System.out.println("THIS IS THE START OF CHOICE = N");
              properties.add(new House(a, ht, rms));
              System.out.println("THIS IS THE END OF CHOICE = N");
            }

          }
        }
          catch (FileNotFoundException e) {
            e.printStackTrace();
          }
          break;

//******************************************TO HERE^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

        default:
          System.out.println("~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~");
          System.out.println("         Try again!            ");
          System.out.println("~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~");
      }
    }
      System.out.println("Exiting program.");
  }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T22:19:25.240

这可能是您没有正确读取文件的猜测。无论我从您的文件读取代码块和输入文件 "property.txt" 中看到什么，请进行以下更改。

1.  在您使用以下内容时，您正在逐行读取文件。

    ```
    while (fileScan.hasNextLine()){ 
    ```

2.  只使用 nextLine() 方法

    ```
    rms1 = fileScan.nextLine();
    yn = fileScan.nextLine(); 
    ```

我希望这些能解决你的问题。

# css - 在 WebKit 中为只读输入显示文本光标

> ID：15420414
> 
> 赞同：2
> 
> 时间：2013-03-14T21:18:24.827
> 
> 标签：css, webkit, html-input

```
<input value="Default" />
<input readonly value="Readonly" /> 
```

[http://jsfiddle.net/EBQ3U/](http://jsfiddle.net/EBQ3U/)

在 Firefox 中，单击禁用的输入字段会显示一个不闪烁的文本光标。我喜欢这种行为，因为它告诉用户他们可以使用 Ctrl-A 来选择输入的内容。Chrome 没有给出任何这样的视觉指示。如何在不使输入字段可写的情况下更改它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T05:27:09.610

尝试使用 CSS --> HTML 添加此代码

```
<input value="Default">
<input readonly value="Readonly" id="rd"> 
```

和 CSS——>

```
#rd
{
cursor:text;
} 
```

那应该这样做......如果那是你想要的。

# c# - 异步等待调用多个同步方法

> ID：15420415
> 
> 赞同：1
> 
> 时间：2013-03-14T21:18:37.750
> 
> 标签：c#, parallel-processing, async-await

我想知道如何最好地处理这个异步等待链，其中需要在异步链之后顺序调用多个 CPU 绑定方法。

我在下面打了一个小例子。

我只是想找出性能最好/副作用最小的模式是什么。我想确保我没有打败异步的好处。我的 Filter 方法不会访问任何异步且可等待的内容，因此要使它们异步意味着我必须在调用方法中返回 Task.Run(() => Filter1(criterion)) 或类似于 await Task.Run(() => { 返回事件; }); 在过滤器方法本身中。采用哪种方式获得最佳实践是个问题。这是大多数讨论停止的地方，所以一个完整的例子和推荐会很好。

是否有任何 4.5 async await 大师可以提供好的建议？

```
namespace test
{
    using System.Net;
    using System.Net.Http;
    using System.Threading.Tasks;
    using System.Web.Http;

    public class sampleController : ApiController
    {
        private Service _service;

        public sampleController()
        {
            _service = new Service();
        }

        public async Task<HttpResponseMessage> SomeTask(DiagnosesSearchCriterion criterion)
        {
            return Request.CreateResponse<IEnumerable<Diagnosis>>(HttpStatusCode.OK, await _service.GetDiagnosesByGroup(criterion));
        }
    }

    public class Service
    {
        private Repository _repository;

        public Service()
        {
            _repository = new Repository();
        }
        public async Task<IEnumerable<Diagnosis>> GetDiagnosis(DiagnosesSearchCriterion criterion)
        {
            System.IO.Stream events = await _repository.GetEvents(criterion);

            // Will these block? Should they be async? They are CPU bound... 
            // how to best handle this, they need to be called sequentially in most cases.
            events = Filter1(criterion, events);
            events = Filter2(criterion, events);

            return new Diagnosis[]{};
        }

        public System.IO.Stream Filter1(DiagnosesSearchCriterion criterion, System.IO.Stream events)
        {
            // CPU bound PLINQ and Parallel filtering logic here.....

            return events;
        }

        public System.IO.Stream Filter2(DiagnosesSearchCriterion criterion, System.IO.Stream events)
        {
            // CPU bound PLINQ and Parallel filtering logic here.....
            // ....

            return events;
        }
    }

    public class Repository
    {
        public async Task<System.IO.Stream> GetEvents(DiagnosesSearchCriterion criterion)
        {
            WebClient wc = new WebClient();
            return await wc.OpenReadTaskAsync("http://www.blah.com/stuff");
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-14T22:15:46.817

在服务器端，您的主要好处`async`是*可扩展性*——也就是说，如果请求只是在等待某些 I/O 完成，线程池线程就可以从处理请求中解放出来。

在这种情况下（您的方法受 CPU 限制），制作它们没有任何好处`async`。您仍然会使用`Task.Run`. 由于它们应该按顺序执行，因此最简单的方法是同步调用它们，就像您的代码当前正在执行的操作一样。

我认为这种情况在优秀的[Async in ASP.NET video](http://channel9.msdn.com/Events/aspConf/aspConf/Async-in-ASP-NET)中得到了解决。请注意，客户端上的相同情况将有不同的处理方式。在客户端，您的主要好处`async`是*响应能力*，因此*将*CPU 工作投入线程池线程 () 是有意义的`Task.Run`，因为这会释放 UI 线程。

（附带说明一下，在服务器上进行并行处理通常不是一个好主意，除非您确定您的用户数量会非常低）。

# node.js - socket.io 发出数据将断开客户端

> ID：15420420
> 
> 赞同：4
> 
> 时间：2013-03-14T21:18:50.837
> 
> 标签：node.js, socket.io

我正在聊天，我注意到有时我的 node.js 服务器和 iOS 客户端之间的连接会在服务器发出一些数据后立即断开。

我连续发出了两个事件，根据客户端上的日志，发出的数据似乎是“组合的”：

```
doQueue() >> 0
2013-03-16 05:11:45.390 [833:907] start/reset timeout
2013-03-16 05:11:45.491 [833:907] onData �187�5:::{"name":"threadInformation","args":[{"threadObjects":[{"threadId":"heacrsi1","users":[{"userName":"tester","userId":"123"},{"userName":"Name","userId":"123"}]}]}]}�171�5:::{"name":"message","args":[{"fromUserName":"tester","fromUserId":"123","text":"heiiiii this is going to trigger a message for u!","threadId":"heacrsi1","messageId":1}]}
2013-03-16 05:11:45.493 [833:907] start/reset timeout
2013-03-16 05:11:45.495 [833:907] disconnect
2013-03-16 05:11:45.496 [833:907] onDisconnect() 
```

我可以始终如一地重现这个问题。数据“合并”正常吗？为什么会发生这种断开连接？

编辑：我设法将我的问题简化为非常简单的事情：

这段代码没问题：

```
 socket.on('online', function(data){
        socket.emit("message", {"testField":"testData2"});
    }); 
```

这段代码断开了客户端的连接！：

```
 socket.on('online', function(data){
        socket.emit("message", {"testField":"testData"});
        socket.emit("message", {"testField":"testData2"});
    }); 
```

我们不允许连续向套接字发射一些东西吗？我是否应该自己实现某种队列以确保每个 socket.emit 在我发出下一个数据之前都成功？

===== 更新 =====

p/s 1：这只发生在objective-c客户端上。如果我使用 javascript 客户端，我可以接收这两个事件。

p/s 2：我设法在一个非常简单的设置中重现了这个问题：首先，一个服务器在建立连接时简单地发出两个事件： io.sockets.on('connection', function(socket) { socket.emit("message", {"text":"welcome2!"}); socket.emit("message", {"text":"welcome3!"}); } b. 其次，一个简单的 iOS 客户端（从这里使用 socket.IO-obj 库：[https ://github.com/pkyeck/ socket.IO-objc](https://github.com/pkyeck/socket.IO-objc) )

```
- (void) viewDidLoad
{
    [super viewDidLoad];
    socketIO = [[SocketIO alloc] initWithDelegate:self];
    [socketIO connectToHost:@"192.168.1.87" onPort:5000 withParams:@{@"token":@"avalidtoken"}];
} 
```

C。iOS客户端的输出：

```
 2013-03-21 01:13:39.355 SocketTesterARC[6391:907] Connecting to socket with URL:         http://192.168.1.87:5000/socket.io/1/?t=16807&token=avalidtoken
    2013-03-21 01:13:39.620 SocketTesterARC[6391:907] didReceiveResponse() 200
    2013-03-21 01:13:39.621 SocketTesterARC[6391:907] connectionDidFinishLoading()         fvSZFJMiIXop5uMayU0t:60:60:xhr-polling
    2013-03-21 01:13:39.622 SocketTesterARC[6391:907] sid: fvSZFJMiIXop5uMayU0t
    2013-03-21 01:13:39.656 SocketTesterARC[6391:907] heartbeatTimeout: 67.000000
    2013-03-21 01:13:39.657 SocketTesterARC[6391:907] transports: (
        "xhr-polling"
    )
    2013-03-21 01:13:39.658 SocketTesterARC[6391:907] xhr polling supported -> using it         now
    2013-03-21 01:13:39.680 SocketTesterARC[6391:907] onData 1::
    2013-03-21 01:13:39.681 SocketTesterARC[6391:907] start/reset timeout
    2013-03-21 01:13:39.683 SocketTesterARC[6391:907] connected
    2013-03-21 01:13:39.684 SocketTesterARC[6391:907] onConnect()
    2013-03-21 01:13:39.685 SocketTesterARC[6391:907] connected to server successfully
    2013-03-21 01:13:39.686 SocketTesterARC[6391:907] doQueue() >> 0
    2013-03-21 01:13:39.687 SocketTesterARC[6391:907] start/reset timeout
    2013-03-21 01:13:39.698 SocketTesterARC[6391:907] onData �52�5:::{"name":"message","args":[{"text":"welcome2!"}]}�52�5:::{"name":"message","args":[{"text":"welcome3!"}]}
    2013-03-21 01:13:39.700 SocketTesterARC[6391:907] start/reset timeout
    2013-03-21 01:13:39.701 SocketTesterARC[6391:907] disconnect
    2013-03-21 01:13:39.702 SocketTesterARC[6391:907] onDisconnect()
    2013-03-21 01:13:39.708 SocketTesterARC[6391:907] disconnected! error: Error Domain=SocketIOError Code=-2 "The operation couldn’t be completed. (SocketIOError error -2.)"
    2013-03-21 01:13:44.687 SocketTesterARC[6391:907] disconnect! 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T19:02:08.897

经过一番挖掘，问题似乎归结为 socket.io 如何将多条消息组合成一个数据包。

两个问题（[#65](https://github.com/pkyeck/socket.IO-objc/issues/65) [#83](https://github.com/pkyeck/socket.IO-objc/issues/83)）描述了手头的问题，并进一步详细讨论了该问题。

总之，socket.IO-objc 库没有处理这些特殊情况，并且总是假设一个数据包只包含一条消息。

问题 #65 供参考：

> 每隔一段时间（在大量套接字流量期间），服务器可以决定发送有效负载，其中多个数据包在单个轮询响应中返回（例如，如果使用 xhr-polling）。它们由 \ufffd 字符分隔，并包括每个数据包的字节长度，例如：
> 
> ```
> �[packet_0 length]�[packet_0]�[packet_1 length]�[packet_1]�[packet_n 
> ```
> 
> 长度]�[packet_n]
> 
> 目前，我相信 onData 仅将数据作为单个数据包处理，但在某些情况下，服务器会在单个响应中发送多个数据包。

*注意 � 是`\ufffd`字符。*

[之前已提交](https://github.com/pkyeck/socket.IO-objc/pull/86)了一个修复程序，并且在此发布时看起来正在审核中。

# c# - 希望为客户端身份验证创建 Web 服务并需要一些建议

> ID：15420422
> 
> 赞同：0
> 
> 时间：2013-03-14T21:19:01.070
> 
> 标签：c#, asp.net, asp.net-mvc, wcf, web-services

我正在开发一个 android 应用程序来容纳我创建的一些桌面软件。我希望移动应用程序的用户必须通过身份验证来验证他们的身份。基本上，Web 服务必须充当中央集线器，以验证和保存 android 应用程序所需的信息。我认为它应该工作的方式是

-设置中央网络服务

- 允许用户使用电子邮件/密码从桌面客户端创建帐户

- 桌面客户端会将信息发送到 android 应用程序需要的 web 服务。

-当android应用程序通过身份验证时，它将检索从客户端发布的所需数据。

所以基本上服务需要能够发送和接收数据。

我将只使用 .net（C# 或 vb.net）作为服务，所以这导致我提出几个问题：

我应该为此使用 WCF 吗？如果是这样，我应该创建一个 WCF 服务库或 WCF 服务应用程序吗？

我应该使用登录服务方法吗？

Web 服务不需要花哨，它只需要完成工作。他们是否有任何样板项目模板或项目可供我用来帮助建立基础？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T21:56:11.023

我们在我工作的地方也有类似的东西。我们必须为公司制作一个 Android 应用程序。如果您使用 .net 4.0 或更高版本，则可以利用[WebApi](http://www.asp.net/web-api)。它可以返回 json 或 xml。因此，这意味着任何平台都可以使用它（desktiop、android 等）。我发现它非常易于使用，开销很小。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-14T21:21:49.793

我最近发现了 SudzC.com，它从 .net Web 服务的 wsdl 数据为 Objective-C 生成类和方法，而且我相当确定它也适用于 Android。

我有大量相当“旧”的 Web 服务目录，这些服务早于 WCF，它们目前运行良好。

我应该指出，SudzC 服务只向您展示它可以免费为您做什么 - 获得您必须支付约 20 英镑才能获得一年通行证的代码。

# ios - pushViewController 为导航栏设置动画，但未显示新视图

> ID：15420427
> 
> 赞同：0
> 
> 时间：2013-03-14T21:19:14.970
> 
> 标签：ios, objective-c, cocoa-touch

我有一个 iOS 应用程序正在做一些疯狂的事情......我会尽力描述它。

我的导航架构如下：

AppDelegate 调用这个：

```
tabNavController = [[MainTabViewController alloc] initWithNibName:nil bundle:nil];
self.window.rootViewController = tabNavController;
[self.window makeKeyAndVisible]; 
```

MainTabViewController 继承自`UITabBarController`

在 MainTabViewController 的 viewDidLoad 中，我以编程方式将选项卡加载到 NSMutableArray 中并将其分配给 tabControllers：

```
NSMutableArray *tabs;

StreamViewController *controller = [StreamViewController alloc] initWithNib...];
UINavigationController *navCon = [UINavigationController alloc] initWithRootViewController:controller];

[tabs addObject:navContorller];

...
self.viewControllers = tabs; 
```

我的第一个选项卡——默认显示的选项卡——继承自 UIViewController。我在 XIB 中有一个 UITableView 设置作为主视图。我的课是 UITableViewDelegate 和 UITableViewDataSource。

```
StreamViewController : BaseModuleViewController <UITableViewDelegate, UITableViewDataSource> 
```

表格加载并显示正常。当用户单击一行时，我将一个新的视图控制器推送到堆栈：

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath {    
   ...
   DetailViewController* detailController = [[DetailViewController alloc] initWithNibName:@"DetailViewController" bundle:[NSBundle mainBundle]];
   [self.navigationController pushViewController:detailController animated:YES];
   ...
} 
```

这就是奇怪的地方。视图控制器的行为就像要显示，但事实并非如此。我看到我的 navigationBar 动画了——我的按钮移动了，标题改变了，并且显示了一个后退按钮——但是视图本身没有显示。我什至可以继续单击表格视图单元格并不断加载越来越多的视图，每个新视图都会为导航栏设置动画并显示一个新的后退按钮。然后我可以回击 X 次以“返回”到我的 StreamViewController。

这是下一个踢球者。如果我导航到选项卡#2，然后返回选项卡#1，以上都不会发生，并且视图看起来与它应该的完全一样。

奇怪 - 有人看到这个并且知道发生了什么吗？

**编辑**

这是一个 YouTube 视频，显示它不起作用：http: [//youtu.be/Shces88d6Go](http://youtu.be/Shces88d6Go)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T22:11:19.123

尝试添加一个导航控制器作为你的根视图控制器。

```
tabNavController = [[MainTabViewController alloc] initWithNibName:nil bundle:nil];
    UINavigationController *navCtrl = [[UINavigationController alloc] initWithRootViewController:tabNavController];
    self.window.rootViewController = navCtrl;
    [self.window makeKeyAndVisible]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T17:43:47.410

发现我在 MainTabViewController 的 viewDidLoad 方法中启动了一个模态窗口。这不知何故混淆了系统，是问题的根源。

# methods - 为什么这种递归方法会以这种方式起作用？

> ID：15420430
> 
> 赞同：1
> 
> 时间：2013-03-14T21:19:32.587
> 
> 标签：methods, recursion

该程序显示“5”的结果，但我看不出它是如何得到那个答案的，因为“+1”会导致“结果之谜（n/20）+1”

谁能带我完成计算机为得到这个而采取的逻辑步骤？

```
 public class Experimental{

    public static int mystery(int n){   
        if (n <= 0) { return 0; }   
        return mystery(n / 2) + 1;
        }//ends method

public static void main(String[] args){
    System.out.println(mystery(20));
}//ends method
}//ends class 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T21:34:05.357

这是一个递归调用。它在 n 等于 0 时结束（它永远不会变成负数）。需要 5 除以 2 才能达到零。对你来说最好的事情就是拿一张纸，看看它是如何展开的。

```
mystery(20/2) + 1 =
(mystery(20/2/2) + 1) + 1 =
((mystery(20/2/2/2) + 1) + 1) + 1 = 
(((mystery(20/2/2/2/2) + 1) + 1) + 1) + 1 = 
((((mystery(20/2/2/2/2/2) + 1) + 1) + 1) + 1) + 1 =
0 + 1 + 1 + 1 + 1 + 1 = 5 
```

希望这可以帮助。计算机在递归方面比人类好得多......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-14T21:21:52.507

是的！实际上，诸如此类的调试器`gdb`可以带您完成计算机执行的逻辑步骤。

1.  编译带有`-g`标志的程序。
2.  运行`gdb a.out`（或您的程序名称）。
3.  谷歌`gdb cheatsheet`有关如何设置断点和单步调试代码的信息。

# php - PHP 我想使用 php 创建一个 html 表

> ID：15420431
> 
> 赞同：-3
> 
> 时间：2013-03-14T21:19:45.987
> 
> 标签：php

嗨，这是我尝试的代码，第一个 while 语句适用于行（适用于 weights0，但我无法让它与列（高度）一起使用。它的工作原理是，如果 min_height 输入值为 20 且 max_height 为 50，则列将看起来像这样 20 25 30 35 40 45 50。我的代码目前适用于行但不适用于列，有人可以帮忙吗？

```
<?php
$rowiStep = 5;
$coliStep = 5;
// Get these
$iweightMin = $_GET["min_weight"];
$iweightMax = $_GET["max_weight"];
$iheightMin = $_GET["max_height"];
$iheightmax = $_GET["min_height"];

$iCur = $iweightMin;
$iCol = $iheightMin;
print('<table class="table">');
print('<tr ><td>Height/</br>Weight</td>');
while ($iCur <= $iweightMax) {
    printf('<tr><td>%d</td></tr>', $iCur);
    $iCur += $rowiStep;
}

$rowiCol = $iheightMin;

while ($iCol <= $iheightmax) {
   printf('<tr><td></td>', $iCol);
   $iCol += $rowiCol;
}

print ('</tr>');
print('</table>');  

?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T21:31:34.470

如果您要打印身高/体重矩阵；尝试这个：

```
$rowiStep = 5;
$coliStep = 5;
$output = array(
    '<table>'
);

for( $row_val = $_GET['min_weight'], $row_max <= $_GET['max_weight'];
     $row_val < $row_max;
     $row_val += $rowistep )
{
    $output[] = '<tr><td>' . $row_val . '</td>';
    for( $col_val = $_GET['min_height'], $col_val <= $_GET['max_height'];
         $col_val < $col_max;
         $col_val += $colistep )
    {
        $output[] = '<td>' . $col_val . '</td>';
    }
    $output[] = '</tr>';
}
$output[] = '</table>';
echo implode( "\n", $output ); 
```

这将产生如下输出：

```
|min_weight            |min_height|min_height+colIStep|min_height+2colIstep|...|
|min_weight + rowIstep |min_height|min_height+colIStep|min_height+2colIstep|...|
|min_weight + 2rowIstep|min_height|min_height+colIStep|min_height+2colIstep|...|
|...| 
```

你在寻找什么输出？

# c++ - C++ 字符和字符串

> ID：15420432
> 
> 赞同：-5
> 
> 时间：2013-03-14T21:20:05.830
> 
> 标签：c++

我的程序被困在同一个地方，如果有人可以帮助我，我会很高兴。我在编写将字符串插入输出流的代码时遇到问题。我用于运算符的定义是：

```
ostream& operator<<(ostream&, const String&); 
```

我被困在如何编写这部分的代码上。

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2013-03-14T21:29:54.583

从我的头顶。这是您的操作方法：

```
ostream& operator<<(ostream stream, string String){
stream << String;} 
```

# java - 这个正则表达式正确吗？

> ID：15420433
> 
> 赞同：-4
> 
> 时间：2013-03-14T21:20:09.857
> 
> 标签：java, regex

对于像 2012ca-e001a083 这样的字符串，我只想解析 e001a083，并且我在 Java 中使用正则表达式，例如：`(.*-)(.*)`所以我应该能够在 group = 2 中提取“e001a083”，对吗？这个正则表达式看起来正确吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T21:26:01.937

您可以以太分裂`-`并采取最后一部分，或者选择您的正则表达式的第二组，例如

```
String data="2012ca-e001a083";
Pattern p=Pattern.compile("(.*-)(.*)");
Matcher m=p.matcher(data);
if (m.find()){
    System.out.println(m.group(2));
} 
```

但我建议使用拆分机制，因为正则表达式中的回溯可能会慢得多。

* * *

还有另一种选择。您可以使用[环视](http://www.regular-expressions.info/lookaround.html)机制。然后你不需要指出你想要哪个组。

```
String data="2012ca-e001a083";
Pattern p=Pattern.compile("(?<=-).*");
Matcher m=p.matcher(data);
if (m.find()){
    System.out.println(m.group());
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-14T21:29:04.943

如果您要匹配的格式定义非常明确，那么尽可能地匹配格式会更安全（并且通常更有用）...

```
(\d{4}[a-z]{2})-(([a-z]\d{3}){2}) 
```

像这样分解...

```
(        // start group 1
\d{4}    // four digits
[a-z]{2} // two letters (lowercase)
)        // close group 1
-        // hyphen
(        // start group 2
(        // start group 3 (repeats within group 2)
[a-z]    // letter
\d{3}    // three digits
){2}     // close group 3, matching when it repeats twice
)        // close group 2 (capturing the repeated group 3) 
```

第 1 组应该最终包含之前的所有内容，第`-`2 组应该包含之后的所有内容

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-14T22:01:28.043

虽然该 RE 可以工作并作为第二组提供您想要的子字符串，但您那里的 RE 很差。特别是，如果不需要它们，则应避免捕获组，并且还应使第一部分能够仅被扫描一次，而不是试图回溯。RE`[^-]*-([^-]*)`更合适（在这种情况下，它将是 RE 中您想要的*第一个*组），因为它可以在一次扫描中解析正确的字符串。

# python - 带有 ctypes 函数的 Numpy 数组接口

> ID：15420442
> 
> 赞同：6
> 
> 时间：2013-03-14T21:20:39.410
> 
> 标签：python, numpy, ctypes

我正在尝试将共享 C 库连接到一些 python 代码。与库的接口类似于

```
typedef struct{
    int v1;
    double* v2} input; 
```

还有两种类似的类型：用于配置和输出类型。

`ctypes Structure`我使用s在 python 中设置这些结构，如下所示：

```
class input(Structure):
    _fields_ = [("v1",c_int),("v2",POINTER(c_double)] 
```

C 代码有一些函数接收指向该结构的指针，并且 argtypes 定义如下：

```
fun.argtypes = [constraints,input,POINTER(input)] 
```

`constraints`是另一种结构，其中包含一些`int`用于配置的字段。

首先我更新输入结构中的 v2 字段

```
input.v2 = generated_array.ctypes.data_as(POINTER(c_double)) 
```

然后我称之为：

```
fun(constraints,input,byref(output)) 
```

函数原型要求 struct 和 * 到 struct（假设输出 struct 类型与输入 struct 类型相同）。

然后我想访问存储在输出的 v2 字段中的 fun 结果。但我得到了意想不到的结果。有更好/正确的方法吗？

我在这里搜索了很多并阅读了文档，但我找不到问题所在。我没有任何错误消息，但我从共享库收到的警告似乎表明这些接口存在错误。

* * *

我想我发现了问题：

当我调用该方法时，会调用一个复杂的 numpy 数组。然后我创建 4 个向量：

```
 out_real = ascontiguousarray(zeros(din.size,dtype=c_double))
    out_imag = ascontiguousarray(zeros(din.size,dtype=c_double))
    in_real  = ascontiguousarray(din.real,dtype = c_double)
    in_imag  = ascontiguousarray(din.imag,dtype = c_double) 
```

其中 din 是输入向量。我以这种方式测试了该方法：

```
 print in_real.ctypes.data_as(POINTER(c_double))    
    print in_imag.ctypes.data_as(POINTER(c_double))
    print out_real.ctypes.data_as(POINTER(c_double))
    print out_imag.ctypes.data_as(POINTER(c_double)) 
```

结果是：

```
 <model.LP_c_double object at 0x1d81f80>
    <model.LP_c_double object at 0x1d81f80>
    <model.LP_c_double object at 0x1d81f80>
    <model.LP_c_double object at 0x1d81f80> 
```

似乎他们都指向同一个地方。

经过一些更改后，它按预期工作......

* * *

经过几次测试，我发现代码第一次几乎是正确的。我创建了一次 Structure 实例并更新了它的字段。我改为在每次调用`fun`. 我还将所有数组类型更改为等效的 ctypes 类型；这似乎使该功能按预期工作。

打印行为仍然与上面的测试一样，但即使出现这种奇怪的行为，该功能似乎也能正常工作。**正如下面@ericsun 评论所指出的那样，这是正确的。**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-15T01:49:01.763

`struct`有一个可能是数组长度的`int`字段，尽管我只是猜测没有完整的函数原型。如果确实如此，这里有一个可能有帮助的例子。

首先，我需要在共享库中编译一个测试函数。我将简单地将输入数组乘以 2：

```
import os
import numpy as np
from ctypes import *

open('tmp.c', 'w').write('''\
typedef struct {
    int v1; double *v2;
} darray;
int test(darray *input, darray *output) {
    int i;
    /* note: this should first test for compatible size */
    for (i=0; i < input->v1; i++)
        *(output->v2 + i) = *(input->v2 + i) * 2;
    return 0;
}
''')
os.system('gcc -shared -o tmp.so tmp.c') 
```

接下来创建 ctypes 定义。我添加了`classmethod`a`darray`从 a 中创建 a `numpy.ndarray`：

```
c_double_p = POINTER(c_double)

class darray(Structure):
    _fields_ = [
      ('v1', c_int),
      ('v2', c_double_p),
    ]
    @classmethod
    def fromnp(cls, a):
        return cls(len(a), a.ctypes.data_as(c_double_p))

lib = CDLL('./tmp.so')
lib.test.argtypes = POINTER(darray), POINTER(darray) 
```

测试：

```
a1 = np.arange(3) + 1.0
a2 = np.zeros(3)
print 'before:', '\na1 =', a1, '\na2 =', a2 

lib.test(darray.fromnp(a1), darray.fromnp(a2))
print 'after:', '\na1 =', a1, '\na2 =', a2 
```

输出：

```
before: 
a1 = [ 1\.  2\.  3.] 
a2 = [ 0\.  0\.  0.]
after: 
a1 = [ 1\.  2\.  3.] 
a2 = [ 2\.  4\.  6.] 
```

# c# - 获取球员姓名和得分

> ID：15420443
> 
> 赞同：1
> 
> 时间：2013-03-14T21:20:45.243
> 
> 标签：c#, mysql, .net, winforms

我想要做的是使用数据表从我的表格中获取数据`mySQL`以显示在`Listbox`我的表格中。

我怎样才能让球员的名字和分数按最高分的顺序显示？

到目前为止，我设法让球员姓名或球员得分出现。

```
MySqlConnection myConn = new MySqlConnection(connStr);

string sqlStr = "SELECT * FROM highscore";

MySqlDataAdapter dAdapter = new MySqlDataAdapter(sqlStr, myConn);

DataTable dTable = new DataTable();
dAdapter.Fill(dTable);
dAdapter.Dispose();
lstNames.DataSource = dTable;
lstScores.DataSource = dTable;
lstNames.DisplayMember = "Name"; 
```

我确实尝试过使用两个单独的列表框，但意识到我无法以任何顺序排列它们。

以下是更改后的保罗

```
 MySqlConnection myConn = new MySqlConnection(connStr);

             string sqlStr = "SELECT Name + ' ' + Score as NameAndScore " + "FROM highscore ORDER BY Score DESC";

             MySqlDataAdapter dAdapter = new MySqlDataAdapter(sqlStr, myConn);

             DataTable dTable = new DataTable();
             dAdapter.Fill(dTable);
             dAdapter.Dispose();
             lstNames.DisplayMember = "NameAndScore";
             lstNames.DataSource = dTable; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T21:23:22.373

你可以用你的 SQL 做很多事情：

```
MySqlConnection myConn = new MySqlConnection(connStr);

string sqlStr = "SELECT CONCAT(Name, ' ', Score) as NameAndScore " +
                "FROM highscore ORDER BY Score DESC";

MySqlDataAdapter dAdapter = new MySqlDataAdapter(sqlStr, myConn);

DataTable dTable = new DataTable();
dAdapter.Fill(dTable);
dAdapter.Dispose();
lstNames.DisplayMember = "NameAndScore";
lstNames.DataSource = dTable; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-14T21:26:17.637

假设保存分数的字段是“分数”，您的查询可能是

string sqlStr = "SELECT * FROM highscore order by score DESC";

基本上你需要按分数降序排列你的记录。这应该很简单

如果您有更多问题，请告诉我

# jquery - 做 Ajax Json 提要的 sessionStorage

> ID：15420444
> 
> 赞同：1
> 
> 时间：2013-03-14T21:20:52.350
> 
> 标签：jquery, ajax, json, session-storage, sessionstorage

我正在尝试实现一个非常简单的程序，但由于我的技能和知识而无法完成。 ***我得到***的 => 我从服务器检索 json 提要，它工作正常。

***我需要什么 =>***检索到的 json 提要将其添加到 sessionStorage 中，因此当我再次（在同一会话中）返回此页面时，应从 sessionStorage 中提取数据，而不是通过 Ajax 从服务器中提取数据。希望它确实有意义。

代码是：

```
$(document).ready(function () {

if (window.sessionStorage.getItem("weather") === null) {

    $.ajax({
        url: 'http://query.yahooapis.com/v1/public/yql?q=select%20*%20from%20weather.forecast%20where%20woeid%3D24553463%20and%20u%20%3D%20"c"&format=json&diagnostics=true',
        async: false,
        callback: 'callback',
        crossDomain: true,
        contentType: 'application/json; charset=utf-8',
        type: 'POST',
        dataType: 'jsonp',
        timeout: 5000,
        success: function (data, status) {
            if (data !== undefined && data.query.results.channel !== undefined) {
                $('#weather').append('<div class="wcode">' + data.query.results.channel.item.condition.code + '</div><div class="temperature">' + data.query.results.channel.item.condition.temp + '°C</div><div class="details">' + data.query.results.channel.wind.speed + '/с<br/>' + data.query.results.channel.atmosphere.pressure + '<br/>' + data.query.results.channel.atmosphere.humidity + '% humid.</div>');
            }
            var output = $('#weather');
            window.sessionStorage.setItem("weather", JSON.stringify(output));
        }
    });

} else {
    var jsData = window.sessionStorage.getItem("weather", JSON.stringify(output));
}
}); 
```

小提琴在这里：http: [//jsfiddle.net/j8QGv/](http://jsfiddle.net/j8QGv/)

请使用 fiddle 进行修改，以便其他用户可以使用该代码作为示例。

真的很感谢你的帮助...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T03:06:36.493

下面介绍如何使用会话存储

```
if (window.sessionStorage.getItem("weather") === null) {

    $.ajax({
        url: 'http://query.yahooapis.com/v1/public/yql?q=select%20*%20from%20weather.forecast%20where%20woeid%3D24553463%20and%20u%20%3D%20"c"&format=json&diagnostics=true',
        async: false,
        callback: 'callback',
        crossDomain: true,
        contentType: 'application/json; charset=utf-8',
        type: 'POST',
        dataType: 'jsonp',
        timeout: 5000,
        success: function (data, status) {
            if (data !== undefined && data.query.results.channel !== undefined) {
                $('#weather').append('<div class="wcode">' + data.query.results.channel.item.condition.code + '</div><div class="temperature">' + data.query.results.channel.item.condition.temp + '°C</div><div class="details">' + data.query.results.channel.wind.speed + ' м/с<br/>' + data.query.results.channel.atmosphere.pressure + ' мм рт. ст.<br/>' + data.query.results.channel.atmosphere.humidity + '% влаж.</div>');
            }
            var output = $('#weather').html(); // get the HTML
            window.sessionStorage.setItem("weather", output); // store it in session
        }
    });

} else {
    // this isn't how you use the getter method
    //var jsData = window.sessionStorage.getItem("weather", JSON.stringify(output));
    var jsData = window.sessionStorage.getItem("weather");
    $('#weather').html(jsData);
} 
```

`[FIDDLE](http://jsfiddle.net/YVwTj/)`

# javascript - 如何获取所选 html 文本的 startOffset/endOffset？

> ID：15420449
> 
> 赞同：0
> 
> 时间：2013-03-14T21:21:10.667
> 
> 标签：javascript

我正在尝试将“contenteditable”div 中的选定文本包装在给定标签中。下面似乎工作正常，但 startOffset/endOffset 不包括 HTML 文本。我的问题是，如果选择中存在 html 标签，我如何让 Range 对象对它们进行计数？

```
getSelectedText: function() {
  var range;
  if (window.getSelection) {
    range = window.getSelection().getRangeAt(0);
    return [range.startOffset, range.endOffset];
  }
}

toggleTagOnRange: function(range, tag, closeTag) {
  var removeExp, val;
  if (closeTag == null) {
    closeTag = tag;
  }
  val = this.get("value");
  removeExp = RegExp("<" + tag + ">(.+)</" + closeTag + ">");
  if (removeExp.test(val)) {
    this.set("value", val.replace(removeExp, function(match, $1) {
      return $1;
    }));
  } else {
    if (range.length > 1) {
      val = val.splice(range[1], "</" + closeTag + ">").splice(range[0], "<" + tag + ">");
      this.set("value", val);
    }
  }
  return this.get("val");
}

// this is called from a bold button click handler.
this.toggleTagOnSelection(this.getSelectedText(), 'strong'); 
```

如果您有其他解决方案，则对它们感兴趣。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-14T22:46:57.110

老实说，当你自己尝试为这类事情编写代码时，事情会变得非常糟糕。您需要涵盖很多情况，例如当您在多个`<p>`标签中选择文本时。你不需要重新发明轮子。查看像[rangy](https://code.google.com/p/rangy)这样的图书馆，他们已经处理了细节。特别针对您的情况，如果您可以使用 CSS 样式而不是使用标签元素`<strong>`，请查看[CSS Class Applier Module](https://code.google.com/p/rangy/wiki/CSSClassApplierModule)，它允许您通过以下方式简单地做到这一点：

```
var cssApplier = rangy.createCssClassApplier("someClass", {normalize: true});
cssApplier.toggleSelection(); 
```

`.someClass`包含您需要应用的任何样式的 CSS 类在哪里。

# string - 如何在 MongoDB 中将 BC 之前的日期存储为 ISODate？

> ID：15420450
> 
> 赞同：3
> 
> 时间：2013-03-14T21:21:13.247
> 
> 标签：string, mongodb, date, isodate

在 MongoDB 中，我存储了 BC 之前的日期具有 String 类型。我如何存储在`ISODate()`type 中？

我试过这个：

```
db.test.insert({"date" : new ISODate("-63-09-23") }) 
```

但我收到一个错误：

```
uncaught exception: invalid ISO date 
```

谢谢你的帮助 ！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-14T21:30:30.473

MongoDB IsoDate() 只是普通 javascript 日期的包装器，它可以将日期带到 1970 年之前的 1 亿天，所以像 setFullYear() 这样的东西可能是你需要的 - 像这样：[你可以创建低于 271800 的日期公元前？喜欢恐龙时代？](https://stackoverflow.com/questions/8860297/can-you-create-dates-that-are-lower-than-271800-bc-like-dinosaur-time)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-15T07:54:44.507

正如 Nik 指出的那样，MongoDB 日期只是 javascript 日期。因此，您需要将 ISODate 来回转换为底层 javascript 日期。如果您不需要根据日期进行查询，您还可以选择将日期存储为字符串。

# java - messageReceived (netty) 未调用

> ID：15420453
> 
> 赞同：0
> 
> 时间：2013-03-14T21:21:20.570
> 
> 标签：java, netty, protocol-buffers

我的源 TestMessage - 是我的 protobuf 对象

```
 @Override
        public ChannelPipeline getPipeline() {
            ChannelPipeline next = Channels.pipeline();

        next.addLast("frameDecoder", new ProtobufVarint32FrameDecoder());
            next.addLast("protobufDecoder", new ProtobufDecoder(TestMessage.getDefaultInstance()));
        next.addLast("frameEncoder", new ProtobufVarint32LengthFieldPrepender());
        next.addLast("protobufEncoder", new ProtobufEncoder());

            return next;
        }

@Override
    public void messageReceived(ChannelHandlerContext ctx, MessageEvent e) {
        Channel ch = e.getChannel();
        if (ch.isOpen()) {

            TestMessage req = (TestMessage) e.getMessage();
            System.out.println(req.getMessage());
            ch.close();

        }
    } 
```

发送

```
Socket fromserver = new Socket("localhost", 7283);

        PrintWriter out = new PrintWriter(fromserver.getOutputStream(), true);

        TestMessage.Builder message = TestMessage.newBuilder();

        message.setMessage("message .....");

        message.build();

        out.println(message);

        out.close();
        fromserver.close(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T05:40:28.423

我有个问题。messageReceived() 在哪里？

ProtobufVarint32FrameDecoder、ProtobufDecoder、ProtobufVarint32LengthFieldPrepender、ProtobufEncoder

netty中有四个班级。但是 messageReceived() 方法必须位于 CustomHandler 类中。和班级

必须添加 ChannelPipeline 的下一个实例。

例如）如果我为 messageReceived() 创建一个 ProtobufHandler 类（扩展 SimpleChannelHandler），

```
ChannelPipeline next = Channels.pipeline();
next.addLast("frameDecoder", new ProtobufVarint32FrameDecoder());
next.addLast("protobufDecoder", new ProtobufDecoder(TestMessage.getDefaultInstance()));
next.addLast("frameEncoder", new ProtobufVarint32LengthFieldPrepender());
next.addLast("protobufEncoder", new ProtobufEncoder());

next.addLast("protobufHandler", new ProtobufHandler()); //add this. 
```

对不起，我的英语水平有限。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-28T08:39:44.947

我一直在使用 Netty 5.0.0 并测试了一些来自 GitHub 的聊天示例，这些示例是为使用较旧的 Netty 版本而开发的。这些示例在客户端使用以下代码发送字符串：

`channel.write(msg + "\r\n");`

我当前的 Netty 库从未调用过函数 messageReceived。但是，在我将客户端代码更改为刷新字符串后，它已开始被调用，如下所示：

`channel.writeAndFlush(msg + "\r\n");`

# spring - 在 Spring Webflow 中，我如何从失败的启动评估过渡

> ID：15420456
> 
> 赞同：2
> 
> 时间：2013-03-14T21:21:36.770
> 
> 标签：spring, spring-webflow

我是 Spring Webflow 的新手，我正在尝试修改现有流程以根据多个规则检查用户对使用流程的授权。似乎没有一种明显的（广泛记录的）方法可以从评估过渡到某种结束条件。我理解的转换在开始时是不允许的。除了抛出异常之外，还有一种优雅的过渡方式吗？谢谢。

这是为编辑创建的表单。我将授权检查代码添加到引用的方法中。我可以在此之前添加一个单独的评估来检查授权，但我仍然有过渡问题。

```
<on-start>
    <evaluate        expression="solutionCreateEditFlowHelper.findDocumentForEdit(requestParameters.solutionId)" result="flowScope.documentForm"></evaluate> 
```

>

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-14T21:29:38.070

你并不总是需要`<on-start>`. 您可以将决策状态作为起始状态，并在该决策状态中检查您的条件是真还是假，如果为真，则转换到您的视图状态或其他状态，如果不转换到带有视图的结束状态。

假设你
在这个文件中调用你的流 documentFlow.xml，你放置了一个如下的决策状态：

```
<input name="solutionId" type="long" />

<decision-state id="isDocumentFormSet">
<on-entry>
    <evaluate expression="solutionCreateEditFlowHelper.findDocumentForEdit(solutionId)" result="flowScope.documentForm"/>
</on-entry>
    <if test="documentForm == null" then="chooseDocument" else="noDocument"/>
</decision-state>

<end-state id="noDocument"/>

<view-state id="chooseDocument">
....
</view-state> 
```

# ruby-on-rails - 由于 cookie，使用 authlogic 时无法在 Rails 中创建用户

> ID：15420462
> 
> 赞同：2
> 
> 时间：2013-03-14T21:21:55.693
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, rspec2, authlogic

所以，我有一个带有 authlogic 的标准 rails 3 应用程序。如果我不在浏览器中（在控制台或测试环境中），我无法创建用户模型。

例如：

我在 rspec 测试或控制台中有此代码：

```
user = User.create(...user attributes...) 
```

我得到这个错误：

```
NoMethodError: undefined method `cookies' for main:Object 
```

我已经在互联网上查看了所有内容，但无法弄清楚。任何帮助将不胜感激。

编辑：

所以，我环顾四周，发现在文档中可以做到这一点：

```
include Authlogic::TestCase 
```

但后来我得到这个错误：

```
uninitialized constant Authlogic::TestCase 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-23T16:53:15.200

我有同样的问题。您在应用程序中的哪个位置放置了以下行：

```
Authlogic::Session::Base.controller = Authlogic::ControllerAdapters::RailsAdapter.new(self) 
```

当我将该行放在`environment.rb`文件中或我的初始化程序文件夹中的文件中时，我遇到了这个错误。

当我把线放在我的`ApplicationController`代替时，我消除了这个问题。

# sql - 包和程序编译

> ID：15420465
> 
> 赞同：0
> 
> 时间：2013-03-14T21:22:07.417
> 
> 标签：sql, oracle, package, oracle-apex, procedure

现在挣扎了一个多小时......为什么不能编译？

Body 编译得很好：

```
create or replace package body "PKG_CUSTOMER" is

PROCEDURE Create_Customer
(  pr_customer_id  customer.Customer_id%type,
      pr_country customer.country%type,
      pr_first_name  customer.first_name%type,
      pr_last_name  customer.last_name%type, 
      pr_birth_date   customer.birth_date%type,
      pr_customer_type customer.customer_type%type,
      pr_address customer.address%type)

   IS
   BEGIN
      INSERT INTO customer (Customer_ID,Country,First_Name,Last_Name,Birth_Date,Customer_Type,Address)
         VALUES(pr_customer_id, pr_country, pr_first_name, pr_last_name, pr_birth_date, pr_customer_type, pr_address);
   END Create_Customer;

   PROCEDURE Delete_Customer(pr_customer_id   customer.customer_id%type) IS
   BEGIN
   DELETE FROM order_line WHERE fk1_order_id IN (SELECT order_id FROM placed_order WHERE fk1_customer_id = pr_customer_id);
   DELETE FROM placed_order WHERE fk1_customer_id = pr_customer_id;
   DELETE FROM customer WHERE customer_id = pr_customer_id;
   END Delete_Customer;

end "PKG_CUSTOMER";​ 
```

但规范不会编译：

```
create or replace package PKG_CUSTOMER as

Procedure CREATE_CUSTOMER;
Procedure DELETE_CUSTOMER;

end;​ 
```

我收到此错误：

```
Compilation failed,line 3 (21:20:46)
PLS-00323: subprogram or cursor 'CREATE_CUSTOMER' is declared in a package specification and must be defined in the package bodyCompilation failed,line 4 (21:20:46)
PLS-00323: subprogram or cursor 'DELETE_CUSTOMER' is declared in a package specification and must be defined in the package body 
```

我正在使用 Oracle APEX。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-14T21:26:55.547

包规范必须为您要公开的过程提供完整的规范。这包括参数。假设你想让你在包中声明的两个过程都对包外的调用者可用

```
create or replace package PKG_CUSTOMER 
as
  Procedure CREATE_CUSTOMER(  
        pr_customer_id  customer.Customer_id%type,
        pr_country customer.country%type,
        pr_first_name  customer.first_name%type,
        pr_last_name  customer.last_name%type, 
        pr_birth_date   customer.birth_date%type,
        pr_customer_type customer.customer_type%type,
        pr_address customer.address%type);
  Procedure DELETE_CUSTOMER(pr_customer_id   customer.customer_id%type);
end;​ 
```

如果您的意图是声明一个`CREATE_CUSTOMER`和一个`DELETE_CUSTOMER`每个都接受 0 个参数的过程，那么您还需要在包主体中实现这些过程。

# python - Python CSV 编写器在每个元素的开头添加字母并出现编码问题

> ID：15420467
> 
> 赞同：8
> 
> 时间：2013-03-14T21:22:12.067
> 
> 标签：python, csv, unicode

所以我试图将 JSON 文件解析成一个制表符分隔的文件。解析似乎工作正常，所有数据都通过了。尽管输出文件上发生了最奇怪的事情。我告诉它使用制表符分隔符并在输出中使用制表符，但它似乎仍然保留单引号。出于某种原因，它似乎也在开头添加了字母 B。我手动输入了标题，效果很好，但数据本身表现得很奇怪。这是我得到的输出示例。

```
id  created text    screen name name    latitude    longitude   place name  place type
b'1234567890'   b'Thu Mar 14 19:39:07 +0000 2013'   "b""I'm at Bank Of America (Wayne, MI) http://t.co/asdf"""  b'userid'   b'username' 42.28286837 -83.38487864    b'Bank Of America, Wayne'   b'poi'
b'1234567891'   b'Thu Mar 14 19:39:16 +0000 2013'   b'here is a sample tweet \xf0\x9f\x8f\x80 #notingoodhands'  b'userid2'  b'username2' 
```

这是我用来写出数据的代码。

```
out = open(filename, 'w')
   out.write('id\tcreated\ttext\tscreen name\tname\tlatitude\tlongitude\tplace name\tplace type')
   out.write('\n')
   rows = zip(ids, times, texts, screen_names, names, lats, lons, place_names, place_types)
   from csv import writer
   csv = writer(out, dialect='excel', delimiter = '\t')
   for row in rows:
       values = [(value.encode('utf-8') if hasattr(value, 'encode') else value) for value in row]
       csv.writerow(values)
   out.close() 
```

事情就是这样。如果我在没有 utf-8 位的情况下执行此操作并直接输出，那么格式将完全符合我的要求。但是当人们输入特殊字符时，程序会崩溃并且无法处理。

```
Traceback (most recent call last):
  File "tweets.py", line 34, in <module>
    csv.writerow(values)
  File "C:\Python33\lib\encodings\cp1252.py", line 19, in encode
    return codecs.charmap_encode(input,self.errors,encoding_table)[0]
UnicodeEncodeError: 'charmap' codec can't encode character '\U0001f3c0' in position 153: character maps to <undefined> 
```

添加 utf-8 位会将其转换为您在此处看到的输出类型，但随后会将所有这些字符添加到输出中。有人对此有任何想法吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-03-14T21:25:16.397

您正在将字节数据而不是 unicode 写入文件，因为您自己对数据进行编码。

完全删除`encode`调用，让 Python 为您处理；使用 UTF8 编码打开文件，其余部分自行处理：

```
out = open(filename, 'w', encoding='utf8') 
```

这记录在[`csv`模块文档](http://docs.python.org/3/library/csv.html#examples)中：

> 由于`open()`用于打开 CSV 文件进行读取，默认情况下该文件将使用系统默认编码解码为 un​​icode（请参阅 参考资料[`locale.getpreferredencoding()`](http://docs.python.org/3/library/locale.html#locale.getpreferredencoding)）。要使用不同的编码解码文件，请使用 open 的 encoding 参数：
> 
> ```
> import csv
> with open('some.csv', newline='', encoding='utf-8') as f:
>     reader = csv.reader(f)
>     for row in reader:
>          print(row) 
> ```
> 
> 这同样适用于以系统默认编码以外的方式写入：打开输出文件时指定编码参数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-14T21:35:30.727

这里有很多事情要做，但首先，让我们澄清一些困惑。

将非 ASCII 字符编码为 UTF-8 意味着您可以获得多个字节。例如，字符`是`\xf0\x9f\x8f\x80`UTF-8。但这仍然只是一个字符，它只是一个占用四个字节的字符。如果您将字符串写入二进制文件，然后在 UTF-8 兼容工具（记事本或 TextEdit，或仅`cat`在 UTF-8 友好终端/shell 上）查看该文件，您会看到一个`，而不是四个垃圾字符。``

 ``其次，`b'abc'`不是`b`添加到开头的字符串，而是`repr`byte-string 的表示`abc`。与引号一样，`b`它不再是字符串的一部分。

最后，在 Python 3 中，您不能以文本模式打开文件，然后将字节字符串写入其中。要么以文本模式打开它，使用编码，然后写入普通的 unicode 字符串，要么以二进制模式打开它并写入编码的字节字符串。``

# matlab - Matlab：这个关于数组的代码有问题

> ID：15420468
> 
> 赞同：0
> 
> 时间：2013-03-14T21:22:16.857
> 
> 标签：matlab

这是问题：

文件 upcs.txt 包含在杂货店扫描的 UPC 代码列表。理想情况下，每行应包含对应于单个产品的 12 位数字。读取文件的内容并将条目存储到一个名为代码的 mx 12 大小的数字数组中，其中 m 是文件中的有效行数。应丢弃少于或多于 12 位的行。某些 12 位数字的行可能包含未正确扫描的数字，这些数字被替换为字母`X'. These missing digits should be represented in the array codes by the integer`-1'。处理文件后，打印读取的总行数、丢弃的行数以及正确处理和存储在代码中的行数。

upcs.txt：

X9096X082489

921642004330

810905023006

733554287763

413527622XX1

287X35871528

100093334850

764491079X90

1537X8886614

086755751640

860053705316

980098819206

038356338621

577577248178

82825685985

684580785580

736657539753

71113617151

935014271064

702345843488

58316491755

110118383664

333841856254

996003013296

495258095746

4457870230

684104168936

522784039910

6504512835

699553963094

853110488363

554147120089

* * *

到目前为止，这是我的代码：

```
fid = fopen('upcs.txt');
mat = [];
if fid == -1
    disp('File open was not successful')
else codes = {};
    while feof(fid) == 0
        aline = fgetl(fid);
        num = strtok(aline);
        codes = [codes; num]
    end;
[m n] = size(codes)
discard = 0
for i = 1:m
    len = length (codes(i))
    if len ~= 12
        codes = [];
        discard = discard + 1
    else
        char(codes(i))
        codes = strrep(codes, 'X', '-1')
    end
end
codes
end 
```

我遇到的麻烦是我不知道如何删除代码中少于或多于 12 位的代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T21:50:47.427

```
clear;clc;
fid = fopen('upcs.txt','r');
if fid == -1
    error('File open was not successful');    
end

C = textscan(fid,'%s');
C = C{1};

all_codes_num = size(C,1);
codes_discarded_num = 0;
codes_missed_digit_num = 0;
codes_correct_num = 0;
codes = [];
for i = 1:all_codes_num
    one_code = C{i};
    if length(one_code) == 12
        x_flag = 0;
        code_tmp = zeros(1,12);
        for j = 1:12
            if one_code(j) == 'X' || one_code(j) == 'x'
                code_tmp(j) = -1;
                x_flag = 1;
            else 
                code_tmp(j) = str2num(one_code(j));
            end
        end
        if x_flag == 1
            codes_missed_digit_num = codes_missed_digit_num +1;
        end
        codes = [codes;code_tmp];
    elseif length(one_code) ~= 12
        codes_discarded_num = codes_discarded_num + 1;
    end
end

all_codes_num
codes_discarded_num
codes_with_x = codes_missed_digit_num
correct_codes_without_x = all_codes_num - codes_discarded_num - codes_with_x 
```

代码：具有所有正确的代码以及 12 长度的代码，缺失数据已被替换为“-1”。这是 am*12 数字矩阵。每一行都是一个代码。

all_codes_num：我们读过的所有行数

code_discarded_num：所有多于或少于 12 个字符的代码的数量

codes_with_x：12 位长度代码中缺少数字的个数。

correct_codes_without_x：只有数字的 12 位代码的数量。

在代码中，我假设在“upcs.txt”中，每一行都是一个代码。

# android - 查找 ContentResolver.notifyChange 的调用者

> ID：15420469
> 
> 赞同：0
> 
> 时间：2013-03-14T21:22:17.060
> 
> 标签：android, android-contentresolver, contentobserver

我有一个更新包含服务配置数据的表的活动。我正在使用 SimpleCursorLoader 和 SupportLoaderManager 来更新该 Activity 中的列表视图。我在活动的 onDestroy 中销毁了加载程序。这可能不相关，因为即使没有访问此活动，我看到的问题也会发生。

我也有一项服务，它将 URI 上的 ContentObserver 注册到在上面的 Activity 中修改的表。它读取其配置，设置自己并在服务的 onCreate 中的该表上注册一个 ContentObserver。在服务的 onDestroy 中，该侦听器未注册。

这只是我系统中的几个数据库/表中的一个。我看到的是，当我对完全不同的表进行更新时，会触发此配置 URI 上的 ContentObserver。Authorities 完全不同，它们与不同的 SqlLite 数据库交互，它们甚至在应用程序的不同进程中运行。我删除了所有我能找到的会触发 ContentObservers 的“notifyChange”调用，但它们仍在触发。

我的问题是，有没有办法找出谁在调用导致 ContentObserver 触发的 notifyChange？我的应用程序之外的系统是否有任何理由通知观察者一个 URI？我正在尝试追踪它，但不知道通知来自何处，我正在撞墙。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T15:32:47.617

同样，距离答案只有几个小时。我显然没有在我的代码中找到所有的 notifyChange 调用。罪犯是：

```
getContentResolver.notifyChange(new Uri.Builder().build(), null); 
```

它在空白 Uri 上调用 notify。文档中似乎没有注意到，但我看到的行为是这触发了所有已注册的 ContentObservers 在我的应用程序中被触发。我把那条线从那里拿出来了，现在一切都在通知它。

我最初的问题的答案，“有没有办法找出谁在 Uri 上调用了 notifyChange？”，我认为答案是“在你的代码中更努力地寻找 notifyChange 的调用。除此之外，你自己。”

# datetime - mysqldb 将时间戳数据转换为无

> ID：15420470
> 
> 赞同：8
> 
> 时间：2013-03-14T21:22:21.757
> 
> 标签：datetime, timestamp, type-conversion, mysql-python

我正在使用 MySQLdb 与 mysql 数据库通信，并且能够动态检索所有结果集。

我的问题是，一旦我得到结果集，有几列在 mysql 中被声明为时间戳，但是当它被检索时，它变成了无。

我有两列，两列都是声明的时间戳，但一列返回正确数据，另一列返回无。utime 和 enddate 都被声明为时间戳，但 utime 不会正确返回，而 enddate 会正确返回。

```
['utime', 'userstr', 'vstr_client', 'enddate']

((None, '000102030ff43260gg0809000000000004', '7.7.0', '1970-01-01 12:00:00.000000'))

def parse_data_and_description(cursor, data):

    res = []
    cols = [d[0] for d in cursor.description]
    print cols
    print data

    for i in data:
        res.append(OrderedDict(zip(cols, i)))
    return res

def call_multi_rs(sp, args):

    rs_id=0;
    conn = connect()
    cursor = conn.cursor()
    try:
        conn.autocommit(True)
        cursor.execute ("CALL %s%s" % (sp, args))
        while True:
            rs_id+=1
            data = cursor.fetchone( )
            listout = parse_data_and_description(cursor, data)
            print listout
            if cursor.nextset( )==None:
            # This means no more recordsets available
            break 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-14T23:34:56.403

最后在没有人回答或尝试查找更多信息后，我继续寻找更多解决方案，发现 MySQLdb 库将数据类型从 sql 转换为 python 并且存在不转换时间戳的错误。

我仍然不知道为什么其中一个被转换而另一个没有。如果有人能弄清楚，请更新这个。

但是这里是连接mysql数据库时需要做的修改。MySQLdb 无法序列化 python 日期时间对象

```
try:
    import MySQLdb.converters
except ImportError:
    _connarg('conv')

def connect(host='abc.dev.local', user='abc', passwd='def', db='myabc', port=3306):

    try:
        orig_conv = MySQLdb.converters.conversions
        conv_iter = iter(orig_conv)
        convert = dict(zip(conv_iter, [str,] * len(orig_conv.keys())))
        print "Connecting host=%s user=%s db=%s port=%d" % (host, user, db, port)
        conn = MySQLdb.connect(host, user, passwd, db, port, conv=convert)
    except MySQLdb.Error, e:
        print "Error connecting %d: %s" % (e.args[0], e.args[1])
    return conn 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-09-06T07:36:34.737

我偶然发现了同样的问题：检索`DATETIME(1)`-type 的数据返回`None`。

一些研究提出了[MySQLdb-Bug #325](https://sourceforge.net/p/mysql-python/bugs/325/)。根据那个错误跟踪器，这个问题仍然存在（现在已经有 2 年多了），但评论提供了一个可行的解决方案：

在 MySQLdb 包的 times.py 中，您需要插入一些行来处理微秒，如下所示：

```
def DateTime_or_None(s):
    if ' ' in s:
       sep = ' '
    elif 'T' in s:
        sep = 'T'
    else:
        return Date_or_None(s)

    try:
        d, t = s.split(sep, 1)
        if '.' in t:
            t, ms = t.split('.',1)
            ms = ms.ljust(6, '0')
        else:
            ms = 0
        return datetime(*[ int(x) for x in d.split('-')+t.split(':')+[ms] ])
    except (SystemExit, KeyboardInterrupt):
        raise
    except:
        return Date_or_None(s)

def TimeDelta_or_None(s):
    try:
        h, m, s = s.split(':')
        if '.' in s:
            s, ms = s.split('.')
            ms = ms.ljust(6, '0')
        else:
            ms = 0
        h, m, s, ms = int(h), int(m), int(s), int(ms)
        td = timedelta(hours=abs(h), minutes=m, seconds=s,
                       microseconds=ms)
        if h < 0:
            return -td
        else:
            return td
    except ValueError:
        # unpacking or int/float conversion failed
        return None

def Time_or_None(s):
    try:
        h, m, s = s.split(':')
        if '.' in s:
            s, ms = s.split('.')
            ms = ms.ljust(6, '0')
        else:
            ms = 0
        h, m, s, ms = int(h), int(m), int(s), int(ms)
        return time(hour=h, minute=m, second=s, microsecond=ms)
    except ValueError:
        return None 
```

但是，我无法解释的是，您的原始查询是在一个列上工作而不是在另一列上工作。也许，第二个查询中没有任何微秒信息？

# ruby-on-rails - 这个 rails 查询为什么在本地工作但在 Heroku 上失败？

> ID：15420473
> 
> 赞同：1
> 
> 时间：2013-03-14T21:22:31.117
> 
> 标签：ruby-on-rails, ruby-on-rails-3, heroku, rails-migrations

我的控制器中有以下方法：

```
@featured_topics = Topic.find_all_by_featured(true) 
```

它在本地运行良好，但是当我将我的网站上传到 Heroku 时，它失败了，并且我收到了 NoMethodError。“精选”是一个新专栏，但我上传了必要的文件并在 Heroku 上运行了 rake db:migrate。为什么它在 Heroku 上不起作用？该网站的其余部分仍然有效。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-15T14:54:53.563

这里的问题是一个微妙的问题，仅当您的应用程序处于生产模式（即当`ENV['RAILS_ENV']`或`ENV['RACK_ENV']`=时`production`）时才会出现，这是 Heroku 上的默认配置。

当 Rails 应用程序处于`production`模式时，它不会在每个请求上重新加载类定义（就像在`development`本地运行的模式下一样）。模型类定义的一部分是加载类时从数据库列中获取的属性。因此，如果您在 中加载一个类`production`，然后更改数据库，加载的类将不知道数据库已更改，您将获得`NoMethodError`新列的。

要了解您在 Heroku 上的情况如何发生这种情况，请考虑以下顺序：

1.  `Topic.find_all_by_featured`使用新列引用 部署的应用程序
    1.  Heroku 自动重启应用
    2.  一个请求进入您的应用程序，导致类从数据库的当前状态加载到内存中（无`featured`列）
2.  你跑`heroku run bundle exec rake db:migrate`
    1.  您在 Heroku 上的数据库已更新为新`featured`列
    2.  Heroku 测功机中已经在内存中的模型类*不会*重新加载。他们仍然不知道新专栏。
3.  你点击了你的应用程序。Rails 抛出错误，因为代码中引用的字段不在其数据库列列表中（在步骤 #1 加载）。

避免这种情况的正确顺序是为部署和数据库迁移打开维护模式：

```
$ heroku maintenance:on
$ git push heroku master
$ heroku run bundle exec rake db:migrate
$ heroku maintenance:off 
```

在部署和迁移时打开维护可确保您的应用程序不会处理任何请求，并且不会加载任何类（具有不正确的列列表）。只有在数据库处于正确状态后，您才允许请求。

# python - 通过 python IDE 访问 GRASS 模块

> ID：15420475
> 
> 赞同：0
> 
> 时间：2013-03-14T21:22:33.223
> 
> 标签：python, ide, open-source, arcgis, arcpy

我正在尝试从 python IDE 中访问 GRASS 模块和函数。（我正在使用 WingIDE）

我的谷歌搜索告诉我可以做到（我认为），但我找不到任何关于如何做到这一点的明确说明。有没有人能给我一些关于我需要做什么的明确指示？

简单地输入这行代码是行不通的。我不认为它正在定位草模块。我有 arcgis 10.1

```
import sys
import grass.script as grass 
```

最终目标是能够同时使用 argis 工具箱和 GRASS 工具。

不管怎样，希望这对外面的人来说是一件容易而明显的事情，

任何帮助都会很棒，

干杯，

担

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T16:45:10.033

Wing IDE 可能会选择另一个 Python 安装作为默认安装，而不是您安装了草地的那个。您可以在 Source 菜单的 Show Python Environment 中进行检查，并在 Project 菜单的 Project Properties 中进行配置（或 Wing 101 中的 Configure Python 对话框）。如果由于某种原因您没有将 Grass 安装到 Python 中而是将其放在单独的位置，则您可能需要配置 Python Path 或代替。

完成后，脚本应该能够在调试器中运行并成功导入模块（或者您也可以在 Python Shell 中执行此操作）。

如果这没有帮助，请告诉我或发送电子邮件至 support@wingware.com。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T16:55:40.527

除了@Wingware 的重点，并假设您的“grass.script”是一个 python 模块，您的 PYTHONPATH 需要包含包含“grass.script”的目录，以便 python 解释器能够找到/导入所需的脚本。您应该能够在启动 IDE 之前通过 IDE 或操作系统进行设置。

# java - 我应该在 Spring MVC Web 应用程序中的 DAO 层或服务层上进行缓存吗？

> ID：15420478
> 
> 赞同：11
> 
> 时间：2013-03-14T21:22:53.820
> 
> 标签：java, caching, spring-mvc

我想在我的 Spring MVC Web 应用程序中缓存数据。因为我也是 Spring Framework 和 MVC 架构的新手，所以我想问一下我应该在 DAO 层缓存数据（通过[Spring Caching system](http://static.springsource.org/spring/docs/3.1.0.M1/spring-framework-reference/html/cache.html)）还是应该在服务层缓存输出方法？

例如，我在服务层上有这个方法：

```
@Override
public LinkedList<OrderCount> getOrderCount(Date dateFrom, Date dateTo, Class type) {
    try {
        return chartDataDAO.getOrderCount(dateFrom, dateTo, type);
    } catch (Exception e) {
        throw new RuntimeException(e);
    }
} 
```

这个方法调用这个 DAO 方法：

```
public LinkedList<OrderCount> getOrderCount(Date dateFrom, Date dateTo, Class type); 
```

**我的问题是：**我应该在服务层还是 DAO 层上进行缓存？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-14T21:29:57.673

首先，不要超前。在缓存之前，请确保您需要它。缓存可以提高性能，但会带来一系列令人头疼的问题（主要是由于失去数据一致性）。

其次，如果您进行缓存，请尽可能使用 EHCache 之类的第三方框架（是的，这就是数据层）

第三，在您的示例中，您的方法签名使我认为您不太可能多次收到相同的请求。当`getOrderCount(January 27, January 28, String)`您收到`getOrderCount(March 21, March 28, Vector)`. 除非您的业务逻辑可能需要很多值，并且计算结果足够重，否则缓存（如果有）应该进入数据层。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-02T19:14:15.777

如果您正在执行更多上下文感知缓存，我认为缓存适合服务层。例如对查询结果的乐观锁定支持，该查询结果可以由 Web 服务 api 或 Etag 支持分页。这假定了直接缓存方法（非声明性），例如直接使用 EhCache。

如果您使用 Spring 声明式缓存来尝试一些全面的性能改进，您可能会发现在 DAO 层中缓存方法很有用。我不确定这是否会比可能已经用您的 ORM 实现的缓存提供任何好处 - 例如，休眠支持各种缓存级别以提高数据库的性能。

# arrays - 为什么反序列化不会将 JSON 字符串转换为 Coldfusion 中的结构或数组？

> ID：15420486
> 
> 赞同：0
> 
> 时间：2013-03-14T21:23:21.273
> 
> 标签：arrays, json, serialization, coldfusion, struct

我正在尝试反序列化 .json 中的 JSON 字符串`Coldfusion8`。它似乎有效（没有错误），但我无法使用我得到的数据。

我的 JSON 字符串如下所示：

```
"{\"kundenliste\":{\"kundennummer\":\"1\",\"plz\":\"2\",\"rabatt\":\"3\",\"laenderkennzeichen\":\"4\",\"preisliste\":\"5\... 
```

我可以做这个：

```
<cfset variables.import = DeserializeJSON(getModus.myJSONstring)>
<cfdump output="e:\dump.txt" label="catch" var="#IsArray(variables.import)#">
<cfdump output="e:\dump.txt" label="catch" var="#IsStruct(variables.import)#">
<cfdump output="e:\dump.txt" label="catch" var="#IsObject(variables.import)#">
<cfdump output="e:\dump.txt" label="catch" var="#IsDefined(variables.import.kundenliste)#"> 
```

结果是：

```
{"kundenliste":{"kundennummer":"1","plz":"2","rabatt":"3","laenderkennzeich ...
NO
NO
NO
<<error>> 
```

**问题**：
反序列化时我做错了什么吗？我认为这将返回一个结构或数组，而不是一个字符串。该怎么办？

感谢帮助！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-14T21:51:04.630

原始 JSON 字符串无效。名称/值对周围的引号不应像 ie 那样转义`\"`，这就是它没有被正确解析的原因。输入字符串应该看起来更像你的“结果”：

```
 {"kundenliste":{"kundennummer":"1"}} 
```

该字符串的来源是什么？

# asp.net-mvc-4 - 两个项目 Visual Studio 解决方案 MVC 和 Web

> ID：15420488
> 
> 赞同：1
> 
> 时间：2013-03-14T21:23:27.887
> 
> 标签：asp.net-mvc-4, visual-studio-2012, single-page-application

是否可以安排一个视觉工作室解决方案，以便有：

```
x.sln
     x.Web.csproj  -pure html/js/css
     x.MVC.csproj  -routes and standard webapi 
```

MVC 站点运行和托管 Web 项目的位置，即视图/静态之外。在同一台服务器上。也许作为一个虚拟目录？这样，它们可以单独开发和测试，但可以部署并可以选择一起运行它们。

# java - java string.replace 使用方法运行太慢

> ID：15420490
> 
> 赞同：1
> 
> 时间：2013-03-14T21:23:47.510
> 
> 标签：java, string, format

我有一个带有字符串作为参数的方法，它用方法中的字符串替换特定的占位符：

```
public static String format(String in)
{
    in=in.replace("[time]",getTime()); //just some methods returning strings
    in=in.replace("[name]",getName());
} 
```

我的问题是，即使字符串“[time]”没有出现在字符串中，每次调用 format(String) 时都会调用方法 getTime() 和 getName()。由于我调用了数百次 format(String)，因此解析所有字符串需要一分钟。由于 getTime() 和 getName() 需要很长时间才能执行，并且子字符串“[time]”和“[name]”很少见，如果替换方法只调用 getTime() 或 getName() 会快得多是占位符。我看到的最快的解决方案是将 string.replace() 重写为 replace(String)。现在我的两个问题是：

1.  有没有更快的方法来做到这一点？
2.  哪个是编写替换（字符串）的最快方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T21:27:51.457

如果在字符串中搜索比调用`getTime()`and花费的时间更少`getName()`，那么`contains`首先使用。

```
if (in.contains("[time]"))
{
    in=in.replace("[time]",getTime());
} 
```

然后你只`getTime()`在需要时才打电话。对`getName()`.

或者，如果`getTime()`并且`getName()`总是返回相同的结果，则只调用它们一次并存储它们的结果以供以后使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-14T21:35:08.190

从逻辑上讲，replace 必须在替换之前先搜索字符串，因此在字符串不出现的情况下，它相当于调用 contains，因为 contains 只是进行搜索。所以先搜索不会加快速度。

听起来代码可能对相同的源字符串进行了多次重复搜索。如果是这样，那么答案可能是停止这样做。您可能希望先扫描所有内容，存储替换的结果，然后在必要时检索这些结果。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-14T22:59:42.960

性能测试是确定什么是最快的。

一个小代码来测试三种不同的方法来编写这个......

```
import java.io.IOException;
import java.util.Properties;
import java.util.Vector;

public class BenchmarkStringStuff {

    public static void main(String[] args) {
        try {
            System.getProperties().store(System.out, "");
        } catch (IOException ioe ) {
            System.out.println("Failed to write properties to STDOUT");
            return;
        }

        BenchmarkStringStuff bss = new BenchmarkStringStuff();
        bss.benchmark(10);
        bss.benchmark(1000);
        bss.benchmark(100000);
        bss.benchmark(1000000);
    }

    public void benchmark(int numTests) 
    {
        Vector<Test> tests = new Vector<Test>();
        tests.add(new OriginalCode());
        tests.add(new TwoSearches());
        tests.add(new SearchOnceAndSubstring());

        Vector<String> testStrings = new Vector<String>();
        // we have a very poor sample, here.  You should test with a better 
        // representation of your expected values
        testStrings.add("aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa[time]aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa");

        Performance overallRuntime = new Performance("overall combined runtime");
        overallRuntime.setCount(numTests * testStrings.size() * tests.size());
        overallRuntime.start();
        for( Test test : tests )
        {
            Performance codePerformance = new Performance(test.getClass().getName());
            codePerformance.setCount(numTests * testStrings.size());
            codePerformance.start();
            for(String testString : testStrings)
            {
                //Performance stringPerformance = new Performance(testString);
                //stringPerformance.setCount(numTests);
                //stringPerformance.start();
                for(int i=0; i<numTests; i++)
                {
                    test.test(testString);
                }
                //stringPerformance.end();
                //System.out.println(stringPerformance.toString());
            }
            codePerformance.end();
            System.out.println(codePerformance.toString());
        }
        overallRuntime.end();
        System.out.println(overallRuntime.toString());
        System.out.println();

    }

    private static String getTime()
    { 
        return "a date"; 
        // static value to avoid any caching behavior - we
        // want to test the algorithm, not the external stuff.
        // you should use your real getTime method to see real numbers
        // for your application
    }

    private static String getName(){ return "a name"; }

    private interface Test {
        public String test(String in);
    }

    public class OriginalCode implements Test {

        public String test(String in)
        {
            in=in.replace("[time]",getTime()); //just some methods returning strings
            in=in.replace("[name]",getName());
            return in;
        }
    }

    public class TwoSearches implements Test {
        public String test(String in)
        {
            if (in.contains("[time]"))
            {
                in=in.replace("[time]",getTime());
            }
            return in;
        }
    }

    public class SearchOnceAndSubstring implements Test {
        public String test(String in)
        {
            String REPLACEME = "[time]";
            int idx = in.indexOf(REPLACEME);
            if( idx == 0 )
            {
                in=getTime() + in.substring(REPLACEME.length());
            }
            else if( idx > 0 )
            {
                in = in.substring(0,idx) + getTime();
                if( idx+REPLACEME.length() < in.length())
                {
                    in += in.substring(idx+REPLACEME.length());
                }
            }
            return in;
        }
    }

    private class Performance
    {
        long start = 0;
        long end = 0;
        String name = null;
        public int count = 0;

        public Performance(String name)
        {
            this.name = name;
        }

        public void start(){ start = System.currentTimeMillis(); }
        public void end() { end   = System.currentTimeMillis(); }
        public void setCount(int count){ this.count = count; } 

        /** be sure to call start & stop first **/
        public long total(){ return end - start; }

        public String toString()
        {
            return count + "cycles    start:"+start+"     end:"+end+"    total:"+total() + "   <---- " + name;
        }
    }
} 
```

以及运行此代码的结果（已编辑与性能无关的内容）......

```
#
#Thu Mar 14 18:45:37 EDT 2013
java.runtime.name=Java(TM) SE Runtime Environment
java.vm.version=20.5-b03
java.vm.vendor=Sun Microsystems Inc.
java.vendor.url=http\://java.sun.com/
java.vm.name=Java HotSpot(TM) Client VM
sun.java.launcher=SUN_STANDARD
sun.os.patch.level=Service Pack 1
java.vm.specification.name=Java Virtual Machine Specification
java.runtime.version=1.6.0_30-b12
os.arch=x86
java.vm.specification.vendor=Sun Microsystems Inc.
user.variant=
os.name=Windows 7
java.specification.name=Java Platform API Specification
java.class.version=50.0
sun.management.compiler=HotSpot Client Compiler
os.version=6.1
java.specification.version=1.6
java.class.path=REDACTED
java.vm.specification.version=1.0
sun.java.command=BenchmarkStringStuff
sun.arch.data.model=32
java.specification.vendor=Sun Microsystems Inc.
java.version=1.6.0_30
java.vendor=Sun Microsystems Inc.
sun.desktop=windows
sun.cpu.isalist=pentium_pro+mmx pentium_pro pentium+mmx pentium i486 i386 i86
10cycles    start:1363301137531     end:1363301137531    total:0   <---- BenchmarkStringStuff$OriginalCode
10cycles    start:1363301137531     end:1363301137531    total:0   <---- BenchmarkStringStuff$TwoSearches
10cycles    start:1363301137531     end:1363301137531    total:0   <---- BenchmarkStringStuff$SearchOnceAndSubstring
30cycles    start:1363301137531     end:1363301137531    total:0   <---- overall combined runtime

1000cycles    start:1363301137531     end:1363301137546    total:15   <---- BenchmarkStringStuff$OriginalCode
1000cycles    start:1363301137546     end:1363301137546    total:0   <---- BenchmarkStringStuff$TwoSearches
1000cycles    start:1363301137546     end:1363301137562    total:16   <---- BenchmarkStringStuff$SearchOnceAndSubstring
3000cycles    start:1363301137531     end:1363301137562    total:31   <---- overall combined runtime

100000cycles    start:1363301137562     end:1363301138108    total:546   <---- BenchmarkStringStuff$OriginalCode
100000cycles    start:1363301138108     end:1363301138451    total:343   <---- BenchmarkStringStuff$TwoSearches
100000cycles    start:1363301138451     end:1363301138499    total:48   <---- BenchmarkStringStuff$SearchOnceAndSubstring
300000cycles    start:1363301137562     end:1363301138499    total:937   <---- overall combined runtime

1000000cycles    start:1363301138499     end:1363301143663    total:5164   <---- BenchmarkStringStuff$OriginalCode
1000000cycles    start:1363301143663     end:1363301146784    total:3121   <---- BenchmarkStringStuff$TwoSearches
1000000cycles    start:1363301146784     end:1363301147190    total:406   <---- BenchmarkStringStuff$SearchOnceAndSubstring
3000000cycles    start:1363301138499     end:1363301147190    total:8691   <---- overall combined runtime 
```

获胜者是 SearchOnceAndSubstring，其速度始终比其他人快。

通过直接使用 char 数组可能还有其他优化，但我怀疑 SearchOnceAndSubstring 会非常接近，大部分时间都丢失在字符串连接上。我将把性能测试留给读者作为练习。

# php - php数据库插入函数

> ID：15420493
> 
> 赞同：0
> 
> 时间：2013-03-14T21:24:02.860
> 
> 标签：php, sql

我正在阅读 nettuts.com 上的一篇文章，它是关于构建 twitter 克隆的，代码中有一个函数可以将标准插入到数据库中。这是代码

```
 private function insert($table, $arr){

        $query = "INSERT INTO" . $table . " (";
        $pref = "";

        foreach ($arr as $key => $value) {
                $query .= $pref . $key;
                $pref = ", ";
            }
            $query .= ") VALUES (";
            $pref = "";
            foreach ($arr as $key => $value) {
                $query .= $pref. "'" . $value . "'";
                $pref = ", ";
            }
            $query = .= ");";
            return $this->db->query($query);
    } 
```

我无法理解的是 $pref 变量。有人可以向我解释它的目的吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T21:35:53.123

这是一种仅在值之间使用逗号的方式，`VALUES('like','this','and','this')` 因为`$pref`第一次它的值仍然设置为“”，并且键附加到`$query`它们将始终在值之前有一个逗号，除了第一个值：

```
 $query .= $pref . $key;
    $pref = ", "; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-14T21:36:44.843

代码中的愚蠢错误

```
$query = "INSERT INTO" . $table . " ("; 
```

INTO后需要空格

```
$query = "INSERT INTO " . $table . " (";
$query .= ") VALUES (";
$query  .= ");"; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-14T21:49:43.927

您还可以使用 implode() 函数[http://php.net/manual/en/function.implode.php](http://php.net/manual/en/function.implode.php)从 $arr 数组创建一个字符串！

```
 implode(", ", array_keys($arr)); 
```

# java - Vaadin 中的嵌入式推文

> ID：15420494
> 
> 赞同：1
> 
> 时间：2013-03-14T21:24:10.440
> 
> 标签：java, twitter, vaadin

我正在尝试在 Vaadin v7 中[嵌入](https://dev.twitter.com/docs/embedded-tweets)一条推文：

```
 Label oneTweet = new Label();

    String s = "<blockquote class=\"twitter-tweet\"><p>Four more years. <a href=\"http://t.co/bAJE6Vom\" title=\"http://twitter.com/BarackObama/status/266031293945503744/photo/1\">twitter.com/BarackObama/st…&lt;/a></p>&mdash; Barack Obama (@BarackObama) <a href=\"https://twitter.com/BarackObama/status/266031293945503744\">November 7, 2012</a></blockquote>";
    s = s + "<script async src=\"http://platform.twitter.com/widgets.js\" charset=\"utf-8\"></script>";

    oneTweet.setValue(s);
    oneTweet.setContentMode(ContentMode.HTML);

    layout.addComponent(oneTweet); 
```

问题是，Vaadin 没有获取脚本文件`widget.js`。我尝试通过将其放在 `@JavaScript( {"http://platform.twitter.com/widgets.js"} )` 源代码的开头来强制它。它拾取文件，但根本不设置嵌入推文的样式。我想知道以前是否有人这样做过。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T08:07:48.337

它是否适用于 ContentMode **Label.CONTENT_XHTML**或**Label.CONTENT_RAW**？想到的另一个猜测是将脚本包含在 gwt.xml 文件中，然后从标签中取出。祝你好运。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-18T22:36:58.613

如果其他人有同样的问题，我通过在加载推文结束时调用它来解决它：

```
 String script = "!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=\"http://platform.twitter.com/widgets.js\";fjs.parentNode.insertBefore(js,fjs);}}(document,\"script\",\"twitter-wjs\");";
    Page.getCurrent().getJavaScript().execute(script); 
```

javascript 片段来自[Twitter](https://dev.twitter.com/docs/embedded-tweets)的指南（疑难解答）。

# jquery - 跨域 iframe 脚本

> ID：15420496
> 
> 赞同：0
> 
> 时间：2013-03-14T21:24:30.497
> 
> 标签：jquery, html, iframe

我想在网络浏览器中模拟浏览器。我需要对 iframe 中加载的页面进行一些操作。我想在 id 属性中查找包含某些特定字符串的所有输入。例如，在 Id 属性中查找所有包含“url”的输入，并插入在数据库中定义的值（使用 javascript）。

我尝试使用 iframe，但我什至无法访问加载到 iframe 中的页面的 html。当我尝试这样做时，我收到错误“不安全的 JavaScript 尝试从带有 URLurlB 的框架访问带有 URL urlA 的框架。域、协议和端口必须匹配。我阅读了很多帖子，但没有找到解决问题的方法。我发现的唯一一件事是修改浏览器的安全策略，但我不能要求我的应用程序的每个用户都这样做。

我真的需要这样做，我将非常感谢每一个建议。

这是我的应用程序屏幕的链接，以更好地显示我想要做什么：[http ://scr.hu/0kos/9jxs6](http://scr.hu/0kos/9jxs6)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T21:27:14.647

[默认浏览器安全策略阻止您从与 javascript 所在页面的域不同的域中操作内容。您可以在 MDN 上](https://developer.mozilla.org/en-US/docs/JavaScript/Same_origin_policy_for_JavaScript)阅读“同源”安全限制。如果这就是您要尝试做的事情，那么您可能无法在正常配置的浏览器中执行此操作。

浏览器插件可以访问网页中的任何内容，但您的查看器必须先下载/安装插件，然后才能启用此功能。

在正常配置的浏览器中，您尝试从屏幕截图中执行的操作是不可能的，并且该限制有很好的安全原因。

# sql - 如何比较两个相同的sql表中的相似行

> ID：15420497
> 
> 赞同：0
> 
> 时间：2013-03-14T21:24:46.020
> 
> 标签：sql, database, oracle10g, plsqldeveloper

我有两个相同的表如下：

表格1

```
Student#|name|Course1#|Course2#|Course3#
456 abc 12  76  89
789 def 09  13  76
345 ghi 56  34  14 
```

表 2

```
Student#|name|Course1#|Course2#|Course3#
456 abc 12  76  89
789 def 90  13  76
345 ghi 56  34  14 
```

表 1 将包含最新数据，表 2 将保留表 1 的副本。表 2 每次更新表 1 后都会更新，我不希望完全截断和插入。我想触发一个查询，它将比较这两个表并仅返回值更改的那些行。基于这些值，我可以在表 2 中进行更新。

例如：在表 1 中，学生#789 的课程 1# 的值从 09 更改为 90，但表 2 仍然具有旧值。当我触发查询时，我应该得到如下结果：

```
Student#|name|Course1#|Course2#|Course3#
789 def 90  13  76 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T21:35:08.877

拥有相同数据的两个副本几乎没有意义，更不用说尝试保留两个数据副本并定期尝试使它们保持同步。所以这个前提似乎相当可疑。

听起来你正在寻找类似的东西

```
UPDATE table2 t2
   SET (course1, course2, course3) = (SELECT course1, course2, course3
                                        FROM table1 t1
                                       WHERE t1.student = t2.student)
 WHERE EXISTS( SELECT 1
                 FROM table1 t1
                WHERE t1.student = t2.student
                  AND (   t1.course1 != t2.course1
                       OR t1.course2 != t2.course2 
                       OR t1.course3 != t2.course3) ); 
```

这不会考虑任何一个表都有`NULL`值的情况。如果您想用非 NULL 值替换`NULL`in的值（如果可用），并假设 -1 不是该列的有效值，则子句中的谓词将更改为类似于.`table2``table1``EXISTS``t1.course1 != nvl(t2.course1, -1)`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T03:41:28.770

在 T1 上为 INSERT,DELETE,UPDATE 创建触发器，在触发器中将脏 KEYS/行放在另一个表中，然后定期检查脏跟踪表。或者在触发器中直接更新 T2。

# javascript - 如何在javascript中按空格分割字符串，除非“引号”之间出现空格？

> ID：15420504
> 
> 赞同：5
> 
> 时间：2013-03-14T21:25:21.027
> 
> 标签：javascript, regex, arrays, string, split

最终我试图改变这个：

```
var msg = '-m "this is a message" --echo "another message" test arg'; 
```

进入这个：

```
[
    '-m',
    'this is a message',
    '--echo',
    'another message',
    'test',
    'arg'
] 
```

我不太确定如何解析字符串以获得所需的结果。这是我到目前为止所拥有的：

```
var msg = '-m "this is a message" --echo "another message" test arg';

// remove spaces from all quoted strings.
msg = msg.replace(/"[^"]*"/g, function (match) {
    return match.replace(/ /g, '{space}');
});

// Now turn it into an array.
var msgArray = msg.split(' ').forEach(function (item) {
    item = item.replace('{space}', ' ');
}); 
```

我认为这会奏效，但男人这样做似乎是一种反复无常和倒退的方式来完成我想要的。我相信你们有比在拆分之前创建占位符字符串更好的方法。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-14T23:13:37.373

使用 exec()，您可以使用不带引号的字符串：

```
var test="once \"upon a time\"  there was   a  \"monster\" blue";

function parseString(str) {
    var re = /(?:")([^"]+)(?:")|([^\s"]+)(?=\s+|$)/g;
    var res=[], arr=null;
    while (arr = re.exec(str)) { res.push(arr[1] ? arr[1] : arr[0]); }
    return res;
}

var parseRes= parseString(test);
// parseRes now contains what you seek 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-14T21:46:14.510

而不是 a `split`，您可以`match`：

```
var msg = '-m "this is a message" --echo "another message" test arg';
var array = msg.match(/"[^"]*"|[^\s"]+/g);
console.log(array); 
```

产生：

```
['-m',
  '"这是一条消息"',
  ' - 回声'，
  '"另一条消息"',
  '测试'，
  'arg']
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-14T21:40:54.477

很难猜测您更喜欢什么作为解决方案，但一种方法是用引号分割（假设没有嵌套引号），然后用空格分割每个备用项：

```
result = [];
msg.split("\"").map(function(v, i ,a){
    if(i % 2 == 0) {
        result = result.concat(v.split(" ").filter(function(v){
            return !v;
        }));
    } else {
        result.push(v);
    }
}); 
```

这是一个演示：http: [//jsfiddle.net/eL7cc/](http://jsfiddle.net/eL7cc/)

# node.js - node.js 中间件和 js 封装

> ID：15420505
> 
> 赞同：2
> 
> 时间：2013-03-14T21:25:22.553
> 
> 标签：node.js, express, middleware

我是 javascript 新手，直接进入 node.js。我已经阅读了很多理论，并且从实用方面开始（我正在为移动应用程序编写 API），但是我有一个基本问题，这导致我使用中间件。我已经成功实现了一个中间件功能，但是我想知道我给出的中间件想法的使用是否可以，并且也解决了最初将我带到中间件的问题。我的问题有两个，如下：

1）据我所知，使用中间件的想法是在实际处理请求之前重复一个过程。我用它来验证令牌，如下：我的只有一个url没有收到令牌参数，所以

应用程序.js

```
app.get('/settings', auth.validateToken, auth.settings); 
```

auth.js

```
function validateToken(req, res, next){ //code }; 
```

在 validateToken 中，我的代码检查令牌，如果一切正常，则调用 next()，或者将 res 修改为 json 以返回特定的错误代码。
我对此的问题是：a）这是对中间件的正确使用吗？b) 是否有 [正确] 将值传递给下一个函数的方法？不是仅在一切正常的情况下才调用 next ，是否有一种 [正确的] 方法可以调用 next 任何一种方式，并从 next 函数（无论它是什么）内部知道中间件是否成功？如果有，这是否是对中间件的正确使用？这一点让我想到了我原来的问题，以及这个问题的第二部分，即封装函数：

这部分已修复，请参阅[我的第二条评论](https://stackoverflow.com/questions/15420505/node-js-middleware-and-js-encapsulation#comment21814036_15420505)。
2) 我发现中间件试图简单地封装 validateToken，并且能够从 get 处理程序指向的函数内部调用它，例如 auth.settings。我习惯于常见的顺序编程，而不是使用 javascript，考虑到 node.js 的基于事件的性质，我一生都无法理解如何做到这一点。
我现在要做的是编写一个简单地验证用户和密码的函数。我把它完美地写在一个特定的处理程序中，但正要复制粘贴到另一个处理程序，所以我停了下来。我想从头开始以正确的方式做事，并了解 node.js。我遇到的一个具体问题是，当用户和密码不匹配时我必须返回的错误代码因父函数而异，所以我需要这个函数才能告诉回调函数“嘿，密码和用户不匹配”，所以我可以从父函数中回复正确的消息。
我*想*我真正想要的是编写一个可以从另一个内部调用的异步函数。

我希望我已经很清楚了，我一直在尝试自己解决这个问题，但是我无法完全理解我的实际问题是什么，我猜这是由于我最近对 ​​node.js 的介绍。 js*和*js。提前致谢！詹妮弗。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-16T17:08:45.163

1) 有 res.locals 对象 ( [http://expressjs.com/api.html#res.locals](http://expressjs.com/api.html#res.locals) ) 旨在存储请求本地的数据并将它们从一个中间件传递到另一个中间件。处理请求后，此对象将被处置。如果要在会话中存储数据，可以使用 req.session。

2）如果我理解你的问题，你想要一个函数将响应异步传递给调用者。您可以按照大多数节点功能的设计方式来执行此操作。

您以这种方式定义一个函数：

```
function doSomething(parameters, callback) {
    // ... do something

    // if (errorConddition()) err = errorCode();

    if (callback) callback(err, result)
} 
```

并且调用者不使用函数的返回值，而是将回调传递给该函数：

```
function caller(req, res, next) {
   //... 

   doSomething(params, function(err, result) {

       if (! err && result) {
           // do something with the result
           next();
       } else {
           // do something else

           next();

           // or even res.redirect('/error');
       }
   });

} 
```

如果您发现自己编写了类似的回调函数，您应该将它们定义为函数并将函数作为参数传递：

```
//...

doSomething(param, processIt);

function processIt(err, result) {
   // ...
} 
```

让您感到困惑的可能是您还没有将函数视为值，这是 JavaScript 特有的（不包括很少使用的语言）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-15T06:03:19.600

在 validateToken 中，我的代码检查令牌，如果一切正常，则调用 next()，或者将 res 修改为 json 以返回特定的错误代码。

a) 这是对中间件的正确使用吗？b) 是否有 [正确] 将值传递给下一个函数的方法？

是的，这是使用中间件的正确方法，尽管根据响应消息类型和规范，您可以使用 connect 的内置错误处理。在本例中，通过调用 next({status:401,stack:'Unauthorized'}); 生成 401 状态码。

中间件系统旨在通过一系列函数处理请求，直到一个函数回复请求。这就是为什么下一个函数只接受一个参数是错误的

-> 如果将错误对象传递给下一个函数，则它将用于创建响应，并且不会处理进一步的中间件。创建错误响应的方式如下

```
 // default to 500
    if (res.statusCode < 400) res.statusCode = 500;
    debug('default %s', res.statusCode);

    // respect err.status
    if (err.status) res.statusCode = err.status;

    // production gets a basic error message
    var msg = 'production' == env
      ? http.STATUS_CODES[res.statusCode]
      : err.stack || err.toString(); 
```

-> 将值传递到修改请求对象的中间件堆栈是最好的方法。这确保了所有处理都绑定到该特定请求，并且由于请求对象通过每个中间件函数，因此这是将信息向下传递到堆栈的好方法。

# iphone - 管理多个 UILocal 通知

> ID：15420507
> 
> 赞同：2
> 
> 时间：2013-03-14T21:25:28.850
> 
> 标签：iphone, ios, objective-c, xcode, uilocalnotification

我创建了多个 UI 本地通知，例如 100 个。我有一组 UILocalNotifications，它们被安排为：

```
 -(void) scheduleNotification{
    AppDelegate *delegate = (AppDelegate *)[[UIApplication sharedApplication] delegate];
    NSDateFormatter *formatter = [[NSDateFormatter alloc]init];
    [[UIApplication sharedApplication] cancelAllLocalNotifications];
    [self.notifications removeAllObjects];
    for (int i = 0; i< [delegate.viewController.contactList count] ; i++) {
        UILocalNotification *localNotification = [[UILocalNotification alloc] init];
        NSString *name = [[delegate.viewController.contactList objectAtIndex:i]objectForKey:NAME_KEY];
        NSString *birthday = [[delegate.viewController.contactList objectAtIndex:i]objectForKey:BIRTHDAY_KEY];
        if (birthday) {
            [formatter setDateFormat:@"MM/dd/yyyy"];
            [formatter setLocale:[NSLocale currentLocale]];
            [formatter setTimeZone:[NSTimeZone systemTimeZone]];
            NSDate *date = [formatter dateFromString:birthday];
            if (date == nil) {
                [formatter setDateFormat:@"MM/dd"];
                [formatter setLocale:[NSLocale currentLocale]];
                [formatter setTimeZone:[NSTimeZone systemTimeZone]];
                date = [formatter dateFromString:birthday];
            }
            NSCalendar *gregorianEnd = [[NSCalendar alloc] initWithCalendarIdentifier:NSGregorianCalendar];
            NSDateComponents *componentsEnd = [gregorianEnd components:NSWeekdayCalendarUnit | NSYearCalendarUnit | NSMonthCalendarUnit | NSDayCalendarUnit fromDate:date];

            componentsEnd.year = [[NSDate date] year];
            date = [gregorianEnd dateFromComponents:componentsEnd];
            self.alarmTime = [date dateByAddingTimeInterval:self.mTimeInterval];
            localNotification.fireDate = _alarmTime;
            localNotification.timeZone = [NSTimeZone defaultTimeZone];
            localNotification.applicationIconBadgeNumber = 1;

            NSString *itemName = @"B'day Alert!!!";
            NSString *msgName = [NSString stringWithFormat:@"Celebrate %@'s B'day",name];
            NSDictionary *userDict = [NSDictionary dictionaryWithObjectsAndKeys:itemName,MessageKey, msgName,TitleKey, nil];
            localNotification.userInfo = userDict;
            localNotification.soundName = self.soundName;
            localNotification.alertBody = [NSString stringWithFormat:@"Celebrate %@'s B'day",name];

            [self.notifications addObject:localNotification];
            } 
        }
    }
} 
```

我已将我的`applicationDidEnterBackground`代表实现为：

```
 - (void)applicationDidEnterBackground:(UIApplication *)application
{

    UILocalNotification* notification;

    for (int i = 0; i< [self.settingVC.notifications count]; i++) {

        notification = [self.settingVC.notifications objectAtIndex:i];
        [[UIApplication sharedApplication] scheduleLocalNotification:notification];
    }

} 
```

另外，在`didReceiveLocalNotification`委托中，我有这个：

```
 - (void)application:(UIApplication *)application
didReceiveLocalNotification:(UILocalNotification *)notification
{
    NSString *itemName = [notification.userInfo objectForKey:TitleKey];
    NSString *messageTitle = [notification.userInfo objectForKey:MessageKey];
    [self _showAlert:itemName withTitle:messageTitle];
    application.applicationIconBadgeNumber = notification.applicationIconBadgeNumber-1;
} 
```

但问题是我没有得到想要的输出。任何帮助将不胜感激。我知道在一个应用程序中只能有有限数量的预定通知；系统保留最快触发的 64 条通知并丢弃其余通知。那么，我将如何处理那 100 个或更多的 UILocalNotification？

# c# - 在类中创建一个类并从数据库返回数据

> ID：15420511
> 
> 赞同：0
> 
> 时间：2013-03-14T21:25:41.647
> 
> 标签：c#

我在一个类中创建了一个类，因此它可以替代编写调用数据库的 3 个不同方法 - 所以我创建了一个包含相关项目的类，现在当我尝试构建时，我得到错误 `Cannot implicity convert type System.collections.generic.list<anonymousType#1> to class that i created StudentDocuments` ，当我点击错误时将我引向`return subs`声明。

```
public class  StudentDocuments
    {
        public Guid DocID {get; set;}
        public string Assignment {get; set;}
        public DateTime Submitted {get; set;}
        public string Student {get;set;}
    }

public StudentDocuments GetStudentSubmissionGrid(Guid usr, Guid lib)
    {
        using (var dc = new DocMgmtDataContext())
        {
            var subs = (from doc in dc.Documents
                        join u in dc.Users on doc.OwnedByUserID equals u.ID
                        where doc.OwnedByUserID == usr && doc.LibraryID == lib
                        select new { 
                            DocID = doc.ID, 
                            Assignment = doc.Library.Name, 
                            Submitted = doc.UploadDT,
                            Student = u.FullName
                        })
                .OrderByDescending(c => c.Submitted).ToList();
            return subs;
        }
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-14T21:27:23.733

您创建匿名类型的 LINQ。相反，您必须根据您的返回类型创建特定类型的对象列表。

用这个：

```
select new StudentDocuments{ 
                               DocID = doc.ID, 
                               Assignment = doc.Library.Name, 
                               Submitted = doc.UploadDT,
                               Student = u.FullName
                           } 
```

并将您的方法声明为：

```
public List<StudentDocuments> GetStudentSubmissionGrid(Guid usr, Guid lib) 
```

您也可以返回`IEnumerable<StudentDocuments>`而不是列表。

**更新**

```
var subs = (from doc in dc.Documents
                    join u in dc.Users on doc.OwnedByUserID equals u.ID
                    where doc.OwnedByUserID == usr && doc.LibraryID == lib
                    orderby doc.UploadDT descending
                    select new StudentDocuments
                     { 
                        DocID = doc.ID, 
                        Assignment = doc.Library.Name, 
                        Submitted = doc.UploadDT,
                        Student = u.FullName
                     }).AsEnumerable().ToList(); 
```

# windows - 在 Windows 中使用 Cygwin 对文件进行排序

> ID：15420516
> 
> 赞同：0
> 
> 时间：2013-03-14T21:26:03.247
> 
> 标签：windows, sorting, scripting, cygwin, rating

我有一个包含数千条啤酒评论的文件，我需要对其进行排序。每个啤酒评论看起来像这样：

```
beer/name: John Harvards Simcoe IPA
beer/beerID: 63836
beer/brewerID: 8481
beer/ABV: 5.4
beer/style: India Pale Ale (ITA)
review/appearance: 4/5
review/aroma: 6/10
review/palate: 3/5
review/taste: 6/10
review/overall: 13/20
review/time: 11575857200 
```

我需要对评论数量最多的前 10 种啤酒进行排序。啤酒标识符“啤酒/名称”。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T21:55:12.430

听起来像是一个家庭作业，但无论如何（我喜欢啤酒），这是一个[awk 开胃](/questions/tagged/awk "显示标记为“awk”的问题") **菜**：

```
awk -F'[ /]' -v note=20 '
    /^beer\/name:/{$1=$2="";beer=$0}
    /^review/ && !/review\/time/{arr[beer]+=$3/$4; count++}
    END{for (a in arr) print a, arr[a]*note/count "/" note}
' beers.txt 
```

从这里很容易将输出传递到`sort`&`head`命令以对特定列进行排序并分别从顶部显示 N 行。（或者使用`awk`自己，但它更难......）

# sql - Left Join 右表的 Count = 1

> ID：15420520
> 
> 赞同：-1
> 
> 时间：2013-03-14T21:26:34.013
> 
> 标签：sql, sql-server-2008, duplicate-removal

表格1：

```
ID     Values
1      1
2      2
3      3
4      4 
```

表 2：

```
ID    Values
1     1
1     2
1     2
2     4
4     5
4     6 
```

我需要一个结果：

```
ID    Table 1 Values    Table 2 Values
1     1                 1
2     2                 4
3     3                         *This is blank because Table 2 doesn't have ID 3
4     4                 5
4     4                 6 
```

注意表 2 中重复值（ID 1 和值 2）的行的排除。然而，ID 4 的 2 行是因为表 2 中 ID 4 的两个值都没有重复性。

所以这是一个左连接，我只想要表 2 中的值，该值不重复，并且 ID 与表 1 中的 ID 匹配。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-14T21:31:22.133

在表 2 上使用 CTE，然后将其用作左连接的右侧：

```
WITH t2 AS (
    SELECT ID, Values FROM [Table 2]
    GROUP BY ID, Values
    HAVING COUNT(*) = 1
)
SELECT t1.ID, t1.Values [Table 1 Values], t2.Values [Table 2 Values]
    FROM [Table 1] t1
    LEFT JOIN t2 ON t1.ID = t2.ID 
```

# svn - svn-忽略除某些文件夹以外的所有内容

> ID：15420522
> 
> 赞同：0
> 
> 时间：2013-03-14T21:26:41.897
> 
> 标签：svn

除了 svn-ignore 模式中的特定子文件夹之外，是否可以忽略文件夹的所有内容？

我读过你可以使用 ! 但我无法让这个 *[!dir/] 工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2018-10-30T07:45:26.147

有可能，您应该否定一个字符而不是字符串。例如，如果你想忽略除“abc”和“def”之外的所有文件夹，忽略模式应该是这样的：

```
[!a&!d]*
a[!b]*
ab[!c]*
d[!e]*
de[!f]* 
```

*   第一行忽略不以“a”和“d”开头的任何内容。
*   第二行忽略以“a”开头但不以“ab”开头的任何内容。
*   第三行忽略以“ab”开头但不以“abc”开头的任何内容。
*   第 4 行忽略以“d”开头但不以“de”开头的任何内容。
*   第 5 行忽略以“de”开头但不以“def”开头的任何内容。

# c# - AutoMapper 行为随 POST 改变

> ID：15420539
> 
> 赞同：0
> 
> 时间：2013-03-14T21:27:59.483
> 
> 标签：c#, asp.net-mvc, nhibernate, automapper

我有一个使用继承的复杂对象，我使用自动映射器映射它，它在获取请求期间完美映射，但在发布请求期间，***完全相同的***代码无法正确映射初始化的类型。

让我解释。（见下面的代码）

在第一种情况下，当我在简单的 get 请求期间映射对象时，它映射得非常好，并且下面`Parent`类的属性`A`是其特定类型`B`或`C`.

但是当在帖子中发生***完全相同的***映射时，`Parent`属性的`A`类型是`A`!??

现在，代码是一样的，从数据库返回的数据模型是一样的。（我使用 nhibernate - 类型如我所料）唯一的区别是它是一个发布请求？！

在这种情况下，我应该了解 AutoMapper 吗？

类定义（ViewModel 遵循相同的结构）：

```
public class A 
{
    public A Parent { get; set;}
}

public class B : A 
{ }

public class C : A 
{ } 
```

并像这样映射：

```
CreateMap<A, AViewModel>()  
    .Include<B, BViewModel>()
    .Include<C, CViewModel>();

CreateMap<B, BViewModel>();
CreateMap<C, CViewModel>(); 
```

调用地图：

```
var aModel = _aManager.Get("same parameter");
var aViewModel = Mapper.Map<AViewModel>(aModel); 
```

`in`编辑 #1 - 这描述了 post Action的逻辑：

```
 [Transaction] // Commits the nhibernate transaction on OnActionExecuted
    [HttpPost]
    public ActionResult UpdateA(OtherModelViewModel viewModel)
    { 
        var a = _aManager.Get("same parameter");

        var otherModel = Mapper.Map<OtherModel>(viewModel); 

        a.AddOtherModel(otherModel);
        _otherModelRepository.New(otherModel);

        // Eeek, writing this out I am seeing a problem here, I suspect this is where my problem would be, loading the model again from the db, after updating it in session without commiting it? I am going to change the logic and see if it fixes it.

        var aModel = _aManager.Get("same parameter");
        var aViewModel = Mapper.Map<AViewModel>(aModel);

        // return result.
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T22:16:46.143

抱歉，我太傻了，让复杂性占了上风。

我使用事务属性将信息保存在 OnActionExecuted 中。

所以我正在做的是>加载模型>修改它>然后再次加载它并尝试在它被持久化之前映射它。

我知道当你尝试做这样的事情时 nHibernate 真的不喜欢它，所以我认为内存中的对象图处于不断变化的状态（待提交），这会影响映射。

我已经更改了我的逻辑，宁愿在更新后执行 ActionRedirect，这已经解决了映射问题。

周围更快乐。

# xpages - xpage 在保存/提交时创建保存冲突

> ID：15420540
> 
> 赞同：1
> 
> 时间：2013-03-14T21:28:02.870
> 
> 标签：xpages

我有一个 xpage，在提交对现有文档的编辑时，每次单击提交按钮时都会创建保存冲突。我是目前唯一可以访问此应用程序的人，所以我知道没有任何其他用户也在保存。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-16T13:59:04.900

当我将文档数据源附加到我在该 xpage 中使用的多个自定义控件时，我注意到了这一点。当执行保存文档简单操作时，它一直导致保存冲突。

# javascript - 在 Javascript 中验证我的 HTML 表单？

> ID：15420544
> 
> 赞同：-3
> 
> 时间：2013-03-14T21:28:10.593
> 
> 标签：javascript, html, web

我有一个用户名表格。其中有2个字段，用户名和密码。基本上用户一直在尝试输入他们的电子邮件地址来登录，这很痛苦，因为我只希望他们使用他们的用户名而不是电子邮件登录。

所以我需要它，所以如果用户试图将他们的电子邮件地址放在用户名字段中，它将显示一个错误，如“使用您的用户名，而不是电子邮件登录”。场下。例如

如果用户在字段中输入“myemail@test.com”并按提交，则会出现错误。

我目前也有一个“必填字段”验证。

这是代码：

JS：

```
 <script type="text/javascript">
  function validar()
  {
     var right = 1;

     if(document.getElementById('email').value.length==0)
     {
        right = 0;
        document.getElementById('emptymail').innerHTML = "Fill in the required fields";
     }
     if(document.getElementById('password').value.length==0)
     {
        right = 0;
        document.getElementById('emptypass').innerHTML = "Fill in the required fields";
     }

    if(right == 1)
    {
      document.forms["formu"].submit();
    }

  }
  </script> 
```

形式：

```
<div id="sessionContainer" class="clearfix">
  <div class="content">
     <form action="goto.php" class=" sign-in" method="post" name="formu" id="formu">
      <div style="margin:0;padding:0"></div>
      <h3>Please login</h3>
      <div class="clearfix">
        <label for="">Username</label><br>
        <input class="xlarge" id="email" name="email" tabindex="1" type="text" value="" /><div id="emptymail"></div>
      </div>
      <div class="clearfix">
        <label for=""><br>
          Password</label><br>
        <input class="xlarge" id="password" name="password" tabindex="2" type="password" value="" /><div id="emptypass"></div>
      </div>

      <p class="remember">&nbsp;</p>
      <p class="remember">
        <button class="btn btn-m btn-blue" id="signin_submit" name="commit" type="button" tabindex=5 onclick="validar();">Sign in</button>
      </p> 
```

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-14T21:41:48.897

首先，将不应包含电子邮件地址的用户名字段命名为“电子邮件”非常棒。反正。

```
function validar()
{
    if(document.getElementById('email').value.length==0)
    {
       document.getElementById('emptymail').innerHTML = "Fill in the required fields";
       return;
    }
    if(document.getElementById('password').value.length==0)
    {
       document.getElementById('emptypass').innerHTML = "Fill in the required fields";
       return;
    }
    var x=document.getElementById('email').value;
    var atpos=x.indexOf("@");
    var dotpos=x.lastIndexOf(".");
    if ( !(atpos<1 || dotpos<atpos+2 || dotpos+2>=x.length) )
    {
        document.getElementById('email').focus();
        document.getElementById('emptymail').innerHTML = "Use your username, not email to login";
        return;
    }

    document.forms["formu"].submit();

} 
```

那应该这样做。

# c++ - 避免成员变量的默认构造函数

> ID：15420547
> 
> 赞同：0
> 
> 时间：2013-03-14T21:28:21.800
> 
> 标签：c++, default-constructor

我有一个带有另一个类的成员变量的类：

```
class MeasurementUnit {
private:
    MeasurementMultiplier _multiplier; 
```

实际上我不需要默认构造函数`MeasurementMultiplier`，因为实际上我将使用参数进行初始化`MeasurementMultiplier(a,b,c)`，而且我会 - 但不能直接：

```
C2864: 'MeasurementUnit::_multiplier' :
only static const integral data members can be initialized within a class 
```

所以我需要默认构造函数，没有它不会编译`error: C2512: 'MeasurementUnit' : no appropriate default constructor available`

我可以避免需要默认构造函数吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-14T21:31:37.263

在您的类的所有构造函数中`MeasurementUnit`，您需要`_multiplier`在初始化列表中初始化成员变量。例子：

```
MeasurementUnit::MeasurementUnit()
  : _multiplier(1,2,3)
{} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-14T21:33:55.993

使用 MIL - 成员初始化列表 [MIL](https://www.google.co.il/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&cad=rja&sqi=2&ved=0CCsQFjAA&url=https://stackoverflow.com/questions/926752/why-should-i-prefer-to-use-member-initialization-list&ei=KEJCUfmzM4GftAbVwIHQDQ&usg=AFQjCNGKHJWkHUw40zqaeQW0pptgwS0_HA&bvm=bv.43287494,d.Yms)

# sass - @if 在带有或条件的 sass 中状态

> ID：15420551
> 
> 赞同：0
> 
> 时间：2013-03-14T21:28:44.247
> 
> 标签：sass

有可能做这样的事情吗？

```
if(x == y || x == z) {
stuff
} 
```

我试过这个

```
@if padding-l == x || padding-r == x{
    padding: 0;
} 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-14T22:36:37.990

```
$padding-l: y;
$padding-r: x;

h1 {
  @if $padding-l == x or $padding-r == x {
    padding: 0;
  }
} 
```

# java - 主题的不同布局目录

> ID：15420552
> 
> 赞同：1
> 
> 时间：2013-03-14T21:28:46.147
> 
> 标签：java, android, android-layout, android-theme

我希望我的应用程序有主题。是否可以在我的 android 应用程序中创建默认布局、蓝色布局、红色布局目录等？还是不同的 res 目录，如 res-default、res-blue 等？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-14T22:04:30.580

除了按大小或方向之外，您不能为不同的样式制作单独的布局，如此[处](http://developer.android.com/guide/practices/screens_support.html)所述。这给出了您可以使用的不同布局的完整列表。

为了做您想做的事情，并拥有红色布局、蓝色布局和其他布局，您将使用应用程序主题，它允许您根据需要设置所有布局的样式，如此[处](http://developer.android.com/guide/topics/ui/themes.html)所述。

首先，您将在`styles.xml`. 这些是基本的，但您可以进行的自定义数量没有尽头。

```
<style name="RedTheme" parent="android:Theme.Light">
    <item name="android:windowBackground">#ff0000</item>
</style>

<style name="BlueTheme" parent="android:Theme.Light">
    <item name="android:windowBackground">#0000ff</item>
</style> 
```

然后，我们在`onCreate`您的活动方法中引用它们，然后再设置`contentView`.

```
public void onCreate(Bundle savedInstanceState) {
setTheme(R.style.BlueTheme);
super.onCreate(savedInstanceState);
setContentView(R.layout.activity_main);
} 
```

您可以保存选择的主题`SharedPreferences`并从那里引用它，或者只是手动为每个`Activity`. 主题也可以`Activity`在您的`Manifest`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-14T21:44:44.460

答案是不。您不能创建自己的文件夹层次结构。但根据您的问题，您似乎想要创建具有不同颜色主题的不同布局，以便您可以轻松创建不同的样式或主题并使用它们。有关更多信息，请查看此[链接](http://developer.android.com/guide/topics/ui/themes.html)

# c# - 如何在C#中按可变数量的字符分割字符串

> ID：15420554
> 
> 赞同：-3
> 
> 时间：2013-03-14T21:29:00.713
> 
> 标签：c#, split

我从串行端口读取数据，我想将此数据拆分为较小的数字示例：

```
 String  inputData = "3032592556231055126395692345723465234578235698"

        output : data1 = "30325925562"
                 data2 = "31055126395"
                 data3 = "692345723"
                 data4 = "465234578"
                 data5 = "235"
                 data6 = "698" 
```

这正是我想做的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T21:32:52.967

采用

```
string part = new string(inputString.Skip(12).Take(12).ToArray()); 
```

您可以用一个或两个变量替换 12

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-14T21:44:42.427

假设`data1`and`data2`将始终保持 11 位`data3`和`data4`9 位，依此类推，也许使用 a`System.Text.RegularExpression.Regex`将帮助您实现您想要的（不使用`SubString`）

```
Regex regex = new Regex("(\d{11})(\d{11})(\d{9})(\d{9})(\d{3})(\d{3})");
Match match = regex.Match(inputData);

if (match == Match.Empty)
    // Your inputData did not match the Regex, decide what to do here

data1 = match.Groups[1];
data2 = match.Groups[2];
// etc. 
```

我承认，这不是最漂亮的解决方案。

# multithreading - fork 的 Haskell 类型错误最后我无法解决

> ID：15420555
> 
> 赞同：0
> 
> 时间：2013-03-14T21:29:01.740
> 
> 标签：multithreading, haskell, network-programming

除了我遇到的错误，任何关于我所做的事情有多糟糕的提示都将不胜感激。

所以我会粘贴代码，有点；但我认为这基本上是正确的，我只是无法让 forkFinally 进行类型检查*......*

错误出现在唯一调用 forkFinally 的行上：

> ```
> Ambiguous type variable `e0' in the constraint:
>   (Exception e0) arising from a use of `forkFinally'
> Probable fix: add a type signature that fixes these type variable(s)
> In a stmt of a 'do' block:
>   t <- forkFinally (echoHandler a) (exitPool p)
> In the expression:
>   do { a <- accept s;
>        t <- forkFinally (echoHandler a) (exitPool p);
>        atomically
>        $ do { p' <- readTVar p;
>               writeTVar p (t : p') };
>        repeatAccept s p }
> In an equation for `repeatAccept':
>     repeatAccept s p
>       = do { a <- accept s;
>              t <- forkFinally (echoHandler a) (exitPool p);
>              atomically
>              $ do { p' <- readTVar p;
>                     .... };
>              .... } Failed, modules loaded: none. 
> ```

这是代码：

```
type ConnectionHandler = (Handle, HostName, PortNumber) -> IO ()
type Pool = TVar [ThreadId]

runConn = do
  s <- withSocketsDo (listenOn (PortNumber 1234))
  p <- atomically (newTVar ([]::[ThreadId]))
  t <- forkIO (repeatAccept s p)
  repeatUntilExit stdin stdout putChar ""
  p' <- atomically (readTVar p)
  mapM killThread (t:p')

repeatAccept s p = do
  a <- accept s
  t <- forkFinally (echoHandler a) (exitPool p) -- Error here, forkIO instead compiles fine.. (and I guess actually should work just fine too?)
  atomically $ do
    p' <- readTVar p
    writeTVar p (t:p')
  repeatAccept s p

exitPool :: Pool -> a -> IO ()
exitPool pool = \_ -> do
  tid <- myThreadId
  atomically $ do
    pool' <- readTVar pool
    writeTVar pool $ filter (/=tid) pool'
    return ()

echoHandler :: ConnectionHandler
echoHandler a@(hdl,_,_) = repeatUntilExit hdl hdl echoToHandleAndStdout ""
  where echoToHandleAndStdout x = hPutChar hdl x >> putChar x

repeatUntilExit :: Handle -> Handle -> (Char -> IO ()) -> [Char] -> IO ()
repeatUntilExit hIn hOut f "exit\n" = hPutStrLn hOut "bye\n"
repeatUntilExit hIn hOut f x = hGetChar hIn >>= \c -> f c >> repeatUntilExit hIn hOut f (appendToLastFive c)
  where appendToLastFive a = (reverse . (:)a . take 4 . reverse) x

forkFinally :: Exception e => IO a -> (Either e a -> IO ()) -> IO ThreadId
forkFinally action and_then =
  mask $ \restore ->
    forkIO $ try (restore action) >>= and_then 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-14T21:42:23.377

[`forkFinally`](http://hackage.haskell.org/packages/archive/base/4.6.0.0/doc/html/Control-Concurrent.html#v%3aforkFinally)在最新的 Control.Concurrent 中键入签名：

```
forkFinally :: IO a -> (Either SomeException a -> IO ()) -> IO ThreadId 
```

`forkFinally`在您的代码中键入签名：

```
forkFinally :: Exception e => IO a -> (Either e a -> IO ()) -> IO ThreadId 
```

您试图概括异常类型。如果异常类型可以从`forkFinally`的第二个参数推导出来，这不是问题。但这是`forkFinally`的第二个参数：

```
exitPool p :: a' -> IO () 
```

类型检查器试图统一`Either e a -> IO ()`并`a' -> IO ()`最终无法推断出是什么`e`。

一般解决方案：指定显式类型。例如

```
t <- forkFinally (echoHandler a) (exitPool p :: Either SomeException () -> IO ()) 
```

更好的具体解决方案：将原始类型签名恢复为`forkFinally`. 只捕获一组有限的异常似乎没有意义。

# jquery - 追加方法后Jquery单击事件不起作用

> ID：15420558
> 
> 赞同：91
> 
> 时间：2013-03-14T21:29:15.117
> 
> 标签：jquery, html

所以我有这个按钮，它向表中添加了一个新行，但是我的问题是它`.new_participant_form`在 append 方法发生后不再监听 click 事件。

[http://jsfiddle.net/cTEFG/](http://jsfiddle.net/cTEFG/)

单击添加新条目，然后单击表单名称。

```
$('#add_new_participant').click(function() {

    var first_name = $('#f_name_participant').val();
    var last_name = $('#l_name_participant').val();
    var role = $('#new_participant_role option:selected').text();
    var email = $('#email_participant').val();

    $('#registered_participants').append('<tr><td><a href="#" class="new_participant_form">Participant Registration</a></td><td>'+first_name+ ' '+last_name+'</td><td>'+role+'</td><td>0% done</td></tr>');

    });

    $('.new_participant_form').click(function() {

        var $td = $(this).closest('tr').children('td');

        var part_name = $td.eq(1).text();
        alert(part_name);

    });
}); 
```

## HTML

```
<table id="registered_participants" class="tablesorter">

<thead>
<tr> 
<th>Form</th>
<th>Name</th>
<th>Role</th>
<th>Progress </th>

</tr> 
</thead>

<tbody>
<tr> 
<td><a href="#" class="new_participant_form">Participant Registration</a></td>
<td>Smith Johnson</td>
<td>Parent</td>
<td>60% done</td>

</tr> 
</tbody>

</table>

<button id="add_new_participant"></span>Add New Entry</button> 
```

* * *

## 回答 #1

> 赞同：229
> 
> 时间：2013-03-14T21:30:46.397

用于：[_](http://api.jquery.com/on/)

```
$('#registered_participants').on('click', '.new_participant_form', function() { 
```

这样点击就会被委托给任何`#registered_participants`具有 class 的元素`new_participant_form`，即使它是在您绑定事件处理程序之后添加的。

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2013-03-14T21:32:14.643

该[`.on()`方法](http://api.jquery.com/on/)用于将事件委托给动态添加或已存在于 DOM 中的元素：

```
// STATIC-PARENT              on  EVENT    DYNAMIC-CHILD
$('#registered_participants').on('click', '.new_participant_form', function() {

  var $td = $(this).closest('tr').find('td');
  var part_name = $td.eq(1).text();
  console.log( part_name );

});

$('#add_new_participant').click(function() {

  var first_name = $.trim( $('#f_name_participant').val() );
  var last_name  = $.trim( $('#l_name_participant').val() );
  var role       = $('#new_participant_role').val();
  var email      = $('#email_participant').val();

  if(!first_name && !last_name) return;

  $('#registered_participants').append('<tr><td><a href="#" class="new_participant_form">Participant Registration</a></td><td>' + first_name + ' ' + last_name + '</td><td>' + role + '</td><td>0% done</td></tr>');

});
```

```
<table id="registered_participants" class="tablesorter">
  <thead>
    <tr>
      <th>Form</th>
      <th>Name</th>
      <th>Role</th>
      <th>Progress </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><a href="#" class="new_participant_form">Participant Registration</a></td>
      <td>Smith Johnson</td>
      <td>Parent</td>
      <td>60% done</td>
    </tr>
  </tbody>
</table>

<input type="text" id="f_name_participant" placeholder="Name">
<input type="text" id="l_name_participant" placeholder="Surname">
<select id="new_participant_role">
  <option>Parent</option>
  <option>Child</option>
</select>
<button id="add_new_participant">Add New Entry</button>

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
```

阅读更多：[http ://api.jquery.com/on/](http://api.jquery.com/on/)

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2017-04-13T08:08:32.837

如前所述，可以使用`.on`jQuery 1.7+ 版本解决此问题。

不幸的是，这在我的代码中不起作用（我有 1.11）所以我使用了：

`$('body').delegate('.logout-link','click',function() {`

[http://api.jquery.com/delegate/](http://api.jquery.com/delegate/)

> 从 jQuery 3.0 开始，.delegate() 已被弃用。从 jQuery 1.7 开始，它被 .on() 方法取代，所以它的使用已经不鼓励了。然而，对于早期版本，它仍然是使用事件委托的最有效方法。有关事件绑定和委托的更多信息在 .on() 方法中。通常，这些是两种方法的等效模板：

```
// jQuery 1.4.3+
$( elements ).delegate( selector, events, data, handler );
// jQuery 1.7+
$( elements ).on( events, selector, data, handler ); 
```

此评论可能对其他人有所帮助:)！

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2020-05-06T10:53:53.337

试试这个

从 jQuery 版本 1.7+ 开始，on() 方法是 bind()、live() 和 delegate() 方法的新替代品。

所以添加这个，

```
$(document).on("click", "a.new_participant_form" , function() {
      console.log('clicked');
}); 
```

或欲了解更多信息，请[点击此处](https://www.tutorialrepublic.com/codelab.php?topic=faq&file=jquery-bind-click-event-to-dynamically-created-elements)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2020-04-20T01:36:25.440

**这是解决方案，可能对您有所帮助**

```
// Changed to delegate() method to use delegation from the body

$("body").delegate("#boundOnPageLoaded", "click", function(){
   alert("Delegated Button Clicked")
}); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-10-21T19:51:25.363

```
$(document).on("click", '.mylink', function(event) { 
alert("new link clicked!");}); 
```

# visual-c++ - 我是否需要注册任何 DLL 才能使用 ATL ActiveX 控件库存属性页？

> ID：15420561
> 
> 赞同：0
> 
> 时间：2013-03-14T21:29:24.163
> 
> 标签：visual-c++, activex, atl

我使用 ATL 在 VC++ 2012 中创建了一个 ActiveX 控件。我想添加一个字体属性并从显示字体选择器的股票属性页面中受益。

我使用控件向导创建了一个具有此类库存属性的新控件。我修改了我的代码以反映添加 stock 属性所需的操作。（我现在实现`ISpecifyPropertyPages`；我在属性映射中有相关`PROP_ENTRY_TYPE`和`PROP_PAGE`条目）但是当我尝试在设计器中显示属性编辑器时，我收到“未注册”类型错误。

我有 ATL 动态链接，据我了解，这意味着我不需要链接到 ATL 的任何外部 DLL。但是，股票属性页在哪里实现？难道是我没有它们，需要以某种方式注册它们？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T13:16:06.927

您可能面临的问题是库存属性页面由托管，`MSSTKPRP.DLL`并且此组件不一定存在/安装在 Windows 中并且随时可用。我建议不要使用 stock 属性页并实现自己的以避免令人不安的依赖关系。

也可以看看：

*   [是否有 x64 版本的 MsStkPrp.dll](https://stackoverflow.com/questions/10524676/is-there-a-x64-version-of-msstkprp-dll)
*   [重新分发 ATL 和 OLE DB 模板](http://msdn.microsoft.com/en-us/library/ms235284%28v=vs.80%29.aspx)- 在底部

# sql-server - Crystal Reports '"This field name not known" 错误，由于 SQL 对象命名冲突

> ID：15420574
> 
> 赞同：-1
> 
> 时间：2013-03-14T21:30:30.383
> 
> 标签：sql-server, crystal-reports, schema, field

我们在未触及报告模板的开发环境中突然出现 5 个报告（大约 20 个）失败，尝试预览这些报告时出现的错误是看似常见的“此字段名称未知”错误来自水晶。

我想我会发布我们遇到的非显而易见的问题以及我们发现的解决方案，因为这似乎是导致其他人可能会被抓住的错误的众多方法之一。

我们一直在慢慢改进我们的数据库，并将旧版本的数据库代码对象移动到“清理”模式组中，以便稍后删除。

事实证明，Crystal 模板试图在 Cleanup 中使用旧版本的视图，而不是原始模式中的新视图，因为我们假设，Crystal 部分存在一些不知道模式的运行时名称匹配。

例如，我们有，说，

Cleanup.vGetLocations（它不再有效，因为它，例如，指的是现在删除的表）和 Stores.vGetLocations（与新表一起工作的新视图）

Crystal在未能成功返回数据时，似乎找到了旧视图并抛出了这个“字段名未知”的错误。

我们的解决方案很简单：我们还重命名了 Cleanup 模式中的旧对象，在名称中添加“OLD”，例如“Cleanup.vGetLocationsOLD”。损坏的报告预览然后立即起作用。

我们将 Crystal Reports 用于 .NET Framework 4.0 和 SQL Server 2008 R2。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T23:01:24.720

Crystal Reports 指示字段已 1) 从数据集中删除或 2) 重命名。

# ios - mergExt - 在 iOS 上使用 mergSettings 本地化应用程序

> ID：15420579
> 
> 赞同：3
> 
> 时间：2013-03-14T21:30:58.733
> 
> 标签：ios, livecode

我正在本地化我的 iOS 应用程序，并且难以在 LiveCode 的 mergSettings 扩展中翻译字符串。我设置了一个新文件夹 - ja.lproj。然后，我在该文件夹中创建了一个名为“Localizable.strings”的新文件。然后我创建了 "key" = "value"; 对。我加载了应用程序，但未翻译字符串。

关于下一步尝试什么的任何想法？蒙特?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T22:31:39.553

设置包有它自己的本地化资源文件夹，所以 ja.lproj 需要在 Settings.bundle 中。另外我假设当您加载应用程序时，语言环境设置为 ja？

* * *

编辑

该文件应命名为 Root.strings

# sql - SQL 中 LIKE 和 IN 的替代方案，您无法格式化 SSRS 提供的输入选项

> ID：15420580
> 
> 赞同：1
> 
> 时间：2013-03-14T21:31:06.763
> 
> 标签：sql, sql-server, sql-server-2008, reporting-services, sql-server-2012

我正在处理一个查询，我需要一起使用“LIKE”和“IN”之类的功能，这些值由 SSRS 返回，我无法控制如何格式化 SSRS 提供的字符串。

我的情况如下

```
SELECT *
FROM suppliers
WHERE supplier_name LIKE IN ('IBM', 'Hewlett Packard', 'DELL', 'Microsoft',) 
```

我想要所有包含“IBM”、“Microsoft”等的供应商名称。

例如：“IBM_ER”、“IBM-PCR”、“EBM_TCC”、“Microsoft-Delta”、“Microsoft-TCC”等。

我将从 SSRS 接收选项列表作为参数，其中@Manufacture 由如上所示的字符串组成，我无法控制它。

```
SELECT *
FROM suppliers
WHERE supplier_name LIKE IN (@Manufacturer) 
```

有什么办法可以实现这件事吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-14T21:53:14.877

好吧，Nikhil，你应该学会的第一件事就是保持冷静。人们在这里提供帮助，如果他们不理解您的问题，可能是您错过了发布更多详细信息。

Jarrod 的回答是正确的，但是如果您将 @Manufactor 作为字符串列表，您可以执行以下操作：拆分字符串，然后将其用作 IN 语句。

因此，首先，如果您没有，请创建一个拆分功能。这是一个示例：[https ://codereview.stackexchange.com/questions/15125/sql-server-split-function-optimized](https://codereview.stackexchange.com/questions/15125/sql-server-split-function-optimized)

其次，像这样修改你的陈述。

```
SELECT *
FROM suppliers
WHERE supplier_name IN (SELECT [value] FROM dbo.fn_Split(@Manufactor,',')) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-14T21:38:08.457

试试这个

```
SELECT *
FROM suppliers
WHERE supplier_name like '%IBM%'
or supplier_name like '%Microsoft%'
or supplier_name like '%Hewlett Packard%' 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-14T22:01:30.373

首先，[创建一个拆分函数，以便您可以将 CSV 字符串转换为数据行](https://stackoverflow.com/a/314917/643591)。

接下来，加入这个函数的结果，用通配符填充分割的结果：

```
SELECT *
FROM suppliers sup
JOIN dbo.Split(',', @Manufacturer) split
    ON sup.supplier_name LIKE '%' + split.s + '%' 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-14T21:33:56.523

您正在寻找的是一个`UNION`

```
SELECT *
FROM suppliers
WHERE supplier_name LIKE '%IBM%'
UNION
SELECT *
FROM suppliers
WHERE supplier_name LIKE '%Hewlett Packard%'
UNION
SELECT *
FROM suppliers
WHERE supplier_name LIKE '%Microsoft%' 
```

由于您已在问题中添加了详细信息，因此您可以调用存储过程并将名称列表解析为服务器上的动态 SQL 语句，但它会很快变得非常难看，更不用说 SQL 注入向量了小路。

# java - weblogic jaas 服务器端示例

> ID：15420581
> 
> 赞同：1
> 
> 时间：2013-03-14T21:31:12.460
> 
> 标签：java, weblogic, jaas

我需要实现 JAAS 身份验证以从客户端和服务器端在 Weblogic 中查找 EJB bean。对于客户端，此代码可以正常工作：

```
LoginContext loginContext = null;
loginContext = new LoginContext("Sample", new WeblogicCallbackHandler("weblogic", "PaSsWoRd", "localhost:7001"));
loginContext.login();

subject = loginContext.getSubject();
weblogic.security.Security.runAs(subject, new PrivilegedExceptionAction<Object>() {
    @Override
    public Object run() throws Exception {
        Object remote = iniCtx.lookup(SOME_BEAN_REF);
        Object home = PortableRemoteObject.narrow(remote, SOME_BEAN_HOME_CLASS);
        return homeClass.getMethod("create", new Class[] {}).invoke(home, new Object[] {});
    }
}); 
```

现在我需要做同样的事情来从 EJB 中查找 EJB。

但是我应该在这里使用什么 URL？

它总是“localhost：7001”吗？

既然我肯定在 Weblogic 内部，那么提供 URL 是否有意义？

# c++ - 使用 Win32 组织的典型约定是什么？

> ID：15420582
> 
> 赞同：2
> 
> 时间：2013-03-14T21:31:15.163
> 
> 标签：c++, winapi, organization

我最近一直在使用 Win32，但我对它很陌生，需要一些关于组织的建议。在 C++ 中，虽然在语法上声明全局变量是可行的，但我一直觉得这是草率的，因为变量可以在任何地方修改，因此跟踪对它的更改变得更加困难。

在我的 Win32 项目中，我有几个变量需要在多个地方进行修改。例如，一个这样的变量在 WndProc 函数和对话过程函数中。由于它的使用方式，我能够简单地使用 WndProc 中的实际值，然后使用 DialogBoxParam 调用对话框，并通过 lParam 值将值传递给对话框。

但是，还有其他值，例如我用于绘图的某些位图或在多个不同窗口消息调用中使用的变量，其中值需要在 WndProc 函数的多个实例或多个函数中保留。我可以控制我创建的函数的参数，但是如果我需要将一个变量传递给 WndProc 函数，以便我可以使用它而不考虑多个不同的窗口消息，该怎么办？如果我需要传入多个值怎么办？

到目前为止，我一直在将所有内容都设为全局，并且可以正常工作，但对我来说感觉很草率……但我知道，按照惯例，某些变量通常是全局的——比如主窗口和实例变量。

大家怎么看？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T21:39:56.110

您可以将特定于窗口的数据存储在与相关窗口关联的 C++ 对象中，而不是使用全局变量。

要将 C++ 对象与窗口关联，可以使用许多现有的 C++ 类框架（例如 Microsoft 的[WTL](http://wtl.sourceforge.net/)或 Torjo 的[Win32GUI](http://www.torjo.com/win32gui/index.html)），或者使用[`SetWindowSubclass`](http://msdn.microsoft.com/en-us/library/windows/desktop/bb762102%28v=vs.85%29.aspx)API 函数自己完成。

对于 Do It Yourself™ 解决方案，我在另一个 SO 答案中提供**[了一个完整的 C++ 示例。](https://stackoverflow.com/questions/15306694/pass-non-static-member-without-externally-setting-it/15307484#15307484)**

也就是说，对于一个很小的程序全局变量+对话框是最简单的并且没有问题。所以一般来说，使用 Right Tool™ 来完成这项工作。对于更大的工作，使用更重的工具……

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-14T21:39:58.863

如果您在代码中有一个特定的示例，它可能会有所帮助。但我认为你在谈论生命周期——你有一个资源（比如一个位图），你需要多次引用它以响应不同的 Windows 消息。你可以让它全球化，是的，但我同意这是草率的。

那么是谁创造了这个窗口呢？可能是您的“应用程序”类或类似的东西。由于该类的生命周期在逻辑上比窗口的生命周期长，因此它可以保存窗口所需的资源。

或者更好的方法是创建一个“ `Window`”类。您`App`实例化了一个`Window`对象。该`Window`对象创建 Win32 窗口并保存 HWND（您现在已经将它从 抽象出来，`App`因此它不需要知道那些血淋淋的细节），并且该`Window`实例可以保存位图资源。

# maven - 使用 POM 在 Intellij 中使用 TestNG 设置 Maven 以读取 .xml 套件

> ID：15420583
> 
> 赞同：3
> 
> 时间：2013-03-14T21:31:16.553
> 
> 标签：maven

嘿，我的项目使用 Maven 结构设置：我的 pom 文件如下所示：

```
<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
    <modelVersion>4.0.0</modelVersion>

    <groupId>com.QASelenium</groupId>
    <artifactId>MyTemp</artifactId>
    <version>1.0-SNAPSHOT</version>

    <build>
        <plugins>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-surefire-plugin</artifactId>
                <version>2.14</version>
                <configuration>
                    <suiteXmlFiles>
                        <suiteXmlFile>src/main/resources/testing.xml</suiteXmlFile>
                    </suiteXmlFiles>
                </configuration>
            </plugin>
        </plugins>
    </build>

    <dependencies>
        <dependency>
            <groupId>junit</groupId>
            <artifactId>junit</artifactId>
            <version>4.11</version>
         <!--   <scope>test</scope>     -->
        </dependency>
        <dependency>
            <groupId>org.testng</groupId>
            <artifactId>testng</artifactId>
            <version>6.8</version>
         <!--   <scope>test</scope>   -->
        </dependency>
        <dependency>
            <groupId>org.seleniumhq.selenium</groupId>
            <artifactId>selenium-java</artifactId>
            <version>2.31.0</version>
        </dependency>
    </dependencies>

</project> 
```

我的 TestNGTest.java 文件位于 src/main/resources 下：

```
import org.testng.Assert;
import org.testng.annotations.Parameters;
import org.testng.annotations.Test;

public class TestNGTest{

    @Test
    @Parameters(value="number")
    public void parameterIntTest(int number) {
        System.out.println("Parameterized Number is : " + number);
    }
} 
```

当我使用 IntelliJ 使用 TestNG 编译它时，为什么我总是收到此错误：

**org.testng.TestNGException：@Test 在方法 parameterIntTest 上需要参数“编号”，但尚未标记为 @Optional 或在 C:\Users(My_Name).IdeaIC12\system\temp-testng-customsuite.xml 中定义**

有人可以指出我在哪里运行错误吗？我是maven的新手，在此先感谢您。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T22:30:48.680

我认为一切都很好，但是如果您使用的是 xml 套件，那么您需要从套件执行测试，而不是从类执行测试。

```
Run/Debug Configurations
Configuration -> Suite
Suite: /PATH/PROJECT/src/test/resources/testng.xml 
```

# assembly - 手动构建 MIPS 字符串

> ID：15420585
> 
> 赞同：0
> 
> 时间：2013-03-14T21:31:20.563
> 
> 标签：assembly, mips

对于家庭作业，我想取一个整数并将其更改为它的字符串代表。我对 MIPS 有基本的了解，但我真的不明白为什么我的代码不起作用。我想知道是否有人可以给我一些指示我需要做什么或帮助如何从手创建一个字符串。我正在使用火星模拟器 4.2。

到目前为止，这是我的代码和注释。

```
#itoa
#$t0 = initial integer
#$t1 = place where string is stored
#This program I'm attempting to by hand create a null ended string from an original integer 2.

li $t0, 2              #load integer 2
la $t1, number         #load memory location for string

addi $t0, $t0, 48       #add 48 to 2 to get ASCII character, 50
sb $t0, ($t1)           #store it in original byte of $t1

add $t1, $t1, 1     #increment $t1, to point to next byte
sb $zero, ($t1)     #store #zero in the next byte

move $a0, $t1           #move the hopefully finished string to print out
li $v0, 1
syscall               #print out string

#exit program
li $v0, 10
syscall

.data
 number: .space 1024 
```

我基本上只是尝试将 2 更改为它的 ASCII 值，添加一个 0 来表示空字符串结尾，然后将该字符串打印出来。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-14T21:36:17.423

您更改了 in 的值，`$t1`使其不再指向字符串的开头。在覆盖之前，您应该重新加载地址或在另一个寄存器中复制`$t1`。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2014-04-14T21:41:03.340

此外，`li $v0 1`用于系统调用以打印整数。如果你真的在做一个字符串，你应该编码`li $v0 4`.

# vb.net - 使用 SaveFileDialog 将数据保存到文本图块？

> ID：15420593
> 
> 赞同：3
> 
> 时间：2013-03-14T21:31:37.950
> 
> 标签：vb.net, file, text, dialog, save

我已经查看了[MSDN 示例](http://msdn.microsoft.com/en-us/library/system.windows.forms.savefiledialog.aspx)，但我仍然遇到问题。

我创建了一个超级简单的程序来将两个数字相乘，并在文本框中显示输出。现在我需要能够读取该文本框的值并将该值放入文本文件中，当单击“保存到文件”按钮时会弹出保存到文件对话框。

```
Private Sub MutiplyBtn_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MutiplyBtn.Click
    Dim FirstNum As Double = Num1.Text
    Dim SecondNum As Double = Num2.Text
    Dim Answer2 As Double = FirstNum * SecondNum
    Answerbox.Text = Answer2
End Sub

Private Sub SaveResultToFile_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles SaveResultToFile.Click
    Dim myStream As Stream
    Dim saveFileDialog1 As New SaveFileDialog()

    saveFileDialog1.Filter = "txt files (*.txt)|*.txt|All files (*.*)|*.*"
    saveFileDialog1.FilterIndex = 2
    saveFileDialog1.RestoreDirectory = True

    If saveFileDialog1.ShowDialog() = DialogResult.OK Then
        myStream = saveFileDialog1.OpenFile()
        If (myStream IsNot Nothing) Then
            System.IO.File.WriteAllText(Answerbox.Text)
            myStream.Close()
        End If
    End If
End Sub 
```

目前，Visual Studio 给我一个错误：`Overload resolution failed because no accessible 'WriteAllText' accepts this number of arguments.`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-14T21:39:02.347

[WriteAllText](http://msdn.microsoft.com/en-us/library/ms143375.aspx)静态方法需要写入数据的文件的名称。
您可以直接使用在 saveFileDialog1 中选择的名称

```
If saveFileDialog1.ShowDialog() = DialogResult.OK Then
    System.IO.File.WriteAllText(saveFiledialog1.FileName, Answerbox.Text)
End If 
```

相反，如果你真的想使用 OpenFile() 方法打开的流，你的代码应该是

```
 If saveFileDialog1.ShowDialog() = DialogResult.OK Then
        Dim sw As StreamWriter = new StreamWriter(saveFileDialog1.OpenFile())
        If (sw IsNot Nothing) Then 
            sw.WriteLine(Answerbox.Text)
            sw.Close()
        End If 
    End If 
```

代码是一个例子，需要加一点错误处理

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-12-24T10:06:05.073

嗨，我尝试了上述方法，但我以这种方式成功....

```
Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click
   SaveFileDialog1.Filter = "TXT Files (*.txt*)|*.txt"
      If SaveFileDialog1.ShowDialog = Windows.Forms.DialogResult.OK _
      Then
         My.Computer.FileSystem.WriteAllText _
         (SaveFileDialog1.FileName, RichTextBox1.Text, True)
      End If
End Sub 
```

# java - 遍历哈希集时遇到问题

> ID：15420594
> 
> 赞同：1
> 
> 时间：2013-03-14T21:31:49.887
> 
> 标签：java, file, iterator, hashset

我的问题是当我运行我的主要方法时，什么都没有打印。我对`HashSet`s 很陌生，我担心它因为一些非常愚蠢的事情而不起作用。 `dic`最初是 an `ArrayList`，我只是想将其转换为`HashSet`s 以提高效率。

```
private Set<String>dic = new HashSet<String>(100000);
public void dictionary(){//reads/intializes arraylist dic from a file
    File data = new File("dictionaryForJava.txt");
    Scanner scanner=null;
    try {
        scanner = new Scanner(data);
        while (scanner.hasNextLine()) {
            dic.add(scanner.nextLine());
        }
    } catch (FileNotFoundException fnfe) {}
    if(scanner!=null)scanner.close(); // need if if file missing
}
public void print () throws IOException{
     Iterator it = dic.iterator();   
     while(it.hasNext())
         {
              String value =(String)it.next();
              System.out.println(value);  
         }
}
public static void main (String[] args)throws IOException{
    words test = new words();
    test.dictionary();
    test.print();
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-14T21:34:32.973

很有可能`dictionaryForJava.txt`找不到该文件。你不能在不打印一些调试信息的情况下吃掉异常，试试这个：

```
catch (FileNotFoundException fnfe) {fnfe.printStackTrace();} 
```

如果读取文件有问题，上面会在控制台中显示。

# php - httpd.conf 中的 Forcetype 不起作用

> ID：15420597
> 
> 赞同：0
> 
> 时间：2013-03-14T21:31:55.110
> 
> 标签：php, apache, lamp, friendly-url, httpd.conf

我想使用漂亮的网址。所以我搜索了网络并尝试使用 forcetype 方法。

**httpd.conf：**

```
<Files "main">
    ForceType application/x-httpd-php
</Files>

ls htdocs/
favicon.ico  index.php  main.php  webalizer  xampp 
```

但这不起作用。我试图找到解决方案，正如建议的那样，我还尝试了以下方法：

```
<Files "main">
    ForceType application/x-httpd-php5
</Files> 
```

* * *

```
<Files "main">
    ForceType application/x-httpd-php
    SetHandler application/x-httpd-php
</Files> 
```

* * *

```
<Files "main">
    ForceType application/x-httpd-php5
    SetHandler application/x-httpd-php5
</Files> 
```

但没有任何工作。我还在`404 error`继续打开`http://localhost/main`。

（`http://localhost/main.php`工作正常。）我正在`xampp-linux-1.8.1`使用`Linux abhi-me 3.0.0-31-generic #49-Ubuntu SMP Tue Feb 19 20:02:57 UTC 2013 x86_64 x86_64 x86_64 GNU/Linux`

**为什么会这样？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-14T21:48:48.960

仅仅因为你试图强制处理程序是 PHP5 并不意味着 Apache 会神奇地找到一个名为`/main.php`at的文件`/main`。

您可以简单地重命名`main.php`为`main`（同时仍然有这些处理程序规则）来完成这项工作。否则，如果您想`.php`在文件中保留扩展名，则需要考虑使用重写指令。

# asp.net-mvc-4 - 使用 SimpleMembership 的动态角色/层次结构

> ID：15420598
> 
> 赞同：0
> 
> 时间：2013-03-14T21:31:56.643
> 
> 标签：asp.net-mvc-4, authorization, simplemembership

我终于用 SimpleMembership 设置了我的 MVC 4 应用程序，但现在遇到了一个新问题。我有一个菜单系统（在侧边栏中），让用户可以访问整个应用程序的各种功能。我最近意识到，为了有点用户友好，我需要根据角色禁用或删除各种菜单链接。所以我建立了一个角色系统和与这些菜单链接的关系，效果很好。但是，“基本站点访问”角色**不应**有权访问菜单中的**所有**链接（及其相应的控制器/操作）。以前，我`Authorize`通过过滤器配置简单地全局应用属性来授予站点访问权限：

```
public static void RegisterGlobalFilters(GlobalFilterCollection filters)
{
    filters.Add(new AuthorizeAttribute());
} 
```

现在我发现，为了控制对应用程序的“基本”访问，我需要`Authorize`在操作级别添加单个属性（“管理员”角色具有完全访问权限）。虽然这很好，虽然有点烦人，但它似乎不是很有可扩展性。如果我的客户通过管理界面添加了一个新角色并想要控制对各种任务的访问怎么办？我已经对菜单系统进行了编码，以根据哪些角色可以访问哪些任务来动态禁用链接。但是没有办法（据我所知）动态地将不同的角色应用于`Authorize`属性。

虽然我已经阅读了[为什么 SimpleMembership 可能不是蜜蜂的膝盖](http://brockallen.com/2012/09/02/think-twice-about-using-membershipprovider-and-simplemembership/)，但我刚刚完成了从 ASP.NET Membership 的迁移（它本身有*严重*的缺点），我当然**不想**推出自己的用户/角色管理系统。有没有人成功地实现了一些东西来处理这种情况？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-26T23:41:07.527

如果您有很多不想用注释装饰的控制器/操作，那么您绝对应该看看[Fluent Security 。](http://www.fluentsecurity.net/)

它允许从 Global.asax 处理所有授权。它有据可查，这里有一个很好的[教程](http://blog.mariusschulz.com/securing-an-aspnet-mvc-application-using-fluentsecurity)。

# ruby-on-rails - 在rails中批量插入模型，如何自动增加id字段？

> ID：15420599
> 
> 赞同：0
> 
> 时间：2013-03-14T21:32:00.243
> 
> 标签：ruby-on-rails

我有一个股票模型和一个 stock_price_history 模型。

我想用这个批量插入

```
sqlstatement = "INSERT INTO stock_histories SELECT datapoint1 AS id, 
datapoint2 AS `date` ...UNION SELECT datapoint9,10,11,12,13,14,15,16, 
UNION SELECT datapoint 17... etc"

ActiveRecord::Base.connection.execute sqlstatement 
```

但是，我实际上并不想使用`datapoint1 AS id`. 如果我把它留空，我会收到一个错误，我的模型有 10 个字段，我只插入了 9 个并且它缺少主键。

有没有办法在通过 SQL 插入时强制对 id 进行自动增量？

编辑：奖金问题，因为我是菜鸟。我在 SQLite3 中开发并部署到 Posgres（即 Heroku），我需要修改上面的批量插入语句，以便它用于 posgres 数据库吗？

第二次编辑：我最初的问题是 Assets 和 AssetHistory 而不是 Stocks 和 Stock_Histories。我将其更改为股票/股票价格历史，因为我认为它更易于理解。因此，出于这个原因，一些答案会参考资产历史。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T21:44:35.800

您可以更改您的 SQL 并更明确地说明您要插入哪些字段，并将其`id`排除在列表之外：

```
insert into asset_histories (date) select datapoint2 as `date` ...etc 
```

这是一个很长的真实示例：

```
jim=# create table test1 (id serial not null, date date not null, name text not null);
NOTICE:  CREATE TABLE will create implicit sequence "test1_id_seq" for serial column "test1.id"
CREATE TABLE
jim=# create table test2 (id serial not null, date date not null, name text not null);
NOTICE:  CREATE TABLE will create implicit sequence "test2_id_seq" for serial column "test2.id"
CREATE TABLE
jim=# insert into test1 (date, name) values (now(), 'jim');
INSERT 0 1
jim=# insert into test1 (date, name) values (now(), 'joe');
INSERT 0 1
jim=# insert into test1 (date, name) values (now(), 'bob');
INSERT 0 1
jim=# select * from test1;
 id |    date    | name
----+------------+------
  1 | 2013-03-14 | jim
  2 | 2013-03-14 | joe
  3 | 2013-03-14 | bob
(3 rows)
jim=# insert into test2 (date, name) select date, name from test1 where name <> 'jim';
INSERT 0 2
jim=# select * from test2;
 id |    date    | name
----+------------+------
  1 | 2013-03-14 | joe
  2 | 2013-03-14 | bob
(2 rows) 
```

如您所见，仅插入了选定的行，并`id`在 table 中为它们分配了新值`test2`。您必须明确要插入的所有字段，并确保插入的顺序和选择匹配。

说了这么多，您可能想研究一下[activerecord-import](https://github.com/zdennis/activerecord-import) gem，这使得这类事情更像 Railsy。假设您有一堆新`AssetHistory`对象（尚未持久化），您可以将它们全部插入：

```
asset_histories = []
asset_histories << AssetHistory.new date: some_date
asset_histories << AssetHistory.new date: some_other_date
AssetHistory.import asset_histories 
```

这将在表中生成一个有效的插入，并`id`为您处理。您仍然需要查询一些数据并构造对象，这可能不会比使用原始 SQL 更快，但如果您已经在 Ruby 对象中获得了数据，这可能是一个更好的选择。

# ios - 布尔 Web 视图功能未按计划工作

> ID：15420604
> 
> 赞同：0
> 
> 时间：2013-03-14T21:32:16.317
> 
> 标签：ios, objective-c, uiwebview, uiwebviewdelegate

基本上，我想要的是一个`[self.navigationController popViewControllerAnimated:YES];`在按下某个按钮并且您在 Google 页面上时执行此功能的功能。但即使我不在 Google 页面上，该功能也会发生。有什么我可能会丢失的吗？

```
- (BOOL)webView:(UIWebView*)webView shouldStartLoadWithRequest:(NSURLRequest*)request navigationType:(UIWebViewNavigationType)navigationType
{
    if(wasClicked)
    {
        if([[request.URL absoluteString] rangeOfString:@"google"].location!=NSNotFound)
        {
            [self.navigationController popViewControllerAnimated:YES];
        }
    }

    return YES;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-14T21:35:19.093

如果单击按钮`UIWebViewNavigationTypeFormSubmitted`或单击链接，您应该在此方法中检查`UIWebViewNavigationTypeLinkClicked`，

```
if (navigationType == UIWebViewNavigationTypeLinkClicked) {
} 
```

在发布每个步骤的问题之前，您至少应该阅读[UIWebViewDelegate的文档。](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIWebViewDelegate_Protocol/Reference/Reference.html)我写这篇文章是因为在上一个问题中您询问了它是如何工作的，您在[其他帖子](https://stackoverflow.com/questions/15419866/webviewhow-to-detect-if-i-am-on-the-original-web-page-and-execute-a-certain-met)中得到了答案，您复制了答案并在此处粘贴为问题，而不是自己尝试。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-14T21:52:41.597

如果您在 Google 页面上，那么大多数链接很可能会针对字符串中某处包含“google”的 URI 发起加载请求。我不确定这一点，但我认为即使是谷歌搜索结果也会先加载一个谷歌 URL 进行跟踪，然后再重定向到点击的实际页面。

尝试添加`NSLog(@"URL: %@", [request.URL absoluteString]);`到您的函数中，看看为什么该语句评估为`YES`.

# c - 二维数组中的第一个元素被覆盖 - C

> ID：15420606
> 
> 赞同：0
> 
> 时间：2013-03-14T21:32:21.403
> 
> 标签：c, arrays, pointers, memory, multidimensional-array

我已经有一段时间遇到同样的问题了，无论进行多少研究，我似乎都无法理解它。我想出了一些理论，为什么它可能会发生。

基本上，我正在编写一个简单的 C shell，但在尝试实现要存储在二维数组中的别名时遇到了一个恼人的错误。每当我尝试为数组分配多个别名时，它都会覆盖第一个元素。

我认为这可能归结为：

1.  再次标记输入时的内存问题
2.  数组“衰减”和指针的问题
3.  我的编译器讨厌我。

这是我的代码：

```
void fillArray(char* tokens[], char* aliasArray[ALIAS_NO][TOKEN_NUM]) {
    /* Integer for the for loop */
    int i;
    /* Counter for attribute addition */
    int counter = 2;
    /* Onto the search */
    for (i = 0; i < ALIAS_NO; i++) {
        if (aliasArray[i][0] == NULL) { /* If there is a space here */
            aliasArray[i][0] = tokens[counter-1]; /* Assign the alias */
            while (tokens[counter] != NULL) { /* While there is still stuff left */
                aliasArray[i][counter-1] = tokens[counter]; /* Add it in */
                counter++; /* Increment the counter */
            }
            return;
        }
    }
    return;
} 
```

其中 ALIAS_NO 和 TOKEN_NUM 分别是值 10 和 50 的预处理器指令。

当我打印 i 的状态时，检查该条目是否为空，并且我还将多维数组中的每个元素初始化为空。

任何帮助将不胜感激。我已经用头撞墙太久了。

谢谢 ：）

编辑：我也尝试使用 strcpy() 函数。不幸的是，这会引发分段错误。

编辑：新代码

```
 void fillArray(char* tokens[], char* aliasArray[ALIAS_NO][TOKEN_NUM]) {
/* Integer for the for loop */
int i;
/* Counter for attribute addition */
int counter = 2;
/* Buffer */
char buffer[200];
/* Onto the search */
for(i = 0; i < ALIAS_NO; i++) {
    if(aliasArray[i][0] == NULL) { /* If there is a space here */
        strcpy(buffer, tokens[counter-1]);
        aliasArray[i][0] = buffer; /* Assign the alias */
        while (tokens[counter] != NULL) { /* While there is still stuff left */
            strcpy(buffer, tokens[counter]);
            aliasArray[i][counter-1] = buffer; /* Add it in */
            counter++; /* Increment the counter */
        }
        return;
    }
}
return;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-14T22:31:34.453

```
for(i = 0; i < ALIAS_NO; i++)
{
    if(aliasArray[i][0] == NULL)
    {
        aliasArray[i][0] = strdup(tokens[counter-1]);
        while (tokens[counter] != NULL)
        {
            aliasArray[i][counter-1] = strdup(tokens[counter]);
            counter++;
        }
        break;
    }
} 
```

# eclipse - 每次eclipse运行可执行文件时如何运行shell“时间”命令？

> ID：15420607
> 
> 赞同：0
> 
> 时间：2013-03-14T21:32:29.407
> 
> 标签：eclipse, shell, time

我希望eclipse打印出程序运行时执行的时间。我正在使用 Linux Mint，并且 shell 有一个我一直使用的“时间”命令。

```
 time ./myPgrogram.out 
```

我搜索了这是否可能，我发现了一个帖子： [Is there an Eclipse plugin to run system shell in the Console？](https://stackoverflow.com/questions/1562600/is-there-an-eclipse-plugin-to-run-system-shell-in-the-console)

这允许我在 Eclipse 中使用控制台，但这很糟糕，首先因为如果我想使用控制台，我不会在第一次调整 Eclipse，其次，因为 Mint 的控制台比那个好很多日食提供。

所以，我想知道，每次单击顶部的绿色三角形并运行可执行文件时，是否可以让 Eclipse 打印出程序运行所需的“时间”？如果是这样，怎么做？

我也找到了这个线程，但我不确定它是否有帮助： [Compiling in Eclipse with gcc's -lpthread and -lrt set](https://stackoverflow.com/questions/4201129/compiling-in-eclipse-with-gccs-lpthread-and-lrt-set) 他们使用它将某些命令链接到 Eclipse，如“-lpthread”，我不知道我是否可以链接“时间”，最后打印出来。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-17T14:55:28.510

我不使用 Eclipse，但我认为您应该对["profiler/profiling"](http://en.wikipedia.org/wiki/Profiling_%28computer_programming%29)感兴趣。
它是测量程序使用的时间和内存的工具，大多数 IDE 都有类似的东西，或者可以使用外部的。

例如，我发现[了这个](http://wiki.eclipse.org/Linux_Tools_Project/GProf/User_Guide) （在回答[Linux Eclipse CDT profiler](https://stackoverflow.com/questions/10076602/linux-eclipse-cdt-profiler)问题时）。

我不会为您提供更多帮助，因为我仍然在控制台中使用“时间”来测试在 Geany（在 Linux Mint 上）中创建的 C/C++ 程序；）。

# php - MySQL：检索到的数据有错误的时区

> ID：15420611
> 
> 赞同：0
> 
> 时间：2013-03-14T21:32:41.617
> 
> 标签：php, mysql

有谁知道为什么检索到的 DateTime 对象的时区不反映服务器的时区（`UTC`）？我有一个使用 的服务器`UTC`，并且时间戳在其时区中正确，但是当我查询和检索它时，DateTime 对象`timezone`更改为`US/Pacific`，这是我居住的地方。

所以，当我这样做时`$temp->setTimeZone(new DateTimeZone('US/Pacific'));`，时间戳不会改变，因为它已经在`US/Pacific`. 我已经尝试过其他时区，它们会相应地改变。

有任何想法吗？

编辑： phpinfo() 显示`America/Los_Angeles`.. 这就是我在检索到的数据中获取太平洋时区的原因吗？基本上，我希望能够将使用的源时区转换为我的时区，以便正确显示给用户。

# r - 有没有办法在 R 中创建“脆弱”属性？

> ID：15420617
> 
> 赞同：3
> 
> 时间：2013-03-14T21:33:10.313
> 
> 标签：r, class, attributes

有没有办法在另一个函数处理时删除的对象上设置属性？例如，我可能会写：

```
weightedMeanZr <- function(r,n) {
   require(psych)
   Zr <- fisherz(r) 
   ZrBar <- sum(Zr*(n-3))/(sum(n-3))
   attr(ZrBar,"names") <- "ZrBar"
   return(ZrBar)
} 
```

计算一组相关性的加权 Fisher 变换 Z 平均值。但是，如果我将其转换回 r，例如

```
require(psych)
bdata <- structure(list(Sample = 1:6, n = c(4L, 13L, 9L, 5L, 11L, 14L), 
    r = c(0.93, 0.57, 0.46, -0.09, 0.12, 0.32)), .Names = c("Sample", 
"n", "r"), class = "data.frame", row.names = c(NA, -6L))

fisherz2r(with(bdata,weightedMeanZr(r,n))) 
```

from 的输出值`fisherz2r`保留了 weightedMeanZr 结果中的 names 属性。有什么方法可以使该属性变得脆弱，以便由诸如`fisherz2r`删除名称属性之类的函数处理？

**编辑** 类似这样的东西：

```
weightedMeanZr <- function(r,n) {
   require(psych)
   Zr <- fisherz(r) 
   ZrBar <- sum(Zr*(n-3))/(sum(n-3))
   class(ZrBar) <- "ZrBar"
   return(ZrBar)
}
"+.ZrBar" <- function(e1,e2) {
    return(unclass(e1)+unclass(e2))
}
"-.ZrBar" <- function(e1,e2) {
    return(unclass(e1)-unclass(e2))
}
"*.ZrBar" <- function(e1,e2) {
    return(unclass(e1)*unclass(e2))
}
"/.ZrBar" <- function(e1,e2) {
    return(unclass(e1)/unclass(e2))
}
weightedMeanZr(bdata$r,bdata$n)
weightedMeanZr(bdata$r,bdata$n)+1
weightedMeanZr(bdata$r,bdata$n)-1
weightedMeanZr(bdata$r,bdata$n)*2
weightedMeanZr(bdata$r,bdata$n)/2
fisherz2r(weightedMeanZr(bdata$r,bdata$n)) 
```

...但这仅适用于fisherz2r调用这些特定方法...是否有更通用的方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-14T21:43:03.600

您可以使用`unname`删除名称

```
 fisherz2r(with(bdata,unname(weightedMeanZr(r,n))))
 # or
 unname(fisherz2(with(bdata,weightedMeanZr(r,n)))) 
```

或`as.vector`，在这种情况下将删除名称

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-15T19:10:51.133

不，没有办法自动做我想做的事情（据我所知，至少从 R 2.15.2 开始）。R 中有一个回调系统（感谢@JoshuaUlrich 让我想到了这个关键字），但是尝试实现所需的行为可能在计算上很昂贵。

但是，这是一个（工作）示例：

```
require(psych)
bdata <- structure(list(Sample = 1:6, n = c(4L, 13L, 9L, 5L, 11L, 14L), 
                        r = c(0.93, 0.57, 0.46, -0.09, 0.12, 0.32)), .Names = c("Sample", 
                                                                                "n", "r"), class = "data.frame", row.names = c(NA, -6L))

weightedMeanZr <- function(r,n) {
  require(psych)
  Zr <- fisherz(r) 
  ZrBar <- sum(Zr*(n-3))/(sum(n-3))
  attr(ZrBar,"original.value") <- ZrBar
  class(ZrBar) <- "ZrBar"
  attr(ZrBar,"names") <- "ZrBar"
  return(ZrBar)
}

h <- taskCallbackManager() #create the callback system

# add a callback
h$add(function(expr, value, ok, visible) {
  cat("In handler",george,"\n")
  ZrBars <- names(which(lapply(sapply(ls(name=.GlobalEnv,all=TRUE),get),class) == "ZrBar"))
  for (i in ZrBars) {
    thisone <- get(i)
    if(!attr(thisone,"original.value") == thisone) {
      attr(thisone,"names") <- NULL
      attr(thisone,"class") <- NULL
      attr(thisone,"original.value") <- NULL
      assign(i,thisone,envir=.GlobalEnv)
    }
  }
  return(TRUE)
}, name = "simpleHandler")

#create some objects of the class
thisone <- weightedMeanZr(runif(10),4:13)
thistoo <- weightedMeanZr(runif(10),4:13)

thisone + 1 #class kept, a print method could be added to resolve this issue
#if we store the result, it goes away as desired
(um <- thisone + 1) #class gone\

#clean out workspace so the callback system doesn't linger
removeTaskCallback("R-taskCallbackManager") 
```

# c# - 使用 MOQ 模拟构造函数

> ID：15420618
> 
> 赞同：9
> 
> 时间：2013-03-14T21:33:21.797
> 
> 标签：c#, moq

我有一个 B 类，其构造函数参数为 A 类。

我希望在为 B 类创建模拟时模拟 A 类。

我怎样才能做到这一点？我尝试了 MockBehavior Loose/Strict 但这没有帮助！

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-03-14T21:40:00.923

如果您正在模拟类，则可以在调用时传入构造函数参数`new Mock<T>`：

因此，如果您有课程：

```
public class A {}

public class B
{
    private readonly A a;

    public B(A a) { this.a = a; }
} 
```

以下代码使用模拟 A 创建模拟 B：

```
var mockA = new Mock<A>();
var mockB = new Mock<B>(mockA.Object); 
```

# .htaccess - .htaccess 使用重写

> ID：15420619
> 
> 赞同：1
> 
> 时间：2013-03-14T21:33:24.117
> 
> 标签：.htaccess, joomla

如何 使用 .htaccess将[http://bruteforce.tv/streams/shinigami](http://bruteforce.tv/shinigami)重写 为 [http://bruteforce.tv/shinigami ？](http://bruteforce.tv/streams/shinigami)

我正在使用 Joomla。3.X 内容管理系统。/steams/ 是 Joomla 的一个类别，无法使用管理面板禁用。提前致谢！

原始 Joomla .htaccess：

```
##
# @package      Joomla
# @copyright    Copyright (C) 2005 - 2013 Open Source Matters. All rights reserved.
# @license      GNU General Public License version 2 or later; see LICENSE.txt
##

##
# READ THIS COMPLETELY IF YOU CHOOSE TO USE THIS FILE!
#
# The line just below this section: 'Options +FollowSymLinks' may cause problems
# with some server configurations.  It is required for use of mod_rewrite, but may already
# be set by your server administrator in a way that disallows changing it in
# your .htaccess file.  If using it causes your server to error out, comment it out (add # to
# beginning of line), reload your site in your browser and test your sef url's.  If they work,
# it has been set by your server administrator and you do not need it set here.
##

## Can be commented out if causes errors, see notes above.
Options +FollowSymLinks

## Mod_rewrite in use.

RewriteEngine On

## Begin - Rewrite rules to block out some common exploits.
# If you experience problems on your site block out the operations listed below
# This attempts to block the most common type of exploit `attempts` to Joomla!
#
# Block out any script trying to base64_encode data within the URL.
RewriteCond %{QUERY_STRING} base64_encode[^(]*\([^)]*\) [OR]
# Block out any script that includes a <script> tag in URL.
RewriteCond %{QUERY_STRING} (<|%3C)([^s]*s)+cript.*(>|%3E) [NC,OR]
# Block out any script trying to set a PHP GLOBALS variable via URL.
RewriteCond %{QUERY_STRING} GLOBALS(=|\[|\%[0-9A-Z]{0,2}) [OR]
# Block out any script trying to modify a _REQUEST variable via URL.
RewriteCond %{QUERY_STRING} _REQUEST(=|\[|\%[0-9A-Z]{0,2})
# Return 403 Forbidden header and show the content of the root homepage
RewriteRule .* index.php [F]
#
## End - Rewrite rules to block out some common exploits.

## Begin - Custom redirects
#
# If you need to redirect some pages, or set a canonical non-www to
# www redirect (or vice versa), place that code here. Ensure those
# redirects use the correct RewriteRule syntax and the [R=301,L] flags.
#
## End - Custom redirects

##
# Uncomment following line if your webserver's URL
# is not directly related to physical file paths.
# Update Your Joomla! Directory (just / for root).
##

# RewriteBase /

## Begin - Joomla! core SEF Section.
#
RewriteRule .* - [E=HTTP_AUTHORIZATION:%{HTTP:Authorization}]
#
# If the requested path and file is not /index.php and the request
# has not already been internally rewritten to the index.php script
RewriteCond %{REQUEST_URI} !^/index\.php
# and the request is for something within the component folder,
# or for the site root, or for an extensionless URL, or the
# requested URL ends with one of the listed extensions
RewriteCond %{REQUEST_URI} /component/|(/[^.]*|\.(php|html?|feed|pdf|vcf|raw))$ [NC]
# and the requested path and file doesn't directly match a physical file
RewriteCond %{REQUEST_FILENAME} !-f
# and the requested path and file doesn't directly match a physical folder
RewriteCond %{REQUEST_FILENAME} !-d
# internally rewrite the request to the index.php script
RewriteRule .* index.php [L]
#
## End - Joomla! core SEF Section. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T21:44:33.977

就在 RewriteBase 下面放了这条规则：

```
RewriteRule ^streams/(shinigami)/?$ /$1 [L,NC,R] 
```

如果你想重定向每个`streams/*`然后使用：

```
RewriteRule ^streams/(.*)/?$ /$1 [L,NC,R] 
```

# css - 使用 jstl 设置 CSS 样式

> ID：15420620
> 
> 赞同：0
> 
> 时间：2013-03-14T21:33:27.017
> 
> 标签：css, jstl

有没有办法直接使用jstl修改css属性？下面是我想做的

```
<div id="error" align="center">
  <img src='resources/warning.png'/>
  <c:if test="${not empty error}">
    <c:out value='${error}' />     //if i enter here, I want #error 'display' to be 'block'
  </c:if>
</div> 
```

所以你可能会说，为什么不把 css 设置为 display:block，然后像这样放置 if 标签

```
<c:if test="${not empty error}">
    <div id="error" align="center">
      <img src='resources/warning.png'/>          
        <c:out value='${error}' />     
    </div>
</c:if> 
```

如果我的错误的唯一来源来自控制器并在模型中传回，那会很好。但是，我也在进行 AJAX 调用，并说浏览器端有问题，我仍然需要显示错误。

所以要做到这一点，例如在我的 ajax 调用中

```
$.ajax({

            url:  "url",
            beforeSend: function(){
              $("body").css("cursor", "wait");
            },
            dataType:"json",
            timeout:15000,
            cache: false,
            async: false,
            success: function(data){
                document.getElementById("error").innerHTML="";
                document.getElementById("error").style.display = "none";

                        $("body").css("cursor", "default");
            },
            error: function(jqXHR, textStatus, errorThrown){
                if (textStatus =="timeout"){
                    document.getElementById("error").innerHTML="Request timed out!";
                }
                else{
                    document.getElementById("error").innerHTML= jqXHR.responseText; 
                }
          document.getElementById("error").style.display = "block";
        //      $("#loading").fadeOut('medium');
                $("body").css("cursor", "default");
            }

        }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T22:02:07.463

```
<div id="error" align="center" <c:if test="${empty error}">style="display: none;"</c:if>>
  <img src='resources/warning.png'/>
  <c:if test="${not empty error}">
    <c:out value='${error}' />
  </c:if>
</div> 
```

或者

```
<div id="error" align="center" style="display: ${(empty error) ? 'none': 'block'};">
  <img src='resources/warning.png'/>
  <c:if test="${not empty error}">
    <c:out value='${error}' />
  </c:if>
</div> 
```

应该做你想做的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-14T22:21:19.580

我是这样做的

```
<div id="error" align="center">
  <img src='resources/critical.png'/>
  <span id="errorText">
    <c:out value='${error}' />
  </span>
</div> 
```

所以现在显示属性只适用于包含 div 'error'

我的 jsp 在“errorText”字段中设置文本 如果发现错误，我的 ajax javascript 也会这样做。

然后，在我的 javascript 中，它会检查 'errorText' 中是否有任何内容，并适当地设置它的显示

```
$.ajax({
          //url:  "./test.go?station="+stName+"&date="+rDate,
            url:  "./getAssignments.go?station="+stName+"&date="+rDate,
            beforeSend: function(){
        //    $("#loading").fadeIn('medium');
              $("body").css("cursor", "wait");
            },
            dataType:"json",
            timeout:15000,
            cache: false,
            async: false,
            success: function(data){

                document.getElementById("errorText").innerHTML="";
                document.getElementById("error").style.display = "none";
                pucksJSON=data;
                reconstructGates( pucksJSON ); 
                setStationName(stationName); 
                refresh_time = new Date();  //reset the time counter
            //  $("#loading").fadeOut('medium');
                $("body").css("cursor", "default");
            },
            error: function(jqXHR, textStatus, errorThrown){
              refresh_time = new Date();  //reset the time counter
                if (textStatus =="timeout"){
                    document.getElementById("errorText").innerHTML="Request timed out!";
                }
                else{

                    document.getElementById("errorText").innerHTML= jqXHR.responseText;
                    setStationName(stationName); 
                    reconstructGates( null ); 
                }
          document.getElementById("error").style.display = "block";
        //      $("#loading").fadeOut('medium');
                $("body").css("cursor", "default");
            }

        }); 
```

这只有效，因为我将控制器设置为在设置错误时返回错误的响应代码。因此 Ajax 失败并转到错误部分。

# r - 从日志中复制表格和绘图

> ID：15420621
> 
> 赞同：26
> 
> 时间：2013-03-14T21:33:34.210
> 
> 标签：r, plot

我是一名外科医生，喜欢编码。我尽我所能为我的论文使用 R 的编码，但在创建表格时遇到了问题。我在著名期刊（NEJM）中找到了表格和情节组合，它看起来像这样：

![在此处输入图像描述](../Images/548e6c5f87a124833e66124f458a5472.png)

如何在**R**中重现这种表格和森林图组合？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2013-11-28T12:23:30.113

这个怎么样，用`ggplot2`and `grid`：

我将其绘制为 2 个面板，因为箱线图所需的对数刻度不允许您在零值左侧绘制“负数”，即标签和数据。

它应该可以缩放（您可以更改顶部代码块中的字体大小），`blankRows`如果页面没有足够的数据，您还可以通过增加变量在文本下添加“空白”行。

组格式的 csv 在这里：[https ://drive.google.com/file/d/0B85i6kIzoV0oSm9PZFNEYUV1WkE/edit?usp=sharing](https://drive.google.com/file/d/0B85i6kIzoV0oSm9PZFNEYUV1WkE/edit?usp=sharing)

![在此处输入图像描述](../Images/f8b3d662ff9bcea1c2091a827f8dbf1f.png)

根据要求，要改用 95% CI 条，请将其添加到绘图调用上方以显示格式：

```
## MOCK up confidence interval data in the form:
## ID (level from groupData), low (2.5%) high (97.5%), target
CI_Data<-ddply(hazardData[!is.na(hazardData$HR),],.(ID),summarize,low=min(HR),high=max(HR),target=mean(HR)) 
```

代替：

```
 geom_boxplot(fill=boxColor,size=0.5, alpha=0.8, notch=F) 
```

和：

```
 geom_point(data=CI_Data,aes(x = factor(ID), y = target),shape=22,size=5,fill=boxColor,vjust=0) + 
  geom_errorbar(data=CI_Data,aes(x=factor(ID),y=target,ymin =low, ymax=high),width=0.5)+ 
```

![在此处输入图像描述](../Images/2c0d28333635103c741740b1bb82fcc7.png)

```
## REQUIRED PACKAGES
require(grid)
require(ggplot2)
require(plyr)

############################################
### CUSTOMIZE APPEARANCE WITH THESE     ####
############################################
blankRows<-2    # blank rows under boxplot
titleSize<-4
dataSize<-4
boxColor<-"pink"
############################################
############################################

## BASIC THEMES (SO TO PLOT BLANK GRID)
theme_grid <- theme(
  axis.line = element_blank(), 
  axis.text.x = element_blank(), 
  axis.text.y = element_blank(),
  axis.ticks = element_blank(), 
  axis.title.x = element_blank(), 
  axis.title.y = element_blank(), 
  axis.ticks.length = unit(0.0001, "mm"),
  axis.ticks.margin = unit(c(0,0,0,0), "lines"), 
  legend.position = "none", 
  panel.background = element_rect(fill = "transparent"), 
  panel.border = element_blank(), 
  panel.grid.major = element_line(colour="grey"), 
  panel.grid.minor = element_line(colour="grey"), 
  panel.margin = unit(c(-0.1,-0.1,-0.1,-0.1), "mm"), 
  plot.margin = unit(c(5,0,5,0.01), "mm")
)

theme_bare <- theme_grid +
  theme(
    panel.grid.major = element_blank(), 
    panel.grid.minor = element_blank()
  )

## LOAD GROUP DATA AND P values from csv file
groupData<-read.csv(file="groupdata.csv",header=T)

## SYNTHESIZE SOME PLOT DATA - you can load csv instead
## EXPECTS 2 columns - integer for 'ID' matching groupdatacsv
## AND 'HR' Hazard Rate
hazardData<-expand.grid(ID=1:nrow(groupData),HR=1:6)
hazardData$HR<-1.3-runif(nrow(hazardData))*0.7
hazardData<-rbind(hazardData,ddply(groupData,.(Group),summarize,ID=max(ID)+0.1,HR=NA)[,2:3])
hazardData<-rbind(hazardData,data.frame(ID=c(0,-1:(-2-blankRows),max(groupData$ID)+1,max(groupData$ID)+2),HR=NA))

## Make the min/max mean labels
hrlabels<-ddply(hazardData[!is.na(hazardData$HR),],.(ID),summarize,lab=paste(round(mean(HR),2)," (",round(min(HR),2),"-",round(max(HR),2),")",sep=""))

## Points to plot on the log scale
scaledata<-data.frame(ID=0,HR=c(0.2,0.6,0.8,1.2,1.8))

## Pull out the Groups & P values
group_p<-ddply(groupData,.(Group),summarize,P=mean(P_G),y=max(ID)+0.1)

## identify the rows to be highlighted, and 
## build a function to add the layers
hl_rows<-data.frame(ID=(1:floor(length(unique(hazardData$ID[which(hazardData$ID>0)]))/2))*2,col="lightgrey")
hl_rows$ID<-hl_rows$ID+blankRows+1
hl_rect<-function(col="white",alpha=0.5){
  rectGrob(   x = 0, y = 0, width = 1, height = 1, just = c("left","bottom"), gp=gpar(alpha=alpha, fill=col))
}

## DATA FOR TEXT LABELS
RtLabels<-data.frame(x=c(rep(length(unique(hazardData$ID))-0.2,times=3)),
                      y=c(0.6,6,10),
                      lab=c("Hazard Ratio\n(95% CI)","P Value","P Value for\nInteraction"))

LfLabels<-data.frame(x=c(rep(length(unique(hazardData$ID))-0.2,times=2)),
                     y=c(0.5,4),
                     lab=c("Subgroup","No. of\nPatients"))

LegendLabels<-data.frame(x=c(rep(1,times=2)),
                     y=c(0.5,1.8),
                     lab=c("Off-Pump CABG Better","On-Pump CABG Better"))

## BASIC PLOT
haz<-ggplot(hazardData,aes(factor(ID),HR))+ labs(x=NULL, y=NULL)

## RIGHT PANEL WITH LOG SCALE
rightPanel<-haz + 
  apply(hl_rows,1,function(x)annotation_custom(hl_rect(x["col"],alpha=0.4),as.numeric(x["ID"])-0.5,as.numeric(x["ID"])+0.5,-20,20)) +
  geom_segment(aes(x = 2, y = 1, xend = 1.5, yend = 1)) + 
  geom_hline(aes(yintercept=1),linetype=2, size=0.5)+
  geom_boxplot(fill=boxColor,size=0.5, alpha=0.8)+ 
  scale_y_log10() + coord_flip() +
  geom_text(data=scaledata,aes(3,HR,label=HR), vjust=0.5, size=dataSize) +
  geom_text(data=RtLabels,aes(x,y,label=lab, fontface="bold"), vjust=0.5, size=titleSize) +
  geom_text(data=hrlabels,aes(factor(ID),4,label=lab),vjust=0.5, hjust=1, size=dataSize) +
  geom_text(data=group_p,aes(factor(y),11,label=P, fontface="bold"),vjust=0.5, hjust=1, size=dataSize) +
  geom_text(data=groupData,aes(factor(ID),6.5,label=P_S),vjust=0.5, hjust=1, size=dataSize) +
  geom_text(data=LegendLabels,aes(x,y,label=lab, fontface="bold"),hjust=0.5, vjust=1, size=titleSize) +
  geom_point(data=scaledata,aes(2.5,HR),shape=3,size=3) + 
  geom_point(aes(2,12),shape=3,alpha=0,vjust=0) + 
  geom_segment(aes(x = 2.5, y = 0, xend = 2.5, yend = 13)) + 
  geom_segment(aes(x = 2, y = 1, xend = 2, yend = 1.8),arrow=arrow(),linetype=1,size=1) + 
  geom_segment(aes(x = 2, y = 1, xend = 2, yend = 0.2),arrow=arrow(),linetype=1,size=1) + 
  theme_bare

## LEFT PANEL WITH NORMAL SCALE
leftPanel<-haz + 
  apply(hl_rows,1,function(x)annotation_custom(hl_rect(x["col"],alpha=0.4),as.numeric(x["ID"])-0.5,as.numeric(x["ID"])+0.5,-20,20)) +
  coord_flip(ylim=c(0,5.5)) +
  geom_point(aes(x=factor(ID),y=1),shape=3,alpha=0,vjust=0) + 
  geom_text(data=group_p,aes(factor(y),0.5,label=Group, fontface="bold"),vjust=0.5, hjust=0, size=dataSize) +
  geom_text(data=groupData,aes(factor(ID),1,label=Subgroup),vjust=0.5, hjust=0, size=dataSize) +
  geom_text(data=groupData,aes(factor(ID),5,label=NoP),vjust=0.5, hjust=1, size=dataSize) +
  geom_text(data=LfLabels,aes(x,y,label=lab, fontface="bold"), vjust=0.5, hjust=0, size=4, size=titleSize) +
  geom_segment(aes(x = 2.5, y = 0, xend = 2.5, yend = 5.5)) + 
  theme_bare

## PLOT THEM BOTH IN A GRID SO THEY MATCH UP
grid.arrange(leftPanel,rightPanel, widths=c(1,3), ncol=2, nrow=1) 
```

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2013-11-22T12:31:30.100

这类绘图的挑战不在于绘图（您只需要构建所有正确的文本和线条功能）。相反，它以正确的格式获取数据。对于这种绘图，我会将每一行视为数据框中的观察值，并使每一列成为您想要放置在绘图上的相关信息。

这是图像的前几行的示例，然后是实现它所需的一长串绘图命令。不过，它们基本上都是矢量化的，因此向数据框中添加行只需要修改一些参数。

这是数据：

```
mydf <- data.frame(
    SubgroupH=c('Age',NA,NA,'Sex',NA,NA),
    Subgroup=c(NA,'<70','>70',NA,'Male','Female'),
    NoOfPatients=c(NA,2815,1935,NA,3843,908),
    HazardRatio=c(NA,0.97,0.86,NA,0.93,0.81),
    HazardLower=c(NA,0.77,0.69,NA,0.78,0.59),
    HazardUpper=c(NA,1.22,1.07,NA,1.12,1.12),
    Pvalue=c(NA,0.77,0.17,NA,0.47,0.21),
    PvalueI=c(0.46,NA,NA,0.46,NA,NA),
    stringsAsFactors=FALSE
) 
```

这是情节：

```
#png('temp.png', width=8, height=4, units='in', res=400)
rowseq <- seq(nrow(mydf),1)
par(mai=c(1,0,0,0))
plot(mydf$HazardRatio, rowseq, pch=15,
    xlim=c(-10,12), ylim=c(0,7),
    xlab='', ylab='', yaxt='n', xaxt='n',
    bty='n')
axis(1, seq(-2,2,by=.4), cex.axis=.5)

segments(1,-1,1,6.25, lty=3)
segments(mydf$HazardLower, rowseq, mydf$HazardUpper, rowseq)

mtext('Off-Pump\nCABG Better',1, line=2.5, at=0, cex=.5, font=2)
mtext('On-Pump\nCABG Better',1.5, line=2.5, at=2, cex=.5, font=2)

text(-8,6.5, "Subgroup", cex=.75, font=2, pos=4)
t1h <- ifelse(!is.na(mydf$SubgroupH), mydf$SubgroupH, '')
text(-8,rowseq, t1h, cex=.75, pos=4, font=3)
t1 <- ifelse(!is.na(mydf$Subgroup), mydf$Subgroup, '')
text(-7.5,rowseq, t1, cex=.75, pos=4)

text(-5,6.5, "No. of\nPatients", cex=.75, font=2, pos=4)
t2 <- ifelse(!is.na(mydf$NoOfPatients), format(mydf$NoOfPatients,big.mark=","), '')
text(-3, rowseq, t2, cex=.75, pos=2)

text(-1,6.5, "Hazard Ratio (95%)", cex=.75, font=2, pos=4)
t3 <- ifelse(!is.na(mydf$HazardRatio), with(mydf, paste(HazardRatio,' (',HazardLower,'-',HazardUpper,')',sep='')), '')
text(3,rowseq, t3, cex=.75, pos=4)

text(7.5,6.5, "P Value", cex=.75, font=2, pos=4)
t4 <- ifelse(!is.na(mydf$Pvalue), mydf$Pvalue, '')
text(7.5,rowseq, t4, cex=.75, pos=4)

text(10,6.5, "P Value for\nInteraction", cex=.75, font=2, pos=4)
t5 <- ifelse(!is.na(mydf$PvalueI), mydf$PvalueI, '')
text(10,rowseq, t5, cex=.75, pos=4)
#dev.off() 
```

结果：

![在此处输入图像描述](../Images/ce1b5db85223d284f2a40d034fc118cd.png)

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2013-03-14T23:34:58.373

sparkTable[包](http://cran.r-project.org/web/packages/sparkTable/index.html)可以做到这一点。例如：

```
install.packages("sparkTable", dep=TRUE)
library(sparkTable)
## Example creates a bunch of files, so run it in a new folder
dir.create("tempDir")
setwd("tempDir")
example(plotSparkTable)
setwd("..") 
```

并`pdflatex`在生成的 t2.tex 文件上运行会生成下图。 ![plotSparktable 示例](../Images/e8fc44996b3cb2701de0f97278ab0d19.png)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-03-14T23:47:09.157

**没关系：它是用元包完成的**

所涉及的工作量将受到您是否希望 R 代码生成整个信息页面的显着影响，或者是否希望使用 R 在中间创建图形并将其添加到文档（MSWord 等）中包含文本信息。如果后一种方法没问题，那么从水平条形图开始（例如，[http](http://docs.ggplot2.org/current/geom_boxplot.html) : //docs.ggplot2.org/current/geom_boxplot.html ），使用类似 theme_classic() 清除背景，并使用 xlim()缩放 x 轴。如果你修改你的问题并添加一个实际数据框的文本表示（例如，就像在这篇文章中：[date at which a percentage of maximum was](https://stackoverflow.com/questions/15420860/date-at-which-a-percentage-of-maximum-was-surpassed) exceeded ），我或其他人可能会为你生成 ggplot 代码。

# javascript - 我正在努力解决的 Javascript 正则表达式

> ID：15420624
> 
> 赞同：1
> 
> 时间：2013-03-14T21:33:42.937
> 
> 标签：javascript, regex, string-matching

诚然，我不是一个正则表达式的人，但通常我可以想办法解决一些问题。这个让我一头雾水...

我需要匹配并替换一个大于 str (>>) 且具有可选前导空格的 double。我知道这行不通，但类似于...

```
/\s\s+[>>]/ 
```

但这显然不好。

将不胜感激任何帮助。多年来，这个网站对我来说一直是一个了不起的资源，我不敢相信我现在只能发布一些东西，所以它表明即使是像我这样的傻瓜也能够在不打扰人们的情况下受益......直到现在:) 提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T21:43:26.353

对于字符串内和前导空格的 >> ，请尝试：

```
/(\s*)(>>){1}/ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T07:33:25.960

用这个 ：

```
str.replace(/\s+>>/g, 'whatever'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-14T21:35:42.927

如果您希望空间是可选的，那么您可以简单地执行以下操作：

```
/>>/ 
```

您可以将其用作带有`g`修饰符的替换模式：

```
str = str.replace(/>>/g, 'something') 
```

如果你想检查一个字符串是 >> 之前可能有一些空格，然后使用

```
/^\s?>>$/ 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-14T21:36:09.353

这个正则表达式应该可以工作。

```
/\s*[>]{2}/ 
```

这个更干净

```
/\s*>>/ 
```

测试：

```
var pattern = /\s*>>/;
s1 = "             >>";
s2 = ">>";
s3 = ">> surrounding text";
s4 = "surrounding  >> text";
s5 = "surrounding>>text";

s1.match(pattern);
["             >>"]
s2.match(pattern);
[">>"]
s3.match(pattern);
[">>"]
s4.match(pattern);
["  >>"]
s5.match(pattern);
[">>"] 
```

替换示例

```
var pattern = /\s*>>/;
var s6 = "    >> surrounding text";
s6.replace(pattern, ">");
"> surrounding text" 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-14T21:44:06.593

如果您希望它匹配无限数量的前导空格字符：

```
/ *>>/ 
```

如果您希望它匹配 0 或 1 个前导空格字符：

```
/ ?>>/ 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-14T21:50:45.953

分解你的例子：

1.  `\s`将匹配任何空白字符
2.  `\s+`将匹配一个或多个空白字符
3.  `[>>]`将匹配一个`>`（见下文）

因此，您的表达式将匹配 a`>`前面至少有两个空格字符。

如果要匹配零个或多个，则必须使用`*`; 费克斯`\s*`_

方括号用于表示字符集，将匹配该集中的任何字符；fex`[abc]`将匹配 a、b 或 c，但一次只能匹配一个字符。

正则表达式中的单个字符将匹配该字符；fex`>`将匹配一个大于号。

将它们放在一起，我们会为您的情况得到以下正则表达式：

```
/\s*>>/ 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-03-14T21:53:22.713

这应该与可选空间一起使用。

```
/\s{0,}>>/g 
```

访问此[链接](http://refiddle.com/by/omi/js-regex-space)以测试匹配。

# c++ - 使没有默认构造函数的类成为另一个类的私有属性

> ID：15420626
> 
> 赞同：2
> 
> 时间：2013-03-14T21:33:54.277
> 
> 标签：c++, oop, constructor, boost-asio

我正在尝试创建一个使用 Boost 套接字进行操作的类，以使连接易于使用。
我的`SocketClient`班级有一些属性，`boost::asio::ip::tcp::socket`其中之一。但是我的构造函数中出现**C2512**错误，因为`boost::asio::ip::tcp::socket`它没有构造函数，所以不能存在。
在这里，查看类的代码：

```
class SocketClient {
private:
    int port;    //Port, currently unused
    boost::asio::io_service io_service;  
    boost::asio::ip::tcp::resolver::iterator endpoint_iterator;  
    boost::asio::ip::tcp::socket sock;  //This causes the error
    //It wants to be like this (impossible too):
  //boost::asio::ip::tcp::socket sock(io_service);
public:
    void init(const char*, const char* );
    SocketClient();  //Default constructor
    bool connect();
    bool read(int bytes, char *text);
    bool send(int length, char *text);
    bool send(std::string text);
    unsigned int timeout;
}; 
```

这是构造函数：

```
SocketClient::SocketClient() {  //ERROR: (23): error C2512: 'boost::asio::basic_stream_socket<Protocol>' : no appropriate default constructor available
    sock=boost::asio::ip::tcp::socket(io_service);  //Adding this didn't help
} 
```

那么该怎么办？我必须保持`sock`原样`void*`吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-14T21:35:10.627

使用[初始化列表](http://www.cprogramming.com/tutorial/initialization-lists-c++.html)：

```
SocketClient::SocketClient() 
    :
    sock(io_service)
{
    // Other initialization code here...
} 
```

不过要小心：这是明确定义的，因为成员变量是*按照它们在类定义中出现的顺序*构造的，并且`io_service`出现**在 之前** `sock`。如果不是这种情况，您会将未初始化的对象传递给 的构造函数`socket`，这很可能会导致未定义的行为。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-09-29T15:54:33.007

如果您使用的是 C++ 11，则可以这样做：

```
boost::asio::io_service io_service;  
boost::asio::ip::tcp::resolver::iterator endpoint_iterator;  
boost::asio::ip::tcp::socket sock { io_service }; 
```

但是（正如 Andy Prowl 所说）io_service 必须放在成员列表中的 sock 之前。

这将编译，但可能导致不可预知的错误：

```
boost::asio::ip::tcp::socket sock { io_service };
boost::asio::io_service io_service; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-10-13T15:40:04.560

通常——如前所述——尽可能使用初始化列表。还使用标识成员的命名方案。

也已经说明 - 初始化取决于成员顺序。如果成员之间存在依赖关系，这通常是设计错误的标志。它闻起来臭臭的。至少在代码中很好地记录这一点 - 总会有下一个维护者。当然，您始终可以通过类型化（智能）指针来保存元素。

对于具体问题，我建议通过参考传递 io_service。这将使您对 io_service 有更多控制权（例如，使用异步模式并在一个 io_service 中运行多个套接字）

```
#include <boost/asio.hpp>

class SocketClient {
private:
    boost::asio::io_service& m_io_service;
    boost::asio::ip::tcp::socket m_socket;

[...]

public:
    SocketClient(boost::asio::io_service& io_service);

[...]

};

SocketClient::SocketClient(boost::asio::io_service& io_service)
    : m_io_service(io_service)
    , m_socket(io_service)
    [...]
{
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-03-20T08:35:52.343

头文件.h

```
boost::asio::ip::tcp::socket *sock; 
```

正文.cpp

```
sock = new boost::asio::ip::tcp::socket(service); 
```

# gcc - GCC makefile 依赖生成路径

> ID：15420629
> 
> 赞同：5
> 
> 时间：2013-03-14T21:34:00.620
> 
> 标签：gcc, makefile

我使用`-MM`GCC 中的标志来为对象生成 makefile 依赖项。生成文件简要如下所示：

```
-include autodep
...
$(TARGET): build $(OBJECTS)
    $(CC) -shared -o $@ $(OBJECTS)
    $(CC) -MM $(SOURCES) > autodep 
```

源位于 in 文件夹中`src`。但是，该`autodep`文件将包含没有相对路径的对象目标：

```
foo.o: src/foo.c src/foo.h
bar.o: src/bar.c src/bar.h src/baz.h 
```

我应该如何把它们变成这样：

```
src/foo.o: src/foo.c src/foo.h
src/bar.o: src/bar.c src/bar.h src/baz.h 
```

?

我尝试使用该`-MT`标志，但它似乎完全丢弃了对象目标。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-14T22:26:04.303

`-MT`设置整个目标名称。如果您想要为每个源使用不同的目标，则需要为每个源使用不同的`-MT`参数，这意味着编译器的多次调用和一个 foreach 循环：

```
$(TARGET): build $(OBJECTS)
    $(CC) -shared -o $@ $(OBJECTS)
    rm autodep
    $(foreach SRC,$(SOURCES),$(CC) -MM -MT $(SRC:.c=.o) $(SRC) >> autodep;) 
```

或者，您可以使用 sed 按摩输出

```
$(TARGET): build $(OBJECTS)
    $(CC) -shared -o $@ $(OBJECTS)
    $(CC) -MM $(SOURCES) | sed 's|^|src/|' > autodep 
```

更简单的方法是将每个源文件的依赖项放入它自己的 .d 文件中，并`-MMD`在编译源文件时使用标志生成它：

```
-include $(SOURCES:.c=.d)
CFLAGS += -MMD

$(TARGET): build $(OBJECTS)
    $(CC) -shared -o $@ $(OBJECTS) 
```

# php - 在压缩文件中没有父文件夹的文件夹中压缩文件

> ID：15420632
> 
> 赞同：4
> 
> 时间：2013-03-14T21:34:07.647
> 
> 标签：php, zip

这对大多数人来说可能是一个愚蠢的问题，但我有以下文件夹，我想压缩它。

```
FolderI
   Folder1
   Folder2
   Folder3
   ..
   ..
   FolderN 
```

现在，由于在线资源如此之多，特别是这里，压缩`FolderI`成一个`zipFile.zip`非常容易！但是，我想创建`zipFile.zip`，包含`Folder1...FolderN`，这样当文件被解压缩时，它会直接用`Folder1...FolderN`, 而不是create 填充当前目录`FolderI`，其中包含`Folder1...FolderN`。

我一直在尝试的一些事情是：

```
$zip = new ZipArchive();

// open archive 
if ($zip->open('my-archive.zip', ZIPARCHIVE::CREATE) !== TRUE) {
    die ("Could not open archive");
}

// initialize an iterator
// pass it the directory to be processed
$iterator = new RecursiveIteratorIterator(new RecursiveDirectoryIterator("FolderI/"));

// iterate over the directory
// add each file found to the archive
foreach ($iterator as $key=>$value) {
    $zip->addFile(realpath($key), $key) or die ("ERROR: Could not add file: $key");
}

// close and save archive
$zip->close(); 
```

[这是使用 php 脚本](https://stackoverflow.com/questions/3828385/compress-archive-folder-using-php-script)从compress/archive 文件夹中提取的，我试图改变它。但是没有用 - *FolderI 仍然是压缩的。但是，当我解压缩时`my-archive.zip`，我得到一个`FolderI`然后`Folder1..FolderN`在里面*。我还在这里某处看到了来自@Alix 的代码，它做了同样的事情。但是，并没有真正关注太多。

任何形式的帮助都会很棒。如果不是代码，至少指出我正确的方向。

谢谢

****这里有人知道怎么做吗？****

@Mods 和管理员：解决方案是否太简单或 PHP 根本无法做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T19:56:24.473

这里出现的问题是`$key`迭代器中的 是完整路径（因为`RecursiveDirectoryIterator::KEY_AS_PATHNAME`默认使用该标志），其中包括 RecursiveDirectoryIterator 构造函数中指定的相对部分。

例如，我们有以下层次结构：

```
folderI
├─ folder1
│  ├─ item.php
│  └─ so.php
└─ folder2
   └─ item.html 
```

和一个用`new RecursiveDirectoryIterator("folderI")`.

当您回显时，`$key`您将获得以下信息`item.php`

```
folderI/folder1/item.php 
```

同样，如果我们这样做`new RecursiveDirectoryIterator("../somewhere/folderI")`，那么`$key`看起来像：

```
../somewhere/folderI/folder1/item.php 
```

您希望获取文件的路径，而不包括用于创建迭代器的路径。值得庆幸的是，RecursiveDirectoryIterator 有一个方法，其生命中的唯一目的就是做到这一点。

**RecursiveDirectoryIterator::getSubPathname()**

您可以使用以下内容，这将更容易

```
$newKey = $iterator->getSubPathname(); 
```

`item.php`鉴于上面显示的相同文件夹结构，这将返回以下内容：

```
folder1/item.php 
```

该方法可以像这样使用：

```
foreach ($iterator as $key=>$value) {
    $zip->addFile(realpath($key), $iterator->getSubPathname()) or die ("ERROR: Could not add file: $key");
} 
```

* * *

^(另外：我们可以`$iterator->getSubPathname()`在这里使用，因为 RecursiveIteratorIterator 将对未知方法的任何调用传递给“内部迭代器”，在本例中是 RecursiveDirectoryIterator。同样，你可以做`$iterator->getInnerIterator()->getSubPathname()`，两者都做同样的工作。)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-14T22:14:33.257

就方向而言，我可以提供：

这对我来说看起来有点过于复杂，但您可以通过添加一个 foreach 循环来创建这些迭代器，如下所示：

```
foreach (glob('./*', GLOB_ONLYDIR) as $dir_name) {
   // iterator
   // add file
} 
```

Glob 可能会为您做更多的事情，可能会消除那些迭代器对象，而只支持迭代 glob 输出。

# ruby - Rspec 进程挂在不同的地方，进程无法被杀死。如何诊断？

> ID：15420633
> 
> 赞同：6
> 
> 时间：2013-03-14T21:34:10.440
> 
> 标签：ruby, macos, rspec, imagemagick, minimagick

在我正在开发的 Rails 应用程序中（在 OS-X 上），我发现通过 rspec 运行测试套件的频率越来越高。它不会每次都发生。我试过`--format documentation`在运行套件时添加，看看它是否每次都发生在同一个地方，但事实并非如此。

我试过用`kill -9`. 然后它将名称更改为 (ruby)，进程状态为`?E`. 此[链接](https://unix.stackexchange.com/questions/5642/what-if-kill-9-does-not-work)表明该进程被阻止等待系统调用完成。每次发生这种情况时，我都必须重新启动机器才能终止此进程。

我试过重新安装 rvm、ruby、mysql 和 imagemagick。这个项目正在使用 imagemagick（通过 mini_magick）gem，我怀疑它可能是导致 rspec 阻塞的这些命令之一。我尝试`puts`在每个 mini_magick 命令周围添加语句，以确保它们完成执行，并且一切看起来都很好。

我正在寻找有关如何诊断此问题的建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-07-17T13:37:51.990

您的问题可能是顺序依赖错误，您可以传递种子并且顺序将保持一致。RSpec 打印出它用于为随机发生器播种的随机数。使用此编号以相同的顺序运行 rspec `--order rand:3455`

# oracle - 将包中定义的 UDT 作为参数传递给 Oracle 中的存储过程

> ID：15420642
> 
> 赞同：0
> 
> 时间：2013-03-14T21:34:53.690
> 
> 标签：oracle, parameter-passing, user-defined-types, custom-collection

创建一个包来定义一个自定义集合和一个将此自定义集合作为输入参数的存储过程。如何从 c# 调用此过程？

这是包裹：

```
CREATE OR REPLACE PACKAGE pkg_name
AS
    TYPE customCollectionType IS VARRAY(200) OF VARCHAR2 (1000);

    PROCEDURE ProcName(p_collection IN customCollectionType);
END pkg_name;
/
CREATE OR REPLACE PACKAGE BODY pkg_name
AS
    PROCEDURE StudyProc (p_StudyNum   IN     customCollectionType)
    IS
    ........................
END pkg_name; 
```

这是 customCollectionType 的工厂实现：

```
public class PlaceHolderType : IOracleCustomType, INullable
{
    [OracleArrayMapping()]
    public string[] Array;
    private bool m_bIsNull;
    private OracleUdtStatus[] m_statusArray;

    public OracleUdtStatus[] StatusArray
    {
        get
        {
            return this.m_statusArray;
        }
        set
        {
            this.m_statusArray = value;
        }
    }

    public virtual bool IsNull
    {
        get
        {
            return m_bIsNull;
        }
    }

    public static PlaceHolderType Null
    {
        get
        {
            PlaceHolderType p = new PlaceHolderType();
            p.m_bIsNull = true;
            return p;
        }
    }

    public virtual void FromCustomObject(OracleConnection con, IntPtr pUdt)
    {
        OracleUdt.SetValue(con, pUdt, 0, Array, m_statusArray);
        return;
    }

    public virtual void ToCustomObject(OracleConnection con, IntPtr pUdt)
    {
        object objectStatusArray = null;
        Array = (string[])OracleUdt.GetValue(con, pUdt, 0, out objectStatusArray);
        m_statusArray = (OracleUdtStatus[])objectStatusArray;
    }

    public override string ToString()
    {
        return string.Empty;
    }
}

[OracleCustomTypeMappingAttribute("USER_NAME.PKG_NAME.CUSTOMCOLLECTIONTYPE")]
public class CUSTOMCOLLECTIONTYPE: IOracleCustomTypeFactory, IOracleArrayTypeFactory
{
    // Implementation of IOracleCustomTypeFactory.CreateObject()
    public IOracleCustomType CreateObject()
    {
        // Return a new custom object
        //OracleString or;
        return new PlaceHolderType();
    }

    #region IOracleArrayTypeFactory Members
    public Array CreateArray(int numElems)
    {
        return new string[numElems];
    }

    public Array CreateStatusArray(int numElems)
    {
        return new OracleUdtStatus[numElems];
    }

    #endregion
} 
```

这是电话：

```
cmd.Connection = OracleConnectionObj;
cmd.BindByName = true;
cmd.CommandText = "PKG_NAME.PROC_NAME";
cmd.CommandType = System.Data.CommandType.StoredProcedure;
OracleParameter param1 = new OracleParameter();
Array inputValue = (new CUSTOMCOLLECTIONTYPE()).CreateArray(5);
System.Array.Copy(SomeArray, inputValue, 5);
param1.OracleDbType = OracleDbType.Array;
param1.Direction = ParameterDirection.Input;
param1.UdtTypeName = "USER_NAME.CUSTOMCOLLECTIONTYPE";
param1.Value = inputValue;
cmd.Parameters.Add(param1);
cmd.ExecuteNonQuery(); 
```

.Net 中的错误是：

"OCI-22303: 类型 \"USER_NAME\".\"CUSTOMCOLLECTIONTYPE\" 未找到"

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T03:00:21.800

当您从 C# 将对象传递给映射到 UDT 的过程时，您需要在模式级别而不是包级别定义类型。因此，您需要在 sqlplus 中执行以下命令：-

```
Create Type customCollectionType AS VARRAY(200) OF VARCHAR2 (1000); 
```

并从您的包规范中删除 customCollectionType 的声明。

# php - php 到 ruby strtr 和 preg_replace

> ID：15420643
> 
> 赞同：-1
> 
> 时间：2013-03-14T21:35:02.513
> 
> 标签：php, ruby

我只是在学习 ruby​​，想将下面的函数从 php 转换为 ruby

```
function stringToDigits($str)
 {  $str = strtolower($str);
    $from = 'abcdefghijklmnopqrstuvwxyz';
    $to = '22233344455566677778889999';
    return preg_replace('/[^0-9]/', '', strtr($str, $from, $to));
 } 
```

对于之前没有正确解释，我深表歉意。这是我的第一个问题......

我在将其转换为红宝石时遇到问题。这就是我所做的

```
class String
  def str_to_digits str
      str = str.downcase
      from = 'abcdefghijklmnopqrstuvwxyz'
      to = '22233344455566677778889999'
      self.gsub('/[^0-9]', '')
      # here I am having problem to translate the whole string 'str' from 'from' to 'to'
      # I dont know how to write it in ruby
  end
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T23:34:48.363

您可以使用`String#tr(from, to)`.
文档：[http ://ruby-doc.org/core-2.0/String.html#method-i-tr](http://ruby-doc.org/core-2.0/String.html#method-i-tr)

但是，您现在正在为字符串创建实例方法。你可以这样称呼它：

```
"examplestring".str_to_digits("second examplestring") 
```

但是你只需要一个字符串，所以你有三个选择：

```
class String
  FROM = 'abcdefghijklmnopqrstuvwxyz'
  TO =   '22233344455566677778889999'

  def instance_str_to_digits
    return self.downcase.gsub(/\d/, '').tr(FROM, TO)
  end

  def destructive_instance_str_to_digits!
    self.downcase!
    self.gsub!(/\d/, '')
    self.tr!(FROM, TO)
  end

  def self.class_str_to_digits(str)
    return str.downcase.gsub(/\d/, '').tr(FROM, TO)
  end
end

# calling the methods:
str = "examplestring"
result_1 = str.instance_str_to_digits
result_2 = String.class_str_to_digits(str)
str.destructive_instance_str_to_digits! # result overrides str 
```

# sql-server - 尝试使用 3 LEFT JOIN 进行 GROUP BY 消除重复行

> ID：15420646
> 
> 赞同：2
> 
> 时间：2013-03-14T21:35:06.303
> 
> 标签：sql-server, group-by

我正在尝试修改现有查询，该查询显示共享 ID 的重复行，同时具有不同的辅助 ID。

```
SELECT  IM.*, C.Client, U.Name, R.FrequencyUnit, R.FrequencyDuration, R.RIID
FROM    itemsMisc IM
LEFT JOIN Clients C on C.ClientID = IM.ClientID
LEFT JOIN Users U on U.UserID = IM.UserID
LEFT JOIN Recurringitem R ON (R.ClientID = C.ClientID AND IM.Rate = R.Rate AND IM.Title = R.Title)
WHERE   (IM.CID = <cfqueryparam cfsqltype="CF_SQL_INTEGER" value="#CID#">) 
  AND   (IM.Invoiced = 0)
ORDER BY IM.DateCompleted ASC; 
```

发生的情况是，如果同一个用户制作了 2 个类似的重复项目，则重复的行显示为具有相同的 IMID（来自 itemsMisc），但具有来自 Recurringitems 的不同 RIID。

我在 IMID 上尝试了 GROUP BY，发现我必须在 GROUP BY 中包含所有选择的项目，这让我无处可去。

```
SELECT IM.IMID, IM.UserID, IM.ClientID, IM.Rate, IM.Title, IM.CID, IM.QTY, IM.DateCompleted, C.Client, U.Name, R.FrequencyUnit, R.FrequencyDuration, R.RBID
FROM    ItemMisc IM
LEFT JOIN Clients C on C.ClientID = IM.ClientID
LEFT JOIN Users U on U.UserID = IM.UserID
LEFT JOIN Recurringitem R ON (R.ClientID = C.ClientID AND IM.Rate = R.Rate AND IM.Title = R.Title)
WHERE   (IM.CID = <cfqueryparam cfsqltype="CF_SQL_INTEGER" value="#CID#">) 
  AND   (IM.Invoiced = 0)
GROUP BY IM.IMID, IM.UserID, IM.ClientID, IM.Rate, IM.Title, IM.CID, IM.QTY, IM.DateCompleted, C.Client, U.Name, R.FrequencyUnit, R.FrequencyDuration, R.RBID
ORDER BY IM.DateCompleted ASC; 
```

如果我能澄清任何事情，请告诉我。

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T21:49:35.480

你有一些选择

*   `R.RBID`你可以从你的`select`and`group by`子句中删除
*   在 Rate、Title、FrequencyUnit、FrequencyDuration 上创建一个唯一键，这样您就不会得到“相似的项目”
*   每个 Rate、Title、FrequencyUnit、FrequencyDuration 只获取一个 R.RBID

如果它是您想要的最后一个，您可以使用 row_number 来获取一个且只有一个 RBID（速率、标题、频率单位和频率持续时间）

```
WITH cte 
     AS (SELECT IM.imid, IM.userid, IM.clientid, IM.rate, 
                IM.title, IM.cid,  IM.qty, IM.datecompleted, 
                C.client, U.name, R.frequencyunit, R.frequencyduration, 
                R.rbid, 
                Row_number() 
                  OVER ( 
                    partition BY R.rate, R.title, R.frequencyunit, R.frequencyduration 
                    ORDER BY R.rbid ) rn 
         FROM   itemmisc IM 
                LEFT JOIN clients C 
                       ON C.clientid = IM.clientid 
                LEFT JOIN users U 
                       ON U.userid = IM.userid 
                LEFT JOIN recurringitem R 
                       ON ( R.clientid = C.clientid 
                            AND IM.rate = R.rate 
                            AND IM.title = R.title ) 
        WHERE   (IM.CID = <cfqueryparam cfsqltype="CF_SQL_INTEGER" value="#CID#">) 
            AND   (IM.Invoiced = 0)
         GROUP  BY IM.imid, IM.userid, IM.clientid, IM.rate, 
                   IM.title, IM.cid, IM.qty, IM.datecompleted, 
                   C.client, U.name, R.frequencyunit, R.frequencyduration, 
                   R.rbid) 
SELECT * 
FROM   cte 
WHERE  rn = 1 
ORDER  BY im.datecompleted ASC 
```

注意：您可以通过修改成员来定义“相似项”`partition BY`

# python - 使用着色器显示 3d 场景后使用 QGLWidget.renderText 渲染文本

> ID：15420648
> 
> 赞同：1
> 
> 时间：2013-03-14T21:35:08.047
> 
> 标签：python, qt, opengl, pyside

我正在编写一个 3D 应用程序，它绘制一个 3D 场景并希望在这个 3D 场景上覆盖一些包含文本的 UI 元素。为此，我使用 Python 以及 PySide 和 PyOpenGL 库。我在 ubuntu linux（专有驱动程序）上使用 NVIDIA 卡。

我的paintGL函数看起来很像这样：

```
def paintGL(self):
    # Various clears...
    self.draw_3d_scene()
    self.draw_ui() 
```

在该`draw_3d_scene`方法中，我使用自定义着色器来显示我的 3d 对象（主要是球体）。着色器和顶点缓冲区对象在代码的不同部分初始化，如果重要的话，在调用 initializeGL 之后。

在`draw_ui`我尝试以这种方式绘制文本时：

```
def draw_ui(self):
    glUseProgram(0)
    glColor3f(0.0, 0.0, 0.0) # Black text
    self.renderText(100, 100, "Hello, World") 
```

如果我以这种方式运行程序，我会获得 3D 场景，但不会获得文本。如果我同时注释着色器/顶点缓冲区初始化代码（当然还有 3d 场景绘图），我会正确获取文本。如果我离开着色器/顶点缓冲区初始化代码并删除绘图部分，我不会得到文本。

我希望使用 glUseProgram(0) 将我恢复到固定管道并让我正确绘制文本。

有人知道我做错了什么吗？

编辑1：

我试图更好地隔离程序，我想我找到了解决方案（我仍然不明白为什么这会干扰 renderText）：

似乎与 glBindBuffer 有关。当我使用顶点缓冲区时，我忘记取消绑定它们。现在，如果我使用：

```
glBindBuffer(GL_ARRAY_BUFFER, 0) 
```

绑定缓冲区后，我终于可以看到显示的文本

# asp.net - ASP.NET DLL 实例冲突

> ID：15420653
> 
> 赞同：1
> 
> 时间：2013-03-14T21:35:12.163
> 
> 标签：asp.net, vb.net

我是 asp.net 的新手，我正在尝试解决一个问题。

我创建了一个引用 vb.net 类的简单 aspx 页面（asp 网站）。我正在使用会话上下文对象处理一个类实例（不知道是否有更好的方法）。该类有一个设置字符串值的 sub 和一个返回它的函数。

我编译并运行网站项目，然后从一个 aspx 页面设置值“1”，从另一个页面设置值“2”（我通过从第一页复制粘贴 URL 打开第二个选项卡或浏览器）然后检索值，两个页面都将显示“2”。

vb.net 表单应用程序 (.exe) 中的同一个类在 exe 实例运行时工作得很好，第一个返回值“1”，第二个返回值“2”。这就是我希望它在我的网站项目中工作的方式，不同的页面不同的 dll 实例。

```
Class:
Public Class Class1

    Private sExten As String

    Public Sub setExten(value As String)
        sExten = value
    End Sub

    Public Function getExten() As String
        Return sExten
    End Function

End Class

aspx:
Partial Class _Default
    Inherits System.Web.UI.Page

    'trying to ensure one instance is running
    Protected Sub Page_Load(sender As Object, e As EventArgs) Handles Me.Load
        If Not Page.IsPostBack Then
            Session.Add("ClassLibrary1", New ClassLibrary1.Class1)
        End If
    End Sub

    'txtSetValue.text contains value "1" or "2"
    Protected Sub btnSet_Click(sender As Object, e As EventArgs) Handles btnSet.Click
        CType(Session.Item("ClassLibrary1"), ClassLibrary1.Class1).setExten(txtSetValue.text)
    End Sub

    'the txtShowValue shows "1" in the first and "2" in the second page
    Protected Sub BtnGet_Click(sender As Object, e As EventArgs) Handles BtnGet.Click
        txtShowValue.Text = CType(Session.Item("ClassLibrary1"), ClassLibrary1.Class1).getExten()
    End Sub

End Class 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T22:06:39.247

两个页面共享相同的 Session.Item("ClassLibrary1")。您可以尝试将值存储在隐藏字段或不可见标签中。

# r - 识别数据框中具有多个重复项的行并对其进行计数

> ID：15420654
> 
> 赞同：-1
> 
> 时间：2013-03-14T21:35:12.380
> 
> 标签：r

我对此数据框有疑问，位于此链接中：

[https://dl.dropbox.com/u/83787253/Base.RData](https://dl.dropbox.com/u/83787253/Base.RData)

我的问题是我想识别具有多个重复项的行。我使用此代码来解决我的问题，但它计算所有行，包括唯一的行。

```
z1=data.frame(ddply(Base, .(TIPO_MOVIMIENTO,FECHA.DE.PROCESO.DEL.SISTEMA.DEL.MOVIMIENTO,FECHA.REAL.DEL.MOVIMIENTO,VALOR_TOTAL_MOVIMIENTO,NOMBRE.DEL.MOVIMIENTO.Y.NTAD.NTAC,ID,Categoria),summarise,X=length(ID))) 
```

它有效，但我不知道如何仅获取具有多个重复项的行。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T22:40:28.350

一个`data.table`答案

```
DT <- data.table(d, key = 'ID')
DTu <- unique(DT)[,N:=0L][DT[, .N,by = list(ID, Amount)][N >1], N := i.N]
DTu
##     ID Amount N
## 1: 001     10 2
## 2: 002     20 0
## 3: 003     50 2
## 4: 004     30 0 
```

这将创建一个唯一的`data.table`（基于键），该`N=0`data.table 中的集合，然后它与已计算行数的 data.table 连接，该数据表是包含大于 1 的计数的子集，然后在其中分配这个新计数唯一的 data.table，用正确的数字覆盖 N=0。

第二种可能更简单的方法（使用问题中的更新数据，其中包括一个类列）

```
 DT[, .N  ,by = list(ID, Class)][,list(dups = sum(N[N>1])) ,by= ID]
    ID dups
1: 001    2
2: 002    0
3: 003    2
4: 004    0 
```

# tsql - 如何编写多参数 CTE 脚本？

> ID：15420655
> 
> 赞同：1
> 
> 时间：2013-03-14T21:35:14.360
> 
> 标签：tsql, common-table-expression

我正在尝试为使用 CTE 根据所选参数选择记录的 SSRS 报告编写 TSQL 脚本。我正在寻找最有效的方法来做到这一点，无论是在 TSQL 和/或 SSRS 中。我有 4 个参数可以设置为 NULL（所有值）或一个特定值。然后在我的 CTE 中，我有以下行：

```
 ROW_NUMBER() over(partition by G.[program_providing_service],G.people_id
    order by G.[actual_date] desc) as rowID 
```

上面的 CTE 适用于 Program 为 NULL 且 People 不为 null 的情况。我的4个参数是：

计划、设施、员工和人员。

所以我只想在它们为 NULL 时对值进行分区。目前，我根据参数值通过一个 CTE 来实现这一点。例如，如果他们为除 People 之外的所有参数选择 NULL，则此 CTE 将如下所示：

```
 ROW_NUMBER() over(partition by G.people_id
    order by G.[actual_date] desc) as rowID 
```

或者如果所有 5 个参数都为空：

```
 ROW_NUMBER() over(partition by G.[program_providing_service], G.[site_providing_service], G.staff_id, G.people_id
    order by G.[actual_date] desc) as rowID 
```

如果他们没有为 4 个参数中的任何一个选择 NULL，那么我可能不需要按任何字段进行分区，因为我只想要按实际日期降序排序的前 1 条记录。这是我的 CTE 的样子：

```
;with cte as
(
Select    distinct
    G.[actual_date],
    G.[site_providing_service],
    p.[program_name],
    G.[staff_id],
    G.program_providing_service,
    ROW_NUMBER() over(partition by G.[program_providing_service],G.people_id
    order by G.[actual_date] desc) as rowID

From 
event_log_rv G With (NoLock)

WHERE 
...
AND (@ClientID Is Null OR [people_id]=@ClientID)
AND (@StaffID Is Null OR [staff_id] = @StaffID)
AND (@FacilityID Is Null OR [site_providing_service] = @FacilityID)
AND (@ProgramID Is Null OR [program_providing_service] = @ProgramID)
and (@SupervisorID is NULL OR staff_id in (select staff_id from #supervisors))
)
SELECT 
    [actual_date],
    [site_providing_service],
    [program_name],
    [staff_id],
    program_providing_service,
    people_id,
    rowID

FROM cte WHERE rowid = 1
ORDER BY [Client_FullName] 
```

其中 ROW_NUMBER 行因所选参数而异。目前我在这个 TSQL 脚本中有 5 个 IF 语句，如下所示：

```
IF @ProgramID IS NOT NULL AND @ClientID IS NULL
BEGIN
...
END

with one CTE in each of these IF statements:

IF @FacilityID IS NOT NULL AND @ClientID IS NULL
BEGIN
...

END

IF @ProgramID IS NOT NULL AND @ClientID IS NULL
BEGIN
...
END

IF @StaffID IS NOT NULL AND @ClientID IS NULL
BEGIN
...

END

IF @ClientID IS NOT NULL
BEGIN
...
END 
```

我如何为所有可能的选项编码，无论他们选择 NULL 还是特定值？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T05:51:42.297

OMG....我花了很长时间才试图理解你想要做什么。你的描述有些矛盾。请修改您的描述。就像您说的那样，您只想在值为 NULL 时对值进行分区；然后您还说，当他们为除人员以外的所有参数选择 NULL 时，您就对人员进行分区....

不管你想实现什么方式，partition on 'null' or 'not null'，都可以通过构造动态sql来实现，而不用加很多[if...else]

以下代码是伪代码，绝对未经测试。只是给你一个提示。以下代码有一个假设，即您的参数在分区顺序中具有优先级，例如，如果 Program 不为 null（或 null），则 Program 在第一个位置。

```
 declare @sql varchar(max)
    set @sql = '
    ;with cte as
    (
    Select    distinct
        G.[actual_date],
        G.[site_providing_service],
        p.[program_name],
        G.[staff_id],
        G.program_providing_service,
        ROW_NUMBER() over(partition by
    '
    if(@progarm is null)
       set @sql = @sql + 'G.[program_providing_service],'
    if(@facility is null) 
       set @sql = @sql + 'G.[site_providing_service],'
    if(@staff is null )
       set @sql = @sql + 'G.staff_id,'
    if(@people is null)
       set @sql = @sql + 'G.people_id'
    set @sql = @sql + '
        order by G.[actual_date] desc) as rowID
    From 
    event_log_rv G With (NoLock)
    WHERE 
    ...
    AND (@ClientID Is Null OR [people_id]=@ClientID)
    AND (@StaffID Is Null OR [staff_id] = @StaffID)
    AND (@FacilityID Is Null OR [site_providing_service] = @FacilityID)
    AND (@ProgramID Is Null OR [program_providing_service] = @ProgramID)
    and (@SupervisorID is NULL OR staff_id in (select staff_id from #supervisors))
    )
    SELECT 
        [actual_date],
        [site_providing_service],
        [program_name],
        [staff_id],
        program_providing_service,
        people_id,
        rowID
    FROM cte WHERE rowid = 1
    ORDER BY [Client_FullName]
    '
    exec(@sql) 
```

# silverlight - 将文本数据从 silverlight 传递到普通页面

> ID：15420658
> 
> 赞同：0
> 
> 时间：2013-03-14T21:35:18.793
> 
> 标签：silverlight, text, clipboard, paste

我在 Silverlight 中编写了应用程序，它从网络摄像头读取二维码。我需要将数据（粘贴纯文本）从silverlight 传递到页面上包含silverlight 的活动字段，但不在silverlight 内。有没有办法做到这一点？用户通过向网络摄像头显示 qrcode 进行交互也受到限制，而不是实际单击任何内容（剪贴板和 silverlight 的问题 - 只能在某些情况下使用）。欢迎任何建议或指导。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T21:45:12.990

您可以与托管 Silverlight 对象的页面进行交互。来自银光：

```
HtmlPage.Window.Eval(string.Format("processQrCode('{0}')", textData) 
```

页面中应该有javascript：

```
function processQrCode(data) {
    // Do something with the data here
} 
```

# css - 由于父级的最大宽度，下拉菜单被切断

> ID：15420667
> 
> 赞同：0
> 
> 时间：2013-03-14T21:35:50.157
> 
> 标签：css, wordpress, megamenu

我已将[Mega Menu 插件](http://wordpress.org/extend/plugins/jquery-mega-menu/)集成到我正在开发的 Wordpress 网站中。最后一个菜单项被截断，因为主容器已`max-width`设置。我希望最后一项溢出，同时仍然保持不变`max-width`。我已经尝试在 menu和main容器上设置`overflow-x`和，但无济于事。 `z-index``ul``li``div`

**编辑**：菜单的父级了`overlow: hidden`。设置它来`overflow: inherit`解决问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T21:38:49.887

`<div id="wrapper">`越来越`overflow: hidden`。如果您删除它，您的菜单将不会被切断。

# lucene - 为什么 Lucene IndexWriter 会覆盖以前的文档？

> ID：15420670
> 
> 赞同：0
> 
> 时间：2013-03-14T21:35:59.200
> 
> 标签：lucene

我不明白关于 Lucene 索引器的这个问题。打开 indexwriter 后，添加一些新文档，然后将其关闭。使用同一目录重新打开 indexwriter，添加一些新文档。然后所有以前的文件都不见了。我只是想不通它为什么会这样。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-21T23:08:09.110

正如上面 Zincup 所指出的，在将文档添加到现有索引时，您需要将 deletePolicy 设置为 false。*（在这里添加，所以这个问题有一个正式的答案。）*

# pandas - IPython Notebook：默认编码是什么？

> ID：15420672
> 
> 赞同：24
> 
> 时间：2013-03-14T21:36:12.817
> 
> 标签：pandas, ipython, ipython-notebook

我已经使用编码 utf-8 创建了一个包。

调用函数时，它会返回一个`DataFrame`, 并带有一个以 utf-8 编码的列。

在命令行中使用 IPython 时，显示该表的内容没有任何问题。使用笔记本时，它会因错误而崩溃`'utf8' codec can't decode byte 0xe7`。我在下面附上了完整的追溯。

与 Notebook 一起使用的正确编码是什么？

```
UnicodeDecodeError                        Traceback (most recent call last)
<ipython-input-13-92c0011919e7> in <module>()
      3 ver = verif.VerificacaoNA()
      4 comp, total = ver.executarCompRealFisica(DT_INI, DT_FIN)
----> 5 comp

c:\Python27-32\lib\site-packages\ipython-0.13.1-py2.7.egg\IPython\core\displayhook.pyc in __call__(self, result)
    240             self.update_user_ns(result)
    241             self.log_output(format_dict)
--> 242             self.finish_displayhook()
    243 
    244     def flush(self):

c:\Python27-32\lib\site-packages\ipython-0.13.1-py2.7.egg\IPython\zmq\displayhook.pyc in finish_displayhook(self)
     59         sys.stdout.flush()
     60         sys.stderr.flush()
---> 61         self.session.send(self.pub_socket, self.msg, ident=self.topic)
     62         self.msg = None
     63 

c:\Python27-32\lib\site-packages\ipython-0.13.1-py2.7.egg\IPython\zmq\session.pyc in send(self, stream, msg_or_type, content, parent, ident, buffers, subheader, track, header)
    557 
    558         buffers = [] if buffers is None else buffers
--> 559         to_send = self.serialize(msg, ident)
    560         flag = 0
    561         if buffers:

c:\Python27-32\lib\site-packages\ipython-0.13.1-py2.7.egg\IPython\zmq\session.pyc in serialize(self, msg, ident)
    461             content = self.none
    462         elif isinstance(content, dict):
--> 463             content = self.pack(content)
    464         elif isinstance(content, bytes):
    465             # content is already packed, as in a relayed message

c:\Python27-32\lib\site-packages\ipython-0.13.1-py2.7.egg\IPython\zmq\session.pyc in <lambda>(obj)
     76 
     77 # ISO8601-ify datetime objects
---> 78 json_packer = lambda obj: jsonapi.dumps(obj, default=date_default)
     79 json_unpacker = lambda s: extract_dates(jsonapi.loads(s))
     80 

c:\Python27-32\lib\site-packages\pyzmq-13.0.0-py2.7-win32.egg\zmq\utils\jsonapi.pyc in dumps(o, **kwargs)
     70         kwargs['separators'] = (',', ':')
     71 
---> 72     return _squash_unicode(jsonmod.dumps(o, **kwargs))
     73 
     74 def loads(s, **kwargs):

c:\Python27-32\lib\json\__init__.pyc in dumps(obj, skipkeys, ensure_ascii, check_circular, allow_nan, cls, indent, separators, encoding, default, **kw)
    236         check_circular=check_circular, allow_nan=allow_nan, indent=indent,
    237         separators=separators, encoding=encoding, default=default,
--> 238         **kw).encode(obj)
    239 
    240 

c:\Python27-32\lib\json\encoder.pyc in encode(self, o)
    199         # exceptions aren't as detailed.  The list call should be roughly
    200         # equivalent to the PySequence_Fast that ''.join() would do.
--> 201         chunks = self.iterencode(o, _one_shot=True)
    202         if not isinstance(chunks, (list, tuple)):
    203             chunks = list(chunks)

c:\Python27-32\lib\json\encoder.pyc in iterencode(self, o, _one_shot)
    262                 self.key_separator, self.item_separator, self.sort_keys,
    263                 self.skipkeys, _one_shot)
--> 264         return _iterencode(o, 0)
    265 
    266 def _make_iterencode(markers, _default, _encoder, _indent, _floatstr,

UnicodeDecodeError: 'utf8' codec can't decode byte 0xe7 in position 199: invalid continuation byte 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-09-30T08:01:28.067

我最近遇到了同样的问题，确实将默认编码设置为 UTF-8 就可以了：

```
import sys
reload(sys)
sys.setdefaultencoding("utf-8") 
```

在我的环境（Python 2.7.3）上运行`sys.getdefaultencoding()`产生了`'ascii'`，所以我猜这是默认设置。

另请参阅[此相关问题](https://stackoverflow.com/questions/2276200/changing-default-encoding-of-python)和[Ian Bicking 关于该主题的博客文章](http://blog.ianbicking.org/illusive-setdefaultencoding.html)。

# ios - 有人知道 Xamarin MonoTouch 自定义 UITableViewCell 的好教程吗？

> ID：15420675
> 
> 赞同：3
> 
> 时间：2013-03-14T21:36:30.117
> 
> 标签：ios, uitableview, customization, xamarin.ios

我一直在寻找一个很好的教程，但我没有成功。他们网站上的文档/教程真的很混乱，并没有说明如何在界面构建器中连接东西。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-14T21:57:04.110

亚历克斯·约克（Alex York）有一篇关于这样做的非常好的[博客文章](http://www.alexyork.net/blog/2011/07/18/creating-custom-uitableviewcells-with-monotouch-the-correct-way/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T10:25:31.393

您可能会发现这也很有用：

创建 UITableViewCells 的模式 [http://tirania.org/monomac/archive/2011/Jan-18.html](http://tirania.org/monomac/archive/2011/Jan-18.html)

强烈推荐！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-15T15:41:10.963

我发现本教程非常有用：

[http://www.arcticmill.com/2012/05/uitableview-with-custom-uitableviewcell.html#comment-1937](http://www.arcticmill.com/2012/05/uitableview-with-custom-uitableviewcell.html#comment-1937)

唯一的问题是它正在创建一个 Nib 文件，并且没有显示如何使用 StoryBoard 进行操作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-19T15:00:55.387

在使用情节提要的情况下，您也必须将单元格加载为单独的 Nib/Xib 文件。参见[IB 的原型单元参考](https://stackoverflow.com/questions/14966278/reference-of-prototype-cells-from-ib)

# java - JBOSS AS7 -SSL .PEM 证书添加错误“别名 xxxx 无法识别密钥条目

> ID：15420680
> 
> 赞同：2
> 
> 时间：2013-03-14T21:36:38.387
> 
> 标签：java, ssl, jboss

客户公司给了我一个 .pem 文件和一个密码，可以添加到 JBOSS AS7 上。

这是我所做的：

1.  `keytool -import -alias runtime -file mymobile.com.pem -keystore /opt/my/ssl/my.keystore`
2.  它提示输入密钥库的密码，然后我传递给我的密码。
3.  之后它确认密码，然后询问我是否信任证书
4.  在输入 YES 时，它会显示一条消息，表明证书已添加到密钥库，并且在指定路径生成密钥库。
5.  现在我在 jboss 的standalone.xml 中添加以下内容：`ssl name="ssl" key-alias="runtime" password="mypass" certificate-key-file="/opt/my/ssl/jboss.keystore" cipher-suite="ALL" protocol="TLS"`

但是当我重新启动 JBOSS 时。它向我抛出错误：

```
2013-03-14 10:18:32,249 ERROR [org.apache.coyote.http11.Http11Protocol] (MSC service thread 1-22) Error initializing endpoint: java.io.IOException: **Alias name runtime does not identify a key entry**
    at org.apache.tomcat.util.net.jsse.JSSESocketFactory.getKeyManagers(JSSESocketFactory.java:517) [jbossweb-7.0.13.Final.jar:]
    at org.apache.tomcat.util.net.jsse.JSSESocketFactory.init(JSSESocketFactory.java:452) [jbossweb-7.0.13.Final.jar:]
    at org.apache.tomcat.util.net.jsse.JSSESocketFactory.createSocket(JSSESocketFactory.java:168) [jbossweb-7.0.13.Final.jar:]
    at org.apache.tomcat.util.net.JIoEndpoint.init(JIoEndpoint.java:977) [jbossweb-7.0.13.Final.jar:]
    at org.apache.coyote.http11.Http11Protocol.init(Http11Protocol.java:190) [jbossweb-7.0.13.Final.jar:]
    at org.apache.catalina.connector.Connector.init(Connector.java:983) [jbossweb-7.0.13.Final.jar:] 
```

请帮助我，因为我有来自客户的压力......

# css - CSS-Mobile Safari 和 Chrome 中的密码字段高度

> ID：15420682
> 
> 赞同：0
> 
> 时间：2013-03-14T21:36:39.470
> 
> 标签：css, mobile-safari, mobile-chrome

即使我将 style="height:22px" 直接应用于两个元素，我也遇到了密码字段的高度与其上方的文本字段不同的问题。

当前的 HTML：

```
 <h2>Username 
    <label>
      <input name="email" type="text" id="email" style="height:22px" />
      </label>
  </h2>
  <h2>Password  
    <label>
      <input name="password" type="password" id="password"style="height:22px"  />
      </label>
  </h2> 
```

当前的 CSS：

```
#logonForm input[type=text], #logonForm input[type=password] { 
    font-size:18px;
    border-radius:8px;
    padding-left:10px;
    height:22px;
    width:364px;
} 
```

这呈现（带有或不带有样式属性）为

![截屏](../Images/5d789a8ca6b9fcf6359ebb4566536bb2.png)

如何使它呈现为相同的高度，为什么会发生这种情况？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T22:07:21.970

您可能必须为所有边添加显式填充，而不仅仅是 padding-left：

```
#logonForm input[type=text], #logonForm input[type=password] { 
    font-size:18px;
    border-radius:8px;
    padding:0 0 0 10px;
    height:22px;
    width:364px;
} 
```

# sql - 您如何对编码或加密数据进行 PostgreSQL 全文搜索？

> ID：15420689
> 
> 赞同：5
> 
> 时间：2013-03-14T21:37:02.087
> 
> 标签：sql, postgresql, encryption, base64

出于各种无关紧要的原因，我们在 PostgreSQL 中以加密或 base64 编码格式存储文本块。但是，我们希望能够使用 PostgreSQL 的全文搜索来查找并返回未加密/解码形式与搜索查询匹配的数据。

一个人将如何实现这一目标？我已经看到其他帖子提到了在将数据发送到数据库之前构建 tsvector 值的能力，但我希望在 Postgres 端有一些可用的东西（至少对于 base64 文本）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-14T23:29:55.987

## 加密值

对于加密值，您不能。即使您创建了`tsvector`客户端，tsvector 也会包含加密文本的形式，因此大多数应用程序都无法接受它。观察：

```
regress=> SELECT to_tsvector('my secret password is CandyStrip3r');
               to_tsvector                
------------------------------------------
 'candystrip3r':5 'password':3 'secret':2
(1 row) 
```

...哎呀。如果您创建该值客户端而不是使用它并不重要`to_tsvector`，它仍然会以明文形式保存您的密码。您可以加密 tsvector，但不能将其用于全文搜索。

当然，给定加密值：

```
CREATE EXTENSION pgcrypto;

regress=> SELECT encrypt( convert_to('my s3kritPassw1rd','utf-8'), '\xdeadbeef', 'aes');
                              encrypt                               
--------------------------------------------------------------------
 \x10441717bfc843677d2b76ac357a55ac5566ffe737105332552f98c2338480ff
(1 row) 
```

你*可以*（但不应该）做这样的事情：

```
regress=> SELECT to_tsvector( convert_from(decrypt('\x10441717bfc843677d2b76ac357a55ac5566ffe737105332552f98c2338480ff', '\xdeadbeef', 'aes'), 'utf-8') );
    to_tsvector     
--------------------
 's3kritpassw1rd':2
(1 row) 
```

...但是如果在代码显示框中向右滚动后问题不是很明显，那么您真的应该让其他人为您进行安全设计;-)

关于在不解密加密值的情况下对加密值执行操作的方法有大量研究，例如将两个加密数字加在一起以产生使用相同密钥加密的结果，因此进行加法的过程不需要解密输入的能力为了得到输出。其中一些可能适用于 fts - 但它超出了我在该领域的专业水平，并且可能非常低效和/或加密弱。

## Base64 编码值

对于 base64，您`decode`在将其送入`to_tsvector`. 因为`decode`返回 a`bytea`并且您知道编码数据是您需要用来`convert_from`解码数据库编码`bytea`中`text`的文本，例如：

```
regress=> SELECT encode(convert_to('some text to search','utf-8'), 'base64');
            encode            
------------------------------
 c29tZSB0ZXh0IHRvIHNlYXJjaA==
(1 row)

regress=> SELECT to_tsvector(convert_from( decode('c29tZSB0ZXh0IHRvIHNlYXJjaA==', 'base64'), getdatabaseencoding() ));
     to_tsvector     
---------------------
 'search':4 'text':2
(1 row) 
```

In this case I've used the database encoding as the input to `convert_from`, but you need to make sure you use the encoding that the underlying `base64` encoded text was in. Your application is responsible for getting this right. I suggest either storing the encoding in a 2nd column or ensuring that your application *always* encodes the text as `utf-8` before applying `base64` encoding.

# c# - 如何在 C# 中从 3x3 单应矩阵获取旋转、平移、剪切

> ID：15420693
> 
> 赞同：4
> 
> 时间：2013-03-14T21:37:28.273
> 
> 标签：c#, windows-8, transformation, homography

我计算了 3x3 单应矩阵，我需要获得旋转、平移、剪切和缩放以将它们用作 windows8 媒体元素属性中的参数？！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-18T14:12:40.273

见[https://math.stackexchange.com/questions/78137/decomposition-of-a-nonsquare-affine-matrix](https://math.stackexchange.com/questions/78137/decomposition-of-a-nonsquare-affine-matrix)

```
def getComponents(normalised_homography):
  '''((translationx, translationy), rotation, (scalex, scaley), shear)'''
  a = normalised_homography[0,0]
  b = normalised_homography[0,1]
  c = normalised_homography[0,2]
  d = normalised_homography[1,0]
  e = normalised_homography[1,1]
  f = normalised_homography[1,2]

  p = math.sqrt(a*a + b*b)
  r = (a*e - b*d)/(p)
  q = (a*d+b*e)/(a*e - b*d)

  translation = (c,f)
  scale = (p,r)
  shear = q
  theta = math.atan2(b,a)

  return (translation, theta, scale, shear) 
```

# c - 如何在 C 中创建字符串类型的变量

> ID：15420696
> 
> 赞同：13
> 
> 时间：2013-03-14T21:37:41.780
> 
> 标签：c, python, c, string, variable-declaration

**问题**

如何在 C 中声明一个字符串变量？

**背景**

为了学习[c](/questions/tagged/c "显示标记为“c”的问题")的基础知识，我试图将我最古老的[python](/questions/tagged/python "显示标记为“python”的问题")程序之一移植`Bob`到 C。在程序中，脚本要求用户提供有关他或她自己的信息，然后吐出响应。几乎所有这些变量都`raw_input`用于它们的信息 - 变量是字符串。但是，我发现没有办法声明 C 变量。

**代码**

到目前为止，我已经尝试将变量声明为类型`char`，`int.`这是代码，您可以随意切换类型。

```
int main(int argc, const char * argv[])
{

    int name;
    printf("What is your name?");
    scanf("%s",&name);
    printf("Your name is %s", name );

    return 0;
} 
```

**错误信息**

当我运行这段代码时，会`Xcode`返回一些奇怪的东西。globidty-gloop 的这一部分被突出显示。

```
0x7fff96d2b4f0:  pcmpeqb(%rdi), %xmm0 
```

最后，[这个 Yahoo Answer](http://answers.yahoo.com/question/index?qid=20080715104545AA4uejN)说我必须使用一个叫做`character array`. 它是 5 年前发布的，所以我认为有更好的方法。

**编辑**

我正在学习[C Programming](http://www.cprogramming.com/tutorial/c-tutorial.html)的教程。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-14T21:40:00.820

```
char name[60];
scanf("%s", name); 
```

编辑：将输入长度限制为 59 个字符（加上终止 0）：

```
char name[60];
scanf("%59s", name); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-01-15T21:51:52.797

您放置的 int 不是字符串，字符串看起来像“char myString[20]”。不像“int name”，它是一个整数，而不是字符串或字符。这是你想要的代码：

```
 int main(int argc, const char * argv[])
{

char name[9999];
printf("What is your name?\n");
scanf("%s", name);
system("cls");
printf("Your name is %s", name);

return 0;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-15T04:32:11.097

在 C 中，您不能像 Java 和其他语言那样直接声明字符串变量。您必须使用字符数组或指针来声明字符串。

```
char a[50];
printf("Enter your string");
gets(a); 
```

或者

```
char *a;
printf("Enter your string here");
gets(a); 
```

或者

```
char a[60];
scanf("%59s",a); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-14T22:01:30.043

***在 XCODE 上测试***

你可以这样做：

```
int main(int argc, const char * argv[])
{

    int i;
    char name[60]; //array, every cell contains a character

    //But here initialize your array

    printf("What is your name?\n");
    fgets(name, sizeof(name), stdin);
    printf("Your name is %s", name );

    return 0;
} 
```

初始化数组，很好的避免bug

```
for(i=0;i<60;i++){
      name[i]='\0'; //null
} 
```

而是`int`用于 int number (1, 2, 3, ecc.); 对于浮点数，您必须使用`float`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-04-13T12:27:57.983

C 没有字符串变量类型。字符串可以存储为**字符数组**（char 变量类型）。我要补充的最基本的例子是：

```
int main()
{
   char name[] = "Hello World!";
   printf("%s",name);
   return(0);
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-08-13T04:32:53.640

# 这很简单！

`main()`只需将这一行放在下面，在你的函数之上。

```
typedef string char*; 
```

这使您可以像在 C 中处理*整数*或*字符*一样创建字符串变量。之后，您的程序应如下所示：

```
#include <stdio.h>

typedef char* string;

int main(void) {
    string a = "Hello";
    printf("%s\n", a);  // %s format specifier for String
    return 0;
} 
```

如需**现场演示**，请访问[此 REPL.it。](https://repl.it/@AbhigyanKumar/ModernBlindShareware)

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2019-03-01T11:39:27.057

通常我们在 scanf 中使用“&”，但你不应该在变量“name”之前使用它。因为“名称”是一个字符数组。当字符数组的名称不带“[]”时，表示数组的地址。

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2018-04-10T22:08:35.953

替换整数名称；至 - 。字符名称[60]；

```
#include <stdio.h>
int main()
{
  char name[648];
  printf("What is your name?");

  scanf("%s", name);
  printf("Your name is %s", name );

  return 0;
} 
```

# css - CSS 不允许滚动

> ID：15420697
> 
> 赞同：-3
> 
> 时间：2013-03-14T21:37:43.140
> 
> 标签：css, scroll

在其当前形式下，下面的 CSS 不允许我的页面滚动。但是，如果我禁用下面的 CSS 代码，则页面允许滚动。我已经尝试`overflow`一遍又一遍地设置属性，使用`height: 130%`允许我看到一个滚动条，但页面实际上仍然没有滚动。

这是一个显示我的问题的[JSFiddle 。](http://jsfiddle.net/UDFrA/)

```
h1{
color: #FFF;
}

h3{
font-size: 25px;
    color: #990000;
    text-decoration: none;
    font-family: 'Chivo';
}

h5 {
    color: #bb0000;
    text-decoration: none;
    font-family: 'Chivo';
    font-size: 40px;
    line-height: 1em;
    font-weight: bold;

    }

h5:focus {
    outline: thin dotted rgb(51, 51, 51);
        outline-width: thin;
        outline-style: dotted;
        outline-color: rgb(51, 51, 51);
    outline-offset: -2px;
}

h5:hover, a:active {
text-decoration: underline;
color: #990000;
outline: 0;
outline-color: initial;
outline-style: initial;
outline-width: 0px;
}

/*box!*/

#boxdrop{
box-shadow: 0px 0px 10px grey;
position:fixed;
background-attachment:scroll;
left:10px;
}
#boxdrop2{box-shadow: 0px 0px 10px grey;}

.boxbg { background-color:#ccc;background-attachment:scroll; }
.boxbg2 { background-color:#ddd; background-attachment:scroll;}
.boxbg3 { background-color:#eee;background-attachment:scroll;}
.all-round {
border-radius:1em;
-moz-border-radius:1em;
-webkit-border-radius:1em;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-14T21:54:00.197

如果您想恢复滚动，请`position:fixed`从您的 boxdrop div 中删除。

```
#boxdrop{
box-shadow: 0px 0px 10px grey;
background-attachment:scroll;
left:10px;
} 
```

**[jsFiddle 示例](http://jsfiddle.net/j08691/UDFrA/1/)**

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-14T21:56:19.303

我认为问题在于您的 HTML。你有两个`div`id `boxdrop2`。此外，您的`div`with id`boxdrop`具有一个`position:fixed`属性，因此`div`无法以任何方式滚动。每当您使用固定时，您都会消除任何滚动的机会，因为固定元素会离开页面中的元素流。

# registry - 通过 cmd 删除注册表项

> ID：15420700
> 
> 赞同：0
> 
> 时间：2013-03-14T21:38:21.710
> 
> 标签：registry

我尝试使用 cmd 删除注册表项。

```
 reg delete HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run\myProgramm 
```

`myProgramm`是我的钥匙。我想删除这个密钥。

我收到了这个错误：`This Registry-Key was not found`。如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T21:47:33.510

这可能是一个键值，而不是键。

也许试试

```
 REG DELETE HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run /v myProgramm 
```

# openssl - 什么是 PKCS#12 漏洞？

> ID：15420710
> 
> 赞同：0
> 
> 时间：2013-03-14T21:39:00.673
> 
> 标签：openssl, pkcs#12

我在假设每个安全协议都有漏洞的情况下问这个问题。

背景：我将使用 PKCS#12 将证书和匹配的私钥发送到 iPad，以便他们安装到他们的设备上。然后，我将让用户将 Cert/Priv 密钥安装到他们的钥匙串中，并在登录其他已部署的机器时将其用作身份。

实施 PKCS#12 时是否存在任何常见/严重错误？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T07:15:39.763

以下文档中列出了一些问题。您可能会发现一些有用的信息。

[http://www.drh-consultancy.demon.co.uk/pkcs12faq.html](http://www.drh-consultancy.demon.co.uk/pkcs12faq.html)

[ftp://ftp.rsasecurity.com/pub/pkcs/98workshop/privkey.pdf](ftp://ftp.rsasecurity.com/pub/pkcs/98workshop/privkey.pdf)

# html - CSS位置使图像预览一半可见

> ID：15420713
> 
> 赞同：0
> 
> 时间：2013-03-14T21:39:15.527
> 
> 标签：html, css

我正在做一个项目，我正在使用 woocommerce 动态图库专业插件来预览产品页面中的产品图片。但问题是预览图像在 IE 中显示一半。

请你们检查IE中的以下链接并帮助我修复。

[http://www.joannelouise.com/shop/sexy-ladies-red-embellished-dress/](http://www.joannelouise.com/shop/sexy-ladies-red-embellished-dress/)

我找到了解决方法，但我不明白我如何应用它。

我注意到如果我从以下课程中删除该职位，它可能会修复错误。但是当我给位置一些值时，比如绝对、相对、固定、静态甚至继承。在我离开职位之前，它没有给出任何回应。

所以请大家帮我解决这个问题。

以下是我的更改。影响 50%。

```
.ad-gallery .ad-image-wrapper .ad-image {
    overflow: visible !important;
    position: inherit !important;
} 
```

但是位置的东西不起作用

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T22:09:12.317

我现在不在寡妇盒子上，但这可能是没有清除浮动或父项不包含浮动的子项的情况。

尝试在未完全显示的任何图像的父容器上使用：溢出：自动。也可以尝试使用溢出：隐藏来实现相同但在某些情况下避免滚动条。

如果可能，尽量避免在生产站点上使用 !important。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-14T22:12:11.160

你真的应该避免这么多的内联样式。它导致混乱的代码和更多的工作。

出于某种原因，您设置`.ad-image`为`{top: 179px;}`. 试试这个（删除内联顶部语句后）：

```
.ad-gallery .ad-image-wrapper .ad-image {
    top: 0;
} 
```

奇怪的是，我`{top: .5px}`在 Firefox 中看到了。我不确定发生了什么事。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-14T22:16:09.600

OP，你用的是什么版本的IE？

> position 属性指定用于元素的定位方法的类型（静态、相对、绝对或固定）。
> 
> **注意：** IE7 及更早版本不支持值“inherit”。IE8 需要一个!DOCTYPE。IE9 支持“继承”。

通过[http://www.w3schools.com/cssref/pr_class_position.asp](http://www.w3schools.com/cssref/pr_class_position.asp)

IE 7/8 解决方法：

```
.ad-gallery .ad-image-wrapper .ad-image {
    overflow: visible !important;
   position: <whatever-the-parent-is> !important;
} 
```

由于 IE 7/8 不理解`inherit`元素父级的位置，因此您可以创建一个 CSS 规则来指定`position`您希望元素使用什么。

# c++ - / 不计算滴答声

> ID：15420715
> 
> 赞同：0
> 
> 时间：2013-03-14T21:39:35.280
> 
> 标签：c++, counting, ctime, time.h

**编辑：它现在似乎正在运行。代码已更新以显示我的修订。感谢大家的帮助。**

我想我只是愚蠢，但我正在尝试使用 ctime 来计算整个程序中的 CPU 滴答声。我正在为一个学校项目编写一个加密算法，并且我正在尝试包含一个计时器，以便我可以添加噪声过程，从而平衡不同密钥/明文组合之间的时间量。下面是对 ctime 的一个小测试：

```
#include <iostream>
#include <string>
#include <ctime>

int main (int arc, char **argv)
{
  double elapsedTime;
  const clock_t start = clock ();

  int uselessInt = 0;
  for (int i = 0; i <= 200; i++)
    {
      uselessInt = uselessInt * 2 / 3 + i;
      std::cout << uselessInt << std::endl;
    }

  clock_t end = clock();
  elapsedTime = static_cast<double>(end - start);

  std::cout << elapsedTime << " CPU ticks have elapsed since this application's initiation." << std::endl;
  return (0);
} 
```

打印：

```
0
1
2
4
/* ... long list of numbers ... */
591
594
0 CPU ticks have elapsed since this application's initiation.
[smalltock@localhost Desktop]$ 
```

我正在使用 GCC (G++)，看来 ctime/time.h 根本没有像我想要的那样计算滴答声。任何人都可以识别问题吗？我是这门语言的相对业余爱好者。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-14T21:47:34.747

`elapsedTime`在您的程序中是以秒为单位的时间度量，而不是时钟滴答计数。如果您想要刻度，请使用`duration`.

由于您的程序（大概）将大部分时间都花在了 I/O 上，因此不会过去多少秒。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-14T21:48:58.890

我的两分钱。当您执行 cin.get() 时，它会等待您在控制台上输入内容，您是否执行了任何操作或只是输入了 enter？

我确实在没有输入任何文本的情况下运行了您的代码，只需按 Enter 键，它就给出了以下输出：

```
Test Text
It's a stone, Luigi... you didn't make it.
0 CPU ticks have elapsed since this application's initiation.

Real    0m0.700s
User    0m0.000s
Sys     0m0.061s 
```

这可能是因为与您的程序使用的 CPU 时间相比，CLOCKS_PER_SEC 的精度有点“大”（以秒为单位）

同时，持续时间行中的语法错误，您要么错过了另一个），要么应该删除第一个（

顺便说一句：Real 是挂钟时间 - 从通话开始到结束的时间。

用户是进程内用户模式代码（内核外部）所花费的 CPU 时间量。这只是执行进程中使用的实际 CPU 时间。

Sys 是进程内在内核中花费的 CPU 时间量。

所以你基本上有 0 CPU 时间，因为你一直在等待 I/O，没有 CPU 计算。

# sql - T-SQL 动态地从测试转移到生产（第 2 部分）

> ID：15420724
> 
> 赞同：0
> 
> 时间：2013-03-14T21:40:22.110
> 
> 标签：sql, sql-server, tsql

好吧，自从我上一篇[文章](https://stackoverflow.com/questions/15372063/t-sql-move-from-test-to-production-dynamically)以来，我能够取得进步！但是，我遇到了另一个问题......再次：

目标：传入两个参数（一个任务和一个主键）以生成表列表。获取列表，然后动态构造插入语句，目的是将数据从生产环境复制到测试环境。换句话说，以编程方式执行 'EDIT TOP 200' 所做的......但要快得多。

问题（更新）：@tmpInserVars 不会随着每次迭代而更新。它在第一次输入代码时被设置，并且永远不会刷新。

迄今：

```
USE MAINDB
DECLARE @PK int = 1000,
 @TaskName nvarchar(50) = 'TASK', 
 @curTable nvarchar(75),
 @curRow nvarchar(75),
 @tmpStatement nvarchar(500),
 @tmpInsert nvarchar(500)

RAISERROR('Retrieving Tables',0,1) WITH NOWAIT
 DECLARE TableCursor CURSOR LOCAL FOR 

    SELECT DISTINCT TOP 2 PRMPTTBL.tTable as PromptTable
       FROM THING1 TK INNER JOIN THING2 SC ON TK.tkNo=SC.tkNo
              INNER JOIN Component EL on EL.scNo=SC.scNo             
              LEFT OUTER JOIN Field FLD1 on FLD1.cfNo=EL.cfNoPrompt1            
              LEFT OUTER JOIN MyTableTable MTTTBL on MTTTBL.tbNo=FLD1.tbNo

       WHERE EL.PK=@PK
              AND (MTTTBL.tTable is not NULL AND MTTTBL.tTable not in('OneTableIDontWant'))
              AND MTTTBL.tTable not like '%[_]d%' --eliminate any tables that are actually views
              AND EL.cfNo > 0  
              AND TK.Description like @TaskName

RAISERROR('Table',0,1) WITH NOWAIT
OPEN TableCursor
FETCH NEXT FROM TableCursor INTO @curTable
WHILE @@FETCH_STATUS = 0
BEGIN
   SET @tmpStatement = 'SELECT TOP 5 * FROM [MYCONN].TEST_MYDB.dbo.' + @curTable + ' where PK=' + Cast(@PK as nvarchar(10))
   EXEC (@tmpStatement)
   RAISERROR(N'Table (outside): %s',0,1,@curTable) WITH NOWAIT  

   IF @@ROWCOUNT = 0 
   BEGIN
        --@tmpInsertVars isn't updating!!!
        RAISERROR(N'Initial Select: %s',0,1,@tmpStatement) WITH NOWAIT
        SELECT @tmpInsertVars = COALESCE(@tmpInsertVars + ',','') + COLUMN_NAME 
        FROM PRODDB.INFORMATION_SCHEMA.COLUMNS
        WHERE TABLE_NAME = @curTable

        SET @tmpInsertStatement = 'INSERT INTO [MYCONN].TEST_MYDB.dbo.' + @curTable + ' (' + @tmpInsertVars + ')' +
                                  ' SELECT TOP 500 ' + @tmpInsertVars +
                                  ' FROM TEST_MYDB.' + @curTable +
                                  ' WHERE PK=' + Cast(@PK as nvarchar(10))

        RAISERROR(N'Insert Statement: %s',0,1,@tmpInsertStatement) WITH NOWAIT
   END

   FETCH NEXT FROM TableCursor INTO @curTable
END

CLOSE TableCursor
DEALLOCATE TableCursor 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T22:46:03.740

1.  声明您的 @tmpInsertStatement 和 @tmpInsertVars 变量。
2.  在填充之前将 @tmpInsertVars 重置为 NULL

    ```
    USE MAINDB
    DECLARE @PK int = 1000,
     @TaskName nvarchar(50) = 'TASK', 
     @curTable nvarchar(75),
     @curRow nvarchar(75),
     @tmpStatement nvarchar(500),
     @tmpInsert nvarchar(500),
     @tmpInsertStatement nvarchar(500),
     @tmpInsertVars nvarchar(500)

    RAISERROR('Retrieving Tables',0,1) WITH NOWAIT
     DECLARE TableCursor CURSOR LOCAL FOR 

        SELECT DISTINCT TOP 2 PRMPTTBL.tTable as PromptTable
           FROM THING1 TK INNER JOIN THING2 SC ON TK.tkNo=SC.tkNo
                  INNER JOIN Component EL on EL.scNo=SC.scNo             
                  LEFT OUTER JOIN Field FLD1 on FLD1.cfNo=EL.cfNoPrompt1            
                  LEFT OUTER JOIN MyTableTable MTTTBL on MTTTBL.tbNo=FLD1.tbNo

           WHERE EL.PK=@PK
                  AND (MTTTBL.tTable is not NULL AND MTTTBL.tTable not in('OneTableIDontWant'))
                  AND MTTTBL.tTable not like '%[_]d%' --eliminate any tables that are actually views
                  AND EL.cfNo > 0  
                  AND TK.Description like @TaskName

    RAISERROR('Table',0,1) WITH NOWAIT
    OPEN TableCursor
    FETCH NEXT FROM TableCursor INTO @curTable
    WHILE @@FETCH_STATUS = 0
    BEGIN
       SET @tmpStatement = 'SELECT TOP 5 * FROM [MYCONN].TEST_MYDB.dbo.' + @curTable + ' where PK=' + Cast(@PK as nvarchar(10))
       EXEC (@tmpStatement)
       RAISERROR(N'Table (outside): %s',0,1,@curTable) WITH NOWAIT  

       IF @@ROWCOUNT = 0 
       BEGIN
            --@tmpInsertVars isn't updating!!!
            SELECT @tmpInsertVars = NULL; -- RESET @tmpInsertVars
            RAISERROR(N'Initial Select: %s',0,1,@tmpStatement) WITH NOWAIT
            SELECT @tmpInsertVars = COALESCE(@tmpInsertVars + ',','') + COLUMN_NAME 
            FROM PRODDB.INFORMATION_SCHEMA.COLUMNS
            WHERE TABLE_NAME = @curTable

            SET @tmpInsertStatement = 'INSERT INTO [MYCONN].TEST_MYDB.dbo.' + @curTable + ' (' + @tmpInsertVars + ')' +
                                      ' SELECT TOP 500 ' + @tmpInsertVars +
                                      ' FROM TEST_MYDB.' + @curTable +
                                      ' WHERE PK=' + Cast(@PK as nvarchar(10))

            RAISERROR(N'Insert Statement: %s',0,1,@tmpInsertStatement) WITH NOWAIT
       END

       FETCH NEXT FROM TableCursor INTO @curTable
    END

    CLOSE TableCursor
    DEALLOCATE TableCursor 
    ```

# symfony - Symfony2 自动注销所有时间

> ID：15420730
> 
> 赞同：1
> 
> 时间：2013-03-14T21:40:53.993
> 
> 标签：symfony, fosuserbundle

我即将完成我正在从事一段时间的项目。我想昨天睡觉很高兴今天将是我工作的最后一天，但是 Symfony 或其他东西会带来一个非常不愉快的惊喜。

由于某种原因，用户几乎总是自动注销。有时在成功登录后，我可以再发出一个请求，以便在下一个时注销。

之前发生过几次，我意外地注销了，但这种情况很少见，我将它与尚未完成的应用程序等连接起来。

我在 security.yml 中注释掉了 access_control 中的所有规则，但角色为 IS_AUTHENTICATED_ANONYMOUSLY 的规则除外，但没有任何改变。

它发生在所有路线上，不知道在哪里寻找修复它。

我昨天在事件侦听器上创建但将其关闭也无济于事。

昨天有效，今天无效。通常我会回顾我所做的更改，但今天还没有完成。

# c++ - 使用 cmake 构建的库上的链接错误

> ID：15420734
> 
> 赞同：0
> 
> 时间：2013-03-14T21:41:12.980
> 
> 标签：c++, c++11, cmake, ld

我想我只是犯了一个简单的错误，但我没有得到哪个..无论如何我正在开发一个库，我也在使用 cmake 为项目构建 Makefile：[https ://github.com/immapoint/ NaNO3/blob/master/CMakeLists.txt](https://github.com/immapoint/NaNO3/blob/master/CMakeLists.txt)

编译库时一切正常；它构建以下文件：

```
bin/libNaNO3.dll
lib/libNaNO3.dll.a (I don't like that name as well) 
```

为了测试整个事情，我设置了另一个项目，也使用 cmake。[https://github.com/immapoint/NaNO3TestApp/blob/master/CMakeLists.txt](https://github.com/immapoint/NaNO3TestApp/blob/master/CMakeLists.txt)

测试库的主文件如下所示： [https ://github.com/immapoint/NaNO3TestApp/blob/master/src/main.cpp](https://github.com/immapoint/NaNO3TestApp/blob/master/src/main.cpp)

但是在编译主文件时，出现以下错误：

```
CMakeFiles/NaNO3TestApp.dir/objects.a(main.cpp.obj):main.cpp:(.text+0xbf): undefined reference to `nano::Event<int>::attach(std::function<void(int)> *)`
CMakeFiles/NaNO3TestApp.dir/objects.a(main.cpp.obj):main.cpp:(.text+0xd3): undefined reference to `nano::Event<int>::notify(int)`
[...]ld.exe: CMakeFiles/NaNO3TestApp.dir/objects.a(main.cpp.obj): bad reloc address 0x8 in section `.rdata' 
```

无论我是使用 make/cmake 构建项目还是直接使用编译源文件，都会出现此错误

```
g++ -Wall -pedantic -ansi -std=c++0x main.cpp [-L./lib -I./include] -lNaNO3 
```

所以问题似乎不在于cmake，而在于ld。我正在使用 CMake 2.8 版和包含 GCC 4.7.2 版的 MinGW。

**附加信息：**

带有 -fPIC 的编译器输出： ![-fPIC](../Images/f99387c5b389f8df4f37d3a47136ae2a.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T22:23:36.427

这与 CMake 或链接器无关。您需要`nano::Event`在头文件中包含成员函数的定义，而不是在单独的源文件中，因为模板是在编译时实例化的。当链接器到达那里时，为时已晚。

有关更完整的解释，请参阅[为什么模板类的实现和声明应该在同一个头文件中？](https://stackoverflow.com/q/3749099/424459)和[http://www.parashift.com/c++-faq-lite/templates-defn-vs-decl.html](http://www.parashift.com/c++-faq-lite/templates-defn-vs-decl.html)

# ruby - 使用 regex + gsub 从字符串中仅删除方括号内的文本

> ID：15420738
> 
> 赞同：3
> 
> 时间：2013-03-14T21:41:23.910
> 
> 标签：ruby, regex

```
text = "This [is] a [fill]-in-the-[blank]" 
```

我正在寻找正则表达式为我做一些魔术：

```
new_text = text.gsub(/[magic happens]/, "")

=> "This [] a []-in-the-[]" 
```

我的代码是 Ruby，但我敢打赌这并不重要。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-14T21:44:42.250

像这样的东西会起作用：

```
text = "This [is] a [fill]-in-the-[blank]"
text.gsub(/\[.+?\]/, '[]')
#=> "This [] a []-in-the-[]" 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-14T21:44:28.573

```
text = "This [is] a [fill]-in-the-[blank]"

text.gsub(/(?<=\[).+?(?=\])/, "") 
```

或者

```
text.gsub(/(?<=\[)[^\]]+?(?=\])/, "") 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-14T21:51:30.273

鉴于您的测试用例-> [http://rubular.com/r/TgdjOtc4Ru](http://rubular.com/r/TgdjOtc4Ru)从这里，您可以删除匹配项或类似内容，我使用[Rubular 对此进行了原型设计：](http://rubular.com/)

```
[5] pry(main)> text = "This [is] a [fill]-in-the[blank]"
=> "This [is] a [fill]-in-the[blank]"
[6] pry(main)> text.gsub(/\[(\w+)\]/) { |match| "[]" }
=> "This [] a []-in-the[]" 
```

可能有一种更漂亮的方法来做到这一点:-)

# jquery - 在 Drupal 中使用带有 jquery 的 location.hash 而不是“加倍”网址

> ID：15420740
> 
> 赞同：0
> 
> 时间：2013-03-14T21:41:29.413
> 
> 标签：jquery, drupal-6

我有一个页面上有一个 5 选项卡系统的页面。每个选项卡在左侧导航列表中都有一个链接，以便某人可以直接链接到打开特定选项卡的页面，或者单击任何选项卡本身以显示内容隐藏/其他。

为此，我使用 location.hash 并将每个选项卡 ID 附加到 url，如：

```
http://localhost:8082/departments/site-facilities/enviroment/iso-14001#impactAreas 
```

所以有人可以打：

```
http://localhost:8082/departments/site-facilities/environment 
```

..查看选项卡系统并单击将哈希添加到 url 的 iso-14001 选项卡，或者他们可以在上方输入该 url 或单击左侧导航栏中的链接。

我在 Drupal 中遇到的问题是在基本的 html 列表（这是一个额外的列表，不是主菜单或辅助菜单）中，我输入了 a hrefs 链接，例如：

```
< a href="/departments/site-facilities/environment/iso-14001#impactAreas">link here</a> 
```

如果站点中的其他位置有效。但是，一旦一个人在带有标签的实际页面上单击左侧列表导航链接，浏览器中的 url 将变为：

```
http://localhost:8082/departments/site-facilities/departments/site-facilities/environment/iso-14001#impactAreas 
```

所以这就像 Drupal 没有识别重新加载新页面，只是将 href 位置附加到现有 url。

我不知道为什么，如果这是一个 php 的东西和散列，如果我需要不同的 jquery 等等。

这是我放在一起的基本jquery：

```
function setupSubNav(){
  pathName = window.location.href;
  $('.hiddenSection').css('display','none');
  pathArray = pathName.split('#');
  param = pathArray[pathArray.length-1];
  if(pathArray.length>1){
    showSection(param,$('.' + param + 'Trigger'));
  }
  else
  {
     if ($('body.fervens-a .pageTabs li')) {
        var sectionName = $($('body.fervens-a .pageTabs li')[0]).attr('class').split('Trigger')[0];
            showSection(sectionName, $($('body.fervens-a .pageTabs li')[0]));
        }
  }
    $('body.fervens-a .pageTabs li').click(function(){
        if (!($(this).hasClass('current'))) {
            var sectionName = $(this).attr('class').split('Trigger')[0];
            showSection(sectionName, $(this));
        }
    });
}
function showSection(sectionName,$navObj) {
    if (sectionName != 'iso14001' && sectionName != 'environmentalPolicy' && sectionName != 'impactAreas' && sectionName != 'goals2013' && sectionName != 'isoDocs') {
        sectionName = 'iso14001';
        $navObj = $($('body.fervens-a .pageTabs li')[0]);
    }
        $('body.fervens-a .pageTabs li').removeClass('current');
        $navObj.addClass('current');
        $('.hiddenSection').css('display','none');
        $('#' + sectionName + 'Content').css('display','block');
        window.location.hash = sectionName;
} 
```

我是否应该以某种方式检查 window.location 是否已经有一个散列，如果有，在添加新散列之前将其删除？听起来不对，但我不知道为什么这不起作用。

我使用了之前为 Schwab 迷你站点编写的代码，只是添加了哈希内容，但那里全是 html，现在这是 Drupal 和 php，我只是想知道我还缺少什么。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T22:00:12.487

Holy cow. It was as simple as using a "?" instead of a "#".

Well, that's how we learn. Thanks for looking.

# emacs - un-camelCase 代码不起作用

> ID：15420741
> 
> 赞同：0
> 
> 时间：2013-03-14T21:41:31.413
> 
> 标签：emacs, camelcasing

camelCase.el emacswiki 具有取消驼峰大小写的功能。但这似乎不起作用。我将该部分添加到 camelCase.el 本身。但不能让它工作。我错过了什么？其他人有同样的问题吗？

编辑：我添加了最后两个函数，其中一个是不起作用的函数

```
(defun camelCase-downcase-word (count)
  "Make word starting at point lowercase, leaving point after word."
  (interactive "*p")
  (let ((start (point)))
    (camelCase-forward-word count)
    (downcase-region start (point))))

(defun un-camelcase-string (s &optional sep start)
  "Convert CamelCase string S to lower case with word separator SEP.
    Default for SEP is a hyphen \"-\".
 If third argument START is non-nil, convert words after that
    index in STRING."
  (let ((case-fold-search nil))
    (while (string-match "[A-Z]" s (or start 1))
      (setq s (replace-match (concat (or sep "_")
                                     (downcase (match-string 0 s)))
                             t nil s)))
    (downcase s)))

(provide 'camelCase) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T17:30:18.867

除了误导性的文档字符串（它实际上默认为“_”，而不是“-”作为分隔符）之外，`un-camelcase-string`您提供的定义有效。您能否详细介绍一下它是如何失败的以及在什么情况下失败？

# java - 替代针对 weblogic.jar 进行编译？

> ID：15420743
> 
> 赞同：0
> 
> 时间：2013-03-14T21:41:44.687
> 
> 标签：java, maven, weblogic, maven-3

我继承了一个`ant`用于构建的旧项目`weblogic.jar`。我正在将其转移到基于更现代`maven`的构建环境中，并且我不想将`weblogic.jar`（34MB）签入到我的私有工件存储库中，我也不想将它添加到我的本地存储库中。我不确定它使用的是什么，该项目是一个超过 500,000 行代码的单一代码库。

实际上，我们的本地开发机器上不会有 Weblogic，我们正在部署到远程虚拟机进行测试，因为公司网络拓扑结构是为了获得我们的应用程序需要与之通信的服务。

**我有什么替代方案来反对`weblogic.jar`.**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T03:48:08.713

使用系统范围通常被认为是一种不好的做法。但是，我会说，在 的情况下`weblogic.jar`，使用系统范围是有意义的。原因是它`weblogic.jar`不包含 WLS 安装提供的所有类。如果您打开`weblogic.jar`并查看里面的文件，它在条目`MANIFEST.MF`中包含一长串 jar 文件。`Class-Path:`这些 jar 引用都使用相对路径。这意味着如果您将其`weblogic.jar`放入 maven 存储库，则相对路径将被破坏，您需要将更多 WLS jar 文件放入您的 maven 存储库。

问题是，如果您的系统范围依赖项指向`weblogic.jar`WLS 安装中的 ，您需要为所有开发人员标准化 WLS 安装目录。否则，您的构建在其他开发人员的机器上是不可移植的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-14T22:00:03.050

如果您不想将其放入本地存储库，则可以使用系统范围的依赖项来引用它，在这种情况下，您只需从磁盘中引用它。我不确定为什么那会是更好的选择，但既然你要求它，你可能有充分的理由。

但是，假设您根本不想使用 weblogic.jar：在不知道您需要什么的情况下，实际上不可能说出针对它构建的替代方案。这需要先弄清楚。如果您使用特定于 weblogic 的东西，您确实需要参考。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-14T21:48:11.293

由于 maven 会将它尝试解析的所有内容下载到您的本地存储库中，因此唯一的方法（afaik）将使用[maven-ant-task](http://maven.apache.org/ant-tasks/index.html)包装现有的 ant 任务。

就我个人而言，我更愿意将 weblogic 的东西添加到 maven 存储库中。

# c - 嵌套循环的大 O 复杂度

> ID：15420747
> 
> 赞同：-3
> 
> 时间：2013-03-14T21:42:06.307
> 
> 标签：c, complexity-theory, big-o, nested-loops

我对以下的复杂性感到困惑（在内部循环中执行的操作是在恒定时间内）：

伪代码：

```
for i = 1 to n
   for j = i to n
      for k = i to j
         x := x + 1;
      end for
   end for
end for; 
```

代码：

```
for(i=1;i<=n;i++) {   
    for(j=i;j<=n;j++) {
        for(k=i;k<=j;k++) {
           x = x + 1;
        }
    }
} 
```

O(n^3) ?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T21:43:53.717

> O(n^3) ???

是的，即使你不费心翻译你的法语作业。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-14T21:44:13.617

它的产品`O(outer loop in outer loop control) * O(inner loop in inner loop control)`。

# vb.net - 基于邮政编码的时区（非州）

> ID：15420751
> 
> 赞同：0
> 
> 时间：2013-03-14T21:42:18.763
> 
> 标签：vb.net, timezone, zipcode

好的，我在这里，我认为这是一个简单的逻辑问题。

我将首先向您展示我的代码（至少我认为您需要的所有代码）然后解释问题。

```
Function GetTimeZone(ByVal state As String) As Integer

    Dim TaxConnStr As String = "Provider=Microsoft.ACE.OLEDB.12.0;Data Source=" & ConfigurationManager.AppSettings("Database")
    Dim dbConnection As OleDbConnection = New OleDbConnection(TaxConnStr)
    Try

        Dim queryString As String
        queryString = "SELECT Top 1 Zips.State, Zips.TimeZone "
        queryString += "FROM Zips "
        queryString += "WHERE (((Zips.State)='" & state & "'));"

        Dim dbCommand As OleDbCommand = New OleDbCommand
        dbCommand.CommandText = queryString
        dbCommand.Connection = dbConnection

        Dim dataAdapter As OleDbDataAdapter = New OleDbDataAdapter
        dataAdapter.SelectCommand = dbCommand
        Dim dataSet As DataSet = New DataSet
        dataAdapter.Fill(dataSet)
        If dataSet.Tables(0).Rows.Count >= 1 Then
            Return dataSet.Tables(0).Rows(0).Item("TimeZone")
        Else
            Return 0
        End If

    Catch ex As Exception
        Console.WriteLine(ex.Message)
        myLogger.Log(ex.Message)
    Finally
        dbConnection.Close()
    End Try
end Function 
```

好的，我要做的不是根据州（此代码如何获取它）而是根据邮政编码找出时区。这显然是 b/c 一些州（KY、TN、OK 等）按其时区划分。

所以我最终希望这个函数查看邮政编码......找出邮政编码所在的时区......然后返回时区。

如果不是很明显。从中提取此信息的表名为“Zips”。它由几列组成，包括邮编、城市、州、县、区号和时区。表中的时区列只有“5、6、7、8等”等值来对应每个时区。5 = 东部，6 = 中部，依此类推..

感谢您的任何指导。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T21:48:44.567

看起来很简单，除非我不明白。您首先需要更改方法签名以获取邮政编码：

```
Function GetTimeZone(ByVal zipcode As Integer) As Integer 
```

然后，您必须更改查询以按该邮政编码进行搜索：

```
queryString = "SELECT Top 1 Zips.TimeZone "
queryString += "FROM Zips "
queryString += "WHERE (((Zips.Zip)=" & zipcode & "));" 
```

其他一切都应该按原样工作。

# python - 神秘索引错误

> ID：15420752
> 
> 赞同：0
> 
> 时间：2013-03-14T21:42:20.100
> 
> 标签：python, matplotlib, ipython

我最近遇到了类似的错误：

```
IndexError                                Traceback (most recent call last)
<ipython-input-124-59ca523b1b36> in <module>()
----> 1 first_experiment_comb(model)

  c:\python26\26664\lib\site-packages\experiments.py in first_experiment_comb(mod
 l)
     172                      "Number NZ: " + str(modelz[j].NumNZs) +"\n")
     173
 --> 174         first_experiment(modelz[j], str(j))
     175
     176

c:\python26\26664\lib\site-packages\experiments.py in first_experiment(model, e
t)
     89         plt.close()
     90
---> 91     fl.timberFlow(model)
     92     plt.savefig(dire + "\\timber_flow" +ext+".pdf", bbox_inches = 0)
     93     plt.close()

C:\Python26\26664\lib\site-packages\func_lib.py in timberFlow(model)
    304     if not unVars:
    305         unVars = varValues(model, 'PIEHTLVOL')
--> 306
    307     for i in range(19):
    308             swVarVals.append(swVars[i].X)

IndexError: list index out of range 
```

跟踪的最后一行指向不存在的代码，或者在以前的情况下已被注释掉。当我自己运行最后一个函数（在func_lib.py中）时，我永远不会得到神秘的IndexError，只有当它从experiments.py调用时。

我在 pylab python 2.6 W64 中运行它。我无法在 iPython 或 Pylab 文档中找到关于此的已知错误。

第 306 行怎么可能是错误的根源？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-14T21:44:39.567

您的代码与字节码不同步。正确重新加载您的代码。

发生异常时，会检查字节码中的文件名和行号，然后加载源文件以显示该行的原始源。

但是，如果您更改了源代码但尚未重新启动您的 python 进程（或重新加载 ipython 中的代码），那么当发生异常时会显示错误的行。

# wpf - 如果可能，如何为属性设置 WPF 默认值？

> ID：15420758
> 
> 赞同：2
> 
> 时间：2013-03-14T21:42:48.907
> 
> 标签：wpf, wpf-controls

我刚刚开始 WPF，这让我很沮丧。似乎许多属性默认为空（至少是我目前正在处理的那些），因此当它编译和运行时，什么也没有发生。

**是否有快速的方法或标准的工作流程来为 WPF 对象设置默认值？**

例如，我在 XAML 视图中放置了一个 Canvas 和一个 Button，然后转到代码视图以在 Button 上添加一个事件处理程序`Canvas.Children.Add(new Ellipse())`，然后没有任何反应。然后我想也许我应该指定宽度和高度。仍然没有任何反应。终于，经过一番挣扎，我找到了这处`Shape.Stroke`房产。

然后就没有直观`Ellipse.X`的`Ellipse.Y`定位Ellipse了。同样，花了一个小时才找到`Canvas.SetLeft()`.

最后一根稻草是当我尝试这样做时`Canvas.SetLeft(Random.Next(0, (int)Canvas.Width));`它会给出**运行时错误**，因为`Canvas.Width`是`NULL`?!!? 天哪...

当然，WPF 提供了很多功能，但似乎来自 Winforms 的大量工作`Graphics.DrawEllipse()`.. **汗**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-14T22:05:57.743

在 WPF 中，如果您没有显式设置`Width/Heigh`t`xaml`的大小将由`Elements`布局确定`Container`，因此要访问这样`Width/Height`的元素，您可以使用属性`ActualWidth/Actualheight`，这些返回的`Rendered`大小`Element`

例子：

```
Canvas.SetLeft(Random.Next(0, (int)Canvas.ActualWidth)); 
```

如果你想`Default`为 a 创建值，`Element`你可以在 xaml 中为它创建一个样式`Element`

例子：

```
<Style TargetType="Ellipse">
    <Setter Property="Stroke" Value="Black"/>
</Style> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-14T22:03:11.820

WPF 确实有一个粗略的学习曲线。更困难的事情之一是放弃您可能习惯的技术并接受 WPF 方法。Xaml 是定义控件及其属性的方法 - Xaml 是一种语言，其唯一真正目的是做好声明。本质上，将代码的 Xaml 部分视为美化的构造函数。

```
<Window x:Class="TestWpfApp.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        x:Name="Window"
        Title="MainWindow"
        Width="640"
        Height="480">       
    <Canvas>
        <Ellipse Canvas.Left="50"
                 Canvas.Top="50"
                 Width="142"
                 Height="88"
                 Fill="Black" />
    </Canvas>
</Window> 
```

上面的声明利用了 Xaml 的[Attached Properties](http://msdn.microsoft.com/en-us/library/ms749011.aspx)漂亮的语法。

如果您发现自己经常在类似对象上设置一组通用属性，您可能想要研究[样式。](http://msdn.microsoft.com/en-us/library/ms745683.aspx)

# ios - 将 MKPolygon 置于最前面

> ID：15420761
> 
> 赞同：1
> 
> 时间：2013-03-14T21:43:07.917
> 
> 标签：ios, objective-c, mkmapview

我在我的 MKMapView 中绘制了一堆 MKPolygons。它们中的一些相互重叠。如何将选定的多边形带到顶部/前面？

我尝试`bringSubviewToFront:`了从多边形层创建的 MKPolygonView：

```
MKPolygonView *view = (MKPolygonView *)[self.mapView viewForOverlay:polygon];

view.strokeColor = [UIColor orangeColor];

[self.mapView bringSubviewToFront:view]; 
```

解决方案：

我删除了

```
MKPolygonView *view = (MKPolygonView *)[self.mapView viewForOverlay:polygon];

view.strokeColor = [UIColor orangeColor];

[self.mapView bringSubviewToFront:view]; 
```

并将其替换为 Craig 建议的内容：

```
[self.mapView insertOverlay:polygon atIndex:self.mapView.overlays.count]; 
```

然后调用 MKMapKit 委托`mapView:viewForOverlay:`，然后我在那里处理颜色变化：

```
 - (MKOverlayView *)mapView:(MKMapView *)mapView viewForOverlay:(id <MKOverlay>)overlay {
    if ([overlay isKindOfClass:[MKPolygon class]] && !((MKPolygon *)overlay).isSelected) {
        MKPolygonView*    aView = [[MKPolygonView alloc] initWithPolygon:(MKPolygon*)overlay];

        aView.fillColor = [[UIColor cyanColor] colorWithAlphaComponent:0.2];
        aView.strokeColor = [UIColor yellowColor];
        aView.lineWidth = 3;

        return aView;
    }
    else if ([overlay isKindOfClass:[MKPolygon class]] && ((MKPolygon *)overlay).isSelected) {
        MKPolygonView*    aView = [[MKPolygonView alloc] initWithPolygon:(MKPolygon*)overlay];

        aView.fillColor = [[UIColor cyanColor] colorWithAlphaComponent:0.2];
        aView.strokeColor = [UIColor orangeColor];
        aView.lineWidth = 3;

        return aView;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-16T09:59:09.183

当您将叠加层添加到 mapView 时，您可以选择将其放置在叠加层列表中的位置。由于叠加层只能在列表中出现，您只需在所需位置再次插入即可移动它。由于您希望它位于顶部，因此应该可以：

```
[mapView insertOverlay:overlay atIndex:[mapView.overlays count]]; 
```

您不应该调用 viewForOverlay。把它留给iOS。如果您需要为叠加层着色，请在 viewForOverlay 中进行，因为 iOS 可以并且会在需要时调用它，并且如果您返回非彩色叠加层，它将绘制它。

# angularjs - 如何在 AngularJS 中停止 $broadcast 事件？

> ID：15420765
> 
> 赞同：30
> 
> 时间：2013-03-14T21:43:32.330
> 
> 标签：angularjs, angularjs-scope

是否有一种内置方法可以阻止`$broadcast`事件沿着作用域链向下移动？

事件传递的事件对象`$broadcast`没有`stopPropagation`方法（如[$rootScope 上的文档](http://docs.angularjs.org/api/ng.$rootScope.Scope#$on)所述）。但是，[此合并的拉取请求](https://github.com/angular/angular.js/pull/914)表明`$broadcast`事件可以`stopPropagation`调用它们。

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2013-03-15T00:37:02.530

来自 angularJS 1.1.2 源代码的片段：

```
$emit: function(name, args) {
    // ....
    event = {
        name: name,
        targetScope: scope,
        stopPropagation: function() {
            stopPropagation = true;
        },
        preventDefault: function() {
            event.defaultPrevented = true;
        },
        defaultPrevented: false
    },
    // ....
}

$broadcast: function(name, args) {
    // ...
    event = {
        name: name,
        targetScope: target,
        preventDefault: function() {
            event.defaultPrevented = true;
        },
        defaultPrevented: false
    },
    // ...
} 
```

如您所见，$broadcast 中的事件对象没有“stopPropagation”。

您可以使用 preventDefault 而不是 stopPropagation 将事件标记为“不需要处理此事件”。这不会停止事件传播，但这会告诉子范围：“不需要处理此事件”

示例：http: [//jsfiddle.net/C8EqT/1/](http://jsfiddle.net/C8EqT/1/)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2015-01-06T10:10:34.000

由于广播没有 stopPropagation 方法，您需要使用 defaultPrevented 属性，这在递归指令中是有意义的。

## 在这里看看这个 plunker：[Plunkr](http://plnkr.co/edit/dxq6fO?p=preview)

`$scope.$on('test', function(event) { if (!event.defaultPrevented) { event.defaultPrevented = true; console.log('Handle event here for the root node only.'); } });`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-02-11T17:52:43.557

为此，我实现了一个事件窃贼：

```
.factory("stealEvent", [function () {

  /**
   * If event is already "default prevented", noop.
   * If event isn't "default prevented", executes callback.
   * If callback returns a truthy value or undefined,
   * stops event propagation if possible, and flags event as "default prevented".
   */
  return function (callback) {
    return function (event) {
      if (!event.defaultPrevented) {
        var stopEvent = callback.apply(null, arguments);
        if (typeof stopEvent === "undefined" || stopEvent) {
          event.stopPropagation && event.stopPropagation();
          event.preventDefault();
        }
      }
    };
  };

}]); 
```

要使用：

```
$scope.$on("AnyEvent", stealEvent(function (event, anyOtherParameter) {
  if ($scope.keepEvent) {
    // do some stuff with anyOtherParameter
    return true; // steal event
  } else {
    return false; // let event available for other listeners
  }
}));

$scope.$on("AnyOtherEvent", stealEvent(function (event, anyOtherParameter) {
  // do some stuff with anyOtherParameter, event stolen by default
})); 
```

# powershell - PSSessionStateBroken 与计划任务中的 start-job -credential

> ID：15420769
> 
> 赞同：2
> 
> 时间：2013-03-14T21:44:14.423
> 
> 标签：powershell, background-process, powershell-3.0, start-job

下面的行在 Powershell 提示符下工作正常，但在计划任务中失败。

```
$pass = gc C:\secrets\shhh.txt | convertTo-secureString
$Cred = new-object -typeName System.management.automation.psCredential -argumentlist "domain\domainUser",$pass

$path = "\\server\share\folder"
$j = start-job {gci -path $args[0]} -cred $Cred -argumentList $path | wait-job | receive-job

$body = $j | out-string
$error | out-file C:\temp\err.txt
send-mailMessage -to me@domain.tld -from server@domain.tld -subject halp -smtpserver mailserver.domain.tld -body $body 
```

在 c:\temp\err.txt 中，Windows 2008R2 计划任务留下了一个面包屑：

```
[localhost] The background process exited abnormally.
    + CategoryInfo          : OpenError: (localhost:String) [], PSRemotingTransportException
    + FullyQualifiedErrorId : 2101,PSSessionStateBroken 
```

...这将我们带到了[这个 Microsoft 错误报告](https://connect.microsoft.com/powershell/feedback/details/736114/psv3-start-jobs-running-from-scheduled-task-with-different-credentials-fail#details)。该报告提到了使用 localhost 环回远程处理的解决方法，这听起来有点脏。我应该去那里吗？

有更好的解决方案吗？也许使用 *session cmdlet 或调用命令之一？计划任务的`Start in`值已设置，但后台进程可能以某种不好的方式使用了一些变量，像[这样](http://support.microsoft.com/kb/832434)？

`–version 2`使用或使用`-command "& {bigKlugeyScriptblock}"`语法调用 powershell.exe 还没有运气。

**编辑：**我试图避免创建一个新的域帐户来运行该任务。该任务不能`domainUser`从 from运行`$cred`，因为该帐户不应该具有 localhost 的权限。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-14T22:48:15.457

作为一些可能的解决方法：

1.  将备用凭据放在计划任务本身上
2.  使用[runas](http://ss64.com/nt/runas.html)命令以其他用户身份启动 powershell.exe
3.  使用[net use](http://ss64.com/nt/net_use.html) /user 参数来验证对网络路径的访问

    ```
    [/USER:[dotted domain name\]username]
    [/USER:[username@dotted domain name] 
    ```

# c# - 将图像列表转换为图像数组

> ID：15420783
> 
> 赞同：1
> 
> 时间：2013-03-14T21:45:04.887
> 
> 标签：c#, arrays, image, list

看了几个例子，按照这些例子我的代码现在看起来像这样（见下文），但不幸的是我收到错误“'System.Windows.Forms.ImageList'不包含'toArray'的定义并且没有扩展名可以找到接受“System.Windows.Forms.ImageList”类型的第一个参数的方法“toArray”（您是否缺少 using 指令或程序集引用？）”

有任何想法吗 ？我可能错过了其他帖子中显示的部分，但我不这么认为

```
ImageList Move_list = new ImageList();
.
.
.
//Gather the images
string        path          = "C:/Pictures/Movements/User";
string[]      filter        = { ".jpg", ".jpeg"};
DirectoryInfo directoryInfo = new DirectoryInfo(path);
FileInfo[]    fileInfo      = directoryInfo.GetFiles();
ArrayList     arrayList     = new ArrayList();

foreach (FileInfo fi in fileInfo)
  foreach (string s in filter)
    if (s == fi.Extension)
      arrayList.Add(fi.FullName);

//adding files to image list:
for (i = 0; i < arrayList.Count; i++)
{
  System.Drawing.Image img = System.Drawing.Image.FromFile(arrayList[i].ToString());
  Move_list.Images.Add(img);
}

User_moves[0] =  Move_list.toArray(); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-14T21:52:57.700

Move_list.Images 是您的列表，而不是 ImageList。这是一个命名错误的类，但它映射到 Win32 中的 ImageList 概念（这是一个长序列图像位图的句柄）。反正：

```
Move_list.Images.Cast<Image>().ToArray(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-14T21:48:43.753

据我所知，`Move_list`是一个`ImageList`. `ImageList`没有实现`IQueryable`或`IEnumerable`。`ToArray`被定义`System.Linq`为这两个接口上的扩展方法。

你应该可以使用`Move_list.Images.ToArray()`，因为 Images 是一个`ImageCollection`，它确实实现了`IEnumerable`.

# ruby-on-rails - Rails 在环境变量中包含返回字符

> ID：15420785
> 
> 赞同：0
> 
> 时间：2013-03-14T21:45:18.930
> 
> 标签：ruby-on-rails, linux, environment-variables

我将环境变量存储在`/etc/environment`：

```
FACEBOOK_API_KEY=XXXXXXXXXXX
FACEBOOK_API_SECRET=XXXXXXXXXX 
```

但是当我通过 Rails 访问 ENV 变量时，我得到了这个：

```
ENV['FACEBOOK_API_KEY']
=> XXXXXXXXX\r 
```

注意`\r`，如何在不清理对 ENV vars 的每次调用的情况下摆脱它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-14T21:57:57.993

我的猜测是你得到了一个`\r`，因为你正在`/etc/environment`使用 Windows 文本编辑器进行编辑并将其安装在 Unix 系统上（或者可能在 Windows 中使用 Cygwin，但同样适用）。或者您从这样做的来源复制/粘贴它。无论如何，某些东西已经将 CRLF 引入了只需要 LF 行尾的 Unix 文件中。

如果它是一个编辑器，您需要修复它以停止使用 Windows CRLF ( `\r\n`) 行尾，并使用 Unix LF ( `\n`) 行尾。Notepad++ 有一个选项，就像许多其他编辑器和 IDE 一样。为你的谷歌搜索并了解如何使用 Unix 行尾。否则你会遇到很多这样的问题。

您可以通过像`dos2unix`（在 Unix 系统上；您可能必须安装软件包）这样的程序运行它来修复现有文件，或者使用这样的简单`tr`命令：

**编辑：修复了`mv`以下命令中的文件名顺序。**

```
tr -d '\r' </etc/environment >/tmp/environment
# <verify new file looks good>
mv /tmp/environment /etc/environment 
```

请小心，进行备份，检查文件等。

`\r`您可以通过查看八进制转储来确保文件中没有任何流氓字符：

```
od -c /tmp/environment 
```

`\r`在输出中查找任何内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-14T21:51:06.593

你可以使用[**figaro**](https://github.com/laserlemon/figaro)来管理你的 ENV 变量。

它会`config/application.yml`为您创建一个不应签入版本控制的文件。

```
# config/application.yml
FACEBOOK_API_KEY:    XXXXXXXXXXX
FACEBOOK_API_SECRET: XXXXXXXXXX 
```

变量将`ENV['FACEBOOK_API_KEY']`按照您的习惯使用。

另一种选择是[configatron](https://github.com/markbates/configatron)。

# java - 安卓套接字互联网

> ID：15420787
> 
> 赞同：3
> 
> 时间：2013-03-14T21:45:25.150
> 
> 标签：java, android, sockets

通过使用 java Sockets，我的小应用程序遇到了一个小问题。

如果我在 pc 上启动我的 Sockert-Server 并且我使用（实习生）网络 IP 通过同一网络中的 wifi 与我的手机连接，我可以将一些东西发送到我的服务器。

但是，如果我尝试通过移动互联网连接发送消息，它不起作用..也没有错误或其他问题：/

这是我的android类：

```
public class Sockets extends Activity {
EditText textOut;
EditText ipAddress;
TextView textIn;

 /** Called when the activity is first created. */
 @Override
 public void onCreate(Bundle savedInstanceState) {
     super.onCreate(savedInstanceState);
     setContentView(R.layout.activity_socket);

     textOut = (EditText)findViewById(R.id.textout);
     Button buttonSend = (Button)findViewById(R.id.send);
     ipAddress = (EditText)findViewById(R.id.ipAddress);
     buttonSend.setOnClickListener(buttonSendOnClickListener);
 }

 Button.OnClickListener buttonSendOnClickListener
 = new Button.OnClickListener(){

@Override
public void onClick(View arg0) {
 // TODO Auto-generated method stub

    new DatagrammClient(ipAddress.getText().toString(),textOut.getText().toString()).execute("");
    textOut.setText("");

}};

private static class DatagrammClient extends android.os.AsyncTask<String, Void, String> {
    final static String LOGIN = "LOGIN";
    final static String LOGOUT = "LOGOUT";
    static int port = 1234;
    static int length = 1024; // Länge eines Pakets

    static DatagramSocket socket = null;
    static InetAddress ia = null;
    static DatagramPacket packet;

    String hostname = "";
    String msg ="";

    public DatagrammClient(String hostname,String msg) {
        this.hostname = hostname;
        this.msg = msg;
    }

    /**
     * Send the login package and open socket
     * 
     * @param servername
     * @throws IOException,UnknownHostEception 
     */
    private static void connectToServer(String servername) throws IOException,UnknownHostException{

        packet = null;
        byte[] ba = LOGIN.getBytes();       

        try {
            socket = new DatagramSocket();
            ia = InetAddress.getByName(servername);
            packet = new DatagramPacket(ba, ba.length, ia, port);
            Log.d("servername",servername);
            Log.d("Internetaddress",ia.toString());
            Log.d("SOCKET",socket.toString());
            // sende Anmeldung
            socket.send(packet);

        } catch (SocketException se) {
            Log.d("SocketException",se.toString());
        }
        catch (UnknownHostException he) {
            Log.d("UnknownHost: ",he.toString());
        }
        catch (IOException e) {
            Log.d("IOException: ",e.toString());
        }
    }

    public static void sendMessage(String message, String hostname) throws UnknownHostException, IOException{
        //if (socket == null){
        DatagrammClient.connectToServer(hostname);
        //}
        DatagrammClient.sendMessageToServer(message);

        DatagrammClient.readMessageFromServer();

        //Close connection -> Send logout Package?
    }

    private static void readMessageFromServer(){
        // Lesen der empfangenen Pakete erfolgt in eigenem Thread
        LeseThread lt = new LeseThread( socket );
    }

    private static void sendMessageToServer(String message){
        byte[] ba = null;
        try {
            if (!message.equals(LOGOUT)) {
                // message = br.readLine();
                ba = message.getBytes();
                packet.setData(ba, 0, ba.length);
                socket.send(packet);
                Log.d("Message:",packet.toString());
            } else {
                ba = LOGOUT.getBytes();
                packet.setData(ba, 0, ba.length);
                socket.send(packet);

                // Exit the system -> do we need to close the socket clientside?
                //socket.close();
                System.exit(0);
            }
        } catch (IOException e) {
            System.err.println("Ausnahmefehler: " + e);
            Log.d("IOEXCEPTION_MESSAGE_TO_SERVER:",e.toString());
        }
    }

    @Override
    protected String doInBackground(String... arg0) {
        // TODO Auto-generated method stub
        try {
            DatagrammClient.sendMessage(msg, hostname);
        }
        catch(Exception e){
            Log.d("Error: ",e.toString());
        }

        return null;
    }
}
} 
```

使用 INTERNET 的权限在 Manifest.. 中设置。

# arrays - 根据参数数量在循环中创建数组

> ID：15420790
> 
> 赞同：28
> 
> 时间：2013-03-14T21:45:44.107
> 
> 标签：arrays, bash, loops, interpolation

```
#!/bin/bash
COUNTER=$#
until [ $COUNTER -eq 0 ]; do
args[$COUNTER]=\$$COUNTER
let COUNTER-=1
done
echo ${args[@]} 
```

当我运行它时，我得到以下结果

```
user@host:~/sandbox# ./script.sh first second third
$1 $2 $3 
```

我希望它能够回显 $1、$2 和 $3 不是“$1”的文本值

我正在尝试在 bash 中编写一个脚本，该脚本将创建一个数组，该数组的大小与我给它的参数数量一样。
我期待着

```
user@host:~/sandbox# ./script.sh alpha bravo charlie
alpha bravo charlie 
```

或者

```
user@host:~/sandbox# ./script.sh 23425 jasson orange green verb noun coffee
23425 jasson orange green verb noun coffee 
```

所以，目标是使

```
args[0]=$1
args[1]=$2
args[2]=$3
args[3]=$4 
```

我拥有它的方式，`$1,$2,$3`不是被插值，而是被作为文本字符串读取。

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2013-03-14T21:55:53.593

您可以使用`+=`运算符追加到数组。

```
args=()
for i in "$@"; do
    args+=("$i")
done
echo "${args[@]}" 
```

这显示了如何进行附加，但获得所需结果的最简单方法是：

```
echo "$@" 
```

或者

```
args=("$@")
echo "${args[@]}" 
```

如果要保留现有方法，则需要使用间接[方法](http://www.gnu.org/software/bash/manual/bashref.html#Shell-Parameter-Expansion)`!`：

```
args=()
for ((i=1; i<=$#; i++)); do
   args[i]=${!i}
done

echo "${args[@]}" 
```

来自 Bash 参考：

> 如果参数的第一个字符是感叹号（！），则引入了变量间接级别。Bash 使用由其余参数形成的变量的值作为变量的名称；然后扩展此变量，并将该值用于替换的其余部分，而不是参数本身的值。这称为间接扩展。例外情况是下面描述的 ${!prefix } 和 ${!name[@]} 的扩展。感叹号必须紧跟左大括号以引入间接性。

# api - Magento API Rest 过滤器

> ID：15420792
> 
> 赞同：0
> 
> 时间：2013-03-14T21:45:49.380
> 
> 标签：api, magento, rest

所以我在下面有这段代码，它将成功地提取产品并为我的 magento 商店提供 XML 数据......

```
http://mywebsite.com/api/rest/products?type=rest&filter[1][attribute]=name&filter[1][in]=test%20product%20name 
```

但是，如果我使产品名称完美，它只会拉出产品信息。如果我尝试放入

```
http://mywebsite.com/api/rest/products?type=rest&filter[1][attribute]=name&filter[1][in]=test 
```

它不会带来任何产品。我的理解是，如果我使用“[in]”过滤器，它应该会显示所有包含“test”字样的产品，但它不会......

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-26T11:40:36.790

in - "equals any of" - 返回与具有指定属性的项目相等的项目

尝试使用“喜欢”...

```
http://mywebsite.com/api/rest/products?type=rest&filter[1][attribute]=name&filter[1][like]=%test% 
```

# c# - 使用 MVVM 模式时如何处理 MessageBox 对话框（MVVM Light ToolKit）

> ID：15420793
> 
> 赞同：2
> 
> 时间：2013-03-14T21:45:57.430
> 
> 标签：c#, windows-phone-7, mvvm, mvvm-light

我正在制作一个 windows phone 7 并尝试使用 MVVM 来完成它。我想让我的视图模型尽可能干净，但我不确定如何制作一个对话框。我正在使用 MVVM light，我知道他们有消息系统或其他东西，但不确定如何使用它。

我想使用 `Guide.BeginShowMessageBox`它，因为这似乎提供了比标准对话框更多的功能。

如何在不破坏 MVVM 模式的情况下做到这一点。当我加载视图时，我希望触发加载的触发器，然后检查一些条件。如果满足条件，则显示对话框。

// 虚拟机

```
public RelayCommand MainPageLoaded
    {
        get
        {
            if (!NetworkInterface.GetIsNetworkAvailable())
            {
                // breaks MVVM now as have view code in viewmodel. Need to take out somehow
                Guide.BeginShowMessageBox("Test", "Test network", new List<string>() { "Yes", "No" }, 0, MessageBoxIcon.Warning, asyncResult =>
                    {
                        int? returned = Guide.EndShowMessageBox(asyncResult);
                        // if yes then work offline mode? Maybe another property in ViewModel will get set to say offline mode?
                    }, null);
            }
            return null;
        }
        set
        {
            // Not sure what to put here.
        }
    } 
```

// 看法

```
<i:Interaction.Triggers>
    <i:EventTrigger>
        <GalaSoft_MvvmLight_Command:EventToCommand Command="{Binding MainPageLoaded}"/>
    </i:EventTrigger>
</i:Interaction.Triggers> 
```

**编辑** 我遇到的另一个问题是。我有一个绑定到存储在此属性中的一些数据的列表

```
 public ObservableCollection<ContactGroup> ContactGroups { get; set; } 
```

然后点击我有一个应该触发的中继命令

```
 public ICommand GroupContactTapped
        {
            get
            {
                return new RelayCommand<GestureEventArgs>(e =>
                {
                    var selectedTextBlock = e.OriginalSource as TextBlock;

                    MessageBox.Show(selectedTextBlock.Tag.ToString());
                });
            }
        } 
```

然而，我不知道如何在不将源转换为文本块的情况下找到“点击”的对象。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T01:41:46.143

假设您有一个托管所有其他视图的主页/视图，例如主窗口：我从视图模型发送消息事件，并且对话框在主窗口后面的代码中处理。这是我项目中唯一的代码隐藏，所以我发现项目的其余部分可以严格地是 MVVM 是可以接受的，除了这个例外。

我使用以下内容发送消息（从 VB 转换，因此可能需要工作）：

```
object message = new DialogMessage("YourMessage", YourFunctionThatHandlesCallback) {
    Button = MessageBoxButton.YesNo,
    Caption = "Caption Goes Here"
};
Messenger.Default.Send(message); 
```

我在后面的主页代码中注册了带有以下内容的对话框：

```
Partial Public Class MainWindow
  Inherits Window

  Public Sub New()
    InitializeComponent()

    ''single initialization of messanger for catching message box
    Messenger.[Default].Register(Of DialogMessage)(Me, Sub(msg)
                                                           Dim result = MessageBox.Show(msg.Content, msg.Caption, msg.Button, MessageBoxImage.Warning)
                                                           ''Send callback
                                                           msg.ProcessCallback(result)
                                                       End Sub)
  End Sub
End Class 
```

我无法成功转换 C# lambda，所以我不得不将它留在 VB 中。希望这可以帮助

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-15T13:54:41.413

[Cimbalino Phone Windows Toolkit](https://github.com/Cimbalino/Cimbalino-Phone-Toolkit)中有一个[MessageBoxService](https://github.com/Cimbalino/Cimbalino-Phone-Toolkit/blob/master/src/Cimbalino.Phone.Toolkit%20%28WP71%29/Services/MessageBoxService.cs)！您可以在 MVVM 架构中使用它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-15T19:26:31.863

遵循“MVVM 模式”真正意味着什么是非常主观的事情。
例如，有些人会说您不应该从 VM 显示/启动消息框（任何类型），而其他人会说这很好。

与任何歧义一样，您需要平衡对模式的遵守、最适合特定项目的内容以及适合开发和维护代码库的人员的内容。

就 MvvmLight 而言，它使用的消息传递系统用于从视图模型到另一个视图模型或视图进行通信，而不是用于向用户显示消息。

如果您要使用`Guide.BeginShowMessageBox`，尤其是从视图模型中，请注意它是非阻塞的。如果您希望它表现得像“常规” ，则`MessageBox`需要将其与 a 一起使用，`ManualResetEvent`以便在显示消息框时无法继续与应用程序交互。

# php - 使用查询方法将插入函数转换为准备好的语句

> ID：15420796
> 
> 赞同：0
> 
> 时间：2013-03-14T21:46:02.183
> 
> 标签：php, sql

我有以下执行标准 INSERTs 的代码。我怎样才能重写这个函数来做同样的事情，而不是使用

```
$this->db->query($query) 
```

我希望它能够通过使用准备好的语句来做同样的事情，因为这段代码似乎很容易受到 SQL 注入的攻击。这是代码。

```
 private function insert($table, $arr){

        $query = "INSERT INTO " . $table . " (";
        $pref = "";

        foreach ($arr as $key => $value) {
                $query .= $pref . $key;
                $pref = ", ";
            }
            $query .= ") VALUES (";
            $pref = "";
            foreach ($arr as $key => $value) {
                $query .= $pref. "'" . $value . "'";
                $pref = ", ";
            }
            $query = .= ");";
            return $this->db->query($query);
    } 
```

我用 PDO 连接到 mysql。

编辑：我编写了以下代码，它可以正常工作。

```
private function insert($table, $arr){

    $query = "INSERT INTO " . $table . " (";
    $pref = "";

    foreach ($arr as $key => $value) {
            $query .= $pref . $key;
            $pref = ", ";
        }
        $query .= ") VALUES (";
        $pref = "";
        foreach ($arr as $key => $value) {
            $query .= $pref. ":" . $key ;
            $pref = ", ";
        }
        $query .= ");";
        $result = $this->db->prepare($query);
        $result->execute($arr);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T22:16:25.033

从[http://www.php.net/manual/en/pdo.prepare.php](http://www.php.net/manual/en/pdo.prepare.php)示例 #1，尝试类似

```
private function insert($table, $arr){

    $query = "INSERT INTO " . $table . " (";
    $pref = "";

    foreach ($arr as $key => $value) {
            $query .= $pref . $key;
            $pref = ", ";
        }
        $query .= ") VALUES (";
        $pref = "";
        foreach ($arr as $key => $value) {
            $query .= $pref. ":" . $key;
            $pref = ", ";
        }
        $query = .= ")";
        $this->db->prepare($query);
        $this->db->execute($arr);

} 
```

# jquery - jQuery如何更改特定索引列中文本框的值？

> ID：15420797
> 
> 赞同：0
> 
> 时间：2013-03-14T21:46:02.903
> 
> 标签：jquery

我试图弄清楚如何在特定索引的列中更改文本框的值。我知道我可以使用以下代码执行类似于此代码的操作：

```
$('#gv [id*=txtPrice]').slice(row_index).css("background-color", "yellow"); 
```

但是，当我执行以下操作时出现错误：

```
$('#gv [id*=txtPrice]').slice(row_index).text("0"); 
```

有没有办法更改从特定索引开始的列中文本框的值？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-14T21:55:32.520

如果通过文本框您的意思是一个`<input type="text" />`，您想用来`.val()`设置值，而不是`.text()`，正如@adeneo 在评论中指出的那样。

```
$('#gv [id*=txtPrice]').slice(row_index).val("0"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-14T21:51:33.643

[http://fiddle.jshell.net/PEB5J/](http://fiddle.jshell.net/PEB5J/)

html:

```
<table border="1">
<tr>
<td>row 1, cell 1</td>
<td>row 1, cell 2</td>
<td>row 1, cell 3</td>
</tr>
<tr>
<td>row 2, cell 1</td>
<td>row 2, cell 2</td>
<td>row 2, cell 3</td>
</tr>
</table> 
```

js：

```
$(function(){
    $('table td').eq(1).text('custom');
}); 
```

如果您希望每个 tr 中的每个 td 都在该索引处，我将使用 .each()：[http ://fiddle.jshell.net/PEB5J/1/](http://fiddle.jshell.net/PEB5J/1/)

js：

```
$(function(){
    $('table tr').each(function(){
        $(this).children().eq(1).text('custom');
    });
}); 
```

# c# - 在 C#/WinForms 中调用外部进程会使 UI 无响应。为什么？

> ID：15420798
> 
> 赞同：0
> 
> 时间：2013-03-14T21:46:04.923
> 
> 标签：c#, .net, asynchronous, task-parallel-library

我有一个位于任务栏区域的 Winforms 应用程序。将打开一个用于记录输出的窗口。

现在，在我的组件中（仍然在 UI 线程上）我需要调用一个运行 5-15 分钟并生成文件的外部进程。我需要等待进程退出并使用这些文件。

因为我希望我的 UI 具有响应性（移动窗口等），所以我实现了一个代理并使用 BeginInvoke/EndInvoke 调用该过程：

```
private delegate int BeginCallDelegate( int port, int baud, int timeout, Job job );
private BeginCallDelegate del = null;

public IAsyncResult BeginCall( int port, int baud, int timeout, Job job )
{
    del = new BeginCallDelegate( Call );
    IAsyncResult iar = del.BeginInvoke( port, baud, timeout, job, null, null );
    return iar;
} 
```

在调用代码中，我使用 WaitOne() 轮询 IAsyncResult 但请注意，如果未*冻结，UI 将非常**无响应*：

 *```
IAsyncResult a = agent.BeginCall(...); //BeginInvoke
while ( !a.IsCompleted )
{
    iar.AsyncWaitHandle.WaitOne( 250 );
    //writing something to a textbox works here, but overall responsiveness is weak
}

agent.EndCall( iar ); //EndInvoke 
```

**VS 告诉我外部进程是在工作线程上启动的，但为什么这对我的 UI 响应没有帮助？它不应该阻塞调用线程**

这是启动该过程的代码：

```
ProcessStartInfo psi = new ProcessStartInfo();

psi.FileName = "app.exe";
psi.Arguments = String.Format( "blah blah", port, baud, timeout, job.FullName );

psi.CreateNoWindow = false;
psi.ErrorDialog = false;
psi.WindowStyle = ProcessWindowStyle.Hidden;

process.StartInfo = psi;

if ( !process.Start() )
    throw new Exception( "The process cannot start." );

process.WaitForExit( job.Timeout ); 
```

***提示：为了测试，外部 app.exe 是一个虚拟应用程序，除了 Thread.Sleep(60000) 之外什么都不做。CPU 负载为 3%。***

**另一个问题：如果不使用 Begin/EndInvoke，我将如何以“TPL 方式”执行此操作？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T23:16:57.383

尝试在您的主线程中执行此操作：

```
ProcessStartInfo psi = new ProcessStartInfo();
Thread processStarter = new Thread(delegate()
{
psi.FileName = "app.exe";
psi.Arguments = String.Format( "blah blah", port, baud, timeout, job.FullName );
psi.CreateNoWindow = false;
psi.ErrorDialog = false;
psi.WindowStyle = ProcessWindowStyle.Hidden;
process.StartInfo = psi;
process.Start();
process.WaitForExit( job.Timeout );
//call methods that deal with the files here
});
processStarter.IsBackground = true;
processStarter.Start(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T11:54:23.353

您的代码异步启动一个方法，但随后在繁忙的等待循环中阻塞，检查 IsComplete 标志。这不是使用代表的正确方法。

您应该将回调函数传递给 BeginInvoke，而不是忙于等待，该回调函数将在委托完成时调用。这已经包含在文档中。勾选MSDN 的[“异步调用同步方法](http://msdn.microsoft.com/en-us/library/2e08f6yc.aspx)**”中的“异步调用完成时执行回调方法**” 。

在你的情况下，你必须写：

```
del.BeginInvoke( port, baud, timeout, job, new AsyncCallBack(MyMethod), null ); 
```

其中 MyMethod 是将处理调用结果的方法。*

# java - 多个 Mark() BufferReader

> ID：15420799
> 
> 赞同：2
> 
> 时间：2013-03-14T21:46:06.747
> 
> 标签：java

是否可以为缓冲区阅读器设置多个标记，以便我可以多次阅读？

所以我的代码相当长，但基本思想是在设置一个我将返回的标记之后，我会提前阅读。我的代码检查这个“提前”行是否满足某些条件，如果满足，它会在返回到初始行之前提前读取 4 行或 1 行。

```
String line = in.readLine(); //reading first line
in.mark(1000);  

while(nextLine != null){
    String nextLine = in.readLine();  
    //NEED TO SET MARK HERE TO RETURN TO
    if(!nextLineType.equals("something")){
        if(nextLine meets some condition){
           //read next four lines
        }else{
           //read next line
        }
    }else{
        in.reset()
    }
} 
```

如何解决这个问题？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T22:16:54.423

没有办法开箱即用。你可以写一个装饰器来做这件事，也许有一堆标记。但是，如果您只关心逐行阅读和倒带，我认为更简单的实现是使用列表来维护“历史”和“回退”。

我认为描述它会比 Teh Codez 花费更多的行数，所以这是实现的第一步（这*不是*生产质量代码；一方面，它不限制历史列表，所以你很容易用完内存):

```
import java.io.BufferedReader;
import java.io.IOException;
import java.util.LinkedList;

public class ReaderBuffer
{
    private BufferedReader reader;

    private LinkedList<String> history = new LinkedList<String>();
    private LinkedList<String> future = new LinkedList<String>();

    public ReaderBuffer(BufferedReader reader) 
    {
        this.reader = reader;
    }

    public String readLine()
    throws IOException
    {
        String line = null;

        if (future.size() > 0)
            line = future.removeFirst();

        if (line == null)
            line = reader.readLine();

        if (line != null)
            history.add(line);

        return line;
    }

    public void rewind(int numLines) 
    {
        for (int ii = 0 ; ii < numLines ; ii++) 
            future.addFirst(history.removeLast());
    }
} 
```

这是一个如何使用它的例子：

```
@Test
public void testRewind() throws Exception 
{
    BufferedReader rdr = new BufferedReader(new StringReader("foo\nbar\nbaz\n"));
    ReaderBuffer buf = new ReaderBuffer(rdr);

    assertEquals("foo", buf.readLine());
    assertEquals("bar", buf.readLine());
    assertEquals("baz", buf.readLine());
    assertEquals(null,  buf.readLine());

    buf.rewind(2);

    assertEquals("bar", buf.readLine());
    assertEquals("baz", buf.readLine());
    assertEquals(null,  buf.readLine());
} 
```

# parameters - google自定义搜索api复杂搜索词

> ID：15420800
> 
> 赞同：3
> 
> 时间：2013-03-14T21:46:09.950
> 
> 标签：parameters, google-custom-search

我正在编写的程序需要执行复杂的搜索查询。一个例子是

（蓝色和牛仔裤而不是（便宜|| 昂贵））。我怎样才能做到这一点。我知道有诸如 hq 和 exclude 和 orTerms （或只是布尔运算符）之类的参数，但我不知道如何组合它们，或者它们是否可以为此组合。

谢谢一堆

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2015-03-25T11:37:37.577

参数在[此处](https://developers.google.com/custom-search/json-api/v1/reference/cse/list)描述。

> *q*（字符串）
> 搜索表达式。
> 
> *exactTerms* (string)
> 标识搜索结果中的所有文档都必须包含的短语。
> 
> *excludeTerms* (string)
> 标识不应出现在搜索结果的任何文档中的单词或短语。
> 
> *orTerms* (string)
> 提供要在文档中检查的附加搜索词，其中搜索结果中的每个文档必须至少包含一个附加搜索词。

[这里](https://developers.google.com/custom-search/docs/xml_results#booleanOperators)描述了不同的布尔运算符。

> **AND**
> includeTerms=(phrase%20one).(phrase%20two)
> 
> **非**
> q=key1%20(-key2)
> 
> **或**
> excludeTerms=key1|key2或Terms
> =key1|key2
> 
> **()**
> lr=-(lang_fr|lang_it)

你可以调用`q=john%20doe&orTerms=wikipedia|imdb`它，这将产生包含`john AND doe AND ( wikipedia OR imbd )`.

我没想到的是`q=&exactTerms=(john).(doe).(wikipedia)`（46 个结果）返回的结果与`q="john%20doe%20wikipedia"`（46 个结果）相同。我认为它的结果与`q="john"%20"doe"%20"wikipedia"`（153000 个结果）相同。因此，它有时更像是一个 CONCAT 而非 AND 运算符，或者`exactTerms`根本无法支持多个关键字。

# powershell - 从文件夹复制文件并在特定目录中搜 索相同的文件夹名称powershell

> ID：15420801
> 
> 赞同：-1
> 
> 时间：2013-03-14T21:46:11.127
> 
> 标签：powershell

我什至不确定这是否可能，但我需要将文件从一个文件夹目录复制到另一个文件夹目录，但`tree`目录 2 的结构与目录 1 不同。这是一个示例：

```
Directory1
--folder1
----text1.pdf
----text2.pdf
--folder2
----text3.pdf
----text4.pdf

Directory2
--home1
----folder1
------text1.pdf
------text2.pdf
--home2
----folder2
------text3.pdf
------text4.pdf 
```

文件夹`"folder1"`和`"folder2"`将在 中`Directory2`，但它们可能位于不同的文件夹中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T22:24:45.413

未测试：

```
$dirs1 =
get-childitem c:\directory1 -recurse |
 where {$_.psiscontainer} |
 select -ExpandProperty fullname

$dirs2 =
get-childitem c:\directory2 -recurse |
 where {$_.psiscontainer} |
 select -ExpandProperty fullname

 $dir_ht = @{}

 foreach ($dir in $dirs1)
 {
  $root = $dir -replace '.+Directory1',''
  $dir_ht[$dir] = ($dirs2 -match $root)
}

$files =
get-childitem c:\directory1 -recurse |
 where {-not($_.psiscontainer)} |
 select -ExpandProperty fullname

foreach ($file in $files)
 {copy-item -Path $file -Destination $dir_ht[($file | Split-Path -Parent)]} 
```

# ruby-on-rails - 应该将哪些对象传递给具有三重嵌套路由的 link_to？

> ID：15420804
> 
> 赞同：0
> 
> 时间：2013-03-14T21:46:22.917
> 
> 标签：ruby-on-rails, routes, link-to, nested-routes

对于三重嵌套路由，我应该将哪些对象传递给我的 link_to？我想检索练习显示页面。

### show.html.erb - 锻炼

```
<%= link_to exercise.name, plan_workout_exercise_path(???) %> 
```

### 路线.rb

```
resources :plans do
 resources :workouts do
   resources :exercises
 end
end 
```

### 锻炼控制器.html.erb

```
def show
    @workout = Workout.find(params[:id])  
end 
```

我尝试了以下操作，但它没有将正确的 ID 提供给正确的模型。

```
<%= link_to exercise.name, plan_workout_exercise_path(@plan, @workout, @exercise) %> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T21:57:26.187

您还必须参加`@plan`表演活动：

在您的**锻炼控制器.rb 中**：

```
def show
    @plan = Plan.find(params[:plan_id])
    @workout = Workout.find(params[:id])
end 
```

**在你的 exercise_controller.rb**：

```
def show
    @plan = Plan.find(params[:plan_id])
    @workout = Workout.find(params[:workout_id])
    @exercise = Exercise.find(params[:id])
end 
```

你也可以这样做：

```
<%= link_to exercise.name, [@plan, @workout, exercise] %> 
```

建议：尝试获取**RailsForZombies 2**幻灯片，它有一个很好的部分如何处理嵌套路由，或者只是查看指南。

此外，只是为了让代码更简洁，使用回调函数获取`@plan`in`workout_controller.rb`和in ：`@plan``@workout``exercise_controller.rb``before_filter`

```
class WorkoutsController < ApplicationController

    before_filter :get_plan

    def get_plan
        @plan = Plan.find(params[:plan_id])
    end

    def show
        @workout = Workout.find(params[:id])
    end

end 
```

就像 Thomas 说的，尽量避免那些深度嵌套的路线。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-14T22:00:01.097

如果你正在使用`exercise.name`我假设你是通过一个循环`@workout.exercises.each do |exercise|`，对吧？

但是，您必须在控制器中定义 @plan。

```
def show
  @plan = Plan.find(params[:plan_id])
  @workout = @plan.workouts.find(params[:workout_id])
end 
```

然后，

```
<%= link_to exercise.name, plan_workout_exercise_path(@plan, @workout, exercise) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-14T22:04:41.207

避免三重嵌套的一种方法是像这样构建您的路线：

```
resources :plans do
  resources :workouts, except: [:index, :show]
end

resources :workouts, only: [:index, :show] do
  resources :exercises
end 
```

到那时你总是只需要一层嵌套和更简单的链接助手。

```
<%= link_to 'Create a new workout', new_plan_workout_path(@plan) %>
<%= link_to workout.name, workout_path(@workout) %>

<%= link_to 'Create a new exercise', new_workout_exercise_path(@workout) %>
<%= link_to exercise.name, workout_exercise_path(@workout, @exercise) %> 
```

# c++ - C++ mpir：如何初始化 mpz_t 数组？

> ID：15420806
> 
> 赞同：1
> 
> 时间：2013-03-14T21:46:24.650
> 
> 标签：c++

**来源：**

```
//$ DO DECLARATION
#define VEC_MAX_SIZE 600000
mpz_t Vec[ VEC_MAX_SIZE ];

//$ DO INITIALIZATION
mpz_array_init( Vec[ 0 ], VEC_MAX_SIZE, 2000 ); // Stack overflow error - 3rd param 
```

**问题：**

问题是我不知道如何正确初始化一个 mpz_t 数组，在本例中是 Vec。错误是堆栈溢出。我认为这是由第三个参数引起的。这是 mpz_array_init 的原型/定义：

```
#define mpz_array_init __gmpz_array_init
__GMP_DECLSPEC void mpz_array_init __GMP_PROTO ((mpz_ptr, mp_size_t, mp_size_t)); 
```

**错误：**

```
Unhandled exception at 0x008e8377 in TestMPIR.exe: 0xC00000FD: Stack overflow. 
```

**笔记：**

我在 Windows 7 64 位上使用 mpir 3.1.1。

mpir 示例中的这个可以正常工作：

```
mpz_t Vec[ 20000 ];
mpz_array_init( Vec[ 0 ], 20000, 512 ); 
```

**回答：**

感谢@Zeta 他/她的精彩回答。如果我错了，请纠正我。我只是想在这里发布这个，以便其他新手可以从中学习。

```
#define MAX_VEC_SIZE 600000 
```

**malloc 方法（我猜应该是 C 风格）：**

```
mpz_t *Vec;

if( ( Vec = ( mpz_t *)::malloc( sizeof( mpz_t ) * MAX_VEC_SIZE ) ) == 0 ) {
    ::perror( "Out of memory" );
    return false;
}

//> Initialize Vec loop ( ... )

::free( Vec ); 
```

**C++ 风格？**

```
mpz_t *VecEx = new mpz_t[ MAX_VEC_SIZE ];

//> Initialize VecEx loop ( ... )

delete [ ] VecEx; 
```

该答案基于@Zeta 的答案（已接受的答案）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-14T22:08:17.897

对于如此大的向量（“堆栈溢出”），堆栈上根本没有足够的空间。您必须动态分配它：

```
mpz_t * Vec = malloc(VEC_MAX_SIZE * sizeof(mpz_t)); 
```

`Vec`大小约为 6MiB。堆栈对于此类对象来说不够大。请注意，GMP 还提供了一个[C++ 接口](http://www.delorie.com/gnu/docs/gmp/gmp_72.html)。

# java - 递归平方分区

> ID：15420815
> 
> 赞同：1
> 
> 时间：2013-03-14T21:47:15.093
> 
> 标签：java, algorithm, math, recursion

我在理解递归方面遇到了麻烦，我无法解决以下问题。

**输入：一个对象（fe 字段）和整数 n**

**所需输出：具有 n 个字段的列表**

我写了一个方法，将一个简单的对象分成两部分，效果很好。但我无法处理递归。

createFields(field, 5) 的最小示例：

```
Input:
**********************************
*                                *
*                                *
*                                *
**********************************
1st iteration (after divide(field))
**********************************
*                *               *                
*                *               *
*                *               *
**********************************
2nd iteration 
**********************************
*                *               *                
**********************************
*                *               *
**********************************
3rd last iteration 
**********************************
*       *        *               *                
**********************************
*                *               *
********************************** 
```

你能帮我解决这个问题吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T22:04:40.503

算法的高级描述是：

```
divide_recursively (fields, n)
args:
    input/output fields : List of fields
    input n : integer (number of fields)
precondition:
    head of list is largest available field
body:
    if (fields.size() == n) return
    f = fields.front()
    fields.pop_front()
    fsplit[] = split_field(f)
    fields.push_back(fsplit[0])
    fields.push_back(fsplit[1])
    divide_recursively(fields, n) 
```

只要`split_field`将输入精确地分成两半，该算法始终满足前提条件。

该算法使用递归呈现，因为这是问题中的标签之一。[这使用尾递归，许多编译器/解释器会将其转换为常规循环，作为尾调用](http://en.wikipedia.org/wiki/Tail_call)优化的特例。

* * *

上面的算法使用了贪婪的方法。下面是一种使用分而治之方法的替代算法。

```
divide_recursively (fields, n)
precondition:
    fields contains exactly one element
body:
    if (n == 1) return
    f = fields.front()
    fields.pop_front()
    fpslit[] = split_field(f)
    subfields1 = new list + fsplit[0]
    subfields2 = new list + fsplit[1]
    divide_recursively(subfields1, n/2)
    divide recursively(subfields2, n - n/2)
    fields = subfields1 + subfields2 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-14T22:07:59.193

您应该能够迭代地使用您当前的功能。您从 1 个字段开始并调用您的函数，它会为您提供 2 个字段的列表。将它们添加到临时列表中。现在只需在这些字段上调用您的拆分函数。一旦用完一定大小的字段，您就可以从拆分较小的字段开始。

下面的代码应该为您提供大小为 x 和 x/2 的 n 个字段（存储在`fields`和中`fields2`）。

```
Field startField=...
ArrayList<Field> fields=new ArrayList<Field>();
ArrayList<Field> fields2=new ArrayList<Field>();
fields.add(startField);
nrFields=1;
outerlabel:
while(nrFields<n){
    while((!fields.isEmpty()){
        Field fieldToSplit = fields.remove(0);
        List<Field> splitFields=splitt(fieldToSplit);
        fields2.addAll(splitFields);
        nrFields++;
        if(nrFields==n)break outerlabel;
    }
    fields=fields2;
    fields2=new ArrayList<Field>();

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-14T22:19:55.233

根据我的一条评论，这里是一个非递归解决方案的提议（在伪代码中）：

```
split(field, n) {
    queue = new Queue()
    queue.addLast(field)
    while (queue.size() < n) {
        f = queue.removeFirst()
        pair = f.split()
        queue.addLast(pair.a)
        queue.addLast(pair.b)
    }
    return queue 
```

}

# python - 处理 sympy 积分返回的分段方程

> ID：15420816
> 
> 赞同：16
> 
> 时间：2013-03-14T21:47:21.583
> 
> 标签：python, sympy, symbolic-math, computer-algebra-systems, symbolic-computation

在 sympy 中，我有一个返回 Piecewise 对象的积分，例如

```
In [2]: from sympy.abc import x,y,z

In [3]: test = exp(-x**2/z**2)

In [4]: itest = integrate(test,(x,0,oo))

In [5]: itest
Out[5]: 
⎧   ___                                                   
⎪ ╲╱ π ⋅z       │                 ⎛      1          ⎞│   π
⎪ ───────   for │periodic_argument⎜──────────────, ∞⎟│ ≤ ─
⎪    2          │                 ⎜          2      ⎟│   2
⎪               │                 ⎝polar_lift (z)   ⎠│    
⎪                                                         
⎪∞                                                        
⎪⌠                                                        
⎨⎮    2                                                   
⎪⎮  -x                                                    
⎪⎮  ───                                                   
⎪⎮    2                                                   
⎪⎮   z                                                    
⎪⎮ ℯ    dx                    otherwise                   
⎪⌡                                                        
⎪0                                                        
⎩ 
```

我想只提取这个分段方程的第一个分支，换句话说，我希望能够做一些`itest.parts(0)`简单的事情`sqrt(pi)*z/2`。我似乎找不到任何方法来做到这一点，但也许我在文档中使用了错误的搜索词。有任何想法吗？

**编辑**

戳了一下，我设法发现如果我这样做，`itest.args[0][0]`我可以提取这个表达式。然而，这似乎有点像黑客。有更好的方法吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-03-15T17:11:59.577

通常，使用`.args`是访问表达式部分的正确方法。

但是，在这种情况下，有一个选项`integrate`可以让您忽略收敛条件

```
In [39]: integrate(test, (x, 0, oo), conds='none')
Out[39]:
  ___
╲╱ π ⋅z
───────
   2 
```

此外，如果您在变量上明确设置您知道的假设，则收敛条件通常会自行解决（不过，在这种情况下，对于 的任何简单假设似乎都不会发生`z`）。例如，如果您知道那`z`是真实的，请使用`z = Symbol('z', real=True)`. 通常假设事情是真实的，甚至更好的是积极的，当您知道这将有助于确保收敛时。

# c# - 访问父中继器 DataItem 属性

> ID：15420819
> 
> 赞同：7
> 
> 时间：2013-03-14T21:47:30.263
> 
> 标签：c#, asp.net, repeater, nested-repeater

我有一个控件，它有一个Repeater，rptReferrals，它贯穿一个实体对象列表，Referrals。Referrals 对象具有对另一个名为 Answers 的表的引用，该表是为用户提交的 Answers 列表。rptReferrals 会将一个子转发器 rptQuestionnaire 绑定到我登录的人的问题列表，该列表未连接到它所绑定的推荐对象。

这是aspx代码：

```
<asp:Repeater runat="server" ID="rptReferrals" OnItemDataBound="rptReferrals_OnItemDataBound">
    <ItemTemplate>
        //some HTML for the referral object
        <asp:Repeater runat="server" ID="rptQuestionnaire" OnItemDataBound="rptQuestionnaire_OnItemDataBound">
              //some HTML for displaying questions and answers
        </asp:Repeater>
    </ItemTemplate>
 </asp:Repeater> 
```

后端代码：

```
protected void rptReferrals_OnItemDataBound(object sender, RepeaterItemEventArgs e)
{
    if (e.Item.ItemType == ListItemType.Item || e.Item.ItemType == ListItemType.AlternatingItem)
    {
         //THIS IS THE ITEM THAT HAS THE LIST OF ANSWERS I NEED
         var data = e.Item.DataItem as PatientReferral;
         var rptQuestionnaire = e.Item.FindControl("rptQuestionnaire") as Repeater;
         rptQuestionnaire.DataSource = QuestionList;   
         rptQuestionnaire.DataBind();

         //QuestionList is a list of questions populated on page load.
         // I can't bind to the property of data.Answers because not
         //all questions are answered. data.Answers is only a list of 
         //the questions answered
    }
}

protected void rptQuestionnaire_OnItemDataBound(object sender, RepeaterItemEventArgs e)
{
    if (e.Item.ItemType == ListItemType.Item || e.Item.ItemType == ListItemType.AlternatingItem)
    {
       Need to access the data.Answers object from above. HOW????
    }
} 
```

我遇到的问题是不需要问题列表，无论用户是否回答，我都需要显示所有问题。但如果他们确实回答了，我需要显示答案，即附加到 rptReferrals 的属性。

关于如何访问我的父中继器数据项的属性的任何想法？在这一点上，我会接受任何答案。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-15T06:20:38.920

您可以使用控件的`.Parent`属性`RepeaterItem`来工作到外部`RepeaterItem`（因此，它的`DataItem`）。

似乎这样会起作用：

```
protected void rptQuestionnaire_OnItemDataBound(object sender, RepeaterItemEventArgs e)
{
    if (e.Item.ItemType == ListItemType.Item || e.Item.ItemType == ListItemType.AlternatingItem)
    {
       Repeater currentRepeater = (Repeater)sender;
       // Note that you might only need one ".Parent" here.  Or you might need
       // more, depends on your actual markup.
       var data = ((RepeaterItem)e.Item.Parent.Parent).DataItem as PatientReferral;
       // Now you have access to data.Answers from the parent Repeater
    }
} 
```

# c# - Microsoft.Speech.Recognition 识别听写

> ID：15420832
> 
> 赞同：3
> 
> 时间：2013-03-14T21:48:12.613
> 
> 标签：c#, .net, speech

我正在使用 Microsoft.Speech.Recognition 来识别一些语音。我安装了 SDK v11，它运行良好，直到我尝试 AppendDictation 到 GrammarBuilder：

```
Thread.CurrentThread.CurrentCulture = new CultureInfo("en-US");
Thread.CurrentThread.CurrentUICulture = new CultureInfo("en-US"); 
sre = new SpeechRecognitionEngine(new System.Globalization.CultureInfo("en-US"));

sre.SetInputToDefaultAudioDevice();
GrammarBuilder gb = new GrammarBuilder();
gb.Append("start");
gb.AppendDictation();
gb.Append("end");
Grammar g = new Grammar(gb);
sre.LoadGrammar(g); 
```

它在 line 崩溃`sre.LoadGrammar(g)`。

**FileNotFound 异常**

错误文本：找不到此语法引用的语法。

难道我做错了什么？我将不胜感激您的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-08-15T18:34:31.530

不幸的是，微软语音 SDK 的服务器版本目前不支持听写语法。您应该尝试使用`System.Speech.Recognition`命名空间而不是`Microsoft.Speech.Recognition`命名空间。如果尚未安装，则需要在服务器上安装语音识别。

# android - onResume() 未在第二次启动 Activity 时调用

> ID：15420836
> 
> 赞同：5
> 
> 时间：2013-03-14T21:48:30.740
> 
> 标签：android

在正常的开发过程中，我注意到一个特定的活动在第二次被调用时似乎停止了响应。

IE`menu->(intent)->activity->(back button)->menu->(intent)`

logcat 中没有任何相关内容。

我什至不知道从哪里开始调试，也不知道要显示什么代码，所以这里是`onClick`和`onResume`片段：

```
 if (!dictionary.getClassName().equals("")) {

            this.setOnClickListener(new OnClickListener() {
                public void onClick(View v) {

                    Intent i;

                    i = new Intent(mContext, NVGlobeNavigatorVC.class);
                    i.putExtra("PAGE_TITLE", title);
                    i.putExtra("TITLE", _dictionary._title);

                    mContext.startActivity(i);

            });
        } else {
            findViewById(R.id.greaterthan).setVisibility(View.GONE);
        } 
```

并在正在启动的活动中：

```
@Override
protected void onResume() {

    super.onResume();

    ... 
```

清单上也没有什么异常：

```
<activity
    android:name=".NVViews.NVGlobeNavigatorVC"
    android:theme="@style/WindowTitleBackground"
    android:label="GlobeNavigator"/> 
```

为了清楚起见，我在`mContext.startActivity(i)`and上放置了断点`super.onResume()`。我单击带有 的视图，`onClickListener`两个断点都按预期命中。然后我按下返回按钮，返回菜单。 `onPause()`按预期调用。

我触摸视图以再次启动活动，并且断点`startActivity`被击中但不在`onResume()`目标活动中。屏幕变黑了，我能重新开始的唯一方法就是重新启动应用程序。如果我暂停调试器，它会暂停，`dalvik.system.NativeStart()`这意味着该活动永远不会重新启动。

我认为这无关紧要，但我正在使用 Intellij IDEA 并删除了所有输出目录，使缓存无效并完成了完全重建。

目标 API 是 8。我在 2.3 和 4.0.4 上进行了测试。

有任何想法吗？我难住了。

[编辑]

在`onPause`中，我将一些东西保存到首选项。的目的`onResume()`是让他们再次回来：

```
@Override
protected void onPause() {

   super.onPause();

   SCPrefs.setGlobeViewViewPoint(globeView.getViewPoint());
   SCPrefs.setGlobeViewZoom(globeView.getZoom());
   SCPrefs.setGlobeViewScale(globeView.getScale());

    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-18T08:12:05.500

我发现了问题，而且有点深奥。

我有一个大型静态数据结构，它加载在类静态初始化程序中。如果数据结构仍在加载，则该初始化程序中有一个错误导致第二次调用它时出现无限循环。

因为该类在我的 Activity 中被引用，所以类加载器在之前加载它`onCreate()`或被`onResume()`调用。

循环给出了 Activity 加载器已挂起的外观。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-15T02:28:12.847

这段代码：

```
i = new Intent(mContext, NVGlobeNavigatorVC.class); 
```

创建一个新的意图。意图是类的`NVGlobeNavigatorVC.class`。

如果你调用它一次，你就会创建一个新的活动，我们称之为“iTheFirst”。如果您退出活动，它会“暂停”执行。当您再次运行上述代码时，您将创建另一个相同类的新活动，但活动不同。因此，它不会恢复您的其他活动，而是创建一个我们可以称为“iTheSecond”的新活动。它看起来就像 iTheFirst，但很独特。

如果您想恢复上述内容，在退出后，您需要在菜单中保留对它的引用。然后在您的 onClick 中，查看该活动是否存在，如果不存在，则新建一个并启动它，如果存在，则继续它。

这是一个记住并重新启动活动的示例活动：

```
Intent savedCueCardActivity = null;
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState, R.layout.landing);
}

public void goToNextScreen(View v) {
    if (savedCueCardActivity == null) {
        savedCueCardActivity = new Intent().setClass(this, CueCardActivity.class);
        startActivity(savedCueCardActivity);
        //       lastActivity.finish();
    } else {
        savedCueCardActivity.setFlags(Intent.FLAG_ACTIVITY_REORDER_TO_FRONT);
        startActivity(savedCueCardActivity);
    }
    overridePendingTransition(R.anim.fade_in, R.anim.fade_out);
} 
```

# c++ - 使用特定大小 C++ 的 SDL_gfx 调整图像大小

> ID：15420837
> 
> 赞同：0
> 
> 时间：2013-03-14T21:48:33.850
> 
> 标签：c++, image, resize, sdl

我正在使用 SDL_gfx 尝试调整图像大小，但我无法真正完成。

情况是我有一个：

```
SDL_Surface* screen = SDL_SetVideoMode(0,0,32,SDL_FULLSCREEN); 
```

我还有一个：

```
SDL_Surface* back_img = SDL_Load("back.jpg"); 
```

如您所见，我将视频模式设置为全屏，因此屏幕表面的大小会因电脑而异。我想找到一种在屏幕上制作 back_img FIT 的方法，但我有两个主要问题。

1.  `screen->w`并`screen->h`返回一个假值！
2.  我无法将图像调整为我想要的特定大小。

有什么帮助吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T21:57:02.943

您的`screen->w`值返回 0，因为您使用`SDL_SetVideoMode(0,0,...` Set them to some proper values 将它们设置为零，例如`SDL_SetVideoMode(800,600,32,SDL_FULLSCREEN);`您可以稍后通过使用不同参数再次调用函数来更改它们。

笔记; 设置 SDL 全屏将自动调整和拉伸图像以适应屏幕

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-17T17:09:21.603

您可以使用 SDL_VideoInfo 获取当前分辨率。请看下面的代码：

```
const SDL_VideoInfo *info = SDL_GetVideoInfo();
SDL_Surface *screen = SDL_SetVideoMode( info->current_w, info->current_h, 32, SDL_FULLSCREEN ); 
```

现在您的屏幕分辨率将匹配每台 PC 的分辨率。

# c++ - C++ (gcc/g++) 两个巨大的字符串数组需要很长时间来编译

> ID：15420839
> 
> 赞同：8
> 
> 时间：2013-03-14T21:48:41.457
> 
> 标签：c++, arrays, string, static, constants

对于用 C++ 编写的程序，我需要两个包含数据的巨大字符串数组。

它们在头文件中定义如下：

```
#include <string>
static const string strdataA[30000]={"this is the first line of the data",
    "the second line of data",
    "other stuff in the third line", 
```

向下

```
 "last line."};
//second array strings
static const string strdataB[60000]={"this is the first line of the data",
    "the second line of data",
    "other stuff in the third line", 
```

向下

```
 "last line."}; 
```

但是当我用 g++ 编译它时，它需要很长时间，以至于我还没有看到它完整。它还使用大约 2 GB 的虚拟内存。所以我把strdataB[]注释掉了，然后程序确实编译了，但是过了很久还是这样。可执行文件只有大约 8 Mb 并且运行良好。

我可以做些什么来加快编译过程？我不介意是否必须更改代码，但我不想使用外部文件来加载。我想要一个数组，因为它在程序中非常适合我。

我在网上某处读到“静态常量”应该可以解决问题，但我从经验中了解到它没有。

非常感谢您的任何建议！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-14T21:57:55.530

你不应该使用`std::string`它。改用普通的 old `const char*`：

```
const char * const strdataA[30000] = {
    "one",
    "two",
    //...
}; 
```

关键字在`static`这里不应该有太大的不同。

这样，字符串本身将作为简单的文字存储在只读数据部分中，而数组本身将只是一个指针数组。此外，您避免在运行时运行字符串构造函数/析构函数。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-14T21:52:26.863

我相信这些是 GCC 中的已知问题。你没有说你使用的是什么版本的 GCC，也许你应该尝试使用最新的稳定版本的 GCC，看看它是否有改进。

您可能不应该将所有字符串保留在源代码中。您可能应该在启动时从外部文件中加载它们。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-14T22:00:14.070

> 我可以做些什么来加快编译过程？

`const char* strdataA ...`应该加快编译过程。因为在您当前的版本中，g++ 必须为每个字符串创建巨大的构造函数调用列表。

# sql - 按 T CP 地址划分的最大日期组

> ID：15420843
> 
> 赞同：2
> 
> 时间：2013-03-14T21:48:45.160
> 
> 标签：sql, greatest-n-per-group

**我想要什么：**我遇到了每组最大 n 个问题。我的组是一组 TCP 地址，n 是表行插入数据库的日期。

**问题：**我目前正在获取与我的 where 子句匹配的 tcp 地址的所有行，而不是每个 tcp 地址具有最大日期的行。

我正在尝试遵循此示例但失败了：[SQL Select only rows with Max Value on a Column](https://stackoverflow.com/questions/7745609/sql-select-only-rows-with-max-value-on-a-column#7745635)。

这是我的桌子的样子。

```
CREATE TABLE IF NOT EXISTS `xactions` (
  `id` int(15) NOT NULL AUTO_INCREMENT,
  `tcpAddress` varchar(40) NOT NULL,
   //a whole lot of other stuff in batween
  `date` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`)
) ENGINE=MyISAM  DEFAULT CHARSET=latin1 AUTO_INCREMENT=150 ; 
```

示例行是

```
ID | tcpAddress     | ...  | date
1  |  192.168.1.161 | ...  | 2012-09-12 14:19:39
2  |  192.168.1.162 | ...  | 2012-09-12 14:19:40
3  |  192.168.1.162 | ...  | 2012-09-12 14:19:41
4  |  192.168.1.162 | ...  | 2012-09-12 14:19:42 
```

我正在尝试使用的 SQL 语句

```
select yt.id, yt.tcpAddress, yt.analog, yt.discrete, yt.counter, yt.date
from xactions yt
inner join(
    select id, tcpAddress, analog, discrete, counter, max(date) date
    from xactions
    WHERE tcpAddress='192.168.1.161' OR tcpAddress='192.168.1.162'
    group by date
) ss on yt.id = ss.id and yt.date= ss.date 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T21:55:32.287

您也可以将选项与 EXISTS() 一起使用。在 EXISTS() 中找到每组 tcpAddress 的 MAX(date) 并比较它们

```
SELECT id, tcpAddress, analog, discrete, counter, date
FROM xactions x1    
WHERE EXISTS (
              SELECT 1
              FROM xactions x2
              WHERE x1.tcpAddress = x2.tcpAddress
              HAVING MAX(x2.date) = x1.date
              ) AND (tcpAddress='192.168.1.161' OR tcpAddress='192.168.1.162') 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-14T21:54:02.820

您需要按 tcpAddress 分组，而不是按日期分组。

并通过 tcpAddress 加入，而不是 id。

```
select yt.id, yt.tcpAddress, yt.analog, yt.discrete, yt.counter, yt.date 
from xactions yt 
inner join ( 
  select tcpAddress, max(date) date 
  from xactions 
  where tcpAddress in ('192.168.1.161', '192.168.1.162')
  group by tcpAddress
 ) ss using (tcpAddress, date); 
```

此外，您不需要在派生表中选择任何额外的列——只需选择 tcpAddress 和 max(date)。

# jquery - 当用户未填充所有掩码时，掩码输入清空值

> ID：15420846
> 
> 赞同：0
> 
> 时间：2013-03-14T21:49:01.503
> 
> 标签：jquery, maskedinput

我在表格上有电话输入。我使用蒙版输入，我必须创建一个模拟值的跨度，当用户单击输入时它会删除跨度，但如果用户没有填充所有蒙版，则在模糊时，它不会显示错误值（使用跨度）。

我使用 span 因为我在使用 value 时遇到了同样的问题..

```
$('#telefone').on({
            focus: function(){
                $('#contato span.value_telefone').hide();
                $('#contato #telefone').mask('(99) 9999-9999');
            },
            blur: function(){
                if($('#contato #telefone').val()=='' || $('#contato #telefone').val()=='(__) ____-____'){
                    $('#contato span.value_telefone').show();
                }
            }
        });
        $('#contato span.value_telefone').click(function(){
            $(this).hide();
            $('#contato #telefone').mask('(99) 9999-9999');
            $('#contato #telefone').focus();
        }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T22:05:47.133

它不是完全相同的功能，但更容易使用 html5 占位符属性：

```
<input name="tel" placeholder="(99) 9999-9999"/> 
```

# algorithm - Big O 表示最坏情况的运行时间，Ω 表示最好的情况，但为什么有时在最坏情况下使用 Ω？

> ID：15420848
> 
> 赞同：10
> 
> 时间：2013-03-14T21:49:12.127
> 
> 标签：algorithm, data-structures, heap, complexity-theory, asymptotic-complexity

我很困惑，我以为您将 Bi​​g O 用于最坏情况的运行时间，而 Ω 用于最好的情况？有人可以解释一下吗？

(lg n) 不是最好的情况吗？和 (nlg n) 是最坏的情况？还是我误解了什么？

> 证明 Max-Heapify 在大小为 n 的堆上的最坏情况运行时间为 Ω(lg n)。（提示：对于具有 n 个节点的堆，给出节点值，使 Max-Heapify 在从根到叶的路径上的每个节点处被递归调用。）

编辑：不，这不是家庭作业。我正在练习，这有一个答案键购买我很困惑。 [http://www-scf.usc.edu/~csci303/cs303hw4solutions.pdf](http://www-scf.usc.edu/~csci303/cs303hw4solutions.pdf)问题 4(6.2 - 6)

编辑2：所以我误解了不是关于大O和Ω的问题？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-03-14T22:13:26.433

区分 case 和 bound 很重要。

在分析算法时，最佳、平均和最差是常见的关注*案例*。

上 (O, o) 和下 (Omega, omega) 以及 Theta 是函数的常见*界限*。

当我们说“算法 X 的最坏情况时间复杂度是 O(n)”时，我们是说当我们将输入限制为最坏情况输入时，代表算法 X 性能的函数是由某个线性函数从上面渐近限制的. 您可以说最坏情况输入的下限；或平均或最佳案例行为的上限或下限。

案例！=绑定。就是说，“最坏的上限”和“最好的下限”是非常明智的指标……它们为算法的性能提供了绝对界限。这并不意味着我们不能谈论其他指标。

编辑以回复您更新的问题：

该问题要求您证明 Omega(lg n) 是最坏*情况*行为的*下限。*换句话说，当这个算法对一类输入做尽可能多的工作时，它所做的工作量增长至少与 (lg n) 一样快，渐近。所以你的步骤如下：（1）确定算法的最坏情况；(2) 在属于最坏情况的输入上找到算法运行时间的下限。

 *这是寻找线性搜索的方式的说明：

在线性搜索的最坏情况下，目标项目不在列表中，必须检查列表中的所有项目以确定这一点。因此，该算法的最坏情况复杂度的下限为 O(n)。

需要注意的重要一点：对于许多算法，大多数情况下的复杂性将受到一组通用函数的上下*限制。*Theta 必然适用是很常见的。因此，无论如何，您可能不会得到与 O 不同的答案。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-14T21:58:34.220

O 是上限（即最坏情况） Ω 是下限（即最好情况）

这个例子是说在 max-heapify 的最差输入中（我猜最差的输入是逆序输入），运行时间复杂度必须（至少）是 lg n 。因此 Ω (lg n) 因为它是执行复杂度的下限。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-03-14T21:56:00.427

实际上，您将 Bi​​g O 用于增长速度快于最坏情况复杂度的函数，而使用 Ω 表示增长速度比最坏情况复杂度更慢的函数。

所以在这里你被要求证明你的最坏情况复杂度比 lg(n) 差。*

# visual-studio-debugging - 如果我手动附加调试器，我可以使用 VS2010 在 IE10 中调试 Javascript，我可以自动化它吗？

> ID：15420850
> 
> 赞同：1
> 
> 时间：2013-03-14T21:49:31.130
> 
> 标签：visual-studio-debugging, internet-explorer-10

所以我刚刚更新到IE10。当我尝试调试我的网络应用程序的 javascript 时，我的断点都是带有小三角形的轮廓，并在工具提示中说：

> 当前不会命中断点。没有为此文档加载任何符号。

IE10 在我开始调试时启动，它会像 IE9 一样访问网站。如果在 VS 2010 中，我转到`Debug > Attach to Process...`并选择 iexplore.exe 进程，当我的 javascript 执行时，它将像 IE9 一样在断点处命中并停止，并且一切都很好，直到我杀死 IE10 并再次开始调试。

我确保在 IE10 中启用了 Javascript 调试，我在网上找到的任何“解决方案”都说要卸载/重新安装 VS2010/IE10，看看是否有帮助。我已经知道 VS2010 能够调试，只是没有正确连接调试器。我该如何解决这个问题，以便调试器正确附加并会遇到断点并表现出通常的行为？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-15T17:41:06.137

另一个[StackOverflow 帖子](https://stackoverflow.com/questions/13421797/vs2010-and-ie10-attaching-the-script-debugger-to-process-iexplore-exe-failed)建议安装 VS2012（任何版本），这应该可以解决您在使用 VS2010 在 IE10 中调试 JavaScript 时遇到的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-23T04:15:12.343

正如以利亚所提到的，关于这个问题还有另一个线程，这个答案可能在那里更合适，但是那个线程对我关闭了，因为我是一个新的海报。Corey 已经提到他目前无法安装 VS2012，但它可能对其他人有用。

更新到 IE10 后，我遇到了同样的问题。我已经安装了更新 1 的 VS2010 和 VS2012，并且没有一个推荐的修复程序（包括 msdbg2.dll 注册）对我有用。解决我的问题是重新应用 VS2012 的更新 1，选择“修复”选项。我现在可以再次在 VS2010 中调试 javascript。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-22T02:24:22.010

这可能会修复 IE10 中的 JavaScript 调试问题：

*   关闭 Internet Explorer
*   按开始并输入 CMD
*   在命令提示符下运行这些命令之一

32 位操作系统

```
regsvr32.exe "%ProgramFiles(x86)%\Common Files\Microsoft Shared\VS7Debug\msdbg2.dll" 
```

64 位操作系统

```
regsvr32.exe "%ProgramFiles%\Common Files\Microsoft Shared\VS7Debug\msdbg2.dll" 
```

# vba - 尝试将收到的 Outlook 电子邮件转换为富文本，并设置字体

> ID：15420853
> 
> 赞同：0
> 
> 时间：2013-03-14T21:49:39.050
> 
> 标签：vba, outlook

我有一个用户收到了系统生成的电子邮件，该电子邮件采用字体格式，这样当它在 Outlook 中呈现时，文本列不会对齐。我知道它需要什么字体，并且它已安装在用户的 PC 上。在groupwise中，他可以在收到消息后简单地更改字体，一切都很好。但是，Outlook（我们最近移至）中似乎没有此功能。

Microsoft 论坛上建议的修复方法是在收到消息时使用规则运行 VBA 脚本，并将消息转换为 RTF，然后设置字体。

这是我第一次涉足 VBA，虽然我过去做过几个小的 vb 脚本，所以我可能从一开始就偏离了基础，但这是我尝试过的。

```
Sub TestMessageRule(Message As Outlook.MailItem)
    Set Message.BodyFormat = 3
End Sub 
```

我收到一个错误，“无效使用属性”，所以我猜你不能那样改变它。通过使用以下代码向自己发送测试电子邮件，我得到了 1=Plain text、2=HTML 和 3=Rich Text：

```
Sub TestMessageRule(Message As Outlook.MailItem)
    MsgBox Message.BodyFormat
End Sub 
```

所以，问题是，我怎样才能正确更改 BodyFormat 属性，或者有什么更好的方法可以解决这个问题？

然后，如果您感觉特别好，也许您可​​以向我指出如何更改正文的字体。

谢谢，布莱恩

这是最终对我有用的方法：

```
Sub TestMessageRule(Message As Outlook.MailItem)
    Dim BodyString As String
    Message.BodyFormat = olFormatHTML
    BodyString = Replace(Message.HTMLBody, "<FONT SIZE=2>", "<FONT SIZE=3 FACE=""COMIC SANS MS"">")
    Message.HTMLBody = BodyString
    Message.Save
End Sub 
```

显然，Comic Sans MS 不是我想要的最终字体，但它非常适合测试。再次感谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T21:55:58.720

设置标量属性时不要使用“set”：

Message.BodyFormat = 3

话虽如此，只需读取纯文本 Body 属性并使用它来构造具有指定字体的适当格式的 HTML，然后设置 HTMLBody 属性。

# asp.net - 带有sql数据连接的ASP.NET中的嵌入式excel powerpivot工作簿？

> ID：15420854
> 
> 赞同：0
> 
> 时间：2013-03-14T21:49:41.673
> 
> 标签：asp.net, sql, excel, powerpivot

我知道可以在 asp.net 页面中嵌入带有 PowerPivot 图表的 excel 工作簿，但也可以在工作簿中从 SQL Server 加载数据，并且仍然可以在 ASP.NET 页面中查看 excel 工作簿。

我之前使用 SharePoint 2013 完成了此操作，但我不想依赖 SharePoint 安装，这可以在没有的情况下完成吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T23:18:54.490

SharePoint 2013 与 Office 应用程序集成。没有它，嵌入工作簿是困难的并且仅限于 ActiveX。默认组件是 OWC11，它可以加载 XML 或 HTML，但使用起来很痛苦。而且它不能直接加载 Excel 文件。

我这样做的方法是使用您的 SQL 数据在 C# 中生成工作簿，将其作为来自 URL 的二进制响应流提供，然后使用 SharePoint（您不想要）或将其保存为文件并将其上传到SkyDrive 并使用他们的查看器。或者您可以编写自己的 ActiveX 控件，但它只能在 IE 中工作。

# java - flyway mysqldump迁移

> ID：15420857
> 
> 赞同：3
> 
> 时间：2013-03-14T21:49:50.723
> 
> 标签：java, mysql, mysqldump, database-migration, flyway

我越了解 flyway 如何进行数据库迁移，我就越喜欢它。

我试图让 flyway 读取从 mysqldump -d 生成的迁移，但我偶然发现了一些奇怪的行为。

在主页上它说

> mysqldump 导出的 DDL 可以在 Flyway 迁移中原样使用。

我的经历有点不同。**如何将mysqldump生成的文件与flyway一起使用？**

* * *

**我在尝试什么：**

我尝试通过使用获取 DDL

```
mysqldump -h host --user=user -p -d --hex-blob databasename > V1__Basic.sql 
```

这确实有效，并给了我一个看起来像这样的文件（是的，它是来自 Activiti 的数据库方案 :)）：

```
-- MySQL dump 10.13  Distrib 5.5.28, for osx10.6 (i386)
--
-- Host: host    Database: database
-- ------------------------------------------------------
-- Server version   5.5.27-log

/*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
/*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
/*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */;
/*!40101 SET NAMES utf8 */;
/*!40103 SET @OLD_TIME_ZONE=@@TIME_ZONE */;
/*!40103 SET TIME_ZONE='+00:00' */;
/*!40014 SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0 */;
/*!40014 SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0 */;
/*!40101 SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='NO_AUTO_VALUE_ON_ZERO' */;
/*!40111 SET @OLD_SQL_NOTES=@@SQL_NOTES, SQL_NOTES=0 */;

--
-- Table structure for table `ACT_GE_BYTEARRAY`   
--

DROP TABLE IF EXISTS `ACT_GE_BYTEARRAY`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `ACT_GE_BYTEARRAY` (
  `ID_` varchar(64) COLLATE utf8_bin NOT NULL DEFAULT '',
  `REV_` int(11) DEFAULT NULL,
  `NAME_` varchar(255) COLLATE utf8_bin DEFAULT NULL,
  `DEPLOYMENT_ID_` varchar(64) COLLATE utf8_bin DEFAULT NULL,
  `BYTES_` longblob,
  `GENERATED_` tinyint(4) DEFAULT NULL,
  PRIMARY KEY (`ID_`),
  KEY `ACT_FK_BYTEARR_DEPL` (`DEPLOYMENT_ID_`),
  CONSTRAINT `ACT_FK_BYTEARR_DEPL` FOREIGN KEY (`DEPLOYMENT_ID_`) REFERENCES     `ACT_RE_DEPLOYMENT` (`ID_`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_bin;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `ACT_GE_PROPERTY`
--

DROP TABLE IF EXISTS `ACT_GE_PROPERTY`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */; 
```

等等。

我有 flyway 设置（简单的弹簧集成），它正在拾取文件。但是它什么也没做（不执行 sql）：

```
INFO  @ 14 Mar 2013 22:34:41,646 @ com.googlecode.flyway.core.command.DbMigrate - Current version of schema "PUBLIC": << Empty Schema >>
INFO  @ 14 Mar 2013 22:34:41,647 @ com.googlecode.flyway.core.command.DbMigrate - Migrating schema "PUBLIC" to version 1
DEBUG @ 14 Mar 2013 22:34:41,649 @ com.googlecode.flyway.core.command.DbMigrate - Successfully completed and committed migration of schema "PUBLIC" to version 1
DEBUG @ 14 Mar 2013 22:34:41,651 @ com.googlecode.flyway.core.command.DbMigrate - Finished migrating schema "PUBLIC" to version 1 (execution time 00:00.002s) 
```

但是，如果我在第一个 SQL 语句 ( `DROP TABLE`) 之前删除所有行，flyway 只会执行 drop 表并在之后停止。

```
DEBUG @ 14 Mar 2013 22:34:41,698 @ com.googlecode.flyway.core.dbsupport.SqlScript - Found statement at line 1: DROP TABLE IF EXISTS `ACT_GE_BYTEARRAY`
DEBUG @ 14 Mar 2013 22:34:41,698 @ com.googlecode.flyway.core.dbsupport.SqlScript - Executing SQL: DROP TABLE IF EXISTS `ACT_GE_BYTEARRAY`
DEBUG @ 14 Mar 2013 22:34:41,700 @ com.googlecode.flyway.core.command.DbMigrate - Successfully completed and committed migration of schema "PUBLIC" to version 1.1
DEBUG @ 14 Mar 2013 22:34:41,700 @ com.googlecode.flyway.core.command.DbMigrate - Finished migrating schema "PUBLIC" to version 1.1 (execution time 00:00.004s) 
```

如果我删除所有到飞行路线的东西`CREATE TABLE`不喜欢语法

```
ERROR @ 14 Mar 2013 22:45:01,270 @ com.googlecode.flyway.core.command.DbMigrate - Caused by org.h2.jdbc.JdbcSQLException: Syntax error in SQL statement "CREATE TABLE ""ACT_GE_BYTEARRAY"" (
  ""ID_"" VARCHAR(64) COLLATE[*] UTF8_BIN NOT NULL DEFAULT '', 
```

我怎样才能得到 mysqldump 的输出到 flyway 喜欢的东西？非常感谢你们！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T07:24:36.270

Flyway 的解析器是特定于数据库的。由于您尝试导入 H2，因此它会尝试解析 H2 语法而不是 mysql 语法。将其导入 mysql 数据库，你应该很高兴。

# angularjs - Angular - 基本控制器范围破坏代码

> ID：15420858
> 
> 赞同：0
> 
> 时间：2013-03-14T21:49:54.457
> 
> 标签：angularjs

我在 jsfiddle 上创建了一个基本的 Angular 应用程序。但是，每当我添加 a 时`ng-controller`，我的代码就会中断。知道它可能是什么吗？

[http://jsfiddle.net/up8pv/3/](http://jsfiddle.net/up8pv/3/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T22:06:01.600

我的行动：

1.  为模块添加名称并通过显式初始化它`angular.module()`
2.  确保这`RaffleCtrl`是正确的功能
3.  将 jsFiddle 类型更改为`No wrap - in <body>`

事实证明，这可以解决问题。我建议你调查这三个提示中的每一个，以确定邪恶的根源是什么:)

[http://jsfiddle.net/up8pv/5/](http://jsfiddle.net/up8pv/5/)

# android - 在另一个布局中包含布局填充视图

> ID：15420859
> 
> 赞同：1
> 
> 时间：2013-03-14T21:50:04.443
> 
> 标签：android, android-layout

我正在做一个布局。temp1 包含在 temp2 中。temp1 工作正常，但是当我将它包含在 temp2 中时。它填满了整个屏幕，因为 temp1 中的根设置为 fill_parent。在这种情况下可能有什么解决方案？

我想在 temp1 中心的一个小区域 temp2 中显示布局。

temp1.xml

```
<RelativeLayout android:layout_height="fill_parent"
                 android:layout_width="fill_parent">

</RelativeLayout> 
```

temp2.​​xml

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
                android:layout_width="match_parent"
                android:layout_height="match_parent">

    <RelativeLayout
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_centerInParent="true"
        android:id="@+id/relativeLayout">
    <include
            android:layout_width="match_parent"
            android:layout_height="match_parent"
            layout="@layout/temp1"/>
</RelativeLayout>

</RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T22:08:04.770

您可以覆盖`layout_*`您所包含的布局的根视图的字段，在这种情况下，它们会`RelativeLayout`覆盖`@layout/temp1`.

您可以使用边距，并将其调整为您想要的边框数量（`100dp`只是一个示例）：

```
<include
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:layout_margin="100dp"
        layout="@layout/temp1"/> 
```

或者你可以设置你想要的大小（`100dp`只是一个例子）：

```
<include
        android:layout_width="100dp"
        android:layout_height="100dp"
        layout="@layout/temp1"/> 
```

或者您可以只显示那里的内容（`temp1`目前没有任何内容）：

```
<include
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        layout="@layout/temp1"/> 
```

有关更多信息，请参阅[http://developer.android.com/training/improving-layouts/reusing-layouts.html](http://developer.android.com/training/improving-layouts/reusing-layouts.html)。

# r - 超过最大值百分比的日期

> ID：15420860
> 
> 赞同：2
> 
> 时间：2013-03-14T21:50:04.753
> 
> 标签：r

我有一个如下所示的数据框：

```
df <- data.frame(site=paste0('site', sort(rep(1:5, 20))),
                 date=as.Date(paste0(sample(1:28, 100, replace=T), '/', 
                                     sample(1:12, 100, replace=T), '/', 
                                     2013), 
                              '%d/%m/%Y'), 
                 count=rep(seq(1, 1000, length.out=20), 10)) 
```

对于每个站点，我需要 > 500 的最早日期。`count`换句话说，计数大于最大计数的 50% 的第一个日期。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-14T21:54:30.117

解决方案`plyr`。

如果您想要 count > 500 的第一个日期：

```
ddply(df, .(site), summarise, date=min(date[count>500])) 
```

如果您想要 count > 50%*max(count) 的第一个日期（对于每个站点）：

```
ddply(df, .(site), summarise, date=min(date[count>max(count)*0.5])) 
```

这里都给出相同的结果：

```
 site       date
1 site1 2013-01-15
2 site2 2013-02-04
3 site3 2013-03-13
4 site4 2013-02-04
5 site5 2013-01-07 
```

# ios - 如何在iOS中给定中心点和角度画线？

> ID：15420861
> 
> 赞同：7
> 
> 时间：2013-03-14T21:50:05.880
> 
> 标签：ios, objective-c, cocoa-touch, coordinates, quartz-graphics

这是一个 iOS 问题，因为我目前无法进行坐标几何。给定一个 CGPoint 作为线将通过的一个点和一个以弧度为单位的角度。如何绘制一条延伸到屏幕边界的线（无限线）？

我正在使用 Quartz2d 来执行此操作，并且用于创建线的 API 仅限于两个点作为输入。那么如何将一个点和角度转换为 iOS 设备边界上的两个点呢？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-14T22:06:10.243

这从简单的三角函数开始。您需要计算第二个点的 x 和 y 坐标。以 0,0 为原点，将直线向右视为 0 度，逆时针方向（有些人为逆时针方向），您可以：

```
double angle = ... // angle in radians
double newX = cos(angle);
double newY = sin(angle); 
```

这假定半径为 1。每次乘以所需的半径。选择一个大于屏幕的数字，例如 iPhone 为 480 或 iPad 为 1024（假设您想要点而不是像素）。

然后加上原点得到最终点。

假设你有`CGPoint start`、`double angle`和 一个长度，你的最后一点是：

```
double endX = cos(angle) * length + start.x;
double endY = sin(angle) * length + start.y;
CGPoint end = CGPointMake(endX, endY); 
```

如果终点不在屏幕上也没关系。

# php - MYSQL - 在 DATE_ADD 和 DATE_SUB 之间选择查询

> ID：15420862
> 
> 赞同：0
> 
> 时间：2013-03-14T21:50:17.733
> 
> 标签：php, mysql, date

我在我的 mysql 预订表中有一个预订，`bookings`如下所示：

```
start_date = 2013-03-04
end_date = 2013-03-08 
```

我想检查特定日期（在本例中为 2013 年 3 月 4 日）是否介于预订的开始日期和结束日期之间 - 但我想在开始日期上增加一天并从结束日期减去 1 天日期。

因此，我不想在 2013-03-04 和 2013-03-08 之间**搜索**，**而是**在 2013-03-05**和**2013-03-07**之间搜索**

下面的查询从结束日期减去 1 天，但将开始日期保留为 04。下面的搜索应该没有结果，但它仍然使用 04 作为开始日期，并给出了该预订的结果。它基本上是在 [04] [05] [06] [07] 之间搜索，什么时候应该做 [05] [06] [07]

```
$fd_query_params = array( 
    ':day' => '2013-03-04
);

$query = " 
    SELECT 
        *
    FROM 
        bookings as bb 
    WHERE 
        :day BETWEEN 
        DATE_ADD(bb.start_date, INTERVAL 1 DAY) 
        AND 
        DATE_SUB(bb.end_date, INTERVAL 1 DAY)
"; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T22:13:28.077

我自己不是 php 专家，但如果我注意到的更多，那么 :day 字符串周围只有一个引号。最好查看输出以验证 start_date 和 end_date 是什么

# file-io - 如何在 FORTRAN 程序运行时打开外部文件

> ID：15420863
> 
> 赞同：1
> 
> 时间：2013-03-14T21:50:22.260
> 
> 标签：file-io, fortran

我有一个执行数值积分的 FORTRAN 代码。所有计算的数据都写入外部文件 (data.out)。这是代码的简单草图

```
OPEN(UNIT=10,FILE='data.out')
DO i=1,n

........

WRITE(10,'(7(E22.16,1x))')a,b,c,d,e,f,g

........

ENDDO
CLOSE(10) 
```

程序持续运行很长时间（约 1.5 小时），直到数值积分完成。在执行期间，我想在 .out 文件中查看结果。但是，当我在 .exe 运行时尝试打开 .out 文件时，我收到以下消息：“文档 data.out 已被另一个应用程序使用，无法访问。” 那么，有没有办法在执行过程中打开 .out 文件呢？观察输出值对我来说很重要（它们不仅仅是上面示例中的 7 个），因此在屏幕输出中发送它们并不方便（显着降低了代码的速度）。提前谢谢了。

* * *

*** 编辑 ***

* * *

这是与上述情况非常相似的另一种情况。在这里，集成例程从输入文件读取初始条件并将输出写入另一个外部文件。下面我给出对应的代码骨架

```
 OPEN(UNIT=10,FILE='input.par',STATUS='UNKNOWN')
 2   READ(10,*,END=1) x_0,y_0

 !   INTEGRATION LOOP
     DO i=1,n
     ........
     ENDDO

     OPEN(UNIT=12,FILE='data.out')
     WRITE(12,'(7(E22.16,1x))')a,b,c,d,e,f,g

     GOTO 2

 1   CLOSE(10)
     CLOSE(12) 
```

因此，例程打开 UNIT 10 读取初始条件，执行积分，并在积分结束时将输出写入 UNIT 12。然后，它采用另一组初始条件并重复相同的过程，直到不再存在UNIT 10 中的初始条件。同样，我希望能够打开和监视 UNIT 12。我尝试了您的方法，但在这种情况下它不能正常工作。我可以随时打开 UNIT 12，但该例程不会在此处写入所有输出。事实上，它只写入最后一组初始条件的输出。有任何想法吗？我坚信对您的方法稍作修改就可以完成这项工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T22:38:46.213

除了将结果打印到屏幕上之外，您还可以在每次写入操作后关闭文件并在下一个集成周期中重新打开它以将新数据*附加*到其中。

```
program test
  implicit none

  integer :: ii

  ! Create emtpy file
  open(10, file='data.out', status='REPLACE', action='WRITE')
  close(10)

  do ii = 1, 100
    !...
    ! Reopen file, append new information and close it again.
    open(10, file='data.out', status='OLD', action='WRITE', position='APPEND')
    write(10,'(7(E23.16,1x))') 1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0
    close(10)
  end do

end program test 
```

编辑：主要思想是，在开始任何类型的循环之前，通过第一个 open 语句创建一个空文件：

```
 open(10, file='data.out', status='REPLACE', action='WRITE')
  close(10) 
```

然后，在循环内，您只需*附加*到该文件，以确保您不会替换已经存在的内容：

```
open(10, file='data.out', status='OLD', action='WRITE', position='APPEND')
write(10,'(7(E23.16,1x))') 1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0
close(10) 
```

请注意传递给`open`语句的参数的差异。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-14T22:15:59.780

执行此操作的合乎逻辑的方法是将输出回显到终端。默认情况下，这是第 6 单元。所以我会将您的输出更改为：

```
WRITE(6,'(7(E22.16,1x))')a,b,c,d,e,f,g
WRITE(10,'(7(E22.16,1x))')a,b,c,d,e,f,g 
```

试试看。它甚至可能起作用。

# charts - 如何在 JqPlot 中只有点而不是线

> ID：15420864
> 
> 赞同：5
> 
> 时间：2013-03-14T21:50:23.443
> 
> 标签：charts, jqplot

我是 JqPlot 的新手。是否可以仅绘制点而不连接它们。因为我不希望它是折线图。我只想要图表上的散点。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-15T02:59:48.723

设置`showLine`为`false`

```
seriesDefaults: {    
                  showLine:false
                } 
```

`showLine`使用属性，是否渲染线段

[**参考**](http://www.jqplot.com/docs/files/jqplot-core-js.html#Series.showLine)

# java - 哪个更快：“null == myObject”或“myObject == null”？

> ID：15420865
> 
> 赞同：2
> 
> 时间：2013-03-14T21:50:39.610
> 
> 标签：java, .net, null, operator-precedence, control-structure

在 Java 和 .Net 中，我听说使用 null first`if (null == myObject)`比使用 object first 更高效`if (myObject == null)`。虽然我认为这可能是真的，但我不确定并且想从 SO 用户那里知道。就个人而言，我认为如果先引用对象会更好读，但如果先使用 null 有任何性能提升，我会选择它。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-14T21:51:56.877

它们完全一样。如果有差异，任何编译器都会进行交换，因为绝对没有功能差异。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-14T22:09:12.023

令人惊讶的是，它们在 Java 中的编译方式不同：

```
if (myObject == null);
if (null == myObject); 
```

编译为

```
 8 aload_1
 9 ifnonnull 12 (+3)
12 aconst_null
13 aload_1
14 if_acmpne 17 (+3) 
```

（这是使用编译的`javac 1.6.0_24`。）

将对象引用放在第一个会产生两条指令，将第`null`一个放在三个指令中。在此基础上，`if (myObject == null)` *可能*会更快。

然而，正如 Thorbjørn Ravn Andersen 所指出的，当使用 JIT 编译器时，字节码指令的数量并没有多大意义，因为无论如何字节码都会在执行之前转换为本地代码。即使存在性能差异，我也怀疑它是否可以衡量。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-14T21:58:02.427

不能说Java，但如果有我会很惊讶，它是不同的。
在我写的 C# 示例中

```
void Main()
{
    object o = new object();

    if(null == o)
        Console.WriteLine("o is null");

    // to force a reload of the registers
    o = new object();

    if(o == null)
        Console.WriteLine("o is null");
} 
```

生成的 IL 代码是

```
IL_0000:  newobj      System.Object..ctor
IL_0005:  stloc.0     // o
IL_0006:  ldloc.0     // o
IL_0007:  brtrue.s    IL_0013
IL_0009:  ldstr       "o is null"
IL_000E:  call        System.Console.WriteLine
IL_0013:  newobj      System.Object..ctor
IL_0018:  stloc.0     // o
IL_0019:  ldloc.0     // o
IL_001A:  brtrue.s    IL_0026
IL_001C:  ldstr       "o is null"
IL_0021:  call        System.Console.WriteLine 
```

完全没有区别

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-03-14T21:52:10.670

我希望 Java 能够为两个版本生成完全相同的字节码（可能是[`ifnull`bytecode](http://en.wikipedia.org/wiki/Java_bytecode_instruction_listings)），因此请使用对您来说更好的读取方式。

# shell - 使用 cron 和脚本将带有计算机 IP 的文件保存在保管箱文件夹中

> ID：15420874
> 
> 赞同：0
> 
> 时间：2013-03-14T21:51:14.037
> 
> 标签：shell, cron

我想使用 Dropbox 来跟踪我电脑的 IP 地址。

我正在考虑`crond`每 5 分钟运行一次 shell 脚本，询问 icanhazip.com 我的 IP 地址是什么，然后编辑一个文件以获得该计算机的当前 IP。

所以我认为脚本会像这样

```
CurrentIP = curl -s http://icanhazip.com/
echo $CurrentIP > ~/Dropbox/ComputerIP 
```

然后我会在 crontab 中添加一个条目，告诉它每十分钟运行一次

```
*/5 * * * * UpdateIP.sh 
```

请注意，这是我的第一个 shell 脚本，所以我不知道我在做什么，并且会感谢任何关于如何更优雅地执行此操作的输入

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T13:36:08.013

最简单的方法是直接从 cron 运行命令：

```
*/5 * * * * /usr/bin/curl -s http://icanhazip.com/ > ~/Dropbox/ComputerIP 
```

（包括 curl 命令的正确完整路径）。

当然，如果您预计将来需要执行更复杂的任务，最好将其保留在脚本中，就像您已经做的那样。

# android - Android 切换按钮崩溃

> ID：15420877
> 
> 赞同：0
> 
> 时间：2013-03-14T21:51:25.533
> 
> 标签：android, audio, crash, playback, togglebutton

当检查切换按钮时，我正在尝试使声音在间隔中播放。单击切换按钮后，我的应用程序不会播放任何声音并崩溃。为什么？

**代码：**

```
 int bpm;
    double timetw;
    final Button plus = (Button) findViewById(R.id.tempop);
    final Button minus = (Button) findViewById(R.id.tempom);
    final TextView curbpm = (TextView) findViewById(R.id.curbpm);
    final ToggleButton metronomepp = (ToggleButton) findViewById (R.id.metronomepp);
    final MediaPlayer metronome = MediaPlayer.create(this, R.raw.beep);
    bpm=60;
    timetw=((60/bpm)-0.19)*10000;
    curbpm.setText("" + bpm);

    Log.i("Metronome1", ""+metronomepp.isChecked());

    metronomepp.setOnCheckedChangeListener(new CompoundButton.OnCheckedChangeListener() {
        @Override
        public void onCheckedChanged(CompoundButton buttonView, boolean isChecked) {
             while (metronomepp.isChecked()) {
                    metronomepp.postDelayed(new Runnable() {
                        @Override
                        public void run() {
                             Log.i("Metronome", "InWhile");
                             if (metronome.isPlaying()) {metronome.pause();}
                                metronome.seekTo(0);
                                metronome.setOnSeekCompleteListener(null);
                                metronome.start();
                                metronome.setOnCompletionListener(null)
                        }
                    }, (long) (timetw));
                }
        }
    }); 
```

**按下切换按钮后的 LogCat：**

```
03-14 22:54:17.094: D/dalvikvm(25418): GC_CONCURRENT freed 101K, 3% free 9518K/9735K, paused 3ms+3ms
03-14 22:54:18.019: D/dalvikvm(25418): GC_CONCURRENT freed 5K, 2% free 9923K/10055K, paused 2ms+2ms
03-14 22:54:19.744: D/dalvikvm(25418): GC_CONCURRENT freed 0K, 2% free 10312K/10439K, paused 1ms+1ms
03-14 22:54:23.039: D/dalvikvm(25418): GC_CONCURRENT freed 0K, 2% free 10759K/10887K, paused 1ms+1ms 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T08:22:14.877

我建议在这里使用[计时器](http://developer.android.com/reference/java/util/Timer.html)。使用`Timer.scheduleAtFixedRate(TimerTask task, long delay, long period)`，您可以安排任务以间隔（周期）运行。此外，您需要一个 TimerTask。只需创建一个扩展 TimerTask 的类并实现 run() 方法来播放节拍器声音。

给你一些代码示例：

1.  在您的活动中创建计时器：

    ```
    class MyActivity extends Activity {
        // In the variables declared for the class:
        private Timer timer = new Timer();
        private long timerTickGapMilliseconds = 1000L; // Change this to change how often the sound is played. 
    ```

2.  将 MetronomeTimerTask 实现为 Activity 类的子类：

    ```
    class MetronomeTimerTask extends TimerTask {
        @Override
        public void run() {
            // play the metronome sound, from your code.
        }
    } 
    ```

3.  启动或停止计时器 在问题中的代码中，替换 onCheckedChanged：

    ```
    public void onCheckedChanged(CompoundButton buttonView, boolean isChecked) {
        if (metronomepp.isChecked()) {
            timer.scheduleAtFixedRate(new MetronomeTimerTask(), 0, timerTickGapMilliSeconds);
        }
        else {
            timer.cancel();
        }
    } 
    ```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-14T22:26:15.257

您遇到的根本问题是您正在 UI 线程中执行长时间操作。onCheckedChanged 应该派生一个线程或 Async 类，它会发出滴答声，直到它停止。最好还是有一个线程来发出你从 onCheckedChanged 打开和关闭的滴答声。

@Torben-Kohlmeier 对您的问题的回答可能已经给出了实现这一目标的最佳方法，我对其进行了编辑以明确它如何适合您的代码。

# mysql - 显示 MySQL 中包含相同值的所有行（2 列过滤器）

> ID：15420878
> 
> 赞同：1
> 
> 时间：2013-03-14T21:51:26.783
> 
> 标签：mysql, database

我有一张这样的桌子

```
| c1 | c2 |
+----+----+
| a  | 2  |
| c  | 1  |
| c  | 2  |
| d  | 3  |
| a  | 2  |
| c  | 2  |
| c  | 4  |
| d  | 2  | 
```

我想从 c1 中选择具有相同 c2 的值。我试过这个

```
SELECT c2, GROUP_CONCAT(DISTINCT c1)
FROM table
group by c2; 
```

我得到了

```
| c2 | c1   |
+----+------+
| 1  | c    |
| 2  | a,c,d| <==
| 3  | d    |
| 4  | c    | 
```

如何选择仅显示在 c1 处具有超过 1 个值的行作为第 2 行？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-14T21:56:29.900

```
SELECT c2, GROUP_CONCAT(DISTINCT c1)
FROM table
group by c2 HAVING count(distinct c1)>1 
```

# ruby-on-rails - Mongoid present_of 嵌入文档并销毁嵌入

> ID：15420879
> 
> 赞同：2
> 
> 时间：2013-03-14T21:51:29.467
> 
> 标签：ruby-on-rails, validation, mongoid

我有一些 mongoid 文件：

```
class Firm
  include Mongoid::Document

  embeds_many :offices
  validates_presence_of :offices
end 
```

至少一个办公室必须在场。有用。然而，当“销毁”方法要求最新的*办公室*时，*公司*被保存但不再有效..

我可以使用这样的东西：

```
class Office
    embedded_in :firm
    before_destroy :check_for_latest

    def check_for_latest
       false if firm.offices.count == 1
    end
end 
```

但这不是好方法

有任何想法吗？谢谢！

# php - html表单动作中的php变量

> ID：15420883
> 
> 赞同：-1
> 
> 时间：2013-03-14T21:51:44.957
> 
> 标签：php, forms

我的表单中有以下操作：

```
<FORM METHOD="POST" ACTION="print.php?naam=<?=$naam;?>&postcodehuisnummer=<?=$postcodehuisnummer?>&fietskeuze=<?=$src?>&fietstype=<?=$fietskeuze?>&framemaat=<?=$frame?>&opties=<?=$opties?>&optieid=<?=$optieid?>&huurdatum=<?=$today?>&einddatum=<?=$Einddatum?>&aantaldagen=<?=$dagenprijs?>"> 
```

在`print.php`页面上，我尝试使用 POST 读取变量（也使用 GET 进行测试），但未发送变量。

在`print.php`我的屏幕上，我在地址 URL 栏中看到以下行：

```
http://localhost:8080/tablet1/print.php?naam=%3C?=$naam;?%3E&postcodehuisnummer=%3C?=$postcodehuisnummer;?%3E&fietskeuze=%3C?=$src;?%3E&fietstype=%3C?=$fietskeuze;?%3E&framemaat=%3C?=$frame;?%3E&opties=%3C?=$opties;?%3E&optieid=%3C?=$optieid;?%3E&huurdatum=%3C?=$today;?%3E&einddatum=%3C?=$Einddatum;?%3E&aantaldagen=%3C?=$dagenprijs;?%3E 
```

看起来它忽略了表单中的 php 标签/变量？如何更改它以获取传递给的变量`print.php`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T21:54:41.797

从您在 url 栏中看到的内容来看，我会说有两种可能性：

1.  短标签未启用。尝试用`<?=`;`<?php echo`替换标签
2.  您已将 php 放入 html 页面（无`.php`扩展名）。

当您向 url（`GET`方法）添加变量时，您需要通过`$_GET`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-14T21:54:24.440

这是因为`<?`and`<?=`被称为短开放标签，并不总是启用（参见[short_open_tag 指令](http://php.net/ini.core#ini.short-open-tag)）。

# poltergeist - 我可以用 execute_script 修补 phantomjs 浏览器 api 吗？

> ID：15420884
> 
> 赞同：2
> 
> 时间：2013-03-14T21:51:46.047
> 
> 标签：poltergeist

我试图测试一个禁用了一些原生 JavaScript 功能的应用程序，例如 querySelector ...

所以我认为这可能会在致电访问之前起作用：

```
page.execute_script("document.querySelector = null") 
```

但它不起作用，关于我如何实现这一目标的任何想法？

干杯约翰

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T23:11:29.003

看看[`:extensions`选项](https://github.com/jonleighton/poltergeist#customization)。这允许您定义一个预加载到浏览器中的 JS 文件。

# python - 在读取 CSV 之前检查文件第一行的巧妙方法

> ID：15420886
> 
> 赞同：0
> 
> 时间：2013-03-14T21:51:54.203
> 
> 标签：python, csv, io

我正在寻找一种聪明的方法来检查文件的第一行，然后再将其作为 csv 文件读取。我想检查是否有一条`# coding: xxx`线，以便我可以相应地解码读取的数据。但如果没有这样的行，第一行可能已经包含一个数据集。寻求对我来说似乎如此残酷，我希望有一种巧妙的方法来做到这一点。

```
import re
import csv
fl = open(filename)
line = fl.readline()
coding = re.match('^#\s*coding\s*(:|=|:=)\s*([\w\d\-_]+)\s*$', line)
fl.seek(0)

reader = csv.reader(fl)
# ... 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-14T22:03:49.503

我认为您当前的方法没有任何问题，但这里有一个您可能会觉得更可取的替代方法：

```
import re
import csv
import itertools

line = next(f1)
coding = re.match('^#\s*coding\s*(:|=|:=)\s*([\w\d\-_]+)\s*$', line)
reader = csv.reader(itertools.chain([line], f1)) 
```

从您的问题或您发布的代码中不清楚，但如果您不想在正则表达式匹配的情况下包含第一行，您可以执行以下操作：

```
reader = csv.reader(f1 if coding else itertools.chain([line], f1)) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-14T22:05:43.230

第一行会是这样吗？

```
# coding: xxx, some other "field", and maybe another field 
```

如果没有，您可以只阅读第一行，查找逗号，如果没有找到逗号，请尝试解释编码，否则将其（以及其他每一行）传递给`csv.reader()`?

# ios - 不知道为什么我的 loadmatcheswithmatchdata 不起作用

> ID：15420889
> 
> 赞同：0
> 
> 时间：2013-03-14T21:52:04.327
> 
> 标签：ios, objective-c, game-center, gamekit

我正在创建一个公共方法来从我的 gamecenterhelper.m 返回我的所有比赛

我有这个：

```
+(NSArray *)retrieveMatchesWithMatchData {
    __block NSArray *myMatches = nil;
    [GKTurnBasedMatch loadMatchesWithCompletionHandler:^(NSArray *matches, NSError *error) {
        if (error) {
            NSLog(@"There was an error loading matches");
        }
        else {
            myMatches = matches;
        }
    }];
    return myMatches;
} 
```

但是当我调用它时它返回 null，即使我有活动的匹配项。调用方法如下所示：

```
NSLog(@"My matches: %@",[GameCenterHelper retrieveMatchesWithMatchData]); 
```

谢谢你的时间！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T22:01:04.457

这就是块的本质。您的块是异步执行的。您无法同步加载 Game Center 比赛。让我们让它成为一个实例方法：

```
-(void)retrieveMatchesWithMatchData {
    [GKTurnBasedMatch loadMatchesWithCompletionHandler:^(NSArray *matches, NSError *error) {
        if (error) {
            NSLog(@"There was an error loading matches");
        }
        else {
            [self matchesLoaded:matches];
        }
    }];
} 
```

然后你用这个方法处理匹配：

```
-(void)matchesLoaded:(NSArray *)matches {
    //do something with your matches
} 
```

编辑：

有一种简单的方法可以做你想做的事。您可以使用 Apple 的标准视图控制器来显示当前匹配项：

```
GKMatchRequest *request = [[GKMatchRequest alloc] init]; 
request.minPlayers = minPlayers;     
request.maxPlayers = maxPlayers;

GKTurnBasedMatchmakerViewController *mmvc = 
[[GKTurnBasedMatchmakerViewController alloc] 
 initWithMatchRequest:request];
mmvc.turnBasedMatchmakerDelegate = self;
mmvc.showExistingMatches = YES;
[self presentViewController:mmvc animated:NO completion:nil]; 
```

# c++ - 头文件并包含最佳实践

> ID：15420891
> 
> 赞同：6
> 
> 时间：2013-03-14T21:52:17.797
> 
> 标签：c++, class, header, include

我有一个关于头文件、包含语句和良好编码风格的快速问题。假设我有 2 个具有关联源文件和头文件的类，然后是 main() 所在的最终源文件。

在 Foo.hpp 我有以下语句：

```
#include <string>
#include <iostream>
#include <exception> 
```

现在有了 Bar.hpp 我有以下陈述：

```
#include "Foo.hpp"
#include <string> 
```

最后与 Myprogram.cpp 我有以下陈述：

```
#include "Bar.hpp"
#include <string>
#include <iostream>
#include <exception> 
```

我知道 Myprogram.cpp 和 Bar.hpp 中的 <> 中的包含语句对于程序编译和运行来说不是必需的，但是最佳实践或正确的做事方式是什么？是否有任何理由不在每个文件中明确包含必要的头文件？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-14T21:56:00.843

您*应该*在每个需要它们的文件中包含所有必要的文件。如果`MyProgram.cpp`需要`string`，请包含它，而不是依赖它被`Bar.hpp`. 不能保证 2 周后`Bar.hpp`仍会包含它，然后您将遇到编译器错误。

请注意**必要**的- 即确保您确实需要一个包含，当一个前向声明甚至完全忽略它时会这样做。

另外，请注意，某些系统标头可能包含其他标头 - 除了少数例外，没有要求。因此，如果您需要两者`<iostream>`并`<string>`包含两者，即使您只能使用其中之一进行编译。

包含出现的顺序（系统包含与用户包含）取决于您遵循的编码标准 - 一致性比选择本身更重要。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-14T21:57:14.757

在每个文件中包含您需要的所有内容，**但不要包含您不需要的任何文件**。通常，包含文件的工作是确保它没有被包含两次，使用预编译器标志等......

例如，如果需要`Foo.cpp`，但不需要`Foo.h`，则将其包含在`Foo.cpp`not in 中`Foo.h`。如果两者都需要，则两者都包含。

切线，作为最佳实践，永远不要`using`在头文件中使用指令。如果需要，可以`using`在实现文件 (.cpp) 中使用指令。

# c# - 父类更改时如何更新子类？

> ID：15420896
> 
> 赞同：0
> 
> 时间：2013-03-14T21:52:49.133
> 
> 标签：c#, inheritance, parent-child

我有点麻烦弄清楚这一点。

我的代码结构如下：

```
public class ParentClass
{
    private double p_num;

    public ParentClass()
    {
    }

    public void AddSomething(double num)
    {
        System.Console.WriteLine(ParentNum + num);
    }

    public double ParentNum
    {
        set { p_num = value; }
        get { return p_num; }
    }
}

public class ChildClass : ParentClass
{
    private double c_num;

    public ChildClass()
    {

    }

    public void AddSomething()
    {
        base.AddSomething(ChildNum);
    }

    public double ChildNum
    {
        set { c_num = value; }
        get { return c_num; }
    }
}

public class Test
{
    public static void Main()
    {
        ParentClass p = new ParentClass();
        ChildClass c = new ChildClass();
        c.ChildNum = 8.0;
        p.ParentNum = 5.0;
        c.AddSomething();
    }
} 
```

这怎么会打印 8.0 而不是 13.0？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-14T21:56:02.970

因为`ChildClass`继承自`ParentClass`并不意味着每个实例都`ChildClass`继承一个实例的属性`ParentClass`。它们是单独的对象。

用现实世界的类比，如果这是真的，如果一个母亲有疤痕，她所有的孩子都会得到同样的疤痕。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-14T21:56:10.463

```
 ParentClass p = new ParentClass();
    ChildClass c = new ChildClass();
    c.ChildNum = 8.0;
    p.ParentNum = 5.0;
    c.AddSomething(); 
```

`p`和`c`这里没有共同点！它们只是 2 个独立的对象。

检查此以使其更清楚：

```
ChildClass c = new ChildClass();
c.ChildNum = 8.0;
c.ParentNum = 5.0;
c.AddSomething(); 
```

这将返回 13。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-14T21:56:09.213

`p`和`c`是两个不同的对象。调用`c.AddSomething()`时，值为`c.ParentNum`默认值`0.0`。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-14T21:58:01.260

如果您将 Parent.p_num 声明为静态，它将起作用：

```
private static double p_num; 
```

但我不确定这是否是你的意图。你的意思是让 p_num 在类的所有实例中共享吗？

顺便说一句，你的类中有很多不必要的代码。这将做：

```
public class ParentClass
{
    public void AddSomething(double num) {
        System.Console.WriteLine(ParentNum + num);
    }

    public double ParentNum { get; set; }
}

public class ChildClass : ParentClass
{
    public void AddSomething() {
        base.AddSomething(ChildNum);
    }

    public double ChildNum { get; set; }
} 
```

原因：

*   无需指定默认构造函数。
*   使用自动属性而不是支持字段

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-14T21:56:34.347

因为您正在调用`AddSomething`您的子类，这是一个完全独立的实例`ParentClass`。`ChildClass`是 的子类`ParentClass`，但这并不意味着它们都指向同一个`ParentClass`. 你基本上有两个对象，你只是在其中一个上调用一个操作。

```
public class Test
{
    public static void Main()
    {
        ChildClass c = new ChildClass();
        c.ChildNum = 8.0;
        c.ParentNum = 5.0;
        c.AddSomething();
    }
} 
```

会给你想要的结果

# wordpress - Wordpress 中的反向导航菜单

> ID：15420899
> 
> 赞同：0
> 
> 时间：2013-03-14T21:52:57.183
> 
> 标签：wordpress, navigation

我的导航菜单反向显示。我认为这是一个css问题，但我找不到问题。请帮助： [http ://www.jamonit.org/dev/](http://www.jamonit.org/dev/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T21:56:21.473

将此添加到您的CSS：

```
#menu-header-nav-1 li {
    float: left;
}

#menu-header-nav-1 {
    float: right;
    width: auto;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-05-09T17:25:45.940

我在构建的网站上遇到了同样的问题。对我有用的是使用“文本对齐”而不是“浮动”将 li 项目向右移动。“浮动”改变顺序，“文本对齐”不会。

```
// Div around the #main-menu div that floats the whole list to the right
#menu-wrapper{
     float: right;
}

//Div containing your wp menu UL
#main-menu{
   text-align: right;
} 
```

# iphone - iPhone标题相机，imageview不显示拍摄的照片

> ID：15420901
> 
> 赞同：0
> 
> 时间：2013-03-14T21:52:58.727
> 
> 标签：iphone, ios6, camera, picker

我被要求制作一个应用程序，为他们的猫提供随机字幕。我有 2 个问题，我一步一步按照教程进行操作，但没有任何效果。1\. 拍摄或选择图片时，它不会显示在 UIImageView 中，故事板中的每件事都喜欢我只是不明白。另外，我制作了一个 IBAction，它在其中生成随机标题，并且在按下按钮时工作正常，无论如何，当拍摄或选择图片时，标题会自动显示吗？这是我在 .M 文件中的代码。我是制作应用程序的初学者。

```
#import "Generator.h"

@interface Generator ()

@end

@implementation Generator

-(IBAction)TakePhoto{
    picker = [[UIImagePickerController alloc] init];
    picker.delegate = self;
    [picker setSourceType:UIImagePickerControllerSourceTypeCamera];
    [self presentViewController:picker animated:YES completion:NULL];

}
-(IBAction)ChooseExisting{
    picker2 = [[UIImagePickerController alloc] init];
    picker2.delegate = self;
    [picker2 setSourceType:UIImagePickerControllerSourceTypePhotoLibrary];
    [self presentViewController:picker2 animated:YES completion:NULL];

}
-(void) imagePickerController:(UIImagePickerController *)picker didFinishPickingMediaWithInfo:(NSDictionary *)info {
    image = [info objectForKey:UIImagePickerControllerOriginalImage];
    [self dismissViewControllerAnimated:YES completion:NULL];
}

-(void) imagePickerControllerDidCancel:(UIImagePickerController *)picker {
    [self dismissViewControllerAnimated:YES completion:NULL];
}

-(IBAction)Back{
    [self dismissViewControllerAnimated:YES completion:NULL];
}

-(IBAction)random {
    int text = rand() % 10;
    switch (text) {
        case 0:
            textview.text = @"I'd Say About Average";
            break;
        case 1:
            textview.text = @"Happy but Hideous";
            break;
        case 2:
            textview.text = @"Furrific";
            break;
        case 3:
            textview.text = @"Cuddly";
            break;
        case 4:
            textview.text = @"Abby Normal";
            break;
        case 5:
            textview.text = @"Purrty";
            break;
        case 6:
            textview.text = @"Yuck";
            break;
        case 7:
            textview.text = @"Glowing";
            break;
        case 8:
            textview.text = @"AWWWWWW";
            break;
        case 9:
            textview.text = @"The Cutest";
            break;
        default:
            break;
    }
}

- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
    if (self) {
        // Custom initialization
    }
    return self;
}

- (void)viewDidLoad
{

    [super viewDidLoad];
    // Do any additional setup after loading the view.
}

- (void)didReceiveMemoryWarning
{
    [super didReceiveMemoryWarning];
    // Dispose of any resources that can be recreated.
}

@end 
```

任何帮助都可以。我的 SDK 是 iOS 6.1

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T22:02:32.570

图像是自动发布的。在超出范围之前设置您的 imageView，或保留它。如果你把它连接到任何东西上，它应该留在记忆中并显示出来。

# google-apps-script - 如何使用脚本编辑器在谷歌电子表格中设置单元格的值？

> ID：15420911
> 
> 赞同：0
> 
> 时间：2013-03-14T21:53:40.783
> 
> 标签：google-apps-script, google-sheets

此代码不起作用，我无法从脚本编辑器设置单个单元格值.. 这是下面的代码..

```
function everyyHour() {
  var sheet = SpreadsheetApp.getActiveSpreadsheet();
  var rows = sheet.getDataRange();
  var numRows = rows.getNumRows();
  var values = rows.getValues();
  //var i = values[1];
  for (var i = 0; i <= numRows - 1; i++) {
    values[i][10] = 0;
  }
} 
```

第 10 列未设置为值 0

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-05T14:44:35.203

您的脚本正在更改`values`使用电子表格中的数据填充的数组，但它从未将其写回工作表。这是需要的单独操作。

```
function everyyHour() {
  var sheet = SpreadsheetApp.getActiveSheet();
  var rows = sheet.getDataRange();
  // var numRows = rows.getNumRows();  // I wish they'd never put this in the example.
  var values = rows.getValues();
  //var i = values[1];
  for (var i = 0; i < values.length; i++) {
    values[i][10] = 0;
  }
  rows.setValues(values);  // Write the results back to the spreadsheet
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T00:21:43.217

我想你想要：

```
var sheet = SpreadsheetApp.getActiveSpreadsheet().getActiveSheet(); 
```

# ruby-on-rails - Postgres + Heroku SSL SYSCALL 错误

> ID：15420922
> 
> 赞同：1
> 
> 时间：2013-03-14T21:54:25.377
> 
> 标签：ruby-on-rails, postgresql, heroku

有时，我托管在 Heroku 上的 Rails 应用程序会出现故障，我不确定发生了什么。有时可能会提前发生许多请求超时错误。然后我得到这个错误：有没有人知道可能发生了什么或者我如何进一步研究这个问题？

```
NilClass# (PG::Error) "SSL SYSCALL error: EOF detected\n"

/app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.12/lib/active_record/connection_adapters/postgresql_adapter.rb:294:in `exec'/app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.12/lib/active_record/connection_adapters/postgresql_adapter.rb:294:in `dealloc'
/app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.12/lib/active_record/connection_adapters/postgresql_adapter.rb:278:in `block in clear'
/app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.12/lib/active_record/connection_adapters/postgresql_adapter.rb:277:in `each_value'
/app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.12/lib/active_record/connection_adapters/postgresql_adapter.rb:277:in `clear'
/app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.12/lib/active_record/connection_adapters/postgresql_adapter.rb:339:in `clear_cache!'
/app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.12/lib/active_record/connection_adapters/postgresql_adapter.rb:352:in `reconnect!'
/app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.12/lib/active_record/connection_adapters/abstract_adapter.rb:219:in `verify!'
/app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.12/lib/active_record/connection_adapters/abstract/connection_pool.rb:333:in `block in checkout_and_verify'
/app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.12/lib/active_support/callbacks.rb:403:in `_run__2596940609290925681__checkout__3309272650293367200__callbacks'
/app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.12/lib/active_support/callbacks.rb:405:in `__run_callback'
/app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.12/lib/active_support/callbacks.rb:385:in `_run_checkout_callbacks'
/app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.12/lib/active_support/callbacks.rb:81:in `run_callbacks'
/app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.12/lib/active_record/connection_adapters/abstract/connection_pool.rb:332:in `checkout_and_verify'
/app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.12/lib/active_record/connection_adapters/abstract/connection_pool.rb:253:in `block (2 levels) in checkout'
/app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.12/lib/active_record/connection_adapters/abstract/connection_pool.rb:242:in `loop'
/app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.12/lib/active_record/connection_adapters/abstract/connection_pool.rb:242:in `block in checkout'
/usr/local/lib/ruby/1.9.1/monitor.rb:201:in `mon_synchronize'
/app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.12/lib/active_record/connection_adapters/abstract/connection_pool.rb:239:in `checkout'
/app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.12/lib/active_record/connection_adapters/abstract/connection_pool.rb:102:in `block in connection'
/usr/local/lib/ruby/1.9.1/monitor.rb:201:in `mon_synchronize'
/app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.12/lib/active_record/connection_adapters/abstract/connection_pool.rb:101:in `connection'
/app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.12/lib/active_record/connection_adapters/abstract/connection_pool.rb:410:in `retrieve_connection'
/app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.12/lib/active_record/connection_adapters/abstract/connection_specification.rb:171:in `retrieve_connection'
/app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.12/lib/active_record/connection_adapters/abstract/connection_specification.rb:145:in `connection'
/app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.12/lib/active_record/query_cache.rb:61:in `call'
/app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.12/lib/active_record/connection_adapters/abstract/connection_pool.rb:479:in `call'
/app/vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.12/lib/action_dispatch/middleware/callbacks.rb:28:in `block in call'
/app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.12/lib/active_support/callbacks.rb:405:in `_run__1965518221808316025__call__3309272650293367200__callbacks'
/app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.12/lib/active_support/callbacks.rb:405:in `__run_callback'
/app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.12/lib/active_support/callbacks.rb:385:in `_run_call_callbacks'
/app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.12/lib/active_support/callbacks.rb:81:in `run_callbacks'
/app/vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.12/lib/action_dispatch/middleware/callbacks.rb:27:in `call'
/app/vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.12/lib/action_dispatch/middleware/remote_ip.rb:31:in `call'
/app/vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.12/lib/action_dispatch/middleware/debug_exceptions.rb:16:in `call'
/app/vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.12/lib/action_dispatch/middleware/show_exceptions.rb:56:in `call'
/app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.12/lib/rails/rack/logger.rb:32:in `call_app'
/app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.12/lib/rails/rack/logger.rb:16:in `block in call'
/app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.12/lib/active_support/tagged_logging.rb:22:in `tagged'
/app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.12/lib/rails/rack/logger.rb:16:in `call'
/app/vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.12/lib/action_dispatch/middleware/request_id.rb:22:in `call'
/app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.5/lib/rack/methodoverride.rb:21:in `call'
/app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.5/lib/rack/runtime.rb:17:in `call'
/app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.12/lib/active_support/cache/strategy/local_cache.rb:72:in `call'
/app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.5/lib/rack/lock.rb:15:in `call'
/app/vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.12/lib/action_dispatch/middleware/static.rb:62:in `call'
/app/vendor/bundle/ruby/1.9.1/gems/rack-cache-1.2/lib/rack/cache/context.rb:136:in `forward'
/app/vendor/bundle/ruby/1.9.1/gems/rack-cache-1.2/lib/rack/cache/context.rb:245:in `fetch'
/app/vendor/bundle/ruby/1.9.1/gems/rack-cache-1.2/lib/rack/cache/context.rb:185:in `lookup'
/app/vendor/bundle/ruby/1.9.1/gems/rack-cache-1.2/lib/rack/cache/context.rb:66:in `call!'
/app/vendor/bundle/ruby/1.9.1/gems/rack-cache-1.2/lib/rack/cache/context.rb:51:in `call'
/app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.12/lib/rails/engine.rb:479:in `call'
/app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.12/lib/rails/application.rb:223:in `call'
/app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.12/lib/rails/railtie/configurable.rb:30:in `method_missing'
/app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.5/lib/rack/static.rb:119:in `call'
/app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.5/lib/rack/content_length.rb:14:in `call'
/app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.12/lib/rails/rack/log_tailer.rb:17:in `call'
/app/vendor/bundle/ruby/1.9.1/gems/thin-1.5.0/lib/thin/connection.rb:81:in `block in pre_process'
/app/vendor/bundle/ruby/1.9.1/gems/thin-1.5.0/lib/thin/connection.rb:79:in `catch'
/app/vendor/bundle/ruby/1.9.1/gems/thin-1.5.0/lib/thin/connection.rb:79:in `pre_process'
/app/vendor/bundle/ruby/1.9.1/gems/thin-1.5.0/lib/thin/connection.rb:54:in `process'
/app/vendor/bundle/ruby/1.9.1/gems/thin-1.5.0/lib/thin/connection.rb:39:in `receive_data'
/app/vendor/bundle/ruby/1.9.1/gems/eventmachine-1.0.0/lib/eventmachine.rb:187:in `run_machine'
/app/vendor/bundle/ruby/1.9.1/gems/eventmachine-1.0.0/lib/eventmachine.rb:187:in `run'
/app/vendor/bundle/ruby/1.9.1/gems/thin-1.5.0/lib/thin/backends/base.rb:63:in `start'
/app/vendor/bundle/ruby/1.9.1/gems/thin-1.5.0/lib/thin/server.rb:159:in `start'
/app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.5/lib/rack/handler/thin.rb:13:in `run'
/app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.5/lib/rack/server.rb:268:in `start'
/app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.12/lib/rails/commands/server.rb:70:in `start'
/app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.12/lib/rails/commands.rb:55:in `block in <top (required)>'
/app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.12/lib/rails/commands.rb:50:in `tap'
/app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.12/lib/rails/commands.rb:50:in `<top (required)>'
script/rails:6:in `require'
script/rails:6:in `<main>' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T01:45:43.073

以下链接可能是一个起点：

[https://devcenter.heroku.com/articles/postgres-logs-errors#pgerror-ssl-syscall-error-eof-detected](https://devcenter.heroku.com/articles/postgres-logs-errors#pgerror-ssl-syscall-error-eof-detected)

特别是以下摘录：

> 这些错误表明客户端违反了有线协议。发生这种情况的原因有两个：
> 
> *   Postgres 连接在多个进程或线程之间共享。典型的违规者是 Resque 工人或独角兽。请务必在 fork 或 thread 初始化后正确建立 PG 连接以解决此问题。
>     
>     
> *   突然的客户端（应用程序端）断开连接。发生这种情况的原因有很多，从您的应用程序崩溃到暂时的网络可用性。当您的应用程序尝试再次对 postgres 发出查询时，连接就消失了，导致崩溃。当 Heroku 检测到崩溃时，我们迁移杀死该测功机并启动一个新的测功机，从而重新建立连接。

我看到了类似的问题，虽然上述内容很有帮助，但我希望找到一种方法来实际解决问题（如果您无法阻止客户端崩溃服务器，这似乎不是最佳选择）。我已经向 Heroku 提交了一张票，所以如果我发现任何进一步的信息，我会建议...

更新：这是另一个可能相关的链接：[https](https://github.com/rails/rails/issues/9421) ://github.com/rails/rails/issues/9421 。

# php - 压缩文件夹的内容 php，而不是整个文件夹

> ID：15420928
> 
> 赞同：0
> 
> 时间：2013-03-14T21:54:41.543
> 
> 标签：php, zip, ziparchive

我正在寻找一种压缩文件夹内容的解决方案，包括文件夹中的所有子文件夹，**但不包括主文件夹本身**。

我从这个函数开始，它将整个文件夹添加到 zip 存档中

```
function addFolderToZip($dir, $zipArchive){
    if (is_dir($dir)) {
        if ($dh = opendir($dir)) {

            //Add the directory
            $zipArchive->addEmptyDir($dir);

            // Loop through all the files
            while (($file = readdir($dh)) !== false) {

                //If it's a folder, run the function again!
                if(!is_file($dir . $file)){
                    // Skip parent and root directories
                    if( ($file !== ".") && ($file !== "..")){
                        addFolderToZip($dir . $file . "/", $zipArchive);
                    }

                }else{
                    // Add the files
                    $zipArchive->addFile($dir . $file);

                }
            }
        }
    }
} 
```

但我看不到如何将函数更改为（也许使用第三个参数？）

```
$z = new ZipArchive();
$z->open("zips/new.zip", ZIPARCHIVE::CREATE);
addFolderToZip("unzipped/",$z);
$z->close(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T23:01:39.860

我知道了，我创建了一个参数 $localpath，设置为“”：

```
function add_folder_in_path($folder_path,$local_path,$z)
{
    $dh=opendir($folder_path);
    while (($file = readdir($dh)) !== false) 
     {
        if( ($file !== ".") && ($file !== ".."))
        {
        if (is_file($folder_path.$file))
            {

                    $z->addFile($folder_path.$file,$local_path.$file);
            }
        else
            {
                add_folder_in_path($folder_path.$file."/",$local_path.$file."/",$z);
            }
        }

     }
} 
```

我是这样称呼它的

```
$z = new ZipArchive();
$z->open("zipped/new.zip", ZIPARCHIVE::CREATE);
echo "<br>";
add_folder_in_path("myzips/","",$z);
$z->close(); 
```

# javascript - 使用 JS 在 Angular 中为删除按钮创建确认警报

> ID：15420935
> 
> 赞同：19
> 
> 时间：2013-03-14T21:55:07.417
> 
> 标签：javascript, angularjs, confirmation

我有一个带有删除按钮的表单，我想创建一个确认框，在单击删除按钮时弹出。删除按钮当前有效。我在javascript中尝试了几件事，但没有运气。我正在使用角。

这是最好的方法吗？

另外，有没有人知道这方面的任何例子，我还没有找到任何工作。

```
$(document).ready(function(){
  $("form").validate();
  $(".radius small success button").ConfirmDialog('Are you sure?');
}); 
```

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2014-05-15T14:22:45.930

似乎 AngularJS 指令对于解决这个问题有点过头了。除非您需要为“confirm()”函数添加一些自定义功能，否则直接使用 javascript 似乎更容易。

```
if (confirm('Are you sure you want to delete this?')) {
     // TODO:  Do something here if the answer is "Ok".
} 
```

希望这有帮助，干杯

> **更新**：实际上，对于 Angular，使用 $window.confirm 会更好，因为这将允许您使用 Karma/Jasmine 进行测试。

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2013-11-12T13:16:40.630

[这](https://gist.github.com/asafge/7430497)是另一种方法。基本上，它是一个指令，用于获取您要显示的警告字符串，以及在用户接受时调用的函数。使用示例：

```
<button type="button" ng-really-message="Are you sure?"
ng-really-click="delete()">Delete</button> 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2013-03-14T22:25:47.103

这就是我们处理“确认对话框”的方式（使用引导程序）

标记

```
<div class="alert alert-block alert-error notification fade in" data-ng-show="displayLocationDeletePopup">
    <h6>Are you sure you want to delete this location?</h6>
    <div class="form-controls-alert">
        <a href="" class="btn" data-ng-click="showDeleteLocationPopup(false)">No</a>
        <a href="" class="btn btn-danger" data-ng-click="deleteVendorLocation(locationId)">Yes</a>
    </div>
</div><!-- end alert --> 
```

在控制器加载时将模型设置为 false 以默认隐藏`ng-show`

```
$scope.displayLocationDeletePopup = false; 
```

单击显示弹出窗口的事件时，调用函数/传递模型

```
<i class="icon-remove" data-ng-click="showDeleteLocationPopup(true, location)"></i> 
```

在控制器中：

```
$scope.showDeleteLocationPopup = function(options, id) {
    if (options === true) {
        $scope.displayLocationDeletePopup = true;
    } else {
        $scope.displayLocationDeletePopup = false;
    }
    $scope.locationId = id;
}; 
```

根据上面 html 中的锚点，可以关闭弹出窗口或运行函数

```
$scope.deleteVendorLocation = function (storeLocation) {
   // Code to run on confirmation            
}; 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2016-07-01T11:49:00.553

```
var r = confirm("Are you sure you want to Permanently delete this order?");
if (r == true) {
    (OK button click) Write the function here.....
} else {
    (Cancle button click) Write the function here.....
} 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2017-08-09T06:48:29.317

将删除选项放在每条记录的右侧，单击删除选项后，记录应从详细信息和 JSON 数组中删除。

# c# - Winforms 中的所有者表单

> ID：15420939
> 
> 赞同：2
> 
> 时间：2013-03-14T21:55:22.863
> 
> 标签：c#, .net, winforms

假设您有两种形式：FormA 和 FormB..

在 FormA 中，我有一些属性。FormA 创建 FormB 并设置 owner 属性。例如：

```
public FormA() 
{
    FormB = new FormB(){Owner = this};
} 
```

现在，在 FormB 中，如果我想访问我在 FormA 上声明的属性。为什么我在写的时候看不到它们：

```
Owner. // here I need to see FormA properties... 
```

为什么它不能这样工作？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-14T21:56:44.627

尝试这个：

```
var forma = Owner as FormA;
forma.Stuff = otherstuff; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-14T21:59:25.467

由于继承和多态性，您看不到。

.NET 中的表单继承自名为 Form 的基类。你FormA是一个派生自Form的类，FormB也是。

现在，Form 引用了 Owner 表单，

```
public Form Owner { get; } 
```

您为其分配了 FormA。没问题！派生类可以被视为它们的基类。但是，如果你访问它，你会得到一个表单，所以你需要做的就是*将*新表单转换回你实际提供的表单：

```
FormA form = (FormB)Owner; 
```

这几乎与执行以下操作相同：

```
FormA form = Owner as FormB; 
```

但有一些警告。运算符是“`as`安全转换”，如果对象不是提供的类型，则返回空值。

我会向您推荐我们提供的代码，当您有时间时，学习继承和多态。它们是了解正在发生的事情的关键。

如果我可以做一些自我推销，我会及时[写一篇](http://blog.brunobrant.net/2011/08/careful-with-c-as-operator.html)关于为什么你通常会避免`as`你可能会觉得有趣的文章。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-14T22:09:42.993

原因是一个叫做[多态](http://en.wikipedia.org/wiki/Polymorphism_%28computer_science%29)的概念。在更具体的意义上，该`Owner`属性是 type `Form`。 `FormA`继承自 type `Form`，所以在某种程度上，它是 a`Form`和 a `FormA`。解决此问题的方法是将所有者“强制转换”为`FormA`，如下所示：

```
FormA fa = Owner as FormA;
if (fa != null)
{
    // do something
} 
```

您要在`null`此处检查的原因是，也许其他人正在使用您的`FormB`，并且已将`Owner`属性设置为 type `FormC`，您不一定能够控制。在这种情况下，代码`Owner as FormA`将返回`null`. 因此，空检查确保您不会得到任何令人讨厌的惊喜。

# git - git - “调试”分支，合并“修复”分支而不使用“调试”

> ID：15420947
> 
> 赞同：8
> 
> 时间：2013-03-14T21:55:56.043
> 
> 标签：git

我有一个`master`需要调试的错误分支。为此，我想插入一堆调试程序（例如，打印变量），查明错误并应用修复。稍后，我想将修复合并到`master`分支中，但我不想跳过调试更改。

```
# create debug branch
git checkout -b debug

# ...
# edit sources and add debug prints
# ...

# commit debug changes
git commit --all

# create branch for the fix
git checkout -b fix 
```

现在做正确的修复并提交

```
git commit --all 
```

去`master`分行...

```
git checkout master 
```

...并与修复合并*而不进行*调试更改

```
git merge fix # <-- wrong, will merge debug changes as well 
```

`fix`没有怎么合并`debug`？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-14T22:31:44.020

您正在寻找的是“git rebase”的“onto”选项（参见“git help rebase”）。根据您的描述，它将是：

```
git rebase --onto master debug fix 
```

这实际上将（从“修复”到“调试”）重新植根于 master 提交。你仍然有修复分支。要完成返工，请跟进：

```
git checkout master
git merge fix 
```

# c++ - 从另一个类的构造函数访问类的成员

> ID：15420952
> 
> 赞同：-1
> 
> 时间：2013-03-14T21:56:05.160
> 
> 标签：c++

我的代码看起来像这样：

主文件

```
#include <iostream>
#include "A.h"
#include "B.h"
using namespace std;

int main(){

int d,f;
A c();
d = c.GetStuff();

B *d = new C();
f = d->Get();

return 0;
} 
```

啊

```
#ifndef A_H
#define A_H
class A
{
int a;

public A();

int GetStuff() {return(a) ;}

};

#endif 
```

A.cpp

```
#include "A.h"

A::A()
{
 a = 42;//just some value for sake of illustration
} 
```

溴化氢

```
#ifndef B_H
#define B_H

Class B 
{
public:
virtual int Get(void) =0;

};

class C: public B {
public:
C();

int Get(void) {return(a);}
};
#endif 
```

B.cpp

```
#include "B.h"

C::C() {
a // want to access this int a that occurs in A.cpp
} 
```

我的问题是，在 B.cpp 中访问“a”的最佳方法是什么？我尝试使用“朋友”类，但没有得到结果。

有什么建议么？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T22:40:40.473

两个不同的答案，取决于你的意思

如果每个 A 对象都意味着有它自己唯一的“a”变量（这是您定义它的方式），那么您需要将 an 传递`A`给 的构造函数`C`：

```
C::C(const A &anA) {
int foo= anA.a; // 
} 
```

并且，调用构造函数变为：

```
A myA;
B *myC = new C(myA);   // You picked confusing names for your classes and objects 
```

但是，如果您希望所有 A 对象共享一个共同的值`a`，那么您应该声明`a`and`getStuff`如下：`static``A`

```
class A
{
static int a;  
public:
static int GetStuff() {return a;}; 
```

...并像`A::GetStuff()`在`C`构造函数中一样访问它。

# java - Java 包组织

> ID：15420957
> 
> 赞同：1
> 
> 时间：2013-03-14T21:56:15.733
> 
> 标签：java, package, project-organization

我已经苦苦挣扎了好几天，但我可以找到一种组织包的好方法。我创建了一些类，我希望在每个项目中都有它们，就像所有的 java 类一样，但我做不到。例如，如果我创建一个类并像这样定义包

```
package myclass.importatnt.test; 
```

此类仅在此项目中可用。如果我想在其他项目中有这个类，我必须将文件夹**myclass**复制/粘贴 到另一个项目文件夹中，这真的很无聊。有什么方法可以整理包裹以便我随时使用它们吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T22:46:55.253

如果您使用 eclipse，请转到 Project->Properties->Java Build Path，并将您的项目添加到所需项目列表中（在 Projects 选项卡下）。然后你应该能够导入它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-14T22:10:12.287

似乎您有一些实用程序类要在多个项目中重用。

与其在每个项目中复制类的源代码，不如编译类，将类文件打包到 jar 文件中，然后将此 jar 文件添加到需要它们的每个项目的类路径中。

这就是您对您使用的所有其他库（commons-lang、guava 等等）所做的事情，并且没有理由不对您自己的实用程序类做同样的事情。

# ruby-on-rails - 缓存包含动态内容的静态 html 的最佳方法是什么？

> ID：15420966
> 
> 赞同：0
> 
> 时间：2013-03-14T21:56:44.877
> 
> 标签：ruby-on-rails, caching, russian-doll-caching

我在 Rails 中使用 haml 和俄罗斯娃娃缓存。我的目标是缓存尽可能多的静态 html，并且只呈现动态内容。但是，我经常有一大段未缓存的html，因为中间有一小部分动态代码。

假设我有这个包含 2 个部分的视图：

**显示.html.haml**

```
= render 'message' 
```

**_container.html.haml**

```
.nested
  .divs
    = render 'dynamic' 
```

**_dynamic.html.haml**

```
= complex_stuff
.something
  = more_complex_stuff 
```

我不能将`_container`部分包装在缓存块中，因为它包含动态内容。我知道我可以根据动态部分中的因变量来键入缓存块，但假设动态部分的复杂性太高而无法缓存。

解决这个问题的好方法是什么？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-03-14T21:56:44.877

我写了一个gem来解决这个问题：

[https://github.com/neighborland/cache_rocket](https://github.com/neighborland/cache_rocket)

# java - 字段存在时出现 NoSuchFieldException

> ID：15420968
> 
> 赞同：80
> 
> 时间：2013-03-14T21:56:49.677
> 
> 标签：java, reflection

我`java.lang.NoSuchFieldException`在尝试运行以下方法时遇到了问题：

```
 public void getTimes(String specialty, String day) {
    ArrayList<Tutor> withSpec = new ArrayList<Tutor>();
    for (Tutor t : tutorList){
        try {
            Time startTime = (Time)t.getClass().getField(day + "Start").get(t);
        } catch (NoSuchFieldException | SecurityException | IllegalAccessException ex) Logger.getLogger(DBHandler.class.getName()).log(Level.SEVERE, null, ex); } 
```

错误在线`Time startTime = (Time)t.getClass().getField(day + "Start").get(t);`

我不明白这个错误，因为 monStart 是`Tutor`类的一个字段：

```
Public class Tutor implements Serializable {
private static final long serialVersionUID = 1L;
@Id
@Basic(optional = false)
@NotNull
@Column(name = "tutorID")
private Integer tutorID;

.... 

@Column(name = "monStart")
@Temporal(TemporalType.TIME)
 Date monStart; 
```

我只是在学习使用反射，所以我确定这是某种语法错误......

* * *

## 回答 #1

> 赞同：167
> 
> 时间：2013-03-14T22:00:12.340

该[`getField`](http://docs.oracle.com/javase/7/docs/api/java/lang/Class.html#getField%28java.lang.String%29)方法只会找到该字段，如果它是`public`. 您将需要改用该方法，该方法将找到*直接*[`getDeclaredField`](http://docs.oracle.com/javase/7/docs/api/java/lang/Class.html#getDeclaredField%28java.lang.String%29)在类上声明的任何字段，即使它不是.*`public`*

 ** * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-03-14T22:00:27.883

根据 javadoc，`Class.getField()`“返回一个`Field`对象，该对象反映该对象表示的类或接口的指定公共成员字段`Class`”。`getDeclaredField()`如果您想访问非公共字段，请使用。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2014-05-07T07:59:16.600

问题的最佳解决方案`getClass().getField()`是：

1.  使用**getDeclaredField** () 代替**getField** ()：

```
 String propertyName = "test";
        Class.forName(this.getClass().getName()).getDeclaredField(propertyName); 
```

2.  将**“HelloWorld”**替换为您的班级名称：

```
 String propertyName = "name";
        HelloWorld.class.getDeclaredField(propertyName); 
```

如果要获取列的注释长度：

```
HelloWorld.class.getDeclaredField(propertyName).getAnnotation(Column.class).length(); 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2019-08-30T19:37:09.743

对于任何看到此问题但似乎仍无法解决问题的 Android 开发人员，**请检查是否启用了 Proguard。**如果是这样，则可能是相关类被混淆了，您需要添加规则以防止这种情况发生。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-09-13T09:47:15.567

我是根据标题来回答这个问题的。我在我的 Android 项目中遇到了同样的错误 ( `NoSuchFieldException`)，但原因不同。

所以对于其他来这里的人来说，这个错误也可能是由于 Android Studio 中的缓存不同步造成的。转到**文件>使缓存无效/重新启动...**

另[请](https://stackoverflow.com/questions/13439486/missing-styles-is-the-correct-theme-chosen-for-this-layout)参阅

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2021-11-12T17:12:29.223

如已接受的答案中所述， using`getDeclaredField`可能会解决您的问题（如果该字段未声明为`public`）。

如果您仍然得到`NoSuchFieldException`，那可能是因为该字段实际上在超类中！确实，如果你的类是`extends`另一个类，那么你将不会通过`getDeclaredField`方法获得继承的字段。以下是解决该问题的方法：

```
String propertyName = "foo";
yourClass.getClass().getSuperClass().getDeclaredField(propertyName); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-09-01T15:09:58.280

很高兴知道...如果您的班级有 @Configuration，则 getDeclaredFields() 将不包含您的字段。*

# iis - Joomla - 500 - 打开文件时出现内部服务器错误

> ID：15420969
> 
> 赞同：0
> 
> 时间：2013-03-14T21:56:54.033
> 
> 标签：iis, joomla, internal

我正在使用在 IIS 7.5 上运行的 Joomla 2.5.8。当我将新文件上传到服务器时，它会成功上传，但是当我将该文件链接到我的文章并在前端查看时。我收到一个错误（500 - 内部服务器错误，另请参阅第一个附加图像）。

我已经使用 Mod Rewrite ON 和 OFF 进行了测试，但仍然无法正常工作。从我的 IIS 错误消息屏幕中，我可以看到 Mod Rewrite 发生错误（另请参阅第二个附加图像）。

过去 2 天一直在研究这个问题。任何帮助将不胜感激......！

[500 - 内部服务器错误屏幕截图](http://i.stack.imgur.com/rEPJN.jpg)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-17T22:42:14.833

我找到了解决方案。在我的 IIS web.config 中，它从传入的 url 中删除了 pdf。这就是为什么它给出 500 错误。

# ruby-on-rails - 如何在 Capybara 中为集成测试设置请求对象？

> ID：15420973
> 
> 赞同：1
> 
> 时间：2013-03-14T21:57:06.867
> 
> 标签：ruby-on-rails, rspec, capybara, omniauth

`request`在 capybara 中不可用，但我正在尝试通过 facebook/twitter 测试登录。如何创建一个可以使用的助手`request`？

错误： `NameError: undefined local variable or method 'request'`

login_integration_tests.rb：

```
 before do
    OmniAuth.config.mock_auth[:facebook] = {
      'provider' => 'facebook',
      'uid' => '123545'
    }
    request.env["omniauth.auth"] = OmniAuth.config.mock_auth[:facebook] # error here
  end 
```

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-06-18T17:36:35.810

我使用 google_auth 进行了此操作，但您可以使用 facebook、twitter 和 github 进行相同的操作。

首先删除这一行：

```
request.env["omniauth.auth"] = OmniAuth.config.mock_auth[:facebook] 
```

在您的 spec_helper.rb 中添加这些行：

```
Capybara.default_host = 'http://localhost:3000' #This is very important!

OmniAuth.config.test_mode = true
OmniAuth.config.add_mock(:default, {
  :info => {
          :email => 'foobar@test.com',
          :name => 'foo',
          :password => 'qwerty123'
       }
}) 
```

然后在你的助手中：

```
module FeatureHelpers
  def login_with_oauth(service = :google_apps)
    visit "/users/auth/#{service}"
  end
end 
```

将您的助手包含在 spec_helper.rb 中

```
RSpec.configure do |config|

    config.include FeatureHelpers, type: :feature

end 
```

最后，在您的 feature/capybara_spec.rb 文件中

```
feature "Signing in" do

  before do
    Capybara.current_driver = :selenium
    login_with_oauth #call your helper method
  end

  scenario "Signing in with correct credentials" do
    expect(page).to have_content('Welcome')
  end
end 
```

我知道有点晚了，也许你找到了答案，但如果你不能或有人正在阅读这本书，那就太好了！

# twitter-bootstrap - 一致迁移到 Twitter Bootstrap

> ID：15420978
> 
> 赞同：0
> 
> 时间：2013-03-14T21:57:31.483
> 
> 标签：twitter-bootstrap

我在 RoR 上有一个庞大而复杂的 Web 应用程序，我想将其前端迁移到 Twitter Bootstrap。但是革命性的方式（只是删除我的旧 CSS 然后启用 Bootstrap 并编写一个新的 CSS）是不可接受的，因为它会破坏应用程序并且恢复其功能将是一项非常艰苦的工作，并且需要太多时间。

因此，我正在寻找一种一致的方法来为前端功能一个一个地启用 Bootstrap，并让剩余的功能以旧式外观和工作，直到它们被迁移。

有没有人有类似的经历？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-14T22:11:38.170

1.  使用 CSS 预处理器
2.  将现有的 CSS 转换为 .less 或 Sass
3.  在 .less 或 Sass 版本的 Bootstrap 主文件 (Bootstrap.less) 的末尾导入您的文件
4.  从 Bootstrap.less 中删除所有 .less 或 Sass 文件
5.  根据需要将组件添加回 Bootstrap.less 并构建您的 CSS 文件。

# php - 如何从 php curl 访问结果

> ID：15420980
> 
> 赞同：0
> 
> 时间：2013-03-14T21:57:34.240
> 
> 标签：php, curl

很抱歉这个基本问题，但我是 PHP 新手。

我在 php 中使用 curl 来访问数据库中的记录。一切正常，最后我创建了一个名为“结果”的变量。我的问题是如何访问结果变量中的 xcoord 和 ycoord 值？

我的卷曲：

```
 curl_setopt($ch, CURLOPT_CUSTOMREQUEST, 'POST');
  curl_setopt($ch, CURLOPT_POSTFIELDS, $query);
  curl_setopt($ch, CURLOPT_RETURNTRANSFER, TRUE);
  $result = curl_exec($ch);
  curl_close($ch); 
```

结果`echo $result;`：

```
{"time":0.041,"total_rows":1,"rows":[{"name":" test ","xcoord":" 13.307580499999972 ","ycoord":" 52.4212494"}]} 
```

我在这里先向您的帮助表示感谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-14T21:59:37.887

看起来是JSON

```
$decoded = json_decode($result);

echo $decoded->time;
echo $decoded->total_rows;
foreach($decoded->rows as $row) {
   echo $row->name;
   //so on
} 
```

# sql - 查看在表上具有自联接

> ID：15420981
> 
> 赞同：-1
> 
> 时间：2013-03-14T21:57:35.070
> 
> 标签：sql, oracle, view, query-optimization, self-join

我想创建一个视图，我将需要一个包含自连接的查询。我担心它的性能和行为，因为它将获取大量数据。表和查询的详细信息如下（原始表有更多列，我将需要来自多个列的结果；这只是为您提供一个示例）：-
**人表**

```
PK NAME       SPOUSE_REF_ID   IS_MARRIED
1  John          Null             Y
2  Alice          1               Y
3  Varvatos      Null             Y
4  Barbara        5               Y
5  Stanely       Null             Y
6  Ross          Null             N
7  Henry         Null             N 
```

我需要查询那些已婚并有配偶ref_id的人的数据。因此，我提出的查询是：-

```
select a.NAME spouse_name, a.SERVICE_NO, a.id,a.employment_category_id, pf.name name, pf.service_no,pf.id,
  pf.employment_category_id
  from person a
 inner join person pf on
  a.id = pf.spouse_ref_id
  where a.IS_MARRIED ='Y' 
```

请就其优化向我提出建议，如果您认为重组查询将获得更好的结果或在查询等中不建议使用自联接等。
我将不胜感激具有优化视图的回复。

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2013-03-15T03:15:04.950

当您查询视图时，在后台执行用于构造视图的查询，然后将适当的数据返回给您。

有时，我注意到使用带有连接的 where 子句会获取意想不到的结果。因此，我建议您将原始查询修改为以下内容：-

```
select a.NAME spouse_name, a.SERVICE_NO, a.id,a.employment_category_id, pf.name name, pf.service_no,pf.id,
  pf.employment_category_id
  from person a
 inner join person pf on
  a.id = pf.spouse_ref_id
  and a.IS_MARRIED ='Y' 
```

您可以做的另一个优化是在配偶_ref_id 上创建一个（唯一索引）/（索引）。这将确保当您进行自连接时，*不会*对两个实例进行全表扫描。我不确定以下查询是否会产生更好的结果或您想要的结果（但值得一试）：-

```
select a.NAME spouse_name, a.SERVICE_NO, a.id,a.employment_category_id, pf.name name, pf.service_no,pf.id,
      pf.employment_category_id
      from person a
     inner join person pf on
      a.id = pf.spouse_ref_id
      and a.IS_MARRIED ='Y'
      and pf.IS_MARRIED='Y' 
```

# php - 即使 SQL 查询在 pgAdminIII 中正常工作，pg_query 仍返回 NULL

> ID：15420982
> 
> 赞同：2
> 
> 时间：2013-03-14T21:57:44.697
> 
> 标签：php, postgresql

**问题**

以下代码返回“queried...NULL”（假设`$id`始终为 6 位数字）

```
$id = sprintf("%06d", $id);
$sql = 'SELECT DISTINCT first_name, last_name
        FROM schemaname.tablename
        WHERE person_id='.$id;
$q = pg_query($sql) or die(pg_last_error().' '.$sql);
print 'queried...';
$items = pg_fetch_all($q) or die(pg_last_error().' '.var_export($q, true));
print 'fetched...';
exit(0); 
```

注：`person_id`是一个`integer not null`

**我试过的**

*   当我输入要替换的 6 位 id 号码时，查询在 pgAdminIII 中正常工作`$id`
*   php pg 连接授予连接的用户`USAGE`权限`schemaname.tablename`
*   读取[php pg_query 不工作](https://stackoverflow.com/questions/9704649/php-pg-query-not-working)
*   读取[pg_query 什么都不返回](https://stackoverflow.com/questions/9880830/pg-query-returns-nothing)
*   我尝试了有和没有`sprintf`语句的代码（[php图像重命名两位数](https://stackoverflow.com/questions/15253113/php-images-rename-double-digits/15253153#15253153)）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-06T09:30:14.637

到目前为止，您的所有测试看起来都发生在 PHP 端。直接的问题是 PostgreSQL 方面发生了什么。我的赌注是这样的：

1.  查询不是您认为的那样。

2.  PostgreSQL 没有得到你认为它得到的东西。

3.  别的东西。

首先要做的是使用 pgadmin 登录并运行以下实用程序语句：

```
ALTER USER [app username] SET log_statements=all; 
```

然后运行您的 PHP 脚本并检查 PostgreSQL 实际接收的内容。然后，您可以从 pgAdmin 的日志中运行语句进行检查。例如，您可能会发现您的 sprintf 没有按照您认为的那样做，或者您的查询中某处存在拼写错误。

完成后，您可以：

```
 ALTER USER [app username] RESET log_statements; 
```

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-03-14T22:06:08.010

您没有连接到数据库。您需要创建一个数据库连接，然后将该连接的处理程序传递给 pg_query()

```
$conn = pg_pconnect("dbname=publisher");
if (!$conn) {
    echo "An error occurred.\n";
    exit;
}

$id = sprintf("%06d", $id);
$sql = 'SELECT DISTINCT first_name, last_name
        FROM schemaname.tablename
        WHERE person_id='.$id;
$q = pg_query($conn, $sql) or die(pg_last_error().' '.$sql);
print 'queried...';
$items = pg_fetch_all($q) or die(pg_last_error().' '.var_export($q, true));
print 'fetched...';
exit(0); 
```

# python - 为类动态添加类方法

> ID：15420989
> 
> 赞同：5
> 
> 时间：2013-03-14T21:58:13.810
> 
> 标签：python, metaprogramming, class-method

我有以下片段：

```
FEED_TYPES = [
    ('fan_mail',     'Fan Mail'),
    ('review',       'Review'),
    ('tip',          'Tip'),
    ('fan_user',     'Fan User'),
    ('fan_song',     'Fan Song'),
    ('fan_album',    'Fan Album'),
    ('played_song',  'Played Song'),
    ('played_album', 'Played Album'),
    ('played_radio', 'Played Radio'),
    ('new_event',    'New Event'),
]

class Feed:
    @classmethod
    def do_create(cls, **kwargs):
        print kwargs

    @classmethod
    def create(cls, type, **kwargs):
        kwargs['feed_type'] = type
        cls.do_create(**kwargs)

for type_tuple in FEED_TYPES:
    type, name = type_tuple

    def notify(self, **kwargs):
        print "notifying %s" % type
        self.create(type, **kwargs)

    notify.__name__ = "notify_%s" % type
    setattr(Feed, notify.__name__, classmethod(notify))

Feed.create("FanMail", to_profile="Gerson", from_profile="Felipe")
Feed.notify_fan_mail(to_profile="Gerson2", from_profile="Felipe2") 
```

这个想法是为每种提要类型动态创建一个类方法（如**notify_fan_mail ）。**它几乎工作得很好，唯一的问题是**打印**语句总是打印“通知 new_event”，无论我调用什么方法（对于**notify_new_mail**、**notify_review**等也是如此）。

我意识到这是因为它使用了分配给类型的最后一个值。我的问题是：如何动态创建可以使用正确值的方法**type**？

另外，如果我在 Python 文件中有这个确切的代码，那是向 Feed 类添加方法的正确方法，还是有更优雅的方法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-14T22:08:48.343

使用闭包来保存 的值`kind`：

```
for type_tuple in FEED_TYPES:
    kind, name = type_tuple
    def make_notify(kind):
        def notify(self, **kwargs):
            print "notifying %s" % kind
            self.create(kind, **kwargs)
        return notify
    notify = make_notify(kind)
    notify.__name__ = "notify_%s" % kind
    setattr(cls, notify.__name__, classmethod(notify)) 
```

顺便说一句，不要`type`用作变量名，因为它会隐藏同名的内置函数。

* * *

一个更优雅的修改方式`Feed`是创建一个类装饰器。这使您更清楚地知道您有代码修改`Feed`.

```
FEED_TYPES = [
    ('fan_mail',     'Fan Mail'),
    ('review',       'Review'),
    ('tip',          'Tip'),
    ('fan_user',     'Fan User'),
    ('fan_song',     'Fan Song'),
    ('fan_album',    'Fan Album'),
    ('played_song',  'Played Song'),
    ('played_album', 'Played Album'),
    ('played_radio', 'Played Radio'),
    ('new_event',    'New Event'),
]

def add_feed_types(cls):
    for type_tuple in FEED_TYPES:
        kind, name = type_tuple
        def make_notify(kind):
            def notify(self, **kwargs):
                print "notifying %s" % kind
                self.create(kind, **kwargs)
            return notify
        notify = make_notify(kind)
        notify.__name__ = "notify_%s" % kind
        setattr(cls, notify.__name__, classmethod(notify))
    return cls

@add_feed_types
class Feed:
    @classmethod
    def do_create(cls, **kwargs):
        print kwargs

    @classmethod
    def create(cls, kind, **kwargs):
        kwargs['feed_type'] = kind
        cls.do_create(**kwargs)

Feed.create("FanMail", to_profile="Gerson", from_profile="Felipe")
Feed.notify_fan_mail(to_profile="Gerson2", from_profile="Felipe2") 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-14T22:09:03.200

该错误是由 Python 中的闭包性质引起的。`type`通知函数中的名称绑定`type`在封闭范围内。当您更改`type`' 值时，所有引用它的闭包都会更改。

解决这个问题的一种方法是使用函数工厂：

```
def make_notify_function(type):
    def notify(self, **kwargs):
        print "notifying %s" % type
        self.create(type, **kwargs)
    return notify 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-14T22:09:05.340

您遇到的问题是您的`notify`函数没有封装 value `type`，只是它的名称。因此，当您的 for 循环进入下一个元组时，旧的会丢失。

您可以通过`type`为函数设置默认参数来解决此问题：

```
for type, name in FEED_TYPES: # no need to unpack the tuple separately
    def notify(cls, type=type, **kwargs): # type is an argument and default value
        print "notyfying %s" % type
        cls.create(type, **kwargs)

    ... 
```

请注意，我已将`self`参数更改为`cls`，这可能更正确，因为您将其设为类方法。

我认为这是在运行时向类添加方法的合适方法。我不确定这是否一定是您需要做的事情，但没有关于您的任务的更多信息（例如，做`do_create`什么？）我看不到任何其他明显的改进。

# ruby-on-rails - 如何使用 Rails 获取 MongoDB 数据库的架构

> ID：15420993
> 
> 赞同：1
> 
> 时间：2013-03-14T21:58:44.033
> 
> 标签：ruby-on-rails, ruby-on-rails-3, mongodb, schema, mongoid

我采用了一个包含 MongoDB 和 Mongoid 的项目。`schema.rb`我喜欢使用 ActiveRecord 或 Annotate gem查看数据库架构设计的方式。如何直观地看到 MongoDB 的架构设计？是否有任何类似于 Annotate 或 MongoDB 的 schema.rb 的 gem 或技巧？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-14T22:45:17.070

该方案应基于您的模型。要查看使用 Mongoid 的项目中的模式，请查看模型类之间的关系。关键字 like`has_many`和`embeds_one`是定义文档之间关系的 Mongoid 命令。你不会找到类似的东西`schema.rb`，因为数据库不像传统的关系数据库那样“静态”——你可以在同一个集合中拥有两个具有不同属性的文档。

另一种选择是使用软件来浏览数据库。我在 Mac 上使用 MongoHub。这将为您提供一个很好的数据图形视图。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-18T02:47:13.373

我最终使用了[Genghis](https://github.com/bobthecow/genghis)。它很棒，超级容易安装，持续更新，正是我想要的。

# android - viewpager 使用的片段的不同布局和功能

> ID：15420994
> 
> 赞同：2
> 
> 时间：2013-03-14T21:58:53.300
> 
> 标签：android, android-layout, android-fragments, android-viewpager

我正在使用片段和查看器。我希望每页有不同的布局和不同的功能。我怎样才能做到这一点？目前我对每个页面都有不同的布局，但我缺乏将功能放在它后面。你能帮我解决这个问题吗？

我的片段

```
public class MyFragment extends Fragment{

    int mCurrentPage;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        /** Getting the arguments to the Bundle object */
        Bundle data = getArguments();

        /** Getting integer data of the key current_page from the bundle */
        mCurrentPage = data.getInt("current_page", 0);

    }

    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {
        View v = null; //= inflater.inflate(R.layout.myfragment_layout, container,false);
        //TextView tv = (TextView ) v.findViewById(R.id.tv);
        //tv.setText("You are viewing the page #" + mCurrentPage + "\n\n" + "Swipe Horizontally left / right");

        //changeing the layout per page here
        switch(mCurrentPage){

        case 1:
            v = inflater.inflate(R.layout.main_layout, container,false);
            break;

        case 2:
            v = inflater.inflate(R.layout.main_favorite, container,false);
            break;

        case 3:
            v = inflater.inflate(R.layout.main_settings, container,false);
            break;
        }    

       return v;
    }

} 
```

MyFragmenterPagerAdapter

```
public class MyFragmentPagerAdapter extends FragmentPagerAdapter{

    final int PAGE_COUNT = 3;

    /** Constructor of the class */
    public MyFragmentPagerAdapter(FragmentManager fm) {
        super(fm);
    }

    /** This method will be invoked when a page is requested to create */
    @Override
    public Fragment getItem(int arg0) {

        MyFragment myFragment = new MyFragment();

        Bundle data = new Bundle();
        data.putInt("current_page", arg0+1);
        myFragment.setArguments(data);
        return myFragment;
    }

    /** Returns the number of pages */
    @Override
    public int getCount() {
        return PAGE_COUNT;
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-14T22:21:26.733

> 我希望每页有不同的布局和不同的功能。我怎样才能做到这一点？

由于您希望每个页面具有不同的功能和不同的布局，因此您应该为每个页面设置不同的布局`Fragment`。在你的`FragmentPagerAdapter`：

```
/** This method will be invoked when a page is requested to create */
@Override
public Fragment getItem(int position) {

    switch(position) {
        case 0:
            return new MyMainFragment();
        case 1:
            return new MyFavoritesFragment();
        case 2:
            return new MySettingsFragment();
        default:
            return null;
    }
} 
```

然后在每个中`Fragment`，对每个单独的布局进行膨胀`onCreateView`。例如，`MyMainFragment`它看起来像：

```
@Override
public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {
    View v = inflater.inflate(R.layout.main_layout, container, false);

    return v;
} 
```

这样，每个`Fragment`（又名页面）都将表现为自己的 UI 逻辑部分，与其他页面分开。

# extjs - 创建一个没有自动完成功能的简单 extjs 组合框

> ID：15420996
> 
> 赞同：1
> 
> 时间：2013-03-14T21:58:59.760
> 
> 标签：extjs, extjs3

我正在尝试创建一个没有自动完成功能的简单 extjs3.4 组合框。

下面是我的代码和链接 jsfiddle [http://jsfiddle.net/E5wyx/](http://jsfiddle.net/E5wyx/)

下面代码的问题是，选择列表中的任何项目后，就无法选择另一个。不确定我应该使用什么配置选项。谢谢。

```
 var cb = new Ext.form.ComboBox({

        width: 60,
        typeAhead: false,
        mode: "local",
        displayField: 'name',
        editable: false,
        renderTo:"cont1",              
        store: new Ext.data.ArrayStore({
            fields: ['name'],
            data  : [
                     ['option 1'], 
                     ['option 2'], 
                     ['option 3'], 
                     ['option 4'],
                     ['option 5']
                    ]
        })
    }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T19:20:23.580

我添加了以下内容`options: lastQuery: '', triggerAction: 'all'` ，这使得组合框的行为就像一个普通的

[http://jsfiddle.net/E5wyx/3/](http://jsfiddle.net/E5wyx/3/)

# excel - 在单列下移动多个excel行中的数据

> ID：15420997
> 
> 赞同：0
> 
> 时间：2013-03-14T21:59:00.757
> 
> 标签：excel, vba

我在将多个数据行移动到一列下时遇到了一些问题。

目前情况如何

![在此处输入图像描述](../Images/5b2af2d04ce219b4d7be80b1e05de196.png)

这就是我想要的

![在此处输入图像描述](../Images/bab3cde32c4763e078b17454fa1acbd3.png)

一段时间以来，我一直试图找到解决此问题的方法，但我似乎找不到任何可以解决此问题的方法。

先感谢您

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T22:10:26.607

选择性粘贴，转置是唯一接近你想要的东西，但它不会为你做。我认为您将不得不编写宏或手动执行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-14T22:26:02.150

正在考虑一种使用工作表功能的方法，但出现了空白。使用 VBA 可能要简单得多。

这是一种相当简单的方法。它查看`Sheet1`并输出到`Sheet2`（因为如果您尝试输出到同一张表而不首先缓存所有值，它会覆盖一些值）。

这是由于`Sheet.Cells`Object(?) 存储数据的方式，即行中的`A1,B1..Y1,Z1,A2,B2..Y2,Z2` 位置`Y`和`Z`最后一个单元格。（基本上与你的结果相反）

```
Sub Main()
Dim S1 As Worksheet
Dim S2 As Worksheet
Dim Cell As Variant
Dim Row As Long

    Set S1 = ThisWorkbook.Worksheets("Sheet1") ' Source Sheet
    Set S2 = ThisWorkbook.Worksheets("Sheet2") ' Destination Sheet

    Row = 1 ' Start Output on this row

    For Each Cell In S1.UsedRange.Cells

        S2.Cells(Row, 1).Value = Cell.Value
        Row = Row + 1

    Next Cell

End Sub 
```

# javascript - 获取大数组[x][y][z] javascript中元素的位置

> ID：15420998
> 
> 赞同：0
> 
> 时间：2013-03-14T21:59:05.420
> 
> 标签：javascript, jquery, arrays, loops

我坐在上面超过一个小时，可能是因为迟到了，也可能是我很愚蠢，但我做不到。我有两个数组

```
a[0] = [['','',''],['','',''],['','','']];
a[1] = [['','',''],['','',''],['','','']];
a[2] = [['','',''],['','',''],['','','']];
a[3] = [['','',''],['','',''],['','','']];

b=['','','','',
'','','','','',
'','','','','',
'','','','','',
'','','','','',
'','','','','',
'','','','','',
'',''] 
```

如您所见，它是不同格式的数组，但是数组 a[] 中的每个单元格都引用了数组 b[] 中的他的兄弟

我正在尝试编写一个函数来获取数组 a[] 中的单元格地址，例如计算（3,2,2）并返回数组 b[] 中的单元格地址

这是我到目前为止写的...

```
function timecalculating(x,y,z) {
    var count =z;

    var prew=y-1;

    for (var i=k; i>-1; i--) {

        for (var j=vocabulary[i].length; j>-1; j--) {

            count+=vocabulary[i][prew].length;
        }
    }
    alert (count) ;
} 
```

但我知道这是不对的..有什么建议吗？

下面是一些例子： INPUT (3,1,1) 这意味着

```
a[0] = [['','',''],['','',''],['','','']];
a[1] = [['','',''],['','',''],['','','']];
a[2] = [['','',''],['','',''],['','','']];
a[3] = [['','',''],['','HERE',''],['','','']]; 
```

所以它应该把所有的都算下来。(2+3)+(3+3+3)+(3+3+3)+(3+3+3)=32 <= 这是数组 b[] 2 中的“地址” - 是 z 3(first ) 是 a[x][y].length 3(second) 是 a[x][y-1].length

等等..

我希望它对不同长度的数组通用）

```
a[0] = [['','',''],['','',''],['','','']];
a[1] = [['',''],['','','']];
a[2] = [['','',''],[''],['','']];
a[3] = [['','','']]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T22:08:14.880

我不确定我是否理解正确，但你的意思是......

```
function timecalculating(x,y,z) {
    var index = 9 * x + 3 * y + z;
    return b[index];
} 
```

## 编辑

好的，在看到您编辑的问题后，我更好地理解了它。

广义的解决方案非常棘手，并且涉及递归。

尝试这个 ：

```
function countUp(arr, stopAt, progress, level) {
    //Initialize level and progress (at level 0).
    level = level || 0;
    if(level == 0) {
        if(!progress) {
            progress = [];
            for(var i=0; i<stopAt.length; i++) progress[i] = 0;
        };
        try {
            var ar = arr, val;
            for(var i=0; i<stopAt.length; i++) {
                val = ar[stopAt[i]];
                if( val == undefined || (i<stopAt.length-1 && !$.isArray(val)) ) {
                    throw('');
                }
                ar = val;
            };
        }
        catch(e) {
            return -1;//return -1 if the requested stopAt position doesn't exist.
        }
    }

    progress[level] = 0;
    var c, stop = false;
    for(var i=0, n=0; i<arr.length; i++, progress[level]++) {
        if($.isArray(arr[i])) {
            c = countUp(arr[i], stopAt, progress, level+1);
            n += c.n;
            stop = c.stop;
        }
        else {
            n += 1;
            stop = arrayCompare(stopAt, progress);
        };
        if(stop) break;
    }
    return (level>0) ? {n:n, 'stop':stop} : n-1;
}

//Utility function for comparing two arrays
function arrayCompare(arr1, arr2) {
    if(arr1.length !== arr2.length) return false;
    for(var i=0; i<arr1.length; i++) {
        if(arr1[i] !== arr2[i]) return false;
    }
    return true;
} 
```

调用函数如下：

```
var index = countUp(a, [3,1,1]); 
```

其中`a`是一个数组，第二个参数表示停止位置的索引。

如果请求的停止位置不存在，则函数返回 -1。

[演示](http://jsfiddle.net/fVZLp/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-14T22:57:47.483

对于相同大小的数组，将多维索引转换为其一维对应物的一般解决方案需要数组每个维度的维度大小，而不是第一个维度，并且取决于您使用的是[行优先还是列优先排序](http://en.wikipedia.org/wiki/Row-major_order).

我将在这里的示例中使用行优先顺序，因为我认为这是您正在寻找的（转换为列优先很容易）。我将使用下面的示例来解释行主索引。考虑以下数组。

```
var array = [[0, 1, 2],
             [0, 1, 2],
             [0, 1, 2]]; 
```

在行主要顺序中，我们正在寻找行的索引，就好像它们一个接一个地组织一样。这就好像每一行都附加到一个数组`[0, 1, 2, 0, 1, 2, 0, 1, 2]`中。第一行的索引完全相同（0、1 和 2）。对于第二行，我们必须添加第一行的长度，即 3，给我们索引 3、4、5。第一行的长度当然是原始数组的第二维的大小。对于第三行，我们必须添加原始数组的第二维的两倍，得到 6、7、8。这里的模式应该很明显，并在下面的示例中使用。

`c`通常，对于大小为 2D 的数组，`c[height][width]`对应于 2D 位置的 1D 索引`c[y][x]`是`y * width + x`。

`d`对于一个大小为 的三维数组，`d[depth][height][width]`对应位置的一维索引`d[z][y][x]`为`z * (width * height) + y * width + z`。

相同的概念可以应用于具有不同大小的多维数组。但是，由于子数组的大小是未知的，因此不可能像我们之前所做的那样在一次计算中得到答案。相反，您必须计算给定目标索引之前的元素数。这很简单，正如您应该在下面的代码中看到的那样，您可以使用这个[demo](http://jsfiddle.net/Ninjakannon/7MpcR/)进行测试。

```
/*  Sums the number of elements in each sub-array of the given array.
    Returns the resulting sum.
    array: the array to count the elements of. */
function countAllElements(array) {
    var elements = 0;

    if (Array.isArray(array)) {
        for (var i = 0; i < array.length; ++i) {
            elements += countAllElements(array[i]);
        }
    }
    else {
        ++elements;
    }

    return elements;
}

/*  Sums the number of elements in each sub-array of the given array up to the given target index.
    Returns the resulting sum.
    array: the array to count the elements of.
    target: the target indices as an array, e.g. [3, 1, 5].
    depth: current depth in the nested arrays. Do not call with this. */
function countElementsBeforeIndex(array, target, depth) {
    var elements = 0;

    depth = depth || 0;

    if (Array.isArray(array)) {
        for (var i = 0; i < target[depth]; ++i) {
            elements += countAllElements(array[i]);
        }

        elements += countElementsBeforeIndex(array[target[depth]], target, depth + 1, i);
    }

    return elements;
} 
```

您将看到我提供了一个函数 ，`countAllElements`它计算具有任意嵌套级别的数组中的所有元素，另一个，`countElementsBeforeIndex`，它一直计数，直到它达到提供的索引。后一种方法使用前一种方法。

我希望这有帮助！ [（演示）](http://jsfiddle.net/Ninjakannon/7MpcR/)

# sql-server - RODBC odbcDriverConnect() 连接错误

> ID：15420999
> 
> 赞同：21
> 
> 时间：2013-03-14T21:59:08.987
> 
> 标签：sql-server, rodbc

我正在尝试使用

```
odbcDriverConnect('driver={SQL Server};server=servername\instancename,port;database=testing;username=abc;password=123456') 
```

连接远程数据库服务器（sql server 2008）。但我得到了

> [RODBC] 错误：状态 08001，代码 17，消息 [Microsoft][ODBC SQL Server Driver][DBNETLIB]SQL Server 不存在或访问被拒绝。

错误。任何想法？

我可以用

```
odbcDriverConnect('driver={SQL Server};server=localhost;database=testing;trusted_connection=true') 
```

连接我的本地数据库服务器（sql server 2008）。

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2013-03-15T16:00:00.497

正确的语法应该是：

```
odbcDriverConnect('driver={SQL Server};server=servername\\instancename,port;database=testing;uid=abc;pwd=123456') 
```

如果您使用 Windows 身份验证方法：

```
odbcDriverConnect('driver={SQL Server};server=servername\\\\instancename,port;database=testing;trusted_connection=true') 
```

斜线似乎是一个转义字符，转义斜线有效。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-09-01T18:21:40.943

对于 Linux 上的 Microsoft ODBC Driver 11 for SQL Server，R 版本 3.0.1 中的 RODBC 版本 1.3-7，上述答案均无效。然而，起作用的是以下内容：

```
dbconnection <- odbcDriverConnect("Driver=ODBC Driver 11 for SQL Server;
                Server=127.0.0.1; Database=MyDBName; 
                Uid=MyName; Pwd=XXXX") 
```

（输入相关的 IP 地址、数据库名称等）。

在可信连接的情况下：

```
dbconnection <- odbcDriverConnect("Driver=ODBC Driver 11 for SQL Server;
                Server=127.0.0.1; Database=MyDBName; 
                Uid=MyName; Pwd=XXXX; trusted_connection=yes") 
```

`trusted_connection`只会听“是”或“否”而不听“真”和“假”

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-17T14:58:04.627

# 1.连接MySQL

a)如果你的系统中安装了Mysql，如果没有安装它。

b) 下载 RMySQL IN R

`library(RMySQL)`

`drv = dbDriver("MySQL 5.0.1")`

确保 MySQL 版本正确。

`con = dbConnect(drv,host="localhost",dbname="test",user="root",pass="root")`

使用本地主机或使用服务器，即 IP 地址

使用所需的数据库名称、用户名和密码

`album = dbGetQuery(con,statement="select * from table")`

运行所需的查询

`close(con)`

# 2.另一种连接数据库的方式

a)首先安装任何数据库，如 MySQL、Oracle、SQL Server

b) 为数据库安装 ODBC 连接器

`library(Rodbc)`

`channel <- odbcConnect("test", uid="ripley", pwd="secret")`

test 是用户必须手动设置的 odbc 连接器的连接名称

用户可以在管理员工具中找到它

`res <- sqlFetch(ch, "table name")`

可以将表作为数据框检索

`res<-sqlQuery(channel, paste("select query"))`

带有条件的表的一部分可以作为数据框检索

`sqlSave(channel, dataframe)`

将数据框保存到数据库（不要使用“res <-”这样的东西）

喜欢用户可以使用

`sqlCopy()` `sqlDrop()`

`sqlTables()`

`close(channel)`

总是关闭连接

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-12-10T16:21:55.037

看起来您正在尝试连接到 SQL Server。这个代码片段应该可以工作，它对我有用：

库（“RODBC”）

连接 <- DBI::dbConnect(odbc::odbc(), Driver = "SQL Server", Server = "Your Server Name", Database = "Your Database Name", UID = "Your Database Name", UID = "Your服务器登录”，PWD = “您的服务器密码”，端口 = 1433）

参考：[通过 R 连接 MS SQL Server](https://db.rstudio.com/databases/microsoft-sql-server/)