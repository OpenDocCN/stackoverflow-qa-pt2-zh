# StackOverflow 问答 13783000-13783999

# facebook - Facebook 应用访问令牌

> ID：13783002
> 
> 赞同：0
> 
> 时间：2012-12-08T23:23:46.247
> 
> 标签：facebook, facebook-graph-api, facebook-access-token

这是我之前发布的问题的后续问题：[Facebook Graph API Access Token](https://stackoverflow.com/questions/13754468/)。我成功生成了一个 60 天的应用令牌。但我的烦恼还没有结束……

我已经能够使用 Graph API Explorer [https://developers.facebook.com/tools/explorer?method=GET&path=me%2Ffeed](https://developers.facebook.com/tools/explorer?method=GET&path=me%2Ffeed)隔离我的问题。当我输入我的临时访问代码时，我会得到完整的列表。当我输入我的应用程序访问代码时，我只会得到一个条目。一个不是特别新的，它的权限值似乎与其他条目没有任何不同。

任何人都可以对此有所了解吗？

再次感谢。

吉姆·舒勒

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T04:36:19.903

实时调频。

Scope 需要包含“read_stream”，它不是应用程序的属性，而是访问代码的属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-08T23:48:04.723

使用应用访问令牌请求`/me`应该只给出错误消息，因为没有用户访问令牌，API 无法确定“我”应该是谁。

`/userid`在这些情况下使用。

# javascript - Slider 一张一张加载图片的最佳解决方案？

> ID：13783007
> 
> 赞同：3
> 
> 时间：2012-12-08T23:24:16.950
> 
> 标签：javascript, jquery, ajax, loading

我有一个带有 7 个大图像的滑块，我正在寻找一个 javascript/ajax 解决方案来一张一张地加载这些图像。只有当第一个图像完成时，浏览器才应该开始下载第二个图像，等等。

满足这种需求的最佳做法是什么？

目前，我有两种方法：

*   [在 JavaScript 中一个接一个地加载图像](https://stackoverflow.com/questions/9412137/load-images-one-after-another-in-javascript)
*   [http://www.appelsiini.net/projects/lazyload](http://www.appelsiini.net/projects/lazyload)

谢谢 ！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T23:12:21.603

使用 Image 构造函数并定义其`src`属性，图像将开始下载。为图像注册一个 onload 事件，并确保在将图像插入 DOM 之前下载它。

[一个简单的预加载示例](http://jsfiddle.net/W4PJN/)

# c# - 根据编号拆分字符串列表

> ID：13783010
> 
> 赞同：2
> 
> 时间：2012-12-08T23:24:29.697
> 
> 标签：c#, linq, c#-4.0

我有几个编号列表存储在`List<string>`：

```
List<string> all = new List<string>()
{
  "1\. Apple",
  "2\. Banana",
  "3\. Coconut",
  "1\. Ant",
  "2\. Beaver",
  "3\. Cat"
  ...
} 
```

我想将此列表拆分为列表列表，其中每个列表包含 1-3。

```
List<List<string>> split = new List<List<string>>()
{
  new List<string>() { "1\. Apple", "2\. Banana", "3\. Coconut"},
  new List<string>() { "1\. Ant", "2\. Beaver", "3\. Cat"}
} 
```

总会有“1”。所以我可以用它作为我的分隔符。有没有一种巧妙的方法可以用 LINQ 做到这一点，而不需要两个嵌套的 for 循环？

更新：我希望这可以概括为任何长度，而不是总是 3。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-08T23:28:55.627

听起来您可以改用字典类型。您可以将项目编号设置为键，将项目本身设置为值，而不是存储项目的编号和项目本身。以下是您如何完成此操作的示例：

```
newList = {'1':'Apple','2':'Banana','3':'Pear'}  
animalList = {'1':'Bear','2':'Cat','3':'Dog'} 
```

您可以遍历每个项目，或使用方法通过键或值调用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-08T23:29:00.510

```
List<List<string>> result = all.GroupAdjacent((g, x) => !x.StartsWith("1."))
                               .Select(g => g.ToList())
                               .ToList(); 
```

从[这里](https://stackoverflow.com/a/8364977/76217)使用*GroupAdjacent 扩展方法*。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-09T00:08:46.050

获得所需结果的另一种选择（按顺序为每个项目分配组索引，然后按该索引分组）：

```
int groupIndex = 0;
List<List<string>> split = all.Select(s => {
                                   if (s.StartsWith("1."))
                                      groupIndex++;
                                   return new { groupIndex, s }; })
                              .GroupBy(x => x.groupIndex)
                              .Select(g => g.Select(x => x.s).ToList())
                              .ToList(); 
```

* * *

另一种选择 - 累积结果（这将需要遍历列表）

```
List<List<string>> split =
    all.Aggregate(new List<List<string>>(), (acc, s) =>
                    { 
                        if (s.StartsWith("1."))
                            acc.Add(new List<string>());
                        acc[acc.Count - 1].Add(s);
                        return acc; 
                    }); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-08T23:31:21.387

如果不对列表进行大量假设，使用 LINQ 执行此操作并没有真正的*巧妙*方法，而且您提供给我们的唯一有保证的信息是*“总会有 1”。*. 总是有 3 个项目的组，还是有时会更多或更少？

为什么不改变字符串的存储方式开始 - 使用 a`List<List<string>>`代替，所以你有 a `List`of `List<string>`？

# c++ - 地图 在共享内存中使用 Boost::interprocess

> ID：13783012
> 
> 赞同：8
> 
> 时间：2012-12-08T23:24:50.383
> 
> 标签：c++, boost, ipc, shared-memory

我正在尝试在以下类型的共享内存中构建地图

我这样创建共享内存区域：

```
 managed_shared_memory segment(create_only ,"MyMap"  ,size);       

ShMemAllocator_t alloc_inst (segment.get_segment_manager());

 map =   segment.construct<MyMap_t>("MyMap")      
                             (std::less<int>() 
                             ,alloc_inst); 
```

地图中的值如下：

```
 typedef pair<MutexType, boost::interprocess::offset_ptr<void> > ValueType ; 
```

MutexType 本身就是一个包含读取和写入互斥锁的结构（使用 read_lock 和 write_lock）；定义如下：

```
typedef struct  mutex_struct{ 
   sharable_lock<interprocess_mutex> read_lock(interprocess_mutex, defer_lock); 
  scoped_lock<interprocess_mutex> write_lock(interprocess_mutex, defer_lock); 
} MutexType; 
```

“大小”是映射的总大小（就对象而言，是所有 void 指针指向的数据大小的总和）。

我如何确保这个 void* 数据也位于我创建的这个内存段中，我如何在现有的共享内存区域中实例化它）。这样做的原因是我只想分配这个大缓冲区一次但重复地删除/添加对象（映射模型缓存）我还没有找到一种方法可以在同一个内存段中分配多个对象地图内。此外，寻求分配 MutexType 对会返回一个编译错误，指出没有提供“调用”运算符。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-12-16T21:01:55.250

你基本上已经在那里了。调用您在共享内存中分配的任何对象类型`SecondValue_t`。代替`ShMemAllocator_t`，定义不同的进程间分配器类型，例如`SecondValueAllocator_t`，用于分配`SecondValue_t`对象。每当您想将`ValueType`对象插入映射时，该对象的第二个值都会与实例`ValueType`一起分配。`SecondValueAllocator_t`

这是一个完整的示例，部分使用了我对[带有 Boost 的 Interprocess reader/writer lock 的](https://stackoverflow.com/q/12439099/196844)[回答](https://stackoverflow.com/questions/12439099/interprocess-reader-writer-lock-with-boost/12442922#12442922)中的代码：

```
#include <cstdlib>
#include <functional>
#include <iostream>
#include <string>
#include <utility>

#include <boost/scope_exit.hpp>
#include <boost/interprocess/managed_shared_memory.hpp>
#include <boost/interprocess/allocators/allocator.hpp>
#include <boost/interprocess/allocators/private_node_allocator.hpp>
#include <boost/interprocess/containers/map.hpp>
#include <boost/interprocess/sync/interprocess_upgradable_mutex.hpp>
#include <boost/interprocess/sync/scoped_lock.hpp>
#include <boost/interprocess/sync/sharable_lock.hpp>
#include <boost/interprocess/sync/upgradable_lock.hpp>

#define SHARED_MEMORY_NAME "SO13783012-MyMap"

// https://stackoverflow.com/questions/13783012/map-of-int-void-in-shared-memory-using-boostinterprocess

using namespace boost::interprocess;

typedef int SecondValue_t;
typedef allocator<SecondValue_t, managed_shared_memory::segment_manager> SecondValueAllocator_t;

typedef struct mutex_struct {
    //...
} MutexType;

typedef std::pair<MutexType, SecondValueAllocator_t::pointer> ValueType;

typedef map<int, ValueType>::value_type MyMapValueType;
typedef allocator<MyMapValueType, managed_shared_memory::segment_manager> MyMapEntryAllocator_t;
typedef map<int, ValueType, std::less<int>, MyMapEntryAllocator_t> MyMap_t;

struct shared_data {
private:
    typedef boost::interprocess::interprocess_upgradable_mutex upgradable_mutex_type;

    mutable upgradable_mutex_type mutex;
    MyMap_t my_map;

public:
    shared_data(const MyMapEntryAllocator_t& alloc)
        : my_map(MyMap_t::key_compare(), alloc)
    {
    }

    // Tries to get the mapped value for the given key `k'. If successful, the mapped value is
    // copied into `out' and `true' is returned. Otherwise, returns `false' and does not modify
    // `out'.
    bool try_get(MyMap_t::mapped_type& out, MyMap_t::key_type k) const {
        boost::interprocess::sharable_lock<upgradable_mutex_type> lock(mutex);
        MyMap_t::const_iterator pos = my_map.find(k);
        if (pos != my_map.end()) {
            out = pos->second;
            return true;
        }
        return false;
    }

    void put(MyMap_t::key_type k, MyMap_t::mapped_type v) {
        boost::interprocess::scoped_lock<upgradable_mutex_type> lock(mutex);
        my_map.insert(MyMap_t::value_type(my_map.size(), v));
    }
};

int main(int argc, char *argv[])
{
    if (argc != 2) {
        std::cerr << "Usage: " << argv[0] << " WHICH\n";
        return EXIT_FAILURE;
    }

    const std::string which = argv[1];

    if (which == "parent") {
        shared_memory_object::remove(SHARED_MEMORY_NAME);
        BOOST_SCOPE_EXIT(argc) {
            shared_memory_object::remove(SHARED_MEMORY_NAME);
        } BOOST_SCOPE_EXIT_END;
        managed_shared_memory shm(create_only, SHARED_MEMORY_NAME, 65536);

        MyMapEntryAllocator_t entry_alloc(shm.get_segment_manager());
        shared_data& d = *shm.construct<shared_data>("theSharedData")(entry_alloc);

        SecondValueAllocator_t second_value_alloc(shm.get_segment_manager());

        // Insert some test data.
        SecondValueAllocator_t::pointer p;
        p = second_value_alloc.allocate(1);
        second_value_alloc.construct(p, -3);
        d.put(0, std::make_pair(MutexType(), p));
        p = second_value_alloc.allocate(1);
        second_value_alloc.construct(p, 70);
        d.put(1, std::make_pair(MutexType(), p));
        p = second_value_alloc.allocate(1);
        second_value_alloc.construct(p, -18);
        d.put(2, std::make_pair(MutexType(), p));
        p = second_value_alloc.allocate(1);
        second_value_alloc.construct(p, 44);
        d.put(3, std::make_pair(MutexType(), p));
        p = second_value_alloc.allocate(1);
        second_value_alloc.construct(p, 0);
        d.put(4, std::make_pair(MutexType(), p));

        // Go to sleep for a minute - gives us a chance to start a child process.
        sleep(60);
    } else {
        managed_shared_memory shm(open_only, SHARED_MEMORY_NAME);
        std::pair<shared_data *, std::size_t> find_res = shm.find<shared_data>("theSharedData");
        if (!find_res.first) {
            std::cerr << "Failed to find `theSharedData'.\n";
            return EXIT_FAILURE;
        }
        shared_data& d = *find_res.first;

        MyMap_t::mapped_type v;
        int i = 0;
        for (; d.try_get(v, i); ++i) {
            std::cout << i << ": " << *v.second << '\n';
        }

        // Add an entry.
        srand(time(NULL));
        SecondValueAllocator_t second_value_alloc(shm.get_segment_manager());
        SecondValueAllocator_t::pointer p = second_value_alloc.allocate(1);
        second_value_alloc.construct(p, (rand() % 200) - 100);
        d.put(i, v = std::make_pair(MutexType(), p));
        std::cout << "placed " << *v.second << " into the map.\n";
    }

    return EXIT_SUCCESS;
} 
```

首先启动父进程来测试它：

```
./SO13783012 父级

```

然后是一些孩子：

```
./SO13783012 孩子

```

样本输出：

```
> ./SO13783012 孩子
0：-3
1：70
2：-18
3：44
4：0
将 5:-63 放入地图。
> ./SO13783012 孩子
0：-3
1：70
2：-18
3：44
4：0
5：-63
将6：-42放入地图。
> ./SO13783012 孩子
0：-3
1：70
2：-18
3：44
4：0
5：-63
6：-42
将7：-28放入地图。

```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-16T16:24:19.517

您可以在分配器<>中使用重新绑定

```
//    convert an allocator<T> to allocator<U>
template<typename U>
struct rebind {
    typedef Allocator<U> other;
}; 
```

做一个

```
typedef std::allocator< char, managed_shared_memory::segment_manager > char_alloc; 
```

然后像这样分配你的内存

```
char_alloc char_alloc_obj;
char * ptr = new (char_alloc_obj.allocate(size)) char[size];
void * vptr = (void *) ptr; 
```

默认的 std::allocator<> 是无状态的。共享内存分配器将具有状态，因此您需要弄清楚如何在不同类型的分配器之间复制状态。

# actionscript-3 - AS3：静态类与单例

> ID：13783017
> 
> 赞同：6
> 
> 时间：2012-12-08T23:25:32.720
> 
> 标签：actionscript-3, singleton, static-classes

我知道朋友们不喜欢“对抗”问题，但是……即使改写一下标题，对抗部分仍然存在，所以，为什么要隐藏它。

基本上，我想知道何时以及为什么应该使用单例或静态类，什么可以提供静态类无法提供的单例，反之亦然。

很长一段时间我都使用了这两种方法，但我看不出为什么我不应该使用另一种。

谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-09T08:14:03.017

两者基本上都是带有警告的全局变量。静态类阻止继承，而单例很丑陋，并且通过属性查找增加了开销。两者都使自动化测试变得困难。

AS3 支持全局变量，那么为什么不使用它们呢？

静止的：

```
package com.example
{
    public class Config
    {
        public static var VERSION:uint = 1;
    }
} 
```

单身人士：

```
package com.example
{
    public class Config
    {
        public static var instance:Config = new Config();

        public var version:uint = 1;

        public function Config()
        {
            //Boiler plate preventing multiple instances
        }
    }
} 
```

全局变量：

```
package com.example
{
    public var config:Config = new Config();
}
class Config
{
    public var version:uint = 1;
} 
```

现在，假设您在生产应用程序中只需要该类的一个实例，但您需要多个实例来编写测试。您可以创建一个公共课程`Config`，并使用它`com.example.config = new Config()`来重置。所有引用你的全局变量的地方现在都在使用新的实例，你甚至可以做一些花哨的事情，比如继承。

例如：

```
if(inDebugMode)
{
    com.example.config = new DebugConfig();
}
{
    com.example.config = new Config();
} 
```

# css - 覆盖 Twitter 引导程序

> ID：13783021
> 
> 赞同：1
> 
> 时间：2012-12-08T23:25:56.857
> 
> 标签：css, twitter-bootstrap, less

我正在使用 Twitter Bootstrap 开发 Rails 3.2 应用程序。我试图在 bootstrap_and_overrides.css.less 中覆盖 Bootstrap 的颜色。

我已经能够使用 LESS 变量覆盖颜色。例如：

```
 @navbarBackground: @blue;
    @navbarBackgroundHighlight: @blueDark; 
```

但是，我想偏离颜色变量。我似乎无法输入像 5092CC 这样的十六进制颜色。我不想在 LESS 中重新定义颜色变量，因为我已经读过这可能会导致问题。

我也在尝试更改所有标题标签的颜色。我希望它们都是相同的颜色。但是，Bootstrap 忽略了我尝试过的每一个更改。我最近的尝试是：

```
 h1, h2, h3, h4, h5, h6 {
      color: 325B7F;
      small {
        color: 325B7F;
      }
    } 
```

我肯定对常规 CSS 和 LESS 感到困惑。我大部分时间都在与这个作斗争。

非常感谢所有帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-08T23:33:56.243

我不熟悉Rails。但是，无论您使用的是 CSS 还是 LESS，您仍然需要添加 #。

```
h1, h2, h3, h4, h5, h6 {
  color: #325B7F;
  small {
    color: #325B7F;
  }
} 
```

如果这不起作用，您应该查看引导程序的 variables.less 文件。将颜色变量（@blue 和 @blueDark）更改为您需要的任何值并重新编译 CSS

添加：

这就是我覆盖引导变量的方式，无需直接更改任何引导文件。我有一个名为 mysite.less 的文件：

```
// bootstrap less files located in another folder 
@import "../../bootstrap/less/bootstrap.less";
@import "../../bootstrap/less/responsive.less";

// mysite overwrites located in my own project folder
@import "variables.less"; 
```

在 variables.less 中重新定义要覆盖的变量：

```
@blue: #123456;
@blueDark: #678912; 
```

最后编译你的 CSS：

```
lessc mysite.less > bootstrapincludingmyoverwrites.css 
```

# git - 合并分支后无法推送到 Git 存储库

> ID：13783023
> 
> 赞同：5
> 
> 时间：2012-12-08T23:26:10.603
> 
> 标签：git

我正在开发一个 Git 存储库，我有我的分支（称为 jviotti），我的更改已合并到 Master。现在，在提交了一些更改后，我发现自己无法推送到我的分支。

```
$ git push origin jviotti
To https://github.com/jorisbontje/pikapay-frontend.git
 ! [rejected]        jviotti -> jviotti (non-fast-forward)
error: failed to push some refs to 'https://github.com/jorisbontje/pikapay-frontend.git'
To prevent you from losing history, non-fast-forward updates were rejected
Merge the remote changes (e.g. 'git pull') before pushing again.  See the
'Note about fast-forwards' section of 'git push --help' for details. 
```

然后我尝试了 git pull：

```
$ git pull
You asked me to pull without telling me which branch you
want to rebase against, and 'branch.jviotti.merge' in
your configuration file does not tell me, either. Please
specify which branch you want to use on the command line and
try again (e.g. 'git pull <repository> <refspec>').
See git-pull(1) for details.

If you often rebase against the same branch, you may want to
use something like the following in your configuration file:

    [branch "jviotti"]
    remote = <nickname>
    merge = <remote-ref>
    rebase = true

    [remote "<nickname>"]
    url = <url>
    fetch = <refspec>

See git-config(1) for details. 
```

在 SO 浏览了一个类似的问题后，我尝试了：

```
$ git pull origin master:jviotti
From https://github.com/jorisbontje/pikapay-frontend
 ! [rejected]        master     -> jviotti  (non-fast-forward) 
```

我认为这会奏效。我错过了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-09T00:29:18.590

您首先应该确保您的本地分支有上游分支有它的上游。

```
git branch --set-upstream-to jviotti origin/jviotti
# or
git branch -u jviotti origin/jviotti 
```

那是因为新的默认[推送策略将是 "simple"](https://stackoverflow.com/questions/11782825/git-config-that-gets-cloned/11783210#11783210)。

一旦完成：

```
git pull --rebase origin jviotti 
```

这可以在上面重播您的主历史记录`origin/jviotti`（如“[引发冲突但](https://stackoverflow.com/questions/2874268/what-does-it-mean-when-git-pull-causes-a-conflict-but-git-pull-rebase-doesnt)[没有发生冲突](https://stackoverflow.com/questions/2874268/what-does-it-mean-when-git-pull-causes-a-conflict-but-git-pull-rebase-doesnt)[是什么意思`git pull``git pull --rebase`](https://stackoverflow.com/questions/2874268/what-does-it-mean-when-git-pull-causes-a-conflict-but-git-pull-rebase-doesnt)？ ”）。

但在那之后，如“ [`git pull --rebase upstream`&`git push origin`拒绝非快进？](https://stackoverflow.com/a/9664919/6309) ”，你可能仍然需要：

```
git push --force origin jviotti 
```

* * *

另一种选择是重置本地仓库，正如[OP jviotti](https://stackoverflow.com/users/1641422/jviotti) [评论](https://stackoverflow.com/questions/13783023/cant-push-to-git-repository-after-merged-branch/13783461#comment18954206_13783461)的那样：

> 我刚刚再次克隆了 repo，更改了分支，效果很好。
> 可怕的 git 噩梦，现在一切正常。

# php - MySQL密码检查器

> ID：13783026
> 
> 赞同：4
> 
> 时间：2012-12-08T23:26:30.020
> 
> 标签：php, database, string

我的问题：

我有一个密码检查器，可确保密码在插入数据库之前不超过 25 或 <5 个字符。如果是，它会吐出一个错误。这一切都很完美，但是我似乎无法检查密码是否不是 <5 或 >25 个字符，然后将其放入数据库。

代码部分：

```
if (strlen($pswd)>30) {
echo "Your password is too long! Password's should be between 5 and 30 characters long!";
}

if (strlen($pswd)<5) {
echo "Your password is too short! Password's should be between 5 and 30 characters long!";
}

else if (!strlen($pswd)>30||strlen($pswd)<5)
{
$query = mysql_query("INSERT INTO users VALUES ('','$un','$fn','$ln','$em','$pswd','$d','0')");
die("<h2>Welcome to M8Ster</h2>Please login to your account to get started ...");
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-08T23:29:30.053

尝试将所有 if 语句组合成一个 if-elseif-else：

```
if (strlen($pswd)>30) {
    echo "Your password is too long! Password's should be between 5 and 30 characters long!";
} else if (strlen($pswd)<5) {
    echo "Your password is too short! Password's should be between 5 and 30 characters long!";
} else {
    $query = mysql_query("INSERT INTO users VALUES ('','$un','$fn','$ln','$em','$pswd','$d','0')");
    die("<h2>Welcome to M8Ster</h2>Please login to your account to get started ...");
} 
```

# javascript - 是什么导致此画布示例中的性能下降？

> ID：13783027
> 
> 赞同：0
> 
> 时间：2012-12-08T23:26:34.890
> 
> 标签：javascript, html, canvas

在我的第一次画布尝试（经典老虎机）中，性能很糟糕。在最初的几次旋转之后，Chrome 几乎崩溃了。

是使用原型吗？

Stack希望我在这里写更多的文本来提交，所以我会的。

```
var Renderer = function(options) {
    var self = this
    _.extend(self, options)
    self.positions = _.map(self.reels, function(r) { return 0 })
    self.heights = _.map(self.reels, function(r) { return r.length * self.symbolHeight })
    self.context = self.canvas.getContext('2d')

    self.render()
}

Renderer.prototype.render = function() {
    var self = this

    self.context.drawImage(self.bg, 0, 0)

    self.context.rect(0, 0, self.symbolWidth * self.rows, self.symbolHeight * self.reels.length)
    self.context.clip()

    for (var reel = 0; reel < self.reels.length; reel++) {
        for (var row = 0; row <= self.rows; row++) {
            var reelIndex = Math.floor(self.positions[reel] / self.symbolHeight) + row
            , symbolOffset = self.positions[reel] % self.symbolHeight

            if (reelIndex >= self.reels[reel].length) {
                reelIndex -= self.reels[reel].length
            }

            var symbolIndex = self.reels[reel][reelIndex]
            , x = reel * self.symbolWidth
            , y = row * self.symbolHeight - symbolOffset

            /*
            console.log('drawing symbol', symbolIndex, 'from', self.symbolDims[symbolIndex].x,
                self.symbolDims[symbolIndex].y, 'to', x, y)
            */

            self.context.drawImage(
                self.symbols,
                self.symbolDims[symbolIndex].x,
                self.symbolDims[symbolIndex].y,
                self.symbolDims[symbolIndex].width,
                self.symbolDims[symbolIndex].height,
                x,
                y,
                self.symbolWidth,
                self.symbolHeight
            )
        }
    }
}

Renderer.prototype.spinupTick = function() {
    var allReelsAtMaxSpeed = true
    , maxReelSpeed = 20
    , self = this
    , acc = 1
    , reel

    for (reel = 0; reel < this.reels.length; reel++) {
        if (!self.reelsMoving[reel]) continue

        if (self.speeds[reel] < maxReelSpeed) {
            if (Math.random() < 0.5) {
                self.speeds[reel] += acc
            }

            allReelsAtMaxSpeed = false
        }

        self.positions[reel] -= self.speeds[reel]

        if (self.positions[reel] < 0) {
            self.positions[reel] += self.heights[reel]
        }
    }

    if (allReelsAtMaxSpeed) {
        var allReelsStopped = true

        for (reel = 0; reel < self.reels.length; reel++) {
            if (!self.reelsMoving[reel]) continue

            var stopSpot = self.stops[reel] * self.symbolHeight

            console.log('stop spot', stopSpot, 'position', self.positions[reel])

            if (stopSpot - self.positions[reel] <= self.speeds[reel]) {
                self.reelsMoving[reel] = false
                self.positions[reel] = stopSpot
            } else {
                allReelsStopped = false
            }
        }

        if (allReelsStopped) {
            clearInterval(self.timer)
            self.timer = null
        }
    }

    self.render()
}

Renderer.prototype.spin = function() {
    var self = this
    self.speeds = _.map(self.reels, function() { return 0 })
    self.reelsMoving = _.map(self.reels, function() { return true })
    self.stops = [0, 1, 2]
    self.timer = setInterval(_.bind(self.spinupTick, self), 1000 / 60)
} 
```

[http://jsfiddle.net/abrkn/yNtEE/7/](http://jsfiddle.net/abrkn/yNtEE/7/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T00:18:52.137

我忘了在剪辑之前调用 context.beginPath()

# postgresql - 如何停止 Npqsql 转换参数值

> ID：13783033
> 
> 赞同：0
> 
> 时间：2012-12-08T23:27:09.867
> 
> 标签：postgresql, casting, postgis, npgsql, parameterized-query

我正在使用 Npgsql 在 Postgres 数据库上发出参数化的 PostGIS 查询。问题是 Npgsql 使用简写符号转换所有参数化变量，而 PostGIS 在某些情况下不理解转换变量。

例如，假设原始查询以此开头：

```
ST_GeometryFromText('POLYGON((:x :y,... 
```

Npgsql 把它变成这样：

```
ST_GeometryFromText('POLYGON((((1278594)::int4) ((1206979)::int4),... 
```

那是行不通的。如果可以省略演员表，它会起作用，如下所示：

```
ST_GeometryFromText('POLYGON((1278594 1206979,... 
```

显然有`UseCast`一个参数的属性，但它不是每个 NpgsqlParameter.cs 可设置的。

除了动态构建我的查询之外，我还有其他选择吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T22:19:33.257

[ST_GeometryFromText](http://postgis.org/docs/ST_GeometryFromText.html)使用[众所周知的文本](http://en.wikipedia.org/wiki/Well-known_text)，因此只需使用`string`变量来表示 WKT。由于 WKT 与 PostgreSQL 无关，它不能与 SQL 混合，也不能以任何方式进行参数化。该字符串需要使用标准方法与 Npgsql 分开格式化。

如果您正在动态生成自己的几何图形，则可以使用一些[几何构造函数](http://postgis.refractions.net/docs/reference.html#Geometry_Constructors)，而不是尝试将 WKT 字符串拼凑在一起。如果您发布您尝试动态生成的几何类型，我可以传递一些关于如何参数化的想法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-10T14:59:32.190

Per Francisco Figueiredo Jr. 和 Josh Cooley，Npgsql 的两个主要开发者，目前没有强制 Npgsql 不强制转换参数化值的好方法。

虽然可以将参数设置为 type `DbType.Object`，这样可以避免强制转换，但这会导致函数调用不明确并可能导致错误。

对于需要进入 WKT 的值，我在处理参数之前对查询使用字符串替换的解决方法。

# javascript - 在 Safari 中抓取 Google Map 链接或网页链接

> ID：13783034
> 
> 赞同：2
> 
> 时间：2012-12-08T23:27:26.000
> 
> 标签：javascript, google-maps, safari, safari-extension

我有这个 javascript 代码：

```
function handleCommand (event) {
    if (event.command === 'send') {
        sendingLink(event.target.browserWindow.activeTab.url);
    } else if (event.command === 'sendMenu') {
        sendingLink(safari.application.activeBrowserWindow.activeTab.url);
    }
}; 
```

我希望能够做出“if”声明，其中我：1）如果链接是“https://maps.google.com/”，则获取 id“leurl”，以及 2）如果它不是 Google Map 链接，然后从地址栏中获取链接。我得到了第二部分，但我不知道如何做第一部分。虽然我知道在制作谷歌浏览器扩展时该怎么做（`document.getElementById('link');`）。

我怎么能做到这一点？任何帮助表示赞赏。先感谢您。

请原谅我，因为我对制作 Safari 扩展不太熟悉。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-12T19:59:30.450

如果我理解正确，您希望将当前页面中包含的一些信息放入您的全局页面。不幸的是，使用`document.getElementById('link');`不能直接工作，因为全局页面无法访问网页的内容（出于安全原因，我认为）。

您将不得不使用注入脚本和消息传递将信息发送到全局页面。例如，您可能会执行以下操作：

### global.js

```
const app = safari.application;
app.addEventListener('message', handleMessage, false);

function sendingLink(link) {
    app.activeBrowserWindow.activeTab.page.dispatchMessage('getLink');
}

function handleMessage(msg) {
    if (msg.name === 'returnLink') {
        alert(msg.message);
    }
} 
```

### 注入的.js

```
safari.self.addEventListener('message', handleMessage, false);

function handleMessage(msg) {
    if (msg.name === 'getLink') {
        // Trigger share button. Maybe:
        // document.getElementById('link').click();
        var link = document.getElementById('leurl').value;
        safari.self.tab.dispatchMessage('returnLink', link);
    }
} 
```

然后确保在 Safari Extension Builder 中将它们分别设置为全局页面和注入脚本。

[Apple Safari Extensions Development Guide](http://developer.apple.com/library/safari/#documentation/Tools/Conceptual/SafariExtensionGuide/MessagesandProxies/MessagesandProxies.html)是这样的一个很好的资源。

# ruby-on-rails - 在 Rails 中提交表单后，引导模式不会关闭

> ID：13783037
> 
> 赞同：5
> 
> 时间：2012-12-08T23:27:37.107
> 
> 标签：ruby-on-rails, twitter-bootstrap

我的 Rails 3 应用程序中的引导模式有问题。它目前可以处理提交和更新数据库的评论表单，但提交表单时模式不会关闭。我尝试将此添加到表单提交按钮：

```
:data => {:dismiss => "modal"} 
```

但它在不执行更新操作的情况下关闭了模式。这是我的模态代码：

```
<!-- Review Modal -->
<% if current_user == nil %>
<% else %>
<div id="reviewModal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="reviewModalLabel" aria-hidden="true">
  <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
    <h3 id="reviewModalLabel">Write a review</h3>
  </div>
  <div class="modal-body">
  <%= form_for(review_ballot, :remote => true, :html => {:class => 'review_ballot'}) do |f| %>
    <h4>Your score:</h4>
    <%= f.label("score_1", content_tag(:span, '1'), {:class=>"review", :id=>"1"}) %>
    <%= radio_button_tag("review[score]", 1, current_user_review == 1, :class => 'review_button')%>
    <%= f.label("score_2", content_tag(:span, '2'), {:class=>"review", :id=>"2"}) %>
    <%= radio_button_tag("review[score]", 2, current_user_review == 2, :class => 'review_button')%>
    <%= f.label("score_3", content_tag(:span, '3'), {:class=>"review", :id=>"3"}) %>
    <%= radio_button_tag("review[score]", 3, current_user_review == 3, :class => 'review_button')%>
    <%= f.label("score_4", content_tag(:span, '4'), {:class=>"review", :id=>"4"}) %>
    <%= radio_button_tag("review[score]", 4, current_user_review == 4, :class => 'review_button')%>
    <%= f.label("score_5", content_tag(:span, '5'), {:class=>"review", :id=>"5"}) %>
    <%= radio_button_tag("review[score]", 5, current_user_review == 5, :class => 'review_button')%>
  <br />
    <h4>What'd you think?</h4>
  <%= f.text_area :review_text, :rows => 3, :cols => 10 %>
  <%= hidden_field_tag :venue_id, @venue.id %>
  </div>
  <div class="modal-footer">
    <button class="btn" data-dismiss="modal" aria-hidden="true">Close</button>
    <%= submit_tag "Save review", :class => "btn btn-warning" %>
    <% end %>
  </div>
</div> 
```

这是 review_ballot 方法的场地助手

```
module VenuesHelper
  def review_ballot
    if @review = current_user.reviews.find_by_venue_id(params[:id])
      @review
    else
      current_user.reviews.new
    end
  end

  def current_user_review
    if @review = current_user.reviews.find_by_venue_id(params[:id])
      @review.score
    else
      "N/A"
    end
  end
end 
```

我现在不知道该尝试什么。我用谷歌搜索过，没有任何运气。我该如何解决？

编辑：我的临时解决方案 - 我已经`:remote => true`从模式中删除并在控制器操作中重定向了访问者，所以现在我不必担心它被解雇。

它显然很笨重/笨拙，所以如果有人可以帮助我解决这个问题，我仍然会喜欢它。愿意根据需要提供更多代码/信息。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-28T04:17:54.593

在您的情况下，我的意思是您没有上传任何图像。因此，您可以简单地进行 ajax 调用来提交。这是一个简单的代码

```
$(document).ready(function(){

  $('#submit_button_id').click(function() {  
    var valuesToSubmit = $("#form_id").serialize();
    $("#modal_id").modal('hide') ;

    $.ajax({
      url: "/controller/method",
      data: valuesToSubmit,
      type: "POST/GET/PUT"
      }).success(function(data, status){
        $("#id_if_div_where_you_want_to_show_updated_data").html( data );
    });

    return false; 
  });
}); 
```

**已编辑**

控制器方法如下所示

```
def method
  Do what you want to do
  @object = Model.some_queries
  render :template => "path_to_view_file like controller_name/method_name", :layout => false
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-20T14:04:53.790

我通过将提交绑定到`hidden.bs.modal`事件来解决这个问题：

```
$('#modal_id').on('hidden.bs.modal', function() {
    $('form').submit();
    form_submitted = false;
}); 
```

要防止表单在按钮单击时提交，您可以`return false;`在表单的 onclick 事件中使用：

```
<%= submit_tag 'Save review',
               class: 'btn btn-warning',
               :data => { :dismiss => 'modal' },
               :onclick => "form_submitted = true; return false;" %> 
```

**编辑：**

添加`form_submitted = true`到 onclick 事件，因此您知道模式在提交时关闭，而不是任何其他退出条件。调用后重置为 false `$('form').submit()`。将此变量添加到您的 javascript 文件中，最初为 false。

# internet-explorer - IE显示部分单元格

> ID：13783045
> 
> 赞同：3
> 
> 时间：2012-12-08T23:28:41.943
> 
> 标签：internet-explorer, slickgrid

我在 Chrome 和 Firefox 中使用没有问题的 slickgrid，但是当尝试在 IE 中显示它时，我只看到部分单元格。我一直在寻找可能未关闭的标签或可能导致问题的 css，但我还没有找到它。有没有其他人见过这个？

IE 示例：[IE 示例](http://imgur.com/xFgrQ)

与 Chrome 和 FireFox 不同：[Chrome 示例](http://imgur.com/1tmv4)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T04:14:43.923

是时候让我觉得自己像个白痴了。将 doctype 添加到我的 layout.jsp 以用于我的图块解决了这个问题。

```
 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> 
```

# java - Java 编译器意外的“不兼容类型”错误

> ID：13783054
> 
> 赞同：4
> 
> 时间：2012-12-08T23:29:15.310
> 
> 标签：java, javac

我的 Java 编译器`javac 1.6.0_37`无法编译以下小程序：

```
import java.util.*;

public class QueueTest {
    public static void main( String args[] ) {
        Queue<String> q = new LinkedList<String>();
    }
} 
```

错误信息是：

```
QueueTest.java:5: incompatible types
found   : java.util.LinkedList<java.lang.String>
required: Queue<java.lang.String>
        Queue<String> q = new LinkedList<String>();
                          ^
1 error 
```

根据文档，`LinkedList<E>`implements `Queue<E>`，这应该编译。我能够用`javac 1.5.0_08`. 此外，您可以将泛型排除在外，问题仍然存在（即使没有泛型，它也不会编译）。

我的问题是：有人捍卫这不是错误的立场吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-08T23:35:48.460

它为我编译。

唯一的结论是你已经导入了一个非`Queue`类`java.util.Queue`或导入了一个`LinkedList`非类`java.util.LinkedList`或两者兼而有之。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-08T23:37:02.043

尝试明确地做：

```
java.util.Queue<String> q = new java.util.LinkedList<String>(); 
```

请注意，使用它导入时`package.*`很容易被覆盖（如果您有一个与您显式导入或在工作包中同名的类）：

从[文档](http://docs.oracle.com/javase/specs/jls/se5.0/html/packages.html#7.5.1)：

> 在包 p 的编译单元 c 中导入名为 n 的类型的单一类型导入声明 d 会隐藏以下声明：
> 
> ```
> any top level type named n declared in another compilation unit of p.
> any type named n imported by a type-import-on-demand declaration in c.
> any type named n imported by a static-import-on-demand declaration in c. 
> ```

您在这里拥有的是按需类型导入声明，它被单个类型导入声明所遮蔽

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-08T23:35:15.213

一定还有其他一些错误，因为它使用 Java 1.6.0.31[与 ideone 一起编译得很好：](http://ideone.com/HemUhU)

```
import java.util.*;

class QueueTest {
    public static void main( String args[] ) {
        Queue<String> q = new LinkedList<String>();
    }
} 
```

您的类路径上是否有另一个类，例如`java.util.Queue`覆盖`java.util.LinkedList`JDK 的类？

# javascript - 将 URL 加载到本地文件的 web 视图中

> ID：13783055
> 
> 赞同：-1
> 
> 时间：2012-12-08T23:29:21.603
> 
> 标签：javascript, xcode, webview

我能够将本地文件从 iTunes 文件共享（例如“index.htm”）加载到 web 视图中

我的问题在于当我尝试从搜索文本 uitextbox 打开链接时。在这里，我搜索字符串“mow now”

```
NSString *currentURL = [viewWeb.request.URL absoluteString];
//cleanup
NSString *match = @"Documents/";
NSString *preTel;
NSString *postTel;

NSScanner *scanner = [NSScanner scannerWithString:currentURL];
[scanner scanUpToString:match intoString:&preTel];
NSString *finalString = [NSString stringWithFormat:@"%@contents/search.htm?search=%@&menu=0&submitType=Search", preTel,fixedSpaces]; 
```

file:///var/mobile/Applications/################/contents/search.htm?search=mow+now&menu=0&submitType=Search

### = 我的 iphone 沙盒代码（我认为？）

```
NSString *fullURL = finalString;
NSURL *url = [NSURL URLWithString:fullURL];
NSURLRequest *requestObj = [NSURLRequest requestWithURL:url];
[viewWeb loadRequest:requestObj]; 
```

..和页面不加载。:(

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T02:29:49.557

修复：缺少的是 stringWithFormat 中的“文档”（区分大小写）。

```
NSString *finalString = [NSString stringWithFormat:@"%@Documents/contents
                         /search.htm?search=%@&menu=0&submitType=Search",
                           preTel,fixedSpaces]; 
```

# php - php mysql 字段名称为？

> ID：13783058
> 
> 赞同：1
> 
> 时间：2012-12-08T23:29:58.983
> 
> 标签：php, mysql

我创建了一个 mysql 查询并将结果显示在表中，但想将 mysql 表中的字段或列名作为表头。我想对多个 php 文件执行此操作，但其中一个有点复杂，因为它使用 for 循环来显示由公共字段相互关联的记录。这是简单的结果表

```
echo "<table border='1' width='85%' cellpadding='5' align='center'>\n";
while ($line = mysql_fetch_array($result, MYSQL_ASSOC)) {
 echo "\t<tr align='center'>\n";
foreach ($line as $col_value) {
echo "\t\t<td align='center'>$col_value</td>\n";
}

 echo "<td align='center'><img src=./images/$col_value border='3' ></td>";

 echo "\t</tr>\n";
}
echo "</table>\n"; 
```

我不知道在哪里，但标签以及如何获取 mysql 列名。我用 mysql_field_names 尝试了一些东西，但没有运气。这是另一个带有 for 循环的表。

```
$last_pattern = null;
echo "<table border='1' width='80%' cellpadding='5' align='center'>\n";
while ($line = mysql_fetch_array($result, MYSQL_ASSOC)) {
 $col_count = count($line) - 1; // Subtract 1 because image isn't in a column
if ($line['PatternName'] !== $last_pattern) {
if ($last_pattern !== null) {
  echo "<td><tr align='center'>\n";
}
echo "<tr align='center'>\n  ";
foreach ($line as $col_name => $col_value) {
  switch ($col_name) {
  case 'YarnImage':
    break;
  case 'PatternImage':
    echo "<td><image src='images/$col_value' /></td>";
    break;
  default:
    echo "<td>$col_value</td>";
  }
}
$last_pattern = $line['PatternName'];
echo "</tr>\n  <tr align='center'><td colspan='$col_count'>\n";
}
$yarn_image = $line['YarnImage'];
echo "<img src='images/$yarn_image' width='150' height='150' border='3'/>\n";
}
if ($last_image !== null) {
echo "</td></tr>";
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-08T23:47:21.450

将第一行作为关联数组提取后，您可以使用`array_keys($line)`.

如果您决定停止使用已弃用的 ext/mysql 函数，并切换到 ext/mysqli 或 pdo_mysql，您可以享受[mysqli_stmt::result_metadata()](http://php.net/manual/en/mysqli-stmt.result-metadata.php)或[PDOStatement::getColumnMeta()](http://us1.php.net/manual/en/pdostatement.getcolumnmeta.php)等不错的函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-08T23:46:33.523

尝试在`<th>`循环上方添加一个`foreach ($line as $col_name => $col_value)`循环

```
$col_number = 1; // add a counter
foreach ($line as $col_names => $col_values) {
    if ($col_number <= $col_count){  // check if counter is >= to $col_count
    echo "<th>$col_names</th>";}
    $col_number++;}  // increase counter by 1
foreach ($line as $col_name => $col_value) {
... //rest of you code 
```

此外，在代码的第 7 行，您的表格元素无效 -

```
 echo "<td><tr align='center'>\n"; 
```

# c# - 时间：2019-04-10 标签：c#system.reflection.emitldfld

> ID：13783063
> 
> 赞同：1
> 
> 时间：2012-12-08T23:31:25.763
> 
> 标签：c#, .net, reflection.emit

嗨，我写了以下代码：

```
 AssemblyName assemblyName = new AssemblyName("SamAsm");
        AssemblyBuilder assemblyBuilder = Thread.GetDomain().DefineDynamicAssembly(assemblyName, AssemblyBuilderAccess.Run);
        TypeBuilder typeBuilder = assemblyBuilder.DefineDynamicModule("SamAsm.exe").DefineType("SamAsmType", TypeAttributes.Public);
        MethodBuilder methodBuilder1 = typeBuilder.DefineMethod("Main", MethodAttributes.Static | MethodAttributes.Public, typeof(void), new Type[] { typeof(string) });
        ILGenerator gen = methodBuilder1.GetILGenerator();
        FieldInfo field1 = typeof(Form1).GetField("TextBox1", BindingFlags.Public | BindingFlags.NonPublic | BindingFlags.Instance);

        MethodInfo method2 = typeof(Control).GetProperty("Text", BindingFlags.Instance | BindingFlags.Public | BindingFlags.NonPublic).GetGetMethod();
        MethodInfo method3 = typeof(String).GetMethod(
            "op_Equality",
            BindingFlags.Static | BindingFlags.Public | BindingFlags.NonPublic,
            null,
            new Type[]{
    typeof(String),
    typeof(String)
    },
            null
            );
        MethodInfo method4 = typeof(MessageBox).GetMethod(
            "Show",
            BindingFlags.Static | BindingFlags.Public | BindingFlags.NonPublic,
            null,
            new Type[]{
    typeof(String)
    },
            null
            );

        LocalBuilder a = gen.DeclareLocal(typeof(Boolean));

        System.Reflection.Emit.Label label42 = gen.DefineLabel();

        gen.Emit(OpCodes.Nop);
        gen.Emit(OpCodes.Ldarg_0);
        gen.Emit(OpCodes.Ldfld, field1);
        gen.Emit(OpCodes.Callvirt, method2);
        gen.Emit(OpCodes.Ldstr, "HI");
        gen.Emit(OpCodes.Call, method3);
        gen.Emit(OpCodes.Ldc_I4_0);
        gen.Emit(OpCodes.Ceq);
        gen.Emit(OpCodes.Stloc_0);
        gen.Emit(OpCodes.Ldloc_0);
        gen.Emit(OpCodes.Brtrue_S, label42);
        gen.Emit(OpCodes.Nop);
        gen.Emit(OpCodes.Ldstr, "You cracked me");
        gen.Emit(OpCodes.Call, method4);
        gen.Emit(OpCodes.Pop);
        gen.Emit(OpCodes.Nop);
        gen.MarkLabel(label42);
        gen.Emit(OpCodes.Ret);

        typeBuilder.CreateType().GetMethod("Main").Invoke(null, new string[] { null });
        assemblyBuilder.SetEntryPoint(methodBuilder1, PEFileKinds.WindowApplication);} 
```

当我尝试这个时，它阻止了我 gen.Emit(OpCodes.Ldfld,typeof(Form1).GetField("TextBox1", BindingFlags.Public | BindingFlags.NonPublic));

并告诉：该值不能为空。参数名称：con。有人可以帮助我吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-10T12:12:02.293

这里似乎很可能会返回以下内容`null`：

```
typeof(Form1).GetField("TextBox1", BindingFlags.Public | BindingFlags.NonPublic) 
```

我的直接猜测是您需要在`BindingFlags.Instance`标志集中添加 a 才能返回该字段。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-10T12:14:31.283

这意味着调用的参数之一为空，很可能是*typeof(Form1).GetField("TextBox1", BindingFlags.Public | BindingFlags.NonPublic)*的返回值。

由于您已经将该值存储在变量*field1*中，您应该进入调试模式并检查它是否不为空。

如果该值为空，则可能意味着不同的事情：

*   您的 Form1 类中真的有一个名为 TextBox1 的字段吗？始终仔细检查拼写和字符大小写。除非与 BindingFlags.IgnoreCase 一起使用，否则像 GetField、GetProperty... 这样的反射方法是区分大小写的。
*   是否可以使用您提供的 BindingFlags 的值访问它（例如，它是静态的吗？）？

在您的情况下，如果您查看 GetField 的[MSDN 文档](http://msdn.microsoft.com/en-us/library/4ek9c21e.aspx)，它会明确指出：

> 以下 BindingFlags 过滤器标志可用于定义要包含在搜索中的字段：
> 
> **您必须指定 BindingFlags.Instance 或 BindingFlags.Static 才能获得 return**。
> 
> 指定 BindingFlags.Public 以在搜索中包含公共字段。
> 
> 指定 BindingFlags.NonPublic 以在搜索中包含非公共字段（即私有、内部和受保护的字段）。
> 
> 指定 BindingFlags.FlattenHierarchy 以在层次结构中包含公共和受保护的静态成员；不包括继承类中的私有静态成员。

所以你应该使用 *BindingFlags.Public | BindingFlags.NonPublic | BindingFlags.Instance*而不是*BindingFlags.Public | BindingFlags.NonPublic*

也换

```
gen.Emit(OpCodes.Ldfld,typeof(Form1).GetField("TextBox1", BindingFlags.Public | BindingFlags.NonPublic | BindingFlags.Instance)); 
```

和

```
gen.Emit(OpCodes.Ldfld, field1); 
```

并在您分配 field1 的行上使用正确的标志。

**更新**：您对 Main 的最后一次调用也有同样的问题。您需要在以下代码行中指定 BindingFlags.Static，因为您在代码的前面使用 MethodAttributes 将方法定义为静态：

```
typeBuilder.CreateType().GetMethod("Main", BindingFlags.Static | BindingFlags.Public).Invoke(null, new string[] { null }); 
```

此外，您不希望以您正在执行的方式检索属性访问器：您应该使用 GetProperty ，而不是使用带有访问器名称 (get_Text) 的 GetMethod ：

```
 MethodInfo method2 = typeof(Control).GetProperty("Text", BindingFlags.Instance | BindingFlags.Public | BindingFlags.NonPublic).GetMethod; 
```

希望有帮助。

# hashtable - 哈希表调整大小：我们如何在不知道密钥的情况下做到这一点？

> ID：13783065
> 
> 赞同：2
> 
> 时间：2012-12-08T23:32:10.173
> 
> 标签：hashtable

当我们只在哈希表中存储键的结果数据时，如何执行哈希表调整大小？我能想到的一个例子是存储用户名和密码组合。为了隐私起见，我们只存储密码（也可以有许多其他用例）。在这里，表只存储数据但不存储键。鉴于此，如果我想在调整大小期间将条目从旧表复制到新表，我没有散列的密钥。

这里如何调整大小？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-08T23:40:38.223

在这种情况下，您根本没有真正使用哈希表——或者至少您所说的哈希没有被用作表的哈希。

换句话说，密码的散列（例如，SHA-256）只是另一条数据，存储在表（散列表或其他）中。仅当/当密码更改时才会修改。

它可能存储*在*一个以用户名为键的哈希表中——但如果是这样，您将在此处拥有用户名，以便您可以在需要时重新哈希。

如果出于某种原因，您决定使用密码的安全散列作为表中的键，则完整的散列将*是*键，而您用于索引表的将是该散列的某个散列（例如，两个字节的块全部异或在一起）。

Edit: As far as table resizing (by itself) goes, no, storing the key is not an absolute necessity. You can get by with just storing the remainder of the original hash code. In other words, you'll typically start by generating, say, a 32-bit hash. You then use part (but only part) of that to index into your table (e.g., 16 bits). When it comes time to resize the table, you will take the position in the table for 16 bits, and the stored remainder of the hash for the other 16 bits to recover the original 32-bit hash. Assuming you're doubling the size of your table, you'll then use 17 bits for the index, and store the remaining 15 bits in the table.

If you didn't mind going a bit insane with the hash itself, you could also use this to eliminate any real need to store the key at all. For example, if you started by creating a 256-bit hash (e.g., SHA-256), you could use N bits as the index into the hash table, and the remaining bits as if it were the key. If your actual keys were longer than 256 bits, this would lead to the possibility of collisions -- but collisions with SHA-256 are sufficiently rare that the odds of encountering one by chance are almost certainly lower than the chances of a computer error during a key comparison, so it said two keys were identical when they really weren't.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-09T00:51:49.893

**Short version:** Hashtables can't work with only the hash codes of their data; they *must* contain actual data. If all you provide to the hash table is a hash, then *it's the data*. A *hashtable of hashes*, which is what you seem to be trying to create, would not have problems with resizing. As far as the hashtable is concerned, the hash you inserted *is* the data, and whatever was hashed to produce the data is irrelevant.

* * *

**Long version:**

A *hashtable* and a *table of hashes* are two orthogonal ideas. It sounds like you're conflating the two in a way that doesn't make much sense in either context.

**For a hashtable, *the entire point is to map keys unambiguously to values. Without both, the table is useless*.** The hash code that a hashtable uses is not, and can not be, logically separated from the data -- it *comes from* the data, and is often calculated on the fly. The sole purpose of the hash code is to quickly locate (or store) the actual key->value mapping; you still need an actual key and an actual value to map.

The big reason for needing the actual key is, the hash code only goes so far. To some degree, every useful hashtable and *every* hash function is inherently bound by the [pigeonhole principle](http://en.wikipedia.org/wiki/Pigeonhole_principle). This means

*   Every hash function by definition can return equal hash codes for two different values; and
*   Every useful hashtable has to resolve collisions somehow (between equal hash codes and/or between different hash codes that point at the same bucket).

Hashtables are actually *doubly affected* by the pigeonhole principle; they not only have to reduce the data to a (typically int-sized) hash code, but since most hash tables can't reasonably have 4 billion buckets, the code then has to do some further reduction with that hash code to turn it into a bucket number. (A common example is taking the hash code times some prime number, *mod* the number of buckets.)

Even read-only hashtables typically have to resolve collisions. Imagine a read-only hash table that uses a hash function so perfect that every value in the table ends up in its own bucket. Even in this case, what happens when you try to find a key that's not in the table, but produces a hash code that resolves to a bucket containing a key that *is* in the table? Either you need the value itself to double-check against, or the table lies and says the key exists, even if the hash code is not actually equal!

Basically the table uses the hash code of the lookup key (or, more typically, the return value from some function on that hash code) to figure out what bucket to look in, and then compares each actual key in that bucket with the actual lookup key in order to disambiguate. This wouldn't work without an actual key of some sort, unless:

*   your hash function was guaranteed to produce a unique value for every input (making it no longer a *hash* function, but an *encoding* or *encryption* function), *and*
*   you had an infinite number of buckets.

**The only way you could have hashes in a hash table without the original data, is if the hashes *are* the data.** In that case you have a *hashtable of hashes*. In the case you're mentioning, you might use a hash of the username as a key, mapping to a SHA /mcrypt/bcrypt/whatever hash of the password. In that case, the hash *is* the key, and no one cares about the username anymore. This would not cause problems with resizing or whatever, as the hash function the hashtable uses has very little to do with the hash function *you* used; as far as the hashtable cares, the hash you gave it is just another value, and has its own hash code, and *that* hash code is what the hashtable uses internally to find stuff.

I might warn you against using hashes for usernames, though. I'd suggest that at least one piece of the auth data be collision-proof, and hashes are by their very nature *not* collision-proof. And i'll personally tear up your programming license if i catch you running around storing unhashed passwords in a potentially user-visible location. :) Perhaps if you *encrypted* the username instead of hashing it? That'd effectively guarantee its uniqueness, and if you use public-key encryption and "forget" the private key, it's effectively as irreversible as hashing. Nifty side effect is, public-key encryption is generally kinda slow due to how it works. You're basically taking a 1024-bit or larger number and multiplying it by itself thousands of times. So you have some built-in protection against brute force.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-08T23:38:56.173

您也可以通过存储原始密钥来做到这一点。对于密码，您不会将它们存储在哈希表中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-08T23:40:31.583

我想这并不能回答您的问题，但我想知道哈希表如何完全不知道其条目的键。当然，除非您确定永远不会发生碰撞。在给定的键是用户名的示例中，我看不出这怎么可能（除非哈希表一开始就大得离谱）。

无论哪种方式，如果我们谈论的是实际的哈希表，而不是直接访问表，我认为在不知道密钥的情况下在不同大小的表之间复制条目在逻辑上是不可能的，因为通常哈希表的大小很重要哈希函数的一部分。

# c++ - 未处理的异常...访问冲突写入位置

> ID：13783068
> 
> 赞同：4
> 
> 时间：2012-12-08T23:32:44.100
> 
> 标签：c++

我是 C++ 新手，我正在尝试编写一个使用双指针将两个数组相乘的程序。到目前为止，我的代码是：

```
 #include <iostream>
    using namespace std;

    //multiplies two matrices A(mxl) and B(lxn) to produce C(mxn)

    int m,l,n;
    int **A, **B, **C;

void main(void)
{ 
```

...用户输入 m,l,n 并像这样分配内存。

```
int i, j;

//creates a new mxl array   
A= (int**) new int*[m];
for(i=0;i<m;i++)
    {
        A[i]=new int[l];
    }

//creates a lxn array
B = (int**) new int*[l];
for(i=0;i<l;i++)
    {
        B[i]=new int[n];
    }

//creates a mxn array
C = (int**) new int*[m];
for(i=0;i<n;i++)
    {
        C[i]=new int[n];
    }

int sum = 0;
for(i=0;i<m;i++)
{
    for(j=0;j<n;j++)
    {
        for(int k=0;k<l;k++)
        {
            sum =+ A[i][k]*B[k][j];
        }
    }
      //cout<sum<<"\t"; 
```

到目前为止一切正常。如果我将其更改为仅 cout 'sum' 那么它将以正确的顺序返回数组的所有正确元素；当我尝试将此值放入数组时，它会返回错误消息。

```
 C[i][j]=sum; 
    }
} 
```

我确信有一种更好的方法可以将矩阵相乘，但我更想知道为什么这段特定的代码不起作用；它看起来很简单，我看不出错误来自哪里。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-08T23:42:41.460

在您的更新中，您添加了以下代码：

```
C = (int**) new int*[m];
for(i=0;i<n;i++)
{
    C[i]=new int[n];
} 
```

循环条件不正确。而不是`i<n`你需要`i<m`.

您的乘法循环如下所示：

```
for(i=0;i<m;i++)
{
    for(j=0;j<n;j++)
    {
        for(int k=0;k<l;k++)
        {
            sum =+ A[i][k]*B[k][j];
        }
    }
    C[i][j]=sum; 
} 
```

分配`C[i][j]`在错误的块中 -`[j]`数组访问超出范围。

它应该是这样的：

```
for(i=0;i<m;i++)
{
    for(j=0;j<n;j++)
    {
        sum = 0;
        for(int k=0;k<l;k++)
        {
            sum =+ A[i][k]*B[k][j];
        }
        C[i][j]=sum; 
    }
} 
```

请注意，`sum`每次`j`启动新循环时，我都将其初始化为 0。这更正了代码中的另一个错误。

如果您声明变量的范围尽可能小，那会好很多。像这样：

```
for(int i=0;i<m;i++)
{
    for(int j=0;j<n;j++)
    {
        int sum = 0;
        for(int k=0;k<l;k++)
        {
            sum =+ A[i][k]*B[k][j];
        }
        C[i][j]=sum; 
    }
} 
```

如果您这样做了，编译器会拒绝您最初将分配分配给`C[i][j]`.

你的`main`函数应该这样声明：

```
int main() 
```

你应该从你的`main()`.

# objective-c - 使用 lldb 在 Xcode 中单步执行时调试另一个选择器

> ID：13783069
> 
> 赞同：4
> 
> 时间：2012-12-08T23:33:06.290
> 
> 标签：objective-c, xcode, debugging, lldb

我的代码在 (lldb) 提示符处的断点处停止。我可以向对象发送消息并将它们的值打印在控制台上。

```
(lldb) p [self computePI]
(float) $1 = 3.0 
```

哇！在这一点上有些不对劲。我希望能够进入 computePI 作为找出哪些变量被搞砸的捷径。但是，如果我在该选择器上放置一个断点并重试，我会得到：

```
(lldb) p [self computePI]
error: Execution was interrupted, reason: breakpoint 5.1.
The process has been returned to the state before execution. 
```

如果此时我能以某种方式进入computePI，那将是一个真正的节省时间。这可能吗？我一直在查看[http://lldb.llvm.org](http://lldb.llvm.org)并没有看到任何东西。谢谢你的帮助。

**更新：** 根据 Jason Molenda 的回答，我使用以下方便的别名更新了我的 ~/.lldbinit 文件：

```
command alias nup expr -u 0 -- 
command alias nupo expr -u 0 -o -- 
```

这让我可以使用 nup（代替 p）和 nupo（代替 po）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-09T01:29:28.030

该`p`命令实际上是`expr --`. 选项之一`expr`是`-u`或`--unwind-on-error`- 在这种情况下，断点被视为“错误”（它本身可能被认为是一个错误 - 这是有争议的，在某些用例中，它的行为不同是不直观的.)

无论如何，你应该能够做到

```
(lldb) expr -u false -- [self computePI] 
```

它将在断点处停止。这里`--`表示`expr`它应该停止进行选项解析，之后的所有内容都是要评估的表达式。

# json - 在我的 json 中读取完 JSON 内容和 Unexpected token 后遇到的附加文本

> ID：13783070
> 
> 赞同：4
> 
> 时间：2012-12-08T23:33:12.247
> 
> 标签：json, json.net

我在使用 JSON.Net 创建的 json-feed 时遇到了一些问题。当我尝试解析它时，它给了我

> 读完 JSON 内容后遇到的附加文本：,. 路径 ''，第 17 行，位置 4。

我尝试使用[http://json.parser.online.fr/](http://json.parser.online.fr/)验证它，它显示“SyntaxError: Unexpected token ”。

任何想法为什么？

我在下面粘贴了我的json：

```
{
    "ReviewId": 10250,
    "DateOfVisit": "Wed, 04 Jan 2012 00:00:00 +01:00",
    "SmartDateOfVisit": "Wednesday, January 04, 2012 12:00 AM",
    "First": null,
    "IsFeatured": null,
    "Rating": 5,
    "Text": "nice food",
    "ReviewTitle": "superb experience",
    "DisplayName": "mr. X",
    "ProfilePagePath": "http://facebook.com",
    "ProfileImage": "http://facebook.com/images/anonymous.png",
    "UserReviewsWritten": 119,
    "PlaceName": "Some place",
    "PlaceUrl": "http://www.somesite.com/someplace"
  },
{
    "ReviewId": 10250,
    "DateOfVisit": "Wed, 04 Jan 2012 00:00:00 +01:00",
    "SmartDateOfVisit": "Wednesday, January 04, 2012 12:00 AM",
    "First": null,
    "IsFeatured": null,
    "Rating": 5,
    "Text": "nice food",
    "ReviewTitle": "superb experience",
    "DisplayName": "mr. X",
    "ProfilePagePath": "http://facebook.com",
    "ProfileImage": "http://facebook.com/images/anonymous.png",
    "UserReviewsWritten": 119,
    "PlaceName": "Some place",
    "PlaceUrl": "http://www.somesite.com/someplace"
  } 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-08T23:43:53.143

`{ ... }`是有效的 JSON。在那之后，`,`是一个意想不到的令牌。之后，`{ ... }`就是尾随垃圾。

# python - 在 python/numpy 中通过 argmin() 或 min() 查找前三个值的索引而不改变列表？

> ID：13783071
> 
> 赞同：14
> 
> 时间：2012-12-08T23:33:16.087
> 
> 标签：python, list, numpy, min

所以我有一个名为 sumErrors 的列表，它有 16000 行和 1 列，并且这个列表已经预分类为 5 个不同的集群。我正在做的是对每个集群的列表进行切片，并在每个切片中找到最小值的索引。

但是，我只能使用 argmin() 找到第一个最小索引。我认为我不能只删除该值，否则它会将切片移动，而索引是我恢复原始 ID 所必须的。有谁知道如何让 argmin() 吐出最低三个的索引？

或者也许是更优化的方法？也许我应该只分配身份证号码，但我觉得可能有更优雅的方法。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-12-08T23:42:38.817

Numpy 包含一个[`argsort`](http://docs.scipy.org/doc/numpy/reference/generated/numpy.argsort.html)将返回所有索引的函数。如果我正确理解您的要求，您应该能够：

```
minidx = []
for cluster in sumErrors:
    minidx.append(np.argsort(cluster)[:3]) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2016-05-08T00:01:35.310

`numpy.argpartition(cluster, 3)`会更有效。

# mysql - 交易catch-22

> ID：13783072
> 
> 赞同：2
> 
> 时间：2012-12-08T23:33:24.917
> 
> 标签：mysql, insert, transactions, block

事务块中涉及的表的唯一键约束存在问题。

关键约束的目的是防止一名球员有多个进球或每场比赛-球队-期间-进球时间球员的助攻。这很好用，没有重复的得分记录，太好了。

但是，如果球队选择了错误的得分手或助攻者（例如，球员 A 得到了助攻，但应该得到进球的得分），然后想要更新记录，关键约束会阻止更新作为球员 A 发生，在更新时，将有一个目标和一个助攻在同一目标上。

我应该提到我正在使用 JDBC SQL 包装器，因此我无法直接控制生成的 SQL。

为了解决这个问题，我决定删除现有的目标并插入，所有这些都在一个事务块中。同样的交易，违反了关键约束。是否可以在同一个事务块中删除和插入？生成 SQL 的代码类似于：

```
db.handle withSession { implicit ss: SS =>
  ss.withTransaction {
    val result = for{
      d <- teams.map{id=> model.delete(gameID, id)}
      s <- rows.map{x=> model.insert(x)}
    } yield s
  }
}
if(result.forall(_.isRight)) Right
else { ss.rollback; Left( i18n("not updated") ) } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T01:21:09.343

解决方案是在单个查询中删除整个游戏，或者，如果仅提交 1 个团队的统计数据进行更新（我们的系统允许），则删除该团队的目标游戏的统计数据。

在完整的统计数据删除的情况下，我们有：

```
db.handle withSession { implicit ss: SS =>
  ss.withTransaction {
    val result = for{
      d <- model.delete(gameID)
      s <- rows.map{x=> model.insert(x)}
    } yield s
  }
}
if(result.forall(_.isRight)) Right
else { ss.rollback; Left( i18n("not updated") ) } 
```

关键在于，似乎无法执行多个删除查询，然后执行多个插入来重新填充事务块中的已删除数据，其中存在键约束，否则会因不删除待插入数据而被破坏。

不确定这是否有意义或者它是否正确;-)，但在单个查询中执行删除确实允许随后的插入执行没有问题。

两全其美，可以保持所需的键约束，并执行事务删除/插入（注意：我不能`REPLACE INTO`，因为 JDBC 包装库不支持它）。

# javascript - JavaScript 替换

> ID：13783074
> 
> 赞同：2
> 
> 时间：2012-12-08T23:33:45.260
> 
> 标签：javascript

在下面的代码中，`alert(a)`JavaScript 内部的替换函数会提醒匹配的字符串，在这种情况下，将是 {name} 和 {place}。

这如文档[javascript docs](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/String/replace)所描述的那样工作，即 replace 方法中函数的第一个参数将是匹配的字符串。在下面的代码中，`alert(b)`将提醒 'name' 和 'place' 但没有围绕它们的花括号。

这是为什么？它如何剥离'b'的花括号？这是一个小提琴 [http://jsfiddle.net/mjmitche/KeHdU/](http://jsfiddle.net/mjmitche/KeHdU/)

此外，从文档中查看此示例，

```
function replacer(match, p1, p2, p3, offset, string){
  // p1 is nondigits, p2 digits, and p3 non-alphanumerics
  return [p1, p2, p3].join(' - ');
}; 
```

下面的替换函数的函数（a，b）中的“b”代表此示例中的哪些参数？

我无法理解的部分原因可能是因为我不确定javascript做了什么，例如，如果没有使用最大数量的参数，则使用第二个参数。

**代码**

```
var subObject = {
    name:  "world",
    place: "google"

}; 

var text = 'Hello, {name} welcome to {place}';

var replace = function (s, o) {
            return s.replace(/\{([^{}]*)\}/g,
              function (a, b) {
                  alert(a);
                  alert(b);
                var r = o[b];

                return typeof r === 'string' || typeof r === 'number' ? r : a;
              }
            );
}; 

var replacedText = replace(text, subObject); 
alert(replacedText); ​ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-08T23:40:15.273

第一个参数是您的正则表达式匹配的整个字符串（捕获组无关紧要，所以它变成`{name}`）。

第二个、第三个、第四个等参数是您的捕获组，由于您只有一个，因此您的第二个参数变为`name`.

最后两个参数是匹配的位置和整个字符串。如果您愿意，可以在回调中省略这些参数。

这是代码的可读性稍强的版本，它说明了替换对象中不存在的属性：

```
var replace = function(string, object) {
    return string.replace(/\{(.*?)\}/g, function(match, group) {
        return group in object ? object[group] : match;
    });
}; 
```

**演示：http: [//jsfiddle.net/KeHdU/4/](http://jsfiddle.net/KeHdU/4/)**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-09T00:03:29.230

有关如何使用替换功能，请参阅[https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/String/replace](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/String/replace)

```
function replacer(match, p1, p2, p3, offset, string){
    // p1 is nondigits, p2 digits, and p3 non-alphanumerics
    return [p1, p2, p3].join(' - ');
}; 
```

> match：是整个匹配的子字符串（即匹配正则表达式的内容）
> 
> p1, p2 .... pn: are `The nth parenthesized submatch string`（在匹配的子字符串中）
> 
> offset：原始字符串中的偏移量
> 
> 字符串：输入字符串

在您的情况下，您没有提供完整的论据

```
s.replace(a, b /*, offset, string*/) 
```

所以`a=match`和`b=p1`

** 请注意，如果第一个参数中的正则表达式是全局的，则每个要替换的完全匹配都会多次调用该函数。

因此，每个匹配都以开头`{`和结尾，`}`并且您有 1 个与大括号内的内容匹配的捕获括号。另外，由于您使用的是全局匹配 /{([^{}]*)}`/g`

因此，函数在 2 个匹配项上调用两次，参数如下：

1.  '{name}', 'name', 7, '你好，{name} 欢迎来到 {place}'
2.  '{place}', 'place', 25, '你好，{name} 欢迎来到 {place}'

并且将整个匹配（即第一个参数）替换为函数的返回值

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-08T23:46:29.500

如果没有使用最大数量的参数，它们将被忽略。但是，如果函数中的参数被引用并且没有首先测试 !undefined，则脚本将出错。

# mysql - 遇到条款麻烦

> ID：13783075
> 
> 赞同：-2
> 
> 时间：2012-12-08T23:33:55.613
> 
> 标签：mysql

因此使用以下 2 个表 Employee：

```
mysql> select * from employee;
+----------+-------+---------+-----------+------------+--------------------------+------+--------+-----------+-----+
| Fname    | Minit | Lname   | SSN       | Bdate      | Address                  | Sex  | Salary | Superssn  | Dno |
+----------+-------+---------+-----------+------------+--------------------------+------+--------+-----------+-----+
| John     | B     | Smith   | 123456789 | 1955-01-09 | 731 Fondren, Cary, NC    | M    |  31500 | 333445555 |   5 |
| Franklin | T     | Wong    | 333445555 | 1945-12-08 | 638 Voss, Cary, NC       | M    |  42000 | 888665555 |   5 |
| Joyce    | A     | English | 453453453 | 1962-07-31 | 5631 Rice, Raleigh, NC   | F    |  26250 | 333445555 |   5 |
| Rameish  | K     | Naraya  | 666884444 | 1952-09-15 | 975 Fire Oak, Angier, NC | M    |  39900 | 333445555 |   5 |
| James    | E     | Borg    | 888665555 | 1927-11-10 | 450 Stone, Cary, NC      | M    |  55000 | NULL      |   1 |
| Jennifer | S     | Wallace | 987654321 | 1931-06-20 | 291 Berry, Garner, NC    | F    |  43000 | 888665555 |   4 |
| Ahmad    | V     | Jabbar  | 987987987 | 1959-03-29 | 980 Dallas, Cary, NC     | M    |  25000 | 987654321 |   4 |
| Alicia   | J     | Zelaya  | 999887777 | 1958-07-19 | 3321 Castle, Apex, NC    | F    |  25000 | 987654321 |   4 |
+----------+-------+---------+-----------+------------+--------------------------+------+--------+-----------+-----+
8 rows in set (0.01 sec) 
```

部门：

```
mysql> select * from department
    -> ;
+---------+----------------+-----------+
| dnumber | dname          | mgrssn    |
+---------+----------------+-----------+
|       1 | Headquarters   | 888665555 |
|       2 | Development    | NULL      |
|       3 | Sales          | NULL      |
|       4 | Administration | 987654321 |
|       5 | Research       | 333445555 |
+---------+----------------+-----------+
5 rows in set (0.00 sec) 
```

我需要使用 having 子句组合信息，哪个部门的员工的平均工资大于 33000。这是输出的副本：

```
+--------------+-------------+
| dname        | AVG(salary) |
+--------------+-------------+
| Headquarters |       55000 |
| Research     |       35000 |
+--------------+-------------+ 
```

好的，我到目前为止：

```
mysql> select d.dname, AVG(salary)
    -> from department as d, employee as e
    -> having avg(salary) > 33000
    -> group by d.dname;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to
use near 'group by d.dname' at line 4
mysql> select d.dname, AVG(salary)
    -> from department as d, employee as e
    -> having avg(salary) > 33000
    -> group by ???? 
```

我在小组中缺少什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-08T23:45:51.167

这和你所有的其他问题听起来就像你在做一些测试或课程。不应该是你至少*尝试*自己解决这些问题之一的时候吗？

```
select
  d.dname,
  AVG(salary)
from
  department d
  inner join employee e on e.Dno = d.dnumber
group by
  d.dname
having
  avg(salary) > 33000 
```

首先，我使用 d 和 e 作为 Department 和 Employee 的别名。您可以在查询中的表名之后指定别名。您可以使用它们为字段名称添加前缀，但如果该字段仅存在于一个表中，则不必这样做。

让我们继续内连接。表之间存在关系。看起来 department.dnumber 包含部门编号。此外，employee.Dno 包含员工的部门编号。通过加入表格，您可以组合数据。该查询将为每个部门和所有员工返回一行。对于返回的每个员工，部门的信息都是重复的。

[聚合](http://en.wikipedia.org/wiki/Aggregate_function)。_ SQL 知道许多*聚合*函数。如果您选择一个字段或几个字段进行“分组”，您可以使用其他字段进行“聚合”。所以在这种情况下，我按部门名称分组。我之前说过会多次返回部门信息，部门的每个员工一次。现在，此步骤再次对该信息进行*分组*。它只返回一次部门名称，并汇总员工信息。在这种情况下，我使用 AVG 来计算平均工资，但您也可以使用它`SUM(salary)`来获取部门所有员工的总工资，或者`COUNT(*)`统计每个部门的员工人数。

# c++ - 无法将 tomsfastmath 链接到 libtomcrypt

> ID：13783079
> 
> 赞同：6
> 
> 时间：2012-12-08T23:34:22.250
> 
> 标签：c++, cryptography, static-libraries, static-linking

我正在用 C++ 编写一个安全的即时消息程序，使用 libtomcrypt C 库的 RSA 和 SPRNG 函数。我将 libtomcrypt 编译为静态库，并且能够链接到它并运行 sprng 函数并查看和使用它生成的随机数据。

我遇到的问题是尝试使用 rsa_make_key() 函数，该函数依赖于链接的数学库来运行。

在这种情况下，我尝试使用 Tomsfastmath (tfm)，我也尝试将其链接为静态库。这两个库都位于他们自己的项目文件夹中，位于我的项目文件夹上方的一个目录中（即 ../libtomcrypt）

在我的代码中，当我尝试访问 tomsfast 数学描述符“tfm_desc”时出现错误`test_crypt.cpp:8:11: error: 'tfm_desc' was not declared in this scope`。这让我认为 tfm 没有正确链接到 libtomcrypt。我已经阅读了这两件事的文档，它不是很清楚。

我在这里束手无策。我做错了什么？

这是我的制作文件

```
 CC:=gcc #C Compiler
 CFLAGS:=-std=c99 -O0 -I/home/k3rb3ros/csci484-CMU-/libtomcrypt-1.17/src/headers -g -     Wall -Wextra#C Compiler flags
 CPP:=g++ #C++ Compiler
 CPPFLAGS:=-std=gnu++0x -O0 -I/home/k3rb3ros/csci484/csci484-CMU-/libtomcrypt-  1.17/src/headers -L. -g -Wall -Wextra#C++ Compiler flags
 #CPPFLAGS:=-std=gnu++0x -O0 -g -Wall -Wextra #C++ Compiler flags
 LDFLAGS:= -lSDL -lSDL_net -ltfm -ltomcrypt
 CSOURCES= #C files used in this program
 CPPSOURCES=connection.cpp chat.cpp test_crypt.cpp #CPP files used in this prgram
 #COBJECTS=$(CSOURCES:.c=.o)libtfm.a libtomcrypt.a
 COBJECTS=$(CSOURCES:.c=.o)
 CPPOBJECTS=$(CPPSOURCES:.cpp=.o)
 BINARY=down_low

 all: $(BINARY) $(COBJECTS) $(CPPOBJECTS)
 .c.o:
      $(CC) $(CFLAGS) -c $< -o $@

 .cpp.o:
      $(CPP) $(CPPFLAGS) -c $< -o $@

  $(BINARY): $(COBJETS) $(CPPOBJECTS)
      $(CPP) $(CPPFLAGS) $(COBJECTS) $(CPPOBJECTS) -o $@ $(LDFLAGS)

  clean:
     rm -rv $(BINARY) $(COBJECTS) $(CPPOBJECTS) 
```

这是我的 test_crypt 函数

```
#include "headers/test_crypt.h"
using namespace std;

void test_crypt()
{
     int err = 0;
     int rng_idx = -1; //rng index, not sure if I need this
     ltc_mp = tfm_desc; //tell tomcrypt to use toms fast math
     rsa_key pub_key;
     prng_state random_gen;

     if((err = sprng_start(&random_gen)) != CRYPT_OK) //start the rng and check for errors
     {
         cout << "start error " << error_to_string(err) << endl;
     }

     rng_idx = find_prng("sprng");
     if((err = sprng_ready(&random_gen)) != CRYPT_OK)
     {
         cout << "Ready error " << error_to_string(err) << endl;
     }

     //test toms fast math present and working
     //fp_int test;
     //fp_init(&test);

     //sprng_read(entropy, size, &random_gen);

     /*
     if((err = rsa_make_key(NULL,           //PRNG state
                            rng_idx,        //PRNG idx
                            1024/8,         //Size of key
                            65537,          //e
                            &pub_key)       //RSA key
                            ) != CRYPT_OK) //if conditon test
     {
         cout << "RSA Key Generation error " << error_to_string(err) << endl;
     }
     rsa_free(&pub_key); //free the key when we are done with it;
     */
     sprng_done(&random_gen); //done generating random numbers
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T03:45:41.240

添加`-DTFM_DESC`到您的 makefile`CFLAGS`和`CPPFLAGS`变量中，以便标头将声明`tfm_desc`为`extern`变量。

然后`tfm_desc`应该从库中拉入变量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-09T00:44:09.913

您需要在 test_crypt 文件中包含相关标头。

我错误地指出您需要`tfm.h`更早地包括在内。您应该`#include "tomcrypt.h"`改为，因为它应该为您提供所需的常量。

为了澄清 melpomene 所说的内容，您的问题是您没有包含正确的标头，这导致编译器 - 正确地 - 告诉您您正在使用的标识符未声明。

# java - 有没有办法增加代码本身的 Java 堆空间？

> ID：13783086
> 
> 赞同：5
> 
> 时间：2012-12-08T23:35:49.220
> 
> 标签：java, memory, jvm, jvm-arguments

> **可能重复：**
> [是否可以动态更改最大 Java 堆大小？](https://stackoverflow.com/questions/1091566/is-it-possible-to-dynamically-change-maximum-java-heap-size)

我知道 Java 启动器有一个 XMX 选项，但是是否有某种预处理指令来代替它（这样所有运行我的代码的计算机都会增加它们的堆）。

就像现在一样，java.exe 最多只能达到~280MB（在它崩溃之前）——这正常吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-08T23:45:55.473

答案是不”。

内存大小在启动时传递给 JVM。JVM 内部运行的代码无法更改它。

如果你仔细想想，这是有道理的，因为 JVM 是一个不是用 java 编写的程序，它可以执行 java 字节码。允许 Java 代码控制其容器是不安全的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-09T00:00:20.843

如果你可以增加它，它不会是最大值。

它不能增加的原因是它在启动时分配。它只能在 JVM 启动之前设置。

您可以做的是以更高的最大值重新启动应用程序。例如，在开始时检查最大值，如果它不够高，则运行相同的程序，但最大值更高。

注意：如果你使用堆外内存，它可以是 GB 甚至 TB 更多，因为它不是最大值的一部分。

> 就像现在一样，java.exe 最多只能达到~280MB（在它崩溃之前）——这正常吗？

崩溃可能意味着任何事情，原因可能是任何事情。我建议您更详细地调查它为什么不起作用，我怀疑您会发现最大内存不是问题。（除非您有一台 1 GB 的小型机器，在这种情况下，默认最大内存约为 250 MB）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-09T00:04:15.547

> “启动具有更多内存的新进程”可以在代码中完成吗？

是的。请参阅这个简单的示例。

```
import java.awt.EventQueue;
import javax.swing.JOptionPane;
import java.io.File;

class BigMemory {

    public static void main(String[] args) throws Exception {
        if (args.length==0) {
            ProcessBuilder pb = new ProcessBuilder(
                "java",
                "-Xmx1024m",
                "BigMemory",
                "anArgument"
                );
            pb.directory(new File("."));
            Process process = pb.start();
            process.waitFor();
            System.out.println("Exit value: " + process.exitValue());
        } else {
            Runnable r = new Runnable() {
                public void run() {
                    JOptionPane.showMessageDialog(
                        null,
                        "Max Memory: " +
                        Runtime.getRuntime().maxMemory() +
                        " bytes.");
                }
            };
            EventQueue.invokeLater(r);
        }
    }
} 
```

# python - Python - 获取 X 窗口 ID

> ID：13783087
> 
> 赞同：1
> 
> 时间：2012-12-08T23:36:01.973
> 
> 标签：python, user-interface, window, xserver

我正在尝试使用 Python 获取任意窗口的 X 窗口 ID。

理想情况下，脚本将采用与从 shell 运行相同的形式`xwininfo`- 允许用户单击窗口并确定所选窗口的 XID。

我查看了`xwininfo.c`(link [here](http://the-labs.com/Perl/ThePerlJournal/Issue_05_X/xwininfo.c) ) 的来源，但我找不到任何可用于 python 的库来完成相同的工作。

任何帮助将非常感激 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T00:19:00.747

If I was trying to do this I would just use [subprocess](http://docs.python.org/2/library/subprocess.html) or [sh](http://amoffat.github.com/sh/) to run xwininfo from the shell and then grab its output and do whatever you need with it. Is there a reason you want to emulate its behavior rather than just using it?

# c++ - SIGBART 错误向量 >

> ID：13783090
> 
> 赞同：1
> 
> 时间：2012-12-08T23:36:48.907
> 
> 标签：c++, xcode, list, graph, vector

我找不到我的程序引发 SIGBART 错误的原因。

调用此函数时，我已将其范围缩小。

```
bool Node::isEdgeConnected(Node vertex1, Node vertex2){

//I'm not sure if this is the right way to copy this vector <list>
vector<list<Node> > myEdgeList = *edgeList;//edgeList is a private data member of Node

vector<list<Node> >::iterator it;
cout << myEdgeList.size();

for (it = myEdgeList.begin(); it != myEdgeList.end(); it++) {
    list<Node> edge;
    edge = *it;
    Node placeNode = edge.front();

    cout <<placeNode.getNodeId()<<endl;
    list<Node>::iterator eIt;
    for (eIt = edge.begin(); eIt != edge.end(); eIt++) {
        Node placeNode1, placeNode2;
        placeNode1 = edge.front();
        placeNode2 = *eIt;

        cout << placeNode1.getNodeId() << " " << placeNode2.getNodeId()<<endl;
        if(placeNode1.getNodeId() == vertex1.getNodeId() &&
           placeNode2.getNodeId() == vertex2.getNodeId()){
            return true;
        }
    }
}
return false;

} 
```

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T01:06:42.533

您的代码很可能会失败`Node placeNode = edge.front();`，您需要检查是否`edge`为空

```
if (edge.empty()){
   continue;
}
Node placeNode = edge.front(); 
```

顺便说一句，`isEdgeConnected()`功能只是检查里面的节点值`edgeList`，你不需要复制所有元素。如果你`edgeList`的很大，复制会很贵。

例如，你可以`edgeList`直接迭代，也`++iter`比 `iter++ 更高效，看[这个](http://www.parashift.com/c++-faq/increment-pre-post-speed.html)

```
for (vector<list<Node> >::iterator it = edgeList->begin();                                       
     it != edgeList->end(); ++it) {
} 
```

# com - 注册 COM 组件 (interop.Acrobat.dll)

> ID：13783091
> 
> 赞同：1
> 
> 时间：2012-12-08T23:36:50.870
> 
> 标签：com

我见过类似的问题，但似乎没有一个对我有帮助。我是初学者，所以请让它对我来说很简单。我正在尝试使用 Acrobat.dll 将 pdf 文件转换为图像文件我的问题是我不知道如何注册 COM 组件，因为：

1.  Underproperties-->Build-->Register for COM Interop 被禁用（我使用的是 C# express）
2.  使用 regsvr32 + 路径 + 文件名对我不起作用

我想知道为什么互操作被禁用也在属性下-->应用程序-->程序集信息-->使程序集COM可见：已启用

# database - ColdFusion：将标签存储在数据库输出中作为字符串

> ID：13783098
> 
> 赞同：2
> 
> 时间：2012-12-08T23:37:25.807
> 
> 标签：database, coldfusion, evaluate

我正在创建一个 CMS 系统，该系统具有仅使用一页的重写规则。然后从该页面中，我从数据库中提取内容以根据其 url 填充每个页面。这一切都很好，但是，在某些页面上，我还想使用存储在数据库表中的 ColdFusion 标签`<cfif>`等。

当页面呈现时，它将标签输出为 html，而不是 ColdFusion 运行标签。我找到了一种通过使用内容来让它工作的方法`Evaluate()`。但是，阅读此内容显然存在大量性能问题。

因此，我想知道我可以使用哪些其他选项来完成这项工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-08T23:46:46.890

您应该能够将数据写入文件，然后将`<cfinclude>`其包含在您的页面中

未经测试，但这样的东西应该可以工作。

```
<cfset NewFileName = CreateUUID()&'.cfm'>
<cffile action="write" file="YourPath\#NewFileName#" output="#DatabaseInfo#">
<cfinclude template="#NewFileName#">
<cffile action="delete" file="YourPath\#NewFileName#"> 
```

# android - 更改 ArrayAdapter 中的元素

> ID：13783101
> 
> 赞同：2
> 
> 时间：2012-12-08T23:38:06.330
> 
> 标签：android, android-arrayadapter

我有一个 ArrayAdapter 保存更新元素的列表（例如，异步加载的新闻项目列表）。

什么是正确的模式，以便当元素的值发生变化时，它会更新视图？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-08T23:40:50.047

使用 notifyDataSetChanged 在您的 listView 中反映更新

```
adapter.notifyDataSetChanged(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-08T23:42:08.557

您可以使用 , 等方法[`ArrayAdapter#add()`](http://developer.android.com/reference/android/widget/ArrayAdapter.html#add%28T%29)。[`ArrayAdapter#addAll()`](http://developer.android.com/reference/android/widget/ArrayAdapter.html#addAll%28java.util.Collection%3C?%20extends%20T%3E%29)这些方法将自动更新绑定到适配器的视图。

或者，您可以使用适配器读取并调用[`ArrayAdapter#notifyDataSetChanged()`](http://developer.android.com/reference/android/widget/ArrayAdapter.html#notifyDataSetChanged%28%29)自己的 List 上的相同方法。

# javascript - jQuery 将固定或绝对定位的元素向左或向右移动

> ID：13783106
> 
> 赞同：3
> 
> 时间：2012-12-08T23:38:59.487
> 
> 标签：javascript, jquery, css, html

我正在玩一个想法，我想模​​仿 facebook 移动应用程序，其中主要容器元素物理地向左或向右移动。但是，我已经尝试了几种方法，我想要移动的元素似乎在调整大小而不是移动，我不确定它是什么或为什么这样做，而不是按照我期望的方式移动。

注意我已经尝试将主要元素作为固定元素和绝对元素。我也尝试过在 javascript 中只使用“left”或“right”而不是“marginLeft”或“marginRight”。

所以我想知道我做错了什么？

[http://jsfiddle.net/4GF8c/](http://jsfiddle.net/4GF8c/)

的CSS：

```
html, body{margin:0;padding:0;width:100%;height:100%;}
#wrap_main{background-color:gray;position:fixed;top:0;left:0;right:0;bottom:0;z-index:10;}
#wrap_bottom_left{background-color:aqua;width:50%;float:left;}
#wrap_bottom_right{background-color:green;width:50%;float:right;}​ 
```

的JavaScript：

```
 var isMenuOpen = false;
    $(document).ready(function()
    {
    //code
    });
    $('#menu_left_trigger').click(function(e)
    {
        e.preventDefault();
        var $mainEle = $('#wrap_main');
        if(isMenuOpen == false)
        {
            isMenuOpen = true;
            $mainEle.animate({marginLeft:"10%"}, 1000);
        }
        else
        {
            isMenuOpen = false;
            $mainEle.animate({marginLeft:"0"}, 1000);
        }
    });
    $('#menu_right_trigger').click(function(e)
    {
        e.preventDefault();
        var $mainEle = $('#wrap_main');
        if(isMenuOpen == false)
        {
            isMenuOpen = true;
            $mainEle.animate({marginRight:"10%"}, 1000);
        }
        else
        {
            isMenuOpen = false;
            $mainEle.animate({marginRight:"0"}, 1000);
        }
    });
​ 
```

的HTML：

```
<div id="wrap_main">
    <a href="javascript:void(0);" id="menu_left_trigger">Menu</a><br>
    <a href="javascript:void(0);" id="menu_right_trigger">Sub Menu</a>
</div>
<div id="wrap_bottom_left">
    <ul>
        <li>Something</li>
        <li>Something</li>
        <li>Something</li>
        <li>Something</li>
    </ul>
</div>
<div id="wrap_bottom_right">
    <ul>
        <li>Something</li>
        <li>Something</li>
        <li>Something</li>
        <li>Something</li>
    </ul>
</div>​ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T00:44:53.967

呃，好吧。我刚刚解决了我自己的问题。所以我会在这里为那些尝试类似的人分解它。

所以第一个逻辑。我的内容包含“主”元素，如果你称之为绝对/固定位置。这基本上将它与 DOM 分离。意思是基于百分比的高度和宽度不起作用。因此，要创建固定/绝对的全高、全宽元素的效果。我需要告诉元素属性 , `left:`, `right:`, `top:`( `bottom:`css) 全部设置为零，因此 4 个点将在所有方面都接触“0”，基本上将其拉伸以使其适合。

所以。这就是我的问题。通常移动一个固定元素或绝对定位的元素，你会完全按照我的尝试去做。然而，在您设置绝对或固定的几乎所有原因中，您可能只设置左上或右上，或分别设置相同但底部。

因此，由于元素的样式被设置为保持在所有四个点，当我想`x%`在任一方向移动元素或这么多像素时。我必须补偿两个方向，所以如果我想正确使用元素，我需要做`left:10%;right-10%`以补偿两侧的移动。

最终我最终做的是改变，现在整个元素都在移动，而不是无意中调整大小，因为我只告诉一侧移动而不是另一侧移动

希望这对未来的玩家有意义

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-08T23:55:32.863

您需要修复“isMenuOpen”状态。这不是二元测试，而是三向测试。它可以是左开式、右开式或封闭式。您的函数需要能够考虑到这一点，否则它会在 wrap_main div 的一侧设置动画而不设置另一侧。您需要检查当前偏移量并使用它来计算位置应该在哪里。请参见此处：[使用 jQuery .animate 从右到左为 div 设置动画？](https://stackoverflow.com/questions/3042092/using-jquery-animate-to-animate-a-div-from-right-to-left)

对于绝对定位的元素，我建议使用动画左/右定位而不是边距，因为边距可以解释为框模型的一部分（在某些浏览器中）并影响页面上其他项目的布局。执行此操作时，请务必确保链接不会以动画形式出现在视野之外。

编辑：我没有玩够小提琴就解雇了我的答案。这应该使您朝着正确的方向前进。对不起！

# python - 在 QT4 中使用 Python 中的像素图或图像序列制作动画

> ID：13783107
> 
> 赞同：2
> 
> 时间：2012-12-08T23:39:10.313
> 
> 标签：python, qt4

我有一个小的 Python 脚本，它制作了一个透明窗口，用于在屏幕上显示图形，我想为该图形设置动画，但我完全不确定如何或从哪里开始。这是我至少拥有的：

```
import sys
from PyQt4 import QtGui, Qt, QtCore

class Transparent(QtGui.QWidget):

    def __init__(self):
        QtGui.QWidget.__init__(self)
        self.setAttribute(Qt.Qt.WA_NoSystemBackground)
        self.setAutoFillBackground(True)

        pixmap = QtGui.QPixmap("test1.gif")
                pixmap2 = QtGui.QPixmap("test2.gif")
        width = pixmap.width()
        height = pixmap.height()

        self.setWindowTitle("Status")
            self.resize(width, height)

            self.label = QtGui.QLabel(self)

        def animateEvent():
                    imgnumber = 0
                    try:
                        if imgnumber == 1:
                            self.label.setPixmap(QtGui.QPixmap("test1.gif"))
                            self.setMask(pixmap.mask())
                            imgnumber = 0
                        else:
                            self.label.setPixmap(QtGui.QPixmap("test2.gif"))
                            self.setMask(pixmap2.mask())
                            imgnumber = 1
                    finally:
                        QtCore.QTimer.singleShot(1000, animateEvent)

                animateEvent()

        def paintEvent(self,event):
        self.setAttribute(Qt.Qt.WA_NoSystemBackground)

if __name__ == "__main__":
    app = QtGui.QApplication(sys.argv)
    x = Transparent()
    x.show()
    app.exec_() 
```

这感觉就像它具有正确的成分，但像素图没有更新。

我尝试了 QMovie，但随后应该透明的窗口区域被黑色填充。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T00:21:47.637

First, just make sure your animated gif really does have a proper transparent background. The following code works for me, using [this fire image as a source](https://web.archive.org/web/20170327025533/http://i1104.photobucket.com/albums/h329/zorq1/Realistic-fire-animated-transparent-gif.gif):

```
class Transparent(QtGui.QWidget):

    def __init__(self):
        QtGui.QWidget.__init__(self)
        self.setAttribute(QtCore.Qt.WA_NoSystemBackground)
        self.setWindowFlags(QtCore.Qt.FramelessWindowHint)

        filename = "test.gif"

        size = QtGui.QImage(filename).size()

        self.setWindowTitle("Status")

        layout = QtGui.QVBoxLayout(self)
        layout.setMargin(0)

        self.movie = QtGui.QMovie(filename)
        self.label = QtGui.QLabel(self)
        self.label.setMovie(self.movie)

        layout.addWidget(self.label)
        self.resize(size)

        self.movie.start() 
```

This will create a completely transparent and frameless window, with the animated gif playing in a QMovie. There is no black being drawn behind the image. It should fully see through to what ever is underneath.

It is not so far off from your original code. You shouldn't need to set the mask, or do a paint event.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-09T00:22:12.443

check out this code from [www.daniweb.com](http://www.daniweb.com/software-development/python/threads/116827/pyqt-and-gif) and see if you can modify it to your needs:

```
import sys 
from PyQt4.QtCore import *
from PyQt4.QtGui import * 

class MoviePlayer(QWidget): 
    def __init__(self, gif, parent=None): 
        super(MoviePlayer, self).__init__(parent)

        self.setGeometry(200, 200, 400, 400)
        self.setWindowTitle("QMovie to show animated gif")

        self.movie_screen = QLabel()
        self.movie_screen.setSizePolicy(QSizePolicy.Expanding, QSizePolicy.Expanding)        
        self.movie_screen.setAlignment(Qt.AlignCenter) 

        btn_start = QPushButton("Start Animation")
        btn_start.clicked.connect(self.start) 

        btn_stop = QPushButton("Stop Animation")
        btn_stop.clicked.connect(self.stop) 

        main_layout = QVBoxLayout() 
        main_layout.addWidget(self.movie_screen)
        main_layout.addWidget(btn_start) 
        main_layout.addWidget(btn_stop)
        self.setLayout(main_layout) 

        self.movie = QMovie(gif, QByteArray(), self) 
        self.movie.setCacheMode(QMovie.CacheAll) 
        self.movie.setSpeed(100) 
        self.movie_screen.setMovie(self.movie) 

    def start(self):
        """
        Start animation
        """
        self.movie.start()

    def stop(self):
        """
        Stop the animation
        """
        self.movie.stop()

app = QApplication(sys.argv) 
player = MoviePlayer("/path/to/image.gif") 
player.show() 
sys.exit(app.exec_()) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-09T16:16:32.720

这最终只是对疏忽的简单纠正。

`imgnumber`需要在 def as 之外，并且每次更改时都`self.imgnumber`需要命名。`self.imgnumber`

# asp.net-web-api - 简单的 ASP.NET WebApi 参数绑定不起作用

> ID：13783110
> 
> 赞同：1
> 
> 时间：2012-12-08T23:39:41.433
> 
> 标签：asp.net-web-api

我很困惑为什么这适用于我的开发服务器（使用 IIS Express）而不是生产服务器（Win2K8 R2 + IIS 7.5）。

我有一个非常简单的 WebAPI 控制器方法：

```
 public HttpResponseMessage Get(string notificationType = "all", int skip=0, int take=25) {
        Trace.WriteLine(String.Format("Hello, world! From NotifcationsController#Get notificationType={0} skip={1} take={2}", notificationType, skip, take));   
        Trace.WriteLine(String.Format("And furthermore, HttpContext.Current.Request[notificationType]={0}", HttpContext.Current.Request["notificationType"]));
        Trace.WriteLine(String.Format("And finally, HttpContext.Current.Request.QueryString[notificationType]={0}", HttpContext.Current.Request.QueryString["notificationType"]));
      ...
 } 
```

在 的开发服务器上`http://localhost:1398/api/notifications?notificationType=comments`，一切正常。我在 trace.axd 中看到了这一点：

```
 Trace Information
 Category   Message From First(s)   From Last(s)
 Hello, world! From NotifcationsController#Get notificationType=comments skip=0 take=25     
 And furthermore, HttpContext.Current.Request[notificationType]=comments
 And finally, HttpContext.Current.Request.QueryString[notificationType]=comments 
```

但是当`http://api.nameofmywebsite.com/api/notifications?type=comments`我在 trace.axd 中看到这个控制器时：

```
 Trace Information
 Category   Message From First(s)   From Last(s)
 Hello, world! From NotifcationsController#Get notificationType=all skip=0 take=25
 And furthermore, HttpContext.Current.Request[notificationType]=    
 And finally, HttpContext.Current.Request.QueryString[notificationType]=

 ...

 Querystring Collection
 Name   Value
 type   comments 
```

这对我来说似乎非常非常奇怪。根据 trace.axd 中的内容，它似乎肯定不是路由问题……它击中了正确的控制器和操作。

为什么查询字符串参数没有映射到生产环境中控制器操作的参数！？

不管它值多少钱，我在开发和服务器上都使用相同的 web.config。我想不出什么配置差异会导致这种差异......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T00:22:11.263

I'm a moron.

This wasn't working because I was hitting "notifications?type=comments" on the production server and not "notifications?notificationType=comments"

The method parameter name has to match the querystring parameter name for binding to happen. I *knew* that, but didn't realize I was passing in the wrong querystring parameter name! What happened is that I changed the method parameter name a few weeks ago, forgot it in the meantime, and didn't realize the browser's autocomplete function supplied me with a history match that contained the old parameter name.

# php - Doctrine 2“演示”数据 - 用开发数据填充表格

> ID：13783111
> 
> 赞同：1
> 
> 时间：2012-12-08T23:39:53.343
> 
> 标签：php, doctrine-orm, demo

在使用 Doctrine 2 ORM 的应用程序中管理演示（开发）数据的最佳方法是什么？

当我不使用这个 ORM 时，我只是在 MySQL Workbench 中绘制图表，并使用每个表的“插入”选项卡来填充数据。在 Doctrine 2 中，我没有看到这样的选项，但我当然需要它。

那么，请问，实现这一目标的最佳方法是什么？你的方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-10T16:30:26.507

你想听听[Doctrine Fixtures](https://github.com/doctrine/data-fixtures)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-10T18:02:04.103

你想了解[Doctrine Data Fixtures](https://github.com/doctrine/data-fixtures)和[Faker](https://github.com/fzaninotto/Faker) :-)

# matlab - 在 matlab 图上创建指数衰减的光束

> ID：13783114
> 
> 赞同：0
> 
> 时间：2012-12-08T23:40:21.953
> 
> 标签：matlab, plot

我在弄清楚如何在 matlab 的绘图中创建这些梁时遇到了一些麻烦。

![](../Images/d193169d8c469b3b424f8a5955a2b775.png)

我已经创建了这个图形，我需要在添加梁之前使用它，但我不确定如何继续。

光束应以 15 cm 的衰减常数从表面以指数方式衰减（或衰减）。因此，如果表面瓦片`1`在深度处具有能量能量值 ，`i`其中`i`以厘米为单位表示深度，则该值应为`exp(-i/15)`。请注意，梁应覆盖中间正方形的整个范围。

图形：

![](../Images/63a14d8b582155b5f26b9e6679fff86d.png)

我的这个图形的代码：

```
Rows = 30;
Cols = 40;
body = zeros(Rows, Cols);
clims = [-1 1];
imagesc(body, clims);
hold on
x = 0:5:40;
y = 0:5:30;
imagesc(x, y, body)
axis([0 40 0 30])
axis xy
shading flat
colorbar
hold on
plot([18, 22],[13, 13],'k')
hold on
plot([18, 18],[13, 17],'k')
hold on
plot([18, 22],[17, 17],'k')
hold on
plot([22, 22],[13, 17],'k') 
```

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T02:10:59.150

有几种方法可以做到这一点。基本上，您想在绘制它们之前设置身体中的值。这是类似曲线的一个示例，我将让您弄清楚如何将其推断为您的确切需求。

```
Rows = 30;
Cols = 40;
body = zeros(Rows, Cols);
xsize=size(body,1);
ysize=size(body,2);
for x=1:xsize
   for y=1:ysize
      body(x,y)=exp((y-ysize/2)*(x-xsize/2));
   end
end
x = 0:5:40;
y = 0:5:30;
imagesc(x, y, body) 
```

# objective-c - 使用线程时的核心数据问题

> ID：13783118
> 
> 赞同：1
> 
> 时间：2012-12-08T23:40:40.360
> 
> 标签：objective-c, multithreading, core-data, exc-bad-access

我正在做一个爱好项目，我会在业余时间慢慢更新，以帮助学习一些新事物。我遇到的一个绊脚石是在一个单独的线程中使用 Core Data。我已经阅读了 Apple 关于 Core Data concurrency 的文档，并且我阅读的所有内容似乎都很简单，所以我开始更新我的项目以在后台线程上加载数据，因为我不想在加载时锁定 UI。

如果在主线程上加载了 Core Data 对象，该项目可以正常工作。如果我切换到后台加载，它会崩溃。

在这个阶段，我可以验证：

*   NSManagedObject 在线程上加载，我可以访问它的属性
*   将数据输出到标准输出工作正常并且看起来正确。
*   主线程上加载的数据对象和后台线程上加载的数据的二进制比较证明它们是相同的。

当我在 NSData 上调用类别实现时，就会出现实际问题。我可以验证 NSData 对象在后台线程上加载时是否正常，只有当我在加载后调用函数对 NSData 对象进行一些工作时，我才会遇到问题。问题是 EXC_BAD_ACCESS，这通常意味着对象的地址是错误的，但它没有任何意义。

我可能只是得到了一些明显或简单的错误——但我就是只见树木不见森林。

如果您认为您可以就此提供任何建议，因为它让我发疯，那么您可以在此处找到代码：

*编辑帖子答案：已删除 URL，因为项目不再存在。*

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-12T23:08:24.087

好的，我终于找到了问题所在。解压方法超出了线程的堆栈大小，因此导致一个奇怪的随机 EXC_BAD_ACCESS 被触发。

在这种情况下，我原以为调试器会产生更直接的线索。

所以一个有效的“**堆栈溢出**”问题，解决了。

# java - Xuggle 无法打开内存输入

> ID：13783119
> 
> 赞同：6
> 
> 时间：2012-12-08T23:40:41.923
> 
> 标签：java, xuggle

我正在开发一个将 Hadoop 的 MapReduce 框架与 Xuggle 集成的程序。为此，我正在实现一个`IURLProtocolHandlerFactory`从内存中的 Hadoop 数据对象读取和写入的类。

你可以在这里看到相关代码： [https ://gist.github.com/4191668](https://gist.github.com/4191668)

这个想法是用 UUID 注册类`BytesWritable`中的每个对象，`IURLProtocolHandlerFactory` 这样当我稍后在打开文件时引用该名称时，它会返回一个`IURLProtocolHandler`附加到该`BytesWritable`对象的实例，我可以从内存中读取和写入。

问题是我得到这样的异常：

```
java.lang.RuntimeException: could not open: byteswritable:d68ce8fa-c56d-4ff5-bade-a4cfb3f666fe
at com.xuggle.mediatool.MediaReader.open(MediaReader.java:637) 
```

（另请参阅发布的链接下）

调试时，我看到在工厂中正确找到了对象，更重要的是，它们甚至在协议处理程序中被读取。如果我从输出文件中删除侦听器，也会发生同样的情况，所以问题已经出在输入上。深入挖掘 Xuggle 的代码，我找到了 JNI 代码（它试图打开文件），但我没有比这更进一步的了。这显然会返回一个错误代码。

```
XugglerJNI.IContainer_open__SWIG_0 
```

我真的很感激一些提示下一步去哪里，我应该如何继续调试。也许我的实现有缺陷，但我看不到。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T19:37:31.213

我认为您遇到的问题是许多输入/输出类型在 JNI 代码中被转换为本机文件描述符`IContainer`，但您传递的内容无法转换。可能无法以这种方式创建您自己的，因为它会`IURLProtocolHandler`在经过.`XuggleIO.map()``avio_open()`

但是，您*可能会*打开`IContainer`一些不是文件/没有文件描述符的东西，并且可以正确处理。[在IContainer](http://code.google.com/p/xuggle/source/browse/trunk/java/xuggle-xuggler/generated/java/com/xuggle/xuggler/IContainer.java)代码中可以看到可以打开的东西，即`java.io.DataOutput`和`java.io.DataOutputStream`（以及相应的输入）。我建议您制作包含 BytesReadable/BytesWriteable 的 DataInput/DataOutput 实现，并在 IContainer 中打开它。

如果这不起作用，则将您的输入写入临时文件并从临时文件中读取输出:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T11:25:52.587

您可以先将文件复制到本地，然后尝试打开容器：

```
filePath = split.getPath();
final FileSystem fileSystem = filePath.getFileSystem(job);
Path localFile = new Path(filePath.getName());
fileSystem.createNewFile(localFile);
fileSystem.copyToLocalFile(filePath, localFile);
int result = container.open(filePath.getName(), IContainer.Type.READ, null); 
```

此代码适用于 RecordReader 类。

在您的情况下，您可以先将文件复制到本地，然后尝试创建 MediaReader

# php - 将参数设置为函数以对其进行处理

> ID：13783123
> 
> 赞同：0
> 
> 时间：2012-12-08T23:41:12.487
> 
> 标签：php

因此，我需要将参数设置为函数，以便将其转换为 .mp3 文件。使用这一行：`$tts->setText($row['raspuns']);`不会发生任何事情，但如果我编写`$tts->setText("Hello World!");`它可以完美运行，这使我得出结论，我必须找到正确的代码才能使 tts 获取文本。任何人都可以帮助我吗？

```
<html>
    <head>
        <title>
            Bot
        </title>
        <link type="text/css" rel="stylesheet" href="main.css" />
    </head>
    <body>
        <form action="bot.php "method="post">
            <lable>You:<input type="text" name="intrebare"></lable>
            <input type="submit" name="introdu" value="Send">
        </form>
    </body>
</html>
<?php
mysql_connect("localhost", "root", "") or die(mysql_error());
mysql_select_db("robo") or die(mysql_error());

$intrebare=$_POST['intrebare'];
$query = "SELECT * FROM dialog where intrebare = '$intrebare'"; 
$result = mysql_query($query) or die(mysql_error());
$row = $result;
?>

<?php
require "tts.php";
$tts = new TextToSpeech();
**$tts->setText($row['raspuns']);**
*//$tts->setText("Hello World!");*
$tts->saveToFile("voice.mp3");
$file='voice.mp3';
?>

<div id="history">
<?php       

    while (true == ($row = mysql_fetch_array($result))) {
    echo "<b>The robot says: </b><br />";
    echo $row['raspuns'];
    echo "<embed src =\"$file\" hidden=\"true\" autostart=\"true\"></embed>";
}
?>
</div> 
```

这是 tts.php 文件：

```
<?php
class TextToSpeech {
    public $mp3data;
    function __construct($text="") {
        $text = trim($text);
        if(!empty($text)) {
            $text = urlencode($text);
            $this->mp3data = file_get_contents("http://translate.google.com/translate_tts?tl=en&q={$text}");
        }
    }

    function setText($text) {
        $text = trim($text);
        if(!empty($text)) {
            $text = urlencode($text);
            $this->mp3data = file_get_contents("http://translate.google.com/translate_tts?tl=en&q={$text}");
            return  $this->mp3data;
        } else { return false; }
    }

    function saveToFile($filename) {
        $filename = trim($filename);
        if(!empty($filename)) {
            return file_put_contents($filename,$this->mp3data);
        } else { return false; }
    }
}
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-08T23:46:15.520

您需要从结果中获取行

如果您希望您的代码在您的 tts 类调用所在的位置工作，请更改

```
$row = $result; 
```

至

```
$row = mysql_fetch_row($result); 
```

请注意，您在下面有一个代码块，它重新定义了 $row 数组。

另请注意 mysql_* 函数已弃用，请改用 PDO 或 mysqli_ 函数。您当前的代码对 sql 注入是开放的！

# javascript - 我不知道如何解决这个 if 语句

> ID：13783124
> 
> 赞同：0
> 
> 时间：2012-12-08T23:41:34.040
> 
> 标签：javascript

```
var count=1;
var temp="";
var end= window.prompt('enter the length');
var b = parseInt(end);

while(true){
  temp+="-";
  count++;
  if(count>b&&end!=null){
console.log("enter:" +end+ "= " + temp );
break;
 }
} 
```

我有这段代码，假设用户输入的每个数字都给我“-”的输出，所以如果我用户输入 2，则输出应该是“--”。但是当用户输入一个字符串或数字零时，输出应该只是“-”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T00:48:52.170

正如评论所说，这实际上只是一种更简单的做你想做的事情的方法，`isNaN`你需要验证你是否真的得到了一个数字。

```
var length = parseInt(window.prompt('enter the length'), 10);
alert(new Array(isNaN(length) ? 2 : length  + 1).join('-')); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-08T23:47:27.050

```
var count = 1;
var temp = "";
var end = window.prompt('enter the length');
var b = parseInt(end);

while (true) {
    temp += "-";
    count++;

    // if the user entered a valid integer that is not 0
    if (!isNaN(b) && b !== 0) {
        if (count > b && end != null) {
            console.log("enter:" + end + "= " + temp);
            break;
        }

    // else the user entered 0 or some other input that isn't an integer
    } else {
        console.log("enter:" + end + "= -");
        break;
    }
}​ 
```

[**小提琴**](http://jsfiddle.net/zxLw2/10/)

[**摆弄警报**](http://jsfiddle.net/zxLw2/12/)

# css - 画布太高

> ID：13783127
> 
> 赞同：2
> 
> 时间：2012-12-08T23:42:06.883
> 
> 标签：css, canvas, height

我的 CSS：

```
body
{
    margin: 0;
    height: 100%;
}
canvas
{
    background-color: black;
    height: 100%;
    width: 100%;
}
html
{
    height: 100%;
} 
```

如您所见，my`body`分别与窗口的可用高度/宽度一样高/宽。我`canvas`的高度/宽度为 100%，看起来应该是窗口内部的高度和宽度。但事实并非如此。它高了几个像素，并出现了一个滚动条。为什么是这样？我可以让它以某种方式工作吗？我不认为`canvas`有任何填充或任何东西。这发生在 Chrome 和 Firefox 中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-08T23:44:27.177

您还需要：

```
canvas { display: block; } 
```

因为 canvas 是一个内联元素，比如`img`.

内联元素在下面有一些“前导”，就像周围的文本一样。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-08T23:44:35.343

~~浏览器可能会感到困惑：使用滚动条，画布太大而无法容纳。没有它们，它适合。~~

忽略这一点，完全是胡说八道。`<canvas>`是一个内联元素，所以它会遇到与图像相同的问题。添加`verical-align:bottom`，或改为尝试：

```
canvas {
  background: #000;
  position: fixed;
  left:0; right:0; top:0; bottom:0;
} 
```

# java - 在 String 方法中返回时间（int）

> ID：13783129
> 
> 赞同：3
> 
> 时间：2012-12-08T23:42:07.910
> 
> 标签：java, string, int, hour, minute

所以我有这个方法可以返回电视节目结束的时间（例如：21:15），但是当小时或分钟小于 10 时，我需要该方法返回如下内容：21:05。

我试过这样，但是因为 msg1 和 msg2 是 String 类型，所以如果发生其他情况，它们无法返回我的 int。

我能做些什么？有用的信息：我在计算机工程专业的第一年。

```
public static final int ZERO = 0;

 public String endsWhen(){
        String msg1="";
        String msg2="";

        if(fhour<10)
            msg1=ZERO + getFHour();
        else
            msg1=getFHour();  //error here

        if(fmin<10)
            msg2=ZERO+getFMin;
        else
            msg2=getFMin;    //error here

        return  msg1 + ":" + msg2;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-08T23:44:13.520

您不能将 int 原语分配给字符串。假设您的 getFHour() 和 getFMin() 返回 int。尝试：

```
 msg1+=getFHour();  

             msg2+=getFMin; 
```

或者，您还可以使用[**Integer.toString()**](http://docs.oracle.com/javase/7/docs/api/java/lang/Integer.html#toString%28int%29)方法将 int 转换为字符串。

```
 msg1=Integer.toString(getFHour());  

             msg2=Integer.toString(getFMin); 
```

但是，您应该使用[**SimpledateFormater**](http://docs.oracle.com/javase/7/docs/api/java/text/SimpleDateFormat.html)来格式化日期和时间

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-08T23:45:40.637

尝试使用[日期格式化程序](http://docs.oracle.com/javase/7/docs/api/java/text/SimpleDateFormat.html)来格式化电视节目开始的时间。

# java - 匿名类的Java“方法序列化”

> ID：13783134
> 
> 赞同：6
> 
> 时间：2012-12-08T23:42:47.510
> 
> 标签：java, serialization, methods

假设我正在创建一个库，其中提供了一个优先级队列类。用户实例化一个并实现一个 Comparator 接口，然后将其轻轻传递给优先级队列。我想要：

**1.** *授予用户轻松定义 Comparator 类的可能性 - 通过将其实现为匿名类，就像此示例所示：*

```
 PriorityQueue<int> pq = new PriorityQueue<int>();
    pq.setComparator(new Comparator<int>() {
                @Override
                public int compare(int i1, int i2){
                     if(i1 < i2) return -1;
                     else if(i1 > i2) return 1;
                     else return 0;
                }
             };); 
```

**2.** *授予用户序列化和反序列化优先级队列及其附加比较器的可能性。*

**3.** *只使用JDK来实现这个，没有其他外部库*

什么方法最适合实现这一目标？

目前我在反序列化 Comparator 类时遇到问题，更具体地说是创建它的一个实例，因为它在创建它的类中是私有的（“拥有”它）并且它也没有空构造函数（这不是真正的大问题，因为我可以使用它公开的可用构造函数）。

感谢您提前提出任何建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-09T00:08:38.303

记录类，解释要正确序列化队列，比较器应该是可序列化的，最好不是非静态内部类，因为这也会导致其封闭对象的序列化。当然，还要记录在反序列化队列时比较器类必须可用的事实。

`java.util.TreeSet`具有与您所拥有的相同的“问题”：它将比较器作为参数，将其存储为其内部状态的一部分，并且是可序列化的。当您将不可序列化的比较器传递给 TreeSet 构造函数时，FindBugs 会生成警告。

我不认为你能做得比这更好。

# user-interface - 在 Ncurses 中嵌入视频流

> ID：13783137
> 
> 赞同：2
> 
> 时间：2012-12-08T23:43:34.097
> 
> 标签：user-interface, video-streaming, ncurses

我真的很喜欢 ncurses 的外观和想法，我想知道是否有办法在 ncurses gui 中包含嵌入的视频流。如果没有，我可以使用任何其他 gui 方法来使我看起来像可用于 python 或 C++ 的 ncurses？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T15:44:50.007

虽然我怀疑你会发现它对任何实际目的有用，但你可以使用[libcaca](http://caca.zoy.org/wiki/libcaca)将视频流嵌入到 ncurses 窗口中（提供了一个[简短的基本教程](http://caca.zoy.org/doxygen/libcaca/libcaca-tutorial.html)，尽管它不讨论视频）。

# java - 在不使用接口的情况下对自定义对象的 Arraylist 进行排序

> ID：13783142
> 
> 赞同：2
> 
> 时间：2012-12-08T23:43:58.970
> 
> 标签：java, sorting, object, arraylist

抱歉，这可能是重复的，我不确定我之前发布的尝试是否通过了。

几周前开始学习 Java，完成了我的第一个任务。:)

我的问题有些基本，但是在查看了以前解决的主题后，我找不到它的完全等价物。这不是现实生活中的问题，所以我想我希望以非常具体的方式解决它。

所以这个任务包括几个步骤——我必须创建一个包含许多自定义对象的超类，添加新的子类，实现新的方法来计算某些变量的值，编写测试类并对我的输出进行排序。

除了最后一步之外，这一切都已完成。不确定我是否可以在网上发布类似的问题，但这是我现在所处的位置：

我有类似的东西：

```
public class Pants
{
public enum SizeType {SMALL, MEDIUM, LARGE, EXTRA_LARGE}
private SizeType size; 
private String brand;
private String countryOfOrigin;
private String color;
private double price;

//Other variables and methods

}

public class Jeans extends Pants  
{ 
//new variables and methods 
}

public class Shorts extends Pants 
{
//some more new variables and methods
} 
```

和其他类似的子类。

```
import java.util.ArrayList;
public class Selection
{
public static void main(String[] args){

    Jeans ex1 = new Jeans("John Lewis");
    ex1.countryOfOrigin("US");
    ex1.color("Navy");
    ex1.setSize(Pants.SizeType.LARGE);
    ex1.setprice(40);
    ex1.machineWashable(true);
    System.out.println(ex1);

    Shorts ex2 = new Shorts("Ted Baker");
    ex2.countryOfOrigin("United Kingdom");
    ex2.color("White");
    ex2.setSize(Pants.SizeType.MEDIUM);
    ex2.setprice(30);
    ex2.machineWashable(true);
    System.out.println(ex2);
//..etc

ArrayList<Pants> selection = new ArrayList<Pants>();
    selection.add(ex1);
    selection.add(ex2);
    selection.add(ex3);
    selection.add(ex4);
    selection.add(ex5);

    System.out.println( "Size - LARGE: " );
    System.out.println();
    Pants.SizeType size;
    size = Pants.SizeType.LARGE;
    ListPants(selection,size); 
```

我需要编写一个 ListPants 方法来根据 SizeType 列出对象 - 在这种情况下从 large 开始。我不认为我可以实现任何额外的接口（这是其他线程中最推荐的）。

请在下面查看我的尝试（无效）。我在这里思考的方向是正确的，还是？

```
public static void ListPants(ArrayList<Pants> selection, Pants.SizeType size)
{
for (Pants.SizeType sizeType : Pants.SizeType.values()) {
    for (Pants pants : selection) {
        if (pants.getSize().equals(sizeType)) {
System.out.println(selection.toString()); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-08T23:56:30.210

我认为这只是你面临的一个小问题。您已经定义了应该打印出特定尺寸的所有裤子的方法的签名：

```
ListPants(ArrayList<Pants> selection, Pants.SizeType size) 
```

那是对的。现在，您的代码正在遍历所有裤子和所有可能的尺寸：

```
public static void ListPants(ArrayList<Pants> selection, Pants.SizeType size)
{
for (Pants.SizeType sizeType : Pants.SizeType.values()) {
    for (Pants pants : selection) {
        if (pants.getSize().equals(sizeType)) {
           System.out.println(selection.toString()); 
```

由于这看起来像是一项家庭作业，我将把我的答案表述为一个问题：

你在哪里使用`size`方法体中的参数`ListPants`？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-08T23:46:54.957

我假设您的类无法实现新接口，并且根本不使用接口。

您可以使用为您的班级构建的[`Collections.sort(List,Comparator)`](http://docs.oracle.com/javase/6/docs/api/java/util/Collections.html#sort%28java.util.List,%20java.util.Comparator%29)a 。[`Comparator`](http://docs.oracle.com/javase/6/docs/api/java/util/Comparator.html)

就像是

```
Collections.sort(selection,new Comparator<Pants>() { 

   @Override
   public int compare(Pants p1, Pants p2) { 
       //implement your compare method in here
       ...
   }
}); 
```

* * *

如果您渴望创建自己的排序算法，请查看此[排序算法列表](http://en.wikipedia.org/wiki/Sorting_algorithm)。最简单的实现（虽然很慢）IMO 是[选择排序](http://en.wikipedia.org/wiki/Selection_sort)

# java - 如何拆分 XML

> ID：13783144
> 
> 赞同：3
> 
> 时间：2012-12-08T23:44:11.733
> 
> 标签：java, xml, xpath, mule, split

我在这里的第一篇文章。我已经搜索但没有找到我要找的东西。

我不确定我需要什么技术来执行以下操作。

我使用 Mule 3.3 CE，我需要拆分 XML 文件。我需要在每个拆分的 XML 中保留“rootElement”及其属性。所有 XML 文件都将放在同一个 JMS 队列中。

我知道如何拆分三个产品节点，但如何在每个 XML 文件中保留“rootElement”？

XPath？XSLT？DOM 并删除和添加节点？我更喜欢 XPath，但它有能力做到这一点吗？

```
<?xml version="1.0" encoding="ISO-8859-1"?>
<rootElement xmlns="http://Ecommerce.com/schemas/loyalist/3"
           preOrderTo="2012-12-31T23:59:59"
           currency="GBP"
           timeStamp="2012-08-15T23:59:59">
  <Product
             itemID="09999-3-"
             name="Plate"
             description="Plate of blue man"
             tax="0.00"
             eanCode="1234567890123"
             eanType="EAN 13"/>
  <priceBracket quantity="1"
            price="10.98"
            grossPrice="13.00"/>
  <Product
             itemID="12345-3-"
             name="Plate"
             description="Plate of black man"
             tax="0.00"
             eanCode="1234569870123"
             eanType="EAN 13"/>
  <priceBracket quantity="1"
            price="15.98"
            grossPrice="18.00"/>
  <Product
             itemID="98765-3-"
             name="Plate"
             description="Plate of yellow man"
             tax="0.00"
             eanCode="7894567890123"
             eanType="EAN 13"/>
  <priceBracket quantity="1"
            price="20.98"
            grossPrice="24.00"/>
</rootElement> 
```

我在 Mule 3.3 CE 中需要的是以下拆分：

1.

```
<?xml version="1.0" encoding="ISO-8859-1"?>
<rootElement xmlns="http://Ecommerce.com/schemas/loyalist/3"
           preOrderTo="2012-12-31T23:59:59"
           currency="GBP"
           timeStamp="2012-08-15T23:59:59">
<Product
             itemID="09999-3-"
             name="Plate"
             description="Plate of blue man"
             tax="0.00"
             eanCode="1234567890123"
             eanType="EAN 13"/>
<priceBracket quantity="1"
            price="10.98"
            grossPrice="13.00"/>
</rootElement> 
```

2.

```
<?xml version="1.0" encoding="ISO-8859-1"?>
<rootElement xmlns="http://Ecommerce.com/schemas/loyalist/3"
           preOrderTo="2012-12-31T23:59:59"
           currency="GBP"
           timeStamp="2012-08-15T23:59:59">
  <Product
             itemID="12345-3-"
             name="Plate"
             description="Plate of black man"
             tax="0.00"
             eanCode="1234569870123"
             eanType="EAN 13"/>
  <priceBracket quantity="1"
            price="15.98"
            grossPrice="18.00"/>
</rootElement> 
```

3.

```
<?xml version="1.0" encoding="ISO-8859-1"?>
<rootElement xmlns="http://Ecommerce.com/schemas/loyalist/3"
           preOrderTo="2012-12-31T23:59:59"
           currency="GBP"
           timeStamp="2012-08-15T23:59:59">
  <Product
             itemID="98765-3-"
             name="Plate"
             description="Plate of yellow man"
             tax="0.00"
             eanCode="7894567890123"
             eanType="EAN 13"/>
  <priceBracket quantity="1"
            price="20.98"
            grossPrice="24.00"/>
</rootElement> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-08T23:51:20.767

用 XPath 拆分然后用 XSLT 转换器用 rootElement 包装每个结果怎么样？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-09T00:10:12.493

如果您可以使用 XSLT 2.0，这里有一种方法...

**XML 输入**

```
<rootElement xmlns="http://Ecommerce.com/schemas/loyalist/3"
    preOrderTo="2012-12-31T23:59:59"
    currency="GBP"
    timeStamp="2012-08-15T23:59:59">
    <Product
        itemID="09999-3-"
        name="Plate"
        description="Plate of blue man"
        tax="0.00"
        eanCode="1234567890123"
        eanType="EAN 13"/>
    <priceBracket quantity="1"
        price="10.98"
        grossPrice="13.00"/>
    <Product
        itemID="12345-3-"
        name="Plate"
        description="Plate of black man"
        tax="0.00"
        eanCode="1234569870123"
        eanType="EAN 13"/>
    <priceBracket quantity="1"
        price="15.98"
        grossPrice="18.00"/>
    <Product
        itemID="98765-3-"
        name="Plate"
        description="Plate of yellow man"
        tax="0.00"
        eanCode="7894567890123"
        eanType="EAN 13"/>
    <priceBracket quantity="1"
        price="20.98"
        grossPrice="24.00"/>
</rootElement> 
```

**XSLT 2.0**

```
<xsl:stylesheet version="2.0" 
    xpath-default-namespace="http://Ecommerce.com/schemas/loyalist/3" 
    xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:output indent="yes"/>
    <xsl:strip-space elements="*"/>

    <xsl:template match="@*|node()">
        <xsl:copy>
            <xsl:apply-templates select="@*|node()"/>
        </xsl:copy>
    </xsl:template>

    <xsl:template match="/*">
        <xsl:apply-templates select="*"/>
    </xsl:template>

    <xsl:template match="Product">
        <xsl:result-document href="{@itemID}.xml">
            <xsl:element name="{/*/name()}" 
                namespace="http://Ecommerce.com/schemas/loyalist/3">
                <xsl:copy-of select="/*/@*|.|following-sibling::priceBracket[1]"/>
            </xsl:element>
        </xsl:result-document>
    </xsl:template>

</xsl:stylesheet> 
```

生成的 XML 文件（名称基于产品的 itemID，但可以轻松更改）...

**09999-3-.xml**

```
<rootElement xmlns="http://Ecommerce.com/schemas/loyalist/3"
             preOrderTo="2012-12-31T23:59:59"
             currency="GBP"
             timeStamp="2012-08-15T23:59:59">
   <Product itemID="09999-3-"
            name="Plate"
            description="Plate of blue man"
            tax="0.00"
            eanCode="1234567890123"
            eanType="EAN 13"/>
   <priceBracket quantity="1" price="10.98" grossPrice="13.00"/>
</rootElement> 
```

**12345-3-.xml**

```
<rootElement xmlns="http://Ecommerce.com/schemas/loyalist/3"
             preOrderTo="2012-12-31T23:59:59"
             currency="GBP"
             timeStamp="2012-08-15T23:59:59">
   <Product itemID="12345-3-"
            name="Plate"
            description="Plate of black man"
            tax="0.00"
            eanCode="1234569870123"
            eanType="EAN 13"/>
   <priceBracket quantity="1" price="15.98" grossPrice="18.00"/>
</rootElement> 
```

**98765-3-.xml**

```
<rootElement xmlns="http://Ecommerce.com/schemas/loyalist/3"
             preOrderTo="2012-12-31T23:59:59"
             currency="GBP"
             timeStamp="2012-08-15T23:59:59">
   <Product itemID="98765-3-"
            name="Plate"
            description="Plate of yellow man"
            tax="0.00"
            eanCode="7894567890123"
            eanType="EAN 13"/>
   <priceBracket quantity="1" price="20.98" grossPrice="24.00"/>
</rootElement> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-05-05T15:21:38.817

使用拆分器组件并在 set payload 中添加根元素

```
<root>#[payload]</root> 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2016-05-04T21:34:15.197

[下面是使用vtd-xml](http://vtd-xml.sf.net)编码拆分文档的代码，大约 20 行代码......

```
import com.ximpleware.*;
import java.io.*;
public class simpleSplit {
    public static void main(String[] s) throws VTDException, IOException{
        VTDGen vg = new VTDGen();
        if (!vg.parseFile("input.xml", true)) //namespace awareness disabled
            return;
        VTDNav vn = vg.getNav();
        AutoPilot ap = new AutoPilot(vn);
        XMLModifier xm = new XMLModifier(vn);
        ap.selectXPath("/rootElement/product");
        int i=0,j=1;
        byte[] ba1 = ("<?xml version=\"1.0\" encoding=\"ISO-8859-1\"?>"+
                      "<rootElement xmlns=\"http://Ecommerce.com/schemas/loyalist/3\""+
                      "preOrderTo=\"2012-12-31T23:59:59\""+
                      "currency=\"GBP\""+
                      "timeStamp=\"2012-08-15T23:59:59\">\n").getBytes();
        byte[] ba =   "\n".getBytes();
        byte[] ba2 = "\n</rootElement>".getBytes();
        while((i=ap.evalXPath())!=-1){
            FileOutputStream fios = new FileOutputStream("file"+j+".xml");
            fios.write(ba1);//write starting tag
            vn.dumpFragment(fios);// write the product fragment
            fios.write(ba);
            if (vn.toElement(VTDNav.NEXT_SIBLING,"priceBracket")){
                // write the priceBracket fragment
                vn.dumpFragment(fios);
                vn.toElement(VTDNav.PREV_SIBLING);
            }
            fios.write(ba2);// write ending tag
            j++;
        }
    }
} 
```

# java - 如何检查整个组件是否在屏幕上？

> ID：13783149
> 
> 赞同：0
> 
> 时间：2012-12-08T23:44:37.893
> 
> 标签：java, swing, components, bounds, swingutilities

我正在使用包含自定义弹出窗口的 3rd 方插件。此弹窗被添加到选项卡窗格中，当它出现时，如果靠近 JFrame 边框，则只有一部分会出现，其余部分将退出屏幕，就好像它在 JFrame 后面一样。

无论如何检查组件边界或其形状是否对用户完全可见？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-08T23:54:24.060

查看[SwingUtilities.convertPointToScreen](http://docs.oracle.com/javase/1.4.2/docs/api/javax/swing/SwingUtilities.html#convertPointToScreen%28java.awt.Point,%20java.awt.Component%29)的 javadocs 。

# php - 如何在jquery中以json格式获取数据时浮动数字？

> ID：13783150
> 
> 赞同：0
> 
> 时间：2012-12-08T23:44:59.173
> 
> 标签：php, javascript, jquery, json

我的问题是要在 jquery 中浮动数字。我在这个网站上查看了其他关于它的问题，但我找不到我看的那个。

在我的部分代码中，我使用`$.post`了 jquery。我向数据库发送请求并以`json`格式获取数据。在我的数据库中，一些数字的格式类似于 345,54565000000。所以，我想在逗号后浮动 5 位数字。

我的部分代码是：

```
$.post("http://localhost/ajax.php",
      function(data) {
          var listdata;
          $.each(data, function(i,item){

              listdata += "<td>"+item.number+"</td>";

          });

            $(".result).empty().html(listdata);

    },"json"
); 
```

我的一些试验是这样的：（这是行不通的）

1.)

```
var number = (item.number).toFixed(5);
listdata += "<td>"+number+"</td>"; 
```

2.)

```
var number=item.number;
var new_number = number.toFixed(5);
listdata += "<td>"+new_number+"</td>"; 
```

谢谢您的回复。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-08T23:56:05.290

```
var number = 345.54565000000​;

var parsedNumber = parseFloat(parseInt(number*100000,10)/100000); 
```

[**小提琴**](http://jsfiddle.net/ASwjf/);

如果该分隔符实际上是逗号，则必须将其替换为`.replace(',', '.')`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-08T23:48:59.607

我使用这个功能：

```
function roundNumber(number,decimals) {
    var newString;// The new rounded number
    decimals = Number(decimals);
    if (decimals < 1) {
        newString = (Math.round(number)).toString();
    } else {
        var numString = number.toString();
        if (numString.lastIndexOf(".") == -1) {// If there is no decimal point
            numString += ".";// give it one at the end
        }
        var cutoff = numString.lastIndexOf(".") + decimals;// The point at which to truncate the number
        var d1 = Number(numString.substring(cutoff,cutoff+1));// The value of the last decimal place that we'll end up with
        var d2 = Number(numString.substring(cutoff+1,cutoff+2));// The next decimal, after the last one we want
        if (d2 >= 5) {// Do we need to round up at all? If not, the string will just be truncated
            if (d1 == 9 && cutoff > 0) {// If the last digit is 9, find a new cutoff point
                while (cutoff > 0 && (d1 == 9 || isNaN(d1))) {
                    if (d1 != ".") {
                        cutoff -= 1;
                        d1 = Number(numString.substring(cutoff,cutoff+1));
                    } else {
                        cutoff -= 1;
                    }
                }
            }
            d1 += 1;
        } 
        newString = numString.substring(0,cutoff) + d1.toString();
    }
    if (newString.lastIndexOf(".") == -1) {// Do this again, to the new string
        newString += ".";
    }
    var decs = (newString.substring(newString.lastIndexOf(".")+1)).length;
    for(var i=0;i<decimals-decs;i++) newString += "0";
    return newString;
} 
```

因此，在您的代码中，将第 6 行更改为：

```
listdata += "<td>"+ roundNumber(item.number, 5) +"</td>"; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-08T23:56:52.777

我假设你有逗号，并且你想坚持使用逗号，这样会破坏任何与 Float 相关的功能，所以......快速而肮脏，但可以完成工作：

**代替**

```
listdata += "<td>"+item.number+"</td>"; 
```

**和**

```
listdata += "<td>"+parseFloat(item.number.replace(',', '.')).toFixed(5).replace('.', ',')+"</td>"; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-09T00:05:37.607

我发现的禁食方式是

```
((number * Math.pow(10, numberOfDigits)) | 0) / Math.pow(10, numberOfDigits) 
```

编辑：忘记了 Math.pow，这很重要。

# c++ - scons ParseConfig 在 Windows 上的 wx-config 行为不正确

> ID：13783151
> 
> 赞同：4
> 
> 时间：2012-12-08T23:45:25.033
> 
> 标签：c++, python, mingw, wxwidgets, scons

我正在尝试使用 MinGW 在 Windows 上使用 wx-widgets 和 scons。这是我的 SConstruct 的违规行：

```
env.ParseConfig("wx-config --cxxflags --libs") 
```

紧接着，打印 env['CPPPATH'] 给出：

```
['C:software_libwxWidgets2.8libgcc_dllmsw', 'C:software_libwxWidgets2.8include'] 
```

显然，它似乎缺少一些非常重要的斜线。我认为这可能与 wx-config 的 windows 端口在其输出中给出反斜杠有关。

这些路径稍后会逐字传递给编译器，从而导致错误。其他一切都很好。

我可以做些什么来解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-15T16:00:33.267

用蛮力解决了这个问题。编写了一个辅助 python 脚本，包含以下内容：

```
import subprocess, sys

p = subprocess.Popen(["wx-config", "--cxxflags", "--libs"], stdout=subprocess.PIPE)
out, err = p.communicate()

san = out.replace("\\", "/")

sys.stdout.write(san)
sys.exit(0) 
```

最后打电话

```
env.ParseConfig("python sanitize-wx-config.py") 
```

在 SConscript 文件中。这解决了问题：

# operating-system - 内存保护属性

> ID：13783153
> 
> 赞同：1
> 
> 时间：2012-12-08T23:45:29.760
> 
> 标签：operating-system

一个典型的进程由 4 个内存区域组成，文本、数据、堆和堆栈。他们每个人都有什么保护属性？

谢谢乔什

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-08T23:49:32.577

这因操作系统而异，因此不可能有普遍有效的答案，但通常看起来像这样：

*   文本 - 读取 - 执行
*   数据 - 读取
*   堆 - 读写
*   堆栈 - 读写

较旧的操作系统可能具有可写的文本和数据（某些硬件也不允许区分读取和读取执行）。此外，某些操作系统会允许您随意更改此设置，而其他操作系统则不会（或会有一些限制，例如不允许您将之前“写入”的内容设置为“执行”）。

# html - 嵌套类的 CSS 选择器

> ID：13783161
> 
> 赞同：2
> 
> 时间：2012-12-08T23:46:33.287
> 
> 标签：html, css, css-selectors

我用这个简单的方法打破了我的头？问题。我知道它不是错误也不是跨浏览器问题，在 Firefox 和 Internet Explorer 上进行了测试。只是我不明白为什么它会以这种方式解决。

```
<!DOCTYPE HTML>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>Untitled Document</title>
<style type="text/css">
    .red_class { color: red; }
    .blue_class {color: blue;}
</style>
</head>

<body>

<div class="red_class">
  <a class="blue_class" href="http://somesite.com">Somesite</a>
</div>
</body>
</html> 
```

在我看来，这两个规则具有相同的特异性，所以我希望链接显示为蓝色，因为 blue_class 规则更接近，但链接显示为红色。我实际上更改了顺序，以便首先编写“.blue_class”规则，但它并没有改变结果

我找到了一些使代码工作的方法，例如使第二条规则更具体，例如：

```
.red_class a.blue_class {color: blue;} 
```

但我真的很想了解为什么这不能按我的预期工作，也就是说，如果链接有一个 blue_class 类，它应该显示为蓝色。

非常感谢您的帮助。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T02:22:03.793

实际上，我看不到您如何获得红色链接...

带有定义的锚元素`href`不继承类似`color`or的属性`text-decoration`，所以你得到的结果有点奇怪。

[http://www.w3.org/TR/html401/struct/links.html#h-12.2](http://www.w3.org/TR/html401/struct/links.html#h-12.2)

> 用户代理通常以使用户明显的方式呈现链接（下划线、反向视频等）。确切的渲染取决于用户代理。渲染可能会根据用户是否已经访问过链接而有所不同。

因此，这会产生一个默认样式的锚：

```
.red_class{color:red;}

<div class="red_class">
    <a href="#">Something</a>
</div> 
```

在这种情况下，锚继承了红色：

```
.red_class{color:red;}

<div class="red_class">
    <a>Something</a>
</div> 
```

我真的不明白这个问题，但至少这是对锚样式如何工作的解释。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-10T11:20:42.747

@Luxfer 这只是我做的一件简单的事情。为您的**Firefox**下载**Firebug 插件**。**检查**要赋予样式的**元素。**在**Firebug的****右侧**，有一个框，您可以在其中看到**使用的 CSS**。只需**右键单击**CSS 窗格，您将在其中找到一个选项**Add Rule**。当您**单击**它时，它将采用将完美定位所需元素的选择器。

 ******* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-10T11:28:06.847

你确定它不起作用吗？蓝色不是一个很好的测试颜色，因为大多数浏览器默认为蓝色作为 hrefs。

```
<div class="red_class">
  <a class="green_class" href="http://somesite.com">Somesite</a>
    <p>More Text</p>
</div> 
```

和

```
.red_class { color: red; }
.green_class {color: green;} 
```

似乎在这里的 Chrome 中工作正常。
[**----演示-----**](http://jsfiddle.net/NotInUse/9AZvK/7/)******

# xcode - 由于未跟踪的工作树文件导致 git branch checkout 问题

> ID：13783168
> 
> 赞同：8
> 
> 时间：2012-12-08T23:47:27.610
> 
> 标签：xcode, git, version-control

我以为我已经把 Xcode + git 问题的日子抛在脑后了。可能不会。尝试签出另一个分支时出现此 git 错误。

```
error: The following untracked working tree files would be overwritten by checkout:
    RCAlpha.xcodeproj/project.xcworkspace/xcuserdata/andrewjl.xcuserdatad/UserInterfaceState.xcuserstate
    RCAlpha.xcodeproj/xcuserdata/andrewjl.xcuserdatad/xcschemes/RCAlpha.xcscheme
    RCAlpha.xcodeproj/xcuserdata/andrewjl.xcuserdatad/xcschemes/xcschememanagement.plist
Please move or remove them before you can switch branches.
Aborting 
```

我说得很好，让我删除这些文件：

```
andrewjl$ git rm --cached RCAlpha.xcodeproj/project.xcworkspace/xcuserdata/andrewjl.xcuserdatad/UserInterfaceState.xcuserstate
fatal: pathspec 'RCAlpha.xcodeproj/project.xcworkspace/xcuserdata/andrewjl.xcuserdatad/UserInterfaceState.xcuserstate' did not match any files 
```

在这一点上，我不知道该怎么做。这些文件都在我的列表中`.gitignore`，我也`git clean -f -d`试了一下。没有骰子。有人知道这里发生了什么吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-08T23:49:58.423

文件未跟踪：`git rm --cached`找不到它们，因为索引中没有。只需使用您的文件管理器或`rm`. 然后结帐应该按预期工作。请注意，`git status`它将向您显示 git 将文件视为什么（已跟踪、已更改、未跟踪；使用附加选项，它还将显示被忽略的文件）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-08T23:50:54.037

它们不在 git 中，但在本地.. 这意味着当您切换时，它们会丢失，而 git 不允许这样做

在本地删除它们：

```
rm RCAlpha.xcodeproj/project.xcworkspace/xcuserdata/andrewjl.xcuserdatad/UserInterfaceState.xcuserstate RCAlpha.xcodeproj/xcuserdata/andrewjl.xcuserdatad/xcschemes/RCAlpha.xcscheme RCAlpha.xcodeproj/xcuserdata/andrewjl.xcuserdatad/xcschemes/xcschememanagement.plist 
```

无论如何，它们都是由 xcode 重新创建的。里面没什么重要的！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-09-27T18:12:56.783

试试这个

git rm --cache */xcschemes/xcschememanagement.plist

git commit -m "再见 xcschememanagement.plist"

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-05-30T02:57:12.367

Git stash 和 git checkout "yourBranch"

# php - PHP/SQL - 不会将新用户插入表中

> ID：13783173
> 
> 赞同：-2
> 
> 时间：2012-12-08T23:49:34.773
> 
> 标签：php, sql, sqlite, insert

我的问题是我的脚本不会将新的用户信息插入到我的数据库表中。我不知道为什么，我一直在看这个将近 3 个小时，试图找到问题，但我似乎无法找到它。这是我的脚本（顺便说一句，SQLITE 3）：

```
 $db = sqlite_open("../../kinz/kinz-db.sqlite", 0666, $sqlerr);

$query_login = sqlite_query($db, "SELECT * FROM USERS WHERE USER = '$user'");
$result = sqlite_fetch_all($query_login, SQLITE_ASSOC);

$query_setId = sqlite_query($db, "SELECT * FROM USERS WHERE ID = (SELECT MAX(ID) FROM USERS)", $sqlerr);
$result2 = sqlite_fetch_all($query_setId, SQLITE_ASSOC);
$ID = $result2[0][ID] + 1;

if (count($result) >= 1) {
    $_SESSION['regErr'] = "Username already in use";
    header("Location: register.php");
    exit();
} else {
    /*This is the registration query*/$query_register = sqlite_query($db, "INSERT INTO USERS (ID, USER, DISPLAY_NAME, PASS_ENC1, PASS_ENC2) VALUES ($ID, '$user', '$displayName', '$pass_enc1', '$pass_enc2')", $sqlerr);
}

if (!$query_register) {
    $_SESSION['regErr'] = $sqlerr;
    header("Location: register.php");
    exit();
} else {
    $_SESSION['regSuccess'] = true;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T00:27:37.943

由于 INSERT 是一条无结果的 SQL 语句，因此您可能应该使用[sqlite_exec()](http://php.net/manual/en/function.sqlite-exec.php)而不是 sqlite_query()。

如果 sqlite_query() 或 sqlite_exec() 返回 FALSE，您还应该报告*发生的*错误。您不必输出给用户，而是输出到您可以阅读的地方。目前您只将它存储在 $_SESSION 中，这可能很难访问。

我会这样写：

```
$query_register = sqlite_exec($db, "INSERT INTO USERS 
    (ID, USER, DISPLAY_NAME, PASS_ENC1, PASS_ENC2) VALUES 
    ($ID, '$user', '$displayName', '$pass_enc1', '$pass_enc2')", $sqlerr);

if ($query_register === false) {
    error_log("Sqlite error in file ".__FILE__." on line ".__LINE__.": "
    . $sqlerr);
} 
```

此外，我没有看到您在将[变量](http://php.net/manual/en/function.sqlite-escape-string.php)插入 INSERT 语句之前转义它们。您需要小心避免 SQL 注入漏洞。

或者升级到 SQLite3 API，它支持带参数的[预处理语句。](http://php.net/manual/en/sqlite3.prepare.php)在编写动态查询时，这对于防止 SQL 注入更加安全。

[PDO_sqlite](http://php.net/manual/en/ref.pdo-sqlite.php)也支持预处理语句，我推荐使用 PDO。

# matrix - 反对角矩阵并行

> ID：13783174
> 
> 赞同：2
> 
> 时间：2012-12-08T23:49:56.657
> 
> 标签：matrix, parallel-processing, cuda, gpu

如何交叉矩阵的对角线并同时计算对角线元素？

如何在 CUDA 中循环对角线的元素？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T03:33:54.387

如果您指的是如何循环从左下角到右上角的最大对角线，那么一种方法是将您的对角线变成一个数组。因为，您可能希望在此对角线下方的 GPU 内进行一些计算，在将数据从 CPU 复制到 GPU 之前，您可以执行以下操作：

```
double diagonal [N];

for(int i = N - 1, j = 0; i >= 0, j < N ; i--, j++)
       diagonal = matrix[i][j]; 
```

然后，您只需将大小为 N 的数组对角线（在一个大小为 N^2 的矩阵中）发送到 GPU，而不是整个矩阵。

如果您想将整个矩阵发送到 gpu 并仅对 gpu 内的对角线执行操作，您可以执行以下操作：

```
__global__ gpuKernell(double **matrix, int N)
{
 int thread_id = blockIdx.x * blockDim.x + threadIdx.x;

    while(thread_id < N)
    {
       matrix[N-1-thread_id][thread_id] = // do something
       thread_id += blockDim.x * gridDim.x; 
    }
} 
```

# wordpress - 侧边栏中的循环执行不正确？

> ID：13783179
> 
> 赞同：0
> 
> 时间：2012-12-08T23:50:32.323
> 
> 标签：wordpress

我正在尝试在侧边栏中添加“电影评论”部分，但它也改变了我的主循环。这是我的代码：

```
//Movie All Reviews
function display_movie_reviews( $query ) {
    if ( $query->is_category('movies') ) {
        $query->set( 'tag', 'movie-reviews' );
    }
}
add_action( 'pre_get_posts', 'display_movie_reviews' ); 
```

它正在显示我想要的评论，但类别页面`site.com/movies/`仅显示评论

这是侧边栏的循环：

```
<ul>
    <?php if ( have_posts() ) : ?>
    <?php /* Start the Loop */ ?>
    <?php add_action( 'pre_get_posts', 'display_movie_reviews' ); ?>
    <?php while ( have_posts() ) : the_post(); ?>
    <?php get_template_part( 'sidebar-reviews', get_post_format() ); ?>
    <?php endwhile; ?>
    <?php else : ?>
    <?php get_template_part( 'no-results', 'index' ); ?>
    <?php endif; ?>
</ul> 
```

和`sidebar-reviews`：

```
<li>
    <a class="sidebar-thumb" href="<?php the_permalink(); ?>"><?php the_post_thumbnail( 'sidebar-thumb',array('title' => "")); ?></a>       
    <div class="sidebar-text">
        <a class="sidebar-link" href="<?php the_permalink(); ?>"><?php the_title(); ?></a>
        <span class="sidebar-rating"><!-- rating here --></span>
    </div>
</li> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T02:28:37.887

试试`wp_reset_query();` [http://codex.wordpress.org/Function_Reference/wp_reset_query](http://codex.wordpress.org/Function_Reference/wp_reset_query)

> 此函数会破坏在自定义循环上使用的先前查询。应在循环之后调用函数以确保条件标签按预期工作。

# join - 限制 solr 子查询/连接上的行

> ID：13783180
> 
> 赞同：1
> 
> 时间：2012-12-08T23:50:43.413
> 
> 标签：join, solr, subquery

我想在 solr 上搜索 500 种畅销产品，然后仅对这 500 种产品进行搜索/过滤

在 SQL 中，我会这样做：

```
SELECT * FROM Product
WHERE ProductID IN (SELECT TOP 500 ProductID FROM Product ORDER BY Sales DESC)
AND Manufacturer = 'Apple' 
```

我知道我可以在 solr 中进行连接/子查询，但我似乎无法弄清楚如何在将这些子查询的行输入到主查询之前对其进行排序和限制。

这在solr中可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T09:21:41.720

您可能不需要任何联接或子查询。
您将使用销售信息为产品编制索引。

您只需要执行 Solr 查询：-

```
q=manufacturer:apple&sort=sales desc&limit=500 
```

或者

```
fq=manufacturer:apple&sort=sales desc&limit=500 
```

这将搜索苹果的制造字段，以降序返回按销售额排序的结果集并将行限制为 500。
获取 500 可能不是一个好主意，您始终可以使用行和限制进行分页。
在客户端可以处理仅显示 500 个结果的限制。

# dart - 包 'unittest' 依赖于源 'sdk' 和 'hosted' 是什么意思？

> ID：13783182
> 
> 赞同：9
> 
> 时间：2012-12-08T23:51:11.180
> 
> 标签：dart

我有一个这样的 pubspec.yaml 文件：

```
name: My App
dependencies:
  unittest: { sdk: unittest }
  json_object:
    git:
      url: git://github.com/chrisbu/dartwatch-JsonObject.git 
```

（这里我只是以 JsonObject 为例）

当我运行时，`pub install`我收到此错误：

```
Package 'unittest' is depended on from both sources 'sdk' and 'hosted' 
```

这是什么意思，我该如何解决？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-08T23:51:11.180

Dart 包管理器 Pub 按名称*以及它们的来源来*识别包。如果 pub 检测到两个具有相同名称的包，但来自两个不同的来源，它将抛出一个错误，例如“Package foo isdependend on both sources 'sdk' and 'hosted'”

要解决此问题，您需要确保所有依赖项都引用具有相同源的相同包。

正确的解决方案是让每个包停止使用`sdk`源代码，因为所有 SDK 包现在都托管在 pub.dartlang.org 中。

你应该改变：

```
dependencies:
  unittest: { sdk: test } 
```

进入这个：

```
dependencies:
  unittest: any 
```

意思是“来自 pub.dartlang.org的`any`任何版本”

以下软件包现在位于它们的新规范主页 pub 中：

*   参数
*   http
*   国际
*   日志记录
*   元
*   oauth2
*   单元测试
*   网络驱动程序

如果您使用上述任何包，请在您的 pubspec.yaml 文件中使用，`foo: any`而不是。`{sdk: foo}`

现在，作为开发人员，您当然可以更新自己的 pubspec.yaml，但您可能无法控制您的 3rd 方依赖项。我建议您通过电子邮件（您可以从 pub.dartlang.org 获得）联系您的包的作者，要求他们更新以使用像 unittest 这样的托管包。

[在http://news.dartlang.org/2012/12/sdk-packages-now-available-on-pub.html](http://news.dartlang.org/2012/12/sdk-packages-now-available-on-pub.html)查看更多信息

# iphone - 带有 Facebook 图像的慢速 UITableView

> ID：13783183
> 
> 赞同：0
> 
> 时间：2012-12-08T23:51:12.553
> 
> 标签：iphone, ios, uitableview, facebook-graph-api, grand-central-dispatch

我有一个 uitableview，每个单元格都有一个来自 facebook 图像配置文件和 2 个 uilabels 的图像（来自单例，不是互联网请求）

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath*)indexPath
{
    static NSString *CellIdentifier = @"MenuCell";
    MenuCellViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier forIndexPath:indexPath];
    if (cell == nil) {
        cell = [[MenuCellViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];
    }

    //Singleton
    DataModel *m = [DataModel getModel];
    switch ([indexPath section]) {
        case 0: //Only Header
            break;

        case 1: //My cells
        {
            //If footer - set footer background
            if (indexPath.row == [tableView numberOfRowsInSection:indexPath.section] - 1){
               [cell setBackgroundView:[[UIImageView alloc]initWithImage:[UIImage imageNamed:@"imgFooter.png"]]];
            //Else - set normal cell background
            } else {
                [cell setBackgroundView:[[UIImageView alloc]initWithImage:[UIImage imageNamed:@"img.png"]]];
            }

            //Get Facebook image
            strForImg = [[NSString alloc] initWithFormat:@"https://graph.facebook.com/%@/picture?type=square",[[[m list] objectAtIndex:indexPath.row] objectForKey:@"id"]];    
            url =[NSURL URLWithString:strForImg];
            img = [UIImage imageWithData: [NSData dataWithContentsOfURL:url]];
            [cell.imgProfile setImage:img];

            //Set some text (uilabels)
            cell.lblNom.text = [[[m list] objectAtIndex:indexPath.row] objectForKey:@"name"];
            cell.lblTour.text = [[[m list] objectAtIndex:indexPath.row] objectForKey:@"description"];
            break;
        }
    }
} 
```

这段代码非常慢，并且在从 facebook 动态加载每个单元格的配置文件图像时冻结了 tableview。

我尝试使用这样的调度

```
case 1://My cells
    {
        if (indexPath.row == [tableView numberOfRowsInSection:indexPath.section] - 1){
           [cell setBackgroundView:[[UIImageView alloc]initWithImage:[UIImage imageNamed:@"imgFooter.png"]]];
        } else {
            [cell setBackgroundView:[[UIImageView alloc]initWithImage:[UIImage imageNamed:@"img.png"]]];
        }

        dispatch_queue_t queue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_HIGH, 0ul);
        dispatch_async(queue, ^{
            dispatch_sync(dispatch_get_main_queue(), ^{
                strForImg = [[NSString alloc] initWithFormat:@"https://graph.facebook.com/%@/picture?type=square",[[list objectAtIndex:indexPath.row] objectForKey:@"id"]];

                url =[NSURL URLWithString:strForImg];
                img = [UIImage imageWithData: [NSData dataWithContentsOfURL:url]];
                [cell.imgProfile setImage:img];

            });
        });
        cell.lblNom.text = [[[m list] objectAtIndex:indexPath.row] objectForKey:@"name"];
        cell.lblTour.text = [[[m list] objectAtIndex:indexPath.row] objectForKey:@"description"];
        break;
    } 
```

速度略有提高，但滚动时仍然**冻结。**

我的派送不正确吗？（我刚刚发现，可能没有很好用）。

或者有没有更好的方法？我喜欢 facebook 的朋友选择器。它会放置一个默认的配置文件图像，并在从 Internet 接收到它时刷新正确的图像配置文件。这个魔法是怎么做到的？:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-08T23:54:48.507

修复此块：

```
 dispatch_queue_t queue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_HIGH, 0ul);
        dispatch_async(queue, ^{
                strForImg = [[NSString alloc] initWithFormat:@"https://graph.facebook.com/%@/picture?type=square",[[list objectAtIndex:indexPath.row] objectForKey:@"id"]];

                url =[NSURL URLWithString:strForImg];
                img = [UIImage imageWithData: [NSData dataWithContentsOfURL:url]];
            dispatch_sync(dispatch_get_main_queue(), ^{
                [cell.imgProfile setImage:img];

            });
        }); 
```

# numpy - 是否有获取图像中心像素的简写？

> ID：13783188
> 
> 赞同：3
> 
> 时间：2012-12-08T23:52:21.187
> 
> 标签：numpy

numpy 中是否有任何索引简写来获取图像（或任何 ND 数组）的中心像素？

例子：

```
cutout = xc[xc.shape[0]/2-30:xc.shape[0]/2+30,xc.shape[1]/2-30:xc.shape[1]/2+30] 
```

我可以定义一个函数

```
def get_center_pixels(arr, npix):
    slices = [slice(shape/2-npix,shape/2+npix) for shape in arr.shape]
    return arr[slices]

cutout = get_center_pixels(xc,30) 
```

有没有更好的方法或内置的方法来做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-10T17:26:31.023

我能想到的 numpy 中最接近的标准函数是[numpy.fft.fftshift](http://docs.scipy.org/doc/numpy/reference/generated/numpy.fft.fftshift.html)，它沿着选定的轴滚动数据，因此中心点现在位于 [0,0]。

# fortran - OpenMP 和 MKL 线程

> ID：13783190
> 
> 赞同：8
> 
> 时间：2012-12-08T23:52:39.433
> 
> 标签：fortran, openmp, intel-mkl

我在 Fortran 中有一个代码，它使用`DGESVD`MKL 并使用 Intel 编译器在 8 个内核上运行。代码通过 OpenMP 加速。我也知道 OpenMP 和 MKL 有自己的设置来设置线程数（`omp_num_threads`和`mkl_num_threads`）。我想知道最佳线程数。我应该`OMP_NUM_THREADS=1`在调用 LAPACK 例程之前设置吗？OpenMP 线程数会影响 MKL 线程数吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-12-09T11:13:58.933

MKL 还使用 OpenMP 作为其多线程驱动程序。这意味着 OpenMP 线程的数量确实会影响 MKL 线程的数量，但方式非常复杂。

首先，作为 OpenMP 代码，MKL 也由通常的 OpenMP 方法控制，以设置线程数，例如`OMP_NUM_THREADS`调用`omp_set_num_threads`. 但它也提供了`MKL_NUM_THREADS`和形式的覆盖配置机制`mkl_set_num_threads()`。这允许在用户代码和 MKL 例程中拥有不同数量的线程。

在配置了所需的线程数之后，还应该知道 MKL 在嵌套并行情况下的行为方式。`parallel`也就是说，如果从用户代码中的活动区域内部调用，MKL 默认会运行单线程。MKL 提供了`MKL_DYNAMIC`可以覆盖此行为的开关，但它要求用户代码使用与 MKL 相同的 OpenMP 编译器（请阅读 - 您必须使用英特尔的编译器），因为不保证不同 OpenMP 运行时之间的兼容性。

一般来说，您不需要在调用 MKL 之前将线程数设置为 1，因为这将使其成为单线程，除非通过显式配置 MKL 线程数被覆盖。`parallel`当启用嵌套并行时，从内部区域调用它时应该小心。

MKL 的用户指南中提供了有关控制 MKL 中的线程数的更多信息：

*   [使用附加线程控制](http://web.archive.org/web/20140116114500/http://software.intel.com/sites/products/documentation/hpc/mkl/lin/MKL_UG_managing_performance/Using_Additional_Threading_Control.htm)（否则为死链接的镜像）
*   [设置线程数的技巧](https://software.intel.com/content/www/us/en/develop/documentation/onemkl-linux-developer-guide/top/managing-performance-and-memory/improving-performance-with-threading/techniques-to-set-the-number-of-threads.html)

# c# - 读取复杂的 XML 属性

> ID：13783191
> 
> 赞同：4
> 
> 时间：2012-12-08T23:52:43.157
> 
> 标签：c#, xml, linq, visual-studio-2008

我有一个 XML 文件，它使用属性和标签的组合，其中包含数据。

我无法控制 XML 文件的结构，但我目前正在切换设备以查看 LINQ 来解析它，并想知道是否有关于如何最好地处理这种结构的意见：

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE call_flow SYSTEM "../../../../dtds/Callflow_1-1.dtd">
<call_flow version="1.1" serial="13903" first_element="Element1">
  <element_def name="Element1">
    <voice class="com.classname.Name">
      <static>Element1.xml</static>
    </voice>
    <exit_state name="done">
      <next_element>Element2</next_element>
    </exit_state>
  </element_def>
  <element_def name="Element2">
    <voice class="com.classname.Name2">
      <static>Element2.xml</static>
    </voice>
    <exit_state name="option1">
      <next_element>Element3</next_element>
    </exit_state>
    <exit_state name="option2">
      <next_element>Element4</next_element>
    </exit_state>
  </element_def>
  <element_def name="Element3">
    <voice class="com.classname.Name3">
      <static>Element3.xml</static>
    </voice>
    <exit_state name="done">
      <next_element>Element4</next_element>
    </exit_state>
  </element_def>
  <element_def name="Element4">
    <decision>
      <class src="com.classname.Name4"/>
    </decision>
    <exit_state name="0">
      <next_element>Element3</next_element>
    </exit_state>
    <exit_state name="1">
      <next_element>Element5</next_element>
    </exit_state>
  </element_def>
  <element_def name="Element5">
    <voice class="com.classname.Name5">
      <static>element5.xml</static>
    </voice>
  </element_def>
</call_flow> 
```

我可以找到大量 LINQ 代码示例，但并没有真正了解如何获取 Next_Element 和 element_def“名称”属性的值。

如果有人可以提供帮助并指出我正确的方向，我将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-09T00:01:57.667

```
XDocument xdoc = XDocument.Load(path_to_xml);
var query = from ed in xdoc.Descendants("element_def")
            select new
            {
               Name = (string)ed.Attribute("name"),
               NextElements = ed.Elements("exit_state")
                                .Select(es => (string)es.Element("next_element"))
            }; 
```

此查询将返回匿名对象序列，该对象将具有`Name`包含`element_def`name 的属性，并且下一个元素的名称为`IEnumerable<string>`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-09T00:19:26.487

What about this:

```
var doc =  XDocument.Load("myXml.xml");
var list = doc.Descendants("element_def")
              .Select(x => new
              {
                 elDefName = x.Attribute("name").Value,
                 nextEl = x.Descendants("next_element").Select(y=> y.Value).ToList()
              }); 
```

It will return an `IEnumerable` of anonymous objects, where `elDefName` will be value of the name attribute of the **element_def** node and `nextEl` will contain list of possible **next_element** values.

# google-maps - 是否可以强制 Google 地图 DrawingManager 完成折线？

> ID：13783193
> 
> 赞同：3
> 
> 时间：2012-12-08T23:53:19.853
> 
> 标签：google-maps

我有一个用户想在地图上绘制一条折线，但他不想通过双击来结束它。他希望能够敲击一个键并以这种方式完成绘图。我可以在我的应用程序中从键盘捕获击键，但似乎无法找到强制 DrawingManager 调用 overlaycomplete 事件的方法，因此我没有任何方法可以找到已完成的路径被绘制。

这可以做到吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T13:06:18.070

是的，它可以完成，我从事过一个项目，用户可以选择双击并结束折线，或者单击“完成”按钮结束它。

要使其工作，您只需将drawingManager的DrawingMode设置为null，就像这样**drawingManager.setDrawingMode(null);**

这将确保折线不能被进一步绘制。

同样作为一项安全措施，您可以删除用于绘制折线的侦听器，但是当用户希望绘制折线时，您必须再次添加它。

希望能帮助到你。

# php - 解析错误：语法错误，意外的 T_LOGICAL_OR

> ID：13783195
> 
> 赞同：-4
> 
> 时间：2012-12-08T23:53:29.183
> 
> 标签：php

我的 php 代码出现以下错误。

`Parse error: syntax error, unexpected T_BOOLEAN_OR in...`

我的代码是...

```
<?php if( !is_home()) or ( !is_archive()) { ?> 

(my code is here)

<?php ?> 
```

错误在第一行。我试过用谷歌搜索这个，但看不到我做错了什么。

你能发现上面的代码有什么问题吗？

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-08T23:55:09.207

尝试：

```
<?php if( !is_home() or !is_archive()) { ?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-08T23:55:05.113

你应该把`or`里面`if()`这样：

```
if(!is_home() or !is_archive() ) { 
```

更多信息在这里： http: [//php.net/manual/en/language.operators.logical.php](http://php.net/manual/en/language.operators.logical.php)

# c++ - libev 将套接字设置为无超时阻塞

> ID：13783199
> 
> 赞同：0
> 
> 时间：2012-12-08T23:53:50.230
> 
> 标签：c++, sockets, timeout, nonblocking, libev

Rant：我真的不喜欢 boost::asio，所以我一直在寻找替代方案并遇到了 libev。这对我来说似乎很简单，但正在做一些我无法理解的事情。如果一个线程中有太多问题，请告诉我。

1）我将监听套接字设置为 NON_BLOCK，我还将每个接受的传入连接设置为 NON_BLOCK，但在代码中的某处套接字变成了 BLOCK。前任：

```
bool Server::Start()
{
    // Setup event loop
    loop = ev_default_loop(EVBACKEND_SELECT); //EVFLAG_AUTO ?
    // Create Socket
    sockfd = socket(PF_INET, SOCK_STREAM, 0);
    addr_len = sizeof(addr)
    // Set Socket to non blocking
    fcntl(sockfd, F_SETFL, fcntl(sockfd, F_GETFL) | O_NONBLOCK);
    if (fcntl(sockfd, F_GETFL) & O_NONBLOCK) std::cout << "Socket is NONBLOCK" << std::endl;
    else std::cout << "Socket is BLOCK" << std::endl;
    if (sockfd < 0) {
        std::cout << "ERROR opening socket" << std::endl;
        return false;
    }
    bzero((char *)&addr, sizeof(addr));
    addr.sin_family = AF_INET;
    addr.sin_port = htons(port);
    addr.sin_addr.s_addr = INADDR_ANY;
    // Bind port to socket
    if (bind(sockfd,(struct sockaddr*)&addr, sizeof(addr))!=0) {
        std::cout << "bind error" << std::endl;
        return false;
    }
    // Listen
    if (listen(sockfd, 2) < 0) {
        std::cout << "listen error" << std::endl;
        return false;
    }
    // Initialize and start a watcher to accepts client requests
    ev_io_init(&w_accept, accept_cb, sockfd, EV_READ);
    ev_io_start(loop, &w_accept);
    return true;
} 
```

我试图让主循环也不会阻塞：

```
void Server::MainLoop()
{
    // Start infinite loop
    while (1) {
        ev_loop(loop, EVLOOP_NONBLOCK);
    }
} 
```

但这似乎并没有带来什么不同。请不要将我重定向到我已阅读的文档（互联网上唯一可用的文档来源）。

我为已接受的客户端套接字执行此操作：

```
void accept_cb(struct ev_loop *loop, struct ev_io *watcher, int revents)
....
c->client_sd = accept(watcher->fd, (struct sockaddr *)&c->client_addr, &c->client_len);
....
ev_io *w_client = (struct ev_io*) malloc (sizeof(struct ev_io));
ev_io_init(w_client, read_cb, c->client_sd, EV_READ);
ev_io_start(loop, w_client);
fcntl(watcher->fd, F_SETFL, fcntl(watcher->fd, F_GETFL) | O_NONBLOCK); 
```

然而，每次执行我的读取回调时，套接字都会神奇地设置为 BLOCK

2）我尝试为套接字设置超时：struct timeval timeout；

```
timeout.tv_sec = 10;
timeout.tv_usec = 0;

if (setsockopt (sockfd, SOL_SOCKET, SO_RCVTIMEO, (char *)&timeout,
            sizeof(timeout)) < 0)
    error("setsockopt failed\n");

if (setsockopt (sockfd, SOL_SOCKET, SO_SNDTIMEO, (char *)&timeout,
            sizeof(timeout)) < 0)
    error("setsockopt failed\n"); 
```

（取自这里：[this question](https://stackoverflow.com/questions/4181784/how-to-set-socket-timeout-in-c-when-making-multiple-connections)）它根本行不通。这是因为套接字被重置为阻塞模式吗？

3) 我看到了 libev 的 C++ 包装器。我绝对讨厌我必须使回调静态函数这一事实，它毁了我的一切。然而，我看到的所有示例都使用：

```
signal.loop.break_loop(); 
```

和

```
loop.run(0); 
```

有趣的是，这会产生：

> 错误：“struct ev::loop_ref”没有名为“break_loop”的成员错误：“struct ev::default_loop”没有名为“run”的成员</p>

关于 Debian 挤压。

所以，我要问的是：

1.  什么，谁，在哪里将套接字从 NON_BLOCK 更改为 BLOCK ？
2.  我如何（如果）为套接字设置超时（阻塞或非阻塞）
3.  ev++.h 有什么问题，为什么那些好人使用我不能使用的包装器？

请记住，我可以使用套接字读取和发送数据，但是以阻塞方式，没有超时。此外，由于这是一个服务器，我需要将代码保存在类中，因为我必须为每个连接的客户端保存消息。制作这种静态或非类方法只会破坏它，或者迫使我采取一种非常不同的方法。

PS： libev 的任何替代品？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-09T00:56:16.843

您没有将客户端 FD 设置为非阻塞模式。您正在设置侦听套接字 FD。

# php - 访问 MySQL 数据库 - D3

> ID：13783204
> 
> 赞同：1
> 
> 时间：2012-12-08T23:54:23.150
> 
> 标签：php, mysql, d3.js

我有一个基本的折线图并试图访问一个 mySQL 数据库。我在 PHP 的某个地方出错了和/或如何处理返回的 JSON - 任何人都可以帮助阐明一下吗？
目前，图表根本没有显示，并收到错误消息“未捕获的语法错误：意外的令牌 >”html 标记 - 不知道为什么语法是正确的，据我所见？

[http://bl.ocks.org/5fc4cd5f41a6ddf2df23](http://bl.ocks.org/5fc4cd5f41a6ddf2df23)

“getdata.php”如下：

```
 <?php

    $username="******"; 
    $password="******";   
    $host="********";
    $link=mysql_connect($host,$username,$password)or die("Unable to connect to MySQL");

    @mysql_select_db($link) or die( "Unable to select database");

    $result = mysql_query("SELECT reading, COUNT(TYPE) AS 'type' FROM    TestSourceSampleData ");
    $rows = array();

    while($r = mysql_fetch_assoc($result)) {
    $rows[$r['reading']] = $r['type'];}

    echo json_encode($rows);
    mysql_close();

    ?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T13:03:42.893

这似乎起到了作用 - while 语句的措辞和格式不正确：

getdata.php 现在如下：

```
 <?php
    $username="***"; 
    $password="****";   
    $host="*****";

    $link=mysql_connect($host,$username,$password)or die("Unable to connect to MySQL");

    mysql_select_db("****", $link) or die( "Unable to select database" );

    $result = mysql_query("SELECT reading FROM TestSourceSampleData", $link)
      or die ("Unable to run query");

    while ($row = mysql_fetch_assoc($result))
    {       
    $reading = $row["reading"];
    echo json_encode($row);
    }    
    mysql_close($link);
    ?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-09T09:17:57.657

尝试将`svg`标签放置在静态部分；我认为`xmlns`缺少。您可以将`svg:`命名空间放在顶部。

```
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="290"> 
```

还可以通过在浏览器中输入 getdata.php 来检查（查看数据是否正确传递）。

# html - 如何为 Objective-C 编写正则表达式？

> ID：13783207
> 
> 赞同：0
> 
> 时间：2012-12-08T23:54:42.903
> 
> 标签：html, objective-c, ios, regex, cocoa

我有一些包含一些 img 标签的 html 数据，如下所示：

```
img width=500 height=400
img width=400 height=250
img width=600 height=470 
```

高度和宽度总是在变化。我必须替换该html数据。我需要使用 Objective-C 将该 html 数据替换为“img with=100”。

我写了这些，但它不匹配

```
NSError *error = NULL;
NSRegularExpression *regex = [NSRegularExpression regularExpressionWithPattern:@"/(img\\s)((width|height)(=)([0-9]+)"
                                                                       options:NSRegularExpressionCaseInsensitive
                                                                         error:&error];
NSUInteger numberOfMatches = [regex numberOfMatchesInString:myhtmldata
                                                    options:0
                                                      range:NSMakeRange(0, [myhtmldata length])];

NSString *modifiedString; 
if (numberOfMatches > 0)
{
   modifiedString = [regex stringByReplacingMatchesInString:myhtmldata
                                                           options:0
                                                             range:NSMakeRange(0, [myhtmldata length])
                                                      withTemplate:@"img width=30"];

} 
```

你能帮助我吗 ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-09T04:47:42.023

如果我从您的示例代码中正确推断出意图，您只想使用`NSRegularExpression`将宽度更改为 30。然后：

```
#import <Foundation/Foundation.h>

int main(int argc, char *argv[]) {
    @autoreleasepool {
        NSError *regexError = nil;
        NSRegularExpressionOptions options = 0;
        NSString *sampleText = @"img width=500 height=400";
        NSString *pattern = @"^(img\\s+)width=\\d+(\\s+height=\\d+)";
        NSRegularExpression *expression = [NSRegularExpression regularExpressionWithPattern:pattern options:options error:&regexError];

        sampleText = [expression stringByReplacingMatchesInString:sampleText
                                                          options:0
                                                            range:NSMakeRange(0,sampleText.length)
                                                     withTemplate:@"$1width=30$2"];
        printf("%s\n",[sampleText UTF8String]);
    }

} 
```

打印`img width=30 height=400`到控制台。

**编辑：**

您更改更改正确转义时的正则表达式`(img\s+width=)\d+\s+height=\d+`将是：

```
@"(img\\s+width=)\\d+\\s+height=\\d+" 
```

然后将模板字符串更改为`@"$130"`. 如果您对我的原始代码进行了这些更改，您应该匹配所有出现`img`在 HTML 中的标记。例如，它应该改变：

```
<html>
    <body>
        <img width=500 height=400>
        <img width=520 height=100>
    </body>
</html> 
```

至：

```
<html>
    <body>
        <img width=30>
        <img width=30>
    </body>
</html> 
```

这是您的规格要求的吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-09T23:14:37.387

我找到了一种不同的方法，它正在工作。这是代码：

```
NSArray* ary = [oldHtml componentsSeparatedByString:@"<img"];
NSString* newHtml = [ary objectAtIndex:0];
for (int i = 1; i < [ary count]; i++) {

    newHtml = [newHtml stringByAppendingString:[@"<img width=300 " stringByAppendingString:[[ary objectAtIndex:i] substringFromIndex:[[ary objectAtIndex:i] rangeOfString:@"src"].location]]];

} 
```

# javascript - 使用 jQuery 隐藏/取消隐藏列表元素

> ID：13783210
> 
> 赞同：1
> 
> 时间：2012-12-08T23:54:57.420
> 
> 标签：javascript, jquery

我正在尝试创建一个“可过滤”的项目列表。用户应该能够单击列表元素（父元素），这将隐藏所有其他父元素并显示“子元素”。

html的一个例子是：

```
<ul class='parent_list'>
    <li>Parent 1</li>
        <ul class='child_list'>
            <li>Child 1</li>
            <li>Child 2</li>
        </ul>
    </li>
    <li>Parent 2</li>
        <ul class='child_list hidden'>
            <li>Child 1</li>
            <li>Child 2</li>
        </ul>
    </li>
</ul> 
```

我的 jQuery 代码是：

```
$('.parent_list li').click(function(){
    $(this).siblings().addClass('hidden');
    $(this).children().removeClass('hidden');
}); 
```

当然，您可能可以通过 javascript 判断出我对此类事情没有太多经验。我试过在谷歌上搜索一堆不同的例子，但到目前为止还没有任何东西可以工作。有小费吗？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-09T00:04:29.053

[http://jsfiddle.net/czHQE/2/](http://jsfiddle.net/czHQE/2/)

这样你就不需要`.child-list`上课了。

HTML：

```
<ul class='parent_list'>
    <li>Parent 1
        <ul>
            <li>Child 1</li>
            <li>Child 2</li>
        </ul>
    </li>
    <li>Parent 2
        <ul>
            <li>Child 1</li>
            <li>Child 2</li>
        </ul>
    </li>
</ul>​ 
```

Javascript：

```
$('.parent_list li').click(function(){
    $(this).siblings().children().hide();
    $(this).children().show();
});​ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-09T00:01:09.650

尝试这个：

```
$('.parent_list > li').click(function(){
    $('ul.child_list').hide();
    $('ul.child_list', this).show();
}); 
```

并更改您的 HTML 以删除`</li>`“Parent1”和“Parent2”之后的额外内容：

```
<ul class='parent_list'>
    <li>
        Parent 1
        <ul class='child_list'>
            <li>Child 1</li>
            <li>Child 2</li>
        </ul>
    </li>
    <li>
        Parent 2
        <ul class='child_list'>
            <li>Child 1</li>
            <li>Child 2</li>
        </ul>
    </li>
</ul>​ 
```

单击的直接子级时`.parent_list`，它将隐藏除自己的子级列表之外的所有子级列表。我使用了`.hide()`and`.show()`方法，因为它们只是切换元素的`display`属性。

这是可以玩的[jsfiddle 。](http://jsfiddle.net/uDPJ7/1/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-09T00:04:11.100

您还需要清理标记 - 您已经关闭了`<li>`“Parent 1”和“Parent 2”的标签，然后在嵌套`<ul>`.

```
<ul class='parent_list'>
    <li>Parent 1
        <ul class='child_list'>
            <li>Child 1</li>
            <li>Child 2</li>
        </ul>
    </li>
    <li>Parent 2
        <ul class='child_list hidden'>
            <li>Child 1</li>
            <li>Child 2</li>
        </ul>
    </li>
</ul> 
```

# python - 如何将参数传递给函数指针参数？

> ID：13783211
> 
> 赞同：55
> 
> 时间：2012-12-08T23:55:03.257
> 
> 标签：python, callback, function-pointers

我刚开始学习Python，发现我可以将一个函数作为另一个函数的参数传递。现在，如果我调用`foo(bar())`它，它不会作为函数指针传递，而是作为使用函数的返回值传递。调用`foo(bar)`将传递函数，但这样我无法传递任何额外的参数。如果我想传递一个调用的函数指针`bar(42)`怎么办？

无论我传递给它什么参数，我都希望能够重复一个函数。

```
def repeat(function, times):
    for calls in range(times):
        function()

def foo(s):
        print s

repeat(foo("test"), 4) 
```

在这种情况下，该函数`foo("test")`应该被连续调用 4 次。有没有办法做到这一点而不必通过“测试”来`repeat`代替`foo`？

* * *

## 回答 #1

> 赞同：79
> 
> 时间：2012-12-08T23:56:54.533

您可以使用`lambda`：

```
repeat(lambda: bar(42)) 
```

或者`functools.partial`：

```
from functools import partial
repeat(partial(bar, 42)) 
```

或者分别传递参数：

```
def repeat(times, f, *args):
    for _ in range(times):
        f(*args) 
```

这种最终风格在标准库和主要 Python 工具中很常见。`*args`表示可变数量的参数，因此您可以将此函数用作

```
repeat(4, foo, "test") 
```

或者

```
def inquisition(weapon1, weapon2, weapon3):
    print("Our weapons are {}, {} and {}".format(weapon1, weapon2, weapon3))

repeat(10, inquisition, "surprise", "fear", "ruthless efficiency") 
```

请注意，为方便起见，我将重复次数放在前面。`*args`如果要使用构造，它不能是最后一个参数。

（为了完整起见，您也可以使用 . 添加关键字参数`**kwargs`。）

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2012-12-09T00:00:32.800

您需要将 foo 的参数传递给 repeat 函数：

```
#! /usr/bin/python3.2

def repeat (function, params, times):
    for calls in range (times):
        function (*params)

def foo (a, b):
    print ('{} are {}'.format (a, b) )

repeat (foo, ['roses', 'red'], 4)
repeat (foo, ['violets', 'blue'], 4) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-01-08T13:13:48.267

虽然这里的许多答案都很好，但这个答案可能会有所帮助，因为它不会引入任何不必要的重复，而且首先回调的原因通常是与主 UI 线程之外的其他工作同步。

享受！

```
import time, threading

def callMethodWithParamsAfterDelay(method=None, params=[], seconds=0.0):

    return threading.Timer(seconds, method, params).start()

def cancelDelayedCall(timer):

    timer.cancel()

# Example
def foo (a, b):

    print ('{} are {}'.format (a, b) )

callMethodWithParametersAfterDelay(foo, ['roses', 'red'], 0) 
```

# c++ - 有人可以直观地解释树遍历是如何工作的吗？

> ID：13783214
> 
> 赞同：0
> 
> 时间：2012-12-08T23:55:06.553
> 
> 标签：c++, tree

我试图通过遍历树并根据需要删除内存来恢复树中分配的内存。例如，假设我有以下树结构：

```
struct tree
{
   int *value;
   tree *left;
   tree *right;
}

tree *root; //always points to the root of this tree 
```

我知道我们必须`value`在每次递归调用后访问每个，删除它，然后移动到下一个节点（可以是`left`or `right`），但是递归过程似乎非常违反直觉（特别是我们向左移动或移动到的部分正确的）。

我试图遵循“用根做某事，递归调用左边，然后递归调用右边”的规则，但代码的功能方式让我感到困惑。如何保留 的不变量`root`？如果有人可以用图片来解释这个概念，那就太好了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T00:17:17.677

因为您需要在删除期间遍历树，所以想法是在返回时删除

```
void del_tree(tree *t) {

  if (t->left) {
    // there is a left subtree existing. delete it
    del_tree(t->left);  // first go deeper on left side
    // left branch now completely empty
    delete t->left;     // nothing left behind t->left
    t->left=0;          // just in case
  } else {
    // there is no left subtree existing
    // we are in a leaf or in an unbalanced node
  }

  if (t->right) {
    // there is a right subtree existing. delete it
    del_tree(t->right);  // now go deeper on right side
    // right branch now completely empty
    delete t->right;     // nothing left behind t->right
    t->right=0;          // just in case
  } else {
    // there is no rigt subtree existing
    // we are in a leaf or this was an unbalanced node
    // (before we deleted the left subtree)
  }

  // both branches are now completely empty
  // either they were from the beginning (leaf)
  // or we have successfully reduced this node to a leaf
  // now do the node visit

  if (t->value) {
    delete t->value;     // tidy up
    t->value=0;          // just in case
  }
  // now we are completely clean and empty
  // after return t will be deleted
}

void main() {
  tree *my_tree;

  // stuff

  del_tree(my_tree);   // delete the whole tree
  delete my_tree;      // delete the remaining root node
} 
```

递归的一个非常重要的方面是何时停止。我假设结构中的 NULL 指针表示没有子树。

`if (t->left) del_tree(t->left);` 现在的策略是当我们在左右两边都达到 NULL 指针时尽可能深入，我们被困在一片叶子中。我们现在清理叶子（删除值）并返回。执行返回时`delete t->left;`，该节点在左子树上没有任何内容，并在其右子树上继续。

在这里我找到了一个很好的[遍历图像](http://www.flickr.com/photos/bjoernknafla/5622204938/)

* * *

删除一棵树的问题分为3个部分。删除左子树，删除右子树，清理self。删除子树（左或右）与删除树本身的过程非常相似。所以你使用相同的函数，这称为递归。

考虑删除文件系统结构。您决定首先删除“左”文件夹结构的策略，然后删除子树“右”，最后删除文件“值”。当您在执行此策略期间更改为文件夹（无论是左还是右）时，您会注意到问题看起来相同。因此，您再次将此策略应用于树中的任何文件夹。

发生的情况是，除非当前目录中没有更多目录，否则您会反复切换到左侧目录。您删除文件“值”。然后您返回一个文件夹并删除名为“left”的文件夹。现在你寻找一个名为'right'的文件夹，进入它，找不到文件夹，删除文件'value'并返回到上一个文件夹。您删除了现在为空的“正确”，最后也删除了文件“值”。接下来是做进一步的返回（回溯）。等等。

在更深入的过程中，您无法删除非空文件夹。撤退时必须删除。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-09T00:33:29.930

你可以把你的树想象成一棵有根和两片叶子的树，每片叶子都指向另一棵树的根。

事实上，这就是你如何保持“根的不变量”的方式，因为一旦你跟随叶子的指针，你就会到达另一棵树的根。

```
root -> branch -> leaf
|
V
branch -> leaf 
```

也可以认为是

```
root -> tree1
|
V
tree2 
```

反过来

```
root -> (root -> leaf)
|
V
(root -> leaf) 
```

因此，当您遵循原始分支时，您最终会再次成为根。

# html - 块元素周围的链接如何在旧版浏览器中翻译？

> ID：13783219
> 
> 赞同：2
> 
> 时间：2012-12-08T23:55:35.177
> 
> 标签：html, hyperlink, cross-browser, semantic-markup

[HTML5 允许](http://html5doctor.com/block-level-links-in-html-5/)将链接包裹在块元素（一个或多个）周围，但它在旧浏览器中究竟会如何呈现呢？假设可以追溯到 IE6。

我还没有找到完整的细节（但有[一些例子](https://stackoverflow.com/questions/5320404/wrap-link-a-around-div)）。

标记如下：

```
<a href="http://example.com">
  <section>
    <h3>Heading</h3>
    <p>Text</p>
  </section>
</a> 
```

此外，使其在旧版浏览器中兼容的最语义化的方法是将链接分别包装在每个块元素内吗？我已经看到用 替换块元素的建议`span`，但这会使它内联并改变标题的含义。

* * *

我注意到**即使是现代浏览器**（例如 iOS 6 上的 Safari）也会做一些奇怪的事情。例如，尝试从您的移动浏览器[单击此 JSFiddle 中的图像](http://jsfiddle.net/3QqmH/2/embedded/result/)——即使它与下面的标题共享链接，但标题并没有为我突出显示。此外，单击标题时，图像或标题都会突出显示。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-09T08:51:20.457

放宽 HTML5 中的内容模型`a`是基于对实际浏览器行为的观察：最初的句法要求并没有真正强制执行。可以预期这会尽可能地进行。（我在 IE 6 和 Firefox 3 上对此进行了测试。）

所以不需要兼容性。但是拆分链接元素肯定不是“语义”的。对于“语义”的任何合理语义，两个链接在语义上与一个链接不同。这也是一个可用性问题，尤其是在使用键盘在链接之间移动时。

视觉渲染是一个不同的问题。从 HTML5 草案或从实际考虑来看，根本不清楚*应该*如何呈现链接，在不同的状态下，什么时候它可能包含任何内容。这可能是旧语法要求背后的一个关键原因。浏览器不会一致地呈现此类链接。这至少适用于下划线。也可能存在功能差异；例如，在某些浏览器上，标题文本右侧的区域是不可点击的，即只有文本是“活动的”，而其他浏览器则使元素的整个区域（默认情况下是标题的整个可用宽度） ） “积极的”。

因此，如果您希望使用这样的链接，基本问题是考虑您打算如何呈现它以及如何在 CSS 中以合理跨浏览器的方式进行渲染。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-09T00:00:46.310

据我所知，这种行为通常与现代浏览器相同。给出的示例标记中的所有内容都将变成一个超链接。这与您是否为旧 IE 包含[HTML5 shiv](https://code.google.com/p/html5shiv)以识别新语义元素无关。

这可能是因为 HTML 中没有任何内容表明特定的开始标签应该自动关闭未关闭的`<a>`标签——结束标签是用来表示超链接的结束的。

是的，如果我想符合旧的 HTML 文档类型，我会这样做以保留语义。不过，它不是 HTML5 一致性所必需的，因为它的工作原理是假设即使是旧浏览器也已经以这种方式运行（向后兼容性和一切）。

# php - url 在使用序列化/php 数组达到最大长度之前被裁剪

> ID：13783221
> 
> 赞同：0
> 
> 时间：2012-12-08T23:55:44.310
> 
> 标签：php, html

我正在学习php。我有一些代码，我试图将 2 个变量和 2 个数组从一个 php 页面发布到另一个页面，接收页面工作正常，但第一页在几个字符后裁剪数据（它没有达到最大长度或任何接近的地方） -

这里，$array_name 和 $array_qty 是两个动态数组。我已经验证 echo $c 给了我我想要的东西。

```
 <?php
  $serialized_name=serialize($array_name);
  $serialized_qty=serialize($array_qty) ;
  $c="count=".$count ."&&Sum=" . $a . "&&serialized_name=". $serialized_name . "&&serialized_qty=". $serialized_qty;
  echo $c;
  ?> 
```

echo $c 给了我-

```
 count=6&&Sum=45.91&&serialized_name=a:7:{i:0;s:7:"vanilla";i:1;s:7:"vanilla";i:2;s:21:"very berry strawberry";i:3;s:7:"vanilla";i:4;s:7:"vanilla";i:5;s:7:"vanilla";i:6;s:7:"vanilla";}&&serialized_qty=a:7:{i:0;s:1:"2";i:1;s:1:"1";i:2;s:1:"1";i:3;s:1:"1";i:4;s:1:"1";i:5;s:1:"3";i:6;s:1:"3";} 
```

但是，这给了我裁剪的输出`$c=`

```
 <p><a href="Checkout.php?<?php echo $c ?>" >Checkout</a> </p> 
```

我从上面的行得到的裁剪输出是 -

```
http://localhost/myRestaurant/Checkout.php?count=6&&Sum=45.91&&serialized_name=a:7:{i:0;s:7: 
```

我想我应该得到这个-

```
http://localhost/myRestaurant/Checkout.php?count=6&&Sum=45.91&&serialized_name=a:7:{i:0;s:7:%22vanilla%22;i:1;s:7:%22vanilla%22;i:2;s:21:%22very%20berry%20strawberry%22;i:3;s:7:%22vanilla%22;i:4;s:7:%22vanilla%22;i:5;s:7:%22vanilla%22;i:6;s:7:%22vanilla%22;}&&serialized_qty=a:7:{i:0;s:1:%222%22;i:1;s:1:%221%22;i:2;s:1:%221%22;i:3;s:1:%221%22;i:4;s:1:%221%22;i:5;s:1:%223%22;i:6;s:1:%223%22;} 
```

我知道 get 不是最好最安全的方法，但我认为这应该有效。任何关于我做错了什么以及如何解决它的提示将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-08T23:58:30.767

您的引号将提前结束该属性。转义引号：

```
<?php echo htmlentities($c); ?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-09T00:04:42.077

您应该对这种购物车产品使用 POST，但无论如何，如果您只想从数组中创建一个 URL，您不能只序列化任意数据，您需要对数据进行编码，否则它会中断，因为特殊字符。

仅用于编码：

```
$serialized_name = base64_encode(serialize($array_name));
$serialized_qty = base64_encode(serialize($array_qty)); 
```

为了检索数据，在 Checkout.php 中，执行相反的操作：

```
$unserialized_name = unserialize(base64_decode($_GET["serialized_name"]));
$unserialized_qty = unserialize(base64_decode($_GET["serialized_qty"])); 
```

# ruby-on-rails-3 - 通过路由器反序列化时，Ember-data 检查是否在商店中找到模型

> ID：13783230
> 
> 赞同：1
> 
> 时间：2012-12-08T23:57:28.120
> 
> 标签：ruby-on-rails-3, ember.js, ember-data, ember-old-router

我在路由器中有一个对象路由（使用带有标准 REST 后端的 ember-data），`connectOutlets`它简单地反序列化并加载对象并将其插入插座。

```
 # inside router 
  action: Ember.Route.extend
    route: 'object/:object_id'

    connectOutlets: (router, object) ->
      unless object.get('isLoaded') # What goes here to tell if the object wasn't found?
         #
         #  handle this case (e.g., redirect)
         #
      else # otherwise proceed as normal
        router.get('applicationController').connectOutlet('object', object) 
```

当我导航到`localhost/#object/object_that_doesnt_exist`时，路由器会反序列化 url，尝试加载对象（服务器日志显示对 localhost/objects/object_that_doesnt_exist 的 HTTP GET 请求），获得 404，而是创建一个 id 设置为 的新对象`object_that_doesnt_exist`。

我想检测到这一点并处理此案。现在，我正在检查`isLoaded`属性，它确实区分了现有模型和不存在的模型，但我不确定这是最好的方法。

理想情况下，会有一种类似于 Rails 的方法`new_record?`。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-09T01:46:57.953

看看源代码：[https ://github.com/emberjs/data/blob/master/packages/ember-data/lib/system/model/model.js#L15](https://github.com/emberjs/data/blob/master/packages/ember-data/lib/system/model/model.js#L15)

```
isError: retrieveFromCurrentState,
isNew: retrieveFromCurrentState,
isValid: retrieveFromCurrentState, 
```

没有尝试过自己，但`isNew`可能是你正在寻找的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-09T09:03:58.970

您不想在 connectOutlet 中执行此操作，因为它需要应用程序在检查数据库中的记录时等待。

就我个人而言，我会`find`在我的适配器中使用自定义方法并从那里处理 404 错误。

```
find: function(store, type, id) {
  var root = this.rootForType(type);

  this.ajax(this.buildURL(root, id), "GET", {
    success: function(json) {
      this.didFindRecord(store, type, json, id);
    },
    statusCode: {
      404: function() {
        # I can never remember the exact semantics, but I think it's something like this
        this.trigger('didNotFindRecord');
      }
    }
  })
}

connectOutlets: (router, object) ->
  router.get('store').addObserver('didNotFindRecord', this, 'handle404')
  router.get('applicationController').connectOutlet('object', object) 

handle404: ->
     # 
     #  handle this case (e.g., redirect)
     # 
```

不过，您必须小心正确地拆除观察者。

# javascript - 使用 JavaScript 更改类

> ID：13783233
> 
> 赞同：4
> 
> 时间：2012-12-08T23:58:03.647
> 
> 标签：javascript, css, html-lists

我有以下代码：

```
<div id="nav">
  <ul>
    <li id="tabOne" class="first current"><a href="./CS1.html" target="SheetView">Page One</a></li>
    <li id="tabTwo"><a href="./CS2.html" target="SheetView">Page Two</a></li>
    <li id="tabThree"><a href="./CS3.html" target="SheetView">Page Three</li>
    <li id="tabFour"><a href="./CS4.html" target="SheetView">Page Four</a></li>
    <li id="tabFive"><a href="./CS5.html" target="SheetView">Page Five</a></li>
    <li id="tabSix"><a href="./CS6.html" target="SheetView">Page Six</a></li>
  </ul> 
```

这会将所选页面加载到名为“SheetView”的 iframe 中。我需要做的是在单击当前未选中的选项时使用 JavaScript 更改类。我应该说我的 CSS 中已经设置了当前类。我只是没有办法触发它。

我想在上面添加一个 onlick 事件`<UL>`并调用`onclick="Javascript:changeCurrent();"`但有问题（实际上是四个）：

1.  我`<ul onclick="JavaScript:changeCurrent();>`需要在哪里举办活动？
2.  使更改发生的结果是什么 JavaScript？
3.  如何使第一个选项默认设置为当前选项？
4.  有没有办法阻止当前选择的选项成为活动链接？

我找到了一些不同的例子，但我无法定制它们来为我工作。非常感激任何的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-09T00:47:03.703

由于您指定需要非 jQuery 响应，因此这里有一个可以适当切换的函数：

```
function toggleNavSelected(el){
    var list = document.getElementById('nav').children[0];
    for(var i=0; i<list.children.length; i++){
        var cur = list.children[i];
        if(el==cur){
            cur.classList.add("current");
            cur.firstChild.onclick = (function(){
                toggleNavSelected(this.parentElement);
                return false;
            });
        } else {
            if(cur.classList.contains("current")){
                cur.classList.remove("current");
            }
            cur.firstChild.onclick = (function(){
                toggleNavSelected(this.parentElement);
            });
        }
    }
} 
```

向每个 LI ( `onclick="toggleNavSelected(this);"`) 添加 onclick 处理程序，或者在加载菜单后执行以下操作：

```
var list = document.getElementById('nav').children[0];
for(var i=0; i<list.children.length; i++){
    var el = list.children[i];
    el.firstChild.onclick = (function(){
        toggleNavSelected(this.parentElement);
    });
} 
```

演示：http: [//jsfiddle.net/bWY7P/2/](http://jsfiddle.net/bWY7P/2/)

（注意：JSFiddle 脚本有一个小的区别；它`return false;`在 onclick 函数中添加了一个，这样您就可以在没有实际遵循 HREF 属性的链接的情况下使用它。不要在您的实时代码中使用该行）

* * *

### 解释：

该函数查看`LI`元素中的每个`#nav`元素。
如果该元素是传递给函数的元素，那么它会添加 class `.current`。
否则，它会删除该类`.current`（如果存在）。

第二部分将函数绑定到`a`调用该`toggleNavSelected()`函数的每个元素的 onclick 事件，并将其父元素 (the `li`) 作为参数传递。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-09T00:39:27.753

1）如果您想在单击一个项目时更改当前选择的类，请将 onclick 放入 li 项目 2）在这里使用 jquery 将非常容易，您所要做的就是导入带有`<script>`标签的 jquery 文件，然后您重新准备好！例如，您可以`onclick="changeClass(this);"`在`<li>`标签和普通 JavaScript 文件或脚本标签中执行以下操作：

```
function changeClass(this){
 $('#nav li').attr("class","");
 $(this).attr("class","current");
} 
```

将“当前”替换为您要使用的类名

3）它应该已经设置为当前

4) 使用 :visited CSS 选择器来更改链接的颜色，例如：

```
a:visited{
 color: #000000;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-09T00:40:54.527

首先，您应该从单独的脚本而不是`onclick`属性设置事件处理程序。您不会以这种方式重复您的代码并将任何东西放在一个地方。HTML 也更干净。

使用[jQuery](http://jquery.com/)会很简单：

```
var menuLinks = jQuery( '#nav a' );

menuLinks.on( 'click' function() {

    menuLinks.removeClass( 'active' );
    $( this ).addClass( 'active' );

} ); 
```

你也可以在纯 JS 中做到这一点，但是使用一些库可以让你摆脱浏览器不兼容的麻烦。

# actionscript-3 - Mac 上存储的 localSharedObject 文件在哪里

> ID：13783236
> 
> 赞同：0
> 
> 时间：2012-12-08T23:58:39.890
> 
> 标签：actionscript-3, flash-builder

我正在使用 localSharedObjects 并希望检查在用户计算机上创建的文件。根据文档，localSharedObject 文件存储在 Mac 上的以下位置：/Users/username/Library/Preferences/Macromedia/Flash Player/#SharedObjects/web_domain/path_to_application/application_name/object_name.sol

当我尝试查找文件时，我什至无法访问：/Users/username/Library，因为该位置不存在库文件。另外，我一直在搜索扩展名为 .sol 的文件，但没有成功。我的问题：我在哪里可以找到运行 10.7.5 的 Mac 上的 loaclSharedObject 文件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T00:30:40.547

Mac OS X 10.7 隐藏了一个 Library 文件夹。前往 Finder，按住 Option 键并选择前往菜单。然后将出现库文件夹，您可以选择它。如果您希望永久访问它，可以将其拖到 Finder 侧边栏中，或者使用终端命令使其永久显示：

chflags nohidden ~/库

# ios - 如何为 iOS 应用托管大量图片？

> ID：13783239
> 
> 赞同：0
> 
> 时间：2012-12-08T23:59:00.733
> 
> 标签：ios, database, xcode, image, hosting

我们想创建一个用户猜测不同图片的 iOS 游戏。为此，游戏将有大量随机图像。

所以事情就是这样，我们正在寻找创建一个图像数据库。

你们推荐什么来创建这样一个数据库并托管所有这些图像？

我听说过**SQLite**，但我们对如何前进感到迷茫。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T00:12:05.453

如果您的图像不是超高质量/不是很大，我建议您尝试使用图像映射。

保留一张起始坐标 + 图像大小的表格以取消引用每个图像。

*注意：*这在图像大小相同时效果最佳。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-09T00:06:49.103

在 SQLite 中，您可以将图像存储为 BLOB，也可以将其保存在文件夹中，并将数据库中的 URL 保存为文本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-09T00:29:35.520

对于游戏，数据库方法太慢了，我不会推荐它。

正如@Miles Alden 所说，图像映射是中小型图像的一个很好的解决方案。将它们放置在大小为 2 的幂的图像中也是明智的。

对于大分辨率图像，我建议将文件名存储在一个数组中（`JSON`或者`PLIST`是最快的解析，或者只是*逗号分隔*），并在您真正需要的时候加载图像。

# c# - 精灵振动。怎么了？

> ID：13783244
> 
> 赞同：1
> 
> 时间：2012-12-08T23:59:24.777
> 
> 标签：c#, xna

我的敌人精灵在到达可变端点后一直在振动。怎么了？为什么会振动？此外，变量 next_position 永远不会为真。但为什么？我希望敌人精灵在到达当前端点后移动到一个新的随机端点。

```
public class Game1 : Microsoft.Xna.Framework.Game
{
    GraphicsDeviceManager graphics;
    SpriteBatch spriteBatch;
    Texture2D enemy;
    Vector2 position, endposition;
    bool next_position = false;

    public Game1()
    {
        graphics = new GraphicsDeviceManager(this);
        Content.RootDirectory = "Content";
        graphics.PreferredBackBufferWidth = 1280;
        graphics.PreferredBackBufferHeight = 720;
    }

    protected override void Initialize()
    {          
        base.Initialize();
    }

    protected override void LoadContent()
    {         
        spriteBatch = new SpriteBatch(GraphicsDevice);
        enemy = Content.Load<Texture2D>("zombie");
        Random randomstart = new Random();
        position = new Vector2(randomstart.Next(100, 200), randomstart.Next(100, 200));
        endposition = new Vector2(randomstart.Next(100, 600), randomstart.Next(100, 400));
    }

    protected override void Update(GameTime gameTime)
    {
        float delta = (float)gameTime.ElapsedGameTime.TotalSeconds;         
        Random random = new Random();
        position.X += 5 * delta;
        position.Y += 3 * delta;

        if (next_position == true)
        {
          endposition = new Vector2(random.Next(100, 600), random.Next(100, 400));
          next_position = false;
        }

        if (Vector2.Dot(endposition - position, endposition - position) > 0 || Vector2.Dot(endposition - position, endposition - position) < 0) 
        {
          Vector2 enemyDirection = Vector2.Normalize(endposition - position) * 100f;
          position += enemyDirection * delta;
        }
        else
        {
            next_position = true;
        }

        base.Update(gameTime);
    }

    protected override void Draw(GameTime gameTime)
    {
        GraphicsDevice.Clear(Color.CornflowerBlue);
        spriteBatch.Begin();
        spriteBatch.Draw(enemy, position, Color.White);
        spriteBatch.End();

        base.Draw(gameTime);
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-09T00:36:29.170

我对这条线有点困惑

```
if (Vector2.Dot(endposition - position, endposition - position) > 0 || Vector2.Dot(endposition - position, endposition - position) < 0) 
```

应该完全正确。从代码的其余部分中，您试图用它来实现的是检查精灵的位置是否是敌人的位置。这条线实际上做的是计算相反方向的向量的点积，除非向量为零，否则它永远不会为零。所以理论上这可能真的有效，但前提是位置精确地等于敌人的位置。

但是，您在单位时间内将精灵移动了固定距离，因此它实际上并没有到达敌人，而是超过了它。发现自己然后在另一边它向后移动，它来自哪里，并再次越过它。这继续并导致您描述的振动。

现在，您想要实现的行为的方式通常是使用毕达哥拉斯定理计算两个对象（精灵和敌人）之间的距离，然后在距离低于某个阈值时接受对象的到达（容易但容易出错），或者比对象可以通过这个特定更新的距离短（在你的情况下，因为你移动了一个归一化的向量 times `100f * delta`，这个距离等于`100f * delta`）。

我希望我的解释是有帮助的。当然，请随时要求澄清。

**编辑（回复评论）：**

您创建的`limit`向量相对没有意义，因为它只是`max_distance`在 x 和 y 方向上偏移的位置。没有必要这样做。但是，另一个`if()`包含几乎您想要的代码，请查看：

```
// first you calculate the distance we can move this update
float max_distance = 100f * delta;

// now, we compare the actual distance to the end position to that maximum
// if the actual distance is larger, then we are not there yet
// otherwise, (if the actual distance is smaller) we will overshoot the target,
// thus we are in fact there! (=close enough to continue)
// (note: we compare the distances squared to avoid a square root,
//  which makes this check much faster, which is good practice,
//  in case we ever scale this up to more objects)
if ((position - endposition).LengthSquared() > max_distance * max_distance)
{
    /* we are not yet there, continue moving! */
}
else
{
    /* we are there! */
} 
```

这真的很简单，不需要其他检查。让我知道这是否适合您！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-09T19:31:26.643

现在好多了，但并不完美。敌方精灵不再振动，但如果到达结束位置，它总是会向右下方移动一些像素。为什么它总是向右移动一些像素？其余的工作正常。

```
public class Game1 : Microsoft.Xna.Framework.Game
{
    GraphicsDeviceManager graphics;
    SpriteBatch spriteBatch;
    Texture2D enemy;
    Vector2 position, endposition;
    bool next_position = false;
    int count_nextposition;

    public Game1()
    {
        graphics = new GraphicsDeviceManager(this);
        Content.RootDirectory = "Content";
        graphics.PreferredBackBufferWidth = 1280;
        graphics.PreferredBackBufferHeight = 720;
    }

    protected override void Initialize()
    {
        base.Initialize();
    }

    protected override void LoadContent()
    {
        spriteBatch = new SpriteBatch(GraphicsDevice);
        enemy = Content.Load<Texture2D>("zombie");
        Random randomstart = new Random();
        position = new Vector2(randomstart.Next(100, 200), randomstart.Next(100, 200));
        endposition = new Vector2(randomstart.Next(100, 600), randomstart.Next(100, 400));
        count_nextposition = randomstart.Next(90, 121);
    }

    protected override void Update(GameTime gameTime)
    {
        float delta = (float)gameTime.ElapsedGameTime.TotalSeconds;
        count_nextposition -= 1;
        Random random = new Random();
        position.X += 5 * delta;
        position.Y += 3 * delta;

        if (count_nextposition <= 0)
        {
        if (next_position == true)
        {
            endposition = new Vector2(random.Next(100, 600), random.Next(100, 400));
            next_position = false;
        }
        float max_distance = 100f * delta;
        if ((position - endposition).LengthSquared() > max_distance * max_distance)
        {
           Vector2 enemyDirection = Vector2.Normalize(endposition - position) * 100f;
           position += enemyDirection * delta;
        }
        else
        {

            next_position = true;
            count_nextposition = random.Next(90, 121);
        }
        }

        base.Update(gameTime);
    }

    protected override void Draw(GameTime gameTime)
    {
        GraphicsDevice.Clear(Color.CornflowerBlue);
        spriteBatch.Begin();
        spriteBatch.Draw(enemy, position, Color.White);
        spriteBatch.End();

        base.Draw(gameTime);
    }
} 
```

# c++ - 错误 C1004：在 Visual Studio 2012 中发现意外的文件结尾

> ID：13783246
> 
> 赞同：10
> 
> 时间：2012-12-08T23:59:38.717
> 
> 标签：c++, header-files

我想在 Visual Studio 2012 中编写一个简单的 C++ 代码，但总是在头文件中收到错误 C1004。有人可以帮我吗？

我的代码如下。我是 Visual Studio C++ 的新手，所以这可能是非常愚蠢的错误。

**添加.cpp**

```
#include <iostream>

int add(int a, int b)
{
    return a+b;
} 
```

**添加.h**

```
#ifndef ADD_H
#define ADD_H

int add(int a, int b);

#endif 
```

**源码.cpp**

```
#include "add.h"
#include <iostream>

int main()
{
    std::cout << add(3, 4);
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-12-09T00:04:17.867

通用代码看起来不错，但 add.h 需要在文件末尾回车。这是该错误代码的 Microsoft 文档：

[http://msdn.microsoft.com/en-us/library/4exw7xyc%28v=vs.110%29.aspx](http://msdn.microsoft.com/en-us/library/4exw7xyc%28v=vs.110%29.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-11-17T09:43:56.257

尝试将您的代码复制到 Notepad++ 等文本编辑器并将编码更改为 ANSI。您可能会看到一些奇怪的符号，例如

```
int main()
{
    // ...
}п»ї 
```

要修复错误，请删除它们并将代码复制回来。

# symfony - 学说的目的：映射：在使用 Symfony2 和 Doctrine2 从现有数据库导入实体时进行转换？

> ID：13783254
> 
> 赞同：0
> 
> 时间：2012-12-09T00:00:53.750
> 
> 标签：symfony, doctrine-orm

在 Symfony2[文档](http://symfony.com/doc/current/cookbook/doctrine/reverse_engineering.html)中，说明说要使用以下命令

```
php app/console doctrine:mapping:convert xml ./src/Acme/BlogBundle/Resources/config/doctrine/metadata/orm --from-database --force 
```

其次是：

```
 php app/console doctrine:mapping:import AcmeBlogBundle annotation
 php app/console doctrine:generate:entities AcmeBlogBundle 
```

学说的目的是什么：映射：转换，我看到它生成了模式，但是如果我运行忽略它并且只运行

```
 php app/console doctrine:mapping:import AcmeBlogBundle annotation
 php app/console doctrine:generate:entities AcmeBlogBundle 
```

它仍然有效。

是否学说：映射：导入检查包中是否存在模式，如果不存在则继续直接从数据库导入？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T14:19:37.660

一旦你运行`doctrine:mapping:convert`了 xml 映射，就留在硬盘上。所以下次调用`doctrine:mapping:import`导入相同的架构。`doctrine:mapping:convert`如果您更新数据库并希望将其转换为原则映射文件（即：更新 xml 模式），则应再次运行。

# c++ - 随机 EXC_BAD_ACCESS 由于我必须忽略的一些事情

> ID：13783255
> 
> 赞同：0
> 
> 时间：2012-12-09T00:00:57.447
> 
> 标签：c++, stl, exc-bad-access, cinder

很长一段时间后我又回到了 C++，我想用风格来做这件事，所以我一头扎进了 libCinder 并开始做我以前很少做的事情（即使那时我还是因为一些原因更喜欢 Qt ）。这个计划有什么问题？

问题是很少这样做，尤其是当我使用调试配置文件从 Xcode 内部运行我的代码并系上几条安全带（又名调试器）时，但随后我不得不陷入困境并且发生了令人讨厌的事情：用户也得到了兴奋，有些东西不够紧，最终我的应用程序悲惨地崩溃了。

我设法将罪魁祸首缩小到 PilotStudyApp::draw() 函数（参见此处的代码[https://github.com/Morpheu5/PilotStudy](https://github.com/Morpheu5/PilotStudy)），很可能是在最后一个 for 循环附近，即通过 _activePoints 的那个，但我不能确定，正如你从 bt 看到的那样

```
Thread 0 Crashed:: Dispatch queue: com.apple.main-thread
0   libstdc++.6.dylib               0x914635e4 std::_Rb_tree_increment(std::_Rb_tree_node_base*) + 15
1   org.cinder.PilotStudy           0x000916b3 PilotStudyApp::draw() + 419
2   org.cinder.PilotStudy           0x000c34ad -[CinderView drawRect:] + 125 
```

您可以在这里完全看到：http: [//pastebin.com/izZcFy8p](http://pastebin.com/izZcFy8p)

我有一种强烈的感觉，我的 C++-fu（或缺乏）出了点问题，所以如果你们能发现我忽略的东西，我将非常感激（因为我不想去处理，它会感觉要回幼儿园了：）

**编辑**：我突然想到 STL 可能不是线程安全的，所以同步或制作本地副本应该可以解决吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-16T18:50:35.327

出于效率原因，SDL 不提供内置同步/互斥。在地图周围添加互斥锁应该可以解决问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-06T15:29:12.453

正如@alexp 所指出的，不支持从多个线程同时读取和写入 STL 容器。

但是，如果您关注 Anthony Williams 的优秀文章，您可以让您的生活更轻松： [http ://www.justsoftwaresolutions.co.uk/threading/implementing-a-thread-safe-queue-using-condition-variables.html](http://www.justsoftwaresolutions.co.uk/threading/implementing-a-thread-safe-queue-using-condition-variables.html)

为了您的方便，我根据他的文章编写了一些并发容器类，您可以在这里找到： [https ://github.com/paulhoux/Cinder-Samples/tree/master/FlickrImageViewer/include/ph](https://github.com/paulhoux/Cinder-Samples/tree/master/FlickrImageViewer/include/ph)

# netbeans - 如何在 NetBeans 7.2 for C/C++ 中显示编译器错误/警告列表？

> ID：13783257
> 
> 赞同：4
> 
> 时间：2012-12-09T00:01:23.770
> 
> 标签：netbeans, netbeans-7.2

在哪里可以找到 NetBeans 7.2 for C/C++ 中列出编译器错误/警告的窗口？我看到也许 Action Items 窗口可以完成这项工作，但事实并非如此。（我将 MinGW 套件与 MSYS 一起使用。）

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-02-06T16:26:42.827

运行项目时会自动显示输​​出窗口。但如果您没有看到它，请选择“窗口 > 输出 > 输出”或按 Ctrl+4![在此处输入图像描述](../Images/eb9979799aa023fe5a0d0ffbf14a35e6.png)

# php - 语法错误看不到它是否出错了

> ID：13783260
> 
> 赞同：1
> 
> 时间：2012-12-09T00:01:46.087
> 
> 标签：php, mysql, sql

好的，所以我在做一个 mysql 选择，如果没有结果，那么我们将插入它，如果有结果我们更新它，但我收到 Parse 错误：语法错误，意外的 T_VARIABLE

这是我的完整代码

```
$query = mysql_query("SELECT * from new_battles WHERE player1='".$_SESSION['username']."'");
if(mysql_num_rows($query)!=0)
{# If row already exists, then update it.

$result2 = mysql_query("UPDATE new_battles SET player1 = '"$_SESSION['username']"' AND player2 = '"$_SESSION['vsuser']"' 
AND onpokemonplayer1 = '1'  AND onpokemonplayer2 = '1'  WHERE player1 = '"$_SESSION['username']"' ")
or die(mysql_error());
}
else
{# If row doesn't exist, then insert row.
$result = mysql_query("INSERT INTO new_battles (player1, player2,onpokemonplayer1,onpokemonplayer2) VALUES('"$_SESSION['username']"', '"$_SESSION['vsuser']"' , '1', '1')")
or die(mysql_error());
} 
```

它说错误出现在mysql更新位上......也许我正在使用很多and's ???

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-09T00:02:46.703

您忘记`.`在查询中连接您的变量：

```
$result2 = mysql_query("UPDATE new_battles
            SET player1 = '".$_SESSION['username']."',
            player2 = '".$_SESSION['vsuser']."',
            onpokemonplayer1 = '1',
            onpokemonplayer2 = '1'
            WHERE player1 = '".$_SESSION['username']."' ") or die(mysql_error()); 
```

编辑：如评论中所问，您的 UPDATE 查询是错误的，要更新多个字段，您需要用逗号而不是 AND 分隔它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-09T00:03:42.110

每个语法错误都必须处理[字符串连接](http://php.net/manual/en/language.operators.string.php)：

```
<?php
$query = mysql_query("SELECT * from new_battles WHERE player1='".$_SESSION['username']."'");
if(mysql_num_rows($query)!=0){# If row already exists, then update it.

    $result2 = mysql_query("UPDATE new_battles SET player1 = '".$_SESSION['username']."' AND player2 = '".$_SESSION['vsuser']."' 
    AND onpokemonplayer1 = '1'  AND onpokemonplayer2 = '1'  WHERE player1 = '".$_SESSION['username']."' ")
    or die(mysql_error());
}else{# If row doesnt exist, then insert row.
    $result = mysql_query("INSERT INTO new_battles (player1, player2,onpokemonplayer1,onpokemonplayer2) VALUES('".$_SESSION['username']."', '".$_SESSION['vsuser']."' , '1', '1')") or die(mysql_error());
}?> 
```

# mysql - 选择语句从一个表中乘以列，然后从另一个表中添加列

> ID：13783262
> 
> 赞同：2
> 
> 时间：2012-12-09T00:02:06.603
> 
> 标签：mysql, sql

```
mysql> select * from orders;
+---------+------------+------------+------------+----------+----------+
| orderid | customerid | orderdate  | shipdate   | shipping | salestax |
+---------+------------+------------+------------+----------+----------+
|       1 |          1 | 2008-03-31 | 2008-03-31 |     4.99 |     5.00 | 
|       2 |          1 | 2008-04-01 | 2008-04-02 |     5.99 |     5.00 | 
|       3 |          2 | 2008-04-01 | 2008-04-02 |     3.99 |     6.00 | 
|       4 |          3 | 2008-04-02 | 2008-04-02 |     6.99 |     7.50 | 
+---------+------------+------------+------------+----------+----------+
4 rows in set (0.02 sec)
mysql> select * from orderinfo;
+---------+------------+-----+-------+----------+
| orderid | isbn       | qty | price | detailid |
+---------+------------+-----+-------+----------+
|       1 | 0929306279 |   1 | 29.95 |        1 | 
|       1 | 0929306260 |   1 | 49.95 |        2 | 
|       2 | 0439357624 |   3 | 16.95 |        3 | 
|       3 | 0670031844 |   1 | 34.95 |        4 | 
|       4 | 0929306279 |   1 | 29.95 |        5 | 
|       4 | 0929306260 |   1 | 49.95 |        6 | 
|       4 | 0439357624 |   1 | 16.95 |        7 | 
|       4 | 0670031844 |   1 | 34.95 |        8 | 
+---------+------------+-----+-------+----------+
8 rows in set (0.00 sec) 
```

我试图将订单信息表中的数量和价格相乘，然后在我尝试将它们倍增时添加订单表中的运费，但当我添加运费时，我得到的值不正确

这行得通

```
mysql> select orders.orderid,sum(orderinfo.qty*orderinfo.price) as order_total from orders
    -> inner join orderinfo
    -> on orders.orderid=orderinfo.orderid
    -> group by orderid;
+---------+-------------+
| orderid | order_total |
+---------+-------------+
|       1 |       79.90 | 
|       2 |       50.85 | 
|       3 |       34.95 | 
|       4 |      131.80 | 
+---------+-------------+
4 rows in set (0.00 sec) 
```

这给出了不正确的值

```
mysql> select orders.orderid,sum(orderinfo.qty*orderinfo.price+orders.shipping) as order_total from orders
    -> inner join orderinfo
    -> on orders.orderid=orderinfo.orderid
    -> group by orderid;
+---------+-------------+
| orderid | order_total |
+---------+-------------+
|       1 |       89.88 | 
|       2 |       56.84 | 
|       3 |       38.94 | 
|       4 |      159.76 | 
+---------+-------------+
4 rows in set (0.00 sec) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-09T00:05:58.790

您正在应用聚合中的`shipping`速率`SUM()`，当您确实需要之后将其添加到`SUM()`. 这具有为聚合组的*每一*`shipping`行添加值的效果，即 为 的双倍运费和 4 倍运费。*`orderid = 1``orderid = 4`*

 *您可以通过添加`shipping`来做到这一点`GROUP BY`（实际上 MySQL 不需要这样做，但这是一个很好的做法）。

```
SELECT
  orders.orderid,
  /* Add `shipping` outside the SUM() aggregate */
  SUM(orderinfo.qty*orderinfo.price) + orders.shipping AS order_total 
FROM orders
  INNER JOIN orderinfo ON orders.orderid = orderinfo.orderid
GROUP BY
  orderid,
  shipping 
```

### [这是](http://sqlfiddle.com/#!2/0e18e/1)SQLFiddle.com 上的一个示例。*

# java - Android-如何显示外部视频源

> ID：13783264
> 
> 赞同：1
> 
> 时间：2012-12-09T00:02:20.480
> 
> 标签：java, android

我制作了一个由我的华硕平板电脑（TF300T）控制的机器人。我使用通过蓝牙通信的 MIT 应用程序发明者编写了控制应用程序。id 喜欢做的是在机器人上安装某种摄像机（股票无线网络摄像头，或像 sparkfun 之类的专业摄像机），然后修改控制应用程序以显示视频源。我知道我将不得不放弃应用程序发明者来执行此操作并直接使用 SDK 进行编写，这很好，但我想知道这个概念是否可行，如果可以，您能否指出一些记录这一点的资源？

所有帮助表示赞赏。

# ruby-on-rails - 用于适应包含多个值的遗留非规范化表的 Rails 模型

> ID：13783265
> 
> 赞同：3
> 
> 时间：2012-12-09T00:02:37.233
> 
> 标签：ruby-on-rails, activerecord, denormalized

我有一个看起来像的旧表

```
item-detail-table
  some-key,
  item-1,
  description-1,
  item-2,
  description-2,
  item-3,
  description-3,
  item-4,
  description-4,
  item-5,
  description-5,
  other-fielda,
  other-fieldb,
  etc. 
```

我想让我的 Rails 模型返回五个单独的对象，以响应 find_by_some_key 检索到的每个匹配记录，每个对象都具有逻辑结构：

```
normalized-item-detail
  some-key,
  item,
  description,
  other-fielda,
  other-fieldb,
  etc. 
```

我以前没有在 Rails 中做过这样的事情，并且想知道做这样的事情的最好/最惯用的方法。

这将是一个只读模型，因此我可以避免需要能够更新结果对象的所有复杂性。

我是否应该有一个代表单个子条目的中间模型，并且只让这个模型返回一个数组，其中包含我想要的那些嘎嘎声？

谢谢！

G。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T00:43:51.777

你可以制作一个 TableItem-Model ，它有一个方法可以让你返回规范化的类......

喜欢：

```
def TableItem < ActiveRecord::Base
  class NormalizedItem
     #attributes
  end

  def getNormalizedItems
     ret = []
     3.times do |u|
       ....
       ret << NormalizedItem.new(params)
     end
     return ret
  end
end 
```

# http - 为什么在向 ASP.NET Web API 发送 DELETE 动词时收到 400 BAD REQUEST？

> ID：13783267
> 
> 赞同：3
> 
> 时间：2012-12-09T00:02:57.030
> 
> 标签：http, rest, asp.net-mvc-4, asp.net-web-api

我的路线看起来像：

```
config.Routes.MapHttpRoute(
     name: "DefaultApi",
     routeTemplate: "api/{controller}/{id}/{uri}",
     defaults: new { id = RouteParameter.Optional, uri = RouterParameter.Optional }
); 
```

我有一个 Base64 编码的 uri 来代替 {uri} 参数。它没有非法字符（我已正确格式化并检查以确保）。但是，它的长度约为 300-400 个字符。

当我使用 long base64 参数向该地址发送 DELETE 请求时，我收到 400 BAD STATUS, INVALID URL 响应。缩短参数时，它起作用。我怀疑存在最大路径问题？

使用查询字符串代替路径参数是可行的，但我宁愿继续使用 RESTful 方法。我可以在我的 Web API 项目上更改配置设置以允许更长的基于路径的参数吗？

这有效：

```
http://localhost:99999/api/reg/10?uri=<long_base64_parameter> 
```

这不起作用：

```
http://localhost:99999/api/reg/10/<long_base64_parameter> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T04:16:23.237

看起来这些是相关的：

[IIS 7 中的请求 URL 无效](https://stackoverflow.com/questions/8447698/the-request-url-is-invalid-in-iis-7)

[ASP.NET MVC，Url 路由：最大路径 (URL) 长度](https://stackoverflow.com/questions/1185739/asp-net-mvc-url-routing-maximum-path-url-length)

另见：

[http://social.msdn.microsoft.com/Forums/nl/netfxnetcom/thread/723e6bfd-cab7-417b-b487-67f1dcfa524f](http://social.msdn.microsoft.com/Forums/nl/netfxnetcom/thread/723e6bfd-cab7-417b-b487-67f1dcfa524f)

看起来默认情况下可能存在路径段限制，但有几种解决方法（url 重写、注册表更改等）

# javascript - 如何添加带有正确和不正确警报的 HTML 提交测验

> ID：13783268
> 
> 赞同：0
> 
> 时间：2012-12-09T00:03:01.283
> 
> 标签：javascript, html, forms, text

我创建了一个迷你网站，自学 JavaScript 和 PHP，其想法是当你点击“播放”时，你可以通过点击瓷砖来猜测城市，从而在背景中发现城市。我有这个页面在这里工作：http: [//hoverpixel.netii.net/play.html](http://hoverpixel.netii.net/play.html)

但是，我正在努力将 PHP/JS 添加到文本输入表单中。

本质上，我需要使用提交表单来表示：

1.  当进入纽约时 - 正确做得好！（作为文本或警报）
2.  或者当提交任何其他内容时 - 错误重试！

我到处搜索包含此功能但没有任何运气的 HTML 提交表单：/

请有人指出我正确的方向，或发送指向具有此功能的示例代码的链接，我可以编辑吗？

非常感谢，非常感谢任何帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T00:14:42.093

您需要的是`action`html 表单的属性：[http ://reference.sitepoint.com/html/form/action](http://reference.sitepoint.com/html/form/action)

这允许您将输入的数据发送到您的服务器。然后，您可以使用例如 php 访问它：http `$_POST`: [//php.net/manual/en/reserved.variables.post.php](http://php.net/manual/en/reserved.variables.post.php) （假设您也使用表单的操作方法“post”。）

然后，您可以轻松检查您的 php 代码中是否输入了正确的字符串，然后输出正确的 html，让用户知道他们输入的字符串是否正确。

希望这可以帮助！随时要求进一步澄清。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-09T00:26:02.750

尝试使用 jQuery：

**在 test.php 中**

```
...
$data['status'] = 1; // Status of the operation (1: Ok, 0: Error)
$data['msg'] = $msg; // Error message or success
header('Content-Type: application/json');
echo json_encode($data); 
```

**在 test.js 中：**

```
$("#send").click(function () {
    $.post('test.php', $('#yourForm').serialize(), function(data){
        if(data.status == 1){
            $('#result').show().addClass('success').html(data.msg);
        }
        else{
            $('#result').show().addClass('error').html(data.msg);
        }
    }, "json");
    return false;
}); 
```

**在 test.html 中：**

```
<form method="post" id="yourForm">
...
<input id="send" type="button"/>
<span id="result"></span>
</form> 
```

**在 test.css 中：**

```
.success{
    color: blue;
}
.error{
    color: red;
} 
```

审查：

*   [http://api.jquery.com/jQuery.post/](http://api.jquery.com/jQuery.post/)
*   [http://www.electrictoolbox.com/json-data-jquery-php-mysql/](http://www.electrictoolbox.com/json-data-jquery-php-mysql/)

希望能有所帮助。

问候。

# python - python中的“确定性”一词是什么意思？

> ID：13783274
> 
> 赞同：0
> 
> 时间：2012-12-09T00:03:59.850
> 
> 标签：python, python-3.x

我正在为编程考试而学习，我需要知道的一个词是确定性的，因为它适用于 python。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-09T00:08:01.627

如果每次运行程序都获得相同的结果和行为，则程序是确定性的。该术语并非特定于 Python。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-12-09T00:06:18.100

[在 Python 文档中](http://docs.python.org/release/1.5.2p1/lib/Deterministic_Profiling.html)有对此的引用，这是在 Google 上搜索返回的第一个结果。

> 确定性分析旨在反映这样一个事实：所有函数调用、函数返回和异常事件都受到监控，并为这些事件之间的间隔（在此期间用户代码正在执行）进行精确计时。相比之下，统计分析（不是由这个模块完成的）随机采样有效指令指针，并推断出时间花费在哪里。后一种技术传统上涉及较少的开销（因为不需要检测代码），但仅提供时间花费的相对指示。
> 
> 在 Python 中，由于在执行期间有一个解释器处于活动状态，因此不需要存在检测代码来进行确定性分析。Python 自动为每个事件提供一个钩子（可选回调）。此外，Python 的解释特性往往会给执行增加太多开销，以至于确定性分析往往只会在典型应用程序中增加很小的处理开销。结果是确定性分析并不那么昂贵，但提供了有关 Python 程序执行的大量运行时统计信息。
> 
> 调用计数统计可用于识别代码中的错误（令人惊讶的计数），并识别可能的内联扩展点（高调用计数）。内部时间统计可用于识别应仔细优化的“热循环”。累积时间统计应用于识别算法选择中的高级错误。请注意，此分析器中对累积时间的异常处理允许将算法的递归实现的统计数据直接与迭代实现进行比较。

# backbone.js - 在 Backbone.js 中渲染模板时传递的正确数据格式是什么。JSON 还是模型？

> ID：13783279
> 
> 赞同：2
> 
> 时间：2012-12-09T00:04:29.980
> 
> 标签：backbone.js

为了简单起见，我应该这样做

```
$(@el).html @template(model: @model) 
```

或者

```
$(@el).html @template(@model.toJSON()) 
```

我曾经走第一种方式，这就是我被教导的方式。但最近我发现第二种方式也可以接受。它至少在渲染模板时节省了很多 @model.get("attribute_name") 。

那么最好的方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-09T00:19:16.877

I think `@model.toJSON()` is better, for the reason you've mentioned: it makes for cleaner templates.

This:

```
<div><%= name %></div> 
```

Is easier on the eyes than:

```
<div><%= this.model.get("name") %></div> 
```

Look at some of the [example apps](http://backbonejs.org/examples/todos/todos.js) on Backbone.js, you'll see they use the `.toJSON()` approach.

* * *

[I suppose it's also a question of whether you want your templates to have access to the full View object. Obviously, that is not possible once you use `toJSON()`. To me, not having that access is a plus respecting the separation of concerns, since the template should be about presentation, with minimal code, and appearing as close to regular HTML markup as possible.]

# php - 尝试匹配两个数组中的值，如果存在匹配的值，则输出 true

> ID：13783280
> 
> 赞同：2
> 
> 时间：2012-12-09T00:04:32.110
> 
> 标签：php, arrays, intersect, array-intersect

试图匹配两个数组中的值，如果存在匹配的值，则输出为真，也许是 array_intersect 函数？很不确定！任何帮助深表感谢！

基本上有两个我不能完全放入这个盒子的 sql 查询！但是它们每个都返回一个数组 $staffExpertise 和 $moduleExpertise，但我对 php 非常陌生，对数组相交函数更加不熟悉，所以不太确定从这里做什么！

```
 foreach ($results as $row) {
        $staffExpertise = $row['expertise'];
    }

    foreach ($results as $row) {
        $moduleExpertise = $row['expertise'];
    }

    $arrayIntersection = array_intersect($moduleExpertise,   $staffExpertise);

    if($arrayIntersection = ){

    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-09T00:24:17.187

是的 array intersect 做到了。尝试这样的事情：

```
$names_1 = array("Alice", "Bob", "Charlie", "David");
$names_2 = array("Alice", "Bruno");

$intersection = array_intersect($names_1, $names_2);

if(!empty($intersection) ){
    echo "The following item(s) exist in both arrays:"."<br>";
  foreach($intersection as $row){
      echo $row."<br>";
  }

}else{
echo "The arrays do not intersect";
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-09T00:13:55.700

尝试：

```
<?php
    if (in_array($Array1, $VarToCheck)) {
        $return = true;
    }elseif (in_array($Array2, $VarToCheck)){
    $return = true;
    }
?> 
```

# java - 将枚举中的所有名称作为 String[]

> ID：13783295
> 
> 赞同：114
> 
> 时间：2012-12-09T00:06:01.797
> 
> 标签：java, arrays, enums

将枚举元素的名称作为 s 数组获取的最简单和/或最短的方法`String`是什么？

我的意思是，例如，如果我有以下枚举：

```
public enum State {
    NEW,
    RUNNABLE,
    BLOCKED,
    WAITING,
    TIMED_WAITING,
    TERMINATED;

    public static String[] names() {
        // ...
    }
} 
```

该`names()`方法将返回数组`{ "NEW", "RUNNABLE", "BLOCKED", "WAITING", "TIMED_WAITING", "TERMINATED" }`。

* * *

## 回答 #1

> 赞同：115
> 
> 时间：2012-12-09T01:18:46.163

这是任何`enum`课程的单线：

```
public static String[] getNames(Class<? extends Enum<?>> e) {
    return Arrays.stream(e.getEnumConstants()).map(Enum::name).toArray(String[]::new);
} 
```

Pre Java 8 仍然是单行的，尽管不那么优雅：

```
public static String[] getNames(Class<? extends Enum<?>> e) {
    return Arrays.toString(e.getEnumConstants()).replaceAll("^.|.$", "").split(", ");
} 
```

你会这样称呼：

```
String[] names = getNames(State.class); // any other enum class will work 
```

如果您只想为硬编码的枚举类做一些简单的事情：

```
public static String[] names() {
    return Arrays.toString(State.values()).replaceAll("^.|.$", "").split(", ");
} 
```

* * *

## 回答 #2

> 赞同：64
> 
> 时间：2012-12-09T00:09:23.300

为名称创建一个`String[]`数组并调用返回所有枚举值的静态`values()`方法，然后遍历这些值并填充名称数组。

```
public static String[] names() {
    State[] states = values();
    String[] names = new String[states.length];

    for (int i = 0; i < states.length; i++) {
        names[i] = states[i].name();
    }

    return names;
} 
```

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2016-03-01T08:50:37.707

[*这是使用Apache Commons Lang 3*](https://commons.apache.org/proper/commons-lang/)的优雅解决方案：

```
EnumUtils.getEnumList(State.class) 
```

虽然它返回一个列表，但您可以轻松地转换列表`list.toArray()`

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2015-06-02T05:16:45.313

如果您可以使用 Java 8，则效果很好（替代 Yura 的建议，效率更高）：

```
public static String[] names() {
    return Stream.of(State.values()).map(State::name).toArray(String[]::new);
} 
```

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2015-03-03T09:22:45.370

使用 Java 8：

```
Arrays.stream(MyEnum.values()).map(Enum::name)
                    .collect(Collectors.toList()).toArray(); 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2014-04-04T11:55:31.250

我会这样写

```
public static String[] names() {

    java.util.LinkedList<String> list = new LinkedList<String>();
    for (State s : State.values()) {
        list.add(s.name());
    }

    return list.toArray(new String[list.size()]);
} 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2017-08-10T08:39:01.010

另一种方法：

第一

```
Arrays.asList(FieldType.values())
            .stream()
            .map(f -> f.toString())
            .toArray(String[]::new); 
```

另一种方式

```
Stream.of(FieldType.values()).map(f -> f.toString()).toArray(String[]::new); 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2012-12-09T00:15:24.463

这样的事情会做：

```
public static String[] names() {
  String[] names = new String[values().length];
  int index = 0;

  for (State state : values()) {
    names[index++] = state.name();
  }

  return names;
} 
```

[文档建议在大多数情况下使用`toString()`而不是`name()`](http://docs.oracle.com/javase/6/docs/api/java/lang/Enum.html#name%28%29)，但您已在此处明确要求提供名称。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2012-12-09T01:07:40.740

我会这样做（但我可能会将名称设为不可修改的集合而不是数组）：

```
import java.util.Arrays;
enum State {
    NEW,RUNNABLE,BLOCKED,WAITING,TIMED_WAITING,TERMINATED;
    public static final String[] names=new String[values().length];
    static {
        State[] values=values();
        for(int i=0;i<values.length;i++)
            names[i]=values[i].name();
    }
}
public class So13783295 {
    public static void main(String[] args) {
        System.out.println(Arrays.asList(State.names));
    }
} 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2012-12-09T03:25:49.153

我的解决方案，通过字符串操作（不是最快的，但很紧凑）：

```
public enum State {
    NEW,
    RUNNABLE,
    BLOCKED,
    WAITING,
    TIMED_WAITING,
    TERMINATED;

    public static String[] names() {
        String valuesStr = Arrays.toString(State.values());
        return valuesStr.substring(1, valuesStr.length()-1).replace(" ", "").split(",");
    }
} 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2016-09-15T01:29:32.483

普通方式（双关语）：

```
String[] myStringArray=new String[EMyEnum.values().length];
for(EMyEnum e:EMyEnum.values())myStringArray[e.ordinal()]=e.toString(); 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2021-02-05T05:37:37.333

得到了简单的解决方案

```
Arrays.stream(State.values()).map(Enum::name).collect(Collectors.toList()) 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2015-04-07T05:09:34.380

我有同样的需要并使用通用方法（在 ArrayUtils 类中）：

```
public static <T> String[] toStringArray(T[] array) {
    String[] result=new String[array.length];
    for(int i=0; i<array.length; i++){
        result[i]=array[i].toString();
    }
    return result;
} 
```

只需在枚举中定义一个 STATIC ...

```
public static final String[] NAMES = ArrayUtils.toStringArray(values()); 
```

Java 枚举真的错过了 names() 和 get(index) 方法，它们真的很有帮助。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2016-04-12T11:04:14.927

org.apache.commons.lang3.EnumUtils.getEnumMap(State.class).keySet()

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2016-11-04T10:12:33.107

我对@Bohemian 的解决方案做了一些测试。改用朴素循环时性能更好。

```
public static <T extends Enum<?>> String[] getEnumNames(Class<T> inEnumClass){
    T [] values = inEnumClass.getEnumConstants();
    int len = values.length;
    String[] names = new String[len];
    for(int i=0;i<values.length;i++){
        names[i] = values[i].name();
    }
    return names;
}

//Bohemian's solution
public static String[] getNames(Class<? extends Enum<?>> e) {
    return Arrays.stream(e.getEnumConstants()).map(Enum::name).toArray(String[]::new);
} 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2020-10-30T18:05:07.257

与接受的答案非常相似，但自从我了解了 EnumSet，我忍不住到处使用它。因此，对于更简洁的（Java8）答案：

```
public static String[] getNames(Class<? extends Enum<?>> e) {
  return EnumSet.allOf(e).stream().map(Enum::name).toArray(String[]::new);
} 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2012-12-09T00:28:39.380

如果你想要最短的你可以试试

```
public static String[] names() {
    String test = Arrays.toString(values());
    return text.substring(1, text.length()-1).split(", ");
} 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2012-12-09T03:53:28.393

只是一个想法：也许您不需要创建一个方法来将枚举的值作为字符串数组返回。

为什么需要字符串数组？如果您需要这样做，也许您只需要在使用它们时转换这些值。

例子：

```
for (State value:values()) {
    System.out.println(value); // Just print it.
} 
```

* * *

```
for (State value:values()) {
    String x = value.toString(); // Just iterate and do something with x.
} 
```

* * *

```
// If you just need to print the values:
System.out.println(Arrays.toString(State.values())); 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2015-05-18T15:48:33.220

试试这个：

```
public static String[] vratAtributy() {
    String[] atributy = new String[values().length];
    for(int index = 0; index < atributy.length; index++) {
        atributy[index] = values()[index].toString();
    }
    return atributy;
} 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2018-10-12T09:19:28.667

在 Java 7 或更早版本中执行此操作的另一种方法是使用 Guava：

```
public static String[] names() {
    return FluentIterable.from(values()).transform(Enum::name).toArray(String.class);
} 
```

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2019-11-09T07:31:33.350

您可以将枚举值放入字符串列表并转换为数组：

```
 List<String> stateList = new ArrayList<>();

            for (State state: State.values()) {
                stateList.add(state.toString());
            }

    String[] stateArray = new String[stateList.size()];
    stateArray = stateList.toArray(stateArray); 
```

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2019-12-09T15:40:41.567

最简单的方法：

```
Category[] category = Category.values();
for (int i = 0; i < cat.length; i++) {
     System.out.println(i  + " - " + category[i]);
} 
```

类别是`Enum`名称

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2021-02-05T05:56:08.217

您可以通过“Enum::name”获取枚举字符串值

```
public static String[] names() {
    return Arrays.stream(State.values()).map(Enum::name).toArray(String[]::new);
} 
```

此实现不需要额外的“功能”和“字段”。只需添加此功能即可获得您想要的结果。

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2021-02-20T03:19:37.937

根据 Bohemian 对 Kotlin 的回答：

使用`replace()`而不是`replaceAll()`.

```
Arrays.toString(MyEnum.values()).replace(Regex("^.|.$"), "").split(", ").toTypedArray() 
```

旁注：例如，转换为`.toTypedArray()`用于`AlertDialog`'s `setSingleChoiceItems`。

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2021-03-30T15:34:24.223

```
enum CardType {
    CLUB, DIAMOND, HEART, SPADE;

}

public class Control {
    public static void main(String[] args) {

        String[] cardsArray = new String[CardType.values().length];
        int i = 0;

        for (CardType cardType : CardType.values()){
            cardsArray[i] = cardType.name();
            i++;
        }
        //to output the array
        for (int j = 0; j < CardType.values().length; j++){
            System.out.println(cardsArray[j]);
        }
    }
} 
```

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2021-04-23T10:22:04.010

您不需要使用*Streams API*或*Apache Commons*库。这里可以说是最简单和最快的方法：

```
public static String[] names() {
    String[] names = new String[State.values().length];
    State[] values = State.values();
    for (int i = 0, valuesLength = values.length; i < valuesLength; i++) {
        names[i] = values[i].toString();
    }
    return names;
} 
```

# django - 使用重写的 Save 为抽象模型扩展 Django ModelForm

> ID：13783297
> 
> 赞同：2
> 
> 时间：2012-12-09T00:06:19.533
> 
> 标签：django, inheritance, model, modelform

所以我有这个类，它是一堆其他类的抽象父类，我们称它为 ActivityModel （代表某种最新活动/或对该对象所做的更改），我想重写 save 方法以获取另一个参数保存对象的时间，因此我将其定义如下。

```
class ActivityModel(models.Model):
    last_updated = models.DateTimeField(auto_now=True)
    updater = models.ForeignKey(UserProfile)
    change = models.CharField(max_length=255)

    def save(self, updater, change, *args, **kwargs):
        self.updater = updater
        self.change = change
        super(ActivityModel, self).save(*args, **kwargs)

    class Meta:
        abstract = True 
```

但是现在我继承这个类的所有模型都不能使用 ModelForms 因为我已经更改了保存方法以要求第二个字段（与经过身份验证的用户相对应的 UserProfile，每次保存时都必须提供）所以我是想知道我是否可以对 ModelForm 类进行子类化以覆盖它的 save 方法，以便它调用新的 ParentModel.save 方法并填写已提供给它的当前登录用户。我想我可以只在表单 init 上提供 UserProfile，但我遇到的一个大问题是是否可以将 ModelForm 类子类化并像 ParentModelForm 类一样创建，然后可以为 ParentModel 的每个子类创建子类。这可能吗？如果可以，我将如何去做？

非常感谢所有帮助！谢谢你的时间！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-09T00:23:13.210

ModelForm 也是一个与其他类具有相似行为的 python 类。

```
#Inherits from ModelForm class
class ParentModelForm(forms.ModelForm):
...
...
   def save(self, *args, **kwargs):
     ...
     ...
#Inherits from ParentModelForm
class ChildModelForm(ParentModelForm):
..
..
  #You would have to override the Meta class
  class Meta:
      model = Child
  def save(self, *args, **kwargs):
       #Calling the parent model form save method
       super(ChildModelForm, self).save(*args, **kwargs) 
```

# java - 在 JFileChooser 中隐藏“可选文件过滤器”小部件

> ID：13783298
> 
> 赞同：5
> 
> 时间：2012-12-09T00:06:43.187
> 
> 标签：java, swing, jfilechooser

如何在 JFileChooser 中隐藏“可选择的文件过滤器小部件”？通过“可选择的文件过滤器小部件”，我指的是下面包含“文件格式”字样的面板。

![在此处输入图像描述](../Images/dabbd9223f9e4a4bdcbc420964672138.png)

[文档](http://docs.oracle.com/javase/6/docs/api/javax/swing/JFileChooser.html)中有很多关于如何修改出现在小部件中的特定过滤器的信息，但我不知道如何完全隐藏它。

我正在使用 JFileChooser 来选择一个目录，所以这个小部件是不必要的。

有任何想法吗？

*编辑*

最后，我接受了 Andrew Thompson 的建议并将过滤器选择器设置为显示文本“仅目录”。如果它对任何人有帮助，我使用了以下代码：

```
 fc.setFileSelectionMode(JFileChooser.DIRECTORIES_ONLY);
        fc.setFileFilter( new FileFilter(){

            @Override
            public boolean accept(File f) {
                return f.isDirectory();
            }

            @Override
            public String getDescription() {
                return "Directories only";
            }

        }); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-09T00:27:33.850

或者用“仅目录”文本填充它。然后它将按照用户的期望出现，并带有说明。

* * *

**文件格式：** `Any Folder`

* * *

# linux - LTTng 2.0：sys_unknown 系统调用

> ID：13783302
> 
> 赞同：2
> 
> 时间：2012-12-09T00:07:17.147
> 
> 标签：linux, linux-kernel, lttng

我正在使用 LTTng 2.0 来跟踪单击 USB 鼠标时发生的事件。我得到的跟踪是这样的（不需要的行已被删除）：

```
irq_handler_entry   name=i8042, irq-12
irq_handler_exit    Irq-12, ret=1 (handled)
exit_syscall        ret=1104
sys_unknown         Id=18, args={3, 140405224710240, 1024, 59772114944, 1024, 140405251328896}
exit_syscall        Ret=1024
sys_unknown         Id=18, args={3, 140405255394560, 1024, 3256243200, 2048, 1}
exit_syscall        Ret=1024
sys_unknown         Id=18, args={3, 140405255394560, 1024, 3256243200, 2048, 1}
exit_syscall        Ret=1024
sys_unknown         Id=18, args={3, 140405255303968, 1024, 3256252416, 1024, 1}
exit_syscall        Ret=1024
sys_writev          Vec=140737365122800, vlen=2, fd=4
exit_syscall        Ret=24
sys_read            Buf=140405224710160, count=135168, fd=4 
```

这是当我收到 IRQ 12（鼠标中断）时开始的跟踪部分，我试图跟踪之后发生的事件，但我似乎无法解决其中的“sys_unknown”部分。我将不胜感激任何形式的帮助。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-30T14:10:44.753

“id”字段表示系统调用号。在 LTTng 2.x 中尚未实现探测的系统调用显示为“sys_unknown”。

系统调用 ID 与其实际名称之间的映射可以通过查看特定于体系结构的 unistd.h 文件手动完成，该文件通常安装在系统范围内。例如，在 x86-64 上，我可以在以下位置找到此信息：/usr/include/asm/unistd_64.h

# ocaml - 为什么方法调度有时很慢？

> ID：13783307
> 
> 赞同：12
> 
> 时间：2012-12-09T00:08:24.853
> 
> 标签：ocaml

阅读 caml-list 上的一些旧帖子时，我发现了 Jacques Garrigues 的以下帖子：http: [//caml.inria.fr/pub/ml-archives/caml-list/2007/11/24e8215c8d844b05db58ed3f79c9645f.en.html](http://caml.inria.fr/pub/ml-archives/caml-list/2007/11/24e8215c8d844b05db58ed3f79c9645f.en.html)

我关心的报价如下：

> 对任意对象的方法调用可能很慢。这是因为，由于子类型化，在某些情况下无法知道方法在表中的位置，因此必须进行二分查找。

谁能解释为什么会这样？为什么确切的子类型（我在这种情况下假设的继承）会影响这一点？这是 OCaml 实现的情况，还是其他语言也受此影响？

请向我指出有关此的更多资源，谷歌让我失望了。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-09T00:20:02.010

I think that delnan's comment that, in OCaml, “Subtyping != inheritance” holds the insight to the explanation.

```
$ rlwrap ocaml
        OCaml version 4.00.1

# let f o = o#x + o#y ;;
val f : < x : int; y : int; .. > -> int = <fun>
# 
```

Function `f` above accepts any object `o` that has methods `x : int` and `y : int`. Not objects that inherit from some class `c` in which an offset for these methods could have been fixed in advance, mind you. **Any** object with these methods. I guess this is difficult to implement, and may be one of the cases Jacques is referring to in his message.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-07T18:56:48.223

> 谁能解释为什么会这样？

通过标称类型，可以在编译时为每个方法分配一个唯一的整数，因此可以通过索引到数组中找到虚函数。对于结构类型（如在 OCaml 中），这是无法做到的，因此结构的散列（即方法名称）用于在字典中搜索虚拟方法的函数指针。

> 为什么确切的子类型（我在这种情况下假设的继承）会影响这一点？

子类型是虚拟调度的先决条件。

> 这是 OCaml 实现的情况，还是其他语言也受此影响？

只是 OCaml 的实现。在 F# 中，我使用反射和运行时代码生成来实现相同的效果，而不会影响调用时性能。

# java - 第一个定时器 Swing 应用，需要帮助实现应用逻辑

> ID：13783311
> 
> 赞同：1
> 
> 时间：2012-12-09T00:08:46.020
> 
> 标签：java

我为一个进行电气计算的程序制作了 Swing 的“脸”。它看起来很棒，但我现在似乎面临着关于如何实现底层计算的一组令人眼花缭乱的选项。代码有点长，所以我将尝试笼统地描述。

我正在处理的面板计算电压降：

1.  用户可以从一组两个单选按钮中进行选择，这些单选按钮选择计算公式的类型。
2.  用户为 (7) 个不同的变量选择值，其中 (3) 个变量仅出现在公式的一种类型中。用户选择可编辑和不可编辑的组合框。
3.  还有一个额外的 (4) 个变量，用户可以选择使用更多单选按钮来解决哪个变量。旁边还有一些额外的单选按钮可以更改变量的格式（即英尺、米）。
4.  结果显示在文本字段中，并在用户更改值时更新。

我认为这不需要太多的处理能力，所以这一切都在事件调度线程中完成——很好，因为我对线程还不太了解。

以我对 Java 和编程的有限知识，我可以想到几种不同的方法来实现这个，可能还有一些我还不知道。即使是我所知道的那些对我来说仍然显得有点“朦胧”。

A. 使用事件监听器，当对面板进行任何合法更改时触发，并将所有变量作为字符串文字传递给一个整体逻辑类构造函数，该构造函数解析所有内容并计算结果并具有返回的方法结果。我猜它可能有不同的构造函数签名，可以帮助弄清楚要做什么。每次用户更改面板时，都会创建一个新对象来计算结果。这似乎很丑陋且难以使用。

B. “父工厂” - 除了将变量作为参数传递给抽象类中的方法外，它与 (A.) 几乎相同，该方法确定要做什么并创建其子类之一的实例。我认为，这至少会使应用程序逻辑的工作更容易一些。

C. 观察者和可观察者？我真的不太了解它是如何工作的。

D. 绑定？同样的事情-我对此还不太了解。

我还需要在不同的模块中将这种类型的计算串在一起。所以我想重用逻辑。

那么 - 我应该跳下哪个兔子洞？我不想把自己编码到一个角落里。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T00:38:02.090

创建单个支持对象并在数据更改时更新它（监听事件）。

然后从对象请求更改的计算（如果您计划允许在数据更改时通知多个源，则让 Swing 对象侦听“CalculationUpdate”事件）。

每次更改都构造一个新对象完全浪费内存——创建然后忽略对象是遇到 GC 问题的好方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-09T03:38:57.410

通常，已发现将用户交互逻辑（看起来很好，与您已经描述的内容相对应）与“业务逻辑”（似乎是您所要求的）分开是有用的. 重要的是使它们彼此分开，而您似乎已经通过先编写其中一个来做到这一点。到现在为止还挺好。

我认为您不需要另一个答案所建议的“单一支持对象”，但我同意您的代码中需要一个“模型”。这可以是一个类或多个类；这里重要的是它们实现了您的逻辑，而不依赖于对用户的演示或与用户的交互。用户可以以任何方式提供数字并将它们传递给模型，模型将返回其答案，而模型之外的其他东西将决定如何呈现该答案。

例如，监听器是 Swing 应用程序的一部分（用户做某事并触发监听器方法）：它们是用户交互的一部分。如果您以不同的方式获得问题的输入，则不会有这些侦听器，因此它们不是业务逻辑的一部分。

我还认为验证是您的用户交互代码的一部分，因为如果您更改某人输入数字的方式，那么验证会更改，而无需了解这些数字的使用方式。因此，在将数字输入模型进行计算之前，我会验证用户的输入；我会记录下该代码的输入应该已经过验证，以防以后没有意识到的人再次使用它们。

因此，当有人更改值时，我希望会触发一个侦听器（或类似的侦听器）来验证输入并在存在无效数据时为用户生成消息；如果输入有效，我希望它调用一个方法来进行计算并返回值，然后该侦听器（或 SwingWorker 线程的侦听器，如果您不知道，请查看它）进行更新屏幕上的结果（也应该只在用户交互逻辑中完成。

您提到传递字符串；在验证之后，我还将对用户交互代码进行编程，以将字符串值转换为应该表示数字的数字。它们是输入字符串这一事实是用户如何与您的代码交互的一部分，而不是业务逻辑的一部分。如果一个从其他地方获取数字的程序想要使用您的计算模型，那么如果仅仅因为您的模型习惯于在这种情况下从用户那里获取字符串，它就必须将其数字转换为字符串，那将是一件很奇怪和愚蠢的事情。

我希望这会有所帮助。

# c++ - dynamic_cast 是如何工作的？

> ID：13783312
> 
> 赞同：18
> 
> 时间：2012-12-09T00:08:47.940
> 
> 标签：c++, dynamic, dynamic-cast

如果您有以下情况：

```
class Animal{};

class Bird : public Animal{};

class Dog : public Animal{};

class Penguin : public Bird{};

class Poodle : public Dog{}; 
```

是否`dynamic_cast`只检查一个类是否是另一个类的派生类，或者一个类是否是另一个类的基类？所以如果我有：

```
Bird* bird;
Animal* animal;

bird = dynamic_cast<Animal*>(bird);
animal = dynamic_cast<Bird*>(animal); 
```

`bird`现在将指向一个`Animal`类，以便我可以使用`bird->some_function();`它并调用函数`Animal`？`animal`现在指向一个`Bird`类，所以我可以做它会`animal->some_function();`调用？`some_function();``Bird`

我一直在试图弄清楚它是如何`dynamic_cast`工作的，而我在网上找到的资源并不是最有帮助的。如果有人可以对它的功能和某些有用的实例提供其他见解`dynamic_cast`，我将不胜感激。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-12-09T00:26:33.787

动态转换最重要的一点是它应该应用于`polymorphic type`. 没有它，动态演员表就像静态演员表一样工作。

什么是多态类型？任何具有至少一个虚拟方法或虚拟析构函数或虚拟基类的类都是多态的。只有这些类型在其数据布局中具有**虚拟方法表(VMT)。**没有任何虚拟的类没有 VMT。该标准没有说明应该如何实现多态性和虚拟方法，但据我所知，所有编译器都这样做。

在您的示例中，类不是多态的。在我看来，如果将动态转换应用于非多态类型时编译器会发出错误会更好。然而，他们不这样做。这增加了混乱。

所有类的 VMT 指针都不同。这意味着在运行时查看：

```
Animal* animal; 
```

可以知道对象的真正类别是什么。是a`Bird`还是a`Dog`还是别的什么。从 VMT 的值知道真正的类型，生成的代码可以根据需要进行调整。

这是一个例子：

```
class Animal   { virtual ~Animal();   int m1; };
class Creature { virtual ~Creature(); int m2; };

class Bird : public Animal, Creature { };

Bird *bird = new Bird();
Creature *creature = dynamic_cast<Creature*>(bird); 
```

请注意，生物不是第一个基类。这意味着指针将移动到指向对象的右侧部分。尽管如此，以下内容仍然有效：

```
Animal *animal = dynamic_cast<Animal*>(creature);   // Case2. 
```

因为当 Creature 是其他类的一部分时，它的 VMT 与单独使用时对象的 VMT 不同：

```
Creature *creature1 = new Creature(); 
```

这种区别允许正确实现动态转换。在示例`Case2`中，指针将向后移动。我对此进行了测试。这行得通。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-12-09T00:28:06.500

`dynamic_cast`运算符检查指针所指向的*实际*对象的类型。这就是它与 compile-time 不同的原因`static_cast`；结果`dynamic_cast`取决于运行时数据。

```
dynamic_cast<Animal*>(bird) 
```

在上述情况下，这里不需要so`Animal`的超类（编译器会将其视为相同或根本不进行强制转换）。`Bird``dynamic_cast``static_cast`

```
dynamic_cast<Bird*>(animal) 
```

`animal`在这种情况下，当该语句实际执行时，运行时系统将检查实际指向的任何类型对象的实际类型。它可能是 的一个`Bird`或子类`Bird`，在这种情况下，结果将是一个有效的`Bird*`。如果对象不是 a `Bird`，那么结果将是`NULL`。

`dynamic_cast`您将这些调用的结果分配回原始指针这一事实使您的问题更加复杂。这可能是部分混乱的来源，我在上面的讨论中省略了这方面。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-12-09T00:27:25.573

正如你所说，这没有多大意义。

的重点`dynamic_cast`是在运行时解决多态性。所以实际有趣的场景是这样的

```
void animalhandler(Animal& animal); 
```

然而，它*不是*（至少不仅）用 的实例调用的`Animal`，而是用任何子类调用的。您通常甚至不需要知道：您可以调用任何虚拟成员，`animal`并确保 C++ 调用正确的重载，无论派生类`*animal`实际属于什么。

但有时您希望做一些只有通过一个特定的派生实例才能实现的事情。在这种情况下，您使用`dynamic_cast`，例如

```
void animalhandler(Animal& animal) {
  if(auto as_bird = dynamic_cast<Bird*>(&animal)) {
    // bird-specific code
  }
} 
```

其中`if`only 触发 if`animal`实际上是 a `Bird`（或派生自`Bird`），否则仅`dynamic_cast`返回解释为.`nullptr``if``false`

现在，你想出了相反的想法。让我们看看这会是什么样子：

```
 if(auto as_bird = dynamic_cast<Bird*>(&animal)) {
    if(auto as_animal = dynamic_cast<Animal*>(as_bird)) {
      // animal-specific code
    }
  } 
```

...等等，动物特异性有什么意义吗？不，因为*所有* `Bird`的 s 都是`Animal`s，我们知道在编译时，所以没有必要动态检查它。您仍然可以编写它，但您最好将其省略并`as_bird`直接使用，因为它可以访问所有可以访问的成员`as_animal`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-09T00:40:15.663

来自 C++ 工作草案

> **动态转换 [expr.dynamic.cast]**
> 
> 1 表达式 dynamic_cast<T>(v) 的结果是将表达式 v 转换为 T 类型的结果。T 应为指向完整类类型的指针或引用，或“指向 cv void 的指针”。dynamic_cast 运算符不应抛弃 constness (5.2.11)。
> 
> 6 否则，v 应是指向多态类型 (10.3) 的指针或左值。
> 
> 8 如果 C 是 T 指向或引用的类类型，则运行时检查在逻辑上执行如下：
> - 如果在 v 指向（引用）的最派生对象中，v 指向（引用）公共基类C 对象的子对象，并且如果只有一个 C 类型的对象派生自 v 指向（引用）的子对象，则结果指向（引用）该 C 对象。
> - 否则，如果 v 指向（引用）最派生对象的公共基类子对象，并且最派生对象的类型具有 C 类型的基类，即明确且公共，则结果指向（引用）到最派生对象的 C 子对象。
> - 否则，运行时检查失败。

您可以从这些条款中得出什么结论

*   `dynamic_cast`适用于多态类
*   它在*运行时*查看指向（或引用）的对象
*   它根据所指向对象的*公共基类决定强制转换是成功还是失败*

# python - 列表列表的总和；返回总和列表

> ID：13783315
> 
> 赞同：33
> 
> 时间：2012-12-09T00:09:23.523
> 
> 标签：python, list, matrix, sum

让`data = [[3,7,2],[1,4,5],[9,8,7]]`

假设我想对列表中每个列表的索引元素求和，例如在矩阵列中添加数字以获得单个列表。我假设数据中的所有列表的长度都是相等的。

```
 print foo(data)

   [[3,7,2],
    [1,4,5],
    [9,8,7]]
    _______
 >>>[13,19,14] 
```

如何在不出现索引超出范围错误的情况下遍历列表列表？也许是拉姆达？谢谢！

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2012-12-09T00:18:27.987

You could try this:

```
In [9]: l = [[3,7,2],[1,4,5],[9,8,7]]

In [10]: [sum(i) for i in zip(*l)]
Out[10]: [13, 19, 14] 
```

This uses a combination of `zip` and `*` to unpack the list and then zip the items according to their index. You then use a list comprehension to iterate through the groups of similar indices, summing them and returning in their 'original' position.

To hopefully make it a bit more clear, here is what happens when you iterate through `zip(*l)`:

```
In [13]: for i in zip(*l):
   ....:     print i
   ....:     
   ....:     
(3, 1, 9)
(7, 4, 8)
(2, 5, 7) 
```

In the case of lists that are of unequal length, you can use `itertools.izip_longest` with a `fillvalue` of `0` - this basically fills missing indices with `0`, allowing you to sum all 'columns':

```
In [1]: import itertools

In [2]: l = [[3,7,2],[1,4],[9,8,7,10]]

In [3]: [sum(i) for i in itertools.izip_longest(*l, fillvalue=0)]
Out[3]: [13, 19, 9, 10] 
```

In this case, here is what iterating over `izip_longest` would look like:

```
In [4]: for i in itertools.izip_longest(*l, fillvalue=0):
   ...:     print i
   ...:     
(3, 1, 9)
(7, 4, 8)
(2, 0, 7)
(0, 0, 10) 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-12-09T00:15:54.090

对于任何矩阵（或其他雄心勃勃的数值）运算，我建议您研究 NumPy。

解决问题中显示的沿轴的数组总和的示例是：

```
>>> from numpy import array
>>> data = array([[3,7,2],
...     [1,4,5],
...     [9,8,7]])
>>> from numpy import sum
>>> sum(data, 0)
array([13, 19, 14]) 
```

这是 numpy 的 sum 函数的文档：http: [//docs.scipy.org/doc/numpy/reference/generated/numpy.sum.html#numpy.sum](http://docs.scipy.org/doc/numpy/reference/generated/numpy.sum.html#numpy.sum)

特别是第二个参数很有趣，因为它可以轻松指定应该总结的内容：所有元素或仅可能是 n 维数组（如）的特定轴。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2013-07-14T13:04:49.420

这将为您提供每个子列表的总和

```
data = [[3,7,2],[1,4],[9,8,7,10]]
list(map(sum, data))
[12, 5, 34] 
```

如果你想对所有元素求和并只得到一个总和，那么使用这个

```
data = [[3,7,2],[1,4],[9,8,7,10]]
sum(sum(data, []))
51 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-09T00:17:39.070

```
>>> data = [[1, 2, 3], [1, 2, 3], [1, 2, 3]]
>>> for column in enumerate(data[0]):
...     count = sum([x[column[0]] for x in data])
...     print 'Column %s: %d' % (column[0], count)
... 
Column 0: 3
Column 1: 6
Column 2: 9 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-09T00:15:18.783

这确实取决于您假设所有内部列表（或行）的长度相同，但它应该做您想要的：

```
sum_list = []

ncols = len(data[0])

for col in range(ncols):
    sum_list.append(sum(row[col] for row in data))

sum_list
Out[9]: [13, 19, 14] 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-06-19T13:27:27.927

```
def sum(L):
res = list()
for j in range(0,len(L[0])):
    tmp = 0
    for i in range(0,len(L)):
        tmp = tmp + L[i][j]
    res.append(tmp)
return res 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-10-11T06:13:22.687

将不同或相同长度的列表相加的最简单的解决方案是：

```
total = 0
for d in data:
    total += sum(d) 
```

一旦你理解了列表理解，你就可以缩短它：

```
sum([sum(d) for d in data]) 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-01-05T18:04:34.070

对于数据是字符串列表的情况。逐元素求和或连接字符串列表的列表。

```
>>> a = [list('abc'),list('def'),list('tyu')]
>>> a
[['a', 'b', 'c'], ['d', 'e', 'f'], ['t', 'y', 'u']]
>>> [''.join(thing) for thing in zip(*a)]
['adt', 'bey', 'cfu']
>>> 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-03-24T10:18:01.123

> ```
> numArr = [[12, 4], [1], [2, 3]]
> 
> sumArr = 0
> 
> sumArr = sum(sum(row) for row in numArr)
> 
> print(sumArr) 
> 
> the answere: 22 
> ```

我做了什么：当你像这样做“for”时，例如：[row.append(1) for row in numArr] 列表将变为：[[12, 4, 1], [1, 1], [2 , 3, 1]] 我使用了 python 中的 sum() 函数，该函数获取列表并对其进行迭代，并将列表中所有数字的总和。当我执行 sum(sum()) 时，我得到了大列表中所有列表的总和。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-10-11T06:00:21.973

此解决方案假定一个方阵并使用两个 for 循环来循环列和行，在此过程中逐列添加。结果以列表形式返回。

```
def foo(data):
    # initialise length of data(n) and sum_of_col variable 
    n = len(data)
    sum_of_col = []

    # iterate over column
    for col_i in range(n):
        # column sum
        col_count = 0;

        #iterate over row
        for row_i in range(n):
            col_count += data[row_i][col_i]

        # append sum of column to list    
        sum_of_col.append(col_count)

    return sum_of_col 
```

# html - IE8 和 IE7 CSS 问题与 div 和定位

> ID：13783316
> 
> 赞同：1
> 
> 时间：2012-12-09T00:09:51.293
> 
> 标签：html, css, internet-explorer-8, internet-explorer-7

我需要帮助弄清楚为什么我的 div class="content" 没有在 IE7 和 IE8 中正确显示 - 在 IE9 中看起来很棒：http: [//kathykroening.com/](http://kathykroening.com/)

内容应该有一个黑色的背景覆盖，但它似乎没有通过并且定位也不正确，因为标题出现在它应该在下面的顶部。

这是HTML：

```
 <body class="home page page-id-81 page-template-default">

    <div id="wrapper">

        <header>
            <div class="toph">
                <h1 class="logo"><a href="http://kathykroening.com">Kathy Kroening</a></h1><!-- /.logo -->
            </div>
            <div class="bottomh">
                <nav class="main">
<ul class="inner"><li id="menu-item-194" class="menu-item menu-item-type-post_type menu-item-object-page current-menu-item page_item page-item-81 current_page_item menu-item-194"><a href="http://kathykroening.com/">Home</a></li>
<li id="menu-item-151" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-151"><a href="http://kathykroening.com/about-kathy/">About Kathy</a></li>
<li id="menu-item-152" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-152"><a href="http://kathykroening.com/experience/">Experience</a></li>
<li id="menu-item-153" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-153"><a href="http://kathykroening.com/ideas/">Ideas</a></li>
<li id="menu-item-156" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-156"><a href="http://kathykroening.com/open-house/">Open House</a></li>
<li id="menu-item-155" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-155"><a href="http://kathykroening.com/cabinetry/">Cabinetry</a></li>
</ul>
                </nav><!-- /.main -->
                <nav class="crumbs">
                </nav><!-- /.crumbs -->
            </div>
        </header><!-- /header -->

        <section id="container">
                <img src="http://kathykroening.com/wp-content/uploads/2012/11/homebg.jpg" alt="" class="pagebg">

        <div class="inner">
            <div class="content">

                <p>Before color, fabric and furnishing, there’s interior architectural design – the essential space planning that literally makes room for your ultimate vision.</p>

            </div>
        </div>

        <div class="caption">
            <h2>Interior Architectural Design</h2>
        </div><!-- /.caption -->
                </section><!-- /#container -->

    </div><!-- /#wrapper -->

</body> 
```

这是CSS：

```
* { margin: 0; padding: 0;}
html { height: 100%; overflow: auto;}
body { font-family: 'Questrial', sans-serif; font-size: 12/13px; line-height: 115%; }
a { text-decoration: none; outline: none !important;}

.alignleft { float: left;}
.alignright { float: right;}

#wrapper { width: 1024px; margin: 0 auto; position: relative; display: block;}
.inner { width: 900px; margin: 0 auto; position: relative; }

header { height: 215px; overflow: hidden;}
.toph { height: 150px; line-height: 150px; text-align: center;}
.logo a { display: inline-block; width: 360px; height: 96px; background: url('assets/img/logo.png') no-repeat; text-indent: -9999px; position: relative; line-height: 96px;}
.bottomh { height: 65px;}
header ul { list-style: none;}
header nav { clear: both; display: inline-block; width: 100%; position: relative;}
header nav li { float: left;}
header nav li a { text-transform: uppercase; font-size: 14px; }
nav.main { height: 35px; background: url('assets/img/mainnavbg.jpg') no-repeat; line-height: 35px;}
nav.main li { padding: 0 45px;}
nav li.first { padding-left: 0 !important; border-left: 0 !important;}
nav li.last { padding-right: 0 !important; border-right: 0 !important;}
nav.main li.last { float: right;}
nav.main a { color: #fff;}
nav.main a:hover,
nav.main li.current_page_item a,
nav.main li.current-page-ancestor a { border-bottom: 1px solid #fff; padding-bottom: 3px;}
nav.crumbs a { color: #726658; font-size: 13px;}
nav.crumbs ul { height: 13px; line-height: 13px; padding: 3px 0;}
nav.crumbs a:hover,
nav.crumbs li.current_page_item a { color: #90492d;}
nav.crumbs li {  padding: 0 10px; border-right: 1px solid #e1dedb; border-left: 1px solid #716558;}

footer { margin-top: 5px; height: 30px; line-height: 30px; clear: both; font-size: 12px; color: #797979; }

section#container { height: 550px; position: relative; display: block;}
.pagebg { position: absolute; z-index: 1; }
.pagebg.block { right: 45px;}
.content {  z-index: 999; position: absolute; left: -50px; width: 250px; height: 470px; background: rgba(0,0,0,0.8); color: #fff; padding: 40px 35px;}
.scroller { height: 500px; overflow: auto; width: 250px;}
.content.block { background: #262223;}
.content h2 { font-weight: 100; text-transform: uppercase; font-size: 21px; margin-bottom: 10px;}
.content h3 { text-transform: uppercase; font-size: 15px; font-weight: 100; padding: 3px 5px; background: #58595b; display: inline-block; margin-bottom: 10px;}
.content p { font-size: 14px; padding-bottom: 10px; }
.content a { color: inherit; text-decoration: underline; }
.content ul { list-style-position: inside;}

body.home .content p { font-size: 19px; line-height: 150%;}
.caption { background: rgba(255,255,255,.8); padding: 10px 5px; position: absolute; bottom: 20px; width: 100%; text-transform: uppercase; z-index: 9999;}
.caption h2 { width: 875px; margin: 0 auto; font-size: 17px; letter-spacing: 20px; font-weight: 100;} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T00:34:52.657

以下是您可以做的三件事来改善您的情况。

1）使用[normalize.css](http://necolas.github.com/normalize.css/)而不是`* { margin:0; padding:0;}`css 重置。这将有助于添加对在 html5 中添加的部分、文章、标题等标签的支持。

2) 使用[html5shiv](http://code.google.com/p/html5shiv/)这样就完成了对 ie8 和更低版本不知道的 html5 元素的支持，并允许您对它们进行样式设置。

3) 对于较低 IE 中的 rgba 支持，请查看这篇关于[跨浏览器 rgba 支持的文章](http://robertnyman.com/2010/01/11/css-background-transparency-without-affecting-child-elements-through-rgba-and-filters/)

添加一个很好的衡量标准，看起来您正在设计一个 wordpress 主题，我建议您按照他们的准则来格式化您的 css。 [Wordpress CSS 编码标准](http://make.wordpress.org/core/handbook/coding-standards/css/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-09T00:35:11.790

**您的第一个问题是 IE bellow 9 不理解 RGBA 颜色。**

解决方法是对渐变背景使用滤镜，但两边使用相同的颜色：

```
background-color: rgba(0, 0, 0, 0.75); /* R G B Alpha */
filter: progid:DXImageTransform.Microsoft.Gradient(GradientType=0, StartColorStr='#BF000000', EndColorStr='#BF000000'); /* Alpha R G B */ 
```

请注意，过滤器将前 2 个字符作为 alpha 的十六进制值，介于 00 和 FF 之间。

获得所需值的一种简单方法是进行一些简单的计算：

```
alpha:
    range: 0 - 1
    value: 0.75

hexa:
    range: 00 - FF = 0 - 255
    value: 0.75 * 255 = 191 = BF 
```

要从十进制中获取十六进制值，您可以在程序员模式下使用 Windows 计算器、Photoshop 的颜色选择器等工具或任何在线转换器工具（甚至 Google 也可以：[https ://www.google.com/?q= 191+到+十六进制](https://www.google.com/?q=191+to+hex)）

**您的第二个问题是 9 以下的 IE 不支持 HTML 5 标签。**

您可以使用一些工具来帮助解决此问题，例如：

*   [http://modernizr.com/](http://modernizr.com/)
*   [http://code.google.com/p/html5shim/](http://code.google.com/p/html5shim/)或[http://code.google.com/p/html5shiv/](http://code.google.com/p/html5shiv/)
*   [http://necolas.github.com/normalize.css/](http://necolas.github.com/normalize.css/)

等等...

我强烈推荐使用[http://html5boilerplate.com/](http://html5boilerplate.com/)

# php - 对具有相同 ID 的所有文本字段进行只读

> ID：13783318
> 
> 赞同：3
> 
> 时间：2012-12-09T00:10:26.517
> 
> 标签：php, javascript

我试图通过仅单击一个按钮来启用/禁用具有相同 ID 的列中文本框的只读属性，但我的代码似乎不起作用。我仍然不熟悉 PHP 的工作原理

PHP中的代码：

```
<input type='text' name='nTotal[$i]' value='$row->Total' size='5'  readonly='true' id='ntotal[$i]'> 
```

javascript中的代码：

```
var a = document.getElementById(ntotal); //ntotal[$i] is the ID name of textbox in PHP
for (var i=0;i<a.length;i++){            

 if (a[i].readonly == 'false' ) {
        a[i].readonly = 'true';
         }

 else if(a[i].readonly == 'true'){ 
        a[i].readonly = 'false';
          }
    }
} 
```

谁能给我一个提示为什么它不起作用？我尝试使用名称而不是 ID，但结果相同。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T02:22:13.973

正如其他人所提到的，您应该使用类，`getElementsByClassName`而不是`getElementById`因为后者最多只会返回一个元素，基于 id 是唯一的规范。此外，`readOnly`（区分大小写，大写 O）属性是布尔值，因此无法将其与字符串进行比较。

```
var a = document.getElementsByClassName(ntotal);
for (var i=0;i<a.length;i++) {
    a[i].readOnly = !a[i].readOnly;
} 
```

您应该使用属性而不是像其他所有答案所建议的属性。更简洁，更可预测。该`readonly`属性是布尔值，因此只有它的存在才是重要的，而不是值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-09T00:37:13.370

尝试：

```
var arr = document.querySelectorAll('[id="'+ntotal+'"]');   
for(var i=0;i<arr.length;i++){
    if(arr[i].getAttribute('readonly')=='readonly')
        arr[i].removeAttribute('readonly');
    else
        arr[i].setAttribute('readonly', 'readonly');
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-09T00:33:35.170

尝试修正命名约定（ID 必须是唯一的，而不仅仅是数字）并使用 getAttribute、setAttribute 和 remove eAttribute 函数。

```
<input type='text' name='nTotal' value='1' size='5' readonly='readonly' id='text_1'> 
<input type='text' name='nTotal' value='2' size='5' id='text_2'> 
```

```
var a = document.getElementsByName("nTotal");
for (var i=0;i<a.length;i++){
   isreadonly = a[i].getAttribute("readonly");
    if (isreadonly) {
      a[i].removeAttribute("readonly");                
    }
    else
    {
      a[i].setAttribute("readonly", "true");        
    }
} 
```

刚刚在以下位置设置了一个工作演示：http: [//jsfiddle.net/wXbzq/](http://jsfiddle.net/wXbzq/)

或者更好的是，使用 jQuery ( [http://jquery.com](http://jquery.com) )……你会喜欢的！

要在 jQuery 中禁用：

```
$('nTotal').removeAttr('readonly'); 
```

要在 jQuery 中启用：

```
$('nTotal').attr('readonly', true); 
```

# java - 如何创建各种类型的输入以测试我的算法？

> ID：13783319
> 
> 赞同：-6
> 
> 时间：2012-12-09T00:10:44.710
> 
> 标签：java, algorithm, sorting, quicksort

我有来自[http://algs4.cs.princeton.edu](http://algs4.cs.princeton.edu)的以下代码，它在 0 到 1 之间的一组随机数上实现快速三向分区的快速排序，但是我想在以下集合上实现它

1.  有序列表
2.  倒序列表
3.  一个包含相同值的列表
4.  25% 的列表已排序

我如何创建它们以便将它们提供给方法？

这是我当前`main()`调用测试的方法：

```
public static void main(String[] args) {

    // generate array of N random reals between 0 and 1
    int N = Integer.parseInt(args[0]);
    Double[] a = new Double[N];
    for (int i = 0; i < N; i++) {
        a[i] = Math.random();
    }

    // sort the array
    sort(a);

    // display results
    for (int i = 0; i < N; i++) {
        System.out.println(a[i]);
    }
    System.out.println("isSorted = " + isSorted(a));

} 
```

* * *

其余代码（不太相关）：

```
public class QuickX {
private static final int CUTOFF = 8;  // cutoff to insertion sort, must be >= 1

public static void sort(Comparable[] a) {
    sort(a, 0, a.length - 1);
}

private static void sort(Comparable[] a, int lo, int hi) { 
    int N = hi - lo + 1;

    // cutoff to insertion sort
    if (N <= CUTOFF) {
        insertionSort(a, lo, hi);
        return;
    }

    // use median-of-3 as partitioning element
    else if (N <= 40) {
        int m = median3(a, lo, lo + N/2, hi);
        exch(a, m, lo);
    }

    // use Tukey ninther as partitioning element
    else  {
        int eps = N/8;
        int mid = lo + N/2;
        int m1 = median3(a, lo, lo + eps, lo + eps + eps);
        int m2 = median3(a, mid - eps, mid, mid + eps);
        int m3 = median3(a, hi - eps - eps, hi - eps, hi); 
        int ninther = median3(a, m1, m2, m3);
        exch(a, ninther, lo);
    }

    // Bentley-McIlroy 3-way partitioning
    int i = lo, j = hi+1;
    int p = lo, q = hi+1;
    while (true) {
        Comparable v = a[lo];
        while (less(a[++i], v))
            if (i == hi) break;
        while (less(v, a[--j]))
            if (j == lo) break;
        if (i >= j) break;
        exch(a, i, j);
        if (eq(a[i], v)) exch(a, ++p, i);
        if (eq(a[j], v)) exch(a, --q, j);
    }
    exch(a, lo, j);

    i = j + 1;
    j = j - 1;
    for (int k = lo+1; k <= p; k++) exch(a, k, j--);
    for (int k = hi  ; k >= q; k--) exch(a, k, i++);

    sort(a, lo, j);
    sort(a, i, hi);
}

// sort from a[lo] to a[hi] using insertion sort
private static void insertionSort(Comparable[] a, int lo, int hi) {
    for (int i = lo; i <= hi; i++)
        for (int j = i; j > lo && less(a[j], a[j-1]); j--)
            exch(a, j, j-1);
}

// return the index of the median element among a[i], a[j], and a[k]
private static int median3(Comparable[] a, int i, int j, int k) {
    return (less(a[i], a[j]) ?
           (less(a[j], a[k]) ? j : less(a[i], a[k]) ? k : i) :
           (less(a[k], a[j]) ? j : less(a[k], a[i]) ? k : i));
}

// is v < w ?
private static boolean less(Comparable v, Comparable w) {
    return (v.compareTo(w) < 0);
}

// does v == w ?
private static boolean eq(Comparable v, Comparable w) {
    return (v.compareTo(w) == 0);
}

// exchange a[i] and a[j]
private static void exch(Object[] a, int i, int j) {
    Object swap = a[i];
    a[i] = a[j];
    a[j] = swap;
}

 private static boolean isSorted(Comparable[] a) {
    for (int i = 1; i < a.length; i++)
        if (less(a[i], a[i-1])) return false;
    return true;
}

// test client
public static void main(String[] args) {

    // generate array of N random reals between 0 and 1
    int N = Integer.parseInt(args[0]);
    Double[] a = new Double[N];
    for (int i = 0; i < N; i++) {
        a[i] = Math.random();
    }

    // sort the array
    sort(a);

    // display results
    for (int i = 0; i < N; i++) {
        System.out.println(a[i]);
    }
    System.out.println("isSorted = " + isSorted(a));

}

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T00:31:59.100

您可以[`Arrays.sort()`](http://docs.oracle.com/javase/6/docs/api/java/util/Arrays.html#sort%28java.lang.Object%5B%5D%29)在输入数组之前对其进行排序，以下每一项都描述了如何实现您要求的一件事 - 在调用之前尝试在数组上执行每一项（一次一个）`sort(a)`

要按升序对数组进行排序：

```
Arrays.sort(a); 
```

要按降序对数组进行排序：

```
Arrays.sort(a,Collections.reverseOrder()); 
```

为数组中的每个元素设置常量值：

```
for (int i = 0; i < a.length; i++) a[i] = 0.25; 
```

对列表进行部分排序（25% 已排序）：

```
Arrays.sort(a,0,a.length/4); 
```

* * *

奖励：打印数组（通常用于调试目的）：

```
System.out.println(Arrays.toString(a)); 
```

# google-app-engine - 使用 ImageServices getServingUrl 取回原始图像

> ID：13783324
> 
> 赞同：4
> 
> 时间：2012-12-09T00:11:48.777
> 
> 标签：google-app-engine

getServingUrl 是一种从 AppEngine 数据存储中获取图像的便捷方式，但它似乎想要自动转换图像。

例如，如果我这样做：

```
ServingUrlOptions servingUrlOptions = ServingUrlOptions.Builder.withBlobKey(blobKey);
String payload = "{ \"image\" : \"" + mImagesService.getServingUrl(servingUrlOptions) + "\" }"; 
```

我得到一个尺寸调整后的图像的 URL。例如，如果我上传一张 960 x 640 的图片，默认 URL 将指向一张 512 x 341 的图片。

所以，你说，在 URL 中应用一个转换并设置 s960。这确实会返回一个 960 x 640 的图像，但它已经过转换——如果将其与原始图像进行比较，您会看到图像中的伪影。

服务器正在适当地存储图像，这要归功于我在[这里](https://groups.google.com/forum/?fromgroups=#!topic/google-appengine-java/RNvaH2RAjJs)找到的一种对原始大小进行裁剪的技术：

```
Image image = ImagesServiceFactory.makeImageFromBlob(blobKey);
Transform noOpCrop = ImagesServiceFactory.makeCrop(0, 0, 1, 1);
image = mImagesService.applyTransform(noOpCrop, image);                     
LOGGER.info("Stored image " + image.getWidth() + ", " + image.getHeight()); 
```

我实际上并没有查看它是否包含原始字节，但这并不重要，因为如果我只是要发送回字节，我还不如直接从存储中提取数据并将其设置为自定义图像服务 servlet 的有效负载。

写这篇文章我意识到这听起来更像是一个功能请求而不是一个问题，所以我会这样提出：有没有比通过自定义 servlet 提供原始图像更好的解决方案？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-09T00:17:47.633

您可以`=s0`在生成的 URL 的末尾添加 以获取原始图像。

默认情况下，如果您不添加任何参数，则图像的最大尺寸为 512px（与添加 相同`=s512`）。您可以在文档和您拥有的选项中阅读有关[getServingUrl的更多信息。](https://developers.google.com/appengine/docs/java/javadoc/com/google/appengine/api/images/ImagesService#getServingUrl%28com.google.appengine.api.images.ServingUrlOptions%29)

# vector - 如何检测两个点向量（C++）中任意两点之间的碰撞？

> ID：13783329
> 
> 赞同：3
> 
> 时间：2012-12-09T00:12:29.323
> 
> 标签：vector, collision-detection, point

我有这样的课：

```
class Point
{
public:
   int x;
   int y;

   bool operator==( Point& other )
   {
       return (x == other.x) && (y = other.y);
   }
}; 
```

然后我有一个基本的 Sprite 类，它有一个点向量，以及许多其他我没有在下面显示的成员/方法：

```
class Sprite
{
   std::vector<Point> points;
}; 
```

现在，如何使用 Point 类中的 operator== 找到 Sprite 对象的向量中与另一个 Sprite 对象的向量中的任何其他点发生碰撞的任何点？我已经尝试过类似以下的方法，但效果不太好。**Size()**返回点向量中的点总数，**Points()**返回点向量：

```
bool Sprite::CollidesWith( Sprite* other )
{
  for ( int ixThis = 0; ixThis < Size(); ixThis++ ) {
    for ( int ixOther = 0; ixOther < other->Size(); ixOther++ ) {
      if ( points->at(ixThis) == other->Points()->at(ixOther) )
        return true;
    }
  }

  return false;
} 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-09T00:16:34.277

你`operator==`的不正确。

```
 bool operator==( Point& other )
   {
       return (x == other.x) && (y == other.y);
   } 
```

# c++ - 光线追踪锥。判别式给出 -ve 值，因此没有交集

> ID：13783330
> 
> 赞同：2
> 
> 时间：2012-12-09T00:12:34.770
> 
> 标签：c++, raytracing

我正在用 C++ 实现光线追踪。球体工作正常，圆柱体几乎工作正常。但是光线追踪器无法找到与锥体的交点。经过计算，基于[此处](http://www.visualization.hpc.mil/wiki/Ccone.cpp)的链接，我创建了一个交集函数。这是我的锥类的 findIntersection 函数。可变比率为 -1 * 半径 * 半径 /（高度 * 高度）；

```
virtual double findIntersection(Ray ray){

                Vect ray_origin = ray.getRayOrigin();
                double ray_origin_x = ray_origin.getVectX();
                double ray_origin_y = ray_origin.getVectY();
                double ray_origin_z = ray_origin.getVectZ();

                Vect ray_direction = ray.getRayDirection();
                double ray_direction_x = ray_direction.getVectX();
                double ray_direction_y = ray_direction.getVectY();
                double ray_direction_z = ray_direction.getVectZ();

                Vect cone_center  = center;
                double cone_center_x = center.getVectX();
                double cone_center_y = center.getVectY();
                double cone_center_z = center.getVectZ();

        Vect diff(cone_center_x - ray_origin_x, cone_center_y - ray_origin_y + height, cone_center_z - ray_origin_z);

        //Derive the coefficients of the quadratic equation
        double a = pow(ray_direction_x, 2) + pow(ray_direction_y, 2) * ratio + pow(ray_direction_z, 2);
        double b = diff.getVectX() * ray_direction_x +  diff.getVectY() * ratio * ray_direction_y + diff.getVectZ() * ray_direction_z;

        double c = diff.getVectX() * diff.getVectX() + ratio * diff.getVectY() * diff.getVectY() + diff.getVectZ() * diff.getVectZ();

        double discriminant = b * b - a * c;
        cout << discriminant << "\n";

        if (discriminant > 0){
            //The ray intersects this cone. Find the lower root
            double root_1 = (-1 * b - discriminant)/2 - 0.000001;
                       if (root_1 > 0) {

                                // the first root is the smallest positive root
                                return root_1;
                        }
                        else {
                                // the second root is the smallest positive root
                                double root_2 = ((sqrt(discriminant) - b)/2) - 0.000001;
                                return root_2;
                        }
                }
                else {
                        // the ray missed the cone
                        return -1;

        }

    } 
```

问题在于变量判别式的计算。他们出来是负面的，所以没有交集被返回。该程序中的相交函数返回从射线原点到相交点的距离。

请有人可以看看锥计算并告诉我我是否做错了什么。

问候，莫伊拉

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T01:04:09.687

我无法点击该链接，但您的“判别式”看起来是错误的。

假设`ratio`（不管是什么）是 1。那么我们有

a =**射线**²
b =**差异。射线**
c =**差异**²

判别式 = b * b - a * c = ( **diff . ray** ) ² - **diff** ² **ray** ²

第一个任期最多 | **差异**|| **射线**| （当**ray**和**diff**平行时），所以判别式最多为零。

# domain-name - 如何使用多个 Web 服务器实现 1 个网站域来为不同国家的用户提供服务？

> ID：13783331
> 
> 赞同：1
> 
> 时间：2012-12-09T00:12:34.253
> 
> 标签：domain-name

我们有一个在英国托管的 asp.net 网络应用程序，我们来自中国和韩国的客户报告说查看网络应用程序的速度非常慢 -

（大多数数据保存为非数据库驱动的文件）

我们决定在中国建立第二个网络服务器来解决这个问题——但是，我们可以让英国服务器和中国服务器使用相同的域名吗？（客户习惯使用我们的旧网址，因此很难向那些非技术用户宣布更改...）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T00:50:05.210

当您想使用相同的域名时，您需要在 DNS 级别执行此操作。一种方法可能是使用可[感知地理位置的域名服务器](http://backreference.org/2010/02/01/geolocation-aware-dns-with-bind/)。

但是，更容易将您的用户永久重定向到他们的区域 URL，例如在两个站点上设置您的应用程序：

```
http://app-emea.yourdomain.com
http://app-apac.yourdomain.com
http://app-amer.yourdomain.com 
```

当您的用户访问 app.yourdomain.com 上的旧站点时，让您的 Web 应用程序检查他们的`Accept-Language`HTTP 标头（或他们的 IP 地址）以找出他们的来源。然后使用新位置响应 HTTP 状态代码 301（永久移动），例如 app-apac.yourdomain.com

随着时间的推移，您的用户会将新地址添加为书签或自动重定向。这不应该让他们感到困惑，你也不需要宣布任何事情，因为他们不需要改变任何事情。如果您想隐藏内部 URL，以便浏览器的位置栏只显示原始 URL，您可以使用 an`iframe`但我不推荐此解决方案（它很难看）。

```
http://app.yourdomain.com
<html>
 <body>
  <iframe src="http://app-apac.yourdomain.com"/>
 </body>
</html> 
```

# windows - 如何关闭 DwmExtendFrameIntoClientArea？

> ID：13783333
> 
> 赞同：3
> 
> 时间：2012-12-09T00:12:54.033
> 
> 标签：windows, dwm

调用`DwmExtendFrameIntoClientArea`窗口后，如何在保持 Aero 模式时再次将其关闭？

我尝试调用 DwmExtendFrameIntoClientArea 并将所有边距设置为 0，这似乎可以部分工作，除了我的窗口客户区的背景全是黑色并显示重绘伪影。

我正在使用Qt，`setAttribute(Qt::WA_TranslucentBackground, false)`这样做后我调用了我的窗口，但它似乎没有任何效果。重置窗框后如何正确重绘客户区？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-09T00:18:31.043

Simple mistake - I also needed to set `Qt::WA_NoSystemBackground` to false so Qt would actually draw the window...

So, the procedure to turn off an extended frame is:

*   Call DwmExtendFrameIntoClientArea (misleading, right?) with all margins set to 0
*   Set WA_TranslucentBackground = false on the window (or non-Qt equivalent)
*   Set WA_NoSystemBackground = false on the window (or non-Qt equivalent)

# perl - 向上和向下箭头在 Perl 调试器和 CPAN 客户端中不再起作用

> ID：13783334
> 
> 赞同：15
> 
> 时间：2012-12-09T00:13:07.890
> 
> 标签：perl, debugging, cpan, arrow-keys, perl5.12

我曾经在我的 Mac OS X (v 10.7.5) 上使用 Active Perl，然后我切换到通过 mac 端口 (v 5.12.4) 提供的那个。

现在，当我运行 CPAN 客户端或 perl 调试器时，我无法使用 ArrowUp 和 ArrowDown 访问历史记录，提示符处分别显示的是`^[[A`和`^[[B`。

至少在历史记录工作的调试器上，我可以通过 ! *数*。

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-12-09T00:14:51.980

默认情况下，`Term::ReadLine`您获得的唯一处理程序`Term::ReadLine::Perl`非常简单，并且不理解箭头键之类的东西。您可能想要安装`Term::ReadLine::Gnu`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-07-20T23:26:44.387

如果您想***避免***安装额外的**操作系统**库（或者因为您没有 root/sudo 而需要），您可以使用 CPAN 来获取 Readline 的这两个 Perl 实现之一：

*   [Term::ReadLine::Perl](http://search.cpan.org/dist/Term-ReadLine-Perl/)（Readline 库的 Perl 实现）
*   [Term::Readline::Zoid](http://search.cpan.org/dist/Term-ReadLine-Zoid/)（ Readline 库的*纯*Perl 实现）

如果您已经有自己的本地 Perl 安装（例如，使用 Perlbrew），它会特别方便。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-02-04T04:00:37.747

继 LeoNerd 和 Hakon 的回答之后：- 在 CentOS 7 上，我必须运行

```
sudo yum install perl-Term-ReadLine-Gnu 
```

安装模块。现在箭头键在 perl -d 中工作

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-09-24T20:44:35.580

对于“git for Windows”，您可以执行以下操作：

从

[Ilya Zakharevich 的包 Term-ReadLine-Perl-1.0303](https://metacpan.org/release/Term-ReadLine-Perl)

下载文件

```
Term-ReadLine-Perl-1.0303.tar.gz 
```

提取它

```
tar xvzf ../Term-ReadLine-Perl-1.0303.tar.gz 
```

两个文件

```
Term-ReadLine-Perl-1.0303/ReadLine/Perl.pm
Term-ReadLine-Perl-1.0303/ReadLine/readline.pm 
```

通常必须以管理员权限复制到目录中

```
C:/Program Files/Git/usr/share/perl5/site_perl/Term/ReadLine/ 
```

导致两个文件

```
C:/Program Files/Git/usr/share/perl5/site_perl/Term/ReadLine/Perl.pm and
C:/Program Files/Git/usr/share/perl5/site_perl/Term/ReadLine/readline.pm 
```

之后，您可以在 perl 调试器中使用光标键，例如在“perl -de 0”会话中。

在 Windows SDK 的 64 位 git 中，您通常必须将这两个文件复制到目录中

```
C:/git-sdk-64/usr/share/perl5/site_perl/Term/ReadLine 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-03-04T15:12:58.747

这就是帮助我进行 Debian 伸展的原因

```
apt install libterm-readline-gnu-perl 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-09-02T00:22:32.957

我最终做的是在 Preferences > Advanced 下将我的“终端”窗口的术语更改为 vt100

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-02-20T18:23:54.863

这是我必须做的才能让它与 Cygwin Perl 一起工作

安装以下 Cygwin 软件包：

```
libncurses-devel
libreadline-devel 
```

然后`Term::ReadLine::Gnu`从 CPAN 安装模块

# google-apps-script - 谷歌脚本文件的文件夹

> ID：13783335
> 
> 赞同：0
> 
> 时间：2012-12-09T00:13:14.240
> 
> 标签：google-apps-script

特定文件检索包含它的文件夹的路径（或 ID）的最简单方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T05:52:38.363

答案在[Docslist 文档中： getParents()](https://developers.google.com/apps-script/class_file?hl=fr-FR#getParents)返回父文件夹数组。然后你可以使用`getName()`或`getId()`

# ocaml - lambda 表达式的自由变量列表

> ID：13783338
> 
> 赞同：6
> 
> 时间：2012-12-09T00:14:00.647
> 
> 标签：ocaml, lambda-calculus, free-variable

我只是在为即将到来的 OCaml 测试做一些功课，但遇到了一些麻烦。

*考虑由以下抽象语法定义的 λ 项语言（其中 x 是一个变量）：*

```
t ::= x | t t | λx. t 
```

*写一个类型项来表示 λ 项。假设变量表示为字符串。*

好的，男孩。

```
# type t = Var of string | App of (t*t) | Abs of string*t;;
type t = Var of string | App of (t * t) | Abs of (string * t) 
```

*项 t 的自由变量 fv(t) 归纳定义如下：*

```
fv(x) = {x}  
fv(t t') = fv(t) ∪ fv(t')  
fv(λx. t) = fv(t) \ {x} 
```

肯定的事。

```
# let rec fv term = match term with
Var x -> [x]
  | App (t, t') -> (List.filter (fun y -> not (List.mem y (fv t'))) (fv t)) @ (fv t')
  | Abs (s, t') -> List.filter (fun y -> y<>s) (fv t');;
      val fv : t -> string list = <fun> 
```

*例如，*

```
fv((λx.(x (λz.y z))) x) = {x,y}. 
```

让我们检查一下。

```
# fv (App(Abs ("x", App (Abs ("z", Var "y"), Var "z")), Var "x"));;
- : string list = ["y"; "z"; "x"] 
```

我检查了一百万次，我确信结果应该包括“z”变量。你能就此向我保证吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-09T01:03:44.087

在对 OP 的评论中，@PasqualCuoq 已经指出，`λ`在 lambda 演算中与 OCaml 中的关联相同`fun`。也就是说，该术语`t in λx.t`被贪婪地评估（参见[http://en.wikipedia.org/wiki/Lambda_calculus#Notation](http://en.wikipedia.org/wiki/Lambda_calculus#Notation)）。

这意味着`(λz.y z)`实际上是`(λz.(y z))`，并且上面的函数是正确的，但是为示例表达式提供的翻译`(λx.(x (λz.y z))) x`不是，因为它应该是

```
(App(Abs("x", App(Var "x", Abs("z", App(Var "y", Var "z")))), Var "x")) 
```

代替

```
(App(Abs ("x", App (Abs ("z", Var "y"), Var "z")), Var "x")) 
```

这里是这个很棒的地方，叫做 Stack Overflow！

# windows-phone-7 - 访问 Facebook 活动

> ID：13783339
> 
> 赞同：2
> 
> 时间：2012-12-09T00:14:17.070
> 
> 标签：windows-phone-7, windows-phone-7.1, facebook-c#-sdk, windows-phone

> **可能重复：**
> [如何从 facebook 页面获取所有事件](https://stackoverflow.com/questions/5314341/how-to-get-all-events-from-a-facebook-page)

我正在开发一个 Windows Phone 应用程序，我需要访问 Facebook 事件。我找到了 Facebook C# SDK，但没有任何关于访问事件的内容。我不是要代码，我只是问我怎么能做到这一点？我可以在没有 FB 用户授权的情况下执行此操作吗？因为我想列出该位置（例如城市）的事件。位置由 GPS 或 WI-Fi 确定。任何想法 ？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T09:03:12.433

Facebook C# SDK 不会让您直接访问 Facebook 内部的对象，而是打开与 Facebook API 的通信线路。

您需要查询 Facebook API 以获取有关事件的信息。如果您的用户没有授权您的应用，这将是不可能的。

在此处查看更多信息： [https ://developers.facebook.com/docs/](https://developers.facebook.com/docs/)

# python - Python：在嵌套字典中设置键

> ID：13783345
> 
> 赞同：-3
> 
> 时间：2012-12-09T00:15:30.533
> 
> 标签：python, loops, dictionary, nest

与我真正想提出的问题相比，标题相当简单，但我不太确定如何措辞。对于我正在制作的 XML 解析模块，我需要它根据 XML 文档的确切结构添加键和属性，例如：

```
<Person>
    <Name>Someone</Name>
    <Age>25</Age>
    <Skills>
    <Skill>Projectile vomiting</Skill>
    </Skills> 
</Person> 
```

应该返回：

```
{ "Person" : { "Name" : "Someone", "Age" : "25", "Skills" : { "Skill" : "Projectile vomiting"}}} 
```

...在程序不知道 XML 文档的确切结构的情况下。它可以有任意数量的属性，任意数量的嵌套属性。

使用

```
Dict["key"]["anotherkey"]["yetanotherkey"] = Value 
```

不起作用，因为我不知道 XML 文档是否使用 3 个属性嵌套，或者这些属性嵌套是否包含更多嵌套。

我的想法是每次解析器遇到嵌套的开头时“打开一个节点”，换句话说，如果解析器到达

```
<Skill> 
```

它会在其中分配属性

```
<Skills> and </Skills> 
```

到 Dict["Person"]["Skills"]，以及何时

```
</Skills> 
```

遇到，它将“关闭”节点，并继续将属性分配给 Dict["Person"]，但我不知道如何实现这一点（但我可以获得文档的所有值、属性和节点）。

如上所示，如何在不知道 XML 文档的确切结构的情况下以正确的格式嵌套字典？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-09T00:19:12.860

You can use a stack corresponding to the point at which you are in the XML document. Each time you encounter an open tag you push it on to the stack and begin filling attributes for the value at stack.peek(). When you encounter a closing tag, you pop the last tag off the stack and know that you'll now be filling attributes for the tag at the new top of the stack.

# java - JPA：默认构造函数是否必须为空？

> ID：13783347
> 
> 赞同：9
> 
> 时间：2012-12-09T00:15:46.540
> 
> 标签：java, jpa, constructor, eclipselink

使用 JPA 时默认构造函数是否必须为空？由于我不知道 JPA 内部是如何工作的，我以某种方式担心当默认构造函数自己执行某些操作（例如用默认值填充属性等）时，JPA 可能会错误地初始化对象。

谢谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-09T00:38:28.953

为了最大限度地减少 JPA 的运行时开销，但在用户代码中创建新实例时强制执行约束：

*   使用没有/很少代码的*受保护*的无参数构造函数来促进最快路径实现，以及
*   客户端代码的 n-arg 构造函数，包含根据约束实例化新对象所需的代码。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-12-09T00:24:29.350

最简洁的答案是不。它不需要为空。

但是，您需要注意，当 JPA 实现从持久化实例化实例时，它将在无参数构造函数完成后对实例执行操作。这可能会撤消您的构造函数所做的事情。

要了解构造函数是否需要为空，您需要考虑构造函数将在两种情况下被调用。

*   当您创建“新”对象时，构造函数需要生成一个已充分初始化以供普通代码使用的对象。应该处理需要初始化为非默认状态的字段。

*   当 JPA 从持久存储中具体化一个对象时，具体化将“填充”新构造实例的细节。这通常会覆盖构造对象的对象状态。

当然，您的代码可能被设计为不直接使用无参数构造函数。这使得第一个场景没有实际意义，也使得可能发生的潜在浪费的“双重初始化”变得毫无意义。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-12-09T00:31:24.720

更长的答案是：它不应该是空的，大多数时候。例如，想象以下实体：

```
@Entity
public class Team {
    @Id
    private Long id;

    @OneToMany
    private Set<Player> players;

    // getters
} 
```

当 JPA 加载实例时，播放器集永远不会为空。它可以为空，但不能为空。但是当你创建一个新的 Team，或者当你在单元测试中使用 Team 实例时，这个不变量也应该得到保证。所以这个类应该写成

```
@Entity
public class Team {
    @Id
    private Long id;

    @OneToMany
    private Set<Player> players = new HashSet<Player>(0);

    // getters
} 
```

这相当于

```
@Entity
public class Team {
    @Id
    private Long id;

    @OneToMany
    private Set<Player> players;

    public Team() {
        this.players = new HashSet<Player>(0);
    }
    // getters
} 
```

# java - 是否有充分的理由使用阴影字段的参数？

> ID：13783351
> 
> 赞同：5
> 
> 时间：2012-12-09T00:16:14.310
> 
> 标签：java, parameters, field, shadow

是否有充分的理由使用阴影字段的参数？这两者有什么区别：

```
public class Point {
    public int x = 0;
    public int y = 0;

    //constructor
    public Point(int a, int b) {
        x = a;
        y = b;
    }
} 
```

和

```
public class Point {
    public int x = 0;
    public int y = 0;

    //constructor
    public Point(int x, int y) {
        this.x = x;
        this.y = y;
    }
} 
```

如果你`this`在这个例子中使用不带参数的关键字会影响字段（我猜这只是不必要的）：

```
public class Point {
    public int x = 0;
    public int y = 0;

    //constructor
    public Point(int a, int b) {
        this.x = a;
        this.y = b;
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-09T00:18:59.587

我认为这是一个风格问题，但特别是对于公共领域 -`Point(int x,int y)`是**自我记录**，而`Point(int a, int b)`不是

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-09T00:18:42.847

在第二种情况下，很明显`x`and`y`有一个目的，尽管存储在两个地方。如果你看到`a`, `b`,`x`并不`y`清楚它们之间的关系是什么。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-09T00:20:12.150

区别在于可读性和 IDE 将向您展示的内容。

IMO 参数的命名应尽可能具有描述性，以便 IDE 和 Javadocs 尽可能具有交流性和表达性。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-11-15T18:59:38.877

还有一个更难检测错误的问题。

在构造函数中使用 x 而不是 this.x 是潜在的错误来源。

# json.net - 如果字符串包含 %, [] 则反序列化失败

> ID：13783354
> 
> 赞同：1
> 
> 时间：2012-12-09T00:16:43.357
> 
> 标签：json.net

当`JsonSerializationException`我使用 JSON.Net 反序列化其中一个字符串值包含`%`符号（在一种情况下）或方括号`[]`（在另一种情况下）的对象时，会引发 A。

我正在使用他们的 API 反序列化从我的 Windows Live 日历下载的日历事件提醒。以下是从导致反序列化异常的较大 JSON 事件结构（3 个不同事件）中摘录的名称元素：

*   "name": "PCC 5% 折扣"
*   “名称”：“带薪假期 [平安夜]”
*   “名称”：“带薪假期 [圣诞节]”

响应看起来有效，如果我将收到的 JSON 粘贴到 JSONLint 或类似文件中，它就会验证。

有什么方法可以修复或解决这些异常而不丢弃有问题的对象，或者不必预处理原始 JSON 以去除某些字符？

# c# - 如何在派生自抽象类的类中创建新方法？

> ID：13783362
> 
> 赞同：1
> 
> 时间：2012-12-09T00:18:05.887
> 
> 标签：c#, oop, inheritance, polymorphism, abstract-class

在以下示例中，我使用 C#。

我创建了一个抽象类`Base_Collection`，然后从中派生出其他类（`Book`、、、`Movie`）`Game`。但是，我不知道如何添加可用于这些新子类的新方法而不会出现编译器错误。

```
namespace polymorphism_test_01
{
    abstract class Base_Collection
    {
        public int id = 0;
        public string title = "";

        public Base_Collection() { }
    }
}    

namespace polymorphism_test_01
{
    class Book : Base_Collection
    {
        public Book() { }

        public override void Read_Book() { }
    }
}    

namespace polymorphism_test_01
{
    class Game : Base_Collection
    {
        public Game() { }

        public void Play_Game() { }
    }
}   

namespace polymorphism_test_01
{
    class Movie : Base_Collection
    {
        public Movie() { }

        public void Watch_Movie() { }
    }
} 
```

调用`book.Read_Book()`在以下代码段中不起作用，编译器将输出错误：

```
namespace polymorphism_test_01
{
    class Program
    {
        public static void Main(string[] args)
        {
            Base_Collection book = new Book();

            book.title = "The Dark Tower";
            book.Read_Book();

            Console.WriteLine(book.title);
            Console.Write("Press any key to continue . . . ");
            Console.ReadKey(true);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-09T00:35:28.290

您可以毫无问题地将方法添加到基类。您收到编译器错误的原因是您错误地使用了`override`关键字。

为了使用`override`关键字，方法名称和签名必须与父类中的方法名称和签名匹配，并且方法必须标记为`virtual`或`abstract`在基类中。两者的区别在[这里](https://stackoverflow.com/questions/391483/what-is-the-difference-between-an-abstract-function-and-a-virtual-function)得到解答。

由于书籍、电影和电影都可以“表演”，您可能需要考虑将您的课程设置为：

```
abstract class Base_Collection
{
    public int id = 0;
    public string title = "";

    public Base_Collection() { }

    public virtual void PerformAction() { } // or public virtual void PerformAction(){ }
}

class Book : Base_Collection
{
    public Book() { }

    public override void PerformAction() { // read book }
}

class Game : Base_Collection
{
    public Game() { }

    public override void PerformAction() { // play game }
}

class Movie : Base_Collection
{
    public Movie() { }

    public void PerformAction() { // watch movie }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-09T00:32:15.920

除了@Will 的答案（这是正确的），您可以更好地构建您的层次结构。例如，您对每种媒体类型执行不同的操作，但每种类型仍会被*消费*。

因此，将您的基类更改为具有一个名为 的抽象基方法`Consume()`，然后在每个派生类中重写并实际实现该方法，这样您就可以传递基类的实例，而无需强制转换来调用`Consume()`每个媒体上的方法类型：

```
public abstract class Base_Collection
{

    public int id = 0;
    public string title = "";

    public Base_Collection() {   }

    public abstract void Consume();

}

public class Book : Base_Collection
{
    public Book() {   }

    public override void Consume()
    {
        //do book reading stuff in here
    }
}

public class Movie : Base_Collection
{
    public Movie() {   }

    public override void Consume()
    {
        //do movie watching stuff in here
    }
}

public class SomeOtherClass
{
    public void SomeMethod(Base_Collection mediaItem)
    {
        //note that the book/movie/whatever was passed as the base type
        mediaItem.Consume();
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-09T00:24:18.023

`Base_Collection`没有名为 的方法`Read_Book`。要在派生类上调用该方法，您需要强制转换，例如

```
(Book)book.Read_Book(); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-09T00:27:34.377

您**不能**覆盖不存在的方法。在访问方法之前删除`override`and then cast，就像 Will 提到的那样。

```
class Book : Base_Collection
{
    public Book()
    {

    }

    public void Read_Book()
    {

    }
}

public static void Main(string[] args)
{
    Base_Collection book = new Book();

    book.title = "The Dark Tower";
    (Book)book.Read_Book();
    ...
} 
```

但是，我只会创建一个 Book 对象，而不是强制转换它，否则您将不得不在程序中进行大量强制转换。甚至可能重新考虑类层次结构，就像 slugster 提到的那样。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-31T13:43:23.020

您应该从 public override void Read_Book() 中删除 override 关键字，或者将此函数添加到 Base_Collection，如下所示

```
 public abstract void Read_Book(); 
```

# php - CodeIgniter params are not passing to library?

> ID：13783364
> 
> 赞同：4
> 
> 时间：2012-12-09T00:18:27.930
> 
> 标签：php, codeigniter

Ok I'm trying to pass parameteres to the constructor of my library I created to extend the CI_Form_validation class. Anyway, here is what I'm passing from my model:

```
$this->load->library('MY_Form_validation', array('config' => '', 'post' => $this->input->post())); 
```

Then here is the MY_Form_validation library:

```
private $post;

    public function __construct($params) {
        parent::__construct($params['config']);
        $this->post = $params['post'];
    } 
```

But it's saying I'm not passing anything in. Here are the error messages:

```
Message: Missing argument 1 for MY_Form_validation::__construct(), called in H:\WD SmartWare.swstor\HALEY-HP\Source\DStable\stable\core\Loader.php on line 1099 and defined
Message: Undefined variable: params 
```

EDIT On request, the whole class:

```
class MY_Form_validation extends CI_Form_validation {
    private $post;

    public function __construct($params) {
        parent::__construct($params['config']);
        $this->post = $params['post'];
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T11:21:08.427

您只需将空数组而不是空字符串作为第一个参数传递给构造函数，该参数将发送给父级：

```
$this->load->library('MY_Form_validation', array('config' => array(), 'post' => $this->input->post())); 
```

CI 表单验证库实际上是这样初始化配置参数的，这是来自的构造函数`system/libraries/Form_validation.php`：

```
public function __construct($rules = array()) 
```

# java - Cannot manage to use ActionListener between two classes

> ID：13783370
> 
> 赞同：4
> 
> 时间：2012-12-09T00:18:44.803
> 
> 标签：java, swing, actionlistener, java-2d

I try to implement two classes, one dedicated to the interface and the other one dedicated to the canvas allowing user to draw shapes on it.

So basically, let's take one of my button, here is my Jbutton bCircle where I want to initialize the action in an anonymous class. I have put just the specific piece :

```
public class Application extends JFrame implements ActionListener {

    toolBar.add(Box.createHorizontalGlue());
    toolBar.add(Box.createVerticalGlue());
    toolBar.add(bSquare, toolBar.getComponentCount() - 1);
    toolBar.add(bCircle, toolBar.getComponentCount() - 1);
    bCircle.addActionListener(new ActionListener(){
        public void actionPerformed(ActionEvent event){
        //Action ?????
    }
});
    toolBar.add(bRectangle, toolBar.getComponentCount() - 1);
    toolBar.add(bTriangle, toolBar.getComponentCount() - 1);
    toolBar.add(bErase, toolBar.getComponentCount() - 1);
    toolBar.setOrientation(SwingConstants.VERTICAL);
    container.add(toolBar, BorderLayout.WEST);
} 
```

And in the other class, here is the action I want the selected state of the Jbutton bCircle to execute when I click on the canvas :

```
public class DrawingCanvas extends JPanel implements MouseListener, MouseMotionListener {

    public void mousePressed(MouseEvent e) {
    // TODO Auto-generated method stub
        if(e.getSource() == bCircle) {
            shapes.add(new Circle(e.getX(),e.getY()));
        }
        repaint();
    }
} 
```

`shapes` is a ArrayList stocking the shapes to make the canvas easier to clean, `Circle` is a class which only contains drawing of the circle.

At the end, the purpose is to allow user to click first on four buttons representing four shapes, then draw them by a mouse pressed on the canvas. But I don't know how to link theses two classes, please help me,

Thanks in advance,

P.S : the full Application class (interface) that I have updated a second time:

```
import java.awt.BorderLayout;
import java.awt.Color;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.awt.event.MouseEvent;
import java.awt.event.MouseListener;
import javax.swing.Box;
import javax.swing.ImageIcon;
import javax.swing.JButton;
import javax.swing.JFileChooser;
import javax.swing.JFrame;
import javax.swing.JMenu;
import javax.swing.JMenuBar;
import javax.swing.JPanel;
import javax.swing.JToolBar;
import javax.swing.SwingConstants;

public class Application extends JFrame implements ActionListener {

{
    //Set appearance Look & Feel for the window
try { javax.swing.UIManager.setLookAndFeel("javax.swing.plaf.nimbus.NimbusLookAndFeel");
    } catch(Exception e) {
        e.printStackTrace();
    }
}

    private DrawingCanvas canvas = new DrawingCanvas();
    private JPanel container = new JPanel();
    private JPanel commandes = new JPanel();
    private JMenuBar menu = new JMenuBar();
    private JMenu newFile = new JMenu();
    private JMenu open = new JMenu(); 
    private JMenu save = new JMenu();
    private JFileChooser fileChooser;
    private JToolBar toolBar = new JToolBar();

    private JButton bSquare = new JButton("Square");
    private JButton bRectangle = new JButton("Rectangle");
    private JButton bCircle = new JButton("Circle");
    private JButton bTriangle = new JButton("Triangle");
    private JButton bErase = new JButton("CLEAR");

    //public static boolean bIsSelected = false;

    public Application(){

    this.setTitle("Animation");         
    this.setSize(579, 432); 
        this.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    this.setLocationRelativeTo(null);
    this.setVisible(true);

        container.setBackground(Color.white);
    container.setLayout(new BorderLayout());
    container.add(canvas, BorderLayout.CENTER);
    this.setContentPane(container);

    toolBar.add(Box.createHorizontalGlue());
        toolBar.add(Box.createVerticalGlue());
        toolBar.add(bSquare, toolBar.getComponentCount() - 1);
        toolBar.add(bCircle, toolBar.getComponentCount() - 1);

        bCircle.addActionListener(new SampleActionListener(canvas, new Circle()));

            toolBar.add(bRectangle, toolBar.getComponentCount() - 1);
        toolBar.add(bTriangle, toolBar.getComponentCount() - 1);
        toolBar.add(bErase, toolBar.getComponentCount() - 1);
        bErase.addActionListener(new ActionListener(){
              public void actionPerformed(ActionEvent erase){
                 canvas.getShapes().clear();
                 repaint();
              }
            });
        toolBar.setOrientation(SwingConstants.VERTICAL);
        container.add(toolBar, BorderLayout.WEST);

        menu.add(newFile);
        newFile.setIcon(new ImageIcon("src/images/new.png"));
        menu.add(open);
        open.setIcon(new ImageIcon("src/images/open.png"));
        menu.add(save);
        save.setIcon(new ImageIcon("src/images/save.png"));
        this.setJMenuBar(menu);  

      }  

    public class SampleActionListener implements ActionListener {

        private final DrawingCanvas canvas2;
        private final ShapeGenerator shapeGenerator;

        public SampleActionListener(DrawingCanvas canvas, ShapeGenerator shapeGenerator) {
            this.canvas2 = canvas;
            this.shapeGenerator = shapeGenerator;
        }

        public void actionPerformed(ActionEvent event) {
           this.canvas2.setShapeGenerator(shapeGenerator);
        }
    }
    @Override
    public void actionPerformed(ActionEvent arg0) {
        // TODO Auto-generated method stub

    }   

    public static void main(String[] args) {
        // TODO Auto-generated method stub
        Application App = new Application();

    }
} 
```

Here is the class for the canvas, uploaded a second time as well :

```
import java.awt.BorderLayout;
import java.awt.Color;
import java.awt.Graphics;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.awt.event.MouseEvent;
import java.awt.event.MouseListener;
import java.awt.event.MouseMotionListener;
import java.util.ArrayList;

import javax.swing.JPanel;

public class DrawingCanvas extends JPanel implements MouseListener {

private ArrayList<Shape> shapes = new ArrayList<>();
private Shape shapeUnderMouse = null;

public ArrayList<Shape> getShapes() {
    return shapes;
}

public void setShapes(ArrayList<Shape> shapes) {
    this.shapes = shapes;
}

public DrawingCanvas() {
    super();
    addMouseListener(this);
}

public void paint(Graphics g){
    for(int i = 0;i < shapes.size();i++){
        shapes.get(i).paint(g);
    }    
}

@Override
public void mouseClicked(MouseEvent e) {
    // TODO Auto-generated method stub

}

@Override
public void mouseEntered(MouseEvent arg0) {
    // TODO Auto-generated method stub

}

@Override
public void mouseExited(MouseEvent arg0) {
    // TODO Auto-generated method stub

}

public void addShape(Shape anyShape)
{
        shapes.add(anyShape);
}

@Override
public void mousePressed(MouseEvent e) {

    shapes.add(this.shapeGenerator.getGeneratedShape(e.getX(), e.getY()));
    repaint();
}
@Override
public void mouseReleased(MouseEvent arg0) {
    // TODO Auto-generated method stub

}

public void setShapeGenerator(ShapeGenerator shapeGenerator) {
    // TODO Auto-generated method stub

} 
```

Now, the class shape :

```
import javax.swing.JPanel;

public class Shape extends JPanel{

protected int posX;
protected int posY;

/*public Shape(int posX, int posY) {
    super();
    this.posX = posX;
    this.posY = posY;
}*/

public int getPosX() {
    return posX;
}

public void setPosX(int posX) {
    this.posX = posX;
}

public int getPosY() {
    return posY;
}

public void setPosY(int posY) {
    this.posY = posY;
}

} 
```

My little circle class :

```
import java.awt.Color;
import java.awt.GradientPaint;
import java.awt.Graphics;
import java.awt.Graphics2D;
import java.awt.geom.Ellipse2D;
import java.awt.geom.Ellipse2D.Float;

import javax.swing.JPanel;

public class Circle extends Shape implements ShapeGenerator{

/*public Circle(int posX, int posY) {
    super(posX, posY);
    // TODO Auto-generated constructor stub
}*/

public void paint(Graphics g){
    g.fillOval(posX,posY,40,40);
    g.setColor(Color.blue);
  } 

public Shape getGeneratedShape(int x, int y) {
    return new Ellipse2D.Float(x, y, 10, 10); //--> does not work, ask me to change       method type to a float
    return new Circle();
    } 
```

} And finally the interface, all the class are in separate classes :
public interface ShapeGenerator {

```
Shape getGeneratedShape(int posX, int posY);

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-09T02:06:51.687

事实上，这很容易。不要使用匿名类。

例如，使用您的代码，您只需附加一个已定义的侦听器。例如 ：

```
bCircle.addActionListener(new SampleActionListener(pan, new CircleShapeGenerator())); 
```

这是 SampleActionListener 女巫实现 ActionListener 接口

```
public class SampleActionListener implements ActionListener {

    private final DrawingCanvas canvas;
    private final ShapeGenerator shapeGenerator;

    public SampleActionListener(DrawingCanvas canvas, ShapeGenerator shapeGenerator) {
        this.canvas = canvas;
        this.shapeGenerator = shapeGenerator;
    }

    public void actionPerformed(ActionEvent event) {
       this.canvas.setShapeGenerator(shapeGenerator);
    }
} 
```

这是类 CircleShapeGenerator

```
public class CircleShapeGenerator implements ShapeGenerator {
    public Shape getGeneratedShape(int x, int y) {
        return new Ellipse2D.Float(x, y, 10, 10);
    }
} 
```

和接口 ShapeGenerator

```
public interface ShapeGenerator {
      Shape getGeneratedShape(int x, int y);
} 
```

而且，如果你想在矩形按钮上添加动作监听器，现在真的很容易。创建此类：

```
public class RectangleShapeGenerator implements ShapeGenerator {
     public Shape getGeneratedShape(int x, int y) {
       return new Rectangle2D.Float(x, y, 10, 10);
      }
} 
```

并在您的应用程序类中，添加以下代码

```
toolBar.add(bRectangle, toolBar.getComponentCount() - 1);
bRectangle.addActionListerner(pan, new RectangleShapeGenerator() ) 
```

我认为，对于您在 DrawingCanvas 中绘制的方法，您应该使用如下代码：

```
for (Shape s : shapes) {
       Graphics2D g2 = (Graphics2D) g;
       g2.draw(s);
} 
```

BR，帕图什

对不起我的英语，我知道它不是很完美......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-10T22:50:02.877

这是您的问题的解决方案。但它真的很脏......就像我说的那样，拥有从 JPanel 继承的 Shape 是没有意义的！

```
public class Application extends JFrame implements ActionListener {

    {
        // Set appearance Look & Feel for the window
        try {
            javax.swing.UIManager.setLookAndFeel("javax.swing.plaf.nimbus.NimbusLookAndFeel");
        } catch (Exception e) {
            e.printStackTrace();
        }
    }

    private final DrawingCanvas pan = new DrawingCanvas();
    // don't use to many field, it's confusing and not necessary.
    // you can do local var instead.
    private final JPanel container = new JPanel();

    private final JPanel commandes = new JPanel();

    private final JMenuBar menu = new JMenuBar();

    private final JMenu newFile = new JMenu();

    private final JMenu open = new JMenu();

    private final JMenu save = new JMenu();

    private JFileChooser fileChooser;

    private final JToolBar toolBar = new JToolBar();

    private final JButton bSquare = new JButton("Square");

    private final JButton bRectangle = new JButton("Rectangle");

    private final JButton bCircle = new JButton("Circle");

    private final JButton bTriangle = new JButton("Triangle");

    private final JButton bErase = new JButton("CLEAR");

    public Application() {

        this.setTitle("Animation");
        this.setSize(579, 432);
        this.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        this.setLocationRelativeTo(null);
        this.setVisible(true);

        container.setBackground(Color.white);
        container.setLayout(new BorderLayout());
        container.add(pan, BorderLayout.CENTER);
        this.setContentPane(container);

        toolBar.add(Box.createHorizontalGlue());
        toolBar.add(Box.createVerticalGlue());
        toolBar.add(bSquare, toolBar.getComponentCount() - 1);
        toolBar.add(bCircle, toolBar.getComponentCount() - 1);
        bCircle.addActionListener(new SampleActionListener(pan, new CircleShapeGenerator()));
        toolBar.add(bRectangle, toolBar.getComponentCount() - 1);
        // bRectangle.addActionListener(new SampleActionListener(pan, new
        // RectangleShapeGenerator()));
        toolBar.add(bTriangle, toolBar.getComponentCount() - 1);
        toolBar.add(bErase, toolBar.getComponentCount() - 1);
        toolBar.setOrientation(SwingConstants.VERTICAL);
        container.add(toolBar, BorderLayout.WEST);

        menu.add(newFile);
        newFile.setIcon(new ImageIcon("src/images/new.png"));
        menu.add(open);
        open.setIcon(new ImageIcon("src/images/open.png"));
        menu.add(save);
        save.setIcon(new ImageIcon("src/images/save.png"));
        this.setJMenuBar(menu);

    }

    @Override
    public void actionPerformed(ActionEvent arg0) {
        // TODO Auto-generated method stub

    }

    public static void main(String[] args) {
        // TODO Auto-generated method stub
        Application App = new Application();
    }
} 
```

我们保留 CircleShapeGenerator 类

```
public class CircleShapeGenerator implements ShapeGenerator {

    @Override
    public CircleShape getGeneratedShape(int x, int y) {
        CircleShape c = new CircleShape();
        c.setCanvasX(x);
        c.setCanvasY(y);
        return c;
    }

} 
```

圆形

```
import java.awt.Graphics;
import java.awt.Graphics2D;
import java.awt.geom.Ellipse2D;

public class CircleShape extends Shape {

    private final Ellipse2D.Float ellipse2D;

    public CircleShape() {
        this.ellipse2D = new Ellipse2D.Float();
        this.setRadius(20);
    }

    private void setRadius(int r) {
        this.ellipse2D.height = r;
        this.ellipse2D.width = r;
    }

    @Override
    public void setCanvasX(int canvasX) {
        this.canvasX = canvasX;
        this.ellipse2D.x = canvasX;
    }

    @Override
    public void setCanvasY(int canvasY) {
        this.canvasY = canvasY;
        this.ellipse2D.y = canvasY;
    }

    @Override
    public java.awt.Shape getTrueShape() {
        return this.ellipse2D;
    }

} 
```

用于编辑形状的上下文菜单类

```
import javax.swing.JMenuItem;
import javax.swing.JPopupMenu;

class ContextualShapeMenu extends JPopupMenu {

    private final Shape shape;

    public ContextualShapeMenu(Shape shape) {
        this.shape = shape;
        JMenuItem anItem = new JMenuItem("Edit the size");
        add(anItem);
    }
} 
```

DrawingCanvas 类

```
import java.awt.Graphics;
import java.awt.event.MouseEvent;
import java.awt.event.MouseListener;
import java.util.ArrayList;
import java.util.List;

import javax.swing.JPanel;

import com.google.common.collect.Lists;

public class DrawingCanvas extends JPanel implements MouseListener {

    protected ArrayList<Shape> shapes = new ArrayList<Shape>();

    private ShapeGenerator shapeGenerator;

    public ArrayList<Shape> getShapes() {
        return shapes;
    }

    public void setShapes(ArrayList<Shape> shapes) {
        this.shapes = shapes;
    }

    public DrawingCanvas() {
        super();
        addMouseListener(this);
    }

    @Override
    public void paint(Graphics g) {
        super.paint(g);
        for (Shape s : shapes) {
            s.paint(g);
        }
    }

    @Override
    public void mouseClicked(MouseEvent e) {
        switch (e.getButton()) {
        case MouseEvent.BUTTON1:
            shapes.add(this.shapeGenerator.getGeneratedShape(e.getX(), e.getY()));
            break;
        default:
            Shape shape = getShapeUnderMouse(e);
            if (shape != null) {
                ContextualShapeMenu menu = new ContextualShapeMenu(shape);
                menu.show(e.getComponent(), e.getX(), e.getY());
            }
        }
        repaint();
    }

    private Shape getShapeUnderMouse(MouseEvent e) {
        List<Shape> reversed = Lists.reverse(this.shapes);
        for (Shape s : reversed) {
            if (s.contains(e.getX(), e.getY())) {
                return s;
            }
        }
        return null;
    }

    @Override
    public void mouseEntered(MouseEvent e) {
        // Do nothing
    }

    @Override
    public void mouseExited(MouseEvent e) {
        // Do nothing
    }

    @Override
    public void mousePressed(MouseEvent e) {
        // Do nothing
    }

    @Override
    public void mouseReleased(MouseEvent e) {
        // Do nothing
    }

    public void setShapeGenerator(ShapeGenerator shapeGenerator) {
        this.shapeGenerator = shapeGenerator;
    }
} 
```

仍然是 ActionListener。重命名它。

```
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;

public class SampleActionListener implements ActionListener {

    private final DrawingCanvas canvas;

    private final ShapeGenerator shapeGenerator;

    public SampleActionListener(DrawingCanvas canvas, ShapeGenerator shapeGenerator) {
        this.canvas = canvas;
        this.shapeGenerator = shapeGenerator;
    }

    @Override
    public void actionPerformed(ActionEvent event) {
        this.canvas.setShapeGenerator(shapeGenerator);
    }
} 
```

形状生成器接口

```
public interface ShapeGenerator {

    Shape getGeneratedShape(int x, int y);

} 
```

至少，最愚蠢的课程：Shape

```
import java.awt.Graphics;
import java.awt.Graphics2D;
import java.awt.Point;
import java.awt.Rectangle;
import java.awt.geom.AffineTransform;
import java.awt.geom.PathIterator;
import java.awt.geom.Point2D;
import java.awt.geom.Rectangle2D;

import javax.swing.JPanel;

public abstract class Shape extends JPanel implements java.awt.Shape {

    protected int canvasX;

    protected int canvasY;

    public int getCanvasX() {
        return canvasX;
    }

    public abstract java.awt.Shape getTrueShape();

    public abstract void setCanvasX(int canvasX);

    public int getCanvasY() {
        return canvasY;
    }

    public abstract void setCanvasY(int canvasY);

    @Override
    public void paint(Graphics g) {
        Graphics2D g2 = (Graphics2D) g;
        g2.draw(this.getTrueShape());
    }

    @Override
    public Rectangle getBounds() {
        return getTrueShape().getBounds();
    }

    @Override
    public Rectangle2D getBounds2D() {
        return getTrueShape().getBounds2D();
    }

    @Override
    public boolean contains(int x, int y) {
        return this.getTrueShape().contains(x, y);
    }

    @Override
    public boolean contains(double x, double y) {
        return this.getTrueShape().contains(x, y);
    }

    @Override
    public boolean contains(Point2D p) {
        return this.getTrueShape().contains(p);
    }

    @Override
    public boolean contains(Point p) {
        return this.getTrueShape().contains(p);
    }

    @Override
    public boolean intersects(double x, double y, double w, double h) {
        return this.getTrueShape().intersects(x, y, w, h);
    }

    @Override
    public boolean intersects(Rectangle2D r) {
        return this.getTrueShape().intersects(r);
    }

    @Override
    public boolean contains(double x, double y, double w, double h) {
        return this.getTrueShape().contains(x, y, w, h);
    }

    @Override
    public boolean contains(Rectangle2D r) {
        return this.getTrueShape().contains(r);
    }

    @Override
    public PathIterator getPathIterator(AffineTransform at) {
        return this.getTrueShape().getPathIterator(at);
    }

    @Override
    public PathIterator getPathIterator(AffineTransform at, double flatness) {
        return this.getTrueShape().getPathIterator(at, flatness);
    }

} 
```

我已经添加了番石榴库，所以，你不会找到 Lists 类。将它添加到您的项目中，使用其他库或创建一种方法来反转您的列表。

祝你好运，以后不要做这样的事情！！！这是编码的恐怖。

顺便说一句，我来自法国。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-09T22:43:13.027

首先，删除你的类 Shape。你不需要。Shape是Java定义的接口。请改用此界面。

DrawingCanvas 类中 ShapeGenerator 的设置器什么也不做。所以添加它。你的方法油漆不正确。

```
public class DrawingCanvas extends JPanel implements MouseListener {

    // Shape here is the java.awt.Shape from java.
    private ArrayList<Shape> shapes = new ArrayList<>();
    private ShapeGenerator shapeGenerator;

    ...
    ...

    public void paint(Graphics g){
        super.paint(g);
        for (Shape s : shapes) {
            Graphics2D g2 = (Graphics2D) g;
            g2.draw(s);
        } 
    }

    ...

    @Override
    public void mousePressed(MouseEvent e) {
        shapes.add(this.shapeGenerator.getGeneratedShape(e.getX(), e.getY()));
        repaint();
    }

    public void setShapeGenerator(ShapeGenerator shapeGenerator) {
        this.shapeGenerator = shapeGenerator;
    }
} 
```

你的类 Circle 真的很复杂。它很简单，这种方法不需要任何绘画方法。你的 Circle 类真的很简单：

```
public class Circle implements ShapeGenerator{

    public Shape getGeneratedShape(int x, int y) {
        // This will return a java.awt.Shape instance
        return new Ellipse2D.Float(x, y, 10, 10);
    }
} 
```

我认为，仅此而已。

# drupal - 如何使用 hook_menu 在 Drupal 中注册通配符 url？

> ID：13783374
> 
> 赞同：2
> 
> 时间：2012-12-09T00:19:05.403
> 
> 标签：drupal, hook-menu

我开始使用 Drupal，我真的很困惑如何创建一个 hook_menu 函数，该函数允许您注册一个具有 1 或 2 个不同值的 URL，这些值可以隐藏而不显示在面包屑中。

对此的任何帮助将不胜感激。甚至是一个例子。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-09T14:39:54.983

不确定面包屑位，但我认为您正在路径中寻找通配符 ( `%`) 和自动加载器通配符 ( `%mymodule_entity`) 组件。

从[hook_menu()](http://api.drupal.org/api/drupal/modules!system!system.api.php/function/hook_menu/7)页面...

> 路径中的通配符也适用于整数替换。例如，您的模块可以注册路径“my-module/%/edit”。当请求路径 'my-module/foo/edit' 时，整数 1 将被替换为 'foo' 并传递给回调函数。请注意，通配符不能用作第一个组件。

```
$items['my-module/%/edit'] = array(
  'page callback' => 'mymodule_abc_edit',
  'page arguments' => array(1),
); 
```

> 注册的路径还可能包含特殊的“自动加载器”通配符组件，形式为“%mymodule_abc”，其中“%”部分表示此路径组件是通配符，“mymodule_abc”部分定义加载函数的前缀，这里将被命名为 mymodule_abc_load()。

```
$items['my-module/%mymodule_abc/edit'] = array(
  'page callback' => 'mymodule_abc_edit',
  'page arguments' => array(1),
); 
```

# node.js - 使用 Express 将多个数据库查询结果发送到单个视图

> ID：13783377
> 
> 赞同：3
> 
> 时间：2012-12-09T00:19:18.417
> 
> 标签：node.js, express

我有一个仪表板视图 (dashboard.jade)，它将显示两个具有不同信息的面板，所有这些信息都应该从数据库中检索，然后发送到视图。

假设我有一个定义了两个动作的路由文件（ document.js ）：

```
exports.getAllDocuments = function(req, res){
    doc = db.model('documents', docSchema);

    doc.find({}, function(err, documents) {
        if (!err) { 
            // handle success
        }
        else { 
            throw err;
        }
    });
};

exports.getLatestDocumentTags = function(req, res){
    tags = db.model('tags', tagSchema);

    tags.find({}, function(err, docs) {
        if (!err) { 
            // handle success
        }
        else { 
            throw err;
        }
    });
}; 
```

这些函数只能用于从数据库中检索数据。

现在我想从我的dashboard.js 路由文件中的exports.index 函数下将该数据发送到仪表板视图，我在其中呈现我的仪表板视图。

问题是，由于数据库调用将是异步的，因此在调用视图之前我无法访问数据。

我想我可以有一个动作，简单地完成我所有的数据库调用，并通过回调一次将所有数据传递到视图，但这会使我的数据检索动作不可重用。

我真的很困惑如何正确解决这个问题，可能我把这个异步的东西都弄错了。有人可以给我一些关于如何正确执行此操作的提示吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-09T00:38:23.243

这里有一些东西可以激起你的兴趣。

```
//Check out the async.js library
var async = require('async');

//Set up your models once at program startup, not on each request
//Ideall these would be in separate modules as wel
var Doc = db.model('documents', docSchema);
var Tags = db.model('tags', tagSchema);

function index(req, res, next) {
    async.parallel({ //Run every function in this object in parallel
    allDocs: async.apply(Doc.find, {}) //gets all documents. async.apply will
    //do the equivalent of Doc.find({}, callback) here
    latestDocs: async.apply(Tags.find, {})
    ], function (error, results) { //This function gets called when all parallel jobs are done
      //results will be like {
      //  allDocs: [doc1, doc2]
      //  latestDocs: [doc3, doc4]
      // }
      res.render('index', results);
    });
}
exports.index = index;
}; 
```

尝试更多教程。如果您还没有对异步编程在节点中的工作方式感到“哈哈”的时刻，请在尝试在没有指导的情况下编写全新的程序之前继续阅读指导性的手持教程。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-03-10T09:40:53.840

```
//Check out the async.js library and mangoose model
var mongoOp     =   require("./models/mongo");
var async = require('async');

router.get("/",function(req,res){
    var locals = {};
    var userId = req.params.userId;
    async.parallel([
        //Load user Data
        function(callback) {
             mongoOp.User.find({},function(err,user){
                if (err) return callback(err);
                locals.user = user;
                callback();
            });
        },
        //Load posts Data
        function(callback) {
                mongoOp.Post.find({},function(err,posts){
               if (err) return callback(err);
                locals.posts = posts;
                callback();
            });
        }
    ], function(err) { //This function gets called after the two tasks have called their "task callbacks"
        if (err) return next(err); //If an error occurred, we let express handle it by calling the `next` function
        //Here `locals` will be an object with `user` and `posts` keys
        //Example: `locals = {user: ..., posts: [...]}`
         res.render('index.ejs', {userdata: locals.user,postdata: locals.posts})
    }); 
```

# php - 如何将数据插入 MySQL 中的多个表？

> ID：13783380
> 
> 赞同：1
> 
> 时间：2012-12-09T00:19:34.360
> 
> 标签：php, mysql, forms

我才刚刚开始学习在 MySQL 中连接表。现在，我有一个小项目，我只想让访问者通过表单插入数据。然后数据显示在一个有四行的 HTML 表中，将我数据库中的两个表连接在一起。“问题”是数据应该提交到我数据库中的这两个*不同*的表中。

我试过

```
$query = "INSERT INTO table1, table2 (col1, col2, col3, col4) VALUES ('value1', 'value2', 'value3', 'value4')"; 
```

但这似乎并没有做到。将表单数据提交到多个数据库表的正确语法是什么？哦，我读过一些类似的线程提到使用事务。这是必要的吗？我的表使用 MyISAM 运行。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T00:24:46.480

您可以从[MySQL 手册](http://dev.mysql.com/doc/refman/5.6/en/insert.html)中了解更多信息。简而言之，您不能一次插入多个表。这为您提供了三个选择：

1.  多个`INSERT`语句
2.  [触发器](http://dev.mysql.com/doc/refman/5.6/en/create-trigger.html)
3.  [存储过程](http://dev.mysql.com/doc/refman/5.6/en/create-procedure.html)

这个问题的答案：[MySQL Insert into multiple tables？（数据库规范化？）](https://stackoverflow.com/questions/5178697/mysql-insert-into-multiple-tables-database-normalization) 建议使用事务，这不适用于 MyISAM，但如果您切换到 InnoDB，这是一个很好的仅供参考。

我真的建议您阅读[Triggers](http://dev.mysql.com/doc/refman/5.6/en/create-trigger.html)。他们可以让你的生活更轻松。但如果您不想使用它们，请查看 PHP 的[mysqli_multi_query](http://us2.php.net/mysqli_multi_query)，这将允许您同时执行两个不同的查询，例如：

```
$query = "INSERT INTO table1 (col1,col2) VALUES ('$value1','$value2');";
$query = "INSERT INTO table2 (col3,col4) VALUES ('$value3','$value4');";
$result = mysqli_multi_query($dbcon, $query); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-09T00:21:40.040

您唯一的解决方案是使用多个单独的查询，最好是在一个事务中。如果您想确保插入来自每个查询的数据，则事务是必要的，在这种情况下您`COMMIT`需要事务；如果其中一个查询失败，您可以`ROLLBACK`.

PS 使用 InnoDB。在几乎`INSERT`所有查询至少占所有查询的 5% 的环境中，它都会更好（遗憾的是，我无法提供源，因为我几个月前读过它并且不再记得在哪里了）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-09T00:21:55.600

我可能错了，但您不会同时插入多个表。您将其拆分为两个或多个命令，每个命令都处理特定的插入，有什么大不了的，那一行额外的代码（使一切更清晰）输入起来太麻烦了？

这么看，如果你写了一个大脚本，比如处理一些数据的例程，你把代码分段越多，越容易调试，如果需要的话，接种有问题的指令，它就会结束从长远来看，可以节省您的时间。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-09T00:22:33.813

您可以通过使用 MySQL 事务来执行此操作：尝试：

```
BEGIN
INSERT INTO table1 (col1, col2...ETC) 
  VALUES('value1', 'value2'...ETC)
INSERT INTO table2 (col1, col2...ETC) 
  VALUES('value1', 'value2'...ETC);
COMMIT; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-09T00:23:35.543

使用 MyISM，您将需要为要插入的每个表执行查询，我不相信在单个查询中您可以添加到多个表。

在您的情况下，您不能使用事务，因为您的引擎不支持它们。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-03-29T01:25:43.690

我之前有这个问题你可以使用多个查询功能

```
$query = "INSERT INTO table1 (col1,col2) VALUES ('$value1','$value2')";
$query = "INSERT INTO table2 (col3,col4) VALUES ('$value3','$value4')";
$result = mysqli_multi_query($dbcon, $query); 
```

# java - sort array of objects in descending order

> ID：13783383
> 
> 赞同：-4
> 
> 时间：2012-12-09T00:20:21.340
> 
> 标签：java, arrays, priority-queue

I am implementing a priority queue using a heap-array of defined "newsFeed" objects, which all have a String, an int of "likes", and an int of "age". The heap is prioritized by the number of "likes" each newsFeed object has, however when I use a removeMax on it, the removeMaxReorder method I wrote for it is giving me null pointers. As I'm debugging it, I was just curious as to if anyone knows of an algorithm that will get around this and basically reorder the array into descending order, thus still keeping the priority queue properties. I can't implement a comparable method, because I can't modify the newsFeed class, so I'm imagining a lot of for loops and statements like `array[i].getLikes` and a lot of `>,<` and `=`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-09T00:23:37.983

I assume you are not talking about the PriorityQueue class, and I am not sure if you are talking about an array or an ArrayList, but you don't need to implement Comparable as you can create a Comparator without changing the original class.

For your description it sounds like you want to reverse sort an array (or sort it in descending order) To do this I would use

```
NewsFeed[] newsFeed =
Arrays.sort(newsFeed, new MyDescendingPriorityOrderComparator()); 
```

# doctrine-orm - install DoctrineFixturesBundle and doctrine-fixtures in Symfony 2.1.4

> ID：13783385
> 
> 赞同：1
> 
> 时间：2012-12-09T00:20:41.770
> 
> 标签：doctrine-orm, symfony-2.1

I want to install and configure **DoctrineFixturesBundle** and **doctrine-fixtures** in Symfony 2.1.4\. Can anyone give me a guide.

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-12T13:54:18.627

您的问题可能已经在[DoctrineFixturesBundle 问题](https://github.com/doctrine/DoctrineFixturesBundle/issues)部分得到解答，无论如何我将总结在 symfony 2.1.4 版本中安装和配置 DoctrineFixturesBundle 的步骤。

步骤1 ：

打开*composer.json*并在 require 部分附加以下代码。此文件位于项目的根文件夹中

```
{
    "require": {  
        "doctrine/doctrine-fixtures-bundle": "dev-master",
        "doctrine/data-fixtures": "dev-master"
    }
} 
```

第2步：

在终端中运行以下命令

```
php composer.phar update 
```

最后一步：

在您的 app/AppKernel.php 中附加以下内容

```
// ...
public function registerBundles()
{
    $bundles = array(
        // ...
        new Doctrine\Bundle\FixturesBundle\DoctrineFixturesBundle(),
        // ...
    );
    // ...
} 
```

希望能帮助到你。

# c++ - How to turn method pointer types into function pointer types

> ID：13783389
> 
> 赞同：2
> 
> 时间：2012-12-09T00:21:44.753
> 
> 标签：c++, templates

Suppose you have template method that takes a pointer to a method of any type. Inside that template, is there a way to turn the template argument, which is a method pointer type (`void(A::*)()` for example), into a function pointer type with the same return type and parameters, but without the class information (`void(*)()`)?

I looked at the `<type_traits>` header but didn't find anything that would help.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-09T01:00:59.827

C++11 中的一个简单方法是使用可变参数模板进行部分特化：

```
template<class PMF> struct pmf_to_pf;

template<class R, class C, class... Args>
struct pmf_to_pf<R (C::*)(Args...)>{
  using type = R(*)(Args...); // I like using aliases
}; 
```

请注意，您需要对`const`成员函数进行单独的部分特化（理论上也需要对具有[引用资格](https://stackoverflow.com/q/8610571/500104)的函数）：

```
template<class R, class C, class... Args>
struct pmf_to_pf<R (C::*)(Args...) const>{
  using type = R(*)(Args...);
}; 
```

使用 cv-qualifiers ( `{nil,const}`, `{nil,volatile}`) 和 ref-qualifiers ( `{nil, &, &&}`)，您总共`2*2*3 == 12`可以提供部分特化^(†</sup>。您通常可以省略`volatile`限定条件，将总数降至“仅” 6 个。由于大多数编译器不支持 function-ref-qualifiers，您实际上只需要 2 个，但请注意其余部分。)

* * *

对于 C++03（即没有可变参数模板的编译器），您可以使用以下非可变参数形式：

```
template<class PMF> struct pmf_to_pf;

template<class Sig, class C>
struct pmf_to_pf<Sig C::*>{
  typedef Sig* type; // 'Sig' is 'R(Args...)' and 'Sig*' is 'R(*)(Args...)'
}; 
```

尽管这不适用于 cv 限定符，但因为我认为 C++03 不允许 cv 限定签名（例如`R(Args...) const`），您可以在这些签名上部分专门化以删除`const`.

* * *

†`{...}`表示某个限定词的集合，用`nil`表示空集。例子：

*   `void f() const&`将会`{const}, {nil}, {&}`
*   `void f() &&`将会`{nil}, {nil}, {&&}`

等等。

# php - Parse html from a .dat file

> ID：13783391
> 
> 赞同：1
> 
> 时间：2012-12-09T00:21:50.710
> 
> 标签：php, domdocument

I'm trying to parse some **html** that is inside an external **.dat** file.

I would normaly use the follwing code:

```
$html = new DOMDocument();
$html->loadHTMLFile('http://www.bvl.com.pe/includes/cotizaciones_todas.dat');
$xpath = new DOMXPath($html);
$path = '/somepath';
$nodelist = $xpath->query($path);
echo $nodelist->item(0)->nodeValue; 
```

But I'm getting this error:

```
DOMDocument::loadHTMLFile(): htmlParseEntityRef: expecting ';' in http://www.bvl.com.pe/includes/cotizaciones_todas.dat, line: 15 
```

I know that the problem is the `loadHTMLFile`, I tried using `load` or `loadXML` but it's not working neither. Any help would be appriciated.

* * *

**UPDATE**

To solve the problem I had to handle the errors using `libxml_use_internal_errors(TRUE)`. Now I've a new problem, I want to count how many `<tr>` tags are inside the table. I'm using the following code:

```
$html = new DOMDocument();
libxml_use_internal_errors(TRUE);
$html->loadHTMLFile('http://www.bvl.com.pe/includes/cotizaciones_todas.dat');
libxml_clear_errors();
$xpath = new DOMXPath($html);
$tbody = $html->getElementsByTagName('tbody')->item(0);
$path = 'count(tr)';
$trCount = $xpath->evaluate($path,$tbody); 
```

But I'm getting this error msg: `PHP Catchable fatal error: Argument 2 passed to DOMXPath::evaluate() must be an instance of DOMNode, null given` I already used the same code with other files and everything worked fine, but in this case it's not working, maybe because the html is broken?

# c - 结构赋值中的不兼容类型

> ID：13783397
> 
> 赞同：1
> 
> 时间：2012-12-09T00:22:21.990
> 
> 标签：c, struct

```
typedef struct s {
char name[20];
char last_name[20];
int height;
} s_t;

s_t my_s_t;
my_s_t.name = "John"; 
```

最后一行我得到“分配中不兼容的类型”。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-09T00:24:17.733

```
my_s_t.name = "John"; 
```

`name`是一个字符数组。所以你不能直接给它分配一个字符串文字。您可以使用`strcpy`或类似的函数来复制字符串文字或声明`name`为`char*`.

选项：

1)

```
typedef struct s {
char name[20];
char last_name[20];
int height;
} s_t;

s_t my_s_t;
strcpy(my_s_t.name, "John"); 
```

2)

```
 typedef struct s {
    char *name;
    char last_name[20];
    int height;
    } s_t;

    s_t my_s_t;
    my_s_t.name = "John"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-09T00:27:16.880

您正在尝试*分配*一个数组。数组不可赋值。由于同样的原因，这将失败

```
char a[20];
a = "Hello"; /* Error */ 
```

为了将数据复制到数组中，您必须使用库函数，例如`strcpy`

```
strcpy(a, "Hello"); 
```

*同时，可以在初始化*时使用核心语言特性（而不是库函数）将数据复制到数组中，如

```
char a[20] = "Hello"; 
```

在您的情况下，您可以使用聚合初始化语法来实现相同的

```
s_t my_s_t = { "John", "Smith", 2 }; 
```

只要您在初始化时执行此操作，它就会起作用。如果您以后必须这样做，那`strcpy`是您的朋友。

# sql - Oracle SQL - 从具有重复节点的 XML 中提取 clob 值

> ID：13783403
> 
> 赞同：5
> 
> 时间：2012-12-09T00:22:46.953
> 
> 标签：sql, xml, oracle

我正在尝试在表上运行 SQL（`test_xml`使用列`xml_data`[数据类型 xmltype] 调用）。该列包含带有重复节点 ( `test_3`) 的 xml。当节点包含非 clob 大小的数据时，以下语句运行成功：

```
SELECT 
   extractvalue (Value (wl), '*/test_3')
      FROM test_xml
         , TABLE (xmlsequence (extract (xml_data, '*/record'))) wl 
```

但是当 test_3 节点包含大量数据时失败：

> ORA-01706: 用户函数结果值太大

我修改了我的查询：

```
SELECT 
   extractvalue(Value (wl), '*/test_3').getClobVal()
      FROM test_xml
         , TABLE (xmlsequence (extract (xml_data, '*/record'))) wl 
```

但这失败了：

> ORA-22806: 不是对象或 REF

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-09T18:56:50.013

这已通过在 Oracle 论坛上收到的回复得到解决：

[见论坛帖子](https://forums.oracle.com/forums/message.jspa?messageID=10736122#10736122)

从 Oracle 版本 11.2.0.2 开始：

```
SELECT x.*
FROM test_xml t
   , XMLTable(
       '/*/record'
       passing t.xml_data
       columns
         test_3  clob path 'test_3'
     ) x
; 
```

我的数据库版本是 10.2.0.4，因此需要以下“技巧”：

```
SELECT dbms_xmlgen.convert(x.test_3.getClobVal(), 1) as test_3
FROM test_xml t
   , XMLTable(
       '/*/record'
       passing t.xml_data
       columns
         test_3  xmltype path 'test_3/text()'
     ) x
; 
```

感谢 odie_63 为此

# objective-c - -[NSObject isEqual:] 和 -[NSNumber isEqualToNumber:]: 有什么区别？

> ID：13783404
> 
> 赞同：7
> 
> 时间：2012-12-09T00:22:50.570
> 
> 标签：objective-c

两种方法都返回相同的结果。当然，`-[NSObject isEqual:]`不比较对象的指针，它以某种方式检查内部字段或其他什么。那么使用究竟`-[NSNumber isEqualToNumber:]`来比较两个`NSNumber`s 有什么意义呢？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-09T00:30:33.730

从[文档](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSNumber_Class/Reference/Reference.html)：

> 如果两个 NSNumber 对象具有相同的 id 值或它们具有相等的值（由 compare: 方法确定），则它们被视为相等。这种方法比比较更有效：如果你知道这两个对象是数字。

所以它处理 id equals 和 number 比较。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-09T00:59:42.673

它们本质上是相同的，尽管 isEqual 必须对传入的对象的类进行类型检查。isEqualToNumber 在编译时进行类型检查，如果可能的话会更好。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-12-09T00:30:07.763

`-[NSObject isEqual:]`检查两个对象是否具有指针地址和哈希值，同时`-[NSNumber isEqualToNumber:]`检查值是否相同。

`NSNumber`值相等的 s 具有相同的指针地址。

# php - php include necessary files in every file

> ID：13783406
> 
> 赞同：-1
> 
> 时间：2012-12-09T00:23:17.717
> 
> 标签：php, class, autoload

I have some classes, and a functions.php file, which needs to be loaded on every PHP page I script. (Because some pages could individually get called by $.ajax)

I googled, but couldn't get further than the __autoload function.

Let's say I have 100 pages, with 10 function files and 10 class files in 3 other directories. It would be kind of hard to load them into every page and get the relative paths good from every page, it's impossible.

So the perfect situation would be to call every class/function file ONCE, on index.php and never have to call them again. Is this possible?

How would you call all your classes and function files to use in your website?

Thank you!

* * *

## 回答 #1

> 赞同：-4
> 
> 时间：2012-12-09T00:25:14.163

include_once('这里的文件路径')

# vba - VBA 下标超出范围

> ID：13783409
> 
> 赞同：0
> 
> 时间：2012-12-09T00:23:57.373
> 
> 标签：vba

我对 VBA 很陌生，所以这可能是一个愚蠢的问题。我的用户窗体上有 2 个按钮，一个用于搜索文件，一个用于输入。（这只是我正在做的事情的简化）。每次我收到错误“下标超出范围”，但我不知道为什么。谁能帮帮我吗？非常感谢

```
Public file as Variant

Private Sub cmdBrowse_Click()
file = Application.GetOpenFilename
If file = False Then
    MsgBox "There is no file selected.", vbCritical, "Warning"
End If
End Sub

Private Sub cmdInput_Click()
Cells(2, 2).Value = Workbooks(file).Worksheets(1).Cells(2, 2).Value
End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T00:58:12.590

从 Excel 帮助 - “显示标准的打开对话框并从用户那里获取文件名，**而不实际打开**任何文件。” 您需要打开工作簿，例如：

```
Private Sub cmdBrowse_Click()
file = Application.GetOpenFilename
If file = False Then
    MsgBox "There is no file selected.", vbCritical, "Warning"
    Exit Sub  
End If
Workbooks.Open file
End Sub 
```

编辑：`Application.Workbooks`属性不采用完整的文件路径，由`GetOpenFileName`. 所以在第二个子中你不想要整个文件路径。您的代码应该只从完整路径中提取文件名：

```
Private Sub cmdInput_Click()
Dim FileName as string

FileName = Mid(file,InStrRev(file,Application.PathSeparator)+1,99)
Cells(2, 2).Value = Workbooks(FileName).Worksheets(1).Cells(2, 2).Value
End Sub 
```

# assembly - Xcode 4.5 中的端口 asm

> ID：13783410
> 
> 赞同：1
> 
> 时间：2012-12-09T00:24:00.037
> 
> 标签：assembly, xcode4.5

希望有人可以帮助我解决这个问题。我从来没有学过 ASM，所以我不能用这个片段做任何事情。但是我需要它来处理它，它对我来说工作得很好（是我之前用于 VC++ 编程的代码片段的一部分，现在我在 Xcode 4.5 上），所以我不知道它到底是如何工作的。

我读过一些帖子，我必须设置引号。但是哪里？

```
 asm(
    fld newVal
    fabs
    fcom oldMax
    fstsw ax
    sahf
    jna else_
    fstp oldMax; // |newVal| > oldMax; pop to oldMax
    jmp endif_
else_:
    ffree st(0)
endif_:
     ); 
```

我在每一行，开头和结尾都尝试了引号。不要工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-09T00:40:23.137

`asm`是 Visual Studio 语法，GCC 和 Clang`__asm__`用于汇编语言。您的代码似乎也采用 Intel 语法，GCC 通常使用稍微不同的语法，称为 AT&T。[您可以在GCC ASM 如何](http://www.ibiblio.org/gferg/ldp/GCC-Inline-Assembly-HOWTO.html#s3)找到更多信息。

这样的事情将是一个很好的起点：

```
__asm__(
"fld %0\n"
"fabs\n"
"fcom %1\n"
"fstsw %%ax\n"
"sahf\n"
"jna 1f\n"
"fstp %1 ; |newVal| > oldMax; pop to oldMax\n"
"jmp 2f\n"
"1:\n"
"ffree %%st0\n"
"2:\n"
 : "=r"(newVal)
 : "r"(oldMax)
 : "%st0"
 ); 
```

# model-view-controller - 在 Ext.net FormPanel 中填充数据

> ID：13783416
> 
> 赞同：0
> 
> 时间：2012-12-09T00:24:20.777
> 
> 标签：model-view-controller, extjs, store, ext.net, formpanel

我正在使用 Ext.net 2.0，我正在尝试在表单面板中加载商店的第一条记录。我总是在商店里没有记录 (getCount() = 0) 吗？我错过了什么吗？

```
 @(Html.X().Store()
              .ID("myStore")
              .AutoSync(true)
              .AutoDataBind(true)
              .Proxy(proxy =>
                     proxy.Add(
                         Html.X().AjaxProxy().API(api =>
                                   {
                                       api.Create = "/Property/Save/";
                                       api.Read   = "/Property/GetById/";
                                   })                   
                             .Reader(reader => reader.Add(Html.X().JsonReader().Root("data").IDProperty("P_ID")))
                             .Writer(writer => writer.Add(Html.X().JsonWriter().AllowSingle(true)))
                     ))
               .Listeners(c =>
                              {
                                  c.DataChanged.Handler ="var store = Ext.getStore('myStore');" +
                                                          "alert(store.getCount());";

                              })

              .AutoLoadParams(parameters =>
                                   {
                                       parameters.Add(Html.X().Parameter().Name("id").Value("document.location.href.split('/')[5]").Mode(ParameterMode.Raw));
                                   })

              .Model(model => model.Add(
                  Html.X().Model()
                      .Fields(fields =>
                                  {

                                      fields.Add(Html.X().ModelField().Name("ID").Type(ModelFieldType.Int));
                                      fields.Add(Html.X().ModelField().Name("DispalyName").Type(ModelFieldType.String));
                                      fields.Add(Html.X().ModelField().Name("Title").Type(ModelFieldType.String));
                                      fields.Add(Html.X().ModelField().Name("ShortDescription").Type(ModelFieldType.String));

                                  })
                          ))
                    ) 
```

对于表单面板

```
@(
        Html.X().FormPanel()
        .ID("myPanel")
        .Layout(LayoutType.Form)
        .Width(350)
        .FieldDefaults(d => {
            d.LabelWidth = 150;
        })
        .BodyPadding(10)
        .Items(item =>
                    {
                        item.Add(Html.X().TextField().ID("Id").Name("ID").FieldLabel("Id").Hidden(true));
                        item.Add(Html.X().TextField().ID("DispalyName").Name("IdDispalyName").FieldLabel("Id Dispaly Name").MaxLength(400));
                        item.Add(Html.X().TextField().ID("Title").Name("Title").FieldLabel("Title").AllowBlank(false).MaxLength(200));
                        item.Add(Html.X().TextField().ID("ShortDescription").Name("ShortDescription").FieldLabel("Short Description").MaxLength(200));
                             }
            ) ) 
```

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-09T22:52:47.923

更合适的事件是 Load（当数据从远程源加载到存储时触发）

请参阅以下描述 [http://docs.sencha.com/ext-js/4-1/#!/api/Ext.data.Store-event-datachanged](http://docs.sencha.com/ext-js/4-1/#!/api/Ext.data.Store-event-datachanged)

# octave - 以八度音阶执行矢量化指数移动平均

> ID：13783419
> 
> 赞同：1
> 
> 时间：2012-12-09T00:24:35.147
> 
> 标签：octave, time-series, vectorization, moving-average

在 GNU Octave 中，想在不使用 for 循环的情况下计算向量的 n 天指数移动平均值。

我可以使用 for 循环来做到这一点，但效率低下。我想使用过滤器功能，但是我不确定如何让它正常工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T01:15:29.323

将这个线程的位拼凑在一起后

[http://octave.1599824.n4.nabble.com/vectorized-moving-average-td2132090.html](http://octave.1599824.n4.nabble.com/vectorized-moving-average-td2132090.html)

我使用 Octave 的过滤器功能构建了这个功能。

```
function meanV = movingEMean(V, window)
  simpleAvg = mean(V(1:window));
  alpha = 1/window;
  X = V(window:end);
  X(1) = simpleAvg;
  meanV = filter(alpha, [1 alpha-1], X, simpleAvg*(1-alpha));
end 
```

它以简单的移动平均线为基础开始。`V`是用于计算指数移动平均线的数字的列向量。 `window`是天数的整数。我用了12。

这是这个函数的数学解释。

[http://en.wikipedia.org/wiki/Moving_average#Exponential_moving_average](http://en.wikipedia.org/wiki/Moving_average#Exponential_moving_average)

请注意，页面使用`2/(n+1)`(where `n`is`window`或天数) as `alpha`，但我使用`1/n`该值是因为该值`alpha`符合我的需要。`alpha`根据需要进行调整。

或者，我有时需要我的输入和输出向量的尺寸来匹配。`NaN`我通过添加`meanV = [NaN(window-1,1); meanV];`作为函数的最后一行来填充无效值`movingEMean`。`simpleAvg`如果你想要一个粗略的估计，你也可以填写它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2022-01-06T22:14:42.297

在向量的倍频程指数移动平均线上重新发明轮子是愚蠢的。只需在此处复制和粘贴`movavg.m`octave 财务包中定义的功能：[https](https://octave.sourceforge.io/financial) ://octave.sourceforge.io/financial ：

```
function [varargout] = movavg(asset, lead, lag, alpha = 0) 
  if nargin < 3 || nargin > 4 
    print_usage (); 
  endif 
  if lead > lag 
    error ("lead must be <= lag") 
  elseif ischar (alpha) 
    if ! strcmpi (alpha, "e") 
      error ("alpha must be 'e' if it is a char"); 
    endif 
  elseif ! isnumeric (alpha) 
    error ("alpha must be numeric or 'e'") 
  endif 
  ## Compute the weights 
  if ischar (alpha) 
    lead = exp(1:lead); 
    lag  = exp(1:lag); 
  else 
    lead = (1:lead).^alpha; 
    lag  = (1:lag).^alpha; 
  endif 
  ## Adjust the weights to equal 1 
  lead = lead / sum (lead); 
  lag  = lag / sum (lag); 
  short = asset; 
  long  = asset; 
  for i = 1:length (asset) 
    if i < length (lead) 
      ## Compute the run-in period 
      r        = length (lead) - i + 1:length(lead); 
      short(i) = dot (asset(1:i), lead(r))./sum (lead(r)); 
    else 
      short(i) = dot (asset(i - length(lead) + 1:i), lead); 
    endif 
    if i < length (lag) 
      r       = length (lag) - i + 1:length(lag); 
      long(i) = dot (asset(1:i), lag(r))./sum (lag(r)); 
    else 
      long(i) = dot (asset(i - length(lag) + 1:i), lag); 
    endif 
  endfor 
  if nargout > 0 
    varargout{1} = short; 
  else 
    plot((1:length(asset))', [asset(:), long(:), short(:)]); 
  endif 
  if nargout > 1 
    varargout{2} = long; 
  endif 
endfunction 
```

并如此调用：

```
foo = [NaN; 1;4;8;10;-3;3;4;0;0;3;4;5;6;7;8;9];     
lead = 7 
lag = 7
alpha = 'e' 
movavg(foo, lead, lag, 'e') 
```

哪个打印：

```
 NaN
       NaN
       NaN
       NaN
       NaN
       NaN
       NaN
   3.39851
   1.24966
   0.45742
   2.06175
   3.28350
   4.37315
   5.40325
   6.41432
   7.42128
   8.42441 
```

# wsdl - 修改 Wsdl2Apex 生成的类以处理 xs:extension 和导入的命名空间

> ID：13783420
> 
> 赞同：3
> 
> 时间：2012-12-09T00:24:45.993
> 
> 标签：wsdl, salesforce, apex-code

我在生成 wsdl2apex 代码时遇到问题，主要是由于在我的 WSDL中使用`xs:import namespace`和使用。`xs:extension`

特别是，我看到了错误`System.CalloutException: Web service callout failed: Unable to parse callout response. Apex type not found for element . . .`。Web 服务返回的原始 SOAP 响应看起来与我预期的一样。

我想修改生成的 Apex 类来解决这个问题，因为对 Web 服务的服务器端更改不是一个选项。

SOAP 响应如下所示：

```
<ns:getAccountsResponse>
 <ns:return xsi:type="ax1:AccountReturn">
  <ax2:successful>true</ax2:successful>
  <ax2:transactionId>1000</ax2:transactionId>
  <ax1:Accounts xsi:type="ax1:Account"> 
```

对于 ax1 目标命名空间，WSDL 看起来像这样：

```
<xs:complexType name="AccountReturn">
 <xs:complexContent>
  <xs:extension base="ax100:BaseReturnObject">
   <xs:sequence>
    <xs:element maxOccurs="unbounded" minOccurs="0" name="Accounts" nillable="true" type="ax1:Account"/>
   </xs:sequence>
  </xs:extension>
 </xs:complexContent>
</xs:complexType> 
```

对于 ax2 目标命名空间：

```
<xs:complexType name="BaseReturnObject">
 <xs:sequence>
  <xs:element minOccurs="0" name="successful" type="xs:boolean"/>
  <xs:element minOccurs="0" name="transactionId" nillable="true" type="xs:integer"/>
 </xs:sequence>
</xs:complexType> 
```

生成的映射到 AccountReturn 的 Apex 类仅包含 ax1 中的 Accounts 字段，但不包含 ax2 中的 BaseReturnObject 字段，因为 wsdl2apex 生成不尊重`xs:extension`命名空间的使用或导入（基于我的研究）。

无论如何修改 Apex 类以使其工作？我尝试将 BaseReturnObject 中的字段添加到 AccountReturn，并修改`field_order_type_info`. 但是，似乎`apex_schema_type_info`只能指向一个命名空间，这可能是调用响应的解析仍然失败的原因。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-09-02T01:56:22.007

我已经构建了一个用于自动创建 Apex 类的工具。它包括对 xs:extension 和 xs:import （除其他外）的支持。

在 ex:extension 的情况下，该工具会将所需字段从基类拉到子类中并正确配置`_type_info`成员。

您可以免费获得它 - [FuseIT SFDC Explorer](http://www.fuseit.com/Solutions/SFDC-Explorer/Help-WSDL-Parser.aspx)。目前仅在 Windows 中直接运行。我有报告说人们使用 Wine 成功运行了它。（披露：我为发布此工具的公司工作）。

顺便说一句，[salesforce.stackexchange.com](http://salesforce.stackexchange.com)站点是询问 Salesforce 特定问题的好地方。

# android - Android：永远在后台运行服务

> ID：13783424
> 
> 赞同：3
> 
> 时间：2012-12-09T00:25:04.327
> 
> 标签：android

我不知道为什么，但我的服务（以 startService(Intent...) 开始）在一段时间后一直关闭。我希望我的服务每 2 分钟检查一次 WiFiSLAM 的位置，因此 TimerTask 正在服务中运行。我意识到在应用程序关闭（onDestroy）并且屏幕关闭后我的服务正在关闭。

我已经阅读了 WakeLock 并尝试了这个：

```
 final PowerManager pm = (PowerManager) getSystemService(Context.POWER_SERVICE);
    WakeLock wakeLock = pm.newWakeLock(PowerManager.PARTIAL_WAKE_LOCK, TAG);
    wakeLock.acquire(); 
```

但它仍然不起作用。我不知道该怎么办。我只想让我的 Wifi 定位框架每两分钟在后台更新一次位置。

我还将 onStartCommand() 的返回值设置为 START_STICKY。也许它正在后台运行，但是当它运行一段时间后我看不到 LogCat 中的日志，这给了我一个信号，表明室内位置管理器仍在捕捉新的位置。

有人有想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-09T00:32:28.727

Android 会自动终止长时间（30 分钟到 1 小时）在后台运行的应用程序。

防止这种情况的唯一方法是将您的服务设置为`foreground service`.

为此，您可以使用以下内容：

```
 startForeground(messgae, notification); 
```

这将显示一个永久通知，通知用户您的服务正在运行。

其他选项是使用每 2 分钟`AlarmManager`启动一次。`IntentService`

问候。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-09T00:28:30.403

我过去也遇到过同样的问题，你可能不想这样做，但它确实对我有用。我设置了 2 个服务，主要工作人员和一个助手。助手，每隔一段时间就会确保工作者正在运行，工作者将确保助手保持运行。在此示例中，如果其中一个碰巧被系统杀死，它将被另一个重新启动。我从来没有让他们两个同时死去。

同样，这是我的解决方案，可能不是您想做的事情。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-09T00:32:44.440

一种解决方案是使用警报，每隔两分钟或您决定的任何时间启动服务。但是，这样做会耗尽电池电量，因此请记住这一点。

# java - Jslider在覆盖paint方法后滞后

> ID：13783428
> 
> 赞同：2
> 
> 时间：2012-12-09T00:25:33.060
> 
> 标签：java, swing, overriding, paint, jslider

在覆盖我的 JSlider 的 paintTrack 和 paintThumb 方法后，如果我拖动它的拇指，它就会滞后。

我已经用图像替换了轨道和拇指。任何想法如何解决这个问题？

```
public class test {
private static JFrame frame;
private static JSlider slider;

public static void main(String[] args) throws IOException {
    frame = new JFrame();
    slider = new JSlider();
    slider.setUI(new MySliderUI(slider));
    frame.add(slider);
    frame.setVisible(true);
    frame.pack();
    frame.setSize(1200, 720);
    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
}

private static class MySliderUI extends BasicSliderUI {

    private BufferedImage imgTrack;
    private BufferedImage imgThumb;

    public MySliderUI(JSlider slider) throws IOException {
        super(slider);
        imgTrack = ImageIO.read(new File("icon/track.png"));
        imgThumb = ImageIO.read(new File("icon/thumb.png"));

    }

    @Override
    public void paintTrack(Graphics g) {
        Graphics2D g2d = (Graphics2D) g;
        Rectangle t = trackRect;
        g2d.drawImage(imgTrack, t.x, t.y, t.width, t.height, null);
    }

    @Override
    public void paintThumb(Graphics g) {
        Graphics2D g2d = (Graphics2D) g;
        g2d.setRenderingHint(RenderingHints.KEY_ANTIALIASING,
                RenderingHints.VALUE_ANTIALIAS_OFF);
        Rectangle t = thumbRect;
        g2d.drawImage(imgThumb, t.x, t.y, null);
    }

} 
```

}

编辑：解决了，我还必须覆盖 getThumbSize()

```
@Override
    protected Dimension getThumbSize() {
        return new Dimension(imgThumb.getWidth(), imgThumb.getHeight());
    } 
```

# ruby-on-rails - 在部署之前如何在资产管道中找到丢失的图像

> ID：13783429
> 
> 赞同：4
> 
> 时间：2012-12-09T00:25:44.053
> 
> 标签：ruby-on-rails, asset-pipeline

我正在使用 Rails 3.2.8 进行开发。一件烦人的事情是，如果错误地丢失了图像，则会在生产模式下出错。

假设我输入了以下代码。

实际上我忘记将 my.jpg 文件放在 app/assets/images 中，这在开发中没问题（浏览器只会忽略丢失的图像），但它在生产模式下会出现 rails 错误。

如何在部署前找到丢失的文件？

谢谢。

山姆

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T00:37:02.137

我在为部署构建新版本时所做的设置如下`config/environments/test.rb`

```
config.assets.compile = false
config.assets.digest  = true 
```

这模仿了`production`资产管道的环境配置，防止资产被编译并强制通过`manifest.yml`文件/资产管道进行查找。运行你的测试（你确实有测试，对吧？:-)）并注意失败。

如果您没有测试，请用 grep`log/development.log`查找 500 错误

```
tail -f log/development.log | grep 500 
```

手动浏览几页并注意出现在尾部的新日志条目。不过，您应该考虑编写测试以使其自动化。

* * *

您在生产中看到错误的原因是资产管道找不到您请求的资产并因此引发异常。在开发中，事情更加宽松，以便可以向您提供调试信息以支持 500 错误。通过在您的环境中更改上述配置，您是在告诉 Rails 严格按照它对通过资产管道丢失资产的响应采取行动，从而使您能够在问题进入生产之前发现它。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-09T00:31:03.277

您可以观看在开发模式下运行的 rails 控制台......它在找不到图像时会显示警告。

另外，使用浏览器的错误控制台。这两个都会告诉您缺少什么，然后您只需开始 grepping 或在视觉上搜索以查看您将图像放在哪里（或没有放在哪里）。

我不知道为什么生产服务器对损坏的代码不像您在开发中那样友好，除非您真的想推出缺少对象和引用的代码，否则会很烦人。

# c# - 下载保存并运行

> ID：13783431
> 
> 赞同：-1
> 
> 时间：2012-12-09T00:26:03.483
> 
> 标签：c#, download

我一直在尝试下载一个文件并运行它而不是 C#，但成功有限。这是我的脚本：

```
using (WebClient Client = new WebClient())
{
    Client.DownloadFile("http://vx.zapto.org/newscript/enone.jpg", ".jpeg");
    MessageBox.Show("Downloaded!");
} 
```

任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-09T00:34:56.713

试试这个（如果*运行它*意味着用默认应用程序打开它）：

```
using (WebClient Client = new WebClient())
{
    FileInfo file = new FileInfo("filename.jpeg");
    Client.DownloadFile("http://vx.zapto.org/newscript/enone.jpg", file.FullName);
    MessageBox.Show("Downloaded!");

    Process.Start(file.FullName);
} 
```

请注意，第二个参数 to[`WebClient.DownloadFile(..)`](http://msdn.microsoft.com/en-us/library/ez801hhe.aspx)是文件名，而不是扩展名。

# c++ - 自定义队列类 C++

> ID：13783434
> 
> 赞同：1
> 
> 时间：2012-12-09T00:26:18.800
> 
> 标签：c++, class, queue, singly-linked-list

所以我正在尝试创建一个单链表队列。我正在尝试编写一个添加元素的函数，一切都很好，但问题是它的 FILO 而不是 FIFO。我不知道如何处理我的前后指针。

```
#include <iostream>
#include <string>
using namespace std;

class Queue{
    public:
        Queue();
       //~Queue();
       void add(const string & item);
       //string remove();
      // unsigned items() const;
       void show() const;
    private:
        struct Node{
            string data;
            Node *next;
        };
        Node *rear;
        Node *front;
        unsigned elements;
};

Queue::Queue():elements(0),rear(NULL),front(NULL){}

//Queue::~Queue(){

//}

void Queue::add(const string & item){
    Node *t=new Node;
    t->data=item;
    t->next=rear;
    if(front==NULL)
        front=t;
    rear=t;
    elements++;

}

void  Queue::show() const{

    Node *p=rear;
    for(; p->next!=rear; p=p->next){
        cout<<" "<<p->data;
    }
    cout<<"\n";
}
int main(){
    Queue obj;
    obj.add("I");
    obj.add("Am");
    obj.add("Super");
    obj.add("Cool");
    obj.show();
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T01:13:44.910

目前它既不是 FIFO 也不是 FILO bu JINO（刚进，永不出）。

你要做的是插入后端。而且您的节目确实从后到前迭代，因为那是唯一的链接方向。

要获得有效的 FIFO，您需要从队列的前端移除。你会注意到，你可以找到前面的元素，但是你没有简单的方法来找到设置前面指针所需的第二个元素。这是单链接设计的缺点，您必须从后到前迭代才能找到指向前的元素。

*   使用单个链表，您可以执行 FILO（实际上更可能命名为 LIFO 或堆栈）
*   对于 FIFO，双链表将是更好的设计。

* * *

如果你想坚持一个单一的链表，你可以做一些递归。你消除了前指针，因为它没用。

```
void  Queue::show_one(Node *p) const{
    if (p->next!=rear) {    // i kept the test for p->next!=rear
                            // either fix add or test for p->next!=NULL
        show_one(p->next);
    }
    cout<<" "<<p->data;
}

void  Queue::show() const{
    show_one(rear);
    cout<<"\n";
} 
```

同样你可以写一个`remove()`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-09T01:35:41.383

实现，FILO（像STACK？），当push（add）时，将你的新元素追加到末尾（你将处理后指针）当pop时，摆脱后指针指向的元素。

在您的代码中，您的后指针指向结束后的一个元素，该元素为空。所以 push 需要 O(n)，pop 需要 O(n)。它效率不高。所以考虑双链表可能是更容易实现的更好选择。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-09T03:00:14.067

我想出了如何扭转整个事情，所以它现在可以正常工作。它有效率吗？运行 main 花了 1.06 毫秒。

```
 #include <iostream>
    #include <string>
    using namespace std;
    bool die(const string &msg);

    class Queue{
        public:
            Queue();
           ~Queue();
           void add(const string & item);
           string remove();
           unsigned items() const;
           void show() const;
        private:
            struct Node{
                string data;
                Node *next;
            };
            Node *rear;
            Node *front;
            unsigned elements;
    };

    Queue::Queue():elements(0),rear(NULL),front(NULL){}

    Queue::~Queue(){
     unsigned el=items();
     for(unsigned i=0; i<el; i++)
      remove();
    }
    unsigned Queue::items()const{
        return elements;
    }

    string Queue::remove(){
        if(front==NULL) die("underflow");
        Node *t=front;
        string data=t->data;
        front=t->next;
        delete t;
        elements--;
        return data;
    }
    void Queue::add(const string &item){
     Node *t=new Node;
     t->data=item;
     t->next=NULL;
     if(front==NULL)
        front=t;
     else{
        Node *t2=rear;
        t2->next=t;
     }
     rear=t;
     elements++;
    }

    void  Queue::show() const{
        Node *t=front;
        for(unsigned i=0; i<items(); i++, t=t->next)
            cout<<t->data<<'\n';
    }

    bool die(const string &msg){
        cout<<"Error: "<<msg;
        exit(EXIT_FAILURE);
    }

    int main(){
        Queue obj;
        obj.show();
        obj.add("poo");
        obj.add("cra");
        obj.add("bil");
        obj.add("shi");
        obj.show();
        cout<<obj.remove()<<"\n";
        cout<<obj.remove()<<"\n";
        cout<<obj.remove()<<"\n";
        cout<<obj.remove()<<"\n";
    } 
```

# javascript - 如何删除使用 jQuery 选择它后的选项？我正在尝试这样做，以便一旦选择了下拉选项，它将从菜单中删除，然后一旦选择了另一个选项，之前删除的选项将返回到菜单中。有没有办法使用 jQuery 做到这一点？我是 jQuery 和 JavaScript 的新手，所以我不太确定自己在做什么，而且我所有的探索都只是进一步破坏了代码。谢谢！作为参考，这是我的 HTML 的样子：<select 2012="" id="departureFlights</h1>
<blockquote>
        <p>ID：13783438</p>
        <p>赞同：7</p>
        <p>时间：2012-12-09T00:27:04.223</p>
        <p>标签：javascript, jquery, option</p>
        </blockquote>

            <hr/>
            <h2>回答 #1</h2>
            <blockquote>
            <p>赞同：2</p>
            <p>时间：2012-12-09T00:58:53.390</p>
            </blockquote>

<p>您可以将其用作基础：</p>

<pre>回答 #2 赞同：1 时间：2012-12-09T04:18:28.980 我想出了一个运行良好的脚本，至少在 Firefox 中是这样。它在 Firefox 中的问题是，在change您离开控件（可能在其他浏览器中）之前，该事件不会触发，并且该click事件在您拉出下拉菜单时发生，而不仅仅是在进行选择时。这使得在选择真正的航班之前很难同步并且不从列表中删除“未选择航班”项目。 所以，我对这个问题做了一些研究，然后尝试开发我自己的 jQuery 插件（jsFiddle）来检测选择下拉和汇总。它变得更好，但仍然不能在 Firefox 中完美运行。 我的结论是，虽然你可以让这样的动物大部分工作，但你无法绕过一些事情： 并非所有浏览器都以相同的方式实现事物，因此它们以不同的方式“破坏”。 在 Firefox 中，如果您从包含下拉选择控件的 iframe 中单击，下拉列表会卷起，您无法对其做出任何响应。因此，现在代码会在一段时间内报告错误事件，直到您离开控件或单击页面中的其他位置。 Firefox 还在 jQuery 库中抛出了脚本错误，但 Chrome 没有。 使用诸如Alt↓弹出下拉菜单之类的键盘快捷键不会引发鼠标事件，至少在 Firefox 中是这样。所以你必须添加更多的键盘事件陷阱（你确定你会在Mac上得到这个吗？Android？iPhone？） 注意：我知道我在那个小提琴中的代码不是最佳的并且有错误。它是一个废弃的原型，而不是成品。:) 所以，我可以建议您使用自定义选择框，它可以做任何您想做的事情。这是一个示例选择框替换 jQuery 插件。 回答 #3 赞同：1 时间：2012-12-09T04:52:48.260 这是一个在页面加载时缓存所有选项的解决方案。选择选项后，将选项从缓存中替换为所有值的选项 var departSelect=$('#departureFlightsControl'); /* cache clones of all options*/ var departOptions=departSelect.find('option').clone(); departSelect.change(function(){ var currVal=$(this).val(); /* other display logic using currVal*/ /* get new options that don't include current one selected from cache*/ var newOptions= departOptions.clone().filter(function(){ return $(this).val() ! = currVal; }); $(this).html(newOptions) }) 回答 #4 赞同：0 时间：2012-12-09T01:25:05.413 这是一个合理的解决方案，可以保持简单并完成工作。如果您愿意，您显然可以增加功能的特异性。 $(document).ready(function () { var temp = 0; if ($(':selected')) { $('select').change(function () { if (temp !== 0) { temp.show(); } temp = $(':selected').hide(); return temp; }); } else { ('select').show(); } });<code><div class=" flightlist"&gt;="" &lt;select="" onchange="addToInfo(this)" &gt;="" &lt;option="" value="default" &gt;no="" flight="" chosen&lt;="" option&gt;="" &gt;november="" 13,="" (5:37pm)="" -="" $137.38&lt;="" 19,="" (5:11am)="" $121.05&lt;="" 24,="" (7:41pm)="" $182.44&lt;="" &gt;december="" 8,="" (8:22am)="" $140.75&lt;="" &lt;="" select&gt;="" div&gt;="" &lt;div="" &lt;script="" type="text/javascript" function="" addtoinfo(element){="" var="" opt="$(element).find(&quot;:selected&quot;).remove();" span="$('<span" style="margin-left:20px;" onclick="addToList(this)" x&lt;="" span&gt;');="" $(span).data('option',="" opt);="" div="$('<div>'+$(opt).html()+'</div>')" $(div).append(span);="" $('#flightinformation').append(div);="" }="" addtolist(element){="" $('#departureflightscontrol').append($(element).data('option'));="" $(element).closest('div').remove();="" script&gt;="" <="" code=""></select>

# javascript - 如何判断 XMLHTTPRequest 是否命中浏览器缓存

> ID：13783442
> 
> 赞同：35
> 
> 时间：2012-12-09T00:27:17.380
> 
> 标签：javascript, xmlhttprequest, browser-cache

如果可以判断（在 javascript 执行中）GET XMLHTTPRequest 是否命中浏览器缓存而不是从服务器获取响应？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-05-29T15:16:49.867

从[XMLHttpRequest 规范](http://www.w3.org/TR/XMLHttpRequest/)：

> 对于作为用户代理生成的条件请求的结果的 304 Not Modified 响应，用户代理必须像服务器给出具有适当内容的 200 OK 响应一样行事。

换句话说，浏览器将始终给出状态码 200 OK，即使对于命中浏览器缓存的请求也是如此。

但是，规范还说：

> 用户代理必须允许作者请求标头覆盖自动缓存验证（例如 If-None-Match 或 If-Modified-Since），在这种情况下必须通过 304 Not Modified 响应。

因此，有一种解决方法可以使 304 Not Modified 响应对您的 JavaScript 代码可见。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-09T00:55:21.417

发出ajax请求时，您会得到响应代码

```
if (request.readyState == 4) {
     if (request.status == 200) { // this number.
       ... 
```

状态 200 表示您正在获取数据的新副本：

> 请求已成功。响应返回的信息取决于请求中使用的方法 -

状态 304 表示数据未更改，您将从浏览器缓存中获取它：

> 如果客户端已经执行了一个条件 GET 请求并且允许访问，但是文档没有被修改，服务器应该用这个状态码来响应。

[阅读更多关于状态码](http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html)

**更新：**
您可以向您的 URL 添加缓存破坏器，以确保您始终访问服务器：

```
var ajaxUrl = "/path?cache="+(Math.random()*1000000); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-09T01:47:30.793

来自[http://www.w3.org/TR/2012/WD-XMLHttpRequest-20121206/](http://www.w3.org/TR/2012/WD-XMLHttpRequest-20121206/)

> 对于作为用户代理生成的条件请求的结果的 304 Not Modified 响应，用户代理必须像服务器给出具有适当内容的 200 OK 响应一样行事。用户代理必须允许作者请求标头覆盖自动缓存验证（例如 If-None-Match 或 If-Modified-Since），在这种情况下必须通过 304 Not Modified 响应。[HTTP]

我觉得这很模糊。我的假设是*，如果*有条件地请求资源，您会看到 304 响应代码。但是，正如我在另一条评论中解释的那样（来源：[https](https://developers.google.com/speed/docs/best-practices/caching) ://developers.google.com/speed/docs/best-practices/caching ），如果该资源的最后一个响应服务器 http 标头有，甚至可能没有请求设定`Cache-Control: max-age`或`Expires`设定在未来的某个时间。在这种情况下，我不确定应该发生什么。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-09T00:52:59.850

该答案基于您的意思是仅浏览器缓存的假设，没有发生 304（修改后，etag 等）。

检查请求花费了多长时间 - 如果它是从缓存中解决的，那么它应该需要接近 0 毫秒。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-09T00:44:35.787

你使用 Firefox 的[Firebug](https://getfirebug.com/network)吗？

Firebug 有一个带有“XHR”过滤视图的“网络”面板。您应该能够通过请求阶段栏检查缓存信息，检查状态和/或单击三角形以检查“标题”。

> [缓存或不缓存](https://getfirebug.com/network)
> 
> 并非所有网络请求都是平等的——其中一些是从浏览器缓存而不是网络加载的。Firebug 为每个请求提供状态代码，因此您可以快速扫描并查看您的站点使用缓存来优化页面加载时间的效率。

Firebug [Net Panel 文档在这里](https://getfirebug.com/wiki/index.php/Net_Panel)。

Chrome/Safari/Opera 都有类似的调试工具。刚刚在[这里找到了一个很好的列表](http://www.browserstack.com/debugging-tools)（大多数应该有检查 XHR 的工具）。

* * *

### 编辑：

为了有点救赎自己……

正如[ibu 已经回答](https://stackoverflow.com/a/13783596/922323)的那样，我也将首先检查响应的状态代码。

如果您使用 jQuery：

> [statusCode（添加 1.5）](http://api.jquery.com/jQuery.ajax/) Map 默认值：{} 数字 HTTP 代码和函数的映射，当响应具有相应代码时要调用。例如，以下将在响应状态为 404 时发出警报：
> 
> ```
> $.ajax({
>   statusCode: {
>     404: function() {
>       alert("page not found");
>     }
>   }
> }); 
> ```
> 
> 如果请求成功，状态码函数采用与成功回调相同的参数；如果导致错误，它们将采用与错误回调相同的参数。

jQuery 确实让生活变得轻松。:)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-11-27T14:36:26.787

要从 Google Chrome 等浏览器进行检查，请按 F12 打开 DevTools，导航到 Network，刷新以获取一些数据，按 XHR 过滤，然后单击正确的 XHR 请求。单击“headers”子选项卡，然后查看 Response Headers -> cache-control。

如果它说像`no-cache`and `max-age=0`，那么你没有缓存。

如果它显示`private`，那么您的浏览器正在缓存，但服务器没有。

如果它说`public`，那么您正在缓存服务器端和客户端。

[Mozilla.org 上的更多信息](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Cache-Control)

[![在此处输入图像描述](../Images/ff1ad208be0c2a3d2bb0a710209a1509.png)](https://i.stack.imgur.com/RjVzu.png)

# javascript - 通过模型属性搜索主干集合 - 正确完成

> ID：13783443
> 
> 赞同：1
> 
> 时间：2012-12-09T00:27:20.837
> 
> 标签：javascript, backbone.js, backbone.js-collections

我有这个漂亮的函数，它遍历集合中的模型以获取属性和值。如果找到该值，则返回 true。

在浏览了很多文档之后，我仍然对如何正确遍历集合以及如何搜索它感到有些困惑。由于 underscorejs（在我的情况下为 lodash）被连接到主干中，我确实使用 .each 遍历集合

我没有在后面放一个 else ，`if (model.get(attribute)===value)`因为它会在遍历整个集合之前返回 false 。回调函数听起来像不必要的复杂性 - 但也许我错了（我几个月前开始使用 JS）

我会很高兴获得提示和/或更好的解决方案；-) 带有解释。提前致谢。

我使用requirejs，这就是为什么我通过_，Bacbkone ...

下面是集合的样子：

```
function (_, Backbone, AppModels) {

    var QueriesCollection = Backbone.Collection.extend({
        model : AppModels.QueryModel,

        search: function (attribute, value) {
            var found = false;
            this.each(function (model) {
                if (model.get(attribute)===value) {
                    found = true;
                }
            });
            return found;
        }
    });

    return {
        QueriesCollection: QueriesCollection
    };
}); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-09T00:41:23.950

您还可以使用与您的函数几乎相同的下划线[`some`](http://underscorejs.org/#some)（又名） ，除了它需要一个函数参数作为其谓词，而不是键/值：`any``search`

> 如果列表中的任何值通过迭代器真值测试，则返回 true。如果找到真正的元素，则短路并停止遍历列表。

使用 this 的实现更直接一些：

```
search: function (attribute, value) {
    return this.some(function(x) { 
        return x.get(attribute) === value; 
    });
} 
```

# c# - 将字节数组转换为单个平面字节值

> ID：13783448
> 
> 赞同：-1
> 
> 时间：2012-12-09T00:27:39.160
> 
> 标签：c#, vb.net, visual-studio

我有以下数组

* * *

```
byte[] SendBuff = new byte[262];
SendBuff[0] = 0x82;
SendBuff[1] = 0xD2;
SendBuff[2] = 0x00;
SendBuff[3] = Convert.ToByte(tAdd.Text.Substring(0, 2),16);
SendBuff[4] = Convert.ToByte(tLen.Text.Substring(0, 2),16); 
```

我有以下函数可以将数据传递给；

* * *

```
SCardTransmit(hCard, ref sIO,ref SendBuff[0],SendBuffLen, ref sIO,ref RecvBuff[0],ref RecvBuffLen);

 @param1 (int)
 @param2 (ModWinsCard.SCARD_IO_REQUEST)
 @param3 (buyte[])
 @param4 (int)
 @param5 (ModWinsCard.SCARD_IO_REQUEST)
 @param6 (buyte[])
 @param7 (int) 
```

我想知道如何将所有数组数据作为单个字节传递到函数的第三个参数中，这样

SendBuff[0]=combination of SendBuff[0],SendBuff [1](http://en.wikipedia.org/wiki/Smart_card_application_protocol_data_unit) ,SendBuff[2],SendBuff[3] 字节

* * *

我还想知道如何将“88 00 1A 31 31 31”之类的字符串转换为字节并将其存储到 SendBuff[0]

我知道这可能听起来很重复，但我找不到可能对我有用的解决方案。
那里有人请帮帮我，我对此表示赞同。
提前致谢

* * *

解释

* * *

我正在为智能卡开发并向读卡器发送命令，但需要命令（[APDU](http://en.wikipedia.org/wiki/Smart_card_application_protocol_data_unit)）具有以下字符串一个
4 字节标题（CLA、INS、P1、P2），例如“88 D2 00 01 02”

该命令通过函数的param3作为字节传递给上述函数。所以我想知道如何将该命令传递给那个 param3。谢谢，希望这个解释有所帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-09T00:42:29.193

做出这些假设：

1.  您列出的 SCardTransmit 方法不是该方法的声明，而是您实际用来调用它的代码。
2.  您向我们提供了您用来调用@param1-7 项目列表中的方法的变量类型。

如果第三个参数是 byte[]（字节数组），那么您不应该传入 SendBuff[0]。这实际上只是传入一个字节，即位于索引 0 处的字节。您想要发送整个数组。因此，您的调用代码将是：

```
SCardTransmit(hCard, ref sIO, ref SendBuff, SendBuffLen, ref sIO, ref RecvBuff, ref RecvBuffLen); 
```

**注意**：我冒昧地对 SendBuff 到 RecvBuff 做了同样的事情。

* * *

您的第二个问题，关于将字符串转换为字节，看起来您正在使用`Convert.ToByte(tAdd.Text.Substring(0, 2),16);`.

你想要的是一个转换它的循环。您可以按空格字符将字符串拆分为一个子字符串数组，您可以对其进行迭代并转换每个字节。这是执行此操作的代码：

```
string stringOfBytes = "88 00 1A 31 31 31";
string[] stringBytes = stringOfBytes.Split(' ');
byte[] outputBytes = new byte[stringBytes.Length];

for (int i = 0; i < stringBytes.Length; i++)
{
    outputBytes[i] = Convert.ToByte(stringBytes[i], 16);
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-09T00:53:00.480

您对 SCardTransmit 的签名不正确。从 pinvoke.net，您可以看到正确的签名，以及如何使用它的示例代码：http: [//pinvoke.net/default.aspx/winscard/SCardTransmit.html](http://pinvoke.net/default.aspx/winscard/SCardTransmit.html) \

```
[DllImport("winscard.dll")]
public static extern int SCardTransmit(int hCard, ref SCARD_IO_REQUEST pioSendRequest, ref byte SendBuff, int SendBuffLen, ref SCARD_IO_REQUEST pioRecvRequest,
        ref byte RecvBuff, ref int RecvBuffLen); 
```

那么，对于您的请求，您可以使用类似这样的方法调用该函数（假设 _hCard 是对调用返回的引用`SCardConnect`（请注意，这会丢弃返回的值）：

```
[StructLayout(LayoutKind.Sequential)]
public struct SCARD_IO_REQUEST
{
   internal uint dwProtocol;
   internal int cbPciLength;
}

SCARD_IO_REQUEST request = new SCARD_IO_REQUEST();
request.dwProtocol = 1; // This is SCARD_PROTOCOL_T1, sub with whatever protocol you're using
request.cbPciLength = System.Runtime.InteropServices.Marshal.SizeOf(typeof(SCARD_IO_REQUEST));

SCardTransmit(_hCard, ref request, ref SendBuff, SendBuff.Length, IntPtr.Zero, IntPtr.Zero, IntPtr.Zero); 
```

有关本地调用的更多信息在这里：http: [//msdn.microsoft.com/en-us/library/windows/desktop/aa379804%28v=vs.85%29.aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/aa379804%28v=vs.85%29.aspx)，您可以使用 pinvoke.net 获取更多信息其他类似功能的帮助。

# javascript - Javascript函数未完成

> ID：13783449
> 
> 赞同：1
> 
> 时间：2012-12-09T00:27:52.657
> 
> 标签：javascript, jquery, fullcalendar

我正在编写一个 JavaScript 函数来在提交位于花式框中的表单时关闭花式框。这里是：

```
function closeFancyBox() {
    $.fancybox.close();
    $('#calendar').fullCalendar('refetchEvents');
} 
```

它是在fancybox中以这种方式触发的：

```
$('form').submit(function() {
    parent.closeFancyBox();    
}); 
```

事情是这样的：fancybox 正确关闭，但 fullcalendar 没有刷新显示。但是，当我`closeFancyBox();`从控制台调用时，它可以工作并且 fullCalendar 会刷新。我被难住了。

编辑：

根据 danronmoon 的建议，我在`$.fancybox.close();`调用后添加了一个断点并检查了`$('#calendar')`返回的内容......它返回了一个 div 元素，正如预期的那样。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T00:59:17.460

您正在提交表单，很明显它将重定向到另一个页面，因此除非您停止重定向，否则您将看不到所有代码的工作。

```
$('form').submit(function(e) {
    parent.closeFancyBox();
    // run either of the following.
    e.preventDefault();
    return false;
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-09T18:57:43.760

我仍然不确定是什么原因造成的，但我确实设法通过将 fullCalendar 的调用移动`refetchEvents`到 fancybox`afterClose`钩子来“修复”它。

简而言之，这解决了症状，但我不知道是什么导致了潜在问题。

# php - 转换会话语句？

> ID：13783451
> 
> 赞同：0
> 
> 时间：2012-12-09T00:27:56.337
> 
> 标签：php, session

我刚刚开始学习 php，我正在使用 if 语句来控制我的网页上显示的内容，具体取决于用户是否登录。

如果用户在会话下登录，我知道如何使用此会话语句向用户显示内容。但是如果用户没有在他们的会话下登录，我将如何创建反向来告诉站点显示其他内容？

这是我正在使用的代码。

```
<?php if (isset($_SESSION['user_id'])) { 
    if ($user['id'] == $_SESSION['user_id']){
        if ($user['account_type'] == "platinum"){ ?>
            <html stuff>
        <?}
    }
}?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T00:41:24.040

听起来您是编程新手，而不仅仅是 PHP。欢迎来到社区！

您正在寻找 - 语句的[`else`](http://php.net/manual/en/control-structures.else.php)一部分`if`。这在许多编程语言中都很常见。

这是一个帮助您入门的示例。

```
<?php 

if (isset($_SESSION['user_id'])) 
{ 
    if ($user['id'] == $_SESSION['user_id'])
    {
        if ($user['account_type'] == "platinum")
        { 
            print "Welcome, platinum user";
        }
        else
        {
            print "Welcome, non-platinum user";
        }
    }
    else
    {
        print "Unexpected session";
    }
}
else
{
    print "You are not logged in";
}

?> 
```

# javascript - jQuery 对此有何反应？

> ID：13783452
> 
> 赞同：1
> 
> 时间：2012-12-09T00:28:02.603
> 
> 标签：javascript, jquery

假设我们收到了某个`onClick`事件`div`，但在此之前，我们需要使用 jQuery 完成一个大计算，这需要大约 3 秒，而 jQuery 目前很忙，所以它无法识别我的事件调用。

所以，1 秒钟过去了，我点击了这个框。没发生什么事？2 秒。没发生什么事？3 秒，jQuery 完成了他当前的任务。我的`onclick`jQuery 事件有效并且该框消失了。

问题是; 在这种情况下 jQuery 会做什么？自动创建一个线程来立即执行我的 onclick 事件？排队通话？（所以它会在任务完成后执行我的 3 次点击，因此会调用 3 次事件）完全忽略前 2 次调用？另外，我应该怎么做才能避免这种问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-09T01:14:31.920

JavaScript 像单线程一样运行。我的理解是，某些浏览器在实际实现中有所不同，但是编写脚本并期望它们将线性执行是安全的。

[看到这个问题](https://stackoverflow.com/questions/2734025/is-javascript-guaranteed-to-be-single-threaded)

我想您的浏览器会在被阻止的 UI 期间将点击排队，但由浏览器决定如何处理这种情况。（我的 Chrome 在被阻止的 UI 期间排队点击事件）

也就是说，在较新的浏览器中实现了一个很酷的功能：

[网络工作者](http://ejohn.org/blog/web-workers/)

它允许您在后台执行昂贵/长时间的操作而不会阻塞 UI。如果您的脚本将在大多数新浏览器上运行，则可能值得深入研究此功能。奖励：那篇文章是由 jQuery 的鼻祖写的！=)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-09T01:28:19.507

您可能会使用加载栏或页面刷新元素来通知用户后台正在发生某些事情。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-09T01:46:33.913

看看[这个 jsfiddle](http://jsfiddle.net/masuK/6/)。正如 Shad 所说，在 Chrome 上，点击会排队，计算完成后会处理事件。一件奇怪的事情是，大计算之前的行

```
E('status').innerHTML = "Status: started"; 
```

似乎直到之后才被执行。另一个令人惊讶的事情是通过重复一些操作 10,000 或 100,000 次让整个浏览器挂起是多么容易。

如果服务器端解决方案不可行，解决方案可能是将计算分解为更小的操作批次，并以几毫秒的间隔一次执行一个批次，以允许代码的其他部分进行操作。与此同时，您可能需要“请稍候”消息。

# javascript - 从动态生成的 DIV 切换对象的状态

> ID：13783453
> 
> 赞同：0
> 
> 时间：2012-12-09T00:28:04.210
> 
> 标签：javascript, html, checkbox, toggle

我在使用复选框时遇到问题，单击该复选框时会将我的“联系人”对象的属性从 0 切换到 1。

该复选框是生成的包含所有对象详细信息的 DIV 的一部分。我要切换的属性称为“切换”。

我试图实现的是，当单击复选框时，它会执行 UpdateStatus() 方法，并将对象的“ID”作为参数传入。然后循环遍历数组中的所有对象以匹配对象的“ID”。

问题是它会切换每个对象的“切换”属性，而不仅仅是我试图定位的对象。

## 使用复选框生成 div 的代码

```
Contact.prototype.generateDiv = function(){

          divid = divid + 1;
          buttonid = buttonid + 1;
         var control = [];
         control[0] = divid;
         control[1] = buttonid;
         var mapLocation = " ";
         myControls.push(control);

    if(this.daysUntil<=14){  //This checks to see if the contacts birthday is within 7 days or less,and creates a warning flag variable so we can display a warning flag
        birthdayFlag = "<img src=resources/birthday.png>"
    }else{
        birthdayFlag = " "
    };

    if(this.post){ // this checks to see if there is a value in the Postcode attribute, if not it will set the map location to the address entered
      mapLocation = this.post;
    }else{
      mapLocation = this.address;
    }

    var childDiv =
                "<div class='parentDiv'>" +
                this.firstName + " " + this.surname + " " + birthdayFlag + "<input type='checkbox' onclick='updateStatus(this.ID)'>" + " " +  "<button class='btnForDiv' id='" + buttonid + "'" + " > Click to Expand </button>" +
                "<div class='childDiv'  id='" +  divid  + "' " +  ">" + "<img class=map src='http://maps.google.com/maps/api/staticmap?scale=1&center=" + mapLocation + "&zoom=14&size=500x350&maptype=hybrid&markers=size:normal|color:RED|label:C|" + mapLocation + "&sensor=false' style='float: right;border-style:groove'>" +
                "&nbsp" + "<span style='color:#5f9ea0';> Surname: </span>"  + "<br> &nbsp&nbsp&nbsp&nbsp" + this.surname +
                "<BR> &nbsp" + "<span style='color:#5f9ea0';> First Name:</span> " +"<br> &nbsp&nbsp&nbsp&nbsp" + this.firstName +
                "<br> &nbsp" + "<span style='color:#5f9ea0';> Date Of Birth:</span> " +"<br> &nbsp&nbsp&nbsp&nbsp" + this.days + "/" +  this.months + "/" + this.years +
                "<br> &nbsp" + "<span style='color:#5f9ea0';> Telephone Number:</span> " +"<br> &nbsp&nbsp&nbsp&nbsp" + this.phone +
                "<br> &nbsp" + "<span style='color:#5f9ea0';> Address:</span> " +"<br> &nbsp&nbsp&nbsp&nbsp" + this.address + " " + this.post +
                "<br> &nbsp" + "<span style='color:#5f9ea0';> Email Address:</span> " +"<br> &nbsp&nbsp&nbsp&nbsp" + this.email +
                "<br> &nbsp" + "<span style='color:#5f9ea0';> Group:</span> " +"<br> &nbsp&nbsp&nbsp&nbsp" + this.group +
                "<br> &nbsp" + "<span style='color:#5f9ea0';> Days Until Birthday:</span> " +"<br> &nbsp&nbsp&nbsp&nbsp" + this.daysUntil +
                "</div>" + "</div>" + "<HR width=1000px>"  + "<BR> ";
    return childDiv; 
```

## 应该切换“toggled”属性的代码

```
var updateStatus = function(thisID){
    alert("firing");
    for (i = 0; i < contacts.length; i += 1) {
        if (thisID = contacts[i].ID){
            if (contacts[i].toggled = "0"){
                contacts[i].toggled = "1";
            }else{
                if (contacts[i].toggled = "1"){
                    contacts[i].toggled = "0";
                }
            }
        }
    }

} 
```

## 以及需要的整个代码

```
var surnameField,firstNameField,birthdayField, phoneField, addressField, postField, emailField, groupField ;  //Declaring variables for the fields

var Contact = function(surname,firstName,date, phone , address , post, email, group, imglink){
    this.surname = surname ;
    this.firstName = firstName ;
    this.birthdayDate = new Date (date) ;
    this.phone = phone;
    this.address= address;
    this.email = email;
    this.post = post;
    this.group = group;
    this.toggled = "0" ;
    this.ID = "";

}

var contacts = [];
upcomingBirthdays = [];
divid = 0;
buttonid = 1000;
mapid = 100;
myControls = [];

var getDate = function() {

    for (var i= 0, j=contacts.length;i<j;i++){
        var y = contacts[i].birthdayDate.getFullYear();
        var m = contacts[i].birthdayDate.getMonth();
       var d = contacts[i].birthdayDate.getDate();
        contacts[i].days = d;
        contacts[i].months = m + 1;
        contacts[i].years = y ;
        var today = new Date() ;
        var ty = today.getFullYear();
        contacts[i].bdThisYear = new Date(ty,m,d, 0 , 0 , 0);

    }
}

var daysUntilBirthday = function(){
    for (var i= 0, j=contacts.length;i<j;i++){
        var today = new Date() ;
            contacts[i].daysUntil = Math.round((contacts[i].bdThisYear - today ) /1000/60/60/24+1);
            if (contacts[i].daysUntil <= 0){
            contacts[i].daysUntil =  contacts[i].daysUntil + 365 ;
        }
    }
}

var birthdayCheck = function(){
    for (var i= 0, j=contacts.length;i<j;i++){
        birth = "\n" + contacts[i].firstName + " " + contacts[i].surname + " has a birthday in " + contacts[i].daysUntil + " days" ;
        if(contacts[i].daysUntil <= 14){
            upcomingBirthdays.push (birth);
        }
    }
    if(upcomingBirthdays.length > 0){
        alert(upcomingBirthdays);
    }

}

Contact.prototype.generateDiv = function(){

          divid = divid + 1;
          buttonid = buttonid + 1;
         var control = [];
         control[0] = divid;
         control[1] = buttonid;
         var mapLocation = " ";
         myControls.push(control);

    if(this.daysUntil<=14){  //This checks to see if the contacts birthday is within 7 days or less,and creates a warning flag variable so we can display a warning flag
        birthdayFlag = "<img src=resources/birthday.png>"
    }else{
        birthdayFlag = " "
    };

    if(this.post){ // this checks to see if there is a value in the Postcode attribute, if not it will set the map location to the address entered
      mapLocation = this.post;
    }else{
      mapLocation = this.address;
    }

    var childDiv =
                "<div class='parentDiv'>" +
                this.firstName + " " + this.surname + " " + birthdayFlag + "<input type='checkbox' onclick='updateStatus(this.ID)'>" + " " +  "<button class='btnForDiv' id='" + buttonid + "'" + " > Click to Expand </button>" +
                "<div class='childDiv'  id='" +  divid  + "' " +  ">" + "<img class=map src='http://maps.google.com/maps/api/staticmap?scale=1&center=" + mapLocation + "&zoom=14&size=500x350&maptype=hybrid&markers=size:normal|color:RED|label:C|" + mapLocation + "&sensor=false' style='float: right;border-style:groove'>" +
                "&nbsp" + "<span style='color:#5f9ea0';> Surname: </span>"  + "<br> &nbsp&nbsp&nbsp&nbsp" + this.surname +
                "<BR> &nbsp" + "<span style='color:#5f9ea0';> First Name:</span> " +"<br> &nbsp&nbsp&nbsp&nbsp" + this.firstName +
                "<br> &nbsp" + "<span style='color:#5f9ea0';> Date Of Birth:</span> " +"<br> &nbsp&nbsp&nbsp&nbsp" + this.days + "/" +  this.months + "/" + this.years +
                "<br> &nbsp" + "<span style='color:#5f9ea0';> Telephone Number:</span> " +"<br> &nbsp&nbsp&nbsp&nbsp" + this.phone +
                "<br> &nbsp" + "<span style='color:#5f9ea0';> Address:</span> " +"<br> &nbsp&nbsp&nbsp&nbsp" + this.address + " " + this.post +
                "<br> &nbsp" + "<span style='color:#5f9ea0';> Email Address:</span> " +"<br> &nbsp&nbsp&nbsp&nbsp" + this.email +
                "<br> &nbsp" + "<span style='color:#5f9ea0';> Group:</span> " +"<br> &nbsp&nbsp&nbsp&nbsp" + this.group +
                "<br> &nbsp" + "<span style='color:#5f9ea0';> Days Until Birthday:</span> " +"<br> &nbsp&nbsp&nbsp&nbsp" + this.daysUntil +
                "</div>" + "</div>" + "<HR width=1000px>"  + "<BR> ";
    return childDiv;

}

var updateStatus = function(thisID){
    alert("firing");
    for (i = 0; i < contacts.length; i += 1) {
        if (thisID = contacts[i].ID){
            if (contacts[i].toggled = "0"){
                contacts[i].toggled = "1";
            }else{
                if (contacts[i].toggled = "1"){
                    contacts[i].toggled = "0";
                }
            }
        }
    }

}

var assignID = function(){
    for (i = 0; i < contacts.length; i += 1) {
      contacts[i].ID = "" + i + "" ;
    }
}

var removeContacts = function () {
    for (i = 0; i < contacts.length; i += 1) {
        if (contacts[i].toggled = "1"){
            contacts.splice(i,1);
        }
    }
    updateList();

}

var addContact = function(surnameField,firstNameField,birthdayField, phoneField, addressField, postField, emailField, groupField ){
        if(surnameField.value){
            a = new Contact(surnameField.value, firstNameField.value,birthdayField.value, phoneField.value, addressField.value, postField.value, emailField.value, groupField.value);
            contacts.push(a);
        }else{ alert("Please complete all fields")}

}

var clearUI = function(){
    var white = "#fff";
    surnameField.value = "";
    surnameField.style.backgroundColor = white;
    firstNameField.value = "";
    firstNameField.style.backgroundColor = white;
    birthdayField.value="";
    birthdayField.style.backgroundColor = white;
    phoneField.value = "";
    phoneField.style.backgroundcolor = white;
    addressField.value = "";
    addressField.style.backgroundcolor = white;
    postField.value = "";
    postField.style.backgroundcolor = white;
    emailField.value = "";
    emailField.style.backgroundcolor = white;
    groupField.value="";
    groupField.style.backgroundcolor = white;

}

var updateList = function(elements){
    assignID();
    myControls = []
    var tableDiv = document.getElementById("parentDiv"),
        cDiv = "<BR>" ;

    for (var i= 0, j=elements.length;i<j;i++){
        var cntct = elements[i];
        cDiv += cntct.generateDiv();
    }

    tableDiv.innerHTML = cDiv;
    getDate();
    daysUntilBirthday();
    saveContacts();
}

var add = function(){
;
    addContact(surnameField,firstNameField,birthdayField, phoneField, addressField, postField, emailField, groupField, imgField);
    clearUI();
    daysUntilBirthday();
    getDate();
    updateList(contacts);
    updateList(contacts);
};

var saveContacts = function(){
    var cntcts = JSON.stringify(contacts);
    if (cntcts !==""){
        localStorage.contacts = cntcts;
    }else{
        alert("Could not save contacts");
    }
}

var loadContacts = function(){
    var cntcts = "";
    if(localStorage.contacts !== undefined){
        cntcts = localStorage.contacts;
        contacts = JSON.parse(cntcts);
        var proto = new Contact();
        for (var i=0; i<contacts.length; i++){
            var cntct = contacts[i]
            cntct.__proto__ = proto;
            cntct.birthdayDate = new Date(cntct.birthdayDate);
        }
    }
}

var clearContacts = function(){
    contacts = [];
    updateList(contacts);

}

var sort_by = function(field, reverse, primer){

    var key = function (x) {return primer ? primer(x[field]) : x[field]};

    return function (a,b) {
        var A = key(a), B = key(b);
        return (A < B ? -1 : (A > B ? 1 : 0)) * [1,-1][+!!reverse];
    }
}

var sortBySurname = function(){
    contacts.sort(sort_by('surname', false, function(a){return a.toUpperCase()}));
    updateList(contacts)
}

var sortByFirstname = function(){
    contacts.sort(sort_by('firstName', false, function(a){return a.toUpperCase()}));
    updateList(contacts)
}

var sortByGroup= function(){
    contacts.sort(sort_by('group', false, function(a){return a.toUpperCase()}));
    updateList(contacts)
}

var sortByBirthday= function(){
    contacts.sort(sort_by('daysUntil', false, parseInt));
    updateList(contacts)
}

window.onload = function(){
    loadContacts();
    updateList(contacts);
    surnameField = document.getElementById("surname");
    firstNameField = document.getElementById("firstName")
    birthdayField = document.getElementById("birthday");
    phoneField = document.getElementById("phone");
    addressField = document.getElementById("address");
    postField = document.getElementById("post");
    emailField = document.getElementById("email");
    groupField = document.getElementById("group");
    imgField = document.getElementById("image");
    addButton = document.getElementById("addButton");
    addButton.onclick = add;
    delButton = document.getElementById("delButton");
    searchField = document.getElementById("searchField");
    searchButton = document.getElementById("searchButton");
    //searchButton.onclick = doSearch();
    //delButton.onclick = removeContacts();
    sortSurnameButton = document.getElementById("surnameSort");
    sortSurnameButton.onclick = sortBySurname;
    sortFirstNameButton = document.getElementById("firstNameSort");
    sortFirstNameButton.onclick = sortByFirstname;
    sortGroupButton = document.getElementById("groupSort");
    sortGroupButton.onclick = sortByGroup;
    birthSortButton = document.getElementById("birthSort");
    birthSortButton.onclick = sortByBirthday;
    clearUI();
    birthdayCheck();

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T01:42:24.700

过度复杂切换器的错误：试试这个：

```
if (thisID === contacts[i].ID){  //<- HERE WAS MISTAKE - single =
    contacts[i].toggled=contacts[i].toggled==="1"? "0": "1"
} 
```

最好按 id 索引您的联系人`Object`以避免按 id 循环...或者在访问数组时仅使用 id，您可以使用[此函数](https://stackoverflow.com/a/105074/815386)生成类似 UUID。

您可以使用以下方法实现：

```
var addContact = function(surnameField,firstNameField,birthdayField, phoneField, addressField, postField, emailField, groupField ){
        if(surnameField.value){
            a = new Contact(surnameField.value, firstNameField.value,birthdayField.value, phoneField.value, addressField.value, postField.value, emailField.value, groupField.value);
            contacts[GUID()]=a;
        }else{ alert("Please complete all fields")}

} 
```

对象将看起来像：

```
{ef9cffdc-9132-af78-6147-6bfc2cb247dc: {object data}, 405e61ae-881e-4b11-eab6-2f2355ca54ae  : {object data},} 
```

并且可以通过`objects[ID];` 单个对象删除轻松访问，如下所示`delete(objects[ID])`：循环将看起来：

```
for (var id in objects) {
   var object=objects[id];
} 
```

够容易吗？

# mysql - 将 MySQL 限制为仅本地主机 - xampp

> ID：13783457
> 
> 赞同：5
> 
> 时间：2012-12-09T00:28:44.803
> 
> 标签：mysql, phpmyadmin, xampp, localhost

我在 Windows Server 2008 R2 上托管了一些较小的站点/游戏服务器，现在我可以在我的连接日志中看到该数据库的使用不仅仅是本地托管的东西，所以我想将我的 mysql 限制为仅本地主机，我知道这样做我将无法使用我的“Mysql 控制中心”，但这就是 Xammp 在这里的原因，从第一天开始就有“PhpMyAdmin”。但是我如何进行设置，所以它只是本地主机？和我的 www.mysqlhostsite.com/phpmyadmin。

我得到的东西：

```
Windows server 2008 R2
Mysql
Phpmyadmin
xampp 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-09T00:43:19.640

[您可以使用bind-address](http://dev.mysql.com/doc/refman/5.5/en/server-options.html#option_mysqld_bind-address)选项限制来自特定地址（例如 localhost）的连接。在你的`my.ini`文件中配置它：

```
[mysqld]
bind-address = localhost 
```

或者，您可以强制 MySQL 使用*命名管道*（一种仅限本地的连接方法）：

```
[mysqld]
bind-address = localhost
skip-networking
enable-named-pipe 
```

当然，在编辑完 my.ini 后重启 MySQL 服务。

# css - W3 CSS 验证错误

> ID：13783459
> 
> 赞同：0
> 
> 时间：2012-12-09T00:29:02.260
> 
> 标签：css

[这是我在http://jigsaw.w3.org/css-validator/](http://jigsaw.w3.org/css-validator/)检查我的网站时的错误消息：

> 值错误：边框样式太多的值或无法识别的值：0

```
.style2 {
background-color : #889B25;
text-align : center;
background-image : url('images/tile3_green.jpg');
}
.style6 {
text-align : center;
}
.style7 {
font-size : xx-small;
}
.style9 {
text-align : center;
font-family : "AR CENA";
font-size : x-large;
color : #339933;
}
.style10 {
text-align : left;
}
.style11 {
color : #339933;
}
.style12 {
text-align : left;
color : #339933;
}
.style13 {
background-image : url('images/tile1.gif');
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T00:42:23.870

错误不在您发布的 CSS 中。此消息的含义是您页面上某处的 css 属性`border-style`设置不正确。所以寻找它，看看`border-style`应该如何设置。

# asp.net-mvc-4 - 使用 MVCSitemap 中的可见性（默认）属性仅在面包屑中显示节点

> ID：13783466
> 
> 赞同：1
> 
> 时间：2012-12-09T00:30:15.077
> 
> 标签：asp.net-mvc-4, mvcsitemapprovider

任何使用 MVCSiteMapProvider 包实现了单个 xml 文件但不同的菜单和面包屑的人。

我的 MVC.Sitemap 与我的菜单和面包屑配合得很好。我为主页添加了一个新节点 - 产品这是产品控制器上的索引操作我不希望它出现在我的菜单中，但我确实希望它出现在我的面包屑中，当有人登陆 /myapp/Products/Index 或 Products/Index

目前我正在使用从示例中提取的 visibility="SiteMapPathHelper,!*" 并且我假设最新的 nuget 包和我的 web.config 设置为

attributesToIgnore="可见性"

这是令人困惑的，因为我不明白这是否意味着忽略参数，或者它是否告诉需要忽略的节点填充了这个参数并且值应该作为条件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-09T18:47:38.597

默认情况下，MvcSiteMapProvider 在您的菜单 XML 声明中看到的任何属性都会添加到 url 参数中。

所以，如果你有这个：

```
<mvcSiteMapNode area="Admin" controller="User" action="Index" title="Users" someRandomAttribute=3/> 
```

站点地图将使用

/admin/user/index?someRandomAttribute=3 用于 url。

如果将 attributesToIgnore="someRandomAttribute" 放在配置中，它将生成的 url 将变为：

/管理员/用户/索引

可见性提供程序是一个插件系统 - 默认使用一个“可见性”属性，因此它可以决定节点是否可见。

# ios - 在Xcode中将部分文本左对齐和右对齐

> ID：13783470
> 
> 赞同：0
> 
> 时间：2012-12-09T00:31:08.090
> 
> 标签：ios, xcode, uitableview, alignment

我正在用营养成分填充 UITableView 表。每行包括营养素的绝对量以及每日百分比值。我想将金额与每行的左侧对齐，将每日百分比值与右侧对齐，以便信息看起来更整洁，并且所有值都对齐。有什么办法可以做到这一点吗？谢谢！

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath     *)indexPath
{

    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:@"NutritionCell" forIndexPath:indexPath];

    if(!cell) {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleValue1 reuseIdentifier:@"NutritionCell"];
    }

    CGRect oldFrame = cell.frame;
    cell.textLabel.frame = CGRectMake(oldFrame.origin.x, oldFrame.origin.y, tableView.frame.size.width/2, oldFrame.size.height);
    cell.detailTextLabel.frame = CGRectMake(oldFrame.origin.x + tableView.frame.size.width/2, oldFrame.origin.y, tableView.frame.size.width/2, oldFrame.size.height);

    cell.textLabel.text = [factamount objectAtIndex:indexPath.row];
    cell.detailTextLabel.text = [percentDV objectAtIndex:indexPath.row];
    return cell;

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-09T00:40:10.523

您可以使用以下代码，

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {
    static NSString *CellIdentifier = @"Cell";

    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
    if (cell == nil) {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleValue1 reuseIdentifier:CellIdentifier];
    }

    cell.textLabel.text = @"Left";
    cell.detailTextLabel.text = @"Right";

    return cell;
} 
```

如果您想在单元格中使用多个自定义标签（两个以上），您也可以这样做并将其添加为子视图并使用属性`cell.contentView`对齐。`textAlignment`您可以设置这些标签的框架以在适当的位置显示。

在这种情况下，您需要这样做

```
myLabel1.textAlignment = NSTextAlignmentLeft;
myLabel2.textAlignment = NSTextAlignmentRight; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-09T00:42:20.830

你也可以使用 UITableViewCellStyleValue1 来做到这一点。它会自动向单元格添加 2 个标签：

```
-(UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
    {
        static NSString *cellID = @"CELLID";
        UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:cellID];
        if(!cell) {
            cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleValue1 reuseIdentifier:cellID];
        }

        cell.textLabel.text = @"AMOUNT TEXT";
        cell.detailTextLabel.text = @"PERCENT TEXT";
        return cell;
    } 
```

# php - PHP - 获取 URL 参数并在数组中重新排列

> ID：13783480
> 
> 赞同：3
> 
> 时间：2012-12-09T00:32:47.900
> 
> 标签：php, arrays, url, url-routing, url-parameters

进入页面的 URL 如下所示：

“http://localhost/testSite/id/1/friend_id/32/msg_id/5/category_id/40”

我想剥离这些变量（**id/1**，**friend_id/32**，**msg_id/5**等）并将它们变成这样的数组：

```
$params = array('id' => 1, 'friend_id' => 32, 'msg_id' => 5, 'category_id' => 40) 
```

这样我就可以像这样访问这些值：

```
$params['id']; $params['friend_id']; 
```

我以为我正在使用以下代码到达某个地方，但这并没有太大帮助。

```
 $keys = explode('/', $url);
    $k2 = $keys;
    $result = array();

    foreach ($keys as $k => $v) {
       $result[$v] = next($k2); 
    }
    array_pop($result);
    print_r($result); 
```

我将从上面的代码中得到以下输出：

```
Array
(
    [id] => 1
    [1] => friend_id
    [friend_id] => 32
    [32] => msg_id
    [msg_id] => 5
    [5] => category_id
    [category_id] => 40
) 
```

以前有人这样做过吗？如何修改上面的代码以使其正常工作？或者有人对如何做到这一点有其他想法吗？

我真的很感激任何帮助，谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-09T00:39:28.033

如果这是由框架完成的，则应该有获取参数的方法。在这种情况下，请参阅文档。

否则，您可以使用简单的正则表达式来解析它。这个想法是使用定义前缀（`$root`在代码中）。

```
$url = 'http://localhost/testSite/id/1/friend_id/32/msg_id/5/category_id/40';
$root = 'http://localhost/testSite/';
$params =  substr($url, strlen($root));
preg_match_all("#([^/]+)/([^/]+)#", $params, $match);
$result = array_combine($match[1], $match[2]); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-09T00:52:05.950

```
$parts = explode('/', $url);
$len = count($parts);
$result = array();
for ($i = 0; $i < $len; $i+=2) {
  $result[$parts[$i]] = $parts[$i+1];
} 
```

# ruby-on-rails - Rails 中的嵌套布局

> ID：13783490
> 
> 赞同：5
> 
> 时间：2012-12-09T00:36:46.160
> 
> 标签：ruby-on-rails

是否可以在 Rails 3.2 中嵌套布局？我想创建一个由 application.html.erb 使用的通用布局，并允许应用程序中的几个视图使用它。我找到了[Nested Layouts](https://github.com/eric/nested-layouts) ruby​​ gem，但它已经四年没有更新了。如果我可以在我的 application.html.erb 文件中执行以下操作，那就太棒了：

```
<% inside_layout 'html5_boilerplate' do %>
  <div id="container">
    <%= yield %>
  </div>
<% end %> 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-09T03:07:42.443

[我在这篇博文](http://m.onkey.org/nested-layouts-in-rails-3)中找到了一个简单的解决方案。

在我的`ApplicationHelper`中，我添加了以下内容：

```
def parent_layout(layout)
  @view_flow.set(:layout, output_buffer)
  self.output_buffer = render(:file => "layouts/#{layout}")
end 
```

在 application.html.erb 中，我添加了：

```
<% parent_layout 'html5_boilerplate' %> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-05-04T16:33:45.263

我尝试了其中的一些，但在 Rails 4 中没有一个对我有用。但是从[nested_layouts](https://github.com/sunteya/nested_layouts/blob/master/lib/nested_layouts.rb) gem 中得到一点启发，我想出了以下简单的修复方法：

```
module ApplicationHelper
  def inside_layout(layout, &block)
    layout = "layouts/#{layout}" unless layout =~ %r[\Alayouts/]
    content_for :content, capture(&block)
    render template: layout
  end
end 
```

然后我修改了我的`layouts/application.html.erb`模板，使其类似于：

```
<html>
  <body>
    <div id="content">
      <%= content_for?(:content) ? yield(:content) : yield %>
    </div>
  </body>
</html> 
```

现在我可以像这样声明一个嵌套布局：

```
# app/views/layouts/blog.html.erb
<%= inside_layout 'application' do %>
  <div id="blog_container">
    <%= yield %>
  </div>
<% end %> 
```

希望这可以帮助！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-09T00:45:13.370

您可以使用[官方 Rails 指南中描述](http://guides.rubyonrails.org/layouts_and_rendering.html#using-the-content-for-method)`content_for`的方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-09T00:54:21.587

AFAIK 您的应用程序布局将围绕您的应用程序中的所有内容。所以真的只是将这些部分构建到您在个人视图级别上的关系中。

我有一个人对象，该对象的模型的其他部分包含在它们的部分渲染中，如下所示。它并不漂亮，但希望它符合您想要完成的目标。

```
<div id="div-1">
    <fieldset><legend><b>Registrant Information</b></legend>
        <fieldset><legend><b>Personal Information</b></legend>
          <p class="field">
            <%= f.label "First Name" %>
            <%= f.text_field :firstname %>
        &nbsp;&nbsp;
            <%= f.label "Last Name" %>
            <%= f.text_field :lastname %>
        &nbsp;&nbsp;
            <%= f.label "Middle Init" %>
            <%= f.text_field :middleinit, :size=>2 %>
        &nbsp;&nbsp;
            <%= f.label "Nickname" %>
            <%= f.text_field :nickname %>
            </p> 
          <p class="field"> 
            <%= f.label :birthdate %>
            <%= f.date_select :birthdate, :start_year=>1935%>
        &nbsp;&nbsp;
            <%= f.label :gender %>
            <%= f.select :gender, ['Male','Female'] %>
            </p> 
          <p class="field">
            <%= f.label "T-Shirt Size" %><br />
            <%= f.select :shirtsize, ['YS','YM','YL','S','M','L','XL','XXL'] %>
            </p>
        </fieldset><br/>
        <fieldset><legend><b>Address Information</b></legend>
          <%= f.fields_for :addresses do |builder| %>
            <%= render "address_fields", f: builder %>
          <% end %>
        </fieldset>
        <fieldset><legend><b>Email</b></legend>
            <%= f.fields_for :emails do |builder| %>
                <%= render "email_fields", f: builder %>
            <% end %>
            <%= link_to_add_fields "Add Email", f, :emails %>
        </fieldset>
    </fieldset>    
</div> 
```

# java - 我可以在 Java 中动态引用字段类吗？

> ID：13783491
> 
> 赞同：-4
> 
> 时间：2012-12-09T00:36:54.177
> 
> 标签：java, dynamic, reference, field

我有一个名为的类`Bird`，它由 3 个字符串字段组成，每个字段都是不同语言的名称，例如`Bird.lang1`, `Bird.lang2`, `Bird.lang3`。我有一个名为 Bird 的实例`allbirds`。

现在我想制作一个`ListOfAllBirds`包含所有鸟类名称的字符串列表，使用用户选择的语言，存储在`lang`变量中，其值为`lang1`, `lang2`,之一`lang3`。我需要这样做数百次（调用这个次数`N`）。

当然，我可以对所有 Bird 元素进行迭代，并将相应的字段添加到`lang`. 但这意味着`3 x N x Bird.size()`（即数十万！！）条件查询来测试用户选择的语言。

我可以做类似的事情吗

```
varfield = lang.toField();
for (Bird birdy : allbirds)
    ListOfAllBirds.add(birdy.varfield); 
```

也就是说，我可以引用带有变量的字段吗？这将为我节省大量的条件查询！

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T00:57:36.420

我使用字符串数组的意思是这样的（如果您不想按照 Vulcan 的建议将语言设置更改为 int）。

```
String chosenLanguage = "Language 2";
int languageIndex = -1;
switch(chosenLanguage)
{
    case "Language 1": 
        languageIndex = 0;
        break;
    case "Language 2":
        languageIndex = 1;
        break;
    case "Language 3":
        languageIndex = 2;
        break;
    default:
        languageIndex = 0;
        break;
}

for (Bird birdy : allbirds)
       ListOfAllBirds.add(birdy.names[languageIndex]); 
```

您的课程将如下所示：

```
class Bird
{
    public String[] names = {"name1", "name2", "name3"};
} 
```

代替

```
class Bird
{
    public String lang1 = "name1";
    public String lang2 = "name2";
    public String lang3 = "name3";
} 
```

这样，您只需检查一次用户选择的语言（以查找索引），然后您可以遍历所有鸟类并根据索引获得正确的名称。

# r - S4 中的 setMethod - 如何定义不需要对象作为参数的方法？

> ID：13783493
> 
> 赞同：0
> 
> 时间：2012-12-09T00:37:03.967
> 
> 标签：r, s4

在带有 S4 类的 R 中，我定义了一个方法来为一个对象分配两个值：

```
setGeneric("setValues", function(object, x, y) {
    standardGeneric("setValues")
})

setMethod(f = "setValues", signature = "chart", definition = function(object, x, y) {
    object@x <- x
    object@y <- y
    return(object)
}) 
```

然后按如下方式使用它

```
obj <- setValues(obj, "value_X", "value_Y") 
```

但是，这意味着我必须一直写`obj`为函数的参数。

***是否可以在 S4 中定义一个可以在没有对象本身作为参数的情况下使用的方法？***

例如：

```
obj <- setValues("value_X", "value_Y") 
```

我非常感谢任何建议！:)

# javascript - Chrome 扩展程序中的上下文菜单

> ID：13783500
> 
> 赞同：33
> 
> 时间：2012-12-09T00:38:14.553
> 
> 标签：javascript, google-chrome-extension

我已经搜索和搜索并搜索了解决方案，但我遇到的每个来源似乎都假设我已经对 Chrome 扩展有深入的了解，甚至是谷歌的帮助页面

我知道 Chrome 扩展的基础知识，并且我用一些基本的内容脚本制作了一个。但是，现在我正在寻找一种涉及上下文菜单的方法。

假设当您突出显示单词并右键单击它们时，您会看到该选项，然后单击它会在新选项卡中`Search '<highlighted words>' on Google`打开。`http://www.google.com/search?q=<highlighted words>`我知道这存在于 Chrome 中，并且我确信已经有十亿个扩展复制它，但这只是我构建的一个示例。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：71
> 
> 时间：2012-12-09T00:45:54.847

脚本应如下所示：

```
function getword(info,tab) {
  console.log("Word " + info.selectionText + " was clicked.");
  chrome.tabs.create({  
    url: "http://www.google.com/search?q=" + info.selectionText
  });
}
chrome.contextMenus.create({
  title: "Search: %s", 
  contexts:["selection"], 
  onclick: getword
}); 
```

和 manifest.json：

```
{
    "name": "App name",
    "version": "1.0",
    "manifest_version": 2,
    "description": "Your description",
    "permissions": [
      "contextMenus"
     ],
    "background": { 
      "scripts": ["script.js"]
    }
} 
```

在这里你有如何加载扩展：http: [//developer.chrome.com/extensions/getstarted.html](http://developer.chrome.com/extensions/getstarted.html)

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2020-04-05T05:33:31.617

Bartlomiej Szalach 的答案太老了。它不适用于 Chrome 版本 80.0.3987.163（2020 年 4 月）。

根据文件，

> onclick：单击菜单项时回调的函数。活动页面不能使用这个；相反，他们应该为 contextMenus.onClicked 注册一个监听器。

background.js 应该修改如下：

```
const CONTEXT_MENU_ID = "MY_CONTEXT_MENU";
function getword(info,tab) {
  if (info.menuItemId !== CONTEXT_MENU_ID) {
    return;
  }
  console.log("Word " + info.selectionText + " was clicked.");
  chrome.tabs.create({  
    url: "http://www.google.com/search?q=" + info.selectionText
  });
}
chrome.contextMenus.create({
  title: "Search: %s", 
  contexts:["selection"], 
  id: CONTEXT_MENU_ID
});
chrome.contextMenus.onClicked.addListener(getword)
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2021-05-13T12:58:33.043

改进 ahnquan 的答案，因此`chrome.contextMenus.create`不会在每个后台脚本调用中调用，并且还将其编码`highlighted text`为 URI，因此当它包含特殊字符时不会中断，例如`;,/?:@&=+$`.

您的 background.js 将如下所示：

```
chrome.runtime.onInstalled.addListener(function() {
    chrome.contextMenus.create({
        "title": 'Search Google for "%s"',
        "contexts": ["selection"],
        "id": "myContextMenuId"
    });
});

chrome.contextMenus.onClicked.addListener(function(info, tab) {
    chrome.tabs.create({  
        url: "http://www.google.com/search?q=" + encodeURIComponent(info.selectionText)
    });
}) 
```

和 manifest.json：

```
{
    "manifest_version": 2,
    "name": "App name",
    "version": "1.0",

    "permissions": ["contextMenus"],
    "background": { 
        "scripts": ["background.js"],
        "persistent": false
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2021-12-22T17:18:13.443

Manifest v3 已发布，因此为了改进 Lucas Mendonca 的答案，您只需将 manifest.json 更改为：

```
{
    "manifest_version": 3,
    "name": "App name",
    "version": "1.0",

    "permissions": ["contextMenus"],
    "background": { 
        "service_worker": "background.js",
        "persistent": false
    }
} 
```

# java - 求平方为 1_2_3_4_5_6_7_8_9_0 形式的最小数。其中“_”可以是任何 1 位数字

> ID：13783515
> 
> 赞同：1
> 
> 时间：2012-12-09T00:41:00.850
> 
> 标签：java, string, long-integer

在我最近的采访中，面试官问我要
`write a Java program to find the least number whose square is of form 1_2_3_4_5_6_7_8_9_0\. Where "_" could be any 1 digit number.`
我坚持下去。

任何人都可以帮助我实现要实现的逻辑吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-09T00:51:37.113

好吧，该格式的最小数量是`1020304050607080900`具有平方根`1010101010.10...`的。该格式的最大数量`1929394959697989990`约为平方根。`1389026623.11`.

从下限开始，并迭代到上限。您使用正则表达式甚至基本的字符串字符匹配，只需检查第一个字符是 1，第三个字符是 2，等等。

另外，我认为 a`long`就足够了。

编辑：

我只是在我的机器上运行了这个，大约花了 2 分钟。我很讨厌正则表达式，所以我做了原始风格。

```
public static void main(String[] args) {
    for (long l = 1010101010; l < 1389026623; l++) {
        long squared = l * l;
        String s = Long.toString(squared);
        if (s.charAt(0) != '1') continue;
        if (s.charAt(2) != '2') continue;
        if (s.charAt(4) != '3') continue;
        if (s.charAt(6) != '4') continue;
        if (s.charAt(8) != '5') continue;
        if (s.charAt(10) != '6') continue;
        if (s.charAt(12) != '7') continue;
        if (s.charAt(14) != '8') continue;
        if (s.charAt(16) != '9') continue;
        if (s.charAt(18) != '0') continue;
        System.out.println(s);
    }
} 
```

结果是`1929374254627488900`（这是平方数）。因此，根号为`1389019170`。另请注意，这是我发现与模式匹配的**唯一**数字，而不仅仅是最小值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-09T00:45:34.077

一个简单但可能效率不高的解决方案是使用[`BigInteger`](http://docs.oracle.com/javase/6/docs/api/java/math/BigInteger.html), 并迭代数字（从下向上），直到找到`n`与`n.multiply(n).toString()`模式匹配的数字。

`toString()`在对结果平方数进行操作之后，可以使用正则表达式轻松验证模式是否匹配。

正则表达式：

```
Matcher m = Pattern.compile(
      "1[0-9]2[0-9]3[0-9]4[0-9]5[0-9]6[0-9]7[0-9]8[0-9]9[0-9]0").matcher(""); 
```

并调用：

```
m.reset(myString);
m.matches() 
```

当且仅当匹配模式`matches()`时才会返回 true`myString`

* * *

**编辑：**

使用@The111 建议的优化来提高性能，这个想法仍然存在 - 迭代并检查结果是否与模式匹配。

# c - 访问C中数组的变量元素

> ID：13783522
> 
> 赞同：1
> 
> 时间：2012-12-09T00:43:03.713
> 
> 标签：c, arrays, element

我是编程新手，所以这可能有一个简单的解决方案。这是我想要做的事情。

我的程序加载一个 .bmp 图像，然后获取宽度和高度来找出图像有多少像素。然后它使用 calloc() 为每个像素的 RGB 值创建三个数组，即 RED、BLUE、GREEN 的数组。我使用了一个 while() 循环来获取第一个像素并将 RGB 值放在它们各自数组的第一个元素中。然后它继续前进，对第二个像素、第三个、第四个像素做同样的事情……这就是我的问题所在，它似乎不想将值放入数组中。我是这样做的，

```
while(temp=fgetc(fp) != NULL)
{
BLUE[current_pixel]=temp;

temp=fgetc(fp);
GREEN[current_pixel]=temp;

temp=fgetc(fp);
RED[current_pixel]=temp;

current_pixel++;
} 
```

current_pixel 是一个变量，用于跟踪我现在正在查看的像素。

所以我想我真正想知道的是为什么我不能做 BLUE[current_pixel]=temp; 编译时我没有收到任何错误，我使用 printf() 语句检查问题出在哪里。

我已经尝试过 BLUE[1]=temp 并且它工作正常，但这对我的程序没有好处，因为我无法移动到下一个像素来保存值。

预先感谢您的任何帮助！

编辑：我仍然无法让它工作，所以我只想在这里发布整个程序。

```
#include <stdio.h>
#include <stdlib.h>
int main()
{
FILE*fp;
int current_pixel=0;
int temp=0;
int paddingremoved=0;
int cycle=0;
int *RED;
int *BLUE;
int *GREEN;
int imgstrt=0;
int width=0;
int height=0;
int padding=0;

fp=fopen("C:\\Users\\Jason\\Documents\\test.bmp","rb");

if(fp==NULL)
{
printf("Error: File could not be opened");
getchar();
return(0);
}

fseek(fp,10,SEEK_SET);
fread(&imgstrt,1,1,fp);
printf("Image Starts At:%d\n",imgstrt);

fseek(fp,18,SEEK_SET);
fread(&width,4,1,fp);
printf("Image Width:%d\n",width);

fseek(fp,22,SEEK_SET);
fread(&height,4,1,fp);  
printf("Image Height:%d\n",height);

padding=(4 -(width*3)%4)%4;
printf("Padding:%d\n",padding);
getchar();

RED = (int*)calloc(height*width+1,sizeof(int));
GREEN = (int*)calloc(height*width+1,sizeof(int));
BLUE = (int*)calloc(height*width+1,sizeof(int));

if(RED == NULL)
{printf("Red Allocation Faliure\n");}
else{printf("Red Allocation Successful\n");}

if(GREEN == NULL)
{printf(" Green Allocation Faliure\n");}
else{printf("Green Allocation Successful\n");}

if(BLUE == NULL)
{printf("Blue Allocation Faliure\n");}
else{printf("Blue Allocation Successful\n");}

fseek(fp,54,SEEK_SET);
/*---------------------Main Loop--------------------------------*/
while((temp = fgetc(fp)) != EOF)
{
    BLUE[current_pixel]=temp;
    temp=fgetc(fp);
    GREEN[current_pixel]=temp;
    temp=fgetc(fp);
    RED[current_pixel]=temp;
    cycle++;
    current_pixel++;

    printf("[%d,%d,%d::%d] ",RED[current_pixel],GREEN[current_pixel],BLUE[current_pixel],current_pixel);
/*------------------------------------------------------------------*/

    /*---------------------Padding Remover-----------------------*/
    if(cycle==width)
    {printf("\n");
    while (paddingremoved!=padding)
    {fgetc(fp); 
                paddingremoved++;}
    cycle=0;
    paddingremoved=0;}
    /*-----------------------------------------------------------*/
}

getchar();
free(RED);
free(BLUE);
free(GREEN);
return(0);
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-09T00:54:27.793

由于 C 运算符优先级，您的`while`条件为：

```
temp=(fgetc(fp) != NULL) 
```

并不是

```
(temp=fgetc(fp)) != NULL 
```

使用括号。此外，`fgetc`返回`EOF`错误/完成，而不是`NULL`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-09T00:56:34.440

由于运算符优先级，您的代码始终将每个 BLUE 像素设置为 1。while() 循环条件将结果`fgetc(fp)`与 NULL 进行比较，然后设置`temp`为该比较的结果（即 0 或 1）。所以每个蓝色像素都将设置为 1。

试试这个：

```
while((temp = fgetc(fp)) != EOF) 
```

# android - 有没有办法通过 Intent 和 Parcelable 传递 DOM 对象？

> ID：13783528
> 
> 赞同：1
> 
> 时间：2012-12-09T00:43:55.357
> 
> 标签：android, dom, android-intent, parcelable, jaxp

有没有办法通过 Intent 和 Parcelable 传递 JAXP 节点或文档？JAXP 没有实现 Parcelable，所以答案可能是 --no。有没有实现 Parcelable 的 DOM 库？有人可以提供一个可行的例子吗？

序列化不是一种选择；令人讨厌的表现受到打击。将数据存储在 res/xml 中不是一种选择：它最终必须（在项目结束时）在磁盘上加密。Android 的“编译”XML 访问工具不支持解密整个 XML。当然，我可以自己上课。

这是我膨胀 XML 的起始代码。我的目标是将节点或文档从一个 ListView 传递到另一个，通过 Lists 有效地钻取 DOM。

我的文档包含所有活动都需要共享的信息。每个活动访问不同的节点，并提取新信息。我考虑过通过全局公开文档，但我认为多个活动以这种方式访问​​它并不安全。

另外，在下面的工作代码中，我打算将一个节点传递给第二个 ListActivity 而不是一个字符串，只是还没有走那么远。

```
package com.example

import java.io.File;

import javax.xml.parsers.DocumentBuilder;
import javax.xml.parsers.DocumentBuilderFactory;

import org.w3c.dom.Document;
import org.w3c.dom.Node;
import org.w3c.dom.NodeList;

import android.app.ListActivity;
import android.content.Intent;
import android.os.Bundle;
import android.view.View;
import android.widget.*;
import android.widget.AdapterView.OnItemClickListener;

public class JAXPListActivity extends ListActivity {
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        Document doc = null;
        try {
            DocumentBuilderFactory factory = 
                        DocumentBuilderFactory.newInstance();
            DocumentBuilder builder = factory.newDocumentBuilder();
            doc = builder.parse(new File("/sdcard/example.xml"));

        } catch (Exception e) {
            e.printStackTrace(); //TO-DO: exception handling
        }

        NodeList nodes = doc.getChildNodes();
        String[] nodeList = new String[nodes.getLength()];

        for(int i = 0; i<nodes.getLength(); i++) {
            Node node = nodes.item(i);
            nodeList[i] = nodes.item(i).getNodeName();
        }

        this.setListAdapter(new ArrayAdapter<String>(this, 
                R.layout.list_item, 
                R.id.label, nodeList));

        ListView lv = getListView();

        lv.setOnItemClickListener(new OnItemClickListener() {
            public void onItemClick(AdapterView<?> parent, View view, 
                        int position, long id) {

                String nodeName = ((TextView) view).getText().toString();

                Intent i = new Intent(getApplicationContext(), 
                                JAXPNodeListActivity.class);

                i.putExtra("nodeName", nodeName);
                startActivity(i);
            }
        });
    }
} 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-12-09T01:39:29.000

您可以简单地使用 Singleton 类。喜欢：

```
public class DomObjectManager{

private static DomObjectManager INSTANCE;
private  Document doc;

public static DomObjectManager getInstance(){

if(INSTANCE==null){
INSTANCE = new DomObjectManager();
}
return INSTANCE;
}
private DomObjectManager(){
}
//set the shared document;
public void setDocument(Document doc){
this.doc = doc;
}
public void getDocument(){
retunr doc;
}
//call to destroy before when you do not need the singleton any more.
public void destroy(){
INSTANCE == null;
}

} 
```

# java - 如何使用 Java ExecutorService 线程池进行持续/无限任务？

> ID：13783531
> 
> 赞同：4
> 
> 时间：2012-12-09T00:44:43.383
> 
> 标签：java, concurrency

Java ExecutorService 框架允许您使用托管线程池委派要执行的多个任务，以便可以一次执行 N 个任务，直到完成 X 个任务。

我的问题是......如果 N 是一个无限大的数字，以至于最初分配/分配/定义不切实际怎么办。

您如何利用 Java (ExecutorService) 中的线程池概念来处理比您可以合理提交的任务更多的任务，而不会耗尽资源。

出于此答案的目的，假设每个任务都是独立的，不依赖于任何其他任务，并且任务可以按任意顺序完成。

我最初尝试解决这个问题涉及一次提供 ExecutorService Y 个线程，但我很快意识到没有明显的方法可以判断特定任务何时完成，因此无法提交要执行的新任务。

我知道我可以编写自己的“ExecutorService”，但我正在尝试利用 Java 框架已经提供的丰富功能。我通常属于“不要重新发明轮子”类别，因为比我更聪明的人已经为我进行了投资。

提前感谢任何可以提供有关如何解决此类问题的任何见解的人。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-09T01:11:29.943

你可以使用 a`CompletionService`来做到这一点。您可以有一个线程为服务提供一堆任务，然后在任务完成时添加新任务。

一个简单的例子：

```
final CompletionService service = new ExecutorCompletionService(Executors.newFixedThreadPool(5));
Runnable taskGenerator = new Runnable() {
    public void run() {
        // Seed the service
        for (int i = 0; i < 100; ++i) {
            service.submit(createNewTask());
        }
        // As tasks complete create new ones
        while (true) {
            Future<Something> result = service.take();
            processResult(result.get());
            service.submit(createNewTask());
        }
    }
};
new Thread(taskGenerator).start(); 
```

这使用一个`ThreadPoolExecutor`带有 5 个线程来处理任务和一个手动生产者/消费者线程来生成任务和处理结果。

显然，您需要比 更智能的东西`while (true)`，您需要对 and 进行合理的实现`processResult`，`createNewTask`并且假设任务执行比生成它们或处理结果要慢得多。

希望这会让你走上正轨。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-09T02:25:18.730

使用 java.util.concurrent.ThreadPoolExecutor 和 java.util.concurrent.ArrayBlockingQueue 作为它的 workQueue。这种方式尝试放置比队列大小更多的任务会阻塞。

```
 BlockingQueue<Runnable> workQueue=new ArrayBlockingQueue<Runnable>(100);
  ThreadPoolExecutor tpe=new ThreadPoolExecutor(5, 10, 60, TimeUnit.SECONDS, workQueue);

  while (true) {
     tpe.execute(createNewTask());
  } 
```

# assembly - lea 指令如何获取操作数的地址？

> ID：13783539
> 
> 赞同：3
> 
> 时间：2012-12-09T00:46:12.803
> 
> 标签：assembly, x86

这究竟是如何工作的？我知道 lea 与使用 add/mov 指令相比效率更高，因为它不通过 ALU 或设置任何标志。那么 lea 如何获取它的地址呢？是什么让它比 add/mov 更好？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-09T14:15:00.533

`lea`不通过 ALU的想法已经过时，并且十多年来一直是错误的。它通过其中一个 ALU - 其中会有几个，这极不可能成为瓶颈。这实际上需要时间。它并不比`add`.

但这并不意味着它没有用。与 不同`add`，它可以有一个不同于两个输入的目的地，因此它可以保存 a `mov`，并且它可以采用一个额外的常量，因此您可以将两个`add`s 和 a`mov`合二为一。缩放也很好，所有结合起来你都可以做一些像`a = b * 9 + 5`all in one一样的事情`lea a, [b + b * 8 + 5]`。这种“复杂”的形式`lea`通常比简单的 2 操作数形式要慢`lea`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-09T00:48:17.987

LEA 指令使用 CPU 的有效地址 (EA) 部分来执行某些类型的算术而不使用 ALU。EA 模块可以执行用于地址计算的非常特定类型的算术，但如果您需要的是它专门提供的东西之一，也可以用于其他事情。

通过不使用 ALU 进行 EA 计算，ALU 可以同时忙于做其他事情，您可以避免流水线停顿。

# android - 如何更新我的通知以显示我的时间计数器发生变化？

> ID：13783540
> 
> 赞同：4
> 
> 时间：2012-12-09T00:46:30.067
> 
> 标签：android, android-intent, android-service, android-3.0-honeycomb, android-notifications

我几乎完成了我正在制作的这个玩具应用游戏。

**问题：** 我的通知总是显示我的计数器为 30000。为什么它没有计时？

**我所做的：** 我实现了一个简单的服务类和一个自定义计时器来计时。最终，一旦我确定计时器正在工作，我将退出整个游戏。

这是我的代码：

```
package com.example.redshirtmarblez;

import android.app.Activity;
import android.app.Notification;
import android.app.NotificationManager;
import android.app.PendingIntent;
import android.app.Service;
import android.content.Context;
import android.content.Intent;
import android.os.CountDownTimer;
import android.os.IBinder;
import android.widget.Toast;

public class TimingService extends Service{

    public long counter = 30000;
    private Context ctx;
    private Activity localActivity;

    private NotificationManager nm;

    @Override
    public IBinder onBind(Intent intent) {
        // TODO Auto-generated method stub
        return null;
    }

    @Override
    public void onCreate() 
    {
          super.onCreate();
          nm = (NotificationManager)getSystemService(NOTIFICATION_SERVICE);
          declareNotification();
          timer.start();
          //Toast.makeText(this, "Timer is :" + counter, Toast.LENGTH_LONG).show();
          //showNotification();
    }

    public void getActivity(Activity activity)
    {
        localActivity = activity;
    }

    //count to end the game
    public CountDownTimer timer = new CountDownTimer(30000, 1000){

        public void onTick(long millisUntilFinished){
            counter = millisUntilFinished / 1000;
        }

        public void onFinish(){
             counter = 0;

 //Kill the game 
             int i = android.os.Process.myPid();
             android.os.Process.killProcess(i);

        }

    };

    /*
     * Show a notification while this service is running 
     */
    public void declareNotification()
    {
        //Declare a new notification 
        Notification notification = new Notification(R.drawable.ic_launcher, "A New Notification", System.currentTimeMillis());

        notification.flags |= Notification.FLAG_ONGOING_EVENT;
        notification.flags |= Notification.FLAG_FOREGROUND_SERVICE;

        Intent intent = new Intent(this, TimingService.class);
        PendingIntent activity = PendingIntent.getActivity(this, 0, intent, 0);
        notification.setLatestEventInfo(this, "herp", "counter: " + counter, activity);

  //This is clearly not 1337, but a good joke
            startForeground(1337, notification);

    }

} 
```

当它运行时，所有这一切都是显示“新通知”，然后更改为“herp 计数器：30000”。但是，此通知永远不会改变。它只是保持 30000。为什么？我以为我通过使标志持续存在来解决这个问题？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2016-07-06T22:37:45.247

[https://developer.android.com/reference/android/app/Notification.Builder.html#setUsesChronometer(boolean)](https://developer.android.com/reference/android/app/Notification.Builder.html#setUsesChronometer(boolean))

> 将 when 字段显示为秒表。通知将自动更新显示从何时开始的分钟和秒，而不是将时间显示为时间戳。在显示经过的时间（如正在进行的电话）时很有用。当使用 setChronometerCountDown(boolean) 时，计数器也可以设置为倒计时。

无需更新，不值一`setWhen()`提

```
NotificationCompat.Builder notification = new NotificationCompat.Builder(context)
        .setSmallIcon(R.mipmap.ic_default_notification)
        .setTicker("Ticker Text")  
        .setWhen(when)  // the time stamp, you will probably use System.currentTimeMillis() for most scenarios
        .setUsesChronometer(true)
        .setContentTitle("Title Text")
        .setContentText("Content Text"); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-09T00:56:51.570

`counter`不是参考；除非您明确告知通知，否则通知不会更新其新值。

查看[有关更新现有通知的文档](http://developer.android.com/guide/topics/ui/notifiers/notifications.html#Updating)。您的 ID 在`1337`这里，因此您可以使用它来更新它。

实际上，您可能只能`declareNotification()`从您的`onTick()`方法中再次调用......但是，如果这不起作用，我建议保留对[`Notification`](http://developer.android.com/reference/android/app/Notification.html)对象的引用（作为成员变量），然后更新它，并使用[`nm.notify(1337, /* your notification object */);`](http://developer.android.com/reference/android/app/NotificationManager.html#notify%28int,%20android.app.Notification%29).

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-09T01:15:45.853

我不知道你为什么要使用通知。但是您需要不断更新您的通知。对于一个简单的修复添加

```
declareNotification(); 
```

在这条线下面：

```
counter = millisUntilFinished / 1000; 
```

请注意，这不是编写代码的好方法。确实，您应该传递一种仅更新通知而不是“创建”新通知的方法。但是，只要它们具有相同的 ID，就会替换另一个。也只是为了使用更新的方式来管理通知，使用

```
NotificationCompat.builder b = new NotificationCompat.Builder(context); 
```

# node-webkit - 在 node-webkit 中获取当前应用程序的路径

> ID：13783542
> 
> 赞同：8
> 
> 时间：2012-12-09T00:46:57.467
> 
> 标签：node-webkit

在 node-webkit 中，有没有办法找到当前应用程序的路径？在 node.js 中，您可以使用`__dirname`查找当前应用程序的路径，但在 node-webkit 中，该变量`__dirname`似乎未定义。

以下 node.js 脚本正确打印文件路径：

`console.log(__dirname)`

以下 node-webkit 脚本未正确打印文件路径：

```
<script type = "text/javascript">
    alert(__dirname);
</script> 
```

在 node-webkit 中找到当前应用程序路径的正确方法是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2015-03-20T15:25:09.630

接受的答案的链接不再可用，所以这里是一个简短的答案：

每次运行时，nw.js 都会将应用程序的内容提取到临时目录。

如果要访问 nw.js 提取应用程序的路径，请使用`process.cwd()`

在其他原因中，如果您想访问可执行应用程序的路径，请使用：

```
var path = require('path');
var nwDir = path.dirname(process.execPath); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-10T01:58:09.917

此处讨论了此问题的答案：[https ://groups.google.com/d/topic/node-webkit/IwGzluFC9iU/discussion](https://groups.google.com/d/topic/node-webkit/IwGzluFC9iU/discussion)

> 在 Windows 上，使用“process.execPath”查看启动它的可执行文件的路径。然后从那里开始工作，从路径中删除可执行文件的文件名以获取文件夹的路径（假设您的应用程序的 .nw 是相对于可执行文件或与之组合的）。
> 
> 无论是使用压缩的“app.nw”还是“nw.exe”和“app.nw”组合成一个可执行文件（app.exe），这对我都有效。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-02-27T20:19:25.973

如果您正在寻找 App 源的路径（即包含 的文件夹`package.json`），那么您可以使用`process.cwd()`.

无论启动节点可执行文件时环境的真正工作目录是什么，它都会设置`process.cwd()`为 App 源的位置。如果应用程序包含在存档中，cwd 将指向提取源的**临时文件夹。**

重要的是，请注意`process.cwd()`在应用程序运行期间`process.chdir(newPath)`可能会被其他事件更改，因此您可能希望在应用程序启动时存储初始值。

**编辑：** 为了澄清，`process.cwd()`设置为包含`package.json`正在运行的应用程序使用的实际文件的文件夹。因此，如果您已将应用程序打包为存档或可执行文件（zip、exe、nwz、nw 等），则 nw.exe 将在运行应用程序之前将项目文件解**压缩**到临时目录。因此`process.cwd()`将指向该临时文件夹，**而不是**原始存档或可执行文件的位置。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-09-20T08:01:23.437

这应该工作：

```
var nw = require('nw.gui'); //This line is only required for NW.js 0.12.x and below

console.log(nw.__dirname) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-10-18T07:55:14.803

如果您加载了外部 uri，window.location 将不起作用，但无论如何，以下内容似乎都是可靠的：

```
var path = require('path');
,appPath = path.dirname(require.main.filename) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-07-21T20:57:24.417

不确定何时添加，但我相信现在获得启动路径的官方方法是：

```
nw.App.startPath 
```

# core-plot - CorePlot 使用 Rubymotion

> ID：13783550
> 
> 赞同：2
> 
> 时间：2012-12-09T00:48:08.977
> 
> 标签：core-plot, rubymotion

我正在使用 ruby​​motion 玩 CorePlot。

谁能帮我把这个客观的 c 方法调用翻译成 ruby​​motion 语法？

```
overlayGradient = [overlayGradient addColorStop:[[CPTColor blackColor] colorWithAlphaComponent:0.0] atPosition:0.9]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T23:08:38.237

这是RubyMotion语法：

```
overlayGradient = overlayGradient.addColorStop(CPTColor.blackColor.colorWithAlphaComponent(0.0), atPosition:0.9) 
```

# url - 批处理 - 是否可以创建一个批处理文件来检查网站/网址是否重定向到另一个网站

> ID：13783555
> 
> 赞同：1
> 
> 时间：2012-12-09T00:48:54.483
> 
> 标签：url, redirect, batch-file

是否可以创建一个批处理文件来检查网站/网址是否重定向到另一个网站？

例如检查[http://www.google.com/](http://www.google.com/)是否重定向到[http://www.google.com/randomsite.php/](http://www.google.com/randomsite.php/)如果它可以做如下状态我会很棒：

```
www.google.dk/ Redirects to www.google.dk/randomsite.php/ 
```

例如使用 echo 和一些变量，例如：

```
echo %Google1% Redirects to %Google2% 
```

那看起来像这样

```
www.google.dk/ Redirects to www.google.dk/randomsite.php/ 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T01:30:53.783

Windows 中没有内置工具，但如果您下载与[Windows 兼容的 curl 版本](http://curl.haxx.se/download.html)，则可以使用它来打印标题。这篇[博客文章](http://beerpla.net/2010/06/10/how-to-display-just-the-http-response-code-in-cli-curl/)似乎是一个不错的起点。

例如：

```
curl -sL http://www.stackoverflow.com --head | find "301" OR
curl -sL http://www.stackoverflow.com --head | find "302" 
```

如果找到，%ERRORLEVEL% 变量将大于 0，因此您可以检查。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-09T01:32:29.907

在 Linux 下，`curl -I http://yoururl.com`. 你只需要第一行，所以也许从`curl -I http://yoururl.com | head -n 1`

# php - PHP，AJAX 从 HTML 选择中自动填充输入字段？

> ID：13783559
> 
> 赞同：4
> 
> 时间：2012-12-09T00:49:49.597
> 
> 标签：php, javascript, ajax

我一直在尝试根据在 html 下拉菜单上选择的初始文本找出从数据库中提取信息的正确方法。

这是我的代码：

```
<html>
<head>
</head>
<script src="testjs.js"></script>
<?php
    $host = "";
    $username = ""; 
    $password = "";
    $database = "";
    mysql_connect($host, $username, $password);
    mysql_select_db($database);
?>
<body>

<form>
<select name="users" onchange="showUser(this.value)">
<option value="">Select a person:</option>
<?php
    $Query = mysql_query("SELECT * FROM population");
    while ($Rows = mysql_fetch_array($Query))
    {
        $ID = $Rows['ID'];
        $Pop = $Rows['Pop'];
        $UniqueID = $Rows['uid'];
        echo "<option value=\"$UniqueID\">$Pop</option>";
    }
?>
</select>
</form>
<br>
<p>DB ID <input type="text" id="ids" name="ID" ></p>
<p>Population <input type="text" id="content" name="contet" ></p>
<p>Unique ID <input type="text" id="uid" name="uid" ></p>
<div id="GetInformation"><b>Person info will be listed here.</b></div>

</body>
</html> 
```

test.js 包含：

```
function showUser(str)
{
if (str=="")
  {
  document.getElementById("GetInformation").innerHTML="";
  return;
  }
if (window.XMLHttpRequest)
  {// code for IE7+, Firefox, Chrome, Opera, Safari
  xmlhttp=new XMLHttpRequest();
  }
else
  {// code for IE6, IE5
  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
  }
xmlhttp.onreadystatechange=function()
  {
  if (xmlhttp.readyState==4 && xmlhttp.status==200)
    {
    document.getElementById("GetInformation").innerHTML=xmlhttp.responseText;
    }
  }
xmlhttp.open("GET","getuser.php?q="+str,true);
xmlhttp.send();
} 
```

获取用户包含：

```
<?php
$q=$_GET["q"];

$con = mysql_connect('', '', '');
if (!$con)
  {
  die('Could not connect: ' . mysql_error());
  }

mysql_select_db("DropDown", $con);

$sql="SELECT * FROM population WHERE uid = '".$q."'";

$result = mysql_query($sql);

while($row = mysql_fetch_array($result))
  {
    $ID = $row['ID'];
    $Pop = $row['Pop'];
    $UID = $row['uid'];
?>
<script type="text/javascript">
var ids = '<?php echo json_encode($ID); ?>';
var content = '<?php echo json_encode($Pop); ?>';
var uid = '<?php echo json_encode($UID); ?>';
</script>
 <?php }
mysql_close($con);
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T08:46:00.887

尝试改变

```
while($row = mysql_fetch_array($result))
  {
    $ID = $row['ID'];
    $Pop = $row['Pop'];
    $UID = $row['uid'];
?>
<script type="text/javascript">
var ids = '<?php echo json_encode($ID); ?>';
var content = '<?php echo json_encode($Pop); ?>';
var uid = '<?php echo json_encode($UID); ?>';
</script>
 <?php } 
```

至

```
while($row = mysql_fetch_array($result))
{
    $ID = $row['ID'];
    $Pop = $row['Pop'];
    $UID = $row['uid'];
    echo $ID . ' - ' . $Pop . ' - ' . $UID;
} 
```

* * *

这应该有效。但是有更好的方法，因为它们稍后会在您的客户端为您提供更多访问权限。例如发回一个 JSON 对象，一个简单的例子是：

```
$info = array();
while($row = mysql_fetch_array($result))
{
    $ID = $row['ID'];
    $Pop = $row['Pop'];
    $UID = $row['uid'];

    $info[] = array( 'id' => $ID, 'pop' => $Pop, 'uid' => $UID );
}
echo json_encode($info); 
```

你的JS会是这样的：

```
if (xmlhttp.readyState==4 && xmlhttp.status==200)
{
    var data = JSON.parse(xmlhttp.responseText);
    for(var i=0;i<data.length;i++) 
    {
      document.getElementById("GetInformation").innerHTML += data[i].id + ' - ' + data[i].pop + ' - ' + data[i].uid;
    }
} 
```

**注意：**如果您使用的浏览器不包含 JSON 库，则需要加载[http://www.json.org/js.html](http://www.json.org/js.html)。如果您想使用 jQuery，您的 AJAX/DOM 更改也会变得更加简单

# python - PyQt4 对象不显示

> ID：13783560
> 
> 赞同：0
> 
> 时间：2012-12-09T00:49:51.683
> 
> 标签：python, pyqt, tabwidget

我正在 PyQt4 中开发一个编辑配置文件的工具。每次加载文件时它都会更改 GUI。编辑器 GUI 是一个 QTabWidget，包含与加载文件中的章节数一样多的选项卡。在每个选项卡上，它都有对应于加载文件中的小节的 QGroupBoxes，最后这些组包含对应于实际配置参数和值的 QLineEdits。

所有这些都是从一个大字典建立起来的，并且在一定程度上可以正常工作：

*   所有选项卡都正确显示
*   所有组在所有选项卡中正确显示
*   **但是**LineEdits 仅显示在第一个选项卡的第一组中

LineEdit 对象也是为其他组创建的，我打印了它们，它们都指向不同的内存位置 - 但它们仍然没有显示。

这是代码的相应部分：

```
while self.tabWidget.widget(0):
    self.tabWidget.removeTab(0)
for i in data['tabList']:
    self.log("Adding tab: '%s'" % i, DEBUG)
    self.data['tabDict'][i]['scrollarea'] = QScrollArea()
    self.data['tabDict'][i]['vbox'] = QVBoxLayout()
    for j in self.data['tabDict'][i]['groupList']:
        self.log("Adding group: '%s'" % j, DEBUG)
        self.data['tabDict'][i]['groupDict'][j]['groupbox'] = QGroupBox(j)
        self.data['tabDict'][i]['groupDict'][j]['formlo'] = QFormLayout()
        print self.data['tabDict'][i]['groupDict'][j]['formlo']
        for k in self.data['tabDict'][i]['groupDict'][j]['fields']:
            self.log("Adding field: '%s'" % k['name'])
            k['lineedit']  = QLineEdit(k['value'])
            k['lineedit'].setToolTip('<b>Type:</b> %s<br><b>TSDB path:</b> %s<br><b>Line:</b> %d<br><b>Comment:</b> %s' % (k['type'],k['path'],k['row'], k['comment']))
            self.data['tabDict'][i]['groupDict'][j]['formlo'].addRow(k['name'], k['lineedit'])
        self.data['tabDict'][i]['groupDict'][j]['groupbox'].setLayout(self.data['tabDict'][i]['groupDict'][j]['formlo'])
        self.data['tabDict'][i]['vbox'].addWidget(self.data['tabDict'][i]['groupDict'][j]['groupbox'])
    self.data['tabDict'][i]['scrollarea'].setLayout(self.data['tabDict'][i]['vbox'])
    self.tabWidget.addTab(self.data['tabDict'][i]['scrollarea'], i) 
```

我在这里想念什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T01:39:33.797

感谢freenode上#pyqt上的人，我在另一个频道上得到了答案。问题是`QScrollArea`需要一个`QWidget`set by `setWidget()`，并且应该包含`QVBoxLayout`.

这是固定代码：

```
 while self.tabWidget.widget(0):
        self.tabWidget.removeTab(0)
    for i in data['tabList']:
        self.log("Adding tab: '%s'" % i, DEBUG)
        self.data['tabDict'][i]['scrollarea'] = QScrollArea()
        self.data['tabDict'][i]['scrollarea'].setWidgetResizable(True)
        self.data['tabDict'][i]['widget'] = QWidget()
        self.data['tabDict'][i]['vbox'] = QVBoxLayout()
        for j in self.data['tabDict'][i]['groupList']:
            self.log("Adding group: '%s'" % j, DEBUG)
            self.data['tabDict'][i]['groupDict'][j]['groupbox'] = QGroupBox(j)
            self.data['tabDict'][i]['groupDict'][j]['formlo'] = QFormLayout()
            print self.data['tabDict'][i]['groupDict'][j]['formlo']
            for k in self.data['tabDict'][i]['groupDict'][j]['fields']:
                self.log("Adding field: '%s'" % k['name'])
                k['lineedit']  = QLineEdit(k['value'])
                k['lineedit'].setToolTip('<b>Type:</b> %s<br><b>TSDB path:</b> %s<br><b>Line:</b> %d<br><b>Comment:</b> %s' % (k['type'],k['path'],k['row'], k['comment']))
                self.data['tabDict'][i]['groupDict'][j]['formlo'].addRow(k['name'], k['lineedit'])
            self.data['tabDict'][i]['groupDict'][j]['groupbox'].setLayout(self.data['tabDict'][i]['groupDict'][j]['formlo'])
            self.data['tabDict'][i]['vbox'].addWidget(self.data['tabDict'][i]['groupDict'][j]['groupbox'])
        self.data['tabDict'][i]['widget'].setLayout(self.data['tabDict'][i]['vbox'])
        self.data['tabDict'][i]['scrollarea'].setWidget(self.data['tabDict'][i]['widget'])
        self.tabWidget.addTab(self.data['tabDict'][i]['scrollarea'], i) 
```

这仍然是一个悬而未决的问题，尽管是什么导致了第一个代码的奇怪行为。:)

# mysql - 在 mySql 中也有 group_concat 的计算字段上排序

> ID：13783562
> 
> 赞同：2
> 
> 时间：2012-12-09T00:50:19.223
> 
> 标签：mysql, database, sql-order-by, group-concat

这是我想要完成的简化版本。假设我有一个人表和一个测试表。每个测试都有 2 个与之相关的分数，每个人可以有 0,1 或多个测试

人
- PersonId（PK）
- PersonName

测试
- testId (PK)
- PersonId (FK)
- test1Score
- test2Score

我试图得到一个结果集，它给我一个排序的人员列表和平均 testScores。这就是我正在做的

```
SELECT GROUP_CONCAT( CASE  
    WHEN( tests.test1Score > 0 )   
    THEN( ( tests.test1Score + tests.test2Score)/2 )  
    ELSE( 99999999 ) END) as averageScore, person.PersonName  
FROM person  
JOIN tests  
    ON person.personId = tests.personId   
GROUP BY person.personId   
ORDER BY averageScore 
```

发生的事情是 group_concat 返回一个字符串并按我的顺序执行结果是这样的

人名1 | 5,6
人名2 | 51,60
人姓名3 | 6、60

我知道我必须先按单个计算字段排序，然后按 group_concatenated 值排序，但不知道该怎么做。

任何帮助，将不胜感激

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T05:34:10.810

您可以使用聚合子查询来执行此操作，并在您喜欢的任何字段上进行分组，而不是在连接的字符串上。使用您的字段的示例：

```
SELECT person.personID, person.personName, p.AvgOftest1score, p.AvgOftest2score
FROM person
INNER JOIN
(
SELECT personID, Avg(test1score) AS AvgOftest1score, Avg(test2score) AS AvgOftest2score
FROM tests
GROUP BY personID
) p
ON person.personID = p.personID
ORDER BY p.AvgOftest1score, p.AvgOftest2score; 
```

# java - 我对从哪里开始使用这种方法感到困惑？

> ID：13783563
> 
> 赞同：-4
> 
> 时间：2012-12-09T00:50:20.190
> 
> 标签：java, drjava

我的 explore 方法有问题（）我必须创建一个高度是高度最大值的图片，宽度是存储图片宽度的总和。相册中的图片应该被复制到目前为止被复制进入一张新图片，并通过调用其上的 explore() 方法显示该图片。这就是我所拥有的：

```
public boolean addPicture( Picture thePicture, int where )
{
int index = nPictsInAlbum;
pictArray[index] = pictArray[index-1];

while( index > where )
{
pictArray[where] = thePicture;
nPictsInAlbum ++;
}
return true;
}

public void explore()
{    
int maxHeight = 0;  //max height for the picture
int value = 0;
int biggest = 0;

for(int i = 0; i < pictArray.length; i++)
{
nPictsInAlbum = pictArray[i];
if(value > maxHeight)
{
biggest = value;
maxHeight = i;
}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T01:08:52.627

*我假设**最大**的变量是保持总宽度的变量。*

你的代码做错了一些事情，你必须先修复这些

1.  您正在为不同类型的变量多次重复使用 nPictsInAlbum。你不应该那样做。我不是 Java 程序员，但它至少在其他语言中是一种不好的做法，因为它会引起混淆。您在方法中使用该变量`addPicture`来跟踪最新索引。但是在该`explore`方法中，您使用它来临时存储您正在访问的单个图片。

2.  在该`explore`方法中，您没有访问图片对象的属性\字段。在不知道图片对象具有哪些属性\字段的情况下，我们无法完全更正您的代码。

如果您解决了这两个问题，那么您在该`explore`方法中遇到的逻辑错误是

1.  （假设变量`biggest`是总宽度，如果是这样，您应该将其重命名为更具描述性）当您发现当前图片的高度大于之前存储的高度时，您才设置总宽度图片。无论如何，当您循环每张图片时，您都需要设置总宽度。

2.  当您设置图片的总宽度时，您是在替换总宽度，而不是添加它。在您的示例`biggest = value`中不会添加它。你会想`biggest = biggest + value`这样做

* * *

您要确保在制定方法时花点时间。巧妙地考虑它要做什么，你需要什么变量，你将访问哪些其他变量，以及你将如何处理它们。例如，如果`explore`要确定最大高度和总宽度，您会这样想：

1.  我需要一段可重用的代码来确定所有图片的最大高度。它还将获得所有图片的总宽度。
2.  因此我需要两个变量：maxHeight 和 totalWidth。
3.  从这段代码中，我需要遍历一组图片。
4.  在那个循环中，我需要检查图片的高度是否大于 maxHeight。如果是这样，我需要将 maxHeight 设置为图片的高度
5.  要访问图片的高度，我需要使用（我不知道图片的对象结构是什么，所以我猜）picture.height 属性。
6.  无论图片的高度如何，我都需要将图片的宽度添加到运行总数中。所以我会用`totalWidth = totalWidth + picture.width`

希望这可以帮助您清理代码并更好地工作。

# facebook-javascript-sdk - Facebook JavaScript SDK：返回所有查询后运行某些东西

> ID：13783565
> 
> 赞同：1
> 
> 时间：2012-12-09T00:50:52.483
> 
> 标签：facebook-javascript-sdk

我正在尝试使用 Facebook JavaScript API 计算朋友的性别。**问题是 FB SDK 基于异步调用，所以在完成所有查询后**我无法触发操作。

例如，这是计算我有多少男性/女性朋友的代码。但是最后一行不起作用，因为它可以在 FB.api() 仍在运行时执行。

处理这个问题的最佳方法是什么？

```
FB.api('/me/friends', function(response) {
    if(response.data) {
        var genderCount = {};

        $.each(response.data, function(index, friend) {
            FB.api('/' + friend.id, function(frienddata) {
                if (frienddata.gender) {
                    if (genderCount[frienddata.gender]) {
                        genderCount[frienddata.gender]++;
                    }
                    else {
                        genderCount[frienddata.gender]=1;
                    }
                }
            });
        });
});

// later do something with genderCount

alert('I have ' + genderCount['male'] + ' male friends'); // won't work 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T01:14:14.103

```
FB.api('/me/friends', function(response)
{
if(response.data) 
{
    var genderCount = {};
    var i = 0;
    function GetGender(friend_id)
    {
        FB.api('/' + friend_id, function(frienddata) 
        {
            if (frienddata.gender) 
            {
                if (genderCount[frienddata.gender]) 
                {
                    genderCount[frienddata.gender]++;
                }
                else 
                {
                    genderCount[frienddata.gender]=1;
                }
            }

            if(i == response.data.length - 1)
            {
                Results(genderCount);
            }
            else
            {
                GetGender(response.data[++i].id);
            }
        });
    }

    GetGender(response.data[i].id);
}
});

function Results(genderCount)
{
// here you are after all the calls
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-09T04:01:49.807

首先，您可能希望使用更高效的`fql`查询，例如

```
SELECT name, sex, uid 
FROM user 
WHERE uid in (
  SELECT uid2 
  FROM friend 
  WHERE uid1 = me()
) 
```

只需将其传递给`graph.facebook.com/fql?q=SELECT%20%name....`

然后，在完成对数字求和后，将警报移动到响应处理程序中。

```
FB.api('/fql', 
  {q: "SELECT name, sex, uid FROM user WHERE uid in (SELECT uid2 FROM friend WHERE uid1 = me())"}, 
  function (response) {
    if (response.data) {
        var genderCount = {
            male: 0,
            female: 0,
            unknown: 0
        };
        response.data.forEach(function (row) {
            genderCount[row.sex || 'unknown']++;
        });
        alert(JSON.stringify(genderCount));
    }
}); 
```

# c# - 让表格出现在一切之上

> ID：13783570
> 
> 赞同：2
> 
> 时间：2012-12-09T00:51:28.383
> 
> 标签：c#, winforms

我正在为 Windows 8 开发一个替代的开始菜单，我已经尝试过：

```
this.TopMost = true; 
```

但它似乎只在表单失去焦点之前有效。是否有一种简单的方法可以使“开始按钮”永久显示在任务栏上方？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-09T00:53:32.863

[Raymond Chen在他的博客上](http://blogs.msdn.com/b/oldnewthing/archive/2011/03/10/10138969.aspx)谈到了顶层窗口的问题。我建议检查一下。

# f# - 定义 F# 计算表达式时，零成员的用途是什么？

> ID：13783577
> 
> 赞同：1
> 
> 时间：2012-12-09T00:52:23.663
> 
> 标签：f#, computation-expression

我正在尝试学习 F# 计算表达式。一般来说，零会员的目的是什么？

它对序列的定义是什么？

它对异步工作流的定义是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-09T01:17:32.727

`Zero`例如，当您在表达式中省略`else`分支时使用该成员：`if`

```
comp { if b then return 1
       return 2 } 
```

...将被翻译成这样的东西：

```
comp.Combine
  ( if b then comp.Return(1) else comp.Zero(),
    comp.Return(2) ) 
```

它是如何为标准计算类型定义的？

*   对于异步工作流，它被定义为立即返回一个单位值的异步工作流——本质上相当于写：`async { return () }`.

*   对于序列（您使用`yield`而不是`return`），该`Zero`成员返回一个不返回任何内容的序列，对应于标准`Seq.empty`值。

如果你想了解更多的理论背景，那么你可以[查看这篇论文](http://www.cl.cam.ac.uk/~tp322/drafts/notations.pdf)。用更理论的术语来说，它`Zero`要么是`return ()`（当计算是单子时），要么是幺半群的单位（当计算是幺半群时），这就是 Haskellers 所说`mzero`的。

# android - 安卓编译

> ID：13783578
> 
> 赞同：-7
> 
> 时间：2012-12-09T00:52:27.160
> 
> 标签：android

我有galaxy s1，我想将它用作测试平台，可以从google 获取任何版本的android 并编译并安装它吗？

我会对某些驱动程序有问题吗？

如果有人可以与我分享有助于编译和安装的任何内容，我将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-09T00:58:34.410

这是不可能的。但是，您可以尝试自定义 ROM，例如来自 XDA 开发人员的。

# c++ - Collat z 动态算法

> ID：13783581
> 
> 赞同：0
> 
> 时间：2012-12-09T00:53:06.420
> 
> 标签：c++, c, algorithm

我正在尝试做一个动态 Collat​​z 算法，但似乎有超过至少 626331 或更大的错误答案。所有其他人似乎都是正确的。我已经为此工作了几个小时，但无法弄清楚我的问题是什么。谁能给我一个帮助的建议。谢谢

```
int DynamicCollatz::DynCollatzConjecture(__int64 n) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-09T01:22:12.230

Collat​​z 算法为值 626331 生成的最大值为：

```
o = 626331 m = 7222283188 c = 508 
```

这个数字远远大于 32-bit (unsigned) 的大小`int`。（这`c`是达到 1 的步数。）

我使用了这个`bc`脚本（我已经把它藏起来了，因为 Collat​​z 算法大多数年都会出现）来推断该信息：

```
define collatz(n) {
    if (n<=0) halt;
    m=n;o=n;c=0;
    while(n>1){
        if(n%2)n=n*3+1 else n/=2; c=c+1;
        if(n>m)m=n;
    }
    print "o = ",o," m = ",m," c = ",c,"\n";
}

collatz(626331) 
```

# python - 在 python 2.7 中使 python 脚本可执行

> ID：13783586
> 
> 赞同：5
> 
> 时间：2012-12-09T00:53:37.640
> 
> 标签：python, executable

我们正在尝试让我们的 python 脚本作为 .exe 文件自行执行，而无需安装 python。就像我们把我们的程序给别人一样，他们不需要安装 python 来打开它。

它是一个像 zork 这样的基于文本的游戏，所以我们需要一个 gui，比如 cmd，来运行它。

我们尝试过使用 py2exe 和 pyinstaller，但它们都没有任何意义，并且由于某种原因不适用于 2.7.3。

有什么帮助吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2016-07-22T13:53:16.193

*假设您已经安装了 pip，在文件夹Scripts*中安装 Python 后应该安装它。使用 pip 安装 PyInstaller，在命令提示符下键入以下内容。

*   点安装 pyinstaller

安装 PyInstaller 后，找到你的 pyinstaller 文件所在的位置（*它们应该是你的 pip 文件在 Scripts 文件夹中的位置*），然后转到命令提示符并键入以下内容。

*   c:\python27\Scripts> **pyinstaller --onefile c:\yourscript.py**

*上面的命令将在Scripts*文件夹中创建一个名为“dist”的文件夹，这将包含您的单个可执行文件“yourscript.exe”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-09T00:58:49.840

可以随时尝试[http://cx-freeze.sourceforge.net](http://cx-freeze.sourceforge.net)，适用于所有版本的 python，包括 3.3。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-09T00:59:19.357

查看这个关于部署 Python 应用程序的 wiki：

[http://wiki.python.org/moin/deployment](http://wiki.python.org/moin/deployment)

除了已经提到的内容之外，它还具有指向 Movable Python、Python-Packager 等的链接。

* * *

## 回答 #4

> 赞同：-4
> 
> 时间：2013-01-30T09:48:12.180

[下载这个，应该适用于 python 2.7.3](http://tenet.dl.sourceforge.net/project/py2exe/py2exe/0.6.9/py2exe-0.6.9.win32-py2.7.exe)

# typo3 - 如何使用打字稿将空的跨度标签放在锚标签内

> ID：13783587
> 
> 赞同：2
> 
> 时间：2012-12-09T00:53:41.683
> 
> 标签：typo3, typoscript

大家好，我有一个打字稿菜单，我希望生成的 HTML 看起来像这样

```
<a href=" ">Text<span></span></a> 
```

我能够将文本包装在跨度标签内，但我找不到在文本右侧放置一个空跨度标签的方法。有人有想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-10T00:38:41.647

故意放置空标签很奇怪，但是你去：

`HMENU.TMENU.TMENUITEM.stdWrap.wrap = |<span></span>`

作为参考，以下是可用于菜单的包装列表：

```
<wrapItemAndSub>
 <allWrap>
 <allStdWrap>
 <before>
 <beforeImg beforeImgTagParams>
 <linkWrap>
  <A href=… ATagParams TITLE=ATagTitle>
   <stdWrap.wrap> TMENUITEM </stdWrap.wrap>
  </A>
 </linkWrap>
 <after>
 </allStdWrap>
 </allWrap>
  UNTERMENU 1
  UNTERMENU 2
</wrapItemAndSub> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-05-06T11:48:06.947

这是另一种方式，使用`linkWrap`and `ATagBeforeWrap`：

```
menu = HMENU
menu {
    1 = TMENU
    1 {
        NO {
            linkWrap = |<span></span>
            ATagBeforeWrap = 1
        }
    }
    # ...
} 
```

# android - 为什么 texImage2D 总是给出无效操作错误？

> ID：13783588
> 
> 赞同：-2
> 
> 时间：2012-12-09T00:54:10.743
> 
> 标签：android, c, opengl-es

这是我的代码，我找不到问题隐藏在哪里。

```
bool setupGraphics(int w, int h) {
    printGLString("Version", GL_VERSION);
    printGLString("Vendor", GL_VENDOR);
    printGLString("Renderer", GL_RENDERER);
    printGLString("Extensions", GL_EXTENSIONS);

    glViewport(0, 0, w, h);
    checkGlError("glViewport");

    glEnable(GL_DEPTH_TEST);

    LOGI("setupGraphics(%d, %d)", w, h);
    gProgram = createProgram(gVertexShader, gFragmentShader);
    if (!gProgram) {
        LOGE("Could not create program.");
        return false;
    }
    gvPositionHandle = glGetAttribLocation(gProgram, "vPosition");
    checkGlError("glGetAttribLocation");

    //Init texture.
    makeCheckImage();  
    checkGlError("init texture1");
    glGenTextures(1, gTextureHandler);
    glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_NEAREST);
    glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_NEAREST);
    glTexImage2D(GL_TEXTURE_2D, 0, 4, 64, 64, 0, GL_RGBA, GL_UNSIGNED_BYTE, checkImage);
    glBindTexture(GL_TEXTURE_2D, gTextureHandler[0]);
    checkGlError("init texture2");

    gTextureUniformHandler = glGetUniformLocation(gProgram, "uTexture");
    gTextureCoordinateHandler = glGetAttribLocation(gProgram, "vTexCoordinate");
    checkGlError("init texture");

    return true;
} 
```

和日志：

```
I/libgl2jni(30066): GL Version = OpenGL ES 2.0 build 1.8.GOOGLENEXUS.ED945322@2112805
I/libgl2jni(30066): GL Vendor = Imagination Technologies
I/libgl2jni(30066): GL Renderer = PowerVR SGX 540
I/libgl2jni(30066): GL Extensions = GL_EXT_debug_marker GL_OES_rgb8_rgba8 GL_OES_depth24 GL_OES_vertex_half_float GL_OES_texture_float GL_OES_texture_half_float GL_OES_element_index_uint GL_OES_mapbuffer GL_OES_fragment_precision_high GL_OES_compressed_ETC1_RGB8_texture GL_OES_EGL_image GL_OES_EGL_image_external GL_OES_required_internalformat GL_OES_depth_texture GL_OES_get_program_binary GL_OES_packed_depth_stencil GL_OES_standard_derivatives GL_OES_vertex_array_object GL_OES_egl_sync GL_EXT_multi_draw_arrays GL_EXT_texture_format_BGRA8888 GL_EXT_discard_framebuffer GL_EXT_shader_texture_lod GL_IMG_shader_binary GL_IMG_texture_compression_pvrtc GL_IMG_texture_npot GL_IMG_texture_format_BGRA8888 GL_IMG_read_format GL_IMG_program_binary GL_IMG_multisampled_render_to_texture
I/libgl2jni(30066): setupGraphics(480, 800)
I/libgl2jni(30066): after init texture2() glError (invalide operation) 
```

如果我发表评论`glTexImage2D(GL_TEXTURE_2D, 0, 4, 64, 64, 0, GL_RGBA, GL_UNSIGNED_BYTE, checkImage); glBindTexture(GL_TEXTURE_2D, gTextureHandler[0]);`，那么一切都会好起来的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T00:58:02.440

看起来您的 the`glBindTexture`和 the`glTexImage`顺序错误。glTexImage 更新当前绑定到指定目标的纹理。

先绑定纹理，再填充数据。此外，您应该在设置 min/mag 过滤器之前绑定纹理，因为这些也会修改绑定的纹理。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-09T04:03:44.290

我自己解决了这个问题。该错误是由于 中的参数不一致引起的`glTexImage2D`。如果我将其更改为`glTexImage2D(GL_TEXTURE_2D, 0, GL_RGBA, 64, 64, 0, GL_RGBA, GL_UNSIGNED_BYTE, checkImage);`，则错误不存在。

# asp.net - 默认找不到多个 MVC 3 区域和获取资源

> ID：13783595
> 
> 赞同：0
> 
> 时间：2012-12-09T00:55:16.533
> 
> 标签：asp.net, asp.net-mvc-3, asp.net-mvc-3-areas

我有一个 mvc 3 应用程序。我有一个管理区域，它工作正常。根据区域之外的默认项目配置，还有控制器和视图。这也很好用。但是当我在区域下添加一个新区域时，区域内的控制器继续工作，但对于外部的控制器，我无法找到资源。

我在这里错过了什么吗？

```
public mycode  //put some areas and controllers here 
               //4 spaces in front of code
{
} 
```

产生此错误消息：

> 发生异常...（以 > 开头的行是一个适用于异常的块）

我的默认路线和区域路线正在全球注册。

# java - 运行时错误：java.lang.ExceptionInInitializerError

> ID：13783598
> 
> 赞同：0
> 
> 时间：2012-12-09T00:55:33.863
> 
> 标签：java, html, applet, runtime-error, java-7

我正在尝试将我编写的 Java 小程序嵌入到 html 文件中。每次运行该文件时，我都会收到“java.lang.ExceptionInInitializerError”。我认为问题出在初始化函数中，因此我将其包含在下面。如果有任何其他有用的信息/代码，请告诉我！

如何解决`java.lang.ExceptionInInitializerError`？

```
@Override
public void init(){   
    //Execute a job on the event-dispatching thread; creating this applet's GUI.
    try {  
        SwingUtilities.invokeAndWait(new Runnable() {
            @Override
            public void run() {
                enterLogin();
            }
        });
    } 
    catch (InterruptedException | InvocationTargetException e) {
        System.err.println("createGUI didn't complete successfully");
    }
} 
```

# javascript - 如何在内容之后加载广告？

> ID：13783600
> 
> 赞同：2
> 
> 时间：2012-12-09T00:56:01.023
> 
> 标签：javascript, html

有时我的广告会导致我的网站加载速度非常慢，并且内容没有显示出来。我试过这个在内容之后加载顶部广告，但它不起作用；

```
<code><div id=”top_ad_loader” style=”display:none;”&gt;adcode</div><script type=”text/javascript”&gt;document.getElementById(“top_ad”).innerHTML =document.getElementById(“top_ad_loader”).innerHTML</script> 
```

有任何想法吗？多谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-09T01:49:18.893

只需在 iframe 中加载广告。他们不会减慢页面加载速度。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-09T01:02:26.530

在页面加载后加载第三方广告并不是一件容易的事。因为大多数广告都是`document.write()`用来添加内容的。在站点加载后使用 document.write 会导致整个页面变为空白。

要做的一件事是在页面顶部覆盖 document.write 并自己操作内容。

例子：

```
// top of the page
var adContent = [];
    document.write = function (a){
    adContent.push(a);
} 
```

现在您的所有广告数据都在`adContent`数组中，您可以检查内容并将其附加到写入部分。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-09T01:18:05.440

您尝试过的技术 - 脚本~~标签~~上的 innerHTML - 将不起作用。

相反，您需要在页面加载**后动态添加脚本：**

```
var newScript=document.createElement("script");
newScript.src="script.js";
document.head.appendChild(newScript); 
```

不幸的是，这通常不会直接在主页上起作用，因为广告需要在特定位置运行。在这种情况下，一种解决方法是使用 iframe。[这就是我在此页面](http://usermanagedsolutions.com/SharePoint-User-Toolkit/)右侧所做的。

# performance - 对于一般的移动 safari 和移动 webkit，使用复杂的 CSS 还是图像更好

> ID：13783601
> 
> 赞同：1
> 
> 时间：2012-12-09T00:56:13.633
> 
> 标签：performance, css, mobile, memory-management, responsive-design

我最近问了这个问题：[如何在对角元素上创建 CSS 边框](https://stackoverflow.com/questions/13782432/how-can-i-create-a-css-border-on-a-diagonal-element/13783241)

**问题：**使用图像或复杂的 css 作为导航菜单是更占用内存还是更占用 CPU？

**问题：**除了跨浏览器/屏幕尺寸之外，除了上面提到的原因之外，一个优势是否比另一个优势？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T01:23:03.693

最终，设备需要显示像素阵列。如果您发送这些像素的图像文件，它们就可以显示了。如果您发送复杂的 css 来创建这些像素，它可能会在网络上占用更少的字节，但处理器将需要渲染像素阵列才能显示。

是否应该使用 css 或图像取决于各种考虑。这里有几个：

*   您需要显示的东西总是完全相同的大小吗？然后图像文件具有已经被渲染的优势。如果没有，css 将提供有效调整大小的能力。

*   用户是否始终拥有良好的网络连接？如果是这样，发送预渲染图像和可能的一堆媒体查询 css 来决定加载哪个图像不会有太多的性能损失。

*   您要在屏幕上渲染的东西是否很大？如果是这样，css 可能比加载大图像文件更有优势。

*   css 是不是非常复杂，需要大量代码来描述？然后图像文件具有经过预处理的 cpu 优势。

*   是否有与显示项目相关的动画状态或其他动画？然后 css 的优点是不必加载多个可能很大的图像文件。但是，如果状态具有非常复杂的动画，需要大量的代码和 cpu，那么前面的指南将适用。

第二个问题：如果您的 css 存在跨浏览器问题，预渲染图像将消除这些问题。但是，如果您正在构建一个具有多种不同显示尺寸的响应式显示对象，那么 css 将具有可扩展性的优势。也就是说，响应式设计的一个基本概念是提供几个不同大小的图像版本。

一般来说，图像文件会消耗带宽，而 css/vectors 会消耗 cpu。

# objective-c - 以编程方式创建 NSButton 并设置自定义 NSButtonCell

> ID：13783610
> 
> 赞同：0
> 
> 时间：2012-12-09T00:57:00.913
> 
> 标签：objective-c, macos, nsbutton, nsbuttoncell

好的，这看起来应该很简单，但我来自 iOS，而且我必须遗漏一些非常明显的东西。所以我有一个 NSButtonCell 的自定义子类。如果我在 IB 中创建一个 NSButton 并在 IB 中分配 NSButtonCell，它就没有问题。

但是，我需要以编程方式创建此按钮。我已经查看了几个示例，并且在 awakeFromNib 中有以下内容，但是，它创建了一个看起来像常规按钮的东西，下面是我的自定义按钮单元格（我可以在单击按钮时知道）。

```
NSButton* button = [[NSButton alloc] initWithFrame:NSMakeRect(100, 100, 60, 30)];
CT_CaptureButtonCell* captureCell = [[CT_CaptureButtonCell alloc] init];
[button setCell:captureCell];
[captureCell release];
[self.view addSubview:button]; 
```

那么我错过/不理解什么愚蠢的事情？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T06:13:40.020

如果您查看" ["的](http://developer.apple.com/library/mac/documentation/Cocoa/Reference/ApplicationKit/Classes/NSControl_Class/Reference/Reference.html#//apple_ref/occ/instm/NSControl/setCell%3a)[文档`setCell:`](http://developer.apple.com/library/mac/documentation/Cocoa/Reference/ApplicationKit/Classes/NSControl_Class/Reference/Reference.html#//apple_ref/occ/instm/NSControl/setCell%3a)，它会指出：

> **讨论**
> 
> 使用此方法时要非常小心，因为它会不可挽回地损坏受影响的控件；具体来说，您应该只在 NSControl 子类的初始化程序中使用此方法。

我读这篇文章的方式是，您应该`setCell`从“”的子类*的*init 方法中调用您的“ `NSButton`”。换句话说，编写您自己的 NSButton 子类（例如“ `ICButton`”，用于 InfalibleCoinage），然后将“ `setCell`”调用填充到那里的 init 方法中。

当我们讨论这个主题时，你究竟想用“ `CT_CaptureButtonCell`”完成什么，你能在不使用自定义纽扣电池的情况下做到这一点吗？

# database - 适用于 i18n 的 FuelPHP ORM 数据库模式，意见/建议

> ID：13783613
> 
> 赞同：5
> 
> 时间：2012-12-09T00:57:32.117
> 
> 标签：database, orm, internationalization, fuelphp

虽然这个问题可能[与](https://stackoverflow.com/questions/929410/what-are-best-practices-for-multi-language-database-design) [许多](https://stackoverflow.com/questions/1980214/how-to-support-multi-languages-approach-in-database-schema/)[其他问题相似](https://stackoverflow.com/questions/9960241/i18n-using-database)[，](https://stackoverflow.com/questions/316780/schema-for-a-multilanguage-database) 但我想就 i18n 特别是在 FuelPHP 上的最佳方法征求意见/建议。

所以，这是我到目前为止所得到的：

**数据库模式#1：**

```
models (id, name_pt, name_es, name_en, description_pt, description_es, description_en) 
```

**样本数据#1：**

```
(1, 'Modelo', 'Modelo', 'Model', 'Descrição do modelo', 'Descripción del modelo', 'Model description') 
```

**优点：**

*   直而简单
*   每个型号一张桌子
*   无需使用 JOIN
*   使用魔术方法简化数据访问：

```
public function & __get($property)
{
    if (array_key_exists($property, array('name', 'description')))
    {
        $property = $property.'_'.Session::get('lang_code');
    }

    return parent::__get($property);
} 
```

这样，我就可以打电话了：

```
$model->name;
$model->description; 
```

代替：

```
$model->{'name_'.Session::get('lang_code')};
$model->{'description_'.Session::get('lang_code')}; 
```

**缺点：**

*   拥有大量语言/翻译字段可能会变得混乱。
*   添加新语言，意味着向表中添加新字段
*   魔术方法仅在我们已经拥有 ORM 实例/对象时才有效。[要通过按翻译字段排序的查询构建器](http://fuelphp.com/dev-docs/packages/orm/relations/intro.html)获取 ORM 实例，仍然需要如下代码：

```
Model_Model::query()
    ->order_by('name_'.Session::get('lang_code'))
    ->get(); 
```

**数据库模式#2：**

```
languages (id, code, name)
models (id)
i18n_models (id, model_id, language_id, name, description) 
```

**样本数据#2：**

```
-- languages
(1, 'pt', 'Português')
(2, 'es', 'Español')
(3, 'en', 'English')

-- models
(1)

-- i18n_models
(1, 1, 1, 'Modelo', 'Descrição do modelo')
(2, 1, 2, 'Modelo', 'Descripción del modelo')
(3, 1, 3, 'Model', 'Model description') 
```

**优点：**

*   更好的数据组织
*   添加新语言是一件轻而易举的事
*   与第一种方法一样，我们也可以使用[set()](http://fuelphp.com/dev-docs/packages/orm/crud.html)方法直接访问数据以填充 $_custom_data 数组：

```
$i18n = Model_I18n_Model::query()
    ->where('model_id', $model->id)
    ->where('language_id', Session::get('lang_code'))
    ->get_one();

$model->set(array(
    'name' => $i18n->name,
    'description' => $i18n->description
)); 
```

**缺点：**

*   复杂性增加
*   必须使用 JOIN 或第二个查询
*   每个模型都需要一个额外的表格

**数据库模式#3：**

在其他问题上，我看到有人建议对所有翻译使用中央 i18n 表，模型的每个翻译使用一行。

**优点：**

*   模型之间共享的 i18n 单表
*   添加新语言应该像以前的方法一样容易

**缺点：**

*   获取数据时复杂性增加，模型具有的每个翻译文本都需要 JOIN
*   我们可以尝试通过这种方法使用[EAV 容器](http://fuelphp.com/dev-docs/packages/orm/eav.html)，尽管它使用键/值进行映射，但在这种情况下，特别是我们还必须使用 language_id 来获取正确的翻译。

就个人而言，我更喜欢第二种方法。您还看到哪些其他优点/缺点？有没有人在 FuePHP 上以不同的方式实现 i18n？分享你的想法:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-04-17T21:13:32.937

我只需`lang`在表中添加一个字段。

然后我过滤该字段：

```
SELECT * FROM articles WHERE lang = 'en' 
```

我什至在 CRUD 中将它用于用户可以切换语言的管理部分，他们可以看到该特定语言的所有条目。

并且编辑器将自动以他所使用的语言处理内容。

```
INSERT INTO articles VALUES('My Title', 'My Article', 'en') 
```

并且只需从当前本地用户那里获取“en”。（我确实允许他们改变形式，但要覆盖它）。

# mysql - mysql where子句冲突

> ID：13783615
> 
> 赞同：1
> 
> 时间：2012-12-09T00:57:37.463
> 
> 标签：mysql, where-clause, ambiguity

我有以下表格：

```
users: id, username, password, created, modified
posts: id, user_id, message, created, modified 
```

我正在尝试运行一个查询，以获取今天创建的最后 5 个帖子（以及发布者的用户名）。当我运行以下查询时：

```
SELECT users.username, posts.*
FROM postsLEFT OUTER JOIN users ON (posts.user_id=users.id)
WHERE (DATE(`posts.created`) = DATE(NOW()))
ORDER BY posts.created DESC
LIMIT 5 
```

我收到消息：

> 'where 子句'中的未知列'posts.created'

很好，我知道 where 在查询的其他部分之前运行。那么我试试这个查询：

```
SELECT users.username, posts.*
FROM postsLEFT OUTER JOIN users ON (posts.user_id=users.id)
WHERE (DATE(`created`) = DATE(NOW()))
ORDER BY posts.created DESC
LIMIT 5 
```

但我当然得到消息：

> where 子句中的“创建”列不明确

关于如何更改查询以便没有任何问题的任何建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T00:59:40.487

通过将 items.created 包装在引号中，它被解释为名为“items.created”的列，而不是 items 表中的 created 列。下面应该工作。

```
SELECT users.username, items.*
FROM items LEFT OUTER JOIN users ON (items.user_id=users.id)
WHERE (DATE(items.created) = DATE(NOW()))
ORDER BY items.created DESC
LIMIT 5 
```

# git - 如何退出某些推送

> ID：13783617
> 
> 赞同：4
> 
> 时间：2012-12-09T00:57:51.260
> 
> 标签：git, git-revert

我正在查看最后 10 次左右的推送，我想退出其中的 4 次（不连续）。

我怎样才能做到这一点？

在 SVN 中，这将是恢复更改并将“撤消”的更改推回的问题。不确定如何在 Git 中执行此操作。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-09T01:00:16.200

您可以`git revert <commit>`在不重写历史记录的情况下恢复有问题的提交。这将创建一个撤消这些提交的新提交。

而不是`<commit>`您使用要还原的每个提交的 SHA。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-09T01:07:19.333

@ThiefMaster 的回答效果很好。

作为替代方案，**如果它不是共享远程分支**（意味着如果没有其他人拉取您的更改），您可以`git rebase -i HEAD~10`. 这将打开 $EDITOR 中最后 10 次提交的列表。只需删除您不再需要的提交，保存文件，然后`git push -f`强制推送并覆盖远程分支上的历史记录。

优点：它使历史更清晰。

缺点：您可能*不*希望清理历史记录，并且可能希望在 git 历史记录中捕获还原提交。

更多关于交互式变基的信息：http: [//git-scm.com/book/en/Git-Tools-Rewriting-History#Changing-Multiple-Commit-Messages](http://git-scm.com/book/en/Git-Tools-Rewriting-History#Changing-Multiple-Commit-Messages)

# php - 如何一次显示所有错误而不是一次显示一个错误？

> ID：13783618
> 
> 赞同：-3
> 
> 时间：2012-12-09T00:57:59.283
> 
> 标签：php

在下面的代码中，它假设包含一个数组中的所有错误，然后根据激活的错误显示错误。但问题是它仍然一次只显示一个错误，而不是一次显示相关错误。为了做到这一点，我需要改变什么？

```
$errors = array();

          if (!$getcourseid){
              $errors[] = "You must enter in Course's ID";
      }else if (!$getcoursename){
          $errors[] = "You must enter in Course's Name";
      }else if (!$getduration){
              $errors[] = "You must select Course's Duration";
          }     

    if(empty($errors)) {
        if ($numrows == 1){
       $errormsg = "<span style='color: green'>Course " . $getcourseid .  " - "  . $getcoursename . " has been Created</span>";
       $getcourseid = "";
       $getcoursename = "";
       $getduration = "";
    }else{
        $errormsg = "An error has occured, Course has not been Created";
    }
    } else {
        if(isset($errors[0])) {
           $errormsg = $errors[0]; 
        } elseif (isset($errors[1])) {
           $errormsg = $errors[1];
        } elseif (isset($errors[1])) {
            $errormsg = $errors[1]; 
        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T01:14:05.300

尝试这样的解决方案：

```
 <?php 

$errors = array();

          if (!$getcourseid){
              $errors[] = "You must enter in Course's ID";
      }else if (!$getcoursename){
          $errors[] = "You must enter in Course's Name";
      }else if (!$getduration){
              $errors[] = "You must select Course's Duration";
          }     

    if(empty($errors)) {
        if ($numrows == 1){
       $errormsg = "<span style='color: green'>Course " . $getcourseid .  " - "  . $getcoursename . " has been Created</span>";
       $getcourseid = "";
       $getcoursename = "";
       $getduration = "";
    }else{
        $errormsg = "An error has occured, Course has not been Created";
    }
    } else {
        if (count($errors) > 0)
        {
            foreach ($errors AS $Errors)
            {
                echo "{$Errors} <br>"; 
            }
        }
    }     
?> 
```

**如果在其他地方设置了 $numrows，我没有看到为 $numrows 设置的变量；然后忽略这个。否则，我会查看您的代码。**

我还会对您的代码演示提出一些建议

# angularjs - 任何按钮的AngularUI ui-keypress？

> ID：13783620
> 
> 赞同：2
> 
> 时间：2012-12-09T00:58:06.483
> 
> 标签：angularjs, angular-ui

好吧，我需要一种方法来转发发生在 textarea 元素上的 keypress （或 keydown 等）事件，而我试图做的是：

```
<div id="wrapper" ng-controller="MyTestCtrl">
    <div id="text" ng-click="DivClick()">
        <ul>
            <li ng-repeat="item in items">
                <textarea ng-click="InnerClick()" ui-keypress="TextKeypress()" autofocus></textarea>
            </li>
        </ul>
    </div>
</div> 
```

但这似乎很有趣，我想避免使用任何特定的键码，因为每次用户在其中输入内容时，我都需要它来更新 textarea 的高度（这就是 TextKeypress 函数正在做的事情）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-07T23:32:32.087

您可以使用**uiEvent**：`<textarea ui-event=" { keypress: 'whatever($event)' } ">`

更新：

现在的核心也包括在内`ng-keypress`！（不知道哪个版本）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-09T20:45:01.040

好的，我已经通过创建一个适合我需要的自定义指令来克服这个问题，并且我已经将该指令绑定到带有“keypress”的元素。像这样的东西：

```
.directive('mydKeypress', function(){
    return function(scope, elm, attrs){
        elm.bind('keypress', function(e){
            //Whatever code;
            alert('it bloody works!');
        });
    };
}); 
```

# javascript - Codeigniter、jQuery 和 Ajax - 在动态显示新数据库内容时阻止页面刷新

> ID：13783626
> 
> 赞同：1
> 
> 时间：2012-12-09T00:58:24.683
> 
> 标签：javascript, jquery, ajax, codeigniter, refresh

我正在尝试实现一些相对简单的事情 - 允许用户在视图页面上发表评论，更新数据库并在页面上动态显示新内容，而无需刷新整个页面。

到目前为止，我的努力没有成功——我正在做的事情可能有几个问题！

在视图页面上，我尝试了这个（将 2 个变量发送到 CI 控制器函数）：

```
<script type="text/javascript">
function ajax(id, user_id) {
jQuery('#dynamicdiv').load('/controller/function/' + id + '/' + user_id);
}
</script>

<div id='dynamicdiv'>
</div> 
```

我有一个 textarea 来收集用户评论，在控制器功能中我应该能够将其称为发布数据以便将其写入数据库吗？如果是这样，我仍然需要将另外两个变量（$id 和 $user_id）发送到 ajax 函数。

```
<?php $atts = array (
  'class' => "alignright button",
  'onClick' => "ajax('$id,$user_id')",
  ); ?>
<?php echo anchor(current_url(), 'Post my Comment', $atts); ?> 
```

在控制器中，它涉及与我希望用户停留的页面不同的功能（视图）：

```
$data = $this->model->database_query($id, $user_id);

echo $data; // from reading other posts it seems I would process the data within this function, to have it displayed on the page the user is viewing? 
```

任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T01:57:44.270

不要忘记阻止您的默认锚点行为（例如通过添加`return false;`到您的`onclick`参数）。

```
<?php $atts = array (
'class' => "alignright button",
'onClick' => "ajax('$id,$user_id'); return false;",
); ?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-09T17:33:57.780

您可以按如下方式发出 ajax 请求：

```
function ajax(id, user_id) {
    $.ajax({
        url: base_url + controller_name + '/' + action_name,
        type: 'GET',
        data: { id: id, user_id: user_id },
        dataType: 'json',
        success: function (data) {
            // append the returned result to your #dynamicdiv
        }
    });
} 
```

在控制器中：

```
$id = $this->input->get('id');
$user_id = $this->input->get('user_id');

$data = $this->model->database_query($id, $user_id);
echo json_encode($data); 
```

希望这可以帮助

# html - --no-clobber 如果在 wget 中使用 --html-extension 仍会覆盖文件？

> ID：13783627
> 
> 赞同：1
> 
> 时间：2012-12-09T00:58:29.223
> 
> 标签：html, wget, overwrite

我有一个用于下载我所有 Chrome 书签的脚本。我将 wget 与 --html-extension 一起使用，因为某些书签以 .php 结尾，并且除非使用 --html-extension 选项，否则无法由 Web 浏览器打开。我遇到的问题是，当我将 --html-extension 与 --no-clobber 一起使用时，由于某种原因，它无法识别大多数文件已经存在，因此它会经历重新下载内容的整个过程已经有了。

一个例子： wget -nc [http://www.test.com/](http://www.test.com/) 运行一次将按预期保存文件。如果你再次运行它，它会说文件已经存在，所以不检索。这就是我所期望的操作。

但是，删除刚刚保存的文件并运行： wget -nc [http://www.test.com/](http://www.test.com/) --html-extension 然后再次运行相同的命令。它覆盖文件而不是说文件已经存在。到底是怎么回事？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T02:48:12.377

添加 html 后缀时，wget 无法告诉您要将其与哪个远程文件进行比较。

男人 wget：[http ://unixhelp.ed.ac.uk/CGI/man-cgi?wget](http://unixhelp.ed.ac.uk/CGI/man-cgi?wget)

=======================

--html-扩展名

如果下载了 application/xhtml+xml 或 text/html 类型的文件并且 URL 不以正则表达式 .[Hh][Tt][Mm][Ll]? 结尾，则此选项将导致后缀 .html附加到本地文件名。这很有用，例如，当您镜像一个使用 .asp 页面的远程站点，但您希望镜像页面可以在您的库存 Apache 服务器上查看时。另一个很好的用途是当您下载 CGI 生成的材料时。像[http://site.com/article.cgi?25](http://site.com/article.cgi?25)这样的 URL将被保存为 article.cgi?25.html。

**请注意，以这种方式更改的文件名将在您每次重新镜像站点时重新下载，因为 Wget 无法判断本地 X.html 文件对应于远程 URL X（因为它还不知道该 URL产生 text/html 或 application/xhtml+xml 类型的输出。** 为防止重新下载，您必须使用 -k 和 -K 以便将文件的原始版本保存为 X.orig。

# html - 如何在浏览器顶部放置标题 - CSS3 HTML5

> ID：13783628
> 
> 赞同：0
> 
> 时间：2012-12-09T00:58:32.973
> 
> 标签：html, css, header, shapes

我正在尝试使用一个形状（用 CSS 制作），并将它放在 HTML 页面的顶部。请参阅下图作为示例。我希望灰色矩形位于 HTML 页面的顶部，顶部、右侧或左侧没有间隙。如果这是一个微不足道的问题，我对 CSS 和 HTML 非常陌生，很抱歉。我只使用 CSS 3 和 HTML 5，也许稍后会使用一点 JavaScript。

我想要什么...（注意灰色矩形上方没有间隙）

![注意灰色矩形上方没有间隙](../Images/95c86260979e82a280369c57ede19f9a.png)

我现在拥有的......（注意灰色矩形上方的白色间隙）

![注意灰色矩形上方的白色间隙](../Images/cbad29adfb6047f8fb7d613505fec219.png)

这是我的 CSS 代码：

```
#header {
margin: auto;
width: 1050; 
height: 120px; 
background: rgb(45,45,45); 
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-09T01:01:07.783

尝试从正文中删除填充和边距。

`body { margin: 0; padding: 0; }`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-09T01:01:14.290

不知道你的代码的其余部分这是一个很长的镜头，但试试这个：

```
body {margin:0; padding:0}

#header {
margin:0 auto;
width: 1050; 
height: 120px; 
background: rgb(45,45,45); 
} 
```

# java - 使用 JButton actionperformed 类如何将元素从一个数组列表添加到另一个数组列表？

> ID：13783632
> 
> 赞同：-2
> 
> 时间：2012-12-09T00:58:58.523
> 
> 标签：java, swing, jbutton

我有一个方法可以返回我通过 buttonListener 调用的数组列表。我需要能够将每个推送结果数组列表存储在另一个数组列表中。我该怎么做呢？每次我尝试时，它都会复制我用来跟踪推送结果的数组列表中的现有元素。

```
private class ButtonListener implements ActionListener{
public  void actionPerformed (ActionEvent e){
    numCounter++;
    String reqVal1 = requestor.getText();
    int reqVal = Integer.parseInt(reqVal1);
    request = reqVal;
    requestsArray.get(3).set(0,0);
    if(numCounter == 1){//---------------------------numCounter == 1 beginning--------   -------------------------
        workingVar = memSize/2; 
                if(request>workingVar){
                    requestsArray.get(3).set(0,1);
                }
                else{   
           reqCounter++;
    while (workingVar>=request){
        workingVar = workingVar/2;
        holes2.add(workingVar);
    }
    if(workingVar<request){
        workingVar=workingVar*2;
        holes2.add(workingVar);    
        holes2.remove(holes2.size()-2);
        holes2.remove(holes2.size()-1);
            }
    }
    e1=workingVar;
    }//-----------------------------------------------end of numCounter == 1 section-------------------------------------
    if(numCounter > 1){
        for (int y = 0; y<requestsArray.get(0).size();y++){
            if(requestsArray.get(1).get(y).equals("H")){
                holes.add((Integer)requestsArray.get(0).get(y));
            }
        }
        //BubbleSort of holes ArrayList
        int in, out;
        for(out= holes.size()-1; out>0;out--) 
            for(in =0; in<out;in++)
            if(holes.get(in)<holes.get(in+1)){
                int temp1 = holes.get(in+1);
                int temp2 = holes.get(in);
                holes.set(in, temp1);
                holes.set(in+1, temp2);
            }

    //calculates the value of e1 using holes array
        if(holes.isEmpty()){
            requestsArray.get(3).set(0, 1); 
        }
        else{
        for(element=holes.size()-1;element>-1;element--){//starts at end of holes array loops backwards
            e1 = holes.get(element); //assigns value of each element to e1  
         if(e1>=request)    //if value e1 is greater than request stop looping                                                           
            break;                        
            }

    workingVar=e1; //assign the value of e1 to workingVar
    if (request>e1){
        requestsArray.get(3).set(0, 1);                   
    }
    else{
        //---------------------code for populating holes2 array---------------------------
        reqCounter++;
    if(workingVar!=request && workingVar/2>=request){
        while (workingVar/2>=request){
            workingVar = workingVar/2;
            holes2.add(workingVar);
            }     
        if(workingVar<request){
            workingVar=workingVar*2;
            holes2.add(workingVar); 
                    }
                }
            }
        }
    }

    //Sort of Holes2 ArrayList - reorder's holes2 for initial set up and subsequent inserts
    int in, out;
    for(out= holes2.size()-1; out>0;out--) 
        for(in =0; in<out;in++)
        if(holes2.get(in)>holes2.get(in+1)){
            int temp1 = holes2.get(in+1);
            int temp2 = holes2.get(in);
            holes2.set(in, temp1);
            holes2.set(in+1, temp2);
        }

   //-------------------------------requestsArray Setups----------------------------------------------------
        //Initial setup of requestsArray 
    if(numCounter == 1){
        if(requestsArray.get(3).get(0).equals(0)){
        requestsArray.get(0).set(0,e1);
        requestsArray.get(1).set(0,"R");
        requestsArray.get(2).set(0, reqCounter);;
        for(int i = 0; i<holes2.size();i++){
            requestsArray.get(0).add(holes2.get(i));
            requestsArray.get(1).add("H");
            requestsArray.get(2).add(0);
            }
        }
        else{
            requestsArray.get(0).set(0,e1);
            requestsArray.get(1).set(0, "H");       
            requestsArray.get(2).set(0,0);
        }
    }

    //Subsequent setup of requestsArray

    int element2;           
    if(numCounter >1 && requestsArray.get(3).get(0).equals(0)){
        for(element2 = 0; element2< requestsArray.get(0).size(); element2++){
            if((Integer)requestsArray.get(0).get(element2)==e1 &&requestsArray.get(1).get(element2).equals("H") ){
                break;
                    }
        }
            if(holes2.isEmpty()){
            requestsArray.get(1).set(element2, "R");
            requestsArray.get(2).set(element2, reqCounter);
                    }
            else{ //holes2 is not empty
                requestsArray.get(0).add(element2, workingVar);
                requestsArray.get(2).add(element2,reqCounter);
                requestsArray.get(1).add(element2, "R");
                requestsArray.get(0).remove(element2+1);
                requestsArray.get(2).remove(element2+1);
                requestsArray.get(1).remove(element2+1);                    
                for(int i = 1; i<holes2.size()+1;i++){
                    requestsArray.get(0).add(element2+i,holes2.get(i-1));
                    requestsArray.get(1).add(element2+i,"H");
                    requestsArray.get(2).add(element2+i,0);
                    }
                }                           
        }

    //-----------------End Section for populating requestsArraywhen numCounter > 1---------------------------           

        //remove all values from holes1 and holes2
        holes.clear();
        holes2.clear();
        System.out.println(results1); 
```

好的。我写了一个类似的程序，它更简单，更容易理解。每次按下按钮时，结果都会作为 arrayList 保存到另一个 arrayList。问题是它将它附加到前一个元素。我需要能够将每次印刷的结果添加为单独的元素。例如：第一次按下：[5, 3, 5, 2, 6, 5] 第二次按下将显示：[5, 3, 5, 2, 6, 5][2, 1, 4, 1, 4, 1]这样我可以循环遍历并分别获取每个数组结果。我该怎么做呢？

```
public class mainClass{
        public static void main(String[] args){
JFrame frame1 = new JFrame("testButton");
frame1.setDefaultCloseOperation(JFrame. EXIT_ON_CLOSE);
buttonExample b1 = new buttonExample(); 
frame1.getContentPane().add(b1);
frame1.pack();
frame1.setVisible(true);
            }

    }

    public class Example {
            private int rand1; 
            private ArrayList<ArrayList> count; 
            private ArrayList<Integer> count2;
            private Random rnd;
            private int counter1;
            private ArrayList<ArrayList>count3;
        public Example(){
            count = new ArrayList<ArrayList>();
            count2 = new ArrayList<Integer>();
            rnd = new Random();
            count3 = new ArrayList<ArrayList>();
}
        private void addCount2(){
            for(int x = 0; x<6;x++){
            rand1 = rnd.nextInt(6)+1;
            count2.add(rand1);// count2 == Integers
            }
        }

        public void addCount(){
            addCount2();
            count.add(count2);// count == count3
        }
        public ArrayList<ArrayList> displayCount(){
        return count;   

        }
}

public class buttonExample extends JPanel {
private JButton button1;
private Example example1;
public buttonExample(){
button1 = new JButton("Submit");
add(button1);
button1.addActionListener(new ButtonListener());
example1 = new Example();
}
private class ButtonListener implements ActionListener{
public void actionPerformed(ActionEvent e) {
    example1.addCount();
    System.out.println(example1.displayCount().get(0));;
    }
}
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-09T01:08:11.610

我会考虑至少两个解决方案......

1.  创建一个`List<...> list`将持续的（全局变量或类似的东西，取决于您的需要）并使用`list.addAll()`方法
2.  创建一个`Map<String, List<...> map`并且您可以单独记录您的列表，例如，您的密钥可能是时间戳

好吧，现在当您发布代码时，您将不得不从不同的事情开始——重构。您的代码很长，难以阅读且容易出错。您必须考虑一下重写它。相信我，一开始你在代码中投入的精力越多，结果就会越好。否则你可能会得到一个充满错误的难以管理的代码......

# excel - VBA将数据写入网络上多个用户使用的Excel？

> ID：13783634
> 
> 赞同：1
> 
> 时间：2012-12-09T00:59:16.540
> 
> 标签：excel, ms-access, vba, ado

基本上我在网络驱动器上有一个主工作簿，许多人使用它来更新工作表，我想自动化这个，通过我的研究我发现如果我自动化它会有很多复杂性。

在 Google 上搜索给了我以下建议，我注意到这些解决方案的一些复杂性

1.  使用 VBA 打开和写入数据并关闭它。

    *   **有可能Excel已经被其他人打开并且它处于只读模式**，所以我不能写。即使我尝试打开和写入，但卡住的时间太长了。
2.  共享工作簿并写入数据

    *   为此，工作簿应至少由一个人打开和共享，同时写入数据如果两个人同时写入数据，则一个**人可能会覆盖其他人的数据**
3.  使用 ADO 将数据写入 Excel

    *   我**对 ADO 以及如何使用它将数据写入 Excel 没有任何想法**，看到了一些示例，但最终没有什么好理解的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T14:05:42.203

*   设置 Access 数据库
*   从 Excel 连接到数据库：转到功能区：数据 > 从 Access。这几乎像数据透视表一样工作，并且确实只是视图。

您还可以将所有数据仍存储在 Excel 中，然后再次使用外部数据选项（来自其他源 > 向导 > 其他/高级 >（选项卡）连接 > 使用数据源名称 > Excel 文件 > 确定）从所有用户使用的中央 Excel。

尽管如此，对于写入您的数据库，我还是建议使用 VBA，如果这超出了您的范围，那么您可能希望尽快忙于它，因为这可能是您让用户编写的最佳方式。

# php - 带有 Windows 路径的 shell_exec 未运行

> ID：13783649
> 
> 赞同：6
> 
> 时间：2012-12-09T01:01:15.833
> 
> 标签：php, shell-exec

我正在尝试使用 shell_exec 运行命令，但它没有返回任何输出。当我将命令复制到命令提示符时，它就像一个魅力。

这是我要运行的命令。

```
$result = shell_exec('android update project -p "C:\xampp\htdocs\appBuilder" -t 1'); 
```

`$result`正在返回一个空字符串。当我在命令提示符下运行命令时，它会显示一条消息，说明`build.xml`文件已成功生成。它应该在 中显示成功消息`$result`。

如果我只`android update project -p "C:\xampp\htdocs\appBuilder" -t 1`在命令提示符下运行命令，它就可以工作。

`build.xml`仅供参考：此命令用于为 android 应用程序生成文件。我也在使用 xampp 在本地 Web 服务器上运行它。

有人知道我在做什么错吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-09T05:55:55.253

应该使用双反斜杠来打印单个字符**（** 第一个用于转义第二个）：`\\``\``\``\`

```
$result = shell_exec('android update project -p "C:\\xampp\\htdocs\\appBuilder" -t 1'); 
```

还要确保`PHP SAFE MODE`设置为`OFF`.

# linux - 如何通过 V4L2 为 USB 网络摄像头枚举所有支持的图像尺寸

> ID：13783650
> 
> 赞同：2
> 
> 时间：2012-12-09T01:01:23.883
> 
> 标签：linux, v4l2

我一直在使用 USB webCam 和 v4l2 API 开发一些视频应用程序。API 提供了许多 ioctl() 调用来枚举通用功能、视频标准、像素颜色格式等。但是没有 ioctl() 来枚举 USB 网络摄像头支持的所有可能的图像大小。

这样做的首选方法是什么？

API 文档说您可以设置特定的图像大小，并且 ioctl() 将返回其最接近的匹配项。所以我想我可以尝试所有可能的图像尺寸，看看 USB 网络摄像头是否会拒绝它。但是，当有这么多标准尺寸格式（QCIF、CIF、4CIF、16CIF、VGA、DV、SVGA、XGA、UVGA、SXGA、UXGA 等）时，枚举所有可能支持的图像尺寸似乎是一种相当低效的方法。

谢谢，

-安德烈斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-11T15:06:48.920

我会回答我自己的问题...

原来我一直在查看 v4l2 上的一些非常古老的文档，其中没有包含任何对 ioctl() 的图像大小参考。较新的文档确实有一个 VIDIOC_ENUM_FRAMESIZES ioctl() 用于枚举所有支持的帧大小。

这个故事的寓意：始终为您打算使用的任何 API 获取最新的文档。对于 video4linux2 使用这个：

[http://linuxtv.org/downloads/v4l-dvb-apis/](http://linuxtv.org/downloads/v4l-dvb-apis/)

-安德烈斯

# entity-framework - 是否有任何免费工具可用于从现有数据库结构生成 POCO、映射和上下文？

> ID：13783653
> 
> 赞同：3
> 
> 时间：2012-12-09T01:01:34.283
> 
> 标签：entity-framework

我开始在我的项目中使用 EF5 Code First，我想创建有界上下文以防止我的系统变得复杂。我想知道，有没有免费的工具可以从现有的数据库结构中生成 POCO、映射和上下文？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-09T01:35:48.090

您可以使用[实体框架电动工具](http://visualstudiogallery.msdn.microsoft.com/72a60b14-1581-4b9b-89f2-846072eff19d)

# javascript - 使用javascript关闭窗口时注销

> ID：13783659
> 
> 赞同：4
> 
> 时间：2012-12-09T01:02:18.387
> 
> 标签：javascript

我在我的 javascript 代码上使用了 window.onbeforeunload，但显然它只适用于 FireFox：

```
 <script type="text/javascript">
    window.onbeforeunload = function (e) {
       location.href="admin.jsp?action=logout";
    };
    </script> 
```

我需要这个来关闭至少 5 个知名浏览器（firefox、IE、opera、safari 和 chrome）。谁能帮我吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-09T01:05:36.427

使用同步 XHR 来执行此操作，并使用 unload 事件而不是 onbeforeunload：

```
window.addEventListener('unload', function() {
    var xhr = new XMLHttpRequest();
    xhr.open('GET', 'admin.jsp?action=logout', false);
    xhr.send(null);
}, false); 
```

# html - 在 ruby on rails if 语句中使用 html 标签

> ID：13783663
> 
> 赞同：3
> 
> 时间：2012-12-09T01:03:08.700
> 
> 标签：html, ruby-on-rails, ruby, if-statement

我的应用程序控制器中有一个方法可以检查用户是否在正确的组中以访问某些功能。

我的问题是，当用户编辑他们自己的帐户设置时，我不希望他们能够编辑他们的组，除非他们是传输组的一部分。目前我有这个

```
 <%= if logged_in_as_transport? %>
   <div class="field">
   <%= f.label :user_type %><br />
   <%= f.select :user_type, [['Transport','1'],['Staff','2']] %>
   </div>  
 <% end %> 
```

我的方法工作正常，因为它用于检查页面上的权限。如果下拉框对其他组不可见但只是被禁用也可以工作，那将是理想的。

上面的代码创建了一个 SyntaxError "unexpected tRPAREN"

```
');@output_buffer.append= ( if logged_in_as_transport? );@output_buffer.safe_concat(' 
```

如果有人可以提供帮助，那就太好了。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-09T01:08:55.903

```
<%= if logged_in_as_transport? %> 
```

应该

```
<% if logged_in_as_transport? %> 
```

语句的`if`条件没有返回值来输出到您的视图的 HTML（这就是您所说的您希望通过使用`<%=`而不是发生的情况`<%`）

# domain-driven-design - 带有 DB id 和实体的值对象的 DDD 类设计困境

> ID：13783666
> 
> 赞同：13
> 
> 时间：2012-12-09T01:03:52.793
> 
> 标签：domain-driven-design, value-objects

这是一个很长的问题，所以我要直奔主题。这是为了更好地说明问题的伪代码

**数据库结构**

用户（用户 ID、姓名、姓氏）

地址(AddressID, UserID, Street, City, State, ZipCode) =>多对一用户关系

Phone (PhoneID, UserID, Number, IsPrimary) =>多对一用户关系

**领域类**

```
class User:IEntity
{
public string Name {get;set;}
public string LastName {get;set;}
public ContactInfo{get;set;}
}

class Phone: IValueObject or IEntity? will see later.
{
public int id; // persistence ID, not domain ID
public string Number {get;set;}
}

class Address: IValueObject or IEntity? will see later.
{
public string Line1 {get;set;}
public string City {get;set;}
public string State {get;set;}
public string ZipCode {get;set;}
}

class ContactInfo: IValueObject or IEntity? will see later.
{
List<Address> Addresses {get;set;}
List<Phone> PhoneNumbers {get;set;}
} 
```

所以，到目前为止，我们对这个领域及其模型有了一个非常基本的表示。

我的问题如下。假设我想更新其中一个地址或修复其中一个数字的区号，因为最初输入的 wnen 拼写错误。

如果我遵循 Evan 关于 DDD 的圣经，值对象应该是不可变的。意思是，在创建后不会更改其属性或字段。如果是这种情况，那么我想，我的所有类都不是 ValueObject，因为我不能仅仅因为电话号码中字符串的一部分错误就重新创建整个 ContactInfo 类。所以，我想这使我所有的类实体？

请记住，我对每个此类都有一个“持久性 ID”，因为它们存储在数据库中。

假设我决定让 Phone 成为一个值对象，因为它很容易在构造函数中重新创建

```
public Phone(string newNumber) 
```

所以，这就像向用户（agg root）和联系人信息添加一个方法？（得墨忒耳定律）

像...

```
User....
public void UpdatePrimaryPhoneNumber(string number)
{
this.ContactInfo.UpdatePrimaryPhoneNumber(number);
}

ContactInfo....
public void UpdatePrimaryPhoneNumber(string number)
{
var oldPhone = Phones.Where(p=>p.IsPrimary).Single();
var newPhone = new Phone(number, oldPhone.persistenceid???-> this is not part of the domain)
oldPhone = newPhone;
} 
```

但我仍然必须处理持久性 id ... grrrrr。真让人头疼。

有时，当我阅读那些博客时，我觉得大多数“ddd 专家”认为价值对象被过度使用，或者我会说被滥用。

这种情况的最佳解决方案是什么？谢谢

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-09T22:46:18.887

> 如果我遵循 Evan 关于 DDD 的圣经，值对象应该是不可变的。意思是，在创建后不会更改其属性或字段。如果是这种情况，那么我想，我的所有类都不是 ValueObject，因为我不能仅仅因为电话号码中字符串的一部分错误就重新创建整个 ContactInfo 类。所以，我想这使我所有的类实体？

虽然 VO 本身可能是不可变的，但 VO 本身并不存在 - 它始终是聚合的一部分。因此，VO 可以是不可变的，但引用该 VO 的对象不一定是。帮助我理解 VO 的是将它们与原始 Int32 值进行比较。每个单独整数的值是不可变的 - 5 始终是 5。但是任何有 Int32 的地方都可以在那里设置另一个值。

对于您的域，这意味着您可以拥有不可变的地址 VO，但给定的使用实体可以引用地址 VO 的任何实例。这将允许进行更正和任何其他更改。您不会更改地址 VO 上的各个字段 - 您将其替换为全新的 VO 实例。

接下来，“Persistence ids”不应该在域代码的任何地方表达。它们的存在只是为了满足关系数据库的需求，而 NoSQL 数据库根本不需要它们。

主要电话场景应该看起来更像这样：

```
public void UpdatePrimaryPhoneNumber(string number)
{
  var existingPrimaryNumber = this.Phones.FirstOrDefault(x => x.IsPrimary == true);
  if (existingPrimaryNumber != null)
      this.Phones.Remove(existingPrimaryNumber);
  this.Phones.Add(new Phone(phoneNumber: number, isPrimary = true));
} 
```

此方法封装了更新现有主电话号码的想法。电话号码 VO 是不可变的这一事实意味着您必须删除现有值并将其替换为新值。数据库端通常会发生什么，特别是对于像 NHibernate 这样的 ORM，它会发出 SQL 删除和随后的插入以有效地替换所有电话号码。这没关系，因为 VO 的 ID 无关紧要。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-12-09T06:58:23.243

一个实体有一个相当独特和独立的生命周期。当它独立存在时，它才有意义。

/的*经典示例*可能对此有所帮助。如果一个成为实体，它将有自己的生命周期。但是，这并没有太大意义，因为它*是*. 这在查看订单时似乎总是很明显，但在查看您自己的类时却不那么明显，因为类之间可能存在一些引用。例如，an代表我们正在销售的一些产品。A有自己的生命周期。我们可以有一个独立的s 列表。我们如何对 an和 the之间的链接进行建模可能是另一个讨论，但我会将我需要的数据非规范化到 the 中并存储原始数据。`Order``OrderItem``OrderItem`*`Order``OrderItem``Product``Product``Product``OrderItem``Product``Product``OrderItem``Product.Id`*

 *那么`Address`类是实体还是值对象？这总是一个有趣的问题，因为我们有最喜欢的答案：这取决于。

它将是特定于上下文的。但是问问自己，你是否有（或需要）一个独立的`Address`s 列表，然后只需要`Address`在你的`User`. 如果是这种情况，那么它就是一个实体。但是，如果您仅在它*是*您的一部分`Address`时才有意义，那么它就是一个值对象。*`User`*

 *值对象是不可变的这一事实并不意味着您需要替换的不仅仅是特定的值对象。我不知道我是否会`ContactInfo`在您当前的设计中有一个类，因为它只包含两个集合（`Address`/ `PhoneNumber`），但如果有更多内容（可能是），我会保留它。所以干脆替换掉相关的`PhoneNumber`。如果您有主/次之类的东西，那么它很简单：

`AR.ReplacePrimaryPhoneNumber(new PhoneNumber('...'))`

如果它是任意数字的列表，则`Remove`/`Add`将是合适的。

现在为了坚持`Id`。你不需要一个。当您有一个主要/次要场景时，您知道您的用例是什么，您可以在数据库中执行相关查询（`PhoneNumber`例如更新主要）。如果您有一个任意列表，您*可以*在我的列表中**添加所有新号码，**并**从数据库中删除那些不在我的列表中的号码**；否则只需删除所有数字并添加您拥有的所有内容。如果这看起来像很多沉重的运动：它是。事件溯源会将其中的很多内容转移到内存处理中，这是我将认真推动的事情。

我希望这一切都有意义。摆脱对事物数据方面的关注是相当困难但必要的。专注于域，就好像您没有数据库一样。当您发现摩擦时，请尽最大努力*不要*将数据库思维引入您的域，而是尝试考虑如何保持域清洁并仍然使用您选择的数据库。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-06-10T13:04:19.543

我将创建一个包含当前 Phone 类的字符串编号的类 PhoneNumber，并将其用作您的 Phone 类中的 Value 对象：

```
class Phone implements IEntity
{
public int id; // persistence ID, not domain ID
public PhoneNumber number {get;set;}
}

class PhoneNumber implements IValueObject
{
public String number {get;set;};
} 
```

稍后当您的代码发展时，您将需要（例如）电话号码验证，您可以将其放在 PhoneNumber 类中。然后可以在不同的地方在整个应用程序中重用这个类。

在我看来，地址是一个值对象，您可以将其视为一个整体。尽管您可以对通常为实体的 Street、City 等进行建模，但这可能是过度建模。地址的任何部分都不能更改，在初始创建后更改时始终替换整个对象。

User 类在这个例子中，这些边界是一个聚合根（因此也是一个实体）。ContactInfo 类不是 ValueObject（不是不可变的），也不是 Entity（没有真实身份），而是一个 Aggregate。它包含多个类，应将其视为一个整体。

[有关http://martinfowler.com/bliki/DDD_Aggregate.html](http://martinfowler.com/bliki/DDD_Aggregate.html)的更多信息

通常，只要有持久性 ID，您就应该考虑一个实体。但是，如果您想添加持久性 ID，我会像 Phone 和 PhoneNumber 类一样开始拆分。例如，包含所有其他字段（以及有关地址值的逻辑）的地址（包含 id 的实体）和地址值。

这也应该解决管理持久性标识的难题，因为您替换了整个值对象，并且在 updatePrimaryPhoneNumber 的情况下持久性标识保持不变。**

# visual-studio-2012 - 安装 VS2012 更新 1 后添加参考对话框不起作用

> ID：13783667
> 
> 赞同：2
> 
> 时间：2012-12-09T01:04:02.480
> 
> 标签：visual-studio-2012

我安装了 Visual Studio 2012 Update 1，现在我无法添加对任何项目的引用。

“添加参考”对话框根本不会打开。

ActivityLog.xml 包含以下错误：

```
550  Begin package load [ReferenceManagerPackage] {48D4A2C1-02AD-4F18-9153-620511BACB7B}  VisualStudio 2012/12/09 00:39:58.544 
551 ERROR CreateInstance failed for package [ReferenceManagerPackage] {48D4A2C1-02AD-4F18-9153-620511BACB7B} 80131522 VisualStudio 2012/12/09 00:39:58.575 
552 ERROR End package load [ReferenceManagerPackage] {48D4A2C1-02AD-4F18-9153-620511BACB7B} 80004005 - E_FAIL VisualStudio 2012/12/09 00:39:58.575 
```

我在 VS2012 Professional 上。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T19:25:45.963

根据 Visual Studio 设置和安装论坛的[建议](http://social.msdn.microsoft.com/Forums/en-US/vssetup/thread/7750703d-c7b8-4cd8-bc5a-f0ba3ac27b40)，我卸载并重新安装了 Visual Studio，问题暂时消失了......

请注意，我在卸载 Visual Studio 时遇到了困难，我猜安装已损坏，但是是什么原因造成的？

# mysql - 下一个连接中的MYSQL未知子句连接列

> ID：13783669
> 
> 赞同：1
> 
> 时间：2012-12-09T01:04:46.863
> 
> 标签：mysql, sql, database, clause

我有以下查询：

```
SELECT * FROM questions 
LEFT JOIN answers ON (questions.id = answers.id AND (connections.username = answers.username OR connections.username = 'bob' OR answers.username IS NULL))
LEFT JOIN connections ON connections.username1 = 'mikha' AND
                         (connections.username2 = answers.username) 
LEFT JOIN answers answers2 ON (questions.id = answers2.id)
WHERE (answers.id <> answers2.id) 
```

我收到以下错误：

```
`Unknown connections.username in ON clause` 
```

我在第一次加入时定义了一些条件，并希望得到与这些条件不匹配的其余条件。这就是我使用这部分的原因`answers.id AND answers2.id`。获取与第一个左连接中的条件不匹配的 ID。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T02:12:44.190

实际上，如果您通过连接结果限制答案的结果，那么您正在执行内部连接而不是两个左连接，因为一行无法返回而另一行没有结果，因为 null 不等于 null。鉴于这是真的，您可以使用以下内容，因为我不知道您的架构是什么所有架构都是为了保护无辜者而组成的。

```
SELECT * FROM questions 
left join (
    select connections.otherstuff,answers.id,answers.text from connections 
    inner join answers ON  connections.username2 = answers.username
    where connections.username1 = 'mikha'
 ) conn on questions.id = conn.id 
```

[http://sqlfiddle.com/#!2/c7252/1](http://sqlfiddle.com/#!2/c7252/1)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-09T01:26:19.660

像这样尝试，我没有自己测试的架构，但我觉得它应该可以工作（或类似的东西）

```
SELECT * FROM questions, connections
LEFT JOIN answers ON (questions.id = answers.id AND
                     connections.username2 = answers.username)
where connections.username1 = 'mikha'; 
```

最终像这样

```
SELECT * FROM questions
LEFT JOIN answers ON (questions.id = answers.id)
LEFT JOIN connections ON (connections.username2 = answers.username)
where connections.username1 = 'mikha'; 
```

编辑：我在文档中找到了这个

> 例子：
> 
> 创建表 t1 (i1 INT); 创建表 t2 (i2 INT); 创建表 t3 (i3 INT); SELECT * FROM t1 加入 t2 ON (i1 = i3) 加入 t3;
> 
> 以前，SELECT 语句是合法的。现在语句失败，出现 Unknown >column 'i3' in 'on Clause' 错误，因为 i3 是 t3 中的列，它不是 >the ON 子句的操作数。该语句应改写如下：
> 
> SELECT * FROM t1 加入 t2 加入 t3 ON (i1 = i3);

所以对于你的情况，它可能是

```
SELECT * FROM questions  
LEFT JOIN connections
LEFT JOIN answers ON (connections.username1 = 'mikha' AND questions.id = answers.id AND
                 connections.username2 = answers.username) 
```

# r - r中的for循环-无法获得大于1的第一个值

> ID：13783670
> 
> 赞同：1
> 
> 时间：2012-12-09T01:04:57.963
> 
> 标签：r, for-loop

我正在尝试在 r 中编写一个 for 循环，该循环遍历我从 1970 年开始的数据。我想自己循环多年，这样我每年都会在数据中进行迭代并存储数据（投票份额，向量中的在职状态等）。显然，由于我的数据从 1970 年开始，我不希望值小于 1970 年，但是，下面的脚本在位置 1-16 中生成一个向量，在位置 17-1969 中生成 NA，然后我认为是预期的1970-2000 年偶数年的统计数据和奇数年的 NA。我如何让它只返回我想要的值（甚至是 1970-2000 年？）位置 1-16 中的 0 值是怎么回事？

incumb.data 是包含投票份额、在职状态、按年份和州的选举结果的数据框。

\脚本：

```
J<-seq(1970, 2000,2)
inc.fx1<-vector(length=length(J))
year.df1<-vector(length=length(J))

for (j in 1970:J){
  state.hold<-incumb.data[StateNumb3==26,]
  yr.hold<-state.hold[state.hold$V6==j,]

  St28.df<-data.frame(year=yr.hold$V6, 
                      v_1=yr.hold$v_1, v_2=yr.hold$v_2,
                      I1=yr.hold$I1, I2=yr.hold$I2,
                      P2=yr.hold$P2)

  St28.lm<-lm(v_2~v_1+I2+P2, data=St28.df)
  inc.fx1[j]<-coef(St28.lm)[3]
  year.df1[j]<-St28.df$year
} 
```

\结束脚本

所以我希望 inc.fx1 保存偶数年 1970-2000 的计算统计数据。感谢您的帮助。

BG

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-09T01:17:32.513

J 是一个向量，您可以直接对其进行迭代。

替换这个（应该给出警告）：

```
for (j in 1970:J){   # ... 
```

有了这个：

```
for (j in J){   # ... 
```

# ajax - 从 ajax 调用加载 Dojo 表单

> ID：13783671
> 
> 赞同：1
> 
> 时间：2012-12-09T01:05:10.307
> 
> 标签：ajax, zend-framework, dojo

我正在尝试实现这样的东西。 [http://app.maqetta.org/mixloginstatic/LoginWindow.html](http://app.maqetta.org/mixloginstatic/LoginWindow.html)

我希望加载登录页面，但是如果您单击注册按钮，那么 ajax 将用注册表单替换登录表单。

我已经使用此代码使其工作

```
dojo.xhrGet({
        // The URL of the request
        url: "'.$url.'",
        // The success callback with result from server
        load: function(newContent) {
            dojo.byId("'.$contentNode.'").innerHTML = newContent;
        },
        // The error handler
        error: function() {
            // Do nothing -- keep old content there
        }
    });' 
```

唯一的问题是新表单只是作为普通表单加载，而不是 dojo 表单。我试图用移相器返回一些脚本，但它没有做任何事情。

```
<div id="loginBox"><div class="instructionBox">Please enter your details below and click <a><strong>signup</strong>
    </a> to have an activation email sent to you.</div>
    <form enctype="application/x-www-form-urlencoded" class="site-form login-form" action="/user/signup" method="post"><div>
    <dt id="emailaddress-label"><label for="emailaddress" class="required">Email address</label></dt>
    <dd>
    <input 0="Errors" id="emailaddress" name="emailaddress" value="" type="text"></dd>
    <dt id="password-label"><label for="password" class="required">Password</label></dt>
    <dd>
    <input 0="Errors" id="password" name="password" value="" type="password"></dd>
    <dt id="captcha-input-label"><label for="captcha-input" class="required">Captcha Code</label></dt>
    <dd id="captcha-element">
    <img width="200" height="50" alt="" src="/captcha/d7849e6f0b95cad032db35e1a853c8f6.png">
    <input type="hidden" name="captcha[id]" value="d7849e6f0b95cad032db35e1a853c8f6" id="captcha-id">
    <input type="text" name="captcha[input]" id="captcha-input" value="">
    <p class="description">Enter the characters shown into the field.</p></dd>
    <dt id="submitButton-label">&nbsp;</dt><dd id="submitButton-element">
    <input id="submitButton" name="submitButton" value="Signup" type="submit"></dd>
    <dt id="cancelButton-label">&nbsp;</dt><dd id="cancelButton-element">
    <button name="cancelButton" id="cancelButton" type="button">Cancel</button></dd> 
       </div></form>

    <script type="text/javascript">

            $(document).ready(function() {

                var widget  = dijit.byId("signup");

                if (widget) {
                   widget.destroyRecursive(true);
                } 

                dojo.parser.instantiate([dojo.byId("loginBox")]); 
                dojo.parser.parse(dojo.byId("loginBox"));
            });

            </script></div> 
```

关于如何将其加载为 dojo 表单的任何建议。顺便说一句，我正在使用 Zend_Dojo_Form，如果我直接运行代码，那么一切正常，但通过 ajax 它不起作用。谢谢。

* * *

更新

我发现如果我在我的操作中加载表单并在其上运行 __toString() ，当我从 ajax 加载表单时它会起作用。它必须在 __toString() 中做准备

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T10:41:03.567

Firstly; You need to run the dojo parser on html, for it to accept the data-dojo-type (fka dojoType) attributes, like so:

```
dojo.parser.parse( dojo.byId("'.$contentNode.'") ) 
```

This will of course only instantiate dijits where the dojo type is set to something, for instance (for html5 1.7+ syntax) `<form data-dojo-type="dijit.form.Form" action="index.php"> ... <button type="submit" data-dojo-type="dijit.form.Button">Send</button> ... </form>`.

So you need to change the ajax contents which is set to innerHTML, so that the parser reckognizes the form of the type dijit.form.Form. That said, I urge people into using a complete set of dijit.form.* Elements as input fields.

In regards to:

```
$(document).ready(function() {}); 
```

This function will never get called. The `document`, youre adding innerHTML to, was ready perhaps a long time a go.

About Zend in this issue:

Youre most likely rendering the above output form from a `Zend_` Dojo type form. If the renderer is set as `programmatic`, you will see above html a script containing a registry for ID=>dojoType mappings. The behavior when inserting `<script>` as an innerHTML attribute value, the script is not run under most circumstances (!).

You should try something similar to this pseudo for your form controller:

if request is ajax dojoHelper set layout `declarative`
else dojoHelper set layout `programmatic`

# c# - 检查 Page.RouteData.Values 是否有值

> ID：13783675
> 
> 赞同：2
> 
> 时间：2012-12-09T01:06:04.760
> 
> 标签：c#, asp.net, routes

运行时出现错误

```
string quote = Page.RouteData.Values["quote"].ToString() ?? string.Empty; 
```

*错误：对象引用未设置为对象的实例。*

我了解 ToString 导致错误，因为 Page.RouteData.Values["quote"] 为空/空。

在执行 ToString 之前，如何检查**Page.RouteData.Values** ["quote"] 是否有值？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-09T01:10:10.457

怎么样：

```
if (Page.RouteData.Values["quote"] != null) {
    string quote = Page.RouteData.Values["quote"].ToString() ?? string.Empty;
} 
```

或者

```
string quote = ((Page.RouteData.Values["quote"] != null) ? Page.RouteData.Values["quote"].ToString() : string.Empty); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-09-11T10:47:22.993

尝试这个

```
var quote = Page.RouteData.Values["quote"]?.ToString() ?? string.Empty; 
```

# facebook - 在 FQL 中过滤日期的 facebook 事件

> ID：13783677
> 
> 赞同：1
> 
> 时间：2012-12-09T01:06:23.160
> 
> 标签：facebook, facebook-fql

我正在使用一个相当简单的 FQL 查询来按页面查询所有事件。

```
SELECT 
   eid, name, pic_big, start_time, end_time, location, description 
   , creator, host, venue
FROM 
   event
WHERE 
   eid IN ( SELECT eid FROM event_member WHERE uid = {$uid} ) 
ORDER BY start_time asc 
```

在 facebook 存储它的时间`start_time`和`end_time`时间戳中，仅获取未来事件很简单：`... AND end_time >= {$now} ...`

但是 facebook 以时区格式更改了它的字段。 **有没有一种简单的方法，最好是在 fql 中，只显示未来的事件？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T09:11:24.310

除非我误解了您的问题，否则我只是在[Facebook Graph API 和 FQL Explorer](https://developers.facebook.com/tools/explorer)上尝试过，它似乎可以工作。

我对您的查询所做的唯一更改是分别替换`{$uid}`和`{$now}`替换`me()`和`now()`。以下查询仅返回我帐户的未来事件：

```
SELECT eid, name, pic_big, start_time, end_time, location, description, creator, host, venue
FROM event
WHERE eid
IN (SELECT eid FROM event_member WHERE uid = me())
AND start_time >= now() 
```

您可以在以下位置查看此操作：[Facebook Graph API Explorer Example](https://developers.facebook.com/tools/explorer?fql=SELECT%20eid,%20name,%20pic_big,%20start_time,%20end_time,%20location,%20description,%20creator,%20host,%20venue%0AFROM%20event%0AWHERE%20eid%0AIN%20%28SELECT%20eid%20FROM%20event_member%20WHERE%20uid%20=%20me%28%29%29%0AAND%20start_time%20%3E=%20now%28%29) 当然，请确保您为 Explorer 提供了您帐户的有效访问令牌。

# knockout.js - KnockoutJS - 对 ko.computed 和 AJAX 请求的不满

> ID：13783679
> 
> 赞同：14
> 
> 时间：2012-12-09T01:07:10.363
> 
> 标签：knockout.js, knockout-2.0

我只是想从 ajax 请求中提取一些数据。ajax 调用有效 - 我知道数据已被检索。但它只是没有设置 ko.computed 的值......

```
 function viewModel() {
            this.Id = ko.observable("@Model.Identity()");
            this.Points = ko.computed({ 
                read: function () {
                    $.ajax({
                        url: '/skills/points',
                        data: { id: this.Id },
                        type: 'get',
                        success: function (data) {
                            return data;
                        }
                    });
                },
                owner: this
            });
        } 
```

所以像...这样的电话

```
<span data-bind="text: Points"></span> 
```

只是不工作。谁能帮我弄清楚我做错了什么？

## 更新

我正在使用以下代码，遵循 RPN 的建议 - 我根本无法让它发挥作用。它不会查看控制器，也不会返回数据……它什么也不做。我已经尝试了所有三个示例，但均未成功。

```
<script type="text/javascript">
    //an observable that retrieves its value when first bound
    ko.onDemandObservable = function (callback, target) {
        var _value = ko.observable();  //private observable

        var result = ko.computed({
            read: function () {
                //if it has not been loaded, execute the supplied function
                if (!result.loaded()) {
                    callback.call(target);
                }
                //always return the current value
                return _value();
            },
            write: function (newValue) {
                //indicate that the value is now loaded and set it
                result.loaded(true);
                _value(newValue);
            },
            deferEvaluation: true  //do not evaluate immediately when created
        });

        //expose the current state, which can be bound against
        result.loaded = ko.observable();
        //load it again
        result.refresh = function () {
            result.loaded(false);
        };

        return result;
    };

    $(document).ready(function () {
        function User(id, name) {
            this.Id = ko.observable(id);
            this.Name = ko.observable(name);
        }
        function viewModel() {
            var self = this;

            this.User = ko.onDemandObservable(this.Update, this);

            this.Update = function () {
                return $.ajax({
                    url: '/home/user/',
                    data: { id: 1 },
                    dataType: 'json'
                }).pipe(function (data) {
                    return new User(data.Id, data.Name);
                });
            };
        };
        var model = new viewModel();
        ko.applyBindings(model);
        model.User();
    });
</script>

<span data-bind="text: User.Name"></span> 
```

## 更新 (2)

按照更多说明，我缩小了一些问题的范围。将 viewModel定义`callback`为函数似乎不起作用（我不确定为什么），但声明内联函数确实会产生......不同的东西。仍然无法正常工作。这是一个更新。

```
<script type="text/javascript">
    //an observable that retrieves its value when first bound
    ko.onDemandObservable = function (callback, target) {
        var _value = ko.observable();  //private observable

        var result = ko.computed({
            read: function () {
                //if it has not been loaded, execute the supplied function
                if (!result.loaded()) {
                    callback.call(target);
                }
                //always return the current value
                return _value();
            },
            write: function (newValue) {
                //indicate that the value is now loaded and set it
                result.loaded(true);
                _value(newValue);
            },
            deferEvaluation: true  //do not evaluate immediately when created
        });

        //expose the current state, which can be bound against
        result.loaded = ko.observable();
        //load it again
        result.refresh = function () {
            result.loaded(false);
        };

        return result;
    };

    $(document).ready(function () {
        function User(id, name) {
            this.Id = ko.observable(id);
            this.Name = ko.observable(name);
        }
        function viewModel() {
            var self = this;

            this.User = ko.onDemandObservable(function(){
                $.ajax({
                    url: '/home/user/',
                    data: { id: 1 },
                    dataType: 'json',
                    success: function (data) {
                        self.User(new User(data.Id, data.Name));
                    }
                });
            }, this);

            //this.Update = function () {
            //  $.ajax({
            //      url: '/home/user/',
            //      data: { id: 1 },
            //      dataType: 'json',
            //      success: function (data) {
            //          self.User(new User(data.Id, data.Name));
            //      }
            //  });
            //};
        };
        var model = new viewModel();
        ko.applyBindings(model);
        model.User();
    });
</script> 
```

然后尝试显示检索到的任何数据仍然失败。

```
<span data-bind="text: User.Name"></span> 
```

## 更新 (3)

有点突破！如果我将声明性绑定更改为如下所示..

```
<span data-bind="with: User">
    <span data-bind="text: Id"></span>
    <span data-bind="text: Name"></span>
</span> 
```

然后我开始看到结果。我想我快到了……

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-12-09T01:26:15.570

正如 SLaks 指出的那样，由于调用是异步进行的，因此您不能这样做，即“读取”函数在检索到响应之前返回。我会推荐这样的东西：

```
function viewModel() {
    var self = this;
    this.Id = ko.observable("@Model.Identity()");
    this.Points = ko.observable(0);

    var refreshPoints = function() {
        $.ajax({
            url: '/skills/points',
            data: { id: self.Id() }, // <-- you need () here!
            type: 'get',
            success: function (data) {
                self.Points(data);
            }
        });
    };

    // Now subscribe to the ID observable to update the points whenever the 
    // ID gets changed:
    this.Id.subscribe(refreshPoints);
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-03-13T16:18:00.530

只需将一个可观察变量绑定到 html 变量并在 ko.computed 字段中更新该字段。不要直接将 ko.computed 字段绑定到 html 变量。

```
self.htmlUserName = ko.observable();

self.computedUserName = ko.computed(function () {
    $.ajax(
    ....
    success: function (result) {
    self.htmlUserName(result);
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-09T01:25:25.293

Knockout 绑定不支持异步计算。

相反，您应该使用常规属性并将其设置为 AJAX 请求的结果。
您可以通过在依赖属性的更改处理程序中重新发送 AJAX 请求来使其可观察。

您还可以使用单独的占位符值将加载指示器添加到绑定的 UI。

# c++ - 如何访问 UPnP 设备的服务？

> ID：13783680
> 
> 赞同：6
> 
> 时间：2012-12-09T01:07:12.877
> 
> 标签：c++, windows, com, upnp

设备：Belkin Wemo Switch
开发环境：MS VC++ 2010 on Windows7

我正在尝试使用 Windows 中的 C++ 枚举 UPnP 设备的服务。

我有`IUPnPDevice`指针，可以访问多个属性。
我有`IUPnPServices`指针，可以计算正确的服务数量（7）。
我`QueryInterface()`用来获取`IEnumVARIANT`指针（似乎成功）。
但是，该方法总是以of -`Next()`失败，转换为. 这个错误对我没有任何意义。`HRESULT``0x80040500``Windows error 1280 (0x500) - ERROR_ALREADY_FIBER`

（我已经尝试同时使用`IEnumVARIANT`和`IEnumUnknown`- 正如文档指出的那样，它可能是任何一个，但两者都会产生相同的结果。）

我在下面包含了完整的源文件，以及它产生的输出。
[注意：使用我自己设备的 udn 是硬编码的]

如果有人能提供帮助，我将不胜感激，因为我目前陷入困境。

最好的问候，
戴夫

代码：

```
// UpnpTest1.cpp : Defines the entry point for the console application.
//

#include "stdafx.h"

#include <windows.h>
#include <upnp.h>

static void DumpComError(const TCHAR *api, HRESULT hr);

int _tmain(int argc, _TCHAR* argv[])
{
  int retcode=-1; // assume failure

  HRESULT hr = CoInitialize(0);
  if (hr==S_OK)
  {
    IUPnPDeviceFinder *deviceFinder=0;
    hr = CoCreateInstance(CLSID_UPnPDeviceFinder, 0, CLSCTX_INPROC_SERVER, IID_IUPnPDeviceFinder, (void**)&deviceFinder);
    if (hr==S_OK)
    {
      IUPnPDevice *device=0;
      hr = deviceFinder->FindByUDN(L"uuid:Socket-1_0-221239K11002F6", &device);
      if (hr==S_OK)
      {
        if (device)
        {
          TCHAR *manufacturer=0, *manufacturerUrl=0;
          TCHAR *description=0, *name=0, *modelUrl=0;
          TCHAR *serialNumber=0, *udn=0, *upc=0, *deviceType=0;
          TCHAR *presentationUrl=0;

          device->get_ManufacturerName(&manufacturer);
          device->get_ManufacturerURL(&manufacturerUrl);
          device->get_Description(&description);
          device->get_FriendlyName(&name);
          device->get_ModelURL(&modelUrl);
          device->get_SerialNumber(&serialNumber);
          device->get_UniqueDeviceName(&udn);
          device->get_UPC(&upc);
          device->get_Type(&deviceType);
          device->get_PresentationURL(&presentationUrl);

          _tprintf(_T("MANUFACTURER: %s [%s]\n"), manufacturer, manufacturerUrl);
          _tprintf(_T("MODEL:        %s [%s]\n              [%s]\n"), description, name, modelUrl);
          _tprintf(_T("DEVICE:       serial=%s\n              udn=%s\n              upc=%s\n              type=%s\n"), serialNumber, udn, upc, deviceType);
          _tprintf(_T("URL:          %s\n"), presentationUrl);

          IUPnPServices *services=0;
          hr = device->get_Services(&services);
          if (hr==S_OK)
          {
            if (services)
            {
              long numberOfServices=0;
              services->get_Count(&numberOfServices);

              if (numberOfServices>0)
              {
                IUnknown *unknown=0;
                hr = services->get__NewEnum(&unknown);
                if (hr==S_OK)
                {
                  if (unknown)
                  {
                    IEnumVARIANT *enumInterface=0;
                    hr = unknown->QueryInterface(IID_IEnumVARIANT,(void**)&enumInterface);
                    if (enumInterface)
                    {
                      VARIANT var;
                      unsigned long fetched=0;
                      hr = enumInterface->Next(1, &var, &fetched);

                      if (hr==S_OK)
                      {

                      }
                      else
                        DumpComError(_T("IEnumVARIANT::Next"), hr);
                    }
                    else
                      DumpComError(_T("IUnknown::QueryInterface"), hr);
                  }
                  else
                    fprintf(stderr, "Failed to get enumeration interface.\n");
                }
                else
                  DumpComError(_T("IUPnPServices::get__NewEnum"), hr);
              }
              else
                fprintf(stderr, "No services available.\n");
            }
            else
              fprintf(stderr, "Failed to get services collection.\n");
          }
          else
            DumpComError(_T("IUPnPDevice::get_Services"), hr);
        }
        else
          fprintf(stderr, "Device not found.\n");
      }
      else
        DumpComError(_T("IUPnPDeviceFinder::FindByUDN"), hr);
    }
    else
      DumpComError(_T("CoCreateIndex"), hr);
  }
  else
    DumpComError(_T("CoInitialize"), hr);

  return retcode;
}

static void AddBoolToString(const TCHAR *name, bool value, TCHAR *buf, int &i, int max)
{
  if (name && *name && value && buf && i>=0)
    i += _snwprintf_s(&buf[i], max-i, (max-i-1)*sizeof(TCHAR), _T("%s%s=YES"), (i>0? _T("; "): _T("")), name);
}

static void AddIntToString(const TCHAR *name, int value, TCHAR *buf, int &i, int max)
{
  if (name && *name && value && buf && i>=0)
    i += _snwprintf_s(&buf[i], max-i, (max-i-1)*sizeof(TCHAR), _T("%s%s=%d"), (i>0? _T("; "): _T("")), name, value);
}

static void DumpComError(const TCHAR *api, HRESULT hr)
{
  bool failure   = (hr&0x80000000? true: false);
  bool severe    = (hr&0x40000000? true: false);
  bool microsoft = (hr&0x20000000? false: true);
  bool ntStatus  = (hr&0x10000000? true: false);
  bool xBit      = (hr&0x08000000? true: false);
  int facility   = (hr&0x07FF0000)>>16;
  int code       = (hr&0x0000FFFF);

  TCHAR buf[1024]={0};
  int bufsize = sizeof(buf)/sizeof(TCHAR);
  int i=0;

  AddBoolToString(_T("failure"), failure, buf, i, bufsize);
  AddBoolToString(_T("severe"), severe, buf, i, bufsize);
  AddBoolToString(_T("microsoft"), microsoft, buf, i, bufsize);
  AddBoolToString(_T("ntStatus"), ntStatus, buf, i, bufsize);
  AddBoolToString(_T("xBit"), xBit, buf, i, bufsize);
  AddIntToString(_T("facility"), facility, buf, i, bufsize);
  AddIntToString(_T("code"), code, buf, i, bufsize);

  _ftprintf(stderr, _T("\n%s() failed, hr=0x%08x\n[%s]\n"), api, hr, buf);
} 
```

输出：它产生以下输出：

```
MANUFACTURER: Belkin International Inc. [http://www.belkin.com/]
MODEL:        Belkin Plugin Socket 1.0 [WeMo Switch]
              [http://www.belkin.com/plugin/]
DEVICE:       serial=221239K11002F6
              udn=uuid:Socket-1_0-221239K11002F6
              upc=123456789
              type=urn:Belkin:device:controllee:1
URL:          http://192.168.1.16:49153/pluginpres.html

IEnumVARIANT::Next() failed, hr=0x80040500
[failure=YES; microsoft=YES; facility=4; code=1280] 
```

**编辑：**

在经历了很多死胡同之后，我设法通过手动构建 SOAP 请求并使用 Windows 套接字通过 TCP 发送请求来完成这项工作。棘手的一点是让语法恰到好处，因为我以前没有使用 SOAP 的经验。[UPnP 有助于识别 IP 地址和端口号 - 因为这些可能会改变]。一旦启动并运行 - 它实际上比 UPnP 界面简单得多。如果您有兴趣，请告诉我，我可以发布代码......它没有直接回答我在这里提出的问题，所以用这个细节回答我的问题是没有意义的。

但是，如果您有兴趣，请告诉我，我可以发布代码。

干杯，
戴夫

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-11T23:27:25.533

0x80040500 的 HRESULT 不是您的想法，而是[UPNP_E_INVALID_DOCUMENT](http://vdfwinapi.googlecode.com/svn/trunk/Include/UPnP.Idl)。有关如何可能出现这种歧义的解释，请参阅[我在另一个 SO question 中的回答](https://stackoverflow.com/a/12536989/886653)。

我的猜测是您的 Belkin 设备提供了不符合要求的设备描述或服务描述 XML。不符合并不一定意味着格式不正确，UPnP 规范有大量的次要要求。尝试 Intel Developer Tools 中的 Device Spy（另一个答案底部的链接），如果设备弹出，则从其上的同一套件运行 Device Validator。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-12-31T19:21:22.040

我的经验是相似的，因为 UPnPDeviceFinder 根本不起作用。它从不发送 UPnP 搜索数据包，因此设备不响应​​。让它工作的唯一方法是，如果您还使用 Windows 媒体播放器或“Cast To Device”菜单（即 WMP）来启动搜索。因为它是 UPnPDeviceFinder 将返回一些设备，只有当它们恰好在那个时刻正在广播时，但是即使在没有其他活动的情况下找到 XBox（另一个 Microsoft 产品）在示例中也不起作用。

# node.js - layout.jade 不工作，为什么？

> ID：13783687
> 
> 赞同：2
> 
> 时间：2012-12-09T01:09:19.147
> 
> 标签：node.js, express, pug

这是我的配置文件：layout.jade 似乎不起作用。但玉在起作用。我使用 Chrome 进行检查，并确定布局 HTML 未加载到页面中。

```
module.exports = function(app, express, mongoose){
    var config=this

    app.configure(function (){
        app.set('views',__dirname+'/views')
        app.set('view engine','jade')
        app.set('view options', {layout:true})

        app.use(express.bodyParser())
        app.use(express.methodOverride())
        app.use(express.cookieParser())
        app.use(express.session({secret: 'topsecret',store: new express.session.MemoryStore}))
        app.use(express.static(app.path.join(app.application_root,"public")))
        app.use(express.errorHandler({dumpExceptions:true,showStack:true}))
        app.use(express.bodyParser({keepExtensions: true, uploadDir:"./public/uploads"}))
        app.use(app.router)
    })

    /*DB part:*/
    app.mongoose.connect('mongodb://localhost/dio_database')

    return config
} 
```

渲染命令：

```
app.get('/items/:id',function(req,res){
    models.ItemModel.findOne({_id:req.params.id}).exec(function(err,item){
        if (!err){
            res.render('item.jade',item)
        } else
            return console.log(err)
    })
}) 
```

我的 layout.jade，很简单：

```
!!!
doctype 5
html
    head
        title "Dio"
        link(rel='icon', href='favicon.ico', type='image/x-icon')
        link(rel='shortcut', href='favicon.ico', type='image/x-icon')
        link(rel="shortcut", href="favicon.ico", type="image/vnd.microsoft.icon")
        link(rel="icon", href="favicon.ico", type="image/vnd.microsoft.icon")

        script(src="http://ajax.googleapis.com/ajax/libs/jquery/1.8/jquery.min.js")
        script(src="http://ajax.cdnjs.com/ajax/libs/json2/20110223/json2.js")
        script(src="./javascripts/underscore-min.js")
        script(src="./javascripts/backbone-min.js")

        link(rel='stylesheet', href='./css/main.css', type="text/css", media="screen")
    body
        div#topbar Dio--where shitty thing happens
        div#main!= body
            footer
                p
                    | Node.js MVC template by XXX 
```

以下是我的 npm 列表：

```
├─┬ bcrypt@0.7.3
│ └── bindings@1.0.0
├─┬ express@3.0.3
│ ├── commander@0.6.1
│ ├─┬ connect@2.7.0
│ │ ├── bytes@0.1.0
│ │ ├── formidable@1.0.11
│ │ ├── pause@0.0.1
│ │ └── qs@0.5.1
│ ├── cookie@0.0.5
│ ├── cookie-signature@0.0.1
│ ├── crc@0.2.0
│ ├── debug@0.7.0
│ ├── fresh@0.1.0
│ ├── methods@0.0.1
│ ├── mkdirp@0.3.3
│ ├── range-parser@0.0.4
│ └─┬ send@0.1.0
│   └── mime@1.2.6
├── fs@0.0.0
├── imagemagick@0.1.3
├─┬ jade@0.27.7
│ ├── coffee-script@1.4.0
│ ├── commander@0.6.1
│ └── mkdirp@0.3.4
├─┬ mongodb@1.2.2
│ └── bson@0.1.5
├─┬ mongoose@3.4.0
│ ├── hooks@0.2.1
│ ├─┬ mongodb@1.1.11
│ │ └── bson@0.1.5
│ ├── ms@0.1.0
│ └── sliced@0.0.3
├─┬ node-static@0.6.5 extraneous
│ ├── colors@0.6.0-1
│ └─┬ optimist@0.3.5
│   └── wordwrap@0.0.2
└── path@0.4.9 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-12T20:51:28.217

其实这个问题的原因很简单：Express 3 不再支持布局..但不要难过。实际上 Express 3 开始采用一种更自然、更简单的方式，称为**block/extends**。基本用法应该是这样的：

```
// In layout file: layout.jade
html 
    head
        title XXX
        block scripts
    body
        block content
        block footer

// in a extended file, for example index.jade:
extends layout
block scripts
    //write javascript part
block content
    // write content
block footer
    // write the footer 
```

它实际上变得更容易和更灵活。很高兴终于得到它。但是我花了2个多小时。

我只是想知道为什么很少有人更清楚、更公开地提到这一变化。希望这篇文章可以帮助像我这样的人。

# java - 二叉树插入 3

> ID：13783688
> 
> 赞同：-1
> 
> 时间：2012-12-09T01:09:34.950
> 
> 标签：java

我正在尝试编写自己的二叉树，但插入时遇到问题。树中的值是重复的。我有带有“节点右、左和 int 值”字段的内部静态类 Node 和带有一个字段的外部类 BinaryTree - 节点根。

插入代码：

```
public void insert(int number) {
    if (root.isEmpty())
        root.value = number;
    else {
        Node node = root;
        insert(number, node);
    }
}

private void insert(int number, Node node) {
    if (number < node.value && node.left != null) {
        node = node.left;
        insert(number, node);
    } else {
        if (node.left == null)
            node.left = new Node(null, null, number);
    }

    if (number > node.value && node.right != null) {
        node = node.right;
        insert(number, node);
    } else {
        if (node.right == null)
            node.right = new Node(null, null, number);
    }
} 
```

我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T01:23:46.260

假设您有一个名为 X 的节点作为根。您正在插入一些数字

```
if (number < node.value && node.left != null) {
    node = node.left; // NODE IS NOW Y
    insert(number, node);
} 
```

现在它进入下一个 if 语句

```
if (number > node.value && node.right != null) {
    node = node.right;
    insert(number, node);
} else {
    if (node.right == null)
        node.right = new Node(null, null, number);
} 
```

节点现在等于 Y 并且没有子节点。所以 node.right==null。所以这个数字被重新插入为 Y 的右孩子。

所以存在该号码的副本。使用 return 解决它。

```
private void insert(int number, Node node) {
    if (number < node.value && node.left != null) {
        node = node.left;
        insert(number, node);
        return;
    } 
    else {
        if (node.left == null)
            node.left = new Node(null, null, number);
        return;
    }

    if (number > node.value && node.right != null) {
        node = node.right;
        insert(number, node);
        return;
    }
    else {
        if (node.right == null)
            node.right = new Node(null, null, number);
        return;
    }
} 
```

# css - 更少的带有自动完成功能的 CSS 编辑器？

> ID：13783689
> 
> 赞同：3
> 
> 时间：2012-12-09T01:09:38.487
> 
> 标签：css, less

有没有什么`LESS CSS`编辑软件。

`Note`: 我想要具有自动完成功能的软件。

请帮助您的建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T01:12:39.923

如果你使用 Visual Studio，这个扩展对 LESS 有很好的支持：

[http://visualstudiogallery.msdn.microsoft.com/07d54d12-7133-4e15-becb-6f451ea3bea6](http://visualstudiogallery.msdn.microsoft.com/07d54d12-7133-4e15-becb-6f451ea3bea6) http://visualstudiogallery.msdn.microsoft.com/6ed4c78f-a23e-49ad-b5fd-369af0c2107f

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-09T01:14:51.950

我使用[PHPStorm](http://www.jetbrains.com/phpstorm/features/)来满足我所有与 Web 相关的编码需求，它支持 LESS 自动完成就好了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-09T01:45:39.773

试试[Sublime Text 2](http://www.sublimetext.com/2)

他们有许多有用的软件包要安装，其中之一是 All Autocomplete。我认为它会适合你正在寻找的东西。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-09T10:15:02.753

[浓缩咖啡](http://macrabbit.com/espresso)的[糖](https://github.com/mkoistinen/LESS.sugar)少（天哪，我一直想用愚蠢的口音说：-）

它具有自动完成支持。

安装很简单：

> *   cd ~/图书馆/应用程序支持/浓缩咖啡/糖
> *   git clone [https://github.com/mkoistinen/LESS.sugar.git](https://github.com/mkoistinen/LESS.sugar.git) LESS.sugar

# javascript - 什么时候清除整个画布更快？

> ID：13783691
> 
> 赞同：3
> 
> 时间：2012-12-09T01:10:11.127
> 
> 标签：javascript, html, html5-canvas

我正在构建一个基于画布的游戏，该游戏将涉及相当数量的精灵在运动时相互重叠。我的目标是移动设备，所以性能是一个问题。

就我而言，基本上有两种方法可以为画布上的精灵设置动画：

1.  擦除至少一个精灵已移动/更改的每一帧上的整个画布，然后重绘*所有内容*。从我所见，这听起来很标准。
2.  只擦除那些已经移动/改变的精灵，只重绘那些已经移动/改变的精灵，以及那些与那些已经移动/改变的精灵重叠的精灵。擦除那些已移动/更改的精灵将从它们重叠的那些精灵中切出块，因此需要重新绘制重叠的精灵。

天真地，听起来第二种选择会产生更好的性能。更少的绘制操作等于更少的机器必须做的工作，对吧？然而，第一个选项将涉及（可能）每帧调用一次 clearRect()，而第二个选项每帧会涉及许多 clearRect() 调用（尽管每个调用都用于一个明显更小的矩形。）更不用说确定的开销了需要删除的内容以及与刚刚删除的内容重叠的内容。

所以，经过一番思考，我不确定哪个会更快。我敢肯定在某些情况下第二个会更快，我想在某些情况下第一个选项会更快。

现在有没有办法确定哪个是更快的选择？或者我最好的选择是同时实现它并进行一些基准测试？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T01:29:56.767

当我意识到您可以将不同的绘制元素分离到彼此重叠的不同画布上时，我已经在较小的范围内处理了同样的问题并且有一个令人震惊的时刻！

一张用于背景的画布，一张用于角色精灵的画布，等等。

[查看此问题](https://stackoverflow.com/questions/4422907/implementing-layers-in-html5-canvas)的答案，了解处理这种绘画风格的完整框架。

# linux - 寻找 32 位 LSB MIPS 架构的编译器

> ID：13783701
> 
> 赞同：0
> 
> 时间：2012-12-09T01:12:43.177
> 
> 标签：linux, mips, mips32, lsb

我想为我的 Xtreamer 神童编写一个简单的 c 程序（“Hello world”）。它运行一个基本的 linux 内核：

```
/host # uname -a
Linux Prodigy 2.6.34-VENUS #30 PREEMPT Tue Feb 28 13:48:27 CST 2012 mips GNU/Linux 
```

（它使用芯片组Realtek 1186）

我在流媒体上看到了一个可执行文件，我在 linux 上“归档”了它，我得到了：

```
sh-4.1# file DvdPlayer 
DvdPlayer: ELF 32-bit LSB executable, MIPS, MIPS32 rel2 version 1 (SYSV), dynamically linked (uses shared libs), with unknown capability 0xf41 = 0x756e6700, with unknown capability 0x70100 = 0x1040000, stripped 
```

在我的电脑上，我运行 linux centos。我需要使用什么编译器，什么时候可以得到它？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-09T01:33:52.143

您需要的是一个跨工具链——gcc 的架构使其能够拥有不同的代码生成后端，主要是为了能够为您正在开发的架构之外的其他架构进行编译。

存在许多预编译的交叉工具链，可以在[此处](http://www.linux-mips.org/wiki/Toolchains)找到用于 MIPS 的现成工具链的概述。

另一方面，创建自己的交叉工具链，根据您的需要进行微调，也不是那么难，只是相当多的工作。关于如何生成交叉工具链的规范参考是[Dan Kegel 的页面](http://kegel.com/crosstool/)。

# c# - 在c#中的指定时间自动调用按钮单击

> ID：13783704
> 
> 赞同：0
> 
> 时间：2012-12-09T01:13:10.493
> 
> 标签：c#, asp.net, .net, visual-studio

我在 C# 中有一个读取文本文件的 buttonclick 事件。我想自动调用此按钮单击，以便它在每天晚上 9 点自动执行。我该如何为此编写代码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T17:06:25.283

您可以将文本文件的读取转移到页面加载事件中，然后只有一个计划任务程序在一天中的特定时间访问该链接，因此无论何时设置文本文件都会被读取。

# wpf - 如何在 WPF 菜单控件上设置前景色和背景色？

> ID：13783705
> 
> 赞同：14
> 
> 时间：2012-12-09T01:13:15.880
> 
> 标签：wpf, xaml, menu, menuitem, styling

我已经在 WPF 中工作了很长一段时间，但是有一些关于样式的基本知识我只是不明白。

如何设置`Menu`控件的前景色和背景色？我从这个开始：

```
 <Menu IsMainMenu="True" Background="#FF3A3A3A" Foreground="White">
        <MenuItem Header="_File">
            <MenuItem Header="_Exit">
            </MenuItem>
        </MenuItem>
    </Menu> 
```

前景色显然是由 继承的`MenuItem`，但背景不是。下一次尝试：

```
 <Menu IsMainMenu="True" Background="#FF3A3A3A" Foreground="White">
        <MenuItem Background="#FF3A3A3A" Header="_File">
            <MenuItem Header="_Exit">
            </MenuItem>
        </MenuItem>
    </Menu> 
```

现在，当菜单被激活时，突出显示/覆盖颜色不正确，我看不到设置它们的明显属性。此外，菜单弹出窗口有一个宽的白色边框，我也不知道如何更改它的颜色（或大小）。

我错过了什么？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-12-09T02:03:20.980

您将希望了解有关 WPF 中的模板和样式的更多信息（实际上是 XAML）。在 XAML 中，控件的外观和控件的操作方式是完全不同的两件事。在您的示例中，您可能具有 Foreground 和 Background 属性，但控件的样式\模板不能利用这些属性来显示控件。

阅读[http://wpftutorial.net/Templates.html](http://wpftutorial.net/Templates.html)和[http://wpftutorial.net/TemplatesStyles.html](http://wpftutorial.net/TemplatesStyles.html)，它们会给你一个很好和快速的概述。如需更深入的了解，请阅读以下内容：http: [//msdn.microsoft.com/en-us/library/ee230084.aspx](http://msdn.microsoft.com/en-us/library/ee230084.aspx)

如果您使用 Visual Studio 2012 编辑您的 WPF UI，您可以轻松地创建菜单控件正在使用的样式\模板的副本，然后对其进行编辑。如果您使用的是 Visual Studio 2010，您应该下载并安装（它可能是免费的，也可能不是免费的）Expression Blend 以编辑您的 XAML UI。

> **提示**：如果您使用的是 Visual Studio 2012，请确保您的*文档大纲*窗口窗格始终可见。这对于编辑 XAML UI 非常方便。我的默认折叠在程序的左侧。默认情况下，此窗格在 Expression Blend 中可见。

在 Document Outline 中找到 MenuItem 控件。右键单击它并选择编辑模板->编辑副本...

这将创建菜单项现有外观的副本以供您编辑。当您这样做时，您将处于该模板的编辑模式，要“弹出”该模式，请单击“文档大纲”窗口左上角的小图标。

![返回范围按钮](../Images/9f53b8e19dfac4d2460439e8fc582a87.png)

编辑模板时，您可以看到模板的布局和设计。当菜单项作为下拉部分时，它实际上像弹出菜单（右键菜单）一样显示。浏览该模板，我立即弹出的是名为 SubMenuBackgroundBrush 的颜色资源：

```
<SolidColorBrush x:Key="SubMenuBackgroundBrush" Color="#FFF5F5F5"/> 
```

如果您搜索 SubMenuBackgroundBrush，您可以看到它用于名为 PART_Popup 的部件：

```
<Popup x:Name="PART_Popup" AllowsTransparency="true" Focusable="false" HorizontalOffset="1" IsOpen="{Binding IsSubmenuOpen, RelativeSource={RelativeSource TemplatedParent}}" PopupAnimation="{DynamicResource {x:Static SystemParameters.MenuPopupAnimationKey}}" Placement="Bottom" VerticalOffset="-1">
    <Themes:SystemDropShadowChrome x:Name="Shdw" Color="Transparent">
        <Border x:Name="SubMenuBorder" BorderBrush="#FF959595" BorderThickness="1" Background="{StaticResource SubMenuBackgroundBrush}">
            <ScrollViewer x:Name="SubMenuScrollViewer" Margin="1,0" Style="{DynamicResource {ComponentResourceKey ResourceId=MenuScrollViewer, TypeInTargetAssembly={x:Type FrameworkElement}}}">
                <Grid RenderOptions.ClearTypeHint="Enabled">
                    <Canvas HorizontalAlignment="Left" Height="0" VerticalAlignment="Top" Width="0">
                        <Rectangle x:Name="OpaqueRect" Fill="{StaticResource SubMenuBackgroundBrush}" Height="{Binding ActualHeight, ElementName=SubMenuBorder}" Width="{Binding ActualWidth, ElementName=SubMenuBorder}"/>
                    </Canvas>
                    <Rectangle Fill="#F1F1F1" HorizontalAlignment="Left" Margin="1,2" RadiusY="2" RadiusX="2" Width="28"/>
                    <Rectangle Fill="#E2E3E3" HorizontalAlignment="Left" Margin="29,2,0,2" Width="1"/>
                    <Rectangle Fill="White" HorizontalAlignment="Left" Margin="30,2,0,2" Width="1"/>
                    <ItemsPresenter x:Name="ItemsPresenter" KeyboardNavigation.DirectionalNavigation="Cycle" Grid.IsSharedSizeScope="true" Margin="2" SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" KeyboardNavigation.TabNavigation="Cycle"/>
                </Grid>
            </ScrollViewer>
        </Border>
    </Themes:SystemDropShadowChrome>
</Popup> 
```

这是您在右键单击显示菜单或下拉菜单的内容时看到的弹出窗口。将引用从：更改`{StaticResource SubMenuBackgroundBrush}`为`{TemplateBinding Foreground}`。

运行程序时，您会看到弹出窗口的主背景发生了变化，但显示图标的区域没有变化。这些也是`<Rectangle Fill="`弹出控件中的所有项目。也改变那些。最后一个对 Rectangle 的引用看起来像是分割图标和文本的线，您可能无法更改它。

享受美妙的模板世界。它看起来令人困惑，并且需要大量工作。这是。但是当你掌握它的窍门时，它是一个**非常酷**的系统。掌握了窍门后，很难再回到任何其他 UI 系统。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-09T02:04:34.283

> 我错过了什么？

控件或多或少是可自定义的，并且有两个级别的自定义控件：

1.  在放置控件的 XAML 中设置 、 等`Foreground`属性。`Background`
2.  `Template`在你的控件中设置`Style`，并创建你自己的`ControlTemplate`.

第二个涉及更多，但它提供了更大的灵活性，使控件看起来像你想要的那样。如果是这种情况，听起来这就是您所需要的。查看[Menu 和 MenuItem 的默认 ControlTemplate](http://msdn.microsoft.com/en-us/library/ms752296.aspx)。您可以复制/粘贴它们并根据需要进行修改。

```
<Window.Resources>
    <Style TargetType="{x:Type Menu}">
        <Setter Property="Template">
            <ControlTemplate TargetType="{x:Type Menu}">
                <!-- your modified template here -->
            </ControlTemplate>
        </Setter>
    </Style>
    <Style TargetType="{x:Type MenuItem}">
        <Setter Property="Template">
            <ControlTemplate TargetType="{x:Type MenuItem}">
                <!-- your modified template here -->
            </ControlTemplate>
        </Setter>
    </Style>
</Window.Resources> 
```

# ios - 无法通过 CFURLCreateStringByAddingPercentEscapes 为 GET 请求编码空值

> ID：13783706
> 
> 赞同：0
> 
> 时间：2012-12-09T01:13:17.890
> 
> 标签：ios

```
 CFStringRef encodedValue = CFURLCreateStringByAddingPercentEscapes(kCFAllocatorDefault,
                                                                           value,
                                                                           NULL,
                                                                           (CFStringRef)@":/?#[]@!$&'()*+,;=",
                                                                           kCFStringEncodingUTF8); 
```

输入文件中我的请求参数的格式："request-params":[ { "webLoginId":"2597171", "webGroupId":"null", "email":"swathi.chukkala@google.com", " emailOrder":"true", "emailQuote":"true" } ]，空值没有被编码形成一个 URL 来发起一个 GET 请求。如何为 GET 请求编码空值？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T01:30:52.200

在使用此条件格式化请求检查之前：

```
-(NSString*)emptyStr:(NSString*)txt
{
    if (txt) return txt;
    else return @"";
}

NSString *webGroupId = nil;

NSString *checkStr = [self emptyStr:webGroupId];

NSLog(@"String is %@",checkStr); 
```

仅返回空字符串。

# javascript - iPad safari 小书签 - 为什么需要轻按 2 次？

> ID：13783709
> 
> 赞同：0
> 
> 时间：2012-12-09T01:13:46.460
> 
> 标签：javascript, ios, bookmarklet, mobile-webkit

我有一个这样的书签：

```
javascript:(function()%7Bvar%20x=document.createElement('SCRIPT');x.type='text/javascript';x.src='http://tmxhost.com/mail/clippad.js?'+(new%20Date().getTime()/100000);document.getElementsByTagName('head')%5B0%5D.appendChild(x);%7D)(); 
```

但是当我点击它时，直到我第二次点击它，它才会发生任何事情，然后它会写入 DOM。有谁知道为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-10T08:42:58.997

小书签将此脚本附加到页面：[http ://tmxhost.com/mail/clippad.js](http://tmxhost.com/mail/clippad.js)

该脚本有两个部分。1.) 将 jQuery 添加到页面。2.) 使用 jQuery。

问题是在第二部分运行之前没有检查 jQuery 是否已经加载，所以通常第二部分在第一次尝试时会失败。

当您第二次单击小书签时，jQuery 已完成加载，因此第二部分按预期运行。

在书签中使用 jQuery 有一些很好的工具和教程：[https ://www.google.com/search?q=jquery+bookmarklet](https://www.google.com/search?q=jquery+bookmarklet)

要考虑的另一点是，在小书签中使用`$(document).ready`通常是没有意义的，因为小书签几乎总是在文档准备好之后使用。

# unit-testing - 单元测试——使用真实价值还是模拟？

> ID：13783715
> 
> 赞同：2
> 
> 时间：2012-12-09T01:14:21.903
> 
> 标签：unit-testing, junit, nunit, phpunit

我有一个单元测试，它断言特定模型是否具有属性以及该属性是否不为空。

因此，类似于以下内容：

```
public function testHasMySpecialProperty()
{
    $this->assertTrue($this->model->getMySpecialProperty());
} 
```

我的问题是模型应该是什么。模拟或对象的真实实例。

在这种情况下，对象是系统的用户。因此，为了正确加载，我需要用户 ID 等。但如果我只是伪造它，那么测试感觉毫无用处

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-09T01:18:27.723

使用 a`mock`并不是真正测试模型。只需传递真实对象并检查属性即可。毕竟，这就是您要测试的内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-09T02:14:18.290

您不使用模拟来测试模拟。您使用模拟来切断您要测试的*真实系统的一部分。*检查模拟是否具有属性正在测试模拟。它不会让您进一步了解您的真实系统。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-09T03:48:22.000

这取决于。当复杂对象或具有外部依赖关系的对象不是测试的主题时，使用模拟来排除复杂对象的行为。

因此，如果您正在测试 的行为`model`，请使用真实的东西。如果`model`是一个数据对象，没有行为并且没有附加到外部资源（例如，不进行数据库调用），那么使用真实的东西。如果`model`有一些额外的行为或依赖项，并且它*不是*测试的目标，请继续模拟它。

# python - 时间序列重采样

> ID：13783721
> 
> 赞同：4
> 
> 时间：2012-12-09T01:15:12.810
> 
> 标签：python, numpy, pandas, time-series

我有以下形式的数据集[dropbox 下载（23kb csv）](https://www.dropbox.com/s/da9mutj86ct494n/test.csv)

在某些情况下，数据的采样率从 0Hz 到超过 200Hz 从一秒到一秒不等，提供的数据集中的最高采样率约为每秒 50 个样本。

例如，当采集样本时，它们甚至总是分布在第二个样本中

```
time                   x
2012-12-06 21:12:40    128.75909883327378
2012-12-06 21:12:40     32.799224301545976
2012-12-06 21:12:40     98.932953779777989
2012-12-06 21:12:43    132.07033814856786
2012-12-06 21:12:43    132.07033814856786
2012-12-06 21:12:43     65.71691352191452
2012-12-06 21:12:44    117.1350194748169
2012-12-06 21:12:45     13.095622561808861
2012-12-06 21:12:47     61.295242676059246
2012-12-06 21:12:48     94.774064119961352
2012-12-06 21:12:49     80.169378222553533
2012-12-06 21:12:49     80.291142695702533
2012-12-06 21:12:49    136.55650749231367
2012-12-06 21:12:49    127.29790925838365 
```

应该

```
time                        x
2012-12-06 21:12:40 000ms   128.75909883327378
2012-12-06 21:12:40 333ms    32.799224301545976
2012-12-06 21:12:40 666ms    98.932953779777989
2012-12-06 21:12:43 000ms   132.07033814856786
2012-12-06 21:12:43 333ms   132.07033814856786
2012-12-06 21:12:43 666ms    65.71691352191452
2012-12-06 21:12:44 000ms   117.1350194748169
2012-12-06 21:12:45 000ms    13.095622561808861
2012-12-06 21:12:47 000ms    61.295242676059246
2012-12-06 21:12:48 000ms    94.774064119961352
2012-12-06 21:12:49 000ms    80.169378222553533
2012-12-06 21:12:49 250ms    80.291142695702533
2012-12-06 21:12:49 500ms   136.55650749231367
2012-12-06 21:12:49 750ms   127.29790925838365 
```

有没有一种简单的方法来使用 pandas 时间序列重采样功能，或者 numpy 或 scipy 中是否有一些可以工作的东西？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-09T02:15:26.530

我认为没有内置的 pandas 或 numpy 方法/函数可以做到这一点。

但是，我更喜欢使用 python 生成器：

```
def repeats(lst):
    i_0 = None
    n = -1 # will still work if lst starts with None
    for i in lst:
        if i == i_0:
            n += 1
        else:
            n = 0
        yield n
        i_0 = i
# list(repeats([1,1,1,2,2,3])) == [0,1,2,0,1,0] 
```

然后你可以把这个[生成器放到一个 numpy 数组](https://stackoverflow.com/a/367599/1240268)中：

```
import numpy as np
df['rep'] = np.array(list(repeats(df['time']))) 
```

计算重复次数：

```
from collections import Counter
count = Counter(df['time'])
df['count'] = df['time'].apply(lambda x: count[x]) 
```

并进行计算（这是计算中最昂贵的部分）：

```
df['time2'] = df.apply(lambda row: (row['time'] 
                                 + datetime.timedelta(0, 1) # 1s
                                     * row['rep'] 
                                     / row['count']),
                 axis=1) 
```

*注意：要删除计算列，请使用`del df['rep']`和`del df['count']`。*

.

*完成它的一种“内置”方法可能需要使用[`shift`](http://pandas.pydata.org/pandas-docs/dev/generated/pandas.Series.shift.html)两次才能完成，但我认为这会有点混乱......*

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-28T01:24:51.853

我发现这是 pandas groupby 机制的一个很好的用例，所以我也想为此提供一个解决方案。我发现它比安迪的解决方案更易读，但实际上并没有那么短。

```
# First, get your data into a dataframe after having copied 
# it with the mouse into a multi-line string:

import pandas as pd
from StringIO import StringIO

s = """2012-12-06 21:12:40    128.75909883327378
2012-12-06 21:12:40     32.799224301545976
2012-12-06 21:12:40     98.932953779777989
2012-12-06 21:12:43    132.07033814856786
2012-12-06 21:12:43    132.07033814856786
2012-12-06 21:12:43     65.71691352191452
2012-12-06 21:12:44    117.1350194748169
2012-12-06 21:12:45     13.095622561808861
2012-12-06 21:12:47     61.295242676059246
2012-12-06 21:12:48     94.774064119961352
2012-12-06 21:12:49     80.169378222553533
2012-12-06 21:12:49     80.291142695702533
2012-12-06 21:12:49    136.55650749231367
2012-12-06 21:12:49    127.29790925838365"""

sio = StringIO(s)
df = pd.io.parsers.read_csv(sio, parse_dates=[[0,1]], sep='\s*', header=None)
df = df.set_index('0_1')
df.index.name = 'time'
df.columns = ['x'] 
```

到目前为止，这只是数据准备，所以如果你想比较解决方案的长度，那就从现在开始吧！;)

```
# Now, groupby the same time indices:

grouped = df.groupby(df.index)

# Create yourself a second object
from datetime import timedelta
second = timedelta(seconds=1)

# loop over group elements, catch new index parts in list
l = []
for _,group in grouped:
    size = len(group)
    if size == 1:
        # go to pydatetime for later addition, so that list is all in 1 format
        l.append(group.index.to_pydatetime())
    else:
        offsets = [i * second / size for i in range(size)]
        l.append(group.index.to_pydatetime() + offsets)

# exchange index for new index
import numpy as np
df.index = pd.DatetimeIndex(np.concatenate(l)) 
```

# linux - 了解 Linux 最高 CPU 利用率输出

> ID：13783726
> 
> 赞同：9
> 
> 时间：2012-12-09T01:15:33.927
> 
> 标签：linux, performance

我正在使用在 Debian 下运行的单核小型 ARM 处理器，并且无法理解 top 的 CPU 利用率输出，请参阅：

```
top - 15:31:54 up 30 days, 23:00,  2 users,  load average: 0.90, 0.89, 0.87
Tasks:  44 total,   1 running,  43 sleeping,   0 stopped,   0 zombie
Cpu(s): 65.0%us, 20.3%sy,  0.0%ni, 14.5%id,  0.0%wa,  0.0%hi,  0.3%si,  0.0%st
Mem:     61540k total,    40056k used,    21484k free,        0k buffers
Swap:        0k total,        0k used,        0k free,    22260k cached

  PID USER      PR  NI  VIRT  RES  SHR S %CPU %MEM    TIME+  COMMAND                                                                                    
26028 root      20   0  2536 1124  912 R  1.9  1.8   0:00.30 top                                                                                        
31231 root      19  -1 45260  964  556 S  1.9  1.6   1206:15 owserver                                                                                   
    3 root      15  -5     0    0    0 S  0.3  0.0   0:08.68 ksoftirqd/0                                                                                
  694 root      20   0 28640  840  412 S  0.3  1.4 468:26.74 rsyslogd 
```

%CPU 列在所有进程中都非常低，在这个例子中它总共是 4.4%（下面的所有其他进程都在 0% 上）但是第 3 行的整个 CPU 显示 65%us 和 20%sy，所以对于一个非常高的价值 - 顺便说一下，这就是系统的感觉：非常慢:-(系统几乎总是处于这种状态：所有进程的 CPU 非常低，但用户 + 系统 CPU 高。任何人都可以解释为什么 top 工具输出中存在如此高的不一致？我可以使用什么工具来更好地找出导致用户+系统 CPU 利用率高的原因 - top 在这里似乎没用。

**更新**：同时我在[这里](https://stackoverflow.com/questions/12319894/cpu-column-and-load-in-top)找到了这个线程，它讨论了一个类似的问题，但我无法验证那里写的是什么：

*   命令*uptime*显示每 1/5/15 分钟的平均 CPU 利用率
*   这与 %us+%sy 之和的*顶部*输出的第一行接近。但这变化更大，也许是每 10 秒的平均值？
*   即使在top output上看更长的时间，%us+%sy的总和总是比所有%CPU的总和高几倍

谢谢阿奇姆

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-10T12:18:20.180

您应该阅读`manpage`of`top`以更敏锐地理解其输出。从手册页：

> %CPU -- CPU 使用率

自上次屏幕更新以来任务占用的 CPU 时间份额，以占总 CPU 时间的百分比表示。默认屏幕更新时间为 3 秒，可使用 更改`#top -d ss.tt`。要测量交流 CPU 使用率，请运行`top -S`.

> -S：累积时间模式切换

从最后一次记住的“S”状态反转开始。当“累积模式”打开时，每个进程都会列出它及其死去的子进程使用的 CPU 时间。

CPU 状态显示在摘要区域中。它们始终显示为百分比，并且是从现在到最后一次刷新之间的时间。

```
 us  --  User CPU time
      The time the CPU has spent running users' processes that are not niced.

    sy  --  System CPU time
      The time the CPU has spent running the kernel and its processes.

    ni  --  Nice CPU time
      The time the CPU has spent running users' proccess that have been niced.

    wa  --  iowait
      Amount of time the CPU has been waiting for I/O to complete.

    hi  --  Hardware IRQ
      The amount of time the CPU has been servicing hardware interrupts.

    si  --  Software Interrupts
      The amount of time the CPU has been servicing software interrupts.

    st  --  Steal Time
      The amount of CPU 'stolen' from this virtual machine by the hypervisor for other tasks (such as running another virtual machine). 
```

在正常情况下，%us+%sy 应该总是更高。

# php - PHP 在最后一个限制后获得更多

> ID：13783730
> 
> 赞同：-2
> 
> 时间：2012-12-09T01:16:18.997
> 
> 标签：php, sql

我正在尝试制作一个简单的“加载更多”按钮，其中我有一个 ajax 请求加载更多页面，该页面加载更多数据库条目。我的问题是我可以像这样做我的选择语句：

```
$result = $db->query("SELECT uid,username,image FROM tbl_multimedia LIMIT 3"); 
```

但是每次单击它时，我都会看到前 3 个结果，而不是第四个，依此类推。此代码不计算或检查最后加载的 id 并从下一个开始。我试图保持简单，任何关于我可以在此处添加以使其计数的快速想法。我已经准备好javascript部分并使用AJAX，我只是被困在这里。

我的代码如下：

```
try 
{
    // Query multimedia table
    $result = $db->query("SELECT uid,username,image FROM tbl_multimedia LIMIT 3");

    // Convert the object to a string
    $result->unescape(array(
        'username'      => 'string',
        'image' => 'string',
        'uid' => 'integer'
    ));

    // No users in our app :(
    $result->tossIfNoRows();
    ?>

    <?
    // Magic happens -> Create rows with every name found in the database
    foreach ($result as $row) 
    {
        ?>
        <div class="g_holder">
        <? echo '<a href="profile.php?user_id='.$row['uid'].'" ><img src="img/'.$row['image'].'" width="120" height="120"/></a>'; ?>
        <div class="g_caption">
            <p class="g_txt">
                <? echo $row['username']; ?>
            </p>
        </div>
        </div>
        <?
    }

} 
catch (fNoRowsException $e) 
{
    ?>
    <p>noone cares about using my app!</p>
    <?php
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T01:21:30.433

你需要的是一个偏移量。所以你的查询应该是这样的：

```
"SELECT uid,username,image FROM tbl_multimedia LIMIT {$offset},3" 
```

其中 offset 是每次点击后增加 3 的数字。

因此，您的页面第一次加载时将是`0`，在第一次单击之后`$offset = 3`，然后是下一次`$offset = 6`，依此类推。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-09T01:19:22.250

“有两个参数，第一个参数指定要返回的第一行的偏移量，第二个指定要返回的最大行数。初始行的偏移量是0（不是1）：”

[http://dev.mysql.com/doc/refman/5.5/en/select.html](http://dev.mysql.com/doc/refman/5.5/en/select.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-09T01:22:02.330

如果您加载了 10 个条目并想要加载 3 个附加条目，`LIMIT 11,13`请尝试在第十个之后获得 3 个条目。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-09T01:23:31.730

尝试使用偏移量。请参阅[MYSQL 文档](http://dev.mysql.com/doc/refman/5.0/en/select.html)。

```
$result = $db->query("SELECT uid,username,image FROM tbl_multimedia LIMIT 3 OFFSET {$offset}"); 
```

# sql - 同一列中的不同值，如何检索数据

> ID：13783731
> 
> 赞同：2
> 
> 时间：2012-12-09T01:16:23.333
> 
> 标签：sql

我在自定义字段上有一个基于 Wordpress 的 SQL 数据库。

以下 3 列相连：post_id、meta_key 和 meta_value。

meta_key 可以是“name”和“age”，而 meta_value 可以是“John”和“40”。看起来像这样：

```
╔═════════╦══════════╦════════════╗
║ POST_ID ║ META_KEY ║ META_VALUE ║
╠═════════╬══════════╬════════════╣
║559║名字║约翰║
║ 559 ║ 年龄 ║ 40 ║
║699║姓名║约翰║
╚═════════╩══════════╩════════════╝

```

我需要计算每个名字为 John 且年龄为 40 岁的人。这可以通过选择语句实现吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T01:18:21.423

```
SELECT COUNT(*) totalCOunt
FROM
(
  SELECT post_ID
  FROM table1
  WHERE (meta_key = 'Name'  AND meta_value = 'John') OR
        (meta_key = 'Age'  AND meta_value = '40')
  GROUP BY post_ID
  HAVING COUNT(*) = 2
) s 
```

*   [SQLFiddle 演示](http://sqlfiddle.com/#!2/0c442/1)
*   [SQLFiddle 演示](http://sqlfiddle.com/#!2/31ac0/1)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-09T01:54:49.030

我偷了你的小提琴约翰。

```
SELECT  a.meta_value,b.meta_value,count(*)
FROM TABLE1 a
inner join TABLE1 b on b.Post_ID = a.Post_ID
                  and a.meta_key = 'name'
where b.meta_key = 'age'
and a.meta_value = 'John'
and b.meta_value = 40
group by a.meta_value,b.meta_value 
```

[http://sqlfiddle.com/#!2/ebebb/2](http://sqlfiddle.com/#!2/ebebb/2)

哦，是的，我还假设帖子 ID 是将名称与年龄相关联，否则我认为这需要魔法才能知道什么与什么相关联。

# python - Pyramid 1.4 需要 WebOb 1.2b3+。Google App Engine 提供 WebOb 1.1.1。这会以眼泪收场吗？

> ID：13783732
> 
> 赞同：1
> 
> 时间：2012-12-09T01:16:36.720
> 
> 标签：python, google-app-engine, pyramid

我正在学习如何将 Pyramid 应用程序部署到 Google App Engine。（我创建了许多基于 webapp2 的小型应用程序。）我目前使用的是 Pyramid 1.3，但我看到 Pyramid 1.4 现在需要 WebOb 1.2b3+：

> Pyramid 现在需要 WebOb 1.2b3+（之前的 Pyramid 版本仅依赖于 1.2dev+）。这是为了确保我们获得以文本形式返回 request.path_info 的 WebOb 版本。

什么时候升级到 Pyramid 1.4 会以眼泪收场吗？有谁知道是否可以在 App Engine 上使用您自己的 WebOb - 或者以某种方式放宽要求？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T01:50:42.130

是的，您只需要在 GAE 项目的根目录中包含 webob 包并部署它。[如此处所述， webob](http://code.google.com/p/googleappengine/issues/detail?id=2749#c81)
1.2.3 将包含在下一个版本中。

# asp.net-mvc - Unity 未解决 MVC3 控制器构造函数中的依赖关系

> ID：13783733
> 
> 赞同：1
> 
> 时间：2012-12-09T01:16:47.400
> 
> 标签：asp.net-mvc, dependency-injection, unity-container

我们有一个 MVC3 控制器，其中有一些我们在控制器构造函数中滚动的“常见”工作。其中一些常见工作是由通过 Unity 动态解析的松散耦合类（例如`ourService`）完成的（用于 IoC / 依赖注入）。`ourService`在 Controller 的构造函数中为 null（即未解析），但在通常的 Controller 方法中已正确解析。下面的简单演示代码显示了该问题：

```
public class Testing123Controller : BaseController
{
    [Dependency]
    public IOurService ourService { get; set; }

    public Testing123Controller()
    {
            ourService.SomeWork(1); // ourService=null here !!
            ...
    }

    public ActionResult Index()
    {
            ourService.SomeWork(1); // resolved properly here here !!
            ...
    }
    ...
} 
```

**问题**：

1.  为什么 Unity 解析行为会有这种不同？我期望一致的行为。
2.  我该如何修复它，以便 Unity 即使在控制器的构造器中也能解决这个问题？

我们设置 Unity 2.0 的方式是：

全球.asax

```
Application_Start()
{
    ...
    Container = new UnityContainer();
    UnityBootstrapper.ConfigureContainer(Container);
    DependencyResolver.SetResolver(new UnityDependencyResolver(Container));
    ...
}

public static void ConfigureContainer(UnityContainer container)
{
    ...
    container.RegisterType<IOurService, OurService>();
    ...
} 
```

IOurService.cs

```
public interface IOurService
{
    bool SomeWork(int anInt);
} 
```

我们的服务.cs

```
public class OurService: IOurService
{
    public bool SomeWork(int anInt)
    {
        return ++anInt; //Whew! Time for a break ...
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-09T01:35:16.497

作为类的基本原则，在设置实例属性之前，必须实例化该实例。

Unity 需要设置依赖属性，但在实例完全实例化之前它不能这样做——即构造函数必须已完成执行。

如果您在构造函数中引用依赖属性，那么这还为时过早——Unity 还没有办法设置它——因此它将被取消设置（即 null）。

如果需要在构造函数中使用依赖，则*必须*使用构造函数注入。虽然总的来说，使用构造函数注入通常是更好的方法：

```
public class Testing123Controller : BaseController
{
    public IOurService ourService { get; set; }

    public Testing123Controller(IOurService ourService)
    {
            this.ourService = ourService;
            this.ourService.SomeWork(1); // ourService no longer null here
            ...
    }

    public ActionResult Index()
    {
            ourService.SomeWork(1); // also resolved properly here
            ...
    }
    ...
} 
```

注意：在示例中，我将其保留`ourService`为公开的可获取和可设置属性，以防您的代码的其他部分需要访问它。另一方面，如果它只能在类中访问（并且仅出于 Unity 的目的而公开），那么随着构造函数注入的引入，最好将其设为`private readonly`字段。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-09T01:24:04.707

您正在使用属性注入（通过使用 Dependency 属性）而不是构造函数注入，因此在实例化控制器之前不会解析依赖关系。如果您想访问依赖项是构造函数，只需将其添加到ctor：

```
private readonly IOurService _ourService { get; set; }

public Testing123Controller(IOurService ourService)
{
  _ourService = ourService;
  _ourService.SomeWork(1); // ourService=null here !!
  ...
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-09T01:24:30.590

恐怕要让 Unity 在构造函数上工作，必须使用 Unity 解析实例本身。Service 属性在构造函数中的事实`null`支持了这个想法。如果您自己调用控制器（不使用 Unity），Unity 没有时间解析该属性。

# mysql - 更多关于 group by 子句

> ID：13783746
> 
> 赞同：0
> 
> 时间：2012-12-09T01:19:42.470
> 
> 标签：mysql

在了解了更多关于小组和有条款的知识后，我能够完成另一个作业。[上一个问题](https://stackoverflow.com/questions/13783075/having-clause-trouble)

对于员工表和部门表，显示有 3 个或更多员工的部门，如下所示：

```
+----------------+---------------------+
| dname          | COUNT(employee.dno) |
+----------------+---------------------+
| Administration |                   3 |
| Research       |                   5 |
+----------------+---------------------+ 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T01:19:42.470

```
mysql> select d.dname, count(e.dno)
        -> from department d
        -> inner join employee e on e.dno = d.dnumber
        -> group by d.dname
        -> having count(e.dno) > 2;
    +----------------+--------------+
    | dname          | count(e.dno) |
    +----------------+--------------+
    | Administration |            3 |
    | Research       |            4 |
    +----------------+--------------+
    2 rows in set (0.00 sec) 
```

我知道研究显示 4 而不是问题中所示的 5。这是由于教授在提出问题和重新安排问题时出现了错误。

GolezTrol 的许多道具（抱歉，我不知道如何将你的名字与此相关联）

# bash - BASH - 如何从文件中检索单行？

> ID：13783748
> 
> 赞同：3
> 
> 时间：2012-12-09T01:19:45.627
> 
> 标签：bash

如何从文件中检索单行？

```
file.txt
"aaaaaaa"
"bbbbbbb"
"ccccccc"
"ddddddd" 
```

我需要检索第 3 行（“ccccccc”）谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-09T01:35:56.420

`sed`是你的朋友。`sed -n 3p`打印第三行（`-n`：不自动打印，`3p`：当行号为 3 时打印）。您还可以有更复杂的模式，例如`sed -n 3,10p`打印第 3 到 10 行。

如果文件很大，您可以考虑不循环遍历整个文件，而是在打印后退出。`sed -n '3{p;q}'`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-09T01:25:24.923

如果您知道需要第 3 行，则一种方法是使用`head`获取前三行，并`tail`仅获取其中的最后一行：

```
varname="$(head -n 3 file.txt | tail -n 1)" 
```

另一种仅使用 Bash 内置函数的方法是调用`read`3 次：

```
{ read ; read ; IFS= read -r varname } < file.txt 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-09T02:00:19.517

这是一种方法`awk`：

```
awk 'FNR==3 {print; exit}' file.txt 
```

**解释：**

*   `awk '...'`: 调用 awk，一个逐行操作文件的工具。用单引号括起来的指令由 awk 执行。
*   `FNR==3 {print; exit}`：FNR代表“文件编号记录”；只需将其视为“到目前为止为此文件读取的行数”。这里我们说，如果我们在文件的第 3 行，打印整行然后立即退出 awk，这样我们就不会浪费时间阅读大文件的其余部分。
*   `file.txt`: 将输入文件指定为 awk 的参数以保存猫。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-09T02:01:48.660

有很多可能性：试试这样：

```
sed '3!d' test 
```

这是一个非常快的版本：

```
sed "1d; 2d; 3q" 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-09T03:59:56.833

是否允许使用 bash 以外的其他工具？在包含 bash 的系统上，您通常会找到`sed`和`awk`/或其他基本工具：

```
$ line="$(sed -ne 3p input.txt)"
$ echo "$line" 
```

或者

```
$ read line < <(awk 'NR==3' input.txt)
$ echo "$line" 
```

或者如果您想通过在读取第 3 行后退出来优化它：

```
$ read line < <(awk 'NR==3{print;nextfile}' input.txt)
$ echo "$line" 
```

或者更简单的工具（尽管优化程度较低）如何：

```
$ line="`head -n 3 input.txt | tail -n 1`"
$ echo "$line" 
```

当然，如果您真的想在 bash 中完成这一切，您仍然可以将其设置为单行，而无需使用任何外部工具。

```
$ for (( i=3 ; i-- ; )); do read line; done < input.txt
$ echo "$line" 
```

有很多方法可以实现相同的目标。选择一个对你的任务有意义的。下一次，也许能更好地解释你的整体需求，这样我们就可以给你更适合你情况的答案。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-12-09T09:58:09.180

因为，像往常一样，所有其他答案都涉及琐碎和常见的东西（管道通过then then`grep`或`awk`），这是一个非常不寻常且（可悲）不太知名的答案（因此，我在此声明我有最原始的答案):`sed``cut``you-name-it`

```
mapfile -s2 -n3 -t < input.txt
echo "$MAPFILE" 
```

我会说这是相当有效的（`mapfile`非常有效，而且它是内置的 bash）。

完毕！

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-12-09T03:36:22.230

快速 bash 版本；

```
while (( ${i:-1} <= 3 )); do
  (( $i == 3 )) && read -r line; (( i++ ))
done < file.txt 
```

**输出**

```
echo "$line" # Third line
"ccccccc" 
```

**解释**

*   `while (( ${i:-1} <= 3 ))`- 计数直到`$i`等于`3`然后退出循环。
*   `(( $i == 3 ))`- 如果`$i`等于`3`执行读取行。
*   `read -r line`- 将文件行读入变量`$line`。
*   `(( i++ ))`-在每个循环中递增`$i`。`1`
*   `done < file.txt`- 管道文件进入while循环。

# objective-c - 如何在没有 SDK 的情况下在 Objective C 中为 S3 创建预签名 URL？

> ID：13783749
> 
> 赞同：2
> 
> 时间：2012-12-09T01:19:54.537
> 
> 标签：objective-c, macos, amazon-s3, amazon-web-services, http-headers

我正在构建一个 mac 应用程序，而**不是**使用 AWS iOS 开发工具包。我正在尝试构建的 GET 请求应遵循以下一般格式：

`"Authorization: AWS " + AWSAccessKeyId + ":" + base64(hmac-sha1(VERB + "\n" + CONTENT-MD5 + "\n" + CONTENT-TYPE + "\n" + DATE + "\n" + CanonicalizedAmzHeaders + "\n" + CanonicalizedResource))`

[在Amazon docs](http://s3.amazonaws.com/doc/s3-developer-guide/RESTAuthentication.html#RESTCanonicalization "亚马逊文档")中作为“伪语法”提供。我一直在寻找澄清，似乎根据很多人的说法，base64 哈希中的许多字段都是可选的。

以下是我到目前为止的想法。但是我得到的响应是来自 AWS 的错误，说“不支持的授权类型”引用了标题中的“授权”字段。我在这里真的很难过。有关如何调试或修复此问题的任何见解？

有没有其他方法可以在 Obj C 中为 S3 生成预​​签名的 url？

```
-(NSURLRequest*) requestWithURL: (NSString*) reqURL 
```

{

```
NSMutableURLRequest *mutableRequest = [[NSMutableURLRequest alloc] initWithURL:[NSURL URLWithString:reqURL]];
NSString* headerField = @"Authorization: ";
NSString* stringToSign = @"GET\n\n\n\n\n";

NSString* hash = [self hmacsha1:stringToSign key:SECRET_KEY];
NSString *authHeader = [NSString stringWithFormat: @"AWS%@:%@", ACCESS_KEY_ID, hash];
NSURLResponse *resp = nil;
NSError *error = nil;

[mutableRequest addValue:authHeader forHTTPHeaderField:headerField];
NSData *response = [NSURLConnection sendSynchronousRequest: mutableRequest returningResponse: &resp error: &error];
NSString *responseString = [[NSString alloc] initWithData:response encoding:NSUTF8StringEncoding];

return (NSURLRequest*) mutableRequest; 
```

}

```
- (NSString *)hmacsha1:(NSString *)text key:(NSString *)secret {
    NSData *secretData = [secret dataUsingEncoding:NSUTF8StringEncoding];
    NSData *clearTextData = [text dataUsingEncoding:NSUTF8StringEncoding];
    unsigned char result[20];
    CCHmac(kCCHmacAlgSHA1, [secretData bytes], [secretData length], [clearTextData bytes], [clearTextData length], result);

    char base64Result[32];
    size_t theResultLength = 32;
    NSData *theData = [NSData dataWithBytes:base64Result length:theResultLength];
    NSString* encodedData = [NSString stringWithFormat:@"%@",[theData base64Encoding]];

    return encodedData;
} 
```

base64 编码是通过[这篇文章中的 NSData 插件完成的](http://cybersam.com/ios-dev/http-basic-access-authentication-with-objective-c-and-ios "这个帖子")

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T11:22:10.407

要验证查询字符串，您需要对 stringToSign 进行编码：

```
Signature = URL-Encode( Base64( HMAC-SHA1( YourSecretAccessKeyID, UTF-8-Encoding-Of( StringToSign ) ) ) );

StringToSign = HTTP-VERB + "\n" +
        Content-MD5 + "\n" +
        Content-Type + "\n" +
        Expires + "\n" +
        CanonicalizedAmzHeaders +
        CanonicalizedResource; 
```

当浏览器发出 GET 请求时，它不会提供 Content-MD5 或 Content-Type 标头，也不会设置任何 x-amz- 标头，因此 StringToSign 的那些部分留空。

您将需要签署以下文件

```
GET\n
\n
\n
1175139620\n

/johnsmith/photos/puppy.jpg 
```

浏览器将发送的请求是：

```
GET /photos/puppy.jpg?AWSAccessKeyId=AKIAIOSFODNN7EXAMPLE&
    Signature=NpgCjnDzrM%2BWFzoENXmpNDUsSn8%3D&
    Expires=1175139620 HTTP/1.1

Host: johnsmith.s3.amazonaws.com 
```

请注意，请求和 stringToSign 都省略了 Content-Type，但`\n`仍保留在 stringToSign 中。其余*可选*部分相同。

[在身份验证示例](http://docs.amazonwebservices.com/AmazonS3/latest/dev/RESTAuthentication.html#RESTAuthenticationExamples)中查看更多示例

[在AWS 文档](http://docs.amazonwebservices.com/AmazonS3/latest/dev/RESTAuthentication.html#RESTAuthenticationQueryStringAuth)中查看更多详细信息

# php - 表单值内的 PHP 回显

> ID：13783750
> 
> 赞同：1
> 
> 时间：2012-12-09T01:20:00.480
> 
> 标签：php, javascript, html, xml, echo

我正在尝试在 HTML 表单值中回显 div 标记。我无法在不弄乱表单值的情况下显示 div 标签的内容。

```
<?php echo '<div id="demo"></div>';?> 
```

表单值...

```
<input type="text" id="term" value="<?php echo '<div id="demo"></div>';?>"> 
```

输出的是什么……（表单值里面回显的应该是当前的经纬度）

```
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta content="text/html; charset=ISO-8859-1" http-equiv="content-type">
<title>Geolocation search</title>
<script type="text/javascript" src="js/jquery-1.4.2.min.js"></script>
<script id="data" type="text/javascript" src="js/search.js" xmlData="data/data.xml"></script>
</head>
<body onload="getLocation()">
<div id="controller">
  <label>Search Term:
    <input type="text" id="term" value="<?php echo '<div id="demo"></div>';?>">
  </label>
  <label>
    <select name="category" id="category">
      <option value="name">Name</option>
    </select>
  </label>
  <input name="Search" type="button" id="searchButton" value="Search">
</div>
<div id="result">&nbsp;</div>

<?php echo '<div id="demo"></div>';?>

<script>
var x=document.getElementById("demo");
function getLocation()
  {
  if (navigator.geolocation)
    {
    navigator.geolocation.getCurrentPosition(showPosition);
    }
  else{x.innerHTML="Geolocation is not supported by this browser.";}
  }
function showPosition(position)
  {
  x.innerHTML=" " + position.coords.latitude + 
  "<br> " + position.coords.longitude;  
  }
</script>
</body>
</html> 
```

是否有其他方法可以从 echo 语句中加载的经度和纬度中呼出？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-09T01:26:43.063

这是“

改变

```
<input type="text" id="term" value="<?php echo '<div id="demo"></div>';?>"> 
```

至

```
<input type="text" id="term" value="<?php echo "<div id='demo'></div>";?>"> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-09T01:53:48.190

```
 <label>Search Term:
        <input type="text" id="term" value="<?php echo '<div id="demo"></div>';?>">
     </label> 
```

我从上面的脚本中看到的是，您使用双引号来表示您的属性值.. 然后单引号来处理 php echo 值，然后在 div 内再次使用双引号，这使得 php 代码无效，因为它停止它通过您使用的双引号读取。您不妨连接您的 php 脚本或使用转义字符使字符串有效“\”

```
 <label>Search Term:
        <input type="text" id="term" value="<?php echo '<div id=\'demo\'></div>'; ?>" />
    </label>

    <?php echo "<div id='demo'></div>"; ?> 
```

我可以问一下......你想从价值中得到什么？真的是 div 标签吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-09T01:29:03.640

您在单词 demo 周围有双引号，它们正在关闭您的值。

尝试：

```
<?php echo "<div id='demo'></div>";?> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-10-30T05:39:11.723

这是因为您像上面那样发送的 HTTP 标头告诉浏览器期望下载一个文件。他们没有告诉浏览器期待 HTML 内容（默认）。因此，您在回声中发送的内容不会被显示。

尽管我相信您可以找到任何解决方法，但两者都无法正常工作，但关键是您在调试时只需要这些回显，因此您可以在调试时禁用提到的标头调用，一旦一切设置完毕，再次启用它文件可以下载。

# ios - 从 plist 中选择一个随机字符串并将其显示在文本字段中

> ID：13783751
> 
> 赞同：2
> 
> 时间：2012-12-09T01:20:15.027
> 
> 标签：ios, nsstring, nsarray, plist, arc4random

嘿，我对 iPhone 编程很陌生，我一直在这个网站和谷歌上搜索几个小时来解决我的问题。基本上我正在尝试制作一个应用程序，它从我的 plist 中选择一个随机字符串并将其显示到一个文本字段中。我尝试了无数种方法，但这种方法似乎效果最好，但是当我按下按钮时它仍然崩溃并在 arc4random 行上给我错误“EXC_ARITHMETIC”。除了这个错误，当我按下按钮时， NSLog(@"items: &@", items) 在日志中显示 items: (null) 。非常感谢任何帮助或建议。PS items 是我已经在 .h 文件中设置的 NSMutableArray

```
-(IBAction)buttonPress {
    NSString* path = [[NSBundle mainBundle] pathForResource:@"ItemList" ofType:@"plist"];
    items = [[NSMutableArray alloc]initWithContentsOfFile:path];
    NSLog(@"items: %@", items);
    NSInteger randomIndex = arc4random() % [items count];
    NSString* randomString = [items objectAtIndex:randomIndex];
    textField.text = randomString;
} 
```

这是plist代码

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
<key>Array</key>
<array>
    <string>AAA</string>
    <string>BBB</string>
    <string>CCC</string>
    <string>DDD</string>
    <string>EEE</string>
    <string>FFF</string>
    <string>GGG</string>
    <string>HHH</string>
    <string>III</string>
    <string>JJJ</string>
</array> 
```

再次感谢大家的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T04:46:00.460

您的问题是您的 plist 不是数组，而是字典。所以要么你需要改变你的 plist，要么你需要把它当作字典来读。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-13T20:50:16.123

很可能您根本无法阅读 plist，只需检查您的 plist 结构，

```
 NSString *StringsFromPList = [[NSBundle mainBundle] bundlePath];
 NSString *itemPositionPlistLocation = [StringsFromPList stringByAppendingPathComponent:@"Words.plist"];
 _myDictionary= [[NSDictionary alloc] initWithContentsOfFile:itemPositionPlistLocation];
NSArray * items = [_myDictionary objectForKey:@"Root"]; 
```

你的 plist 应该匹配这个结构并且从 ROOT 键而不是数组读取希望它有帮助:) 别担心我花了很长时间才找到为什么我无法阅读我的><

```
<plist version="1.0">
<dict>
<key>Root</key>
    <array>
        <string>Happy</string>
        <string>Rain</string>
    </array> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-20T09:10:23.140

@Bryman 我已经执行了你的代码，它对我来说很好。请重新创建您的 plist 文件。正如您所说，它包含数组，所以我通过将数组添加到 plist 文件来测试您的代码。

# java - 试图禁用拖动 JInternalFrame

> ID：13783753
> 
> 赞同：2
> 
> 时间：2012-12-09T01:20:39.563
> 
> 标签：java, swing, applet, jinternalframe, jdesktoppane

我环顾四周，找不到禁用拖动 JIntenal 框架的方法。任何帮助将不胜感激-TYIA，Roland

请记住这是一个小程序，

```
import java.awt.*;
import java.applet.*;
import java.awt.event.*;
import javax.swing.*;

public class inigui2 extends Applet {

    public void init() {

        final JDesktopPane desktop = new JDesktopPane();
        desktop.setPreferredSize(new Dimension(640, 480));
        this.add(desktop);

        JInternalFrame fr = new JInternalFrame("internal", false, false, false, false);
        fr.setBounds(0, 0, 640, 480);
        desktop.add(fr);
        fr.setVisible(true);

        JInternalFrame fr2 = new JInternalFrame("internal2", true, true, true, true);
        fr2.setBounds(50, 50, 300, 200);
        desktop.add(fr2);
        fr2.setVisible(true);

    }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-09T01:39:15.297

您可以删除所有`MouseMotionListeners`：`JInternalFrames`

```
JInternalFrame[] frames = desktop.getAllFrames();
for (JInternalFrame frame: frames) {
   BasicInternalFrameUI ui = (BasicInternalFrameUI) frame.getUI();
   Component northPane = ui.getNorthPane();
   MouseMotionListener[] motionListeners = (MouseMotionListener[]) northPane.getListeners(MouseMotionListener.class);

   for (MouseMotionListener listener: motionListeners)
      northPane.removeMouseMotionListener(listener);
   }
} 
```

# powershell - 连接网络路径 + 变量

> ID：13783759
> 
> 赞同：62
> 
> 时间：2012-12-09T01:22:18.347
> 
> 标签：powershell

如何将此路径与此变量连接？

```
$file = "My file 01.txt" #The file name contains spaces

$readfile = gc "\\server01\folder01\" + ($file) #It doesn't work 
```

谢谢

* * *

## 回答 #1

> 赞同：97
> 
> 时间：2012-12-09T01:43:30.380

有几种方法。最简单的：

```
$readfile = gc \\server01\folder01\$file 
```

你的方法很接近：

```
$readfile = gc ("\\server01\folder01\" + $file) 
```

您还可以使用[Join-Path](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.management/join-path?view=powershell-7)例如：

```
$path = Join-Path \\server01\folder01 $file
$readfile = gc $path 
```

# php - PHP - 替换标签并返回 src

> ID：13783760
> 
> 赞同：10
> 
> 时间：2012-12-09T01:23:02.760
> 
> 标签：php, regex, html-parsing

任务是用标签和属性替换`<img>`给定字符串中的所有标签作为内部文本。在寻找答案时，我发现了[类似的问题](https://stackoverflow.com/questions/1107194/php-remove-img-tag-from-string)`<div>``src`

```
<?php

    $content = "this is something with an <img src=\"test.png\"/> in it.";
    $content = preg_replace("/<img[^>]+\>/i", "(image) ", $content); 
    echo $content;

?> 
```

结果：

```
this is something with an (image)  in it. 
```

**问题：如何升级脚本ant得到这个结果：**

```
this is something with an <div>test.png</div>  in it. 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-12-09T01:36:23.630

这是 PHP[`DOMDocument`](http://php.net/manual/en/class.domdocument.php)类擅长的问题：

```
$dom = new DOMDocument();
$dom->loadHTML($content);

foreach ($dom->getElementsByTagName('img') as $img) {
    // put your replacement code here
}

$content = $dom->saveHTML(); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-08-03T11:34:59.823

```
$content = "this is something with an <img src=\"test.png\"/> in it.";
$content = preg_replace('/(<)([img])(\w+)([^>]*>)/', '<div>$1</div>', $content); 
echo $content; 
```

# twitter-bootstrap - 有没有集成 Kendo UI 和 Bootstrap 的框架？

> ID：13783766
> 
> 赞同：3
> 
> 时间：2012-12-09T01:23:49.517
> 
> 标签：twitter-bootstrap, kendo-ui

我开始在我的项目中使用 Kendo UI，我想将它与 Bootstrap 集成以进行负责任的设计。我想知道，是否有任何框架集成了 Kendo 和 Bootstrap？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-09T01:40:40.377

所以，你可以使用[BootstrapForKendoUI](https://github.com/advancedrei/BootstrapForKendoUI)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-20T09:44:40.347

kendo UI 已经具有 BootStrap 兼容设计。[http://demos.kendoui.c​​om/themebuilder/web.html](http://demos.kendoui.com/themebuilder/web.html)

从选择列表中选择 Bootstrap 主题

# linux - 减少来自日志文件搜索的重复输出的问题

> ID：13783768
> 
> 赞同：1
> 
> 时间：2012-12-09T01:24:05.380
> 
> 标签：linux, perl, apache, logfiles

自从我重新开始编程以来，这个网站提供了很大的帮助，我正在尝试编写一个简单的 perl 脚本，该脚本将分析目录（多个域）中的 apache 日志文件，提取每个日志文件的最后 1000 行，从日志文件中删除 IP 地址，然后将它们与已知的垃圾邮件发送者阻止列表进行比较。

现在到目前为止，除了一个问题外，我已经让脚本正常工作了。假设我在两个日志文件中有 IP 地址 10.128.45.5，脚本当然会依次分析每个日志文件，并将 IP 减少到一个 PER 日志文件，但我想要做的是将其缩小到更多每个实例一个我运行此脚本，无论多个日志文件中是否出现相同的 IP。

这是我到目前为止得到的代码，如果有点乱，请见谅。

```
#!/usr/bin/perl

# Extract IP's from apache access logs for the last hour and matches with forum spam bot list.
# The fun work of Daniel Pearson

use strict;
use warnings;
use Socket;

# Declarations
my ($file,$list,@files,%ips,$match,$path,$sort);
my $timestamp = localtime(time);

# Check to see if matching file exists
$list ='list';

if (-e $list) {
Delete the file so we can download a new one if it exists
print "File Exists!";
print "Deleting File $list\n";
unlink($list);
}
sleep(5);

system ("wget http://www.domain.com/list");
sleep(5);

my $dir = $ARGV[0] or die "Need to specify the log file directory\n";

opendir(DIR, "$dir");
@files = grep(/\.*$/,readdir(DIR));
closedir(DIR);

foreach my $file(@files) {
my $sum = 0;
if (-d $file) {
print "Skipping Directory $file\n";
}
else {

$path = "$dir$file";
open my $path, "-|", "/usr/bin/tail", "-1000", "$path" or die "could not start tail on $path: $!";

my %ips;

while (my $line = <$path>) {
chomp $line;
if ($line =~  m/(?!0+\.0+\.0+\.0+$)(([01]?\d\d?|2[0-4]\d|25[0-5])\.([01]?\d\d?|2[0-4]\d|25[0-5])\.([01]?\d\d?|2[0-4]\d|25[0-5])\.([01]?\d\d?|2[0-4]\d|25[0-5]))/g) {

my $ip = $1;

$ips{$ip} = $ip;
        }
}
}

foreach my $key (sort keys %ips) {
open ("files","$list");
while (my $sort = <files>) {
chomp $sort;
if ($key =~ $sort) {
open my $fh, '>>', 'banned.out';
print "Match Found we need to block it $key\n";
print $fh "$key:$timestamp\n";
close $fh;
        }
    }
}
} 
```

任何可以提供的建议我都会感激不尽。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T02:47:40.520

完成任务：

*   移出`my %ips`（*上*）`foreach my $file (@files)`循环。

*   移出`foreach my $key ( sort keys %ips )`（*下*）`foreach my $file (@files)`循环。

# java - Java gettext + 添加数字

> ID：13783770
> 
> 赞同：0
> 
> 时间：2012-12-09T01:24:52.090
> 
> 标签：java, numbers, add, settext

我需要一些帮助来获取整数，然后在我从用户添加的内容中获取整数后，我需要向它添加 10，感谢帮助，代码如下；\

```
private void btnCalculateMouseClicked(java.awt.event.MouseEvent evt) 
{                                          
    Integer memoryAdd1, total, radBlue1, radWhite1, radBlack1, microsoftYes1, 
        caseA1, batteryA1, webcamA1, windows20001, windowsVista1;

    radBlack1 = 0;
    radWhite1 = 0;
    radBlue1 = 0;
    microsoftYes1 = 0;
    caseA1 = 0;
    batteryA1 = 0;
    webcamA1 = 0;
    windows20001 = 0;
    windowsVista1 = 0;
    memoryAdd1 = 0;

    if (radBlack.isSelected()) { radBlack1 = radBlack1 + 5; };

    if (radWhite.isSelected()) { radWhite1 = radWhite1 + 5; };

    if (radBlue.isSelected()) { radWhite1 = radWhite1 + 10; };

    memoryAdd.getText(Integer.toString( memoryAdd1 = memoryAdd1+10));

    if (microsoftYes.isSelected()) { microsoftYes1 = microsoftYes1 + 100; };

    if (caseA.isSelected()) { caseA1 = caseA1 + 50; };

    if (batteryA.isSelected()) { batteryA1 = batteryA1 + 30; };

    if (webcamA.isSelected()) { webcamA1 = webcamA1 + 25; };

    if (windows2000.isSelected()) { windows20001 = windows20001 + 300; };

    if (windowsVista.isSelected()) { windowsVista1 = windowsVista1 + 300; };

    total = radBlack1 + radWhite1 + radBlue1 + microsoftYes1 + caseA1 + 
        batteryA1 + webcamA1 + windows20001 + windowsVista1;

    beforeTax.setText(Integer.toString(total)); 
```

}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-09T02:50:55.860

看起来只是铸造问题..

```
 MemoryAdd1+=10 
    String str = Integer.toString( memoryAdd1)
    memoryAdd.getText(str); 

```

顺便问一下你的记忆力是什么？它是 AWT 文本框吗？您是否要在其中设置值？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-09T01:48:39.567

您的问题是，一旦值在转换函数中，您就不能再用它进行数学运算了，因为它现在是一个字符串。

试试这个

```
MemoryAdd1+=10

memoryAdd.getText(Integer.toString( memoryAdd1)); 
```

# c - C中与二维字符数组的连接

> ID：13783771
> 
> 赞同：2
> 
> 时间：2012-12-09T01:24:59.300
> 
> 标签：c, char, concatenation, dna-sequence

我正在将文本文件逐行读取到二维数组中。我想连接 char 数组，所以我有一个长 char 数组。我遇到了麻烦，我可以让它与两个 char 数组一起工作，但是当我尝试做很多时，我出错了。

目前 char 数组如下所示：

```
AGCTTTTCATTC 
```

我想得到这样的东西：

```
AGCTTTTCATTCAGCTTTTCATTC 
```

我已经包含了一些我的代码。

```
int counter = 0; 
fid = fopen("dna.fna","r");
while(fgets(line, sizeof(line), fid) != NULL && counter!=66283 ) {
    if (strlen(line)==70) {
        strcpy(dna[counter], line);        
    counter++;
    }
}
int dnaSize = 6628; 
//Concatenating the DNA into a single char array.
int i;
char DNA[dnaSize];
for(i = 0; i<66283;i++){
   strcpy(DNA[i],dna[i]);
   strcat(DNA[i+1],dna[i+1]);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T01:51:05.190

您只需要循环到`< counter` 然后，您是在复制还是连接？你只需要做一个或另一个。

我建议只在循环中使用 strcat，但初始化 DNA。

```
char DNA[dnaSize] = ""; //initalise so safe to pass to strcat
for(i = 0; i<counter;i++)
{
   strcat(DNA,dna[i]); //no need for indexer to DNA
} 
```

此外，您需要考虑两个数组的大小。我相信（希望）这`dna`是一个数组的数组`char`。如果是的话，我想它`66283`在它的第一个维度上很长。因此，即使每行的长度为 1 个字符，它也不适合`DNA`( long)。`6628`

以下是关于如何准确分配正确内存量的想法：

```
#define MAXLINELENGTH (70)
#define MAXDNALINES (66283)

//don't copy this line, it will not work because of the sizes involved (over 4MB)
//it will likely stack overflow
//just do what you are currently doing as long as it's a 2-d array.
char dna[MAXDNALINES][MAXLINELENGTH + 1];

int counter = 0; 
int totalSize = 0;
fid = fopen("dna.fna","r");
while(fgets(line, sizeof(line), fid) != NULL && counter!=MAXDNALINES ) {
    const int lineLength = strlen(line);
    if (lineLength==MAXLINELENGTH) {
        strcpy(dna[counter], line);        
        counter++;
        totalSize += lineLength;
    }
}

//Concatenating the DNA into a single char array (of exactly the right length)
int i;
char *DNA = malloc(totalSize+1); // the + 1 is for the final null, and putting on heap so don't SO
DNA[0] = '\0'; //the initial null is so that the first strcat works
for(i = 0; i<counter;i++){
   strcat(DNA,dna[i]);
}

//do work with DNA here

//finally free it  
free(DNA); 
```

# php - 变量通过但仍然抛出异常？

> ID：13783773
> 
> 赞同：0
> 
> 时间：2012-12-09T01:25:19.520
> 
> 标签：php, codeigniter

我创建并传递一个数据数组：

```
public function home()
{

    $data['page'] = 'home';
    $data['table'] = 'pageData';
    $data['temp'] = 'temp_1';

    $this->template($data);

}

    public function template($data)
{

    $this->load->model("model_get");

    $data['results'] = $this->model_get->getData($data);

    $this->load->view('template', $data);

} 
```

这是模板视图：

```
<?php

$this->load->view('header');

$this->load->view('nav', $data);

$data['results'] = $results;

$this->load->view($temp, $data);

$this->load->view('footer');

?> 
```

它在以下位置为未定义的变量引发异常：

```
$this->load->view('nav', $data); 
```

但仍会加载视图并完成其中的所有 if 语句，并从存储在`$temp`.

为什么会抛出异常？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T11:55:31.607

您尚未在该视图中填充 $data 以加载第二个视图。您的代码名称太模糊，无法真正理解它应该做什么，但让我们分解一下。

```
public function home()
{
$data['page'] = 'home';
$data['table'] = 'pageData';
$data['temp'] = 'temp_1';
$this->template($data);
}

public function template($data)
{
$this->load->model("model_get");
$data['results'] = $this->model_get->getData($data);
//I assume getData takes a table name and returns all the data
//This only works because you're taking all the data passed from the first function
//in the function above.
$this->load->view('template', $data);
}

<?php
$this->load->view('header');
$this->load->view('nav', $data);
//At this point $data is empty. You have available $results, $page, $table and $temp
//because they were passed from the template function above.
$this->load->view('nav', $results);
//The line above is what it appears you need, rather than $data.
$data['results'] = $results;
//You've repopulated $data here but now all it contains is $results.
$this->load->view($temp, $data);
$this->load->view('footer');
?> 
```

您误解的是 $data 不是持久的，当您通过加载带有 $data 作为第二个参数的视图将其传递给视图时，它会分解为其组件，因此 $data 本身不再可用。

# javascript - 闭包和垃圾收集：从链表中删除连续节点的最有效方法

> ID：13783776
> 
> 赞同：5
> 
> 时间：2012-12-09T01:25:56.123
> 
> 标签：javascript, garbage-collection, linked-list, nodes

我为 javascript 编写了一个快速而肮脏的双向链表实现。我希望能够一次删除多个（连续的）节点，并且想知道：仅仅切断我要删除的这些最外层节点的末端是否足够，或者我必须单独删除每个节点。如果我正确理解了javascript的垃圾收集，一旦没有任何东西指向那些连续的节点，即使它们仍然相互连接，它们应该由垃圾收集器处理，对吗？如果有人能告诉我如何自己测试或验证这一点，我也将不胜感激。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-09T01:45:31.617

根据[MDN](https://developer.mozilla.org/en-US/docs/JavaScript/Memory_Management)：

> 截至 2012 年，所有现代浏览器都提供了一个标记和清除垃圾收集器。过去几年在 JavaScript 垃圾收集（分代/增量/并发/并行垃圾收集）领域所做的所有改进都是该算法的实现改进，但不是对垃圾收集算法本身的改进，也不是它对何时定义的减少“不再需要一个对象”

标记和扫描算法从根对象开始，找到所有可访问的对象，然后收集所有不可访问的对象，因此对于这些浏览器来说，切断节点就可以了。较旧的浏览器使用引用计数，这意味着对象只有在对它们的引用为 0 时才会被收集，因此在这种情况下，双向链表的循环将是有问题的。然后，您需要以某种方式切断连续节点中的循环（将引用设置为 null、删除关键字等）。

因此，如果您正在为现代浏览器进行开发，那么一切都很好，但是如果您想向后兼容 IE6/7 等浏览器，则需要一个稍微复杂的解决方案（总是这样，不是吗...）

# java - int 作为布尔表达式 Eclipse-Java

> ID：13783779
> 
> 赞同：1
> 
> 时间：2012-12-09T01:26:06.383
> 
> 标签：java, eclipse, boolean-expression

为什么 Eclipse 会告诉我

```
int a = 4;
if (a) {
    //do stuff
} 
```

是错的，还是`Cannot convert from integer to boolean`？

我习惯用 C、C++ 编写类似的东西，并且认为 Java 也可以。它是 Eclipse 的工作原理吗？还是 Java 是如何工作的？有什么解决方法吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-09T01:27:26.463

Java 与 C++ 不同，从一开始就有一个内置的布尔类型。
因此，它不需要使用整数作为布尔值。

`if (x = 4)`在大多数情况下，禁止将整数隐式转换为布尔值可以防止臭名昭著的错误。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-09T01:27:34.873

在 java 中，布尔 literls 只能有**true**和**false**值。0 和 1 在 java 中不能作为布尔值工作。

来自[java语言规范](http://docs.oracle.com/javase/specs/jls/se7/jls7.pdf)：

> **boolean 类型有两个值，由布尔文字 true 和 false 表示**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-09T02:03:05.237

这样做的原因是在 C 中没有特定的类型`boolean`- 相反，任何非 0 整数都会计算为布尔值“真”。因此在您的 C 代码中：

```
if(a) 
```

`a`被赋值为 4，它是非 0 - 并且条件被评估为`true`

在java中，有一个基本类型`boolean`，里面的条件值`if`必须是这个类型。

```
a=4 
```

在 Java 中，将 4 分配给`a`并返回评估的最终结果`integer value 4`，但是 type`boolean`是预期的 - 因此您会收到有关不兼容类型的编译时错误。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-09T02:15:31.733

对于 int 变量 a，if(a != 0) 在 Java 中的作用与在 C 或 C++ 中的 if(a) 相同。

更一般地说，认识到 Java 不是 C 或 C++ 的方言非常重要。最强的相似之处在于表面上。Java 必须作为一种不同的语言来学习。如果您在编写 Java 时依赖于 C 或 C++ 知识，您会感到非常沮丧。你习惯的许多成语都行不通，你也不会知道行之有效的成语。

# ios - NSURLCredential 密码偶尔返回无密码

> ID：13783783
> 
> 赞同：3
> 
> 时间：2012-12-09T01:26:44.860
> 
> 标签：ios, nsurlcredential

NSURLCredential 的 Apple 文档说它可能并不总是返回密码。但是除了没有密码与凭证一起存储的明显原因之外，还有什么理由永久存储在 NSURLCredentialStorage 中的默认凭证会随机返回没有密码？

奇怪的是它工作正常的时间百分比。但偶尔读取默认凭据上的密码属性会返回 nil。credential 对象在其他方面似乎是有效的，但 password 属性只返回 nil。

密码读取发生在不是主线程的线程中，所以我想知道是否存在线程限制，尽管我在文档中找不到任何内容。

是否有可能我们需要在一段时间后重试获取密码？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-25T08:19:53.983

如果它是永久性的并且钥匙串被锁定，那就可以了。大多数应用程序不会遇到这个问题，因为默认行为只会在不寻常的情况下使钥匙串锁定。NSURLCredentials 应该与默认的 kSecAttrAccessible 属性（kSecAttrAccessibleWhenUnlocked）一起存储。 [本文描述了其中一些行为](http://software-security.sans.org/blog/2011/01/05/using-keychain-to-store-passwords-ios-iphone-ipad/)。

# c# - 使用 WINSCRD 传递 APDU 命令

> ID：13783785
> 
> 赞同：1
> 
> 时间：2012-12-09T01:27:12.220
> 
> 标签：c#, vb.net, smartcard, smartcard-reader, winscard

下面是来自 winscard API 的函数

```
[DllImport("winscard.dll")]        
public  static extern int SCardTransmit (
                                          int hCard, 
                                          ref SCARD_IO_REQUEST pioSendRequest, 
                                          ref byte SendBuff, 
                                          int SendBuffLen, 
                                          ref SCARD_IO_REQUEST pioRecvRequest, 
                                          ref byte RecvBuff, 
                                          ref int RecvBuffLen); 
```

但是第三个参数接受类似于类似的APDU命令 `FF B2 A4 03 0E`
所以我想知道如果我已经以字符串形式将其以字节形式传递给该参数。

我知道这可能是复制，但我找不到解决方案。任何链接或其他信息都会很有帮助。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-10T20:50:11.650

这很简单。你有一个十六进制字符串，所以你需要一个十六进制编码器/解码器包来将这些类型的字符串转换为字节数组/从字节数组转换。

请注意，给定的十六进制字符串看起来不像我听说过的任何 APDU。

# javascript - 如何从使用Javascript选择复选框的行中读取元素

> ID：13783786
> 
> 赞同：3
> 
> 时间：2012-12-09T01:27:18.507
> 
> 标签：javascript, jquery, checkbox, html-table

这是我的问题，我有一个用 Javascript 动态创建的表，结果我有这样的东西：

```
<table>
<tbody id="bodyDepartment">
            <tr><td class="Depa" style="width:30px;" align="center"><input id="Depa" name="Depa" type="checkbox" value="1" style="width:30px;"/> </td>
                <td>value 1.1</td>
                <td>value 1.2</td>
                <td>value 1.3</td>
            </tr>
            <tr><td class="Depa" style="width:30px;" align="center"><input id="Depa" name="Depa" type="checkbox" value="1" style="width:30px;"/> </td>
                <td>value 2.1</td>
                <td>value 2.2</td>
                <td>value 2.3</td>
            </tr>
</tbody>
</table>​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​ 
```

我想要的是从所有选定的行中获取所有元素，我试图使用这段代码来获取带有 Javascript 的元素：

```
function Click(){
if ($("input:checkbox[name='Depa']:checked")) {
    var id, num, piso
    $("input:checkbox[name='Depa']:checked").parents("tr").each(function (index) {
      $("input:checkbox[name='Depa']:checked").parents("tr").children("td").each(function (index2) {
        switch (index2) {
        case 1:
            id = $(this).text();
            alert(id);
            break;
        case 2:
            num= $(this).text();
            alert(num);
            break;
        case 3:
            piso = $(this).text();
            alert(piso);
            break;

         }
      })
    })
} 
```

​ }​</p>

但我只能得到“n”次选择的最后一个元素，其中“n”是选择的元素的数量，有人可以告诉我出了什么问题以及如何解决它。

这是我的问题的演示：http: [//jsfiddle.net/ZPxqJ/180/](http://jsfiddle.net/ZPxqJ/180/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T01:40:41.107

尝试：

```
function getDetails(){
    var checkboxes = $("input:checkbox[name='Depa']:checked");
    $(checkboxes).each(function(){
        var arr = $(this).closest('tr').find('td:not(.Depa)');
        $(arr).each(function(){
            console.log(this.innerHTML);
        });
    });
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-09T01:32:44.437

试试这个，

```
$("#RegBtnReg").click(Click);

function Click() {
    var id, num, piso
    $("input:checkbox[name='Depa']:checked").parents("tr").each(function(index) {

        $(this).children("td").each(function(index2) {
            switch (index2) {
            case 1:
                id = $(this).text();
                alert(id);
                break;
            case 2:
                num = $(this).text();
                alert(num);
                break;
            case 3:
                piso = $(this).text();
                alert(piso);
                break;

            }
        })
    })
}​ 
```

演示：http: [//jsfiddle.net/ZPxqJ/181/](http://jsfiddle.net/ZPxqJ/181/)

# email - 解决方案 No such User Here 错误

> ID：13783793
> 
> 赞同：1
> 
> 时间：2012-12-09T01:28:46.683
> 
> 标签：email

我正在努力为这个问题找到一个明确的答案和解决方案，把我的头发拉出来。

我有几个 Wordpress 网站，其中包含表格。基本上，表格已完成，员工会收到包含详细信息的通知，非常简单。员工根本没有收到通知电子邮件，但是当我使用我的个人电子邮件或 Gmail 时，它可以正常工作！

我通过我的主机 webamail 看到 No such User Here 错误，如下所示。我被告知所有电子邮件都被列入白名单并且不应该被阻止，但他们说他们没有看到电子邮件到达他们的网关。

我真的很感谢这里的一些帮助来继续这件事，在此先感谢。

**错误信息：**

此消息是由邮件传递软件自动创建的。

您发送的邮件无法传递给一个或多个收件人。这是一个永久性错误。以下地址失败：

rcook@csgroup.org.au 这里没有这样的用户

------ 这是邮件的副本，包括所有标题。------

```
Return-path: <gravityforms@ampedmediaworks.com>
Received: from amwrrc by gator41.hostgator.com with local (Exim 4.80)
        (envelope-from <gravityforms@ampedmediaworks.com>)
        id 1ThUzf-0007gH-00
        for rcook@csgroup.org.au; Sat, 08 Dec 2012 18:43:42 -0600
Received: from 60.228.85.149 ([60.228.85.149])
        (SquirrelMail authenticated user gravityforms@ampedmediaworks.com)
        by gator41.hostgator.com with HTTP;
        Sat, 8 Dec 2012 18:43:42 -0600
Message-ID: <ec0f41d26aad8a08452d013018cd32db.squirrel@gator41.hostgator.com>
Date: Sat, 8 Dec 2012 18:43:42 -0600
Subject: test
From: gravityforms@ampedmediaworks.com
To: rcook@csgroup.org.au
User-Agent: SquirrelMail/1.4.22
MIME-Version: 1.0
Content-Type: text/plain;charset=iso-8859-1
Content-Transfer-Encoding: 8bit
X-Priority: 3 (Normal)
Importance: Normal

test 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T01:37:46.313

这可能与您的 IP 被列入黑名单有关

[http://www.mxtoolbox.com/SuperTool.aspx?action=blacklist%3a60.228.85.149](http://www.mxtoolbox.com/SuperTool.aspx?action=blacklist%3a60.228.85.149)

# gruntjs - 通往资产的 yeoman 路径。目录不在服务器根目录

> ID：13783798
> 
> 赞同：2
> 
> 时间：2012-12-09T01:29:36.370
> 
> 标签：gruntjs, yeoman

我创建了一个默认的 yeoman 项目。yeoman 服务器很好用。

yeoman build 会将文件放入 dist 文件夹中。

当我推送到不在根目录的临时服务器上的文件夹时，我得到 404s。这是意料之中的（我认为），但有谁知道如何修改 grunt 文件或将某些内容传递给编译器参数以允许我想要的行为？

哪个是运行 yeoman build，然后能够将 dist 文件夹的内容推送到非根位置，并且网站不会阻塞图像路径和 js 路径等？

谢谢你的时间cp

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T23:43:34.473

我的错误是由于对 yeoman 的混淆造成的。我在构建过程和路径以及图像重命名方面遇到了问题。所以我的坏。

我认为这是我的问题的解决方案。

不是最好的，但我学到的是……</p>

如果您在 .scss 中将图像路径定义为“../”，Yeoman 将不会修改路径或图像名称。

问题：它仍然重命名所有图像并压缩它们，因此 .css 找不到正确的图像。dist / images 中不存在未修改的图像

所以解决方法是

1\. 将 ../ 保留在 .scss 文件中。2.运行 yeoman build 3.然后在我们要压缩的所有图像上使用 optiPng。这将导致未重命名的压缩图像。4.然后将这些图像放在暂存时的图像文件夹中。

和。css 将能够针对它们。仅供参考，yeoman 使用 optiPng。（我认为）

# ruby-on-rails - 从多个其他 Gemfile 组合一个 Gemfile

> ID：13783801
> 
> 赞同：3
> 
> 时间：2012-12-09T01:30:03.587
> 
> 标签：ruby-on-rails, rubygems, gem, gemfile, squeel

我正在将一个大型应用程序拆分为多个较小的应用程序。这样做时，我意识到通过创建一个`Gemfile.global`并将其包含在我的主应用程序和子应用程序中，我可以清理我所有的`Gemfile`s. 例如，我所有的部署 gem 都放在 main`Gemfile`中，而我的 rails 放在`Gemfile.global`.

它几乎适用于我所有的宝石，除了一个：Squeel。

我`Gemfile`在根应用程序中的开头是：

```
gemfiles = [
  File.join('Gemfile.global'),
]
Dir.glob(File.join(File.dirname(__FILE__), gemfiles)) do |gemfile|
  eval(IO.read(gemfile), binding)
end

# gem 'squeel' # Let's try putting this in Gemfile.global 
```

我的`Gemfile.global`样子：

```
source 'https://rubygems.org'
# rails and dependencies
gem 'squeel' 
```

`bundle install`效果很好，`rails s`几乎所有东西都像您期望的那样，以 Squeel 为主`Gemfile`。`Gemfile.global`但是，在使用默认的 Squeel 初始化程序时，将其放入 中会破坏初始化过程：

```
Squeel.configure do |config|
end 
```

`rails s`抛出一个`uninitialized constant Squeel (NameError)`即使`bundle install`报告`Using squeel (1.0.13)`。为什么这种组合我`Gemfile`的方法会弄乱 Rails 运行时常量？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-05-19T20:33:50.293

在将 Gemfile.global 加载到您的 Gemfile 时使用`instance_eval`而不是。`eval`即您的项目 Gemfile 应如下所示（删除 File.joins 以避免混淆）：

```
gemfiles = [ 'Gemfile.global' ]
gemfiles.each do |gemfile|
  instance_eval File.read(gemfile)
end 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2015-08-28T19:18:23.837

您还可以使用`eval_gemfile`：

```
gemfiles = [ 'Gemfile.global' ]
gemfiles.each do |gemfile|
  eval_gemfile gemfile
end 
```

# matlab - 当我完成绘图时，如何修改 Matlab 绘制的图形中不同图层的可见性？

> ID：13783805
> 
> 赞同：4
> 
> 时间：2012-12-09T01:31:07.300
> 
> 标签：matlab, plot, visibility

保存图形文件。当多条线相交时，我想让其中一条线可见。我应该如何在不重新绘制图形的情况下修改线条的不同层？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-09T09:05:20.253

使用`uistack`（见[文档](http://www.mathworks.com/help/matlab/ref/uistack.html)）。例如，之后：

```
figure
hold on
hblue=plot([1 2],[3 4],'b','LineWidth',5);
hred=plot([1 2],[4 3],'r','LineWidth',5); 
```

红线在顶部（如果红线覆盖它，则看不到蓝线）。然后，如果您使用`uistack(hblue,'top')`，蓝线将被带到顶部。用于重新排序图的其他选项，而不是`top`、 是`up`、`down`和`bottom`。您可以选择指定步数`up`或`down`（例如`uistack(h,'up',2)`将手柄向上移动两层 - 尽管在我的简单示例中不需要）。

`hblue`如果，如您所说，“图形文件已保存”，并且您没有绘图的句柄（`hred`在我的示例中），则在加载绘图后，您可以使用`get(gca,'children')`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-09T04:40:25.987

[`hold on`](http://www.mathworks.com/help/matlab/ref/hold.html)如果我理解正确，请在绘图之前尝试使用...

# java - 如何将“新建文件夹”按钮添加到 JFileChooser

> ID：13783808
> 
> 赞同：4
> 
> 时间：2012-12-09T01:31:20.267
> 
> 标签：java, swing, jfilechooser

我正在尝试制作一个 JFileChooser 来选择一个文件夹。在这个 FileChooser 中，我希望用户可以选择创建一个新文件夹，然后选择它。我注意到 JFileChooser“保存”对话框默认有一个“新文件夹”按钮，但在“打开”对话框中没有出现类似的按钮。有谁知道如何在“打开”对话框中添加“新文件夹”按钮？

具体来说，我想将按钮添加到使用此代码创建的对话框中：

```
 JFrame frame = new JFrame();

            JFileChooser fc = new JFileChooser();

            fc.setFileSelectionMode(JFileChooser.DIRECTORIES_ONLY);
            fc.setFileFilter( new FileFilter(){
                @Override
                public boolean accept(File f) {
                    return f.isDirectory();
                }
                @Override
                public String getDescription() {
                    return "Any folder";
                }
            });

            fc.setDialogType(JFileChooser.OPEN_DIALOG);
            frame.getContentPane().add(fc);

            frame.pack();
            frame.setVisible(true); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-09T19:03:15.993

行。最后，我通过使用“保存”对话框而不是“打开”对话框解决了这个问题。标准的保存对话框已经有一个“新文件夹”按钮，但它的顶部还有一个“另存为：”面板，这是我不想要的。我的解决方案是使用标准的保存对话框，但隐藏“另存为”面板。

这是保存对话框的代码：

```
 JFrame frame = new JFrame();

            JFileChooser fc = new JFileChooser();

            fc.setFileSelectionMode(JFileChooser.DIRECTORIES_ONLY);
            fc.setFileFilter( new FileFilter(){

                @Override
                public boolean accept(File f) {
                    return f.isDirectory();
                }

                @Override
                public String getDescription() {
                    return "Any folder";
                }

            });

            fc.setDialogType(JFileChooser.SAVE_DIALOG);
            fc.setApproveButtonText("Select");

            frame.getContentPane().add(fc);

            frame.setVisible(true); 
```

此部分定位并隐藏“另存为：”面板：

```
 ArrayList<JPanel> jpanels = new ArrayList<JPanel>();

            for(Component c : fc.getComponents()){
                if( c instanceof JPanel ){
                    jpanels.add((JPanel)c);
                }
            }

            jpanels.get(0).getComponent(0).setVisible(false);

            frame.pack(); 
```

最终结果：

![在此处输入图像描述](../Images/50187165b25486d1ab3d455e12e4af5a.png)

*编辑*

这个解决方案有一个怪癖，如果用户在当前没有选择目录的情况下按下批准按钮，就会出现这种情况。在这种情况下，选择器返回的目录将对应于用户正在查看的任何目录，并与（隐藏的）“另存为：”面板中的文本连接。结果目录可能是一个不存在的目录。我用下面的代码处理了这个。

```
 File dir = fc.getSelectedFile();
                    if(!dir.exists()){
                        dir = dir.getParentFile();
                    } 
```

# node.js - DocPad 中用户提供的内容

> ID：13783812
> 
> 赞同：3
> 
> 时间：2012-12-09T01:32:04.440
> 
> 标签：node.js, docpad

我正在考虑用[DocPad](http://www.docpad.org/)制作一个包含大量用户交互的网站，例如评论、用户配置文件等。我喜欢基于文件的数据存储，所以我考虑将用户发布的数据写入 src/documents/ 下的文件（例如 src/documents /comments/ *some-generated-id* .html.md 和 src/documents/users/ *user-name* .html.md）。

这将需要一些服务器端逻辑来处理和存储用户输入。你会如何解决这个问题？我应该把我的代码放在哪里？我想这应该去一个插件。有没有这样的现成插件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T22:32:59.100

我想我想通了。

我在 /plugins/userInput/userInput.plugin.coffee 下制作了插件，如@balupton 所述：http: [//bevry.me/docpad/plugin-write](http://bevry.me/docpad/plugin-write)。

在我的插件里面我有这个：

```
<!-- language: lang-coffee -->
module.exports = (BasePlugin) ->
  class userInput extends BasePlugin
    name: "userInput"
    serverExtend: (options) ->
      {server} = options
      docpad = @docpad
      server.delete '*', userInput.deleteContent
      server.get '*', (request, response, next) ->
        switch request.query.action
          when 'delete' then userInput.deleteContent request, response, next
          else next()
    @deleteContent: (request, response, next) ->
      response.send 'That was really cool shit, man. Now it\'s gone!' 
```

这只是概念证明。它并没有真正删除或更改任何内容。无论如何，这回答了我的问题，从这里实现真正的数据操作应该很容易。当它更成熟一点时，我会分享这个插件。

顺便说一句，DocPad 很棒。我一直梦想着这样的事情。感谢所有背后的人。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T10:47:57.120

1) 任何/所有动态内容都应“离岸”到某些服务提供商。喜欢广告服务的广告（好吧，几乎总是这样做）评论到 disqus 或与任何 rss 服务类似的 rss

2）用户配置文件并不容易。（除非您无法连接某些 3rd 方用户配置文件服务，例如 google+/facebook）

一种解决方案是构建处理所有用户生成内容的服务器，然后为您更新静态文件。

这可能很慢，而且很麻烦。

# sql - 将序列附加到列并从 1000 开始

> ID：13783814
> 
> 赞同：1
> 
> 时间：2012-12-09T01:32:29.983
> 
> 标签：sql, postgresql, sequence

应用此 sql 脚本：

```
create table software (
  id                        bigint not null,
  name                      varchar(255),
  description               varchar(255),
  constraint pk_software primary key (id))
;

create sequence software_seq; 
```

然后这个：

```
alter sequence software_seq start with 1000;;

insert into software (id, name, description) values (  1, 'Soft1', 'Description1'); 
```

然后**当以编程方式（从java）插入新软件时**，得到**id = 24的新软件**

**为什么不用1001？**由于'alter sequence **software_seq start with 1000** ;'

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-09T01:48:03.353

你这里有一些问题。

首先，仅创建具有特定名称的序列不会将其附加到您要使用它的表和列。您需要更改`software.id`为使用`software_seq`默认值：

```
alter table software alter column id set default nextval('software_seq'); 
```

并且您还需要更改[序列的所有权](http://www.postgresql.org/docs/current/static/sql-altersequence.html)（当然，除非您在其他地方使用该序列）：

> `OWNED BY table_name.column_name`
> `OWNED BY NONE`
> 
> 该`OWNED BY`选项使序列与特定的表列相关联，这样如果删除该列（或其整个表），该序列也将自动删除。如果指定，此关联将替换之前为该序列指定的任何关联。指定的表必须与序列具有相同的所有者并且在相同的模式中。指定`OWNED BY NONE`删除任何现有的关联，使序列“独立”。

所以你应该：

```
alter sequence software_seq owned by software.id; 
```

然后在插入时，您可以省略`id`：

```
insert into software (name, description) values ('...', '...'); 
```

或指定默认值：

```
insert into software (id, name, description) values (default, '...', '...'); 
```

你的另一个问题是它`start with`没有做你认为它做的事情：

> `start`
> 
> 可选子句`START WITH` ***start***更改序列的记录开始值。这对**当前**序列值没有影响；它只是设置未来`ALTER SEQUENCE RESTART`命令将使用的值。

如果您希望序列从 1000 开始，那么您可以：

```
alter sequence software_seq restart with 1000; 
```

或者，您可以使用[`setval`](http://www.postgresql.org/docs/current/static/functions-sequence.html)：

```
select setval('software_seq', 1000); 
```

当然，你也可以使用[`bigserial`](http://www.postgresql.org/docs/current/static/datatype-numeric.html#DATATYPE-SERIAL)：

> 数据类型`smallserial`和不是真正的类型，`serial`而`bigserial`只是用于创建唯一标识符列的符号方便（类似于某些其他数据库支持的 AUTO_INCREMENT 属性）。在当前实现中，指定：
> 
> ```
> CREATE TABLE tablename (
>     colname SERIAL
> ); 
> ```
> 
> 相当于指定：
> 
> ```
> CREATE SEQUENCE tablename_colname_seq;
> CREATE TABLE tablename (
>     colname integer NOT NULL DEFAULT nextval('tablename_colname_seq')
> );
> ALTER SEQUENCE tablename_colname_seq OWNED BY tablename.colname; 
> ```

因此，使用`bigserial`作为`id`列类型将为您设置所有序列内容。然后你会像使用之前一样设置起始值`alter sequence`or `setval`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-09T01:46:34.097

大概我得到了。如果一个人想改变顺序，那么他应该使用这个语法：

ALTER SEQUENCE sequenceName [ RESTART WITH long ] [ INCREMENT BY long ]

即使用'RESTART'而不是'START'

我测试过：然后在插入新值时它真的从 1000 开始。

# c++ - 从子类中隐藏变量

> ID：13783819
> 
> 赞同：1
> 
> 时间：2012-12-09T01:33:35.327
> 
> 标签：c++, inheritance

我有许多遵循通用接口 Foo_Interface.h 的 C++ 类。这些类不是“受信任的”。我希望他们能够使用两种方法与主系统进行通信（通过 Foo_Interface.h）。由于它们扩展了 Foo_Interface.h，这很容易，我只是没有将方法 A 和 B 声明为虚拟方法。但是，这些方法 A 和 B 需要访问 Foo_Interface 的类变量（在本例中为端点的地址），子类不应该看到该变量。

我想说的是，这个变量应该只对 A 和 B 方法可见（变量将通过构造函数实例化），因为这些子类是通过单独的方法（Foo_main）运行的。

这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T01:40:15.243

`Put`并且`Get`听起来不太像功能界面。这听起来更像是一种设计气味。但无论如何，只需制作他们访问的变量，`private`.

这就是它在语言中的用途。

它使东西`private`。

# android - 使用 ArrayAdapter 创建列表视图的问题

> ID：13783831
> 
> 赞同：0
> 
> 时间：2012-12-09T01:35:49.633
> 
> 标签：android

我在使用我的数据创建 ListView 时遇到问题。生成它的代码是：

```
protected void onPostExecute(DtoProjectListItem[] result) {
    mProgressDialog.dismiss();

    // DtoProjectListItem[] Adapter for ListView
    ArrayAdapter<DtoProjectListItem> projects_adapter = new ArrayAdapter<DtoProjectListItem>(
            ProjectListActivity.this,
            R.layout.activity_project_list_item, 
            R.id.tvProjectName, 
            result
    );

    ListView lvProjects = (ListView) findViewById(R.layout.activity_project_list);
    lvProjects.setAdapter(projects_adapter); 
```

}

我得到的错误是：

```
Shutting down VM
threadid=1: thread exiting with uncaught exception (group=0x40cad930)
FATAL EXCEPTION: main
java.lang.NullPointerException
    at org.my.cihub.ProjectListActivity$GetDataAsyncTask.onPostExecute(ProjectListActivity.java:173)
    at org.my.cihub.ProjectListActivity$GetDataAsyncTask.onPostExecute(ProjectListActivity.java:1)
    at android.os.AsyncTask.finish(AsyncTask.java:631)
    at android.os.AsyncTask.access$600(AsyncTask.java:177)
    at android.os.AsyncTask$InternalHandler.handleMessage(AsyncTask.java:644)
    at android.os.Handler.dispatchMessage(Handler.java:99)
    at android.os.Looper.loop(Looper.java:137)
    at android.app.ActivityThread.main(ActivityThread.java:5039)
    at java.lang.reflect.Method.invokeNative(Native Method)
    at java.lang.reflect.Method.invoke(Method.java:511)
    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:793)
    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:560)
    at dalvik.system.NativeStart.main(Native Method)
12-08 20:31:03.386: I/Process(21412): Sending signal. PID: 21412 SIG: 9 
```

第 173 行是：

```
lvProjects.setAdapter(projects_adapter); 
```

有人可以帮我解决这个问题吗？

谢谢！:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T02:15:03.850

问题出在这一行

```
ListView lvProjects = (ListView) findViewById(R.layout.activity_project_list); 
```

应该是这样的

```
ListView lvProjects = (ListView) findViewById(R.id.your_list_id); 
```

# node.js - 使用 Redis 的 Express 应用程序的结构

> ID：13783834
> 
> 赞同：1
> 
> 时间：2012-12-09T01:36:06.707
> 
> 标签：node.js, express, redis, node.js-connect

我不确定在我正在构建的 Express 应用程序中定义 redis 客户端的最佳位置是哪里。我使用[骨架](https://github.com/EtienneLem/skeleton)作为框架。

似乎与 redis 的连接应该放在`boot.coffee`or`app.coffee`中，但是我不能轻易地在 中获得对它的引用`application_controller.coffee`，这正是我需要的地方。

如果我`client = redis.createClient`输入`application_controller.coffee`，这是否意味着每个请求都会创建一个新客户端？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-12T12:29:14.983

我会在`app.coffee`（配置之后，路由之前）定义 Redis 客户端，并将 Redis 客户端设置为 App 对象的属性： `app.client = redis.createClient`

然后在`application_controller.coffee`你可以通过 访问 Redis 客户端`app.client`。

# php - Codeigniter + CSS 不能正常工作，可能是 baseurl

> ID：13783837
> 
> 赞同：4
> 
> 时间：2012-12-09T01:36:37.403
> 
> 标签：php, css, .htaccess, codeigniter

这个问题已经被问过好几次了，但我研究了仍然无法解决。在我的一个视图文件中，我有（参考我的 css）：

```
link rel="stylesheet" type="text/css"  href="/application/views/screen.css" 
```

css 文件位于：

```
- www
  - application
    - view
      - css
        - screen.css
  - system 
```

我还尝试在同一文件夹下设置css`-www`并直接使用它

```
link rel="stylesheet" type="text/css"  href="css/screen.css" 
```

我的基础`url`设置为`""`因为我在本地开发。这是问题吗？我正在使用 wamp 服务器。

那么问题是什么？任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-09T01:40:07.167

您不能将您的 CSS 文件或要提供给浏览器的文件放在应用程序文件夹中，因为出于安全原因，它受到保护，将 .htaccess 文件设置为“全部拒绝”您的 CSS、JS、图像文件等需要在应用程序文件夹之外。

将您的 CSS 文件放在“www”文件夹中名为“css”的文件夹中，使其不在“应用程序”或“系统”内。然后确保使用以下内容（注意前导斜杠，表示绝对 URL）：

```
href="/css/screen.css" 
```

改用这个：

```
# If your default controller is something other than
# "welcome" you should probably change this
RewriteCond $1 !^(index\.php|css)
RewriteRule ^(.*)$ /index.php/$1 [L] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-09T01:48:04.650

请记住，有几种方法可以给猫剥皮。

快速修复而不会弄乱 htaccess。使用 base_url() 或 site_url()：

```
<link rel="stylesheet" type="text/css"  href="<?php echo base_url();?>assets/css/screen.css"> 
```

并使用以下文件结构：

*   万维网

    *   应用

        *   意见
        *   (...)
    *   系统

    *   资产
        *   css
            *   屏幕.css

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-09T14:31:39.567

您应该将所有资产文件（图像、js、css 等）放入站点根目录（**应用程序文件夹之外**）的单独文件夹中。创建一个名为“files”的文件夹，并`.htaccess`在站点根目录的文件中添加以下行：

```
# Allow these directories and files to be displayed directly:
# - index.php (DO NOT FORGET THIS!)
# - robots.txt
# - favicon.ico
# - Any file inside of the files/ - js/, or css/ directories
RewriteCond $1 ^(index\.php|files) 
```

这样，您将可以通过 url 直接访问该文件夹（以及其中的任何文件夹）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-10-01T06:20:38.267

我在 Windows 中也遇到了同样的问题。在 Mac 中，这很容易。当试图`index.php`从 URL 中排除时，我遇到了`400 Bad Request Error`. 后来解决了这个问题，通过在 RewriteRule index.php 前面加上斜线前缀，如下所示

```
RewriteRule ^(.*)$ index.php/$1 [L] 
```

至

```
RewriteRule ^(.*)$ /index.php/$1 [L] 
```

**展望未来，面临另一个问题：** 无法加载资产/静态文件。另外，我的资产文件夹位于根目录级别。我看到了一个解决方案，例如在 RewriteCond 中添加“资产”以使其被排除在应用 rewriteRule 之外。喜欢，

```
RewriteCond $1 !^(index\.php|assets)       #It does not work for me 
```

但是，它不起作用。我收到 404 未找到错误。后来，我找到了解决方案，如

```
RewriteCond $1 !^(index\.php|\/assets)     #Working! 
```

我的重写脚本在这里：

```
 RewriteEngine on
  RewriteCond $1 !^(index\.php|\/assets)
  RewriteRule ^(.*)$ /index.php/$1 [L] 
```

希望，这将有助于并节省大量时间！:)

# jquery - JQuery 中的输入标签特征检测

> ID：13783838
> 
> 赞同：0
> 
> 时间：2012-12-09T01:36:44.783
> 
> 标签：jquery

有人可以准确解释这个特征检测是如何工作的吗？

```
// Create a dummy element for feature detection
if (!('placeholder' in $('<input>')[0])) { 
```

这行代码检测浏览器是否支持输入元素的占位符属性。

在部署到生产环境之前，我想对这里的幕后情况更加熟悉。

这最终会循环遍历输入元素的所有可能属性，只是为了检查`placeholder`元素的存在吗？如果是这种情况，我不知道我们可以（以某种方式）访问标记中未明确说明的元素。

[代码源](http://www.jacklmoore.com/notes/form-placeholder-text)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T01:50:38.413

浏览器是否支持元素的属性基本上归结为浏览器的javascript环境是否具有该元素的该属性的定义。

如果定义存在，则属性的“获取”访问应返回该属性的非空值，而如果定义不存在，则返回空/“假”（即 javascript 解释为假的东西）值。

有问题的代码利用了 javascript 对值的 'truish'/'falseish' 解释，将属性上的“get”访问的返回值用作特征检测的谓词。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-09T01:54:03.493

您可以访问使用 javascript 创建的任何元素，无论该元素是否附加到页面本身。所以如果你创建一个元素，你可以改变它，像这样：

```
var element = document.createElement('input');
    element.style.border = '1px solid red';
    element.value = 'some value'; 
```

现在要在 jQuery 中创建一个元素，您可以：

```
$('<input />') 
```

当然`[0]`最后得到的是原生 DOM 元素，所以这两个是完全一样的：

```
var DOM_element1 = $('<input />')[0];
var DOM_element2 = document.createElement('input'); 
```

创建元素后，该元素的所有属性也都可用，例如`element.value`等。

如果浏览器支持占位符，placeholder 属性将出现在输入元素上，并且由于我们创建的元素实际上是一个节点或元素对象，我们使用`in`关键字来检查该属性是否可用：

```
var element = document.createElement('input');

if ('placeholder' in element) {
    //the element has a placeholder attribute, 
    //so it must be supported by the browser
} 
```

做同样事情的另一种方法是直接检查属性以查看它是否未定义，如下所示：

```
if (typeof element.placeholder!=undefined) {  //should return string if present

} 
```

# vim - Vim：仅在状态行中显示当前文件名的方式

> ID：13783839
> 
> 赞同：0
> 
> 时间：2012-12-09T01:37:03.410
> 
> 标签：vim

正如标题所说。

我已经搜索了很长时间，如果它很容易，那么我一定是盲目的。

但是只输出当前文件名的最佳方法是什么？`expand('%')`据我所知，使用我得到相对路径。

Using`%f`给了我相对路径，并`%F`给了我家的完整路径（如果我在主文件夹中）。

那么我该如何实现呢？仅获取当前文件的名称，因为它会出现在缓冲区名称中。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-09T01:44:59.493

利用：

```
set statusline=%t 
```

`t`如缓冲区中文件的文件名的尾部。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-09T01:51:06.417

尝试

```
:echo expand('%:t') 
```

它应该只输出文件名。

# javascript - 将类添加到dom元素后如何强制ie8重新绘制

> ID：13783840
> 
> 赞同：20
> 
> 时间：2012-12-09T01:37:20.867
> 
> 标签：javascript, jquery, internet-explorer-8

在 ie8 中，如果在更改类名时元素不使用关联的 css“重新绘制”，那么如何强制浏览器刷新而不破坏 ie8 性能？

这篇文章（[如何强制 WebKit 重绘/重绘以传播样式更改？](https://stackoverflow.com/questions/3485365/how-can-i-force-webkit-to-redraw-repaint-to-propagate-style-changes)）建议调用 offsetHeight 来强制重绘。

这篇文章 ( [http://www.tek-tips.com/viewthread.cfm?qid=1688809](http://www.tek-tips.com/viewthread.cfm?qid=1688809) ) 有一条评论建议从 body 元素中添加和删除一个类。

这两种方法都扼杀了 ie8 的性能，第一种方法对我的布局产生了副作用。

最好的方法是什么？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-12-09T01:37:20.867

我为我的 ie8 问题提出的解决方案是在我正在更改的元素的近父级上添加/删除一个类。由于我使用的是modernizer，因此我检查了ie8，然后执行此添加/删除舞蹈以获取新的css 进行绘制。

```
 $uicontext.addClass('new-ui-look');
        if ($('html').is('.ie8')) {
            // IE8: ui does not repaint when css class changes
            $uicontext.parents('li').addClass('z').removeClass('z');
        } 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2014-01-16T19:44:19.433

这个问题的正确答案是您需要实际更改`content`规则。

```
.black-element:before { content:"Hey!"; color: #000;}
.red-element:before { content:"Hey! "; color: #f00;} 
```

`Hey!`注意我在on之后添加的额外空间`.red-element`

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2015-01-29T12:37:33.403

可笑的是，这行得通：

```
function ie8Repaint(element) {
    element.html(element.html().replace('>', '>'));
} 
```

DOM 中实际上没有任何变化，因此它不会影响任何其他浏览器。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-09T02:17:38.073

在其上触发移动或调整大小事件。

```
var ie8 = whateverYouUseToDetectIE();
var element = document.getElementById("my-element");
element.className += " new-class";
if (ie8) {
    element.fireEvent("resize");
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-08-08T13:35:41.547

这扩展了此处的其他答案。您需要添加一个新类（*Doug 的答案*）并确保该类具有不同的内容值（*Adam 的答案*）。仅仅改变班级可能是不够的。需要更改内容以强制 IE8 重新绘制。这是一篇[相关的博客文章](http://blog-it.hypoport.de/2013/10/02/how-to-make-ie-8-redraw-pseudo-elements-on-class-change/)。

这是要更改添加新类的 JQuery：

```
$(".my-css-class").addClass("my-css-class2"); 
```

这是第二类的 CSS，其内容值略有不同：

```
.my-css-class:before {content: "\e014";}
.my-css-class2:before {content: "\e014 ";} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-06-12T01:48:52.563

我遇到了很多困难，尝试了一切都无济于事……直到我为 IE8 尝试了这个

```
function toggleCheck(name) {
  el = document.getElementById(name);
  if( hasClass(el, 'checked') ) {
    el.className = el.className.replace(/checked/,'unchecked');
  } else if( hasClass(el, 'unchecked') ) {
    el.className = el.className.replace(/unchecked/,'checked');
  }
  document.body.className = document.body.className;
}
function hasClass(element, cls) {
  return (' ' + element.className + ' ').indexOf(' ' + cls + ' ') > -1;
} 
```

现在我的复选框的 CSS 更改在 IE8、Chrome 和 Firefox 上运行良好！

# android - Eclipse android数据库：插入“注释”后如何插入日期

> ID：13783843
> 
> 赞同：-1
> 
> 时间：2012-12-09T01:37:54.757
> 
> 标签：android, eclipse

我正在尝试编写一个比赛数据库，您可以在其中输入比赛名称和比赛日期，然后单击该比赛名称，然后编辑/删除它或日期。我无法输入日期。下面是我的 LogCat 错误。我究竟做错了什么 ？

```
//LOGCAT
12-08 20:15:35.710: I/Database(1648): sqlite returned: error code = 1, msg = near "FROM": syntax error
12-08 20:15:35.710: E/ERROR(1648): ERROR IN CODE: android.database.sqlite.SQLiteException: near "FROM": syntax error: , while compiling: SELECT _id, note FROM Races, date FROM Races
12-08 20:15:35.721: W/System.err(1648): android.database.sqlite.SQLiteException: near "FROM": syntax error: , while compiling: SELECT _id, note FROM Races, date FROM Races
12-08 20:15:35.730: W/System.err(1648):     at android.database.sqlite.SQLiteCompiledSql.native_compile(Native Method) 
```

```
//View races java code
package com.CIS2818.tritracker;
import android.app.Activity;
import android.content.Context;
import android.content.Intent;
import android.database.Cursor;
import android.os.Bundle;
import android.util.Log;
import android.view.LayoutInflater;
import android.view.Menu;
import android.view.View;
import android.view.ViewGroup;
import android.widget.AdapterView;
import android.widget.Button;
import android.widget.CursorAdapter;
import android.widget.EditText;
import android.widget.ListView;
import android.widget.TextView;
public class View_races extends Activity {

NoteAdapter adapter=null;
RaceHelper helper2=null;
Cursor dataset_cursor=null;
EditText editNote2=null;
EditText editNote3=null;
String noteId2=null;

String TAG = "INFORMATION";

@SuppressWarnings("deprecation")
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    try
    {
        setContentView(R.layout.activity_view_races);

        ListView list2=(ListView)findViewById(R.id.list2);
        editNote2 = (EditText)findViewById(R.id.myEditText2);
        editNote3 = (EditText)findViewById(R.id.myEditText3);

        helper2=new RaceHelper(this);

        dataset_cursor=helper2.getAll();

        startManagingCursor(dataset_cursor);

        adapter=new NoteAdapter(dataset_cursor);

        list2.setAdapter(adapter);

        Button btnSimple2 = (Button) findViewById(R.id.btnSimple2);
        btnSimple2.setOnClickListener(onSave);
        Button btnDelete2 = (Button) findViewById(R.id.btnDelete2);
        btnDelete2.setOnClickListener(onDelete);
        list2.setOnItemClickListener(onListClick);

    }
    catch (Exception e)
    {

        Log.e("ERROR", "ERROR IN CODE: " + e.toString());
        e.printStackTrace();
    } 
}
@Override
public void onDestroy() {
    super.onDestroy();
    helper2.close();
}

private View.OnClickListener onSave=new View.OnClickListener() {
    @SuppressWarnings("deprecation")
    public void onClick(View v) {
        Log.i(TAG,"You passed through the save method");
        if (noteId2==null) {
            helper2.insert(editNote2.getText().toString(),editNote3.getText().toString());
        }
        else{
            helper2.update(noteId2, editNote2.getText().toString(),editNote3.getText().toString());

            noteId2=null;

        }
        dataset_cursor.requery();

        editNote2.setText("");
    }
};    

private View.OnClickListener onDelete=new View.OnClickListener() {
    @SuppressWarnings("deprecation")
    public void onClick(View v) {

        if (noteId2==null) {
            return;
        }
        else{

            helper2.delete(noteId2);

            noteId2=null;

        }
        dataset_cursor.requery();

        editNote2.setText("");
    }
};    

private AdapterView.OnItemClickListener onListClick=new AdapterView.OnItemClickListener() {
    public void onItemClick(AdapterView<?> parent,
                            View view, int position,
                            long id2) 
    {

        noteId2 =String.valueOf(id2);

        Cursor c=helper2.getById(noteId2);

        c.moveToFirst();

        editNote2.setText(helper2.getNote(c));

    }
};

class NoteAdapter extends CursorAdapter {
    @SuppressWarnings("deprecation")
    NoteAdapter(Cursor c) {
        super(View_races.this, c);
    }

    @Override
    public void bindView(View row, Context ctxt,Cursor c) {
        NoteHolder2 holder=(NoteHolder2)row.getTag();

        holder.populateFrom(c, helper2);
    }

    @Override
    public View newView(Context ctxt, Cursor c,ViewGroup parent) {
        LayoutInflater inflater=getLayoutInflater();
        View row=inflater.inflate(R.layout.row2, parent, false);
        NoteHolder2 holder=new NoteHolder2(row);

        row.setTag(holder);

        return(row);
    }
}

static class NoteHolder2 {
    private TextView noteText2=null;

    NoteHolder2(View row) {
        noteText2=(TextView)row.findViewById(R.id.note2);
    }

    void populateFrom(Cursor c, RaceHelper helper) {
        noteText2.setText(helper.getNote(c));

    }
}
@Override
public boolean onCreateOptionsMenu(Menu menu) {
    getMenuInflater().inflate(R.menu.activity_view_races, menu);
    return true;} 
  //Button Method to return to the main Menu
 public void Menu(View v){
    Intent intent = new Intent(this, MainMenuActivity.class);
    startActivity(intent);
 }
 //Button Method to go to the Race Activity
 public void Races(View v){
    Intent intent = new Intent(this, UpComingRaceActivity.class);
    startActivity(intent);
}
} 
```

```
// RaceHelper java code
package com.CIS2818.tritracker;
import android.content.ContentValues;
import android.content.Context;
import android.database.Cursor;
import android.database.sqlite.SQLiteDatabase;
import android.database.sqlite.SQLiteOpenHelper;
import android.util.Log;

class RaceHelper extends SQLiteOpenHelper {
private static final String DATABASE_NAME="Races.db";
private static final int SCHEMA_VERSION=2;
String TAG = "INFORMATION";
public RaceHelper(Context context) {
    super(context, DATABASE_NAME, null, SCHEMA_VERSION);
}

@Override
public void onCreate(SQLiteDatabase db) {
    db.execSQL("CREATE TABLE Races (_id INTEGER PRIMARY KEY AUTOINCREMENT, note TEXT, date TEXT);");
    Log.i(TAG, "You are in the creation of db");
}

@Override
public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {

}
public void insert(String note, String date) {

    ContentValues cv=new ContentValues();
    cv.put("note", note);
    getWritableDatabase().insert("Races", "note", cv);
    Log.i(TAG, "You have succesfully inserted into the db");
}
public void update(String id, String note, String date) {
    ContentValues cv=new ContentValues();
    String[] args={id};

    cv.put("note", note);

    getWritableDatabase().update("Races", cv, "_id=?", args);

}
public void delete(String id) {

    getWritableDatabase().delete("Races", "_id=?", new String[] {id});
}

public Cursor getAll() {
    return(getReadableDatabase()
                    .rawQuery("SELECT _id, note FROM Races, date FROM Races",
                                        null));
}

public String getNote(Cursor c) {
    return(c.getString(1));
}

public Cursor getById(String id) {
    String[] args={id};

    return(getReadableDatabase()
                    .rawQuery("SELECT _id, note FROM Races WHERE _id=?",
                                        args));
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T03:15:11.593

更改以下行

```
getReadableDatabase().rawQuery("SELECT _id, note FROM Races, date FROM Races",
                                        null) 
```

至

```
getReadableDatabase().rawQuery("SELECT _id, note, data FROM Races",
                                        null) 
```

# mysql - 获取列数 MySQL

> ID：13783844
> 
> 赞同：1
> 
> 时间：2012-12-09T01:38:17.690
> 
> 标签：mysql, count

> **可能重复：**
> [查找表中的列数](https://stackoverflow.com/questions/658395/find-the-number-of-columns-in-a-table)

我如何获得表格中的列数，通过谷歌搜索，但找不到直接答案。

先感谢您。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T01:43:03.420

此类信息位于**INFORMATION_SCHEMA**中，您可以通过查询表调用`COLUMNS`来获取数据库中的列数。

此查询将为您提供列数。

```
SELECT COUNT(*) FROM INFORMATION_SCHEMA.COLUMNS
WHERE table_schema = 'DB_NAME' AND table_name = 'TABLE_NAME' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-09T01:43:03.493

```
select COUNT(*) totalColumns
from information_schema.columns
where table_schema = 'db_2_a3c3e' AND -- the name of your Database
      table_name = 'table1'           -- the name of your table 
```

*   [SQLFiddle 演示](http://sqlfiddle.com/#!2/a3c3e/4)

# objective-c - 在 Xcode 中编辑编译器的支持文件位置

> ID：13783846
> 
> 赞同：0
> 
> 时间：2012-12-09T01:39:09.150
> 
> 标签：objective-c, ios, xcode, compiler-construction, clang

我重命名了存储我的 Xcode 项目的支持文件的文件夹，现在我无法编译我的项目。我能够编辑构建设置以反映新的文件夹名称，但构建阶段选项卡显示我的编译器仍在使用旧文件夹名称，并且我没有看到任何用于编辑编译源的选项。我什至尝试删除编译源并重新添加它们，但它们仍然显示旧文件夹名称。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T02:09:56.547

首先，在 Xcode 中，删除问题文件。但是（重要！）当被问到时，单击“仅删除”或其他任何内容，而不是“从磁盘中删除文件”的选项。

接下来，在您希望课程发生的文件夹上使用人民币，然后单击“添加现有文件”或其他任何内容。导航到文件的实际位置并选择它们，然后单击“添加”或其他任何内容。（小心在浏览目录时本能地双击，因为这会添加整个目录。如果这样做，只需从项目中删除添加的目录并再次执行 RMB。）

您不需要对构建设置或其他任何东西做任何其他事情（除了可能撤消您之前的一些更改）。

# c++ - 在 C++ 中将 sqlite 结果转换为 std::string

> ID：13783849
> 
> 赞同：3
> 
> 时间：2012-12-09T01:39:23.577
> 
> 标签：c++, sql, casting, sqlite

我正在查询一个 sqlite 数据库，但我需要将结果（一个 TEXT 属性）转换为一个 C++ std::string。我觉得这应该不难完成，但我遇到了麻烦。

```
sqlite3_open("sqlite.db", &db);
std::string str = "SELECT something FROM table";
sqlite3_prepare_v2(db,
str.c_str(),
-1,
&m_statement,
0);

sqlite3_step(m_statement);
// OBS: 3rd party printf, cannot use std::cout in this environment
printf("Result1: %s",sqlite3_column_text(m_statement,0)); // OK! Result is printed

string try1 = string(
    reinterpret_cast<const char*>(sqlite3_column_text(m_statement,0))); 
printf("Result2: %s",try1); // null

stringstream ss;
ss << sqlite3_column_text(m_statement,0);
printf("Result3: %s",ss.str()); // null 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-09T01:44:12.720

您的问题与 sqlite 无关。当您使用`%s`with 时`printf`，`printf`需要一个`char *`NOT a `std::string`。

例如改变这个：

```
 printf("Result2: %s",try1); // null 
```

至

```
 printf("Result2: %s",try1.c_str()); 
```

看看会发生什么。

C++ 有两种主要的实现字符串的方法。遗留 C 字符串 ( `char*`) 和`std::string`C++ 标准库中的类。如果您处理 C API，您将主要处理前者。`printf`并且`sqlite*`都来自 C API，因此期望处理`char*`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-09T01:43:39.023

问题不在于`sqlite3_column_text`.

`printf`格式说明符`%s`需要一个 C 字符串（字符指针）。

由于`printf`无法检查堆栈上传递了哪些值，因此它必须信任格式说明符。因为格式说明符是`%s`，它读取一个参数，因为它是一个 char 指针（它不是），但巧合的是，它打印错误的结果，而不是崩溃。

`std::string`公开一个函数，该函数为您获取一个只读的对应 C 字符串，因此，例如，您的第二种情况将是：

```
// Get a C string from std::string
printf("Result2: %s", try1.c_str()); 
```

# mysql - 功能依赖澄清

> ID：13783853
> 
> 赞同：0
> 
> 时间：2012-12-09T01:40:00.530
> 
> 标签：mysql, database, database-design, functional-dependencies

我正在为最终项目（小学）创建数据库，如果我正确地获得了我的功能依赖关系，我有点困惑。

这里有几张表：

![ERD](../Images/cad650e64550a6f92e37fe124fd0db74.png)

![erd2](../Images/07af6b39650a0a0562439063cd52958f.png)

这是我派生的功能依赖项：

**学校表：** School_ID -> School_Name, School_Year

**科目表：** 科目、学校 ID -> 学年、科目名称

**Course_Join_Periods 表：** Course_Period_ID、Course_ID、Grade_Level_ID、Teacher_ID、Grade_Level、School_Year、Grade_Name、Period_ID、School_ID、Subject_ID、Subject_Name -> Period_Class_Name

我在这里有什么正确的吗，还是我应该回到绘图板上重新自学FD？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T06:29:24.540

确定 FD 是分析的一部分，而不是设计的一部分。您所说的 FD 在您的小学可能是正确的，但在我的学校可能不正确或不完整。

# html - html5画布滞后

> ID：13783859
> 
> 赞同：0
> 
> 时间：2012-12-09T01:40:46.620
> 
> 标签：html, canvas, lag

我正在画布上制作俄罗斯方块。它适用于第一件作品，有时适用于第二件和第三件。但它很快就会开始滞后，而且只会变得更糟。看起来这不是太多的对象来减慢它。我在想这可能是因为我每次都在画整个板子，但即使这样似乎也没什么大不了的（不像它画很多东西）。我的项目位于[http://tetris.townsendwebdd.com](http://tetris.townsendwebdd.com)。任何帮助都会非常好。在我解决这个问题之前我有点卡住了谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T03:24:24.263

感谢您的帮助。我认为这是问题的一部分。我认为另一部分是我在整个板上画了好几次。我已经清理了它，现在它似乎工作得很好，谢谢

# textures - Directx 11 - 仅部分显示纹理

> ID：13783861
> 
> 赞同：1
> 
> 时间：2012-12-09T01:41:12.857
> 
> 标签：textures, directx-11

为了在一个简单的矩形上获得纹理，我遇到了一个奇怪的问题。似乎只使用了纹理中的最后一列像素。 [http://i.imgur.com/40EoI.png](http://i.imgur.com/40EoI.png) <- 结果是顶部的黑白矩形。

我已经在已经提出的问题的深处跋涉，并在谷歌的危险下腹部进行了探索，但无济于事。我已经将我的代码与我基于它的教程进行了比较（巧合的是，它适用于我选择的纹理）但仍然感到困惑。我在想它可能是输入布局，也许是偏移量？

```
D3D11_INPUT_ELEMENT_DESC ied[] =
{
    {"POSITION", 0, DXGI_FORMAT_R32G32B32_FLOAT, 0, 0, D3D11_INPUT_PER_VERTEX_DATA, 0},
    {"COLOR", 0, DXGI_FORMAT_R32G32B32A32_FLOAT, 0, 12, D3D11_INPUT_PER_VERTEX_DATA, 0},        
    {"TEXCOORD", 0, DXGI_FORMAT_R32G32_FLOAT, 0, 24, D3D11_INPUT_PER_VERTEX_DATA, 0},
};

dev->CreateInputLayout(ied, 3, VS->GetBufferPointer(), VS->GetBufferSize(), &pLayout);
devcon->IASetInputLayout(pLayout); 
```

如果不是这个，那么它可能是 CreateShaderResourceFromViewFile：

```
 D3DX11CreateShaderResourceViewFromFile(dev,        // the Direct3D device
                                   L"Ptitle.png",    // load Wood.png in the local folder
                                   NULL,           // no additional information
                                   NULL,           // no multithreading
                                   &Ttitle,      // address of the shader-resource-view
                                   NULL);          // no multithreading 
```

另外，只是为了很好的衡量-尽管我确定这很好，但这里是顶点及其各自的纹理坐标

```
 // Title
    {-200.0f, 100.0f, 0.0f, D3DXCOLOR(1.0f, 1.0f, 1.0f, 1.0f), 0.0f, 1.0f},//13 BOTTOM LEFT
    {-200.0f, 200.0f, 0.0f, D3DXCOLOR(1.0f, 1.0f, 1.0f, 1.0f), 0.0f, 0.0f},//14 TOP LEFT
    {200.0f, 100.0f, 0.0f, D3DXCOLOR(1.0f, 1.0f, 1.0f, 1.0f), 1.0f, 1.0f},//15 BOTTOM RIGHT
    {200.0f, 200.0f, 0.0f, D3DXCOLOR(1.0f, 1.0f, 1.0f, 1.0f), 1.0f, 0.0f},//16 TOP RIGHT 
```

我有一种感觉，我会踢自己。非常感谢我可能收到的任何帮助，如果我仍然太含糊，请道歉。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T16:31:15.537

似乎您输入布局错误：

```
D3D11_INPUT_ELEMENT_DESC ied[] =
{
    {"POSITION", 0, DXGI_FORMAT_R32G32B32_FLOAT, 0, 0, D3D11_INPUT_PER_VERTEX_DATA, 0},
    {"COLOR", 0, DXGI_FORMAT_R32G32B32A32_FLOAT, 0, 12, D3D11_INPUT_PER_VERTEX_DATA, 0},        
    {"TEXCOORD", 0, DXGI_FORMAT_R32G32_FLOAT, 0, 24, D3D11_INPUT_PER_VERTEX_DATA, 0},
}; 
```

对于 TEXCOORD，将 24 替换为 28，因为颜色的大小为 16。

# java - 生成 IllegalAccessException

> ID：13783862
> 
> 赞同：1
> 
> 时间：2012-12-09T01:41:15.760
> 
> 标签：java, illegalaccessexception

我正在测试 StringSearch 的算法，该算法中有许多 IllegalAccessExceptions。

我想测试代码在异常情况下是否正常工作......并且测试它们也很重要，因为它们在发生异常时调用了一些函数。

我只是想知道如何隐式生成异常。

我正在尝试使用 Java 安全管理器，但不知道如何使用它来撤销程序对 String 类的访问权限。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T02:02:18.347

尝试使用 Mockito 存根方法抛出异常

```
 doThrow(new RuntimeException()).when(mockedList).clear();

 //following throws RuntimeException:
 mockedList.clear(); 
```

[http://gojko.net/2009/10/23/mockito-in-six-easy-examples/](http://gojko.net/2009/10/23/mockito-in-six-easy-examples/)

[http://mockito.googlecode.com/svn/tags/1.7/javadoc/org/mockito/internal/stubbing/Stubber.html](http://mockito.googlecode.com/svn/tags/1.7/javadoc/org/mockito/internal/stubbing/Stubber.html)

# jquery - Rails & wysihtml5 - 更改时保存

> ID：13783863
> 
> 赞同：1
> 
> 时间：2012-12-09T01:41:22.080
> 
> 标签：jquery, ruby-on-rails, wysihtml5

我们正在使用 gem 'bootstrap-wysihtml5-rails'、'0.3.1.13'。当焦点丢失时，我想保存文本区域中更改的内容。

我尝试在视图中直接使用 jquery，并被脚本标签包围：

```
$("textarea").live("blur", function(){ alert("Focus lost"); }); 
```

如果我使用“模糊”（或聚焦），则在页面加载时会触发几次警报，但在失去焦点时不会触发，当我使用“更改”时，什么都不会发生。

在另一次尝试中，我尝试以相同的行为挂钩 wysihtml5-event：

```
function integrate_wysihtml5() {
var editor = $('.wysihtml5').each(function(i, elem) {
    $(elem).wysihtml5({
        "font-styles": false, //Font styling, e.g. h1, h2, etc. Default true
        "emphasis": true, //Italics, bold, etc. Default true
        "lists": true, //(Un)ordered lists, e.g. Bullets, Numbers. Default true
        "html": false, //Button which allows you to edit the generated HTML. Default false
        "link": false, //Button to insert a link. Default true
        "image": false, //Button to insert an image. Default true,
        "color": false //Button to change color of font  
    });
});

function onChange() { alert("The content of the editor has changed"); };
editor.on("change", onChange); 
```

}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-22T13:04:44.277

```
$('.textarea').wysihtml5({
    events: {
        change: function() {
            var html = this.textarea.getValue();
            //ajax method
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-22T13:18:22.350

捕捉变化事件的好方法：

```
editor.composer.element.addEventListener("keyup", myOnChange);
editor.on("aftercommand:composer", myOnChange); 
```

但我不认为你的每一个都很好，wysihtml5 不能在多个可编辑部分上工作，这里你使用引导版，但我认为它是一样的。[这就是我写jquery.scribe](https://github.com/r043v/jQuery.scribe)的主要原因

所以，也许是这样？

```
$('.wysihtml5').each(function(i, elem) {
    var editor = $(elem).wysihtml5({
        "font-styles": false, //Font styling, e.g. h1, h2, etc. Default true
        "emphasis": true, //Italics, bold, etc. Default true
        "lists": true, //(Un)ordered lists, e.g. Bullets, Numbers. Default true
        "html": false, //Button which allows you to edit the generated HTML. Default false
        "link": false, //Button to insert a link. Default true
        "image": false, //Button to insert an image. Default true,
        "color": false //Button to change color of font  
    });

    editor.composer.element.addEventListener("keyup", myOnChange);
    editor.on("aftercommand:composer", myOnChange);
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-11-03T14:01:16.260

我正在像这样附加侦听器：

```
$("#msgtextarea").data("wysihtml5").editor.on("change",function(){
   // Do your stuff
}) 
```

希望能帮助到你。

# python - 获取 ttf/otf 字体本地化名称

> ID：13783865
> 
> 赞同：1
> 
> 时间：2012-12-09T01:41:28.923
> 
> 标签：python, c, fonts

无论如何我可以从 ttf/otf 字体文件中提取本地化名称吗？

Python 中的解决方案将是首选，但我对任何语言都很好。

非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T02:42:54.880

转到此页面

[http://wotsit.org/list.asp?al=T](http://wotsit.org/list.asp?al=T)

请注意，ttf 文件的文件格式有几个规范。选一个。您需要决定哪一个与您相关。然后，您必须设计一种方法（在 C 中带有结构的 Ex）来读取和提取您需要的内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-09T03:04:36.230

[PyPI](http://pypi.python.org/pypi)是 Python 包索引，是查找 Python 工具的好地方。我找到了一个名为[TTFQuery](http://pypi.python.org/pypi/TTFQuery/1.0.2)的包，从描述中听起来它可以满足您的需求。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-04-25T15:22:32.940

看起来字体文件可能有多个本地化名称。

使用 fontconfig 工具的示例： `$ fc-query -f '%{fullname} (%{fullnamelang}): %{file}\n' /usr/share/fonts/truetype/unfonts-core/UnBatang.ttf Un Batang,은 바탕 (en,ko): /usr/share/fonts/truetype/unfonts-core/UnBatang.ttf`

我可以`ko`使用以下顺序选择韩文 ( ) 名称`fullnamelang`： `$ fc-query -f '%{fullname[1]}\n' /usr/share/fonts/truetype/unfonts-core/UnBatang.ttf 은 바탕`

# mysql - 有条款问题

> ID：13783872
> 
> 赞同：1
> 
> 时间：2012-12-09T01:42:33.560
> 
> 标签：mysql

使用[上一个问题中的 Employee 和 Department 表](https://stackoverflow.com/questions/13783075/having-clause-trouble)

我正在尝试建立另一个组合表，显示在总部和研究部门工作的员工人数。

到目前为止，我已经尝试过了，但是在我的 having 子句中不断出现错误。有什么建议么？

```
mysql> select e.fname, d.dname
    -> from department d
    -> inner join employee e on e.dno = d.dnumber
    -> group by e.fname
    -> having d.dname='Headquarters','Research';
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to
use near ''Research'' at line 5
mysql> select e.fname, d.dname
    -> from department d
    -> inner join employee e on e.dno = d.dnumber
    -> group by e.fname
    -> having d.dname=1,5;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to
use near '5' at line 5 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-09T01:45:09.510

`IN`在`WHERE`子句中使用。

```
SELECT...
FROM...
WHERE d.dname IN ('Headquarters','Research')
GROUP BY... 
```

# c - 为什么这不是故意使无效的文件定位不引起任何错误

> ID：13783875
> 
> 赞同：0
> 
> 时间：2012-12-09T01:42:48.333
> 
> 标签：c, file, positioning, binaryfiles, fseek

所以给定一个包含 100 个字节的二进制文件。我很确定 INVALID 应该导致错误，但为什么不呢？我很困惑，一次 INVALID 应该会引发语义错误，对吗？还是我误会了什么

```
/* VALID */  fseek(fp, sizeof(char) * 2, SEEK_SET);
/* VALID */  fseek(fp, -2 * sizeof(char), SEEK_END);
/* INVALID */fseek(fp, sizeof(char)* 2, SEEK_END);
/* INVALID */fseek(fp, -2 * sizeof(char), SEEK_SET);
/* INVALID */fseek(fp, 50, SEEK_CUR);
/* VALID */  fseek(fp, -50, SEEK_CUR);
/* INVALID */ fseek(fp, 51, SEEK_CUR);
/* INVALID */ fseek(fp, -51, SEEK_CUR); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-09T01:48:44.110

你在说什么“语义错误”？

无效的文件位置将导致`fseek`失败，这将由 . 的返回值指示`fseek`。您必须接收该值并对其进行分析以确定函数是否成功。您上面的代码完全忽略了`fseek`.

请记住，标准库并不要求所有平台都支持`SEEK_END`定位。平台可能不知道文件末尾的确切位置（直到您在读取文件时实际碰到它）。例如，某些文件系统可能不会以字节为单位存储确切的文件大小，而是存储该文件占用了多少“块”或“扇区”，这只能作为近似的文件大小。出于这个原因，语言规范声明`SEEK_END`不能保证对定位进行有意义的支持。

还要记住，在某些平台上，可能完全允许在为写入而打开的文件末尾寻找过去。随后的写入操作将在新位置写入数据，同时用零填充“间隙”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-09T02:26:57.953

我不知道您使用的是哪种操作系统（您说“二进制文件”的事实表明它是 Windows），但在基于 Unix 的系统上，“查找”操作实际上并没有立即执行任何操作。所以它不太可能崩溃。

**以下是lseek**函数描述的摘录，这是**fseek**和朋友使用的核心 Unix 函数，根据W. Richard Stevens*在 Unix 环境中的高级编程：*

> 每个打开的文件都有一个关联的“当前文件偏移量”，通常是一个非负整数，用于测量从文件开头开始的字节数。读写操作通常从当前文件偏移量开始，并导致偏移量递增...
> 
> **lseek**仅记录内核中的当前文件偏移量——它不会导致任何 I/O 发生。然后，此偏移量供下一次读取或写入操作使用。

简而言之，**fseek**改变的东西很可能只是结构内的一个整数变量。只有在请求实际的 I/O 操作时，Unix 内核才会访问文件系统。所以“不可能”的位置不会导致崩溃。

# qt - QDir absolutePath 仍然返回文件名

> ID：13783876
> 
> 赞同：3
> 
> 时间：2012-12-09T01:42:53.000
> 
> 标签：qt, qfiledialog, qdir

```
QString FilePath2 = QFileDialog::getOpenFileName(this, tr("Open Directory"), "C:/", tr("Text files (*.txt)"));
QDir a = FilePath2;
qDebug() << a.absolutePath(); 
```

代码工作正常。但是 absolutePath() 仍然返回路径+文件名，而不仅仅是路径。

C:/Users/Blastcore/Desktop/text.txt 而不仅仅是 C:/Users/Blastcore/Desktop

任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-08-19T20:02:18.050

您可以使用`QFileInfo`而不是`QDir`. 用你的例子：

```
QString FilePath2 = QFileDialog::getOpenFileName(this, tr("Open Directory"), "C:/", tr("Text files (*.txt)"));
QFileInfo a(FilePath2);
qDebug() << a.absolutePath(); 
```

# .htaccess - 重写图片路径

> ID：13783880
> 
> 赞同：3
> 
> 时间：2012-12-09T01:43:24.880
> 
> 标签：.htaccess, mod-rewrite

如何重写我网站上的图像路径？

即在`imagesite.com/images`我托管我的图像和`website.com`我有我的网站上。

在`website.com`我使用托管在`imagesite.com/images`. 当然，网址`website.com`指向的`imagesite.com/images`是，有什么方法可以让它看起来像托管的图像 `website.com`吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-09T08:14:20.223

默认情况下，不，mod_rewrite 的内部重定向不能跨域工作，除非两个域都托管在同一台服务器上。

您当然可以将请求*重定向*到另一台服务器：

```
 RewriteRule ^images/(.*) http://imagesite.com/images/$1 [R] 
```

但这可能不是您想要的（浏览器的地址栏会显示图像服务器的地址）。

但是，您可以使用[P 标志](http://httpd.apache.org/docs/current/rewrite/flags.html#flag_p)让 mod_proxy 发出代理请求。手册中给出的示例正是您想要实现的：

```
RewriteRule (.*)\.(jpg|gif|png)$ http://images.example.com/$1.$2 [P] 
```

mod_proxy 非常酷，但使用服务器端语言处理它可能更经济、更容易：在内部将请求重定向到获取远程图像并输出它的脚本 -[请参阅此问题](https://stackoverflow.com/q/909374/477453)以获取解决方案。

# http - 获取请求中的零内容长度从 lighttpd (clj-http) 获得 400 Bad Request

> ID：13783892
> 
> 赞同：1
> 
> 时间：2012-12-09T01:45:46.870
> 
> 标签：http, clojure, bad-request

使用 Clojure 1.4 (Java 7) 和 clj-http (0.6.0) 库。执行获取请求时，会自动包含 Content-Length 标头并将其设置为零。一些服务器（例如 lighttpd）不喜欢这样，并以 Bad Request 响应。是否可以删除上述标题或使库默认不包含它？我在文档中找不到任何相关的东西，谷歌搜索只给了我[this](https://groups.google.com/forum/#!msg/aleph-lib/aSsqALAMhqk/WtEu6M2j64oJ)，这并没有真正的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T17:14:26.027

如果我尝试：

```
(client/get "http://thepiratebay.se" {:debug true}) 
```

我得到：

```
Request: nil
{:scheme :http,
 :http-url "http://thepiratebay.se",
 :request-method :get,
 :query-string nil,
 :uri "",
 :server-name "thepiratebay.se",

 :headers {"accept-encoding" "gzip, deflate"},
 :debug true,
 :body-type nil,
 :server-port nil,
 :body nil,
 :user-info nil}
HttpRequest:
{:requestLine #<BasicRequestLine GET http://thepiratebay.se HTTP/1.1>,
 :protocolVersion #<HttpVersion HTTP/1.1>,
 :params
 #<BasicHttpParams org.apache.http.params.BasicHttpParams@5b14a306>,
 :method "GET",
 :entity nil,
 :class
 clj_http.core.proxy$org.apache.http.client.methods.HttpEntityEnclosingRequestBase$0,
 :allHeaders
 [#<BasicHeader Connection: close>,
  #<BasicHeader accept-encoding: gzip, deflate>],
 :aborted false,
 :URI #<URI http://thepiratebay.se>} 
```

这会产生 400 错误。我尝试直接使用 Apache HttpClient 在 Java 中重现它：

```
import org.apache.http.client.methods.HttpGet;
import org.apache.http.impl.client.DefaultHttpClient;
import org.apache.http.client.HttpClient;
import org.apache.http.HttpResponse;
import org.apache.http.Header;

public class Get {
  public static void main(String args[]) throws Exception {
    HttpClient httpclient = new DefaultHttpClient();
    HttpGet httpget = new HttpGet(args[0]);
    httpget.addHeader("Connection", "close");
    httpget.addHeader("accept-encoding", "gzip, deflate");
    Header[] headers = httpget.getAllHeaders();
    for (Header h : headers) {
      System.out.println(h.getName() + ", " + h.getValue());
    }
    System.out.println();
    HttpResponse response = httpclient.execute(httpget);
    System.out.println(response);
  }
} 
```

但是，这很好用。我的猜测是，在调用 HttpClient 之前，clj-http 正在执行一些强制响应中的空正文的操作，因此 HttpClient 将标头 Content-Length 设置为 0。如果您查看源代码，则 clj-http 不会设置标头。我会将此作为 clj-http 的问题提交。

[https://github.com/dakrone/clj-http/issues](https://github.com/dakrone/clj-http/issues)

# java - 添加 TextChangedListener 时应用程序崩溃

> ID：13783893
> 
> 赞同：2
> 
> 时间：2012-12-09T01:46:03.877
> 
> 标签：java, android, nullpointerexception, listener

我正在尝试将 TextChangedListener 添加到我的 EditText：

```
 statusText = (EditText) findViewById(R.id.statusText);
        //Everythig is ok here...
        statusText.addTextChangedListener(new TextWatcher() {
            public void afterTextChanged(Editable s) {
            //After this moment app crushes with Null pointer error
            }

            public void beforeTextChanged(CharSequence s, int start, int count,
                    int after) {
            }

            public void onTextChanged(CharSequence s, int start, int before,
                    int count) {
            }
        }); 
```

我的日志：

```
 12-09 02:29:25.198: E/AndroidRuntime(5167): FATAL EXCEPTION: main
12-09 02:29:25.198: E/AndroidRuntime(5167): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.bresiu.elemelek/com.bresiu.elemelek.MainActivity}: java.lang.NullPointerException
12-09 02:29:25.198: E/AndroidRuntime(5167):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2180)
12-09 02:29:25.198: E/AndroidRuntime(5167):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2230)
12-09 02:29:25.198: E/AndroidRuntime(5167):     at android.app.ActivityThread.access$600(ActivityThread.java:141)
12-09 02:29:25.198: E/AndroidRuntime(5167):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1234)
12-09 02:29:25.198: E/AndroidRuntime(5167):     at android.os.Handler.dispatchMessage(Handler.java:99)
12-09 02:29:25.198: E/AndroidRuntime(5167):     at android.os.Looper.loop(Looper.java:137)
12-09 02:29:25.198: E/AndroidRuntime(5167):     at android.app.ActivityThread.main(ActivityThread.java:5039)
12-09 02:29:25.198: E/AndroidRuntime(5167):     at java.lang.reflect.Method.invokeNative(Native Method)
12-09 02:29:25.198: E/AndroidRuntime(5167):     at java.lang.reflect.Method.invoke(Method.java:511)
12-09 02:29:25.198: E/AndroidRuntime(5167):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:793) 
12-09 02:29:25.198: E/AndroidRuntime(5167):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:560)
12-09 02:29:25.198: E/AndroidRuntime(5167):     at dalvik.system.NativeStart.main(Native Method)
12-09 02:29:25.198: E/AndroidRuntime(5167): Caused by: java.lang.NullPointerException
12-09 02:29:25.198: E/AndroidRuntime(5167):     at com.bresiu.elemelek.MainActivity.onTabSelected(MainActivity.java:213)
12-09 02:29:25.198: E/AndroidRuntime(5167):     at com.android.internal.app.ActionBarImpl.selectTab(ActionBarImpl.java:570)
12-09 02:29:25.198: E/AndroidRuntime(5167):     at com.android.internal.app.ActionBarImpl.addTab(ActionBarImpl.java:499)
12-09 02:29:25.198: E/AndroidRuntime(5167):     at com.android.internal.app.ActionBarImpl.addTab(ActionBarImpl.java:485)
12-09 02:29:25.198: E/AndroidRuntime(5167):     at com.bresiu.elemelek.MainActivity.onCreate(MainActivity.java:107)
12-09 02:29:25.198: E/AndroidRuntime(5167):     at android.app.Activity.performCreate(Activity.java:5104)
12-09 02:29:25.198: E/AndroidRuntime(5167):     at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1080)
12-09 02:29:25.198: E/AndroidRuntime(5167):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2144)
12-09 02:29:25.198: E/AndroidRuntime(5167):     ... 11 more 
12-09 02:29:27.068: E/GetJar SDK(5181): PackageMonitor: doOnReceive(): failed
12-09 02:29:27.068: E/GetJar SDK(5181): java.lang.IllegalStateException: Unable to access the application key
12-09 02:29:27.068: E/GetJar SDK(5181):     at com.getjar.sdk.data.metadata.PackageMonitor.doOnReceive(PackageMonitor.java:113)
12-09 02:29:27.068: E/GetJar SDK(5181):     at com.getjar.sdk.data.metadata.PackageMonitor.access$000(PackageMonitor.java:62)
12-09 02:29:27.068: E/GetJar SDK(5181):     at com.getjar.sdk.data.metadata.PackageMonitor$1.run(PackageMonitor.java:87)
12-09 02:29:27.068: E/GetJar SDK(5181):     at java.lang.Thread.run(Thread.java:856)
12-09 02:29:30.628: E/GetJar SDK(5576): PackageMonitor: doOnReceive(): failed
12-09 02:29:30.628: E/GetJar SDK(5576): java.lang.IllegalStateException: Unable to access the application key
12-09 02:29:30.628: E/GetJar SDK(5576):     at com.getjar.sdk.data.metadata.PackageMonitor.doOnReceive(PackageMonitor.java:113)
12-09 02:29:30.628: E/GetJar SDK(5576):     at com.getjar.sdk.data.metadata.PackageMonitor.access$000(PackageMonitor.java:62)
12-09 02:29:30.628: E/GetJar SDK(5576):     at com.getjar.sdk.data.metadata.PackageMonitor$1.run(PackageMonitor.java:87)
12-09 02:29:30.628: E/GetJar SDK(5576):     at java.lang.Thread.run(Thread.java:856) 
```

我检查了我的 layout.xml，一切正常。我认为这是由 FragmentActivity （我的应用程序实现选项卡）引起的。我应该添加哪些附加信息来更好地解释问题？

主要活动：

[http://pastebin.com/NAiw8VFe](http://pastebin.com/NAiw8VFe)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T02:42:39.363

您的内容视图是`R.layout.main`，但您正在从 tab1 请求一个值。似乎您在选项卡内设置了视图。我建议您将所有设置操作侦听器移动到您的选项卡界面，在`onCreateView`. 通过以下方式引用正确的视图：

```
statusText = (EditText) rootView.findViewById(R.id.statusText); 
```

# c# - 使用 ProtoBuf.Meta 接口模拟 ProtoEnumAttribute

> ID：13783894
> 
> 赞同：2
> 
> 时间：2012-12-09T01:46:08.933
> 
> 标签：c#, protobuf-net

在[protobuf-net](http://code.google.com/p/protobuf-net/)中，您可以使用以下方式覆盖枚举的有线格式`ProtoEnumAttribute`：

```
[ProtoContract]
enum MyEnum
{
  [ProtoEnum(Value=1)]
  Default,
  [ProtoEnum(Value=10)]
  Foo
} 
```

使用这些属性，`Default`通常将序列化到`0`和`Foo`到的位置`1`现在将分别序列化到`1`和`10`。

我想做的是使用 中的接口来模仿这种行为[`ProtoBuf.Meta`](http://code.google.com/p/protobuf-net/source/search?q=metatype&origq=metatype&btnG=Search%20Trunk)，所以我不必注释枚举（因为我通常不会在我的项目中控制它们）。

挖掘 protobuf-net 的源代码，我设法使以下（简化了一点）工作：

```
var model = RuntimeTypeModel.Create();
var meta = model.Add(enumType, applyDefaultBehaviour: true);

var fields = meta.GetFields();

// Oh god why
var fieldNumber = 
      typeof(ValueMember).GetField(
        "fieldNumber", 
        System.Reflection.BindingFlags.Instance | 
        System.Reflection.BindingFlags.NonPublic
      );

List<string> ordered = GetDesiredEnumOrder(enumType);
int equiv = 0;
foreach (var val in ordered)
{
    var field = fields.Single(f => f.Name == val);
    fieldNumber.SetValue(field, equiv);
    equiv++;
} 
```

但是我不能依靠反射到一个私有（只读！）字段来发送这个，这只是自找麻烦。

那么，是否有一种受支持的方法可以在运行时覆盖 protobuf-net 中的枚举线值？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-09T08:52:19.860

我不在 PC 上检查这个，所以如果我在胡说八道，你必须纠正我，但它应该是这样的（在应用程序的早期）：

```
RuntimeTypeModel.Default.Add(typeof(MyEnum), false)
    .Add(1, "Default").Add(10, "Foo"); 
```

第一行告诉它`Type`在模型中添加一个新的，*而不是*( `false`) 应用任何通常的规则；第二行将 2 个成员添加到该类型的表示中，并带有所需的值。

如果这不起作用（我将在今天晚些时候尝试检查），请告诉我，我会*使其*工作（或提供等效的 API）。可能只是在没有属性的情况下，我根本没有出现这种情况来验证它。

# c# - 在 wp 中获取我的应用程序的数据使用情况

> ID：13783901
> 
> 赞同：0
> 
> 时间：2012-12-09T01:47:08.667
> 
> 标签：c#, windows-phone-7

有什么方法可以用来查看我在 Windows Phone 中的应用程序的数据使用情况吗？我使用了 WP 7.1 SDK。我需要它来监控我的应用程序使用网络的程度。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T08:55:41.507

Windows Phone SDK 没有相应的 API。

唯一可行的方法是通过某种计数器传递所有互联网连接，汇总通过它的所有字节并保存。您也可以对 Tile 更新执行此操作，但不适用于从操作系统发送给您的推送更新，因为您不是拨打电话的人。

# windows-phone-8 - 如何检测是否在后台播放另一个音频？（Windows 电话 8）

> ID：13783913
> 
> 赞同：2
> 
> 时间：2012-12-09T01:48:44.603
> 
> 标签：windows-phone-8, xaudio2

我的一个应用程序最近未能通过认证，因为：“我的应用程序停止了背景音乐，而没有询问用户何时想要播放一些音乐”。

现在的问题是：我们如何检测背景中是否有音乐在播放？

**PS：**请不要 XNA 或 XAML 答案，这是一款针对 Windows Phone Direct 3D 应用程序（仅限本机）的游戏，使用 Xaudio 2

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T21:50:29.283

您说您不想要 XNA 或 XAML 答案，但我认为要做到这一点，您需要从 Direct3D with XAML 项目模板开始。这将使您能够调用 MediaPlayer.GameHasControl

对于 Direct3D 本身，您使用[Media Foundation](http://msdn.microsoft.com/en-us/library/windows/apps/jj681688%28v=vs.105%29.aspx)但我认为您无法通过那里完成。

# python - Ruby 等价于 python nonlocal

> ID：13783915
> 
> 赞同：7
> 
> 时间：2012-12-09T01:49:08.807
> 
> 标签：python, ruby, closures, python-nonlocal

我正在尝试用 Ruby 编写一个闭包。这是用 Python 编写的代码：

```
def counter():
    x = 0
    def increment(y):
        nonlocal x
        x += y
        print(x)
    return increment 
```

Ruby 中是否有“非本地”等价物，所以我可以从增量内部访问和更改变量 x？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-09T01:58:38.210

也许是这样的：

```
class CGroup
  def counter
    @x ||= 0
    lambda do |y|
      @x += y
    end
  end
end 
```

然后：

```
group = CGroup.new
c = group.counter
c.call(1)
=> 1
c.call(1)
=> 2 
```

我不知道 Python 的`nonlocal`.

**编辑**：实例变量是不必要的，同样的事情可以通过方法局部变量来实现。这使得类是多余的，尽管在 Ruby 中很多都是在对象的上下文中发生的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-09T02:15:26.987

既然反对使用对象，为什么不直接使用 lambda？

```
counter_generator = ->(){
  x ||= 0
  ->(y){
    x += y
    puts x
  }
}

i = counter_generator.call
=> #<Proc:0x00000100867508@(irb):17 (lambda)>
i.call(1)
1
=> nil
i.call(1)
2
=> nil 
```

请注意，增量器实际上返回 nil，因为您只指定输出 x 的值，而不是返回它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-09T02:39:08.080

`nonlocal`关键字告诉 Python 要捕获哪些变量。在 Ruby 中，您不需要这样的关键字：除非另有明确说明，否则所有变量都会被捕获。

因此，与您的 Python 代码等效的 Ruby 几乎可以直接翻译：

```
counter = -> {
  x = 0
  ->y {
    x += y
    puts x
  }
}

i = counter.()

i.(2)
# 2

i.(3)
# 5 
```

不过，使用 for 的方法可能会更惯用`counter`：

```
def counter
  x = 0
  ->y {
    x += y
    puts x
  }
end

i = counter

i.(2)
# 2

i.(3)
# 5 
```

# javascript - 在图片上显示图片

> ID：13783924
> 
> 赞同：3
> 
> 时间：2012-12-09T01:51:20.913
> 
> 标签：javascript, onclick, toggle, delay

我的决赛遇到了一些麻烦。我所有的 img 都设置为 0 不透明度并在单击时更改（不透明度 1）。我的设计要求单击按钮时，我会在其顶部显示一个额外的图像，延迟 1 秒。IE 描述显示的每一层/图像。当用户点击关闭时，他们都使用它并出现一张新幻灯片，然后延迟 1 秒，显示该图层的新描述。

这是我当前的js代码：

```
window.onload = intialize;
function intialize(){
    var suit = document.getElementById("man").getElementsByTagName("img")[0];
    var undies = document.getElementById("man").getElementsByTagName("img")[1];
    var naked = document.getElementById("man").getElementsByTagName("img")[2];

    var suit = document.getElementById("layernav").getElementsByTagName("a")[0];
    var undies = document.getElementById("layernav").getElementsByTagName("a")[1];
    var naked = document.getElementById("layernav").getElementsByTagName("a")[2];   

//initial load suit
    showSuit();

    suit.onclick = showSuit;
    undies.onclick = showUndies;
    naked.onclick = showNaked;
}

function showSuit(){
    var suit = document.getElementById("man").getElementsByTagName("img")[0];
    var undies = document.getElementById("man").getElementsByTagName("img")[1];
    var naked = document.getElementById("man").getElementsByTagName("img")[2];

    suit.style.opacity = "1";
    undies.style.opacity ="0";  
    fbnaked.style.opacity ="0"; 
}

function showUndies(){
    var suit = document.getElementById("man").getElementsByTagName("img")[0];
    var undies = document.getElementById("man").getElementsByTagName("img")[1];
    var naked = document.getElementById("man").getElementsByTagName("img")[2];

    suit.style.opacity = "0";
    undies.style.opacity ="1";
    naked.style.opacity ="0";   
}

function showNaked(){
    var suit = document.getElementById("man").getElementsByTagName("img")[0];
    var undies = document.getElementById("man").getElementsByTagName("img")[1];
    var naked = document.getElementById("man").getElementsByTagName("img")[2];

    suit.style.opacity = "0";
    undies.style.opacity ="0";
    naked.style.opacity ="1";   
} 
```

两个问题，一个是如何可能添加到此代码中。其次，这个不断增长的 JS 是否存在短手，因为我的层现在越来越长。

在此先感谢您，我真的筋疲力尽，而且非常接近做得好或根本做得不好。

干杯!

我觉得它也可能看起来像这样，我就是无法拼凑：

[http://jsfiddle.net/gtU56/2/](http://jsfiddle.net/gtU56/2/)

无论是点击还是延迟，我只是在第二个 img/description 中尝试图层。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T02:01:39.410

要使图像重叠，您可能需要`position: relative`or `position: absolute`，以及`zindex`在 css 中。

[http://www.w3schools.com/css/css_positioning.asp](http://www.w3schools.com/css/css_positioning.asp)

对于速记，我建议您简单地创建一个完成整个`document.getElementById("man").getElementsByTagName("img")`部分的函数。或者，如果可以，只需使用 jQuery，这可以轻松完成

```
var suit = $("#man img")[0]; 
```

[http://jquery.com/](http://jquery.com/)

做 1 秒延迟使用`setTimeout`

[http://www.w3schools.com/js/js_timing.asp](http://www.w3schools.com/js/js_timing.asp)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-09T03:02:12.007

对于减少代码长度的问题，我总是包含一个带有短名称的函数来替换`document.getElementById`，例如：

```
function E(i) {return document.getElementById(i)} 
```

像 jquery 这样的框架已经提供了。使用附加功能可以很容易地减少您当前的代码，以避免一些重复。

```
function E(i) {
    return document.getElementById(i)
}
window.onload = intialize;

function intialize() {
    var n = E('layernav').getElementsByTagName('a');
    showSuit();
    n[0].onclick = showSuit;
    n[1].onclick = showUndies;
    n[2].onclick = showNaked;
}

function setManOpacity(op0, op1, op2) {
    var i = E('man').getElementsByTagName('img');
    i[0].style.opacity = op0;
    i[1].style.opacity = op1;
    i[2].style.opacity = op2;
}

function showSuit() {
    setManOpacity(1, 0, 0);
}

function showUndies() {
    setManOpacity(0, 1, 0);
}

function showNaked() {
    setManOpacity(0, 0, 1);
}​ 
```

# c++ - C++ 运算符重载、运算符 bool() 和运算符 !()

> ID：13783932
> 
> 赞同：3
> 
> 时间：2012-12-09T01:52:17.730
> 
> 标签：c++, operator-overloading

如果我超载了`operator bool()`. 我也需要超载`operator !()`吗？时间和原因。感谢帮助。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-09T01:54:54.427

`operator!()`如果您希望开发人员能够说出您的类的实例`!myobject`在哪里，您也应该实现。`myobject`

第 13.3.1.2 节规定，当将一元运算符应用于用户定义类型的对象时

> 内置候选函数包括 13.6 中定义的所有候选运算符函数，与给定运算符相比，
> 
> *   具有相同的操作员名称，并且
> *   接受相同数量的操作数，并且
> *   接受可以根据 13.3.3.1 将给定操作数转换为的操作数类型，以及
> *   没有与任何非模板非成员候选相同的参数类型列表。

所以编译器可能会使用内置的`bool operator!(bool)`和你的用户定义的转换，但只有当你`operator bool()`是隐式可调用的。 `operator bool()`几乎总是显式地避免它在任意整数上下文中的使用。正如 chris 在评论中提到的那样，多个用户定义的转换也可能在内置候选运算符之间产生歧义。

所以最好只定义`operator!()`自己。

# python - 尝试/排除一系列 BeautifulSoup 命令的优雅方式？

> ID：13783933
> 
> 赞同：9
> 
> 时间：2012-12-09T01:52:26.253
> 
> 标签：python, beautifulsoup

我正在解析显示项目数据的网站上的网页。这些项目有大约 20 个可能出现也可能不出现的字段——比如：价格、数量、最后购买、高、低等。

我目前正在使用一系列命令；大约 20 行`soup.find('div',{'class':SOME_FIELD_OF_INTEREST})`来查找每个单独的感兴趣领域。（有些在`div`, `span`, `dd`, 等等，所以很难只做一个`soup.find_all('div')`命令。）

我的问题：是否有一种优雅的方式`try`和`except`一切，使得所述代码的查看可以更紧凑或更简洁？现在，示例行如下所示：

```
try:
    soup.find('div', {'id':'item-pic'}).img["src"]
except:
    "" 
```

我希望将所有内容组合在一行中。我认为我不能在语法上运行 try: `<line of code> except: <code>`，而且我不确定如何编写一个`try_command(soup.find('div',{'id':'item-pic'}).img["src"])`无需实际运行命令的函数。

我很想听听是否有人有任何建议（包括：“这不可能/不切实际，继续前进”）。:)

编辑：聊了一会儿，我想我想看看内联异常处理的好做法是什么，以及这是否是正确的途径。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T02:48:37.080

也许是这样的：

```
def try_these(start_obj, *args) :
        obj = start_obj
        for trythat in args :
            if obj is None :
                return None
            try :
                if isinstance(trythat, str) :
                    obj = getattr(obj, trythat)
                else :
                    method, opts = trythat
                    obj = getattr(obj, method)(*opts)
            except :
                return None
        return obj    
src = try_these(soup, ('find', ({'id':'item-pic'},),), 
                      'img', 
                      ('get', ('src',),) ) 
```

您可以在其中传递`str`从对象或`tuple`（str 方法，元组参数）获取属性，最后您将得到`None`或结果。我对汤不熟悉，所以我不确定这是否`get('src')`是一个好方法（因为它可能不是一个字典），无论如何你可以轻松地修改那个片段来接受不仅仅是“调用或属性”的东西。

* * *

受您的问题启发，我编写了简单的 python 模块来帮助处理这种情况，您可以在[这里找到它](https://github.com/lupatus/silentcrawler)

```
import silentcrawler    

wrapped = silentcrawler.wrap(soup)
# just return None on failure
print wrapped.find('div', {'id':'item-pic'}).img["src"].value_

# or
def on_success(value) :
    print 'found value:', value
wrapped = silentcrawler.wrap(soup, success=on_success)
# call on_success if everything will be ok
wrapped.find('div', {'id':'item-pic'}).img["src"].value_ 
```

还有更多的可能性

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-09T21:00:56.633

如果我理解正确，您想根据有趣的类名查找一些字段，但它们不一定是相同的元素（不是全部`<div>`）

如果是这样，您可以使用 BeautifulSoup 传递已编译的正则表达式（[`re.compile`](http://docs.python.org/2/library/re.html#re.compile)在许多情况下代替字符串。例如：

```
print soup.findAll(re.compile(".*"), {'class': 'blah'})
# [<div class="blah"></div>, <span class="blah"></span>] 
```

我们可以使用它来整齐地循环所有可能包含图像的相关外观 DOM 元素：

```
import re
import urllib

from BeautifulSoup import BeautifulSoup as BS

html = """
<html>
<body>
<div class="blah"></div>
<span class="blah"><img src="yay.jpg"></span>
<span class="other"></div>

</body>
</html>
"""

def get_img_src(soup, cssclass):
    for item in soup.findAll(re.compile(".*"), {'class': cssclass}):
        if item.img is not None and 'src' in dict(item.img.attrs):
            return item.img['src']

soup = BS(html)
img = get_img_src(soup, cssclass = "blah")
print img # outputs yay.jpg, or would return None if nothing was found 
```

值得商榷，但我认为`if`在这种情况下使用检查更合适，因为`item.img['src']`

它同样可以这样写：

```
def get_img_src(soup, cssclass):
    for item in soup.findAll(re.compile(".*"), {'class': cssclass}):
        try:
            return item.img['src']
        except TypeError:
            pass 
```

..但是在这里捕捉很奇怪`TypeError`（因为`'NoneType' object has no attribute '__getitem__'`这并不是您要捕捉的真正异常，它是 BeautifulSoup 用于访问属性的语法的副产品）

# python - s.strip() 究竟做了什么？

> ID：13783934
> 
> 赞同：5
> 
> 时间：2012-12-09T01:52:53.633
> 
> 标签：python

有人告诉我它会删除空格，但是

```
s = "ss asdas vsadsafas asfasasgas"

print(s.strip()) 
```

打印出来

```
ss asdas vsadsafas asfasasgas 
```

不应该`ssasdasvsadsafasasfasasgas`吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-12-09T01:54:05.267

您也许应该查看该功能的文档。它修剪前导和尾随空格。 `" ss ss ".strip()`变成`"ss ss"`

相关链接：[http ://docs.python.org/2/library/stdtypes.html#str.strip](http://docs.python.org/2/library/stdtypes.html#str.strip)

此外，Python 交互式解释器中有一个非常强大的工具——你可以做一些事情，比如`help("".strip)`获取大量有用的信息。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-09T01:55:54.663

来自[Python 参考的](http://docs.python.org/2/library/stdtypes.html#str.strip)定义：

```
str.strip([chars]) 
```

*返回删除了前导和尾随字符的字符串的副本*。chars 参数是一个字符串，指定要删除的字符集。如果省略或无，chars 参数默认删除空格。chars 参数不是前缀或后缀；相反，它的值的所有组合都被剥离：

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-09T01:57:05.583

正如其他人所说，`strip()`仅删除前导和尾随空格。

你正在寻找`s.replace(" ","")`

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2018-06-19T13:13:18.450

### 据我们所知

```
s.strip() 
```

函数返回一个字符串，其中前导和尾随**空格**被删除或条纹

但是如果我们使用带参数的 strip() 函数，例如-

```
 s="your string goes here"
s.strip("string") 
```

现在我们将参数作为“字符串”传递，这将被视为一组 char **{s,t,r,i,n,g}** 现在类似：因为 s.strip() 去除了前导和尾随空格 s。 strip("string") 将在字符串 s 的左右两边一一搜索集合的所有字符。

如果字符串**s**中的字符不在集合中，则不会从该侧进行进一步检查，则将从另一侧继续搜索，直到从该侧发生类似的事情。如果在 set 中找到字符串 s 中的 char，则删除该 char，例如 -

**考虑字符串：** s="这很棘手"

**s.strip("ric")** 现在我们的集合将是 {"r","i","c"}。

现在从**字符串 s 的左侧**检查第一个字符是“t”，因为“t”不在我们的集合中，我们在这里停止。

现在从**字符串 s 的右侧**检查第一个字符是“y”，因为“y”不在我们的集合中，我们在这里停止 **输出：“这很棘手”

**s.strip("ingy")** set={"i","n","g","y"} 仅适用于右侧情况 y 被发现并在未找到 g 后将其删除，因此我们停在这里 **输出：“这是把戏”

**s.strip("the")** set={"t","h","e"} 右侧“y”不在我们的集合中，所以我们停止，因为左侧“t”存在于我们的集合中我们删除它，检查“h”-present-so 删除“h”，而不是“i”不存在停在这里

**输出：“很棘手”**

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-02-22T09:27:06.347

除了删除前导和尾随空格之外，它还删除了传递参数。

像下面这样： **string = 'shiv is awesome'**

**打印（string.strip（'sh'））**

这将打印**“iv is awesome”**

但是像这样剥离字符会变得非常混乱，因为它会导致各种结果，如下例所示。

> s = **"paandroid 是真棒爸爸"**
> 
> 做**s.strip('p')**什么**都不做**
> 
> 如果你给 s = **"paapandroid is awesomean papa"**
> 
> 在这里做**s.strip('pa')**它给了**'** android is awesomean'最后一个空格。这意味着它递归地删除在字符串的后缀和前缀上包含一个或多个每个字符的任何此类**pa 。****通过在"paapandroid is awesomean papa"**上执行 strip 来查看更多结果。

# floating-point - 英特尔：计算浮点数

> ID：13783940
> 
> 赞同：0
> 
> 时间：2012-12-09T01:55:13.990
> 
> 标签：floating-point, intel, i386

我正在阅读“C 科学计算艺术中的数值食谱”，在第一章中有一节讨论了浮点数是如何从某种架构不可知的角度表示的。这篇文章与英特尔处理器的 i386 系列有关，以及浮点数在该架构中的表示方式。我的问题专门针对如何计算有偏指数以及如何表示尾数。是否存储在尾数中的前导数。

在“C 科学计算艺术中的数值食谱”中，我得到了公式：

> s XMXB^(e - E) : s 是表示符号的单个位，M 是尾数，B 是底数（底数 2），e 是指数，E 是指数的偏差。

1.  e 是存储在 2 的补码中，还是一个无符号的 8 位字段？
2.  E 是偏差。偏差是 127 吗？
3.  尾数是读作 1.00000(2) 还是读作 0.0000000(2)？其中 (2) 是基数 2。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T02:07:58.570

是的——包括 64 位在内的所有英特尔 86 系列都支持 IEEE 754 浮点标准。

从来源：

[http://www.intel.com/standards/floatingpoint.pdf](http://www.intel.com/standards/floatingpoint.pdf)

要回答 IEEE 754 - 它是如何工作的，请参阅：

[http://en.wikipedia.org/wiki/IEEE_754-2008](http://en.wikipedia.org/wiki/IEEE_754-2008)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-09T11:33:07.030

1.  e 是一个无符号的 8 位字段。偏差 (E) 可以让您同时表示正指数和负指数。这是一个比二进制补码更适合进行实际计算的表示，即使考虑起来有点尴尬。

2.  偏差是什么取决于浮点类型。对于标准 IEEE 浮点数，它是 127。对于标准 IEEE 双精度数，它是 1023。

3.  不明白你的意思。对于标准的 float 和 double 类型，在尾数之前隐含 1 位表示正常数，而没有表示次正常数。如果您有二进制表示（符号、指数、尾数）为 的 IEEE 浮点数`0 01111111 01110111011101110111011`，您可以将其解读为`(-1)^0 * 2^(01111111b) * 1.01110111011101110111011b` 注意尾数之前的前导`1.`。

当指数尽可能小（零）时，您有次正规数。当指数尽可能大（全为）时，您有无穷大和 NaN。尾数在这里意味着不同的东西。所有其他指数代表“正常数”。

对于英特尔的 80 位`long double`类型，*没有*隐含的 1 位（它存储在尾数的高位中），我不记得当您尝试使用`long double`具有正常表示但隐含位是的 s进行算术时会发生什么关闭。我*认为*他们这样做是为了让 x87 更容易构建。

# python - multiprocessing.process 子类不起作用

> ID：13783942
> 
> 赞同：3
> 
> 时间：2012-12-09T01:55:16.817
> 
> 标签：python, inheritance, multiprocessing

我是多处理的新手，我正在尝试对项目使用 multiprocessing.Process 类而不是 threading.Thread 类，因为它们显然具有相同的变量，但是即使我复制[了这段](http://www.doughellmann.com/PyMOTW/multiprocessing/basics.html)代码，run() 似乎也没有工作......这可能与python版本或丢失文件有关吗？

```
import multiprocessing

class Worker(multiprocessing.Process):
    def run(self):
        print 'In %s' % self.name
        return

if __name__ == '__main__':
    jobs = []
    for i in range(5):
        p = Worker()
        jobs.append(p)
        p.start()
    for j in jobs:
        j.join() 
```

我找到了其他示例，但仍然不明白，请帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T02:06:51.597

这是因为多处理和线程模块之间的差异。这个问题与使用 python 多处理模块创建的子进程基本相同[不会打印](https://stackoverflow.com/questions/2774585/child-processes-created-with-python-multiprocessing-module-wont-print)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-23T01:52:24.287

您的代码有两个问题。

1.  您需要`Process.__init__`从您的 Worker 类中调用。目前，您的派生类中没有`__init__`函数。在您执行此操作之前，任何事情都不会正常工作。

2.  传达要执行的代码的首选方式不是直接覆盖，而是`run()`使用. 这允许在新进程中将参数传递给您的代码。有关所有血腥细节，请参阅文档。`target=``Process``Process``multiprocessing.Process`

# html - Css Style 不匹配或拒绝匹配元素

> ID：13783943
> 
> 赞同：0
> 
> 时间：2012-12-09T01:55:28.420
> 
> 标签：html, css

我正在开发一个也使用 jQuery 的开源流体 html 布局。有一个问题一直让我发疯，因为在过去的几个小时里我无法解决这个问题。我确定我错过了一些相当简单的东西，如果你能帮我找到它，我将不胜感激。

**问题是**当我尝试让 div#content-wrapper 有一个`min-height`和`margin-left`/时`margin-right`。基本上它应该填满页面并在左右两侧留出一些空间。

[在 cssdeck http://cssdeck.com/labs/fluid-html-template](http://cssdeck.com/labs/fluid-html-template)的工作空间中查看时看起来不错，但是当您在[http://cssdeck.com/labs/full/](http://cssdeck.com/labs/full/fluid-html-template/0)全屏查看时在 Chromium 开发人员工具 (F12) 上， fluid [-html-template/0](http://cssdeck.com/labs/full/fluid-html-template/0)我看到`#content-wrapper`该类与. 这可能是什么原因造成的？我发现覆盖它的唯一方法是将样式直接应用于具有属性的标签。`div#content-wrapper``Matched CSS Rules``div``style`

由于模板是用jade-lang 编写的，因此这里是计算的html、JavaScript 和CSS 代码，以使事情变得更容易。

* * *

**HTML：**

```
<!DOCTYPE html>
<html>
  <head>
    <link rel="stylesheet" href="http://code.jquery.com/ui/1.9.2/themes/base/jquery-ui.css">
    <script type="text/javascript" src="https://github.com/WeaponXI/cplog/raw/master/public/javascripts/jquery.js"></script>
    <script type="text/javascript" src="https://raw.github.com/WeaponXI/cplog/master/public/javascripts/jquery-ui-1.9.1.custom.min.js"></script>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>WeaponXI</title>
  </head>
  <body>
    <div class="wrapper">
      <div class="top-nav ui-widget-header">Home | Login | Etc</div>
      <div class="header">
        <div class="logo"></div>
        <div class="menu ui-widget-header">
          <div id="menu">
            <ul>
              <li> <a href="/" title="Home"> Home</a>
                <ul>
                  <li> <a href="/users" title="Users"> Users</a>
                  </li>
                  <li> <a href="/users2" title="Users"> Users</a>
                  </li>
                </ul>
              </li>
              <li> <a href="/cplog" title="Captains Logs"> Captains Logs</a>
              </li>
              <li> <a href="/contact" title="Contact"> Contact</a>
              </li>
            </ul>
          </div>
        </div>
      </div>
      <div class="left-panel"></div>
      <div id="content-wrapper" class="ui-widget-content ui-corner-all">
        <div id="content">Content</div>
      </div>
      <div class="right-panel"></div>
      <div class="bottom-panel"></div>
    </div><!--
    <end>wrapper</end>-->
    <footer>
      <div id="footer"><em>Copyright © 2013 WeaponXI.com</em></div>
    </footer>
  </body>
</html> 
```

**CSS：**

```
body, html {
    height: 100%;
    margin: 0;
}
.wrapper {
    min-height: 100%;
}
.top-nav {
    z-index:0 !important;
    padding:4px;
    background-color:#333;
    color:white;
    font-size:0.8em;
    opacity:0.6;
}
.top-nav:hover {
    opacity:0.9;
}
.header {
    height: 200px;
    background: #fff;
    overflow: hidden;
    display: block;
}
.logo {
    /*width: 451px;*/

    height:130px;
    background-image:url(https://github.com/WeaponXI/cplog/raw/master/public/images/logo.png);
    background-position:center center;
    background-repeat:no-repeat;
}
.menu {
    z-index:0 !important;
    position:relative;
    text-align: left;
    padding-left:20px;
    padding-top:5px;
    padding-bottom:5px;
    margin-top:5px;
    margin-bottom:5px;
    width:100%;
    height:30px;
font-size : 0.7em;
}
.ui-menu { position: absolute; width: 100px;}

​
#content-wrapper {
        width:auto;
        margin-left:20px;
                margin-right:20px;
                min-height:600px;
                margin-bottom:20px;
}
#content {
    padding: 20px;
    font:1em;
}
footer {

    width: auto;
    margin-left:20px;
    margin-right:20px;
    border-top: thin solid #999;
    display: block;
}
#footer {
    padding:10px;
    font-size:0.8em;
} 
```

**JavaScript：（**这只处理菜单）

```
$(function() {
    $(document.createElement('div')).attr('id', 'menu-p').appendTo('#menu');
    $(document.createElement('div')).attr('id', 'menu-c').appendTo('#menu');
    $('#menu > ul').children('li').children('a').each(function(i) {

        $(this).attr('id', 'menu-p-' + i).parent().children('ul').attr('id', 'menu-c-' + i).appendTo('#menu-c');
        $(this).appendTo('#menu-p').parent().parent().children('ul').remove();

    });
    var shownmenu;
    $('#menu-p').children('a').each(function() {
        var n = $(this).attr('id').split('-')[2];
        var button = $(this);
        if ($('#menu-c-' + n).length) {
            button.button({
                text: true,
                icons: {
                    secondary: "ui-icon-triangle-1-s"
                }
            }).hover(function() {
                $('#menu-c-' + n).show().position({
                    my: "left top",
                    at: "left bottom",
                    of: this
                });
            }, function() {
                $('#menu-c-' + n).hover(function() {
                    $('#menu-c-' + n).show();
                }, function() {
                    $('#menu-c-' + n).hide();
                });
                $('#menu-c-' + n).hide();

            });
            $('#menu-c-' + n).hide().menu();
        }
        else {
            button.button();
        }
    });
    $('#menu-p').buttonset();

}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-09T02:16:58.400

这很可能是由于无效的 HTML 而发生的

```
<body onload="__pauseAnimations();">

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"> 
```

你到达`body`然后开始一个`html`无效的新的。之前定义的 CSS 在此无法访问`html`（*无论如何这完全无效..*）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-09T02:15:49.147

```
 #content-wrapper {
    width:80%;
    height:100%;
    margin: 0 auto 0 auto;
    }
    content {
    padding: 20px;
    font:1em;
    } 
```

如果你希望它是流动的使用百分比值..

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-09T04:41:59.963

问题不在于语法。有一个从 jsfiddle 或 cssdeck 粘贴的字符。这阻止了读取该特殊字符之后的 css 规则。我已经复制粘贴了那个字符，它是：

U+200B 零宽度空间（即 Unicode U+hex 表示法）

我用[http://rishida.net/tools/conversion/](http://rishida.net/tools/conversion/)找出那个字符是什么。

# django - TemplateView 上的 CSRF 问题

> ID：13783948
> 
> 赞同：0
> 
> 时间：2012-12-09T01:56:15.423
> 
> 标签：django, csrf

我有一个非常简单的 django TemplateView 如下：

```
class Homeview(TemplateView):
    template_name = 'home.html' 
```

而且我启用了 csrfmiddleware，但是为什么没有在那个主视图上设置 CSRF cookie？我的表单依赖于该页面上的 csrf cookie。我不想使用`{% csrf_token %}`标签来做到这一点。

我尝试对此进行调试，发现 cookie 从未设置，因为它不符合 的条件`CSRF_COOKIE_USED`，我的`request.META`.

```
def process_response(self, request, response):
        if getattr(response, 'csrf_processing_done', False):
            return response

        # If CSRF_COOKIE is unset, then CsrfViewMiddleware.process_view was
        # never called, probaby because a request middleware returned a response
        # (for example, contrib.auth redirecting to a login page).
        if request.META.get("CSRF_COOKIE") is None:
            return response

        if not request.META.get("CSRF_COOKIE_USED", False):
            return response      # **It returned here, so COOKIE is never set!**

        # Set the CSRF cookie even if it's already set, so we renew
        # the expiry timer.
        response.set_cookie(settings.CSRF_COOKIE_NAME,
                            request.META["CSRF_COOKIE"],
                            max_age = 60 * 60 * 24 * 7 * 52,
                            domain=settings.CSRF_COOKIE_DOMAIN,
                            path=settings.CSRF_COOKIE_PATH,
                            secure=settings.CSRF_COOKIE_SECURE
                            )
        # Content varies with the CSRF cookie, so set the Vary header.
        patch_vary_headers(response, ('Cookie',))
        response.csrf_processing_done = True
        return response 
```

附加我的上下文处理器设置：

```
TEMPLATE_CONTEXT_PROCESSORS = (
    'django.contrib.auth.context_processors.auth',
    'django.core.context_processors.debug',
    'django.core.context_processors.i18n',
    'django.core.context_processors.media',
    'django.core.context_processors.static',
    'django.core.context_processors.tz',
    'django.core.context_processors.csrf',
    'django.core.context_processors.request',
    'django.contrib.messages.context_processors.messages',
) 
```

还发现了一些很奇怪的东西：

如果 {% csrf_token %} 出现在我的模板中，则 csrf_cookie 存在。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T13:29:18.940

如果您使用的是 1.4，请使用[`ensure_csrf_cookie`](https://docs.djangoproject.com/en/dev/ref/contrib/csrf/#django.views.decorators.csrf.ensure_csrf_cookie)，否则使用此[javascript 片段](https://docs.djangoproject.com/en/1.3/ref/contrib/csrf/#ajax)。

# c++ - C++ 将文件读入 char* 数组

> ID：13783949
> 
> 赞同：1
> 
> 时间：2012-12-09T01:56:27.910
> 
> 标签：c++

我在将 .txt 文件读入 char* 数组时遇到问题。

我有一个如下所示的levels.txt 文件：

```
level1.txt
level2.txt 
```

我在一个类中定义了我的数组

```
 char* levels[10]; 
```

我的解析函数如下所示：

```
// Parse the level list file
int Environment::parseLevels() {
    ifstream data;
    data.open("levels.txt");

    char buf[64];

    for (int i=0; i<sizeof(levels); i++) {
        data.getline(buf, 64);
        levels[0] = strtok(buf, " ");
    }
} 
```

如果我做*cout << levels[0];* 紧接着

```
levels[0] = strtok(buf, " "); 
```

然后我得到一个很好的输出。但是，当我尝试*cout << levels[0];* 从其他地方，什么都没有显示。

我究竟做错了什么？

先感谢您！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-09T02:00:15.363

返回的指针`strtok`不会永远指向有效内存，因为您要标记的缓冲区是在堆栈上声明的。`strtok`如果要在函数体外部使用字符串，则需要实际复制 的返回指针指向的字符串，而不是指针本身。

所以基本上将您的代码修改为以下内容：

```
levels[0] = new char[64];
char* temp = strtok(buf, " ");

//check for NULL pointer return from strtok()
if (temp) 
{
    //if the pointer is not NULL, copy the contents of the temporary string
    //returned by strtok into more permanent memory allocated on the heap
    //and being pointed to by levels[0]

    //Use strncpy() to prevent the risk of a buffer overflow
    strncpy(levels[0], temp, 64);
} 
```

然后在`Environment`对象的析构函数中，确保有一些循环来释放`levels`数组中每个指向通过分配的内存的成员所指向的内存`new []`。你通过调用来做到这一点`delete []`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-09T03:24:31.203

这是你的功能：

```
// Parse the level list file
int Environment::parseLevels() {
    ifstream data;
    data.open("levels.txt");

    char buf[64];

    for (int i=0; i<sizeof(levels); i++) {
        data.getline(buf, 64);
        levels[0] = strtok(buf, " ");
    }
} 
```

您正在分配`levels[0] = strtok(buf," ");`

这是在堆栈内存中创建一个对象（没有使用 new 运算符）并返回一个指向该内存的指针，一个您分配给级别 [0] 的指针。

离开这个函数后，它使用的内存会从堆栈中取出，销毁它创建的任何内存，这将是 strtok 返回的指针指向的内存。

这就是指针不再有效的原因。

不过，其他人得到了复制数据的正确方法，strcopy()。

// 对于每个字符串，将其长度分配为堆级别上的 char 缓冲区[0] = new char[64]; // 获取指向数据的指针 char* temp = strtok(buf, " ");

// 检查从 strtok() 返回的 NULL 指针 if (temp) tstrncpy(levels[0], temp, 64); // 将数据从 temp 复制到 heap

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-09T04:05:23.693

这是我最终做的事情：

```
int Environment::parseLevels(char* filename) {
    ifstream myfile("levels.txt", ifstream::in);
    int i = 0;
    while(myfile >> levels[i]) {
        i++;
    }
    return 0;
} 
```

# delphi - 在 Delphi 中访问 JVSegmentedLEDDisplay 控件中的单个数字

> ID：13783953
> 
> 赞同：1
> 
> 时间：2012-12-09T01:58:14.780
> 
> 标签：delphi, jvcl

我有一个`TJVSegmentedLEDDisplay`要用作计时器的控件（来自 JVCL）。因此，它有五个位置，两个代表小时，两个代表分钟，两个数字之间有一个冒号（即 12:34）。经过数小时的试验和搜索，我仍然无法弄清楚如何以编程方式访问每个单独的数字。在我看来，它应该是这样的：

```
LEDControl.Digits[Index].Text 
```

...但是，显然，它不是。

有什么想法吗 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T02:16:12.850

您尝试访问的[`TJvCustomSegmentedLEDDigit.Text`](http://wiki.delphi-jedi.org/wiki/JVCL_Help%3aTJvCustomSegmentedLEDDigit.Text)属性受到我要说的错误的保护，从那时起，除了直接修改[`Text`](http://wiki.delphi-jedi.org/wiki/JVCL_Help%3aTJvSegmentedLEDDisplay.Text)属性之外，这不太舒服，我找不到如何更改各个段值的方法。但是，您可以通过插入器类来解决这种受保护的访问：

```
unit Unit1;

interface

uses
  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,
  Dialogs, StdCtrls, JvExControls, JvSegmentedLEDDisplay;

type
  TLEDDigit = class(JvSegmentedLEDDisplay.TJvCustomSegmentedLEDDigit);

type
  TForm1 = class(TForm)
    Button1: TButton;
    JvSegmentedLEDDisplay1: TJvSegmentedLEDDisplay;
    procedure Button1Click(Sender: TObject);
  private
    { Private declarations }
  public
    { Public declarations }
  end;

var
  Form1: TForm1;

implementation

{$R *.dfm}

procedure TForm1.Button1Click(Sender: TObject);
begin
  TLEDDigit(JvSegmentedLEDDisplay1.Digits[0]).Text := '1';
  TLEDDigit(JvSegmentedLEDDisplay1.Digits[1]).Text := '2';
end;

end. 
```

# javascript - jquery动画图像滑出ul列表后面

> ID：13783961
> 
> 赞同：2
> 
> 时间：2012-12-09T02:00:45.523
> 
> 标签：javascript, jquery, css, animation, jquery-animate

我试图让图像在悬停时滑出，然后在它们悬停到新链接后滑回，但我似乎无法让它工作。

这是JS

```
$(function() {
  $('#menu_seo > li').hover(
    function () {
        var $this = $(this);
        $('span',$this).stop().animate({
            'right':'70px'
        }).css({
            'zIndex':'10'
        });
    },
    function () {
        var $this = $(this);
        $('span',$this).stop().animate({
            'right':'-10px'
        }).css({
            'zIndex':'-1'
        });
    }
  );
}); 
```

和我的 CSS：

```
#menu_seo {
    position:relative;
}

ul#menu_seo li span {
    height:60px;
    width:15px;
    position:absolute;
    z-index:-1;
    cursor:pointer;
}

ul#menu_seo li span.arrowout1 {
    background-image:url(../arrow.png);
    top:8px;
    left:230px;
} 
```

有人在这里看到我的问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-09T02:42:23.483

首先你不能用 做这个动画`z-index`，你应该用 css`overflow:hidden`属性创建一个遮罩区域并用 隐藏动画对象`position`。

`right`第二件事，当对象的 css 获得属性时，您不能为对象设置动画`left`，这会产生冲突并且不起作用。位置值必须准确。

我建议你使用 jQuery 绑定方法，它是可靠的，你可以使用多个事件，比如：click、hover、mouseenter、mouseleave。

这是工作的jsFiddle：http: [//jsfiddle.net/ATPG9/11/](http://jsfiddle.net/ATPG9/11/)

**jQuery：**

```
$('#menu_seo li').bind({
    mouseenter: function() {
        $(this).children('span').stop().animate({'right':'70px'},200);
    },
    mouseleave: function() {
        $(this).children('span').stop().animate({'right':'-50px'},200);
    }
}); 
```

**CSS：**

```
#left_aside {
    overflow:hidden;
    float:left;
    width:230px;
    height:900px;
    background-color:#f2dada;
}

ul#menu_seo li span    {
    height:50px;
    width:50px;
    position:absolute;
    cursor:pointer;
    right:-50px;
} 
```

# google-app-engine - 在 GAE 中使用 xlwt 在 Excel 中插入图像

> ID：13783964
> 
> 赞同：0
> 
> 时间：2012-12-09T02:01:35.697
> 
> 标签：google-app-engine, python-2.7, xlwt

我试过：

> sheetLoopParam.insert_bitmap(os.path.abspath("static/PLL_diagram2_small.bmp"), 12, 0)

但它说：

> IOError：[Errno 13] 文件不可访问：'C:\Users\rest_of_path\static\PLL_diagram2_small.bmp'

它显示的路径*是*正确的，我不明白为什么它说它无法访问它。谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-10T17:10:04.703

我想通了，或多或少。我将图像放在应用程序的根目录而不是静态目录中，似乎还可以。

像这样：

> sheetLoopParam.insert_bitmap(os.path.abspath(" **PLL_diagram2_small.bmp** "), 12, 0)

而不是这样：

> sheetLoopParam.insert_bitmap(os.path.abspath(" **static/PLL_diagram2_small.bmp** "), 12, 0)

我只需要插入一张图片就可以了。

# jquery - 获取右键单击的元素 JQuery

> ID：13783966
> 
> 赞同：1
> 
> 时间：2012-12-09T02:01:38.887
> 
> 标签：jquery, html-lists, right-click

我想得到我的`<li>`元素，当我右键单击它时：出现一个自定义的上下文菜单，我想对我最初选择的元素进行处理`<li>`。我已经尝试过了，`$(this).attr("id");`但它返回了我的上下文菜单的一项，而不是我原来的右键单击`<li>`。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-09T03:34:10.357

要检测右键单击，您可以使用，

**jQuery代码**

```
<script language="javascript" type="text/javascript">
    $(function(){
        $('#rClick').on('contextmenu', function(e) {
            alert($(this).attr('id'));
            return false;
        });
    });
</script> 
```

**html代码**

```
<ul>
<li id="rClick">AAAAAA</li>
<li id="rClick2">BBBBBB</li>
</ul> 
```

# visual-studio-2012 - Intellisense 和错误高亮在 VS2012 中默认不工作

> ID：13783969
> 
> 赞同：1
> 
> 时间：2012-12-09T02:02:14.207
> 
> 标签：visual-studio-2012, intellisense

我最近买了一台新电脑，因此不得不在上面安装 Visual Studio 2012。当我将它安装到我的最后一台计算机上时，默认情况下一切正常；这一次，自动完成功能关闭/不起作用，错误突出显示也没有。

我尝试将设置重置为[默认值](http://blog.jongallant.com/2012/07/intellisense-visual-studio-2012.html)，但这没有任何效果。

我还能尝试什么？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-09T02:20:28.950

您是否尝试过此处的第二个建议[Intellisense 和代码建议在 Visual Studio 2012 Ultimate RC 中不起作用](https://stackoverflow.com/questions/10992983/intellisense-and-code-suggestion-not-working-in-vs2012-ultimate-rc)

删除此文件夹中的文件：

%AppData%\Roaming\Microsoft\VisualStudio\11.0\ReflectedSchemas

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-09-06T04:27:00.920

选择工具 -> 选项，然后选择文本编辑器。在您使用的语言（即 C#）下，转到高级并确保选中编辑器中的下划线错误和显示实时语义错误

# objective-c - 将 CALayer 渲染为 PDF 输出时保持矢量图形

> ID：13783971
> 
> 赞同：2
> 
> 时间：2012-12-09T02:02:20.790
> 
> 标签：objective-c, macos, cocoa, pdf, calayer

我正在将包含许多数据点的绘图渲染到由 NSView 托管的 CALayer 中。在 CALayer 的 drawInContext: 中完成的所有绘图操作都是矢量操作（CGPaths 等）。

现在我想将其导出为 PDF 文件。使用 CGPDFContextCreateWithURL() 创建一个 PDF 文件，但它本质上只包含我的绘图的屏幕截图，即视图内容的位图图像。

但我想要的是基于矢量的 PDF。我知道 CALayers 将其屏幕外的内容渲染为位图，然后显示在屏幕上，但为什么不能将相同的内容渲染为矢量图形呢？

真的没有内置的方法来实现这一点吗？我一定不是唯一需要这个的人。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-10T09:03:41.713

您需要重写代码，在 CALayer 上下文上绘制的代码也应该在 PDF 上下文上绘制，不要在 PDF 上下文上渲染 CALayer，因为您将获得位图输出。

# iphone - Xcode 4.5.2：如何正确编程 CGRectMake？

> ID：13783972
> 
> 赞同：1
> 
> 时间：2012-12-09T02:02:30.667
> 
> 标签：iphone, ios, xcode, ipad, landscape

我想要一个处于横向模式的视图在编辑文本字段时向上移动（因为它被键盘覆盖），问题是我没有正确设置坐标，因为视图向左移动上升，似乎 X 值被 Y 值和画外音改变了。我究竟做错了什么？我怎样才能解决它？风景模式有什么特殊代码吗？

代码：

```
self.view.frame = CGRectMake(0, -160, 300, 480); 
```

非常感谢！！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-09T02:42:02.797

通常最乏味的错误是我们从不寻找的错误。:P

```
self.view.frame = CGRectMake(0, -160, 480, 300); 
```

# seo - 隐私政策、带有 Meta KW 和 Desc 的 ToS 页面？

> ID：13783973
> 
> 赞同：-1
> 
> 时间：2012-12-09T02:02:39.123
> 
> 标签：seo, web-crawler

我目前正在制作我的网站 SEO，我想知道我是否应该为服务条款和隐私警察页面设置一个元关键字和描述。

目前我只有这 2 个页面的元描述。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T10:46:37.430

拥有元描述总是一个好主意，因为如果精心制作，搜索引擎可能会在搜索结果片段中使用它。如果您不指定一个，搜索引擎将只使用页面中的一些其他文本。通常，指定元描述是一个好主意，因为这样您就可以更好地控制页面搜索结果中显示的内容，但如果您省略它绝对不是世界末日。

至于元关键字，据我所知，没有搜索引擎使用它，因此不值得花时间在上面。

# f# - 如何使用现有项目在 F# 中初始化序列？

> ID：13783974
> 
> 赞同：9
> 
> 时间：2012-12-09T02:02:52.010
> 
> 标签：f#, sequence

在 C# 中，您可以像这样初始化一个列表：

```
var list = new List<int> { obj1, obj2, obj3 }; 
```

我期待在 F# 中做类似的事情，但不断收到错误：

```
let list =  { obj1, obj2, obj3 } 
```

这在 F# 中可能吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-12-09T02:26:25.527

要创建（不可变的）F# 列表，您可以编写：

```
let list = [ obj1; obj2; obj3 ] 
```

还有许多其他选择。您可以使用`[| .. |]`而不是创建数组，`[ .. ]`还可以编写序列表达式来生成数据 - 类似于 C# 迭代器方法。如需更多信息，请参阅：

*   [F# WikiBook 中的序列](http://en.wikibooks.org/wiki/F_Sharp_Programming/Sequences)
*   [MSDN 上的序列 (F#)](http://msdn.microsoft.com/en-us/library/dd233209.aspx)

# php - PHP If / Else 语句在 While 循环中不起作用

> ID：13783976
> 
> 赞同：2
> 
> 时间：2012-12-09T02:03:13.663
> 
> 标签：php, while-loop, if-statement

我已经在这段代码上工作了大约一个小时，但似乎无法弄清楚为什么它不起作用。PHP 是否允许在 While 循环中使用 If/Else 语句？我尝试在 If/Else 语句中添加不同的回声，而后者 (Else) 不会显示。这是因为我试图使用相同的变量名吗？

```
while($row = mysql_fetch_array($result))

{

//assign variables
$title = $row['title'];
$file_url = $row['file_location'];
$category = $row['category'];
$layout = $row['layout'];

    If ($layout = "vertical")       
    {
        //Page Layout
        $BODYLAYOUT = "vertical_body";
        $GAMECONTAIN = "vertical_gameContain";
        $GAMEWIDTH = "vertical_game";
    }
    Else
    {
        // Page Layout
        $BODYLAYOUT = "horizontal_body";
        $GAMECONTAIN = "horizontal_gameContain";
        $GAMEWIDTH = "horizontal_game";
    } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-09T02:06:21.040

```
if ($layout = "vertical") 
```

应该：

```
if ($layout == "vertical") 
```

否则，您正在为“垂直”的 $layout 分配一个值，而不是比较它的值以查看它是否等于“垂直”。否则，该分配将等于 true，原因是第一部分运行而 ELSE 不运行。

我用来防止此类事故的一种方法是将常量放在首位，例如：

```
if ("vertical" == $layout) 
```

这样，如果我错过了另一个 = 符号 PHP 将出错，而不是错误地分配值。

# php - php和html表单在同一页面上

> ID：13783979
> 
> 赞同：0
> 
> 时间：2012-12-09T02:04:21.547
> 
> 标签：php, html, mysql

我正在学习php。我将一些值从一个页面传递到另一个页面，并让用户在此页面中输入表单，然后存储到数据库中。

我想留在同一页上，所以不是第一页-

```
<form method="post" action="update.php">
   <input type="text" name="name" value="value1" />
</form> 
```

更新.php

```
<?php
   $name= $_POST['name'];
?> 
```

我想在同一页面上，因为我使用 get() 从上一页获取一些变量和数组

```
<?php 

$count= $_GET['count'];
$sum= $_GET['Sum'];
for ($i=0;$i<$count;$i++){
echo unserialize($_GET['serialized_name'])[$i];
?> 
```

因为我还需要发送表单值，所以我不确定如何将我得到的值传递到下一页——这就是为什么我希望在同一页面上而不是去 update.php。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T02:11:13.690

试试这个，把所有这些代码放在你想停留的页面中（我说的是 update.php 这里）：

```
<?php
    if($_POST['submit_button'] == "Submit")
    {
        $name= $_POST['name'];
    }
?>

    <form method="post" action="update.php">
       <input type="text" name="name" value="value1" />
       <input type="submit" name="submit_button" value="Submit"/>
    </form> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-09T04:54:29.113

您可以使用 .php 上方的隐藏字段将更多数据传递给 update.php `<input type=submit`。

例如`<input type="hidden" name="some_data" value="<?php echo $some_data; ?>" />`

当然，任何网络访问者如果使用浏览器的“查看源”功能，都可以看到这些数据，因此只能对不会导致安全问题的数据执行此操作。

然后，在 update.php 中，您可以通过执行类似的操作来访问该数据`$some_data = $_POST["some_data"]`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-09T05:21:24.917

```
 <?php 
       @session_start();
       $_session['count']= $_GET['count'];
       $_session['sum']= $_GET['Sum'];
       for ($i=0;$i<$_session['count'];$i++){

          //make necessary changes here as well
         echo unserialize($_GET['serialized_name'])[$i];

         //use session to store your data from previous page
       ?>
     <?php
         //put this code above the form to process the submitted data which was previously sent to update.php

      if(isset($_POST[submit])){
                //Your code
        e.g.
              $name=$_POST['name']
           //whenever you want to access previous data just get it from session variable.
         e.g. $count=$_SESSION['count'];

      }?>

     <html>
            <!--Submit the data of the form to itself instead of update.php -->
       <form method="post" action="<?php echo $PHP_SELF;?>">
           <!--your html code -->
       </form>
     </html> 
```

# python - 在 Python 中计算内存碎片

> ID：13783983
> 
> 赞同：4
> 
> 时间：2012-12-09T02:05:19.533
> 
> 标签：python, memory, fragmentation

我有一个长期运行的过程，不断分配和释放对象。尽管正在释放对象，但 RSS 内存使用量会随着时间的推移而上升。

如何计算发生了多少碎片？一种可能性是计算 RSS / sum_of_allocations 并将其作为指标。即使那样，我该怎么办计算分母（sum_of_allocations）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T03:20:06.447

查看垃圾收集器界面，gc。

[http://docs.python.org/2/library/gc.html](http://docs.python.org/2/library/gc.html)

您可以使用 gc.get_objects() 检查正在跟踪的对象

“作为一般规则，不跟踪原子类型的实例，而跟踪非原子类型（容器、用户定义的对象......）的实例。”

还有 gc.garbage，它会查找无法释放但无法访问的对象。

# mysqli - 为了删除未定义的变量，下面的逻辑应该是什么？

> ID：13783989
> 
> 赞同：2
> 
> 时间：2012-12-09T02:07:32.813
> 
> 标签：mysqli, php

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T02:42:20.180

`isset($_POST['registerbtn'])`在您的支票上方，设置`$numrowsstmt`为 null 或其他一些虚假值。

将 的构造移至`$courseHTML`检查下方*，*的构造*上方*。`isset($_POST['registerbtn'])`*`$form`*

 *这样，变量就在范围内，并且有机会实际具有值。你怎么期望这会起作用？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-09T04:12:24.953

该`isset`功能是您想要的，或者可能是`empty`.

例如

`if ($validSubmission && $course == $_POST['courses'] && (isset($numrowsstmt) && $numrowsstmt != 1) {`*

# xml - 什么是对象树 - XML 解析？

> ID：13783991
> 
> 赞同：0
> 
> 时间：2012-12-09T02:07:59.197
> 
> 标签：xml

我正在阅读有关使用 Java 进行 XML 解析的教程 - [http://www.vogella.com/articles/JavaXML/article.html](http://www.vogella.com/articles/JavaXML/article.html)

他说“在 DOM 中，您可以通过对象树访问 XML 文档”。我猜它是某种数据结构并在谷歌搜索“对象树数据结构”但没有找到任何这样的 DS。

对象树与树 DS 相同还是甚至不是 DS ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T02:09:52.427

对象树是在节点处保存对象的树数据结构。在此处提到的特定情况下，DOM（文档对象模型）是表示正在访问的 XML 的树结构。DOM 树中的每个节点都将对应一个 XML 节点。

维基百科条目：[http ://en.wikipedia.org/wiki/Document_Object_Model](http://en.wikipedia.org/wiki/Document_Object_Model)

W3C：[http ://www.w3.org/DOM/](http://www.w3.org/DOM/)

# php - 如何上传 PHP 脚本而不会在上传期间抛出错误？

> ID：13783992
> 
> 赞同：1
> 
> 时间：2012-12-09T02:08:05.640
> 
> 标签：php, ftp

我有一个相当有趣的问题。我使用 FileZilla 和 Notepad++ 来编辑我的 PHP 脚本。一个名为 的脚本`functions.php`被编辑和更改了很多。不幸的是，每次我编辑并重新上传它时，我都会检查我的错误日志，发现每次重新上传时都会在我的网站上抛出大约 5 个错误。只需要几秒钟，但由于脚本包含在我网站上的几乎每个页面中，所以几秒钟就足以引发错误。

我在想，也许，我可以有一个`functions2.php`基本相同的。`functions2.php`如果不可用，是否有办法让我网站上的脚本`functions.php`获取？谢谢。

编辑：我得到的错误通常类似于“解析错误：语法错误，意外 $end ...”，我认为这意味着脚本只是部分上传。这可能使 file_exists 不是最好的解决方案，因为文件在那里，但它只是“一半”在那里。

上传和重命名似乎是一个很好的解决方案，但每次上传都有点乏味:) 我重新上传并测试了很多。

有没有办法检查 php 文件中的 PHP 语法错误？在这种情况下，这将非常方便......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T02:32:19.110

不使用 FTP，而是考虑一个 PHP / Perl / Ruby 脚本，它将获取正在上传的文件的 POST，以及要替换的文件的文件名和 MD5 / SHA（以确保您在帖子中拥有所有内容）。您还需要添加一些安全性，例如在 Apache 登录之后。

一旦发布的文件被 PHP / Perl / Ruby 脚本接受，md5 检查（并且安全性也通过了），服务器将用“新”版本覆盖“旧”版本。这应该比 FTP 快很多并减少错误。

唯一可能的问题是需要将服务器上的文件权限设置为允许来自 Web 服务器的写访问。

只是一个想法。

另一个想法...

*   上传到暂存目录
*   使用 ssh 登录并执行`mv /staging/<file> ./`

也许你也可以让一个 cron 作业每小时执行一次。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-09T02:25:36.973

您可以执行以下操作：

1) 如果 function.php 不存在，则具有获取 function2.php 的代码

看

[http://php.net/manual/en/function.file-exists.php](http://php.net/manual/en/function.file-exists.php)

和

[http://php.net/manual/en/function.require.php](http://php.net/manual/en/function.require.php)

```
<?php
if(file_exists('function.php')){
    require_once 'function.php';
}else{
    require_once 'function2.php';
}
?> 
```

2）更新文件时，删除function.php，然后将新文件上传到newfile.php，然后将newfile.php重命名为function.php

这样您就不会尝试获取一半上传的文件，并且重命名非常快。

您可能会在 file_exists 和 require_once 之间出现错误（如果存在，则将其删除，然后到达 require_once 并且不再存在）。但希望这不会经常发生，也许。至少，如果发生这种情况，它将完全失败，并且他们可以重新加载页面。也许它不会发生。

# java - Java Bluej 实例不显示打印

> ID：13783993
> 
> 赞同：0
> 
> 时间：2012-12-09T02:08:18.120
> 
> 标签：java, bluej

我正在使用 bluej 为用户列表制作程序。当我编译并运行代码时，bluej 不会给出任何错误。但是当我创建一个类的新实例时，它看起来什么都没有发生。从我的实例打印一行到我的终端窗口不起作用。如何让我的实例打印显示在我的终端窗口中？

```
 import java.util.*;
   import java.text.*;

   public class Main{
       private ArrayList<List> userlists;
       public Main(){
          System.out.print('\f');
          System.out.println("this text will show.");
          newlist("listname");
       }
       public void newlist(String listname){
          System.out.println("this text will show too!");
          List userlist = new List(listname); //terminal does not show lines printed by constructor of List?
          userlists.add(userlist);
          userlist.printSomeText(); //second attempt to print a line, does not show in terminal.
       }
    }

    public class List {
        private String listname;
        public List(String ln) {
            listname = ln;
            System.out.println("this text does not show.");
        }
        public void printSomeText(){
            System.out.println("this text neither.");      
        }
    } 
```

我通过（首先编译两个类，然后）右键单击 bluej 界面中的 Main 类并选择 new Main() 来运行它。当我这样做时，会出现一个终端窗口，其中显示：

```
this text will show.
this text will show too! 
```

但它没有显示：

```
this text will show.
this text will show too!
this text does not show.
this text neither. 
```

它没有显示任何错误，所以我想知道出了什么问题以及如何获得第二个结果，显示这四行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T02:12:16.137

不要被迷惑

```
public Main() {
   ...
} 
```

这是一个*构造函数*。您需要一个`main`方法入口点来调用它：

```
public static void main(String[] args) {
   new Main();
} 
```

*旁白*：不要忘记实例化你的`userlists` `ArrayList`以避免得到`NPE`：

```
private ArrayList<List> userlists = new ArrayList<>(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-09T02:26:57.607

首先，您`public`在同一个`Java`文件中没有两个类。

其次，您必须在使用该变量或字段之前初始化该变量，这在您的问题中没有发生。我已经对您的代码进行了一些修改，这些修改将根据您的需要进行，并且还会打印您想要打印的第二行。

```
import java.util.ArrayList;

public class Main {
    private ArrayList<List> userlists;

    public Main() {
        userlists = new ArrayList<List>();
        System.out.print('\f');
        System.out.println("this text will show.");
        newlist("listname");
    }

    public void newlist(String listname) {
        System.out.println("this text will show too!");
        List userlist = new List(listname); // terminal does not show lines
                                            // printed by constructor of List?
        userlists.add(userlist);
        userlist.printSomeText(); // second attempt to print a line, does not
                                    // show in terminal.
    }

    public static void main(String ... args){
        new Main();
    }
}

class List {
    private String listname;

    public List(String ln) {
        listname = ln;
        System.out.println("this text does not show.");
    }

    public void printSomeText() {
        System.out.println("this text neither.");
    }
} 
```

# python - 这是线程的正确操作流程吗？

> ID：13783994
> 
> 赞同：2
> 
> 时间：2012-12-09T02:09:27.183
> 
> 标签：python, multithreading

过去我没有做太多线程。我对它应该如何工作的假设如下：

启动 n 个线程

当一个线程完成时，启动一个新线程并终止现有线程。这合适吗？

我在 python 中工作，所以我打算让我的线程中的 main 方法在它死之前创建一个新实例。我不完全确定这是安全的。有什么建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-09T03:06:54.643

一个好的开始是研究[生产者-消费者问题](http://en.wikipedia.org/wiki/Producer-consumer_problem). 它涉及两个不同的函数来操作一个固定大小的队列。这个问题当然有多种解决方案，但处理这个问题的常用方法是使用信号量和互斥体，它们只是二进制信号量，它们基本上锁定和解锁关键部分，即操作队列的函数。考虑到这一点，作为示例，您将为您拥有的每个函数创建 n 个线程，在此示例中为生产者函数和消费者函数。然后在生产者函数中，您将有一个由互斥锁/解锁包围的 putItem() 调用，该调用仅允许一个进程在互斥调用之间运行，然后由一个信号量包围，该信号量在队列为空时解锁并在队列为空时锁定满的。在消费者函数中，您将有一个由信号量包围的互斥锁包围的 getItem() 调用，该信号量在队列满时解锁，在队列为空时锁定。我建议查看维基百科页面，甚至可能查看[POSIX pthreads](http://www.gentoo.org/doc/en/articles/l-posix1.xml)它在 C 中，但概念就在那里。然后，当您准备好应用您在 Python 中学到的知识并查看他们的线程文档时。

# node.js - Socket IO：何时使用房间，何时使用命名空间？

> ID：13783995
> 
> 赞同：2
> 
> 时间：2012-12-09T02:09:50.163
> 
> 标签：node.js, socket.io

我正在构建一个用于协作编辑文档的 Node.js 应用程序。每个文档都有一个单独的私人聊天（使用 Socket.IO 构建）。

现在我不清楚将每个聊天限制为仅限当前编辑该特定文档的成员的正确方法是什么。

我应该使用单独的房间吗：

```
io.sockets.on('connection', function (socket) {
      socket.join(documentId);
      socket.broadcast.to(documentId).emit('new member');
    }); 
```

或者我应该将每个文档聊天划分为新的命名空间：

```
var chat = io
    .of('/chat/' + documentId)
    .on('connection', function (socket) {...}
```

还是有第三种方法更适合我的需要？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T08:03:31.463

Socket.IO 命名空间用于控制服务器和客户端之间的通信管道。这将允许您有效地将同一连接用于多种目的。

您概述了使用房间和命名空间的好方法。在您的情况下，这些应该一起使用。这不是一种二选一的情况。

最后，如果您发现消息的内置分段不能满足您的需求，您可以随时编写自己的，并在需要时简单地发出。我经常走这条路。