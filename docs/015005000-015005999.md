# StackOverflow 问答 15005000-15005999

# c# - 同步框架清除跟踪表

> ID：15005000
> 
> 赞同：1
> 
> 时间：2013-02-21T14:40:22.763
> 
> 标签：c#, asp.net, .net, microsoft-sync-framework

让我解释一下我的项目的场景：

在系统架构中，节点多，中间服务器少，主服务器一台。

**问题描述：**

为了简化场景，我不解释中间服务器。常见的情况是假设系统中有 n 个节点（Node#1、Node#2、...、Node#n）和 1 个服务器（Server#1）。大多数本地输入将在节点级别完成，主要配置将在服务器级别完成。现在所有节点都应该将自己的数据同步到服务器（即上传），同时，它们应该从服务器下载其他节点的数据。因此，在所有节点和服务器上的同步过程数据将相同。有可能在同步的时候，任何一个节点都处于离线状态，所以这个节点在线时会从服务器上传和下载数据。

我的团队的解决方案：

我的团队建议使用 Microsoft 的同步框架 2.1。我们为概念验证创建了一个示例应用程序。该示例有一台服务器和一个节点，我们用数据填充服务器，就好像它来自节点#2 并将其与节点#1 同步，同步和冲突得到了正确解决。请注意，我们已经处理了主键和冲突。

我们目前看到的问题如下：

1.  在服务器和所有节点之间成功同步后，我们应该删除/清空跟踪表条目，否则表大小将呈指数增长。同步成功后，所有节点都将清除其跟踪表，只有当所有节点都同步时，服务器才会清除跟踪表，否则将保留这些表。当服务器有跟踪表条目并且节点已清除表时，同步框架将再次尝试同步所有节点，这将导致重复条目。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T08:38:31.813

跟踪表用于更改跟踪，如果清除它，Sync Fx 将如何知道自上次同步以来发生了什么变化？

如果要减小大小，可以运行定期元数据清理并指定较低的保留期。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T08:59:23.107

无法清除跟踪数据。正如[JuneT](https://stackoverflow.com/a/15019949/299164)已经提到的。

每条记录都需要有跟踪记录。所以一条跟踪记录的id等于对应记录的id。

确实，这是很多数据。我们的环境中有 200 多张桌子。这些表包含一个相应的跟踪表。所以表格总数超过400张。

在 10GB 的数据库中，跟踪数据约为 3GB (30%)。这个比率当然取决于每个数据模型，但它可以为您提供跟踪数据开销的指示。

# iphone - 成功服务器响应并成功插入数据库后未获取服务器响应字符串

> ID：15005001
> 
> 赞同：0
> 
> 时间：2013-02-21T14:40:23.170
> 
> 标签：iphone, ios, xcode, httpresponse

```
- (void)viewDidLoad
{
    [super viewDidLoad];

    NSString *jString = @"{\"block_face_line\" : [{\"longitude\" : -71.34345555,\"latitude\" : 42.7794343 },{\"longitude\" : -71.4473179666667,\"latitude\" : 42.7336227666667  },  {\"longitude\" : -71.4461721166667,\"latitude\" : 42.7321493333333  },{\"longitude\" : -71.4473179662267,\"latitude\" : 42.726227666667  } ],\"block_face_curb_side\" : \"LEFT\",\"block_face_collector_id\" : \"3\"}";

    NSLog(@"JSON : : : : %@",jString);

    NSURL *passurl = [NSURL URLWithString:[[NSString stringWithFormat:@"https://XXXX:XXXX@parkme.goldenware.com/cgi-bin/db.test?COMMAND=add&TABLE=block_faces&USER=1&SUBSYSTEM=json"] stringByAddingPercentEscapesUsingEncoding:NSUTF8StringEncoding]];
    NSLog(@"passurl:%@",passurl);

    NSMutableURLRequest *request = [NSMutableURLRequest requestWithURL:
    [NSURL URLWithString:[passurl absoluteString]]
    cachePolicy:NSURLRequestReloadIgnoringLocalCacheData timeoutInterval:60.0];

    NSLog(@"request:%@",request);

    mFinalData = [jString dataUsingEncoding:NSUTF8StringEncoding];

    [request setHTTPMethod:@"POST"];
    [request setValue:@"application/json" forHTTPHeaderField:@"Accept"];
    [request setValue:@"application/json" forHTTPHeaderField:@"Content-Type"];
    [request setValue:[NSString stringWithFormat:@"%d", [jString length]] forHTTPHeaderField:@"Content-Length"];
    [request setHTTPBody:mFinalData];

    receivedData = [[NSMutableData alloc] init];

    NSURLConnection *connection = [NSURLConnection connectionWithRequest:request delegate:self];
    [connection start];
    NSLog(@"Connection = %@", connection);

    if(connection)
    {
        self.receivedData = [[NSMutableData data] initWithCapacity:2048];
        NSLog(@"receive data:%@",self.receivedData);
        NSString *stringData= [[NSString alloc] initWithData:receivedData
                                                    encoding:NSUTF8StringEncoding];
        NSLog (@"result%@", stringData);
    }
}

- (void)connection:(NSURLConnection *)connection didFailWithError:(NSError *)error
{
    NSLog(@"Connection Failed To Response");
    self->operationFailed = YES;
}

- (void)connection:(NSURLConnection *)connection didReceiveData:(NSData *)data
{
//  if (!operationBreaked)
//      [self.receivedData appendData:data];
//    else
//    {
//      [connection cancel];
//      NSLog(@" STOP !!!!  Receiving data was stoped");
//  }

    NSLog(@"DONE1111");
    [receivedData appendData:data];
    NSLog(@"didreceivedata:%@",receivedData);
}

- (void)connection:(NSURLConnection *)connection didReceiveResponse:(NSURLResponse *)response {

    NSLog(@"[DO::didReceiveData] %d operation", (int)self);
    NSLog(@"[DO::didReceiveData] ddb: %.2f, wdb: %.2f, ratio: %.2f",
          (float)bytesReceived,
          (float)expectedBytes,
          (float)bytesReceived / (float)expectedBytes);

    if ([response isKindOfClass:[NSHTTPURLResponse class]])
    {
        NSHTTPURLResponse *httpResponse = (NSHTTPURLResponse*) response;
        NSLog(@"Received status code: %d %@", [(NSHTTPURLResponse *) httpResponse statusCode],
              [NSHTTPURLResponse localizedStringForStatusCode:[(NSHTTPURLResponse *) httpResponse statusCode]]) ;
    }
    NSLog(@"soapMsg1: %d", [receivedData length]);
    [receivedData setLength:0];
}

- (void)connectionDidFinishLoading:(NSURLConnection *)connection
{

    NSLog(@"DONE. Received Bytes: %d", [receivedData length]);
    NSString *theXML = [[NSString alloc] initWithBytes:[receivedData mutableBytes] length:             [receivedData length] encoding:NSUTF8StringEncoding];
    NSLog(@"theXML:%@",theXML);
    connection = nil;
    receivedData =nil;
    operationFinished = YES;
}

- (BOOL)connection:(NSURLConnection *)connection canAuthenticateAgainstProtectionSpace:(NSURLProtectionSpace *)protectionSpace {
    return [protectionSpace.authenticationMethod isEqualToString:NSURLAuthenticationMethodServerTrust];
}

//
// connection:didReceiveAuthenticationChallenge:
//
// Show the authentication challenge alert to the user (or gives up if the
// failure count is non-zero).
//
- (void)connection:(NSURLConnection *)aConnection didReceiveAuthenticationChallenge:(NSURLAuthenticationChallenge *)aChallenge
{
    [aChallenge.sender useCredential:[NSURLCredential credentialForTrust:aChallenge.protectionSpace.serverTrust] forAuthenticationChallenge:aChallenge];
    NSLog(@"Challenge Protection Space = %@",aChallenge.protectionSpace.host);
}

- (void)didReceiveMemoryWarning
{
    [super didReceiveMemoryWarning];
    // Dispose of any resources that can be recreated.
} 
```

获取服务器响应 200 但未获取响应字符串，来自服务器的响应应如下所示：

> // 状态码：OK，状态描述：OK ID=77

```
Or only ID number, for Example: `123` 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T15:05:05.100

在哪里`receivedData`定义？是ivar吗？您的日志记录是什么样的`-connection:didReceiveData:`？是否`recievedData`在日志中显示数据？如果是这样，当你到达的时候是什么清除它`-connectionDidReceiveResponse:`？

很可能，要么`receivedData`没有正确定义，所以总是如此`nil`，或者没有被正确保留，所以在你到达之前它被释放了`-connectionDidReceiveResponse:`

# php - php：sql更新查询未按预期工作

> ID：15005007
> 
> 赞同：-2
> 
> 时间：2013-02-21T14:40:44.463
> 
> 标签：php, mysqli, sql-update

我正在使用以下查询

```
$mysqli->query("UPDATE `edit_users` SET `password` = \"" . hash('sha512', $_POST['change_pw_password']) . "\", `single_login_pw` = NULL WHERE `id` = \"" . $userinfo['id'] . "\""); 
```

结果，这将更改具有特定 ID 的用户的密码，但将所有用户的 single_login_pw 设置为 NULL。

知道为什么所有 single_login_pws 都设置为 NULL 以及如何解决问题？

编辑：我也尝试使用 mysql_query() ......这是同一回事。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T14:45:02.623

尝试使用`LIMIT`

```
"UPDATE `edit_users` SET `password` = '" . hash('sha512', $_POST['change_pw_password']) . "', `single_login_pw` = NULL WHERE `id` = '" . $userinfo['id'] . "' LIMIT 1" 
```

我还将您的双引号更改为您的字符串周围的单引号。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T14:45:08.353

尝试这个

```
$hash = hash('sha512', $_POST['change_pw_password']);
$uid = $userinfo['id'];
$mysqli->query("UPDATE edit_users SET password = $hash, single_login_pw = NULL WHERE id = $uid"); 
```

# algorithm - 给定一些整数范围，从每个范围中找到一个包含至少一个整数的最小集合

> ID：15005008
> 
> 赞同：6
> 
> 时间：2013-02-21T14:40:47.010
> 
> 标签：algorithm

我怎样才能找到一组最小数量的整数，以便对于某些给定的整数范围，对于每个范围，该集合至少包含一个整数。例如，如果给我这些范围：

```
[0, 4], [1, 2], [5, 7], [6, 7], [6, 9], [8, 10] 
```

然后一些解决方案集是：`{ 1, 6, 8 }, { 2, 7, 9 }, { 1, 7, 8 }` 等。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-21T14:45:39.720

想象一下，您绘制所有按**最终值**排序的范围，就像您在日程安排器中绘制会议一样。

**您可以以贪婪的方式**直观地选择您的数字，以便第一个是首先完成的段（在您的示例中，这将是`2`）。

然后你删除所有包含该数字的段，然后重新开始。

该算法将产生解决方案`{ 2, 7, 10 }`

```
0  1  2  3  4  5  6  7  8  9 10
   ----
-------------
      ^        -------
      |           ----
                  ----------
                     ^  -------
                     |        ^
                              | 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-21T14:54:32.860

**算法：** 对起点和终点进行排序。越过它们，直到遇到端点。将其添加到答案中并删除所有起点已经通过的范围（即包含当前端点的范围）。重复直到剩下一点。

**例子：**

```
[0, 4], [1, 2], [5, 7], [6, 7], [6, 9], [8, 10] 
```

排序后会变成

```
[0, [1, 2], 4], [5, [6, [6, 7], 7], [8, 9], 10], ans = [] 
```

第一个端点是`2]`，我们将它添加到`ans`和删除在它之前打开的范围，即`[0`和`[1`：

```
[5, [6, [6, 7], 7], [8, 9], 10], ans = [2] 
```

现在第一个端点是`7]`，我们删除范围`[5, 7], [6, 7], [6, 9]`：

```
[8, 9], ans = [2, 7] 
```

最后添加`9`和删除最后一个范围。结果将是`[2, 7, 9]`。

**复杂：**

排序将花费 O(nlogn) 时间，之后您将传递每个元素两次：一次是在寻找下一个端点时，一次是在删除所有当前打开的间隔时，这是线性的，总复杂度将`O(nlogn)`来自排序。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-06-30T20:52:52.093

我们按结束数字对间隔进行排序。对于任何一个区间，如果它的起点不大于前一个终点，（由于区间已经排序，终点不小于前一个终点），那么我们在前一个终点有重叠，可以跳过这个区间。如果当前间隔的开始大于前一个结束，我们没有重叠，并将当前结束添加到结果集中。

[![在此处输入图像描述](../Images/cae961911623a4f8ebc52fc6cc62a43c.png)](https://i.stack.imgur.com/4gT0J.png)

考虑区间`(0, 3), (2, 6), (3, 4), (6, 10)`。排序后，我们有`(0, 3), (3, 4), (2, 6), (6, 10)`. 我们从`result = [3]`和开始`previous = 3`。因为`3 <= previous`，我们跳过区间`(3, 4)`；`previous`保持不变。因为`2 <= previous`，我们跳过区间`(2, 6)`；`previous`保持不变。最后，因为`6 > previous`，我们添加`10`到结果中，并更新`previous = 10`。算法终止；答案是`[3, 10]`。

时间复杂度：`n log(n)`，其中`n`是区间数。

# c# - 当且仅当整个单词匹配时如何替换richtextbox.rtf？

> ID：15005009
> 
> 赞同：0
> 
> 时间：2013-02-21T14:40:47.023
> 
> 标签：c#, .net

我原来的替换代码是。

```
rtTextArea.Rtf = rtTextArea.Rtf.Replace(oldtext, newtext); 
```

但问题是它替换了所有出现的单词而不是所需的单词，例如原始单词：- 你好，我的名字是 serak，我在以色列 replace() - 是整个单词 chages 到“是 serak 和 am in arereal "

无论如何我可以包含一个条件或匹配整个单词的东西吗？我的工作环境 C#。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T14:55:26.267

使用[正则表达式](http://msdn.microsoft.com/en-us/library/az24scfc.aspx)。在这个例子中`\b`代表一个字边界。

```
var regExp = new System.Text.RegularExpressions.Regex(@"\bis\b");
rtTextArea.Rtf = regExp.Replace(rtTextArea.Rtf, "are"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-20T16:29:02.127

之前的帖子显示

var regExp = new System.Text.RegularExpressions.Regex(@"\b"+oldtext+@"\b"); rtTextArea.Rtf = regExp.Replace(rtTextArea.Rtf, newtext);

这与第一篇文章有​​点不同。注意额外的 b 和 @

这对我有用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-20T16:34:30.613

为此使用 RegEx 是正确的方法，但为了简洁起见，您还可以在要替换的单词前面/附加一个空格，以确保它不是另一个单词的一部分。

例如`wordToReplace = " " + wordToReplace + " ";`

# svn - svn树冲突：我做错了什么？

> ID：15005014
> 
> 赞同：2
> 
> 时间：2013-02-21T14:41:06.150
> 
> 标签：svn, merge, tree-conflict

每当我尝试在 SVN 中合并时，我都会遇到成堆的树冲突。好吧，在这个示例脚本的情况下，只有一个，但仍然如此。

```
#!/bin/bash
svnadmin create repo
svn checkout file://`pwd`/repo wc
cd wc
mkdir trunk branches
svn add trunk branches
svn commit -m 'created trunk and branches'
echo red > trunk/colors
svn add trunk/colors
svn commit trunk -m 'created trunk/colors with red inside'
svn copy trunk branches/a
svn commit branches/a -m 'created branches/a'
echo green >> trunk/colors
svn commit trunk -m 'added green to trunk/colors'
echo blue >> branches/a/colors
svn commit branches/a -m 'added blue to branches/a/colors'
svn update
svn merge ^/trunk branches/a 
```

我的结果是：

```
Checked out revision 0.
A         trunk
A         branches
Adding         branches
Adding         trunk

Committed revision 1.
A         trunk/colors
Adding         trunk/colors
Transmitting file data .
Committed revision 2.
A         branches/a
Adding         branches/a
Adding         branches/a/colors

Committed revision 3.
Sending        trunk/colors
Transmitting file data .
Committed revision 4.
Sending        branches/a/colors
Transmitting file data .
Committed revision 5.
Updating '.':
At revision 5.
--- Merging r2 through r5 into 'branches/a':
   C branches/a/colors
--- Recording mergeinfo for merge of r2 through r5 into 'branches/a':
 U   branches/a
Summary of conflicts:
  Tree conflicts: 1 
```

我知道 SVN 并不以合并友好而闻名，但我不得不假设在这种情况下这是我的错。感谢您的任何指示。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-11T20:48:56.407

您遇到的问题不是由于“本地副本”[1] 本身造成的。问题在于，在修订版 3 中，您复制了混合修订版工作副本（[http://svnbook.red-bean.com/en/1.7/svn-book.html#svn.basic.in-action .mixedrevs](http://svnbook.red-bean.com/en/1.7/svn-book.html#svn.basic.in-action.mixedrevs)）。

如果我们一直运行您的脚本，直到您将“主干”复制到“分支/a”，我们会发现我们有一个混合修订的工作副本：

```
>svn st -v
                 0        0  ?           .
                 1        1 pburba       branches
                 1        1 pburba       trunk
                 2        2 pburba       trunk\colors 
```

所以当你将'trunk'复制到'branches/a'时，你实际上是在复制trunk@1和trunk/colors@2：

```
>svn copy trunk branches\a
A         branches\a

>svn st -v
                 0        0  ?           .
                 1        1 pburba       branches
A  +             -        1 pburba       branches\a
A  +             -        2 pburba       branches\a\colors
                 1        1 pburba       trunk
                 2        2 pburba       trunk\colors

>svn ci -m "Copy mixed-rev trunk"
Adding         branches\a
Adding         branches\a\colors

Committed revision 3. 
```

在查看 r3 的详细日志时，我们可以最清楚地看到这一点：

```
>svn log -v -r3
------------------------------------------------------------------------
r3 | pburba | 2013-03-11 15:31:23 -0400 (Mon, 11 Mar 2013) | 1 line
Changed paths:
   A /branches/a (from /trunk:1)
   A /branches/a/colors (from /trunk/colors:2)

Copy mixed-rev trunk
------------------------------------------------------------------------ 
```

跳过有问题的合并，我们有一个“干净”的工作副本，没有混合修订，也没有本地修改。到目前为止，一切都很好：

```
>svn st -v
                 5        5 pburba       .
                 5        5 pburba       branches
                 5        5 pburba       branches\a
                 5        5 pburba       branches\a\colors
                 5        4 pburba       trunk
                 5        4 pburba       trunk\colors 
```

但是如果我们使用 svn mergeinfo 命令来预览哪些版本将被合并，我们注意到版本 2 是合格的：

```
>svn mergeinfo --show-revs eligible ^/trunk branches\a
r2
r4 
```

但是等等，修订版 2 是添加了“颜色”，

```
>svn log -v -r2
------------------------------------------------------------------------
r2 | pburba | 2013-03-11 15:43:52 -0400 (Mon, 11 Mar 2013) | 1 line
Changed paths:
   A /trunk/colors

created trunk/colors with red inside
------------------------------------------------------------------------ 
```

当我们在修订版 3 中创建分支时，我们已经复制了它！那么为什么 Subversion 会再次尝试合并它呢？原因回到我们制作的混合修订 WC-to-WC 副本。合并目标 'branch/a' 知道它是在添加 'trunk/colors' 之前从 trunk@1 复制的。因此合并认为修订版 2 尚未合并到 branch/a 并尝试合并此更改，将“colors”添加到已存在同名文件的“a”中，从而导致*树*冲突：

```
>svn merge ^/trunk branches\a
--- Merging r2 through r5 into 'branches\a':
   C branches\a\colors
--- Recording mergeinfo for merge of r2 through r5 into 'branches\a':
 U   branches\a
Summary of conflicts:
  Tree conflicts: 1

>svn st
 M      branches\a
      C branches\a\colors
      >   local file obstruction, incoming file add upon merge
Summary of conflicts:
  Tree conflicts: 1 
```

所以我们用混合版本的 WC 到 WC 副本欺骗了 Subversion，它在复制过程中有效地将修订版本 2 带到了分支。那么为什么 Subversion 不能检测到这一点并跳过修订版 2？在这种情况下，我们可以想象可以做到这一点，但如果修订版 2 包括对“主干”的其他更改呢？例如：

```
>svn log -v -r2
------------------------------------------------------------------------
r2 | pburba | 2013-03-11 15:43:52 -0400 (Mon, 11 Mar 2013) | 1 line
Changed paths:
   A /trunk/colors
   A /trunk/README
   M /trunk

created trunk/colors with red inside, add a README file, and set the
svn:ignore property on trunk
------------------------------------------------------------------------ 
```

Subversion 不支持将修订的*一部分*合并到给定的路径，它要么全有，要么全无。

~~~~~

那么如何避免这个问题呢？正如您已经发现的那样，进行 URL 到 URL 的复制可以解决这个问题。为什么？因为当复制源是一个 URL 时，根据定义，它是在某个统一的修订版中：

```
>svn log -v -r3
------------------------------------------------------------------------
r3 | pburba | 2013-03-11 16:02:59 -0400 (Mon, 11 Mar 2013) | 1 line
Changed paths:
   A /branches/a (from /trunk:2)

Create branch 'a' from 'trunk' with a URL-to-URL copy.
------------------------------------------------------------------------ 
```

但是，您也可以使用 URL-to-WC 副本完成相同的操作：

```
 svn commit trunk -m 'created trunk/colors with red inside'
-svn copy trunk branches/a
+svn copy ^/trunk branches/a
 svn commit branches/a -m 'created branches/a' 
```

或者只是在原始脚本中的 WC 到 WC 副本之前更新 WC：

```
 svn commit trunk -m 'created trunk/colors with red inside'
+svn update
 svn copy trunk branches/a
 svn commit branches/a -m 'created branches/a' 
```

您的原始解决方案，即 URL 到 URL 副本，然后是更新，是 IMO 的最佳选择。update & WC-to-WC 副本和 URL-to-WC 副本都允许在提交之前对副本进行其他更改——最好是创建分支的修订版没有除副本外的其他更改。也就是说，所有这些选项都可以正常工作[2]。

[1] 在 Subversion 中，我们通常将其称为工作副本到工作副本，或简称为 WC 到 WC 副本。将此与 URL 到 URL、URL 到 WC 或 WC 到 URL 副本进行对比。WC-to-URL 副本也容易受到上述问题的影响。另见'svn copy --help'。

[2] 当然，即使使用这三个选项之一仍然会导致*文本*冲突，但这是意料之中的，因为我们在创建分支后对主干和分支上的“颜色”文件进行了不兼容的更改。

```
>svn merge ^/trunk branches\a
--- Merging r3 through r5 into 'branches\a':
C    branches\a\colors
--- Recording mergeinfo for merge of r3 through r5 into 'branches\a':
 U   branches\a
Summary of conflicts:
  Text conflicts: 1
Conflict discovered in file 'branches\a\colors'.
Select: (p) postpone, (df) diff-full, (e) edit, (m) merge,
        (mc) mine-conflict, (tc) theirs-conflict, (s) show all options: p

>svn st
 M      branches\a
C       branches\a\colors
?       branches\a\colors.merge-left.r2
?       branches\a\colors.merge-right.r5
?       branches\a\colors.working
Summary of conflicts:
  Text conflicts: 1 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-21T16:07:01.257

看来问题在于使用本地`svn copy`而不是远程。

```
-svn copy trunk branches/a
-svn commit branches/a -m 'created branches/a'
+svn copy ^/trunk ^/branches/a -m 'server side copy from trunk to branches/a'
+svn update 
```

虽然[SVN 书](http://svnbook.red-bean.com/en/1.7/svn.branchmerge.using.html#svn.branchmerge.using.create)说本地副本“不推荐使用技术”，但它没有将此列为原因。相反，它只是谈论廉价的服务器端副本、磁盘使用情况、时间等。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-21T16:24:38.657

您演示的案例应该会产生正常的冲突，而不应该导致树冲突。

我怀疑您的用例正在执行子树合并（请注意 svn merge 命令中的子树路径）。所有的合并信息都只存储在您结帐的顶层

从'svn帮助合并'：

```
 SOURCE specifies the branch from where the changes will be pulled, and
 TARGET_WCPATH specifies a working copy of the target branch to which
 the changes will be applied. Normally SOURCE and TARGET_WCPATH should
 each correspond to the root of a branch. (If you want to merge only a
 subtree, then the subtree path must be included in both SOURCE and
 TARGET_WCPATH; this is discouraged, to avoid subtree mergeinfo.) 
```

以下片段显示了我认为您在避免子树合并时正在寻找的功能。它使用'svn switch'来避免子树合并和多个WC

```
export SVN_REPO=~/svntest
cd $SVN_REPO
rm -rf $SVN_REPO/*
svnadmin create repo
svn mkdir file:///$SVN_REPO/repo/trunk -m "created trunk"
svn mkdir file:///$SVN_REPO/repo/branches -m "created branches"
#
svn checkout file:///$SVN_REPO/repo/trunk wc
cd wc
echo red > colors
svn add colors
svn commit . -m 'created trunk/colors with red inside' 
#
svn cp file:///$SVN_REPO/repo/trunk file:///$SVN_REPO/repo/branches/a  -m 'created branches/a'
#
echo green >> colors
svn commit . -m 'added green to trunk/colors'
#
svn switch file:///$SVN_REPO/repo/branches/a .
echo blue >> colors
svn commit  -m 'added blue to branches/a/colors'
svn update
svn merge file:///$SVN_REPO/repo/trunk 
```

结果：

```
Committed revision 1.
SVN_REPO/repo/branches -m "created branches"

Committed revision 2.

SVN_REPO/repo/trunk wc
Checked out revision 2.
 cd wc
 echo red > colors
 svn add colors
 A         colors
 svn commit . -m 'created trunk/colors with red inside'
Adding         colors
Transmitting file data .
Committed revision 3.

SVN_REPO/repo/branches/a  -m 'created branches/a'

Committed revision 4.

 echo green >> colors
 svn commit . -m 'added green to trunk/colors'
Sending        colors
Transmitting file data .
Committed revision 5.

SVN_REPO/repo/branches/a .
 U    colors
Updated to revision 5.
 echo blue >> colors
 svn commit  -m 'added blue to branches/a/colors'
Sending        colors
Transmitting file data .
Committed revision 6.
 svn update
Updating '.':
At revision 6.

Conflict discovered in '/home/jbellamy/svntest/wc/colors'.
Select: (p) postpone, (df) diff-full, (e) edit,
        (mc) mine-conflict, (tc) theirs-conflict,
        (s) show all options: p
--- Merging r4 through r6 into '.':
 C    colors
--- Recording mergeinfo for merge of r4 through r6 into '.':
 U   .
Summary of conflicts:
  Text conflicts: 1
     svn diff
Index: .
===================================================================
--- .   (revision 6)
+++ .   (working copy)

Property changes on: .
___________________________________________________________________
Added: svn:mergeinfo
   Merged /trunk:r4-6
Index: colors
===================================================================
--- colors      (revision 6)
+++ colors      (working copy)
@@ -1,2 +1,6 @@
 red
+<<<<<<< .working
 blue
+=======
+green
+>>>>>>> .merge-right.r6 
```

# jquery - 如何将带有 POST 查询的 jQuery 自动完成功能连接到远程数据源？

> ID：15005016
> 
> 赞同：4
> 
> 时间：2013-02-21T14:41:11.720
> 
> 标签：jquery, jquery-ui, autocomplete, jquery-autocomplete, jquery-ui-autocomplete

我正在尝试使用 POST 查询将文本字段连接到带有远程数据源的 jQuery UI 的自动完成功能。到目前为止，我有这个：

```
$( "#booking_student" ).autocomplete({
            source: function( request, respond ) {
                $.post( "/path/to/my/api.php", { student: request.term },
                        function( response ) {
                            //do something
                        } );
            }
        }); 
```

使用 Firebug，我可以看到我的 API 返回了我期望的结果，但没有出现自动完成下拉菜单。我需要做什么才能将我的结果插入到自动完成下拉列表中？我是否需要在 //do something 部分中使用 JSON 结果填充变量？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-21T14:42:37.673

您需要将结果提供给`respond`小部件为您提供的回调：

```
$( "#booking_student" ).autocomplete({
    source: function( request, respond ) {
        $.post( "/path/to/my/api.php", { student: request.term },
            function( response ) {
                respond(response);
        });
    }
}); 
```

这当然假设您的数据是一个数组，其中包含一个`label`属性、一个`value`属性或两者的项。[该选项的](http://api.jqueryui.com/autocomplete/#option-source)[文档中`source`](http://api.jqueryui.com/autocomplete/#option-source)对此进行了概述。

# php - 是否有可靠的方法根据浏览器和浏览器版本进行重定向？

> ID：15005019
> 
> 赞同：0
> 
> 时间：2013-02-21T14:41:17.780
> 
> 标签：php, redirect, http-redirect

我想根据他/她使用的浏览器和浏览器版本将用户重定向到另一个网页。

我知道这可以通过简单的 javascript 代码以及带有`HTTP_USER_AGENT`参数的 PHP 来完成。但是，这两种方法都可以通过停用 javascript 或手动更改 user_agent 来规避。

我的问题是：有没有办法让客户没有机会逃避它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-21T14:43:36.770

您最好的选择是检查用户代理并发出[301 移动永久](http://en.wikipedia.org/wiki/HTTP_301)重定向标头，除了“此页面已移动”消息之外，正文中没有任何有意义的内容。浏览器要么服从它，要么呈现一个空文档。重要的是要认识到用户代理字符串是*可选*的，您绝对不应该将其作为使用网站的必需部分。

请注意，您的态度与互联网的整个本质是对立的。没有办法*强迫*用户的浏览器做*任何事情*，也不应该有，永远。所有行为都是完全可选的，用户可以自由地获取您的网站或网站的部分内容，并以编程方式对您发送给他们的数据做*任何他们想做的事情。*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-21T14:46:23.377

简单的回答：没有

这将使生活变得更轻松，但浏览器更重视用户的隐私，而不是网站建设者的愿望。

您能做的最好的事情就是使您的网站尽可能向下兼容。

我经常遇到的唯一罪魁祸首是 6 到 10 的各种版本的 IE，它们都需要不同的样式表规则。

我会简单地用在头上

```
<head>
<!--[if IE 6]>
<link rel="stylesheet" href="ie6.css">
<![endif]-->
<!--[if IE 7]>
<link rel="stylesheet" href="ie7.css">
<![endif]-->
<!--[if IE 8]>
<link rel="stylesheet" href="ie8.css">
<![endif]-->
<!--[if IE 9]>
<link rel="stylesheet" href="ie9.css">
<![endif]-->
<!--[if IE 10]>
<link rel="stylesheet" href="ie10.css">
<![endif]--> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-21T14:44:26.693

您只能通过网络上的文本字符串与客户端进行通信。如果客户不想告诉你他真正的用户代理，你真的无能为力。

# javascript - 带图像切换的下拉菜单

> ID：15005020
> 
> 赞同：1
> 
> 时间：2013-02-21T14:41:19.950
> 
> 标签：javascript, html

我正在尝试根据人们在下拉菜单中选择的内容来切换图像。html 和 js 在两个不同的文件中。

这只是 html 的一部分：

```
 <select id="Breed_0_field" name="Breed76" onChange="javascript: wizard();" onkeyup="javascript: wizard();" tabindex="4">
 <option selected="selected" value="Select One">Select One</option>
 <option value="Other/Mix">Other/Mix</option>
 <option value="0">--- Common Breeds----</option>
 <option value="Border Collie">Border Collie</option>
 <option value="Boxer">Boxer</option>
 <option value="Corgi">Corgi</option>
 <option value="Dachshund">Dachshund</option> 
```

对于 JS 部分：

```
 breed = document.getElementById("Breed_0_field").value;
 selectdog()

function selectdog()
{
dog_type=0

switch (breed)
{

case "Affenpinscher": // Affenpinscher
    // Affenpinscher
    document.getElementById("dog_breed_picture").src = "http://handicappedpet.net/helppets/images/avatars/gallery/Dog_Larger/blank.gif";
    break;
case "Affenpinscher": // Affenpinscher
    // Affenpinscher
    document.getElementById("dog_breed_picture").src = "http://handicappedpet.net/helppets/images/avatars/gallery/Dog_Larger/Affenpinscher.gif";
    break;
case "Afghan Hound": // Afghan Hound
    // Afghan Hound
    document.getElementById("dog_breed_picture").src = "http://handicappedpet.net/helppets/images/avatars/gallery/Dog_Larger/Afghan_Hound.gif";
    break; 
```

问题是，这一切都适用于数字。html 部分中的值使用为 1,2,3,4 ......并且正确的图像与 1,2,3,4 匹配......但我需要 html 的值是它的名字，否则稍后在代码下方，它只显示数字而不是品种名称。

我如何使这个图像切换有点工作但使用字符串而不是数字？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T14:57:55.523

我的错！显然这确实有效！

我的问题是我有一个函数 if (breed > 0){selectdog()} 永远不会工作，因为我不再使用数字。

但是您确实可以使用带大小写的字符串。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-21T14:45:17.607

你可以做的是有一个包含狗名字的数组，这些数字引用数组中的一个索引，你可以稍后在代码中使用。如果有帮助，我可以举个例子

# c# - Windows Phone 7 中 TextBlock 上的单击/悬停效果

> ID：15005028
> 
> 赞同：1
> 
> 时间：2013-02-21T14:41:50.073
> 
> 标签：c#, silverlight, windows-phone-7, animation

`TextBlock`我有一个从s构建的菜单`StackPanel`。

我希望`TextBlock`s 在被点击时动画。很像股票应用程序在菜单中单击时的动画方式。

我读过的文档似乎为每个命名项目创建了一个动画。这似乎有点倒退。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-21T16:08:43.367

我使用 TiltEffect.cs 解决了它。

[http://msdn.microsoft.com/en-us/library/ff941094](http://msdn.microsoft.com/en-us/library/ff941094)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T14:46:07.153

为每个项目创建动画并不是那么疯狂。您可以简单地迭代`Children`将`StackPanel`动画添加到每个代码中。

# php - 使用 Codeigniter 从数据库表中查看文件

> ID：15005032
> 
> 赞同：0
> 
> 时间：2013-02-21T14:42:07.280
> 
> 标签：php, database

我正在尝试查看从数据库中获取的图像文件，但我不知道为什么在加载视图时会得到一个未定义的变量。

几乎我只是想查看存储在我的数据库图像中的图像名称。任何帮助都会非常感谢。

这是我在浏览器中查看时收到的错误

```
A PHP Error was encountered
Severity: Notice
Message: Undefined variable: imagename
Filename: layouts/home.php
Line Number: 8
A PHP Error was encountered
Severity: Warning
Message: Invalid argument supplied for foreach()
Filename: layouts/home.php
Line Number: 8 
```

这是我的控制器

```
class Home extends CI_Controller {

function __construct()
{
    parent::__construct();
    $this->load->library('upload');

}
  function index() {
    $this->load->model('index_model');
    $foldername['foldername'] = $this->index_model->getFoldernames();
    $imagename['imagename'] = $this->index_model->getImagenames();

    $this->load->view('layouts/home', $foldername, $imagename, array('error' => ' ' ));
  }

function create() {
   if(array_key_exists('createFolder',$_POST)){
     $data = array(
       'folderName' => $this->input->post('folderName')
   );
    $data = str_replace(' ', '_', $data);
    $this->index_model->createFolder($data);
  }
  $this->foldercreated();
}

function delete() {
  $this->load->model('index_model');
  $foldername['foldername'] = $this->index_model->getFoldernames();
  $this->load->view('layouts/delete', $foldername);
}

function deleteFolder() {
   if($this->input->post('checkbox') !== false) {
   $checkbox = $this->input->post('checkbox');
   $this->index_model->deleteFolder($checkbox);
  }
 $this->folderdeleted();
}

function foldercreated() {
  $this->load->view('partials/foldercreated');
}

function folderdeleted() {
  $this->load->view('partials/folderdeleted');
}

function do_upload() {
  $config['source_image'] = $this->upload->upload_path.$this->upload->file_name;
  $config['upload_path'] = './uploads/';
  $config['allowed_types'] = 'gif|jpg|png';
  $config['max_size'] = '0';
  $config['max_width']  = '0';
  $config['max_height']  = '0';
  $this->upload->initialize($config);
  $this->load->library('upload', $config);

  if ( !$this->upload->do_upload('userfile'))
     {
      // echo  '<p>IMAGE NOT WORKING</p>'. '<br/><p>' . $this->upload->display_errors() .      '</p>';
     $uploadError = $this->upload->display_errors();
     $this->load->view('partials/upload_error', $uploadError);
    }
  else
   { 
    // $imagefile = array('upload_data' => $this->upload->data());
     $upload_data = $this->upload->data();

     $db_data = array('imageName' => $upload_data['file_name']);
     $this->index_model->addImage($db_data); // replace the tablename

     $this->load->view('partials/upload_success', $db_data);

   }
 }
} 
```

这是我的模型

```
 function getFolderNames() {
    $this->db->order_by('id', 'DESC');
    $this->db->select('folderName');
    $q = $this->db->get('senior');

    if($q->num_rows() > 0) {
        foreach ($q->result() as $row) {
          $data[] = $row;
        }
       return $data;
    }
  }

  function getImagenames() {
    $this->db->order_by('id', 'DESC');
    $this->db->select('imageName');
    $query = $this->db->get('images');

    if($query->num_rows() > 0) {
        foreach ($query->result() as $row) {
          $data[] = $row;
       }
     return $data;
    }
  } 
```

这是我的观点

```
 <div id="imagefiles">
    <?php 
       foreach ($imagename as $img) { ?>
          <div><?php echo $img->imageName; ?></div>
    <?php } ?>
 </div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T15:14:23.763

您没有正确地将数据传递给您的视图。

你有这个：`$this->load->view('layouts/home', $foldername, $imagename, array('error' => ' ' ));`

您的第二个参数应该是要传递给视图的数据数组。尝试这样的事情：

```
$data['foldername'] = $this->index_model->getFoldernames();
$data['imagename'] = $this->index_model->getImagenames();

$this->load->view('layouts/home', $data); 
```

请查看[CodeIgniter 文档](http://ellislab.com/codeigniter/user-guide/general/views.html)以获取更多信息。

# iphone - 用 drawAtPoint 定位字符串？

> ID：15005036
> 
> 赞同：0
> 
> 时间：2013-02-21T14:42:18.100
> 
> 标签：iphone, ios, objective-c, ios6, uiimage

我正在尝试使用**drawAtPoint**绘制字符串，而不是使用**CGContextShowTextAtPoint**。

```
- (UIImage *)drawonimage:(UIImage *)img {
// myString is a string to draw
// fontName is a string (font name)
// fontSize is the font size (CGfloat)

CGFloat w = img.size.width;
CGFloat h = img.size.height;

UIGraphicsBeginImageContextWithOptions(img.size,NO,1.0f);
CGColorSpaceRef colorSpace0 = CGColorSpaceCreateDeviceRGB();
CGContextRef context0 = CGBitmapContextCreate(NULL,w,h,8,4 * w,colorSpace0,kCGImageAlphaPremultipliedFirst);
CGContextDrawImage(context0,CGRectMake(0,0,w,h),img.CGImage);
CGPoint p0 = CGPointMake(0,0);
[img drawAtPoint:p0];
CGPoint p1 = CGPointMake(0,0);
UIColor *aColor;
aColor = [UIColor colorWithRed:100/255.0 green:120.0/255.0 blue:140.0/255.0 alpha:90/100.0];
CGContextSetFillColorWithColor(UIGraphicsGetCurrentContext(),aColor.CGColor);
[myString drawAtPoint:p1 withFont:[UIFont fontWithName:fontName size:fontSize]];
UIImage *Img = UIGraphicsGetImageFromCurrentImageContext();
UIGraphicsEndImageContext();
return Img;
} 
```

我遇到的问题是字符串实际出现的位置。例如，假设我要绘制的字符串是“Hello world！” 字符串的最左上角不在 0,0 处。（见图）外观取决于字体，字体大小和其他因素，我想。所以我想知道是否有一种测量字符串高度（而不是宽度）的方法？ **或者我该怎么做才能使字符串的左上角（箭头处）位于 0,0？**

谢谢您的帮助。

![在此处输入图像描述](../Images/d413d5fbeabf0988d5271c3fff870464.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T15:12:16.967

看起来这不是微不足道的......`sizeWithFont`总是会返回最大可能的高度值，它会返回正确的宽度值......

正如这里所指出的（[如何使用 UIKit 计算文本的确切高度？](https://stackoverflow.com/questions/8751219/how-do-i-calculate-the-exact-height-of-text-using-uikit)），您需要查看 CoreText 框架（[http://developer.apple.com/library/ios/#documentation/StringsTextFonts/概念/CoreText_Programming/Introduction/Introduction.html#//apple_ref/doc/uid/TP40005533](http://developer.apple.com/library/ios/#documentation/StringsTextFonts/Conceptual/CoreText_Programming/Introduction/Introduction.html#//apple_ref/doc/uid/TP40005533)）。

# windows-phone-7 - Windows Phone 上的提示输入框上的数据验证

> ID：15005044
> 
> 赞同：0
> 
> 时间：2013-02-21T14:42:41.853
> 
> 标签：windows-phone-7, windows-phone-8, telerik-radinput

```
RadInputPrompt.Show("Enter the number", MessageBoxButtons.OK, message, InputMode.Text, textBoxStyle, closedHandler: (arg) =>
{
    int okButton = arg.ButtonIndex;
    if (okButton == 0) 
    {

          //do some check before submit
          if (string.IsNullOrEmpty(arg.Text))
          {
               MessageBox.Show("Please input the number.");
               return; //??
          }

          //submit
    }
    else
    {
        return;
    }
}); 
```

我的问题是：我在提交之前进行了一些数据验证（例如：仅数字，数字计数......）

如果来自用户的输入无效，我希望提示输入屏幕仍然可以保留。
如果我使用“return”关键字，它会回到主屏幕。

或者是否有任何其他验证方式（类似于 AJAX？）我可以在此提示界面上使用，而不是在代码隐藏页面上使用？

非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-06T12:05:16.157

一种技术是在每次用户单击“确定”时保持循环并显示输入提示，但无法满足输入验证。您可以在下面看到一个示例，如果结果不是有效的数值，输入文本框会继续重复。

向用户添加某种反馈也是一个好主意，表明在无效提交的情况下先前的输入是不可接受的。下面是一个示例，其中输入文本框的标题在第一次无效提交后更改为包含指示输入值必须是有效数字的文本。

注意： Telerik 说现在应该使用 ShowAsync 方法而不是 Show 方法，因为它已被弃用。

```
 string userInput = string.Empty;
        int okButton = 0;
        bool firstPass = true;
        double numericResult;

        while (okButton.Equals(0) && string.IsNullOrWhiteSpace(userInput))
        {
            string inputBoxTitle = (!firstPass) ? "Enter the number (you must enter a valid number)" : "Enter the number";

            InputPromptClosedEventArgs args = await RadInputPrompt.ShowAsync(inputBoxTitle, MessageBoxButtons.OKCancel);
            okButton = args.ButtonIndex;
            firstPass = false;

            if (okButton.Equals(0))
            {
                if (!string.IsNullOrWhiteSpace(args.Text))
                {
                    bool isNumeric = double.TryParse(args.Text, out numericResult);
                    if (isNumeric)
                    {
                        // We have good data, so assign it so we can get out of this loop
                        userInput = args.Text;
                    }
                }
            }
        } 
```

# android - 如何通过 Facebook 帖子中的链接打开 android 应用程序？

> ID：15005046
> 
> 赞同：0
> 
> 时间：2013-02-21T14:42:42.687
> 
> 标签：android, facebook

我们正在开发一个 android 应用程序，它使用 facebook connect 在 facebook 上发布消息。该消息包含一个链接。

如果用户单击 facebook 上发布的链接，我们希望打开 android 应用程序。

以下是步骤：

[1] 考虑安装了 facebook 应用程序的手机

[2] 在同一部手机上安装我们的应用程序

[3] 使用我们的应用程序在 facebook 上发布带有链接的消息

[4] 前往脸书应用程式

[5] 点击链接，它应该会打开我们的应用程序。

实际上我们不想使用，除此之外，是否可以通过传递“facebook 应用程序 ID”或“应用程序包名称”作为查询字符串参数来自定义/格式化链接？

请让我们您的意见...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T15:16:43.350

看看[Intent Filters](http://developer.android.com/guide/components/intents-filters.html)，或者这个答案

[https://stackoverflow.com/a/2958870/1589566](https://stackoverflow.com/a/2958870/1589566)

在某些情况下，您也需要添加这些。

```
<category android:name="android.intent.category.DEFAULT"/>
<category android:name="android.intent.category.BROWSABLE"/> 
```

# erlang - 为什么我不能运行这个 Erlang 演示应用程序？

> ID：15005047
> 
> 赞同：2
> 
> 时间：2013-02-21T14:42:47.587
> 
> 标签：erlang, rebar, erlang-shell

我在[运行钢筋应用程序时遇到了与此处类似的问题](https://stackoverflow.com/questions/14086568/how-run-an-erlang-application-inside-the-erlang-shell)

基本上，我想从以下位置运行演示代码：[https ://github.com/hukl/fancyapi](https://github.com/hukl/fancyapi)

当我在根目录中时，我会：

```
→ erl [...] -pa ebin -pa deps/*/ebin
Erlang R15B02 (erts-5.9.2) [source] [64-bit] [smp:8:8] [async-threads:0] [hipe] [kernel-poll:false] [dtrace]

Eshell V5.9.2（使用 ^G 中止）
1> 应用
1>。
应用
2> 应用程序：开始（fancyapi）。
{error,{"没有这样的文件或目录","fancyapi.app"}}
3> 应用程序：开始（“fancyapi”）。
{错误，{bad_application,"fancyapi"}}
4>

```

ERL 如何找到fancyapi 代码？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-21T15:32:16.237

```
[g@dev1 ~/work]$ git clone git://github.com/hukl/fancyapi.git
Cloning into 'fancyapi'...
remote: Counting objects: 12, done.
remote: Compressing objects: 100% (9/9), done.
remote: Total 12 (delta 0), reused 12 (delta 0)
Receiving objects: 100% (12/12), done.

[g@dev1 ~/work]$ cd fancyapi/

[g@dev1 ~/work/fancyapi]$ rebar get-deps
==> fancyapi (get-deps)
Pulling etest from {git,"git://github.com/wooga/etest.git"}
Cloning into 'etest'...
Pulling etest_http from {git,"git://github.com/wooga/etest_http.git"}
Cloning into 'etest_http'...
Pulling elli from {git,"git://github.com/knutin/elli.git"}
Cloning into 'elli'...
==> etest (get-deps)
==> etest_http (get-deps)
Pulling jiffy from {git,"git://github.com/davisp/jiffy.git","HEAD"}
Cloning into 'jiffy'...
==> jiffy (get-deps)
==> elli (get-deps)

[g@dev1 ~/work/fancyapi]$ rebar compile
==> etest (compile)
Compiled src/etest_runner.erl
==> jiffy (compile)
Compiled test/jiffy_tests.erl
Compiled test/util.erl
Compiled src/jiffy_utf8.erl
Compiled src/jiffy.erl
Compiled test/etap.erl
Compiling c_src/decoder.c
Compiling c_src/encoder.c
Compiling c_src/jiffy.c
Compiling c_src/utf8.c
Compiling c_src/util.c
==> etest_http (compile)
Compiled src/etest_http.erl
Compiled src/etest_http_json.erl
Compiled test/etest_http_test.erl
==> elli (compile)
Compiled src/elli_handler.erl
Compiled src/elli_middleware_compress.erl
Compiled src/elli_example_middleware.erl
Compiled src/elli_middleware.erl
Compiled src/elli_util.erl
Compiled src/elli_request.erl
Compiled src/elli.erl
Compiled src/elli_test.erl
Compiled src/elli_example_callback.erl
Compiled src/elli_http.erl
==> fancyapi (compile)
Compiled src/fancyapi_app.erl
Compiled src/fancyapi_callback.erl
Compiled src/fancyapi_sup.erl
Compiled test/my_fancy_test.erl

[g@dev1 ~/work/fancyapi]$ erl -pa ebin -pa ebin deps/*/ebin
Erlang R15B03 (erts-5.9.3.1) [source] [64-bit] [smp:2:2] [async-threads:0] [hipe] [kernel-poll:false]

Eshell V5.9.3.1  (abort with ^G)
1> application:start(fancyapi).
ok 
```

# ios - 了解 UIView 和对象的缩放大小

> ID：15005048
> 
> 赞同：0
> 
> 时间：2013-02-21T14:42:50.020
> 
> 标签：ios, uitableview, uiview, uiviewcontroller, autoresizingmask

我试图更好地了解如何根据旧 iphone 和新 iphone 的大小差异来控制视图的大小。

如果我有类似下面示例的设计，那么应该如何根据子视图以编程方式对其进行编码。

![例子](../Images/8c141adf8329352f1e759f1fd0d1d604.png)

请原谅画得不好的图表，但它应该有助于解释。

在此示例中，fieldView 和 buttonView 始终需要保持固定大小，因为它们的对象在变小时看起来不太好。然而，logoview 有另一个用于 logo 本身的子视图，因此可以根据设备/屏幕尺寸缩小。

这将如何实现？以编程方式设置示例子视图。我不明白的部分是，在创建子视图的 viewDidLoad 中，您不必像这样创建：

```
-(void)ViewDidLoad {
CGRect screen = [[UIScreen mainScreen] applicationFrame];
wholeView = [[UIView alloc] initWithFrame:CGRectMake(self.view.bounds.origin.x, self.view.bounds.origin.y, self.view.bounds.size.width, self.view.bounds.size.height)];

 logoView = [[UIView alloc] initWithFrame:CGRectMake(0,0,320,150);
fieldView = [[UITableView alloc] initWithFrame:CGRectMake(0, logoView.bounds.size.height, 320, 100); 
```

我了解使用

> 自动调整大小掩码

但是根据可用的实际视图大小，它如何在计算高度方面发挥作用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T14:47:19.797

不确定我是否理解您的疑问，但添加以下内容应该可以解决问题：

```
self.view.autoresizingMask = UIViewAutoresizingFlexibleWidth | UIViewAutoresizingFlexibleHeight;
logoView.autoresizingMask = UIViewAutoresizingFlexibleWidth | UIViewAutoresizingFlexibleHeight; 
```

剩下的视图将保持它们的边距和高度/宽度固定（即，`UIViewAutoresizingNone`它们的默认值`autoresizingMask`很好。）

> 根据可用的实际视图大小，它如何在计算高度方面发挥作用？

基本上，您在 iPhone 显示屏上看到的是视图层次结构；此层次结构中的最顶层视图是`UIWindow`. 这与设备屏幕的大小相同（以这种方式初始化）。

现在，在上面的代码中，我们的`logoView`边距是固定的：这意味着它将与容器视图框架保持相同的距离；如果我们指定 size 是灵活的，那么 logoView 将简单地占据整个空间以保持边距固定。

# c++ - 处理绝对差异的 BOOST_CHECK_CLOSE 版本

> ID：15005052
> 
> 赞同：2
> 
> 时间：2013-02-21T14:43:03.827
> 
> 标签：c++, unit-testing, boost-test

是否有一个版本的 BOOST_CHECK_CLOSE 可以使用绝对差异而不是百分比？在某些情况下，绝对差异更有意义，例如当我们使用金钱时（是的，我知道 double 不是最好的类型），我们可能会检查答案是否适合最接近的一分钱。还有很多其他的例子。

使用例如 BOOST_CHECK_SMALL 自己编写其中一个是相当简单的，但我正确宏的详细输出会使错误更容易追踪。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-21T15:40:27.793

TBH，我不明白 BOOST_CHECK_SMALL 的问题：

```
double val = func(); //should be between 95 and 105
BOOST_CHECK_SMALL(val - 100, 5); 
```

但是，如果它必须看起来更像 CHECK_CLOSE，您将不得不像 boost 一样滚动您自己的宏 - 只需挖掘相应的标题。您可能必须添加自己的检查类型枚举值，创建谓词并在宏中使用它。

或者使用[BOOST_CHECK_PREDICATE](http://www.boost.org/doc/libs/1_45_0/libs/test/doc/html/utf/testing-tools/custom-predicate.html)，老实说，它看起来比 CHECK_SMALL 丑多了，但有所不同。或者简单地将 BOOST_CHECK 与返回谓词的自定义函数一起使用——但我认为这太过分了。

# ruby - 添加所有具有主数组的数组，不重复

> ID：15005055
> 
> 赞同：1
> 
> 时间：2013-02-21T14:43:16.533
> 
> 标签：ruby, multidimensional-array

我需要将一个数组数组添加到一个没有重复的数组中

```
array = [[1,2,3],[2,3,4],[7,8,9]] 
```

到

```
new_array [1,2,3,4,7,8,9] 
```

在 Ruby 中做 IT 的最佳方式是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-21T14:45:56.857

试试这个：

```
array.flatten!.uniq! 
```

[`flatten!`](http://www.ruby-doc.org/core-1.9.3/Array.html#method-i-flatten-21)接受任何子数组并将它们的元素添加到封闭数组（递归），因此它“展平”数组数组。

[`uniq!`](http://www.ruby-doc.org/core-1.9.3/Array.html#method-i-uniq-21)从数组中删除重复元素。

注意 ！方法修改原始数组。使用非！如果您希望返回一个新数组，请使用方法 ([`flatten`](http://www.ruby-doc.org/core-1.9.3/Array.html#method-i-flatten)和)。[`uniq`](http://www.ruby-doc.org/core-1.9.3/Array.html#method-i-uniq)

# google-maps - 谷歌地图标记偏离中心

> ID：15005058
> 
> 赞同：3
> 
> 时间：2013-02-21T14:43:24.197
> 
> 标签：google-maps, marker

我有一个谷歌地图，在特定的纬度和经度上有一个圆圈。我还使用了一个我想显示在圆圈中心的标记，它应该是圆圈设置的 Lat 和 Lng。

这是我正在谈论的屏幕截图： ![在此处输入图像描述](../Images/6a3de60e06c6f69b764fc88b7bf1051c.png)

你可以看到“6”和“7”不在圆的中心。我不知道如何解决这个问题？

这是标记代码：

```
var markerIcon = [
                "img/marker-icon-1.png",
                "img/marker-icon-2.png",
                "img/marker-icon-3.png",
                "img/marker-icon-4.png",
                "img/marker-icon-5.png",
                "img/marker-icon-6.png",
                "img/marker-icon-7.png",
                "img/marker-icon-8.png",
                "img/marker-icon-9.png",
                "img/marker-icon-10.png"
            ];

var marker = new google.maps.Marker({
    position:new google.maps.LatLng(mapDataTrending[i].lat, mapDataTrending[i].lng),
    icon: markerIcon[i],
    map: map
}); 
```

我正在从 JSON 文件设置 Lat 和 Lng，但我使用相同的 Lat 和 Lng 来设置我的圆圈的中心。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-21T14:47:13.393

请注意，当您将图像作为标记放置时，图像的底部中心会转到所选的 latlng。您需要通过 Icon.anchor 属性调整图像大小（假设您正在谈论 google maps Javascript v3，因为您使用的是 icon ）

[https://developers.google.com/maps/documentation/javascript/reference#Icon](https://developers.google.com/maps/documentation/javascript/reference#Icon)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2022-03-04T06:24:40.080

希望有人会发现这有助于寻找更多的复制粘贴答案。`ICON_BASE`允许您跨多个相同大小的图标复制它。

```
const ICON_BASE = {
    size: new google.maps.Size(16, 16), 
    origin: new google.maps.Point(0, 0),
    anchor: new google.maps.Point(8, 8)),
};

const ICON_1 = {
    ...ICON_BASE,
    url: "img/marker-icon-1.png",
}; 
```

# javascript - 为什么 document.execCommand("copy") 在我的 chrome 扩展的内容脚本中不起作用？

> ID：15005059
> 
> 赞同：7
> 
> 时间：2013-02-21T14:43:24.793
> 
> 标签：javascript, google-chrome-extension

我想从我正在创建的 chrome 扩展中将一些数据写入剪贴板。在清单文件中，我授予了**clipboardRead 和clipboardWrite 的权限。**

我使用我在[这里找到的这个功能](https://stackoverflow.com/a/11527906/2095705)

但它不起作用。似乎“document.execCommand('copy');” 不能工作。

我在内容脚本中编写了所有这些代码。

谢谢清单：

```
{
    "manifest_version":2,

    "name":"easyCopy",
    "description":"just a small toll",
    "version":"1.0.0",

    "permissions":[
        "clipboardWrite", "http://*/*", "clipboardRead"
    ],

    "content_scripts":[
        {
            "matches":["http://*/*"],
            "js":["jquery-1.9.1.min.js", "main_feature.js"]
        }
    ],

    "background":{
        "persistent":false,
        "page":"background.html"
    }
} 
```

main_feature.js：

```
copyOrderId();
function copyOrderId() {
    $(".order-num").click(function () {
        var curOrderNum = $(this).text();
        copyTextToClipboard(curOrderNum);
//        chrome.extension.sendMessage({method:"copy", content:curOrderNum}, function (response) {
//            clog(response);
//        });
    });

}

function copyTextToClipboard(text) {
    var copyFrom = $('<textarea/>');
    copyFrom.text(text);
    $('body').append(copyFrom);
    copyFrom.select();
    document.execCommand('copy', true);
    copyFrom.remove();

}
function clog(message) {
    console.log(message);
} 
```

background.html 只是一个带有基本 html 正文的空白页面。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-26T02:32:01.047

谢谢大家，我最终使用了这个：

`document.execCommand`不能在内容脚本中工作。相反，我将数据发送到后台页面，然后运行“copyTextToClipboard”函数。

请注意，您必须将 JavaScript 放入单个 .js 文件中，而不是将其与 background.html 混合。

此外，textarea 必须具有`id`or`class`属性。

# android - 在同时运行的 Blackberry 10 Dev Alpha B 和 C 模拟器上从 Eclipse 部署 android 应用程序

> ID：15005070
> 
> 赞同：0
> 
> 时间：2013-02-21T14:43:53.380
> 
> 标签：android, eclipse, blackberry-simulator, blackberry-eclipse-plugin, blackberry-10

我已经将两个模拟器都设置为 Eclipse 中的目标，但是不可能在 B 模拟器上运行应用程序，然后在 C 模拟器上运行它。Eclipse 没有找到其中之一（它在“目标”设置中设置，但在我尝试部署应用程序时无法访问）。

因此，目前，每次我想在不同的模拟器上测试应用程序时，我都需要更改 Eclipse 中的“目标”设置（并且经常（甚至总是，我不是 100% 确定 - 只是不要记住）Eclipse 甚至无法在不关闭以前的模拟器/清理所有模拟器设置/重新启动 Eclipse 的情况下在另一个模拟器上部署应用程序...）。例如：我将模拟器 B 设置为默认目标并在其上部署应用程序，然后我将模拟器 C 设置为默认目标，但应用程序再次部署到 B！

**如何在同时运行的两个 Blackberry 10 Dev Alpha B anc C 模拟器上从 Eclipse 部署 android 应用程序？**

附加信息：

*   我有最新版本的 Blackberry 10 模拟器和适用于 Eclipse 的 Android 和 Blackberry 开发软件
*   我在 Vmware 中运行模拟器

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T16:56:33.657

我认为不可能从 Eclipse 一次在多个设备上进行部署。至少使用当前版本的插件（我希望很快就会添加）。

但也许命令行会更适合你。如果您只是编写一个调用所有命令的小脚本（每个设备一个）。您可以在想要部署时运行该脚本。

```
command_to_deploy_on_Dev_Alpha_B
command_to_deploy_on_Dev_Alpha_C 
```

不是真的“同时”，但我猜足够接近

# database - 应用数据库/实例分解

> ID：15005074
> 
> 赞同：0
> 
> 时间：2013-02-21T14:44:04.470
> 
> 标签：database, postgresql, scala, heroku, playframework-2.0

我正在设计一种服务于一些商业实体的服务。从逻辑上讲，它将分为两部分：

1.  前端 - 诸如 Wiki、定价、登陆页面之类的花里胡哨，也许还有帐户信息（帐单、帐户状态等）。
2.  服务本身，商业实体的雇主将在其中工作。

它是 play 2.x 框架，计划托管在 heroku 中。目前尚不清楚如何分解实例和数据库内容。

我应该为客户分解数据库：业务实体 - 一个数据库吗？或者我应该将所有数据存储在一个数据库中，但为拥有某行的业务实体的所有表添加 ID？这个决定可能会带来哪些问题（性能、管理、扩展）？

如果我将选择划分数据库，我该怎么做？为此，我需要为该实例所属的客户端启动带有数据库的应用程序实例。因此，我们有可能成为扩展障碍的非均匀实例。据我所知，heroku 不支持非统一（网络）实例。

请帮忙，我完全被困在这里。

预期堆栈：

*   斯卡拉
*   玩 2.0
*   异常
*   JDBC
*   PostgresSQL
*   Heroku

所有这些（Scala 除外，可能是 Play 2.0）都是可以互换的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-24T19:06:50.437

这是一个非常经典的问题。您有许多客户，您想知道是否应该为每个客户创建单独的数据库 - 或者他们是否应该共享一个数据库。

我建议从一个共享数据库开始，然后使用它直到你扩展它。想想让每个客户端都有自己的数据库实例的一些缺点：

1.  就像您提到的那样，模式管理可能很困难。您需要编写工具来维护所有服务器上的所有数据库。

2.  如果您告诉客户您以这种方式构建系统，其中一些可能会促使您分叉数据库。换句话说，他们可能会争辩说：“我有自己的数据库！我想要一个只属于我自己的新表。”

3.  跨服务器/数据库运行查询有点困难。如果您想计算所有客户拥有多少物品，您必须考虑一下。

但是，如果您想从基于客户端 ( [http://en.wikipedia.org/wiki/Shard_(database_architecture)](http://en.wikipedia.org/wiki/Shard_(database_architecture)) ) 的分片开始，您可以考虑：

1.  如前所述，您需要一些工具/脚本来为客户端启动新的数据库实例。通常，这些工具需要用配置信息“播种”数据库——比如为地址填充状态表。

2.  您将需要一个工具来监视/维护数据库。启动一个，停止另一个，查看一个是否有高 CPU 使用率等。

3.  您需要某种系统来汇总所有客户端的统计信息。

4.  您将需要一个工具来推出架构更改，并计划如何在他们的 Web 应用程序运行时优雅地升级数据库。

总的来说，我建议从小而简单的开始，只有在你到达那里时才开始担心规模。

# c++ - 在重载算术运算符中调用 C++ 析构函数

> ID：15005075
> 
> 赞同：4
> 
> 时间：2013-02-21T14:44:06.597
> 
> 标签：c++, matrix, operator-overloading

我有一个用于神经网络程序和重载算术运算符的定制矩阵库。这是类声明：

```
class Matrix{
public:
int m;
int n;
double **mat;
Matrix(int,int);
Matrix(int);
Matrix(const Matrix& that):mat(that.mat),m(that.m),n(that.n)
    {
        mat = new double*[m];
        for(int i = 0;i<m;i++)mat[i] = new double[n];
    };
~Matrix();
friend istream& operator>>(istream &in, Matrix &c);
friend ostream& operator<<(ostream &out, Matrix &c);
Matrix operator+(const Matrix& other);
}; 
```

这是 + 操作的函数定义：

```
 Matrix Matrix::operator+(const Matrix& other)
    {
        Matrix c(m,n);
        for(int i=0;i<m;i++)
        {
           for(int j = 0; j<n;j++)
               c.mat[i][j] = mat[i][j] + other.mat[i][j];
        }
        return c;
    } 
```

我试图以各种方式实现它并且错误是相同的......这是一个实例

```
Matrix x(m,n); //m and n are known
x = a+b; // a and b are also m by n matrices 
```

我已经使用断点调试了代码，这是错误... **运算符函数中的局部矩阵'c'在返回之前被破坏**，因此分配给x的是垃圾指针..

请给我一些建议...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-21T14:46:01.787

您需要为您的类定义一个复制构造函数。复制构造函数将需要为数据分配内存`mat`并制作数据副本。

没有这个，当你`return c`构造一个新对象时，它的值与`mat`as相同`c`。当`c`随后超出范围时，它会删除`c.mat`. 结果， 的副本`c`留下了一个悬空指针。

完成此操作后，您还应该实现一个赋值运算符。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-21T14:47:43.023

您返回的值用于初始化一个临时值，然后在您返回的值被销毁*后将该临时值复制到结果中。*这是正常行为（除非呼叫因 NRVO 而被忽略）。

但是，由于您的类没有明确定义的复制构造函数，因此将调用隐式生成的复制构造函数，这只会将指针 ( `mat`) 复制到已被返回对象的析构函数释放的内容。

这违反了所谓的**[“三法则”](http://www.google.com/url?sa=t&rct=j&q=rule%20of%20three%20c%2B%2B&source=web&cd=2&cad=rja&sqi=2&ved=0CDQQFjAB&url=http%3A%2F%2Fstackoverflow.com%2Fquestions%2F4172722%2Fwhat-is-the-rule-of-three&ei=zjUmUYiSL4TYsgb-8YGADA&usg=AFQjCNHQX0F3xfZi2V1-KNUmU7V3-g1Qdg&bvm=bv.42661473,d.Yms)**，这是一种编程最佳实践，即每当您的类显式定义复制构造函数、赋值运算符或析构函数时，就应该定义*所有*这些。基本原理是定义其中一个的类很可能这样做，因为它正在管理一些资源，并且为了正确处理资源释放/获取逻辑，需要所有这三个特殊成员函数。

请注意，在 C++11 中，您还可以有一个*移动*构造函数，只需分配指针并使您从中移动的对象无效，就可以执行`Matrix`' 内容的传输。

```
Matrix(Matrix&& m)
{
    mat = m.mat;
    m.mat = nullptr;
} 
```

当然，如果你引入了一个移动构造函数，你将不得不相应地修改你的类析构函数来检查你是否真的需要释放分配的内存：

```
~Matrix()
{
    if (m.mat == nullptr)
    {
        return;
    }

    ...
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-21T14:47:04.360

您的 Matrix 类有一个原始指针成员，并且可能在其构造函数中分配内存，但您没有复制构造函数或复制赋值运算符。

此外，您有一个析构函数，但没有复制构造函数或复制赋值运算符。这违反了三法则。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-21T14:47:20.370

你`Matrix c`是一个局部变量。因此，当创建它的方法结束时，它就会被销毁。在 C++ 中，这种不需要的情况通常通过复制对象来解决。您可以定义具有相同功能的复制构造函数和赋值运算符 =。复制的问题是它很慢，所以如果你希望它更快，你应该使用不同的方法而不是复制。例如，您可以将参数添加到调用方将引用传递给存储结果的现有矩阵对象的方法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-21T14:51:14.957

您需要一个复制构造函数和一个赋值运算符来为您的类制作对象的深层副本，因为编译器生成的函数不会。

编译器生成的复制构造函数和赋值运算符将简单地复制包含在类中的对象。在您的情况下，这些是 POD，因此自动生成的函数将简单地进行按位复制。在 的情况下`double**`，这将导致指针值的副本，而不是指向的值。结果，`Matrix`在析构函数从你下面拉出地毯之前，你最终得到了两个指向相同底层数据的对象。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2013-02-21T14:49:05.880

您应该更改代码以返回 Matrix *，而不是 Matrix 对象。这样，您可以确保 Matrix 对象存在于函数之后。（您当前的代码使 Matrix 对象成为函数变量，因此它将在函数结束后被删除）。

您的代码可能如下所示：

```
Matrix *Matrix::operator+(const Matrix& other)
{
    Matrix *c = new Matrix(m,n);
    for(int i=0;i<m;i++)
    {
       for(int j = 0; j<n;j++)
           c->mat[i][j] = mat[i][j] + other.mat[i][j];
    }
    return c;
} 
```

编辑：显然这是不好的做法，我猜我今天也学到了一些东西:)

# c# - 从 Interlocked 变量中读取最新值，仅对变量进行一次写入

> ID：15005083
> 
> 赞同：6
> 
> 时间：2013-02-21T14:44:29.850
> 
> 标签：c#, volatile, lock-free, interlocked

我想用两种方法创建一个类：

*   `void SetValue(T value)`存储一个值，但只允许存储一个值（否则它会引发异常）。
*   `T GetValue()`检索值（如果还没有值则抛出异常）。

我有以下愿望/限制：

*   读取值应该很便宜。
*   写入值可能（适度）昂贵。
*   `GetValue()`仅当最新值不存在时才应抛出异常 ( `null`)：它不应`null`在调用`SetValue()`另一个线程后基于陈旧值抛出异常。
*   该值只写入一次。这意味着`GetValue()`如果它不为空，则不需要更新该值。
*   如果可以避免完整的内存屏障，那么它（好多）更好。
*   我知道无锁并发更好，但我不确定这里是否是这种情况。

我想出了几种方法来实现这一点，但我不确定哪些是正确的，哪些是有效的，为什么它们是（不）正确和（低）效率的，以及是否有更好的方法来实现我想要的。

# 方法一

*   使用非易失性字段
*   用于`Interlocked.CompareExchange`写入字段
*   `Interlocked.CompareExchange`用于从字段中读取
*   这依赖于（可能是错误的）假设，即在`Interlocked.CompareExchange(ref v, null, null)`对字段执行操作后将导致下一次访问获得的值至少与所`Interlocked.CompareExchange`看到的值一样新。

编码：

```
public class SetOnce1<T> where T : class
{
    private T _value = null;

    public T GetValue() {
        if (_value == null) {
            // Maybe we got a stale value (from the cache or compiler optimization).
            // Read an up-to-date value of that variable
            Interlocked.CompareExchange<T>(ref _value, null, null);
            // _value contains up-to-date data, because of the Interlocked.CompareExchange call above.
            if (_value == null) {
                throw new System.Exception("Value not yet present.");
            }
        }

        // _value contains up-to-date data here too.
        return _value;
    }

    public T SetValue(T newValue) {
        if (newValue == null) {
            throw new System.ArgumentNullException();
        }

        if (Interlocked.CompareExchange<T>(ref _value, newValue, null) != null) {
            throw new System.Exception("Value already present.");
        }

        return newValue;
    }
} 
```

# 方法二

*   使用`volatile`字段
*   使用 Ìnterlocked.CompareExchange `to write the value (with [Joe Duffy](http://www.bluebytesoftware.com/blog/PermaLink,guid,c36d1633-50ab-4462-993e-f1902f8938cc.aspx)'s`#pragma `to avoid the compiler warning on passing a volatile value by`ref`）。
*   直接读取值，因为字段是`volatile`

编码：

```
public class SetOnce2<T> where T : class
{
    private volatile T _value = null;

    public T GetValue() {
        if (_value == null) {
            throw new System.Exception("Value not yet present.");
        }
        return _value;
    }

    public T SetValue(T newValue) {
        if (newValue == null) {
            throw new System.ArgumentNullException();
        }

        #pragma warning disable 0420
        T oldValue = Interlocked.CompareExchange<T>(ref _value, newValue, null);
        #pragma warning restore 0420

        if (oldValue != null) {
            throw new System.Exception("Value already present.");
        }
        return newValue;
    }
} 
```

# 方法三

*   使用非易失性字段。
*   写入时使用锁。
*   如果我们读取 null，则在读取时使用锁（因为引用是原子读取的，我们将在锁外获得一致的值）。

编码：

```
public class SetOnce3<T> where T : class
{
    private T _value = null;

    public T GetValue() {
        if (_value == null) {
            // Maybe we got a stale value (from the cache or compiler optimization).
            lock (this) {
                // Read an up-to-date value of that variable
                if (_value == null) {
                    throw new System.Exception("Value not yet present.");
                }
                return _value;
            }
        }
        return _value;
    }

    public T SetValue(T newValue) {
        lock (this) {
            if (newValue == null) {
                throw new System.ArgumentNullException();
            }

            if (_value != null) {
                throw new System.Exception("Value already present.");
            }

            _value = newValue;

            return newValue;
        }
    }
} 
```

# 方法四

*   使用 volatile 字段
*   使用锁写入值。
*   直接读取值，因为该字段是易失的（即使我们不使用锁，我们也会得到一个一致的值，因为引用是原子读取的）。

编码：

```
public class SetOnce4<T> where T : class
{
    private volatile T _value = null;

    public T GetValue() {
        if (_value == null) {
            throw new System.Exception("Value not yet present.");
        }
        return _value;
    }

    public T SetValue(T newValue) {
        lock (this) {
            if (newValue == null) {
                throw new System.ArgumentNullException();
            }

            if (_value != null) {
                throw new System.Exception("Value already present.");
            }

            _value = newValue;

            return newValue;
        }
    }
} 
```

# 其他方法

我还可以[`Thread.VolatileRead()`](http://msdn.microsoft.com/en-us/library/system.threading.thread.volatileread.aspx)结合任何写作技巧来读取值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T15:13:02.400

好吧，不确定波动性，但如果你不介意一点滥用和调用第二种方法......（它也不依赖于可空性；可自由用于值类型）也避免在 getter 中进行空检查。仅在写入时完成锁定，因此 AFAIK，唯一的负面影响来自在获取值时调用委托。

```
public class SetOnce<T>
{
    private static readonly Func<T> NoValueSetError = () => { throw new Exception("Value not yet present.");};

    private Func<T> ValueGetter = NoValueSetError;
    private readonly object SetterLock = new object();

    public T SetValue(T newValue)
    {
        lock (SetterLock)
        {
            if (ValueGetter != NoValueSetError)
                throw new Exception("Value already present.");
            else
                ValueGetter = () => newValue;
        }

        return newValue;
    }

    public T GetValue()
    {
        return ValueGetter();
    }
} 
```

事实上，我对此感到非常愚蠢，并感到有点辱骂。我很想看到有关这样做的潜在问题的评论。:)

编辑：刚刚意识到这意味着第一次调用`SetValue(null)`意味着“null”将被视为有效值，并将无异常返回 null。不确定这是否是您想要的（我不明白为什么`null`不能是有效值，但如果您想避免它，只需在 setter 中进行检查；在 getter 中不需要）

EDITx2：如果您仍想将其限制为`class`并避免`null`使用值，则简单的更改可能是：

```
public class SetOnce<T> where T : class
{
    private static readonly Func<T> NoValueSetError = () => { throw new Exception("Value not yet present.");};

    private Func<T> ValueGetter = NoValueSetError;
    private readonly object SetterLock = new object();

    public T SetValue(T newValue)
    {
        if (newValue == null)
            throw new ArgumentNullException("newValue");

        lock (SetterLock)
        {
            if (ValueGetter != NoValueSetError)
                throw new Exception("Value already present.");
            else
                ValueGetter = () => newValue;
        }

        return newValue;
    }

    public T GetValue()
    {
        return ValueGetter();
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T14:49:46.373

除了带有`lock`(#3) 的方法之外，您的任何方法都不能正常工作。

看：

```
 if (_value == null) {
        throw new System.Exception("Value not yet present.");
    }
    return _value; 
```

这段代码不是原子的，也不是线程安全的，如果不是 inside `lock`。其他线程仍然可能设置`_value`为`null`between`if`和`return`。您可以做的是设置为局部变量：

```
 var localValue = _value;
    if (localValue == null) {
        throw new System.Exception("Value not yet present.");
    }
    return localValue; 
```

但它仍然可以返回停顿值。您最好使用`lock`- 清晰、简单、快速。

**编辑**：避免使用`lock(this)`，因为`this`在外部可见，第三方代码可能会决定`lock`在您的对象上使用。

**编辑2：**如果永远无法设置空值，那么只需执行以下操作：

```
public T GetValue() {
    if (_value == null) {
        throw new System.Exception("Value not yet present.");
    }
    return _value;
}

public T SetValue(T newValue) {
    lock (writeLock)
    {        
        if (newValue == null) {
            throw new System.ArgumentNullException();
        }
        _value = newValue;
        return newValue;
    }
} 
```

# bit-manipulation - Teradata 14 是否支持按位？

> ID：15005084
> 
> 赞同：0
> 
> 时间：2013-02-21T14:44:40.437
> 
> 标签：bit-manipulation, bitwise-operators, teradata

我可以发誓我听说 TD14 将支持按位，但我在搜索中没有提到它，也没有在 TD14 手册中搜索“按位”。

有人可以确认是否支持按位吗？

顺便说一句，我正在查看的手册是 Teradata 用户文档，以防我应该阅读另一个文档。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-21T15:21:51.567

查看 Teradata 14 SQL 函数、运算符、表达式和谓词手册的第 4 章，解释了 Teradata 14 通过嵌入式服务函数提供的字节/位操作函数。

（**阅读：**它们不是像 Transact-SQL 中那样的原生 ANSI 运算符。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-17T22:06:04.397

是的，Teradata 14（和其他版本）支持这些类型的函数，如“SQL 函数、运算符、表达式和谓词”参考的第 6 章“位/字节操作函数”中所述。具体来说，它们有`BITAND(target_arg, bit_mask_arg)`BITNOT、BITOR、BITXOR、COUNTSET、GETBIT、SETBIT、ROTATELEFT、ROTATERIGHT、SHIFTLEFT、SHIFTRIGHT 和 SUBBITSTR。

# javascript - Jquery，按宽度调整图像大小保持恒定高度

> ID：15005085
> 
> 赞同：0
> 
> 时间：2013-02-21T14:44:48.593
> 
> 标签：javascript, jquery

如何调整图像大小/裁剪图像以使高度恒定但随着页面大小调整其宽度变小？

与您在此处的轮播中看到的效果相同：

[http://dai.com/](http://dai.com/)

谢谢，

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-21T14:58:39.303

你仔细看网站图片了吗？因为它没有调整大小！`img`它只是作为`background`属性居中在元素的中间。当您更改屏幕宽度时，您会看到图像中心已调整..

`background`仅使用属性来完成此效果非常简单：

`background: url("img path") 50% 0 no-repeat;`

背景图像将获取元素的高度。

示例：[这里](http://jsfiddle.net/4Uv7y/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T15:06:49.833

您应该将一个函数绑定到“resize”事件，
并给图像最大宽度和最大高度而不是高度和宽度，

```
 function imageresize() {  
 if (($(window).width()) < '800'){  
 $('#img').css('max-width',$(window).width());  
 } else {  
 $('#img').css('max-width','');  
 }  
 }  

 imageresize();

 $(window).resize(function(){
 imageresize();  
 }); 
```

我附上了一个 jsFiddle：http: [//jsfiddle.net/gGBRF/](http://jsfiddle.net/gGBRF/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-21T15:14:00.853

正如@Sven 所说，它没有被重新调整大小，它只是居中并重新调整浏览器的大小，使它看起来像是从两边溢出。

# entity-framework - EF 5 不会将 IsIdentity 的 PK 属性设置为 false

> ID：15005091
> 
> 赞同：1
> 
> 时间：2013-02-21T14:45:02.377
> 
> 标签：entity-framework

[该线程](https://stackoverflow.com/questions/14829911/identity-specification-set-to-false)中的答案对我不起作用。

我把这个注释放在我的客户类的 PK 上，就像这样。

```
public class Customer
{
    [DatabaseGenerated(DatabaseGeneratedOption.None)] 
    public int Id { get; set; }
    [Required]
    public string Name { get; set; }
} 
```

数据库迁移为新添加的数据注释创建了一个显示这一行的配置：

```
AlterColumn("dbo.Customers", "Id", c => c.Int(nullable: false)); 
```

我运行迁移并查看 SQL Server Management Studio 中的表。客户 ID 列仍然有 Identity Specification Yes 和 Is Identity Yes。我究竟做错了什么？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-21T18:36:45.243

你没有做错任何事。这是迁移的限制（或者可能被视为错误），因为 SQL 服务器不允许更改现有列的 IDENTITY。它只能在新列上设置。如果您在 management studio 中更改标识值，它将在内部执行一些复杂的 SQL 批处理，涉及临时表和大量数据操作。

最简单的解决方案是删除数据库并从初始迁移中删除身份定义。否则，使用 SQL 探查器查看 SQL 管理工作室在更改列的标识值时正在做什么，并在迁移中使用该 SQL 而不是`AlterColumn`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-21T14:48:42.620

EF把Id字段当作一个PK，一个PK必须有唯一值。这就是身份规范的含义。[表列属性](http://msdn.microsoft.com/en-us/library/ms177173.aspx)

设置 DatabaseGeneratedOption.None 仅指定 Id 不会由 DB Engine 生成，您必须提供它（我认为这不是一个好主意）。

# c# - 抛出自定义异常并使用 Postsharp 捕获它们

> ID：15005096
> 
> 赞同：1
> 
> 时间：2013-02-21T14:45:16.210
> 
> 标签：c#, security, exception-handling, postsharp

我有 2 个属性：

1.  SecuredOperation属性
2.  异常策略属性

如果用户无权访问控制器上的操作，那么我会抛出一个自定义**NonAuthorizedException**但我无法在 ExceptionPolicyAttribute 上捕获它

我的代码：

```
[LogMethod]
[ExceptionPolicy]
public ActionResult Edit(int id)
{
   // some works on here
}

[Serializable]
public class ExceptionPolicyAttribute : OnExceptionAspect
{
    private ILog logger;
    private string methodName;

    public override void CompileTimeInitialize(MethodBase method, AspectInfo aspectInfo)
    {
        this.methodName = method.DeclaringType.FullName + "." + method.Name;
    }

    public override void OnException(MethodExecutionArgs args)
    {
        Guid guid = Guid.NewGuid();

        var stringBuilder = new StringBuilder(1024);

        // Write the exit message.
        stringBuilder.Append(this.methodName);
        stringBuilder.Append('(');

        // Write the current instance object, unless the method
        // is static.
        object instance = args.Instance;
        if (instance != null)
        {
            stringBuilder.Append("this=");
            stringBuilder.Append(instance);
            if (args.Arguments.Count > 0)
               stringBuilder.Append("; ");
        }

        // Write the list of all arguments.
        for (int i = 0; i < args.Arguments.Count; i++)
        {
            if (i > 0)
                stringBuilder.Append(", ");
            stringBuilder.Append(args.Arguments.GetArgument(i) ?? "null");
        }

        // Write the exception message.
        stringBuilder.AppendFormat("): Exception ");
        stringBuilder.Append(args.Exception.GetType().Name);
        stringBuilder.Append(": ");
        stringBuilder.Append(args.Exception.Message);

        logger.Error(stringBuilder.ToString(), args.Exception);

        args.FlowBehavior = FlowBehavior.Continue;
    }

    public override Type GetExceptionType(System.Reflection.MethodBase targetMethod)
    {
        return typeof(NonAuthorizedException);
    }
} 
```

安全属性是：

```
[Serializable]
public class SecuredOperationAttribute: OnMethodBoundaryAspect
{
    public override void OnEntry(MethodExecutionArgs args)
    {
        IUserManager userManager = new UserManager();
        int userId = userManager.GetUserIdFromCookie;
        AdminUser adminUser = GenericSessionHelper<AdminUser>.Get(userId.ToString(), State.Session);
        if(!User.CanAccess)
        {
            args.ReturnValue = null;
            throw new NonAuthorizedException(string.Format("{0} userId li kullanıcının {1} işlemini yapmak için yetkisi yoktur",userId,args.Method.Name));
        }
        return;
    }
} 
```

可能是什么问题？我是否以错误的方式使用 postsharp？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-25T16:16:21.820

我找到了解决方案：我使用的属性如下：

```
[SecuredOperation]
[ExceptionPolicy]
public ActionResult Edit(int id) 
```

但 ExceptionPolicy 无法捕获异常。所以我将 ExceptionPolicy 移到了控制器类的顶部：

```
[ExceptionPolicy]
    public class UserController : BaseAuthorizedUserController 
```

现在它可以工作了。

# javascript - 为什么 JavaScript 会提升变量？

> ID：15005098
> 
> 赞同：122
> 
> 时间：2013-02-21T14:45:20.063
> 
> 标签：javascript, hoisting

**为什么 JavaScript 会提升变量？**

当他们决定实施吊装时，设计师的基本原理是什么？还有其他流行的语言可以做到这一点吗？

请提供文件和/或记录的相关链接。

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2013-02-22T00:22:37.567

正如 Stoyan Stefanov 在“JavaScript 模式”一书中所解释的，提升是 JavaScript 解释器实现的结果。

JS 代码解释分两遍执行。在第一次传递期间，解释器处理变量和函数声明。

第二遍是实际的代码执行步骤。解释器处理函数表达式和未声明的变量。

因此，我们可以使用“提升”的概念来描述这种行为。

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2020-01-28T14:54:14.253

# JS 创造者 Brendan Eich[曾经说过（在 Twitter 上）](https://twitter.com/BrendanEich/status/522394590301933568)：

> “因此，var 提升是函数提升、没有块范围和 JS 作为 1995 年的紧急工作的 [an] 意外结果。”

## 他还解释说……</h2>

> “函数提升允许自上而下的程序分解，'let rec'免费，在声明之前调用；var提升标记。”

[![布伦丹·艾希](../Images/0e09447792feec7ecb0236e65252527c.png)](https://i.stack.imgur.com/UJ8vo.png)

### 还有其他流行的语言可以做到这一点吗？

我不知道以相同方式提升变量的任何其他流行语言。我认为即使是 ActionScript（Flash 开发中使用的 ECMAScript 的另一种实现）也没有实现提升。对于熟悉学习 JavaScript 的其他语言的开发人员来说，这一直是困惑和沮丧的根源。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2019-03-02T13:50:10.703

这是因为 javascript 解释器在两个周期内解释代码。

1.  代码完成/编译：
2.  代码执行：

在第一个周期中，所有变量和函数声明都被带到它正在执行的函数范围的顶部。这有助于在函数执行之前创建函数`variableObjects`。`execution context`

在第二阶段，赋值、代码语句和函数调用以预期的方式逐行进行。

你在这里有更详细的阅读 [。](https://medium.com/@sidhujaspreet963/advance-javascript-why-hoisting-3db74309e674?source=friends_link&sk=5a0ddbd3b66f11b61f3807a4bd2c2b55)

它将让您更好地了解和声明周围的行为`let`，以及它在变量和函数之间遵循的优先级。`const``class`

# jquery - 无法选择jQuery ajax返回元素

> ID：15005103
> 
> 赞同：-1
> 
> 时间：2013-02-21T14:45:29.190
> 
> 标签：jquery, ajax, dom, external, readystate

我在使用 ajax 生成的选择器时遇到问题。

基本上我有一个默认状态的开始按钮。onclick，它启动了一些东西，然后单击还从带有结果的 ajax 调用中引入了一个新的 div。其中一项是停止按钮。我从主页链接的脚本有一个点击事件附加到这个停止按钮

```
<a id="stop">stop</a> 
```

如果我把脚本内联，在返回调用它自己也打印锚，我可以访问它

```
$('#stop').click(function() {   }); 
```

但是，我不希望那里有脚本（因为每页有多个项目，将它放在主链接资源中更有意义）。如果此调用位于主页的链接工作表中，则不会发生任何事情。

为什么是这样？

我应该使用另一个“文档就绪”包装器来处理返回元素吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-21T14:49:37.827

如果

```
<div id="container"></div> 
```

是将`ajax`调用结果附加到的元素，

你想做：

```
$('#container').on('click', '#stop', function() { console.log('test'); }); 
```

或者你可以做类似的事情

```
$('#stop').live('click', function(){ console.log('test'); }); 
```

但如果您要在页面上处理大量事件，我不建议您这样做，因为`live`每次使用都会增加开销。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-21T14:55:45.040

我对您的问题的理解是，您创建的点击事件不会触发通过 ajax 添加的元素。当您将处理程序附加到元素的单击事件时，这只发生在当前位于 DOM 中的那些元素上。你有几个选择来获得你想要的行为。

1）使用低效的“实时”处理程序。（效率低下通常以毫秒为单位）

```
$('#stop').live('click', function(){}); 
```

2) 在元素插入 DOM 后重新附加事件处理程序。

```
$.ajax({
    complete: function(){
        $('#idOfTheElementsYouJustInserted').click(function(){});
    }
}); 
```

3) 将事件处理程序附加到静态父元素，以便在单击按钮时，事件“冒泡”并触发此事件。要引用创建气泡的元素，可以使用 event.target ，其中 event 是传递给函数的默认参数。

```
$('#staticParentElement').click(function(event) { var elementClicked = event.target;   }); 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2013-02-21T14:47:41.300

您的主脚本没有将事件添加到您的新元素，因为它是在元素存在之前运行的。

是否可以在主脚本中创建函数，然后在添加事件时简单地指定函数 -

主脚本

```
var your_function = function() {
    // your code
} 
```

然后当你添加 div -

```
$('#stop').click(your_function()); 
```

更好的解决方案是 Brad M 建议将事件添加到父级并在它冒泡时对其进行处理。

# android - 应用程序可以保密吗？

> ID：15005111
> 
> 赞同：3
> 
> 时间：2013-02-21T14:45:51.840
> 
> 标签：android, ios, algorithm, hash, cracking

给定的服务器 API 应该可供所有未经授权的用户公开访问，但请求应该只允许来自一个特定的应用程序。

理论上，这应该通过拥有应用程序`HMAC-sign all API requests`以及让服务器正确发布和存储来完成`nonces`（以避免重放攻击）。

**问题：：**

是否有任何已知的方法可以让移动应用程序对秘密进行切片、切块、切分和异或运算，以使黑客和破解者很难（如果不是不可能的话）检索密钥？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-21T15:51:19.513

使用 iTunes 连接创建免费的应用内购买并让用户“购买”它（即使他们不会被收取任何费用）......然后使用您的服务器验证收据......Apple 将提供交易收据，该收据将验证它起源于您的应用程序。

[https://developer.apple.com/library/ios/#releasenotes/StoreKit/IAP_ReceiptValidation/](https://developer.apple.com/library/ios/#releasenotes/StoreKit/IAP_ReceiptValidation/)

# mysql - 来自 3 个左连接的极慢选择查询

> ID：15005117
> 
> 赞同：0
> 
> 时间：2013-02-21T14:46:04.287
> 
> 标签：mysql, sql, optimization, left-join

我有一个非常慢的选择查询，我已经尝试了很多方法来加快它，但它仍然需要*几分钟*才能执行。我将解释这些表格以及我尝试过的内容。我想知道是否有更有效的方法来组织这个相当简单的查询。

大约有18000行。

### 查询解释

本质上，这些**头寸由****经纪人**拥有的**客户**拥有，因此要将头寸与经纪人联系起来，我们需要遍历表格。我正在显示与相应经纪人的头寸，以及它们是否通过 链接到另一个头寸，以及链接的头寸（如果有）。**`clients``covered_positions`**

 **### 表格解释

*   `positions`包含客户进行的所有交易（股票/期权）。它有一个 PK `positionsID`(AI)，但 MySQL 似乎没有将它识别为*可能的 index*。在下面解释结果。
*   `clients`包含所有客户信息（客户）。它具有 PK `clientsID`(AI)，它是`positions`.
*   `login_users`包含经纪人（雇员）。它具有 PK `user_id`(AI)，它是`clients`as中的外键`broker_id`。
*   `covered_positions`包含 2-5 个位置之间的链接（不是超链接）。它有PK `covered_id`（AI）。这些`linked_id*`列是`positionsID`链接在一起的。

### 查询

```
delimiter $$

CREATE VIEW `main_join3` AS 
select `positions`.`id` AS `positionsID`,
`positions`.`order_list` AS `order_list`,
`positions`.`client_id` AS `client_id`,
`positions`.`client_name` AS `client_name`,
`positions`.`broker_name` AS `pos_broker_name`,
`positions`.`account_status` AS `pos_account_status`,
`positions`.`cost_basis` AS `cost_basis`,
`positions`.`cost_per_share` AS `cost_per_share`,
`positions`.`security` AS `security`,
`positions`.`security_type` AS `security_type`,
`positions`.`strike_price` AS `strike_price`,
`positions`.`option_type` AS `option_type`,
`positions`.`exp_month` AS `exp_month`,
`positions`.`exp_year` AS `exp_year`,
`positions`.`exp_date` AS `exp_date`,
`positions`.`buy_shares` AS `buy_shares`,
`positions`.`buy_date` AS `buy_date`,
`positions`.`buy_price` AS `buy_price`,
`positions`.`buy_commission` AS `buy_commission`,
`positions`.`buy_misc` AS `buy_misc`,
`positions`.`buy_cost` AS `buy_cost`,
`positions`.`sell_shares` AS `sell_shares`,
`positions`.`sell_date` AS `sell_date`,
`positions`.`sell_price` AS `sell_price`,
`positions`.`sell_commission` AS `sell_commission`,
`positions`.`sell_misc` AS `sell_misc`,
`positions`.`sell_cost` AS `sell_cost`,
`positions`.`loss` AS `loss`,
`positions`.`profit` AS `profit`,
`positions`.`funds_in_out` AS `funds_in_out`,
`positions`.`funds_in` AS `funds_in`,
`positions`.`funds_out` AS `funds_out`,
`positions`.`stop_order` AS `stop_order`,
`positions`.`notes` AS `notes`,
`positions`.`orange_highlight` AS `orange_highlight`,
`positions`.`date_created` AS `pos_date_created`,
`positions`.`date_updated` AS `pos_date_updated`,
`positions`.`created_by_id` AS `pos_cb_id`,
`positions`.`created_by_name` AS `pos_cb_name`,
`clients`.`id` AS `clientsID`,
`clients`.`broker_id` AS `broker_id`,
`clients`.`account_status` AS `clients_account_status`,
`login_users`.`user_id` AS `user_id`,
`login_users`.`user_level` AS `user_level`,
`login_users`.`username` AS `username`,
`login_users`.`name` AS `name`,
`covered_positions`.`id` AS `covered_id`,
`covered_positions`.`linked_id1` AS `linked_id1`,
`covered_positions`.`linked_id2` AS `linked_id2`,
`covered_positions`.`linked_id3` AS `linked_id3`,
`covered_positions`.`linked_id4` AS `linked_id4`,
`covered_positions`.`linked_id5` AS `linked_id5` 
from (((`positions` 
left join `clients` 
on((`positions`.`client_id` = `clients`.`id`))) 
left join `login_users` 
on((`clients`.`broker_id` = `login_users`.`user_id`))) 
left join `covered_positions` 
on(((`positions`.`id` = `covered_positions`.`linked_id1`) 
or (`positions`.`id` = `covered_positions`.`linked_id2`) 
or (`positions`.`id` = `covered_positions`.`linked_id3`) 
or (`positions`.`id` = `covered_positions`.`linked_id4`) 
or (`positions`.`id` = `covered_positions`.`linked_id5`))))$$ 
```

### 解释结果

```
id  select_type table   type    possible_keys   key key_len ref rows    Extra
1   SIMPLE  positions   ALL NULL    NULL    NULL    NULL    18070   
1   SIMPLE  clients eq_ref  PRIMARY PRIMARY 4   blackri_posting.positions.client_id 1   
1   SIMPLE  login_users eq_ref  PRIMARY,user_id PRIMARY 4   blackri_posting.clients.broker_id   1   
1   SIMPLE  covered_positions   ALL NULL    NULL    NULL    NULL    214 
```

### 我试过的

*   从查询中删除所有未使用的列
*   将查询创建为视图
*   分析和优化数据库
*   更换服务器

非常感谢任何支持。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T14:53:49.350

虽然很小，但您过度使用了括号...这里是从/加入修改的

```
from 
   positions
      left join clients
         ON positions.client_id = clients.id 
         left join login_users
            ON clients.broker_id = login_users.user_id
      left join covered_positions
         ON  positions.id = covered_positions.linked_id1
         or  positions.id = covered_positions.linked_id2  
         or  positions.id = covered_positions.linked_id3 
         or  positions.id = covered_positions.linked_id4
         or  positions.id = covered_positions.linked_id5 
```

其次，只是为了微笑，尝试将 MySQL 关键字“STRAIGHT_JOIN”添加到您的查询中......

SELECT STRAIGHT_JOIN（查询的其余部分）

第三，您的表“Covered_positions”是否对每个linked_id 列都有索引。如果无法在连接上使用索引，这将使您的查询爬网。

最后，如果您涵盖的职位表具有客户 ID，我绝对会将其添加为索引中的第一个字段，并在连接中包含客户 ID...这样，至少您将首先加入客户，然后该客户中的职位。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T17:11:29.870

我设法使用**触发器**解决了这个问题。我没有使用那些昂贵的 OR，而是简单地添加了一个`positions`名为from的列，`link_id`其中使用了：`id``covered_positions`

```
DELIMITER $$
CREATE TRIGGER covereds_after_insert
    AFTER INSERT ON covered_positions
    FOR EACH ROW
BEGIN
    UPDATE positions
    SET link_id = NEW.id 
    WHERE positions.id 
    IN (NEW.linked_id1, NEW.linked_id2, NEW.linked_id3, NEW.linked_id4, NEW.linked_id5);
END
$$ 
```

和

```
DELIMITER $$
CREATE TRIGGER covereds_after_delete
    AFTER DELETE ON covered_positions
    FOR EACH ROW
BEGIN
    UPDATE positions
    SET link_id = NULL
    WHERE positions.id 
    IN (OLD.linked_id1, OLD.linked_id2, OLD.linked_id3, OLD.linked_id4, OLD.linked_id5);
END
$$ 
```

这样，查询不会将 18,000 行变成大约 400 万行。**

# ssis - 如何在 SSIS 表达式中将 NULL 替换为零？

> ID：15005118
> 
> 赞同：4
> 
> 时间：2013-02-21T14:46:06.670
> 
> 标签：ssis

我有两列`ActivityCount`和`ParentValue`. 我创建了一个表达式：

```
ROUND((ActivityCount / ParentValue) / 100,16) * 100 
```

但问题是它返回`NULL`某些列，我想`NULL`用`0`. 我似乎找不到答案。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-21T15:13:40.473

### 表达：

```
ISNULL(ParentValue) || (ParentValue == 0) ? 0 : ROUND(ISNULL(ActivityCount) ? 0 : ActivityCount / ParentValue / 100,16) * 100 
```

### 为了可读性：

```
ISNULL(ParentValue) || (ParentValue == 0) 
    ? 0 
    : ROUND((ISNULL(ActivityCount) 
                ? 0 
                : ActivityCount / ParentValue) / 100
             , 16) * 100 
```

### 它能做什么：

*   如果*`ParentValue`*field is**`NULL`**或 has **`Zero`**，您不必执行计算，因为您会遇到*`Divide by Zero`*错误。因此，只需返回**0**即可退出表达式。

*   如果*`ActivityCount`*字段为**`NULL`**，则在执行计算之前将其替换为零。

### 推荐：

如果可能，我建议*`COALESCE`*在源查询上使用零值和计算替换 NULL 值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-21T14:53:00.147

使用[ISNULL](http://msdn.microsoft.com/en-us/library/ms141184.aspx)（SSIS，而不是 SQL 表达式）进行测试，使用[条件](http://msdn.microsoft.com/en-us/library/ms141680.aspx)运算符

```
ISNULL(ROUND((ActivityCount / ParentValue) / 100,16) * 100) ? 0 : ROUND((ActivityCount / ParentValue) / 100,16) * 100 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-21T14:55:59.720

试试下面...它会帮助你...

```
ISNULL(ROUND((ActivityCount / ParentValue) / 100,16) * 100) || (ROUND((ActivityCount / ParentValue) / 100,16) * 100)= "" ? 0 : ROUND((ActivityCount / ParentValue) / 100,16 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-02-21T15:13:02.170

我会说：

```
ISNULL(ActivityCount) || ISNULL(ParentValue) ? 0 : ROUND((ActivityCount/ParentValue)/100,16)*100 
```

这样，您正在测试将导致 NULL 结果的最简单情况，而不是在条件中多次计算最终情况。

（话虽这么说，任何这些在技术上都可以工作。）

# php - PHP包含函数，不显示图像

> ID：15005123
> 
> 赞同：1
> 
> 时间：2013-02-21T14:46:13.867
> 
> 标签：php, css

这就是我的 home.php 页面上包含的所有内容

```
<?php
    include ('../bgs/bg-verbier.html');
    include('../menus/menu-verbier.html');
?> 
```

两个请求的页面都位于父目录中。/menus/menu-verbier.html 对 include 函数没有任何问题，但是 '../bgs/bg-verbier.html 是。已找到该文件，但未显示图像。

图像的路径在位于同一父目录中的 .php 页面上工作，

这是 ../bgs/bg-verbier.html' 文件：

```
<div id="bg">
    <b><i><i><img src="images/verbier/0.jpg"></i></i></b>
    <!--b:holder, i#1: large canvas, i#2: center verticaly -->
    <b><i><i><img src="images/verbier/1.jpg"></i></i></b>
    <b><i><i><img src="images/verbier/2.jpg"></i></i></b>
    <b><i><i><img src="images/verbier/3.jpg"></i></i></b>
</div>
<script type="text/javascript" src="js/scaler.js"></script>
<script type="text/javascript" src="js/example.js"></script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-21T14:52:36.947

您的`images`文件夹必须与`php`调用它的文件位于同一目录中。否则，您必须指定图像文件夹的相对路径。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T14:53:45.610

当您`include`创建一个文件时，就像您将该文件的内容复制并粘贴到 PHP 文件中一样。

因此，就像 PHP 文件要求的一样`images/verbier/0.jpg`，这意味着它正在与 PHP 文件相同的文件夹中查找。

我建议您编辑 HTML 文件，使其使用图像的绝对路径，例如：

```
<img src="/menus/images/verbier/0.jpg"> 
```

# php - 覆盖报告中未显示的抽象方法

> ID：15005127
> 
> 赞同：1
> 
> 时间：2013-02-21T14:46:30.307
> 
> 标签：php, phpunit, code-coverage

我有一个包含抽象方法的抽象类

```
abstract class AbstractImporter
{
    abstract protected function runImporter();
} 
```

一个实现类

```
SomeImporter extends AbstractImporter
{
    public function runImporter()
    {
        //This does some work
    }
} 
```

和一个单元测试

```
SomeImporterTest extends \PHPUnit_Framework_TestCase
{
    public function testRunImporter()
    {
        $importer = new SomeImporter();
        $importer->runImporter();
        $this->assertTrue(true);
    }
} 
```

如果我运行它，则包含抽象方法定义的行`AbstractImporter`显示为未涵盖。

我也尝试`@covers AbstractImporter::runImporter`在`SomeImporter`.

有任何想法吗？提前致谢。

编辑：

当我使用 创建报告时，它**确实**显示为**无法访问**`--coverage-html`，但我的 IDE (PHPStorm) 将该行显示为**未覆盖**。PHPStorm 正在使用`--coverage-clover`并且在三叶草 xml 中我看到以下行：

```
<line num="66" type="method" name="runImporter" crap="1" count="0"/> 
```

# c++ - SDL 程序在关闭时崩溃 - c0000005？

> ID：15005130
> 
> 赞同：-3
> 
> 时间：2013-02-21T14:46:41.147
> 
> 标签：c++, sdl, sdl-1.2

试图只做一个简单的程序来显示加载到系统中的图片。如果我输入一个在目录中找不到的图像名称，它会返回并且错误说它还没有找到，但是在此之后当我返回 0 时出于某种原因；在主要内部，我崩溃了。

我找不到解决它的方法。对我做错了什么有帮助吗？

```
#include "SDL_Wrapper.h"
#include <iostream>
#include <string>

using namespace std;

class Image {
public:
    Image();
    ~Image();
    int loadImage();
    int saveImage();
    int outputImage();
protected:
    int height, width;
    string imageName;
    SDL_Surface* displayWindow;
    SDL_Surface* imageSurface;
    SDL_Surface* tempSurface;
};

Image::Image() {
    displayWindow = NULL;
    imageSurface = NULL;
    tempSurface = NULL;
}

Image::~Image() {
}

int Image::saveImage() {
    return 0;
}

int Image::outputImage() {
    return 0;
}

int Image::loadImage() {
    if (SDL_Init(SDL_INIT_EVERYTHING) == -1) {
        cout << "Error: Did not initialise correctly" << endl;
    }
    cout << "Enter the image name (and extension) you wish to use - ";
    cin >> imageName;
    imageSurface = LoadImage(imageName.c_str());

    // Check if the image has been loaded correctly
    if (imageSurface == NULL) {
        imageSurface = NULL;
        SDL_Quit();
        cout << "Error: Picture not loaded/found" << endl;
        return 1;
    }
    displayWindow = SDL_SetVideoMode(imageSurface->w, imageSurface->h, 32, SDL_SWSURFACE);
    if (displayWindow == NULL) {
        cout << "Error: displayWindow is blank, halting";
        return 1;
    }
    SDL_WM_SetCaption("Image Preview", NULL);
    SDL_BlitSurface(imageSurface, NULL, displayWindow, NULL);
    if (SDL_Flip(displayWindow) == -1) {
        cout << "Error: displayWindow did not flip correctly";
        return 1;
    }
    SDL_Event event;
    bool quit = false;
    while (quit == false) {
        while (SDL_PollEvent(&event)) {
            if (event.type == SDL_QUIT) {
                quit = true;
            }
        }
    }
    SDL_FreeSurface(imageSurface);
    SDL_Quit();
    return 0;
}

void test()
{
    Image img;
    img.loadImage();
}

int main(int argc, char * argv[]) {
    test();
    return 0;
} 
```

编辑：编译器告诉我这个 -

```
Unhandled exception at 0x776015de in SDL_Display.exe: 0xC0000005: Access violation reading location 0x61d47bce. 
```

在“调用堆栈”中，它在线

```
- > SDL_Display.exe!std::_DebugHeapDelete<std::locale::facet>(std::locale::facet * _Ptr)  Line 62 + 0xc bytes   C++ 
```

编辑 2：LoadImage() 函数 -

```
// Load Image
SDL_Surface* LoadImage(const char* ImageLocation)
{
    // Initialize Variables
    SDL_Surface *SDL_S_Return = NULL;

    // Load Image
    SDL_S_Return = IMG_Load(ImageLocation);

    // If it hasn't been loaded...
    if(SDL_S_Return == NULL)
    {
        // Send out an Error Message
        fprintf(stderr, "Error: %s\n", IMG_GetError());
    }

    // Return the Surface (Will be NULL if file isn't loaded)
    return SDL_S_Return;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T13:03:44.000

你的代码没问题。它运行良好，我能看到的唯一问题是：您没有将加载的图像转换为显示格式。试试这个功能：

```
 SDL_Surface *loadImage(char *imageToLoad)
{
    SDL_Surface *rawImage = NULL;
    SDL_Surface *fixedImage = NULL;

    //load image from file
    rawImage = IMG_Load(imageToLoad);
    //fix image's depth
    fixedImage = SDL_DisplayFormat(rawImage);
    //transparenty
    Uint32 colorkey = SDL_MapRGB(fixedImage->format,0xff,0,0);
    SDL_SetColorKey(fixedImage,SDL_SRCCOLORKEY,colorkey);
    //free memory
    SDL_FreeSurface(rawImage);
    return fixedImage;
} 
```

# django - Django 应用程序中 /admin/ 处的 UnicodeEncodeError

> ID：15005132
> 
> 赞同：3
> 
> 时间：2013-02-21T14:46:55.233
> 
> 标签：django, unicode, utf-8, ascii, admin

当我尝试查看现有对象的列表时，我在管理页面上收到以下错误。

```
UnicodeEncodeError at /admin/character/charlevel/

'ascii' codec can't encode character u'\xd6' in position 0: ordinal not in range(128)

Request Method:     GET
Request URL:    http://127.0.0.1:8000/admin/character/charlevel/
Django Version:     1.4.1
Exception Type:     UnicodeEncodeError
Exception Value:    

'ascii' codec can't encode character u'\xd6' in position 0: ordinal not in range(128)

Exception Location:     /home/***/workspace/***/***/character/models.py in __unicode__, line 413
Python Executable:  /usr/bin/python
Python Version:     2.7.3 
```

当我打开此类的对象列表时会发生这种情况：

```
class CharLevel(models.Model):
    char = models.ForeignKey(Character)
    prof = models.ForeignKey(Profession)
    level = models.SmallIntegerField()

    def __unicode__(self):
        return ('{c}/{l}/{p}'.format(c=self.char.name, l=self.level, p=self.prof )).encode('utf-8') 
```

如果我删除`{c}`字符串格式的组件，问题就会消失

但是，具有以下内容的 Charater 类不会出现此问题`__unicode__`：

```
class Character(models.Model):
    name = models.CharField(max_length=32)
    def __unicode__(self):
        return self.name 
```

我做错了什么？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-21T14:50:09.240

`__unicode__`应该返回`unicode`：

```
def __unicode__(self):
    return u'{c}/{l}/{p}'.format(c=self.char.name, l=self.level, p=self.prof) 
```

# c++ - 是否可以在类定义中使用 if 语句？

> ID：15005135
> 
> 赞同：0
> 
> 时间：2013-02-21T14:46:59.373
> 
> 标签：c++

我对 C++ 编程比较陌生，因此不知道你可以用一个类做多少。但是我想知道是否可以在头文件中创建一个类并在该类中使用 if 语句。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-21T14:48:25.280

您可以在该类的内联成员函数中使用 if 语句。您不能在函数之外使用 if 语句。（“语句”给出了它。语句只能出现在函数内部。）

# android - 无法将事件发送到谷歌分析

> ID：15005136
> 
> 赞同：0
> 
> 时间：2013-02-21T14:46:59.663
> 
> 标签：android, google-analytics

有没有人知道乳清不能将事件发送到谷歌分析？

代码：

```
 GAServiceManager.getInstance().setDispatchPeriod(20);
 GoogleAnalytics mGaInstance;
 Tracker mGaTracker1; 
 mGaInstance = GoogleAnalytics.getInstance(getActivity());
 mGaInstance.setDebug(true);
 mGaTracker1 = mGaInstance.getTracker(Consts.ANALYTICS);    
 mGaTracker1.sendEvent("aa", "bb", "cc", null); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T15:13:00.997

虽然我没有使用它来发送自定义事件或数据，但这个 api 文档似乎暗示它是可能的。

参考：[https ://developers.google.com/analytics/devguides/collection/android/v2/customdimsmets](https://developers.google.com/analytics/devguides/collection/android/v2/customdimsmets)

请注意，如果您在 logcat 中看到发送，那么它确实已发送，但您最多需要 24 小时才能开始在分析网络报告站点中看到任何内容。

# backbone.js - Backbone 监听来自 Raphael freeTransform 的事件

> ID：15005139
> 
> 赞同：2
> 
> 时间：2013-02-21T14:47:05.363
> 
> 标签：backbone.js, raphael, backbone-events

我知道如何处理一般事件，比如点击等，但是我在理解如何在我的渲染函数中监听函数触发的事件时遇到了问题：

```
function( ft, events) {
   console.log(events);
}); /*fires ["drag start"]
    ["drag"]
    ["apply"] 
    ["drag"] 
    ["apply"]
    ["drag"] 
    etc.*/ 
```

现在我想在我的视图中有处理程序来监听这些事件。我该怎么做？

这是整个视图：

```
var myView = Backbone.View.extend({ 

    initialize: function () {
        self = this;
        this.element = paper.rect();
        this.setElement(this.element.node);
        this.delegateEvents(this.events);

    },
    events: { 
        "click": "showHandles",
            "drag end": "dragEndHandler"
    },

    dragEndHandler: function(e){ 
        console.log('dragEnd'); 

    },      

    showHandles: function(e){ 
      this.ft.showHandles();
    },

    render: function(){ 
        this.element.attr({ 
            'x': this.model.get('x'),
            'y': this.model.get('y'),
            'width': this.model.get('width'),
            'height': this.model.get('height'),
            'fill': this.model.get('fill'),
            'cursor': this.model.get('cursor')
        })
        // Add freeTransform with options and callback
        this.ft = paper.freeTransform(this.element, { 
                'keepRatio': ['axisX', 'axisY'],
                'size': 4,
                //set handle
                'attrs': {'fill': '#436eee', 'stroke': '#fff'}
                }, 
                function( ft, events) {
                    console.log(events);/*fires ["drag start"]
                                                        ["drag"]
                                                        ["apply"] 
                                                        ["drag"] 
                                                        ["apply"]
                                                        ["drag"] 
                                                        etc.*/
                });
        return this; 
    } 
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-21T15:22:40.530

FreeTransform 接受回调作为第三个参数，您可以将其设置为绑定到您的视图的函数：

```
var myView = Backbone.View.extend({

    initialize: function () {
        _.bindAll(this, 'transformed');
       // ...
    },

    transformed: function (ft, events) {
        console.log(this);
        console.log(events);
    },

    render: function (){
        // ...
        this.ft = paper.freeTransform(this.element, options, this.transformed);
        return this;
    }
    // ...
}); 
```

`view.transformed`将使用此设置调用视图，这要归功于`_.bindAll`

要对特定事件做出反应，您必须检查*事件*数组是否包含相关值：

```
transformed: function (ft, events) {
    if (_.indexOf(events, "scale end")!==-1) {
        console.log("do something with scale end");
    }
}, 
```

有关演示，请参见[http://jsfiddle.net/nikoshr/BC2X3/](http://jsfiddle.net/nikoshr/BC2X3/)

或者您可以构建自己的事件路由方法：

```
transformed: function (ft, events) {
    var i = 0, l = events.length, ev;
    for (; i<l; i++) {
        ev = 'transformed_' + events[i].replace(' ', '_');
        if (this[ev])
            this[ev](ft);
    }
},

transformed_scale_end: function() {
    console.log("do something with scale end");
},
transformed_rotate_end: function() {
    console.log("do something with rotate end");
}, 
```

有关更新的演示，请参阅[http://jsfiddle.net/nikoshr/BC2X3/1/](http://jsfiddle.net/nikoshr/BC2X3/1/)

# ubuntu - 安装多个版本的 GStreamer

> ID：15005140
> 
> 赞同：1
> 
> 时间：2013-02-21T14:47:07.293
> 
> 标签：ubuntu, gstreamer, ubuntu-10.04

**是否可以在非标准位置**安装 GStreamer 软件包（例如：gstreamer-0.10.31、gst-plugins-base-0.10.31、gst-plugins-good-0.10.23）（通常我们将安装在 /usr/local ) ?

因为我们要在**不同版本的 GStreamer**中测试应用程序。因此，是否可以在一台机器上将不同版本安装到非标准路径，如下所示**（相对于默认的 /usr/local）**：

*   /home/gst-10.0
*   /home/gst-zx.x
*   /home/gst-xy.y

当我尝试在非标准位置安装时，系统会提示依赖包，因为它们不存在于该位置（默认情况下它们存在于 /usr/local 中），如下所示：

我确实设置了 LD_LIBRARY_PATH、PKG_CONFIG_PATH 和 PATH 变量

例如，假设我安装在 /home/gst-10.0 位置

我为上述变量设置了以下值**（我正在使用 Ubuntu 10.04LTS）**

**LD_LIBRARY_PATH** = /home/gst-10.0/lib:/home/gst-10.0/lib/gstreamer-0.10:/usr/lib
**PKG_CONFIG_PATH** = /home/gst-10.0/lib/pkgconfig
**PATH** = /home/gst-10.0/bin :$PATH
我在执行“./configure”时使用**前缀**为**/home/gst-10.0**

为了安装 GStreamer(10.04) 包，我有以下依赖项（当我尝试安装每个 Gstreamer 包时，这些依赖项都被提示安装）：

*   利油
*   zlib
*   获取文本
*   油嘴滑舌
*   libxml
*   libIDL
*   ORBit2
*   国际工具
*   攻击力
*   盘古
*   自由式
*   字体配置
*   开罗
*   总线
*   gconf
*   gtk

其中 dbus,gconf,gtk 软件包无法在此非标准位置安装并出现一些编译错误，但在默认 /usr/local 位置工作。因此，通过这种方式，我无法继续进行。

寻找您对此的想法。

提前致谢....

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T14:53:00.983

是的，这是完全可能的。我已经做了很多。我什至卸载了不同的版本。

许多现有的构建脚本已经存在；jhbuild 就是一个例子。

为什么要重新编译 dbus、gconf 等依赖项？重点是什么 ？你只需要用你想要的前缀编译gstreamer和friends。他们会很高兴地使用您系统安装的软件包作为依赖项。

您的 LD_LIBRARY_PATH 上不应有 /home/gst-10.0/lib/gstreamer-0.10；插件由插件目录中的 GStreamer 自动拾取。

# c# - 串行端口数据接收事件在与表单不同的类中

> ID：15005141
> 
> 赞同：0
> 
> 时间：2013-02-21T14:47:08.580
> 
> 标签：c#, events, event-handling

我正在使用 Windows 应用程序表单从串行端口接收数据。在表格内我可以提出`SerialportDataReceived`事件。但我想要的是把串口事件放在一个单独的类中，并将数据返回到表单中。

这是包含`eventhandler`串行端口接收数据的类：

```
class SerialPortEvent
{
    public void mySerialPort_DataReceived(object sender, SerialDataReceivedEventArgs e)
    {
        try
        {
            SerialPort sp = new SerialPort();
            //no. of data at the port
            int ByteToRead = sp.BytesToRead;

            //create array to store buffer data
            byte[] inputData = new byte[ByteToRead];

            //read the data and store
            sp.Read(inputData, 0, ByteToRead);

        }
        catch (SystemException ex)
        {
            MessageBox.Show(ex.Message, "Data Received Event");
        }

    }
} 
```

收到数据时如何将此类链接到表单？我必须在主程序或表单本身中提出事件吗？

我现在调用的方式主要如下：

```
 static void Main()
    {
        Application.EnableVisualStyles();
        Application.SetCompatibleTextRenderingDefault(false);
        Application.Run(new Form1());

        SerialPort mySerialPort = new SerialPort("COM81");
        SerialPortEvent ReceivedData = new SerialPortEvent();
        mySerialPort.DataReceived += new SerialDataReceivedEventHandler(ReceivedData.mySerialPort_DataReceived);
        myserialPort.open();
    } 
```

在串口接收事件中没有收到任何内容。

有什么我做错了吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-21T15:06:07.263

让您的其他类定义它自己的事件以供表单处理，该事件可以为表单提供读取的字节：

```
class SerialPortEvent
{
    private SerialPort mySerialPort;

    public Action<byte[]> DataReceived;

    //Created the actual serial port in the constructor here, 
    //as it makes more sense than having the caller need to do it.
    //you'll also need access to it in the event handler to read the data
    public SerialPortEvent()
    {
        mySerialPort = new SerialPort("COM81");
        mySerialPort.DataReceived += mySerialPort_DataReceived
        myserialPort.open();
    }

    public void mySerialPort_DataReceived(object sender, SerialDataReceivedEventArgs e)
    {
        try
        {
            //no. of data at the port
            int ByteToRead = mySerialPort.BytesToRead;

            //create array to store buffer data
            byte[] inputData = new byte[ByteToRead];

            //read the data and store
            mySerialPort.Read(inputData, 0, ByteToRead);

            var copy = DataReceived;
            if(copy != null) copy(inputData);

        }
        catch (SystemException ex)
        {
            MessageBox.Show(ex.Message, "Data Received Event");
        }
    }
} 
```

接下来，您不想在 中创建`SerialPortEvent`实例`Main`，而是希望在主窗体的构造函数或加载事件中创建它：

```
public Form1()
{
    SerialPortEvent serialPortEvent = new SerialPortEvent();
    serialPortEvent.DataReceived += ProcessData;
}

private void ProcessData(byte[] data)
{
    //TODO do stuff with data
} 
```

# jquery - 将小部件添加到 jquery Masonry

> ID：15005156
> 
> 赞同：1
> 
> 时间：2013-02-21T14:47:47.157
> 
> 标签：jquery

我对此完全是新手，但是对于使用 jquery Masonry 的网站，我想添加“小部件”（一个 222 像素 x 50 像素的小框，上面写着在 Facebook 上添加我们等），以便在每个页面上都可以看到位置，即在前 5 个帖子之后等。

如何才能做到这一点？

PS：可以在这里看到一个示例：[http](http://www.dazeddigital.com) ://www.dazeddigital.com在帖子之间，有诸如“阅读所有相关信息”之类的小部件。

# android - 对话只触发一次

> ID：15005158
> 
> 赞同：0
> 
> 时间：2013-02-21T14:47:50.007
> 
> 标签：android, android-alertdialog

我有一个带有图标的列表视图，当我单击该图标时，它会触发一个 dailog ..我的实现如下

```
private void sendmessage() {

        final Dialog dialog = new Dialog(getActivity(),
                R.style.FullHeightDialog);
        dialog.setContentView(R.layout.customdailog);
        WindowManager.LayoutParams lp = new WindowManager.LayoutParams();
        lp.copyFrom(dialog.getWindow().getAttributes());
        lp.width = WindowManager.LayoutParams.MATCH_PARENT;
        lp.height = WindowManager.LayoutParams.WRAP_CONTENT;

        try {
            final EditText edittext = (EditText) dialog
                    .findViewById(R.id.fbedittext);

            spinner = (Spinner) dialog.findViewById(R.id.replyspinner);

            Button diButton = (Button) dialog.findViewById(R.id.fbshare);
            ImageView dialogcancelButton = (ImageView) dialog
                    .findViewById(R.id.fbreplycancel);
            dialogcancelButton.setOnClickListener(new OnClickListener() {
                public void onClick(View v) {
                    dialog.dismiss();
                    getActivity().finish();

                }});

            diButton.setOnClickListener(new OnClickListener() {
                public void onClick(View v) {
                    try {
                        String userComment = edittext.getText().toString();
                        boolean postStatus=true;

                        postStatus=false;
                        }

                        postReply(userComment,postStatus);
                        getActivity().finish();

                         }
                         }  } catch (Exception e) {}});

            dialog.show();
            dialog.getWindow().setAttributes(lp);
            } catch (Exception e) {
            e.printStackTrace();
            getActivity().finish();
        }

    } 
```

我的问题是 dailog 仅触发一次，例如，当我在单击 cancelbutoon 或按后退按钮后第一次单击图标打开 dailog 时，当我再次单击时，dailog 未打开，不确定发生了什么。任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T10:00:28.923

解决了`setOnCancellistener`

```
dialog.setOnCancelListener(new OnCancelListener() {

            @Override
            public void onCancel(DialogInterface dialog) {
                getActivity().finish();
            }
        } ); 
```

# .net - LINQ to EF 返回所有列并且不将 WHERE 子句传递给服务器

> ID：15005160
> 
> 赞同：0
> 
> 时间：2013-02-21T14:47:58.717
> 
> 标签：.net, asp.net-mvc, linq, entity-framework, linq-to-entities

我正在使用 LINQ to Entity in Razor。我有这样的事情：

```
@foreach(Org o in Model) {
    @foreach(User u in o.Users.Where(x => x.Active==true) ) {
       <span> @u.FirstName </span>
    }
} 
```

当我查看 SQL Server Profiler 时，查询有两个主要的低效率：

1.  它返回用户表中的所有列
2.  它返回用户表中的所有行，而不仅仅是那些 Active==true 的行。

当然它可以正常工作，但我的印象是 LINQ 比这更聪明，并且会向 SQL 服务器发送更具体的查询。

问题：我可以让 LINQ 传递 WHERE 子句 (Active==true) 并且只自动获取 FirstName 列吗？

ps 除非严格相关，否则我对视图中的 LINQ 是否是好的做法不太感兴趣——例如，视图的优化是否与编译的代码不同？

这是我的控制器代码：

```
public ActionResult Index()
{
    xyz_Entities db = new xyz_Entities();
    return PartialView(db.Orgs);
} 
```

更新 - 许多道歉，这实际上是一个嵌套循环，可能很重要。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-21T14:53:49.610

> 它返回用户表中的所有列

确实如此——Linq 不知道你打算*使用*这些数据——所以它会返回所有的列。

> 它返回用户表中的所有行，而不仅仅是那些 Active==true 的行。

我猜这是因为`Model`通过调用`ToList`或实现控制器中的所有记录`AsEnumerable`。

为了避免这些，我会在控制器而不是视图中进行查询，并将结果作为模型或`ViewData`字典的一部分传递。您可以尝试将查询缩减为：

```
var names = Model.Users.Where(x => x.Active==true)
                       .Select(u => u.FirstName)
                       .ToList();
ViewData["Names"] = names; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-21T14:52:39.340

您尚未显示填充模型的位置，但这就是数据访问发生的位置，也是您从数据库中检索所有用户的原因。

当您到达此视图时，您已经填充了您的`Users`集合，因此您只需将 LINQ to Objects 与您的内存集合一起使用。

您将需要更改填充模型的数据访问代码，以在数据库查询级别应用过滤器。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-21T14:58:18.787

它可能会拉出所有行，因为您正在调用`ToList`或`ToArray`因为声明的类型`Model.Users`是`IEnumerable<>`而不是`IQueryable<>`. 对扩展方法的调用被编译器重写为像普通静态方法一样被调用，并且编译器使用声明的类型来确定`IEnumerable<>`vs `IQueryable<>`。

修复过滤问题后，您可以使用`Select`扩展方法准确告诉 EF 您希望查询返回哪些列。

# graph - 为什么具有 n 个顶点的图有 2^n -2 个割？

> ID：15005162
> 
> 赞同：14
> 
> 时间：2013-02-21T14:47:59.523
> 
> 标签：graph

为什么具有 n 个顶点的图有 2^n -2 个割？我想不通这个。有 4 个顶点，我不能得到 14 次切割。我可以得到最大值。12刀？我错过了什么？

通过 cut ，我的意思是 V 分为 2 对非空顶点列表 - A 和 B。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-02-21T15:01:48.193

使其合理化以及列举削减的一种简单方法是为每个节点分配一个二进制数字。0 表示它在集合 A 中，1 表示它在集合 B 中。然后简单地递增，忽略 0 和 2^n - 1 的情况，留下 2^n - 2 个削减。因此，对于具有顶点 P、Q、R、S 的 4 顶点图：

```
PQRS
0000 A : { P,Q,R,S } B : {} // ignore, B is empty
0001 A : { P,Q,R } B : { S }
0010 A : { P,Q,S } B : { R }
0011 A : { P,Q } B : { R,S }
0100 A : { P,R,S } B : { Q }
0101 A : { P,R } B : { Q,S }
0110 A : { P,S } B : { Q,R }
0111 A : { P } B : { Q,R,S }
1000 A : { Q,R,S } B : { P }
1001 A : { Q,R }, B : { P,S } 
1010 A : { Q,S } B : { P,R }
1011 A : { Q } B : { P,R,S }
1100 A : { R,S } B : { P,Q }
1101 A : { R } B : { P,Q,S }
1110 A : { S } B : { P,Q,R }
1111 A : {} B : { P,Q,R,S } // ignore, A empty 
```

剩下的就是 14, 2^4 - 2。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-21T15:00:43.603

我认为这很明显：

*   每个顶点可以在集合 A 或集合 B
*   我们有 n 个顶点
*   n 顶点上的两种可能性导致 2^n 排列
*   删除所有顶点都在 A 或 B 中的一次
*   这给了我们 2^n - 2

或者把它想象成一个真值表。`a`表示一个顶点在集合 A 中，`b`表示它在集合 B 中。

```
Vertices
1 2 3 4
a a a a
a a a b
a a b a
a a b b
a b a a
a b a b
a b b a
a b b b
b a a a
b a a b
b a b a
b a b b
b b a a
b b a b
b b b a
b b b b 
```

如果我们删除`a a a a`and`b b b b`集合，我们就剩下所需的 14 ......

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-02-21T14:52:28.523

你的最后一句话说 - 切割只是将顶点集划分为两个集合，这两个集合都不为空。

因此，要定义一个特定的切割，你只需取 V 的一些子集，它定义了 A，还有 B，它的补码。

V 的子集数，其中 |V| = n 是 V 的幂集的基数，2^n。但是，您必须减去两种情况，因为 A 不能为空，也不能等于 V，因为那样 B 将是空的。因此 2^n - 2。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-11-02T18:19:32.130

割意味着一个顶点要么在一个集合 A 中，要么在一个集合 B 中。

由于两个集合都必须是非空的，因此以下是唯一的可能性。

1, (n-1) ==> 这意味着集合 A 中有 1 个顶点，集合 B 中有 (n-1)。从 n = nC1 中选择 1 的方法没有

2, (n-2) ==> 集合 A 中的 2 个顶点和集合 B 中的 (n-2)。从 n = nC2 中选择 2 的方法数

3, (n-3) ==> 集合 A 中的 3 个顶点和集合 B 中的 (n-3)。从 n = nC3 中选择 3 的方法数

(n-1), 1 ==> (n-1) 集合 A 中的顶点和集合 B 中的 1。从 n = nCn-1 中选择 n-1 的方法数

因此，总削减数为：

```
nC1 + nC2 + nC3 + ..... nCn-1 = 2^(n)-2 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-04-07T02:26:16.227

起初，我在计算 4 个顶点（正方形）有多少切口时遇到了类似的问题。

请记住，您可以按正方形的对角线切割。这将为您提供缺少的 2。

# sql - 使用相同数据进行 Oracle UNION 查询的效率提高一倍

> ID：15005164
> 
> 赞同：0
> 
> 时间：2013-02-21T14:48:03.740
> 
> 标签：sql, oracle

我想知道如何在不必两次写出（或使数据库进程）成为该查询的主要部分的情况下做到这一点。

我的场景是我正在查询一个 Oracle 企业数据库（我受到 DBA 的限制，所以有些解决方案可能不起作用，但我不确定我受限到什么程度，直到我尝试并且不知道去哪里还没有）。

目前，我的查询如下所示：

```
 SELECT
        a.Field1,
        a.Field2,
        b.Field3,
        b.Field4,
        c.Field5
    FROM
        a,
        b,
        c,
    WHERE
            a.FieldX = b.FieldX
        AND
            b.FieldY = c.FieldY

UNION
  (
    SELECT
        d.Field6 as Field1,
        d.Field7 + d.Field8 as Field2,
        MainQuery.Field3,
        MainQuery.Field4,
        MainQuery.Field5
    FROM
        (
            SELECT
                a.Field1,
                a.Field2,
                b.Field3,
                b.Field4,
                c.Field5
            FROM
                a,
                b,
                c,
            WHERE
                    a.FieldX = b.FieldX
                AND
                    b.FieldY = c.FieldY
                AND
                    a.FieldZ = 'XXXX'
        ) MainQuery,

        d
    WHERE
        MainQuery.Field1 = d.Field6
  ) 
```

简单地说，我有一个主查询（第一部分），它返回我的大部分结果，然后我重复主查询，但有一个额外的限制（`a.FieldZ = 'XXXX'`），并从这个查询和第二个表中提取数据并将其附加到使用`UNION`.

我面临的主要挑战是两个查询之间`Field1`&的定义发生了`Field2`变化，所以我不知道如何做一个简单的连接。但我确信必须有一种方法可以实现这一点，而不必让数据库查询相同的数据两次。

关于如何使这个查询更有效的任何想法？

谢谢！！

* * *

根据评论，更多地解释这个查询 - 我要做的是在查询的前半部分获取我的全部数据，然后在查询的后半部分附加额外的行以获取记录其中`a.FieldZ = 'XXXX'`计算与和的略有不同的`Field1`地方`Field2`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-21T14:58:38.040

因此，根据您的评论，您的要求似乎是“第 2 列将从表中获取`M`。另外，当`M.fieldZ = 'XXX'`需要从表中添加带有字段的额外行时`D`。”

在这种情况下，您将不得不使用 UNION ALL 或通过加入 2 行表来复制您的记录。您可以使用该`WITH`子句在 SELECT 中重用子查询。这将使其更具可读性，优化器可能决定只运行一次查询（通过将子查询的结果保存在 temp 中）。

```
WITH mainquery AS (SELECT /* your main query */)
SELECT *
  FROM mainquery
 UNION ALL
SELECT field1, d.field2 /*, ... */
  FROM (SELECT * FROM mainquery WHERE fieldZ = 'XXX') m
  JOIN d ON m.field1 = d.field6 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-21T16:43:28.563

我相信这是一种方法，可以为您提供所需的答案。如果没有大量数据，我无法判断它是否会更快。在这里，您将扫描临时表几次，但如果基本查询从表 a、b、c 和 d 中返回一小组数据，则工作量可能会减少。

```
with foo as 
   (SELECT
        a.Field1,
        a.Field2,
        a.FieldZ,
        b.Field3,
        b.Field4,
        c.Field5
    FROM
        a,
        b,
        c
    WHERE
            a.FieldX = b.FieldX
        AND
            b.FieldY = c.FieldY
)
select Field1
       ,field2
       ,field3
       ,field4
       ,field5 
from foo
union
select
 d.Field6 as Field1
 ,d.Field7 ||'+'|| d.Field8 as Field2
 ,foo.Field3
 ,foo.Field4
 ,foo.Field5
from foo
join d on foo.field1 = d.field6
where foo.fieldz = 'XXXX' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-21T14:54:52.920

使用`case`声明（[http://www.techonthenet.com/oracle/functions/case.php](http://www.techonthenet.com/oracle/functions/case.php)）

例如

```
select case when FieldZ = 'XXXX' then Field6 else Field1 end as Field1,
       case when FieldZ = 'XXXX' then Field7 + Field8 else Field2 as Field2,
       Field3,
       Field4,
       Field5
from   a join b on a.FieldX = b.FieldX
       join c on b.FieldY = c.FieldY
       left join d on a.Field1 = d.Field6 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-21T15:02:50.433

If your intention is *not* to duplicate the XXXX records, then you can simplify the query to an appropriate join with case statements:

```
SELECT (case when a.FieldZ = 'XXXX' then a.Field1 else d.Field6 end) as Field1,
       (case when a.FieldZ = 'XXXX' then a.Field2 else d.Field7 + d.Field8 end) as Field2,
        b.Field3,
        b.Field4,
        c.Field5
FROM a join
     b
     on a.FieldX = b.FieldX join
     C
     on b.FieldY = c.FieldY left outer join
     d
     on A.Field1 = d.Field6 and
        a.FieldZ = 'XXXX' 
```

If you are duplicating these records, then some sort of `union all` would seem necessary.

# c# - PostBack 在 ASP.NET 中是否失败？

> ID：15005166
> 
> 赞同：3
> 
> 时间：2013-02-21T14:48:08.497
> 
> 标签：c#, asp.net, ispostback

我们有一个为物流公司创建的 ASP.NET 3.5 应用程序，它允许他们的客户输入交货/工作并将它们输入系统。

系统中的核心页面是您可以想象的 Add Job 屏幕 - 当用户建立他们的工作时，我们将一些信息存储在 Session 中。然后，当他们提交作业时，或者在`Page_Load`请求不是回发的情况下，会话被清除，为下一个作业做好准备。

我们遇到了一小部分客户的问题，其中用户会话似乎在提交发生之前被擦除 - 用户向我们保证他们没有尝试使用多个会话（即同一页面的 2 个窗口） . 我们在该页面上清除了会话时记录了一些错误捕获，并且似乎在`Page_Load`事件中的“清除会话”在他们单击提交之前触发了几秒钟。请注意，我们在此页面上有很多`autopostback`控件。

是否有任何 ASP.NET 怪癖或浏览器怪癖，这意味着该`IsPostback`属性将错误地为假？这是一个非常零星的问题，我们无法复制它！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T15:35:10.157

正如许多评论所建议的那样，会议是错误的解决方案。它可以被很多东西重置（例如应用程序池回收）。

您不应该强迫用户不要使用不同的浏览器或选项卡，因此正确的选择是将数据移动到 ViewState/Control 状态。

如果由于某些奇怪的原因您仍然必须在会话中保留数据，请考虑切换到持久会话存储（即使用 sql Server）。

# django - Google Maps Ground Overlay 不缓存 Django 提供的动态图像

> ID：15005167
> 
> 赞同：1
> 
> 时间：2013-02-21T14:48:14.093
> 
> 标签：django, caching, google-maps-api-3, http-caching, django-caching

我在 javascript 中设置了一个谷歌地图叠加层（v 3.10）来显示在服务器上生成的图像：

```
var overlay = new google.maps.GroundOverlay(url, MAP_BOUNDS, {map: gmap}); 
```

当 url 指向静态 url 时，覆盖可以正常工作。但是，当它指向 Django (v 1.4) 动态 url 时，图像会正确显示，但**随着地图的滚动，它会不断向 url 发出服务器请求。** 例如：

```
url = 'localhost:8000/abcdef/maps/getMap' 
```

在 Django urls.py 中：

```
url(r'^(?P<key>\S+)/maps/getMap/$', 'maps.views.getMap'), 
```

该 url 重定向到此代码：

```
@csrf_exempt
def getMap(request, key):

    response = HttpResponse(mimetype="image/png")

    im=Image.open('media/maps' + id + '/map.png')
    im.save(response, 'PNG')

    return response 
```

因此，在我看来，谷歌地图/浏览器出于缓存目的处理图像的方式存在一些差异，可能与 HTTP 标头中的某些内容有关。我怎样才能使它在检索图像后不会继续发出服务器请求？

通过检查浏览器控制台中的响应标头，静态图像似乎具有“Content-Length”和“Last-Modified”字段，而动态图像没有。不确定这是否相关。

感谢任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T16:40:18.357

原来解决方案相对简单：

```
response = HttpResponse(image_data, mimetype="image/png")
response['Cache-Control'] = 'max-age=86400'
return response 
```

# java - 如何生成构建器类

> ID：15005170
> 
> 赞同：7
> 
> 时间：2013-02-21T14:48:21.707
> 
> 标签：java, javafx-2

我在一个库中开发了一个自定义 javafx.animation.Transition。我想提供相应的构建器（例如`TranslateBuilder`用于`Translate`转换）。

[正如您在TranslateBuilder](http://docs.oracle.com/javafx/2/api/javafx/scene/transform/TranslateBuilder.html) javadoc中所见，构建器类由`@Generated(value="Generated by javafx.builder.processor.BuilderProcessor")`.

可以使用这个处理器吗？如果是，如何？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-21T21:19:08.283

构建器是使用注释处理器创建的，现在它是内部的。

我创建了一个问题：http: [//javafx-jira.kenai.com/browse/RT-28553](http://javafx-jira.kenai.com/browse/RT-28553)

这是为了跟踪目的和讨论。

# linux - 如何在环境变量中添加任何命令

> ID：15005172
> 
> 赞同：0
> 
> 时间：2013-02-21T14:48:26.160
> 
> 标签：linux, bash, shell, ssh

我有一个变量

```
 PVM_RSH=/usr/bin/ssh 
```

我想逐步添加一个标志`-v`来检查 ssh 的工作方式。

为此，我运行一个命令`PVM_RSH="/usr/bin/ssh -v "`。

但它显示

**错误 - 文件 /usr/bon/ssh -v 未找到！**

帮助我如何克服这个错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T15:00:36.227

我想知道你想在变量中做一个别名或定义它

```
 1\. alias something='unix command with options' 
```

或者

1.  设置可以使用“`”完成的变量

例如 ：

```
 PVM_ROOT=`some command whose output u want to set`
  For example : PVM_ROOT=`cat file | wc -l` --gives the count of number of lines 
```

同样在 UNIX 中，对于 SSH 没有 -v 选项

因为我不是你的 LINUX，所以这就是你想要做的：

```
$a="ftp -i"

 $ echo $a
 ftp -i
 $ `echo $a`
 ftp> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T16:33:00.247

PVM_RSH="/usr/bin/ssh -v"

要运行该命令，必须输出变量 PVM_RSH 的内容以供 shell 解释。所以-：

**$PVM_RSH**

# solr - 在 Solr 中获得相似度分数

> ID：15005174
> 
> 赞同：8
> 
> 时间：2013-02-21T14:48:34.410
> 
> 标签：solr, lucene

如何获得查询和 Solr 中每个检索到的文档之间的相似度分数？

此外，如何设置 Solr 检索方法？例如，在向量空间模型或文档语言模型之间进行选择。

可能吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-21T21:00:50.353

正如您在自己的答案中提到的，您可以指定 Solr 要使用`fl=*, score`. 您可以阅读[本文档来查看它](http://wiki.apache.org/solr/SolrRelevancyFAQ#How_can_I_see_the_relevancy_scores_for_search_results)

首先，Lucene/Solr，只提供[TF-IDF](http://en.wikipedia.org/wiki/Tf%E2%80%93idf)（基于VSM）评分策略。如果您决定插入第三方相似度实现，您[可以更改 Solr 使用的评分策略](http://wiki.apache.org/solr/SchemaXml#Similarity)，但您不能在查询基础上更改它。实际上，您需要[重新加载内核](http://wiki.apache.org/solr/CoreAdmin#RELOAD)才能更改它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-21T14:57:29.537

如此处所述[https://stackoverflow.com/a/9262300/1593370](https://stackoverflow.com/a/9262300/1593370) 您可以通过添加`fl=*,score`到您的请求中将分数字段添加到结果中。

但我仍然找不到选择检索方法的方法。

# .net - Visual Studio 2010 Professional 和 Team Foundation Server 2012 Express

> ID：15005181
> 
> 赞同：7
> 
> 时间：2013-02-21T14:48:46.443
> 
> 标签：.net, visual-studio, visual-studio-2010

由于以下错误消息，我无法从 VS 2010 Professional 中的团队资源管理器创建新团队项目：

![在此处输入图像描述](../Images/914cff93082636ce2b67769c365f0f08.png)

> TF30172：您正在尝试在没有所需权限或使用旧版本的团队资源管理器的情况下创建团队项目。请联系您的项目管理员以检查您的权限或确定如何升级团队资源管理器。

我是 TFS 的管理员，也是“Team Foundation Adminstrators”组的一员。我可能做错了什么？

此外，我还安装了 VS2010 的 SP1 和[KB2662296](http://www.microsoft.com/en-us/download/details.aspx?id=29082)修补程序。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-21T16:48:54.627

此错误消息表明需要 Team Explorer 2012 才能针对 Team Foundation Server 2012 创建团队项目。

您应该安装 Team Explorer 2012 以创建您的团队项目。如果您没有安装 Visual Studio 2012，Team Explorer 2012 将安装为可用于连接到 TFS 的独立应用程序。这将与 Visual Studio 2010 并行安装，它不会升级您现有的安装。正如艾伦在他的回答中指出的那样，您可以从 Visual Studio 2010 连接到 TFS 2012 实例。您只需要匹配的团队资源管理器版本**来**创建团队项目。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-23T04:49:26.433

是的，您需要VS2010 SP1，以及前向兼容性升级GDR 补丁才能使VS2010 连接到TFS2012。但是，VS2010 附带的 Team Explorer 及其所有变体（beta、RTM、SP1）不支持按设计创建 Team Project。

见巴克霍奇斯的帖子：

[http://blogs.msdn.com/b/buckh/archive/2012/03/05/permission-error-with-creating-a-team-project-from-vs-2010-on-tfs-11-beta。 .aspx](http://blogs.msdn.com/b/buckh/archive/2012/03/05/permission-error-with-creating-a-team-project-from-vs-2010-on-tfs-11-beta.aspx) _

Buck 断言您将需要 Team Explorer 2012 来创建 Team Project，**但之后可以安全地将 Team Explorer 2010 用于所有其他目的**。这是很重要的一点。

*   VS2010 SP1 链接是 [http://www.microsoft.com/en-us/download/details.aspx?id=23691](http://www.microsoft.com/en-us/download/details.aspx?id=23691)

*   GDR 链接是 [http://www.microsoft.com/en-us/download/details.aspx?id=29082](http://www.microsoft.com/en-us/download/details.aspx?id=29082)

*   Team Explorer 2012 链接是 [http://www.microsoft.com/en-us/download/details.aspx?id=30656 （注意这将安装](http://www.microsoft.com/en-us/download/details.aspx?id=30656)[Edward Thomson](https://stackoverflow.com/users/729881/edward-thomson) 提到的 VS2012 shell ）

我已经确认通过此设置，您可以通过 VS2012 shell 使用 Team Explorer 创建一个 Team Project，然后在 VS2010 Team Explorer 中连接到它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-21T15:05:05.647

先安装[VS2010SP1](http://support.microsoft.com/kb/2182621)，再安装[compat gdr补丁](http://www.microsoft.com/en-us/download/details.aspx?id=29082)连接到TFS2012。

# c# - 通过 Internet 连接 MySQL 和 .net 应用程序有危险吗？

> ID：15005183
> 
> 赞同：3
> 
> 时间：2013-02-21T14:48:50.993
> 
> 标签：c#, mysql, .net, mysql-connector

对于一个小项目，我需要在 MySQL 中存储一些数据。用户遍布世界各地并运行 .net ClickOnce 应用程序。访问的数据并不是真正机密的，即使有人可以访问，从隐私的角度来看也不会造成损害。

从技术上讲，可以将 MySQL 数据库放在某处的服务器上，并让每个人都通过**Internet 上的**[Connector/Net进行连接。](http://dev.mysql.com/downloads/connector/net/) **但这是可取的吗？**

1.  协议是否足够稳定/健壮，可以处理速度较慢的互联网连接？
2.  这会是一个严重的安全风险。数据加密**不是**主题，但密码加密才是。将 MySql 数据库（端口）打开到 Internet 会有危险吗？

或者，我可以通过 Web 服务或其他方式“包装”数据库访问。但当然这是我想避免的一些开销。那么通过 Internet 连接 MySQL 是一个有效的选择吗？

评论：

*   [没有通过 Internet 与 VB.NET 的 MySQL 连接](https://stackoverflow.com/questions/4749563/mysql-connection-with-vb-net-via-internet)重复！
*   所以通过互联网[连接到数据库](https://stackoverflow.com/questions/10314937/connecting-to-the-database-via-the-internet)不太具体，截至今天还没有答案。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-21T14:58:33.933

我建议为您的远程 .NET 应用程序实现一个 REST Web 服务层来与之通信。然后，您可以让处理 Web 服务请求的服务器对数据库具有本地访问权限，并且您不必担心 MySQL 协议是否能胜任这项工作。

我的经验是 MySQL 协议*可能*在 WAN 上工作，但它实际上是在本地网络上使用的，因此 WAN 的延迟会使事务处理速度慢得无法忍受。

此外，MySQL 服务器必须公开其端口（默认情况下为 3306），这并没有真正加强，因此除非您通过 VPN 或 stunnel 或其他不安全的东西连接。

MySQL 客户端/服务器协议不会以纯文本形式传输密码，它会在发送之前在客户端对密码进行哈希处理。但我知道 MySQL Connector/NET 不使用 MySQL 客户端，所以我不确定它是否在客户端对密码散列做同样的事情。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-21T14:56:20.423

1）本协议稳定，使用时间长。

2）您不应该在本地网络之外共享您的数据库，这是一个很高的安全风险。您应该在您的数据库服务器上创建一些层，您将从数据库中访问数据。您也可以在`client-side`和之间制作 WCF 服务器`db`。

# cmake - 为什么需要 CMake？

> ID：15005184
> 
> 赞同：0
> 
> 时间：2013-02-21T14:48:51.620
> 
> 标签：cmake

我正在尝试编译第三方库以在 Windows 7 上的 Visual Studio 2005 Express 中使用。

我有无穷无尽的错误消息，我暂时不会讨论。

我真正的问题是 - 如果必须编译一个 c++ 库，并且可以从该编译库编译一个 c++ 可执行文件 - 为什么需要两个编译步骤？当然，将类等的 C++ 代码作为一些 .txt 文件提供给我们自己决定编译会更容易吗？对于我的非计算机科学家教育，整个 c-make 惨败似乎是完成任何事情的不必要障碍。

还有这个业务与链接和编译。手动将所有目录设置为各种依赖项而不是依赖环境变量等不是更容易吗？由于我没有管理员权限，所有这些事情似乎又是一个不必要的负担？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-21T14:59:53.353

源代码可能是高度可移植的，但编译器和工具在不同平台上差异很大。在 Windows 上构建共享动态库的方式与在 Linux 上的方式大不相同。CMake 等提供了适应上述差异的通用工具。这不是惨败，而是解决方案。

# java - 如何解析未引用的 JSON 字符串

> ID：15005185
> 
> 赞同：14
> 
> 时间：2013-02-21T14:48:57.313
> 
> 标签：java, json

我有一个 JSON 字符串，其中既没有引用键也没有引用值，我想将其转换为格式正确的 JSON。

```
{basic:{0:{index:0, license:t, nameSID:n, image:"img_left", descriptionSID:t, category:r}} 
```

有可以处理它的Java库吗？我试过[杰克逊](http://wiki.fasterxml.com/JacksonHome)，但它不起作用。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-21T14:54:57.383

您可以`JsonParser.Feature.ALLOW_UNQUOTED_FIELD_NAMES`与 Jackson 一起使用以允许不带引号的字段名称：

```
JsonFactory factory = new JsonFactory();
factory.configure(JsonParser.Feature.ALLOW_UNQUOTED_FIELD_NAMES, true);
JsonParser jp = factory.createJsonParser(new FileInputStream("content.json")); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-01-14T16:17:49.647

不确定你是否有时间编写自己的解析器，但我做到了。

[https://github.com/ischumacher/rsjp](https://github.com/ischumacher/rsjp)

这是您的示例 JSON 的示例用法：

```
String str = "{basic:{0:{index:0, license:t, nameSID:n, image:\"img_left\", descriptionSID:t, category:r}}";
Map<String, Object> jso = Json.parseJSON(str);
System.out.println(jso);
System.out.println(Json.get(jso, "basic", "0", "image")); 
```

这是输出：

```
{
   basic: 
   {
      0: 
      {
         index: 0, 
         license: t, 
         nameSID: n, 
         image: img_left, 
         descriptionSID: t, 
         category: r
      }
   }
}

img_left 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-04-21T16:13:43.043

我研究了如何自定义 Jackson 以处理未引用的字段值（相对于字段名称）。尽管我最终写了一个 hack，但我还是在这里为其他人发布了我的面包屑路径。我的代码探索是在 Jackson 2.7.2 中完成的。

Jackson Core 带有 JsonParser 接口的两个具体实现：

*   ReaderBasedJsonParser，字符流解析器（编码无关）
*   UTF8StreamJsonParser，针对 UTF-8 字节流优化的解析器

这两个类中的代码非常多余，可能是出于必要。每个类都有一个方法，当遇到意外字符时由 nextToken() 调用。ReaderBasedJsonParser 的名称为 _handleOddValue()，UTF8StreamJsonParser 的名称为 _handleUnexpectedValue()。像接受“NaN”作为数值并允许单引号字符串值之类的事情发生在这里。

我的计划（在我意识到并意识到一个可怕的 hack 足以满足我的短期需求之前）是对这些解析器中的一个/两个进行子类化，并覆盖上面的方法来处理未引用的字符串值。因为当输入流在字段值的上下文中时调用此方法（就在识别冒号之后），所以应该可以向前读取，直到遇到逗号或右花括号并将读取到该点的所有内容计数为一个字符串值。这段代码编写起来很棘手，因为它需要了解 Jackson 的缓冲策略、解析器的架构（指向当前缓冲区的当前指针是一个实例变量）等。

要使 ObjectMapper 使用此自定义解析器，必须继承 JsonFactory 并使用实例化它的方法覆盖 _createParser() 方法。可能需要做更多工作才能使常规解析器和 UTF-8 解析器都能正常工作，但如果不考虑性能，强制使用常规解析器就足够了。然后，可以将这个自定义 JsonFactory 的实例传递给 ObjectMapper 的构造函数。

希望这可以帮助某人。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-12-06T23:01:39.447

可以使用nuget包`unquotedJson`，安装后执行如下F#代码，会得到更严重的引用json格式：

```
let x = """{
    0:{index:0, license:t, nameSID:n, image:"img:left", descriptionSID:t, category:r}
    }"""
let y = 
    x
    |> JSON.parse
    |> JSON.stringifyNormalJson 
```

是`y`：

```
{"0":{"index":0,"license":"t","nameSID":"n","image":"img:left","descriptionSID":"t","category":"r"}} 
```

# android - 倒计时计时器在android中具有特定值

> ID：15005191
> 
> 赞同：-1
> 
> 时间：2013-02-21T14:49:05.653
> 
> 标签：android

我需要一个*倒数计时器*，它会从指定的时间减少它的值。例如 `05:45:67`. 现在，当我启动计时器时，从这个值开始，它将继续减少直到达到零状态。

你能给我提供实现这一目标的合适例子吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T15:08:35.760

小时、分钟和秒基本上是千、6 万和 360 万毫秒的倍数。您可以减少毫秒数，构造 Date 对象并以您希望的方式对其进行格式化。像这样的东西：

```
@Override
public void onTick(long millisUntilFinished) {
    String time = DateFormat.format("hh:mm:ss", new Date(millisUntilFinished));
    tv.setText(time);
} 
```

# ios - 将块作为参数传递

> ID：15005197
> 
> 赞同：1
> 
> 时间：2013-02-21T14:49:27.687
> 
> 标签：ios, parameters, block, grand-central-dispatch, nsoperation

是否可以将一个完全形成的块（一个包含所有参数的块）传递给一个方法，然后在该方法中执行该块？

目前我在我的项目中重复了这个结构：

```
 if (//block exists)
        {
            if (self.returnOnMainThread)
            {
                dispatch_async(dispatch_get_main_queue(), ^
                               {
                                   //call block here
                               });
            }
            else
            {
                //call block here
            }
        } 
```

但是理想情况下，我想将上面的代码块抽象成类似于以下的方法：

```
- (void) reportSuccessWithBlock:(GenericBlockType)block{
        if (block)
        {
            if (self.returnOnMainThread)
            {
                dispatch_async(dispatch_get_main_queue(), ^
                               {
                                   block;
                               });
            }
            else
            {
                block;
            }
        }

} 
```

编辑：

块的类型不会提前知道。

所以调用路径可能看起来像这样

```
- (void) someMethod:(void (^)(NSArray *array))success
{
//Some code here setting up the array to be passed back

   [self reportSuccessWithBlock:success(array)];

} 
```

上面的代码中有一些假设（我不知道是可能的）：

1.  方法可以接受通用块类型
2.  一个块可以在其所有参数存在的情况下传递，但没有实际执行

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-21T15:31:12.500

如果您像在评论中所说的那样有两个不同的块，则可以按如下方式合并两者。但是，这很 hacky，您需要检查`object`调用块时的类。

```
- (void) reportSuccessWithBlock:(void (^) (id object, NSUInteger value)) block {

    if (!block)
        return;

    if (self.returnOnMainThread) {
        dispatch_async(dispatch_get_main_queue(), block((id)someObject, value)); // return 0 instead if there is no value
    }

    else {
        block((id) someObject, value)); // return 0 instead if there is no value
    }
} 
```

因此，当调用块时，您需要做的就是检查类并对返回的对象执行任何操作：

```
- (void) someMethod {

    [self reportSuccessWithBlock:^(id object, NSUInteger value) {

        if ([object isKindOfClass:[NSArray class]]) {

            // returned an NSArray and `value` is 0 (unset)

        }

        else if ([object isKindOfClass:[NSDictionary class]]) {

            // returned an NSDictionary and the `value` is not 0 (unset)

        }

        else {

            // something has gone wrong somewhere!

        }

    }];

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-21T15:47:30.940

好的，我认为使用`NSArray`参数的想法会奏效，因此您可以为您的块提供相同的签名：

```
typedef void ^(MYBLOCK)(NSArray *args); 
```

并将您的方法实现为：

```
- (void)reportSuccessWithBlock:(GenericBlockType)block
                  andArguments:(NSArray *)args
{
    if (block != nil)
    {
       if (self.returnOnMainThread)
       {
            dispatch_async(dispatch_get_main_queue(), ^{
                block(args);
            });
       }
       else
       {
           block(args);
       }
    }
} 
```

然后它只是确保以正确的顺序将正确类型的参数提供给块的情况（听起来微不足道，但如果你弄错了会导致各种仇恨）。

```
MYBLOCK block1 = ^(NSArray *args) {
    // I accept NSNumber, NSString, NSValue
    NSAssert(args.count == 3, @"Invalid argument count");
    NSNumber *arg1 = args[0];
    NSString *arg2 = args[1];
    NSValue *arg3 = args[2];

    // Do my thing
}; 
```

并称它为：

```
[someClass reportSuccessWithBlock:block1
                     andArguments:@[ @(1), @"Hello", @(cgpoint) ]]; 
```

# scala - 在 Scala 2.10 中使用 ClassTag/TypeTag 而不是 ClassManifest

> ID：15005200
> 
> 赞同：2
> 
> 时间：2013-02-21T14:49:41.927
> 
> 标签：scala, scala-2.10

我有一些代码来实例化这样的随机类：

```
trait T
class A extends T
class B extends T
class C extends T

def createRandomT = {
    val choices = Vector(classOf[A], classOf[B], classOf[C])
    val cls = new scala.util.Random().shuffle(choices).head
    instantiateT(cls)
}                                   

def instantiateT(cls: Class[_ <: T]) = {
    ClassManifest.fromClass(cls) match {
        case c if c <:< classManifest[A] => new A
        case c if c <:< classManifest[B] => new B
        case c if c <:< classManifest[C] => new C
    }
} 
```

这可行，但在升级到 2.10 后`instantiateT`会给出各种弃用警告。

任何提示如何使用`ClassTag`和/或复制功能`TypeTag`？

**编辑：**正如丹尼尔所指出的，这有效：

```
 cls match {
        case c if c.isAssignableFrom(classOf[A]) => new A
        case c if c.isAssignableFrom(classOf[B]) => new B
        case c if c.isAssignableFrom(classOf[C]) => new C
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-21T15:06:27.680

如果你有一个`Class`，你应该只使用`isAssignableFrom`.

```
case c if cls.isAssignableFrom(c.getClass()) => new A 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-21T15:16:24.480

我不知道为什么它必须如此复杂......当然，如果你已经有一个`Class`实例，你可以调用`Class.newInstance`？像这样：

```
def instantiateT(cls: Class[_ <: T]) = cls.newInstance 
```

或者，也许您正在执行匹配，因为在您的真实代码中，每个类都有一个单独的（默认）参数列表来传递给构造函数？

# c# - 通过代理 Web 服务重复调用 Web 服务 - 性能

> ID：15005204
> 
> 赞同：0
> 
> 时间：2013-02-21T14:49:56.250
> 
> 标签：c#, .net, web-services

这是我的场景，我有一个夜间批处理作业，将记录插入到第 3 方系统/数据库中。所有这些导入调用都通过我创建的代理服务进行路由，主要是因为我的夜间批处理作业由于防火墙而没有直接连接到第 3 方服务。

因此，我在每次作业运行时导入 10000 条记录。我建立了与代理服务的连接，其中代理服务建立了与第 3 方 Web 服务的静态引用/连接。现在（别笑），我在代理服务中为每个记录建立连接。这意味着，我的代理服务中有 10000 个“OpenConnection”和“CloseConnection”方法调用来完成这 1 个作业的运行。我每天两次运行这项工作。

我的问题是，如果我在第一次 Web 服务调用时建立连接，但在第一次调用时不关闭连接，后续 Web 服务调用是否会重新使用现有连接（因为它是静态的）？或者它会使用 3rd 方服务重新创建另一个会话？

如果这确实有效（为后续调用保持连接打开），我如何在我的工作完成后关闭连接，以便我可以释放我的托管（或非托管）资源？我不想在我自己的 Web 服务中添加一个名为“CloseConnection”的方法......

除此之外，我们的服务器每晚都会自动进行 IIS 重置，如果那时连接仍然打开，它会正确处理我的连接吗？

抱歉，这里有很多问题，只是在寻找一种“最佳实践”方法来完成我加快这一过程的任务。

我将尝试给出一个代码示例，这是批处理作业代码：

```
ws.EstablishConnection();

for (int counter = 0; counter < 10000; counter++)
{
   ws.ImportRecord(myRecords[counter]);
}

ws.Dispose(); 
```

网络服务代码：

```
[WebMethod]
public static void ImportRecord(MyRecord myRecord)
{
   try
   {
      OpenConnection();
      _3rdPartyWS.ImportRecord(myRecord);
   }
   catch (Exception)
   {
      throw;
   }
   finally
   {
      CloseConnection();
   }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T16:20:40.120

> 我的问题是，如果我在第一次 Web 服务调用时建立连接，但在第一次调用时不关闭连接，后续 Web 服务调用是否会重新使用现有连接（因为它是静态的）？

如果它是静态的，将使用相同的对象。但是你不会获得太多的速度。请注意，因为“打开”连接可能会超时。

> 或者它会使用 3rd 方服务重新创建另一个会话？

Web 服务是“无会话”的，每个调用都将在它自己的会话中。

> 如果这确实有效（为后续调用保持连接打开），我如何在我的工作完成后关闭连接，以便我可以释放我的托管（或非托管）资源？我不想在我自己的 Web 服务中添加一个名为“CloseConnection”的方法......

您的连接对象是静态的......如果不明确调用“closeConnection.

> 除此之外，我们的服务器每晚都会自动进行 IIS 重置，如果那时连接仍然打开，它会正确处理我的连接吗？

“池空闲”超时可能会在每晚基本 IISReset 之前过去。垃圾收集器将处理您使用的所有内存。第 3 方可能永远不会收到 close() 请求，但它肯定会在一段时间后关闭连接。

在您的情况下，您可以做的最好的事情是实现一个接收 MyRecord 数组的 Web 服务方法。你会在那里节省很多时间。

```
[WebMethod]
public static void ImportRecord(MyRecord[] myRecords)
{
   try
   {
      OpenConnection();
      for (int counter = 0; counter < myRecords.Length; counter++)
      {
         3rdPartyWS.ImportRecord(myRecords[counter]);
      }
   }
   finally
   {
      CloseConnection();
   }
} 
```

更好的情况是，如果可能的话，请您的第 3 方实现一个接收对象或文件数组的 Web 方法。

Web 服务循环非常慢，您永远不应该这样做。

# windows-8 - 从图像创建字节数组

> ID：15005212
> 
> 赞同：0
> 
> 时间：2013-02-21T14:50:14.953
> 
> 标签：windows-8, windows-runtime, winrt-xaml

从图像创建字节数组的最佳方法是什么？我见过很多方法，但在 WinRT 中没有一个有效。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-21T15:38:36.203

这是一种方法 [http://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.xaml.media.imaging.writeablebitmap.aspx](http://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.xaml.media.imaging.writeablebitmap.aspx)

或者，如果您将图像保存在 FS 上，只需创建一个 StorageFile 并使用流获取 byte[]

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-12T10:26:45.100

```
static class ByteArrayConverter
    {
        public static async Task<byte[]> ToByteArrayAsync(StorageFile file)
        {
            using (IRandomAccessStream stream = await file.OpenReadAsync())
            {
                using (DataReader reader = new DataReader(stream.GetInputStreamAt(0)))
                {
                    await reader.LoadAsync((uint)stream.Size);
                    byte[] Bytes = new byte[stream.Size];
                    reader.ReadBytes(Bytes);
                    return Bytes;
                }
            }
        }
    } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-22T04:41:17.973

神奇之处在于[DataReader 类](http://msdn.microsoft.com/en-us/library/windows/apps/windows.storage.streams.datareader.aspx)。例如 ...

```
var file = await Windows.Storage.StorageFile.GetFileFromApplicationUriAsync(new Uri("ms-appx:///Assets/Logo.png"));
var buf = await FileIO.ReadBufferAsync(file);
var bytes = new byte[buf.Length];
var dr = DataReader.FromBuffer(buf);
dr.ReadBytes(bytes); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-22T16:09:25.020

我使用了[Charles Petzold](http://www.charlespetzold.com/blog/2012/08/WriteableBitmap-Pixel-Arrays-in-CSharp-and-CPlusPlus.html)的方法：

```
 byte[] srcPixels;
        Uri uri = new Uri("http://www.skrenta.com/images/stackoverflow.jpg");
        RandomAccessStreamReference streamRef = RandomAccessStreamReference.CreateFromUri(uri);

        using (IRandomAccessStreamWithContentType fileStream = await streamRef.OpenReadAsync())
        {
            BitmapDecoder decoder = await BitmapDecoder.CreateAsync(fileStream);
            BitmapFrame frame = await decoder.GetFrameAsync(0);

            PixelDataProvider pixelProvider = await frame.GetPixelDataAsync();
            srcPixels = pixelProvider.DetachPixelData();

        } 
```

# geckofx - geckofx 按钮单击

> ID：15005216
> 
> 赞同：3
> 
> 时间：2013-02-21T14:50:17.620
> 
> 标签：geckofx

我已将 Skybound geckkofx 集成到我的应用程序中。我可以填写文本框

```
GeckoElement username = null; 
username = checkDoc.GetElementById("ctl00_contentPlaceHolder_txtUserName");
username.SetAttribute("value", "myemail@gmail.com"); 
```

但我无法点击按钮

```
GeckoElement button1 = null;
button1 = checkDoc.GetElementById("ctl00_contentPlaceHolder_lbtnLogin");
button.click() // there is no function by the name on click on the button 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-09-07T09:47:56.793

检查您是否有 GeckoInputElement 类。如果没有，那么您可能需要 Skybount.Com 库。或者您可以使用最新版本的壁虎 fx。将 GeckoFX 21 与 xulrunner 21 一起使用。您可以从 ftp.mozila.org 获得

在 geckofx 21 你可以试试这个代码

```
GeckoButtonElement button = new GeckoButtonElement(_webBrowser.Document.getElementById("your_button_id").DomObject);
button.Click(); 
```

很简单！

您也可以使用 GeckoInputElement 将您的电子邮件地址输入到 html 元素中，如下所示

```
GeckoInputElement username = new GeckoInputElement(checkDoc.GetElementById("ctl00_contentPlaceHolder_txtUserName");
.DomObject);
username.Value = "myemail@gmail.com" 
```

嗬嗬！（结束）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-09-02T12:06:30.510

我已经完成了这种方式

```
 Gecko.GeckoHtmlElement Btn = (Gecko.GeckoHtmlElement)browse.DomDocument.GetElementById("btnPrint");               
 Btn.Click(); 
```

//browse =`Gecko`浏览器控件的名称

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-14T07:42:03.073

你试过这样的事情吗？

```
function performClick(buttonElement)
{
    var evt = document.createEvent("MouseEvents");
    evt.initEvent("click", true, true);
    buttonElement.dispatchEvent(evt);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-10-06T18:41:26.253

```
'geckowebbrowser for any element click function
Dim element = geckoWebBrowser1.Document.GetElementById("someid")
Dim Clickelement As GeckoHtmlElement = CType(element,GeckoHtmlElement)
Clickelement.Click()
```

# jquery - jquery .on 与 twitter 引导单选按钮

> ID：15005218
> 
> 赞同：0
> 
> 时间：2013-02-21T14:50:27.903
> 
> 标签：jquery, twitter-bootstrap

我正在使用一个函数来为 touchstart 设置一个 jQuery .on 并为各种控件设置单击事件，以便在单击它们时执行一些额外的 UI 操作。这消除了触摸设备上的 300 毫秒延迟，还防止了重影点击（在 touchend 和 onclick 上注册了点击）。

```
function touchClick(att, sel, fnc) {
    $(att).on('touchstart click', sel, function(event){
        event.stopPropagation();
        event.preventDefault();
        if (event.handled !== true) {   
            fnc(this, event);
            event.handled = true;
        } else {
            return false;
        }
    });
} 
```

我通过此功能发送的控件之一是 twitter 引导单选按钮。当我单击它时，会调用 fnc()，但单选按钮不会更新以显示哪个单选按钮处于活动状态。我怎样才能把它连接起来，以便更新单选按钮以反映用户点击（虽然只有一次，没有幽灵更新请）。

**编辑：**或者简单地说，我如何调用引导程序的“更新单选按钮”功能？

# css - 如何为子 DIV 元素设置边距...是否有解决此问题的 CSS 方法？

> ID：15005219
> 
> 赞同：0
> 
> 时间：2013-02-21T14:50:29.413
> 
> 标签：css, html, margin

所以在我的网站[www.buildinghunter.com](http://www.buildinghunter.com)上工作。在我们的主页上，页面左下方有 4-div 元素。

我正在尝试将中间的两个 div（`id=text-9`和`id=text-10`）与左侧的两个（`id=delivered`和）对齐`id=savehours`。

当我将这些 ID 添加到我的 CSS 页面时，我添加到 ID 的边距会被 DIV 进一步忽略。

所以我的问题是：如何为这些 ID 添加边距并使用它？如果我进一步修改 DIV 上的 CSS，我可能会更改整个站点的元素。

感谢您的任何见解，如果术语不正确，我也很抱歉。不确定我遇到的问题是否被认为是父/子 div 问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T14:55:42.267

据我所知，你不能在那里应用边距的原因是因为你在 style.css 第 1131 行声明了`margin: 0 !important`. 您也可以通过在此处将更改声明为 !important 来覆盖它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T15:00:18.750

当我查看当前标记时， id=text-9 和 id=text-10 都是`<li>`嵌套在`<div id="homemid">`没有周围`<ul>`元素的元素下。当我用`<li>`适当的标签包装这两个元素时，`<ul>`这纠正了对齐问题（在 Chrome 和 Firefox 中），而无需调整任何边距样式。

# c# - 如何编写c#查询以查找mongodb中的最大值和最小值

> ID：15005222
> 
> 赞同：-4
> 
> 时间：2013-02-21T14:50:50.263
> 
> 标签：c#, mongodb

如何在 C# 中编写以下查询以查找最大值和最小值

```
db.col.find().sort({val: 1}).limit(1); //min
db.col.find().sort({val: -1}).limit(1); //max 
```

这是我尝试过的查询

```
var cursor = collection.FindAs<BsonDocument> 
    (Query.Null).SetSortOrder(SortBy.Descending("_id"‌​)).SetLimit(1)
    .SetFields(Fields.Exclude("_id")); 
```

请帮我继续。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T15:30:50.220

您可以通过以下方式找到 min 和 max 文档：

```
var min = collection.FindAll().SetSortOrder(SortBy.Ascending("val")).SetLimit(1).FirstOrDefault();
var max = collection.FindAll().SetSortOrder(SortBy.Descending("val")).SetLimit(1).FirstOrDefault(); 
```

假设您的集合是 MongoCollection<T> 类型，那么您的 min 和 max 变量是 <T> 类型的文档。

这是内部发生的事情：

1.  FindAll 返回一个 MongoCursor<T>
2.  SetSortOrder 通过设置排序顺序来修改游标
3.  SetLimit 通过设置限制来修改光标
4.  FirstOrDefault（一种标准的 .NET LINQ 方法）枚举游标并返回唯一的文档

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-06-13T20:47:32.783

```
var sort =  Builders<BsonDocument>.Sort.Descending("columnName"); //build sort object   
var result = db.Find().Sort(sort).FirstOrDefault(); //apply it to collection 
```

# css - 没有水平滚动条的大主体宽度

> ID：15005225
> 
> 赞同：0
> 
> 时间：2013-02-21T14:50:57.567
> 
> 标签：css

我将正文宽度设置为 1920px 并设置相同宽度的背景图像。该图像用于标题。因为我的身体内部有更窄的包装，如果我将标题背景放在标题本身，标题背景的宽度会被包装的边框切割。所以我把它放在正文中，但现在我在底部有水平滚动条，页面的中心向右移动。我怎样才能摆脱那个滚动条并使页面居中？这是代码：

```
body {
    background-color: #f6f6f6;
    background-image: url('../img/menu-background.png');
    width: 1920px;
    background-repeat: no-repeat;
    font-family: 'PT Sans';
}

.wrapper {
    width: 950px;
    min-height: 1658px;
    border: 1px solid grey;
    margin: 0 auto;
}

header a {
    text-decoration: none;
    text-align: center;
    display: block;
    width: 365px;
    margin-left: auto;
    margin-right: auto;
} 
```

和 HTML：

```
<body>
    <div class="wrapper">
        <header>
            <a href="#">
                <h1>Lorem ipsum</h1>
                <span>bla-bla-bla</span>
            </a>
        </header> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-21T14:53:29.600

您不需要将 body 上的宽度指定为 1920px。

具有较大分辨率屏幕的用户无论如何都会看到整个背景图像。

我建议将您的背景图像标签设置在这样的一行上：

```
body {
    background: #f6f6f6 url('../img/menu-background.png') no-repeat center 0;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-21T14:57:37.287

`overflow-x:hidden;`您可以通过添加到您的身体来防止滚动条

# google-maps - 如何检查是否启用了街景？

> ID：15005232
> 
> 赞同：-2
> 
> 时间：2013-02-21T14:51:44.897
> 
> 标签：google-maps, google-maps-api-3, google-street-view

我想在谷歌地图上放置一个标记，但只有在街景处于活动状态时。如果显示“正常”地图，则标记不应该是可见的。

有谁知道如何检查谷歌地图上的街景是否处于活动状态？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T16:21:20.323

刚读`map.getStreetView().getVisible();`

```
var svpIsVisible = map.getStreetView().getVisible();
 if (svpIsVisible){
   // visible -do something
 }
 else (
   //Not visible - do something else
 ) 
```

# c# - 使用 URL 参数中的值更新 ASP:Parameter

> ID：15005236
> 
> 赞同：0
> 
> 时间：2013-02-21T14:52:08.593
> 
> 标签：c#, asp.net, visual-studio

我希望能够收集 URL 参数并将其传递给 SelectParameter。

我认为这样的事情会起作用，但我将一些代码从代码隐藏到显示级别的方法可能是错误的

```
<asp:GridView ID="CountryGridView" runat="server" AutoGenerateColumns="false" CssClass="mGrid" OnRowEditing="CountryGridView_RowEditing">
                    <Columns>
                        <asp:BoundField ReadOnly="true" DataField="i_SK_Accom" HeaderText="i_SK_Accom" Visible="false" />
                        <asp:BoundField ReadOnly="true" DataField="Accom_Code" HeaderText="Accom Code" />
                        <asp:BoundField ReadOnly="true" DataField="Accom_Name" HeaderText="Accom Name" />
                        <asp:BoundField DataField="OP49_Required" HeaderText="OP49 Required?" />
                        <asp:BoundField DataField="Weekly" HeaderText="Weekly" />
                        <asp:BoundField DataField="Daily" HeaderText="Daily" />
                        <asp:CommandField ShowEditButton="true" ButtonType="Image" EditImageUrl="~/Images/Edit.gif" UpdateImageUrl="~/Images/save.png" CancelImageUrl="~/Images/cancel.png" ControlStyle-CssClass="ImageButton" />
                    </Columns>
                </asp:GridView>
                <asp:SqlDataSource ID="Get_Country" runat="server" ConnectionString="<%$ ConnectionStrings:JFAAdmin %>" SelectCommand="IFACE_JFA_ACCOM" SelectCommandType="StoredProcedure" UpdateCommand="IFACE_JFA_ACCOM" UpdateCommandType="StoredProcedure" >
                    <SelectParameters>
                        <asp:Parameter Direction="Input" Name="Statement" Type="String" DefaultValue="CountryGridSelect" />
                        <asp:Parameter Direction="Input" Name="i_FK_CountryID" Type="String" DefaultValue="Request["i_FK_CountryID"].Trim().ToString()" />
                    </SelectParameters>
                </asp:SqlDataSource> 
```

Request["i_FK_CountryID"].Trim().ToString() 是我试图捕获以作为 i_FK_CountryID 参数传递的 URL 参数

谢谢你的帮助。

马库斯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-21T14:54:53.780

您可以为此使用[QueryStringParameter ：](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.querystringparameter.aspx)

```
<asp:QueryStringParameter
     Name="i_FK_CountryID"
     Type="String"
     QueryStringField="i_FK_CountryID" /> 
```

# python - 在 Linux 上从 Python 连接到受保护的 WiFi

> ID：15005240
> 
> 赞同：11
> 
> 时间：2013-02-21T14:52:21.513
> 
> 标签：python, linux, wifi, wpa

我正在为需要连接到 WiFi AP 的 Ubuntu Linux 创建一个软件。WiFi 网络不是预定义的，并且可以在软件的单次运行期间更改多次（用户是下令更改的人）。想法是这样的：给定一组 SSID 及其 WPA 或 WEP 密码，软件应该能够随心所欲地在网络之间切换，而无需更改系统中任何位置的任何配置文件。

看起来，最大的问题是将密码传递给连接。到目前为止，这是我一直在使用的：

*   配备 WiFi 加密狗的 Ubuntu 12.10 机器。
*   Python，运行软件，将用于请求连接
*   康曼 0.79
*   wpa_supplicant v1.0
*   总线

起初我认为可以通过 d-bus 将密码传递给 connman，但是这个版本的 connman 和 1.11 似乎都没有为此公开任何方法。然后我发现可以将`service_<SSID>.conf`文件转储到`/var/lib/connman/`目录中。该文件的内容非常简单，如下所示：

```
[service_SSID]
Type=wifi
Name=Network-SSID
Passphrase=here-goes-the-passphrase 
```

创建此文件后，连接到网络需要在适当的服务中简单调用 net.connman.Service.Connect() 方法。问题是 connman 除非重新启动，否则不会解析配置文件。这需要 sudo 权限、额外的时间，并增加了所有“现在可能出错”的事情发生的风险。然后我认为密码可以以某种方式传递给 wpa_supplicant d-bus API，但我什么也没找到。

谷歌搜索也让我失望了。好像以前没有人尝试过这样做。

命令`sudo iwconfig wlan0 essid <SSID> key s:<PASSPHRASE>`导致`SET failed on device wlan0 ; Invalid argument.`错误。此外，它需要我想避免的 sudo 。

我试图弄清楚 wpa_gui 程序是如何发挥它的魔力的。首先我发现它也需要 sudo，而且它会直接发送一堆命令到`/var/run/wpa_supplicant/wlan0`. 如果我没有找到更简单的方法，复制这种行为对我来说是最后的手段。

所以，最大的问题是：如何使用 Python 连接到受 WEP/WPA 保护的 WiFi 网络？
我还想知道在这里使用 connman 是否是一种好方法，以及我是否不应该恢复到网络管理器，这是 Ubuntu 的默认设置。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-22T10:36:21.420

这显示了如何为 WPA 执行此操作。

首先，抛弃 connman 并使用 NetworkManager。下面的示例脚本显示了如何启用无线支持，检查具有给定 SSID 的网络是否可用，使用 WPA 密码连接到该 SSID，然后断开与网络的连接并禁用无线。我相当确定这个脚本可以改进，但当前版本足以作为示例：

```
#!/usr/bin/python

# This script shows how to connect to a WPA protected WiFi network
# by communicating through D-Bus to NetworkManager 0.9.
#
# Reference URLs:
# http://projects.gnome.org/NetworkManager/developers/
# http://projects.gnome.org/NetworkManager/developers/settings-spec-08.html

import dbus
import time

SEEKED_SSID = "skynet"
SEEKED_PASSPHRASE = "qwertyuiop"

if __name__ == "__main__":
    bus = dbus.SystemBus()
    # Obtain handles to manager objects.
    manager_bus_object = bus.get_object("org.freedesktop.NetworkManager",
                                        "/org/freedesktop/NetworkManager")
    manager = dbus.Interface(manager_bus_object,
                             "org.freedesktop.NetworkManager")
    manager_props = dbus.Interface(manager_bus_object,
                                   "org.freedesktop.DBus.Properties")

    # Enable Wireless. If Wireless is already enabled, this does nothing.
    was_wifi_enabled = manager_props.Get("org.freedesktop.NetworkManager",
                                         "WirelessEnabled")
    if not was_wifi_enabled:
        print "Enabling WiFi and sleeping for 10 seconds ..."
        manager_props.Set("org.freedesktop.NetworkManager", "WirelessEnabled",
                          True)
        # Give the WiFi adapter some time to scan for APs. This is absolutely
        # the wrong way to do it, and the program should listen for
        # AccessPointAdded() signals, but it will do.
        time.sleep(10)

    # Get path to the 'wlan0' device. If you're uncertain whether your WiFi
    # device is wlan0 or something else, you may utilize manager.GetDevices()
    # method to obtain a list of all devices, and then iterate over these
    # devices to check if DeviceType property equals NM_DEVICE_TYPE_WIFI (2).
    device_path = manager.GetDeviceByIpIface("wlan0")
    print "wlan0 path: ", device_path

    # Connect to the device's Wireless interface and obtain list of access
    # points.
    device = dbus.Interface(bus.get_object("org.freedesktop.NetworkManager",
                                           device_path),
                            "org.freedesktop.NetworkManager.Device.Wireless")
    accesspoints_paths_list = device.GetAccessPoints()

    # Identify our access point. We do this by comparing our desired SSID
    # to the SSID reported by the AP.
    our_ap_path = None
    for ap_path in accesspoints_paths_list:
        ap_props = dbus.Interface(
            bus.get_object("org.freedesktop.NetworkManager", ap_path),
            "org.freedesktop.DBus.Properties")
        ap_ssid = ap_props.Get("org.freedesktop.NetworkManager.AccessPoint",
                               "Ssid")
        # Returned SSID is a list of ASCII values. Let's convert it to a proper
        # string.
        str_ap_ssid = "".join(chr(i) for i in ap_ssid)
        print ap_path, ": SSID =", str_ap_ssid
        if str_ap_ssid == SEEKED_SSID:
            our_ap_path = ap_path
            break

    if not our_ap_path:
        print "AP not found :("
        exit(2)
    print "Our AP: ", our_ap_path

    # At this point we have all the data we need. Let's prepare our connection
    # parameters so that we can tell the NetworkManager what is the passphrase.
    connection_params = {
        "802-11-wireless": {
            "security": "802-11-wireless-security",
        },
        "802-11-wireless-security": {
            "key-mgmt": "wpa-psk",
            "psk": SEEKED_PASSPHRASE
        },
    }

    # Establish the connection.
    settings_path, connection_path = manager.AddAndActivateConnection(
        connection_params, device_path, our_ap_path)
    print "settings_path =", settings_path
    print "connection_path =", connection_path

    # Wait until connection is established. This may take a few seconds.
    NM_ACTIVE_CONNECTION_STATE_ACTIVATED = 2
    print """Waiting for connection to reach """ \
          """NM_ACTIVE_CONNECTION_STATE_ACTIVATED state ..."""
    connection_props = dbus.Interface(
        bus.get_object("org.freedesktop.NetworkManager", connection_path),
        "org.freedesktop.DBus.Properties")
    state = 0
    while True:
        # Loop forever until desired state is detected.
        #
        # A timeout should be implemented here, otherwise the program will
        # get stuck if connection fails.
        #
        # IF PASSWORD IS BAD, NETWORK MANAGER WILL DISPLAY A QUERY DIALOG!
        # This is something that should be avoided, but I don't know how, yet.
        #
        # Also, if connection is disconnected at this point, the Get()
        # method will raise an org.freedesktop.DBus.Error.UnknownMethod
        # exception. This should also be anticipated.
        state = connection_props.Get(
            "org.freedesktop.NetworkManager.Connection.Active", "State")
        if state == NM_ACTIVE_CONNECTION_STATE_ACTIVATED:
            break
        time.sleep(0.001)
    print "Connection established!"

    #
    # Connection is established. Do whatever is necessary.
    # ...
    #
    print "Sleeping for 5 seconds ..."
    time.sleep(5)
    print "Disconnecting ..."

    # Clean up: disconnect and delete connection settings. If program crashes
    # before this point is reached then connection settings will be stored
    # forever.
    # Some pre-init cleanup feature should be devised to deal with this problem,
    # but this is an issue for another topic.
    manager.DeactivateConnection(connection_path)
    settings = dbus.Interface(
        bus.get_object("org.freedesktop.NetworkManager", settings_path),
        "org.freedesktop.NetworkManager.Settings.Connection")
    settings.Delete()

    # Disable Wireless (optional step)
    if not was_wifi_enabled:
        manager_props.Set("org.freedesktop.NetworkManager", "WirelessEnabled",
                          False)
    print "DONE!"
    exit(0) 
```

# php - PHP时间戳转换为日期不起作用

> ID：15005243
> 
> 赞同：1
> 
> 时间：2013-02-21T14:52:32.300
> 
> 标签：php, date, timestamp

谁能解释一下这些时间戳的这种奇怪行为？有一个应用程序可以将时间戳转换为日期，如下所示：

```
1184947071570 - 07-20-2007 11:57
```

```
1190394533377 - 09-21-2007 13:08
```

我无法访问该应用程序的源代码。但是我从数据库中获取了时间戳，当我使用 php 转换为日期时，会发生以下情况：

```
1184947071570 - 1955 年 4 月 20 日 13:17:54
```

```
1190394533377 - 1991 年 10 月 27 日 14:39:45
```

我在php中使用了这段代码：

```
date("l, j F Y H:i:s", $timestamp) 
```

日期完全不同！我怎样才能得到正确的日期？

谢谢你。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-21T14:59:53.747

您拥有的时间戳包括毫秒。如果您将时间戳除以 1000，您将得到正确的时间。

```
echo date('l, j F Y H:i:s', 1184947071570 / 1000); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-21T14:59:26.540

它们不像 UNIX 时间戳那样是秒。

它们以毫秒为单位除以 1000 并重试

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-21T15:00:08.930

我刚刚做了一些测试，你的数据库时间戳有一些额外的字符。

时间戳`07-20-2007 11:57`为`1184947020`

# c# - 通过方法调用将自定义对象传递给 DLL

> ID：15005248
> 
> 赞同：0
> 
> 时间：2013-02-21T14:52:36.650
> 
> 标签：c#, methods, namespaces

所以我有一个命名空间：

```
namespace Main
{
  Class DoStuff
  {
    Code...

    var tableVars = new Dictionary<string, tableObject>();

    Code...

    string insertResponse = MyDLL.Insert(someString, tableVars, someString);

    Code../

  }
  public class tableObject
  {
    public string Name { get; set; }
    public string Type { get; set; }
    public string Value { get; set; }
    public string Default { get; set; }
  }
} 
```

我有第二个命名空间：

```
namespace MyDLL
{
  public static string Insert(string table, Dictionary<string, tableObject> tableVars, string connection)
  {
    Code...
  }
} 
```

在我的第一个命名空间 Main 中，我引用了第二个命名空间 MyDLL。如何在不引用我的 Main 命名空间的情况下让 DLL 识别我的自定义对象（因为这会导致循环引用）？

我也尝试使用 var 关键字，但在这种情况下不起作用：

```
namespace MyDLL
    {
      public static string Insert(string table, var tableVars, string connection)
      {
        Code...
      }
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-21T14:55:15.197

将所有常见类型（在本例中为 tableObject）移动到第三个 dll 并从两个更高的程序集中引用他

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-21T15:18:26.243

我昨天在阅读 .NET 4.0 中引入的 ExpandoObject，使用这种对象类型，您可以在运行时动态创建对象并将对象传递到另一个命名空间。

这不是一个完美的解决方案，因为可能存在性能问题（我无法相信 Expando 对象与静态对象一样快）。也没有编译（或运行）时检查以确保添加了所有字段。

Dynamic/ExpandoObject 还支持向对象添加方法。

但是，这里有一些示例源：

```
 void Method1()
    {

        var tableVars = new Dictionary<string, dynamic>();

        dynamic sampleObject = new ExpandoObject();
        sampleObject.Name = "Count";
        sampleObject.Type = "Int32";
        sampleObject.Value = "4";
        sampleObject.Default = "0";

        tableVars.Add("Sample", sampleObject);

        Insert("TableName", tableVars, "Connection");

    }

    string Insert(string table, Dictionary<string, dynamic> tableVars, string connection)
    {

        foreach (var v in tableVars)
        {
            Console.Write("Name is: ");

            Console.WriteLine(v.Value.Name);

        }

        return "";
    } 
```

根据您的情况，按照@Benny 在他的回答中指出的那样做可能会更好，但我想介绍 DLR 的元素作为一个选项

# c# - 升级到 EL 5 'Microsoft.Practices.EnterpriseLibrary.Caching ..或其依赖项之一时出错

> ID：15005250
> 
> 赞同：5
> 
> 时间：2013-02-21T14:52:40.200
> 
> 标签：c#, asp.net, .net, visual-studio-2010, enterprise-library

我试图将我的企业库从 4.0.0.0 升级到 5.0.5.0

我知道安全的方法是使用 NuGet。

我使用它，但得到这个错误：

> 创建缓存配置的配置节处理程序时出错：无法加载文件或程序集“Microsoft.Practices.EnterpriseLibrary.Caching，版本=5.0.505.0，Culture=neutral，PublicKeyToken=null”或其依赖项之一。找到的程序集的清单定义与程序集引用不匹配。（来自 HRESULT 的异常：0x80131040）

```
Configuration Error

Description: An error occurred during the processing of a configuration file required to service this request. Please review the specific error details below and modify your configuration file appropriately. 

Parser Error Message: An error occurred creating the configuration section handler for cachingConfiguration: Could not load file or assembly 'Microsoft.Practices.EnterpriseLibrary.Caching, Version=5.0.505.0, Culture=neutral, PublicKeyToken=null' or one of its dependencies. The located assembly's manifest definition does not match the assembly reference. (Exception from HRESULT: 0x80131040)

Source Error: 

Line 8:      <section name="entityFramework" type="System.Data.Entity.Internal.ConfigFile.EntityFrameworkSection, EntityFramework, Version=4.4.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" requirePermission="false" />
Line 9:      <section name="dataConfiguration" type="Microsoft.Practices.EnterpriseLibrary.Data.Configuration.DatabaseSettings, Microsoft.Practices.EnterpriseLibrary.Data, Version=5.0.505.0, Culture=neutral, PublicKeyToken=null" />
Line 10:     <section name="cachingConfiguration" type="Microsoft.Practices.EnterpriseLibrary.Caching.Configuration.CacheManagerSettings, Microsoft.Practices.EnterpriseLibrary.Caching, Version=5.0.505.0, Culture=neutral, PublicKeyToken=null" />
Line 11:     <section name="instrumentationConfiguration" type="Microsoft.Practices.EnterpriseLibrary.Common.Instrumentation.Configuration.InstrumentationConfigurationSection, Microsoft.Practices.EnterpriseLibrary.Common, Version=5.0.505.0, Culture=neutral, PublicKeyToken=null" />
Line 12:     <section name="log4net" type="log4net.Config.Log4NetConfigurationSectionHandler,log4net" />

Source File: D:\MaM\Server\ClientServices\Dev\ClientService 1.5\Conduit.Mam.ClientService.Service\web.config    Line: 10 

Assembly Load Trace: The following information can be helpful to determine why the assembly 'Microsoft.Practices.EnterpriseLibrary.Caching, Version=5.0.505.0, Culture=neutral, PublicKeyToken=null' could not be loaded.

=== Pre-bind state information ===
LOG: User = CONDUIT-IL\elad.bendavid
LOG: DisplayName = Microsoft.Practices.EnterpriseLibrary.Caching, Version=5.0.505.0, Culture=neutral, PublicKeyToken=null
 (Fully-specified)
LOG: Appbase = file:///D:/MaM/Server/ClientServices/Dev/ClientService 1.5/Conduit.Mam.ClientService.Service/
LOG: Initial PrivatePath = D:\MaM\Server\ClientServices\Dev\ClientService 1.5\Conduit.Mam.ClientService.Service\bin
Calling assembly : (Unknown).
===
LOG: This bind starts in default load context.
LOG: Using application configuration file: D:\MaM\Server\ClientServices\Dev\ClientService 1.5\Conduit.Mam.ClientService.Service\web.config
LOG: Using host configuration file: 
LOG: Using machine configuration file from C:\Windows\Microsoft.NET\Framework\v4.0.30319\config\machine.config.
LOG: Policy not being applied to reference at this time (private, custom, partial, or location-based assembly bind).
LOG: Attempting download of new URL file:///C:/Windows/Microsoft.NET/Framework/v4.0.30319/Temporary ASP.NET Files/root/fb9f9038/ea6afb52/Microsoft.Practices.EnterpriseLibrary.Caching.DLL.
LOG: Attempting download of new URL file:///C:/Windows/Microsoft.NET/Framework/v4.0.30319/Temporary ASP.NET Files/root/fb9f9038/ea6afb52/Microsoft.Practices.EnterpriseLibrary.Caching/Microsoft.Practices.EnterpriseLibrary.Caching.DLL.
LOG: Attempting download of new URL file:///D:/MaM/Server/ClientServices/Dev/ClientService 1.5/Conduit.Mam.ClientService.Service/bin/Microsoft.Practices.EnterpriseLibrary.Caching.DLL.
WRN: Comparing the assembly name resulted in the mismatch: PUBLIC KEY TOKEN
ERR: Failed to complete setup of assembly (hr = 0x80131040). Probing terminated. 
```

我的 web.config：

我试图用 NuGet 看看，什么 dll 依赖于什么 dll。

我验证并且所有具有正确版本的 dll 都被引用（由 NuGet 安装）

我尝试了 DependenciesWallker，但不明白缺少什么。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-27T00:41:39.293

您需要使用签署程序集的实际公钥。只是把 NULL 会给你一个不匹配和加载失败。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-18T13:00:47.793

我也遇到了这个异常。原来 web.config 中的 configSections 部分引用了 4.0 框架。将部分更改为此为我解决了它：

```
<configuration>
  <configSections>
    <section name="entityFramework" type="System.Data.Entity.Internal.ConfigFile.EntityFrameworkSection, EntityFramework, Version=5.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" requirePermission="false" /> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-26T14:09:38.473

请再次将 ADO.NET 实体模型文件添加到项目中。不要删除现有的。您只需在项目中再创建一个 .edmx 文件。它会将新的 5.0 版本 DLL 文件引用到项目中，并将代码也添加到配置文件中。添加文件后，您可以从项目中删除该文件。它仅用于将新创建的引用添加到项目中。试试这个它会工作....

# ruby-on-rails - 在 Ruby 中对 Redis 数据集进行分页

> ID：15005255
> 
> 赞同：2
> 
> 时间：2013-02-21T14:52:46.700
> 
> 标签：ruby-on-rails, ruby, redis

当您的数据由 ActiveRecord 建模时，您可以使用多种工具对数据进行分页，因此您不必在任何给定时间将 1,000,000 个对象加载到应用服务器上的内存中。当您拥有像 redis 集、排序集、列表这样的大型数据集时……是否有任何工具也可以帮助对这些数据进行分页？我理解对于集合之类的东西，这可能不起作用，因为没有确定的方式来增量检索数据。但是，如果您正在处理排序集或列表，这不应该是我想像的问题。有哪些工具可以在 Ruby 中处理对 redis 数据集进行分页？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T22:54:17.887

我创建了一个名为[redis_pagination](https://github.com/czarneckid/redis_pagination)的 Ruby gem来为 Redis 排序集和列表执行此操作。

# ckeditor - Ckeditor 和特殊字符

> ID：15005256
> 
> 赞同：0
> 
> 时间：2013-02-21T14:52:50.237
> 
> 标签：ckeditor

尝试将 1/8 添加到 CKEditor 上的特殊字符形式。

我在 en.js 文件中添加了“frac18:'VULGAR FRACTION ONE EIGHTH'”，但它没有显示在表单中。

还有什么我需要更新的吗？

谢谢

布雷特

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T08:31:50.627

是的。你必须将你的角色添加到[editor.config.specialChars](http://docs.ckeditor.com/#!/api/CKEDITOR.config-cfg-specialChars)。

# jquery - 如何在日期选择器中更改默认突出显示的“今天”日期

> ID：15005263
> 
> 赞同：4
> 
> 时间：2013-02-21T14:53:08.227
> 
> 标签：jquery, datepicker

我正在使用 datepicker 在两个日期字段（从日期和到日期）中选择日期。

其中，默认突出显示的日期是今天的日期。我需要在第二个日期选择器中将默认突出显示的日期更改为其他日期。（例如今天 + 8 天）。

我怎样才能正确地做到这一点？

以下是我的日期选择器，

```
$(function() {
$( "#datepicker" ).datepicker();
$( "#datepicker" ).datepicker("option", "dateFormat", "yy-mm-dd"); // ISO 8601
$( "#datepicker2" ).datepicker();
$( "#datepicker2" ).datepicker("option", "dateFormat", "yy-mm-dd");
}); 
```

谢谢。

- - - - - - - - - - - - - - - - - 更新 - - - - - - - - --------------------------------

在迈克尔的屏幕截图之后，

![后两天日历（今天+2天）](../Images/0b4388d134f86466001cda4a5e4cfa62.png)

我把以下，

```
$( "#datepicker2" ).datepicker("option", "defaultDate", +2); 
```

您仍然可以看到第 21 天（今天）是突出显示，并且 23 与黑线接壤。我需要看到 23 看起来像 21 与高照明。无需强调 21。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-21T14:56:29.557

```
 $( "#datepicker" ).datepicker("option", "defaultDate", +8); 
```

来源：[http ://api.jqueryui.com/datepicker/#option-defaultDate](http://api.jqueryui.com/datepicker/#option-defaultDate)

编辑：当前日期将始终作为日期选择器的一部分突出显示。没有关闭此功能的选项。就是要让用户明白什么是“今天”。但是，您可以使用一些 CSS 覆盖它的图形外观：

```
 .ui-datepicker-today a.ui-state-highlight {
        border-color: #d3d3d3;
        background: #e6e6e6 url(/themeroller/images/ui-bg_glass_75_e6e6e6_1x400.png) 50% 50% repeat-x;;
        color: #555555;    
    }
   .ui-datepicker-today.ui-datepicker-current-day a.ui-state-highlight {
        border-color: #aaaaaa;
        background: #ffffff url(images/ui-bg_glass_65_ffffff_1x400.png) 50% 50% repeat-x;
        color: #212121;
    } 
```

工作 jsfiddle：http: [//jsfiddle.net/EpWud/](http://jsfiddle.net/EpWud/)

这假设您使用的是默认主题 - 但您可以对任何主题执行相同的做法。只需像上面的代码一样覆盖样式。然而，这个 CSS 是不完整的。您需要对其他情况进行覆盖，例如 :hover 状态。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-04-28T01:05:43.157

[对jQuery UI DatePicker](https://stackoverflow.com/questions/24666321/)中选定答案的小调整更改突出显示“今天”日期

```
// Get users 'today' date
var localToday = new Date();
localToday.setDate(tomorrow.getDate()+1); // tomorrow

// Pass the today date to datepicker
$( "#datepicker" ).datepicker({
    showButtonPanel: true,
    localToday: localToday    // This option determines the highlighted today date
}); 
```

我已经覆盖了 2 个 datepicker 方法，以便有条件地为“今天”日期使用新设置，而不是`new Date()`. 新设置称为`localToday`。

覆盖`$.datepicker._gotoToday`并`$.datepicker._generateHTML`像这样：

```
$.datepicker._gotoToday = function(id) {
    /* ... */
    var date = inst.settings.localToday || new Date()
    /* ... */
}

$.datepicker._generateHTML = function(inst) {
    /* ... */
    tempDate = inst.settings.localToday || new Date()
    /* ... */
} 
```

这是一个[**演示**](http://jsfiddle.net/NAzz7/5/)，显示了完整的代码和用法：http: **[//jsfiddle.net/NAzz7/5/](http://jsfiddle.net/NAzz7/5/)**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-05-25T18:55:17.000

我对 UI Core 如何显示带有脆弱边框的 defaultDate 和所有内容不满意。经过多次试验和错误，我在第二个日期选择器中添加了一个焦点方法并使用了 setDate 方法。

```
$('#datepicker2').datepicker().focus(function(){
   $(this).datepicker('setDate',+2);
}); 
```

这将为您提供具有基于主题的背景颜色的选定日期，并且当日期选择器打开时，今天也将保留其背景。唯一的缺点是，如果您最终没有从日期选择器中选择日期，则必须返回并清除输入字段。

看起来有点像散列，因为我通常不喜欢使用焦点方法，但我坚持使用它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-10-19T12:25:21.087

使用 onSelect 选项。它应该看起来像这样：

```
$('#datepickerID').datepicker({
                    onSelect: function(dateText, inst) {
                        $('#ui-datepicker-div').addClass("calendar-piced");
                    },
                    showButtonPanel: true,
                    gotoCurrent: true
                });
```

```
#datepickerID{
    &.calendar-piced{
        .ui-datepicker-today{
            a{
                background: #f6f6f6;
                border: 1px solid #c5c5c5;
                color: #454545;
            }
        }
    }
}
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-06-12T14:01:20.507

另一个突出显示的解决方案`defaultDate`是覆盖对应于所选的 CSS 类`defaultDate`：

```
.ui-datepicker td.ui-datepicker-days-cell-over a {
    background: #7ca600;
} 
```

演示 jsfiddle： http: [//jsfiddle.net/0vjadze4/](http://jsfiddle.net/0vjadze4/)（突出显示`today` **和** `defaultDate`）

当然，您可以将其与[Mickael 提供的答案](https://stackoverflow.com/a/15005329/1660354)结合起来，仅突出显示`defaultDate`：`

```
.ui-datepicker td.ui-datepicker-days-cell-over a {
    background: #7ca600;
}
.ui-datepicker-today a.ui-state-highlight {
    border-color: #d3d3d3;
    background: #e6e6e6 url(/themeroller/images/ui-bg_glass_75_e6e6e6_1x400.png) 50% 50% repeat-x;;
    color: #555555;    
}
.ui-datepicker-today.ui-datepicker-current-day a.ui-state-highlight {
    border-color: #aaaaaa;
    background: #ffffff url(images/ui-bg_glass_65_ffffff_1x400.png) 50% 50% repeat-x;
    color: #212121;
} 
```

演示 jsfiddle： http: [//jsfiddle.net/43svpe80/1/](http://jsfiddle.net/43svpe80/1/)（仅突出显示`defaultDate`）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-06-26T20:59:30.993

这可以通过更改 jquery-ui.js 中 _generateHTML 下的变量来实现

```
today = this._daylightSavingAdjust(
                new Date("Your Date Here") ), // clear time 
```

# ios - 适用于 iOS 的 Google Plus SDK 错误

> ID：15005266
> 
> 赞同：0
> 
> 时间：2013-02-21T14:53:24.070
> 
> 标签：ios, objective-c, sdk

我正在尝试在我的项目中实现“Google Plus SDK for iOS”。但我有这样的问题。

![截屏](../Images/58cda09853701b4f1d20a40a40b7ff60.png)

# node.js - node.js 用 Q 处理异常

> ID：15005273
> 
> 赞同：2
> 
> 时间：2013-02-21T14:53:47.803
> 
> 标签：node.js, error-handling, q

我已经使用 node 几个月了。对于异步代码中的错误处理，我一直在遵循我所知道的[最佳实践](https://stackoverflow.com/questions/7310521/node-js-best-practice-exception-handling)，即通过回调错误参数处理错误，并让大多数异常冒泡并使应用程序崩溃，因为实际上并没有一种干净地恢复的方法。

我现在正在与使用[Q](https://github.com/kriskowal/q)的开发人员一起开发一个项目，他正在使用 Q.nfbind 使用包装器调用我的一些基于回调的函数。但是，这让我对错误处理感到头疼。例如，假设我有一个可以回调错误的函数：

```
function doSomething(x, callback) {
    dbpool.acquire(function(err, conn) {
        if (err) return callback(err);

        conn.query('INSERT INTO some_table (x) VALUES (?)', [x],
        function(err, result) {
            dbpool.release(conn);
            if (err) return callback(err);
            callback(null, result.insertId);
        });
}
var qDoSomething = Q.nfbind(doSomething); 
```

使用 QI 然后可以调用 qDoSomething 并处理错误 ok：

```
qDoSomething('abc')
.fail(function(err) {
     ...
}); 
```

现在假设我一晚工作得太晚，并在查询之前在我的 doSomething() 函数中签入了这样的代码：

```
var foo;
foo.doAnotherThing(); 
```

在我的 Q 之前的世界里，这会很糟糕。将引发异常，这将导致应用程序崩溃，并且它将永远重启。但是，一旦应用程序重新启动，它至少可以正常工作，直到再次点击此代码路径。但是，使用 Q，这个异常现在被失败处理程序捕获和处理。此处理程序无法修复损坏，因为它对连接池一无所知。现在，每次命中此代码路径时，都会从池中泄漏一个连接，最终应用程序被阻塞。这个错误的影响从坏到可怕。

我不知道 Q 有什么方法可以区分最初抛出的错误和通过回调错误产生的错误。似乎我被困在处理所有事情或什么都不处理。任何人都可以建议一种从可怕到糟糕的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T15:13:36.097

子类化`Error`来包装那些`err`'s 怎么样？

```
var MyError = function() {
  Error.apply(this, arguments);
};

var generateError = function(callback) {
  callback(new MyError('some reason'));
};
var doSomething = q.nfbind(generateError);

doSomething()
  .fail(function(e) {
    console.log('Was this a MyError instance?', e instanceof MyError);
  }); 
```

# .net - 按位值必须是指数的吗？

> ID：15005276
> 
> 赞同：1
> 
> 时间：2013-02-21T14:54:05.340
> 
> 标签：.net, bit-manipulation, bitwise-operators

在所有按位示例中，我看到值呈指数增长（1、2、4、8 等）。但是，在下面的枚举中，我使用 1、2、3、4（如果你愿意，请原谅 VB）：

```
<Flags()>
Enum BitWiseTest
    One = 1
    Two = 2
    Three = 3
    Four = 4
End Enum 
```

令我惊讶的是，以下代码有效：

```
Dim TestBits As BitWiseTest

TestBits = TestBits Or BitWiseTest.One
TestBits = TestBits Or BitWiseTest.Two
TestBits = TestBits Or BitWiseTest.Three
TestBits = TestBits Or BitWiseTest.Four

Dim BitToRemove As BitWiseTest

BitToRemove = BitWiseTest.Two

TestBits = Not BitToRemove

Console.WriteLine(TestBits And BitToRemove) 
```

注释掉该行将`TestBits = Not BitToRemove`告诉您不删除该位将告诉您它仍然存在。更改`BitToRemove = BitWiseTest.Two`为使用另一个枚举值将表明它也适用于其他位。

它似乎完美无缺，那么我在各处看到的关于按位的值的指数递增是怎么回事？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-21T14:56:11.333

> 它似乎完美无缺

这取决于您所说的“完美无缺”。

你*真的*想要`BitWiseTest.One`或`BitwiseTest.Two`等于`BitwiseTest.Three`吗？这就是你现在会得到的，这通常不是理想的......通常你希望标志是独立的，这意味着它们需要由二进制表示中的独立位表示 - 而这正是你得到的通过使用 1、2、4、8、16 等值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-21T19:16:08.013

通常有两种枚举。对于枚举：

1.  使用其中一个值。
2.  使用值的组合。

### 使用其中一个值

在这种情况下，您可以随意编号枚举成员。如果它们的含义相同，您甚至可以拥有两个具有相同值的成员。例如：

```
Enum Comparison
    None = 0
    CaseSensitive = 1
    IgnoreCase = 2

    Default = 1
End Enum 
```

### 使用了值的组合

一个值现在是布尔值：它可以是*on*（已使用、指定）或*off*（未使用或未指定）。这很好地转换为位，即 1（开）或 0（关）。为了能够将这些值彼此区分开来，您*应该*使用 2 的幂。然后，对于任何特定位，只有一个值可以将该位设置为开或关。

```
<Flags()>
Enum NumberStyles
    None = 0                    ' Binary:          0
    AllowLeadingWhite = 1       ' Binary:          1
    AllowTrailingWhite = 2      ' Binary:         10
    AllowLeadingSign = 4        ' Binary:        100
    AllowTrailingSign = 8       ' Binary:       1000
    AllowParentheses = 16       ' Binary:      10000
    AllowDecimalPoint = 32      ' Binary:     100000
    AllowThousands = 64         ' Binary:    1000000
    AllowExponent = 128         ' Binary:   10000000
    AllowCurrencySymbol = 256   ' Binary:  100000000
    AllowHexSpecifier = 512     ' Binary: 1000000000
End Enum 
```

现在您可以组合两个值来获得一个新值，并且可以区分这些值：

```
Dim testBits As NumberStyles
testBits = NumberStyles.AllowHexSpecifier _
        Or NumberStyles.AllowTrailingWhite _
        Or NumberStyles.AllowLeadingWhite       ' Binary: 1000000011

' If (1000000011 And 1000000000) <> 0 Then
If testBits.HasFlag(NumberStyles.AllowHexSpecifier) Then
    ' Do something
End If 
```

如果有意义的话，您也可以将这些组合添加到枚举中：

```
<Flags()>
Enum NumberStyles
    ' ...
    Integer = 7                 ' Binary:        111
    Number = 111                ' Binary:    1101111
    Float = 167                 ' Binary:   10100111
    Currency = 383              ' Binary:  101111111
    HexNumber = 515             ' Binary: 1000000011
End Enum 
```

* * *

## 关于你的例子

查看示例的二进制值。值`One`和是`Two`二`Four`的幂，但`Three`不是。如果我扩展您的示例，也许您会看到问题：

```
<Flags()>
Enum BitWiseTest
    One = 1     ' Binary:    1
    Two = 2     ' Binary:   10
    Three = 3   ' Binary:   11
    Four = 4    ' Binary:  100
    Five = 5    ' Binary:  101
    Six = 6     ' Binary:  110
    Seven = 7   ' Binary:  111
End Enum 
```

现在，做`Six Or Three = Seven`，这通常不是你想要的。也是when `value And Two`is ，or ，这也可能是你现在想要的。原因是在 中设置的一位也存在于 中，这取决于您选择值的方式。`True``value``Three``Six``Seven``Two``Three``Six``Seven`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-21T15:20:32.140

它们不必是指数级的，没有语言限制。

在大多数情况下，将它们定义为指数是有意义的，因此它们彼此独立。在*极*少数情况下，您可能会受益于将指数*标志*值与预定义的*状态*值相结合：

```
public enum KitchenState{
    NothingHappening = 0,

    PanOnStove = 1,
    StoveOn = 2,
    Preheating = 3,

    EggsInPan = 4,
    EggsCooking = 7, 
} 
```

在这种情况下，预热和 EggsCooking 是*状态*，PanOnStove、StoveOn 和 EggsInPan 是*标志*。这主要是一个噱头，但有时会派上用场

# python - Bazaar：添加 WorkingTree 特定的元数据

> ID：15005282
> 
> 赞同：1
> 
> 时间：2013-02-21T14:54:34.840
> 
> 标签：python, bazaar

我希望能够设置/获取与 bzr 中的工作树相关的一些自定义属性。当我在特定的工作树中开始构建源时，可以使用这些属性。例如，我们的软件使用 PostgreSQL 数据库实例，每个构建（在工作树/分支内）需要能够通过名称/主机/端口“知道”它与哪个数据库实例相关：DevDB、StableDB、StableRev010DB 等。 ..

我不想将这些属性中的任何一个放在 bzr 控制下的文件中。我已经制作了一个自定义的“make_branch.py​​”脚本，它能够从源 URL 创建一个工作树/分支，并且希望添加一些选项以便在使用我的创建新分支时能够设置这些自定义属性脚本。

有人有建议吗？Bzrlib 文档非常详尽，但我似乎无法确定如何通过当前的 API 实现这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T20:57:57.863

为什么不将您的元数据存储在文件中并使用`bzr ignore`或编辑标记这些文件被忽略`.bzrignore`？如果这不适合您，请解释原因。

`bzr-svn`根据存储某种未版本化的属性，我在文档 中看到的最接近的内容：http: [//doc.bazaar.canonical.com/migration/en/foreign/bzr-on-svn-projects.html #versioned-properties](http://doc.bazaar.canonical.com/migration/en/foreign/bzr-on-svn-projects.html#versioned-properties)

> Subversion 有一个 Bazaar 目前不存在的版本化属性的概念。这意味着 bzr-svn 不能设置任何版本化的属性，例如：svn:keywords、svn:eol-style 和 svn:mime-type。
> 
> 但是，bzr-svn 将保留文件上已经存在的版本化属性。

也就是说，Bazaar 中没有版本化的属性，但这很好，因为您不想对它们进行版本化。该插件保留了很多 Subversion 元数据，因此确实必须有 API 方法。但是，即使这些元数据没有版本化，它们仍然存储在存储库中，这又不是您想要的。

我还没有阅读所有 API 文档，但是阅读了用户指南，并且绝对没有提及您正在寻找的功能。也就是说，Bazaar*是*非常可扩展的，所以也许有一种使用 API 的方法。

我建议在 irc.freenode.net 上的 IRC 频道 #bzr 上四处询问。您也可以尝试在[http://irclogs.ubuntu.com的 IRC 日志中进行搜索](http://irclogs.ubuntu.com)

# sql - 如何检查 SQL Server 2008 R2 中的包含？

> ID：15005283
> 
> 赞同：0
> 
> 时间：2013-02-21T14:54:36.317
> 
> 标签：sql, sql-server, sql-server-2008, sql-server-2005, sql-server-2008-r2

我正在使用 SQL Server 2008 R2。我需要同时检查列值是否有`"-"`，我`case`这里使用的语句。

如果`"-"`存在，那么我需要将日期格式更改为`dd/mm/yy`. 数据库中的给定日期是`"2013-01-01 00:00:00.000" to "dd/mm/yy"`

你对此有什么想法吗？

我的代码是：

```
select  
    DISTINCT 
    D30.SPGD30_SHIP_SITE_C As ShipSite, D30.SPGD30_RATING_MONTH_Y As RatingMonth,
    D30.SPGD30_PRIOR_SCORE_R As Prior, D30.SPGD30_REVISED_SCORE_R As Revised, 
    CASE 
      WHEN SUBSTRING(D30.SPGD30_TRACKED_ADJUSTMENT_X, 1, 1) = 'D' 
        THEN 'Dispute - ' + D30.SPGD30_TRACKED_ADJUSTMENT_X 
      WHEN SUBSTRING(D30.SPGD30_TRACKED_ADJUSTMENT_X, 1, 1) = 'R' 
        THEN 'Return Of Points - '+D30.SPGD30_TRACKED_ADJUSTMENT_X
      WHEN containstable(D30.SPGD30_TRACKED_ADJUSTMENT_X, '"*-" or "-*"') 
        THEN 'Score Calculation - ' + CONVERT(VARCHAR(8), D30.SPGD30_TRACKED_ADJUSTMENT_X, 1)
    END AS Adjustments,
    J02.SPGJ02_MSG_CODE_X As Comments,
    D31.SPGA04_RATING_ELEMENT_D As Comments,
    D30.SPGD30_LAST_TOUCH_Y As LastUpdated,
    D30.SPGD30_LAST_TOUCH_C As LastUpdatedCDSID 
FROM
    CSPGD30_TRACKING D30, CSPGD31_TRACKING_RATING_ELEMNT D31,
    CSPGA04_RATING_ELEMENT_MSTR A04 , CSPGJ02_MSG_OBJ J02, CSPGJ03_MSG_TRANSLN J03
WHERE
    D30.SPGD30_SHIP_SITE_C = D31.SPGD30_SHIP_SITE_C -- D30 and D31
    AND D30.SPGD30_RATING_MONTH_Y = D31.SPGD30_RATING_MONTH_Y --D30 and D31
    AND D31.SPGA04_RATING_ELEMENT_D = A04.SPGA04_RATING_ELEMENT_D --D31 and A04
    AND J02.SPGJ02_MSG_K = J03.SPGJ02_MSG_K --J02 and J03
    AND A04.SPGJ02_MSG_K = J02.SPGJ02_MSG_K --A04 and Jo2
    AND d30.SPGA02_BUSINESS_TYPE_C = 'prod' -- org
    AND d30.SPGA03_REGION_C = 'EU' -- region
    AND d30.SPGD30_SHIP_SITE_C = 'ms01a' -- shipsite
    AND D30.SPGD30_LAST_TOUCH_Y BETWEEN '2013-01-01 00:00:00.000'  --rating month
                                    AND '2013-01-30 23:59:59.000' -- rating month
    AND d30.SPGD30_LAST_TOUCH_C = 'sadalara' --CDSID 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-21T14:59:55.197

只需使用[CHARINDEX](http://msdn.microsoft.com/en-us/library/ms186323.aspx)进行测试

```
...
when CHARINDEX('-*', D30.SPGD30_TRACKED_ADJUSTMENT_X) > 0 OR
  CHARINDEX('*-', D30.SPGD30_TRACKED_ADJUSTMENT_X) > 0

THEN 'Score Calculation - '+CONVERT(VARCHAR(8), D30.SPGD30_TRACKED_ADJUSTMENT_X, 1) 
```

仅供参考，您需要[样式 103`dd/mm/yyyy`](http://msdn.microsoft.com/en-us/library/a87d0850-c670-4720-9ad5-6f5a22343ea8)

# android - 无法解析主机 Android

> ID：15005285
> 
> 赞同：1
> 
> 时间：2013-02-21T14:54:42.983
> 
> 标签：android, resolve, inetaddress

我想使用本地代理从我的 Android 设备发送一个 http 请求。在详细说明我的问题之前，我想让你知道这在我尝试过的每台设备上都运行良好，除了在 Android 4.0.4 下运行的 Xperia arc S 和 Xperia T。我在两台设备上都有数据连接，而且都在工作！

我使用了一个`DefaultHttpClient`实例来发送我的请求，但是当代码到达那部分时：

```
client.execute(request.target, request.post); 
```

它崩溃说以下错误：

```
02-21 15:37:25.677: W/System.err(1926): java.net.UnknownHostException: Unable to resolve host "192.168.010.200": No address associated with hostname
02-21 15:37:25.681: W/System.err(1926):     at java.net.InetAddress.lookupHostByName(InetAddress.java:426)
02-21 15:37:25.681: W/System.err(1926):     at java.net.InetAddress.getAllByNameImpl(InetAddress.java:242)
02-21 15:37:25.681: W/System.err(1926):     at java.net.InetAddress.getAllByName(InetAddress.java:220)
02-21 15:37:25.681: W/System.err(1926):     at org.apache.http.impl.conn.DefaultClientConnectionOperator.openConnection(DefaultClientConnectionOperator.java:143)
02-21 15:37:25.681: W/System.err(1926):     at org.apache.http.impl.conn.AbstractPoolEntry.open(AbstractPoolEntry.java:164)
02-21 15:37:25.681: W/System.err(1926):     at org.apache.http.impl.conn.AbstractPooledConnAdapter.open(AbstractPooledConnAdapter.java:119)
02-21 15:37:25.681: W/System.err(1926):     at org.apache.http.impl.client.DefaultRequestDirector.execute(DefaultRequestDirector.java:360)
02-21 15:37:25.681: W/System.err(1926):     at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:580)
02-21 15:37:25.681: W/System.err(1926):     at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:534)
02-21 15:37:25.681: W/System.err(1926):     at com.myapp.mms.sender.WapClient.execute(WapClient.java:59) 
```

在上面的错误日志中，本地IP是我的本地代理主机。

这是我的整个代码：

```
public Response execute(PostRequest request) throws Exception
{
    // Set proxy and route
    this.params = client.getParams();
    if (isProxySet) ConnRouteParams.setDefaultProxy(params, new HttpHost(this.host, this.port));        
    request.post.setParams(params);

    // Set header
    request.post.addHeader("Accept", "*/*, application/vnd.wap.mms-message, application/vnd.wap.sic");
    request.post.addHeader("Accept-Language", getCurrentAcceptLanguage(Locale.getDefault()));

    // Execute the request
    HttpResponse httpResponse = client.execute(request.target, request.post);

    // Create the object that will receive the response
    Response response = new Response();

    // Get the response code
    StatusLine status = httpResponse.getStatusLine();
    response.code = status.getStatusCode();

    // Get the response body
    byte[] responseBody = null;
    HttpEntity entity = httpResponse.getEntity();
    if (entity != null)
    {
        if (entity.getContentLength() > 0)
        {
            responseBody = new byte[(int)entity.getContentLength()];
            DataInputStream dis = new DataInputStream(entity.getContent());
            dis.readFully(responseBody);
            dis.close();
        }
        entity.consumeContent();
    }
    response.body = responseBody;

    return response;
} 
```

有没有办法绕过这个仅在 Android 4.0.4 下出现的错误，还是我做错了？

或者有没有办法在不调用 InetAddress.getByName 的情况下做同样的事情？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-21T15:51:18.213

我找到了一种似乎适用于我拥有的每台设备的方法：

```
 URL url = new URL(apn);

    // Set-up proxy
    Log.d(TAG, "Setting up proxy (" + host + ":" + port + ")");
    Properties systemProperties = System.getProperties();
    systemProperties.setProperty("http.proxyHost", host);
    systemProperties.setProperty("http.proxyPort", String.valueOf(port));
    systemProperties.setProperty("http.keepAlive", "false");

    // Open connection
    HttpURLConnection connection = (HttpURLConnection) url.openConnection();

    // Use the URL connection for output
    connection.setUseCaches(false);
    connection.setDoOutput(true);

    // Set the timeouts
    connection.setConnectTimeout(TIMEOUT);
    connection.setReadTimeout(TIMEOUT);

    // Sends the request
    connection.setRequestProperty("Content-Type", "application/vnd.wap.mms-message");
    connection.setRequestProperty("Content-Length", Integer.toString(mms.length));

    // Connect to the MMSC
    Log.d(TAG, "Connecting to APN " + apn);
    connection.connect();

    try
    {
        // Upload mms as bytes array
        Log.d(TAG, "Uploading data (Size: " + mms.length);
        OutputStream out = connection.getOutputStream();
        out.write(mms);
        out.flush();
        out.close();

        // Wait for the response
        Log.d(TAG, "Response code is " + connection.getResponseCode());

        if (connection.getContentLength() >= 0)
        {
            Log.d(TAG, "Reading response ...");
            byte[] responseArray = new byte[connection.getContentLength()];
            DataInputStream i = new DataInputStream(connection.getInputStream());
            int b = 0;
            int index = 0;
            while ((b = i.read()) != -1)
            {
                responseArray[index] = (byte) b;
                index++;
            }
            i.close();

            // Close the connection
            Log.d(TAG, "[MMS Sender] Disconnecting ...");
            connection.disconnect();
        }
        else
        {
            return false;
        }
    }
    catch (Exception e)
    {
        e.printStackTrace();
    }

    return false; 
```

我希望这会帮助一些有同样错误的人。

# android - 设备就绪检查期间出现奇怪的 Phonegap 警报

> ID：15005289
> 
> 赞同：2
> 
> 时间：2013-02-21T14:54:53.390
> 
> 标签：android, cordova

我在 Android 4.2 上[嵌入了一个 Cordova WebView](http://docs.phonegap.com/en/2.4.0/guide_cordova-webview_android.md.html#Embedding%20Cordova%20WebView%20on%20Android)，我正在使用 cordova-2.4.0.js。

webview 工作正常，但每当我尝试像这样初始化 Phonegap 时：

```
function init() {
        document.addEventListener("deviceready", function() {
                deviceReady = true;
                console.log("Device="+device.platform+" "+device.version);
            }, false);
        window.setTimeout(function() {
            if (!deviceReady) {
                alert("Error: PhoneGap did not initialize.  Demo will not run correctly.");
            }
        },1000);
    } 
```

我收到一条警报：gap:["Network Status","getConnectionInfo","Network Status1602045086"]

[这里](https://stackoverflow.com/questions/10575651/ios-phonegap-infinite-dialog-error-when-running-application)的解决方案表明我可能使用了错误版本的 phonegap，但我确保我得到了 Android 所需的版本。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-21T23:59:04.163

通过删除来修复它： cordovawebview.setWebChromeClient(); 我用来调试的。

# sql - SQL Server 2008 生成数据脚本并检查现有记录

> ID：15005292
> 
> 赞同：1
> 
> 时间：2013-02-21T14:54:56.073
> 
> 标签：sql, sql-server-2008, wizard

我正在使用 SQL Server 2008 Management Studio`Generate Scripts...`向导为我的数据库中的各种表生成纯数据脚本。

问题是它会生成一堆插入语句，但不包括任何类型的 if exists 逻辑。所以，我得到了已经存在的记录的主键异常。

有谁知道一种在表中编写数据脚本的方法，以便检查记录是否已经存在？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T15:08:43.827

最简单的方法是创建一个视图，该视图只为新主键选择具有唯一值的行，然后从该视图生成数据脚本。

如果您向我们展示源表的 CREATE TABLE 脚本以及您的新主键是什么，我可以向您展示如何创建这样的视图。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T15:37:11.513

我猜你的意思是存在 FK 错误，因为某些表在将数据插入表中作为其引用之前需要存在数据。

生成脚本向导将为您提供一组插入脚本但不会为您排序，您需要做的是智能地所有子表插入脚本应该比父表更早排序，因为一旦数据填充到父表中所有引用的表都将具有值。

# vba - Excel2010中自动隐藏行的if-else VBA语句

> ID：15005295
> 
> 赞同：1
> 
> 时间：2013-02-21T14:55:00.550
> 
> 标签：vba, excel, if-statement, excel-2010

我正在尝试根据在特定字段中输入的值隐藏-自动隐藏我的 Excel 2010 电子表格中的某些行。我正在使用数据验证来设置 0 到 50 之间的最小和最大数字。如果是 0，则隐藏接下来的 3 行，但如果是任何其他数字，则显示行。

下面是有效的 VBA 代码，除了我必须把它放在每个可能的数字上。有没有我可以使用的 IF Else 语句？如果为 0 则隐藏，否则显示行

```
If Target.Address(False, False) = "B45" Then

    Select Case Target.Value

        Case "0": Rows("46:48").Hidden = True

        Case "1": Rows("46:48").Hidden = False

        Case "2": Rows("460:48").Hidden = False

        Case "3": Rows("46:48").Hidden = False

        Case "4": Rows("46:48").Hidden = False

        Case "5": Rows("46:48").Hidden = False

        Case "6": Rows("46:48").Hidden = False

        Case "7": Rows("46:48").Hidden = False

        Case "8": Rows("46:48").Hidden = False

        Case "9": Rows("46:48").Hidden = False

        Case "10": Rows("46:48").Hidden = False

    End Select

    Else: Rows("46:48").Hidden = False

End If 
```

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T15:00:54.150

你不只是使用：

```
Case Else
Rows("46:48").Hidden = False 
```

?

然后这表示任何不适合第一种情况（0）的东西都默认为这个。

对不起，如果我误解了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T15:01:14.150

而不是使用 Select Case 您可以尝试：

```
If Target.Address(False, False) = "B45" Then
    If Target.Value > 0 And Target.Value <= 10 Then
        Rows("46:48").Hidden = False
    Else
        Rows("46:48").Hidden = True
    End If
Else
    Rows("46:48").Hidden = False
End If 
```

# php - 在 while 循环中循环 mysqli_fetch_array()

> ID：15005298
> 
> 赞同：1
> 
> 时间：2013-02-21T14:55:06.470
> 
> 标签：php, jquery-mobile, while-loop

我有以下*工作*代码从数据库中获取图像`mysqli_fetch_array()`并将图像加载到`layout grid`Jquery Mobile 1.2.0 中的结构中。

`layout grid`Jquery Mobile的结构使用限制为五列[的内置样式网格/块](http://view.jquerymobile.com/1.2.0/docs/content/content-grids.html)`ui-block-a`，最多`ui-block-e`. 因此，我应该坚持 JQM 风格。

**注意：**我使用四列结构`ui-block-a`，`ui-block-d`

为了将八 (8) 个图像加载到块中并正确设置它们的样式，我必须将这些类`ui-block-a, -b, -c, -d`用于四个图像的第一行，并将相同的类用于四个图像的第二行。

我`foreach (array(a, b, c, d, a, b, c, d) as $i)`在里面使用`while loop`但我得到了重复的结果。

代码运行良好，但我想知道是否还有其他可能性可以通过删除所有`IF-statements`.

**编码：**

```
while ($row = mysqli_fetch_array($query)) {
 $img = $row["fn"];
  if (empty($img)) { break; }
  $thumb = 'images/th_'.$img;
  if ($count == 8) { break; } // limited to 8 images/results

  if ($count == 0) $i = 'a'; //first 4 imgs row classes
  if ($count == 1) $i = 'b';
  if ($count == 2) $i = 'c';
  if ($count == 3) $i = 'd';

  if ($count == 4) $i = 'a'; //second 4 imgs row classes
  if ($count == 5) $i = 'b';
  if ($count == 6) $i = 'c';
  if ($count == 7) $i = 'd';

  $ths.='<div class="ui-block-'.$i.'"><img src="'.$thumb.'"></div>';

  $count = $count + 1;
}; 
```

**结果：**

```
<div class="ui-grid-c">
    <!-- First row -->
    <div class="ui-block-a"><img src="img1.jpg"></div>
    <div class="ui-block-b"><img src="img2.jpg"></div>
    <div class="ui-block-c"><img src="img3.jpg"></div>
    <div class="ui-block-d"><img src="img4.jpg"></div>
    <!-- Second row -->
    <div class="ui-block-a"><img src="img5.jpg"></div>
    <div class="ui-block-b"><img src="img6.jpg"></div>
    <div class="ui-block-c"><img src="img7.jpg"></div>
    <div class="ui-block-d"><img src="img8.jpg"></div>
</div> 
```

先感谢您！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-21T15:03:16.780

试一试吧！

```
$count=0;
$arr=array('a', 'b', 'c', 'd');
while ($row = mysqli_fetch_array($query)) {
 $img = $row["fn"];
  if (empty($img)) { break; }
  $thumb = 'images/th_'.$img;
  if ($count == 8) { break; }

  $i=$arr[$count%4];    

  $ths.='<div class="ui-block-'.$i.'"><img src="'.$thumb.'"></div>';

  $count++;
}; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-21T15:02:07.960

尝试

```
$count = 0;
while ($row = mysqli_fetch_array($query) && $count < 8) {
  $img = $row["fn"];
  if (empty($img)) { break; }
  $thumb = 'images/th_'.$img;

  $i = chr(97 + ($count%4) ); // char a + 0, 1, 2 or 3

  $ths.='<div class="ui-block-'.$i.'"><img src="'.$thumb.'"></div>';

  $count++;
}; 
```

php 函数 chr： http: [//php.net/manual/en/function.chr.php](http://php.net/manual/en/function.chr.php)

“a”的ASCII码：97

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-28T15:06:33.380

与其他答案一样，这使用 MOD 来确定我们所在的列，但适用于任意数量的图片，并且如果图片数量不是 4 的因子，也可以填写空白单元格。使用用户输入而不是 ad/b 结果有关演示，请参见[http://solomon.ie/so/gallery.php?pics=6](http://solomon.ie/so/gallery.php?pics=6) - 将 pics=6 更改为任意数字

```
<?  
$num_pics = 0;
$num_pics = $_GET['pics'];

// store HTML/JQM fragments
$blank_picture_row = "<div class='ui-block-a'>%pic_1%</div>\n";
$blank_picture_row .= "<div class='ui-block-b'>%pic_2%</div>\n";
$blank_picture_row .= "<div class='ui-block-c'>%pic_3%</div>\n";
$blank_picture_row .= "<div class='ui-block-d'>%pic_4%</div>\n\n";

//start HTML
$out ="<div class='ui-grid-c'>\n\n";

for ($pic_index=0; $pic_index < $num_pics; $pic_index++)
    {
    $thumb_pic = "Pic # $pic_index";// create image tag - text for demo

    if ($pic_index % 4 == 0) // mod result will be zero for start of each new row of 4 
        $picture_row = $blank_picture_row;

    $position_in_row = ($pic_index % 4) + 1;
    $pic_place_holder = "%pic_"  . $position_in_row . "%";

    $picture_row = str_replace($pic_place_holder, $thumb_pic, $picture_row);

    if ($pic_index == ($num_pics - 1)) // last pic, blank any positions that are not needed
        {
        $position_in_row = $pic_index % 4; 

        switch ($position_in_row) 
            { 
            case 0: // last pic was in column 1 - using a space, but could also put in a dummy pic
                    $picture_row = str_replace("%pic_2%", "&nbsp;", $picture_row);
            case 1: // last pic was in column 2 
                    $picture_row = str_replace("%pic_3%", "&nbsp;", $picture_row);
            case 2: // last pic was in column 3 
                    $picture_row = str_replace("%pic_4%", "&nbsp;", $picture_row);
            case 3: // last pic is in column 4, no action required
                break;
            } 
        } // END if if ($pic_index == ($num_pics - 1))

    if ($pic_index % 4 == 3 || $pic_index == ($num_pics - 1))  
        {// last pic in this row or last pic in total - add this row to output
        $out .= $picture_row;
        }

    } // END for ($pic_index=$start_pic; $pic_index < $finish_pic; $pic_index++)

$out .= "</div>\n\n\n";
$out=htmlspecialchars($out);
$out=nl2br($out);

print "$out\n";
?> 
```

# android - 如何保持蓝牙活动活跃

> ID：15005301
> 
> 赞同：0
> 
> 时间：2013-02-21T14:55:16.973
> 
> 标签：android, android-activity, bluetooth

在我的应用程序中，我使用[Janos Gyerik 的 BluetoothViewer](http://bazaar.launchpad.net/~janos-gyerik/bluetoothviewer/main/files)代码通过蓝牙进行连接。

我还有一个`TCPServer`通过 USB 连接的类。

```
public void connectViaUSB() {
    if (GlobalVariables.connectionstatus == 0) {
        mTCPServer = new TCPServer(2222, getCurrentActivity());
        mTCPServer.start();
        mTCPServer.setResponseReceivedListener(this);
    } 
```

问题是，`BluetoothViewer`写成`Activity`. 需要启动活动才能连接，但是当我切换到另一个活动时连接丢失。

我需要始终保持该活动，或者找到修改它的方法。我该如何解决这种情况？

**编辑**

`
公共类 MyService 扩展服务 {

```
private static final String TAG = "MyService";

@Override
public IBinder onBind(Intent intent) {
    return null;
}

@Override
public void onCreate() {
    Toast.makeText(this, "My Service Created", Toast.LENGTH_LONG).show();
    Log.d(TAG, "onCreate");

    BluetoothAdapter mAdapter = BluetoothAdapter.getDefaultAdapter();
    mAdapter.enable();

    BluetoothChatService mChatService = new BluetoothChatService(mHandler);
    BluetoothDevice device = BluetoothAdapter.getDefaultAdapter().getRemoteDevice("00:12:11:13:19:26");
    mChatService.connect(device);
}

@Override
public void onDestroy() {
    Toast.makeText(this, "My Service Stopped", Toast.LENGTH_LONG).show();
    //stop thread
}

@Override
public void onStart(Intent intent, int startid) {
    Toast.makeText(this, "My Service Started", Toast.LENGTH_LONG).show();
    Log.d(TAG, "onStart");
    //start thread (again)
} 
```

}`

如何从该服务类建立蓝牙连接？它需要我移动 mHandler，我做到了。现在我得到 RuntimeException: Unable to create .MyService: NullPointerException

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T15:40:59.510

尝试使用服务连接到蓝牙。当您需要使用蓝牙时，只需致电服务即可。这可以帮助你：[http ://www.vogella.com/articles/AndroidServices/article.html](http://www.vogella.com/articles/AndroidServices/article.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T15:37:30.797

不确定这是否对您有所帮助，但我曾经创建了一个由蓝牙控制的机器人。它使用在服务/线程内运行的连接。为此，我使用了以下 2 个类：

BluetoothSerialService.java

DeviceListActivity.java

只需用谷歌搜索这两个课程，您就会找到托管它们的地方。像这儿。 [http://code.google.com/p/bluetooth-remote-control/source/browse/trunk/src/pro/apus/blueremote/?r=2](http://code.google.com/p/bluetooth-remote-control/source/browse/trunk/src/pro/apus/blueremote/?r=2)

要实际设置连接，只需将类似这样的内容绑定到按钮即可。

```
public void autoconnect() {

        t = new TextView(this);
        t = (TextView) findViewById(R.id.connecttext);
        mSerialService = new BluetoothSerialService(this, mHandlerBT, t);
        if (mSerialService.getState() == BluetoothSerialService.STATE_NONE) {
            BluetoothDevice device = BluetoothAdapter.getDefaultAdapter()
                    .getRemoteDevice(mMacAddress);
            mSerialService.connect(device);
        } else if (mSerialService.getState() == BluetoothSerialService.STATE_CONNECTED) {
            setProgressBarIndeterminateVisibility(false);
            mSerialService.stop();
            mSerialService.start();
        }
    } 
```

并确保在这样做之前征求许可。

```
BluetoothAdapter mBluetoothAdapter = BluetoothAdapter
                .getDefaultAdapter();
        askBluetoothPermission(mBluetoothAdapter); 
```

# spring - Apache骆驼抛出链接错误

> ID：15005302
> 
> 赞同：0
> 
> 时间：2013-02-21T14:55:18.100
> 
> 标签：spring, apache, jetty, apache-camel, linkageerror

我在我的应用程序中包含了 apache camel，以转发匹配字符串模式的请求。

当我尝试在 jetty 应用程序服务器（版本 7.6.1.v20120215）中部署打包的 Web 应用程序时，应用程序崩溃并抛出 Linkage 错误。

我尝试在camel-parent pom.xml 中进行一些更改来编译camel 源代码，以便它使用与码头服务器和Web 应用程序使用的相同版本的依赖项。

以下是我在camel-parent pom.xml 中所做的更改：

```
 <project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
  <parent>
    <groupId>org.apache.camel</groupId>
    <artifactId>camel</artifactId>
    <version>2.10.3</version>
  </parent>
  <modelVersion>4.0.0</modelVersion>
  <groupId>org.apache.camel</groupId>
  <artifactId>camel-parent</artifactId>
  <version>2.10.3</version>
  <packaging>pom</packaging>
  <name>Camel :: Parent</name>
  <description>Camel Parent POM</description>
  <properties>
    <jetty-version>7.6.1.v20120215</jetty-version>
    <log4j-version>1.2.16</log4j-version>
    <slf4j-api-version>1.6.1</slf4j-api-version>
    <slf4j-version>1.6.1</slf4j-version> 
```

下面是添加到我的 Web 应用程序的 pom.xml 中的导入依赖项列表：

```
<dependency>
    <groupId>org.apache.camel</groupId>
    <artifactId>camel-core</artifactId>
    <version>2.10.3</version>
</dependency>
<dependency>
    <groupId>org.apache.camel</groupId>
    <artifactId>camel-spring</artifactId>
    <version>2.10.3</version>
</dependency>
<dependency>
    <groupId>org.apache.camel</groupId>
    <artifactId>camel-servlet</artifactId>
    <version>2.10.3</version>
</dependency> 
```

每次部署 webapp 时都会遇到的错误是：

```
2013-02-21 13:06:43.138: org.springframework.web.context.ContextLoader ERROR - Context initialization failed
org.springframework.beans.factory.BeanDefinitionStoreException: Unexpected exception parsing XML document from ServletContext resource [/WEB-INF/applicationContext.xml]; nested exception is org.springframework.beans.FatalBeanException: Invalid NamespaceHandler class [org.apache.camel.spring.handler.CamelNamespaceHandler] for namespace [http://camel.apache.org/schema/spring]: problem with handler class file or dependent class; nested exception is java.lang.LinkageError: loader constraint violation: when resolving method "org.slf4j.impl.StaticLoggerBinder.getLoggerFactory()Lorg/slf4j/ILoggerFactory;" the class loader (instance of org/eclipse/jetty/webapp/WebAppClassLoader) of the current class, org/slf4j/LoggerFactory, and the class loader (instance of sun/misc/Launcher$AppClassLoader) for resolved class, org/slf4j/impl/StaticLoggerBinder, have different Class objects for the type org/slf4j/ILoggerFactory used in the signature
    at org.springframework.beans.factory.xml.XmlBeanDefinitionReader.doLoadBeanDefinitions(XmlBeanDefinitionReader.java:412)
    at org.springframework.beans.factory.xml.XmlBeanDefinitionReader.loadBeanDefinitions(XmlBeanDefinitionReader.java:334)
    at org.springframework.beans.factory.xml.XmlBeanDefinitionReader.loadBeanDefinitions(XmlBeanDefinitionReader.java:302)
    at org.springframework.beans.factory.support.AbstractBeanDefinitionReader.loadBeanDefinitions(AbstractBeanDefinitionReader.java:174)
    at org.springframework.beans.factory.support.AbstractBeanDefinitionReader.loadBeanDefinitions(AbstractBeanDefinitionReader.java:209)
    at org.springframework.beans.factory.support.AbstractBeanDefinitionReader.loadBeanDefinitions(AbstractBeanDefinitionReader.java:180)
    at org.springframework.web.context.support.XmlWebApplicationContext.loadBeanDefinitions(XmlWebApplicationContext.java:125)
    at org.springframework.web.context.support.XmlWebApplicationContext.loadBeanDefinitions(XmlWebApplicationContext.java:94)
    at org.springframework.context.support.AbstractRefreshableApplicationContext.refreshBeanFactory(AbstractRefreshableApplicationContext.java:131)
    at org.springframework.context.support.AbstractApplicationContext.obtainFreshBeanFactory(AbstractApplicationContext.java:527)
    at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:441)
    at org.springframework.web.context.ContextLoader.configureAndRefreshWebApplicationContext(ContextLoader.java:383)
    at org.springframework.web.context.ContextLoader.initWebApplicationContext(ContextLoader.java:283)
    at org.springframework.web.context.ContextLoaderListener.contextInitialized(ContextLoaderListener.java:111)
    at org.eclipse.jetty.server.handler.ContextHandler.startContext(ContextHandler.java:733)
    at org.eclipse.jetty.servlet.ServletContextHandler.startContext(ServletContextHandler.java:233)
    at org.eclipse.jetty.webapp.WebAppContext.startContext(WebAppContext.java:1214)
    at org.eclipse.jetty.server.handler.ContextHandler.doStart(ContextHandler.java:676)
    at org.eclipse.jetty.webapp.WebAppContext.doStart(WebAppContext.java:455)
    at com.myclass.appserver.ContextWrapper.doStart(ContextWrapper.java:73)
    at org.eclipse.jetty.util.component.AbstractLifeCycle.start(AbstractLifeCycle.java:59)
    at com.myclass.appserver.JettyServer.startHandler(JettyServer.java:274)
    at com.myclass.appserver.JettyServer.deployApp(JettyServer.java:203)
    at com.myclass.appserver.JettyServer.deployApp(JettyServer.java:138)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at sun.reflect.misc.Trampoline.invoke(MethodUtil.java:37)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at sun.reflect.misc.MethodUtil.invoke(MethodUtil.java:244)
    at javax.management.modelmbean.RequiredModelMBean.invokeMethod(RequiredModelMBean.java:1074)
    at javax.management.modelmbean.RequiredModelMBean.invoke(RequiredModelMBean.java:955)
    at com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.invoke(DefaultMBeanServerInterceptor.java:836)
    at com.sun.jmx.mbeanserver.JmxMBeanServer.invoke(JmxMBeanServer.java:761)
    at javax.management.remote.rmi.RMIConnectionImpl.doOperation(RMIConnectionImpl.java:1427)
    at javax.management.remote.rmi.RMIConnectionImpl.access$200(RMIConnectionImpl.java:72)
    at javax.management.remote.rmi.RMIConnectionImpl$PrivilegedOperation.run(RMIConnectionImpl.java:1265)
    at javax.management.remote.rmi.RMIConnectionImpl.doPrivilegedOperation(RMIConnectionImpl.java:1360)
    at javax.management.remote.rmi.RMIConnectionImpl.invoke(RMIConnectionImpl.java:788)
    at sun.reflect.GeneratedMethodAccessor41.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at sun.rmi.server.UnicastServerRef.dispatch(UnicastServerRef.java:305)
    at sun.rmi.transport.Transport$1.run(Transport.java:159)
    at java.security.AccessController.doPrivileged(Native Method)
    at sun.rmi.transport.Transport.serviceCall(Transport.java:155)
    at sun.rmi.transport.tcp.TCPTransport.handleMessages(TCPTransport.java:535)
    at sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run0(TCPTransport.java:790)
    at sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run(TCPTransport.java:649)
    at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)
    at java.lang.Thread.run(Thread.java:662)
Caused by: org.springframework.beans.FatalBeanException: Invalid NamespaceHandler class [org.apache.camel.spring.handler.CamelNamespaceHandler] for namespace [http://camel.apache.org/schema/spring]: problem with handler class file or dependent class; nested exception is java.lang.LinkageError: loader constraint violation: when resolving method "org.slf4j.impl.StaticLoggerBinder.getLoggerFactory()Lorg/slf4j/ILoggerFactory;" the class loader (instance of org/eclipse/jetty/webapp/WebAppClassLoader) of the current class, org/slf4j/LoggerFactory, and the class loader (instance of sun/misc/Launcher$AppClassLoader) for resolved class, org/slf4j/impl/StaticLoggerBinder, have different Class objects for the type org/slf4j/ILoggerFactory used in the signature
    at org.springframework.beans.factory.xml.DefaultNamespaceHandlerResolver.resolve(DefaultNamespaceHandlerResolver.java:139)
    at org.springframework.beans.factory.xml.BeanDefinitionParserDelegate.parseCustomElement(BeanDefinitionParserDelegate.java:1414)
    at org.springframework.beans.factory.xml.BeanDefinitionParserDelegate.parseCustomElement(BeanDefinitionParserDelegate.java:1409)
    at org.springframework.beans.factory.xml.DefaultBeanDefinitionDocumentReader.parseBeanDefinitions(DefaultBeanDefinitionDocumentReader.java:184)
    at org.springframework.beans.factory.xml.DefaultBeanDefinitionDocumentReader.doRegisterBeanDefinitions(DefaultBeanDefinitionDocumentReader.java:140)
    at org.springframework.beans.factory.xml.DefaultBeanDefinitionDocumentReader.registerBeanDefinitions(DefaultBeanDefinitionDocumentReader.java:111)
    at org.springframework.beans.factory.xml.XmlBeanDefinitionReader.registerBeanDefinitions(XmlBeanDefinitionReader.java:493)
    at org.springframework.beans.factory.xml.XmlBeanDefinitionReader.doLoadBeanDefinitions(XmlBeanDefinitionReader.java:390)
    ... 55 more 
```

我环顾四周试图找出链接错误，但没有任何结果。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T17:18:53.217

经过大量阅读，发现错误是因为无法获取slf4j staticlogger，参考这篇文章：[http ://www.slf4j.org/codes.html#StaticLoggerBinder](http://www.slf4j.org/codes.html#StaticLoggerBinder)

# jquery - 我无法解决 jquery 和 prototyp.js 之间的冲突

> ID：15005304
> 
> 赞同：0
> 
> 时间：2013-02-21T14:55:18.377
> 
> 标签：jquery, tabs, prototypejs, lightbox, conflict

我是带着沉重的心情和沉重的脑袋请求帮助的。我正在为疗养院设计一个网站（这里 - [http://www.coolpenguin.co.uk/yourhealth/yourhealth-cedarcourt.php](http://www.coolpenguin.co.uk/yourhealth/yourhealth-cedarcourt.php)）

该站点使用 jquery 作为选项卡，使用prototype.js 作为灯箱功能（显示在名为 life here 的第二个选项卡上）。

该网站是全新的，所以我接受格式化等不完整，但我已经停止处理这个问题。我可以有工作标签或工作灯箱画廊，不能两者兼而有之。

我试过 jQuery.noConflict(); 在许多方面，甚至更改所有关联的 js 文件中的 $ 符号以用于灯箱，反之亦然在选项卡的标题中。

我需要有一个在标签上工作的图片库。我不能是第一个需要这两个功能的人，但是在这个问题上超过三个小时我无法解决它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T14:59:10.373

不知道我明白了，noConflict 很简单

```
var $s = jQuery.noConflict(); 
```

然后像这样使用jQuery ...

```
$s(document).ready(function() { 
```

此外，您的 jquery 版本很旧。

# jquery - 限制 jqgrid 自动刷新

> ID：15005307
> 
> 赞同：0
> 
> 时间：2013-02-21T14:55:33.613
> 
> 标签：jquery, jqgrid, struts2, struts2-jquery

我正在使用**struts2-jquery-jqgrid**。我在网格上有**filterSearch**。**在过滤器中，我在“分配给**”列上有一个下拉列表，其中包含用户列表，并且可以根据用户过滤数据。

**问题场景：**

当我从下拉列表中选择一个选项时，数据被成功过滤，但之后**jqgrid 会自动刷新**。因此，我再次无法在网格中获取过滤后的数据。

**我的网格是**

```
 <sjg:grid
            id="gridtable"
            caption="Issue-Summary"
            dataType="json"
            href="%{remoteurl}"
            pager="true"
            gridModel="finalGridModel"
            rowList="20,25,30"
            rowNum="20"
            rownumbers="true"
            width="1260" 
            filter="true"
            filterOptions="{stringResult :true,
                            searchOnEnter : true,
                            enableClear : true,
**// Update Section**       autosearch:'false' //this solved my problem
                           }"   
        >
            <sjg:gridColumn name="assigned_to"   index="assigned_user" key="assigned_user" title="Assigned To" searchtype="select"
              searchoptions="{defaultSearch:'cn', dataUrl : '%{fillUser}', 
              dataEvents: [{ type: 'change', fn: function(elem) { myfunction(elem)}}]}"/>
       </sjg:grid> 
```

我的网格快照

![在此处输入图像描述](../Images/e8fc59e5099a61abfe8e260dfc479ef9.png)

任何帮助都会很棒。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T05:29:18.813

好的，我让它工作了，只是我必须添加**自动搜索：'false'** 请检查更新的部分

# css3pie - 圆角在 IE 中不圆角

> ID：15005310
> 
> 赞同：0
> 
> 时间：2013-02-21T14:55:42.963
> 
> 标签：css3pie, video.js

有什么线索吗？试过`pie.htc`但它不起作用

```
.vjs-default-skin .vjs-big-play-button {
  -moz-border-radius: 25px;
  -webkit-border-radius: 25px;
  border-radius: 25px;
  behavior: url(bla bla/PIE.htc);
  position: relative;
} 
```

![在此处输入图像描述](../Images/5397741ab2b11add047aaed269b46d79.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-25T08:26:44.307

我认为您的“.htc”文件的链接有问题。我有同样的问题，并通过正确链接到 PIE.htc 解决了它（我使用 PIE.php，因为这对我来说更好 - 这个文件包括 PIE.htc，我对 .htaccess 文件没有问题）。如果您的圆角在 Firefox（例如）中有效，而在 IE8 和更早版本中无效，那么您在 PIE 文件上的链接肯定有问题。您必须从使用圆角的文件（不是从 CSS 文件，而是从例如 home.php）链接到 htc 文件。

但是没有代码，测试页面或类似的东西是测试它并说“你在这里有问题”的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T19:56:59.303

您看到的是 IE 9、渐变背景和 CSS3 边框的问题。在 3.2.0 版中，在默认样式的第 329 行，您将找到`Big Play Button (at start)`. IE 9 抓住了这个`filter`声明。

```
background: #454545;
background: -moz-linear-gradient(top, #454545 0%, #232323 50%, #161616 50%, #3f3f3f 100%);
background: -webkit-gradient(linear, 0% 0%, 0% 100%, color-stop(0%,#454545), color-stop(50%,#232323), color-stop(50%,#161616), color-stop(100%,#3f3f3f));
background: -webkit-linear-gradient(top, #454545 0%,#232323 50%,#161616 50%,#3f3f3f 100%);
background: -o-linear-gradient(top, #454545 0%,#232323 50%,#161616 50%,#3f3f3f 100%);
background: -ms-linear-gradient(top, #454545 0%,#232323 50%,#161616 50%,#3f3f3f 100%);
filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#454545', endColorstr='#3f3f3f',GradientType=0 );
background: linear-gradient(top, #454545 0%,#232323 50%,#161616 50%,#3f3f3f 100%); 
```

如果您添加 SVG 图像渐变并使用条件注释来摆脱过滤器，您可以获得圆角边框和渐变背景。[Colorzilla 的渐变生成器之](http://www.colorzilla.com/gradient-editor/)类的东西可以提供帮助。

CSS：

```
background: #454545; /* Old browsers */
/* IE9 SVG, needs conditional override of 'filter' to 'none' */
background: url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiA/Pgo8c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgdmlld0JveD0iMCAwIDEgMSIgcHJlc2VydmVBc3BlY3RSYXRpbz0ibm9uZSI+CiAgPGxpbmVhckdyYWRpZW50IGlkPSJncmFkLXVjZ2ctZ2VuZXJhdGVkIiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSIgeDE9IjAlIiB5MT0iMCUiIHgyPSIwJSIgeTI9IjEwMCUiPgogICAgPHN0b3Agb2Zmc2V0PSIwJSIgc3RvcC1jb2xvcj0iIzQ1NDU0NSIgc3RvcC1vcGFjaXR5PSIxIi8+CiAgICA8c3RvcCBvZmZzZXQ9IjUwJSIgc3RvcC1jb2xvcj0iIzIzMjMyMyIgc3RvcC1vcGFjaXR5PSIxIi8+CiAgICA8c3RvcCBvZmZzZXQ9IjUxJSIgc3RvcC1jb2xvcj0iIzE2MTYxNiIgc3RvcC1vcGFjaXR5PSIxIi8+CiAgICA8c3RvcCBvZmZzZXQ9IjEwMCUiIHN0b3AtY29sb3I9IiMzZjNmM2YiIHN0b3Atb3BhY2l0eT0iMSIvPgogIDwvbGluZWFyR3JhZGllbnQ+CiAgPHJlY3QgeD0iMCIgeT0iMCIgd2lkdGg9IjEiIGhlaWdodD0iMSIgZmlsbD0idXJsKCNncmFkLXVjZ2ctZ2VuZXJhdGVkKSIgLz4KPC9zdmc+);
background: -moz-linear-gradient(top,  #454545 0%, #232323 50%, #161616 51%, #3f3f3f 100%); /* FF3.6+ */
background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#454545), color-stop(50%,#232323), color-stop(51%,#161616), color-stop(100%,#3f3f3f)); /* Chrome,Safari4+ */
background: -webkit-linear-gradient(top,  #454545 0%,#232323 50%,#161616 51%,#3f3f3f 100%); /* Chrome10+,Safari5.1+ */
background: -o-linear-gradient(top,  #454545 0%,#232323 50%,#161616 51%,#3f3f3f 100%); /* Opera 11.10+ */
background: -ms-linear-gradient(top,  #454545 0%,#232323 50%,#161616 51%,#3f3f3f 100%); /* IE10+ */
background: linear-gradient(to bottom,  #454545 0%,#232323 50%,#161616 51%,#3f3f3f 100%); /* W3C */
filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#454545', endColorstr='#3f3f3f',GradientType=0 ); /* IE6-8 */ 
```

在您的 HTML 中的某处：

```
<!--[if gte IE 9]>
<style type="text/css">
.vjs-default-skin .vjs-big-play-button {
    filter: none;
}
</style>
<![endif]--> 
```

希望有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-21T15:08:10.817

告诉浏览器它期待 IE9+ 代码可能会有所帮助，如下所示：

```
<meta http-equiv="X-UA-Compatible" content="IE=9" /> 
```

（请参阅[IE 中对“border-radius”的支持](https://stackoverflow.com/questions/635851/support-for-border-radius-in-ie)）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-18T01:56:49.390

尝试在 css 文件中声明它，

溢出：隐藏

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-21T23:39:49.953

我在 CSS3Pie 上遇到过不少问题。阅读[已知问题页面](http://css3pie.com/documentation/known-issues/)以获取完整说明，但我通常遇到的问题是相对路径或 htaccess 文件中没有适当的 .htc 内容类型。

# installation - 参考 UI 取决于 Windows 安装程序中的选定功能

> ID：15005314
> 
> 赞同：0
> 
> 时间：2013-02-21T14:55:49.783
> 
> 标签：installation, wix, windows-installer

在我的安装程序中，前两个屏幕始终相同（欢迎对话框和带有复选框的功能选择）。每个功能都需要不同的对话，有几个共同点。

我想知道是否可以为每个功能都有一个 UI 元素，并根据用户选择的他们想要的功能，引用正确的 UI。

我只想`FEATURETOINSTALL`在退出与我想要的 UI 的 ID 对应的功能选择对话框时设置一个属性，例如 。

```
<UI Id="CommonUI">
    ...
</UI>
<Property Id="FEATURETOINSTALL" Value="DefaultUIId"/>
<UIRef Id="[FEATURETOINSTALL]"/> 
```

基本上，当机器上已经显示 UI 时，我想引用一个 UI 元素。

有没有办法在已经显示 UI 时动态引用 UI 元素，而不是使用一堆`Publish`标签手动执行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T00:33:47.590

不可以。Id 和 Ref 是构建（编译/链接）时间概念，在构建 MSI 时必须完全解决。对于运行时操作，您需要操作`Publish`条件。

# .net - 我可以在嵌入式 Windows 7 上安装 net framework 4 应用程序吗

> ID：15005315
> 
> 赞同：1
> 
> 时间：2013-02-21T14:55:51.000
> 
> 标签：.net, windows-7, embedded, portability

我可以在嵌入了 Windows 7 操作系统的设备上安装和运行使用 .NET Framework 4 开发的应用程序吗？我打算购买这样一个嵌入了 Windows 7 的设备，所以需要知道我是否需要一些特殊的东西才能让我的应用程序在该设备上运行。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-21T14:58:41.987

如果是 Windows 7 SP1。

一探究竟 ：

[http://www.microsoft.com/windowsembedded/en-us/downloads/windows-embedded-compatible-applications-chooser.aspx](http://www.microsoft.com/windowsembedded/en-us/downloads/windows-embedded-compatible-applications-chooser.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-04-15T10:10:09.820

您可以运行在 .NET 4.0 中开发的应用程序，它在 Windows Embedded 7 SP 1 及更高版本中受支持。

检查以下链接以了解兼容性

[https://blogs.msdn.microsoft.com/windows-embedded/2015/08/10/microsoft-net-framework-versions-supported-by-windows-embedded-products/](https://blogs.msdn.microsoft.com/windows-embedded/2015/08/10/microsoft-net-framework-versions-supported-by-windows-embedded-products/)

# c# - EF Code First外键定义/左连接/导航属性？

> ID：15005316
> 
> 赞同：0
> 
> 时间：2013-02-21T14:55:55.617
> 
> 标签：c#, entity-framework, asp.net-mvc-4, lambda, foreign-keys

假设我有 3 张桌子：

```
[Table("Comments")]
public class Comment {
    [Key]
    [DatabaseGeneratedAttribute(DatabaseGeneratedOption.Identity)]
    public int Id { get; set; }
    [ForeignKey("Users")]
    public int UserId { get; set; }
    public virtual Users Users { get; set; }
    public string Text { get; set; }
}

[Table("Users")]
public class Users {
    [Key]
    [DatabaseGeneratedAttribute(DatabaseGeneratedOption.Identity)]
    public int Id { get; set; }
    public string UserName { get; set; }
}

[Table("CommentAgree")]
public class CommentAgree {
    [Key]
    [DatabaseGeneratedAttribute(DatabaseGeneratedOption.Identity)]
    public int Id { get; set; }
    public int CommentId { get; set; }
    public int UserId { get; set; }
} 
```

用户发表评论，其他用户可以“同意”该评论，有点像 Facebook 的“点赞”系统。我正在使用 lambda 进行查询，我可以这样做：

```
var query = db.Comments.Select(c => new {
            c.Id,
            c.Users.UserName,
            c.Text
}); 
```

如何创建加入 CommentAgree on `Comment.Id = CommentAgree.CommentId`？我可以在 Lambda 中编写联接，但我需要它是左联接，因为没有人可能同意该评论，但我仍然希望它显示。

我想以正确的方式做到这一点，所以我愿意接受建议，是否通过外键、lambda 连接、导航属性......或其他方式来做到这一点？

这可能吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T15:03:58.083

最好的方法可能是使用实体框架的功能并创建导航属性，而不是显式地使用 LINQ 来仅为相关数据执行连接。

如果您的类型只是为了访问数据而设计的，那么在关系的两端添加导航属性以及您已经拥有的外键属性可能是一个好主意。

集合导航属性 on`Comment`应该实现`ICollection`（例如），并且您将在该类型上具有类型`List<CommentAgree>`的引用导航属性。`Comment``CommentAgree`

然后，您必须使用数据注释或（最好）流畅的 API 来定义映射中的关系。

要加载相关数据，您可以使用延迟加载或急切加载（使用`Include`扩展方法），或使用实体条目信息中的显式加载。

# php - 用 MongoDB / PHP 保存图像有什么更好的地方/方法

> ID：15005324
> 
> 赞同：1
> 
> 时间：2013-02-21T14:56:11.833
> 
> 标签：php, mongodb, image, nosql

大家早上好，

我有一个问题，我正在用 php 创建一个 Web 应用程序，它将利用 MongoDB 数据库，即一个 nosql 数据库。

这个应用程序可以处理漂亮的图片，比如电子商务。我尝试了将图像保存在数据库中的想法，但没有成功，因此我得出结论，最好将图像路径保存在数据库中，图像通常保存在服务器上。

问题是，如何最好地做到这一点，最好的图像服务器是什么，最好是免费的或非常便宜的。大家平时都是怎么做的，用什么服务器啊？

注意：它将用于商业应用。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-09T21:23:12.860

首先，如果您正在建立在线业务，您应该准备好为对您的项目有益的产品和服务付费。当然，我不是告诉你选择最昂贵的解决方案，我告诉你不要首先考虑成本来做出选择。

出于多种原因，将图像本身保存在数据库中并不是一个好主意。如果您对人们很容易猜测您的图像路径感到满意，您可以使用类似于以下内容的内容：

```
http://img.buyfromus.com/products/12736.png 
```

其中**12736**是产品的唯一 ID。这样，您不必存储每个产品图像的路径，只需在代码或模板中构建路径。

如果您不希望人们轻易猜测您的图像路径，您可以为每个产品生成一个**唯一代码**并将其用作文件名：

```
http://img.buyfromus.com/products/fc9e5c3935.png 
```

其中**fc9e5c3935**是产品的唯一代码。

这两种方法比存储每个产品图像的完整路径要好。

根据目标受众的规模和类型（全球、本地等），“我应该在哪里托管我的图像”的答案会发生变化。如果它是一个小型网站，您可能也可以使用您的网络服务器来提供您的图像。如果它不会很小，您可以使用一个或多个单独的服务器来提供您的图像。如果它将成为一个高流量的全球网站，您可能希望使用其中一种云解决方案，例如 AWS S3。

如果您需要更具体的建议，请编辑您的帖子以提供更多详细信息。

# delphi - VCL 样式从何而来？

> ID：15005327
> 
> 赞同：3
> 
> 时间：2013-02-21T14:56:21.100
> 
> 标签：delphi, vcl-styles

在我的编程团队中，我们都使用 Delphi XE2 Professional。我们刚刚发现在不同的计算机上可以使用不同数量的 VCL 样式。

VCL 样式从何而来？我是否必须小心将样式从一个 Delphi 安装转移到另一个？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-21T19:06:52.027

**Q : VCL 风格从何而来？**

**A :** Vcl Styles 文件是 Delphi XE2 和 XE3 版本的一部分，安装在两个位置`C:\Users\Public\Public Documents\RAD Studio\<n.n>\Styles`和`C:\Program Files (x86)\Embarcadero\RAD Studio\<n.n>\Redist\styles\vcl`文件夹中。

您也可以从头开始创建或自定义 Vcl 样式文件，因此可能某些机器包含自定义 Vcl 样式并解释不同数量的 vsf 文件。

**问：我是否必须小心将样式从一个 Delphi 安装转移到另一个？**

这取决于如何将 Vcl 样式添加到 Delphi 项目中。基本上存在 3 种将 Vcl 样式添加到项目中的方法。

1.  使用`Projects->Options->Application->Appearance`菜单选项。在这种情况下，每种样式的新条目都将添加到 .dproj（Delphi 项目文件）中，并带有样式的路径。编译后，.dproj 文件引用的样式将作为资源嵌入到项目中。

2.  [使用TStyleManager](http://docwiki.embarcadero.com/Libraries/XE3/en/Vcl.Themes.TStyleManager)类手动加载样式（从外部文件或资源） 。

3.  直接编辑 .dproj 文件并添加一个名为Key`VCL_Custom_Styles`的新条目。`<PropertyGroup Condition="'$(Base)'!=''">`

因此，如果您的 Delphi 项目使用方法 1 或 3 引用 Vcl 样式，则需要在机器之间复制 Vcl 样式以避免在缺少 Vcl 样式时出现编译问题。

Note : As recommendation you can create a *style* folder (and add that folder as part of you source control scheme) in your Delphi project location and here copy the vcl styles used by you Application, and then modify your code to load the styles using the method 2.

# html - 内部 p 内 span 的 CSS 类

> ID：15005331
> 
> 赞同：4
> 
> 时间：2013-02-21T14:56:33.013
> 
> 标签：html, css, css-selectors

我有这样的 HTML 结构：

```
<p>
    <a href="#">
        <span class = "class-for-span"> SOME TEXT HERE </span>
    </a>
</p> 
```

和 CSS：

```
p a{
    color: grey;
    text-decoration: underline;
}

.class-for-span {
    color: red;
    text-decoretion: none;
}

.class-for-span:hover {
    text-decoration:underline;
} 
```

我想得到这样的想法：

对于每个内部 pi 需要灰色下划线链接。如果标签中有跨度，则它必须是没有装饰的红色，并且在悬停时带有红色下划线。

现在我有灰色带下划线的链接，如果在标签内跨越 - 悬停时带有灰色下划线的红色链接和带有红色 udnerline 的红色链接。

我怎样才能只用css解决我的问题？我也一直在尝试这样的事情：

```
p a span .class-for-span {
text-decoration: none;
} 
```

但它也不起作用......

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-21T15:03:55.960

```
p a span .class-for-span {
    text-decoration: none;
} 
```

Won't work because of the space between `span` and `.class-...`. That would imply "the element with class `class-...` **within** the span". You can't overwrite an element's parent's property in CSS. The solution would be to set `text-decoration:none;` on the `a` tag and only use it on the `span`:

```
p a { text-decoration:none; }
p a span.class-for-span { text-decoration:none; }
p a:hover span.class-for-span { text-decoration:underline; } 
```

This will cause the underline to appear when the anchor is hovered over, but not necessarily when the span is hovered over. So the underline would still appear on the span even if you had:

```
<a href="..."><span>Text</span><img src="..." alt="" /></a> 
```

...and hovered over the image.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-21T15:02:37.517

```
p a:link, p a:hover, p a:active, p a:visited {
  /* works for any 'a' tag inside a 'p' tag */
  border-bottom: 2px dotted #CCCCCC;
} 
```

that will work for these:

```
<p><a href="#">Hello</a><br>
<a href="#">Hello again</a></p> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-21T15:00:23.417

a 元素是下划线，而不是跨度，因此当您从跨度中删除下划线时，您仍然有 a 元素保持其下划线。做你原来的块

```
p a span {
color: grey;
text-decoration: underline;
} 
```

一切都应该开始工作

# java - 从 Servlet 重定向后其他形式不起作用

> ID：15005332
> 
> 赞同：0
> 
> 时间：2013-02-21T14:56:43.480
> 
> 标签：java, jsp, servlets, jstl

所以，我目前正在尝试学习一些 JSP，但我不知道如何解决我遇到的这个问题。

目前，我有一个包含多个表单的 index.jsp 页面。对于一种表单，它有两个文本字段，将其发送到 servlet test.java 以构建字符串。构建字符串后，servlet 会重定向回 index.jsp

原始 index.jsp 地址： `http://localhost:8080/TestJSPConversion/`

重定向后，地址为 `http://localhost:8080/TestJSPConversion/test`

当我尝试在 index.jsp 上使用另一个表单时出现问题，然后它会将我带到地址处的空白页， `http://localhost:8080/TestJSPConversion/test?author=Peter+Johnson`

我相信这是由于我用来从 servlet 重定向的方法 (request.getRequestDispatcher("/index.jsp").forward(request, response); 但是，我不太确定如何解决这个问题。即使在 servlet 重定向回 index.jsp 之后，我也希望表单能够正常工作。

小服务程序代码：

```
protected void doPost(HttpServletRequest request,
        HttpServletResponse response) throws ServletException, IOException {
    // TODO Auto-generated method stub
    // Get parameters from the request.
    String name = request.getParameter("name");
    String email = request.getParameter("email");

    String message = null;
    GregorianCalendar calendar = new GregorianCalendar();
    if (calendar.get(Calendar.AM_PM) == Calendar.AM) {
        message = "Good Morning, ";
    } else {
        message = "Good Afternoon, ";
    }
    message += name + " with the email, " + email;

    request.setAttribute("message", message);
    request.getRequestDispatcher("/index.jsp").forward(request, response);
} 
```

Index.jsp 代码：

```
<h2>Choose authors:</h2>
<form method="get">
    <input type="checkbox" name="author" value="Tan Ah Teck">Tan
    <input type="checkbox" name="author" value="Mohd Ali">Ali 
    <input type="checkbox" name="author" value="Kumar">Kumar 
    <input type="checkbox" name="author" value="Peter Johnson">Peter
    <input type="submit" value="Query">
</form>

<c:set var="authorName" value="${param.author}" />
</br>
<c:if test="${not empty authorName}">
    <c:out value="${authorName}" />
</c:if>
</br>
<form  action="test" method="POST">  
    First Name: <input type="text" name="name" size="20"><br />  
    Surname: <input type="text" name="email" size="20">  
    <br /><br />  
    <input type="submit" value="Submit">  
</form>
<c:out value="${message}" /> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T15:20:50.907

尝试使用（EL）`response.sendRedirect("index.jsp?message=hello");`显示它。`${param.message}`如果您使用方法作为 post in `<form action="test" method="POST">`，那么您必须在`doPost`方法中编写代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T15:06:44.930

也为其他设置 action="test" `<form>`。

如果这会引导您访问一些 url，例如 domain/TestJspConnection/test/test... 然后尝试将 action="/TestJSPConnection/test" 作为您的`<form>`属性

哦，是的，根本没有注意到这一点！...您没有在您的 sevlet 中实现 doGet() ......所以让`<form method="get" >`您进入空白页面

所以..两种解决方案：

1) 在 servlet 中实现 doGet()
或
2) 设置`method="post"`为第一种形式

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-21T15:22:37.100

首先：你只实现 doPost 所以你的第一个带有 method=Get 的表单会很可能。失败。

第二：你应该使用 sendRedirect 而不是 forward。这样，如果您在浏览器上点击刷新，您将不会收到有关重新发布数据的警告！当服务器进程完成并且您希望在 JSP 中显示结果时，最好使用 sendRedirect。

问候

# c# - 将复选框动态添加到 Windows 窗体仅显示一个复选框

> ID：15005333
> 
> 赞同：14
> 
> 时间：2013-02-21T14:56:47.997
> 
> 标签：c#, winforms, checkbox

对不起，如果这看起来很奇怪，但我已经搜索了几天了。我正在尝试将复选框动态添加到 Windows 窗体；但是，表单上只出现一个复选框。这是我的代码：

```
for (int i = 0; i < 10; i++)
{
    box = new CheckBox();
    box.Tag = i.ToString();
    box.Text = "a";
    box.AutoSize = true;
    box.Location = new Point(10, i + 10);
    Main.Controls.Add(box);
} 
```

如您所见，我正在通过 for 循环添加复选框。我试过弄乱位置并启用自动调整大小，以防它们以某种方式重叠。结果是一个带有文本“a”的复选框。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-02-21T15:04:50.027

实际上，您已经创建了一个`CheckBox`但在同一点内。

```
CheckBox box;
for (int i = 0; i < 10; i++)
{
    box = new CheckBox();
    box.Tag = i.ToString();
    box.Text = "a";
    box.AutoSize = true;
    box.Location = new Point(10, i * 50); //vertical
    //box.Location = new Point(i * 50, 10); //horizontal
    this.Controls.Add(box);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-04-09T06:54:25.607

在这种情况下，借助动态分配 Name 属性如何实现 checkbox.checked 属性，在提交按钮等其他操作中。我如何才能选中所有复选框并在循环中创建？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-11-10T04:04:58.677

如果你有每个按钮的实例，你可以用你的按钮或你的事件来制作类似的东西

```
 CheckBox myCheckedBox = (CheckBox)sender; 
```

# c++ - libcurl c++ curl_easy_init 不工作

> ID：15005334
> 
> 赞同：2
> 
> 时间：2013-02-21T14:56:53.467
> 
> 标签：c++, curl, mingw, libcurl

我刚刚尝试使用 windows + mingw + eclipse juno + curl 7.29 第一次设置 curl。我设法让它编译和构建得很好。我为 lcurl 和 lcurldll 添加了两个标志。出于某种原因，尽管以下方法不起作用：

```
#include <iostream>
#include <curl.h>
using namespace std;

int main(int argc,char *argv[]) {
 cout << "L1" << endl;
 CURL *curl;
 curl = curl_easy_init();
 cout << "L2" << endl;
} 
```

L1 和 L2 都不会打印。如果我注释掉easy_init 行，尽管它运行良好。我好像找不到类似的帖子，如果这是骗人的，请见谅。另外，我不能踏入任何东西，因为它一击运行就死了。我敢肯定这是显而易见的。

提前致谢。

面向 C/C++ 开发人员的 Eclipse IDE 版本：Juno Service Release 1 Build id：20120920-0800

curl 版本：7.29.0 - 启用 SSL 的 URL：[http ://curl.haxx.se/gknw.net/7.29.0/dist-w32/curl-7.29.0-devel-mingw32.zip](http://curl.haxx.se/gknw.net/7.29.0/dist-w32/curl-7.29.0-devel-mingw32.zip)

至于 mingw 不确定我有哪个版本，我只是去了[http://sourceforge.net/projects/mingw/files/](http://sourceforge.net/projects/mingw/files/)并下载/安装了最新版本。

在 Eclipse 中，在 MinGW C++ 链接器下，我有 curl 和 curldll 库。在杂项中，我有静态标志 - 这些是我更改的唯一编译器设置。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T18:06:11.170

它确实对我有用，但我只需要`system("PAUSE")`在最后添加，因为控制台关闭之前我可以看到任何东西。

这是我的代码：

```
#include <curl.h>
#include <iostream>

using namespace std;

int main(void)
{
    cout << "L1" << endl;

    CURL *curl;
    curl = curl_easy_init();

    cout << "L2" << endl;

    system("PAUSE");

    return 0;
} 
```

如果您收到“无法打开包含文件：'curl.h'：没有这样的文件或目录”或类似的消息，这是因为您在安装 curl 时遗漏了一些内容。我花了很长时间才安装它。

# vb.net - 列表：检测从小于零到大于零的开关

> ID：15005335
> 
> 赞同：0
> 
> 时间：2013-02-21T14:56:55.123
> 
> 标签：vb.net, algorithm, linq, list

是否有任何现有的 linq 函数或类似函数来检测有序列表中的值从小于零变为大于零的频率？

例如，值：

```
5
2
-2
-5
8  <--- First
6
2
0
1
-3
-5
-3
2  <--- Second 
```

总数：2

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-21T15:04:45.940

当然 - 如果您使用 .NET 4 或更高版本，这当然很容易，使用`Zip`：

```
// TODO: Consider how you want to handle 0 itself
var count = list.Zip(list.Skip(1), (x, y) => new { x, y })
                .Count(pair => pair.x > 0 && pair.y < 0); 
```

如果你对 VB 很了解，那应该不难转换成 VB :)

或者，如果你真的有一个列表，你可以在没有 LINQ 的情况下很容易地“手动”完成它：

```
int count = 0;
for (int i = 0; i < list.Count - 1; i++)
{
    if (list[i] > 0 && list[i + 1] < 0)
    {
        count++;
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-21T15:52:49.373

您可以使用以下方法一次性实现`Aggregate`：

```
seq.Aggregate(new { Count=0, LastN = 0}, (state, n) => new { 
        Count =  state.Count + (n > 0 && state.LastN < 0 ? 1 : 0), 
        LastN = n == 0 ? state.LastN : n
    }).Count 
```

这考虑到您希望包含“渐进”转换，例如 -1,0,1。

但是，foreach 可能更容易，因为它更传统。它也会更快：

```
var count = 0;
var lastN = 0;
foreach(var n in seq) {
    if(n > 0 && lastN < 0)
        count++;
    if (n != 0)
        lastN = n;
} 
```

# javascript - 如何使用javascript验证标签或元素是否在网页上居中对齐

> ID：15005336
> 
> 赞同：0
> 
> 时间：2013-02-21T14:56:58.660
> 
> 标签：javascript, css, coded-ui-tests

为了验证元素是否居中对齐，我试图获取元素的 CSS 属性/值。我完全是 javascript 的新手，所以我想寻求你的帮助来获取 css 属性，以便使用 javascript 验证文本对齐。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T15:01:37.553

如果你的意思是垂直对齐 - 你不能，在表格之外不存在这样的东西。

如果你想获得水平对齐，你可以使用'text-align'。

`document.getElementById('idOfElement').style.textAlign`将返回对齐方式'left'、'right'、'center'、'justify'等。

使用 jQuery 更简单： `$('#idOfElement').css('text-align');`将返回相同的结果。但是要让 jQuery 工作，您需要在[此处包含脚本](http://code.jquery.com/jquery-1.9.1.min.js)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T15:16:41.730

看看[jQuery offset()](http://api.jquery.com/offset/)

获取第一个元素的当前坐标，或设置匹配元素集中每个元素相对于文档的坐标。

.offset() 方法允许我们检索元素相对于文档的当前位置。将此与 .position() 进行对比，后者检索相对于偏移父级的当前位置。当将新元素放置在现有元素之上以进行全局操作（特别是用于实现拖放）时，.offset() 更有用。

结合找到的文档

*   [如何获得元素的正确偏移量？- jQuery](https://stackoverflow.com/questions/3043102/how-to-get-right-offset-of-an-element-jquery)
*   [从jquery获取偏移值](https://stackoverflow.com/questions/1042584/to-get-the-offset-values-from-jquery)
*   [获取元素的底部和右侧位置](https://stackoverflow.com/questions/9872128/get-bottom-and-right-position-of-an-element)

您将能够实现验证元素是否对齐（定位）中心的目标。

对于使用 javascript 验证文本对齐的另一点：

```
if ($('#yourElement').css('text-align') == 'center')
{
   // true
} 
```

继续

# xml - 在给定位置的无效 XML 字符串中查找父元素

> ID：15005337
> 
> 赞同：0
> 
> 时间：2013-02-21T14:57:03.873
> 
> 标签：xml, regex

例子：

```
...some string content here...
<test>
    <a>
        ...something...
    </a>
    <a/>
    {position 1}
    <b>{position 2}
        <c>
            ...something else...
            {position 3}
        </c>
        <c/>
        <d>
            <e/>
            {position 4}
            <e>
                ...another thing here...
                {position 5}
            </e>
        </d>
        {position 6}
    </b>
    {position 7}
...more xml and other sting content... 
```

> 我需要在（例如）上面指定的位置找到父封闭元素。
> 
> 结果将是： {position 1} = test {position 2} = b {position 3} = c {position 4} = d {position 5} = e {position 6} = b {position 7} = test
> 
> 备注： - 不知道任何元素标签名称 - 孔字符串可能包含非 xml 内容 - 数据大小非常大（>50MB 文本文件）

必须实施一种搜索技术，从给定位置开始向后读取，直到找到有效匹配（如果有）。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T15:18:13.033

根据定义，无法解析无效的 XML。这就是为什么任何 XML 解析器都会拒绝解析它并返回错误的原因。

如果 XML 解析器不能解析它，你也不能（基本上）。您所要求的不是一些可以被正则表达式抓取的简单字符串或简单的标签集合。您确实必须进行*完整的解析*（可能是无效数据！）才能在特定位置找到父标签。

**更新：**要了解我在说什么，请考虑`{position 1}`在您的示例中找到父级。

*   解决这个问题的一个简单的开始方法可能是“倒退并找到开始标签”。但是你显然不能取你找到的第一个开始标签 ( `<a>`)，因为它在仓位之前关闭。
*   所以，当你往回走时，你必须看到`</a>`并记住`<a>`标签是关闭的，这样你就不能算作`<a>`父级了。
*   当然，在您到达父级之前，可能会有任意数量的打开和关闭标签。您必须跟踪所有这些（包括同一标签的多次出现）。

如您所见，这非常复杂。那是在您允许文件中存在任何*无效元素*之前。

一种可能有效的简单方法：如果您确切知道文件错误是什么，您可以删除这些错误，然后将更正后的文件输入 XML 解析器。

否则，您将不得不为特定品牌的无效 XML 编写自己的自定义解析器。根据文件中错误的类型，它甚至可能是不可能的。

# html - 下拉图像没有出现在前面

> ID：15005338
> 
> 赞同：0
> 
> 时间：2013-02-21T14:57:05.117
> 
> 标签：html, css

我有一个带有图像代替箭头的下拉菜单。但我遇到了交叉浏览问题。在 chrome 中显示正常，但在 Mozilla 中，图像显示在后面。附上截图。

下拉 HTML

```
<td align="right">
 <div class="blue" style="float: left;">
    <div class="lightblueHeading" style="text-align: left;">No. Of Guests</div>
    <div>
        <div class="styled-select">
            <asp:DropDownList ID="ddlNoOfGuest" runat="server" Style="width: 165px;"></asp:DropDownList>
        </div>
    </div>
 </div>
</td> 
```

班级

```
.styled-select
{
    overflow: hidden; /*height: 24px;     background: url(../images/dropdown_icon.png) no-repeat right;*/
    background: url(../images/signup-dropdown_icon.png) no-repeat right;
    background-color: white;
    width: 100%;
}
.styled-select select
{
    background: transparent; /*border: 1px solid #e8e9e9;*/
    font-size: 12px;
    -webkit-appearance: none;
    -moz-appearance: none;
    appearance: none;
    visibility: hidden;

} 
```

![铬下拉](../Images/6f15c8d5dff3e483414a617514aa0bc4.png)

![Mozilla 下拉菜单](../Images/822882e02b34c8c167e5a2cbfecfacc6.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T15:53:19.320

您尝试的方法并非在每个浏览器中都完全兼容，并且您面临浏览器兼容性问题以及您如何解决问题的一些方法，但将来您可能会遇到浏览器兼容性问题，因为市场上有很多版本的 IE 每个人最喜欢的是 IE7 . 因此，为了解决这个问题，我的建议是使用基于 jquery 的插件，如下所示：

1.  [http://www.bulgaria-web-developers.com/projects/javascript/selectbox/](http://www.bulgaria-web-developers.com/projects/javascript/selectbox/)
2.  [http://www.jquery4u.com/plugins/10-jquery-selectboxdrop-down-plugins/](http://www.jquery4u.com/plugins/10-jquery-selectboxdrop-down-plugins/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T15:31:59.923

用作标签`opacity:0`的属性。`select`

# php - 为执行 exec() 的对象创建测试

> ID：15005340
> 
> 赞同：2
> 
> 时间：2013-02-21T14:57:18.813
> 
> 标签：php, unit-testing, phpunit

我想测试一个 php 函数调用`exec()`，最好的方法是什么？我用它来得到结果`git describe`：

```
class Version
{
    public function getVersionString()
    {
        $result = exec('git describe --always');

        if (false !== strpos($result, 'fatal')) {
            throw new RuntimeException(sprintf(
                'Git describe returns error: %s',
                $result
            ));
        }

        return $result;
    }
} 
```

所以我想测试命令是否被执行，当发生错误时，抛出异常（即“预期”行为和“异常”行为）。

```
class VersionTest extends PHPUnit_Framework_TestCase
{
    public function testVersionResultsString()
    {
        $version = new Version();
        $result  = $version->getVersionString();

        $this->assertEquals('...', $result);
    }

    public function testVersionResultHasFatalErrorThrowsException()
    {
        // trigger something that will cause the fatal
        $this->setExpectedException('RuntimeException');

        $version = new Version();
        $result  = $version->getVersionString();
    }
} 
```

当然课程和测试实际上要复杂一些，但本质是捕捉`exec()`某处。知道怎么做吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-21T15:04:11.233

如果您使用命名空间，则有一个*模拟*内置函数的技巧，如下所述：[https ://stackoverflow.com/a/5337635/664108](https://stackoverflow.com/a/5337635/664108)

所以，基本上你可以`exec`用你自己的函数替换，它的返回值将由你的测试指定。

# jboss7.x - 如何使用 Spring 3.2.1、Jboss AS7、Aspectj 1.7.1 java 1.7 确定 jms 连接工厂的实现接口？

> ID：15005345
> 
> 赞同：5
> 
> 时间：2013-02-21T14:57:31.247
> 
> 标签：jboss7.x, aspectj, java-7, spring-3, hornetq

我们正在使用 JBOSS AS7 在 java 1.6 中开发一个项目，其中我们使用：Aspectj 和 HornetQ。我们需要升级到 java 1.7，所以我们使用 ASpectj 1.7.1。在部署期间，我们得到以下异常：

```
Caused by: org.springframework.beans.factory.BeanCreationException:
  Error creating bean with name 'eventsJmsTemplate' defined in class path resource [com/company/project/jms/jms.xml]: 
  Cannot resolve reference to bean 'jmsConnectionFactory' while setting bean property 'connectionFactory'; nested exception is
   org.springframework.beans.factory.BeanCreationException: 
  Error creating bean with name 'jmsConnectionFactory': 
  Post-processing of the FactoryBean's object failed; 
    nestedexception is java.lang.IllegalArgumentException: 
      warning can't determine implemented interfaces of missing type 
    com.company.project.aspects.MBeanAttributesAdvice [Xlint:cantFindType] 
```

mbean是：

```
<jee:jndi-lookup id="jmsConnectionFactory" jndi-name="java:/JmsXA" /> 
```

在其他项目中，我们在使用 JPA 数据源时遇到了同样的异常：

```
<jee:jndi-lookup id="dataSource" jndi-name="java:jboss/datasources/table" />
<bean id="jpaDialect" class="org.springframework.orm.jpa.vendor.HibernateJpaDialect" /> 
```

我们设法通过在 jboss-deployment-structure 上添加模块依赖来解决这个问题：org.jboss.ironjacamar.jdbcadapters

```
<jboss-deployment-structure>
    <deployment>
        <exclusions>
            <module name="org.slf4j" />
            <module name="org.slf4j.impl" />
            <module name="org.apache.log4j" />
        </exclusions>
        <dependencies>
            <module name="org.jboss.ironjacamar.jdbcadapters" />
        </dependencies>
    </deployment>
</jboss-deployment-structure> 
```

有没有我们可以添加的模块来传递这个异常？或任何其他方式来解决这个问题？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-22T09:51:09.667

我想与您分享解决方案。添加模块：org.hornetq、org.hornetq.ra、org.jboss.ejb3、org.jboss.ejb-client。

```
<jboss-deployment-structure>
    <deployment>
        <!-- Exclusions allow you to prevent the server from automatically adding 
            some dependencies -->
        <exclusions>
            <module name="org.slf4j" />
            <module name="org.slf4j.impl" />
            <module name="org.apache.log4j" />
        </exclusions>
        <dependencies>
            <module name="org.jboss.ironjacamar.jdbcadapters" />
            <module name="org.hornetq" />
            <module name="org.hornetq.ra" />
            <module name="org.jboss.ejb3" />
            <module name="org.jboss.ejb-client" />
        </dependencies>
    </deployment>
</jboss-deployment-structure> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-02-21T10:56:02.707

我想记录什么对我有用，即使我迟到了这个问题。

我正在使用 JBoss 7.1.1 和 Spring 3.2.4：

例如，在 Spring 设置中使用基于注释的 Aspects 将导致 Aspect-Weaver 尝试检查您拥有的*所有*组件，包括您通过 JNDI-lookup 获得的组件。Weaver 会偶然发现这些组件，因为（我在某处读到过）用于加载它们的 Classloader（在我的例子中是 JBoss 的 ModuleClassLoader）对我的 Aspect （生活在我项目的类加载器中）一无所知，并且以`Xlint:cantFindType`.

通过项目类加载器范围内的东西代理这些组件可以解决这个问题。

对于 JDBC 数据源：

```
<jee:jndi-lookup id="dataSource" jndi-name="java:jboss/datasources/myDS" proxy-interface="javax.sql.DataSource" /> 
```

对于 JMS 连接工厂

```
<jee:jndi-lookup id="connectionFactory" jndi-name="java:/JmsXA" proxy-interface="javax.jms.ConnectionFactory"/> 
```

等等。

这样我就不必包含任何额外的模块之类的`org.jboss.ironjacamar.jdbcadapters`。

# c++ - 在 Mac (C++) 上获取系统时区的 UTC 偏移量

> ID：15005351
> 
> 赞同：3
> 
> 时间：2013-02-21T14:57:41.547
> 
> 标签：c++, macos, time, macos-carbon, core-foundation

我试图以分钟为单位将系统时区表示为与 UTC 的偏移量 - 类似于 Windows 函数 GetTimeZoneInformation(LPTIME_ZONE_INFORMATION)。Corefoundation 或 Carbon 中有什么东西可以给我这些信息吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-21T15:10:43.557

查看 Core Foundation的[日期和时间编程指南](https://developer.apple.com/library/mac/#documentation/CoreFoundation/Conceptual/CFDatesAndTimes/Tasks/UsingDates.html#//apple_ref/doc/uid/20001141-CJBEHAAG)。

这是未经测试的，但是如何：

```
CFTimeZoneRef tz = CFTimeZoneCopySystem();
CFTimeInterval minsFromGMT = CFTimeZoneGetSecondsFromGMT(tz, CFAbsoluteTimeGetCurrent()) / 60.0;
CFRelease(tz); 
```

# android - 我可以传入一个成员变量供 Android 服务使用吗？

> ID：15005352
> 
> 赞同：0
> 
> 时间：2013-02-21T14:57:46.230
> 
> 标签：android, service, android-manifest

我想在另一个项目中重用一些服务层代码。我确实希望能够更改服务使用的成员变量之一，而无需使用不同的服务代码。我不知道如何做到这一点，因为我没有“创建”服务；清单和系统会这样做。因此我不能在构造函数中传递一些东西。

我很难找到提出这个问题的文字，所以也许一个简单的例子是最好的。我有一项服务，例如：

```
public class MyService extends Service implements MyCommunicatorListener {

ICommunicator _comm = new BlueToothCommunicator(); // great for project 1, not for project 2!

public void shutUpCommunicator()  // example of using communicator
{
    _comm.Shutup();
}

// MyCommunicatorListener methods
@Override
public void onPageReceived(Page page) {  // example of listening to communicator
    Log.d(TAG,"onPageReceived");

}
}  // class greatly simplified... 
```

一切正常。该服务已启动，因为它已在清单中声明：

```
 <service android:name="com.acme.servicelayer.MyService" android:process=":remote" >
        <intent-filter>
            <action android:name="com.acme.servicelayer.MyService" />
            <action android:name="android.intent.action.BOOT_COMPLETED" />
            <category android:name="android.intent.category.HOME" />
        </intent-filter>
    </service> 
```

我想保留此服务代码并在另一个项目中重用它。在另一个项目中，我不想使用：

```
ICommunicator _comm = new BlueToothCommunicator(); // great for project 1, not for project 2! 
```

我想使用：ICommunicator _comm = new WiFiCommunicator(); // 非常适合项目 2，而不适合项目 1！我怎样才能做到这一点并保持相同的代码库？有没有办法通过清单传递参数？谢谢，戴夫

# php - sf_guard_user 无法保存权限

> ID：15005355
> 
> 赞同：1
> 
> 时间：2013-02-21T14:57:52.543
> 
> 标签：php, symfony-1.4, sfguard

当`sf_guard_user`我尝试修改用户的字段和权限时，symfony 告诉我“项目已成功更新”。

除权限外，所有字段均已修改。

我必须检查什么？

# image - 如何确定图像的整体像素值来设置阈值

> ID：15005359
> 
> 赞同：2
> 
> 时间：2013-02-21T14:58:29.957
> 
> 标签：image, matlab, image-processing, binary, threshold

我是 Matlab 新手。我尝试加载图像并对其执行背景减法。但是，我不知道如何根据我的结果确定阈值。我尝试使用直方图和灰度图来确定图像的阈值。我需要一些关于如何确定阈值的建议。

这是我的代码：

```
i2=imread('1cars.jpeg');
b1=rgb2gray(i2);
a1=medfilt2(b1);
result1= a1-a;
a2=imadjust(result1);

figure, imshow(a2);
level=graythresh(a2)
bw1=im2bw(a2,level);
bw=bwareaopen(bw1,50);
figure, imshow(bw);
image=getframe(gcf)
imwrite(image.cdata, strcat('result for 1 cars.jpg')); 
```

# java - 自签名证书

> ID：15005360
> 
> 赞同：1
> 
> 时间：2013-02-21T14:58:29.880
> 
> 标签：java, android, ssl-certificate, ksoap2

我使用带有自签名证书的主机。所以我从我的域[https://www.marpel.cz/下载了证书，并使用](https://www.marpel.cz/)[http://portecle.sourceforge.net/](http://portecle.sourceforge.net/)创建了 .bks 文件。

我需要建立 https 连接并从我的网络服务中检索数据。我使用 ksoap2 库。我已经复制并使用了ksoap2 wiki 中所述的类[ConnectionWithSelfSignedCertificate 。](http://code.google.com/p/ksoap2-android/wiki/CodingTipsAndTricks#How_to_set_the_SSLSocketFactory_on_a_https_connection__in_order)

这是我创建 keyStore 的方式

```
 MainActivity.java
    // Get an instance of the Bouncy Castle KeyStore format
    try {
        this.keyStore = KeyStore.getInstance("BKS");
    } catch (KeyStoreException e1) {
        // TODO Auto-generated catch block
        e1.printStackTrace();
    }
    // Get the raw resource, which contains the keystore with
    // your trusted certificates (root and any intermediate certs)
    InputStream in = this.getApplicationContext().getResources().openRawResource(R.raw.myCer);
    try {
        // Initialize the keystore with the provided trusted certificates
        // Also provide the password of the keystore
        this.keyStore.load(in, "myPass".toCharArray());
    } catch (Exception e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }finally {
        try {
            in.close();
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
    }

    try {
        this.sslSocketFactory = new ConnectionWithSelfSignedCertificate(this.keyStore).getSSLSocketFactory();
    } catch (Exception e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } 
```

这是来自 AsyncTask 的代码

```
background task
final HttpsTransportSE transportSE = new HttpsTransportSE(URL, PORT, SERVICE, TIMEOUT);

    try {
        ((HttpsServiceConnectionSE) transportSE.getServiceConnection()).setSSLSocketFactory(this.sslSocketFactory);
    } catch (IOException e1) {
        // TODO Auto-generated catch block
        e1.printStackTrace();
    } 
```

如果我打电话给 transportSE.call(SOAP_ACTION, envelope); 我收到 IOException，未验证主机名“www.marpel.cz”。我做错了什么？

我有一个 ICS 4.1.2 设备。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T14:19:55.277

首先，您使用自签名证书吗？

如果是，请点击此链接：[android-webservices-via-ksoap2-https](http://www.daniweb.com/software-development/mobile-development/threads/367301/android-webservices-via-ksoap2-https)

您需要额外的类来创建 https 连接和接受证书。一切准备就绪后，您可以调用您的`transportSE`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T15:14:33.353

我第一篇文章中的代码运行良好。我发现自签名证书是为不同的域颁发的。我修好了证书，一切正常。

固定证书在这里运行[https://www.marpel.cz:445/](https://www.marpel.cz:445/)

谢谢你，马丁。

# authentication - 为什么我的身份验证不起作用？（顶尖）

> ID：15005361
> 
> 赞同：1
> 
> 时间：2013-02-21T14:58:33.317
> 
> 标签：authentication, login, oracle-apex

我有一个功能来验证我的用户，这是因为我测试过它。

认证功能：

```
create or replace function authenticate(p_username in VARCHAR2, p_password in VARCHAR2) 
return BOOLEAN 
is 
  l_password varchar2(4000); 
  l_stored_password varchar2(4000); 
  l_count number; 
begin 
select count(*) into l_count from users where username = p_username; 
if l_count > 0 then 
  -- First, we fetch the stored hashed password
  select password into l_stored_password 
   from users where upper(username) = upper(p_username); 
    -- we have to apply the custom hash function to the password 
    l_password := custom_hash(p_username, p_password); 
    -- Finally, we compare them to see if they are the same and return
    -- either TRUE or FALSE
    if l_password = l_stored_password then 
      return true; 
    else 
      return false; 
    end if; 
else 
  -- The username provided is not in the users table
  return false; 
end if; 
end; 
```

然而我在 Apex 中的身份验证不起作用，我激活了身份验证方案并链接到身份验证功能。我正在使用顶点 4.2

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T22:40:51.697

这就是我的设置：

方案类型：自定义
认证函数名称：my_auth_func
来源：

```
FUNCTION my_auth_func (p_username IN VARCHAR2, p_password IN VARCHAR2)
RETURN BOOLEAN
IS
    is_authenticated BOOLEAN := FALSE;
BEGIN
    --authentication logic, etc...
    RETURN is_authenticated;
END 
```

# ruby-on-rails - 为什么 Rails 在开发模式下响应 public/assets/application.js 而不是 app/assets/javascripts/application.js？

> ID：15005368
> 
> 赞同：1
> 
> 时间：2013-02-21T14:58:49.347
> 
> 标签：ruby-on-rails, asset-pipeline, assets, sprockets

我在`turbo-sprockets`本地测试 gem 和预编译资产。从那以后总是用文件（不是）`localhost:3000/assets/application.js`响应。`public/assets/application.js``app/assets/javascripts/application.js`

解决方案是删除`public/assets`文件夹。这是正常行为吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-21T15:27:46.063

当您使用生产环境编译资产时，生成的资产将放入`public/assets`. 这是 Rails 搜索资产的第一个地方：如果您使用开发环境重新启动应用程序，资产已经存在，Rails 将不再在您的`app/assets`目录中搜索它们。

如[文档](http://guides.rubyonrails.org/asset_pipeline.html#asset-organization)中所述：“任何资产`public`都将由应用程序或 Web 服务器作为静态文件提供。”

你不应该在你的开发机器上预编译你的资产。

# git - 在钩子提交后执行 git 命令

> ID：15005369
> 
> 赞同：0
> 
> 时间：2013-02-21T14:58:53.523
> 
> 标签：git, shell, command, hook, post-commit

我有一个提交后挂钩。每次我提交我的回购协议时，我都想计算提交次数。我写 ：

```
#!/bin/sh
commit_number=$(git shortlog | grep -E '^[ ]+\w+' | wc -l)
echo "$commit_number" 
```

每个新的提交，终端都在打印 0 ...我不知道为什么。如果我在终端内提交后启动此命令，我的计数是正确的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T16:43:49.073

尝试做类似的事情：

```
cd ..
commit_number=$(env -i git shortlog | grep -E '^[ ]+\w+' | wc -l)
echo "$commit_number" 
```

# ios - 为什么这个 JSON 使用 NSJSONSerialization 无效？

> ID：15005371
> 
> 赞同：0
> 
> 时间：2013-02-21T14:58:56.350
> 
> 标签：ios, json

我是 JSON 新手，不明白为什么会失败。根据在线验证工具，JSON 是有效的，但是 NSJSONSerilization 说这个字符串是无效的。为什么无效？

```
NSString* JSON = @"{\"Questionnaire\":{\"questionnaireid\":1,\"modifiedDate\":\"2012-12-28 15:27:00\"}}";

if (![NSJSONSerialization isValidJSONObject:JSON]) {
  return nil;
}

NSError *jsonParsingError = nil;
NSDictionary* data = [NSJSONSerialization dataWithJSONObject:JSON options:NSJSONReadingMutableContainers error:&jsonParsingError]; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-21T15:03:52.303

为什么在您自己创建 JSON 时进行序列化？

你应该做什么：

```
NSData *jsonPayload = [JSON dataUsingEncoding:NSUTF8StringEncoding];
NSDictionary *data = [NSJSONSerialization JSONObjectWithData:jsonPayload
 options:kNilOptions error:&error]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-21T15:05:21.417

因为在传递 NSString 时，JSON 对象必须是 NSArray 或 NSDictionary 类型。

从[文档](http://developer.apple.com/library/ios/#documentation/Foundation/Reference/NSJSONSerialization_Class/Reference/Reference.html)：

> 可以转换为 JSON 的对象必须具有以下属性：
> 
> *   顶级对象是 NSArray 或 NSDictionary。
> *   所有对象都是 NSString、NSNumber、NSArray、NSDictionary 或 NSNull 的实例。
> *   所有字典键都是 NSString 的实例。
> *   数字不是 NaN 或无穷大。

**更新**

你可能想要这样做：

```
NSData *jsonData = [JSON dataUsingEncoding:NSUTF8StringEncoding];
NSDictionary *jsonDict = [NSJSONSerialization JSONObjectWithData:jsonData options:NSJSONReadingMutableContainers error:&err]; 
```

# visual-studio-2010 - VS 更新后恢复丢失的 Visual Studio 2010 解决方案

> ID：15005377
> 
> 赞同：1
> 
> 时间：2013-02-21T14:59:15.680
> 
> 标签：visual-studio-2010, projects-and-solutions

我花了几个小时在 Visual Studio 2010 (C#) 中构建了一个新的解决方案。创建了解决方案，构建和调试了很多次，使用 ctrl+S 定期保存... AutoRecover 也设置为每 5 分钟保存一次。

Windows 正在安装 VS 2010 更新并自动重新启动，强制关闭。

重新启动时，整个解决方案都消失了。我能找到的唯一痕迹是“备份”文件夹中带有解决方案名称的空文件夹和位于“ *C:\Users\USERNAME\AppData\Local\Microsoft\VCSExpress\10.0\ProjectAssemblies\fh5gnjqk01* ”中的 2 个早期构建think 是在构建失败时创建的。

是否有可能新文件仍然存在于某个临时文件夹或其他地方，或者我应该认为它丢失并继续前进？由于我构建并调试了解决方案，我怀疑在某个地方一定有一个更新的“.exe”，如果没有别的，我可以与反射器一起重用。

如果没有，以后我应该怎么做才能保证解决方案真的保存在磁盘上？

# wordpress - WordPress 元框保存不起作用

> ID：15005378
> 
> 赞同：1
> 
> 时间：2013-02-21T14:59:16.353
> 
> 标签：wordpress, wordpress-theming

我无法弄清楚为什么 events_price 和 events_location 没有保存而 events_startdate 是。我已经以各种方式对此进行了测试，但它仍然没有保存数据。

```
 function event_detail_box_content() {
    global $post;

    $custom = get_post_custom($post->ID);
    $meta_sd = $custom["events_startdate"][0];
    $meta_pr = isset( $custom['events_price'] ) ? esc_attr( $custom["events_price"][0]): ”;
    $meta_lo = $custom["events_location"][0];

    $meta_st = $meta_sd;

    $time_format = get_option('time_format');

    if ($meta_sd == null) { $meta_sd = time(); $meta_st = 0;}

    $clean_sd = date("D, M d, Y", $meta_sd);
    $clean_st = date($time_format, $meta_st);

    wp_nonce_field( 'my_meta_box_nonce', 'meta_box_nonce' ); 

    ?>
    <div class="tf-meta">
    <ul>
        <li><label>Event Date</label><input name="events_startdate" class="tfdate" value="<?php echo $clean_sd; ?>" /></li>
        <li><label>Event Time</label><input name="events_starttime" value="<?php echo $clean_st; ?>" /><em>Use 24h format (7pm = 19:00)</em></li>
        <li><label>Event Price</label><input name="events_price" value="<?php echo $meta_pr; ?>" /></li>
        <li><label>Event Location</label><input name="events_location" value="<?php echo $meta_lo; ?>" /></li>
    </ul>
    </div>
    <?php
    print_r($custom);
 }

  add_action ('save_post', 'save_events');

 function save_events($post_id){

    if ( !wp_verify_nonce( $_POST['meta_box_nonce'], 'my_meta_box_nonce' ) ) return; 

    if ( !current_user_can( 'edit_post')) return;

    if(!isset($_POST["events_startdate"])): return; endif;

    $updatestartd = strtotime ( $_POST["events_startdate"] . $_POST["events_starttime"] );

    update_post_meta($post_id, "events_startdate", $updatestartd ); 

    update_post_meta($post_id, "events_price",  $POST["events_price"] );  

    update_post_meta($post_id, "events_location", $POST["events_location"] ); 
 } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-21T15:17:00.617

您的`$_POST`变量缺少下划线

```
update_post_meta($post_id, "events_price",  $POST["events_price"] );  

update_post_meta($post_id, "events_location", $POST["events_location"] ); 
```

应该

```
update_post_meta($post_id, "events_price",  $_POST["events_price"] );  

update_post_meta($post_id, "events_location", $_POST["events_location"] ); 
```

# java - 无法使用JSF通过浏览器导入大文件（可能与使用JSF无关）

> ID：15005379
> 
> 赞同：0
> 
> 时间：2013-02-21T14:59:17.367
> 
> 标签：java, jsf, tomcat, file-upload

我目前正在做一个项目，我通过浏览器导入 CSV 文件，然后将该文件中包含的数据传输到数据库中。

我编写的代码适用于小文件，但事实证明该应用程序不适用于大文件（超过 200MB）。

导入.xhtml：

```
...
<t:panelGrid columns="2" styleClass="table_layout center" columnClasses="col_label,col_input">
    <t:outputLabel for="importFile" styleClass="required" value="#{messages.import_file}" />
    <t:inputFileUpload id="importFile" value="#{imports.csv}" required="true" />

    <t:panelGroup colspan="2" styleClass="center">
        <t:commandButton action="#{imports.import}" value="#{messages.import_action_import}" disabled="#{imports.state}" reRender="pnl" />
    </t:panelGroup>
</t:panelGrid>
... 
```

ImportBean.java

```
public String import() throws IOException {
        System.out.println("Entering import()");

            ...
            if (csv != null) {
                fileInputStream = csv.getInputStream();
            }
            final InputStream fileInputStreamF = fileInputStream;

            Runnable r = new Runnable() {

                public void run() {
                    System.out.println("Entering run()");
                    try {
                        System.out.println("Before entering importService.import(InputStream)");
                        importService.import(fileInputStreamF);
                    } catch (MyException e) {
                        ...
                    } catch (IOException e) {
                        // TODO Auto-generated catch block
                        e.printStackTrace();
                    }
            };
            System.out.println("Before running Thread");
            Thread thread = new Thread(r);
} 
```

因此，当我尝试上传一个小文件时，控制台会显示：

```
Entering import()
Before running Thread
Entering run()
Before entering importService.import(InputStream) 
```

但是当我尝试上传一个大文件时，控制台完全没有显示，这意味着（我相信）`ImportBean.import()`没有被调用。

对于这个项目，我使用 Java 5、JSF 1.1 和 Tomcat 5。我的猜测是我应该在 Tomcat 中配置一些东西，但我不确定。

有任何想法吗？

**编辑：**我试图`maxPostSize`在 Tomcat server.xml 中设置为 0，但它似乎没有做任何事情。我刚刚使用了数据包分析器（Wireshark），似乎文件正在上传大约一分钟然后停止。当它停止时，控制台上仍然没有任何东西......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T15:26:56.340

尝试增加`max-file-size`和`max-request-size`。`web.xml`重启tomcat，再次部署WAR文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T16:08:41.117

如果 max-file-size 和 max-request-size 不起作用，则问题可能是传输时间过长并且超过了浏览器超时。

我使用 struts 处理了一个类似的问题，解决它的唯一方法是让客户端将 csv 传输到一个 zip 文件中，然后我们解压缩并处理该文件。

我们的导入功能也需要一段时间来处理文件，因此我们必须将用户转发到定期检查导入状态的刷新页面。

# memory - 什么时候应该避免在 Clojure 中使用 `seq`？

> ID：15005380
> 
> 赞同：9
> 
> 时间：2013-02-21T14:59:25.153
> 
> 标签：memory, memory-management, clojure, garbage-collection

在[这个 SO thread](https://stackoverflow.com/questions/749911/how-can-i-leak-memory-in-clojure)中，我了解到`seq`在大型集合上保留对 a 的引用将防止整个集合被垃圾收集。

首先，该线程来自 2009 年。在“现代”Clojure（v1.4.0 或 v1.5.0）中仍然如此吗？

其次，这个问题是否也适用于惰性序列？例如，是否`(def s (drop 999 (seq (range 1000))))`允许垃圾收集器淘汰`999`序列的第一个元素？

最后，对于大型收藏品是否有解决此问题的好方法？换句话说，如果我有一个包含 1000 万个元素的向量，我是否可以以这样一种方式使用该向量，使得消耗的部分可以被垃圾收集？如果我有一个包含 1000 万个元素的哈希图呢？

我问的原因是我正在对相当大的数据集进行操作，并且我必须更加小心不要保留对对象的引用，以便可以对我不需要的对象进行垃圾收集。`java.lang.OutOfMemoryError: GC overhead limit exceeded`事实上，在某些情况下我会遇到错误。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-22T00:05:04.607

通常情况下，如果您“抓住序列的头部”，那么 Clojure 将被迫将所有内容保存在内存中。它没有选择：您仍然保留对它的引用。

然而，“达到 GC 开销限制”与内存不足错误不同——这更有可能表明您正在运行一个虚构的工作负载，该工作负载创建和丢弃对象的速度如此之快，以至于欺骗 GC 认为它超载。

看：

*   [超出 GC 开销限制](https://stackoverflow.com/questions/4371505/gc-overhead-limit-exceeded)

如果您对正在处理的项目施加实际工作量，我怀疑您会发现此错误不会再发生。在这种情况下，您可以轻松处理大于可用内存的惰性序列。

然而，像向量和哈希图这样的具体集合是另一回事：它们不是惰性的，因此必须始终完全保存在内存中。如果您的数据集大于内存，那么您的选择包括：

*   使用惰性序列，不要抓住头部
*   使用支持延迟加载的专用集合（我相信 Datomic 使用了一些这样的结构）
*   将数据视为事件流（使用 Storm 之类的东西）
*   编写自定义代码将数据分成块并一次处理一个。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T18:04:11.007

如果你在绑定中持有序列的头部，那么你是正确的，它不能被 gc'd （每个版本的 Clojure 都是如此）。如果你正在处理大量的结果，为什么你需要抓住头部？

至于解决方法，是的！lazy-seq 实现可以 gc 已经“处理”并且没有从绑定中直接引用的部分。只要确保你没有抓住序列的头部。

# apache - mod_rewrite 更改查询字符串参数名称

> ID：15005384
> 
> 赞同：4
> 
> 时间：2013-02-21T14:59:31.127
> 
> 标签：apache, mod-rewrite, url-rewriting, query-string, querystringparameter

我需要帮助编写一个 mod 重写规则来更改查询字符串参数的名称。我想更改名称，而不是值。

旧名`partner` 新名`a_aid`

所以像这样的链接

```
http://domain.com/?partner=derphipster&pname=foo&plink=http%3A%2F%2Fbar.com%2Ffoo 
```

会变成

```
http://domain.com/?a_aid=derphipster&pname=foo&plink=http%3A%2F%2Fbar.com%2Ffoo 
```

我找到了这篇文章，但接受的答案为 OP 生成了错误： [mod_rewrite - old parameter name to new name](https://stackoverflow.com/questions/569600/mod-rewrite-old-parameter-name-to-new-name)

还有这篇文章，但解决方案是使用 PHP。这在我的情况下不起作用： [APACHE mod_rewrite change variable name in query string](https://stackoverflow.com/questions/5451183/apache-mod-rewrite-change-variable-name-in-query-string)

我不能使用 PHP，因为一些附属跟踪代码会从查询字符串创建一个 cookie，并且需要 a_aid。所以我试图转换`partner`成`a_aid`它

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-21T15:21:52.137

好吧，我想我是自己破解的。如果您认为它易碎或可以做得更好，请发布答案，我会接受您的

```
RewriteCond %{QUERY_STRING} ^(.*)partner(.*)$
RewriteRule ^(.*)$ $1?%1a_aid%2 [R=301,L] 
```

# sencha-touch-2 - pullRefresh 插件在商店中追加新记录时不起作用，sencha-touch 2

> ID：15005385
> 
> 赞同：0
> 
> 时间：2013-02-21T14:59:34.847
> 
> 标签：sencha-touch-2

我正在使用 sencha touch 2 并处理连接到商店的列表。该商店包含来自 google places API 的位置。我在列表中集成了分页。每当加载来自谷歌位置的新页面时，新记录就会附加到商店并呈现在列表中。到目前为止效果很好。我想将 pullRefresh 插件添加到列表中。在第一页上，pullRefresh 插件工作。refreshFn 被调用，一切正常。但是当一个新页面被加载并且新记录被追加到存储中时，refreshFn 永远不会被调用。你有什么线索吗？

# jquery - jquery 图像库在任何 li 上花费 cliking

> ID：15005389
> 
> 赞同：0
> 
> 时间：2013-02-21T14:59:46.443
> 
> 标签：jquery, gallery, bind

请帮忙。我有一个图片库，我想扩展每个缩略图以显示全长图像，然后单击它返回到其原始大小。请提供一些jquery代码的建议。谢谢你。

```
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Untitled Document</title>
<script type="text/javascript" src="js/jquery-1.9.0.min.js"></script>
<script>
$(document).ready(function(e) {

$('#wrapper ul li').bind('click', function () {
    $(this).removeClass();
    $(this).fadeIn(500).addClass("applyclass");});

});
</script>
<style>
html, body{margin:0; padding:0; width:100%; height:100%}
#wrapper{background:#0CC; margin:0 auto 0 auto}
#wrapper ul{list-style:none; margin:0 auto 0 auto; padding:0; width:960px;}
#wrapper ul li{display:inline-block; width:227px; height:180px; background:#FC3; margin:5px;}
#wrapper ul li.applyclass{display:block; width:960px; height:300px}
#wrapper ul li.removeclass{display:inline-block; width:227px; height:180px}
</style>
</head>

<body>
<div id="wrapper">
<ul>
    <li>1</li>
    <li>2</li>
    <li>3</li>
    <li>4</li>
    <li>5</li>
    <li>6</li>
    <li>7</li>
    <li>8</li>
    <li>9</li>
</ul>
</div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T15:10:05.540

试试这个脚本，

```
$(document).ready(function() {

    $('#wrapper ul li').click(function () {
       if($(this).hasClass("applyclass"))
          $(this).removeClass("applyclass");   
       else
          $(this).fadeIn(500).addClass("applyclass");
    });

}); 
```

演示：http: [//jsfiddle.net/8TchT/1/](http://jsfiddle.net/8TchT/1/)

**更新** 此代码将`li`通过单击其他`li`的来减小

```
$(document).ready(function() {

    $('#wrapper ul li').click(function () {
          $('#wrapper ul li').removeClass("applyclass");
          $(this).fadeIn(500).addClass("applyclass");

    });

}); 
```

演示：http: [//jsfiddle.net/8TchT/3/](http://jsfiddle.net/8TchT/3/)

# jquery - 悬停上的 nivo 滑块显示上一个和下一个按钮

> ID：15005390
> 
> 赞同：0
> 
> 时间：2013-02-21T14:59:46.473
> 
> 标签：jquery, slider, nivo-slider

任何人都可以帮我解决这个问题。接下来有没有办法显示 Nivo Slider。和上一个。仅当鼠标悬停在幻灯片上时按钮？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T15:02:20.797

你可以为此使用一些 CSS。如果没有一些示例代码，我不知道确切的元素，但本质是这样的：

```
<div class="parent">
    <div> <!--STUFF--></div>
    <div class="navigation-links"><!--LINKS--></div>
</div> 
```

对于上述简单的标记，只需使用以下 CSS：

```
.parent .navigation-links { display:none; }
.parent:hover .navigation-links { display:block; } 
```

你应该有预期的效果。

# google-app-engine - 如何防止 ndb 批处理 put_async() 调用并使其立即发出 RPC？

> ID：15005393
> 
> 赞同：5
> 
> 时间：2013-02-21T14:59:51.230
> 
> 标签：google-app-engine, app-engine-ndb

我有一个更新实体的请求处理程序，将其保存到数据存储区，然后需要在返回之前执行一些额外的工作（比如排队后台任务和 json 序列化一些结果）。我想并行化这段代码，以便在保存实体的同时完成额外的工作。

这是我的处理程序代码归结为：

```
class FooHandler(webapp2.RequestHandler):
    @ndb.toplevel
    def post(self):
        foo = yield Foo.get_by_id_async(some_id)

        # Do some work with foo

        # Don't yield, as I want to perform the code that follows
        # while foo is being saved to the datastore.
        # I'm in a toplevel, so the handler will not exit as long as
        # this async request is not finished.
        foo.put_async()

        taskqueue.add(...)
        json_result = generate_result()
        self.response.headers["Content-Type"] = "application/json; charset=UTF-8"
        self.response.write(json_result) 
```

但是，Appstats 显示`datastore.Put`RPC 正在串行完成，之后`taskqueue.Add`：

![应用统计截图](../Images/66225259f2c864cff24abcecee05f15d.png)

稍微挖掘一下，`ndb.context.py`就会发现`put_async()`调用最终被添加到 an中，`AutoBatcher`而不是立即发出 RPC。

所以我认为当等待所有异步调用完成`_put_batcher`时，最终会被刷新。`toplevel`

我知道批处理 put 在某些情况下确实有好处，但在我的情况下，我真的希望立即发送 put RPC，这样我就可以在保存实体的同时执行其他工作。

如果我这样做`yield foo.put_async()`了，那么我会在 Appstats 中得到相同的瀑布，但`datastore.Put`在其余部分之前完成：

![第二个 Appstats 截图](../Images/26d4da6a2cc9f2987210d0ff8f9c802e.png)

这是意料之中的，因为让我的处理程序在执行其余代码之前`yield`等待调用完成。`put_async()`

我也尝试过`ndb.get_context().flush()`在之后添加一个调用`foo.put_async()`，但是根据 Appstats 仍然没有并行进行`datastore.Put`and调用。`taskqueue.BulkAdd`

所以我的问题是：如何强制调用`put_async()`绕过自动批处理器并立即发出 RPC？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-22T15:58:57.850

没有支持的方式来做到这一点。也许应该有。如果这行得通，你可以试试吗？

```
loop - ndb.eventloop.get_event_loop()
while loop.run_idle():
    pass 
```

您可能需要查看 ndb/eventloop.py 的源代码以了解您还可以尝试什么——基本上您想尝试 run0() 的大部分功能，除了等待 RPC。特别是，您可能必须这样做：

```
while loop.current:
    loop.run0()
while loop.run_idle():
    pass 
```

（这仍然不受支持，因为您可能还必须处理其他条件，但在您的示例中似乎没有出现这些情况。）

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-02-21T17:24:10.920

试试这个，我不是 100% 肯定它会有所帮助：

```
foo = yield Foo.get_by_id_async(some_id)
future = foo.put_async()
future.done() 
```

ndb 请求被放入自动批处理器，当您需要结果时，批处理被发送到 RPC。由于您不需要 foo.put_async() 的结果，因此在您进行另一个 ndb 调用（您不需要）或直到 @ndb.toplevel 结束之前，它不会被发送。

调用 future.done() 不会阻塞，但我猜它可能会触发请求。

尝试强制操作的另一件事是：

```
ndb.get_context().flush() 
```

# objective-c - NSTableView 并非所有数据源方法都在调用

> ID：15005394
> 
> 赞同：0
> 
> 时间：2013-02-21T14:59:52.103
> 
> 标签：objective-c, osx-lion, nstableview

我以编程方式创建了一个表格视图并成功添加了列、委托和数据源。但问题是只有一种数据源方法被调用，即

```
-(NSInteger)numberOfRowsInTableView:(NSTableView *)tableView 
```

正如这里提出的问题： [NSTableView: only numberOfRowsInTableView: datasource is called](https://stackoverflow.com/questions/12245113/nstableview-only-numberofrowsintableview-datasource-is-called)

但是这个问题没有具体的答案。

这是我创建 TableView 的代码：

```
customTableView=[[NSTableView alloc]initWithFrame:frame];
[customTableView setBackgroundColor:[NSColor redColor]];
customTableView.delegate=self;
customTableView.dataSource=self;
NSTableColumn * column1 = [[NSTableColumn alloc] initWithIdentifier:@"Col1"];
[column1 setWidth:frame.size.width];
[customTableView addTableColumn:column1];
[self addSubView:customTableView];
[customTableView reloadData]; 
```

此外，我所有的数据源方法都在同一个类中。

编辑：我在一个单独的视图类中创建这个 TableView，而不是在 ViewController 或 AppDelegate 中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T15:06:49.093

我猜你已经在`init`.

尝试移动`setDatasource`&`setDelegate`到`awakeFromNib`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T15:31:07.617

我认为您缺少将表格视图作为子视图添加到窗口的代码。

假设您在其中创建表视图的对象具有`window`属性。以下方法可以解决问题：

```
[[self.window contentView] addSubview:customTableView]; 
```

# css - 相对定位元素内的绝对定位无法正常工作

> ID：15005398
> 
> 赞同：0
> 
> 时间：2013-02-21T14:59:55.707
> 
> 标签：css

我可能在这里遗漏了一些明显的东西，但这让我发疯了。

有问题的[页面是这个测试站点的主页](http://searchanddevelop.ca/adv/)。

*   header id 是相对定位的，我试图在其中绝对定位元素（两个人的照片和这些照片旁边的文字，#bodyad1 和#bodyad2）。

*   问题是，他们拒绝工作并最终被绝对定位在#header*之外*，相对于身体。

奇怪的是我已经将另一个元素绝对定位在标题内并且它可以工作（丝带的照片）。但是，当我插入其他两个元素时，标题会中断：所有标题内容都会移动到页面底部。

有什么想法吗？

```
<div id="bodyad1">
    <img src="images/person1.png" alt="">
    <div id="bodyad1-text">
        <h3>—Featured Story—&lt;/h3>
        <p>John Smith</p>
        <h2>Toronto Criminal Lawyer</h2>
</div>

<div id="bodyad2">
    <img src="images/person2.png" alt="">
    <div id="bodyad2-text">
        <h3>—Featured Story—&lt;/h3>
        <p>John Smith</p>
        <h2>Toronto Criminal Lawyer</h2>
    </div>
</div>

<div id="adlogo">
    <img src="images/advocatedaily-logo.png" alt="Advocate Daily dot com Logo">
    <h2>Ontario's Legal News</h2>
</div>
 <div id="adsash"></div>

<div class="clear"></div> 
```

CSS（是的，我知道我可以让我的样式更简洁）

```
/*header*/
#header {
  display: block;
  border-bottom: 1px solid #9e0505;
  position: relative;
}
/*   Featured Lawyer Body Shots   */

#bodyad1 {
    display:block;
    position: absolute;
    width: 220px;
    height: 94px;
    bottom: 0px;
    left: 60px;
}

#bodyad2 {
    display:block;
    position: absolute;
    width: 220px;
    height: 94px;
    bottom: 0px;
    right: 60px;

}

#bodyad1 img{
    float:right;
    display:block;
}

#bodyad1-text {
    height:94px;
    float:right;
}

#bodyad1-text  h3 {
    font: italic 10px helvetica, arial, sans-serif;
    color: #666;
    text-align: right;
}

#bodyad1-text  p {
    font: normal bold 11px helvetica, arial, sans-serif;
    text-transform: uppercase;
    color: #cd1713;
    text-align: right;
}

#bodyad1-text  h2 {
    font: normal bold 11px helvetica, arial, sans-serif;
    color: #666;
    text-align: right;
}

#bodyad2 img {
    float:left;
    display:block;
}

#bodyad2-text {
    height: 94px;
    float: left;
}

#bodyad2-text  h3 {
    font: italic 10px helvetica, arial, sans-serif;
    color: #666;
    text-align: left;
}

#bodyad2-text  p {
    font: normal bold 11px helvetica, arial, sans-serif;
    text-transform: uppercase;
    color: #cd1713;
    text-align: left;
}

#bodyad2-text  h2 {
    font: normal bold 11px helvetica, arial, sans-serif;
    color: #666;
    text-align: left;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T15:14:27.500

原来我错过了一个结束 div 标签，但由于我的缩进风格，我让它看起来确实关闭了它。

很荒谬的事情要发布。继续。

谢谢@pebbl。

# ravendb - RavenDB- 构建会话工厂，单例 DocumentStore

> ID：15005403
> 
> 赞同：0
> 
> 时间：2013-02-21T15:00:07.147
> 
> 标签：ravendb

我是 RavenDb 的新手。我已经像下面的代码一样构建了 RavenDB 会话工厂。这个想法很大程度上来自我们构建 NHibernateSessionHelpers 的方式。我希望这应该在生产中很好地工作。RavenDB 专家有什么建议可以改善这一点吗？

```
public class MXRavenDbSessionHelper
{        
    //---All new lazy singleton that's thread safe.---        
    private static Lazy<IDocumentStore> _lazyDocStore = new Lazy<IDocumentStore>(() => InitializeSessionFactory());

    private MXRavenDbSessionHelper() { }

    private static IDocumentStore SessionFactory
    {
        get
        {
            return _lazyDocStore.Value;
        }
    }

    public static IDocumentSession OpenSession()
    {
        return SessionFactory.OpenSession();
    }

    private static IDocumentStore InitializeSessionFactory()
    {
        var _docStore = new DocumentStore { ConnectionStringName = "RavenDBConnString", DefaultDatabase = "MXMunky" }; //One more way is this : _store = new DocumentStore { Url = "http://localhost:7000" };
        _docStore.Initialize();            
        _docStore.Conventions.IdentityPartsSeparator = "-";
        IndexCreation.CreateIndexes(typeof(Location).Assembly, _docStore);

        return _docStore;
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-21T21:16:36.157

我认为你不需要`_docStore`单独保存。请参阅[Jon Skeet 的单例模式](http://csharpindepth.com/Articles/General/Singleton.aspx)(#6)。

除此之外，我看不出有什么特别的问题。

我会小心不要在单元测试时使用它。在那里，您实际上*确实*需要为每个测试创建一个新的 docstore 实例——并且应该正确处理它们。

# php - 使用 PHP 从 div 类中提取所有内容（包括 HTML）

> ID：15005406
> 
> 赞同：2
> 
> 时间：2013-02-21T15:00:16.973
> 
> 标签：php, dom, extract

示例 HTML...

```
<html>
<head></head>
<body>
<table>
<tr>
    <td class="rsheader"><b>Header Content</b></td>
</tr>
<tr>
    <td class="rstext">Some text (Most likely will contain lots of HTML</td>
</tr>
</table>
</body>
</html> 
```

我需要将 HTML 页面转换为该 HTML 页面的模板版本。HTML 页面由几个框组成，每个框都有一个标题（在上面的代码中称为“rsheader”）和一些文本（在上面的代码中称为“rstext”）。

我正在尝试编写一个 PHP 脚本来检索可能使用 file_get_contents 的 HTML 页面，然后提取 rsheader 和 rstext div 中的任何内容。基本上我不知道怎么做！我尝试过使用 DOM，但我不太了解它，虽然我确实设法提取了文本，但它忽略了任何 HTML。

我的PHP...

```
<?php

$html = '<html>
<head></head>
<body>
<table>
<tr>
    <td class="rsheader"><b>Header Content</b></td>
</tr>
<tr>
    <td class="rstext">Some text (Most likely will contain lots of HTML</td>
</tr>
</table>
</body>
</html>';

$dom = new DomDocument();
$dom->loadHtml($html);
$xpath = new DomXpath($dom);
$div = $xpath->query('//*[@class="rsheader"]')->item(0);
echo $div->textContent;

?> 
```

如果我做一个 print_r($div) 我会看到这个......

```
DOMElement Object
    (
    [tagName] => td
    [schemaTypeInfo] => 
    [nodeName] => td
    [nodeValue] => Header Content
    [nodeType] => 1
    [parentNode] => (object value omitted)
    [childNodes] => (object value omitted)
    [firstChild] => (object value omitted)
    [lastChild] => (object value omitted)
    [previousSibling] => 
    [nextSibling] => (object value omitted)
    [attributes] => (object value omitted)
    [ownerDocument] => (object value omitted)
    [namespaceURI] => 
    [prefix] => 
    [localName] => td
    [baseURI] => 
    [textContent] => Header Content
    ) 
```

如您所见， textContent 节点中没有 HTML 标记，这让我相信我的做法是错误的 :(

真的希望有人可以给我一些帮助...

提前致谢

保罗

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-21T15:18:34.123

X-Path 可能比您执行此任务所需的更多。我会尝试改用 DOMDocument 的[getElementById() 方法](http://www.php.net/manual/en/domdocument.getelementbyid.php)。下面是一个例子，改编自[这篇文章](http://www.codekites.com/php-tutorial-parsing-html-with-domdocument/)。

注意：更新为使用标签和类名而不是元素 ID。

```
function getChildHtml( $node ) 
{
    $innerHtml= '';
    $children = $node->childNodes;

    foreach( $children as $child )
    {
        $innerHtml .= sprintf( '%s%s', $innerHtml, $child->ownerDocument->saveXML( $child ) );
    }

    return $innerHtml;
}

$dom = new DomDocument();
$dom->loadHtml( $html );

// Gather all table cells in the document.
$cells = $dom->getElementsByTagName( 'td' );

// Loop through the collected table cells looking for those of class 'rsheader' or 'rstext'.
foreach( $cells as $cell )
{
    if( $cell->getAttribute( 'class' ) == 'rsheader' )
    {
        $headerHtml = getChildHtml( $cell );
        // Do something with header html.
    }

    if( $cell->getAttribute( 'class' ) == 'rstext' )
    {
        $textHtml = getChildHtml( $cell );
        // Do something with text html.
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T15:14:50.823

查看此答案并将其用作指南： [从网站检索特定数据](https://stackoverflow.com/questions/12746579/retrieving-specific-data-from-a-website/12746602#12746602)

如果您需要详细的帮助，我在这里为您提供帮助。

# asp.net - Windows 身份验证当前用户模拟 401 未经授权

> ID：15005409
> 
> 赞同：3
> 
> 时间：2013-02-21T15:00:22.400
> 
> 标签：asp.net, asp.net-mvc, iis-7, windows-server-2008

我有一个发布 RSS 提要的 Intranet，我正在尝试从 Windows 域环境中的同一 IIS 服务器上托管的另一个 Intranet 站点使用该 RSS 提要。

两个网站都有

```
<authentication mode="Windows"> 
```

并且匿名身份验证被禁用。

在本地开发（Windows Auth 但不在域上）以下工作：

```
var request = HttpWebRequest.Create(feedUrl);
request.Credentials = CredentialCache.DefaultNetworkCredentials;

XElement f;
using (var response = request.GetResponse())
{
     var reader = new XmlTextReader(response.GetResponseStream()); 
     f = XElement.Load(reader);
}
return f; 
```

但是，当我将其部署到生产环境（Windows 2008）时，我得到一个 401 Unauthorized 异常。以域用户身份登录时，我可以在浏览器中毫无问题地查看 RSS 提要，但是当尝试通过代码访问它时，它似乎没有经过身份验证。

我也试过：

```
request.Credentials = New System.Net.NetworkCredential("myUser","myPass","myDomain"); 
```

但仍然是 401 Unauthorized。任何人都可以就我忽略的内容提供想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T21:40:25.120

When you are running locally in VS, `CredentialCache.DefaultNetworkCredentials` will get your username, whereas when you have this client running on a web server this will return the account used to execute your application under. This is usually a NetworkService account local to your web server. That's why when you attempt to use this client to authenticate against the remote service you are getting 401\. So you could configure your ASP.NET MVC client application to execute under a domain account which has permissions to access the remote service. This could be done in the advance properties of the Application Pool in the IIS manager.

# mysql - 从 sqlserver 迁移到 mysql 的数据库似乎在 rails 有错误

> ID：15005412
> 
> 赞同：0
> 
> 时间：2013-02-21T15:00:24.990
> 
> 标签：mysql, ruby-on-rails, ruby, sql-server, ruby-on-rails-2

我已经完成了将数据库从 sqlserver 迁移到 mysql，但它似乎在 rails 中有问题。当我在 Rails 控制台中获取记录时，例如：

```
 <AuthAdmin:0xb6e506f8 @attributes={"Status"=>"1", "LastUpdateSeqNo"=>nil, "CreationDate"=>"2005-08-03 22:53:57", "AuthAdminID"=>"8987", "PropertyID"=>nil, "Password"=>"trustbss", "LastUpdate"=>"2012-07-12 05:15:02", "UserType"=>"0", "LoginName"=>"dev"} 
```

现在，CreationDate 和 AuthAdminID 等属性假设为日期和整数显示为字符串。但是当我这样做时

```
 AuthAdmin.find(:first).AuthAdminID.class output is Fixnum 
```

您可以检查上面给出的记录，它显示字符串。现在，当我在我的视图中进行算术运算时，无法将问题字符串强制转换为 Fixnum。将所有内容显式更改为自己的 TYPE 是一个非常糟糕的主意。

希望能解释我的问题。看起来没有人遇到过这个问题。

# javascript - how to make an Angular.js app offline with server sync when available

> ID：15005419
> 
> 赞同：32
> 
> 时间：2013-02-21T15:00:44.387
> 
> 标签：javascript, html, angularjs, offline, breeze

I'm looking for an approach or a library that handles this. the idea is to store data in localstorage and sync to the backend when a connection is available, [http://pouchdb.com/](http://pouchdb.com/) looks like a cool solution but anyone has use it on production?

**UPDATE:**

Right now you can also use:

*   [MeteorJS + Angular](https://www.meteor.com/)
*   [Firebase](https://firebase.google.com/)
*   [Parse](https://github.com/ParsePlatform/parse-server)
*   [Horizon](http://horizon.io)

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-19T13:55:31.207

Haven't used it yet, but familiar w/ the concepts behind BreezeJS from their other offerings in .NET. Check it out [http://www.breezejs.com/](http://www.breezejs.com/) and here's Ward Bell presenting it to the Googlers [http://www.youtube.com/watch?v=P2ErSQj3SN8&feature=player_profilepage](http://www.youtube.com/watch?v=P2ErSQj3SN8&feature=player_profilepage)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-19T15:41:31.457

you can also take a look at jaydata [http://jaydata.org/blog/synchronized-online-offline-data-applications-part-2-syncing-large-tables-and-tables-with-foreign-relations](http://jaydata.org/blog/synchronized-online-offline-data-applications-part-2-syncing-large-tables-and-tables-with-foreign-relations)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2014-07-05T09:13:08.600

breezejs is not a sync solution! if server data changes what happen in local data if some recordes deleted on server after last update local data must sync after a method called sync in other word some date must come back to client after calling savechange that tell client db to be sync with server

# jquery - 如何在带有标题标签的主 DIV 中显示所有嵌套 DIV？

> ID：15005426
> 
> 赞同：5
> 
> 时间：2013-02-21T15:00:54.583
> 
> 标签：jquery, html

我的主div`div`和`title="apple"`嵌套 div 没有标题标签。当我编写代码以显示带有`"apple"`标题的主 div 时，只显示主标题`div`，嵌套的 div 不会显示。即使没有标题标签，如何显示所有子 div？这是下面的代码。

```
<div title="apple">
  <div>Hi..</div>
</div> 
```

和 jQuery

```
$('input#showapple').click(function(){
  $("div *[title='apple']").show(2000);
});

$('input#hideapple').click(function(){
  $("div *[title='apple']").hide(2000);
}); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-21T15:09:20.843

你可以同时使用`toggle` **加上**你不需要`input`在按 ID 选择时指定参数，jQuery**只会返回 ID 上的第一个匹配元素**（因为应该只有一个）：

```
$('#showapple, #hideapple').click(function(){
    $("div[title='apple'] > div").toggle(2000);
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T15:02:35.897

Try:

```
$('input#showapple').click(function(){
   $("div[title='apple'] > div").show(2000);
}); 
```

You will select all the div with title apple and any child div's within it.

[http://jsfiddle.net/rpZbL/](http://jsfiddle.net/rpZbL/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-21T15:03:24.133

your selector seems to be a little bit off

```
$('input#showapple').click(function(){
    $("div[title=apple]").show(2000);
}); 
```

also, you should really be using classes for this and not the title.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-21T15:01:41.337

```
<div id="apple"> 
```

您使用属性 ID 而不是标题选择元素。

# javascript - 可以导出 KineticJS 完整层

> ID：15005427
> 
> 赞同：0
> 
> 时间：2013-02-21T15:01:00.077
> 
> 标签：javascript, kineticjs

有谁知道是否有办法“导出”整个 KineticJS 层（或组），而不仅仅是可见画布中的部分？

我有一个简单的“图像编辑器”，允许用户在画布中缩放图像，可以故意将图像缩放到大于可见的画布舞台区域，从而允许用户将图像部分平移到视图中。问题是，当他们来导出图像时（当前使用 toDataURL），只有可见画布阶段中的图像部分被保存，图像的其余部分被丢弃！

我实际上想保存整个图层，而不仅仅是在可见画布阶段呈现的内容。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T17:10:35.743

好吧，您需要一个临时的解决方法。

我假设您有一个函数或执行 .toDataURL() 的函数。

在执行 toDataURL() 之前，更改舞台大小或比例，然后保存，然后再更改回来。

例子：

```
 function save(){
     stage.setScale(newX,newY); //rescale to new values
     stage.setWidth(newWidth);
     stage.setHeight(newHeight);

     stage.toDataURL();   // <----- save

     stage.setScale(oldX,oldY); //rescale to old values
     stage.setWidth(oldWidth);
     stage.setHeight(oldHeight);
 } 
```

这将调整您的舞台大小或重新缩放，然后将其放回原样。

# asp.net-mvc - 使用 Redirect() 时将信息传递回视图

> ID：15005434
> 
> 赞同：3
> 
> 时间：2013-02-21T15:01:18.893
> 
> 标签：asp.net-mvc, asp.net-mvc-3, asp.net-mvc-4, tempdata

我从多个页面调用控制器并使用`returnUrl`参数返回正确的调用位置：

```
public ActionResult EmailOrder(int id, string returnUrl)
{
    var message = "The order has been emailed";
    if (!string.IsNullOrEmpty(returnUrl)) return Redirect(returnUrl);
    return RedirectToAction("Details", new { id, message });
} 
```

使用时如何将附加信息传递回视图`Redirect(url)`？在上面的示例中，我希望能够在有值`message`时回传。`returnUrl`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-21T15:27:37.627

如果您正在重定向到另一个操作方法并且您想要传递可以在新操作方法中访问的数据，您应该使用 ASP.MVC 控制器的 TempData 属性。您可以按如下方式使用它：

```
[HttpPost]
public ActionResult MyActionMethod(Order order) 
{
    // write your logic here to save the Order
    TempData["message"] = "here is some message";
     return RedirectToAction("Index");
} 
```

TempData 成员中的数据将通过重定向保留。它将在重定向页面中访问，然后将被删除。一旦您读取了 TempData 中的条目，它将被标记为删除。

```
public ActionResult RedirectedMethod() 
{
    //Retrieve data from TempData.  It will then be marked for deletion
    var data = TempData["message"].ToString();
} 
```

如果您想获取一个值而不将其标记为删除，您可以使用“Peek”方法：

```
var data = TempData.Peek("message") 
```

此外，您可以手动保留一个值，否则将使用“保持”方法删除该值：

```
TempData.Keep("message") 
```

TempData 属于 TempDataDictionary[类型](http://msdn.microsoft.com/en-us/library/system.web.mvc.tempdatadictionary%28v=vs.98%29.aspx)。

请注意，TempData 在后台使用 ASP.Net 会话状态，因此如果您使用的是 TempData，则必须打开会话状态。

有关 TempData 的更多信息，请参见[此处](http://www.devcurry.com/2012/05/what-is-aspnet-mvc-tempdata.html)。

# ffmpeg - 使用 ffmpeg 解码 H.264 帧时出错

> ID：15005436
> 
> 赞同：42
> 
> 时间：2013-02-21T15:01:35.627
> 
> 标签：ffmpeg, h.264

解码从基于 H.264 的 SIP 视频呼叫的远程端接收的 H.264 帧时，出现以下错误。感谢任何帮助理解那里的错误。

```
non-existing PPS 0 referenced
decode_slice_header error
non-existing PPS 0 referenced
decode_slice_header error
no frame!

non-existing PPS 0 referenced
decode_slice_header error
non-existing PPS 0 referenced
decode_slice_header error
no frame! 
```

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2013-02-21T20:08:42.007

那只是意味着 ffmpeg 还没有看到一个关键帧，其中包含 SPS 和 PPS 信息。SPS 和 PPS 在解码传入的帧/片时至关重要。定期发送关键帧（即每 5-10 秒或更长时间）；因此，如果事实证明您在关键帧到达之前加入了流；在关键帧出现之前，您将在每一帧看到此警告。

一旦关键帧从线路中显示出来，ffmpeg 将有足够的信息来解码该帧（以及直到下一个关键帧之前的任何后续帧），因此这些警告将消失。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-08-11T06:53:56.813

你需要添加帧**sps**和**pps**信息。ffmpeg 需要这些信息来进行解码。您可以在 SDP 文件中找到这些值。

在 SDP 文件中，您应该查看 NAL 单元，您可以看到类似 z0IAHukCwS1xIADbugAzf5GdyGQl、aM4xUg

这些值基于 64 编码，您应该将其转换为十六进制格式。我正在使用 wireshark，wireshark 会为你自己转换这些值。之后，您将获得 sps 和 pps 值。

现在您必须在数据框之前添加这些 Nal 信息。

00 00 00 01 sps 00 00 00 01 pps 00 00 00 01 数据

对于 h264 这些格式我一直用来解码。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-21T16:32:17.623

解码一个帧或一个切片，`sliceHeader`就是解码，它指的是一个PPS或“图片参数集”。它包含有关框架细节的信息，如宽度、高度等。

我猜您的数据来自流输入通道，在这种情况下，SPS 和 PPS 将在流中较早发送。

您可能必须将其连接到您的流中。

# spring-mvc - @RequestParam 自定义对象

> ID：15005438
> 
> 赞同：3
> 
> 时间：2013-02-21T15:01:39.667
> 
> 标签：spring-mvc

我在我的应用程序中使用 Spring MVC 3.1。假设我在控制器中有一个方法如下：

```
@RequestMapping(value = "/assignUser", method = RequestMethod.GET)
public String assignUserToCompany(ModelMap map){
    List<CompanyDetails> companies = //companies list from DAO
    List<UserDetails> users = //users list from DAO
    map.addAttribute("companiesList",companies);
    map.addAttribute("usersList",users);
    return "someView";
}

@RequestMapping(value = "/assignUser", method = RequestMethod.POST)
    public String assignUserToCompany(@RequestParam("user")UserDetails user,
                                      @RequestParam("company")CompanyDetails company){

    if(user!=null && company!=null){
      // some operations with entities
    }

    return "someView";
    } 
```

我在视图方面有一个表格：

```
<form method="post" action="assignUser.html">
        <label for="select-users"><spring:message code="assignUser.label.users"/> </label>
        <select id="select-users" name="user">
            <c:forEach items="${usersList}" var="user">
                <option value="${user}">${user.firstName} ${user.legalName}</option>
            </c:forEach>
        </select>
        <label for="select-companies"><spring:message code="assignUser.label.companies"/> </label>
        <select id="select-companies" name="company">
            <c:forEach items="${companiesList}" var="company">
                <option value="${company}">${company.name}</option>
            </c:forEach>
        </select>
        <input type="submit" value="<spring:message code="assignUser.label.submit"/>"/>
    </form> 
```

我想将我在输入中选择的对象作为请求参数传递并使用它们执行一些操作，但标准 @RequestParam 只允许我们知道原始类型和包装器。我可以自定义它以传递我的对象吗？谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-21T15:04:58.760

如果 pojo 直接与表单相关，请在您的 jsp 中声明一个 spring 表单（假设您的 DTO 有一个属性名称......

```
 <form:form id="yourForm" commandName="yourDTO" action="Save" method="POST">
 <form:input path="name" maxlength="90" cssStyle="width: 650px;" id="name"/> 
```

和你的控制器：

```
@RequestMapping(value = "/Save", method = RequestMethod.POST)
public ModelAndView save(final yourDTO yourDTO) { 
```

或者，如果将一个字段转换为复杂的类，您将必须提供转换服务：

```
@Component
public class FooConverter implements Converter<String, Foo> {
    @Override public Foo convert(String source) {
        //do covnersion from string to Foo
        Foo foo = new Foo(source)
        return Foo;
    }
} 
```

并注册

```
<bean id="conversionService"
          class="org.springframework.context.support.ConversionServiceFactoryBean">
        <property name="converters">
            <set>
                <bean class="com.yourcompany.controller.converters.FooConverter"/>
            </set>
        </property>
    </bean> 
```

# ios - 如何隐藏故事板上的pickerview？

> ID：15005439
> 
> 赞同：0
> 
> 时间：2013-02-21T15:01:41.010
> 
> 标签：ios, objective-c, hide, uipickerview

我在我的 iphone 应用程序中使用了 UIpicker，它填满了我的一半屏幕，无法正确设计我的界面。

我见过类似的问题，但我需要将其隐藏在故事板/xib 上，而不是在应用加载时。

Xcode 在属性面板中提供了一个隐藏选项，但它只是将其变灰，并且仍然可以点击，因此它不能解决问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T15:04:19.470

如果您以编程方式添加它可能会更好......

检查这个：[http ://cocoamatic.blogspot.com/2010/08/create-uipickerview-programmatically.html](http://cocoamatic.blogspot.com/2010/08/create-uipickerview-programmatically.html)

# javascript - Jquery 不正确的子编号 XML 解析器

> ID：15005441
> 
> 赞同：0
> 
> 时间：2013-02-21T15:01:43.777
> 
> 标签：javascript, jquery

最近我在使用 Jquery 在 JavaScript 中编写一个小型 XML 解析器时遇到了问题。我用于完成此任务的代码如下：

```
 /*Private */
 var XMLObject=$.parseXML(dataXml);
 var $XMLObject=$(XMLObject); 

 var questionNumber=0;
 // array of XML objects 
 var questionsXML= new Array();

 /** Html questions */ 
 //array of strings
 var questionsHTML= new Array();
 /*********************
  * Constructor       *
  *********************/

 a=$XMLObject.find("questions"); 
 a.children().each( function () {
     console.log( "XML : " +  new XMLSerializer().serializeToString(this));
     questionsXML[questionNumber]=this;
     questionNumber++; 
 });

this.getXML=function () {
    var out = new XMLSerializer().serializeToString(this.XMLObject);
    return out;
}

this.getQuestionNumber=function() { 
    return questionNumber; 
}

// This function returns the question sequentially. 
this.getQuestion=function() { 
}

Test function  :

    function testXML () { 
        var xml ="XML see later"
        var Obj= new XMLQuestions(xml); 
        console.log("Question Number: " + Obj.getQuestionNumber());
    } 
```

我不明白为什么返回的子节点数应该是 2 时是 3。正如 Jquery 文档中所述，子函数应该只检查 XML 树的第一级。

用作测试的 XML 如下：

```
<questionnaire>
  <questions>
      <question id="1">
          <number></number>
          <title>Q1</title>
          <answers >
              <answer type="TextInput">
                  <result>ss</result>
                  <questions>
          <title>Hidden</title>
         </questions>
              </answer>
          </answers>
      </question>
    <question id="2">
    <title>Q2</title>
    </question>
  </questions>
</questionnaire> 
```

如您所见，问题的孩子人数是两个。

我得到的结果是：

```
XML : <question id="1">           <number/>           <title>Q1</title>           <answers>               <answer type="TextInput">                   <result>ss</result>                     <questions>                     <title>Hidden</title>                   </questions>                </answer>           </answers>          </question> question.js:24
XML : <question id="2">         <title>Q2</title>       </question> question.js:24
XML : <title>Hidden</title> question.js:24
Question Number: 3 
```

你能帮助我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T15:09:57.000

`this.XMLObject`在没有此类属性的情况下，调用不会导致错误吗？您正在定义`var XMLObject`与`this.XMLObject`;不同的

当实际变量不是属性时调用也`this.$XMLObject`应该引发异常。

另一件事：尝试使用`questionsXML.push(this)`而不是增加变量`questionNumber`。并返回计数使用`return questionsXML.length`。

除此之外，我认为您的代码应该返回正确的值。或者也许有更多`children`（内部节点/值）。

要测试的 XML：

```
<questionnaire>
    <questions>
        <question id="1">
            <number></number>
            <title>Q1</title>
            <answers>
                <answer type="TextInput">
                <result>ss</result>
            </answers>
        </question>
        <question id="2">
            <number></number>
            <title>Q1</title>
            <answers>
                <answer type="TextInput">
                <result>sSSs</result>
            </answers>
        </question>
    </questions>
</questionnaire> 
```

# msbuild - 在生成服务器上运行 MSBuild 时如何引用不存在的 Office 库

> ID：15005443
> 
> 赞同：1
> 
> 时间：2013-02-21T15:02:07.537
> 
> 标签：msbuild, continuous-integration, office-interop

我正在尝试在我们的 Hudson（CI 构建）服务器上设置 .Net 构建。一个应用程序使用 Microsoft.Office.Interop.Excel.dll。这在构建服务器上找不到，并导致构建失败。

我显然不想为了这种情况在服务器上安装 Office，我该怎么办？

澄清一下：这是一个构建服务器。该项目不在服务器上运行，不需要 Excel，除非满足编译器。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T15:09:09.790

安装主互操作程序集：

*   Office 2003：[http ://www.microsoft.com/en-us/download/details.aspx?id=20923](http://www.microsoft.com/en-us/download/details.aspx?id=20923)
*   Office 2007：[http ://www.microsoft.com/en-us/download/details.aspx?id=18346](http://www.microsoft.com/en-us/download/details.aspx?id=18346)
*   Office 2010：[http ://www.microsoft.com/en-us/download/details.aspx?id=3508](http://www.microsoft.com/en-us/download/details.aspx?id=3508)

当您安装 Visual Studio（如果可以）时，这些 PIA 也应该部署到 GAC。

你也可以看看这个问题：[Unit test with Microsoft.Office.Interop dll failed on build server](https://stackoverflow.com/questions/6762506/unit-test-with-microsoft-office-interop-dll-fails-on-build-server)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-09-14T09:43:04.767

如果您使用 nuget 和任何存储库（如 nexus）进行依赖管理，这很简单。在我们的项目中，我们使用 VS2017，它的 msbuild 与 nuget 很好地集成，它可以在本地和构建服务器上下载这个 dll。

希望这可以帮助

# eclipse - 有没有办法重新安装 SUBVERSIVE？

> ID：15005445
> 
> 赞同：1
> 
> 时间：2013-02-21T15:02:07.983
> 
> 标签：eclipse, subversive

在安装了仅更新 Subversive 的 Eclipse 更新后，我昨天更新了 Subversive，我试图在我的 Eclipse IDE 中卸载 Subversive。

该更新破坏了我在 Eclipse 中的所有功能键，因此是尝试卸载它的原因。显然我做错了什么，并没有完全卸载它。这是我在尝试卸载时正在阅读的信息：

> Subversive SVN Team Provider”无法完全卸载，因为其他安装的软件需要它。不需要的部分将被卸载。

我仍然单击卸载按钮，但它*永远不会*卸载。

我失去了与存储库的连接，我一直在谷歌搜索重新安装 Subversive 的方法，但找不到任何东西来完成。

任何建议/方向将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2021-04-14T14:34:14.807

使用这个更新站点：http: [//download.eclipse.org/technology/subversive/4.0/update-site/](http://download.eclipse.org/technology/subversive/4.0/update-site/)

它适用于 Eclipse 2020-12 (4.18.0)

# ajax - JQuery (Mobile) /Ajax 未定义的返回变量

> ID：15005446
> 
> 赞同：0
> 
> 时间：2013-02-21T15:02:10.917
> 
> 标签：ajax, jquery, jquery-mobile

尽管对此有很多问题，但我似乎无法找到适合我情况的代码，但每次运行此代码时，我都会得到一个未定义的变量，而不是所需的返回 JSON。

我的 AJAX 代码是：

```
$.ajax({
    data: {"serial":account},
    url: 'http://127.0.0.1/MobilePHP/findCustomerName.php',
    dataType: 'json',
    success: function(data){
        window.alert(data);   
    }
}); 
```

我的PHP代码是：

```
 <?php
header("Access-Control-Allow-Origin: *");
header('Content-type: application/json');

include 'dbConfig.php';
include 'connectDB.php';

//$account = $_POST['serial'];

$account = 14;

$sth = mysql_query("SELECT customer_name AS Name FROM customer_details  WHERE auto_id = $account ");

$rows = array();
while($r = mysql_fetch_assoc($sth)) {
    $rows ['CustomerName'][] = $r;
}
echo json_encode($rows);

include 'closeDB.php';

?> 
```

我的控制台中的 JSON 是：

```
{"CustomerName":[{"Name":"Tullaroan"}]} 
```

我真的不确定为什么我无法访问这些变量，因为它似乎在控制台上返回了正确的 JSON。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T15:11:25.890

在`success`函数内部，`data`是一个具有单个属性的对象：`CustomerName`. 要访问它，您使用`data.CustomerName`. 该属性本身就是一个数组，因此您需要使用它们的索引来访问其中的元素。

在您的示例中，您在数组中有一个对象，因此要访问该对象，您需要执行`data.CustomerName[0]`. 该对象还有一个属性: `Name`，因此要获取实际名称，您需要执行: `data.CustomerName[0].Name`，这将返回“Tullaroan”。

像这样可视化对象的分解可能更容易`data`：

```
data = {"CustomerName":[{"Name":"Tullaroan"}]}
data.CustomerName = [{"Name":"Tullaroan"}]
data.CustomerName[0] = {"Name":"Tullaroan"}
data.CustomerName[0].Name = "Tullaroan" 
```

# vb.net - 使用另一个表中的值搜索 DataTable

> ID：15005448
> 
> 赞同：1
> 
> 时间：2013-02-21T15:02:15.447
> 
> 标签：vb.net, linq, datatable, linq-to-dataset

我正在尝试使用 LINQ`DataTable`从另一个值中搜索一个`DataTable`，但到目前为止没有任何进展......怎么做？

在下面的示例中，我有`table`，我在其中搜索，并且`PlTable`，它只有一列；我需要从中检索每一行`table`，其中该字段在的行`Name`中至少包含一个字段字符串。`Name``PlTable`

```
Dim ePlTable As IEnumerable(Of DataRow) = PlTable.AsEnumerable()

Dim found = From row In table.AsEnumerable
            Where row(0).Contains(ePlTable)
            Select row
Return found.CopyToDataTable.Rows 
```

当然它不起作用，因为`.Contains`想要`String`作为论点

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T15:17:09.117

> 当然它不起作用，因为 .Contains 想要 String 作为参数

这就是问题所在，因此请使用强类型`Field`扩展方法将其转换为正确的类型，并`Enumerable.Any`查看其中是否包含至少一个字符串`Name`：

```
Dim strings = From row In PlTable Select row.Field(Of String)(0)
Dim found = From row In table.AsEnumerable
            Where strings.Any(Function(s) row.Field(Of String)("Name").Contains(s))
            Select row
Return found.CopyToDataTable() 
```

# ios - How to remove queued block from a GCD dispatch queue?

> ID：15005452
> 
> 赞同：9
> 
> 时间：2013-02-21T15:02:29.983
> 
> 标签：ios, grand-central-dispatch

I am trying to re-schedule queued block that will handle the update operations. Main goal is updating UI objects (online user table...) with minimum amount of (UI update request). (Server sometimes rain down massive amount of updates, yay!)

For simplicity main scenario is;

*   The dispatch_queue_t instance (queue that will handle given UI updating block) is a serial dispatch queue (private dispatch queue)

*   The operation (UI updating block) is scheduled with dispatch_after with t amount of time (Instead of updating for each data set update, collect update requests within t amount of time and perform a single UI update for them)

*   In case our data set updated, check if there already exist a scheduled event. If yes, unschedule it from dispatch_queue_t instance. Then re-schedule same block with t amount of time delay.

Also;

t is a small amount of time interval that possibly won't be noticed by the user (like 500 ms.) Any alternative approach is welcome.

My motive behind this;

i applied same logic via Android's Handler (post & removeCallbacks combination with Runnable instance) and i hope i could achieve the same on iOS.

**Edit:**

As @Sven suggested usage of NSOperationQueue is more suitable for the scenario as they support cancelling each NSOperation. I skimmed through documents and found;

> Canceling Operations Once added to an operation queue, an operation object is effectively owned by the queue and cannot be removed. The only way to dequeue an operation is to cancel it. **You can cancel a single individual operation object by calling its cancel method** or you can cancel all of the operation objects in a queue by calling the cancelAllOperations method of the queue object.
> 
> You should cancel operations only when you are sure you no longer need them. Issuing a cancel command puts the operation object into the “canceled” state, which prevents it from ever being run. Because a canceled operation is still considered to be “finished”, objects that are dependent on it receive the appropriate KVO notifications to clear that dependency. Thus, it is more common to cancel all queued operations in response to some significant event, like the application quitting or the user specifically requesting the cancellation, rather than cancel operations selectively.

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-02-21T20:28:19.553

这也可以通过 GCD 轻松完成，无需在此处使用 NSOperationQueue 的大锤子。

只需直接使用非重复调度计时器源而不是`dispatch_after`（这只是此类计时器源的便利包装，它实际上不会将块排入队列，直到计时器关闭）。

您可以使用 重新安排挂起的计时器源执行`dispatch_source_set_timer()`。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-21T15:45:19.847

您不能删除或以其他方式更改调度队列中排队的操作。`NSOperationQueue`尝试使用支持取消的更高级别。

# facebook-php-sdk - 当我在 Symfony2 上需要 PHP facebook SDK 时出现 HTTP 500 错误

> ID：15005455
> 
> 赞同：0
> 
> 时间：2013-02-21T15:02:34.087
> 
> 标签：facebook-php-sdk, symfony-2.1

我添加了要求

```
require_once __DIR__ . './facebook/src/facebook.php'; 
```

在供应商/autoload.php 文件中。当我使用[denwer](http://www.denwer.ru/)在 localhost 上工作时，一切都很好。但是当我尝试在真实服务器上使用它时，我得到了 HTTP 500 错误。为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T10:46:27.470

问题是尚未安装 CURL。

# android - 从 attrs.xml 获取自定义属性的名称

> ID：15005461
> 
> 赞同：1
> 
> 时间：2013-02-21T15:02:43.493
> 
> 标签：android, xml

我在以下位置创建了自定义属性`attrs.xml`：

```
<?xml version="1.0" encoding="utf-8"?>
<resources>
<declare-styleable name="StarWars">
  <attr name="sw_jedi" format="string" />
  <attr name="sw_rank" format="string" />
</declare-styleable> 
```

我得到了`R`（例如`R.styleable.StarWars_sw_jedi`）支持的 int 值，但是我怎样才能得到属性`name`（`jedi`）？

编辑更具体：

我想要属性的“名称”字符串而不是 R 中的值（它是一个 int）：

例如，我想检索“绝地”而不是 int ( `R.styleable.StarWars_sw_jedi`or `R.attr.sw_jedi`)

事实上我想要一个`getAttributeName(R.styleable.StarWars_sw_jedi)`

提前谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T15:44:31.997

我曾使用过您的相同样式，并且正在完美地检查一次以供参考。

第1步：

通过在 res/values 文件夹中创建文件 attrs.xml 来创建自定义样式

这是 attrs.xml

```
<?xml version="1.0" encoding="utf-8"?>
<resources>
<declare-styleable name="StarWars">
  <attr name="sw_jedi" format="string" />
  <attr name="sw_rank" format="string" />
</declare-styleable>
</resources> 
```

声明您指定的格式`res/values/strings.xml`

```
 <string name="sw_jedi">Hi</string>
        <string name="sw_rank">Bye</string> 
```

当我在我的java代码中使用

它的工作没有任何歧义。

如果您想获得绝地的价值，请这样做

```
 String jedi=getResources().getResourceEntryName(StarWars_sw_jedi); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-21T15:50:31.210

好吧，我不知道为什么我没有找到它，但我正在寻找的功能是[getResourceEntryName](http://developer.android.com/reference/android/content/res/Resources.html#getResourceEntryName%28int%29)它实际上正是我想要的

就我而言，如果我想要“绝地”，我会这样做：

```
String name = getResources().getResourceEntryName(R.attr.sw_jedi); 
```

# jquery - Load method in jquery

> ID：15005471
> 
> 赞同：0
> 
> 时间：2013-02-21T15:02:59.177
> 
> 标签：jquery

I want to alert massage when div having id b is loaded.

```
<div id='a'>a</div>
<div id='b'>b</div>
<div id='c'>c</div>

$(function(){
$('#b').load(function(){
alert(0)
})
}) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T15:08:46.797

Load 事件不适用于 div 元素。据我所知，你能做的最好的就是

```
<div id='a'>a</div>
<div id='b'>b</div>

<script>
   alert(0);
</script>

<div id='c'>c</div> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T15:06:30.300

您不能将事件加载或准备应用于 div 元素。您可以使用此代码，当所有 DOM 准备好或加载时发出警报：

```
$(document).ready(function() {
  alert("0");
}); 
```

或者

```
$(window).load(function() {
   alert("0");
}); 
```

# asp.net - 如何保护注册表单免受垃圾邮件

> ID：15005472
> 
> 赞同：-1
> 
> 时间：2013-02-21T15:02:59.843
> 
> 标签：asp.net, html, asp.net-mvc, forms, asp.net-mvc-2

ASP.NET/Mono MVC2 E-shop 包含注册表，要求输入必填的客户姓名、地址、电话密码两次和一些可选字段。

是否应该在表单中添加垃圾邮件保护？表单验证密码和“重复密码”字段是否相同。这足以防止垃圾邮件吗？

如果不是，添加这种保护的最合理方法是什么？就像是

*   防伪令牌
*   向现有数据添加更多验证（如何）
*   添加额外的输入（验证码）

jquery 和 jquery ui 用于客户端。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-21T15:46:19.957

防伪令牌是很好的第一步。真的没有理由不在每个表单上都使用它们，所以让它成为一种习惯。它们的工作方式是，当用户登陆您的 GET 操作时，会创建一个令牌并将其设置为表单中的隐藏字段或 cookie，或两者兼而有之。发布表单时，POST 操作会检查它是否等于在 GET 操作上设置的令牌。如果发布的值与原始值匹配，则正常处理请求。这意味着某些第三方不能简单地将数据直接发布到您的 POST 操作。他们必须首先加载 GET 操作，获取防伪令牌，然后使用该令牌进行 POST。这只是一个额外的步骤，但在垃圾邮件和网络钓鱼等游戏中，它更多的是关于数量而不是有效性，它至少会减慢它们的速度。他们现在必须为您的站点自定义编写一些东西，而不是可能适用于一系列 URL 和站点的脚本。如果你是 Facebook，他们会这样做。如果这是您的个人博客，他们可能不会浪费时间。这完全取决于他们的动机以及他们认为您的网站的价值。

另一种相对有效的技术称为蜜罐。基本上，您在表单中添加了一些通常很重要的字段，但对于相关表单而言并不重要 - 诸如“电子邮件”、“姓名”等字段。选择一个您当前表单没有的字段不要使用，无论如何都包含它，然后用 CSS 或 JS 隐藏它。（请记住，尽管您需要*明显地*隐藏它，*而不是*将其设置为`display:none`。未发布的字段`display:none`，因此它违背了目的 - 您希望它被发布。只需设置如下：

```
position:absolute;
width:0; height:0;
overflow:hidden; 
```

无论如何，如果垃圾邮件发送者只是随机定位网站，他们的脚本会追踪你的蜜罐，如果他们填写，你就知道它是垃圾邮件发送者，所以你扔掉那个帖子。另外，请记住，要使这种技术有效，您必须*假装*它有效。所以，即使你实际上是在幕后把帖子扔掉，你仍然表现得好像这是一个成功的请求。如果您返回一些错误或因 403 Forbidden 之类的完全失败，他们会明白您在做什么。

我想说，只有当上面的前两个建议不能防止垃圾邮件时，你才应该考虑使用 CAPTCHA。它们在可用性方面存在极大缺陷，用户对它们的恨意与烈日之火一样。不要从一开始就过火。根据您网站的知名度大小，单独的防伪令牌实际上可以完成这项工作。如果没有，蜜罐可能会，等等。对于许多人来说，只是一头扎进所有东西上，然后在所有东西上打一个验证码，当更有可能时，垃圾邮件充其量是最少的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-21T15:05:19.330

我的经验是验证码足以防止垃圾邮件。

# ios - Does anyone know how to implement the AVAssetResourceLoaderDelegate methods correctly?

> ID：15005474
> 
> 赞同：12
> 
> 时间：2013-02-21T15:03:07.310
> 
> 标签：ios, objective-c, avfoundation

I am trying to coax AVFoundation to read from a custom URL. The custom URL stuff works. The code below creates a NSData with a movie file:

```
NSData* movieData = [NSData dataWithContentsOfURL:@"memory://video"]; 
```

I've set up a AVAssetResourceLoader object using the following code:

```
NSURL* url = [NSURL URLWithString:@"memory://video"];
AVURLAsset* asset = [[AVURLAsset alloc] initWithURL:url options:nil];
AVAssetResourceLoader* loader = [asset resourceLoader];
[loader setDelegate:self queue:mDispatchQueue]; 
```

The dispatch queue is concurrent.

I then try to extract the first frame from the movie:

```
AVAssetImageGenerator* imageGen = [AVAssetImageGenerator assetImageGeneratorWithAsset:asset];
CMTime time = CMTimeMakeWithSeconds(0, 600);
NSError* error = nil;
CMTime actualTime;
CGImageRef image = [imageGen copyCGImageAtTime:time
                                    actualTime:&actualTime
                                         error:&error];
if (error) NSLog(@"%@", error); 
```

But when I run this but of code I get:

```
2013-02-21 10:02:22.197 VideoPlayer[501:907] Error Domain=AVFoundationErrorDomain Code=-11800 "The operation could not be completed" UserInfo=0x1f863090 {NSLocalizedDescription=The operation could not be completed, NSUnderlyingError=0x1e575a90 "The operation couldn’t be completed. (OSStatus error 268451843.)", NSLocalizedFailureReason=An unknown error occurred (268451843)} 
```

The implementation of the delegate method is:

```
- (BOOL)resourceLoader:(AVAssetResourceLoader *)resourceLoader shouldWaitForLoadingOfRequestedResource:(AVAssetResourceLoadingRequest *)loadingRequest
{
    NSData* data = [NSData dataWithContentsOfURL:loadingRequest.request.URL];
    [loadingRequest finishLoadingWithResponse:nil data:data redirect:nil];
    return YES;
} 
```

Now, my question is, am I implementing the method correctly? Does anyone know if what I am doing correct?

Thanks.

EDIT: The movie I am fetching in its entirety is a single frame movie.

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2014-05-30T15:52:50.920

我已经实现了这个方法的一个工作版本。我花了一段时间才弄清楚。但生成的应用程序现在可以工作了。这表明代码没问题。

我的应用程序包含一个我不想在未加密的包中发送的媒体文件。我想动态解密文件。（一次一个块）。

该方法必须同时响应内容请求（告诉播放器正在加载什么）和数据请求（给播放器一些数据）。第一次调用该方法时，总是有一个内容请求。然后会有一系列的数据请求。

玩家很贪心。它总是要求整个文件。您没有义务提供。它要求整个蛋糕。你可以给它一片。

我把数据块交给媒体播放器。通常一次 1 MB。使用特殊情况来处理较小的最终块。通常按顺序要求块。但是您也需要能够处理乱序请求。

```
- (BOOL) resourceLoader:(AVAssetResourceLoader *)resourceLoader shouldWaitForLoadingOfRequestedResource:(AVAssetResourceLoadingRequest *)loadingRequest
{
    NSURLRequest* request = loadingRequest.request; 
    AVAssetResourceLoadingDataRequest* dataRequest = loadingRequest.dataRequest;
    AVAssetResourceLoadingContentInformationRequest* contentRequest = loadingRequest.contentInformationRequest;

    //handle content request
    if (contentRequest)
    {
        NSError* attributesError;
        NSString* path = request.URL.path;
        _fileURL = request.URL;
        if (_fileHandle == nil)
        {
            _fileHandle = [NSFileHandle fileHandleForReadingAtPath:path];
        }

        // fire up the decryption here..
        // for example ... 
        if (_decryptedData == nil)
        {
            _cacheStart = 1000000000;
            _decryptedData = [NSMutableData dataWithLength:BUFFER_LENGTH+16];
            CCCryptorCreate(kCCDecrypt, kCCAlgorithmAES128, kCCOptionPKCS7Padding, [sharedKey cStringUsingEncoding:NSISOLatin1StringEncoding], kCCKeySizeAES256, NULL, &cryptoRef);
        }

        NSDictionary *fileAttributes = [[NSFileManager defaultManager] attributesOfItemAtPath:path error:&attributesError];

        NSNumber *fileSizeNumber = [fileAttributes objectForKey:NSFileSize];
        _fileSize = [fileSizeNumber longLongValue];

        //provide information about the content
        _mimeType = @"mp3";
        contentRequest.contentType = _mimeType;
        contentRequest.contentLength = _fileSize;
        contentRequest.byteRangeAccessSupported = YES;
    }

    //handle data request
    if (dataRequest)
    {
        //decrypt a block of data (can be any size you want) 
        //code omitted

        NSData* decodedData = [NSData dataWithBytes:outBuffer length:reducedLen];
       [dataRequest  respondWithData:decodedData];
    [loadingRequest finishLoading];
    }

    return YES;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-27T15:03:25.180

我只是浪费了 2 个小时试图做一些非常相似的事情。

原来它只适用于设备，不适用于 iOS 模拟器！

我猜模拟器中的 AVFoundation 以某种方式“桥接”到主机 Mac 的 AVFoundation。不幸的是，这个 API 在 OS X 10.8 上不可用（根据 WebCore 上的一些提交，它将在 OS X 10.9 中可用），所以现在它在模拟器中不起作用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-08-02T09:57:40.040

用户 NSURLComponent 以及 scheme = "enc" 以调用 AVAssetResourceLoaderDelegate 方法。

```
let urlComponents = NSURLComponents(url: video_url, resolvingAgainstBaseURL: false)
    urlComponents?.scheme = "enc"
let avAsset = AVURLAsset(url: (urlComponents?.url)!, options: ["AVURLAssetHTTPHeaderFieldsKey": headers])
    avAsset.resourceLoader.setDelegate(self, queue: DispatchQueue(label: "AVARLDelegateDemo loader")) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-21T15:35:22.930

您需要[创建一个 NSURLResponse 对象](https://developer.apple.com/library/mac/documentation/Cocoa/Reference/Foundation/Classes/NSURLResponse_Class/Reference/Reference.html#//apple_ref/occ/instm/NSURLResponse/initWithURL%3aMIMEType%3aexpectedContentLength%3atextEncodingName%3a)来传回。你要回去了`nil`。没有它，AVAssetResourceLoader 不知道如何处理你交给它的数据（也就是说，它不知道它是什么类型的数据 - 错误消息、jpeg 等）。在假设成功之前，您还应该真正使用`-[NSData dataWithContentsOfURL:options:error:]`并检查错误。

# python - Run python script on all subdirectories with specific name

> ID：15005476
> 
> 赞同：0
> 
> 时间：2013-02-21T15:03:14.933
> 
> 标签：python, bash

I have a python script which takes some parameters, and I want to run this script on all the sub directories starting from the one that the script is inside.

The idea is I want to get a custom output of the script to be saved in the file.

here's what i've done:

```
for x in `find . -type d | grep data`;
do
python /full/path/to/file/script.py -f "%a
%t" $x/*.txt -o $x/res.txt
done 
```

But this is not working and I don't know why. The `grep` in the for loop is to only get the directories that contains .txt files and apply the script on them.

The new line between %a and %t is because I want to customize the output of the output of the python script to include a new line between each 2 variables

What am I doing wrong ?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T15:33:55.337

如果您想在*从脚本所在的目录开始的所有子目录上运行此脚本*，请尝试以这种方式执行此操作：

```
import os

for path, directories, files in os.walk(os.path.dirname(os.path.realpath(__file__))):
    print path, directories, files
    txt_files = [arbitrary_file for arbitrary_file in files if arbitrary_file[-4:].lower() == ".txt"]

    #run your python here
    txt_files = [txt_file for arbitrary_file in files if arbitrary_file[] 
```

如果您的原始代码是这样的：

```
import sys

text_files_to_process = #Do Something with sys.argv - or whatever you're using to parse your arguments.

with open("res.txt", "w") as f:
    #do something with all the text files, and write the output to res.txt.
    for text_file in text_files_to_process:
        with open(text_file) as tf:
            for line in tf:
                #whatever your text processing is
            tf.write("something") 
```

然后您只需将其更改为以下内容：

```
import os

for path, directories, files in os.walk(os.path.dirname(os.path.realpath(__file__))):
    print path, directories, files
    txt_files = [arbitrary_file for arbitrary_file in files if arbitrary_file[-4:].lower() == ".txt"]

    txt_files = [txt_file for arbitrary_file in files if arbitrary_file[]

    with open("res.txt", "w") as f:
        #do something with all the text files, and write the output to res.txt.
        for text_file in txt_files:
            with open(text_file) as tf:
                for line in tf:
                    #whatever your text processing is
                tf.write("something") 
```

# python - 使用指定编码记录多个模块和多个处理程序的最 Pythonic 方式是什么？

> ID：15005478
> 
> 赞同：4
> 
> 时间：2013-02-21T15:03:18.677
> 
> 标签：python, logging, character-encoding, module

我正在寻找有关如何完成多模块和多处理程序日志记录的具体建议。我在这里添加了我的简化代码，但我不想让答案产生偏见 - 告诉我最佳实践是什么。

我想将所有内容记录到文件中，并警告及以上到控制台。

这是我`level0.py`希望它记录到指定文件的内容：

```
import logging
from flask import Flask
from level1 import function1

app = Flask(__name__)

logger = logging.getLogger('logger0')
logger.setLevel(logging.DEBUG)

file_handler = logging.FileHandler('../logs/logger0','w','utf-8')
file_handler.setLevel(logging.DEBUG)
file_format = logging.Formatter('%(asctime)s %(levelname)s: %(message)s [in %(pathname)s:%(lineno)d in %(funcName)s]')
file_handler.setFormatter(file_format)
logger.addHandler(file_handler)

console_handler = logging.StreamHandler()
console_handler.setLevel(logging.INFO)
console_format = logging.Formatter('%(message)s')
console_handler.setFormatter(console_format)
logger.addHandler(console_handler)

@app.route('/', methods=['GET', 'POST'])
def function0(foo):
    bar = function1(foo)
    logger.debug('function0')
    ... 
```

此外，`level1`当作为脚本调用时，它可以是一个独立的模块。在这种情况下，我希望它记录到另一个文件中。下面是`level1.py`（有重复的日志记录行）：

```
import logging
logger = logging.getLogger('level0.level1')

from level2 import function2

def function1(foo):
    bar = function2(foo)
    logger.debug('function1')
    ...

if __name__ == "__main__":
    logger = logging.getLogger('logger0')
    logger.setLevel(logging.DEBUG)

    file_handler = logging.FileHandler('../logs/logger1','w','utf-8')
    file_handler.setLevel(logging.DEBUG)
    file_format = logging.Formatter('%(asctime)s %(levelname)s: %(message)s [in %(pathname)s:%(lineno)d in %(funcName)s]')
    file_handler.setFormatter(file_format)
    logger.addHandler(file_handler)

    console_handler = logging.StreamHandler()
    console_handler.setLevel(logging.INFO)
    console_format = logging.Formatter('%(message)s')
    console_handler.setFormatter(console_format)
    logger.addHandler(console_handler)

    bar = function1('foo')
    logger.info('level1 main')
    ... 
```

我从 复制了这个日志记录块`level0`，因为我想要相同的日志记录，而且将它放在 main.js 中似乎很直观。`level2`不是独立的，所以它只有：

```
import logging
logger = logging.getLogger('level0.level1.level2')

def function2(foo):
    logger.info('function2')
    .... 
```

我从 开始`logging.basicSetup`，但无法为文件设置编码，并且`UnicodeEncodeError`在尝试记录非 ascii 字符串时不断获取：

```
logger.warn(u'foo bar {}'.format(NON_ASCII_STR)) 
```

（当记录器将消息传递给其父母时，我仍然收到错误消息）

那么，对于这种情况或更普遍的情况，最好的日志设计是什么 - 多个模块（带有编码选择 - 我想要 utf-8）

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-21T20:13:23.550

对于由许多部分组成的模块，我使用[文档](http://docs.python.org/2/howto/logging.html#logging-advanced-tutorial)中推荐的方法，每个模块只有一行，`logger = logging.getLogger(__name__)`. 正如您所指出的，模块不应该知道或关心它的消息如何或去哪里，它只是将它传递给应该由主程序设置的记录器。

要根据您的主程序减少剪切粘贴，请确保您的模块具有有意义的层次结构，并且在某处只有一个函数可以设置您的日志记录，然后可以由您希望的任何主程序调用。

例如，制作一个 logsetup.py：

```
import logging

def configure_log(level=None,name=None):
    logger = logging.getLogger(name)
    logger.setLevel(level)

    file_handler = logging.FileHandler('../logs/%s' % name,'w','utf-8')
    file_handler.setLevel(logging.DEBUG)
    file_format = logging.Formatter('%(asctime)s %(levelname)s: %(message)s [in %(pathname)s:%(lineno)d in %(funcName)s]')
    file_handler.setFormatter(file_format)
    logger.addHandler(file_handler)

    console_handler = logging.StreamHandler()
    console_handler.setLevel(logging.INFO)
    console_format = logging.Formatter('%(message)s')
    console_handler.setFormatter(console_format)
    logger.addHandler(console_handler) 
```

要让您的各个模块具有它们作为主模块的模式，请定义一个单独的函数，例如`main`.

在 level0.py 和/或 level1.py 中：

```
def main():
  # do whatever 
```

在最顶层的程序中，调用该函数：

```
import logging
from logsetup import configure_log
configure_log(logging.DEBUG,'level0') # or 'level1'
from level0 import main # or level1

if __name__ == "__main__"
  main() 
```

您应该仍然有该`__name__ == "__main__"`子句，某些模块（*咳嗽*多处理*咳嗽*）具有不同的行为，具体取决于该子句是否存在。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-25T14:59:57.683

总结一下，这就是我所做的；我在每个模块/文件中添加了以下两行：

```
import logging
logger = logging.getLogger(__name__) 
```

这会设置日志记录，但不会添加任何处理程序。然后，我将处理程序添加到主文件中的根记录器中，我正在运行导入的模块，因此将它们的记录传递给根记录器，所有内容都会被保存和显示。我像 CaptainMurphy 建议的那样做，但`logger = logging.getLogger('')`要使用根记录器

解决编码问题 - 我在将非 ascii 字符串保存到文件时遇到问题。所以我只是添加`FileHandler`到根记录器，其中可以指定编码。我无法做到这一点`logging.basicConfig`。

再次感谢@CaptainMurphy - 很抱歉，我的声誉很低，我无法为你投票，但我已经勾选了答案。

# c# - Out of range error on SqlDataReader

> ID：15005479
> 
> 赞同：3
> 
> 时间：2013-02-21T15:03:20.150
> 
> 标签：c#, asp.net, sqldatareader

I'm using a `SqlDataReader` and get this exception when trying to read a column...

> *System.IndexOutOfRangeException: record*

Here is the code...

```
SqlCommand select = new SqlCommand("SELECT RTRIM(LTRIM(PART_NO)) AS PART_NO, record AS CUSTOMER_NO FROM [RMAData].[dbo].[IMPORTING_ORDER_EDI] WHERE sessionID = '" + Session.SessionID + "'", connection);
SqlDataReader reader = select.ExecuteReader();

if (reader.HasRows)
{
   while (reader.Read())
   {
       lblWebMasterMessage.Text += "record " + reader["record"].ToString() + "<br />";
... 
```

If I change the `lblWebMasterMessage.Text` to the following it works just fine...

```
lblWebMasterMessage.Text += "record " + reader["PART_NO"].ToString() + "<br />"; 
```

The difference between record and `PART_NO` in the SQL Server table is that 'record' is a primary key and an `int`, `PART_NO` is a `varchar(100)`.

The trouble is, I need the 'record' to identify the record to update it later...

I really can't see why it can return one field and not the other?

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-21T15:04:50.850

那是因为您没有名为“record”的字段，您将其别名为“CUSTOMER_NO”，因此将代码更改为：

```
lblWebMasterMessage.Text += "record " + reader["CUSTOMER_NO"].ToString() + "<br />"; 
```

也就是说，您也可以使用 index 而不是 name 来阅读第二列：

```
lblWebMasterMessage.Text += "record " + reader[1] + "<br />"; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-10-27T06:08:52.237

在我的情况下，这个错误是因为我不小心在命令文本中执行了两个 select 语句。我有两个单独的输出结果，第一个输出不包含我正在阅读的列名，因此出现了错误。

# caching - MVC4 StyleBundle：您可以在调试模式下添加缓存清除查询字符串吗？

> ID：15005481
> 
> 赞同：56
> 
> 时间：2013-02-21T15:03:26.863
> 
> 标签：caching, asp.net-mvc-4, bundle

我有一个 MVC 应用程序，我正在使用`StyleBundle`该类来渲染 CSS 文件，如下所示：

```
bundles.Add(new StyleBundle("~/bundles/css").Include("~/Content/*.css")); 
```

我遇到的问题是，在`Debug`模式下，CSS url 是单独呈现的，并且我有一个 Web 代理可以主动缓存这些 url。在`Release`模式下，我知道一个查询字符串被添加到最终 url 以使每个版本的任何缓存无效。

是否可以配置`StyleBundle`为在模式下添加随机查询字符串`Debug`以产生以下输出来解决缓存问题？

```
<link href="/stylesheet.css?random=some_random_string" rel="stylesheet"/> 
```

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2016-05-09T16:02:45.307

你只需要一个唯一的字符串。它不一定是哈希。我们使用文件的 LastModified 日期并从那里获取 Ticks。正如@Todd 指出的那样，打开和读取文件的成本很高。Ticks 足以输出一个在文件更改时更改的唯一编号。

```
internal static class BundleExtensions
{
    public static Bundle WithLastModifiedToken(this Bundle sb)
    {
        sb.Transforms.Add(new LastModifiedBundleTransform());
        return sb;
    }
    public class LastModifiedBundleTransform : IBundleTransform
    {
        public void Process(BundleContext context, BundleResponse response)
        {
            foreach (var file in response.Files)
            {
                var lastWrite = File.GetLastWriteTime(HostingEnvironment.MapPath(file.IncludedVirtualPath)).Ticks.ToString();
                file.IncludedVirtualPath = string.Concat(file.IncludedVirtualPath, "?v=", lastWrite);
            }
        }
    }
} 
```

以及如何使用它：

```
bundles.Add(new StyleBundle("~/bundles/css")
    .Include("~/Content/*.css")
    .WithLastModifiedToken()); 
```

这就是 MVC 所写的：

```
<link href="bundles/css/site.css?v=635983900813469054" rel="stylesheet"/> 
```

也适用于脚本包。

* * *

## 回答 #2

> 赞同：48
> 
> 时间：2014-10-21T15:32:24.480

您可以创建一个自定义 IBundleTransform 类来执行此操作。这是一个示例，它将使用文件内容的哈希附加 av=[filehash] 参数。

```
public class FileHashVersionBundleTransform: IBundleTransform
{
    public void Process(BundleContext context, BundleResponse response)
    {
        foreach(var file in response.Files)
        {
            using(FileStream fs = File.OpenRead(HostingEnvironment.MapPath(file.IncludedVirtualPath)))
            {
                //get hash of file contents
                byte[] fileHash = new SHA256Managed().ComputeHash(fs);

                //encode file hash as a query string param
                string version = HttpServerUtility.UrlTokenEncode(fileHash);
                file.IncludedVirtualPath = string.Concat(file.IncludedVirtualPath, "?v=", version);
            }                
        }
    }
} 
```

然后，您可以通过将其添加到捆绑包的 Transforms 集合来注册该类。

```
new StyleBundle("...").Transforms.Add(new FileHashVersionBundleTransform()); 
```

现在版本号只有在文件内容改变时才会改变。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2015-01-11T12:19:10.440

这个库可以在调试模式下将缓存清除哈希添加到您的捆绑文件中，以及其他一些缓存清除的东西：[https ://github.com/kemmis/System.Web.Optimization.HashCache](https://github.com/kemmis/System.Web.Optimization.HashCache)

### 您可以将 HashCache 应用于 BundlesCollection 中的所有捆绑包

**将所有捆绑包添加到集合后**，对 BundlesCollection 实例执行 ApplyHashCache() 扩展方法 。

```
BundleTable.Bundles.ApplyHashCache(); 
```

### 或者您可以将 HashCache 应用于单个 Bundle

创建 HashCacheTransform 的实例并将其添加到您要应用 HashCache 的捆绑实例中。

```
var myBundle = new ScriptBundle("~/bundle_virtual_path").Include("~/scripts/jsfile.js");
myBundle.Transforms.Add(new HashCacheTransform()); 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2014-03-14T08:27:06.747

我遇到了同样的问题，但升级后客户端浏览器中有缓存版本。我的解决方案是将调用包装`@Styles.Render("~/Content/css")`在我自己的渲染器中，将我们的版本号附加到查询字符串中，如下所示：

```
 public static IHtmlString RenderCacheSafe(string path)
    {
        var html = Styles.Render(path);
        var version = VersionHelper.GetVersion();
        var stringContent = html.ToString();

        // The version should be inserted just before the closing quotation mark of the href attribute.
        var versionedHtml = stringContent.Replace("\" rel=", string.Format("?v={0}\" rel=", version));
        return new HtmlString(versionedHtml);
    } 
```

然后在视图中我喜欢这样：

```
@RenderHelpers.RenderCacheSafe("~/Content/css") 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-02-22T11:05:51.153

目前还没有，但预计很快就会添加（现在计划用于 1.1 稳定版本，您可以在此处跟踪此问题：[Codeplex](http://aspnetoptimization.codeplex.com/workitem/40)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-03-19T13:20:36.230

请注意，这是为脚本编写的，但也适用于样式（只需更改这些关键词）

基于@Johan 的回答：

```
public static IHtmlString RenderBundle(this HtmlHelper htmlHelper, string path)
{
    var context = new BundleContext(htmlHelper.ViewContext.HttpContext, BundleTable.Bundles, string.Empty);
    var bundle = System.Web.Optimization.BundleTable.Bundles.GetBundleFor(path);
    var html = System.Web.Optimization.Scripts.Render(path).ToString();
    foreach (var item in bundle.EnumerateFiles(context))
    {
        if (!html.Contains(item.Name))
            continue;

        html = html.Replace(item.Name, item.Name + "?" + item.LastWriteTimeUtc.ToString("yyyyMMddHHmmss"));
    }

    return new HtmlString(html);
}

public static IHtmlString RenderStylesBundle(this HtmlHelper htmlHelper, string path)
{
    var context = new BundleContext(htmlHelper.ViewContext.HttpContext, BundleTable.Bundles, string.Empty);
    var bundle = System.Web.Optimization.BundleTable.Bundles.GetBundleFor(path);
    var html = System.Web.Optimization.Styles.Render(path).ToString();
    foreach (var item in bundle.EnumerateFiles(context))
    {
        if (!html.Contains(item.Name))
            continue;

        html = html.Replace(item.Name, item.Name + "?" + item.LastWriteTimeUtc.ToString("yyyyMMddHHmmss"));
    }

    return new HtmlString(html);
} 
```

用法：

```
@Html.RenderBundle("...")
@Html.RenderStylesBundle("...") 
```

更换

```
@Scripts.Render("...")
@Styles.Render("...") 
```

好处：

*   适用于 System.Web.Optimizations v1.0.0.0
*   适用于捆绑包中的多个文件
*   获取每个文件而不是组的文件修改日期，而不是散列

此外，当您需要快速解决 Bundler 问题时：

```
public static MvcHtmlString ResolveUrl(this HtmlHelper htmlHelper, string url)
{
    var urlHelper = new UrlHelper(htmlHelper.ViewContext.RequestContext);
    var resolvedUrl = urlHelper.Content(url);

    if (resolvedUrl.ToLower().EndsWith(".js") || resolvedUrl.ToLower().EndsWith(".css"))
    {
        var localPath = HostingEnvironment.MapPath(resolvedUrl);
        var fileInfo = new FileInfo(localPath);
        resolvedUrl += "?" + fileInfo.LastWriteTimeUtc.ToString("yyyyMMddHHmmss");
    }

    return MvcHtmlString.Create(resolvedUrl);
} 
```

用法：

```
<script type="text/javascript" src="@Html.ResolveUrl("~/Scripts/jquery-1.9.1.min.js")"></script> 
```

更换：

```
<script type="text/javascript" src="@Url.Content("~/Scripts/jquery-1.9.1.min.js")"></script> 
```

（也替换了许多其他替代查找）

# xml - 使用 XSLT 根据环境输入从 Heat 输出文件中过滤一些文件

> ID：15005484
> 
> 赞同：1
> 
> 时间：2013-02-21T15:03:44.947
> 
> 标签：xml, xslt, wix, windows-installer, heat

我有一些文件需要根据给定的环境输入（如 dev、prod）从 .WXS 中删除，这些文件将作为属性传递给 Heat.exe。基于此，我需要在通过 XSLT 转换收获后从 Fragment.WXS 中过滤或删除一些文件。例如，如果 xslt 模板用于开发，那么我需要源文件不包含 .UAT,.Prod,.Test 的所有文件。我还需要使用 Heat 执行转换的命令。

请参阅下面来自热生成输出的一些组件

```
 <?xml version="1.0" encoding="utf-8"?>
            <Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
                <Fragment>
                    <DirectoryRef Id="TARGETDIR">
                       <Directory Id="dir8EF11DA0EAFBFCB7A0B81343D3750C8B" Name="SCBUDirect" />
                    </DirectoryRef>
                </Fragment>
                <Fragment>
        <ComponentGroup Id="SCBUDirect">

        <Component Id="cmpE3B75974B57E1263C93B9B05FDFE715F" Directory="dir64C5FB989D956FBA878D608B754DE28A" Guid="{CA810124-F44B-4EF5-986A-07FAA67434AB}">
        <File Id="fil85729F855FDD131D6161043C08CB4543" KeyPath="yes" Source="C:\Workspaces\Chatra\Website\SCBUDirect.B2CWeb\App_Config\TestBuild_dev_ConnectionStrings.config" />
        </Component>

        <Component Id="cmpERG5974B57E1263C93B9B05FDFE715F" Directory="dir64C5FB989D956FBA878D608B754DE28A" Guid="{ERGT50124-F44B-4EF5-986A-07FAA67434AB}">
            <File Id="fil8574324425555FDD131D6161043C08CB4543" KeyPath="yes" Source="C:\Workspaces\Chatra\Website\SCBUDirect.B2CWeb\App_Config\TestBuild_prod_ConnectionStrings.config" />
         </Component>

<Component Id="cmp51A6C4030B563BC4A64DA99AED42D978" Directory="dir64C5FB989D956FBA878D608B754DE28A" Guid="{CF063EF0-6926-4D21-B89D-BD71E0E926F7}">
                <File Id="fil1494493122AA1F38F8D2C11F93A8D4E8" KeyPath="yes" Source="C:\Workspaces\Chatra\Website\SCBUDirect.B2CWeb\App_Config\Deployment.config" />
            </Component>

        <Component Id="cmpDF354EF7DC6C98108D05886911231011" Directory="dir64C5FB989D956FBA878D608B754DE28A" Guid="{F912A8C7-1226-49D6-897F-1878A1607B16}">
        <File Id="fil1058EF5A5E46590311096FFC704CD243" KeyPath="yes" Source="C:\Workspaces\Chatra\Website\SCBUDirect.B2CWeb\App_Config\basic.log4net.dev" />
        </Component>

        <Component Id="cmpD84FEB6CD3B1AE3534AA6B94CF5065C8" Directory="dir64C5FB989D956FBA878D608B754DE28A" Guid="{8BEBA112-9967-4DD9-96FC-25A879C5D6FA}">
        <File Id="filE0D63A4EC6CCCF6E9C06A91E04EA87E7" KeyPath="yes" Source="C:\Workspaces\Chatra\Website\SCBUDirect.B2CWeb\App_Config\basic.log4net.prod" />
        </Component>

        <Component Id="cmp0B6A1EF1380A825CC1F3894FAA38CC0B" Directory="dir64C5FB989D956FBA878D608B754DE28A" Guid="{60C807BD-142C-4C1F-8366-DC297657AB0A}">
        <File Id="fil20F28B0827462F414C432783951DD049" KeyPath="yes" Source="C:\Workspaces\Chatra\Website\SCBUDirect.B2CWeb\App_Config\basic.log4net.test" />
        </Component>

        <Component Id="cmp80CFA73AA353BE789D4539008E7F3516" Directory="dir64C5FB989D956FBA878D608B754DE28A" Guid="{0B3FA0E7-8F66-408C-944F-DAA0A847B6C4}">
        <File Id="fil2B292A388045FDF49475C9F6C5D144D1" KeyPath="yes" Source="C:\Workspaces\Chatra\Website\SCBUDirect.B2CWeb\App_Config\basic.log4net.uat" />
        </Component>

     <Component Id="cmpE1C2EEC551696DCE99C2CAB9ED013C54" Directory="dir83BD7C94126520DBEDF76AF461521286" Guid="{A3D766EE-A488-468A-A7BF-DDB507B21299}">
                    <File Id="fil2F90622E603C0AF703A504C3DE3A6201" KeyPath="yes" Source="C:\Workspaces\Chatra\Website\SCBUDirect.B2CWeb\App_Config\Deployment\Deployment.Dev.config" />
                </Component>
                <Component Id="cmpEBF2150BC59E378124B87AF387DA5519" Directory="dir83BD7C94126520DBEDF76AF461521286" Guid="{16CF5D16-A551-4184-9E9D-772A9277941A}">
                    <File Id="fil9241DCC3F781240AD979AAF25BF020F5" KeyPath="yes" Source="C:\Workspaces\Chatra\Website\SCBUDirect.B2CWeb\App_Config\Deployment\Deployment.Dev.CSR.config" />
                </Component>
                <Component Id="cmpA8F307EAB3BEB1352C23666A8E11D981" Directory="dir83BD7C94126520DBEDF76AF461521286" Guid="{3A42EC95-3DE5-4BB8-870F-E4AE8C8B1AE0}">
                    <File Id="fil8A99AE4CB701995838FD078019546D30" KeyPath="yes" Source="C:\Workspaces\Chatra\Website\SCBUDirect.B2CWeb\App_Config\Deployment\Deployment.Prod.config.xml" />
                </Component>
                <Component Id="cmpB64314E8A44B127FAE8A6CBAAF9AA052" Directory="dir83BD7C94126520DBEDF76AF461521286" Guid="{450B216D-7A3D-40EF-A41D-AAB2FA65BC5D}">
                    <File Id="fil0F1FCF642AF4B0D8A101964BCAFCA227" KeyPath="yes" Source="C:\Workspaces\Chatra\Website\SCBUDirect.B2CWeb\App_Config\Deployment\Deployment.Prod.CSR.config.xml" />
                </Component>
                <Component Id="cmpD59E44F90B1003A9D3FEEE194F8AA63D" Directory="dir83BD7C94126520DBEDF76AF461521286" Guid="{94AA1663-5043-4DA1-A60D-50FFEDED6B7A}">
                    <File Id="filCA238418D1A725B1303D44003BEE495E" KeyPath="yes" Source="C:\Workspaces\Chatra\Website\SCBUDirect.B2CWeb\App_Config\Deployment\Deployment.Test.config.xml" />
                </Component>
                <Component Id="cmp1AF2C8707EBD76A179C1CE20515E0A9B" Directory="dir83BD7C94126520DBEDF76AF461521286" Guid="{42342DFE-227C-4F70-B2E9-B9422DEA45AE}">
                    <File Id="filAB15496223BAA05CC1CCFED05F52E902" KeyPath="yes" Source="C:\Workspaces\Chatra\Website\SCBUDirect.B2CWeb\App_Config\Deployment\Deployment.Test.CSR.config.xml" />
                </Component>
                <Component Id="cmp89433C61AF95511BE1BC8121DAAAA401" Directory="dir83BD7C94126520DBEDF76AF461521286" Guid="{DDB6E815-9946-4744-8D1A-E4BE3D09EC2E}">
                    <File Id="filC0041C051A21C3705C9417015F51ACCC" KeyPath="yes" Source="C:\Workspaces\Chatra\Website\SCBUDirect.B2CWeb\App_Config\Deployment\Deployment.UAT.config.xml" />
                </Component>

                <Component Id="cmp131FA57DB66446A7226E0236B8ACAAFD" Directory="dir83BD7C94126520DBEDF76AF461521286" Guid="{6CA4CE62-33FD-4BF9-8E43-1A079983D492}">
                    <File Id="fil42A0BC81342E575F8EA9F004A065CCA4" KeyPath="yes" Source="C:\Workspaces\Chatra\Website\SCBUDirect.B2CWeb\App_Config\Deployment\Deployment.UAT.CSR.config.xml" />
                </Component>
     <Component Id="cmp3B36FD232E0AAD653B9259D5F2AC60A2" Directory="dirE4970414C520BB64F468385DC180508F" Guid="{BF4A808E-AFBD-4F43-8F90-20E38639C8BD}">
                    <File Id="filFD59C7E39C8BCA47D7ECEA7EBCA4E8FF" KeyPath="yes" Source="C:\Workspaces\Chatra\Website\SCBUDirect.B2CWeb\controls\ReferAFriend\ReferAFriendInfo.ascx" />
                </Component>

        </ComponentGroup>
        </Fragment>

                <Fragment>
                    <DirectoryRef Id="dir19836A556979704BCD883A1A4BC5ACCA">
                       <Directory Id="dir64C5FB989D956FBA878D608B754DE28A" Name="App_Config" />
                    </DirectoryRef>
                </Fragment> 
               <Fragment>
            <DirectoryRef Id="dir64C5FB989D956FBA878D608B754DE28A">
                <Directory Id="dir83BD7C94126520DBEDF76AF461521286" Name="Deployment" />
            </DirectoryRef>
              </Fragment>
     <Fragment>
            <DirectoryRef Id="dir0370A1E873AC03CA5FA01FB090FBCEF4">
                <Directory Id="dirE4970414C520BB64F468385DC180508F" Name="ReferAFriend" />
            </DirectoryRef>
        </Fragment>    
            </Wix> 
```

这是我的 xslt 文件提出的需要使其工作的内容。

```
 ?xml version="1.0" encoding="UTF-8"?>
        <xsl:stylesheet version="1.0"
            xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
            xmlns="http://schemas.microsoft.com/wix/2006/wi"
            xmlns:wix="http://schemas.microsoft.com/wix/2006/wi"
            xmlns:msxsl="urn:schemas-microsoft-com:xslt" exclude-result-prefixes="msxsl">

          <xsl:output method="xml" indent="yes"/>

          <!--<!–Identity Transform–&gt;-->
          <xsl:template match="@*|node()">
            <xsl:copy>
              <xsl:apply-templates select="@*|node()"/>
            </xsl:copy>
          </xsl:template>

          <!--<!–Set up keys for ignoring various file types–&gt;-->
          <xsl:key name="config-search" match="wix:Component[contains(wix:File/@Source, 'TestBuild_prod')]" use="@Id"/>
          <!--<!–Match and ignore TestBuild_prod files for dev Environment similarly vice-versa for prod Environment –&gt;-->
          <xsl:template match="wix:Component[key('config-search', @Id)]"/>
          <xsl:template match="wix:ComponentRef[key('config-search', @Id)]"/>

        </xsl:stylesheet> 
```

如果输入为“dev”，则在转换后，fragment.WXS 文件如下所示

```
 <?xml version="1.0" encoding="utf-8"?>
            <Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
                <Fragment>
                    <DirectoryRef Id="TARGETDIR">
                       <Directory Id="dir8EF11DA0EAFBFCB7A0B81343D3750C8B" Name="SCBUDirect" />
                    </DirectoryRef>
                </Fragment>

        <Fragment>
        <ComponentGroup Id="SCBUDirect">

        <Component Id="cmpE3B75974B57E1263C93B9B05FDFE715F" Directory="dir64C5FB989D956FBA878D608B754DE28A" Guid="{CA810124-F44B-4EF5-986A-07FAA67434AB}">
        <File Id="fil85729F855FDD131D6161043C08CB4543" KeyPath="yes" Source="C:\Workspaces\Chatra\Website\SCBUDirect.B2CWeb\App_Config\TestBuild_dev_ConnectionStrings.config" />
        </Component>

       <Component Id="cmp51A6C4030B563BC4A64DA99AED42D978" Directory="dir64C5FB989D956FBA878D608B754DE28A" Guid="{CF063EF0-6926-4D21-B89D-BD71E0E926F7}">
            <File Id="fil1494493122AA1F38F8D2C11F93A8D4E8" KeyPath="yes" Source="C:\Workspaces\Chatra\Website\SCBUDirect.B2CWeb\App_Config\Deployment.config" />
        </Component>

        <Component Id="cmpDF354EF7DC6C98108D05886911231011" Directory="dir64C5FB989D956FBA878D608B754DE28A" Guid="{F912A8C7-1226-49D6-897F-1878A1607B16}">
        <File Id="fil1058EF5A5E46590311096FFC704CD243" KeyPath="yes" Source="C:\Workspaces\Chatra\Website\SCBUDirect.B2CWeb\App_Config\basic.log4net.dev" />
        </Component>

        <Component Id="cmpE1C2EEC551696DCE99C2CAB9ED013C54" Directory="dir83BD7C94126520DBEDF76AF461521286" Guid="{A3D766EE-A488-468A-A7BF-DDB507B21299}">
                <File Id="fil2F90622E603C0AF703A504C3DE3A6201" KeyPath="yes" Source="C:\Workspaces\Chatra\Website\SCBUDirect.B2CWeb\App_Config\Deployment\Deployment.Dev.config" />
        </Component>

        <Component Id="cmpEBF2150BC59E378124B87AF387DA5519" Directory="dir83BD7C94126520DBEDF76AF461521286" Guid="{16CF5D16-A551-4184-9E9D-772A9277941A}">
                <File Id="fil9241DCC3F781240AD979AAF25BF020F5" KeyPath="yes" Source="C:\Workspaces\Chatra\Website\SCBUDirect.B2CWeb\App_Config\Deployment\Deployment.Dev.CSR.config" />
       </Component>

     <Component Id="cmp3B36FD232E0AAD653B9259D5F2AC60A2" Directory="dirE4970414C520BB64F468385DC180508F" Guid="{BF4A808E-AFBD-4F43-8F90-20E38639C8BD}">
                <File Id="filFD59C7E39C8BCA47D7ECEA7EBCA4E8FF" KeyPath="yes" Source="C:\Workspaces\Chatra\Website\SCBUDirect.B2CWeb\controls\ReferAFriend\ReferAFriendInfo.ascx" />
     </Component>

    </ComponentGroup>
    </Fragment>
                <Fragment>
                    <DirectoryRef Id="dir19836A556979704BCD883A1A4BC5ACCA">
                   <Directory Id="dir64C5FB989D956FBA878D608B754DE28A" Name="App_Config" />
                    </DirectoryRef>
                </Fragment>     
               <Fragment>
        <DirectoryRef Id="dir64C5FB989D956FBA878D608B754DE28A">
            <Directory Id="dir83BD7C94126520DBEDF76AF461521286" Name="Deployment" />
        </DirectoryRef>
             </Fragment> 
 <Fragment>
        <DirectoryRef Id="dir0370A1E873AC03CA5FA01FB090FBCEF4">
            <Directory Id="dirE4970414C520BB64F468385DC180508F" Name="ReferAFriend" />
        </DirectoryRef>
    </Fragment> 
 </Wix> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-21T16:25:08.160

这似乎可以满足您的要求。有一个`xsl:param`默认值为`dev`. 您可以对其进行修改以控制`Component`保留哪些元素。

**XML 输入**

```
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
    <Fragment>
        <DirectoryRef Id="TARGETDIR">
            <Directory Id="dir8EF11DA0EAFBFCB7A0B81343D3750C8B" Name="SCBUDirect" />
        </DirectoryRef>
    </Fragment>
    <Fragment>
        <ComponentGroup Id="SCBUDirect">

            <Component Id="cmpE3B75974B57E1263C93B9B05FDFE715F" Directory="dir64C5FB989D956FBA878D608B754DE28A" Guid="{CA810124-F44B-4EF5-986A-07FAA67434AB}">
                <File Id="fil85729F855FDD131D6161043C08CB4543" KeyPath="yes" Source="C:\Workspaces\Chatra\Website\SCBUDirect.B2CWeb\App_Config\TestBuild_dev_ConnectionStrings.config" />
            </Component>

            <Component Id="cmpERG5974B57E1263C93B9B05FDFE715F" Directory="dir64C5FB989D956FBA878D608B754DE28A" Guid="{ERGT50124-F44B-4EF5-986A-07FAA67434AB}">
                <File Id="fil8574324425555FDD131D6161043C08CB4543" KeyPath="yes" Source="C:\Workspaces\Chatra\Website\SCBUDirect.B2CWeb\App_Config\TestBuild_prod_ConnectionStrings.config" />
            </Component>

            <Component Id="cmp51A6C4030B563BC4A64DA99AED42D978" Directory="dir64C5FB989D956FBA878D608B754DE28A" Guid="{CF063EF0-6926-4D21-B89D-BD71E0E926F7}">
                <File Id="fil1494493122AA1F38F8D2C11F93A8D4E8" KeyPath="yes" Source="C:\Workspaces\Chatra\Website\SCBUDirect.B2CWeb\App_Config\Deployment.config" />
            </Component>

            <Component Id="cmpDF354EF7DC6C98108D05886911231011" Directory="dir64C5FB989D956FBA878D608B754DE28A" Guid="{F912A8C7-1226-49D6-897F-1878A1607B16}">
                <File Id="fil1058EF5A5E46590311096FFC704CD243" KeyPath="yes" Source="C:\Workspaces\Chatra\Website\SCBUDirect.B2CWeb\App_Config\basic.log4net.dev" />
            </Component>

            <Component Id="cmpD84FEB6CD3B1AE3534AA6B94CF5065C8" Directory="dir64C5FB989D956FBA878D608B754DE28A" Guid="{8BEBA112-9967-4DD9-96FC-25A879C5D6FA}">
                <File Id="filE0D63A4EC6CCCF6E9C06A91E04EA87E7" KeyPath="yes" Source="C:\Workspaces\Chatra\Website\SCBUDirect.B2CWeb\App_Config\basic.log4net.prod" />
            </Component>

            <Component Id="cmp0B6A1EF1380A825CC1F3894FAA38CC0B" Directory="dir64C5FB989D956FBA878D608B754DE28A" Guid="{60C807BD-142C-4C1F-8366-DC297657AB0A}">
                <File Id="fil20F28B0827462F414C432783951DD049" KeyPath="yes" Source="C:\Workspaces\Chatra\Website\SCBUDirect.B2CWeb\App_Config\basic.log4net.test" />
            </Component>

            <Component Id="cmp80CFA73AA353BE789D4539008E7F3516" Directory="dir64C5FB989D956FBA878D608B754DE28A" Guid="{0B3FA0E7-8F66-408C-944F-DAA0A847B6C4}">
                <File Id="fil2B292A388045FDF49475C9F6C5D144D1" KeyPath="yes" Source="C:\Workspaces\Chatra\Website\SCBUDirect.B2CWeb\App_Config\basic.log4net.uat" />
            </Component>

            <Component Id="cmpE1C2EEC551696DCE99C2CAB9ED013C54" Directory="dir83BD7C94126520DBEDF76AF461521286" Guid="{A3D766EE-A488-468A-A7BF-DDB507B21299}">
                <File Id="fil2F90622E603C0AF703A504C3DE3A6201" KeyPath="yes" Source="C:\Workspaces\Chatra\Website\SCBUDirect.B2CWeb\App_Config\Deployment\Deployment.Dev.config" />
            </Component>
            <Component Id="cmpEBF2150BC59E378124B87AF387DA5519" Directory="dir83BD7C94126520DBEDF76AF461521286" Guid="{16CF5D16-A551-4184-9E9D-772A9277941A}">
                <File Id="fil9241DCC3F781240AD979AAF25BF020F5" KeyPath="yes" Source="C:\Workspaces\Chatra\Website\SCBUDirect.B2CWeb\App_Config\Deployment\Deployment.Dev.CSR.config" />
            </Component>
            <Component Id="cmpA8F307EAB3BEB1352C23666A8E11D981" Directory="dir83BD7C94126520DBEDF76AF461521286" Guid="{3A42EC95-3DE5-4BB8-870F-E4AE8C8B1AE0}">
                <File Id="fil8A99AE4CB701995838FD078019546D30" KeyPath="yes" Source="C:\Workspaces\Chatra\Website\SCBUDirect.B2CWeb\App_Config\Deployment\Deployment.Prod.config.xml" />
            </Component>
            <Component Id="cmpB64314E8A44B127FAE8A6CBAAF9AA052" Directory="dir83BD7C94126520DBEDF76AF461521286" Guid="{450B216D-7A3D-40EF-A41D-AAB2FA65BC5D}">
                <File Id="fil0F1FCF642AF4B0D8A101964BCAFCA227" KeyPath="yes" Source="C:\Workspaces\Chatra\Website\SCBUDirect.B2CWeb\App_Config\Deployment\Deployment.Prod.CSR.config.xml" />
            </Component>
            <Component Id="cmpD59E44F90B1003A9D3FEEE194F8AA63D" Directory="dir83BD7C94126520DBEDF76AF461521286" Guid="{94AA1663-5043-4DA1-A60D-50FFEDED6B7A}">
                <File Id="filCA238418D1A725B1303D44003BEE495E" KeyPath="yes" Source="C:\Workspaces\Chatra\Website\SCBUDirect.B2CWeb\App_Config\Deployment\Deployment.Test.config.xml" />
            </Component>
            <Component Id="cmp1AF2C8707EBD76A179C1CE20515E0A9B" Directory="dir83BD7C94126520DBEDF76AF461521286" Guid="{42342DFE-227C-4F70-B2E9-B9422DEA45AE}">
                <File Id="filAB15496223BAA05CC1CCFED05F52E902" KeyPath="yes" Source="C:\Workspaces\Chatra\Website\SCBUDirect.B2CWeb\App_Config\Deployment\Deployment.Test.CSR.config.xml" />
            </Component>
            <Component Id="cmp89433C61AF95511BE1BC8121DAAAA401" Directory="dir83BD7C94126520DBEDF76AF461521286" Guid="{DDB6E815-9946-4744-8D1A-E4BE3D09EC2E}">
                <File Id="filC0041C051A21C3705C9417015F51ACCC" KeyPath="yes" Source="C:\Workspaces\Chatra\Website\SCBUDirect.B2CWeb\App_Config\Deployment\Deployment.UAT.config.xml" />
            </Component>

            <Component Id="cmp131FA57DB66446A7226E0236B8ACAAFD" Directory="dir83BD7C94126520DBEDF76AF461521286" Guid="{6CA4CE62-33FD-4BF9-8E43-1A079983D492}">
                <File Id="fil42A0BC81342E575F8EA9F004A065CCA4" KeyPath="yes" Source="C:\Workspaces\Chatra\Website\SCBUDirect.B2CWeb\App_Config\Deployment\Deployment.UAT.CSR.config.xml" />
            </Component>
            <Component Id="cmp3B36FD232E0AAD653B9259D5F2AC60A2" Directory="dirE4970414C520BB64F468385DC180508F" Guid="{BF4A808E-AFBD-4F43-8F90-20E38639C8BD}">
                <File Id="filFD59C7E39C8BCA47D7ECEA7EBCA4E8FF" KeyPath="yes" Source="C:\Workspaces\Chatra\Website\SCBUDirect.B2CWeb\controls\ReferAFriend\ReferAFriendInfo.ascx" />
            </Component>

        </ComponentGroup>
    </Fragment>

    <Fragment>
        <DirectoryRef Id="dir19836A556979704BCD883A1A4BC5ACCA">
            <Directory Id="dir64C5FB989D956FBA878D608B754DE28A" Name="App_Config" />
        </DirectoryRef>
    </Fragment> 
    <Fragment>
        <DirectoryRef Id="dir64C5FB989D956FBA878D608B754DE28A">
            <Directory Id="dir83BD7C94126520DBEDF76AF461521286" Name="Deployment" />
        </DirectoryRef>
    </Fragment>
    <Fragment>
        <DirectoryRef Id="dir0370A1E873AC03CA5FA01FB090FBCEF4">
            <Directory Id="dirE4970414C520BB64F468385DC180508F" Name="ReferAFriend" />
        </DirectoryRef>
    </Fragment>    
</Wix> 
```

**XSLT 1.0**

```
<xsl:stylesheet version="1.0" xmlns:wi="http://schemas.microsoft.com/wix/2006/wi" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:output indent="yes"/>
    <xsl:strip-space elements="*"/>

    <xsl:param name="type" select="'dev'"/>
    <xsl:variable name="lower" select="'abcdefghijklmnopqrstuvwxyz'"/>
    <xsl:variable name="upper" select="'ABCDEFGHIJKLMNOPQRSTUVWXYZ'"/>

    <xsl:template match="@*|node()" name="ident">
        <xsl:copy>
            <xsl:apply-templates select="@*|node()"/>
        </xsl:copy>
    </xsl:template>

    <xsl:template match="wi:Component">
        <xsl:choose>
            <xsl:when test="$type='dev'">
                <xsl:variable name="source" select="translate(wi:File/@Source,$upper,$lower)"/>
                <!--Note: These are not exact matches. contains() checks to see if the string is anywhere in $source.-->                
                <!--.test - substring($source,string-length($source) - 4,4)-->
                <xsl:if test="not(contains($source,'.test')) and not(contains($source,'.uat')) and not(contains($source,'.prod'))">
                    <xsl:call-template name="ident"/>
                </xsl:if>               
            </xsl:when>
            <xsl:when test="$type='blah'">
                <!--Copy xsl:if from above and modify for 'blah' types.-->
            </xsl:when>
            <xsl:otherwise>
                <!--If you need to output anything by default, it would go here. Otherwise, xsl:otherwise 
                is not needed and can be removed.-->
            </xsl:otherwise>
        </xsl:choose>
    </xsl:template>

</xsl:stylesheet> 
```

**XML 输出**

```
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
   <Fragment>
      <DirectoryRef Id="TARGETDIR">
         <Directory Id="dir8EF11DA0EAFBFCB7A0B81343D3750C8B" Name="SCBUDirect"/>
      </DirectoryRef>
   </Fragment>
   <Fragment>
      <ComponentGroup Id="SCBUDirect">
         <Component Id="cmpE3B75974B57E1263C93B9B05FDFE715F"
                    Directory="dir64C5FB989D956FBA878D608B754DE28A"
                    Guid="{CA810124-F44B-4EF5-986A-07FAA67434AB}">
            <File Id="fil85729F855FDD131D6161043C08CB4543"
                  KeyPath="yes"
                  Source="C:\Workspaces\Chatra\Website\SCBUDirect.B2CWeb\App_Config\TestBuild_dev_ConnectionStrings.config"/>
         </Component>
         <Component Id="cmpERG5974B57E1263C93B9B05FDFE715F"
                    Directory="dir64C5FB989D956FBA878D608B754DE28A"
                    Guid="{ERGT50124-F44B-4EF5-986A-07FAA67434AB}">
            <File Id="fil8574324425555FDD131D6161043C08CB4543"
                  KeyPath="yes"
                  Source="C:\Workspaces\Chatra\Website\SCBUDirect.B2CWeb\App_Config\TestBuild_prod_ConnectionStrings.config"/>
         </Component>
         <Component Id="cmp51A6C4030B563BC4A64DA99AED42D978"
                    Directory="dir64C5FB989D956FBA878D608B754DE28A"
                    Guid="{CF063EF0-6926-4D21-B89D-BD71E0E926F7}">
            <File Id="fil1494493122AA1F38F8D2C11F93A8D4E8"
                  KeyPath="yes"
                  Source="C:\Workspaces\Chatra\Website\SCBUDirect.B2CWeb\App_Config\Deployment.config"/>
         </Component>
         <Component Id="cmpDF354EF7DC6C98108D05886911231011"
                    Directory="dir64C5FB989D956FBA878D608B754DE28A"
                    Guid="{F912A8C7-1226-49D6-897F-1878A1607B16}">
            <File Id="fil1058EF5A5E46590311096FFC704CD243"
                  KeyPath="yes"
                  Source="C:\Workspaces\Chatra\Website\SCBUDirect.B2CWeb\App_Config\basic.log4net.dev"/>
         </Component>
         <Component Id="cmpE1C2EEC551696DCE99C2CAB9ED013C54"
                    Directory="dir83BD7C94126520DBEDF76AF461521286"
                    Guid="{A3D766EE-A488-468A-A7BF-DDB507B21299}">
            <File Id="fil2F90622E603C0AF703A504C3DE3A6201"
                  KeyPath="yes"
                  Source="C:\Workspaces\Chatra\Website\SCBUDirect.B2CWeb\App_Config\Deployment\Deployment.Dev.config"/>
         </Component>
         <Component Id="cmpEBF2150BC59E378124B87AF387DA5519"
                    Directory="dir83BD7C94126520DBEDF76AF461521286"
                    Guid="{16CF5D16-A551-4184-9E9D-772A9277941A}">
            <File Id="fil9241DCC3F781240AD979AAF25BF020F5"
                  KeyPath="yes"
                  Source="C:\Workspaces\Chatra\Website\SCBUDirect.B2CWeb\App_Config\Deployment\Deployment.Dev.CSR.config"/>
         </Component>
         <Component Id="cmp3B36FD232E0AAD653B9259D5F2AC60A2"
                    Directory="dirE4970414C520BB64F468385DC180508F"
                    Guid="{BF4A808E-AFBD-4F43-8F90-20E38639C8BD}">
            <File Id="filFD59C7E39C8BCA47D7ECEA7EBCA4E8FF"
                  KeyPath="yes"
                  Source="C:\Workspaces\Chatra\Website\SCBUDirect.B2CWeb\controls\ReferAFriend\ReferAFriendInfo.ascx"/>
         </Component>
      </ComponentGroup>
   </Fragment>
   <Fragment>
      <DirectoryRef Id="dir19836A556979704BCD883A1A4BC5ACCA">
         <Directory Id="dir64C5FB989D956FBA878D608B754DE28A" Name="App_Config"/>
      </DirectoryRef>
   </Fragment>
   <Fragment>
      <DirectoryRef Id="dir64C5FB989D956FBA878D608B754DE28A">
         <Directory Id="dir83BD7C94126520DBEDF76AF461521286" Name="Deployment"/>
      </DirectoryRef>
   </Fragment>
   <Fragment>
      <DirectoryRef Id="dir0370A1E873AC03CA5FA01FB090FBCEF4">
         <Directory Id="dirE4970414C520BB64F468385DC180508F" Name="ReferAFriend"/>
      </DirectoryRef>
   </Fragment>
</Wix> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T20:22:20.830

我已经为开发环境提出了以下解决方案，但不确定它是否有效。同样，我需要为“prod”、“uat”和“test”创建 XSLT 模板。但我相信你会提供更好的解决方案。通常所有文件都有其环境的点扩展名。

```
 <?xml version="1.0" encoding="UTF-8"?>
    <xsl:stylesheet version="1.0"
        xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
        xmlns="http://schemas.microsoft.com/wix/2006/wi"
        xmlns:wix="http://schemas.microsoft.com/wix/2006/wi"
        xmlns:msxsl="urn:schemas-microsoft-com:xslt" exclude-result-prefixes="msxsl">

      <xsl:output method="xml" indent="yes"/>
      <xsl:strip-space elements="*"/>

      <xsl:param name="type" select="'dev'"/>
      <xsl:variable name="lower" select="'abcdefghijklmnopqrstuvwxyz'"/>
      <xsl:variable name="upper" select="'ABCDEFGHIJKLMNOPQRSTUVWXYZ'"/>

      <!--<!–Identity Transform–&gt;-->
      <xsl:template match="@*|node()" name="ident">
        <xsl:copy>
          <xsl:apply-templates select="@*|node()"/>
        </xsl:copy>
      </xsl:template>

      <!--<!–Set up keys for ignoring various file types–&gt;-->
      <xsl:key name="prod" match="wix:Component[contains(wix:File/@Source, 'prod')]" use="@Id"/>
      <!--<!–Match and ignore .prod files–&gt;-->
      <xsl:template match="wix:Component[key('prod', @Id)]"/>
      <xsl:template match="wix:ComponentRef[key('prod', @Id)]"/>

           <!--<!–Set up keys for ignoring various file types–&gt;-->
      <xsl:key name="Prod" match="wix:Component[contains(wix:File/@Source, '.Prod')]" use="@Id"/>
      <!--<!–Match and ignore .Prod files–&gt;-->
      <xsl:template match="wix:Component[key('Prod', @Id)]"/>
      <xsl:template match="wix:ComponentRef[key('Prod', @Id)]"/>

          <!--<!–Set up keys for ignoring various file types–&gt;-->
      <xsl:key name="uat" match="wix:Component[contains(wix:File/@Source, '.uat')]" use="@Id"/>
      <!--<!–Match and ignore .uat files–&gt;-->
      <xsl:template match="wix:Component[key('uat', @Id)]"/>
      <xsl:template match="wix:ComponentRef[key('uat', @Id)]"/>

           <!--<!–Set up keys for ignoring various file types–&gt;-->
      <xsl:key name="UAT" match="wix:Component[contains(wix:File/@Source, '.UAT')]" use="@Id"/>
      <!--<!–Match and ignore .UAT files–&gt;-->
      <xsl:template match="wix:Component[key('UAT', @Id)]"/>
      <xsl:template match="wix:ComponentRef[key('UAT', @Id)]"/>

           <!--<!–Set up keys for ignoring various file types–&gt;-->
      <xsl:key name="Test" match="wix:Component[contains(wix:File/@Source, '.Test')]" use="@Id"/>
      <!--<!–Match and ignore .Test files–&gt;-->
      <xsl:template match="wix:Component[key('Test', @Id)]"/>
      <xsl:template match="wix:ComponentRef[key('Test', @Id)]"/>

               <!--<!–Set up keys for ignoring various file types–&gt;-->
      <xsl:key name="test" match="wix:Component[contains(wix:File/@Source, '.test')]" use="@Id"/>
      <!--<!–Match and ignore .test files–&gt;-->
      <xsl:template match="wix:Component[key('test', @Id)]"/>
      <xsl:template match="wix:ComponentRef[key('test', @Id)]"/>

    </xsl:stylesheet> 
```

# mysql - python3.3 TypeError: embedded NUL character

> ID：15005488
> 
> 赞同：1
> 
> 时间：2013-02-21T15:03:55.517
> 
> 标签：mysql, python-3.x, sqlalchemy, pyramid, mysql-connector

I searched about our problem but couldn't find anny solution.

I've installed mysqlconnector in a virtual environment. I also changed the connection string from the sqlalchemy scaffold in pyramidsthat uses sqllite to connect, to our connection string using mysqlconnector:

```
sqlalchemy.url = mysql+mysqlconnector://admin:admin@127.0.0.1:3306/tetten 
```

We use this code to initialise our database.

```
class Page(Base):
    """ The SQLAlchemy declarative model class for a Page object. """
    __tablename__ = 'pages'
    id = Column(Integer, primary_key=True)
    name = Column(String(40, convert_unicode=True), unique=True)
    data = Column(String(40, convert_unicode=True))

    def __init__(self, name, data):
        self.name = name
        self.data = data

class RootFactory(object):
    __acl__ = [ (Allow, Everyone, 'view'),
                (Allow, 'group:editors', 'edit') ]
    def __init__(self, request):
        pass 
```

The table 'pages' is created in the database and also gets filled with the right data. When I go to my browser I get the following error:

```
**builtins.TypeError**
TypeError: embedded NUL character 
```

with this output:

```
Traceback (most recent call last):
  File "c:\env\pyramid_debugtoolbar-1.0.4-py3.3.egg\pyramid_debugtoolbar\panels\performance.py", line 69, in noresource_timer_handler
    result = handler(request)
  File "C:\env\lib\site-packages\pyramid-1.4-py3.3.egg\pyramid\tweens.py", line 21, in excview_tween
    response = handler(request)
  File "C:\env\lib\site-packages\pyramid_tm-0.7-py3.3.egg\pyramid_tm\__init__.py", line 82, in tm_tween
    reraise(*exc_info)
  File "C:\env\lib\site-packages\pyramid_tm-0.7-py3.3.egg\pyramid_tm\compat.py", line 13, in reraise
    raise value
  File "C:\env\lib\site-packages\pyramid_tm-0.7-py3.3.egg\pyramid_tm\__init__.py", line 63, in tm_tween
    response = handler(request)
  File "C:\env\lib\site-packages\pyramid-1.4-py3.3.egg\pyramid\router.py", line 161, in handle_request
    response = view_callable(context, request)
  File "C:\env\lib\site-packages\pyramid-1.4-py3.3.egg\pyramid\config\views.py", line 367, in rendered_view
    context)
  File "C:\env\lib\site-packages\pyramid-1.4-py3.3.egg\pyramid\renderers.py", line 531, in render_view
    return self.render_to_response(response, system, request=request)
  File "C:\env\lib\site-packages\pyramid-1.4-py3.3.egg\pyramid\renderers.py", line 561, in render_to_response
    result = self.render(value, system_values, request=request)
  File "C:\env\lib\site-packages\pyramid-1.4-py3.3.egg\pyramid\renderers.py", line 557, in render
    result = renderer(value, system_values)
  File "C:\env\lib\site-packages\pyramid-1.4-py3.3.egg\pyramid\chameleon_zpt.py", line 42, in __call__
    result = self.template(**system)
  File "C:\env\lib\site-packages\chameleon-2.11-py3.3.egg\chameleon\template.py", line 125, in __call__
    return self.render(**kwargs)
  File "C:\env\lib\site-packages\chameleon-2.11-py3.3.egg\chameleon\zpt\template.py", line 257, in render
    return super(PageTemplate, self).render(**vars)
  File "C:\env\lib\site-packages\chameleon-2.11-py3.3.egg\chameleon\template.py", line 169, in render
    self.cook_check()
  File "C:\env\lib\site-packages\chameleon-2.11-py3.3.egg\chameleon\template.py", line 293, in cook_check
    self.cook(body)
  File "C:\env\lib\site-packages\chameleon-2.11-py3.3.egg\chameleon\template.py", line 147, in cook
    program = self._cook(body, digest, names)
  File "C:\env\lib\site-packages\chameleon-2.11-py3.3.egg\chameleon\template.py", line 218, in _cook
    source = self._make(body, builtins)
  File "C:\env\lib\site-packages\chameleon-2.11-py3.3.egg\chameleon\template.py", line 249, in _make
    program = self.parse(body)
  File "C:\env\lib\site-packages\chameleon-2.11-py3.3.egg\chameleon\zpt\template.py", line 202, in parse
    trim_attribute_space=self.trim_attribute_space,
  File "C:\env\lib\site-packages\chameleon-2.11-py3.3.egg\chameleon\zpt\program.py", line 145, in __init__
    super(MacroProgram, self).__init__(*args, **kwargs)
  File "C:\env\lib\site-packages\chameleon-2.11-py3.3.egg\chameleon\program.py", line 32, in __init__
    node = self.visit(kind, args)
  File "C:\env\lib\site-packages\chameleon-2.11-py3.3.egg\chameleon\program.py", line 38, in visit
    return visitor(*args)
  File "C:\env\lib\site-packages\chameleon-2.11-py3.3.egg\chameleon\zpt\program.py", line 270, in visit_element
    STATIC_ATTRIBUTES = self._create_static_attributes(prepared)
  File "C:\env\lib\site-packages\chameleon-2.11-py3.3.egg\chameleon\zpt\program.py", line 790, in _create_static_attributes
    return Static(parse(repr(static_attrs)).body)
  File "C:\env\lib\site-packages\chameleon-2.11-py3.3.egg\chameleon\astutil.py", line 48, in parse
    return compile(source, '', mode, ast.PyCF_ONLY_AST)
TypeError: embedded NUL character 
```

Does anny1 have a solution for my problem?

*edit:*

I found this link in the bug section of python. Altough I don't think it's a bug, this might be related to my problem. Can't seem to figure it out how it works tough. [http://bugs.python.org/issue13617](http://bugs.python.org/issue13617)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T10:18:07.780

这与您的 SQLAlchemy 设置无关；这是您的模板引擎 (Chameleon) 编译成 Python 代码以提高速度和失败，因为您的模板中有一个 NUL 字符。

使用文本编辑器检查您的模板，并确保文件中没有不可打印的字节。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T12:23:42.207

我无法在 Linux 上重现它。我的猜测是它是特定于 Windows 的，并且是 Python 中的一个错误。

# php - 将列传递给外部 ajax 调用

> ID：15005499
> 
> 赞同：0
> 
> 时间：2013-02-21T15:04:24.803
> 
> 标签：php, jqgrid

我正在使用 custom_func 来验证编辑中的字段并添加以进行表单编辑。此 custom_func 正在对服务器进行 ajax 调用以验证帐号。问题是该列没有发布到 php.ini 中。

查询功能：

```
function chkAcct(value,colname){
    // var result = null;
    $.ajax({
        async: false,
        url: 'functions.php',
        type: 'POST',
        data: {action: 'chkAcct'},
        // dataType: 'xml',
        // contentType: 'application/xml; charset=utf-8',
        success: function(response){                
        if(response){
            result = [true,""];                 
        }
        else{
           result = [false,"This account already exists"];
        }
        alert(response);
        },          
        });
    return result;
} 
```

PHP 功能：

```
function chkAcct($conn){
    $sql = "SELECT dist_id FROM batch WHERE open_flg = '1'";
    $query = pg_query($conn,$sql);
    $row = pg_fetch_row($query);
    $dist = distConversion($row[0]);
    $cntrct_id = $dist.$_POST['cntrct_id'];

    $sql = "SELECT COUNT(*) FROM addru ad, cntrt ct WHERE ct.cntrct_id = '$cntrct_id' AND ad.cntrct_seq = ct.cntrct_seq AND ad.active_flg = '1'";   
    $query = pg_query($conn,$sql);
    $row = pg_fetch_row($query);
    $count1 = $row[0];

    $sql = "SELECT COUNT(*) FROM nmaddr nm WHERE nm.cntrct_id = '$cntrct_id'";
    $query = pg_query($conn,$sql);
    $row = pg_fetch_row($query);
    $count2 = $row[0];
    $total = $count1+$count2;

    if($total === 0){
        $myfile = "text.txt";
        $fh = fopen($myfile,'a');
        fwrite($fh,$total);
        fclose($fh);
        echo $cntrct_id;
     }
  } 
```

最后，有问题的行：

```
 { name:'cntrct_id',
        editoptions:{ maxlength:8 }, 
        editrules:{
            custom:true, 
            custom_func: chkAcct,
        }  
    }, 
```

我尝试在行的编辑选项中使用 data:{ cntrct_id: 'cntrct_id' } 手动将列​​的值发送到服务器，但无济于事。我还能尝试什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T15:06:16.830

您没有发布该`cntrct_id`字段，您只是发布`chkAcct`.

您需要通过将其添加到数据对象来发布合同字段：

```
data: {
  action: 'chkAcct',
  cntrct_id: $('#cntrct_id').val()
} 
```

替换`$('#cntrct_id')`为对数据的正确引用。

# javascript - 使用 AJAX 加载跨域端点

> ID：15005500
> 
> 赞同：135
> 
> 时间：2013-02-21T15:04:31.107
> 
> 标签：javascript, jquery, ajax, cross-domain

我正在尝试使用 AJAX 加载跨域 HTML 页面，但除非 dataType 是“jsonp”，否则我无法得到响应。然而，使用 jsonp 浏览器需要一个脚本 mime 类型，但正在接收“text/html”。

我的请求代码是：

```
$.ajax({
    type: "GET",
    url: "http://saskatchewan.univ-ubs.fr:8080/SASStoredProcess/do?_username=DARTIES3-2012&_password=P@ssw0rd&_program=%2FUtilisateurs%2FDARTIES3-2012%2FMon+dossier%2Fanalyse_dc&annee=2012&ind=V&_action=execute",
    dataType: "jsonp",
}).success( function( data ) {
    $( 'div.ajax-field' ).html( data );
}); 
```

有什么方法可以避免使用 jsonp 请求？我已经尝试过使用 crossDomain 参数，但它不起作用。

如果没有，有什么方法可以在 jsonp 中接收 html 内容？目前，控制台在 jsonp 回复中说“unexpected <”。

* * *

## 回答 #1

> 赞同：240
> 
> 时间：2013-06-25T14:18:13.427

# jQuery Ajax 笔记

*   由于浏览器安全限制，大部分**Ajax**请求都受[同源策略](http://en.wikipedia.org/wiki/Same_origin_policy)的约束；请求无法从不同的域、子域、端口或协议成功检索数据。
*   脚本和 JSONP 请求不受同源策略限制。

有一些方法可以克服**跨域**障碍：

*   [CORS 代理替代品](http://alternativeto.net/software/cors-proxy/)
*   [规避同源政策的方法](https://stackoverflow.com/questions/3076414/ways-to-circumvent-the-same-origin-policy)
*   [打破跨域壁垒](http://www.slideshare.net/SlexAxton/breaking-the-cross-domain-barrier)

有一些插件可以帮助处理**跨域**请求：

*   [使用 YQL 和 jQuery 的跨域 AJAX 请求](http://net.tutsplus.com/tutorials/javascript-ajax/quick-tip-cross-domain-ajax-request-with-yql-and-jquery/)
*   [使用 jQuery.ajax 的跨域请求](http://james.padolsey.com/javascript/cross-domain-requests-with-jquery/)

**小心！**

解决这个问题最好的办法，就是在后端创建自己的代理，让你的代理指向其他域的服务，因为后端不存在**同源策略**限制。但是，如果您不能在后端执行此操作，请注意以下提示。

* * *

**警告！**

使用第三方代理不是一种安全的做法，因为它们可以跟踪您的数据，因此它可以用于公共信息，但**不能**用于私人数据。

* * *

*下面显示的代码示例使用**[jQuery.get()](http://api.jquery.com/jquery.get/)**和**[jQuery.getJSON()](http://api.jquery.com/jquery.getjson/)**，它们都是**[jQuery.ajax()的简写方法](http://api.jquery.com/jQuery.ajax/)***

* * *

# CORS 无处不在

### 2021 更新

[公共演示服务器 (cors-anywhere.herokuapp.com) 将在 2021 年 1 月 31 日之前非常有限](https://github.com/Rob--W/cors-anywhere/issues/301)

> CORS Anywhere 的演示服务器 (cors-anywhere.herokuapp.com) 旨在作为该项目的演示。但是滥用已经变得如此普遍，以至于托管演示的平台 (Heroku) 要求我关闭服务器，尽管我们努力抵制这种滥用。由于滥用及其流行，停机时间变得越来越频繁。
> 
> 为了解决这个问题，我将进行以下更改：
> 
> 1.  速率限制将从每小时 200 次降至每小时 50 次。
> 2.  到 2021 年 1 月 31 日，cors-anywhere.herokuapp.com 将停止作为开放代理。
> 3.  从2月1日开始。2021 年，cors-anywhere.herokuapp.com 将仅在访问者完成挑战后提供请求：用户（开发人员）必须访问 cors-anywhere.herokuapp.com 的页面以临时解锁其浏览器的演示。这允许开发人员尝试该功能，以帮助决定自托管或寻找替代方案。

* * *

CORS Anywhere 是一个**node.js 代理**，它将 CORS 标头添加到代理请求中。
要使用 API，只需在 URL 前面加上 API URL。（支持**https**：见[github 仓库](https://github.com/Rob--W/cors-anywhere/)）

如果您想在需要时自动启用跨域请求，请使用以下代码段：

```
$.ajaxPrefilter( function (options) {
  if (options.crossDomain && jQuery.support.cors) {
    var http = (window.location.protocol === 'http:' ? 'http:' : 'https:');
    options.url = http + '//cors-anywhere.herokuapp.com/' + options.url;
    //options.url = "http://cors.corsproxy.io/url=" + options.url;
  }
});

$.get(
    'http://en.wikipedia.org/wiki/Cross-origin_resource_sharing',
    function (response) {
        console.log("> ", response);
        $("#viewer").html(response);
}); 
```

* * *

# 无论起源

[无论 Origin](http://whateverorigin.org/)是**跨域 jsonp**访问。[这是anyorigin.com](http://anyorigin.com/)的开源替代方案。

要从*google.com 获取数据，*您可以使用以下代码段：

```
// It is good specify the charset you expect.
// You can use the charset you want instead of utf-8.
// See details for scriptCharset and contentType options: 
// http://api.jquery.com/jQuery.ajax/#jQuery-ajax-settings
$.ajaxSetup({
    scriptCharset: "utf-8", //or "ISO-8859-1"
    contentType: "application/json; charset=utf-8"
});

$.getJSON('http://whateverorigin.org/get?url=' + 
    encodeURIComponent('http://google.com') + '&callback=?',
    function (data) {
        console.log("> ", data);

        //If the expected response is text/plain
        $("#viewer").html(data.contents);

        //If the expected response is JSON
        //var response = $.parseJSON(data.contents);
}); 
```

* * *

# CORS 代理

CORS 代理是一个简单的**node.js 代理**，可以为任何网站启用 CORS 请求。它允许您网站上的 javascript 代码访问其他域上的资源，这些资源通常会由于同源策略而被阻止。

*   [CORS 代理 gr2m](https://github.com/gr2m/CORS-Proxy)
*   [CORS-代理 rmadhuram](https://github.com/rmadhuram/corsproxy)

它是如何工作的？CORS 代理利用了跨域资源共享，这是与 HTML 5 一起添加的功能。服务器可以指定他们希望浏览器允许其他网站请求他们托管的资源。CORS 代理只是一个 HTTP 代理，它在响应中添加一个标头，说“任何人都可以请求这个”。

这是实现目标的另一种方式（参见[www.corsproxy.com](http://www.corsproxy.com/)）。您所要做的就是剥离**http://**和**www。**来自被代理的 URL，并在 URL 前面加上`www.corsproxy.com/`

```
$.get(
    'http://www.corsproxy.com/' +
    'en.wikipedia.org/wiki/Cross-origin_resource_sharing',
    function (response) {
        console.log("> ", response);
        $("#viewer").html(response);
}); 
```

* * *

# CORS 代理浏览器

最近我发现了这个，它涉及各种面向安全的跨域远程共享实用程序。但它是一个以 Flash 为后端的黑盒。

你可以在这里看到它的实际效果：[CORS 代理浏览器](http://koto.github.io/cors-proxy-browser/)
在 GitHub 上获取源代码：[koto/cors-proxy-browser](https://github.com/koto/cors-proxy-browser)

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2014-08-03T16:30:52.793

您可以使用 Ajax-cross-origin 一个 jQuery 插件。使用此插件，您可以使用`jQuery.ajax()`跨域。它使用谷歌服务来实现这一点：

> AJAX Cross Origin 插件使用 Google Apps 脚本作为未实现 jSONP 的代理 jSON getter。当您将 crossOrigin 选项设置为 true 时，插件会将原始 url 替换为 Google Apps 脚本地址并将其作为编码的 url 参数发送。Google Apps 脚本使用 Google 服务器资源来获取远程数据，并将其作为 JSONP 返回给客户端。

使用非常简单：

```
 $.ajax({
        crossOrigin: true,
        url: url,
        success: function(data) {
            console.log(data);
        }
    }); 
```

你可以在这里阅读更多： [http ://www.ajax-cross-origin.com/](http://www.ajax-cross-origin.com/)

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2013-02-21T15:05:47.167

如果外部站点不支持 JSONP 或 CORS，您唯一的选择是使用代理。

在您的服务器上构建一个请求该内容的脚本，然后使用 jQuery ajax 在您的服务器上点击该脚本。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2017-09-17T22:08:38.343

只需将其放在您的 PHP 页面的标题中，如果没有 API，它将无法正常工作：

```
header('Access-Control-Allow-Origin: *'); //allow everybody 
```

或者

```
header('Access-Control-Allow-Origin: http://codesheet.org'); //allow just one domain 
```

或者

```
$http_origin = $_SERVER['HTTP_ORIGIN'];  //allow multiple domains

$allowed_domains = array(
  'http://codesheet.org',
  'http://stackoverflow.com'
);

if (in_array($http_origin, $allowed_domains))
{  
    header("Access-Control-Allow-Origin: $http_origin");
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-05-18T10:46:37.477

我发布这个以防有人面临我现在面临的同样问题。我有一台配备 ZebraNet 打印服务器的 Zebra 热敏打印机，它提供了一个基于 HTML 的用户界面，用于编辑多个设置、查看打印机的当前状态等。我需要获取打印机的状态，显示在其中一个 html 页面中，由 ZebraNet 服务器提供，例如，alert() 向浏览器中的用户发送一条消息。这意味着我必须首先在 Javascript 中获取该 html 页面。尽管打印机在用户 PC 的 LAN 内，但该[同源策略](https://en.wikipedia.org/wiki/Same-origin_policy)仍然坚定地挡在我的路上。我尝试了 JSONP，但服务器返回 html，我还没有找到修改其功能的方法（如果可以的话，我已经设置了魔术头 Access-control-allow-origin: *）。所以我决定用 C# 编写一个小型控制台应用程序。它必须以管理员身份运行才能正常工作，否则它会引发 :D 异常。这是一些代码：

```
// Create a listener.
        HttpListener listener = new HttpListener();
        // Add the prefixes.
        //foreach (string s in prefixes)
        //{
        //    listener.Prefixes.Add(s);
        //}
        listener.Prefixes.Add("http://*:1234/"); // accept connections from everywhere,
        //because the printer is accessible only within the LAN (no portforwarding)
        listener.Start();
        Console.WriteLine("Listening...");
        // Note: The GetContext method blocks while waiting for a request. 
        HttpListenerContext context;
        string urlForRequest = "";

        HttpWebRequest requestForPage = null;
        HttpWebResponse responseForPage = null;
        string responseForPageAsString = "";

        while (true)
        {
            context = listener.GetContext();
            HttpListenerRequest request = context.Request;
            urlForRequest = request.RawUrl.Substring(1, request.RawUrl.Length - 1); // remove the slash, which separates the portNumber from the arg sent
            Console.WriteLine(urlForRequest);

            //Request for the html page:
            requestForPage = (HttpWebRequest)WebRequest.Create(urlForRequest);
            responseForPage = (HttpWebResponse)requestForPage.GetResponse();
            responseForPageAsString = new StreamReader(responseForPage.GetResponseStream()).ReadToEnd();

            // Obtain a response object.
            HttpListenerResponse response = context.Response;
            // Send back the response.
            byte[] buffer = System.Text.Encoding.UTF8.GetBytes(responseForPageAsString);
            // Get a response stream and write the response to it.
            response.ContentLength64 = buffer.Length;
            response.AddHeader("Access-Control-Allow-Origin", "*"); // the magic header in action ;-D
            System.IO.Stream output = response.OutputStream;
            output.Write(buffer, 0, buffer.Length);
            // You must close the output stream.
            output.Close();
            //listener.Stop(); 
```

用户需要做的就是以管理员身份运行该控制台应用程序。我知道这太……令人沮丧和复杂，但它是域策略问题的一种解决方法，以防您无法以任何方式修改服务器。

编辑：从js我做了一个简单的ajax调用：

```
$.ajax({
                type: 'POST',
                url: 'http://LAN_IP:1234/http://google.com',
                success: function (data) {
                    console.log("Success: " + data);
                },
                error: function (e) {
                    alert("Error: " + e);
                    console.log("Error: " + e);
                }
            }); 
```

返回请求页面的 html 并将其存储在**data**变量中。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-06-22T12:44:09.117

要通过使用 jherax 建议的本地代理传递来获取外部站点的数据，您可以创建一个 php 页面，该页面从相应的外部 url 为您获取内容，然后向该 php 页面发送获取请求。

```
var req = new XMLHttpRequest();
req.open('GET', 'http://localhost/get_url_content.php',false);
if(req.status == 200) {
   alert(req.responseText);
} 
```

作为 php 代理，您可以使用[https://github.com/cowboy/php-simple-proxy](https://github.com/cowboy/php-simple-proxy)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-01-26T07:12:18.773

这些天你`URL`不工作，但你的代码可以用这个工作解决方案更新：

```
var url = "http://saskatchewan.univ-ubs.fr:8080/SASStoredProcess/do?_username=DARTIES3-2012&_password=P@ssw0rd&_program=%2FUtilisateurs%2FDARTIES3-2012%2FMon+dossier%2Fanalyse_dc&annee=2012&ind=V&_action=execute";

url = 'https://google.com'; // TEST URL

$.get("https://images"+~~(Math.random()*33)+"-focus-opensocial.googleusercontent.com/gadgets/proxy?container=none&url=" + encodeURI(url), function(data) {
    $('div.ajax-field').html(data);
});
```

```
<div class="ajax-field"></div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
```

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2016-06-01T23:23:08.330

您需要 CORS 代理，它将您的请求从浏览器代理到具有适当[CORS 标头](https://en.wikipedia.org/wiki/Cross-origin_resource_sharing)的请求服务。此类服务的列表在下面的代码片段中。您还可以运行提供的代码片段以查看从您所在位置对此类服务的 ping。

```
$('li').each(function() {
  var self = this;
  ping($(this).text()).then(function(delta) {
    console.log($(self).text(), delta, ' ms');
  });
});
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<script src="https://cdn.rawgit.com/jdfreder/pingjs/c2190a3649759f2bd8569a72ae2b597b2546c871/ping.js"></script>
<ul>
  <li>https://crossorigin.me/</li>
  <li>https://cors-anywhere.herokuapp.com/</li>
  <li>http://cors.io/</li>
  <li>https://cors.5apps.com/?uri=</li>
  <li>http://whateverorigin.org/get?url=</li>
  <li>https://anyorigin.com/get?url=</li>
  <li>http://corsproxy.nodester.com/?src=</li>
  <li>https://jsonp.afeld.me/?url=</li>
  <li>http://benalman.com/code/projects/php-simple-proxy/ba-simple-proxy.php?url=</li>
</ul>
```

* * *

## 回答 #9

> 赞同：-7
> 
> 时间：2015-06-16T12:45:23.190

弄清楚了。改用这个。

```
$('.div_class').load('http://en.wikipedia.org/wiki/Cross-origin_resource_sharing #toctitle'); 
```

# python - 为什么python不能读取我的环境变量？

> ID：15005501
> 
> 赞同：5
> 
> 时间：2013-02-21T15:04:35.593
> 
> 标签：python, linux, django, environment-variables

我正在使用 Django，我正在尝试设置几个环境变量来定义要导入的设置。

我使用以下文件夹层次结构：

```
project_folder>
    app_folder>
    project_specific_files>
        settings>
            base.py
            local.py 
```

我使用[Kenneth Reitz 的 autoenv](https://github.com/kennethreitz/autoenv)来加载我的环境变量。我知道它工作正常，因为我可以输入`$ echo $DJANGO_SETTINGS_MODULE`并看到以下输出：

```
project_specific_files.settings.local 
```

但是当我跑步时，`$django-admin.py runserver`我得到：

```
ImportError: Settings cannot be imported, because environment variable DJANGO_SETTINGS_MODULE is undefined. 
```

另外，如果我进入 python shell 并尝试打印出环境变量，我会得到以下信息：

```
Python 2.7.3 (default, Dec 22 2012, 21:14:12) 
[GCC 4.7.2] on linux2
Type "help", "copyright", "credits" or "license" for more information.
>>> import os
>>> print os.environ['HOME']
/home/marco
>>> print os.environ['DJANGO_SETTINGS_MODULE']
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "/home/marco/.virtualenvs/myproject/lib/python2.7/UserDict.py", line 23, in __getitem__
    raise KeyError(key)
KeyError: 'DJANGO_SETTINGS_MODULE' 
```

有人知道可能出了什么问题吗？谢谢！

另外，我可以打字`$ django-admin.py runserver --settings='project_specific_files.settings.local`，一切都会好起来的 0.o

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-21T15:11:04.463

您的环境变量是否已导出？

也许环境变量是在当前 shell 中定义的，但没有标记为要导出到子进程（python 解释器或 Django）。

使用 bash，运行：`export DJANGO_SETTINGS_MODULE`

# php - 与 Symfony 1.4 的左连接略有不同，Doctrine

> ID：15005502
> 
> 赞同：1
> 
> 时间：2013-02-21T15:04:39.393
> 
> 标签：php, doctrine, symfony-1.4

有用户：

```
id | name
 1    user1
 2    testuser 
```

有任务：

```
id | creatorid | ownerid| name
1     1           1        task1
2     1           2        task2
3     2           1        task3
4     2           2        task4 
```

我做了这样的事情：

```
Doctrine_Core::getTable('User')->createQuery()->leftJoin('User.Task') 
```

但是这些表是用“creatorid”连接的，而不是“ownerid”，如何指定呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-21T16:16:00.563

I use Doctrine_Query

```
$q = Doctrine_Query::create()
        ->select('u.*, t.*')
        ->from('Users u')
        ->leftJoin('u.Tasks t ON u.id = t.creatorid');

echo $q->getSqlQuery(); 
```

[Doctrine 1.2 Left Join Documentation](http://docs.doctrine-project.org/projects/doctrine1/en/latest/en/manual/dql-doctrine-query-language.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T07:30:50.350

这取决于您如何定义表`Task`上的关系`Users`。你应该有类似的东西：

```
Tasks:
...
  relations:
    owner: {class: User, local: ownerId, foreign: id, foreignAlias: ownedTasks}
    creator: {class: User, local: creatorId, foreign: id, foreignAlias: createdTasks} 
```

然后你可以使用：

```
Doctrine_Core::getTable('User')->createQuery()->leftJoin('User.ownedTasks) 
```

业主加入或

```
Doctrine_Core::getTable('User')->createQuery()->leftJoin('User.createdTasks') 
```

由创建者加入。

# jquery - jQuery 插件 .live() 到 .on()

> ID：15005508
> 
> 赞同：3
> 
> 时间：2013-02-21T15:04:58.643
> 
> 标签：jquery, plugins, live

如何改变

```
$.fn.ajaxFormPostLink = function() {    
    this.live('click', function() {
        var $this = $(this); 
```

...

`.on()`对于使用not的 somenthig `.live()`，我尝试了：

```
$.fn.ajaxFormPostLink = function() {    
    $("body").on('click', this, function() {
        var $this = $(this); 
```

...

但是id不起作用，所以如何在jQuery插件中`live()`更改`on()`。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-21T15:09:03.840

重新构建要以这种方式使用的插件：

```
$.ajaxFormPostLink(".someform",{... options ...}); 
```

例如：

```
$.ajaxFormPostLink = function(selector,options) {

    $(document).on("click",selector,function(){
        ...
    });

}; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-21T15:08:40.287

尝试这个：

```
$("body").on('click', this.selector, function() { 
```

假设您正在处理简单的 jQuery 对象。

# javascript - Javascript 事件在 JSF 命令按钮中不起作用

> ID：15005517
> 
> 赞同：0
> 
> 时间：2013-02-21T15:05:19.673
> 
> 标签：javascript, java, jsf, dom-events, jsf-1.2

我正在研究 JSF 1.x 在 JavaServer Faces in Action 中所述的一个示例。

命令按钮上调用的 javascript 不起作用。两个 onmouseover/out 事件都没有执行这些方法。

**我的项目结构如下：**

![结构](../Images/fb27c0948cc15577f0b19b84df0269a7.png)

在这个例子中我没有使用任何 Java 代码，它只包含一个登录页面。

**login.jsp 如下：**

```
 <%@ taglib uri="http://java.sun.com/jsf/html" prefix="h"%>
<%@ taglib uri="http://java.sun.com/jsf/core" prefix="f"%>

<f:view>
<html>
<head>
    <link rel="stylesheet" type="text/css" href="stylesheet.css" />

    <script type="text/javascript">
        function set_image(button, image){
            button.src = img;
        }
    </script>

    <title><h:outputText value="ProjectTrack" /></title>
</head>

<body>

    <h:form>
        <h:panelGrid columns="2" border="0" cellpadding="3" cellspacing="3">

            <h:graphicImage url="/images/logo.png"
                    alt="Welcome to ProjectTrack" title="Welcome to ProjectTrack"
                    width="149" height="160" />

            <h:panelGrid columns="3" border="0" cellpadding="5" cellspacing="3" headerClass="login-heading">

                <f:facet name="header">
                    <h:outputText value="ProjectTrack" />
                </f:facet>

                <h:outputLabel for="userNameInput" >
                    <h:outputText value="Enter your user name: " />
                </h:outputLabel>

                <h:inputText id="userNameInput" size="20" maxlength="30" required="true">
                    <f:validateLength minimum="5" maximum="30"/>
                </h:inputText>

                <h:message for="userNameInput" />

                <h:outputLabel for="passwordInput">
                    <h:outputText value="Password"/>
                </h:outputLabel>

                <h:inputSecret id="passwordInput" size="20" maxlength="20" required="true">
                    <f:validateLength minimum="5" maximum="15" />
                </h:inputSecret>

                <h:message for="passwordInput" />

                <h:panelGroup>
                    <h:commandButton  action="success" 
                                image="/images/submit.gif" 
                                onmouseover="set_image(this, '/images/submit_over.gif'); alert('button: ' + this );"
                                onmouseout="set_image(this, '/images/submit.gif'); alert('button: ' + this ); " 
                            />
                </h:panelGroup>

            </h:panelGrid>

        </h:panelGrid>

        <h:outputText value=" Debug test for EL exp : #{facesContext.externalContext.requestContextPath}/images/submit.gif" />
    </h:form>
</body>
</f:view>
    </html> 
```

**我的部署描述符 web.xml 如下：**

```
<web-app version="2.5"
      xmlns="http://java.sun.com/xml/ns/javaee"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://java.sun.com/xml/ns/javaee
      http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd">

    <display-name>Project Track</display-name>
    <description>Sample Project</description>

    <servlet>
        <servlet-name>Faces Servlet</servlet-name>
        <servlet-class>javax.faces.webapp.FacesServlet</servlet-class>
        <load-on-startup>1</load-on-startup>
    </servlet>

    <servlet-mapping>
        <servlet-name>Faces Servlet</servlet-name>
        <url-pattern>/faces/*</url-pattern>
    </servlet-mapping>

    <welcome-file-list>
        <welcome-file>faces/login.jsp</welcome-file>
    </welcome-file-list>

</web-app> 
```

**Faces-config.xml 如下：**

```
<?xml version="1.0"?>
<!DOCTYPE faces-config PUBLIC
     "-//Sun Microsystems, Inc.//DTD JavaServer Faces Config 1.0//EN"
     "http://java.sun.com/dtd/web-facesconfig_1_0.dtd">

<faces-config>

    <application>
        <message-bundle>ptrackResources</message-bundle>
    </application>

    <navigation-rule>
        <from-view-id>/login.jsp</from-view-id>
        <navigation-case>
            <from-outcome>success</from-outcome>
            <to-view-id>/inbox.jsp</to-view-id>
        </navigation-case>
        <navigation-case>
            <from-outcome>failure</from-outcome>
            <to-view-id>/login.jsp</to-view-id>
        </navigation-case>
    </navigation-rule>

</faces-config> 
```

**我的 Maven 依赖项如下：**

```
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
  <modelVersion>4.0.0</modelVersion>
  <groupId>com.achutha.labs</groupId>
  <artifactId>03JsfExample</artifactId>
  <version>0.0.1-SNAPSHOT</version>
  <packaging>war</packaging>
  <name>03JsfExample</name>
  <description>Project Track</description>

  <dependencies>

        <dependency>
            <groupId>javax.faces</groupId>
            <artifactId>jsf-api</artifactId>
            <version>1.2_14</version>
        </dependency>
        <dependency>
            <groupId>javax.faces</groupId>
            <artifactId>jsf-impl</artifactId>
            <version>1.2_14</version>
        </dependency>

        <dependency>
            <groupId>javax.servlet</groupId>
            <artifactId>jstl</artifactId>
            <version>1.2</version>
        </dependency>

        <dependency>
            <groupId>javax.servlet</groupId>
            <artifactId>servlet-api</artifactId>
            <version>2.5</version>
        </dependency>

        <dependency>
            <groupId>javax.servlet.jsp</groupId>
            <artifactId>jsp-api</artifactId>
            <version>2.1</version>
        </dependency>

        <!-- EL -->
        <dependency>
            <groupId>org.glassfish.web</groupId>
            <artifactId>el-impl</artifactId>
            <version>2.2</version>
        </dependency>

    </dependencies>

    <build>
        <finalName>JavaServerFaces</finalName>

        <plugins>

            <plugin>
                <groupId>org.codehaus.mojo</groupId>
                <artifactId>tomcat-maven-plugin</artifactId>
                <configuration>
                    <url>http://localhost:8090/manager/text</url>
                    <server>TomcatServer</server>
                    <path>/balaji</path>
                </configuration>
            </plugin>

            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-compiler-plugin</artifactId>
                <version>2.3.1</version>
                <configuration>
                    <source>1.6</source>
                    <target>1.6</target>
                </configuration>
            </plugin>
        </plugins>
    </build>

</project> 
```

应用程序运行成功。但是“提交的图像”按钮未显示，该按钮是通过运行时表达式检索的。

**浏览器显示：**

![在此处输入图像描述](../Images/8e7b2ec97c37296d0cd3c6ff52370b7c.png)

JavaScript 没有调用声明的事件。

```
<h:commandButton  action="success" 
                                    image="/images/submit.gif" 
                                    onmouseover="set_image(this, '/images/submit_over.gif'); alert('button: ' + this );"
                                    onmouseout="set_image(this, '/images/submit.gif'); alert('button: ' + this ); " 
                                /> 
```

我必须使用 JSF 1.x 并且无法将其升级到 JSF 2。请向我建议解决方案，并帮助我知道出了什么问题。

**之前：**

如问题[#{facesContext} EL 表达式在运行时未解析中](https://stackoverflow.com/questions/15002141/facescontext-el-expression-not-resolved-at-runtime)所述， 我将以下语句用于命令按钮。

```
<h:commandButton  action="success" 
                                image="#{facesContext.externalContext.requestContextPath}/images/submit.gif" 
                                onmouseover="set_image(this, '#{facesContext.externalContext.requestContextPath}/images/submit_over.gif');"
                                onmouseout="set_image(this, '#{facesContext.externalContext.requestContextPath}/images/submit.gif');" 
                            /> 
```

我刚刚添加了一个 Debug 语句，`login.jsp`如下所示：

```
<h:outputText value=" Debug test for EL exp : #{facesContext.externalContext.requestContextPath}/images/submit.gif" /> 
```

**调试结果：**

![调试结果](../Images/938144f29b7ddf05a3fb273dbb7b6f35.png)

表达式在运行时被评估，（但未看到提交图像）消除了之前的问题。因此，我删除了 EL 语句，并将它们替换为没有附加项目名称的相对路径。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T01:53:30.523

我弄清楚了错误是什么。

我的 javascript 代码是错误的。

```
<script type="text/javascript">
        function set_image(button, image){
            button.src = img;
        }
    </script> 
```

我将 img 更改为 image ：

```
<script type="text/javascript">
        function set_image(button, image){
            button.src = image;
        }
    </script> 
```

然后事件开始正常工作。但是第二张图片“submit_over.gif”没有检索显示。

然后我将 EL 表达式添加到事件中：

```
<h:commandButton  action="success" 
                                image="/images/submit.gif" 
                                onmouseover="set_image(this, '#{facesContext.externalContext.requestContextPath}/images/submit_over.gif');"
                                onmouseout="set_image(this, '#{facesContext.externalContext.requestContextPath}/images/submit.gif');" 
                            /> 
```

这解决了我所有的问题。

谢谢大家的意见和建议。你的建议奏效了。

# file - 删除对我的 asp-classic 网站中文件和文件夹的访问权限

> ID：15005523
> 
> 赞同：0
> 
> 时间：2013-02-21T15:05:39.967
> 
> 标签：file, iis, asp-classic, permissions, file-access

我有一个经典的 asp 网站，用户可以上传一些保存在我网站子文件夹中的文件。

我刚刚注意到，如果我浏览到该文件夹​​，我会看到我的文件列表。localhost/myfiles 所以我已经删除了目录浏览。

但如果我知道文件名，我可以打开它：localhost/myfiles/file1.pdf

我不在乎登录的用户是否访问文件，但问题是即使我没有连接我也可以访问它。

经典asp中有没有办法阻止访问，我知道在.net中是可能的

更多：我不想更改 myfiles 文件夹的位置并将其从网站中删除...

编辑：即使我从我的网站下取出文件夹，我也不确定我是否能够从网站上获取/保存文件，有人可以确认吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T17:14:27.420

这是一篇非常好的帖子，可以解决您的要求

也许最好的选择是...

创建一个在查询字符串中接收文件名并从服务器端提供文件的页面： [http ://www.webmasterworld.com/forum47/2275.htm](http://www.webmasterworld.com/forum47/2275.htm)

对于您想要做的事情，这并不是一个简单的解决方案。

可能也有使用 ARR 的方法来执行此操作，但这对于您想要做的事情可能非常复杂。

# ios - 地图setRegion时MKMapView冻结

> ID：15005524
> 
> 赞同：0
> 
> 时间：2013-02-21T15:05:40.350
> 
> 标签：ios, objective-c, iphone-developer-program

我正在尝试设置区域，但是当我设置区域时，地图冻结并且我无法移动地图...

这是我的代码

```
 -(void) configurarZoomDoMapaComLatitude:(double)latitude eLongitude:(double)longitude {
_myMapView.userInteractionEnabled = YES;
CLLocation *localizacao = [[CLLocation alloc]initWithLatitude:latitude longitude:longitude]; //regiao de ref. (usar localizacao atual)
double miles = 0.5; // quanto menor, mais próximo
double scalingFactor = ABS( (cos(2 * M_PI * localizacao.coordinate.latitude / 360.0) ));

MKCoordinateSpan span;
span.latitudeDelta = miles/69.0;
span.longitudeDelta = miles/(scalingFactor * 69.0);

MKCoordinateRegion region;
region.span = span;
region.center = localizacao.coordinate;
[_myMapView setRegion:region animated:YES];
} 
```

* * *

## 回答 #1

> 赞同：-3
> 
> 时间：2013-02-21T16:34:21.363

我已经解决了这个问题......我在地图添加中做了一个视图......我删除了它并且它有效！谢谢大家

# postgresql - Disadvantages of removing unused foreign key indexes?

> ID：15005531
> 
> 赞同：0
> 
> 时间：2013-02-21T15:06:08.230
> 
> 标签：postgresql, indexing, foreign-keys

Foreign key indexes are never used as you can see in pg_stat_user_indexes table. I want to remove them. Are there any disadvantages of removing foreign keys indexes due to non-usage.

```
db=# SELECT * FROM pg_stat_user_indexes WHERE relname='order_cancellationreason';
     relid | indexrelid | schemaname |         relname          |                indexrelname                 | idx_scan | idx_tup_read | idx_tup_fetch 
    -------+------------+------------+--------------------------+---------------------------------------------+----------+--------------+---------------
     29835 |      31055 | public     | order_cancellationreason | order_cancellationreason_address_id         |        0 |            0 |             0
     29835 |      31053 | public     | order_cancellationreason | order_cancellationreason_cancelled_by_id    |        0 |            0 |             0

 db=#\d+ order_cancellationreason
     ...
     Indexes:
        "order_cancellationreason_cancelled_by_id" btree (cancelled_by_id)
        "order_cancellationreason_address_id" btree (address_id)

    Foreign-key constraints:
        "cargo_id_refs_id_f4ffe34d" FOREIGN KEY (cargo_id) REFERENCES cargo_cargoinfo(id) DEFERRABLE INITIALLY DEFERRED
        "order_cancellationreason_address_id_fkey" FOREIGN KEY (address_id) REFERENCES invoice_address(id) DEFERRABLE INITIALLY DEFERRED
        "order_cancellationreason_cancelled_by_id_fkey" FOREIGN KEY (cancelled_by_id) REFERENCES auth_user(id) DEFERRABLE INITIALLY DEFERRED 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T02:47:40.417

Indexes on the referring foreign key column are not required for referential integrity enforcement. You only need a unique index on the referred-to column for that.

The only downside to removing the index on the referring column is that checks and enforcement can be very slow. If you attempt to delete a row from the FK target table, the database must check whether that value appears in the referring column and either reject the delete or, for `ON DELETE CASCADE` keys, delete it. Either way, without an index on the referring column this will likely lead to a seqscan. For small referring tables that's fine, but for a big referring table and especially where multiple FK checks are being made, performance can be truly awful.

If your application doesn't ever actually use the FK checks, ie they're there to declare the data model and for peace of mind rather than the expectation that they'll actually be checked and enforced, then removing the referring column index may be fine.

If your app actually performs deletes or updates on the referred-to table, I'd recommend keeping the index.

I haven't verified that FK enforcement checks properly appear in `pg_stat_user_indexes`. I'd recommend checking that yourself; try running some deletes you know will fail on the referred-to table, and see if the index stats on the referring column change.

# python - Django 应用程序中的 urls.py 在测试博客上导致 404 错误

> ID：15005532
> 
> 赞同：0
> 
> 时间：2013-02-21T15:06:14.453
> 
> 标签：python, django, django-urls

我正在学习 Python 和 Django，并且正在构建一个测试博客。我没有遵循 Django 书中给出的官方教程（我发现它很难理解和学习），而是遵循[这里](http://sandcurves.com/blog_engine/)给出的教程。这对我了解管理界面以及模板部分的内容有很大帮助（包括一些示例 HTML，我认为它不包含在 Django 官方书籍中）。

这是我的 urls.py 示例（位于 myproject/myproject/urls.py 中）：

```
from django.conf.urls import patterns, include, url

# Uncomment the next two lines to enable the admin:
from django.contrib import admin
admin.autodiscover()

urlpatterns = patterns('',
    # Examples:
    # url(r'^$', 'myblog.views.home', name='home'),
    # url(r'^myblog/', include('myblog.foo.urls')),

    # Uncomment the admin/doc line below to enable admin documentation:
    # url(r'^admin/doc/', include('django.contrib.admindocs.urls')),

    # Uncomment the next line to enable the admin:
    url(r'^admin/', include(admin.site.urls)),
    url(r'^', include('blog.urls')),
) 
```

这是我的 urls.py 的示例（位于 myproject/blog/urls.py 中）：

```
from django.conf.urls.defaults import *

urlpatterns = patterns('',
    (r'^$', 'blog.views.liist'),
    (r'^archive/(\d{1,2})/$', 'blog.views.liist'),
    (r'^\d{4}/d{1,2}/(.*)/$', 'blog.views.detail'),
    (r'^(\d{4})/(\d{1,2})/$', 'blog.views.month'),
    (r'^(\d{4})/$', 'blog.views.year'),
    (r'^category/$', 'blog.views.category'),
    (r'^category/(.*)/$', 'blog.views.one_category'),
    (r'^tag/$', 'blog.views.tag'),
    (r'^tag/(.*)/$', 'blog.views.one_tag'),

) 
```

*   127.0.0.1:8000 - 有效
*   127.0.0.1:8000/admin - 有效
*   127.0.0.1:8000/2013/2/fourth-post/ - 404

有什么我错过的吗？有人可以指出故障排除的步骤，或者检查什么，或者哪个部分会引发错误？因为我不知道从哪里开始进行故障排除。

我需要在这里发布任何其他信息来帮助我的情况吗？

*   Django 版本 - 1.4.3
*   Python 版本 - 2.7
*   操作系统 - Windows XP

提前致谢。

编辑：

这就是我的 views.py 文件中“详细信息”功能的样子：

```
def detail(request,sl):
    try:
         post = Post.objects.filter(slug=sl)[0]
         try:
              previous_post = post.get_previous_by_published()
         except:
              previous_post = ""
         try:
              next_post = post.get_next_by_published()
         except:
              next_post = ""
    except:
         next_post = ""
         previous_post = ""
         post = ""
    return render_to_response('blog/detail.html', {'post':post,
                                            'next_post':next_post,
                                            'previous_post':previous_post,
                                           },) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-21T15:12:23.623

尝试：

```
(r'^(\d{4})/(\d{1,2})/([-\w]+)/$', 'blog.views.detail') 
```

另外，一定要查看有关 URL 的官方文档：[https ://docs.djangoproject.com/en/1.4/topics/http/urls/#overview](https://docs.djangoproject.com/en/1.4/topics/http/urls/#overview)

# android - Android NDK 测试指令值

> ID：15005536
> 
> 赞同：0
> 
> 时间：2013-02-21T15:06:21.053
> 
> 标签：android, android-ndk, preprocessor, directive

我有一个使用 Android NDK 的 Android 项目。

在文件**Application.mk**中，我使用了一个名为**MYDIRECTIVE**的自定义指令：

```
APP_CFLAGS := -DMYDIRECTIVE=TEST 
```

在 .cpp 文件中，我想测试它的值：

```
#ifdef MYDIRECTIVE
#if MYDIRECTIVE == 'TEST'
/* do some stuff */
#else
#error MYDIRECTIVE is unknown
#endif
#endif 
```

问题是我收到**MYDIRECTIVE is unknown**消息。

当我使用**V=1**选项编译时，我在编译中看到指令：

```
 -MYDIRECTIVE=TEST 
```

我尝试使用**'TEST'**、**TEST**和**"TEST"**进行测试，但仍然出现错误。

有什么帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T15:12:25.890

您不能使用 `#if`指令来检查字符串是否相等。正如[GCC 文档中](http://gcc.gnu.org/onlinedocs/cpp/If.html)所说：

> `#if' 指令允许您测试**算术** 表达式的值。

无论如何，在 C 中，您不会通过 using`==`而是通过 using 来比较字符串`strcmp()`。并且预处理器不能使用`strcmp()`.

也许您可能想`MYDIRECTIVETEST`改用：

```
#ifdef MYDIRECTIVETEST
/* do some stuff */
#else
#error MYDIRECTIVETEST is unknown
#endif 
```

# css - 即使使用媒体查询，网站在智能手机上看起来也大不相同

> ID：15005541
> 
> 赞同：0
> 
> 时间：2013-02-21T15:06:32.567
> 
> 标签：css, media-queries

编辑：我设法调整了一个更好的结果，将视口设置为 0.25。但我仍然有一些可怕的事情发生。例如，操作栏设置为 100%，并且只占屏幕的 70%。

我这里有个大问题。

我正在开发一个网站，没什么大不了的。但我必须让它对智能手机也有响应。

好吧，我为此使用媒体查询，并使用窗口大小调整器来使用确切的宽度。

我也为 div 使用 % 值，当然不是高度，而是宽度。

当我在 chrome 上“模拟”时，布局工作得很好，完全没有问题。

但是，例如，当我在 Galaxy S2 上进行测试时，看起来真的很厚实。我不知道我能做些什么来让它完全一样。

[http://www2.madeinweb.com.br/jobs/adc/prototype/html/](http://www2.madeinweb.com.br/jobs/adc/prototype/html/)

这是我现在正在工作的家。正确的媒体查询是这样的：

```
@media only screen and (min-width : 320px) and (max-width : 640px) {} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T15:53:04.077

您是否尝试过添加`-webkit-min-device-pixel-ratio: 1.5`或`and (orientation : portrait)`. 您可以在此处找到有关移动像素密度的信息：http: [//bjango.com/articles/min-device-pixel-ratio/](http://bjango.com/articles/min-device-pixel-ratio/)

在您的情况下，如果向下滚动，您将看到`Galaxy S2`

# svn - 如何在 SVN 中使用新的存储库 URL 更新签出的存储库？

> ID：15005550
> 
> 赞同：0
> 
> 时间：2013-02-21T15:06:52.067
> 
> 标签：svn

由于一些服务器更改和重组，我想更改为我们存储库的 url

[http://unitas.sports-reference.com/svn/br_repos/br/trunk](http://unitas.sports-reference.com/svn/br_repos/br/trunk) [http://foo.example.com/svn/repos](http://foo.example.com/svn/repos)

到

[http://bar.example.com/svn/repos](http://bar.example.com/svn/repos)

我可以处理存储库本身的更新，但是如何更新已签出的存储库副本，而不必将其删除然后再将其签出。svn开关？这是完全相同的存储库，只是在一个新位置。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-21T15:08:43.040

您可以使用[svn](http://svnbook.red-bean.com/en/1.7/svn.ref.svn.c.relocate.html) relocate或[svn switch --relocate](http://svnbook.red-bean.com/en/1.7/svn.ref.svn.html#svn.ref.svn.sw.relocate)如果您使用的是没有该`svn relocate`命令的旧 svn 客户端版本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-21T15:09:16.727

如果您访问 svn 命令行：

```
sudo svn switch --relocate http://old.example.com/repo http://new.example.com/repo 
```

# android - Android：水平放置单选按钮

> ID：15005551
> 
> 赞同：70
> 
> 时间：2013-02-21T15:06:55.000
> 
> 标签：android, radio-button

下面是我的相对布局..我试图将单选按钮放在编辑文本上方

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:background="#FFFFFF" >

    <ImageView
        android:id="@+id/fbreplycancel"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentRight="true"
        android:layout_alignParentTop="true"
        android:src="@drawable/fbcancel" />

    <RelativeLayout
        android:id="@+id/relativeLayout1"
        android:layout_width="80dp"
        android:layout_height="250dp"
        android:layout_alignParentRight="true"
        android:layout_below="@+id/fbcancel" >

        <Spinner
            android:id="@+id/replyspinner"
            android:layout_width="50dp"
            android:layout_height="30dp"
            android:layout_alignLeft="@+id/fbshare"
            android:layout_alignRight="@+id/fbshare"
            android:layout_below="@+id/fbshare"
            android:layout_marginTop="16dp"
            android:drawSelectorOnTop="true"
            android:entries="@array/fbcommentlist"
            android:visibility="gone" />

        <Button
            android:id="@+id/fbshare"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_alignParentBottom="true"
            android:layout_centerHorizontal="true"
            android:background="@drawable/fbbuttons"
            android:text="@string/share" />

        <ImageView
            android:id="@+id/fbpeople"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_above="@+id/fbshare"
            android:layout_centerHorizontal="true"
            android:layout_marginBottom="19dp"
            android:background="@drawable/people2"
            android:drawSelectorOnTop="true"
            android:paddingTop="20dp" />

        <RadioButton
            android:id="@+id/radio2"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_alignParentLeft="true"
            android:layout_centerVertical="true"
            android:text="RadioButton" />
    </RelativeLayout>

    <View
        android:layout_width="250dp"
        android:layout_height="0.7dip"
        android:layout_alignParentLeft="true"
        android:layout_alignParentRight="true"
        android:layout_below="@+id/imageView1"
        android:background="#3b5998" />

    <ImageView
        android:id="@+id/imageView1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignBottom="@+id/fbcancel"
        android:layout_alignParentLeft="true"
        android:layout_alignParentTop="true"
        android:paddingRight="2dp"
        android:src="@drawable/askabud" />

    <TextView
        android:id="@+id/fbcommentpostedby"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignLeft="@+id/fbedittext"
        android:layout_alignRight="@+id/fbcommentdisplay"
        android:layout_below="@+id/imageView1"
        android:layout_marginTop="15dp"
        android:textColor="#000000" />

    <TextView
        android:id="@+id/fbcommentdisplay"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignLeft="@+id/fbedittext"
        android:layout_below="@+id/fbcommentpostedby"
        android:layout_toLeftOf="@+id/relativeLayout1"
        android:textColor="#000000" />

    <TextView
        android:id="@+id/fbtextview"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignBottom="@+id/imageView1"
        android:layout_toLeftOf="@+id/fbreplycancel"
        android:layout_toRightOf="@+id/imageView1"
         android:text="@string/replyrecommend" 
          android:textSize="18sp"
          android:textColor="#000000"/>

    <TextView
        android:id="@+id/fbplacename"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignLeft="@+id/fbcommentdisplay"
        android:layout_alignRight="@+id/fbcommentdisplay"
        android:layout_below="@+id/fbcommentdisplay"
        android:textColor="#000000" />

    <EditText
        android:id="@+id/fbedittext"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_below="@+id/fbplacename"
        android:layout_marginLeft="19dp"
        android:layout_marginTop="45dp"
        android:layout_toLeftOf="@+id/relativeLayout1"
        android:background="@drawable/roundcorners"
        android:ems="10"
        android:hint="@string/fbhint"
        android:lines="6"
        android:scrollHorizontally="true"
        android:textSize="14sp"
        android:windowSoftInputMode="stateHidden" />

    <RadioGroup
        android:id="@+id/radioGroup1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_below="@+id/fbplacename" >

        <RadioButton
            android:id="@+id/radio0"
            android:layout_width="30dp"
            android:layout_height="30dp"
            android:checked="true"
            android:text="1"
             />
    </RadioGroup>

    <RadioGroup
        android:id="@+id/radioGroup2"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignTop="@+id/radioGroup1"
        android:layout_toLeftOf="@+id/relativeLayout1" >

        <RadioButton
            android:id="@+id/radio0"
            android:layout_width="26dp"
            android:layout_height="wrap_content"
            android:checked="true"
            android:text="3" />

        <RadioButton
            android:id="@+id/radio2"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="RadioButton" />
    </RadioGroup>

    <RadioButton
        android:id="@+id/radio1"
        android:layout_width="30dp"
        android:layout_height="30dp"
        android:layout_alignTop="@+id/radioGroup2"
        android:layout_toLeftOf="@+id/radioGroup2"
        android:text="2" />

</RelativeLayout> 
```

我正面临着水平排列它们的困难时期。感谢任何帮助。

* * *

## 回答 #1

> 赞同：165
> 
> 时间：2013-02-21T15:17:50.483

要将无线电组（或任何其他视图）置于其他上方，只需执行以下操作：

```
android:layout_above="@+id/view_below" 
```

要更改刚刚设置的方向：

```
android:orientation="horizontal" 
```

并为项目提供相等的宽度，请使用`layout_weight`：

```
<RadioGroup
    android:id="@+id/radio_group"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:orientation="horizontal"
    android:layout_above="@+id/view_below" >

    <RadioButton
        android:id="@+id/radio1"
        android:layout_width="0dp"
        android:layout_weight="1"
        android:layout_height="wrap_content"
        android:checked="true"
        android:text="First" />

    <RadioButton
        android:id="@+id/radio2"
        android:layout_width="0dp"
        android:layout_weight="1"
        android:layout_height="wrap_content"
        android:text="Second" />
</RadioGroup> 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-21T15:22:38.950

您可以使用表格布局而不是相对布局。将行插入表格布局并将单选按钮放置在表格行内。

对于等间距，请遵循以下步骤

```
<TableRow
        android:id="@+id/tableRow2"
        android:layout_width="0dp"
        android:layout_height="wrap_content"
        android:layout_marginTop="50dp" >

        <RadioButton
            android:id="@+id/button2"
            android:layout_width="5dp"
            android:layout_height="60dp"
            android:layout_weight="1"
            android:text="@string/btnReject"
            android:onClick="onCallRejectButton" />

        <RadioButton
            android:id="@+id/button1"
            android:layout_width="5dp"
            android:layout_height="60dp"
            android:layout_weight="1
            android:onClick="onCallAcceptButton"
            android:text="@string/btnAccept" />

    </TableRow> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-02-16T15:51:31.833

android:orientation="horizo​​ntal" 就这样做。在 radiogroup 标签中输入方向水平属性

```
 <RadioGroup
    android:id="@+id/radio"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:orientation="horizontal">

    <RadioButton
        android:id="@+id/radioMale"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="Male"
        android:checked="true" />

    <RadioButton
        android:id="@+id/radioFemale"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="Female" />

</RadioGroup> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-06-08T10:45:27.527

您只需要将无线电组方向设置为水平。

```
 <RadioGroup                                    
android:id="@+id/radio_group_forgot_password"
android:layout_width="match_parent"
android:layout_height="wrap_content"
**android:orientation="horizontal"**                               
> 
```

# parsing - 不适用于 JSTL 1.2

> ID：15005554
> 
> 赞同：0
> 
> 时间：2013-02-21T15:07:07.693
> 
> 标签：parsing, exception, jstl, tomcat7, catch-block

我正在使用 JSTL 1.2 (Apache Taglibs) 实现一个简单的 JSP 页面。该页面执行以下操作：

```
 <c:catch var="error">
            <fmt:parseNumber var="parsedNum" value="${param.num}" />
        </c:catch> 
```

HTML 输入元素如下所示：

```
 <input type="text" name="num" size="3"/> 
```

我知道由于解析机制的工作方式，允许输入“12a”。不过，我想捕捉完全错误的输入，例如“aaa”。不幸的是，抛出的异常不是由 管理的`<c:catch>`，导致 Tomcat 7 显示整个堆栈跟踪。

有什么建议吗？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T16:14:50.053

请为我们发布一个可测试的页面。例如，以下页面对我来说很好。

```
<%@taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c"%> 
<%@ taglib prefix="fmt" uri="http://java.sun.com/jsp/jstl/fmt" %>
<c:catch var="error">
<fmt:parseNumber var="parsedNum" value="aaa" />
</c:catch>
${parsedNum}
${error} 
```

# sql - Select 语句中的日期减法

> ID：15005555
> 
> 赞同：3
> 
> 时间：2013-02-21T15:07:19.323
> 
> 标签：sql, vba, ms-access

我目前正在研究 MS Access 数据库，并且遇到日期减法问题。

本质上，我正在尝试创建一个目标日期，例如：

目标日期 = 截止日期 - 提前期

即提前期可能为 30 天，因此目标日期应在截止日期前 30 天。

我尝试使用的代码是这样的：

```
strSQL = "INSERT INTO dbo_DEALER_TASK ( Dlr_Number, Action_Id, Task_Id, Area_Id, 
Task_Deadline_Date, Responsible_Person_Id, Alternate_Person_Id, Priority, Comment, 
Suppress_Email, Dealer_Type ) "

strSQL = strSQL & "SELECT dbo_DEALER_ACTION.Dlr_Number, dbo_DEALER_ACTION.Action_Id, 
qryAllTasksToAdd.Task_Id, qryAllTasksToAdd.Area_Id, Deadline_Date - Deadline_adjustment 
AS 'Task_Deadline_Date', qryAllTasksToAdd.Person_Responsible_Id, 
qryAllTasksToAdd.Alternate_Responsible_Id, qryAllTasksToAdd.Priority, 
qryAllTasksToAdd.Comment, qryAllTasksToAdd.Suppress_Email, 
qryAllTasksToAdd.Applies_To_Dealer_Type "

strSQL = strSQL & "FROM dbo_DEALER_ACTION LEFT JOIN qryAllTasksToAdd ON 
(dbo_DEALER_ACTION.Dealer_Type = qryAllTasksToAdd.Applies_To_Dealer_Type) AND 
(dbo_DEALER_ACTION.Action_Id = qryAllTasksToAdd.Action_Id) "

strSQL = strSQL & WHERE (((qryAllTasksToAdd.Task_Id)=" & Me.Task_Id & ") AND 
((dbo_DEALER_ACTION.Date_Completed) Is Null));"

DoCmd.RunSQL strSQL 
```

当 VBA 代码执行该语句时，所有内容都会正确更新，但 Task_Deadline_Date 字段除外，该字段留空。

真正让我困惑的是，如果我独立运行这个 SQL 语句，它会按预期工作。在尝试了许多不同的想法后，我尝试用字符串文字日期替换“Deadline_Date - Deadline_adjustment AS 'Task_Deadline_Date'”，然后该语句运行良好

有人知道出了什么问题吗？

谢谢，

克里斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T15:15:06.883

您引用了别名，您不应该这样做：

```
 Deadline_Date - Deadline_adjustment AS Task_Deadline_Date 
```

不是

```
 Deadline_Date - Deadline_adjustment AS 'Task_Deadline_Date' 
```

添加引号时，该字段的名称是`'Task_Deadline_Date'`

根据日期字段的数据类型以及是否使用 SQL Server，您可能需要使用 DateAdd，例如：

```
DateAdd("d",-[Deadline_adjustment],[Deadline_Date]) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T22:05:44.413

听起来您在 dbo_DEALER_TASK 中插入的列的数据类型实际上不是日期时间字段。

> 我尝试用字符串文字日期替换“Deadline_Date - Deadline_adjustment AS 'Task_Deadline_Date'”，然后该语句运行良好

如果您的意思是“2012 年 2 月 20 日”（例如，您将在 SQL Server 上正确使用），那么这在 Access 中不应该起作用，并且只有当您的输出列是文本（= varchar/char））数据类型时才会起作用. Access 中的日期常量指定为 #02/20/2012#

请在您的输出表中确认 Task_Deadline_Date 的数据类型。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-21T16:29:27.687

在 Access 的查询设计器中，从可以工作的查询版本开始，并将其转换为参数查询。

```
WHERE
        qryAllTasksToAdd.Task_Id=[which_id]
    AND dbo_DEALER_ACTION.Date_Completed Is Null; 
```

您还可以`PARAMETERS`在查询开始时添加一条语句，以告知数据库引擎您的参数的数据类型。例子 ...

```
PARAMETERS which_id Text ( 255 );
PARAMETERS which_id Long; 
```

一旦你得到那个查询，保存它并给它一个名字。然后，您的 VBA 过程可以使用该保存的查询，为其提供参数值并执行它。

```
Dim db As DAO.database
Dim qdf As DAO.QueryDef

Set db = CurrentDb
Set qdf = db.QueryDefs("YourQuery")
qdf.Parameters("which_id").value = Me.Task_Id
qdf.Execute dbFailOnError
Set qdf = Nothing
Set db = Nothing 
```

这应该比每次需要执行时都尝试在 VBA 代码中重新创建该 SQL 语句要容易得多。

# iphone - 显示没有动画的 UIKeyboard

> ID：15005556
> 
> 赞同：3
> 
> 时间：2013-02-21T15:07:27.990
> 
> 标签：iphone, ios, objective-c, cocoa-touch, uikeyboard

在objective-c 中设置`becomeFirstResponder`时`UITextField`键盘会从底部向上滑动。

有没有办法禁用这个动画？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-21T15:15:57.893

在动画过程之间执行此操作，就像这样

```
[UIView beginAnimations:nil context:nil];
    [UIView setAnimationDuration:0.0];
    [UIView setAnimationDelay:0.0];
    [UIView setAnimationCurve:UIViewAnimationCurveLinear];

    [textField becomeFirstResponder];

    [UIView commitAnimations]; 
```

如果以上由于任何原因不起作用，那么您可以使用通知

[看到这个链接](https://stackoverflow.com/questions/1851566/display-keyboard-without-animation)

# dwolla - 注册用户和添加资金来源是否需要 OAuth 流程

> ID：15005557
> 
> 赞同：0
> 
> 时间：2013-02-21T15:07:35.637
> 
> 标签：dwolla

API 当前启用的注册用户和添加资金来源的流程是什么？据我所知，我似乎需要：

1.  调用“注册用户”来创建帐户
2.  按照 OAuth 流程获取新用户的身份验证令牌
3.  对“资金来源 - 添加”进行经过身份验证的调用

注册用户和添加资金来源是否需要 OAuth 流程？

我的问题与几个月前 Clay Gulick 在以下 GetSatisfaction 线程中提出的问题非常相似，但尚未得到回答。 [https://getsatisfaction.com/dwolla/topics/does_api_facilitate_to_add_bank_account_to_my_endusers_dwolla_account](https://getsatisfaction.com/dwolla/topics/does_api_facilitate_to_add_bank_account_to_my_endusers_dwolla_account)

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T01:58:20.977

o用户的身份验证不是必需的，[`registerUser() (Requires Authentication: NO)`](https://developers.dwolla.com/dev/docs/register/register) 而是必需的[`addFundingSource() (Requires Authentication: YES)`](https://developers.dwolla.com/dev/docs/funding/add)。根据您的语言，用户的 oAuth 令牌会像这样添加（PHP）：

```
$token='xxxxxxx'; //user's oAuth token
$Dwolla->setToken($token); 
```

请注意，对于两个 API 调用，您都需要与您的 oAuth 令牌不同的应用程序密钥。

# ruby - 线程对这种情况有益吗？

> ID：15005562
> 
> 赞同：1
> 
> 时间：2013-02-21T15:07:49.077
> 
> 标签：ruby, multithreading, mongodb

我有一个超过 100 万行的 CSV 文件。我还有一个以格式化方式包含此类数据的数据库。

我想检查和验证CSV文件中的数据和数据库中的数据。

从 CSV 文件读取线程并使用数据库连接池是否有益/减少时间？

Ruby 处理线程的能力如何？

我也在使用 MongoDB。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-21T15:23:05.913

如果不了解有关您希望应用程序在有人启动此比较时的感觉的具体细节的更多细节，很难说。因此，为了回答，一些一般性的建议应该相当适用，无论您可能想要解决的问题是什么。

### 线程不会降低计算成本

就计算时间而言，线程并不会降低成本。它只是让两件事并行发生。因此，请注意，您不会陷入普遍的误解，即“线程使我的应用程序更快，因为用户无需等待。” - 这不是真的，线程实际上增加了相当多的复杂性。

因此，如果您启动此 DB 与 CSV 比较任务，线程不会使该比较花费更少的时间。它可能做的就是让您立即告诉用户“好的，我会为您检查”，同时在单独的执行线程中进行比较。您仍然必须弄清楚在比较完成后如何返回给用户。

### 想想你为什么要线程，而不是简单地把它当作线程是否是长任务的好解决方案

就像我上面说的，线程不会让事情变得更快。充其量，它以一种更有效的方式使用计算资源，或者提供更好的用户体验，或者两者兼而有之。

如果应用程序的用户（可能只是您）不介意等待比较运行，则不要添加线程，因为您只会增加复杂性并且不会更快。如果这种比较需要很长时间并且您宁愿“在后台进行”，那么线程**可能**是您的答案。请注意，如果您这样做，那么您会添加另一个问题，即在后台作业完成后如何更新用户？

### 线程涉及额外的开销和应用程序复杂性，然后您必须在应用程序中进行管理 - 小心翼翼

还有其他问题，例如，我如何安排该工作线程以确保它不会占用计算资源？在我的环境中设置线程优先级是否是一个选项，如果是，调整它们将如何影响计算资源的使用？

线程和所涉及的额外开销几乎肯定会使您的比较花费更长的时间（就进行比较所需的绝对时间而言）。真正的优势是，如果您不关心完成时间（比较开始和完成之间的时间），而是应用程序对用户的响应能力，和/或可以实现的总吞吐量（例如您可以运行的同时比较的数量，因此您可以在给定的时间跨度内完成的比较总数）。

### 线程并不能保证您的可用 CPU 内核得到有效使用

请参阅[绿色线程](http://en.wikipedia.org/wiki/Green_threads)与本机线程 - 某些语言（取决于它们的线程实现）可以跨 CPU 调度线程。

线程化并不一定意味着您的线程最终会在多个物理 CPU 内核中运行 - 事实上在许多情况下它们肯定**不会**。如果您的应用程序的所有线程都在同一个物理内核上运行，那么它们并不是真正并行运行的——它们只是以一种可能使它们看起来像并行运行的方式分割 CPU 时间。

由于这些原因，根据您的应用程序的结构，将后台任务发送到单独的工作**进程**（进程，而不是线程）通常不太复杂，可以轻松地将其调度到操作系统级别的可用 CPU 内核上。单独的进程（相对于单独的线程）也消除了应用程序中的许多调度问题，因为您基本上将有关如何调度事物的决定转移到了操作系统本身。

**最后一点非常重要。**操作系统调度程序极有可能比您在应用程序中提出的任何算法更智能、更高效。

# regex - ngPattern 指令的问题

> ID：15005567
> 
> 赞同：5
> 
> 时间：2013-02-21T15:08:15.173
> 
> 标签：regex, validation, angularjs, angularjs-directive

我有这个代码：

```
<form name="test">
    <input type="text" ng-model="code" name="code" ng-pattern="/^code_[0-9]+$/"/>
    <div ng-show="test.code.$dirty && test.code.$invalid">
        Error:
        <span ng-show="test.code.$error.pattern">Pattern fail.</span>
    </div>
</form> 
```

这段代码有两个问题：

1.  “code_232”、“code_232”、“code_232”等字符串通过了验证。我不是正则表达式的专家，所以这可能是一个与我写的正则表达式相关的问题：`/^code_[0-9]+$/`

2.  如果我开始写“code_23892”（一个正确的字符串），当我还在写（`test.code.$error.pattern = true`）时我会收到错误消息。有没有一种内置的方法可以避免这种情况？所以我想要的行为是：

> 如果我写“cod”，并且输入仍然有焦点：没有错误
> 
> 如果我写“cod”并且输入失去焦点：错误。
> 
> 如果我写“a”、“ca”、“coa”等：错误，导致模式已经被违反。

**这已经可能吗，或者我已经编写了一个客户验证指令来实现这一点？**

提前致谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-21T15:29:58.427

空格不会触发验证失败的原因是 ng-model 会自动修剪该值。如果你不想这样，你可以添加`ng-trim="false"`到你的`<input />`. 请注意，ng-trim 是一个相当新的属性，因此您可能需要更新您的 Angular 版本。

关于你的第二个问题；我认为您无法避免在键入期间运行验证，但您可以更改代码以仅在输入失去焦点时显示错误。我不认为存在类似的东西`ng-blur`，`ng-focus`但实现它们应该很简单。

# php - 如何将 zend 框架 2 php 应用程序部署到 CloudControl？

> ID：15005568
> 
> 赞同：0
> 
> 时间：2013-02-21T15:08:17.960
> 
> 标签：php, zend-framework2, cloudcontrol

我有zend骨架应用程序，框架被检测到但我仍然遇到问题：Constructor Zend\Stdlib\Glob::glob() cannot be static 现在我不确定是与云控制的php版本有关，还是其他配置我应该考虑到。

例如，数据库日志而不是文件日志等等。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T15:59:10.760

要运行基本的 Zend 2 应用程序，请查看[cloudControl Zend2 指南](https://github.com/cloudControl/documentation/blob/master/Guides/PHP/Zend%202.md)。

# extjs - 如何正确对齐字段输入文本？

> ID：15005570
> 
> 赞同：8
> 
> 时间：2013-02-21T15:08:25.787
> 
> 标签：extjs, extjs4, extjs4.1, extjs4.2

如何将所有字段中的文本右对齐而不是左对齐？我查看了 API，但只找到了标签的属性。

**编辑**

我知道我可以通过 CSS 更改它，但我正在寻找一种使用配置选项的方法。...仍然希望有一个...

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-02-21T16:17:12.183

实际上有一种方法可以在字段的配置对象中做到这一点：

```
fieldStyle:     "text-align:right;" 
```

# javascript - 如何将两个div合并为一个div

> ID：15005571
> 
> 赞同：3
> 
> 时间：2013-02-21T15:08:27.267
> 
> 标签：javascript, jquery, html

我有两个 div

```
<div id = "first">some details111</div> 
```

和

```
<div id = "second">some details222</div> 
```

我想创建：

```
<div id ="New">some details111 some details222</div> 
```

最好和最快的方法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-21T15:11:08.857

使用 jQuery 你可以做到这一点：

```
$(document).ready(function(){
   $("body").append("<div id='New'></div>");
   $("#New").text($("#first").text() + " " +$("#second").text());
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-21T15:27:33.950

一些用于踢球和咯咯笑的香草JS：

```
// grab the content from our two divs
var content1 = document.getElementById('one').innerHTML;
var content2 = document.getElementById('two').innerHTML;

// create our new div, pop the content in it, and give it an id
var combined = document.createElement('div');
combined.innerHTML = content1 + " " + content2; // a little spacing
combined.id = 'new';

// 'container' can be whatever your containing element is
document.getElementById('container').appendChild(combined); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-21T15:12:43.383

试试下面的：

小提琴示例：http: [//jsfiddle.net/RYh7U/99/](http://jsfiddle.net/RYh7U/99/)

如果您**已经有一个**ID 为“NEW”的 DIV，请尝试如下操作：

```
$('#New').html($('#first').html() + " " + $('#second').html()) 
```

如果你**想创建一个 div**然后添加内容然后尝试如下。

```
$("body").append("<div id ='New'></div>")
$('#New').html($('#first').html() + " " + $('#second').html()) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-21T15:12:38.903

好吧，使用 jQuery 你可以这样做：

```
$("body").append(
    $('<div/>')
        .attr("id","New")
        .html(
            $("#first).html() + $("#second").html()
        )
); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-21T15:13:35.967

```
$("&lt;div&gt;&lt;/div&gt;").attr("id", "New").html($("#first").html() + $("#second").html()).appendTo($("body")); 
```

# javascript - 提高背景视差滚动的性能

> ID：15005573
> 
> 赞同：4
> 
> 时间：2013-02-21T15:08:29.803
> 
> 标签：javascript, jquery, performance, parallax

你好 StackOverflow 社区，

我想要实现的是一个可以用鼠标移动的标题。您单击标题并拖动鼠标，标题内的元素将以不同的速度移动。

我实现了视差部分，但性能并不是很好。拖动背景时，它部分有点滞后。

我现在的问题是：可以在代码中进行哪些更改以提高性能？

这是处理视差的代码部分。在每个 mousemove 上执行每个循环，我认为这是性能如此滞后的原因：

```
var dragging = false;
var clickMouseX;

//Our object for the layers
//each layer has a different scrolling speed
var movingObjects = {
    '#header-l1' : {'speed': 1},
    '#header-l2' : {'speed': 1.4},
    '#header-l3' : {'speed': 1.85},
    '#header-l4' : {'speed': 2.2},
};

$('#header-wrapper').mousedown(function(e){
    dragging = true;

    //Get initial mouse position when clicked
    clickMouseX = e.pageX;

        $(this).mousemove(function(mme){
            //execute only if mousedown
            if(dragging){
                //iterate through all layers which have to be parallaxed
                $.each(movingObjects, function(el, opt){
                    var element = $(el);
                    //get difference of initial mouse position and current mouse position
                    var diff = clickMouseX - mme.pageX;
                    //scroll-position left speed 1
                    if(diff < 0) diff = -1;
                    //scroll position right speed 1
                    if(diff >= 0) diff = 1;
                    //get current position of layer
                    currLeft = parseInt(element.css('left'));
                    //get current layer width
                    elWidth = element.width();

                    //if right border is reached don't scroll further
                    if(currLeft < -(elWidth - 810)){
                        element.css('left', -(elWidth - 810));
                    }           
                    //so do with left border
                    if(currLeft > 0){
                        element.css('left', 0);
                    }
                    //parallax it! Subtract the scroll position speed multiplied by the speed of the desired
                    //layer from the current left property
                    element.css('left', parseInt(element.css('left')) - diff*opt.speed);    
                });
            }
        });

    /* Cursor */
    $(this).css('cursor', 'pointer');
    return false;
}); 
```

我也提琴了：http: [//jsfiddle.net/yWGDz/](http://jsfiddle.net/yWGDz/)

在此先感谢，托马斯

PS也许有人甚至会发现为什么第二层和第三层具有相同的滚动速度而定义了不同的速度。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-21T16:35:13.893

我做了一点工作，并想出了这个：http: [//jsfiddle.net/amqER/2/](http://jsfiddle.net/amqER/2/)

这比原来的工作要快得多（特别是在 Firefox 中，它的性能要好得多，chrome 它仍然很慢）。我还更改了您代码中的一些逻辑，以使其更有意义。

我做过的事情的清单：

### 缩小你的png

您的 2 个 png 文件超过 2 兆，因此我将它们放入 png 压缩器 ( [tinypng](http://tinypng.org/) ) 中，这大大减小了大小。这有助于加载时间和整体活泼。

### 尽可能重用价值

`left`在您的原始代码中，您在代码中多次写入并随后读取 css属性。这样做会使它变慢很多。`$.css`相反，我保留了一个左属性，并且只有在我绝对需要时才会触摸。同样对于每次更新读取每个元素的宽度。

另外，就像我说的那样，考虑到您要完成的工作，我将您的逻辑修改为（我认为）更有意义。它每次更新都会计算一个新的差异，并尝试据此移动。此外，一旦其中一个图像脱落，它就不会尝试继续移动（如果你一直向右移动，它就会这样做，它看起来真的很奇怪）。你也可以看看这个： http: [//jsfiddle.net/amqER/5/](http://jsfiddle.net/amqER/5/)，它可能更像你想要的控制方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-21T15:22:32.167

只是一些快速的性能提示。

尽量不要使用`$(this).mousemove`保存`$(this)`到变量中并使用它。

```
var th = $(this);
th.mousemove... 
```

尽量避免使用 $.each。这可能是减慢代码速度的部分。您可以用 for 循环替换它，但我建议在这种情况下，一个一个地发送每个元素。

```
var parallax = function(img){

};

parallax(img1);
parallax(img2); 
```

[立即提高您的 jquery 性能](http://net.tutsplus.com/tutorials/javascript-ajax/10-ways-to-instantly-increase-your-jquery-performance)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-03-25T18:48:28.457

虽然 Xymotech 的答案确实大大改进了原始发布者的原始代码；我在 Chrome 中的性能几乎没有改善。

在检查页面 FPS 时，此处发布的解决方案在 Retina MacBook Pro 上以 15FPS 运行。

我对代码做了一个非常简单的更改，将其更改为使用`translate3d`属性而不是`left`. 现在，它对我来说以 55-60 FPS 的速度运行。我称之为巨大的性能提升。

如果在 Chrome 中打开了“显示绘制矩形”，您将看到之前发布的解决方案是在视差运动时不断绘制对 dom 的更改。使用 translate3d 解决方案，在视差运动的整个过程中，只需进行零绘制。

[http://jsfiddle.net/LG47e/](http://jsfiddle.net/LG47e/)

# c++ - 链接到 SFML 2 会引发对 sf::Window 构造函数的未定义引用

> ID：15005574
> 
> 赞同：4
> 
> 时间：2013-02-21T15:08:32.250
> 
> 标签：c++, linker-errors, sfml

我只是想在我的新计算机上移动我的程序源并安装 Codeblocks 12.11 并按照 SFMLCoder 的最新说明自行编译 SFML 2。一切正常。当我尝试编译这个时：

```
#include <iostream>

using namespace std;

#include <SFML/Window.hpp>

int main()
{
    cout << "Hello world!" << endl;

    sf::Window w( sf::VideoMode( 800, 600 ), "test" );

    return 0;
} 
```

我尝试了静态（在 Buildoptions 的 C::B 中定义 SFML_STATIC）、动态和两个调试库。但总是在它链接文件之后它说： `main.cpp|11|undefined reference to sf::Window::Window(sf::VideoMode, std::string const&, unsigned int, sf::ContextSettings const&)` 或者使用动态库时 `main.cpp|11|undefined reference to _imp___ZN2sf6WindowC1ENS_9VideoModeERKSsjRKNS_15ContextSettingsE` ，这显然等同于静态链接错误。

编辑：我在官方[SFML 论坛](http://en.sfml-dev.org/forums/index.php?topic=10619.0)中发现了一个问题完全相同的问题：如果我做对了，我会发布解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T18:53:27.443

I added myself into [this discussion](http://en.sfml-dev.org/forums/index.php?topic=10619.15 "this discussion") and it reveals that I had to download the version from github and I had to include SFML/Window.hpp. It works from now on. Hope this answer helps others too.

# actionscript-3 - 使用 AS3 错误地读取 DWORD？

> ID：15005578
> 
> 赞同：0
> 
> 时间：2013-02-21T15:08:42.000
> 
> 标签：actionscript-3, bytearray, byte, dword

在[这个问题](https://stackoverflow.com/questions/14879358/as3-using-struct-information-to-decompress-a-format)中，我得到了关于如何使用[这些信息](http://wiki.multimedia.cx/index.php?title=BLB)来读取 BLB 文件的答案。所以我按照说明进行操作，看来我正在正确阅读标题。

但是，当我尝试读取文件 ID 时，出现文件运行时错误结束：

```
[Fault] exception, information=Error: Error #2030: End of file was encountered. 
```

这是我的代码。

基类：

```
package  
{
    import flash.display.Sprite;
    import flash.filesystem.File;
    import flash.filesystem.FileStream;
    import flash.utils.ByteArray;
    import flash.utils.IDataInput;
    import flash.filesystem.FileMode;

    public class BLBDecompress extends Sprite 
    {
        private var _file:File;
        private var _stream:FileStream;

        private var _blbBytes:ByteArray;

        private var _header:Header;
        private var _fileIDs:Array;

        public function BLBDecompress() 
        {
            decompress();
        }

        private function decompress():void
        {
            _file = File.applicationDirectory.resolvePath("testfiles/t.blb");
            _blbBytes = new ByteArray();

            _stream = new FileStream();
            _stream.open(_file, FileMode.READ);
            _stream.readBytes(_blbBytes);
            _stream.close();

            _header = readHeader(_blbBytes);

            _fileIDs = new Array();

            for (var i:int = 0; i < _header.dwNumber; i++)
            {
                _fileIDs.push(readFileID(_blbBytes));
            }
        }

        private function readHeader(input:IDataInput):Header
        {
            var header:Header = new Header();

            header.szID = new ByteArray();
            input.readBytes(header.szID, 0, 4);

            header.bID = input.readUnsignedByte();
            header.bUnknown = input.readUnsignedByte();
            header.wDataSize = input.readUnsignedShort();
            header.dwFileSize = input.readUnsignedInt();
            header.dwNumber = input.readUnsignedInt();

            return header;
        }

        private function readFileID(input:IDataInput):uint
        {
            var fileID:uint = input.readUnsignedInt();

            return fileID;
        }
    }
} 
```

标题类：

```
package  
{
    import flash.utils.ByteArray;

    public class Header 
    {
        public var szID:ByteArray;
        public var bID:uint;
        public var bUnknown:uint;
        public var wDataSize:uint;
        public var dwFileSize:uint;
        public var dwNumber:uint;

        public function Header() 
        {

        }
    }
} 
```

问题是`_header.dwNumber`返回/跟踪为 1090650112（基数为 16 的 41020000），所以我可以想象这会到达文件的末尾。那么我是读错了，用错了，还是做错了什么？剩下的

如果有帮助，这是一个 AIR 应用程序，我正在使用 FlashDevelop 和 Flex 4 SDK。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T17:07:38.840

这看起来像是一个简单的大/小端问题，构成 DWORD 的 4 个字节在文件中的顺序与处理器使用的顺序不同。

您需要颠倒 DWORD 中的字节顺序以获得 00000241，以及任何其他多字节数

# validation - 如何覆盖 FOSUserBundle 中的密码验证

> ID：15005582
> 
> 赞同：7
> 
> 时间：2013-02-21T15:08:56.280
> 
> 标签：validation, symfony, passwords, fosuserbundle

我在 Symfony2 项目中使用 FOSUserBundle。我找不到任何合理的解释如何覆盖表单字段验证。我需要将密码字段验证设置为至少 7 个字符、至少一个小写字母、至少一个大写字母和至少一个数字。我发现的所有解决方案似乎都不起作用。有任何想法吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-05-31T16:40:52.210

`Regex`使用具有以下模式的标准约束`/(?=.*[A-Z])(?=.*[a-z])(?=.*[0-9]).{7,}/`

```
class User extends FOSUser
{

    /**
     * @Assert\Regex(
     *  pattern="/(?=.*[A-Z])(?=.*[a-z])(?=.*[0-9]).{7,}/",
     *  message="Password must be seven or more characters long and contain at least one digit, one upper- and one lowercase character."
     * )
     */
    protected $plainPassword;

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-21T15:37:38.590

您应该创建一个自定义约束类，如[文档中所述](http://symfony.com/doc/current/cookbook/validation/custom_constraint.html#creating-the-validator-itself)

1.  在 isValid 方法中添加您的正则表达式
2.  添加您的自定义错误消息
3.  使用validation.yml（或者如果您愿意，可以使用注释）将您的约束类添加到您的实体类中

应该适合您的需求

# iphone - 一次运行多个 CADisplayLinks ？

> ID：15005593
> 
> 赞同：0
> 
> 时间：2013-02-21T15:09:25.010
> 
> 标签：iphone, ios, objective-c, ios6, cadisplaylink

我使用 CADisplayLink 作为频闪计时器。

我有 2 个 CADisplayLinks：

主要的（在整个过程中运行）：

```
SMPTELink = [CADisplayLink displayLinkWithTarget:self selector:@selector(onTick)];
SMPTELink.frameInterval = 1;
[SMPTELink addToRunLoop:[NSRunLoop mainRunLoop]
                       forMode:NSDefaultRunLoopMode]; 
```

频闪灯（仅在频闪发生时运行）：

```
strobeLink = [CADisplayLink displayLinkWithTarget:self selector:@selector(toggleStrobe)];
strobeLink.frameInterval = 1;
[strobeLink addToRunLoop:[NSRunLoop mainRunLoop]
                     forMode:NSDefaultRunLoopMode];
[strobeLink setPaused:YES]; // I setPaused:NO when using the strobe. 
```

一次运行两个 CADisplayLink 是不是很糟糕？有时我的闪光灯看起来并不像我认为的那样平滑。这是我的 toggleStrobe 方法：

```
-(void)toggleStrobe {

    if (!self.firstTimestampStrobe)
        self.firstTimestampStrobe = strobeLink.timestamp;

    NSTimeInterval elapsed = (strobeLink.timestamp - self.firstTimestampStrobe);

    NSInteger frameNumber = (NSInteger)(elapsed * ((strobeValue*15)/255)) % 2;

    if (frameNumber != self.lastFrameStrobe)
    {
        if (frameNumber == 1) {

            UIColor *color = [[UIColor alloc] initWithRed: 0 green: 0 blue: 0 alpha: 1.0];
            strobeBackground.backgroundColor = color;

        } else {

            UIColor *color = [[UIColor alloc] initWithRed: 0 green: 0 blue: 0 alpha: 0];
            strobeBackground.backgroundColor = color;

        }

        self.lastFrameStrobe = frameNumber;
    }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-21T19:21:38.760

显示链接的重点是能够在每次刷新屏幕时进行绘制。我不明白你为什么需要两个（因为它仍然会在显示刷新时被调用）。您不能只使用一个并在每次刷新时确定要显示的颜色吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T20:30:01.737

它还不错..它只是毫无意义。

为什么需要两个？CADisplayLink 的目的是在每次刷新显示时触发一个方法。如果您希望以两种不同的速率发生两种不同的事情，那么让显示链接触发一种称为 refreshView: 的方法或类似的方法。然后在此方法中执行您的自定义逻辑以确定是否该切换频闪。

# slickgrid - 关闭模式窗口时从 Slickgrid 中清除所有行

> ID：15005594
> 
> 赞同：0
> 
> 时间：2013-02-21T15:09:31.300
> 
> 标签：slickgrid

我在 jquery 模态层中有 2 个 SlickGrids。
我需要能够在模式层关闭时清除所有行，以便当/如果用户稍后重新打开模式层时网格为空。
实际上我可以使用以下方法做到这一点：

```
dataViewMG1.beginUpdate();
dataViewMG1.getItems().length=0;
dataViewMG1.endUpdate(); 
```

但如果我这样做，我将无法使用我的任何标准方法重新填充网格：

```
dataViewMG1.beginUpdate();
dataViewMG1.setItems(modaldata1);
dataViewMG1.endUpdate();
invmodalgrid1.invalidate();
invmodalgrid1.render(); 
```

有人有想法么？？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-21T22:24:42.413

我个人在刷新数据之前清空了我的网格，所以它不会混淆用户认为它是实际刷新的数据。这似乎是你想要在这里做的。

我在 HTML 中的网格是：
`<div id="myGrid1" style="width:100%;height:680px;"></div>`

在我的 JavaScript 中，我在刷新之前清空了网格
`$('#myGrid1').empty(); // empty out the Grid before refreshing the data`

# php - PHP不在Nginx中处理

> ID：15005595
> 
> 赞同：2
> 
> 时间：2013-02-21T15:09:32.040
> 
> 标签：php, nginx

我创建了一个 try_files 指令，该指令尝试与放入文件不同的目录中的文件。即，如果我访问`www.example.com/home/main`它将尝试文件`/var/www/main/home/main.php`。它可以工作，但是当我访问一个页面时，它只显示 PHP 源代码而不是处理后的页面。这是我的指令：

```
location ~ /home/ {
   index main.php
   try_files /main$uri.php @404;
   location \.php {
       fastcgi_pass php_server;
       include fastcgi_params;
   }
} 
```

关于如何处理页面而不是仅显示 PHP 源代码的任何想法？

编辑以获取更多信息：我尝试制作一个看起来像的位置指令

```
location ~ /main/(.*)\.php {
       fastcgi_pass php_server;
       include fastcgi_params;
} 
```

但这也不起作用，页面仍然只显示源代码。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-21T15:40:35.547

当然，它会向您显示来源，因为您`fastcgi_pass`所在的`/home/`位置没有。

试试这个：

```
location /home/ {
   try_files /main$uri.php @static;
   fastcgi_pass php_server;
   include fastcgi_params;
}

location @static { } 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-21T15:17:38.367

`try_files`编辑：实际上下面是错误的——如果在指令的其他任何地方都找不到文件，最后一个参数总是用作重定向。在这个例子中，它正在命中 .php 文件，但没有被处理，所以`@404`没有被命中。但是，如果不`@404`存在示例，那么无论如何找不到文件都会失败。

> 如果找不到文件，则会调用到最后一个参数的内部重定向 [...]最后一个参数是备用 URI，并且*必须*存在，否则将引发内部错误。

来源：[http ://wiki.nginx.org/HttpCoreModule#try_files](http://wiki.nginx.org/HttpCoreModule#try_files)

~~`@404`指令末尾的将`try_files`发送 php 文件以由`location @404`指令解析，而不是使用 fastcgi 的 php 指令。~~

~~尝试放弃`@404`或简单地做：`try_files $uri /main$uri.php;`~~

# ios - 对对象的类方法实例上运行方法的困惑

> ID：15005600
> 
> 赞同：1
> 
> 时间：2013-02-21T15:09:51.307
> 
> 标签：ios, objective-c, class, singleton

所以我让自己对我的数据去哪里以及它在我的应用程序中的存储位置感到困惑。这不是一个具体的问题，所以希望有人可以提供一个笼统的答案。

我需要在几个`UIViewController`实例之间传递一些数据，而我目前正在使用一个名为我的 dataManager 的单例对象来做这件事。这个类有一个方法，一个类方法，被称为`+ (LCDataManager *) sharedDataManager`，并且该方法基本上检查是否`sharedDataManager`已经存在，如果存在，则返回它，如果不存在，则创建它并设置它的变量。这意味着我可以在我喜欢的任何地方引用该类，在我喜欢的任何地方访问和修改其变量，跨多个类。

第一个问题：这是像这样传递数据的正确/最佳/最合适的方法吗？我希望它服从 MVC，感觉就像它，我希望我是对的。

第二个问题：如果我想在该类中放置一个实例方法，并从类方法中调用它怎么办？假设我`sharedDataManager`需要调用一个方法来获取一些对象的一个​​变量（一个数组），并将它们放入另一个数组中，然后再次将其发送回来。我不能那样做，可以吗？有什么办法呢？如果我创建该类的实例（而不是使用共享实例），我将失去跨多个 viewController 使用该实例的能力。

我非常困惑，似乎这不是我要解决的问题。感谢任何指导，最好不要那些“阅读 Apple 文档”的东西——他们写的好像你已经知道你在做什么，坦率地说我还不知道。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-21T15:25:40.117

> 这是像这样传递数据的正确/最佳/最合适的方法吗？

只拥有一个 LCDDataManager 实例并没有错，但是使用 Singleton 模式[有潜在的问题](https://softwareengineering.stackexchange.com/questions/40373/so-singletons-are-bad-then-what/40610#40610)。另一种方法是只初始化一个 LCDDataManger 并将其传递到需要的地方。

> 如果我想在该类中放置一个实例方法，并从类方法中调用它怎么办？

访问者`+ (LCDataManager *) sharedDataManager`应该只返回实例。我想你想要的是类似的东西

```
+ (LCDataManager *)preparedDataManager {
    LCDataManager *shared = [self sharedDataManager];
    [shared doSomeInstanceMagic];
    return shared;
}

- (void)doSomeInstanceMagic {
    // magic!
    // grab some objects one of its variables (an array),
    // and put them in another array
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-21T15:26:22.163

> 第一个问题：这是像这样传递数据的正确/最佳/最合适的方法吗？我希望它服从 MVC，感觉就像它，我希望我是对的。

您的设计完全符合 MVC。

> 第二个问题：如果我想在该类中放置一个实例方法，并从类方法中调用它怎么办？

您当然可以定义一个实例方法并像这样调用它：

```
[[MyModelClass sharedModel] myInstanceMethod]; 
```

事实上，`[MyModelClass sharedModel]`会给你一个*实例*（`MyModelClass`应该保证是唯一的，因为它是一个单例）。

如果你想从`sharedModel`类方法调用实例方法，你也可以这样做，因为`sharedModel`拥有对你的单例的引用，所以它可以向它发送消息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-21T15:34:09.430

[Matthijs Hollemans](https://stackoverflow.com/users/411775/hollance)在他的博客上有一个很好的三部分教程，介绍了让视图控制器相互通信的正确方法：

*   [第1部分](http://www.hollance.com/2011/04/making-your-classes-talk-to-each-other-part-1/)
*   [第2部分](http://www.hollance.com/2011/04/making-your-classes-talk-to-each-other-part-2/)
*   [第 3 部分](http://www.hollance.com/2011/04/making-your-classes-talk-to-each-other-part-3/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-21T15:21:03.080

这个开发架构没有问题，是iOS开发中必须使用的（我认为）。在[IOS Programming: The Big Nerd Ranch Guide](http://www.bignerdranch.com/book/ios_programming_the_big_nerd_ranch_guide_rd_edition_)一书中，他们称之为*Model View Controller Store*。

关于你的第二个问题，是的，你可以声明实例方法，然后从你的`sharedDataManager`. 不常见的是创建单例类的其他实例，但这是可能的。

# ios - 无法从 Facebook IOS 请求中调用 UIView

> ID：15005602
> 
> 赞同：0
> 
> 时间：2013-02-21T15:09:55.023
> 
> 标签：ios, facebook, ios5, ios6

我在 IOS6 中有以下设置，可以通过我的应用程序连接到 Facebook。

```
self.accountStore = [[ACAccountStore alloc] init];

ACAccountType *facebookAccountType = [self.accountStore
                                      accountTypeWithAccountTypeIdentifier:ACAccountTypeIdentifierFacebook];

// Specify App ID and permissions
NSDictionary *options = @{
                          ACFacebookAppIdKey: @"xxxxxxxxxxxxx",
                          ACFacebookPermissionsKey: @[@"publish_stream", @"publish_actions"],
                          ACFacebookAudienceKey: ACFacebookAudienceFriends
                          };

[accountStore requestAccessToAccountsWithType:facebookAccountType
                                      options:options completion:^(BOOL granted, NSError *e) {
                                          if (granted) {
                                              NSArray *accounts = [self.accountStore
                                                                   accountsWithAccountType:facebookAccountType];
                                              self.facebookAccount = [accounts lastObject];
                                              NSLog(@"Logged In :: %@",self.facebookAccount);

                                              [self uploadVideo];

                                          }
                                          else
                                          {
                                              NSLog(@"Logged In Fail");
                                          }
                                      }]; 
```

问题是我想以 UIAlertView 的形式提供一些反馈，其中 else 语句是。当我添加以下内容时，应用程序会因 EXC_BAD_ACCESS 而崩溃

```
UIAlertView *alert = [[UIAlertView alloc]
                      initWithTitle: @"Unable To Connect With Facebook"
                      message: @"xxxxxxxxxxxxx."
                      delegate: nil
                      cancelButtonTitle:@"OK"
                      otherButtonTitles:nil];
[alert show]; 
```

如果我只是调用一个没有警报视图的方法，那么这似乎工作正常。有人有想法么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T15:57:39.653

你确定完成块在主线程上吗？

尝试将警报视图代码包装到主线程的调度中。

```
dispatch_async(dispatch_get_main_queue(), ^(void) {

}); 
```

# jquery - 使用“选择”插件重新选择所选选项。jQuery

> ID：15005608
> 
> 赞同：0
> 
> 时间：2013-02-21T15:10:14.730
> 
> 标签：jquery, jquery-plugins

我将 Harvest 选择的插件与 Jquery 一起使用。一切正常，当我选择其中一个选项时，它会被选中，并应用了一些样式：我正在使用 (Allow Deselect on Single Select): [link](http://harvesthq.github.com/chosen)。

问题是当我刷新页面时，我希望重新呈现所选值。

我试图了解选择的属性和方法，例如：Chosen.result_activate() 或 Chosen.result_select()，但我不确定如何使用它们。

这是我的html：

```
 <div id="container">
    <div class="side-by-side clearfix">
           <div class="side-by-side clearfix">
        <select id ="combooptions" data-placeholder="Search drafts" style="width:200px" class="chzn-select-deselect" tabindex="7">
          <option value=""></option>
 </select><span style="margin-left:5px;cursor:pointer;color:blue;text-decoration:underline;" id="draftInsert"> Insert</span>
      </div>
    </div>
   </div> 
```

> **编辑：**
> 
> 实际上我的示例不在 jQuery(document).ready() 中，而是在单独的函数中，它一直在重新加载。实际上不是刷新页面而是更新面板刷新。我为我的误会道歉。我的页面没有重新加载文档。我猜是准备好了。

这是我的js：

```
 var saveseleted='';
    jQuery(document).ready(function ($) {

    for (var i in combonews) {
            jQuery("#combooptions").append("<option value='" + combonews[i][0] + "'>" + combonews[i][1] + "</option>");
               }

        jQuery(".chzn-select-deselect").chosen({ allow_single_deselect: true });

jQuery('#combooptions').change(function () {
        saveseleted= jQuery("#combooptions :selected").val();
    });
    }); 
```

然后我在页面刷新后需要自动重新选择“saveselected”选项值。

请帮我，

**更新：**

```
jQuery("#combooptions option").eq(saveseleted).attr('selected', 'selected'); 
```

不工作

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-21T16:01:46.623

我猜这可能是答案：

```
 jQuery("#combooptions").val(saveseleted);  //update the value first

 jQuery("#combooptions").trigger("liszt:updated");   //trigger this event 
```

此触发事件将强制插件更新。

# c++ - C++ CreateThread 不显示结果

> ID：15005609
> 
> 赞同：0
> 
> 时间：2013-02-21T15:10:19.070
> 
> 标签：c++, sockets, asynchronous, createthread

我正在尝试使用 C++ 制作异步服务器侦听器我是 C++ 新手，但我必须做这个项目，我是 Web 开发人员 (PHP)，但 PHP 无法进行异步连接 + 他对于大量连接来说语言很差...我可以在没有异步的情况下编写简单的侦听器，但现在我遇到了“CreateThread”的问题...例如，如果客户端已连接，控制台会给我关于此的结果 + 嗅探器可以修复它... 10 秒后客户端必须发送给我再次具有不同数据的相同数据包。我的控制台没有给我关于那个数据包的结果，但嗅探器可以看到那个数据包......请如果有人能看到我的问题解释我......（对不起我的英语不好：D）

```
#include <winsock2.h>
#include <windows.h>
#include <fcntl.h>
#include <string.h>
#include <stdlib.h>
#include <errno.h>
#include <stdio.h>

DWORD WINAPI SocketHandler(void*);

int main(int argv, char** argc){

    //The port you want the server to listen on
    int host_port = 7878;

    //Initialize socket support WINDOWS ONLY!
    unsigned short wVersionRequested;
    WSADATA wsaData;
    int err;
    wVersionRequested = MAKEWORD( 2, 2 );
     err = WSAStartup( wVersionRequested, &wsaData );
    if ( err != 0 || ( LOBYTE( wsaData.wVersion ) != 2 ||
            HIBYTE( wsaData.wVersion ) != 2 )) {
        fprintf(stderr, "Could not find useable sock dll %d\n",WSAGetLastError());

    }

    //Initialize sockets and set any options
    int hsock;
    int * p_int ;
    hsock = socket(AF_INET, SOCK_STREAM, 0);
    if(hsock == -1){
        printf("Error initializing socket %d\n",WSAGetLastError());

    }

    p_int = (int*)malloc(sizeof(int));
    *p_int = 1;
    if( (setsockopt(hsock, SOL_SOCKET, SO_REUSEADDR, (char*)p_int, sizeof(int)) == -1 )||
        (setsockopt(hsock, SOL_SOCKET, SO_KEEPALIVE, (char*)p_int, sizeof(int)) == -1 ) ){
        printf("Error setting options %d\n", WSAGetLastError());
        free(p_int);

    }

    free(p_int);

    //Bind and listen
    struct sockaddr_in my_addr;

    my_addr.sin_family = AF_INET ;
    my_addr.sin_port = htons(host_port);

    memset(&(my_addr.sin_zero), 0, 8);
    my_addr.sin_addr.s_addr = INADDR_ANY ;

    if( bind( hsock, (struct sockaddr*)&my_addr, sizeof(my_addr)) == -1 ){
        fprintf(stderr,"Error binding to socket, make sure nothing else is listening on this port %d\n",WSAGetLastError());

    }
    if(listen( hsock, 10) == -1 ){
        fprintf(stderr, "Error listening %d\n",WSAGetLastError());

    }

    //Now lets to the server stuff

    int* csock;
    sockaddr_in sadr;
    int    addr_size = sizeof(SOCKADDR);

    while(true){
        printf("waiting for a connection\n");
        csock = (int*)malloc(sizeof(int));

        if((*csock = accept( hsock, (SOCKADDR*)&sadr, &addr_size))!= INVALID_SOCKET ){
            printf("Received connection from %s",inet_ntoa(sadr.sin_addr));
            CreateThread(0,0,&SocketHandler, (void*)csock , 0,0);
        }
        else{
            fprintf(stderr, "Error accepting %d\n",WSAGetLastError());
        }
    }

}

DWORD WINAPI SocketHandler(void* lp){

    int *csock = (int*)lp;
    char buffer[1024];  
    int buffer_len = 1024;
    int bytecount;
    memset(buffer, 0, buffer_len);
    if((bytecount = recv(*csock, buffer, buffer_len, 0))==SOCKET_ERROR){
        fprintf(stderr, "Error receiving data %d\n", WSAGetLastError());   
    }
    printf("Received bytes %d\n Received string \"%s\"\n", bytecount, buffer);

    char buff[1] = {0x11};        
    if((bytecount = send(*csock, buff, 1, 0))==SOCKET_ERROR){
        fprintf(stderr, "Error sending data %d\n", WSAGetLastError());    
    }

    printf("Sent bytes: %d. Send Message: %s\n ", bytecount,buff);

    free(csock);

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T17:30:43.097

我怀疑问题不在于创建线程，而在于数据的传递。将套接字传递给线程可能更简单。此外，在函数结束时，您正确释放了内存，但没有关闭套接字。我已经进行了更改并验证了它是否正常运行。我所做的更改是带有 // **的注释*

```
#include <winsock2.h>
#include <windows.h>
#include <fcntl.h>
#include <string.h>
#include <stdlib.h>
#include <errno.h>
#include <stdio.h>

DWORD WINAPI SocketHandler(void*);

//*** Changed to work with my version of 
//*** Visual Studio
int _tmain(int argc, _TCHAR* argv[]){

//The port you want the server to listen on
int host_port = 7878;

//Initialize socket support WINDOWS ONLY!
unsigned short wVersionRequested;
WSADATA wsaData;
int err;
wVersionRequested = MAKEWORD( 2, 2 );
 err = WSAStartup( wVersionRequested, &wsaData );
if ( err != 0 || ( LOBYTE( wsaData.wVersion ) != 2 ||
    HIBYTE( wsaData.wVersion ) != 2 )) {
    fprintf(stderr, "Could not find useable sock dll %d\n",WSAGetLastError());
}

//Initialize sockets and set any options
    //*** Changed to be SOCKET instead of int
SOCKET hsock;
int * p_int ;
hsock = socket(AF_INET, SOCK_STREAM, 0);
if(hsock == -1){
    printf("Error initializing socket %d\n",WSAGetLastError());
}

p_int = (int*)malloc(sizeof(int));
*p_int = 1;
if( (setsockopt(hsock, SOL_SOCKET, SO_REUSEADDR, (char*)p_int, sizeof(int)) == -1 )||
    (setsockopt(hsock, SOL_SOCKET, SO_KEEPALIVE, (char*)p_int, sizeof(int)) == -1 ) ){
    printf("Error setting options %d\n", WSAGetLastError());
    free(p_int);
}

free(p_int);

//Bind and listen
struct sockaddr_in my_addr;

my_addr.sin_family = AF_INET ;
my_addr.sin_port = htons(host_port);

memset(&(my_addr.sin_zero), 0, 8);
my_addr.sin_addr.s_addr = INADDR_ANY ;

if( bind( hsock, (struct sockaddr*)&my_addr, sizeof(my_addr)) == -1 ){
    fprintf(stderr,"Error binding to socket, make sure nothing else is listening on this port %d\n",WSAGetLastError());
}
if(listen( hsock, 10) == -1 ){
    fprintf(stderr, "Error listening %d\n",WSAGetLastError());
}

//Now lets to the server stuff
    //*** Changed to be SOCKET instead of int* 
SOCKET csock;
sockaddr_in sadr;
int    addr_size = sizeof(SOCKADDR);

while(true){
    printf("waiting for a connection\n");
        //*** Changed to comment out line as it is not needed
   // csock = (SOCKET)malloc(sizeof(SOCKET));
        //*** Changed check to be INVALID_SOCKET
    if((csock = accept( hsock, (SOCKADDR*)&sadr, &addr_size))!= INVALID_SOCKET ){
    printf("Received connection from %s",inet_ntoa(sadr.sin_addr));
            //*** Changed to pass the client socket
    CreateThread(0,0,&SocketHandler, (void*)csock , 0,0);
    }
    else{
    fprintf(stderr, "Error accepting %d\n",WSAGetLastError());
    }
}
}

DWORD WINAPI SocketHandler(void* lp){

    //** Changed to cast as the SOCKET which was passed
SOCKET csock = (SOCKET)lp;
char buffer[1024];  
int buffer_len = 1024;
int bytecount;
memset(buffer, 0, buffer_len);
if((bytecount = recv(csock, buffer, buffer_len, 0))==SOCKET_ERROR){
    fprintf(stderr, "Error receiving data %d\n", WSAGetLastError());   
}
printf("Received bytes: %d\nReceived string: \"%s\"\n", bytecount, buffer);

char buff[1] = {0x11};        
if((bytecount = send(csock, buff, 1, 0))==SOCKET_ERROR){
    fprintf(stderr, "Error sending data %d\n", WSAGetLastError());    
}

printf("Sent bytes: %d. Send Message: %s\n ", bytecount,buff);

    //*** Changed to close the socket after the message is sent. Otherwise
    //*** the socket would remain open
    closesocket(csock);

    //*** Changed to comment the line out as there is 
    //*** no allocated memory.
//free(csock);

    return 0;
} 
```

# java - 使用java的Ruby指南针编译器

> ID：15005611
> 
> 赞同：0
> 
> 时间：2013-02-21T15:10:21.533
> 
> 标签：java, ruby, jruby, compass-sass

我在我的 java 应用程序中使用 compass 编译器。基本上，我正在执行 Process 来启动指南针。问题是......是否可以使用 JRuby 之类的工具/框架来执行指南针编译器任务，而无需在我的环境中安装任何依赖项（Ruby）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T09:36:04.293

您可以使用反引号在 ruby​​（以及 JRuby）中执行命令，例如：

```
puts `compass version` 
```

# javascript - Coffeescript 三元 if 语句错误逻辑

> ID：15005613
> 
> 赞同：0
> 
> 时间：2013-02-21T15:10:27.840
> 
> 标签：javascript, jquery, if-statement, coffeescript

我在返回函数中有一个非常简单的逻辑，但它没有按预期工作。当然我可以让代码稍长一些并解决问题，但我希望它尽可能小。

这是我的代码：

```
#Return title if exists or false otherwise
getPageTitleFromMainContent = (mainContent) ->
  mainContent.find('#pageTitle') ?.length ?=  false

if y = (getPageTitleFromMainContent $("#mainContent"))
  y.css color:red 
```

如您所见，如果它在#mainContent 中找到#pageTitle，它应该将其变为红色。但是如果找到该函数不会返回#pageTitle，它会返回.length。

从 js2coffee.org 我看到代码被编译成：

```
var getPageTitleFromMainContent, y;

getPageTitleFromMainContent = function(mainContent) {
  var _ref, _ref1;
  return (_ref = mainContent.find('#pageTitle')) != null ? (_ref1 = _ref.length) != null ? **_ref1 : _ref.length = false : void 0;**
};

if (y = getPageTitleFromMainContent($("#mainContent"))) {
  y.css({
    color: red
  });
} 
```

它应该是`_ref : _ref.length = false : void 0;`，不是`_ref**1** : _ref.length = false : void 0;`。

[http://jsfiddle.net/X8VjJ/1/](http://jsfiddle.net/X8VjJ/1/)

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-21T15:24:48.740

> 如果它找到`#pageTitle`in `#mainContent`，它应该把它变成红色

您可以使用更简单的方法来完成此操作：

```
 $('#mainContent #pageTitle').css(color: 'red') 
```

因为，如果在*中*找不到`#pageTitle`，`#mainContent`它会尝试更改一组空元素的 css——无操作。

您提供的代码实际上没有任何意义。`?.`是不必要的，因为 jQuery 选择器不会返回`null`或者`undefined`不匹配；它将返回一组空元素。所以它总是返回`length`，它总是一个数字，所以赋值永远不会执行，因为它依赖于`length`返回`null`or `undefined`。这很好，因为您可能不想将元素的长度设置为`false`.

最后，这不是三元 if 语句。CoffeeScript 的三元 if 语句如下所示`if foo then bar else baz`：

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-21T15:18:05.577

不确定代码是否有意义。除非定义了长度，否则您实际上是在尝试分配给长度属性。如果它被定义，它只返回长度属性。看起来代码和行为是正确的，但是您对存在运算符和返回值的理解是错误的。如果您想返回找到的元素，您可能需要将其与长度检查断开连接。

也许是这样的：

```
getPageTitleFromMainContent = (mainContent) ->
  arr = mainContent.find('#pageTitle')
  if arr.length then arr else false 
```

正如 Ian 在他更优雅的回答中解释的那样，您不需要在 arr 上使用存在运算符（假设为 jquery），因为它始终是一个元素数组（如果未找到，则长度为零）。

# android - 将 Parcelable 通过 Messenger 传递给远程服务时解组时找不到类

> ID：15005615
> 
> 赞同：13
> 
> 时间：2013-02-21T15:10:31.447
> 
> 标签：android

我有一个 Parcelable 对象，我用它来将它从 Activity 传递到远程服务。当我使用**AIDL**接口传递它时，一切听起来都很好。

最近，我尝试从 Activity 中通过**Messenger传递它。**

```
// TEST TEST TEST!
StockInfo stockInfo0 = new StockInfo(Code.newInstance("code0"), Symbol.newInstance("symbol0"));
StockInfo stockInfo1 = new StockInfo(Code.newInstance("code1"), Symbol.newInstance("symbol1"));
StockInfo stockInfo2 = new StockInfo(Code.newInstance("code2"), Symbol.newInstance("symbol2"));
List<StockInfo> stockInfos = new ArrayList<StockInfo>();
stockInfos.add(stockInfo0);
stockInfos.add(stockInfo1);
stockInfos.add(stockInfo2);
StockInfosEx stockInfosEx = new StockInfosEx(stockInfos, "abc");
msg.obj = stockInfosEx;

try {
    mService.send(msg);
} catch (RemoteException e) {
    // TODO Auto-generated catch block
    e.printStackTrace();
} 
```

我在远程服务中遇到以下异常。

> 02-21 22:55:16.546：E/Parcel(8365)：解组时找不到类：com.example.testonmessenger.StockInfosEx，e：java.lang.ClassNotFoundException：com.example.testonmessenger.StockInfosEx

我想知道，这两者之间会出现什么问题？这是我的 Parcelable 对象。

```
public class StockInfosEx implements Parcelable {
    public final List<StockInfo> stockInfos;
    public final String searchedString;

    public StockInfosEx(List<StockInfo> stockInfos, String searchedString) {
        this.stockInfos = stockInfos;
        this.searchedString = searchedString;
    }

    ////////////////////////////////////////////////////////////////////////////
    // Handling Parcelable nicely.

    public static final Parcelable.Creator<StockInfosEx> CREATOR = new Parcelable.Creator<StockInfosEx>() {
        public StockInfosEx createFromParcel(Parcel in) {
            return new StockInfosEx(in);
        }

        public StockInfosEx[] newArray(int size) {
            return new StockInfosEx[size];
        }
    };

    private StockInfosEx(Parcel in) {
        stockInfos = new ArrayList<StockInfo>();
        in.readTypedList(stockInfos, StockInfo.CREATOR);
        searchedString = in.readString();
    }

    @Override
    public int describeContents() {
        return 0;
    }

    @Override
    public void writeToParcel(Parcel parcel, int flags) {
        parcel.writeTypedList(stockInfos);
        parcel.writeString(searchedString);
    }

    // Handling Parcelable nicely.    
    ////////////////////////////////////////////////////////////////////////////        
} 
```

要获得完整的源代码，请从[https://www.dropbox.com/s/n69yuhddpb8vedz/testonmessenger.zip下载](https://www.dropbox.com/s/n69yuhddpb8vedz/testonmessenger.zip)

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-02-21T16:36:28.363

## 不可行的方法（因为我们的 Parcelable 是自定义的，而不是像 Rect 这样的框架的一部分）

**活动**

```
msg.obj = stockInfosEx; 
```

**远程服务**

```
StockInfosEx stockInfosEx = (StockInfosEx)msg.obj; 
```

## 可行的方法

**活动**

```
msg.getData().putParcelable("data", stockInfosEx); 
```

**远程服务**

```
msg.getData().setClassLoader(StockInfosEx.class.getClassLoader());
StockInfosEx stockInfosEx = (StockInfosEx)msg.getData().getParcelable("data"); 
```

* * *

现在，在我再次阅读 msg.obj （[http://developer.android.com/reference/android/os/Message.html#obj](http://developer.android.com/reference/android/os/Message.html#obj)）的文档后，只有我明白它的真正含义`Parcelable of a framework class`

> 要发送给收件人的任意对象。当使用 Messenger 跨进程发送消息时，如果它包含一个框架类的 Parcelable（不是应用程序实现的），它只能是非空的。对于其他数据传输，请使用 setData(Bundle)。
> 
> 请注意，在 FROYO 版本之前，此处不支持 Parcelable 对象。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-21T15:32:24.283

您可能没有使用正确的`ClassLoader`. 您需要首先跟踪`ClassLoader`正在编组类的内容，并使用 THAT`ClassLoader`来解组它。

解组时，您使用的是当前线程的 ClassLoader，它不是您的 UIThread 而是 Android 系统线程，因此没有关于您的自定义类的信息。

我使用了一个包含我的静态类`ClassLoader`来解决这个问题（可以使用类似的方法，而不需要它是静态的）。

就像是：

```
ClassLoaderHelper.setClassLoader(Thread.currentThread().getContextClassLoader()); 
```

然后在解组时：

```
public final void readFromParcel(final Parcel in) {
    id = in.readString();
    appInfo = in.readParcelable(ClassLoaderHelper.getClassLoader());
    ...
} 
```

有关更多详细信息，请参阅[其他问题（可能是重复的顺便说一句）。](https://stackoverflow.com/questions/11393751/badparcelableexception-classnotfoundexception-when-unmarshalling)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-21T15:40:22.413

> 我在远程服务中遇到以下异常。

如果你真的是从远程服务中得到这个，那是因为远程服务应用程序不包含那个类。如果要使用自定义`Parcelable`类，客户端和服务器必须具有相同的类定义。

但是，如果您的堆栈跟踪感觉就像您`Parcelable`正在从核心操作系统进程访问，那么您无法可靠地传递`Parcelable`对象。`obj`我只用于进程内对象传递，从不`obj`用于`Message`跨进程消息。

# objective-c - 如何从目录路径播放wav文件

> ID：15005620
> 
> 赞同：1
> 
> 时间：2013-02-21T15:10:38.883
> 
> 标签：objective-c, avaudioplayer

我正在尝试从我之前保存在那里的目录路径中播放 wav 文件，但我无法播放，我希望有人可以帮助我

```
NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
NSString *directoryPath = [paths objectAtIndex:0];
directoryPath =[NSString stringWithFormat:@"%@/%@",directoryPath,@"path1.wav",nil];
audioPath1 = [[AVAudioPlayer alloc]initWithContentsOfURL:[NSURL fileURLWithPath:directoryPath] error:NULL]; 
[audioPath1 play]; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-21T15:18:41.357

应该是这样的，

```
-(void)playFileAdv:(NSString *)audioFile WithVolume:(float)audioLevelIndex{
    [self stopAlert];

    pSound = [[NSSound alloc]initWithContentsOfFile:audioFile byReference:NO];
    playRecursively = NO;
    [pSound setVolume:audioLevelIndex];
    [pSound setDelegate:self];
    [pSound play];

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-21T15:18:37.860

```
if ([[NSFileManager defaultManager] fileExistsAtPath:directoryPath]) {
    NSError *error = nil;
    audioPath1 = [[AVAudioPlayer alloc]initWithContentsOfURL:[NSURL fileURLWithPath:directoryPath] error:&error];
    if (!error) {
        [audioPath1 play];
    }
    else {
        NSLog(@"Error in creating audio player:%@",[error description]);
    }
}
else {
    NSLog(@"File doesn't exists");
} 
```

使用上面的代码并向我们展示控制台日志

# php - URL 检测和 BB 样式标签（正则表达式、前瞻问题）

> ID：15005621
> 
> 赞同：4
> 
> 时间：2013-02-21T15:10:43.027
> 
> 标签：php, regex, preg-replace-callback, negative-lookahead

所以我正在构建一个小型 CMS，我想避免在内容编辑器中允许 HTML。出于这个原因，我想检测文本中的原始 URL 以及支持类似 BB 的标签，以便更好地定制。

```
www.example.com
[link http://www.example.com]Click me[/link] 
```

不幸的是，我对正则表达式还很陌生，我似乎无法让它工作。我在字符串上运行了两个正则表达式：第一个检测原始 URL，第二个检测类似 BB 的 URL。后者似乎工作得很好，但第一个会干扰，并且也会转换包含在标签中的 URL。

我从在[这里](https://stackoverflow.com/questions/910912/extract-urls-from-text-in-php)找到的一段代码开始，并做了一些补充。

这是非标记 URL 的代码：

```
/* don't match URLs preceeded by '[link ' */
(?<!\[link\s)
(
    /* match all combinations of protocol and www. */
    (\bhttps?://www\.|\bhttps?://|(?<!//)\bwww\.)

    /* match URL (no changes made here) */
    ([^\s()<>]+(?:\([\w\d]+\)|([^[:punct:]\s]|/)))

    /* but don't match if followed by [/link] - THIS DOESN'T WORK */
    (?!\[/link\])
) 
```

之前的负面后视`www.`是因为`/`不是单词字符，没有它就像

```
 [link http://www.example.com]example[/link] 
```

之后仍然会匹配`http://`。

上面的正则表达式产生以下匹配（用[http://gskinner.com/RegExr/](http://gskinner.com/RegExr/)测试，匹配以**粗体显示**。我必须在后面添加空格，`http://`因为我不允许发布更多 URL）：

> **www.example.com**
> **http:// www.example.com**
> **http://example.com**
> [链接[http://www.example.com]没](http://www.example.com]no)问题 1[/link]
> [链接 www.example.com]没问题2[/link]
> [链接[http://www.example.com]](http://www.example.com]) **[http://www.example.com[/link](http://www.example.com[/link)** ]

我尝试移动负面的前瞻性并使用括号（非常漫无目的），但没有成功。

为了完整起见，这是标签匹配的正则表达式（似乎有效）：

```
(?:\[link\s)(\bhttps?://|\bwww\.|\bhttps?://www\.)([^\s()<>]+(?:\([\w\d]+\)|([^[:punct:]\s]|/)))\](.*)(?:\[/link\]) 
```

我相信有人可以立即发现错误。

提前非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T17:13:38.397

我已经采用了您的正则表达式，并使用您提供的示例将其插入到 regexr 中，并试图使其工作。

**一步步：**

1）原始正则表达式：[http](http://regexr.com?33snj) ://regexr.com?33snj 。这个正则表达式也匹配 [/link] 的问题在于 URL 匹配位：

```
[^\s()<>]+ 
```

这也将匹配左括号字符“[”，因此当遇到 [/link] 位时匹配不会停止。可以说 [ 字符是有效的 URI 字符，但这仅在极少数情况下（有关更多信息，请参阅[此](https://stackoverflow.com/questions/40568/square-brackets-in-urls)stackoverflow 帖子）。

2）我决定继续使用您的正则表达式，但将左括号字符添加到否定字符列表中：

```
[^\s()<>[]+ 
```

这会让你陷入另一个问题。请参阅[http://regexr.com?33snp](http://regexr.com?33snp)。由于回溯，引擎现在在最后找到了一种绕过负前瞻的方法。

3) 一旦你使 URL 匹配组原子化（通过添加 ?> 到捕获组的开头），引擎停止回溯，我们已经达到了预期的结果。

```
(?<!\[link\s)((\bhttps?://www\.|\bhttps?://|(?<!//)\bwww\.)(?>[^\s()<>[]+(?:\([\w\d]+\)|([^[:punct:]\s]|/)))(?!\[/link\])) 
```

[在http://regexr.com?33sns](http://regexr.com?33sns)中查看它。

# powershell - Powershell @{} 管道错误

> ID：15005624
> 
> 赞同：1
> 
> 时间：2013-02-21T15:10:57.407
> 
> 标签：powershell

我有两个自定义的 powershell 函数，它们的用途如下：

```
Get-Users | Select LoginName | Get-UserJobStatus -StartDate 2013-02-19 -EndDate 2013-02-21 
```

运行此程序时，我收到来自 Web 服务的错​​误：

```
@{LoginName=UserName} not found 
```

这是有道理的，因为传递给 Web 服务函数的用户名应该只是 UserName 而不是 @{LoginName=username}。如何正确格式化？

```
function Global:Get-BackupJobStatus
{
    [cmdletBinding()]

    Param(
      [Parameter(
        Mandatory=$True,
        HelpMessage='Specific account name.',
        ParameterSetName='LoginName',
        ValueFromPipeline=$True
      )]
      [System.String[]]$LoginName = $null,

      [Parameter(
        Mandatory=$false,
        HelpMessage='Start date for report.'
      )]
      [System.DateTime]$startDate,

      [Parameter(
        Mandatory=$false,
        HelpMessage='Ending date for report.'
      )]
      [System.DateTime]$EndDate
    )

    Begin {
      $tempXml = New-Object System.Xml.XmlDocument
      Write-Output $StartDate.toString("yyyy-MM-dd")
    }

    Process{        
      $tempXml.Load("https://webservicecall/info.do?LoginName="+$LoginName+"&Date="+$startDate.toString("yyyy-MM-dd"))
    }

    End {
      Write-Output $tempXml.Users.User
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-21T15:19:40.653

问题是您的函数需要一个`string`-object 作为`loginname`输入，而您正在发送一个`pscustomobject`（由 创建`select`），其**属性**名为`loginname`. 要解决此问题，请使用`select-object`'s`-ExpandProperty`参数发送值`loginname`而不是具有该属性的对象。像这样：

```
Get-Users | Select -ExpandProperty LoginName |
    Get-UserJobStatus -StartDate 2013-02-19 -EndDate 2013-02-21 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-21T16:42:15.197

或者，您可以添加`ValueFromPipelineByPropertyName=$true`以允许您将管道中对象的 LoginName 属性绑定到 $LoginName 参数

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-21T15:17:08.190

如果您要使用“ValuefromPipeline”，那么它只需要是值：

```
Get-Users | Select -ExpandProperty LoginName | Get-UserJobStatus -StartDate 2013-02-19 -EndDate 2013-02-21 
```

# python - 计算数据框中特定列的成对差异

> ID：15005629
> 
> 赞同：5
> 
> 时间：2013-02-21T15:11:15.070
> 
> 标签：python, indexing, dataframe, pandas

我有以下数据框，其中显示了我看到从 Item1 到 Item 2 的移动次数。例如，从 A 到 B 有一个过渡，从 A 到 C 有 2 个过渡，从 C 到 A 有 1 个过渡

* * *

```
 Item1   Item2   Moves
  1  A       B       1
  2  A       C       2
  3  B       D       3
  4  C       A       1
  5  C       B       5
  6  D       B       4
  7  D       C       1 
```

* * *

我想计算两个项目之间的差异，所以新构建的 Dataframe 如下

```
 Item1   Item2   Moves
  1  A       B       1
  2  A       C       1
  3  B       D      -1
  4  C       B       5
  5  D       C       1 
```

有谁知道如何使用 Pandas 做到这一点？我想我需要对前两列进行索引，但我在 Pandas 中很新，我面临很多困难。谢谢

编辑不能有任何重复的对。例如你不能看到两次 a->b （但你当然可以看到 b->a）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-21T18:18:22.200

我相信有人可以将其简化为更少的行，但我已经留了很长时间来帮助澄清发生了什么。简而言之，根据“Item1”在字母表中是否早于“Item2”，将数据框分成两部分。然后翻转'Item1'和'Item2'并否定'Moves'为一件。将它们粘在一起并使用该`groupby`函数聚合行。

```
>>> df
  Item1 Item2  Moves
0     A     B      1
1     A     C      2
2     B     D      3
3     C     A      1
4     C     B      5
5     D     B      4
6     D     C      1
>>> swapidx = df['Item1'] < df['Item2']
>>> df1 = df[swapidx]
>>> df2 = df[swapidx^True]
>>> df1
  Item1 Item2  Moves
0     A     B      1
1     A     C      2
2     B     D      3
>>> df2
  Item1 Item2  Moves
3     C     A      1
4     C     B      5
5     D     B      4
6     D     C      1
>>> df2[['Item1', 'Item2']] = df2[['Item2', 'Item1']]
>>> df2['Moves'] = df2['Moves']*-1
>>> df2
  Item1 Item2  Moves
3     A     C     -1
4     B     C     -5
5     B     D     -4
6     C     D     -1
>>> df3 = df1.append(df2)
>>> df3.groupby(['Item1', 'Item2'], as_index=False).sum()
  Item1 Item2  Moves
0     A     B      1
1     A     C      1
2     B     C     -5
3     B     D     -1
4     C     D     -1 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-21T18:08:10.520

这是一种方法：

首先创建一个仅包含 Item1 和 Item2 的字符串的行。

```
In [11]: df['Items'] = df.apply(lambda row: row['Item1'] + row['Item2'], axis=1)

In [12]: df
Out[12]: 
  Item1 Item2  Moves Items
1     A     B      1    AB
2     A     C      2    AC
3     B     D      3    BD
4     C     A      1    CA
5     C     B      5    CB
6     D     B      4    DB
7     D     C      1    DC 
```

如果`Items`是（按字母顺序）离开它，否则切换它并取反`Moves`：

```
In [13]: df[['Items','Moves']] = df.apply(lambda row: (row[['Items', 'Moves']])
                                                       if row['Items'][0] <= row['Items'][1]
                                                       else (row['Items'][::-1], -row['Moves']),
                                          axis=1)

In [14]: df
Out[14]: 
  Item1 Item2  Moves Items
1     A     B      1    AB
2     A     C      2    AC
3     B     D      3    BD
4     C     A     -1    AC
5     C     B     -5    BC
6     D     B     -4    BD
7     D     C     -1    CD

In [15]: g = df.groupby('Items')

In [16]: g.sum()
Out[16]: 
       Moves
Items       
AB         1
AC         1
BC        -5
BD        -1
CD        -1 
```

大多数情况下，这对你来说可能就足够了。

要获得所需的最终输出，一种骇人听闻的方式可能是：

```
In [17]: df1 = g.first() # the first row in each group

In [18]: df1.Moves = g.sum()

In [19]: df2 = df1.reset_index(drop=True)

In [20]: df2
Out[20]: 
  Item1 Item2  Moves
0     A     B      1
1     A     C      1
2     C     B     -5
3     B     D     -1
4     D     C     -1 
```

但是，请注意否定并不完全正确（对于那些错误的方式，例如 DC 而不是 CD）：

```
In [21]: df2.Moves = df2.apply(lambda row: row['Moves']
                                            if row['Item1'] <= row['Item2']
                                            else -row['Moves'],
                                axis=1)

In [22]: df2
Out[22]: 
  Item1 Item2  Moves
0     A     B      1
1     A     C      1
2     C     B      5
3     B     D     -1
4     D     C      1 
```

# symfony - symfony2 从查询创建学说集合

> ID：15005631
> 
> 赞同：0
> 
> 时间：2013-02-21T15:11:19.107
> 
> 标签：symfony, orm, import, doctrine-orm, entity

不确定这是否可能，但我希望从查询中创建一个学说集合。这个想法是用一些预设值填充集合，这样我就可以更新数据库，就像将用户从旧系统导入/生成到新系统一样。我正在为存储库位而苦苦挣扎。

**实体**

```
// Portal\UserBundle\Entity\User.php

namespace Portal\UserBundle\Entity;
use Doctrine\ORM\Mapping AS ORM;

/** 
 * @ORM\Entity
 */
class User
{
    /** 
     * @ORM\Id
     * @ORM\Column(type="integer")
     */
    private $id;

    /** 
     * @ORM\Column(type="string", length=255, nullable=false)
     */
    private $fistname;

    /**
     * Get id
     *
     * @return integer 
     */
    public function getId()
    {
        return $this->id;
    }

    // etc...
} 
```

**存储库**

```
namespace Portal\UserBundle\Entity\Repository;
use Doctrine\ORM\EntityRepository;

class UserRepository extends EntityRepository
{
   public function getGenerateNewUsers()
   {
    // acts as an import from an old user table
    $sql = " SELECT firstname, surname, other FROM old_user_table ";

    $userCollection = .... not sure how I link query? 
    return $userCollection;       

   }
} 
```

**在控制器内部调用它**

有了上面的内容，我打算能够获取新生成的用户循环并访问我的实体方法对象等。

```
class SetupController extends Controller
{
    public function indexAction(){

        $repository = this->getDoctrine()->getRepository('UserBundle:User');

        $newUsers =   $repository->getGenerateUsers();

        // I can now have access to the users with something like

        foreach($newUsers as $user){
          $user->setFirstName('testing');
          $user->save();
        }

    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T20:11:26.313

霍根提到了 DQL。这是看起来的样子，但您必须确保您的旧数据库已连接。结果是一组实体，您可以使用方法调用来存储您认为合适的部分或全部数据。

```
namespace Portal\UserBundle\Entity\Repository;
use Doctrine\ORM\EntityRepository;

class UserRepository extends EntityRepository
{
   public function getGenerateNewUsers()
   {
    $qb = $this->getEntityManager()
               ->getRepository('Bundle:Old_User')->createQueryBuilder('o');
    $query = $qb->getQuery();
    $results = $query->getResult();

    return $results;       
  }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-21T17:31:21.173

It's usually the case with imports like this that your legacy table doesn't directly map to your new one (in terms of field names, constraints, etc), and may not even be in the same DBMS, so really the best option is a slightly manual approach. Execute your SQL query against your legacy database in your favourite old-fashioned way to get your users as simple arrays, then loop through them and create entities:

```
//Set up an empty collection
$collection = new ArrayCollection();

/*Assuming PDO where you have set up and executed a PDO statement $pdoStatement,
  but mysql_fetch_assoc or whatever is appropriate for your DBMS would work equally
  well. $oldUser should just be a plain associative array*/

while($oldUser = $pdoStatement->fetch(PDO::FETCH_ASSOC)){ 
    //Initialise an empty User entity
    $newUser = new User();

    //Set the properties on the entity using the values from your array
    $newUser->setFirstName($oldUser['firstname']);
    //etc

    //Add your user to the collection
    $collection->add($newUser);
}

return $collection 
```

I notice you're thinking of calling `save()` on your `User` objects in your controller, but it doesn't generally work that way in Doctrine as your entities will be plain objects which don't inherit from anything and don't have any special methods. The way to save the entity to your new database is to grab the [entity manager](http://docs.doctrine-project.org/en/2.0.x/reference/working-with-objects.html) and call its `persist` method.

In your controller:

```
$entityManager = $this->get('Doctrine')->getManager();
foreach($users as $user){
    //Manipulate the user here if you need to

    //Then persist it
    $entityManager->persist($user);
} 
```

As an aside - if you wanted to get a collection of entities by executing a query against your **new** database that's a slightly different problem to which there's a much more elegant solution. [Doctrine Query Language](http://doctrine-orm.readthedocs.org/en/2.0.x/reference/dql-doctrine-query-language.html) allows you to query your database in a SQL-like way while using the language of your objects. With DQL, the results of your queries will by default be [hydrated](http://docs.doctrine-project.org/projects/doctrine1/en/latest/en/manual/data-hydrators.html) into Doctrine entites.

# memory - 字节序是否取决于处理器或内存？

> ID：15005634
> 
> 赞同：2
> 
> 时间：2013-02-21T15:11:36.763
> 
> 标签：memory, language-agnostic, hardware, endianness, cpu-architecture

Endianess 确定字中字节的顺序。让我们考虑以下
内存系统：

![在此处输入图像描述](../Images/b75f053c884b8fa9318f57ddf55b29d5.png)

所以这是一个字节可寻址的 32 位存储器。如果我将一个十六进制值移动`'val = 0x56789A'`到字地址为 0 的内存位置，那么对于 big endian，它将如下所示：
![在此处输入图像描述](../Images/b65468166eac398aa8654f31a262ccde.png)
对于 little endian，如下所示：
![在此处输入图像描述](../Images/a9651e60e4687b8e96ba84f6b60caacb.png)

但是我们知道，在寄存器中，值存储为“56789A”，所以如果我们有一个大端类型的字节顺序，那没问题，因为可以以正确的顺序加载值。
但是在必须颠倒顺序的小端的情况下呢？在 little endian 中，它将被加载为“9A7856”，这是错误的。
那么我们是否像这样将它存储在内存中，（即）对小端类型排序有不同的组织？例如： ![在此处输入图像描述](../Images/5c4b475632edca148a75de763d90262d.png)
现在我们可以将字地址位置'0'的值加载到寄存器中以进行任何进一步的操作。这是一个可能的解决方案。
但现在这意味着字节序将取决于存储单元的排列，而不是完全取决于处理器......这究竟是如何工作的？
还是字节序完全不受内存架构影响，而仅受处理器影响？那么最后是否字节序取决于处理器或内存？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T17:21:56.007

字节顺序实际上是一个接口问题。对于 32 位寄存器加载，一个接口要求 32 位值，而存储器接口提供一个字节数组。必须解决该接口的问题。如果它将字节数组解析为低位字节进入返回值的最高有效位，则它是大端。如果它通过将低位字节放入返回值的最低有效位来解决它，则它是小端。

所以，真正的问题是谁解决了这些接口。从技术上讲，处理器如何从内存中请求数据很重要。如果它通过说“我想要一个 32 位值”来请求它，那么具有字节数组的内存必须解析它。如果它通过说“我想要 4 个字节”来请求它，那么处理器必须在将它存储到寄存器之前解决它。

按照惯例，处理器解析这个接口。这允许内存与大端和小端处理器一起使用，因为它可以为两种类型的处理器提供相同的接口（字节数组），并让处理器以它想要的任何方式解析它。冒着简单化的风险：处理器在加载/存储单元和内存接口单元中解析它。寄存器永远不必考虑它，因为当它到达它们时，它是一个 32 位的值，已经由内存接口单元从它从内存中请求的字节数组中解析出来。

# sql-server - 存在与选择计数

> ID：15005636
> 
> 赞同：1
> 
> 时间：2013-02-21T15:11:40.050
> 
> 标签：sql-server, oracle, plsql

在 SQL Server 中，就性能而言，使用它`IF EXISTS (select * ...)`比使用`IF (select count(1)...) > 0`...

但是，看起来 Oracle 不允许`EXISTS`在语句内部，因为 using在性能方面效率非常低`IF`，有什么替代方法可以做到这一点？`IF select count(1) into...`

代码示例：

```
IF (select count(1) from _TABLE where FIELD IS NULL) > 0 THEN
UPDATE TABLE _TABLE
SET FIELD = VAR    
WHERE FIELD IS NULL;
END IF; 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-21T15:22:40.540

编写代码片段的最佳方法是

```
UPDATE TABLE _TABLE
SET FIELD = VAR    
WHERE FIELD IS NULL; 
```

即只做更新。它要么处理行，要么不处理。如果您需要检查它是否确实处理了行然后添加

```
if (sql%rowcount > 0)
then
... 
```

通常在您有类似逻辑的情况下

```
declare
  v_cnt number;
begin
select count(*) 
  into v_cnt 
  from TABLE 
 where ...;

if (v_cnt > 0) then.. 
```

最好使用 ROWNUM = 1，因为你不关心是否有 4000 万行......只需在找到 1 行后让 Oracle 停止。

```
declare
  v_cnt number;
begin
select count(*) 
  into v_cnt 
  from TABLE 
 where rownum = 1
   and ...;

if (v_cnt > 0) then.. 
```

或者

```
select count(*) 
  into v_cnt 
  from dual
 where exists (select null 
                 from TABLE
                where ...); 
```

无论您喜欢哪种语法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-21T15:25:05.740

根据：http://asktom.oracle.com/pls/asktom/f?p=100:11:0::::P11_QUESTION_ID: [3069487275935](http://asktom.oracle.com/pls/asktom/f?p=100:11:0::::P11_QUESTION_ID:3069487275935)

你可以试试：

```
 for x in ( select count(*) cnt
               from dual 
              where exists ( select NULL from foo where bar ) )
  loop
        if ( x.cnt = 1 ) 
        then
          found do something
        else 
          not found
        end if;
  end loop; 
```

是一种方式（非常快，只在“需要”时运行子查询，其中存在在到达第一行后停止子查询）

该循环始终至少执行一次且最多执行一次，因为没有 group by 子句的表上的 count(*) 总是返回至少一行和最多一行（即使表本身也是空的！）

# java - 使用 JAXB 将带有名称空间的 XML 解组时为空值

> ID：15005640
> 
> 赞同：2
> 
> 时间：2013-02-21T15:12:01.270
> 
> 标签：java, jaxb, unmarshalling

使用 JAXB 解组简单 XML（CSDL 的子集）时遇到问题。
过去有人已经尝试过帮助我（[这里](https://stackoverflow.com/questions/14875956/error-while-trying-to-unmarshal-edmx-with-jaxb)），但是它部分工作，我不知道该怎么做......
请考虑以下 XML：

```
<edmx:Edmx xmlns:edmx="http://schemas.microsoft.com/ado/2007/06/edmx">
  <edmx:DataServices xmlns:m="http://schemas.microsoft.com/ado/2007/08/dataservices/metadata" m:DataServiceVersion="3.0">
    <Schema xmlns:cg="http://schemas.microsoft.com/ado/2006/04/codegeneration" xmlns:sap="http://www.sap.com/Protocols/SAPData" xmlns="http://schemas.microsoft.com/ado/2009/11/edm" xmlns:m="http://schemas.microsoft.com/ado/2007/08/dataservices/metadata" xmlns:d="http://schemas.microsoft.com/ado/2007/08/dataservices" Namespace="myNS">
    </Schema>
  </edmx:DataServices>
</edmx:Edmx> 
```

有人告诉我，我有一个**package-info.java**文件，看起来像（在同一个包中）：

```
@XmlSchema(
  namespace="http://schemas.microsoft.com/ado/2007/06/edmx",
  elementFormDefault=XmlNsForm.QUALIFIED,
  xmlns={
          @XmlNs(prefix="edmx", namespaceURI="http://schemas.microsoft.com/ado/2007/06/edmx"),
          @XmlNs(prefix="", namespaceURI="http://schemas.microsoft.com/ado/2009/11/edm"),
          @XmlNs(prefix="m", namespaceURI="http://schemas.microsoft.com/ado/2007/08/dataservices/metadata")                                
  }
)
@XmlAccessorType(XmlAccessType.FIELD)
package com.sap.ndb.studio.rdl.csdlparser.jaxb.objects;

import javax.xml.bind.annotation.*; 
```

另外，我有以下数据结构：

**Edmx.java**

```
package com.sap.ndb.studio.rdl.csdlparser.jaxb.objects;

import javax.xml.bind.annotation.XmlElement;
import javax.xml.bind.annotation.XmlRootElement;

@XmlRootElement(name = "Edmx")
public class Edmx {

    @XmlElement(name = "DataServices")
    private DataService dataService;

    public DataService getDataService() {
          return dataService;
    }
} 
```

**数据服务.java**

```
package com.sap.ndb.studio.rdl.csdlparser.jaxb.objects;

import javax.xml.bind.annotation.XmlAttribute;
import javax.xml.bind.annotation.XmlElement;
import javax.xml.bind.annotation.XmlRootElement;

@XmlRootElement
public class DataService {

    @XmlElement(name = "Schema")
    private Schema schema;

    @XmlAttribute(name = "DataServiceVersion")
    private double version;

    public Schema getSchema() {
      return schema;
    }
 } 
```

**架构.java**

```
package com.sap.ndb.studio.rdl.csdlparser.jaxb.objects;

@XmlRootElement
public class Schema {
  ....
} 
```

注意：在 Schema.java 中，我有一些与 XML 无关的实现，所以我将其删除（内部逻辑）。

**使用 JAXB 解组 XML 后，返回的 Edmx 对象在“schema”和“version”成员中都包含空值，尽管我在 package-info.java 中提到了所有 xmlns 参数。

任何人？:(**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T15:18:38.830

**更新**

在我对您之前的一个问题的回答中，我从这个问题中提供了模型的映射。

*   [尝试使用 JAXB 解组 EDMX 时出错](https://stackoverflow.com/questions/14875956/error-while-trying-to-unmarshal-edmx-with-jaxb)

我已更新此答案以解决您提出的以下评论：

> 为什么我要声明'namespace=schemas.microsoft.com/ado/2009/11/edm'；在我的@XmlElement 中？很抱歉很烦人（这是我第一次使用 JAXB），但我将有一个很长的 XML，其中包含许多类似于“架构”的 @XmlElement 节点，我只想为它们声明一次命名空间......

您可以通过根据模型类对应的命名空间将模型类组织到不同的包中来减少需要声明命名空间的次数。

**命名空间的包 1`http://schemas.microsoft.com/ado/2007/06/edmx`**

***包信息***

对于每个包，我们将使用`@XmlSchema`注解来指定命名空间限定。在这个例子中，我们只需要为这个特定的包指定命名空间。

```
@XmlSchema(
        namespace="http://schemas.microsoft.com/ado/2007/06/edmx",
        elementFormDefault=XmlNsForm.QUALIFIED,
        xmlns={
                @XmlNs(
                    prefix="edmx", 
                    namespaceURI="http://schemas.microsoft.com/ado/2007/06/edmx"
                ),
        }
)
@XmlAccessorType(XmlAccessType.FIELD)
package forum14875956.edmx;

import javax.xml.bind.annotation.*; 
```

***edmx***

与该类对应的 XML 元素`Edmx`将根据我们在`@XmlSchema`此包的注释上定义的内容进行命名空间限定。

```
package forum14875956.edmx;

import javax.xml.bind.annotation.*;

@XmlRootElement(name = "Edmx")
public class Edmx {

    @XmlElement(name = "DataServices")
    private DataService dataService;

    public DataService getDataService() {
        return dataService;
    }

} 
```

***数据服务***

该类`DataService`包含对对应于不同 XML 名称空间的类的引用。如果`Schema`类在同一个包中，我们可以使用`@XmlElement`注解来覆盖命名空间限定。由于`Schema`在不同的包中，我们可以使用`@XmlElementRef`注释。这告诉 JAXB 从为该类配置的根元素中派生元素信息。

```
package forum14875956.edmx;

import javax.xml.bind.annotation.*;
import forum14875956.schema.Schema;

public class DataService {

    //@XmlElement(namespace="http://schemas.microsoft.com/ado/2009/11/edm", name="Schema")
    @XmlElementRef
    private Schema schema;

    public Schema getSchema() {
        return schema;
    }

} 
```

**命名空间的包 2`http://schemas.microsoft.com/ado/2009/11/edm`**

我们将再次使用`@XmlSchema`来声明第二个包的命名空间信息。

***包信息***

```
@XmlSchema(
        namespace="http://schemas.microsoft.com/ado/2009/11/edm",
        elementFormDefault=XmlNsForm.QUALIFIED,
        xmlns={
                @XmlNs(
                    prefix="", 
                    namespaceURI="http://schemas.microsoft.com/ado/2009/11/edm"
                )
        }
)
@XmlAccessorType(XmlAccessType.FIELD)
package forum14875956.schema;

import javax.xml.bind.annotation.*; 
```

***架构***

类中的元素将是其包`Schema`的注释中基于命名空间限定的命名空间信息。`@XmlSchema`

```
package forum14875956.schema;

import javax.xml.bind.annotation.XmlRootElement;

@XmlRootElement(name="Schema")
public class Schema {

} 
```

* * *

**原始答案**

您需要在`schema`属性的映射中包含命名空间 URI：

```
@XmlRootElement
public class DataService {

    @XmlElement(name = "Schema" , namespace="http://schemas.microsoft.com/ado/2009/11/edm")
    private Schema schema;

    @XmlAttribute(name = "DataServiceVersion")
    private double version;

    public Schema getSchema() {
      return schema;
    }
 } 
```

**完整示例**

不久前，我回答了您的一个问题，提供了该模型的完整映射：

*   [尝试使用 JAXB 解组 EDMX 时出错](https://stackoverflow.com/questions/14875956/error-while-trying-to-unmarshal-edmx-with-jaxb/14876026#14876026)

# html - html 表溢出仅对 td 隐藏

> ID：15005641
> 
> 赞同：0
> 
> 时间：2013-02-21T15:12:03.797
> 
> 标签：html, css, html-table, overflow

我们知道的是表格和第一列的总宽度。第 3 列和第 4 列必须适应内容，第 2 列必须使用其余空间。这第二列必须设置溢出隐藏，只允许一行或一行
行

也许小提琴更清晰

[http://jsfiddle.net/favio41/9z867/](http://jsfiddle.net/favio41/9z867/)

```
<table>
    <colgroup>
        <col class="col1" />
        <col class="col2" />
        <col class="col3" />
        <col class="col4" />
    </colgroup>
    <tbody>
        <tr>
            <td class="date">
                <span class="month monthAndYear">Feb</span>
                <br/>
                <span class="day ng-binding">21</span>
            </td>
            <td style="background-image: url(resources/img/categories/G0400.png);" class="category_icon cat_G0400">
                <span class="concepto ng-binding">This is a example of text</span>
            </td>
            <td>
                <span data-tooltip="Internet, teléfono fijo" class="cat-label cat-tooltip onlyTitle">
                    <span class="text ng-binding">Internet</span>
                    <span class="arrow"></span>
                </span>
            </td>
            <td class="importe">
                <span class="importe_value ng-binding">-33,23</span>
            </td>
        </tr>

        <tr>
            <td class="date">
                <span class="month monthAndYear">Feb</span>
                <br />
                <span class="day ng-binding">21</span>
            </td>
            <td style="background-image: url(resources/img/categories/G0400.png);" class="category_icon cat_G0400">
                <span class="concepto ng-binding">This is a example of text, but this is really big and we want to be hidden the last part because if is too big ...</span>
                <br/>
                <span class="descripcion ng-binding">This is a example of description text</span>
            </td>
            <td>
                <span data-tooltip="Internet, teléfono fijo" class="cat-label cat-tooltip onlyTitle">
                    <span class="text ng-binding">Internet</span>
                    <span class="arrow"></span>
                </span>
            </td>
            <td class="importe">
                <span class="importe_value ng-binding">-33,23</span>
            </td>
        </tr>
</tbody> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T15:15:09.137

在要溢出的单元格中放置一个 DIV。设置 DIV 的尺寸和溢出，而不是 TD。

# symfony - Symfony2 应用程序在缓存清除后无法工作

> ID：15005643
> 
> 赞同：0
> 
> 时间：2013-02-21T15:12:16.773
> 
> 标签：symfony, doctrine-orm, centos, symfony-2.1, cpanel

我正在使用 Cpanel 在 CentOS 服务器中部署 Symfony2 应用程序。

我第一次执行应用程序运行良好，但问题来了当我清除缓存时，应用程序无法正常工作，并出现此错误。

类“Propa\PageBundle\Entity\Page”不是有效的实体或映射的超类。

进入网站： http: [//propa.estudi83.com/app_dev.php/es/empresa/](http://propa.estudi83.com/app_dev.php/es/empresa/)

我能做些什么 ？

更新：解决了问题是 eAccelerator，我卸载了 eAccelerator 并安装了 APC 并且工作正常！！

谢谢

问候

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T17:32:06.477

这可能是缓存优化器问题。如果您使用的是 eAccelerator，那么您将遇到问题，可能是 Doctrine。原因是 eAccelerator 从代码中删除了注释！您可以尝试在学说方面表现良好的 APC。

阅读[apc vs eaccelerator vs xcache](https://stackoverflow.com/questions/930877/apc-vs-eaccelerator-vs-xcache)

# git - 使用 git-tfs rcheckin 将 git 提交一对一映射到 TFS 变更集

> ID：15005647
> 
> 赞同：5
> 
> 时间：2013-02-21T15:12:32.430
> 
> 标签：git, version-control, tfs, git-tfs

## 上下文

*   我们有一个带有发布分支的 git 存储库。
*   我们有一个 TFS 存储库（当前为空）。

我的任务是将 git repo 的发布分支镜像到 TFS 中，以便 git 中的每个提交都映射到 TFS 中的变更集。所有开发人员都只承诺使用 git 并且（假设）不知道 TFS。

阅读[rcheckin 的文档](https://github.com/git-tfs/git-tfs/wiki/Rcheckin)以及对这个[相关问题](https://stackoverflow.com/questions/11333835/git-tfs-a-tfs-changeset-per-git-commit)的回答让我相信 rcheckin 能够做到这一点。

## 问题

git 中的所有提交都被压缩到一个单一的变更集中。

繁殖顺序：

```
git tfs clone http://tfs:8080 $/tfsrepo
cd tfsrepo
git remote add github git@github.com:REPO/Repo.git
git fetch github
git merge github/release
git tfs rcheckin 
```

这会导致单次签入包含所有提交的 TFS。

## 解决问题的其他尝试

*   克隆后，从源（git）repo 中合并第一个提交，rcheckin 以创建共享库

    *   这有效，但随后`git pull github release`导致`git-tfs rcheckin`再次提交压缩。
*   对于原始存储库中的前几个提交，我将它们一个接一个地合并到 git-tfs 共享存储库中，并在每个提交后重新检查。

    *   这种方法很有效，对于每次提交，TFS 中都有一个变更集。但是，原始提交消息位于“merged c02436de4f..”消息下方。
    *   对每个变更集都进行处理是不现实的，即使使用脚本也是如此。
    *   [正如patthoyts](https://stackoverflow.com/users/291641/patthoyts)所指出的，就 TFS 而言，这将使我成为该更改的提交者。

# 我的问题

我需要做些什么来使 TFS 与 git-repo 的发布分支保持最新，以便 git 中的每个提交都有相应的 TFS 变更集？

# 附加信息

我确实对这两个 repos 有管理控制权，如果有必要，我可以重新设置 git repo 的基础，这意味着所有后果。我只是不想失去我们已经创造的历史。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-21T22:08:21.017

我认为您所看到的是 git-tfs 仅使用 HEAD 和 tfs/default 之间最短路径的提交。TFS 的历史是一个变化列表，而 git 是一个图表，你遇到了两者之间的阻抗不匹配。要了解 git-tfs 所看到的内容，`git log --graph --oneline --decorate HEAD tfs/default`请在使用 rcheckin 之前尝试。

如果你想要 1:1::commit:changeset 的东西，试试这个：

```
git tfs clone http://tfs:8080 $/tfsrepo
cd tfsrepo
git remote add github git@github.com:REPO/Repo.git
git fetch github
git tfs rcheckin github/release 
```

另一种方法是使用 cherry-pick 或[rebase](http://www.kernel.org/pub/software/scm/git/docs/git-rebase.html)。

```
git tfs clone http://tfs:8080 $/tfsrepo
cd tfsrepo
git remote add github git@github.com:REPO/Repo.git
git fetch github
git checkout -b about-to-be-rewritten-twice github/release
git rebase tfs/default
git tfs rcheckin 
```

查看[rebase 文档](http://www.kernel.org/pub/software/scm/git/docs/git-rebase.html)以获取更多关于 rebase 可以做的事情的示例。

不要`git push github about-to-be-rewritten-twice:release`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-21T15:53:58.987

我不认为这会很好。如果您确实修复了提交，则每个提交都将具有您向 TFS 提交的那一刻的时间戳和用户 ID。将这些提交到 TFS 时，您无法保留原始作者或时间。微软已经宣布 TFS 将在未来支持 Git，你可能最好等待。所以不久之后，任何需要使用 tfs 的人都可以升级他们的工具并访问您真正的 git 存储库。

我怀疑您的合并进行了合并提交，这导致了壁球。您可以尝试将 git-tfs 分支重置为您的 git master，然后推送提交。我们在共享存储库是 TFS 的地方使用 git-tfs 的另一种方式，我们都使用 git 和 git tfs 进行提交。如果我创建一个分支并添加一些提交，那么`git tfs rcheckin`不会将它们压缩成一个，而是会创建一个与我在本地 git 中的内容相匹配的系列。我确实发现使用“阶段”然后在 tfs 中取消暂存以进行提交会将所有内容压缩为一个。您没有说为什么必须镜像到 TFS，但我建议您尝试将他们指向最近的 microsoft 公告并告诉他们 git 是未来！即使使用 TFS。:)

# crystal-reports - 通过水晶报表导出到多个工作表

> ID：15005651
> 
> 赞同：0
> 
> 时间：2013-02-21T15:12:42.950
> 
> 标签：crystal-reports, crystal-reports-2008, crystal-reports-xi

我正在创建一个将使用两个存储过程的水晶报表。我的要求是将存储过程中的数据吐到两个工作表中。
在boxi水晶报告中可能吗？
谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T16:50:13.960

当您说工作表时，您是指 Excel 吗？

我看到这里有一个可能的答案：

[带有工作表的 Crystal Reports Excel 导出](https://stackoverflow.com/questions/947687/crystal-reports-excel-export-with-worksheets)

# java - 将 Maven 输出发送到 Eclipse 中的文件

> ID：15005654
> 
> 赞同：0
> 
> 时间：2013-02-21T15:12:47.063
> 
> 标签：java, eclipse, maven

我希望将我的 Maven 输出（例如在构建期间）写入文件，因为 Eclipse 中的控制台很快就会阻塞。有什么办法可以在 Eclipse 中做到这一点，还是我必须求助于使用 -DoutputFile 选项从命令行构建我的项目？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-21T15:19:06.150

您可以扩展 Eclipse 控制台缓冲区，使用最大值就可以了。我个人不使用 Eclipse 来运行 maven 命令。我在我的 shell 中定义了一些别名。由于我的评论似乎有帮助，我将其作为答案...

# javascript - 逐像素跟踪六边形的边缘

> ID：15005655
> 
> 赞同：0
> 
> 时间：2013-02-21T15:12:48.873
> 
> 标签：javascript, animation, html5-canvas, trigonometry, hexagonal-tiles

要使用 HTML5 画布在 Javascript 中创建动画，我首先需要能够描述围绕六边形形状的逐点路径。我已经有了每个顶点的 x/y 坐标。我不知道我将在边缘行驶的哪个方向，所以任何解决方案都应该能够在任何一个方向上工作。

六边形的半径（因此每边）为 20 像素。我需要为每一侧生成一组 20 个点，用于映射该路径中每个像素的 x 和 y 位置。这对于直线来说显然很容易，其中每个像素每步递增 1，而另一个轴保持静止。对于有角度的边，我无法获得绘制点所需的三角函数。

我相当肯定这是微不足道的，但希望能在我的脑海中得到一些帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T21:52:23.407

此代码将绘制从点 x1/y1 到点 x2/y2 的等距点。

也可以反向工作（x2/y2 到 x1/y1）。

由于您拥有每个顶点的所有 x/y，因此您应该一切顺利！

这是代码和小提琴：http: [//jsfiddle.net/m1erickson/pW4De/](http://jsfiddle.net/m1erickson/pW4De/)

```
 <!doctype html>
    <html>
    <head>
    <link rel="stylesheet" type="text/css" media="all" href="css/reset.css" /> <!-- reset css -->
    <script type="text/javascript" src="http://code.jquery.com/jquery.min.js"></script>

    <style>
        body{ background-color: ivory; }
        canvas{border:1px solid red;}
        p{font-size:24px;}
    </style>

    <script>
        $(function(){

            var canvas=document.getElementById("canvas");
            var ctx=canvas.getContext("2d");

            DrawDottedLine(300,400,7,7,7,20,"green");

            function DrawDottedLine(x1,y1,x2,y2,dotRadius,dotCount,dotColor){
              var dx=x2-x1;
              var dy=y2-y1;
              var spaceX=dx/(dotCount-1);
              var spaceY=dy/(dotCount-1);
              var newX=x1;
              var newY=y1;
              for (var i=0;i<dotCount;i++){
                      drawDot(newX,newY,dotRadius,dotColor);
                      newX+=spaceX;
                      newY+=spaceY;              
               }
               drawDot(x1,y1,3,"red");
               drawDot(x2,y2,3,"red");
            }
            function drawDot(x,y,dotRadius,dotColor){
                ctx.beginPath();
                ctx.arc(x,y, dotRadius, 0, 2 * Math.PI, false);
                ctx.fillStyle = dotColor;
                ctx.fill();              
            }           

        }); // end $(function(){});
    </script>

    </head>

    <body>

    <canvas id="canvas" width=307 height=407></canvas>

    </body>
    </html> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T15:40:22.947

您可以考虑 Bresenhams 线算法。这是一个标准的 goto 并且易于实现.... [http://en.wikipedia.org/wiki/Bresenham%27s_line_algorithm](http://en.wikipedia.org/wiki/Bresenham%27s_line_algorithm)

```
function plotLine(p1, p2){
    var dx = p2.x - p1.x;
    var dy = p2.y - p2.y;
    var err = 0.0;
    var derr = Math.abs( dy / dx ); 

    var y = p1.y;
    for(var x = p1.x; x < p2.x; x++){
        drawPoint(new Point(x,y));
        err = err + derr;
        if(err >= 0.5 ) {
           y++;
           err = err - 1.0;
        }
    }
} 
```

尽管这可能是一种不好的方法，因为它不会抗锯齿。这些是实现别名的画线算法（谷歌它......），或者最好的方法是使用画线 API 中内置的画布，并且只覆盖越来越长的连续线。

# asp.net-mvc-3 - 如何编写 Linq 查询来获取复杂的模型项？

> ID：15005657
> 
> 赞同：0
> 
> 时间：2013-02-21T15:12:55.400
> 
> 标签：asp.net-mvc-3, linq, entity-framework, linq-to-entities

我首先使用 EF 代码。现在，我很难弄清楚如何编写 LINQ 以将数据检索到我的 Controller 中的模型中，以便在视图中显示它们。基本上，我正在接收 HolterTest 数据的提要，并且我正在尝试为执行一系列特定任务以处理 HolterTest 的人员创建一个工作列表，允许他们在任务完成时对其进行标记，并提供位置状态各个测试都在流程中 基本的 Task 类是这样他们可以添加或更改流程中的步骤，displayOrder 是任务完成的顺序。WorkTask 是任务的特定实例，允许我们标记完成它的人员和时间。WorkItem 是一种复杂类型，包括 HolterTest、WorkTasks 列表和状态信息，包括 WorkTasks 何时完成。

模型类：

```
public class HolterTest
{
    public Int32 HolterTestID { get; set; }
    public string PatientNumber { get; set; }
    public string LastName { get; set; }
    public DateTime RecordingStartDateTime { get; set; }
    public System.Nullable<DateTime> AppointmentDateTime { get; set; }

}

public class Task
{
    public Int32 TaskID { get; set; }
    public string Name { get; set; }
    public string Description { get; set; }
    public Int32 DisplayOrder { get; set; }
    public bool IsActive { get; set; }
}

public class WorkTask
{
    public Int32 WorkTaskID { get; set; }
    public Task Task { get; set; }
    public bool IsCompleted { get; set; }
    public System.Nullable<DateTime> CompletedDateTime { get; set; }
    public string CompletedBy { get; set; }
}   

public class WorkItem
{
    public Int32 WorkItemID { get; set; }
    public HolterTest HolterTest { get; set; }
    public string Status { get; set; }
    public List<WorkTask> WorkTasks { get; set; }
    public bool IsStarted { get; set; }
    public bool IsCompleted { get; set; }
    public System.Nullable<DateTime> CompletedDateTime { get; set; }

} 
```

目前我有一个业务逻辑函数，它获取 HolterTests 列表，找到没有 WorkItem 的那些，并创建 WorkItems，根据当前活动的任务列表关联包括 WorkTasks 在内的 HolterTests。

我的问题是如何编写 LINQ 来为我的 WorkItemController 获取所有 WorkItems（及其子项），以便我可以通过 PatientNumber 在 View（WorkItems where IsCompleted = false）中显示要执行的工作，并使其可以更新特定 WorkItem 的 WorkTasks。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T16:15:31.623

You want to access the related using it's navigation properties. Note that in your example, you haven't setup the navigation properties to be virtual. You should should update your model like this:

```
public class WorkItem
{
    public Int32 WorkItemID { get; set; }
    public virtual HolterTest HolterTest { get; set; }
    public string Status { get; set; }
    public virtual List<WorkTask> WorkTasks { get; set; }
    public bool IsStarted { get; set; }
    public bool IsCompleted { get; set; }
    public System.Nullable<DateTime> CompletedDateTime { get; set; }

} 
```

A simple function for accessing the work items by patient number is this:

```
IEnumerable<WorkItem> GetWorkIncompleteWorkItemsByPatient(string patientNumber)
{
  var db = new YourContext();
  return db.WorkItems.Where(wi => wi.IsCompleted == false && wi.HolterTest.PatientNumber == patientNumber);
} 
```

Then to work on the related tasks, you would access it through the task, in this example if you knew the task ID:

```
var workTask = YourWorkItem.WorkTasks.FirstOrDefault(wt => wt.WorkTaskID == worktaskId); 
```

You could look through all the tasks in the work item like this:

```
foreach (var workTask in YourWorkItem.WorkTasks)
{
  //your logic here...
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-21T15:36:50.300

Linq 到实体解释 [http://msdn.microsoft.com/en-us/library/bb399367.aspx](http://msdn.microsoft.com/en-us/library/bb399367.aspx)

但从这里开始可能更适合：EF 主站点[http://msdn.microsoft.com/en-us/data/ee712907](http://msdn.microsoft.com/en-us/data/ee712907)

如果你真的想直接尝试这个视频和示例代码。[http://msdn.microsoft.com/en-us/data/jj193542](http://msdn.microsoft.com/en-us/data/jj193542) 然后看到这个[http://msdn.microsoft.com/en-us/data/jj573936](http://msdn.microsoft.com/en-us/data/jj573936)

基本上基于您拥有的 POCO，您可以读取每个 POCO 并以这种方式获取数据。但是，如果 POCOS 定义了导航属性和外键，则 EF 会做很多繁重的工作。值得重新审视 POCO 定义和 Code-First 模式。

# vb.net - c# 到 VB 的声明数组的翻译

> ID：15005659
> 
> 赞同：2
> 
> 时间：2013-02-21T15:13:00.137
> 
> 标签：vb.net

这应该是一件容易的事，但我的大脑不工作

在 C# 中，我可以拥有以下内容：

```
SqlParameter[] spParameter 
spParameter = new SqlParameter[3]; 
```

我如何在VB中做到这一点

```
Dim Params() As SqlParameter
Params = New SqlParameter(4) //<- This line does not work because 
                             //    SqlParameter has a constructor 
```

那么我如何实际创建数组呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-21T15:17:12.143

你错过了波浪形的大括号：

```
Dim spParameter As SqlParameter()
spParameter = New SqlParameter(2) {} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-21T15:20:18.197

Dim Params(3) 作为 SqlParameter

参数 (0) = 新的 SqlParameter()

参数 (1) = 新的 SqlParameter()

参数(2) = 新的 SqlParameter()

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-21T15:16:01.757

将索引放入类型中：

```
Dim Params(2) As SqlParameter 
```

请注意，C# 使用长度，而 VB 使用最高索引，因此 C# 中的 3 对应于 VB 中的 2。

# r - 寻找一种更好的方法从查找表中添加 data.table 中的列

> ID：15005666
> 
> 赞同：8
> 
> 时间：2013-02-21T15:13:19.793
> 
> 标签：r, data.table

我想通过与常用列&`key`的查找表合并，在我的 data.table中创建一个新列。然后从这个新列（, , ）的值中，我想生成 3 个新列（, , ）来索引data.table 中的列。`index1``index2``key``a``b``c``a``b``c``value`

我的 data.table 看起来像这样：

```
 index1      index2    value
1       2          0     0.00
2       1          2    -5.00
3       3          2    -5.00
4       3          2    17.50
5       2          2    15.00
6       1          2    -7.50
7       3          2     3.75
8       1          2    -8.75
9       2          1    15.00
10      2          1    12.50 
```

查找表是这样的：

```
 index1  index2  key
1    1        1   a
2    1        2   b
3    2        1   a
4    2        2   c
5    3        1   c
6    3        2   b 
```

最终结果是这样的：

```
 index1     index2   value  key       a       b      c
1       2          0     0.00   NA      NA      NA     NA
2       1          2    -5.00    b      NA   -5.00     NA
3       3          2    -5.00    b      NA   -5.00     NA
4       3          2    17.50    b      NA   17.50     NA
5       2          2    15.00    c      NA      NA  15.00
6       1          2    -7.50    b      NA   -7.50     NA
7       3          2     3.75    b      NA    3.75     NA
8       1          2    -8.75    b      NA   -8.75     NA 
9       2          1    15.00    a   15.00      NA     NA
10      2          1    12.50    a   12.50      NA     NA 
```

我尝试通过首先合并 data.table 和查找表来解决它`merge()`，然后使用`J()`三个不同的时间来实现上述结果。我对 data.table 很陌生，但我很想学习一种更优雅的方法来解决这个问题，而不是多次重复该过程。这是我的代码：

```
DT <- merge(DT, lookup, by=c('index1', 'index2'), all.x=TRUE)
DT <- data.table(DT)  #Don't know why but DT became a data.frame after merge()
DT[J("a"), a:=value]
DT[J("b"), b:=value]
DT[J("c"), c:=value] 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-21T15:34:50.327

由于您想在 index1 和 index2 上加入，您可以`merge`按原样使用，或者如果您将这些作为键分配给每个表，那么您可以简单地使用`[]`加入。（如`DT[lookup]`）

```
 setkey(lookup, index1, index2)
 setkey(DT, index1, index2) 
```

然后您可以迭代表中的每个唯一值`key`，`lookup`如下所示

```
 keyVals <- unique(lookup[, key])

 for (k in keyVals)
   DT[lookup[key==k], c(k) := value] 
```

* * *

结果：

```
DT
#     index1 index2 value    a     b  c
#  1:      1      2 -5.00   NA -5.00 NA
#  2:      1      2 -7.50   NA -7.50 NA
#  3:      1      2 -8.75   NA -8.75 NA
#  4:      2      0  0.00   NA    NA NA
#  5:      2      1 15.00 15.0    NA NA
#  6:      2      1 12.50 12.5    NA NA
#  7:      2      2 15.00   NA    NA 15
#  8:      3      2 -5.00   NA -5.00 NA
#  9:      3      2 17.50   NA 17.50 NA
# 10:      3      2  3.75   NA  3.75 NA 
```

# ruby - Capybara 将下拉选项文本写入数组

> ID：15005667
> 
> 赞同：8
> 
> 时间：2013-02-21T15:13:20.833
> 
> 标签：ruby, capybara

我想将下拉列表的选项放入通常在水豚中的数组中。在这个过程之后，我期望有一个字符串数组，包含所有下拉选项。我已经尝试了下面的代码，但是无论选项计数是多少，我的数组的长度都保持为 1。

```
periods = Array.new()
periods = all('#MainContent_dd')
print periods.length 
```

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2013-02-21T16:33:53.133

问题是`all('#MainContent_dd')`返回所有具有 id 的元素`MainContent_dd`。假设这是您的下拉列表并且 id 是唯一的，则应`periods.length`为 1（即`periods`选择列表）。

您想要做的是获取`option`元素而不是`select`元素。

假设你的 html 是：

```
<select id="MainContent_dd">
    <option>Option A</option>
    <option>Option B</option>
    <option>Option C</option>
</select> 
```

然后你可以这样做：

```
 periods = find('#MainContent_dd').all('option').collect(&:text)
  p periods.length
  #=> 3
  p periods
  #=> ["Option A", "Option B", "Option C"] 
```

这是做什么的：

1.  `find('#MainContent_dd')`- 查找要从中获取选项的选择列表
2.  `all('option')`- 获取选择列表中的所有选项元素
3.  `collect(&:text)`- 收集每个选项的文本并将其作为数组返回

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-01T20:54:14.593

如果使用的驱动程序不快，@JustinCo 的答案会出现问题：Capybara 将在每次调用`text`. 因此，如果 select 包含 200 个元素，Capybara 将对浏览器进行 201 次查询，而不是 1 次，这可能会很慢。

我建议您使用一个带有 Javascript 的查询来做到这一点：

```
periods = page.execute_script("options = document.querySelectorAll('#MainContent_dd > option'); texts=[]; for (i=0; i<options.length; i++) texts.push(options[i].textContent); return texts") 
```

或（使用 jQuery 的较短变体）：

```
periods = page.evaluate_script("$('#MainContent_dd').map(function() { return $(this).text() }).get()") 
```

# sql-server - 更新列中单元格的百分比

> ID：15005669
> 
> 赞同：2
> 
> 时间：2013-02-21T15:13:27.343
> 
> 标签：sql-server, tsql

我的表中有 400 万行，其中有一个名为 Cancelled Bookings 的空白列，分为 3 年 2010、2011 和 2012

```
Booking_Skey BookingNumber ArrivalDate DepartureDate BookingDate CancelledDate BookingValue PitchType_Skey Site_Skey
      124532 B00124532      2010-12-31    2011-01-02  2010-12-31          NULL        10.00              7         2 
```

我需要做的是创建一个代码，我可以在其中更改我想要更新的那一年的取消百分比：

因此，对于 2010 年，我需要以下内容

--取消的预订--

*   8% 的预订在 2010 年被取消，取消日期可以等于或小于到达日期，也可以等于或大于预订日期
*   8% 中的 20% 在到达日当天取消
*   8% 中的 20% 在抵达日期前一天取消
*   8% 中的 20% 在抵达日期前 7 天取消
*   其余的取消是在 1 到 90 天之间随机分配的

.

```
USE Occupancy
SELECT ArrivalDate, 
DATEADD(day, 
CASE WHEN Rand(CHECKSUM(NEWID())) BETWEEN 0 and 0.92 THEN NULL ELSE
CASE WHEN Rand(CHECKSUM(NEWID())) BETWEEN 0.92 and 0.94 THEN 0 ELSE
CASE WHEN Rand(CHECKSUM(NEWID())) BETWEEN 0.94 and 0.96 THEN -1 ELSE
CASE WHEN Rand(CHECKSUM(NEWID())) BETWEEN 0.96 and 0.98 THEN -7 ELSE
Round(Rand(CHECKSUM(NEWID())) * -90,0) END END END END, ArrivalDate) AS DaystoReduce 
FROM Bookings
WHERE DATEPART(Year,ArrivalDate) = '2010' and CancelledDate BETWEEN ArrivalDate AND DepartureDate 
```

你能帮我吗？

谢谢

韦恩

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T17:40:10.587

像下面这样的东西怎么样？它不是很漂亮，所以将其作为练习留给你，但基本上它沿着计算每种类型的数量，然后将规则应用于行号......

```
declare @shareCancelled float, @shareSameDay float, @sharePrevDay float, @shareSevenDays float
select @shareCancelled = 0.08, @shareSameDay = 0.20, @sharePrevDay = 0.20, @shareSevenDays = 0.20

declare @count int, @cancelled int, @sameDay int, @prevDay int, @sevenDays int
select @count = COUNT(*) from Bookings WHERE DATEPART(Year,ArrivalDate) = '2010' and CancelledDate BETWEEN ArrivalDate AND DepartureDate
select @cancelled = @count * @shareCancelled,
       @sameDay = @count * @shareCancelled * @shareSameDay,
       @prevDay = @count * @shareCancelled * @sharePrevDay,
       @sevenDays = @count * @shareCancelled * @shareSevenDays

select ArrivalDate,
DATEADD(day,
CASE WHEN a.RowNum <= @sameDay THEN 0
     WHEN a.RowNum <= @sameDay + @prevDay THEN -1
     WHEN a.RowNum <= @sameDay + @prevDay + @sevenDays THEN -7
     WHEN a.RowNum <= @cancelled THEN -(ABS(CAST(NEWID() AS binary(6)) %90) + 1)
     ELSE NULL END
, GETDATE()) as DaystoReduce 
from (
  select *, ROW_NUMBER() OVER(ORDER BY NEWID()) as RowNum from Bookings WHERE DATEPART(Year,ArrivalDate) = '2010' and CancelledDate BETWEEN ArrivalDate AND DepartureDate
) as a 
```

# haskell - 为什么 Haskell 中没有隐式并行性？

> ID：15005670
> 
> 赞同：61
> 
> 时间：2013-02-21T15:13:29.090
> 
> 标签：haskell, concurrency, parallel-processing, compiler-optimization

Haskell 是函数式且纯粹的，因此基本上它具有编译器能够处理[隐式并行](http://en.wikipedia.org/wiki/Implicit_parallelism)性所需的所有属性。

考虑这个简单的例子：

```
f = do
  a <- Just 1
  b <- Just $ Just 2
  -- ^ The above line does not utilize an `a` variable, so it can be safely
  -- executed in parallel with the preceding line
  c <- b
  -- ^ The above line references a `b` variable, so it can only be executed
  -- sequentially after it
  return (a, c)
  -- On the exit from a monad scope we wait for all computations to finish and 
  -- gather the results 
```

执行计划的示意图可以描述为：

```
 do
                |
      +---------+---------+
      |                   |
  a <- Just 1      b <- Just $ Just 2
      |                   |
      |                 c <- b
      |                   |
      +---------+---------+
                |
           return (a, c) 
```

为什么编译器中还没有使用标志或编译指示实现这样的功能？有哪些实际原因？

* * *

## 回答 #1

> 赞同：81
> 
> 时间：2013-02-21T17:04:30.487

这是一个长期研究的话题。虽然您可以在 Haskell 代码中隐式推导出并行性，但问题是对于当前硬件而言并行性太多，粒度太细。

因此，您最终将精力花在记账上，而不是更快地运行。

因为我们没有无限的并行硬件，所以一切都是为了选择正确的粒度——太粗就会有空闲的处理器，太细就会产生不可接受的开销。

我们所拥有的是更粗粒度的并行性（火花），适用于生成数千或数百万个并行任务（因此不在指令级别），它们映射到我们今天通常可用的仅有的少数内核上。

请注意，对于某些子集（例如数组处理），有具有严格成本模型的全自动并行化库。

有关这方面的背景，请参阅[反馈定向隐式并行](https://timharris.uk/papers/2007-fdip.pdf)，他们在其中介绍了一种自动化方法来插入`par`任意 Haskell 程序。

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2013-02-21T15:46:19.190

`a`虽然由于和之间的隐式数据依赖性，您的代码块可能不是最好的示例`b`，但值得注意的是，这两个绑定在

```
f = do
  a <- Just 1
  b <- Just $ Just 2
  ... 
```

将给出相同的结果

```
f = do
  b <- Just $ Just 2
  a <- Just 1
  ... 
```

所以这仍然可以以推测的方式并行化。值得注意的是，这不需要与 monad 有任何关系。例如，`let`我们可以并行计算一个 -block 中的所有独立表达式，或者我们可以引入一个`let`可以这样做的版本。Common Lisp的[lparallel 库可以做到这一点。](http://lparallel.org/defpun/)

现在，我绝不是这方面的专家，但这是我对这个问题的理解。一个主要的绊脚石是确定何时并行计算多个表达式是有利的。启动单独的线程进行评估会产生开销，并且如您的示例所示，它可能会导致工作浪费。某些表达式可能太小而无法使并行评估值得开销。据我了解，提出一个完全准确的表达式成本指标将相当于解决停止问题，因此您只能使用启发式方法来确定要并行评估的内容。

那么在一个问题上投入更多的核心并不总是更快。即使在使用许多可用的 Haskell 库显式并行化问题时，由于大量内存分配和使用以及这给垃圾收集器和 CPU 缓存带来的压力，您通常不会仅仅通过并行评估表达式来看到太多的加速。您最终需要一个漂亮的紧凑内存布局并智能地遍历您的数据。让 16 个线程遍历链表只会成为内存总线的瓶颈，实际上可能会使事情变慢。

至少，什么表达式可以有效地并行化对于许多程序员来说并不明显（至少对这个来说不是），所以让编译器有效地做到这一点并非易事。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-02-21T18:44:04.097

简短的回答：有时并行运行的东西变得更慢，而不是更快。弄清楚什么时候是，什么时候不是一个好主意是一个未解决的研究问题。

但是，您仍然可以“突然利用所有这些内核，而不必担心线程、死锁和竞争条件”。这不是自动的；你只需要给编译器一些关于在哪里做的提示！:-D

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-02-21T18:54:36.487

原因之一是因为 Haskell 是非严格的，默认情况下它不会评估任何内容。一般来说，编译器不知道计算`a`并`b`终止，因此试图计算它会浪费资源：

```
x :: Maybe ([Int], [Int])
x = Just undefined
y :: Maybe ([Int], [Int])
y = Just (undefined, undefined)
z :: Maybe ([Int], [Int])
z = Just ([0], [1..])
a :: Maybe ([Int], [Int])
a = undefined
b :: Maybe ([Int], [Int])
b = Just ([0], map fib [0..])
    where fib 0 = 1
          fib 1 = 1
          fib n = fib (n - 1) + fib (n - 2) 
```

考虑以下功能

```
main1 x = case x of
              Just _ -> putStrLn "Just"
              Nothing -> putStrLn "Nothing" 
```

`(a, b)`部分不需要评估。一旦你得到 x = Just _ 你就可以继续分支 - 因此它适用于所有值，但`a`

```
main2 x = case x of
              Just (_, _) -> putStrLn "Just"
              Nothing -> putStrLn "Nothing" 
```

此函数强制对元组进行评估。因此`x`将因错误而终止，而休息将起作用。

```
main3 x = case x of
              Just (a, b) -> print a >> print b
              Nothing -> putStrLn "Nothing" 
```

此函数将首先打印第一个列表，然后打印第二个。它适用于`z`（导致打印无限的数字流，但 Haskell 可以处理它）。`b`最终会耗尽内存。

现在通常您不知道计算是否终止以及它将消耗多少资源。无限列表在 Haskell 中非常好：

```
main = maybe (return ()) (print . take 5 . snd) b -- Prints first 5 Fibbonacci numbers 
```

因此，在 Haskell 中生成线程来评估表达式可能会尝试评估一些不应该被完全评估的东西——比如所有素数的列表——但程序员将其用作结构的一部分。上面的例子非常简单，你可能会争辩说编译器会注意到它们——但是由于停机问题，通常不可能（你不能编写接受任意程序及其输入并检查它是否终止的程序）——因此它不是安全优化。

此外 - 其他答案提到过 - 很难预测额外线程的开销是否值得参与。即使 GHC 没有使用绿色线程（使用固定数量的内核线程 - 除了一些例外）为 spark 生成新线程，您仍然需要将数据从一个核心移动到另一个核心并在它们之间进行同步，这可能会非常昂贵。

然而，Haskell 确实引导了并行化，而不会破坏语言的纯度`par`和类似的功能。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2016-09-03T15:15:29.840

实际上有这样的尝试，但由于可用内核数量较少，因此没有在普通硬件上进行。该项目称为[Reduceron](https://www.cs.york.ac.uk/fp/reduceron/)。它以高并行度运行 Haskell 代码。如果它曾经作为[适当的 2 GHz ASIC 内核](https://www.doc.ic.ac.uk/~wl/icprojects/papers/reduceron08.pdf)发布，我们将在 Haskell 执行速度方面取得重大突破。

# ruby - Net::SSH 转发不起作用

> ID：15005671
> 
> 赞同：2
> 
> 时间：2013-02-21T15:13:32.773
> 
> 标签：ruby, ssh, net-ssh

我想通过 Net::SSH 转发一个端口，如下所示：

```
ssh = Net::SSH.start('host', 'user', config: true)
ssh.forward.local(3333, 'localhost', 80)
ssh.loop 
```

据我了解，这相当于：

```
ssh user@host -L 3333:localhost:80 
```

使用命令行版本，我可以向远程主机发送 HTTP 请求`localhost:3333`并获得答复。`localhost:80`对于 Ruby 版本，我没有得到任何答案。

任何想法为什么？

**编辑：**

我试过`net-ssh-gateway`了，它有效。查看它的代码，我真的看不出它在建立连接方面有什么不同。

# wpf - 如何管理放置在组合框弹出部分中的 DataGrid 中的列可见性

> ID：15005675
> 
> 赞同：0
> 
> 时间：2013-02-21T15:13:42.640
> 
> 标签：wpf, xaml, datatrigger

我的 WPF 页面上有一个单选按钮和一个组合框。这`ComboBox`是 normal 的自定义版本`ComboBox`，可以在下拉列表中显示多个列。`IsChecked`我想要的只是根据单选按钮的状态显示或隐藏某个列。我正在尝试使用 a`DataTrigger`来避免代码落后。

```
<RadioButton Content="Show ID Column" x:Name="chkScrollCustomerNumber" IsChecked="True" >

<m:MultiColumnComboBox x:Name="cboCustomer" IsSynchronizedWithCurrentItem="True" 
ItemsSource="{Binding AllCustomers}" SelectedValuePath="customerID"             DisplayMemberPath="customerID" SelectedValue="{Binding SalesOrder.customerID}">
    <DataGridTextColumn x:Name="colID" Binding="{Binding customerID, Mode=Default}" />
    <DataGridTextColumn Binding="{Binding customerName, Mode=Default}" />
    <DataGridTextColumn Binding="{Binding billingAddress, Mode=Default}"/>

    <m:MultiColumnComboBox.Style>
        <Style>
            <Setter Property="Visibility" Value="Collapsed"/>
            <Style.Triggers>
                <DataTrigger Binding="{Binding ElementName=chk1, Path=IsChecked}" Value="True">
                    <Setter TargetName="colID" Property="Visibility" Value="Visible"/>
                </DataTrigger>
                <DataTrigger Binding="{Binding ElementName=chk1, Path=IsChecked}" Value="False">
                    <Setter TargetName="colID" Property="Visibility" Value="Collapsed"/>
                </DataTrigger>
            </Style.Triggers>
        </Style>
    </m:MultiColumnComboBox.Style>
</m:MultiColumnComboBox> 
```

但它告诉我找不到 colID。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T15:47:14.357

**编辑**

好的，这是如何让这个东西工作的技巧：

*   创建 VisibilityToBooleanConverter：

```
public class VisibilityToBoolean : IValueConverter
{
    public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
    {
        return (Visibility) value == Visibility.Visible;
    }

    public object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture)
    {
        return (bool) value ? Visibility.Visible : Visibility.Collapsed;
    }
} 
```

*   通过此转换器将 RadioButton 的 IsChecked 属性绑定到所需的列：

```
<RadioButton 
    IsChecked="{Binding ElementName=cboCustomer, 
             Path=Columns[0].Visibility, 
             Converter={StaticResource boolToVis}, 
             Mode=OneWayToSource}"
    ... /> 
```

*   为每个列指定适当的索引`RadioButton`

*（之前的所有建议都是错误的，因为这里的 DataGridTextColumn 不是逻辑树的一部分，并且它没有 DataContext 属性，因此尝试将其属性绑定到任何地方都没有用）*

# python - 需要优化以在大文件夹中更快地搜索

> ID：15005681
> 
> 赞同：1
> 
> 时间：2013-02-21T15:14:06.403
> 
> 标签：python, search, optimization

我有一个包含很多文件的文件夹，我需要优化搜索速度，因为我有超过 1k 的不同文件要搜索，实际上我正在使用这个：

```
for path,dirs,files in os.walk('M:/MYFOLDER'): 
```

但是搜索所有文件夹需要很长时间（超过 30 分钟）（因为它逐个文件搜索），但“Windows 搜索”需要 20 秒才能找到它。

您知道一些优化搜索并使其更快的技巧吗？

感谢您的任何提示。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-21T15:20:23.353

你在**[信息检索](http://en.wikipedia.org/wiki/Information_retrieval)**的土地上，而不是每次都从头开始搜索 - 做搜索引擎所做的事情：

*   [索引](http://en.wikipedia.org/wiki/Index_%28search_engine%29)你的数据（预处理，只做一次，或者偶尔做一次 - 这假设文档的集合是相对稳定的 - 与搜索次数相比变化很小）
*   每次出现查询时——在索引中搜索以快速找到答案。

这种方法不仅允许您稍后返回相关文档，而且还允许您通过使用一些已经证明的启发式方法（例如[tf-idf 模型](http://en.wikipedia.org/wiki/Tf%E2%80%93idf)）将它们从最相关到​​最不相关进行排名。

**[有一个名为Lucene](http://lucene.apache.org/core/)**的开源项目，它还具有可以帮助您实现的[python 绑定。](http://lucene.apache.org/pylucene/)Lucene 是一个成熟的广泛使用（并且经过广泛测试）的信息检索库（例如，用于 eclipse 搜索）

* * *

**PS**如果您发现自己对信息检索更感兴趣，我建议您阅读 Manning 的[信息检索简介](http://nlp.stanford.edu/IR-book/)- 它会让您对该领域有很好的理解 - 但对于应用您的任务来说，这真的不是强制性的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T15:38:52.200

您可以使用[Windows Search SDK](http://www.microsoft.com/en-us/download/details.aspx?id=7388) + [Python ctypes](http://docs.python.org/3/library/ctypes.html)。

# asp.net - RIA 服务错误但未使用

> ID：15005682
> 
> 赞同：1
> 
> 时间：2013-02-21T15:14:19.610
> 
> 标签：asp.net, asp.net-mvc, iis, wcf-ria-services, asp.net-webpages

我创建了一个 ASP.NET MVC WebPages 应用程序。在本地完美运行。当我将它安装为网站时，它可以在服务器上完美运行。但是，当它作为 IIS 应用程序安装时（低于另一个网站，使用相同的应用程序池），它所做的只是抛出这个异常：

> 无法加载文件或程序集“System.ServiceModel.DomainServices.Hosting, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35”或其依赖项之一。该系统找不到指定的文件。

显然与未使用的 WCF RIA 服务相关的东西。我只使用 Linq to SQL。这怎么可能？

服务器：带有 IIS 7.5 的 Windows Server 2008 R2

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-25T08:26:33.633

检查应用程序的 web.config 是否包含以下条目：

```
<httpModules>
  <add name="DomainServiceModule"
       type="System.ServiceModel.DomainServices.Hosting.DomainServiceHttpModule, System.ServiceModel.DomainServices.Hosting, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" />
</httpModules> 
```

它位于该`<system.web>`部分。

还有另一个条目，例如：

```
<modules runAllManagedModulesForAllRequests="true">
  <add name="DomainServiceModule" 
       preCondition="managedHandler"
       type="System.ServiceModel.DomainServices.Hosting.DomainServiceHttpModule, System.ServiceModel.DomainServices.Hosting, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" />
</modules> 
```

在`<system.webserver>`节中。

删除条目，那么您不应该得到异常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-15T12:53:03.733

我知道为时已晚，但我的回答可能对某些人有用。我有类似的问题，但没有对应于 IIS。

所以，我有基于 RIA 服务的网络应用程序。这个应用程序使用了单独的 dll (DAL)，其中包含由 RIA 属性赋予的一些类（当然，它引用了 RIA dll）。dll (DAL) 被另一个应用程序引用，该应用程序不使用 RIA 并引发与您提到的相同的错误（但仅使用`System.ServiceModel.DomainServices.Server`）。此错误仅在 WCF 通道创建期间引发 (ChannelFactory<>)。所以我想WCF在分析合同类的属性时应该知道所有引用的dll。但是我没有找到任何解释为什么 WCF 不只使用自己的属性而不分析所有属性。

# c# - 实体框架 - 事件问题

> ID：15005684
> 
> 赞同：0
> 
> 时间：2013-02-21T15:14:26.560
> 
> 标签：c#, sql, entity-framework, events, opc

我刚开始强迫自己使用实体框架（我知道我落后了很长一段路），但我已经陷入了第一个障碍。

我正在编写的程序只是观察 PLC 使其成为现实。当它变为真时，会触发一个事件，然后将值（目前是随机的）输入到 SQL 中。然后我将该位设置为假。

我遇到的问题是事件触发一次，条目被添加，并且位被设置为假。但是，该事件永远不会再次触发。如果我注释掉所有的 SQL 位然后只是将位设置为 false 那么它可以完美地工作并触发多次。

这是我拥有的大部分代码。

任何帮助将非常感激。

```
static void Main(string[] args)
{
    PlcListener plcListener = new PlcListener();
    plcLister.BitChanged += (bitVal) => On_BitChanged(bitVal, plcListener)
    plcListner.Start();
}

private static void On_BitChanged(bool bitVal, PlcListener plcListner)
{
    SqlEntities sqlEntity = new SqlEntities();
    SampleData sampleData = new SampleData(){ Data = new Random().Next(); };

    sqlEntity.AddToSampleDatas(sampleData);
    sqlEntity.SaveChanges();

    plcListener.Confirm();
}

public class PlcListener
{
    public void Start()
    {
        OPCServer opcServer = new OPCServer();
        opcServer.DataChanged += On_DataChanged;
    }

    public void Confirm()
    {
        //Code to set bit to false
    }

    public void On_DataChanged(bool bitVal.......)
    {
        if(bitVal)
        {
            BitChangedEventHandler handler = BitChanged;
            if (handler != null)
            {
               handler(bitVal);
            }
        }
    }

    public delegate void BitChangedEventHandler(bool bitValue);
    public event BitChangedEventHandler BitChanged;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T17:39:09.660

您没有提到您正在使用哪个 OpcServer 组件，但最可能的问题是 DataChange 在 COM 回调线程中进入您的应用程序，并且在处理回调时不允许您写回 COM。您只需记录传入的值并在您自己的处理程序线程中进行实际处理，然后在 PLC 中将该位设置回 false。

# mysql - 生成一个 5 位数字，但 MySQL 表列除外

> ID：15005686
> 
> 赞同：0
> 
> 时间：2013-02-21T15:14:33.150
> 
> 标签：mysql, exception, numbers

我有一个 MySQL 数据库，其中包含一个名为`images`. 在该表中，我有一个名为`file_name`. 该`file_name`列包含 5 行：

```
.---.-----------.
| # | file_name |
.---.-----------.
| 1 | 00000     |
| 2 | 00001     |
| 3 | 00002     |
| 4 | 00003     |
| 5 | 00004     |
.---------------. 
```

我的查询代码是：

```
<?php
require_once('config/config_db.php');
$SQLquery = "SELECT `file_name` FROM images";
$result = mysql_query($SQLquery);

while($row = mysql_fetch_array($result)){
    echo $row['file_name']."<br>"; // ?
}
?> 
```

我有以下 PHP 函数，它生成一个 5 位随机函数，但我的异常是在变量数组中手动​​引入的`$exception`（如下所示）。我的目标是从`file_name`列中获取所有行，并设置为`$exception`变量。我试图实现这 3 或 4 个小时，但没有成功。感谢您的时间。

PHP函数：

```
<?php
function getRandom($exception=array('00000', '00001', '00002', '00003', '00004')){ // ?
    $rand = str_pad(mt_rand(0,99999),5,0,STR_PAD_LEFT);
    if(in_array($rand,$exception))return getRandom($exception);
    return $rand;
}

echo getRandom().'<br>';
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T15:40:39.263

根据我之前的问题，这可能会在一个 SQL 语句中为您完成工作：-

```
SELECT aNumber
FROM (
SELECT LPAD(CONVERT(a.i+b.i*10+c.i*100+d.i*1000+e.i*10000,CHAR(5)),5,'0') AS aNumber
FROM integers a, integers b, integers c, integers d, integers e) Sub1
LEFT OUTER JOIN images b ON Sub1.aNumber = b.file_name
WHERE b.file_name IS NULL
ORDER BY RAND()
LIMIT 1 
```

使用一个名为 integers 的表，其中包含一个名为 i 的列和 10 行，其值为 0 到 9。

它使用*ORDER BY RAND()*有点慢，所以可能值得你优化一下。

# three.js - Three.js 鼠标悬停在 3D 元素上

> ID：15005687
> 
> 赞同：2
> 
> 时间：2013-02-21T15:14:37.013
> 
> 标签：three.js, mousehover

我的问题如下：即使鼠标不在立方体上方，鼠标悬停动作也适用于立方体，如果它位于场景之外的立方体上方或下方的 Y 轴上，它也可以工作。有人可以解释一下为什么以及如何解决它吗？

```
 <!DOCTYPE html>
    <html lang="fr" xml:lang="fr" xmlns="http://www.w3.org/1999/xhtml">
    <head>

     <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js" type="text/javascript"></script>        

    <script src="lib/Three.js" type="text/javascript"></script>

    <script src="lib/Detector.js"></script>
    <script src="lib/stats.min.js" type="text/javascript"></script>
    <script src="lib/THREEx/THREEx.WindowResize.js"></script>
    <script src="lib/THREEx/THREEx.FUllScreen.js"></script>
    <script src="lib/TrackballControls.js"></script>

      <style type="text/css">
      body
    {
        color: #ffffff;
        text-align:center;
        background-color:  gray;
        margin: 0px;
    }
    #center
    {
        color: #fff;
        position: absolute;
        top: 50px; width: 100%;
        padding: 5px;
        z-index:100;
    }

    #center h1
    {

        font-size:60px;
    }

    #container
    {
        position:absolute;
        bottom:0;
    }

      </style>

    </head>

    <body>

    <br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/>
    <div id="container"></div>

     </body>

     <script>
    // MAIN

    console.log("Main.js");
    if ( ! Detector.webgl ) Detector.addGetWebGLMessage();

    // global variables

    var container, scene, camera, renderer, stats, controls;

    // custom variables 

    var t = THREE;
    var cube;

    // to keep track of the mouse position
    var projector, INTERSECTED, mouse = { x: 0, y: 0 },

    // an array to store our particles in
    particles = [];

    init();
    animate();

    function init()
    {

        // scene
        scene = new THREE.Scene();

        // camera
        var SCREEN_WIDTH = window.innerWidth, SCREEN_HEIGHT = window.innerHeight;
        var VIEW_ANGLE = 45, ASPECT = SCREEN_WIDTH / SCREEN_HEIGHT, NEAR = 0.1, FAR = 20000;
        camera = new THREE.PerspectiveCamera( VIEW_ANGLE, ASPECT, NEAR, FAR);
        scene.add(camera);
        camera.position.set(0,0,800);
        camera.lookAt(scene.position);

        // renderer
        renderer = new THREE.CanvasRenderer();
        renderer.setSize( window.innerWidth, window.innerHeight );

        // container
        container = document.getElementById('container');
        container.appendChild( renderer.domElement );

        // stats
        stats = new Stats();
        stats.domElement.style.position = 'absolute';
        stats.domElement.style.bottom = '0px';
        stats.domElement.style.zIndex = 100;
        container.appendChild( stats.domElement );

        // events 
        THREEx.WindowResize(renderer, camera);
        THREEx.FullScreen.bindKey({ charCode : 'm'.charCodeAt(0) });

        // initialize object to perform world/screen calculations
        projector = new THREE.Projector();

        // CUSTOM

        // Cubes

        x = window.innerWidth / 5;
        y =  window.innerHeight / 10;
        console.log(window.innerWidth);
        console.log(window.innerHeight);
        var geometry = new t.CubeGeometry(125,125,125);
        var material = new t.MeshBasicMaterial({color:0xCCCCCC});
        cube = new t.Mesh(geometry, material);
        cube.name = "cube";

        scene.add(cube);
        cube.position.set(-x,-y,0);

        x = window.innerWidth;
        y =  window.innerHeight / 10;

        var geometry2 = new t.CubeGeometry(125,125,125);
        var material2 = new t.MeshBasicMaterial({color:0xCCCCCC});
        cube2 = new t.Mesh(geometry2, material2);
        scene.add(cube2);

        cube2.name = "cube2";
        cube2.position.set(0,-y,0);

        x = window.innerWidth / 5;
        y =  window.innerHeight / 10;

        var geometry3 = new t.CubeGeometry(125,125,125);
        var material3 = new t.MeshBasicMaterial({color:0xCCCCCC});
        cube3 = new t.Mesh(geometry3, material3);
        cube3.name = "cube3";

        scene.add(cube3);
        cube3.position.set(x,-y,0);

        // particles

        makeParticles(); 

    // Mouse events
    document.addEventListener( 'mousemove', onMouseMove, false ); 
    document.addEventListener( 'mousedown', onMouseDown, false ); 

    }

    // called when the mouse moves
    function onMouseMove( event ) 
    {
    // store the mouseX and mouseY position 
    mouse.x = ( event.clientX / window.innerWidth ) * 2 - 1;
    mouse.y = - ( event.clientY / window.innerHeight ) * 2 + 1;
    }

    function onMouseDown( event ) 
    {
        event.preventDefault();

        var vector = new THREE.Vector3( mouse.x, mouse.y, 1 );
        projector.unprojectVector( vector, camera );
        var ray = new THREE.Ray( camera.position, vector.subSelf( camera.position ).normalize() );

        var intersects = ray.intersectObjects( scene.children );

        if ( intersects.length > 0 )
        {
            console.log(INTERSECTED.name);
            if(INTERSECTED.name == "cube")
            {
                page("real");
            }
        }
    }

    function animate() 
    {
        cube.rotation.y +=0.005;
        cube.rotation.x -=0.005;
        cube2.rotation.y +=0.005;
        cube2.rotation.x -=0.005;
        cube3.rotation.y +=0.005;
        cube3.rotation.x -=0.005;
        //textMesh.rotation.y +=0.005;

        requestAnimationFrame( animate );
        render();   
        update();   
    }

                    // creates a random field of Particle objects

    function makeParticles() 
    { 

    var particle, material; 

        // we're gonna move from z position -1000 (far away) 
        // to 1000 (where the camera is) and add a random particle at every pos. 
        for ( var zpos= -1000; zpos < 1000; zpos+=20 ) 
        {

        // we make a particle material and pass through the 
        // colour and custom particle render function we defined. 
        material = new THREE.ParticleCanvasMaterial( {  program: particleRender } );
        // make the particle
        particle = new THREE.Particle(material);

        // give it a random x and y position between -500 and 500
        particle.position.x = Math.random() * 1000 - 500;
        particle.position.y = Math.random() * 1000 - 500;

        // set its z position
        particle.position.z = zpos;

        // scale it up a bit
        particle.scale.x = particle.scale.y = 10;

        // add it to the scene
        scene.add( particle );

        // and to the array of particles. 
        particles.push(particle); 
        }
    }

    // there isn't a built in circle particle renderer 
    // so we have to define our own. 

    function particleRender( context ) 
    {

    // we get passed a reference to the canvas context
    context.beginPath();
    // and we just have to draw our shape at 0,0 - in this
    // case an arc from 0 to 2Pi radians or 360º - a full circle!
    context.arc( 0, 0, 0.2, 2,  Math.PI * 4, true );
    context.fillStyle = "white";
    context.fill();
    };

        // moves all the particles dependent on mouse position

    function updateParticles() 
    { 

        // iterate through every particle
        for(var i=0; i<particles.length; i++) 
        {

        particle = particles[i]; 

        // and move it forward dependent on the mouseY position. 
        particle.position.z +=  250 * 0.02;

        // if the particle is too close move it to the back
        if(particle.position.z>1000) particle.position.z-=2000; 

        }

    }

    function render()
    {
    renderer.render( scene, camera );
    }

    function update()
    {
    updateParticles();
    stats.update();

        // find intersections

        // create a Ray with origin at the mouse position
        //   and direction into the scene (camera direction)
        var vector = new THREE.Vector3( mouse.x, mouse.y, 1 );
        projector.unprojectVector( vector, camera );
        var ray = new THREE.Ray( camera.position, vector.subSelf( camera.position ).normalize() );

        // create an array containing all objects in the scene with which the ray intersects
        var intersects = ray.intersectObjects( scene.children );

        // INTERSECTED = the object in the scene currently closest to the camera 
        //      and intersected by the Ray projected from the mouse position    

        // if there is one (or more) intersections
        if ( intersects.length > 0 )
        {
            // if the closest object intersected is not the currently stored intersection object
            if ( intersects[ 0 ].object != INTERSECTED) 
            {
                // restore previous intersection object (if it exists) to its original scale
                if ( INTERSECTED )  
                {
                    INTERSECTED.scale.x = INTERSECTED.currentscale.x;
                    INTERSECTED.scale.y = INTERSECTED.currentscale.y;
                    INTERSECTED.scale.z = INTERSECTED.currentscale.z;
                }
                // store reference to closest object as current intersection object
                INTERSECTED = intersects[ 0 ].object;
                // store scale of closest object (for later restoration)
                scalex = INTERSECTED.scale.x;
                scaley = INTERSECTED.scale.y;
                scalez = INTERSECTED.scale.z;

                INTERSECTED.currentscale = { x : scalex , y : scaley, z : scalez };
                // set a new scale for closest object
                INTERSECTED.scale.x = INTERSECTED.scale.y = INTERSECTED.scale.z = 1.5;

            }
        } 

        else // there are no intersections
        {
            // restore previous intersection object (if it exists) to its original scale
            if ( INTERSECTED ) 
            {
                INTERSECTED.scale.x = INTERSECTED.currentscale.x;
                INTERSECTED.scale.y = INTERSECTED.currentscale.y;
                INTERSECTED.scale.z = INTERSECTED.currentscale.z;
            }

            // remove previous intersection object reference
            //     by setting current intersection object to "nothing"
            INTERSECTED = null;
        }

    }

    // Pour charger une page dynamiquement
        function page(page){
        $("body").animate({opacity:0},1000, function(){
        $("body").empty();
        $("body").load(page +'.html');
        $("body").animate({opacity:1},1000, function(){

                });
            });
    }

     </script>

    </html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T15:35:05.787

窗口左上角和画布左上角之间是否有偏移？如果是这样，您必须计算偏移量（顶部和左侧）并从 event.client 值中减去这些值。

尝试这个 ：

```
// now get the space between top left browser window corner
var absoluteOffsetLeft = 0;
var absoluteOffsetTop = 0;
var obj = <your HTML object containing the canvas>;

// taken from http://www.quirksmode.org/js/findpos.html
if (obj.offsetParent) {
    do {
        absoluteOffsetLeft += obj.offsetLeft;
        absoluteOffsetTop += obj.offsetTop;
    } while (obj = obj.offsetParent);
} else {
    console.log("Method offsetParent not supported");
}

// YOUR mouse move event handler - also take the innerWidth and Height from the canvas
function onMouseMove( event ) {
    // store the mouseX and mouseY position 
    mouse.x = ( (event.clientX - absoluteOffsetLeft) / canvas.innerWidth ) * 2 - 1;
    mouse.y = - ( (event.clientY - absoluteOffsetTop) / canvas.innerHeight ) * 2 + 1;
} 
```

# javascript - 为什么这段代码有 3 个八位字节超过 4 个字符？

> ID：15005688
> 
> 赞同：4
> 
> 时间：2013-02-21T15:14:36.577
> 
> 标签：javascript, base64

我试图理解[这个 JavaScript base64 解码代码](https://github.com/danguer/blog-examples/blob/master/js/base64-binary.js)，但我对[第 70-84 行](https://github.com/danguer/blog-examples/blob/master/js/base64-binary.js#L70)的这个循环感到困惑：

```
for (i=0; i<bytes; i+=3) {  
    //get the 3 octects in 4 ascii chars
    enc1 = this._keyStr.indexOf(input.charAt(j++));
    enc2 = this._keyStr.indexOf(input.charAt(j++));
    enc3 = this._keyStr.indexOf(input.charAt(j++));
    enc4 = this._keyStr.indexOf(input.charAt(j++));

    chr1 = (enc1 << 2) | (enc2 >> 4);
    chr2 = ((enc2 & 15) << 4) | (enc3 >> 2);
    chr3 = ((enc3 & 3) << 6) | enc4;

    uarray[i] = chr1;           
    if (enc3 != 64) uarray[i+1] = chr2;
    if (enc4 != 64) uarray[i+2] = chr3;
} 
```

具体来说，我想知道为什么 4 个 ascii 字符中只有 3 个八位字节。不应该有4个八位字节吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-21T15:17:28.587

因为 3 个八位字节需要 24 位存储。在 base 64 中，每个字符（ascii 字符）有 6 位。4 个字符 * 6 位 = 24 位，因此 24 位需要 4 个 base64 字符。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-21T15:17:07.373

注释指的是 Base64 算法本身。由于您将二进制字符串编码为 7 位 US-ASCII，因此字符串必须增长，这就是确切的比率：3 个源字节变成 4 个目标字符。

# javascript - scriptmanager 和 rokbox 冲突

> ID：15005695
> 
> 赞同：1
> 
> 时间：2013-02-21T15:14:56.500
> 
> 标签：javascript, jquery, asp.net, scriptmanager

我正在尝试使用 RokBox 在页面上显示图像，但 asp: scriptmanager 阻止它工作。

当我注释掉代码时：

```
<asp:ScriptManager ID="ScriptManager1" runat="server" EnablePageMethods="true">
    <Scripts>
        <asp:ScriptReference Path="~/Scripts/jquery-1.9.0.min.js" />
    </Scripts>
</asp:ScriptManager> 
```

RokBox 脚本运行。Rokbox 代码是：

```
<script type="text/javascript" src="rokbox/mootools-release-1.11.js"></script> 
<script type="text/javascript" src="rokbox/rokbox.js"></script> 
<script type="text/javascript" src="rokbox/rokbox-mt1.2.js"></script> 
<link href="rokbox/themes/dark/rokbox-style.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="rokbox/themes/dark/rokbox-config.js"></script>
<script type="text/javascript" src="mainjscript.js"> </script> 
```

有什么建议吗？这些是我真的不熟悉的东西。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T15:26:51.423

这是因为您正在尝试同时使用 mootools 和 jquery，您需要运行 jquery 并`jQuery.noConflict();`查看这些页面以获取更多信息：

[jQuery 和 MooTools 冲突](https://stackoverflow.com/questions/2810399/jquery-and-mootools-conflict)

[http://docs.jquery.com/Using_jQuery_with_Other_Libraries](http://docs.jquery.com/Using_jQuery_with_Other_Libraries)

# reporting-services - RDLC 分页问题

> ID：15005696
> 
> 赞同：0
> 
> 时间：2013-02-21T15:14:58.230
> 
> 标签：reporting-services, rdlc, ssrs-tablix

我对很长的报告有疑问。它在打印布局中大约有 60 页，但在正常布局中它只显示 1 页中的 1 页。正常布局的报告滚动速度很慢，我认为它将所有 60 页合二为一，他不能足够快地绘制它。
任何建议如何在正常布局中拆分多个页面而不更改打印布局？（我没有任何可用于分页符的分组，并且行数/页数也不固定）

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T15:14:18.440

好的，我终于找到了。在 tablix 属性上（右键单击任何行> Tablix 属性），我必须取消选中“如果可能，请在一个页面上保持在一起”。

# plone - 用另一种语言克隆对象并修改字段

> ID：15005698
> 
> 赞同：1
> 
> 时间：2013-02-21T15:15:01.597
> 
> 标签：plone

使用 LinguaPlone，我们可以将单个对象翻译成另一种语言。通常我们会获得一个相同对象类型的新实例，其中所有字段都是空白的。我们必须填写（空白）字段，然后全部保存。翻译目录已提交并升级。

我写了两个新的 AT 内容类型。对象的几乎所有字段都必须未翻译成各种语言（我们还有两个图像字段和文件字段）。

那么，是否有一种方法（或插件）可以克隆一个对象，因为它只动态更改语言字段和翻译目录？

（Plone 4.2，linguaplone 的最新版本）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-21T15:16:54.920

这就是`languageIndependent=True`您的架构中标志的用途。使用它来标记不需要翻译的任何字段，*并将*为您复制它。

通过设置标志，您可以在规范副本中将字段标记为仅可编辑，每当您修改此类字段时，所有翻译都会自动更新。

# xtext - 没有eclipse就不能运行xtext（作为jar）

> ID：15005701
> 
> 赞同：2
> 
> 时间：2013-02-21T15:15:09.767
> 
> 标签：xtext

我正在尝试在没有 Eclipse 的情况下使用 Xtext，如本文所述：http: [//zarnekow.blogspot.de/2010/06/how-to-deploy-xtext-standalone.html](http://zarnekow.blogspot.de/2010/06/how-to-deploy-xtext-standalone.html)。不幸的是，我无法运行创建的 .jar 文件。

我创建了一个运行配置。它使用 Wrapper 类作为其 Main 类，该类调用 Mwe2Launcher.main 方法。（使用 Mwe2Launcher 作为主要课程对我不起作用）。到目前为止，这以及将项目导出到可运行的 jar 文件都运行良好。但是，现在我无法运行 jar 文件。我用

```
java -jar exported.jar org.example.mydsl.GenerateMydsl 
```

org.example.mydsl.GenerateMydsl.mwe2 是我在 Eclipse 中运行 Xtext 时通常作为 MWE2 Workflow 运行的工作流文件（成功，顺便说一句）。但我在输出中收到以下错误：

```
7098 ERROR Generator          - java.io.FileNotFoundException: ..\org.example.mydsl\META-INF\MANIFEST.MF (The system cannot find the path)
org.eclipse.emf.common.util.WrappedException: java.io.FileNotFoundException: ..\org.example.mydsl\META-INF\MANIFEST.MF (The system cannot find the path)
        at org.eclipse.xtext.generator.Generator.mergeManifest(Generator.java:418)
        at org.eclipse.xtext.generator.Generator.generateManifestRt(Generator.java:385)
        at org.eclipse.xtext.generator.Generator.invokeInternal(Generator.java:137)
        at org.eclipse.emf.mwe.core.lib.AbstractWorkflowComponent.invoke(AbstractWorkflowComponent.java:126)
        at org.eclipse.emf.mwe.core.lib.Mwe2Bridge.invoke(Mwe2Bridge.java:34)
        at org.eclipse.emf.mwe.core.lib.AbstractWorkflowComponent.invoke(AbstractWorkflowComponent.java:201)
        at org.eclipse.emf.mwe2.runtime.workflow.AbstractCompositeWorkflowComponent.invoke(AbstractCompositeWorkflowComponent.java:35)
        at org.eclipse.emf.mwe2.runtime.workflow.Workflow.run(Workflow.java:19)
        at org.eclipse.emf.mwe2.launch.runtime.Mwe2Runner.run(Mwe2Runner.java:102)
        at org.eclipse.emf.mwe2.launch.runtime.Mwe2Runner.run(Mwe2Runner.java:79)
        at org.eclipse.emf.mwe2.launch.runtime.Mwe2Runner.run(Mwe2Runner.java:71)
        at org.eclipse.emf.mwe2.launch.runtime.Mwe2Launcher.run(Mwe2Launcher.java:76)
        at org.eclipse.emf.mwe2.launch.runtime.Mwe2Launcher.main(Mwe2Launcher.java:35)
        at org.example.domainmodel.Wrapper.main(Wrapper.java:11)
Caused by: java.io.FileNotFoundException: ..\org.example.mydsl\META-INF\MANIFEST.MF (The system cannot find the path)
        at java.io.FileInputStream.open(Native Method)
        at java.io.FileInputStream.<init>(Unknown Source)
        at org.eclipse.xtext.generator.Generator.mergeManifest(Generator.java:404)
        ... 13 more
7098 INFO  Workflow           - Done. 
```

它正在\org.example.mydsl\META-INF\MANIFEST.MF 中寻找清单文件。但是，在 jar 中，META-INF 文件夹直接位于根目录中。

有没有人知道我可能做错了什么或者我可以尝试什么？将不胜感激。

# data-distribution-service - 单个 DDS 域中可以创建的最大 DDS 主题数

> ID：15005702
> 
> 赞同：3
> 
> 时间：2013-02-21T15:15:09.790
> 
> 标签：data-distribution-service

在 DDS 中可以为特定域创建的主题数量是否有限制？这是否依赖于实现？

RTI Connext DDS 5.0.0 的最大值是多少？我没有在文档中看到它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-11T14:38:32.827

您回忆的 240 的“神奇”限制很可能是可以在同一域 ID 上的单台计算机上运行的 DomainParticipants 的最大数量，即 120。或者它是 DDS 域 ID 的最大数量，即 233 .见[http://community.rti.com/kb/what-maximum-number-participants-domain](http://community.rti.com/kb/what-maximum-number-participants-domain)

正如 Reinier 所提到的，端点的数量没有内在的限制。

杰拉尔多

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-21T16:26:51.193

With Connext, the limiting factor is not so much the number of Topics, but more the number of DataReaders and DataWriters created in a particular Domain. Of course, each DataReader and DataWriter is associated with exactly one Topic, so indirectly there is a dependency on the number of Topics.

With regard to the maximum number of DataReader and DataWriters in a Domain (often collectively indicated by Endpoints), the practical limitations depend on the resources in your system. Memory consumption due to administration of the topology of your DDS system will increase with the number of Endpoints. There is no hard or hard-coded limit on the number of Endpoints though.

If you have any particular scale in mind, I could indicate where you are in comparison to other users of the product.

This answer is indeed implementation dependent. My remarks apply to RTI Connext DDS and are not necessarily true for other DDS implementations.

# javascript - Javascript DOMContentLoaded 有一个神秘的 5-10 秒延迟

> ID：15005703
> 
> 赞同：1
> 
> 时间：2013-02-21T15:15:10.337
> 
> 标签：javascript, jquery, dom, twitter-bootstrap, domcontentloaded

我真的很困惑。我在使用 Bootstrap 的轮播的测试站点上有一个相当动态的页面（但我希望这是我的代码，而不是他们的，这是错误的）。

测试页面可以在这里找到：http: [//bit.ly/ZjLl19](http://bit.ly/ZjLl19)

你会注意到如下...

*   页面开始加载
*   员工画像开始出现
*   然后......**大约 5-10 秒内没有任何反应**
*   5-10 秒后，会出现一个带有员工传记和较大肖像的轮播

为什么会有这种延迟？我查看了 Webkit 调试器，我可以在`DOMContentLoaded`运行时看到时间线中的空闲时间，然后再发生其他任何事情。有任何想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T15:46:48.497

***注意事项：***

1）您在初始化时暂停了轮播。这可以解释最初的停顿。轮播自动继续下一张幻灯片，显示默认延迟后的后续幻灯片，[显然是 5000ms](http://twitter.github.com/bootstrap/javascript.html#carousel)。

```
$('.carousel.paused-by-default').carousel('pause'); 
```

2）暂停的轮播，在初始暂停后，使用以下代码显示自己：

```
info = setTimeout(function(){reveal_content();}, 500); 
```

3) **[更新 - 忽略前两个观察结果]**

轮播似乎是从幻灯片**-1**开始的。由于没有幻灯片**-1**，旋转木马的高度保持在`0px`。轮播的高度仅`560px`在第一张幻灯片完成动画后更新。这就是为什么第一张幻灯片没有动画，而且在默认的幻灯片延迟 5000 之后，它似乎突然*冒出*来，加上大约一秒的额外动画速度（如第 1 点所述）。要解决此问题，请使用以下两种解决方案。

=====================================

***可能帮助您解决问题的方法：***

1）在函数的右括号之前添加这个`$(document).ready()`，立即显示第一张幻灯片：

```
$('.carousel').carousel(0); 
```

2）如果上一点没有完全解决问题，将`#mtt-carousel`和的高度设置`.carousel-inner`为560px，在#1中之前的JS语句之前添加这个。

```
$('#mtt-carousel, .carousel-inner').css('height', '560px'); 
```

或 CSS：

```
#mtt-carousel, .carousel-inner { height: 560px !important; } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T15:14:45.197

这实际上是一个简单的修复。只需将活动类应用于第一个元素以显示它（或者您想要首先显示的任何一个）。否则，您将等到 dom 已加载并且轮播已初始化为您执行此操作。

所以下面的这个可以解决问题并立即显示轮播，而无需等待 JS：

```
<div class="carousel-inner">
    <div class="item mtt-item active">...</div>
    <div class="item mtt-item">...</div>
</div> 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-22T08:38:12.577

我建议您执行以下操作：

1.  减小图像的大小。

2.  将您的 css 文件合并为一个 .

3.  合并js文件。

4.  Gzip css 和 js 文件。压缩将大大缩短加载时间。

5.  缩小 css 和 js ，删除这些文件中不需要的空间将减小它们的大小。

6.  您可以通过指定资源的到期日期和年龄来利用浏览器缓存。

# file-upload - a4j:commandButton 通过 t:inputFileUpload 给出 NullPointerException

> ID：15005704
> 
> 赞同：2
> 
> 时间：2013-02-21T15:15:10.417
> 
> 标签：file-upload, jsf-2, ajax4jsf, tomahawk

为什么对于下面的代码，当我使用它时`t:commandButton`它工作正常并且万一`a4j:commandButton`它给出`NullPointerException`了`uploadedFile.getInputStream()`？

```
<h:form enctype="multipart/form-data">
    <t:inputFileUpload value="#{fileUploadController.uploadedFile}"/>
    <t:commandButton action="#{fileUploadController.insertFile}"/>      
</h:form> 
```

# jquery - 如何根据不同的ajax调用显示不同的预加载器gif？

> ID：15005705
> 
> 赞同：0
> 
> 时间：2013-02-21T15:15:13.140
> 
> 标签：jquery, css, ajax

我目前正在使用以下代码为我的 ajax 调用使用预加载器 gif：

```
$(document).ajaxStart(function () {
    var position = $('#parentDiv').position();
    position.left += (($('#parentDiv').width() / 2) - ($('#bigPreloader').width() / 2));
    position.top += (($('#parentDiv').height() / 2) - ($('#bigPreloader').height() / 2));
    $('#bigPreloader').css(position).show();
    $('#bigPreloader').show();
}).ajaxStop(function () {
    $('#bigPreloader').hide();
}); 
```

在上面的代码中，#parentDiv 占据了页面的大部分，并且预加载器是 250x250 像素并以 #parentDiv 为中心。

这很好用，但我刚刚添加了一些与特定输入相关联的额外 ajax 调用，而不是整个页面。我有一个小型预加载器（14x14 像素），我计划将其放入适当的输入本身。

ajaxStart 内部有没有办法确定进行了哪个 ajax 调用？或者有没有办法让多个 ajaxStarts 链接到特定元素？

**解决方案**

```
$(document).ajaxSend(function (event, jqxhr, settings) {
    if (settings.url.indexOf('LoadInputData') == -1) {
        var position = $('#parentDiv').position();
        position.left += (($('#parentDiv').width() / 2) - ($('#bigPreloader').width() / 2));
        position.top += (($('#parentDiv').height() / 2) - ($('#bigPreloader').height() / 2));
        $('#bigPreloader').css(position).show();
        $('#bigPreloader').show();
    } else {
        $('#inputLoad').removeClass('notActive').addClass('isActive');
    }
}).ajaxStop(function () {
    if ($('#bigPreloader').is(':visible')) {
        $('#bigPreloader').hide();
    } else {
        $('#inputLoad').removeClass('isActive').addClass('notActive');
    }
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T15:33:28.700

.ajaxStart() 只有在所有其他调用都完成后才会触发。如果没有正在进行的请求，它将触发 ajaxStart 中的代码。因此，如果您使用的是异步请求，则此方法不会有太大帮助，除非所有先前的请求都已完成运行。

为了解决您的问题，我建议改用[.ajaxSend()](http://api.jquery.com/ajaxSend/)方法。此方法每次都会触发，就在即将发出请求之前。所以它的作用与 .ajaxStart() 几乎相同。要区分请求，您可以使用传递给处理函数的参数。您可以测试几件事，但可能最简单的是只使用 URL，如下所示：

来自 jQuery 文档的示例：

```
$(document).ajaxSend(function(event, jqxhr, settings) {
    if ( settings.url == "ajax/test.html" ) { //Test by URL
        //Do your specific pre-loader stuff here
    }
}); 
```

您还可以在特定请求中设置上下文。这样做会将`$(this)`选择器设置为您指定的上下文，因此您也可以将逻辑与 DOM 分开。通过这种方式，您可以使用设置了加载器的单个函数，该函数会发布在您在上下文中设置的元素上。

```
$.ajax({
    url: "test.html",
    context: document.body
}).done(function() {
    $(this).addClass("done"); //$(this) is the document.body or could be the element you want to put your specific loader in.
}); 
```

# c++ - C++ Builder 2009 - 有没有办法确定无法访问的表单？

> ID：15005707
> 
> 赞同：0
> 
> 时间：2013-02-21T15:15:13.957
> 
> 标签：c++, refactoring

我正在使用 C++ Builder 2009。

我得到了一个旧项目，该项目已经与许多开发人员一起开发了多年。我注意到项目中的一些表单并没有真正实现，并且可能在某些时候用于 POC 工作。我希望清理项目，然后我将重构项目中的一些重复代码。

基于此，我的问题是，是否有一种简单的方法可以确定无法从初始表单中访问哪些表单？例如，我有一个入口点表单，程序中使用的所有表单都应该有一个路径表单。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T15:17:39.237

除非您基于类名进行运行时类型查找，否则很容易解决这个问题。如果您认为某个类未使用，请将其删除。如果您的所有代码都编译和链接，那么它没有被使用。如果你得到未解决的引用，那么它就被使用了。

# php - 如何使用 PHP 打开 IDM

> ID：15005711
> 
> 赞同：0
> 
> 时间：2013-02-21T15:15:42.113
> 
> 标签：php

我想在 PHP 中使用 exec() 函数打开 Internet 下载管理器，这是我的代码：

```
if(isset($_POST['link'])){
    exec('C:\Program Files (x86)\Internet Download Manager\IDMan.exe /d '.$_POST['link']);....... 
```

但是这个脚本没有任何反应。那么我的代码有问题吗？提前致谢 。

# ruby - has_many 有两个或多个表。

> ID：15005713
> 
> 赞同：0
> 
> 时间：2013-02-21T15:15:47.980
> 
> 标签：ruby, ruby-on-rails-3, hash

我正在尝试向我的模型添加多个 has_many 关系：

```
class Program < ActiveRecord::Base
  has_many :courses, :program_offers
  belongs_to :university
  attr_accessible :end_date, :name, :period, :start_date, :symbol, :year, :university_id, :description, :titles, :profile, :price
end 
```

但我得到：

`hash expected`错误。

我怎样才能引用两个有很多表？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-21T15:19:10.097

你不能这样做，因为它是关联方法，它只接受一个关联名称作为参数：

```
 has_many(name, options = {}, &extension) 
```

因此，在 中指定每个关联`single line`。

```
 has_many :courses
  has_many :program_offers 
```

如果您这样指定，则认为您正在指定某些条件或块。请参阅 API 文档[http://apidock.com/rails/ActiveRecord/Associations/ClassMethods/has_many](http://apidock.com/rails/ActiveRecord/Associations/ClassMethods/has_many)

# class - 类中的访问说明符

> ID：15005714
> 
> 赞同：0
> 
> 时间：2013-02-21T15:15:51.247
> 
> 标签：class, copy-constructor

我知道，通常，类的“对象”不能访问私有成员。但是在复制构造函数的函数定义中，您使用对象来访问私有成员成员。怎么来的？例如：-

```
class Sample {int i,j;
 public: 
 Sample(int a, int b)
 {i=a;j=b;}
 Sample(Sample &S)
 {j=s.j;i=s.i;}
 } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T15:17:38.150

这是同一个班级。不同的*实例*，但相同的类。

`private`意味着该成员仅在类中可见 - 包括其他实例。

# asp.net - 是否可以在网格外以编程方式调用网格的更新命令？

> ID：15005716
> 
> 赞同：0
> 
> 时间：2013-02-21T15:15:51.973
> 
> 标签：asp.net, gridview, webforms

我有一个带有编辑按钮的 GridView，该按钮打开记录以使用更新命令进行编辑。这与代码隐藏中的 RowEditing 事件相关联，并在单击时按预期工作。

但是，我正在破解我的 GridView 以支持插入。这涉及在将集合分配给数据源之前将空白实体添加到我的实体集合的开头，然后打开第一行进行编辑。它看起来像这样：

```
MyDataGrid.DataSource = New MyEntity() {New MyEntity()}.Union(MyDbEntities)
MyDataGrid.EditIndex = 0
MyDataGrid.DataBind() 
```

它可以工作并打开一个空白行，可以在其中添加全新的记录。但是，它不会触发 RowEditing 事件。我需要触发此事件，因为在将特定控件交付给客户端之前，会执行一些特殊代码来准备特定控件。我知道我可以创建一个接受 GridViewRow 对象作为参数的辅助方法，但我真的很想在特定行上调用网格的更新命令，以便一切自然流动。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T16:17:15.210

您是对 GridView 进行子类化，还是仅将其包装在大量额外代码中？

如果您是子类化，您应该可以访问`OnRowEditing`受保护的方法。如果你调用它，它将触发事件（假设事件处理程序附加到它。）

实际上，我会推荐子类化 - 它会产生更便携和可重用的东西，并且您将能够访问很多您无法访问的方法。

# javascript - javascript中的大数字

> ID：15005718
> 
> 赞同：0
> 
> 时间：2013-02-21T15:16:01.783
> 
> 标签：javascript, numbers, ecmascript-5

我正在用javascript开发一个计算器，用户可以在文本字段中输入值并执行操作。现在，如果用户输入一个非常大的值，例如 5345345345353453453453535，它将转换为 5.345345345353453e+24

我正在使用 parsrInt() 将其转换为整数。它给了我 5\. 这是错误的。任何人都可以建议如何解决它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-21T15:19:31.297

javascript 中的整数与每个数字一样，存储为[IEEE754](http://en.wikipedia.org/wiki/IEEE_754)双精度浮点数。

因此，您只能精确存储最大为 2^51（尾数大小）的整数。

这意味着您必须设计另一种格式来处理大整数，或者使用现有的库，如[BigInteger.js](https://github.com/peterolson/BigInteger.js)（Google 会建议其他一些）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-21T15:19:49.737

取自[Mozilla 文档](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/parseInt)：

> 解析字符串参数并返回指定基数或基数的整数。

因此`parseInt()`将您的值作为字符串`5.345345345353453e+24`

然后它忽略任何非整数值并将其归类为小数（5.345 ...），然后将其评估为`5`.

* * *

正如[@dystroy](https://stackoverflow.com/a/15005795/370103)所指出的，如果您希望使用这些大数字进行计算，您需要使用自定义格式，或者使用预先存在的 javascript 库。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-21T15:17:53.180

尝试使用 parseFloat 而不是 parseInt。

```
<script type="text/javascript">
    var value = parseFloat(5345345345353453453453535);
    alert(value);
</script> 
```

# java - 给定参数的枚举值

> ID：15005719
> 
> 赞同：1
> 
> 时间：2013-02-21T15:16:01.833
> 
> 标签：java, enums

是否有任何美学方法可以根据其他两种枚举类型检索枚举值？我想做的是获得两个枚举参数的状态，如下例所示：

```
public enum State{

ONE_STATE,
SECOND_STATE;
THIRD_STATE;

public static State getState(Direction dir, Type type) {
    if (dir.equals(Direction.LEFT) && type.equals(Type.BIG)) {
        return ONE_STATE;
    }
    else if (dir.equals(Direction.RIGHT) && type.equals(Type.SMALL)) {
        return SECOND_STATE;
    }
    else if (dir.equals(Direction.UP) && type.equals(Type.SMALL)) {
        return FIRST_STATE;
    }
    return THIRD_STATE;
}

} 
```

当然这会说话，但我的目的是让一些事情更清楚，因为这样的可能性会随着时间的推移而增加。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T15:26:34.113

使用嵌套的 EnummMap。“Effective Java”一书（Item 33）解释了为什么这是最好的解决方案。

```
// Using a nested EnumMap to associate data with enum pairs
public enum Phase {
    SOLID, LIQUID, GAS;
    public enum Transition {
        MELT(SOLID, LIQUID), FREEZE(LIQUID, SOLID),
        BOIL(LIQUID, GAS), CONDENSE(GAS, LIQUID),
        SUBLIME(SOLID, GAS), DEPOSIT(GAS, SOLID);
        final Phase src;
        final Phase dst;
        Transition(Phase src, Phase dst) {
            this.src = src;
            this.dst = dst;
        }
        // Initialize the phase transition map
        private static final Map<Phase, Map<Phase,Transition>> m =
                new EnumMap<Phase, Map<Phase,Transition>>(Phase.class);
        static {
            for (Phase p : Phase.values())
                m.put(p,new EnumMap<Phase,Transition>(Phase.class));
            for (Transition trans : Transition.values())
                m.get(trans.src).put(trans.dst, trans);
        }
        public static Transition from(Phase src, Phase dst) {
            return m.get(src).get(dst);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T15:25:15.953

您可以使用`switch`es 而不是`if`s 但这不会使代码更短。它将具有更清晰的优点，并且根据您的 IDE，您可以让它在`switch`缺少案例时给您错误。

让项目最多的枚举是外部的`switch`，其他的是内部的`switch`。

`State` `enum`仅当只有`Direction`and的一种组合`Type`“到达” that时，才能向您添加字段`State`。

```
switch(dir) {
  case LEFT:
  {
    switch(type) {
      case BIG:
      ... 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-21T15:19:20.267

为什么不使用查找表？行数组 - 每行包含 2 个输入和一个输出。

```
LEFT,  BIG,   ONE_STATE
RIGHT, SMALL, SECOND_STATE 
```

等，并提供一种方法来查找并在查找失败时返回默认值。

做不到这一点，你可以调查[双重调度](http://en.wikipedia.org/wiki/Double_dispatch)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-21T15:20:48.447

枚举可以有字段，您可以尝试以下操作：

```
public enum State {
    ONE_STATE(Direction.LEFT, Type.BIG),
    ...

    Direction d;
    Type t;

    private State(Direction d, Type t) {
        ...
    }

    public static State getState(Direction d, Type t) {
        for (State s : State.values()) {
            if (s.d == d && s.t == t) {
                return s;
            }
        }
        return null;
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-21T15:20:56.347

将 Direction 和 Type 作为枚举的成员怎么样，如下所示：

```
public enum State {

    ONE_STATE(Direction.LEFT, Type.BIG),
    SECOND_STATE(Direction.RIGHT, Type.SMALL);
    THIRD_STATE(Direction.UP, Type.SMALL);

    private Direction direction;
    private Type type;

    private State(Direction direction, Type type) {
        this.direction = direction;
        this.type = type;
    }

    public static State getState(Direction dir, Type type) {
        for (State state : values()) {
            if (state.direction == dir && state.type == type) {
                return state;
            }
        }
        return THIRD_STATE;
    }
} 
```

请注意，如果每个枚举有多个不同的组合，这将不起作用。在这种情况下，您将需要使用另一张海报所建议的某种查找表。例如，您可以使用`Map<Pair<Direction, Type>, State>`. （Java 没有`Pair<T, U>`类，但您可以轻松地创建一个类或在许多不同的库中找到一个。）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-21T18:18:28.660

`DIRECTION`您可以将和封装`TYPE`在一个具体的类中（比如`EnumGroup`）。并创建一个`Hashmap`包含 key 作为enum的对象`EnumGroup`和value 的值。通过这种方式，我们可以为和的多个组合保存值。我们也可以有两个不同的具有相同的值。这是代码演示。`value``State``state``DIRECTION``STATE``EnumGroup``state`

```
import java.util.ArrayList;
import java.util.Map;
import java.util.HashMap;
import java.util.List;
class EnumGroup 
{
    Direction direction;
    Type type;
    private EnumGroup(){}//To prevent parmeterless construction
    public EnumGroup(Direction direction , Type type)
    {
        if (direction==null || type == null)
        {
            throw new IllegalStateException("null is not allowed");
        }
        this.direction = direction;
        this.type = type;
    }
    @Override
    public int hashCode()
    {
        return direction.toString().hashCode() + type.toString().hashCode() ;
    }
    @Override
    public boolean equals(final Object other)
    {
        if (other == null || !(other instanceof EnumGroup))
        {
            return false;
        }
        if (this == other)
        {
            return true;
        }
        EnumGroup temp = (EnumGroup)other;
        if (temp.type == this.type && temp.direction == this.direction)
        {
            return true;
        }
        return false;
    }
}
enum Direction
{
    LEFT,RIGHT,DOWN,UP,ACCROSS;
}
enum Type
{
    BIG,SMALL,MEDIUM;
}
enum State
{
    ONE_STATE,FIRST_STATE,SECOND_STATE,THIRD_STATE;
    private static final Map<EnumGroup,State> map = new HashMap<EnumGroup,State>();
    static
    {
        map.put(new EnumGroup(Direction.LEFT,Type.BIG),ONE_STATE);
        map.put(new EnumGroup(Direction.RIGHT,Type.SMALL),SECOND_STATE);
        map.put(new EnumGroup(Direction.UP,Type.SMALL),FIRST_STATE);
        /*
        .
        .
        .
        */
    }
    public static State getState(EnumGroup eGroup) 
    {
        State state = map.get(eGroup);
        return state == null ? THIRD_STATE : state;
    }
}
public class EnumValueByArgument
{
    public static void main(String st[])
    {
        ArrayList<EnumGroup> list = new ArrayList<EnumGroup>();
        for (Direction direction : Direction.values())
        {
            for (Type type : Type.values() )
            {
                list.add(new EnumGroup(direction,type));
            }
        }
        for (EnumGroup eGroup : list )
        {
            System.out.println(State.getState(eGroup));
        }
    }
} 
```

# vba - 使用 VBA 从 Excel 激活 Word 窗口

> ID：15005723
> 
> 赞同：4
> 
> 时间：2013-02-21T15:16:06.730
> 
> 标签：vba, excel, ms-word

我正在尝试从 Excel 访问 MS Word 的窗口。我找到了访问新 Word 文档或特定文档的方法，例如 [Copy Text from Range in Excel into Word Document](https://stackoverflow.com/questions/2006077/copy-text-from-range-in-excel-into-word-document)中的方法，

但就我而言，我不知道文件的名称，它应该是最后一个活动的。我希望使用类似的东西

```
Word.ActiveDocument 
```

但没有成功。我还尝试模拟 Alt+Tab 击键来激活窗口

```
Application.SendKeys("%{TAB}") 
```

但它也不起作用。有什么提示吗？

我正在尝试创建一个宏，它只会将图表和一些文本复制到 Word 中，并对文本进行一些格式化。所以基本上我可以使用任何方法来完成这项任务。非常感谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-21T20:29:12.690

您可以使用后期绑定 ( [http://support.microsoft.com/kb/245115](http://support.microsoft.com/kb/245115) ) 和`GetObject`. 如果您打开了多个 Word 实例，则不能保证您会获得其中的任何一个。

获取 Word 实例将允许您访问`ActiveDocument`应用程序的当前`Selection`. 我仍然建议做一些错误检查，以确保你得到了你想要的。

```
 Sub GetWordDocument()
        Dim wdApp As Object

        'Turn off error handling since if the Application is not found we'll get an error
        'Use Late Binding and the GetObject method to find any open instances of Word
        On Error Resume Next
        Set wdApp = GetObject(, "Word.Application")
        On Error GoTo 0

        'Check to see if we found an instance.  If not you can create one if you desire
        If wdApp Is Nothing Then
            MsgBox "No instances of Word found"
            Exit Sub
        End If

        'Check if there are documents in the found instance of Word
        If wdApp.Documents.Count > 0 Then
            wdApp.Selection.TypeText "Cool, we got it" & vbCr

            'You can now access any of the active document properties too
            wdApp.ActiveDocument.Range.InsertAfter "We did indeed"
        End If

        'Clean up the Object when Finished
        Set wdApp = Nothing
    End Sub 
```

# apache - Apache 2.2 SSL 配置..https 响应为空白主页

> ID：15005725
> 
> 赞同：1
> 
> 时间：2013-02-21T15:16:09.423
> 
> 标签：apache, ssl, configuration

我正在尝试为我们的一个网站实施 SSL。网站使用 Apache 2.2 作为 Web 服务器，然后通过 AJP 协议与 Tomcat 7 对话。

我从 Verisign 购买了证书。我也能够在 apache Web 服务器服务器上安装相同的东西。告诉你我已经完成了哪些配置

httpd.conf

```
Listen 82
LoadModule ssl_module libexec/mod_ssl.so
Include etc/extra/httpd-ssl.conf
Include etc/extra/httpd-vhosts.conf 
```

httpd-ssl.conf

```
Listen 443
<VirtualHost _default_:443>
ServerName test.domain.com:443
ServerAdmin root@test.domain.com
SSLEngine on
SSLCertificateFile /opt/csw/ssl/test.crt
SSLCertificateKeyFile /opt/csw/ssl/test.key
SSLCertificateChainFile /opt/csw/ssl/test.crt
<Virtual Host> 
```

httpd-vhosts.conf

```
NameVirtualHost *:82
NameVirtualHost *:443
Include etc/vhosts/test.conf 
```

测试.conf

```
<VirtualHost *:82 *:443>
    ServerName test.domain.com
    RewriteEngine On
    RewriteRule ^/(test/registration.cfm) /test/$1 [P,L]
    RewriteRule ^/(index.cfm) / [P] 
    ProxyRequests Off
<Proxy balancer://testBal>
BalancerMember ajp://<tomcat_server>:8009/test
BalancerMember ajp://<tomcat_server2>:8009/test status=+h
</Proxy>
ProxyPass /test/admin/ !
    ProxyPass /test/ balancer://testBal/
    ProxyPass / balancer://testBal/
</VirtualHost> 
```

好的。现在的问题是，每当我点击 url [https://test.domain.com](https://test.domain.com)时，我都会得到空白页。但是我看到该网站被认为是经过认证的，我也可以查看证书。我在 apache 访问日志中看到的内容 - “GET /favicon.ico HTTP/1.1”404 209”和错误日志中 - “文件不存在：/opt/csw/apache2/share/htdocs/favicon.ico”。Tomcat 服务器正在8080端口上运行。过去几天我一直在为这个问题而苦苦挣扎，但无济于事。感谢您的建议和帮助！谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-22T03:55:57.400

好的。所以我想我已经解决了这个问题。进行了以下更改..

http-ssl.conf

```
Listen 443
<VirtualHost *:443>
#ServerName test.domain.com:443
ServerAdmin root@test.domain.com
SSLEngine on
SSLCertificateFile /opt/csw/ssl/test.crt
SSLCertificateKeyFile /opt/csw/ssl/test.key
SSLCertificateChainFile /opt/csw/ssl/test.crt
<Virtual Host> 
```

不知何故，我发现服务器名称是在 test.conf 中定义的，所以只是在 http-ssl.conf 中进行了评论，它就像一个魅力。该网站也监听 http 和 https 协议..强制使用 https 协议..可以进行以下更改..我无法对此进行测试，但我认为它应该可以工作..如果有人有这个要求..对我来说没必要。。

测试.conf

```
 <VirtualHost *:82 *:443>
 ServerName test.domain.com
 RewriteEngine On
 RewriteCond %{HTTPS} off
 RewriteRule (.*) https://%{HTTP_HOST}%{REQUEST_URI}
 RewriteRule ^/(test/registration.cfm) /test/$1 [P,L]
 RewriteRule ^/(index.cfm) / [P] 
 ProxyRequests Off
 <Proxy balancer://testBal>
 BalancerMember ajp://<tomcat_server>:8009/test
 BalancerMember ajp://<tomcat_server2>:8009/test status=+h
 </Proxy>
 ProxyPass /test/admin/ !
 ProxyPass /test/ balancer://testBal/
 ProxyPass / balancer://testBal/
 </VirtualHost> 
```

谢谢！

# joomla - Kunema 论坛的顶部菜单别名项单击时未激活

> ID：15005726
> 
> 赞同：0
> 
> 时间：2013-02-21T15:16:12.420
> 
> 标签：joomla, menu, alias

我刚刚安装了 Joomla 2.5.9 版和 Kunema 论坛组件 2.0.4 版。我还没有安装任何其他组件/模块/插件。

我创建了一个名为“Forum Sports”的新顶部菜单项作为“菜单别名项”，并将其指向 Kunema 菜单的“论坛”项（请参见下图）。

![在此处输入图像描述](../Images/df2b24a3dd73e708c53b3ecc4e55c9dd.png)

但是，在站点中，当我单击“论坛体育”顶部菜单项时，它不会激活如果我将此菜单项指向任何其他菜单/文章/页面，菜单项就会激活（请参见下图） .

![在此处输入图像描述](../Images/ff2e6cc87c5d6b02891bdf196d5cc6eb.png)

![在此处输入图像描述](../Images/6aa10c138b9b5ea8ebf40584540e597f.png)

指向 Kunema 菜单的论坛项目时，如何使顶部菜单项目“论坛体育”处于活动状态？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T16:57:47.383

原因是 Joomla 为菜单项分配了两个不同的类。如果您在菜单项页面上，它将分配一个`.active`和`.current`css 类。大多数模板（包括 Joomla 的）菜单项然后基于`.current`类的样式。要使菜单显示为活动状态，只需在模板 css 文件中为 .current 类添加一些额外的 css :)

# jquery - 将图像添加到固定大小的容器而不更改尺寸

> ID：15005728
> 
> 赞同：0
> 
> 时间：2013-02-21T15:16:13.403
> 
> 标签：jquery, html, css

我有一个固定容器（200x200px），我希望在其中加载我的图像。每个图像都有不同的大小，目前我必须将图像大小调整为容器宽度，或者图像失去比例。

如何将图像（不是背景图像）添加到容器并显示图像而不改变其可能在中心的比例（因此，如果图像是 800x600），它将显示同一图像的中心中间 200x200？我不介意使用 PHP 或 jQuery 或一些 CSS 魔法来完成这项工作。

我真的不知道如何开始，所以我希望有人可以协助程序或垫脚石如何做到这一点？

****编辑 ******

 **我可能没有正确解释。所有图像都大于分配给它的 200x200 区域，调整大小的问题是，一旦用户单击图像，它需要在灯箱中加载相同的图像，关键区别在于它加载相同的图像。因此，我想在不影响图像比例的情况下强制使用“缩略图”视图。由于有些图像是水平的，有些是垂直的，我想我宁愿以 200x200 显示图像的“中心”或任何角落，并让用户单击图像以查看完整图片。我正在寻找的是一种几乎使图像“行为”的方式与背景图像相同，但不是背景图像？这有意义吗？有什么可以提供帮助的吗？

** 示例图像 ** 这是一个示例图像来说明我的想法：[http ://tinypic.com/view.php?pic=21caxc1&s=6](http://tinypic.com/view.php?pic=21caxc1&s=6)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T15:19:09.533

您应该从页面速度的角度调整图像大小。用户下载 800x600 的图像并通过浏览器将其缩小到 200 像素宽是一种浪费。

无论哪种方式，有几种方法可以做到这一点。首先，您可以将`width`属性添加到您的`img`.

或者，看看使用 CSS：`.img{ max-width: 200px;`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T15:20:25.790

您可以检查图像的宽度，如果宽度大于高度，则减小图像的宽度，而不是从高度减小以填充容器，如下所示：

```
list($width, $height) = getimagesize("image_name.jpg");
if ($width>$height){
   echo'<img src="image_name.jpg" style="width:200px;" alt=""/>';
}
else{
   echo'<img src="image_name.jpg" style="height:200px;" alt=""/>';
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-21T15:23:28.693

或者尝试基于 css 的解决方案。为您的图像提供类属性，例如`.resizedimg{width:90%}`. 这 90% 是相对于容器宽度而不是原始图像宽度。

如果它不能帮助从 jquery 制作它。这是一个使工作变得非常好的工具：http: [//imgscale.kjmeath.com/](http://imgscale.kjmeath.com/)**

# php - 动态设置导航的活动状态

> ID：15005731
> 
> 赞同：5
> 
> 时间：2013-02-21T15:16:22.300
> 
> 标签：php, javascript, jquery, css, wordpress

我似乎经常遇到这个问题，永远找不到解决方案。我有一个带有顶部导航的 Wordpress 网站。由于这是在我的 header.php 中，并在所有页面上使用，因此我无法对每个页面的活动菜单状态进行硬编码。

如何动态设置激活状态以适用于每个页面？

这是我当前的导航代码：

```
<nav id="main-menu" class="padbot">
<ul id="ce">
    <li class="cemenu"><a href="<?php echo $base_url;?>/about">About</a></li>
    <li class="cemenu"><a href="<?php echo $base_url;?>/consulting">Consulting</a></li>
    <li class="cemenu"><a href="<?php echo $base_url;?>/intelligence">Intelligence</a></li>
    <li class="cemenu"><a href="<?php echo $base_url;?>/academy">Academy</a></li>        
    <li class="cemenu"><a href="<?php echo $base_url;?>/blog">Blog</a></li>
    <li class="cemenu"><a href="<?php echo $base_url;?>/contact">Contact</a></li>
 </ul> 
```

我已经设置了一个名为“active”的 CSS 类，它具有我的活动状态属性。理想情况下，我正在寻找的是当您在“关于”页面（或任何其他页面）上时，我为活动状态创建的类将附加到当前 li 类的。

例子：

```
<li class="cemenu active"><a href="<?php echo $base_url;?>/about">About</a></li> 
```

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-21T15:23:42.407

你可以尝试一些类似的东西

```
<li class="cemenu<?php echo ($_SERVER['PHP_SELF'] == '/about' ? ' active' : '');?>"><a href="<?php echo $base_url;?>/about">About</a></li> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-21T15:22:28.097

你可以这样做：

这会将`active`类添加到`<a>`包含`page`来自 url 的类。

```
$(function(){
   var url = window.location.href;
   var page = url.substr(url.lastIndexOf('/')+1);
   $('.cemenu a[href*="'+page+'"]').addClass('active');
}); 
```

如果你想将类添加到它的父 li 替换最后一行到这个和 css 类应该是这样的：

```
.active a{
      css 
      properties 
      for active li's a
}

 // using closest
$('.cemenu a[href*="'+page+'"]').closest('li').addClass('active'); 
```

或者

```
// using parent
$('.cemenu a[href*="'+page+'"]').parent('li').addClass('active'); 
```

[**只是在这里试用小提琴**](http://jsfiddle.net/Y8Mfw/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-21T15:39:26.300

尝试这样的事情：

```
<?php $pages = array('about' => 'About Us', 'blog' => 'blog') ?>

<ul>
<?php foreach($pages as $url => $page): ?>
    <?php $isActive = $_SERVER["REQUEST_URI"] == $url ?>
    <li<?php echo $isActive ? ' class="active"' : '' ?>>
        <a href="<?php echo $base_url . "/{$url}" ?>"><?php echo $page ?></a>
    </li>
<?php endforeach ?>
</ul> 
```

可能值得考虑使用诸如 get_page_link 之类的 wordpres 函数，这比使用 Server super global 更好，因为这并不好。如果您在文件夹中有 wordpress 而不是文档根目录，这也会失败，这只是一个简单的示例，让您开始:)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-21T15:26:22.970

首先，有一个 css 伪类用于设置“活动”链接的样式：

```
a:active {css} 
```

对于您的情况，您必须将此类添加到您的样式中：

```
.active a, a:active {css} 
```

但是您的需求似乎更多是在 PHP 方面而不是 CSS，也许其他人会在这部分帮助您。将有一个带有 jQ​​uery 的 javascript 解决方案，找到实际位置，然后将 css 选择器注入到正确的元素中。

查看[这篇文章](http://www.vanseodesign.com/wordpress/hightlight-current-page-wordpress/)和[另一篇](http://wordpress.org/support/topic/navigation-active-state-problem)关于 wordpress 的文章。它会帮助你。

堆栈溢出参考：

*   [如何在 Wordpress 的活动状态下针对每个菜单的不同项目](https://stackoverflow.com/questions/6529155/how-do-i-target-each-menu-different-items-on-active-state-in-wordpress)
*   [如何在 wordpress wp_nav_menu() 中添加活动状态和图标](https://stackoverflow.com/questions/9858243/how-to-add-active-states-and-icons-in-wordpress-wp-nav-menu)
*   [在 Wordpress 动态菜单中丢失导航活动状态](https://stackoverflow.com/questions/11942798/loosing-nav-active-state-in-wordpress-dynamic-menu)
*   [谷歌搜索](https://www.google.ca/search?num=100&hl=fr&newwindow=1&q=wordpress%20active%20state%20navigation%20site:stackoverflow.com&oq=wordpress%20active%20state%20navigation%20site:stackoverflow.com&gs_l=serp.3...320081.325972.0.326119.23.23.0.0.0.0.138.1639.22j1.23.0...0.0...1c.1.4.serp.2uc03Bkjn9E)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-01-07T11:44:01.280

你可以这样尝试

```
<li class="<?php 
                if($this_page=='Home'){
                     echo 'active';
                }
          ?>">
      Home
 </li>
<li class="<?php 
                if($this_page=='Contact'){
                     echo 'active';
                }
          ?>">
      Contact
 </li> 
```

然后在你的主页

```
$this_page='Home'; 
```

在您的联系页面中

```
$this_page='Contact'; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-12-31T16:33:33.773

您可以使用 preg_replace()`class="active"`像这样添加：

```
ob_start();
echo '<ul>
  <li><a href="page1.php">Page 1</a></li>
  <li><a href="page2.php">Page 2</a></li>
  </ul>';
$output = ob_get_clean();
$pattern = '~<li><a href="'.$url.'">~';
$replacement = '<li class="active"><a href="'.$url.'">';
echo preg_replace($pattern, $replacement, $output); 
```

# python - 将匹配附加到新列表并从原始列表中删除匹配

> ID：15005734
> 
> 赞同：1
> 
> 时间：2013-02-21T15:16:33.587
> 
> 标签：python

假设我在一个名为“main”的列表中有一堆字符串。如何遍历“main”，如果找到匹配项，则删除“main”中匹配的部分，然后将匹配的文本添加到名为“new”的新列表中？

Python

```
main = ['text \fc + \fr this is my match1 \fc* text', 'text \fc + \fr this is my match2 \fc* text', 'text', 'text', 'text \fc + \fr this is my match \fc* text']
new = []

def rematch(pattern, inp):
  matcher = re.compile(pattern)
  matches = matcher.match(inp)
  if matches:
    new.append(matches)
    #remove match from "main" somehow?

for x in main:
  for m in rematch('\\fc \+ \\fr(.*?)\\fc\*', x): 
```

结果：

```
main = ['text text', 'text text', 'text', 'text', 'text text']

new = ['this is my match1', 'this is my match2', 'this is my match3'] 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-21T15:24:31.870

```
In [33]: import re

In [34]: pat = re.compile('\\fc \+ \\fr(.*?)\\fc\*')

In [43]: main, new = zip(*[(''.join(parts[::2]), ''.join(parts[1::2])) for parts in [pat.split(m) for m in main]])

In [44]: new = [n.strip() for n in new if n]

In [45]: main
Out[45]: ('text  text', 'text  text', 'text', 'text', 'text  text')

In [46]: new
Out[46]: ['this is my match1', 'this is my match2', 'this is my match'] 
```

* * *

解释：

注意使用时会发生什么`pat.split`：

```
In [37]: pat.split(main[0])
Out[37]: ['text ', ' this is my match1 ', ' text'] 
```

这与您想要的类似，只是您需要 中的奇数项`main`和 中的偶数项`new`。我们稍后会谈到。

首先，让我们应用`pat.split`到 中的每个项目`main`：

```
In [51]: [pat.split(m) for m in main]
Out[51]: 
[['text ', ' this is my match1 ', ' text'],
 ['text ', ' this is my match2 ', ' text'],
 ['text'],
 ['text'],
 ['text ', ' this is my match ', ' text']] 
```

接下来，让我们将奇数项与偶数项分开，并使用`''.join`将这些项组合成一个字符串：

```
In [52]: [(''.join(parts[::2]), ''.join(parts[1::2])) for parts in [pat.split(m) for m in main]]
Out[52]: 
[('text  text', ' this is my match1 '),
 ('text  text', ' this is my match2 '),
 ('text', ''),
 ('text', ''),
 ('text  text', ' this is my match ')] 
```

从这里，我们可以使用`zip(*...)`to 分开：`main``new`

```
In [53]: main, new = zip(*[(''.join(parts[::2]), ''.join(parts[1::2])) for parts in [pat.split(m) for m in main]])

In [54]: main
Out[54]: ('text  text', 'text  text', 'text', 'text', 'text  text')

In [55]: new
Out[55]: (' this is my match1 ', ' this is my match2 ', '', '', ' this is my match ') 
```

# ios - 在导航控制器中的视图之间跳转

> ID：15005736
> 
> 赞同：3
> 
> 时间：2013-02-21T15:16:37.997
> 
> 标签：ios, xcode, uinavigationcontroller

我需要在视图控制器之间跳转。例如：

```
View1: First screen (Just logo)
View2: Download Screen
View3: First app screen (Some Buttons)
View4-View(N): some app screens 
```

当用户进入应用程序时，应用程序转到 View1->View2（下载东西）->View 3->View4->View5 然后用户希望转到第一个应用程序屏幕（View3），他这样做：

```
NSArray *array = [self.navigationController viewControllers];
[self.navigationController popToViewController:[array objectAtIndex:2] animated:NO]; 
```

用户第一次进入应用程序时：View1->View3（不再需要下载屏幕），我有不同的推送序列可以转到 View3，所以假设用户转到：View1->View 3->View4- >View5，现在他想回到View3，所以函数：

```
NSArray *array = [self.navigationController viewControllers];
[self.navigationController popToViewController:[array objectAtIndex:2] animated:NO]; 
```

将他送回 View4，这是错误的。我该如何解决？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-21T16:05:35.173

好吧，如果您使用 storyboards ，您可以做的是设置您的 uiviewcontrollers 的故事板 ID 并将其用于弹出和推送您的视图。

![在此处输入图像描述](../Images/51594cfd6d5d0e24010d7c78ad0817d9.png)

假设您的故事板名称是`MainStoryboard.storyboard`

```
UIStoryboard*  sb = [UIStoryboard storyboardWithName:@"MainStoryboard"
                                                  bundle:nil];
SettingsListViewController *settingsVC = [sb instantiateViewControllerWithIdentifier:@"SettingsListViewController"]; // @"SettingsListViewController" is the string you have set in above picture
[self.navigationController popToViewController:settingsVC animated:YES]; 
```

上面的解决方案应该对你有用，但如果我是你，我会改变我的应用程序的结构，你说：

```
View1: First screen (Just logo)
View2: Download Screen 
```

由于 View1 只是徽标，而 View 2 也是您跳过的视图，因此您可以将它们从导航控制器中删除，并使 View3 成为您的导航控制器`root view controller`，当您需要 view1 和 view2`present them as Modal View Controllers`时，

当你完成它们时，让我们说；用户成功加载应用程序关闭徽标屏幕，`present Download Screen`如果下载成功则关闭它。

因此，您的 View3 将作为根视图控制器存在，假设您在 View(n) 处想要转到主屏幕，即 View3，您需要做的就是调用

```
[self.navigationController popToRootViewControllerAnimated:NO]; 
```

当您打开`view(n)`并想要弹出以`view(n-1)`使用时

```
[self.navigationController popViewControllerAnimated:YES]; 
```

祝你好运，

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-25T18:26:21.317

如果我理解正确，你的 view3 有特殊的视图控制器，所以你可以使用这样的代码：

```
NSArray *VCs = [self.navigationController viewControllers];
for (UIViewController *VC in VCs)
{
    if ([VC isKindOfClass:[**YOUR-VIEW-CONTROLLER** class]]) {
        [self.navigationController popToViewController:VC animated:NO];
    }
} 
```

这很简单而且有效！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-21T16:13:15.503

听起来 View 2 没有在运行时添加到您的视图控制器数组中，可能是因为您创建了 segue。

尝试删除从 View 1 > View 3 转换的 segue 并将用户推过 View 2 而无需动画，因为您的应用程序的逻辑需要它：

```
// If the user needs to skip ahead to view 3, conditionally push view 2 and view 3 without animating
[self.navigationController pushViewController:viewController2 animated:NO];
[self.navigationController pushViewController:viewController3 animated:NO]; 
```

或者，如果您将 segue 留在原地，您是否可以不查看`UINavigationController` `viewControllers`属性的大小并根据大小“猜测”您是否跳过 View 2？如果你这样做了，那么你可以调整`popToViewController`方法以弹出正确的索引。如果您还需要跳过其他视图，这无疑是不那么优雅和脆弱的。

```
// Check length of viewController array with 'N' views (pseudo code)
if (self.navigationController.viewControllers.length == N-1)
    // View 2 was ignored: pop to objectAtIndex:1
else 
    // View 2 was included: pop to objectAtIndex:2 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-21T15:21:39.497

根据您的位置，直接使用 viewController 的名称

创建您的 viewController 的实例，像这样我在这里假设您的 viewController 名称是-view3Controller

```
 View3Controller view3Controller=[[View3Controller alloc]init];
 [self.navigationController popToViewController:@"view3Controller" animated:NO] 
```

或者如果您正在使用情节提要，那么

```
View3Controller view3Controller=[self.storyboard instantiateViewControllerWithIdentifier:@"view3Controller"];

        [self.navigationController popToViewController:@"view3Controller" animated:NO] 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-21T15:36:10.153

在第二个序列中，您的导航堆栈更改并且 view3 将位于索引 1。所以

```
[[self.navigationController popToViewController:[array objectAtIndex:1] animated:NO]; 
```

将是这样做的正确方法。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-10-20T10:51:22.270

我总是使用它，它会在你的情况下正常工作。事实上，以下代码行被复制到我的“Notes”中以便快速复制/粘贴。

如果没有，请务必导入您的 ViewController.h 文件。

```
for (UIViewController *viewController in self.navigationController.viewControllers) {
        if([viewController isKindOfClass:["your ViewController" class]]) {
            [self.navigationController popToViewController:viewController animated:NO];
        }
    } 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-08-23T08:56:08.357

```
for (UIViewController* controller in self.navigationController.viewControllers) {
        if ([controller isKindOfClass:[<Your View Controller Name> class]]) {
            [self.navigationController popToViewController:controller animated:YES];
            return;
        }
    } 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2015-02-05T09:59:28.630

像这样转到特定的视图控制器

```
 [self.navigationController popToViewController:[[self.navigationController viewControllers]objectAtIndex:1] animated:YES]; 
```

# php - 准备好的语句中的“加倍”数组以填充重复的占位符

> ID：15005740
> 
> 赞同：-1
> 
> 时间：2013-02-21T15:16:43.143
> 
> 标签：php, mysql, prepared-statement

天哪，这太烦人了。我有一个带有收件箱、发件箱和对话视图的消息系统。对话视图显示与特定用户发送和接收的消息，并且由于我只使用一个表来处理消息（sender_status/receiver_status 来控制消息中涉及的哪些用户已将其删除、阅读等）

我的列表旁边有一个复选框，每条消息一个，它在我的收件箱和发件箱查询中都可以正常工作：

```
<input type="checkbox" name="message_delete[]" value="<?= $message['mid']; ?>"/> 
```

当我尝试在对话视图中删除时，我需要将 messageupdate 应用到正确的状态：正常查询，即收件箱，工作正常：

```
$questionmarks = str_repeat("?,", count($mid_array) - 1) . "?";
$st = $db->prepare("UPDATE messages SET sender_status = 'DELETED' WHERE mid IN ($questionmarks)");
            $st->execute($mid_array); 
```

对话查询，不起作用：

```
$st = $db->prepare("UPDATE messages SET (receiver_status = 'DELETED' WHERE mid IN        ($questionmarks) AND to_user = '{$user_id}'), (sender_status = 'DELETED' WHERE mid IN ($questionmarks) AND from_user = '{$user_id}')");
            $st->execute( WHAT TO PUT HERE ); 
```

我在我认为可行的执行中尝试了 array($mid_array, $mid_array) 。还有其他几个我无法工作的有点愚蠢的解决方案。我可能在这里错过了一些简单的功能，但我尝试过的功能都没有，因此我的问题。需要帮忙！！提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T15:26:29.343

尝试更多类似的东西

```
UPDATE messages
SET
    receiver_status = 'DELETED',
    sender_status = 'DELETED'
WHERE mid IN ($questionmarks) AND ('$user_id' IN (to_user, from_user)) 
```

解决原始查询中的多个`where`问题。

* * *

```
SET
   receiver_status = IF(to_user   = '$user_id', 'DELETED', receiver_status),
   sender_status   = IF(from_user = '$user_id', 'DELETED', sender_status)
WHERE mid IN ($questionmarks) 
```

相反，然后呢？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T15:30:44.400

哇。
无论有没有准备好的陈述，你都无法做到这一点。
它是 SQL 语法，而不是 PDO。

因此，只需使用 2 个单独的数据集运行 2 个单独的查询。

顺便说一句，由于某种原因，您没有在查询中使用占位符 - 所以，您处于危险之中。

# html - 在链接有效的html中输入？

> ID：15005743
> 
> 赞同：0
> 
> 时间：2013-02-21T15:17:04.703
> 
> 标签：html, forms, internet-explorer

这是有效的标记吗？

```
<a href="/checkout/booking.php">
   <input type="image" src="/image.gif" value="Complete" title="Complete" style="width: 131px;">
</a> 
```

W3C 验证器似乎没有任何问题。它在 FF 和 Chrome 中运行良好，但在 IE 中单击它时没有任何反应。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T15:21:17.613

那么它在 W3C 中是有效的。但它并不常见。将实际上是图像的输入作为链接。也许考虑只使用`<img />`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T15:22:16.823

在 HTML 4 中它是有效的。在 HTML 5 中它是无效的。某些浏览器存在问题，因此即使您使用的是 HTML 4，也不应该使用它。

# lucene - Lucens 进行“开始”查询的最佳方式

> ID：15005747
> 
> 赞同：4
> 
> 时间：2013-02-21T15:17:11.693
> 
> 标签：lucene, startswith

我希望能够执行以下类型的查询：

要索引的数据包括（比方说）只有标题有趣的音乐视频。我只是想对这些进行索引，然后为它们创建查询，这样，无论用户在查询中使用什么单词或多个单词，包含这些单词的文档都会按顺序在图块的开头返回，然后（在没有特别的顺序）由在标题的任何位置包含至少一个搜索词的文档。此外，所有这些都应该不区分大小写。

例子：

对于文件：

*   Video1Title = 海是蓝色的
*   Video2Title = 野生海洋
*   Video3Title = 野生海洋 随便
*   Video4Title = 海边随便

如果我搜索“海”，我想得到

*   “Video1Title = 海是蓝色的”

首先是所有其他标题中包含“sea”的文件，但不是在开头。

如果我搜索“Wild sea”我想得到

*   Video2Title = 野生海洋
*   Video3Title = 野生海洋 随便

首先是标题中包含“Wild”或“Sea”但没有“Wild Sea”作为标题前缀的所有其他文档。

如果我搜索“Seasi”，我不想得到任何东西（我不关心关键字标记化和前缀查询）。

现在 AFAIKS，没有实际的方法可以告诉 Lucene“找到 word1 和 word2 等在位置 1 和 2 和 3 等的文档”。

有“解决方法”来模拟这种行为：

*   索引该字段两次。在`field1`您将单词标记化（使用也许`StandardAnalyzer`）并且`field2`将它们全部聚集成一个元素（使用`KeywordAnalyzer`）。然后，如果您搜索以下内容：

    +(field1:word1 word2 word3) (field2:"word1 word2 word3*")

有效地告诉 Lucene “文档必须在标题中包含 word1 或 word2 或 word3，并且匹配“标题以 >word1 word2 word3< 开头”的那些更好（获得更高的分数）。

*   在索引字段时将“lucene_start_token”添加到字段的开头，以便 `Video2Title = Wild sea`索引为“ `title:lucene_start_token Wild sea`”，其余部分依此类推

然后进行如下查询：

+(title:sea) (title:"lucene_start_token sea")

并让 Lucene 返回标题中包含我的搜索词的所有文档，并对匹配“lucene_start_token+搜索词”的人给出更好的分数

那么我的问题是，确实有更好的方法来做到这一点（也许使用[PhraseQuery](https://lucene.apache.org/core/old_versioned_docs/versions/3_0_3/api/all/org/apache/lucene/search/PhraseQuery.html)和[Term](https://lucene.apache.org/core/old_versioned_docs/versions/3_0_3/api/all/org/apache/lucene/index/Term.html) [position](https://lucene.apache.org/core/old_versioned_docs/versions/3_0_3/api/all/org/apache/lucene/search/PhraseQuery.html#add%28org.apache.lucene.index.Term,%20int%29)）？如果不是，以上哪一项在性能方面更好？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-26T00:00:10.410

您可以为此使用[Lucene Payloads](http://searchhub.org/2010/04/18/refresh-getting-started-with-payloads/)。您可以为字段值的每个术语提供自定义提升。

因此，当您索引标题时，您可以开始使用 3 的提升因子（例如）：

标题：**野生**|3.0**生物**|2.5**蓝色**|2.0**海**|1.5

标题：**海**|3.0**生物**|2.5

通过这种方式索引，您将最近的术语提升到标题的开头。

使用这种方法的主要问题是您必须自己标记并“手动”添加所有这些提升信息，因为分析器需要以这种方式构造的文本 (term1|1.1 term2|3.0 term3)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-25T16:33:01.433

你可以做的是分别索引标题和每个标记，例如文本`wild deep blue endless sea`将被索引为：

```
title: wild deep blue endless sea
t1: wild
t2: deep
t3: blue
t4: endless
t5: sea 
```

然后如果有人查询“wild deep”，查询将被重写为

```
title:"wild deep" OR (t1:wild AND t2:deep) 
```

这样，您将始终找到所有匹配的文档（如果它们匹配`title`），但匹配`t1..tN`的标记将使相关文档得分更高。

# ruby-on-rails - 在rails 3中指定url

> ID：15005750
> 
> 赞同：0
> 
> 时间：2013-02-21T15:17:18.033
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我对 Rails 编程完全陌生...我使用 request.path 来获取当前 url，并通过在 applications.html.erb 中指定它来在我的所有视图中显示它。它正在返回整个路径，我想将其显示为链接...所以我使用 **link_to**将其指定为 url..现在这就是我想要做的..返回的 url 将采用 path1/path2 格式/path3..... 我想将其显示为 path1>path2>path3 和一个链接，这样当用户单击 path1 时，它应该将他带到路径 1 等等......

这是我在 html.erb 文件中给出的代码

但我收到一个错误，上面写着未定义的方法....我应该怎么做才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-21T15:29:49.747

您可以拆分 request.path`/`然后建立各种链接，但是对于深度嵌套的路径，这可能会变得非常混乱。我认为更好的方法是使用诸如[breadcrumbs_on_rails](https://github.com/weppos/breadcrumbs_on_rails)之类的东西并明确声明您的面包屑并以部分或辅助方法呈现它们。我认为您也可以使用一些 Rails 过滤器魔术来自动对动作名称进行面包屑导航，但是使面包屑显式化会迫使您考虑您的站点和用户，而不是以编程方式吐出一串长度未知的链接。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-21T15:37:45.183

你可以这样做：

```
 <% path = request.path %>
 <% links = path.split('/') %>
 <% ll="/" %>
 <% links.each do |l| %>
   <% ll += (l+'/') %>
   <%= link_to l,ll %> &gt;
 <% end %> 
```

# selenium - RemoteWebDriver 将 '/session' 附加到 url

> ID：15005752
> 
> 赞同：0
> 
> 时间：2013-02-21T15:17:22.400
> 
> 标签：selenium, web, driver

使用 RemoteWebDriver，我正在尝试在 ClassInitialize 方法内的 VS2012 MSTest 项目中运行以下代码：

```
RemoteWebDriver remote = new RemoteWebDriver(new Uri("http://localhost.website/"), DesiredCapabilities.Chrome()); 
```

我得到一个 WebDriver 异常，它显示 /session 标记在我指定的 url 的末尾：

> {"意外错误。\r\n\r\n \r\n
> 找不到资源。\r\n \r\n
> \r\n body {font-family:\"Verdana\";font-weight :normal;font-size: .7em;color:black;} \r\np {font-family:\"Verdana\";font-weight:normal;color:black;margin-top: -5px}\r\ nb {font-family:\"Verdana\";font-weight:bold;color:black;margin-top: -5px}\r\n H1 { font-family:\"Verdana\";font-weight:normal ;font-size:18pt;color:red }\r\n H2 { font-family:\"Verdana\";font-weight:normal;font-size:14pt;color:maroon }\r\n pre {font -family:\"Consolas\",\"Lucida Console\",Monospace;font-size:11pt;margin:0;padding:0.5em;line-height:14pt}\r\n .marker {font-weight:粗体；颜色：黑色；文字装饰：无；}\r\n
> .version {color: gray;}\r\n .error {margin-bottom: 10px;}\r\n .expandable { text-decoration:underline; 字体粗细：粗体；颜色：海军蓝；光标：手；}\r\n @media screen and (max-width: 639px) {\r\n pre { width: 440px; 溢出：自动；空白：预包装；word-wrap：断词；}\r\n }\r\n @media screen and (max-width: 479px) {\r\n pre { width: 280px; }\r\n }\r\n
> \r\n \r\n\r\n \r\n\r\n
> 
> # “/MyProject.Web”应用程序中的服务器错误。
> 
> \r\n\r\n
> 
> ## *无法找到该资源。*
> 
> \r\n\r\n
> \r\n\r\n **描述：** HTTP 404。您要查找的资源（或其依赖项之一）可能已被删除、名称已更改或暂时不可用。请检查以下 URL 并确保其拼写正确。\r\n
> 
> \r\n\r\n **请求的 URL:** /MyProject.Web/session
> 
> \r\n\r\n
> \r\n\r\ n **版本信息：**  Microsoft .NET Framework 版本：4.0.30319；ASP.NET 版本：4.0.30319.18033\r\n\r\n \r\n\r\n
> \r\n\r\nc__DisplayClass1d.b__18(IAsyncResult asyncResult)\r\n 在 System.Web.Mvc.Async.AsyncResultWrapper.<>c__DisplayClass4.b__3(IAsyncResult ar)\r\n 在 System.Web.Mvc.Async .AsyncResultWrapper.WrappedAsyncResult`1.End()\r\n 在 System.Web.Mvc.Controller.EndExecuteCore(IAsyncResult asyncResult)\r\n 在 System.Web.Mvc.Async.AsyncResultWrapper.<>c__DisplayClass4.<MakeVoidDelegate> b__3(IAsyncResult ar)\r\n 在 System.Web.Mvc.Async.AsyncResultWrapper.WrappedAsyncResult</code>1.End()\r\n 在 System.Web.Mvc.Controller.EndExecute(IAsyncResult asyncResult)\r \n 在 System.Web.Mvc.Controller.System.Web.Mvc.Async.IAsyncController.EndExecute(IAsyncResult asyncResult)\r\n 在 System.Web.Mvc.MvcHandler.<>c__DisplayClass8.b__3(IAsyncResult asyncResult)\r \n 在 System.Web.Mvc.Async。AsyncResultWrapper.<>c__DisplayClass4.b__3(IAsyncResult ar)\r\n 在 System.Web.Mvc.Async.AsyncResultWrapper.WrappedAsyncResult`1.End()\r\n 在 System.Web.Mvc.MvcHandler.EndProcessRequest(IAsyncResult asyncResult )\r\n 在 System.Web.Mvc.MvcHandler.System.Web.IHttpAsyncHandler.EndProcessRequest(IAsyncResult 结果)\r\n 在 System.Web.HttpApplication.CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute()\ r\n 在 System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously)\r\n-->"}EndProcessRequest(IAsyncResult 结果)\r\n 在 System.Web.HttpApplication.CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute()\r\n 在 System.Web.HttpApplication.ExecuteStep(IExecutionStep 步骤，Boolean& completedSynchronously)\r \n-->"}EndProcessRequest(IAsyncResult 结果)\r\n 在 System.Web.HttpApplication.CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute()\r\n 在 System.Web.HttpApplication.ExecuteStep(IExecutionStep 步骤，Boolean& completedSynchronously)\r \n-->"}

任何人都知道它为什么这样做？发生这种情况知道我指向它的网址。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T15:25:00.160

正确阅读您的错误后（道歉）...

您使用的构造函数错误。

快速查看代码显示您正在使用此构造函数：

```
/// <summary>
/// Initializes a new instance of the RemoteWebDriver class
/// </summary>
/// <param name="remoteAddress">URI containing the address of the WebDriver remote server (e.g. http://127.0.0.1:4444/wd/hub).</param>
/// <param name="desiredCapabilities">An <see cref="ICapabilities"/> object containing the desired capabilities of the browser.</param>
public RemoteWebDriver(Uri remoteAddress, ICapabilities desiredCapabilities)
    : this(remoteAddress, desiredCapabilities, RemoteWebDriver.DefaultCommandTimeout)
{
} 
```

您传入的 URI 属性是*远程网格服务器的地址*。*不是*你想去的地方。

Selenium 会将`session`信息附加到 URL 上，因为它会尝试在*远程服务器*上创建自己的会话。

除非我误解了您，否则您听起来好像是在本地运行它。在这种情况下，要么使用封装的驱动程序对象（所以在使用`RemoteWebDriver`with`DesiredCapabilities.Chrome()`的内部`ChromeDriver`）或简单地省略 URI 属性......

```
RemoteWebDriver remote = new RemoteWebDriver(DesiredCapabilities.Chrome()); 
```

要导航到某个地方，请*使用*：

```
remote.Navigate().GoToUrl("yourlocalwebsite"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-06-24T12:16:41.273

当您访问远程浏览器时，有时它们确实需要用户名和密码。如果您在使用 RemoteWebDriver() 方法创建会话期间意外未能提供相同的信息，您将看到错误说明“服务器错误 ******** /session”。所以尝试添加驱动程序=。new RemoteWebDriver(new URL("https://:<密码/连接密钥>@.com"))

# c++ - 编译器找不到 ui_xyz.h 文件

> ID：15005754
> 
> 赞同：1
> 
> 时间：2013-02-21T15:17:29.607
> 
> 标签：c++, qt, netbeans

我已经在 Windows7 上安装了 Netbeans 7.2 和 Qt 5。一切都编译得很好。

但最近当我创建一个 Qt 表单并尝试以这种方式使用它时：

*   新项目 > C/C++ Qt 应用程序 > 完成
*   右键单击新 Qt 项目 > 新建 > Qt 表单 > 完成
*   在 Designer 中保存 ui 文件后

出现此错误：

> newForm.h:11:24：致命错误：ui_newForm.h：没有这样的文件或目录

main.cpp 的内容是：

```
#include <QGuiApplication>
#include "newForm.h"

int main(int argc, char *argv[])
{
    // initialize resources, if needed
    // Q_INIT_RESOURCE(resfile);

    QGuiApplication app(argc, argv);

    // create and show your widgets here

    return app.exec();
} 
```

我尝试手动创建 ui_xwz.h 文件并将其添加到我的项目中。但我希望它像以前一样自动工作。我该如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T17:31:18.073

我有一个荒谬的解决方案，也许我们应该将它作为错误报告给 Netbeans 或 Qt。

![在此处输入图像描述](../Images/468b064c1fb964318979f5f05a65087e.png)

去激活项目的 QtSVG 和 QtXml 模块并重建它。我以这种方式进行了测试，问题消失了。

# perl - 在本地机器上升级 bugzilla（3.4.x 到 4.2.x）

> ID：15005759
> 
> 赞同：0
> 
> 时间：2013-02-21T15:17:39.377
> 
> 标签：perl, bazaar, bugzilla

我已经安装了 bugzilla **Win32InstallPackages**

[https://wiki.mozilla.org/Bugzilla:Win32InstallPackages](https://wiki.mozilla.org/Bugzilla:Win32InstallPackages)

它非常简单，只需下载**Bugzilla-Setup-3.4.8.exe**文件，按照步骤操作并按住 Next 按钮。它可以安装所有东西（Apache、MySql、Perl、Bugzilla）并且运行良好。只需通过此 url localhost 开始使用 bugzilla

现在我想用一些稳定的最新版本 4.4 来升级它。我正在使用 Bazaar 存储库从这里 [http://bzr.mozilla.org/bugzilla/4.4/在我的本地 PC 上下载](http://bzr.mozilla.org/bugzilla/4.4/)

Bazaar explorer 在 C:\Bugzilla\trunk 中创建了 trunk 文件夹，并在 trunk 目录中下载了所有源代码。

当我从主干文件夹中复制所有文件并替换为 C:\Bugzilla\ 中的现有文件时，它就不起作用了。

现在，当我尝试通过将 localhost/ 写入地址栏来打开 bugzilla 时，我收到以下错误消息。

```
500 Internal Server Error

The server encountered an internal error or misconfiguration and was unable to complete your request.

Please contact the server administrator, admin@example.com and inform them of the time the error occurred, and anything you might have done that may have caused the error.

More information about this error may be available in the server error log. 
```

你能帮我如何在我的本地机器上升级 bugzilla 吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T15:22:10.720

有可以遵循的[升级说明。](http://www.bugzilla.org/docs/4.4/en/html/upgrade.html)还要检查您的 apache 日志以了解 500 错误的真正含义。

# python - 从文件中读取行但存储为列表（python）

> ID：15005760
> 
> 赞同：2
> 
> 时间：2013-02-21T15:17:41.533
> 
> 标签：python

我想读取文本文件中的特定行并将元素存储在列表中。

我的文本文件看起来像这样

```
'item1' 'item2' 'item3' 
```

我总是以每个字母为元素的列表结束

我试过的

```
line = file.readline()
        for u in line:
            #do something 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-21T15:24:10.323

```
line = file.readline()
for u in line.split():
    # do stuff 
```

这假设项目被空格分割。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-21T15:36:31.243

用空格分割行，然后将它们添加到列表中：

```
# line = ('item1' 'item2' 'item3') example of line
listed = []
line = file.readline()
for u in line.split(' '):
    listed.append(u)

for e in listed:
    print(e) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-21T15:25:16.347

您在那里的内容将读入一整行，然后循环遍历该行中的每个字符。您可能想要做的是将该行拆分为 3 个项目。如果它们用空格分隔，您可以这样做：

```
line = file.readline()      # Read the line in as before
singles = line.split(' ')   # Split the line wherever there are spaces found. You can choose any character though
for item in singles:        # Loop through all items, in your example there will be 3
    #Do something 
```

您可以通过将使用的各种函数串在一起来减少此处的行数（和变量），但为了便于理解，我将它们分开。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-21T15:27:38.120

你可以试试：

```
for u in line.split(): 
```

假设每个项目之间有空格。否则，您将简单地迭代 a `str`，从而逐个字符地迭代。

您可能还想这样做：

```
u = u.strip('\'') 
```

摆脱`'`

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-21T15:30:48.530

我会使用`with`,`re`并且基本上在撇号之间取任何东西...（这适用于其中包含空格的字符串（例如：`item 1` `item 2`，但显然不会捕获嵌套或字符串转义序列）。

```
import re

with open('somefile') as fin:
    print re.findall("'(.*?)'", next(fin))
    # ['item1', 'item2', 'item3'] 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-10-25T10:16:17.353

如果你想要列表中的所有字符，你可以试试这个。

这使用双重列表理解。

```
with open('stackoverflow.txt', 'r') as file:
    charlist = [c for word in file.readline().split(' ') for c in word ]
    print(charlist) 
```

如果你想去掉一些字符，你可以应用一些过滤器，例如；我不希望 char = ' 在我的列表中。

```
with open('stackoverflow.txt', 'r') as file:
    charlist = [c for word in file.readline().split(' ') for c in word if(c != "'")]
    print(charlist) 
```

如果这个双重列表理解看起来很奇怪，这也是一样的。

```
with open('stackoverflow.txt', 'r') as file:
    charlist = []
    line = file.readline()
    for word in line.split(' '):
        for c in word:
            if(c != "'"):
                charlist.append(c)

    print(charlist) 
```

# iphone - 尝试在 iOS 上实现 JW Player

> ID：15005762
> 
> 赞同：6
> 
> 时间：2013-02-21T15:17:46.387
> 
> 标签：iphone, ios, objective-c, jwplayer

我是 JW 的新手，似乎无法对最简单的玩家实施。请帮帮我。

我创建了一个 html 并将其放入我的项目中。与 jwplayer.flash.swf、jwplayer.html5.js、jwplayer.js 在同一个地方

我的 html 文件如下所示（Home.html）：

```
<html>
<head>
  <title>Title of the document</title>
  <script type="text/javascript" src="jwplayer.js"></script>
  <script type="text/javascript">jwplayer.key="myKey"</script>
</head>
<body>
  <div id='player_8955'></div>
  <script type='text/javascript'>
    jwplayer('player_8955').setup({
      file: "http://www.youtube.com/watch?v=ac7KhViaVqc",
      width: "480",
      height: "270",
      image: "http://content.bitsontherun.com/thumbs/3XnJSIm4-640.jpg",
    });
  </script>
</body>
</html> 
```

在控制器类中：

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    htmlPlayerWebView=[[UIWebView alloc]initWithFrame:CGRectMake(20, 51, 674,381)];
    [self.view addSubview:htmlPlayerWebView];
}
-(void)loadVideo
{
    NSString *path = [[NSBundle mainBundle] pathForResource:@"Home" ofType:@"html"];
    NSString *HTMLString = [NSString stringWithContentsOfFile:path encoding:NSUTF8StringEncoding error:nil];
    [htmlPlayerWebView loadHTMLString:HTMLString baseURL:[NSURL URLWithString:path]];
} 
```

函数被调用。但什么也没有发生。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-24T11:46:47.100

我发现了问题： UIWebView 无权访问项目文件。所以 jwplayer.js 没有加载。所以要么将播放器加载到某个网络服务器，要么替换

```
<script type="text/javascript" src="jwplayer.js"></script> 
```

和

```
<script type="text/javascript"> 
```

***文件 jwplayer.js 的内容***（右键单击 jwplayer.js -> 查看源代码 -> 复制 -> 粘贴到此处）

```
</script> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-02T21:29:06.463

您实际上可以从 UIWebview 的 HTML 中访问本地文件。只需更改您的代码：

```
-(void)loadVideo
{
    NSString *basePath = [[NSBundle mainBundle] bundlePath];
    NSURL *baseURL = [NSURL fileURLWithPath:basePath];

    NSString *htmlPath = [[NSBundle mainBundle] pathForResource:@"Home" ofType:@"html"];
    NSString *HTMLString = [NSString stringWithContentsOfFile:htmlPath encoding:NSUTF8StringEncoding error:nil];

    [htmlPlayerWebView loadHTMLString:HTMLString baseURL:baseURL];
} 
```

您的 HTML 中的任何相对路径都将从您的项目文件中引用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-06-27T00:42:35.333

In the years since this question was originally posted, JWPlayer has implemented a [mobile SDK for iOS](https://developer.jwplayer.com/ios-sdk/), which was at first freely available, and now is maintained exclusively for Enterprise users. There is also a new "Developer Class" account which gives full access for 6 months, free.

This post, and related issues, are perhaps the main motivator for such a move; exchanging the slippery moving target of web views, with their opaque implementation details, in favor of the controlled native environment available to a framework project was a clear win.

# knockout.js - 将 DatePicker 与 Knockout 可观察数组一起使用

> ID：15005771
> 
> 赞同：4
> 
> 时间：2013-02-21T15:18:12.497
> 
> 标签：knockout.js, datetimepicker, ko.observablearray

使用来自 Knockout的[可编辑网格示例，并与](http://knockoutjs.com/examples/gridEditor.html)[Steve Sanderson 博客](http://blog.stevensanderson.com/2010/07/12/editing-a-variable-length-list-knockout-style/)联系在一起，我试图让 DatePicker 或 datetimepicker 在可编辑网格中工作。[我首先使用由Ryan Niemeyer](http://www.knockmeout.net/2011/07/another-look-at-custom-bindings-for.html)设置的 datepicker 绑定，但这不适用于可观察数组。

所以代码看起来像：

```
ko.bindingHandlers.datetimepicker = {
    init: function(element, valueAccessor, allBindingsAccessor) {
        //initialize datepicker with some optional options
        var options = allBindingsAccessor().datetimepickerOptions || {};
        $(element).datetimepicker(options);

        //handle the field changing
        ko.utils.registerEventHandler(element, "change", function() {
            var observable = valueAccessor();
            console.log("changing", observable);
            observable($(element).datetimepicker("getDate"));
        });

        //handle disposal (if KO removes by the template binding)
        ko.utils.domNodeDisposal.addDisposeCallback(element, function() {
            $(element).datetimepicker("destroy");
        });

    },
    update: function(element, valueAccessor) {
        var value = ko.utils.unwrapObservable(valueAccessor()),
            current = $(element).datetimepicker("getDate");
        console.log("updating");
        if (value - current !== 0) {
            console.log("setting", value);
            $(element).datetimepicker("setDate", value); 
            console.log("just set", $(element).datetimepicker("getDate"));            
        }
    }
}; 
```

与绑定：

```
<td><input class ="datetimeClass" style="width:130px" data-bind="datetimepicker: CPDateString, uniqueName: true" /></td> 
```

任何帮助或示例将不胜感激。我知道这与可观察数组中的每个项目本身都不是可观察的有关，但是对于 Javascript 来说是新手，我不知道如何修复它。

我收到一个错误：Change 事件中的“字符串不是函数”。如果我添加一些代码来尝试使该字段可观察，如下所示：

```
 $(initialData).each(function(gift) { 
    this.CPDateString = ko.observable(this.CPDateString); 
}); 
```

然后 datetimepicker 工作，并正确更新浏览器，但数据没有发布，所以它没有更新由以下人员发布的实际礼品数组：

```
var initialDataLocations = @Html.Raw(JsonConvert.SerializeObject(ViewBag.Locations));

var initialData = @Html.Raw(JsonConvert.SerializeObject(Model));

var viewModel = {
    availableLocations: ko.observableArray(initialDataLocations),
    gifts: ko.observableArray(initialData),
    save: function() {      
        ko.utils.postJson(location.href, { gifts: this.gifts })
        }
    }; 
```

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-21T17:15:23.473

自定义绑定是使用小部件 UI 控件的强大工具。您只需要使用 datetimepicker 自定义绑定来使 textbox/input 成为日期时间选择器，并且 input 的值只需使用标准 ko 绑定：

```
<td><input class ="datetimeClass" style="width:130px" data-bind="datetimepicker: {}, value:CPDateString, uniqueName: true" /></td> 
```

希望这会有所帮助

# 更新示例：

我写了一个非常简单的 datepicker 自定义绑定，如下所示：

```
ko.bindingHandlers.datepicker = {
    init: function (element, valueAccessor) {
        var options = valueAccessor();
        $(element).datepicker(options || {});
    }
}; 
```

在 html 代码中只需使用自定义绑定，如下所示：

```
<input id="txtFromtDate" data-bind="datepicker:{}, value:lastUpdateFrom" type="text" /> 
```

# php - 用php从mysql结果创建csv文件？

> ID：15005782
> 
> 赞同：0
> 
> 时间：2013-02-21T15:18:53.200
> 
> 标签：php, mysql, export-to-csv

所以我正在尝试制作一个 .csv 文件，之后我会下载它，但问题是行没有正确排列。我正在使用 fputcsv。

```
$tot.="$codcomanda,$clientnume,$brandnume,$numeprod,$um,$cantitate,$updatare";
$list =array(
    array('Comanda','Client','Categorie','Produs','UM','Cantitate','Actualizare'),
    array($tot),
);

$fp = fopen('file.csv', 'w');

foreach ($list as $fields) {
    fputcsv($fp, $fields);
}

fclose($fp); 
```

变量 $tot 来自一个`while`语句，它从不同的查询中获取它的变量，我在互联网上找不到满足我需要的 php 代码。我尝试了几种方法来尝试让它工作但没有。我尝试了`$tot`不同的方法，但没有任何工作，要么 $tot.= csv 文件应该有类似的东西。

*   标题行，
*   1号线，
*   2号线，
*   ETC

但我的 csv 显示像

*   标题行，
*   “线路 1、线路 2 等”

我尝试了`$tot`不同的方法，但没有任何工作，要么像这样的 csv 显示，要么根本不显示任何内容。

* * *

已解决：使用 fwrite 我已经解决了。

```
$tot.="$codcomanda;$clientnume;$brandnume;$numeprod;$um;$cantitate;$updatare;\n";
$tot2="Comanda;Client;Brand;Produse;U.M;Cantitate;Actualizare;\n$tot";

    $file = fopen("file.csv","w");
    fwrite($file,$tot2);
    fclose($file); 
```

它像它应该写的那样写。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T12:27:59.297

Try like the following example

```
 <?php
          $list =array(
                       array('Comanda','Client','Categorie','Produs','UM','Cantitate','Actualizare'),
           array('P1','C1','CL1','2','2','Ct1','A1'),
           array('P2','C2','CL2','2','2','Ct2','A2'),
          );

       $fp = fopen('file.csv', 'w');

     foreach ($list as $fields) {
     fputcsv($fp, $fields);
    }

     fclose($fp)
   ?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T15:52:46.977

尝试在调用 fopen() 之前添加此行：ini_set("auto_detect_line_endings", true)

# javascript - 发送 jsonp 请求 phonegap 时捕获响应

> ID：15005784
> 
> 赞同：1
> 
> 时间：2013-02-21T15:18:57.970
> 
> 标签：javascript, ajax, node.js, cordova, jsonp

我用 phonegap 服务器端编写应用程序 我用 nodejs 编写

```
exports.login = function(request, response) {
    var keys = Object.keys(request.query);
    request.body= JSON.parse(keys[1]);
    Accounts.findOne({
        name : request.body.name
    }, function(err, docs) {
        if (!docs) {
            response.json('{"error": "user-not-found"}');
        } else {
            console.log("docs: ", docs);
            Accounts.validatePassword(request.body.password, docs['hashedPass'], docs['salt'], function(error, res) {
                if (error) {
                    response.json(error);
                }
                if (res) {
                    generateToken(request.body.name, request.body.device, function(res) {
                        if (res) {
                            response.json('{"token": "' + res + '"}');
                        } else {
                            response.json('{"error": "cant-create-token"}');
                        }
                    });
                } else {
                    response.json('{"error": "invalid-password"}');
                }
            });

        }
    })
} 
```

Phonegap：我写函数来登录

```
function LoginUser(info)
{
    var varUrl=server+"/auth/login";
    $.ajax({
            url:varUrl,
            type:"GET",
            contentType:"application/json",
            headers: {
                            Accept:"application/json",
                            "Access-Control-Allow-Origin": "*"
                        },              
            data:info,              
            dataType:"jsonp", 
            success:function(data)
                {
                    console.log("HERE");
                    console.log(data);                      
                },
            error: function(err){
                console.log(err);
            }

    });
} 
```

我要求它会像这样`http://localhost:3000/auth/login?callback=jQuery161014894121675752103_1361459462241&{%22name%22:%22fdfdfd%22,%22password%22:%22fdfdfdfd%22}&_=1361459615743`

当我在 chrome 开发者的 tab network 的响应中看到`"{\"error\": \"user-not-found\"}"`

但我无法在`function LoginUser(info)`上面如何获取它，因为在控制台中它打印`error: function(err){ console.log(err); }`

我不知道为什么。你能帮助我吗。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T15:22:40.177

在服务器端，您必须使用回调，并且在您的 jsonp 文件的响应中，您需要执行以下操作：

```
jQuery161014894121675752103_1361459462241({"error": "user-not-found"}) 
```

函数名称来自 jsonp 请求中的回调变量。导致 jsonp 请求只是在您的站点中“包含”一个脚本标签，它可以执行 js（基本上）。

# r - 更改数据框中的列

> ID：15005800
> 
> 赞同：2
> 
> 时间：2013-02-21T15:19:48.223
> 
> 标签：r, dataframe

如果某列具有特定内容（但是，不是确切的内容，而是我使用正则表达式找到的内容），我正在尝试更改 R 数据框中的一列。

例如：

```
 df:
 Name        City            Age
 Peter       Fort Wayne      15
 John        South Bend      20
 Christopher Boston          25
 Andy        Boston          30
 Johnathan   Los Angeles     35 
```

现在，如果我想更改所有名字以 John 开头的人的年龄，我通常会这样选择他们：

```
 subset(df, grepl("^John", Name)) 
```

这会给我

```
 Name        City            Age
 John        South Bend      20
 Johnathan   Los Angeles     35 
```

但是，显然我无法使用

```
 subset(df, grepl("^John", Name))$Age <- 20 
```

是否有捷径可寻？我不想从数据框中删除行然后重新插入它们，这就是我迄今为止一直在做的事情。

谢谢你的帮助，奥利弗

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-21T15:21:19.523

尝试：

```
 df$Age[grepl("^John", df$Name)] <- 20 
```

`subset`返回 a`data.frame`并且您不能分配`20`给整个`data.frame`. 相反，按列索引，如上所示。

# web-services - 带有 REST Web 服务的 Spring Security - 使用 Curl 进行测试时无法通过标头进行身份验证

> ID：15005804
> 
> 赞同：2
> 
> 时间：2013-02-21T15:19:53.200
> 
> 标签：web-services, spring, api, spring-security, restful-authentication

我是 Spring 和 Spring Security 的新手，我似乎无法正常工作。我正在使用 Spring 安全性保护 Web 服务。当我明确登录到我定义的 URL 时，我得到了适当的响应 - 401、200 等 - 用于安全请求。但是，当我尝试通过 curl 或在标头中发送身份验证的海报测试提供数据的实际 url 时，我无法让它工作。

这是我的 servlet-security.xml 文件：

```
<?xml version="1.0" encoding="UTF-8"?>
<beans:beans xmlns="http://www.springframework.org/schema/security"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xmlns:beans="http://www.springframework.org/schema/beans"
xmlns:sec="http://www.springframework.org/schema/security"
xsi:schemaLocation="
http://www.springframework.org/schema/security
http://www.springframework.org/schema/security/spring-security-3.1.xsd
http://www.springframework.org/schema/beans
http://www.springframework.org/schema/beans/spring-beans-3.1.xsd">

<http create-session="stateless" entry-point-ref="restAuthenticationEntryPoint">
  <intercept-url pattern="/services/schedule/**" access="ROLE_USER, ROLE_ADMIN"/>

  <custom-filter ref="myFilter" position="FORM_LOGIN_FILTER"/>

  <!-- Adds a logout filter to Spring Security filter chain -->
    <logout logout-url="/api/logout" delete-cookies="true" invalidate-session="true"
        success-handler-ref="restLogoutSuccessHandler"/>
</http>

<beans:bean id="myFilter" class="org.springframework.security.web.authentication.UsernamePasswordAuthenticationFilter">
  <beans:property name="authenticationManager" ref="authenticationManager"/>
  <beans:property name="authenticationSuccessHandler" ref="mySuccessHandler"/>
  <beans:property name="filterProcessesUrl" value="/api/login"/>
    <beans:property name="usernameParameter" value="username"/>
    <beans:property name="passwordParameter" value="password"/>
    <beans:property name="postOnly" value="true"/>
 </beans:bean>

 <!-- Configures a custom authentication success handler that returns HTTP status code 200 -->
 <beans:bean id="mySuccessHandler" class="com.touchvision.pilot.security.RestAuthenticationSuccessHandler"/>

 <!-- Configures a custom authentication failure handler that returns HTTP status code 401 -->
 <beans:bean id="restAuthenticationFailureHandler" class="com.touchvision.pilot.security.RestAuthenticationFailureHandler"/>

  <!-- Configures a custom logout success handler that returns HTTP status code 200 -->
  <beans:bean id="restLogoutSuccessHandler" class="com.touchvision.pilot.security.RestLogoutSuccessHandler"/>

<!-- Declare an authentication-manager to use a custom userDetailsService -->
<authentication-manager alias="authenticationManager">
        <authentication-provider user-service-ref="customUserDetailsService">
                <password-encoder ref="passwordEncoder"/>
        </authentication-provider>
</authentication-manager>

<!-- Use a Md5 encoder since the user's passwords are stored as Md5 in the database -->
<beans:bean class="org.springframework.security.authentication.encoding.Md5PasswordEncoder" id="passwordEncoder"/>

    <!-- A custom service where Spring will retrieve users and their corresponding access levels  -->
<beans:bean id="customUserDetailsService" class="com.touchvision.pilot.services.CustomUserDetailsService"/>

</beans:beans> 
```

正如我所说，我可以通过将凭据发布到 /api/login 来正常登录。但是，当我尝试使用实际数据请求在标头中发送身份验证时，我收到一条错误消息，提示“此请求需要 HTTP 身份验证”。我正在使用的 curl 命令是：

```
curl -u admin@touchvision.com:admin123 "http://local.touchvision.com/services/schedule/list" 
```

感谢您的任何帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-21T15:36:41.300

您只`UsernamePasswordAuthenticationFilter`配置了一个表单登录过滤器 ( ) 来处理在 HTTP POST 请求中传递的表单参数，但服务器端没有任何东西可以处理请求的*标头*。

尝试配置一个`BasicAuthenticationFilter`将根据标头中传递的信息对请求进行身份验证的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T15:27:05.970

您是否尝试过在用户 ID 中使用 %40 而不是 @ 符号。此外，根据您的 CURL 版本，您可能需要尝试在整个 -u 参数周围加上引号。

# java - 检查对象是否来自某个包

> ID：15005806
> 
> 赞同：6
> 
> 时间：2013-02-21T15:20:04.650
> 
> 标签：java, reflection

有没有办法检查一个对象的类是否来自某个包？

就像，当我使用 来检查对象是否属于某个类`instanceof`时，我想要类似的东西来检查 Java 中的包。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-02-21T15:22:04.000

您可以检查使用

```
myInstance.getClass().getPackage() 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-02-21T15:24:08.870

```
if (instanceofClass.getClass().getPackage().getName().equals("packageyouwanttocheck")) {
    // your code
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-21T15:25:36.440

这是一个关于如何做到这一点的示例。

```
package my.packaging.name;

class X {
}

public class Main { 
    public static void main(String[] args) {
        String packageName = "my.packaging.name";
        X x = new X();
        if (x.getClass().getPackage().getName().equals(packageName)) {
            System.out.println("x belongs to package my.packaging.name");
        } else {
            System.out.println("x does not belong to package my.packaging.name");
        }
    }
} 
```

# sql - 查询开始和结束日期

> ID：15005807
> 
> 赞同：0
> 
> 时间：2013-02-21T15:20:11.193
> 
> 标签：sql, date

我已经搜查了网络，但仍然没有答案。

嗯，我正在创建一个酒店房间预订系统。

我的房间可用性查询适用于此查询：

```
SELECT r.roominv_id, r.room_id, m.room_type,r.room_number,r.room_status
            FROM roominventory r
            INNER JOIN room AS m ON m.room_id = r.room_id
            WHERE m.room_type LIKE '%$roomtype%'
            AND r.room_status = 'available'
            AND r.roominv_id NOT IN (SELECT b.roominv_id
                       FROM reserve b
                       WHERE NOT (b.chckout < '$chckin'
                                  OR b.chckin > '$chckout')) 
```

我希望 2 月 2 日作为下午的开始日期（酒店预订必须始终在中午 12 点之后开始）和 2 月 3 日作为我的结束日期（中午 12 点之前）

但在我当前的查询中，如果我选择 2 月 2 日作为开始日期，选择 2 月 3 日作为结束日期，在数据库中，它将显示为 2 天预订。

所以我的问题是：我将如何查询客户仍然可以从已经预订的房间中选择结束日期？

我实际上看到一个网站有一个日期选择器，有点像 AM/PM [http://reservations.directwithhotels.com/reservation/selectDates/148/campaign/ew](http://reservations.directwithhotels.com/reservation/selectDates/148/campaign/ew)

但是我对javascript很陌生。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T15:21:59.497

根据 and 的数据类型`chckout`，`chckin`您可能只想使用`BETWEEN`运算符，或使用包含相等运算符 ( `>=`, `<=`)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T15:32:15.427

我认为您只需将`where`条款更改为：

```
WHERE NOT (b.chckout < '$chckin'
                              OR b.chckin >= '$chckout') 
```

这假定 chckin 和 chckout 存储为日期。否则，您需要将它们转换为日期，这取决于数据库。. . 这里有一些方法：

```
date(b.chckin)
cast(b.chckin as date)
trunc(b.chckin) 
```

# c++ - C++ 中严格 typedef 的成语

> ID：15005809
> 
> 赞同：10
> 
> 时间：2013-02-21T15:20:15.823
> 
> 标签：c++, templates, types, idioms

C++ 中是否有严格类型定义的习惯用法，可能使用模板？

就像是：

```
template <class base_type, int N> struct new_type{
    base_type p;
    explicit new_type(base_type i = base_type()) : p(i) {}
};

typedef new_type<int, __LINE__> x_coordinate;
typedef new_type<int, __LINE__> y_coordinate; 
```

所以我可以使这样的事情成为编译时错误：

```
x_coordinate x(5);
y_coordinate y(6);

x = y; // whoops 
```

`__LINE__`那里看起来可能很麻烦，但我不希望仅仅为了保持每种类型的唯一性而手动创建一组常量。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-21T16:42:45.623

我在我的项目中使用了类似的东西。只有我使用类型标记而不是 int。在我的特定应用程序中运行良好。

```
template <class base_type, class tag> class new_type{     
  public:   
    explicit new_type(base_type i = base_type()) : p(i) {}

    //
    // All sorts of constructors and overloaded operators
    // to make it behave like built-in type
    //

  private:
     base_type p;
};

typedef new_type<int, class TAG_x_coordinate> x_coordinate;
typedef new_type<int, class TAG_y_coordinate> y_coordinate; 
```

注意 TAG_* 类不需要在任何地方定义，它们只是标签

```
x_coordinate x (1);
y_coordinate y (2);

x = y; // error 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-21T15:24:20.447

没有。有人提议将其纳入下一个标准（C++14，或者可能是 C++17），但在 C++11 中没有。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-02-21T15:51:11.730

使用 C++11：

```
#include <stdio.h>

struct dummy {};

struct NotMineType
{
    NotMineType(dummy) {}
};

template <int N>
struct type_scope
{
    struct MyOwnType
    {
    };

    struct ConvertedToMineType : NotMineType
    {
        template <typename ...Args>
        ConvertedToMineType(Args... args) : NotMineType(args...) {};
    };

    enum myint : int {};
};

typedef type_scope<0>::MyOwnType x1;
typedef type_scope<1>::MyOwnType x2;

typedef type_scope<0>::ConvertedToMineType y1;
typedef type_scope<1>::ConvertedToMineType y2;

typedef type_scope<0>::myint i1;
typedef type_scope<1>::myint i2;

void foo(x1) { printf("x1\n"); }
void foo(x2) { printf("x2\n"); }
void foo(y1) { printf("y1\n"); }
void foo(y2) { printf("y2\n"); }
void foo(i1) { printf("i1\n"); }
void foo(i2) { printf("i2\n"); }

int main()
{
    foo(x1());
    foo(x2());
    foo(y1(dummy()));
    foo(y2(dummy()));
    foo(i1());
    foo(i2());
} 
```

**输出：**

```
x1
x2
y1
y2
i1
i2 
```

**编译器：**

视觉工作室 2015，GCC 4.8.x

# php - 代码重复 (PHP)

> ID：15005813
> 
> 赞同：1
> 
> 时间：2013-02-21T15:20:24.920
> 
> 标签：php, mysql, sql, repeat

我试图不重复代码。有什么办法可以让这个工作，所以我不必为三个人写三遍代码？原谅我的无知：我是初学者。

```
$c1 = "Rufus T Firefly";
$c2 = "Chicolini";
$c3 = "Pinky";

for ($i=1; $i<=3; $i++){
  $result = mysqli_query($dbc, ' SELECT * FROM voters WHERE choice = "'. $c($i).'" ');
  //create table...
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-21T15:21:36.870

采用[`IN()`](http://dev.mysql.com/doc/refman/5.0/en/comparison-operators.html#function_in)

```
$sql = "SELECT * FROM voters WHERE choice IN('Rufus T Firefly', 'Chicolini', 'Pinky')"
$result = mysqli_query($dbc, $sql); 
```

现在不需要循环或数组（生成您的查询）。

# excel - 如果它是空的，如何删除整个列

> ID：15005824
> 
> 赞同：1
> 
> 时间：2013-02-21T15:20:54.297
> 
> 标签：excel, excel-2010, vba

我有列第 1 行是标题..

```
IF Column C doesn't have data in entire column then delete C D E F
IF Column D doesn't have data in entire column then delete D E F
IF Column E doesn't have data in entire column then delete E F
IF Column F doesn't have data in entire column then delete F 
```

以同样的方式前往 NN

```
IF Column G doesn't have data in entire column then delete G H I J K L M N 
IF Column H doesn't have data in entire column then delete H I J K L M N 
IF Column I doesn't have data in entire column then delete I J K L M N 
IF Column J doesn't have data in entire column then delete J K L M N 
IF Column K doesn't have data in entire column then delete K L M N 
IF Column L doesn't have data in entire column then delete L M N 
IF Column M doesn't have data in entire column then delete M N 
IF Column N doesn't have data in entire column then delete N

A   B   C   D   E   F   G   H   I   J   K   L   M   N   O   P   Q   R
TI1 TE2 TT1 TT2 TT3 TT4 NN1 NN2 NN3 NN4 NN5 NN6 NN7 NN8 CMT K2  K3  
BLAH    BLAH 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-21T15:35:23.220

我会通过添加一个额外的行来解决这个问题（你以后可以随时隐藏它）。

假设您的标题在第 1 行，然后在第 2 行中添加一个额外的（帮助）行。

*   在 C2 中，输入以下公式（替换`C30`为适合您的值）：

    `=COUNTA(C3:C30)`

*   在 D2 中，输入以下公式：

    `=IF(C2=0,0,COUNTA(D3:D30))`

*   将该公式拖到 E & F

*   在 G 中重做 C 的公式

*   在 H 中重做 D 的公式并拖到 N

... ETC。

现在只需编写一个非常简单的宏来删除 row2 的值 = 0 的任何列。

这对我来说似乎是最简单的方法，但还有很多其他方法。

希望这可以帮助！！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T17:11:00.540

这个宏做你的第一点——第二阶段将非常相似。

您需要将`5`s 更改为表格的长度。

`GoTo`一般不喜欢，但我在这段代码中使用了它。

```
Sub firstbit()

If Excel.WorksheetFunction.CountA(ActiveSheet.Range("C2:C5")) = 0 Then
    Excel.ActiveSheet.Range("C2:F5").clearcontents
    GoTo FirstStageComplete:
End If
If Excel.WorksheetFunction.CountA(ActiveSheet.Range("D2:D5")) = 0 Then
    Excel.ActiveSheet.Range("D2:F5").clearcontents
    GoTo FirstStageComplete:
End If
If Excel.WorksheetFunction.CountA(ActiveSheet.Range("E2:E5")) = 0 Then
    Excel.ActiveSheet.Range("E2:F5").clearcontents
    GoTo FirstStageComplete:
End If
If Excel.WorksheetFunction.CountA(ActiveSheet.Range("F2:F5")) = 0 Then
    Excel.ActiveSheet.Range("F2:F5").clearcontents
End If
FirstStageComplete:

End Sub 
```

# html - 使用#include 文件时不显示本地语言字符

> ID：15005826
> 
> 赞同：0
> 
> 时间：2013-02-21T15:20:57.757
> 
> 标签：html, asp-classic, server-side-includes

因此，我设置网站的方式是根据 QueryString 值将用户重定向到内容页面。
但标题保持不变。
我遇到的问题是本地语言字符。
即使在我检查源代码时存在 meta-equiv，它们也不会显示在内容页面中。
这里可能有什么问题？我该如何解决？

太感谢了..

```
<%
    Section = Request.QueryString("Section")

    If Section = "" then 
%>
<!-- #Include File="home/index.asp" -->
<%
    ElseIf Section = "home" then 
%>
<!-- #Include File="home/index.asp" -->
<%
    ElseIf Section = "friends" then 
%> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T17:02:51.703

你可以尝试两件事

1.  在记事本中打开您的页面并打开另存为框。显示什么编码？如果选择 ANSI，则将其更改为 UTF-8

2.  在您的 asp 页面顶部添加 <%@CODEPAGE="65001"%>

编辑 - 我尝试添加以下内容作为评论，但我无法格式化

你看到的是 giriÅŸ 而不是 giriş

查看您的源代码 - 它包含

```
<meta http-equiv="Content-Type" content="text/html; charset=windows-1254" />
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-9">    
<meta http-equiv="content-type" content="application/xhtml+xml; charset=UTF-8" /> 
```

它应该包含

```
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> 
<meta http-equiv="content-type" content="application/xhtml+xml; charset=UTF-8" /> 
```

# grails - 更改 Grails REST 格式 /controller/ /

> ID：15005828
> 
> 赞同：4
> 
> 时间：2013-02-21T15:21:01.967
> 
> 标签：grails

我昨天搞砸了这个，惨遭失败。我想转换：

```
"/$controller/$action?/$id?" 
```

至

```
#in psudo
"/$controller/$id?/$action?"
#ideal regex
"\/(\w+)(\/\d+)?(\/\w+)?" 
```

最明显的方法失败了`"/$controller/$action?/$id?"`

我可以编写正则表达式来做到这一点，但我无法找到使用真正正则表达式的方法（我找到了[RegexUrlMapping](http://grails.org/doc/2.1.3/api/org/codehaus/groovy/grails/web/mapping/RegexUrlMapping.html)但找不到如何使用它），也找不到有关如何分配组的文档一个变量。

我的问题是两部分：

1.  如何使用真正的正则表达式定义 URL 资源。
2.  如何将“组”绑定到变量。换句话说，如果我定义一个正则表达式，我如何将它绑定到一个变量，如 $controller、$id、$action

我还希望能够支持 .json 表示法 /user/id.json

* * *

我尝试过的其他事情，我认为这会起作用：

```
"/$controller$id?$action?"{
        constraints {
            controller(matches:/\w+/)
            id(matches:/\/\d+/)
            action(matches:/\/\w+/)
        }
    } 
```

也试过：

```
"/$controller/$id?/$action?"{
        constraints {
            controller(matches:/\w+/)
            id(matches:/\d+/)
            action(matches:/\w+/)
        }
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-21T16:50:52.457

解决这个问题的 grails 方法是设置

```
grails.mime.file.extensions = true 
```

在`Config.groovy`. 这将导致 Grails 在应用 URL 映射之前去除文件扩展名，但使其可供以下用户使用[`withFormat`](http://grails.org/doc/latest/ref/Controllers/withFormat.html)

```
def someAction() {
  withFormat {
    json {
      render ([message:"hello"] as JSON)
    }
    xml {
      render(contentType:'text/xml') {
        //...
      }
    }
  } 
```

为此，您只需要一个 URL 映射`"$controller/$id?/$action?"`

我不知道在 URL 映射中以您希望的方式使用正则表达式的任何方法，但是您可以使用以下事实来获得正向映射工作，即您可以为在运行时评估的参数值指定闭包并访问其他参数：

```
"$controller/$a?/$b?" {
  action = { params.b ?: params.a }
  id = { params.b ? params.a : null }
} 
```

它说“如果`b`已设置，则将其用作操作并`a`用作`id`，否则`a`用作操作并设置`id`为`null`”。但这不会给你一个很好的反向映射，即`createLink(controller:'foo', action:'bar', id:1)`不会产生任何合理的东西，你必须使用`createLink(controller:'foo', params:[a:1, b:'bar'])`

**编辑**

您可以尝试的第三种可能性是将

```
"/$controller/$id/$action"{
    constraints {
        controller(matches:/\w+/)
        id(matches:/\d+/)
        action(matches:/\w+/)
    }
} 
```

映射与互补

```
"/$controller/$action?"{
    constraints {
        controller(matches:/\w+/)
        action(matches:/(?!\d+$)\w+/)
    }
} 
```

使用负前瞻来确保两个映射不相交。

# javascript - PhantomJS 使用太多线程

> ID：15005830
> 
> 赞同：7
> 
> 时间：2013-02-21T15:21:02.943
> 
> 标签：javascript, web-crawler, phantomjs

我编写了一个 PhantomJS 应用程序来爬取我构建的网站并检查要包含的 JavaScript 文件。JavaScript 类似于谷歌，其中一些内联代码加载到另一个 JS 文件中。该应用程序会查找其他 JS 文件，这就是我使用 Phantom 的原因。

**预期的结果是什么？**

控制台输出应读取大量 URL，然后判断脚本是否已加载。

**到底发生了什么？**

控制台输出将按预期读取大约 50 个请求，然后开始吐出此错误：

```
2013-02-21T10:01:23 [FATAL] QEventDispatcherUNIXPrivate(): Can not continue without a thread pipe
QEventDispatcherUNIXPrivate(): Unable to create thread pipe: Too many open files 
```

这是打开页面并搜索脚本的代码块，包括：

```
page.open(url, function (status) {
    console.log(YELLOW, url, status, CLEAR);
    var found =  page.evaluate(function () {
      if (document.querySelectorAll("script[src='***']").length) {
        return true;
      } else { return false; }
    });

    if (found) {
      console.log(GREEN, 'JavaScript found on', url, CLEAR);
    } else {
      console.log(RED, 'JavaScript not found on', url, CLEAR);
    }
    self.crawledURLs[url] = true;
    self.crawlURLs(self.getAllLinks(page), depth-1);
  }); 
```

crawledURLs 对象只是我已经爬过的 url 的一个对象。crawlURLs 函数只是遍历 getAllLinks 函数中的链接，并在所有链接上调用 open 函数，这些链接具有爬虫启动的域的基本域。

**编辑**

我将代码的最后一块修改如下，但仍然有同样的问题。我已将 page.close() 添加到文件中。

```
if (!found) {
  console.log(RED, 'JavaScript not found on', url, CLEAR);
}
self.crawledURLs[url] = true;
var links = self.getAllLinks(page);
page.close();
self.crawlURLs(links, depth-1); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-21T16:02:55.110

从文档中：

> 由于一些技术限制，网页对象可能不会被完全垃圾收集。当反复使用同一个对象时，经常会遇到这种情况。

解决方案是在正确的时间显式调用`close()`网页对象（即`page`在许多情况下）。

一些包含的示例，例如[follow.js](https://github.com/ariya/phantomjs/blob/master/examples/follow.js)，演示了具有显式关闭的多个页面对象。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-08-06T17:30:48.383

### 打开文件限制。

即使正确关闭文件，您仍可能遇到此错误。

在搜索了互联网之后，我发现您需要**增加单个进程允许打开的文件数量的限制**。就我而言，我正在生成包含数百到数千页的 PDF。

根据您正在运行的系统，有不同的方法可以调整此设置，但**以下是在*Ubuntu*服务器**上对我有用的方法：

将以下内容添加到末尾**`/etc/security/limits.conf`**：

```
# Sets the open file maximum here.
# Generating large PDFs hits the default ceiling (1024) quickly. 
*    hard nofile 65535
*    soft nofile 65535
root hard nofile 65535 # Need these two lines because the wildcards (above)
root soft nofile 65535 # are not applied to the root user as well. 
```

`ulimit`可以在[此处](http://docs.mongodb.org/manual/reference/ulimit/#ulimit)找到该命令的一个很好的参考。

我希望这能让一些人走上正轨。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-02-20T06:38:20.983

在我的 ruby​​ 程序中运行多个线程时出现此错误。我正在使用 Capybara-poltergeist 运行 phantomjs，每个线程都在访问一个页面，打开同一个 CSV 文件并写入它。

我能够通过使用`Mutex`类来修复它。

```
lock = Mutex.new
lock.synchronize do
    CSV.open("reservations.csv", "w") do |file|
        file << ["Status","Name","Res-Code","LS-Num","Check-in","Check-out","Talk-URL"]
          $status.length.times do |i|
              file << [$status[i],$guest_name[i],$reservation_code[i],$listing_number[i],$check_in[i],$check_out[i], $talk_url[i]]
          end
        end
        puts "#{user.email} PAGE NUMBER ##{p+1} WRITTEN TO CSV"
    end
end 
```

# java - 扫描时如何忽略空白

> ID：15005831
> 
> 赞同：2
> 
> 时间：2013-02-21T15:21:05.343
> 
> 标签：java, whitespace, token, java.util.scanner

我有一个文件：

```
12345678;ABC 123456A12345678;45678945 
```

这就是我所做的：

```
Scanner s = new Scanner(new File(testCase.getFileName()));
while (s.hasNext()) {
    String[] lineItems = s.next().split(";");
} 
```

输出：

```
12345678;ABC
123456A12345678;
45678945 
```

期望的输出：

```
12345678
ABC 123456A12345678
45678945 
```

我希望它被`"ABC 123456A12345678"`视为一个单一的标记，并且在遇到空格时不会中断。

我该怎么办？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-21T15:29:06.290

从[这里](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/Scanner.html)：

> “扫描器使用分隔符模式将其输入分解为标记，默认情况下匹配空格”。

因此，您的程序首先根据空格拆分文件，然后`.split(";");`将它们拆分为`;`.

您需要将分隔符设置`;`如下：

```
Scanner s = new Scanner(new File(testCase.getFileName())));
s.useDelimiter(";");
while (s.hasNext()) {
   System.out.println(s.next());
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T17:02:10.597

你可以使用这样的东西：`String[] items = line.split(";");`

请考虑以下示例以更好地理解：假设您的硬盘驱动器中有一个名为“data.txt”的文件（例如“C:/Users/sarath_sivan/Desktop”），其中包含您的记录，如下所示：

```
12345678;ABC 123456A12345678;45678945
12345678;ABC 123456A12345678;45678945
12345678;ABC 123456A12345678;45678945
12345678;ABC 123456A12345678;45678945
12345678;ABC 123456A12345678;45678945
12345678;ABC 123456A12345678;45678945
12345678;ABC 123456A12345678;45678945
12345678;ABC 123456A12345678;45678945
12345678;ABC 123456A12345678;45678945
12345678;ABC 123456A12345678;45678945 
```

并且您希望在使用 java.util.Scanner 类进行扫描时忽略空格。

首先，我们可以创建一个模型类来保存您的数据。你可以使用这样的东西：

```
package com.stack.overflow.works.model;

/**
 * @author sarath_sivan
 */
public class Data {

    private String column1;
    private String column2;
    private String column3;

    public Data() {}

    public String getColumn1() {
        return column1;
    }

    public void setColumn1(String column1) {
        this.column1 = column1;
    }

    public String getColumn2() {
        return column2;
    }

    public void setColumn2(String column2) {
        this.column2 = column2;
    }

    public String getColumn3() {
        return column3;
    }

    public void setColumn3(String column3) {
        this.column3 = column3;
    }

} 
```

接下来，我们可以创建一个用于扫描目的的界面。包 com.stack.overflow.works.service；

```
/**
 * @author sarath_sivan
 */

public interface Scannable {

    abstract public void scan();

} 
```

接下来，我们可以通过创建一个实现接口的新类来实现业务逻辑

```
package com.stack.overflow.works.service;

import java.io.File;
import java.io.FileNotFoundException;
import java.util.ArrayList;
import java.util.List;
import java.util.Scanner;

import com.stack.overflow.works.model.Data;

/**
 * @author sarath_sivan
 */
public class FileScanner implements Scannable {

    private static final String SEMICOLON = ";";
    private static final String TAB_SPACE = "\t";
    private static final String FILE_NAME = "C:/Users/sarath_sivan/Desktop/data.txt";

    @Override
    public void scan() {
        File file = new File(FILE_NAME);
        Scanner scanner = null;
        List<Data> recordList = new ArrayList<Data>();
        Data data = null;
        try {
            scanner = new Scanner(file);
            while (scanner.hasNextLine()) {
                String line = scanner.nextLine();
                String[] items = line.split(SEMICOLON);
                data = new Data();
                data.setColumn1(items[0]);
                data.setColumn2(items[1]);
                data.setColumn3(items[2]);
                recordList.add(data);
            }
            displayRecords(recordList); /*Displaying your records*/
        } catch (FileNotFoundException e) {
            e.printStackTrace();
        }

    }

    private void displayRecords(List<Data> recordList) {
        System.out.println("*DISPLAYING YOUR RECORDS:*");
        System.out.println("COLUMN1" + TAB_SPACE + "COLUMN2" + TAB_SPACE + TAB_SPACE + "COLUMN3");
        for (Data data: recordList) {
            System.out.println(data.getColumn1() + TAB_SPACE + data.getColumn2() + TAB_SPACE + data.getColumn3());
        }
    }

} 
```

最后，我们可以创建一个服务或测试类来验证逻辑。包 com.stack.overflow.works.main；

```
import com.stack.overflow.works.service.FileScanner;
import com.stack.overflow.works.service.Scannable;

/**
 * @author sarath_sivan
 */
public class ScannerService {

    public static void main(String[] args) {
        Scannable fileScanner =  new FileScanner();
        fileScanner.scan();
    }

} 
```

现在，您可以运行生成如下输出的 ScannerService 类：

显示您的记录：

```
COLUMN1     COLUMN2             COLUMN3
------------------------------------------
12345678    ABC 123456A12345678 45678945
12345678    ABC 123456A12345678 45678945
12345678    ABC 123456A12345678 45678945
12345678    ABC 123456A12345678 45678945
12345678    ABC 123456A12345678 45678945
12345678    ABC 123456A12345678 45678945
12345678    ABC 123456A12345678 45678945
12345678    ABC 123456A12345678 45678945
12345678    ABC 123456A12345678 45678945
12345678    ABC 123456A12345678 45678945 
```

您可以在此处查看包结构![在此处输入图像描述](../Images/c6f0e41bed3fb9616a4187111324699b.png)

希望这可以帮助。谢谢！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-13T13:41:34.490

```
 LinkedList<Double> a = new LinkedList<Double>();
    File f = new File("C:/Users/etc.txt");
    BufferedReader in = new BufferedReader(new FileReader(f));
    String [] tmp=null;
    String line;
    while ((line = in.readLine()) != null) {
        if(line.trim().contains("   "))
             tmp = line.split(" ");
        a.add(Double.parseDouble(tmp[0].trim()));
    } 
```

# selenium - 使用 Selenium 进行浏览器插件测试

> ID：15005833
> 
> 赞同：17
> 
> 时间：2013-02-21T15:21:08.717
> 
> 标签：selenium, cross-browser, browser-plugin

我正在编写一个 web 应用程序，它有一个适用于 Firefox 和 chrome 的浏览器插件组件。我当前的测试系统使用通过 Selenium IDE 创建的一系列 Selenium 测试。

是否也可以安装、激活和删除用于 Firefox 和 chrome 的浏览器插件（可能还有其他浏览器）？

我认为最大的问题是安装/启用浏览器插件需要重新启动浏览器，我不确定这是否会通过 selenium 关闭。

通过访问内部站点链接到检测您的浏览器的 php 脚本，可以轻松处理插件的获取。

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2013-06-14T21:56:32.610

答案是**肯定**的，Selenium 2 支持（远程）安装浏览器扩展。

Chrome 和 Firefox WebDriver 支持远程安装扩展。以下是 Chrome 和 Firefox 的示例代码：

## 铬合金

```
File file = new File("extension.crx"); // zip files are also accepted
ChromeOptions options = new ChromeOptions();
options.addExtensions(file);

// Option 1: Locally.
WebDriver driver = new ChromeDriver(options);

// Option 2: Remotely
DesiredCapabilities capabilities = DesiredCapabilities.chrome();
capabilities.setCapability(ChromeOptions.CAPABILITY, options);
WebDriver driver = new RemoteWebDriver(new URL("http://localhost:4444/wd/hub"), capabilities); 
```

## 火狐

```
File file = new File("extension.xpi");
FirefoxProfile firefoxProfile = new FirefoxProfile();
firefoxProfile.addExtension(file);

// Option 1: Locally
WebDriver driver = new FirefoxDriver(firefoxProfile);

// Option 2: Remotely
DesiredCapabilities capabilities = DesiredCapabilities.firefox();
capabilities.setCapability(FirefoxDriver.PROFILE, firefoxProfile);
WebDriver driver = new RemoteWebDriver(new URL("http://localhost:4444/wd/hub"), capabilities); 
```

* * *

我还实现了 Opera 和 Safari 扩展的自动安装，它们已在上游合并：

*   OperaDriver：[https ://github.com/operasoftware/operadriver/pull/93](https://github.com/operasoftware/operadriver/pull/93)
*   SafariDriver：[https ://github.com/SeleniumHQ/selenium/pull/87](https://github.com/SeleniumHQ/selenium/pull/87)

## 歌剧

此 API 类似于 FirefoxDriver。

```
File file = new File("extension.oex"); // Must end with ".oex"
OperaProfile operaProfile = new OperaProfile();
operaProfile.addExtension(file);

// Option 1: Locally
WebDriver driver = new OperaDriver(operaProfile);

// Option 2: Remotely
DesiredCapabilities capabilities = DesiredCapabilities.opera();
capabilities.setCapability("opera.profile", operaProfile);
WebDriver driver = new RemoteWebDriver(new URL("http://localhost:4444/wd/hub"), capabilities); 
```

## 苹果浏览器

此 API 类似于 ChromeDriver。

```
File file = new File("extension.safariextz");
SafariOptions options = new SafariOptions();
options.addExtensions(file);

// Option 1: Locally.
WebDriver driver = new SafariDriver(options);

// Option 2: Remotely
DesiredCapabilities capabilities = DesiredCapabilities.safari();
capabilities.setCapability(SafariOptions.CAPABILITY, options);
WebDriver driver = new RemoteWebDriver(new URL("http://localhost:4444/wd/hub"), capabilities); 
```

## IE浏览器

祝你好运。

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2013-02-28T14:45:20.753

简短的回答：没有

安装浏览器扩展超出了 Selenium 的处理范围。

在 Chrome 中，当您想要添加插件或应用程序时，它会显示一个无法使用 Selenium “单击”的模式窗口。Chrome 不需要重新启动。

Firefox 具有相同的行为来提示扩展权限。

你可以尝试一些驻留在浏览器之外的东西来做你想做的事。Sikuli 可能会成功。

# iis-7 - IIS 7 中的嵌套自定义错误页面

> ID：15005837
> 
> 赞同：1
> 
> 时间：2013-02-21T15:21:15.700
> 
> 标签：iis-7, asp-classic, iis-7.5, custom-error-pages

. .

我正在尝试将 IIS 7 设置为使用自定义错误页面，但我遇到了一个似乎无法解决的问题。我几乎到处都在寻找这个问题的答案，但都一无所获。

这是交易：我打开 IIS，进入错误页面（注意：这是一个经典的 ASP 环境），然后打开编辑功能设置。我将路径类型设置为执行 URL 并设置路径（例如，假设它是“/errors/SomeError.asp”）。我还将它设置为“自定义错误页面”。

在大多数情况下，这似乎没问题，但这是我遇到麻烦的地方。

我相信你们都看到了页面部分加载的错误，并且错误出现在页面中间。（例如，你会看到你的页面模板，在中间的某个地方，你会看到你的“错误 500 ......”等等等等。）

我创建的错误页面（我上面提到的“/errors/SomeError.asp”）是一个完整的页面，包含模板和所有内容。

当页面中间发生错误时，它不会重定向到我的自定义错误页面。相反，页面是“嵌套的”——也就是说，整个页面出现在问题页面的中间——所以它看起来就像一个完整页面中的一个完整页面。

我希望它转到错误页面，而不是将错误页面嵌套在页面中。

我该如何解决这个问题？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T15:51:24.960

我只是回答了我自己的问题。

我没有将路径类型设置为“执行 URL”，而是将其设置为“重定向”。问题解决了。

# python - Python 2.7：奇怪的构造函数行为：更改错误的字段

> ID：15005841
> 
> 赞同：0
> 
> 时间：2013-02-21T15:21:26.863
> 
> 标签：python, python-2.7

在这段代码中：

```
# coding=utf-8

def print_tree(node, tree=0):
    print(u"|---" * tree + u"-> %s" % node)
    for kid in node.children:
        print_tree(kid, tree + 1)

class Person(object):
    parent = None
    first_name = None
    last_name = None
    children = []

    def __str__(self):
        return '%s %s' % (self.first_name, self.last_name)

    def __unicode__(self):
        return u'%s %s' % (self.first_name, self.last_name)

    def __init__(self, first_name, last_name, parent=None):
        if parent is not None:
            if not isinstance(parent, Person):
                raise AttributeError('`parent` is not `Person` type!')
            self.parent = parent
            self.parent.children.append(self)
        self.first_name = first_name
        self.last_name = last_name
        #self.children = []

root = Person('Alan', 'Smith')
p1 = Person('Barbara', 'Smith', root)
p2 = Person('Basia', 'Smith', root)
p3 = Person('Bary', 'Smith', root)

print_tree(root) 
```

如果我从`#self.children = []`示例中删除评论效果很好。但我不明白为什么我必须添加这一行？

在调试器中，我发现该行也`self.parent.children.append(self)`添加`self`到`self.children`

为什么 ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-21T15:28:18.260

`children`是一个类属性，你希望它是一个实例属性。您应该`children=[]`完全从类范围中删除，只在`__init__`方法中保留一个。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-21T15:27:54.543

在 python 中，当您在类级别声明一个属性时，这使其成为类属性（在类的所有实例之间共享）。在您的情况下，您需要实例属性。实例属性必须在构造函数（您的`self.children = []`）中创建。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-21T15:27:55.980

您遇到了问题，因为在您的代码`children`中是 a `class variable`（当您在类级别而不是实例级别访问它时引用它），而不是`instance variable`（对于每个实例都是唯一的）。

所以你必须添加类似的东西：

```
self.children = [] 
```

每次你`__init__`的实例`Person`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-21T15:28:04.250

您正在从对象实例中引用子项，因此您不能仅将其保留在类范围/层中。因此你需要`self.children = []`，因为否则你指的不是实例的孩子而是类。（后者的语法是`Person.children`）

# c# - 使用 EventHandler 更新主线程中的控件

> ID：15005851
> 
> 赞同：2
> 
> 时间：2013-02-21T15:22:00.957
> 
> 标签：c#, visual-studio-2008, event-handling, thread-safety, compact-framework2.0

我正在使用它从另一个线程更新主线程中的控件：

```
private void ShowHourGlassSafe(bool visible)
{
    this.Invoke((EventHandler)((s, ev) => pictureBoxHourGlass.Visible = visible));           
} 
```

我想知道这样做有什么影响，或者是否有失败的风险？

从许多例子中，我找不到这样的同一件事。

可能是它完全是错误的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-21T15:26:26.573

好吧，您选择了一个相当奇怪的代表来选择，因为您选择了一个具有两个参数的代表，尽管事实上不需要也不会提供任何参数。我不知道这是否会导致它崩溃，但它肯定无济于事。您最好使用不带参数且不返回值的委托，例如：

```
private void ShowHourGlassSafe(bool visible)
{
    this.Invoke((MethodInvoker)(() => pictureBoxHourGlass.Visible = visible));           
} 
```

除此之外，您正在做的事情的基本概念非常好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-21T15:38:34.833

这种代码的典型问题：

*   如果 UI 线程正在做一些不明智的事情，比如等待线程完成，你就会死锁。使用 Invoke 没有任何意义，它会阻塞工作线程而没有任何好处，只需使用 BeginInvoke。解决了潜在的死锁和不必要的延迟。

*   当 UI 关闭并且 pictureBoxHourGlass 被释放时，你会崩溃。在允许 UI 关闭之前确保线程不再运行是很容易被忽视的。仅仅显示一个沙漏是不够的，您还必须采取对策来防止用户关闭 UI。或者以其他方式将其与首先取消线程的方式互锁

*   当沙漏出现而他没有做任何事情来要求完成某事时，用户通常会感到困惑。99% 正确的情况是您在 UI 线程中显示带有代码的沙漏，然后启动线程。并在线程完成时再次隐藏它。最容易使用 BackgroundWorker 或 Task 类，它们可以在工作完成后在 UI 线程上运行代码。

支持 Action 委托类型以保持一致性：

```
 private void ShowHourGlassSafe(bool visible) {
        this.BeginInvoke(new Action(() => something.Visible = visible));
    } 
```

# jquery - jQuery UI Datepicker Inline - 点击提交表单

> ID：15005857
> 
> 赞同：3
> 
> 时间：2013-02-21T15:22:11.007
> 
> 标签：jquery, jquery-ui, jquery-plugins, jquery-ui-datepicker

我正在尝试在日期选择器上单击日期时提交表单。我已成功提交，但无法将所选日期传递给表单的隐藏字段。因此，表单提交，但日期未发送（

我相信它一定很简单，但我对 js 没有经验，所以感谢任何帮助。

这是代码：

```
<script type="text/javascript">
  $(document).ready($(function(){

    var $hiddenInput = $('#hiddenFieldID');

    $('#datepicker').datepicker({ inline: true })
     .bind('click', function(){ $('#myFormID').submit();})
     .bind('hiddenFieldID',function(e, hiddenFieldID, $td) { $hiddenInput.val(hiddenFieldID.asString()); });
      }));
 </script>

<div id="datepicker"></div>

<form id="myFormID" action="index.php" method="GET">
<input type="hidden" name="date" id="hiddenFieldID" value="">
</form> 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-02-21T15:39:25.640

`datepicker`实际上有一些选项可以帮助您解决这个问题。尝试以下操作：

```
$('#datepicker').datepicker({
    inline : true,
    altField : '#hiddenFieldID',
    onSelect : function(){
        $('#myFormID').submit();   
    }
}); 
```

> **altField**：一个输入元素，将使用从日期选择器中选择的日期进行更新。使用 altFormat 选项更改此字段中日期的格式。如果没有备用字段，请留空。
> 
> **onSelect**：选择日期选择器时调用。该函数接收选定的日期作为文本和 datepicker 实例作为参数。这指的是关联的输入字段。

访问完整的 API 以获取与以下相关的更多选项和事件：http `datepicker`: [//api.jqueryui.com/datepicker/](http://api.jqueryui.com/datepicker/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-02-05T00:24:23.190

我为同样的问题而战。就我而言，我的开始和结束都在一张桌子内。将表格移到表格外解决了这个问题。

基因

# internet-explorer - 单元格属性在 Internet Explorer 上泄漏内存？

> ID：15005858
> 
> 赞同：0
> 
> 时间：2013-02-21T15:22:14.327
> 
> 标签：internet-explorer, debugging, memory-leaks, cross-browser, appendchild

[Microsoft 文档](http://msdn.microsoft.com/en-gb/library/windows/apps/hh453026.aspx)和[W3C 文档](http://www.w3.org/TR/DOM-Level-2-HTML/html.html#ID-67349879)均未提及泄漏。

它发生在动态创建的行上。这对我们来说是个问题，因为我们有一个单页 Web 应用程序，其中的表格通过 ajax 定期更新，最终 iexplore 消耗了所有内存并且 Windows 死掉了。

重现：

```
function process() {
  var row = document.createElement('tr');
  var cell = document.createElement('td');
  var text = document.createTextNode();

  // doesn't matter order of these lines:
  row.appendChild(cell);
  cell.appendChild(text);

  // this leaks on IE8/9:
  var x = row.cells;

  // this alternative doesn't:
  //var x = row.getElementsByTagName("td");

  setTimeout(process, 10);
}

process(); 
```

[http://jsfiddle.net/5wzW2/1/](http://jsfiddle.net/5wzW2/1/) （jsfiddle 站点在 IE8 上不起作用，因此发布了上面的代码）。

在任务管理器中观看 iexplore 的内存使用量每分钟增加大约 1 MB。FF18/Chrome24 中没有。

有什么想法为什么，或者最好怎么做？

[Microsoft 的错误报告页面](http://connect.microsoft.com/IE)似乎已损坏。我的解决方法是用 替换`.cells`，`.getElementsByTagName("td")`例如在[tablesorter](https://github.com/Mottie/tablesorter)插件中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-18T19:48:29.053

存在对和DOM 对象的[循环引用](http://technet.microsoft.com/en-us/dd361842)，因为它们在不在文档树中时引用自己：`row``cell`

```
var row = document.createElement('tr');
row.appendChild(cell); 
```

此外，对该`cells`属性的调用返回一个[IHTMLElementCollection](http://technet.microsoft.com/en-us/windows/aa741775)

在 IE10 中存在内存泄漏错误：

*   [在 Internet Explorer 10 的应用程序中使用枚举器对象时发生内存泄漏](http://support.microsoft.com/kb/2880281)

# performance - 静态成员约束函数的性能

> ID：15005860
> 
> 赞同：10
> 
> 时间：2013-02-21T15:22:22.790
> 
> 标签：performance, generics, f#

我正在尝试学习 F# 中的静态成员约束。通过阅读[Tomas Petricek 的博客文章](http://tomasp.net/blog/fsharp-generic-numeric.aspx)，我了解到编写一个`inline`“仅使用本身使用静态成员约束编写的操作”的函数将使我的函数对于满足这些约束的所有数字类型都能正常工作。[这个问题](https://stackoverflow.com/questions/3754862/use-of-inline-in-f/3760485)表明它的`inline`工作方式与 c++ 模板有些相似，所以我没想到这两个函数之间有任何性能差异：

```
let MultiplyTyped (A : double[,]) (B : double[,]) =
    let rA, cA = (Array2D.length1 A) - 1, (Array2D.length2 A) - 1
    let cB = (Array2D.length2 B) - 1
    let C = Array2D.zeroCreate<double> (Array2D.length1 A) (Array2D.length2 B)
    for i = 0 to rA do
        for k = 0 to cA do
            for j = 0 to cB do
                C.[i,j] <- C.[i,j] + A.[i,k] * B.[k,j]
    C

let inline MultiplyGeneric (A : 'T[,]) (B : 'T[,]) =
    let rA, cA = Array2D.length1 A - 1, Array2D.length2 A - 1
    let cB = Array2D.length2 B - 1
    let C = Array2D.zeroCreate<'T> (Array2D.length1 A) (Array2D.length2 B)
    for i = 0 to rA do
        for k = 0 to cA do
            for j = 0 to cB do
                C.[i,j] <- C.[i,j] + A.[i,k] * B.[k,j]
    C 
```

然而，将两个 1024 x 1024 矩阵相乘，`MultiplyTyped`在我的机器上平均需要 2550 毫秒，而`MultiplyGeneric`大约需要 5150 毫秒。我最初认为这`zeroCreate`是通用版本的错误，但是将该行更改为下面的行并没有什么不同。

```
let C = Array2D.init<'T> (Array2D.length1 A) (Array2D.length2 B) (fun i j -> LanguagePrimitives.GenericZero) 
```

有什么我在这里想念的东西来做`MultiplyGeneric`一样的`MultiplyTyped`吗？或者这是预期的？

**编辑**：我应该提一下，这是 VS2010，F# 2.0，Win7 64bit，发布版本。**平台目标是 x64**（用于测试更大的矩阵） - 这会有所不同：x86 为这两个函数产生相似的结果。

奖励问题：推断的类型`MultiplyGeneric`如下：

```
val inline MultiplyGeneric :
   ^T [,] ->  ^T [,] ->  ^T [,]
    when ( ^T or  ^a) : (static member ( + ) :  ^T *  ^a ->  ^T) and
          ^T : (static member ( * ) :  ^T *  ^T ->  ^a) 
```

`^a`类型从何而来？

**编辑 2**：这是我的测试代码：

```
let r = new System.Random()
let A = Array2D.init 1024 1024 (fun i j -> r.NextDouble())
let B = Array2D.init 1024 1024 (fun i j -> r.NextDouble())

let test f =
    let sw = System.Diagnostics.Stopwatch.StartNew()
    f() |> ignore
    sw.Stop()
    printfn "%A" sw.ElapsedMilliseconds

for i = 1 to 5 do
    test (fun () -> MultiplyTyped A B)

for i = 1 to 5 do
    test (fun () -> MultiplyGeneric A B) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-21T16:39:39.333

我想看看你的基准。我没有得到相同的结果（VS 2012 F# 3.0 Win 7 64 位）。

```
let m = Array2D.init 1024 1024 (fun i j -> float i * float j)

let test f =
  let sw = System.Diagnostics.Stopwatch.StartNew()
  f() |> ignore
  sw.Stop()
  printfn "%A" sw.Elapsed

test (fun () -> MultiplyTyped m m)
> 00:00:09.6013188

test (fun () -> MultiplyGeneric m m)
> 00:00:09.1686885 
```

用 Reflector 反编译，函数看起来是一样的。

关于您的最后一个问题，推断出限制最少的约束。在这一行

```
C.[i,j] <- C.[i,j] + A.[i,k] * B.[k,j] 
```

因为 的结果类型`A.[i,k] * B.[k,j]`未指定，并且立即传递给`(+)`，所以可能涉及额外的类型。如果要收紧约束，可以将该行替换为

```
let temp : 'T = A.[i,k] * B.[k,j]
C.[i,j] <- C.[i,j] + temp 
```

这会将签名更改为

```
val inline MultiplyGeneric :
  A: ^T [,] -> B: ^T [,] ->  ^T [,]
    when  ^T : (static member ( * ) :  ^T *  ^T ->  ^T) and
          ^T : (static member ( + ) :  ^T *  ^T ->  ^T) 
```

编辑

使用您的测试，输出如下：

```
//MultiplyTyped
00:00:09.9904615
00:00:09.5489653
00:00:10.0562346
00:00:09.7023183
00:00:09.5123992
//MultiplyGeneric
00:00:09.1320273
00:00:08.8195283
00:00:08.8523408
00:00:09.2496603
00:00:09.2950196

```

这是[对 ideone 的相同测试](http://ideone.com/zXPqSK)（在时间限制内进行了一些小的更改：512x512 矩阵和一次测试迭代）。它运行 F# 2.0 并产生类似的结果。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-21T17:10:25.333

好问题。我将首先回答简单的部分：这`^a`只是自然泛化过程的一部分。想象一下你有一个这样的类型：

```
type T = | T with
    static member (+)(T, i:int) = T
    static member (*)(T, T) = 0 
```

然后你仍然可以将你的`MultiplyGeneric`函数与这种类型的数组一起使用：将元素相乘`A`并`B`得到`int`s，但这没关系，因为你仍然可以将它们添加到元素中`C`并取回类型的值`T`以存储回`C`.

至于你的表现问题，恐怕我没有很好的解释。您的基本理解是正确的 - using `MultiplyGeneric`with `double[,]`arguments 应该等同于 using `MultiplyTyped`。如果您使用 ildasm 查看编译器为以下 F# 代码生成的 IL：

```
let arr = Array2D.zeroCreate 1024 1024
let f1 = MultiplyTyped arr
let f2 = MultiplyGeneric arr

let timer = System.Diagnostics.Stopwatch()
timer.Start()

f1 arr |> ignore

printfn "%A" timer.Elapsed
timer.Restart()

f2 arr |> ignore

printfn "%A" timer.Elapsed 
```

然后您可以看到编译器确实为它们中的每一个生成了相同的代码，将内联代码`MultipyGeneric`放入内部静态函数中。我在生成的代码中看到的唯一区别是本地人的名字，当从命令行运行时，我得到大致相等的经过时间。但是，从 FSI 运行时，我看到了与您报告的类似的差异。

我不清楚为什么会这样。在我看来，有两种可能性：

1.  FSI 的代码生成可能与静态编译器稍有不同
2.  CLR 的 JIT 编译器对运行时生成的代码的处理方式可能与编译后的代码略有不同。例如，正如我在上面提到的那样，我的代码`MultiplyGeneric`实际上使用了一个包含内联主体的内部方法。也许 CLR 的 JIT 处理公共方法和内部方法之间的差异时，它们在运行时生成时与在静态编译代码中时不同。

# javascript - 平滑滚动 - 不一直滚动到锚标记

> ID：15005862
> 
> 赞同：0
> 
> 时间：2013-02-21T15:22:25.907
> 
> 标签：javascript, html

我正在一个网站上工作，我决定使用带有固定侧边栏导航的平滑滚动。但是突然间，当我开始添加内容时，它并没有一直向下滚动到我的#contact 锚标记。任何想法为什么会这样做？这似乎是跨 IE、FF 和 Chrome 的问题。

[http://encorevisions.com/proofsites/finaldrive/](http://encorevisions.com/proofsites/finaldrive/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T15:32:01.537

div #females 似乎有问题，有浮动吗？如果不是，为什么有一个明确的：两者都在最后。

我相信浮动有问题，因为如果您对您的网站进行启动并悬停在 div #females 上，似乎其中没有任何内容。这主要发生在浮动而不是清除

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T15:30:41.347

里面的所有`<li>`元素`#females`都是浮动的。因为该部分中的列表后面没有非浮动元素，所以它在`<h2>`. 这是该部分的`#contact`开始位置，也是您锚定的位置让您滚动到的位置。

在列表元素上使用`display: inline-block`代替`float: left`或在列表后添加一个元素`clear: both;`来解决此问题。

# c# - 如何打开一个巨大的 HTML 文件或将其拆分为可管理的块？

> ID：15005863
> 
> 赞同：-1
> 
> 时间：2013-02-21T15:22:26.543
> 
> 标签：c#, html

因此，我制作了一个应用程序，它可以交叉检查数据库中的信息，将其与 Excel 表格进行比较，最终结果是一个巨大的 html 文件。以前我将每个 HTML 文件分开，但是当我尝试将它们全部打印出来（2 面）时，它无法批量正确打印，所以我必须手动完成。

HTML 代码如下所示：

```
<html>
<head></head>
<body>
....random form crap
</body>
</html>
<html>
<head></head>
<body>
.... etc
</body>
</html> 
```

有成千上万个。我要么需要：只需打开这个文件（它是 84mb 并且我尝试过的每个浏览器都崩溃了）并打印整个文件。或者把它分成大约 5mb 的小块，这样我就可以把它们打印出来。

我很感激你们对我如何做到这一点的任何建议！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T15:25:39.557

尝试使用一些 linux 工具。例如[http://www.howtogeek.com/howto/ubuntu/split-a-text-file-in-half-or-any-percentage-on-ubuntu-linux/](http://www.howtogeek.com/howto/ubuntu/split-a-text-file-in-half-or-any-percentage-on-ubuntu-linux/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-21T15:27:35.620

由于这是标记为 C#，我将假设您想在 Windows 上完成此操作。

如果您这样做一次并想要一个实用的解决方案，请安装 Cygwin 并使用`split -p "<html>"`.

如果您需要 C# 中的可重复解决方案，请打开文件并逐行读取，将每一行输出到一个新文件（不要忘记添加 CRLF 字符！）。每次遇到`<html>`关闭要输出到的文件并打开一个新文件时，您将输出重定向到该文件。

# javascript - 自动对焦后触发 Jquery 函数

> ID：15005867
> 
> 赞同：0
> 
> 时间：2013-02-21T15:22:35.127
> 
> 标签：javascript, jquery, triggers, focus

自动对焦后是否可以触发功能？我试过了，但是当我的 textarea 获得自动对焦时，我需要点击离开，然后再次点击我的 textarea 以触发该功能

我的代码是：

```
$('#test').focus();
$('#test').focus(function() {
  alert('ok');
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-21T15:24:34.950

尝试交换代码。第一次调用时，您的事件未附加到测试元素`focus()`

```
$('#test').focus(function() {
  alert('ok');
});
$('#test').focus(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-21T15:24:46.653

这是因为您在设置焦点**后设置触发器。**

重新排列您的代码，这将正常工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-21T15:28:46.343

.focus() 方法根据传递的参数有两种不同的含义。

在你的第一个声明中。

```
$('#test').focus(); 
```

这是将焦点设置到具有 ID 测试的元素。

你的第二个陈述虽然

```
$('#test').focus(function() {
   alert('ok');
}); 
```

这里发生的是 jQuery 将事件处理程序附加到元素的焦点事件。我建议在加载 DOM 时添加事件处理程序，然后在需要时调用 .focus() 事件（这将触发警报）。

```
$(function(){
   $('#test').focus(function() {
       alert('ok');
   });
}); 
```

# c++ - 我被困在自定义链表上

> ID：15005879
> 
> 赞同：0
> 
> 时间：2013-02-21T15:22:58.803
> 
> 标签：c++, arrays

我应该在不使用结构的情况下创建一个链表，而只是使用数组。一切都按照讲师的要求进行，除了 Tom 应该是列表的末尾，并且需要显示 if 语句。这是我唯一不能上班的事情。在此先感谢您的帮助。

```
#include<iostream>
#include<string>
using namespace std;

int main()
{
    int position[10] = {0,1,2,3,4,5,6,7,8,9};
    string names[10] = {"dick", "Harry", "Sam", "Tom"};
    int link[10] = {1, 2, 3, 99, 5, 6, 7, 8, 9, 10, };
    int stkptr = 0;

    for(int i = 0; i < 10; i++)
    {
        if(stkptr == 99)
            cout<<"You have reached the end of the list."<<endl;
        else
            stkptr = link[stkptr];
        cout << names[i] << " is in position " 
             <<position[stkptr] << " and is linked to " << names[stkptr] << endl;
    }
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T15:50:49.983

没有人对需要括号的 else 语句发表评论我认为解决了 else 只会执行后面的第一行的事实。所以，

```
else
    stkptr = link[stkptr];
    cout<<names[i]<<" is in position "<<position[stkptr]<<" and is linked to "<<names[stkptr]<<endl; 
```

只会执行`stkptr = link[stkptr];`if 条件失败，但 cout 将始终执行。

不过，更广泛的问题与超出范围的数组索引有关。你看不到汤姆，因为你的堆栈溢出了。这里的问题是你`stkptr`要`link[stkptr]`在你的 cout 之前。当`i == 3`您将拥有：

```
cout<<names[3]<<" is in position "<<position[99]<<" and is linked to "<<names[99]<<endl; 
```

您必须重组程序，以便`stkptr`在任何数组查找后设置为 99，并且您必须添加更多逻辑以`" and is linked to "...`在查看 Tom 时不计算整体，因为他没有与任何人链接。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-21T16:00:39.017

您的链接设置不正确。

99 in`link[3]`表示列表中没有第 4 个节点，只有 3 个。

您想将 99 移动到最后一个有效链接之后。

提示：您的列表为：0 -> 1 -> 2 -> 99，仅显示有效节点 0、1、2。

提示2：用笔和纸画出来。

*If you like this answer, click the check mark next to it.*

# asp.net-mvc - 在每个下拉列表项上显示工具提示（或标题）消息

> ID：15005880
> 
> 赞同：1
> 
> 时间：2013-02-21T15:23:00.883
> 
> 标签：asp.net-mvc, asp.net-mvc-4, tooltip

我正在使用自定义下拉列表并动态绑定元素，但在这里我想在下拉列表的每个项目上显示一个工具提示消息。

**查看代码：**

```
 @Html.DropDownListFor(m => m.Industry,Model.IndustryList, "All", new { @style = "width:258px;", @class = "drpDown" }) 
```

**控制器代码：**

```
IEnumerable<SelectListItem> IndustryList= EntityModel<T>.Where(m => m.t == “something”).ToList().Select(c => new SelectListItem { Text = t.Name, Value = t.Value); 
```

所以让我知道有没有办法在选择标签中的每个选项上设置标题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-21T15:28:34.637

不，标准`Html.DropDownListFor`助手不支持在`<option>`标签上设置任何属性，除了标准的（`value`和`selected`）。您可以编写一个自定义助手来实现这一点。[`this example`](https://stackoverflow.com/a/7938038/29407)您也可以检查[`this one`](https://stackoverflow.com/a/8208384/29407)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-21T18:05:07.310

我也可能会选择 Darin 的答案，您需要一个自定义下拉列表。

一个快速（和肮脏）的替代方法可能是手动循环并创建您的选择列表并在选项上设置标题值。

在您的控制器上，可能会填充这样的视图模型（我只是使用匿名对象作为示例）：

```
var SelectListViewModel = new[] {
            new {
                Text = "One",
                Title = "I'm One Title",
                Value = "1"
            },
            new {
                Text = "Two",
                Title = "I'm Two Title",
                Value = "2"
            }

        }; 
```

在您看来：

```
<select>
    @foreach (var item in SelectListViewModel)
    {
        <option title="@item.Title" value="@item.Value">@item.Text</option>
    }
</select> 
```

不是最干净的，但希望可能对某人有所帮助。

# javascript - jqgrid hiddengrid加倍数据和垂直滚动重叠数据

> ID：15005885
> 
> 赞同：0
> 
> 时间：2013-02-21T15:23:12.653
> 
> 标签：javascript, jquery, jqgrid

我正在使用jqgrid 4.4.4，我似乎遇到了问题。

**问题 1：固定**

**用例**

*我希望 jqgrid 在“启动”时隐藏而不使我的数据加倍。*

**解决方案**

通过删除 scroll:true，数据不会像以前那样翻倍。

**问题 2：固定**

当数据超过jqgrid的高度时，会出现滚动条。但是滚动条与图片上的数据重叠。

![jqgrid垂直滚动条重叠](../Images/ed88fdb3f3d621b4389df6ce27b09435.png)

我已经尝试了 autowidth:true、scrollOffset、定义像素宽度 ++，但似乎没有任何效果。

我正在做一个相当大的项目，我喜欢使用 jqgrid。但我认为有必要让这些问题过时。

代码：

```
 var grid = $("#table").jqGrid(
                {       
                    datatype: "local",
                    height: "auto",
                    width: 1000,
                    scroll: true,
                    colNames:['','1992','1997','2002','2007',
                              '2012','2017','2022','2027','2032','2037'],
                    colModel: [{name:'Name',index:'Name', align: 'left'},
                               {name:'Col0',index:'Col0'},{name:'Col1',index:'Col1'}
                               {name:'Col2',index:'Col2'},{name:'Col3',index:'Col3'},
                               {name:'Col4',index:'Col4'},{name:'Col5',index:'Col5'},
                               {name:'Col6',index:'Col6'},{name:'Col7',index:'Col7'},
                               {name:'Col8',index:'Col8'},{name:'Col9',index:'Col9'}],
                    multiselect: true,
                    caption: "Table",
                    shrinkToFit: true,
                    data: [{ Name: 'County1', Col0: '11 273', Col1: '11 431', 
                             Col2: '12 515', Col3: '13 414', Col4: '15 143',
                             Col5: '16  852', Col6: '18 362', Col7: '19 698', 
                             Col8: '20 821', Col9: '21 734' },
                           { Name: 'County2', Col0: '22 530', Col1: '24 457', 
                             Col2: '25 763', Col3: '27 247', Col4: '28 970', 
                             Col5: '31 135', Col6: '32 977', Col7: '34 649', 
                             Col8: '36 020', Col9: '37 158' },
                           { Name: 'County3', Col0: '11 909', Col1: '12 734', 
                             Col2: '14 037', Col3: '14 873', Col4: '17 284', 
                             Col5: '20 083', Col6: '22 877', Col7: '25 603', 
                             Col8: '28 064', Col9: '30 210' },
                           { Name: 'County4', Col0: '10 465', Col1: '12 165', 
                             Col2: '12 962', Col3: '13 890', Col4: '15 154', 
                             Col5: '16 293', Col6: '17 284', Col7: '18 174', 
                             Col8: '18 897', Col9: '19 446' },
                           { Name: 'County5', Col0: '13 300', Col1: '14 350', 
                             Col2: '15 777', Col3: '16 791', Col4: '17 809', 
                             Col5: '18 971', Col6: '19 931', Col7: '20 785', 
                             Col8: '21 452', Col9: '21 930' }]
                  //hiddengrid: true
                }
            );
    CSS:
     .ui-jqgrid-bdiv {
       max-height:300px;
    } 
```

描述我的问题的 JSFiddle：http: [//jsfiddle.net/aalmaas/3z7s7/2/](http://jsfiddle.net/aalmaas/3z7s7/2/)

JSFiddle 正是我想要的：http: [//jsfiddle.net/aalmaas/LBfCV/](http://jsfiddle.net/aalmaas/LBfCV/)。但是，我希望将 jqgrid 高度设置为“自动”，而不是确定的高度。

**解决方案：**

非常感谢 Oleg 帮助我。

如果设置 jqgrid 的高度以及将其定义为 height:"auto"，则垂直滚动条的行为会有所不同。

这就是我最终做的事情：

如果有滚动条可见，我首先调用 setGridWidth 来减小网格的宽度，并将收缩参数设置为 true。宽度考虑到垂直滚动条需要有空间。然后我再次调用 setGridWidth 并将收缩参数设置为 false 以恢复网格的先前宽度。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-25T11:25:25.410

如果我正确理解您想要做什么，您应该执行以下操作

1）将HTML代码更改为以下

```
<div id="foo">A top div</div>
<div class="myGridDiv">
    <table id="grid"></table>
</div> 
```

其中*外部*div 上的 CSS 定义为`position: absolute`：

```
.myGridDiv { position: absolute; bottom: 10px;} 
```

2) 将 JavaScript 代码更改为

```
var numberTemplate = {width: 60, formatter: "integer",
        formatoptions: {thousandsSeparator: " "}, sorttype: "integer"};

$("#grid").jqGrid({
    datatype: "local",
    height: "auto",
    hiddengrid: true,
    gridview: true, // to improve performance
    rowNum: 10000,  // to have no local paging
    colNames: ['', '1992', '1997', '2002', '2007', '2012', '2017', '2022', '2027',
        '2032', '2037'],
    colModel: [
        {name:'Name', width: 80, key: true},
        {name:'Col0', template: numberTemplate},
        {name:'Col1', template: numberTemplate},
        {name:'Col2', template: numberTemplate},
        {name:'Col3', template: numberTemplate},
        {name:'Col4', template: numberTemplate},
        {name:'Col5', template: numberTemplate},
        {name:'Col6', template: numberTemplate},
        {name:'Col7', template: numberTemplate},
        {name:'Col8', template: numberTemplate},
        {name:'Col9', template: numberTemplate}
    ],
    caption: "Stack Overflow Example",
    data: [
        { Name: 'County1', Col0: 11273, Col1: 11431, Col2: 12515, Col3: 13414,
            Col4: 15143, Col5: 16852, Col6: 18362, Col7: 19698, Col8: 20821,
            Col9: 21734 },
        { Name: 'County2', Col0: 22530, Col1: 24457, Col2: 25763, Col3: 27247,
            Col4: 28970, Col5: 31135, Col6: 32977, Col7: 34649, Col8: 36020,
            Col9: 37158 },
        { Name: 'County3', Col0: 11909, Col1: 12734, Col2: 14037, Col3: 14873,
            Col4: 17284, Col5: 20083, Col6: 22877, Col7: 25603, Col8: 28064,
            Col9: 30210 },
        { Name: 'County4', Col0: 10465, Col1: 12165, Col2: 12962, Col3: 13890,
            Col4: 15154, Col5: 16293, Col6: 17284, Col7: 18174, Col8: 18897,
            Col9: 19446 },
        { Name: 'County5', Col0: 13300, Col1: 14350, Col2: 15777, Col3: 16791,
            Col4: 17809, Col5: 18971, Col6: 19931, Col7: 20785, Col8: 21452,
            Col9: 21930 }
    ]
}); 
```

[在此处](http://jsfiddle.net/LBfCV/1/)查看修改后的提琴手演示

**更新**：我不确定我是否正确理解滚动问题。希望[demo](http://jsfiddle.net/LBfCV/3/)能解决问题。我在演示中使用了以下 CSS：

```
.ui-jqgrid .ui-jqgrid-bdiv {
    max-height: 100px;
    overflow-x: hidden;
} 
```

# android - 使用 phonegap 将文件发送到服务器

> ID：15005886
> 
> 赞同：0
> 
> 时间：2013-02-21T15:23:16.503
> 
> 标签：android, cordova

我想使用 PhoneGap 将文件发送到服务器。这是我要发送的以下函数参数文件下面的代码。问题是，如果我插入一个假 url 作为 localhost 服务器，它会显示服务器错误代码 = 2，如果我插入一个真实 url，则会显示我找不到文件代码 = 1

```
function gotFile(file)
{
    navigator.notification.alert(file.fullPath);

    var options = new FileUploadOptions();
        options.mimeType="image/jpg"; 
        options.fileKey="file";
        var params = {};
        params.IdPrestation = "3d660013-3028-46c3-adfa-d7141a712ed7";
        params.IdPhoto      = "3a660013-3028-46c3-adfa-d7141a712ed7";
        options.params = params;
            options.chunkedMode = true ;

      var ft = new FileTransfer();

               ft.upload(file.fullPath,encodeURI('http://Myserver.fr/Phototheque.asmx/SavePhoto'),function(r)
               {      
                   //navigator.notification.alert(r.response,function(){});
                    alert(r.response,function(){});
                    console.log("Code = " + r.responseCode);
                    console.log("Response = " + r.response);
                    console.log("Sent = " + r.bytesSent);
               },
               function(e)
               {
               //navigator.notification.alert('Serveur Erreur:' + e.code,function(){});
                    cause_erreur(e.code);
                    /*
                    alert('Serveur Erreur:' + e.code,function(){});
                    alert("upload error source " + e.source);
                    alert("upload error target " + e.target)
                    */
               },
               options
               );//ft.upload

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T00:11:23.463

我不完全知道你的错误。但是，您的上传代码似乎是正常的，可能由于文件大小或网络状态而出现错误。同时，您可以在服务器中检查请求和响应是否按预期工作。

# android - 将 CharSequenceArray 传递给其他 Activity

> ID：15005890
> 
> 赞同：0
> 
> 时间：2013-02-21T15:23:34.683
> 
> 标签：android, android-activity, arraylist

您好，我已经制作了`CharSequenceArray`一个 Activity，我想使用 Intent 将它传递给另一个 Activity。

这是我的数组

```
ArrayList<CharSequence> selectedingredients = new ArrayList<CharSequence>(); 
```

我把 Intent 像这样

```
i.putCharSequenceArrayListExtra("ingredients", selectedingredients); 
```

放入其他活动我如何检索它并将其再次保存在 ArrayList 中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T15:28:06.010

在您的第二个活动电话中：

```
ArrayList<CharSequence> selectedingredients = getIntent().getCharArrayListExtra("ingredients"); 
```

# javascript - 通过单击列表滚动到部分

> ID：15005891
> 
> 赞同：2
> 
> 时间：2013-02-21T15:23:36.370
> 
> 标签：javascript, jquery, html

当我单击侧边栏列表上的一个项目时，我想滚动到相应的 .cinematography_box ，我有这个标记：

就像，列表中的第一项 > goto > 第一个 .cinematography_box div 等等，第二个，第三个等等

实现这一目标的最佳方法是什么？

```
 <div id="sidebar" class="clearfix">
                <ul>
                    <li>
                        <a id="aboutlink" href="javascript:void(0)" >CINEMATOGRAPHY LIST</a>
                    </li>
                    <li>
                        <a href="javascript:void(0)">FIRST ITEM</a>
                    </li>
                    <li>
                        <a href="javascript:void(0)">SECOND ITEM</a>
                    </li>
                    <li>
                        <a href="javascript:void(0)">THIR ITEM</a>
                    </li>
                </ul>
            </div>

                <div id="gallery" class="cinematography clearfix">

                    <div class="cinematography_box clearfix">
                        <div class="cinematography_item">
                        </div>
                        <div class="cinematography_info">
                            <p>Lorem Ipsum</p>
                        </div>
                    </div>

                    <div class="cinematography_box clearfix">
                        <div class="cinematography_item">
                        </div>
                        <div class="cinematography_info">
                            <p>Lorem Ipsum</p>
                        </div>
                    </div>

                    <div class="cinematography_box clearfix" >
                        <div class="cinematography_item">
                        </div>
                        <div class="cinematography_info">
                            <p>Lorem Ipsum</p>
                        </div>
                    </div>

                </div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T15:26:55.387

像这样定义每个元素：

```
<li data-target="one">
   <a href="javascript:void(0)">THIR ITEM</a>
</li>

<div class="cinematography_info" data-pos="one">
    <p>Lorem Ipsum</p>
</div> 
```

使用 jQuery 你可以这样做：

```
$(document).ready(function(){
    $("li").click(function() {
       scrollTo($(this).attr("data-target"));
    });
});

function scrollTo(target){
    var tagScroll = $(".cinematography_info[data-pos='"+ target+"']");
    $('html,body').animate({scrollTop: tagScroll .offset().top},'slow');
} 
```

请参阅我制作的示例：http: [//jsfiddle.net/NfwEv/9/](http://jsfiddle.net/NfwEv/9/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T15:27:22.880

首先，给你的三个`div`标签 ID，比如说`item1`, `item2`, `item3`。

这样，您可以将`a`标签更改为：

```
<li>
    <a href="#item1">FIRST ITEM</a>
</li>
<li>
    <a href="#item2">SECOND ITEM</a>
</li>
<li>
    <a href="#item3">THIR ITEM</a>
</li> 
```

# c++ - 如何在 C++ 中访问带有变量的数组？

> ID：15005893
> 
> 赞同：0
> 
> 时间：2013-02-21T15:23:53.287
> 
> 标签：c++, arrays

我有一个包含变量的数组。我如何访问它们？

我用来设置它们的代码是：

```
Movie::Movie(string temp) {
    istringstream iS(temp);
    getline(iS, title, '\t');
    getline(iS, studio, '\t');
    iS >> releaseYear >> usRank >> usBoxOffice >> nonUSRank >>
          nonUSBoxOffice >> worldRank >> worldBoxOffice;

    void Movies::loadMovies(string fn) {
        ifstream iS(fn);
        string s;
        getline(iS, s); // Skip heading
        getline(iS, s);
        movieCnt=0;
        movies = new Movie[MAX_MOVIES];
        while(!iS.eof()) {
            movies[movieCnt++] = Movie(s);
            getline(iS, s);
        }
        iS.close();
        reSize();
    } 
```

因此，如果我想访问 worldrank 的数组，我只需输入`array[cnt].worldrank`吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T16:56:46.467

如果数组内容是对象，你可以做 arrayname[index].variableofObject

如果数组内容是指向对象的指针，则执行 arrayname[index]->variableOfObject

这就对了 ：）

# java - 可以使用java读取来电吗？

> ID：15005895
> 
> 赞同：1
> 
> 时间：2013-02-21T15:24:05.233
> 
> 标签：java, phone-call

我正在做一个 DVT 程序（对于比萨店）作为 Java 大学的测试。我希望程序从电话（固定电话）读取来电，但我不知道如何。我想电话应该连接到PC和线路，但我不知道我需要做什么。你知道我该怎么做或类似的事情吗？我只需要一些参考或想法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-21T15:26:43.297

你看过[Java Telephony API](http://www.oracle.com/technetwork/java/jtapi-136088.html)吗？这里有一个[简单的介绍](http://blog.devrealm.org/2009/03/26/jtapi-overview/)。

# php - 从文件夹 PHP 中删除图像

> ID：15005899
> 
> 赞同：40
> 
> 时间：2013-02-21T15:24:14.507
> 
> 标签：php

我有一个保存图像的文件夹，名为`img/`. 我有一张桌子，上面有我所有的图片：

```
<table border="3">
    <tr>
        <td>    
            <?php
            $files = glob("img/*");
            foreach ($files as $file) {
                echo "<div class='divimages'>"; 
                echo '<img src="'.$file.'"/>';
                echo "<input type='submit' value='Delete image'/><br>";
                echo "</div>";  
            }
            ?>
        </td>
    </tr>   
</table> 
```

如何删除与具有值的按钮关联的图像：`"Delete image"`。

* * *

## 回答 #1

> 赞同：71
> 
> 时间：2013-02-21T15:37:39.000

有几条路线。一个，最简单的，就是把它变成一种形式；当它提交时，您对 POST 数据做出反应并使用删除图像`unlink`

**免责声明**：这不安全。攻击者可以使用此代码删除您服务器上的**任何**文件。您必须扩展此演示代码以添加一些安全措施，*否则您可能会遇到坏事*。

每个图像的显示标记将包含如下形式：

```
echo '<form method="post">';
  echo '<input type="hidden" value="'.$file.'" name="delete_file" />';
  echo '<input type="submit" value="Delete image" />';
echo '</form>'; 
```

...在同一个 PHP 文件的顶部：

```
if (array_key_exists('delete_file', $_POST)) {
  $filename = $_POST['delete_file'];
  if (file_exists($filename)) {
    unlink($filename);
    echo 'File '.$filename.' has been deleted';
  } else {
    echo 'Could not delete '.$filename.', file does not exist';
  }
}
// existing code continues below... 
```

您可以使用 javascript 对此进行详细说明：您可以发送 AJAX 请求，而不是提交表单。服务器端代码看起来与此非常相似。

**文档和相关阅读**

*   `unlink`- [http://php.net/manual/en/function.unlink.php](http://php.net/manual/en/function.unlink.php)
*   `$_POST`- [http://php.net/manual/en/reserved.variables.post.php](http://php.net/manual/en/reserved.variables.post.php)
*   `file_exists`- [http://php.net/manual/en/function.file-exists.php](http://php.net/manual/en/function.file-exists.php)
*   `array_key_exists`- [http://php.net/manual/en/function.array-key-exists.php](http://php.net/manual/en/function.array-key-exists.php)
*   *“在 HTML 表单中使用 PHP”* - [http://www.tizag.com/phpT/forms.php](http://www.tizag.com/phpT/forms.php)

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2013-02-21T15:25:45.987

[`unlink()`](http://php.net/manual/en/function.unlink.php)您可以使用该函数在 PHP 中删除文件。

```
unlink('path/to/file.jpg'); 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2018-02-01T13:32:46.560

首先检查图像是否存在？如果是，那么只需调用 unlink(your file path) 函数来删除您的文件，否则向用户显示消息。

```
 if (file_exists($filePath)) 
               {
                 unlink($filePath);
                  echo "File Successfully Delete."; 
              }
              else
              {
               echo "File does not exists"; 
              } 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-02-21T15:27:26.237

对于删除使用[http://www.php.net/manual/en/function.unlink.php](http://www.php.net/manual/en/function.unlink.php) 希望你能写逻辑？

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-11-01T05:27:15.073

你可以试试这段代码。这是从服务器中删除简单 PHP 图像的代码。

```
<form method="post">
<input type="text" name="photoname"> // You can type your image name here...
<input type="submit" name="submit" value="Delete">
</form>

<?php
if (isset($_POST['submit'])) 
{
$photoname = $_POST['photoname'];
if (!unlink($photoname))
  {
  echo ("Error deleting $photoname");
  }
else
  {
  echo ("Deleted $photoname");
  }
}
?> 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-04-11T08:38:21.013

```
<?php

    require 'database.php';

    $id = $_GET['id'];

    $image = "SELECT * FROM slider WHERE id = '$id'";
    $query = mysqli_query($connect, $image);
    $after = mysqli_fetch_assoc($query);

    if ($after['image'] != 'default.png') {
        unlink('../slider/'.$after['image']);
    }

    $delete = "DELETE FROM slider WHERE id = $id";
    $query = mysqli_query($connect, $delete);

    if ($query) {
        header('location: slider.php');
    }

?> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-12-13T19:11:51.490

```
<?php
$path = 'img/imageName.jpg';
if (is_file($path)) {
    unlink($path);
} else {
    die('your image not found');
} 
```

# javascript - 为什么这个功能不起作用？

> ID：15005903
> 
> 赞同：0
> 
> 时间：2013-02-21T15:24:31.980
> 
> 标签：javascript

我有这个代码：

```
var frames = document.getElementsByTagName("iFrame");
var auto_resize_timer = window.setInterval("autoresize_frames()", 400);
function autoresize_frames() {
    for (var i = 0; i < frames.length; ++i) {
        if (frames[i].contentWindow.document.body) {
            var frames_size = frames[i].contentWindow.document.body.offsetHeight;
            if (document.all && !window.opera) {
                frames_size = frames[i].contentWindow.document.body.scrollHeight;
            }
            frames[i].style.height = frames_size + 'px';
        }
    }
} 
```

那工作得很好。

然后，我决定把它放在自己的模块中：

```
function autoResizeFrames() {
    var frames = document.getElementsByTagName("iFrame");
    window.setInterval("autoresize_frames(frames)", 400);
}

function autoresize_frames(frames) {

    for (var i = 0; i < frames.length; ++i) {
        if (frames[i].contentWindow.document.body) {
            var frames_size = frames[i].contentWindow.document.body.offsetHeight;
            if (document.all && !window.opera) {
                frames_size = frames[i].contentWindow.document.body.scrollHeight;
            }
            frames[i].style.height = frames_size + 'px';
        }
    }
} 
```

并像这样在页面中运行它：

```
<script type="text/javascript">

    $(document).ready
(
     function () {
         autoResizeFrames();
     }

    );

</script> 
```

但是现在不行了？任何想法为什么？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T15:27:37.743

当你运行时：

```
 window.setInterval("autoresize_frames(frames)", 400); 
```

您实际上`eval`是在窗口的上下文中编写代码。使用 setInterval 时，您应该传递对函数的引用而不是字符串。您可以阅读为什么 eval 不好[为什么使用 JavaScript eval 函数是个坏主意？](https://stackoverflow.com/questions/86513/why-is-using-the-javascript-eval-function-a-bad-idea)

通常你会这样做：

```
 window.setInterval(autoresize_frames, 400); 
```

但是，如果您的函数需要参数，那么您需要将其包装在一个函数中。

以下将起作用：

```
window.setInterval(function() {
  autoresize_frames(frames);
}, 400); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T15:26:44.690

在您自己的函数中，“框架”是在内部声明的。您可以尝试删除“var”关键字，使其成为全局变量。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-21T15:30:44.413

我认为问题可能出`frames`在 setInterval 中可能无法访问的变量上。你可以试试这个

```
function autoResizeFrames() {
    window.setInterval(function(){
         autoresize_frames(document.getElementsByTagName("iFrame"))
    }, 400);
} 
```

# glassfish - 以编程方式读取 DMQ

> ID：15005907
> 
> 赞同：0
> 
> 时间：2013-02-21T15:24:38.370
> 
> 标签：glassfish, openmq

如何以编程方式从“mq.sys.dmq”读取消息。我使用 Glassfish 3.1.2.2

当我尝试：

```
InitialContext ctx = new InitialContext();
Queue queue = (Queue) ctx.lookup("mq.sys.dmq");
QueueConnectionFactory connFactory = (QueueConnectionFactory) ctx.lookup("jms/ConnectionFactory");
QueueConnection queueConn = connFactory.createQueueConnection();
QueueSession queueSession = queueConn.createQueueSession(false,
             Session.AUTO_ACKNOWLEDGE);
QueueReceiver queueReceiver = queueSession.createReceiver(queue); 
```

我收到：

> javax.naming.NamingException：查找“mq.sys.dmq”失败

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-21T15:49:46.643

您必须在 Glassfish 管理 GUI 中创建队列。

转到`JMS Resources`-> `Destination Resources`：

`mq.sys.dmq`使用as`Physical Destination Name`和`javax.jms.queue`as创建一个新条目`Resource type`

# jquery - 为什么 attr() 在第二次调用时不更新 HTML？

> ID：15005908
> 
> 赞同：1
> 
> 时间：2013-02-21T15:24:41.570
> 
> 标签：jquery, dom-traversal

我有一个脚本，应该在选择祖先复选框时选择所有后代输入复选框。

见这里：http: [//jsfiddle.net/zJPfR/](http://jsfiddle.net/zJPfR/)

当顶层复选框被选中时，下面的所有复选框都被选中。如果您取消选中该复选框，则会删除选中的复选框。但是，如果您第二次尝试这样做，它就行不通了。

如果我不正确地处理这个问题，请告诉我。

大流士

```
 $('.poSelect').click(function() {
        var expandBox   = $(this).parents('.pohelpTbl').next('.expandBox');
        var receipts    = expandBox.find('input[type="checkbox"]');

        if ($(this).is(':checked')) {
            var status = true;
        } else {
            var status = false;
        }

        $(receipts).each(function (i) {
            var cb = $(this);
            cb.attr("checked",status);          
        });
    }); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-21T15:27:02.737

jQuery`.attr`只使用初始属性。使用[`.prop`](http://api.jquery.com/prop)而不是`.attr`更改当前的 DOM。
`cb.attr("checked",status);`=>`cb.prop("checked",status);`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-21T15:29:58.470

它应该是

```
$('.poSelect').click(function() {
    var receipts    = $(this).closest('.pohelpTbl').next('.expandBox').find(':checkbox');

    receipts.prop('checked', this.checked);
}); 
```

无需遍历每个`receipts`项目，您可以`.prop()`直接调用`receipts`.

演示：[小提琴](http://jsfiddle.net/arunpjohny/zJPfR/8/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-21T15:29:43.460

选中属性的存在是显示要选中的复选框，而不是属性的值设置为真或假。

从此改变：

```
var cb = $(this);
cb.attr("checked",status); 
```

对此：

```
var cb = $(this);
if (status){
    cb.attr("checked","checked");
}
else{
    cb.removeAttr("checked");
} 
```

# ios - 在 cocos2d 中移动精灵

> ID：15005913
> 
> 赞同：0
> 
> 时间：2013-02-21T15:24:53.400
> 
> 标签：ios, xcode, ipad, cocos2d-iphone

我有 6 个想要移动的精灵：

-（id）初始化{

```
if( (self=[super init]) )
{
    CGSize winSize = [[CCDirector sharedDirector] winSize];

    CCSprite * backGround = [CCSprite spriteWithFile:@"background_ipad.png"];
    backGround.position = ccp(winSize.width/2, winSize.height/2);
    [self addChild:backGround z:0];

    cloth1 = [CCSprite spriteWithFile:@"clothe_1.png"];
    cloth1.position = ccp(-200, -15);
    [self addChild:cloth1 z:1];
    cloth2 = [CCSprite spriteWithFile:@"clothe_2.png"];
    cloth2.position = ccp(130, 225);
    [self addChild:cloth2 z:2];

    cloth3 = [CCSprite spriteWithFile:@"clothe_3.png"];
    cloth3.position = ccp(365, 225);
    [self addChild:cloth3 z:3];

    cloth4 = [CCSprite spriteWithFile:@"clothe_4.png"];
    cloth4.position = ccp(-110, -15);
    [self addChild:cloth4 z:4];

    cloth5 = [CCSprite spriteWithFile:@"clothe_5.png"];
    cloth5.position = ccp(130, -20);
    [self addChild:cloth5 z:5];

    cloth6 = [CCSprite spriteWithFile:@"clothe_6.png"];
    cloth6.position = ccp(365, -15);
    [self addChild:cloth6 z:6];

}
return self;
[[CCTouchDispatcher sharedDispatcher] addTargetedDelegate:self priority:0 swallowsTouches:YES]; 
```

}

以及这种移动方法：

```
-(void) ccTouchMoved:(UITouch *)touch withEvent:(UIEvent *)event
{
    CGPoint location = [touch locationInView: [touch view]];
    location = [[CCDirector sharedDirector] convertToGL: location];
    //Sprite follows the finger movement.
    [cloth1 setPosition:location];
} 
```

问题是，我想在那里添加更多精灵来移动精灵。我尝试在 //follow the finger Movement 中添加更多精灵，但随后所有精灵都跟随手指移动。我想移动一个精灵。例如：接触布料1时，移动布料1；接触布料2时，移动布料2；但不是同时。

有人可以告诉我该怎么做吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T15:53:28.120

```
@interface YourClass : NSObject
{
    NSMutableArray  *mSpriteArray;
    CCSprite  *mSpriteOnHand;
} 
```

//在实现中：

```
-(id) init 
{
  .. //your old code
  ..

   [mSpriteArray addObject: cloth1];
   [mSpriteArray addObject: cloth2];
   [mSpriteArray addObject: cloth3];
   [mSpriteArray addObject: cloth4];
   [mSpriteArray addObject: cloth5];
   [mSpriteArray addObject: cloth6];

}

-(void)onEnter
{
    [super onEnter];
    self.touchEnabled = YES; //    self.isTouchEnabled = YES;

}

- (void)ccTouchesBegan:(NSSet *)touches withEvent:(UIEvent *)event
{
    UITouch *myTouch = [touches anyObject];
    CGPoint location = [myTouch locationInView:[myTouch view]];
    location = [[CCDirector sharedDirector] convertToGL:location];

    mSpriteOnHand = nil;

    for(CCSprite *cloth in mSpriteArray)
    {
        if(CGRectContainsPoint([cloth boundingBox], location))
        {
            mSpriteOnHand = cloth;
            break;
        }
    }
}

- (void)ccTouchesMoved:(NSSet *)touches withEvent:(UIEvent *)event
{
    UITouch *touch = [touches anyObject];

    CGPoint location = [touch locationInView: [touch view]];
    location = [[CCDirector sharedDirector] convertToGL:location];

    if(mSpriteOnHand)
       mSpriteOnHand.position = location;

 }

- (void)ccTouchesEnded:(NSSet *)touches withEvent:(UIEvent *)event
{
    mSpriteOnHand = nil;
}

-(void)onExit
{
   [mSpriteArray release]; 
   mSpriteArray = nil;
   [super onExit];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T15:46:25.137

`return`语句总是终止函数并将控制权返回给调用函数。你写了：

```
 return self;
[[CCTouchDispatcher sharedDispatcher] addTargetedDelegate:self priority:0 swallowsTouches:YES]; 
```

`[[CCTouchDispatcher sharedDispatcher]...`行将永远不会被执行。

你的类是 的子类`CCLayer`吗？如果您将图层的`isTouchEnabled`属性设置为`YES`，它将将此图层添加为标准（非目标）触摸委托。

如果您必须在您的层中使用目标触摸，如果您声明此触摸，则您应该返回`YES`，如果您没有声明。已声明触摸的更新仅发送给声明它的委托。`-(BOOL) ccTouchBegan:(UITouch *)touch withEvent:(UIEvent *)event``NO`

要确定哪个精灵被触摸：创建一个实例变量来存储“选定”精灵，在`touchBegan`方法中检查哪个精灵的边界框包含触摸位置并将这个精灵存储在实例变量中（另外，看起来你只想在触摸时声明触摸一个精灵）。

```
[cloth1 setPosition:location]; 
```

-- 你的精灵会“跳”到触摸位置。通常看起来不太好。我会得到 touch's `locationInView:`and `previousLocationInView:`，将它们转换为 GL，得到差异并通过该差异改变精灵的位置。

# java - Hibernate：org.hibernate.NonUniqueObjectException：具有相同标识符值的不同对象已与会话关联

> ID：15005914
> 
> 赞同：1
> 
> 时间：2013-02-21T15:24:55.653
> 
> 标签：java, hibernate, hibernate-mapping

我想知道为什么会发生此异常，尽管 Hibernate get/query 方法可以确保检索在 Hibernate 会话中已经可用的对象，以防重复需要这些对象：

```
org.hibernate.NonUniqueObjectException: a different object with the same identifier value was already associated with the session: [x.y.z.MyObject#130062]
    at org.hibernate.engine.StatefulPersistenceContext.checkUniqueness(StatefulPersistenceContext.java:638)
    at org.hibernate.event.def.DefaultSaveOrUpdateEventListener.performUpdate(DefaultSaveOrUpdateEventListener.java:305)
    at org.hibernate.event.def.DefaultSaveOrUpdateEventListener.entityIsDetached(DefaultSaveOrUpdateEventListener.java:246)
    at org.hibernate.event.def.DefaultSaveOrUpdateEventListener.performSaveOrUpdate(DefaultSaveOrUpdateEventListener.java:112)
    at org.hibernate.event.def.DefaultSaveOrUpdateEventListener.onSaveOrUpdate(DefaultSaveOrUpdateEventListener.java:93)
    at org.hibernate.impl.SessionImpl.fireSaveOrUpdate(SessionImpl.java:685)
    at org.hibernate.impl.SessionImpl.saveOrUpdate(SessionImpl.java:677)
    at org.hibernate.engine.CascadingAction$5.cascade(CascadingAction.java:252)
    at org.hibernate.engine.Cascade.cascadeToOne(Cascade.java:392)
    at org.hibernate.engine.Cascade.cascadeAssociation(Cascade.java:335)
    at org.hibernate.engine.Cascade.cascadeProperty(Cascade.java:204)
    at org.hibernate.engine.Cascade.cascadeCollectionElements(Cascade.java:425)
    at org.hibernate.engine.Cascade.cascadeCollection(Cascade.java:362)
    at org.hibernate.engine.Cascade.cascadeAssociation(Cascade.java:338)
    at org.hibernate.engine.Cascade.cascadeProperty(Cascade.java:204)
    at org.hibernate.engine.Cascade.cascade(Cascade.java:161)
    at org.hibernate.engine.Cascade.cascade(Cascade.java:127)
    at org.hibernate.event.def.DefaultSaveOrUpdateEventListener.cascadeOnUpdate(DefaultSaveOrUpdateEventListener.java:376)
    at org.hibernate.event.def.DefaultSaveOrUpdateEventListener.performUpdate(DefaultSaveOrUpdateEventListener.java:350)
    at org.hibernate.event.def.DefaultSaveOrUpdateEventListener.entityIsDetached(DefaultSaveOrUpdateEventListener.java:246)
    at org.hibernate.event.def.DefaultUpdateEventListener.performSaveOrUpdate(DefaultUpdateEventListener.java:57)
    at org.hibernate.event.def.DefaultSaveOrUpdateEventListener.onSaveOrUpdate(DefaultSaveOrUpdateEventListener.java:93)
    at org.hibernate.impl.SessionImpl.fireUpdate(SessionImpl.java:742)
    at org.hibernate.impl.SessionImpl.update(SessionImpl.java:730)
    at org.hibernate.impl.SessionImpl.update(SessionImpl.java:722) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-21T16:04:54.120

经过一些调试后，我发现我并没有停止在自引用模型中级联传播更新：

**type1 --> type2 --> type3 --> 集合（type1）**

所以需要做的就是停止级联`cascade="none"`：

```
<set name="type1collection" ... cascade="none">
...
</set> 
```

这意味着，**已经与会话关联的具有相同标识符值的不同对象**隐藏在自引用子项中。这些孩子的额外更新是不必要的，所以没有级联是正确的。

# mysql - 获取 MySQL 查询中返回的行数

> ID：15005916
> 
> 赞同：17
> 
> 时间：2013-02-21T15:25:01.813
> 
> 标签：mysql

我在编写 MySQL 查询时遇到了一些问题。我想计算我的查询返回的行数，而不实际返回行，然后使用 mysql_num_rows 等。

我的查询如下：

```
SELECT COUNT(l.product_number_language) as counts, l.id, l.product_number, l.language,    l.product_number_language
FROM bs_products_languages l
LEFT JOIN bs_products p ON (l.product_number_language = p.product_number)
WHERE l.product_number = 'C4164' 
AND l.active='Y'
AND p.active='Y'
GROUP BY l.language 
```

以下是返回的内容： ![截屏](../Images/50613fb16362f8d2b78a7cd38518adab.png)

我真正想要的只是这些行的计数，所以在这种情况下为 3。

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2013-02-21T17:24:30.633

```
Select count(*)
From
(
    SELECT COUNT(l.product_number_language) as counts, l.id, l.product_number, 
        l.language, l.product_number_language
    FROM bs_products_languages l
    LEFT JOIN bs_products p ON (l.product_number_language = p.product_number)
    WHERE l.product_number = 'C4164' 
    AND l.active='Y'
    AND p.active='Y'
    GROUP BY l.language
) as t 
```

# php - PHP中的按位比较

> ID：15005917
> 
> 赞同：1
> 
> 时间：2013-02-21T15:25:04.657
> 
> 标签：php, math, bit-manipulation, linden-scripting-language

我承认我真的不知道我在做什么！我正在从 SecondLife 中提取一些数据并在 PHP 中对其进行解析。数据是来自[llGetRegionFlags](http://wiki.secondlife.com/wiki/LlGetRegionFlags)的整数，在我的情况下，它返回 1048592

现在我需要在 PHP 中进行按位比较，以确定哪些标志是真/假。例如 0x00000040 用于“block terraform”标志。

每个标志的符号都是十六进制的，我有一个整数要测试，[PHP手册](http://php.net/manual/en/language.operators.bitwise.php)建议整数并以二进制显示示例。

所以我的问题真的是，给定一个整数和一些十六进制标志，我该如何在 PHP 中进行按位比较？脑筋急转弯！提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T15:28:50.410

要确定某个特定位是否打开，请使用 & (AND) 运算符：

```
if ($data & 0x00000040) {
    // block terraform flag is true
} 
```

如果该位打开，AND 运算符将返回一个正数。如果它被关闭，那么 AND 运算符将产生一个零。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T15:30:11.233

您可以定义所需的位，并检查它们以使其看起来干净。IE

```
define('BLOCK_TERAFORM', 0x00000040);

....

if($data & BLOCK_TERAFORM) {
  ... do something ...
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-21T15:28:18.090

使用单个 AND `&`/ OR`|`

```
if ($value1 & $value2) { } 
```

PHP 手册解释更多： http: [//php.net/manual/en/language.operators.bitwise.php](http://php.net/manual/en/language.operators.bitwise.php)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-21T15:35:15.050

通常使用如下代码检查位标志：

```
$blockTerraformFlag = 0x00000040;
$isBlockTerraform = (($RegionFlags & $blockTerraformFlag) == $blockTerraformFlag); 
```

# solr - 如何从 HTML 文件中提取元标记并在 SOLR 和 TIKA 中对其进行索引

> ID：15005919
> 
> 赞同：1
> 
> 时间：2013-02-21T15:25:12.430
> 
> 标签：solr, apache-tika, data-import, solr4

我正在尝试提取 HTML 文件的元标记并将它们索引到具有 tika 集成的 solr 中。我无法使用 Tika 提取这些元标记，也无法在 solr 中显示。

我的 HTML 文件看起来像这样。

```
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="product_id" content="11"/>
<meta name="assetid" content="10001"/>
<meta name="title" content="title of the article"/>
<meta name="type" content="0xyzb"/>
<meta name="category" content="article category"/>
<meta name="first" content="details of the article"/>

<h4>title of the article</h4>
<p class="link"><a href="#link">How cite the Article</a></p>
<p class="list">
  <span class="listterm">Length: </span>13 to 15 feet<br>
  <span class="listterm">Height to Top of Head: </span>up to 18 feet<br>
  <span class="listterm">Weight: </span>1,200 to 4,300 pounds<br>
  <span class="listterm">Diet: </span>leaves and branches of trees<br>
  <span class="listterm">Number of Young: </span>1<br>
  <span class="listterm">Home: </span>Sahara<br>
</p>
</p> 
```

我的 data-config.xml 文件看起来像这样

```
<dataConfig>
<dataSource name="bin" type="BinFileDataSource" />
    <document>   
    <entity name="f" dataSource="null" rootEntity="false"
        processor="FileListEntityProcessor"
        baseDir="/path/to/html/files/" 
        fileName=".*html|xml" onError="skip"
        recursive="false">

        <field column="fileAbsolutePath" name="path" />
        <field column="fileSize" name="size"/>
        <field column="file" name="filename"/>

        <entity name="tika-test" dataSource="bin" processor="TikaEntityProcessor" 
        url="${f.fileAbsolutePath}" format="text" onError="skip">

        <field column="product_id" name="product_id" meta="true"/>
        <field column="assetid" name="assetid" meta="true"/>
        <field column="title" name="title" meta="true"/>
        <field column="type" name="type" meta="true"/>
        <field column="first" name="first" meta="true"/>
        <field column="category" name="category" meta="true"/>      
        </entity>
    </entity>
</document>
</dataConfig> 
```

在我的 schema.xml 文件中，我添加了以下字段。

```
<field name="product_id" type="string" indexed="true" stored="true"/>
<field name="assetid" type="string" indexed="true" stored="true" />
<field name="title" type="string" indexed="true" stored="true"/>
<field name="type" type="string" indexed="true" stored="true"/>
<field name="category" type="string" indexed="true" stored="true"/>
<field name="first" type="text_general" indexed="true" stored="true"/> 
```

在我的 solrconfing.xml 文件中，我添加了以下代码。

```
<requestHandler name="/dataimport" class="org.apache.solr.handler.dataimport.DataImportHandler" />
<lst name="defaults">
  <str name="config">/path/to/data-config.xml</str>
</lst> 
```

谁能知道如何从 HTML 文件中提取这些元标记并在 solr 和 Tika 中对它们进行索引？您的帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T16:16:23.013

I don't think meta="true" means what you think it means. It usually refers to things that are **about** the file rather than the content. So, content-type, etc. Possibly http-equiv will get mapped as well.

Other than that, you need to extract actual content. You can do it by using format="xml" and then putting an inner entity with XPathEntityProcessor and mapping the path then. Except, even then, you are limited because stuck because AFAIK, DIH uses DefaultHtmlMapper which is extremely restrictive in what it let's through and skips most of the 'class' and 'id' attributes and even things like 'div'. You can read the [list of allowed elements and attributes](http://www.grepcode.com/file/repo1.maven.org/maven2/org.apache.tika/tika-parsers/1.2/org/apache/tika/parser/html/DefaultHtmlMapper.java#33) by yourself in the source code.

Frankly, your easier path is to have a SolrJ client and manage Tika yourself. Then you can set it to use IdentityHtmlMapper which does not muck about with HTML.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-19T08:44:27.357

您使用的是哪个版本的 Solr？如果您使用的是[Solr 4.0](http://lucene.apache.org/solr/4_0_0/)或更高版本，则[tika](http://www.slideshare.net/jukka/text-and-metadata-extraction-with-apache-tika-4427630)已嵌入其中。Tika 使用 solrconfig.xml 中配置的**“Solr-Cells”** *“ExtractingRequestHandler”*类与 solr 通信，如下所示：

```
 <!-- Solr Cell Update Request Handler

       http://wiki.apache.org/solr/ExtractingRequestHandler 

    -->
  <requestHandler name="/update/extract" 
                  startup="lazy"
                  class="solr.extraction.ExtractingRequestHandler" >
    <lst name="defaults">
      <str name="lowernames">true</str>
      <str name="uprefix">ignored_</str>

      <!-- capture link hrefs but ignore div attributes -->
      <str name="captureAttr">true</str>
      <str name="fmap.a">links</str>
      <str name="fmap.div">ignored_</str>
    </lst>
  </requestHandler> 
```

现在默认情况下在 solr 中，如您在上面的配置中所见，从 HTML 文档中提取的任何未在 schema.xml 中声明的字段都以**“ignored_”**为前缀，即它们映射到schema.xml 中*的“ignored_* *”动态字段。默认的 schema.xml 如下所示：

```
 <!-- some trie-coded dynamic fields for faster range queries -->
   <dynamicField name="*_ti" type="tint"    indexed="true"  stored="true"/>
   <dynamicField name="*_tl" type="tlong"   indexed="true"  stored="true"/>
   <dynamicField name="*_tf" type="tfloat"  indexed="true"  stored="true"/>
   <dynamicField name="*_td" type="tdouble" indexed="true"  stored="true"/>
   <dynamicField name="*_tdt" type="tdate"  indexed="true"  stored="true"/>

   <dynamicField name="*_pi"  type="pint"    indexed="true"  stored="true"/>
   <dynamicField name="*_c"   type="currency" indexed="true"  stored="true"/>

   <dynamicField name="ignored_*" type="ignored" multiValued="true"/>
   <dynamicField name="attr_*" type="text_general" indexed="true" stored="true" multiValued="true"/>

   <dynamicField name="random_*" type="random" />

   <!-- uncomment the following to ignore any fields that don't already match an existing 
        field name or dynamic field, rather than reporting them as an error. 
        alternately, change the type="ignored" to some other type e.g. "text" if you want 
        unknown fields indexed and/or stored by default --> 
   <!--dynamicField name="*" type="ignored" multiValued="true" /-->

 </fields> 
```

以下是**“忽略”**类型的处理方式：

```
<!-- since fields of this type are by default not stored or indexed,
     any data added to them will be ignored outright.  --> 
<fieldtype name="ignored" stored="false" indexed="false" multiValued="true" class="solr.StrField" /> 
```

因此，tika 提取的元数据默认情况下被 Solr-Cell 放在*“忽略”*字段中，这就是为什么它们在索引和存储时被忽略的原因。因此，要*索引*和*存储*元数据，您可以更改**“uprefix=attr_”**或“为已知元数据*创建特定字段或动态字段”，并根据需要处理它们。*

所以，这里是更正后的 solrconfig.xml：

```
 <!-- Solr Cell Update Request Handler

       http://wiki.apache.org/solr/ExtractingRequestHandler 

    -->
  <requestHandler name="/update/extract" 
                  startup="lazy"
                  class="solr.extraction.ExtractingRequestHandler" >
    <lst name="defaults">
      <str name="lowernames">true</str>
      <str name="uprefix">attr_</str>

      <!-- capture link hrefs but ignore div attributes -->
      <str name="captureAttr">true</str>
      <str name="fmap.a">links</str>
      <str name="fmap.div">ignored_</str>
    </lst>
  </requestHandler> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-11-17T22:23:26.143

虽然是一个较老的问题，但我的回答是

1.  我最近问了一个类似的问题（几天后没有回复或评论），我整理出来并且与这个问题相关。

2.  多年来，Solr 发生了很大变化，关于该主题的现有文档（如果存在）既令人困惑，有时又是错误的。

3.  虽然很长，但此回复通过示例和文档提供了该问题的解决方案。

简而言之，我现在删除的 StackOverflow 问题是“使用 Apache Solr 从 HTML 中提取自定义（例如 <my_id></my_id）标记文本”。该任务的辅助是如何索引 HTML 页面，包括自定义 HTML 元素：属性。

简短的回答是，虽然索引“标准”HTML 元素（a; div; h1; h2; li; meta; p; title; ... [https://www.w3.org/TR/2005 /WD-xhtml2-20050527/elements.html](https://www.w3.org/TR/2005/WD-xhtml2-20050527/elements.html)），如果不严格使用格式正确的 XML 文件和 Solr 中的更新功能，很难包含自定义标签集（参见，例如：[https ://lucene.apache.org/solr/ guide/6_6/uploading-data-with-index-handlers.html#uploading-data-with-index-handlers](https://lucene.apache.org/solr/guide/6_6/uploading-data-with-index-handlers.html#uploading-data-with-index-handlers)），或使用`captureAttr`Apache Tika 的参数，通过`ExtractingRequestHandler`（如下所述）或其他工具等作为 Apache Nutch。

标准 HTML 元素，例如`<title>Solr HTML Indexing Tests</title>`易于索引；但是，像这样的非标准元素`<my_id>bt-ic8eew2u</my_id>`会被忽略。

虽然您可以应用基于 XML 的解决方案，例如`<field name="my_id">bt-ic8eew2u</field>`，但我更喜欢简单的基于 HTML 的解决方案——因此，HTML 元数据方法。

* * *

**环境：** Arch Linux (x86_64) 命令行；Apache Solr 8.7.0；FireFox 83.0 中的 Solr 管理 UI (http://localhost:8983/solr/#/gettingstarted/query)

**测试文件（solr_test9.html）：**

```
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-us">
<head>
  <meta charset="UTF-8" />
  <title>Solr HTML Indexing Tests</title>
  <meta name="date_created" content="2019-11-01" />
  <meta name="source_url" content="/mnt/Vancouver/programming/datasci/solr/test/solr_test9.html" />
  <!-- <my_id>bt-ic8eew2u</my_id> -->
  <meta name="doc_id" content="bt-ic8eeW2U" />
  <meta name="date_pub" content="2020-11-16" />
</head>

<body>
<h1>Apples</h1>
<p>I like apples.</p>

<h2>Bananas</h2>
<p>I also like bananas.</p>

<p><div id="div1">This text is located in div element 1.</div></p>
<p><div id="div2">This text is located in div element 2.</div></p>

<br/>
Lorem ipsum dolor sit amet, consectetur adipiscing elit.
<br/>

<p>Suspendisse efficitur pulvinar elementum.</p>

<p>My website is <a href="https://buriedtruth.com/">BuriedTruth.com</a>.</p>

<h1>Nova Scotia</h1>
<p>Nova Scotia is a province on the east coast of Canada.</p>

<h2>Capital of Nova Scotia</h2>
<p>Halifax is the capital of N.S.</p>
<p>Halifax is also N.S.'s largest city.</p>

<h1>British Columbia</h1>
<h2>Capital of British Columbia</h2>
<p>Victoria is the capital of B.C.</p>
<p>Vancouver is the largest city in B.C., however.</p>

<p>Non-terminated sentence (missing period)</p>

<meta name="date_current" content="2020-11-17" />
<!-- Comments like these are not indexed. -->
<p>Current date: 2020-11-17</p>

</body>
</html> 
```

* * *

**solrconfig.xml**

`solrconfig.xml`这是我文件的相关补充。

```
 <!-- SOLR CELL PLUGINS: -->
  <lib dir="${solr.install.dir:../../..}/contrib/extraction/lib" regex=".*\.jar" />
  <lib dir="${solr.install.dir:../../..}/dist/" regex="solr-cell-\d.*\.jar" />

  <!-- https://lucene.472066.n3.nabble.com/Prons-an-Cons-of-Startup-Lazy-a-Handler-td4059111.html -->
  <requestHandler name="/update/extract"
    class="org.apache.solr.handler.extraction.ExtractingRequestHandler">
    <lst name="defaults">
      <str name="lowernames">true</str>
      <str name="uprefix">ignored_</str>
      <str name="capture">div</str>
      <str name="fmap.div">div</str>
      <str name="capture">h1</str>
      <str name="fmap.h1">h1</str>
      <str name="capture">h2</str>
      <str name="fmap.h2">h2_t</str>
      <str name="capture">p</str>
      <!-- <str name="fmap.p">p_t</str> -->
      <str name="fmap.p">p</str>
      <!-- COMMENT: note that the entries above refer to standard -->
      <!-- HTML elements.  As long as you have <meta/> (metadata) -->
      <!-- entries ("doc-id", "date_pub" ...) in your schema then -->
      <!-- Solr will automatically pick them up when indexing ... -->
      <!-- (hence no need to include those, here!).               -->
    </lst>
  </requestHandler>

  <!-- https://doc.lucidworks.com/fusion-server/5.2/reference/solr-reference-guide/7.7.2/update-request-processors.html -->
  <!-- The update.autoCreateFields property can be turned to false to disable schemaless mode -->
  <updateRequestProcessorChain name="add-unknown-fields-to-the-schema" default="${update.autoCreateFields:true}"
           processor="uuid,remove-blank,field-name-mutating,parse-boolean,parse-long,parse-double,parse-date,add-schema-fields">
    <processor class="solr.LogUpdateProcessorFactory"/>
    <processor class="solr.DistributedUpdateProcessorFactory"/>
    <!-- ======================================== -->
    <!-- https://lucene.apache.org/solr/7_4_0/solr-core/org/apache/solr/update/processor/RegexReplaceProcessorFactory.html -->
    <processor class="solr.RegexReplaceProcessorFactory">
      <str name="fieldName">content</str>
      <str name="fieldName">title</str>
      <str name="fieldName">p</str>
      <!-- Case-sensitive (and only one pattern:replacement allowed, so use as many copies): -->
      <!-- of this processor as needed: -->
      <str name="pattern">\s+</str>
      <str name="replacement"> </str>
      <bool name="literalReplacement">true</bool>
    </processor>

    <!-- Solr bug? URLs parse as "rect https..."  Managed-schema (Admin UI): defined p as text_general -->
    <!-- but did not parse. Looking at content | title: text_general copied to string, so added  -->
    <!-- copyfield of p (text_general) as p_str ... regex below now works! -->
    <!-- https://stackoverflow.com/questions/22178700/solr-extractingrequesthandler-extracting-rect-in-links/64882751#64882751 -->
      <processor class="solr.RegexReplaceProcessorFactory">
      <str name="fieldName">content</str>
      <str name="fieldName">title</str>
      <str name="fieldName">p</str>
      <!-- Case-sensitive (and only one pattern:replacement allowed, so use as many copies): -->
      <!-- of this processor as needed: -->
      <str name="pattern">rect http</str>
      <str name="replacement">http</str>
      <bool name="literalReplacement">true</bool>
    </processor>
    <!-- ======================================== -->
    <!-- This needs to be last (may need to clear documents and re-index to see changes, e.g. Solr Admin UI): -->
    <processor class="solr.RunUpdateProcessorFactory"/>
  </updateRequestProcessorChain> 
```

* * *

**托管模式（schema.xml）：**

我通过管理 UI 编辑了 Solr 架构。基本上，对于您想要索引的任何 HTML 元数据，添加一个名称相似的字段（具有适当的类型：例如，`text_general`| `string`| `pdate`| ...）。

例如，为了捕获“doc-id”和“date_pub”元数据，我创建了以下（各自的）模式条目：

```
<field name="doc_id" type="string" uninvertible="true" indexed="true" stored="true"/>
<field name="date_pub" type="pdate" uninvertible="true" indexed="true" stored="true"/> 
```

* * *

**索引**

这是我索引该 HTML 测试文件的方法，

```
[victoria@victoria solr-8.7.0]$ date; pwd; ls -l; echo; ls -l server/solr/gettingstarted/conf/

Tue Nov 17 02:18:12 PM PST 2020

/mnt/Vancouver/apps/solr/solr-8.7.0
total 1792
drwxr-xr-x  3 victoria victoria   4096 Nov 17 13:26 bin
-rw-r--r--  1 victoria victoria 946955 Oct 28 02:40 CHANGES.txt
drwxr-xr-x 12 victoria victoria   4096 Oct 29 07:09 contrib
drwxr-xr-x  4 victoria victoria   4096 Nov 15 12:33 dist
drwxr-xr-x  3 victoria victoria   4096 Nov 15 12:33 docs
drwxr-xr-x  6 victoria victoria   4096 Oct 28 02:40 example
drwxr-xr-x  2 victoria victoria  36864 Oct 28 02:40 licenses
-rw-r--r--  1 victoria victoria  12646 Oct 28 02:21 LICENSE.txt
-rw-r--r--  1 victoria victoria 766662 Oct 28 02:40 LUCENE_CHANGES.txt
-rw-r--r--  1 victoria victoria  27540 Oct 28 02:21 NOTICE.txt
-rw-r--r--  1 victoria victoria   7490 Oct 28 02:40 README.txt
drwxr-xr-x 11 victoria victoria   4096 Nov 15 12:40 server

total 208
drwxr-xr-x 2 victoria victoria  4096 Oct 28 02:21 lang
-rw-r--r-- 1 victoria victoria 33888 Nov 17 13:20 managed-schema
-rw-r--r-- 1 victoria victoria   873 Oct 28 02:21 protwords.txt
-rw-r--r-- 1 victoria victoria 33788 Nov 17 11:36 schema.xml.2020-11-17.13:01
-rw-r--r-- 1 victoria victoria 59248 Nov 17 13:16 solrconfig.xml
-rw-r--r-- 1 victoria victoria 59151 Nov 17 12:59 solrconfig.xml.2020-11-17.13:01
-rw-r--r-- 1 victoria victoria   781 Oct 28 02:21 stopwords.txt
-rw-r--r-- 1 victoria victoria  1124 Oct 28 02:21 synonyms.txt

[victoria@victoria solr-8.7.0]$ solr restart; sleep 1; post -c gettingstarted /mnt/Vancouver/programming/datasci/solr/test/solr_test9.html

Sending stop command to Solr running on port 8983 ... waiting up to 180 seconds to allow Jetty process 3511453 to stop gracefully.
Waiting up to 180 seconds to see Solr running on port 8983 [|]  
Started Solr server on port 8983 (pid=3572520). Happy searching!

/usr/lib/jvm/java-8-openjdk/jre//bin/java -classpath /mnt/Vancouver/apps/solr/solr-8.7.0/dist/solr-core-8.7.0.jar -Dauto=yes -Dc=gettingstarted -Ddata=files org.apache.solr.util.SimplePostTool /mnt/Vancouver/programming/datasci/solr/test/solr_test9.html
SimplePostTool version 5.0.0
Posting files to [base] url http://localhost:8983/solr/gettingstarted/update...
Entering auto mode. File endings considered are xml,json,jsonl,csv,pdf,doc,docx,ppt,pptx,xls,xlsx,odt,odp,ods,ott,otp,ots,rtf,htm,html,txt,log
POSTing file solr_test9.html (text/html) to [base]/extract
1 files indexed.
COMMITting Solr index changes to http://localhost:8983/solr/gettingstarted/update...
Time spent: 0:00:00.755

[victoria@victoria solr-8.7.0]$ 
```

...这是结果（Solr Admin UI：http://localhost:8983/solr/#/gettingstarted/query）

```
http://localhost:8983/solr/gettingstarted/select?q=*%3A*

{
  "responseHeader":{
    "status":0,
    "QTime":0,
    "params":{
      "q":"*:*",
      "_":"1605651674401"}},
  "response":{"numFound":1,"start":0,"numFoundExact":true,"docs":[
      {
        "id":"/mnt/Vancouver/programming/datasci/solr/test/solr_test9.html",
        "stream_size":[1428],
        "x_parsed_by":["org.apache.tika.parser.DefaultParser",
          "org.apache.tika.parser.html.HtmlParser"],
        "stream_content_type":["text/html"],
        "date_created":"2019-11-01T00:00:00Z",
        "date_current":["2020-11-17"],
        "resourcename":["/mnt/Vancouver/programming/datasci/solr/test/solr_test9.html"],
        "title":["Solr HTML Indexing Tests"],
        "date_pub":"2020-11-16T00:00:00Z",
        "doc_id":"bt-ic8eeW2U",
        "source_url":"/mnt/Vancouver/programming/datasci/solr/test/solr_test9.html",
        "dc_title":["Solr HTML Indexing Tests"],
        "content_encoding":["UTF-8"],
        "content_type":["application/xhtml+xml; charset=UTF-8"],
        "content":[" en-us stream_size 1428 X-Parsed-By org.apache.tika.parser.DefaultParser X-Parsed-By org.apache.tika.parser.html.HtmlParser stream_content_type text/html date_created 2019-11-01 resourceName /mnt/Vancouver/programming/datasci/solr/test/solr_test9.html date_pub 2020-11-16 doc_id bt-ic8eeW2U source_url /mnt/Vancouver/programming/datasci/solr/test/solr_test9.html dc:title Solr HTML Indexing Tests Content-Encoding UTF-8 Content-Language en-us Content-Type application/xhtml+xml; charset=UTF-8 Solr HTML Indexing Tests Lorem ipsum dolor sit amet, consectetur adipiscing elit. "],
        "div":[" div1 This text is located in div element 1\. div2 This text is located in div element 2."],
        "p":[" I like apples. I also like bananas. Suspendisse efficitur pulvinar elementum. My website is https://buriedtruth.com/ BuriedTruth.com . Nova Scotia is a province on the east coast of Canada. Halifax is the capital of N.S. Halifax is also N.S.'s largest city. Victoria is the capital of B.C. Vancouver is the largest city in B.C., however. Non-terminated sentence (missing period) Current date: 2020-11-17"],
        "h1":[" Apples Nova Scotia British Columbia"],
        "h2_t":" Bananas Capital of Nova Scotia Capital of British Columbia",
        "_version_":1683647678197530624}]
  }} 
```

* * *

**更新—— `managed-schema`>>`schema.xml`特点：**

虽然与原始问题无关，但以下内容与我的回答（上图）有关——特别是与从 Solr 切换`managed-schema`到经典（用户管理）相关的特性`schema.xml`。它包含在此处以提供完整的解决方案。

首先，添加

```
<schemaFactory class="ClassicIndexSchemaFactory"/> 
```

到你的`solrconfig.xml`文件。

然后编辑这个：-->

```
<updateRequestProcessorChain
  name="add-unknown-fields-to-the-schema"
  default="${update.autoCreateFields:true}"
  processor="uuid,remove-blank,field-name-mutating,parse-boolean,
             parse-long,parse-double,parse-date,add-schema-fields"> 
```

...对此：

```
<updateRequestProcessorChain
  processor="uuid,remove-blank,field-name-mutating,parse-boolean,
             parse-long,parse-double,parse-date"> 
```

即，删除

```
 name="add-unknown-fields-to-the-schema"
  default="${update.autoCreateFields:true}"
  add-schema-fields 
```

重命名`managed-schema`为`schema.xml`，然后重新启动 Solr 或重新加载核心以使更改生效。

为了进一步扩展我的示例（上），这里是一个示例 `<updateRequestProcessorChain />`和输出，位于我还提供的 HTML 代码上（上）。

**solrconfig.xml（部分）：**

```
<updateRequestProcessorChain
  processor="uuid,remove-blank,field-name-mutating,parse-boolean,parse-long,parse-double,parse-date">
  <processor class="solr.LogUpdateProcessorFactory"/>
  <processor class="solr.DistributedUpdateProcessorFactory"/>
  <processor class="solr.RegexReplaceProcessorFactory">
    <str name="fieldName">content</str>
    <str name="fieldName">title</str>
    <str name="fieldName">p</str>
    <!-- Case-sensitive (and only one pattern:replacement allowed, so use as many copies): -->
    <!-- of this processor as needed: -->
    <str name="pattern">\s+</str>
    <str name="replacement"> </str>
    <bool name="literalReplacement">true</bool>
  </processor>

  <processor class="solr.RegexReplaceProcessorFactory">
    <str name="fieldName">content</str>
    <str name="fieldName">title</str>
    <str name="fieldName">p</str>
    <!-- Case-sensitive (and only one pattern:replacement allowed, so use as many copies): -->
    <!-- of this processor as needed: -->
    <str name="pattern">rect http</str>
    <str name="replacement">http</str>
    <bool name="literalReplacement">true</bool>
  </processor>

  <processor class="solr.RegexReplaceProcessorFactory">
    <str name="fieldName">content</str>
    <str name="fieldName">title</str>
    <str name="pattern">[sS]olr</str>
    <str name="replacement">APPLE</str>
    <bool name="literalReplacement">true</bool>
  </processor>

  <processor class="solr.RegexReplaceProcessorFactory">
    <str name="fieldName">content</str>
    <str name="fieldName">title</str>
    <str name="pattern">HTML</str>
    <str name="replacement">BANANA</str>
    <bool name="literalReplacement">true</bool>
  </processor>

  <processor class="solr.RunUpdateProcessorFactory"/>
</updateRequestProcessorChain> 
```

**输出**

*   笔记：

    *   更改为“标题”（`Solr`>> `APPLE`; `HTML`>> `BANANA`）
    *   从“p”中的 URL 中删除“rect”（在此讨论：[Solr ExtractingRequestHandler 在链接中提取“rect”](https://stackoverflow.com/questions/22178700/solr-extractingrequesthandler-extracting-rect-in-links/64882751#64882751)）

```
{
  "responseHeader":{
    "status":0,
    "QTime":32,
    "params":{
      "q":"*:*",
      "_":"1605767164812"}},
  "response":{"numFound":1,"start":0,"numFoundExact":true,"docs":[
      {
        "id":"/mnt/Vancouver/programming/datasci/solr/test/solr_test9.html",
        "stream_size":[1628],
        "x_parsed_by":["org.apache.tika.parser.DefaultParser",
          "org.apache.tika.parser.html.HtmlParser"],
        "stream_content_type":["text/html"],
        "date_created":"2020-11-11T21:36:38Z",
        "date_current":["2020-11-17"],
        "resourcename":["/mnt/Vancouver/programming/datasci/solr/test/solr_test9.html"],
        "title":["APPLE BANANA Indexing Tests"],
        "date_pub":"2020-11-16T21:37:18Z",
        "doc_id":"bt-ic8eeW2U",
        "source_url":"/mnt/Vancouver/programming/datasci/solr/test/solr_test9.html",
        "dc_title":["Solr HTML Indexing Tests"],
        "content_encoding":["UTF-8"],
        "content_type":["application/xhtml+xml; charset=UTF-8"],
        "content":[" en-us stream_size 1628 X-Parsed-By org.apache.tika.parser.DefaultParser X-Parsed-By org.apache.tika.parser.html.HtmlParser stream_content_type text/html date_created 2020-11-11T21:36:38Z resourceName /mnt/Vancouver/programming/datasci/APPLE/test/APPLE_test9.html date_pub 2020-11-16T21:37:18Z doc_id bt-ic8eeW2U source_url /mnt/Vancouver/programming/datasci/APPLE/test/APPLE_test9.html dc:title APPLE BANANA Indexing Tests Content-Encoding UTF-8 Content-Language en-us Content-Type application/xhtml+xml; charset=UTF-8 APPLE BANANA Indexing Tests Lorem ipsum dolor sit amet, consectetur adipiscing elit. "],
        "div":[" div1 This text is located in div element 1\. div2 This text is located in div element 2\. apple This text is located in the \"apple\" (class) div element. banana This text is located in the \"banana\" (class) div element."],
        "p":[" I like apples. I also like bananas. Suspendisse efficitur pulvinar elementum. My website is https://buriedtruth.com/ BuriedTruth.com . Nova Scotia is a province on the east coast of Canada. Halifax is the capital of N.S. Halifax is also N.S.'s largest city. Victoria is the capital of B.C. Vancouver is the largest city in B.C., however. Non-terminated sentence (missing period) Current date: 2020-11-17"],
        "h1":[" Apples Nova Scotia British Columbia"],
        "h2_t":" Bananas Capital of Nova Scotia Capital of British Columbia",
        "_version_":1683814668971278336}]
  }} 
```

# magento - Magento 标题中的自定义货币切换器消失了？

> ID：15005924
> 
> 赞同：0
> 
> 时间：2013-02-21T15:25:28.090
> 
> 标签：magento, block, magento-1.7

我昨天为我的标题构建了一个自定义货币切换器，一切正常。今天我来设置目录页面，发现自己需要删除左栏中的标准货币切换器，我打开了我的 local.xml 并添加了对货币的删除。也许是愚蠢的选择，当我突然注意到我在我的一个文件中所做的某件事阻止了我的标题自定义货币切换器显示时，我设法让 left.currency 被删除。

**本地.xml**

```
<?xml version="1.0" encoding="UTF-8"?>
    <layout>
    <default>
    <!-- Remove callouts and rarely used stuff -->
    <remove name="right.poll"/>
    <remove name="right.permanent.callout"/>
    <remove name="left.permanent.callout"/>
    <remove name="paypal.partner.right.logo"/>
    <remove name="catalog.compare.list" />

    <!-- add the local stylesheet -->
    <reference name="head">
        <action method="addCss"><stylesheet>css/smoothness/jquery-ui-1.10.1.custom.css</stylesheet></action>
        <action method="addJs"><script>ahoy/jquery-1.9.1.js</script></action>
        <action method="addJs"><script>ahoy/jquery-ui-1.10.1.custom.js</script></action>
        <action method="addJs"><script>ahoy/script.js</script></action>

        <action method="addCss"><stylesheet>css/1140.css</stylesheet></action>
        <action method="addCss"><stylesheet>css/ahoy.css</stylesheet></action>          
    </reference>
    <reference name="header">
        <block type="template/currency" name="custom_currency_selector" template="currency/currency.phtml"/>
    </reference>

</default>

<catalog_category_view>
    <reference name="root">
        <action method="setTemplate"><template>page/2columns-left.phtml</template></action>
    </reference>
</catalog_category_view> 
```

**header.phtml 的第一部分**

```
<div class="header">
<div class="row">
    <div class="row">   
        <div class="sixcol">
            <?php echo $this->getChildHtml('topLinks') ?>
            <?php echo $this->getChildHtml('custom_currency_selector') ?>
        </div>
        <div class="sixcol last">
            <div class="row"> 
```

**测试/默认/模板/货币/currency.phtml**

```
<?php if($this->getCurrencyCount() > 1): ?>
<div class="currency-block">
<ul>
    <?php foreach ($this->getCurrencies() as $_code => $_name): ?>

    <?php $active = ($_code==$this->getCurrentCurrencyCode()) ? "active":""; ?>
    <li>
        <a class="<?php echo $active; ?>" href="<?php echo $this->getSwitchCurrencyUrl() . "currency/" . $_code; ?>" title="Set <?php echo $_code; ?> as your chosen currency">
            <?php echo Mage::app()->getLocale()->currency($_code)->getSymbol(); ?>
        </a>
    </li>
    <?php endforeach; ?>
</ul> 
```

据我所知，这就是创建块、分配其位置并调用它所需的全部内容。我在摆弄时一直在清除缓存，我重新加载了货币转换数据，在本地删除并重新测试了删除左柱货币的“删除”，在我删除了 left.currency 的删除后，现在又回来了但第一名再也没有回来。

这些是我当前的文件，所以现在根本没有删除货币，我不确定它什么时候消失了，但我一直在玩左侧边栏的东西，在 css 挣扎之后我试图删除货币，因为我没有知道如何引用它试图杀死我能找到的所有货币，当我抽动时，我不再确定何时删除了顶级货币。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-21T18:13:32.557

尝试更改`type="template/currency"`为`type="directory/currency"`

# linux - 从源代码编译 atk

> ID：15005935
> 
> 赞同：0
> 
> 时间：2013-02-21T15:26:04.113
> 
> 标签：linux, compilation, configure, glib

我试图从源代码编译 atk 2.7.91。由于我正在使用较旧的 ubuntu 系统，因此没有所需的 glib 版本的最新软件包。所以我刚刚下载了 glib 2.35.8 并成功完成`./configure`了`make`它（我不想在系统范围内安装它，所以我没有这样做`make install`）。

假设这个 glib 在`/foobar/glib-2.35.8`. 现在我`cd`要`/foobar/atk-2.7.91`导出`PKG_CONFIG_PATH`: `export PKG_CONFIG_PATH=/foobar/glib-2.35.8:$PKG_CONFIG_PATH`。

然后

`pkg-config --modversion glib-2.0`

告诉我：

`2.35.8`

但是当我这样做时，`./configure`我收到错误消息：

```
checking for GLIB - version >= 2.31.2... no
*** Could not run GLIB test program, checking why...
*** The test program failed to compile or link. See the file config.log for the
*** exact error that occured. This usually means GLIB is incorrectly installed.
configure: error: 
*** GLIB 2.31.2 or better is required. The latest version of
*** GLIB is always available from ftp://ftp.gtk.org/. If GLIB is installed
*** but not in the same location as pkg-config add the location of the file
*** glib-2.0.pc to the environment variable PKG_CONFIG_PATH. 
```

`cat config.log |grep glib`给出：

```
configure:12143: checking for GLIB - version >= 2.31.2
configure:12258: gcc -o conftest -g -O2 -Wall -I/usr/local/include/glib-2.0 -I/usr/local/lib/glib-2.0/include    -DG_DISABLE_SINGLE_INCLUDES -DATK_DISABLE_SINGLE_INCLUDES  conftest.c -L/usr/local/lib -lgobject-2.0 -lglib-2.0    >&5
conftest.c:25:18: fatal error: glib.h: No such file or directory
| #include <glib.h>
|   fclose (fopen ("conf.glibtest", "w"));
|   if ((glib_major_version != 2) ||
|       (glib_minor_version != 35) ||
|       (glib_micro_version != 8))
|       printf("\n*** 'pkg-config --modversion glib-2.0' returned %d.%d.%d, but GLIB (%d.%d.%d)\n",
|              glib_major_version, glib_minor_version, glib_micro_version);
|       printf ("*** to remove the old version of GLib. You may also be able to fix the error\n");
|   else if ((glib_major_version != GLIB_MAJOR_VERSION) ||
|      (glib_minor_version != GLIB_MINOR_VERSION) ||
|            (glib_micro_version != GLIB_MICRO_VERSION))
|       printf("*** GLIB header files (version %d.%d.%d) do not match\n",
|        GLIB_MAJOR_VERSION, GLIB_MINOR_VERSION, GLIB_MICRO_VERSION);
|        glib_major_version, glib_minor_version, glib_micro_version);
|       if ((glib_major_version > major) ||
|         ((glib_major_version == major) && (glib_minor_version > minor)) ||
|         ((glib_major_version == major) && (glib_minor_version == minor) && (glib_micro_version >= micro)))
|         printf("\n*** An old version of GLIB (%u.%u.%u) was found.\n",
|                glib_major_version, glib_minor_version, glib_micro_version);
|         printf("*** You need a version of GLIB newer than %u.%u.%u. The latest version of\n",
|         printf("*** GLIB is always available from ftp://ftp.gtk.org.\n");
|         printf("*** of GLIB, but you can also set the PKG_CONFIG environment to point to the\n");
configure:12304: gcc -o conftest -g -O2 -Wall -I/usr/local/include/glib-2.0 -I/usr/local/lib/glib-2.0/include    -DG_DISABLE_SINGLE_INCLUDES -DATK_DISABLE_SINGLE_INCLUDES  conftest.c  -L/usr/local/lib -lgobject-2.0 -lglib-2.0   >&5
conftest.c:25:18: fatal error: glib.h: No such file or directory
| #include <glib.h>
|  return ((glib_major_version) || (glib_minor_version) || (glib_micro_version));
*** GLIB 2.31.2 or better is required. The latest version of
*** GLIB is always available from ftp://ftp.gtk.org/. If GLIB is installed
*** glib-2.0.pc to the environment variable PKG_CONFIG_PATH.
ac_cv_env_PKG_CONFIG_PATH_value=/foobar/glib-2.35.8/:
GLIB_CFLAGS=''
GLIB_COMPILE_RESOURCES=''
GLIB_GENMARSHAL=''
GLIB_LIBS=''
GLIB_MKENUMS=''
GLIB_PACKAGES='gobject-2.0'
GLIB_REQUIRED_VERSION='2.31.2'
PKG_CONFIG_PATH='/foobar/glib-2.35.8/:' 
```

知道这里出了什么问题以及如何解决吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-21T21:39:56.647

## 简短的回答

正如（几乎）始终手册是您的朋友。试着看看`man pkg-config`你会发现它`.pc`是 pkg-config 执行它的工作所需的文件。`glib-2.0.pc`在你的情况下。不幸的是，这并不像仅仅指向存储它的位置那么简单，而是把它留到最后，然后先看一下手册页。

> pkg-config 从特殊元数据文件中检索有关包的信息。这些文件以包命名，并具有 .pc 扩展名。在大多数系统上，pkg-config 会查找这些文件。它还将查看由 PKG_CONFIG_PATH 环境变量指定的以冒号分隔（在 Windows 上以分号分隔）的目录列表。
> 
> pkg-config 命令行上指定的包名称被定义为元数据文件的名称，减去 .pc 扩展名。如果一个库可以同时安装多个版本，它必须给每个版本一个自己的名字（例如，GTK 1.2 可能有包名“gtk+”，而 GTK 2.0 有“gtk+-2.0”）。

我希望你觉得有趣

> 在大多数系统上，pkg-config 会查找并查找这些文件

线。结果可能在您的系统上有所不同，但在我的系统上它实际上以这种方式显示，这很可能是一个错误。

`pkg-config --variable pc_path pkg-config`不过，您可以通过运行which 例如 prints来找出标准目录中编译的 内容

```
/usr/local/lib/pkgconfig:/usr/local/lib/pkgconfig/i486-linux-gnu:/usr/local/share/pkgconfig:/usr/lib/pkgconfig:/usr/lib/pkgconfig/i486-linux-gnu:/usr/share/pkgconfig 
```

在我的系统上。

## 长答案

回到你原来的问题，看看一个示例`.pc`文件可能最好地解释为什么你的第一次努力是徒劳的。作为示例，这里是`glib-2.0.pc`我系统上文件的内容：

```
prefix=/usr
exec_prefix=${prefix}
libdir=${exec_prefix}/lib
includedir=${prefix}/include

glib_genmarshal=glib-genmarshal
gobject_query=gobject-query
glib_mkenums=glib-mkenums

Name: GLib
Description: C Utility Library
Version: 2.24.2
Libs: -L${libdir} -lglib-2.0 
Libs.private: 
Cflags: -I${includedir}/glib-2.0 -I${libdir}/glib-2.0/include 
```

正如您希望看到的那样，整个路径都是硬连线的。不要被`${libdir}`……之类的东西弄糊涂了。仔细观察，您会发现它们都是从`prefix=/usr`第一行构建的。

试图将 PKG_CONFIG_PATH 指向 glib 的构建目录的原因将无法作为`.pc`安装目录中指定的路径而不是构建目录的位置。

这就是您的`pkg-config --modversion`测试运行良好的原因：`.pc`确实找到了该文件并包含给定的信息，但编译失败：`.pc`在第一种情况下找到了该文件，但文件中给出的路径`.pc`完全错误。

没有人可以禁止您仅将 中给定的目录更改为`.pc`您喜欢的任何路径，因此实际上您可以通过手动修复`.pc`文件中给定的路径来使新构建的库在其构建目录中工作。至少如果库本身不包含任何硬连线路径，但这只会在运行时成为问题，而不是在链接时。

甚至解决最后一个难题 -`.pc`文件怎么会知道它将被安装到哪里来给出正确的前缀？只需查看您的源目录即可。伴随您的`glib-2.0.pc`文件，您会找到一个名为`glib-2.0.pc.in`那里的文件，其内容如下所示：

```
prefix=@prefix@
exec_prefix=@exec_prefix@
libdir=@libdir@
includedir=@includedir@

glib_genmarshal=glib-genmarshal
gobject_query=gobject-query
glib_mkenums=glib-mkenums

Name: GLib
Description: C Utility Library
Version: @VERSION@
Requires.private: @PCRE_REQUIRES@
Libs: -L${libdir} -lglib-2.0 @INTLLIBS@
Libs.private: @G_THREAD_LIBS@ @G_LIBS_EXTRA@ @PCRE_LIBS@ @INTLLIBS@ @ICONV_LIBS@
Cflags: -I${includedir}/glib-2.0 -I${libdir}/glib-2.0/include @GLIB_EXTRA_CFLAGS@ 
```

`@....@`运行时在配置时填写的整个占位符`configure`。ie`@prefix@`填充`--prefix=`了命令行中给出的参数，而其他类似`@NTLLIBS@`填充了配置脚本检测到的参数。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-21T18:42:09.620

您需要在某处安装 glib，不能只将 ATK 指向 Glib 构建目录。您可以将它安装在像 ~/install 这样的私有位置

`./configure --prefix=/home/<username>/install`

（配置不喜欢~IIRC）

# android - ListFragment onCreate 调用了两次

> ID：15005937
> 
> 赞同：1
> 
> 时间：2013-02-21T15:26:05.810
> 
> 标签：android, fragment

如何避免 ListFragment 中的 onCreate 方法被调用两次？

我的列表有搜索功能。搜索结果可能比我在创建 ListFragment 后显示的列表短（此时您可以在后台看到长列表，在前台看到带有搜索结果的较短列表）。

这是我的代码片段：

在我的 FragmentActivity 中：

```
@Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        plantManager = new PlantManager(this); 
        listFragment = new PlantListFragment();
        fragmentActivityListener = listFragment;

        if(getSupportFragmentManager().findFragmentByTag(tag) == null){
            try{
                getSupportFragmentManager().beginTransaction().replace(R.id.fragment_plantlist, listFragment,tag).commit();
            }catch(Exception ex){
                ex.printStackTrace();
                CharSequence text = this.getString(R.string.info_error_list);
                Toast toast = Toast.makeText(this, text, Toast.LENGTH_LONG);
                toast.show();
            }
        }

        //force commit
        getSupportFragmentManager().executePendingTransactions();

        buttonSearch = (Button) findViewById(R.id.button_search);
        buttonSearch.setOnClickListener(searchListAktionen);
    } 
```

来自我的 ListFragment：

```
@Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        if(savedInstanceState == null){
            Log.d(TAG, "onCreate called"); 
            plantManager = new PlantManager(getActivity()); 
            loader = getLoaderManager().initLoader(0, null, this);
            myAdapter = new PlantListCustomCursorAdapter(getActivity(), myCursor);
        }
    }

    /**
     * @param savedInstanceState
     */
    @Override
    public void onActivityCreated(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        if(savedInstanceState == null){
            Log.d(TAG, "onActivityCreated called"); 
            //          ListView lv = getListView();
            //          LayoutInflater inflater = this.getLayoutInflater(savedInstanceState);
            //          ViewGroup header = (ViewGroup)inflater.inflate(R.layout.header_aktionenlist, lv, false);
            //          lv.addHeaderView(header, null, false);
            this.getListView().setAdapter(myAdapter);
        }
    } 
```

为什么这些方法被调用两次？

提前感谢您的回答，

更新但它仍然不起作用：

```
 @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        if (savedInstanceState == null) {
            if(getSupportFragmentManager().findFragmentByTag(tag) == null){
                setContentView(R.layout.activity_main);
                listFragment = new PlantListFragment();
                try{
                    getSupportFragmentManager().beginTransaction().replace(R.id.fragment_plantlist, listFragment,tag).commit();
                    //force commit
//                  getSupportFragmentManager().executePendingTransactions();
                }catch(Exception ex){
                    ex.printStackTrace();
                    CharSequence text = this.getString(R.string.info_error_list);
                    Toast toast = Toast.makeText(this, text, Toast.LENGTH_LONG);
                    toast.show();
                }
            }
        }
        fragmentActivityListener = listFragment;
        plantManager = new PlantManager(this); 

        buttonSearch = (Button) findViewById(R.id.button_search);
        buttonSearch.setOnClickListener(searchListAktionen);
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-21T15:37:52.307

把你的片段初始化代码`if-else`像这样：

```
if (savedInstanceState == null) {
    listFragment = new PlantListFragment();
    if(getSupportFragmentManager().findFragmentByTag(tag) == null){
        try{
            getSupportFragmentManager().beginTransaction().replace(R.id.fragment_plantlist, listFragment,tag).commit();
        }catch(Exception ex){
            ex.printStackTrace();
            CharSequence text = this.getString(R.string.info_error_list);
            Toast toast = Toast.makeText(this, text, Toast.LENGTH_LONG);
            toast.show();
        }
    }

    //why you are force committing?
    //getSupportFragmentManager().executePendingTransactions();
} 
```

它会解决你的问题。确保将`listFragment = new PlantListFragment();`线移到里面`if-else`。

# html - @font-face 使用 CSS3 关键帧动画时字体被裁剪

> ID：15005938
> 
> 赞同：0
> 
> 时间：2013-02-21T15:26:08.123
> 
> 标签：html, css, font-face, css-transitions

我有四个绝对定位的 div，它们使用 css3`@-webkit-keyframe`动画淡入和移动。我注意到的是，`@font-face`我正在使用的一些衬线和下降线在 div 的自动计算边缘处被裁剪。（我正在使用`text-align: left`，所以我只在 div 的左边缘和下边缘注意到这一点。

我可以通过为 div 定义固定大小并更改为 来解决此问题`text-align: center`，但我很好奇是否有更好的方法来解决此问题，因此如果文本更改，我不必更改 div 的大小或者如果我需要更改`font-size`.

编辑：这里有一些代码可以让你了解我在做什么

```
div#text_2
{ 
    position: absolute;
    top: 288px;
    left: 100px;
    font-size: 65px;
    color: #C0DB81;
    font-family: 'TFArrow-Medium'; /* This is defined in another css file */
    -webkit-animation-delay: 0s;
    -webkit-animation-timing-function: cubic-bezier(0, 0, 0.35, 1.0);
    -webkit-transform: translateZ(0);
    -webkit-animation-duration: 4s;
    -webkit-animation-name: text_fade_in2;
}

@-webkit-keyframes text_fade_in2
{
    0%      { opacity: 0; }
    25%     { opacity: 0; }
    50%     { opacity: 1; }
    100%    { opacity: 1; }
} 
```

这解决了裁剪问题：

```
div#text_2
{ 
    position: absolute;
    top: 288px;
    left: 100px;
    font-size: 65px;
    color: #C0DB81;
    font-family: 'TFArrow-Medium'; /* This is defined in another css file */
    -webkit-animation-delay: 0s;
    -webkit-animation-timing-function: cubic-bezier(0, 0, 0.35, 1.0);
    -webkit-transform: translateZ(0);
    -webkit-animation-duration: 4s;
    -webkit-animation-name: text_fade_in2;
    height: 65; /* 60px is the auto-calculated height in Safari */
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-24T19:57:06.303

我与一些 WebKit 开发人员交谈，发现了一个新的 WebKit 错误。他们用网络渲染术语说话（我对此一无所知），但我相信这是他们打开的问题：[https ://bugs.webkit.org/show_bug.cgi?id=117540](https://bugs.webkit.org/show_bug.cgi?id=117540)

与此同时，一种解决方法是将此 CSS 添加到您的网页中（警告：这将大大增加大量文本的渲染时间）：

```
* { text-rendering: optimizelegibility; } 
```

# javascript - jQuery Animated Div 在点击“返回”后移动

> ID：15005948
> 
> 赞同：0
> 
> 时间：2013-02-21T15:26:42.420
> 
> 标签：javascript, jquery, html

我目前正在为自己整理一个投资组合。我遇到了 jQuery animate 函数的问题。我正在使用 animate 函数移动几个 div，然后加载不同的页面。问题是，当在 Firefox（没有其他浏览器）中，如果用户加载不同的页面然后按“返回”返回上一页，被 jQuery 移动的 div 仍然在移动的位置，而不是它们的原始位置动画之前。有谁知道会导致什么？

这是链接。[http://evanfrancis.com/beta/index.php](http://evanfrancis.com/beta/index.php)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T16:02:40.647

经过进一步搜索，我在这里找到了答案[jQuery page transition and browser history](https://stackoverflow.com/questions/3628459/jquery-page-transition-and-browser-history/3695577#3695577)

我只需要添加一个 onunload 事件来防止浏览器缓存

```
<body onunload""> 
```

# excel - 如何使用coldfusion创建xlsx文件

> ID：15005951
> 
> 赞同：7
> 
> 时间：2013-02-21T15:26:45.147
> 
> 标签：excel, coldfusion, excel-2007, openxml, excel-2010

免责声明：我是冷融合的新手。我正在尝试创建一个包含图像和多个选项卡的 Excel 2010 文档。我已经能够将其输出到 XLS 中，但我无法将图像放入文件中。

我无法找到如何正确创建 XLSx 文件的完整示例。我宁愿学习正确的方法，以后养成自己的坏习惯，而不是仅仅养成坏习惯。

这是一个例子：

```
<!--- Make CF export to Excel --->
<!--- This will create a XLS file --->
<!--- <cfheader name="Content-Disposition" value="attachment; filename=#URL.TRNo#_image.xls">
<cfcontent type="application/vnd.msexcel"> --->

<!--- This does not work to create an XLSX file --->
<cfheader name="Content-Disposition" value="inline; filename=#URL.TRNo#_image.xlsx">
<cfcontent type="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"> 

<cfparam name="URL.TRNo" default="AD0310">

<cfoutput>
    <?xml version="1.0"?>
    <Workbook xmlns="urn:schemas-microsoft-com:office:spreadsheet" xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet">
        <ss:Styles>
            <ss:Style ss:ID="Default" ss:Name="Normal">
                <ss:Font ss:Size="11" ss:FontName="Calibri"/>
            </ss:Style>
            <ss:Style ss:ID="Left">
                <ss:Alignment ss:Horizontal="Left"/>
            </ss:Style>
            <ss:Style ss:ID="Center">
                <ss:Alignment ss:Horizontal="Center"/>
            </ss:Style>
            <ss:Style ss:ID="Right">
                <ss:Alignment ss:Horizontal="Right"/>
            </ss:Style>
        </ss:Styles>

        <Worksheet ss:Name="#URL.TRNo# page 1">
            <ss:Table ss:DefaultColumnWidth="15" ss:DefaultRowHeight="15">
                <Row ss:Height="51"><!--- Start Row 1 --->
                    <Cell ss:Index="1" ss:MergeAcross="9">
                        <Data ss:Type="String">Final Test Report</Data>
                    </Cell>
                    <Cell ss:Index="11" ss:MergeAcross="10" ss:StyleID="Center">
                        <Data ss:Type="String"><!--- <img src="http://wwwdev.elmsweb.ford.com/elmsGEN3/SafetyLab/FMVSS/ReportWriter/img/fordLogo_transparent_small.png" height="68" width="181" alt="13"> ---></Data>
                    </Cell>
                    <Cell ss:Index="22" ss:MergeAcross="9" ss:StyleID="Right">
                        <Data ss:Type="String">Confidential</Data>
                    </Cell>
                </Row><!--- End Row 1 --->
                <Row/><!--- Row 2 Blank --->
                <Row><!--- Start Row 3 --->
                    <Cell ss:Index="1" ss:MergeAcross="1" ss:StyleID="Right">
                        <Data ss:Type="String">To:</Data>
                    </Cell>
                    <Cell ss:Index="3" ss:MergeAcross="12">
                        <Data ss:Type="String"></Data>
                    </Cell>
                    <Cell ss:Index="16" ss:MergeAcross="10" ss:StyleID="Right">
                        <Data ss:Type="String">Test Order:</Data>
                    </Cell>
                    <Cell ss:Index="27" ss:MergeAcross="4">
                        <Data ss:Type="String">#URL.TRNo#</Data>
                    </Cell>
                </Row><!--- End Row 3 --->
            </ss:Table>
        </Worksheet>
    </Workbook>
</cfoutput> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-04T13:50:31.627

我建议使用 ColdFusion 的内置电子表格功能（在版本 9 中首次引入）。这是[SpreadsheetNew 函数的文档](http://help.adobe.com/en_US/ColdFusion/9.0/CFMLRef/WSc3ff6d0ea77859461172e0811cbec22c24-747b.html)。如果将`xmlformat`参数设置为“true”，它将创建一个 .xlsx 文件。

关于如何使用这些 ColdFusion 功能，网络上有几个示例（以及这里的 SO）。 [Raymond Camden 在这里有一个很好的示例](http://www.raymondcamden.com/index.cfm/2011/7/11/Quick-followup-to-my-CFSpreadSheet-Samples)，说明如何生成电子表格并使用`cfcontent`标签直接将其交付给用户。 [这是 Raymond 的另一个示例，](http://www.raymondcamden.com/index.cfm/2011/7/12/One-more-I-swear-this-is-it-follow-up-to-my-CFSpreadSheet-Example)它建立在第一个示例的基础上。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-07-25T11:59:13.157

我整个星期都在做这件事，并想分享结果。此代码适用于我在 Windows Server 2008 R2 上使用 CF 9。顺便说一句，CFSpreadsheet 似乎在较大的导出上消耗了大量内存。为此，我们增加了服务器的物理内存，然后在 Administrator -> Java and JVM settings 中使用 CF Administrator 来增加 jvm 堆大小。我的最大 Java 堆大小现在是 3072 Gig。需要帮忙？我建议您就服务器问题联系 Charlie Arehart：charlie@carehart.org

代码：

示例查询称为“Myquery” 电子表格称为“Myspreadsheet” 我将电子表格导出到名为“xlsx”的子目录中 我使用 cflocation 将浏览器定向到电子表格。浏览器提示用户打开、保存或取消。

```
<cfset var_filenameis = "Myspreadsheet.xlsx">
<cfset SpreadsheetObj = spreadsheetNew("true")>
<cfset SpreadsheetObj = spreadsheetNew("#var_filenameis#","yes")>

<cfspreadsheet action="write" filename="./xlsx/#var_filenameis#" query="Myquery" overwrite="true"> 

<cflocation url = "./xlsx/#var_filenameis#"> 
```

戴夫·克拉夫特

# mysql - 列在mysql中显示

> ID：15005955
> 
> 赞同：0
> 
> 时间：2013-02-21T15:26:52.853
> 
> 标签：mysql, sql, database

我正在尝试构建一个显示名字和姓氏以及“打开者”标签的查询。这是查询：

```
SELECT a.account_id, 
       a.cust_id, 
       a.last_activity_date, 
       a.open_emp_id, 
       Concat(' Opened By ', e.fname, ' ', e.lname), 
       a.avail_balance 
FROM   account a 
       INNER JOIN employee e 
               ON a.open_emp_id = e. emp_id 
WHERE  NOT EXISTS (SELECT 1 
                   FROM   transaction t 
                   WHERE  t.txn_date = a.last_activity_date); 
```

它工作得很好，除了列标签说`CONCAT(' Opened By ', e.fname, ' ', e.lname)`而不是`e.fname`& `e.lname`。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-21T15:28:14.010

使用别名：

```
CONCAT(' Opened By ', e.fname, ' ', e.lname) AS opened_by 
```

您现在可以引用该结果，就好像它来自名为`opened_by`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-21T15:28:35.357

使用别名...

```
...
Concat(' Opened By ', e.fname, ' ', e.lname) AS 'openedBy',
... 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-21T15:28:44.793

您可以使用`AS`关键字来命名列：

```
SELECT a.account_id, a.cust_id, a.last_activity_date, a.open_emp_id, 
CONCAT(' Opened By ', e.fname, ' ', e.lname) AS opened_by, a.avail_balance
FROM account a INNER JOIN employee e
ON a.open_emp_id = e. emp_id
WHERE NOT EXISTS (SELECT 1
FROM transaction t
WHERE t.txn_date = a.last_activity_date); 
```

# java - 在渲染之前获取 TextView 的高度

> ID：15005964
> 
> 赞同：0
> 
> 时间：2013-02-21T15:27:02.880
> 
> 标签：java, android, textview, android-linearlayout

我试图以某种方式获得 TextView 的高度（实际上是在渲染它之前，因为它必须适合 ListView）。

我试过了

```
Rect currentBounds = new Rect();
textview1.getPaint().getTextBounds(textview1.getText().toString(), 0,
                                       textview1.length(), currentBounds);
String size = rect.height(); 
```

...但我总是得到相同的高度数字。文本始终具有相同的宽度（显示的宽度）；也许这是一个问题？

或者，我通过 StaticLayout 进行了尝试：

```
Display display = getWindowManager().getDefaultDisplay();
Point size = new Point();
display.getSize(size);
int width = size.x;                                     

StaticLayout measure = new StaticLayout(textview11.getText(), textview1.getPaint(), 
    width, Layout.Alignment.ALIGN_NORMAL, 1.0f, 1.0f, false); 
```

但也在这里，我只是得到奇数，我真的不知道如何处理......它们与上面的完全不同，无论我如何转换它们......

通过以下方式设置 LinearLayout 的新高度：

```
LinearLayout layout = (LinearLayout)findViewById(R.id.ll);
LayoutParams params = layout.getLayoutParams();
params.height = height; 
```

我希望你能听懂我的言论。告诉我，如果我需要澄清更多的事情...

谢谢！

# java - 通配符类型在类型参数中提供什么灵活性？

> ID：15005968
> 
> 赞同：1
> 
> 时间：2013-02-21T15:27:22.607
> 
> 标签：java, generics

考虑静态实用程序中的通用`min`方法，该方法旨在返回 set 中的最小元素。为什么我们需要将其声明为

```
 public static <T extends Comparable<? super T>> T min(Set<? extends T> producerSet) 
```

如果我们改为将其声明为

```
public static <T extends Comparable<T>> T min(Set<? extends T> producerSet) 
```

type 参数中的通配符类型在这里给了我什么灵活性？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-10T02:11:15.913

这涵盖了 T 是 Comparable 实现者的子类的情况。考虑以下：

```
public static class A implements Comparable<A> {

   public int compareTo(A o) {
      return 0;
   }
}
public static class B extends A {}

public static <T extends Comparable<T>> T min(Set<? extends T> producerSet) {
   return null;
}

public static void main(String[] args) {
   Set<B> set = new HashSet<B>();
   min(set); // incompatible with method signature
} 
```

# java - 在 JMock 中访问包私有类时出现 IllegalAccessError

> ID：15005971
> 
> 赞同：1
> 
> 时间：2013-02-21T15:27:23.903
> 
> 标签：java, junit, jmock

我使用 JMock 2.6.0-RC2 编写了一个单元测试，它使用了几个包私有类。出于某种原因，这会导致`IllegalAccessError`：

```
java.lang.IllegalAccessError: tried to access class foo.PackagePrivateClass from class $Proxy6
    at $Proxy6.getInstance(Unknown Source)
    at foo.UsingClass.<init>(UsingClass.java:6)
    at foo.FailingTest.testFailure(FailingTest.java:29) 
```

我已经上传了一个最小的 Maven 项目来演示这个问题：http: [//dl.dropbox.com/u/108474287/example-project.zip](http://dl.dropbox.com/u/108474287/example-project.zip)。相关代码也如下所示（相当简洁）。

为什么我在测试中看到错误？测试类与测试类是同一个包的一部分，所以我不认为访问控制是一个问题。

一些有趣的观察：

1.  如果我更改`ExampleInterface`为包私有（而不是公共），问题就会消失。可悲的是，在我的现实项目中，这是不可能的。

2.  仅当我从模拟对象返回值时才会发生异常。下载我的示例项目的人会看到另一个`null`返回的测试；这个测试通过了。

3.  如果我将所有类移动到默认包中，则测试通过！如果所有类都保留在 package`foo`中，则测试失败。

以下是我的项目中包含的文件。我在上面链接的 ZIP 是一个包含所有这些的小型 Maven 项目。

*我也将这个问题发布到了 JMock 开发者列表中。如果我在那里收到答案，我会更新这个问题（反之亦然）。*

* * *

**失败测试.java**

```
package foo;

// Imports omitted

@RunWith(JMock.class)
public class FailingTest {

  private static final PackagePrivateClass EXAMPLE_INSTANCE = 
      new PackagePrivateClass();

  public Mockery context = new JUnit4Mockery();

  @Test
  public void testFailure() {
    final ExampleInterface exampleInterface = context
        .mock(ExampleInterface.class);

    context.checking(new Expectations() {
      {
        oneOf(exampleInterface).getInstance(); 
        will(returnValue(EXAMPLE_INSTANCE));
      }
    });

    new UsingClass(exampleInterface); <-- exception thrown from constructor
  }
} 
```

**ExampleInterface.java**

```
package foo;

public interface ExampleInterface {
  PackagePrivateClass getInstance();
} 
```

**PackagePrivateClass.java**

```
package foo;

class PackagePrivateClass {

  PackagePrivateClass() {}

  @Override
  public String toString() {
    return "Hello, World!";
  }
} 
```

**使用Class.java**

```
package foo;

class UsingClass {

  UsingClass(ExampleInterface exampleInterface) {
    PackagePrivateClass bar = exampleInterface.getInstance(); // <--- exception
    System.out.println(bar);                                  // originates here
  }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T09:09:39.860

*为未来的读者提供更新......*

目前，我认为这是 JMock 中的一个错误。我已经在 J​​Mock github 页面上提交了它：[https](https://github.com/jmock-developers/jmock-library/issues/43) ://github.com/jmock-developers/jmock-library/issues/43 。还没有回复（也没有对我在邮件列表上的评论）。

我已经切换到[Mockito](http://code.google.com/p/mockito/)，它能够处理完全相同的情况而不会出错。

# java - Java序列化到数组

> ID：15005973
> 
> 赞同：0
> 
> 时间：2013-02-21T15:27:30.047
> 
> 标签：java, serialization

我正在尝试序列化按钮矩阵（`new JButton [6][6]`;），以便我可以将值保存到文件中，然后将它们重新加载到矩阵中。我在网上找到了成功保存数据的代码，但我无法加载数据并将其值返回到矩阵。

我尝试使用以下代码：

```
public class SaveListener implements ActionListener {
    public void actionPerformed(ActionEvent ab) {
        saveArray("customlevel", buttons);
    }

    public void saveArray(String filename, JButton[][] write) {
        try {
            FileOutputStream fos = new FileOutputStream(filename);
            GZIPOutputStream gzos = new GZIPOutputStream(fos);
            ObjectOutputStream out = new ObjectOutputStream(gzos);
            out.writeObject(write);
            out.flush();
            out.close();
        } catch (IOException e) {
            System.out.println(e);
        }
    }
}

public class LoadListener implements ActionListener {
    public void actionPerformed(ActionEvent e) {
        loadArray("customlevel", buttons);
    }
}

public JButton[][] loadArray(String filename, JButton[][] read) {
    try {
        FileInputStream fis = new FileInputStream(filename);
        GZIPInputStream gzis = new GZIPInputStream(fis);
        ObjectInputStream in = new ObjectInputStream(gzis);
        // in.readObject(read);
        JButton[][] load = (JButton[][]) in.readObject();
        in.close();
        return load;
    } catch (Exception e) {
        System.out.println(e);

    }
    return null;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-21T15:35:07.553

`loadArray()`你既传入一个数组又返回一个数组。传入的数组被忽略。您是否以某种方式期望传入的数组将被填充？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T15:42:04.787

我认为混乱来自这样一个事实，即您从 loadArray() 方法返回加载的数组，但忽略了 ActionListener.performAction 函数中函数调用的结果。如果您希望按钮具有返回值，只需分配它，就这样做

`buttons = loadArray(fileName)`

# c# - SqlDataReader 和 SqlCommand

> ID：15005974
> 
> 赞同：2
> 
> 时间：2013-02-21T15:27:31.520
> 
> 标签：c#, asp.net, connection, sqldatareader, sqlcommand

我有以下代码。

```
using (SqlConnection connection = new SqlConnection(ConfigurationManager.ConnectionStrings["ConnectionString"].ConnectionString))
{
   connection.Open();
   SqlCommand select = new SqlCommand("SELECT RTRIM(LTRIM(PART_NO)) AS PART_NO, record FROM [RMAData].[dbo].[IMPORTING_ORDER_EDI] WHERE sessionID = '" + Session.SessionID + "'", connection);

   SqlDataReader reader = select.ExecuteReader();

   if (reader.HasRows)
   {
      while (reader.Read())
      {
         if (!currentPart.IsActive)
         {
            // this part is not active, set the active flag in sql to 0
            SqlCommand update = new SqlCommand("UPDATE [RMAData].[dbo].[IMPORTING_ORDER_EDI] SET valid = 0, active = 0 WHERE record = " + reader["record"].ToString() + ";", connection);

            update.ExecuteNonQuery();
         }
         else
         {
            ///blah
         }
      }

      reader.Close();
   }
} 
```

但这会导致以下异常...

> *System.InvalidOperationException：已经有一个打开的 DataReader 与此命令关联，必须先关闭。*

我需要读取返回的每一行，对数据进行一些验证并在必要时进行更新，然后继续下一条记录。如果我不能使用`SqlCommand`while 循环，我怎么能做到这一点`reader.Read()`？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-21T15:31:07.580

可以像[修改连接字符串](http://social.msdn.microsoft.com/Forums/en-US/adodotnetdataproviders/thread/78d3989a-8975-4930-998d-1eb907966f57/)一样简单：

> 将 MultipleActiveResultSets=True 添加到连接字符串

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-21T15:37:39.953

您需要创建连接的多个实例。
因为通常只能针对连接执行一个命令
或

按照@grantThomas 的建议执行
或者您可以使用多个连接，如下所示

```
using (SqlConnection connection = new SqlConnection(ConfigurationManager.ConnectionStrings["ConnectionString"].ConnectionString))
{
   connection.Open();
   SqlCommand select = new SqlCommand("SELECT RTRIM(LTRIM(PART_NO)) AS PART_NO, record FROM [RMAData].[dbo].[IMPORTING_ORDER_EDI] WHERE sessionID = '" + Session.SessionID + "'", connection);

   SqlDataReader reader = select.ExecuteReader();

   if (reader.HasRows)
   {
      while (reader.Read())
      {
         if (!currentPart.IsActive)
         {
            // this part is not active, set the active flag in sql to 0
            using (SqlConnection connection1 = new SqlConnection(ConfigurationManager.ConnectionStrings["ConnectionString"].ConnectionString))
           {
               SqlCommand update = new SqlCommand("UPDATE [RMAData].[dbo].[IMPORTING_ORDER_EDI] SET valid = 0, active = 0 WHERE record = " + reader["record"].ToString() + ";", connection1);

            update.ExecuteNonQuery();
           }
         }
         else
         {
            ///blah
         }
      }

      reader.Close();
   }
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-21T18:13:20.353

另一种方法是不添加 MultipleActiveResultSets=True - 这样做会带来很小的性能损失 - 所以像这样：

```
using (SqlConnection connection = new ...))
{
   connection.Open();
   SqlCommand select = new SqlCommand(...);

   SqlDataReader reader = select.ExecuteReader();

   var toInactivate = new List<string>();

   if (reader.HasRows)
   {
      while (reader.Read())
      {
         if (!currentPart.IsActive)
         {
            toInactivate.Add(reader["record"].ToString());
         }
         else
         {
            ///blah
         }
      }

      reader.Close();
   }

   SqlCommand update = new SqlCommand("UPDATE ... SET valid = 0, active = 0 " +
       "WHERE record IN(" + string.Join(",", toInactivate) +  ");", connection);

   update.ExecuteNonQuery();
} 
```

它的优点是在单个 SQL 语句中更新所有必需的记录。

当然，使用 EF 和 Linq 整个事情会变得更加整洁。

# ruby-on-rails - 如果当前页面 posts_edit_path 则显示文本

> ID：15005981
> 
> 赞同：-2
> 
> 时间：2013-02-21T15:27:41.777
> 
> 标签：ruby-on-rails, ruby

只有当用户在posts_edit_path中时我才需要显示文本，我该怎么做？

谢谢！

我的帖子形成了我想向 post_edit_path 中的用户显示此文本的位置

```
<%= nested_form_for(@post) do |f| %>
  <% if @post.errors.any? %>
    <div id="error_explanation">
      <h2><%= pluralize(@post.errors.count, "error") %> prohibited this post from being saved:</h2>

      <ul>
      <% @post.errors.full_messages.each do |msg| %>
        <li><%= msg %></li>
      <% end %>
      </ul>
    </div>
  <% end %>

  <div id="field">
    <%= f.label :Nosaukums %>:<br /><br />
    <%= f.text_field :title %><br /><br />
  </div>
  <div id="field">
    <%= f.label :Raksts %>:<br /><br />
    <%= f.text_area :content %><br /><br />
  </div>
  <div id="field_browse">
    <b><%= f.label :Bildes %>:</b><br />
        Lai izdzēstu bildes, ieklikšķiniet tās un publicējiet rakstu.<br /><br />
    <%= f.fields_for :assets do |asset| %>
        <% if asset.object.new_record? %>
        <div style="clear: both;"></div>
            <%= asset.file_field :image %>          
            <%= f.link_to_remove "Noņemt" %>
        <% end %>   
        <% unless asset.object.new_record? %>
        <p>
            <div id="pictures_in_form"><%= link_to image_tag(asset.object.image.url(:thumb)), asset.object.image.url(:big), :class => "fancybox", :rel => "gallery" if asset.object.image? %></div>                         
            <div id="delete_box"><%= asset.check_box :_destroy if asset.object.image?%></div>
        </p>
        <% end %>
    <% end %>
  <%= f.link_to_add "Pievienot bildes", :assets %>
  </div>
  <div style="margin-top: 15px;">
    <%= f.submit "Publicēt rakstu", :id => "button-link" %>
  </div>
<% end %> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-21T15:44:10.623

当前页面？应该帮助你做你所追求的。例如：

```
if current_page?(:controller => "post", :action => "edit") 
```

查看此链接了解更多信息：[ruby on rails api: current_page?](http://api.rubyonrails.org/classes/ActionView/Helpers/UrlHelper.html#method-i-current_page-3F)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-21T15:49:43.050

你可以这样做：

```
 <div id="field_browse">
<b><%= f.label :Bildes %>:</b><br />
<%=  "Lai izdzēstu bildes, ieklikšķiniet tās un publicējiet rakstu." if action_name.eql? "edit" %>
   <br /><br />
<%= f.fields_for :assets do |asset| %>
    <% if asset.object.new_record? %>
    <div style="clear: both;"></div>
        <%= asset.file_field :image %>          
        <%= f.link_to_remove "Noņemt" %>
    <% end %>   
    <% unless asset.object.new_record? %>
    <p>
        <div id="pictures_in_form"><%= link_to image_tag(asset.object.image.url(:thumb)), asset.object.image.url(:big), :class => "fancybox", :rel => "gallery" if asset.object.image? %></div>                         
        <div id="delete_box"><%= asset.check_box :_destroy if asset.object.image?%></div>
    </p>
    <% end %>
<% end %>
<%= f.link_to_add "Pievienot bildes", :assets %> 
```

# .net - 用于为中型公司实施企业应用程序的 SharePoint 与 SiteCore

> ID：15005982
> 
> 赞同：-1
> 
> 时间：2013-02-21T15:27:44.840
> 
> 标签：.net, sharepoint, content-management-system, sitecore

我正在为一家中型公司（大约有 50 名员工和大约 200 名客户）寻找一个企业应用程序，该应用程序提供；内容管理系统，用于构建 Intranet & Extranet 门户、文档管理、企业搜索、协作等。目前我正试图从我的阅读和调查中找出 SharePoint 和 SiteCore 之间的区别（记住我没有研究过它们），我可以弄清楚以下几点：-

1.  Sitecore 是用于构建外部网站的更好的 CMS，而 SharePoint 是用于内部网协作门户的更好的 CMS。

2.  SharePoint 具有更好的安全管理和文档管理。

3.  通过允许轻松使用现成的库和 Web 部件，SharePoint 更加以 IT 为中心，而 sitecore 则更加以开发人员为中心。

我的上述观点正确吗？是否有人有其他要比较的点，尤其是在这两种软件的价格要求方面？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-21T15:42:44.230

首先让我说我对 Sharepoint 没有太多经验。

1.  虽然我相信 Sitecore 也可以用于构建 Intranet 门户（例如，通过使用 Intranet 模块 - 我从未使用过，所以不能说这是否好用），并且 Sharepoint 可以用于构建外部网站，我被多次告知是的——似乎确实如此。

2.  对 SharePoint 了解不足，无法告诉您这一点

3.  是的，我想我也会同意这一点。

阅读[这篇](http://ericbrown.com/sitecore-or-sharepoint-cms-platform.htm)文章，其中陈述了以下内容：

> 对于外部内容焦点，请选择 Sitecore。
> 对于营销驱动的平台，请选择 Sitecore。
> 对于基于未经身份验证的用户自定义 Web 用户体验的平台，请选择 Sitecore（和 Sitecore OMS）
> 对于关注企业级安全要求的内部内容，请选择 Sharepoint
> 对于协作平台，请选择 Sharepoint
> 对于 IT 驱动的平台，选择共享点

基本上，它取决于你需要用它做什么。

# c# - 使用 Lucene 提高 Sitecore 的性能

> ID：15005985
> 
> 赞同：1
> 
> 时间：2013-02-21T15:27:47.810
> 
> 标签：c#, performance, search, lucene, sitecore

我目前正在使用 Sitecore，我们在其中创建了一个“创建新内容”部分，它会打开一个弹出窗口，显示 8 个最常用的模板以及使用次数。

问题是，模板数量过多（目前最高超过11k）时，耗时过长。

这是我用来获取 8 个最常用模板的代码：

我从数据库中获取所有项目。

```
var allItems = db.GetItem("/sitecore/content").Axes.GetDescendants(); 
```

然后我得到了最常用的 8 个。

```
var mostUsedTemplates = allItems.GroupBy(x => x.TemplateID)
                .Select(x => new { TemplateID = x.Key, Count = x.Count() })
                .OrderByDescending(x => x.Count).Take(8); 
```

我们已经实现了 Lucene，但我真的不知道如何使用它。

我尝试寻找获取所有模板的方法，对它们进行计数，然后找到最常用的 8 个，但我一无所获。

简而言之，我需要计算用于创建内容中的项目的所有模板，并恢复计数最高的 8 个。

任何帮助将不胜感激。谢谢。

对此进行扩展：这是我目前正在制作的配置。我正在尝试包含所有模板，并能够计算它们。

```
<configuration xmlns:patch="http://www.sitecore.net/xmlconfig/">
<sitecore>
<search>
  <configuration>
    <indexes>
      <index id="usage_template_count" type="Sitecore.Search.Index, Sitecore.Kernel">
        <param desc="name">$(id)</param>
        <param desc="folder">usage_template_count</param>
        <Analyzer ref="search/analyzer" />
        <locations hint="list:AddCrawler">   

        For what I understand, here is what I specify what to index.
        From what I read, I know how to include some templates, or excludes others, but no idea how to include ALL.
        Also don´t know if I have to set up something in the config to be able to count the results.

        </locations>
      </index>
    </indexes>
  </configuration>
</search>
</sitecore>
</configuration> 
```

再次感谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-21T15:54:17.987

首先，永远不要迭代或检索整个内容树并期望它执行。这不是一个合理的期望。

您可以在 lucene 中执行此操作，但它需要索引模板本身并添加一个包含模板实例计数的字段。（查看[scSearchContrib](https://github.com/sitecorian/SitecoreSearchContrib)以使这更容易。）但是，您需要计划完全重建此索引，因为模板项将永远不会被重新索引，除非它们本身发生变化。

Links DB 可能会为您带来更好的性能，因为那里应该包含对模板的引用。但是，您仍然需要遍历所有模板，并检查对每个模板的引用数。

无论使用哪种解决方案，我肯定仍然建议实施缓存层。

最后，为什么有必要动态地执行此操作？安装中最常用或最有用的八个模板会经常更改吗？为什么不为此在内容树的某处创建一个配置元素，并根据模板使用报告定期更新它？您可以使用[Sitecore Powershell 控制台](http://marketplace.sitecore.net/en/Modules/Sitecore_PowerShell_console.aspx)之类的工具来运行报告。如果您确实需要自动化，请编写一个 Sitecore Powershell 脚本来执行查询，然后自动更新您的配置元素。安排脚本每天运行。

# r - 在同一面板中绘制多个直方图

> ID：15005991
> 
> 赞同：4
> 
> 时间：2013-02-21T15:27:57.810
> 
> 标签：r, lattice

我正在尝试在同一面板的数据框中绘制一些变量的多个直方图。下面是一些代码：

```
 library(lattice) 
 dd <- data.frame(gp = factor(rep(paste('Group', 1:6, sep = ''), each = 
 100)), x = rnorm(600)) 
 histogram( ~ x | gp, data = dd) 
 histogram( ~ x | gp, data = dd, as.table = TRUE) 
```

这是将数据 x 放入 1 到 6 组。在给定的数据框中，我们已经拥有特定类别的数字。例如，假设我想在同一面板中绘制身高、体重和平均血压（日期框架中的变量）的直方图。如果不必形成新的数据集和第 1 到 3 组，我将如何做到这一点？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-21T15:40:53.197

无需在这里重塑数据。

```
 histogram( ~ height +age +weight ,data = dd) 
```

然后，您可以`layout`更改面板的显示顺序。例如：

```
 histogram( ~ height +age +weight ,layout=c(1,3),data = dd) 
```

这将在 3 个面板中生成 3 个直方图。

**编辑**

添加可以使用的标题`main`

```
histogram( ~ height +age +weight ,layout=c(1,3),data = dd,
            main='PLEASE READ LATTICE HELP') 
```

旁注：设置参数在不同的晶格函数之间共享。例如 xlab 的条目：`See xyplot`. 当你去 xyplot 帮助时，你可以阅读：

```
main:
Typically a character string or expression describing the main 
       title to be placed on top of each page. Defaults to NULL 
```

# c++ - 使用 vs typedef 的别名

> ID：15005994
> 
> 赞同：2
> 
> 时间：2013-02-21T15:28:11.633
> 
> 标签：c++, c++11, alias, typedef, using

我正在学校实验室工作，在说明中它说：

> 将定义 Word_List 的 typedef 更改为别名声明（使用）

从我用谷歌搜索的内容来看，这样做的方法是改变：

```
typedef vector<Word_Entry> Word_List; 
```

至：

```
using Word_List = std::vector<Word_Entry>; 
```

但是当我编译时，我收到以下错误：

```
error: expected nested-name-specifier before 'Word_List' 
```

**大部分代码：**

```
#include <iostream>
#include <algorithm>
#include <list>
#include <string>
#include <vector>
#include <fstream>
#include <cctype>
#include <iomanip>

using namespace std;

struct Word_Entry
{
  string ord;
  unsigned cnt;
};

//typedef vector<Word_Entry> Word_List; <-This is what it used to look like
using Word_List = vector<Word_Entry>;

int main()
{
 ...
} 
```

附加信息：

```
Yes, I am compiling with c++11 
Word_Entry is a struct that stores 2 variables
I have the line "using namespace std;" in the begining of my code
I'm using mingw compiler 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-21T16:26:45.037

You can see the solution here:

```
#include <string>
#include <vector>

using namespace std;

struct Word_Entry
{
  string ord;
  unsigned cnt;
};

//typedef vector<Word_Entry> Word_List; <-This is what it used to look like
using Word_List = vector<Word_Entry>;

int main()
{
} 
```

*   [http://ideone.com/9mCaq0](http://ideone.com/9mCaq0) (C++) error: expected nested-name-specifier before ‘Word_List’</li>
*   [http://ideone.com/FdIKcr](http://ideone.com/FdIKcr) (C++11) success

You have a configuration error, you are not compiling with C++11 specification.

# php - 如何使用有源过滤器过滤产品集合？

> ID：15005996
> 
> 赞同：0
> 
> 时间：2013-02-21T15:28:14.700
> 
> 标签：php, magento

您能否帮助我解决如何将有源过滤器应用于产品集合？

例如：

```
$_category = Mage::getModel('catalog/category')->load($category_id);
$productsCollection = $_category->getProductCollection(); 
```

获取有源过滤器：

```
$_filters = Mage::getSingleton('catalog/layer')->getState()->getFilters(); 
```

如何使用 $_filters 过滤 $productsCollection 中的产品？

感谢您的关注！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T16:03:19.850

Magento 将过滤器应用于函数[Mage_Catalog_Model_Resource_Layer_Filter_Attribute::applyFilterToCollection](https://github.com/varinen/Magento-Community-1.6.2.0-0.1/blob/master/app/code/core/Mage/Catalog/Model/Resource/Layer/Filter/Attribute.php#L53)中的集合。按照其逻辑，您可以使用以下代码：

```
$_filters = Mage::getSingleton('catalog/layer')->getState()->getFilters();
$productsCollection = $_category->getProductCollection();
foreach ($_filters as $filterItem) {
    $filter = $filterItem->getFilter(); /**Mage_Catalog_Model_Layer_Filter_Attribute**/
    $attribute  = $filter->getAttributeModel();
    $connection = Mage::getSingleton('core/resource')->getConnection('core_read');
    $tableAlias = $attribute->getAttributeCode() . '_idx';
    $conditions = array(
        "{$tableAlias}.entity_id = e.entity_id",
        $connection->quoteInto("{$tableAlias}.attribute_id = ?",
        $attribute->getAttributeId()),
        $connection->quoteInto("{$tableAlias}.store_id = ?", $collection->getStoreId()),
            $connection->quoteInto("{$tableAlias}.value = ?", $value)
        );

    $productsCollection->getSelect()->join(
        array($tableAlias => $filter->getResource()->getMainTable()),
        implode(' AND ', $conditions),
        array()
        );

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T16:15:21.017

选择类别时出现的错误是过滤器对象属于类型`Mage_Catalog_Model_Layer_Filter_Category`并且没有属性`attribute_model`。您必须在过滤器循环中添加检查以防止出现这种情况：

```
foreach($_filters as $filterItem)
{
    $filter = $filterItem->getFilter();
    if (!($filter instanceof Mage_Catalog_Model_Layer_Filter_Attribute)) {
        continue;
    } 
```

多个选择过滤器值的问题也可以通过两种方式解决。如果您希望以 OR 方式应用过滤器值，请执行以下操作：

```
 $connection->quoteInto("{$tableAlias}.value = in(?)", explode('_', Mage::app()->getRequest()->getParam($attribute->getAttributeCode()))) 
```

如果必须以 AND 方式应用过滤器值，则该过程有点复杂。基本上，您必须对同一个表执行多个连接，并且必须为每个连接提供唯一的表别名：

```
 $connection = Mage::getSingleton('core/resource')->getConnection('core_read');
   $tableAlias = $attribute->getAttributeCode() . '_idx';

   $values = explode('_', Mage::app()->getRequest()->getParam($attribute->getAttributeCode()));

   foreach ($values as $value) {
        $tableAliasModified = $tableAlias.'_'.$value;
        $conditions = array(
            "{$tableAliasModified}.entity_id = e.entity_id",
            $connection->quoteInto("{$tableAliasModified}.attribute_id = ?",
            $attribute->getAttributeId()),
            $connection->quoteInto("{$tableAliasModified}.store_id = ?", Mage::app()->getStore()->getStoreId()),
                $connection->quoteInto("{$tableAliasModified}.value = ?", $value)
            );

        $productsCollection->getSelect()->join(
            array($tableAliasModified => Mage::getResourceModel('catalog/layer_filter_attribute')->getMainTable()),
            implode(' AND ', $conditions),
            array()
            );
    } 
```

# c# - 为什么是 (int)(61.1f * 10)==610 但 (int)(61.1 * 10) == 611

> ID：15005997
> 
> 赞同：0
> 
> 时间：2013-02-21T15:28:14.857
> 
> 标签：c#, floating-point, precision

编辑3：实际答案。

两个错误的假设导致了这个问题的出现：

a) 浮点数的隐式转换是加倍，而不是浮点数。这解释了两种操作之间的区别。

b) 不要相信调试器。正如 Servy 所指出的那样（在用棍子戳了一下之后），调试器使用 ToString() ，正如他所说的那样，它显然做了隐式舍入。无法以二进制精确表示的浮点值将四舍五入显示。有人可能会争论这一点，我会说这是邪恶的。

Edit2：接受欺骗：[在 C# 中将浮点数转换为 int 时的奇怪行为](https://stackoverflow.com/questions/8911440/strange-behavior-when-casting-a-float-to-int-in-c-sharp)

谢谢诺洛纳尔。你们其他人应该在发布之前阅读实际问题。

编辑：这并不是真正的重复，实际上对所谓重复的答案只是指出了我为什么感到困惑......我想我应该让自己更清楚......

问题是，

a) 为什么 (61.1 * 10) 产生与 (61.1f * 10) 不同的结果[假设编译器优化在这里起作用]？

b) 为什么下面示例中的第二行在调试器输出中显示为“621.0”，在打印时等等 - 当转换为 int 后，它实际上更接近 620.9~？[假设 VS 调试器的“watch”功能在这里起到了格式化的作用]

好的，所以这种情况不再经常发生在我身上，但是我从根本上对看似简单的事情感到困惑（这就是我的问题，假设浮动和强制转换是一件简单的事情......）

我的意思是，我知道花车是如何工作的。但这与精度限制相去甚远，并且可能是非关键操作？

我可以猜测编译器优化与标题中产生不同结果的两种情况有关，但真正的情况是在运行时：

```
float x = 62.1
x*10 // == 621.0
(int)(x*10) // == 620 
```

我是否正确假设如图所示的 621.0 真的很像 620.999999999999999999999999999999998 并因此在演员表后被截断？

在这种情况下，我想我应该归咎于 VS“手表”功能..