# StackOverflow 问答 15820000-15820999

# objective-c - UIActionsheet 位置从横向模式变为纵向模式

> ID：15820000
> 
> 赞同：0
> 
> 时间：2013-04-04T19:26:47.170
> 
> 标签：objective-c, uiactionsheet

我有一个表格视图，其中长按一行会触发操作表 - 选项。当我按行上的任意位置（想想 iPad 屏幕）时，操作表在横向/纵向模式下正确显示。但是，当我在横向模式下（靠近显示指示器）长按行的最右侧并更改为纵向模式时，操作表将显示如下所示。

![在此处输入图像描述](https://i.stack.imgur.com/z1AHE.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T19:50:30.057

它`UIActionSheet`不会将自己固定在任何东西上，因此当屏幕旋转时，它会保持原位，而其他所有东西都在移动。您想在`willAnimateRotationToInterfaceOrientation:`或中重新显示操作表`didAnimateRotationFromInterfaceOrientation`。

# vim - 定义用于构建和加载错误文件的命令

> ID：15820008
> 
> 赞同：0
> 
> 时间：2013-04-04T19:27:06.897
> 
> 标签：vim, go

我想定义一个命令，该命令将首先构建当前`Go`源文件并加载 errors.err 文件，以便进一步使用`:cnext`或等命令`:clist`。

是）我有的：

我将以下行添加到我的`.vimrc`：

```
command Gobuild !go build %:t | grep -v "^\#" | tee errors.err 
```

但我必须做`:cfile`after `:Gobuild`，因为它不是自动完成的。如何自动加载`errors.err`文件？试图附加`:cfile`到命令，它没有帮助。加载后自动删除`errors.err`也很有用。

我知道有办法用 做这样的事情`make`，但我不喜欢它。

**UPD：**一个笨拙的临时解决方案（在我深入研究建议的解决方案之前）：

```
function GoBuild()
    silent !echo -e "make:\n\t@go build \${src} | grep -v '^\#' | tee" > %:t"_makefile"
    make -f %:t"_makefile" src="%:t"
    silent !rm %:t"_makefile"
endfunction

command Gobuild call GoBuild() 
```

这里`@`防止`make`回显命令，`grep`过滤掉`#command line arguments`行，并且`tee`不打扰`make`错误代码`grep`（`grep`返回有注意过滤掉的错误代码） -`tee`总是返回 0，`OK`错误代码。

**UPD：**更好的解决方案

```
autocmd FileType go set makeprg=go\ build\ %:t\ 2>&1\\\|grep\ -v\ '^\\#'\\\|tee
command Gorun !./%:r 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T20:23:38.690

一般而言，整个构建和报告错误业务围绕两个选项展开：`'makeprg'`以及`'errorformat'`一`:make`组与快速修复相关的命令（如`:copen`or ）的组合`:cnext`。在您的文件中添加几行`~/.vimrc`应该是您所需要的。

[本文](http://richiewu.is-programmer.com/posts/33267.html)作为一些示例代码，[这里是一个成熟的插件](https://github.com/rjohnsondev/vim-compiler-go)。

# wordpress - 自动刷新wordpress主页

> ID：15820009
> 
> 赞同：0
> 
> 时间：2013-04-04T19:27:07.277
> 
> 标签：wordpress, refresh

如何每 3 分钟自动刷新一次主页？

我只想要 index.php 而不是所有页面（不会将代码放在 header.php 中）。

我应该使用什么代码以及放置在哪里？这是我的 index.php 第一行：

```
<?php
/**
 * @package WordPress
 * @subpackage Default_Theme
 */

get_header(); 
?>
<!--Body Container Start Here --> 
```

非常感谢！！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-04T19:40:05.887

不确定你的主题是什么样的，但你可以使用一个钩子，比如 wp_head 并检查你想要的条件。这可以插入到functions.php 或其他地方。

```
<?php
/**
 * @package WordPress
 * @subpackage Default_Theme
 */

function check_if_this_is_home_and_then() {
    if( is_home() ) {

?>

<meta http-equiv="refresh" content="180;url=http://stackoverflow.com/">

<?php

    }
}

add_action( 'wp_head', 'check_if_this_is_home_and_then' );

get_header(); 
?>

<!--Body Container Start Here --> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-04T19:34:57.953

为什么不只在主页上使用元刷新标签？

```
<meta http-equiv="refresh" content="180;url=http://stackoverflow.com/"> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-04T23:15:27.493

您可以添加以下内容；

```
<script language="JavaScript">
     var sURL = unescape(window.location.pathname);
     var intValue = 0;
     function doLoad()
     {
         intValue=setTimeout( "refresh()", 300*1000 );
     }

    function refresh()
     {
         window.location.href = sURL;
     }

    function noRefresh(e)
     {
         switch (e.keyCode) {
             case 40:
             case 39:
             case 38:
             case 37:
             case 34:
             case 33:
                 break;
             default:
                 clearTimeout(intValue);
         }

    }

    if ($.browser.mozilla) {
         $(document).keypress(noRefresh);
     } else {
         $(document).keydown(noRefresh);
     }

    $(document).ready(doLoad());
 </script>
 <noscript>
     <meta http-equiv="refresh" content="300">
 </noscript> 
```

如上所述，将 300 修改为`<meta http-equiv="refresh" content="300">`60，将每 60 秒刷新一次。

希望有效！

**编辑：这将在您的“header.php”中进行修改:)

# jquery - 如果 span 包含“(0)”，则隐藏父元素

> ID：15820010
> 
> 赞同：0
> 
> 时间：2013-04-04T19:27:07.017
> 
> 标签：jquery

**HTML**

```
<div>Group 1
    <br>

        <input type="checkbox" name="testing" value="B"> <label>A<span>(34)</span></label>
    <br />
        <input type="checkbox" name="testing" value="I"> <label>B<span>(0)</span></label>
    <br />
        <input type="checkbox" name="testing" value="A"> <label>C<span>(323)</span></label>
    <br />
</div>
<div>Group 2
    <br>

        <input type="checkbox" name="testing2" value="B"><label>A<span>(0)</span></label>
    <br />

        <input type="checkbox" name="testing2" value="I"><label>B<span>(564)</span></label>
    <br />

        <input type="checkbox" name="testing2" value="A"> <label>C<span>(0)</span></label>
    <br />
</div> 
```

**JS**

```
$("input:checkbox").change(function () {
    var checkname = $(this).attr("name");

    if (this.checked) {

        $("input:checkbox[name='" + checkname + "']").removeAttr("checked").parent().hide();
        this.checked = true;
        $(this).parent().show();
    } else {
        $("input:checkbox[name='" + checkname + "']").parent().show();
    }

    if($(".options input:checkbox + label span:contains('(0)')")){
        $(this).parent().hide();;
    }else{
        $(this).parent().show();
    }
});

$("input:checkbox[checked]").trigger("change"); 
```

如果子跨度包含（0），我想隐藏带有标签的复选框。你可以看到我在上面尝试过的，但它不起作用。怎么做 ？

[http://jsfiddle.net/warface/uvYzW/4/](http://jsfiddle.net/warface/uvYzW/4/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T19:35:14.060

标记：

```
<div>Group 1
    <div>
        <input type="checkbox" name="testing" value="B"> <label>A<span>(34)</span></label>
    </div>
    <div>
        <input type="checkbox" name="testing" value="I"> <label>B<span>(0)</span></label>
    </div>
</div> 
```

JS：

```
$("label span:contains('(0)')").closest("div").hide(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T19:57:58.683

试试这个：

```
$.each( $("input[type=checkbox]") , function(key, value) {  
    var element = $(value);
    if (element.next().find("span").text()==="(0)") {               
        element.prev().hide();  // remove the <br>
        element.hide();
        element.next().hide(); // remove the label
    }   
}); 
```

[http://jsfiddle.net/Hgg58/2/](http://jsfiddle.net/Hgg58/2/)

# vb.net - Datagrid 显示组合框控件的空值

> ID：15820012
> 
> 赞同：0
> 
> 时间：2013-04-04T19:27:14.887
> 
> 标签：vb.net

我有一个带有组合框控件的数据网格控件。以下是示例代码：

```
Dim cbCell As DataGridViewComboBoxCell
...
n = myGridView.RowCount - 1
For i = 0 to n
  cbCell = Me.myGridView.Rows(i).Cells(6)
  cbCell.DataSource = ' data source varies depending on rows
  cbCell.DisplayMember = "name"
  cbCell.ValueMember = "name"
Next 
```

我遇到的问题是组合框始终显示为空值（空字符串），除非我单击组合框并选择要显示的项目。

我需要将第一项（下拉列表的）设置为每一行的默认值。由于组合框的数据源不同，因此显示的默认项可能不同。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T19:39:48.737

您可以将单元格的文本更改为指定的字符串吗？

```
 cbCell.text = egCell.items(1) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-07T20:16:53.597

我终于找到了解决问题的方法。让我先解释一下我的问题。此“组合框”控件未绑定到其数据网格数据源的任何属性。这就是为什么我需要在表单加载事件中的代码中定义其数据源，如问题中所述。“组合框”实际上是 DataGridViewComboBoxCell 的一个实例，它没有选中索引属性。我找不到一种方法来获取分配的“组合框”的第一项值。

解决方案是将 DataGridViewComboBoxCell 转换或转换为 DataRowView。以下是我的示例代码：

```
Private Sub WorkOrderList_CellFormatting(sender As Object, 
  e As System.Windows.Forms.DataGridViewCellFormattingEventArgs) Handles
  WorkOrderList.CellFormatting

  Dim dgvc As DataGridViewComboBoxCell
  dgvc = Me.MyDataGridList(e.ColumnIndex, e.RowIndex)
  ....
  Me.MyDataGridList(e.ColumnIndex, e.RowIndex).Value = CType(dgvc.Items(0), DataRowView).Item(0).ToString()
  ....
End Sub 
```

请注意，如果我直接将 dvvc.Items(0) 分配给 datagrid 控件的值，我只会得到类类型名称作为字符串。DataRowView 的 Item(0) 的字符串值是组合框中第一项的文本。这就是我想要的。

我希望这个答案可以为类似情况的其他人提供一些帮助。

# php - 将 PHP URL 中的多个值传递到 SQL 表中的单行

> ID：15820015
> 
> 赞同：1
> 
> 时间：2013-04-04T19:27:26.237
> 
> 标签：php, sql, get

我正在尝试使用 Get 语句从 PHP URL 传递多个值。我觉得应该很简单。我设法很好地传递了一个变量，但由于某种原因，第二个变量总是最终为 NULL。

这是我的代码：

```
<?php

$DB_HostName = "localhost";
$DB_Name = "prototype3DB";
$DB_User = "root";
$DB_Pass = "root";
$DB_Table = "sqlTable";

if (isset ($_GET["date"]))
$date = $_GET["date"];
else
$date = "null";

    if (isset ($_GET["fname"]))
    $fname = $_GET["fname"];
    else
    $fname = "null";

    $con = mysql_connect($DB_HostName,$DB_User,$DB_Pass) or die(mysql_error()); 
    mysql_select_db($DB_Name,$con) or die(mysql_error()); 

    $sql = "insert into $DB_Table (date, fname) values ('$date','$fname')";

    $res = mysql_query($sql,$con) or die(mysql_error());

    mysql_close($con);
    if ($res) {
        echo "success";
    }else{
        echo "failed";
    }// end else
?> 
```

日期变量总是传递给数据库，但 fname 是最终为 NULL 的变量。我有点感觉这是语法问题，但我对 PHP 还是很陌生。

基本上，我认为这条线是问题所在：

```
$sql = "insert into $DB_Table (date, fname) values ('$date','$fname')"; 
```

我很感激任何帮助。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T19:31:40.050

试试这个...

```
$sql = "insert into $DB_Table (date, fname) values ('$date','".$fname."')"; 
```

有时那些额外的引号可以解决问题...大声笑

但 Colin 也是对的……这里的漏洞非常明显。希望你只是在测试东西.. :)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T20:21:58.350

请使用 PDO 或 MySQLi 代替`mysql_*`函数。我喜欢 PDO，可以在这里找到有用的信息：[http](http://wiki.hashphp.org/PDO_Tutorial_for_MySQL_Developers) ://wiki.hashphp.org/PDO_Tutorial_for_MySQL_Developers 和[http://us.php.net/manual/en/pdostatement.bindvalue.php](http://us.php.net/manual/en/pdostatement.bindvalue.php)

要快速入门，请检查以下代码：

```
<?php

// Credentials. DSN is a string defining how to connect to the DB
$DB_DSN    = "mysql:dbname=myDatabase;host=127.0.0.1";
$DB_USER   = "myUser";
$DB_PASSWD = "myPassword";

// Make the connection and get a handle for talking to the db
$db = new PDO($DB_DSN, $DB_USER, $DB_PASSWD);

// Make query into a prepared statement. Protects us from SQL injection.
// Use placeholders like :status and :id where we will be inserting variables
$statement = $db->prepare('
    UPDATE users
    SET status = :status
    WHERE id = :id ');

// Associate vars with the placeholders in our query
// Define the type of valus such as string or int with the third param
$statement->bindValue(':id',     $_GET['id'],     PDO::PARAM_INT);
$statement->bindValue(':status', $_GET['status'], PDO::PARAM_STR);

// Actually run the query
$statement->execute(); 
```

# scala - 链接部分函数时如何避免“缺少类型”错误

> ID：15820017
> 
> 赞同：4
> 
> 时间：2013-04-04T19:27:45.950
> 
> 标签：scala, akka, anonymous-function, partialfunction

我目前正在研究 Scala & Akka 并为其开发测试应用程序。在这个应用程序中，几乎所有参与者都记录未处理的消息以便于调试：

```
import akka.actor._

class TestActor extends Actor with ActorLogging {
  def receive: Receive = {
    case Some(value) => // do something...
    case msg => log.debug("Unhandled message: {}.", msg)
  }
} 
```

正如我所说，这样的代码几乎存在于我所有的代理中，我开始考虑将其转化为特征：

```
trait LogUnhandled { this: Actor with ActorLogging =>
  def logUnhandled: Receive = {
    case msg => log.debug("Unhandled message: {}.", msg)
  }
} 
```

并在喜欢后使用它

```
class TestActor extends Actor with ActorLogging with LogUnhandled {
  def receive: Receive = {
    case Some(value) => // do something...
  } orElse logUnhandled
} 
```

我主要想知道结构子类型是否允许我这样做，或者`TestActor#Receive`会`LogUnhadled#Receive`是不同的类型，但即使在此之前我已经有了

```
error: missing parameter type for expanded function
The argument types of an anonymous function must be fully known. (SLS 8.5)
Expected type was: ? 
```

现在我不知道如何避免这种情况，除了将第一个`{...}`块移动到单独的函数中：

```
class TestActor extends Actor with ActorLogging with LogUnhandled {
  def doReceive: Receive = {
    case Some(value) => // do something...
  } 

  def receive: Receive = doReceive orElse logUnhandled
} 
```

当然，后者会做，但它有点“漏掉了重点”并造成了一些其他副作用，比如“考虑适当的函数名而不是`receive`”......

所以我想知道：是否可以通过某种方式声明`(Any) => Unit`函数签名“就地”来避免“缺少类型参数错误”？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-04T19:58:26.310

```
class TestActor extends Actor with ActorLogging with LogUnhandled {
  def receive = ({
    case Some(value) => // do something...
  }: Receive) orElse logUnhandled
} 
```

也看看[这个](https://github.com/akka/akka/blob/master/akka-actor/src/main/scala/akka/event/LoggingReceive.scala)。LoggingReceive 允许您执行以下操作：

```
class A extends Actor {
   def receive = LoggingReceive {
      case msg => ...
   }
} 
```

所有接受/拒绝的消息都将发布到调试流。

# linux - Linux：并行进程和依赖项

> ID：15820026
> 
> 赞同：0
> 
> 时间：2013-04-04T19:28:22.257
> 
> 标签：linux, bash, concurrency

我想在我的工作中自动化代码吸收。总共有5个阶段：

1.  摄取
2.  初级编译
3.  二次编译
4.  数据库部署
5.  后编译

我想做的是打开三个 GNOME 终端窗口，在第一个窗口中只运行第 1 阶段，在第二个窗口中运行第 2 和第 3 阶段，在第三个窗口中运行第 4 和第 5 阶段。

这是一个如何从终端启动 GNOME 终端的示例（并让它保持打开状态！）：

```
gnome-terminal \
--title="UPTAKE" \
--working-directory="$DIR" \
--command="bash -c \"echo CODE UPTAKE STARTING... ; \
exec bash\"" \ 
```

这是踢球者：我希望同时启动第 2 阶段和第 4 阶段（并行），但只有在第 2 阶段成功时才运行第 3 阶段（很像 Linux 中的 'Stage2 && Stage3' 命令），并且仅在以下情况下运行第 5 阶段第 4 阶段成功。

我是 Linux 的新手，似乎有很多方法可以启动并行进程，我不知道该选择哪一种。而且我不知道如何通过满足上述所有条件来完成我的任务。任何意见，将不胜感激。

编辑：是否可以将信号从一个现有终端传递到另一个终端？（即，一个终端等待另一个终端完成任务。）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-04T19:42:50.847

> 我是 Linux 新手

所以，请接受一个建议：当终端窗口无故弹出和消失时，人们讨厌它。只需编写一个简单的 shell 脚本来实现您的任务，这样它就可以在任何终端窗口中工作，而不仅仅是 gnome-terminal。

首先，您描述的逻辑是用 shell 编写的，因此：

```
stage1; (stage2 && stage3) & (stage4 && stage5) 
```

# ruby - JSON::ParserError: JSON 文本必须至少包含两个八位字节！（对于非零输入）

> ID：15820028
> 
> 赞同：4
> 
> 时间：2013-04-04T19:28:29.827
> 
> 标签：ruby, json, post, sinatra

所以，我意识到已经就这个主题提出了[两个](https://stackoverflow.com/questions/8390256/a-json-text-must-at-least-contain-two-octets) [问题，但是（不幸的是）我的情况似乎有所不同。](https://stackoverflow.com/questions/7200554/what-is-json-octet-and-why-are-two-required)

[Sinatra README](http://www.sinatrarb.com/intro.html)说要对POST 数据执行以下操作：

```
post "/api" do
  request.body.rewind  # in case someone already read it
  data = JSON.parse request.body.read
  "Hello #{data['name']}!"
end 
```

当我尝试这个时，我得到：

```
JSON::ParserError: A JSON text must at least contain two octets! 
```

其他问题涉及数据为零或格式错误（`\"`而不是`"`）的情况，但我的似乎很好。如果我打开 irb 和 JSON.parse 与我发布的完全相同的字符串，它就可以正常工作。

这是我用于测试的命令：

```
curl -XPOST http://localhost:5000/endpoint --data '{"foo":"bar","blah":"wat","abcdefghijklmnop":"qrstuvwxyz"}' 
```

我觉得这应该是非常明显的，因为解析 POST 数据对于网络服务器来说是一件非常基本的事情。显然不是。

**编辑：**如果我打电话`logger.info Hash[params]`，我会得到：

```
{"{\"foo\":\"bar\",\"blah\":\"wat\",\"abcdefghijklmnop\":\"qrstuvwxyz\"}"=>nil,   "splat"=>[], "captures"=>["endpoint"], "resource"=>"endpoint"} 
```

...但我不确定这是否/如何帮助。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-04T19:35:18.580

尝试以下方式：

```
post "/api" do
  request.body.rewind  # in case someone already read it
  data = JSON.parse (request.body.read || '{"name":"Not Given"}')
  "Hello #{data['name']}!"
end 
```

# c++ - 将一个输入文件与给定数量的文件匹配的算法

> ID：15820029
> 
> 赞同：7
> 
> 时间：2013-04-04T19:28:32.447
> 
> 标签：c++, c, string, algorithm, string-matching

我上周接受了面试。我被困在算法回合中的一个问题中。我回答了这个问题，但面试官似乎并不相信。这就是我分享相同内容的原因。

请告诉我这个问题的任何优化方法，以便在以后的采访中帮助我。

**问题**：-

> 给出了 20 个文本文件，所有文件都是 ASCII 文本文件，大小小于 10^9 字节。还给出了一个输入，这也是一个 ASCII 文件，例如 input.txt。
> 
> 我们的任务是策略性地将这个输入文件的内容与给定的 20 个文件进行匹配，并打印最接近的匹配文件的名称。输入文件的内容可能仅部分匹配

提前致谢。寻找您的友好答复。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T19:41:48.480

区分它们并通过 wc -l，或在 C++ 中实现[Levenshtein 距离](http://en.m.wikipedia.org/wiki/Levenshtein_distance)，将每一行视为单个字符（或考虑主题域的任何更合适的单元）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T20:24:49.917

您可以创建某种索引（例如：trie）来汇总输入文件。然后您可以检查有多少索引在文档中匹配。

例如。为长度为 10 的输入文件创建一个 trie。对于文本文件中每个长度为 10 的字符串（重叠），检查其中有多少在 trie 中匹配。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-04T21:45:53.273

作为为文档相似性设计真正功能强大、可扩展的系统的建议，我建议阅读《[挖掘海量数据集](http://i.stanford.edu/~ullman/mmds.html)》的第 3 章，该书可在线免费获得。那里提出的一种方法是通过将字数向量化为集合来“拼凑”数据集，然后对这些字数进行散列处理，并将散列结果族与 Jaccard 相似度进行比较，以获得所有文档之间的分数。如果操作正确，这可以以高精度处理数 PB 的文件。可以从斯坦福的[CS246 Slides on Locality Sensitive Hashing](http://www.stanford.edu/class/cs246/slides/03-lsh.pdf)中阅读带有良好图表的明确细节。书中还描述了更简单的方法，如词频计数。

# gwt - GWT 单线程回调

> ID：15820032
> 
> 赞同：0
> 
> 时间：2013-04-04T19:28:43.600
> 
> 标签：gwt, concurrency, single-threaded

```
positionService.call(new PositionCallback(){ onPositionUpdate(Position position)
{
   this.position=position;
   if (isLoaded){
      refreshDataWithPosition();
   }
});

dataService.call(new DataCallback(){ onDataUpdate(Data data)
{
   //does this need synchronization?
   updateTable(data,position);
   isLoaded=true;
}); 
```

我上面有以下代码。它同时加载 GPS 地理位置和所有一些数据。如果 GPS 数据首先更新，updateTable 将考虑到这一点进行更新。如果 GPS 数据第二次更新，它将调用 refreshDataWithPosition 来刷新其内容。我想在有或没有位置的情况下更新表格以获得更灵敏的体验。

GWT 异步回调如何与单线程（或者可能是多线程 javascript 引擎）一起工作？这里的危险是在 updateTable 完成但 isLoaded 设置为 true 之前调用位置回调。在这种情况下，表格不会使用位置数据进行刷新。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T21:16:40.403

GWT 行为与 JavaScript 行为没有任何不同。仅当 JavaScript 代码释放控制流时才会处理这些事件。做一个无限循环`for(;;);`，之后不会处理任何事件，因为控制永远不会被释放。

> 这里的危险是在 updateTable 完成但 isLoaded 设置为 true 之前调用位置回调。在这种情况下，表格不会使用位置数据进行刷新。

只要`updateTable`是同步的就没有危险（例如内部不使用回调）。

`updateTable`PS之后发生的另一个选择`refreshDataWithPosition`是保存来自两个来源的数据并调用一个在两者都存在时起作用的函数：

```
source1callback (position) {
  this.position = position;
  join();
}
source2callback (data) {
  this.data = data;
  join();
}
join() {
  if (this.position && this.data) updateTable (this.data, this.position)
} 
```

# cocos2d-iphone - cocos2d 移动精灵？

> ID：15820034
> 
> 赞同：0
> 
> 时间：2013-04-04T19:28:52.007
> 
> 标签：cocos2d-iphone

需要一些建议/指出正确的方向来解决这个问题..学校小伙子..不是家庭作业！个人学习。我不知道如何让怨恨从上到下。下面的代码使它们从左到右。提前致谢。

```
 CCSprite * monster = [CCSprite spriteWithFile:@"image.png"];
// Determine where to spawn the monster along the Y axis
CGSize winSize = [CCDirector sharedDirector].winSize;
int minX = monster.contentSize.width/ 0.2;
int maxX = winSize.height - monster1.contentSize.width/2;
int rangeX = maxX - minX;
int actualX = (arc4random() % rangeX) + minX;

// Create the monster slightly off-screen along the right edge,
// and along a random position along the Y axis as calculated above
monster.position = ccp(winSize1.width + monster.contentSize.width/2, actualX);
[self addChild:monster1];

// Determine speed of the monster
int minDuration = 2.0;
int maxDuration = 4.0;
int rangeDuration = maxDuration - minDuration;
int actualDuration = (arc4random() % rangeDuration) + minDuration;

// Create the actions
CCMoveTo * actionMove = [CCMoveTo actionWithDuration:actualDuration
                                            position:ccp(-monster.contentSize.width/2, actualX)];
CCCallBlockN * actionMoveDone = [CCCallBlockN actionWithBlock:^(CCNode *node) {
    [node removeFromParentAndCleanup:YES];
}];
[monster1 runAction:[CCSequence actions:actionMove, actionMoveDone, nil]]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T20:49:10.827

说明这一点的行：

```
CCMoveTo * actionMove = [CCMoveTo actionWithDuration:actualDuration position:ccp(-monster.contentSize.width/2, actualX)]; 
```

是什么在设置运动。您告诉精灵移动到的位置 , 是您想要移动到的位置`ccp(-monster.contentSize.width/2, actualX)`的 (X, Y) 坐标。X 是第一个值，Y 是第二个值。出于某种原因，您拥有`actualX`想要移动到的位置的 Y 值。

如果要向上或向下移动，则应将精灵移动到新的 Y 坐标。也许是这样的？

```
CCMoveTo * actionMove = [CCMoveTo actionWithDuration:actualDuration position:ccp(monster.position.x, monster.position.y - 300)]; 
```

# java - 上传文件 - 特殊字符转换为 html 字符？

> ID：15820039
> 
> 赞同：0
> 
> 时间：2013-04-04T19:29:12.990
> 
> 标签：java, html, gwt, serialization, file-upload

我想使用文件选择对话框读取文件并将其发送到服务器。因此，在客户端，我创建了一个表单，该表单将文件内容作为`SubmitCompleteEvent`.

问题：已经在客户端（在将内容发送到服务器之前），特殊字符如`&`被错误地读取为 eg `&amp;`，因此以某种方式替换为`HTML`字符实现。

问题：为什么，更重要的是：我怎样才能防止这种情况发生？如果我不能阻止这种情况，这意味着我必须对文件中可能出现的所有特殊字符运行正则表达式，并替换它们的 html 表示。那会有点没意思...

```
 @UiField FormPanel uploadForm;

 @UiHandler("uploadForm")
    void onSubmitForm(SubmitCompleteEvent evt) {  
    Sysout(evt.getResults()); //prints: &amp;
 } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T20:44:15.647

我找到了一种解决方法，通过以下方式将服务器端的输入转换为 UTF-8：

```
StringEscapeUtils.unescapeHtml(input); 
```

# c# - 如何将 RIFF 块数据写入使用 NAudio 制作的 WAV 文件？

> ID：15820043
> 
> 赞同：2
> 
> 时间：2013-04-04T19:29:31.027
> 
> 标签：c#, .net, audio, wav, naudio

如何将 RIFF 块数据写入**WAV 文件的末尾？**是的，没错，就是**一个WAV文件的结尾。**为什么？因为这就是我要替换的旧程序的方式，并且集成程序是为它准备的，*它们不能被修改。*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T01:46:28.640

我个人会使用[BASS.NET](http://www.un4seen.com/bass.html#addons)，它确实处理 RIFF ICMT 标签。

EncoderWAV 类提供了一个允许它的 WAV_AddRiffInfo 属性。

```
// re-encodes a file and adds a comment to it.    
var init = Bass.BASS_Init(-1, 44100, BASSInit.BASS_DEVICE_DEFAULT, IntPtr.Zero);
if (init)
{
    int channel = Bass.BASS_StreamCreateFile("filename", 0, 0, BASSFlag.BASS_STREAM_DECODE);
    var tagInfo = new TAG_INFO { comment = "your comment" };
    var encoderWav = new EncoderWAV(channel);
    encoderWav.WAV_AddRiffInfo = true;
    encoderWav.TAGs = tagInfo;
    encoderWav.OutputFile = "output.wav";
    var start = encoderWav.Start(null, IntPtr.Zero, false);
    Bass.Free();
} 
```

**注意：不要忘记将 bass.dll 放在 .EXE 所在的位置**

（起初 BASS 是一个 C 库，BASS.NET 为其提供了一个包装器，但也提供了许多原始库中不存在的很酷的东西，例如编码器、可视化器等......）

IMO BASS.NET 是 .NET 的最佳音频库，尤其是低级的东西，实际上这是唯一的 :-)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T15:15:12.817

好的，所以最后它不是真正的标准格式。`CueWaveFileWriter`我们通过利用Mark Heath 所说的方式发现了这一点。格式实际上是非常自定义的，看起来更像这样：

```
LIST - this is a one-time blurb of text.
Tag Name (e.g. ICOP for copyright)
4 bytes indicating the length of the following value + 1\. The 1 was a (byte)0 terminator.
Value 
```

所以一个例子可能如下所示：

```
ICOP<bh:15><bh:00><bh:00><bh:00>4/5/2013 10:48:40 AM<bh:00> 
```

所以，为了完成这件事，我们只是创建了一个`BinaryWriter`并像这样直接写出来：

```
using (BinaryWriter bw = new BinaryWriter(writer))
{
    foreach (var item in RIFFChunks)
    {
        if (!(bw.BaseStream.Position % 2 == 0))
        {
            bw.Write((byte)0);
        }

        bw.Write(Encoding.Default.GetBytes(item.Key));
        bw.Write(item.Value.Length + 1);
        bw.Write(Encoding.Default.GetBytes(item.Value));
        bw.Write((byte)0);
    }
} 
```

您可能需要注意这一行`if (!(bw.BaseStream.Position % 2 == 0))`，因为每个标签名称都需要以偶数偏移量开始。老实说，我不知道为什么，我只知道确实如此。

不过我不得不说，我现在很有可能可以对任何文件格式进行逆向工程。但说真的，这有什么好处？！？

# http - 在 http 处理程序中使用 goroutine 和通道

> ID：15820046
> 
> 赞同：2
> 
> 时间：2013-04-04T19:29:44.397
> 
> 标签：http, go, channels

我已经实现了一个非常简单的 twitter 客户端阅读器：

```
package main

import (
    "encoding/json"
    "fmt"
    "io/ioutil"
    "log"
    "net/http"
    "time"
)

type twitterResult struct {
    Results []struct {
        Text     string `json:"text"`
        Ids      string `json:"id_str"`
        Name     string `json:"from_user_name"`
        Username string `json:"from_user"`
        UserId   string `json:"from_user_id_str"`
    }
}

var (
  twitterUrl = "http://search.twitter.com/search.json?q=%23UCL"
  pauseDuration = 5 * time.Second
)

func retrieveTweets(c chan<- *twitterResult) {
    for {
        resp, err := http.Get(twitterUrl)
        if err != nil {
            log.Fatal(err)
        }

        defer resp.Body.Close()
        body, err := ioutil.ReadAll(resp.Body)
        r := new(twitterResult) //or &twitterResult{} which returns *twitterResult
        err = json.Unmarshal(body, &r)
        if err != nil {
            log.Fatal(err)
        }
        c <- r
        time.Sleep(pauseDuration)
    }

}

func displayTweets(c chan *twitterResult) {
    tweets := <-c
    for _, v := range tweets.Results {
        fmt.Printf("%v:%v\n", v.Username, v.Text)
    }

}

func main() {
    c := make(chan *twitterResult)
    go retrieveTweets(c)
    for {
        displayTweets(c)
    }

} 
```

我现在想为它构建一个简单的 Web 客户端并让它显示 twitter 结果。但我对在 http 处理程序中调用 goroutines 持谨慎态度。有人指出我正确的方向吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T21:55:15.597

You're sort of limited with goroutines within the context of an HTTP request because that HTTP request expects a response, not a "wait until later". Here are a couple options:

1.  Use websockets. I've never implemented a websocket in Go, so I don't have any experience there, but this is really the best way to have the client wait for data and display it as it comes in. [This blog post](http://gary.beagledreams.com/page/go-websocket-chat.html) seems to have a good tutorial. (You could also use a COMET framework to achieve something similar here.)

2.  Don't use goroutines, but rather AJAX requests to keep the asynchronousness (totally a word) on the client. What that would look like is the client loading your page, which makes a bunch of AJAX requests to your server, which you can handle in multiple threads so they could theoretically all finish around the same time. Note that you *can* spawn a goroutine to respond to a specific request, but that goroutine should be expected to respond to that request fully.

3.  Use goroutines to make all your requests to the Twitter API, but wait for them all to finish and lump them all together before completing the request and making the response. This lets all your Twitter API requests happen simultaneously and saves you time on the backend, but your client still has to wait for that time (the slowest API request) before showing anything to the user.

If it were me and I were in a hurry, I'd go with option 2 and leave the heavy lifting to the client, while just using the server as basically a proxy to the Twitter API. But option 1 would be a better solution, especially if you're not too worried about browser compatibility.

# java - 如何模拟 Map 的返回值？

> ID：15820047
> 
> 赞同：16
> 
> 时间：2013-04-04T19:29:45.257
> 
> 标签：java, mockito

我的代码看起来像这样：

```
for (Map.Entry<Integer, Action> entry : availableActions.entrySet()) {
  ...
} 
```

我试图像这样模拟它：

```
Map mockAvailableActions = mock(Map.class, Mockito.RETURNS_DEEP_STUBS);
mockAvailableActions.put(new Integer(1), mockAction); 
```

我认为这就足够了。但是 entrySet 是空的。所以我添加了这个：

```
when(mockAvailableActions.entrySet().iterator()).thenReturn(mockIterator);
when(mockIterator.next()).thenReturn(mockAction); 
```

仍然 entrySet 是空的。我究竟做错了什么？感谢您的任何意见！

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2013-04-04T19:34:54.310

也许我错过了一些东西，但为什么不这样做：

```
Map.Entry<Integer, Action> entrySet = <whatever you want it to return>
Map mockAvailableActions = mock(Map.class);
when(mockAvailableActions.entrySet()).thenReturn(entrySet); 
```

还要考虑你是否真的需要一个模拟地图，不是一个真正的地图吗？模拟通常用于替换您不想参与单元测试的其他代码片段，Map 是核心 Java 语言的一部分，通常不会被模拟出来。

# xml - XSL 按嵌套参数分组

> ID：15820052
> 
> 赞同：1
> 
> 时间：2013-04-04T19:29:51.403
> 
> 标签：xml, xslt, xslt-2.0

我有一个这样的 XML 文件

```
<fruits>
  <fruit>
    <name>banana</name>
    <country>Morocco</country>
  </fruit>
  <fruit>
    <name>orange</name>
    <country>Morocco</country>
  </fruit>
  <fruit>
    <name>grape</name>
    <country>Egypt</country>
  </fruit>
 </fruits> 
```

我需要以另一种方式对其进行分组：

```
<fruits>
  <country name="Morocco">
    <fruit>
      <name>banana</name>
    </fruit>
    <fruit>
      <name>orange</name>
    </fruit>
  </country>
  <country name="Egypt">
    <fruit>
      <name>grape</name>
    </fruit>
  </country>
</fruits> 
```

我尝试`for-each-group`从 XSLT 2.0 开始，但它一点也不好：我不知道如何处理嵌套参数的分组，所以我的 .xsl 文件没有任何好处。

```
<?xml version="1.0"?>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="2.0">

  <xsl:output method="xml" indent="yes"/>

  <xsl:for-each-group select="fruits/fruit" group-by="fruits/fruit/country">
    <country name="{country}">
      <xsl:for-each select="current-group()">
        <fruit>
          <name> '{name}'/</name>
        </fruit>
      </xsl:for-each>
    </country>
  </xsl:for-each-group>

</xsl:stylesheet> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T19:59:25.843

这个怎么样：

```
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="2.0">
  <xsl:output method="xml" indent="yes" omit-xml-declaration="yes"/>

  <xsl:template match="/*">
    <xsl:copy>
      <xsl:for-each-group select="fruit" group-by="country">
        <country name="{country}">
          <xsl:for-each select="current-group()">
            <fruit>
              <name>
                <xsl:value-of select="name" />
              </name>
            </fruit>
          </xsl:for-each>
        </country>
      </xsl:for-each-group>
    </xsl:copy>
  </xsl:template>

</xsl:stylesheet> 
```

或者更清洁的方法：

```
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="2.0">
  <xsl:output method="xml" indent="yes" omit-xml-declaration="yes"/>
  <xsl:strip-space elements="*"/>

  <xsl:template match="@* | node()">
    <xsl:copy>
      <xsl:apply-templates select="@* | node()" />
    </xsl:copy>
  </xsl:template>

  <xsl:template match="/*">
    <xsl:copy>
      <xsl:for-each-group select="fruit" group-by="country">
        <country name="{country}">
          <xsl:apply-templates select="current-group()" />
        </country>
      </xsl:for-each-group>
    </xsl:copy>
  </xsl:template>
  <xsl:template match="fruit/country" />

</xsl:stylesheet> 
```

在您的示例输入上运行时，任何一个都会产生：

```
<fruits>
   <country name="Morocco">
      <fruit>
         <name>banana</name>
      </fruit>
      <fruit>
         <name>orange</name>
      </fruit>
   </country>
   <country name="Egypt">
      <fruit>
         <name>grape</name>
      </fruit>
   </country>
</fruits> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T20:09:13.603

如果您仅限于 XSLT 1.0，那么有几种方法可以做到这一点：它们都不整洁。这个查找所有`<fruit>`在同一国家/地区之前没有兄弟姐妹的元素。然后它复制该`<country>`元素，然后`<fruit>`为自己创建一个新节点，以及每个具有相同国家/地区的兄弟姐妹。

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
  version="1.0">

  <xsl:output indent="yes"/>

  <xsl:template match="/fruits">
    <xsl:copy>
      <xsl:apply-templates select="*"/>
    </xsl:copy>
  </xsl:template>

  <xsl:template match="fruit">
    <xsl:if test="not(country = preceding-sibling::fruit/country)">
      <country>
        <xsl:attribute name="name">
          <xsl:value-of select="country"/>
        </xsl:attribute>
        <xsl:for-each select="../fruit[country=current()/country]">
          <fruit>
            <xsl:copy-of select="name" />
          </fruit>
        </xsl:for-each>
      </country>
    </xsl:if>
  </xsl:template>

</xsl:stylesheet> 
```

**输出**

```
<?xml version="1.0" encoding="utf-8"?>
<fruits>
   <country name="Morocco">
      <fruit>
         <name>banana</name>
      </fruit>
      <fruit>
         <name>orange</name>
      </fruit>
   </country>
   <country name="Egypt">
      <fruit>
         <name>grape</name>
      </fruit>
   </country>
</fruits> 
```

* * *

Muenchian*方法*通过使用 XSLT 的工具来加速这个查询`key`，并且对于相当大的数据集很有用。此替代解决方案声明了键`fruit-by-country`，以便可以使用，例如，选择`<fruit>`具有相同元素值的所有元素。该模板使用 键检查当前是否是第一个具有此值的水果，并选择同一组中的所有水果，以便它们可以一起显示。输出与前一个变换的输出相同。`<country>``key('fruit-by-country', 'Morocco')``<fruit>``<country>`

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
  version="1.0">

  <xsl:output indent="yes"/>

  <xsl:key name="fruit-by-country" match="fruit" use="country" />

  <xsl:template match="/fruits">
    <xsl:copy>
      <xsl:apply-templates select="*"/>
    </xsl:copy>
  </xsl:template>

  <xsl:template match="fruit">
    <xsl:if test="generate-id() = generate-id(key('fruit-by-country', country)[1])">
      <country>
        <xsl:attribute name="name">
          <xsl:value-of select="country"/>
        </xsl:attribute>
        <xsl:for-each select="key('fruit-by-country', country)">
          <fruit>
            <xsl:copy-of select="name" />
          </fruit>
        </xsl:for-each>
      </country>
    </xsl:if>
  </xsl:template>

</xsl:stylesheet> 
```

# css - WordPress css显示图像浮动

> ID：15820057
> 
> 赞同：0
> 
> 时间：2013-04-04T19:30:14.470
> 
> 标签：css, wordpress, css-float

我试着把 2 张图片放在右边和右边，就在下面并向右浮动，问题是它总是显示这两张图片，一个向上，另一个向下

我的代码是这样的：

```
<div style="clear:both;float:right;">
<a onclick="increase_text(1)" href="#"><img src="'.get_template_directory_uri().'/images/text_increase.png" style="float:left;"></a> 
<a onclick="decrease_text(1)" href="#"><img src="'.get_template_directory_uri().'/images/text_decrease.png" style="float:left;"></a>
</div>
<br/> 
```

我怎样才能在同一行显示这个显示图像并正确浮动？， 谢谢

# javascript - OnClick 中函数的 jQuery 引用问题

> ID：15820061
> 
> 赞同：0
> 
> 时间：2013-04-04T19:30:30.120
> 
> 标签：javascript, jquery

这是我的代码：

```
jQuery("#"+code+"_2").after("<a href='#' id='"+code+"_3' onclick='addfunction('"+code+"', event); return true;'><img src='special.gif' border='0'></a>"); 
```

我在 addfunction( 上遇到语法错误。代码是一个字符串，我尝试将它用引号括起来，但它不起作用。有什么想法吗？

更新 --- 这有效，但不会在函数中传递代码和事件。

```
function addfunction() {
alert("THIS WORKS");
}
var myAnchor = $('<a href="#" id="' + code + '_3"><img src="special.gif" border="0"></a>').bind('click', addfunction);
$('#' + code + '_2').after(myAnchor); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T19:32:58.710

您需要转义内部单引号：

```
jQuery("#"+code+"_2").after("<a href='#' id='"+code+"_3' onclick='addfunction(\'"+code+"\', event); return true;'><img src='special.gif' border='0'></a>"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T19:45:53.667

为了您的头脑清醒，请尝试重新组织您的代码：

```
var insertLink = function(code) {
   var parent = jQuery('#' + code + '_2');
   var a = $('<a/>', {
       href: '#',
       id: code + '_3'
   }).html('<img src='special.gif' border='0'>').on('click', function() {
      addfunction(code, event);
      return true;
   });
} 
```

我没有测试过代码，但你明白了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-04T19:53:29.593

这行得通！尽量避免 onclick 事件，使用 on() 代替。

首先创建锚点，将点击事件绑定到它，然后附加到 DOM。

```
function addfunction(code, event) {
    alert("THIS WORKS, the code is: " + code);
}
var myAnchor = $('<a href="#" id="' + code + '_3"><img src="special.gif" border="0"></a>').bind('click', function(event) {
    addfunction(code, event);
});
$('#' + code + '_2').after(myAnchor); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-04T19:33:06.117

你的问题是`addfunction('"+code+"', event)` 你需要在 onnClick 值中转义单引号

```
jQuery("#"+code+"_2").after("<a href='#' id='"+code+"_3' onclick='addfunction(\'"+code+"\', event); return true;'><img src='special.gif' border='0'></a>"); 
```

# asp.net - WPF 或 ASP.NET 作为 WCF 客户端

> ID：15820071
> 
> 赞同：1
> 
> 时间：2013-04-04T19:30:50.527
> 
> 标签：asp.net, wpf, wcf, web-services

我是 WCF 的新手，现在正在学习教程。我想知道使用 WPF 或 ASP.NET Web 应用程序作为服务客户端的优点和缺点是什么。我知道这取决于服务的类型，但除了一个是 Windows 应用程序和另一个是 Web 应用程序的共同区别之外，一个比另一个有什么优势。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T20:10:55.177

首先，客户端技术的选择完全不取决于您将与之交谈的服务类型。WPF/Winforms 和 Web 应用程序都将完全能够与 Web 服务通信。

相反，客户端技术的选择应该完全由**客户端的需求驱动**

在使用一种客户端技术而不是另一种时，您应该考虑的因素是：

*   您（和您的团队）可获得的专有技术
*   部署场景：如何将您的应用程序提供给用户等。
*   客户端环境：你需要支持多少个操作系统，做一个网络应用需要支持多少种不同的浏览器？
*   您是否有偶尔连接的场景，或者您是否需要对客户端资源的特权访问？- 这将在一定程度上向富客户端倾斜。

即便如此，在许多情况下，Web 应用程序似乎是一个非常有效的选择，因为您可以访问大量非 MS 技术，如 Javascript 框架、CSS 资源等。

就个人而言：不要使用 WCF 来定义您的 Web 服务 - 有很棒的开源框架，最著名的是[ServiceStack](http://www.servicestack.net/)，它将使您更有效率并专注于您的服务所做的事情，而不是在机制和抽象上。

# c# - Visual Studio Intellisense 图标可供下载？

> ID：15820074
> 
> 赞同：0
> 
> 时间：2013-04-04T19:31:00.653
> 
> 标签：c#, visual-studio-2010, visual-studio-2012, icons, intellisense

嗨，我想知道 Visual Studio 2010/2012 的 Intellisense 菜单中用于区分方法和字段等的图标是否可以在某处下载？

![在此处输入图像描述](https://i.stack.imgur.com/LHdVu.png)

它们可用作我正在开发的当前应用程序的占位符。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T19:38:44.070

这些图像在 Visual Studio 2008 SDK 中公开可用，路径如下：

> VisualStudioIntegration\Common\Source\CSharp\LanguageService\Resources\completionset.bmp

我不知道这些图像是根据什么许可证分发的，因为我只将它们用作 Visual Studio 本身扩展的一部分。

编辑：图像与 Visual Studio 2005 和 2008 的 SDK 一起分发，但不再包含在 Visual Studio 2010 或 2012 的 SDK 中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-04T19:34:00.743

Avalon Edit 是开源的，您可能可以使用其中的图像：

[https://github.com/icsharpcode/SharpDevelop/wiki/AvalonEdit](https://github.com/icsharpcode/SharpDevelop/wiki/AvalonEdit)

这些图像是 Microsoft 的财产，因此不应使用，我相信快速 google 会为您指明合适的图像使用方向。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-08-16T14:48:34.563

## Visual Studio 2012（及更高版本）

[对于 VS 2012 及更高版本，您可以从 Microsoft 的Visual Studio Image Library](https://www.microsoft.com/en-us/download/details.aspx?id=35825)下载图标。

## Visual Studio 2010（及更早版本）

根据他们的[文档](https://social.technet.microsoft.com/wiki/contents/articles/17794.visual-studio-how-to-get-high-quality-icons-using-image-library.aspx)，早期版本与 Visual Studio 捆绑在一起，因此如果您安装了 VS，则可以在本地找到它们：

**视觉工作室 2005**

...\Program Files\Microsoft Visual Studio 8\Common7\VS2005ImageLibrary\VS2005ImageLibrary.zip

**视觉工作室 2008**

...\Microsoft Visual Studio 9.0\Common7\VS2008ImageLibrary\1033\VS2008ImageLibrary.zip

**视觉工作室 2010**

...\Microsoft Visual Studio 10.0\Common7\VS2010ImageLibrary\1033\VS2010ImageLibrary.zip

# docpad - 文档板设计注意事项

> ID：15820080
> 
> 赞同：0
> 
> 时间：2013-04-04T19:31:17.857
> 
> 标签：docpad

我来自 php/mysql 背景。我最熟悉 Kohana PHP 框架，我正在尝试学习 Docpad。在这一点上我有一个松散的理解，我已经建立了我的第一个网站和博客。静态内容在 Docpad 上对我来说很有意义。

我正在我的摄影网站上工作，我希望能够将新图像上传到作品集。后端需要处理上传的高分辨率图像，并在图像的不同分辨率下创建多个不同的副本。**我最大的问题是如何跟踪我想要显示的图像元数据？**我是否为每个图像生成一个物理文件，其中包含我想要跟踪的所有细节并将这些文件用作我的可搜索数据库，就像博客文章的设置方式一样？

或者我应该去使用像 MongoDB 这样的东西来存储图像数据，在那里可以查询并插入到布局中？

关于处理 POST 或 GET 数据，我应该阅读 express.js 文档吗？我真的不知道该去哪里。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T23:25:11.650

Wordpress 使用 TimThumb 调整图像大小：[WordPress.com 如何动态调整图像大小？](https://stackoverflow.com/questions/10475884/how-does-wordpress-com-resize-images-dynamically)

然后是节点的这个重新调整大小的库：[用于文件附件和图像大小调整的节点包](https://stackoverflow.com/questions/7141720/node-package-for-file-attachments-and-image-resizing)

如果您想创建 3 种不同大小的图像并使用 DocPad 中的主干集合，那么您可以将不同大小的图像添加到这三个不同的集合/文件夹中。要访问图像，您可能只能通过其文件名来完成。因此，当您复制、重新调整大小和重命名图像时，在重命名步骤中，在末尾连接图像大小，例如：coolPhoto-med.jpg，然后您可以通过硬链接获取图像，例如 /spring- collection/med/coolPhoto-med.jpg 或者您可以使用查询引擎来访问它们。

文件模型有一个元属性：[https](https://github.com/bevry/docpad/blob/master/src/lib/models/file.coffee#L17) ://github.com/bevry/docpad/blob/master/src/lib/models/file.coffee#L17 我还没有学习如何使用它。

我知道我们昨天在#docpad IRC 上聊天，但我也想在这里回答你。如果您确实编写了为 DocPad 重新调整图像大小的代码，请考虑将其放在 Github 上与社区分享。

# xamarin.ios - MvxBindableCollectionViewSource 的实现

> ID：15820081
> 
> 赞同：1
> 
> 时间：2013-04-04T19:31:21.920
> 
> 标签：xamarin.ios, xamarin, mvvmcross

我是 Mvvmcross 框架的新手，目前正在探索它的 iOS 部分（哦，也是 iOS 开发的新手，以描绘我目前的情况^^）。我正在使用 vNext 版本。

我找到了对 UICollectionViewController 实现的引用（MvxTouchCollectionViewController 和 MvxBindableCollectionViewSource），但是这些类似乎只是未来实现的骨架（抽象类，至少缺少一种 MvxSimpleBindableCollectionViewSource）。我还没有找到使用此功能的示例。我还发现了 Stuart 的一篇博文，假设他正在研究这一部分（[Work In Progress - MvvmCross lists sample](http://slodge.blogspot.co.uk/2013/01/work-in-progress-mvvmcross-lists-sample.html)）。

是否有人已经玩过这部分并知道实现或使用示例？

我看过 Stuart 在其文章中提到的第 10 分钟的研讨会，看起来很有趣，对我来说是一个很好的起点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T19:56:19.660

我在几个客户应用程序中使用了集合视图控制器，但我认为我没有发布任何使用它的开源示例。

本质上，collectionview 的使用与 tableview 和 cell 的使用非常相似——详见：[http ://slodge.blogspot.co.uk/2013/01/uitableviewcell-using-xib-editor .html](http://slodge.blogspot.co.uk/2013/01/uitableviewcell-using-xib-editor.html)

在 vNext 中，示例控制器可能如下所示：

```
public class MyCollectionView : BaseCollectionView<MyCollectionViewModel>
{
    private bool _needToCallViewDidLoadManually;

    public HubView (MvxShowViewModelRequest request)
        : base(request, new UICollectionViewFlowLayout (){
            ItemSize= new System.Drawing.SizeF (100, 100),
            MinimumInteritemSpacing = 20.0f,
            SectionInset = new UIEdgeInsets (10,50,20,50),
            ScrollDirection = UICollectionViewScrollDirection.Vertical,

        })
    {
        if (_needToCallViewDidLoadManually) {
            ViewDidLoad();
        }
    }

    public override void ViewDidLoad ()
    {
        if (ShowRequest == null) {
            _needToCallViewDidLoadManually = true;
            return;
        }

        base.ViewDidLoad ();

        _needToCallViewDidLoadManually = false;

        var source = new CollectionViewSource(CollectionView);

        this.AddBindings(
            new Dictionary<object, string>()
            {
            { source, "ItemsSource TheItems" }
        });

        CollectionView.Source = source;
        CollectionView.ReloadData();
    }

    public class CollectionViewSource : MvxBindableCollectionViewSource
    {
        public CollectionViewSource (UICollectionView collectionView)
            : base(collectionView, MyViewCell.Identifier)
        {
            collectionView.RegisterNibForCell(UINib.FromName(MyViewCell.Identifier, NSBundle.MainBundle), MyViewCell.Identifier);
        }
    }
} 
```

* * *

如果您现在开始开发，那么考虑刚刚进入 Beta 的 v3 分支，您可能也会受益。

# mysql - 使用从另一个表的行值派生的列名创建一个表

> ID：15820082
> 
> 赞同：8
> 
> 时间：2013-04-04T19:31:29.097
> 
> 标签：mysql

假设我有一个带有单列的下表：

表格1

```
-----------
| nameCol |
-----------
| A       |
| A       |
| B       |
| C       |
----------- 
```

我想创建一个具有以下列名称的新表：

表_2

```
| pk | A | B | C | 
```

也就是说，一张表的数据成为第二张表的列名。在某种程度上可能涉及一个支点，但我无法真正得到答案。

我试过：

```
create table Table_2 (
  select group_concat(distinct(nameCol), " varchar(50), ")
  from Table_1
); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-04T19:38:27.717

您可以使用动态查询：

```
SELECT
  CONCAT(
    'CREATE TABLE Table_2 (',
    GROUP_CONCAT(DISTINCT
      CONCAT(nameCol, ' VARCHAR(50)')
      SEPARATOR ','),
    ');')
FROM
  Table_1
INTO @sql;

PREPARE stmt FROM @sql;
EXECUTE stmt; 
```

请[在此处](http://sqlfiddle.com/#!2/b5fc0/1)查看小提琴。

# php - mod_rewrite 隐藏文件扩展名

> ID：15820083
> 
> 赞同：0
> 
> 时间：2013-04-04T19:31:32.320
> 
> 标签：php, .htaccess, mod-rewrite

```
Options +FollowSymLinks 
RewriteEngine on

RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*) /files.php?q=$1

RewriteCond %{HTTP_HOST} ^mysite.com
RewriteRule (.*) http://m.mysite.com/$1 [R=301,L]

AddHandler application/x-httpd-php5 .html .htm .txt .php 
```

我的 .htaccess 对所有请求都使用主要的“files.php”。在我的 files.php 中，我有一些包含 href 的代码，如下所示：

`/people/john`--> 当一个人点击这个时，它应该转到：`people.php?q=john` 但是，当一个人点击这个时，我的 .htaccess 没有重定向`/people/john`。顺便说一句，即使那是幕后发生的事情，网址也应该始终说“`/people/john`不”。`people.php?q=john`

只想说，我有

```
/city/newyork --> city.php?q=newyork
/country/australia --> country.php?q=australia 
```

我一直在努力和在这里寻找确切的位置，但仍然没有运气。我感谢所有的回应。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T20:38:28.083

根据您的示例，您的网址如下所示：

```
/city/newyork, where city is the php file to call with parameter newyork 
```

如果这就是你想要的，试试这个：Options +FollowSymLinks RewriteEngine on

```
# Rewrite /city/newyork to city.php?q=newyork
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)/(.*) /$1.php?q=$2 [L]

# Rewrite all urls without a second / to files.php?q=$1
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*) /files.php?q=$1 [L]

RewriteCond %{HTTP_HOST} ^mysite.com
RewriteRule (.*) http://m.mysite.com/$1 [R=301,L]

AddHandler application/x-httpd-php5 .html .htm .txt .php 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T20:36:29.153

你想让它动态吗？我的意思是，`/$anything1/$anything2`将被重新映射为`/$anything1.php?=$anything2`：

```
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_URI} ^/([a-z0-9-_]+)/([a-z0-9-_]+)/?$
RewriteRule ^(.*) /%1.php?q=%2 
```

或者如果上面的代码不起作用，请尝试以下操作：

```
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_URI} ^/([a-z0-9-_]+)/([a-z0-9-_]+)/?$
RewriteRule ^(.*) http://%{HTTP_HOST}/%1.php?q=%2 [P] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-04T20:46:26.160

这是我在 CodeIgniter 中使用的（支持非常深的 a/b/c/d/e/f/g）

```
 RewriteEngine On
    RewriteBase /
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule ^(.*)$ files.php?/$1 [L] 
```

基本上逐行显示
-打开重写引擎
-使用web_root（因此，如果您在子文件夹中，它可能不是/适合您）
-如果url不是现有文件
-并且url不是现有文件dir
- 将参数映射到 files.php

刚刚意识到您正在使用 Files.php ......奇怪，如果它是所有内容都应该通过的路由，则应该将其称为索引以保持一致性，或者创建一个将文件夹/文件/*路由到 index.php?tab=files& 的索引。 ..

希望这可以帮助

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-06T14:54:46.817

Faa，我按照你说的做了，下面是我的服务器变量，我认为正确的变量应该是下面写着“应该是这个：”的变量。

```
["QUERY_STRING"]=>
  string(17) "q=city/newyork"
  ["REDIRECT_QUERY_STRING"]=>
  string(17) "q=city/newyork"
  ["REDIRECT_STATUS"]=>
  string(3) "200"
  ["REDIRECT_URL"]=>
  string(16) "/city/newyork"
["REQUEST_URI"]=>
  string(16) "/city/newyork"
  ["SCRIPT_FILENAME"]=>
  string(30) "/home/mywebsite/myfiles.php"
  ["SCRIPT_NAME"]=>
  string(14) "/myfiles.php"
["PHP_SELF"]=>
  string(14) "/myfiles.php"
  ["argv"]=>
  array(1) {
    [0]=>
    string(17) "q=city/newyork"
  }

should be this:
["QUERY_STRING"]=>
  string(16) "q=newyork"
  ["REDIRECT_QUERY_STRING"]=>
  string(16) "q=newyork"
  ["REDIRECT_STATUS"]=>
  string(3) "200"
  ["REDIRECT_URL"]=>
  string(25) "/city/newyork"
["REQUEST_URI"]=>
  string(25) "/city/newyork"
  ["SCRIPT_FILENAME"]=>
  string(30) "/home/mywebsite/city.php"
  ["SCRIPT_NAME"]=>
  string(14) "/city.php"
["PHP_SELF"]=>
  string(14) "/city.php"
  ["argv"]=>
  array(1) {
    [0]=>
    string(16) "q=newyork"
  } 
```

# javascript - 使用 Javascript 在现有部分下添加第二部分

> ID：15820084
> 
> 赞同：0
> 
> 时间：2013-04-04T19:31:34.657
> 
> 标签：javascript, html, dom, nodes

`Uncaught TypeError: Cannot call method 'appendChild'`我的目标是在现有部分下创建另一个部分，但由于未定义的错误，我很难添加它。

我收到以下代码错误：

```
getElementsByClassName("row").appendChild(sectionElement); 
```

使用这个创建的功能：

```
function getElementsByClassName(cl) {
    if (!document.getElementsByClassName) {
        document.getElementsByClassName = function (className) {
            var node = [];
            var elem = this.getElementsByTagName('*');
            for (var i = 0; i < elem.length; i++) {
                if((' ' + elem[i].className + ' ').indexOf(' ' + cl + ' ') > -1) retnode.push(elem[i]);
             }
             return node;
        }; 
    }
} 
```

HTML 代码：

```
<div class='row'>
    <section class='well well-small'>
        <legend>Select An Animal</legend>
        <form method="post" id="speciesForm">
            <div class="control-group">
                <div class="controls"></div>
            </div>
            <input type="button" class="btn" >
            <input type="button" class="btn" v>
        </form>
    </section>
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T19:37:49.183

您的函数将始终返回`undefined`，因为如果 `getElementsByClassName`未定义该函数，您将创建它但永远不会调用它。如果它被定义，你的函数不会做任何事情。没有显式`return`语句的函数将返回`undefined`。对您的函数的这些修改应该可以解决问题：

```
function getElementsByClassName(cl) {
    if (!document.getElementsByClassName) {
        document.getElementsByClassName = function (className) {
           var node = [];
           var elem = this.getElementsByTagName('*');
           for (var i = 0; i < elem.length; i++) {
             if((' ' + elem[i].className + ' ').indexOf(' ' + className + ' ') > -1) retnode.push(elem[i]);
           }
           return node;
        }; 
        return document.getElementsByClassName(cl);
    } else {
        return document.getElementsByClassName(cl);
    }
} 
```

还应注意，调用`appendChild`此函数的结果将失败，因为您在自定义函数中返回一个数组，而本机`getElementsByClassName`返回一个 NodeList。

# c# - 检测设备是否正在使用 USB 3.0

> ID：15820091
> 
> 赞同：12
> 
> 时间：2013-04-04T19:31:43.330
> 
> 标签：c#, .net, usb

有谁知道使用 C# 检测连接到 USB 3.0 主机端口的 USB 设备是否以 3.0 或 2.0 运行的方法？

我们正在制造 USB 3.0 延长线，我们需要验证所有引脚是否已正确焊接。我们想在软件中做到这一点。我们想将 3.0 拇指驱动器连接到电缆并检查设备是否在 USB 3.0 模式下运行。如果它处于 2.0 模式，我们知道它们是 1 个或多个 USB 3.0 线路的问题。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-05T01:11:23.483

[在我找到](http://read.pudn.com/downloads105/sourcecode/windows/vxd/432626/USBLib/USB.cs__.htm)的一些源代码的帮助下，我设法制作了一个工作演示。

```
private static void Main(string[] args)
{
  var hostCtrls = USB.GetHostControllers();

  foreach (var hostCtrl in hostCtrls)
  {
    var hub = hostCtrl.GetRootHub();
    foreach (var port in hub.GetPorts())
    {
      if (port.IsDeviceConnected && !port.IsHub)
      {
        var device = port.GetDevice();
        Console.WriteLine("Serial: " + device.DeviceSerialNumber);
        Console.WriteLine("Speed:  " + port.Speed);
        Console.WriteLine("Port:   " + device.PortNumber + Environment.NewLine);
      }
    }
  }
} 
```

![输出](https://i.stack.imgur.com/OL4HX.png)

应用程序枚举 USB 主机控制器。然后它获取根集线器并枚举属于它的端口。如果连接了一个设备并且它不是集线器，那么它会显示所需的信息。

在您的情况下，您可能知道要检查哪个设备，因此您可以修改源（上述代码和链接代码）以仅专门检查该设备。

您需要在 USB 类中创建一个方法，通过指定端口号和集线器的路径从特定集线器获取特定端口。

就像是：

```
GetDeviceSpeed(string hubPath, int portNumber) { ... } 
```

并使用适当的值调用它：

```
var hubPath = @"\\.\NUSB3#ROOT_HUB30#5&b235176&0#{f18a0e88-c30c-11d0-8815-00a0c906bed8}";
var portNumber = 2;
GetDeviceSpeed(hubPath, portNumber); 
```

但是，如果您不愿意这样做，那么您可以简单地使用上面的代码并注意您要测试的设备的序列号，然后只检查速度：

```
if (device.DeviceSerialNumber == "xxxxxx")
  Console.WriteLine("Speed:  " + port.Speed); 
```

如果您要在带有 GUI 的应用程序中使用它，您只需在下拉列表中选择要检查的设备。

嗯......有一些想法，希望有一个可行的解决方案。

**附录**

为了长寿，我将包括我用于演示的修改后的类。
（*由于对 30000 个字符的 SO 限制，删除了注释和空行*）：

```
public class USB
{
    const int GENERIC_WRITE = 0x40000000;
    const int FILE_SHARE_READ = 0x1;
    const int FILE_SHARE_WRITE = 0x2;
    const int OPEN_EXISTING = 0x3;
    const int INVALID_HANDLE_VALUE = -1;
    const int IOCTL_GET_HCD_DRIVERKEY_NAME = 0x220424;
    const int IOCTL_USB_GET_ROOT_HUB_NAME = 0x220408;
    const int IOCTL_USB_GET_NODE_INFORMATION = 0x220408;
    const int IOCTL_USB_GET_NODE_CONNECTION_INFORMATION_EX = 0x220448;
    const int IOCTL_USB_GET_DESCRIPTOR_FROM_NODE_CONNECTION = 0x220410;
    const int IOCTL_USB_GET_NODE_CONNECTION_NAME = 0x220414;
    const int IOCTL_USB_GET_NODE_CONNECTION_DRIVERKEY_NAME = 0x220420;
    const int USB_DEVICE_DESCRIPTOR_TYPE = 0x1;
    const int USB_STRING_DESCRIPTOR_TYPE = 0x3;
    const int BUFFER_SIZE = 2048;
    const int MAXIMUM_USB_STRING_LENGTH = 255;
    const string GUID_DEVINTERFACE_HUBCONTROLLER = "3abf6f2d-71c4-462a-8a92-1e6861e6af27";
    const string REGSTR_KEY_USB = "USB";
    const int DIGCF_PRESENT = 0x2;
    const int DIGCF_ALLCLASSES = 0x4;
    const int DIGCF_DEVICEINTERFACE = 0x10;
    const int SPDRP_DRIVER = 0x9;
    const int SPDRP_DEVICEDESC = 0x0;
    const int REG_SZ = 1;
    enum USB_HUB_NODE
    {
        UsbHub,
        UsbMIParent
    }
    enum USB_CONNECTION_STATUS
    {
        NoDeviceConnected,
        DeviceConnected,
        DeviceFailedEnumeration,
        DeviceGeneralFailure,
        DeviceCausedOvercurrent,
        DeviceNotEnoughPower,
        DeviceNotEnoughBandwidth,
        DeviceHubNestedTooDeeply,
        DeviceInLegacyHub
    }
    enum USB_DEVICE_SPEED : byte
    {
        UsbLowSpeed,
        UsbFullSpeed,
        UsbHighSpeed,
        UsbSuperSpeed
    }
    [StructLayout(LayoutKind.Sequential)]
    struct SP_DEVINFO_DATA
    {
        public int cbSize;
        public Guid ClassGuid;
        public IntPtr DevInst;
        public IntPtr Reserved;
    }
    [StructLayout(LayoutKind.Sequential)]
    struct SP_DEVICE_INTERFACE_DATA
    {
        public int cbSize;
        public Guid InterfaceClassGuid;
        public int Flags;
        public IntPtr Reserved;
    }
    [StructLayout(LayoutKind.Sequential, CharSet = CharSet.Auto)]
    struct SP_DEVICE_INTERFACE_DETAIL_DATA
    {
        public int cbSize;
        [MarshalAs(UnmanagedType.ByValTStr, SizeConst = BUFFER_SIZE)]
        public string DevicePath;
    }
    [StructLayout(LayoutKind.Sequential, CharSet = CharSet.Auto)]
    struct USB_HCD_DRIVERKEY_NAME
    {
        public int ActualLength;
        [MarshalAs(UnmanagedType.ByValTStr, SizeConst = BUFFER_SIZE)]
        public string DriverKeyName;
    }
    [StructLayout(LayoutKind.Sequential, CharSet = CharSet.Auto)]
    struct USB_ROOT_HUB_NAME
    {
        public int ActualLength;
        [MarshalAs(UnmanagedType.ByValTStr, SizeConst = BUFFER_SIZE)]
        public string RootHubName;
    }
    [StructLayout(LayoutKind.Sequential, Pack = 1)]
    struct USB_HUB_DESCRIPTOR
    {
        public byte bDescriptorLength;
        public byte bDescriptorType;
        public byte bNumberOfPorts;
        public short wHubCharacteristics;
        public byte bPowerOnToPowerGood;
        public byte bHubControlCurrent;
        [MarshalAs(UnmanagedType.ByValArray, SizeConst = 64)]
        public byte[] bRemoveAndPowerMask;
    }
    [StructLayout(LayoutKind.Sequential)]
    struct USB_HUB_INFORMATION
    {
        public USB_HUB_DESCRIPTOR HubDescriptor;
        public byte HubIsBusPowered;
    }
    [StructLayout(LayoutKind.Sequential)]
    struct USB_NODE_INFORMATION
    {
        public int NodeType;
        public USB_HUB_INFORMATION HubInformation;
    }
    [StructLayout(LayoutKind.Sequential, Pack = 1)]
    struct USB_NODE_CONNECTION_INFORMATION_EX
    {
        public int ConnectionIndex;
        public USB_DEVICE_DESCRIPTOR DeviceDescriptor;
        public byte CurrentConfigurationValue;
        public byte Speed;
        public byte DeviceIsHub;
        public short DeviceAddress;
        public int NumberOfOpenPipes;
        public int ConnectionStatus;
    }
    [StructLayout(LayoutKind.Sequential, Pack = 1)]
    internal struct USB_DEVICE_DESCRIPTOR
    {
        public byte bLength;
        public byte bDescriptorType;
        public short bcdUSB;
        public byte bDeviceClass;
        public byte bDeviceSubClass;
        public byte bDeviceProtocol;
        public byte bMaxPacketSize0;
        public short idVendor;
        public short idProduct;
        public short bcdDevice;
        public byte iManufacturer;
        public byte iProduct;
        public byte iSerialNumber;
        public byte bNumConfigurations;
    }
    [StructLayout(LayoutKind.Sequential, CharSet = CharSet.Auto)]
    struct USB_STRING_DESCRIPTOR
    {
        public byte bLength;
        public byte bDescriptorType;
        [MarshalAs(UnmanagedType.ByValTStr, SizeConst = MAXIMUM_USB_STRING_LENGTH)]
        public string bString;
    }
    [StructLayout(LayoutKind.Sequential)]
    struct USB_SETUP_PACKET
    {
        public byte bmRequest;
        public byte bRequest;
        public short wValue;
        public short wIndex;
        public short wLength;
    }
    [StructLayout(LayoutKind.Sequential)]
    struct USB_DESCRIPTOR_REQUEST
    {
        public int ConnectionIndex;
        public USB_SETUP_PACKET SetupPacket;
    }
    [StructLayout(LayoutKind.Sequential, CharSet = CharSet.Auto)]
    struct USB_NODE_CONNECTION_NAME
    {
        public int ConnectionIndex;
        public int ActualLength;
        [MarshalAs(UnmanagedType.ByValTStr, SizeConst = BUFFER_SIZE)]
        public string NodeName;
    }
    [StructLayout(LayoutKind.Sequential, CharSet = CharSet.Auto)]
    struct USB_NODE_CONNECTION_DRIVERKEY_NAME
    {
        public int ConnectionIndex;
        public int ActualLength;
        [MarshalAs(UnmanagedType.ByValTStr, SizeConst = BUFFER_SIZE)]
        public string DriverKeyName;
    }
    [DllImport("setupapi.dll", CharSet = CharSet.Auto)]
    static extern IntPtr SetupDiGetClassDevs(
            ref Guid ClassGuid,
            int Enumerator,
            IntPtr hwndParent,
            int Flags
    );
    [DllImport("setupapi.dll", CharSet = CharSet.Auto)]
    static extern IntPtr SetupDiGetClassDevs(
            int ClassGuid,
            string Enumerator,
            IntPtr hwndParent,
            int Flags
    );
    [DllImport("setupapi.dll", SetLastError = true, CharSet = CharSet.Auto)]
    static extern bool SetupDiEnumDeviceInterfaces(
            IntPtr DeviceInfoSet,
            IntPtr DeviceInfoData,
            ref Guid InterfaceClassGuid,
            int MemberIndex,
            ref SP_DEVICE_INTERFACE_DATA DeviceInterfaceData
    );
    [DllImport("setupapi.dll", SetLastError = true, CharSet = CharSet.Auto)]
    static extern bool SetupDiGetDeviceInterfaceDetail(
            IntPtr DeviceInfoSet,
            ref SP_DEVICE_INTERFACE_DATA DeviceInterfaceData,
            ref SP_DEVICE_INTERFACE_DETAIL_DATA DeviceInterfaceDetailData,
            int DeviceInterfaceDetailDataSize,
            ref int RequiredSize,
            ref SP_DEVINFO_DATA DeviceInfoData
    );
    [DllImport("setupapi.dll", SetLastError = true, CharSet = CharSet.Auto)]
    static extern bool SetupDiGetDeviceRegistryProperty(
            IntPtr DeviceInfoSet,
            ref SP_DEVINFO_DATA DeviceInfoData,
            int iProperty,
            ref int PropertyRegDataType,
            IntPtr PropertyBuffer,
            int PropertyBufferSize,
            ref int RequiredSize
    );
    [DllImport("setupapi.dll", SetLastError = true, CharSet = CharSet.Auto)]
    static extern bool SetupDiEnumDeviceInfo(
            IntPtr DeviceInfoSet,
            int MemberIndex,
            ref SP_DEVINFO_DATA DeviceInfoData
    );
    [DllImport("setupapi.dll", SetLastError = true)]
    static extern bool SetupDiDestroyDeviceInfoList(
            IntPtr DeviceInfoSet
    );
    [DllImport("setupapi.dll", SetLastError = true, CharSet = CharSet.Auto)]
    static extern bool SetupDiGetDeviceInstanceId(
            IntPtr DeviceInfoSet,
            ref SP_DEVINFO_DATA DeviceInfoData,
            StringBuilder DeviceInstanceId,
            int DeviceInstanceIdSize,
            out int RequiredSize
    );
    [DllImport("kernel32.dll", SetLastError = true, CharSet = CharSet.Auto)]
    static extern bool DeviceIoControl(
            IntPtr hDevice,
            int dwIoControlCode,
            IntPtr lpInBuffer,
            int nInBufferSize,
            IntPtr lpOutBuffer,
            int nOutBufferSize,
            out int lpBytesReturned,
            IntPtr lpOverlapped
    );
    [DllImport("kernel32.dll", SetLastError = true, CharSet = CharSet.Auto)]
    static extern IntPtr CreateFile(
         string lpFileName,
         int dwDesiredAccess,
         int dwShareMode,
         IntPtr lpSecurityAttributes,
         int dwCreationDisposition,
         int dwFlagsAndAttributes,
         IntPtr hTemplateFile
    );
    [DllImport("kernel32.dll", SetLastError = true, CharSet = CharSet.Auto)]
    static extern bool CloseHandle(
            IntPtr hObject
    );
    static public System.Collections.ObjectModel.ReadOnlyCollection<USBController> GetHostControllers()
    {
        List<USBController> HostList = new List<USBController>();
        Guid HostGUID = new Guid(GUID_DEVINTERFACE_HUBCONTROLLER);
        IntPtr h = SetupDiGetClassDevs(ref HostGUID, 0, IntPtr.Zero, DIGCF_PRESENT | DIGCF_DEVICEINTERFACE);
        if (h.ToInt32() != INVALID_HANDLE_VALUE)
        {
            IntPtr ptrBuf = Marshal.AllocHGlobal(BUFFER_SIZE);
            bool Success;
            int i = 0;
            do
            {
                USBController host = new USBController();
                host.ControllerIndex = i;
                SP_DEVICE_INTERFACE_DATA dia = new SP_DEVICE_INTERFACE_DATA();
                dia.cbSize = Marshal.SizeOf(dia);
                Success = SetupDiEnumDeviceInterfaces(h, IntPtr.Zero, ref HostGUID, i, ref dia);
                if (Success)
                {
                    SP_DEVINFO_DATA da = new SP_DEVINFO_DATA();
                    da.cbSize = Marshal.SizeOf(da);
                    SP_DEVICE_INTERFACE_DETAIL_DATA didd = new SP_DEVICE_INTERFACE_DETAIL_DATA();
                    didd.cbSize = 4 + Marshal.SystemDefaultCharSize;
                    int nRequiredSize = 0;
                    int nBytes = BUFFER_SIZE;
                    if (SetupDiGetDeviceInterfaceDetail(h, ref dia, ref didd, nBytes, ref nRequiredSize, ref da))
                    {
                        host.ControllerDevicePath = didd.DevicePath;
                        int RequiredSize = 0;
                        int RegType = REG_SZ;
                        if (SetupDiGetDeviceRegistryProperty(h, ref da, SPDRP_DEVICEDESC, ref RegType, ptrBuf, BUFFER_SIZE, ref RequiredSize))
                        {
                            host.ControllerDeviceDesc = Marshal.PtrToStringAuto(ptrBuf);
                        }
                        if (SetupDiGetDeviceRegistryProperty(h, ref da, SPDRP_DRIVER, ref RegType, ptrBuf, BUFFER_SIZE, ref RequiredSize))
                        {
                            host.ControllerDriverKeyName = Marshal.PtrToStringAuto(ptrBuf);
                        }
                    }
                    HostList.Add(host);
                }
                i++;
            } while (Success);
            Marshal.FreeHGlobal(ptrBuf);
            SetupDiDestroyDeviceInfoList(h);
        }
        return new System.Collections.ObjectModel.ReadOnlyCollection<USBController>(HostList);
    }
    public class USBController
    {
        internal int ControllerIndex;
        internal string ControllerDriverKeyName, ControllerDevicePath, ControllerDeviceDesc;
        public USBController()
        {
            ControllerIndex = 0;
            ControllerDevicePath = "";
            ControllerDeviceDesc = "";
            ControllerDriverKeyName = "";
        }
        public int Index
        {
            get { return ControllerIndex; }
        }
        public string DevicePath
        {
            get { return ControllerDevicePath; }
        }
        public string DriverKeyName
        {
            get { return ControllerDriverKeyName; }
        }
        public string Name
        {
            get { return ControllerDeviceDesc; }
        }
        public USBHub GetRootHub()
        {
            IntPtr h, h2;
            USBHub Root = new USBHub();
            Root.HubIsRootHub = true;
            Root.HubDeviceDesc = "Root Hub";
            h = CreateFile(ControllerDevicePath, GENERIC_WRITE, FILE_SHARE_WRITE, IntPtr.Zero, OPEN_EXISTING, 0, IntPtr.Zero);
            if (h.ToInt32() != INVALID_HANDLE_VALUE)
            {
                int nBytesReturned;
                USB_ROOT_HUB_NAME HubName = new USB_ROOT_HUB_NAME();
                int nBytes = Marshal.SizeOf(HubName);
                IntPtr ptrHubName = Marshal.AllocHGlobal(nBytes);
                if (DeviceIoControl(h, IOCTL_USB_GET_ROOT_HUB_NAME, ptrHubName, nBytes, ptrHubName, nBytes, out nBytesReturned, IntPtr.Zero))
                {
                    HubName = (USB_ROOT_HUB_NAME)Marshal.PtrToStructure(ptrHubName, typeof(USB_ROOT_HUB_NAME));
                    Root.HubDevicePath = @"\\.\" + HubName.RootHubName;
                }
                h2 = CreateFile(Root.HubDevicePath, GENERIC_WRITE, FILE_SHARE_WRITE, IntPtr.Zero, OPEN_EXISTING, 0, IntPtr.Zero);
                if (h2.ToInt32() != INVALID_HANDLE_VALUE)
                {
                    USB_NODE_INFORMATION NodeInfo = new USB_NODE_INFORMATION();
                    NodeInfo.NodeType = (int)USB_HUB_NODE.UsbHub;
                    nBytes = Marshal.SizeOf(NodeInfo);
                    IntPtr ptrNodeInfo = Marshal.AllocHGlobal(nBytes);
                    Marshal.StructureToPtr(NodeInfo, ptrNodeInfo, true);
                    if (DeviceIoControl(h2, IOCTL_USB_GET_NODE_INFORMATION, ptrNodeInfo, nBytes, ptrNodeInfo, nBytes, out nBytesReturned, IntPtr.Zero))
                    {
                        NodeInfo = (USB_NODE_INFORMATION)Marshal.PtrToStructure(ptrNodeInfo, typeof(USB_NODE_INFORMATION));
                        Root.HubIsBusPowered = Convert.ToBoolean(NodeInfo.HubInformation.HubIsBusPowered);
                        Root.HubPortCount = NodeInfo.HubInformation.HubDescriptor.bNumberOfPorts;
                    }
                    Marshal.FreeHGlobal(ptrNodeInfo);
                    CloseHandle(h2);
                }
                Marshal.FreeHGlobal(ptrHubName);
                CloseHandle(h);
            }
            return Root;
        }
    }
    public class USBHub
    {
        internal int HubPortCount;
        internal string HubDriverKey, HubDevicePath, HubDeviceDesc;
        internal string HubManufacturer, HubProduct, HubSerialNumber, HubInstanceID;
        internal bool HubIsBusPowered, HubIsRootHub;
        public USBHub()
        {
            HubPortCount = 0;
            HubDevicePath = "";
            HubDeviceDesc = "";
            HubDriverKey = "";
            HubIsBusPowered = false;
            HubIsRootHub = false;
            HubManufacturer = "";
            HubProduct = "";
            HubSerialNumber = "";
            HubInstanceID = "";
        }
        public int PortCount
        {
            get { return HubPortCount; }
        }
        public string DevicePath
        {
            get { return HubDevicePath; }
        }
        public string DriverKey
        {
            get { return HubDriverKey; }
        }
        public string Name
        {
            get { return HubDeviceDesc; }
        }
        public string InstanceID
        {
            get { return HubInstanceID; }
        }
        public bool IsBusPowered
        {
            get { return HubIsBusPowered; }
        }
        public bool IsRootHub
        {
            get { return HubIsRootHub; }
        }
        public string Manufacturer
        {
            get { return HubManufacturer; }
        }
        public string Product
        {
            get { return HubProduct; }
        }
        public string SerialNumber
        {
            get { return HubSerialNumber; }
        }
        public System.Collections.ObjectModel.ReadOnlyCollection<USBPort> GetPorts()
        {
            List<USBPort> PortList = new List<USBPort>();
            IntPtr h = CreateFile(HubDevicePath, GENERIC_WRITE, FILE_SHARE_WRITE, IntPtr.Zero, OPEN_EXISTING, 0, IntPtr.Zero);
            if (h.ToInt32() != INVALID_HANDLE_VALUE)
            {
                int nBytes = Marshal.SizeOf(typeof(USB_NODE_CONNECTION_INFORMATION_EX));
                IntPtr ptrNodeConnection = Marshal.AllocHGlobal(nBytes);
                for (int i = 1; i <= HubPortCount; i++)
                {
                    int nBytesReturned;
                    USB_NODE_CONNECTION_INFORMATION_EX NodeConnection = new USB_NODE_CONNECTION_INFORMATION_EX();
                    NodeConnection.ConnectionIndex = i;
                    Marshal.StructureToPtr(NodeConnection, ptrNodeConnection, true);
                    if (DeviceIoControl(h, IOCTL_USB_GET_NODE_CONNECTION_INFORMATION_EX, ptrNodeConnection, nBytes, ptrNodeConnection, nBytes, out nBytesReturned, IntPtr.Zero))
                    {
                        NodeConnection = (USB_NODE_CONNECTION_INFORMATION_EX)Marshal.PtrToStructure(ptrNodeConnection, typeof(USB_NODE_CONNECTION_INFORMATION_EX));
                        USBPort port = new USBPort();
                        port.PortPortNumber = i;
                        port.PortHubDevicePath = HubDevicePath;
                        USB_CONNECTION_STATUS Status = (USB_CONNECTION_STATUS)NodeConnection.ConnectionStatus;
                        port.PortStatus = Status.ToString();
                        USB_DEVICE_SPEED Speed = (USB_DEVICE_SPEED)NodeConnection.Speed;
                        port.PortSpeed = Speed.ToString();
                        port.PortIsDeviceConnected = (NodeConnection.ConnectionStatus == (int)USB_CONNECTION_STATUS.DeviceConnected);
                        port.PortIsHub = Convert.ToBoolean(NodeConnection.DeviceIsHub);
                        port.PortDeviceDescriptor = NodeConnection.DeviceDescriptor;
                        PortList.Add(port);
                    }
                }
                Marshal.FreeHGlobal(ptrNodeConnection);
                CloseHandle(h);
            }
            return new System.Collections.ObjectModel.ReadOnlyCollection<USBPort>(PortList);
        }
    }
    public class USBPort
    {
        internal int PortPortNumber;
        internal string PortStatus, PortHubDevicePath, PortSpeed;
        internal bool PortIsHub, PortIsDeviceConnected;
        internal USB_DEVICE_DESCRIPTOR PortDeviceDescriptor;
        public USBPort()
        {
            PortPortNumber = 0;
            PortStatus = "";
            PortHubDevicePath = "";
            PortSpeed = "";
            PortIsHub = false;
            PortIsDeviceConnected = false;
        }
        public int PortNumber
        {
            get { return PortPortNumber; }
        }
        public string HubDevicePath
        {
            get { return PortHubDevicePath; }
        }
        public string Status
        {
            get { return PortStatus; }
        }
        public string Speed
        {
            get { return PortSpeed; }
        }
        public bool IsHub
        {
            get { return PortIsHub; }
        }
        public bool IsDeviceConnected
        {
            get { return PortIsDeviceConnected; }
        }
        public USBDevice GetDevice()
        {
            if (!PortIsDeviceConnected)
            {
                return null;
            }
            USBDevice Device = new USBDevice();
            Device.DevicePortNumber = PortPortNumber;
            Device.DeviceHubDevicePath = PortHubDevicePath;
            Device.DeviceDescriptor = PortDeviceDescriptor;
            IntPtr h = CreateFile(PortHubDevicePath, GENERIC_WRITE, FILE_SHARE_WRITE, IntPtr.Zero, OPEN_EXISTING, 0, IntPtr.Zero);
            if (h.ToInt32() != INVALID_HANDLE_VALUE)
            {
                int nBytesReturned;
                int nBytes = BUFFER_SIZE;
                string NullString = new string((char)0, BUFFER_SIZE / Marshal.SystemDefaultCharSize);
                if (PortDeviceDescriptor.iManufacturer > 0)
                {
                    USB_DESCRIPTOR_REQUEST Request = new USB_DESCRIPTOR_REQUEST();
                    Request.ConnectionIndex = PortPortNumber;
                    Request.SetupPacket.wValue = (short)((USB_STRING_DESCRIPTOR_TYPE << 8) + PortDeviceDescriptor.iManufacturer);
                    Request.SetupPacket.wLength = (short)(nBytes - Marshal.SizeOf(Request));
                    Request.SetupPacket.wIndex = 0x409;
                    IntPtr ptrRequest = Marshal.StringToHGlobalAuto(NullString);
                    Marshal.StructureToPtr(Request, ptrRequest, true);
                    if (DeviceIoControl(h, IOCTL_USB_GET_DESCRIPTOR_FROM_NODE_CONNECTION, ptrRequest, nBytes, ptrRequest, nBytes, out nBytesReturned, IntPtr.Zero))
                    {
                        IntPtr ptrStringDesc = new IntPtr(ptrRequest.ToInt32() + Marshal.SizeOf(Request));
                        USB_STRING_DESCRIPTOR StringDesc = (USB_STRING_DESCRIPTOR)Marshal.PtrToStructure(ptrStringDesc, typeof(USB_STRING_DESCRIPTOR));
                        Device.DeviceManufacturer = StringDesc.bString;
                    }
                    Marshal.FreeHGlobal(ptrRequest);
                }
                if (PortDeviceDescriptor.iProduct > 0)
                {
                    USB_DESCRIPTOR_REQUEST Request = new USB_DESCRIPTOR_REQUEST();
                    Request.ConnectionIndex = PortPortNumber;
                    Request.SetupPacket.wValue = (short)((USB_STRING_DESCRIPTOR_TYPE << 8) + PortDeviceDescriptor.iProduct);
                    Request.SetupPacket.wLength = (short)(nBytes - Marshal.SizeOf(Request));
                    Request.SetupPacket.wIndex = 0x409;
                    IntPtr ptrRequest = Marshal.StringToHGlobalAuto(NullString);
                    Marshal.StructureToPtr(Request, ptrRequest, true);
                    if (DeviceIoControl(h, IOCTL_USB_GET_DESCRIPTOR_FROM_NODE_CONNECTION, ptrRequest, nBytes, ptrRequest, nBytes, out nBytesReturned, IntPtr.Zero))
                    {
                        IntPtr ptrStringDesc = new IntPtr(ptrRequest.ToInt32() + Marshal.SizeOf(Request));
                        USB_STRING_DESCRIPTOR StringDesc = (USB_STRING_DESCRIPTOR)Marshal.PtrToStructure(ptrStringDesc, typeof(USB_STRING_DESCRIPTOR));
                        Device.DeviceProduct = StringDesc.bString;
                    }
                    Marshal.FreeHGlobal(ptrRequest);
                }
                if (PortDeviceDescriptor.iSerialNumber > 0)
                {
                    USB_DESCRIPTOR_REQUEST Request = new USB_DESCRIPTOR_REQUEST();
                    Request.ConnectionIndex = PortPortNumber;
                    Request.SetupPacket.wValue = (short)((USB_STRING_DESCRIPTOR_TYPE << 8) + PortDeviceDescriptor.iSerialNumber);
                    Request.SetupPacket.wLength = (short)(nBytes - Marshal.SizeOf(Request));
                    Request.SetupPacket.wIndex = 0x409;
                    IntPtr ptrRequest = Marshal.StringToHGlobalAuto(NullString);
                    Marshal.StructureToPtr(Request, ptrRequest, true);
                    if (DeviceIoControl(h, IOCTL_USB_GET_DESCRIPTOR_FROM_NODE_CONNECTION, ptrRequest, nBytes, ptrRequest, nBytes, out nBytesReturned, IntPtr.Zero))
                    {
                        IntPtr ptrStringDesc = new IntPtr(ptrRequest.ToInt32() + Marshal.SizeOf(Request));
                        USB_STRING_DESCRIPTOR StringDesc = (USB_STRING_DESCRIPTOR)Marshal.PtrToStructure(ptrStringDesc, typeof(USB_STRING_DESCRIPTOR));
                        Device.DeviceSerialNumber = StringDesc.bString;
                    }
                    Marshal.FreeHGlobal(ptrRequest);
                }
                USB_NODE_CONNECTION_DRIVERKEY_NAME DriverKey = new USB_NODE_CONNECTION_DRIVERKEY_NAME();
                DriverKey.ConnectionIndex = PortPortNumber;
                nBytes = Marshal.SizeOf(DriverKey);
                IntPtr ptrDriverKey = Marshal.AllocHGlobal(nBytes);
                Marshal.StructureToPtr(DriverKey, ptrDriverKey, true);
                if (DeviceIoControl(h, IOCTL_USB_GET_NODE_CONNECTION_DRIVERKEY_NAME, ptrDriverKey, nBytes, ptrDriverKey, nBytes, out nBytesReturned, IntPtr.Zero))
                {
                    DriverKey = (USB_NODE_CONNECTION_DRIVERKEY_NAME)Marshal.PtrToStructure(ptrDriverKey, typeof(USB_NODE_CONNECTION_DRIVERKEY_NAME));
                    Device.DeviceDriverKey = DriverKey.DriverKeyName;

                    Device.DeviceName = GetDescriptionByKeyName(Device.DeviceDriverKey);
                    Device.DeviceInstanceID = GetInstanceIDByKeyName(Device.DeviceDriverKey);
                }
                Marshal.FreeHGlobal(ptrDriverKey);
                CloseHandle(h);
            }
            return Device;
        }
        public USBHub GetHub()
        {
            if (!PortIsHub)
            {
                return null;
            }
            USBHub Hub = new USBHub();
            IntPtr h, h2;
            Hub.HubIsRootHub = false;
            Hub.HubDeviceDesc = "External Hub";
            h = CreateFile(PortHubDevicePath, GENERIC_WRITE, FILE_SHARE_WRITE, IntPtr.Zero, OPEN_EXISTING, 0, IntPtr.Zero);
            if (h.ToInt32() != INVALID_HANDLE_VALUE)
            {
                int nBytesReturned;
                USB_NODE_CONNECTION_NAME NodeName = new USB_NODE_CONNECTION_NAME();
                NodeName.ConnectionIndex = PortPortNumber;
                int nBytes = Marshal.SizeOf(NodeName);
                IntPtr ptrNodeName = Marshal.AllocHGlobal(nBytes);
                Marshal.StructureToPtr(NodeName, ptrNodeName, true);
                if (DeviceIoControl(h, IOCTL_USB_GET_NODE_CONNECTION_NAME, ptrNodeName, nBytes, ptrNodeName, nBytes, out nBytesReturned, IntPtr.Zero))
                {
                    NodeName = (USB_NODE_CONNECTION_NAME)Marshal.PtrToStructure(ptrNodeName, typeof(USB_NODE_CONNECTION_NAME));
                    Hub.HubDevicePath = @"\\.\" + NodeName.NodeName;
                }
                h2 = CreateFile(Hub.HubDevicePath, GENERIC_WRITE, FILE_SHARE_WRITE, IntPtr.Zero, OPEN_EXISTING, 0, IntPtr.Zero);
                if (h2.ToInt32() != INVALID_HANDLE_VALUE)
                {
                    USB_NODE_INFORMATION NodeInfo = new USB_NODE_INFORMATION();
                    NodeInfo.NodeType = (int)USB_HUB_NODE.UsbHub;
                    nBytes = Marshal.SizeOf(NodeInfo);
                    IntPtr ptrNodeInfo = Marshal.AllocHGlobal(nBytes);
                    Marshal.StructureToPtr(NodeInfo, ptrNodeInfo, true);
                    if (DeviceIoControl(h2, IOCTL_USB_GET_NODE_INFORMATION, ptrNodeInfo, nBytes, ptrNodeInfo, nBytes, out nBytesReturned, IntPtr.Zero))
                    {
                        NodeInfo = (USB_NODE_INFORMATION)Marshal.PtrToStructure(ptrNodeInfo, typeof(USB_NODE_INFORMATION));
                        Hub.HubIsBusPowered = Convert.ToBoolean(NodeInfo.HubInformation.HubIsBusPowered);
                        Hub.HubPortCount = NodeInfo.HubInformation.HubDescriptor.bNumberOfPorts;
                    }
                    Marshal.FreeHGlobal(ptrNodeInfo);
                    CloseHandle(h2);
                }
                USBDevice Device = GetDevice();
                Hub.HubInstanceID = Device.DeviceInstanceID;
                Hub.HubManufacturer = Device.Manufacturer;
                Hub.HubProduct = Device.Product;
                Hub.HubSerialNumber = Device.SerialNumber;
                Hub.HubDriverKey = Device.DriverKey;
                Marshal.FreeHGlobal(ptrNodeName);
                CloseHandle(h);
            }
            return Hub;
        }
    }
    public class USBDevice
    {
        internal int DevicePortNumber;
        internal string DeviceDriverKey, DeviceHubDevicePath, DeviceInstanceID, DeviceName;
        internal string DeviceManufacturer, DeviceProduct, DeviceSerialNumber;
        internal USB_DEVICE_DESCRIPTOR DeviceDescriptor;
        public USBDevice()
        {
            DevicePortNumber = 0;
            DeviceHubDevicePath = "";
            DeviceDriverKey = "";
            DeviceManufacturer = "";
            DeviceProduct = "Unknown USB Device";
            DeviceSerialNumber = "";
            DeviceName = "";
            DeviceInstanceID = "";
        }
        public int PortNumber
        {
            get { return DevicePortNumber; }
        }
        public string HubDevicePath
        {
            get { return DeviceHubDevicePath; }
        }
        public string DriverKey
        {
            get { return DeviceDriverKey; }
        }
        public string InstanceID
        {
            get { return DeviceInstanceID; }
        }
        public string Name
        {
            get { return DeviceName; }
        }
        public string Manufacturer
        {
            get { return DeviceManufacturer; }
        }
        public string Product
        {
            get { return DeviceProduct; }
        }
        public string SerialNumber
        {
            get { return DeviceSerialNumber; }
        }
    }
    static string GetDescriptionByKeyName(string DriverKeyName)
    {
        string ans = "";
        string DevEnum = REGSTR_KEY_USB;
        IntPtr h = SetupDiGetClassDevs(0, DevEnum, IntPtr.Zero, DIGCF_PRESENT | DIGCF_ALLCLASSES);
        if (h.ToInt32() != INVALID_HANDLE_VALUE)
        {
            IntPtr ptrBuf = Marshal.AllocHGlobal(BUFFER_SIZE);
            string KeyName;
            bool Success;
            int i = 0;
            do
            {
                SP_DEVINFO_DATA da = new SP_DEVINFO_DATA();
                da.cbSize = Marshal.SizeOf(da);
                Success = SetupDiEnumDeviceInfo(h, i, ref da);
                if (Success)
                {
                    int RequiredSize = 0;
                    int RegType = REG_SZ;
                    KeyName = "";
                    if (SetupDiGetDeviceRegistryProperty(h, ref da, SPDRP_DRIVER, ref RegType, ptrBuf, BUFFER_SIZE, ref RequiredSize))
                    {
                        KeyName = Marshal.PtrToStringAuto(ptrBuf);
                    }
                    if (KeyName == DriverKeyName)
                    {
                        if (SetupDiGetDeviceRegistryProperty(h, ref da, SPDRP_DEVICEDESC, ref RegType, ptrBuf, BUFFER_SIZE, ref RequiredSize))
                        {
                            ans = Marshal.PtrToStringAuto(ptrBuf);
                        }
                        break;
                    }
                }
                i++;
            } while (Success);
            Marshal.FreeHGlobal(ptrBuf);
            SetupDiDestroyDeviceInfoList(h);
        }
        return ans;
    }
    static string GetInstanceIDByKeyName(string DriverKeyName)
    {
        string ans = "";
        string DevEnum = REGSTR_KEY_USB;
        IntPtr h = SetupDiGetClassDevs(0, DevEnum, IntPtr.Zero, DIGCF_PRESENT | DIGCF_ALLCLASSES);
        if (h.ToInt32() != INVALID_HANDLE_VALUE)
        {
            IntPtr ptrBuf = Marshal.AllocHGlobal(BUFFER_SIZE);
            string KeyName;
            bool Success;
            int i = 0;
            do
            {
                SP_DEVINFO_DATA da = new SP_DEVINFO_DATA();
                da.cbSize = Marshal.SizeOf(da);
                Success = SetupDiEnumDeviceInfo(h, i, ref da);
                if (Success)
                {
                    int RequiredSize = 0;
                    int RegType = REG_SZ;
                    KeyName = "";
                    if (SetupDiGetDeviceRegistryProperty(h, ref da, SPDRP_DRIVER, ref RegType, ptrBuf, BUFFER_SIZE, ref RequiredSize))
                    {
                        KeyName = Marshal.PtrToStringAuto(ptrBuf);
                    }
                    if (KeyName == DriverKeyName)
                    {
                        int nBytes = BUFFER_SIZE;
                        StringBuilder sb = new StringBuilder(nBytes);
                        SetupDiGetDeviceInstanceId(h, ref da, sb, nBytes, out RequiredSize);
                        ans = sb.ToString();
                        break;
                    }
                }
                i++;
            } while (Success);
            Marshal.FreeHGlobal(ptrBuf);
            SetupDiDestroyDeviceInfoList(h);
        }
        return ans;
    }
} 
```

# c# - 如何将 DropDownList 绑定到绑定到 ObjectDataSource 的 FormView 内的通用列表？

> ID：15820093
> 
> 赞同：0
> 
> 时间：2013-04-04T19:31:46.987
> 
> 标签：c#, asp.net

我有一个仅在编辑模式下使用的 FormView，绑定到从自定义类中选择的 ObjectDataSource。该自定义类的属性是我想绑定到窗体视图中的 DropDownList 的其他对象的通用列表。

显然这不起作用，因为您不能以声明方式设置 DataSource：

```
<asp:DropDownList ID="ddl" runat="server" DataSource="theList"> 
```

我考虑过在 ObjectDataSource 的 Selected 事件内的代码中绑定 DropDownLists，但 FormView 那时没有绑定，所以我无权访问 DropDownLists。

我可以直接访问在 DropDownList 的 DataBound 事件中选择的 ObjectDataSource 对象吗？如果是这样，我如何得到那个对象。

或者，有没有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T19:37:47.163

你试过formView的DataBound吗？

# ruby-on-rails - Neo4j 和 Rails：使用 neo4j.rb 按日期查询

> ID：15820098
> 
> 赞同：0
> 
> 时间：2013-04-04T19:32:03.977
> 
> 标签：ruby-on-rails, neo4j

我在 Rails 中有一个名为 Shows 的简单模型。在我的控制器中，如果我这样做

@show = Show.all

它按预期工作，显示所有节目。如果我想编辑现有节目并执行以下操作：

@show = Show.find(:id(params[:id]))

它在数据库中找到它并正确填充表单。

如果我想展示一个仅包含即将上映的节目的列表，我该怎么做？每个节目都有一个属性 show_date，类型为“Date”，因此信息就在其中。我知道我可以用 Neo4j 做一个范围，所以我应该能够告诉它从今天的日期到现在的 20 年或其他什么......但是查询是什么？

这里是初学者问题，如果我忽略了一些简单的事情，请道歉。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T12:48:54.947

Neo4j.rb 的开发者 Andreas 在这里回答了我的问题： [https ://groups.google.com/forum/?fromgroups=#!msg/neo4jrb/ROTZF6yobdI/CaePi-rxkGAJ](https://groups.google.com/forum/?fromgroups=#!msg/neo4jrb/ROTZF6yobdI/CaePi-rxkGAJ)

# cocoa-touch - 可以使 NSDataDetector 检测 URL 而不是电子邮件地址吗？

> ID：15820099
> 
> 赞同：1
> 
> 时间：2013-04-04T19:32:05.710
> 
> 标签：cocoa-touch, nsdatadetector

我已经实现`NSDataDetector`了检测 URL，但它也包括电子邮件地址。有没有一种简单的方法可以让它不检测电子邮件，但检测所有其他 URL？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T19:36:23.053

好吧，电子邮件地址不是 URL。`mailto:someone@some.where.com`是一个*包含*电子邮件地址的 URL。因此，回答您的问题：检查您的 URL 是否以`mailto:`. 如果是，请忽略它。如果由于某种原因您将电子邮件地址作为 URL，您可能有一些解析错误......

有关URL 的正则表达式，请参见[此处。](https://stackoverflow.com/q/161738/1593077)

# python - 如何在 Python 中只处理一次重复的有序列表中的每个项目？

> ID：15820100
> 
> 赞同：3
> 
> 时间：2013-04-04T19:32:06.380
> 
> 标签：python, python-2.7, set, duplicate-removal, test-and-set

我有一个要处理的有序列表，其中包括一些重复项，我只想处理第一次出现。目前，我在 Python v2.7 中这样做：

```
seen = set()
for (value, fmt) in formats:
  if fmt not in seen:
    seen.add(fmt)
    process(value, fmt) 
```

无论如何要同时插入一个新元素`seen`并检测它是否已经存在？（这样可以避免在 . 中重复查找`fmt`。`set`）

```
seen = set()
for (value, fmt) in formats:
  # myInsert() would return true if item was not already present.
  if seen.myInsert(fmt):
    process(value, fmt) 
```

或者，或者，我可以`formats`在循环之前以某种方式过滤掉重复的条目吗？

```
unique_formats = removeDuplicates(formats, key=itemgetter(1))
for (value, fmt) in unique_formats:
  process(value, fmt) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T19:37:06.803

你可以在 . 之前和之后取集合的长度`add()`。如果它没有改变，则格式已经在集合中。

```
seen = set()
for (value, fmt) in formats:
    l1 = len(seen)
    seen.add(fmt)
    if l1 != len(seen):
         process(value, fmt) 
```

您的问题假定`in`测试是一项昂贵的操作。事实证明并非如此。使用`len()`可能需要更多时间，尽管两者都非常快；

```
In [4]: seen = set(range(10000))

In [5]: %timeit 5995 in seen
10000000 loops, best of 3: 122 ns per loop

In [6]: %timeit len(seen)
1000000 loops, best of 3: 167 ns per loop 
```

（在 2.5 GHz Core Quad Q9300 上使用 CPython 2.7.3 测量）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T19:51:16.440

我认为你的第一种方法是最好的。甚至`unique_everseen`来自的配方[`itertools recipes`](http://docs.python.org/2/library/itertools.html#recipes)也使用相同的方法。

```
def unique_everseen(iterable, key=None):
    "List unique elements, preserving order. Remember all elements ever seen."
    # unique_everseen('AAAABBBCCDAABBB') --> A B C D
    # unique_everseen('ABBCcAD', str.lower) --> A B C D
    seen = set()
    seen_add = seen.add
    if key is None:
        for element in ifilterfalse(seen.__contains__, iterable):
            seen_add(element)
            yield element
    else:
        for element in iterable:
            k = key(element)
            if k not in seen:
                seen_add(k)
                yield element 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-04T19:34:09.210

您必须使用一组：

```
for (value, fmt) in set(formats):
   process(value, fmt) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-04T19:47:48.657

```
from ordereddict import OrderedDict
unique_formats = list(OrderedDict.fromkeys(format))
process(unique_formats) 
```

这将保留订单并删除重复项

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-04T19:53:33.140

您可以使用[`itertools.groupby`](http://docs.python.org/2/library/itertools.html#itertools.groupby)按对的第二个元素进行分组，然后只考虑第一个值。

```
>>> from itertools import imap, groupby
>>> from operator import itemgetter
>>> formats = [(1, 'xxx'), (2, 'xxx'), (3, 'yyy'), (4, 'yyy')]
>>> for fmt, value in imap(lambda (x, y): (x, next(y)[0]), groupby(formats, itemgetter(1)):
...    print('%s: %s', fmt, value)
...
xxx: 1
yyy: 3 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-04T19:59:22.420

如果您的列表是有序的，您可以确定相同的格式将彼此相邻。这意味着您不需要使用集合来跟踪过去的值。只需使用一个变量来记录最后处理的格式：

```
last = None
for (value, fmt) in formats:
    if fmt != last:
        last = fmt
        process(value, fmt) 
```

# c++ - 字节翻转和字节交换的区别

> ID：15820106
> 
> 赞同：0
> 
> 时间：2013-04-04T19:32:25.363
> 
> 标签：c++, byte

我试图找出我在 Mac 上的计算器中看到的字节翻转功能的差异，以及程序员的视图。

所以我写了一个程序来字节交换一个值，我们这样做是为了从小端到大端或其他方式，我称之为字节交换。但是当我看到字节翻转时，我不明白它到底是什么以及它与字节交换有何不同。我确实证实了结果是不同的。

例如，对于值为 12976128 的 int

字节翻转给我 198；字节交换给了我 50688。

我想实现一个字节翻转算法，因为 198 是我在阅读内容时想要获得的值。谷歌上的任何内容都说字节翻转找到了帮助字节交换，这对我来说不是这种情况。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T19:40:45.853

字节翻转和字节交换是同义词。

您看到的结果只是交换字节的两种不同方式，具体取决于您将数字视为 32 位数字（由 4 个字节组成），还是可以容纳 12976128 的数字的最小大小，即 24 位或 3 个字节。

4 字节交换在计算机文化中更为常见，因为 32 位处理器目前占主导地位（即使 64 位架构仍然以 32 位数字进行大部分数学运算，部分原因是向后兼容的软件基础架构，部分原因是它足以满足许多实际用途）。但是 Mac 计算器似乎使用最小宽度交换，在本例中为 3 字节交换。

12976128 转换为十六进制时，为您提供 0xC60000。总共 3 个字节；每个十六进制数字为 4 位，或半字节宽。要交换的字节是 0xC6、零和另一个零。

3字节交换后：0x0000C6 = 198

4字节交换后：0x0000C600 = 50688

# php - 如何连接到两个数据库

> ID：15820107
> 
> 赞同：-1
> 
> 时间：2013-04-04T19:32:34.290
> 
> 标签：php, mysql

我正在尝试连接到两个数据库来为我的几个数据库创建一个搜索引擎。这是一个测试代码。有人可以告诉我我做错了什么或者是否有可能。谢谢。

```
mysql_connect("localhost","user","pass");
mysql_select_db("db1");
mysql_select_db("db2");

$search=mysql_query("SELECT * from db1.repairs, db2.order from db1,db2");
while($row=mysql_fetch_array($search)){
    echo $row['first_name']."&nbsp;".$row['esn']."&nbsp;".$row['order_type']."<br>";
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T19:51:07.080

如果像这样在表名之前指定数据库名，则可以跨数据库查询

```
SELECT     a.col1, b.col2 
FROM       db1.table1 AS a
INNER JOIN db2.table2 AS b ON a.someIdFromA = b.someIdFromB 
```

正如 Korcholis 提到的，问题出在您的选择中。`mysql_*`如果可以避免，您也不想使用这些功能。PDO 或 MySqli 是首选。

**编辑** 至少这可以使用 MySQL。我敢打赌它也适用于大多数其他 RDBMS，但我没有其他方便的测试，我不能说这是否符合 SQL 标准。评论有人吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T19:57:12.357

您可以使用

```
<?php
$db1 = mysql_connect("localhost","user","pass");
$db2 = mysql_connect("remote","user","pass");

mysql_select_db("db1", $db1);
mysql_select_db("db1", $db2);

$query1 = mysql_query("USE somedatabase", $db1);
$query2 = mysql_query("USE otherdatabase", $db2); 
```

或者尝试使用在不同实例中处理这些连接的类 [http://www.joni2back.com.ar/programacion/php-class-for-mysql-databases/](http://www.joni2back.com.ar/programacion/php-class-for-mysql-databases/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-04T20:15:50.930

尝试查看此内容，也许您无法使用 querying 查询数据库`FROM`：

```
<?php
$con1 = mysqli_connect("$hostname", "$user1", "$password1", "$db1");
if (mysqli_connect_errno($con1)) {
    echo mysqli_connect_error();
}

$con2 = mysqli_connect("$hostname", "$user2", "$password2", "$db2");
if (mysqli_connect_errno($con2)) {
    echo mysqli_connect_error();
}

$search1 = mysqli_query($con1, "SELECT * from $db1table");

$search2 = mysqli_query($con2, "SELECT * from $db2table");

/* Other PHP codes here */

mysqli_close($con1);
mysqli_close($con2);
?> 
```

您甚至可以改进此代码，也不能将其最小化！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-04T19:38:20.847

[`mysql_connect`](http://php.net/manual/en/function.mysql-connect.php)返回一个`$resource`。你可以连接两次，每次都选择一个数据库（实际上，你可以从连接本身中选择一个数据库），然后使用每个连接。

但是，您的问题是您的 SELECT 不正确。您正在尝试从数据库中的表中选择字段，这是不正确的。事实上，您不能以如此奇特的方式获取两个不同的数据库，因为它们被认为是两组相互独立且不相关的信息。这就是存在表的原因，以适应该问题。

然而，[这个其他答案可能有一个解决方案。](https://stackoverflow.com/questions/15670633/php-connect-to-two-databases-simultaneously-on-same-server-using-adbdb)

否则，您可以使用两个`mysql_connect`和两个资源连接到每个数据库，获取值并自己交叉它们。我知道，这不是最佳选择，但可以满足您的需求。

PS：如果您现在开始项目，请切换到 Mysqli 或 PDO。不推荐使用 Mysql。

# jquery - 状态的 jQuery 验证

> ID：15820108
> 
> 赞同：3
> 
> 时间：2013-04-04T19:32:36.020
> 
> 标签：jquery, regex, jquery-validate

我无法让 jquery.validation.js 验证状态。这是我编写的自定义代码：

```
jQuery.validator.addMethod("state", function(state, element) {
    return this.optional(element) || state.match(/^d{2}[A-Z]+$/);
}, "Please specify a valid state"); 
```

什么需求改变了？在我看来没问题。它需要匹配 2 个大写字母。另外，这种格式是如何工作的？对我来说真的没有多大意义，所有奇怪的符号来指定可以使用哪些字符。在某个地方有这方面的指南吗？

[http://docs.jquery.com/Plugins/Validation](http://docs.jquery.com/Plugins/Validation)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T19:48:00.657

您为什么不尝试将其用于大写的州代码：

```
/^(A[LKSZRAEP]|C[AOT]|D[EC]|F[LM]|G[ANU]|HI|I[ADLN]|K[SY]|LA|M[ADEHINOPST]|N[CDEHJMVY]|O[HKR]|P[ARW]|RI|S[CD]|T[NX]|UT|V[AIT]|W[AIVY])$/ 
```

在您的示例中：

```
jQuery.validator.addMethod("state", function (state, element) {
    return this.optional(element) || state.match(/^(A[LKSZRAEP]|C[AOT]|D[EC]|F[LM]|G[ANU]|HI|I[ADLN]|K[SY]|LA|M[ADEHINOPST]|N[CDEHJMVY]|O[HKR]|P[ARW]|RI|S[CD]|T[NX]|UT|V[AIT]|W[AIVY])$/);
}, "Please specify a valid state"); 
```

# php - Project Euler #3 - 寻找质因数

> ID：15820112
> 
> 赞同：1
> 
> 时间：2013-04-04T19:32:45.597
> 
> 标签：php, math

**剧透**

这是关于[Project Euler](http://projecteuler.net/)的问题 3，如果您想尝试它，请不要提前阅读，因为它包含答案！

* * *

因此，目标是找到一个数字的最大素数，我编写的代码会这样做，但是当数字变大时会失败，我不知道为什么，我想知道是否有人可以帮我看看。我唯一能想到的是，对于某些 PHP 的数据类型来说，这个数字太大了？

我会粘贴我的代码，如果您没有本地测试环境，您可以将代码粘贴到这里，[http://writecodeonline.com/php/](http://writecodeonline.com/php/)

理论（我确信有更有效的方法来解决这个问题，但我既不是数学家也不是流利的编码器），它将从一个必须高于所有主要因素的数字开始，它然后依次尝试将起始数字除以另一个数字，如果结果是整数，它会一次又一次地运行该过程，直到它不再给出整数（必须是素数）。然后它将起始数字除以这个素数以获得一个新数字，然后将其插入第一个函数以获得一个新的素数和另一个数字，它一直这样做直到所有数字都是素数。然后是对最大素数的简单检查。

它一直有效，直到一个非常大的数字，即如果你测试`13195`你得到`29`最大的素数，但如果你用`600851475143`(The question) 测试它给出的最大素数是不正确的。我知道答案是`6857`，所以我确保我的起始计数器大于它，但它仍然失败 - 我不知道为什么。

感谢您的时间，这是代码（我再次知道会有更有效的方法，我想知道为什么我的方法不起作用）。

这是代码：

```
$startVal = 13195;
echo "<b>Starting Value</b> = $startVal<br /><br />";

$scriptTime = -microtime(true);

$testVar = 10000;
$primeArray = array();
$processArray = "";

function findPrimes($startStart,$startTest, array & $primeArray, $processArray) {
    $test = $startTest;
    $start = $startStart;
    $holdVal = NULL;
    for ($i=$test; $i > 1 ; $i--) { 
        if(is_int($start/$i) && $start != $i) {
            $processArray .= "$start is divisible by $i<br />";
            $start = $i;
            $i = $test +1;
        }
    }
    $processArray .= "Can't Divide Further<br /><b>Found a Prime : <font     color='red'>$start</font></b><br />";
    $primeArray[] = $start;
    if($start != $startStart) {
        $holdVal = $startStart/$start;
    }
    if(isset($holdVal)) {
        findPrimes($holdVal,$startTest,$primeArray,$processArray);
    }
    return array($primeArray,$processArray);
}

echo "Finding Primes...<br />";

$returnArray = findPrimes($startVal,$testVar,$primeArray,$processArray);
$primeArray = $returnArray[0];
$processArray = $returnArray[1];

echo "Script Found <b>".count($primeArray)."</b> Prime Numbers (";
for ($i=count($primeArray)-1; $i >= 0 ; $i--) {
    if(!$i == 0)
        echo $primeArray[$i].", ";
    else
        echo $primeArray[$i].")";
}
echo "<br />The largest Prime Factor of $startVal is <b><font     color='red'>".max($primeArray)."</font></b><br />";
$scriptTime = round(($scriptTime += microtime(true))* 1000, 3);
echo "<i>Script took $scriptTime milliseconds<br />";
echo "<br /><br /><b>Process</b><br />";
echo "<pre>";
print_r($processArray);
echo "</pre>"; 
```

也忽略进程文本位，我无法让它工作

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T20:10:45.773

当您有一台 32 位机器时，数字 600851475143 超出了 PHP 中可以使用整数表示的范围，因此`600851475143 / 6857`不是整数：

```
php> var_dump(600851475143/6857);
float(87625999) 
```

[`bcmod`](http://www.php.net/manual/en/function.bcmod.php)如果您使用BC 任意精度库实现可除性检查，则可以使其工作：

```
php> echo bcmod('600851475143','6857');
0 
```

在您的代码中，这将是：

```
for ($i=$test; $i > 1 ; $i--) { 
    if(bcmod($start, $i) == 0 && $start != $i) {
        $processArray .= "$start is divisible by $i<br />";
        $start = $i;
        $i = $test +1;
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-04T20:09:17.307

我怀疑你遇到了整数溢出。目标数字 600851475143 被特别选择为不适合 32 位整数，因此这个问题充当了其他同样需要大整数的问题的“网关”。解决方案是使用更大的数字数据类型。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-04T20:41:06.557

也许 PHP 是为 32 位编译的。64 位操作系统将愉快地运行 32 位二进制文​​件。转到[http://php.net/manual/en/install.windows.manual.php](http://php.net/manual/en/install.windows.manual.php)并确保您已安装 64 位二进制文​​件。

# ruby-on-rails - 一个 ruby on rails 应用程序可以使用两个 sqlite3 数据库吗？

> ID：15820121
> 
> 赞同：1
> 
> 时间：2013-04-04T19:33:29.857
> 
> 标签：ruby-on-rails, database, sqlite

在我的 config/database.yml 文件中

```
# SQLite version 3.x
#   gem install sqlite3
#
#   Ensure the SQLite 3 gem is defined in your Gemfile
#   gem 'sqlite3'
development:
  adapter: sqlite3
  database: db/development.sqlite3
  pool: 5
  timeout: 5000

# Warning: The database defined as "test" will be erased and
# re-generated from your development database when you run "rake".
# Do not set this db to the same as development or production.
test:
  adapter: sqlite3
  database: db/test.sqlite3
  pool: 5
  timeout: 5000

production:
  adapter: sqlite3
  database: db/production.sqlite3
  pool: 5
  timeout: 5000

otherdb:
  adapter: sqlite3
  database: /c/Users/dsun/Documents/apeers/db/development.sqlite3
  pool: 5
  timeout: 10000 
```

在我的模型中，我通过以下方式调用新数据库：`establish_connection :otherdb`

但这会返回错误，`database configuration does not specify adapter`

那么是sqlite3不能一次使用2个db的问题吗？

如果是这样，我该如何解决这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T20:59:55.303

是的，当然，但是在每个模型中，您都应该定义要使用的数据库。您可以使用方法建立连接来定义哪个数据库应该使用当前模型。更多在这里[http://api.rubyonrails.org/classes/ActiveRecord/Base.html](http://api.rubyonrails.org/classes/ActiveRecord/Base.html)。但我可以建议创建几个基本活动记录类来定义每个数据库名称，然后从它们继承你的模型类。

# c++ - 动态分配向量

> ID：15820122
> 
> 赞同：2
> 
> 时间：2013-04-04T19:33:31.227
> 
> 标签：c++, vector

是否可以在不指定类型的情况下动态分配向量？

我正在创建一个应该支持所有数字类型的容器类，它必须创建一个容器向量，该类型将在稍后将第一个数字推入其中时指定。

首先，这段代码是否正确？

```
private :
        vector<int> stk ;

public :
    template <typename Typ> 
    void push (Typ input) 
    {
        vector<Typ> temp ;
                    stk = temp ;
    } 
```

第二：我不知何故需要在不指定类型的情况下动态分配“stk”向量。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T19:42:46.623

如果这是 C++ 代码，那么模板在**编译时是***专门*的。您不能将向量（或任何其他模板类实例）的分配*延迟*到运行时。

 ***一种解决方法是使用基类自定义您自己的数字类层次结构，例如`CNumeric`，并分配`CNumeric*`. 然后向量可以容纳您自己的类层次结构中的任何数字类型。但是，当然，这种解决方法可能*非常*低效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T19:45:24.037

你没有正确解释问题，或者你没有理解你真正需要什么。

如果我理解正确，这就是你要找的。

```
template<typename Typ>
class A {
private :
        vector<Typ> stk ;

public :

    void push (Typ input) 
    {

         stk.push_back(input) ;

    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-04T19:48:40.430

通常你不需要在运行时改变事物的类型（你不能在 C++ 中）。通常，您希望更改程序的设计。

如果你真的想这样做，你可以使用一个联合类型，它可以容纳不同数量的东西之一，比如这里：

```
union A {
  int i;
  float f;
  double d;
}; 
```

然后存储A的向量。***

# perl - 如何在不访问 CPAN 的情况下使用 CPAN 模块？

> ID：15820129
> 
> 赞同：3
> 
> 时间：2013-04-04T19:33:54.327
> 
> 标签：perl, perl-module, cpan

每次我被迫从 CPAN 检索模块时，我都感到非常失望。在我工作的大多数环境中，互联网访问受到严格限制或完全拒绝。在操作系统强化过程中​​，所有编译器都已被删除。在进入或离开站点之前，安全团队会扫描所有数字存储介质。请注意，我了解安全性，这一切对我来说都可以，但是...

仅 CPAN 模块提供的访问代码的推荐或最佳实践是什么。

如果我只需要一个模块给我的一个片段、一个函数或一个功能字符串，我如何在不安装整个模块的情况下提取“正是我需要/想要的”？请记住，我可能实际上是在打印、写下和输入，以从具有 Internet 访问权限的异地位置传输数据。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-04T19:51:20.487

当您无法访问 CPAN 时 - 您想如何使用它？因此，您可以：

*   当可以访问互联网时 - 您可以安装模块
*   如果没有，你可以带一个`minicpan`U 盘或 soo
*   如果由于安全策略而无法做到这一点，您只能使用例如您的手机在 CPAN 上显示源代码并手动重新键入所需的部分
*   如果两者都不可能 - 您可以在家中将源代码打印在您的 T 恤上，然后在工作中重新输入 :)
*   或者，必须自己编程所有东西 - 通过在家学习
*   或者，找到更好的工作:)

编辑：更严肃的方法

首先，有一家公司使用 perl 开发，但不允许使用 CPAN，这很奇怪。当然，我理解对于许多公司来说，直接访问大量未经扫描的软件是不可接受的，但在这种情况下，这里应该存在一些“公司政策”——如何允许访问。

这里有几个问题：

*   硬化仅在技术层面（防火墙等） - 因此您可以将 USB 记忆棒、CD 或任何其他介质带入内部，或
*   政策级别 - 政策不允许使用任何外部资源

如果它在政策层面 - 恕我直言，你不走运。简单地说，当它不允许使用任何外部资源时——您实际上只能使用“打印和重新输入”方法。

这里有一些可能性：

## 建立公司范围的本地 CPAN 存储库

创建具有“受信任”模块的本地 CPAN ( [minicpan ) 服务器。](http://search.cpan.org/dist/CPAN-Mini/bin/minicpan)该存储库也可以用作本地开发模块的存储库。在这种情况下，必须存在一些“审计机构”（政策和程序）如何将模块放入本地 repo。恕我直言，这可能是最有用的方式 - 当公司定期使用 perl 时。

当然，将系统范围（默认 perl 模块）与 CPAN 模块混合不是最好的主意。因此可以设置：

## local::lib 或构建前缀

[local::lib](http://search.cpan.org/dist/local-lib/lib/local/lib.pm) - 使用 PERL5LIB 为 perl 模块创建和使用本地 lib/。谷歌`perl "local::lib"`或类似的东西。另请阅读其他一些 SQ 问题：

*   [如何将 CPAN 模块安装到本地目录中？](https://stackoverflow.com/questions/540640/how-can-i-install-a-cpan-module-into-a-local-directory)
*   [如何在没有安装权限的情况下使用新的 Perl 模块？](https://stackoverflow.com/questions/251705/how-can-i-use-a-new-perl-module-without-install-permissions)
*   [如何在没有 root 访问权限的情况下在本地安装 CPAN 模块（DynaLoader.pm 第 229 行错误）？](https://stackoverflow.com/questions/102850/how-can-i-install-cpan-modules-locally-without-root-access-dynaloader-pm-line-2)
*   和别的

使用 local::lib 是很好的解决方案，因为不会破坏系统范围的 perl 模块。当然，再次 - 您将需要一些“审核过程”如何获取*模块*。

## perlbrew

如果系统没有安装 perl，则使用您自己构建的 perl - [perlbrew - 是更通用的解决方案。](http://perlbrew.pl)你不需要 root 权限来构建你自己的 perl。当然，这里还有一些问题（除了审计），例如“缺少编译器问题”。

## 虚拟机

您可以尝试设置具有完全 CPAN 访问权限的虚拟机进行开发（或隔离的物理机）并在此处进行开发。完成开发后，您可以将所有必需模块的工作转发到“审计流程”。

## 其他

如果您只需要从 CPAN 模块中提取一个功能或一个模块，请在外部机器上进行。提取一个函数或某个部分不是技术问题（当你知道 perl 时）它更多的是一个许可证问题——在你的工作中使用模块的一部分——你需要引用作者。

为此，您需要获取所有需要的功能 - 可以找到有趣的[讨论](http://www.perlmonks.org/?node_id=798738)。谷歌“perl 函数依赖”或类似的东西，或者：

*   [在部署 Perl 项目之前如何确定 CPAN 依赖项？](https://stackoverflow.com/questions/240704/how-can-i-determine-cpan-dependencies-before-i-deploy-a-perl-project)
*   [http://metacpan.org/pod/Module::Extract::Use](http://metacpan.org/pod/Module::Extract::Use)
*   [http://metacpan.org/pod/Module::ScanDeps](http://metacpan.org/pod/Module::ScanDeps)
*   [Perl：CPAN - 模块修改和添加功能](https://stackoverflow.com/questions/11699118/perl-cpan-module-modifying-and-adding-functionality?rq=1)

也许，你会发现[这个讨论](http://www.perlmonks.org/bare/?node_id=514420)也很有趣......

# jquery - 防止在使用 TAB 键时触发 jQuery 模糊

> ID：15820133
> 
> 赞同：2
> 
> 时间：2013-04-04T19:34:04.310
> 
> 标签：jquery, iphone, blur

在具有固定标题的网站的移动版本上工作。因为 iPhone 将标题向上推，而键盘向上滑动，然后又回落……我决定使用 jQuery 隐藏它。

工作得很好......除了当你使用下一个/上一个按钮“标签”时。然后标题将跳动，因为触发了模糊事件。

我在[这里发布了一个小提琴](http://jsfiddle.net/osifer/VVeL9/3/)。我尝试了很多不同的解决方案，但没有找到一个可行的。

```
$(".input").focus(function () {
    $('header').fadeTo("fast", 0).css('z-index', 1);
})
$('.input').delay(100).blur(function () {
    $('header').fadeTo("fast", 1).css('z-index', 3);
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T19:38:03.307

在淡入之前添加`stop`到你的`focus`和小的应该做：`delay`

```
$(".input").focus(function() {
    $('header').stop(true).fadeTo("fast", 0).css('z-index', 1);
});

$('.input').blur(function() {
    $('header').delay(100).fadeTo("fast", 1).css('z-index', 3);
}); 
```

[http://jsfiddle.net/VVeL9/7/](http://jsfiddle.net/VVeL9/7/)

# facebook - 记录对特定链接的点击

> ID：15820134
> 
> 赞同：0
> 
> 时间：2013-04-04T19:34:05.367
> 
> 标签：facebook, logging

我的 facebook 页面上有一个链接，我想生成一个日志，记录哪个用户在什么时间点击了该链接。我怎样才能做到这一点 ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T20:22:40.637

您无法看到哪个用户在什么时间点击了该链接。那将是对隐私的侵犯。Facebook Insights 是聚合分析。

您最多可以使用链接跟踪服务，例如 bit.ly。但这不会告诉你比 Facebook Insights 更多的信息。

# php - 基于两个变量的变量

> ID：15820139
> 
> 赞同：1
> 
> 时间：2013-04-04T19:34:37.623
> 
> 标签：php

在`foreach ($_POST as $key => $value)`我有这样的变量 title_1、title_2、title_3 之后。我需要使 $title 等于 $title_ + $id

我试过的

```
 $link = ${$title_ . $id};
            $title= $title_[$id];
            $title= $title_[$id]; 
```

编码

```
foreach ($_POST as $key => $value)
    {
     if (preg_match('/^id_(\d*)$/', $value, $matches))
        {
    $id = $matches[1];
        if (isset($_POST['title_' . $id]))
            {
                //$link = ${$title_ . $id};
                $title= $title_[$id];
                //mysql_query("UPDATE table SET title='" . $title . "' where id='$id'");

            }
    }
    }

} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-04T19:35:27.987

你想要类似...

```
$link = ${$title."_" . $id}; 
```

也许

```
${"title_" . $id}; 
```

看到这个参考： http: [//php.net/manual/en/language.variables.variable.php](http://php.net/manual/en/language.variables.variable.php)

# sql - 检查多个值是否在 1 个查询中的相应（多个）范围内

> ID：15820140
> 
> 赞同：0
> 
> 时间：2013-04-04T19:34:45.153
> 
> 标签：sql, ms-access

从几年前开始讨论这个问题：[MS Access 2003：检查数据是否在另一个表的范围内](https://stackoverflow.com/questions/4796582/ms-access-2003-check-if-data-is-within-range-from-another-table#)

如果我想在一个查询中检查多个数据是否在多个范围内，我该怎么办？我试图找出一个人每次测试的分数。我对每个测试都有不同的范围，因为一个测试可能满分 100，而另一个测试只能满分 10。

我是否必须使用上面链接的问题中的答案创建许多查询并结合起来，还是有更简单的方法？

表 A：

```
Name        Test1_Score    Test2_Score     Test3_Score        
Person A     205           98              5 
Person B     105           88              8
Person C     400           89              10 
```

表 B：

```
Points       Test1_GradeReq    Test2_GradeReq     Test3_GradeReq
1              0               0               0
2              300             30              1
3              300             70              2
4              400             100             3 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T19:41:48.840

以下获取每个测试和每个人的分数：

```
select a.name, a.Test1_Score, a.Test2_Score, a.Test3_Score,
       sum(iif(test1_score <= test1_gradeReq, 1, 0)) - 1 as Test1_Points,
       sum(iif(test2_score <= test2_gradeReq, 1, 0)) - 1 as Test2_Points,
       sum(iif(test3_score <= test3_gradeReq, 1, 0)) - 1 as Test3_Points
from TableA a, -- cross join
     TableB b
group by a.name, a.Test1_Score, a.Test2_Score, a.Test3_Score 
```

它假设点每一步增加一。

# delphi - 如何在“uses”子句中创建子库？

> ID：15820144
> 
> 赞同：4
> 
> 时间：2013-04-04T19:34:55.140
> 
> 标签：delphi

回到那里，当我使用 Delphi 2006 时，它是：

```
 uses System, SysUtils, StrUtils, Windows, Dialogs, WinApi; 
```

但最近我们可以使用：

```
 uses Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants, System.Classes, Vcl.Graphics; 
```

**这种变化如何运作？**他们是否将`System.pas`into分开，`System.*.pas`或者他们是否创建了一个新的子句来在单个库中按类型分隔函数？

**如何修改我的旧库以使其像这样工作？**我想做一些类似的东西：MyLib.Logic、MyLib.Arrays、MyLib.NetWork 等。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-04T20:20:43.483

只需在 ide 中打开旧文件，然后在项目管理器中重命名单元即可。它会自动更改文件中的单位名称。

之后，打开并重新编译您的旧项目，以确保您引用了正确的单元名称。

这些点相对于下划线之类的唯一优势似乎是您可以在代码完成中获得匹配的“子库”列表。

任何点之前的部分都不应该被称为“命名空间”，因为它不像一个那样工作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-04T19:40:42.833

它们被称为`namespaces`，它们从 Delphi 7 左右就开始存在，当时他们正准备发布 Delphi 8（Delphi for .NET）。添加它们是为了支持 .NET 方面的事情。它们记录在[Using Namespaces with Delphi](http://docwiki.embarcadero.com/RADStudio/en/Using_Namespaces_with_Delphi)中。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-04-04T20:59:15.143

您遇到的称为[**Unit Scope Names**](http://docwiki.embarcadero.com/RADStudio/XE3/en/Unit_Scope_Names)。更改了各种 RTL 和 VCL 单元名称，以更好地区分哪些单元是特定于平台的，哪些是跨平台的。不仅单元名称使用命名空间，自 Delphi.NET 引入以来就一直存在，现在甚至单元文件名本身现在也使用命名空间，这是新的。

如果您不编写跨平台代码，那么我们鼓励您使用新语法：

```
uses
  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants, System.Classes, Vcl.Graphics 
```

但是，如果您想编写跨平台代码，或者只需要维护遗留代码，则继续使用原始语法：

```
uses
  System, SysUtils, StrUtils, ...; 
```

然后根据需要确保“Winapi”、“System”、“Vcl”、“Fmx”等前缀包含在 Project Options 的“Unit Scope Names”字段中。

# android - 无法在 Android 手机上写入 SD 卡

> ID：15820148
> 
> 赞同：3
> 
> 时间：2013-04-04T19:35:04.690
> 
> 标签：android

**EDIT2：对于那些从谷歌偶然发现这个问题的人。该`canWrite()`功能有点错误，似乎无法正常工作。我建议不要使用它。只是`catch`和例外。还要确保您的手机未处于`USB Storage`模式，以便您可以写入 SD 卡。最后确保 Android 设备中的设置没有写保护或类似的东西。**

我似乎在尝试在我的 Android 手机上写入我的 SD 卡时遇到问题。我是在 Eclipse 的调试模式下，还是自己运行手机都没有关系。我无法写入 SD 卡。是的，权限已配置，如下所示。使用 Android 网站上提供的代码片段时，在完成该段后，我的两个布尔值都为 false。我完全不知道为什么存储不可用或不可写。我从我的 Mac 中弹出 SD 卡和手机，以确保它们没有使用它并且手机可以安装，但就像我说的那样，我在完全不使用 Eclipse 时遇到了同样的问题。

编辑：根据关于信息使用运行 4.04 的真正 Android 手机。

```
boolean mExternalStorageAvailable = false;
boolean mExternalStorageWriteable = false;
String state = Environment.getExternalStorageState();

if (Environment.MEDIA_MOUNTED.equals(state)) {
    // We can read and write the media
    mExternalStorageAvailable = mExternalStorageWriteable = true;
} else if (Environment.MEDIA_MOUNTED_READ_ONLY.equals(state)) {
    // We can only read the media
    mExternalStorageAvailable = true;
    mExternalStorageWriteable = false;
} else {
    // Something else is wrong. It may be one of many other states, but all we need
    //  to know is we can neither read nor write
    mExternalStorageAvailable = mExternalStorageWriteable = false;
} 
```

显现：

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.tinywebteam.gpstracker"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION" />
    <uses-permission android:name="android.permission.INTERNET" />
    <uses-permission android:name="android.permission.READ_EXTERNAL_STORAGE" />
    <uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE"/>
    <uses-sdk
        android:minSdkVersion="8"
        android:targetSdkVersion="17" />

    <application
        android:allowBackup="true"
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/AppTheme" >
        <activity
            android:name="com.tinywebteam.gpstracker.MainActivity"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
    </application>

</manifest> 
```

尝试在`mkdirs()`下面执行时失败并抛出分配的异常：

```
try {
            File sdCard = Environment.getExternalStorageDirectory();
            File dir = new File(sdCard.getAbsolutePath() + "/GPStracker/data/");
            if (!dir.exists()) {
                if (!dir.mkdirs())
                    throw new FileNotFoundException("Couldn't make directory.");
            }
            File fileOut = new File(dir, "GPSTracker_" + ts + ".csv");
            if (fileOut.canWrite()) {
                FileOutputStream out = new FileOutputStream(fileOut);
                out.write(fileStr.getBytes());
                out.close();
                System.out.println("File written successfully");
            } else {
                System.out.println("Could not write to file");
            }
        } catch (FileNotFoundException e) {
            e.printStackTrace();
        } catch (IOException e) {
            e.printStackTrace();
        } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T19:48:07.723

根据[文档](http://developer.android.com/reference/android/os/Environment.html#MEDIA_SHARED)，您所描述的状态意味着您无法访问外部媒体存储：

> 公共静态最终字符串 MEDIA_SHARED
> 
> 在 API 级别 1 中添加 getExternalStorageState() 如果媒体存在但未安装，则返回 MEDIA_SHARED，并通过 USB 大容量存储共享。
> 
> 常数值：“共享”

您需要转到 USB 大容量存储选项并关闭 USB 存储。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T20:03:32.400

这是交易，你正在使用

```
File sdCard = Environment.getExternalStorageDirectory();
File dir = new File(sdCard.getAbsolutePath() + "/GPStracker/data/"); 
```

而是使用 -

```
File sdCard = Environment.getExternalStorageDirectory();
File dir = new File(sdcard + "/GPStracker/data"); 
```

在这里，我们没有使用第二个“/”，因为`mkdirs()`将其误解为创建递归目录。你不会得到这个例外。并检查您传递的文件名是否在前面附加了“/”，或者它也以这种方式工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-04T20:05:05.107

我有一个三星 Galaxy s3（运行 android 4.1.2），我的内部存储器名为 sdCard0，我的外部 sd 卡名为 extSdCard。

所以 Environment.getExternalStorageDirectory() 返回了 sdCard0 的路径，我的内部手机内存

在这种情况下，您可以使用以下内容获取实际路径。

```
String externalpath = new String();
String internalpath = new String();

public  void getExternalMounts() {
Runtime runtime = Runtime.getRuntime();
try
{
Process proc = runtime.exec("mount");
InputStream is = proc.getInputStream();
InputStreamReader isr = new InputStreamReader(is);
String line;

BufferedReader br = new BufferedReader(isr);
while ((line = br.readLine()) != null) {
    if (line.contains("secure")) continue;
    if (line.contains("asec")) continue;

    if (line.contains("fat")) {//external card
        String columns[] = line.split(" ");
        if (columns != null && columns.length > 1) {
            externalpath = externalpath.concat("*" + columns[1] + "\n");
        }
} 
        else if (line.contains("fuse")) {//internal storage
        String columns[] = line.split(" ");
        if (columns != null && columns.length > 1) {
            internalpath = internalpath.concat(columns[1] + "\n");
        }
    }
}
}
catch(Exception e)
{
    e.printStackTrace();
}
System.out.println("Path  of sd card external............"+externalpath);
System.out.println("Path  of internal memory............"+internalpath);
} 
```

获得实际路径后，您可以将文件写入 sdcard。

# java - Gson 应为 BEGIN_ARRAY，但为 STRING

> ID：15820149
> 
> 赞同：1
> 
> 时间：2013-04-04T19:35:07.377
> 
> 标签：java, json, gson

所有 StackOverflow 的答案都没有帮助我。根据他们和我搜索的所有其他地方，我的 JSON 看起来是正确的，看起来很好。

我无法在 Java 中加载我的 JSON 文件，我真的需要帮助。

这是我的 JSON

```
{"evento":
 {"descricao":"saf","finalizado":false,"id":1,"localEvento":"asufgb","nome":"Teste",
  "convidados":
   [{"acompanhante":null,"id":"28147",
     "localHospedagem":"ATLANTE PLAZA","nome":"FooBar","nomeCracha":"FOO","observacoes":null,"participante":null,
     "publico":"FROTISTAS"}
   ]}} 
```

这是我的代码

```
JsonReader reader = new JsonReader(new InputStreamReader(new FileInputStream(filePath)));

JsonObject obj = parser.parse(reader).getAsJsonObject();

Evento evento = gson.fromJson(obj.get("evento"), Evento.class); 
```

和错误

```
Caused by: java.lang.IllegalStateException: Expected BEGIN_ARRAY but was STRING
    at com.google.gson.internal.bind.JsonTreeReader.expect(JsonTreeReader.java:139) 
```

谁能告诉我我做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-06T13:54:13.603

我可能会采取以下方法。

```
import java.io.FileReader;
import java.util.List;

import com.google.gson.Gson;

public class App
{
  public static void main(String[] args) throws Exception
  {
    Evento evento = new Gson().fromJson(new FileReader("input.json"), EventoWrapper.class).evento;
    System.out.println(evento.descricao);
  }
}

class EventoWrapper
{
    Evento evento;
}

class Evento
{
    String descricao;
    String finalizado;
    int id;
    String localEvento;
    String nome;
    List<Convidado> convidados;
}

class Convidado
{
    String acompanhante;
    int id;
    String localHospedagem;
    String nome;
    String nomeCracha;
    String observacoes;
    String participante;
    String publico;
} 
```

# html - CSS：“表格布局：固定”和 Safari 中单元格的边框大小

> ID：15820154
> 
> 赞同：9
> 
> 时间：2013-04-04T19:35:16.703
> 
> 标签：html, css, cross-browser, tablelayout

我有一个简单的表格，带有标题和表格主体。所有单元格都应该是固定宽度，只有一个是可变的（例如名称）。

我需要`table-layout: fixed`在`text-overflow: ellipsis`可变宽度单元格上使用。

这是表格的 CSS：

```
table {
    width: 550px;
    border: 1px solid #AAA;
    table-layout: fixed;
    border-collapse: collapse;
}
table td, table th {
    border: 1px solid #DDD;
    text-align: left;
    padding: 5px 15px 5px 15px;
    -webkit-box-sizing: border-box;
    box-sizing: border-box;
}
.one {
    width: 60px;
}
.two {
    width: auto;
    text-overflow: ellipsis;
    overflow: hidden;
    white-space: nowrap;
}
.three, .four, .five {
    width: 90px;
} 
```

检查**[HTML 以及演示](http://jsfiddle.net/zinkkrysty/ccGaP/4/)**。

我试图让这个表在所有浏览器中的行为都相同，但似乎 box-sizing:border-box 在 Safari 中被忽略了。虽然根据[这个答案](https://stackoverflow.com/a/14419952/322253)，它应该是对旧版本 Safari 中的错误的修复。

这是它在 Chrome 中的外观： ![在此处输入图像描述](https://i.stack.imgur.com/6MfFZ.png)

以及它在 Safari 6.0.3 中的外观： ![在此处输入图像描述](https://i.stack.imgur.com/0hyXF.png)

这个问题也出现在我测试过的所有较新的 Mac 版 Safari 中。我几乎可以肯定我一周前在 Safari 中对它进行了测试，新旧版本都运行良好。不知何故，新的 Safari 突然出现了一种新的错误。

我正在使用 Safari 版本 6.0.3 (7536.28.10)。旧 Safari 版本 5.0.5 (6533.21.1, 6533.21) 似乎工作正常。

人，在发疯之前帮助我！我在这里做错了什么还是真的是一个错误？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-10T08:59:07.123

更好的方法是完全删除表格并使用 CSS，但如果这不可能，我建议为只影响 safari 的表格尝试一些特定于浏览器的 css

jQuery代码

```
if ($.browser.safari) {
                $("html").addClass("saf");
            }; 
```

然后在你的CSS中

```
.saf table
{
// any adjustments required
} 
```

尽管如果使用这种方法，我至少会在桌子上建议一个 id。我在 StackOverflow 上发现了这种方法，我不能声称它是我的功劳，但是当我只需要一些特定于浏览器的 hack 时，我就使用它

**更新**

只需将任何人偶然发现此错误，正如下面的评论中所指出的，$.browser 已在 jquery 1.9 版中被删除，因此另一种方法是使用modernizr.js 并使用如下代码

```
<script type="text/javascript">                             
    $(document).ready(function () {

        Modernizr.addTest('ff', function () {
            return !!navigator.userAgent.match(/firefox/i);
        });
        Modernizr.addTest('gc', function () {
            return !!navigator.userAgent.match(/chrome/i);
        });
        Modernizr.addTest('saf', function () {
            return !!navigator.userAgent.match(/safari/i);
        });      
        Modernizr.addTest('op', function () {
            return !!navigator.userAgent.match(/opera/i);
        });
    })           
</script> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-10T06:01:00.013

试试这个，你可以使用：

```
<table width="100%" cellspacing="0">
<colgroup>
<col width="specific width of the column 1"/>
<col width="specific width of the column 2"/>
and so on
</colgroup>
<thead>
</thead>
<tbody>
</tbody>
</table> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-10T06:40:45.983

尝试内联列宽，但仅在一行上！例如：

```
<table>
<thead>
    <tr>
        <th class="one"   width="60">One</th>
        <th class="two">Two</th>
        <th class="three" width="90">Three</th>
        <th class="four"  width="90">Four</th>
        <th class="five"  width="90">Five</th>
    </tr>
</thead>
<tbody>
    <tr>
        <td class="one">1</td>
        <td class="two">Text that could be too long for this column and it should be truncated.</td>
        <td class="three">3</td>
        <td class="four">4</td>
        <td class="five">5</td>
    </tr>
    <tr>
       ...
    </tr>
</tbody> 
```

这是一个**[演示](http://jsfiddle.net/ccGaP/22/)**。

在我的 safari 5.1.7 (7534.57.2) 中，您的代码运行良好......我的也是......

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-10T07:42:55.873

[这](https://coderwall.com/p/sdzewg)应该对这个问题有所启发。在表格单元格中使用时，似乎`box-sizing`在 Safari 6 中不再起作用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-04-12T04:06:53.293

如果要设置`width: auto;`ie的可变宽度，那就考虑自己根据哪一行来设置这个。一行可能是 100px，另一行可能是该列的 300px，那么哪一行是重要的呢？你显然对此感到困惑。就像浏览器混淆应该应用到哪一行`width: auto;`。一些浏览器根据它的标题和一些根据它的行内容设置它。因此，您必须将宽度设置为在任何浏览器中的行为都相同。

您需要声明列的宽度，以便在任何浏览器中对其进行修复。所以我刚刚添加`width: 60px;`了你的`.two`选择器。

看到**[这个小提琴](http://jsfiddle.net/ccGaP/24/)**

**注意：**如果只是 safari 中的问题，请添加`width: inherit;`到您的`.two`选择器中。它工作正常。

# javascript - javascript中的“这个”？

> ID：15820157
> 
> 赞同：0
> 
> 时间：2013-04-04T19:35:26.580
> 
> 标签：javascript

假设我有以下内容：

```
function test() {
     this.message = "Hello World";
     this.marker = //A google marker object
     google.maps.event.addListener(this.marker,'click', function(mouseEvent) {
         alert(this.message); // Incorrect as "this" refers to this.mypolygon
     });     
} 
```

如何使我可以正确地在事件侦听器中提醒“Hello World”？换句话说，从事件监听器中获取“this”的正确上下文？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T20:06:17.570

您将需要关闭。

```
function test() {
     var self = this;
     this.message = "Hello World";
     this.marker = //A google marker object

     google.maps.event.addListener(this.marker,'click', function(mouseEvent) {
         alert(self.message); // Now "self" points to parent function scope
     });     
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T19:37:37.750

不要使用`this`关键字。使用其他不会改变的东西`addListener`：

```
function test() {
     foo.message = "Hello World";
     this.marker = //A google marker object
     google.maps.event.addListener(this.marker,'click', function(mouseEvent) {
         alert(foo.message); 
     });     
} 
```

甚至更清洁：

```
function test() {
     var message = "Hello World";
     this.marker = //A google marker object
     google.maps.event.addListener(this.marker,'click', function(mouseEvent) {
         alert(message); 
     });     
} 
```

或者，您可以这样做：

```
function test() {
     this.message = "Hello World";
     this.marker = //A google marker object

     var self = this;
     google.maps.event.addListener(this.marker,'click', function(mouseEvent) {
         alert(self.message); 
     });     
} 
```

最后，如果你真的想`this`在点击处理程序中使用，你可以使用`bind`：

```
function test() {
     this.message = "Hello World";
     this.marker = //A google marker object

     google.maps.event.addListener(this.marker,'click', myFunc.bind(this) );

     function myFunc(mouseEvent) {
         alert(this.message); 
     }     
} 
```

# xcode - Xcode：用于在提交视图中导航更改的键盘快捷键？

> ID：15820159
> 
> 赞同：16
> 
> 时间：2013-04-04T19:35:34.170
> 
> 标签：xcode, version-control, keyboard-shortcuts

在 Xcode 中将文件提交到 SCM 时，它会调出带有比较视图的版本编辑器（显示每个文件的差异）。如果您单击文件之间的装订线，您可以使用向上和向下箭头键在更改之间快速导航。但是，您不能轻松地使用键盘移动到下一个文件（据我所知）。必须使用鼠标单击每个文件，然后单击装订线，使用键盘在更改之间移动，然后单击下一个文件，这是非常乏味的。

有谁知道仅使用键盘在此视图中的文件之间导航的方法？

我已经进行了一些搜索并查看了 Xcode 的 Key Bindings 首选项，但我找不到任何东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-04-10T13:37:08.193

这有点笨拙，但您可以`Cmd-Shift-J`在项目导航器中按 转到当前文件，然后使用向上和向下箭头选择不同的文件。从那里您可以按`Cmd-J, Return`将光标置于编辑器视图中。

# javascript - 在 Javascript 中从子方法调用父方法。

> ID：15820165
> 
> 赞同：0
> 
> 时间：2013-04-04T19:36:09.443
> 
> 标签：javascript, class

我有一个班级叫人：

```
function Person() {}

Person.prototype.walk = function(){
  alert ('I am walking!');
};
Person.prototype.sayHello = function(){
  alert ('hello');
}; 
```

学生类继承自 person：

```
function Student() {
  Person.call(this);
}

Student.prototype = Object.create(Person.prototype);

// override the sayHello method
Student.prototype.sayHello = function(){
  alert('hi, I am a student');
} 
```

我想要的是能够从它的子sayHello方法中调用父方法sayHello，如下所示：

```
Student.prototype.sayHello = function(){
      SUPER // call super 
      alert('hi, I am a student');
} 
```

因此，当我有一个学生实例并在此实例上调用 sayHello 方法时，它现在应该警告“你好”，然后是“嗨，我是学生”。

在不使用框架的情况下，调用 super 的一种优雅且（现代）的方式是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T19:37:33.117

你可以做：

```
Student.prototype.sayHello = function(){
    Person.prototype.sayHello.call(this);
    alert('hi, I am a student');
} 
```

您还可以通过执行以下操作使其更通用*：*

```
function Student() {
    this._super = Person;
    this._super.call(this);
}

...

Student.prototype.sayHello = function(){
    this._super.prototype.sayHello.call(this);
    alert('hi, I am a student');
} 
```

...虽然，TBH，我认为那里的抽象不值得。

# mysql - 在 Java 中执行多个 COUNT 查询

> ID：15820166
> 
> 赞同：0
> 
> 时间：2013-04-04T19:36:18.407
> 
> 标签：mysql, arrays, string

我有一个 MySQL 数据库（版本 5.2 CE），我有一个表，我想根据用户给出的 WHERE 条件（来自数组列表）将其过滤到另一个表中。我想针对用户选择的拆分对这个新表执行计数查询。例如，来自 TableName WHERE 的 COUNT(*) [userConditions like gender=male and gender=female, etc]。用户可以提供多个 WHERE 条件，但 COUNT 查询一次只能采用一个条件。因此，我将我的方法（执行此查询）设为一个数组，以根据用户选择的条件数量返回多个查询，然后在 for 循环中执行每个查询。但是，这似乎以两种方式给了我编译错误：i）我在 String[] 方法中返回构建字符串的方式和 ii）我执行 COUNT 查询的方式。这些问题的代码：

```
private String countQuery;

public SetupSubsamplePopulation(UserSelectedSplit split) {

    this.split = split;
    // connect to the database
    try {
        Class.forName("com.mysql.jdbc.Driver").newInstance();

        connection = DriverManager.getConnection("jdbc:mysql://localhost:3306/mysql?zeroDateTimeBehavior=convertToNull","root", "sharadha_1992");

        String buildSelectQuery = buildSelectQueryForCode();
        String getRowsFromTable = getNumberOfRows();
        stmt = connection.createStatement();
        rows = stmt.executeUpdate(buildSelectQuery);
        ResultSet rs = stmt.executeQuery(getRowsFromTable);

        for (int i=0; i<getCountOfWhereCondition().length; i++){
            //where I get the executeQuery error
            ResultSet rs1= stmt.execute(getCountOfWhereCondition());
            while (rs1.next()){
                rowsCount= rs.getRow();
                rows_count++;
            }
        }
        while (rs.next()) {
            rows = rs.getRow();
            rows_inserted++;
        }

        System.out.println(rows_inserted);
        System.out.println(rows_count);

    } catch (Exception e) {
        e.printStackTrace();
    }

} 
```

返回 COUNT 个查询数组的方法：

```
public String[] getCountOfWhereCondition() {
    countQuery="SELECT COUNT (*) FROM (SELECT * from mygrist_samples.subsample_population WHERE ";

    for (int i = 0; i < split.getSplitConditions().size(); i++) {

        String getCorrespondingCodeFromDatabase = split.getSplitConditions().get(i).getCode();
        getCorrespondingCodeFromDatabase = getCorrespondingCodeFromDatabase.replaceAll("-", "_");

        Enumerations enum1 = new Enumerations();

        String getCorrespondingRelationshipOperator = enum1.getOperator(split.getSplitConditions().get(i).getRelationship());

        countQuery+=getCorrespondingCodeFromDatabase + " " + getCorrespondingRelationshipOperator + " '" + split.getSplitConditions().get(i).getAnswer() + "'";
    }
    countQuery+=")";

    System.out.println(countQuery);
    //error which doesn't allow me to return a string
    return countQuery;

} 
```

有人可以告诉我如何明智地实施吗？非常感谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T19:44:30.880

我认为您想要条件聚合而不是`where`：

```
select count(*)
from  mygrist_samples.subsample_population
WHERE XXX 
```

是相同的：

```
select sum(case when XXX then 1 else 0 end) as cnt1
from mygrist_samples.subsample_population 
```

现在您可以在一次调用中添加多个条件：

```
select sum(case when XXX then 1 else 0 end) as cnt1,
       sum(case when yyy then 1 else 0 end) as cnt1
from  mygrist_samples.subsample_population 
```

# php - 未捕获的 ReferenceError：未定义 addBlogLink

> ID：15820167
> 
> 赞同：0
> 
> 时间：2013-04-04T19:36:22.913
> 
> 标签：php, javascript, html, function

我对自己真的很失望，因为我知道这很简单，而且我发誓我的代码看起来是正确的。我想我只需要另一双眼睛。

这个错误：

```
Uncaught ReferenceError: addBlogLink is not defined 
```

在我的 php 代码的这一行被调用：

```
<input type=\"button\" onclick=\"addBlogLink($userID,'$beerID')\" class = \"btn btn-warning\" name = \"submit\" value=\"Submit Taste Tag\"> 
```

问题是，它被定义了......如果我去我的这个功能所在的js页面，我有：

```
function addBlogLink(userID, beerID )
    {
        //get values
        var blogTitle = $('#blogTitle').val();
        var link = $('#blogLink').val();

        //clear div
        $('#textToReplace').empty();

        //call to get new friend list
        $('#textToReplace').load('addBeerBlog.php?u=' + userID + "&b=" + beerID + "&t=" + blogTitle + "&l=" + blogLink,
            function() {

        }); 

        return false;
    } 
```

userID 是一个 int 并且 beerID 是一个字符串。我的页面上也有这个，所以我知道可以联系到 js 页面：

```
<script src=\"addBlog.js\"></script> 
```

我也知道正在传递一个 int 和 string，因为当我查看调用该函数的页面源时，我可以看到：

```
<input type="button" onclick="addBlogLink(3,'8NX7Sy')" class = "btn btn-warning" name = "submit" value="Submit Taste Tag"> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T19:59:19.263

浏览器在知道您的函数*addBlogLink*存在之前解析您的 HTML 标记*INPUT 。*

 *我应该尝试一些不那么突兀的东西。像这样：

```
<input type="button" id="myID" class = "btn btn-warning" name = "submit" value="Submit Taste Tag"> 
```

并在 JS 中附加事件：

```
function addBlogLink(userID, beerID ){
   // Your code here
}
document.getElementById("myID").onclick = addBlogLink; 
```

将 SCRIPT 标签放在 </BODY> 标签之前

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T20:08:37.513

我犯了一个愚蠢的错误。我把：

```
<script src=\"addBlog.js\"></script> 
```

在错误的页面。我忘了我的花哨的盒子不是用我的页面 php 类构建的 iframe*

# stored-procedures - 无法在类上创建 IEnumerable

> ID：15820169
> 
> 赞同：-2
> 
> 时间：2013-04-04T19:36:24.423
> 
> 标签：stored-procedures, asp.net-mvc-4

我正在尝试在 MVC 中使用以下代码，这是我到目前为止所做的：

```
public class MoviesModel
{
    public int Id { get; set; }
    public string MovieName { get; set; }
    public string Actor { get; set; }
    public int Year { get; set; }
} 
```

控制器

```
public MoviesModel Index()
    {
        MoviesModel myModel;
        string connectionString =
            "";
        SqlConnection con = new SqlConnection(connectionString);
        SqlCommand com = con.CreateCommand();

        com.CommandText = "SELECT [ID] ,[MovieName] ,[Actor] ,[Year] FROM [dbo].[Movies]";
        con.Open();
        using (SqlDataReader reader = com.ExecuteReader())
        {
            while (reader.Read())
            {
                myModel = new MoviesModel
                {
                    myModel.Id = Convert.ToInt32(reader[0]),
                    myModel.MovieName = reader[1].ToString(),
                    myModel.Actor = reader[2].ToString(),
                    myModel.Year = Convert.ToInt32(reader[3])
                };
            }
        }

         con.Close();
        return myModel;
    } 
```

但我得到以下错误

```
cannot initialize class with a collection because it does not implement System.Collection.IEnumerable 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T19:55:57.027

> 你得到的编译错误带有一个文件名和一个行号，我保证这些东西没有指向你引用的任何代码。

实际上，我收回了这一点。我认为这可能是您的编译错误的根源（告诉我们编译器抱怨的那一行会有所帮助）。

```
myModel = new MoviesModel
{
    myModel.Id = Convert.ToInt32(reader[0]),
    myModel.MovieName = reader[1].ToString(),
    myModel.Actor = reader[2].ToString(),
    myModel.Year = Convert.ToInt32(reader[3])
}; 
```

这不是正确的语法。大括号内是为了初始化而运行的代码`myModel`——你不能`myModel`在括号内引用，因为直到括号内的代码完成执行后它才存在。幸运的是，您不需要这样做，因为这是设置这些属性的语法：

```
myModel = new MoviesModel
{
    Id = Convert.ToInt32(reader[0]),
    MovieName = reader[1].ToString(),
    Actor = reader[2].ToString(),
    Year = Convert.ToInt32(reader[3])
}; 
```

更广泛地说，我会冒昧地猜测您真正想要做的是返回一组 MoviesModel 对象，而不是返回恰好是结果集中最后一部电影的单个 MoviesModel 对象。执行此操作的代码如下所示：

```
public ActionResult Index()
{
    var models = new List<MoviesModel>();
    string connectionString = "";
    using (var con = new SqlConnection(connectionString))
    using (var com = con.CreateCommand())
    {
        com.CommandText = "SELECT [ID] ,[MovieName] ,[Actor] ,[Year] FROM [dbo].[Movies]";
        con.Open();
        using (var reader = com.ExecuteReader())
        {
            while (reader.Read())
            {
                var myModel = new MoviesModel
                {
                    Id = reader.GetInt32(0),
                    MovieName = reader.GetString(1),
                    Actor = reader.GetString(2),
                    Year = reader.GetInt32(3)
                };

                models.Add(myModel);
            }
        }
    }

    return View(models);
} 
```

顺便说一句`Convert.ToInt32`，在数据库和阅读器中获取已经是整数的东西是一种非常低效的方法。该`GetInt32`方法将执行得更好。

# java - JFrame 显示一个巨大的白框

> ID：15820177
> 
> 赞同：1
> 
> 时间：2013-04-04T19:37:00.677
> 
> 标签：java, swing, nullpointerexception, jpanel, border-layout

我一直在为一个项目开发 GUI，到目前为止，我似乎根本无法让 JFrame 出现。这是我的代码。

```
package code;
import java.awt.*;
import java.awt.event.*;
import javax.swing.*;

public class GUI extends JFrame {
    private JPanel ui, board, u1, u2, game, main;
    private JTextField console;
    private int x, y;

    public GUI (Controller c) {
        setSize(new Dimension(900,710));
        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

        //console.setText("Hello, and welcome to the game of Lotus!");
        main = new JPanel(new BorderLayout());
        game = new JPanel(new BorderLayout());
        board = new BoardPanel(c);
        ui = new JPanel (new GridLayout(1,2));;
        u1 = new JPanel (new FlowLayout());
        u2 = new StackPanel(c);
        board = new JPanel();

        createAndShowGUI();
        add(main);
        setVisible(true);
    }

    public GUI () {
        setSize(new Dimension(900,710));
        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

        //console.setText("Hello, and welcome to the game of Lotus!");
        main = new JPanel(new BorderLayout());
        game = new JPanel(new BorderLayout());
        board = new BoardPanel();
        ui = new JPanel (new GridLayout(1,2));;
        u1 = new JPanel (new FlowLayout());
        u2 = new StackPanel();
        board = new JPanel();

        createAndShowGUI();
        add(main);
        setVisible(true);
        printToConsole("Yes, it's working!");
    }

    public void createAndShowGUI() {
        //add components to ui
        u1.setSize(200,300);
        u2.setSize(200,400);
        ui.add(u1);
        ui.add(u2);

        //add components to game
        board.setSize(700,700);
        ui.setSize(200,700);
        game.add(board, BorderLayout.CENTER);
        game.add(ui, BorderLayout.EAST);

        //add main frame components to gui
        main.add(game, BorderLayout.CENTER);
        main.add(console, BorderLayout.SOUTH);
    }

    public void update () {
        repaint();
    }

    public void printToConsole (String s) {
        console.setText(s);
    }

} 
```

每当我运行它时，我都会收到 NullPointerException

> main.add（控制台，BorderLayout.SOUTH）；

如果我注释掉那行，它运行时没有错误，但显示的只是一个巨大的空白白框。

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T19:40:56.380

您尚未初始化`console`正在抛出 NullPointerException

```
 console = new JTextField("Some Name"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T19:42:22.180

`console`没有在任何地方实例化。除了你所拥有的一切都是`JPanel`s，所以没有什么可以显示的，因为`JPanel`它本身并不能提供太多的视觉反馈。

# javascript - 显示加载了哪些脚本

> ID：15820184
> 
> 赞同：-1
> 
> 时间：2013-04-04T19:37:30.963
> 
> 标签：javascript

我怀疑有些用户有工具栏、插件、恶意软件或其他东西，当他们访问我们的网站时，它们会在他们的浏览器中运行一些 javascript，而这些 javascript 会破坏我们页面上的功能。

我的 javascript 可以查看已从其他文件（即 http://some.site/script.js'> 加载的 javascript 吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T20:09:48.797

你的问题很有趣，但动机是错误的，IMO。是什么让你相信“某事”正在搞乱你的 JavaScript？你能重现这个问题吗？即使某种小书签正在破坏全局 JavaScript 代码，您（作为开发人员）也有能力检查正确的功能并在需要时进行 polyfill。

如果您更仔细地查看您的代码以及为什么它没有按照您的预期执行，我希望您会发现恶意软件/工具栏/插件不是罪魁祸首。

隔离失败的代码并重现该行为。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T19:38:44.200

在浏览器上打开开发者工具（通常使用 F12）。然后检查网络部分/选项卡，它将列出加载到当前文档中的所有资源。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-04T19:57:18.733

如果您想查找页面加载的脚本并且您无法访问开发工具，您可以在 DOM 中搜索脚本标签。这只会找到由 DOM 加载的脚本（这是非常典型的）。但它不会找到通过 xhr 请求加载然后 eval-ed 的脚本，也不会找到浏览器扩展加载的脚本。

但是，这仍然可能对您有所帮助。你可以这样做：

```
console.log(window.document.getElementsByTagName("script")) 
```

这会将所有加载的脚本记录到控制台。或者，您可以在客户端中对此进行分析，并在您看到可疑内容时弹出一条明亮的大警告消息。

要捕获其他类型的请求，您可以在 xhr send 方法中添加一个包装器，如下所示：

```
XMLHttpRequest.prototype.send = function () {
  // do some checking of the request
  // do the actual request
  this.send();
} 
```

我还没有尝试过，所以可能会有一些警告，比如我不确定是否所有浏览器引擎都允许你重新定义内置类型的方法。但值得一试。

# maven - 让所有这些工作：War、OSGI、Spring Beans、Maven

> ID：15820185
> 
> 赞同：1
> 
> 时间：2013-04-04T19:37:31.417
> 
> 标签：maven, war, fuseesb, jbossfuse

尝试在 Fuse Servicemix（版本 4.3.1）中使用 bean 文件部署战争。我正在使用 Maven 来构建我的战争。我似乎无法让它工作。谁能提供一个可以告诉我如何做到这一点的网站？

这个网站告诉我在 web.xml 文件中放什么，但没有解释其余的。

[http://fusesource.com/docs/esbent/7.0/esb_deploy_osgi/BuildWar-Spring.html](http://fusesource.com/docs/esbent/7.0/esb_deploy_osgi/BuildWar-Spring.html)。

在 19 天的时间里，我尝试了几种解决方案和方法。每个人似乎对这只猫的皮肤都不一样，但它们都不适合我。

**脂肪战争（已解决）**：

请看下面的答案

* * *

**瘦身战**：

在osgi中似乎是不可能的。需要手动导入太多包。这个链接似乎可以解决它，但似乎有很多讨厌的副作用。

[http://davidvaleri.wordpress.com/2011/08/17/deploying-spring-mvc-based-web-applications-to-osgi-using-apache-servicemix/](http://davidvaleri.wordpress.com/2011/08/17/deploying-spring-mvc-based-web-applications-to-osgi-using-apache-servicemix/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T10:13:56.400

您需要将 Spring OSGi ContextLoaderListener 添加到您的 web.xml 中，否则它不起作用。您还需要 Spring-DM 1.2.1 的依赖项。查看[Pax Web Spring 示例](https://github.com/ops4j/org.ops4j.pax.web/tree/master/samples/war-spring)，尤其是其中的 web.xml。这是一个关于如何在 Karaf / Fuse-ServiceMix 中使用 Spring 的工作示例......

我想我给你指出了错误的样本。您不需要使用以下内容。

contextClass
org.springframework.osgi.web.context.support.OsgiBundleXmlWebApplicationContext

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T01:50:21.657

脂肪战争解决方案

这是对我有用的最小可行解决方案。我试图删除一些东西，但它很快就坏了，通常甚至没有发布错误消息。

* * *

目录结构：

```
src/main/java/test/Test.java
src/main/webapp/WEB-INF/web.xml
src/main/webapp/WEB-INF/applicationContext.xml 
```

pom.xml

```
...
    <groupId>test</groupId>
    <artifactId>war-bean-test</artifactId>
    <packaging>war</packaging>

    <dependencies>
        <dependency>
          <groupId>org.springframework</groupId>
          <artifactId>spring-web</artifactId>
          <version>3.0.5.RELEASE</version>
        </dependency>
        <dependency>
          <groupId>org.springframework.osgi</groupId>
          <artifactId>spring-osgi-web</artifactId>
          <version>1.2.0</version>
        </dependency>
    </dependencies>

    <build>
        <plugins>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-compiler-plugin</artifactId>
            </plugin>
            <plugin>
                <groupId>org.apache.felix</groupId>
                <artifactId>maven-bundle-plugin</artifactId>
                <version>2.3.7</version>
                <executions>
                  <execution>
                    <id>bundle-manifest</id>
                    <phase>process-classes</phase>
                    <goals>
                      <goal>manifest</goal>
                    </goals>
                  </execution>
                </executions>
                <configuration>
                  <supportedProjectTypes>
                    <supportedProjectType>jar</supportedProjectType>
                    <supportedProjectType>bundle</supportedProjectType>
                    <supportedProjectType>war</supportedProjectType>
                  </supportedProjectTypes>
                  <instructions>
                    <Bundle-SymbolicName>${project.groupId}.${project.artifactId}</Bundle-SymbolicName>
                    <Bundle-Version>${project.version}</Bundle-Version>

                    <!-- IMPORTANT resolution:=optional fixes bug where bundle fails to load unnecessary packages such as bsh. You also need javax.servlet. In Servicemix 4.3.1 it is provided by geronimo servlet. -->
                    <Import-Package>
                        javax.servlet
                        *; resolution:=optional
                    </Import-Package>
                    <Export-Package></Export-Package>

                    <!-- IMPORTANT explicitly adding the jars fixes the numerous CassNotFoundExceptions -->
                    <Bundle-ClassPath>
                        .,WEB-INF/classes,{maven-dependencies}
                    </Bundle-ClassPath>
                    <Web-ContextPath>warbeantest</Web-ContextPath>
                    <Webapp-Context>warbeantest</Webapp-Context>

                    <!-- adding inline=true to Embed-Dependency causes {maven-dependencies} to not work and you will have to add every jar by hand -->
                    <Embed-Dependency>*;scope=compile|runtime</Embed-Dependency>
                    <Embed-Transitive>true</Embed-Transitive>
                    <Embed-Directory>WEB-INF/lib</Embed-Directory>
                  </instructions>
                </configuration>
              </plugin>

              <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-war-plugin</artifactId>
                <version>2.3</version>
                <configuration>
                  <archive>
                    <manifestFile>${project.build.outputDirectory}/META-INF/MANIFEST.MF</manifestFile>
                  </archive>
                </configuration>
              </plugin>
        </plugins>
    </build>
</project> 
```

web.xml 文件：

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app version="2.4" xmlns="http://java.sun.com/xml/ns/j2ee">
    <display-name>war-bean-test</display-name>
    <description>war-bean-test</description>

    <context-param>
        <param-name>contextConfigLocation</param-name>
        <param-value>/WEB-INF/applicationContext.xml</param-value>
    </context-param>

    <!-- If you remove this then the spring beans will still work, but you wont be able to fetch services and resources from other osgi bundles -->
    <context-param>
        <param-name>contextClass</param-name>
        <param-value>org.springframework.osgi.web.context.support.OsgiBundleXmlWebApplicationContext</param-value>
    </context-param>

    <listener>
        <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
    </listener>
</web-app> 
```

应用程序上下文.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="
        http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd">

    <bean id="test" class="test.Test">
        <property name="value" value="1" />
    </bean>
</beans> 
```

测试.java

```
package test;
public class Test {
    private int value = 0;
    public TestImpl() { }

    public void setValue(int value) {
        // Should print to console when you load into Fuse Servicemix
        System.out.println("testing...");
        this.value = value;
    }

    public int getValue() { return value; }
} 
```

# java - 在 Android 中阻止成人网站

> ID：15820191
> 
> 赞同：-3
> 
> 时间：2013-04-04T19:37:43.293
> 
> 标签：java, android, logging, traffic

我想监控 Android 日志中的成人 IP 地址列表（我已经有一个常见成人网站列表） 有没有人看过如何监控特定 IP 流量的日志的示例？我已经在 Google 和 StackOverflow 上搜索了有关如何做到这一点的信息 - 但没有找到太多信息。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T19:43:46.300

这不是正确的做法——很多服务器是共享的。一个 IP 地址可以托管十几个网站，其中只有一个可能是成人网站。

如果这种应用程序无需生根就可以实现，我也会感到非常惊讶 - 允许一个应用程序从另一个应用程序嗅探 IP 将是一个严重的隐私问题。据我所知，绝对没有全球网络连接日志，而且谷歌非常小心地防止应用程序以这种方式相互交互。

# javascript - 如何检查匿名函数中的变量？

> ID：15820197
> 
> 赞同：3
> 
> 时间：2013-04-04T19:37:55.293
> 
> 标签：javascript, google-chrome

假设我有一个看起来像这样的代码块......

```
$(function(){
    var Foo = "Thing";
    var Bar = "Other Thing";
    var Bag = new Widget({name: "Some Thing", color: "Purple"});
}); 
```

有没有办法在 Chrome 控制台中检查或检索这些变量/对象？我想我可能试图将 Chrome 控制台用作 REPL，但我很好奇它是否可能。

-**编辑**：对不起，我应该包含更多信息。我知道我可以添加断点或包含调试器调用。在一切运行完成*后*，我对查看变量/对象更感兴趣。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T19:44:58.677

我认为这是不可能的，因为这些变量是匿名函数的本地变量。

您可以暂时执行以下操作来检查函数内的值：

```
var Foo;    

$(function(){
    Foo = "Thing";
    var Bar = "Other Thing";
    var Bag = new Widget({name: "Some Thing", color: "Purple});
}); 
```

从这里您可以访问`Foo`并查看里面的值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T19:50:39.340

变量的作用域是函数，这意味着它们*不能*在函数外部访问，除非它们被显式传递出去。以下是我能想到的一些选项：

1.  您可以在外部范围内声明同名变量，例如`window`. 小心，因为如果在其他函数中使用这些变量名，它们现在都将使用相同的“全局”副本，并且一切都可能中断。

2.  您可以在匿名函数的最终返回之前添加“变量收集器”语句：

    ```
    var collector = [];

    $(function () {
       var Foo = "Thing",
          Bar = "Other Thing",
          Bag = new Widget({name: "Some Thing", color: "Purple"});
       collector.push({"anonymousfunction1": {Foo: Foo, Bar: Bar, Bag: Bag}});
       return something;
    }); 
    ```

    然后在执行结束时，您可以随意检查`collector`变量中的所有内容。我创建了`collector`一个数组，因为我认为您可能有多个想要了解的匿名函数，或者该函数可以被多次调用（尽管它在我看来就像一个 jQuery`ready`事件，但您永远不知道）。

3.  只需将值记录到控制台。这适用于 Chrome 和 Firefox（按 F12），并且可能适用于更高版本的 IE：

    ```
    $(function () {
       var Foo = "Thing",
          Bar = "Other Thing",
          Bag = new Widget({name: "Some Thing", color: "Purple"});
       console.log("Foo", Foo, "Bar", Bar, "Bag", Bag);
       return something;
    }); 
    ```

# ios - 如何在 Google 地图 ios 中标记地图标记

> ID：15820199
> 
> 赞同：5
> 
> 时间：2013-04-04T19:38:02.083
> 
> 标签：ios, objective-c, google-maps, google-maps-markers, google-maps-sdk-ios

我在地图上有几个标记，它们每个都代表具有不同主题的路径。我希望用户能够在选择标记之前看到每个主题，因此我计划在每个主题上方添加一个简单的文本标签。这似乎不是 ios 谷歌地图中的嵌入式功能。有没有办法解决？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-04-04T19:47:57.377

设置 a `UILabel`，设置它，将其渲染为 a`UIImage`并将其设置为标记的图标。

```
//setup label
UILabel *label = [[UILabel alloc] initWithFrame:CGRectMake(0, 0, 50, 20)];
label.text = @"test";
label.backgroundColor = [[UIColor redColor] colorWithAlphaComponent:0.5];

//grab it
UIGraphicsBeginImageContextWithOptions(label.bounds.size, NO, [[UIScreen mainScreen] scale]);
[label.layer renderInContext:UIGraphicsGetCurrentContext()];
UIImage * icon = UIGraphicsGetImageFromCurrentImageContext();
UIGraphicsEndImageContext();

//prepare options
GMSMarkerOptions *options = [GMSMarkerOptions options];
options.position = CLLocationCoordinate2DMake(latitude, longitude);
options.title = [NSString stringWithFormat:@"#%d", count_];
options.icon = icon; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-03-04T22:50:48.367

我是 swift 的初学者，但我能够转换 Daij-Djan 的答案：

```
let label = UILabel()
label.frame = CGRect(x:0, y:0, width: 50, height: 20)
label.text = "test"
label.backgroundColor = UIColor.redColor().colorWithAlphaComponent(0.5)
label.textColor = UIColor.whiteColor()
label.adjustsFontSizeToFitWidth = true
UIGraphicsBeginImageContextWithOptions(label.frame.size, false, UIScreen.mainScreen().scale)
if let currentContext = UIGraphicsGetCurrentContext()
{
    label.layer.renderInContext(currentContext)
    let imageMarker = UIImage()
    imageMarker = UIGraphicsGetImageFromCurrentImageContext()
    let marker = GMSMarker(position: CLLocationCoordinate2DMake(lat, long))
    marker.icon = imageMarker
    marker.map = mapView
}
UIGraphicsEndImageContext() 
```

# php - 无法使用 curl 登录

> ID：15820203
> 
> 赞同：0
> 
> 时间：2013-04-04T19:38:09.463
> 
> 标签：php, curl, login, hidden, field

我有一个关于 curl 的问题，我到处搜索并尝试了很多东西，但我无法登录。我尝试登录到一个页面。我认为它与隐藏字段有关，隐藏字段不是随机生成的。

我熟悉php的基础知识，但不是专家。如果你对这个问题发表评论，你可以写一些评论吗，我真的很想学习！

这是我的代码：

```
<?php
$url = 'see url above';
$username = 'username';
$password = 'password';

$ch = curl_init();
curl_setopt($ch, CURLOPT_URL, $url);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
curl_setopt($ch, CURLOPT_USERPWD, "$username:$password");
curl_setopt($ch, CURLOPT_HTTPAUTH, CURLAUTH_BASIC);
curl_setopt($ch, CURLOPT_FOLLOWLOCATION, true);
$output = curl_exec($ch);
$info = curl_getinfo($ch);
curl_close($ch);

echo '<pre>',print_r($info),'</pre>';

?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T21:05:35.923

您应该通过查看返回的 cookie 来验证您是否已登录。无论您是否输入虚假信息，该应用程序似乎总是返回 HTTP 代码 200。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T19:11:14.753

实际上，您不需要基本身份验证。
正如我所看到的，页面中有简单的表单和隐藏的变量。尝试通过 POST 发送它们。

像这样的东西：

```
$url =  'http://www.cibap.nl/index.php';
$username = 'username';
$password = 'password';

$post_data = array(
'ACT'       => '9',
'RET'       => '/login',
'site_id'   => '1',
'username'  => $username,
'password'  => $password,
'autologin' => '1'  
);

$ch = curl_init($url);

$postargs = http_build_query($post_data);
curl_setopt ($ch, CURLOPT_POST, true);
curl_setopt ($ch, CURLOPT_POSTFIELDS, $postargs);

//Use cookie file if needed (probably needed)
//$cookiefile = '/path/to/cookie.txt'; 
//any filename, curl stores and reads this file next time
//curl_setopt($ch, CURLOPT_COOKIEJAR, $cookiefile); 

//curl_setopt($ch, CURLOPT_HEADER, true); 
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
curl_setopt($ch, CURLOPT_FOLLOWLOCATION, true);

$output = curl_exec($ch);   
curl_close($ch);

echo '<pre>',print_r($output),'</pre>'; 
```

# ios - 阴影不显示在 drawRect:(CGrect)rect,objective

> ID：15820205
> 
> 赞同：2
> 
> 时间：2013-04-04T19:38:18.653
> 
> 标签：ios, objective-c, core-graphics, drawrect

我的目标是 1\. 为我的视图添加渐变（完成） 2\. 为我的视图底部边缘添加阴影（问题在这里） 我正在做的是：

```
- (void)drawRect:(CGRect)rect {
    CGContextRef context = UIGraphicsGetCurrentContext();

    UIColor *whiteColor         =   [UIColor colorWithRed:1.0 green:1.0 blue:1.0 alpha:1.0];
    UIColor *lightGrayColor     =   [UIColor colorWithRed:230.0/255.0 green:230.0/255.0 blue:230.0/255.0 alpha:1.0];

    CGRect paperRect            =   self.bounds;

    // Fill with gradient
    [self drawLinearGradient:context for:paperRect start:whiteColor.CGColor end:lightGrayColor.CGColor];

    CGContextSetStrokeColorWithColor(context, [UIColor lightGrayColor].CGColor);
    CGContextSetLineWidth(context, .9);
    CGContextStrokeRect(context, paperRect);

    // Add shadow
    CGContextSetShadowWithColor(context, CGSizeMake(0, self.frame.size.height), 9.0, [UIColor blueColor].CGColor);

}
-(void)drawLinearGradient:(CGContextRef)context for:(CGRect)rect start:(CGColorRef)startColor end:(CGColorRef)endColor {
    CGColorSpaceRef colorSpace  =   CGColorSpaceCreateDeviceRGB();
    CGFloat locations[]         =   { 0.0, 1.0 };

    NSArray *colors             =   [NSArray arrayWithObjects:(__bridge id)startColor, (__bridge id)endColor, nil];

    CGGradientRef gradient      =   CGGradientCreateWithColors(colorSpace, (__bridge CFArrayRef) colors, locations);

    CGPoint startPoint          =   CGPointMake(CGRectGetMidX(rect), CGRectGetMinY(rect));
    CGPoint endPoint            =   CGPointMake(CGRectGetMidX(rect), CGRectGetMaxY(rect));

    CGContextSaveGState(context);
    CGContextAddRect(context, rect);
    CGContextClip(context);
    CGContextDrawLinearGradient(context, gradient, startPoint, endPoint, 0);
    CGContextRestoreGState(context);

    CGGradientRelease(gradient);
    CGColorSpaceRelease(colorSpace);

} 
```

但是，我得到的是下面没有阴影的图片

我是否在正确的轨道上，但在中间错过了什么？如果您有任何想法，请帮助.. ![在此处输入图像描述](https://i.stack.imgur.com/5idu6.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T20:11:52.840

您需要在绘制任何应该有阴影的东西*之前设置阴影属性。*在调用 to`CGContextSetShadowWithColor`之前先调用 to `CGContextStrokeRect`。

此外，偏移量可能不应该像你做的那么大。阴影偏移控制阴影与使用该阴影绘制的像素的偏移量，因此除非您希望阴影实际开始时离您的矩形很远，否则您可能只需要一个像素左右的偏移量，例如`CGSizeMake(0.0, 1.0)`.

# powershell - 函数参数变成数组

> ID：15820208
> 
> 赞同：0
> 
> 时间：2013-04-04T19:38:26.980
> 
> 标签：powershell

我有一个简单的 PowerShell 函数

```
function Foo($a, $b){
  '$a = ' + $a
  '$b = ' + $b
} 
```

我通过调用来调用它

```
Foo("dogs", "cat"); 
```

到目前为止我读过的所有内容都表明预期的输出是

```
$a = dogs
$b = cats 
```

我实际看到的是：

```
$a = dogs cat
$b = 
```

如果我将我的函数重写为：

```
function Foo($a, $b){
  '$a is ' + $a.GetType().Name;
  '$b = ' + $b.GetType().Name;
} 
```

输出是：

```
$a is Object[]
You cannot call a method on a null-valued expression.
At C:\WCMTeam\Percussion\Notifier\foo.ps1:4 char:7
+       '$b = ' + $b.GetType().Name;
+       ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : InvalidOperation: (:) [], RuntimeException
    + FullyQualifiedErrorId : InvokeMethodOnNull 
```

显然 $a 和 $b 被组合成一个数组。我在做什么来导致这种情况，我应该如何改变它以获得我的预期结果？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-04T19:42:30.623

你应该使用调用你的函数

```
Foo "dogs" "cats" 
```

`,`用于在 Powershell 中分隔数组元素，所以

```
Foo "dogs", "cats" 
```

`Foo`使用单个数组参数调用，该参数分配给`$a`.

# ipad - 如何在 Ipad/iPhone/iOS 中滚动包含 pdf 的 iframe？

> ID：15820210
> 
> 赞同：2
> 
> 时间：2013-04-04T19:38:35.700
> 
> 标签：ipad, iframe

我有一个使用媒体插件通过 iframe 嵌入的 pdf。当您在 ipad 上打开它时，iframe 不会拉伸以适应 pdf 的内容。

在这一点上，我只是在运行一个测试，看看我得到了什么。

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>Untitled Document</title>
<script type="text/javascript" src="./ipad_files/jquery-1.7.min.js"></script>
<script type="text/javascript" src="./ipad_files/media.js"></script>
    <style>
        iframe{width:550px; height:100%;}
        .media{width:630px !important; height:600px; overflow:scroll; -webkit-overflow-scrolling: touch;}
        *:not(html) {
            -webkit-transform: translate3d(0, 0, 0);
            }
    </style>
</head>
<body>
    <div style="width:650px; height:630px;">
        <a href="ipad_files/History-of-Cars.pdf" class="media">PDF LINK</a>
    </div>    
    <script type="text/javascript">
        $('.media').media();
    </script>
</body>
</html> 
```

在浏览器中呈现的是 iframe。

有什么想法可以滚动 iframe/包含 div 吗？我知道我无法滚动 iframe，但 iframe 没有扩展。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-30T10:52:14.087

我从来没有用过它，但也许[iScroll4](http://cubiq.org/iscroll-4)会解决你的问题......

# c# - 数组列表会话

> ID：15820212
> 
> 赞同：0
> 
> 时间：2013-04-04T19:38:38.277
> 
> 标签：c#, asp.net, arrays, session, arraylist

我有一个针对每种音乐类型形成的数组列表，例如我将展示乡村音乐：

```
public class CountryItemList
{
    ArrayList CountryItems = new ArrayList();

    protected void CountryBuy1_Click(object sender, ImageClickEventArgs e)
    {
        CountryItems.Add("Johnny Cash - I Walk The Line - $9");
    }
    protected void CountryBuy2_Click(object sender, ImageClickEventArgs e)
    {
        CountryItems.Add("Carrie Underwood - Blown Away - $9");
    }
    protected void CountryBuy3_Click(object sender, ImageClickEventArgs e)
    {
        CountryItems.Add("Keith Urban - The Story So Far - $9");
    }

    protected void CountryBuy5_Click(object sender, ImageClickEventArgs e)
    {
        CountryItems.Add("Taylor Swift - Red - $11");
    }
    protected void CountryBuy6_Click(object sender, ImageClickEventArgs e)
    {
        CountryItems.Add("Willie Nelson - Legend - $9");
    }

} 
```

}

对于单击的每个购买按钮，所选专辑将添加到数组列表中，从那时起，我希望将数组列表带入会话并将其带到“购物车页面”上的列表框中。我在获取数组列表并将其设置为会话以延续到下一页时遇到问题

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T19:49:10.993

你只需要使用 Session[] 来进行。

我会使用 List 而不是 ArrayList。

尝试类似：

```
private List<string> _countryItems;
        public List<string> CountryItems {
            get {
                if (_countryItems == null) {
                    _countryItems = (List<string>)Session["CountryItems"];
                    if (_countryItems == null) {
                        _countryListItems = new List<string>();
                        Session["CountryItems"] = _countryItems;
                    }
                }
                return _countryItems;
            }
            set { _countryItems = value; }
        }

        protected void CountryBuy6_Click(object sender, ImageClickEventArgs e) {
            CountryItems.Add("Willie Nelson - Legend - $9");
        } 
```

这样您就可以直接从 Session 中引用 CountryListItems。如果它存在于会话中，您将从会话中获取值。如果没有，您将获得一个可以添加值的空列表。然后，这应该在您添加元素时将任何更新提交到会话。

此外，请查看使用 CommandEventArgs，它允许您创建从多个位置调用的单击事件，然后您将能够在 e 上发送单个评论事件 args 并直接从标记中获取值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T20:22:28.480

我一直不太热衷于将 Session 用于此类事情。我发现它不像使用数据库表那样可靠，尤其是对于像购物车这样的东西。

如果您需要重新启动应用程序池，如果您将其存储在 Session 中，任何当前用户都会丢失他们的选择。您也不应该假设将某些内容放入 Session 中是立即可用的。

您应该考虑将这些内容存储在数据库表中。您可以在每个用户第一次向购物车添加东西时为他们分配一个 GUID，并在每首歌曲的产品 ID 之外使用它。将该 GUID 放入 cookie 中，这样如果他们稍后回来，他们的购物车仍然是满的。如果您不想使用 cookie，也可以使用他们的 SessionID，或者在他们关闭窗口时关心他们的购物车是否为空。

如果你想继续使用 Session，这样的事情就可以了

```
 protected List<string> SelectedSongs
    {
        get
        {
            List<string> li = new List<string>();

            if (Session["SelectedSongs"] != null)
            {
                try
                {
                    return (List<string>)Session["SelectedSongs"];
                }
                catch (Exception e)
                {
                    return li; // Something went wrong?  Return the empty list.
                }
            }
            else
            {
                return li;
            }
        }
        set
        {
            Session["SelectedSongs"] = value;
        }
    } 
```

要将它们添加到列表中，您可以只使用一个事件处理程序来稍微清理一下您的代码。像这样的东西

```
protected void AddToCart(object sender, CommandEventArgs e)
{
     List<string> li = SelectedSongs;
     li.Add(e.CommandArgument )
     SelectedSongs = li;    
}

<asp:Button id="btnAddToCart"  Text="Add Song" CommandArgument="Johnny Cash - I Walk The Line - $9" CommandName="AddToCart" runat="server"/>

<asp:Button id="btnAddToCart"  Text="Add Song" CommandArgument="Carrie Underwood - Blown Away - $9" CommandName="AddToCart" runat="server"/> 
```

其他歌曲以此类推。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-04T20:12:09.890

我认为这不会获得最佳购物卡奖，但它会完成这项工作。

它基本上将选定的项目存储到 Session 中，以便您可以在下一页检索它。

注意：[ArrayList 已弃用](https://stackoverflow.com/a/2309699/296861)，因此请使用通用列表。

![在此处输入图像描述](https://i.stack.imgur.com/QMEhU.png)

```
<%@ Page Language="C#" AutoEventWireup="true" CodeBehind="CountryItemList.aspx.cs"
    Inherits="WebApplication2010.CountryItemList" %>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <title></title>
</head>
<body>
    <form id="form1" runat="server">
    <div>
        <asp:Button runat="server" ID="Button1" OnCommand="Button_Command" 
        CommandName="Johnny Cash - I Walk The Line - $9"
            Text="Johnny Cash - I Walk The Line - $9" /><br/>
        <asp:Button runat="server" ID="Button2" OnCommand="Button_Command" 
        CommandName="Carrie Underwood - Blown Away - $9"
            Text="Carrie Underwood - Blown Away - $9" /><br/>
        <asp:Button runat="server" ID="Button3" OnCommand="Button_Command" 
        CommandName="Keith Urban - The Story So Far - $9"
            Text="Keith Urban - The Story So Far - $9" /><br/>
        <asp:Button runat="server" ID="Button4" OnCommand="Button_Command" 
        CommandName="Taylor Swift - Red - $11"
            Text="Taylor Swift - Red - $11" /><br/>
        <asp:Button runat="server" ID="Button5" OnCommand="Button_Command" 
        CommandName="Willie Nelson - Legend - $9"
            Text="Willie Nelson - Legend - $9" />
    </div>
    </form>
</body>
</html>

public partial class CountryItemList : System.Web.UI.Page
{
    public List<string> CountryItems
    {
        get { return Session["CountryItems"] as List<string> ?? new List<string>(); }
        set { Session["CountryItems"] = value; }
    }

    protected void Button_Command(object sender, CommandEventArgs e)
    {
        var items = CountryItems;
        items.Add(e.CommandName);
        CountryItems = items;
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-08-07T07:22:46.127

试试这个

第 1 页：

```
protected void Page_Load(object sender, EventArgs e)
{
    //Creating Session
    ArrayList idList = new ArrayList();
    idList.Add("1");
    idList.Add("2");
    idList.Add("3");
    Session["idArrayList"] = idList;
} 
```

第2页：

```
protected void Page_Load(object sender, EventArgs e)
{
    //Retrieving
    ArrayList idList = (ArrayList)Session["idArrayList"];
    string id1 = idList[0].ToString() ;
    string id2 = idList[1].ToString();
    string id3 = idList[2].ToString(); 
} 
```

来源：[http ://forums.asp.net/t/1425975.aspx?C+How+to+place+an+arraylist+inside+a+Session+Variable+and+Iterate+through+it](http://forums.asp.net/t/1425975.aspx?C+How+to+place+an+arraylist+inside+a+Session+Variable+and+Iterate+through+it)

# android - AndEngine - 精灵不会在不同的设备上缩放

> ID：15820219
> 
> 赞同：2
> 
> 时间：2013-04-04T19:38:56.140
> 
> 标签：android, andengine, resolution, android-resolution

代码 ：

这就是我初始化相机的方式。
我'，试图获得设备的分辨率，并在此基础上设置相机的宽度和高度。

```
 public class GameActivity extends SimpleBaseGameActivity {

        private SmoothCamera mCamera;
        private DisplayMetrics dM; 

        private int CAMERA_WIDTH, CAMERA_HEIGHT;

        private double  ScreenWidth,
                        ScreenHeight,
                        resolutionRatio;

        public EngineOptions onCreateEngineOptions() {

             //set Camera
            getDeviceResolution();
            setCamera();

        EngineOptions options =  new EngineOptions(true,
            ScreenOrientation.LANDSCAPE_FIXED, 
            new RatioResolutionPolicy((int)this.getCameraWidth(),(int)this.getCameraHeight()),
            //new FillResolutionPolicy(),
            mCamera);
          return options;

        }

      private void getDeviceResolution() {
            dM = new DisplayMetrics();
            this.getWindowManager().getDefaultDisplay().getMetrics(dM);
            this.ScreenWidth    = dM.widthPixels;
            this.ScreenHeight   = dM.heightPixels;
            this.resolutionRatio = this.ScreenWidth/this.ScreenHeight;

                resolutionRatio = (double)Math.round(resolutionRatio * 100) / 100;

            Log.d("Resolution","ScrennWidth: "+this.ScreenWidth );
            Log.d("Resolution","ScrennHeight: "+this.ScreenHeight );
                    Log.d("Resolution","Resolution Ratio: " +   this.resolutionRatio );
        }

    private void setCamera() {

        if(resolutionRatio == 1.66){
            this.setCameraHeight(340);
            this.setCameraWidth(400);
        }else if(resolutionRatio == 2.13){
            this.setCameraHeight(480);
            this.setCameraWidth(1024);
        }else if(resolutionRatio == 1.77){
            this.setCameraHeight(720);
            this.setCameraWidth(1280);
        }else if(resolutionRatio == 1.5){
            this.setCameraHeight(320);
            this.setCameraWidth(480);
        }else if(resolutionRatio == 1.67){
            this.setCameraHeight(480);
            this.setCameraWidth(800);
        }else {
            this.setCameraHeight((int) this.ScreenHeight);
            this.setCameraWidth((int) this.ScreenWidth);
        }

        // Create a Camera
        this.mCamera = new SmoothCamera(0,0,(int)getCameraWidth(),(int)getCameraHeight(),100,100,1.0f);
            mCamera.setZoomFactor(1.0f);

            mCamera.setBoundsEnabled(true);
            mCamera.setBounds(0, 0, mCamera.getWidth(), mCamera.getHeight());   
        }

        } 
```

问题是。

我已经在分辨率为 480x320 的设备上尝试过游戏； ![在此处输入图像描述](https://i.stack.imgur.com/CW09k.png)

当我在分辨率为 800X480 的设备上尝试相同的代码时![在此处输入图像描述](https://i.stack.imgur.com/4XWBt.png)

我认为精灵没有在更高分辨率的设备上缩放。
据我所知，引擎可以原生缩放相机和精灵。

那么为什么精灵在这种情况下没有得到缩放呢？

我应该怎么做才能根据分辨率放大精灵？

我也试过 FillResolutionPolicy。一样。

我正在使用 andengine 和 SpriteSheets 的 TexturePackerExtension。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-09T06:43:04.820

你想要一个`Camera`固定的`width`和一个`height`由设备屏幕纵横比计算的。将其与 a 配对，`FillResolutionPolicy`您将得到您想要的。

笔记：

> AndEngine 不会为您*缩放* `Sprites`，但您设置 以`Camera`使整体`Scene`显示为缩放。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-04T20:02:26.383

AndEngine 确实`Sprites`在您的示例中扩展了您的规模。结果不是您预期的原因是您设置了相机`width`并`height`手动（基于分辨率）。

如果您真的希望每个精灵在每个显示器上都以相同的方式缩放，那么您应该选择**一个**固定分辨率来创建您的游戏。例如，您可以将每个精灵和每个位置设置为 960x640 的分辨率。

```
 // skip the whole if(resolutionRatio == 1.66){..  part
this.mCamera = new SmoothCamera(0, 0, 960f, 640f, 100, 100, 1.0f); 
```

AndEngine 然后将缩放相机，使其尽可能多地填充显示。

```
 public EngineOptions onCreateEngineOptions() {
      EngineOptions options = new EngineOptions(true, ScreenOrientation.LANDSCAPE_SENSOR, new RatioResolutionPolicy(1.5f), camera;
      return options;
 } 
```

这`1.5f`是 960x640 分辨率的拟合纵横比。现在您不必再关心不同的显示尺寸了。

# asp.net-mvc-3 - 如何在表单中使用 MathJax？

> ID：15820221
> 
> 赞同：1
> 
> 时间：2013-04-04T19:39:00.783
> 
> 标签：asp.net-mvc-3, mathjax

我有一个表单中的文本框，我想使用 MathJax。我已经下载了它，但不知道如何使用它。我正在使用 ASP-MVC3。感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T10:07:15.783

我发现了问题。它只需要从 mathjax.org 加载 js 文件并将这些行添加到`head`标签中。

```
<script type="text/javascript">
    $(document).ready(function () {
        MathJax.Hub.Config({ TeX: { equationNumbers: { autoNumber: "all" } } });
    });
</script>
<script src="~/Scripts/MathJax.js?config=Tex-AMS_HTML"></script> 
```

现在它只需要以下面的形式添加字符`$$`和`\\`文本并将其附加到类似 div 的内容中。

```
jQuery("#radikal").on('click', function () {
    var x="$$\\sqrt[3]{8}$$";
    $("#formul").append(x);
});

<input type="button" id="radikal"/>
<div id="formul"></div> 
```

现在我们将在`div#radikal`. 就这样。

# c++ - 输出显示不为零

> ID：15820224
> 
> 赞同：1
> 
> 时间：2013-04-04T19:39:15.910
> 
> 标签：c++

仅供参考，我是 C++ 的初学者。这只是完整代码的一部分，问题是'student.id'，如果输入以'0'开头，例如'06042010'，输出显示不为零（在这种情况下是'6042010'！而关键是，我希望显示第一个零。谢谢。

```
#include<iostream>
using namespace std;

struct students
{
    char name[15];
    char surname[10];
    int id;

};

int main()
{
    students student;

cout<<"Name: ";
cin>>student.name;
cout<<"Surname: ";
cin>>student.surname;
cout<<"ID: ";
cin>>student.id;

cout<<"\nStudent: "<<student.name<<" "<<student.surname<<" ID "<<student.id<<endl;

return 0; 
```

}

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-04T19:40:17.727

如果需要保留前导零，则应存储`id`为字符串而不是`int`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T19:43:32.183

如果你的 ID 总是有特定的长度，你可以使用 C 的`printf`函数而不是流，这会给你更多的权力；

```
printf( "Student: %s %s ID %08d\n", student.name, student.surname, student.id ); 
```

这将始终打印 8 位 ID，并根据需要以 0 为前缀（如果只是`%8d`它，它将以空格为前缀）。

但正如已经指出的那样，您最好将其存储为字符串，因为这样您将来就可以增加 ID 的长度，而无需调整所有旧的 ID。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-04T20:14:21.947

如果您出于某种原因需要或想要保留学生证号码，您也可以使用以下方法：

```
#include <iomanip>

const int width = 8; //The length of your student ID numbers

cout << "\nStudent: " << student.name << " " <<student.surname
     << " ID " << setfill('0') << setw(width) << student.id << setfill(' ') << endl; 
```

如果您的 ID 号码长度不同，您将必须检测它们的长度并在每个 setw() 调用中使用适当的宽度。

# algorithm - 使用网格划分的 2D 最近邻搜索

> ID：15820226
> 
> 赞同：4
> 
> 时间：2013-04-04T19:39:29.317
> 
> 标签：algorithm, geometry, nearest-neighbor

我有一组相当大的 2D 点（~20000），对于 xy 平面中的每个点，我想确定集合中的哪个点最接近。（其实点的类型不同，我只想知道哪种类型最接近。而xy平面是位图，比如640x480。）

从[这个问题](https://stackoverflow.com/a/4172378/143091)的答案“[所有 k 最近的邻居在 2D，C++](https://stackoverflow.com/questions/4172358/all-k-nearest-neighbors-in-2d-c) ”我得到了制作网格的想法。我创建了 n*m C++ 向量并将点放入向量中，具体取决于它属于哪个 bin。这个想法是你只需要检查 bin 中点的距离，而不是所有点。如果 bin 中没有点，则继续以螺旋方式处理相邻的 bin。

不幸的是，我后来只看了 Oli Charlesworth 的评论：

> 不幸的是，不仅仅是相邻的（例如，考虑到单元格 2 中向东的点可能比单元格中正向东北的点更接近；这个问题在更高维度上会变得更糟）。另外，如果相邻的单元格中恰好有不到 10 个点怎么办？在实践中，您将需要“盘旋”。

幸运的是，我已经弄清楚了螺旋式代码（[这里有一个不错的 C++ 版本](https://stackoverflow.com/a/14010215/143091)，在同一个问题中还有其他版本）。但我仍然存在问题：

*   如果我在一个单元格中找到一个命中，则相邻单元格中可能有一个更接近的命中（黄色是我的探针，红色是错误的选择，绿色是实际最近的点）：

    ![在此处输入图像描述](https://i.stack.imgur.com/xpBdc.png)

*   如果我在相邻的单元格中发现命中，则可能会在 2 步外的单元格中命中，正如 Oli Charlesworth 所说：

    ![在此处输入图像描述](https://i.stack.imgur.com/sKGwg.png)

*   但更糟糕的是，如果我在两步外的牢房中发现命中，三步外的命中仍然可能会更近地命中！这意味着我必须考虑所有 dx,dy= -3...3 或 49 个单元格的单元格！

    ![在此处输入图像描述](https://i.stack.imgur.com/DQWIk.png)

现在，实际上这不会经常发生，因为我可以选择我的 bin 大小，这样单元格就足够填充了。不过，我希望得到一个正确的结果，而不是遍历所有点。

**那么我如何找出何时停止“螺旋”或搜索？**我听说有一种方法有多个重叠网格，但我不太明白。是否有可能挽救这种网格技术？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T20:51:54.177

对于您的任务，通常`Point Quadtree`使用 a ，尤其是当点分布不均匀时。

为了节省主内存，您还可以使用使用存储桶的 PM 或 PMR-Quadtree。

您在您的单元格中搜索，在最坏的情况下搜索该单元格周围的所有四边形单元格。

您也可以使用`k-d tree`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-04T20:20:30.220

由于您的位图尺寸不大，并且您想计算**每个** `(x,y)`的最近点，您可以使用动态规划。

令为到集合中最近点`V[i][j]`的距离，但**仅**考虑集合中位于“矩形”[(1, 1), (i, j)] 中的点。`(i,j)`

 **那么`V[i][j] = 0`如果 中有一个点`(i, j)`，或者的三个邻居之一在`V[i][j] = min(V[i'][j'] + dist((i, j), (i', j')))`哪里：`(i', j')``(i,j)`

IE

*   `(i - 1, j)`
*   `(i, j - 1)`
*   `(i - 1, j - 1)`

这为您提供了最小距离，但仅适用于“左上”矩形。我们对“右上”、“左下”和“右下”方向做同样的事情，然后取最小值。

复杂度为 O（平面大小），这是最优的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-10-17T05:06:38.853

我正在尝试的解决方案

*   首先制作一个网格，使每个框平均有 1 个（如果您想要更大的扫描，则更多）点。
*   选择中心框。继续以循环方式选择邻居框，直到找到至少一个邻居。此时您可以选择 1 个或 9 个左右的框
*   多选一层相邻框
*   现在您有一个相当小的点列表，通常不超过 10 个，您可以将其打入距离公式以找到最近的邻居。

由于每个框平均有 1 个点，因此您将主要选择 9 个框并比较 9 个距离。可以根据您的数据集属性调整网格大小以获得更好的结果。

此外，如果您的数据有很大的差异，您可以尝试 2 个级别的网格（甚至更多），因此如果选择有效并且在单个查询中返回超过 50 个点，请使用 1/10 的网格开始下一次网格搜索尺寸 ...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-04T20:21:03.730

一种解决方案是构建具有不同网格大小的多个分区。

假设您在 1、2、4、8、.. 级别创建分区

现在，在网格大小 1 中搜索一个点（您基本上是在 9 个方格中搜索）。如果搜索区域中有一个点，并且到该点的距离小于 1，则停止。否则移动到下一个网格大小。

与仅创建一级分区相比，您需要构建的网格数量大约是两倍。**

# facebook - 通过 Facebook API 检索未缩写的故事

> ID：15820228
> 
> 赞同：1
> 
> 时间：2013-04-04T19:39:34.813
> 
> 标签：facebook, facebook-graph-api

如果您在 Graph API 浏览器上查看此[评论](https://developers.facebook.com/tools/explorer/?method=GET&path=200312702164_10151521685107165?fields=story)，则该故事是缩写的，并且其完整内容不可用。有什么方法可以轻松检索这样的评论的完整信息？还是他们永远不会曝光？

```
 {
  "story": "\"We have no technology...\" on Ken Fowler's post on Moodagent's wall.",
  "id": "200312702164_10151521685107165",
  "created_time": "2013-03-11T11:39:01+0000"
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T19:45:07.223

看看脸书的RSS。这是一个示例的链接，该示例具有输出，因此您可以查看它是否符合您的需求。

[https://www.facebook.com/feeds/page.php?format=atom10&id=5791561181](https://www.facebook.com/feeds/page.php?format=atom10&id=5791561181)

希望这可以帮助。

# c# - 基于另一种颜色和 alpha 创建 System.Drawing.Color 的扩展方法或子类？

> ID：15820241
> 
> 赞同：2
> 
> 时间：2013-04-04T19:40:13.413
> 
> 标签：c#, extension-methods, system.drawing.color

我想使用以下习语之一在 C#（不是 XAML）中创建颜色：

```
Color transparentblue = TransparentColor(Brushes.Blue, 0.5); // 0.5 => 128
Color transparentblue = Brushes.Blue.SetAlpha(0.5);  // again, 0.5 => 128 
```

我想摆脱对`Color.FromArgb()`设计师不友好的语法。我也让它在静态类中使用静态方法，但写作有点沉重：

```
public static class ColorGenerators {        
    public static Color GetTransparentColor (Color color, double opacity) {
        byte op = (byte)(opacity*255);

        return Color.FromArgb(op, color.R, color.G, color.B);
    }
}

// To be used as
var transparentblue = ColorGenerators.GetTransparentColor(Color.Blue, 0.5); 
```

我仍然更喜欢扩展方法方法，在我看来，我们公司很快就会从类似于[这个问题](https://stackoverflow.com/q/780759/401828)中描述的方法中受益，所以我想知道它们会是什么样子（鉴于 Color 是一个结构，而不是一个类）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T19:43:51.863

像这样的东西怎么样：

```
public static class ColorExtensions
{        
    public static Color WithAlpha(this Color color, double opacity) 
    {
        byte op = (byte)(opacity*255);
        return Color.FromArgb(op, color.R, color.G, color.B);
    }
} 
```

关键是`this`第一个参数中的关键字。这（以及作为类中的`static`方法`static`）向编译器表明这是一个扩展方法。

```
Color transparentblue = Color.Blue.WithAlpha(0.5); 
```

**延伸阅读**

*   [扩展方法（C# 编程指南）](http://msdn.microsoft.com/en-us/library/vstudio/bb383977.aspx)

# python - 为什么 DatastoreInputReader 过滤器参数只支持相等运算符？

> ID：15820244
> 
> 赞同：4
> 
> 时间：2013-04-04T19:40:24.143
> 
> 标签：python, google-app-engine, mapreduce

我正在尝试仅处理特定日期之后发生的事件。为了实现这一点，我尝试使用大于运算符传递**过滤器参数（mapper_params）。**但是我收到以下错误：“仅支持相等过滤器”。

这是我的运行方法的样子：

```
 def run(self, action, occurred_after):
    output = yield mapreduce_pipeline.MapreducePipeline(
                "word_count",
                "main.word_count_map",
                "main.word_count_reduce",
                "mapreduce.input_readers.DatastoreInputReader",
                "mapreduce.output_writers.FileOutputWriter",
                mapper_params={
                    "entity_kind": 'models.Event',
                    "filters": [("action", "=", action),
                    ("occurred_on", ">", occurred_after )]
                },
                reducer_params={
                    "filesystem": "gs",
                    "gs_bucket_name": "mybucket/mapreduce_output",
                    "mime_type": "text/plain",
                    "output_sharding": "input"
                },
                shards=1) 
```

有谁知道为什么只支持“=”运算符？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-05-25T12:30:28.867

MapReduce 在内部使用实体的 KEY 上的不等式过滤器将数据库拆分为小块实体。

首先，它查询仅存在于一小部分实体上的[秘密属性](https://github.com/GoogleCloudPlatform/appengine-mapreduce/wiki/ScatterPropertyImplementation)（平均每 128 个实体一次 - 0.78% 的机会），然后查询 2 个连续实体之间的实体（实体 x 和实体 x+128 之间），然后运行您对该列表中每个实体的映射器函数（对于每个 x, x+128 组它创建一个任务）

# python - Python 'with' 语句 - 如何判断哪个模块/对象/类支持它？

> ID：15820247
> 
> 赞同：6
> 
> 时间：2013-04-04T19:40:36.883
> 
> 标签：python

[Raymond Hettinger](https://speakerdeck.com/pyconslides/transforming-code-into-beautiful-idiomatic-python-by-raymond-hettinger)在展示幻灯片 36 和 37 时让不少人感到惊讶。语句可用于打开文件，但不能用于这些新事物。查看有关线程的 python 3.3 文档，仅在最底部的第 16.2.8 节中甚至提到了它。从讲座中可以看出，使用“with”运算符是最佳实践。

*   应该如何确定是否支持'with'，它可以绑定到什么等？
*   另外，“with”应该怎么称呼？（threading with statement，python threading lock with statement，...），什么是白话来搜索并查看是否支持'with'（我们可以询问某些东西是否可迭代，我们是否询问它是否'withable'）？

参考：

*   [http://docs.python.org/2/reference/compound_stmts.html#with](http://docs.python.org/2/reference/compound_stmts.html#with) 7.5
*   [http://docs.python.org/2/reference/datamodel.html#context-managers](http://docs.python.org/2/reference/datamodel.html#context-managers) 3.4.10
*   [http://docs.python.org/3.1/library/threading.html](http://docs.python.org/3.1/library/threading.html) 16.2.8

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-04T19:48:38.523

首先，你不问某事是否“可使用”，而是问它是否是“上下文管理器”。*

例如，在您链接的文档中（顺便说一下，它们来自 3.1，而不是 3.3）：

> 目前，`Lock`、`RLock`、`Condition`、`Semaphore`和`BoundedSemaphore`对象可以用作`with`语句上下文管理器。

同时，如果你想在交互式解释器中进行搜索，有两件显而易见的事情要做：

```
if hasattr(x, '__exit__'):
    print('x is a context manager')

try:
    with x:
        pass
except AttributeError:
    pass
else:
    print('x is a context manager') 
```

同时：

> `help(open)`……没有提及

嗯，是的，因为`open`它不是上下文管理器，它是一个碰巧返回上下文管理器的函数。在 3.3 中，它可以根据其参数返回各种不同的东西；在 2.7 中，它只返回一件事 (a `file`)，但`help`会告诉您它返回的确切内容，然后您可以使用`help`适合您的用例的任何一个，或者只查看它的属性，看看它定义了`__exit__`.

无论如何，实际上，请记住 EAFTP 适用于调试和原型设计以及您的最终代码。尝试先写一些带有`with`声明的东西。如果您尝试用作上下文管理器的表达式不是一个，那么您将在尝试运行该代码时立即收到异常，这很容易调试。（这通常是`AttributeError`关于缺少的`__exit__`，但即使不是，回溯表明它来自您的`with`线路的事实应该告诉您问题。）如果您有一个看起来*应该*可用的对象作为上下文管理器，但不是，您可能需要考虑提交错误/将其提交到邮件列表/等。（在有人抱怨之前，stdlib 中有一些类不是上下文管理器。）

最后一件事：如果您使用的类型具有`close`方法，但不是上下文管理器，请`contextlib.closing`在它周围使用：

```
with closing(legacy_file_like_object): 
```

… 或者

```
with closing(legacy_file_like_object_producer()) as f: 
```

实际上，您应该真正查看[`contextlib`](http://docs.python.org/2/library/contextlib.html). `@contextmanager`非常漂亮，`nested`如果您需要将 2.7/3.x 代码反向移植到 2.5，并且虽然`closing`编写起来很简单（如果您有`@contextmanager`），但使用 stdlib 函数可以使您的意图变得清晰。

* * *

* 实际上，关于命名存在一些争论，并且它经常在邮件列表中重复出现。但是文档和`help('with')`两者都给出了近乎精确的定义，“上下文管理器”是评估“上下文表达式”的结果。因此， in`with foo(bar) as baz, qux as quux:`和`foo(bar)`都是`qux`上下文管理器。（或者也许在某种程度上，他们两个组成了一个上下文管理器。）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-04T19:44:36.470

afaik 实现`__exit__`方法的任何类/对象（您可能还需要实现`__enter__`）

```
>>>dir(file)
#notice it includes __enter__ and __exit__ 
```

所以

```
def supportsWith(some_ob):
   if "__exit__" in dir(some_ob): #could justas easily used hasattr
       return True 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-04T20:43:17.407

使用 Python`with`语句的对象称为*上下文管理器*。在典型的 Python 风格中，一个对象是否是一个上下文管理器只取决于你是否可以用它做“上下文管理器”的事情。（这种策略称为[鸭式打字](http://en.wikipedia.org/wiki/Duck_typing)。）

那么什么构成“上下文管理器-y”行为？确实有两件事：（1）在进入街区时进行一些标准设置`with`，以及（2）在退出街区之前进行一些标准的“拆除”，如果出现问题，可能还会进行一些损坏控制。就是这样。

详细信息在介绍该声明的[PEP 343](http://www.python.org/dev/peps/pep-0343/)`with`以及您在问题中链接的文档中提供。

## 一个`with`块，一步一步

但是，让我们一步一步地完成这个过程。

首先，我们需要一个“上下文管理器”。这是任何提供设置和拆卸行为的对象，封装在分别称为`__enter__`和的方法中`__exit__`。如果一个对象提供了这些方法，它就有资格作为一个上下文管理器，尽管如果这些方法没有做明智的事情，它可能是一个糟糕的管理器。

`with`那么当解释器看到一个块时，幕后会发生什么？首先，解释器在语句之后提供的对象上查找`__enter__`和`__exit__`方法。`with`如果方法不存在，那么我们没有上下文管理器，因此解释器会抛出异常。

但如果方法确实存在，一切都很好。我们有我们的上下文管理器，所以我们进入块。解释器然后执行上下文管理器的 `__enter__`方法并将结果分配给`as`语句后面的变量（如果有，否则结果被丢弃）。接下来，`with`执行块的主体。完成后，上下文管理器的`__exit__`语句将传递一个（可能为空的）字典，其中包含有关执行 bock 主体时发生的任何异常的信息，并执行该`__exit__`方法以清理内容。

以下是逐行演练：

```
with man as x:         # 1) Look for `man.__enter__` and `man.__exit__`, then ...
                       # 2) Execute `x = man.__enter__()`, then ...
    do_something(x)    # 3) Execute the code in the body of the block, ...
                       # 4) If something blows up, note it (in `err`), ...
                       # 5) Last, this (always!) happens: `man.__exit__(**err)`.
carry_on() 
```

就是这样。

## 重点是什么？

这里唯一的微妙之处是上下文管理器的`__exit__`方法*总是*被执行，即使在`with`块的主体中​​抛出了未捕获的异常。在这种情况下，异常信息被传递给`__exit__`方法（在我在上面的示例中调用的字典`err`中），该方法应该使用该信息来提供损害控制。

因此，`with`块只是一种抽象，它让我们将设置、拆卸和损坏控制代码（即“上下文管理”）分流到几个方法中，然后可以在幕后调用这些方法。这既鼓励我们排除样板文件，又提供更简洁、易读的代码，突出核心控制流并隐藏实现细节。

# c# - 如果已经打开，请关闭 Telerik Radgrid Editform

> ID：15820250
> 
> 赞同：5
> 
> 时间：2013-04-04T19:40:44.553
> 
> 标签：c#, asp.net, telerik, radgrid

在过去的一两个小时里，我试图找到一个解决方案来解决我认为应该很容易做的事情，以及我认为以前有人问过的事情，但也许我没有使用正确的术语。

我有一个非常基本的 RadGrid，它允许扩展行以编辑或显示更多内容。这是我在里面的 GridEditCommandColumn

```
<rad:GridEditCommandColumn EditText="+" UniqueName="EditCommandColumn" ItemStyle-Width="30" HeaderStyle-Width="30" /> 
```

再次，没什么特别的。当网格加载时，每行都有一个“+”字符，允许它展开。如果我单击它，它会正确打开。如果我单击另一行，它会关闭我打开的行并打开我单击的行。太好了，一切都很好。

现在我一直在尝试搜索的是，如果我已经打开了一行并且我再次单击“+”链接，如果它已经打开，我希望关闭该行。现在，它仍然处于打开状态。

如果您再次单击它（如果它已经打开），我是唯一一个希望它关闭的人吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-05T13:18:44.220

根据 dstepan 的建议，我能够解决它。我摆脱了通用的 GridEditCommandColumn 行并用它替换了它。

```
<rad:GridTemplateColumn UniqueName="ExpandRow">
   <ItemTemplate>
      <asp:Button ID="btnExpand" CommandName="ExpandRow" CommandArgument="<%# Container.ItemIndex %>" Text="+" runat="server" />
    </ItemTemplate>
 </rad:GridTemplateColumn> 
```

然后对于事件处理程序

```
protected void rg_ItemCommand(object sender, GridCommandEventArgs e)
    {            
        if (e.CommandName == "ExpandRow")
        {
            GridDataItem item = rg.Items[int.Parse(e.CommandArgument.ToString())];

            item.Edit = item.Edit ? false : true; // If it's already in edit mode, change it to false. If not, set it to true

            rg.Rebind();
        }
    } 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-05T06:34:27.513

请尝试使用以下代码片段。

```
protected void RadGrid1_ItemCommand(object sender, GridCommandEventArgs e)
{
    if (e.CommandName == RadGrid.EditCommandName)
    {
        RadGrid1.MasterTableView.ClearEditItems();
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-04T21:42:34.157

在我们的应用程序中，我们做了类似的事情，但是我们不是再次单击加号按钮，而是单击取消按钮。对于这个取消按钮，我们实际上没有任何特定的代码，但我们`CommandName="Cancel"`在标记中设置，然后在项目命令事件中检查并`CommandName`在那里编写我们的代码。然后绑定网格，并关闭编辑表单。抱歉，它没有回答您的根本问题，但希望有一些东西可以让您开始。

下面是示例事件结构，您可以在其中使用`CommandName`& 编写逻辑进行过滤。

```
protected void rg_ItemCommand(object sender, GridCommandEventArgs e)
{            
    if (e.CommandName == "Cancel")
    {
      //custom logic here
    }
} 
```

# cmd - 使用 AutoHotkey 捕获 CMD 输出

> ID：15820253
> 
> 赞同：4
> 
> 时间：2013-04-04T19:40:50.233
> 
> 标签：cmd, autohotkey

我正在尝试使用 AutoHotkey 读取 Windows CMD 的标准输出。例如，我想将`set`AHK 中的控制台命令的输出存储在一个变量中。我已经在不久前实现了它，这让我更加困惑为什么它现在不起作用。在 AHK 论坛中，有一个关于*CMDret*
的相当[老](http://www.autohotkey.com/board/topic/3489-cmdret-return-output-from-console-progs-dll-version/)的帖子，这是一个基于 DLL 的功能，可以完全按照我的意愿行事。第一个问题是为它找到一个有效的下载，因为帖子中的所有链接都已失效。Google 给了我[另一个站点](http://z4.invisionfree.com/Apps_4_Apps/ar/t7.htm)，托管**v3.1.2**。尽管似乎有一个较新的（分别为**v3.2.1和****4d Beta**），但我检查了它并测试了一个简单的示例：

 *******```
msgbox % CMDret(COMSPEC " /C set")
CMDret(CMD) 
{ 
  VarSetCapacity(StrOut, 10000) 
  RetVal := DllCall("cmdret.dll\RunReturn", "str", CMD, "str", StrOut)
  Return, %StrOut%
} 
```

不幸的是，MsgBox 什么都没有。然后我检查了`RetVal`哪个值为**0**；随附的自述文件说：

> 如果函数失败，则返回值为零。

再往下，它说：

> 注意：目前**只有 32 位**控制台应用程序可以使用这个 dll 版本的 CMDret（v3.1.2 或更低版本）。需要 command.com 的调用可能不会产生任何输出并且可能会崩溃。为了避免这种情况，我在下载文件中包含了一个名为“cmdstub.exe”的文件（在 Win9x 文件夹中）。**当调用16 位** 控制台应用程序以启用返回输出时，应使用此文件。

总之，我不确定问题是什么。我的机器在 64 位上运行。但是自述文件中的相应条款是否应该仅排除 16 位系统，还是仅包括 32 位系统？
如果计算架构可能不是问题，那可能是什么？

我正在寻找的是以下之一：

1.  我可以解决问题并继续使用 v3.1.2 吗？
2.  有没有人可以查看我可以查看的较新版本的工作源（甚至是本地副本）？
3.  是否有另一种方法 [库、.ahk 代码等] 我可以用于我的目的？（最好类似，因为 CMDret 看起来很简单）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-24T20:57:09.760

如果您不需要实时输出，您可以使用 cmd 框本身保存自己的文本文件，然后您可以让 autohotkey 检测控制台的 PID 何时完成（使用返回的结果`runwait`并将输出的文件读入内存。

所以你可以在你的运行命令中做到这一点（只是一个常规的 cmd 参数）：

```
ipconfig > myoutput.txt
exit 
```

现在您有了一个包含 ipconfig 输出的文本文件。

或者你可以做同样的事情，但不是输出到文本文件，你可以输出到剪贴板，如下所示：

```
ipconfig | clip 
```

然后，由于输出在剪贴板上，您可以轻松地将其抓取到自动热键中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2019-11-14T22:37:59.220

截至 2019 年 11 月，新推荐的 2 种做法 - [https://www.autohotkey.com/docs/FAQ.htm#output](https://www.autohotkey.com/docs/FAQ.htm#output)：

> # 如何检索命令行操作的输出？
> 
> 测试表明，由于文件缓存，临时文件对于相对较小的输出可能非常快。事实上，如果文件在使用后立即删除，它通常不会真正写入磁盘。例如：
> 
> ```
> RunWait %ComSpec% /c dir > C:\My Temp File.txt
> FileRead, VarToContainContents, C:\My Temp File.txt
> FileDelete, C:\My Temp File.txt 
> ```
> 
> 为避免使用临时文件（尤其是在输出很大的情况下），请考虑使用 Shell.Exec() 方法，如 Run 命令示例中所示。

运行命令示例 - [https://www.autohotkey.com/docs/commands/Run.htm#StdOut](https://www.autohotkey.com/docs/commands/Run.htm#StdOut)：

```
MsgBox % RunWaitOne("dir " A_ScriptDir)

RunWaitOne(command) {
    shell := ComObjCreate("WScript.Shell")
    exec := shell.Exec(ComSpec " /C " command)
    return exec.StdOut.ReadAll()
} 
```

注意：后一种方法 (shell.Exec) 将导致快速显示 cmd 窗口。您可以通过将这些行放在脚本的顶部来减少其出现的持续时间，这也会导致闪烁仅在您第一次调用 cmd 命令时发生一次。来自[https://autohotkey.com/board/topic/92032-how-to-hide-a-wscript-comspec-window/](https://autohotkey.com/board/topic/92032-how-to-hide-a-wscript-comspec-window/)：

```
;Following 2 lines : the cmd window will flash only once and quickly
DllCall("AllocConsole")
WinHide % "ahk_id " DllCall("GetConsoleWindow", "ptr") 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-06-29T02:16:25.607

这个剧本怎么样`StdoutToVar`？
它支持 64 位控制台。 [http://www.autohotkey.com/board/topic/15455-stdouttovar/page-7](http://www.autohotkey.com/board/topic/15455-stdouttovar/page-7)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-02-21T15:41:36.343

这已经困扰了我一段时间了-终于可以了！

唯一的先决条件是 MS sqlcmd.exe，一个名为 AHK_Dev 的数据库，当然还有 AHK_DBA，以便在您希望使用它时读取该值。

PS。确保将 {yourDir} 和 {yourServer} 替换为您自己的值！

```
USE AHK_DEV
CREATE TABLE [dbo].[AHK_DOS]([dos_out] [varchar](max) NULL) ON [PRIMARY];
insert into ahk_dos select 'empty' 
```

创建以下脚本...调用它 dos_out.bat

```
@echo off
if "%1" == "" ( 
    set v_cmd=""
) else (
    set v_cmd=%1
)
set v_cmd=%v_cmd:~1,-1%
SETLOCAL ENABLEDELAYEDEXPANSION
if "!v_cmd!" == "" (
    set v_cmd="echo ... %COMPUTERNAME% %USERNAME% %DATE% %TIME%"
    set v_cmd=!v_cmd:~1,-1!
)
set v_data=""
FOR /F "usebackq delims=¬" %%i in (`!v_cmd!`) do (
    set v_data="!v_data:~1,-1!%%i~"
)
set q_cmd="set nocount on;update ahk_dos set dos_out=N'!v_data:~1,-1!'"
"{yourDir}\Microsoft SQL Server\90\Tools\Binn\sqlcmd.exe" -S {yourServer} -E -d ahk_dev -Q !q_cmd! -W 
set q_cmd="set nocount on;select len(dos_out) as out_len, dos_out from ahk_dos"
"{yourDir}\Microsoft SQL Server\90\Tools\Binn\sqlcmd.exe" -S {yourServer} -E -d ahk_dev -Q !q_cmd! -W -w 8000
pause 
```

您可以使用...从 AHK 运行它

```
dosCmd2db(c) {
runwait, {yourDir\}dos_out.bat "%c%", , , dospid
msgbox %dospid% closed
}
dosCmd2db("")
dosCmd2db("echo This is a test")
dosCmd2db("dir") 
```

由于每次都在更新同一个字段，您显然需要在每个字段之间做一些事情以使这个示例有用！

试试看，让我知道你的进展如何

问候，杰夫

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-06-21T12:40:52.040

我在以下位置找到了适用于 AutoHotKey L 64bit 的仅脚本解决方案： [http ://www.autohotkey.com/board/topic/67687-ahkahk-lusing-wsh-to-interact-with-command-line-progs/](http://www.autohotkey.com/board/topic/67687-ahkahk-lusing-wsh-to-interact-with-command-line-progs/)

在玩了一会儿之后，我能够捕获我使用 DOS 类型命令列出的 40k 文本文件的整个输出。有一个演示展示了如何与 time 命令交互，如果您需要与 dos 命令或批处理脚本进行有限的双向交互，这很好。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-09-27T19:12:43.970

只是对@amynbe 答案的更新。

> ```
> MsgBox % RunWaitOne("dir " A_ScriptDir)
> 
> RunWaitOne(command) {
>     shell := ComObjCreate("WScript.Shell")
>     exec := shell.Exec(ComSpec " /C " command)
>     return exec.StdOut.ReadAll() } 
> ```
> 
> 注意：后一种方法 (shell.Exec) 将导致快速显示 cmd 窗口。您可以通过将这些行放在脚本顶部来减少 > 其出现的持续时间，这也会导致闪烁仅发生一次 > 第一次调用 cmd 命令时。

您可以在下面执行此操作以隐藏 cmd 并避免闪烁。

> ```
> MsgBox % RunWaitOne("dir " A_ScriptDir)
> 
> RunWaitOne(command) {
>   DetectHiddenWindows On
>   Run %ComSpec%,, Hide, pid
>   WinWait ahk_pid %pid%
>   DllCall("AttachConsole", "UInt", pid)
> 
>   shell := ComObjCreate("WScript.Shell")
>   exec := shell.Exec(ComSpec " /C " command)
> 
>   DllCall( "FreeConsole" )
>     return exec.StdOut.ReadAll()
> } 
> ```*******

# c# - 将样式添加到在 sql 查询中的 case 语句中设置的数据

> ID：15820255
> 
> 赞同：0
> 
> 时间：2013-04-04T19:41:01.443
> 
> 标签：c#, sql, gridview, case

我正在寻找修改我的网格视图的状态列中每个结果的颜色，无论如何使用我的查询中的案例语句来执行此操作还是我必须更改它？

基本上，如果它是 Pending 它的红色，如果它是 In Review，它是橙色的，如果它完成它是绿色的。使用当前代码完成此操作的最佳方法是什么？

我在 C# 中的 Visual Studio 中做所有事情。

我希望它看起来像这样：

![在此处输入图像描述](https://i.stack.imgur.com/1lwSI.jpg)

我声明状态变量的 SQL 语句后面的代码：

```
SqlCommand mySqlCommand = new SqlCommand(@"SELECT W.ID, W.Name, 
                CASE W.Type
                    WHEN 1 then 'U.S.'
                    WHEN 2 then 'Foreign'
                end as Type,
                CASE W.Status
                    WHEN 0 then 'Pending'
                    WHEN 1 then 'In Review'
                    WHEN 2 then 'Complete'
                end as Status, 
```

..ETC

正面：

```
<asp:GridView runat="server" ID="GridView1" CssClass="gridview" BorderColor="#E8CC6B"
        BorderStyle="Solid" BorderWidth="1px" Font-Size="Medium" HorizontalAlign="Left"
        AlternatingRowStyle-CssClass="even" Width="750px" AutoGenerateColumns="False" 
            AllowPaging="True" onpageindexchanging="GridView1_PageIndexChanging" 
            PageSize="25" ShowFooter="True" OnRowDataBound="GridView1_RowDataBound"> <PagerStyle CssClass="cssPager" /><FooterStyle CssClass="cssFooter" />
        <AlternatingRowStyle CssClass="even"></AlternatingRowStyle>
        <Columns>
            <asp:BoundField DataField="ID" HeaderText="ID" />
            <asp:BoundField DataField="Name" HeaderText="Name" />
            <asp:BoundField DataField="Type" HeaderText="Type" />
            <asp:BoundField DataField="Status" HeaderText="Status" />
            </Columns>
    </asp:GridView> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T19:45:34.797

您可以使用[GridView.RowDataBound](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.gridview.rowdatabound.aspx)事件来实现这一点。在文本的基础上设置单元格颜色。

```
void CustomersGridView_RowDataBound(Object sender, GridViewRowEventArgs e)
  {
    if(e.Row.RowType == DataControlRowType.DataRow)
    {
      switch (e.Row.Cells[3].Text)
        {
            case "Panding":
                e.Row.Cells[3].ForeColor = System.Drawing.Color.Red;
                break;
            case "Complete":
                e.Row.Cells[3].ForeColor = System.Drawing.Color.Green;
                break;
            case "In Review":
                e.Row.Cells[3].ForeColor = System.Drawing.Color.Yellow;
                break;
            default:
                e.Row.Cells[3].ForeColor = System.Drawing.Color.Black;
                break;
        };

     }
  } 
```

# mysql - 如何修改文本文件以便将其加载到mysql数据库中？

> ID：15820263
> 
> 赞同：0
> 
> 时间：2013-04-04T19:41:50.790
> 
> 标签：mysql, database, text

我的表中有 100 多列，有些可以为空。我想从一个txt文件输入。因此，某些行可能没有全部 100 个奇数条目。

例如，我的文本文件中的一行可能有大约 50 个条目，由一个“制表符”分隔，但我如何指定这 50 个条目必须从 100 多列中组成哪些列？

我已经阅读了有关 LOAD DATA INFILE 的信息，但我仍然对我的问题感到困惑。任何帮助表示赞赏。

假设文本文件是：
Toby, LA
Carl, 246

，我希望结果表是：
Toby NULL LA
Carl 246 NULL
我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T19:59:13.487

需要组织文本文件，使其具有一致的列集。如果您在一行中有 50 个制表符分隔的值，然后在下一行中有 100 个制表符分隔的值，那么您将永远无法将数据干净地加载到 MySQL 中。

在文本文件中仍然需要考虑缺失值，使用空字符串、NULL 等来表示缺失值。

如果您的表中有一些包含 NULL 值的现有数据，那么您可以将该数据的子集转储到磁盘，以获得在制表符分隔的文件中格式化缺失值的正确方法的示例：

```
select *
into outfile '/tmp/test.tsv'
FIELDS TERMINATED BY '\t' OPTIONALLY ENCLOSED BY '"'
LINES TERMINATED BY '\n'
from your_table
limit 1000 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T19:55:07.937

使用此指令：

```
LOAD DATA INFILE '/tmp/test.txt' INTO TABLE test
FIELDS TERMINATED BY ',' LINES TERMINATED BY '\n' 
```

这是您的txt的路线：

```
'/tmp/test.txt' 
```

您将 txt 转储到名为 test 的表上。

您的 txt 应具有以下结构：

```
Toby, 245, LA
Carl, 246, CA 
```

对于这样的结果：

```
Toby NULL LA 
Carl 246 NULL 
```

txt 应该是这样的：

```
Toby, NULL, LA 
Carl, 246 , NULL 
```

那是因为未指定 FIELD SCAPED BY。

**来自 Mysql 文档：**

NULL 值的处理因使用的 FIELDS 和 LINES 选项而异：

对于默认的 FIELDS 和 LINES 值，NULL 被写入为 \N 的字段值用于输出，而 \N 的字段值被读取为 NULL 用于输入（假设 ESCAPED BY 字符为“\”）。

如果 FIELDS ENCLOSED BY 不为空，则将包含文字 NULL 作为其值的字段读取为 NULL 值。这与包含在 FIELDS ENCLOSED BY 字符中的单词 NULL 不同，后者被读取为字符串“NULL”。

如果 FIELDS ESCAPED BY 为空，则将 NULL 写入单词 NULL。由 ',' 分隔的 3 个字段 \n .....您的表测试应该具有相同的结构

# php - 如何将客户从 Magento 导出到 WooCommerce（wordpress）

> ID：15820268
> 
> 赞同：1
> 
> 时间：2013-04-04T19:42:19.193
> 
> 标签：php, wordpress, magento

我正在将 Magento 商店迁移到 WooCommerce。

问题是 Magento 和 Wordpress 有不同的密码验证算法。

magento存储密码的方式：`md5($salt.$password).':'.$salt;`

Wordpress 存储密码的方式：`md5($password)`

有没有办法将现有的 Magento 客户导出到 wrpdress 并保留他们的密码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T19:44:07.660

因为这是不可能的单向加密。您最好的选择是修改 Wordpress 商店以使用 Magento 使用的相同加密。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-05-13T08:23:50.940

这可能是一个非常古老的帖子，但找到了以下解决方案： [https](https://wordpress.org/plugins/magento-user-compatibility/) ://wordpress.org/plugins/magento-user-compatibility/ 它是一个插件，在登录时，它会根据 Magento 哈希测试输入的密码，如果那样的话成功后，它会重新散列 WordPress 样式的密码并将其保存到数据库并继续登录。

这篇文章对我帮助很大：[http ://www.iancboswell.com/?p=122](http://www.iancboswell.com/?p=122)

# python - django 查询 - 如何在不同时获取最新行

> ID：15820273
> 
> 赞同：1
> 
> 时间：2013-04-04T19:42:30.267
> 
> 标签：python, django, django-queryset

这是我想要最后一行重复条目的 db RATING 表：

![在此处输入图像描述](https://i.stack.imgur.com/JMkMR.png)

我这样做了：

```
bewertung = Rating.objects.filter(von_location=1).distinct('von_location') 
```

但我得到了`bewertung`= 4的第一行。我想要这个属性的最后一行。我怎样才能得到`bewertung`=3，最后一行`von_location`？最好的方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T22:51:48.190

看起来好像您想要最大`id`的记录（在具有正确值的记录中`von_location`）。这是您按列按降序对它们进行排序时检索到的第一条记录`id`：

```
Rating.objects.filter(von_location=1).order_by('-id')[0] 
```

# c# - X 不包含 Y 的定义

> ID：15820283
> 
> 赞同：0
> 
> 时间：2013-04-04T19:43:01.453
> 
> 标签：c#

问题已由***csharpler***回答。我不知道我在彼此内部创建了两个相同的类（在 MenuMaker 类中）......

X

X

X

这是我遇到问题的代码示例：

```
namespace MeatMenuProgram
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();

            MenuMaker menu = new MenuMaker() { Randomizer = new Random() };
            label1.Text = menu.GetMenuItem();
            label2.Text = menu.GetMenuItem();
            label3.Text = menu.GetMenuItem();
            label4.Text = menu.GetMenuItem();
            label5.Text = menu.GetMenuItem();
            label6.Text = menu.GetMenuItem();
        }
    }
} 
```

我做了一个`MenuMaker`类：

```
namespace MeatMenuProgram
{
    class MenuMaker
    {
        class MenuMaker {

            public Random Randomizer;

            string[] Meats = { "Roast beef", "Salami", "Turkey", "Ham", "Pastrami" };

            string[] Condiments = { "yellow mustard", "brown mustard","honey mustard", "mayo", "relish", "french dressing" };

            string[] Breads = { "rye", "white", "wheat", "pumpernickel","italian bread", "a roll" };

                public string GetMenuItem() {
                    string randomMeat = Meats[Randomizer.Next(Meats.Length)];

                    string randomCondiment = Condiments[Randomizer.Next(Condiments.Length)];

                    string randomBread = Breads[Randomizer.Next(Breads.Length)];

                    return randomMeat + " with " + randomCondiment + " on " + randomBread;

                }
            }
        }
    } 
```

但它不编译。错误日志：

> 错误 1 ​​'MeatMenuProgram.MenuMaker' 不包含 'Randomizer' 的定义
> 
> 错误 2“MeatMenuProgram.MenuMaker”不包含“GetMenuItem”的定义，并且找不到接受“MeatMenuProgram.MenuMaker”类型的第一个参数的扩展方法“GetMenuItem”（您是否缺少 using 指令或程序集引用？）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T19:57:58.463

首先，您应该使用 C# 编程约定，例如：以小写字母开头的变量、参数和*字段的名称。*

然后，*仔细*检查您的代码。你看到`MeatMenuProgram`命名空间了吗？是的。它包含一个`MenuMaker`类吗？是的，它确实。*该类*是否包含一个字段`randomizer`？不，不是的。它包含*另一个*也名为`MenuMaker`. 相反，删除内部类，所有问题都会消失：

```
namespace MeatMenuProgram
{
    class MenuMaker
    {
        public Random randomizer;

        string[] meats =
        { "Roast beef", "Salami", "Turkey", "Ham", "Pastrami" };

        string[] condiments =
        { "yellow mustard", "brown mustard","honey mustard" };

        string[] breads =
        { "rye", "white", "wheat", "pumpernickel" };

        public string GetMenuItem()
        {
            string randomMeat = meats[randomizer.Next(meats.Length)];
            string randomCondiment = condiments[randomizer.Next(condiments.Length)];
            string randomBread = breads[randomizer.Next(breads.Length)];

            return randomMeat + " with " + randomCondiment + " on " + randomBread;
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T19:46:31.500

正如错误所述，您的 class`MenuMaker`不包含您尝试访问的那些属性/方法。你必须有

```
public string GetMenuItem() { }
public Random Randomizer { get; set; } 
```

在课堂`MenuMaker`上。

您将 MenuMaker 类嵌套在另一个同名的类中，您必须删除加倍的`class MenuMaker {`（以及最后的右大括号）。

# jquery - 检查jQuery中的选择器是否为空白

> ID：15820285
> 
> 赞同：4
> 
> 时间：2013-04-04T19:43:08.147
> 
> 标签：jquery, jquery-selectors, string

我目前正在使用带有 jQ​​uery 命令的 .js 文件来查找 .xml 文件的某些元素。我已经能够轻松收集我想要的所有数据，但是在演示时遇到了一些困难。

我使用相同的 .js 脚本来加载多个 .xml 文件。数据以 html 文档和列表形式收集。这是代码：

```
 $upgrade1 = $(xml).find("upgrades").eq(0).next();
        $upgrade2 = $(xml).find("upgrades").eq(1).next();
        $upgrade3 = $(xml).find("upgrades").eq(2).next();
        $("#upgrades").append($upgrade1.text() + "<li>" + $upgrade2.text() + "</li><li>" + $upgrade3.text() + "</li>"); 
```

现在您可以看到，选择器首先编译它们需要的文本，然后将其添加到`<li class ="upgrades">`. `<li>`现在这里的问题是一些 .xml 文件将只有 1 或 2 次升级，而不是全部 3 次。但由于.append() 中的元素，该函数仍会绘制空白项目符号

最简单的解决方案是使用 if 语句，但是我似乎无法在任何地方找到如何检查选择器是否为空白？只提到了检查表单元素，但这对我没有帮助。可能是一种检查空字符串或少于 1 个字符的字符串的方法？我不知道...

有没有人有任何想法？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-04T19:45:54.903

使用`length`.

```
if ($('whatever').length == 0) {
  // It's empty
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-04T19:48:54.983

您还可以通过在查询中调用 each 来隐式使用您的选择器。

```
$("whatever").each(function () {
    var ctl = $(this);
    ctl.text("bob jones");
}); 
```

通过这种方式，您会自动放弃没有返回任何结果的实例。

# c# - 如何在驻留在基类中的函数中返回派生类类型？

> ID：15820286
> 
> 赞同：-2
> 
> 时间：2013-04-04T19:43:15.593
> 
> 标签：c#, .net

这是代码。

```
public class EData {
    public static EData All(){
        return null;
    }
}

public class EHouse : EData {

} 
```

我不希望函数 All in class `EHouse`return`EData`但 return `EHouse`。

`EHouse.All()`应该返回一种 EHouse 类型，而无需在派生类中编码任何额外内容。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-04T19:52:37.397

好吧，您可以使用[自引用泛型](http://blogs.msdn.com/b/simonince/archive/2008/06/12/generics-the-knee-bone-s-connected-to-the-toe-bone-pattern.aspx)，但有时会[导致问题](http://blogs.msdn.com/b/ericlippert/archive/2011/02/03/curiouser-and-curiouser.aspx)。但是你会得到这样的东西：

```
public class EData<T> where T : EData<T>
{
    public static T All(){
        return null;
    }
}

public class EHouse : EData<EHouse> 
{

} 
```

使用如下：

```
EHouse all = EHouse.All(); 
```

但不确定这是否违反了您“不必在派生类中编写任何内容”的约束，因为它会稍微更改其继承声明。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T19:59:13.113

您可以尝试具有泛型类型参数的 EData：

```
public class EData<T> 
{
    public static T All()
    { return (T) ..... }
}

public class EHouse : EData<EHouse> { } 
```

# mysql - MySQL 错误 1241：操作数应包含 1 列

> ID：15820288
> 
> 赞同：66
> 
> 时间：2013-04-04T19:43:21.180
> 
> 标签：mysql, sql, select, insert, mysql-error-1241

我正在尝试将 table1 中的数据插入 table2

```
insert into table2(Name,Subject,student_id,result)
select (Name,Subject,student_id,result)
from table1; 
```

table2 的键是 student_id。

假设没有任何重复。

我得到错误：`MySQL error 1241: Operand should contain 1 column(s)`

表 2 中只有四列。

* * *

## 回答 #1

> 赞同：145
> 
> 时间：2013-04-04T19:45:49.267

语法错误，删除`( )`from `select`。

```
insert into table2 (name, subject, student_id, result)
select name, subject, student_id, result
from table1; 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2013-04-04T19:44:25.270

只需删除SELECT 语句中的`(`and即可：`)`

```
insert into table2 (Name, Subject, student_id, result)
select Name, Subject, student_id, result
from table1; 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2018-03-05T05:46:27.967

使解析器引发相同异常的另一种方法是以下不正确的子句。

```
SELECT r.name
FROM roles r
WHERE id IN ( SELECT role_id ,
                     system_user_id
                 FROM role_members m
                 WHERE r.id = m.role_id
                 AND m.system_user_id = intIdSystemUser
             ) 
```

子句中的嵌套`SELECT`语句`IN`返回两列，解析器将其视为操作数，这在技术上是正确的，因为 id 列与嵌套选择语句返回的结果中的一列 (role_id) 中的值相匹配，预计返回一个列表。

为了完整起见，正确的语法如下。

```
SELECT r.name
FROM roles r
WHERE id IN ( SELECT role_id
                 FROM role_members m
                 WHERE r.id = m.role_id
                 AND m.system_user_id = intIdSystemUser
             ) 
```

该查询所在的存储过程不仅被解析，而且返回了预期的结果。

# razor - 从下拉列表中选择选项时无法在 ViewModel 上设置属性---MVC4

> ID：15820291
> 
> 赞同：0
> 
> 时间：2013-04-04T19:43:38.660
> 
> 标签：razor, asp.net-mvc-4

无法找到我做错的地方。帮助将不胜感激。谢谢！

在我的视图模型中，我有属性 ListValues，其中包含下拉列表的数据。当在下拉列表中进行选择时，我正在尝试在 viewmodel 上设置属性（SelectedItem）。但是当在下拉列表中选择某些内容时，它不会更新值。在此示例中，我使用 javascript 函数来测试该值是否已设置，但它始终显示变量未定义。

我的视图模型：

```
public class ViewModel
    {
        private readonly List<SelectListItem> items;
        public ViewModel()
        {
            items = new List<SelectListItem>();
            items.Add(new SelectListItem() { Text = "Texas", Value = "1", Selected = true });
            items.Add(new SelectListItem() { Text = "Illinios", Value = "2", Selected = false });
            items.Add(new SelectListItem() { Text = "New York", Value = "3", Selected = false });
            items.Add(new SelectListItem() { Text = "Kansas", Value = "4", Selected = false });

            ListValues = items;
        }
        public string SelectedItem { get; set; }
        public IEnumerable<SelectListItem> ListValues { get; set; } 
    } 
```

行动方法：

```
public class EmployersController : Controller
    {
        //
        // GET: /Employers/

        public ActionResult Index()
        {
            ViewModel vm = new ViewModel();
            return View(vm);
        }

    } 
```

看法：

```
@using System.Collections
@model DemoMVCApplication.Models.ViewModel
<script src="~/Scripts/Custom/default.js"></script>
@{
    ViewBag.Title = "Index";
}

@Html.DropDownListFor(model => model.SelectedItem, Model.ListValues)
<button id="button123"  onclick="process(@Model.SelectedItem);">Call Script</button>
<h2>Index</h2> 
```

javascript测试是否已设置值

```
function process(x) {
    var result = x;

} 
```

x 总是说未定义

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T19:47:12.140

这是一个副本：[如何编写一个简单的 Html.DropDownListFor()？](https://stackoverflow.com/questions/3057873/how-to-write-a-simple-html-dropdownlistfor)

然而：`<%= Html.DropDownListFor(n => n.MyColorId, new SelectList(Colors, "ColorId", "Name")) %>`

是您需要的答案中的代码，这是您还需要将您的类型转换为 selectList，尽管这已经是模型中的那种类型。

# hazelcast - hazelcast v2.5 的管理控制台应用程序的版本不匹配错误

> ID：15820297
> 
> 赞同：0
> 
> 时间：2013-04-04T19:43:52.120
> 
> 标签：hazelcast

我最近切换到2.5。我刚刚尝试了 hazelcast（在 tomcat7 中运行）的管理控制台（v2.5） - 我相信应用程序目录是可读/可写的。我有一个 hazelcast 节点正在运行（相同版本）。但是，即使它们是相同的版本，连接请求也无法抱怨版本不匹配（错误复制如下）。任何解决此问题的建议都将受到欢迎。

```
com.hazelcast.impl.management.VersionMismatchLogRequest
SEVERE: [192.168.1.11]:5701 [dev] Version Mismatch
    management center version : 2.5
    hazelcast version : 2.5 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T20:01:31.590

这些天我脸上的鸡蛋很多。飞行员错误。这些是我遵循的步骤：

1.  从 127.0.0.1 切换到 0.0.0.0（我的盒子上的本地主机是 0.0.0.0）
2.  更重要的是，确保 mancenter 的数据目录（称为 mancenter）在 /var/lib/tomcat7 中并且是可读/可写的——以前不是这样。

用户名/密码（默认）是 admin/admin。到目前为止，它有效。希望能帮助到你！

# java - 当我添加“this”时，递归初始化程序有效吗？

> ID：15820302
> 
> 赞同：35
> 
> 时间：2013-04-04T19:44:23.927
> 
> 标签：java

正如人们所期望的那样，这无法编译（出现`illegal forward reference`错误）：

```
class test {
    int x = x + 42;
} 
```

但这有效：

```
class test {
    int x = this.x + 42;
} 
```

这是怎么回事？在后一种情况下分配了什么？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-04-04T21:05:43.243

`x`在 x 的初始化期间发现和禁止所有访问太难了。例如

```
int x = that().x;                |    int x = getX();
                                 |
Test that(){ return this; }      |    int getX(){ return x; } 
```

该规范停留在“通过简单名称访问”，并没有尝试更全面。

在另一部分“明确分配”中，规范做了类似的事情。例如

```
public class Test
{
    static final int y;
    static final int z = y;  // fail, y is not definitely assigned 
    static{ y = 1; }
}

public class Test
{
    static final int y;
    static final int z = Test.y;  // pass... because it's not a simple name
    static{ y = 1; }
} 
```

有趣的是，“Definite Assignment”特别提到这`this.x`相当于`x`

> （或者，对于一个字段，由这个限定的字段的简单名称）

该条款也可以添加到 NPE 引用的部分。

> *   用法是通过一个简单的名称（或由此限定的简单名称）

但最后，不可能在编译时分析所有可能的使用/访问一个字段。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2013-04-04T19:58:24.153

摘要：两个初始化器都访问一个尚未初始化的字段（因此仍然具有默认值零）。由于这很可能是编程错误，因此该语言禁止某些简单形式的此类访问。但是，它并没有禁止更复杂的形式。

该行为符合 JLS，特别是[§8.3.2.3。初始化期间使用字段的限制](http://docs.oracle.com/javase/specs/jls/se7/html/jls-8.html#jls-8.3.2.3)

> 仅当成员是`static`类或接口的实例（分别）字段`C`并且以下所有条件都成立时，成员的声明才需要在使用之前以文本形式出现：
> 
> *   该用法发生在 C 的实例（分别`static`）变量初始化器或 C 的实例（分别`static`）初始化器中。
>     
>     
> *   用法不在作业的左侧。
>     
>     
> *   用法是通过一个简单的名称。
>     
>     
> *   `C`是包含用法的最里面的类或接口。

第一个示例满足所有四个条件，因此无效。第二个示例不满足第三个条件（`this.x`不是一个简单的名称），因此可以。

事件的总体顺序如下：

*   创建类的实例时，所有字段都被初始化为其类型的默认值。
*   [然后初始化程序按文本顺序](https://stackoverflow.com/a/15831155/367273)（从上到下）运行。

因此，如果初始化器引用稍后出现在类定义中的字段（或字段本身），它将看到该其他字段的默认值。这可能是一个编程错误，因此第 8.3.2.3 节明确禁止。

例如，如果您通过使用`this.`to 前向引用字段来规避 §8.3.2.3，[您将看到默认值](https://stackoverflow.com/a/15831295/367273)（零表示`int`）。因此，以下是明确定义的，并保证设置`x`为`42`：

```
class test {
    int x = this.x + 42;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-05T08:40:16.680

在第一种情况下，编译器尝试评估表达式 'x + 42' 但由于 x 未初始化而失败。

在第二种情况下，表达式 'this.x + 42' 在运行时计算（因为有 'this' 关键字），此时 x 已经初始化并且值为 0。

# javascript - 碰撞寿命减少

> ID：15820303
> 
> 赞同：0
> 
> 时间：2013-04-04T19:44:24.573
> 
> 标签：javascript, html, canvas, collision

我正在使用 HTML5 Canvas 和 javascript 制作一个小游戏。到目前为止，我有一只风筝在碰撞时移动某种电源，在碰撞时移动障碍物。

现在我想增加生命，当你遇到障碍时，你的生命将减少 1。

我尝试了一些东西，当你撞到障碍物时，生命会减少，但它会不断减少，并且玩家图像被移除而不是障碍物图像。

这是生活中的事情，您可以在那里检查所有代码。

[http://nickzijlstra.com/kite](http://nickzijlstra.com/kite)

这里的代码我认为是最重要的问题。

```
 function  hitObject(player, obj){
var a = (obj.x - player.x),
b = (obj.y - player.y),
c = Math.sqrt(a*a + b*b),
r0 = player.image.width/2,
r1 = obj.image.width/2;

 if (c < r0+r1) { 
player.drawable = false;
lifes -=1;

window.location.reload(true);       
  }
 } 
```

如果有人看到问题或知道解决方案，我将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T19:55:12.520

播放器消失的原因是`hitObject`函数中的这一行：

```
player.drawable = false; 
```

由于绘图函数中的这种情况，这将导致无法绘制玩家：

```
if (player.drawable == true) {
    context.drawImage(player.image, player.x, player.y, player.image.width, player.image.height);
} 
```

我想如果玩家被击中，你实际上想将`obj`背部移动到屏幕顶部的随机位置。目前它不这样做，这就是生命值迅速下降的原因：物体击中玩家，移除一条生命，然后下一帧再次击中玩家（即使玩家不可见） .

你可能想要的是这样的：

```
...
if (c < r0+r1) { 
    lifes -=1;

    // Respawn the object.
    obj.y = -50;
    obj.x = Math.random() * canvas.width;
... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T19:53:49.737

猜测一下，我会说你应该更换

```
player.drawable = false; 
```

和

```
obj.drawable = false; 
```

并将整个碰撞检测包裹在 if obj.drawable=true 中，这样移除的障碍物就不会与风筝发生碰撞。

# css - OSX Safari 6.0.3 和 twitter 引导折叠插件

> ID：15820305
> 
> 赞同：3
> 
> 时间：2013-04-04T19:44:24.800
> 
> 标签：css, twitter-bootstrap, safari, collapse

我正在努力让手风琴折叠容器在 OSX 10.8.3 上的 Safari 6.0.3 中工作

仅当存在浏览器历史记录（已访问域中的其他一些页面）时，才会出现此问题。如果您清除历史记录然后重新加载页面，则手风琴正在工作？？？

到目前为止我所拥有和测试的内容：1.所有其他浏览器都在工作，包括适用于 Windows 的浏览器和适用于旧版 OSX（雪豹）的 Safari 2.在检查器中，我注意到折叠后的元素设置为 height:40px 和不像 Chrome 那样 height:auto 。

你有没有注意到这种奇怪的行为？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-09T20:14:01.800

我没有找到 safari 不当行为的原因，但想出了一个解决手风琴可折叠元素的方法。过渡效果是通过 jQuery slideUp 和 slideDown 实现的。它可能对某人有帮助。

```
 if (navigator.userAgent.indexOf('Safari') != -1 && navigator.userAgent.indexOf('Chrome') == -1) {

    if(navigator.userAgent.indexOf('Mac OS X') != -1 && navigator.userAgent.indexOf('Version/6.0.3') != -1){

        $('[data-toggle="collapse"]').attr('data-toggle', "safari-collapse");

        var collapsible_elements = $(".collapse").addClass('safari-collapse').removeClass('collapse').not('.in').hide();

        $('[data-toggle="safari-collapse"]').on('click', function(e){

            e.preventDefault();

            var target = $(this).attr('href');

            if( $(this).attr('data-parent') ){      // check if data-parent (accordion)
                $(target).parent().siblings().find('.safari-collapse').not(":hidden").slideUp();    
            }

            if($(target).is(":visible")){
                $(target).slideUp();
            }
            else{
                $(target).slideDown();
            }

        });

    }

} 
```

# asp.net-mvc-3 - 播种数据实体框架指南

> ID：15820306
> 
> 赞同：0
> 
> 时间：2013-04-04T19:44:24.903
> 
> 标签：asp.net-mvc-3, entity-framework

我在`dropcreatedatabase`启动时播种一些常量数据时遇到问题。我查看了一些类似的问题，但我很难理解为什么我的代码不起作用。

非常感谢所有帮助（c：

这是我的带有种子数据的 SampleData 模型

```
public class SampleData : DropCreateDatabaseIfModelChanges<fotmEntities>
{
    protected override void Seed(fotmEntities context)
    {
        var genres = new List<Genre>
        {
            new Genre { Name = "Specials" },
            new Genre { Name = "Online" },
            new Genre { Name = "Services" },
            new Genre { Name = "Food" },
            new Genre { Name = "Misc" },
            new Genre { Name = "Auto" }
        };var localities = new List<Locality>

        {
            new Locality { Name = "Location1" },
            new Locality { Name = "Location2" },
            new Locality { Name = "Location3" },
            new Locality { Name = "Location4" },

        };

        new List<Discount>
        {
            new Discount { Title = "Title A", Genre = genres.SingleOrDefault(g => g.Name == "Specials"), Information = "8.99M", Locality = localities.Single(a => a.Name == "Location1"), DiscountArtUrl = "/Content/img/placeholder.gif" },
            new Discount { Title = "Title B", Genre = genres.SingleOrDefault(g => g.Name == "Specials"), Information = "8.99M", Locality = localities.Single(a => a.Name == "Location2"), DiscountArtUrl = "/Content/img/placeholder.gif" },
            new Discount { Title = "Title C", Genre = genres.SingleOrDefault(g => g.Name == "Services"), Information = "8.99M", Locality = localities.Single(a => a.Name == "Location3"), DiscountArtUrl = "/Content/img/placeholder.gif" },
            new Discount { Title = "Title D", Genre = genres.SingleOrDefault(g => g.Name == "Food"), Information = "8.99M", Locality = localities.Single(a => a.Name == "Location4"), DiscountArtUrl = "/Content/img/placeholder.gif" },
            new Discount { Title = "Title E", Genre = genres.SingleOrDefault(g => g.Name == "Misc"), Information = "8.99M", Locality = localities.Single(a => a.Name == "Location1"), DiscountArtUrl = "/Content/img/placeholder.gif" },
            new Discount { Title = "Title F", Genre = genres.SingleOrDefault(g => g.Name == "Auto"), Information = "8.99M", Locality = localities.Single(a => a.Name == "Location2"), DiscountArtUrl = "/Content/img/placeholder.gif" },
        }.ForEach(a => context.Discounts.Add(a)); 
```

这是我的上下文模型：

```
using System.Data.Entity;

public class fotmEntities : DbContext
{
    public DbSet<Discount> Discounts { get; set; }
    public DbSet<Genre> Genres { get; set; }

    public DbSet<Locality> Localities { get; set; }
} 
```

和我的 Global.asx

```
protected void Application_Start()
    {
        System.Data.Entity.Database.SetInitializer(
            new fotm.Models.SampleData());
        AreaRegistration.RegisterAllAreas();
        RegisterGlobalFilters(GlobalFilters.Filters);
        RegisterRoutes(RouteTable.Routes);
    } 
```

# c - 多处理器架构中的状态机事件生成

> ID：15820308
> 
> 赞同：1
> 
> 时间：2013-04-04T19:44:26.973
> 
> 标签：c, state-machine, cpu-architecture, event-driven, event-driven-design

目前，我正在与一位同事进行小型架构争论。我希望你们中的一些人可以通过强烈建议一种方法而不是另一种方法来帮助解决它。

我们有一个 DSP 和 Cortex-M3 与共享内存耦合在一起。DSP 接收来自外部世界的请求，其中一些请求将执行某些只能在 CM3 上完成的无线测试功能。DSP 写入共享内存，然后通过中断向 CM3 发送信号。共享内存指示请求是什么以及执行请求所需的任何必要数据（调谐到的通道、要读取的 RF 芯片的寄存器等）。

*我的偏好是为中断*中可能发生的每个请求生成一个唯一的事件 ID 。然后在离开中断之前将事件传递到状态机的事件队列，该队列将在专用于 RF 活动的线程中处理。

相反，我的同事希望将单个事件 ID（通用 RF 命令）传递给状态机，并在状态机中接收到此事件 ID 后对共享内存区域进行解析。解析后，您将知道需要执行的特定命令。

我不喜欢这种方法，因为您将在您碰巧处于的任何状态下解析共享内存。您可以将其设为函数，但它仍然是应该与状态无关的处理。她不喜欢在中断中解析共享内存的想法。

对更好的方法有何评论？如果有帮助，我们将使用 Miro Samek 的 QP 框架来实现状态机。

编辑：将状态图移至[ftp://hiddenoaks.asuscomm.com/Statechart.bmp](ftp://hiddenoaks.asuscomm.com/Statechart.bmp)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T19:56:21.810

这是一个折衷方案：

*   将单个事件 ID（通用 RF 命令）从中断传递给状态机
*   创建一个“解析”共享内存并返回特定命令的 action_function
*   `[parser_action_func() == RF_CMD_1]`使用等保护状态图中的 RF_EVENT 转换。

状态图代码生成器应该足够智能，`parser_action_func()`每个 RF_EVENT 只执行一次。（不知道 QP 框架是否那么聪明）。

这与“每个请求的唯一事件 ID”具有相同的状态图语义，并避免在中断处理程序中解析共享内存。

附录

状态图中的区别是标记了 N 个转换

```
----RF_EVT_CMD_1---->
----RF_EVT_CMD_2---->
       ...
----RF_EVT_CMD_N----> 
```

真的

```
----RF_EVT[cmd()==CMD_1]---->
----RF_EVT[cmd()==CMD_2]---->
        ...
----RF_EVT[cmd()==CMD_N]----> 
```

`cmd()`解析动作函数在哪里。

# linux - 从 Linux 访问控制服务器上的视频流中捕获静止图像

> ID：15820310
> 
> 赞同：0
> 
> 时间：2013-04-04T19:44:31.457
> 
> 标签：linux, image, video-streaming, video-capture

我目前正在为工作中的自定义访问控制服务器添加功能，我想做的是访问门口的摄像头并在门解锁后存储至少一张静止图像（每扇门都有一个 RFID 阅读器与此接口服务器）。

例如，其中一台摄像机是 Vivotek FD8136，它有多个输出流，只要我有用户名和密码，我就可以访问这些流......使用这台摄像机，我可以通过转到本地地址[http来访问流://xxx.xxx.xxx.xxx:8002/video2.mjpg](http://xxx.xxx.xxx.xxx:8002/video2.mjpg)

我只是不确定如何从该流中将一个简单的图像保存到服务器.....

任何和所有的帮助将不胜感激。我知道我可能试图在我的脑海里把它复杂化......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T21:01:00.830

我找到了一种使用 avconv 的可能方法......但是如果有人知道更好的方法，请随时留言，以便如果其他人需要它也可以帮助他们。

使用 avconv 它是如下命令（我相信它也可以与 ffmpeg 一起使用）

avconv -i [http://xxx.xxx.xxx.x:8002/video2.mjpg](http://xxx.xxx.xxx.x:8002/video2.mjpg) -vframes 1 输出%.jpg

这将输出一个用于测试的文件，但是带有日期的 bash 脚本可以轻松地使文件名带有日期和时间。然后在需要时只需运行所需的脚本，稍后可以访问图像。

# java - System.out.println 不适用于数字

> ID：15820316
> 
> 赞同：0
> 
> 时间：2013-04-04T19:44:39.653
> 
> 标签：java, numbers, system

我有以下代码：

```
 import java.util.Scanner;

    import javax.swing.JOptionPane;

    public class weatherCalc {
        public static void main(String args[]) {
            while (true) {
                int division = 8125/1000;
                Scanner in = new Scanner;
                System.out.println("How far, in inches, is it moving on a 50-mile = 0.75 in? (Please use decimels)");
                int weatherInput = in.nextInt();
                System.out.println("How long is the time period in hours? (Please use decimels)");
                int weatherTime = in.nextInt();
                int weatherOutput = weatherInput/division*50/weatherTime;
                System.out.println("The storm is travling at "+ weatherOutput +"MPH.");
            }
        }
    } 
```

你看，系统在 "System.out.println("它在 50 英里 = 0.75 英寸上移动了多远，以英寸为单位？（请使用小数）");" 带有红色下划线以及“Scanner in = new Scanner;”的结尾 我不知道为什么，我只是想为自己开发这个。我以后可能会做一些工作。如果有人能告诉我为什么，那将有很大帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-04T19:45:56.447

```
Scanner in = new Scanner; 
```

应该：

```
Scanner in = new Scanner(System.in); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-04T19:48:50.053

```
Scanner in = new Scanner(System.in); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-04T19:49:01.133

您的 while 循环应该是这样的：（查看针对每个更改的代码指定的注释）

```
Scanner in = new Scanner(System.in);//Move the Scanner declaration outside loop . Don't create it every-time within the loop.
while (true) {
  int division = 8125/1000;
  System.out.println("How far, in inches, is it moving on a 50-mile = 0.75 in? (Please use decimels)");
  int weatherInput = in.nextInt();
  System.out.println("How long is the time period in hours? (Please use decimels)");
  double weatherTime = in.nextDouble();//Take double value from input as u have specified that you want input in decimals.
  double weatherOutput = weatherInput/division*50/weatherTime;//Changed weatherOutput type to double so that you get the result in double.
  System.out.println("The storm is travling at "+ weatherOutput +"MPH.");
 } 
```

# audio - 如何封装原始 uLaw 或 aLaw 样本以便轻松播放？

> ID：15820318
> 
> 赞同：2
> 
> 时间：2013-04-04T19:44:48.503
> 
> 标签：audio, wav, rtp, file-format, codec

我正在调试一些处理 uLaw 或 aLaw 格式的 RTP 语音流的代码。我想捕获通过我的代码的样本并将它们存储到一个文件中。*这*很容易。我的问题是：是否有一种文件格式可以让我轻松封装原始数据，以便可以由一些常见的播放器软件播放？

我知道采样率，它是每秒 8000 次——电话默认。

我可以将每个样本转换为等效的 16 位 PCM 并制作一个 WAV 文件，但我真的很想避免这样做。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-05T01:49:05.297

如果你有[SoX](http://sox.sourceforge.net)，你可以将你的编码数据写入一个二进制文件，并使用一堆命令行选项来播放它，告诉 SoX 正确的格式。我*认为*你可以这样做：

```
$ sox --bits 8 --channels 1 --encoding mu-law --rate 8000 file.raw --default-device 
```

我总是需要几次尝试才能获得正确的选项，但它是处理音频数据的有用实用程序。不同操作系统的命令行应该相同。如果该`--default-device`选项不适合您，您可以指定一个输出 WAV（或其他）文件。

注意文件的扩展名很重要。SoX 将[使用扩展](http://sox.sourceforge.net/soxformat.html)来尝试和预测一些通道/bitwdith/采样率参数。`sox -h`将向您显示已识别文件类型的完整列表。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-05T01:34:01.020

常见的 Microsoft WAV 和 Apple AIFF 格式都可以存储 aLaw 和 uLaw 数据。在 WAV 中，aLaw 的格式 ID 为 0x0006，而 uLaw 的格式 ID 为 0x0007。对于 AIFF，相关的编解码器 FourCC 是“alaw”和“ulaw”。

MS WAV 似乎是阻力最小的路径。编写基本的 WAVEFORMATEX 非常简单。也许最棘手的部分，取决于您的程序的架构方式，是在您知道文件中实际有多少样本后，返回到标题部分并填写长度字段。

# html - 在电话模式下隐藏按钮文本 - Bootstrap

> ID：15820321
> 
> 赞同：9
> 
> 时间：2013-04-04T19:44:59.757
> 
> 标签：html, css, twitter-bootstrap

我正在制作一个应用程序，我想在其中隐藏按钮文本，以便在“电话模式”中节省宝贵的空间。所有的按钮都有图标，这样就足够了。

我想有一个纯 css 解决方案，但我想不出任何东西。

这是一个按钮的样子：

```
<button type="submit" name="btnSave" id="btnSave" class="btn btn-primary"><i class="icon-save"></i> Save</button> 
```

我想补充一点，它也可以是：

```
<a class="btn btn-warning"><i class="icon-trash"></i> Delete</a> 
```

所以基本上，如果响应模式是电话，.btn 选择器中的所有文本都应该被隐藏。但是图标需要保留。

我试过`text-ident`了，但这也隐藏了图标。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-04T20:12:54.823

我会使用内置的 twitter bootstrap 类`.hidden-phone`。

```
 <button type="submit" name="btnSave" id="btnSave" class="btn btn-primary">
           <i class="icon-save"></i> <span class="hidden-phone">Save</span>
    </button> 
```

[http://twitter.github.com/bootstrap/scaffolding.html#responsive](http://twitter.github.com/bootstrap/scaffolding.html#responsive)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2015-09-06T16:04:52.417

在引导程序 3 中，`hidden-phone`该类[更改](http://getbootstrap.com/migration/)为`hidden-xs`. 事实上，`hidden-`现在可以与其他设备大小前缀一起使用，例如`lg`,`sm`等等...

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-04T20:11:57.853

这是你想要的吗？

```
<button type="submit" name="btnSave" id="btnSave" class="btn btn-primary">
    <i class="icon-save icon-white"></i>
    <span class="hidden-phone">Save</span>
</button> 
```

`bootstrap-responsive.css`如果它不起作用，请确保您已包含在内。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-09-04T14:37:50.730

对于 Bootstrap 4，您可以使用[display property](https://getbootstrap.com/docs/4.0/utilities/display/)。因此，这些类使用以下格式命名：

```
.d-{value} for xs
.d-{breakpoint}-{value} for sm, md, lg, and xl. 
```

所以你的代码应该是这样的：

```
<button type="submit" name="btnSave" id="btnSave" class="btn btn-primary">
    <i class="icon-save"></i> <span class="d-none d-sm-inline">Save</span>
</button> 
```

对于超小（xs）屏幕，文本将消失：

[![在此处输入图像描述](https://i.stack.imgur.com/SDciu.gif)](https://i.stack.imgur.com/SDciu.gif)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-05-01T06:51:06.353

您可以像这样编写一个简单的 CSS 规则：

```
@media screen and (max-width: 576px) and (min-width: 0px) {
  .desktop-only {
    display: none;
} 
```

进而

```
 <button type="submit" name="btnSave" id="btnSave" class="btn btn-primary">
           <i class="icon-save"></i> <span class="desktop-only">Save</span>
    </button> 
```

# ios - 将带纹理的 3d 模型从 .obj 文件导入到 iOs OpenGL ES 2.0

> ID：15820328
> 
> 赞同：1
> 
> 时间：2013-04-04T19:45:25.353
> 
> 标签：ios, objective-c, opengl-es-2.0, texture-mapping, .obj

我目前正在尝试将带有纹理的 .obj 格式的 3D 模型转换为与 Objective c 兼容的代码，并使用 OpenGL ES 2.0 渲染它们。

我正在使用 Heiko Behrens 的 [obj2opengl][1] 将 3d 模型转换为头文件

3d 模型具有带有[此](http://imageshack.us/photo/my-images/130/boxtexture.jpg)纹理图像的 UV 映射。

一切都差不多了，但不知何故，纹理没有正确渲染，我的立方体显示为[这样](http://imageshack.us/photo/my-images/4/cubebk.png/)。

我尝试了各种各样的事情，但无法弄清楚我做错了什么，或者我就是不明白。

这是我如何渲染立方体的代码：

```
unsigned int boxNumVerts = 36;

float boxVerts [] = {
  // f 1/1/1 2/2/1 3/3/1 4/4/1 
  -0.5, -0.5, 0.5,
  -0.5, -0.5, -0.5,
  0.5, -0.5, -0.5,
  // f 1/1/1 2/2/1 3/3/1 4/4/1 
  -0.5, -0.5, 0.5,
  0.5, -0.5, 0.5,
  0.5, -0.5, -0.5,
  // f 5/5/2 6/6/2 7/7/2 8/8/2 
  -0.5, 0.5, 0.5,
  0.5, 0.5, 0.5,
  0.5, 0.5, -0.5,
  // f 5/5/2 6/6/2 7/7/2 8/8/2 
  -0.5, 0.5, 0.5,
  -0.5, 0.5, -0.5,
  0.5, 0.5, -0.5,
  // f 1/9/3 4/10/3 6/6/3 5/5/3 
  -0.5, -0.5, 0.5,
  0.5, -0.5, 0.5,
  0.5, 0.5, 0.5,
  // f 1/9/3 4/10/3 6/6/3 5/5/3 
  -0.5, -0.5, 0.5,
  -0.5, 0.5, 0.5,
  0.5, 0.5, 0.5,
  // f 4/11/4 3/12/4 7/7/4 6/6/4 
  0.5, -0.5, 0.5,
  0.5, -0.5, -0.5,
  0.5, 0.5, -0.5,
  // f 4/11/4 3/12/4 7/7/4 6/6/4 
  0.5, -0.5, 0.5,
  0.5, 0.5, 0.5,
  0.5, 0.5, -0.5,
  // f 3/13/5 2/14/5 8/8/5 7/7/5 
  0.5, -0.5, -0.5,
  -0.5, -0.5, -0.5,
  -0.5, 0.5, -0.5,
  // f 3/13/5 2/14/5 8/8/5 7/7/5 
  0.5, -0.5, -0.5,
  0.5, 0.5, -0.5,
  -0.5, 0.5, -0.5,
  // f 2/2/6 1/1/6 5/5/6 8/8/6 
  -0.5, -0.5, -0.5,
  -0.5, -0.5, 0.5,
  -0.5, 0.5, 0.5,
  // f 2/2/6 1/1/6 5/5/6 8/8/6 
  -0.5, -0.5, -0.5,
  -0.5, 0.5, -0.5,
  -0.5, 0.5, 0.5,
};

float boxTexCoords [] = {
  // f 1/1/1 2/2/1 3/3/1 4/4/1 
  0.5016, 0.7508,
  0.2504, 0.7508,
  0.2504, 1.002,
  // f 1/1/1 2/2/1 3/3/1 4/4/1 
  0.5016, 0.7508,
  0.5016, 1.002,
  0.2504, 1.002,
  // f 5/5/2 6/6/2 7/7/2 8/8/2 
  0.5016, 0.4996,
  0.5016, 0.2484,
  0.2504, 0.2484,
  // f 5/5/2 6/6/2 7/7/2 8/8/2 
  0.5016, 0.4996,
  0.2504, 0.4996,
  0.2504, 0.2484,
  // f 1/9/3 4/10/3 6/6/3 5/5/3 
  0.7528, 0.4996,
  0.7528, 0.2484,
  0.5016, 0.2484,
  // f 1/9/3 4/10/3 6/6/3 5/5/3 
  0.7528, 0.4996,
  0.5016, 0.4996,
  0.5016, 0.2484,
  // f 4/11/4 3/12/4 7/7/4 6/6/4 
  0.5016, -0.00279999999999991,
  0.2504, -0.00279999999999991,
  0.2504, 0.2484,
  // f 4/11/4 3/12/4 7/7/4 6/6/4 
  0.5016, -0.00279999999999991,
  0.5016, 0.2484,
  0.2504, 0.2484,
  // f 3/13/5 2/14/5 8/8/5 7/7/5 
  -0.0008, 0.2484,
  -0.0008, 0.4996,
  0.2504, 0.4996,
  // f 3/13/5 2/14/5 8/8/5 7/7/5 
  -0.0008, 0.2484,
  0.2504, 0.2484,
  0.2504, 0.4996,
  // f 2/2/6 1/1/6 5/5/6 8/8/6 
  0.2504, 0.7508,
  0.5016, 0.7508,
  0.5016, 0.4996,
  // f 2/2/6 1/1/6 5/5/6 8/8/6 
  0.2504, 0.7508,
  0.2504, 0.4996,
  0.5016, 0.4996,
}; 
```

还有我的渲染代码：

```
-(void)setup
{
    self.drawingMode = GL_TRIANGLES;
    vertexData = [NSMutableData dataWithBytes:boxVerts length:sizeof(float)*boxNumVerts*3];
    textureCoordinateData = [NSMutableData dataWithBytes:boxTexCoords length:sizeof(float)*boxNumVerts*2];
    //    vertexNormalData = [NSMutableData dataWithBytes:PrisonCellNormals length:sizeof(float)*PrisonCellNumVerts*3];
}

-(void)renderInScene:(FRPGScene *)_scene 
{
     if (texture != nil)
        {
            effect.texture2d0.envMode = GLKTextureEnvModeReplace;
            effect.texture2d0.target = GLKTextureTarget2D;
            effect.texture2d0.name = texture.name;
            [effect.texture2d0 setEnabled:YES];
        }

        effect.transform.modelviewMatrix = self.modelviewMatrix;
        effect.transform.projectionMatrix = _scene.projectionMatrix;

        [effect prepareToDraw];

        // setup
        glEnable(GL_BLEND);

        glBlendFunc(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA);

        glEnableVertexAttribArray(GLKVertexAttribPosition);

        glVertexAttribPointer(GLKVertexAttribPosition, 3, GL_FLOAT, GL_FALSE, 0, self.vertices);

        if (!useConstantColor)
        {
            glEnableVertexAttribArray(GLKVertexAttribColor);
            glVertexAttribPointer(GLKVertexAttribColor, 4, GL_FLOAT, GL_FALSE, 0, self.vertexColors);
        }

        if (texture != nil)
        {
            glEnableVertexAttribArray(GLKVertexAttribTexCoord0);
            glVertexAttribPointer(GLKVertexAttribTexCoord0, 2, GL_FLOAT, GL_FALSE, 0, self.textureCoordinates);
        }

        glDrawArrays(drawingMode, 0, self.numVertices);

        glDisable(GL_BLEND);

        // teardown
        glDisableVertexAttribArray(GLKVertexAttribPosition);

        if (!useConstantColor)
        {
            glDisableVertexAttribArray(GLKVertexAttribColor);
        }

        if (texture != nil)
        {
            glDisableVertexAttribArray(GLKVertexAttribTexCoord0);
        }
} 
```

**更新：** 我设置上下文的 appDelegate 函数。

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    EAGLContext *context = [[EAGLContext alloc] initWithAPI:kEAGLRenderingAPIOpenGLES2];
    [EAGLContext setCurrentContext:context];

    GLKView *view = [[GLKView alloc] initWithFrame:[[UIScreen mainScreen] bounds] context:context];
    view.delegate = self; //Makes sure the views drawInRect is called

    FRPGViewController *controller = [[FRPGViewController alloc] init];
    controller.delegate = self;
    controller.view = view;

    self.window = [[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]];
    self.window.rootViewController = controller;
    [self.window makeKeyAndVisible];

    scene = [[FRPGTestLevel alloc] init];

    //Set screen aspect ratio boundaries ipad 4:3 iphone 3:2
    CGRect rect = view.bounds;

    scene.left = -100.0f;
    scene.right = 100.0f;
    scene.bottom = -100.0f / (rect.size.width / rect.size.height); // -75.0..
    scene.top = 100.0f / (rect.size.width / rect.size.height); // 75.0..
    [scene setup];

    [controller setScene:scene];

    return YES;
} 
```

我的场景渲染函数清除缓冲区并在每个对象上调用上述 renderInScene 方法

```
-(void)render
{
     glClearColor(clearColor.r, clearColor.g, clearColor.b, clearColor.a);
     glClear(GL_COLOR_BUFFER_BIT);
     [object renderInScene:scene]; 
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-27T10:04:37.093

您需要设置深度缓冲区

```
GLuint _depthRenderBuffer;

- (void)setupDepthBuffer
{
    glGenRenderbuffers(1, &_depthRenderBuffer);
    glBindRenderbuffer(GL_RENDERBUFFER, _depthRenderBuffer);
    glRenderbufferStorage(GL_RENDERBUFFER, GL_DEPTH_COMPONENT16, self.frame.size.width, self.frame.size.height);
} 
```

然后添加到您的帧缓冲区

```
glFramebufferRenderbuffer(GL_FRAMEBUFFER, GL_DEPTH_ATTACHMENT, GL_RENDERBUFFER, _depthRenderBuffer); 
```

# c# - 从连接表中抓取数据，如果连接表没有结果，仍然抓取数据

> ID：15820329
> 
> 赞同：0
> 
> 时间：2013-04-04T19:45:28.617
> 
> 标签：c#, linq

我有 2 张桌子、员工和办公室，我想退回所有员工，无论他们是否有办公室（没有办公室是新要求）。但如果他们确实有办公室，我想归还所有办公室的详细信息。

现在查询只返回有办公室的员工......这并不理想

```
var employeesDetails = from emp in details.FindEmployeeByLastName(lastName)
join office in details.Offices on emp.EmployeeID equals office.EmployeeID
select new {
    EmpID = emp.EmpID
    OfficeID = (office == null) ? -1 : office.OfficeID,
     //...etc
} 
```

编辑我知道我必须更改此行加入办公室的详细信息。emp.EmployeeID 上的办公室等于 office.EmployeeID 到左外连接...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T19:56:56.677

您正在尝试完成一些在数据库术语中称为“左外连接”的事情。要在 LINQ 中完成此操作，需要使用该`DefaultIfEmpty`方法为缺少的右侧生成默认对象，[如此 MSDN 文章中所述](http://msdn.microsoft.com/en-us/library/vstudio/bb397895.aspx)

在您的情况下，它看起来像：

```
var employeesDetails = from emp in details.FindEmployeeByLastName(lastName)
                       join office in details.Offices on emp.EmployeeID equals office.EmployeeID into offices
                       from empoffice in offices.DefaultIfEmpty()
                       select new {
                         EmpID = emp.EmpID
                         OfficeID = (empoffice == null) ? -1 : empoffice .OfficeID,
                         //...etc
                       } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T19:55:53.543

您可以执行以下操作来规避内部联接：

```
var employeesDetails = from emp in details.FindEmployeeByLastName(lastName)
let office = details.Offices
                    .Where(o => emp.EmployeeID == o.EmployeeID)
                    .FirstOrDefault()
select new {
    EmpID = emp.EmpID
    OfficeID = (office == null) ? -1 : office.OfficeID,
     //...etc
} 
```

# android - 具有圆角和自适应颜色的列表视图项目

> ID：15820335
> 
> 赞同：0
> 
> 时间：2013-04-04T19:45:34.743
> 
> 标签：android, android-listview

我需要通过以下方式自定义列表视图的项目。每个项目都应该有一个圆角，并且项目的背景应该根据当前系统颜色自适应地改变（通过颜色过滤器（PorterDuff）或通过计算适当的 rgb 组件中的颜色偏移 - 这个东西已经编码，这不是主题这个问题，所以让我们假设我有一个特定的颜色可以在运行时用作背景）。

`android:background`我可以通过在项目的布局文件中指定使用以下代码引用形状来轻松应用圆角：

```
<corners android:radius="5dp" /> 
```

问题是，不可能（据我所知）动态调整（从 Java 中）形状中的颜色。因此，我不能使用 XML 定义的形状方法，而是转向使用 Java 编码的解决方案。

我的`getView`方法中有类似的东西（对于背景是颜色而不是可绘制的情况）：

```
PaintDrawable mDrawable = new PaintDrawable();
mDrawable.getPaint().setColor(Color.argb(calcColor, r, g, b));
int px = DP2PX(10);
mDrawable.setCornerRadius(px);
view.setBackgroundDrawable(mDrawable); 
```

It does the thing, but when an item is selected or pressed my custom background overrides default selection background, which is a bug. 所选项目必须以标准选择背景显示，但带有圆角。

我尝试使用`LinearLayout`列表视图项目的子类并覆盖`dispatchDraw`或`onDraw`在其中，但奇怪的是这对角落没有影响。例如，我找到了以下代码：

```
float radius = 10.0f;
Path clipPath = new Path();
RectF rect = new RectF(0, 0, this.getWidth(), this.getHeight());
clipPath.addRoundRect(rect, radius, radius, Path.Direction.CW);
canvas.clipPath(clipPath);
super.dispatchDraw(canvas); 
```

与基于标准的项目相比，这种自定义绘制的视图显示没有任何变化`LinearLayout`。

那么，问题是如何在列表视图项中结合圆角和自适应背景颜色？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T10:30:49.400

我对我的问题有部分解决方案。现在的代码`getView`如下：

```
PaintDrawable mDrawable = new PaintDrawable();
mDrawable.getPaint().setColor(Color.argb(calcColor, r, g, b));
int px = DP2PX(10);
mDrawable.setCornerRadius(px);

Drawable defaultBg = getResources().getDrawable(android.R.drawable.list_selector_background);

StateListDrawable states = new StateListDrawable();
states.addState(new int[] {android.R.attr.state_pressed}, defaultBg);
states.addState(new int[] {android.R.attr.state_focused}, defaultBg);
states.addState(new int[] { },  mDrawable);

view.setBackgroundDrawable(states); 
```

这将为空闲视图应用圆角和自定义颜色，并为按下的视图显示默认选择背景，但后者显示时没有圆角。对于如何在默认选择器上应用圆角的任何建议，我将不胜感激。

# html - 相对定位留有空隙

> ID：15820336
> 
> 赞同：0
> 
> 时间：2013-04-04T19:45:39.300
> 
> 标签：html, css

嗨，我正在尝试使用相对位置将封面 div 放在 profile-top div 后面。但是，由于某种原因，它在封面包装 div 通常去的地方留下了一个空白。我究竟做错了什么？

JSFIDDLE：http: [//jsfiddle.net/QPZEk/1/](http://jsfiddle.net/QPZEk/1/)

CSS：

```
#cover-wrap {
position: relative;
top: -65px;
height: 250px;
width: 470px;
background: url('https://sphotos-a.xx.fbcdn.net/hphotos-    
ash3/540880_10200267172913759_929968936_n.jpg') no-repeat center center; 
-webkit-background-size: cover;
-moz-background-size: cover;
-o-background-size: cover;
background-size: cover;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T20:08:37.367

这就是相对定位的工作原理。该元素最初占用的空间仍然从文档中切出，因此当您调整前一个元素的顶部值时，它下面的元素不会上移。将顶部转换为边距顶部将为您提供所需的效果。

[http://jsfiddle.net/QPZEk/4/](http://jsfiddle.net/QPZEk/4/)

```
#cover-wrap {
    margin-top: -65px;
    height: 250px;
    width: 470px;
    background: url('https://sphotos-a.xx.fbcdn.net/hphotos-ash3/540880_10200267172913759_929968936_n.jpg') no-repeat center center;
    -webkit-background-size: cover;
    -moz-background-size: cover;
    -o-background-size: cover;
    background-size: cover;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-05T00:00:31.720

我喜欢做的是给#cover-wrap 的父级一个位置：相对的。这将允许您的#cover-wrap 具有位置：绝对。具有 position:relative 的父级的子级可以具有 position:absolute，这会将图像绝对放置在相对区域中。

当您给 div 一个 position:absolute 时，您将不再有该边距。它也使得对动态元素执行此操作变得容易。

例子：

```
#parent {
    position:relative;
}

#cover-wrap {
    height: 250px;
    width: 470px;
    background: url('https://sphotos-a.xx.fbcdn.net/hphotos-    ash3/540880_10200267172913759_929968936_n.jpg') no-repeat center center; 
    -webkit-background-size: cover;
    -moz-background-size: cover;
    -o-background-size: cover;
    background-size: cover;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-04T19:52:35.070

您正在将图像从其原始位置移动，这会影响下面的文本。您可以添加负边距，请参阅[http://jsfiddle.net/QPZEk/3/](http://jsfiddle.net/QPZEk/3/)

```
#cover-wrap {
position: relative;
top: -65px;
margin-bottom:-65px;
height: 250px;
width: 470px;
background: url('https://sphotos-a.xx.fbcdn.net/hphotos-ash3/540880_10200267172913759_929968936_n.jpg') no-repeat center center;
-webkit-background-size: cover;
-moz-background-size: cover;
-o-background-size: cover;
background-size: cover;
} 
```

# d3.js - 向时间序列图表添加数据叠加

> ID：15820339
> 
> 赞同：1
> 
> 时间：2013-04-04T19:45:44.433
> 
> 标签：d3.js

d3可以做到这样的[事情](https://www.google.com/finance?q=INDEXDJX%3A.DJI%2CINDEXSP%3A.INX%2CINDEXNASDAQ%3A.IXIC&ei=fNddUejQO6WAlwOElQE)吗？

我想查看鼠标悬停时的具体数据点。我已经为条形图完成了它，但对于时间序列数据来说似乎有点棘手。有谁知道任何例子？

检查[NVD3 主页](http://nvd3.org/)上的一些图表会发现，他们已经添加了一定数量的点，这些点在鼠标悬停时会显示出来。理想情况下，我希望拥有所有这些信息，并将信息显示在一个位置，就像 Google 图表一样。有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T21:18:56.090

有可能的。[有关x 值叠加的示例，](http://bl.ocks.org/mbostock/3902569)请参见此处。

如果你想在鼠标位置以外的地方显示信息，你可以把它放在页面上任何你想要的 div 中。[在此示例](http://bl.ocks.org/andrewStaroscik/4995990)中，div 已填充`.on("click")`，但相同的过程将起作用。`.on("mouseover")`

# asp.net - 使用 MembershipProvider 归档 ASP.Net 用户

> ID：15820340
> 
> 赞同：0
> 
> 时间：2013-04-04T19:45:47.947
> 
> 标签：asp.net, asp.net-membership, archive

使用 MembershipProvider 删除时存档 asp.net 用户是否有最佳实践？

基本上，我想要完成的是，当我使用 MembershipProvider.DeleteUser("someusername@some.com", true) 删除用户时，我希望能够存档其个人资料。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T20:09:34.267

由于（顾名思义）Membership 基于 Provider 模式，您可以轻松实现具有归档功能的 DeleteUser 方法。

对于 SqlMembershipProvider，您可以轻松添加已删除位列并自定义 aspnet_Users_DeleteUser 存储过程以不真正删除用户，而只需设置此位。然后还要修改其他 sprocs 以进行选择等，使其保持一致。检查[http://msdn.microsoft.com/en-us/library/aa478949.aspx](http://msdn.microsoft.com/en-us/library/aa478949.aspx)以了解概述。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T21:07:41.593

由于您使用的是旧版会员服务提供商，因此这里有两种解决方案 -

## 简单的方法

**将 aspnet_Membership**表的**IsApproved**列标记为false **，**这样用户将无法登录。

如果你想这样做，你需要修改**aspnet_Users_DeleteUser**存储过程来更新**IsApproved**列而不是删除用户。

## 艰辛的道路

正如您所说，您不想将 IsDeleted 列添加到**aspnet_Users**表中，创建一个新表来跟踪已删除的用户。

![在此处输入图像描述](https://i.stack.imgur.com/nOLkL.png)

在这里，您还需要修改**aspnet_Users_DeleteUser**存储过程以将UserId**插入****DeletedUsers**表而不是删除用户。

此外，您需要修改**aspnet_Membership_GetPasswordWithFormat**存储过程以进行登录验证。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-04T20:06:04.213

如果你只是这样做会发生什么`Membership.DeleteUser(username,true).`你可能会得到一点提示，要求在 Membership 上添加 using 指令。如果配置正确，则不需要创建新`SimpleMembershipProvider`实例。

如果您像这样动态创建它，则需要在该对象上设置连接并以编程方式对其进行配置（它不知道您在上面创建的连接）。通常人们在 web.config 中执行此操作，但如果您使用表单身份验证模板创建应用程序，那么您应该自动处理该问题。

# sql - 根据连接值有条件地更新记录

> ID：15820345
> 
> 赞同：0
> 
> 时间：2013-04-04T19:45:58.667
> 
> 标签：sql, inner-join

我想知道 SQL 是否可以自己完成此任务，或者我是否应该使用 PHP。

(golf) 数据库有一个`rounds`表和一个`holes`表。 `rounds.id`存储在该轮的洞记录中。

`holes`表有（在许多其他领域中）`firstPutt`, `secondPutt`, `thirdPutt`. 这些是存储距离并默认为零的浮点数。

我的雇主想要做的是在圆桌中存储该轮所有洞的最后一个推杆长度的总和。

我意识到，如果我有一个`putts`表引用`holes.id`，这将是一个更好的结构，但目前这是不可能的。

所以pseudoSQL中的更新会是这样的

```
UPDATE holes h, rounds r
SET r.sumOfLastPutts = (
SELECT thirdPutt if thirdPutt is not 0 
  OR secondPutt if secondPutt is not zero AND thirdPutt is zero 
  OR firstPutt if firstPutt is not zero AND secondPutt is zero)
) WHERE h.round = rounds.id 
```

这可能只使用 SQL 吗？

在此示例中，该轮的数字为 145，即红色框中数字的总和。

![数据](https://i.stack.imgur.com/BiM1S.jpg)

离开马丁帕金的回答，我可以得到这样的单轮总和：

```
SELECT 
SUM(
  CASE
    WHEN h.thirdPutt != 0 THEN h.thirdPutt
    WHEN h.secondPutt != 0 THEN h.secondPutt
    WHEN h.firstPutt != 0 THEN h.firstPutt
  END
)
FROM holes h
WHERE h.round = 3044 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T19:57:42.883

您可以尝试以下方法，这似乎提供了您正在寻找的东西：

```
UPDATE rounds r, holes h
  SET r.sumOfLastPutts =
    CASE
      WHEN h.thirdPutt != 0 THEN h.thirdPutt
      WHEN h.secondPutt != 0 THEN h.secondPutt
      WHEN h.firstPutt != 0 THEN h.firstPutt
    END
  WHERE h.round = r.id; 
```

[这里](http://sqlfiddle.com/#!2/f501c/1)有一个 SQLFiddle 演示。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T21:18:22.693

这可以完成工作：

```
UPDATE rounds r
  SET r.totalPuttDistance = (
    SELECT 
      SUM(
        CASE
          WHEN h.thirdPutt != 0 THEN h.thirdPutt
          WHEN h.secondPutt != 0 THEN h.secondPutt
          WHEN h.firstPutt != 0 THEN h.firstPutt
        END
       )
    FROM holes h
    WHERE h.round = r.id
) 
```

# sql - 按特定顺序排序结果集

> ID：15820349
> 
> 赞同：0
> 
> 时间：2013-04-04T19:46:21.083
> 
> 标签：sql, sql-server-2008

我需要先将我的结果集与“NY”条目分组，然后再将任何其他可能返回的状态条目分组。

例子：

```
OrderID   State   Type   
----------------------------           
123       CA      Checque
123       NY      ELectronic
222       JC      Checque
123       NY      Checque 
```

`OrderID`是主键

结果集需要如下所示：

```
OrderID   State   Type    
----------------------------
123       NY      ELectronic
123       NY      Checque     
123       CA      Checque 
```

对于用户`OrderID = 123`

如果我在下面这样做，它会起作用，但是否可以在不使用联合的情况下做同样的事情。

我正在为大量记录执行此操作。

它使用：

```
Select * from Table1 where orderid = 123 and State = 'NY'
Union
Select * from Table1 where orderid = 123 and State <> 'NY' 
```

使用 SQL Server 2008

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T19:49:14.037

在查询结束时试试这个：

```
order by (case when state = 'NY' then 0 else 1 end),
         state 
```

作品是偶然的事实`union`——完全不能保证。排序结果的唯一方法是`order by`在查询的最外层指定一个子句。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T19:51:46.100

您可以使用`case`语句到达顶部，`'NY'`然后按如下所示：`State``Type desc`

**[小提琴演示](http://sqlfiddle.com/#!3/39a2a/3)**

```
select OrderID, State, Type
from T
where orderID = 123
order by case when State = 'NY' then '0' else State end, Type desc 
```

# php - PHP 正则表达式中任何字符的正确语法是什么？我的例子不起作用

> ID：15820350
> 
> 赞同：0
> 
> 时间：2013-04-04T19:46:23.287
> 
> 标签：php, html, regex, preg-replace

我有一段 html 代码作为字符串：

```
<input id="an_id" name="a_name" value="some_value" class="a_class" type="text"/> 
```

我想用正则表达式和 preg_replace 去掉 name 属性及其值：

```
preg_replace('/name\="(.*)"/', '', $html, 1); 
```

但这输出：

```
<input id="an_id" /> 
```

有谁能够帮助我？为什么删了那么多？正则表达式`name`用于属性，`(.*)`因为我不在乎值中的 char 是什么。什么都可以。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T19:52:40.393

让它变得不贪婪（请参阅[可能的修饰符](http://www.php.net/manual/en/reference.pcre.pattern.modifiers.php)）：

```
preg_replace('/name\="(.*)"/U', '', $html, 1); 
```

结果：

```
<input id="an_id"  value="some_value" class="a_class" type="text"/> 
```

或者正如@John Conde 评论的那样，使用[DOM Parser](http://php.net/manual/en/class.domdocument.php)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T19:53:20.560

您不是要匹配*任何*字符，而是要查找除`"`. 此外，捕获组`()`不是必需的，因为您没有在替换中使用该值，而且我不知道您为什么要转义`=`，因为它不是特殊字符。

```
preg_replace('/name="[^"]*"/', '', $html, 1); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-04T19:53:24.407

原始的，但它应该让你继续前进。

```
<?php
function remove_attribute($attribute, $html) {
    return preg_replace(
        sprintf('~%s="[^"]+"\s?~', preg_quote($attribute)),
        null,
        $html
    );
}

$html = '<input id="an_id" name="a_name" value="some_value" class="a_class" type="text"/>';
echo remove_attribute('name', $html);
/*
    <input id="an_id" value="some_value" class="a_class" type="text"/>
*/ 
```

# c++ - 这是未定义的行为吗？你会怎么看？

> ID：15820353
> 
> 赞同：0
> 
> 时间：2013-04-04T19:46:38.920
> 
> 标签：c++

受到这篇文章的回答的启发。[为什么这是 NaN](https://stackoverflow.com/questions/15819836/why-is-this-nan)

我有以下代码：

```
int main()
{
   const int weeks = 10;
   const int salespersons = 9;
   const int days = 30;

   double weekly_sales[weeks][salespersons][days];
   double total_weekly_sales[weeks];
   double total_overall_weekly_sales[salespersons];
   int a;
   cout << "a = " << a <<endl;
   cout << total_weekly_sales[0] <<endl; 
   for(int w=0; w < weeks;w++)
   {
      for(int d =0; d < days; d++)
      {  
          for(int s=0; s < salespersons; s++)
          {
              total_weekly_sales[w]+=weekly_sales[w][s][d];
              total_overall_weekly_sales[s]+= weekly_sales[w][s][d];
          }
       }  
    }
 cout << total_weekly_sales[0] <<endl;
} 
```

它将输出以下内容：

```
a = 0
0
0 
```

在 gcc 4.5.3 下，带有编译选项`-Wall`.

我还在这里编译了代码：http: [//liveworkspace.org/code/94SOj](http://liveworkspace.org/code/94SOj) $2。与上面相同的输出。

我也在VS2010下编译了代码。VS2010 给出警告如下：

```
warning C4700: uninitialized local variable 'a' used
warning C4700: uninitialized local variable 'total_weekly_sales' used 
```

当我跑的时候：

```
Run-Time Check Failure #3 - The variable 'a' is being used without being initialized. 
```

我知道不初始化局部变量并使用它们是不好的做法。我也明白这会有问题。

我的问题是：

在 C++ 标准中：有没有地方说使用未初始化的局部变量会导致未定义的行为？为什么它在不同的编译器下表现不同？这是否意味着该标准实际上并未强制要求所有编译器都应针对`using uninitialized local variable`? 那么，您如何从编译器输出中判断它是未定义的行为呢？

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-04T19:48:14.787

是的，该标准明确指出未初始化对象上的左值到右值转换将导致未定义的行为：

> 非函数、非数组类型的 glvalue (3.10)`T`可以转换为纯右值。如果`T`是不完整类型，则需要进行此转换的程序格式错误。如果泛左值引用的对象不是 T 类型的对象，也不是从 T 派生的类型的对象，或者如果该对象未初始化，则需要此转换的程序具有未定义的行为。

任何需要使用对象值的东西都会调用左值到右值的转换。

未定义的行为定义为：

> 本国际标准没有要求的行为

所以是的，一个具有未定义行为的程序可以做任何事情，即使它看起来工作正常。所以你不能总是从程序的输出中识别出未定义的行为。**真正的解决方案是编写正确的、定义明确的代码。**为此，我强烈建议您随身携带一份 C++ 标准的副本。编写代码并对它的作用做出假设是一件非常糟糕的事情，所以如果你写过任何你不确定的 C++，一定要检查一下。

为什么标准中存在未定义的行为？首先，这意味着你真的只能得到你想要的。如果将未初始化的变量定义为自动获取值 0（例如），则您声明未初始化的每个变量都将有一些额外的操作将值设置为 0，这可能是不需要的。该标准简单地说，使用未初始化变量的值是未定义的，允许它留下已经存在于该内存位置的垃圾值。无需额外费用。

其次，它允许编译器基于任何 C++ 程序员都会编写理智、定义明确的代码的假设进行优化。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T19:50:15.327

未定义的行为就是这个意思。行为未定义。有些编译器会很好并警告你，有些编译器会做一些疯狂的事情。从理论上讲，他们可以在这种情况下擦除您的硬盘驱动器，但这将是一个非常糟糕的编译器。

具体来说，未初始化的变量可以具有任何值。实际上，如果您的程序刚刚启动，它通常为 0（操作系统提供的一项安全功能，用于阻止您的程序从旧程序读取内存），但是一旦运行了一段时间，它很有可能是一个完全随机的值，因为内存以前被另一个函数使用过。因此发出警告。如果您忽略它，您的程序将无缘无故地随机失败。

# javascript - 解析 JSON 响应

> ID：15820357
> 
> 赞同：3
> 
> 时间：2013-04-04T19:46:51.030
> 
> 标签：javascript, json, parsing

我从一个已经过验证的服务器得到这个 JSON 响应，但我无法用我当前的代码解析它。它一直说数据是“未定义的”。有人知道出了什么问题吗？

这是 JSON：

```
 {
       "response": {
           "status": {
               "version": "4.2",
               "code": 0,
               "message": "Success"
           },
           "artists": [
               {
                   "name": "Radiohead",
                   "id": "ARH6W4X1187B99274F"
               },
               {
                   "name": "Radioheadheadhead",
                   "id": "ARKVYRS126DD652B02"
               },
               {
                   "name": "Radiohead Lullabies",
                   "id": "ARHYPRQ11F4C83D230"
               },
               {
                   "name": "Radioheadheadheadheadhead",
                   "id": "ARPMOVZ126DD9A5A25"
               },
               {
                   "name": "Radiohead Tribute - Meeting in the Aisle",
                   "id": "ARVOZQT11E8F5C12BA"
               },
               {
                   "name": "On a Friday",
                   "id": "ARZNOIY1187B989D9C"
               },
               {
                   "name": "Wonky vs. Radiohead",
                   "id": "AR26WWW1187FB40070"
               },
               {
                   "name": "Meeting in the Aisle: a Tribute to the Music of Radiohead",
                   "id": "ARVGJEW11E8F5C0E4E"
               }
           ]
       }
   } 
```

这是我写的代码不起作用。我故意从代码中删除了键值，因为它应该是机密的。另外，我确实意识到 hotttnesss 拼写错误。这就是他们拼写的方式。

```
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Project</title>
<script>

var apiUrl = "http://developer.echonest.com/api/v4/artist/";
var key = "*****";
var format = "format=json";

function callApi(method, arguments, callBack){
var requestUrl = apiUrl+method+key+format+"&"+arguments;
try{
var request = new XMLHttpRequest();
request.addEventListener("readystatechange",
function() {callBack(request);}, false);
request.open("GET", requestUrl, true);
request.setRequestHeader("Accept", "application/json; charset=utf-8");
request.send();
}//end try
catch(exception){
alert("Request Failed");
}//end catch
}// end function callApi

function parseData(request){
if(request.readyState==4 && request.status==200){
var data = JSON.parse(request.responseText);
displayNames(data);
}//end if
}// end function parseData

function displayNames(data){
var listbox = document.getElementById("artists");
listbox.innerHTML = "";
for(var i=0; i<data.length; i++){
var entry = document.createElement("div");
var field = document.createElement("fieldset");
entry.onclick = function() { getGenre(this, this.id);
getHotttnesss(this, this.id);
getSimilar(this, this.id);
getNews(this, this.id);};
entry.number = i;
entry.innerHTML = data[i].name + data[i].id;
field.appendChild(entry);
listbox.appendChild(field);
}//end for
}//end function displayNames

function search(input){
var listbox = document.getElementById("artists");
listbox.innerHTML = "";
callApi("search", "name="+input, parseData);
}//end function search

function getGenre(entry, id){
var requestUrl = apiUrl+"profile"+key+id+"&bucket=genre&"+format;
try{
var request = new XMLHttpRequest();
request.addEventListener("readystatechange",
function() {displayGenre(entry, request);}, false);
request.open("GET", requestUrl, true);
request.setRequestHeader("Accept", 
"application/json; charset=utf-8" );
request.send();
}//end try
catch(exception){
alert("Request Failed");
}//end catch
}//end function getGenre

function displayGenre(entry, request){
if(request.readyState==4 && request.status ==200){
var data = JSON.parse(request.responseText);
var name = entry.innerHTML;
entry.innerHTML = name +"<br>"+data.genre;
}//end if
}//end function displayGenre

function getHotttnesss(entry, id){
var requestUrl = apiUrl+"hotttnesss"+key+id+"&"+format;
try{
var request = new XMLHttpRequest();
request.addEventListener("readystatechange",
function() {displayHotttnesss(entry, request);}, false);
request.open("GET", requestUrl, true);
request.setRequestHeader("Accept", 
"application/json; charset=utf-8" );
request.send();
}//end try
catch(exception){
alert("Request Failed");
}//end catch
}//end function getHotttnesss

function displayHotttnesss(entry, request){
if(request.readyState==4 && request.status ==200){
var data = JSON.parse(request.responseText);
var name = entry.innerHTML;
entry.innerHTML = name +"<br>"+data.hotttnesss;
}//end if
}//end function displayHotttnesss

function getSimilar(entry, id){
var requestUrl =apiUrl+"similar"+key+id+"&"+format+"results=3";
try{
var request = new XMLHttpRequest();
request.addEventListener("readystatechange",
function() {displaySimilar(entry, request);}, false);
request.open("GET", requestUrl, true);
request.setRequestHeader("Accept", 
"application/json; charset=utf-8" );
request.send();
}//end try
catch(exception){
alert("Request Failed");
}//end catch
}//end function getSimilar

function displaySimilar(entry, request){
if(request.readyState==4 && request.status ==200){
var data = JSON.parse(request.responseText);
var name = entry.innerHTML;
entry.innerHTML = name +"<br>"+data.similar;
}//end if
}//end function displaySimilar

function getNews(entry, id){
var requestUrl = apiUrl+"news"+key+id+"&"+format+"&results=3";
try{
var request = new XMLHttpRequest();
request.addEventListener("readystatechange",
function() {displayNews(entry, request);}, false);
request.open("GET", requestUrl, true);
request.setRequestHeader("Accept", 
"application/json; charset=utf-8" );
request.send();
}//end try
catch(exception){
alert("Request Failed");
}//end catch
}//end function getNews

function displayNews(entry, request){
if(request.readyState==4 && request.status ==200){
var data = JSON.parse(request.responseText);
var name = entry.innerHTML;
entry.innerHTML = name +"<br>"+data.news;
}//end if
}//end function displayNews

function start(){
document.getElementById("artistName").addEventListener("keyup",
function(){search(this.value);}, false);
}//end function start

window.addEventListener("load", start, false);
</script>
</head>

<body>
<div>
<p>Search Artist<input id="artistName">
<div id="artists"></div>
</div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T03:42:58.060

`for`你不能用（至少不正确）迭代一个对象。在我看来，你想迭代`artists`：

```
function displayNames(data) {
    var artists = data.response.artists;
    /* snip */
    entry.innerHTML = artists[i].name + artists[i].id;
    /* snip */
} 
```

# sql - 从另一个表中引用数据，通过外键连接

> ID：15820358
> 
> 赞同：0
> 
> 时间：2013-04-04T19:46:53.127
> 
> 标签：sql, reference, key

我正在构建一个社交网站，其中每个用户都属于一个特定的组。主页（可以说是“新闻提要”）显示他们组内任何人的最新帖子。因此，我需要从与登录用户的组 ID 匹配的人那里获取任何故事。

stories 表包含几列，其中之一是 poster_id（它被 FK 约束到 users 表中的 ID 列），并且 user 表也有一个列 group_id。本质上，我需要做的是：

```
SELECT * FROM stories WHERE poster_id.group_id = '$logged_in_user_group' 
```

但显然我不能通过poster_id直接引用group_id。将“回溯”到用户表中的最简单方法是什么，以便我可以比较 group_id？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T19:50:45.860

您正在寻找“加入”：

```
select stories.*
from stories
join poster on poster.poster_id = stories.poster_id
where poster.group_id = '$logged_in_user_group' 
```

# c# - 解析大文本文件 Python vs c#

> ID：15820361
> 
> 赞同：-3
> 
> 时间：2013-04-04T19:47:18.110
> 
> 标签：c#, python, regex, parsing

解析 8GB 文本文件的最快方法是什么？Python 的性能会与 c# 相媲美吗？

```
exampledomain NS ns.anameserver.com.
exampledomain NS ns2.anameserver.com.
exampledomain NS ns3.anameserver.com.
anotherdomain NS ns1.nameservers.com.
cooldomain NS ns.example.com.
cooldomain NS ns2.example.com. 
```

我需要解析每一行并使用每行的第一项和第三项更新数据库表，忽略每行中的 NS。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-04T19:53:06.817

解析性能几乎肯定在这里完全无关紧要。我希望这些贡献是这样的：

*   用于写入数据的数据库访问
*   用于读取数据的磁盘访问
*   用于解析的 CPU

按这个顺序，每个子弹之间很可能有一个数量级的差异，这取决于数据库是否是本地的（以及网络的速度等）和磁盘类型（如果它是 SSD 会快得多） .

我希望 Python 和 C# 都能很好地做到这一点，假设它们都有相当高效的数据库驱动程序，用于您正在与之交谈的任何数据库 - 使用您会发现更容易维护的任何语言。

请注意，虽然您当然可以利用*一些*并行性，但如果网络最终成为瓶颈，它可能不会产生太大影响。批处理数据库写入可能更重要 - 这是您应该尝试的一点，IMO。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T20:15:30.737

像这样的东西会起作用：

```
ins = open( "file.txt", "r" )
for line in ins:
    linesplit = line.split(" ")
    # linesplit should contain your 3 elements which you can then insert into your db 
```

*   如果您需要先修剪线条，您可以使用 trim

性能限制很可能是您的数据库写入/插入速度。

如果您使用的是 mysql，则可以使用“插入延迟”来加快插入过程，因为这将分派查询并立即返回。

您还可以在插入时禁用索引（如果不需要主/唯一），这也应该加快数据库插入性能。

如果您正在进行更新，请确保您的查找列已编入索引。

在c#中会是这样的

```
using System;
using System.IO;

class Program {
    static void Main() {
        StreamReader sr = new StreamReader("file.txt");
        while ((line = sr.ReadLine()) != null) {
             string[] linesplit = line.Split(' ');
             // linesplit has your elements, do your db stuff
        }
    }
} 
```

我想这两种语言之间的性能实际上是相同的，并且内存占用开销优于 c#。您应该同时尝试并报告。

# scala - 在 Kiama/Scala 中有条件地重写术语

> ID：15820362
> 
> 赞同：2
> 
> 时间：2013-04-04T19:47:18.250
> 
> 标签：scala, rewriting, kiama

我正在尝试在 Kiama 中实现“承诺选择”操作（以及以类似方式工作的其他一些功能）。

我想重写一个术语，如果它的一个子术语可以被成功重写（这个想法是，一旦你启动任一分支，你就已经承诺了）。

目前，我可以这样做：

```
import org.kiama.rewriting.Rewriter
import org.junit.Test

case class B(l:L,r:L)
case class L(s:String)
class RewriteExperiment extends Rewriter {
  def r1 = rule {
    case L(l) if l.s == "X" => L("Did stuff")
  }

  def r2 = strategy {
    case B(l,r) => r1(l) match {
      case Some(x:L) => Some(B(x,"Avoided"))
      case _ => None
    }
  }

  implicit def s2l(s:String) : L = L(s)
}

class RewriteTest extends RewriteExperiment {
  @Test
  def testPruning : Unit = {
    println( rewrite(r2)(B("P","b")) )
    println( rewrite(r2)(B("X","b")) )
  }
} 
```

所以 r2 只有在它可以成功地将 r1 应用于第一个子项时才会触发。

这感觉不太像 Kiama-ish。我觉得我应该使用同余，但我无法从文档中弄清楚它们是如何工作的。

谁能建议一种更优雅和 Kiamaish 的方式来做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-08T10:38:06.067

一致性是一种方式，但不幸的是在 Kiama 他们需要一些样板。如果您想朝那个方向发展，请参阅 Kiama 的 lambda2 示例。AST.scala 为树节点类型定义同余，ParLazySubst.scala 等文件使用它们来定义策略。例如，在 中`App (s, id)`，如果 s 在节点的第一个子节点上成功`App`，则`App (s, id)`策略在节点上成功（是恒等策略）。`App``id`

另一种方法是使用`child`which 是单个孩子的通用同余，您可以通过给出其编号来说明要对哪个孩子进行操作。（或者，如果您不知道它是哪个孩子，或者您想对多个孩子进行操作，您可以使用`all`、`one`或`some`。）

例如，我认为以下是执行上述操作的更清晰方法：

```
 def r1 =
    rule {
      case L (l) if l.s == "X" => L ("Did stuff")
    }

  def r2 =
    rule {
      case B (l, r) => B (l, "Avoided")
    }

  val r3 = (child (1, r1)) <* r2 
```

然后使用 r3。

请注意，子 (...) 策略对原始输入项进行操作，因此我们可以使用正常排序 (<*) 来决定是否也将 r2 应用于该项。此解决方案更具组合性，因为 r2 不必知道有关 r1 的任何信息。

# facebook - facebook sdk 3 移动应用程序在 actionscript 中安装广告

> ID：15820363
> 
> 赞同：1
> 
> 时间：2013-04-04T19:47:25.390
> 
> 标签：facebook, mobile, actionscript, sdk, air

我正在 Adob​​e AIR 中制作移动应用程序，但找不到集成新 facebook 功能的解决方案。Facebook 和 Adob​​e 都支持一个库[https://code.google.com/p/facebook-actionscript-api/](https://code.google.com/p/facebook-actionscript-api/)但它缺少很多新的 sdk 部分。

特别是我有兴趣让移动应用安装广告正常工作。希望我并不孤单，有人也有类似的问题。在我看来有几个变种：​​1\. 将 java sdk 代码移植到 actionscript 2\. 创建一个扩展

欢迎任何想法，建议，解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-22T21:35:48.400

我正在寻找做同样的事情。据我所知，除了从移动 SDK 移植 publishInstall 代码外，没有其他办法。我喜欢 Android SDK 版本。

以下代码来自 Settings.java：

```
 GraphObject publishParams = GraphObject.Factory.create();
        publishParams.setProperty("event", "MOBILE_APP_INSTALL");
        publishParams.setProperty("attribution", attributionId);
        publishParams.setProperty("auto_publish", isAutoPublish);
        publishParams.setProperty("application_tracking_enabled", !AppEventsLogger.getLimitEventUsage(context));
        publishParams.setProperty("application_package_name", context.getPackageName());

        String publishUrl = String.format(PUBLISH_ACTIVITY_PATH, applicationId);
        Request publishRequest = Request.newPostRequest(null, publishUrl, publishParams, null); 
```

它看起来像是一个直接的复制请求。我会尽量记住在完成后更新它。

# ruby-on-rails - 在 Rails 视图中使用 Each_Slice

> ID：15820371
> 
> 赞同：0
> 
> 时间：2013-04-04T19:48:03.223
> 
> 标签：ruby-on-rails, ruby

我有一个模型，我想在两列中显示文章。看起来 each_slice 会拆分数组，但我不确定如何应用它。当我尝试`each_slice`在我的视图中使用时，我无法让它工作。

在我的控制器中：

```
@articles = Article.order("title ASC") 
```

在我看来，我想替换：

```
<% @articles.each do |article| %> 
```

有了这个：

```
<% @articles.each_slice((@articles.size/2.0).ceil) { |slice| puts slice } if @articles.size > 0 do |article| %> 
```

使用此答案中的代码： [RoR show elements in two columns](https://stackoverflow.com/questions/1798579/ror-show-elements-in-two-columns/1798767#1798767)

我正在尝试制作两列文章标题，其中前半部分位于第 1 列，而后半部分位于第 2 列（按标题字母顺序排序）。有人可以帮我理解我做错了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T20:02:07.387

目前尚不清楚您是要尝试在输出中的两个可视列中显示文章的单个实例，还是在两列中显示文章实例的列表。您的代码将指示后者，但您的文本指示前者。

假设是后者，您不应该使用表格来显示非表格数据，特别是如果您打算将两列用于相同的数据。而是使用有序列表和适当的 CSS 来处理跨两列的显示，这可以根据您的需要以多种方式处理（具有固定宽度和固定容器宽度的内联块元素将是一种非常友好的方法） .

如果您确实需要使用 n 进行迭代，`each_slice`则需要检查文档，`each_slice`这样您就不会像在这里一样将错误的参数传递给它。您似乎希望将文章数组按顺序分成两列（即它们以 1 和 2 水平对齐的方式出现），因此您只需调用`@articles.each_slice(2) { |(article_a, article_b)| article_a.name, article_b.name }`.

链接的答案以您的标记无法处理的方式拆分数据，提供两个未指定长度的数组，基本上分成两半。然后，您将遍历每个结果列表以显示它们，可能在单独的包含元素中。

# xml - XSD 模式处理两个值之一

> ID：15820378
> 
> 赞同：0
> 
> 时间：2013-04-04T19:48:24.330
> 
> 标签：xml, xsd, switch-statement

我正在创建一个 xsd 架构来支持以下 xml 结构：

```
<Switch code="enable'>
 .....more..stuff.....
</Switch> 
```

这是它在模式中的声明方式

```
 <xs:element name="Switch minOccurs="1" maxOccurs="1">
      <xs:complexType>
         ................
        <xs:attribute type="xs:string" name="Code" use="required"/>
      </xs:complexType>
    </xs:element> 
```

现在 Switch code 的值只能是“enable”或“disable”。在我的 xsd 模式中，我将如何指定它只能是其中一个值？这是可能的还是我需要使用诸如 C# 之类的编程语言来处理这个问题？

如果有人可以帮助我，我将不胜感激。

谢谢，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T19:58:08.703

您可以在 XML 模式中定义枚举类型：

```
<xs:simpleType name="enableDisable">
  <xs:restriction base="xs:string">
    <xs:enumeration value="enable" />
    <xs:enumeration value="disable" />
  </xs:restriction>
</xs:simpleType> 
```

有了它，您可以使用此类型而不是`xs:string`属性

```
<xs:attribute type="enableDisable" name="Code" use="required"/> 
```

（如果您的架构有一个，它可能需要一个前缀`targetNamespace`）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T20:11:03.723

请参阅 Ian answer ... 或直接不声明命名类型：

```
<xs:element name="Switch" minOccurs="1" maxOccurs="1">
  <xs:complexType>
     ................
    <xs:attribute name="Code" use="required">
      <xs:simpleType>
        <xs:restriction base="xs:string">
          <xs:enumeration value="enable" />
          <xs:enumeration value="disable" />
        </xs:restriction>
      </xs:simpleType>
    </xs:attribute>
  </xs:complexType>
</xs:element> 
```

# java - 在 derby 中使用身份 id 导入数据

> ID：15820386
> 
> 赞同：2
> 
> 时间：2013-04-04T19:48:49.437
> 
> 标签：java, sql, derby

我正在使用`SYSCS_IMPORT_DATA`. 我的表有一个我想保留的标识列，因为它在其他表中被引用。

我不断收到错误：

> 尝试修改标识列

使用以下调用

```
CALL SYSCS_UTIL.SYSCS_IMPORT_DATA (NULL,'TABLE',NULL,NULL,'DATA.DEL',NULL,NULL,NULL,0); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T20:12:43.877

好吧，我找到了我的答案。问题是表，只是将 GENERATED ALWAYS 更改为 GENERATED BY DEFAULT。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-25T16:38:51.500

您可以在表格中保留“始终生成”。解决方案是您必须在调用中指定要在表中导入的那些列，不包括那些作为标识列的列。

例子：

CALL SYSCS_UTIL.SYSCS_IMPORT_DATA (null, 'STAFF', 'NAME,DEPT,SALARY,PICTURE', '2,3,4,6', 'c:\data\staff.del', ',','"', 'UTF-8', 0);

调用的第三个参数是列名，第四个参数是它们在表中的顺序。

此链接的更多信息：

[http://db.apache.org/derby/docs/10.6/tools/ctoolsimportidentitycol.html](http://db.apache.org/derby/docs/10.6/tools/ctoolsimportidentitycol.html)

希望这对未来有所帮助，马科斯。

# php - SMTP，哪一个是正确的答案？

> ID：15820396
> 
> 赞同：-2
> 
> 时间：2013-04-04T19:49:07.520
> 
> 标签：php, email, smtp

“最初是作为主机到主机协议发明的，通过 SMTP 身份验证，用户必须识别自己，并且在成功身份验证后，他/她的电子邮件的接收/传输被授予。”

= 或 ==

SMTP AUTH 的工作方式与 Outlook 或任何其他邮件客户端完全相同？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T19:53:55.077

完全一样——你提供一个用户名、密码和域来发送。[在http://phpmailer.worxware.com/index.php?pg=examplebsmtp](http://phpmailer.worxware.com/index.php?pg=examplebsmtp)查看一个很好的例子

# javascript - 随机空格？

> ID：15820397
> 
> 赞同：1
> 
> 时间：2013-04-04T19:49:09.190
> 
> 标签：javascript, html, css, twitter-bootstrap

## 固定/已解决

感谢@Steve，这是解决方案：

> 我相信这是由于各个盒子之间的高度略有不同。由于它们都是浮动的，所以稍微高一点的第一个框会使第二行中的第一个框在第一个框占用的额外空间之后开始。
> 
> 确保它们都被迫具有完全相同的高度。

* * *

## 问题

我不知道为什么会这样 - 我正在开发的网站突然开始出现这些奇怪的空间？（红框已添加到 s

知道为什么会发生这种情况或如何解决吗？不只是在这个地方，我正在构建另一个随机添加空白区域的页面？

如果我更改`max-width`图像上的属性，每隔一个像素就会将不合适的像素放回原位？

我正在查看

**铬/火狐/Safari**：`Mozilla/5.0 (Macintosh; Intel Mac OS X 10_8_3) AppleWebKit/537.31 (KHTML, like Gecko) Chrome/26.0.1410.43 Safari/537.31`

![奇怪的事情](https://i.stack.imgur.com/WdE0a.png)

## HTML

```
<div class="container">
<div class="span12" style="margin-top: -15px; margin-bottom: 10px;">
    <div class="span10" style="margin: 0px auto; float: none;">
        <a href="/news-and-media"><img src="" alt="Magazines and blogs" class="span3 front-page-tile pull-left"></a>
        <a href="/how-to-use"><img src="" alt="How to use" class="span3 front-page-tile pull-left"></a>
        <a href="/store"><img src="" alt="Products" class="span3 front-page-tile pull-left"></a>
        <a href="/endorsements"><img src="" alt="Endorsements" class="span3 front-page-tile pull-left"></a>
        <a href="/before-after"><img src="" alt="Before and After" class="span3 front-page-tile pull-left"></a>
        <a href="/doctor-recommended"><img src="" alt="Doctor Recomended" class="span3 front-page-tile pull-left"></a>
        <div class="clearfix"></div>
    </div>
</div>
<div class="clearfix"></div>
</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T19:51:58.807

我相信这是由于各个盒子之间的高度略有不同。由于它们都是浮动的，所以稍微高一点的第一个框会使第二行中的第一个框在第一个框占用的额外空间之后开始。

确保它们都被迫具有完全相同的高度。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T19:53:05.553

尝试将此样式添加到您的样式表中。

```
.span10 a{vertical-align: top;} 
```

或者如果你想继续使用 inline-stlyes，添加 style="vertical-align: top;" 到你的每一个锚。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-04T19:54:56.443

这只是一个猜测，因为我目前看不到您的 CSS，但您是否尝试过使用`display:inline-block;`( `zoom:1;*display:inline;`-修复旧版本的 IE) 作为您的链接？

# macos - 使用Matlab在特定坐标中打开窗口？

> ID：15820403
> 
> 赞同：1
> 
> 时间：2013-04-04T19:49:33.143
> 
> 标签：macos, matlab, window, organization

我的代码使用以下命令打开 4 个文本文件：

```
system('open 1.txt'); %using MAC OS
system('open 2.txt');
system('open 3.txt');
system('open 4.txt'); 
```

并将它们显示为堆叠顺序：

![在此处输入图像描述](https://i.stack.imgur.com/6US1p.png)

但我想像这样向他们展示：

![在此处输入图像描述](https://i.stack.imgur.com/e1vsu.png)

这可能使用 matlab 吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T21:22:45.583

不使用纯Matlab，不。真的，您需要研究如何在 osx 中以编程方式重新定位窗口，然后编写一个程序/mexFunction 将该部分包装起来供 Matlab 调用。

在 Windows 系统上，我可能会寻找相关的 Windows API 调用，对于 Mac，我不确定。希望SO上的其他人知道。

# sql - sql插入带有选择案例值的表

> ID：15820405
> 
> 赞同：17
> 
> 时间：2013-04-04T19:49:36.463
> 
> 标签：sql, sql-server-2008

出于某种原因，我对这个陈述有疑问

```
Insert into TblStuff
(FullName,Address,City,Zip)

Select
Case
When Middle is Null Then Fname + LName as FullName,
Else Fname +' ' + Middle + ' '+ Lname as FullName,
End
Case
When Address2 is Null Then Address1 as Address,
else Address1 +', ' + Address2 as  Address,
End
City as City,
Zip as Zip
from tblImport 
```

我在关键字“as”附近收到不正确的语法

编辑添加到这个问题，让我知道是否需要添加新帖子。

我知道下面的陈述有点不同，但你能做一个类似于下面的案例陈述吗？下面的陈述甚至有意义吗？

```
Insert into TblStuff
    (NickName,FirstName,MiddleName,Suffix)

    Case when FirstName IS NULL then 
        NickName as Nickname,
        IsNULL(FirstName,'''') as FirstName,
        IsNULL(MiddelName,'''') as MiddleName,
        IsNULL(NameSuffix,'''') as Suffix,
    Else
        IsNull(NickName2,'''') as NickName,
        IsNULL(FirstName,'''') as FirstName,
        IsNULL(MiddelName,'''') as Middlename,
        Case when NameSuffix2 is NULL then
            IsNULL(NameSuffix,'''')as suffix,
        Else
            IsNULL(NameSuffix,'''') + '''', '''' + IsNULL(NameSuffix2,'''') as suffix,
        End
    End
From tblImport 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-04-04T19:51:41.500

`end`完成 case 语句后需要逗号。而且，“as”在`case`语句之后，而不是在它里面：

```
Insert into TblStuff(FullName, Address, City, Zip)
    Select (Case When Middle is Null Then Fname + LName
                 Else Fname +' ' + Middle + ' '+ Lname
            End)  as FullName,
           (Case When Address2 is Null Then Address1
                 else Address1 +', ' + Address2
            End)  as  Address,
           City as City,
           Zip as Zip
    from tblImport 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-04-04T19:52:25.553

您在案例内部有别名，它需要在以下内容之外`END`：

```
Insert into TblStuff (FullName,Address,City,Zip)
Select
  Case
    When Middle is Null 
    Then Fname + LName
    Else Fname +' ' + Middle + ' '+ Lname
  End as FullName,
  Case
    When Address2 is Null Then Address1
    else Address1 +', ' + Address2 
  End as  Address,
  City as City,
  Zip as Zip
from tblImport 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-04T20:38:08.943

您也可以使用[COALESCE](http://msdn.microsoft.com/en-us/library/ms190349.aspx)代替 CASE 表达式。因为将任何东西连接到 NULL 的结果，甚至它本身，总是 NULL

```
INSERT TblStuff(FullName,Address,City,Zip)
SELECT COALESCE(Fname + ' ' + Middle + ' ' + Lname, Fname + LName) AS FullName,
       COALESCE(Address1 + ', ' + Address2, Address1) AS Address, City, Zip
FROM tblImport 
```

[**SQLFiddle**](http://sqlfiddle.com/#!3/5af31/3)上的演示[](http://sqlfiddle.com/#!3/5af31/3)

 *** * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-04T21:32:01.970

If FName and LName contain NULL values, then you will need special handling to avoid unnecessary extra preceeding, trailing, and middle spaces. Also, if Address1 contains NULL values, then you need to have special handling to prevent adding unnecessary ', ' at the beginning of your address string.

If you are using SQL Server 2012, then you can use CONCAT (NULLs are automatically treated as empty strings) and IIF:

```
INSERT INTO TblStuff (FullName, Address, City, Zip)
SELECT FullName = REPLACE(RTRIM(LTRIM(CONCAT(FName, ' ', Middle, ' ', LName))), '  ', ' ')
    , Address = CONCAT(Address1, IIF(Address2 IS NOT NULL, CONCAT(', ', Address2), ''))
    , City
    , Zip
FROM tblImport (NOLOCK); 
```

Otherwise, this will work:

```
INSERT INTO TblStuff (FullName, Address, City, Zip)
SELECT FullName = REPLACE(RTRIM(LTRIM(ISNULL(FName, '') + ' ' + ISNULL(Middle, '') + ' ' + ISNULL(LName, ''))), '  ', ' ')
    , Address = ISNULL(Address1, '') + CASE
        WHEN Address2 IS NOT NULL THEN ', ' + Address2
        ELSE '' END
    , City
    , Zip
FROM tblImport (NOLOCK); 
```**

# qt - 如何从 QWebElement 中提取纯文本（无标记）？

> ID：15820406
> 
> 赞同：1
> 
> 时间：2013-04-04T19:49:43.413
> 
> 标签：qt, qwebelement

我正在将 URL 加载到 QTabWidget 的新选项卡中的 QWebFrame 中。然后我将选项卡文本设置为 HTML 文档的。这在大多数情况下都可以正常工作，但显然 QWebElement::toPlainText() 返回原始标记文本。因此，如果其中有 HTML 注释，我最终会将 Tab 文本设置为“我的标题”之类的内容。我希望它对其他标记也有同样的作用，比如 <: 等。

删除评论的最佳方法是什么？我不知道应该如何识别 QWebElement 的注释子元素。

我猜由于元素应该只包含一个简单的字符串，我可以求助于使用正则表达式从 QWebElement::toPlainText() 返回的字符串中删除注释。

我应该将 QWebElement 标题文本加载到 QDomDocument 中并从中删除评论元素吗？即使这开始被证明有点笨拙。

* * *

使用 QDomDocument 并没有那么糟糕：

```
QDomDocument titleDoc;
titleDoc.setContent(QString("<x>%1</x>").arg(webFrame->title()));
m_tabWidget->setTabText(index, titleDoc.documentElement().text()); 
```

它看起来就像一个大锤子。

# java - jdk 1.7 的源/规范文件

> ID：15820408
> 
> 赞同：3
> 
> 时间：2013-04-04T19:49:45.200
> 
> 标签：java, java-7, rpm, rpmbuild, rpm-spec

我有来自 Oracle 站点的 rpm，但我想进行一些配置更改并重新打包 rpm。我没有在他们的网站上看到源文件或规范文件，我不想自己构建整个事情......任何人有任何建议或链接到我可以找到这个的地方吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-15T19:19:38.183

在为 CentOS 打包最新版本的 Redmine 时，我遇到了类似的问题。由于 rpm 发行版之间的 initd/systemd 差异，我不得不尝试几个源 rpm，但我通过 rpmfind 进行了管理。

那里似乎有几个 jdk 1.7 的 srpm：

[http://www.rpmfind.net/linux/rpm2html/search.php?query=java-1.7.0-openjdk](http://www.rpmfind.net/linux/rpm2html/search.php?query=java-1.7.0-openjdk)

几个 Fedora Core 和几个来自 sourceforge.net（Fuduntu、Mageia 等）

# c# - 如何更改treeview默认展开/折叠图像c#

> ID：15820410
> 
> 赞同：1
> 
> 时间：2013-04-04T19:49:48.480
> 
> 标签：c#, winforms, treeview

1.  我需要更改展开和折叠图像的树节点默认图像（`+/-`）。如何使用我自己的图像而不是默认 ( `+/-`) 加减图像来展开和折叠？

2.  如何捕获任何节点展开或折叠？

3.  当任何节点展开时，我想暂时更改节点图像，并且在展开节点下加载子节点的那一刻，然后恢复该节点的先前图像。只想模拟按需节点填充或在任何节点下加载数据。

您能为我的 3 个问题提供一些代码指导吗？

谢谢

# jquery - jquery 绑定上下文不匹配

> ID：15820411
> 
> 赞同：0
> 
> 时间：2013-04-04T19:49:56.520
> 
> 标签：jquery, binding, jquery-context

我有一个 HTML 菜单选项，我`click`在 jQuery 中绑定了一个处理程序：

```
var xyz = {
    getMainContainerSelector: function () {
        return '.container#main';
    },
    bindMenuOptions: function () {
        $('#menu_outcome_list').bind('click', function() {
            // inject template
            $(this.getMainContainerSelector()).html(ich.outcomeListTemplate({}));
            // load datatable
            $('#outcomes').dataTable({
                "bServerSide": true,
                'sPaginationType': 'bootstrap',
                "sAjaxSource": '../php/client/json.php?type=outcomes'
            });
        });
    },
    ...
} 
```

我对以下行有疑问：

```
$(this.getMainContainerSelector()).html(ich.outcomeListTemplate({})); 
```

我想这是一个上下文问题。我的意思是，在 bind 函数内部，`this`不再`xyz`是 ('#menu_outcome_list') HTML 元素。我想做的只是`xyz`从绑定函数内部调用 ' 方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T19:51:16.110

您仍然可以在 xyz 中定义的方法中对它进行闭包访问。

你可以打电话`xyx.getMainContainerSelector();`

如果你想要一个`jQuery`ish 解决方案，jQuery 有一个[`jQuery.proxy()`](http://api.jquery.com/jQuery.proxy/)绑定上下文的函数：

```
$('#menu_outcome_list').bind('click', $.proxy(function(){
    //rest of your code
},xyz)}) 
```

我认为第一个选项更好。

# iphone - HTML 电子邮件签名仅在 iPhone 上不正确呈现

> ID：15820412
> 
> 赞同：3
> 
> 时间：2013-04-04T19:50:00.857
> 
> 标签：iphone, ios, email, signature

这实际上是我第一次发布问题，但我通常“总是”在这里找到答案。你们真棒！...

这是我的问题（相信我，我试图找到答案）。我使用标准 HTML/内联 CSS 使用表格创建了一个电子邮件签名。它几乎在任何地方看起来都很棒，并且有许多不同的电子邮件客户端......好吧，除了 iPhone/iPad

我附上了我的代码的精确副本以及它应该在 iphone 上看到的图像（它看起来几乎在我测试过的所有其他地方都很好，比如 hotmail、live、gmail、office 365、roundcube 等）。在我看来，iphone 将字体/文本呈现为设定的大小，并且不尊重我用作字体大小的内容。我尝试将我的 html 代码从 div 调整到 table，从将样式从 td 移动到 spans 等，但什么都没有。

*注意：它不会让我上传图片，所以我在这里上传到网络：http: [//www.ileansolutions.com/ditthavong/uploads/images/test_email_signature.jpg](http://www.ileansolutions.com/ditthavong/uploads/images/test_email_signature.jpg)

```
<table width="400" cellpadding="0" cellspacing="0" cols="2">

<tr>
<td width="400" colspan="2"><img src="http://ileansolutions.com/ditthavong/uploads/images/ditthavong_em_sig.jpg" width="400" height="34" /></td>
</tr>

<tr>
  <td width="400" colspan="2" style="background-color:#999999; color:#ffffff; width:auto; height:10px;"></td>
</tr>

<tr>
<td width="400" colspan="2" style="padding: 10px 0 5px 0;"><span style="font-family:Verdana, Arial, Helvetica, sans-serif; color:#717070; font-size:17px;">Kevin Smith</span></td>
</tr>

<tr>
<td width="180"><span style="font-family:Verdana, Arial, Helvetica, sans-serif; color:#000000; font-size:11px;">Office 703.500.9900</span></td>
<td width="220" style="text-align:right;"><span style="font-family:Verdana, Arial, Helvetica, sans-serif; color:#000000; font-size:11px;">44 Canal Center Plaza, Suite 322</span></td>
</tr>

<tr>
<td width="190"><span style="font-family:Verdana, Arial, Helvetica, sans-serif; color:#000000; font-size:11px;">Direct 703.500.9900</span></td>
<td width="210" style=" text-align:right;"><span style="font-family:Verdana, Arial, Helvetica, sans-serif; color:#000000; font-size:11px;">Alexandria, Virginia 22314 USA</span></td>
</tr>

<tr>
<td width="400" colspan="2" style="background-color:#ffffff; color:#ffffff; width:auto; height:10px;"></td>
</tr>

<tr>
<td width="400" colspan="2" style="background-color:#999999; padding: 5px 0 5px 5px;"><span style="font-family:Verdana, Arial, Helvetica, sans-serif; color:#ffffff; font-size:14px;">email@domain.com</span></td>
</tr>

</table>

<br/>

<table width="100%" cellpadding="0" cellspacing="0">
<tr>
<td>
<span style="font-size:11px; font-weight:bold;">******** PRIVILEGED AND CONFIDENTIAL COMMUNICATION *********</span>
<br/>
<span style="font-size:11px;">THIS MESSAGE IS BEING SENT FROM THE LAW OFFICES OF SO AND SO ETC. THIS MESSAGE IS BEING SENT FROM THE LAW OFFICES OF SO AND SO ETC. THIS MESSAGE IS BEING SENT FROM THE LAW OFFICES OF SO AND SO ETC. THIS MESSAGE IS BEING SENT FROM THE LAW OFFICES OF SO AND SO ETC. THIS MESSAGE IS BEING SENT FROM THE LAW OFFICES OF SO AND SO ETC.        </span>
</td>
</tr>
</table> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-12T23:25:17.037

iOS 会自动更改文本大小和颜色。但幸运的是，您可以撤消此操作！在“设置”中粘贴您的签名后，*摇晃*您的 iPhone 以调出“撤消”对话框。选择“撤消更改属性”。繁荣。恢复正常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-08T17:16:27.113

不确定这些是否会有所作为，但总比没有答案要好：

尝试使用`<font>`标签而不是`<span>`.

尝试使用`font-size:17px !important;`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-16T21:46:17.837

“摇动你的 iPhone”到“撤消更改属性”效果很好，包括让签名在 Outlook 中正确显示。如果您不“撤消更改属性”，则 Outlook 用户将看到整个电子邮件 - 电子邮件内容和签名 - 采用 Times New Roman 字体。

这是因为 Outlook 默认显示未指定为特定字体的任何 HTML 文本，如 Times New Roman。当您最初将签名粘贴到 iOS 设置中时，Apple 会删除您编码的任何特定字体。但是，当您选择“撤消更改属性”时，它会将 HTML 代码放回原处。

但是对于 Outlook 需要注意的一件事 -您的电子邮件**内容**仍将显示为 Times New Roman，即使您的签名以 sans 字体正确显示（假设您选择了 sans 字体）。这是因为 iOS 没有在 HTML 电子邮件中指定字体，这导致 Outlook 回退到 Times New Roman。

可以在每台用户计算机上更改 Outlook 的这种后备字体（[http://www.msoutlook.info/question/521](http://www.msoutlook.info/question/521)），但似乎没有办法强制为所有查看者指定正文字体.

# octopress - 隐藏起始页上的内容

> ID：15820417
> 
> 赞同：0
> 
> 时间：2013-04-04T19:50:18.280
> 
> 标签：octopress

我有一个八字博客。如果我在帖子页面上，我有我只想显示的内容。

有没有像 {% if post.page %} 这样的可能性

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-07T00:49:06.660

由于您的问题并不完全清楚，我假设您有一堆要显示在帖子页面而不是索引页面上的帖子。在这里，我认为您可以在登录页面上显示帖子的标题，以便当用户单击特定链接/帖子时，他们可以在其帖子页面中完整阅读帖子。为此，您可以修改 index.html ：

```
---
layout: page
footer: false
sidebar: true
---

<div id="blog-archives">
{% for post in site.posts reverse %}
{% capture this_year %}{{ post.date | date: "%Y" }}{% endcapture %}
{% unless year == this_year %}
  {% assign year = this_year %}
  <h2>{{ year }}</h2>
{% endunless %}
<article>
  {% include archive_post.html %}
</article>
{% endfor %}
</div>
<aside class="sidebar">
  {% if site.blog_index_asides.size %}
    {% include_array blog_index_asides %}
  {% else %}
    {% include_array default_asides %}
  {% endif %}
</aside> 
```

# email - Sendgrid Web API -- 在 reply_to 字段中设置多个用户

> ID：15820418
> 
> 赞同：4
> 
> 时间：2013-04-04T19:50:22.187
> 
> 标签：email, sendgrid, reply

我正在使用 Sendgrid Python 库，我想在“reply_to”字段中与多人一起发送电子邮件。

我想向 2 个人发送一封电子邮件，以便两个用户可以通过点击回复相互发送电子邮件。最简单的解决方案似乎是将两个用户都放在回复字段中。

我在 Sendgrid 文档中没有看到任何方法来做到这一点——他们似乎只想要在他们的“reply_to”字段中使用一个电子邮件地址字符串。但是，我知道具有此特征的电子邮件是可能的（请原谅预算编辑工作）：

![回复字段中有多个条目](https://i.stack.imgur.com/fiOqQ.png)

无论如何，如您所见，“回复”中的多个条目是可能的。那么有谁知道如何用 Sendgrid 做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T21:15:56.873

是的，SendGrid 可以做到这一点。要添加多个“回复”条目，您必须使用自定义标题。

因此，在 Python 中，您将添加：

```
message.add_header("Reply-To", "user1@email.com, user2@email.com") 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2019-08-16T14:15:54.297

截至今天，没有办法设置多个回复地址。这是 sendgrid 的 Github 问题：[https ://github.com/sendgrid/sendgrid-csharp/issues/339](https://github.com/sendgrid/sendgrid-csharp/issues/339)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-09-02T14:48:18.110

[根据这个开放问题](https://github.com/sendgrid/sendgrid-csharp/issues/339)，这已被讨论为最想要的功能。现在 SendGrid 支持在 replyTo 中提及多封电子邮件，但他们为此引入了一个新标题，如他们的[文档](https://docs.sendgrid.com/api-reference/mail-send/mail-send#multiple-reply-to-emails)中所述。尽管他们的许多 SDK 都没有这种支持。**更新：现在[Sendgrid Mail nodejs library](https://www.npmjs.com/package/@sendgrid/mail/v/7.5.0)提供了此功能。**

所以我分叉了他们的代码并进行了更改。此[链接](https://github.com/subinoy7/sendgrid-nodejs/tree/f/replyToMultiple)上提供了更改，很快我将提出 PR 以将其与他们的代码库合并。

在replyTo中发送一封包含多封电子邮件的电子邮件，使用下面给出的代码片段：

```
const sgMail = require('@sendgrid/mail');
sgMail.setApiKey(process.env.SENDGRID_API_KEY);
const msg = {
  to: 'recipient@example.org',
  from: 'sender@example.org',
  subject: 'Multiple mail in replyTo',
  html: '<p>Here’s an example of multiple replyTo email for you!</p>',
  replyToList: [
        {
            'name': 'Test User1',
            'email': 'test_user1@example.org'
        },
        {
            'email': 'test_user2@example.org'
        }
    ],
};
```

# android - Android 用 OnTouchListener 显示一个按钮

> ID：15820430
> 
> 赞同：0
> 
> 时间：2013-04-04T19:51:12.357
> 
> 标签：android, button, android-widget, visible, ontouchlistener

我有一个按钮，按下后 3 秒就会消失。我想通过触摸屏幕使其再次可见。

```
public class MainActivity extends Activity {

    Runnable buttonRunnable;
    Handler buttonHandler = new Handler();

    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        final Button button=(Button)findViewById(R.id.myButton);
        buttonRunnable = new Runnable() {
            public void run() {
                button.setVisibility(View.GONE);

            }
        };

        button.setOnClickListener(new View.OnClickListener() {
            public void onClick(View view) {   

                buttonHandler.postDelayed(buttonRunnable, 3000);
            }
        });
    }

private OnTouchListener buttonOnTouchListener = new OnTouchListener() {

        @Override
        public boolean onTouch(View v, MotionEvent event) {

            final Button button=(Button)findViewById(R.id.myButton);
            final LinearLayout linearLayout=(LinearLayout)findViewById(R.id.myLinearLayout);

            linearLayout.setClickable(true);
            linearLayout.setOnClickListener(new OnClickListener() { 
                public void onClick(View view) {   

                    button.setVisibility(View.VISIBLE);
                }
            });
            return true;
        }

    };

} 
```

我可以在 3 秒后隐藏按钮，但我无法让它再次可见。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T19:56:46.437

您需要获取对父容器视图的引用，并确保在其上调用 setClickable(true)。然后，将另一个单击处理程序附加到该视图，并在该单击处理程序中调用 button.setVisibility(View.VISIBLE);

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-05T14:22:55.593

我已经解决了这个问题：

```
public class MainActivity extends Activity{

    Runnable buttonRunnable;
    Handler buttonHandler = new Handler();

    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        final LinearLayout linearLayout=(LinearLayout)findViewById(R.id.myLinearLayout);
        final Button button=(Button)findViewById(R.id.myButton);
        buttonRunnable = new Runnable() {
            public void run() {
                button.setVisibility(View.INVISIBLE);

            }
        };

        button.setOnClickListener(new View.OnClickListener() {
            public void onClick(View view) {   

                buttonHandler.postDelayed(buttonRunnable, 3000);
            }
        });

        linearLayout.setOnTouchListener(buttonOnTouchListener);
    }

    private OnTouchListener buttonOnTouchListener = new OnTouchListener() { 
        @Override
        public boolean onTouch(View v, MotionEvent event) {

            final Button button=(Button)findViewById(R.id.myButton);
            button.setVisibility(View.VISIBLE);
            return true;
        }
    };
} 
```

# javascript - Youtube javascript api 分页参数

> ID：15820436
> 
> 赞同：0
> 
> 时间：2013-04-04T19:51:33.240
> 
> 标签：javascript, youtube, youtube-api

在 youtube api v2 文档中。它建议使用`rel="previous"`和`rel="next"` 使用分页。

```
http://gdata.youtube.com/feeds/api/videos?start-index=51&max-results=25 
```

假设上面的链接，从 51 开始，并在链接中限制 25 个视频参数。我的问题是，我不想直接使用链接，我想分离参数并传递给我的函数参数。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T19:55:30.593

如果我理解您的问题，这很容易做到，只需将字符串分成块并插入您的函数参数。

```
function make_url(start_index, max_results) {
    return "http://gdata.youtube.com/feeds/api/videos?start-index=" + start_index + "&max-results=" + max_results
} 
```

然后调用 make_url(100, 25) 将返回一个这样的 url。

```
http://gdata.youtube.com/feeds/api/videos?start-index=100&max-results=25 
```

# ruby - 将 AppleScript 重写为 appscript-rb，在 Keyboard Maestro 中设置变量

> ID：15820444
> 
> 赞同：0
> 
> 时间：2013-04-04T19:51:57.267
> 
> 标签：ruby, macos, applescript, keyboard-maestro, sourceforge-appscript

我需要在 Keyboard Maestro 中设置一个变量，并且文档指出这可以使用 AppleScript 完成：

```
tell application "Keyboard Maestro Engine"
  make variable with properties {name:"My Variable", value:"New Value"}
end tell 
```

我正在尝试将其转换为 appscript-rb 表示法，到目前为止我已经有了

```
Appscript.app('Keyboard Maestro Engine').
  make(:variable, properties={:name=>'var1', :value => 'val1'}) 
```

我在这里记录了很多成功的片段：[http](http://reganmian.net/wiki/appscript) ://reganmian.net/wiki/appscript ，其中许多都遵循上面的模式，但是这个片段不起作用，它给出了“未知的关键字参数名称”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T20:31:35.003

您可以使用默认写入和默认读取将变量存储在您自己的 plist 中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-07T06:15:08.783

您的命令语法错误（我知道，AppleScript 清晰且定义明确的语法很难想象！）。

命令应该是这样的：

```
#!/usr/bin/ruby

require "rubygems";
require "appscript";

kme = Appscript.app('Keyboard Maestro Engine');
kme.make(:new => :variable, :with_properties => {:name => "My New Variable", :value => "New Value 2"}); 
```

我发现[这本使用 Ruby 编写 Mac 应用程序脚本的草稿](http://www.apeth.com/rbappscript/00intro.html#XXXtoc)有助于弄清楚如何将 AppleScript 代码转换为 ruby​​。

顺便说一句，如果您知道变量已经存在，则仅使用简单的参考 get/set 命令会更容易：

```
kme = Appscript.app('Keyboard Maestro Engine');
p kme.variables["My Variable"].value.get;
kme.variables["My Variable"].value.set("Next Value");
p kme.variables["My Variable"].value.get; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-06T15:49:55.080

所以我想要一个更优雅的答案，但根据菲利普马丁的评论，这是一种有效的方式：

```
defaults write reganmian.net.researchr prelude "export LC_ALL=en_US.UTF-8;export LANG=en_US.UTF-8;declare -x LANG=en_CA.utf-8"
defaults write reganmian.net.researchr ruby "/usr/local/bin/ruby -KU"
defaults write reganmian.net.researchr path "/Users/Stian/src/folders2web" 
```

进而

将此添加到键盘大师“执行shell命令

```
`defaults read reganmian.net.researchr prelude`
`defaults read reganmian.net.researchr ruby` `defaults read reganmian.net.researchr path`/dokuwiki.rb image 
```

它有效，但看起来非常笨拙。

*（有两件事会使这更容易，一是能够配置 Keyboard Maestro 用来执行 shell 命令的 shell - 这不是您的默认 shell，不尊重 ~/.profile，并且没有正确的代码页，路径等 - 另一个是允许在设置中定义任意变量，可以使用 %variable% 插入）。*

# iphone - 带有可显示侧面板的中心面板的 iOS 应用程序：JASidePanels

> ID：15820455
> 
> 赞同：0
> 
> 时间：2013-04-04T19:52:29.190
> 
> 标签：iphone, ios, objective-c, cocoa-touch, uitabbarcontroller

我正在使用[JASidePanels](https://github.com/gotosleep/JASidePanels)与 Facebook 具有相同的布局，但有一些限制，我希望您帮助我：

*   在中心视图控制器的导航控制器中添加右键

*   在不同的视图控制器中按下按钮后，将中心视图更改为不同的视图

*   从左侧或右侧告诉中心视图控制器推送视图

*   从左侧或右侧转到标签栏视图控制器内的视图

这是我在 MainAppDelegate 中的实现：

```
/* tabbar views with their navigation controller */
SearchViewController *searchViewController = [[SearchViewController alloc]
   initWithNibName:@"SearchViewController" bundle:nil];
self.searchNavController = [[UINavigationController alloc]
initWithRootViewController:searchViewController];

MainViewController *mainViewController = [[MainViewController alloc]
 initWithNibName:@"MainViewController" bundle:nil];
self.mainNavController = [[UINavigationController alloc]
initWithRootViewController:mainViewController];

  /* uiviewcontroller for our left side view */
SideMenuViewController *sideMenuViewController=[[SideMenuViewController alloc]
initWithNibName:@"SideMenuViewController" bundle:nil];

  /* the center view of the side panel */
self.mainSidePanelviewController = [[JASidePanelController alloc] init];
self.mainSidePanelviewController.shouldDelegateAutorotateToVisiblePanel = NO;

   /* set the properties of JASidePanel*/

self.mainSidePanelviewController.leftPanel = sideMenuViewController ;
self.mainSidePanelviewController.centerPanel =  self.mainNavController;

[self.mainSidePanelviewController.centerPanel.navigationController
 setNavigationBarHidden:YES animated:YES];

NSArray *controllers = [NSArray arrayWithObjects:
 self.mainSidePanelviewController,self.searchNavController ,nil];

[self.tabController setViewControllers:controllers];

// the tab bar is our root view
self.window.rootViewController = self.tabController;

[self.window makeKeyAndVisible]; 
```

如果有更好的开源项目可以让我做我想做的事，请给我链接

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-21T08:20:51.083

1.  导入接口头文件

    #import "UIViewController+JASidePanel.h"

2.  在要添加右键的 ViewController 中。将以下代码添加到 viewDidLoad 方法。

    ```
    if (!self.navigationItem.rightBarButtonItem) {
        UIImage* image = [UIImage imageNamed:@"rightButtonImage.png"];
        CGRect frameimg = CGRectMake(0, 0, image.size.width, image.size.height);
        UIButton *button = [[UIButton alloc] initWithFrame:frameimg];
        [button setBackgroundImage:image forState:UIControlStateNormal];
        [button addTarget:self.sidePanelController action:@selector(toggleRightPanel:) forControlEvents:UIControlEventTouchUpInside];
        self.navigationItem.rightBarButtonItem = [[UIBarButtonItem alloc] initWithCustomView:button];  } 
    ```

您可以使用任何 UIButton 来创建 rightBarButtonItem。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T23:44:10.337

只需添加您自己的按钮（例如在 viewDidLoad 中）并分配一个选择器以显示右侧面板：

`UIBarButtonItem *rightbutton = [UIBarButtonItem barItemWithImage:[UIImage imageNamed:@"rightIcon.png"] hightlightImage:[UIImage imageNamed:@"rightIcon.png"] target:self action:@selector(slideInRightHandView:)]; self.navigationItem.rightBarButtonItem = rightbutton;`

# c# - 为什么 servicestack 不能将此 JSON 反序列化为 C#？

> ID：15820456
> 
> 赞同：2
> 
> 时间：2013-04-04T19:52:31.260
> 
> 标签：c#, json, deserialization, servicestack

我正在尝试将以下 JSON 表示反序列化为强类型对象。我能够从 c# -> json 序列化它，但反之亦然。

C＃

```
public class Package 
{
   public Guid Id {get;set;}
   public List<string> Email {get;set;}
   public List<Items> Items {get;set;}
}

public class Items
{
   public string Uri {get;set;}
   public int Width {get;set;}
   public int Height {get;set;}
} 
```

JSON

```
{
    "Id":"84fd8751-6107-41af-9473-65aae51e042a",
    "Email":[
    "j@t.com"
    ],
    "Items":"[
       {"Uri":"http://localhost/foo.jpg","Width":234,"Height":313},
       {"Uri":"http://localhost/bar.jpg","Width":234,"Height":174}]"
} 
```

反序列化的代码

```
var instance = JsonSerializer.DeserializeFromString<Package>(jsonData); 
```

对象`instance`已创建，其中有 2 个 item 对象，`instance.Items`但它们的所有属性均为 null。

TIA

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-04T19:55:52.863

您在 Items 值周围加上引号，因此将它们解析为字符串而不是数组/列表。删除它们即可获胜。

```
"Items":[
       {"Uri":"http://localhost/foo.jpg","Width":234,"Height":313},
       {"Uri":"http://localhost/bar.jpg","Width":234,"Height":174}] 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-04T19:56:06.837

那不是有效的 JSON。Items 值周围的引号不应存在。

# c - 防止键入零作为值的第一个数字

> ID：15820458
> 
> 赞同：0
> 
> 时间：2013-04-04T19:52:35.167
> 
> 标签：c

我有这段代码可以从命令中解码输入字符

```
 if( arg && isdigit( arg[ 0 ] ) {

        /* Decode the input char from commands.  */
        if( cmd->digit_counter == 0 ) memset( cmd->next_chan_buffer, 0, 5 );
        cmd->next_chan_buffer[ cmd->digit_counter ] = arg[ 0 ];
        cmd->digit_counter++;
        cmd->frame_counter = cmd->delay;

        /**
         * Send an enter command if we type more digits than there are stations.
         */
        if( cmd->digit_counter > 0 && (station_get_max_position( cmd->station ) < 10) ) {
            commands_handle( cmd, ENTER, 0 );
        } else if( cmd->digit_counter > 1 && (station_get_max_position( cmd->station ) < 100) ) {
            commands_handle( cmd, ENTER, 0 );
        } else if( cmd->digit_counter > 2 ) {
            commands_handle( cmd, ENTER, 0 );
        }
    } 
```

例如，在键盘上输入数字并在框中输入数字

```
 |5|4|2|0| 
```

我想防止第一个计数数字为 0（或只接受 1 到 9 的数字）和第二个、第三个、... 数字来接受 0 - 9 的数字

```
digits count           1            2        3        4
          -------------------------------------------------
          | only digits 1 to 9 | 0 to 9 | 0 to 9 | 0 to 9 |
          ------------------------------------------------- 
```

谢谢

好的，通过添加功能解决：

```
int first_digit( int num ) 
{
        while(num >= 10) {
            num = ( num - ( num % 10 ) ) / 10;
        }
        return num;
}

if( arg && isdigit( arg[ 0 ] ) {

        /* Decode the input char from commands.  */
        if( cmd->digit_counter == 0 ) memset( cmd->next_buffer, 0, 5 );
        cmd->next_buffer[ cmd->digit_counter ] = arg[ 0 ];
        if( first_digit( atoi( cmd->next_chan_buffer ) ) != 0 ) {
            cmd->digit_counter++;
            cmd->frame_counter = cmd->delay;
        }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T19:56:46.333

您可以像这样执行检查，而不是使用 isdigit()。

```
if( arg && arg[0] >= '1' && arg[0] <= '9' ) { // only accept '1' through '9' 
```

从 '0' 到 '9' 的字符在 C 中总是以相邻的顺序排列，所以这个检查可以满足你的需要。

# oracle - 为什么 WAS 不附带 oracle 驱动程序 jars

> ID：15820465
> 
> 赞同：1
> 
> 时间：2013-04-04T19:52:48.457
> 
> 标签：oracle, jdbc, websphere, implementation

websphere 应用程序服务器附带了它自己的用于 oracle 数据库的 jdbc 提供程序。这就是为什么当我们创建一个新的 JDBC 提供者时我们可以选择“Oracle”。现在如果它提供自己的驱动程序，基本上它是为 Oracle db 提供 JDBC API 的实现。所以在 IBM/Webspher/AppServer/lib 目录中，我希望看到 ojdbc14.jar。但我看不到它。它在我的 C:Oracle/ora92/lib 目录中。为什么 WAS 不像它自己的 jdk/jre 实现那样附带它自己的 jdbc 实现。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T20:41:15.317

因为 Java 企业版规范不要求“应用服务器提供者”必须为每个数据库开发驱动 JDBC，它只要求应用服务器支持某些版本的 JDBC API。

# ruby-on-rails - 提前取消工作

> ID：15820466
> 
> 赞同：4
> 
> 时间：2013-04-04T19:52:49.270
> 
> 标签：ruby-on-rails, sidekiq

我有一个用户在命令行中运行的脚本。如果他们在命令完成之前意识到某些事情，他们将简单地`Ctrl``C`中断该过程，修复任何内容，然后重新启动它。

然而，在我的 Rails 应用程序中，我使用 Sidekiq 在后台启动工作程序。如何在我的 Web 应用程序中设置一个按钮以允许用户取消作业？

如果您需要更多信息，请告诉我。

**更新：关注问题**

是否有可能使用 Ruby 来`grep`获取特定的进程 ID 并以这种方式杀死它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T20:54:00.710

您可以查看 man 的这一部分[https://github.com/mperham/sidekiq/wiki/Signals](https://github.com/mperham/sidekiq/wiki/Signals)和这部分[https://github.com/mperham/sidekiq/wiki/API](https://github.com/mperham/sidekiq/wiki/API)。似乎你可以对你的工人做任何事情。对不起，我不使用 Sidekiq，所以不能给你一个完整的决定。

# weblogic - BPEL 托管服务器错误

> ID：15820467
> 
> 赞同：1
> 
> 时间：2013-04-04T19:52:56.597
> 
> 标签：weblogic, bpel

***问题已解决。我将数据源驱动程序更改为非 XA 并且工作正常，谢谢***

我在 Bpel 托管服务器日志中看到此错误。与 Quartz 调度器相关的东西。有人见过这个错误吗？

bpel 是否期望某些数据库表为空以进行持久性

这是我看到的堆栈跟踪，似乎与应用程序无关。

```
<Apr 4, 2013 11:13:35 AM PDT> <Error> <oracle.integration.platform.blocks.scheduler.FabricJobStoreCMT> <BEA-000000> <ClusterManager: Error managing cluster: null
java.lang.reflect.UndeclaredThrowableException
        at $Proxy364.commit(Unknown Source)
        at org.quartz.impl.jdbcjobstore.JobStoreSupport.commitConnection(JobStoreSupport.java:3621)
        at org.quartz.impl.jdbcjobstore.JobStoreSupport.doCheckin(JobStoreSupport.java:3210)
        at org.quartz.impl.jdbcjobstore.JobStoreSupport$ClusterManager.manage(JobStoreSupport.java:3811)
        at org.quartz.impl.jdbcjobstore.JobStoreSupport$ClusterManager.initialize(JobStoreSupport.java:3798)
        at org.quartz.impl.jdbcjobstore.JobStoreSupport.schedulerStarted(JobStoreSupport.java:621)
        at org.quartz.core.QuartzScheduler.start(QuartzScheduler.java:456)
        at org.quartz.impl.StdScheduler.start(StdScheduler.java:147)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        at java.lang.reflect.Method.invoke(Method.java:597)
        at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:307)
        at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:182)
        at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:149)
        at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:106)
        at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:171)
        at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:204)
        at $Proxy318.start(Unknown Source)
        at oracle.integration.platform.blocks.scheduler.QrtzSchedulerServiceImpl.startScheduler(QrtzSchedulerServiceImpl.java:46)
        at oracle.integration.platform.blocks.scheduler.FabricSchedulerFactory.stateChanged(FabricSchedulerFactory.java:147)
        at oracle.integration.platform.blocks.mesh.FabricLifecycle.notifyListeners(FabricLifecycle.java:46)
        at oracle.integration.platform.blocks.mesh.FabricLifecycle.setState(FabricLifecycle.java:30)
        at oracle.integration.platform.blocks.mesh.MeshImpl.postDeployInit(MeshImpl.java:118)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        at java.lang.reflect.Method.invoke(Method.java:597)
        at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:307)
        at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:182)
        at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:149)
        at oracle.integration.platform.metrics.PhaseEventAspect.invoke(PhaseEventAspect.java:71)
        at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:171)
        at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:204)
        at $Proxy304.postDeployInit(Unknown Source)
        at oracle.integration.platform.kernel.FabricKernelInitializerServlet$1.run(FabricKernelInitializerServlet.java:555)
        at oracle.integration.platform.blocks.executor.WorkManagerExecutor$1.run(WorkManagerExecutor.java:120)
        at weblogic.work.j2ee.J2EEWorkManager$WorkWithListener.run(J2EEWorkManager.java:183)
        at weblogic.work.DaemonWorkThread.run(DaemonWorkThread.java:30)
Caused By: java.lang.reflect.InvocationTargetException
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T20:14:18.730

BPEL 期望在数据库上创建和访问**RCU表。**

您是否正确创建了 RCU 模式？您能否在 WEblogic 中检查它的`SOADataSource`定义是否正确，并且您可以从 Admin/BPEL 管理的服务器访问它吗？

此外，似乎错误与您的集群配置有关：`ClusterManager: Error managing cluster: null`。

# ruby-on-rails - 在 Rails 中为回调初始化字符串数组

> ID：15820468
> 
> 赞同：0
> 
> 时间：2013-04-04T19:52:59.607
> 
> 标签：ruby-on-rails, ruby

我正在尝试访问我的应用程序中的字符串数组并收到错误

```
undefined method `each' for nil:NilClass 
```

我回到我的代码，发现无论我做什么，当我试图访问对象连续返回 nil 的字符串数组时：

```
class Foo
   attr_reader :bar
   def initalize
     @bar = ['a','b','c']
   end  
 end  

> a = Foo.new
=> #<KeywordsController::Foo:0x007fa3541b3920>
> a.bar
=> nil 
```

如何创建一个可以访问字符串数组的类？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T19:59:06.680

```
class Foo
   attr_reader :bar
   def initialize
     @bar = ['a','b','c']
   end  
 end 
```

在寻找更奇怪和更奇怪的问题时，您看不到的那些导致疯狂的错别字之一！

# sql - 使用 sqlite 在列中查找最常用的单词？

> ID：15820482
> 
> 赞同：2
> 
> 时间：2013-04-04T19:53:44.000
> 
> 标签：sql, sqlite

我的数据如下所示：

```
 movie_id    comment
            1           tom cruise is great
            1           great action movie
            2           got teary eyed
            2           great cast
            1           tom cruise is hott 
```

我想要一个函数，根据我选择的 movie_id 返回评论中最常见的单词。所以如果我查询movie_id=1，我会得到：

```
 tom, 2
            cruise, 2
            is, 2
            great, 2
            hott, 1
            action, 1
            movie, 1 
```

如果我查询movie_id=2，我会得到：

```
 got, 1
            teary, 1
            eyed, 1
            great, 1
            cast, 1 
```

我看到了一些使用 tsql 的解决方案，但我以前从未使用过，也不懂代码。在 sqlite3 中寻找一种方法来做到这一点。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T20:07:39.383

你可以用一个非常丑陋的查询来做到这一点。

```
select word, count(*) from (
select (case when instr(substr(m.comments, nums.n+1), ' ') then substr(m.comments, nums.n+1)
             else substr(m.comments, nums.n+1, instr(substr(m.comments, nums.n+1), ' ') - 1)
        end) as word
from (select ' '||comments as comments
      from m
     )m cross join
     (select 1 as n union all select 2 union all select 3
     ) nums
where substr(m.comments, nums.n, 1) = ' ' and substr(m.comments, nums.n, 1) <> ' '
) w
group by word
order by count(*) desc 
```

这是未经测试的。内部查询需要一个数字列表（此处仅限 3 个；您可以查看如何添加更多）。然后它检查一个单词是否从位置 n+1 开始。一个单词在一个空格之后开始，所以我在评论的开头放了一个空格。

然后它把这个词拉出来，用于聚合目的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-08-31T04:24:54.177

这是一个 hack，但您也可以使用 SQLite 的表值函数来解决这个问题：

```
select value from (
    select
        '["' || replace(trim(title), '"', '') || '"]' as arr
    from story limit 2500000
    ) e, json_each(e.arr) 
```

但请注意 - 您可能会注意到您的列中有很多字符可能会破坏 JSON 解析并引发 JSON 解析错误。

在这种情况下，您可能必须删除一些控制字符：

```
select value from (select
'["' || replace(replace(replace(replace(replace(replace(trim(title), '"', ''), CHAR(10), ""), CHAR(13), ''), "  ", ""), "\", ""), ' ', '","') 
|| '"]' as arr
from your_table limit 2500000
) e, json_each(e.arr) 
```

为了更容易调试，您可以使用限制和偏移的组合（例如`limit 1000000 offset 2200000`）来帮助您找到问题行，然后将该字符替换为空字符串。

# gantt-chart - 甘特图和关键跟踪器

> ID：15820485
> 
> 赞同：2
> 
> 时间：2013-04-04T19:53:56.060
> 
> 标签：gantt-chart, pivotaltracker

有谁知道与 Pivotal 跟踪器或其他解决方案集成的良好甘特图？

我免费试用了 gantto，并没有留下很深刻的印象。不幸的是，我还没有找到任何其他真正的解决方案。

提前致谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-05T15:38:13.033

你想解决什么问题？通常瀑布方法（使用甘特图）和敏捷方法（Tracker 体现）是相互排斥的。

也就是说，请查看Tracker 网站上的[第三方工具页面；](https://www.pivotaltracker.com/help/thirdpartytools)其中一些可能会有所帮助。

# xml - 如何从命令行中删除父 XML 节点

> ID：15820486
> 
> 赞同：1
> 
> 时间：2013-04-04T19:54:07.337
> 
> 标签：xml, xml-parsing

我想知道在不影响肉类产品节点的情况下仅删除蔬菜产品节点的最佳方法是哪种。

```
<Product>
    <Type>Meat</Type>
    <Object>
      <ID>1</ID>
    </Object>
  </Product>
<Product>
    <Type>Vegetables</Type>
    <Object>
      <ID>1</ID>
    </Object>
  </Product> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-02T07:41:31.757

Wrap your snippet in a top level tag to create a well-formed XML file. Then use e.g. the command line tool [xmlstarlet](http://xmlstar.sourceforge.net/) to modify the XML.

For your case the staep by step instructions:

1.  Add a toplevel tag, say, `MyTopLevelTag`, so that your XML files looks like :

    Meat 1 Vegetables 1

Save it as `how-to-remove-vegetables_wrapped.xml`

1.  Install [xmlstarlet](http://xmlstar.sourceforge.net/). (Under OSX you can use [homebrew](http://brew.sh)).

2.  Type in your shell:

    xml ed -d "/MyTopLevelTag/Product[Type = 'Vegetables']" how-to-remove-vegetables_wrapped.xml

The magic is in the XPath `/MyTopLevelTag/Product[Type = 'Vegetables']`: You select the `Product` tag, but you restrict it to its children with the `type` value of `'Vegetables'`.

# css - 在移动设备上将两个单独的菜单合并为一个响应式下拉菜单

> ID：15820487
> 
> 赞同：1
> 
> 时间：2013-04-04T19:54:08.347
> 
> 标签：css, drop-down-menu, menu

我的网站顶部有两个完全独立的菜单，

这是有充分理由的，因为两个菜单的样式完全不同，并且有不同的链接等；

例如：

```
<div class="menu1">
 <ul>
  <li><a href="">one</a></li>
  <li><a href="">two</a></li>
  <li><a href="">three</a></li>
 </ul>
</div>

<div class="menu2">
 <ul>
  <li><a href="">drop 1</a>
    <ul>
      <li><a href="">sub 1</a></li>
    </ul>
  </li>
  <li><a href="">drop 2</a>
    <ul>
      <li><a href="">sub 2</a></li>
    </ul>
  </li>  
  <li><a href="">drop 3</a>
    <ul>
      <li><a href="">sub 3</a></li>
    </ul>
  </li>
 </ul>
</div> 
```

当设备宽度小于 768.

所以它会变成：

```
<div class="menus combined">
 <ul>
  <li><a href="">one</a></li>
  <li><a href="">two</a></li>
  <li><a href="">three</a></li>
  <li><a href="">drop 1</a>
    <ul>
      <li><a href="">sub 1</a></li>
    </ul>
  </li>
  <li><a href="">drop 2</a>
    <ul>
      <li><a href="">sub 2</a></li>
    </ul>
  </li>  
  <li><a href="">drop 3</a>
    <ul>
      <li><a href="">sub 3</a></li>
    </ul>
  </li>
 </ul>
</div> 
```

任何意见或建议将不胜感激！

谢谢你！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T06:06:17.417

你也可以使用

```
<div class="menus combined">
 <ul>
 <select>
    <option>one</option>
    <option>two</option>
    <option>three</option>
    <option>drop 1</option>
    <option>sub 1</option>
    <option>drop 2</option>
    <option>sub 2</option>
    <option>drop 3</option>
    <option>sub 3</option>
    <option>one</option>
 </select>
</div 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-29T13:59:50.513

页面的 HTML 无法通过 CSS 媒体查询更改，但您可以通过 JavaScript。

[如果文档宽度为 768 像素或更窄，请查看此 Fiddle](http://jsfiddle.net/fmVfK)以了解它如何组合 2 个菜单。

```
$(document).ready( function () {

// Get the width of the body:
var bodyWidth = document.documentElement.clientWidth;

if (bodyWidth <= 768) {
    // Change the class of the first menu:
    $('.menu1').attr('class', 'menus combined'); 

    // Add in the items from the second menu into the first:
    $('.menus.combined ul').append($('.menu2 ul').html());        
}

}); 
```

您可能还想添加一个 resize 事件侦听器以在调整浏览器大小时运行代码，否则它只会在页面首次加载时运行。

# excel - 使用带有 2 个参数的“if”函数

> ID：15820490
> 
> 赞同：-4
> 
> 时间：2013-04-04T19:54:09.857
> 
> 标签：excel

如果 A1 = 2012 年 12 月 31 日（年底） B1 = 公司、个人、信托等（实体类型） 我希望 C1 计算纳税申报表的到期日期 根据您和实体类型，到期日期为从年末算起 3.5 或 2.5 个月。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T20:11:13.587

您可以使用如下公式：

```
=IF(criteria, A1+74, A1+105 ) 
```

您定义的标准。

74：天数（闰年第一个 2.5 个月）
105：天数（闰年第一个 3.5 个月）

或者正如 pnuts 建议的那样：

```
=IF(criterion,EOMONTH(A1,3)-15,EOMONTH(A1,4)-15) 
```

# oracle - org.hibernate.ObjectDeletedException：已删除的对象将被级联重新保存（从关联中删除已删除的对象）

> ID：15820491
> 
> 赞同：0
> 
> 时间：2013-04-04T19:54:12.933
> 
> 标签：oracle, spring, hibernate, oracle10g, composite-primary-key

我在 Oracle (10g) 中有 3 个表。

*   区
*   重量
*   区域充电

where`ZoneCharge`有一个复合主键（zoneId，weightId），它引用表`Zone`和`Weight`表的主键。

我需要`ZoneCharge`根据`zoneId`提供的数据从表中删除所有行（`weightIds`在这种情况下是未知的）。

实现此目的的本机 Oracle SQL 如下所示。

```
DELETE FROM zone_charge WHERE zone_id=22; 
```

* * *

我尝试了以下方式（在 DAO 中）。

```
@Override
@SuppressWarnings("unchecked")
@Transactional(readOnly=false, propagation=Propagation.REQUIRES_NEW)
public void delete(Long id)
{
    Session session=sessionFactory.openSession();
    session.beginTransaction();

    Zone  zone=(Zone) session.get(Zone.class, id);
    Set<ZoneCharge> zoneChargeSet = zone.getZoneChargeSet();
    int i=1;

    for(ZoneCharge zoneCharge:zoneChargeSet)
    {
        ZoneChargePK zoneChargePK=new ZoneChargePK();
        zoneChargePK.setZoneId(id);
        zoneChargePK.setWeightId(zoneCharge.getWeight().getWeightId());
        zoneCharge.setZoneChargePK(zoneChargePK);
        session.delete(zoneCharge);

        if(i++%50==0)
        {
            i=1;
            session.flush();
            session.clear();
        }
    }        
    session.getTransaction().commit(); //The exception is caused at this line.
    session.close();
} 
```

它导致了以下异常。

```
org.hibernate.ObjectDeletedException: deleted object would be re-saved by cascade (remove deleted object from associations): [model.ZoneCharge#tempPackage.ZoneChargePK[zoneId=22, weightId=164]] 
```

堆栈跟踪：

```
org.springframework.web.util.NestedServletException: Request processing failed; nested exception is org.hibernate.ObjectDeletedException: deleted object would be re-saved by cascade (remove deleted object from associations): [model.ZoneCharge#tempPackage.ZoneChargePK[zoneId=22, weightId=164]]
    at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:927)
    at org.springframework.web.servlet.FrameworkServlet.doDelete(FrameworkServlet.java:844)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:653)
    at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:796)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:728)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:305)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
    at org.springframework.orm.hibernate4.support.OpenSessionInViewFilter.doFilterInternal(OpenSessionInViewFilter.java:152)
    at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
    at org.springframework.web.filter.HiddenHttpMethodFilter.doFilterInternal(HiddenHttpMethodFilter.java:77)
    at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
    at org.springframework.web.multipart.support.MultipartFilter.doFilterInternal(MultipartFilter.java:119)
    at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
    at filter.NoCacheFilter.doFilter(NoCacheFilter.java:102)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:330)
    at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:118)
    at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:84)
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:342)
    at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:113)
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:342)
    at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:103)
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:342)
    at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:113)
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:342)
    at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:150)
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:342)
    at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:45)
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:342)
    at org.springframework.security.web.authentication.www.BasicAuthenticationFilter.doFilter(BasicAuthenticationFilter.java:150)
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:342)
    at org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:183)
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:342)
    at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:105)
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:342)
    at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:50)
    at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:342)
    at org.springframework.security.web.session.ConcurrentSessionFilter.doFilter(ConcurrentSessionFilter.java:125)
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:342)
    at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:87)
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:342)
    at org.springframework.security.web.access.channel.ChannelProcessingFilter.doFilter(ChannelProcessingFilter.java:144)
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:342)
    at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:192)
    at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:160)
    at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:346)
    at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:259)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:222)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:123)
    at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:472)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:171)
    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:99)
    at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:936)
    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:407)
    at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1004)
    at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:589)
    at org.apache.tomcat.util.net.AprEndpoint$SocketProcessor.run(AprEndpoint.java:1822)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)
    at java.lang.Thread.run(Thread.java:722)
Caused by: org.hibernate.ObjectDeletedException: deleted object would be re-saved by cascade (remove deleted object from associations): [model.ZoneCharge#tempPackage.ZoneChargePK[zoneId=22, weightId=164]]
    at org.hibernate.internal.SessionImpl.forceFlush(SessionImpl.java:1224)
    at org.hibernate.event.internal.DefaultSaveOrUpdateEventListener.entityIsTransient(DefaultSaveOrUpdateEventListener.java:182)
    at org.hibernate.event.internal.DefaultSaveOrUpdateEventListener.performSaveOrUpdate(DefaultSaveOrUpdateEventListener.java:114)
    at org.hibernate.event.internal.DefaultSaveOrUpdateEventListener.onSaveOrUpdate(DefaultSaveOrUpdateEventListener.java:90)
    at org.hibernate.internal.SessionImpl.fireSaveOrUpdate(SessionImpl.java:726)
    at org.hibernate.internal.SessionImpl.saveOrUpdate(SessionImpl.java:718)
    at org.hibernate.engine.spi.CascadingAction$5.cascade(CascadingAction.java:258)
    at org.hibernate.engine.internal.Cascade.cascadeToOne(Cascade.java:383)
    at org.hibernate.engine.internal.Cascade.cascadeAssociation(Cascade.java:326)
    at org.hibernate.engine.internal.Cascade.cascadeProperty(Cascade.java:208)
    at org.hibernate.engine.internal.Cascade.cascadeCollectionElements(Cascade.java:412)
    at org.hibernate.engine.internal.Cascade.cascadeCollection(Cascade.java:353)
    at org.hibernate.engine.internal.Cascade.cascadeAssociation(Cascade.java:329)
    at org.hibernate.engine.internal.Cascade.cascadeProperty(Cascade.java:208)
    at org.hibernate.engine.internal.Cascade.cascade(Cascade.java:165)
    at org.hibernate.event.internal.AbstractFlushingEventListener.cascadeOnFlush(AbstractFlushingEventListener.java:161)
    at org.hibernate.event.internal.AbstractFlushingEventListener.prepareEntityFlushes(AbstractFlushingEventListener.java:152)
    at org.hibernate.event.internal.AbstractFlushingEventListener.flushEverythingToExecutions(AbstractFlushingEventListener.java:88)
    at org.hibernate.event.internal.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:51)
    at org.hibernate.internal.SessionImpl.flush(SessionImpl.java:1212)
    at org.hibernate.internal.SessionImpl.managedFlush(SessionImpl.java:400)
    at org.hibernate.engine.transaction.internal.jdbc.JdbcTransaction.beforeTransactionCommit(JdbcTransaction.java:101)
    at org.hibernate.engine.transaction.spi.AbstractTransactionImpl.commit(AbstractTransactionImpl.java:175)
    at dao.ZoneChargeDAO.delete(ZoneChargeDAO.java:131)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:317)
    at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:183)
    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:150)
    at org.springframework.security.access.intercept.aopalliance.MethodSecurityInterceptor.invoke(MethodSecurityInterceptor.java:64)
    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:172)
    at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:110)
    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:172)
    at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:204)
    at $Proxy928.delete(Unknown Source)
    at controller.ZoneCharge.delete(ZoneCharge.java:41)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at org.springframework.web.method.support.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:219)
    at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:132)
    at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:104)
    at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandleMethod(RequestMappingHandlerAdapter.java:746)
    at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:687)
    at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:80)
    at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:925)
    at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:856)
    at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:915)
    ... 70 more 
```

* * *

如果需要关联实体，它们如下所示。

区：

```
@Entity
@Table(name = "ZONE", catalog = "", schema = "WAGAFASHIONDB")
public class Zone  implements java.io.Serializable
{
    private static final long serialVersionUID = 1L;
    @Id
    @Basic(optional = false)
    @Column(name = "ZONE_ID", nullable = false, precision = 35, scale = 0)
    @SequenceGenerator(name = "zoneIdSequence", sequenceName = "ZONE_SEQ", allocationSize=1, initialValue=1)
    @GeneratedValue(strategy = GenerationType.SEQUENCE, generator = "zoneIdSequence")
    private Long zoneId;
    @Column(name = "ZONE", length = 50)
    private String zone;
    @OneToMany(mappedBy = "zoneId", fetch = FetchType.LAZY)
    private Set<Country> countrySet;
    @OneToMany(cascade = CascadeType.ALL, mappedBy = "zone", orphanRemoval = true, fetch = FetchType.LAZY)
    private Set<ZoneCharge> zoneChargeSet;
    @JoinColumn(name = "TRANSPORTER_ID", referencedColumnName = "TRANSPORTER_ID")
    @ManyToOne(fetch = FetchType.LAZY)
    private Transporter transporterId;

    //Mutators and accessors
} 
```

* * *

重量：

```
@Entity
@Table(name = "WEIGHT", catalog = "", schema = "WAGAFASHIONDB")
public class Weight  implements java.io.Serializable
{
    private static final long serialVersionUID = 1L;
    @Id
    @Basic(optional = false)
    @Column(name = "WEIGHT_ID", nullable = false, precision = 35, scale = 0)
    @SequenceGenerator(name = "weightIdSequence", sequenceName = "WEIGHT_SEQ", allocationSize=1, initialValue=1)
    @GeneratedValue(strategy = GenerationType.SEQUENCE, generator = "weightIdSequence")
    private Long weightId;
    @Column(name = "WEIGHT", precision = 35, scale = 2)
    private BigDecimal weight;
    @OneToMany(cascade = CascadeType.ALL, mappedBy = "weight", orphanRemoval = true, fetch = FetchType.LAZY)
    private Set<ZoneCharge> zoneChargeSet;

    //Mutators and accessors
} 
```

* * *

区域收费：

```
@Entity
@Table(name = "ZONE_CHARGE", catalog = "", schema = "WAGAFASHIONDB")
public class ZoneCharge  implements java.io.Serializable
{
    private static final long serialVersionUID = 1L;
    @EmbeddedId
    protected ZoneChargePK zoneChargePK;
    @Column(name = "CHARGE", precision = 35, scale = 2)
    private BigDecimal charge;
    @JoinColumn(name = "ZONE_ID", referencedColumnName = "ZONE_ID", nullable = false, insertable = false, updatable = false)
    @ManyToOne(optional = false, fetch = FetchType.LAZY)
    private Zone zone;
    @JoinColumn(name = "WEIGHT_ID", referencedColumnName = "WEIGHT_ID", nullable = false, insertable = false, updatable = false)
    @ManyToOne(optional = false, fetch = FetchType.LAZY)
    private Weight weight;

    //Mutators and accessors

} 
```

* * *

ZoneChargePK：

```
@Embeddable
public class ZoneChargePK  implements java.io.Serializable
{
    @Basic(optional = false)
    @Column(name = "ZONE_ID", nullable = false)
    private Long zoneId;
    @Basic(optional = false)
    @Column(name = "WEIGHT_ID", nullable = false)
    private Long weightId;

    //Mutators and accessors
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T09:50:02.807

必须在某个地方与该对象（列表、映射、集合等）建立关联，您必须先从那里删除该对象，然后才能将其删除。

此处提出了类似的问题：[已删除的对象将由级联重新保存（从关联中删除已删除的对象）](https://stackoverflow.com/questions/11649249/deleted-object-would-be-re-saved-by-cascade-remove-deleted-object-from-associat)

# c# - 如何将未处理的 KeyDown 事件传播到父控件？

> ID：15820493
> 
> 赞同：4
> 
> 时间：2013-04-04T19:54:17.627
> 
> 标签：c#, winforms

**背景**：

我有几个相当复杂的 C# gui 应用程序，它们的控件嵌套在控件内部的控件中，这需要全局处理热键（即，需要有一个顶级处理程序，无论焦点在哪里都可以捕获按键是）。

我的要求在这里可能有点不寻常，因为一些热键是常用的按键，如字母，甚至是空格键。当按下空格键之类的键时，显然会有某些控件（例如文本框）已经处理它。在焦点控件处理键的情况下，我想避免调用全局热键处理程序。

我当前的解决方案是使用[PreFilterMessage](http://msdn.microsoft.com/en-us/library/system.windows.forms.imessagefilter.prefiltermessage.aspx)全局处理热键，然后在 PreFilterMessage 调用内部，如果已知焦点控件处理该键，则我有绕过全局热键的代码。（但是，由于[IsInputKey](http://msdn.microsoft.com/en-CA/library/system.windows.forms.control.isinputkey.aspx)受到保护，我无法询问控件是否处理密钥，所以我只有自己的混乱逻辑，即应该绕过哪些控件的热键）。

我对 PreFilterMessage 解决方案不是很满意，看起来他们应该是一种更优雅的方式来做到这一点。从概念上讲，我想要的行为非常简单。如果焦点控件处理 KeyDown，那么我不希望其他任何东西来处理它。否则，父控件应尝试处理它，如果该控件不处理该键，则应尝试该键的父控件，直到它一直到达 Form 的 KeyDown 处理程序。

**问题**：

有没有办法在 Control 上设置 KeyDown 处理程序，使其仅在且仅在以下情况下接收事件：

*   控制或其后代之一被聚焦，并且
*   任何后代控件都没有焦点，或者焦点控件不处理 KeyDown 事件

我对此做了尽可能多的研究。我知道[PreFilterMessage](http://msdn.microsoft.com/en-us/library/system.windows.forms.imessagefilter.prefiltermessage.aspx)和[Form.KeyPreview](http://msdn.microsoft.com/en-us/library/system.windows.forms.form.keypreview.aspx)，但据我所知，当它应该由一些更具体的控件处理时，它们没有一种干净的方式来忽略键，因为它们之前得到了事件重点控制得到它。我真正想要的几乎是相反的——在焦点控件决定是否处理它之前，表单不会获得 KeyDown。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T21:57:19.183

您正在寻找键盘挂钩。

创建一个名为的类`KeyboardHook`，如下所示：

```
using System;
using System.Runtime.InteropServices;
using System.Windows.Forms;

public sealed class KeyboardHook : IDisposable
{
    // Registers a hot key with Windows.
    [DllImport("user32.dll")]
    private static extern bool RegisterHotKey(IntPtr hWnd, int id, uint fsModifiers, uint vk);
    // Unregisters the hot key with Windows.
    [DllImport("user32.dll")]
    private static extern bool UnregisterHotKey(IntPtr hWnd, int id);
    /// <summary>
    /// Represents the window that is used internally to get the messages.
    /// </summary>
    private class Window : NativeWindow, IDisposable
    {
        private static int WM_HOTKEY = 0X0312;

        public Window()
        {
            // create the handle for the window.
            this.CreateHandle(new CreateParams());
        }

        /// <summary>
        /// Overridden to get the notifications.
        /// </summary>
        /// <param name="m"></param>
        protected override void WndProc(ref Message m)
        {
            base.WndProc(ref m);

            // check if we got a hot key pressed.
            if (m.Msg == WM_HOTKEY)
            {
                // get the keys.
                Keys key = (Keys)(((int)m.LParam >> 16) & 0xFFFF);
                ModifierKeys modifier = (ModifierKeys)((int)m.LParam & 0xFFFF);

                // invoke the event to notify the parent.
                if (KeyPressed != null)
                    KeyPressed(this, new KeyPressedEventArgs(modifier, key));
            }
        }

        public event EventHandler<KeyPressedEventArgs> KeyPressed;

        #region IDisposable Members

        public void Dispose()
        {
            this.DestroyHandle();
        }

        #endregion
    }

    private Window _window = new Window();
    private int _currentId;

    public KeyboardHook()
    {
        // register the event of the inner native window.
        _window.KeyPressed += delegate(object sender, KeyPressedEventArgs args)
        {
            if (KeyPressed != null)
                KeyPressed(this, args);
        };
    }

    /// <summary>
    /// Registers a hot key in the system.
    /// </summary>
    /// <param name="modifier">The modifiers that are associated with the hot key.</param>
    /// <param name="key">The key itself that is associated with the hot key.</param>
    public void RegisterHotKey(ModifierKeys modifier, Keys key)
    {
        // increment the counter.
        _currentId = _currentId + 1;

        // register the hot key.
        if (!RegisterHotKey(_window.Handle, _currentId, (uint)modifier, (uint)key))
            throw new InvalidOperationException("Couldn’t register the hot key.");
    }

    /// <summary>
    /// A hot key has been pressed.
    /// </summary>
    public event EventHandler<KeyPressedEventArgs> KeyPressed;

    #region IDisposable Members

    public void Dispose()
    {
        // unregister all the registered hot keys.
        for (int i = _currentId; i > 0; i--)
        {
            UnregisterHotKey(_window.Handle, i);
        }

        // dispose the inner native window.
        _window.Dispose();
    }

    #endregion
}

/// <summary>
/// Event Args for the event that is fired after the hot key has been pressed.
/// </summary>
public class KeyPressedEventArgs : EventArgs
{
    private ModifierKeys _modifier;
    private Keys _key;

    internal KeyPressedEventArgs(ModifierKeys modifier, Keys key)
    {
        _modifier = modifier;
        _key = key;
    }

    public ModifierKeys Modifier
    {
        get { return _modifier; }
    }

    public Keys Key
    {
        get { return _key; }
    }
}

/// <summary>
/// The enumeration of possible modifiers.
/// </summary>
[Flags]
public enum ModifierKeys : uint
{
    Alt = 1,
    Control = 2,
    Shift = 4,
    Win = 8
} 
```

在你的表格中应该是这样的：

```
 KeyboardHook hook = new KeyboardHook();

    public Form1()
    {
        InitializeComponent();

        // register the event that is fired after the key press.
        hook.KeyPressed +=
        new EventHandler<KeyPressedEventArgs>(hook_KeyPressed);
        // register the control + alt + F12 combination as hot key.
        hook.RegisterHotKey(global::ModifierKeys.Control, Keys.A);
    }

    void hook_KeyPressed(object sender, KeyPressedEventArgs e)
    {
        if (e.Modifier == global::ModifierKeys.Control && e.Key == Keys.A)
        {
             //Some code here when hotkey is pressed.
        }

        if (textBox1 == ActiveControl)
        {
            // if textBox1 is in focus
        }
    } 
```

某些键组合不起作用，并且会在`RegisterHotKey(ModifierKeys modifier, Keys key)`方法上引发异常。

它似乎可以很好地使用 Ctrl 作为修饰符和任何字母作为键。

享受。

# javascript - JQuery - 提示文件然后处理它

> ID：15820496
> 
> 赞同：1
> 
> 时间：2013-04-04T19:54:24.340
> 
> 标签：javascript, jquery

所以我的目标是有一个按钮；当用户单击按钮时，系统会提示他们输入文件，然后程序对该文件执行某些操作。（可能通过要处理的 AJAX 请求发送它）目前我有以下实现，带有一个隐藏的表单和一个调用该表单单击的按钮。

```
<script>
   $(document).ready(function () 
   {
       $("#upload_button").click(function() { 
           $("#file_upload").click();
       });
   });
</script>

<input type="file" style="display:none" id="file_upload" />
<button id="upload_button">Upload File</button> 
```

这样，单击按钮会按预期提示用户输入文件，但我不知道如何插入代码以在用户选择文件后运行。如果我在 之后放置行`$("#file_upload").click();`，它将与用户上传同步运行。

我意识到我显然可以放第二个按钮，但是两个按钮似乎没有必要，而一个按钮确实可以。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T19:59:17.877

```
 $('input[type=file]').change(function() { 
      //do something!
  }); 
```

# css - @font-face 在文件夹中找不到字体

> ID：15820497
> 
> 赞同：3
> 
> 时间：2013-04-04T19:54:34.090
> 
> 标签：css, font-face, webfonts

我试图让@font-face 在位于文件夹 public_html/evansopen 的子域中工作。我有网站[http://coryfitzpatrick.com/evansopen/](http://coryfitzpatrick.com/evansopen/)正在运行。我想将 fontsquirrel 文件放在 evansopen/fonts 中，但是当我没有将它们放在与 styles.css 和 index.php（public_html/evansopen 文件夹）相同的位置时，它们不会加载。它目前以这种方式运行良好，但我喜欢保持我的文件结构干净。

我可以从 /evansopen/images/putting_green_footer.gif 文件夹中加载图像，没有这样的问题

```
#footer {
    background-image: url(images/putting_green_footer.gif); background-repeat: repeat;
} 
```

为什么我不能像这样让@font-face 直接指向 evansopen/fonts/？

```
@font-face {
    font-family: 'nexa_lightregular';
        src: url('fonts/nexa_light-webfont.eot');
        src: url('fonts/nexa_light-webfont.eot?#iefix') format('embedded-opentype'), 
             url('fonts/nexa_light-webfont.woff') format('woff'),
             url('fonts/nexa_light-webfont.ttf') format('truetype'),
             url('fonts/nexa_light-webfont.svg#nexa_lightregular') format('svg');
    font-weight: normal;
    font-style: normal;
} 
```

我对此进行了相当多的研究。如果这是一个多余的帖子，我很抱歉。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-04T19:59:26.547

**使用示例** `fontface`

您的 CSS 文件 (domain.com/path/custom-font.css)

```
font-family: 'nexa_lightregular';
      src: url('fonts/nexa_light-webfont.eot');
      src: url('fonts/nexa_light-webfont.eot?#iefix') format('embedded-opentype'), 
           url('fonts/nexa_light-webfont.woff') format('woff'),
           url('fonts/nexa_light-webfont.ttf') format('truetype'),
           url('fonts/nexa_light-webfont.svg#nexa_lightregular') format('svg');
font-weight: normal;
font-style: normal; 
```

您的字体文件必须上传

> domain.com/path/ **fonts** /nexa_light-webfont.ttf

例如

PS：这是关于你的`css`文件在哪里，所以`/fonts/`在相同的 CSS 文件路径中创建一个文件夹。

例如：domain.com/mycss.css -> domain.com/fonts/myfont.ttf

# html - HTML5 从表单选择创建 URL

> ID：15820501
> 
> 赞同：3
> 
> 时间：2013-04-04T19:54:41.427
> 
> 标签：html, forms, url

我有一个用户管理网站，我想拥有“更好”的 URL。本质上，客户端将看到一个用户列表，他们选择一个，然后他们可以查看该用户的页面。所以我有两个选择：

1.  我可以向用户展示一个像这样的 URL 的文字列表并让它滚动：

    ```
    <ul style="height:300px;overflow:auto">
    <li><a href="/profiles/1">User 1</a></li>
    <li><a href="/profiles/2">User 2</a></li>
    </ul> 
    ```

2.  我可以向用户展示一个更友好的表单/选择，如下所示：

    ```
    <form action="/profiles/" method="GET">
    <select name="user">
    <option value="1">User 1</option>
    <option value="2">User 2</option>
    </select>
    <input type="submit">
    </form> 
    ```

我对两者都有好恶，我真正想要的是两全其美：

1.  我想拥有像`/profiles/1`.

2.  我想让 UI 像一个简单的下拉菜单，用户只需键入项目的前几个字符，它就会跳转到它。（最后一部分有点大，有1000个用户）。它不必完全是这样，但在可用性方面是等效的。

3.  我不喜欢看起来`/profiles/?user=1`像`/profiles/1`.

到目前为止，我能想到的最好的办法就是`/profiles/?user=1`无缝地重定向到`/profiles/1`. 所以用户体验很流畅，但我很好奇是否有人可以做得更好:-)。

想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-24T11:45:16.427

我认为对于您的选项 2（通过表单生成 URL），您可以尝试以下操作：

```
<form id="urlForm" onsubmit="this.action = '/profiles/' + this.user.options[this.user.selectedIndex].value;" method="GET">
<select id="user">
<option value="1">User 1</option>
<option value="2">User 2</option>
<option value="3">User 3</option>
</select>
<input type="submit" />
</form> 
```

但是浏览器默认情况下可能不允许这种类型的脚本运行，如果脚本关闭或不可用，它当然根本不起作用。在我的测试中，这在 Chrome 中有效，在 Firefox 上失败，并且 IE 提示我接受正在运行的脚本。

如果有一个新的 HTML5 输出属性会很有用，这样您就可以计算表单/@action 的内容，但我想围绕这个有各种各样的安全问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T21:38:02.227

I suppose if you want to avoid javascript in the name of being a clever bastard, you could use a css :hover pseudo-class to expand a div containing typical anchor tags. Something like:

```
.dropdown_parent {
    height:1.25em;
    width:100px;
    display: inline_block;
    position:relative;
}
.dropdown {
    max-height:1.25em;
    overflow:hidden;
    line-height:1.25em;
    border: 1px solid black;
    background: white;
    position:absolute;
    top:0px;
    left:0px;
    right:0px;
}
.dropdown:hover {
    max-height:10em;
    overflow:auto;
} 
```

HTML:

```
<div class="dropdown_parent>
    <div class="dropdown">
        <a>link</a>
        <a>link</a>
        <a>link</a>
    </div>
</div> 
```

Note that I have not tested this at all.

More seriously, javascript is pretty much the way to go for this kind of thing.

# python - 在 Sublime Text 2 中运行脚本时出现常量 [错误 2]

> ID：15820502
> 
> 赞同：-1
> 
> 时间：2013-04-04T19:54:41.913
> 
> 标签：python, sublimetext2

我正在使用 Sublime Text 2。我最近编写的一个脚本不断给我一个恒定的 [错误 2] 消息。然后我意识到它正在为我的**所有**脚本执行此操作，甚至像（打印“Hello World！”）一样简单。根据错误消息的详细信息，解释器似乎指向某种路径，我不知道它是如何变成这样的。我怎样才能解决这个问题？谢谢！

```
[Error 2] The system cannot find the file specified 
[cmd:  [u'python', u'-u', u'C:\\Users\\Sam\\Desktop\\hello.py']]
[dir:  C:\Users\Sam\Desktop]
[path: C:\Program Files\NVIDIA Corporation\PhysX\Common;C:\Program Files\Common      
Files\Microsoft Shared\Windows 
Live;C:\Windows\system32;C:\Windows;C:\Windows\System32\Wbem;C:\Windows\
System32\WindowsPowerShell\v1.0\;C:\Program Files\TortoiseSVN\bin;C:\Program  
Files\QuickTime\QTSystem\] 
```

[完成的]

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T19:59:18.810

看起来你的路径中没有 python

您要么需要将其添加到您的路径中（如果已安装）

或者

你需要安装python ...

# lucene - Lucene.net PerFieldAnalyzerWrapper

> ID：15820504
> 
> 赞同：2
> 
> 时间：2013-04-04T19:54:44.387
> 
> 标签：lucene, analyzer

我已经阅读了如何使用每个字段分析器包装器，但无法让它与我的自定义分析器一起使用。我什至无法让分析器运行构造函数，这让我相信我实际上错误地调用了每个字段分析器。

这就是我正在做的事情：

创建每个字段分析器：

```
PerFieldAnalyzerWrapper perFieldAnalyzer = new  PerFieldAnalyzerWrapper(srchInfo.GetAnalyzer(true));
perFieldAnalyzer.AddAnalyzer("<special field>", dta); 
```

像往常一样添加所有字段做文档，包括我们以不同方式分析的特殊字段。

并像这样使用分析器添加文档：

```
iw.AddDocument(doc, perFieldAnalyzer); 
```

我在正确的轨道上吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T18:26:43.180

这个问题与我对 CMS (Kentico) 内置 Lucene 助手类的依赖有关。基本上，使用这些类，您需要通过 CMS 在索引级别指定自定义分析器，而我不希望这样做。所以我最终几乎在任何地方都直接使用了 Lucene.net，获得了使用我想要的任何自定义分析器的灵活性

我还对数据结构进行了一些更改，最终使用了久经考验的 KeywordAnalyzer 来分析文档标签。以前我试图对逗号分隔的值（如 [tag1, tag2, tag with many parts] 做一些自定义标记化魔术，但无法使其可靠地与多部分标签一起使用。我仍然保留该字段，但开始在文档中添加多个“标签”字段，每个字段都存储一个标签。所以现在我有“N”个标签的 N 个“标签”字段，每个都被分析为一个关键字，这意味着每个标签（一个词或多个）都是一个标记。

我想我最初的方法想太多了。

这就是我最终得到的。

关于索引：

```
KeywordAnalyzer ka = new KeywordAnalyzer();
PerFieldAnalyzerWrapper perFieldAnalyzer = new PerFieldAnalyzerWrapper(srchInfo.GetAnalyzer(true));
perFieldAnalyzer.AddAnalyzer("documenttags_t", ka);

-- Some procedure to compile all documents by reading from DB and putting into Lucene docs

foreach(var doc in docs)
{
   iw.AddDocument(doc, perFieldAnalyzer);
} 
```

搜索时：

```
KeywordAnalyzer ka = new KeywordAnalyzer();
PerFieldAnalyzerWrapper perFieldAnalyzer = new PerFieldAnalyzerWrapper(srchInfo.GetAnalyzer(true));
perFieldAnalyzer.AddAnalyzer("documenttags_t", ka);

string baseQuery = "documenttags_t:\"" + tagName + "\"";
Query query = _parser.Parse(baseQuery);
var results = _searcher.Search(query, sortBy) 
```

# c# - DbEntityValidationException - 如何轻松判断导致错误的原因？

> ID：15820505
> 
> 赞同：223
> 
> 时间：2013-04-04T19:54:47.010
> 
> 标签：c#, entity-framework

我有一个使用实体框架的项目。在调用`SaveChanges`my`DbContext`时，出现以下异常：

> System.Data.Entity.Validation.DbEntityValidationException：一个或多个实体的验证失败。有关更多详细信息，请参阅“EntityValidationErrors”属性。

这一切都很好而且很花哨，但我不想每次发生此异常时都附加调试器。此外，在生产环境中，我无法轻松附加调试器，因此我必须竭尽全力重现这些错误。

如何查看隐藏在 中的详细信息`DbEntityValidationException`？

* * *

## 回答 #1

> 赞同：437
> 
> 时间：2013-04-04T19:54:47.010

最简单的解决方案是覆盖`SaveChanges`您的实体类。您可以捕获、解包实际错误并使用改进的消息`DbEntityValidationException`创建新错误。`DbEntityValidationException`

1.  在您的 SomethingSomething.Context.cs 文件旁边创建一个部分类。
2.  使用本文底部的代码。
3.  就是这样。您的实现将自动使用覆盖的 SaveChanges，而无需任何重构工作。

您的异常消息现在将如下所示：

> System.Data.Entity.Validation.DbEntityValidationException：一个或多个实体的验证失败。有关更多详细信息，请参阅“EntityValidationErrors”属性。验证错误是：字段PhoneNumber必须是字符串或数组类型，最大长度为'12'；姓氏字段是必需的。

您可以在继承自的任何类中删除覆盖的 SaveChanges `DbContext`：

```
public partial class SomethingSomethingEntities
{
    public override int SaveChanges()
    {
        try
        {
            return base.SaveChanges();
        }
        catch (DbEntityValidationException ex)
        {
            // Retrieve the error messages as a list of strings.
            var errorMessages = ex.EntityValidationErrors
                    .SelectMany(x => x.ValidationErrors)
                    .Select(x => x.ErrorMessage);

            // Join the list to a single string.
            var fullErrorMessage = string.Join("; ", errorMessages);

            // Combine the original exception message with the new one.
            var exceptionMessage = string.Concat(ex.Message, " The validation errors are: ", fullErrorMessage);

            // Throw a new DbEntityValidationException with the improved exception message.
            throw new DbEntityValidationException(exceptionMessage, ex.EntityValidationErrors);
        }
    }
} 
```

`DbEntityValidationException`还包含导致验证错误的实体。因此，如果您需要更多信息，您可以更改上述代码以输出有关这些实体的信息。

**另见：[http ://devillers.nl/improving-dbentityvalidationexception/](http://devillers.nl/improving-dbentityvalidationexception/)**

* * *

## 回答 #2

> 赞同：49
> 
> 时间：2013-10-07T16:31:26.647

正如 Martin 所指出的，在`DbEntityValidationResult`. 我发现在每条消息中同时获取我的 POCO 类名和属性名很有用，并且希望避免为此在我的所有标签`ErrorMessage`上编写自定义属性。`[Required]`

以下对 Martin 代码的调整为我处理了这些细节：

```
// Retrieve the error messages as a list of strings.
List<string> errorMessages = new List<string>();
foreach (DbEntityValidationResult validationResult in ex.EntityValidationErrors)
{
    string entityName = validationResult.Entry.Entity.GetType().Name;
    foreach (DbValidationError error in validationResult.ValidationErrors)
    {
        errorMessages.Add(entityName + "." + error.PropertyName + ": " + error.ErrorMessage);
    }
} 
```

* * *

## 回答 #3

> 赞同：45
> 
> 时间：2015-08-09T09:52:57.177

要查看`EntityValidationErrors`集合，请将以下 Watch 表达式添加到 Watch 窗口。

```
((System.Data.Entity.Validation.DbEntityValidationException)$exception).EntityValidationErrors 
```

我正在使用视觉工作室 2013

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2016-03-14T23:26:35.997

当您在块内处于调试模式时，`catch {...}`打开“QuickWatch”窗口（`ctrl`++ `alt`）`q`并粘贴到那里：

```
((System.Data.Entity.Validation.DbEntityValidationException)ex).EntityValidationErrors 
```

这将允许您深入到`ValidationErrors`树中。这是我发现即时了解这些错误的最简单方法。

对于只关心第一个错误并且可能没有`catch`阻塞的 Visual 2012+ 用户，您甚至可以这样做：

```
((System.Data.Entity.Validation.DbEntityValidationException)$exception).EntityValidationErrors.First().ValidationErrors.First().ErrorMessage 
```

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2016-10-20T00:21:54.483

通过在调试期间检查错误来快速找到有意义的错误消息：

*   添加快速观看：

    ```
    ((System.Data.Entity.Validation.DbEntityValidationException)$exception).EntityValidationErrors 
    ```

*   **像这样深入研究 EntityValidationErrors：**

    （集合项，例如 [0]）> ValidationErrors >（集合项，例如 [0]）> ErrorMessage

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2016-10-26T23:14:04.787

实际上，这只是验证问题，EF 会在对数据库进行任何更改之前先验证实体属性。因此，EF 会检查属性的值是否超出范围，就像您设计表格时一样。Table_Column_UserName 是 varchar(20)。但是，在 EF 中，您输入的值大于 20。或者，在其他情况下，如果该列不允许为 Null。因此，在验证过程中，您必须为非空列设置一个值，无论您是否要对其进行更改。我个人喜欢 Leniel Macaferi 的回答。它可以向您显示验证问题的详细信息

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2015-08-18T22:07:14.870

我认为“实际验证错误”可能包含敏感信息，这可能是微软选择将它们放在另一个地方（属性）的原因。此处标记的解决方案是实用的，但应谨慎使用。

我更愿意创建一个扩展方法。更多原因：

*   保留原始堆栈跟踪
*   遵循开放/封闭原则（即：我可以为不同类型的日志使用不同的消息）
*   在生产环境中，可能会在其他地方（即：其他 dbcontext）抛出 DbEntityValidationException。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2018-03-15T16:27:15.073

对于 Azure Functions，我们使用*Microsoft.Extensions.Logging.ILogger这个简单的扩展*

```
public static class LoggerExtensions
{
    public static void Error(this ILogger logger, string message, Exception exception)
    {
        if (exception is DbEntityValidationException dbException)
        {
            message += "\nValidation Errors: ";
            foreach (var error in dbException.EntityValidationErrors.SelectMany(entity => entity.ValidationErrors))
            {
                message += $"\n * Field name: {error.PropertyName}, Error message: {error.ErrorMessage}";
            }
        }

        logger.LogError(default(EventId), exception, message);
    }
} 
```

和示例用法：

```
try
{
    do something with request and EF
}
catch (Exception e)
{
    log.Error($"Failed to create customer due to an exception: {e.Message}", e);
    return await StringResponseUtil.CreateResponse(HttpStatusCode.InternalServerError, e.Message);
} 
```

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2014-10-02T16:24:43.283

在您的代码中使用 try 块，例如

```
try
{
    // Your code...
    // Could also be before try if you know the exception occurs in SaveChanges

    context.SaveChanges();
}
catch (DbEntityValidationException e)
{
    foreach (var eve in e.EntityValidationErrors)
    {
        Console.WriteLine("Entity of type \"{0}\" in state \"{1}\" has the following validation errors:",
            eve.Entry.Entity.GetType().Name, eve.Entry.State);
        foreach (var ve in eve.ValidationErrors)
        {
            Console.WriteLine("- Property: \"{0}\", Error: \"{1}\"",
                ve.PropertyName, ve.ErrorMessage);
        }
    }
    throw;
} 
```

您也可以在此处查看详细信息

1.  [http://mattrandle.me/viewing-entityvalidationerrors-in-visual-studio/](http://mattrandle.me/viewing-entityvalidationerrors-in-visual-studio/)

2.  [一个或多个实体的验证失败。有关更多详细信息，请参阅“EntityValidationErrors”属性](https://stackoverflow.com/questions/7795300/validation-failed-for-one-or-more-entities-see-entityvalidationerrors-propert)

3.  [http://blogs.infosupport.com/improving-dbentityvalidationexception/](http://blogs.infosupport.com/improving-dbentityvalidationexception/)

# mysql - 是否可以完全匹配“WHERE IN”查询中的值？

> ID：15820507
> 
> 赞同：0
> 
> 时间：2013-04-04T19:54:55.863
> 
> 标签：mysql, where

我有一个具有这种结构的表：

```
ID | level1 | level2 | level3 
```

每个字段都存储一个整数。然后我有一个这样的数组： $array (1,2,8,9,15)

我想在任何字段 level1、level2 或 level3 中获取包含数组中值的所有行。

我试试这个：

```
SELECT P.* FROM table P 
WHERE level1 OR level2 OR level3 IN (".$array.") 
```

问题是，如果数组包含例如数字 1，则查询获取具有 10、11、12 的行...

有没有办法使值完全匹配？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T20:03:18.580

问题不是你想的那样。如目前所写，您的查询将返回列表中 level1 != 0 OR level2 != 0 OR level3 的任何行，因为 level1 和 level2 被评估为布尔值。

您需要有 3 个单独的`IN`子句，如下所示：

```
SELECT P.* 
FROM table P 
WHERE level1 IN (...) 
OR level2 IN (...) 
OR level3 IN (...) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T22:29:43.623

IN 选择器要求与数组中的值之一完全匹配。你这里有几个问题。首先，您不能像使用 OR 一样使用不需要为每个字段指定 IN，如下所示：

```
SELECT P.* FROM table P 
WHERE
level1 IN (...)
OR level2 IN (...)
OR level3 IN (...) 
```

其次，您不能像尝试这样的方式来回显您的数组：

```
$in_string = "'" . implode("','", $array) . "'";
$query = "SELECT P.* FROM table P 
    WHERE
    level1 IN ($in_string)
    OR level2 IN ($in_string)
    OR level3 IN ($in_string)"; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-04T20:00:09.533

您可以使用[FIND_IN_SET](http://dev.mysql.com/doc/refman/5.0/en/string-functions.html#function_find-in-set)：

```
SELECT P.* FROM P 
WHERE
  FIND_IN_SET(level1, '".$array."') OR
  FIND_IN_SET(level2, '".$array."') OR
  FIND_IN_SET(level3, '".$array."') 
```

请[在此处](http://sqlfiddle.com/#!2/593f3/1)查看小提琴。

# r - 自动绘制（并保存）xts 对象列表

> ID：15820509
> 
> 赞同：2
> 
> 时间：2013-04-04T19:54:58.410
> 
> 标签：r, list, plot, xts, quantmod

我有一长串`xts`对象，我想自动绘制并将它们保存到一个文件夹中（因为手动处理 >500 个图需要很长时间）。棘手的部分似乎是将函数应用于`xts`对象列表。例如，根据日期获取列表元素的通用命名方法（列表`xts`中的每个对象都是唯一的一天），并绘制每个对象并将它们保存到具有自己名称的文件路径中。

**数据**可以在以前的帖子中[找到](https://stackoverflow.com/questions/15620935/subset-xts-object-using-vector-of-unique-index-days)。每个`xts`元素都是列表中唯一的一天，带有价格和数量列。我正在使用最新的 R (2.15) 包 xts、TTR 和 quantmod。

根据r-bloggers上的一篇精彩[文章](http://www.r-bloggers.com/automatically-save-your-plots-to-a-folder/)，我已经尝试使用此代码来命名列表元素：

```
names(sample.data.uniquePOS) <- paste0("sample.data.uniquePOS", lapply(sample.data.uniquePOS, function(x) .indexday(sample.data.uniquePOS))) 
```

这应该通过它们的日期索引来命名它们（例如，如果 2012 年 1 月 1 日，那么它将是“2012-01-01”作为元素名称）。不幸的是，它不起作用，生成一个长度列表，`sample.data.uniquePOS`但每个元素都命名为`sample.data.uniquePOSnumeric(0)`。我认为问题在于`.indexday`被应用于列表，而应该应用于`xts`对象，但我不知道如何解决它。

下一步是生成将绘图保存到的文件路径，然后执行绘图：

```
mypath <- file.path("C:", "Documents and Settings", 
                              paste("Date_", names(sample.data.uniquePOS), ".jpg", sep = ""))

jpg(file=mypath)
mytitle = paste("my title is", names(sample.data.uniquePOS))
candleChart(sample.data.uniquePOS[[1]]:sample.data.uniquePOS[[length(sample.data.uniquePOS)]])
dev.off()
} 
```

这有同样的问题，`candleChart`需要应用于`xts`对象而不是列表：

```
Error in try.xts(x, error = "chartSeries requires an xtsible object") : 
  chartSeries requires an xtsible object 
```

我真的很感激这方面的帮助！

# jquery - 用于切换表中所有行的下拉列表是/否值的 jQuery 按钮

> ID：15820513
> 
> 赞同：3
> 
> 时间：2013-04-04T19:55:06.680
> 
> 标签：jquery, drop-down-menu

我有一个表，它的每一行都有一个（是/否）下拉菜单，我想使用一个按钮使用 jQuery 将下拉菜单的值更改为是。这就是我正在尝试的： HTML：

```
<select name="activeFlag">
    <option value="true">Yes</option>
    <option value="false">No</option>
</select> 
<br />
<input type="button" value="Activate All" id="activateAllButton"> 
```

jQuery：

```
$(document).ready(
        function()
        {
            jQuery('#activateAllButton').button();
            $('#activateAllButton').click(
            function() 
            {
                $('select>option:eq(0)').attr('selected', true);
            });
        }); 
```

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T19:58:25.247

只需制作点击处理程序：

```
$('#activateAllButton').click(function() {
    $('select').val('true');
}); 
```

**[jsFiddle 示例](http://jsfiddle.net/j08691/ZP9dY/)**

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-04T19:58:36.003

而不是`.attr()`，使用[`.prop()`](http://api.jquery.com/prop/).

```
$(document).ready(
        function()
        {
            jQuery('#activateAllButton').button();
            $('#activateAllButton').click(
            function() 
            {
                $('select>option:eq(0)').prop('selected', true);
            });
        }); 
```

演示：http: [//jsfiddle.net/dirtyd77/UKKKR/1/](http://jsfiddle.net/dirtyd77/UKKKR/1/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-04T20:06:16.033

让我知道此代码是否适合您

```
$("#activateAllButton").click(function () {
    $("#myTable td select[name='activeFlag']").val('True');
}); 
```

[jsFiddle](http://jsfiddle.net/qHjex/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-04T20:07:22.997

其他 2 个答案都是正确的，但我只是想展示一个使用缓存的更高效的版本：

```
$(document).ready(function ()
{
    var $buttons = $('#activateAllButton'),
        $select = $('select');

    $buttons.button().on('click', function () 
    {
        $select.val('true');
    });
}); 
```

***[请参阅工作 jsFiddle 演示](http://jsfiddle.net/DotNetScott/N9KBw/)***

# jsp - 如何使用 JSP 从服务器硬盘为特定用户动态检索图像

> ID：15820514
> 
> 赞同：0
> 
> 时间：2013-04-04T19:55:07.053
> 
> 标签：jsp

我正在处理用户上传图像的应用程序。应用程序获取文件名，通过将特定用户的用户名附加到文件名来对其进行编辑，然后将其存储在服务器的硬盘中。

我在这里打算为特定用户加载特定图像。我计划通过使用会话对象来做到这一点。但我仍然无法找到解决方案。

那么您能否提供一个解决方案，用于使用特定用户的会话对象来检索/显示图像。您知道我是使用 JSP 维护会话和存储会话变量的新手。我已经为它编写了一些代码，但恐怕我在链接 jsfiddle 上的代码时遇到了一些错误......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T20:24:22.640

您的问题非常笼统，如果您粘贴一些到目前为止所做的代码会有所帮助。无论如何，这是一个从会话中提取 USER_ID 属性并链接到应该返回图像的 url 的基本代码：

```
<%
//extract the property of the user session
String userId = (String) request.getSession().getAttribute("USER_ID");
//build the image url
String imageUrl = "http://yourserver.com/yourimagefoler/"+userId+".jpg";
%>
<!--HTML code to show the image -->
<img src="<%=imageUrl%>" /> 
```

ps：需要将USER_ID设置为会话对象，并且需要根据保存图像文件的文件夹更改imageURL

# c# - C# ComboBox 使用 Dictionary 值中的 Property 作为 DisplayMember，Dictionary 值本身作为 ValueMember

> ID：15820517
> 
> 赞同：0
> 
> 时间：2013-04-04T19:55:13.007
> 
> 标签：c#, winforms

我有一个字典，我正在尝试用它填充一个 ComboBox。我的 Settings 类有一个名为 Symbol 的字符串属性，这是我想要在下拉列表中显示的内容，并且我希望 comboBox.SelectedItem 成为一个 Settings 对象。到目前为止，我已经尝试过：

```
comboBox.DataSource = dictionary.Values.ToList();
comboBox.DisplayMember = "Symbol";
comboBox.ValueMember = null; 
```

和

```
BindingSource bindingSource = new BindingSource();
bindingSource.DataSource = dictionary.Values.ToList();
comboBox.DataSource = bindingSource;
comboBox.DisplayMember = "Symbol";
comboBox.ValueMember = null; 
```

我不需要为我正在做的事情绑定数据，我很乐意在构造函数中添加一次所有内容，但是使用 DataSource 而不是循环遍历 dictionary.Values 似乎更干净。预先感谢您的帮助。

# string - 使用三字符语言对图形进行编码？

> ID：15820521
> 
> 赞同：1
> 
> 时间：2013-04-04T19:55:25.933
> 
> 标签：string, graph, graph-algorithm, representation

假设您有一个只有三个字符的字母表，例如`0, 1, @`. 如何`G = (V, E)`仅使用这些字符的字符串来表示未加权（所有顶点和边的权重为 1）的无向图？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T20:05:53.657

你可以试试邻接矩阵。

[http://en.wikipedia.org/wiki/Adjacency_matrix](http://en.wikipedia.org/wiki/Adjacency_matrix)

也许使用 @ 来表示每个新行。

所以 100@010@001@ 将是单位矩阵

# python - 测试项目不同版本的应用程序

> ID：15820522
> 
> 赞同：1
> 
> 时间：2013-04-04T19:55:27.260
> 
> 标签：python

我的任务是创建一个 GUI 或者一个 Web 应用程序，让项目中的开发人员测试正在开发的代码的不同版本：

1.  将所有基线的编译后的可执行文件及其关联的配置文件存储在服务器上的一个目录中。
2.  测试可执行文件的程序可以位于服务器上的同一目录中。什么都行。
3.  让用户决定显示其内容的两个可执行文件，并让用户根据需要更改参数。
4.  用户现在应该能够点击一个按钮，该按钮运行带有相关参数的两个可执行文件。
5.  可执行文件创建包含代表空间路径的数字列表的文本文件。这些应该以图形方式显示，以便用户可以比较两个版本的可执行文件和它们输入的参数。

我有一点 Perl 经验和一些 C++ 经验，但我希望这可以成为学习 Python 的借口，但我有几个问题：

我只是想知道是否有适合这项工作的更好的语言/工具？

我应该使用哪些库？

如果我们决定应该通过浏览器完成，我应该使用什么？

在开始这样的事情之前，一个相对缺乏经验的程序员应该知道的任何其他事情？

非常感谢！

# javascript - 添加无限滚动以查看页面

> ID：15820525
> 
> 赞同：1
> 
> 时间：2013-04-04T19:55:35.213
> 
> 标签：javascript, asp.net-mvc, infinite-scroll

我在更改无限滚动 javascript 时遇到了一些麻烦，因此它可以在我的视图页面上运行，并且不确定要更改或添加什么。我正在使用淘汰赛 js 用 JSON 加载我的数据。

**查看页面**

```
 <section id="rosterImages">
        <section id="users" data-bind="foreach: RosterUsers">
            <div id="nameImage">
                <figure>
                    <img width="158" height="158" alt="Gravatar" data-bind="attr:{src: GravatarUrl}"/>
                </figure>
                <span data-bind="text:Name"></span>
                </div>
            </section>
    </section> 
```

**来自[https://github.com/paulirish/infinite-scroll的](https://github.com/paulirish/infinite-scroll)**无限滚动 Javascript****

 **```
$.infinitescroll.defaults = {
    loading: {
        finished: undefined,
        finishedMsg: "<em>Congratulations, you've reached the end of the internet.</em>",
        img: "data:image/gif;base64...",
        msg: null,
        msgText: "<em>Loading the next set of posts...</em>",
        selector: null,
        speed: 'fast',
        start: undefined
    },
    state: {
        isDuringAjax: false,
        isInvalidPage: false,
        isDestroyed: false,
        isDone: false, // For when it goes all the way through the archive.
        isPaused: false,
        currPage: 1
    },
    debug: false,
    behavior: undefined,
    binder: $(window), // used to cache the selector
    nextSelector: "div.navigation a:first",
    navSelector: "div.navigation",
    contentSelector: "section", // rename to pageFragment
    extraScrollPx: 150,
    itemSelector: "div.post",
    animate: false,
    pathParse: undefined,
    dataType: 'html',
    appendCallback: true,
    bufferPx: 40,
    errorCallback: function () { },
    infid: 0, //Instance ID
    pixelsFromNavToBottom: undefined,
    path: undefined, // Either parts of a URL as an array (e.g. ["/page/", "/"] or a function that takes in the page number and returns a URL
    prefill: false, // When the document is smaller than the window, load data until the document is larger or links are exhausted
    maxPage: undefined // to manually control maximum page (when maxPage is undefined, maximum page limitation is not work)
}; 
```**

# python - 使用封装/函数修改变量并将其传递给当前命名空间

> ID：15820526
> 
> 赞同：0
> 
> 时间：2013-04-04T19:55:36.460
> 
> 标签：python, encapsulation

我正在尝试编写一个函数，该函数获取 CSV 文件的标题并将其存储为列表，稍后将很有用：

```
def getHeader(filename, headername):
     import csv
     charList = ['a', 'b', 'c', 'd', 'e', 'A', 'B', 'C', 'D', 'E', 'F'] <<<---a lot longer
     headercsv = open(filename, 'r', newline = '')
     headerreader = csv.reader(headercsv, delimiter = ',')
     for row in headerreader:
         if row[0][0] in charList:
              headername = row

     headercsv.close()
     return headername 
```

然后我执行以下操作：

```
thisHeader = []
getHeader('csvfile.csv', thisHeader) 
```

如果我在 shell 中尝试这个，它会返回正确的信息，但是当我尝试查看变量中包含的信息时`thisHeader`，它只返回`[]`一个空白列表。

我还定义了另一个函数来汇总每个队列的每个条目的人口信息。需要用到上面函数中得到的header，定义如下：

```
def newPopCount(filename, fileheader, popholder):
     import csv
     cohorts = []
     for i in range (3, len(fileheader)):
          cohorts.append(fileheader[i])
     for i in range (len(cohorts)):
          popholder.append(0)

     popcsv = open(filename, 'r', newline = '')
     popreader = csv.reader(popcsv, delimiter = ',')

     for row in popreader:
         counter = 0
         if row[0] == fileheader[0]:
             continue
         else:
             for i in range(3, len(fileheader)):
                 popholder[counter] += int(row[i])
                 counter += 1

     popcsv.close()
     return popholder 
```

我在另一个函数中定义了这些函数，以便只调用带有文件名的最外层函数，`test('csvfile.csv')`然后使用一些打印语句来评估代码是否正在执行它应该做的事情，方法是将从一个函数获得的信息传递给其他功能 - 他们不是。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T20:00:50.347

您正在为 python 如何处理引用而苦苦挣扎——赋值运算符从右侧的表达式中获取对象，并将其绑定到左侧的本地名称（“覆盖”任何提前引用的名称）。所以，像这样的函数：

```
a = []
def foo(lst):
    lst = [1]

foo(a)
print a #[] 
```

永远不会更新`a`。相反，在函数内部，您在赋值右侧创建一个新列表，并将其绑定到参数左侧的*本地名称。*

这与预期基本相同：

```
a = []
b = a
b = [1]
print a #[] 
```

修改`a`（它不会）。

但是，您可以执行将改变函数中列表的操作：

```
def foo(lst):
    lst.append(1)

a = []
foo(a)
print a #[1] 
```

在最后一种情况下，如果您总是希望输入一个空列表，那么编写如下内容更为惯用：

```
def foo():
    return [1]

a = foo() 
```

*当您可以直接返回*填充列表并让调用者做任何他们想做的事情时，调用者不需要创建一个空列表只是为了将它传递给函数。（**这是其他人在他们的答案中推荐的方法，我完全同意他们**）。

* * *

请注意，在 python 中，一个函数通常会修改其参数以返回`None`以清楚地表明参数正在发生变化。你有时会看到类似的东西：

```
def foo(lst):
    a = [x*x for x in lst]
    return a

a = [1, 2, 3]
a = foo(a)  #Nothing wrong with this. 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T20:01:07.577

你不是把事情复杂化了吗？

```
def getHeader(filename):
     import csv
     headername = None
     charList = ['a', 'b', 'c', 'd', 'e', 'A', 'B', 'C', 'D', 'E', 'F']
     headercsv = open(filename, 'r', newline = '')
     headerreader = csv.reader(headercsv, delimiter = ',')
     for row in headerreader:
         if row[0][0] in charList:
              headername = row

     headercsv.close()
     return headername 
```

现在你可以：

```
thisHeader = getHeader('csvfile.csv') 
```

确保您了解函数的工作原理，以及按值传递和按引用传递之间的区别。

# scala - 如何将在不同时间生成的静态文件结果呈现给客户端播放 2？

> ID：15820527
> 
> 赞同：1
> 
> 时间：2013-04-04T19:55:39.033
> 
> 标签：scala, playframework, playframework-2.0

我正在使用 scala 中的 play 2.0 编写 Web 服务。

获取客户端的配置参数后，Web 服务将需要一段时间来生成一些文件。（注意：有些文件可能很短，有些文件可能很长）。

我想出了如何获取客户的配置并触发我的计算，

现在我需要在会话结束时将生成的文件呈现给客户端。

所以问题是：

*   如何将文件呈现给客户？

我正在考虑将静态文件夹链接返回给客户端，以便他们可以进入文件夹以进一步查看那里有哪些文件，因此当单击文件时，可以显示文件的详细信息，无论是 jpg 还是文本.

但是怎么做？

*   如何在文件生成期间不阻止客户端？

例如，客户端仍然可以单击当时可用的文件。那么第三个问题来了：

*   如何让客户端知道长时间计算文件可用并在文件夹中列出？

我对 Web 应用程序很陌生，感谢您的任何建议、建议或小示例也非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T10:56:05.040

我将创建一个 Web 界面来向您的客户显示创建的文件，并为长时间的计算过程创建一个后台作业。您可以创建一个等待页面，其中 javascript 检查文件是否已创建。

# jquery - 在 jQuery ui Dialog 窗口中加载 MVC4 PartialView

> ID：15820535
> 
> 赞同：3
> 
> 时间：2013-04-04T19:56:07.353
> 
> 标签：jquery, asp.net-mvc, jquery-ui, asp.net-mvc-4

我正在尝试在 jQuery ui 对话框窗口中显示部分视图，但我对加载函数没有太多运气。对话窗口确实打开了，但我没有看到部分视图的内容。

JS 代码位于外部 js 文件中。警报确实显示。

```
$(document).ready(function () {
    $('#dialog-modal').dialog({
        autoOpen: false,
        //width: 200,
        height: 400,
        modal: true,
        open: function (event, ui) {
            //alert("test");
            $(this).load("@Url.Action(\"OpenDialogWindow\", \"Home\" )");
        }
    });
}); 
```

==================================================== =================

我的 div 在这样的母版页上。

```
 <div id="dialog-modal" title="Select a city to see the listings">  </div> 
```

=========================

我的 ActionResult 看起来像这样。我确实将视图设置为部分视图。

```
public ActionResult OpenDialogWindow()
        {
            return PartialView("DialogView");
        } 
```

=========================

我的观点是这样的。

```
@using TheSGroup_Web.ViewModels
@model CitiesViewModel

    <p>this is the content.
    </p> 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-20T14:42:47.123

我不确定 MVC 2 或 3，但在 MVC 4 中，这就是我让它工作的方式。

```
$(document).ready(function () {
    $('#dialog-modal').dialog({
        autoOpen: false,
        modal: true,
        open: function (event, ui) {
            //alert("test");
            $(this).load("/Controller/Action");
        }
    });
});

function OpenDialog() {
    $('#dialog-modal').dialog('open');
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T23:04:23.090

您总是可以向您的局部视图发出 ajax 请求，检查状态代码，以防出现问题而您需要做其他事情，并将响应数据存储在变量中。如果状态码是 200（OK），然后在 open: 方法中加载带有变量的对话框，否则，做一些很酷的事情......我不知道我脑海中的确切代码，但它不会t be tuff 我不认为...

# android - 带有 CSipSimple 和 pjsip 的 Android SIP

> ID：15820547
> 
> 赞同：7
> 
> 时间：2013-04-04T19:56:47.597
> 
> 标签：android, sip, voip, pjsip, csip-simple

我正在编写一个自定义 Android 应用程序，允许用户使用 SIP 进行 VOIP 呼叫。当用户按下按钮时，将与另一个 SIP 用户发起语音呼叫。而已。唯一的其他要求是它必须在 2.3+ Android 设备上运行，并且不能仅限于 wifi。

Android 已经包含一个 SIP 堆栈（从 2.3 开始），我能够修改 Walkie-Talkie 示例项目以完全按照我想要的方式工作。不幸的是，我无法在某些设备上使用这个应用程序（Casio Commando 就是其中之一），更糟糕的是，该应用程序只能在 wifi 上运行（正如我所提到的，这对我的项目来说是不可接受的）。

我开始寻找另一个具有易于使用的 API 的 SIP 堆栈，并遇到了 CSimpleSip。我编译了它并运行了他们的演示项目（SipHome），它在我不受支持的手机（包括 Commando）上完美运行，它也可以通过 wifi 运行，满足我的要求。我非常兴奋……直到我查看了 CSipSimple 的源代码。我不知道如何开始提取对底层 pjsip API 的实际调用，也无法让 pjsip 演示应用程序在 10 多个小时后工作。

有没有人解构 CSipSimple 并将 SIP 部分从他们极其复杂的 UI 中分离出来，或者是否有人知道更简单的 SIP 库？使用本机 SIP API，我能够制作一个 200 行的 Android 活动，完美地进行调用......我如何使用支持非 wifi 的第三方 SIP 堆栈来实现这一点？

感谢您的任何意见，我知道很多人都被困在同一阶段。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-09T17:33:55.933

与其选择更复杂的 CSipSimple，不如攻击最基本的 apjsua，它运行相同的 pjsip 堆栈，因此它也有望满足您的要求：[http ://trac.pjsip.org/repos/wiki/Getting-已启动/安卓](http://trac.pjsip.org/repos/wiki/Getting-Started/Android)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-11T16:32:39.340

我完全同意 Balint，apjsua 是可以帮助您更好地理解的应用程序，但是当您不熟悉 C 时（就像我一样），从它开始可能并不明显，但这种方式效率更高。

你可以看看[www.pjsip.org](http://www.pjsip.org)，只关心你要下载的包，因为教程不是很清楚：例如，他们谈论了很多关于 apjsua（pjsua 的 android 实现）和这个应用程序不包含在他们提供的下载链接中，您可以在这里看到我的问题： [apjsua 在哪里？](https://stackoverflow.com/questions/15477556/wheres-apjsua)

当然，您必须在 pjsip 网站上观看 android 教程。

希望这可以帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-10-03T06:34:42.733

> 使用 csipsimple 作为库项目。在 csipsimple 项目中有一个 api 可以将其用作库。您可以绑定到 csipsimple 服务并进行调用。

注册广播接收器和意图过滤器以从 csipsimple 获取回调。分析 csipsimple 中的 Incall 活动以获取更多详细信息。

# c++ - 在 C++ 中将整数变量附加到 char 变量

> ID：15820552
> 
> 赞同：1
> 
> 时间：2013-04-04T19:56:58.673
> 
> 标签：c++, visual-c++

我是 C++ 新手，我有一个小项目，我应该从用户那里获得 10 个数字，然后显示结果。

所以我写了这段代码：

```
#include<stdio.h>
int main() {
    int counter=1,
        allNumbers;
    float score;
    while(counter <= 10) {
        scanf("%f",&score);
        counter++;
    }

    printf("Your entered numbers are : %s\n",allNumber);
} 
```

例如用户输入 2 3 80 50 ... 我想在结果中显示 2,3,80,50,...。

但我不知道我该怎么办！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-04T20:13:12.377

我不知道你在用什么书，但作者似乎在进入 C++ 领域之前教你 C。在不讨论他们的动机的情况下，在讨论理想的 C++ 解决方案之前，我将写一个与您的代码风格相似的答案。

*   您需要一个数组来存储您的数字：`double score[10]`
*   数组从零开始索引，因此更改`counter`为从零开始到九（而不是像现在一样从一开始到十）
*   由于`score`是数组，`&score[count]`在调用中使用`scanf`
*   要打印十个数字，您还需要一个循环。您需要一个标志来告诉您在打印的数字后是否需要逗号。`printf("\n")`在循环之后添加一个。

就“理想”的 C++ 解决方案而言，它应该看起来接近这个：

```
istream_iterator<double> eos;
istream_iterator<double> iit(cin); 
vector<double> score;
copy(iit, eos, back_inserter(score));
ostream_iterator<double> oit (cout, ", ");
copy(score.begin(), score.end(), oit); 
```

但是，在您研究 C++ 标准库及其对迭代器的使用之前，讨论它仍然很困难。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T22:32:45.120

您可以通过声明一个包含十个数字的数组来实现。你的代码在这里：

```
#include <stdio.h>
int main() {
int counter=0;
float allNumbers[10];
while(counter < 10) {
    scanf("%f",&allNumbers[counter]);
    counter++;
        }

printf("Your entered numbers are : \n");
counter=0;
while(counter < 10) {
    printf("%f , ",allNumbers[counter]);
    counter++;
        }
} 
```

# ruby - 解释 1<<16 | 10？

> ID：15820553
> 
> 赞同：3
> 
> 时间：2013-04-04T19:57:09.490
> 
> 标签：ruby

我需要使用下面的代码，但我对 ruby​​ 和一般编程很陌生，不明白这是做什么的。有人能告诉我这是做什么的，或者至少这叫什么吗？

```
def MAKELPARAM(w1, w2)
  return (w2<<16) | w1
end 
```

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T19:59:09.967

这会将 w2 左移 16 位，然后将 w1 按位或运算到结果中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T20:07:02.583

因此，如果您知道它们是数字，那么这些可能是按位运算符，但是如果传入的参数是数组，则 << 是要添加到数组的运算符。还有然后| 运算符在两个数组上执行或返回一个数组，该数组包含任一数组中的元素
例如：

```
w1 =[]
w2 = [16,13]
w3 = [13]
MAKELPARAM(w1,w2)
#Returns [16,13]

MAKELPARAM(w1,w3)
#Returns [16,13]

MAKELPARAM(w1,w1)
#Returns [16] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-04T20:01:22.767

首先它将 w2 向左移动 16 位，即`w2 = 1`：

```
w2 == 0b1
w2 << 16 == 0b1000000000000000 
```

然后它使用 bitwise 或 with `w1`。

# vba - 单元格（..）.Formula 上的 VBA 运行时错误 1004

> ID：15820556
> 
> 赞同：3
> 
> 时间：2013-04-04T19:57:28.173
> 
> 标签：vba, excel

我无法使这个简单的命令起作用：

```
Cells(l, 7).Formula = "=" & var1 & " * " & var2 & " * " & var3 & " / 252" 
```

我可以将检查过的公式字符串值粘贴到 Excel 中，它可以按预期工作。

Cells(l,7) 是一个适当的参考，因为我可以检查它的值。

调试时检查的公式：“=86710597,9409 * 0,02 * 0,35 / 252”

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-04T20:23:05.720

问题是当变量表示为字符串时，它将具有系统的小数点。在您的情况下，它是一个逗号，因此您需要将其转换为点，例如使用[`replace()`](http://msdn.microsoft.com/en-us/library/bt3szac5%28v=vs.80%29.aspx)函数。

# javascript - 如何使用 jQuery 读取流

> ID：15820557
> 
> 赞同：-1
> 
> 时间：2013-04-04T19:57:29.677
> 
> 标签：javascript, jquery, streaming, shoutcast, stream-processing

我需要以某种方式从我的广播服务器中读取包含 VU 仪表数据的流，看起来像这样

“0xa5 leftVal rightVal 0xa5 leftVal .....等”

流是连续的。

我想接收这些数据并在 JavaScript(jQuery) 中解析它来管理 VU 表动画。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T23:02:34.540

对于连续流处理，也许这个答案会有所帮助：[处理 JSON 的连续流](https://stackoverflow.com/questions/6558129/process-a-continuous-stream-of-json)

要解析数据，请使用内置的 javascript split 函数。然后，您可以使用 jQuery each 函数来遍历数组。

```
var items = dataStream.split(" ");

$.each(items, function(index, value) {
  //Do stuff
}); 
```

# javascript - 使用 jQuery Mobile 选择作为菜单更改 URL 或内部页面

> ID：15820559
> 
> 赞同：1
> 
> 时间：2013-04-04T19:57:32.900
> 
> 标签：javascript, jquery, jquery-mobile, mobile

我正在使用一个选择框作为我的 jQuery Mobile 网站的菜单导航。

菜单中的某些项目链接到内部页面，而其他项目链接到外部 URL。

我正在使用以下代码来更改页面网址：

```
$('#menu-select').change(function() {
   window.location = $(this).data('location')  
}) 
```

的HTML：

```
 <select name='select-choice-1' id="menu-select">
    <option value="">Menú:</option>
    <option value="index.php">Noticias</option>
    <option value="index.php#tramites" data-location='index.php#tramites'>Trámites</option>
    <option value="index.php#twitter" data-location='index.php#twitter'>Twitter</option>
    <option value="virgen_del_valle.php">Parque Virgen del Valle</option>
    </select> 
```

我有三个页面：

*   index.php（包含页面或 data-role="page" 和 id）
*   新闻.php
*   事件.php

问题是，例如，当我选择主页选项，然后选择更多信息并尝试转到事件时，它没有加载页面。

它与外部和内部 url 加载不一致。

我认为这段代码必须对内部页面和外部 url 有条件。

希望你能帮忙。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T20:16:17.467

```
$('#menu-select').change(function () {
    window.location = $(this).val();
}); 
```

# linux - 这个简单的 C Shell 脚本有什么错误？

> ID：15820560
> 
> 赞同：0
> 
> 时间：2013-04-04T19:57:41.547
> 
> 标签：linux, shell, unix

代码应该花一个小时作为输入，然后说早安、下午或晚上。当代码以 12 运行时，它说 if 语句语法错误，但它在 0 下运行良好。

```
#!/bin/csh  
#
# Time of day greeting
#
# usage: greet [hour between 0-23]
#
if ($#argv == 0) then
   set hour = 'date +%H'
   else
     set hour = $argv[1]
endif
#
if ($hour < 12) then
echo "Good Morning\!"
else
if (hour < 18) then
echo "Good Afternoon\!"
else
echo "Good Evening\!"
endif
endif
#
exit 0
# 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T19:59:56.937

您的第二个`if`语句前面没有美元符号`hour`。

# mysql - Mysqldump 不断出现未知变量错误

> ID：15820563
> 
> 赞同：2
> 
> 时间：2013-04-04T19:57:48.660
> 
> 标签：mysql, variables, dump

我的转储代码：

```
C:\Program Files\MySQL\MySQL Server 5.6\bin> mysqldump -uroot -p marketingfunctions --single-transaction=TRUE > C:\20130404.sql 
```

错误：

> mysqldump：未知变量 'set-variable=max_allowed_pa​​cket=16M'

图片路径：

```
"C:\Program Files\MySQL\MySQL Server 5.6\bin\mysqld" --defaults-file="C:\ProgramData\MySQL\MySQL Server 5.6\my.ini" MySQL56 
```

在该 my.ini 文件中，我检查了该短语`'set-variable=max_allowed_packet=16M'`，但无济于事。

知道如何解决这个问题或可能发生什么吗？

# ldap - OpenLdap 不能同时使用 inetOrgPerson 和residentialPerson

> ID：15820565
> 
> 赞同：0
> 
> 时间：2013-04-04T19:57:56.500
> 
> 标签：ldap, schema, openldap

是否可以同时使用 inetOrgPerson 和residentialPerson ？

我有以下条目要添加到 ldap

```
dn: mail=james@email.com,ou=development,dc=company,dc=com
objectclass: inetOrgPerson 
objectclass: residentialPerson
cn: James Lin
sn: Lin
l: the address
mail: james@email.com 
```

在 slapd.conf 中，我包含了以下模式

```
include         /usr/local/etc/openldap/schema/core.schema
include         /usr/local/etc/openldap/schema/cosine.schema
include         /usr/local/etc/openldap/schema/inetorgperson.schema 
```

当我尝试通过 slapadd 添加条目时，出现以下错误

```
additional info: invalid structural object class chain (residentialPerson/inetOrgPerson) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T23:41:19.450

不可能同时拥有这两个类，因为它们都是 STRUCTURAL 并且都不从另一个继承。这类似于 Java 中的“类”，其中也不允许多重继承。如果其中一个或两个都是 AUXILIARY，您可以同时拥有它们，这类似于 Java 接口。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-04T20:05:00.420

找到这个[常见问题解答](http://www.openldap.org/faq/data/cache/883.html)，不可能同时拥有这两个类，因为它们在结构上不同，所以我必须选择一个，我认为 inetOrgPerson 是一个更好的选择。

# javascript - 在页面源中搜索 attr，然后找到该 attr 的父 div

> ID：15820566
> 
> 赞同：0
> 
> 时间：2013-04-04T19:57:54.950
> 
> 标签：javascript, jquery

我想通过在 HTML src 中搜索特定属性或文本来在 javascript（或 jquery）中找到父 div ID。

假设我们正在使用这段代码：

```
<div id="ad_creative_1" class="ad-div mastad" style="z-index: 1;">
<script>(function() {var loaded = function() {return yt && yt.www && yt.www.home && yt.www.home.ads;};window.masthead_ad_creative_iframe_1_workaround = function() {if (loaded()) {yt.www.home.ads.workaroundIE(this);}};window.masthead_ad_creative_iframe_1_onload = function() {if (!loaded()) {setTimeout(masthead_ad_creative_iframe_1_onload, 50);return;}yt.www.home.ads.workaroundLoad();};})();</script>

      <iframe id="ad_creative_iframe_1" src="http://ad-g.doubleclick.net/N4061/adi/com.ythome/_default;sz=970x250;tile=1;plat=pc;dc_dedup=1;kage=18;kar=3;kbsg=HPUS130404;kcr=us;kga=1001;kgender=m;kgg=1;klg=en;kmyd=ad_creative_1;"
              height="250" width="970"
              scrolling="no" frameborder="0" style="z-index: 1"
              onload="masthead_ad_creative_iframe_1_onload();"
              onmouseover="masthead_ad_creative_iframe_1_workaround(this)"
              onfocus="masthead_ad_creative_iframe_1_workaround(this)"></iframe>
        <script>
    (function() {
          var ord = Math.floor(Math.random() * 10000000000000000);
          var adIframe = document.getElementById("ad_creative_iframe_1");
          adIframe.src = "http://ad-g.doubleclick.net/N4061/adi/com.ythome/_default;sz=970x250;tile=1;plat=pc;dc_dedup=1;kage=18;kar=3;kbsg=HPUS130404;kcr=us;kga=1001;kgender=m;kgg=1;klg=en;kmyd=ad_creative_1;ord=" + ord + "?";
    })();
  </script>

    </div> 
```

在不知道父 div 是 ad_creative_1 的情况下，是否有可能（如果是，我将如何处理？）通过在源中搜索关键字来找出父 div？

假设 doubleclick.net 是我们的关键字。

我可以搜索 html 页面源，找到 doubleclick.net，然后返回包含 doubleclick.net 的部分的父 div 吗？

我该怎么办？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T19:59:59.893

您可以使用“属性包含”选择器，然后只需获取父级：

```
var parent = $('[src*="doubleclick.net"]').parent(); 
```

看在上帝的份上，不要发布您的实际 Adsense 代码或单击它来测试内容、移动或更改它，因为这最终会导致您的帐户被关闭。

# jquery - 从 $.get 函数中获取返回变量

> ID：15820568
> 
> 赞同：1
> 
> 时间：2013-04-04T19:57:58.540
> 
> 标签：jquery

我需要`prodata`从这个函数（动态填充）中获取变量，以便在另一个函数中使用它。但我不知道我可以使用`return`. 将 return 放在哪里，以便我可以在此函数之外使用 prodata。

```
$.get("proDB.txt", function(data) {
    var lines=data.split(/\n/);
    var numberofmodels=lines.length-2;
    var prodata=[];
    var i;
    var fieldnames=lines[0].split(/\t/);
    for (i = 1; i < lines.length-1; ++i) {
        var fields=lines[i].split(/\t/);
        var j;
        prodata[i]={};
        for (j = 0; j < fields.length; ++j) {
            prodata[i][fieldnames[j]]=fields[j];
        }
    }
    //remplir la liste déroulante:
    var options = '';
    for (i = 1; i < lines.length-1; ++i) {
        if (prodata[i]['name'].indexOf("elly") >= 0) {
            options += '<option value="' + prodata[i]['id'] + '" selected>' + prodata[i]['name']+', '+prodata[i]['brand']+', '+prodata[i]['model']+'</option>';
        }else{
            options += '<option value="' + prodata[i]['id'] + '">' + prodata[i]['name']+', '+prodata[i]['brand']+', '+prodata[i]['model']+'</option>';
        }
    }
$("#userchosenpromodel").html(options);
}, 'text'); //$.get 
```

然后我需要在里面访问和`prodata`使用

```
$('#submitbutton').click(function(e) {
    e.preventDefault(); 
    //computeUserDimensions(prodata[proId]);
});

function computeUserDimensions(line){ 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T20:00:19.147

您不能在该功能之外使用它，否则它将在它存在之前被使用。另一种方法是使用延迟对象。

```
var request = $.get("myurl",handler,"text"); 
```

现在，如果您需要从 获取数据`handler`，只需使用以下命令：

```
request.done(function(data){
    // use the data here, but not outside
    console.log(data)
}); 
```

解决此问题的一种方法是将您的工作保留在处理程序中，但允许您获取修改后的 var 是在外部存储对它的引用，并且只能在 .done() 中访问它。

```
var prdata;
var request = $.get("myurl",function(data){
    prdata = data;
},"text");
console.log(prdata); // undefined because request isn't done
request.done(function(){
    console.log(prdata); // IS defined because request IS done
});
console.log(prdata); // undefined because request still isn't done 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-10T18:36:05.010

另一种选择是使 prodata 像以前一样全局化，但在填充按钮之前禁用提交按钮。像这样的东西：

```
// Declare prodata here
var prodata = [];

// Disable submitbutton so it won't be clicked before prodata is ready
$('#submitbutton').attr("disabled", "disabled");

$.get("proDB.txt", function(data) {
    var lines=data.split(/\n/);
    var numberofmodels=lines.length-2;
    var i;
    var fieldnames=lines[0].split(/\t/);
    for (i = 1; i < lines.length-1; ++i) {
        var fields=lines[i].split(/\t/);
        var j;
        prodata[i]={};
        for (j = 0; j < fields.length; ++j) {
            prodata[i][fieldnames[j]]=fields[j];
        }
    }
    //remplir la liste déroulante:
    var options = '';
    for (i = 1; i < lines.length-1; ++i) {
        if (prodata[i]['name'].indexOf("elly") >= 0) {
            options += '<option value="' + prodata[i]['id'] + '" selected>' + prodata[i]['name']+', '+prodata[i]['brand']+', '+prodata[i]['model']+'</option>';
        }else{
            options += '<option value="' + prodata[i]['id'] + '">' + prodata[i]['name']+', '+prodata[i]['brand']+', '+prodata[i]['model']+'</option>';
        }
    }
    $("#userchosenpromodel").html(options);

    // Enable submitbutton since prodata is now available
    $('#submitbutton').removeAttr("disabled");
}, 'text'); //$.get

$('#submitbutton').click(function(e) {
    e.preventDefault(); 

    // Do an if check here just in case we somehow got here when prodata wasn't ready
    if ( prodata.length > 0 ) computeUserDimensions(prodata[proId]);
});

function computeUserDimensions(line){} 
```

这将允许您从 click 方法访问 prodata，因为在 prodata 可用之前永远不会访问 click 方法。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-04-04T20:13:47.630

正如其他人指出的那样，由于 $.get 调用的异步性质，在回调之外使用变量会出现问题。但是，如果需要，您可以使调用同步。为此，您必须使用更通用的 $.ajax 而不是 $.get，并将其传递 async:false，并且您需要在 ajax 调用之上定义 prodata：

```
var prodata=[];
$.ajax({
  url: 'proDB.txt',
  async: false,
  dataType: 'text',
  success: function(data) {
      // do stuff to prodata here
  }
});
// use prodata here 
```

# python - （Python Newb）写入文件打印什么？

> ID：15820570
> 
> 赞同：0
> 
> 时间：2013-04-04T19:57:59.817
> 
> 标签：python, gdata

感谢这个网站上的好意，我已经安装了 2.7/setuptools/feedparser 都没有问题。我已经找到了 feedparser，它可以正常工作。

我一直在阅读有关如何通过 python 写入文件（文本）的教程，我在使用文本方面取得了一定的成功。但是，当我尝试编写一个数据列表时，它对我来说全都搞砸了，什么也没做全部。

原来的：

```
import feedparser

result = feedparser.parse('https://gdata.youtube.com/feeds/api/videos/Ej4_G-E1cAM/comments')
for entry in result.entries:
print entry.author 
```

我的尝试：

```
import feedparser

result = feedparser.parse('https://gdata.youtube.com/feeds/api/videos/Ej4_G-E1cAM/comments')
for entry in result.entries:
with open("write.txt", "w") as text_file:
text_file.write entry.author 
```

我正在尝试为我的 YouTube 频道上即将发布的赠品收集评论。如果有人想知道我在使用这些看似无用的数据做什么。

最好的问候，-米奇鲍威尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T20:04:18.117

```
import feedparser
f = open('filename','w')
result = feedparser.parse('https://gdata.youtube.com/feeds/api/videos/Ej4_G-E1cAM/comments')
for entry in result.entries:
    f.write(entry.author) 
```

# ruby-on-rails - 如何使这些路由+助手具有足智多谋的语义/语法？

> ID：15820571
> 
> 赞同：0
> 
> 时间：2013-04-04T19:58:05.070
> 
> 标签：ruby-on-rails, routes, url-helper

我想要这样的路线：

```
get '/posts/new'           => 'posts#new'
get '/:username/posts/:id' => 'posts#show'
get '/:username/posts'     => 'posts#index' 
```

可通过以下助手访问：

```
new_post_path    #=> new   -
post_path(post)  #=> show  - :username implied from post
posts_path       #=> index - :username implied from session
posts_path(user) #=> index - :username explicit 
```

我想用足智多谋的语义来做到这一点，而不是手动指定每条路线。另外我不确定如何使 url 助手变得聪明。

想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T20:22:37.327

我假设您想要的是嵌套路由。这应该让你更接近你正在寻找的东西。

在您的 routes.rb 文件中：

```
resources :users do
  resoures :posts
end 
```

这将使路径如下：

```
/users
/users/:user_id
/users/:user_id/posts
/users/:user_id/posts/:id 
```

然后你可以从那里调整你的路线，以便`/posts/new`指向你的帖子控制器，如下所示：

（未经测试，不确定这是 100% 正确，所以请有人加入）

```
resources :users do
  resoures :posts do
    match "/posts/new", :to => "posts#new"
  end
end 
```

# c# - 让丑陋的 SQL 查询在 C# 中工作

> ID：15820582
> 
> 赞同：1
> 
> 时间：2013-04-04T19:58:29.387
> 
> 标签：c#, sql, coding-style

我试图从数据库中的几个表中获取一系列值。

我目前有这个代码工作：

```
SqlDataReader reader = null;
SqlCommand myCommand = new SqlCommand("select * from ods_LN_Master", xavierConnection);

reader = myCommand.ExecuteReader();
while (reader.Read())
{
   Console.WriteLine(reader["LMBKNO"].ToString());
} 
```

然而，我真正想做的 SQL 查询是这样的：

```
select "T1"."C0" AS "Collateral Type", "T1"."C1" AS "Owner Occuppied", "T1"."C2" AS "County Name", "T1"."C3" AS "Region Description", "T1"."C4" AS "City", "T1"."C5" AS "Orig Appraisal Date", "T1"."C6" AS "Curr Appraisal Date", "T1"."C7" AS "Mortgage 1 Bank", "T1"."C8" AS "Mortgage 2 Bank", "T1"."C9" AS "Bank Owned Mortgage 1", "T1"."C10" AS "Bank Owned Mortgage 2", "T1"."C11" AS "Call Report Code", "T1"."C12" AS "Original Note Date", "T1"."C13" AS "Account Key", "T1"."C14" AS "Account Number", "T1"."C15" AS "Credit Risk Code", "T1"."C16" AS "Current FICO Score", "T1"."C17" AS "Original FICO Score", "T0"."C18" AS "Bank Owned Principal Assets", "T0"."C19" AS "Orig Appraisal Amount", "T0"."C20" AS "Curr Appraisal Amount", "T0"."C21" AS "Mortgage Amount 1", "T0"."C22" AS "Mortgage Amount 2", "T1"."C18" AS "Available Balance", "T1"."C19" AS "Past Due Counter 1", "T1"."C20" AS "Past Due Counter 2", "T1"."C21" AS "Past Due Counter 3", "T1"."C22" AS "Past Due Counter 4", "T1"."C23" AS "Past Due Counter 5", "T1"."C24" AS "Past Due Counter 6"
 from (
select "CT_Master"."Collateral Type" AS "C0", "CTPROP"."Owner Occuppied" AS "C1", "CTPROP"."County Name" AS "C2", "Org"."Region Description" AS "C3", "CTPROP"."City" AS "C4", "CTPROP"."Orig Appraisal Date" AS "C5", "CTPROP"."Curr Appraisal Date" AS "C6", "CTPROP"."Mortgage 1 Bank" AS "C7", "CTPROP"."Mortgage 2 Bank" AS "C8", "CTPROP"."Bank Owned Mortgage 1" AS "C9", "CTPROP"."Bank Owned Mortgage 2" AS "C10", "LN_Master"."Call Report Code" AS "C11", case  when isdate("LN_Master"."Original Note Date") = 1 then convert(datetime,convert(varchar,"LN_Master"."Original Note Date")) else NULL end  AS "C12", "LN_Master"."Account Key" AS "C13", "LN_Master"."Account Number" AS "C14", "LN_Master"."Credit Risk Code" AS "C15", "SIFINA"."10 Char Spare Code 1" AS "C16", "SIFINA"."10 Char Spare Code 2" AS "C17", sum("LNIMPR"."Book_Balance" - "Participation_Lookups"."Participation Principal Assets") AS "C18", sum("CTPROP"."Orig Appraisal Amount") AS "C19", sum("CTPROP"."Curr Appraisal Amount") AS "C20", sum("CTPROP"."Mortgage Amount 1") AS "C21", sum("CTPROP"."Mortgage Amount 2") AS "C22"
 from (((((((
select "ods_LN_Master"."Account Count",  "ods_LN_Master"."Current Loan Status Code", "ods_LN_Master"."Account Key", "ods_LN_Master"."Org SKey", "ods_LN_Master"."Impaired Asset Status", "ods_LN_Master"."Credit Risk Code", "ods_LN_Master"."Call Report Code",  "ods_LN_Master"."Original Note Date", "ods_LN_Master"."Bank Number", "ods_LN_Master"."Account Number", "ods_LN_Master"."Participation Number", "ods_LN_Master"."Customer Number", "ods_LN_Master"."Dealer Number", "ods_LN_Master"."CIF Key", "ods_LN_Master"."Short Name", "ods_LN_Master"."Converted Account Key", "ods_LN_Master"."Branch Number", "ods_LN_Master"."Proc Application Code",  "ods_LN_Master"."Product Code",  "ods_LN_Master"."Account Application Code"
 from "BANK38"."dbo"."v_ods_LN_Master" "ods_LN_Master"
 where ods_LN_Master."Participation Number" = 0) "LN_Master" INNER JOIN (
select "Account Key", "Participation Principal Assets"
 from "BANK38"."dbo"."v_ods_Fact_AllProds_2008"
 where "Application Code" = 'LN') "Participation_Lookups" on "LN_Master"."Account Key" = "Participation_Lookups"."Account Key") LEFT OUTER JOIN (
select "ods_LNIMPR"."Account Key" AS "Account_Key", "ods_LNIMPR"."Book Balance" AS "Book_Balance"
 from "BANK38"."dbo"."v_ods_LNIMPR" "ods_LNIMPR"
 where ods_LNIMPR."Participation Number" = 0) "LNIMPR" on "LN_Master"."Account Key" = "LNIMPR"."Account_Key") LEFT OUTER JOIN "BANK38"."dbo"."fi_Core_Org" "Org" on "LN_Master"."Org SKey" = "Org"."Org Key") LEFT OUTER JOIN (
select *
 from "BANK38"."dbo"."v_ods_SICOD1" "ods_CODE_Master"
 where "ods_CODE_Master"."Application" = 'LN' and "ods_CODE_Master"."Code Type" = 'STAT') "Status_Code" on "LN_Master"."Bank Number" = "Status_Code"."Bankid" and "LN_Master"."Current Loan Status Code" = "Status_Code"."User Code") LEFT OUTER JOIN (
select "V_ODS_SIFINA"."10 Char Spare Code 1", "V_ODS_SIFINA"."10 Char Spare Code 2", "V_ODS_SIFINA"."Account Key"
 from "BANK38"."dbo"."V_ODS_SIFINA" "V_ODS_SIFINA"
 where "V_ODS_SIFINA"."APPLICATION" = 'LN') "SIFINA" on "LN_Master"."Account Key" = "SIFINA"."Account Key") LEFT OUTER JOIN ("BANK38"."dbo"."v_ods_CT_Master" "CT_Master" INNER JOIN (
select "v_ods_CTACTREL"."Account Number", "v_ods_CTACTREL"."Collateral Key"
 from "BANK38"."dbo"."v_ods_CTACTREL" "v_ods_CTACTREL"
 where v_ods_CTACTREL."Application" = 'LN') "CTACTREL" on "CT_Master"."Collateral Key" = "CTACTREL"."Collateral Key") on "LN_Master"."Account Number" = "CTACTREL"."Account Number") LEFT OUTER JOIN "BANK38"."dbo"."v_ods_CTPROP" "CTPROP" on "CT_Master"."Collateral Key" = "CTPROP"."Collateral Key"
 where case  when ("LN_Master"."Impaired Asset Status" = 'C') then 'H' else "Status_Code"."Code Key 2" end  <> 'C' and "LN_Master"."Proc Application Code" in ('RE', 'IL', 'CL') and case  when ("LN_Master"."Impaired Asset Status" = 'C') then 'H' else "Status_Code"."Code Key 2" end  <> 'H' and "CT_Master"."Collateral Type" in ('430', '431') and "CTPROP"."Owner Occuppied" in ('O')
 group by "CT_Master"."Collateral Type", "CTPROP"."Owner Occuppied", "CTPROP"."County Name", "Org"."Region Description", "CTPROP"."City", "CTPROP"."Orig Appraisal Date", "CTPROP"."Curr Appraisal Date", "CTPROP"."Mortgage 1 Bank", "CTPROP"."Mortgage 2 Bank", "CTPROP"."Bank Owned Mortgage 1", "CTPROP"."Bank Owned Mortgage 2", "LN_Master"."Call Report Code", case  when isdate("LN_Master"."Original Note Date") = 1 then convert(datetime,convert(varchar,"LN_Master"."Original Note Date")) else NULL end , "LN_Master"."Account Key", "LN_Master"."Account Number", "LN_Master"."Credit Risk Code", "SIFINA"."10 Char Spare Code 1", "SIFINA"."10 Char Spare Code 2") "T0", (
select "CT_Master"."Collateral Type" AS "C0", "CTPROP"."Owner Occuppied" AS "C1", "CTPROP"."County Name" AS "C2", "Org"."Region Description" AS "C3", "CTPROP"."City" AS "C4", "CTPROP"."Orig Appraisal Date" AS "C5", "CTPROP"."Curr Appraisal Date" AS "C6", "CTPROP"."Mortgage 1 Bank" AS "C7", "CTPROP"."Mortgage 2 Bank" AS "C8", "CTPROP"."Bank Owned Mortgage 1" AS "C9", "CTPROP"."Bank Owned Mortgage 2" AS "C10", "LN_Master"."Call Report Code" AS "C11", case  when isdate("LN_Master"."Original Note Date") = 1 then convert(datetime,convert(varchar,"LN_Master"."Original Note Date")) else NULL end  AS "C12", "LN_Master"."Account Key" AS "C13", "LN_Master"."Account Number" AS "C14", "LN_Master"."Credit Risk Code" AS "C15", "SIFINA"."10 Char Spare Code 1" AS "C16", "SIFINA"."10 Char Spare Code 2" AS "C17", "LN_Master"."Available Balance" AS "C18", "LN_Master"."Past Due Counter 1" AS "C19", "LN_Master"."Past Due Counter 2" AS "C20", "LN_Master"."Past Due Counter 3" AS "C21", "LN_Master"."Past Due Counter 4" AS "C22", "LN_Master"."Past Due Counter 5" AS "C23", "LN_Master"."Past Due Counter 6" AS "C24"
 from (((((((
select "ods_LN_Master"."Account Count", "ods_LN_Master"."Current Loan Status Code", "ods_LN_Master"."Credit Risk Code", "ods_LN_Master"."Call Report Code",  "ods_LN_Master"."Impaired Asset Status", "ods_LN_Master"."Past Due Counter 4", "ods_LN_Master"."Past Due Counter 5", "ods_LN_Master"."Past Due Counter 6", "ods_LN_Master"."Past Due Counter 1", "ods_LN_Master"."Past Due Counter 2", "ods_LN_Master"."Past Due Counter 3", "ods_LN_Master"."Available Balance",  "ods_LN_Master"."Original Note Date", "ods_LN_Master"."Org SKey", "ods_LN_Master"."Account Key", "ods_LN_Master"."Ext Application Code", "ods_LN_Master"."Bank Number", "ods_LN_Master"."Account Number", "ods_LN_Master"."Participation Number", "ods_LN_Master"."CIF Key",  "ods_LN_Master"."Proc Application Code", "ods_LN_Master"."Product Code"
 from "BANK38"."dbo"."v_ods_LN_Master" "ods_LN_Master"
 where ods_LN_Master."Participation Number" = 0) "LN_Master" INNER JOIN (
select "Account Key", "Participation Principal Assets"
 from "BANK38"."dbo"."v_ods_Fact_AllProds_2008"
 where "Application Code" = 'LN') "Participation_Lookups" on "LN_Master"."Account Key" = "Participation_Lookups"."Account Key") LEFT OUTER JOIN (
select "ods_LNIMPR"."Account Key" AS "Account_Key", "ods_LNIMPR"."Book Balance" AS "Book_Balance"
 from "BANK38"."dbo"."v_ods_LNIMPR" "ods_LNIMPR"
 where ods_LNIMPR."Participation Number" = 0) "LNIMPR" on "LN_Master"."Account Key" = "LNIMPR"."Account_Key") LEFT OUTER JOIN "BANK38"."dbo"."fi_Core_Org" "Org" on "LN_Master"."Org SKey" = "Org"."Org Key") LEFT OUTER JOIN (
select *
 from "BANK38"."dbo"."v_ods_SICOD1" "ods_CODE_Master"
 where "ods_CODE_Master"."Application" = 'LN' and "ods_CODE_Master"."Code Type" = 'STAT') "Status_Code" on "LN_Master"."Bank Number" = "Status_Code"."Bankid" and "LN_Master"."Current Loan Status Code" = "Status_Code"."User Code") LEFT OUTER JOIN (
select "V_ODS_SIFINA"."10 Char Spare Code 1", "V_ODS_SIFINA"."10 Char Spare Code 2", "V_ODS_SIFINA"."Account Key"
 from "BANK38"."dbo"."V_ODS_SIFINA" "V_ODS_SIFINA"
 where "V_ODS_SIFINA"."APPLICATION" = 'LN') "SIFINA" on "LN_Master"."Account Key" = "SIFINA"."Account Key") LEFT OUTER JOIN ("BANK38"."dbo"."v_ods_CT_Master" "CT_Master" INNER JOIN (
select "v_ods_CTACTREL"."Account Number", "v_ods_CTACTREL"."Collateral Key"
 from "BANK38"."dbo"."v_ods_CTACTREL" "v_ods_CTACTREL"
 where v_ods_CTACTREL."Application" = 'LN') "CTACTREL" on "CT_Master"."Collateral Key" = "CTACTREL"."Collateral Key") on "LN_Master"."Account Number" = "CTACTREL"."Account Number") LEFT OUTER JOIN "BANK38"."dbo"."v_ods_CTPROP" "CTPROP" on "CT_Master"."Collateral Key" = "CTPROP"."Collateral Key"
 where case  when ("LN_Master"."Impaired Asset Status" = 'C') then 'H' else "Status_Code"."Code Key 2" end  <> 'C' and "LN_Master"."Proc Application Code" in ('RE', 'IL', 'CL') and case  when ("LN_Master"."Impaired Asset Status" = 'C') then 'H' else "Status_Code"."Code Key 2" end  <> 'H' and "CT_Master"."Collateral Type" in ('430', '431') and "CTPROP"."Owner Occuppied" in ('O')) "T1"
 where ("T1"."C0" = "T0"."C0" or "T1"."C0" is null and "T0"."C0" is null) and ("T1"."C1" = "T0"."C1" or "T1"."C1" is null and "T0"."C1" is null) and ("T1"."C2" = "T0"."C2" or "T1"."C2" is null and "T0"."C2" is null) and ("T1"."C3" = "T0"."C3" or "T1"."C3" is null and "T0"."C3" is null) and ("T1"."C4" = "T0"."C4" or "T1"."C4" is null and "T0"."C4" is null) and ("T1"."C5" = "T0"."C5" or "T1"."C5" is null and "T0"."C5" is null) and ("T1"."C6" = "T0"."C6" or "T1"."C6" is null and "T0"."C6" is null) and ("T1"."C7" = "T0"."C7" or "T1"."C7" is null and "T0"."C7" is null) and ("T1"."C8" = "T0"."C8" or "T1"."C8" is null and "T0"."C8" is null) and ("T1"."C9" = "T0"."C9" or "T1"."C9" is null and "T0"."C9" is null) and ("T1"."C10" = "T0"."C10" or "T1"."C10" is null and "T0"."C10" is null) and "T1"."C11" = "T0"."C11" and ("T1"."C12" = "T0"."C12" or "T1"."C12" is null and "T0"."C12" is null) and ("T1"."C13" = "T0"."C13" or "T1"."C13" is null and "T0"."C13" is null) and "T1"."C14" = "T0"."C14" and "T1"."C15" = "T0"."C15" and ("T1"."C16" = "T0"."C16" or "T1"."C16" is null and "T0"."C16" is null) and ("T1"."C17" = "T0"."C17" or "T1"."C17" is null and "T0"."C17" is null) 
```

它是从我公司用来查看数据库中内容的不同程序自动生成的。我知道它会返回我正在寻找的确切数据。我暂时想使用这个 SQL，因为我还没有跟上我们的数据库架构的速度（而且我不会在很长一段时间内，它的巨大....”）

我需要做什么才能将丑陋的 SQL 查询放入我的 C# 代码中，以便它的行为方式与我的简单语句相同？

我目前的问题是双引号。有没有我可以做的 Find/Peplace 让它工作？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-04T20:00:06.090

我只需将其复制并粘贴到存储过程中，然后使用[ADO.NET调用存储过程](http://support.microsoft.com/kb/310070)

编辑：

```
using (var conn = new SqlConnection("<connection string>")) {
    using (var cmd = new SqlCommand("MyStoredProcedureName")) {
        cmd.CommandType = CommandType.StoredProcedure;
        SqlDataReader reader = cmd.ExecuteReader();
        while (reader.Read())
        {
            // Use the reader to read data
        }
    }
} 
```

仅供参考，不使用存储过程的另一种方法是在项目中创建一个新的文本文件，然后将 SQL 复制并粘贴到该文本文件中。将文本文件的构建操作更改为 Embedded Resource，然后使用[GetManifestResourceStream从资源中提取 SQL](http://msdn.microsoft.com/en-us/library/system.reflection.assembly.getmanifestresourcestream.aspx)

所以像这样：

```
string sql = "";
using (StreamReader reader = new StreamReader(Assembly.GetExecutingAssembly().
       GetManifestResourceStream("<AssemblyName>.<NameOfTextFile>")) {
    sql = reader.ReadToEnd();
}

if (!string.IsNullOrEmpty(sql))
{
    using (var conn = new SqlConnection("<connection string>")) {
        using (var cmd = new SqlCommand(sql)) {
            cmd.CommandType = CommandType.Text;
            SqlDataReader reader = cmd.ExecuteReader();
            while (reader.Read())
            {
                // Use the reader to read data
            }
        }
    }
} 
```

# javascript - 使用 CSS 定位自身以外的样式

> ID：15820583
> 
> 赞同：0
> 
> 时间：2013-04-04T19:58:32.817
> 
> 标签：javascript, css, html, web-applications, animation

可能只有 JavaScript 才有可能，但我想知道是否可以仅在 CSS 中使用 :focus 或 :hover 之类的事件将一种样式链接到另一种样式。

例如，类“hitArea”可以在焦点时更改“changeArea”背景属性吗？

```
.changeArea { background: yellow; }
.hitArea div:focus { changeArea:changeBG; }
.changeArea changeBG { background: blue; } 
```

我知道在做 CSS 动画时样式之间存在通信，就像在这个工作示例中一样：

```
.reveal {
    position:absolute;
    top:190px;
    left:0px;
    margin-left:0px;

    -webkit-animation-name:reveal;
    -webkit-animation-duration:0.1s;
    -webkit-animation-fill-mode:backwards;
    -webkit-animation-delay:0.2s;

    animation-name:reveal;
    animation-duration:0.1s;
    animation-fill-mode:backwards;
    animation-delay:0.2s;
}

@-webkit-keyframes reveal {
    0%  { left:-900px; -webkit-animation-timing-function:linear;  }
    99%     { left:-900px; -webkit-animation-timing-function:linear; }
    100%    { left:0px; }
} 
```

那么我在其他风格之间进行交流的语法是什么，或者甚至有可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T20:04:04.257

如果您的 HTML 如下所示：

```
<div class="hitarea">
    <div class="changeArea"></div>
</div> 
```

然后，当 hitArea 像这样聚焦时，您可以定位 changeArea：

```
.hitarea:focus .changeArea {
    background-color: red;
} 
```

这仅在“changeArea”是 hitarea 的某个子项时才有效。

在此处阅读有关 CSS 选择器以及您可以使用它们做什么的更多信息：[https ://developer.mozilla.org/en-US/docs/CSS/Getting_Started/Selectors](https://developer.mozilla.org/en-US/docs/CSS/Getting_Started/Selectors)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T20:02:18.623

我不相信这是可能的。你可以看看[http://sass-lang.com/](http://sass-lang.com/)它允许你做这样的事情。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-04T20:04:45.420

如果`.changeArea`是 的孩子`.hitArea`，是的！

```
.hitArea:focus .changeArea{ /* Styles to apply when .hitarea is hovered */ } 
```

如果这不是您想要的，我建议您进行设置，以便在`.hitArea`聚焦时，javascript 将一个类应用于`.changeArea`具有您想要应用的样式的类。

# c# - 释放按钮事件

> ID：15820596
> 
> 赞同：1
> 
> 时间：2013-04-04T19:59:15.450
> 
> 标签：c#, .net, winforms, click

我正在开发一个应用程序来通过蓝牙控制一些东西。

目前我有一个带有一些按钮的表单。在每个按钮上，我想在按下按钮时触发一个事件，并在释放按钮时触发一个不同的事件。

这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T20:01:46.670

不确定“蓝牙”信息应该告诉我什么。

但是在 C# Winforms 中，是的，这是可能的。请参阅 MouseDown 和 MouseUp 事件： http: [//msdn.microsoft.com/en-us/library/system.windows.forms.button_events.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.button_events.aspx) （您可能还需要将它们与键盘事件结合起来以捕获它们）

# python - 如何在 Python 中将斐波那契数列打印到第 n 个数字？

> ID：15820601
> 
> 赞同：7
> 
> 时间：2013-04-04T19:59:22.670
> 
> 标签：python, parameter-passing, fibonacci

我有一个家庭作业，我很难过。我正在尝试编写一个程序，将斐波那契数列输出到第 n 个数字。这是我到目前为止所拥有的：

```
def fib():
   n = int(input("Please Enter a number: "))

   if n == 1:
      return(1)
   elif n == 0:   
      return(0)            
   else:                      
      return (n-1) + (n-2)

mylist = range[0:n]
print(mylist) 
```

我想我可以使用单独的函数，但我不知道如何传递计算斐波那契数列的参数。然后下一步将打印出直到该数字的数字序列。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-04-04T20:14:39.077

非递归解决方案

```
def fib(n):
    cur = 1
    old = 1
    i = 1
    while (i < n):
        cur, old, i = cur+old, cur, i+1
    return cur

for i in range(10):
    print(fib(i)) 
```

发电机解决方案：

```
def fib(n):
    old = 0
    cur = 1
    i = 1
    yield cur
    while (i < n):
        cur, old, i = cur+old, cur, i+1
        yield cur

for f in fib(10):
    print(f) 
```

请注意，生成器解决方案优于非递归解决方案（如果记忆化不适用于递归解决方案，非递归优于递归解决方案）

再一次，用记忆递归：

```
def memoize(func):
    memo = dict()
    def decorated(n):
        if n not in memo:
            memo[n] = func(n)
        return memo[n]

    return decorated

@memoize
def fib(n):
    #added for demonstration purposes only - not really needed
    global call_count
    call_count = call_count + 1
    #end demonstration purposes

    if n<=1:
        return 1
    else:
        return fib(n-1) + fib(n-2)

call_count = 0 #added for demonstration purposes only - not really needed
for i in range(100):
    print(fib(i))
print(call_count) #prints 100 
```

这一次*每个**斐波*那契数只计算一次，然后存储。因此，此解决方案将胜过所有其他解决方案。然而，装饰器的实现既快又脏，不要让它进入生产环境。（有关 python 装饰器的详细信息，请参阅 SO 上的[这个惊人的问题:)](https://stackoverflow.com/questions/739654/understanding-python-decorators)

因此，`fib`定义后，程序将类似于（抱歉，只是循环很无聊，这里有一些更酷的 python 东西：[列表推导](http://en.wikipedia.org/wiki/List_comprehension#Python)）

```
fib_n = int(input("Fib number?"))
fibs = [fib(i) for i in range(fib_n)]
print " ".join(fibs) 
```

这将打印一行中的所有数字，以空格分隔。如果您希望每个都在自己的行上 - 替换`" "`为`"\n"`

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-04-04T20:08:18.720

```
def fibonacci(n):
  if n <= 1:
    return n
  else:
    return fibonacci(n-1) + fibonacci(n-2)

print(fibonacci(int(input()))) 
```

而且由于您要打印到第`n`th 个数字：

```
[print(fibonacci(n)) for n in range (int(input()))] 
```

而对于 python2.7 更改`input`为`raw_input`.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-04-04T20:01:37.130

请注意，在您的通话中

1.  您没有递归调用 fib()
2.  您需要一个包装方法，以便每次递归调用该方法时都不会请求输入
3.  您无需发送列表。只是数字 n 就足够了。

这种方法只会给你序列中的第 n 个数字。它不打印序列。

你需要`return fib(n-1) + fib(n-2)`

```
def f():
    n = int(input("Please Enter a number: "))
    print fib(n)

def fib(n):    
    if n == 0: 
        return 0
    elif n == 1: 
        return 1
    else: 
        return fib(n-1)+fib(n-2) 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-08-04T20:35:17.497

如果列表很长，这可能会更快

```
# Get nth Fibonacci number 
def nfib(nth):
  sq5 = 5**.5
  phi1 = (1+sq5)/2
  phi2 = -1 * (phi1 -1)
  resp = (phi1**(nth+1) - phi2**(nth+1))/sq5
  return long(resp)

for i in range(10):
  print i+1, ": ",  nfib(i) 
```

### 输出

```
1 :  1
2 :  1
3 :  2
4 :  3
5 :  5
6 :  8
7 :  13
8 :  21
9 :  34
10 :  55 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-04-04T20:02:17.763

```
def fib(n):
   if n == 1:
      return(1)
   elif n == 0:   
      return(0)            
   else:                      
      return fib(n-1) + fib(n-2)

my_num = int(input("Enter a number:"))
print fib(my_num) 
```

我不太确定你的问题是什么......但答案可能是这样的

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-04-04T20:17:47.083

单独的函数是最好的，因为递归函数会更容易处理。另一方面，您可以编写一个只接受一个参数的迭代函数

递归::

```
def fib(n):
    if n == 1:
        return (1);
    elif n == 0:
        return (0);
    else:
        return fib(n-1) + fib(n-2);

def callFib():
    n = int(raw_input('Enter n::\t'));
    mylist = fib(n);
    print mylist;

callFib(); 
```

迭代地::

```
def fib():
    n = int(raw_input('Enter n::\t'));
    terms = [0,1];
    i=2;
    while i<=n:
        terms.append(terms[i-1] + terms[i-2]);
        i=i+1;
    print terms[n];

fib(); 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2013-04-11T13:47:57.427

对于递归解决方案：

```
def fib(n):
    if n == 0:
        return 0
    elif n == 1:
        return 1
    else:
        return fib(n-1) + fib(n-2)
x=input('which fibonnaci number do you want?')
print fib(x) 
```

解释：如果 n 为 0，那么“第 0”项当然为 0，第 1 项为 1。从这里，您知道下一个数字将是前两个数字的总和。这就是 else 之后的行所推断的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-01-14T22:05:55.480

看起来您可能正在尝试解决与我相同的家庭作业问题，您实际上并不需要用户输入。调用函数时只需传入参数即可。

```
 def compute_nth_fib(num):

    if num == 0:
        return 0
    elif num == 1:
        return 1
    else:
        return compute_nth_fib(num-1) + compute_nth_fib(num-2)

#test with different parameters    
print(compute_nth_fib(3)) 
```

希望这对某人有帮助！

# ruby-on-rails - 如何在之前的过滤器中使用永久 cookie 来过滤首次入住的客人

> ID：15820610
> 
> 赞同：0
> 
> 时间：2013-04-04T19:59:54.387
> 
> 标签：ruby-on-rails

我正在我的网页上设置一个简单的调查。我想添加一个 before_filter 以便同一个人不能多次参加调查。

我的想法是

1) 在提交时为每个调查创建并保存一个 remember_token。

2) 根据要放置在提交者浏览器上的记住令牌创建一个 cookie

3) 每次访问页面时，使用前置过滤器以确保他们没有与数据库中的调查相匹配的 cookie。

我将以下内容放在一起，但由于某种原因，它会自动重定向到Thanks_path，无论我是否有记住令牌？

为什么这样做？我是否错误地使用了会话 cookie？

我`surveys_controller`的如下

```
before_filter :new_visitor, only: [:new, :create]

def new
  #this is the survey form
  @survey = Survey.new
end

def create   
  #this submits the survey and creates a cookie on the client's browser
  @survey = Survey.new(params[:survey])
  if @survey.save
    cookies.permanent[:remember_token] = @survey.remember_token
    redirect_to thanks_path
  else
    render action: "new"
  end
end

def thanks 
  #blank page that just says, "thanks for taking the survey!"
end

def new_visitor
  # if a browser has a survey cookie, redirect to thanks page
  unless Survey.find_by_remember_token(cookies[:remember_token]).nil?
    redirect_to thanks_path
  end    
end 
```

我正在我的`Survey`模型中创建记住令牌。

```
class Survey < ActiveRecord::Base
  before_save :create_remember_token

  def create_remember_token
    self.remember_token = SecureRandom.urlsafe_base64
  end
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T21:26:09.420

```
unless Survey.find_by_remember_token(cookies[:remember_token]).nil? 
```

这意味着如果 Survey 不是 nil 然后重定向，我认为您需要更改为

```
unless Survey.find_by_remember_token(cookies[:remember_token]) 
```

或者

```
if Survey.find_by_remember_token(cookies[:remember_token]).nil? 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T21:51:55.900

我认为您需要`cookie[:remember_token]`在将其用作`find_by_remember_token()`. 仅当`cookies[:remember_token]`不是 nil 并且找到记录时，您才会重定向到Thanks_page。

```
if cookies[:remember_token] && Survey.find_by_remember_token(cookies[:remember_token])
    redirect_to thanks_page
end 
```

# c# - 实体框架中的空值

> ID：15820613
> 
> 赞同：0
> 
> 时间：2013-04-04T19:59:57.903
> 
> 标签：c#, .net, wpf, linq, entity-framework

```
var query = from section in load_sections.Sections
            join course in load_sections.Courses
                on section.Course_Id equals course.Course_Id
            join faculty in load_sections.Faculties
                on section.Faculty_Id equals faculty.Faculty_Id
            select section; 
```

我的 section.Faculty_Id 中有一些空值，它们不等于 Faculty.Faculty_Id 中的任何行，它只是返回 section.Faculty_Id 不为空的记录...如果 section.Faculty_Id 不为空，那么它必须返回 Table Courses 的其他剩余字段

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T20:39:35.227

如果`faculty`由于某种原因无法删除连接，则必须构造一个外部连接：

```
var query = from section in load_sections.Sections
            join course in load_sections.Courses
                on section.Course_Id equals course.Course_Id
            join faculty in load_sections.Faculties
                on section.Faculty_Id equals faculty.Faculty_Id into faculties
            from f in faculties.DefaultIfEmpty()
            select section; 
```

这执行一个`GroupJoin`with `Faculties`。随后的效果`from f in faculties`是分组再次被 a 展平`SelectMany`。`.DefaultIfEmpty()`创建外连接。

# python - Django with sweetpie 如何刷新查询集？

> ID：15820617
> 
> 赞同：0
> 
> 时间：2013-04-04T20:00:10.937
> 
> 标签：python, django, django-models, tastypie

我数据库中的一些表是从一些在后台不断运行的后台 python 脚本更新的（进行数据挖掘）。Django 很难知道数据是在 Django 之外更新的，并且总是显示旧数据。经过长时间的研究，大多数在线缓存禁用方法对我不起作用，但这种解决方法非常有效：

```
from django.db import connection
connection.close() 
```

这仍然不是一个完美的解决方案，但它确实在 Django 的视图中起作用。如果你知道如何解决这个问题，请在此处评论[Django: how to refresh or reload models from database](https://stackoverflow.com/questions/15821581/django-how-to-refresh-or-reload-models-from-database)。但是，数据也可以通过 REST 访问。在 Tastypie 中，资源仍未更新。

JSON 结构总是返回过时的时间戳，我可以看到数据库中的最新值是不同的。我已经尝试了以下方法，但没有奏效。

```
from tastypie.cache import NoCache
cache = NoCache() 
```

现在唯一的刷新方法就是手动重启uwsgi服务，这显然不是解决办法。这个问题快把我逼疯了。任何评论将不胜感激。谢谢你。

* * *

**更新**

我已将代码和模型简化为仅包含时间戳列。这是完整的代码和日志。

**Tastypie 的资源.py**

```
from lp.models import LatestPrices
from tastypie.resources import ModelResource
from tastypie.serializers import Serializer
from django.db import connection

class LpResource(ModelResource):
    class Meta:

        # forces Django to make a new connection, fixes OperationalError: (2006, 'MySQL server has gone away') after a long time with no access
        connection.close() 

        queryset = LatestPrices.objects.all()

        include_resource_uri = False
        resource_name = 'lp'
        allowed_methods = ['get']
        excludes = ['slug']
        serializer = Serializer(formats=['json'])
        connection.close() 
```

**模型.py**：

```
from django.db import models

class LatestPrices(models.Model):
    id = models.AutoField(primary_key=True)
    slug = models.SlugField(unique=True)

    # timestamp is updated every 10 seconds
    timestamp = models.DateTimeField(null=True, blank=True)

    # Removed all other columns for debugging.

    # The data to show in admin
    def __unicode__(self):
        return str(self.timestamp)

    class Meta:
        db_table = 'latest_prices' 
```

**Django 之外的数据库注入器脚本**

```
while True:
    try:
        # Get date & time
        timestamp = datetime.now().strftime("%Y-%m-%d %H:%M:%S")
        logger.info("------" + timestamp)

        # Inject to local database
        logger.debug("Injecting...")
        con = None
        con = db.connect('localhost', 'user', 'pw', 'tablename')
        con.autocommit(True)
        cursor = con.cursor(MySQLdb.cursors.DictCursor)
        update_query = "UPDATE latest_prices SET slug='latest', timestamp='" + timestamp \
                             + "' WHERE id=1"
        rows_affected = cursor.execute(update_query)
        con.commit()
        if rows_affected != 1:
            logger.critical("Couldn't inject! Rows affected: " + str(rows_affected))
            cursor.close()
            time.sleep(WAIT_TIME)
            continue

        cursor.close()

    except Exception as e:
        # Code removed. Email admin the error string...
        pass
    finally:    
        pass

    time.sleep(WAIT_TIME) 
```

**mysql.log**

```
 124 Query UPDATE latest_prices SET slug='latest', timestamp='2013-04-04 18:38:16' WHERE id=1
          124 Query commit
130404 18:38:26   125 Connect   dev@localhost on gs
          125 Query set autocommit=0
          125 Query set autocommit=1
          124 Quit  
          125 Query UPDATE latest_prices SET slug='latest', timestamp='2013-04-04 18:38:26' WHERE id=1
          125 Query commit
130404 18:38:36   126 Connect   dev@localhost on gs
          126 Query set autocommit=0
          126 Query set autocommit=1
          125 Quit  
          126 Query UPDATE latest_prices SET slug='latest', timestamp='2013-04-04 18:38:36' WHERE id=1
          126 Query commit
130404 18:38:46   127 Connect   dev@localhost on gs
          127 Query set autocommit=0
          127 Query set autocommit=1
          126 Quit  
          127 Query UPDATE latest_prices SET slug='latest', timestamp='2013-04-04 18:38:46' WHERE id=1
          127 Query commit

# Click the browser refresh button one time here
130404 18:38:53    73 Query SELECT `latest_prices`.`id`, `latest_prices`.`slug`, `latest_prices`.`timestamp` FROM `latest_prices` WHERE (`latest_prices`.`id` = 1  AND `latest_prices`.`id` = 1 )

130404 18:38:56   128 Connect   dev@localhost on gs
          128 Query set autocommit=0
          128 Query set autocommit=1
          127 Quit  
          128 Query UPDATE latest_prices SET slug='latest', timestamp='2013-04-04 18:38:56' WHERE id=1
          128 Query commit

# Click the browser refresh button a few times here
130404 18:38:58    70 Query SELECT `latest_prices`.`id`, `latest_prices`.`slug`, `latest_prices`.`timestamp` FROM `latest_prices` WHERE (`latest_prices`.`id` = 1  AND `latest_prices`.`id` = 1 )
130404 18:39:02    70 Query SELECT `latest_prices`.`id`, `latest_prices`.`slug`, `latest_prices`.`timestamp` FROM `latest_prices` WHERE (`latest_prices`.`id` = 1  AND `latest_prices`.`id` = 1 )
130404 18:39:04    73 Query SELECT `latest_prices`.`id`, `latest_prices`.`slug`, `latest_prices`.`timestamp` FROM `latest_prices` WHERE (`latest_prices`.`id` = 1  AND `latest_prices`.`id` = 1 )

130404 18:39:06   129 Connect   dev@localhost on gs
          129 Query set autocommit=0
          129 Query set autocommit=1
          128 Quit  
          129 Query UPDATE latest_prices SET slug='latest', timestamp='2013-04-04 18:39:06' WHERE id=1
          129 Query commit
130404 18:39:16   130 Connect   dev@localhost on gs
          130 Query set autocommit=0
          130 Query set autocommit=1
          130 Query UPDATE latest_prices SET slug='latest', timestamp='2013-04-04 18:39:16' WHERE id=1
          129 Quit  
          130 Query commit 
```

**浏览器输出（总是一样的）**

```
{"id": 1, "timestamp": "2013-04-04T18:29:45"} 
```

**HTTP 标头**

```
Cache-Control →no-cache
Connection →keep-alive
Content-Type →application/json
Date →Fri, 05 Apr 2013 00:27:48 GMT
Server →nginx
Transfer-Encoding →
Transfer-Encoding
The form of encoding used to safely transfer the entity to the user. Currently defined methods are: chunked, compress, deflate, gzip, identity.

chunked
Vary →Accept 
```

我还在注入器脚本中添加了显式提交。它在 mysql.log 中说 commit 和我正在使用的现有“set autocommit = 1”并没有太大区别。

现在我正在查看 mysql.log，我看到每次点击浏览器的刷新按钮时，我都会看到 Django 发送的新 SELECT 语句。但是这些对象仍然很旧。我想不通，为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T00:28:21.057

Django 将缓存查询集中的结果，但不缓存不相关查询集中的结果。

以下代码将导致两个数据库查询：

```
list(SomeTable.objects.all())  # First db query.
list(SomeTable.objects.all())  # Second db query unrelated to first. 
```

症状和您的`connection.close()`解决方案与 MySQL 事务问题一致。每个查询的新连接将导致不同的事务。

似乎在您的 Django 代码中启动了一个事务，但从未提交或回滚。当事务开始时，该事务中的进一步读/写只会看到事务开始时数据库的状态，以及该事务中所做的更新。如果另一个进程启动会话（例如您的数据挖掘脚本）并插入数据，则 Django 事务将不会看到它，直到现有事务关闭。

如果没有看到您的代码，就不可能知道为什么会有一个事务开始但没有完成。要验证此假设，请打开 MySQL 查询日志并检查其内容。您应该会看到一个`start transaction`没有相应`commit`or的查询`rollback`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T05:23:04.987

将“transaction-isolation = READ-COMMITTED”添加到 my.cnf。此处有更多详细信息：[Django：如何从数据库刷新或重新加载模型](https://stackoverflow.com/questions/15821581/django-how-to-refresh-or-reload-models-from-database/15826232#15826232)

# actionscript-3 - Actionscript 3 未命中测试

> ID：15820622
> 
> 赞同：0
> 
> 时间：2013-04-04T20:00:37.833
> 
> 标签：actionscript-3

是否有“非”hitTest 的代码，就像`if(player.notHitTestObject(object))`我们对碰撞检测所做的那样，

```
if(player.hitTestObject(object)) {

}
else {

} 
```

我知道其他是一样的，但是有不同的方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T21:42:42.033

这 '！' 运算符或 NOT 运算符是您要使用的。

hitTestObject 返回一个布尔值（真/假），所以你可以这样做：

```
if (!player.hitTestObject(object))
{
    // code to run if hit test is not true
} 
```

# r - 获取“lm()”返回的“mlm”对象的回归系数的 t 统计量

> ID：15820623
> 
> 赞同：4
> 
> 时间：2013-04-04T20:00:38.083
> 
> 标签：r, regression, linear-regression, lm, mlm

对于 R 中的多个（约 100 万）响应变量，我必须`used lm()`拟合多个回归模型。

```
allModels <- lm(t(responseVariablesMatrix) ~ modelMatrix) 
```

这将返回一个“mlm”类的对象，它就像一个包含所有模型的巨大对象。我想获得每个模型中第一个系数的*t 统计量*，我可以使用该`summary(allModels)`函数来完成，但是在这个大数据上它非常慢并且也返回了很多不需要的信息。

是否有更快的`t-statistic`手动计算方法，可能比使用`summary()`函数更快

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-16T02:05:33.167

您可以破解 summary.lm() 函数以获取您需要的位并留下其余部分。

如果你有

```
nVariables <- 5
nObs <- 15

y <- rnorm(nObs)
x <- matrix(rnorm(nVariables*nObs),nrow=nObs)

allModels <-lm(y~x) 
```

然后这是来自 lm.summary() 函数的代码，但删除了所有多余的行李（请注意，所有错误处理也已删除）。

```
p <- allModels$rank
rdf <- allModels$df.residual
Qr <- allModels$qr
n <- NROW(Qr$qr)
p1 <- 1L:p
r <- allModels$residuals
f <- allModels$fitted.values
w <- allModels$weights
mss <- if (attr(allModels$terms, "intercept")) 
sum((f - mean(f))^2) else sum(f^2)
rss <- sum(r^2)
resvar <- rss/rdf
R <- chol2inv(Qr$qr[p1, p1, drop = FALSE])
se <- sqrt(diag(R) * resvar)
est <- allModels$coefficients[Qr$pivot[p1]]
tval <- est/se 
```

`tval`现在是 t 统计量的向量，也由

```
summary(allModels)$coefficients[,3] 
```

如果您在大型模型上遇到问题，您可能需要重写代码，以便通过将多行/分配复合成更少的行来保留更少的对象。

我知道的哈克解决方案。但它会尽可能快。我想将所有代码行也放入一个函数中会更整洁。

# .net - 在多租户解决方案中动态设置母版页。

> ID：15820627
> 
> 赞同：0
> 
> 时间：2013-04-04T20:01:00.827
> 
> 标签：.net, asp.net-mvc, master-pages, multi-tenant, asp.net-mvc-controller

我在 .net mvc4 中创建了一个效果很好的多租户解决方案。我只剩下最后一期了。

我使用 OnResultExecuting 创建了自己的控制器，这很好，因为它允许我处理母版页，同时仍然保持我的多租户功能（在自定义视图引擎中路由）

我的代码看起来像这样

```
 protected override void OnResultExecuting(ResultExecutingContext filterContext)
    {
        var viewResult = filterContext.Result as ViewResult;
        if (viewResult != null)
        {
            viewResult.MasterName = viewResult.MasterName == "" ? "_Layout" : (viewResult.MasterName == "IGNORE" ? "" : viewResult.MasterName);
        } 
```

我唯一剩下的问题是我不能为某个客户制作某个页面使用不同的布局。

这是我能做的

*   不同的页面有不同的布局
*   为租户提供不同版本的布局
*   没有masterview（通过发送IGNORE）

但我不能做的是替换客户 X 的一个视图文件并让它使用 _LayoutX 代替。我仍然希望customerx的所有其他文件使用正常的_Layout

因为如果我为 customerX 创建一个 _Layout，那么所有 customerX 的页面都会使用它，而不是我想要的。如果我改为为 customerX 创建一个名为 _LayoutX 的文件，则无法将其应用于某个视图文件。因为即使我为 customerX 创建视图文件，它也会忽略我放入实际视图文件中的任何 @Layout，因为它将使用从自定义控制器获得的内容。

我想我能做的就是让 myView （全局）使用 _LayoutX （从控制器发送）。然后，我可以全局放置一个 _LayoutX，它是 _Layout 的克隆，但在 customerX 下我可以放置 _LayoutX，它实际上是我想要的唯一文件。这不是一个很好的解决方案，因为我什至在全球范围内都会获得两倍多的布局文件来跟踪。

有更好的想法吗？

# ios - iPad Mini 上 GCD 后台队列挂断时的 CoreData 保存

> ID：15820629
> 
> 赞同：2
> 
> 时间：2013-04-04T20:01:02.563
> 
> 标签：ios, ipad, core-data, grand-central-dispatch, ipad-mini

我有一个单例类，它使用 GCD（Grand Central Dispatch）队列在后台将 JSON 对象保存到 CoreData 数据库。这在大多数情况下都能完美运行，但在 iPad 2 和 iPad Mini 设备上，我遇到了一些进程冻结问题。

我的设置非常简单。我有一个设置为串行运行的后台调度队列 (backgroundQueue)，并且我有一个单独的 NSManagedObjectContext 实例用于后台队列。当我想将某些内容保存到数据库时，我调用开始保存过程的方法，在该方法中，我使用 dispatch_async 在后台线程上调用我的保存逻辑。

一旦所有处理逻辑都运行完毕，我保存后台 MOC，并使用 NSManagedObjectContextDidSaveNotification 将后台 MOC 的更改合并到主线程 MOC。后台线程等待此完成，一旦完成，它将运行队列中的下一个块（如果有）。下面是我的代码。

```
dispatch_queue_t backgroundQueue;

- (id)init
{
    if (self = [super init]) 
    {
        // init the background queue
        backgroundQueue = dispatch_queue_create(VS_CORE_DATA_MANAGER_BACKGROUND_QUEUE_NAME, DISPATCH_QUEUE_SERIAL);
    }
    return self;
}

- (void)saveJsonObjects:(NSDictionary *)jsonDict
          objectMapping:(VS_ObjectMapping *)objectMapping
                  class:(__unsafe_unretained Class)managedObjectClass
             completion:(void (^)(NSArray *objects, NSError *error))completion
{
    [VS_Log logDebug:@"**** Queue Save JSON Objects for Class: %@", managedObjectClass];

    // process in the background queue
    dispatch_async(backgroundQueue, ^(void)
    {
        [VS_Log logDebug:@"**** Dispatch Save JSON Objects for Class: %@", managedObjectClass];

        // create a new process object and add it to the dictionary
        currentRequest = [[VS_CoreDataRequest alloc] init];

        // set the thead name
        NSThread *currentThread = [NSThread currentThread];
        [currentThread setName:VS_CORE_DATA_MANAGER_BACKGROUND_THREAD_NAME];

        // if there is not already a background context, then create one
        if (!_backgroundQueueManagedObjectContext)
        {
            NSPersistentStoreCoordinator *coordinator = [self persistentStoreCoordinator];
            if (coordinator != nil)
            {
                // create the background queue
                _backgroundQueueManagedObjectContext = [[NSManagedObjectContext alloc] init];
                [_backgroundQueueManagedObjectContext setPersistentStoreCoordinator:coordinator];
                [_backgroundQueueManagedObjectContext setMergePolicy:NSMergeByPropertyStoreTrumpMergePolicy];
                _backgroundQueueManagedObjectContext.undoManager = nil;

                // listen for the merge changes from context did save notification on the background queue
                [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(mergeChangesFromBackground:) name:NSManagedObjectContextDidSaveNotification object:_backgroundQueueManagedObjectContext];
            }
        }

        // save the JSON dictionary
        NSArray *objects = [self saveJSON:jsonDict objectMapping:objectMapping class:managedObjectClass managedObjectContext:_backgroundQueueManagedObjectContext level:0];

        // save the objects so we can access them later to be re-fetched and returned on the main thread
        if (objects.count > 0)
            [currentRequest.objects addObjectsFromArray:objects];

        // save the object IDs and the completion block to global variables so we can access them after the save
        if (completion)
            currentRequest.completionBlock = completion;

        [VS_Log logDebug:@"**** Save MOC for Class: %@", managedObjectClass];

        // save all changes object context
        [self saveManagedObjectContext];
    });
}

- (void)mergeChangesFromBackground:(NSNotification *)notification
{
    [VS_Log logDebug:@"**** Merge Changes From Background"];

    // save the current request to a local var since we're about to be processing it on the main thread
    __block VS_CoreDataRequest *request = (VS_CoreDataRequest *)[currentRequest copy];
    __block NSNotification *bNotification = (NSNotification *)[notification copy];

    // clear out the request
    currentRequest = nil;

    dispatch_sync(dispatch_get_main_queue(), ^(void)
    {
        [VS_Log logDebug:@"**** Start Merge Changes On Main Thread"];

        // merge changes to the primary context, and wait for the action to complete on the main thread
        [_managedObjectContext mergeChangesFromContextDidSaveNotification:bNotification];

        NSMutableArray *objects = [[NSMutableArray alloc] init];

        // iterate through the updated objects and find them in the main thread MOC
        for (NSManagedObject *object in request.objects)
        {
            NSError *error;
            NSManagedObject *obj = [[self managedObjectContext] existingObjectWithID:object.objectID error:&error];
            if (error)
                [self logError:error];

            if (obj)
                [objects addObject:obj];
        }

        // call the completion block
        if (request.completionBlock)
        {
            void (^saveCompletionBlock)(NSArray *, NSError *) = request.completionBlock;
            saveCompletionBlock(objects, nil);
        }

        [VS_Log logDebug:@"**** Complete Merge Changes On Main Thread"];

        // clear the request
        request = nil;
    });

    [VS_Log logDebug:@"**** Complete Merge Changes From Background"];
} 
```

当问题发生时，一切似乎都运行良好，它进入了 mergeChangesFromBackground: 方法，但没有调用 dispatch_async()。

正如我上面提到的，代码在大多数情况下都能完美运行。只有当我在 iPad 2 或 iPad Mini 上测试并保存大型对象时才会出现问题。

有没有人知道为什么会这样？

谢谢

** 编辑 **

自从写这篇文章以来，我已经了解了嵌套的 NSManagedObjectContexts。我已经修改了我的代码以使用它，它似乎运行良好。但是，我仍然有同样的问题。想法？另外，对嵌套 MOC 有何评论？

```
- (void)saveJsonObjects:(NSDictionary *)jsonDict
          objectMapping:(VS_ObjectMapping *)objectMapping
                  class:(__unsafe_unretained Class)managedObjectClass
             completion:(void (^)(NSArray *objects, NSError *error))completion
{
    // process in the background queue
    dispatch_async(backgroundQueue, ^(void)
    {
        // create a new process object and add it to the dictionary
        __block VS_CoreDataRequest *currentRequest = [[VS_CoreDataRequest alloc] init];

        // set the thead name
        NSThread *currentThread = [NSThread currentThread];
        [currentThread setName:VS_CORE_DATA_MANAGER_BACKGROUND_THREAD_NAME];

        // if there is not already a background context, then create one
        if (!_backgroundQueueManagedObjectContext)
        {
            NSPersistentStoreCoordinator *coordinator = [self persistentStoreCoordinator];
            if (coordinator != nil)
            {
                // create the background queue
                _backgroundQueueManagedObjectContext = [[NSManagedObjectContext alloc] initWithConcurrencyType:NSPrivateQueueConcurrencyType];
                [_backgroundQueueManagedObjectContext setParentContext:[self managedObjectContext]];
                [_backgroundQueueManagedObjectContext setMergePolicy:NSMergeByPropertyStoreTrumpMergePolicy];
                _backgroundQueueManagedObjectContext.undoManager = nil;
            }
        }

        // save the JSON dictionary starting at the upper most level of the key path
        NSArray *objects = [self saveJSON:jsonDict objectMapping:objectMapping class:managedObjectClass managedObjectContext:_backgroundQueueManagedObjectContext level:0];

        // if no objects were processed, then return with an error
        if (!objects || objects.count == 0)
        {
            currentRequest = nil;

            // dispatch the completion block
            dispatch_async(dispatch_get_main_queue(), ^(void)
            {
                NSError *error = [self createErrorWithErrorCode:100 description:@"No objects were found for the object mapping"];
                [self logMessage:error.debugDescription];
                completion(nil, error);
            });
        }

        // save the objects so we can access them later to be re-fetched and returned on the main thread
        if (objects.count > 0)
            [currentRequest.objects addObjectsFromArray:objects];

        // save the object IDs and the completion block to global variables so we can access them after the save
        if (completion)
            currentRequest.completionBlock = completion;

        // save all changes object context
        NSError *error = nil;
        [_backgroundQueueManagedObjectContext save:&error];
        if (error)
            [VS_Log logError:error.localizedDescription];

        dispatch_sync(dispatch_get_main_queue(), ^(void)
        {
            NSMutableArray *objects = [[NSMutableArray alloc] init];

            // iterate through the updated objects and find them in the main thread MOC
            for (NSManagedObject *object in currentRequest.objects)
            {
                NSError *error;
                NSManagedObject *obj = [[self managedObjectContext] existingObjectWithID:object.objectID error:&error];
                if (error)
                    [self logError:error];

                if (obj)
                    [objects addObject:obj];
            }

            // call the completion block
            if (currentRequest.completionBlock)
            {
                void (^saveCompletionBlock)(NSArray *, NSError *) = currentRequest.completionBlock;
                saveCompletionBlock(objects, nil);
            }
        });

        // clear out the request
        currentRequest = nil;
    });
} 
```

** 编辑 **

嗨，大家好，

我首先要感谢大家对此的意见，因为这就是我找到解决问题的方法的原因。长话短说，我完全放弃了使用 GCD 和自定义后台队列，而是现在使用嵌套上下文和“performBlock”方法在后台线程上执行所有保存。这很好用，我提出了挂断问题。

但是，我现在有一个新错误。每当我第一次运行我的应用程序时，每当我尝试保存具有子对象关系的对象时，都会出现以下异常。

-_referenceData64 仅为抽象类定义。定义 -[NSTemporaryObjectID_default _referenceData64]！

下面是我的新代码。

```
- (void)saveJsonObjects:(NSDictionary *)jsonDict
          objectMapping:(VS_ObjectMapping *)objectMapping
                  class:(__unsafe_unretained Class)managedObjectClass
             completion:(void (^)(NSArray *objects, NSError *error))completion
{
    [_backgroundManagedObjectContext performBlock:^(void)
    {
        // create a new process object and add it to the dictionary
        VS_CoreDataRequest *currentRequest = [[VS_CoreDataRequest alloc] init];
        currentRequest.managedObjectClass = managedObjectClass;

        // save the JSON dictionary starting at the upper most level of the key path
        NSArray *objects = [self saveJSON:jsonDict objectMapping:objectMapping class:managedObjectClass managedObjectContext:_backgroundManagedObjectContext level:0];

        if (objects.count == 0)
        {
            currentRequest.error = [self createErrorWithErrorCode:100 description:@"No objects were found for the object mapping"];
            [self performSelectorOnMainThread:@selector(backgroundSaveProcessDidFail:) withObject:currentRequest waitUntilDone:NO];
        }
        else
        {
            // save the objects so we can access them later to be re-fetched and returned on the main thread
            [currentRequest.objects addObjectsFromArray:objects];

            // save the object IDs and the completion block to global variables so we can access them after the save
            currentRequest.completionBlock = completion;

            [_backgroundManagedObjectContext lock];

            @try
            {
                [_backgroundManagedObjectContext processPendingChanges];
                [_backgroundManagedObjectContext save:nil];
            }
            @catch (NSException *exception)
            {
                currentRequest.error = [self createErrorWithErrorCode:100 description:exception.reason];
            }

            [_backgroundManagedObjectContext unlock];

            // complete the process on the main thread
            if (currentRequest.error)
                [self performSelectorOnMainThread:@selector(backgroundSaveProcessDidFail:) withObject:currentRequest waitUntilDone:NO];
            else
                [self performSelectorOnMainThread:@selector(backgroundSaveProcessDidSucceed:) withObject:currentRequest waitUntilDone:NO];

            // clear out the request
            currentRequest = nil;
        }
    }];
}

- (void)backgroundSaveProcessDidFail:(VS_CoreDataRequest *)request
{
    if (request.error)
        [self logError:request.error];

    if (request.completionBlock)
    {
        void (^saveCompletionBlock)(NSArray *, NSError *) = request.completionBlock;
        saveCompletionBlock(nil, request.error);
    }
}

- (void)backgroundSaveProcessDidSucceed:(VS_CoreDataRequest *)request
{
    // get objects from main thread
    NSArray *objects = nil;
    if (request.objects.count > 0)
    {
        NSFetchRequest *fetchReq = [NSFetchRequest fetchRequestWithEntityName:[NSString stringWithFormat:@"%@", request.managedObjectClass]];
        fetchReq.predicate = [NSPredicate predicateWithFormat:@"self IN %@", request.objects];
        objects = [self executeFetchRequest:fetchReq];
    }

    // call the completion block
    if (request.completionBlock)
    {
        void (^saveCompletionBlock)(NSArray *, NSError *) = request.completionBlock;
        saveCompletionBlock(objects, nil);
    }
}

- (NSManagedObjectContext *)managedObjectContext
{
    if (_managedObjectContext != nil) {
        return _managedObjectContext;
    }

    NSPersistentStoreCoordinator *coordinator = [self persistentStoreCoordinator];
    if (coordinator != nil)
    {
        // create the MOC for the backgroumd thread
        _backgroundManagedObjectContext = [[NSManagedObjectContext alloc] initWithConcurrencyType:NSPrivateQueueConcurrencyType];
        [_backgroundManagedObjectContext setPersistentStoreCoordinator:coordinator];
        [_backgroundManagedObjectContext setMergePolicy:NSMergeByPropertyStoreTrumpMergePolicy];
        _backgroundManagedObjectContext.undoManager = nil;

        // create the MOC for the main thread
        _managedObjectContext = [[NSManagedObjectContext alloc] initWithConcurrencyType:NSMainQueueConcurrencyType];
        [_managedObjectContext setParentContext:_backgroundManagedObjectContext];
        [_managedObjectContext setMergePolicy:NSMergeByPropertyStoreTrumpMergePolicy];
    }

    return _managedObjectContext;
} 
```

你们中有人知道为什么会发生这种崩溃吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T21:27:39.737

您可能需要考虑这种上下文架构（未经测试的代码）：
mainManagedObjectContext 将以相同的方式初始化，但`NSMainQueueConcurrencyType`没有观察者（顺便说一句，请记住删除您的观察者）

```
- (void) mergeChangesFromBackground:(NSNotification*)notification
{
    __block __weak NSManagedObjectContext* context = self.managedObjectContext;
    [context performBlockAndWait:^{
        [context mergeChangesFromContextDidSaveNotification:notification];
    }];
}

- (NSManagedObjectContext*) bgContext
{
    if (_bgContext) {
        return _bgContext;
    }

    NSPersistentStoreCoordinator* coordinator = [self persistentStoreCoordinator];
    if (!coordinator) {
        return nil;
    }
    _bgContext = [[NSManagedObjectContext alloc] initWithConcurrencyType:NSPrivateQueueConcurrencyType];
    [_bgContext setPersistentStoreCoordinator:coordinator];
    [_bgContext setMergePolicy:NSMergeByPropertyStoreTrumpMergePolicy];
    [_bgContext setUndoManager:nil];
    [[NSNotificationCenter defaultCenter] addObserver:self
                                             selector:@selector(mergeChangesFromBackground:)
                                                 name:NSManagedObjectContextDidSaveNotification
                                               object:_bgContext];
    return _bgContext;
}

- (void) doSomethingOnBGContextWithoutBlocking:(void(^)(NSManagedObjectContext*))contextBlock
{
    __block __weak NSManagedObjectContext* context = [self bgContext];
    [context performBlock:^{
        NSThread *currentThread = [NSThread currentThread];
        NSString* prevName = [currentThread name];
        [currentThread setName:@"BGContextThread"];

        contextBlock(context);

        [context reset];
        [currentThread setName:prevName];
    }];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T14:52:34.533

我首先要感谢大家对此的意见，因为这就是我找到解决问题的方法的原因。长话短说，我完全放弃了使用 GCD 和自定义后台队列，而是现在使用嵌套上下文和“performBlock”方法在后台线程上执行所有保存。这很好用，我提出了挂断问题。

但是，我现在有一个新错误。每当我第一次运行我的应用程序时，每当我尝试保存具有子对象关系的对象时，都会出现以下异常。

-_referenceData64 仅为抽象类定义。定义 -[NSTemporaryObjectID_default _referenceData64]！

下面是我的新代码。

```
- (void)saveJsonObjects:(NSDictionary *)jsonDict
          objectMapping:(VS_ObjectMapping *)objectMapping
                  class:(__unsafe_unretained Class)managedObjectClass
             completion:(void (^)(NSArray *objects, NSError *error))completion
{
    [_backgroundManagedObjectContext performBlock:^(void)
    {
        // create a new process object and add it to the dictionary
        VS_CoreDataRequest *currentRequest = [[VS_CoreDataRequest alloc] init];
        currentRequest.managedObjectClass = managedObjectClass;

        // save the JSON dictionary starting at the upper most level of the key path
        NSArray *objects = [self saveJSON:jsonDict objectMapping:objectMapping class:managedObjectClass managedObjectContext:_backgroundManagedObjectContext level:0];

        if (objects.count == 0)
        {
            currentRequest.error = [self createErrorWithErrorCode:100 description:@"No objects were found for the object mapping"];
            [self performSelectorOnMainThread:@selector(backgroundSaveProcessDidFail:) withObject:currentRequest waitUntilDone:NO];
        }
        else
        {
            // save the objects so we can access them later to be re-fetched and returned on the main thread
            [currentRequest.objects addObjectsFromArray:objects];

            // save the object IDs and the completion block to global variables so we can access them after the save
            currentRequest.completionBlock = completion;

            [_backgroundManagedObjectContext lock];

            @try
            {
                [_backgroundManagedObjectContext processPendingChanges];
                [_backgroundManagedObjectContext save:nil];
            }
            @catch (NSException *exception)
            {
                currentRequest.error = [self createErrorWithErrorCode:100 description:exception.reason];
            }

            [_backgroundManagedObjectContext unlock];

            // complete the process on the main thread
            if (currentRequest.error)
                [self performSelectorOnMainThread:@selector(backgroundSaveProcessDidFail:) withObject:currentRequest waitUntilDone:NO];
            else
                [self performSelectorOnMainThread:@selector(backgroundSaveProcessDidSucceed:) withObject:currentRequest waitUntilDone:NO];

            // clear out the request
            currentRequest = nil;
        }
    }];
}

- (void)backgroundSaveProcessDidFail:(VS_CoreDataRequest *)request
{
    if (request.error)
        [self logError:request.error];

    if (request.completionBlock)
    {
        void (^saveCompletionBlock)(NSArray *, NSError *) = request.completionBlock;
        saveCompletionBlock(nil, request.error);
    }
}

- (void)backgroundSaveProcessDidSucceed:(VS_CoreDataRequest *)request
{
    // get objects from main thread
    NSArray *objects = nil;
    if (request.objects.count > 0)
    {
        NSFetchRequest *fetchReq = [NSFetchRequest fetchRequestWithEntityName:[NSString stringWithFormat:@"%@", request.managedObjectClass]];
        fetchReq.predicate = [NSPredicate predicateWithFormat:@"self IN %@", request.objects];
        objects = [self executeFetchRequest:fetchReq];
    }

    // call the completion block
    if (request.completionBlock)
    {
        void (^saveCompletionBlock)(NSArray *, NSError *) = request.completionBlock;
        saveCompletionBlock(objects, nil);
    }
}

- (NSManagedObjectContext *)managedObjectContext
{
    if (_managedObjectContext != nil) {
        return _managedObjectContext;
    }

    NSPersistentStoreCoordinator *coordinator = [self persistentStoreCoordinator];
    if (coordinator != nil)
    {
        // create the MOC for the backgroumd thread
        _backgroundManagedObjectContext = [[NSManagedObjectContext alloc] initWithConcurrencyType:NSPrivateQueueConcurrencyType];
        [_backgroundManagedObjectContext setPersistentStoreCoordinator:coordinator];
        [_backgroundManagedObjectContext setMergePolicy:NSMergeByPropertyStoreTrumpMergePolicy];
        _backgroundManagedObjectContext.undoManager = nil;

        // create the MOC for the main thread
        _managedObjectContext = [[NSManagedObjectContext alloc] initWithConcurrencyType:NSMainQueueConcurrencyType];
        [_managedObjectContext setParentContext:_backgroundManagedObjectContext];
        [_managedObjectContext setMergePolicy:NSMergeByPropertyStoreTrumpMergePolicy];
    }

    return _managedObjectContext;
} 
```

你们中有人知道为什么会发生这种崩溃吗？

** 编辑 **

女士们，先生们，我找到了解决方案。显然，即使使用嵌套上下文，您仍然必须通过 NSManagedObjectContextDidSaveNotification 合并更改。一旦我将它添加到我的代码中，它就开始完美地工作了。下面是我的工作代码。谢谢百万人！

```
- (NSManagedObjectContext *)managedObjectContext
{
    if (_managedObjectContext != nil)
        return _managedObjectContext;

    NSPersistentStoreCoordinator *coordinator = [self persistentStoreCoordinator];
    if (coordinator != nil)
    {
        // create the MOC for the backgroumd thread
        _backgroundManagedObjectContext = [[NSManagedObjectContext alloc] initWithConcurrencyType:NSPrivateQueueConcurrencyType];
        [_backgroundManagedObjectContext setPersistentStoreCoordinator:coordinator];
        [_backgroundManagedObjectContext setMergePolicy:NSMergeByPropertyStoreTrumpMergePolicy];
        _backgroundManagedObjectContext.undoManager = nil;

        // create the MOC for the main thread
        _managedObjectContext = [[NSManagedObjectContext alloc] initWithConcurrencyType:NSMainQueueConcurrencyType];
        [_managedObjectContext setParentContext:_backgroundManagedObjectContext];
        [_managedObjectContext setMergePolicy:NSMergeByPropertyStoreTrumpMergePolicy];

        [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(mergeChangesFromContextDidSaveNotification:) name:NSManagedObjectContextDidSaveNotification object:_backgroundManagedObjectContext];
    }

    return _managedObjectContext;
}

- (void)saveJsonObjects:(NSDictionary *)jsonDict
          objectMapping:(VS_ObjectMapping *)objectMapping
                  class:(__unsafe_unretained Class)managedObjectClass
             completion:(void (^)(NSArray *objects, NSError *error))completion
{
    // perform save on background thread
    [_backgroundManagedObjectContext performBlock:^(void)
    {
        // create a new process object and add it to the dictionary
        VS_CoreDataRequest *currentRequest = [[VS_CoreDataRequest alloc] init];
        currentRequest.managedObjectClass = managedObjectClass;

        // save the JSON dictionary starting at the upper most level of the key path
        NSArray *objects = [self saveJSON:jsonDict objectMapping:objectMapping class:managedObjectClass managedObjectContext:_backgroundManagedObjectContext level:0];

        if (objects.count == 0)
        {
            currentRequest.error = [self createErrorWithErrorCode:100 description:@"No objects were found for the object mapping"];
            [self performSelectorOnMainThread:@selector(backgroundSaveProcessDidFail:) withObject:currentRequest waitUntilDone:NO];
        }
        else
        {
            // save the objects so we can access them later to be re-fetched and returned on the main thread
            [currentRequest.objects addObjectsFromArray:objects];

            // save the object IDs and the completion block to global variables so we can access them after the save
            currentRequest.completionBlock = completion;

            [_backgroundManagedObjectContext lock];

            @try
            {
                [_backgroundManagedObjectContext processPendingChanges];
                [_backgroundManagedObjectContext save:nil];
            }
            @catch (NSException *exception)
            {
                currentRequest.error = [self createErrorWithErrorCode:100 description:exception.reason];
            }

            [_backgroundManagedObjectContext unlock];

            // complete the process on the main thread
            if (currentRequest.error)
                [self performSelectorOnMainThread:@selector(backgroundSaveProcessDidFail:) withObject:currentRequest waitUntilDone:NO];
            else
                [self performSelectorOnMainThread:@selector(backgroundSaveProcessDidSucceed:) withObject:currentRequest waitUntilDone:NO];

            // clear out the request
            currentRequest = nil;
        }
    }];
}

- (void)mergeChangesFromContextDidSaveNotification:(NSNotification *)notification
{
    [_managedObjectContext mergeChangesFromContextDidSaveNotification:notification];
}

- (void)backgroundSaveProcessDidFail:(VS_CoreDataRequest *)request
{
    if (request.error)
        [self logError:request.error];

    if (request.completionBlock)
    {
        void (^saveCompletionBlock)(NSArray *, NSError *) = request.completionBlock;
        saveCompletionBlock(nil, request.error);
    }
}

- (void)backgroundSaveProcessDidSucceed:(VS_CoreDataRequest *)request
{
    // get objects from main thread
    NSArray *objects = nil;
    if (request.objects.count > 0)
    {
        NSFetchRequest *fetchReq = [NSFetchRequest fetchRequestWithEntityName:[NSString stringWithFormat:@"%@", request.managedObjectClass]];
        fetchReq.predicate = [NSPredicate predicateWithFormat:@"self IN %@", request.objects];
        objects = [self executeFetchRequest:fetchReq];
    }

    // call the completion block
    if (request.completionBlock)
    {
        void (^saveCompletionBlock)(NSArray *, NSError *) = request.completionBlock;
        saveCompletionBlock(objects, nil);
    }
} 
```

# android - 根据 Dialog 的输入修改 MainActivity 变量

> ID：15820632
> 
> 赞同：0
> 
> 时间：2013-04-04T20:01:18.693
> 
> 标签：android, android-alertdialog

我正在构建一个使用`ListView`. 当前，当用户单击 ListView 的一行时，会执行以下代码。此代码基本上删除了一些与所选行有关的数据。该代码是 MainActivity.class 的一个片段。

```
//understanding this code is not crucial. list is the ListView, adapter is an 
//ArrayAdapter object and displayDataMap is a Hashmap object.

list.setOnItemLongClickListener(new OnItemLongClickListener(){

@Override
public boolean onItemLongClick(AdapterView<?> arg0, View view, int position, long id) {
    String key = adapter.getItem(position); //position of ListView row
    String data = displayDataMap.get(key);
    displayDataMap.remove(key);

  //"aqlpzaml" is used as a regex.
    String addressee = data.split("aqlpzaml")[1];
    long time = Long.valueOf(data.split("aqlpzaml")[0]);
    int finalID = Integer.valueOf(data.split("aqlpzaml")[3]);
    String dateTime = sdf.format(time);
    adapter.remove(addressee + " " + dateTime);
    adapter.notifyDataSetChanged();
} 
```

现在我希望在删除这些数据之前，向用户提示一个`Dialog`，询问他是否确定要进行更改。

我知道如何创建`Dialog`和显示它。但我不知道如何根据输入触发值`adapter`的变化。我想如果我使用另一个类来创建一个对象（使用），那么我将无法在该对话框中访问类的私有变量。`displayDataMap``Dialog``Dialog``DialogFragment``MainActivity``setPositiveButton()`

有什么建议么 ？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T20:16:12.313

只需在 onItemLongClick 中插入您的对话框创建，并使适配器“适配器”、“收件人”和“日期时间”成为最终的，以便您可以在 setPositiveButton() 方法中访问它。

因为我不知道您的适配器是如何创建的，它应该看起来像这样，并且与 list.setOnItemLongClickListener 或类变量具有相同的功能：

```
final ArrayAdapter<String> adapter = ... 
```

还有你的数据图：

```
final Hashmap<String, ...> displayDataMap = ... 
```

你的函数应该是这样的：

```
list.setOnItemLongClickListener(new OnItemLongClickListener(){
    @Override
    public boolean onItemLongClick(AdapterView<?> arg0, View view, int position, long id) 
    {
        final String key = adapter.getItem(position); //position of ListView row
        String data = displayDataMap.get(key);
        //"aqlpzaml" is used as a regex.
        final String addressee = data.split("aqlpzaml")[1];
        long time = Long.valueOf(data.split("aqlpzaml")[0]);
        int finalID = Integer.valueOf(data.split("aqlpzaml")[3]);
        final String dateTime = sdf.format(time);

        Builder dialog = new Builder(view.getContext());
        dialog
            .setMessage("Want to delete?")
            .setPositiveButton("delete",new DialogInterface.OnClickListener() {
                public void onClick(DialogInterface dialog,int id) {
                    displayDataMap.remove(key);
                    adapter.remove(addressee + " " + dateTime);
                    adapter.notifyDataSetChanged();
                }
            })
            .setNegativeButton("cancel",new DialogInterface.OnClickListener() {
                public void onClick(DialogInterface dialog,int id) {
                    dialog.cancel();
                }
            });
        dialog.create().show();
    }
} 
```

# python - python中的TLS回显服务器和回显客户端崩溃

> ID：15820634
> 
> 赞同：3
> 
> 时间：2013-04-04T20:01:28.233
> 
> 标签：python, sockets, ssl, client-server

我用 Python 编写了一个简单的回显服务器客户端代码。我还使用命令生成了 keyfile.pem 和 certfile.pem：

`openssl genrsa -des3 -out keyfile.pem 2048`和

`openssl req -new -key keyfile.pem -out certfile.pem`

当我运行客户端服务器时，它询问了我关于 passphase:的信息`Enter PEM pass phrase:`，我输入了正确的文本并得到了错误（不知道为什么）：

```
Traceback (most recent call last):   File "echo_server.py", line 19, in <module>
    connection, client_address= tls_server.accept()   File "/usr/lib/python2.7/ssl.py", line 354, in accept
    suppress_ragged_eofs=self.suppress_ragged_eofs),   File "/usr/lib/python2.7/ssl.py", line 141, in __init__
    ciphers) ssl.SSLError: [Errno 336445449] _ssl.c:365: error:140DC009:SSL routines:SSL_CTX_use_certificate_chain_file:PEM lib 
```

这是我的server.py：

```
#server side
# echo client
from socket import *
from ssl import *

#create socket
server_socket=socket(AF_INET, SOCK_STREAM)

#Bind to an unused port on the local machine
server_socket.bind(('localhost',6668))

#listen for connection
server_socket.listen (1)
tls_server = wrap_socket(server_socket, ssl_version=PROTOCOL_TLSv1, cert_reqs=CERT_NONE, server_side=True, keyfile='./keyfile.pem', certfile='./certfile.pem')

print('server started')

#accept connection
connection, client_address= tls_server.accept()
print ('connection from', client_address)

#server is not finnished
finnished =False

#while not finnished
while not finnished:

    #send and receive data from the client socket
    data_in=connection.recv(1024)
    message=data_in.decode()
    print('client send',message)

    if message=='quit':
        finnished= True
    else:

        data_out=message.encode()
        connection.send(data_out)

#close the connection
connection.shutdown(SHUT_RDWR)
connection.close()

#close the server socket
server_socket.shutdown(SHUT_RDWR)
server_socket.close() 
```

和client.py：

```
#client side
# echo client
from socket import *
from ssl import *

#user is not finnished
finnished =False

#create socket
client_socket=socket(AF_INET, SOCK_STREAM)
tls_client = wrap_socket(client_socket, ssl_version=PROTOCOL_TLSv1, cert_reqs=CERT_NONE)

#connect to the echo server
tls_client.connect(('localhost',6668))

#while not finnished
while not finnished:

    #message
    message=input ('enter message:   ')

    data_out= message.encode ()

    #send data out
    tls_client.send(data_out)    

    #receive data
    data_in=tls_client.recv(1024)

    #decode message
    response= data_in.decode()
    print('Received from client:', response)

    reapet=input('yes or no?  ')

    if reapet == 'n':
        finnished= True
        client_socket.send(b'quit')

#close the socket
client_socket.shutdown(SHUT_RDWR)
client_socket.close() 
```

可能有什么问题？我使用 Kubuntu 12.04 LTS 和 Python 2.7。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-06-11T20:45:29.913

```
openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout my.key -out my.crt 
```

# css - 在 chrome 中打印（另存为 pdf）问题

> ID：15820638
> 
> 赞同：4
> 
> 时间：2013-04-04T20:01:40.123
> 
> 标签：css, google-chrome, pdf, printing

问题是这样的 - 在 Chrome 中，此页面在一台计算机上正确保存为 PDF，而在另一台计算机上存在问题。我有这个代码：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Untitled Document</title>
<style type="text/css">
body
{
    margin:0; padding:0;
}
.fullscreen
{
    width:1156px;
    height:893px;
    float:left;
    background:url(2.jpg) no-repeat;
}
.firstpage{background:url(1.jpg) no-repeat;}
.lastpage{background:url(3.jpg) no-repeat;}
@media print {
  body {
    width:1156;
    height:893;
  }
}
</style>
</head>

<body>
<div class="fullscreen firstpage"></div>
<div class="fullscreen"></div>
<div class="fullscreen lastpage"></div>
</body>
</html> 
```

它只有 3 个 div 和 3 个不同的背景图像（相同大小 - 1156x893）。在我家的电脑上，一切正常。如果我放置 @page{size:1156 893;} 或 size:auto，或者（在本例中）我根本不放置它，没有区别。

问题是在我的办公室电脑上，无论我做什么，打印模式下的页面大小总是1286x909，内容被缩放并超出页面。我在这里遗漏了什么还是问题根本不在页面代码中？如果它不在代码中，我必须在哪里进行更改才能使其正确？如有必要，我也可以提供 2 个 PDF 文件。

我在两台计算机上都使用 Windows 7 和最新版本的 Chrome。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-03-23T13:32:29.013

您需要实现完整的 css 样式进行打印。

您为打印而编写的代码仅用于正文。

```
@media print {
  body {
    width:1156;
    height:893;
  }
} 
```

由于缺少该 css 样式，浏览器将采用 pdf 的默认值。因此，如果您创建一个完整的 css 样式会更好，您可以查看这篇文章以了解如何做到这一点。 [https://www.smashingmagazine.com/2011/11/how-to-set-up-a-print-style-sheet/](https://www.smashingmagazine.com/2011/11/how-to-set-up-a-print-style-sheet/)

请让我知道这是否适合你:)

# railstutorial.org - Rails 教程第 7 章 Rspec 失败

> ID：15820639
> 
> 赞同：0
> 
> 时间：2013-04-04T20:01:40.277
> 
> 标签：railstutorial.org

我正在阅读 ROR 教程并在问题 4 上遇到障碍。

```
Failures:
  1) UserPages signup with valid information after saving the user      
Failure/Error: it    { should have_selector('div.alert.alert-success', text: 'Welcome') }
       expected css "div.alert.alert-success" with text "Welcome" to return something
     # ./spec/requests/user_pages_spec.rb:54:in `block (5 levels) in <top (required)>'

Finished in 3.26 seconds
39 examples, 1 failure
Failed examples:

rspec ./spec/requests/user_pages_spec.rb:54 # UserPages signup with valid information    after saving the user 
```

用户控制器.rb

```
class UsersController < ApplicationController
  def show
    @user = User.find(params[:id])
  end

  def create
    @user = User.new(params[:user])
    if @user.save
      # Handle a successful save.
      flash[:success] = "Welcome to the Sample App!"
      redirect_to @user
    else 
      render 'new'
    end
  end

  def new
    @user = User.new
 end
end 
```

user_pages_spec.rb

```
require 'spec_helper'

describe "UserPages" do
  subject { page }

  describe "profile page" do
    let(:user) { FactoryGirl.create(:user) }
    before { visit user_path(user) }

    it { should have_selector('h1', text: user.name) }
    it { should have_selector('title', text: user.name) }
  end

  describe "signup page" do
    before { visit signup_path }
    it {should have_selector('h1', text: 'Sign up') }
    it {should have_selector('title', text: full_title('Sign up')) }
  end

  describe "signup" do
    before { visit signup_path }
    let(:submit) { "Create my account" }

    describe "with invalid information" do
      it "should not create a user" do
        expect { click_button submit }.not_to change(User, :count)
      end

      describe "after submission" do
        before { click_button submit }
        it { should have_selector('title', text: 'Sign up') }
        it { should have_content('error') }
        it { should have_content('The form contains')}
      end
    end

    describe "with valid information" do
      before do
        fill_in "Name",         with: "Example User"
        fill_in "Email",        with: "user@example.com"
        fill_in "Password",     with: "foobar"
        fill_in "Confirmation", with: "foobar"
      end

      it "should create a user" do
        expect { click_button submit }.to change(User, :count).by(1)
      end

      describe "after saving the user" do
        before { click_button submit }
        let(:user) { User.find_by_email('user@example.com') }
        it { should have_selector('title', text: user.name) }
        it { should have_selector('div.alert.alert-success', text: 'Welcome') }
      end

    end
  end
end 
```

应用程序.html.erb

```
<!DOCTYPE html>
<html>
  <head>
    <title><%= full_title(yield(:title)) %></title>
    <%= stylesheet_link_tag    "application", media: "all" %>
    <%= javascript_include_tag "application" %>
    <%= csrf_meta_tags %>
    <%= render 'layouts/shim' %>
  </head>
  <body>
    <%= render 'layouts/header' %>
    <div class="container">

      <% flash.each do |key, value| %>
        <div class="alert alert-"<%= key %>"><%= value %></div>
      <% end %>

      <%= yield %>
      <%= render 'layouts/footer' %>
      <%= debug(params) if Rails.env.development? %>
    </div>
  </body>
</html> 
```

我试过手动硬编码

```
<div class="alert alert-success">Welcome</div> 
```

这会导致测试通过，所以我排除了 user_pages_spec 文件。不确定错误在哪里，因为它在注册时会打印成功消息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-07T12:13:27.290

看起来你有一个额外的报价

```
<div class="alert alert-"<%= key %>"><%= value %></div> 
```

应该

```
<div class="alert alert-<%= key %>"><%= value %></div> 
```

# c# - 如何模拟实现多个接口的类

> ID：15820642
> 
> 赞同：62
> 
> 时间：2013-04-04T20:01:47.570
> 
> 标签：c#, mocking, moq

如何模拟以下课程：

```
UserRepository : GenericRepository<User>, IUserRepository

public class GenericRepository<TEntity> : IGenericRepository<TEntity> where TEntity : class 
```

我正在使用起订量，我很困惑如何正确处理多个接口。

* * *

## 回答 #1

> 赞同：103
> 
> 时间：2015-01-26T05:55:36.783

看看[https://github.com/Moq/moq4/wiki/Quickstart](https://github.com/Moq/moq4/wiki/Quickstart)

**高级功能**

```
// implementing multiple interfaces in mock
var foo = new Mock<IFoo>();
var disposableFoo = foo.As<IDisposable>();
// now IFoo mock also implements IDisposable :)
disposableFoo.Setup(df => df.Dispose()); 
```

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2013-04-09T08:53:02.400

Moq 中内置了一种机制来处理多个接口。

假设我们有一个接口**IFoo**和同一个**Foo**的实现。我们还有使用 IFoo的**ClientOne 。**

然后我们有一个接口**IFooBar : IFoo**、一个实现**FooBar : Foo、IFooBar**和一个使用**IFooBar**的ClientTwo。

在为系统创建端到端测试时，我们有**IFooBar**、**ClientOne**和**ClientTwo**。**As<>()**函数允许我们将Mock **<IFooBar>**用作**Mock<IFoo>**。

```
public interface IFoo {
    int Id { get; }
}

public class Foo : IFoo {
    public int Id {
        get { return 1; }
    }
}

public interface IFooBar : IFoo  {
    string Name { get; }
}

public class FooBar : Foo, IFooBar {
    public string Name {
        get { return "AName"; }
    }
}

public class ClientOne {
    private readonly IFoo foo;

    public ClientOne(IFoo foo) {
        this.foo = foo;
    }

    public string Details {
        get { return string.Format("Foo : {0}", foo.Id); }
    }

}

public class ClientTwo {
    private readonly IFooBar fooBar;

    public ClientTwo(IFooBar fooBar) {
        this.fooBar = fooBar;
    }

    public string Details {
        get { return string.Format("Foo : {0}, Bar : {1}", fooBar.Id, fooBar.Name); }
    }

}

[TestMethod]
public void TestUsingBothClients() {

    var fooBarMock = new Mock<IFooBar>();
    var fooMock = fooBarMock.As<IFoo>();

    fooBarMock.SetupGet(mk => mk.Id).Returns(1);
    fooBarMock.SetupGet(mk => mk.Name).Returns("AName");

    var clientOne = new ClientOne(fooMock.Object);
    var clientTwo = new ClientTwo(fooBarMock.Object);

    Assert.AreEqual("Foo : 1", clientOne.Details);
    Assert.AreEqual("Foo : 1, Bar : AName", clientTwo.Details);

} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-06T12:26:15.973

如果我正确理解了这个问题，您需要一个模拟实例`UserRepository`，并且出于测试目的，设置从`IGenericRepository<TEntity>`接口和`IUserRepository`接口调用方法。

您可以使用单个模拟实例实现多个接口，如下所示：

```
var genericRepositoryMock = new Mock<IGenericRepository<User>>();
genericRepositoryMock.Setup(m => m.CallGenericRepositoryMethod()).Returns(false);

var userRepositoryMock = genericRepositoryMock.As<IUserRepository>();
userRepositoryMock.Setup(m => m.CallUserRepositoryMethod()).Returns(true); 
```

然而，正如 D Stanley 指出的那样，需要这样做可能表明您的设计存在缺陷。

# javascript - Angular JS + jasmine 测试控制器

> ID：15820644
> 
> 赞同：4
> 
> 时间：2013-04-04T20:01:59.173
> 
> 标签：javascript, testing, angularjs, mocking, jasmine

我在 controllersSpec.coffee Angular App 代码中有一个简单的测试：

```
describe 'Controllers', ->
  beforeEach ->
    angular.module 'app'
  describe 'MainCtrl', ->
    beforeEach inject ($controller, $rootScope) ->
      scope = $rootScope.$new()
      ctrl = $controller 'MainCtrl', $scope: scope
    it 'should be true', ->
      expect(true).toEqual(true) 
```

和 SpecRunner.html 文件进行测试：

```
<html lang="eu">
  <head>
    <title>Angular Test Runner</title>
    <script src="../js/libs/jquery.js"></script>
    <script src="lib/jasmine.js"></script>
    <script src="lib/jasmine-html.js"></script>
    <script src="../js/libs/underscore.js"></script>
    <script src="../js/libs/angular.js"></script>
    <script src="lib/angular/angular-mocks.js"></script>
    <script src="lib/angular/angular-scenario.js" ng-autotest></script>
    <script src="../js/controllers.js"></script>
    <script src="controllersSpec.js"></script>
    <script type="text/javascript">
    (function() {
    var jasmineEnv = jasmine.getEnv();
    jasmineEnv.updateInterval = 1000;
        var htmlReporter = new jasmine.HtmlReporter();
    jasmineEnv.addReporter(htmlReporter);
    jasmineEnv.specFilter = function(spec) {
      return htmlReporter.specFilter(spec);
        };
    var currentWindowOnload = window.onload;
    window.onload = function() {
      if (currentWindowOnload) {
        currentWindowOnload();
          }
          execJasmine();
        };
        function execJasmine() {
       jasmineEnv.execute();
    }
    })();
    </script>
    </head>
    <body>
    </body>
</html> 
```

那个抛出错误，关于angular-mock中的'$modules'：

```
TypeError: Cannot read property '$modules' of null
    at Object.workFn (http://localhost/lolobot/test/lib/angular/angular-mocks.js:1745:25)
    at Object.<anonymous> (http://localhost/lolobot/test/lib/angular/angular-scenario.js:24673:54)
    at Array.forEach (native)
    at Object.forEach (http://localhost/lolobot/test/lib/angular/angular-scenario.js:9538:11) 
```

你能帮我解决这个问题吗？这是我的第一个测试角度应用程序。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T23:12:56.803

我认为您需要包含更多的 Angular 包。我将整个套件都包含在我的跑步者中。我不认为我真的需要它们，但我试图删除一些并失败了。具体来说，我有这些：

```
angular.js
angular-bootstrap.js
angular-cookies.js
angular-loader.js
angular-mocks.js
angular-resource.js
angular-sanitize.js 
```

此外，在您的测试中，您可能希望拥有

```
controller = null
scope = null 
```

在您的`describe`街区中的任何其他东西之前。否则，您的控制器和范围最终会成为`inject`函数中的局部变量。

# ruby-on-rails - 别名路线名称

> ID：15820647
> 
> 赞同：13
> 
> 时间：2013-04-04T20:02:17.253
> 
> 标签：ruby-on-rails, devise, routes

我需要通过多个名称访问一条路径。在我`routes.rb`做的

```
get '/route' => 'controller#edit', :as => 'name_a'
get '/route' => 'controller#edit', :as => 'name_b' 
```

这很好用，但没有加载路由表。根据我对文档的理解，`:as`在调用时定义了一个辅助方法。

所以我去了我的`ApplicationController`并添加了

```
alias_method :name_b, :name_a 
```

我删除了第二行`routes.rb`

但这失败了`Uncaught exception: undefined method name_a for class ApplicationController`

是否有任何正确的方法可以为单个路径设置两个名称？

=================编辑==================== 阐述：

`Admin`我使用 Devise gem 来管理 2 种用户的会话、注册、锁定等，我们称之为`Guest`. gem 放置得很好，但它要求明确的路线名称才能正常运行。

就我而言，就设计而言，只有注册过程不同，所以我正在尝试构建一个如下所示的结构：

```
app
  controllers
    users
        admin
            registration_controller.rb
        guest
            registration_controller.rb
        session_controller.rb
        password_controller.rb
        registration_controller.rb 
```

和控制器继承自上面的registration_controller，后者继承自Devise `Admin`。`Guest`

现在，为了正常工作，Devise 需要例如名称`guest_user_password`以及`admin_user_password`创建或删除密码检索。就我而言，两者都在同一路径下，因此我希望两个名称都重定向到相同的“用户/密码”控制器。

更重要的是，这就是为什么我真的想要令人振奋的原因。是我的观点不应该关心重定向到密码检索控制器时是否正在处理`Admin`和路由。`Guest`两者都是用户，所以我想同时使用`user_password`它们。

因此我的问题。:)

另请注意，正如我写的那样，一切正常。我只是想用“最优雅的方式”来写它。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-11-01T14:30:00.017

将别名放在您的 ApplicationController 中怎么样？

```
class ApplicationController < ActionController::Base

alias_method :route_new, :route_old
helper_method :route_new 
```

请记住，它首先是新名称，然后是旧名称。

helper_method 调用是为了在您的视图中使用这些，而不仅仅是控制器。

如果你愿意，你可以把它放在一个名为 RouteAliases 之类的包含模块中

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-09-14T12:13:22.773

您可以将这样的内容添加到您的`routes.rb`：

```
Rails.application.routes.draw do

  ...

  Rails.application.routes.named_routes.tap do |named_routes|
    named_routes['new_name'] = named_routes['real_name']
  end
end 
```

这将创建`new_name_path`和`new_name_url`助手。我已经用 Rails 5.0.6 对此进行了测试。

# wix - WIX MSI perMachine 安装程序将已安装属性写入 HKCU 而不是 HKLM

> ID：15820654
> 
> 赞同：0
> 
> 时间：2013-04-04T20:02:28.630
> 
> 标签：wix, registry, windows-installer

WIX MSI perMachine 安装程序将已安装属性写入 HKCU 而不是 HKLM。

症状之一是我用来检测安装旧版本产品的尝试的原始逻辑失败了，因为我依赖 Installed 属性在之前执行安装的系统上进行定义。为了清楚起见，这种逻辑在过去是有效的，但现在我正在做回归测试，但它失败了。

我用 orca 编辑了 msi 并修改了测试这个的启动条件。我将启动条件更改为“已安装”并将消息更改为“未安装”，然后在安装了我们的应用程序的几个系统上运行安装程序。如果 Installed 为真，则安装程序将运行，但在每种情况下，安装程序都会显示消息框，这意味着它找不到注册表项。

我查看了所有这些系统，“已安装”注册表项位于 HKCU/Software/company/product/installed=1 而不是 HKLM。

这也是一个 64 位安装程序，当我运行安装程序时，它会进入 UI，我查看任务管理器以确保它运行的是 64 位版本的 msiexec。

这是停止工作的相关 WIX 片段。见第一个启动条件。我正在添加 Product ... 部分的开头。

```
<Product Id="*"
 Name="$(var.ProductDisplayName)"
 Language="1033"
 Version="$(var.OurVersion)"
 Manufacturer="$(var.ProductAuthor)"
 UpgradeCode="$(var.ProductUpgradeCode)">
<Product Id="*"
 Name="$(var.ProductDisplayName)"
 Language="1033"
 Version="$(var.VayTekVersion)"
 Manufacturer="$(var.ProductAuthor)"
 UpgradeCode="$(var.ProductUpgradeCode)"
>

<Package
  Description="$(var.ProductDisplayName)"
  Comments="$(var.ProductDisplayComment)"
  Manufacturer="$(var.ProductAuthor)"
  InstallerVersion="301" Compressed="yes"
  Platform="$(var.Platform)"
  InstallScope="perMachine"
  InstallPrivileges="elevated"/>

<Upgrade Id="$(var.ProductUpgradeCode)">
<UpgradeVersion Minimum="$(var.OurVersion)"
    IncludeMinimum="no" 
    OnlyDetect="yes"   
    Property="NEWERPRODUCTFOUND" />
<UpgradeVersion
    Minimum="07.01.01001" IncludeMinimum="yes"
    Maximum="$(var.OurVersion)" IncludeMaximum="no"
    Property="PREVIOUSVERSIONSINSTALLED"/>
</Upgrade>

<InstallExecuteSequence>
  <RemoveExistingProducts After="InstallFinalize"/>
</InstallExecuteSequence>

<Condition 
    Message="A later version of the product is already installed. Setup  will now exit.">
    (NOT NEWERPRODUCTFOUND) OR (NOT Installed)
</Condition> 
```

在我盯着代码一会儿后，我删除了“未安装”逻辑并离开了

```
NOT NEWERPRODUCTFOUND 
```

这并不理想，但它适用于大多数情况。

任何人都知道为什么注册表项被放置在错误的配置单元中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T20:24:21.673

`ALLUSERS`当属性设置为“1”时，MSI 包是每台计算机的。在 WiX 工具集中，您可以使用将`Package`元素`InstallScope`属性设置为“perMachine”来进行设置。

此外，升级不会检测到其他安装范围内的包。换句话说，每台机器不能升级每用户，反之亦然。

PS：`"NOT Installed"`在a`LaunchCondition`中看到是一件很奇怪的事情。那只会尝试阻止修复/卸载。

# codeigniter - Codeigniter CSV 上传然后爆炸

> ID：15820656
> 
> 赞同：0
> 
> 时间：2013-04-04T20:02:34.003
> 
> 标签：codeigniter, activerecord

我有一些将 CSV 文件上传到指定文件夹的代码，但它不会更新数据库。

```
public function do_upload()
{
    $csv_path = realpath(APPPATH . '/../assets/uploads/CSV/');
    $config['upload_path']   = $csv_path;
    $config['allowed_types'] = '*'; // All types of files allowed
    $config['overwrite']     = true; // Overwrites the existing file

    $this->upload->initialize($config);
    $this->load->library('upload', $config);

    if ( ! $this->upload->do_upload('userfile'))
    {
        $error = array('error' => $this->upload->display_errors());

        $this->layout->buffer('content', 'program/upload', $error);
        $this->layout->render();
    }
    else
    {

        $image_data = $this->upload->data();
        $fname = $image_data['file_name'];
        $fpath = $image_data['file_path'].$fname;
        $fh = fopen($fpath, "r");

        $insert_str = 'INSERT INTO wc_program (JobRef, Area, Parish, AbbrWorkType, WorkType, Timing, TrafficManagement, Location, Duration, Start, Finish) VALUES '."\n";

        if ($fh) {

            // Create each set of values.
            while (($csv_row = fgetcsv($fh, 2000, ',')) !== false) {

                foreach ($csv_row as &$row) {
                    $row = strtr($row, array("'" => "\'", '"' => '\"'));
                }

                $insert_str .= '("'
                    // Implode the array and fix pesky apostrophes.
                    .implode('","', $csv_row)
                    .'"),'."\n";
            }

            // Remove the trailing comma.
            $insert_str = rtrim($insert_str, ",\n");

            // Insert all of the values at once.
            $this->db->set($insert_str);

            echo '<script type="text/javascript">
                        alert("Document successfully uploaded and saved to the database.");
                        location = "program/index";
                </script>';
        } 
        else {
                echo '<script type="text/javascript">
                        alert("Sorry! Something went wrong please proceed to try again.");
                        location = "program/upload";
                </script>';
        } 

    }
} 
```

当我运行 var_dump($fh); 它显示：资源（89）类型（流）

当我运行`var_dump($fpath)`它显示：`string(66) "/Applications/MAMP/htdocs/site/assets/uploads/CSV/wc_program.csv"`

所以这一切都上传了，但它不更新数据库有什么问题？我尝试了各种更改`fopen`方法，但仍然没有乐趣，我真的需要将它添加到数据库中，插入查询和设置查询应该可以解决问题，但它没有。

非常感谢任何帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T20:10:14.280

您没有在数据库上运行任何查询。您将活动记录语法与简单查询语法混合在一起。活动记录插入查询将通过调用来执行。

```
$this->db->insert('my_table'); 
```

`db::set()`实际上并不查询数据库。它接受一个键/值对，该键/值对将在`db::insert()`或被`db::update()`调用之后插入或更新。如果您自己构建查询，则需要使用该`db::query()`函数。

查看[活动目录文档](http://ellislab.com/codeigniter/user-guide/database/active_record.html)。

您可以使用`$this->db->query('put your query here')`，但您失去了 CodeIgniter 内置安全性的好处。查看[CodeIgniter 的查询](http://ellislab.com/codeigniter/user-guide/database/queries.html)函数。

我将为您提供使用 CodeIgniter 插入数据库的多种方法中的几种示例。这些示例将根据您的评论生成查询。您将需要相应地调整您的代码。

**示例 1**：

```
$result = $this->db
    ->set('JobRef', 911847)
    ->set('Area', 'Coastal')
    ->set('Parish', 'Yapton')
    ->set('AbbrWorkType', 'Micro')
    ->set('WorkType', 'Micro-Asphalt Surfacing')
    ->set('Timing', 'TBC')
    ->set('TrafficManagement', 'No Positive Traffic Management')
    ->set('Location', 'Canal Road (added PMI 16/07/12)')
    ->set('Duration', '2 days')
    ->set('Start', '0000-00-00')
    ->set('Finish', '0000-00-00') 
    ->insert('wc_program');

echo $this->db->last_query() . "\n\n";
echo "RESULT: \n\n";
print_r($result); 
```

**示例 2**（使用关联数组）：

```
$row = array(
    'JobRef' => 911847,
    'Area' => 'Coastal',
    'Parish' => 'Yapton',
    'AbbrWorkType' => 'Micro',
    'WorkType' => 'Micro-Asphalt Surfacing',
    'Timing' => 'TBC',
    'TrafficManagement' => 'No Positive Traffic Management',
    'Location' => 'Canal Road (added PMI 16/07/12)',
    'Duration' => '2 days',
    'Start' => '0000-00-00',
    'Finish' => '0000-00-00'
);
$this->db->insert('wc_program', $row);
// This will do the same thing
// $this->db->set($row);
// $this->db->insert('wc_program');
echo $this->db->last_query(); 
```

示例 1 和 2 使用的是 Active Record。信息被一块一块地存储，然后在您进行最终调用时构建查询。这有几个优点。它允许您动态构建查询，而无需担心 SQL 语法和关键字的顺序。它还会转义您的数据。

**示例 3**（简单查询）：

```
$query = 'INSERT INTO 
    wc_program 
        (JobRef, Area, Parish, AbbrWorkType, WorkType, Timing, TrafficManagement, Location, Duration, Start, Finish) 
    VALUES 
        ("911847","Coastal","Yapton","Micro","Micro-Asphalt Surfacing","TBC","No Positive Traffic Management","Canal Road (added PMI 16/07/12)","2 days","0000-00-00","0000-00-00")';
$result = $this->db->query($query);
echo $this->db->last_query() . "\n\n";
echo "RESULT: \n";
print_r($result); 
```

这种方式将所有针对注入的保护留给您，可能导致更多错误，并且更难更改/维护。

如果你打算这样做，你应该使用以下语法，这将防止注入。

**示例 4**：

```
$query = 'INSERT INTO 
    wc_program 
        (JobRef, Area, Parish, AbbrWorkType, WorkType, Timing, TrafficManagement, Location, Duration, Start, Finish) 
    VALUES 
        (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?);';

$row = array(
    911847,
    'Coastal',
    'Yapton',
    'Micro',
    'Micro-Asphalt Surfacing',
    'TBC',
    'No Positive Traffic Management',
    'Canal Road (added PMI 16/07/12)',
    '2 days',
    '0000-00-00',
    '0000-00-00'
);

$result = $this->db->query($query, $row);
echo $this->db->last_query() . "\n\n";
echo "RESULT: \n";
print_r($result); 
```

CodeIgniter 将替换每个“？” 转义后，在查询中使用数组中的相应值。您可以使用它来运行许多具有相同形式但具有不同数据的查询，只需更新`$row`数组并受益于 CI 的内置安全性。

# rdf - 如何在 RDF 中表示 5 元组？

> ID：15820657
> 
> 赞同：3
> 
> 时间：2013-04-04T20:02:34.907
> 
> 标签：rdf

在 RDF 中，我见过类似的例子

```
John | Is a Friend of | James
James | Is a friend of | Jill
Jill | Likes | Snowboarding
Snowboarding | Is a | Sport 
```

但是如果在一个由 5 元组描述的模型中发生了一些事情，称为

```
{Subject, Event, Beneficiary, Time, Place} 
```

例如：

```
"John met Thomas yesterday in garden" 
```

5 元组

```
John - Subject
met - Event
Thomas - Beneficiary
yesterday - Time
in garden - Place 
```

它如何在 RDF 中表示？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-05T10:08:23.610

这是**n 元关系**的一个示例。它们通常借助额外节点在 RDF 中建模，该节点可能是空白节点（但不一定必须如此）。

**W3C** *Semantic Web Best Practices and Deployment Working Group*发表了**一篇[关于 RDF 中的 n-ary 关系的](http://www.w3.org/TR/swbp-n-aryRelations/ "在语义网上定义 N 元关系")**说明。

在 RDF 中表达您的示例的许多方法之一可能看起来像

```
ex:John ex:hasMeeting 
    [ a ex:Meeting;
      ex:beneficiary ex:Thomas;
      ex:date ex:Yesterday;
      ex:place ex:Garden.
    ] . 
```

此解决方案使用一个空白节点（`[]`在海龟语法中缩写为）和命名空间中的虚构个体和属性`ex:`。

# gwt - GWT 中的类#newInstance

> ID：15820658
> 
> 赞同：1
> 
> 时间：2013-04-04T20:02:35.953
> 
> 标签：gwt

我知道 GWT 不模拟这种方法，但我需要提供它的功能的 smth。我尝试了下一种方法：

```
 private static <T extends Widget> T createWidget(Class<T> widgetClass) {
        return GWT.create(widgetClass);
    } 
```

但是当我尝试编译它时，我得到一个错误： **只有类文字可以用作 GWT.create() 的参数**

那么，我怎样才能编写一个可以模拟的上述方法`Class#newInstance`呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T03:56:34.163

`GWT.create()`总是需要类文字作为参数，这意味着你必须传递 this:`GWT.create(MyClass.class)`而没有其他东西。

之所以如此，是因为 gwt 编译器必须在编译时决定要选择哪个类，请注意，在您的代码中，该类是在运行时传递的。

如果您打算使用`GWT.create`减少且众所周知的类集，则可以执行以下操作：

```
private static <T extends Widget> T createWidget(Class<T> widgetClass) {
    if (ClassA.class.equals(widgetClass))  {
       return GWT.create(ClassA.class);
    } else if (ClassA.class.equals(widgetClass))  {
       return GWT.create(ClassB.class);
    }
    return null;
} 
```

# mysql - 按优先级排序，不按字母顺序

> ID：15820660
> 
> 赞同：4
> 
> 时间：2013-04-04T20:02:39.670
> 
> 标签：mysql, sql-order-by

我正在尝试按`ticket_priority_id`.

ID 被分类为`ASAP`, `HIGH`, `MED`, `LOW`。

当我按它订购时，`ticket_priority_id`它总是按字母顺序排列（`LOW`在前面`MED`）。

我怎样才能做到这一点，以便我可以按顺序`ticket_priority_id`但不是按字母顺序而是按重要性排序。我要订单（从上到下）`ASAP`- `HIGH`- `MED`-`LOW`

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-04T20:05:50.000

您可以像这样在您的订单中使用 case 语句

```
ORDER BY 
   CASE WHEN ticket_priority_id = 'ASAP' THEN 1
        WHEN ticket_priority_id = 'HIGH' THEN 2
        WHEN ticket_priority_id = 'MED' THEN 3
        WHEN ticket_priority_id = 'LOW' THEN 4
        ELSE 5
   END 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-04T20:12:11.360

您可以使用[FIELD](http://dev.mysql.com/doc/refman/5.0/en/string-functions.html#function_field)功能：

```
ORDER BY
  FIELD(ticket_priority_id, 'ASAP', 'HIGH', 'MED', 'LOW') 
```

请注意，如果`ticket_priority_id`以下列表中不存在，它将返回 0，因此您可能还需要添加：

```
ORDER BY
  ticket_priority_id NOT IN ('ASAP', 'HIGH', 'MED', 'LOW'),
  FIELD(ticket_priority_id, 'ASAP', 'HIGH', 'MED', 'LOW') 
```

将没有优先级的行放在底部而不是顶部。

# java - 应用程序在上传超过 300M 的文件时崩溃

> ID：15820661
> 
> 赞同：0
> 
> 时间：2013-04-04T20:02:48.867
> 
> 标签：java, android

当我选择 400M 文件上传时，我的应用程序崩溃了，小于 300M 的上传正常

我改变了这个

```
int maxBufferSize =  10 * 10241 * 1024; 
```

到

```
int maxBufferSize =   10241 * 1024; 
```

还是一样的问题

我错过了什么吗？

```
protected String doInBackground(String... urls) {

    String upLoadServerUri = upApi.uploadUrl;
    String fileName = this.file_path;
    HttpURLConnection connection = null;
    DataOutputStream outputStream = null;
    String lineEnd = "\r\n";
    String twoHyphens = "--";
    String boundary = "*****";
    int bytesRead, bytesAvailable, bufferSize;
    byte[] buffer;
    int maxBufferSize =  10 * 10241 * 1024;
    File sourceFile = new File(fileName);
    int sentBytes = 0;
    long fileSize = sourceFile.length();

    try
    {
        FileInputStream fileInputStream = new FileInputStream(new File(fileName));

        URL url = new URL(upLoadServerUri);
        connection = (HttpURLConnection) url.openConnection();

        // Allow Inputs & Outputs
        connection.setDoInput(true);
        connection.setDoOutput(true);
        connection.setUseCaches(false);
        connection.setChunkedStreamingMode(1024);
        // Enable POST method
        connection.setRequestMethod("POST");

        connection.setRequestProperty("Connection", "Keep-Alive");
        connection.setRequestProperty("Content-Type",     "multipart/form-data;boundary="+boundary);

        outputStream = new DataOutputStream(     connection.getOutputStream() );
        outputStream.writeBytes(twoHyphens + boundary + lineEnd);
        outputStream.writeBytes("Content-Disposition: form-data; name=\"file[]\";filename=\""+ fileName + "\"" + lineEnd);
        outputStream.writeBytes(lineEnd);

        buffer = new byte[maxBufferSize];

        while (true)
        {
            int bytesToRead = Math.min(maxBufferSize, fileInputStream.available());

            // Break if complete
            if(bytesToRead == 0){ break; }

            // Read bytes
            bytesRead = fileInputStream.read(buffer, 0, bytesToRead);

            // Write bytes
            outputStream.write(buffer, 0, bytesRead);

            // Update progress dialog
            sentBytes += bytesRead;

            // Publish progress
            double progress = (double)sentBytes / fileSize;
            publishProgress((int)progress);
        } 
```

* * *

```
04-04 23:11:24.664: E/OMX-VDEC-1080P(217): ION: alloc_data: handle(0xE4904BC0), len(368640), align(8192), flags(0x2000100), fd_data: handle(0xe4904bc0), fd(0x46)
04-04 23:11:24.664: E/OMX-VDEC-1080P(217): Allocate done for all i/p buffers
04-04 23:11:24.664: E/OMX-VDEC-1080P(217): Allocate done for all o/p buffers
04-04 23:11:24.664: E/OMX-VDEC-1080P(217): OMX_CommandStateSet complete, m_state = 2
04-04 23:11:24.664: E/OMX-VDEC-1080P(217): send_command: Recieved a Command from Client
04-04 23:11:24.664: E/OMX-VDEC-1080P(217): send_command_proxy(): cmd = 0, Current State 2, Expected State 3
04-04 23:11:24.664: E/OMX-VDEC-1080P(217): send_command_proxy(): OMX_CommandStateSet issued
04-04 23:11:24.664: E/OMX-VDEC-1080P(217): Current State 2, Expected State 3
04-04 23:11:24.664: E/OMX-VDEC-1080P(217): send_command_proxy(): Idle-->Executing
04-04 23:11:24.664: E/OMX-VDEC-1080P(217): send_command: Command Processed
04-04 23:11:24.664: E/OMX-VDEC-1080P(217): Rxd OMX_COMPONENT_GENERATE_START_DONE
04-04 23:11:24.664: E/OMX-VDEC-1080P(217): Rxd i/p EOS, Notify Driver that EOS has been reached
04-04 23:11:24.694: E/OMX-VDEC-1080P(217): Output EOS has been reached
04-04 23:11:24.694: E/OMX-VDEC-1080P(217): Rxd OMX_COMPONENT_GENERATE_EOS_DONE
04-04 23:11:24.704: E/OMX-VDEC-1080P(217): send_command: Recieved a Command from Client
04-04 23:11:24.704: E/OMX-VDEC-1080P(217): send_command_proxy(): cmd = 0, Current State 3, Expected State 2
04-04 23:11:24.704: E/OMX-VDEC-1080P(217): send_command_proxy(): OMX_CommandStateSet issued
04-04 23:11:24.704: E/OMX-VDEC-1080P(217): Current State 3, Expected State 2
04-04 23:11:24.704: E/OMX-VDEC-1080P(217): Command Recieved in OMX_StateExecuting
04-04 23:11:24.704: E/OMX-VDEC-1080P(217): send_command_proxy(): Executing --> Idle
04-04 23:11:24.704: E/OMX-VDEC-1080P(217): Driver flush i/p Port complete
04-04 23:11:24.704: E/OMX-VDEC-1080P(217): Initiate Input Flush
04-04 23:11:24.704: E/OMX-VDEC-1080P(217): Reset all the variables before flusing
04-04 23:11:24.704: E/OMX-VDEC-1080P(217): Initialize parser
04-04 23:11:24.704: E/OMX-VDEC-1080P(217): OMX flush i/p Port complete PenBuf(0)
04-04 23:11:24.704: E/OMX-VDEC-1080P(217): Driver flush o/p Port complete
04-04 23:11:24.704: E/OMX-VDEC-1080P(217): Initiate Output Flush
04-04 23:11:24.704: E/OMX-VDEC-1080P(217): OMX flush o/p Port complete PenBuf(0)
04-04 23:11:24.704: E/OMX-VDEC-1080P(217): Rxd OMX_COMPONENT_GENERATE_STOP_DONE
04-04 23:11:24.704: E/OMX-VDEC-1080P(217): send_command: Command Processed
04-04 23:11:24.704: E/OMX-VDEC-1080P(217): send_command: Recieved a Command from Client
04-04 23:11:24.704: E/OMX-VDEC-1080P(217): send_command_proxy(): cmd = 0, Current State 2, Expected State 1
04-04 23:11:24.704: E/OMX-VDEC-1080P(217): send_command_proxy(): OMX_CommandStateSet issued
04-04 23:11:24.704: E/OMX-VDEC-1080P(217): Current State 2, Expected State 1
04-04 23:11:24.704: E/OMX-VDEC-1080P(217): send_command_proxy(): Idle-->Loaded-Pending
04-04 23:11:24.704: E/OMX-VDEC-1080P(217): send_command: Command Processed
04-04 23:11:24.704: E/OMX-VDEC-1080P(217): ION: free: handle(0xEB8C3D00), len(2097152), fd(0x41)
04-04 23:11:24.704: E/OMXNodeInstance(217): OMX_FreeBuffer for buffer header 0x43f34670 successful
04-04 23:11:24.704: E/OMX-VDEC-1080P(217): ION: free: handle(0xDCAB0D00), len(2097152), fd(0x3f)
04-04 23:11:24.704: E/OMX-VDEC-1080P(217): ALL input buffers are freed/released
04-04 23:11:24.704: E/OMXNodeInstance(217): OMX_FreeBuffer for buffer header 0x43f34620 successful
04-04 23:11:24.704: E/OMX-VDEC-1080P(217): ION: free: handle(0xE4904BC0), len(368640), fd(0x46)
04-04 23:11:24.704: E/OMX-VDEC-1080P(217): ION: free: handle(0xD31AE040), len(73728), fd(0x44)
04-04 23:11:24.784: E/OMX-VDEC-1080P(217): ALL output buffers are freed/released
04-04 23:11:24.784: E/OMXNodeInstance(217): OMX_FreeBuffer for buffer header 0x43f348f8 successful
04-04 23:11:24.784: E/OMX-VDEC-1080P(217): OMX_CommandStateSet complete, m_state = 1
04-04 23:11:24.784: E/OMX-VDEC-1080P(217): Playback Ended - PASSED
04-04 23:11:24.784: E/OMX-VDEC-1080P(217): ALL output buffers are freed/released
04-04 23:11:24.784: E/OMX-VDEC-1080P(217):  Error in ioctl read next msg
04-04 23:11:24.784: E/OMX-VDEC-1080P(217): omx_vdec: Async thread stop
04-04 23:11:24.784: E/OMX-VDEC-1080P(217): Close the driver instance
04-04 23:11:24.804: E/OMX-VDEC-1080P(217): omx_vdec::component_deinit() complete
04-04 23:11:24.804: E/OMX-VDEC-1080P(217): In OMX vdec Destructor
04-04 23:11:24.804: E/OMX-VDEC-1080P(217): omx_vdec: message thread stop
04-04 23:11:24.804: E/OMX-VDEC-1080P(217): Waiting on OMX Msg Thread exit
04-04 23:11:24.804: E/OMX-VDEC-1080P(217): Waiting on OMX Async Thread exit
04-04 23:11:24.804: E/OMX-VDEC-1080P(217): Exit OMX vdec Destructor 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-04T20:23:13.527

您正在尝试分配过大的缓冲区 ( `10 * 10241 * 1024 = 104867840 bytes`)。偶数`10241 * 1024`太大 ( `10486784 bytes`)。尝试将其减小到`1024 * 1024`( `1048576`) 或更小；值得怀疑的是，您能否通过网络连接以足够快的速度传输它，无论如何都需要这么大的缓冲区。

# lucene - 在 Lucene 中索引 POJO

> ID：15820663
> 
> 赞同：2
> 
> 时间：2013-04-04T20:02:51.527
> 
> 标签：lucene, eclipselink, pojo

有没有一个很好的例子来说明如何在 Lucene 中为 POJO 建立索引——就像 JIRA 对问题所做的一样？

例如，如果你有类似的东西

```
class Book {
  private String author;
  private String title;
} 
```

我希望在 Lucene 中对作者和标题字段的文本进行索引，以便我可以搜索它们。

我知道这是可能的，但还没有找到一个很好的简洁示例如何做到这一点。

我使用的是 EclipseLink，而不是 Hibernate，所以 Hibernate Search 不是一个选项。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T20:43:56.830

**1）案例1：**

如果可以通过 getter 公开 POJO 的所有要索引的内部属性。

```
public interface Indexable{}

class Book implements Indexable{}

public interface POJOToLuceneDocumentConverter{    
      Document convert(Indexable obj);    
}

public class BookToLuceneDocumentConverter{
    public Document convert(Indexable obj){
    // build the Lucene document.
 }
} 
```

**2）案例2：**

如果您被限制不能通过 getter 公开所有要索引的数据。

a) 为要索引的每个 POJO 创建一个内部类。

b) 在该内部类中有一个从父类读取属性的方法

c) 构建 Lucene 文档并返回。

上述方法很幼稚。如果您正在寻找高级、基于框架、自动化等的东西，我不确定..

# excel - 如果不匹配，则将行从 excel 工作表复制到另一个

> ID：15820664
> 
> 赞同：0
> 
> 时间：2013-04-04T20:02:55.413
> 
> 标签：excel, vba

我有一个从 SharePoint 列表填充的 Excel 工作表（“所有文档”），但也有一些包含公式的列。我在同一个工作簿（“原始”）中有另一个工作表，其中包含列表项的原始值。我需要比较两个工作表，如果“所有文档”中的 A 列中的值在“原始”的 A 列中不存在，则需要将该行复制到“原始”工作表中。它必须作为值粘贴。我搜索了许多论坛并尝试了许多建议，但都没有奏效。这是我最近的尝试。任何帮助将不胜感激！

```
Dim x As Long, y As Long, a As Long
Dim b As String
Dim rFound As Range
Dim TargetRange As Range
x = Worksheets("All Documents").Range("A" & Rows.Count).End(xlUp).Row
For a = 2 To x
    y = Worksheets("Original").Range("A" & Rows.Count).End(xlUp).Row
    b = Worksheets("All Documents").Range("A" & a)
    If a > y Then Exit For
    With Worksheets("Original").Range("A:A")
        Set rFound = .Find(b, LookIn:=xlValues)
        If rFound Is Nothing Then
           TargetRange = Worksheets("Original"1).Cells(Worksheets("Original").Rows(y + 1))
           Worksheets("All Documents").Rows(a).Copy
           TargetRange.PasteSpecial xlPasteValues
        End If
    End With
Next a 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T10:53:50.850

三件事，

1.  要设置范围，您需要：

    ```
    Set TargetRange = Worksheets("Original").Rows(y + 1) 
    ```

2.  检查工作表是否已`"Original"1`更换`"Original"`

3.  并通过以下方式改进复制您的价值观：

    ```
    Worksheets("Original").Rows(y + 1).Value = _
      Worksheets("All Documents").Rows(a).Value 
    ```

# sql-server - 位默认值设置为 ((0)) 但在设计视图中查看显示 dbo.tablename_columnname_D

> ID：15820674
> 
> 赞同：0
> 
> 时间：2013-04-04T20:03:46.883
> 
> 标签：sql-server, sql-server-2008, sql-server-2008-r2

只是想知道为什么它在 SQL2008R2 上这样做，可能在早期的。我假设 SQL 正在命名默认值，但为什么它不只是将其保留为 0？我注意到如果我将脚本设置为创建它，它会在脚本中设置默认值，如果它是 ((0))，但不是当它是 dbo.tablename_columnname_D 时。可能与拥有多个具有相同表和结构的数据库有关吗？

# ios - TableView 和 PKRevealController 手势冲突 - 如何真正解决它们？

> ID：15820684
> 
> 赞同：1
> 
> 时间：2013-04-04T20:04:20.153
> 
> 标签：ios, xcode, uitableview, ios6, slidingmenu

我正在尝试使用滑动侧菜单实现视图，例如 iOS 6.1 中的[PKRevealController](https://github.com/pkluz/PKRevealController)。 [在 github 上使用源代码对这个问题进行了简单的演示](https://github.com/wpostma/PKRevealControllerWP)，但是如果您已经了解了 gestureRecognizer 委托实现，则可能不需要获取它。

我看到的问题是我的用户想要使用的两个手势会相互混淆。应用程序中心（主屏幕）中的 UITableView 应该能够使用向右滑动手势删除，但我仍然希望在顶部导航区域发生滑动以暴露侧边菜单。我也打算显示除表格视图之外的其他内容，并且在运行时，每当用户在其中一个侧面菜单上选择一个按钮时，我计划将主视图换成不同的视图。这有点像我要使用的“隐藏侧托盘 UITabBarController”，但我希望仅当主“前视图”控制器不是 UITableView 或其子视图时才显示侧栏。

目前，使用PKRevealController自带的demo源码，并在主视图的UITableView中加入删除支持，已经无法通过滑动手势删除一行。（您必须添加一种表格视图方法才能在 UITable 视图中启用删除支持，我确实添加了。）

[这是在这里](https://stackoverflow.com/questions/14337753/conflicting-gesture-recognizers-on-uitableview)被问到的，但是所陈述的答案是不完整的，如下所示，对我不起作用，我不知道为什么，因为似乎在我返回 YES 的任何时候都没有调用这个委托方法，但是无论如何它都会继续并开始一个手势。 **更新**与我在下面放置的 WIKI/FAQ 答案相比，上一个问题中的答案也是错误的。

我只通过添加以下内容修改了 PKRevealController.m 类：

```
- (BOOL)                             gestureRecognizer:(UIGestureRecognizer *)gestureRecognizer shouldRecognizeSimultaneouslyWithGestureRecognizer:(UIGestureRecognizer *)otherGestureRecognizer {

    UIView *view1 = otherGestureRecognizer.view;
    UIView *view2;
    if (view1) {
         view2 = view1.superview;
    };

    if ([gestureRecognizer.view isKindOfClass:[UITableView class]])
    {
        return NO;
    }
    // Co-operate by not stealing gestures from UITableView.
    if ([view1 isKindOfClass:[UITableView class]]) {
        return NO;
    }else if ([view1 isKindOfClass:[UITableViewCell class]]) {
        return NO;
        // UITableViewCellContentView
    }
    else if (view2 && [view2 isKindOfClass:[UITableViewCell class]]) {
        return NO;
        // UITableViewCellContentView
    }
    else
    {
        return YES;    // NEVER GETS HIT. BREAKPOINT HERE!
    }
} 
```

让我感到困惑的是，上面的返回 YES 代码在任何时候都没有被命中（我有一个断点），然而，手势控制器仍在窃取手势。

注意：我做了一个邪恶的黑客攻击，但我认为我可以干净地阻止这种情况。这是我的邪恶黑客：

```
- (BOOL)gestureRecognizerShouldBegin:(UIGestureRecognizer *)gestureRecognizer
{
    if (gestureRecognizer == self.revealPanGestureRecognizer)
    {
        CGPoint translation = [self.revealPanGestureRecognizer translationInView:self.frontViewContainer];
        BOOL begin = (fabs(translation.x) >= fabs(translation.y));

        // BEGIN EVIL HACK
        if (_topLimitY > 0) {
         CGPoint location = [gestureRecognizer locationInView:gestureRecognizer.view];
         if (location.y>_topLimitY) // _topLimitY = 55 for instance.
            begin = NO;
        }
        // END EVIL HACK.

        return begin;
    }
    else if (gestureRecognizer == self.revealResetTapGestureRecognizer)
    {
        return ([self isLeftViewVisible] || [self isRightViewVisible]);
    } 

    return YES;
} 
```

现在，在我的恶意黑客演示中，我将 topLimitY 属性（我添加到 PKRevealController 的属性中）设置为 55，这允许我在前视图的导航栏区域上滑动，但不能在占据演示的其余部分。

请注意，我计划有多个主视图，并且如果视图是 UITableView 或其某些子视图，则只想在整个主区域上击败手势识别。这就是为什么我将我的 hack 称为 hack 之上的原因。因为我认为你可以告诉手势识别器离开而不打扰你，但它不起作用，它甚至没有调用 shouldRecognize 方法，它只是继续执行其列表中的下一个事情做。

![在此处输入图像描述](https://i.stack.imgur.com/euXND.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-05T14:09:11.670

我真的应该先阅读WIKI，不是吗？

这是一个常见问题解答，它[在这里](https://github.com/pkluz/PKRevealController/wiki/How-To%3a-Help!-The-PKRevealController-interferes-with-my-UITableView-cell-swipes)说：

实例化控制器时，在您的选项字典中传递此选项：

```
 NSDictionary *options = @{
      PKRevealControllerRecognizesPanningOnFrontViewKey : @NO
  }; 
```

这将禁用整个前视图的基于平移的显示。现在，您可以使用revealPanGestureRecognizer 并将其添加到您希望在不干扰表格视图的情况下平移的任何视图中，以启用基于手势的显示。我建议（如果使用带有可滑动单元格的基于表格的环境）您，将revealPanGestureRecognizer 添加到您的前视图控制器的导航栏（它很可能有）：

```
 [self.navigationController.navigationBar addGestureRecognizer:self.revealController.revealPanGestureRecognizer]; 
```

瞧——平移不再干扰您的表格视图。

更多信息： [https ://github.com/pkluz/PKRevealController/issues/76](https://github.com/pkluz/PKRevealController/issues/76)

谢谢维基。要是我先读完就好了。

以上完全回答了我的问题，并且已经在 wiki 上。我正在回答我自己的问题，因为 Google 似乎总是首先使用 Stackoverflow，这可能会在未来帮助其他困惑的开发人员。

**更新**如果上面的事情在你尝试的时候爆炸了，那可能是太早了。这是上述修复的一个更强大的版本：

```
// Additional gesture recognition linkups. The underscore variables here
// are implementation-section ivars in my app-delegate,  that I have already 
// checked are valid and initialized, and this is the last thing in my app delegate
// didFinishLaunch... method, before the return YES:

UIGestureRecognizer *rec = _revealController.revealPanGestureRecognizer;
if (rec) {
    [_frontViewNavController.navigationBar addGestureRecognizer:rec];
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-06-07T09:49:44.707

用这个 ：

```
self.revealController.frontViewController.revealController.recognizesPanningOnFrontView = YES; 
```

# java - JQuery 数据表仅在本地计算机上的 Chrome 上加载数据

> ID：15820685
> 
> 赞同：0
> 
> 时间：2013-04-04T20:04:22.297
> 
> 标签：java, jquery, jsp, servlets, datatable

我正在使用 JQuery 数据表来填充 Java Web 应用程序。所有的 html 都是通过 JSP 页面呈现的，数据本身来自页面加载时 javascript 触发的 Servlet。

当我在 Tomcat 上部署 Web 应用程序并在我的计算机上的 Chrome 上运行它时，数据加载正常。但是，当我在计算机上的 Firefox 上运行 Web 应用程序时，数据不会加载。从 Internet Explorer 和 Opera 中也看到了类似的场景。

我也连接到 LAN，从第二台计算机访问 Chrome 上的网络应用程序不会加载我的数据。似乎我的数据仅在我在计算机的 Chrome 上运行网络应用程序时才加载。

这是数据表初始化的代码片段：

```
<script type="text/javascript">
        $(document).ready(function(){
            oTable = $("#datatables").dataTable({
                        "aoColumns" : [
                            {
                                "sName" : "fullName"
                            },

                        "sAjaxSource" : 'checklistdataallteam',
                        "sServerMethod": "GET",
                        "fnDrawCallback" : function(oSettings) {
                            //The call to makeEditable is set here to make sure all the data are loaded 
                            this.makeEditable({
                                oEditableSettings: { event: 'click' },
                                sUpdateURL : 'UpdateChecklistData',
                                aoColumns : [
                                     {} //patient name; default editing                                         
                            });
                       });

 </script> 
```

servlet 'checklistdataallteam' 连接到 mysql 数据库，获取数据，转换为 JSON 格式并填充数据表。

解决方案是什么？

# email - 当通过任何 ftp 客户端上传文件时，如何在 IIS 6.0 Web 服务器中设置电子邮件通知警报？

> ID：15820686
> 
> 赞同：0
> 
> 时间：2013-04-04T20:04:26.520
> 
> 标签：email, iis, vbscript, ftp

当通过任何 FTP 客户端上传文件时，我正在尝试在 IIS 6 中设置电子邮件通知警报。有谁知道如何做到这一点？

我发现了类似的东西，但不明白如何实现它： [http ://forums.iis.net/t/1196793.aspx/1?How+to+add+email+notification+service+in+IIS+6+ 0+当+a+文件+是+上传+通过+FTP+](http://forums.iis.net/t/1196793.aspx/1?How+to+add+email+notification+service+in+IIS+6+0+when+a+file+is+uploaded+via+FTP+)

有人对此有任何见解吗？

```
function countFolders(strPath)
   dim objShell
   dim objFolder
   dim folderCount

   set objShell = CreateObject("shell.application")
   set objFolder = objShell.NameSpace(strPath)

   if (not objFolder is nothing) then
      dim objFolderItems

      set objFolderItems = objFolder.Items

      if (not objFolderItems Is Nothing) then
         folderCount=objFolderItems.Count
      end if

      set objFolderItem = nothing
   end if

   set objFolder = nothing
   set objShell = nothing

   countFolders=folderCount
end function 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T07:59:13.890

您引用的帖子基本上表明了这一点：

1.  创建一个检查文件夹（或文件夹）中文件数量的脚本（如您所见）。
2.  创建运行总数的文件。也许将此值保存到数据库或另一个 txt 文件中。
3.  如果文件数与上次运行检查时不同，则发送电子邮件。

它建议使用计划任务。这意味着仅在执行脚本时才在更新 FTP 时发送电子邮件。[Windows 任务](http://windows.microsoft.com/en-GB/windows7/schedule-a-task)的好处是您可以随意运行它。因此，假设您不需要立即通知，您可以将脚本设置为每分钟运行一次、每 10 分钟运行一次或类似。

上面的问题是，如果人们也在删除文件，您可能会收到错过的通知。EG 假设您不想在删除文件时收到通知，这意味着如果我当前的文件计数为 10、3 和删除并添加 1，这意味着下次运行脚本时我有 8 个文件。无法知道文件已被删除/重新添加。在这种情况下，您要注意文件名和路径，记下它们，以便将现有路径与以前的路径进行比较！

我刚刚完成了一个非常相似的任务，但我有额外的奢侈。我编写了 FTP 客户端，它必须安装在所有客户端机器上才能将文件发送到我的 FTP。这意味着，在我的 FTP 程序中，我有一段额外的代码：*OnUploadCompleted -> Send Notofication Email*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T08:11:58.777

您可以创建一个使用[FileSystemWatcher](http://msdn.microsoft.com/en-us/library/x7t1d0ky.aspx)的服务。

FileSystemWatcher 侦听文件系统更改通知。在提供的链接中是如何使用该类的一个很好的例子。

# android - Android WebView 和 CSS 媒体查询

> ID：15820687
> 
> 赞同：7
> 
> 时间：2013-04-04T20:04:30.300
> 
> 标签：android, css, webview

我有一个基本网页，当在 Android 平板电脑（Nexus 7）上的 Chrome 中显示时，它可以正确响应屏幕尺寸和方向的变化（使用 CSS 媒体查询）。当我在 WebView 中显示同一页面时，基于屏幕宽度的媒体查询不起作用。这是我设置 WebView 的方式：

```
WebView webView = (WebView) findViewById(R.id.webView);
webView.getSettings().setJavaScriptEnabled(true);
webView.getSettings().setLoadWithOverviewMode(true);
webView.getSettings().setUseWideViewPort(true);
webView.loadUrl("http://10.0.1.8:8080/cbc/test"); 
```

WebView 根据以下媒体查询的行为正确检测方向变化：

```
@media only screen and (orientation: portrait) {
    .landscape { display: none; }
}

@media only screen and (orientation: landscape) {
    .portrait { display: none; }
} 
```

使用屏幕尺寸的媒体查询无法正常工作，因为根据以下 JavaScript，屏幕宽度和高度在方向更改时保持不变：

```
 $("#dimensions").empty();
    $("#dimensions").append($("<div>Width: " + screen.width + "</div>"));
    $("#dimensions").append($("<div>Height: " + screen.height + "</div>"));
    $("#dimensions").append($("<div>Depth: " + screen.pixelDepth + "</div>")); 
```

我用“orientationchange”事件触发了前面的代码。在 Android 上的 Chrome 中运行时，宽度和高度值会正确显示，并考虑设备方向。在 WebView 内运行时，无论方向如何，宽度和高度都保持不变。

是否需要对 WebView 应用一些配置才能获得预期的行为？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-22T15:42:18.387

尝试在您的 javascript 中查看`window.innerWidth`& 。`window.innerHeight`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-07-24T21:23:53.207

加载 HTML 后（屏幕更改或任何更改后），您需要 WebView CONTENTS 的宽度和高度。是的，但是没有**getContentWidth**方法（只有一个视口值），并且**getContentHeight** () 不准确！

答：子类WebView：

```
/*
  Jon Goodwin
*/
package com.example.html2pdf;//your package

import android.content.Context;
import android.util.AttributeSet;
import android.webkit.WebView;

class CustomWebView extends WebView
{
    public int rawContentWidth   = 0;                         //unneeded
    public int rawContentHeight  = 0;                         //unneeded
    Context    mContext          = null;                      //unneeded

    public CustomWebView(Context context)                     //unused constructor
    {
        super(context);
        mContext = this.getContext();
    }   

    public CustomWebView(Context context, AttributeSet attrs) //inflate constructor
    {
        super(context,attrs);
        mContext = context;
    }

    public int getContentWidth()
    {
        int ret = super.computeHorizontalScrollRange();//working after load of page
        rawContentWidth = ret;
        return ret;
    }

    public int getContentHeight()
    {
        int ret = super.computeVerticalScrollRange(); //working after load of page
        rawContentHeight = ret;
        return ret;
    }
//=========
}//class
//========= 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-04-04T20:09:28.757

对于现代屏幕，您需要指定像素比率。CSS 术语中的像素是测量值，而不是实际像素。由于高分辨率屏幕和视网膜显示，像素大小不同。制造商尝试根据像素作为大小进行显示，但它不适用于媒体查询。您需要像这样进行媒体查询：

```
@media
  only screen and (-webkit-min-device-pixel-ratio: 2),
  only screen and (   min--moz-device-pixel-ratio: 2),
  only screen and (     -o-min-device-pixel-ratio: 2/1) { 
      //CSS here
} 
```

# extjs - 在 Extjs4 中检查 checkcolumn 时更改网格行的样式

> ID：15820694
> 
> 赞同：2
> 
> 时间：2013-04-04T20:05:05.013
> 
> 标签：extjs, extjs4, extjs4.1

我有一个带有校验列的网格。我希望能够更改选中该行上给定行复选框的样式。

现在我有这个：

```
listeners: {
    checkchange: function (checkcolumn, rowIndex, checked) {
        if (checked) {
        }
    }
} 
```

但是我不知道在条件中放什么，这会给我一个对象，它有一个方法可以让我改变风格。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-04T20:15:40.957

覆盖[getRowClass](http://docs.sencha.com/ext-js/4-0/#!/api/Ext.view.Table-method-getRowClass "获取行类")方法。当复选框更改时，该行将在 DOM 中更新，这将触发此方法。

# eclipse - 从 SVN repo 调用依赖文件

> ID：15820698
> 
> 赞同：0
> 
> 时间：2013-04-04T20:05:19.340
> 
> 标签：eclipse, selenium

根据我的要求，我需要在 eclipse 中使用来自 SVN 存储库的 jlibs 和 SauceRest 依赖项。现在我在 SVN 存储库中提交了 jlibs 和 SauceRest。

现在任何人都可以指导我如何从我的 Pom.xml 文件中调用这些依赖项以及如何将它们导入到我的项目中。

任何人都可以分享示例代码来实现这一点吗？？？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T20:14:27.540

检查整个项目有什么问题。在您的计算机终端中，发出

`co http://yourprojecturl/yourpojectname localnameforyourpoject`.

完成后，您可以在 Eclipse 中导入项目。如果你觉得这太多了，你可以使用 Eclipse 的 SVN 插件。[SubEclipse](http://subclipse.tigris.org/)就是其中之一，还有更多。

# c - 在 openssl 中生成 16 位哈希值的最佳加密哈希函数是什么？

> ID：15820699
> 
> 赞同：2
> 
> 时间：2013-04-04T20:05:24.950
> 
> 标签：c, openssl, sha, sha256, cryptographic-hash-function

我想只使用 SHA256，然后只使用结果的前两个字节。这种方法有什么问题吗？

注意：这里关注的不是恶意攻击，而是确保对随机位翻转提供最佳保护。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T20:40:23.883

任何满足[严格雪崩标准](http://en.wikipedia.org/wiki/Avalanche_effect#Strict_avalanche_criterion)的哈希（即，如果输入中的任何位被翻转，输出中的每个位都将以 50% 的概率被翻转）可以以这种方式使用，并且包括每个加密哈希常用，包括 SHA512。使用非常短的散列存在安全隐患，但如果它们真的不相关，正如您所声称的，您可以自由选择可用的最快散列（可能是 MD5）。

但是，由于短散列特别容易受到生日悖论的影响，因此无论如何都要考虑使用更长的散列。如果您生成的哈希值如此之多，以至于 16 位与 256 位比较重要，那么即使没有恶意攻击者，您*也会*遇到重复。

# android - 刷新 ImageView

> ID：15820700
> 
> 赞同：0
> 
> 时间：2013-04-04T20:05:27.077
> 
> 标签：android, imageview, batterylevel

我想创建一个在 textView 中提供电池状态 (%) 的 android 应用程序。我还有一个 ImageView，其中包含我想根据电池状态的值更改的图像。（我有不同的电池图像对应于不同的充电水平）。

我已经可以在 textView 中打印电池状态，但我不知道如何更改 Image View 中的图像。这是我的主要片段：

```
public class Battery extends Fragment{ 

private TextView contentTxt;
private ImageView battery; 
int level;
int scale;
int test;

public View onCreateView(LayoutInflater inflater, ViewGroup container,
           Bundle savedInstanceState) {
          View myFragmentView = inflater.inflate(R.layout.fragment_a, container, false);
          contentTxt=(TextView) myFragmentView.findViewById(R.id.monospaceTxt);

          getActivity().registerReceiver(this.mBatInfoReceiver, new IntentFilter(Intent.ACTION_BATTERY_CHANGED));
          return myFragmentView;

        }

private BroadcastReceiver mBatInfoReceiver = new BroadcastReceiver(){
    @Override
    public void onReceive(Context context, Intent intent) {
            // TODO Auto-generated method stub
            int level = intent.getIntExtra("level", 0);
            int scale = intent.getIntExtra("scale", 100);
            contentTxt.setText(String.valueOf(level * 100 / scale) + "%");

        }
};

} 
```

BatteryService 源：

```
public class BatteryService extends Service {
    private int APP_ID = 10000;
    private int currentPercent = 0;
    private Intent intentFrom;
    public static boolean isRunning;

    private BroadcastReceiver mBatInfoReceiver = new BroadcastReceiver(){
            @Override
            public void onReceive(Context context, Intent intent) {
                    // TODO Auto-generated method stub
                    int level = intent.getIntExtra("level", 0);
        int scale = intent.getIntExtra("scale", 100);
        Log.d("BATTERY_STAT", intent.getClass().getName());

        currentPercent = level * 100 / scale;
                    //Notification notification = new Notification(R.drawable.icon,
                            //context.getResources().getString(R.string.your_battery_status), System.currentTimeMillis());
                   // notification.number = currentPercent;
                   // notification.flags = Notification.FLAG_NO_CLEAR; 

                   // Intent contentIntent = new Intent(context,Main.class);          
                   // notification.setLatestEventInfo(context,
                                  //  context.getResources().getString(R.string.battery_status) + " " + String.valueOf(notification.number) + "%",
                                  //  context.getResources().getString(R.string.your_battery_status),
                      //  PendingIntent.getActivity(context, 0, contentIntent,Intent.FLAG_ACTIVITY_NEW_TASK));

                  //  mManager.notify(APP_ID , notification);

            }
    };
    private NotificationManager mManager;

    @Override
    public IBinder onBind(Intent intent) {
            // TODO Auto-generated method stub
            return null;
    }

    @Override
    public void onCreate() {
            // TODO Auto-generated method stub
            super.onCreate();
            Log.d("BATTERY_STAT", "battery service onCreate");
            BatteryService.isRunning = true;
            mManager = (NotificationManager) getSystemService(Context.NOTIFICATION_SERVICE);
        this.registerReceiver(this.mBatInfoReceiver, new IntentFilter(Intent.ACTION_BATTERY_CHANGED));
    }

    @Override
    public void onDestroy() {
            // TODO Auto-generated method stub
            this.unregisterReceiver(this.mBatInfoReceiver);
            BatteryService.isRunning = false;
            removeServiceNotification();
            super.onDestroy();

    }

    @Override
    public void onStart(Intent intent, int startId) {
            // TODO Auto-generated method stub
            intentFrom = intent;
            super.onStart(intent, startId);
    }

    private int getPercentBatt(){
            return currentPercent;
    }

    private final IBattery.Stub binder=new IBattery.Stub() {
               public int getPercent() {
                 return(getPercentBatt());
               }
               public void stopNotification(){
                       removeServiceNotification();
               }
    };

    public  void removeServiceNotification(){
            mManager.cancel(APP_ID);
    }

} 
```

和我的 xml 文件：

```
LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:orientation="vertical"
android:background="@drawable/fond_correct" >

<TextView
    android:id="@+id/textView1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="  Battery Status"
    android:textAppearance="?android:attr/textAppearanceLarge"
    android:layout_marginTop="80px"
    android:layout_marginLeft="10px"
    android:layout_gravity="center"
    android:textStyle="bold"
    android:textSize="30sp"

     />

<TextView
    android:id="@+id/monospaceTxt"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="100%"
    android:textSize="50px"
    android:typeface="monospace"
    android:layout_gravity="center_horizontal"
    android:layout_marginTop="35px" />

<ImageView
    android:id="@+id/battery"
   android:layout_width="match_parent"
   android:layout_height="match_parent"
   android:scaleType="center"
   android:src="@drawable/battery1"
   android:layout_gravity="center_horizontal"/>

</LinearLayout> 
```

在私有 BroadcastReceiver mBatInfoReceive 中，我尝试了一个“if”条件，但它不起作用，请帮我解决这个问题。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T20:13:36.460

也许我只是不明白你的问题。您的问题是您不知道如何以编程方式更改 imageview 中的图像？您可以使用 setImageResource(resourceId)，在您的情况下使用电池。setImageResource(resourceId)。我猜你对不同的电池电量有不同的图像。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T20:34:05.717

您应该将其添加到 onCreateView：

```
battery=(ImageView) myFragmentView.findViewById(R.id.battery); 
```

这要 onReceive：

```
battery.setImageResource(R.drawable.battery1); 
```

# c# - 以编程方式更改左侧和顶部图像

> ID：15820708
> 
> 赞同：-2
> 
> 时间：2013-04-04T20:06:05.133
> 
> 标签：c#, windows-runtime

我需要以编程方式更改设置在画布上的左侧和顶部图像。

```
<Image x:Name="img1" Height="100" Width="100" Source="Assets/111.png" Margin="0" Canvas.Left="50" Canvas.Top="80"/> 
```

像这样的代码：

```
private async void Image1()
        {
            ....
            //img1.Left=50;
            //img1.Top=80;
            img1.UpdateLayout();
        } 
```

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T20:08:37.537

```
Canvas.SetLeft(img1, 50);
Canvas.SetTop(img1, 80); 
```

# google-maps - 我可以创建一个 url，用我定义的坐标打开一个带有 3 个点（A、B、C）的谷歌地图吗？

> ID：15820713
> 
> 赞同：3
> 
> 时间：2013-04-04T20:06:11.380
> 
> 标签：google-maps

我可以制作一个显示 3 点或更多点的谷歌地图的网址吗？类似`https://maps.google.com/maps?q=58+41.881N+152+31.324W`（[链接](https://maps.google.com/maps?q=58+41.881N+152+31.324W)）的东西，但有更多的点。

可能的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T21:35:38.897

我不相信可以在[Google Maps](http://maps.google.com)的 URL 中指定多个标记。

其他选项：

1.  [创建一个包含点的 KML 文件，然后在 URL示例](https://maps.google.com/maps?q=http%3a%2F%2Fwww.geocodezip.com%2Fgeoxml3_test%2Fkmltest_2_SUNSHINE_CHEVRON_b_kml.xml&hl=en&sll=25.641526,-79.101562&sspn=23.171946,41.52832&t=m&z=15)中将其传递给 Google 地图

2.  使用[静态地图](https://developers.google.com/maps/documentation/staticmaps/)

# ruby-on-rails - Rails 使用 jbuilder 显示错误的正确方法

> ID：15820714
> 
> 赞同：7
> 
> 时间：2013-04-04T20:06:13.077
> 
> 标签：ruby-on-rails, ruby, json, jbuilder

我希望在 jbuilder 视图中显示错误消息。例如，我可能有的一条路线可能是：

`/foos/:id/bars`

如果`:id`用户提交的内容不存在或无效，我希望能够在我的`index.json.builder`文件中相应地显示错误消息。

使用 Rails，完成这项工作的最佳方法是什么？控制器可能具有以下内容：

```
def index
  @bar = Bar.where(:foo_id => params[:id])
end 
```

在这种情况下，`params[:id]`可能是`nil`，或者该对象可能不存在。我不确定这里最好的做法是在控制器中处理它并显式渲染一个`error.json.builder`，还是在`index.json.builder`视图本身中处理它。执行此操作的正确方法是什么，如果它在`index.json.builder`，`params[:id]`可以在那里检查吗？我知道我可以看到`@bar.nil?`但不确定是否相反？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-16T21:19:01.013

我认为您的意思是显示，因为索引实际上是用于列表/集合的。你应该去`.first`那里，否则你只是有关系，对吧？然后，用于`.first!`引发错误，因为 Rails 4 [public_exceptions](https://github.com/rails/rails/blob/master/actionpack/lib/action_dispatch/middleware/public_exceptions.rb)中的 Rails 机架中间件将以基本方式处理，例如

```
def show
  # need to do to_s on params value if affected by security issue CVE-2013-1854
  @bar = Bar.where(:foo_id => params[:id].to_s).first!
end 
```

您也可以使用`@bar = Bar.find(params[:id])`，但已弃用，将在 Rails 4.1 中删除，之后您必须添加`gem 'activerecord-deprecated_finders'`到 Gemfile 才能使用。

对于索引，您可能需要`@bars = Bar.all`. 如果由于某种原因您想要过滤而不想要范围等，那么您可以使用`@bars = Bar.where(...).to_a`或类似的。

# Rails 4：Rack 中的基本异常处理是自动的

只要查询开始出现错误，Rails 4 就应该能够返回错误的消息部分，因为`where to_(format)`可以在哈希上调用任何支持的格式（例如 json、xml 等）。

要了解原因，请查看 Rails 的 Rack [public_exceptions](https://github.com/rails/rails/blob/master/actionpack/lib/action_dispatch/middleware/public_exceptions.rb)中间件。

如果是 html，它将尝试从 Rails 的公共目录中读取相关文件以获取状态代码（例如`500.html`，对于服务器错误/HTTP 500）。

如果是其他格式，它会尝试`to_(the format)`在 hash: 上做`{ :status => status, :error => exception.message }`。要查看它是如何工作的，请转到 Rails 的控制台：

```
$ rails c
...
1.9.3p392 :001 > {status: 500, error: "herro shraggy!"}.to_xml
 => "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<hash>\n  <status type=\"integer\">500</status>\n  <error>herro shraggy!</error>\n</hash>\n" 
1.9.3p392 :002 > {status: 500, error: "herro shraggy!"}.to_json
 => "{\"status\":500,\"error\":\"herro shraggy!\"}" 
```

在中间件中，您将`X-Cascade`在代码中以及与 Rails 在 Rack 中的异常处理相关的各个地方看到标头。根据[这个答案](https://stackoverflow.com/a/5644114/178651)，`X-Cascade`标头设置为`pass`告诉 Rack 尝试其他路由来查找资源。

# Rails 3.2.x：可以处理机架中的异常

在 Rails 3.2.x 中，`to_(format)`为响应正文等执行的代码不在[public_exceptions.rb](https://github.com/rails/rails/blob/3-2-stable/actionpack/lib/action_dispatch/middleware/public_exceptions.rb)中。它只处理html格式。

也许您可以尝试通过补丁将旧的中间件替换为较新的版本。

如果您希望 Rack 在没有补丁的情况下以更具体的方式处理您的错误，请参阅 José Valim 的文章中的 #3，“ [Rails 3.2 中我最喜欢的五个“隐藏”功能](http://blog.plataformatec.com.br/2012/01/my-five-favorite-hidden-features-in-rails-3-2/)”。

在那个和[另一个答案](https://stackoverflow.com/questions/10253366/need-to-return-json-formatted-404-error-in-rails/10257494#10257494)中也提到，你可以使用`config.exceptions_app = self.routes`. 然后使用指向自定义控制器的路由，您可以像处理任何其他请求一样处理来自任何控制器的错误。请注意`config.consider_all_requests_local = false`您的`config/environments/development.rb`.

您不必使用路线来使用`exceptions_app`. 虽然它可能有点吓人，但它只是一个 proc/lambda，它接受一个哈希并返回一个格式为： 的数组`[http_status_code_number, {headers hash...}, ['the response body']]`。例如，您应该能够在 Rails 3.2.x 配置中执行此操作，以使其处理 Rails 4.0 之类的错误（这是最新的 public_exceptions 中间件折叠）：

```
config.exceptions_app = lambda do |env|
  exception = env["action_dispatch.exception"]
  status = env["PATH_INFO"][1..-1]
  request = ActionDispatch::Request.new(env)
  content_type = request.formats.first
  body = { :status => status, :error => exception.message }
  format = content_type && "to_#{content_type.to_sym}"
  if format && body.respond_to?(format)
    formatted_body = body.public_send(format)
    [status, {'Content-Type' => "#{content_type}; charset=#{ActionDispatch::Response.default_charset}",
            'Content-Length' => body.bytesize.to_s}, [formatted_body]]
  else
    found = false
    path = "#{public_path}/#{status}.#{I18n.locale}.html" if I18n.locale
    path = "#{public_path}/#{status}.html" unless path && (found = File.exist?(path))

    if found || File.exist?(path)
      [status, {'Content-Type' => "text/html; charset=#{ActionDispatch::Response.default_charset}",
              'Content-Length' => body.bytesize.to_s}, [File.read(path)]]
    else
      [404, { "X-Cascade" => "pass" }, []]
    end
  end
end 
```

注意：对于该处理的任何问题，故障安全实现在`ActionDispatch::ShowExceptions` [这里](https://github.com/rails/rails/blob/master/actionpack/lib/action_dispatch/middleware/show_exceptions.rb)。

# Rails 3 和 4：在 Rails 控制器中处理一些异常

如果您希望在控制器本身中有错误呈现，您可以执行以下操作：

```
def show
  respond_with @bar = Bar.where(:foo_id => params[:id].to_s).first!
rescue ActiveRecord::RecordNotFound => e
  respond_to do |format|
    format.json => { :error => e.message }, :status => 404
  end
end 
```

但是，您不需要引发错误。你也可以这样做：

```
def show
  @bar = Bar.where(:foo_id => params[:id].to_s).first
  if @bar
    respond_with @bar
  else
    respond_to do |format|
      format.json => { :error => "Couldn't find Bar with id=#{params[:id]}" }, :status => 404
    end
  end
end 
```

您还可以使用[rescue_from](http://api.rubyonrails.org/classes/ActiveSupport/Rescuable/ClassMethods.html)，例如在您的控制器或 ApplicationController 等中：

```
rescue_from ActiveRecord::RecordNotFound, with: :not_found

def not_found(exception)
  respond_to do |format|
    format.json => { :error => e.message }, :status => 404
  end
end 
```

或者：

```
rescue_from ActiveRecord::RecordNotFound do |exception|
  respond_to do |format|
    format.json => { :error => e.message }, :status => 404
  end
end 
```

虽然一些常见的错误可以在控制器中处理，但如果您的错误与缺少路由等相关的错误以 json 等格式格式化，则需要在 Rack 中间件中处理。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-04T22:27:58.917

我会渲染 index.json.builder 或只是内联 json`:error => 'not found'` 并且不要忘记设置正确的 HTTP 状态：`:status => 404`

所以结果可能如下所示：

```
render :json => { :error => 'not found' }, :status => 422 if @bar.nil? 
```

# c - gdb 声称 realloc() 或 free() 损坏了内存，而 valgrind 声称非空终止的数组耗尽了……这是什么？

> ID：15820719
> 
> 赞同：2
> 
> 时间：2013-04-04T20:06:31.580
> 
> 标签：c, heap-memory, realloc, strcat, corrupt

### 背景

我正在开发一个程序，其中一个线程从主线程中分离出来，解析电子邮件日志并按 QID 组织每个条目，QID 是每条消息唯一的 ID。

### 问题

该程序一直在工作，直到我重新组织它，而不是首先将整个日志文件加载到内存中，而是在读取日志文件时开始解析每一行。该程序将在下面显示的代码片段中进行 SIGABRT（稍微简化但演示了相同的问题）。

### 调试结果

gdb 将声称它是（取决于运行）realloc/free 无效大小或 realloc/free 损坏内存，而 valgrind 始终声称一个非空终止数组导致运行溢出并损坏堆（我认为这更有可能是案例但找不到问题）。（如果您希望我分享 valgrind 或 gdb 的原始输出，请告诉我）。

```
void *parseMessageAndMatch(void *params) {
    // get params passed in from parent thread
    parse_params *rp = (parse_params *)params;

    // len0: length of log dump for current QID
    // len1: length of log dump after current buffer is appended
    int len0, len1;
    // tmp char pointer for log dump
    char *tmp;

    // 1\. increase/allocate memory for log dump and append line buffer
    // get length of current log dump (0 if NULL)
    // dump is of type char* and contains the log lines pertaining to a certain QID
    len0 = (!msgs.msgs[rp->index].dump) ? 0 : strlen(msgs.msgs[rp->index].dump);
    // get length of log dump after current line buffer is appended
    // rp->len contains the strlen of the line buffer
    len1 = len0 + rp->len + 1;

    // allocate space for tmp log dump
    // lock becaus msgs is a global variable and there is more than one thread
    pthread_mutex_lock(rp->mutex);
    if ((tmp = realloc(msgs.msgs[rp->index].dump, sizeof(*tmp)*len1)) == NULL) {
        printf("Cannot allocate memory for log dump.\n");
        exit(-1);
    }
    // update pointer
    msgs.msgs[rp->index].dump = tmp;
    // set tmp to null
    tmp = NULL;
    // if original buffer was empty, zero it out for safety
    if (len0 == 0)
        bzero(msgs.msgs[rp->index].dump, sizeof(char)*len1);

    // rp->line is malloc'ed then bzero'ed and strcpy'ed to contain the log line read from file
    strcat(msgs.msgs[rp->index].dump, rp->line);
    msgs.msgs[rp->index].dump[len1-1] = '\0'; // add null terminator
    pthread_mutex_unlock(rp->mutex);

    // more parsing code is here but was commented out during my debug process
    // so I have omitted it from this code snippet

    // free line buffer
    free(rp->line);
    // set to null to prevent double free
    rp->line = NULL;
    // free params
    free(rp);
    // prevent double free
    rp = NULL;
} 
```

### 编辑

在下面的答案中进行了更正。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T20:14:06.180

```
msgs.msgs[rp->index].dump[len1] = '\0'; // add null terminator 
```

后

```
realloc(msgs.msgs[rp->index].dump, sizeof(*tmp)*len1) 
```

是越界写入。最后一个有效索引是`len1 - 1`。

* * *

修复后代码仍在中止，可能是

```
// rp->line is malloc'ed then bzero'ed and strcpy'ed to contain the log line read from file
strcat(msgs.msgs[rp->index].dump, rp->line); 
```

写在分配`strcpy`的`rp->line`缓冲区之外。我可以在函数中看到的唯一其他候选人是

```
msgs.msgs[rp->index].dump 
```

如果这不是 0 终止的，则`strlen`可以在分配的缓冲区外运行，`strcat`然后可以再次在分配的内存之外写入。后者可以通过设置来避免

```
msgs.msgs[rp->index].dump[len0] = 0; 
```

在 realloc 之后和`strcat`.

* * *

释放后设置`rp`为`NULL`

```
free(rp);
// prevent double free
rp = NULL; 
```

是没有意义的，因为`rp`是一个局部变量，然后函数立即返回。传入的指针`params`仍然保存调用者中的旧地址（严格来说，它的值变得不确定，但实际上，位不会改变）。这开启了调用者认为指针仍然指向有效内存的可能性。

# javascript - 如何计算 HTML 元素的左边距

> ID：15820721
> 
> 赞同：1
> 
> 时间：2013-04-04T20:06:37.420
> 
> 标签：javascript, html, css

有没有办法编写一个javascript函数，给定任何HTML元素告诉我它的'margin-left'以像素为单位。*（我想无论算法是什么，它都可以重新应用以获得margin-right，top和bottom）*

一种解决方案是：

```
function(htmlElement) {
    return htmlElement.style.marginLeft;
} 
```

但这仅在将 marginLeft 应用于该 html 元素时才有效。

如果没有明确设置，我该如何计算它？如果它没有以像素为单位明确设置？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-04T20:11:16.527

您可以使用[`window.getComputedStyle()`](https://developer.mozilla.org/en/docs/DOM/window.getComputedStyle).

[jsFiddle](http://jsfiddle.net/rj99U/)

```
window.getComputedStyle(elem, null).getPropertyValue("margin-left"); 
```

所以`elem.style.marginLeft`获取应用的 CSS 值，在应用`getComputedStyle`所有内容后获取实际计算值。

`getComputedStyle`在 IE8 中不起作用，但是有一堆 polyfills 可用：

*   [Polyfills-for-IE8 / getComputedStyle.js](https://github.com/jonathantneal/Polyfills-for-IE8/blob/master/getComputedStyle.js)
*   [一个更简单的 polyfill](http://snipplr.com/view/13523/)

# javascript - 资源属性中的动态指令

> ID：15820722
> 
> 赞同：0
> 
> 时间：2013-04-04T20:06:38.097
> 
> 标签：javascript, angularjs, angularjs-directive

我有一个资源中继器，该资源包含一个内部带有角度指令的属性，并与文本混合。我想要完成的是根据对象的属性动态显示表单输入。

```
<ul>
  <li ng-repeat="action in actions">
    {{action.form_layout}}
  </li>
</ul> 
```

在这种情况下`action.form_layout`，可能包含一些带有指令的文本，这些文本也需要编译。

```
Open the <door></door> with this <key></key>
// <door> and <key> are directives that would return different inputs
// so this should be compiled to Open the <input type="text" name="door"></input> with this <input type="text" name="key"></input> 
```

我怎样才能做到这一点？现在，属性值正在模板中以纯文本形式打印。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T04:18:12.447

请看看这个小提琴。[http://jsfiddle.net/dH5Ln/](http://jsfiddle.net/dH5Ln/) 这里`door`and`key`被分隔为单独的指令。在`compile`函数的帮助下，我们正在解析模板并显示编译后的模板。

# jquery - IE8及以下条件格式

> ID：15820723
> 
> 赞同：1
> 
> 时间：2013-04-04T20:06:41.770
> 
> 标签：jquery, html, css, internet-explorer

我有一个网页（参见[http://goo.gl/Bfnm6](http://goo.gl/Bfnm6)），其底部出现两个圆圈。对于非 IE 浏览器（如果版本 > 8 还包括 IE），圆圈由 CSS 生成。对于 IE8 及以下版本，圆圈呈现为 .PNG 文件，因为这些浏览器无法使用 CSS 生成圆圈。

我的问题是，虽然我的条件格式在找到 IE8 或更低版本时正确地为 .PNG 文件提供服务，但是应该调用 Javascript 来删除包含 CSS 生成的圆圈的 div 并不会删除 div。结果是您在下面的屏幕截图中看到了工件。工件是包含在 div 中的文本，而这些文本又包含 CCS 声明。谁能告诉我我做错了什么？

我尝试了以下方法，但在所有情况下，工件仍然存在：

1.  使用 jQuery 调用`.empty()`div，如下面的代码块所示
2.  通过使用纯 Javascript 调用`document.getElementById("advisers-css-image").innerHTML=""`和设置 div 的内部 HTML 为 ""`document.getElementById("industry-css-image").innerHTML=""`
3.  打电话`document.getElementById("advisers-css-image").style.visibility="hidden"`和`document.getElementById("industry-css-image").style.visibility="hidden"`

**截屏** ![在此处输入图像描述](https://i.stack.imgur.com/CXVCH.png)

**HTML**

```
<script type="text/javascript" src="http://code.jquery.com/jquery-1.9.1.min.js"></script>    
<script type="text/javascript" src="http://code.jquery.com/ui/1.9.2/jquery-ui.min.js"></script>

<!--[if lt IE 9]>
<div class="advisers display-inline-block">
<a href="#" id="advisers-png-image">
  <img src="images/advisers220x220.png?format=300w" alt=""> 
</a>
</div>

<div class="display-inline-block">
<a href="#" id="industry-png-image">
  <img src="images/industry220X220.png?format=300w" alt="">
</a>
</div>

<script type="text/javascript">
$( "#advisers-css-image" ).empty();
$( "#industry-css-image" ).empty();
$( "#advisers-circle-text" ).empty();
$( "#industry-circle-text" ).empty();
</script>
<![endif]-->

<a href="#" id="advisers-css-image">
  <div id="advisers-circle-text "class="circle display-inline-block hovershadow advisers advisers-box-shadow text">Professional
    advisers</div>
</a>

<a href="#" id="industry-css-image">
  <div id="industry-circle-text"class="circle display-inline-block hovershadow industry industry-box-shadow">Industry</div>
</a> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T20:11:35.467

这是因为链接需要在条件格式的脚本上方。在脚本执行时，链接尚未呈现。

所以像这样向上移动它们：

```
<script type="text/javascript" src="http://code.jquery.com/jquery-1.9.1.min.js"></script>    
<script type="text/javascript" src="http://code.jquery.com/ui/1.9.2/jquery-ui.min.js"></script>

<a href="#" id="advisers-css-image">
  <div id="advisers-circle-text "class="circle display-inline-block hovershadow advisers advisers-box-shadow text">Professional
    advisers</div>
</a>

<a href="#" id="industry-css-image">
  <div id="industry-circle-text"class="circle display-inline-block hovershadow industry industry-box-shadow">Industry</div>
</a>

<!--[if lt IE 9]>
<div class="advisers display-inline-block">
<a href="#" id="advisers-png-image">
  <img src="images/advisers220x220.png?format=300w" alt=""> 
</a>
</div>

<div class="display-inline-block">
<a href="#" id="industry-png-image">
  <img src="images/industry220X220.png?format=300w" alt="">
</a>
</div>

<script type="text/javascript">
$( "#advisers-css-image" ).empty();
$( "#industry-css-image" ).empty();
$( "#advisers-circle-text" ).empty();
$( "#industry-circle-text" ).empty();
</script>
<![endif]--> 
```

* * *

或者正如@Zach L 在评论中所说，您可以将条件格式化脚本包装在一个[`.ready()`](http://api.jquery.com/ready/)函数中。这样做，您无需更改标记：

```
<script type="text/javascript">
    $(document).ready(function() 
    {
        $( "#advisers-css-image" ).empty();
        $( "#industry-css-image" ).empty();
        $( "#advisers-circle-text" ).empty();
        $( "#industry-circle-text" ).empty();
    });
</script> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T20:16:36.737

正如@Scott 指出的那样，问题在于您的脚本是在呈现 HTML 之前执行的。您可以将脚本移动到 HTML 之上，或在 DOM 就绪时执行它。

这应该可以解决问题：

```
<script>
  $(function(){
    $('#advisers-css-image, #industry-css-image').remove();
  });
</script> 
```

# internet-explorer - 如何在 IE10 的 Web 浏览器控件中启用拼写检查器

> ID：15820726
> 
> 赞同：2
> 
> 时间：2013-04-04T20:07:01.637
> 
> 标签：internet-explorer, webbrowser-control, spell-checking

我正在尝试在我自己的应用程序托管 Web 浏览器控件中启用 IE10 附带的拼写检查器功能。根据此页面[http://msdn.microsoft.com/en-us/library/ee330735(v=vs.85).aspx#spellcheck](http://msdn.microsoft.com/en-us/library/ee330735(v=vs.85).aspx#spellcheck)，我所要做的就是创建一个值 myapp.exe 并将其设置为 1在以下注册表项下：

HKCU\Software\Microsoft\Internet Explorer\Main\FeatureControl\FEATURE_SPELLCHECKING

或者

HKLM\Software\Microsoft\Internet Explorer\Main\FeatureControl\FEATURE_SPELLCHECKING

但是，我试过了，它不起作用。如果你已经能够让它工作，请分享你的经验。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-29T08:53:35.417

它作为标准打开，但对我来说是错误的，它适用于某些页面和某些文本框但不是全部，它在 IE 测试站点上对我来说很好：

[http://ie.microsoft.com/testdrive/Browser/SpellChecking/](http://ie.microsoft.com/testdrive/Browser/SpellChecking/)

那对你有用吗？

# python - Python 3 - 查找列表的哪个索引包含特定字符串作为子字符串

> ID：15820732
> 
> 赞同：2
> 
> 时间：2013-04-04T20:07:33.967
> 
> 标签：python, list, python-3.x

我正在处理以下代码：

```
def findLine(prog, target):
   for l in range(0, len(prog)-1):
      progX = prog[l].split()
      for i in range(0, len(progX)):
         if progX[i] == target:
            a = progX[i] 
```

...但我需要一种方法来查找 prog 的哪个索引包含 a。该程序的示例输入是：

findLine(['10 GOTO 20', '20 END'], '20')

问题本身应该比我自己解释得更好：
定义一个函数 findLine(prog, target) 来执行以下操作。假设 prog 是一个包含 BASIC 程序的字符串列表，例如 getBASIC() 生成的类型；假设 target 是一个包含行号的字符串，它是 GOTO 语句的目标。该函数应返回索引 i（一个介于 0 和 len(prog)-1 之间的数字），使得 prog[i] 是其标签等于 target 的行。

示例输入/输出：如果调用 findLine(['10 GOTO 20','20 END'], '10') 则输出应为 0，因为列表的第 0 项是标签为 10 的行。

那么，如何找到包含 ans 作为子字符串的第一个索引？提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T20:16:08.030

在我看来，你很接近...

```
def findLine(prog, target):
   for l in range(0, len(prog)):  #range doesn't include last element.
      progX = prog[l].split()
      #you probably only want to check the first element in progX
      #since that's the one with the label
      if progX[0] == target:
          return l  #This is the one we want, return the index

      #Your code for comparison
      #for i in range(0, len(progX)):
      #   if progX[i] == target:
      #      a = progX[i] 
```

这部分可以使用以下方法更好地完成`enumerate`：

```
def findLine(prog, target):
   for l,line in enumerate(prog):
      progX = line.split()
      if progX[0] == target:
          return l  #This is the one we want, return the index 
```

如果你真的感兴趣，这可以在 python 的 1 行中完成：

```
def findLine(prog,target):
    return next(i for i,line in enumerate(prog) if line.split()[0] == target) 
```

这条线有很多内容，但这是一个相当普遍的成语。它使用`next`带有“生成器表达式”的函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T20:17:57.617

你跳过了最后一行。

Range 产生一系列直到但不包括第二个参数的所有内容：

```
>>> list(range(5))
[0, 1, 2, 3, 4] 
```

看看有五个值但`5`不是其中之一吗？（如果第一个参数`range`是`0`，你可以省略它。）

一种更 Pythonic 的方式来迭代某些东西但仍然能够知道索引是使用`enumerate`：

```
for index, line in enumerate(prog):
    line_parts = line.split()
    for part in line_parts:
        if part == target:
            # Figure out what to do here.
            # Remember that 'index' is the index of the line you are examining. 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-04-04T20:19:49.640

```
def iterfind (iterable, function):
    for i in enumerate(iterable):
        if function(i[1]): return i[0]
    return -1

def basic_linenumber_find (mylist, linenumber):
    return iterfind(mylist, lambda x: int(x.split()[0]) == linenumber)

basic_linenumber_find(['10 GOTO 20', '20 END'], 10) 
```

# jquery - 使用 jquery fileupload 单独取消上传

> ID：15820738
> 
> 赞同：0
> 
> 时间：2013-04-04T20:08:01.543
> 
> 标签：jquery, file-upload

如何中止特定文件的上传！我将 jqXHR 附加到上下文的数据属性，然后调用 abourtUpload 函数来搜索数据属性，然后尝试中止它！但它不工作！

```
function abortUpload (e) {    
    e.preventDefault();
    var template = $(e.currentTarget).closest('.template-upload'),
    data = template.data('data') || {}; 
    console.log(data); // returns [Object object]
    data.jqXHR.abort(); // Cannot call method 'abort' of undefined 
}
// Method of fileupload
 add: function(e, data) {
      data.context = $(tmpl("template-upload", file)).attr('data-data', { jqXHR: data.submit() } );
      $('#fileupload').append(data.context);
      data.context.find('.cancel').click( abortUpload );
      return data.submit(); 
  } 
```

有什么想法吗？米格尔。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T09:41:11.917

您正在尝试将 jqXHR 对象存储为 HTML 数据属性值，这是不可能的。
您只能将对象存储在可序列化为 JSON 的 HTML 数据属性中。

你可以做的是使用 jQuery 的 .data() 方法来存储值，它允许存储任意对象。

但是，由于您的所有代码都在同一个方法中，因此您无需执行任何操作，因为您可以简单地使用局部变量来访问 jqXHR 对象并取消上传。
您也不需要设置 data.context，因为这仅用于设置 jQuery.ajax 请求的上下文。

因此，以下代码段应该可以帮助您开始：

```
var jqXHR = data.submit(),
    node = $(tmpl("template-upload", file)).appendTo('#fileupload');
node.find('.cancel').click(function (e) {
    e.preventDefault();
    jqXHR.abort();
}); 
```

# python - Python：URL错误： 操作系统：Windows 7；使用 Python GUI Shell 的 Python 2.7.3 我正在尝试通过 Python 阅读网站，并且有几位作者使用urllib和urllib2库。要将站点存储在变量中，我看到了一种类似的方法： 问问题 问问题 2013-04-04T20:08:04.457 129554 次 This question shows research effort; it is useful and clear 20 This question does not show any research effort; it is unclear or not useful Bookmark this question. Show activity on this post. 操作系统：Windows 7；使用 Python GUI Shell 的 Python 2.7.3 我正在尝试通过 Python 阅读网站，并且有几位作者使用urllib和urllib2库。要将站点存储在变量中，我看到了一种类似的方法： import urllib import urllib2 g = "http://www.google.com/" read = urllib2.urlopen(g) 最后一行在 120 多秒后生成错误： > Traceback (most recent call last): File "<pyshell#27>", line 1, in > <module> > r = urllib2.urlopen(o) File "C:\Python27\lib\urllib2.py", line 126, in urlopen > return _opener.open(url, data, timeout) File "C:\Python27\lib\urllib2.py", line 400, in open > response = self._open(req, data) File "C:\Python27\lib\urllib2.py", line 418, in _open > '_open', req) File "C:\Python27\lib\urllib2.py", line 378, in _call_chain > result = func(*args) File "C:\Python27\lib\urllib2.py", line 1207, in http_open > return self.do_open(httplib.HTTPConnection, req) File "C:\Python27\lib\urllib2.py", line 1177, in do_open > raise URLError(err) URLError: <urlopen error [Errno 10060] A connection attempt failed because the connected party did not properly > respond after a period of time, or established connection failed > because connected host has failed to respond> 我尝试绕过g变量并尝试也urlopen("http://www.google.com/")没有成功（它在相同的时间长度后产生相同的错误）。 错误代码 10060 表示它无法连接到远程对等方。这可能是因为网络问题或主要是您的设置问题，例如代理设置。 您可以尝试将同一主机与其他工具（例如 ncat）和/或同一本地网络中的另一台 PC 连接，以找出问题所在。 对于代理问题，这里有一些材料： 使用 HTTP 代理 - Python 为什么我不能让 Python 的 urlopen() 方法在 Windows 上工作？ 希望能帮助到你！ pythonpython-2.7urllib2urllib 4 3 回答 3 This answer is useful 16 错误代码 10060 表示它无法连接到远程对等方。这可能是因为网络问题或主要是您的设置问题，例如代理设置。 您可以尝试将同一主机与其他工具（例如 ncat）和/或同一本地网络中的另一台 PC 连接，以找出问题所在。 对于代理问题，这里有一些材料： 使用 HTTP 代理 - Python 为什么我不能让 Python 的 urlopen() 方法在 Windows 上工作？ 希望能帮助到你！ 于 2013-05-01T02:49:21.890 回答 This answer is useful 5 答案（基本是提前！）： 错误：10060 添加超时参数来请求解决了我的问题。 示例 1 import urllib import urllib2 g = "http://www.google.com/" read = urllib2.urlopen(g, timeout=20) 示例 2 在我发出 GET 请求时也发生了类似的错误。同样，传递timeout参数解决了 10060 错误。 response = requests.get(param_url, timeout=20) 于 2020-05-29T07:14:14.040 回答 This answer is useful 1 这是因为代理设置。我也遇到了同样的问题，在这个问题下，我无法使用任何从 Internet 获取数据的模块。有几个简单的步骤： 1.打开控制面板 2.打开互联网选项 3.在连接选项卡下打开 LAN 设置 4.转到高级设置并取消标记所有内容，删除其中的每个代理。或者您可以取消标记代理服务器中的复选框，这也将执行相同的操作 5.单击确定 保存所有设置。 你完成了。尝试再次运行该程序，它必须工作它至少对我有用 于 2017-12-28T13:56:24.230 回答 Related 3 java - java初始化一个类的字段 2 c# - 如何知道电子邮件是否被收件人标记为垃圾邮件 1 jquery - 在初始化之前无法调用 [widget name] 上的方法 0 html - 如何在 Firefox 中使用 selenium 选择菜单和子菜单 1 youtube - youtube direct lite 视频无法播放 3 java - 在解析输入字符串时保留输入字符串的格式以加倍 1 c# - NSubstitute When...Do 定义不会被后续定义覆盖 3 oracle - 带有两个表的更新语句 -Oracle 2 java - 使用 javafx 从 webview 获取内容 1 html - 在 HTML 中缩放图像映射 Reference php × 1429865 c/c++ × 756500 nginx × 49975 mongodb × 159057 mybatis × 3233 anaconda × 13410 pycharm × 14671 python × 1902243 vscode × 56040 docker × 110988 github × 49000 flask × 49129 ffmpeg × 24037 jmeter × 16910 matplotlib × 63493 bootstrap × 54641

> ID：15820739
> 
> 赞同：20
> 
> 时间：
> 
> 标签：python, python-2.7, urllib2, urllib

**操作系统：Windows 7；使用 Python GUI Shell 的 Python 2.7.3**

我正在尝试通过 Python 阅读网站，并且有几位作者使用`urllib`和`urllib2`库。要将站点存储在变量中，我看到了一种类似的方法：

```
import urllib
import urllib2
g = "http://www.google.com/"
read = urllib2.urlopen(g) 
```

最后一行在 120 多秒后生成错误：

```
> Traceback (most recent call last):   File "<pyshell#27>", line 1, in
> <module>
>     r = urllib2.urlopen(o)   File "C:\Python27\lib\urllib2.py", line 126, in urlopen
>     return _opener.open(url, data, timeout)   File "C:\Python27\lib\urllib2.py", line 400, in open
>     response = self._open(req, data)   File "C:\Python27\lib\urllib2.py", line 418, in _open
>     '_open', req)   File "C:\Python27\lib\urllib2.py", line 378, in _call_chain
>     result = func(*args)   File "C:\Python27\lib\urllib2.py", line 1207, in http_open
>     return self.do_open(httplib.HTTPConnection, req)   File "C:\Python27\lib\urllib2.py", line 1177, in do_open
>     raise URLError(err) URLError: <urlopen error [Errno 10060] A connection attempt failed because the connected party did not properly
> respond after a period of time, or established connection failed
> because connected host has failed to respond> 
```

我尝试绕过`g`变量并尝试也`urlopen("http://www.google.com/")`没有成功（它在相同的时间长度后产生相同的错误）。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-05-01T02:49:21.890

错误代码 10060 表示它无法连接到远程对等方。这可能是因为网络问题或主要是您的设置问题，例如代理设置。

您可以尝试将同一主机与其他工具（例如 ncat）和/或同一本地网络中的另一台 PC 连接，以找出问题所在。

对于代理问题，这里有一些材料：

[使用 HTTP 代理 - Python](https://stackoverflow.com/questions/5620263/using-an-http-proxy-python)

[为什么我不能让 Python 的 urlopen() 方法在 Windows 上工作？](https://stackoverflow.com/questions/2923703/why-cant-i-get-pythons-urlopen-method-to-work)

希望能帮助到你！

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2020-05-29T07:14:14.040

## 答案（基本是提前！）：

***错误：10060*** 添加超时参数来请求解决了我的问题。

### 示例 1

```
import urllib
import urllib2
g = "http://www.google.com/"
read = urllib2.urlopen(g, timeout=20) 
```

## 示例 2

在我发出 GET 请求时也发生了类似的错误。同样，传递`timeout`参数解决了 10060 错误。

```
response = requests.get(param_url, timeout=20) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-12-28T13:56:24.230

这是因为代理设置。我也遇到了同样的问题，在这个问题下，我无法使用任何从 Internet 获取数据的模块。有几个简单的步骤：
**1.**打开**控制面板**
**2.**打开**互联网选项**
**3.**在连接选项卡下**打开 LAN 设置**
**4.**转到高级设置并**取消标记所有内容**，**删除其中的每个代理**。或者您可以取消标记代理服务器中的复选框，这也将执行相同的操作
**5.单击确定** **保存所有设置**。
你完成了。尝试再次运行该程序，它必须工作它至少对我有用

# c# - C# 中用于数据结构的惯用、有保证的互斥锁？

> ID：15820742
> 
> 赞同：2
> 
> 时间：2013-04-04T20:08:23.933
> 
> 标签：c#, locking

假设在 C# 中，您有一个`Dictionary<K, V>`对象，多个线程正在访问和更改。您希望某些操作是线程安全的。

因此，您需要一个互斥锁。在 C# 中，使用互斥锁的标准方法是：

```
lock (someSharedObject)
{
   // Mutual exclusion zone here.
   myDictionary.Add(1, "hello");
} 
```

问题是，您仅依靠文档来防止未来的程序员绕过互斥锁直接访问字典：

```
myDictionary.Add(1, "hello"); 
```

我希望编译器阻止未来的程序员使用不受保护的字典。

我看到两种一般可能性：

1.  创建一个相似的字典（例如，`LockedDictionary`），它确保锁定其成员方法，但在其他方面都像字典一样。
2.  创建一个保护对 的访问的类，因此调用者在不通过保护的情况下`Dictionary`无法到达。`Dictionary`

这些满足了人们想要的特性，即现在没有人可以不受保护地使用字典，至少是偶然的。我想讨论两者的优缺点，然后请您同意或不同意我的观点，并提出我可能忽略的解决方案。

好处`LockedDictionary`是对其他人来说很直观。它还允许对哪些方法需要锁定以及锁定程度进行细粒度控制。缺点是它不完全是 a `Dictionary`，因此您不能将此对象传递给期望接收 a 的函数`Dictionary`。（尽管您可以通过实施来接近`IDictionary`。）

继续#2。守卫类的好处是你可以`IDisposable`像这样实现和使用它：

```
class DictionaryFortress {
   Dictionary<K, V> realDict;
   Object lockobject;
   void Lock() {
      Monitor.Enter(lockobject);
      return DictionaryGuard(lockobject, realDict);
   }
}

class DictionaryGuard : IDisposable {
   public Dictionary<K, V> Dict {
      get { return realDict; }
   }
   public void Dispose() {
      Monitor.Exit(lockobject);
   }
}

// in some class
DictionaryFortress dict = new DictionaryFortress(); // early on

// in a function, when we need to access dictionary contents...
using (DictionaryGuard guard = dict.Lock()) {
   Dictionary<K, V> actualDict = guard.Dict;
   // now you can pass actualDict anywhere; no one has to know that it's locked
} 
```

当然，好处是我们可以访问原始字典，因此我们不受限制如何使用它以及可以在哪里传递它。缺点是使用它的开销更大。用户也可以在引用`guard.Dict`可用时保存它，然后在处理 DictionaryGuard 后使用它。

我倾向于#2。我错过了任何优点和缺点吗？有没有更好的方法来保护对我的字典的访问，同时最大限度地减少误用的风险？同样，我的*要求*是健忘或粗心的程序员不能跳过锁定阶段。我的愿望是它是惯用的、方便的和灵活的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T20:23:11.463

你考虑过[`ConcurrentDictionary<TKey, TValue>`](http://msdn.microsoft.com/en-us/library/dd287191.aspx)吗？它和其他[并发集合](http://msdn.microsoft.com/en-us/library/dd287108.aspx)是在 .NET 4.0 中引入的。

> 表示可由多个线程同时访问的键/值对的线程安全集合。

# javascript - 配置 - 是否有基于 Web 的 github 连接工具？

> ID：15820743
> 
> 赞同：0
> 
> 时间：2013-04-04T20:08:26.370
> 
> 标签：javascript, github

有人告诉我 github 有连接工具，而不是我在一次技术活动中听到的。

所以如果我有

```
file1.js
file2.js
... 
```

它将它们连接成

```
file_all.js 
```

有这个的网络界面吗？（在 www.github.com 上）

我想提高效率，而不是手动复制粘贴。

我不需要任何复杂的东西，只需要自动执行此操作的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T20:10:40.930

使用[咕噜声](http://gruntjs.com/)。它已成为一种非常流行的工具。设置它可能需要一些时间，但它旨在自动执行诸如[uglifying](https://github.com/gruntjs/grunt-contrib-uglify)（连接和缩小 JS 文件）之类的任务。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T20:11:47.137

您想自动化您的工作流程吗？使用 maven 和这个为 JS 开发人员提供的工具包[http://mojo.codehaus.org/javascript-maven-tools/](http://mojo.codehaus.org/javascript-maven-tools/)

# php - AS3、PHP、mysql：无法从服务器获取变量

> ID：15820745
> 
> 赞同：0
> 
> 时间：2013-04-04T20:08:34.070
> 
> 标签：php, mysql, actionscript-3

我使用 as3、mysql 和 php，尝试发送用户名并接收（积分）并将积分发布在舞台上的文本对象中，我可以使用类似的脚本将积分发送到服务器，但可以取回数字！

* * *

```
// global variables
var loader:URLLoader;
var urlReq:URLRequest;
var urlVars:URLVariables;
var myVars:URLVariables;

addEventListener(Event.ENTER_FRAME, onit);

function onit(e:Event):void
{

    urlReq = new URLRequest("http://www.mysite.com/GetPoints.php");
    urlReq.method = URLRequestMethod.POST;

    urlVars = new URLVariables();
    urlReq.data = urlVars;
    urlVars.username = nickname_txt.text;

    loader = new URLLoader(urlReq);
    loader.addEventListener(Event.COMPLETE, onUpdateComplete);

    loader.dataFormat = URLLoaderDataFormat.VARIABLES;
    loader.load(urlReq);
}

function onUpdateComplete(e:Event):void
{
    myVars = e.target.data;
    totalP.text = myVars.total;
} 
```

* * *

php 在浏览器中执行时重新运行这些点，但未连接到 flash。

```
<?php
$username = $_POST["username"];
    // defining main variables
    $dbHost = "localhost";
    $dbUser = "";
    $dbPass = "";
    $dbName = "";
    $dbTable = "`".$username."_points`";

    @mysql_connect($dbHost, $dbUser, $dbPass) or die(mysql_error());
    @mysql_select_db($dbName) or die(mysql_error());

    $data = "";
    $res = mysql_query("SELECT * FROM ".$dbTable." ORDER BY id") or die(mysql_error());
    while($row = mysql_fetch_object($res)) {

        $data = "total=".$row->total;
        print $data;
    }

?> 
```

任何帮助将不胜感激 ！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T06:39:20.670

你必须`echo`或`println`你的数据在 php.ini 中。

您必须打印的格式如下 -

```
key1=value1&key2=value2&key3=value3 and so on 
```

然后你应该能够像这样访问 AS3 中的数据 -

```
myVars = e.target.data;
totalP.text = myVars.key1; //this will be value1 
```

此外，您传递的第一个变量之前不应有 & 符号。

我建议你做的是这样的

```
print "key1=value1"; //print out a test value    
while($row = mysql_fetch_object($res)) {

        $data = "&total=".$row->total; //add an ampersand before the key
        print $data;
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T08:23:38.003

尝试将这样的内容添加到您的`PHP`,

```
 $someVar  = "l=l";
 $someVar .= "&someData=".rawurlencode($someData);
 echo $someVar; 
```

好运。

# javascript - 如何在 Web Audio API 中使用 LFO 调制 AudioParam

> ID：15820746
> 
> 赞同：2
> 
> 时间：2013-04-04T20:08:35.607
> 
> 标签：javascript, web-audio-api

如何调制 Web Audio API 中的任何 AudioParams，例如使用低频振荡器的 GainNode 增益值？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-04T20:29:33.680

[https://coderwall.com/p/h1jnmg](https://coderwall.com/p/h1jnmg)

```
var saw = context.createOscillator(),
      sine = context.createOscillator(),
      sineGain = context.createGainNode();

//set up our oscillator types
saw.type = saw.SAWTOOTH;
sine.type = sine.SINE;

//set the amplitude of the modulation
sineGain.gain.value = 10;

//connect the dots
sine.connect(sineGain);
sineGain.connect(saw.frequency); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-05T04:04:56.160

您没有保存实际节点，只是保存值 - 所以当您尝试连接到振荡器.频率时，您传递的是一个整数值（400 - 您保存在节点中的频率）。尝试[http://jsfiddle.net/GCSEq/6/](http://jsfiddle.net/GCSEq/6/) - 它存储节点，并正确路由到 AudioParam。

```
this.oscillator = context.createOscillator();
this.gain = context.createGainNode(); 
```

和 osctest2.play(osctest.oscillator.frequency , 1000);

（您在控制台中遇到错误。）

# python - 正则表达式 re.findall() 挂起 - 如果您无法逐行阅读怎么办

> ID：15820752
> 
> 赞同：3
> 
> 时间：2013-04-04T20:08:46.227
> 
> 标签：python, regex, freeze

我有多个文件，每个文件都在搜索一系列单词。

我的正则表达式基本上搜索 word1 后跟 word2 后跟 word 3 等的序列。所以表达式看起来像：

```
strings = re.findall('word1.*?word2.*?word3', f.read(), re.DOTALL) 
```

对于 20kb 以下的文件，表达式执行得很好。但是，对于大于 20 kb 的文件，执行时间会成倍增加，并且对于接近 100 kb 的文件，进程会完全挂起。看来（在阅读了以前的线程之后）问题与使用 .* 和 re.DOTALL 相关 - 导致“灾难性回溯”。推荐的解决方案是逐行提供输入文件，而不是将整个文件读入单个内存缓冲区。

但是，我的输入文件充满了随机空格和“\n”换行符。我的单词序列也很长，并且出现在多行中。因此，我需要将整个文件连同 re.DOTALL 一起输入到正则表达式中 - 否则逐行搜索将永远找不到我的序列。

有什么办法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T21:24:55.277

如果您从字面上搜索三个单词的出现，其中根本没有正则表达式模式，则根本不需要使用正则表达式 - 正如我写这个答案时@Bart所建议的那样：)。像这样的东西可能会起作用（未经测试，并且可能更漂亮）：

```
with open('...') as f:
    contents = f.read()

words = ['word1', 'word2', 'word3']
matches = []
start_idx = 0
try:
    while True:
        cand = []
        for word in words:
            word_idx = contents.index(word, start_idx)
            cand.append(word_idx)
            start_idx = word_idx + len(word)
        matches.append(cand)
except ValueError:  # from index() failing
    pass 
```

这会将索引放入`matches`; 如果你想要一个与 findall 等效的结果，你可以这样做，说，

```
found = [contents[match[0]:match[-1]+len(words[-1]] for match in matches] 
```

`index`您还可以通过将调用替换为文件上的等效函数来使这种方法工作而无需事先读取整个文件。我不认为 stdlib 包含这样的功能；您可能必须在文件对象上手动使用`readline()`和`tell()`或类似的方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T21:07:11.950

发生这种情况的原因是因为 python 的正则表达式引擎使用回溯。在每个`.*`，如果没有找到下面的单词，引擎必须一直走到字符串的末尾（100kb）然后回溯。现在考虑如果在最后一场比赛之后有许多“几乎匹配”会发生什么。引擎从匹配开始到字符串结尾不断地来回跳跃。

您可以使用基于 NFA 而不是回溯的正则表达式引擎来修复它。请注意，这限制了您可以使用的正则表达式的种类（没有回溯或任意零宽度断言），但它适合您的用例。

[你可以在这里](https://pypi.python.org/pypi/re2/)找到这样的引擎。您可以在[www.debuggex.com](http://www.debuggex.com/?re=word1.%2a?word2.%2a?word3&str=word1%20word3%20word2%20word3%20word1%20word3word1%20word2%20word1%20word%202word3%20word1%20word2%20word2)上可视化 nfa 引擎的工作原理。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-05T05:46:40.653

您可以使用循环一次搜索一个单词。我在`str.find()`这里使用它是因为它对于简单的子字符串搜索更快，但您也可以调整此代码以`re.search()`代替使用。

```
def findstrings(text, words):
    end = 0
    while True:
        start = None
        for word in words:
            pos = text.find(word, end) #starts from position end
            if pos < 0:
                return
            if start is None:
                start = pos
            end = pos + len(word)
        yield text[start:end]

#usage in place of re.findall('word1.*?word2.*?word3', f.read(), re.DOTALL)
list(findstrings(f.read(), ['word1', 'word2', 'word3'])) 
```

# laravel - Laravel 4 beta3 和 beta4 之间 Input::json() 函数的变化

> ID：15820755
> 
> 赞同：8
> 
> 时间：2013-04-04T20:08:49.410
> 
> 标签：laravel, laravel-4

当我在 Laravel4 Beta3 中开发时，我曾经使用 Input::json() 函数从服务中获取 JSON POST 数据，但是当我更新到 Laravel4 Beta4 时，出现以下错误：

注意：未定义的属性：/Applications/MAMP/htdocs/commonDBAPI/app/controllers/UserController.php 第 47 行中的 Symfony\Component\HttpFoundation\ParameterBag::$productName

有没有人有任何想法，可能是什么原因。

谢谢，

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-04-11T11:59:01.740

您可以使用仅访问 JSON `Input::json()->all()`。

JSON 输入也被合并到`Input::all()`(and `Input::get('key', 'default')`) 中，因此您可以使用相同的接口来获取查询字符串数据、表单数据和 JSON 有效负载。

该文档尚未反映所有更改，因为 Laravel 4 仍处于测试阶段，并且重点是正确编写代码，文档将进行更新，为公开发布做好准备。

* * *

**JSON 如何与 Input::all() 合并？**

考虑以下 JSON：

```
{
    'name': 'Phill Sparks',
    'location': 'England',
    'skills': [
        'PHP',
        'MySQL',
        'Laravel'
    ],
    'jobs': [
        {
            'org': 'Laravel',
            'role': 'Quality Team',
            'since': 2012
        }
    ]
} 
```

当合并到 Laravel 的输入中时，JSON 被解码，顶级键成为输入中的顶级键。例如：

```
Input::get('name'); // string
Input::get('skills'); // array
Input::get('jobs.0'); // object
Input::all(); // Full structure of JSON, plus other input 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T23:34:40.837

是的，他们将其更改为返回一个 ParameterBag 对象，将您的代码切换为 Input::json()->all()

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-05-26T23:42:39.417

For : { "name":"Olivier", "title":"Just a try" }

试试这个 ：

$input = 输入::json()->all();

返回 $input['name'];

# matlab - 连接元胞数组中的两列值

> ID：15820758
> 
> 赞同：0
> 
> 时间：2013-04-04T20:08:56.020
> 
> 标签：matlab, cell-array

我有一个单元格数组：

```
cellArray = {
   '123' 'BC' 'other value';
   '124' 'BC' 'other value';
   '125' 'BC' 'other value';
   '126' 'BC' 'other value';
} 
```

我想得到这个：

```
cellArray = {
   '123 BC' 'other value';
   '124 BC' 'other value';
   '125 BC' 'other value';
   '126 BC' 'other value';
} 
```

如您所见，第二列现在连接到第一列......有什么建议吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-04T20:12:51.567

看起来`strcat`加上标准单元阵列连接可以做到这一点：

```
x = [strcat(cellArray(:,1), {' '}, cellArray(:,2)) cellArray(:,3)] 
```

唯一的技巧是中间空格字符需要在单元格中，否则会`strcat`尝试通过删除尾随空格来“帮助”。见`help strcat`解释。

# c# - 使用 Moq 在单元测试中模拟执行延迟

> ID：15820760
> 
> 赞同：24
> 
> 时间：2013-04-04T20:09:02.847
> 
> 标签：c#, unit-testing, moq, mstest

我正在尝试测试以下内容：

```
protected IHealthStatus VerifyMessage(ISubscriber destination)
{
    var status = new HeartBeatStatus();

    var task = new Task<CheckResult>(() =>
    {
        Console.WriteLine("VerifyMessage(Start): {0} - {1}", DateTime.Now, WarningTimeout);
        Thread.Sleep(WarningTimeout - 500);
        Console.WriteLine("VerifyMessage(Success): {0}", DateTime.Now);
        if (CheckMessages(destination))
        {
            return CheckResult.Success;
        }

        Console.WriteLine("VerifyMessage(Pre-Warning): {0} - {1}", DateTime.Now, ErrorTimeout);
        Thread.Sleep(ErrorTimeout - 500);
        Console.WriteLine("VerifyMessage(Warning): {0}", DateTime.Now);
        if (CheckMessages(destination))
        {
            return CheckResult.Warning;
        }

        return CheckResult.Error;
    });

    task.Start();

    task.Wait();
    status.Status = task.Result;

    return status;
} 
```

使用以下单元测试：

```
public void HeartBeat_Should_ReturnWarning_When_MockReturnsWarning()
{
    // Arrange
    var heartbeat = new SocketToSocketHeartbeat(_sourceSubscriber.Object, _destinationSubscriber.Object);
    heartbeat.SetTaskConfiguration(this.ConfigurationHB1ToHB2_ValidConfiguration());

    // Simulate the message being delayed to destination subscriber.
    _destinationSubscriber.Setup(foo => foo.ReceivedMessages).Returns(DelayDelivery(3000, Message_HB1ToHB2()));

    // Act
    var healthStatus = heartbeat.Execute();

    // Assert
    Assert.AreEqual(CheckResult.Warning, healthStatus.Status);
} 
```

Message_HB1ToHB2() 只返回一个字符串，“延迟传递”方法是

```
private List<NcsMessage> DelayDelivery(int delay, string message)
{
    var sent = DateTime.Now;
    var msg = new NcsMessage()
    {
        SourceSubscriber = "HB1",
        DestinationSubscriber = "HB2",
        SentOrReceived = sent,
        Message = message
    };

    var messages = new List<NcsMessage>();
    messages.Add(msg);

    Console.WriteLine("DelayDelivery: {0}", DateTime.Now);
    Thread.Sleep(delay);
    Console.WriteLine("DelayDelivery: {0}", DateTime.Now);

    return messages;
} 
```

我使用 Moq 作为模拟框架，使用 MSTest 作为测试框架。每当我运行单元测试时，我都会得到以下输出：

```
DelayDelivery: 04/04/2013 15:50:33
DelayDelivery: 04/04/2013 15:50:36
VerifyMessage(Start): 04/04/2013 15:50:36 - 3000
VerifyMessage(Success): 04/04/2013 15:50:38 
```

除了在上述方法中使用 Thread.Sleep 的明显“代码气味”之外，单元测试的结果并不是我想要完成的。

谁能建议一种更好/更准确的方法来使用 Moq 框架来模拟消息“传递”的延迟。我省略了一些“胶水”代码，只包括了相关部分。让我知道我遗漏的内容是否会妨碍您理解问题。

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2013-04-05T10:20:57.983

如果您希望 Moq 模拟只是坐着什么也不做一段时间，您可以使用回调：

```
Mock<IFoo> mockFoo = new Mock<IFoo>();
mockFoo.Setup(f => f.Bar())
       .Callback(() => Thread.Sleep(1000))
       .Returns("test");

string result = mockFoo.Object.Bar(); // will take 1 second to return

Assert.AreEqual("test", result); 
```

我已经在 LinqPad 中尝试过，如果您调整`Thread.Sleep()`执行时间，则会相应地变化。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2016-10-11T03:06:15.070

当你设置你的模拟时，你可以告诉线程在返回函数中休眠：

```
Mock<IMyService> myService = new Mock<IMyService>();

myService.Setup(x => x.GetResultDelayed()).Returns(() => {
    Thread.Sleep(100);
    return "result";
}); 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2021-02-23T16:10:42.027

如果运行异步代码，Moq 可以通过第二个参数延迟响应`TimeSpan`

```
mockFooService
    .Setup(m => m.GetFooAsync())
    .ReturnsAsync(new Foo(), TimeSpan.FromMilliseconds(500)); // Delay return for 500 milliseconds. 
```

如果每次调用方法都需要指定不同的延迟，可以使用`.SetupSequence`like

```
mockFooService
    .SetupSequence(m => m.GetFooAsync())
    .Returns(new Foo())
    .Returns(Task.Run(async () => 
    {
        await Task.Delay(500) // Delay return for 500 milliseconds.
        return new Foo();
    }) 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-06-03T16:35:44.970

我无法让最小起订量版本工作，所以我最终做了这样的事情：

一个使用 WaitHandle 的小例子：

```
[TestFixture]
public class EventWaitHandleTests
{
    class Worker {
        private volatile bool _shouldStop;
        public EventWaitHandle WaitHandleExternal;

        public void DoWork ()
        {
            while (!_shouldStop)
            {
                Console.WriteLine("worker thread: working...");
                Thread.Sleep(1000);
                WaitHandleExternal.Set();
            }
        }

        public void RequestStop()
        {
            _shouldStop = true;
        }

    }

    [Test]
    public void WaitForHandleEventTest()
    {
        EventWaitHandle _waitHandle = new AutoResetEvent (false); // is signaled value change to true

        // start a thread which will after a small time set an event
        Worker workerObject = new Worker ();
        workerObject.WaitHandleExternal = _waitHandle;
        Thread workerThread = new Thread(workerObject.DoWork);

        // Start the worker thread.
        workerThread.Start();

        Console.WriteLine ("Waiting...");
        _waitHandle.WaitOne();                // Wait for notification
        Console.WriteLine ("Notified");

        // Stop the worker thread.
        workerObject.RequestStop();

    }

} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-10-14T15:53:22.713

我喜欢并投票支持 serup 的解决方案。我的答案是他的一个版本被转换为图书馆。

```
using System;
using System.Threading.Tasks;
using Microsoft.VisualStudio.TestTools.UnitTesting;

/// <summary>
/// support halting a workflow and waiting for a finish request
/// </summary>
public class MockWorker
{
    private readonly DateTime? _end;
    private volatile bool _shouldStop;

    /// <summary>
    /// Create a worker object
    /// </summary>
    /// <param name="timeoutInMilliseconds">How long before DoWork will timeout.  default - Null will not timeout.</param>
    public MockWorker(int? timeoutInMilliseconds = null)
    {
        if (timeoutInMilliseconds.HasValue)
            _end = DateTime.Now.AddMilliseconds(timeoutInMilliseconds.Value);
    }

    /// <summary>
    /// Instruct DoWork to complete
    /// </summary>
    public void RequestStop()
    {
        _shouldStop = true;
    }

    /// <summary>
    /// Do work async will run until either timeoutInMilliseconds is exceeded or RequestStop is called.
    /// </summary>
    public async Task DoWorkAsync()
    {
        while (!_shouldStop)
        {
            await Task.Delay(100);
            if (_end.HasValue && _end.Value < DateTime.Now)
                throw new AssertFailedException("Timeout");
        }
    }

    /// <summary>
    /// Do work async will run until either timeoutInMilliseconds is exceeded or RequestStop is called.
    /// </summary>
    /// <typeparam name="T">Type of value to return</typeparam>
    /// <param name="valueToReturn">The value to be returned</param>
    /// <returns>valueToReturn</returns>
    public async Task<T> DoWorkAsync<T>(T valueToReturn)
    {
        await DoWorkAsync();
        return valueToReturn;
    }
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-02-14T22:08:16.197

我有类似的情况，但是使用了 Async 方法。对我有用的是执行以下操作：

```
 mock_object.Setup(scheduler => scheduler.MakeJobAsync())
  .Returns(Task.Run(()=> { Thread.Sleep(50000); return Guid.NewGuid().ToString(); })); 
```

# jquery - 如何获取 CSS 动态更改的值？

> ID：15820763
> 
> 赞同：0
> 
> 时间：2013-04-04T20:09:16.673
> 
> 标签：jquery, jquery-animate

我有一个 div，当我将链接悬停时，它会一直使用 div 向左设置动画，`.animate()`而当 mouseout 时它会停止动画。

当它动画时，它会`style="left:x"`在 div 中添加 a，其中 x 是实际值。

我试图获得这个值，但它不起作用。

我试过这个：

```
var posicao = $('#conteudo').css('left');

$('a').click(function(e)({
    e.preventDefault();
    console.log(posicao);
}); 
```

但它返回值`auto`。在 css 文件中，我什至没有将值设置为`left`..

其实我有两个问题。

*   如何获得这个值？
*   `auto`如果我什至没有将值设置为 left，为什么它会返回？

编辑***这里是链接[http://www.estudiocaju.com.br/homolog/dicavalcanti/teste/](http://www.estudiocaju.com.br/homolog/dicavalcanti/teste/) 左右有 2 个黑条。如果您将它们悬停`.animate()`在该`#conteudo`部分。如果您单击该`<header>`区域，它将`console.log(posicao)`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T20:37:48.163

```
var posicao = $('#conteudo').position().left; 
```

?

PS：你应该在 click 事件中使用它，否则该值将存储在 document load 上，当它始终为 0 时。像这样：

```
$('a').click(function(e)({
    e.preventDefault();
    var posicao = $('#conteudo').position().left;
    console.log(posicao);
}); 
```

# ruby-on-rails - Ruby on Rails 教程：7.1.3 使用 mysql 找不到表“用户”

> ID：15820765
> 
> 赞同：0
> 
> 时间：2013-04-04T20:09:17.253
> 
> 标签：ruby-on-rails

这个问题与在执行任何数据库操作之前在 Rails 中从 sqlite 切换到 mysql 相关，同时遵循 Ruby on Rails 教程（第 2 版）。

在使用 Ruby on Rails 教程（第 2 版）进行任何数据库操作之前，我将 config/database.yml 中的数据库参数切换为使用 mysql。在第 7.1.3 节之前，一切都在工作。至此，`users`表已创建完毕，示例用户已成功添加到表中。但是，当我去测试显示用户页面时，`users/1`我收到以下错误消息。使用 mysql 数据库而不是 sqlite 时，还有什么需要做的吗？预先感谢您的任何支持！

错误：

```
ActiveRecord::StatementInvalid in UsersController#show

Could not find table 'users' 
```

完整跟踪：

```
activerecord (3.2.11) lib/active_record/connection_adapters/sqlite_adapter.rb:472:in `table_structure'
activerecord (3.2.11) lib/active_record/connection_adapters/sqlite_adapter.rb:346:in `columns'
activerecord (3.2.11) lib/active_record/connection_adapters/schema_cache.rb:12:in `block in initialize'
activerecord (3.2.11) lib/active_record/model_schema.rb:228:in `yield'
activerecord (3.2.11) lib/active_record/model_schema.rb:228:in `default'
activerecord (3.2.11) lib/active_record/model_schema.rb:228:in `columns'
activerecord (3.2.11) lib/active_record/model_schema.rb:237:in `columns_hash'
activerecord (3.2.11) lib/active_record/relation/delegation.rb:7:in `columns_hash'
activerecord (3.2.11) lib/active_record/relation/finder_methods.rb:331:in `find_one'
activerecord (3.2.11) lib/active_record/relation/finder_methods.rb:312:in `find_with_ids'
activerecord (3.2.11) lib/active_record/relation/finder_methods.rb:107:in `find'
activerecord (3.2.11) lib/active_record/querying.rb:5:in `find'
app/controllers/users_controller.rb:4:in `show'
actionpack (3.2.11) lib/action_controller/metal/implicit_render.rb:4:in `send_action'
actionpack (3.2.11) lib/abstract_controller/base.rb:167:in `process_action'
actionpack (3.2.11) lib/action_controller/metal/rendering.rb:10:in `process_action'
actionpack (3.2.11) lib/abstract_controller/callbacks.rb:18:in `block in process_action'
activesupport (3.2.11) lib/active_support/callbacks.rb:414:in `_run__1973165003296325481__process_action__197160741547540830__callbacks'
activesupport (3.2.11) lib/active_support/callbacks.rb:405:in `__run_callback'
activesupport (3.2.11) lib/active_support/callbacks.rb:385:in `_run_process_action_callbacks'
activesupport (3.2.11) lib/active_support/callbacks.rb:81:in `run_callbacks'
actionpack (3.2.11) lib/abstract_controller/callbacks.rb:17:in `process_action'
actionpack (3.2.11) lib/action_controller/metal/rescue.rb:29:in `process_action'
actionpack (3.2.11) lib/action_controller/metal/instrumentation.rb:30:in `block in process_action'
activesupport (3.2.11) lib/active_support/notifications.rb:123:in `block in instrument'
activesupport (3.2.11) lib/active_support/notifications/instrumenter.rb:20:in `instrument'
activesupport (3.2.11) lib/active_support/notifications.rb:123:in `instrument'
actionpack (3.2.11) lib/action_controller/metal/instrumentation.rb:29:in `process_action'
actionpack (3.2.11) lib/action_controller/metal/params_wrapper.rb:207:in `process_action'
activerecord (3.2.11) lib/active_record/railties/controller_runtime.rb:18:in `process_action'
actionpack (3.2.11) lib/abstract_controller/base.rb:121:in `process'
actionpack (3.2.11) lib/abstract_controller/rendering.rb:45:in `process'
actionpack (3.2.11) lib/action_controller/metal.rb:203:in `dispatch'
actionpack (3.2.11) lib/action_controller/metal/rack_delegation.rb:14:in `dispatch'
actionpack (3.2.11) lib/action_controller/metal.rb:246:in `block in action'
actionpack (3.2.11) lib/action_dispatch/routing/route_set.rb:73:in `call'
actionpack (3.2.11) lib/action_dispatch/routing/route_set.rb:73:in `dispatch'
actionpack (3.2.11) lib/action_dispatch/routing/route_set.rb:36:in `call'
journey (1.0.4) lib/journey/router.rb:68:in `block in call'
journey (1.0.4) lib/journey/router.rb:56:in `each'
journey (1.0.4) lib/journey/router.rb:56:in `call'
actionpack (3.2.11) lib/action_dispatch/routing/route_set.rb:601:in `call'
actionpack (3.2.11) lib/action_dispatch/middleware/best_standards_support.rb:17:in `call'
rack (1.4.5) lib/rack/etag.rb:23:in `call'
rack (1.4.5) lib/rack/conditionalget.rb:25:in `call'
actionpack (3.2.11) lib/action_dispatch/middleware/head.rb:14:in `call'
actionpack (3.2.11) lib/action_dispatch/middleware/params_parser.rb:21:in `call'
actionpack (3.2.11) lib/action_dispatch/middleware/flash.rb:242:in `call'
rack (1.4.5) lib/rack/session/abstract/id.rb:210:in `context'
rack (1.4.5) lib/rack/session/abstract/id.rb:205:in `call'
actionpack (3.2.11) lib/action_dispatch/middleware/cookies.rb:341:in `call'
activerecord (3.2.11) lib/active_record/query_cache.rb:64:in `call'
activerecord (3.2.11) lib/active_record/connection_adapters/abstract/connection_pool.rb:479:in `call'
actionpack (3.2.11) lib/action_dispatch/middleware/callbacks.rb:28:in `block in call'
activesupport (3.2.11) lib/active_support/callbacks.rb:405:in `_run__2423197318852707609__call__2019361553739003282__callbacks'
activesupport (3.2.11) lib/active_support/callbacks.rb:405:in `__run_callback'
activesupport (3.2.11) lib/active_support/callbacks.rb:385:in `_run_call_callbacks'
activesupport (3.2.11) lib/active_support/callbacks.rb:81:in `run_callbacks'
actionpack (3.2.11) lib/action_dispatch/middleware/callbacks.rb:27:in `call'
actionpack (3.2.11) lib/action_dispatch/middleware/reloader.rb:65:in `call'
actionpack (3.2.11) lib/action_dispatch/middleware/remote_ip.rb:31:in `call'
actionpack (3.2.11) lib/action_dispatch/middleware/debug_exceptions.rb:16:in `call'
actionpack (3.2.11) lib/action_dispatch/middleware/show_exceptions.rb:56:in `call'
railties (3.2.11) lib/rails/rack/logger.rb:32:in `call_app'
railties (3.2.11) lib/rails/rack/logger.rb:16:in `block in call'
activesupport (3.2.11) lib/active_support/tagged_logging.rb:22:in `tagged'
railties (3.2.11) lib/rails/rack/logger.rb:16:in `call'
actionpack (3.2.11) lib/action_dispatch/middleware/request_id.rb:22:in `call'
rack (1.4.5) lib/rack/methodoverride.rb:21:in `call'
rack (1.4.5) lib/rack/runtime.rb:17:in `call'
activesupport (3.2.11) lib/active_support/cache/strategy/local_cache.rb:72:in `call'
rack (1.4.5) lib/rack/lock.rb:15:in `call'
actionpack (3.2.11) lib/action_dispatch/middleware/static.rb:62:in `call'
railties (3.2.11) lib/rails/engine.rb:479:in `call'
railties (3.2.11) lib/rails/application.rb:223:in `call'
rack (1.4.5) lib/rack/content_length.rb:14:in `call'
rack (1.4.5) lib/rack/handler/webrick.rb:59:in `service'
/opt/bitnami/ruby/lib/ruby/1.9.1/webrick/httpserver.rb:138:in `service'
/opt/bitnami/ruby/lib/ruby/1.9.1/webrick/httpserver.rb:94:in `run'
/opt/bitnami/ruby/lib/ruby/1.9.1/webrick/server.rb:191:in `block in start_thread' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T20:17:01.770

从您提供的堆栈跟踪来看，您的应用似乎没有指向您的 mysql 数据库。

`activerecord (3.2.11) lib/active_record/connection_adapters/sqlite_adapter.rb:472:in`table_structure'` <--指向 sqlite_adapter 而不是 mysql 适配器

确保您使用`mysql2`gem 并且不要忘记`bundle install`在修改 gemfile 后运行。还要确保在修改 database.yml 文件后重新启动服务器。

# python - Python FTP“ERRNO 10054”顺序文件下载

> ID：15820767
> 
> 赞同：2
> 
> 时间：2013-04-04T20:09:19.683
> 
> 标签：python, python-2.7, ftp, ibm-midrange, ftplib

我编写了一些代码来登录到一个 AS/400 FTP 站点，移动到某个目录，并找到我需要下载的文件。它有效，但似乎有很多文件要下载时我收到：

```
socket.error: [Errno 10054] An existing connection was 
              forcibly closed by the remote host 
```

我登录并成功导航到相应的目录：

```
try:
    newSession = ftplib.FTP(URL,username,password)
    newSession.set_debuglevel(3)
    newSession.cwd("SOME DIRECTORY")
except ftplib.all_errors, e:
    print str(e).split(None,1)
    sys.exit(0) 
```

我获取了我需要的文件列表：

```
filesToDownload= filter(lambda x: "SOME_FILE_PREFIX" in x, newSession.nlst()) 
```

这就是它正在死去的地方（特别是`newSession.retrbinary('RETR '+f,tempFileVar.write)`）：

```
for f in filesToDownload:
    newLocalFileName = f + ".edi"
newLocalFilePath = os.path.join(directory,newLocalFileName)
tempFileVar = open(newLocalFilePath,'wb')
newSession.retrbinary('RETR '+f,tempFileVar.write)
tempFileVar.close() 
```

它在我被击中之前下载了我需要的文件的 85% 以上，`Errno 10054`我想我只是对为什么它在如此接近完成时似乎任意死亡感到困惑。我现在诚实的猜测是尝试提取这些文件时对 FTP 的请求太多。

这是出现在我的命令提示符上的错误截图：

![在此处输入图像描述](https://i.stack.imgur.com/0WVcI.png)

任何建议或指示都会很棒。我仍在尝试解决此问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-09T18:48:38.177

我想这个问题没有真正的答案，似乎客户端的 FTP 有问题，它非常不稳定。我能做的最好的事情是围绕捕获抛出的套接字错误并在被强制断开之前恢复我在上一个会话中中断的地方进行处理。客户的 IT 团队最终正在调查他们的问题。

叹。

# c# - AxaptaContainerWrapper 类 .net AX 2009

> ID：15820769
> 
> 赞同：0
> 
> 时间：2013-04-04T20:09:24.150
> 
> 标签：c#, .net, axapta

我想`AxaptaContainerWrapper`在 .net c# 中使用对象。我不理解 MSDN 网站 ( [http://msdn.microsoft.com/en-us/library/cc519742%28v=ax.50%29.aspx](http://msdn.microsoft.com/en-us/library/cc519742%28v=ax.50%29.aspx) ) 上的文档。

AxaptaContainerWrapper axCon；

```
string ret2 = "axCon";

axCon.Insert(1, ret2); 
```

在 VS 2008 中，我得到错误 Use of unassigned local variable`axCon`

为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T21:23:53.423

您应该使用 axaptaWrapper.CreateAxaptaObject() 方法：[msdn](http://msdn.microsoft.com/en-us/library/cc599500.aspx)

```
AxaptaWrapper aw= SessionManager.GetSession();
AxaptaObjectWrapper aow= ax.CreateAxaptaObject("??"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T08:09:02.403

我在下面写了代码，我没有任何错误。我必须做所有报告来测试它

```
 AxaptaWrapper ax = SessionManager.GetSession();
    AxaptaObjectWrapper axClass;

    AxaptaContainerWrapper axCon = ax.CreateAxaptaContainer(); 
```

# xcode - UISearch 栏总是显示：没有结果

> ID：15820772
> 
> 赞同：2
> 
> 时间：2013-04-04T20:09:28.990
> 
> 标签：xcode, sqlite, nsdictionary, uisearchdisplaycontroller

在我的应用程序中，我成功显示来自 sqlite 数据库的数据，并在另一个表中`uitableview`插入`UISearchbar`并`display controller`显示搜索结果，问题是当我键入要搜索的字符串时，它总是返回：即使该字符串存在于该表中也没有结果！！

我认为我的方法有问题， `(void)searchBar:(UISearchBar *)searchBar textDidChange:(NSString *)searchText`但我不知道到底是什么问题以及如何处理它！这是我的代码：

MasterViewControllerViewController.m：

```
#import "MasterViewControllerViewController.h"
#import"MasterViewControllerAppDelegate.h"

#import"SingleStudent.h"

- (void)viewDidLoad {

MasterViewControllerAppDelegate* appDelegate =(MasterViewControllerAppDelegate*)[[UIApplication sharedApplication]delegate];
maListe = [[NSMutableArray alloc] init];
tampon = [[NSMutableArray alloc] init];
[maListe addObjectsFromArray:appDelegate.aryDatabase];
[tampon addObjectsFromArray:maListe];
 [super viewDidLoad];
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath

{static NSString *CellIdentifier = @"Cell";

UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
if (cell == nil) 
{
    cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];
}
MasterViewControllerAppDelegate* appDelegate =(MasterViewControllerAppDelegate*)[[UIApplication sharedApplication]delegate];
SingleStudent* sStudent =[appDelegate.aryDatabase objectAtIndex:indexPath.row];

cell.textLabel.text = [sStudent strName];
// Configure the cell.

return cell;
}

- (void)searchBar:(UISearchBar *)searchBar textDidChange:(NSString *)searchText
{

tampon2 = [[NSMutableArray alloc] init];

[tampon2 addObjectsFromArray:tampon];
[maListe removeAllObjects];
if([searchText isEqualToString:@""])
{
    [maListe removeAllObjects];
    [maListe addObjectsFromArray:tampon]; // Restitution des données originales
    return;
}

for (NSDictionary *dict in tampon2 ){
      NSString *name = [NSString stringWithFormat:@"%@", dict];

        NSRange  range = [name rangeOfString:searchText options:NSCaseInsensitiveSearch];
        if (range.location != NSNotFound)
        { 
            if(range.location== 0) // premiere lettre
                [maListe addObject:name];}
        }} 
```

MasterViewControllerAppDelegate.m

```
#import "MasterViewControllerAppDelegate.h"
#import "MasterViewControllerViewController.h"
#import "SingleStudent.h"

-(void)updateNames {

databaseName = @"students7.sqlite";
NSArray* documentsPath= NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
NSString* documentsDir =[documentsPath objectAtIndex:0];
databasePath = [documentsDir stringByAppendingPathComponent:databaseName];}

-(void)checkAndCreateDatabase {

BOOL success;
NSFileManager* fileManager = [NSFileManager defaultManager];
success = [fileManager fileExistsAtPath:databasePath];
if (success) {
    return;
}
NSString* databasePathFromApp = [[[NSBundle mainBundle] resourcePath] stringByAppendingPathComponent:databaseName];
[fileManager copyItemAtPath:databasePathFromApp toPath:databasePath error:nil];

}

-(void)readWordsFromDatabase{     

    db = [FMDatabase databaseWithPath:databasePath];
aryDatabase = [[NSMutableArray alloc] init];
[db setLogsErrors:TRUE];
[db setTraceExecution:TRUE];
if (![db open]) {
    NSLog(@"failed to open database");
    return;
}
else {
    NSLog(@"Opened database successfully");
}
FMResultSet* rs = [db executeQuery:@"SELECT * FROM student"];
while ([rs next]) {
    int aID = [rs intForColumn:@"id"];
    int aPK = [rs intForColumn:@"pk"];
    NSString* aName = [rs stringForColumn:@"name"];

    SingleStudent* sStudent = [[SingleStudent alloc] initWithData:aPK :aID :aName];
    [aryDatabase addObject:sStudent];
    [sStudent release];

}
[db close];

} 
```

单身学生.m

```
-(id)initWithData:(int)pK :(int)aId :(NSString*)name`
{

self.intPK = pK;
self.intId = aId;
self.strName = name;
return self;} 
```

我怎么解决这个问题 ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-06T07:59:19.483

我将我的代码更改为此，如果有一天有人需要它，它可以在这里正常工作：

```
- (void)viewDidLoad {

maListe = [[NSMutableArray alloc] init];
tampon = [[NSMutableArray alloc] init];
int i;
for (i=0 ; i <= 4; i++) {

 MasterViewControllerAppDelegate* appDelegate=(MasterViewControllerAppDelegate*)[[UIApplication sharedApplication]delegate];
SingleStudent* sStudent=[appDelegate.aryDatabase objectAtIndex:i];

[maListe addObject:[sStudent strName]];

    }
[tampon addObjectsFromArray:maListe];

[super viewDidLoad];
    }
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath{

static NSString *CellIdentifier = @"Cell";
UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
if (cell == nil) 
{
    cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];
}
//MasterViewControllerAppDelegate* appDelegate =(MasterViewControllerAppDelegate*)[[UIApplication sharedApplication]delegate];
//SingleStudent* sStudent =[appDelegate.aryDatabase objectAtIndex:indexPath.row];
//NSString *cellValue = [sStudent strName];
NSString *cellValue = [maListe objectAtIndex:indexPath.row];
cell.textLabel.text = cellValue;
// Configure the cell.
/*NSString *cellValue = [maListe objectAtIndex:indexPath.row];
cell.textLabel.text = cellValue;*/

return cell;}

- (void)searchBar:(UISearchBar *)searchBar textDidChange:(NSString *)searchText

{

tampon2 = [[NSMutableArray alloc] init];
[tampon2 addObjectsFromArray:tampon];
[maListe removeAllObjects];
if([searchText isEqualToString:@""])
{
    [maListe removeAllObjects];
    [maListe addObjectsFromArray:tampon]; // Restitution des données originales
    return;
}

for(NSString *name in tampon2)
{

            NSRange r = [name rangeOfString:searchText];
    if(r.location != NSNotFound)
    {
        if(r.location== 0) // premiere lettre
        [maListe addObject:name];
    }
}
} 
```

# java - 什么时候设置 Ant 路径引用？

> ID：15820773
> 
> 赞同：0
> 
> 时间：2013-04-04T20:09:31.303
> 
> 标签：java, ant, build

当我使用路径引用 ID 时，Ant 似乎会在任何任务运行之前评估定义中的任何变量。例如，`${common.dist}`以下`${common.lib}`似乎在任何任务运行之前进行评估。

```
<path id="compile.classpath">
      <fileset dir="lib">
         <include name="*.jar" />
      </fileset>
      <fileset dir="${common.dist}">
         <include name="*.jar" />
      </fileset>
      <fileset dir="${common.lib}">
         <include name="*.jar" />
      </fileset>
</path> 
```

在 Ant 输出中，我看到如下内容：

```
Adding reference: compile.classpath
Property "common.dist" has not been set
Property "common.lib" has not been set
...
Build sequence for target(s) `package' is [...]
Complete build sequence is [...] 
```

这使得在运行任何目标之前似乎正在处理路径引用。

我有一个这样的编译目标：

```
 <target name="compile" depends="init,common">
    <javac destdir="build/classes" debug="true" deprecation="true" optimize="true">
      <src path="src/java" />
      <classpath>
        <path refid="compile.classpath" />
      </classpath>
    </javac>
  </target> 
```

如果我将路径引用的内容复制到编译目标内的类路径元素中，事情似乎工作正常。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T20:58:25.507

答案在[Ant 手册路径中，如结构](http://ant.apache.org/manual/using.html#path)：

> **默认情况下，类似结构的路径将在使用时重新评估所有嵌套资源集合**，这可能会导致对文件系统进行不必要的重新扫描...

我想你可能忘了设置 ${common.dist} 和 ${common.lib} 属性。它们应该在任何目标之外：

```
<property name="common.dist" location="dist"/>
<property name="common.lib" location="lib"/> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-04T21:19:27.253

`build.xml`在运行任何目标之前，目标之外的任何任务都会在每个构建中执行，按照出现的顺序。如果要在`<path>`目标外部定义的属性中使用属性，则需要将`<property>`定义属性的任务也放在目标之外，并且在`<path>`. 如果您需要在目标中加载属性，那么您也必须将`<path>`定义放入目标中（相同的定义或在定义属性的定义之后运行的定义）。

有关更多详细信息，请参阅[此问题](https://stackoverflow.com/q/15788306/592139)（和我的答案）。

# python - 从大型数据库（> 1GB）读取时出现 SQLite3 内存错误

> ID：15820776
> 
> 赞同：0
> 
> 时间：2013-04-04T20:09:35.220
> 
> 标签：python, eclipse, memory, sqlite

我有一个小的 Python 2.7 脚本，它使用 LIKE 语句从存储在 SQLite 数据库中的文本数据中提取信息片段。

```
sql = "SELECT user_id, loc,\
        FROM entity\
        WHERE loc LIKE '%\"place\":%'\
        AND loc LIKE '%\"geo\":%'\
    AND loc LIKE '%\"coordinates\":%'" 
cin.execute(sql)
entities = cin.fetchall() 
```

`cin`是 SQLite 数据库（`entity`>10^6 行的表）（~1.5GB）的游标，它是使用建立的

```
import sqlite3
try:
    dbin = sqlite3.connect(database=args['dbi'].name)
    dbin.row_factory = sqlite3.Row
    cin = dbin.cursor()
except sqlite3.Error, e:
    errorLogger.error('... %e' % e)
    sys.exit() 
```

该脚本运行良好，数据库大小为 10^2 MB，但现在我得到了

```
Traceback (most recent call last):
  File "C:\Users\...\migrate.py", line 247, in <module>
    entities = cin.fetchall()
MemoryError 
```

几秒钟后。*我正在运行具有 8GB RAM 的 W7 64 位机器*。当脚本运行时，通过查看 W7 的资源监视器，我可以看出，在程序崩溃之前，所有空闲内存都已连续使用，python.exe 消耗多达 1.9GB。尽管如此，仍然有大约 3GB 的备用内存可用（但不要问我备用内存和空闲内存有什么区别）。

除了预先过滤我的查询之外，我还能做些什么，例如，仅查看每个查询 10'000 行？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T21:28:14.630

调用`fetchall`需要为所有结果记录分配内存。

您应该`cin`一一读取结果记录。

# java - 从 Java 写入 XML 文档 - 简单

> ID：15820779
> 
> 赞同：3
> 
> 时间：2013-04-04T20:09:42.777
> 
> 标签：java, xml, xml-parsing, printwriter, bufferedwriter

我知道在 stackoverflow 上从 Java 到 XML 的编写有很多问题，但这太复杂了。我觉得我有一个非常简单的问题，我就是想不通。

因此，我有一个程序需要大量用户输入，并且我目前正在创建并附加一个带有结果的文本文档。我将在这里发布我的编写器代码：

```
 PrintWriter out = null;
         try {
             out = new PrintWriter(new BufferedWriter(new FileWriter("C:/Documents and Settings/blank/My Documents/test/test.txt", true)));
             out.println("");
             out.println("<event title=\""+titleFieldUI+"\"");
             out.println("  start=\""+monthLongUI+" "+dayLongUI+" "+yearLongUI+" 00:00:00 EST"+"\"");            
             out.println("  isDuration=\"true\"");
             out.println("  color=\""+sValue+"\"");
             out.println("  end=\""+monthLong1UI+" "+dayLong1UI+" "+yearLong1UI+" 00:00:00 EST"+"\"");
             out.println("  "+descriptionUI);
             out.println("");
             out.println("</event>");
             out.println("  <!-- Above event added by: " +System.getProperty("user.name")+" " +
                        "on: "+month+"/"+day+"/"+year+" -->");       
         }catch (IOException e) {
             System.err.println(e);
         }finally{
             if(out != null){
                 out.close();
             }
         } 
```

所以最后，我希望它写入一个已经存在的 XML 文件（我可以通过简单地改变我的作家去的地方来做到这一点）。问题是，这个 XML 文件有一个根标签，称为`<data>`. 我需要将程序的结果放在 XML 文件的底部，但要在 BEFORE 之前`</data>`。这是唯一的要求。我发现的一切似乎都太复杂了，我无法弄清楚..

很感谢任何形式的帮助！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-04T20:18:42.853

您应该使用体面的 XML API。例如，这是一个使用[JDOM](http://www.jdom.org/)的示例：

```
import java.io.*;

import org.jdom2.*;
import org.jdom2.input.*;
import org.jdom2.output.*;

public class Test {
    public static void main(String args[]) throws IOException, JDOMException {
        File input = new File("input.xml"); 
        Document document = new SAXBuilder().build(input);
        Element element = new Element("event");
        element.setAttribute("title", "foo");
        // etc...
        document.getRootElement().addContent(element);

        // Java 7 try-with-resources statement; use a try/finally
        // block to close the output stream if you're not using Java 7
        try(OutputStream out = new FileOutputStream("output.xml")) {
            new XMLOutputter().output(document, out);
        }
    }
} 
```

这*真的*没那么难......而且它会比手动写出来要强大得多。（例如，如果您的事件标题包含“&”，这将做正确的事情 - 而您的代码会产生无效的 XML。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-04T20:14:34.967

如果你喜欢[fluent api](http://en.wikipedia.org/wiki/Fluent_interface)，那么你可以使用[JOOX](https://code.google.com/p/joox/)：

```
File file = new File("projects.xml");

Document document = $(file).document();

Comment eventComment = document.createComment("Above event added by: "
        + System.getProperty("user.name") + "\n" +
        " on: " + month + "/" + day + "/" + year);

document = $(file)
        .xpath("//data")
        .append($("event",
                $("title", "titleFieldUI"),
                $("start", monthLongUI + " " + dayLongUI + " " + yearLongUI + " 00:00:00 EST"),
                $("isDuration", "true"),
                $("color", sValue),
                $("end", monthLong1UI + " " + dayLong1UI + " " + yearLong1UI + " 00:00:00 EST")))
        .append($(eventComment))
        .document();

Transformer transformer = TransformerFactory.newInstance().newTransformer();
Result output = new StreamResult(file);
Source input = new DOMSource(document);

transformer.transform(input, output); 
```

或[XMLBuilder](https://code.google.com/p/java-xmlbuilder/)

```
XMLBuilder builder = XMLBuilder.parse(
        new InputSource(new FileReader("C:/Documents and Settings/blank/My Documents/test/test.txt")))
        .xpathFind("//data")
        .e("event")
        .a("title", titleFieldUI)
        .a("start", monthLongUI + " " + dayLongUI + " " + yearLongUI + " 00:00:00 EST")
        .a("isDuration", "true")
        .a("color", sValue)
        .a("end", monthLong1UI + " " + dayLong1UI + " " + yearLong1UI + " 00:00:00 EST")
        .up()
        .comment("Above event added by: " + System.getProperty("user.name") + "\n" +
                " on: " + month + "/" + day + "/" + year);

PrintWriter writer = new PrintWriter(new FileOutputStream("C:/Documents and Settings/blank/My Documents/test/test.txt"));
builder.toWriter(writer, new Properties()); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-04T21:46:26.550

你可以使用[JOOX](https://code.google.com/p/joox/ "JOOX")。这是你将如何做一个追加：

```
DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();
DocumentBuilder parser = factory.newDocumentBuilder();
Document doc = parser.parse("/pathToXML");

JOOX.$(doc).append("<newNode>data<newNode>"); 
```

默认情况下 $(doc) 将加载根节点。如果你想要一个内部节点，你可以使用 find() 方法。该库的文档记录不是很好，但是作为开源，您可以随时直接查看源代码。

# javascript - jQuery 支持 ":invalid" 选择器

> ID：15820780
> 
> 赞同：15
> 
> 时间：2013-04-04T20:09:43.923
> 
> 标签：javascript, jquery, html, jquery-selectors

我收到以下控制台消息：

```
[16:04:01.292] Error: Syntax error, unrecognized expression: unsupported pseudo: invalid @ http://localhost:8080/assets/js/jquery-1.9.1.min.js:4 
```

当我尝试类似的事情时：

`if( $(e.target).is(':invalid') ){ ... }`

我该如何解决？

这是一个示例： http: [//jsfiddle.net/L4g99/](http://jsfiddle.net/L4g99/) - 尝试更改 jQuery 版本（1.9 后停止工作）

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-04-04T20:39:40.623

按照@JanDvorak 的建议使用`querySelectorAll`（考虑到这一点，他的回答应该被接受），您可以编写自己的表达式，使`.is(':invalid')`?

```
jQuery.extend(jQuery.expr[':'], {
    invalid : function(elem, index, match){
        var invalids = document.querySelectorAll(':invalid'),
            result = false,
            len = invalids.length;

        if (len) {
            for (var i=0; i<len; i++) {
                if (elem === invalids[i]) {
                    result = true;
                    break;
                }
            }
        }
        return result;
    }
}); 
```

现在你可以这样做：

```
if( $(e.target).is(':invalid') ){ ... } 
```

[**小提琴**](http://jsfiddle.net/qAmKa/2/)

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-04-04T20:41:03.283

`:invalid`实际上，它不是一个有效的 jQuery 选择器（伪类）。

但是，根据[您发布的链接](https://developer.mozilla.org/en-US/docs/CSS/:invalid)，它是一个有效的 CSS 选择器（IE<10 不支持）。

[Adeneo 的小提琴](http://jsfiddle.net/qAmKa/)表明，正如怀疑的那样，虽然它在 jQuery 中不起作用，但可以通过本机`querySelector`/`querySelectorAll`方法使用。所以，虽然这不起作用：

```
if($(e.target).is(":invalid"))  //SyntaxError 
```

这样做（IE<10 除外）：

```
if(~[].indexOf.call(document.querySelectorAll(":invalid"),e.target)) 
```

这也应该起作用（在将来或在必要的匀场之后；参见[caniuse](http://caniuse.com/#feat=matchesselector)）：

```
if(e.target.matches(":invalid")) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2018-01-11T16:22:08.530

您可以使用元素的`validity`属性（参见[MDN](https://developer.mozilla.org/en/docs/Web/API/ValidityState)）。

现在将它与@adeneo 的想法结合起来：

```
jQuery.extend(jQuery.expr[':'], {
    invalid : function(elem, index, match){
        return elem.validity !== undefined && elem.validity.valid === false;
    },

    valid : function(elem, index, match){
        return elem.validity !== undefined && elem.validity.valid === true;
    }

}); 
```

# python - 在 Flask 中使用 Twitter Bootstrap 单选按钮

> ID：15820788
> 
> 赞同：11
> 
> 时间：2013-04-04T20:09:59.990
> 
> 标签：python, twitter-bootstrap, flask, jinja2

我正在构建一个基于 Web 的仪表板，我想使用[Twitter Bootstrap](http://en.wikipedia.org/wiki/Twitter_Bootstrap)中的单选按钮来帮助创建查询，然后对[MongoDB](http://en.wikipedia.org/wiki/MongoDB)运行（通过[Flask](http://en.wikipedia.org/wiki/Flask_%28programming%29)），然后用新填充的数据刷新*同一页面。*我是构建基于 Web 的仪表板的新手，所以如果有更好的方法，请告诉我。

```
{% extends "base.html" %}

{% block content %}
<div class="row">
    <div class="span4 offset4">
        <div class="well">
            <legend>Click me!</legend>
            <form method="POST" action="" accept-charset="UTF-8">
                {% if error %}
                    <div class="alert alert-error">
                        <a class="close" data-dismiss="alert" href="#">x</a>{{ error }}
                    </div>
                {% endif %}

                <div id="radios1" class="btn-group view-opt-btn-group" data-toggle="buttons-radio">
                    <button type="button" class="btn active" name="choice1" value="A">A</button>
                    <button type="button" class="btn" name="choice1" value="B">B</button>
                    <button type="button" class="btn" name="choice1" value="C">C</button>
                    <button type="button" class="btn" name="choice1" value="D">D</button>
                    <button type="button" class="btn" name="choice1" value="E">E</button>
                    <input type="hidden" name="choice1" value={{request.form['choice1']}} />
                </div>

                <script type="text/jscript">
                    $("body").find("#radios1").children().each(function () {
                        $(this).bind('click', function () {
                            $("input[name=choice1]").val(this.value);
                            });
                    });
                </script>

                <button class="btn-info btn" input type="submit">Submit</button>
            </form>
        </div>
    </div>
</div>
{% endblock %} 
```

这会生成单选按钮并使用 JavaScript 代码来检测单击了哪个按钮，然后通过`request.Form`对象将该数据发送回以进行处理。

屏幕更新后，如何在每个按钮栏上设置活动框？我是否必须编写某种`{{if request.option1 == ?}}`块来`class="btn active"`为每个按钮定义，还是有更聪明（或更明显）的方式来做到这一点？另外，如何设置默认值/初始化条件？我应该预先填充请求对象中的相应字段吗？

另外，是否可以在不使用上面的 JavaScript 代码的情况下将选定的框传递给 Flask？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-04-11T18:08:06.657

如果你有大量类似的控件——最好的方法是为它们使用循环。假设我们使用 list 来存储所有按钮名称，以及其他活跃的按钮列表。这会给我们一些控制器：

```
from flask import render_template

@app.route('/form/')
def hello(name=None):
    return render_template('hello.html', buttons=['A', 'B', 'C'], active_btns=['A', 'C']) 
```

所以，在模板中，我们会有类似的东西：

```
<div id="radios1" class="btn-group view-opt-btn-group" data-toggle="buttons-radio">
{% for button in buttons %}
    {% if button in active_btns %}
        <button type="button" class="btn active" name="choice1" value="{{ button }}">{{ button }}</button>
    {% else %}
        <button type="button" class="btn" name="choice1" value="{{ button }}">{{ button }}</button>
    {% endif %}
{% endfor %}
</div> 
```

实际上，使用 Jinja 的 If 表达式可以简化 for 循环中的表达式，应该如下所示：

```
<button type="button" class="btn{{" active" if button in active_btns}}" name="choice1" value="{{ button }}">{{ button }}</button> 
```

但我现在没有 Jinja2，而且语法可能有误。

如果我没有正确回答您的问题-请写一些评论，我会尝试更新我的答案:)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-04-14T06:34:09.567

至于设置活动框，我不确定你的意思，但按钮标签属性[autofocus](http://www.w3schools.com/tags/att_button_autofocus.asp)可能会有所帮助。最初将这些字段留空可能是个好主意。

您可以使用以下 Flask 代码在不使用 JavaScript 的情况下将选定的框传递给 Flask（您的 HTML 当前已正确设置为在按下提交按钮时将请求传递给 Flask）：

```
from flask import Flask, render_template, request

@app.route("/", methods = ["GET", "POST"])
def home():
    if request.method == "POST":

        button = request.form['choice1'] #this retrieves which radio button was pressed

        if button == 'A': #if the button with attribute value = "A' is pressed
            #what you want to do when button A is pressed
        elif button == 'B':
            #what you want to do when button B is pressed
        elif button == 'C':
            #what you want to do when button C is pressed
        elif button == 'D':
            #what you want to do when button D is pressed
        elif button == 'E':
            #what you want to do when button E is pressed
    return render_template("home.html") 
```

# javascript - 动态改变ngView的内容

> ID：15820791
> 
> 赞同：0
> 
> 时间：2013-04-04T20:10:06.393
> 
> 标签：javascript, angularjs, angularjs-directive

我有一个要求，当请求某些 url 时，我需要更改视图并显示一些具有相应数据的统一视图。如果我可以手动添加路由以匹配这些 url，然后使用相同的`templateUrl`并`controller`呈现视图，这将很容易。

就我而言，它有点复杂。这些路线是动态生成的。简而言之，在我正在进行的项目中，我需要让用户 [开发人员实际上] 能够定义站点地图，并根据用户选择的某些标准，某个节点的子节点（具有动态生成的 url）将显示在菜单中或在通用视图中显示为图块。

我的菜单部分工作得很好。我仍然需要找到一种方法来提供`ngView`正确的模板和数据来渲染图块。这甚至可能吗？

**更新：**

我想我可以使用服务`otherwise`上的方法`$routeProvider`来实现类似的目标。文档说，当没有为某个 URL 定义路由时，会触发此方法。

如果有人能确认这是一个可能的解决方案，如果有更好的解决方案，我将不胜感激，请分享。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-10-10T09:39:15.017

我也有这个问题。请看看这是否有帮助。

HTML：

```
<a href="" class="btn btn-success" ng-click="changeView()">Switch View</a>
<div ng-include="viewTemplate"></div> 
```

控制器：

```
 $scope.changeView = function () {
            if ($scope.isParcelYearGrid) {
                $scope.viewTemplate = '../app/parcelMassEntry/parcelMassEntryGrid.html';
            }
            else {
                $scope.viewTemplate = '../app/parcelMassEntry/parcelMassEntry.html';
            }
        }; 
```

# functional-programming - let 定义系列

> ID：15820792
> 
> 赞同：3
> 
> 时间：2013-04-04T20:10:09.390
> 
> 标签：functional-programming, ocaml, let

我是 OCaml 的初学者，我对一系列 let 有疑问，例如：

```
let x = myFun y in
let z = myFun x in
... 
```

但是，在让之间，我使用 Hashtbl.iter 和其他返回单位的函数。如果我做：

```
let x = myFun y in
Hashtbl.iter (...) ...
let z = myFun x in
... 
```

编译器引发错误。但是，如果我这样做：

```
let x = myFun y in
let h = Hashtbl.iter (...) ...
let z = myFun x in
... 
```

编译器不会引发任何错误，只是警告显示从未使用过“h”。没有任何问题的最佳方法是什么？谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-04T20:20:31.167

您必须使用`;`来分隔表达式：

```
e1 ; e2 
```

这会执行副作用`e1`并丢弃结果，然后评估 `e2.

所以在你的情况下：

```
let x = myFun y in
Hashtbl.iter (...) ... ;
let z = myFun x in
... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-05T10:59:30.210

请注意，您可以写

```
let x = ... in
  let _ = Hashtbl.iter in ... 
```

# php - PHP 和 Node.js 的 FIFO 共享存储

> ID：15820793
> 
> 赞同：1
> 
> 时间：2013-04-04T20:10:12.787
> 
> 标签：php, apache, node.js, memcached, redis

我以前没有做过这种规模的项目，所以如果我走错了方向，请告知。

我需要有 5 到 700 个连接（来自移动电话），在同一个套接字上进行连接，并同时将小数据包传输到服务器（只有大约 20 个字符的 CSV 字符串）。没有数据需要返回到手机，所以只需要确认到达。需要处理数据并将其发送到主设备，我认为该设备将使用网络套接字。

多年来，我一直是 Apache/（CGI 和 PHP）专家，但我认为 Node.js 将成为收集数据的方式。只是一个简单的 IO 循环，它将捕获数据并发送一个简单的确认。我打算使用 C 和 PHP 进行更重的数字处理和服务。问题是从 node.js 服务器收集数据，并在 Apache 服务器上对其进行处理。

我在想Redis，但是具体对Redis不是很熟悉，所以不知道有没有FIFO的实现，也不需要写磁盘，因为数据会马上被删除。我现在正在考虑 memcached，但我仍然不知道不依赖于使用时间戳的 FIFO 实现（这可能是我最终必须使用的）。

有什么想法或建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T20:21:36.150

你在正确的轨道上！

您可以根据需要使用 redis 来实现[FIFO 队列](http://rediscookbook.org/implement_a_fifo_queue.html)。Node.JS 是这个应用程序的一个很好的前端，因为它需要最少的资源和最少的数据处理。

```
var redis = require("redis"),
    client = redis.createClient();

client.lpush("key","hello");
client.lpush("key","world"); 
```

然后，从命令行（或其他程序，例如您的 PHP 程序）：

```
$ redis-cli
redis 127.0.0.1:6379> rpop key
hello
redis 127.0.0.1:6379> rpop key
world 
```

我花了几个小时才从 php/database 的心态来理解 node 和 redis。不要放弃，你有正确的想法，你有正确的软件。

# facebook - Pinterest Pin It 按钮不适用于 Wordpress 博客上上传的图片

> ID：15820795
> 
> 赞同：1
> 
> 时间：2013-04-04T20:10:16.157
> 
> 标签：facebook, image, wordpress, pinterest

我最近从博主迁移到了 wordpress，但在使用图像时遇到了问题。

Pinterest 和 Facebook 都无法识别我上传到 wordpress 的新图像，但它们确实识别出直接从博主导入的旧图像，并且仍然指向博主。

当我尝试固定图像时，它允许我选择图像，但是当我单击“固定”时，它会显示“哎呀！抱歉，我们无法获取图像”。

使用 facebook，尝试共享链接，带有新上传图像的帖子不会加载任何缩略图，但是来自旧导入博客的图像会显示缩略图。

我检查了一个基于相同主题的朋友博客的固定，我可以固定他们的网站。我还检查了上传的图像是否在 iframe 中 - 它们不是。我已经用 pinterest 验证了我的网站。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-09-04T22:22:18.990

如果您在 facebook，只需右键单击您想要的图像，然后选择“复制 url”返回 pinterest，然后选择“从网站固定”。粘贴链接，瞧！你可以选择照片来固定它：D

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-27T16:26:39.557

我现在设法通过将图像上传到 photobucket 然后通过 url 链接到帖子来解决这个问题。因此，问题似乎在于它们需要托管在我的 wordpress 网站以外的其他地方。

如果其他人发布了一个不需要解决的更好的答案，那么我会接受他们的。

# c - 在C中找到第一行零nxn数组

> ID：15820799
> 
> 赞同：0
> 
> 时间：2013-04-04T20:10:33.373
> 
> 标签：c, multidimensional-array, goto, zero

我有一些伪代码可以在 nxm 矩阵中找到第一个全零行：

```
int first_zero_row = -1; /* none */
int i, j;
for(i=0; i<n; i++) {
    for (j=0; j<n; j++) {
       if (A[i][j]) goto next;
    }
    first_zero_row = i;
    break;
next: ;
} 
```

虽然这应该可行，但我不认为使用 goto 语句是最好的方法。我对 C 不是很熟悉，但我的目标是尽可能使代码在 C 中结构良好。这会是最好的方法吗，还是有更快或更通用的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T20:18:36.093

只`first_zero_row`在内部循环运行完成时设置，

```
int first_zero_row = -1; /* none */
int i, j;
for(i=0; i<n; i++) {
    for (j=0; j<n; j++) {
       if (A[i][j]) break;
    }
    if (j == n) {
        first_zero_row = i;
        break;
    }
} 
```

如果你想避免`goto`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T20:13:48.823

放置`break;`语句而不是 goto 语句。设置一个布尔标志并检查标志，如果标志为真，则也从外部 for 循环再次中断。像这样的东西-

```
bool nonZeroFlag = true;

for(i=0; i<n; i++) {
   for (j=0; j<n; j++) {
     if (A[i][j]){
        nonZeroFlag = false;
        break;
     }
   }
  if (nonZeroFlag) {
     first_zero_row = i;
     break;
  }
  nonZeroFlag = true;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-04T20:14:50.377

```
int first_zero_row = -1; /* none */
int i, j;
for(i=0; i<n; i++) {
    for (j=0; j<n; j++) {
       if (A[i][j] != 0){
           first_zero_row = i;
       } 
    }
    break;
next: ;
} 
```

这个怎么样？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-04T20:20:02.180

这是一个没有`break`或`goto`:)

```
int zero_count = -1; /* none */
i = j = 0;
for(i=0; i < n && (zero_count != n); i++) {
    for (j=0; j < n && (A[i][j] == 0); j++) {
       zero_count = j + 1;
    }
}

if(i < 10)
   printf("First Zero row is %d\n",i);
else
   printf("Nop! Not today!\n"); 
```

# c++ - sf::Shader 和 sf::RectangleShape

> ID：15820800
> 
> 赞同：0
> 
> 时间：2013-04-04T20:10:39.810
> 
> 标签：c++, sfml

我有一个关于使用`sf::Shape`SFML 图形库中的问题。在我的游戏中，我使用`sf::RectangleShapes`. 例如 UserInterface 或播放器。这是代码的和平：

```
std::unique_ptr<sf::RectangleShape> rect;
sf::RenderTarget &target;
sf::RenderStates &stats;

void SfUIComponents::SfBaseRectangle::draw()
{
        target.draw(*rect, stats);
} 
```

当我使用如下文件加载着色器时：

```
If(shader->loadFromFile(vertex, fragment)){ loaded = true;}

effect->loadFromFile("wave.vert","blur.frag"); 
```

在我绘制矩形之前：

```
void SfShader::activate()
{
    stats.shader = shader;
} 
```

我绘制的文本也显示了效果，但矩形不可见。所以 ms 问题没有显示更多代码。是否可以将 sfml 着色器用于简单填充白色的矩形？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-09T11:09:36.517

绘制到渲染中时可以使用着色器。您可以通过创建“sf::RenderState”并设置它的着色器来做到这一点：

```
sf::RenderState rs;
sf::Shader effect;

effect.loadFromFile("wave.vert","blur.frag");

rs.shader = &effect;

window.draw(rect , rs); 
```

如果您不需要使用来自 RenderState 的更多信息（如纹理），则可以直接将着色器传递给绘图函数：

```
sf::Shader effect;

effect.loadFromFile("wave.vert","blur.frag");

window.draw(rect , &effect); 
```

# r - 对 Rcpp NumericMatrix 的列进行排序以进行中值计算

> ID：15820803
> 
> 赞同：2
> 
> 时间：2013-04-04T20:10:48.277
> 
> 标签：r, rcpp

我一直在测试 Rcpp 和 RcppArmadillo 来计算大矩阵的汇总统计数据。这比大约 400 万行、45 列的基本 R colMeans 或犰狳要快得多（快 5 或 10 倍）。

```
colMeansRcpp <- cxxfunction(signature(X_="integer"), 
                            plugin='Rcpp',
                            body='
                            Rcpp::IntegerMatrix X = X_;
                            int ncol = X.ncol(); int nrow = X.nrow();                      
                            Rcpp::NumericVector out(ncol);
                            for(int col = 0; col < ncol; col++){
                              out[col]=Rcpp::sum(X(_, col));
                            }                             
                            return wrap(out/nrow);
                          ') 
```

我真的很想计算中位数，也许还有其他分位数用于绘图 - 因为它需要一种排序，所以它更需要 C++ 外包。犰狳似乎有点慢，所以我想对与上面类似的代码进行就地排序，但我只是无法正确理解语法......这就是我正在尝试的......

```
# OK I'm aware this floor(nrow/2) is not **absolutely** correct 
# I'm simplifying here
    colMedianRcpp <- cxxfunction(signature(X_="integer"), 
                          plugin='Rcpp',
                          body='
                          Rcpp::IntegerMatrix X = clone(X_);
                          int ncol = X.ncol(); int nrow = X.nrow();                           
                          Rcpp::NumericVector out(ncol);
                          for(int col = 0; col < ncol; col++){
                          X(_,col)= std::sort((X_,col).begin, (X_,col).end));
                          out[col]=X(floor(nrow/2), col));
                          }
                        return wrap(out);
                        ') 
```

基本上就是这条线

```
X(_,col)= std::sort((X_,col).begin, (X_,col).end)); 
```

我不知道如何用这种 Rcpp 糖和标准 C++ 的混合物来表达“对列进行排序”。抱歉，我可以看出我在做什么是错误的，但是关于正确语法的提示会很可爱。

ps 我是对的，我需要这样做 clone() 所以我不更改 R 对象吗？

**编辑** 我添加了 RcppArmadillo 代码和基准比较来解决下面的答案/评论。该基准仅针对 50k 行进行快速回复，但我记得它与更多类似。我知道你是 Rcpp 作者.. 非常感谢你的时间！

出现的想法是，也许我正在对 RcppArmadillo 代码做一些愚蠢的事情，以使其运行速度比基本 colMeans 或 Rcpp 版本慢得多？

```
colMeansRcppArmadillo <- cxxfunction(signature(X_="integer"), 
                                     plugin="RcppArmadillo",
                                      body='
                                      arma::mat X = Rcpp::as<arma::mat > (X_);
                                      arma::rowvec MD= arma::mean(X, 0);
                                      return wrap(MD);
                                    ') 
```

基准是...

```
(mb = microbenchmark(
+                     colMeans(fqSmallMatrix), 
+                     colMeansRcpp(fqSmallMatrix), 
+                     colMeansRcppArmadillo(fqSmallMatrix),
+                     times=50))
Unit: milliseconds
                                 expr       min       lq    median        uq        max neval
              colMeans(fqSmallMatrix) 10.620919 10.63289 10.640819 10.648882  10.907145    50
          colMeansRcpp(fqSmallMatrix)  2.649038  2.66832  2.676709  2.700839   2.841012    50
 colMeansRcppArmadillo(fqSmallMatrix) 25.687067 26.23488 33.168589 33.792489 113.832495    50 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-04T21:54:49.030

您可以将列复制到一个新的向量中

```
NumericVector y = x(_,j); 
```

完整示例：

```
library(Rcpp)
cppFunction('
  NumericVector colMedianRcpp(NumericMatrix x) {
    int nrow = x.nrow();
    int ncol = x.ncol();
    int position = nrow / 2; // Euclidian division
    NumericVector out(ncol);
    for (int j = 0; j < ncol; j++) {
      NumericVector y = x(_,j); // Copy the column -- the original will not be modified
      std::nth_element(y.begin(), y.begin() + position, y.end());
      out[j] = y[position];
    }
    return out;
  }
')
x <- matrix( sample(1:12), 3, 4 )
x
colMedianRcpp(x)
x   # Unchanged 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-04T20:16:26.500

您实际上并没有显示 RcppArmadillo 代码——我对 RcppArmadillo 代码的性能非常满意，我需要行/列子集。

您可以通过 Rcpp 以同样有效的方式实例化 Armadillo 矩阵（无需复制，重新使用 R 对象内存），所以我会尝试这样做。

而你：你想要`clone()`一个独特的副本，如果你使用默认的 RcppArmadillo ctor（而不是更有效的两步），我认为你会免费获得它。

**几个小时后编辑**

你留下了一个悬而未决的问题，为什么你的犰狳很慢。与此同时，Vincent 为您解决了这个问题，但这里使用您的代码和 Vincent 的代码重新审视了一个更简洁的解决方案。

现在它如何在没有副本的情况下实例化犰狳矩阵——所以它更快。它还避免了混合整数和数字矩阵。先上代码：

```
#include <RcppArmadillo.h> 

using namespace Rcpp;

// [[Rcpp::depends(RcppArmadillo)]]

// [[Rcpp::export]]
NumericVector colMedianRcpp(NumericMatrix x) {
    int nrow = x.nrow();
    int ncol = x.ncol();
    int position = nrow / 2; // Euclidian division
    NumericVector out(ncol);
    for (int j = 0; j < ncol; j++) { 
        NumericVector y = x(_,j); // Copy column -- original will not be mod
        std::nth_element(y.begin(), y.begin() + position, y.end()); 
        out[j] = y[position];  
    }
    return out;
}

// [[Rcpp::export]]
arma::rowvec colMeansRcppArmadillo(NumericMatrix x){
    arma::mat X = arma::mat(x.begin(), x.nrow(), x.ncol(), false); 
    return arma::mean(X, 0); 
}

// [[Rcpp::export]]
NumericVector colMeansRcpp(NumericMatrix X) {
    int ncol = X.ncol();
    int nrow = X.nrow(); 
    Rcpp::NumericVector out(ncol);
    for (int col = 0; col < ncol; col++){
        out[col]=Rcpp::sum(X(_, col)); 
    } 
    return wrap(out/nrow);
} 

/*** R
set.seed(42)
X <- matrix(rnorm(100*10), 100, 10)
library(microbenchmark)

mb <- microbenchmark(colMeans(X), colMeansRcpp(X), colMeansRcppArmadillo(X),
                     colMedianRcpp(X), times=50)  
print(mb)
*/ 
```

这是我机器上的结果，简明的犰狳版本和你的一样快，中值稍微慢一点，因为它必须做更多的工作：

```
R> sourceCpp("/tmp/stephen.cpp") 
R> set.seed(42)
R> X <- matrix(rnorm(100*10), 100, 10)
R> library(microbenchmark)
R> mb <- microbenchmark(colMeans(X), colMeansRcpp(X), colMeansRcppArmadillo(X),
+                      colMedianRcpp(X), times=50) 
R> print(mb)
Unit: microseconds
                     expr    min     lq  median     uq    max neval
              colMeans(X)  9.469 10.422 11.5810 12.421 30.597    50 
          colMeansRcpp(X)  3.922  4.281  4.5245  5.306 18.020    50 
 colMeansRcppArmadillo(X)  4.196  4.549  4.9295  5.927 11.159    50 
         colMedianRcpp(X) 15.615 16.291 16.7290 17.971 27.026    50 
R> 
```

# c# - 反复使用Form Constructor刷新标签文本

> ID：15820805
> 
> 赞同：2
> 
> 时间：2013-04-04T20:10:50.213
> 
> 标签：c#, winforms, refresh

我是C# 的**新手**，我有一个小项目。我被困在某个地方。我在这里解释了它（带有示例源代码）：

我有一个表格申请。我要求用户从 2 个按钮中选择一个选项。有 2 个按钮（是和否）。我的代码是这样的：

```
public partial class Form1 : Form
{
   public int choice=0;
   public Form1()
   {
      if(choice == 0)
      {
         label.Text = "Please push one of these buttons :";
         // And there are buttons below this label
      }
      else if(choice == 1)
      {
         label.Text = "You just pushed YES button";
      }
      else if(choice == 2)
      {
         label.Text = "You just pushed NO button";
      }
   }

   private void buttonYes_Click(object sender, EventArgs e)
   {
       choice = 1;
       /*
          I have to use one of these here for redraw whole form
          this.Refresh();
          this.Invalidate();
       */
   }
   private void buttonNo_Click(object sender, EventArgs e)
   {
       choice = 2;
       /*
          I have to use one of these here for redraw whole form
          this.Refresh();
          this.Invalidate();
       */
   }
} 
```

如您所见，当用户单击“是”或“否”按钮之一时，应重新执行整个构造函数。标签应该是“你刚刚按下是/否按钮”。

但是当我使用 this.Refresh() 时，当我点击按钮时什么也没有发生。仍然标签是“请按下这些按钮之一：”。

当我使用 this.Invalidate() 时，所有按钮都消失了，标签仍然是“请按下这些按钮之一：”。

我该怎么办 ？

谢谢。

**PS** 我在问这个[问题](https://stackoverflow.com/questions/7347714/how-to-refresh-or-flush-the-c-sharp-windows-form)之前发现了这个问题。但如您所见，接受的答案对我不起作用。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-04T20:12:47.953

无效或刷新不会再次调用构造函数。创建表单时只调用一次构造函数，并且无效不会创建新表单。将更改内容的逻辑放在另一个方法中，并从构造函数和事件处理程序调用它——但请注意后人调用实例方法或从构造函数访问变量并不是做这些事情的最佳方式——而是您的目的是简单的解决方案。

```
public partial class Form1 : Form
{
   public int choice=0;
   public Form1()
   {
      UpdateForm();
   }
   private void UpdateForm(){
      if(choice == 0)
      {
         label.Text = "Please push one of these buttons :";
         // And there are buttons below this label
      }
      else if(choice == 1)
      {
         label.Text = "You just pushed YES button";
      }
      else if(choice == 2)
      {
         label.Text = "You just pushed NO button";
      }
   }
   private void buttonYes_Click(object sender, EventArgs e)
   {
       choice = 1;
       /*
          I have to use one of these here for redraw whole form
          this.Refresh();
          this.Invalidate();
       */
       UpdateForm();
   }
   private void buttonNo_Click(object sender, EventArgs e)
   {
       choice = 2;
       /*
          I have to use one of these here for redraw whole form
          this.Refresh();
          this.Invalidate();
       */
      UpdateForm();

   }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-04T20:17:20.893

如果您想保留与示例中相同的变量，这是最佳选择。如果您想要更短的版本，只需直接在`Form1 Constructor`.

```
public partial class Form1 : Form
{
   public int choice=0;

   public Form1()
   {
       buttonYes.Click += (s,e) => { 
       choice = 1; 
       ChangeText(choice);};

       buttonNo.Click += (s,e) => {
       choice = 2;
       ChangeText(choice);};
   }

  private void ChangeText(int userChoice)
  { 
    if(choice == 0)
         label.Text = "Please push one of these buttons :";

      else if(choice == 1)
         label.Text = "You just pushed YES button";

      else if(choice == 2)
       label.Text = "You just pushed NO button";
  }

} 
```

**较短的版本**

```
public partial class Form1 : Form
{
  public Form1()
  {
    label.Text = "Push a button";
    buttonYes.Click += (s,e) => {label.Text = "Yes is pressed";};
    buttonNo.Click += (s,e) => {label.Text = "No is pressed";};
  }
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-04-04T20:18:57.840

这就是你真正应该这样做的方式：

```
public partial class Form1 : Form
{
   public Form1()
   {
       // Isn't there supposed to be InitializeComponent() here?

       // You should assign this in the designer, rather than here.
       label.Text = "Please push one of these buttons :";
   }

   private void buttonYes_Click(object sender, EventArgs e)
   {
       label.Text = "You just pushed YES button";
   }
   private void buttonNo_Click(object sender, EventArgs e)
   {
       label.Text = "You just pushed NO button";
   }
} 
```

由于按钮所做的只是更改标签，因此应该直接完成，而不是更改变量并刷新。

**但为什么它没有按我的方式工作？**

所有 Refresh 和 Invalidate 所做的就是重绘表单上已有的内容。他们不会重新创建它。

构造函数旨在在创建对象时对其进行一次初始化。不能调用它来“重新初始化”或“刷新”对象。

为避免过于详细，我建议您查找有关面向对象编程的文章/书籍，以了解有关构造函数和其他 OOP 习惯用法的更多信息。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-04T22:21:25.180

创建新对象时执行主构造函数。

使用方法来做到这一点。我在岸上，这行得通

```
 public string TextSwitcher(int choice)
       {
          Switch(choice) // choice is an int 
          {
// 1,2,3 is not an serial no they will pass by parameter  
             case(1):
              return "Please push one of these buttons :";
             brake;
             case(2):
              return = "You just pushed YES button";
             brake;
             case(3)
              return = "You just pushed NO button";
             brake;
          }
       }

   private void buttonYes_Click(object sender, EventArgs e)
   {
       label.Text = TextSwitcher(2);
   }
   private void buttonNo_Click(object sender, EventArgs e)
   {
       label.Text = TextSwitcher(3);
   } 
```

我希望这会对你有所帮助。并欢迎你的感谢。

祝你好运

# c# - 手动实例化 SessionState 提供程序的问题

> ID：15820806
> 
> 赞同：7
> 
> 时间：2013-04-04T20:10:51.887
> 
> 标签：c#, mysql, session-state

我正在开发一个原型程序，它应该为 ASP.NET 测试不同的（SessionState、Profile 等）提供程序，即 MySQL、Oracle 等。目前我正在使用 MySQL 提供程序。我刚刚成功地实例化了提供者、SessionStateContainer 和 SessionState 本身。

```
Type mySqlType = Type.GetType("MySql.Web.SessionState.MySqlSessionStateStore, MySql.Web, Version=6.6.4.0, Culture=neutral, PublicKeyToken=c5687fc88969c44d", true, true);

SessionStateStoreProviderBase provider = (SessionStateStoreProviderBase)Activator.CreateInstance(mySqlType);
System.Collections.Specialized.NameValueCollection providerConfig = new System.Collections.Specialized.NameValueCollection();
providerConfig.Add("connectionStringName", "LocalMySqlServer");
providerConfig.Add("applicationName", "/");
providerConfig.Add("autogenerateschema", "True");
providerConfig.Add("enableExpireCallback", "False");

provider.Initialize("MySqlSessionStateProvider", providerConfig);

HttpContext context = new HttpContext(
                          new HttpRequest("fake", "http://localhost:14359", ""),
                          new HttpResponse(new StringWriter()));

SessionStateStoreData storeData = provider.CreateNewStoreData(context, 100);
System.Web.SessionState.HttpSessionStateContainer sessionStateContainer =
    new System.Web.SessionState.HttpSessionStateContainer(
            "mySession",
            storeData.Items,
            storeData.StaticObjects,
            100,
            true,
            System.Web.HttpCookieMode.UseDeviceProfile,
            SessionStateMode.Custom,
            false
    );

Type sessionStateType = Type.GetType("System.Web.SessionState.HttpSessionState, System.Web, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a");
HttpSessionState sessionState =
    (HttpSessionState)sessionStateType
        .GetConstructor(BindingFlags.NonPublic | BindingFlags.Instance, null, new Type[] { typeof(IHttpSessionState) }, null)
        .Invoke(new object[] { ssessionStateContainer });

provider.InitializeRequest(context); 
```

一切似乎都运行良好，因为我可以在我创建的会话中写入一些值，并且我可以从那里读取它们：

```
sessionStateContainer.Add("SomeKey", "SomeValue");
var test = sessionStateContainer["SomeKey"];
Console.WriteLine("var test: " + test.ToString()); // outputs "var test: SomeValue"

sessionState.Add("AnotherKey", "SomeOtherValue");
var test2 = sessionState["AnotherKey"];
Console.WriteLine("var test2: " + test2.ToString()); // outputs "var test2: SomeOtherValue"

// End the request
provider.EndRequest(context); 
```

有趣的部分来了——当我检查`my_aspnet_sessions`数据库中的表时，里面什么都没有。

所以我想知道数据写在哪里或者我做错了什么？

**更新：**
即使这个问题不再是一个障碍，我仍然很想知道，如果有人愿意尝试一下，这是`connectionString`我用过的：

```
<connectionStrings>
  <remove name="LocalMySqlServer" />
  <add name="LocalMySqlServer" connectionString="server=localhost;database=session_test;User Id=user;password=pass" providerName="MySql.Data.MySqlClient" />
</connectionStrings> 
```

您还需要[MySQL Connector NET](http://dev.mysql.com/downloads/connector/net/)。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-14T14:58:07.130

您在数据库中看不到任何数据，因为[SessionStateModule](http://msdn.microsoft.com/it-it/library/system.web.sessionstate.sessionstatemodule.aspx)等待请求结束以调用命令[SetAndReleaseItemExclusive](http://msdn.microsoft.com/it-it/library/system.web.sessionstate.sessionstatestoreproviderbase.setandreleaseitemexclusive.aspx)。数据一直保存在内存中，直到调用了这样的命令。确实，文档指出：

> SessionStateModule 对象在请求结束时调用 SetAndReleaseItemExclusive 方法，在 ReleaseRequestState 事件期间，将当前会话项信息插入数据存储或使用当前值更新数据存储中现有的会话项信息，以更新到期时间在项目上，并释放对数据的锁定。仅更新与提供的会话 id 和 lockId 值匹配的当前应用程序的会话数据。有关锁定的更多信息，请参阅 SessionStateStoreProviderBase 类概述中的“锁定会话存储数据”。

要进一步了解细节，您可以查看[mono 代码库中的相关文件](https://github.com/mono/mono/tree/master/mcs/class/System.Web/System.Web.SessionState_2.0)。

鉴于此，要在数据库中查看会话数据，您应该执行以下操作：

```
object storeLockId = new object();
sessionStateContainer.Add("SomeKey", "SomeValue");
var test = sessionStateContainer["SomeKey"];
Console.WriteLine("var test: " + test.ToString());

sessionState.Add("AnotherKey", "SomeOtherValue");
var test2 = sessionState["AnotherKey"];
Console.WriteLine("var test2: " + test2.ToString()); 

// End the request
provider.SetAndReleaseItemExclusive (context, sessionStateContainer.SessionID, 
                                     storeData, storeLockId, true);
provider.EndRequest(context); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-13T07:37:53.990

在您的 web.config 中，您需要设置 mode="custom"

```
 <sessionState mode="Custom" customProvider="YourProvider"> 
```

否则，无论提供者如何，会话数据都将存储在内存中。

# php - 使用 MySQL 和 Backbone JS 检索数据

> ID：15820807
> 
> 赞同：3
> 
> 时间：2013-04-04T20:10:53.743
> 
> 标签：php, mysql, backbone.js

我希望你能帮助我。我正在尝试使用 mysql 和主干从我的数据库中获取数据。问题是我可以创建一个“用户”，并且我可以获取所有这些用户。但是当我尝试制作时：

```
var user = new User({id: 10}); 
```

我总是有这种类型的结果，无论给定的 id ：

```
Object {id: "10", nom: "", age: "", prenom: ""} 
```

但我从我的服务器收到了回复：

```
[{"id":"10","nom":"test","prenom":"test","age":"12"}] 
```

因此，执行 GET 请求，并返回未保存在 «user » 变量中的内容。

有关更多解释，这是我的脚本

```
// The model
var User = Backbone.Model.extend({
    defaults: {
        id:"",
        nom:"",
        age:"",
        prenom:""
    },

    url: function(){
    if (this.isNew()){
      return "./users.php";
    } else {
      return "./users.php?id=" + this.id;
    }
  }
});

// The collection
var Users = Backbone.Collection.extend({
    models:"user",
    url:"./users.php"
});

// The view
var EditUser = Backbone.View.extend({
    el: ".page",
    render: function(options) {
        var that = this
        if (options.id) {
            var user = new User({id: options.id});
            console.log(user.toJSON());
            user.fetch({
                success: function(user){
                    var template = _.template($('#edit-user-template').html(), {user: user});                   
                    that.$el.html(template);
                }
            })
        } else {
            var template = _.template($('#edit-user-template').html(), {user:null});
            this.$el.html(template);
        }

    },
    events: {
        'submit .edit-user-form' : 'saveUser',
    },

    saveUser: function(ev){
        data = $(ev.currentTarget).serializeObject();
        var user = new User();
        user.save(data, {
            success: function(user) {
                router.navigate('', {trigger:true})
            }
        });
        return false;
    }
}); 
```

还有我的 users.php

```
<?php 

    $request_method = strtolower($_SERVER['REQUEST_METHOD']);

    switch($_SERVER['REQUEST_METHOD']){
        case 'POST':
        save();
        break;
        case 'GET':
        fetch();
        break;
        case 'PUT':
        save();
        break;
        case 'DELETE':
                    // delete item
        destroy();
        break;
    }

    function fetch() {
        $pdo=new PDO("mysql:dbname=nomade;host=localhost","","");
        $sql = "SELECT * FROM users";
        if (isset($_GET['id'])) $sql .= " WHERE id =".$_GET['id'];
        $statement=$pdo->prepare($sql);
        $statement->execute();
        $results=$statement->fetchAll(PDO::FETCH_ASSOC);
        echo json_encode($results);
    }

    function save() {
        $pdo=new PDO("mysql:dbname=nomade;host=localhost","","");
        $data = json_decode(file_get_contents('php://input'));
        $nom = $data->{'nom'};
        $prenom = $data->{'prenom'};
        $age = $data->{'age'};
        $statement=$pdo->prepare("INSERT INTO users (prenom, nom, age) VALUES ('".$nom."','".$prenom."',$age)");
        $statement->execute();
        $results=$statement->fetchAll(PDO::FETCH_ASSOC);
        echo json_encode($results);
    }
?> 
```

**编辑** 当我做一个

```
var user = new User({id: options.id});
        user.fetch({
            success: function(user){
                console.log(user.attributes[0]);
                // var template = _.template($('#edit-user-template').html(), {});
                // that.$el.html(template);
            }
        }); 
```

我明白了：

```
 Object {id: "5", nom: "dsfsdfqds", prenom: "qsdfqsdf", age: "12"} 
```

为什么 ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T07:45:06.170

我终于做到了。

如果你做一个

```
$results=$statement->fetchAll(PDO::FETCH_ASSOC); 
```

您将获得一个模型属性，其中包含您需要的对象。你可以这样解析它：

这是我的观点：

```
var EditUser = Backbone.View.extend({
    el: ".page",
    render: function(options) {
        var that = this
        if (options.id) {
            var user = new User({id: options.id});
            user.fetch({
                success: function(user){
                    var template = _.template($('#edit-user-template').html(), {user: user.attributes['0']});
                    that.$el.html(template);
                }
            });
        } else {
            var template = _.template($('#edit-user-template').html(), {user:null});
            this.$el.html(template);
        }

    },
    events: {
        'submit .edit-user-form' : 'saveUser',
    },

    saveUser: function(ev){
        data = $(ev.currentTarget).serializeObject();
        var user = new User();
        user.save(data, {
            success: function(user) {
                router.navigate('', {trigger:true})
            }
        });
        return false;
    }
}); 
```

和相关的模板：

```
<script type="text/template" id="edit-user-template">
<form  class="edit-user-form">
<legend><%= user ? "Créer" : "Mettre à jour" %> un user</legend>
<label>Prenom</label>
<input type="text" name="prenom" value="<%= user ? user['prenom'] : '' %>" placeholder="">

<label>Nom</label>
<input type="text" name="nom" value="<%= user ? user['nom'] : '' %>" placeholder="">

<label>Age</label>
<input type="text" name="age" value="<%= user ? user['age'] : '' %>" placeholder="">

<hr>
<input type="submit" name="submit" value="Envoyer" placeholder="" class="btn">

</form>
</script> 
```

但是如果你让

```
$results=$statement->fetchObject(); 
```

它会返回用户。谢谢@WiredPrairie，我太傻了，改变了我的“保存”功能而不是“获取”功能。

# ios - iOS：NSURLConnection 不可取消

> ID：15820815
> 
> 赞同：1
> 
> 时间：2013-04-04T20:11:41.310
> 
> 标签：ios, uiimageview, uiimage, nsurlconnection

我正在通过`NSURLConnection`. 一切正常，期待`EDGE`模式。当`NSLog();`我连接（收到数据）时，旧图像仍在加载（逐步直到`connectionDidFinishLoading`），即使在`[connection cancel];`.

我能做些什么？在这种情况下，旧图像仍然会在新图像出现之前出现。

## 编辑

**从 A 类调用连接：**

```
ProductImageLoader *imageLoader = [[ProductImageLoader alloc] initWithString:productID delegate:self];

[self.queue_3LF addOperation:imageLoader]; 
```

在这里它将在 B 类中初始化：

```
- (void)start_XL_ImageDownload
{
    [self.authConnection_N3I cancel];
    self.authConnection_N3I = nil;

    if (self.authConnection_N3I == nil)
    {
        NSMutableURLRequest *request_N3I = [NSMutableURLRequest requestWithURL:[NSURL URLWithString:[NSString stringWithFormat:@"http://www.softridge.ch/images/articles/%@_1_xl.jpg", self.product_id]] cachePolicy:NSURLRequestReloadIgnoringLocalCacheData timeoutInterval:18.0];

        [[UIApplication sharedApplication] setNetworkActivityIndicatorVisible:YES];

        self.authConnection_N3I = [[NSURLConnection alloc] initWithRequest:request_N3I delegate:self];
    }
} 
```

**这是B类的流产：**

```
- (void)abortRunningProcess
{
    [self.authConnection_N3I cancel];
    self.authConnection_N3I = nil;
} 
```

**从 A 类中调用：**

```
ProductDataParser *PDP = [[ProductDataParser alloc] init];
[PDP abortRunningProcess]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-09T08:46:38.147

刚刚将连接导入另一个类。现在它完美地工作了。可能是委托错误。

# c# - DataGridView / ComboBox 需要两种显示状态（长和短）来获取信息

> ID：15820823
> 
> 赞同：3
> 
> 时间：2013-04-04T20:12:02.733
> 
> 标签：c#, winforms, user-interface, datagridview

我有一个在水平空间上非常紧凑的 DataGidView，还有一个描述相当冗长的列。

我想做的是创建一个 ComboBox 列：

1.  显示描述的缩短版本
2.  在下拉列表中有完整的描述
3.  幕后处理实际价值

例如，我在下面有这个人为的例子。真正的列表可以有 20-30 个项目，其中的文本很长：

```
Code    Short      DropDown Text
 1      BigBox     Boxes larger than 6' x 6'
 2      SmBox      Boxes smaller than 6' x 6'
 3      BigBrl     Barrel 55 gallons
 4      SmBrl      Barrel less than 55 gallons 
```

所以我想展示的是：

![在此处输入图像描述](https://i.stack.imgur.com/7OZiY.png)

当我打开下拉列表时，我想看到：

![在此处输入图像描述](https://i.stack.imgur.com/hixu5.png)

当然，当我查询单元格的值时，我想要“1”。

我可以分叉并将“短”描述作为较长描述的第一部分（“BigBx Boxes 大于 6' x 6'”），但这似乎不正确。

我正在寻找有关实现此目标的最佳方法的建议。还没有代码显示，因为我不太确定从哪里开始。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T14:59:51.520

您需要更改 DropDown 和 DropDownClosed 事件组合框的 DisplayMember。

在事件下拉菜单中，您需要将 DisplayMember 更改为您的长名称。我发现的一件事是更改 DisplayMember 会重置 SelectedIndex，因此您需要保存它，然后在更改显示后将其重置。

```
int i = comboBox1.SelectedIndex;
comboBox1.DisplayMember = "LongNm";
comboBox1.SelectedIndex = i; 
```

您需要使用 DropDownClosed 事件和短名称重复此过程以返回到您的关闭显示。

```
int i = comboBox1.SelectedIndex;
comboBox1.DisplayMember = "ShortNm";
comboBox1.SelectedIndex = i; 
```

我遇到的最后一个问题是更改组合框下拉菜单的宽度。我在[这里](http://www.codeproject.com/Articles/5801/Adjust-combo-box-drop-down-list-width-to-longest-s)找到了执行此操作的代码。我的最终代码如下所示：

```
public partial class Form1 : Form
{
    List<ComboData> data;
    public Form1()
    {
        InitializeComponent();
    }

    private void Form1_Load(object sender, EventArgs e)
    {
        data = new List<ComboData>();
        data.Add(new ComboData(1, "BigBox", "Boxes larger than 6x6"));
        data.Add(new ComboData(2, "SmBox", "Boxes small than 6x6"));
        data.Add(new ComboData(3, "BirBrl", "Barrel 55 Gallons"));
        data.Add(new ComboData(4, "smBrl", "Barrel less than 55 gallons"));

        comboBox1.DataSource = data;
        comboBox1.DisplayMember = "ShortNm";
    }

    private void comboBox1_DropDown(object sender, EventArgs e)
    {
        int i = comboBox1.SelectedIndex;
        comboBox1.DisplayMember = "LongNm";
        comboBox1.SelectedIndex = i;

        ComboBox senderComboBox = (ComboBox)sender;
        int width = senderComboBox.DropDownWidth;
        Graphics g = senderComboBox.CreateGraphics();
        Font font = senderComboBox.Font;
        int vertScrollBarWidth =
            (senderComboBox.Items.Count > senderComboBox.MaxDropDownItems)
            ? SystemInformation.VerticalScrollBarWidth : 0;

        int newWidth;
        foreach (ComboData s in ((ComboBox)sender).Items)
        {
            newWidth = (int)g.MeasureString(s.LongNm, font).Width
                + vertScrollBarWidth;
            if (width < newWidth)
            {
                width = newWidth;
            }
        }
        senderComboBox.DropDownWidth = width;
    }

    private void comboBox1_DropDownClosed(object sender, EventArgs e)
    {
        int i = comboBox1.SelectedIndex;
        comboBox1.DisplayMember = "ShortNm";
        comboBox1.SelectedIndex = i;
    }
}

public class ComboData
{
    public int Code;
    public string ShortNm
    {
        get;
        set;
    }
    public string LongNm
    {
        get;
        set;
    }

    public ComboData(int c, string s, string l)
    {
        Code = c;
        ShortNm = s;
        LongNm = l;
    }
} 
```

最终结果如下所示：

![封闭的组合框](https://i.stack.imgur.com/Fwlv5.png) ![打开组合框](https://i.stack.imgur.com/Cy6Gd.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T21:41:03.953

我想我几乎拥有你想要的东西。一个小的折衷方案：在您编辑值时，组合框会显示截断的 long 值。否则这应该很适合你。

我的源代码是[这个例子](http://msdn.microsoft.com/en-us/library/y0wfd4yz.aspx)的一个稍微编辑过的版本。在示例中，它们有一个可通过组合框列编辑的枚举。我的扩展现在将组合框更改为具有显示和值成员（显示成员是长文本，值成员是实际的枚举值），并且在正常显示单元格时，单元格格式化事件开始发挥作用，覆盖显示

这些是主要变化：

```
private static T GetAttribute<T>(Enum value)
{
    T attribute = value.GetType()
        .GetMember(value.ToString())[0].GetCustomAttributes(typeof(T), false)
        .Cast<T>()
        .SingleOrDefault();
    return attribute;
}

DataGridViewComboBoxColumn CreateComboBoxWithEnums()
{
    DataGridViewComboBoxColumn combo = new DataGridViewComboBoxColumn();
    //combo.DataSource = Enum.GetValues(typeof(Title));        

    var datatable = new DataTable(); //Setup a DataTable for your ComboBox Column
    datatable.Columns.Add("col1", typeof(string));
    datatable.Columns.Add("col2", typeof(Title));

    foreach (Title item in Enum.GetValues(typeof(Title)))
        datatable.Rows.Add(GetAttribute<DescriptionAttribute>(item).Description, item);

    combo.DisplayMember = "col1";
    combo.ValueMember = "col2";
    combo.DataSource = datatable;
    combo.DropDownWidth = 200;
    combo.DataPropertyName = "Title";
    combo.Name = "Title";
    return combo;
}

private void dataGridView1_CellFormatting(object sender, DataGridViewCellFormattingEventArgs e)
{
    if (e.ColumnIndex == 0)//where Column1 is your combobox column
    {
        var val = dataGridView1[e.ColumnIndex, e.RowIndex].Value;
        if (val != null)
        {
            e.Value = ((Title)val).ToString();
            e.FormattingApplied = true;
        }
    }
}

public enum Title
{
    [Description("This better be thy king!")]
    King,

    [Description("aka wanna-be-king")]
    Sir
}; 
```

完整代码： http: [//pastebin.com/Mp9DRvDn](http://pastebin.com/Mp9DRvDn)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-04T21:35:56.523

您可以使用单击事件或下拉事件来检测用户何时尝试打开组合框。然后在组合框正下方显示一个带有较长字符串的列表框。当用户从列表框中选择一个字符串时，在组合框中设置相应的值。

# javascript - 刷新时旋转图像

> ID：15820824
> 
> 赞同：0
> 
> 时间：2013-04-04T20:12:04.453
> 
> 标签：javascript, html, css

我对此完全陌生，所以请耐心等待。我希望在每次刷新或加载时旋转此页面[http://jovanatanakovic.com/index.html上的主图像。](http://jovanatanackovic.com/index.html)我找到了这个并尝试将它添加到脚本标签中

```
function random_imglink(){
  var theImages = new Array()

  theIimages[1]="images/thalia-heffernan-4.jpg"
  theImages[2]="images/volcano-surfing-the-ascent.jpg"
  theImages[3]="images/rooster-fighting-sucking-blood-from-face.jpg"
  theImages[4]="images/cooper-canyon-fallen-tarahumara.jpg"
  theImages[5]="images/copper-canyon-finishers.jpg"

  var j = 0
  var p = theImages.length;
  var preBuffer = new Array()
  for (i = 0; i < p; i++){
    preBuffer[i] = new Image()
    preBuffer[i].src = theImages[i]
  }
  var whichImage = Math.round(Math.random()*(p-1));

  function showImage(){
  if(whichImage==0){
    document.write('<a href =""><img src="'+theImages[whichImage]+'" border=0 width=689 height=466></a>');
  } else if(whichImage==1){
    document.write('<a href ="link.html"><img src="'+theImages[whichImage]+'" border=0 width=689 height=466></a>');
  } else if(whichImage==2){
    document.write('<a href ="link.html"><img src="'+theImages[whichImage]+'" border=0 width=689 height=466></a>');
  } else if(whichImage==3){
    document.write('<a href ="link.html"><img src="'+theImages[whichImage]+'" border=0 width=689 height=466></a>');
  } else if(whichImage==4){
    document.write('<a href ="link.html"><img src="'+theImages[whichImage]+'" border=0 width=689 height=466></a>');
  }
} 
```

我被告知在我希望图像显示的地方添加这个

```
<script>showImage();</script> 
```

这个对吗？我确定将它放在哪里，因为当前图像附加了 css。我试过将它添加到 div 标签中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T20:23:50.970

尝试这个;

[JSfiddle](http://jsfiddle.net/Allendar/AQQ44/)

**CSS**

```
#imgTest {
    background-image: url('YourImage.jpg');
    width: 450px;
    height: 281px;
    -webkit-animation-name: rotate;
    -webkit-animation-duration: 4s;
    -webkit-animation-iteration-count: 1;
    -webkit-animation-direction: right;
    -webkit-animation-timing-function: linear;
    -ms-animation-name: rotate;
    -ms-animation-duration: 4s;
    -ms-animation-iteration-count: 1;
    -ms-animation-direction: right;
    -ms-animation-timing-function: linear;
    -moz-animation-name: rotate;
    -moz-animation-duration: 4s;
    -moz-animation-iteration-count: 1;
    -moz-animation-direction: right;
    -moz-animation-timing-function: linear;
    -o-animation-name: rotate;
    -o-animation-duration: 4s;
    -o-animation-iteration-count: 1;
    -o-animation-direction: right;
    -o-animation-timing-function: linear;
    animation-name: rotate;
    animation-duration: 4s;
    animation-iteration-count: 1;
    animation-direction: right;
    animation-timing-function: linear;
}

@-webkit-keyframes rotate {
    0% {
        -webkit-transform:rotate(0deg);
        transform:rotate(0deg);
    }
    100% {
        -webkit-transform:rotate(360deg);
        transform:rotate(360deg);
    }
}

@-ms-keyframes rotate {
    0% {
        -ms-transform:rotate(0deg);
        transform:rotate(0deg);
    }
    100% {
        -ms-transform:rotate(360deg);
        transform:rotate(360deg);
    }
}

@-moz-keyframes rotate {
    0% {
        -moz-transform:rotate(0deg);
        transform:rotate(0deg);
    }
    100% {
        -moz-transform:rotate(360deg);
        transform:rotate(360deg);
    }
}

@-o-keyframes rotate {
    0% {
        -o-transform:rotate(0deg);
        transform:rotate(0deg);
    }
    100% {
        -o-transform:rotate(360deg);
        transform:rotate(360deg);
    }
}

@keyframes rotate {
    0% {
        transform:rotate(0deg);
    }
    100% {
        transform:rotate(360deg);
    }
} 
```

**HTML**

```
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>HTML</title>
    <link rel="stylesheet" href="main.css" type="text/css" />
</head>
<body>
    <div id="imgTest"></div>
</body>
</html> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T20:24:21.143

如果您真的想使用该代码，那么您需要以下内容：

```
<div class="photo">
  <script>
    ...JAVASCRIPT HERE...
  </script>
</div> 
```

当然，使用 javascript 代替 document.write 会是一个更好的解决方案：

在头部：

```
<script>
function showImage()
{
  // Better array init thanks to Joseph Silvashy
  var theImages = [
    "images/thalia-heffernan-4.jpg",
    "images/volcano-surfing-the-ascent.jpg",
    "images/rooster-fighting-sucking-blood-from-face.jpg",
    "images/cooper-canyon-fallen-tarahumara.jpg",
    "images/copper-canyon-finishers.jpg"
  ]

  var whichImage = Math.round(Math.random()*(p-1));

  document.getElementById("rotatingImage").src = theImages[whichImage];
}
</script> 
```

和

```
<body onload="showImage()">
... 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-04T20:27:52.853

作为提示，您可以简化数组：

```
var theImages = [
  "images/thalia-heffernan-4.jpg",
  "images/volcano-surfing-the-ascent.jpg",
  "images/rooster-fighting-sucking-blood-from-face.jpg",
  "images/cooper-canyon-fallen-tarahumara.jpg",
  "images/copper-canyon-finishers.jpg"
] 
```

# drupal - 在drupal中上传文件以在solr中建立索引

> ID：15820828
> 
> 赞同：0
> 
> 时间：2013-04-04T20:12:16.330
> 
> 标签：drupal, solr

是否有任何模块可以让您上传文件，然后由 Apache solr 编制索引。我使用了位于 solr 集成模块之上的附件模块。但这涉及创建基本页面和/文章，然后有一个文件上传小部件将文件上传到它们，然后被索引并可以搜索。

但我不想创建页面来上传我的文件。这是要求。

我的堆栈是 apache solr 3.2、drupal 7 solr 集成模块和 solr 附件模块（由于上述原因，我不满意！）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-07T23:48:33.693

这是目前无法使用的。drupal 中有一些模块，例如文件实体，可以让您上传文件，核心 drupal 模块也是如此，但它们永远不会被 apache solr 附件模块索引。

我希望得到纠正。

# android - 在移动设备上检测隐藏/不可见的蓝牙设备

> ID：15820829
> 
> 赞同：12
> 
> 时间：2013-04-04T20:12:21.367
> 
> 标签：android, bluetooth

我有目标设备的蓝牙 mac-id。然而，蓝牙处于隐藏/不可见模式。

两款手机都是安卓的。（非根）。

我做了我的研究，我*知道*如果我知道 mac-id，我可以连接到设备（在大多数情况下），但是我只想扫描接近度而不连接，即如果目标设备在蓝牙范围内并且我知道它的 mac-id，我可以 * 只是 * 知道它是否在附近（或松散的术语，扫描它吗？）

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-04-04T22:19:45.393

简短的回答是*否定*的，您无法发现无法发现的蓝牙设备。

安装设备*`undiscoverable mode`*是制造商为防止设备跟踪等滥用而实施的一项安全措施。这使得标准蓝牙适配器（例如您的）**完全**无法说明不可见/不可发现的设备是否接近。

然而，事实证明这种安全性并不是最佳的，并且最近被打破了。您可以在此处找到 Michael Ossmann 的工作[`Ubertooth`](http://ubertooth.sourceforge.net/)，这是一款能够检测不可发现设备的小型蓝牙适配器。你可以在[这里](http://hak5.org/episodes/episode-824)找到关于这是什么的精彩演示，使用开源计划构建这个加密狗，甚至[购买](http://hakshop.myshopify.com/products/ubertooth-one)他的加密狗。

**编辑 ：**

通过首先知道他的完整 MAC 地址，可以知道蓝牙设备是否在附近，即使他处于不可发现的模式。

该技术是尝试一个*PAGE 请求*，发送所有 6 个字节，这些字节组成了所寻找的蓝牙主机 MAC 标识符。一个 PAGE 请求允许一个人在知道他的 BT ADDR 时与蓝牙从站连接。处于不可发现模式的设备不会响应查询扫描（设备发现意图），但它们会响应想要连接到另一个先前已知设备的设备使用的页面扫描。

您可以使用[Bluesniff](http://bluesniff.shmoo.com/)做您想做的事，这是一种安全概念证明，可让您发现隐藏的设备。它可能支持页面扫描。

请注意，这将被视为一种*教育*资源，我不鼓励在商业应用中进行这种做法。

# android - 是否可以将 TextView 设置为每行具有不同的宽度？

> ID：15820835
> 
> 赞同：0
> 
> 时间：2013-04-04T20:12:49.043
> 
> 标签：android, android-layout, textview, android-relativelayout

这就是我到目前为止所得到的，使用`RelativeLayout`and `android:layout_toLeftOf`and`android:layout_toRightOf`

```
[BUTTON1][TEXTVIEW: HERE GOES A TEXT........][BUTTON2]
         [...THAT MUST CONTINUE IN THIS LINE] 
```

这就是我需要的：

```
[BUTTON1][TEXTVIEW: HERE GOES A TEXT........][BUTTON2]
[..........THAT MUST CONTINUE IN THIS LINE...........] 
```

我知道我可以使用多个文本视图来做到这一点，但我不知道如何拆分文本以完全适合第一行和第二行。

那么，是否可以将 textview 设置为保持 button1 的“右侧”和 button2 的“左侧”，但仅限于“line1”？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T20:23:29.063

没有`TextView`那个平台提供。但是，您可以编写自己的小部件以这种方式进行布局。查看此小部件的来源作为起点[http://code.google.com/p/android-flowtextview/](http://code.google.com/p/android-flowtextview/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T20:15:40.107

恐怕不是-在android中，视图始终是矩形的。你不能看到顶部变得瘦弱。

# c++ - Visual Studio 控制台应用程序是否使用 CRT

> ID：15820838
> 
> 赞同：0
> 
> 时间：2013-04-04T20:12:55.960
> 
> 标签：c++, visual-studio, console-application

Visual Studio 控制台应用程序是否使用 CRT？

有没有办法通过查看链接器设置来判断这是真的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T20:45:45.153

是的，控制台应用程序将使用 CRT。

CRT 负责静态数据设置和众多内务管理功能。如果要禁用 CRT，则需要编写大量样板代码。当然，如果您不使用基本的字符串操作、静态等，那么您可以安全地从项目中删除 CRT 库。

就个人而言，我不会，但这只是我。

# automake - 如何有条件地定义 AUTOMAKE_OPTIONS？

> ID：15820844
> 
> 赞同：4
> 
> 时间：2013-04-04T20:13:35.117
> 
> 标签：automake

在一个基于 autotools 的项目中，我目前在我的 中有以下行`Makefile.am`：

```
AUTOMAKE_OPTIONS = serial-tests 
```

**当且仅当**我的 automake 版本为 1.12 或更高版本时，我想让此选项适用。原因是需要同时支持 1.11 和 1.13 automake 的串行测试工具。做这个的最好方式是什么？

* * *

我已经尝试过这个：

```
AM_VER = $(shell $(AUTOMAKE) --version | head -n1 | sed -e 's|[^0-9.]||g')
AM_VER_MAJOR = $(shell echo $(AM_VER) | cut -d. -f1)
AM_VER_MINOR = $(shell echo $(AM_VER) | cut -d. -f2)
AM_VER_PATCH = $(shell echo $(AM_VER) | cut -d. -f3)

$(info $(AM_VER_MAJOR) $(AM_VER_MINOR) $(AM_VER_PATCH))

supports_serial_tests_opt = $(shell if [ "$(AM_VER_MAJOR)" -gt 1 ] || { [ "$(AM_VER_MAJOR)" -eq 1 ] && [ "$(AM_VER_MINOR)" -ge 12 ]; }; then echo true; fi)

$(info $(supports_serial_tests_opt))

$(if $(supports_serial_tests_opt), $(eval AUTOMAKE_OPTIONS=serial-opts))

$(info $(AUTOMAKE_OPTIONS)) 
```

而且它不起作用，因为`AUTOMAKE_OPTIONS`需要在`automake`执行时设置，并且函数条件是在`make`时间执行的。即使它有效，我也会觉得它冗长而臃肿。有没有更好的办法？我的直觉告诉我应该使用 my`configure.ac`来设置一个变量，然后我将简单地在 中展开`Makefile.am`，如下所示：

```
AUTOMAKE_OPTIONS = $(SERIAL_TESTS) 
```

* * *

自动配置背后的理念是检查功能——我可以以某种方式跳过版本检查并检查串行测试选项的可用性并在给定的情况下使用它吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-05T15:29:31.190

您的尝试不起作用，因为`$(shell ...)`仅由 GNU Make 解释，而 Automake`Makefile.am`自行读取并且对 GNU Make 的功能一无所知。

`AUTOMAKE_OPTIONS`您应该尝试使用参数，而不是尝试使用`AM_INIT_AUTOMAKE`变量。因为`configure.ac`总是使用 M4 读取，所以您可以在那里使用 shell 扩展。此外，您在此处设置的选项将适用于整个项目，无需在每个`Makefile.am`.

例如：

```
...
AM_INIT_AUTOMAKE(m4_esyscmd([case `automake --version | head -n 1` in 
                             *1.11*);; 
                             *) echo serial-tests;; 
                             esac]))
... 
```

如果您需要调试该脚本，请使用`autoconf -t AM_INIT_AUTOMAKE`跟踪传递给`AM_INIT_AUTOMAKE`.

（也就是说，我必须同意威廉的评论。要求 1.12 对我来说似乎是一个更好的举措。）

# c# - SQL Server 的输出参数未打印到 Web 表单

> ID：15820850
> 
> 赞同：1
> 
> 时间：2013-04-04T20:13:55.257
> 
> 标签：c#, asp.net, .net, sql-server

我有一个存储程序

```
create proc spAddEmployees  
@Name varchar(50),  
@Gender varchar(10),  
@Salary int,  
@EmployeeId int out  
as  
begin  
insert into tblEmployees values (@Name, @Gender, @Salary)  
select EmployeeId = SCOPE_IDENTITY()  
end 
```

它有一个输出参数，告诉用户当前的 scope_identity 标记看起来像

```
<asp:Content ID="BodyContent" runat="server" ContentPlaceHolderID="MainContent">
    <table style="border: 1px solid black; font-family:Arial">
    <tr>
        <td>
            Employee Name
        </td>
        <td>
            <asp:TextBox ID="txtEmployeeName" runat="server"></asp:TextBox>
        </td>
    </tr>        
    <tr>
        <td>
            Gender
        </td>
        <td>
            <asp:DropDownList ID="ddlGender" runat="server">
                <asp:ListItem>Male</asp:ListItem>
                <asp:ListItem>Female</asp:ListItem>
            </asp:DropDownList>
        </td>
    </tr> 
    <tr>
        <td>
            Salary
        </td>
        <td>
            <asp:TextBox ID="txtSalary" runat="server"></asp:TextBox>
        </td>
    </tr>       
    <tr>
        <td colspan="2">
            <asp:Button ID="btnSubmit" runat="server" Text="Submit" 
                onclick="btnSubmit_Click" />
        </td>
    </tr>          
    <tr>
        <td colspan="2">
            <asp:Label ID="lblMessage" runat="server"></asp:Label>
        </td>
    </tr>  
</table> 
```

以及背后的代码

```
 public partial class _Default : System.Web.UI.Page
    {
        protected void Page_Load(object sender, EventArgs e)
        {

        }

        protected void btnSubmit_Click(object sender, EventArgs e)
        {
            //read from the config file so you don't have to hardcode the connection string
            string cs = ConfigurationManager.ConnectionStrings["dbcs"].ConnectionString;
            //when you use the using statement the database connection is automatically closed for you
            using(SqlConnection con = new SqlConnection(cs))
            {
                SqlCommand cmd = new SqlCommand("spAddEmployees", con);

                cmd.CommandType = CommandType.StoredProcedure;

                cmd.Parameters.AddWithValue("@Name", txtEmployeeName.Text);
                cmd.Parameters.AddWithValue("@Gender",ddlGender.SelectedValue);
                cmd.Parameters.AddWithValue("@Salary", txtSalary.Text);

                SqlParameter outputParmeter = new SqlParameter();

                outputParmeter.ParameterName = "@EmployeeId";

                outputParmeter.SqlDbType = SqlDbType.Int;
                outputParmeter.Direction = ParameterDirection.Output;

                cmd.Parameters.Add(outputParmeter);

                con.Open();
                cmd.ExecuteNonQuery();

                string EmpId = outputParmeter.Value.ToString();
                lblMessage.Text = "Employee Id = " + EmpId;    

            }

        }
    } 
```

该程序应向 tblEmployees 表添加新行，然后将存储过程的输出参数输出给用户。单击按钮时，它会运行并将行添加到数字中，但输出参数未打印到屏幕上。想法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-04T20:16:09.610

也许：

```
select EmployeeId = SCOPE_IDENTITY() 
```

在存储过程中应该是：

```
select @EmployeeId = SCOPE_IDENTITY() 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-04T20:17:04.813

存储过程中的语法不正确。
你应该使用

```
select @EmployeeId = SCOPE_IDENTITY()  
       ^ 
```

检索输出参数的常用方法是通过命令集合。我不确定在此过程中参数是否在某处被替换

```
string EmpId = cmd.Parameters["@EmplyeeId"].Value.ToString(); 
```

# ios - 在这种情况下创建属性有什么意义

> ID：15820851
> 
> 赞同：-2
> 
> 时间：2013-04-04T20:13:57.637
> 
> 标签：ios, objective-c

假设我有：

```
@interface test : NSObject {
    BOOL bVal;
} 
```

人们一直说属性是访问 ivar 的更好方法，但他们这样做只是为了它吗？

在这种情况下，为什么我需要这个 ivar 的 @property？

我只是想知道人们是否知道他们为什么要做他们被告知的事情，或者我是否遗漏了什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T20:22:36.920

属性为您提供了一些不错的东西，例如合成的 getter 和 setter，它们肯定会以最好的方式编写，用于属性的保留/强、分配/弱、原子或非原子属性。如果您根本不需要类外部的代码来访问 ivar，那么您可能应该在实现本身中声明 ivar 并将其完全隐藏在外部，例如：

```
@implementation test {
    BOOL bVal;
} 
```

您的另一个问题的答案是，这当然取决于人。是的，这个网站上有很多人在没有真正理解的情况下模仿建议和代码片段。这里也有很多人真正知道他们在说什么。

# php - TCPDF：自动添加页面时的MultiCell

> ID：15820855
> 
> 赞同：0
> 
> 时间：2013-04-04T20:14:17.493
> 
> 标签：php, pdf-generation, tcpdf

我正在使用 TCPDF 进行报告，但是在 MultiCell 中，当生成新页面时，字符会安装在另一个页面上。我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T20:33:09.260

没有看到代码，这是无法回答的！

您是否按照 tcpdf 网站上的示例进行操作 - 多种页面格式

[http://www.tcpdf.org/examples.php](http://www.tcpdf.org/examples.php)

[http://www.tcpdf.org/examples/example_028.phps](http://www.tcpdf.org/examples/example_028.phps)

[http://www.tcpdf.org/examples/example_020.phps](http://www.tcpdf.org/examples/example_020.phps)

# multithreading - 终止线程变量并将其设置为 NULL

> ID：15820858
> 
> 赞同：1
> 
> 时间：2013-04-04T20:14:22.523
> 
> 标签：multithreading, c++builder, tthread

与`TThread`后代一起工作时，我基本上有一个选择：

*   设置`FreeOnTerminate`为`true`删除我的`TThread`后代对象但不将其设置为`NULL`
*   手动完成并自己完成删除它的所有麻烦

我基本上需要的是一种确定线程是否正在运行的方法，所以我做了以下事情：

```
//------------------------------------------------------------------------------
// Thread descendant
//------------------------------------------------------------------------------
class TMyThread : public TThread
    {
    private:   UnicodeString StatusLine;  // Used for Synchronize function

               void __fastcall UpdateGUI();
    protected: virtual void __fastcall Execute();
    public:                 __fastcall TMyThread();
    };
//------------------------------------------------------------------------------
TMyThread *MyThread;
//------------------------------------------------------------------------------

// Thread constructor
__fastcall TMyThread::TMyThread() : TThread(true)
{
FreeOnTerminate = false;
Priority        = tpNormal;
}

 // Synchronize function for Form1
void __fastcall TMyThread::UpdateGUI()
{
Form1->Label1 = StatusLine; 
}

// Execute code
void __fastcall TMyThread::Execute()
{
Sleep(2000);
StatusLine = "I am almost done!";
Synchronize(&UpdateGUI);
}

// Thread terminate, delete object, set to NULL
void __fastcall TForm1::ThreadTerminateIfDone(TMyThread *T)
{
if (T != NULL && WaitForSingleObject(reinterpret_cast<void*>(T->Handle),0) == WAIT_OBJECT_0)
    {
    T->Terminate();
    T->WaitFor();
    delete T;
    T = NULL;
    }
}

// And initialization part which needs to check if thread is already running
void __fastcall TForm1::StartOrRestartThread(TObject *Sender)
{
// Remove old thread if done
ThreadTerminateIfDone(MyThread);

// Check if thread is running - NULL = not running and terminated or uninitialized
if (MyThread == NULL)
    {
    MyThread = new TMyThread();
    MyThread->Start();
    }
else
    {
    Application->MessageBox(L"Thread is still running please wait!", L"Error", MB_OK);
    }
} 
```

此代码按原样工作。我的问题是：

*   有没有办法简化这个？完成后我需要设置`MyThread`为 NULL，以便在下次调用启动/重新启动之前该对象不存在？这不能通过`FreeOnTerminate`设置为 true 来完成，因为它会删除对象。我只能尝试访问然后生成异常的对象（我可以捕获但它是愚蠢的）。在初始化或重新启动之前，我真的只需要知道 MyThread 是否已完成执行。

*   我可以在不终止线程的情况下重新启动线程吗（在程序完成之前我真的不需要删除对象） - 如果我启动线程，我会得到“无法在正在运行或挂起的线程上调用启动”异常。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T20:22:13.770

在线程中运行一个while循环，在顶部等待一些等待以允许它在发出信号时运行一次，这比不断创建/终止/销毁线程以及相关的微管理更可取，没有其他课程是理智的。

创建线程，在顶部放置一个等待的while循环，发出信号让它运行并且永远不要终止线程，除非绝对强制。

死亡召唤：

```
TThread.WaitFor
TThread.Synchronize
TThread.Terminate 
```

永远不要使用这些。

简单的例子：

```
TmyThread=class(TThread);
private;
  mySimpleEvent:TSimpleEvent;
public
  constructor create;
  procedure go;
end;

constructor TmyThread.create;
begin
  inherited create(true);
  mySimpleEvent:=TSimpleEvent.Create;
  resume;
end;

procedure TmyThread.go;
begin
  mySimpleEvent.SetEvent;
end;

procedure TmyThread.Execute;
begin
  while mySimpleEvent.WaitFor(INFINITE) do
  begin
    mySimpleEvent.ResetEvent;
    //code to do your stuff
  end;
end; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T20:34:14.127

您的`ThreadTerminateIfDone()`函数需要通过引用获取线程指针，否则将无法正确将指针设置为 NULL：

```
void __fastcall TForm1::ThreadTerminateIfDone(TMyThread* &T) 
```

`ThreadTerminateIfDone()`话虽如此，如果您使用线程的`OnTerminate`事件来跟踪线程是否正在运行，则可以完全消除。当`FreeOnTerminate`设置为true时，`OnTerminate`在线程被释放之前触发，例如：

```
class TMyThread : public TThread
{
private:
    String StatusLine;  // Used for Synchronize function
    void __fastcall UpdateGUI();
protected:
    virtual void __fastcall Execute();
public:
    __fastcall TMyThread();
};
//------------------------------------------------------------------------------
extern TMyThread *MyThread;
//------------------------------------------------------------------------------ 
```

.

```
TMyThread *MyThread = NULL;

__fastcall TMyThread::TMyThread()
    : TThread(true)
{
    FreeOnTerminate = true;
    Priority        = tpNormal;
}

void __fastcall TMyThread::UpdateGUI()
{
    Form1->Label1 = StatusLine; 
}

void __fastcall TMyThread::Execute()
{
    Sleep(2000);
    StatusLine = "I am almost done!";
    Synchronize(&UpdateGUI);
}

void __fastcall TForm1::StartOrRestartThread(TObject *Sender)
{
    if (MyThread == NULL)
    {
        MyThread = new TMyThread();
        MyThread->OnTerminate = ThreadTerminated;
        MyThread->Start();
    }
    else
    {
        Application->MessageBox(L"Thread is still running please wait!", L"Error", MB_OK);
    }
}

void __fastcall TForm1::ThreadTerminated(TObject *Sender)
{
    MyThread = NULL;
} 
```

要回答您的其他问题，如果您希望线程可重新启动，那么您必须稍微更改线程设计，例如：

```
class TMyThread : public TThread
{
private:
    String StatusLine;  // Used for Synchronize function
    TEvent *RestartEvent;
    void __fastcall UpdateGUI();
protected:
    virtual void __fastcall Execute();
public:
    bool Busy;
    __fastcall TMyThread();
    __fastcall ~TMyThread();
    void __fastcall Restart();
};
//------------------------------------------------------------------------------
extern TMyThread *MyThread;
//------------------------------------------------------------------------------ 
```

.

```
TMyThread *MyThread = NULL;

__fastcall TMyThread::TMyThread()
    : TThread(true)
{
    FreeOnTerminate = true;
    Priority        = tpNormal;
    RestartEvent    = new TEvent(nil, true, true, "");
}

__fastcall TMyThread::~TMyThread()
{
    delete RestartEvent;
}

void __fastcall TMyThread::UpdateGUI()
{
    Form1->Label1 = StatusLine; 
}

void __fastcall TMyThread::Execute()
{
    while (!Terminated)
    {
        if (RestartEvent.WaitFor(1000) == wrSignaled)
        {
            if (Terminated) return;

            RestartEvent.ResetEvent();
            Busy = true;

            StatusLine = "I am doing something!";
            Synchronize(&UpdateGUI);

            Sleep(2000);

            StatusLine = "I am almost done!";
            Synchronize(&UpdateGUI);

            Busy = false;
        }
    }
}

void __fastcall TForm1::StartOrRestartThread(TObject *Sender)
{
    if (MyThread == NULL)
    {
        MyThread = new TMyThread();
        MyThread->OnTerminate = ThreadTerminated;
        MyThread->Start();
    }
    else if (!MyThread->Busy)
    {
        MyThread->Restart();
    }
    else
    {
        Application->MessageBox(L"Thread is still running please wait!", L"Error", MB_OK);
    }
}

void __fastcall TForm1::ThreadTerminated(TObject *Sender)
{
    MyThread = NULL;
} 
```

# java - 添加到 hashmap 和 arraylist

> ID：15820860
> 
> 赞同：1
> 
> 时间：2013-04-04T20:14:30.563
> 
> 标签：java, map, arraylist, hashmap

我正在尝试将哈希图添加到数组列表中。但是当我尝试向 arraylist(listOfCompleteEntries) 添加多个值时， map(completeEntrie) 会覆盖以前的值

```
public class MapExample {

    public static void main(String a[]) {
        ArrayList listOfCompleteEntries = new ArrayList();
        Map<String, String> completeEntrie = new HashMap<String, String>();

        for (int i = 0; i < 3; i++) {

            completeEntrie.put("KEY_NAME", "Number:" + i);
            System.out.print(completeEntrie.toString());
            listOfCompleteEntries.add(completeEntrie);
            System.out.println(listOfCompleteEntries.toString());
        }
        System.out.println(listOfCompleteEntries.toString());
    }
} 
```

上述代码的输出是

> {KEY_NAME=Number:0}[{KEY_NAME=Number:0}]
> {KEY_NAME=Number:1}[{KEY_NAME=Number:1}, {KEY_NAME=Number:1}]
> {KEY_NAME=Number:2}[{KEY_NAME =编号：2}，{KEY_NAME=编号：2}，{KEY_NAME=编号：2}]
> [{KEY_NAME=编号：2}，{KEY_NAME=编号：2}，{KEY_NAME=编号：2}]

但我希望输出是这样的

> {KEY_NAME=Number:0}[{KEY_NAME=Number:0}]
> {KEY_NAME=Number:1}[{KEY_NAME=Number:0}, {KEY_NAME=Number:1}]
> {KEY_NAME=Number:2}[{KEY_NAME =编号：0}，{KEY_NAME=编号：1}，{KEY_NAME=编号：2}]
> [{KEY_NAME=编号：0}，{KEY_NAME=编号：1}，{KEY_NAME=编号：2}]

还请解释为什么这张地图会覆盖 arraylist 中的前一张地图。谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T20:18:21.903

尽管标题不相关，但您需要为要添加到数组列表的每个唯一条目构建一个新的地图实例。没有这个，你正在修改同一个地图实例。

# jquery - 如何为给定的堆叠列设置自定义样式？

> ID：15820867
> 
> 赞同：1
> 
> 时间：2013-04-04T20:14:48.503
> 
> 标签：jquery, highcharts

我正在努力实现这一目标：

我有一个包含 4 个系列的堆叠柱形图，我希望用户能够单击堆叠列（不是单个列，整个堆叠列）来选择这些点并更改宽度、颜色、添加 dataLabels仅选定的堆叠列。这需要显示有关所选堆叠列的更多详细信息。

该系列看起来像这样：

```
series: [{
    name: 'd',
    data: [120000, 120000, 120000, 120000, 120000, 120000, 120000, 120000, 120000, 120000, 120000, 120000, 120000, 120000, 120000],
    color: '#ffffff'
}, {
    name: 'c',
    data: [40000, 67000, 94000, 121000, 148000, 175000, 202000, 229000, 256000, 283000, 310000, 337000, 364000, 391000, 418000],
    color: '#bde0db'
}, {
    name: 'b',
    data: [75000, 73000, 71000, 69000, 67000, 65000, 63000, 61000, 59000, 57000, 55000, 53000, 51000, 49000, 47000],
    color: '#a7dcf0'
}, {
    name: 'a',
    data: [450000, 425000, 400000, 375000, 350000, 325000, 300000, 275000, 250000, 225000, 200000, 175000, 150000, 125000, 100000],
    color: '#8dbad2'
}] 
```

jsfiddle： http: [//jsfiddle.net/XFDdz/6/](http://jsfiddle.net/XFDdz/6/)（感谢Dmonix！）

有没有办法做到这一点？如果有怎么办？

编辑：从我在这里看到的，我想要的部分是可行的（堆叠列的宽度不同）：[http](http://www.fusioncharts.com/demos/gallery/#marimekko-charts) ://www.fusioncharts.com/demos/gallery/#marimekko-charts和[http://highcharts。 uservoice.com/forums/55896-general/suggestions/2303560-multi-dimensional-column-charts](http://highcharts.uservoice.com/forums/55896-general/suggestions/2303560-multi-dimensional-column-charts)

如果有人能为我指出宽度问题的正确方向，以及为选定的堆叠列点重新设置样式和添加数据标签，我将不胜感激！

编辑 2：我想出了如何将颜色设置为给定点，仍然需要找出如何设置宽度。以下系列中的解决方案：

```
series: [{
    name: 'd',
    data: [120000, 120000, 120000, {name: 'point 1',color: '#df4a92',y:120000,pointWidth:100}, 120000, 120000, 120000, 120000, 120000, 120000, 120000, 120000, 120000, 120000, 120000],
    color: '#ffffff'
}, {
    name: 'c',
    data: [40000, 67000, 94000, {name: 'point 1',color: '#81c6bd',y:121000,pointWidth:100}, 148000, 175000, 202000, 229000, 256000, 283000, 310000, 337000, 364000, 391000, 418000],
    color: '#bde0db'
}, {
    name: 'b',
    data: [75000, 73000, 71000, {name: 'point 1',color: '#58c3eb',y:69000,pointWidth:100}, 67000, 65000, 63000, 61000, 59000, 57000, 55000, 53000, 51000, 49000, 47000],
    color: '#a7dcf0'
}, {
    name: 'a',
    data: [450000, 425000, 400000, {name: 'point 1',color: '#2e87b7',y:375000,pointWidth:100}, 350000, 325000, 300000, 275000, 250000, 225000, 200000, 175000, 150000, 125000, 100000],
    color: '#8dbad2'
}] 
```

忽略数据集中的pointWidth，它什么都不做..

编辑 3：我可以通过直接操作 SVG 元素来设置宽度，但这是一个非常糟糕的 hack，我真的希望通过 API 来解决它，并且这种方法不会调整/放置其余列的大小：

```
$(".highcharts-series.highcharts-tracker rect[fill='#2e87b7']").attr('width',175)
$(".highcharts-series.highcharts-tracker rect[fill='#58c3eb']").attr('width',175)
$(".highcharts-series.highcharts-tracker rect[fill='#81c6bd']").attr('width',175)
$(".highcharts-series.highcharts-tracker rect[fill='#df4a92']").attr('width',175) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-06T13:28:27.077

最终解决方案是创建与列高度和位置匹配的新 SVG 元素（使用 Highcharts.renderer），然后将新元素重新定位在实际图形上。然后，我根据新元素中的 data-rel 标记和数据标签中的匹配 css 类名称重新定位数据标签。

唯一（可接受的）缺点是该列与前一列和下一列重叠。

由于无法通过 Highcharts API 做到这一点，我接受这个答案。

# ios - 为什么我会收到构建错误（当我尝试调用它时使用了未声明的标识符“methodName”？

> ID：15820868
> 
> 赞同：0
> 
> 时间：2013-04-04T20:14:49.040
> 
> 标签：ios, objective-c

我在 .m 文件中定义了这个方法：

```
-(void)showHTMLHelp:(NSString *)htmlString pointTo:(UITextField *)textField background:(UIColor *)bgColor  { 
```

}

这是 .h 文件中的内容：

```
-(void)showHTMLHelp:(NSString *)htmlString pointTo:(UITextField *)textField background:(UIColor *)bgColor; 
```

这是我试图调用它的地方，但是**使用了未声明的标识符“showHTMLHelp”** 构建错误。

```
[showHTMLHelp htmlString:html pointTo:tfShopOpens background:[UIColor whiteColor]]; 
```

如您所见，它在 .h 文件中声明，该文件被导入 .m 文件（正常）。这是什么原因造成的？我查看了 Google 和 SO（没有发现任何具体内容），完成了多次清理，但它不会消失。我试过像这样把'self'放在前面：[self.showHTMLHelp] 然后我得到：

> 在“PreferencesViewController *”类型的对象上找不到属性“showHTMLHelp”

我做错了什么，我该如何解决？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T20:17:50.227

因此，您调用的方法名称不正确（您有参数名称），您确实需要调用它`self`：

```
[self showHTMLHelp:html pointTo:tfShopOpens background:[UIColor whiteColor]]; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-04T20:22:15.540

你有正确的想法：

```
[self.showHTMLHelp... 
```

您需要首先说明您正在调用该方法的对象，然后调用该方法。但是，您不能使用点表示法。您将使用它来访问属性。它应该看起来像：

```
[self showHTMLHelp:html pointTo:tfShopOpens background:[UIColor whiteColor]]; 
```

# mysql - 两个mysql都插入或不插入

> ID：15820874
> 
> 赞同：0
> 
> 时间：2013-04-04T20:15:22.563
> 
> 标签：mysql, forms

我有一个发布到 php 的表单。作为帖子的一部分，我需要将数据插入到 2 个不同的表中。现在我只做一个插入，然后是第二个插入。

你可能已经知道我接下来要问什么了 :)

我需要能够确保两个插入都发生。如果第二个没有发生，我需要第一个不发生或回滚。

我的理解是，如果 mysql 使用 innodb，这是可能的，这是 mysql 5.5 及更高版本的默认设置，但我使用的是 mysql 5.3，这是 centos 的最新版本。不知道我怎么知道，如果打开了innodb，我该如何编写查询？然后当然我可能不得不假设任何可能使用我的程序的人可能没有正确版本的 mysql 和 innodb。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T20:55:49.950

创建表时，您可以指定它应该运行的引擎。为了能够在 InnoDB 中使用它需要的事务。那部分在*表 options*[`CREATE TABLE`](http://dev.mysql.com/doc/refman/5.5/en/create-table.html)的末尾。如果您的表还不是 InnoDB，您可以使用.*`ALTER TABLE`*

 *可以从 php 将 auto_commit 设置为 false，这就是您想要做的。然后你所做的一切都将在一个事务中，直到你进行提交或回滚。

另一种选择是手动发送`START TRANSACTION`,`COMMIT`或`ROLLBACK`. [php 手册](http://php.net/manual/en/mysqlnd-ms.quickstart.transactions.php)中有一个示例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T20:41:00.590

```
START TRANSACTION

if(first insert failed)
{
    ROLLBACK
}
else if(second insert failed)
{
    ROLLBACK
}
else
{
    COMMIT
} 
```*

# c# - 切换精灵时遇到问题

> ID：15820876
> 
> 赞同：1
> 
> 时间：2013-04-04T20:15:27.397
> 
> 标签：c#, xna

好的，我有一个包含移动代码等的玩家类。我的问题是当按下“2”键时，我希望玩家精灵（默认情况下是非武装的）切换到一个拿着枪的人。

直到我尝试在游戏中添加第三把枪，我才开始工作，此时我只能通过一直按住“2”和“3”键才能看到这两把枪。

我希望它切换，我认为我对布尔值的使用可能是原因，但这是代码

```
using System;
using System.Collections.Generic;
using System.Linq;
using Microsoft.Xna.Framework;
using Microsoft.Xna.Framework.Audio;
using Microsoft.Xna.Framework.Content;
using Microsoft.Xna.Framework.GamerServices;
using Microsoft.Xna.Framework.Graphics;
using Microsoft.Xna.Framework.Input;
using Microsoft.Xna.Framework.Media;
using Microsoft.Xna.Framework.Net;
using Microsoft.Xna.Framework.Storage;

namespace Teir_Tactical_2A 
{
    public class Player
    {
        public Texture2D playerunarmed;
        public Texture2D playerM1911;
        public Texture2D playerM4;
        public KeyboardState keyState;
        public KeyboardState oldKeyboardState;
        public Vector2 playerPosition;
        public SpriteBatch spriteBatch;
        public float Angle { get; set; }
        public float AngularVelocity { get; set; }
        public Vector2 playerVelocity = Vector2.One;
        public bool unarmed;
        public bool M1911;
        public bool M4;
        public bool IsToggled = false;
        float angle;

        public Player(ContentManager content, Vector2 location)
        {
            this.playerunarmed = content.Load<Texture2D>("PLAYER");
            this.playerM1911 = content.Load<Texture2D>("PLAYERM1911");
            this.playerM4 = content.Load<Texture2D>("PLAYERM4");
            playerPosition = location;
            unarmed = true;
            M4 = true;
            M1911 = true;           
        }

        public void Update()
        {
            MouseState curMouse = Mouse.GetState();

            if (M1911 == true)
            {
                armed();
            }

            if (unarmed == true)
            {
                armed();
            }

            if (M4 == true)
            {
                armed();
            }

            Vector2 mouseLoc = new Vector2(curMouse.X, curMouse.Y);
            Vector2 direction = mouseLoc - playerPosition;
            angle = (float)(Math.Atan2(direction.Y, direction.X));
            keyState = Keyboard.GetState();         

            if (keyState.IsKeyDown(Keys.D1))
            {
                unarmed = true;
                M4 = false;
                M1911 = false;              
            }

            if (keyState.IsKeyDown(Keys.D2))
            {
                M1911 = true;
                M4 = false;
                unarmed = false;         
            }

            if (keyState.IsKeyDown(Keys.D3))
            {
                M4 = true;
                unarmed = false;
                M1911 = false;
            }                     

            if (keyState.IsKeyDown(Keys.D))
                playerPosition.X += playerVelocity.X + 1;
            if (keyState.IsKeyDown(Keys.A))
                playerPosition.X -= playerVelocity.X + 1;
            if (keyState.IsKeyDown(Keys.W))
                playerPosition.Y -= playerVelocity.Y + 1;
            if (keyState.IsKeyDown(Keys.S))
                playerPosition.Y += playerVelocity.Y + 1;
        }

        public void Draw(SpriteBatch spriteBatch)
        {
            spriteBatch.Begin();
            {
                Rectangle sourceRectangle = new Rectangle(0, 0, playerunarmed.Width, playerunarmed.Height);
                Vector2 origin = new Vector2(playerunarmed.Width / 2, playerunarmed.Height / 2);

                if (unarmed == true)
                {
                    spriteBatch.Draw(playerunarmed, new Rectangle((int)playerPosition.X, (int)playerPosition.Y, playerunarmed.Width, playerunarmed.Height), null, Color.White, angle + 90, new Vector2(62, 70), SpriteEffects.None, 0f);
                }

                if (M1911 == true)
                {
                    spriteBatch.Draw(playerM1911, new Rectangle((int)playerPosition.X, (int)playerPosition.Y, playerunarmed.Width, playerunarmed.Height), null, Color.White, angle + 90, new Vector2(62, 70), SpriteEffects.None, 0f);
                }

                if (M4 == true)
                {
                    spriteBatch.Draw(playerM4, new Rectangle((int)playerPosition.X, (int)playerPosition.Y, playerunarmed.Width, playerunarmed.Height), null, Color.White, angle + 90, new Vector2(62, 70), SpriteEffects.None, 0f);
                }
            }
            spriteBatch.End();
        }

        public void armed()
        {
            M1911 = false;
            M4 = false;
            unarmed = true;
        }
    }
} 
```

现在我认为问题出在这，就在这里

```
if (keyState.IsKeyDown(Keys.D1))
{
    unarmed = true;
    M4 = false;
    M1911 = false;

}

if (keyState.IsKeyDown(Keys.D2))
{
    M1911 = true;
    M4 = false;
    unarmed = false;        
}

if (keyState.IsKeyDown(Keys.D3))
{
    M4 = true;
    unarmed = false;
    M1911 = false;
} 
```

不知何故，我必须让按键切换，这样当我按下“3”时，它确保 M1911 和非武装变量设置为假，而 M4 值设置为真。

我会以正确的方式解决这个问题吗？

我也尝试过 IsKeyUp && IsKeyDown 方法，您可以在其中将当前状态链接到旧状态，但这只会导致枪在消失之前短暂地在屏幕上闪烁，所以如果有办法解决这个问题，那就是伟大的

编辑：那么有没有办法编辑武装方法，以便在按下键时改变武器状态？

第二次编辑：我想通了，我给每个武器状态都赋予了它自己的 armed(); 变量，然后在底部武装（）中添加真/假设置；这里的变量：

```
 public void armedM1911()
    {
        M1911 = true;
        M4 = false;
        player = false;

    }
    public void armedM4()
    {
        M4 = true;
        M1911 = false;
        player = false;
    }
    public void unarmed()
    {
        M1911 = false;
        M4 = false;
    }
} 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T20:29:00.680

`armed()`无论您的武器状态如何，您都在每个更新循环开始时调用该方法

```
if (M1911 == true)
{
    armed();
}

if (unarmed == true)
{
    armed();
}
if (M4 == true)
{
    armed();
} 
```

这显然是调用

```
public void armed()
{
    M1911 = false;
    M4 = false;
    unarmed = true;
} 
```

这会将你的武器设置为 false 和`unarmed`true

所以即使你认为你可能会在循环结束时切换你的状态，当你放开按键时，它总是会再次重置下一个循环。

# html - CSS 部分悬停在下部元素后面

> ID：15820878
> 
> 赞同：1
> 
> 时间：2013-04-04T20:15:31.433
> 
> 标签：html, css

我在一系列表单上有一个情况，我在输入框上有一个悬停提示。在少数情况下，有足够的文本将悬停元素换行到第二行下拉“覆盖”其下方的下一个表单元素。问题在于，悬停元素实际上是在下面的输入框下方而不是在下方的输入框上方，这违背了目的。

任何帮助将不胜感激。

这是HTML：

Address1: " id="address1" /> 您的街道地址。

```
<div class="field">
  <label for="address2">Address2:</label>
  <input type="text" class="input" name="address2" value="<?php if ($row_GuestLookup['customer_fname']) { echo $row_GuestLookup['address2']; } ?>" id="address2" />
  <p class="hint">Any extra street address information if necessary.</p>
</div>

<div class="field">
  <label for="city">City:</label>
  <input type="text" class="input" name="city" value="<?php if ($row_GuestLookup['customer_fname']) { echo $row_GuestLookup['city']; } ?>" id="city" />
  <p class="hint">Your city.</p>
</div> 
```

这是相关的CSS。

```
#defaultform {
 width: 600px;
 margin-left: auto;
 margin-right: auto;
 padding: 20px;
 background: #f0f0f0;
 overflow:auto;

 /* Border style */
 border: 1px solid #cccccc;
 -moz-border-radius: 7px;
 -webkit-border-radius: 7px;
 border-radius: 7px;

 /* Border Shadow */
 -moz-box-shadow: 2px 2px 2px #cccccc;
 -webkit-box-shadow: 2px 2px 2px #cccccc;
 box-shadow: 2px 2px 2px #cccccc;

}
.hint{
  display: none;
}

.field {
  position: relative;
  height: 30px;
}

.field:hover .hint {
  position: absolute;
  display: block;
  margin: -30px 0 0 375px;
  color: #FFFFFF;
  padding: 7px 10px;
  background: rgba(0, 0, 0, 0.6);

  -moz-border-radius: 7px;
  -webkit-border-radius: 7px;
  border-radius: 7px;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T20:22:34.483

在 上，如果不指定位置和值（例如或类似`.field:hover .hint`），您将无法获得 的好处。我建议像这样制作这些元素：`position: absolute;``top:0px;`

```
.field {
  position: relative;
  height: 30px;
  z-index:100;
  display:block;

  # Just to see if it's collapsing since I can't 
  # tell if the elements inside are floating too.
  float:left; 
}

.field:hover .hint {
  position: relative;
  z-index: 101;

  display: block;
  margin: -30px 0 0 375px;
  color: #FFFFFF;
  padding: 7px 10px;
  background: rgba(0, 0, 0, 0.6);

  -moz-border-radius: 7px;
  -webkit-border-radius: 7px;
  border-radius: 7px;
} 
```

还要确保里面的元素

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T20:18:33.313

像这样更改提示类的[z-index ：](http://www.w3schools.com/cssref/pr_pos_z-index.asp)

```
.field:hover .hint {
position: absolute;
display: block;
margin: -30px 0 0 375px;
color: #FFFFFF;
padding: 7px 10px;
background: rgba(0, 0, 0, 0.6);
z-index:10000;

-moz-border-radius: 7px;
-webkit-border-radius: 7px;
border-radius: 7px;
} 
```

**编辑：** 您可能想要使用与 10000 不同的值。我只是将其用于说明目的。

# javascript - Javascript：向同步 REST API 调用添加超时

> ID：15820886
> 
> 赞同：0
> 
> 时间：2013-04-04T20:15:52.403
> 
> 标签：javascript, jquery, rest

我将调用一个进行同步 REST API 调用的函数。如果它在一段时间内没有返回，我想以某种方式超时该函数调用。我怎么做？

```
callBlahService = function(args){
    // make actual rest api call
    $.ajax{
        // arguments
        async: false
    }
}

callBlahService({
    success:function(data){
        console.log("blah successful");
    },
    error: function(data){
        console.log("blah failed");
    }
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T20:22:23.607

看起来你正在使用 JQuery。应该使用一个`timeout`设置：http: [//api.jquery.com/jQuery.ajax/](http://api.jquery.com/jQuery.ajax/)`$.ajax`

如果超时，您的错误处理程序将被调用。

```
$.ajax({
    timeout: 1000,
    success: function(response) {},
    error: function(x, t, m) {
        if(t==="timeout") {
            alert("timed out!");
        } 
    }
});​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T20:19:40.797

> **超时**
> 
> 类型：[数字](http://api.jquery.com/Types#Number)
> 
> 为请求设置超时（以毫秒为单位）。这将覆盖使用[$.ajaxSetup()](http://api.jquery.com/jQuery.ajaxSetup)设置的任何全局超时。超时时间从 $.ajax 调用开始；如果有几个其他请求正在进行并且浏览器没有可用的连接，则请求可能会在发送之前超时。**在 jQuery 1.4.x 及以下版本中**，如果请求超时，XMLHttpRequest 对象将处于无效状态；访问任何对象成员都可能引发异常。**仅在 Firefox 3.0+**中，脚本和 JSONP 请求不能被超时取消；即使脚本在超时期限之后到达，它也会运行。 [http://api.jquery.com/jQuery.ajax/](http://api.jquery.com/jQuery.ajax/)

# unity3d - 在 Unity3d 运行时将 PNG 图像加载为纹理

> ID：15820890
> 
> 赞同：9
> 
> 时间：2013-04-04T20:16:09.047
> 
> 标签：unity3d, textures

我正在使用一系列 PNG 图像作为精灵在平面上为 Unity 中的增强现实应用程序创建动画。PNG 图像作为纹理加载，并将纹理应用于平面以创建跟踪增强现实目标的动画序列。

这是附加到平面并控制动画序列的脚本。

### 文件 PNGSequence.js

```
#pragma strict
var tecture : Texture[];

var changeInterval : float = 0.06;
var isRunning = false;
var isLooping = false;

function Start () {
    var isRunning = true;
}

function Update () {
    if( isRunning == true) {
        Animation ();
    }
}

function Animation () {
    var index : int = Time.time/changeInterval;
    index = index % tecture.Length;
    renderer.material.mainTexture = tecture[index];
    if ( index == tecture.Length-1){
        if( isLooping == false){
            isRunning = false;
        }
           renderer.material.mainTexture = tecture[0];
    }
} 
```

纹理是通过在编辑器中拖放 PNG 文件来分配的，如果我限制 PNG 数量，一切都会正常工作。然而，随着我的纹理数量增加，我在 Android 上出现内存不足错误。

我想在运行时将 PNG 文件加载为纹理以限制数字内存，但我无法让代码正常工作。

我试过LoadImage。

```
var imageTextAsset : TextAsset = Resources.Load("test.png");
var tex = new Texture2D (4, 4);
tex.LoadImage(imageTextAsset.bytes);
renderer.material.mainTexture = tex; 
```

我还尝试将图像直接加载为纹理（因为这似乎适用于编辑器）。

```
renderer.material.mainTexture = Resources.LoadAssetAtPath"Assets/Images/test.png",Texture); 
```

也没有运气。关于如何做到这一点的任何建议？

**已编辑**

由于 Xerosigma 提供的链接，我能够得到这个工作。我遇到了路径问题（我怀疑加载时的纹理要求）。

除了加载 PNG 纹理之外，我还发现 Unity 不会对纹理进行内存管理。为了恢复内存，纹理在使用后需要手动卸载。

纹理都放置在“资源”文件夹中。资源文件夹可以放置在资产层次结构中的任何位置——我为每个 PNG 序列创建了几个单独的文件夹来组织它们，然后在每个文件夹中添加了一个资源文件夹来保存实际的 PNG。

通过指定纹理计数（即 100）、基本名称（例如“texture_”）和零填充，通过编辑器分配纹理。

### 文件 PNGSequenceRunTime.js

```
#pragma strict

var imageCount : int = 0;
var imageNameBase : String = "";
var imageNameZeroPadding : int = 0;

var changeInterval : float = 0.06;
var isRunning = false;
var isLooping = false;

private var texture : Texture = null;

function PlayRocket () {
    isRunning = true;
}

function Start () {
    var isRunning = false;
    var fileName : String = imageNameBase + ZeroPad(0,imageNameZeroPadding);
    texture = Resources.Load(fileName);
}

function Update () {
    if( isRunning == true) {
        PNGAnimation ();
    }
}

function PNGAnimation () {
    var index : int = Time.time/changeInterval;
    index = index % imageCount;
    var fileName : String = imageNameBase + ZeroPad(index,imageNameZeroPadding);
    Resources.UnloadAsset(texture);
    texture = Resources.Load(fileName);
    renderer.material.mainTexture = texture;

    if ( index == imageCount-1){
        Debug.Log("End of Animation");
        Debug.LogWarning("End of Animation");
        if( isLooping == false){
            isRunning = false;
        }
        fileName = imageNameBase + ZeroPad(0,imageNameZeroPadding);
        Resources.UnloadAsset(texture);
        texture = Resources.Load(fileName);
        renderer.material.mainTexture = texture;
    }
}

function ZeroPad(number : int, size : int) {
    var numberString : String = number.ToString();
    while (numberString.Length < size) numberString = "0" + numberString;
    return numberString;
} 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-04-04T21:57:49.217

**在 C# 中：**

```
// Load all textures into an array
Object[] textures = Resources.LoadAll("Textures", typeof(Texture2D));

// Load a single texture
Texture2D texture = Resources.Load("Texture") as Texture2D;

renderer.material.mainTexture = texture; 
```

希望能帮助到你。你应该可以把它转换成 JS 没问题。只需查看 Unity 文档即可。

[http://docs.unity3d.com/Documentation/ScriptReference/Resources.html](http://docs.unity3d.com/Documentation/ScriptReference/Resources.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-11-18T12:57:33.160

我通过将任何 .png 图像序列（带有 alpha 通道）放置在主 Assets 文件夹内的文件夹 Resources/Sequence1 中来实现相同的效果。输出是完全根据图像的 Alpha 通道以透明方式播放的无缝电影。

此代码应用于分配了具有透明/漫反射着色器的默认新材质的平面。此着色器支持以 alpha 作为透明度的 PNG 图像。您只需将包含图像的文件夹的名称提供给变量 framespath。

```
#pragma strict

var framespath: String = "";
var vidframes: Object[];
var count: int;

function Start () {

    vidframes = Resources.LoadAll(framespath, Texture);
    Debug.Log(vidframes.Length);

    count = 0;
    renderer.material.mainTexture = vidframes[count];
}

function Update () {
    count++;
    renderer.material.mainTexture = vidframes[count];
    if (count == vidframes.Length-1)
    {
        count = 0;
    }
} 
```

# c++ - 将向量复制到结构中

> ID：15820892
> 
> 赞同：-1
> 
> 时间：2013-04-04T20:16:11.720
> 
> 标签：c++, vector, struct, copy

这是要点。我有一个带有字符串的结构，它有一个可以调用结构中信息的向量。我想创建一个我可以引用的文件，但为了做到这一点，我需要一个具有字符的结构，具有设定的大小，我不能只是将原始结构切换到字符。这就是我所拥有的：

```
struct PERSON
{
    string fName;
    string lName;
    string Address;
};

struct tmpPERSON
{
    char fName2[50];
    char lName2[50];
    char Address2[50];
};

class addressBook
{
private:
    vector<PERSON> people;
}; 
```

我需要能够将存储的信息从我的人员向量复制到我的 tmpPERSON 结构中。任何人都知道如何做到这一点，因为我只是迷路了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T20:52:42.367

像这样：

```
for (vector<PERSON>::iterator iter = people.begin(), end = people.end(); iter != end; ++iter)
{
    tmpPERSON tmp;

    strncpy(tmp.fName, iter->fName.c_str(), 50);
    strncpy(tmp.lName, iter->lName.c_str(), 50);
    strncpy(tmp.Address, iter->Address.c_str(), 50);

    // use tmp as needed...
} 
```

# log4j - 警告找不到记录器的附加程序（org.apache.accumulo.start.classloader.AccumuloClassLoader）

> ID：15820894
> 
> 赞同：2
> 
> 时间：2013-04-04T20:16:14.693
> 
> 标签：log4j, accumulo

有谁知道如何在启动 accumulo 时摆脱以下警告：

```
log4j:WARN No appenders could be found for logger (org.apache.accumulo.start.classloader.AccumuloClassLoader).
log4j:WARN Please initialize the log4j system properly.
log4j:WARN See http://logging.apache.org/log4j/1.2/faq.html#noconfig for more info. 
```

我正在运行 accumulo 1.4.0 hadoop 0.20.2 和 zookeeper 3.3.3。我理解这个警告的发生是因为类找不到 log4j.properties 文件，是的，我已经阅读了[http://logging.apache.org/log4j/1.2/manual.html](http://logging.apache.org/log4j/1.2/manual.html)。我的 log4j.properties 文件包含从 accumulo 1.4.3 log4j 文件复制的以下行（我没有将系统升级到 1.4.3 的选项）：

```
# default logging properties:
#  by default, log everything at INFO or higher to the console
log4j.rootLogger=INFO,A1

# hide Jetty junk
log4j.logger.org.mortbay.log=WARN,A1

# hide "Got brand-new compresssor" messages
log4j.logger.org.apache.hadoop.io.compress=WARN,A1

# hide junk from TestRandomDeletes
log4j.logger.org.apache.accumulo.server.test.TestRandomDeletes=WARN,A1

# hide almost everything from zookeeper
log4j.logger.org.apache.zookeeper=ERROR,A1

# hide AUDIT messages in the shell, alternatively you could send them to a different logger
log4j.logger.org.apache.accumulo.core.util.shell.Shell.audit=WARN,A1

# Send most things to the console
log4j.appender.A1=org.apache.log4j.ConsoleAppender
log4j.appender.A1.layout.ConversionPattern=%d{ISO8601} [%-8c{2}] %-5p: %m%n
log4j.appender.A1.layout=org.apache.log4j.PatternLayout 
```

我已经把这个 log4j 文件给大家了。在 accumulo/bin 文件夹中，在 accumulo/conf 文件夹中，在 accumulo/lib 文件夹中，但无法摆脱此警告（我知道它必须在 accumulo 类路径上，但不知道在哪里）。我也无法将 log4j.configuration 选项传递给 java 编译器，因为 accmulo 可执行文件是预编译的（我只是运行它）。

在此先感谢您的帮助。

编辑：下面是我系统上“accumulo classpath”命令的结果：

```
[admin-cloud@NODE1 bin]$ echo $ACCUMULO_HOME
/accumulo/accumulo-1.4.0
[admin-cloud@NODE1 bin]$ accumulo classpath
Accumulo List of classpath items are:
file:/accumulo/accumulo-1.4.0/lib/commons-collections-3.2.jar
file:/accumulo/accumulo-1.4.0/lib/commons-configuration-1.5.jar
file:/accumulo/accumulo-1.4.0/lib/log4j-1.2.16.jar
file:/accumulo/accumulo-1.4.0/lib/libthrift-0.6.1.jar
file:/accumulo/accumulo-1.4.0/lib/commons-jci-core-1.0.jar
file:/accumulo/accumulo-1.4.0/lib/commons-lang-2.4.jar
file:/accumulo/accumulo-1.4.0/lib/commons-logging-api-1.0.4.jar
file:/accumulo/accumulo-1.4.0/lib/accumulo-server-1.4.0.jar
file:/accumulo/accumulo-1.4.0/lib/accumulo-start-1.4.0.jar
file:/accumulo/accumulo-1.4.0/lib/commons-jci-fam-1.0.jar
file:/accumulo/accumulo-1.4.0/lib/jline-0.9.94.jar
file:/accumulo/accumulo-1.4.0/lib/examples-simple-1.4.0.jar
file:/accumulo/accumulo-1.4.0/lib/cloudtrace-1.4.0.jar
file:/accumulo/accumulo-1.4.0/lib/commons-logging-1.0.4.jar
file:/accumulo/accumulo-1.4.0/lib/accumulo-core-1.4.0.jar
file:/accumulo/accumulo-1.4.0/lib/commons-io-1.4.jar
file:/zookeeper/zookeeper-3.3.6/zookeeper-3.3.6.jar
file:/hadoop/hadoop-0.20.2/conf/
file:/hadoop/hadoop-0.20.2/hadoop-0.20.2-examples.jar
file:/hadoop/hadoop-0.20.2/hadoop-0.20.2-test.jar
file:/hadoop/hadoop-0.20.2/hadoop-0.20.2-tools.jar
file:/hadoop/hadoop-0.20.2/hadoop-0.20.2-ant.jar
file:/hadoop/hadoop-0.20.2/hadoop-0.20.2-core.jar
file:/hadoop/hadoop-0.20.2/lib/log4j-1.2.15.jar
file:/hadoop/hadoop-0.20.2/lib/jasper-runtime-5.5.12.jar
file:/hadoop/hadoop-0.20.2/lib/slf4j-log4j12-1.4.3.jar
file:/hadoop/hadoop-0.20.2/lib/commons-httpclient-3.0.1.jar
file:/hadoop/hadoop-0.20.2/lib/mockito-all-1.8.0.jar
file:/hadoop/hadoop-0.20.2/lib/jetty-6.1.14.jar
file:/hadoop/hadoop-0.20.2/lib/oro-2.0.8.jar
file:/hadoop/hadoop-0.20.2/lib/servlet-api-2.5-6.1.14.jar
file:/hadoop/hadoop-0.20.2/lib/junit-3.8.1.jar
file:/hadoop/hadoop-0.20.2/lib/commons-logging-api-1.0.4.jar
file:/hadoop/hadoop-0.20.2/lib/commons-codec-1.3.jar
file:/hadoop/hadoop-0.20.2/lib/core-3.1.1.jar
file:/hadoop/hadoop-0.20.2/lib/jets3t-0.6.1.jar
file:/hadoop/hadoop-0.20.2/lib/hsqldb-1.8.0.10.jar
file:/hadoop/hadoop-0.20.2/lib/slf4j-api-1.4.3.jar
file:/hadoop/hadoop-0.20.2/lib/jasper-compiler-5.5.12.jar
file:/hadoop/hadoop-0.20.2/lib/jetty-util-6.1.14.jar
file:/hadoop/hadoop-0.20.2/lib/commons-net-1.4.1.jar
file:/hadoop/hadoop-0.20.2/lib/commons-logging-1.0.4.jar
file:/hadoop/hadoop-0.20.2/lib/commons-cli-1.2.jar
file:/hadoop/hadoop-0.20.2/lib/xmlenc-0.52.jar
file:/hadoop/hadoop-0.20.2/lib/kfs-0.2.2.jar
file:/hadoop/hadoop-0.20.2/lib/commons-el-1.0.jar 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-06T14:27:39.330

Apache Accumulo 1.4.0 中 bin/accumulo 的第 84 行将变量 XML_FILES 设置为 $ACCUMULO_HOME/conf，然后将 XML_FILES 添加到稍后传递给 java 命令的 CLASSPATH 变量中。

[https://svn.apache.org/repos/asf/accumulo/tags/1.4.0/bin/accumulo](https://svn.apache.org/repos/asf/accumulo/tags/1.4.0/bin/accumulo)

听起来您通过 shell 环境或 $ACCUMULO_HOME/conf/accumulo-env.sh 对 ACCUMULO_HOME 进行了错误配置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-11T14:07:56.720

我正在对其他人设置的遇到相同问题的安装进行故障排除。我对这个问题的解决方案很简单，就是 conf 目录中实际上没有 log4j.properties！所以我只是从 conf/examples 目录中复制了一个 log4j.properties，重新启动，一切正常！

# c# - 使用 ASP.NET MVC 应用程序授权 Twitter

> ID：15820898
> 
> 赞同：0
> 
> 时间：2013-04-04T20:16:31.487
> 
> 标签：c#, twitter

我有一个 ASP.NET MVC 应用程序。我想将 Twitter 用户的帐户链接到我的应用程序中的用户帐户。以前，我使用的是 Twitterizer。但是，据我了解，该库将不再工作，因为 Twitter 改变了他们的授权方式。考虑到这一点，C# 开发人员推荐使用什么库？

有谁知道 C# 开发人员可以用来获取 Twitter 用户访问密钥和访问令牌的库？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T21:00:21.377

在新的 ASP MVC 4 模板中，您已完成所有工作并可以使用：http: [//blogs.msdn.com/b/webdev/archive/2012/08/15/oauth-openid-support-for-webforms-mvc-和-webpages.aspx](http://blogs.msdn.com/b/webdev/archive/2012/08/15/oauth-openid-support-for-webforms-mvc-and-webpages.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T20:57:13.263

您将使用 OAuth 连接到他们的身份验证系统。对于 .NET 来说，有一些非常有效的库，请查看 twitter 的开发站点以获取最新的库：

[https://dev.twitter.com/docs/twitter-libraries](https://dev.twitter.com/docs/twitter-libraries)

# javascript - 如何测试CSS文件是否在head中链接

> ID：15820900
> 
> 赞同：0
> 
> 时间：2013-04-04T20:16:48.843
> 
> 标签：javascript, jquery

我想测试`iframe`我的页面上是否有指向“css/iframeMobile.css”的链接。就像是：

```
var isThere = frames['frameName'].document.head.link[href='css/iframeMobile.css']; 
```

但我知道我的语法不对。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T20:22:21.950

您可以使用：

```
var isThere = frames['frameName'].document.head.querySelectorAll("link[href='css/iframeMobile.css']").length > 0; 
```

得到一个布尔值。 `querySelectorAll`返回您查询的所有元素的数组，因此如果其长度大于 0，则存在这样的元素。

# objective-c - 如何在 UITableView 中将鼠标悬停在单元格上时显示全文？

> ID：15820901
> 
> 赞同：1
> 
> 时间：2013-04-04T20:16:55.707
> 
> 标签：objective-c, uitableview, popup, hover

在 UITableView 中，我有一组值，其中一些值比指定/绘制的宽度长。我想要一种方法来显示悬停在该单元格上的全部价值，就像我们在网页上一样。

请提供一种方法来实现这一点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T20:39:52.680

由于您确实无法将鼠标悬停在触摸手机上，因此我将使用**UILongPressGestureRecognizer**并让操作在屏幕上显示一个较小的子集视图，而不是带有单元格详细信息的表格视图。

# c - 冒泡排序的二分查找

> ID：15820907
> 
> 赞同：0
> 
> 时间：2013-04-04T20:17:14.020
> 
> 标签：c, binary-search, bubble-sort

是否可以进行使用冒泡排序对其进行排序的二进制搜索？

这是我的冒泡排序和二分搜索。我如何将它们结合起来？

```
int Search_for_Client (int cList[], int low, int high, int target) {
    int middle;
    while (low <= high) {
        middle = low + (high - low)/2;
        if (target < cList[middle])
            high = middle - 1;
        else if (target > cList[middle])
            low = middle + 1;
        else
            return middle;
    }
    return -1;
}

int bubbleSort(char cList[], int size) {
    int swapped;
    int p;
    for (p = 1; p < size; p++) {
        swapped = 0;    /* this is to check if the array is already sorted */
        int j;
        for (j = 0; j < size - p; j++) {
            if (cList[j] > cList[j+1]) {
                int temp = cList[j];
                cList[j] = cList[j+1];
                cList[j+1] = temp;
                swapped = 1;
            }
        }
        if (!swapped)
        {
            break; /*if it is sorted then stop*/
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T20:44:36.980

首先，修复您的代码以便编译。例如，`bubbleSort`声明为返回 int 但您不返回任何内容。

然后做这样的事情：

```
#include <stdio.h>

// *** paste your code here

int main(int argc, char *argv[])
{
    char data[11] = { 'z', 'y', 'x', 'w', 'v', 'u', 't', 's', 'r', 'q', 'p' };
    int foundIt;

    bubbleSort(data, 11);
    foundIt = Search_for_Client(data, 0, 10, 'w');
    if (foundIt >= 0)
       printf("Found 'w' at index %d\n", foundIt);
    else
       printf("Did not find 'w'\n");
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T20:21:08.070

是的，您可以使用冒泡排序对数组进行排序，然后对生成的排序数组使用二进制搜索。

然而，值得注意的是，有比冒泡排序更有效的排序方法。

# c++ - 无法在 Windows 7 机器上的 Microsoft Visual C++ 2010 中运行 OpenCV

> ID：15820908
> 
> 赞同：0
> 
> 时间：2013-04-04T20:17:19.097
> 
> 标签：c++, visual-c++, opencv, visual-c++-2010

我一直遵循[这里](https://stackoverflow.com/questions/10901905/installing-opencv-2-4-3-in-visual-c-2010-express)的指令到核心。

它们在 Windows 7 32 位机器上运行完美。但我在 Windows 7 64 位机器上使用相同的指令。我收到以下错误。

错误 LNK2019：函数“void * __cdecl trial1(void *)”(?trial1@@YAPAXPAX@Z) 中引用的未解析外部符号 _cvDestroyAllWindows

对于其他 openCV 方法也是如此。

我在我的配置管理器中进行了更改，并将 x64 添加到解决方案平台，但仍然出现错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T20:25:44.140

您需要链接`*.lib`项目属性中的文件。它们是代码中包含的每个头文件的 lib 文件。即`opencv2/core`有库`opencv_core.lib`

# c# - 从接口实例中获取实现类实例

> ID：15820910
> 
> 赞同：0
> 
> 时间：2013-04-04T20:17:22.693
> 
> 标签：c#, reflection, interface

我有一些实现接口的类：

```
class FirstImplementer : IInterface { ... }
class AnotherImplementer : IInterface { ... } 
```

在代码的某处，我得到了 IInterface 实例的列表。

```
List<IInterface> MyList; 
```

我想知道每个 IInterface 实例的具体实例的实现类是什么（FirstImplementer 或 AnotherImplementer）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T20:19:07.453

您可以`.GetType()`在其中的实例上使用`MyList`并从那里开始。

`MyList[0].GetType()`> 这与`typeof(FirstImplementer)`等人相同。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T20:19:16.813

```
foreach (var item in MyList)
{
    var theType = item.GetType();
    // why did you want theType, again?
    // you generally shouldn't be concerned with how your interface is implemented
} 
```

根据您要执行的操作，此替代方法可能更有用：

```
foreach (var item in MyList)
{
    if (item is FirstImplementer)
    {
        var firstImpl = (FirstImplementer)item;
        // do something with firstImpl
    }
    else if (item is AnotherImplementer)
    {
        var anotherImpl = (AnotherImplementer)item;
        // do something with anotherImpl
    }
} 
```

在可能有意义的情况下，通常最好使用`is`或`as`过度反射（例如）。`GetType`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-04T20:20:44.080

```
foreach (var instance in MyList)
{
    Type implementation = instance.GetType ();
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-04T20:40:20.340

如果您需要获取第一个类型参数（如果有），如果列表中的每个实例甚至不存在此类类型参数，则为 null，在设计时您在语法上将其视为接口引用，那么您可以使用 Type 类型的 GetGenericArguments 方法。

这是一个小助手方法，它接受一堆可能为空的对象，但如果它们不是，它肯定会实现你的接口（它们会有一个运行时类型）并产生一堆代表的类型（按各自的顺序) SomeImplementer 模式中发现的类型参数：

```
public IEnumerable<Type> GetTypeArgumentsFrom(IEnumerable<IInterface> objects) {
    foreach (var obj in objects) {
        if (null == obj) {
            yield return null; // just a convention 
                               // you return null if the object was null
            continue;
        }

        var type = obj.GetType();
        if (!type.IsGenericType) {
            yield return null;
            continue;
        }

        yield return type.GetGenericArguments()[0];
    }
} 
```

# ruby - ruby 正则表达式匹配除特定字符之外的任何字符

> ID：15820911
> 
> 赞同：1
> 
> 时间：2013-04-04T20:17:23.757
> 
> 标签：ruby, regex

我正在寻找一种方法来匹配除“#”之外的任何字符。

它看起来像......

```
gsub(/^foo.*foo$/) 
```

但我希望它匹配

```
"foofdfdfdfoo" 
```

但不是

```
"fooddgdgd#fdfoo" 
```

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-04T20:20:18.957

```
^[^#]+$ 
```

[http://rubular.com/r/glijo99dU9](http://rubular.com/r/glijo99dU9)

`gsub`是为了替代。如果你只想匹配，`.match`方法

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T20:24:52.413

为了扩展 Explosion Pills 答案，插入符号 (^) 将否定正则表达式中的匹配。这意味着如果在表达式中找到它后面的字符，它将不匹配。[您可以在文档](http://www.regular-expressions.info/anchors.html)中阅读有关它的更多信息。

# python - 没有解析的 Python JSON 键

> ID：15820916
> 
> 赞同：3
> 
> 时间：2013-04-04T20:17:52.417
> 
> 标签：python, json, parsing

我需要从大约 70.000 个（子）键/对象的 JSON 格式文本中获取主键（设备）它看起来像这样：

```
{
   "1":{...........}
   "4":{...........}
   "9":{...........}
} 
```

我需要得到“1”、“4”和“9”。但是我现在这样做的方式需要大约 2 分钟来解析文本

```
json = json.loads(response.text) #this takes so long!
devices = json.keys() 
```

因为我在树莓派上运行它！

有没有更好的办法？

**编辑：** 我从运行在服务器上的 JSON API 接收数据：

```
http://.../ZWaveAPI/Run/devices #this is an array 
```

**编辑3：**

最终工作代码：（运行 2-5 秒！:)

```
import ijson.backends.python as ijson
import urllib

parser = ijson.parse(urllib.urlopen("http://.../ZWaveAPI/Run/devices"))
list = []
for prefix,event,value in parser:
    if event == "map_key" and len(prefix) == 0:
        list.append(value)
return list 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-04T20:27:02.643

您可以使用面向流的迭代 JSON 解析器来完成它，但您需要单独安装它。试一试[`ijson`](https://pypi.python.org/pypi/ijson/)，它会为遇到的每个 JSON 结构发出事件：

```
for prefix, event, value in parser:
    if event == 'map_key':
        print value 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T00:33:19.093

您是否尝试过只购买一台设备？对于大多数 RESTful Web 服务，如果您看到这样的 URL：

> “h ttp://.../ZWaveAPI/Run/devices”

您有可能通过以下方式获得单个设备：

> “h ttp://.../ZWaveAPI/Run/devices/1”

如果它有效，它应该会大大减少你必须下载和解析的数据量。

# javascript - 我的 jquery 代码是否应该对所有人可见

> ID：15820923
> 
> 赞同：1
> 
> 时间：2013-04-04T20:18:22.117
> 
> 标签：javascript, jquery, asp.net-mvc, asp.net-mvc-3, security

我知道我无法隐藏它。但我只是想确定我做这件事是对的。
我有一个主视图，我在其中渲染了一些部分视图：

```
@{
    ViewBag.Title = "Index";
}
...
@{Html.RenderAction("Index", "Product");}
@{Html.RenderAction("Index", "Machine");} 
```

在**产品和机器**控制器中，我有其他操作和简单 CRUD 操作的视图。
当用户尝试执行某些操作时，每个索引都有其 JS 代码来操作视图。
在下图中，我显示了当我打开并检查时我现在可以在我的网站上看到的内容。
这个 JS 代码对每个人都是可见的，我的问题是我是否会受到某种攻击？
在生产中，我将混淆 *.js 文件。
在服务器端，我首先检查用户是否可以采取行动（基于当前的用户 ID）。
我只想知道我的方法是好是坏。

![在此处输入图像描述](https://i.stack.imgur.com/QAY1Q.png) ![在此处输入图像描述](https://i.stack.imgur.com/K6MUg.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T20:29:30.487

只要您在服务器端验证请求，就不必担心。无法隐藏 JavaScript，因为您必须将其发送到客户端。混淆是可以逆转的。不过，您应该担心[CSRF 攻击](https://www.owasp.org/index.php/Cross-Site_Request_Forgery_%28CSRF%29)。可能没有人会费心对您的 JavaScript 代码进行逆向工程。一旦攻击者找到对您的操作发出有效请求的方法，他们就会尝试篡改数据或欺骗其他人发出他们不知道的请求。

# jquery - jQuery.sortable() 和限制移动

> ID：15820928
> 
> 赞同：0
> 
> 时间：2013-04-04T20:18:50.870
> 
> 标签：jquery, jquery-ui-sortable

我有一个相当复杂的 UI 要实现。大量的拖放。但是，dom 中有一些“组”是可排序的，但我需要限制将项目拖过具有不同类名的项目的能力。

例如，在这个 Dom 中，我希望 typea 项目在它们之间是可排序的，但不能将它们与 typeb 或 typec 项目混合。

我意识到添加更多分组可以解决这个问题，但是，我的实际 dom 要复杂得多，我宁愿不要将它与更多组进一步嵌套。

[JSFiddle 示例](http://jsfiddle.net/gibble/atd8s/)

```
<div id="sortable">
    <div class="typea">typea1</div>
    <div class="typea">typea2</div>
    <div class="typea">typea3</div>
    <div class="typea">typea4</div>

    <div class="typeb">typeb1</div>
    <div class="typeb">typeb2</div>
    <div class="typeb">typeb3</div>
    <div class="typeb">typeb4</div>
    <div class="typeb">typeb5</div>

    <div class="typec">typec1</div>
    <div class="typec">typec2</div>
    <div class="typec">typec3</div>
    <div class="typec">typec4</div>
    <div class="typec">typec5</div>
    <div class="typec">typec6</div>
</div> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-04T21:11:10.233

您可以使用 sortable's [`change event`](http://api.jqueryui.com/sortable/#event-change)，找到占位符的类（与原始元素相同），如果类不匹配，则限制排序。

```
$( "#sortable" ).sortable({
    change:function(event,ui){
        var currentClass = $(ui.placeholder)[0].classList[0];
         if(!$(ui.placeholder).prev().hasClass(currentClass) 
            && !$(ui.placeholder).next().hasClass(currentClass))
             return false;
    }
});
$( "#sortable" ).disableSelection(); 
```

演示：http: [//jsfiddle.net/dirtyd77/atd8s/1/](http://jsfiddle.net/dirtyd77/atd8s/1/)

# javascript - 在 iframe 中将灯箱居中

> ID：15820929
> 
> 赞同：0
> 
> 时间：2013-04-04T20:18:53.837
> 
> 标签：javascript, jquery, iframe, fancybox

我正在尝试在 Facebook iframe 画布应用程序中使用 fancybox jQuery 插件，但是当灯箱打开时，它以 iframe 的宽度和高度为中心，而不是以我的视口为中心。有什么办法可以解决这个问题吗？任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T20:20:28.550

没有。为了安全起见，不允许 iframe 的内容了解其父窗口的任何信息。有关更多信息，请参见：[http ://en.wikipedia.org/wiki/Cross-site_scripting](http://en.wikipedia.org/wiki/Cross-site_scripting)

# c# - RichEditBox FontSize C# windows 商店应用程序无响应

> ID：15820930
> 
> 赞同：1
> 
> 时间：2013-04-04T20:18:54.910
> 
> 标签：c#, windows-store-apps

我正在尝试为用户提供在richeditbox 中输入文本时更改字体大小的选项。我有以下代码：

```
 void textBox_GotFocus(object sender, RoutedEventArgs e)
    {
            RichEditBox textBox = sender as RichEditBox;

            ITextSelection selectedText = currentTextBox.Document.Selection;
            if (selectedText != null)
            {
                ITextCharacterFormat charFormatting = selectedText.CharacterFormat;
                charFormatting.Size = (float)textBoxFontSize;
                selectedText.CharacterFormat = charFormatting;
            }                
    } 
```

如果我将输入设备用作鼠标和键盘，则在正常工作时调用此代码。如果我使用触摸屏并在上述函数中放置一个调试点，此代码也可以工作。

但是，如果我使用触摸屏作为输入设备并且代码中没有断点，则字体大小会自动变为 10.5，并且永远不会变回来。

我看到其他人面临类似的问题：

[http://social.msdn.microsoft.com/Forums/en-US/winappswithcsharp/thread/771b6374-37da-4cdd-b68c-7b50b939b775](http://social.msdn.microsoft.com/Forums/en-US/winappswithcsharp/thread/771b6374-37da-4cdd-b68c-7b50b939b775)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-16T20:23:50.140

感谢 DJ KRAZE 问题完全解决了。这是响应鼠标键盘和触摸交互的解决方案：

```
string currentTextBoxText = null; 
textBox.Document.GetText(TextGetOptions.None, out currentTextBoxText); 
int textLength = currentTextBoxText.Length - 1; 
currentTextBox.Document.GetRange(textLength, int.MaxValue).CharacterFormat.Size = (float)textBoxFontSize; 
```

# html - 去除IE中按钮上的白角

> ID：15820932
> 
> 赞同：0
> 
> 时间：2013-04-04T20:19:05.247
> 
> 标签：html, css, linear-gradients

我为我的网站创建了一个自定义按钮，在 chrome 中看起来不错

![在此处输入图像描述](https://i.stack.imgur.com/gciRl.jpg)

但在 IE 中它有白角

![在此处输入图像描述](https://i.stack.imgur.com/URkBH.jpg)

我已经尽我所能去除白角，但我不知道如何。

这是我在下面使用的样式：

```
 <input type="submit" value="Search" class="button1"> 
```

CSS规则是：

```
 .button1{
        height:26px;  font-size:12px;  font-weight:bold;   cursor:pointer; float:right;   
        padding-left:10px;   padding-right:10px;  margin:2px;  font-family:verdana,arial, helvetica, sans-serif; 
        border:1px solid #000;   border-width:1px;   float:left;
        -webkit-border-top-right-radius:    5px;    -moz-border-radius-topright:    5px;   border-top-right-radius:     5px;
        -webkit-border-bottom-right-radius: 5px;    -moz-border-radius-bottomright: 5px;   border-bottom-right-radius:  5px;
        -webkit-border-top-left-radius:     5px;    -moz-border-radius-topleft:     5px;   border-top-left-radius:      5px;
        -webkit-border-bottom-left-radius:  5px;    -moz-border-radius-bottomleft:  5px;   border-bottom-left-radius:   5px;
        background-color:#F00;
        background: rgb(254,255,232); /* Old browsers */
        background: -moz-linear-gradient(top,  rgba(254,255,232,1) 0%, rgba(214,219,191,1) 100%); /* FF3.6+ */
        background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,rgba(254,255,232,1)), 
            color-stop(100%,rgba(214,219,191,1))); /* Chrome,Safari4+ */
        background: -webkit-linear-gradient(top,  rgba(254,255,232,1) 0%,rgba(214,219,191,1) 100%); /* Chrome10+,Safari5.1+ */
        background: -o-linear-gradient(top,  rgba(254,255,232,1) 0%,rgba(214,219,191,1) 100%); /* Opera 11.10+ */
        background: -ms-linear-gradient(top,  rgba(254,255,232,1) 0%,rgba(214,219,191,1) 100%); /* IE10+ */
        background: linear-gradient(to bottom,  rgba(254,255,232,1) 0%,rgba(214,219,191,1) 100%); /* W3C */
        filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#feffe8', endColorstr='#d6dbbf',GradientType=0 ); /* IE6-9 */

    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T20:41:14.550

这是[这个问题](https://stackoverflow.com/questions/6130235/ie9-rounded-corners-css-background-gradients-living-together)的副本。

给出的解决方案建议添加一个包装器 div 来处理角落和 IE 无法混合和匹配。[http://jsfiddle.net/UME84/](http://jsfiddle.net/UME84/)

```
.corners {
    border:1px solid #000;
    border-radius:5px;
    margin:2px;
    overflow:hidden;
    float:left;
} 
```

在 IE9 中测试。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T20:31:58.447

**对于 IE9-**

```
<!--[if gte IE 9]><style type="text/css">.button1 {filter: none;}</style><![endif]--> 
```

**或者** `border-radius:0px;`在所有IE中设置

```
 <!--[if IE]>
       <style type="text/css">
        .button1 {
          filter:none;
          border-radius:none;
        }
       </style>
    <![endif]--> 
```

**CSS：**

```
.button1{
        height:26px;cursor:pointer;
        padding-left:10px;
        padding-right:10px;
        margin:2px;
        font:bold 12px verdana,arial,helvetica,sans-serif;
        float:left;
        border:1px solid #000;
        border-radius:5px;
        background: #feffe8;
        background: url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiA/Pgo8c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgdmlld0JveD0iMCAwIDEgMSIgcHJlc2VydmVBc3BlY3RSYXRpbz0ibm9uZSI+CiAgPGxpbmVhckdyYWRpZW50IGlkPSJncmFkLXVjZ2ctZ2VuZXJhdGVkIiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSIgeDE9IjAlIiB5MT0iMCUiIHgyPSIwJSIgeTI9IjEwMCUiPgogICAgPHN0b3Agb2Zmc2V0PSIwJSIgc3RvcC1jb2xvcj0iI2ZlZmZlOCIgc3RvcC1vcGFjaXR5PSIxIi8+CiAgICA8c3RvcCBvZmZzZXQ9IjEwMCUiIHN0b3AtY29sb3I9IiNkNmRiYmYiIHN0b3Atb3BhY2l0eT0iMSIvPgogIDwvbGluZWFyR3JhZGllbnQ+CiAgPHJlY3QgeD0iMCIgeT0iMCIgd2lkdGg9IjEiIGhlaWdodD0iMSIgZmlsbD0idXJsKCNncmFkLXVjZ2ctZ2VuZXJhdGVkKSIgLz4KPC9zdmc+);
        background: -moz-linear-gradient(top, #feffe8 0%, #d6dbbf 100%);
        background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#feffe8), color-stop(100%,#d6dbbf));
        background: -webkit-linear-gradient(top, #feffe8 0%,#d6dbbf 100%);
        background: -o-linear-gradient(top, #feffe8 0%,#d6dbbf 100%);
        background: -ms-linear-gradient(top, #feffe8 0%,#d6dbbf 100%);
        background: linear-gradient(to bottom, #feffe8 0%,#d6dbbf 100%);
        filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#feffe8', endColorstr='#d6dbbf',GradientType=0 )
} 
```

**PS：**未经测试

请带上仍然使用 IE 的老 IE 用户下载[Google Chrome Frame](http://www.google.com/chromeframe)

# javascript - 如何将javascript日期转换为GMT毫秒？

> ID：15820934
> 
> 赞同：3
> 
> 时间：2013-04-04T20:19:14.343
> 
> 标签：javascript

我有以下日期：

```
var datestr = "11/11/2012 10:55" 
```

当我执行以下操作时：

```
var datems = new Date(datestr).getTime(); 
```

我得到的毫秒数似乎不是正确的毫秒数，因为它似乎比时间要早得多。如何将上面的“datestr”转换为毫秒（相对于 GMT）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T20:30:31.503

一种可能性是，如果字符串未指定时区，则`Date`假定为**当地时间。**

如果您的所有日期字符串都采用该格式，则可以在解析时为其附加时区：

```
var datems = new Date(datestr + " UTC").getTime(); 
```

或者您必须使用[本地偏移量](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Date/getTimezoneOffset)来查找 UTC：

```
var localDate = new Date(datestr);
var datems = localDate.getTime() - (localDate.getTimezoneOffset() * 60 * 1000); 
```

# ftp - ftp 回复如何工作

> ID：15820936
> 
> 赞同：4
> 
> 时间：2013-04-04T20:19:17.443
> 
> 标签：ftp

我一直在阅读 FTP 规范并使用 Wireshark 来捕获我的 FTP 客户端正在发送/接收的数据包，并对它们有一些疑问。

首先是来自我的 FTP 服务器的“连接问候语”（正如 FTP RFC 所说的那样）：

```
220---------- Welcome to Pure-FTPd [privsep] [TLS] ----------
220-You are user number 2 of 50 allowed.
220-Local time is now 15:22\. Server port: 21.
220-This is a private system - No anonymous login
220-IPv6 connections are also welcome on this server.
220 You will be disconnected after 15 minutes of inactivity. 
```

根据[RFC959#page-35](https://www.rfc-editor.org/rfc/rfc959#page-35)，如果在三位数之后有 - 表示它是多行响应。因此，随后的 220- 似乎是不必要的，上面可以重写如下：

```
220---------- Welcome to Pure-FTPd [privsep] [TLS] ----------
You are user number 2 of 50 allowed.
Local time is now 15:22\. Server port: 21.
This is a private system - No anonymous login
IPv6 connections are also welcome on this server.
220 You will be disconnected after 15 minutes of inactivity. 
```

那是对的吗？

另外，线的长度有限制吗？RFC 只提到一次“行长”。这里：

```
 A reply is defined to contain the 3-digit code, followed by Space
  <SP>, followed by one line of text (where some maximum line length
  has been specified) 
```

然而，RFC 并没有讨论如何或何时指定这样的“最大行长”。它为这些多行响应提供的特定用例是 STAT 回复，但在我看来，该示例有点做作，因为无论如何我认为 STAT 响应中不会有新行。

最后，一个人应该如何知道一个人何时完成接收回复？下面是 phpBB 是如何做到的：

[https://github.com/phpbb/phpbb3/blob/develop/phpBB/includes/functions_transfer.php#L885](https://github.com/phpbb/phpbb3/blob/develop/phpBB/includes/functions_transfer.php#L885)

```
do
{
    $result = @fgets($this->connection, 512);
    $response .= $result;
}
while (substr($result, 3, 1) !== ' '); 
```

他们对 512 的选择似乎是任意的 *，但是，暂时忽略这一点，他们`substr($result, 3, 1) !== ' '`也会中断我在本文前面所做的“连接问候”重写。

*   我说这是任意的，因为 RFC 中唯一出现的数字 512 是在讨论不连续文件传输的页面结构时。

任何见解将不胜感激 - 谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T21:54:13.143

你是对的多线响应。但是许多服务器使用在每一行开头重复代码的格式。因此，不幸的是，您需要能够同时处理这两个问题。

至于线路长度，我不知道。phpBB 代码似乎确实不遵循 RFC。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-05T05:45:48.913

是的，你是对的。但如果你只实现当时在你的 linux 系统上可用的服务器和客户端，你的代码在没有 3 位数字的情况下无法工作。因为所有人都遵循 rfc。所以你必须遵循 rfc。

# .net - 如何判断 DLL 是否为 ComVisible？

> ID：15820944
> 
> 赞同：2
> 
> 时间：2013-04-04T20:19:40.357
> 
> 标签：.net, dll, comvisible

我有一个 DLL，它的 ComVisible 属性可能设置为 true，也可能不设置。我不确定它是如何构建的，或者具有什么属性？我所知道的是它是一个.Net DLL。简而言之，我如何判断它是否是 Com Visible？

抱歉，如果这是重复的。我对这个返回结果的所有搜索都显示了如何*使*DLL ComVisible。我知道该怎么做。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T20:44:54.957

您可以使用反射检查程序集的[ComVisibleAttribute](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.comvisibleattribute.aspx)：

```
private static bool IsComVisible(string assemblyPath)
{
  var assembly = Assembly.LoadFile(assemblyPath);

  var attributes = assembly.GetCustomAttributes(typeof(ComVisibleAttribute), false);

  if (attributes.Length > 0)
  {
    return ((ComVisibleAttribute)attributes[0]).Value;
  }

  return false;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T20:44:32.817

像这样的东西？

```
Assembly asm = Assembly.GetExecutingAssembly(); //Assembly.LoadFile, Assembly.Load

bool comVisible = asm.GetCustomAttributes()
                     .OfType<ComVisibleAttribute>()
                     .First()
                     .Value; 
```

# java - 查找 3 个日期中最早的日期

> ID：15820951
> 
> 赞同：19
> 
> 时间：2013-04-04T20:20:07.460
> 
> 标签：java, date

我在 Java 中有三个日期：a、b、c。这些日期中的任何一个或所有日期都可能为空。在没有大量 if-else 块的情况下，确定 a、b、c 中最早日期的最有效方法是什么？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2013-04-04T20:31:36.763

没有绕过空值检查，但通过一些重构，你可以让它变得轻松。

创建一个安全地比较两个日期的方法：

```
/**
 * Safely compare two dates, null being considered "greater" than a Date
 * @return the earliest of the two
 */
public static Date least(Date a, Date b) {
    return a == null ? b : (b == null ? a : (a.before(b) ? a : b));
} 
```

然后结合对它的调用：

```
Date earliest = least(least(a, b), c); 
```

* * *

实际上，您可以将此作为任何通用方法`Comparable`：

```
public static <T extends Comparable<T>> T least(T a, T b) {
    return a == null ? b : (b == null ? a : (a.compareTo(b) < 0 ? a : b));
} 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2019-12-19T19:16:53.247

Java 8+ 单线器。为了安全起见，添加了空检查。通过任意数量的日期。

```
public static Date min(Date... dates) {
    return Arrays.stream(dates).filter(Objects::nonNull).min(Date::compareTo).orElse(null);
} 
```

**不是 null 安全**的，但要短得多：

```
public static Date min(Date... dates) {
    return Collections.min(Arrays.asList(dates));
} 
```

**没有新方法就**不是空安全的：****

 **```
Collections.min(Arrays.asList(date1, date2)); 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-04-04T20:29:32.560

好吧，“效率”有一些不同的含义，但我认为比较三个日期不会有效率问题。事实上，它真的很便宜。您可以尝试这种方法：

```
SortedSet<Date> dates = new TreeSet<Date>();
dates.add(date1);
dates.add(date2);
// ...
dates.add(dateN);
Date earliest = dates.first(); 
```

或者，也许更优雅：

```
for (Date date : someDates) {
   if (date != null) {
      dates.add(date);
   }
}
Date earliest = dates.first(); 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2018-05-01T13:35:37.290

一些使用流的 Java 8 方法。第一个将在比较之前过滤空值，第二个将它们放在列表的末尾。

```
Date minDate = Arrays.asList(date1, date2, etc).stream()
     .filter(Objects::nonNull).min(Date::compareTo).get() 
```

或者

```
Date minDate = Arrays.asList(date1, date2, etc).stream()
    .sorted((a, b) -> {
        //some kind of custom sort.
        if(a == null && b == null) return 0;
        if(a == null) return 1;
        if(b == null) return -1;
        return a.compareTo(b);
    }).findFirst().get() 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2020-11-02T22:07:40.283

当 Apache Commons 可用时，您可以使用[`ObjectUtils.min`](https://commons.apache.org/proper/commons-lang/apidocs/org/apache/commons/lang3/ObjectUtils.html#min-T...-)：

```
Date earliest = ObjectUtils.min(a, b, c); 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2020-12-27T20:27:16.453

同时，您可能正在使用 Java 8 LocalDate（而不是旧的 java.util.Date）

对于 Java 8 LocalDate 使用此方法来获取最早的日期列表：

```
import java.time.LocalDate;

public static LocalDate earliestDate(LocalDate... dates) {
    return
        Arrays
        .stream(dates)
        .filter(Objects::nonNull)
        .min(LocalDate::compareTo)
        .orElse(null);
} 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2013-04-04T20:21:30.047

使用 java Date 对象[http://docs.oracle.com/javase/6/docs/api/java/util/Date.html](http://docs.oracle.com/javase/6/docs/api/java/util/Date.html)

然后您可以使用这些对象的 before() 和 after() 函数

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2017-06-05T11:18:01.377

使用之前和之后：

```
 /**
     * find Min Dates
     * @param date1
     * @param date2
     * @return
     */
    public static Date minDate(Date date1, Date date2) {
        // if date1 before date2 then return date1 else return date2
        return date1.before(date2) ? date1 : date2;
    }
     /**
     * find Max Dates
     * @param date1
     * @param date2
     * @return
     */
    public static Date maxDate(Date date1, Date date2) {
        // if date1 after date2 then return date1 else return date2
        return date1.after(date2) ? date1 : date2;
    } 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2020-04-28T06:38:16.127

使用流：

```
Date min = Stream.of(date1, date2, etc)
  .filter(Objects::nonNull)
  .min(Date::compareTo)
  .orElse(null); 
```

如果您的数组不包含 NULL 值，您可以使用`Ordering`

```
Ordering.natural().min(date1, date2, etc); 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2017-06-26T07:58:45.747

另一种方法是使用[java.util.Collections.min(collection)](https://docs.oracle.com/javase/7/docs/api/java/util/Collections.html#min(java.util.Collection))：

> 返回： 给定集合的最小元素，根据其元素的自然顺序。

```
public static Date getEarliestDate(List<Date> dates) {

    if (dates == null || dates.isEmpty())
        return null;

    dates.removeIf(Objects::isNull);

    return dates.isEmpty() ? null : Collections.min(dates);
} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-04-04T20:29:50.493

您可以使用

```
date1.compareTo(anotherDate) 
```

回报：

如果参数 Date 等于此 Date，则值为 0；如果此 Date 在 Date 参数之前，则值小于 0；如果此 Date 在 Date 参数之后，则值大于 0。

抛出：

```
NullPointerException - 
```

如果另一个日期为空。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2013-04-04T20:53:20.403

只是另一个版本作为一个想法和乐趣

```
new Date(Math.min(a != null ? a.getTime() : Long.MAX_VALUE
, Math.min(b != null ? b.getTime() : Long.MAX_VALUE
, c != null ? c.getTime() : Long.MAX_VALUE))) 
```

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2022-01-20T08:03:38.733

```
List.of(date1, date2)
                .stream()
                .min(Date::compareTo)
                .get(); 
```**

# javascript - 在 ajax:success 上更改不同的 DOM 元素

> ID：15820956
> 
> 赞同：1
> 
> 时间：2013-04-04T20:20:23.493
> 
> 标签：javascript, jquery, ajax, dom, animation

在一个页面上，我有两个区域：任务列表和任务表单。在 ajax 提交表单并成功返回时，我希望通过另一个 ajax 调用调用并重新加载任务列表。那部分有效。但是，作为 ajax 调用的一部分，列表上应该有一个“加载”动画；一旦返回数据，动画就会被删除。

```
AAAAAAAAAAAAAA    //list of tasks. Loaded on page load or changing of a dropdown (works)
A            A
A            A
AAAAAAAAAAAAAA
...page stuff...
BBBBBBBBBBBBBB    //this is the form. on ajax:success-> call ajax to repopulate 'A' list
B            B
B            B
BBBBBBBBBBBBBB 
```

这也是一个 MVC 框架。所以我可以轻松地调用给定的 div 并告诉它重新加载该 div 的内容（同样，这有效）但动画似乎没有找到“目标”。

代码：

```
//Global Js
//Loads animation over DIVs that are in the middle of an ajax operation
$.fn.addBlockLoadingDiv = function() {
var block_width = this.outerWidth();
var block_height = this.outerHeight();
var block_padding_left = this.css('padding-left');
var block_padding_top = this.css('padding-top');

var block = $("<div class='block_loading'></div>")
block.css({'width':block_width,'height':block_height, 'margin-top':'-'+block_padding_top, 'margin-left':'-'+block_padding_left})
// if the div is too big, the loading in the center not would apper in the screen
if (block_height > 400) {
    block.css({'background-position':'center 120px'});
}
this.prepend(block);
};

//Makes the ajax call and generally returns HTML to be displayed
$.fn.loadUrl = function(url, dataAjax) {
var target = this;
target.addBlockLoadingDiv();
return $.ajax({
    type: "POST",
    url: url,
    data: dataAjax,
    success: function(data) {
        if (data) {
            target.html(data);
        } else {
            target.text("Unable to display requested data, sorry.");
        }
    },
    error: function(err) {
        target.html(err.response);
    }
});
};

//and the ajax call that submits the form data to create/update/delete a task
$("#task_action_button").on('click', function(event) {
    //clear status block
    $().clearStatusBlocks()
    //hide task schedule if showing
    $("#task_persons_tasks").slideUp();
    //validate form
    $("#task_crud_form").validate();

    //return if not valid
    if ($("#task_crud_form").valid() != true) {
        return false;
    }

    //add ajaxloader
    $("#task_container_table").addBlockLoadingDiv();

    //submit ajax
    $.ajax({
        type: "POST",
        dataType:"JSON",
        url:    "./index.php?w1=TTRCTL/TTRTaskCTL",
        data:   $("#task_crud_form").serialize(),
        success: function(data) {
            //if return is null
            if (data.bool === true) {
                //clr form on successfull save
                $("#task_reset_button").trigger('click');
                //show good status message
                $().taskFormStatus('Action successful.', true);
            //else nicly fail
            } else {
                $().taskFormStatus(data.text);
            }

            $("#project_tasks").trigger('change');
            $('project_task_list_table').addBlockLoadingDiv();
        },
        error: function(data) {
            $().taskFormStatus('Could not completed the requested action.');
        },
        complete: function(data) {
            $(".block_loading").remove();
        }
    });
}); 
```

我试过的：从表单'B'调用ajax来重新填充列表'A'：重新填充但动画不显示；将可选参数传递给 loadUrl() 以指示目标元素：不行；以及其他一些当然行不通的愚蠢想法……

任何帮助表示赞赏。

# ios - IOS：PNG文件包含无效签名：XCode/Organizer/Archive/Validate中的Icon.png

> ID：15820957
> 
> 赞同：0
> 
> 时间：2013-04-04T20:20:25.863
> 
> 标签：ios, xcode, app-store-connect, archive, organizer

尝试在商店中发布应用程序需要五个小时，但没有结果。我遇到以下错误：PNG 文件包含无效签名：在 Organizer/Archive 中进行验证期间的 Icon.png。这也是我编译我的 .app 时的警告。我不明白该怎么做。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T22:02:53.620

iTunes Connect 最近添加了更严格的 PNG 验证。也就是说，以前通过验证的图标文件现在可能由于新规则而无法通过验证。

无论哪种情况，请尝试使用 Preview 重新生成一个新的图标文件，如下所示：

1.  在“预览”中打开 png 并选择“文件”>“复制”
2.  以JPEG格式保存副本
3.  全部关闭并重新打开 JPEG 版本
4.  复制 JPEG 版本并将副本另存为 PNG
5.  将项目中的旧 png 替换为新的 png，产品 > 清洁，产品 > 存档，然后重新尝试验证/提交

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T20:35:25.883

检查以确保您的项目中没有 .jpg 文件，并且没有两个名称相同但大小写不同的文件（icon.png 与 Icon.png）另外，请确保检查您的实际项目文件结构以及您在 Xcode（组）中看到的文件。

# python - 将 .csv 中的空格替换为特定列，Python

> ID：15820962
> 
> 赞同：0
> 
> 时间：2013-04-04T20:20:34.657
> 
> 标签：python, csv, python-2.7, whitespace

我有一个看似简单的 .CSV 文件任务。我需要用 0 替换两个特定列（37、38）的所有空格。我试过以下代码：

```
import csv

with open("C:/Temp/whiteSpace.csv", "rb") as infile, open("C:/Temp/repaired_test.csv", "wb") as outfile:
    reader = csv.reader(infile)
    writer = csv.writer(outfile)
    for row in reader:
        row[37] = row[37].replace(' ', '0')
        writer.writerow(row)
        print row[37] 
```

但是，这只是将“whiteSpace.csv”写入“repaired_test.csv”而不进行任何编辑。

我发现很多关于剥离空白（[从文件 csv](https://stackoverflow.com/questions/14885908/strip-white-spaces-from-file-csv)中剥离空白），但我无法连接这些点并使我的代码工作。

对不起，多余的问题，并提前谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T21:19:19.287

您确定要替换的字符是空白字符 ( `) 吗？它可能是一个标签或其他东西。您可以尝试使用正则表达式来捕获所有空白字符：`

 ````
>>> import re
>>> r = re.compile(r'\s')
>>> r.sub('0', 'TEXT\tSPACE TEXT')
'TEXT0SPACE0TEXT' 
````

# mysql - mysql表中的数据表示

> ID：15820972
> 
> 赞同：1
> 
> 时间：2013-04-04T20:21:40.773
> 
> 标签：mysql, sql, database, database-design

假设我在 mysql 数据库中有三个表，其中包含如下数据：

```
- Sections (which have a number, a title)
- Sub-sections (which also have a number and a title but the title is the same as the title of the next data type with is 'statements')
- Statements (which have a number, a title (the same as the title from Sub-sections) 
```

正如您在上面看到的，表格**子部分**和**语句中的字段****标题**是相同的，并且它们具有相同的数据。有没有更好的方法可以在我的表中表示这个，这样我就不会有重复的数据？

 ****感谢您的任何建议

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T21:04:29.067

任何冗余都可能导致数据损坏：如果有两条数据代表相同的信息，而其中一条发生了变化，你会突然不知道哪一条是正确的。实际上，您已经丢失了信息！

这就是**规范化**很重要的原因：它最大限度地减少了冗余（和依赖性）。

有时，出于性能原因（所谓的“非规范化”）故意进行冗余，但这总是在衡量对性能的影响并仔细权衡数据损坏风险之后进行。除非您这样做，否则您的“默认”方法应该是避免数据模型中的冗余。

你还没有解释你的数据模型应该是什么*意思*，但我猜你需要这样的东西：

![在此处输入图像描述](https://i.stack.imgur.com/GMvi6.png)

请注意，该语句没有标题。您可以通过 JOINing`Statement`和`SubSection`.

*注意：如果您预计您将需要少于或多于两个级别的部分，您可以通过 Mahmoud Gamal[提出的“邻接列表”来表示。](https://stackoverflow.com/a/15821072/533120)有关表示分层数据的其他一些方法，请查看Bill Karwin的[此演示文稿。](http://www.slideshare.net/billkarwin/models-for-hierarchical-data)*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T20:27:45.550

是的，[***规范化***](http://en.wikipedia.org/wiki/Database_normalization)你的表格。

您可以只使用两个表来执行此操作；和`sections`subsections 表将仅使用一个表来表示，其中`Sections`一个新列`ParentSectionNumber`指示每个部分的父部分，根部分将`NULL`作为父部分编号。像这样的东西：

**`Sections`：**

*   `SectionNumber`,
*   `SectionTitle`,
*   `ParentSectionNumber`（可为空）外键引用同一个表。

* * *

对于第二个表，我猜测每个部分或子部分都有语句，在这种情况下，创建一个引用该表的外键`sections`：

**`Statements`：**

*   `StatementNumber`,
*   `SectionNumber`外键参考`Sections(SectionNumber)`。****

# direct3d - Assimp 和 D3D 模型加载：网格未在 D3D 中显示

> ID：15820973
> 
> 赞同：1
> 
> 时间：2013-04-04T20:21:42.663
> 
> 标签：direct3d, .obj

我想使用 Assimp 将模型加载到 D3D 中。我想了解更多 Assimp 如何处理索引，因为我无法让它以我理解的形式与 obj 模型一起使用。例如，对于面为 int/int/int 的 obj 模型，当我遍历面数时：

```
for (unsigned int x = 0 ; x < paiMesh->mNumFaces ; ++x) {
    const aiFace& Face = paiMesh->mFaces[x];
    assert(Face.mNumIndices == 3);
    for (unsigned int k = 0; k< nidx;k++)//triangle list
    {
    i1 = Face.mIndices[k];
    Indices.push_back(i1);
    }
} 
```

我注意到我的 Indices 向量似乎只包含递增顺序的数字，即 Indices = [0,1,2,3,4,5,6,7,8...]。这看起来不像实际的 obj 文件。那么，谁能告诉我 Assimp 在这里做什么。这将帮助我了解我的加载代码哪里出错了

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-08T08:16:15.317

我想到了。虽然上面的代码是正确的，但我没有纠正模型中的不同子集。这是我从 Assimp 加载顶点的代码。如果您想要我使用的全套课程，请留言。

```
 /****************************************************
                **********File name: MeshLoader03.cpp****************
                ******************************************************/

                /*************Includes*****************************/
                #include "stdafx.h"
                #include "MeshLoader03.h"

                /******************Class**************************/
                bool MeshLoader03::LoadModel(const std::string& a_file, float a_scale,
                    std::vector<Vertex::Basic28>& vertices,
                    std::vector<USHORT>& indices,
                    std::vector<MeshGeometry::Subset>& subsets,
                    std::vector<ModelMaterial>& mats)
                {

                    //check if file exists
                    std::ifstream fin(a_file.c_str());
                    if(!fin.fail())
                    {
                        fin.close();
                    }
                    else
                    {
                        MessageBox(NULL,  TEXT("Couldn't open file: ") , TEXT("ERROR"), MB_OK | MB_ICONEXCLAMATION);
                        return false;
                    }

                    //Assign scale
                    m_scale = a_scale;

                    //Assign mesh properties
                    numVertices = 0;
                    numSubsets = 0;
                    numMaterials = 0;
                    numTriangles = 0;

                    //initialize success variable
                    bool Ret = false;

                    //Load mesh
                    Ret = loadMesh(a_file,a_scale, vertices,indices,subsets,mats);

                    //Return
                    return Ret;
                }

                //Load mesh with Assimp
                bool MeshLoader03::loadMesh(const std::string& a_file, float a_scale, 
                    std::vector<Vertex::Basic28>& vertices,
                    std::vector<USHORT>& indices,
                    std::vector<MeshGeometry::Subset>& subsets,
                    std::vector<ModelMaterial>& mats)
                {
                    //Assimp importer we are using
                    Assimp::Importer importer;      
                    const aiScene* loadedScene = importer.ReadFile( a_file,
                        aiProcessPreset_TargetRealtime_Quality |
                        aiProcess_ConvertToLeftHanded   
                        );
                    //we have NO assimp object
                    if(!loadedScene)
                    {
                        OutputDebugString(L"Model failed to load \n");
                        //OutputDebugString( (importer.GetErrorString()).c_str() );
                        return false;
                    }
                    else
                    {   //we have an assimp object with meshes
                        if(loadedScene->HasMeshes())
                        {
                        //Get mesh properties
                        GetMeshProperties(loadedScene);
                        //Extract Faces,Vertices,Subsets,Materials
                        InitMaterials(a_file,loadedScene, numMaterials,  mats);
                        InitSubsetTable(a_file,loadedScene,numSubsets,subsets);
                        InitVertices(a_file,loadedScene, numVertices,  vertices);
                        InitTriangles(a_file,loadedScene, numTriangles,  indices);
                        ScaleAsset(loadedScene);
                        return true;
                        }
                        else //an assimp object with NO meshes
                            return false;
                    }

                }

                //Get mesh properties
                void MeshLoader03::GetMeshProperties(const aiScene* loadedScene)
                {
                    //Get rootNode
                    aiNode* rootNode = loadedScene->mRootNode;

                    //Attributes
                    numSubsets = loadedScene->mNumMeshes;
                    numMaterials = loadedScene->mNumMaterials;

                    //If only one node
                    if(rootNode->mNumChildren == 0)
                    {
                        numVertices = loadedScene->mMeshes[0]->mNumVertices;
                        numTriangles = loadedScene->mMeshes[0]->mNumFaces;
                    }
                    else
                    {
                        //For all the children
                        for (size_t i =0 ;i<rootNode->mNumChildren; ++i)
                        {

                            //Get child node
                            aiNode* childNode = rootNode->mChildren[i];

                            // Initialize the meshes in the scene one by one
                            for (size_t n=0; n < childNode->mNumMeshes; ++n)
                            {
                                //get the mesh
                                const aiMesh* paiMesh = loadedScene->mMeshes[childNode->mMeshes[n]];

                                //Update total vertices and faces
                                numVertices+= paiMesh->mNumVertices;
                                numTriangles+= paiMesh->mNumFaces;
                            }
                        }
                    }

                }

                //Extract subsets
                void MeshLoader03::InitSubsetTable(const std::string& a_file,const aiScene* pScene, UINT numSubsets, std::vector<MeshGeometry::Subset>& subsets)
                {
                    subsets.resize(numSubsets);

                    //Get rootNode
                    aiNode* rootNode = pScene->mRootNode;

                    //Counter for vertices and indices
                    unsigned int vertexCounter, faceCounter;

                    //If only one node
                    if(rootNode->mNumChildren == 0)
                    {
                        subsets[0].Id = pScene->mMeshes[0]->mMaterialIndex;
                        subsets[0].VertexStart = 0;
                        subsets[0].VertexCount = pScene->mMeshes[0]->mNumVertices;
                        subsets[0].FaceStart = 0;
                        subsets[0].FaceCount = pScene->mMeshes[0]->mNumFaces;
                    }
                    else
                    {
                        //Counter
                        unsigned int subsetCounter = 0;
                        vertexCounter = 0; faceCounter = 0;
                        //For all the children
                        for (size_t i =0 ;i<rootNode->mNumChildren; ++i)
                        {

                            //Get child node
                            aiNode* childNode = rootNode->mChildren[i];

                            // Initialize the meshes in the scene one by one
                            for (size_t n=0; n < childNode->mNumMeshes; ++n)
                            {
                                //get the mesh
                                const aiMesh* paiMesh = pScene->mMeshes[childNode->mMeshes[n]];

                                subsets[subsetCounter].Id = pScene->mMeshes[childNode->mMeshes[n]]->mMaterialIndex;
                                subsets[subsetCounter].VertexStart = vertexCounter;
                                subsets[subsetCounter].VertexCount = paiMesh->mNumVertices;
                                subsets[subsetCounter].FaceStart = faceCounter;
                                subsets[subsetCounter].FaceCount = paiMesh->mNumFaces;
                                //Update total vertices and faces
                                vertexCounter+= paiMesh->mNumVertices;
                                faceCounter+= paiMesh->mNumFaces;
                                //Update counter
                                subsetCounter++;
                            }
                        }
                    }

                }

                //Extract Vertices
                void MeshLoader03::InitVertices(const std::string& a_file,const aiScene* pScene, UINT numVertices, std::vector<Vertex::Basic28>& vertices)
                {
                    vertices.resize(numVertices);
                    //Get rootNode
                    aiNode* rootNode = pScene->mRootNode;

                    //Counter for vertices and indices
                    unsigned int vertexCounter;

                    //If only one node
                    if(rootNode->mNumChildren == 0)
                    {
                        const aiMesh* mesh = pScene->mMeshes[0];
                        for(size_t b = 0;b<mesh->mNumVertices;b++)
                        {
                            vertices[b].Pos.x = mesh->mVertices[b].x;
                            vertices[b].Pos.y = mesh->mVertices[b].y;
                            vertices[b].Pos.z = mesh->mVertices[b].z;

                            if(mesh->HasVertexColors(0))
                            {
                                const aiColor4D pColr = mesh->mColors[0][b];
                                vertices[b].Color.x = pColr.r;
                                vertices[b].Color.y = pColr.g;
                                vertices[b].Color.z = pColr.b;
                                vertices[b].Color.w = pColr.a;
                            }
                            else
                                vertices[b].Color = XMFLOAT4(1.0f,1.0f,0.0f,0.0f);
                        }

                    }
                    else
                    {
                        //Counter
                        vertexCounter = 0; 

                        //For all the children
                        for (size_t i =0 ;i<rootNode->mNumChildren; ++i)
                        {

                            //Get child node
                            aiNode* childNode = rootNode->mChildren[i];

                            // Initialize the meshes in the scene one by one
                            for (size_t n=0; n < childNode->mNumMeshes; ++n)
                            {
                                //get the mesh
                                const aiMesh* paiMesh = pScene->mMeshes[childNode->mMeshes[n]];

                                for(size_t b = 0;b<paiMesh->mNumVertices;b++)
                                {
                                    vertices[vertexCounter].Pos.x = paiMesh->mVertices[b].x;
                                    vertices[vertexCounter].Pos.y = paiMesh->mVertices[b].y;
                                    vertices[vertexCounter].Pos.z = paiMesh->mVertices[b].z;

                                    if(paiMesh->HasVertexColors(0))
                                    {
                                        const aiColor4D pColr = paiMesh->mColors[0][i];
                                        vertices[vertexCounter].Color.x = pColr.r;
                                        vertices[vertexCounter].Color.y = pColr.g;
                                        vertices[vertexCounter].Color.z = pColr.b;
                                        vertices[vertexCounter].Color.w = pColr.a;
                                    }
                                    else
                                        vertices[vertexCounter].Color = XMFLOAT4(1.0f,1.0f,0.0f,0.0f);

                                    vertexCounter++;
                                }
                            }
                        }
                    }

                }

                //Extract Triangles
                void MeshLoader03::InitTriangles(const std::string& a_file,const aiScene* pScene, UINT numTriangles, std::vector<USHORT>& indices)
                {
                    //indices.resize(numTriangles*3);

                    //Get rootNode
                    aiNode* rootNode = pScene->mRootNode;

                    //Counter for vertices and indices
                    unsigned int indexCounter, indexStart;
                    indexCounter = 0;
                    indexStart = indexCounter;
                    //If only one node
                    if(rootNode->mNumChildren == 0)
                    {
                        const aiMesh* mesh = pScene->mMeshes[0];
                        for(size_t b = 0;b<mesh->mNumFaces;b++)
                        {
                            indices[indexCounter++] = mesh->mFaces[b].mIndices[0] + indexStart;
                            indices[indexCounter++] = mesh->mFaces[b].mIndices[1] + indexStart;
                            indices[indexCounter++] = mesh->mFaces[b].mIndices[2] + indexStart;
                        }

                    }
                    else
                    {
                        //Counter
                        indexStart = 0; 
                        indexCounter = 0;

                        //For all the children
                        for (size_t i =0 ;i<rootNode->mNumChildren; ++i)
                        {

                            //Get child node
                            aiNode* childNode = rootNode->mChildren[i];

                            // Initialize the meshes in the scene one by one
                            for (size_t n=0; n < childNode->mNumMeshes; ++n)
                            {
                                //get the mesh
                                const aiMesh* mesh = pScene->mMeshes[childNode->mMeshes[n]];

                                for(size_t b = 0;b<mesh->mNumFaces;b++)
                                {
                                    //indices[indexCounter++] = mesh->mFaces[b].mIndices[0] + indexStart;
                                    //indices[indexCounter++] = mesh->mFaces[b].mIndices[1] + indexStart;
                                    //indices[indexCounter++] = mesh->mFaces[b].mIndices[2] + indexStart;

                                    indices.push_back(mesh->mFaces[b].mIndices[0] + indexStart);
                                    indices.push_back(mesh->mFaces[b].mIndices[1] + indexStart);
                                    indices.push_back(mesh->mFaces[b].mIndices[2] + indexStart);
                                }
                                indexStart += mesh->mNumVertices;
                            }
                        }
                    }

                }

                /*********************Conversion functions**********************************/
                //AiVector3 to XMFLOAT3
                XMFLOAT3 MeshLoader03::aiVec3ToXMFloat3(const aiVector3D* vector)
                {
                    //Ooutput
                    XMFLOAT3 output;

                    //Assignmetns
                    output.x = vector->x;
                    output.y = vector->y;
                    output.z = vector->z;

                    //Send back result
                    return output;
                }

                //AiColor to XMFLOAT4
                    XMFLOAT4 MeshLoader03::aiColorToXMFLOAT4(const aiColor4D* color)
                    {
                    //Ooutput
                    XMFLOAT4 output;

                    //Assignmetns
                    output.x = color->r;
                    output.y = color->g;
                    output.z = color->b;
                    output.w = color->a;

                    //Send back result
                    return output;

                    }

                //AiMatrix to XMFLOAT4X4
                XMFLOAT4X4 MeshLoader03::aiMatrixToXMFloat4x4(const aiMatrix4x4* aiMe)
                {
                    XMFLOAT4X4 output;
                    output._11 = aiMe->a1;
                    output._12 = aiMe->a2;
                    output._13 = aiMe->a3;
                    output._14 = aiMe->a4;

                    output._21 = aiMe->b1;
                    output._22 = aiMe->b2;
                    output._23 = aiMe->b3;
                    output._24 = aiMe->b4;

                    output._31 = aiMe->c1;
                    output._32 = aiMe->c2;
                    output._33 = aiMe->c3;
                    output._34 = aiMe->c4;

                    output._41 = aiMe->d1;
                    output._42 = aiMe->d2;
                    output._43 = aiMe->d3;
                    output._44 = aiMe->d4;

                    return output;
                }

                /****************Scaling Functions: Taken from Assimp**********************/
                //-------------------------------------------------------------------------------
                // Calculate the boundaries of a given node and all of its children
                // The boundaries are in Worldspace (AABB)
                // piNode Input node
                // p_avOut Receives the min/max boundaries. Must point to 2 vec3s
                // piMatrix Transformation matrix of the graph at this position
                //-------------------------------------------------------------------------------
                int MeshLoader03::CalculateBounds(aiNode* piNode, aiVector3D* p_avOut, 
                    const aiMatrix4x4& piMatrix, const aiScene* pcScene)
                {
                    assert(NULL != piNode);
                    assert(NULL != p_avOut);

                    aiMatrix4x4 mTemp = piNode->mTransformation;
                    mTemp.Transpose();
                    const aiMatrix4x4 aiMe = mTemp * piMatrix;

                    for (unsigned int i = 0; i < piNode->mNumMeshes;++i)
                    {
                        for( unsigned int a = 0; a < pcScene->mMeshes[piNode->mMeshes[i]]->mNumVertices;++a)
                        {

                            const aiVector3D pc = pcScene->mMeshes[piNode->mMeshes[i]]->mVertices[a];
                            XMFLOAT3 pc11 = aiVec3ToXMFloat3(&pc);
                            XMFLOAT4X4 aiMe1 = aiMatrixToXMFloat4x4(&aiMe);

                            XMVECTOR pc1 = XMVector3TransformCoord(XMLoadFloat3(&pc11),XMLoadFloat4x4(&aiMe1));

                            p_avOut[0].x = min( p_avOut[0].x, pc1.m128_f32[0]);
                            p_avOut[0].y = min( p_avOut[0].y, pc1.m128_f32[1]);
                            p_avOut[0].z = min( p_avOut[0].z, pc1.m128_f32[2]);
                            p_avOut[1].x = max( p_avOut[1].x, pc1.m128_f32[0]);
                            p_avOut[1].y = max( p_avOut[1].y, pc1.m128_f32[1]);
                            p_avOut[1].z = max( p_avOut[1].z, pc1.m128_f32[2]);
                        }
                    }
                    for (unsigned int i = 0; i < piNode->mNumChildren;++i)
                    {
                        CalculateBounds( piNode->mChildren[i], p_avOut, aiMe, pcScene);
                    }
                    return 1;
                }

                //-------------------------------------------------------------------------------
                // Scale the asset that it fits perfectly into the viewer window
                // The function calculates the boundaries of the mesh and modifies the
                // global world transformation matrix according to the aset AABB
                //-------------------------------------------------------------------------------
                int MeshLoader03::ScaleAsset(const aiScene* pcScene)
                {
                    aiVector3D aiVecs[2] = {
                        aiVector3D( 1e10f, 1e10f, 1e10f),
                        aiVector3D( -1e10f, -1e10f, -1e10f) };

                    if (pcScene->mRootNode)
                    {
                        aiMatrix4x4 m;
                        CalculateBounds(pcScene->mRootNode,aiVecs,m, pcScene);
                    }

                    aiVector3D vDelta = aiVecs[1] -  aiVecs[0];
                    aiVector3D vHalf =  aiVecs[0] + (vDelta / 2.0f);
                    float fScale = 10.0f / vDelta.Length();

                    aiMatrix4x4 g_mWorld =  aiMatrix4x4(
                                            1.0f,0.0f,0.0f,0.0f,
                                            0.0f,1.0f,0.0f,0.0f,
                                            0.0f,0.0f,1.0f,0.0f,
                                            -vHalf.x,-vHalf.y,-vHalf.z,1.0f) *
                        aiMatrix4x4(
                                    fScale*m_scale,0.0f,0.0f,0.0f,
                                    0.0f,fScale*m_scale,0.0f,0.0f,
                                    0.0f,0.0f,fScale*m_scale,0.0f,
                                    0.0f,0.0f,0.0f,1.0f);

                    m_World = aiMatrixToXMFloat4x4(&g_mWorld);
                    return 1;
                } 
```

# jsf - 在服务器中生成 JQPlot 图表

> ID：15820981
> 
> 赞同：3
> 
> 时间：2013-04-04T20:22:03.140
> 
> 标签：jsf, jqplot, rhino

我们正在使用 JQplot 生成图表，到目前为止，一切都像一个魅力。但是，我们面临着一个阻塞问题。

根据用户要求，我们需要以 PDF 的形式显示所有图表。通过使用“jqplotToImageElem”方法创建一个 Base64 文件并将其发送到我使用 iText 创建 PDF 的服务器，我可以为每个图表单独创建一个 pdf。然而，一份报告中可能有数百个图表。在前端，我们一次显示一个，但在后端，我们必须打印所有这些。现在发送这么多的图像数据实际上是不可能的。

我也在探索使用 Rhino+EnvJS 调用正在工作的 bean 中的 JQPlot（创建图表对象）但是当我尝试使用“jqplotToImageElem”获取图像文件时，我得到一个 NoSuchMethod 异常，因为 EnvJs 不支持HTMLCanvas 对象的 toDataURL() 方法。

这是一个死胡同。有没有出路，或者我应该以任何其他方式解决这个问题。

我们正在使用：JSF 2.0 + Jquery + iText。

任何帮助将非常感激。

谢谢阿米特

# jquery - 仅当用户滚动到首屏下方时，如何使用 jquery 触发灯箱

> ID：15820985
> 
> 赞同：0
> 
> 时间：2013-04-04T20:22:12.110
> 
> 标签：jquery, html, jquery-waypoints

设置：所以我有一个标题 div 960px x 400px，足以容纳左侧的 youtube 视频和其他一些要点和右侧的号召性用语。该 div 是隐藏的，仅在单击按钮时显示。很容易。

但我想在颜色框中显示相同的隐藏内容，但前提是该用户向下滚动了 750 像素，这将是我折叠的末尾。如果说他们只向下滚动了 400 像素并且他们点击了播放按钮，那么他们应该被弹回屏幕顶部并观看上面提到的标题 div 中的视频。

我正在考虑使用航点来帮助实现此功能，但可能有更好的方法。

让我知道你的想法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T20:28:15.537

`<a href="#">Play</a>`会将用户带到文档的顶部。确保您的点击处理程序返回 true 并且不会停止传播。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T00:25:55.513

您可以考虑滚动的东西是`.scroll()`来自 jQuery（阅读[此处](http://api.jquery.com/scroll/)）和`.scrollTo()` [jQuery 插件](http://flesler.blogspot.ch/2007/10/jqueryscrollto.html)

这是我在[JS Fiddle中制作的一个示例](http://jsfiddle.net/WDDAS/)

```
$(function(){
$(window).scroll( function() {
    var scrolled = $(this).scrollTop();
    if(scrolled > 150) {
        $('#up').fadeIn();
    } else if(scrolled < 150) {
        $('#up').fadeOut();
    }
});
    $('#up').click(function(){
        $.scrollTo('#Top');
    });
}); 
```

在此示例中，当`window`滚动超过`150px`时，`#up`将显示 div。如果滚动条上的位置是`top`，则`#up`div 将隐藏。单击`#up`div 将自动滚动到 div `#top`（参见小提琴）。

我认为这与一些改变会得到你所需要的。

# smalltalk - smalltalk中的后缀计算

> ID：15820995
> 
> 赞同：4
> 
> 时间：2013-04-04T20:22:36.790
> 
> 标签：smalltalk, postfix-notation

我必须编写一个代码来评估 Smalltalk 中的后缀符号（反向波兰评估）。我已经浏览了文档并且还实现了一个堆栈。这是我到目前为止写的代码：

```
Object subclass: #Rpcalc
instanceVariableNames: 'anArray top'
classVariableNames: ''
poolDictionaries: ''
category: nil !

pop:
    | item |
item := anArray at: top.
top := top - 1.
^item!

push: item
 top := top + 1.
 anArray at: top put: item!

setsize: n
  anArray := Array new: n.
  top := 0! 

evaluate:
       | expression aToken op1 op2 operator answer|
   Transcript show: 'Enter Expression' .
   expression :- stdin nextLine.

   | aStack |
   aStack := Array new: 10 .

   aToken := self getNextToken.
       ((aToken key) = 'operand')
       ifTrue: [push : aToken].

        aToken := self getNextToken.
       ((aToken key) = 'operator')
        ifTrue:  [op1 := pop.
           op2 := pop.
           operator := aToken.
   "if(operator := +)"
   "answer := op1 + op2" 
```

我想知道如何标记表达式中的每个元素。例如，对于表达式，10 3 + 3 7 * - 我需要将它等同于一个标记。如果它是一个操作数，它应该将它压入堆栈。如果是运算符，则弹出堆栈两次以获取操作数并计算表达式。我对 smalltalk 完全陌生，所以我对语法一无所知。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T17:57:56.237

您没有指定您使用的是哪种 Smalltalk 方言。在 Squeak 中，您可以使用以下`findTokens:`方法：

```
'336 8 4 2 1 + - * /' findTokens: ' '
==> an OrderedCollection('336' '8' '4' '2' '1' '+' '-' '*' '/') 
```

用于`isDigit`测试令牌是否为数字：

```
'336' first isDigit
==> true
'+' first isDigit
==> false 
```

要将字符串转换为数字，您将使用`asNumber`：

```
'336' asNumber
==> 336 
```

整个 RPN 解析器/评估器可以用不到 10 行代码轻松实现，但显然这是你要做的功课（提示：不需要实现堆栈，已经有一个）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T20:58:00.543

我建议你看看[PetitParser](http://www.lukas-renggli.ch/blog/petitparser-1)。您可以将您拥有的表达式：解析`10 3 + 3 7 *`为令牌，例如：NumberToken(10)、OperatorTocken(+)，然后根据您需要的令牌进行操作。也不要做

```
operator = '+' ifTrue: [op1 + op2] 
```

做：

```
op1 perform: operator with: op2 
```

反而，

# iphone - setNeedsDisplay 只被调用一次

> ID：15820998
> 
> 赞同：2
> 
> 时间：2013-04-04T20:22:38.197
> 
> 标签：iphone, objective-c, drawrect, method-call, setneedsdisplay

在我的代码中，我想“动画”绘制一条线的延迟，因此在向视图添加新线后，我调用 setNeedsDisplay - 一次可以正常工作。

在 drawRect 方法中，我绘制了线条并调用线条的方法来增加线条长度l。现在我想再次调用 setNeedsDisplay 来重绘线条 - 所以它是一个“成长”的动画..

但它只调用一次 setNeedsDisplay 并且再也不会调用，除非我添加了另一行。我还尝试在这个类中调用一个方法，该方法调用 setNeedsDisplay，以确保您不能在 drawRect 内部调用它。

```
- (void)drawRect:(CGRect)rect {

    for(GameLine *line in _lines) {

        if(line.done) {
            CGContextRef c = UIGraphicsGetCurrentContext();
            CGContextSetLineWidth(c, 5.0f);
            CGContextSetStrokeColor(c, lineColor);

            CGContextBeginPath(c);
            CGContextMoveToPoint(c, line.startPos.x, line.startPos.y);
            CGContextAddLineToPoint(c, line.endPos.x, line.endPos.y);
            CGContextStrokePath(c);
        }else {
            CGContextRef c = UIGraphicsGetCurrentContext();
            CGContextSetLineWidth(c, 5.0f);
            CGContextSetStrokeColor(c, delayColor);

            CGContextBeginPath(c);
            CGContextMoveToPoint(c, line.delayStartPos.x, line.delayStartPos.y);
            CGContextAddLineToPoint(c, line.delayEndPos.x, line.delayEndPos.y);
            CGContextStrokePath(c);

            [line incrementDelayLine];
            [self setNeedsDisplay];
        }
    }
} 
```

**_lines**是具有 GameLine 对象（非原子，保留）属性的 NSMutableArray。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-04T20:27:25.427

这是预期的。

当您调用 setNeedsDisplay 时，您将视图标记为需要重绘。好的。系统得到它。
*它将在您的应用程序的主循环下次运行时完成*。

**如果您现在**真的想刷新视图，请调用：

```
[[NSRunLoop currentRunLoop] runMode: NSDefaultRunLoopMode beforeDate: [NSDate date]]; 
```

之后`setNeedsDisplay`。

事实上，[苹果文档](http://developer.apple.com/library/ios/#documentation/UIKit/Reference/UIView_Class/UIView/UIView.html)指出（强调我的）：

> 当您的视图的实际内容发生变化时，您有责任**通知系统**您的视图需要重绘。为此，您可以调用视图的**setNeedsDisplay**或 setNeedsDisplayInRect: 方法。**这些方法让系统知道它应该在下一个绘图周期更新视图。**因为**它要等到下一个绘图周期**才更新视图，所以可以在多个视图上调用这些方法同时更新它们。

另外，请参阅这些 SO 问题：

*   [如何强制视图呈现自己？](https://stackoverflow.com/questions/5408234/how-to-force-a-view-to-render-itself)
*   [有没有办法让 drawRect 现在工作？](https://stackoverflow.com/questions/4739748/is-there-a-way-to-make-drawrect-work-right-now/4766028#4766028)（和你一样的担心）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-04T20:31:54.630

如果您需要动画 - 启动计时器，一旦它被触发 - 调整您想要的任何行参数并调用`setNeedsDisplay`