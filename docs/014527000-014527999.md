# StackOverflow 问答 14527000-14527999

# apache-flex - localToGlobal flex 火花空气中的输出不正确

> ID：14527000
> 
> 赞同：1
> 
> 时间：2013-01-25T17:18:01.817
> 
> 标签：apache-flex, actionscript, air

与 localToGlobal 堆叠

我有这个代码（见 id=search）：

```
<s:NavigatorContent id="clients" width="100%" height="100%" >
    <s:layout>
        <s:VerticalLayout gap="0"
                          paddingBottom="0"
                          paddingLeft="0"
                          paddingRight="0"
                          paddingTop="0"/>
    </s:layout>

    <s:SkinnableContainer backgroundColor="0xF3F3F3" width="100%" height="40">
        <s:layout>
            <s:HorizontalLayout verticalAlign="middle"
                                paddingLeft="3"
                                paddingBottom="2"
                                paddingTop="2"
                                paddingRight="3"/>
        </s:layout>

        <s:Button id="addClientBtn"
                  label="{resourceManager.getString(
                      'myResources','workplace.addClientBtn')}"
                  icon="{Images.add}"
                  click="{addClient()}"
                  doubleClickEnabled="true"
                  doubleClick="{openHelp('NewClient')}"/>

        <s:Spacer width="100%" />

        <components:SearchClients id="search"/>
    </s:SkinnableContainer>
</s:NavigatorContent> 
```

在 creationComplete 事件中 ->

```
search.localToGlobal( new Point(search.x,search.y)) 

Output returns  
(x=0, y=32) 
```

但从视觉上我看到这个输出是错误的。应该类似于 ~ (x=300, y=32)

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T22:25:44.620

这不太正确：

```
search.localToGlobal(new Point(search.x,search.y)); 
```

search.x 和 search.y 是相对于 NavigationContainer 的坐标，其中 search.localToGlocal 期望指向相对于搜索的点，即 x,y 点本地搜索并将它们转换为全局坐标。

我认为您想要的是：
search.localToGlobal(new Point(0, 0));

您可能需要检查 ViewStack 的 creationPolicy（默认情况下它是自动的）以及该视图是否是执行此计算时的第一个视图。默认情况下，当调用应用程序 creationComplete 方法时，视图堆栈中只会存在一个视图（第一个）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T17:29:04.097

您计算相对于搜索的点，因此您需要设置零点：

```
search.localToGlobal(new Point(0, 0)); 
```

# python - 通过 FTP 下载 zip 文件并在 Python 中提取内存中的文件

> ID：14527010
> 
> 赞同：1
> 
> 时间：2013-01-25T17:18:35.263
> 
> 标签：python, ftp, zip

我正在尝试通过 ftp 下载一个 zip 文件，然后在没有实际保存 zip 的情况下提取其中的文件。知道我该怎么做吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-25T17:35:42.677

使用[zipfile.open](http://docs.python.org/2/library/zipfile#zipfile.ZipFile.open)

它将档案中的一个成员打开到内存中。由于 ZipFile 接受任何类似文件的对象作为参数，因此您可以从许多来源获取它，例如 HTTP/FTP 服务器

```
import urllib
import io
from zipfile import ZipFile

mysock = urllib.urlopen('ftp://ftp.yourhost.com/spam.zip')  // check urllib for parameters
memfile = io.BytesIO(mysock.read())
with ZipFile(memfile, 'r') as myzip:
    f = myzip.open('eggs.txt')
    content = f.read()  // or other file-like commands 
```

还要检查[Python 内存 zip 库](https://stackoverflow.com/questions/2463770/python-in-memory-zip-library?rq=1)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-25T17:34:49.123

该[`ftplib`](http://docs.python.org/3/library/ftplib.html#module-ftplib)模块允许通过 FTP 下载文件。

该[`zipfile`](http://docs.python.org/3/library/zipfile.html#module-zipfile)模块允许从 zip 文件中提取文件。

这是关键，[`io.BytesIO`](http://docs.python.org/3/library/io.html#io.BytesIO)该类允许您将内存中的字节传递给任何需要文件的东西。（在 Python 2.x 中，该[`StringIO`](http://docs.python.org/2.7/library/stringio.html#module-StringIO)模块提供了类似的功能。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-25T17:33:45.287

zipfile 模块可用于从 zip 文件中提取内容；ftplib 将用于访问 zip 文件。不幸的是，ftplib 没有为 zipfile 提供一个类似文件的对象来访问文件的内容。我想您可以读取 zip 并将其存储在内存中，例如存储在一个字符串中，然后可以将其包裹在一个类似文件的对象 (StringIO) 中，尽管您仍然可以获得整个 zip，只是没有将其保存到磁盘。

如果您不需要保存单个文件，而只是访问（即读取）它们，则 zipfile 将允许您执行此操作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-07-07T05:22:47.137

我找不到直接提取文件的可能方法，但这里有一个替代方法：

首先，从 FTP 下载文件

```
ftp =ftplib.FTP(FtpServer)          #connect to the ftp server
ftp.login(ServerUser,ServerPwd)     #using your credentials here

filedata = open(os.path.join(destination,DowloadedFileName),'wb')
ftp.retrbinary('RETR '+SourceFilename,filedata.write)      
filedata.close()
ftp.quit() 
```

其次，从 zip 中提取文件：

```
path_to_zip_file = os.path.join(destination,DowloadedFileName)
directory_to_extract_to = destination
with zipfile.ZipFile(path_to_zip_file, 'r') as zip_ref:
    zip_ref.extractall(directory_to_extract_to) 
```

最后，删除下载的 zip 文件

```
os.remove(path_to_zip_file) 
```

# python - 用于从嵌套的 Python 对象 (dicts) 创建树形图的 Python 库

> ID：14527011
> 
> 赞同：14
> 
> 时间：2013-01-25T17:18:59.443
> 
> 标签：python, graph, dictionary, tree

有谁知道任何 Python 库可以让您简单快速地为其提供嵌套到任意级别的对象，例如按照您在[此 gist](https://gist.github.com/hrldcpr/2012250)中找到的内容的 dict 树，它可以吐出一个可行的树图形文件？

在这里，简单是关键，因为我必须能够与没有技术头脑的人一起工作。

我所说的“图树”是指以下内容，我可以向它提供一个嵌套的值字典，然后它会创建树结构：

[![](../Images/d48fb8910e3d313180460e03a1b7c5ed.png)](https://i.stack.imgur.com/OIduA.jpg)
[（来源：[rubyforge.org](http://dhaka.rubyforge.org/parse_tree.jpg)）]

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-25T17:50:16.910

我不确定这是否完全符合您的想法，但这是您首先想到的。

[blockdiag](http://blockdiag.com/)主要用作类似于[Graphviz](http://www.graphviz.org/)（存在 Python 接口）的独立文件处理器。它接受一个文本文件作为输入，语法非常简单，并生成图像作为输出。

您应该能够编写一个简单的 shim 来输出您的递归 dict 结构，该结构已格式化为独立 blockdiag 脚本的输入，或者导入 blockdiag 包的必要内部结构并直接驱动输出。

如果这听起来很有希望，我会看看是否可以编写一些示例代码。

**编辑**示例代码：

```
def print_blockdiag(tree, parent=None):
    if not parent: print('blockdiag { orientation = portrait')
    for key in tree:
        if parent: print('   {} -> {};'.format(parent, key))
        print_blockdiag(tree[key], key)
    if not parent: print('}') 
```

这将输出一个 blockdiag 可以读取的文件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-25T18:41:36.787

所以我在这个答案中为我的代码片段推荐和使用的库*不是*python 库，但它是一个 python 友好的库，我的意思是使用这个库的代码可以插入到 python 模块中来处理数据和这个*外部*代码将连接到两端现存的python代码，即输入和输出，我怀疑，虽然我当然不知道，但这就是“python库”标准的真正含义。因此，如果您正在编写 Web 应用程序，则此代码将是客户端的。换句话说，这个库不是 python，但它可以与 python 一起使用。

1.  *它的输入（几乎）是原始 python dicts*，更具体地说，*json.load(a_python_dict)*返回一个 json 数组或对象，这个 javascript 库当然可以识别的格式；和

2.  输出格式是 HTML 或 SVG，而不是某些特定语言格式的对象

您可以使用[d3.js](http://d3js.org)。它有一个专门用于渲染树的[类：](https://github.com/mbostock/d3/wiki/Tree-Layout)

```
var tree = d3.layout.tree().size([h, w]); 
```

在*d3的**示例文件夹*中还有几个树的示例（工作代码）*，您可以从我上面提供的链接克隆/下载它们。*

 *因为d3是一个javascript库，它的原生数据格式是*JSON*。

基本结构是一个嵌套字典，每个字典代表一个具有两个值的单个节点，节点的名称及其子节点（存储在一个数组中），分别以***names***和***children***为键：

```
{"name": "a_root_node", "children": ["B", "C"]} 
```

当然，在 python 字典和 JSON 之间进行转换也很简单：

```
>>> d = {"name": 'A', "children": ['B', 'C']}
>>> import json as JSON
>>> dj = JSON.dumps(d)
>>> dj
    '{"name": "A", "children": ["B", "C"]}' 
```

这是一个较大的树（十几个节点）的python*字典*表示，我如上所述将其转换为json，然后在*d3*中呈现为下图所示的树：

```
tree = {'name': 'root', 'children': [{'name': 'node 2', 'children': 
       [{'name': 'node 4', 'children': [{'name': 'node 10', 'size': 7500}, 
       {'name': 'node 11', 'size': 12000}]}, {'name': 'node 5', 'children': 
       [{'name': 'node 12', 'children': [{'name': 'node 16', 'size': 10000}, 
       {'name': 'node 17', 'size': 12000}]}, {'name': 'node 13', 'size': 5000}]}]}, 
       {'name': 'node 3', 'children': [{'name': 'node 6', 'children': 
       [{'name': 'node 14', 'size': 8000}, {'name': 'node 15', 'size': 9000}]}, 
       {'name': 'node 7', 'children': [{'name': 'node 8', 'size': 10000}, 
       {'name': 'node 9', 'size': 12000}]}]}]} 
```

![树表示为在 d3 中呈现的 python 字典：](../Images/ea68a306b84d3fcba27328ebdc66cd8e.png)

*注意*：d3 在*浏览器*中呈现；上图只是我的浏览器窗口的屏幕截图。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-04-27T07:59:28.970

D3.js 是一个主要用于可视化的库......

据我所知，它没有提供方便的工具来遍历图形和对其进行数学运算。但它们在 Python **networkX**包中：

```
import networkx as nx

graph_data = {
    'id': 'root',
    'children': [
        {
            'id': 'A',
            'children': [
                {
                    'id': 'B', 'children': [{'id': 'B1'}, {'id': 'B2'}]
                },
                {
                    'id': 'C'
                }
            ]
        }
    ]
}

G = nx.readwrite.json_graph.tree_graph(graph_data)

print('EDGES: ', G.edges())
# EDGES: [('root', 'A'), ('A', 'B'), ('A', 'C'), ('B', 'B1'), ('B', 'B2')]
print('NODES: ', G.nodes())
# NODES: ['root', 'A', 'B', 'B1', 'B2', 'C'] 
```

这是从结构创建相同的 D3.js（带有`id`和`children`字段）的示例。

Graph也可以通过递归迭代创建，以及多种格式的读写： [https ://networkx.github.io/documentation/stable/reference/readwrite/index.html](https://networkx.github.io/documentation/stable/reference/readwrite/index.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-09-25T13:15:47.483

我一直在寻找类似的问题：使用嵌套字典打印字典的键，其中键结构非常周期性。因此，我编写了一个递归函数，它打印每个 dict 和嵌套 dicts 的键，**但只**针对**单个分支**。

希望以下代码片段对其他人有所帮助：

```
from itertools import zip_longest

def dictPrintKeysTopBranch(dic):
    #track recursive depth
    depth=dictPrintKeysTopBranch.data.get('depth',-1)+1;
    dictPrintKeysTopBranch.data['depth']=depth;

    #accumalte keys from nested dicts
    if type(dic) is type(dict()):
        listKeys=sorted(list(dic.keys()));

        #save keys of current depth
        dictPrintKeysTopBranch.data['listKeysDepth{}'.format(depth)]=listKeys;

        #repeat for top branch
        dictPrintKeysTopBranch(dic[listKeys[0]]);

    #print accumalated list of keys
    else: 
        #pad lists 
        lists=[];
        maxlen=[];
        for d in range(depth):
            l=dictPrintKeysTopBranch.data['listKeysDepth{}'.format(d)];
            lists.append(l);

            lens = [len(s) for s in l];
            maxlen.append(max(lens)+1);

        i=-1;
        for zipped in zip_longest(*lists, fillvalue=' '):
            i=i+1;
            #print(x)
            row = '';
            j=-1;
            for z in zipped:
                j=j+1;
                if i==0:
                    row = row+ ((' {: <'+str(maxlen[j])+'} -->\\').format(z));
                else :
                    row = row+ ((' {: <'+str(maxlen[j])+'}    |').format(z));
            print(row.strip('\\|->'));

    dictPrintKeysTopBranch.data={};
dictPrintKeysTopBranch.data={}; 
```

这里有一个例子：

```
mydict = { 'topLv':{'secLv':{'thirdLv':{'item1':42,'item2':'foo'}}}, 
           'topLvItem':[1,2,3], 
           'topLvOther':{'notPrinted':':('}
         }
dictPrintKeysTopBranch(mydict) 
```

输出：

```
topLv       -->\ secLv  -->\ thirdLv  -->\ item1  
topLvItem      |           |             | item2     
topLvOther     |           |             | 
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2013-04-07T17:02:40.693

根据您的需要，但如果您只需要它来轻松查看内容，您可以使用在线工具 - [“Python dict formatter and viewer”](http://www.python-dict-viewer.com)可以将 dict 呈现为树。*

# delphi - TListView - 如何在调整大小时重新排列项目

> ID：14527012
> 
> 赞同：3
> 
> 时间：2013-01-25T17:19:04.570
> 
> 标签：delphi, listview

我有一个显示小缩略图的**TListView**`(ViewStyle:=vsIcon)`。在运行时，我将图像分配给项目：

```
 for i := 0 to Total - 1 DO
   with ListView.Items.Add DO
     begin
      Caption := 'Item ' + IntToStr(i);
      ImageIndex := i;
     end; 
```

启动时表单不是很宽，缩略图仅显示在 3 列上。不幸的是，如果我调整表单（和**ListView**）的大小，列数将保持为 3，并且在右侧我将有很多空白。

这也不起作用：

```
procedure TForm1.FormCreate(Sender: TObject);
begin
 ListView.IconOptions.AutoArrange := TRUE;
end; 
```

如何重新排列项目以填充空白空间？
有像 AutoArrange 这样的属性吗？

* * *

更新：
我删除了旧控件，并在表单上放置了一个新控件。
现在`ListView.IconOptions.AutoArrange`工作。以前的控件中有一些东西（我做了一些设置）阻止了 AutoArrange 工作。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-25T17:25:04.120

有*一个*像`AutoArrange`. 它属于[`IconOptions`](http://docwiki.embarcadero.com/Libraries/XE2/en/Vcl.ComCtrls.TCustomListView.IconOptions)属性而不是直接属于列表视图。

```
ListView1.IconOptions.AutoArrange := True; 
```

要一次性排列图标，您可以调用`ListView_Arrange`。

# content-management-system - 使用 PageBuilder 作为 SmartForm 内容的模板

> ID：14527014
> 
> 赞同：1
> 
> 时间：2013-01-25T17:19:07.907
> 
> 标签：content-management-system, ektron

我有一些文章要发布，我已经设置了一个包含所有文章内容的智能表单。我使用 PageBuilder 页面作为模板并让智能表单使用此模板。我需要具有此内容的 PageBuilder 模板的灵活性。这很好用： [https ://www.ektron.com/Blogs/eGandalf/Combining-Dynamic-Content-with-PageBuilder/](https://www.ektron.com/Blogs/eGandalf/Combining-Dynamic-Content-with-PageBuilder/)

我的问题是，现在我们需要有一个移动版的文章内容。

我的问题是您如何让一个智能表单与两个模板相关联。这可以由设备或 URL 确定。

例如，

```
if (desktop device)     
   use desktop template
else if (mobile device)
   use mobile template 
```

或者

```
if (http://domain.com/content/item)  
    use desktop template  
else if (http://domain.com/m/content/item)  
    use mobile template 
```

我尝试使用快速链接来做到这一点，但每次更新页面布局时都会重新编写快速链接。这是一个重大的维护噩梦。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-26T05:30:18.177

**移动模板**

您可以指定模板的移动版本。如果移动模板具有与桌面模板相同 ID 的放置区，则会显示相同的小部件。

在这种情况下，移动设备和桌面设备的 URL 将相同，并且 Ektron 将使用设备检测来决定显示哪个模板。

[Ektron 参考（特别是设置移动模板）](http://documentation.ektron.com/cms400/v8.50/Reference/Mobile/Advanced/Content/Mobile_Devices/Mobile_Devices.htm)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-26T05:35:31.153

**元数据到 Smartform**

我经常使用元数据链接到智能表单。页面布局可以有一个指向智能表单的元数据链接，然后小部件需要通过元数据访问智能表单。

我们通常在桌面和移动页面布局上设置元数据，以保持一致。

在这种情况下，页面将具有不同的 URL。

# java - 请向我解释这个for循环

> ID：14527020
> 
> 赞同：0
> 
> 时间：2013-01-25T17:19:24.877
> 
> 标签：java, jakarta-ee

你能解释一下`for-loop`吗？

```
beanNote bnote = new beanNote();
String somme=0;
for (Note note : bnote.getNotes()) {
     somme = somme + note.getNoteMat();
} 
```

我只知道经典之`for-loop`类的：

```
for(int i=0; i<1000; i++){
   // do job .....
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-25T17:22:00.610

它相当于：

> for (注记 = bnote.getFirstNote(); bnote.stillNotes() ; 注 = bnote.getTheFolwingNote()) {
> 
> ```
> somme = somme + note.getNoteMat(); 
> ```
> 
> }

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-25T17:20:59.420

```
for (Note note : bnote.getNotes()) {
     somme = somme + note.getNoteMat();
} 
```

它的 e `nhanced for-loop`，有时甚至`for-each loop`在 java 版本 5 中引入，这使得迭代集合和数组变得灵活。

[**For-Each 循环**](http://docs.oracle.com/javase/1.5.0/docs/guide/language/foreach.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-25T17:21:53.887

这是一个 for-each 构造： bnote.getNotes() 返回一个数组或一个 Iterable 对象，并且针对该集合中的每个对象执行循环体。

# java - InvokeLater 事件排序

> ID：14527023
> 
> 赞同：9
> 
> 时间：2013-01-25T17:19:33.770
> 
> 标签：java, swing, awt, event-dispatch-thread

javadoc 声明要求排队的`EventQueue`事件按顺序分派。

保证在后续用户事件（例如 a ）之前调度`Runnable`s 排队是否正确？换句话说，如果用户事件发生在之后，事件处理程序可以在入队之前执行。`EventQueue.invokeLater``MouseEvent``Runnable``EventQueue.invokeLater`

谢谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-25T17:28:57.163

API 文档声明事件是

> 与它们入队的顺序相同。

但是，如果您检查源代码，您会发现情况并非总是如此，尽管它在大多数情况下基本上是正确的。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-01-25T17:38:17.847

可能最好解释一下您要做什么。一般来说，事件分派系统的设计使您不应该知道或担心它的内部结构。如果您正在编写一个直接更新 UI 的事件处理程序，那么不使用 Runnable 并内联执行更新可能是有意义的。但是，如果您的事件处理程序执行一些计算或处理需要不确定的时间量，那么您将希望使用一个线程，该线程最终将使用带有 Swing.invokeLater 调用的 Runnable 执行 UI 更新。需要知道事件被分派时的顺序意味着您正在尝试在您的逻辑中建立可能属于其他地方的假设。

例如，考虑一个鼠标单击事件处理程序，它在线程中执行繁重的处理（网络下载或 DBMS 查询），然后更新 UI 中的文本标签。您可能希望确保在用户单击 UI 上的其他位置之前进行处理和 UI 更新，以避免处理单击的歧义。在这种情况下，您可能会在初始鼠标点击事件中立即禁用 UI 或 UI 的某些可点击部分，以便 UI 保持响应但保护您的 onMouse 处理程序不重新进入，直到原始点击事件完全处理。（请原谅下面的代码片段，因为我完成 Swing 已经有好几年了，它更像是伪代码。）

```
void setUIEnabled(boolean enable) {
   for(Button eachUIButton : getAllClickableButtons()) {
      eachUIButton.setEnabled(enable);
   }
}

void onMouseClick(MouseEvent event) {
   setUIEnabled(false);
   new Thread(
      new Runnable() {
         public void run() {
            final String result = doLengthyProcessing();
            enableRunnable = new Runnable() {
               public void run() {
                  setUIEnabled(true);
                  updateTextLabelFromLengthyProcess(result);
               }
            };
            Swing.invokeLater(enableRunnable);
         }
      }
   ).start();
} 
```

这里的想法是您编写逻辑，使其不依赖于调度事件的随机顺序，而是承认处理可能比下一个传入的鼠标事件花费更长的时间，并为此类时间做出规定。一个微妙的改进是还绘制一个进度指示器或进度微调器，以指示正在向用户完成工作。

# macos - 加载顶点着色器时出错

> ID：14527025
> 
> 赞同：3
> 
> 时间：2013-01-25T17:19:44.467
> 
> 标签：macos, opengl, graphics, xcode4.5, shader

我正在 OpenGL 和计算机图形学方面迈出第一步。我找到[了这本书](http://www.cs.unm.edu/~angel/BOOK/INTERACTIVE_COMPUTER_GRAPHICS/SIXTH_EDITION/)，我正在尝试遵循示例和理论，但是当我尝试编译项目时出现以下错误

```
vertex.glsl failed to compile:
ERROR: 0:1: '' :  version '150' is not supported 
```

顶点文件有这个：

```
#version 150

varying vec4 vPosition;

void main(){
    gl_Position = vPosition;
} 
```

我试图执行的代码是：

```
#include "Angel.h"
#include <iostream>

const int numPoints = 5000;
typedef vec2 point2;

void init(){

    point2 points[numPoints];
    point2 vertices[3] = {
        point2(-1.0, -1.0), point2(0.0, 1.0), point2(1.0, -1.0)
    };

    points[0] = point2(0.25, 0.5);

    for (int k = 1; k < numPoints; k++) {
        int j = rand()%3;
        points[k] = (points[k-1]+vertices[j])/2.0;
    }

    GLuint program = InitShader("vertex.glsl", "fragment.glsl");
    glUseProgram(program);

    GLuint abuffer;
    glGenVertexArraysAPPLE(1, &abuffer);
    glBindVertexArrayAPPLE(abuffer);

    GLuint buffer;
    glGenBuffers(1, &buffer);
    glBindBuffer(GL_ARRAY_BUFFER, buffer);
    glBufferData(GL_ARRAY_BUFFER, sizeof(points), points, GL_STATIC_DRAW);

    GLuint location = glGetAttribLocation(program, "vPosition");
    glEnableVertexAttribArray(location);
    glVertexAttribPointer(location, 2, GL_FLOAT, GL_FALSE, 0, BUFFER_OFFSET(0));

    glClearColor(1.0, 1.0, 1.0, 1.0);

}

void display(){
    glClear(GL_COLOR_BUFFER_BIT);
    glDrawArrays(GL_POINTS, 0, numPoints);
    glFlush();
}

int main(int argc, char** argv){

    glutInit(&argc, argv);

    glutInitDisplayMode(GLUT_RGBA);

    glutInitWindowSize(640, 480);

    glutCreateWindow("Sierpinski Gasket");

    init();

    glutDisplayFunc(display);

    glutMainLoop();

    return 0;
} 
```

我检测到问题出在函数`InitShader("vertex.glsl", "fragment.glsl");`中：

```
#include "Angel.h"

namespace Angel {

    // Create a NULL-terminated string by reading the provided file
    static char*
    readShaderSource(const char* shaderFile)
    {
        FILE* fp = fopen(shaderFile, "r");

        if ( fp == NULL ) { return NULL; }

        fseek(fp, 0L, SEEK_END);
        long size = ftell(fp);

        fseek(fp, 0L, SEEK_SET);
        char* buf = new char[size + 1];
        fread(buf, 1, size, fp);

        buf[size] = '\0';
        fclose(fp);

        return buf;
    }

    // Create a GLSL program object from vertex and fragment shader files
    GLuint
    InitShader(const char* vShaderFile, const char* fShaderFile)
    {
        struct Shader {
            const char*  filename;
            GLenum       type;
            GLchar*      source;
        }  shaders[2] = {
            { vShaderFile, GL_VERTEX_SHADER, NULL },
            { fShaderFile, GL_FRAGMENT_SHADER, NULL }
        };

        GLuint program = glCreateProgram();

        for ( int i = 0; i < 2; ++i ) {
            Shader& s = shaders[i];
            s.source = readShaderSource( s.filename );
            if ( shaders[i].source == NULL ) {
                std::cerr << "Failed to read " << s.filename << std::endl;
                exit( EXIT_FAILURE );
            }

            GLuint shader = glCreateShader( s.type );
            glShaderSource( shader, 1, (const GLchar**) &s.source, NULL );
            glCompileShader( shader );

            GLint  compiled;
            glGetShaderiv( shader, GL_COMPILE_STATUS, &compiled );
            if ( !compiled ) {
                std::cerr << s.filename << " failed to compile:" << std::endl;
                GLint  logSize;
                glGetShaderiv( shader, GL_INFO_LOG_LENGTH, &logSize );
                char* logMsg = new char[logSize];
                glGetShaderInfoLog( shader, logSize, NULL, logMsg );
                std::cerr << logMsg << std::endl;
                delete [] logMsg;

                exit( EXIT_FAILURE );
            }

            delete [] s.source;

            glAttachShader( program, shader );
        }

        /* link  and error check */
        glLinkProgram(program);

        GLint  linked;
        glGetProgramiv( program, GL_LINK_STATUS, &linked );
        if ( !linked ) {
            std::cerr << "Shader program failed to link" << std::endl;
            GLint  logSize;
            glGetProgramiv( program, GL_INFO_LOG_LENGTH, &logSize);
            char* logMsg = new char[logSize];
            glGetProgramInfoLog( program, logSize, NULL, logMsg );
            std::cerr << logMsg << std::endl;
            delete [] logMsg;

            exit( EXIT_FAILURE );
        }

        /* use program object */
        glUseProgram(program);

        return program;
    }

}  // Close namespace Angel block 
```

完整的源代码可以在本书的链接中找到。这是什么问题？我对着色器一无所知，我只是想让这个应用程序工作。我正在使用 OS X 10.8、Xcode 4.5 的 Mac 上执行此操作

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-25T18:46:52.177

仔细检查您的实现`GL_VERSION`是否`GL_SHADING_LANGUAGE_VERSION`符合您的期望。

OSX 可能不会/可能不会为您提供带有不合格`glutInitDisplayMode(GLUT_RGBA)`. 尝试`GLUT_3_2_CORE_PROFILE`在那里拍打：

```
glutInitDisplayMode(GLUT_RGBA | GLUT_3_2_CORE_PROFILE); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-25T17:40:28.630

如果不支持 150 版，则您正在使用非常旧的硬件，或者您的显卡驱动程序不是最新的。

# php - 处理来自 php 和 jQuery 的 json var，而是提供文本 var

> ID：14527026
> 
> 赞同：2
> 
> 时间：2013-01-25T17:19:46.767
> 
> 标签：php, jquery, ajax, json

我使用 jquery 通过 ajax 接收来自 php 脚本的文本，如下所示：

```
$.ajax({
        dataType: 'json',
           url: 'someURL.com',
                success:function(result){
                    json = JSON.parse(result.rgraph);
}) 
```

result.rgraph 在 php 中发送为：

```
$arr = array( 'actiondata'=> 'some info here',  'rgraph' => $this->_rgraph() );
$jsonTable = json_encode($arr);

return $jsonTable; 
```

其中 $this->_rgraph() 只是一个返回的函数：

> return '{ id：“0_0”，名称：“类别”，孩子：[{ id：“0_1”，名称：“业务服务”，数据：{关系：“”}，孩子：[{ id：“0_2” ，名称：“H-FARM Ventures”，数据：{关系：“”}，儿童：[] }]}，{ id：“0_3”，名称：“原因”，数据：{关系：“”}，儿童：[{ id：“0_4”，名称：“StartupVisa”，数据：{关系：“”}，孩子：[] }]}，{ id：“0_5”，名称：“社区”，数据：{关系： "" },children: [{ id: "0_6", name: "Different Solutions", data: { relationship: "" }, children: [] }]},{ id: "0_7", name: "News/媒体网站”，数据：{关系：“”}，儿童：[{ id：“0_8”，名称：“iSpazio”，数据：{ 关系：“”}，儿童：[] }]}，{ id：“0_9”，名称：“非营利组织”，数据：{关系：“”}，儿童：[{ id：“0_10”，名称：“Indigeni Digitali”，数据：{ 关系：“”}，儿童：[] }]}，{ id：“0_11”，名称：“网站”，数据：{ 关系：“”}，儿童：[{ id：“0_12”，名称：“Hot Pin Venezuela”，数据：{关系：“”}，儿童：[]}，{ id：“0_13”，名称：“El Chiguire Bipolar”，数据：{关系：“ " }, 孩子: [] }]}], 数据: { 关系: "一些文本" }}';{ 关系：“”}，孩子：[] }]}，{ id：“0_11”，名称：“网站”，数据：{ 关系：“”}，孩子：[{ id：“0_12”，名称：“热销委内瑞拉”，数据：{ 关系：“”}，儿童：[] }，{ id：“0_13”，名称：“El Chiguire Bipolar”，数据：{关系：“”}，儿童：[] }] }]，数据：{关系：“一些文本”}}'；{ 关系：“”}，孩子：[] }]}，{ id：“0_11”，名称：“网站”，数据：{ 关系：“”}，孩子：[{ id：“0_12”，名称：“热销委内瑞拉”，数据：{ 关系：“”}，儿童：[] }，{ id：“0_13”，名称：“El Chiguire Bipolar”，数据：{关系：“”}，儿童：[] }] }]，数据：{关系：“一些文本”}}'；

然后我在图表引擎中使用这个 var (json)，我的想法是，如果我将 _rhraph() 返回的字符串复制到它工作的 javascript 上的 ajax 硬编码上，它会将字符串作为对象获取并绘制 chard。但是，如果让脚本从 php 脚本中检索 var，您可能会认为这个 var 作为文本到达**json = JSON.parse(result.rgraph);** 因为如果我在 json 上发出警报，我会看到内容而不是 Object 对象。所以此时我将代码更改为：`json = JSON.parse(result.rgraph);`

但这给了我一个错误：*Uncaught SyntaxError: Unexpected token i*。我不知道发生了什么，似乎 json var 的格式不正确，但是为什么当我对 var 进行硬编码时它可以工作？有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T17:22:15.903

您需要引用您的密钥以获得有效的 JSON

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-25T17:22:33.873

那不是有效的 JSON。必须引用键名，例如：

```
{ "id" : ... 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-25T17:22:53.183

只需将所有 JSON 键放在引号中（“id”、“etc”）...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-25T17:26:48.720

我认为你必须用以下方式解析它`jQuery.parseJSON()`：

```
json = jQuery.parseJSON(result); 
```

# jquery - 响应式设计的 scrollTop() 值

> ID：14527027
> 
> 赞同：0
> 
> 时间：2013-01-25T17:19:46.683
> 
> 标签：jquery, responsive-design

您好，我正在构建一个类似于此[http://engageinteractive.co.uk/](http://engageinteractive.co.uk/)的顶部导航系统 （当在主图片下滚动时，透明导航栏会变成纯色透明色）。在我的设计中，我给导航栏一个固定的位置并应用了以下代码

```
$(window).scroll(function() {
    var top_val = $(window).scrollTop();
    if(top_val > 600) {
        $("#main_nav_container").removeClass('transparent_0');
        $("#main_nav_container").addClass('transparent_1');
    }
}); 
```

这对我很有用，在通过主站点图像（测试值为 600）后，导航容器会更改其显示。问题是我还需要针对响应式设计进行调整。我的主顶部图像根据浏览器大小更改其大小，因此我需要以某种方式将我从 scrollTop() 属性获得的固定值转换为相对大小。如果有人可以帮助我，我将不胜感激

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T17:22:45.810

您需要阅读主图像的位置，然后对此进行评估`scrollTop()`。像这样的东西，也许：

```
 var main_img = $('img.main_img'),
scroll_change_at = main_img.offset().top + main_img.height();

$(window).scroll(function() {
    var top_val = $(this).scrollTop();

    if(top_val > scroll_change_at) 
    {
        $("#main_nav_container").removeClass('transparent_0');
        $("#main_nav_container").addClass('transparent_1');
    }
}); 
```

显然替换了`main_img`分配的相关选择器。

# iphone - EKEventEditor 在 iPhone 上崩溃，但在 iPad 上没有

> ID：14527034
> 
> 赞同：2
> 
> 时间：2013-01-25T17:20:27.877
> 
> 标签：iphone, ios, objective-c, ipad, eventkit

我正在尝试使用以下代码集从我的 iPhone 应用程序模态调用本机 iOS 日历事件编辑窗口以从 UIButton 响应：

```
- (void) initCalendar:(id) sender {

EKEventStore *eventStore = [[EKEventStore alloc] init];

if([eventStore respondsToSelector:
    @selector(requestAccessToEntityType:completion:)]) {

    [eventStore requestAccessToEntityType:EKEntityTypeEvent completion:^(BOOL granted, NSError *error) {

        [self performSelectorOnMainThread: @selector(presentEventEditViewControllerWithEventStore:) withObject:eventStore waitUntilDone:NO];
    }];

} else {

    [self presentEventEditViewControllerWithEventStore:eventStore];

}

}

- (void) presentEventEditViewControllerWithEventStore:(EKEventStore*)eventStore {

EKEvent *event = [EKEvent eventWithEventStore:eventStore];

event.title = _meeting.meeting_title;

NSCalendar *gregorian = [[NSCalendar alloc] initWithCalendarIdentifier: NSGregorianCalendar];
NSDateComponents *components = [gregorian components: NSUIntegerMax fromDate: _meeting.date];

NSString *meetingTimeString = _meeting.time;

NSRange lastColonInTimeString = [meetingTimeString rangeOfString:@":" options:NSBackwardsSearch];
NSString *timeHour = [meetingTimeString substringToIndex:lastColonInTimeString.location];
NSString *timeMinute = [meetingTimeString substringFromIndex:lastColonInTimeString.location];

[components setHour:[timeHour integerValue]];
[components setMinute: [timeMinute integerValue]];
[components setSecond: 00];

NSDate *fullDateAndTime = [gregorian dateFromComponents: components];

event.startDate = fullDateAndTime;
event.allDay = NO;
event.endDate = [[NSDate alloc] initWithTimeInterval:7200 sinceDate:fullDateAndTime];
event.notes = [NSString stringWithFormat:@"%@ %@", _meeting.user_notes, _meeting.organizer_notes];
event.location = [NSString stringWithFormat:@"%@, %@",_meeting.location_long, _meeting.location_lat];

[event setCalendar:[eventStore defaultCalendarForNewEvents]];

EKEventEditViewController* controller = [[EKEventEditViewController alloc] init];
controller.eventStore = eventStore;
controller.event = event;
controller.editViewDelegate = self;

[self presentViewController:controller animated:YES completion:nil];

} 
```

此代码在同一应用程序的 iPad 版本中运行良好，但会导致 iPhone 崩溃并显示消息`"[EKEventEditor actionSheetShowing]: unrecognized selector sent to instance <0xXXXXXXX>"`

任何人都知道为什么这段代码应该在 iPad 上正常工作但在 iPhone 上不能正常工作？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T06:44:02.823

我正在使用 iOS 6.x。我的测试代码在 iPhone 上没问题。

```
EKEventEditViewController* controller = [[EKEventEditViewController alloc] init];
controller.allowsEditing = YES;
controller.event = event;
[self presentViewController:controller animated:YES completion:nil]; 
```

# python - 具有多个嵌套函数的 ndb.Tasklet 和 SyncTasklet

> ID：14527035
> 
> 赞同：3
> 
> 时间：2013-01-25T17:20:29.880
> 
> 标签：python, google-app-engine, asynchronous, app-engine-ndb

我正在尝试有效地调用 tasklet 和 subtasklet：

```
@ndb.tasklet
def getBeds(bed_key):
    bed = yield bed_key.get_asyn()
    bed_info = {}
    ......
    raise ndb.Return(bed_info)

@ndb.tasklet
def getRoom(room_key):
    room = yield room_key.get_async()
    room_info = {}
    ..........
    beds_in_room = map(getBeds,room.beds)
    room_info["beds"] = beds_in_room
    raise ndb.Return(room_info)

@ndb.tasklet
def getBuilding(build_key):
    build = yield build_key.get_async()
    build_info = {}
    ...........
    rooms_in_build = map(getRoom,build.rooms)
    build_info["rooms"] = rooms_in_build

@ndb.toplevel
def getHotel(hotel_obj)
    hotel_inf = {}
    .........
    buildings_in_hotel = map(getBuilding,hotel_obj.buildings)
    hotel_inf["buildings"] = buildings_in_hotel
    return hotel_inf 
```

出于某种原因，我虽然 @ndb.toplevel 会暂停 getHotel 直到一切完成。不幸的是，buildings_in_hotel 正在返回一个期货列表......

我如何让它完成？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-25T21:12:44.707

你屈服了！

当调用一个 tasklet 时，你总是得到一个 future，然后 yield 得到结果。还有并行 yield，您可以在其中产生一个元组或 tasklet 列表（有时称为屏障）。

```
beds_in_room = yield map(getBeds,room.beds) 
```

和

```
rooms_in_build = yield map(getRoom,build.rooms) 
```

和

```
buildings_in_hotel = yield map(getBuilding,hotel_obj.buildings) 
```

# linux - 了解 Linux 上从 hid 使用 id 到 gdk keyval 的方式

> ID：14527037
> 
> 赞同：2
> 
> 时间：2013-01-25T17:20:33.913
> 
> 标签：linux, hid, gdk

我想了解从键盘的隐藏使用 ID 通过系统到 GDK keyval 包含布局翻译的方式。或者更具体地说：我有一个 UTF-8 字符串，并且不想创建一个外部设备必须播放才能获得相同结果的隐藏键列表。

到目前为止我尝试了什么：

（精简版没有移位/替代处理）

```
#include <glib.h>
#include <gdk/gdk.h>
#include <gtk/gtk.h>

static GdkKeymapKey *get_key_with_group_0(GdkKeymapKey *keys, gint n_keys) {
gint i;

for (i = 0; i < n_keys; ++i)
    if (keys[i].group == 0)
        return &keys[i];

/* fallback: return first element */
g_warning("can't find keycode for group 0");
return keys;
}

static guint keycode_to_keyval(guint keycode) {
GdkKeymap *keymap;
GdkKeymapKey key = {keycode, 0, 0};
guint keyval;

keymap = gdk_keymap_get_default();
keyval = gdk_keymap_lookup_key(keymap, &key);
if (keyval == 0)
    g_warning("keycode %i has no keyval!\n", keycode);
return keyval;
}

/* Hid usage tables v1.12 chapter 10 and /usr/include/gtk-2.0/gdk/gdkkeysyms.h */
/* stores keyvals without modifiers */
static guint const table_hid_usage_id_to_keyval[232] = {
/*   0       1       2       3       4       5       6       7       8       9       A       B       C       D       E       F */
0x0000, 0x0000, 0x0000, 0x0000, 0x0061, 0x0062, 0x0063, 0x0064, 0x0065, 0x0066, 0x0067, 0x0068, 0x0069, 0x006a, 0x006b, 0x006c, /* 0 */
0x006d, 0x006e, 0x006f, 0x0070, 0x0071, 0x0072, 0x0073, 0x0074, 0x0075, 0x0076, 0x0077, 0x0078, 0x0079, 0x007a, 0x0031, 0x0032, /* 1 */
0x0033, 0x0034, 0x0035, 0x0036, 0x0037, 0x0038, 0x0039, 0x0030, 0xff0d, 0xff1b, 0xff08, 0xff09, 0x0020, 0x00df, 0x00b4, 0x00fc, /* 2 */
0x002b, 0x005c, 0x0023, 0x00f6, 0x00e4, 0x005e, 0x002c, 0x002e, 0x002d, 0xffe5, 0xffbe, 0xffbf, 0xffc0, 0xffc1, 0xffc2, 0xffc3, /* 3 */
0xffc4, 0xffc5, 0xffc6, 0xffc7, 0xffc8, 0xffc9, 0x0000, 0xff14, 0xff13, 0xff63, 0xff50, 0xff55, 0xffff, 0xff57, 0xff56, 0xff53, /* 4 */
0xff51, 0xff54, 0xff52, 0xff7f, 0xffaf, 0xffaa, 0xffad, 0xffab, 0xff8d, 0xff9c, 0xff99, 0xff9b, 0xff96, 0xff9d, 0xff98, 0xff95, /* 5 */
0xff97, 0xff9a, 0xff9e, 0xff9f, 0x003c, 0xff67, 0x0000, 0x0000, 0xffca, 0xffcb, 0xffcc, 0xffcd, 0xffce, 0xffcf, 0xffd0, 0xffd1, /* 6 */
0xffd2, 0xffd3, 0xffd4, 0xffd5, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, /* 7 */
0x0000, 0x0000, 0xffe5, 0x0000, 0xff14, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, /* 8 */
0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, /* 9 */
0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, /* A */
0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0xff89, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, /* B */
0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0xff80, 0x0000, 0x0000, /* C */
0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0xffae, 0x0000, 0x0000, 0x0000, /* D */
0xffe3, 0xffe1, 0xffe9, 0xffeb, 0xffe4, 0xffe2, 0xffea, 0xff67 /* E */
};

// Needs keyval without modifications
static guint8 keyval_to_hid(guint keyval) {
guint i;
for (i = 0; i < 232; ++i) {
    if (table_hid_usage_id_to_keyval[i] == keyval)
        return i;
}
return 0;
}

static void do_it(gchar const *text) {
gchar const *iter;
guint keyval;
gunichar character;
GdkKeymapKey *keys;
GdkKeymapKey *key;
gint n_keys;
GdkKeymap *keymap;

iter = text;

keymap = gdk_keymap_get_default();

while(TRUE) {
    character = g_utf8_get_char_validated(iter, -1);
    if (character == 0)
        break;

    keyval = gdk_unicode_to_keyval(character);

            /* get keyval without modifications */
    if (!gdk_keymap_get_entries_for_keyval(keymap, keyval, &keys, &n_keys)) {
        g_warning("keyval 0x%04x has no keycode!", keyval);
        iter = g_utf8_find_next_char(iter, NULL);
        break;
    }
    key = get_key_with_group_0(keys, n_keys);
    keyval = keycode_to_keyval(key->keycode);

    g_print("0x%04x\n", keyval_to_hid(keyval));

    g_free(keys);

    iter = g_utf8_find_next_char(iter, NULL);
}
}

int main(int argc, char **argv) {
g_type_init();
gtk_init(&argc, &argv);

do_it("Testing z");

return 0;
} 
```

我的问题：

键盘布局翻译在哪里以及如何完成？在我的德语键盘上，我得到了这个：

1.  按下“z”按钮
2.  设备发送 HID 使用 id 0x1c（y 和 Y）
3.  xev 说键码 29；密钥符号 0x7a；“z”

这个翻译是在哪里完成的，我怎么能这样回去？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-03T08:06:13.923

回答我自己的问题：

GTK 返回的键码是 X 使用的键码，它与键映射无关。通过静态查找将 xkeycode 转换为 keyval 并返回到 hid 使用 id 是错误的，因为 keyval 依赖于 keymap。

xkeycode 可以通过静态表 [1] 传输回内核键码。内核键码到隐藏使用 id 的进一步转换也是使用静态表 [2] 完成的。

[1] [http://lists.x.org/archives/xorg/2006-June/015633.html](http://lists.x.org/archives/xorg/2006-June/015633.html)

[2] [https://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/tree/drivers/hid/hid-input.c?id=refs/tags/v3.9](https://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/tree/drivers/hid/hid-input.c?id=refs/tags/v3.9)

# java - 如何像使用父对象一样使用子对象？

> ID：14527041
> 
> 赞同：0
> 
> 时间：2013-01-25T17:20:56.450
> 
> 标签：java

我有一组 Java 类用作工具包，可以插入到许多项目中。我不想更改此工具包中的代码，因此每当我更新它或修复错误时，我都可以将其放入正在使用它的任何项目中，而无需担心本地更改。因此，如果任何本地项目需要覆盖工具包中的方法，我只需制作工具包对象的本地版本，如下所示：

**文件：工具包/狗（）**

```
public class Dog(){
  public void pet(){
    print("scratch ruff");
  }
} 
```

**文件：本地/狗（）**

```
public class Dog extends toolkit/Dog {
  public void pet(){
    print("rub ears");
  }
} 
```

在本地对象中，我指的是本地`Dog`对象而不是工具包`Dog`对象。

到目前为止效果很好，但我遇到了一个问题。工具包中的另一个类使用`Dog`.

**文件：工具包/DogHandler**

```
public void careForPack( List<Dog> arg_allTheDogs ){
  for( Dog fido : arg_allTheDogs ){
    fido.pet();
  }
} 
```

出现的问题是系统不喜欢这些不是同一个`Dog`对象。我不想在本地覆盖`DogHandler`，因为我最终会覆盖我的整个工具包，这反而违背了目的。

有没有办法将的孩子（也称为）`DogHandler`识别为有效？`Dog``Dog`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-25T17:34:58.017

你应该让你的工具包方法接受一个`List`包含*扩展* `toolkit.Dog`类型的对象。您可以`? extends T`为此使用：

```
public void careForPack( List<? extends toolkit.Dog> arg_allTheDogs ){
  for( toolkit.Dog fido : arg_allTheDogs ){
    fido.pet();
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T17:24:21.310

```
public void careForPack( List<toolkit.Dog> arg_allTheDogs )
{
   for( local.package.name.Dog fido : arg_allTheDogs )
   {
       fido.pet();
   }
} 
```

编辑：也许这个？

```
//we need an interface to have datatype interchangability
public class Toolkit.Dog implements IToolkitDog
{
    public void pet()
    {
        print("toolkit dog says what");
    }
}

//we inherit the IToolkitDog from Toolkit.Dog
public class local.Dog extends Toolkit.Dog 
{
     public void pet()
     {
         print("rub ears");
     }
}

//both toolkit.dog and local.dog are of type IToolkitDog 
public void careForPack( List<IToolkitDog> arg_allTheDogs )
{
    for( local.Dog fido : arg_allTheDogs )
    {
       fido.pet();
    }
} 
```

这可以解决问题吗？

我想它看起来像这样

```
public interface IToolkitDog
{
     pet();
//...
} 
```

# c# - 命名空间“AuntieDot”中不存在类型或命名空间名称“Core”

> ID：14527042
> 
> 赞同：6
> 
> 时间：2013-01-25T17:20:57.050
> 
> 标签：c#, portable-class-library

我有 4 个 PCL，它们都针对相同的框架：

阿姨点：

![点点阿姨](../Images/a78325e232d853b239aa2de15b69cda7.png)

AuntieDot.身份验证：

![AuntieDot.Authentication](../Images/3ad9246e9cff167f4892ae11ab7a60fe.png)

AuntieDot.Core：

![AuntieDot.Core](../Images/428e4ad3dffcac0a0a17968f28ba479d.png)

AuntieDot.Models:

![AuntieDot.Models](../Images/ee331dacbbd0e1c1383e7460b30d34ca.png)

但由于某种原因，在“AuntieDot.Authentication”命名空间中使用“AuntieDot.Core.Helpers”（尽管将“AuntieDot.Core”作为引用添加到“AuntieDot.Authentication”中，但它表示它不存在。我用谷歌搜索，唯一得到的答复是我需要确保其他库针对的是相同的框架，它们是。

我使用的唯一外部代码是 JSON.net，它是我通过 NuGet 添加的，所以我认为这不是问题。

'AuntieDot.Core' 中的代码； ![帮手](../Images/c351b8fb8bf9d33bf60b9aa1cea3e749.png) ![例外](../Images/8e95b0b228a496af5f558e64030f36a4.png)

引发问题的代码只是在错误列表中抱怨，在编译时，它没有像往常一样的红色下划线：

![错误 ：（](../Images/0bcecbaca6a3da3e15035101ff3d2863.png)

我只是认为发布构建输出可能会有所帮助； [http://pastebin.com/raw.php?i=wn74UKyc](http://pastebin.com/raw.php?i=wn74UKyc)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-26T00:33:49.740

找到了问题，在针对我所针对的框架时，VS 似乎存在一个错误。我通过谷歌搜索`The currently targeted framework ".NETPortable,Version=v4.5,Profile=Profile78" does not include "System.Net.Requests, Version=4.0.0.0, Culture=neutral`构建输出中的错误发现了这一点，这让我在 Microsoft 的[Connect Site](http://connect.microsoft.com/VisualStudio/feedback/details/770242/build-error-with-dependent-portable-class-libraries-that-target-windows-phone-8)上遇到了同样的问题。似乎他们很快就会修复这个错误，但在此之前微软发布了这个解决方法，感谢 VS 团队的 Dave，

> 再次感谢您的错误报告。我们发现了另一种不需要您更改目标框架的解决方法。要解决此问题，请在文本编辑器中编辑项目，并在最后一个“导入”元素下方添加以下内容：

```
<Target Name="_SetFullFrameworkFolderToProfile"
 AfterTargets="GetReferenceAssemblyPaths">

<PropertyGroup>
 <_FullFrameworkReferenceAssemblyPaths>$(TargetFrameworkDirectory)</_FullFrameworkReferenceAssemblyPaths>
</PropertyGroup>
</Target> 
```

Andddd繁荣：

![赃物](../Images/03dccd977a8e3b5ff61ff6b2ca39e265.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-25T17:27:46.327

我之前在同一解决方案中引用其他项目时遇到过这个问题。我的问题只是我将那个 ONE 项目设置为构建，`Release`而解决方案的其余部分设置为`Debug`. 这意味着即使我正确引用了项目，编译器也没有在调试目录中找到编译后的 DLL。有机会吗？

# javascript - 使用正则表达式从文本中获取 URL

> ID：14527045
> 
> 赞同：-5
> 
> 时间：2013-01-25T17:21:03.533
> 
> 标签：javascript, regex, url

我有一段带有标签和垃圾的文本。在此块内是我想要获取的 youtube 视频链接，该链接始终以 ('http://www.youtube 并始终以'结尾，

我正在寻找一个可以提取 url 的正则表达式。谢谢！

这就是我所拥有的：

```
((https?|ftp|file)\://|www.)[A-Za-z0-9\.\-]+(/[A-Za-z0-9\?\&\=;\+!\(\)\*\-\._~%]*)*[^'] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T17:29:51.907

你可以试试这个正则表达式...

`www.youtube[^']*`

`[^']`匹配任何字符，除了`'`

`[^']*`匹配 0 到多个字符，除了`'`

# jquery - 通过 JSONP 获取数据时检测 SyntaxError

> ID：14527046
> 
> 赞同：2
> 
> 时间：2013-01-25T17:21:04.930
> 
> 标签：jquery, google-chrome, jsonp, syntax-error

我正在尝试`SyntaxError`使用 jQuery 通过 JSONP 访问可能格式错误的资源时检测到。

当我执行这样的事情时

```
try
{
  $.ajax("http://www.google.com", {dataType:"jsonp"});
  alert("good");
}
catch(e)
{
 alert("bad");
} 
```

我收到`"good"`消息和`Uncaught SyntaxError: Unexpected token <`来自`www.google.com:1`。我想得到的是`"bad"`消息。我正在使用 Chrome，但如果可能的话，我想要一个跨浏览器的解决方案。

有没有办法抑制`SyntaxError`并检测返回的资源不是有效的 JSONP 文档？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T17:35:43.990

[`window.onerror`](https://developer.mozilla.org/en-US/docs/DOM/window.onerror)捕获所有 JavaScript 语法错误。你可以像这样使用它：

```
$.ajax("http://www.google.com", {dataType:"jsonp"});

window.onerror = function(msg, url, linenumber) {
    if((msg == "Script error." || msg == "Syntax error") &&
        url.indexOf("http://www.google.com/") == 0) {

        alert("bad");

    }
} 
```

# delphi - 在 Delphi 中实施变更日志（第 2 步）

> ID：14527047
> 
> 赞同：7
> 
> 时间：2013-01-25T17:21:07.810
> 
> 标签：delphi, delphi-xe2, ntfs, ntfs-mft

继续[我之前的问题](https://stackoverflow.com/questions/14496630/implement-change-journal-in-delphi)，我可以使用这个[delphi 单元](https://bitbucket.org/ZeljkoMarjanovic/delphi-mft-journal-helpers/src/a2040df226cb/Units/uMFT.pas)来使用这个[EnumMFTEntries() 函数](https://bitbucket.org/ZeljkoMarjanovic/delphi-mft-journal-helpers/src/a2040df226cb/Units/uMFT.pas#cl-297)实现**疯狂的 FAST 驱动器扫描**，但是我在执行以下任务时遇到了麻烦：

## 任务#1：查询`change journal`以获取新修改的文​​件（更改、重命名、删除等...）

在阅读了该函数以及 [StCroixSkipper 的 USN Journal Explorer](http://www.dreamincode.net/forums/blog/1017/entry-2587-stcroixskippers-usn-journal-explorer-v13/)（在 C# 中）之后，我调整了这个*损坏的例程。*`EnumMFTEntries()`

由于某种原因，报告**的文件名总是#0**

```
function EnumUsnEntries(ARootHandle : Cardinal; AMFTEnumBuff : Pointer; EnumCallBack : TMFTEnumCallback) : Boolean;
var
   P         : Pointer;
   UsnEnum   : Pointer;
   BytesRet  : Cardinal;

   PUSN           : PUSNRecord;
   ReadUSN        : TReadUSNJournalData;
   PReadUSN       : PReadUSNJournalData;
   UsnJournalData : TUSNJournalData;
   BUF_SIZE       : Integer;
begin
     Result            := False;
     if (ARootHandle = INVALID_HANDLE_VALUE) OR (AMFTEnumBuff = nil) then
        Exit;

     QueryUSNJournal(ARootHandle, UsnJournalData);
     with ReadUSN do
     begin
          StartUsn          := UsnJournalData.NextUsn;
          ReasonMask        := USN_REASON_DATA_OVERWRITE OR USN_REASON_DATA_EXTEND OR USN_REASON_NAMED_DATA_OVERWRITE OR USN_REASON_NAMED_DATA_TRUNCATION OR
                               USN_REASON_FILE_CREATE OR USN_REASON_FILE_DELETE OR USN_REASON_EA_CHANGE OR USN_REASON_SECURITY_CHANGE OR
                               USN_REASON_RENAME_OLD_NAME OR USN_REASON_RENAME_NEW_NAME OR USN_REASON_INDEXABLE_CHANGE OR USN_REASON_BASIC_INFO_CHANGE OR
                               USN_REASON_HARD_LINK_CHANGE OR USN_REASON_COMPRESSION_CHANGE OR USN_REASON_ENCRYPTION_CHANGE OR
                               USN_REASON_OBJECT_ID_CHANGE OR USN_REASON_REPARSE_POINT_CHANGE OR USN_REASON_STREAM_CHANGE OR USN_REASON_CLOSE;
          ReturnOnlyOnClose := 0;
          Timeout           := 0;
          BytesToWaitFor    := 0;
          UsnJournalID      := UsnJournalData.UsnJournalID;
     end;    // with

     BUF_SIZE          := SizeOf(ReadUSN);
     GetMem(P, BUF_SIZE);
     try
        ZeroMemory(P, BUF_SIZE);
        while DeviceIoControl(ARootHandle, FSCTL_READ_USN_JOURNAL, Addr(ReadUSN){UsnEnum}, SizeOf(ReadUSN{TReadUSNJournalData}), P, BUF_SIZE, BytesRet, nil) do
        begin
             PUSN      := PUSNRecord{PReadUSNJournalData}(Integer(P) + SizeOf(Int64));
             while (BytesRet > 0{60}) do
             begin
                  if Not EnumCallBack(PUSN, nil{Extra}) then
                     Exit;

                  if PUSN.RecordLength > 0 then
                     Dec(BytesRet, PUSN.RecordLength)
                  else
                      Break;
                  PUSN := PUSNRecord(Cardinal(PUSN) + PUSN.RecordLength);
             end;    // while
             CopyMemory(UsnEnum{MFTEnum}, P, SizeOf(Int64));
        end;    // while

        Result         := True;
     finally
            FreeMem(P);
     end;    // try/finally
end; 
```

* * *

## 任务 #2：限制扫描到某个文件夹？

如果我没记错的话，似乎可以通过在[EnumMFTEntries()函数中定义来](https://bitbucket.org/ZeljkoMarjanovic/delphi-mft-journal-helpers/src/a2040df226cb/Units/uMFT.pas#cl-297)*部分地*做到这一点，但目前尚不清楚如何做到这一点。`StartUsn`

## 任务#3：获取文件名的完整路径？

例如，`EnumMFTEntries()`总是只返回名称及其父文件夹参考号，不清楚获取完整路径的最快方法是什么。

* * *

我希望我没有问太多，这些任务真的是息息相关的，我**真的**希望社区在这里帮助Delphi开发人员轻松实现疯狂的快速文件夹扫描。尽管它很有用，但变更日志/MFT 是最有趣但被遗忘的技术之一。这必须改变！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-30T06:00:19.730

在任务 #2 上：您可以通过首先发出 FSCTL_READ_FILE_USN_DATA 来将 usn 数据搜索限制到特定文件/目录以获取最后更改的 usn 编号，然后 FSTCL_READ_USN_JOURNAL 将 StartUsn 成员分配给该 usn 编号以获取有关更改的有效信息（timrstamp，原因）。但是，这种方式只能获得最后的变化。要获得所有更改，我认为只能通过特定文件参考号过滤读取的 usn 日志数据。MSDN 库中的更多信息。

# ruby-on-rails - Rails：使用 where 子句查找深度嵌套的关联

> ID：14527051
> 
> 赞同：25
> 
> 时间：2013-01-25T17:21:09.903
> 
> 标签：ruby-on-rails, rails-activerecord

我有两个模型加入了 has_many :through 关系：

```
class Publication < ActiveRecord::Base
  has_many :publication_contributors
  has_many :contributors, :through => :publication_contributors
end

class Contributor < ActiveRecord::Base
  has_many :publication_contributors
  has_many :publications, :through => :publication_contributors
end

class PublicationContributor < ActiveRecord::Base
  belongs_to :publication
  belongs_to :contributor
end 
```

（关于我的 PublicationContributor 模型的一些不寻常且重要的地方在于，它不仅有一对数据库 id，它还有一个名为contributor_type 的字符串属性。该字符串可以包含诸如“作者”或“翻译者”或“发布者”之类的角色。我不相信这是这里的问题，但解决方案仍然必须解决它。）

我想找到一个具有特定贡献者的出版物，如下所示：

```
Publication
  .joins(:publication_contributors =>  :contributor)
  .where(:publication_contributors => 
            {:contributor_type => "Author", 
             :contributor => {:name => params[:authors]}}) 
```

一切正常，直到我到达嵌套的 :contributor，此时 SQL 溅射：

```
Mysql2::Error: Unknown column 'publication_contributors.contributor' in 'where clause' 
```

它不是在寻找publication_contributors.contributor_id，而是在寻找不存在的publication_contributors.contributor。我在我的代码中做错了吗？我找不到像这样具有深度嵌套关联的 where 子句的任何其他示例。也许这甚至不可能？

更新：

生成的 SQL

```
←[1m←[35mPublication Load (0.0ms)←[0m  SELECT `publications`.* FROM `publicati
ons` INNER JOIN `publication_contributors` ON `publication_contributors`.`public
ation_id` = `publications`.`id` INNER JOIN `contributors` ON `contributors`.`id`
 = `publication_contributors`.`contributor_id` WHERE `publication_contributors`.
`contributor_type` = 'Author' AND `publication_contributors`.`contributor` = '--
-\n:name:\n- Marilynne Robinson\n' LIMIT 1 
```

另外，我的 Publications 模型中有这个关联：

```
has_many :authors, :through => :publication_contributors, :source => :contributor, :conditions => {:publication_contributors => {:contributor_type => "Author"}} 
```

我在想我可以这样做：

```
Publication.joins(:authors).where(:authors => {:name => params[:authors]}) 
```

但这会引发错误：

```
Mysql2::Error: Unknown column 'authors.name' in 'where clause' 
```

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2013-01-25T18:50:42.123

尝试更改您的 where 子句：

```
Publication
  .joins( :publication_contributors => :contributor )
  .where( :publication_contributors => {:contributor_type => "Author"}, 
          :contributors             => {:name => params[:authors]} ) 
```

ActiveRecord api 在这里并不是非常一致： 的参数`where`与`joins`. 这是因为 for 的参数`joins`不*反映*底层 SQL，而`where`do 的参数。

`where`接受一个散列，其键是**表名**，值是散列（它们本身具有列名作为键）。它只是在针对两个表中具有相同名称的列时防止歧义。

这也解释了为什么会出现第二个问题：关系`authors`不存在。

# background-image - 如何在博客上添加背景广告

> ID：14527054
> 
> 赞同：-1
> 
> 时间：2013-01-25T17:21:18.430
> 
> 标签：background-image, blogger

做这样的事情可行吗？我想在我的博主博客中添加一个类似[http://goo.gl/xSmwq的背景可点击图片（广告）？](http://goo.gl/xSmwq)

你能帮我提供所需的代码吗？

先感谢您

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T17:44:56.343

好吧，如果您看到没有背景可点击图像，则有一个位置固定的“透明图像”：

![在此处输入图像描述](../Images/f2f1e3ffab419ed37cc375f9959cc581.png)

尝试放入您的级联样式表（CSS）：

```
body {
background-image: url("http://banners.dol.gr/opap_skin_kathigitis_tovima.jpg");
background-repeat: no-repeat;
background-position: center 40PX;
background-attachment: fixed;
background-color: #000000 !important;
}
.background {position:absolute;top:0;left:0;z-index:999;visibility:hidden;overflow:hidden;width:100%;height:880px;}
.background .first-banner {position:fixed;left:50%;visibility:visible;margin-left:-800px;} 
```

然后在您的html代码中：

```
<div class="background">
  <div class="first-banner">
    <a target="_blank" href="http://www.google.com">
      <img width="300" height="880" src="http://static.adman.gr/void.gif" border="0">
    </a>
  </div>
</div> 
```

希望能帮助到你！:)

# python - 到 MySQL 的 Scrapy 管道 - 找不到答案

> ID：14527056
> 
> 赞同：4
> 
> 时间：2013-01-25T17:21:19.973
> 
> 标签：python, scrapy

我环顾四周寻找答案，但找不到答案。正如我昨天提到的，我是scrapy和python的新手，所以答案可能就在那里，但我没有赶上。

我写了我的蜘蛛，它工作得很好。这是我的管道....

```
import sys
import MySQLdb
import hashlib
from scrapy.exceptions import DropItem
from scrapy.http import Request

class somepipeline(object):
    def __init__(self):
        self.conn = MySQLdb.connect(user='user', 'passwd', 'dbname', 'host', charset="utf8", use_unicode=True)
        self.cursor = self.conn.cursor()

    def process_item(self, item, spider):    
        try:
            self.cursor.execute("""INSERT INTO sometable (title, link, desc)  
                            VALUES (%s, %s)""", 
                           (item['title'].encode('utf-8'), 
                            item['link'].encode('utf-8'),
                            item['desc'].encode('utf-8'))

            self.conn.commit()
        except MySQLdb.Error, e:
            print "Error %d: %s" % (e.args[0], e.args[1])
        return item 
```

这是我的设置：

```
BOT_NAME = 'somebot'

SPIDER_MODULES = ['somespider.spiders']
NEWSPIDER_MODULE = 'somespider.spiders'
ITEM_PIPELINES = ['myproject.pipeline.somepipeline'] 
```

但是，当我运行它时，我得到一个：No module named pipeline 错误

找到了一个类似的答案，但它是针对图像类的，我只想要 HTML 数据。

我究竟做错了什么？我需要下载另一个模块吗？感谢帮助。如果我很近，请给我一个肘部。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-02-09T20:43:17.853

Scrapy 教程有一个错字：它必须是 'pipelineS'

```
ITEM_PIPELINES = ['myproject.pipelines.somepipeline'] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-27T03:22:23.550

没有“管道”文件。它应该是“管道”。所以你需要改变

```
ITEM_PIPELINES = ['myproject.pipeline.somepipeline'] 
```

至

```
ITEM_PIPELINES = ['myproject.pipelines.somepipeline'] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-28T01:41:24.540

正确的目录路径应该是这样的：

```
myproject/
     scrapy.cfg  
     myproject/
         __init__.py
         items.py
         pipeline.py
         settings.py
         spiders/
            spider.py 
```

另一方面，你能确认你的蜘蛛工作正常吗？例如，如果您要注释掉 ITEM_PIPELINES 设置，您的蜘蛛程序是否工作并产生预期的输出？

# .htaccess - 使用 cPanel 和插件域时 htaccess 如何工作

> ID：14527057
> 
> 赞同：4
> 
> 时间：2013-01-25T17:21:20.520
> 
> 标签：.htaccess, cpanel

当您拥有 cPanel 托管并使用插件域时，这些域“位于”文件夹内的`public_html`文件夹中（默认情况下），例如：

```
A) public_html/.htaccess
B) public_html/addondomain_1/.htaccess
C) public_html/addondomain_2/.htaccess 
```

我的理解是，我放入 htaccess 文件 A) 中的任何内容都适用于其中的所有内容，其中应包括 B) 和 C)。

因此，作为示例，将被阻止的 IP 地址添加到 A) 也会在 B) 和 C) 上被阻止。

但我查询这个纯粹是因为 B) 和 C) 在浏览器中查看时是不同的域。我已经尝试过对其进行测试，但运气不佳，并且浏览文档页面并没有帮助我得出结论。

如果我在 A) 中阻止某人的 IP，它会阻止他们访问 B) 和 C) 网站吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T17:24:39.367

[Apache 文档](http://httpd.apache.org/docs/2.2/howto/htaccess.html#how)非常清楚：

> 在 .htaccess 文件中找到的配置指令应用于找到 .htaccess 文件的目录及其所有子目录。然而，重要的是还要记住在更高的目录中可能有 .htaccess 文件。指令按照它们被发现的顺序应用。因此，特定目录中的 .htaccess 文件可能会覆盖在目录树中较高位置的 .htaccess 文件中找到的指令。反过来，那些可能已经覆盖了更高的指令，或者在主服务器配置文件本身中。

这是 Apache 的特性，而不是 cPanel 的特性。是否使用 cPanel 并不重要——Apache 仍然会遍历父目录并应用它们的`.htaccess`指令。

# scheme - 关于球拍中的符号

> ID：14527059
> 
> 赞同：1
> 
> 时间：2013-01-25T17:21:26.217
> 
> 标签：scheme, racket

```
(define-struct student (first last major))

(define student1 (make-student "John" "Smith" 'CS))
(define student2 (make-student"Jane" "Jones" 'Math))
(define student3 (make-student "Jim" "Black" 'CS))

#;(define (same-major? s1 s2)
  (symbol=? (student-major s1)
            (student-major s2))) 
```

当我输入这些时，我得到了我期望的答案。

```
;;(same-major? student1 student2) -> FALSE
;;(same-mejor? student1 student3) -> True 
```

但是当我想知道学生是否有相同的名字时，它告诉我他们期望一个符号作为第一个参数，但给定的是 John。

```
(define (same-first? s1 s2)
  (symbol=? (student-first s1)
            (student-first s2))) 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-25T17:23:53.530

`'CS`并且`'Math`是符号，“John”、“Jane”和“Jim”不是（它们是字符串）。正如错误消息告诉您的那样，参数`symbol=?`需要是符号。

要比较字符串是否相等，您可以使用`string=?`or just `equal?`（适用于字符串、符号和几乎所有其他内容）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-25T17:25:29.457

改变这个：

```
(symbol=? (student-major s1)
          (student-major s2))) 
```

对此：

```
(string=? (student-major s1)
          (student-major s2))) 
```

请注意，您要比较的是*字符串*而不是*符号*，因此必须使用适当的相等过程。

# user-interface - 面包屑面板

> ID：14527062
> 
> 赞同：0
> 
> 时间：2013-01-25T17:21:41.510
> 
> 标签：user-interface, wizard, breadcrumbs, panels

我最近使用了一个 Web 应用程序，它采用了我想使用的用户界面模式。我不确定是否有帮助实施的标准或工具集。这是一个类似于向导的多路径可视化界面。一系列“面包屑面板”按顺序打开并允许用户以非线性方式导航交易。

它类似于：

[http://i50.tinypic.com/vybdqg.jpg](http://i50.tinypic.com/vybdqg.jpg)

有谁知道这叫什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-08T11:44:55.860

我想你的意思是这样的：

JBREADCRUMB - 自动折叠面包屑

[http://www.comparenetworks.com/developers/jqueryplugins/jbreadcrumb.html](http://www.comparenetworks.com/developers/jqueryplugins/jbreadcrumb.html)

但是你需要考虑这将对移动设备上的用户产生什么影响，以及谷歌将如何看待导航。确保你有谷歌可以抓取的替代方案，而不仅仅是基于 javascript。

# ios - 我可以捕获异常并重新启动我的应用程序吗？

> ID：14527071
> 
> 赞同：0
> 
> 时间：2013-01-25T17:22:09.450
> 
> 标签：ios, objective-c, cocoa-touch, exception

当我的应用程序的方法内引发异常时，我希望应用程序重新启动。我怎样才能获得这个功能？我可以为此使用 try-catch 块吗？如何？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-25T18:35:35.710

您无法重新启动应用程序。

您最好的选择可能是重置应用程序的*状态*。例如，您的应用程序委托可以有一个方法来设置和拆除视图控制器等，然后另一种方法来重新设置它们。

另请注意，如果您试图以某种方式强制退出，Apple 可能会拒绝您的应用程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T17:29:50.150

您无法重新启动您的应用程序。

苹果不允许你这样做。

尝试抓住你的错误抛出它，但重新启动否。

# java - 如何测试从文件和路径读取（使用junit）？

> ID：14527074
> 
> 赞同：2
> 
> 时间：2013-01-25T17:22:17.197
> 
> 标签：java, testing, file-io, junit, path

我需要使用 JUnit 框架执行测试覆盖。

我阅读了[JUnit - 教程](http://www.vogella.com/articles/JUnit/article.html)，但我无法将这些知识与我的示例绑定。

我了解如何单独测试从文件中读取的方法，但不知道如何通过测试某些路径和 askUserPathAndWord 来完全做到这一点。我怎样才能对此进行良好的测试？

```
package task;
import java.io.*;

class SearchPhrase {
    public void walk(String path, String whatFind) throws IOException {
        File root = new File(path);
        File[] list = root.listFiles();
        for (File titleName : list) {
            if (titleName.isDirectory()) {
                walk(titleName.getAbsolutePath(), whatFind);
            } else {
                if (read(titleName.getAbsolutePath()).contains(whatFind)) {
                    System.out.println("File:" + titleName.getAbsolutePath());
                }
            }
        }
    }

    // Read file as one line
    public static String read(String fileName) {
        StringBuilder strBuider = new StringBuilder();
        try {
            BufferedReader in = new BufferedReader(new FileReader(new File(
                    fileName)));
            String strInput;
            while ((strInput = in.readLine()) != null) {
                strBuider.append(strInput);
                strBuider.append("\n");
            }

            in.close();
        } catch (IOException e) {
            e.printStackTrace();
        }

        return strBuider.toString();
    }

    public void askUserPathAndWord() {
        BufferedReader bufferedReader = new BufferedReader(
                new InputStreamReader(System.in));
        String path, whatFind;
        try {
            System.out.println("Please, enter a Path and Word"
                    + "(which you want to find):");
            System.out.println("Please enter a Path:");
            path = bufferedReader.readLine();
            System.out.println("Please enter a Word:");
            whatFind = bufferedReader.readLine();

            if (path != null && whatFind != null) {
                walk(path, whatFind);
                System.out.println("Thank you!");
            } else {
                System.out.println("You did not enter anything");
            }
        } catch (IOException | RuntimeException e) {
            System.out.println("Wrong input!");
            e.printStackTrace();
        }
    }

    public static void main(String[] args) {
            SearchPhrase example = new SearchPhrase();
            example.askUserPathAndWord();
    }
} 
```

接下来的*问题：*

*   我们如何才能完全测试集成依赖并检查路径？
*   哪一点应该有好的，可以理解的junit测试？
*   在这种情况下我们需要使用失败测试吗？
*   我们可以覆盖哪个最大百分比计划？
*   我们应该（通常）测试私有方法和受保护方法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-25T17:48:11.250

我建议一开始就保持简单。在我看来，从根本上讲，编写单元测试的目标实际上只是为了确保您的代码能够按照预期执行。

我认为你的`read`方法是一个很好的起点。看起来您的`read`方法的目的是将文件名作为输入并返回包含文件内容的字符串。

因此，要编写一个证明它有效的测试，首先在某处创建一个名为“testFile”的文件，其中包含一些虚拟文本，例如“my test”。

然后，编写一个单元测试，如：

```
@Test
public void read() {

    String testFileName = "/path/to/test/file/testFile";
    String expected = "my test";
    SearchPhrase searchPhrase = new SearchPhrase();
    String result = searchPhrase.read(testFileName);
    assertEquals(expected, result);

} 
```

这只是为了让你开始。一旦掌握了窍门，就可以进行改进，例如更新测试文件的路径，使其不会被硬编码。理想情况下，测试应该能够在任何地方运行。

作为一个额外的好处，编写单元测试让你考虑以一种更可重用和更容易理解的方式组织你的包、类和方法（除了其他好处之外）。

例如，您的`walk`方法很难测试，因为它是当前编写的。所以试着想想如何让它更容易测试。也许它可以返回代表搜索结果的字符串列表？如果您进行更改并在包含 testFile 的目录中搜索字符串“test”，您知道您应该在列表中获得一个结果，因此请使用以下内容进行测试：

```
assertNotNull(searchPhrase.walk());
assertEquals(1, searchPhrase.walk().size()); 
```

由于您刚刚开始，我建议不要担心您的测试涵盖的程序百分比。

在编写测试时，它可以帮助我思考如果其他人使用我的代码，他们会如何期望它的行为？然后我尝试编写测试来展示预期的行为。

希望有帮助！

# checkstyle - filetab字符检查不适用于checkstyle

> ID：14527077
> 
> 赞同：6
> 
> 时间：2013-01-25T17:22:32.190
> 
> 标签：checkstyle

支票似乎对`FileTabCharacter`我不起作用。下面是我的配置：

```
<module name="Checker">
..
..
<!-- No TAB characters in the source code -->
<module name="FileTabCharacter">
    <property name="eachLine" value="true" />
    <property name="fileExtensions" value="java,xml" />
</module>
..
..
<module name="TreeWalker">
..
..
</module>
</module> 
```

我有 XML 文件 -`pom.xml`和 checkstyle config xml - 其中包含选项卡，但没有一个被标记为违规。

一些附加信息 - 我的插件配置如下所示：

```
<plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-checkstyle-plugin</artifactId>
    <version>2.9.1</version>
    <executions>
        <execution>
            <phase>verify</phase>
            <goals>
                <goal>check</goal>
            </goals>
        </execution>
    </executions>
    <configuration>
        <configLocation>checkstyle/kepler-checkstyle-config.xml</configLocation>
        <suppressionsLocation>${project.parent.basedir}${file.separator}checkstyle/kepler-checkstyle-suppressions.xml</suppressionsLocation>
    </configuration>
</plugin> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2020-06-15T21:26:59.403

我也遇到了这个问题；问题原来是默认配置只查看源代码目录，而不是顶级目录。我用下面的配置解决了这个问题，它将 Java 代码限制在源代码目录中，但在除目标目录之外的所有地方查找 XML 文件。

```
<configuration>
  <sourceDirectories>${project.basedir}</sourceDirectories>
  <includes>src/main/**/*.java,**/*.xml</includes>
  <excludes>**/target/**</excludes>
</configuration> 
```

# asp.net - 实体框架：EF4 – 从数据库更新模型不起作用

> ID：14527078
> 
> 赞同：2
> 
> 时间：2013-01-25T17:22:33.430
> 
> 标签：asp.net, visual-studio-2010, entity-framework

我正在使用带有 EF 4.0 的 VS 2010，我遇到了一个问题，我在无争议的论坛和网站上进行了搜索，但找不到我的问题的答案。

我有一个数据库，用于我在 C# 和 EF 中的最终项目。当我试图升级我的数据模型时（因为我在我的数据库中进行了更改，即添加了更多的功能，比如表格），我创建的表格出现在“添加”选项卡中，但最终没有出现模型。我试图删除模型并重新创建它，但问题仍然存在。

我阅读了很多关于这个问题的回复，但没有一个能解决我的问题。我被困住了，如果不解决这个问题，我就无法继续我的项目。

提前谢谢你，里卡多·戈麦斯葡萄牙

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T23:02:11.907

我之前在尝试添加一个包含所有可为空字段且没有键的表时已经看到了这一点。

# sql - 在多对多关系中选择匹配子集

> ID：14527080
> 
> 赞同：2
> 
> 时间：2013-01-25T17:22:42.690
> 
> 标签：sql, postgresql

假设我在用户和项目之间存在多对多关系：一个用户可能属于多个项目，一个项目可能有多个用户。这种关系编码在表中`user_projects`：

```
create table user_projects
(
proj_id int references projs(id) not null,
user_id int references users(id) not null,
primary key (proj_id, user_id)
); 
```

这是我的问题：给定一组用户（user1，user2，...），我想选择给定用户集是其所有用户子集的所有项目。

例如，如果我在下面插入数据，然后询问用户 1 和 2 的所有项目，那么查询应该只返回项目 1。

```
insert into user_projects values (1, 1);
insert into user_projects values (1, 2);
insert into user_projects values (1, 3);
insert into user_projects values (2, 1);
insert into user_projects values (2, 3); 
```

（如果最好的解决方案碰巧是非标准的，我正在使用 PostgreSQL。）

**编辑：**为澄清起见，用户集应被解释为对要返回的项目列表的约束。集合 {u1, u2} 意味着项目列表应该只包括那些至少有用户 u1 和 u2 的项目；集合 {u1} 表示应返回至少具有用户 u1 的所有项目，并且作为限制情况，空集表示应返回**所有项目。**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-25T17:29:42.410

```
Select project_ID 
from user_projects
where user_ID in (1,2)
group by project_ID
Having count(*) = 2 
```

您知道您有 2 个用户，您知道他们将是唯一的（主键），因此您知道如果有 2 条记录，对于同一个项目，那么它就是您想要的。

您的问题表明您已经发送了 GIVEN 用户，因此您知道哪些用户以及有多少用户。上面的 SQL 可以更新以接受这些已知的参数，因此保持动态，不仅限于 2 个用户。

```
where user_ID in (userlist)
having count(*) = (cntuserList) 
```

------------当用户集为空时处理情况-----

```
Select P.project_ID 
from Projects P
LEFT JOIN user_projects UP
where (UP.user_ID in (1,2) OR UP.USER_ID is null)
group by project_ID
Having count(*) = 2 
```

这就是它的作用。它返回所有项目，如果有用户附属于该项目，它会识别它们。如果您设置包含用户，则返回的项目列表由该集合过滤，确保整个集合都在项目中，通过有子句。

如果集合为空，则左连接以及 userID 为 null 语句将保留没有列出用户的项目，无论集合是否为空。have 子句将进一步减少集合到您在集合中定义的用户数，或 0 表示返回所有未分配用户的项目。

我们还没有讨论的另一个极端情况是，如果项目包含的用户多于您在集合中定义的用户数，会发生什么。目前该项目将被退回；但我不肯定这就是你想要的。

顺便说一句，感谢您让我思考。我不再深入研究代码了。这就是为什么我时不时来这里看看我能不能帮忙！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-26T13:30:06.390

这是另一种解决方案，看起来更简单：

```
select  proj_id
from    user_projects
group by proj_id
having  array_agg ( user_id ) @> array [1, 2] 
```

* * *

正如@Thilo 注意到的那样，可能存在没有分配用户的项目。因此，如果用户的输入集为空，则查询应返回 projs 表中的所有项目。这是改进的解决方案：

```
select      p.proj_id
from        projs           p
left join   user_projects   up
    on      p.proj_id = up.proj_id
group by    p.proj_id
having      array_agg ( up.user_id ) @> array (
    select  u
    from    generate_series ( 1, 2 )
    where   false   /* an empty set */
    )
; 
```

* * *

我已经测试了一段时间的额定解决方案的性能。至于查询小型数据集（user_projects 中的 1 670 行）时没有显着差异，另一种情况是表 user_projects 有 1 667 000 行
（列 proj_id 和 user_id 已填充从 1 到 1 000 000 的随机值；一个项目中平均有 2 个用户，最多 11 个用户）：

*   array_agg 方法（从 projs 和 user_projects 读取）通常需要 24 秒（有时更少）才能给出结果。
*   Wildplasser 的方法：总是 31 秒。
*   Thilo 的查询时间太长，我决定取消它。
*   xQbert 的“计数”方法强烈依赖于索引，速度要快很多倍——几乎总是**只需要 0.5 秒**。但是，为了处理空的用户输入集，它需要被重写。

[测试是在不是最新的 PC 上的 Postgresql 9.2.2 上运行的，尽管在较新的 PC 上的 Postgresql 8.4 上的比例相似]。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-26T16:01:06.893

这种关系划分通常可以表示为`SELECT FROM a WHERE NOT EXISTS ( b WHERE NOT EXISTS (c))`

```
WITH users AS (
        SELECT generate_series (1,2)::integer AS user_id
        )
SELECT DISTINCT up.proj_id
FROM user_projects up
   -- all the projects, but
   -- NOT the ones that miss (at least) one of the users
WHERE NOT EXISTS (
        SELECT *
        FROM users us
          -- The projects that miss (at least) one of the users
        WHERE NOT EXISTS (
                SELECT *
                FROM user_projects nx
                WHERE nx.user_id = us.user_id AND nx.proj_id = up.proj_id
                )
        )
        ; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-25T17:39:36.643

一个更通用的答案，允许您使用相同数量的代码拥有任意用户集。首先，我们使用用户集创建一个表：

```
CREATE TEMP TABLE user_set ( 
  u int
);
INSERT INTO user_set VALUES (1), (2); 
```

你可以用你可以放在`FROM`下面子句中的任何函数来替换这个表。

现在选择实际项目：

```
SELECT DISTINCT 
    proj_id 
FROM 
    user_projects 
WHERE 
    true = ALL (
        -- Select all required users and test if they are a member of the project
        SELECT u IN (
            -- Select all user ids of this project
            SELECT 
                user_id 
            FROM 
                user_projects AS up 
            WHERE 
                up.proj_id = user_projects.proj_id
        )
        FROM 
            user_set
   ) 
```

还有[小提琴](http://sqlfiddle.com/#!12/afb0b/6)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-25T17:29:47.210

像这样的东西应该工作：

```
SELECT u.proj_id
FROM user_projects u
   JOIN user_projects u2 on u.proj_id = u2.proj_id
WHERE u.user_id = 1 and u2.user_id = 2 
```

这是[小提琴](http://sqlfiddle.com/#!1/754ce/6)。

祝你好运。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-25T17:35:36.690

您可以使用多个 JOIN 块，例如：

```
 SELECT Up1.project_id
   FROM user_projects as up1
   JOIN user_projects as up2 on up1.project_id=up2.project_id
  WHERE up1.user_id=1
    AND up2.user_id=2; 
```

您应该为所需集合中的每个用户创建一个新的 JOIN 块。

# azure - Azure - 系统启动任务失败，退出代码为 -532462766

> ID：14527082
> 
> 赞同：5
> 
> 时间：2013-01-25T17:22:48.057
> 
> 标签：azure, azure-web-roles

我最近将 Azure 缓存添加到我的 Web 角色中，并在重新部署实例时以以下状态挂起约 30 分钟：忙碌（等待角色启动...系统启动任务正在运行。[2013-01-25T17:12: 53Z])

然后在实例重试启动之前获取*System startup task failed with exit code -532462766 。*

我没有在这个错误代码上找到任何东西，并且迫切需要更多信息。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-04T14:01:08.360

问题已解决。我需要将我的 Web 角色存储凭据设置为使用真实存储帐户而不是开发存储。我还选中了“配置”选项卡上的复选框，以便在发布时使用 Azure 更新诊断和缓存的连接字符串。一旦这个问题得到纠正，重新部署就成功了。

# selenium - 如何处理从另一个弹出窗口触发的一个弹出窗口？

> ID：14527089
> 
> 赞同：2
> 
> 时间：2013-01-25T17:23:11.283
> 
> 标签：selenium, webdriver, selenium-webdriver

我正在使用 Firefox 8.0.1 测试 Selenium 2.29（之前在 2.17 上，由于模态对话框问题让我在 FF 11 作为最大版本）。我有一个图标，点击它会触发一些 javascript 代码。这个 JS 代码触发了一个弹出窗口，我可以使用它来处理：

```
driver.findElement(By.xpath(""xpath_to_icon")).click; 
```

`log("Alert text = " + getAlertText()); //log just outputs to the console`

`acceptAlert;`

上面的代码毫无问题地处理了第一个弹出窗口的触发和接受。我遇到的问题是在第一个弹出窗口上单击“确定”（我必须为我的测试做）触发第二个弹出窗口。到目前为止，我还没有成功处理第二个弹出窗口。我尝试了以下代码的变体，但没有成功：

```
acceptAlert;

driver.switchTo().alert().accept();

selenium.keyDownNative("32");
selenium.keyUpNative("32");

 Thread t = new Thread(new Runnable() {
     public void run() {
     // driver.findElement("").click();
     log("Alert2 text = " + getAlertText());
     acceptAlert();
     }
     });
     t.start(); 
```

每次抛出此错误时：org.openqa.selenium.UnhandledAlertException: Modal dialog present。以前我会手动单击第二个弹出窗口上的“确定”按钮，但在 2.29 中不再可能了。

目前我只有一个有这个特定问题的测试用例，但我想看看是否有其他人遇到过这个问题并找到了一种处理它的好方法。谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T14:20:58.477

Qrazi 是对的，如果有框架，您必须对目标框架进行编码更改，并且新的弹出窗口需要将焦点切换到它们。`selectFrame`，`selectPopup`并且`selectWindow`是一个很好的起点。

切换焦点后，您可以自动单击“确定”按钮。最后不要忘记切换焦点！

对于框架，以下代码将框架焦点放在页面顶部。一旦你在一个框架内，你就不能再看到父框架了。

```
Driver.getDriver().switchTo().defaultContent(); 
```

# web - 什么是用于限制用户访问某些页面的简单 CMS？

> ID：14527090
> 
> 赞同：0
> 
> 时间：2013-01-25T17:23:13.570
> 
> 标签：web, content-management-system

嗨，
什么是用于限制某些页面的用户的简单 CMS？CMS 功能很重要，但我的兴趣是限制用户访问某些页面的内置解决方案（基于客户 ID）。这是我的目标。

一，限制某些用户的页面。二，用户拥有多个ID和权限。管理页面和用户访问的简单解决方案是我寻找新 CMS 系统的原因。我看过 Wordpress、WildApricot、Magento 和 SurrealCMS。你会推荐什么？

我需要可以与 ftp 服务器一起使用的简单前端解决方案。“如果我必须知道服务器的类型，那并不容易。” 我只想说明我在考虑什么。我期待你的回复。
谢谢，
解散

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T17:28:51.690

[Mezzanine](http://mezzanine.jupo.org/)可以做到这一点，任何构建在 django 上的东西都可以，因为它具有内置的[身份验证和权限](https://docs.djangoproject.com/en/dev/topics/auth/default/#topic-authorization)作为框架的一流部分。

我也听说过关于[Django CMS](https://www.django-cms.org/en/)的好消息，虽然我没用过。

# asp.net-mvc - 为 mvc4 视图引擎添加文件夹以在其中查找视图

> ID：14527092
> 
> 赞同：2
> 
> 时间：2013-01-25T17:23:25.527
> 
> 标签：asp.net-mvc, asp.net-mvc-4, asp.net-mvc-views

我正在使用 MVC4 并希望为视图引擎设置自定义位置以在其中查找视图。目前它只会在它期望视图存在的文件夹之外的 Shared 文件夹中查找。

我想再添加 2 个文件夹位置以在其中查找视图。如何在 mvc4 中实现？我不想操纵它目前的工作方式，只需添加额外的文件夹供它查看。

注意：我已经使用基于请求设备呈现视图的显示模式 - 我不想通过我的更改来影响这一点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T17:44:06.110

使用此代码

```
 public class CustomViewEngine : WebFormViewEngine
    {
        public CustomViewEngine()
        {
            var viewLocations =  new[] {  
                "~/Views/{1}/{0}.aspx",  
                "~/Views/{1}/{0}.ascx",  
                "~/Views/Shared/{0}.aspx",  
                "~/Views/Shared/{0}.ascx",  
                "~/AnotherPath/Views/{0}.ascx"
                // etc
            };

            this.PartialViewLocationFormats = viewLocations;
            this.ViewLocationFormats = viewLocations;
        }
    } 
```

# ios - 子类化 UIButton

> ID：14527094
> 
> 赞同：2
> 
> 时间：2013-01-25T17:23:29.410
> 
> 标签：ios, uiview, uibutton, subclass, uistoryboard

我想知道您是否认为在我的情况下子类化 UIButton 是一个好主意，如果是这样，那么究竟该如何去做呢？

所以情况是我的项目中有三个自定义按钮，如果不是我的项目中的所有视图控制器，我需要这些按钮。我目前采用的方法是在所有控制器中使用情节提要构建它们，然后根据需要添加功能。但是，我发现这会导致一种痛苦的情况，即使我想做某事，比如只是改变高度，我也需要做 8 次。所以我的想法是，拥有 3 个 uibutton 子类（具有不同状态下的图像、宽度、高度、位置等所需的特征），然后我可以将它们添加到不同的视图控制器中，然后在需要时从它们中执行 segue。如果我需要进行任何更改，我只需要在子类中进行一次，而不是在所有视图控制器中。

你们有什么感想？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-25T19:28:34.727

当然，我认为这会很好。在情节提要中添加自定义按钮，并将其类更改为按钮子类之一。在子类中，在 initWithCoder: 方法中进行自定义。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T19:00:30.240

您可以子类化 UIButton，但更好的解决方案是为 UIButton 创建一个类别

看教程：http: [//mobile.tutsplus.com/tutorials/iphone/custom-uibutton_iphone/](http://mobile.tutsplus.com/tutorials/iphone/custom-uibutton_iphone/)

# ios - 试图通过回调代码块关闭视图控制器，但出现异常

> ID：14527104
> 
> 赞同：0
> 
> 时间：2013-01-25T17:24:11.270
> 
> 标签：ios, objective-c

我试图从回调代码块中关闭呈现的视图控制器，如下所示。

```
MyBViewController *bvc = [[MyBViewController alloc] init];

bvc.callBack = ^(void){
   NSLog(@"Dismiss");
   [self dismissViewControllerAnimated:YES completion:Nil];
}; 
```

但它抛出 EXC_BAD_ACCESS 异常。在异常堆栈中，它似乎在 [MyBViewController 回调]；

我什至尝试调用另一个本地方法来关闭它会在 1.0 秒后触发。但是得到了同样的错误。

不能像这样通过回调块解除吗？请告诉我。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T17:28:20.567

我相信在释放 bvc 时可能会调用您的回调。

在没有看到其余代码的情况下，我只是假设在分配 bvc 的函数完成后调用回调函数，并且 ARC 可能会清理它。然后在释放的对象上触发回调，这就是您获得 EXC_BAD_ACCESS 的方式。您应该尝试使 bvc 成为属性或 iVar，这样它就不会过早死亡。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T17:33:06.600

正如 developer.apple.com 所说：“呈现视图控制器负责关闭它呈现的视图控制器。但是，如果您在呈现的视图控制器本身上调用此方法，它会自动将消息转发到呈现视图控制器。” 您可以在不使用任何块的情况下使用`[self dismissViewControllerAnimated:YES completion:Nil];`内部。`MyBViewController`希望这会帮助你。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-26T02:36:17.983

最后我想通了。我将 MyBViewController 上的回调属性设置为“分配”。我通过更改为“复制”来解决这个问题。然后它起作用了。

# c# - 动态标量变量

> ID：14527107
> 
> 赞同：1
> 
> 时间：2013-01-25T17:24:24.293
> 
> 标签：c#, sqlcommand

**背景：**

我有一系列 sql 查询要运行。根据查询，可能有要替换的标量变量。

**问题：**

`SqlCommand`即使查询中没有使用该变量，是否可以将标量变量添加到？

**例子：**

查询 #1 可以使用标量变量`@CashSub`，但查询 #2 不使用。我可以添加`@CashSub`为参数而不收到错误吗？

代码：

```
private void InsertStatements()
{
    foreach (string Query in Client.InsertStatements(CurrentCompany.Modules.ToArray()))
    {
        foreach (Branch CompBranch in CurrentCompany.Branches)
        {
            SqlCommand cmd = new SqlCommand(Query);
            cmd.Parameters.AddWithValue("DataDB", CompBranch.AppDB);
            cmd.Parameters.AddWithValue("OrigCpnyID", CompBranch.CompanyId);
            cmd.Parameters.AddWithValue("CashAcct", CompBranch.CashAccount);
            cmd.Parameters.AddWithValue("CashSub", CompBranch.CashSubAccount);

            Queries.RunQuery2(cmd, DestinationConnection.ConnectionString);
        }
    }       
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T17:42:26.203

您如何看待在每个 addparam 前面添加如下内容：

```
 if(Query.Contains("DataDB")) cmd.Parameters.AddWithValue("DataDB",...) 
```

也可以更干净地将参数存储在具有名称和值的字典中并循环。

编辑：

我是说：

```
 var paramRegistry = new Dictionary<string,object>{
      {"@DataDB", CompBranch.AppDB},
      {"@OrigCpnyID", CompBranch. CompanyId},
      {"@CashAcct", CompBranch. CashAccount},
      {"@CashSub", CompBranch. CashSubAccount},
      ...
  };

  foreach (string Query in Client.InsertStatements(CurrentCompany.Modules.ToArray()))
  {
    foreach (Branch CompBranch in CurrentCompany.Branches)
    {
        SqlCommand cmd = new SqlCommand(Query);

        foreach(var parName in paramRegistry.Keys){
            if (Query.Contains(parName)){
                 cmd.Parameters.AddWithValue(parName,paramRegistry[parName]);
            }
        }

        Queries.RunQuery2(cmd, DestinationConnection.ConnectionString);
    }
} 
```

# wpf - 将 WPF 简单条件从 Codebehind 移动到 XAML

> ID：14527113
> 
> 赞同：1
> 
> 时间：2013-01-25T17:24:47.283
> 
> 标签：wpf, mvvm

我有一个简单的条件，一个名为 tbDestinationTableName 的文本框，当从 ComboBox cbConnection 进行任何选择时，它应该只允许用户输入。我目前在 codeBehind 中执行此操作。如果可以在 XAML 中完成，有人可以更正以下代码吗？

```
<ComboBox x:Name="cbConnection"
                  ItemsSource="{Binding Source={StaticResource XmlConnectionList}, XPath=//ComboItem}"
                  DisplayMemberPath="Key"
                  SelectedValuePath="Value"
                  SelectedValue="{Binding Path=ConnectionString,ValidatesOnDataErrors=True,UpdateSourceTrigger=PropertyChanged}" 
                  Margin="{StaticResource ConsistentMargins}"
                  />

<kit:WatermarkTextBox Name="tbDestinationTableName" Margin="{StaticResource ConsistentMargins}"
                  TextChanged="tbDestinationTableName_TextChanged"
                  Text="{Binding Path=DestinationTableName, UpdateSourceTrigger=PropertyChanged,ValidatesOnDataErrors=True}"
                  Watermark="Destination Table"
                  IsEnabled="{Binding Path=ValidCreate}"/> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T17:28:09.057

我相信你可以用你的自定义文本框做这样的事情

```
<kit:WatermarkTextBox>
    <kit:WatermarkTextBox.Style>
        <Style TargetType="{x:Type kit:WatermarkTextBox}">
            <Style.Triggers>
                <DataTrigger Binding="{Binding ElementName=cbConnection, Path=SelectedIndex}" Value="-1">
                    <Setter Property="IsReadOnly" Value="True"/>
                </DataTrigger>
            </Style.Triggers>
        </Style>
    </kit:WatermarkTextBox.Style>
</kit:WatermarkTextBox> 
```

如果您想改用 IsEnabled，则**不应在 kit:WatermarkTextBox 的 xaml 中设置**它。

只需像这样使用另一个 Datatrigger：

```
 <kit:WatermarkTextBox Name="tbDestinationTableName" Margin="{StaticResource ConsistentMargins}"                     
                TextChanged="tbDestinationTableName_TextChanged"
                Text="{Binding Path=DestinationTableName, UpdateSourceTrigger=PropertyChanged,ValidatesOnDataErrors=True}"
              Watermark="Destination Table">
    <kit:WatermarkTextBox.Style>
        <Style TargetType="{x:Type kit:WatermarkTextBox}">
            <Style.Triggers>
                <DataTrigger Binding="{Binding ElementName=cbConnection, Path=SelectedIndex}" Value="-1">
                    <Setter Property="IsEnabled" Value="False"/>
                </DataTrigger>
                <DataTrigger Binding="{Binding Path=ValidCreate}" Value="False">
                    <Setter Property="IsEnabled" Value="False"/>
                </DataTrigger>
            </Style.Triggers>
        </Style>
    </kit:WatermarkTextBox.Style>
</kit:WatermarkTextBox> 
```

# javascript - DOMParser (javascript) 未识别文本节点

> ID：14527123
> 
> 赞同：0
> 
> 时间：2013-01-25T17:25:29.567
> 
> 标签：javascript, xml, dom

我遇到了一个非常不寻常的问题。如有必要，为了更好地了解全局，请参阅我的上一篇文章[Unable to retrieve a sub-NodeList from a NodeList in Javascript](https://stackoverflow.com/questions/14483426/unable-to-retrieve-a-sub-nodelist-from-a-nodelist-in-javascript/)。

好吧，现在可以了，但是当我尝试使用基本相同的方法解析不同的 XML 字符串时，生成的 NodeList 将不包含任何文本节点。而不是格式化的 XML，我将把我试图解析的字符串的一部分发布到 NodeList 中：

```
<clients><client><code>1111</code><crm>2222</crm><company><name>FOO</name><enterprise>BAR</enterprise><cnpj>XXX</cnpj></company></client></clients> 
```

请注意，这些不是节点的实际值，但父节点客户端遵循这个结构（虽然它被删节了）。

因此，出于测试目的，我最终求助于以下代码来查看列表是否正确创建：

```
function parseClientsXML(xmlString, filter){
    var parser = new DOMParser();
    var xmlDoc = parser.parseFromString(xmlString, "text/xml");
    var clients = xmlDoc.getElementsByTagName(filter);

    for(var i = 0; i < clients.length; i++){
        var client = clients[i].childNodes;
        for (var j = 0; j < client.length; j++){
            var node = client[j];
            $('#div_clients').append("Node index: " + i + " - Type: " + node.nodeType + " - Name: " + node.nodeName + "<br>");
        }
    } 
```

调用函数：

```
parseXML(theString, "clients"); 
```

我期望的结果是这样的：

```
Node index: 0 - Type: 1 - Name: client
Node index: 1 - Type: 1 - Name: code
Node index: 2 - Type: 3 - Name: #text
Node index: 3 - Type: 1 - Name: crm
Node index: 4 - Type: 3 - Name: #text 
```

等等。使用从我的另一篇文章中的 XML 解析的字符串作为“theString”，它可以正常工作。但是这篇文章中字符串的输出是这样的：

```
Node index: 0 - Type: 1 - Name: client
Node index: 1 - Type: 1 - Name: code
Node index: 2 - Type: 1 - Name: crm
Node index: 3 - Type: 1 - Name: company
Node index: 4 - Type: 1 - Name: name
... 
```

我整天都在研究这个问题，但找不到解决方案。输入字符串与我在上面发布的完全一样（嗯，不完全是，但很接近）。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-26T17:27:47.000

按照承诺解决您的问题。

```
function parseClientsXML(xmlString, filter) {
    var parser = new DOMParser();
    var xmlDoc = parser.parseFromString(xmlString, "text/xml");

    (function output(node, filter) {
        var child;
        var children = node.childNodes.length;

        if (filter === "") {
            $('#div_clients').append(node.nodeType + " : " + node.nodeName + "<br>");
        } else {
            filter = node.nodeName === filter ? "" : filter;
        }

        for (child = 0; child < children; child += 1) {
            output(node.childNodes[child], filter);
        }
    }(xmlDoc, filter));
} 
```

# android - 为什么我的应用程序在 Facebook 注销时崩溃？使用脸书 SDK

> ID：14527125
> 
> 赞同：-2
> 
> 时间：2013-01-25T17:25:30.900
> 
> 标签：android, facebook, login, sdk

当我单击登录按钮时，它会将我登录到 facebook（第一次请求许可），一切都很好。但是当我点击注销之后我收到“不幸的是我的应用程序已停止”错误并且应用程序关闭。我寻找解决该问题的方法，但找不到任何适合我的方法。这是我的代码：

```
import java.io.IOException;
import java.net.MalformedURLException;

import com.facebook.android.DialogError;
import com.facebook.android.Facebook;
import com.facebook.android.Facebook.DialogListener;
import com.facebook.android.FacebookError;

import android.os.AsyncTask;
import android.os.Bundle;
import android.app.Activity;
import android.app.AlertDialog;
import android.content.DialogInterface;
import android.content.Intent;
import android.content.SharedPreferences;
import android.content.SharedPreferences.Editor;
import android.content.pm.ActivityInfo;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.ImageView;
import android.widget.Toast;

public class MainMenu extends Activity {

ImageView btnLogin;
Facebook fb;
private SharedPreferences shared_pref;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main_menu);
    btnLogin = (ImageView) findViewById(R.id.buttonFb);

    setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_PORTRAIT);

    String APP_ID = getString(R.string.APP_ID);
    fb = new Facebook(APP_ID);

    //tryToGetDataFromPreviousLogin();

    createButtons();
}

private void tryToGetDataFromPreviousLogin() {
    shared_pref = getPreferences(MODE_PRIVATE);
    String access_token = shared_pref.getString("access_token", null);
    long expires = shared_pref.getLong("access_expires", 0);

    if(access_token != null) {
        fb.setAccessToken(access_token);
    }

    if(expires != 0) {
        fb.setAccessExpires(expires);
    }
}

private void createButtons() {
    createBtnExit();
    createBtnStart();
    createBtnFbLogin();
    createBtnSettings();        
}

private void createBtnExit() {
    Button btnExit = (Button) findViewById(R.id.buttonExit);
    btnExit.setOnClickListener(new OnClickListener() {
        public void onClick(View v) {
            popQuitDialog();
        }
    });
}

private void createBtnStart() {
    Button btnStart = (Button) findViewById(R.id.buttonStart);
    btnStart.setOnClickListener(new OnClickListener() {
        public void onClick(View v) {
            Intent intent = new Intent(MainMenu.this, MainActivity.class);
            MainMenu.this.startActivity(intent);
        }
    });
}

private void createBtnFbLogin() {
    btnLogin.setOnClickListener(new OnClickListener() {
        public void onClick(View v) {
            if(fb.isSessionValid()) {
                try {
                    fb.logout(MainMenu.this);
                    updateFbButtonImage();
                } catch (MalformedURLException e) {
                    e.printStackTrace();
                } catch (IOException e) {
                    e.printStackTrace();
                }
            }
            else {
                fb.authorize(MainMenu.this, new DialogListener() {

                    @Override
                    public void onFacebookError(FacebookError e) {
                        Toast.makeText(MainMenu.this, "onFacebookError", Toast.LENGTH_SHORT).show();

                    }

                    @Override
                    public void onError(DialogError e) {
                        Toast.makeText(MainMenu.this, "onError", Toast.LENGTH_SHORT).show();                            
                    }

                    @Override
                    public void onComplete(Bundle values) {
                        /*
                        Editor editor = shared_pref.edit();
                        editor.putString("access_token", fb.getAccessToken());
                        editor.putLong("access_expires", fb.getAccessExpires());
                        editor.commit(); */
                        updateFbButtonImage();                          
                    }

                    @Override
                    public void onCancel() {
                        Toast.makeText(MainMenu.this, "onCancel", Toast.LENGTH_SHORT).show();                           
                    }
                });
            }
        }
    });
}

@Override
protected void onActivityResult(int requestCode, int resultCode, Intent data) {
    // TODO Auto-generated method stub
    super.onActivityResult(requestCode, resultCode, data);
    fb.authorizeCallback(requestCode, resultCode, data);
}

private void updateFbButtonImage() {
    if(fb.isSessionValid()) {
        btnLogin.setImageResource(R.drawable.logout_button);
    }
    else {
        btnLogin.setImageResource(R.drawable.login_button);
    }
}

private void createBtnSettings() {
    Button btnSettings = (Button) findViewById(R.id.buttonStatistics);
    btnSettings.setOnClickListener(new OnClickListener() {
        public void onClick(View v) {
            Intent intent = new Intent(MainMenu.this, Statistics.class);
            MainMenu.this.startActivity(intent);
        }
    });
}

public void popQuitDialog() {
    AlertDialog.Builder alertDialog = new AlertDialog.Builder(MainMenu.this);

    alertDialog.setTitle("Do you really want to quit?");
    alertDialog.setPositiveButton("Yes", new DialogInterface.OnClickListener() {
        @Override
        public void onClick(DialogInterface dialog, int which) {
            finish();
        }
    });

    alertDialog.setNegativeButton("No", new DialogInterface.OnClickListener() {
        @Override
        public void onClick(DialogInterface dialog, int which) {

        }
    });

    alertDialog.show();
}

} 
```

这是堆栈跟踪（在我的 android 4.0.4 上运行）：

```
 01-25 19:09:06.028: D/dalvikvm(23201): GC_FOR_ALLOC freed 50K, 7% free 12768K/13663K, paused 23ms
01-25 19:09:06.088: I/dalvikvm-heap(23201): Grow heap (frag case) to 21.362MB for 9216016-byte allocation
01-25 19:09:06.118: D/dalvikvm(23201): GC_FOR_ALLOC freed <1K, 5% free 21767K/22691K, paused 15ms
01-25 19:09:06.168: D/dalvikvm(23201): GC_CONCURRENT freed 1K, 5% free 21766K/22691K, paused 2ms+2ms
01-25 19:09:06.248: D/dalvikvm(23201): GC_FOR_ALLOC freed <1K, 5% free 21766K/22691K, paused 12ms
01-25 19:09:06.368: I/dalvikvm-heap(23201): Grow heap (frag case) to 36.985MB for 16384016-byte allocation
01-25 19:09:06.398: D/dalvikvm(23201): GC_FOR_ALLOC freed 0K, 3% free 37766K/38755K, paused 19ms
01-25 19:09:06.448: D/dalvikvm(23201): GC_CONCURRENT freed 0K, 3% free 37767K/38755K, paused 2ms+3ms
01-25 19:09:06.558: D/TextLayoutCache(23201): Using debug level: 0 - Debug Enabled: 0
01-25 19:09:06.568: D/libEGL(23201): loaded /system/lib/egl/libGLES_android.so
01-25 19:09:06.568: D/libEGL(23201): loaded /system/lib/egl/libEGL_adreno200.so
01-25 19:09:06.578: D/libEGL(23201): loaded /system/lib/egl/libGLESv1_CM_adreno200.so
01-25 19:09:06.588: D/libEGL(23201): loaded /system/lib/egl/libGLESv2_adreno200.so
01-25 19:09:06.598: I/Adreno200-EGLSUB(23201): <ConfigWindowMatch:2078>: Format RGBA_8888.
01-25 19:09:06.618: D/memalloc(23201): /dev/pmem: Mapped buffer base:0x5c6c6000 size:21016576 offset:17248256 fd:64
01-25 19:09:06.618: E/(23201): Can't open file for reading
01-25 19:09:06.618: E/(23201): Can't open file for reading
01-25 19:09:06.628: D/OpenGLRenderer(23201): Enabling debug mode 0
01-25 19:09:06.818: D/memalloc(23201): /dev/pmem: Mapped buffer base:0x5ee47000 size:11022336 offset:7254016 fd:67
01-25 19:09:09.048: D/memalloc(23201): /dev/pmem: Mapped buffer base:0x5f9d2000 size:7254016 offset:3485696 fd:70
01-25 19:09:09.208: D/OpenGLRenderer(23201): Flushing caches (mode 1)
01-25 19:09:10.038: D/OpenGLRenderer(23201): Flushing caches (mode 0)
01-25 19:09:10.038: D/memalloc(23201): /dev/pmem: Unmapping buffer base:0x5c6c6000 size:21016576 offset:17248256
01-25 19:09:10.038: D/memalloc(23201): /dev/pmem: Unmapping buffer base:0x5ee47000 size:11022336 offset:7254016
01-25 19:09:10.038: D/memalloc(23201): /dev/pmem: Unmapping buffer base:0x5f9d2000 size:7254016 offset:3485696
01-25 19:09:16.588: I/Adreno200-EGLSUB(23201): <ConfigWindowMatch:2078>: Format RGBA_8888.
01-25 19:09:16.598: D/memalloc(23201): /dev/pmem: Mapped buffer base:0x5c6c6000 size:7254016 offset:3485696 fd:64
01-25 19:09:16.738: D/memalloc(23201): /dev/pmem: Mapped buffer base:0x5ceb1000 size:11563008 offset:7794688 fd:67
01-25 19:09:18.498: D/memalloc(23201): /dev/pmem: Mapped buffer base:0x600ce000 size:21016576 offset:17248256 fd:70
01-25 19:09:18.578: D/Facebook-Util(23201): GET URL: https://api.facebook.com/restserver.php?access_token=BAAHxNZCKUYeABAOumBne8GijZA3qZAUimZBQVsGu19qjSfRXIWBSy5t5WpsT3SV4GmqSFFZAdOWpmu7SJrH51V245ZBHh1RMMQybkpP2OH7GRDGMNAgc0Fudaztq07ZCVRMbcHb14nfYAZDZD&method=auth.expireSession&format=json
01-25 19:09:18.578: D/AndroidRuntime(23201): Shutting down VM
01-25 19:09:18.578: W/dalvikvm(23201): threadid=1: thread exiting with uncaught exception (group=0x40a9f210)
01-25 19:09:18.608: E/AndroidRuntime(23201): FATAL EXCEPTION: main
01-25 19:09:18.608: E/AndroidRuntime(23201): android.os.NetworkOnMainThreadException
01-25 19:09:18.608: E/AndroidRuntime(23201):    at android.os.StrictMode$AndroidBlockGuardPolicy.onNetwork(StrictMode.java:1108)
01-25 19:09:18.608: E/AndroidRuntime(23201):    at libcore.io.BlockGuardOs.connect(BlockGuardOs.java:84)
01-25 19:09:18.608: E/AndroidRuntime(23201):    at libcore.io.IoBridge.connectErrno(IoBridge.java:133)
01-25 19:09:18.608: E/AndroidRuntime(23201):    at libcore.io.IoBridge.connect(IoBridge.java:118)
01-25 19:09:18.608: E/AndroidRuntime(23201):    at java.net.PlainSocketImpl.connect(PlainSocketImpl.java:192)
01-25 19:09:18.608: E/AndroidRuntime(23201):    at java.net.PlainSocketImpl.connect(PlainSocketImpl.java:459)
01-25 19:09:18.608: E/AndroidRuntime(23201):    at java.net.Socket.connect(Socket.java:849)
01-25 19:09:18.608: E/AndroidRuntime(23201):    at libcore.net.http.HttpConnection.<init>(HttpConnection.java:77)
01-25 19:09:18.608: E/AndroidRuntime(23201):    at libcore.net.http.HttpConnection.<init>(HttpConnection.java:50)
01-25 19:09:18.608: E/AndroidRuntime(23201):    at libcore.net.http.HttpConnection$Address.connect(HttpConnection.java:351)
01-25 19:09:18.608: E/AndroidRuntime(23201):    at libcore.net.http.HttpConnectionPool.get(HttpConnectionPool.java:86)
01-25 19:09:18.608: E/AndroidRuntime(23201):    at libcore.net.http.HttpConnection.connect(HttpConnection.java:117)
01-25 19:09:18.608: E/AndroidRuntime(23201):    at libcore.net.http.HttpEngine.openSocketConnection(HttpEngine.java:308)
01-25 19:09:18.608: E/AndroidRuntime(23201):    at libcore.net.http.HttpsURLConnectionImpl$HttpsEngine.makeSslConnection(HttpsURLConnectionImpl.java:460)
01-25 19:09:18.608: E/AndroidRuntime(23201):    at libcore.net.http.HttpsURLConnectionImpl$HttpsEngine.connect(HttpsURLConnectionImpl.java:432)
01-25 19:09:18.608: E/AndroidRuntime(23201):    at libcore.net.http.HttpEngine.sendSocketRequest(HttpEngine.java:282)
01-25 19:09:18.608: E/AndroidRuntime(23201):    at libcore.net.http.HttpEngine.sendRequest(HttpEngine.java:232)
01-25 19:09:18.608: E/AndroidRuntime(23201):    at libcore.net.http.HttpURLConnectionImpl.getResponse(HttpURLConnectionImpl.java:273)
01-25 19:09:18.608: E/AndroidRuntime(23201):    at libcore.net.http.HttpURLConnectionImpl.getInputStream(HttpURLConnectionImpl.java:168)
01-25 19:09:18.608: E/AndroidRuntime(23201):    at libcore.net.http.HttpsURLConnectionImpl.getInputStream(HttpsURLConnectionImpl.java:270)
01-25 19:09:18.608: E/AndroidRuntime(23201):    at com.facebook.android.Util.openUrl(Util.java:219)
01-25 19:09:18.608: E/AndroidRuntime(23201):    at com.facebook.android.Facebook.requestImpl(Facebook.java:806)
01-25 19:09:18.608: E/AndroidRuntime(23201):    at com.facebook.android.Facebook.request(Facebook.java:709)
01-25 19:09:18.608: E/AndroidRuntime(23201):    at com.facebook.android.Facebook.logoutImpl(Facebook.java:651)
01-25 19:09:18.608: E/AndroidRuntime(23201):    at com.facebook.android.Facebook.logout(Facebook.java:644)
01-25 19:09:18.608: E/AndroidRuntime(23201):    at taxi.route.MainMenu$3.onClick(MainMenu.java:93)
01-25 19:09:18.608: E/AndroidRuntime(23201):    at android.view.View.performClick(View.java:3574)
01-25 19:09:18.608: E/AndroidRuntime(23201):    at android.view.View$PerformClick.run(View.java:14293)
01-25 19:09:18.608: E/AndroidRuntime(23201):    at android.os.Handler.handleCallback(Handler.java:605)
01-25 19:09:18.608: E/AndroidRuntime(23201):    at android.os.Handler.dispatchMessage(Handler.java:92)
01-25 19:09:18.608: E/AndroidRuntime(23201):    at android.os.Looper.loop(Looper.java:137)
01-25 19:09:18.608: E/AndroidRuntime(23201):    at android.app.ActivityThread.main(ActivityThread.java:4441)
01-25 19:09:18.608: E/AndroidRuntime(23201):    at java.lang.reflect.Method.invokeNative(Native Method)
01-25 19:09:18.608: E/AndroidRuntime(23201):    at java.lang.reflect.Method.invoke(Method.java:511)
01-25 19:09:18.608: E/AndroidRuntime(23201):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:823)
01-25 19:09:18.608: E/AndroidRuntime(23201):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:590)
01-25 19:09:18.608: E/AndroidRuntime(23201):    at dalvik.system.NativeStart.main(Native Method)
01-25 19:09:22.068: I/Process(23201): Sending signal. PID: 23201 SIG: 9 
```

此外，正如您所看到的，注释代码是应该尝试自动登录用户的代码，但它没有按预期工作，我也找不到解决方案。我不知道我是否必须对此提出新问题，因此不胜感激。

* * *

这就是我在 MainMenu.java 中添加的内容

```
private class PostTask extends AsyncTask<String, Integer, String> {

    @Override
    protected String doInBackground(String... params) {
        try {
            fb.logout(MainMenu.this);
        } catch (MalformedURLException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
        return null;
    }

} 
```

并将评论替换为

```
//fb.logout(MainMenu.this);
  new PostTask().doInBackground(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T17:28:35.923

您将获得`NetworkOnMainThreadException`堆栈跟踪所指示的 a 。这发生在 Android 3.0+ 版本上，因为它们有一个新的 StrictMode，它不允许在主线程（本机线程）上进行网络操作。考虑使用一个`AsyncTask`来做你的网络工作。

[这](http://androidresearch.wordpress.com/2012/03/17/understanding-asynctask-once-and-forever/)是一个 AsyncTask 的示例。它由两个基本部分组成 -在**单独**`doInBackground()`的线程上处理网络内容，然后将其结果传递给. 在第二种方法中，您对 UI 进行必要的更改。就像示例注释一样，如果您想在方法执行*之前*做一些事情，您可以使用.**`onPostExecute()`*`doInBackground()``onPreExecute()`***

 ***还有一个有趣的阅读：[保持你的应用响应](http://developer.android.com/training/articles/perf-anr.html)。它还提供了一个 AsyncTask 示例。***

# codeigniter - CodeIgniter - 相关href链接断开

> ID：14527126
> 
> 赞同：0
> 
> 时间：2013-01-25T17:25:35.883
> 
> 标签：codeigniter, routing, rewrite

我最近不得不将基于 CodeIgniter 的网站从以下 Web 根目录中移出：

```
/var/www/vhosts/dev/ 
```

到：

```
/var/www/vhosts/dev/site1/ 
```

我遇到的问题是我需要 web 根仍然可以从域访问：www.devdomain.com

现在所有相关链接都被破坏了，因为它们显然是指网络根目录。是否有重写规则或我可以使用的顶级规则将自动添加`site1/`到所有基于相对的链接？

那么，通常情况下会是什么；

```
<a href="/enrollment">Enrollment</a>
https://www.devdomain.com/enrollment 
```

现在需要成为；

```
<a href="/enrollment">Enrollment</a>
https://www.devdomain.com/site1/enrollment 
```

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T17:33:55.833

如果您在链接中使用了 $config['base_url'] 修复 Nikola 将起作用

```
<a href="<?php echo base_url(); ?>/enrollment">Enrollment</a> 
```

由于显然您不想浏览代码，因此问题不在 Codeigniter 中，而是在服务器中（？）。也许 .htaccess 文件中的 RewriteRule 可以帮助您（如果您在 Apache 上）。

由于我的代表水平低，我无法评论其他答案，否则我只会评论 Nikola 的答案。

编辑：我刚刚想通了。您必须从 href 属性中删除初始的“/”！它会到达网络服务器的根目录，它是一个相对链接，但不是你想的那样。如果删除“/”，则链接将转到与文件相同目录级别的文件（在本例中为 Codeigniter 安装）。抱歉，您必须检查整个代码。

此外，我建议您使用 site_url() 在 Codeigniter 内部的控制器之间进行链接，这有助于解决这种情况以及许多其他情况。

第二次编辑：这不是 site_url() 而是 base_url()，很抱歉造成混淆。刚刚更正了代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T18:51:56.030

请在此处查看我关于`base_url()`vs主题的回答`site_url()`以及为什么您使用其中一个。

[如何设置正确的codeigniter base url？](https://stackoverflow.com/questions/11792268/how-to-set-proper-codeigniter-base-url/11801195#11801195)

对于生成CodeIgniter 生成页面的链接，`site_url()`其实是正确的功能。此外，将 url 作为参数作为字符串传递给函数可以使生成 url 更清晰。观察：

```
<a href="<?php echo base_url(); ?>/enrollment">Enrollment</a> 
```

与：

```
<a href="<?php echo site_url('enrollment'); ?>">Enrollment</a> 
```

甚至：

```
<?php echo anchor('enrollment', 'Enrollment'); ?> 
```

# php - 保护ajax php脚本后调用

> ID：14527131
> 
> 赞同：0
> 
> 时间：2013-01-25T17:25:48.200
> 
> 标签：php, jquery, email, post

起始位置的最佳描述是[使用 PHP 和 jQuery](http://www.webmastertalkforums.com/php-tutorials/78-sending-emails-php-jquery.html)文本发送电子邮件。

TL;DR 我正在使用 jQuery.post() 调用 php 脚本。php里面有这样的东西

```
$to = $_REQUEST['to'];
$from = $_REQUEST['from'];
$message = $_REQUEST['content'];
$subject = $_REQUEST['subject'];
$header = "From: <".$from.">" ."\r\n";
mail($to, $subject, $message, $header); 
```

问题是如何通过创建一个 js 循环并调用它一百万次来保护我的邮件脚本免受滥用？或者只是通过邮寄来称呼它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T17:32:29.770

在 $to 和 $header 参数中信任用户输入也不会保存。攻击者可以添加数百个收件人，因此他甚至不需要多次调用脚本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-25T17:28:08.370

对多个调用的防御必须在服务器端。攻击者可以修改您的客户端代码，或者攻击者可以编写自己的客户端。

我会研究节流策略，如果这不是太多工作，则进入身份验证，这可以使节流更有效。最简单的节流方法是跟踪脚本最后一次执行的时间，并且仅在该时间长于过去一定时间时才允许重新执行。此信息需要永久存储，可能存储在磁盘中的文件或数据库中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-25T17:32:04.497

为了避免自动提交表单，Web 开发人员通常使用`CAPTCHA`. 您还应该使用基于图像的`CAPTCHA`方式来确保您的表单安全。

# javascript - 为浮动在网页顶部并随着查看器向下滚动而移动的 div 设置边界

> ID：14527132
> 
> 赞同：0
> 
> 时间：2013-01-25T17:25:53.280
> 
> 标签：javascript, css, html, css-float, accordion

我的页面右侧有一个浮动滚动 div，我想为它设置边界，但它与文本和按钮共享页面，这些文本和按钮以 jquery 垂直手风琴样式打开，带有标签长度不均匀。因此，页面底部不是一个设定的数字，当页面一直向下滚动时，div 最终位于页脚的顶部。此外，如果页面被调整大小，框就会被撞到不合适的位置。有没有办法定义它不应该越过页面上的某些其他 div？这是我为 div 准备的 css：

```
position: fixed;
width:225px;
float:right;
margin-left:1em;
top: 36.5%;
left: 65%;
margin-left: 10px;
margin-top: 5px; 
```

[jsFiddle - 问题出在蓝色框及其附带的文本上](http://jsfiddle.net/9P8n7/1)

[滚动 div 的一个很好的例子是Apple 配置器页面](http://store.apple.com/us_smb_78313/configure/MD772LL/A?=)上的“摘要”框

# jquery-mobile - jQuery移动转换事件问题

> ID：14527135
> 
> 赞同：1
> 
> 时间：2013-01-25T17:26:06.330
> 
> 标签：jquery-mobile

我正在创建一个 jquery 移动网站。我正在使用最新版本的 jQ mobile。我在顶部栏上有一个按钮，可以打开一个菜单。该按钮仅在主页上可用。在其他页面上，一个后退按钮取代了它。菜单 div 在页面 div 下（想想 Facebook iphone 应用程序）。

当我转换到没有很多内容的页面时，菜单会显示在新页面的 div 下。我浏览了 jQ 移动文档，发现了几个似乎符合要求的事件。我在主页上添加了这个 JavaScript：

```
 <script type="text/javascript">
  $(document).on("pagebeforeshow", function(){
    $('#menu').show();
  });
  $(document).on("pagebeforehide", function() {
    $('#menu').hide();
  });
</script> 
```

我期待它`beforepagehide`会在过渡之前触发并隐藏菜单 div 并且`pagebeforeshow`会再次显示它回来。这是行不通的。我选择了错误的事件吗？我是否完全错过了有关 jQ mobile 工作原理的信息？

**编辑：**我尝试像这样修改代码：

```
<script type="text/javascript">
    $(document).on("pageinit", function(){
      $('div[data-role="page"]').one("pagebeforeshow", function(event, ui){
          alert("show");
          $('#menu').show();
      });
      $('div[data-role="page"]').one("pagebeforehide", function(event, ui) {
          alert("hide");
          $('#menu').hide();
      });
   });
</script> 
```

我期待上面的代码在每次显示页面时绑定事件以执行一次。我得到的是两次“隐藏”警报，然后是我正在转换到显示的页面之前的“显示”警报。我有一种感觉，我在 jQuery 移动生命周期中遗漏了一些东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T10:14:04.250

## 解决方案

我为你做了一个工作示例：**[jsFiddle](http://jsfiddle.net/Gajotres/PGxuR/)**

与您的示例不同，我制作了一个简单的 div，在页面转换期间每次都显示。您可以通过删除 javascript 代码来测试它。

这是隐藏/显示自定义 div 的 js 代码：

```
$(document).on('pagebeforehide','[data-role="page"]',function(e,data){    
    $('#test-div').hide();  
});

$(document).on('pageshow','[data-role="page"]',function(e,data){    
    $('#test-div').show();  
}); 
```

**[在pagebeforehide](http://api.jquerymobile.com/pagebeforehide/)**之前还有 3 个事件。我们不能使用它们，因为它们只会在页面加载到 DOM 之前触发一次。每次触发的第一个事件是**[pagebeforehide](http://api.jquerymobile.com/pagebeforehide/)**，每次触发的最后一个事件是**[pageshow](http://api.jquerymobile.com/pageshow/)**。

与此问题无关的另一件事，此语法不起作用：

```
$(document).on("pageinit", function(){
  $('div[data-role="page"]').one("pagebeforeshow", function(event, ui){
      alert("show");
      $('#menu').show();
  });
  $('div[data-role="page"]').one("pagebeforehide", function(event, ui) {
      alert("hide");
      $('#menu').hide();
  });
}); 
```

页面事件不能像那样序列化。页面事件不能是另一个页面事件的子事件。

## 更多信息

如果您想了解更多关于此以及页面事件如何工作的信息，请在我的**个人博客中浏览****[文章](http://www.gajotres.net/document-onpageinit-vs-document-ready/)**。

# node.js - Sequelize.js 使用 hasMany 连接表两次

> ID：14527136
> 
> 赞同：3
> 
> 时间：2013-01-25T17:26:07.213
> 
> 标签：node.js, orm, data-modeling, datamodel, sequelize.js

我正在使用 Sequelize.js 在同一张表上进行双重连接。我有一组 Team 对象和一组 Game 对象。一个团队有很多游戏，所以它在游戏表中会有外键，但是每场游戏都有两个团队，所以我需要加入两次表。使用 sequelize ORM 执行此操作的最佳方法是什么。

```
Team = sequelize.define('teams',{
  name : Sequelize.STRING,
  location : Sequelize.STRING,
});

Game = sequelize.define('games',{
  homeTeamId : Sequelize.INTEGER,
  awayTeamId : Sequelize.INTEGER,
  location : Sequelize.STRING,
});

// Associations
Game.hasOne(Team, {foreignKey : 'homeTeamId'});
    .hasOne(Team, {foreignKey : 'awayTeamId'});

Team.hasMany(Game); 
```

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-29T17:05:05.267

这实际上是一个有趣的问题。目前 sequelize 不支持此功能，但绝对可行。我在下面概述了两种方法：

```
var Sequelize = require('./index');

var sequelize = new Sequelize('sequelize_test', 'root', null, {
  host: "127.0.0.1",
  port: 3306
});

var Team = sequelize.define('teams',{
  name : Sequelize.STRING,
  location : Sequelize.STRING
}, {
  instanceMethods: {
    getGamesOne: function () {
      var chainer = new Sequelize.Utils.QueryChainer();

      chainer.add(this.getHomeGames());
      chainer.add(this.getAwayGames());

      return new Sequelize.Utils.CustomEventEmitter(function (emitter) {
        chainer.run().done(function (err, results) {
          var home = results[0],
            away = results[1];

          if (err) emitter.emit('error', err)
          else emitter.emit('success', home.concat(away));
        });
      }).run();      
    },

    getGamesTwo: function () {
      return Game.findAll({ where: ["homeTeamId = ? OR awayTeamId = ?", this.id, this.id ]})
    }
  }
});

var Game = sequelize.define('games',{
  homeTeamId : Sequelize.INTEGER,
  awayTeamId : Sequelize.INTEGER,
  location : Sequelize.STRING
});

// Associations
Game.belongsTo(Team, {foreignKey : 'homeTeamId'})
    .belongsTo(Team, {foreignKey : 'awayTeamId'});

Team.hasMany(Game, { as: 'AwayGames', foreignKey : 'awayTeamId'});
Team.hasMany(Game, { as: 'HomeGames', foreignKey : 'homeTeamId'});

Team.find(1).done(function (err, team) {
  team.getGamesOne().done(function(err, games) {
    console.log(games);
  });
  team.getGamesTwo().done(function(err, games) {
    console.log(games);
  });
}) 
```

GetGamesOne 使用 sequelize 的关联来分别获取主场比赛和客场比赛，并在将它们返回给您之前加入。GetGamesTwo 手动构建查询，因此您只需与数据库对话一次。选择您喜欢的任何一个 - 其中一个可能不太清楚发生了什么，但您正在使用 sequelize 构建查询，因此即使您稍后更改键的名称，它仍然可以工作。二非常简短明了，但您必须自己处理查询。

我还将您从游戏到团队的关系更改为`belongsTo`- 意味着外键在游戏表中。

玩得开心使用 Sequelize ;-)

# c++ - 使用继承的类作为映射值

> ID：14527146
> 
> 赞同：0
> 
> 时间：2013-01-25T17:27:08.767
> 
> 标签：c++, inheritance, methods, map

```
class StationSongs {
protected:
    int original_song; 
};

class NewsRadio: public StationSongs {
public:
    NewsRadio()
    {
        current_song = NULL;
        currently_empty = 0;
        original_song = 0;
        start_time_of_song = 0;
        next_song_to_play = NULL;
    }
};

class CommercialRadio : public StationSongs {
public:
    CommercialRadio() {
        current_song = NULL;
        currently_empty = 0;
        original_song = 0;
        start_time_of_song = 0;
        next_song_to_play = NULL;
    }
}; 
```

问题：我想使用继承类作为映射值

地图是：

```
typedef MtmMap<double, StationSongs*> RadioMap;

method{

    CommercialRadio new_station();

    RadioPair new_pair(stationFrequency,*new_station);

    radio.insert(new_pair);
} 
```

我得到这个错误：

```
Multiple markers at this line

- no matching function for call to 'mtm::MtmMap<double, mtm::StationSongs*>::Pair::Pair(double&, 

mtm::CommercialRadio 
     (&)())' 
```

我该如何解决这个？？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T21:10:31.170

`CommercialRadio new_station();`声明一个`new_station`不带参数的函数并返回一个`CommercialRadio`. 删除括号。C++ 语言的这个特性被称为[最令人头疼的解析](http://en.wikipedia.org/wiki/Most_vexing_parse)。

此外，您的基类没有定义虚拟析构函数几乎肯定是不正确的。

# sql-server - TSQL 局部变量在选择它们后似乎没有立即填充

> ID：14527151
> 
> 赞同：0
> 
> 时间：2013-01-25T17:27:25.147
> 
> 标签：sql-server, tsql

我有一个 MS SQL Server 脚本，我在其中创建了一个临时存储过程，当传递两个患者标识符时，它会选择并打印第二个患者的详细信息。然后，它使用这些标识符和详细信息来调用另一个存储过程以将这两个患者合并在一起。

该脚本在这里的几个测试数据库上完美运行，但是当我在繁忙的站点上运行相同的脚本时，看起来好像我选择那些患者详细信息的局部变量“偶尔”没有及时填充以进行打印，但是合并过程的后续执行总是让它们填充得很好。大多数情况下，PRINT 正确显示了这些值。

这是我正在做的精简版。你怎么看？

```
CREATE PROCEDURE [dbo].[TMP_MergeMRNs] @Merge_From_Medical_Record_Number VARCHAR(64) = NULL,
                                       @Merge_From_Institution_Name      VARCHAR(64) = NULL,
                                       @Merge_To_Medical_Record_Number   VARCHAR(64) = NULL,
                                       @Merge_To_Institution_Name        VARCHAR(64) = NULL
AS
  BEGIN
      SET NOCOUNT ON
      SET DEADLOCK_PRIORITY LOW

      /* ALL parameters must be supplied */
      IF @Merge_From_Medical_Record_Number IS NULL
          OR @Merge_From_Institution_Name IS NULL
          OR @Merge_To_Medical_Record_Number IS NULL
          OR @Merge_To_Institution_Name IS NULL
        BEGIN
            PRINT 'ERROR. One or more of the 4 required fields was empty.'

            RETURN 4
        END

      /* Retrieve the merge_to patient demographics */
      DECLARE @lstNm  NVARCHAR(64),
              @frstNm NVARCHAR(64),
              @mdlNm  NVARCHAR(64)

      SELECT @lstNm = id1.LastName,
             @frstNm = id1.FirstName,
             @mdlNm = id1.MiddleName
      FROM   [dbo].[PATIENT] pid1
             INNER JOIN [dbo].[INSTITUTION] i1
               ON pid1.InstitutionDBKey = i1.InstitutionDBKey
      WHERE  i1.InstitutionName = @Merge_To_Institution_Name
             AND pid1.MedicalRecordNumber = @Merge_To_Medical_Record_Number

      PRINT LTrim('Merge From Patient: ' + RTrim(@Merge_From_Medical_Record_Number)) + ' / ' + LTRIM(RTRIM(@Merge_From_Institution_Name))

      PRINT LTrim('Merge To Patient: ' + RTrim(@Merge_To_Medical_Record_Number)) + ' / ' + LTRIM(RTRIM(@Merge_To_Institution_Name))

      PRINT '  Name: ' + ISNULL(LTRIM(RTRIM(@lstNm)), '') + IsNull(', ' + LTRIM(RTRIM(@frstNm)), '') + IsNull(' ' + LTRIM(RTRIM(@mdlNm)), '')

      EXEC PatientMerge
        @Merge_From_Medical_Record_Number,
        @Merge_From_Institution_Name,
        @Merge_To_Medical_Record_Number,
        @Merge_To_Institution_Name,
        /* last */ @lstNm,
        /* first */ @frstNm,
        /* middle */ @mdlNm

      RETURN 0
  END

GO 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T18:34:22.180

你为什么要设置这个'@variable（type）= null'然后想要强制一个值？为什么不直接删除 '= null' 部分，它会要求用户输入一个值？EG：如果我确实创建了 ... (@var int = Null)，它会告诉 proc 它接受 NULLS 并且可以输入 null 值作为输入。如果您执行默认的 create .... (@var int)，则它需要输入值。您正在覆盖默认值，然后重新声明默认值。我不明白你为什么要这样做。

如果您将默认行为设置为需要非空值，则除非为其列出变量，否则 proc 将失败，这就是您希望它出现的内容。

至于 proc 有时工作，有时不工作，我认为如果输入变量为空，您可能应该在输入变量上设置默认值。

```
-- Method 1 set a default if variable is null
declare @int int;

select @int = isnull(@int, 2);  -- variable not listed, no problem ensure there is a default or else do not more forward

select @Int
GO

-- Method 2, do not move forward if variable is null
declare @int int;

If @int is not null
BEGIN
  select @Int;
END
ELSE 
    Select 'Variable is null, please identify value if you wish system to proceed' 
```

# asp.net-mvc-4 - 我究竟如何在 Asp.NET MVC 4 中使用角色？

> ID：14527152
> 
> 赞同：4
> 
> 时间：2013-01-25T17:27:25.033
> 
> 标签：asp.net-mvc-4, visual-studio-2012, roles, membership

我一直在阅读大量文章和论坛，但我仍然无法弄清楚......我正在使用 Visual Studio Express 2012 for Web 构建一个互联网应用程序，其中包含 MVC4+Razor+Entity Framework CodeFirst。

据我了解，使用 SimpleMembership 在 MVC4 中管理用户和角色比在以前的版本中更简单，并且应该相当简单。

在我的应用程序中，我只需要授权某些用户组（例如，只有管理员可以访问某些页面）。我知道这是通过将参数传递给 [Authorize] 注释来实现的： [Authorize(Roles="Admins")] 但是如何创建这些角色以及如何向它们添加用户？

为了要求身份验证，我在控制器方法的顶部添加了注释**[Authorize]**（没有参数），它无需进行任何额外配置或添加任何其他内容即可工作。此外，当我查看自动创建的数据库时，我看到了一个名为 pages_UsersInRoles 的表，其中包含 UserId 和 RoleId 列。所有这一切让我觉得这必须是一个非常简单的任务，因为一切似乎都已设置并准备好使用，但我就是不知道如何;）

到目前为止我尝试过的（但没有成功）是这样的：我有一个继承自 DropCreateDatabaseIfModelChanges 的“DataContextDbInitializer”类。Seed 方法在该类中被覆盖，我添加了这个（我必须导入 System.Web.Security）：

```
Membership.CreateUser("user1", "123456");
Roles.CreateRole("Admins");
Roles.AddUserToRole("user1", "Admins"); 
```

我还在 Web.config 文件的标签中插入了这个标签：

```
<roleManager
enabled="true"
cacheRolesInCookie="true" >
</roleManager> 
```

为了尝试它，我在控制器中的操作方法之上添加了 [Authorize(Roles="Admins")]，然后以“admin”身份登录并尝试访问该方法，但没有运气:(

我不知道我还缺少什么......如果有人能指导我完成这个，我会非常高兴，因为它让我发疯：P

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-25T19:22:44.347

我的猜测是您的 Seed 方法没有被调用。通过在方法中放置一个断点并在调试器中运行它来验证它是否被调用。除非您对应用程序进行了一些其他更改，否则不会使用 EF 迁移。默认情况下，数据库使用 InitializeSimpleMembershipAttribute 进行**初始化**。您将看到此属性已添加到 Account Controller 中，如以下代码所示。

```
[Authorize]
[InitializeSimpleMembership]
public class AccountController : Controller
{
  ....
} 
```

这样只有在访问**AccountController**时才会调用它。您将在 Filters\InitializeSimpleMembershipAttribute.cs 中找到定义。这是这个类的一个代码片段，它可能是为什么它没有被调用的线索。

```
// Create the SimpleMembership database without Entity Framework migration schema
((IObjectContextAdapter)context).ObjectContext.CreateDatabase(); 
```

**InitializeSimpleMembershipAttribute**中的许多代码用于处理未将表单身份验证用于 MVC 应用程序的场景。如果您将始终使用表单身份验证，则可以消除此代码并自己初始化数据库。只需从 AccountController 中删除此属性并将您自己的初始化代码放入 Global.asax **Application_Start**方法中。**您可以在Application_Start**方法中添加类似的内容

```
Database.SetInitializer<UsersContext>(new MyDBInitializer()); 
```

种子方法看起来像这样

```
WebSecurity.InitializeDatabaseConnection("DefaultConnection",
      "UserProfile", "UserId", "UserName", autoCreateTables: true);

var roles = (SimpleRoleProvider)Roles.Provider;
var membership = (SimpleMembershipProvider)Membership.Provider;

if (!roles.RoleExists("Admin"))
{
     roles.CreateRole("Admin");
}
if (membership.GetUser("user1", false) == null)
{
     membership.CreateUserAndAccount("user1", "123456");
}
if (!roles.GetRolesForUser("user1").Contains("Admin"))
{
    roles.AddUsersToRoles(new[] { "user1" }, new[] { "Admin" });
} 
```

请注意，您需要通过调用**WebSecurity.InitializeDatabaseConnection方法在****Seed**方法中初始化 Web 矩阵安全数据库。

 **[您可以在此博客文章](http://kevin-junghans.blogspot.com/2013/01/seeding-customizing-aspnet-mvc.html)中找到有关播种 SimpleMembership 的更多详细信息，其中包括示例项目的完整源代码。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-28T11:02:39.643

最后，我设法使整个事情顺利进行！

我的种子方法现在看起来像这样：

```
WebSecurity.InitializeDatabaseConnection("DefaultConnection", "UserProfile", "UserId", "UserName", autoCreateTables: true);

if (!Roles.RoleExists("Admins"))
{
    Roles.CreateRole("Admins");
}
if (!WebSecurity.UserExists("admin"))
{
    WebSecurity.CreateUserAndAccount("admin", "123456");
}
if (!Roles.GetRolesForUser("admin").Contains("Admins"))
{
    Roles.AddUsersToRoles(new[] { "admin" }, new[] { "Admins" });
}
base.Seed(context); 
```

我在 Global.asax 中的 App_Start 如下所示：

```
Database.SetInitializer(new DataContextDbInitializer());
DataContext c = new DataContext();
c.Database.Initialize(true); 
```

我不确定这是否真的在做某事，但我在 Web.config 的 system.web 标记中有这个：

```
<roleManager enabled="true" cacheRolesInCookie="true" /> 
```

我还从 AccountController 中删除了 [InitializeSimpleMembership]，并在 AccountModels 中删除了 UsersContext 类。我将这一点移到我自己的上下文类中：

```
public DbSet<UserProfile> UserProfiles { get; set; } 
```

然后，为了测试一切是否正常，我在 HomeController 的 About() 方法之上使用了 [Authorize(Roles = "Admins")] 注释。如果一切正常，这将迫使我以 admin/123456 身份登录，以便能够看到由 HomeController/About 控制的“About”页面。哪个；）**

# bash - 如何逐行读取文件并检查每行是否包含bash中的字符

> ID：14527153
> 
> 赞同：0
> 
> 时间：2013-01-25T17:27:27.637
> 
> 标签：bash

我正在尝试使用 bash 逐行读取文本文件，然后挑选出特定的行以存储在向量中。我正在使用的文本文件包含我想使用 cURL 从服务器下载的文件的名称。我感兴趣的每一行前面都有一个以 # 字符开头的描述行。我想逐行阅读文件，检查它是否包含#。如果所述行包含 # 则跳过它。对于那些不包含 # 我想使用该信息传递给 cURL 的行，以便我可以自动下载有问题的文件。到目前为止，我可以使用以下代码逐行阅读它。

```
#! /bin/bash

while read line; do
    echo $line
done <file.txt 
```

我尝试了以下方法，但它不起作用。

```
#! /bin/bash

while read line; do
    if [[ "$line" =~ \#*]]
    then 
        echo $line
    fi
done <file.txt 
```

我收到以下错误。

```
./script.sh: line 4: syntax error in conditional expression
./script.sh: line 5: syntax error near `then'
./script.sh: line 5: `  then ' 
```

我正在为 OS X 10.8.2 (x86_64-apple-darwin12) 使用 GNU bash 3.2.48(1)

我已经在其他地方看到过这个问题，这就是我提出尝试的地方。虽然，由于某种原因，它在我的机器上不起作用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-25T17:29:42.610

`grep`对此有好处：

```
grep -v "^#" file | xargs -n1 curl 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-25T17:35:27.997

在您的代码中 ]] 之前有一个空格。你的正则表达式匹配任何东西。（零个或多个#）

```
#! /bin/bash

while read line; do
    if ! [[ "$line" =~ ^\# ]]
    then 
        echo $line
    fi
done <file.txt 
```

# javascript - Jpicker 透明度

> ID：14527155
> 
> 赞同：0
> 
> 时间：2013-01-25T17:27:34.207
> 
> 标签：javascript, jquery

我正在使用来自[http://www.digitalmagicpro.com/jPicker/的 Jpicker jpicker-1.1.6.js](http://www.digitalmagicpro.com/jPicker/)

我的代码在这里：

```
<script type="text/javascript">
$(function()
      {
        $.fn.jPicker.defaults.images.clientPath='/img';
               var LiveCallbackElement = $('#Live'),
        LiveCallbackButton = $('#LiveButton');
    $('#Binded').jPicker({window:{title:'Gama de Cores', position:{x:'screenCenter', y: 'bottom'}},color:{active:new $.jPicker.Color({ahex:'993300ff'})}});
    $('#LiveButton').click(
      function()
      {
        $.jPicker.List[7].color.active.val('hex', 'e2ddcf', this);
      });
    $('#GetActiveColor').click(
      function()
      {
        alert($.jPicker.List[8].color.active.val('ahex'));
      });
  });
</script> 
```

我想知道的是，如何从颜色选择器选择框中禁用透明度选项？

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T18:02:47.790

```
.QuickColor:last-child {background-image: none;}

$('.QuickColor:last-child').click(function(event) {
    $('.QuickColor:last-child').unbind();
    event.preventDefault();
    return false;
}); 
```

# powershell - Powershell - 双下拉菜单选择

> ID：14527157
> 
> 赞同：1
> 
> 时间：2013-01-25T17:27:43.943
> 
> 标签：powershell, drop-down-menu

我正在为我的一个脚本使用下拉菜单，我调用它两次以在两个不同的窗口上获得两个不同的值。我想优化我的脚本并在同一个窗口中创建一个带有两个下拉框的窗口。

看我的脚本：

```
 $DropDownArray = "Value1" , "Value2" , "Value3"

    # Form building

    Add-Type -AssemblyName System.Windows.Forms
    Add-Type -AssemblyName System.Drawing

    $Form = New-Object System.Windows.Forms.Form
    $Form.width = 300
    $Form.height = 200
    $Form.Text = ”User move Original Location Box”
    $Form.StartPosition = "CenterScreen"

    $DropDown = new-object System.Windows.Forms.ComboBox
    $DropDown.Location = new-object System.Drawing.Size(100,10)
    $DropDown.Size = new-object System.Drawing.Size(130,30)

    ForEach ($Item in $DropDownArray) {
    $DropDown.Items.Add($Item) | Out-Null
    }

    $Form.Controls.Add($DropDown)

    $DropDownLabel = new-object System.Windows.Forms.Label
    $DropDownLabel.Location = new-object System.Drawing.Size(10,10)
    $DropDownLabel.size = new-object System.Drawing.Size(100,200)
    $DropDownLabel.Text = "Select the user Original location ?"
    $Form.Controls.Add($DropDownLabel)

    $OKButton = new-object System.Windows.Forms.Button
    $OKButton.Location = new-object System.Drawing.Size(100,50)
    $OKButton.Size = new-object System.Drawing.Size(100,20)
    $OKButton.Text = "OK"
    $OKButton.Add_Click({
    $Form.DialogResult = "OK"
    $Form.close()
    })
    $form.Controls.Add($OKButton)

    $CancelButton = New-Object System.Windows.Forms.Button
    $CancelButton.Location = New-Object System.Drawing.Size(100,75)
    $CancelButton.Size = New-Object System.Drawing.Size(100,20)
    $CancelButton.Text = "Cancel"
    $CancelButton.Add_Click({
    $Form.DialogResult = "Cancel"
    $Form.close()
    })
    $Form.Controls.Add($CancelButton)

    $Form.Add_Shown({$Form.Activate()})

    $result = $Form.ShowDialog()

    if($result -eq "OK")
    {
    $SrcServer = $DropDown.SelectedItem.ToString()
    }
    else
    {
    $SrcServer = $null
    }
foreach( $Site in $SiteAttribute.location.Site){
   $var1 = $Site.city    
    If ($var1 -match $SrcServer){
            $SOURCE = $site.server
            $OldSiteGroup = $site.OldSiteGroup
            $OldDFSGroup = $site.OldDFSGroup
            $NewDFSRemote = $site.NewDFSRemote
       } 

}                                                             

$source

# Form building

Add-Type -AssemblyName System.Windows.Forms
Add-Type -AssemblyName System.Drawing

$Form = New-Object System.Windows.Forms.Form
$Form.width = 300
$Form.height = 200
$Form.Text = ”User move Destination Location”
$Form.StartPosition = "CenterScreen"

$DropDown = new-object System.Windows.Forms.ComboBox
$DropDown.Location = new-object System.Drawing.Size(100,10)
$DropDown.Size = new-object System.Drawing.Size(130,30)

ForEach ($Item in $DropDownArray) {
$DropDown.Items.Add($Item) | Out-Null
}

$Form.Controls.Add($DropDown)

$DropDownLabel = new-object System.Windows.Forms.Label
$DropDownLabel.Location = new-object System.Drawing.Size(10,10)
$DropDownLabel.size = new-object System.Drawing.Size(100,200)
$DropDownLabel.Text = "Select the user Destination location ?"
$Form.Controls.Add($DropDownLabel)

$OKButton = new-object System.Windows.Forms.Button
$OKButton.Location = new-object System.Drawing.Size(100,50)
$OKButton.Size = new-object System.Drawing.Size(100,20)
$OKButton.Text = "OK"
$OKButton.Add_Click({
$Form.DialogResult = "OK"
$Form.close()
})
$form.Controls.Add($OKButton)

$CancelButton = New-Object System.Windows.Forms.Button
$CancelButton.Location = New-Object System.Drawing.Size(100,75)
$CancelButton.Size = New-Object System.Drawing.Size(100,20)
$CancelButton.Text = "Cancel"
$CancelButton.Add_Click({
$Form.DialogResult = "Cancel"
$Form.close()
})
$Form.Controls.Add($CancelButton)

$Form.Add_Shown({$Form.Activate()})

$result = $Form.ShowDialog()

if($result -eq "OK")
{
$DestServer = $DropDown.SelectedItem.ToString()
}
else
{
$DestServer = $null
}
#The Variable $Sharelocalpath is use in "Part 2 Creating a share on a remote computer" to help WMI
#to create the shared folder remotly using the Localserver Path to create the share if not the good value the U: drive will not map.

foreach( $Site in $SiteAttribute.location.Site){
   $var2 = $Site.city    
    If ($var2 -match $DestServer -and $SrcServer -notmatch $DestServer ){
            $DESTINATION = $site.server
            $Street = $site.street
            $POBox = $site.POBox
            $city = $site.City
            $State = $site.state
            $Zip = $site.zip
            $Country = $site.country
            $OfficePhone = $site.OfficePhone                
            $TargetOU = $site.TargetOU
            $Udrive = $site.Udrive + "$username$"
            $Sharelocalpath = $site.Sharelocalpath + $Username
            $NewSiteGroup = $site.NewSiteGroup
            $NewDFSGroup = $site.NewDFSGroup
            $DESTINATION
            Remove-ADGroupMember -server $DC -Identity $OldSiteGroup -Members $username -Confirm:$false
            Remove-ADGroupMember -server $DC -Identity $OldDFSGroup -Members $username -Confirm:$false
            Add-ADGroupMember -server $DC -Identity $NewDFSRemote -Members $username -Confirm:$false
            Add-ADGroupMember -server $DC -Identity $NewSiteGroup -Members $username -Confirm:$false
            Add-ADGroupMember -server $DC -Identity $NewDFSGroup -Members $username -Confirm:$false            
            }  
 } 
```

我的下拉数组在两个下拉列表中具有相同的值。但是根据我的选择，我的 var 将会改变。谢谢你的帮助。约翰

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-26T18:54:04.420

只是一个肮脏的例子。用这个替换你的两个表格。您必须再次填写命令，因为我刚刚提取了您的一个表格来修改它。如果您只是阅读代码，这是非常基本的修改。或者你可以使用你用来设计它的软件（原始形式）（因为你不理解代码）来制作它。

```
$DropDownArray = @("Test1", "Test2", "Test3")

# Form building

Add-Type -AssemblyName System.Windows.Forms
Add-Type -AssemblyName System.Drawing

$Form = New-Object System.Windows.Forms.Form
$Form.width = 300
$Form.height = 200
$Form.Text = ”User move Destination Location”
$Form.StartPosition = "CenterScreen"

$DropDownFrom = New-Object System.Windows.Forms.ComboBox
$DropDownFrom.Location = New-Object System.Drawing.Size(140,10)
$DropDownFrom.Size = New-Object System.Drawing.Size(130,30)

ForEach ($Item in $DropDownArray) {
    $DropDownFrom.Items.Add($Item) | Out-Null
}

$Form.Controls.Add($DropDownFrom)

$DropDownFromLabel = New-Object System.Windows.Forms.Label
$DropDownFromLabel.Location = New-Object System.Drawing.Size(10,10)
$DropDownFromLabel.Size = New-Object System.Drawing.Size(100,40)
$DropDownFromLabel.Text = "Select the user Original location ?"
$Form.Controls.Add($DropDownFromLabel)

$DropDownTo = New-Object System.Windows.Forms.ComboBox
$DropDownTo.Location = New-Object System.Drawing.Size(140,50)
$DropDownTo.Size = New-Object System.Drawing.Size(130,30)

ForEach ($Item in $DropDownArray) {
    $DropDownTo.Items.Add($Item) | Out-Null
}

$Form.Controls.Add($DropDownTo)

$DropDownToLabel = new-object System.Windows.Forms.Label
$DropDownToLabel.Location = new-object System.Drawing.Size(10,50)
$DropDownToLabel.size = new-object System.Drawing.Size(100,40)
$DropDownToLabel.Text = "Select the user Destination location ?"
$Form.Controls.Add($DropDownToLabel)

$OKButton = new-object System.Windows.Forms.Button
$OKButton.Location = new-object System.Drawing.Size(100,100)
$OKButton.Size = new-object System.Drawing.Size(100,20)
$OKButton.Text = "OK"
$OKButton.Add_Click({
$Form.DialogResult = "OK"
$Form.close()
})
$form.Controls.Add($OKButton)

$CancelButton = New-Object System.Windows.Forms.Button
$CancelButton.Location = New-Object System.Drawing.Size(100,130)
$CancelButton.Size = New-Object System.Drawing.Size(100,20)
$CancelButton.Text = "Cancel"
$CancelButton.Add_Click({
$Form.DialogResult = "Cancel"
$Form.close()
})
$Form.Controls.Add($CancelButton)

$Form.Add_Shown({$Form.Activate()})

$result = $Form.ShowDialog() 
```

# c# - 如何在 c#、asp.net mvc 3 中反序列化未知的大型 xml 文件？

> ID：14527158
> 
> 赞同：0
> 
> 时间：2013-01-25T17:27:46.110
> 
> 标签：c#, asp.net, xml, asp.net-mvc-3, deserialization

我几乎写了一个“webstore”asp.net mvc 3 应用程序，我想用来自一个网上商店的一些项目来填充我的数据库。他们在 xml 文件中为其合作伙伴提供有关项目的信息。我已经下载了一个，但它有 150 MB，所以我不能打开它并查看内容。

文件中的信息也不会完全匹配我的模型，所以我需要以某种方式“合并”事物。我怎么能做到？也许你知道一些关于如何下载 xml 和反序列化的很棒的教程？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T17:29:09.993

LINQ to XML 是一个了不起的提供者。它将允许您以 XElements 的形式查询您的 XML 文档。

```
using System.Xml.Linq; 
```

如果您可以通过它们提供的任何 uri 在代码中下载 xml，则可以通过 System.IO.File 将其加载到内存中并使用 LINQ to XML 对其进行操作。

```
string xml = new WebClient().DownloadString(url);

XDocument doc = XDocument.Parse(xml);

//item being the name of the node
var itemDescendent = doc.Descendants("item"); 

var query = from item in itemDescendent
            select new
            {
               itemId = item.Attribute("id"),
               itemName = item.Attribute("Name")
            };

foreach (item in query)
{
   //dostuff
} 
```

这将从节点中选择属性，您需要一种稍微不同的方法来获取节点内的节点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T18:10:09.990

使用[这个](https://stackoverflow.com/questions/5198224/best-way-to-deserialize-this-xml-into-an-object)或[这个](https://stackoverflow.com/questions/364253/how-to-deserialize-xml-document)

```
 using System;
    using System.IO;
    using System.Xml.Serialization;

namespace xmlTest
{
    class Program
    {
        static void Main(string[] args)
        {
            var articles = new Articles();
            articles.ArticleArray = new ArticlesArticle[2]
            {
                new ArticlesArticle()
                    {
                        Guid = Guid.NewGuid(),
                        Order = 1,
                        Type = "deal_abstract",
                        Title = "Abu Dhabi...",
                        Summary = "Abu Dhabi...",
                        ArticleDate = new DateTime(2011,2,24)
                    },
                new ArticlesArticle()
                    {
                        Guid = Guid.NewGuid(),
                        Order = 2,
                        Type = "deal_abstract",
                        Title = "Abu Dhabi...",
                        Summary = "China...",
                        ArticleDate = new DateTime(2011,2,23)
                    },
            };

            var sw = new StringWriter();
            var xmlSer = new XmlSerializer(typeof (Articles));
            var noNamespaces = new XmlSerializerNamespaces();
            noNamespaces.Add("", ""); 
            xmlSer.Serialize(sw, articles,noNamespaces);
            Console.WriteLine(sw.ToString());
        }
    }

    [XmlRoot(ElementName = "articles", Namespace = "", IsNullable = false)]
    public class Articles
    {
        [XmlElement("article")]
        public ArticlesArticle[] ArticleArray { get; set; }
    }

    public class ArticlesArticle
    {
        [XmlElement("guid")]
        public Guid Guid { get; set; }
        [XmlElement("order")]
        public int Order { get; set; }
        [XmlElement("type")]
        public string Type { get; set; }
        [XmlElement("textType")]
        public string TextType { get; set; }
        [XmlElement("id")]
        public int Id { get; set; }
        [XmlElement("title")]
        public string Title { get; set; }
        [XmlElement("summary")]
        public string Summary { get; set; }
        [XmlElement("readmore")]
        public string Readmore { get; set; }
        [XmlElement("fileName")]
        public string FileName { get; set; }
        [XmlElement("articleDate")]
        public DateTime ArticleDate { get; set; }
        [XmlElement("articleDateType")]
        public string ArticleDateType { get; set; }
    }
} 
```

# logging - 从 InstallShield .EXE 打开 MSI 登录？

> ID：14527160
> 
> 赞同：6
> 
> 时间：2013-01-25T17:27:49.240
> 
> 标签：logging, windows-installer, installshield

我有一个软件更新，它给了我一个错误对话框，并且无法查看错误日志。

我为安装更新而运行的可执行文件在文件的产品名称中标识为 InstallShield。我通过了所有 InstallSheild 向导和对话框就好了，但是当它执行 .msi 文件时，我得到一个对话框，其标题为读取`Windows Installer`和文本读取`This patch package could not be opened. Verify that the patch package exists and that you can access it, or contact the application vendor to verify that this is a valid Windows Installer patch package.`

[我在这里](http://blogs.technet.com/b/richard_macdonald/archive/2007/04/02/how-to-interpret-windows-installer-logs.aspx)读到，如果您只有一个直接的 .msi 文件，而没有 InstallShield，您可以通过从命令行运行 MSI 并提供正确的参数来打开 msi 日志记录，以便更清楚地了解消息，但我不知道当文件在 InstallShield 可执行文件中执行时，不知道如何执行此操作。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-02-20T19:49:50.913

**您可以使用/v**将命令行参数从 Installshield .EXE 传递到包含的 MSI，然后双引号将传递的内容。
**/lv**输出详细日志

因此，要从 installshield 可执行文件生成详细日志，请运行

```
Setup.exe /V"/lv C:\temp\SetupLog.log" 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-01-25T17:34:27.717

在对 InstallShield 安装程序进行故障排除时，我遇到了类似的问题。我通常会导致强制操作系统记录安装：

1.  导航到注册表：`[HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Installer]`
2.  如下创建一个新的 reg 键：`Logging=voicewarmup`其中*Logging*是 reg 键，*voicewarmup*是值。
3.  每当运行安装程序时，它都会登录到用户的临时目录。日志文件将命名为*MSI#####* .LOG，其中*#####*是一串字母数字字符。您可以按修改日期排序以查看最新创建的日志。

**注意：**这将记录**所有**安装，并且某些安装可能有多个日志文件。一般来说，我建议如果您设置此注册表项以获取安装日志，则在获取日志文件后删除注册表项。

上面介绍的方法也在这里描述：[How to enable windows logging](http://support.microsoft.com/kb/223300)

# entity-framework - 选择连接对象的列表及其相关实体

> ID：14527162
> 
> 赞同：1
> 
> 时间：2013-01-25T17:27:51.363
> 
> 标签：entity-framework

我有三张桌子：

QuestionWrappers 问题选项

我想要的是一个问题列表，其中每个问题都绑定了 Options 集合。

到目前为止，这是我正在尝试的：

```
return context.QuestionWrappers
                    .Include("Question")
                    .Include("Question.Options")
                    .Select(q => q.Question)
                    .ToList(); 
```

不幸的是，这会返回一个“问题”对象列表，但缺少 Question.Options。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T22:13:08.390

我认为您几乎拥有它，这将起作用：

```
return context.QuestionWrappers
                .Include(qw=>qw.Question.Select(q=>q.Options))
                .ToList(); 
```

来源：http: [//msdn.microsoft.com/en-us/data/jj574232.aspx](http://msdn.microsoft.com/en-us/data/jj574232.aspx)

# ios - 使用 Core Data 的瞬态属性作为缓存

> ID：14527168
> 
> 赞同：2
> 
> 时间：2013-01-25T17:28:07.937
> 
> 标签：ios, cocoa-touch, caching, core-data

我有一个*核心数据*模型，我想使用`UITableView`. 问题是每个`UITableViewCell`人都有自己的自定义高度，计算它需要一些时间。因此，我想预先计算并缓存它们。

这是我的想法：

每个模型都有一个称为 的瞬态属性`cache`。该属性将包含我自己的缓存对象（的自定义子类`NSObject`），这些对象能够懒惰地计算它们的数据。

这是我的问题：

*   使用瞬态属性来存储我的`cache`对象是个好主意吗？还是将它们存储在一个更好的`NSDictionary`？如果是这样，`ObjectID`作为钥匙使用是否安全？
*   应用程序启动后，我需要为所有`cache`对象运行后台预计算。`NSFetchRequest`使用并要求他们的`cache`对象预先计算来访问所有对象（可能是几千个）是一个好主意吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T12:50:40.553

鲁道夫，

`@property CGSize`我在表格视图中使用的实体上使用简单的方法解决了这个问题。当请求行高时，它会检查大小是否为零（`-tableView:heightForRowAtIndexPath:`），如果是，则计算它，将其保存在 ivar 中并返回它。它非常简单，不需要成为模型中的属性。如果这个高度可以改变，那么您需要跟踪这些条件并通知表格视图。因此，您可以清除缓存的值。

安德鲁

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T18:55:40.363

您尝试缓存的属性似乎不是很动态，因为您是在应用程序启动时计算它。您最好将其设为持久属性并在保存到数据库时计算值。如果由于某种原因值发生变化，您可以重新计算该值。如果您将实体上的所有新记录保存在后台线程上，则效果会更好。

# ms-word - 是否可以将元数据附加到 Word 中的部分/段落？

> ID：14527171
> 
> 赞同：2
> 
> 时间：2013-01-25T17:28:11.737
> 
> 标签：ms-word, metadata

我有一个想要索引的 MS Word 文档。它包含几个段落，每个段落都与特定项目有关。我想将段落链接到特定项目的事实存储到文档中 - 但此链接不应该是可见的（元数据）。

有没有办法使用 Word (2003、2007 或 2010) 做到这一点？

似乎有一些关于自定义 XML 标记的东西，但这在较新版本的 Word 中不可用，我不希望在此基础上进行构建。

谢谢你的帮助

# python - 通过用户输入绕过 CAPTHA

> ID：14527176
> 
> 赞同：0
> 
> 时间：2013-01-25T17:28:21.770
> 
> 标签：python, selenium, web-scraping

我需要创建一个 python web-scraper 来收集一些站点数据。

但是，目标站点仅在满足单个 CAPTCHA 后才会授予访问权限（一次性事件）

我在想是否可以使用简单的网络爬虫脚本（如 selenium）来：

1.  与目标站点进行首次联系，
2.  获取验证码 img，并将其显示给用户，
3.  **使用用户输入询问验证码值**，
4.  **并将请求发送回站点，以便继续导航。**

甚至可能吗？

# android - Android提供者实体关系图？

> ID：14527179
> 
> 赞同：3
> 
> 时间：2013-01-25T17:28:34.097
> 
> 标签：android

有没有人看过安卓提供者数据库的实体关系图？

我正在进入联系人数据库，并进入媒体数据库。男孩将显示表格如何相互关联的图表真的很有帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T12:30:51.847

在公共领域似乎没有任何这样的事情。非常不幸，因为这可能导致应用程序开发人员无法掌握数据库并将错误的数据放入数据库中。

我在调查模拟器上的数据库方面取得了一些成功。为此，将数据库文件从模拟器复制到我的桌面，然后在 Sqlite3 的 Firefox 插件中打开。Android 已经在一些表（PHONEBOOK）中添加了自己的整理器，所以 sqlite 浏览器确实有点抱怨。
我查看的 2 个数据库位于以下位置的 android 设备模拟器上：

```
/data/data/com.android.providers.media/databases for media databases

/data/data/com.android.providers.contacts/databases for contacts 
```

确实花了相当多的时间来获取文件，在这个过程中，了解到 adb shell 没有 cp（复制）命令，但是 adb pull 可以用来将文件从一个位置复制到另一个位置在设备上，再加上尝试`chmod 777 *.db`似乎可以解决问题。最后一步是使用 Eclipse 的设备实用程序中的拉取文件将数据库文件传送到我的桌面。

这绝不是专家的指南，但看起来这就是目前的全部内容。

在桌面上查看数据库及其结构比使用 adb 命令行 shell 要容易得多。

# ruby-on-rails - 如何清空 Heroku 数据库并重新填充

> ID：14527181
> 
> 赞同：1
> 
> 时间：2013-01-25T17:28:38.730
> 
> 标签：ruby-on-rails, database, heroku

我已经看到了这个问题的一些答案，但似乎没有一个对我有用。不小心跑了`heroku run rake db:seed`两次。所以在我的数据库中有双重日期。所以我想删除表，重新迁移并再次运行种子（这次一次;））到目前为止我看到的解决方案告诉我运行：`heroku pg:reset SHARED_DATABASE`或`heroku pg:reset SHARED_DATABASE --confirm <myAppName>`。两者都不起作用。我得到的错误是这样的：

```
 heroku pg:reset SHARED_DATABASE
/usr/local/lib/ruby/gems/1.9.1/gems/heroku-2.8.0/lib/heroku/pg_resolver.rb:125:in `parse_config': undefined method `each' for nil:NilClass (NoMethodError)
    from /usr/local/lib/ruby/gems/1.9.1/gems/heroku-2.8.0/lib/heroku/pg_resolver.rb:116:in `parse_config'
    from /usr/local/lib/ruby/gems/1.9.1/gems/heroku-2.8.0/lib/heroku/pg_resolver.rb:79:in `initialize'
    from /usr/local/lib/ruby/gems/1.9.1/gems/heroku-2.8.0/lib/heroku/pg_resolver.rb:34:in `new'
    from /usr/local/lib/ruby/gems/1.9.1/gems/heroku-2.8.0/lib/heroku/pg_resolver.rb:34:in `resolve_db'
    from /usr/local/lib/ruby/gems/1.9.1/gems/heroku-2.8.0/lib/heroku/command/pg.rb:70:in `reset'
    from /usr/local/lib/ruby/gems/1.9.1/gems/heroku-2.8.0/lib/heroku/command.rb:114:in `run'
    from /usr/local/lib/ruby/gems/1.9.1/gems/heroku-2.8.0/bin/heroku:14:in `<top (required)>'
    from /usr/local/bin/heroku:19:in `load'
    from /usr/local/bin/heroku:19:in `<main>' 
```

我想要做的就是能够删除表，然后用我的种子数据重新填充它。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T20:17:35.677

这`heroku pg:reset`是正确的命令，但是您有旧版本的 gem，您可能需要升级。此外，对于最新的 Postgres 堆栈，SHARED_DATABASE 配置变量不存在 - [Heroku 文档](https://devcenter.heroku.com/articles/heroku-postgresql)说该命令应该是`heroku pg:reset DATABASE`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-26T10:17:28.317

我从 Heroku 获取数据库变量名称的方法是运行`heroku config | grep POSTGRESQL`. 这将输出变量的名称及其 URL。然后，您可以通过 go 删除数据库`heroku pg:reset <DATABASE>`（例如，可能是`heroku pg:reset HEROKU_POSTGRESQL_CHARCOAL_URL`）。然后，您应该能够再次迁移数据库并填充它，但是您通常会这样做。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-25T17:42:44.153

您可以简单地进入 heroku 控制台并删除种子数据。

```
heroku run console 
```

并删除表中的所有项目。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-25T22:26:25.030

我找到了一个似乎有效的答案。我`heroku run rake db:rollback`能够删除表，然后迁移并重新植入数据。感谢您的输入。

# sql - 使用左外连接时按子句排序

> ID：14527183
> 
> 赞同：2
> 
> 时间：2013-01-25T17:28:41.307
> 
> 标签：sql, sql-server, sql-server-2005

`Order by`当我使用左外连接并且并非所有行都有列的值时，如何在 SQL 查询中使用？这是在 SQL Server 2005 中

```
Select * from Order O
left outer join Order_Selection OS on OS.Order_ColorID = O.Order_ColorID    
order by OS.Order_SelectionID asc 
```

并非此处的所有行都具有 的值`Order_selectionID`。当我使用`DESC`时，我想要的顺序搞砸了，当我使用时`ASC`，行排在最后，因为没有的行排在`Order_SelectionID`第一位。

先感谢您！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-25T17:44:45.963

您可以使用`CASE`表达式来避免依赖`ISNULL(OS.Order_SelectionID, magic_number)`

```
SELECT *
FROM   Order O
       LEFT OUTER JOIN Order_Selection OS
         ON OS.Order_ColorID = O.Order_ColorID
ORDER  BY CASE
            WHEN OS.Order_SelectionID IS NULL THEN 1
            ELSE 0
          END,
          OS.Order_SelectionID 
```

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2013-01-25T17:33:41.123

Order_selectionID 的行真的有必要吗？如果不使用子句过滤它们：

```
and Order_selectionID is not null; 
```

或者，如果您的数据允许，您可以将空值替换为某个虚拟值：在 Oracle 中：

```
select nvl(Order_selectionID, -1) from... 
```

# html - HTML 表单在 Chrome 24 上的外观与在 Chrome 23 上的外观不同

> ID：14527184
> 
> 赞同：-1
> 
> 时间：2013-01-25T17:28:41.890
> 
> 标签：html, css, forms, google-chrome, css-tables

我注意到自上次更新 Chrome (24.0.1312.56)**以来我的网站看起来有所不同，****尽管我没有修改任何代码行。**更准确地说，表单上的输入被本地化在不同的位置，并且文本看起来比以前更大。

[这是 Chrome 23](http://i48.tinypic.com/145o5e.jpg)
[上的渲染 这是最新版 Chrome 上的渲染。](http://i50.tinypic.com/11qprep.jpg)

我在不同的电脑上做了测试，结果是一样的。
IE 和 Firefox 没有任何变化。

请参阅下面的犯罪代码。

**HTML**

```
<table class="form-fields-table form-main-block">
  <colgroup>
    <col class="form-select-col"></col>
    <col class="form-select-col"></col>
    <col class="form-select-col"></col>
  </colgroup>
  <tr class="form-input-block">
    <td class="form-label">
      <label for="sit_pro">Vous êtes<span class="form-required">*</span> :</label>
      <select name="sit_pro">
        <option value="0">-- Sélectionnez --</option>
        (...)
      </select>
    </td>
    <td class="form-label">
      <label for="sit_bien">Votre situation<span class="form-required">*</span>:</label>
      <select name="sit_bien">
        <option value="0">-- Sélectionnez --</option>
        (...)
      </select>
    </td>
    <td class="form-label">
      <label for="type_bien">Votre type de bien<span class="form-required">*</span> : </label>
      <select name="type_bien">
        <option value="0">-- Sélectionnez --</option>
        (...)
      </select>
    </td>
  </tr>
</table> 
```

**CSS**

```
.form-fields-table .form-main-block td {
  padding-top: 15px;
}

.form-fields-table td {
  border-spacing: 10px 0;
  vertical-align: middle;
  padding: 2px 0;
}

.form-comments-table td {
  vertical-align: top;
}

.form-fields-table td.form-label-top {
  vertical-align: top;
  padding-top: 8px;
}

.form-select-col {
  width: 200px;
}

.form-label {
  text-align: left;
  color: #444;
  font-weight: bold;
  font-size: 14px;
} 
```

知道发生了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T11:24:49.470

似乎谷歌浏览器根据最大的输入文本设置列的宽度。就我而言，最大的输入文本是中间下拉列表的选择输入选项之一。

我已经使用`max-width`on`td`和`select`tags 的属性解决了这个问题：

```
.form-label {
  text-align: left;
  color: #444;
  font-weight: bold;
  font-size: 14px;
  max-width: 155px; // new
}

.form-label select {
    max-width: 155px; // new
} 
```

而且渲染效果很好。

# jms - ActiveMQ - 我无法使用 InOut 模式使用从 Camel 发送的消息

> ID：14527185
> 
> 赞同：1
> 
> 时间：2013-01-25T17:28:43.343
> 
> 标签：jms, activemq, apache-camel

活动MQ 5.5.1

```
<c:route>
    <c:from uri="jetty:http://0.0.0.0:8055/ws/despacho" />
    <c:to uri="bean:despachoHandler" />
    <c:to uri="activemq:queue:copom.out.test" pattern="InOut" />
</c:route> 
```

该消息出现在队列中，但我无法使用它。一段时间后，我得到了超时，消息转到 ActiveMQ.DLQ。

> org.apache.camel.ExchangeTimedOutException：未收到 OUT 消息：20000 毫秒到期回复消息，相关 ID：Camel-ID-SSP-SGPF-GITSAD-58215-1359134232568-0-3 未收到。

如果我将其更改为**pattern="InOnly"**我可以正常使用该消息。

这是怎么回事？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-25T18:00:00.817

您应该学习 EIP 模式。

使用 InOut 时，您正在执行请求-回复 EIP 模式 [http://camel.apache.org/request-reply.html](http://camel.apache.org/request-reply.html)

在这种情况下，一条消息被发送到一个 JMS 队列，并且当您执行 InOut 时，一个回复消息应该被发送回 JMSReply 属性中定义的队列（如果没有，Camel 将设置为一个临时队列名称）否则显式设置）。

如果 20 秒后没有回复消息，Camel 会因超时异常而失败。您可以配置超时的长度。

所以你必须决定你是在做请求回复 EIP (InOut) 还是事件消息 (InOnly) [http://camel.apache.org/event-message.html](http://camel.apache.org/event-message.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-09-17T12:56:44.083

当 JMSCorrelationID= 设置我们的系统并且 Camel in/out 无法接收来自请求回复队列的响应时，我们遇到了类似的问题。在删除由我们的代码设置的 JMSCorrelationID= 后，Camel 开始运行，成功接收来自请求回复队列的消息。

# android - Android onTouchListener：在用户触摸时切换活动

> ID：14527191
> 
> 赞同：1
> 
> 时间：2013-01-25T17:28:55.283
> 
> 标签：android, ontouchlistener

我是 Android 开发的新手，希望得到一些帮助来弄清楚如何做某事。我有一个带有 EditText 对象的活动，该对象已格式化为占据整个视图，中间有一个单词。我需要弄清楚的是如何实现onTouchListener，这样当用户点击屏幕（任何地方）时，他们就会被转发到另一个Activity。非常感谢任何帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T17:36:36.850

当您`EditText`占据整个视图时，您需要附加`onTouchListener`到它。

在您的活动代码中：

```
yourEditText.setOnTouchListener( new View.OnTouchListener()
{
        @Override
        public boolean onTouch( View v, MotionEvent event )
        {
            // start your other activity here
        }
} ); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T18:51:06.923

在您的 .xml 中将此属性添加到您的 EditText

```
android:clickable="true" 
```

并在 .java 文件中，在初始化您的 EditText 集 onClickListener 之后

```
mEditeText.setOnCLickListener(new View.OnClickListener(){

    public void onClick(View v) {
        .....
    }

}); 
```

# compiler-errors - VHDL - 分配默认值

> ID：14527201
> 
> 赞同：2
> 
> 时间：2013-01-25T17:29:24.870
> 
> 标签：compiler-errors, default-value, vhdl

我有以下架构：

```
architecture datapath of DE2_TOP is

begin
  U1: entity work.lab1 port map ( --error on this line
    clock => clock_50,
    key => key,
    hex6 => hex6,
    hex5 => hex5,
    hex4 => hex4
  );

end datapath; 
```

这种架构显然依赖于 lab1 实体。这是我的 lab1 实体和架构：

```
entity lab1 is
    port(
        clock : in std_logic;
        key : in std_logic_vector(3 downto 0);
        hex4, hex5, hex6 : out std_logic_vector(6 downto 0);
        value_counter   : in unsigned(7 downto 0);
        register_counter : in unsigned(3 downto 0)
        );
end lab1;

architecture up_and_down of lab1 is
    signal hex5_value : unsigned(7 downto 0);
        begin
    process(clock)
        begin
            value_counter<="00000000"; --default values?
            register_counter<="0000";
            if rising_edge(clock) then
                if (key(3)='0' and key(2)='0' and key(1)='1' and key(0)='0') then
                    value_counter <= value_counter + "1";   
                elsif (key(3)='0' and key(2)='0' and key(1)='0' and key(0)='1') then  
                    value_counter <= value_counter - "1";   
                end if;
            end if;
            hex5_value <= (value_counter - (value_counter mod 10))/10;
    end process;

end architecture up_and_down; 
```

我收到以下错误：`Error (10346): VHDL error at DE2_TOP.vhd(280): formal port or parameter "value_counter" must have actual or default value`在指示的行上。在我看来，我已经在我的 lab1 架构中设置了默认值。有谁知道问题是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T18:16:51.650

这不是“默认值”，而是初始化它的赋值。它还分配给非法的输入端口。此外，实体是在架构之前编译的，因此（非法）分配还不存在。

```
signal value_counter : unsigned(7 downto 0) := (others => 'X'); 
```

是声明中提供的默认值（或初始值）

```
port (
   value_counter   : in unsigned(7 downto 0) := (others => '1'); 
```

将是输入端口上的默认值，但我从未见过这样做。我一直在端口映射中连接所有输入端口。如果这行得通，我（有点）印象深刻，但可能不足以对未连接的输入感到高兴；以这种方式忽略错误似乎太容易了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-01T13:13:49.293

你没有在`value_counter`输入上驱动任何东西。所有实体输入必须具有驱动它们的信号，或实体声明中指定的默认值。

后者对于可选的输入很有用：

```
entity lab1 is
    port(
        clock : in std_logic;
        key : in std_logic_vector(3 downto 0);
        hex4, hex5, hex6 : out std_logic_vector(6 downto 0);
        value_counter   : in unsigned(7 downto 0) := (others => '-');
        register_counter : in unsigned(3 downto 0)
        );
end lab1; 
```

`-`如果您不连接它，将确保 value_counter 获得分配给它的无关位 ( )。或者，如果您希望它全为零，

```
 value_counter   : in unsigned(7 downto 0) := (others => '0'); 
```

# sql - 不同组合的产品和产品包的数据库模型

> ID：14527203
> 
> 赞同：3
> 
> 时间：2013-01-25T17:29:31.377
> 
> 标签：sql, database-design, database-relations

*你将如何设计你的数据库来实现这个功能？*

考虑一个我们想要创建***产品关系（包）***的场景......

假设我们创建了一个**ProductTbl**

```
prod_id   prod_name    prod_fee
1         prepaid-A    19 usd
2         prepaid-B    29 usd
3         prepaid-C    39 usd
4         internet      9 usd
5         mms           1 usd
6         email         3 usd 
```

我们希望提供一个产品包，为客户提供更好的费用。

> 例如，如果客户选择**prepaid-A + internet + mms**，他们将收取 25 美元的 pkg 费用（而不是 29 美元）。

**设计**

*   具有相同组合的 pkg 应该只存在一次。
*   如果可能，一个 pkg 可以有无限数量的产品。（通常是 2-4 个）。

例如 pkg 组合

**产品包装表**

```
ppkg_id   prod_name    prod_fee
1         prepaid-A    25 usd
1         mms          25 usd
1         internet     25 usd

2         internet     10 usd
2         email        10 usd

3         prepaid-C    45 usd
3         internet     45 usd
3         mms          45 usd
3         email        45 usd 
```

这意味着组合

> *   pkgid 1 -> prepaid-a、mms 和 internet，pkg 费用为 25 美元
> *   pkgid 2 -> 互联网和电子邮件一起收取 10 美元的费用
> *   pkgid 3 -> prepaid-c, internet, mms, email all together for 45 usd

因此，如果客户只获得了***预付-c + 互联网***，他们没有得到 45 美元的交易，他们将支付 39 + 9 = 48 美元的正常费用。

现在这个表格只是为了演示，我想得到你的意见和建议，以便朝着正确的方向建模。

我们需要首先选择查询客户当前的费用计划（基于使用的产品/服务），然后查看产品 pkg 并查看 pkg 交易是否对他们有效。

（如何做这样的选择？在 pkg 表上？）如何为此有一个好的数据库模型？

请提供网址、提示和任何有价值的建议，以将我推向正确的方向。

十分感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T21:09:25.107

您正在销售目录中的商品或服务。您也可以出售上述组合。这称为营销包（或捆绑或组合）。

营销包也从目录中出售。它可以由商品、服务或其他营销包组成。

每个订单的价格确实不同。您可以在 good 表中设置基价，在 service 表中设置月价，在营销包表中设置基价。

![在此处输入图像描述](../Images/2abbf427ab0c9169062091480c9c62ca.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T20:48:40.987

我希望对此有一些意见，但也许问题是“混乱”来回答。:o)

我现在的模型是这样的：

**产品表**

```
prod_id   prod_name    prod_fee
1         prepaid-A    19 usd
2         prepaid-B    29 usd
3         prepaid-C    39 usd
4         internet      9 usd
5         mms           1 usd
6         email         3 usd 
```

**产品包装表**

```
ppkg_id   prod_id      prod_name 
1         1            prepaid-A 
1         5            mms       
1         4            internet  

2         4            internet  
2         6            email     

3         3            prepaid-C 
3         4            internet  
3         5            mms       
3         6            email 
```

**ProductPkgFeeTbl**

```
ppkg_id   ppkig_fee
1         25
2         10
3         45 
```

> 但是上面有一些缺陷，那就是有人可以将相同的产品插入不同的 pkg 并收取不同的费用。

我真的不知道如何使用 sql 确保 pkg 是唯一的。好吧，当然可以使用编程语言/存储过程/触发器等进行检查！但我想要一个 100% 完美无瑕的设计。

> 请根据您在此类问题上的经验将我推向正确的方向...

# jquery - jquery removeClass '有效'，但类的效果仍在继续

> ID：14527204
> 
> 赞同：0
> 
> 时间：2013-01-25T17:29:35.323
> 
> 标签：jquery, removeclass

首先请记住，我是网页设计、JS 和所有这些方面的新手。任何建议都将不胜感激:) 我将这个 img 图标（serviceIcon）定位为“绝对”，并带有它们的特定类（serviceHardware，...）。

```
<div class="servicesBox">
    <img class="serviceIcon serviceHardware" />
    <img class="serviceIcon serviceSoftware" />
    <img class="serviceIcon serviceNetwork" />
</div> 
```

很简单：鼠标悬停改变未悬停项目的不透明度并调整悬停项目的大小；mouseleave 将所有动画设置为之前的状态；单击将单击的 img 动画到角落，应该删除 serviceIcon 类（以避免触发 mouseover/mouseleave，对吗？）并向下移动（在示例中）未单击的 img，并将 serviceSelected 类添加到单击的项目。

```
$("img.serviceIcon").click(function(){

    $("img.serviceIcon").not(this)
        .animate({
            top:'45px',
        });

    $(this).removeClass("serviceIcon")
        .animate({
            left:'150px'
        }, 300, function(){
            origLeft = $(this).css('left');
            $(this).addClass("serviceSelected");
            //alert(origLeft);
        });
}); 
```

但是正如您在此处看到的（[http://jsfiddle.net/rcvmQ/4/](http://jsfiddle.net/rcvmQ/4/)），单击的 img 不断触发对应于 serviceIcon 类的 mouseover/mouseleave 事件（单击时已删除），如果您检查元素，您将看到它不再有 serviceIcon 类了。我在这里做错了什么？可能是全部？身份证。

实际上，它添加了 serviceSelected 类，但是如果单击它，则永远不会触发该类的单击事件。奇怪的。我已经在 Firefox 和 safari 中对此进行了测试，并且两者的行为都相同。

我在 serviceItem 的单击事件中添加了额外的验证代码，检查它是否具有 serviceSelected 类，这根本不是逻辑的。即使它有效，我也拒绝使用它！谢谢！

编辑：关于 mouseover/mouseleave 的代码

```
$("img.serviceIcon").mouseover(function(){
    $(".serviceIcon").not(this)
                        .animate({
                            opacity:'0.3'
                        }, 100);
    $(this).animate({
        width   :'25px',
        height  :'40px',
        opacity :1
    },200);
});

$("img.serviceIcon").mouseleave(function(){
$("img.serviceIcon").stop(true,true)
                        .animate({
                            width   :'20px',
                            height  :'40px',
                            opacity :'1'
                        },100);
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T17:46:59.007

取消绑定`mouseover`事件

[http://jsfiddle.net/rcvmQ/5/](http://jsfiddle.net/rcvmQ/5/)

```
 $(this).off('mouseover').removeClass("serviceIcon")
            .animate({
                left:'150px'
            },300, function(){
                origLeft = $(this).css('left');
                $(this).addClass("serviceSelected");
                //alert(origLeft);
            }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-26T14:35:31.560

在阅读了 .on() 和 .off() 之后，我对代码进行了一些更改，它似乎可以工作。我创建了 2 个函数：

```
function clickIcon(){ ... }
function restoreIcons(){ ... } 
```

基本上，它们包含 serviceIcon 和 serviceSelected 类的单击事件的代码。正如您向我展示的那样，当我单击 serviceIcon 时，我关闭了“click”事件，取消绑定它，然后我打开（绑定）了使用函数 restoreIcons（）处理的 serviceSelected 类的“click”事件。

```
function clickIcon(){
    leftPos = $(this).css('left');
    //alert(leftPos);
    $("img.serviceIcon").not(this)
                        .animate({
                            top     :'80px',
                        }); 
        //turning off 'click' for serviceIcon   
    $(this).off('click').removeClass("serviceIcon")
                    .animate({
                        left:'300px'
                    },200, function(){
                        $(this).addClass("serviceSelected");
                                            // turning on 'click' for serviceSelected
                    $('img.serviceSelected').on('click',restoreIcons);
                    });         
} 
```

在 restoreIcon 函数内部，我关闭了 serviceSelected 的“click”事件并再次打开了 serviceIcon 的“click”事件（由 clickIcon() 处理）。

```
function restoreIcons(){
    $(this).animate({
            left    :leftPos
        },200, function(){
            $(this).off('click')
                    .removeClass('serviceSelected')
                    .addClass('serviceIcon');
            $('img.serviceIcon').animate({
                            top:'0px'
                        },100);
            $('img.serviceIcon').on('click', clickIcon);
        });
} 
```

您可以在此处查看完整代码 ( [http://jsfiddle.net/rcvmQ/9/](http://jsfiddle.net/rcvmQ/9/) )。

这很完美，至少在您第一次单击每个图标时是这样。之后，如果我开始反复单击它们，我会注意到严重的延迟，并且每次都会变长。对我来说似乎是处理开和关的时间，可能是？我认为可能的另一件事是我没有解除 mouseenter/mouseleave 事件的绑定，所以这可能会同时发生。有什么建议吗？

# ruby-on-rails - 在 HTML 中逐行打印 SQL 结果，而不将所有行存储在内存中

> ID：14527207
> 
> 赞同：0
> 
> 时间：2013-01-25T17:29:46.810
> 
> 标签：ruby-on-rails, ruby-on-rails-3.2

在 PHP（过去）中，您曾经`mysql_fetch_assoc`在 html 上逐行打印一些内容。基本上，你正在对一些 sql 结果进行循环，而不将整个结果存储在内存中。

当我进行一个非常大的查询时，我遇到了一种情况，它“连接”了所有必需的表来创建一个大行，所以当我请求一个关联模型时，查询不会调用数据库，因为考虑了数据“缓存”。

这个查询的最大问题，它是巨大的，它将很多东西加载到内存中。因为是用连接构建的，所以我真的不需要一次在内存中加载所有使用过的表的所有数据，因为每一行都是直接可打印的（感谢这个连接），所以我的想法基本上是在每个获取的行上做一个循环并直接打印，然后丢弃。

我怎样才能做到这一点？

这是我正在使用的粗略表结构（未完成）：

```
Trips
  - has_many Hikers
  - belongs_to Organization

Hikers
  - belongs_to PersonalRecord

PersonalRecord

Organization
  - has_many Trips 
```

我的加入只是简单地进行所有旅行，并将这张表的每一行与组织、徒步旅行者和个人记录连接起来。

**更新1：**

目前我正在使用这个查询来获取结果：

```
table_join_to_cache = '
  INNER JOIN organizations    ON organizations.id         = trips.organization_id
   LEFT JOIN cities           ON cities.id                = trips.city_id
   LEFT JOIN hiker_trips      ON hiker_trips.trip_id      = trips.id
   LEFT JOIN hikers           ON hikers.id                = hiker_trips.hiker_id
   LEFT JOIN personal_records ON personal_records.id      = hikers.personal_record_id
   LEFT JOIN trip_trip_levels ON trip_trip_levels.trip_id = trips.id
   LEFT JOIN trip_levels      ON trip_levels.id           = trip_trip_levels.trip_level_id
'
@trips = Trip.joins(table_join_to_cache)
             .where('trips.begin_date >= ? AND trips.begin_date <= ?', begin_of_month, end_of_month)
             .uniq.order('begin_date ASC, title ASC') 
```

如果我需要，我可以选择添加其他条件，例如，为特定组织旅行。

**注意**如果可能的话，我想避免分页。

**我的想法：**在我的想象中，这应该像“光标”一样工作，我进行查询，而不是存储类似的东西`@trips_cursor = myquery`，然后在视图`trips_cursor.each_row do |trip|`中创建一个模型对象（并丢弃它）每次都需要循环。它显然可以是只读的。

**我需要 ruby​​ on rails 代码，而不是 PHP**

**更新答案**

由于我同时学到了一些东西，所以我想分享一些我发现的信息。首先，如果您使用 AR 查询（where、joins、limit 和一些类似的方法），查询**将不会运行**（延迟加载），直到您在查询上运行一个方法，这不是*AR 方法*。基本上每个`each`方法都会触发查询。因此，如果您`find_each(batch_size: 1)`在未触发的 AR 查询上执行 ，它只会在内存中加载一行并每次打印出来，从而保留您宝贵的 RAM。请注意，我使用这种方法只是因为，由于我的巨型连接，我加载了所需的所有内容并且所有记录都是唯一的，因此我不需要缓存它们。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T17:59:30.160

检查此链接：

[http://guides.rubyonrails.org/active_record_querying.html#retrieving-multiple-objects-in-batches](http://guides.rubyonrails.org/active_record_querying.html#retrieving-multiple-objects-in-batches)

我想你要的是`find_each`方法。它默认一次加载 1000 行，这可能没问题，但您可以将其配置为获取更少或更多。

我希望这会有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-25T18:25:21.363

如果 @trips 是视图中的关系，则使用 find_each 或 find_in_batches 的示例（可能会更好）：

```
<%= @trips.find_in_batches do |trips| %>
  <%= render partial: trips %>
<% end %> 
```

怎么样？

另外，如果结果真的那么大，我强烈建议您考虑使用某种形式的缓存，例如 ActiveSupport::Cache::Store: [http://guides.rubyonrails.org/caching_with_rails.html#activesupport-cache-store](http://guides.rubyonrails.org/caching_with_rails.html#activesupport-cache-store)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-25T18:00:57.150

我敢肯定有很多聪明的解决方案，但为什么不在 SQL 查询中使用好的旧 LIMIT 呢？只需获取 500 行来处理它们并进行更多操作。

# wcf - WCF 绑定属性没有被拉入我的客户端服务参考

> ID：14527208
> 
> 赞同：0
> 
> 时间：2013-01-25T17:29:46.997
> 
> 标签：wcf, .net-4.0, wcf-binding

我在将绑定属性拉入客户端服务配置时遇到问题。我在服务器上运行 WCF 服务（作为 Windows 服务）。我首先尝试命名绑定，并使用 bindingConfiguration 属性将其应用于我的服务，但这不起作用。我看到其他人通过删除 name 属性将绑定设为默认值，这就是我现在所处的位置。WCF 项目的应用程序配置如下所示：

```
<?xml version="1.0" encoding="utf-8"?>
<configuration>
  <system.web>
    <compilation debug="true" />
  </system.web>
  <!-- When deploying the service library project, the content of the config file must be added to the host's 
  app.config file. System.Configuration does not support config files for libraries. -->
  <system.serviceModel>
    <bindings>
      <basicHttpBinding>
        <binding maxReceivedMessageSize="6553600" maxBufferSize="6553600" />
      </basicHttpBinding>
    </bindings>
    <client />
    <services>
        <service ... />
        <service name="PdfWriterService.Service4">
          <host>
          <baseAddresses>
            <add baseAddress="http://rsmreports:8733/PdfWriterService/v4" />
          </baseAddresses>
        </host>
        <!-- Service Endpoints -->
        <!-- Unless fully qualified, address is relative to base address supplied above -->
        <endpoint address="" binding="basicHttpBinding" contract="PdfWriterService.IService4">
          <!-- 
                          Upon deployment, the following identity element should be removed or replaced to reflect the 
                          identity under which the deployed service runs.  If removed, WCF will infer an appropriate identity 
                          automatically.
                    -->
          <!--<identity>
            <dns value="localhost" />
          </identity>-->
        </endpoint>
        <!-- Metadata Endpoints -->
        <!-- The Metadata Exchange endpoint is used by the service to describe itself to clients. -->
        <!-- This endpoint does not use a secure binding and should be secured or removed before deployment -->
        <endpoint address="mex" binding="mexHttpBinding" contract="IMetadataExchange" />
      </service>
    </services>
    <behaviors>
      <serviceBehaviors>
        <behavior>
          <!-- To avoid disclosing metadata information, 
                      set the value below to false before deployment -->
          <serviceMetadata httpGetEnabled="True" />
          <!-- To receive exception details in faults for debugging purposes, 
                      set the value below to true.  Set to false before deployment 
                      to avoid disclosing exception information -->
          <serviceDebug includeExceptionDetailInFaults="False" />
        </behavior>
      </serviceBehaviors>
    </behaviors>
  </system.serviceModel>
</configuration> 
```

我的客户端站点（服务部分）上的 web.config 如下所示：

```
 <system.serviceModel>
    <bindings>
      <basicHttpBinding>
        <binding name="BasicHttpBinding_PdfWriterServiceV4" closeTimeout="00:01:00"
          openTimeout="00:01:00" receiveTimeout="00:10:00" sendTimeout="00:01:00"
          allowCookies="false" bypassProxyOnLocal="false" hostNameComparisonMode="StrongWildcard"
          maxBufferSize="65536" maxBufferPoolSize="524288" maxReceivedMessageSize="65536"
          messageEncoding="Text" textEncoding="utf-8" transferMode="Buffered"
          useDefaultWebProxy="true">
          <readerQuotas maxDepth="32" maxStringContentLength="8192" maxArrayLength="16384"
            maxBytesPerRead="4096" maxNameTableCharCount="16384" />
          <security mode="None">
            <transport clientCredentialType="None" proxyCredentialType="None"
              realm="" />
            <message clientCredentialType="UserName" algorithmSuite="Default" />
          </security>
        </binding>
      </basicHttpBinding>
    </bindings>
    <client>
      <endpoint address="http://rsmreports:8733/PdfWriterService/v4"
        binding="basicHttpBinding" bindingConfiguration="BasicHttpBinding_PdfWriterServiceV4"
        contract="PdfWriter.PdfWriterServiceV4" name="BasicHttpBinding_PdfWriterServiceV4" />
    </client>
  </system.serviceModel> 
```

我是否缺少让客户端拥有这些属性（maxReceivedMessageSize 和 maxBufferSize）的东西？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T20:57:40.417

看来，为了使用这些属性，我需要更改服务的 app.config 以及客户端站点的 web.config 上的值。这就是我能够使更改生效的方式。

如果我的假设不正确，请告诉我如何通过更新服务参考将这些更改过滤到客户端，我会将您的答案标记为正确。

# android - 为什么 findViewById 在 robolectric-unit-test 中的膨胀布局上返回 null？

> ID：14527221
> 
> 赞同：3
> 
> 时间：2013-01-25T17:30:39.903
> 
> 标签：android, robolectric

我正在尝试使用 Robolectric 测试一些代码。

我的代码膨胀了一个布局，然后尝试通过调用`findViewById`这个布局来检索一个视图。布局膨胀工作正常。但是`findViewById`，在此布局上始终返回 null。

我可以在调试器中看到膨胀布局的所有（阴影）子视图都在那里并且设置了它们的属性。但是每个孩子的id都设置为0。这是为什么呢？我错过了什么吗？

设备或仿真器（没有 robolectric）上的实际代码工作正常，但是当我尝试使用 robolectric 运行它时，它会按照描述失败。

基本上我的代码如下所示：

```
LayoutInflater inflater = (LayoutInflater) Robolectric.application.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
View layout = inflater.inflate(R.layout.timeline_list_item, null);
TextView view = (TextView) layout.findViewById(R.id.listItem_date);
//why is view null here!
view.setText("test"); 
```

问候弗兰克

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-27T17:15:42.563

谢谢，我找到了问题。

我的资源标识符在我的资源 xml 文件`R.id.listItem_date`中声明。`@+id/listItem.date`

Android似乎转换了“。” 在生成的 R 文件中的名称中添加一个“_”。这在编译和运行代码时工作正常，但显然 robolectric 存在问题。

当我将资源名称中的点更改为下划线时，我的 robolectric 代码可以正常工作。

现在我知道要寻找什么，我发现有一个开放的错误票： [https ://github.com/pivotal/robolectric/issues/265](https://github.com/pivotal/robolectric/issues/265)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T18:43:30.493

请查看以下更改

```
LayoutInflater inflater = (LayoutInflater)**"ContextOnject"**.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
View layout = inflater.inflate(R.layout.timeline_list_item, null); 
```

# c - 编译错误，找不到“blasint”

> ID：14527224
> 
> 赞同：0
> 
> 时间：2013-01-25T17:30:49.247
> 
> 标签：c, gcc, blas

我想使用 GotoBLAS2 对两个向量求和（z = x+y，其中 x 和 y 是两个长度相同的向量）。我使用以下代码：

```
#include <stdio.h>
#include <cblas.h>
#include <common.h>

double x[] = {1,2,3};
double y[] = {4,5,6};

void main()
{
int n,i,x_int,y_int=5,a;
n=3;x_int=1;y_int=1;a=1;
cblas_dzxpy(n, a, &x[0], x_int, &y[0], y_int);
for(i=0;i<n;i++) printf("x[%d] = %g\n", i, x[i]);
} 
```

该文件位于某个目录“Test”中，而 GotoBLAS2 位于带有 TEST（不是文件）的目录中。另外，我将 libgoto2.a 放在 TEST 文件夹中。当我想使用以下命令编译它时：

```
gcc AddSubVectors.c -I../GotoBLAS2 -L../GotoBLAS2 libgoto2.a 
```

我多次收到以下错误：

```
../GotoBLAS2/cblas.h:270:45: error: unknown type name 'blasint' 
```

似乎我必须将某些东西链接到 gcc，但我不知道是什么以及如何。非常感谢任何帮助。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T17:46:24.607

感谢您的快速回复。使用您的提示，我发现了问题所在。实际上， blasint 是在 common.h 中定义的，因为在我的代码`#include <cblas.h>`中是 before `#include <common.h>`，gcc 找不到 blasint 的定义。

再次感谢

# java - 从 MessageContext.HTTP_RESPONSE_HEADERS 获取 Cookie 值

> ID：14527226
> 
> 赞同：0
> 
> 时间：2013-01-25T17:31:11.280
> 
> 标签：java, cookies, http-headers

如何从 cookie 列表中获取特定 cookie 的值。以下是我的尝试：

```
 Map<String, List<String>> map = (Map<String, 
                List<String>>) context.get(MessageContext.HTTP_RESPONSE_HEADERS);

        List<String> contentType = getHTTPHeader(map);
        if (contentType != null) {
            StringBuffer strBuf = new StringBuffer();
            for (String type : contentType) {
                strBuf.append(type);
            }
            System.out.println("Content-Type:" + strBuf.toString());
        }

        List<String> cookies = map.get("Set-Cookie"); 
        if (cookies != null) {
            System.out.println("cookies != null");
            StringBuffer strBuf = new StringBuffer();
            for (String type : cookies) {
                System.out.println(" Looping cookie ");
                strBuf.append(type);
            }
            System.out.println("Cookie:" + strBuf.toString());
        }else{
            System.out.println("cookies == null");
        } 
```

我得到以下结果，我想获得“JSESSIONID”的价值

```
Cookie:JSESSIONID=88E53DE2E78TRE86E1C2B021BA240B; Path=/us-webservice 
```

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T17:39:36.540

`cookie.substring(cookie.indexOf(':'), cookie.indexOf(';')).split("=")[1]`

或者如果你想要正则表达式

```
Pattern p = Pattern.compile( "JSESSIONID=([A-Z0-9]+)");
Matcher m = p.matcher(cookie);
m.find();
m.group(1); 
```

# windows-8 - Windows 8 应用程序 - 根据分辨率加载不同的 default.html 文件

> ID：14527231
> 
> 赞同：0
> 
> 时间：2013-01-25T17:31:42.767
> 
> 标签：windows-8, screen-resolution

我有一个非常基本的 HTML/JavaScript 应用程序，我将其放入 Windows 8 应用程序中。其中大部分是基于图像的，并不真正适合为不同分辨率设计的标准方式。

我已经以几种不同的分辨率创建了它，基本上我想要做的是告诉它根据设备的屏幕分辨率加载不同的“default.html”文件。我没有任何运气找到有关如何执行此操作的信息。有人能指出我正确的方向吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T18:00:13.060

如果您想要设备的屏幕分辨率（而不仅仅是窗口的大小），则需要[使用用 C++ 编写的 WinRT 组件](http://blogs.microsoft.co.il/blogs/tomershamam/archive/2012/07/24/get-screen-resolution-in-windows-8-metro-style-application.aspx)。该组件可以[从您的 Javascript 应用程序中调用](http://msdn.microsoft.com/en-us/library/windows/apps/hh755833.aspx)。您将在[app.onactivated](http://msdn.microsoft.com/en-us/library/windows/apps/br212679.aspx)处理程序中调用此组件并根据分辨率显示适当的内容。

起始页 (default.html) 在您的应用清单中定义，您无法通过逻辑更改它。但是，如上所述，没有必要。只需从 default.html 开始，检查分辨率并显示您想要的内容（例如根据分辨率显示和隐藏 div）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-23T16:52:12.663

Default.html 页面是您的 Windows 8 应用程序的默认页面。哪个反过来在您的应用程序的清单文件**package.appxmanifest**中定义。您可以在此处设置应用程序的主页以及其他一些应用程序设置。

您不能通过对屏幕分辨率使用 if else 块来更改它，例如：

```
if(screen.width > 1788) {
   default.page == "someotherpage";
} 
```

没有。那不会发生。

但是，既然您使用的是 HTML、CSS、JavaScript，为什么不做我们 Web 开发人员对我们网站所做的事情。我们检查屏幕分辨率。并据此改变内容。

否则，将无法在运行时编辑和更改 App Manifest 文件。

# c# - CreateStreamedFileFromUriAsync：如何传递 IRandomAccessStreamReference？

> ID：14527233
> 
> 赞同：3
> 
> 时间：2013-01-25T17:31:47.330
> 
> 标签：c#, uri, storagefile

我正在尝试使用`StorageFile`方法 下载文件，`CreateStreamedFileFromUriAsync`但我对`IRandomAccessStreamReference`参数感到困惑。如何传递 IRandomAccessStreamReference？它是一个接口。我该怎么办？

```
public static IAsyncOperation<StorageFile> CreateStreamedFileFromUriAsync(
    string displayNameWithExtension, 
    Uri uri, 
    IRandomAccessStreamReference thumbnail
) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-27T15:55:20.183

我找到了答案：

```
IRandomAccessStreamReference thumbnail =
    RandomAccessStreamReference.CreateFromUri(new Uri(remoteUri));
IAsyncOperation<StorageFile> file1 =
    StorageFile.CreateStreamedFileFromUriAsync("duyuru.pdf", new Uri(remoteUri), thumbnail); 
```

# c++ - 通过有关更改的信号快速进行进程间通信

> ID：14527235
> 
> 赞同：0
> 
> 时间：2013-01-25T17:31:54.350
> 
> 标签：c++, com, ipc, shared-memory, dbus

我知道 IPC 的几种方法，例如：

1.  共享内存
2.  DBus、COM等技术
3.  通过文件

第一种将内存直接共享到 RAM 中的方法，但我不能立即知道公共内存的变化。

第二种方法很好，但不是跨平台解决方案。

第三种方法是跨平台的，通过平台 api，我可以立即了解公共内存的变化。但是读/写文件时间可能很长。

是否存在可以直接将内存共享到 RAM 并可以
立即发出有关公共内存更改的信号的跨平台解决方案？

更新 1\. 例如，是否存在用于文件 IPC 的协议和技术，通过数据库文件结构降低时间成本？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T19:17:34.263

我找到了一种解决方案[http://www.qtcentre.org/wiki/index.php?title=SingleApplication](http://www.qtcentre.org/wiki/index.php?title=SingleApplication)

该解决方案使用共享内存进行数据存储，并在 Windows 命名管道、Unix 本地域套接字上使用，用于立即发送有关更改的消息。

# c# - 如何在滚动查看器中放置的图像周围设置“边框”

> ID：14527236
> 
> 赞同：2
> 
> 时间：2013-01-25T17:32:01.220
> 
> 标签：c#, xaml, winrt-xaml, scrollviewer

我正在创建一个 Windows 商店应用程序，并且在一个页面上，我在 ScrollViewer 中放置了一个大图像，以使用户能够使用触摸手势来平移和缩放图像。到目前为止，一切都很好，除了一件事。我想对其进行调整，以便有一个用于平移的“缓冲区”，以便用户可以“过度平移”到**最多**一半图像不在屏幕上的程度，无论 ZoomFactor 或用户缩放了多少进或出。

我的问题是，我将如何实施这个？有人建议用透明的 uielements 填充图像的顶部、左侧、底部、右侧，但我不认为静态大小的插入 uielements 将能够实现“最多一半的图像离开屏幕”的要求。

有任何想法吗？提前谢谢你的帮助。

编辑：每个请求添加代码

```
<Grid x:Name="LayoutRoot" Background="{StaticResource ApplicationPageBackgroundThemeBrush}">
    <ScrollViewer x:Name="ImageViewer" Background="White" ZoomMode="Enabled" 
                  IsVerticalRailEnabled="False" IsHorizontalRailEnabled="False" 
                  VerticalScrollMode="Enabled" HorizontalScrollMode="Enabled" 
                  VerticalScrollBarVisibility="Hidden" HorizontalScrollBarVisibility="Hidden" 
                  MinZoomFactor=".22" MaxZoomFactor="2"
                  VerticalContentAlignment="Center" HorizontalContentAlignment="Center">
            <Image x:Name="map" Source="map.png" ImageOpened="map_Loaded_1"/>

    </ScrollViewer>
</Grid> 
```

这是事件背后的代码

```
 const float _defaultZoomFactor = 0.23F;
    private void map_Loaded_1(object sender, RoutedEventArgs e)
    {
        ImageViewer.ZoomToFactor(_defaultZoomFactor);
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-19T14:39:16.407

您可以为图像 UI 元素添加动态边距，该边距是根据`Loaded`事件上的图像大小计算得出的，与`ImageOpened`.

Xaml 方面：

```
<Image x:Name="map" Source="map.png" ImageOpened="map_Loaded_1" Loaded="OnImageElementLoaded"/> 
```

和代码方面（样机）：

```
private void OnImageUILoaded( object sender , RoutedEventArgs e)
{
  //Get image size
  //Calculate margin size
  //Set (Image)sender's new margin
} 
```

# php - 如何使用另一个站点数据库创建登录？

> ID：14527237
> 
> 赞同：0
> 
> 时间：2013-01-25T17:32:02.217
> 
> 标签：php, jquery

我们有一个网站正在运行，我的老板想使用 WordPress 网站作为封面。

我正在尝试使用我们现有的用户数据库在 WordPress 中创建登录。这样当用户登录 WordPress 时，他们将被重定向到我们当前的网站。

关于我应该如何处理这个问题的任何建议？

我尝试使用 jQuery `$.post`，但对于外部链接效果不佳。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T17:37:47.053

为了安全地执行此操作，您可能需要在服务器端实现一些东西。例如，登录 WordPress 网站，如果成功，将用户重定向到您当前的网站。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T17:38:32.187

您可以编写登录逻辑，如果登录良好，请继续访问您的网站。像这样的东西：

```
<?php
     /* Your login logic */
     if login = 'success'
     {
        $urlToRedirect = 'https://yourwebsite.com'
        header('Location: '.$urlToRedirect);
     }
     exit;
?> 
```

# javascript - 对 JavaScript 的“this”对象和“var”声明的变量感到困惑

> ID：14527241
> 
> 赞同：1
> 
> 时间：2013-01-25T17:32:21.200
> 
> 标签：javascript

我对 JavaScript 的`this`对象有点困惑。

```
var contextTest = function() {
    var x = 0;
}

var test = new contextTest;
console.log(test.x); // produces undefined 
```

上面和函数内部有什么区别`this.x = 0;`？

我一直认为声明这样的变量会将变量绑定到范围。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T17:38:11.557

声明：

```
var x = 0; 
```

只需在您所在的任何函数范围内创建一个局部变量。

该变量仅在该函数或函数闭包的生命周期内存在。这种类型的声明永远不会将此变量作为属性绑定到对象。为此，您必须明确地为对象的属性赋值，如`this.x = 0;`.

如果您使用导致函数闭包持续存在的构造（您在代码中拥有该构造），则局部变量的值将作为私有可访问变量存在于函数闭包中，只能从该特定上下文中的该特定函数访问. 它会在某些方面表现得像对象的私有实例变量。但是，它不是对象的属性，您不能通过`this`或任何其他对对象的引用来引用它。您只能从声明它的函数中引用它。

# actionscript-3 - 发生键盘事件时是否可以更改符号图像？

> ID：14527242
> 
> 赞同：0
> 
> 时间：2013-01-25T17:32:28.457
> 
> 标签：actionscript-3, flash, flash-cs4, keyboard-events

我知道这在 actionscript 3.0 中是可能的，但我不知道要使用什么方法。就像当我按下左箭头键时，闪光灯上的物体会将图像从圆形变为方形。类似的东西......我试图用谷歌搜索，但我真的找不到答案，甚至找不到例子。

我只看到这个站点包含 AS3 中的键盘事件[http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/events/KeyboardEvent.html#](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/events/KeyboardEvent.html#)

谁能帮我解决这个问题。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T17:54:18.080

听键盘事件代码示例：

```
import flash.events.KeyboardEvent;

stage.addEventListener(KeyboardEvent.KEY_UP, onKeyboard);

function onKeyboard(event:KeyboardEvent):void
{
    var char:String = String.fromCharCode(event.charCode);
    trace("ker pressed: ", char);
} 
```

# java - 关闭 InitialContext

> ID：14527245
> 
> 赞同：0
> 
> 时间：2013-01-25T17:32:33.570
> 
> 标签：java, initial-context

我有一个类使用另一个`EJBHelper`类中的方法，该类调用该方法`getInitialContext`来初始化`InitialContext`.

现在，问题是我需要`InitialContext`在 EJB 进程结束后关闭。请帮忙; 我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T17:36:02.540

据我所知，您不需要关闭 InitialContext。

# actionscript-3 - 是否可以与套接字 io 同时使用闪存套接字和 websockets？

> ID：14527249
> 
> 赞同：3
> 
> 时间：2013-01-25T17:32:53.107
> 
> 标签：actionscript-3, node.js, google-chrome, websocket, socket.io

我已经为此苦苦挣扎了几天，试图到处寻找信息，但我无法解决。

基本上，我有一个 Flash 客户端应用程序和一个浏览器 - 基于 chrome 的应用程序连接到一个套接字 io - nodejs 服务实例。

如您所知，Chrome 可以通过 websockets 运行，而我的 flash 应用可以通过 flash sockets 运行。

chrome 和 node 之间一切正常，但是当我从我的 flash 应用程序进行任何交互时，这会将连接类型降级为 flash 套接字而不是 websockets，从而使 chrome web 应用程序无法从服务器读取，因为服务器开始使用闪光灯插座。基本上，当我从 Flash 进行任何交互时，chrome 不再接收任何信息。

你知道有什么方法可以通过 flash-node 在 flashsockets 中继续提供信息，而且还保证 node-chrome 通过 websockets 进行通信吗？

我已经尝试了与 socket io 连接的推荐库，您可以在 socket io 网站上找到该库；就是这个[https://github.com/simb/FlashSocket.IO](https://github.com/simb/FlashSocket.IO)

我还尝试在 AS3 中使用一个使用 websockets 的库，但似乎无法与 socket.io 正确通信；就是这个[https://github.com/y8/websocket-as](https://github.com/y8/websocket-as)。尝试连接时套接字 io 输出的消息是“调试 - 破坏非 socket.io 升级”

这里有一些调试代码，显示了 flashsockets 和 websocket，这是我的两个客户端应用程序试图连接到同一个套接字 io 服务器：

[https://gist.github.com/4637617](https://gist.github.com/4637617)

非常感谢你的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-26T17:21:21.147

谢谢，经过大量的工作，我终于设法解决了这个问题。

Socket.io 有一个非常智能的实现，允许您使用命名空间和房间。

我已经通过在两个不同的命名空间中工作来解决它：一个用于浏览器，另一个用于 flash。

例子：

```
 var browser = io.of("/browser").on('connection', function (socket) {
     socket.on('move', function (data) {
        browser.emit("move", {"left" : data.left, "top" : data.top});
     });
 });

 io.sockets.on('connection', function (socket2) {
     socket2.on('click', function (data) {
        browser.emit("move", {"left" : 1000, "top" : 50});
    });
 }); 
```

当我单击一个按钮时，Flash 会发送“单击”，然后我会向浏览器命名空间中的所有浏览器发送一条消息。

挺有用的。

我希望这可以帮助别人！

一切顺利

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-26T02:30:33.813

如果您使用多个传输配置 socket.io，当客户端连接时，它将选择最佳可用传输。因此，如果一个客户端只能使用闪存，那么它将使用它，而另一个客户端可能会使用 xhr-polling。

默认情况下，您有 websocket、htmlfile、xhr-polling、jsonp-polling，但没有 flashsocket。

有关更多详细信息，请参阅[https://github.com/LearnBoost/Socket.IO/wiki/Configuring-Socket.IO](https://github.com/LearnBoost/Socket.IO/wiki/Configuring-Socket.IO)。

# windows-phone-8 - 更改 XAP 内容、重新打包和部署到 Windows Phone 8

> ID：14527251
> 
> 赞同：2
> 
> 时间：2013-01-25T17:33:19.607
> 
> 标签：windows-phone-8, xap

我需要能够从 WP8 xap 文件中提取内容（通过重命名为 .zip 和解压缩），更改我的一个文本文件的内容，重新打包它（使用发送到压缩（压缩）文件夹，然后重命名为 xap）和使用 XapDeploy.exe 部署它

除部署阶段外，一切正常。XapDeploy 报告状态为 XAP 文件无效。

我还需要做其他步骤吗？

这可能吗？

在构建过程之外执行此操作的原因是允许没有源代码的客户在将其部署到员工之前更改此单个文本文件以满足他们的需求。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T18:38:42.487

这个过程对我来说在 WP8 上使用 FIle Explorer 效果很好。

以下是可能出错的两件事：

1.  您是否尝试使用 Windows Phone Apps 服务中的生产 XAP？这些是使用 WmPrHeader 签名的，并且在不制动该签名的情况下不能再更改。确保您使用的是从 VS2012 生成的 XAP。

2.  您的 ZIP 格式与 XAP ZIP 格式不匹配。可能是您将文件添加到 ZIP 并保存新 ZIP 的方式将压缩算法更改为 WP8 不支持的内容。确保您使用具有相同参数的相同压缩算法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-27T09:11:14.547

Silverlight 仅支持一部分压缩方法。您可以使用[infoZip 2.32 版](http://sourceforge.net/projects/infozip/files/Zip%202.2x%20and%20earlier/2.32/)重新打包。请注意，info zip 3.0 版（当前）存档不兼容。[在info zip bugs 部分](http://www.info-zip.org/mans/zip.html#BUGS)有关于 PKZIP 兼容性的提示。

# asp.net - 我如何制作将数据存储在客户端数据库中的服务器端应用程序

> ID：14527253
> 
> 赞同：2
> 
> 时间：2013-01-25T17:33:29.170
> 
> 标签：asp.net, sql-server, ms-access, database-connection

我正在构建一个需要数据库的 asp.net 网站，但要求是我不会将数据存储在服务器上。因此，我需要有关如何将服务器端 asp.net 网站的数据存储在客户端数据库文件上的帮助。表示与客户端数据库文件交互的 Web 应用程序，该文件也可以存储在闪存驱动器中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T17:47:37.903

您可以尝试使用[HTML5 Storage](http://diveintohtml5.info/storage.html)。

您也可以阅读：[如何在 HTML5 中将数据存储到数据库](https://stackoverflow.com/questions/9865980/how-to-store-data-to-database-in-html5)

并在互联网上搜索更多信息。

# java - Git 无法识别重命名和修改的包文件

> ID：14527257
> 
> 赞同：16
> 
> 时间：2013-01-25T17:33:42.527
> 
> 标签：java, git

我有一个名为`package/old/myfile.java`. 我已经通过 git 提交了这个文件。然后我将我的包重命名为，`new`所以我的文件位于`package/new/myfile.java`.

我现在想将此文件重命名（和内容更改）提交给 git。

当我这样做时，`git status`我得到

```
# Changes not staged for commit:
#   (use "git add/rm <file>..." to update what will be committed)
#   (use "git checkout -- <file>..." to discard changes in working directory)
#
#       deleted:    package/old/myfile.java
#
# Untracked files:
#   (use "git add <file>..." to include in what will be committed)
#
#       package/new/myfile.java 
```

我已经尝试`add`过新`rm`的和旧的，反之亦然，我不断得到

```
$ git status
# On branch develop
# Changes to be committed: 
#        delete:    package/old/myfile.java
#        new file:  package/new/myfile.java 
```

我不能这样做`mv old new`，因为旧文件不存在，所以我得到`bad source`错误。

还有什么我可以尝试的吗？

对于类似的问题，我已经尝试了一些关于 SO 的多个答案，但它们没有奏效。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-01-25T17:42:00.667

[git book](http://git-scm.com/book)中的[相关部分](http://git-scm.com/book/en/Git-Basics-Recording-Changes-to-the-Repository#Moving-Files)对此进行了解释。

> 与许多其他 VCS 系统不同，Git 不会显式跟踪文件移动。如果您在 Git 中重命名文件，Git 中不会存储任何元数据来告诉它您重命名了该文件。然而，Git 非常聪明地在事后弄清楚这一点——我们稍后会处理检测文件移动。

What this means is that if you move a file and then make significant changes git will not know that it was a move. It will see a file deleted and a new file created because the new file doesn't look like the old one. To get around this people often `git mv` files, commit the move, and then make changes. In your situation you can do

```
git reset # Move changes from index to working copy
git checkout package/old/myfile.java # Undo delete
git mv package/old/myfile.java package/new/myfile.java # Move file 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-01-25T17:37:01.950

将文件移回，然后提交，并将实际移动放入单独的提交中。Git 不会像这样记录移动（或重命名），但可以在之后根据内容识别它们。如果内容发生变化，则无法正确检测到移动。因此，通常的做法是将移动和更改拆分为两个提交。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-07-24T21:26:00.963

Commands to implement @Nevik Rehnel's suggestion of two commits by rewriting history to move the file before it's edited:

Starting condition:

*   your most recent commit includes both a move and modification to a file and `git log --follow newpath` shows the file as newly created in the most recent commit

Steps:

*   Tag your current status `git tag working_code`
*   Start an interactive rebase to edit the history: `git rebase -i HEAD~2`
    *   in the editor that pops up, change "pick" on the first line to "edit", save and exit.
*   Your are now editing history just before your commit
*   Create the move as its own commit
    *   `git mv oldpath newpath`
    *   The directory to contain the new file location has to exist; you may have to `mkdir` it first
    *   (optionally) Edit the file with any small changes needed to accompany the file rename (ex: in Java: class name and/or package and import lines) - **Avoid making other changes** Git detects these as the same file based on similarity
    *   `git add .` and check that `git status` now shows: `renamed: oldpath -> newpath`
    *   `git commit -m "Rename oldpath newpath"`
*   `git rebase --continue`
    *   You should get a conflict on newpath. Restore the file with `git checkout working_code newpath`
    *   Complete the rebase: `git rebase --continue`
*   Verify that `git log --follow newpath` shows the full history

# android - 在 Eclipse 中从一页到另一页链接页面的问题

> ID：14527259
> 
> 赞同：0
> 
> 时间：2013-01-25T17:33:46.007
> 
> 标签：android, eclipse

我正在尝试使页面相互链接。就像下图一样。我无法将页面链接到其他页面，然后将最后一页链接到原始页面 这是一张图片，让你们了解我正在尝试做什么 [http://i.imgur.com/ikuUBXB .png](http://i.imgur.com/ikuUBXB.png)

这是 home.xml

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:background="@drawable/title"
tools:context=".home" >

<Button
    android:id="@+id/button1"
    android:layout_width="200dp"
    android:layout_height="65dp"
    android:layout_alignParentBottom="true"
    android:layout_centerHorizontal="true"
    android:layout_marginBottom="300dp"
    android:text="@string/page1"
    android:textSize="@dimen/fontsize"
    android:textColor="#FFFFFF" />

<Button
    android:id="@+id/button2"
    android:layout_width="200dp"
    android:layout_height="65dp"
    android:layout_alignParentBottom="true"
    android:layout_centerHorizontal="true"
    android:layout_marginBottom="200dp"
    android:text="@string/page2"
    android:textSize="@dimen/fontsize"
    android:textColor="#FFFFFF" />

<Button
    android:id="@+id/button3"
    android:layout_width="200dp"
    android:layout_height="65dp"
    android:layout_alignParentBottom="true"
    android:layout_centerHorizontal="true"
    android:layout_marginBottom="100dp"
    android:text="@string/page3"
    android:textSize="@dimen/fontsize"
    android:textColor="#FFFFFF" /> 
```

page1.java

```
 package com.example.app;

     import android.os.Bundle;
     import android.app.Activity;
     import android.content.Intent;
     import android.text.method.KeyListener;
     import android.view.Menu;
     import android.view.View;
     import android.widget.Button;

 import android.os.Bundle;
 import android.app.Activity;
 import android.content.Intent;
 import android.text.method.KeyListener;
 import android.view.Menu;
 import android.view.View;
 import android.widget.Button;

 public class page1 extends Activity {
    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_page1);
    }
    View.OnClickListener handler = new View.OnClickListener(){

    public void OnStart(){
        Button Btn = (Button)findViewById(R.id.button1);     
        Btn.setOnClickListener(new OnClickListener() {

            public void onClick(View Button) {

        Intent myIntent = new Intent(Home.this, page1.class); 
        Home.this.startActivity(myIntent);

            } 

        });
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T18:40:18.317

尝试像这样创建您的意图-

```
Intent myIntent = new Intent(getApplicationContext, page1.class); 
```

然后开始你的活动

```
Home.this.startActivity use startActivity(myIntent); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T17:45:36.560

在您的代码中，您处于 page1 活动中，并且您的 onclick 为 page1 启动了一个活动。因此，每次单击 button1 时，都会启动相同的活动。

这就是我想你想要完成的事情：

```
public class HomePage extends Activity{
...
public void OnStart() {
    Button Btn1 = (Button) findViewById(R.id.button1);
    Btn1.setOnClickListener(new OnClickListener() {
        public void onClick(View Button) {
            Intent myIntent = new Intent(getActivity(), page1.class);
            startActivity(myIntent);
        }
    });
    Button Btn2 = (Button) findViewById(R.id.button2);
    Btn2.setOnClickListener(new OnClickListener() {
        public void onClick(View Button) {
            Intent myIntent = new Intent(getActivity(), page2.class);
            startActivity(myIntent);
        }
    });
    Button Btn3 = (Button) findViewById(R.id.button3);
    Btn3.setOnClickListener(new OnClickListener() {
        public void onClick(View Button) {
            Intent myIntent = new Intent(getActivity(), page3.class);
            startActivity(myIntent);
        }
    });
} 
```

并且您的 page1、page2 等活动中将有类似的 onClickListeners 以进一步导航。

# javascript - jQuery Calendar 时间选择建议

> ID：14527260
> 
> 赞同：3
> 
> 时间：2013-01-25T17:33:53.460
> 
> 标签：javascript, jquery, css, jquery-plugins, twitter-bootstrap

这听起来像是另一个“我应该使用什么日历插件”。它有点像，但是我正在寻找一些相当具体的东西，我希望有人会对我可以开始的东西提出建议。

我需要创建日期和时间的布局。类似于任何日历程序中的每周视图，但如您在图像中看到的略有不同。

我有一个来自服务器 API 调用的日期、存储开放时间和可用时隙的列表，我需要将此列表呈现给用户并允许他们选择一个时隙。

如果有一个 jQuery 插件或控件可能是一个很好的起点，请告诉我。目前，我正在使用 Bootstrap 表并对其进行自定义。

最终结果不必完全匹配这个设计，但显然越接近越好（如果我可以自定义或主题化控件）。

一个类似的例子，尽管设计非常不同，是天才吧预约时间选择器，这很好，但我找不到他们使用的控件。

![时隙选择器](../Images/2fe1a7dc827b8cdf6dd2554316f5d9f5.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-30T16:46:33.513

正如我上面提到的，我最终使用良好的旧表格和 CSS 创建了自己的表格。

由于这是一个 Rails 应用程序，我根据可用的时间段在服务器上自定义 HTML 视图。我还使用 Ruby 自动生成工作日和日期。

在 HAML 视图中：

```
%table
  %thead
    %tr
      %th
        .day-of-week= Time.now.strftime("%A")
        .date= Time.now.strftime("%b %e")
      %th
        .day-of-week= (Time.now + 1.day).strftime("%A")
        .date= (Time.now + 1.day).strftime("%b %e")
      ...
  %tbody
    %tr
      - (1..7).each do
        %td.closed 6:00 am
    %tr
      - (1..7).each do
        %td.available 7:00 am
    ... 
```

在 CSS 中：

```
table {
  border-collapse: separate;
  border-spacing: 20px 10px;

  tbody tr td {
    &.closed {
      color: lightgray;
    }

    &.unavailable {
      color: #777;
      background-color: lightgray;
      border-radius: 15px;
    }

    &.available {
      cursor: pointer;

      &:hover {
        color: white;
        background-color: blue;
        border-radius: 15px;
      }
    }
  }
} 
```

仍在处理标题图像/ css 渐变，但我使用的占位符给出了正确的想法。我还需要添加一个类并使用 jQuery 数据标签来实现选择时隙，但该功能将会出现。这个问题主要是关于控件的设计。

这是我的大部分成品： ![自定义调度程序](../Images/f3bf0092f3101ae6e2cacdd1bf3b6488.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-08-25T03:00:55.960

以下是我过去使用过的一些 jQuery 插件。我真的很喜欢#2（Highcharts）。

[http://www.1stwebdesigner.com/css/top-jquery-chart-libraries-interactive-charts/](http://www.1stwebdesigner.com/css/top-jquery-chart-libraries-interactive-charts/)

# c# - 委托命令在基类而不是派生类上执行

> ID：14527267
> 
> 赞同：0
> 
> 时间：2013-01-25T17:34:33.263
> 
> 标签：c#, inheritance, delegates, command

我想知道是否有人可以对我刚刚解决的问题有所了解。

我有一个基本窗口，它有一个委托命令，该命令触发一种方法，该方法旨在使主窗口中的特定视图可见

假设是数据可能已损坏并且给定视图可能无法使用，因此我有一个用户控件，它显示错误消息并有一个按钮触发此命令以切换到数据所在的更低级别的视图可以纠正。

然后我继承基本窗口，在我的派生窗口中，我有一个选项卡控件，每个都有不同的视图。我重写了 switch 方法以切换到包含我的低级视图的选项卡项。

然后在其他选项卡上，我使用按钮实现用户控件。

我面临的问题是，在第一个选项卡上，按钮工作正常，但是在每个后​​续选项卡上，执行方法总是调用基类方法，而不是派生类方法。

我更改了选项卡的顺序，它始终是第一个正常工作的选项卡，以及无法调用派生方法的后续选项卡。

我可以通过将命令更改为 RoutedCommand 来解决问题，然后执行总是调用派生方法。

但是我对为什么委托命令不起作用以及为什么我看到上述行为感到困惑？

任何见解将不胜感激。

* * *

是的，我想代码可能有用:) 我添加了一些可能有助于表明我的意图的代码片段。

请注意，我尝试了此代码的许多不同变体，包括使用非静态委托命令和使用自定义委托命令（不是来自 prism），但似乎只有使用路由命令才有效

基础窗口：

```
 public static DelegateCommand<object> SwitchToXmlOnError;

    public WindowBase()
    {

        SwitchToXmlOnError = new DelegateCommand<object>(SwitchToXml, CanSwitch);
        this.CommandBindings.Add(new System.Windows.Input.CommandBinding(SwitchToXmlOnError));
    }

protected bool CanSwitch(object e)
{
    return true;
}

protected void SwitchToXml(object e)
{
    this.SwitchToXmlErrorExecute(e);
}

protected virtual void SwitchToXmlErrorExecute(object sender)
{
    //To be implemented by derived class
} 
```

派生窗口：

```
protected override void SwitchToXmlErrorExecute(object sender)
{
    //some code to change selected tab item
} 
```

用户控件中的按钮：

```
<Button x:Name="lnkOpenXmlDocument" BorderThickness="0" Content="Switch To Xml" Command="inf:WindowBase.SwitchToXmlOnError" CommandParameter="{Binding XmlValidationException}" /> 
```

在其他视图中实现的用户控件：

```
 <appCtrl:XmlErrorCtrl >
                        <appCtrl:XmlErrorCtrl.Style>
                            <Style TargetType="{x:Type appCtrl:XmlErrorCtrl}">
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding IsXmlValid}" Value="True">
                                        <Setter Property="Visibility" Value="Collapsed" />
                                    </DataTrigger>
                                    <DataTrigger Binding="{Binding IsXmlValid}" Value="False">
                                        <Setter Property="Visibility" Value="Visible" />
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </appCtrl:XmlErrorCtrl.Style>
                    </appCtrl:XmlErrorCtrl> 
```

我的主窗口上的选项卡控件：（自定义选项卡控件只是带有 SelectedItemChanging 事件的继承选项卡控件

```
<Grid>
    <ctrl:CustomTabControl x:Name="MainTabControl" SelectionChanging="MainTabControl_SelectionChanging_1" >
        <ctrl:CustomTabItem x:Name="GeneralTabItem" Header="{Binding GeneralTabVM.Title}" >
            <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Auto">
                <view:GeneralTabEnhancedView x:Name="generalDetailsView" MinHeight="650" MinWidth="700" />
            </ScrollViewer>
        </ctrl:CustomTabItem>
        <ctrl:CustomTabItem x:Name="SetingsTabItem" Header="{Binding SettingTabVM.Title}" >
            <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Auto">
                <view:SettingsView x:Name="settingsView" MinHeight="400"  />
            </ScrollViewer>
        </ctrl:CustomTabItem>
        <ctrl:CustomTabItem x:Name="XmlTabItem"  DataContext="{Binding XMLEditorTabVM}" Header="{Binding Title}" >
            <editor:SyntaxEditor x:Name="MainXmlEditor"
                                 IsReadOnly="{Binding ElementName=DataQueryView, Path=IsReadOnly}" 
                                 Foreground="Black" SyntaxHighlighting="XML" Document="{Binding XmlDocument}"
                                 Loaded="MainXmlEditor_Loaded_1" Unloaded="MainXmlEditor_Unloaded_1"/>
        </ctrl:CustomTabItem>
    </ctrl:CustomTabControl>
</Grid> 
```

# php - Zend Framework 第一次从一开始就设置它

> ID：14527269
> 
> 赞同：0
> 
> 时间：2013-01-25T17:34:42.947
> 
> 标签：php, zend-framework

好的，不确定这个问题是否适合这里。但无论如何我都会问。我知道 Zend 是一个 MVC，并且几乎所有 MVC 的 Zend 或我使用或安装的其他工具都带有大量文件和您期望的核心目录结构。例如，我工作的公司目前使用 Zend，他们和我工作过的所有其他使用 Zend 的公司一样，都共享一个类似的文件夹结构：

```
IE:
  application
  config
  controllers
  data
  library
  model
  views
  webroot 
```

但是去 Zend 站点，下载 ZF2 包我解压它，我只看到几个 Zend 中构建的东西的例子。但是没有任何关于这样的结构，然后我发现我必须做一些骨架构建或其他什么，我尝试了，但仍然没有看到类似的东西。所以我的问题是，我做错了什么吗？还是我从那里获取了错误的东西？想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T18:44:05.067

ZF2 的目录结构与 ZF1 不同。主要区别在于 ZF2 应用程序是按模块组织的。每个模块基本上都有自己的模型、视图和控制器目录。

获得“正确”文件结构的最快方法可能是开始在[ZendSkeletonApplication](https://github.com/zendframework/ZendSkeletonApplication)之上构建您的应用程序。同时查看其他模块（例如[ZF2 模块目录](http://modules.zendframework.com/)）可能有助于更好地理解 ZF2 的目录结构。[以ZfcUser](https://github.com/ZF-Commons/ZfcUser)模块为例：它包含一个简单的用户认证模块，[带有控制器](https://github.com/ZF-Commons/ZfcUser/tree/master/src/ZfcUser/Controller)、[数据模型](https://github.com/ZF-Commons/ZfcUser/tree/master/src/ZfcUser)和[视图](https://github.com/ZF-Commons/ZfcUser/tree/master/view)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T18:04:15.150

您给出的文件结构大致是 ZF **1**应用程序的标准文件结构。如果您查看 ZF1 手册，您将在那里看到相同的文件结构：http: [//framework.zend.com/manual/1.12/en/project-structure.project.html](http://framework.zend.com/manual/1.12/en/project-structure.project.html)。ZF2（当前版本）的工作方式略有不同。

# html - 在 SPAN 内垂直居中文本

> ID：14527270
> 
> 赞同：1
> 
> 时间：2013-01-25T17:34:43.727
> 
> 标签：html, css

![在此处输入图像描述](../Images/c51fc0ccd1cc0a8bdd8c09733580120f.png)

像我上面指定的图片一样，里面的`span`空间更少，空间`top`更多`bottom`，我不知道发生这种情况的原因。我的要求是准确地显示该文本的中心`span`。我试图设置`margin-top`（`span`是一个`inline`元素，它不会支持`margin-top`）`line-height`等。但似乎没有任何效果。我的问题是我们可以将文本垂直居中在一个准确的 [和]`span`上的相等空格中吗？`top``bottom`

## [演示](http://jsfiddle.net/DPfcq/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T17:46:43.843

是的，您可以在跨度内准确地垂直居中文本。你会想略读这个，这篇文章详细说明：http: [//phrogz.net/css/vertical-align/index.html](http://phrogz.net/css/vertical-align/index.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T17:50:29.887

您可以使用 padding-top，希望对您有所帮助。

# pentaho - 使用 pentaho 解析文本文件

> ID：14527272
> 
> 赞同：1
> 
> 时间：2013-01-25T17:34:57.363
> 
> 标签：pentaho, kettle

我有大量文本文件需要加载到数据库中。它们的结构不是更常见的 csv 格式，而是如下所示：

```
TY  - JOUR
T1  - On the Structure and Life-History of Entyloma ranunculi (Bonorden)
JF  - Philosophical Transactions of the Royal Society of London. B (1887-1895)
VL  - 178
SP  - 173
EP  - 185
PY  - 1887/01/01/
UR  - http://dx.doi.org/10.1098/rstb.1887.0008
M3  - doi:10.1098/rstb.1887.0008
AU  - Ward, H.
ER  - 
```

其中每一行是一个不同的字段，字段名称由前导字符表示。

我想做的是将每一行加载到记录中的相应字段中。我想通过 pentaho 做到这一点，任何人都知道如何做到这一点。文本输入步骤是为 csv 输入设置的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-29T00:16:05.300

那个文本样本看起来非常熟悉......

*匆匆忙忙去检查一些东西*

如果该文本示例是我认为的“皇家科学学会期刊描述文件”，那么您将无法编写 pentaho 脚本来解析这些内容。

我去过那里，试过了，很痛苦，很痛苦。

为什么？

很多事情。

首先，文件格式**没有**经过严格检查，因此您会**找到**一些没有 2 个字符 ID 后跟 2 个空格、破折号 1 个空格和数据格式行的文件。

您还会发现一些文件中包含**未解析的 LATEX 命令**和/或未**处理的变量替换**。

简而言之，这些文件（至少是我上次用这些文件做任何事情时查看的文件）处于可怕的状态。

您将遇到的另一个主要问题是缺少行。

每个描述符应该有 11 个主要标签，如下所示：

```
TY
T1
JF
VL
SP
EP
PY
UR
M3
AU
ER 
```

从记忆中是：

```
TY - Title
T1 - Description
JF - ???
VL - Volume number
SP - Start page
EP - End page
PY - Published Year
UR - Url
M3 - ???
AU - Author name
ER - ??? 
```

您经常会发现并非所有这些行都存在，但要使列在 CSV 中对齐，您仍然需要添加空白条目。

还要注意 AU 字段，它可以而且经常确实包含文件的多个条目，因此您经常会得到：

```
TY  - ....
T1  - ....
....
AU  - ....
AU  - ....
.... 
```

使用上面 Carey 回答中的 pentaho 方法处理这个问题会使你的很多行不同步，因为每个文件的每个标签都会有一行

关于凯莉的答案，我不得不说这是一个非常好的答案，并且比我放弃之前所做的更接近于进行良好的转换，但冷酷的事实是文件只是不适合由pentaho可靠地处理。

对此，我拖出了我写的一些 C# 来获取一个装满这些文本文件的文件夹并将它们转换为扁平的 CSV。

生成的 CSV 并不完美，仍然需要进行少量调整，但它会让你完成 99.9% 的工作，并且使用 pentaho 处理生成的文件比使用源文件本身更容易。

代码是相当通用的 C#，所以它应该在 windows 和 mono 上编译（虽然我不得不承认，我没有在后面测试它）

这是代码：

```
using System.Collections.Generic;
using System.IO;
using System.Text.RegularExpressions;

namespace SciDataParse
{
  class RecordData
  {
    public string TY { get; set; }
    public string T1 { get; set; }
    public string JF { get; set; }
    public string VL { get; set; }
    public string SP { get; set; }
    public string EP { get; set; }
    public string PY { get; set; }
    public string UR { get; set; }
    public string M3 { get; set; }
    public List<string> AU { get; set; }
    public string ER { get; set; }

    public RecordData()
    {
      AU = new List<string>();
      TY = string.Empty;
      T1 = string.Empty;
      JF = string.Empty;
      VL = string.Empty;
      SP = string.Empty;
      EP = string.Empty;
      PY = string.Empty;
      UR = string.Empty;
      M3 = string.Empty;
      ER = string.Empty;
    }
  }

  class Program
  {
    static RecordData ProcessFile(string inputName)
    {
      RecordData result = new RecordData();

      using (StreamReader reader = new StreamReader(inputName))
      {
        string inputLine = reader.ReadLine();
        while(!string.IsNullOrEmpty(inputLine))
        {
          if (!Regex.IsMatch(inputLine, @"^[A-Z,0-9][A-Z,0-9]\s+-\s+.*$"))
          {
            inputLine = reader.ReadLine();
            continue; // Regex match to ensure lines are valid format
          }
          string[] lineItems = inputLine.Split('-');
          string tag = lineItems[0].Trim();
          string data = lineItems[1].Trim();
          switch (tag)
          {
            // Sort and add lines to our result object.  Note we check and change null to empty strings and filter commas
            // so that we don't create any problems with outputting CSV data
            case "TY" :
              result.TY = !string.IsNullOrEmpty(data) ? data : string.Empty;
              break;

            case "T1":
              result.T1 = !string.IsNullOrEmpty(data) ? data.Replace(",", string.Empty) : string.Empty;
              break;

            case "JF":
              result.JF = !string.IsNullOrEmpty(data) ? data.Replace(",", string.Empty) : string.Empty;
              break;

            case "VL":
              result.VL = !string.IsNullOrEmpty(data) ? data : string.Empty;
              break;

            case "SP":
              result.SP = !string.IsNullOrEmpty(data) ? data : string.Empty;
              break;

            case "EP":
              result.EP = !string.IsNullOrEmpty(data) ? data : string.Empty;
              break;

            case "PY":
              result.PY = !string.IsNullOrEmpty(data) ? data : string.Empty;
              break;

            case "UR":
              result.UR = !string.IsNullOrEmpty(data) ? data : string.Empty;
              break;

            case "M3":
              result.M3 = !string.IsNullOrEmpty(data) ? data : string.Empty;
              break;

            case "AU":
              // AU = Author items of which there can be multiple, note we also replace blank author names with "Unknown"
              result.AU.Add(!string.IsNullOrEmpty(data) ? data.Replace(",", string.Empty) : "Unknown");
              break;

            case "ER":
              result.ER = !string.IsNullOrEmpty(data) ? data : string.Empty;
              break;
          }
          inputLine = reader.ReadLine();
        }
      }

      return result;
    }

    static void Main()
    {
      List<RecordData> fileRecords = new List<RecordData>();
      List<string> headerColumns = new List<string> {"TY", "T1", "JF", "VL", "SP", "EP", "PY", "UR", "M3", "AU", "ER"};

      string baseFolder = Directory.GetCurrentDirectory();

      string[] fileNames = Directory.GetFiles(baseFolder, "*.txt");

      foreach (string fileName in fileNames)
      {
        fileRecords.Add(ProcessFile(fileName));
      }

      using (StreamWriter writer = new StreamWriter("consolodated_data.csv"))
      {
        string headerRow = string.Join(",", headerColumns);
        writer.WriteLine(headerRow);

        foreach (RecordData fileRecord in fileRecords)
        {
          string fileLine = string.Empty;
          fileLine += fileRecord.TY + ",";
          fileLine += fileRecord.T1 + ",";
          fileLine += fileRecord.JF + ",";
          fileLine += fileRecord.VL + ",";
          fileLine += fileRecord.SP + ",";
          fileLine += fileRecord.EP + ",";
          fileLine += fileRecord.PY + ",";
          fileLine += fileRecord.UR + ",";
          fileLine += fileRecord.M3 + ",";
          fileLine += string.Join("|",fileRecord.AU) + ","; // Join author names with a |
          fileLine += fileRecord.ER;
          writer.WriteLine(fileLine);
        }
      }

    }
  }
} 
```

*编译文件，然后将生成的 EXE 复制到所有 txt 文件所在的文件夹中并运行它。*

现在，在你们中的任何 C# 纯粹主义者开始跳入这里并挑剔我的代码之前，请注意这一点...

A）它是前一段时间写的，作为解决我遇到的问题的快速工具，它从来都不是生产代码。

B）是的，我知道有更好的方法来做事情，例如字符串构建器与连接，请参见 A 点

C）如果您确实进来并开始在我的代码中挑毛病，而不是试图帮助 OP 解决他的问题（就像我一样），那么您只是一个无所事事的混蛋。

D）你试图用我的代码指出的任何错误都不会导致我失眠，因为坦率地说，我不在乎。它有效，我知道它有效（因为它做了我当时需要它做的事情），这就是我所关心的。

回到OP的问题。

正如我所说，它并不完美，您将不得不进行最少的编辑。

你必须做的任何编辑，你会想要使用纯文本编辑器，如果内存服务一些描述行非常长并且会超过 excel 中可用的最大列宽，从而导致一行'### ################'

您当然可以使用 pentaho 将 CSV 直接导入数据库，然后编辑其中的记录以整理数据（我就是这样做的）

最后要注意的一件事是，作者姓名（或至少在有多个姓名的情况下）使用 | 连接。字符放入“AU”标签下的一个 CSV 字段中，因此当您进一步处理它们时，您可能需要考虑将它们放在自己的表中，并使用自己的 ID 和指向源记录的外键对它们进行反规范化.

如果你不能编译它（或不想编译它）给我写信，告诉我你的平台，我会为你构建它并将二进制文件发送给你。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-27T01:18:32.143

您需要使用 Row Denormaliser 步骤对行进行非规范化。

脚步：

1.  使用您的文本文件输入将数据读入一个字段

2.  使用字段拆分器拆分“-”上的字段

3.  对组字段上的数据进行排序（我没有在您的示例中识别组 ID）。如果没有可用的组 ID，那么希望每个组的行数固定，然后您可以添加计算的组 ID

4.  将行传递给 Row Normaliser 并指定以下内容：

    4.1。将您的组 ID 字段添加到组 ID 到组 ID 规范中。

    4.2\. 在字段中为您需要的每一行添加目标字段名称。我在
    TY、T1、JF 等的示例中添加了 11 个。它们可以是您选择的任何名称。

    4.3\. 为每个新字段指定值字段名称，您分配给
    拆分产生的第二个字段的字段。在字段拆分器的示例中，我分配了两个字段 - fld_hdr 和 fld_content。我的值字段包含 fld_content fld。

    4.4\. 指定字段类型和可选的每行上的剩余列。

我创建了一个示例，但看不到在哪里上传 ktr 文件。

# javascript - bootstrapx-clickover HTML 内容？

> ID：14527276
> 
> 赞同：0
> 
> 时间：2013-01-25T17:35:09.483
> 
> 标签：javascript, jquery, html, twitter-bootstrap

我正在使用[Bootstrapx-Clickover](http://www.leecarmichael.com/bootstrapx-clickover/examples.html)

为点击运行此 javascript：

```
var message = "Access Forbidden.</br> <a href=\"/contact/access\">Request Access!</a>";
$("#spec").clickover({placement:'top', title: "Sensitive information", content: message, width: 170, height: 110}); 
```

HTML 内容不会呈现：

![在此处输入图像描述](../Images/39419a36ec74b51dd305d7cc29d7b5d4.png)

它曾经与**bootstrap 2.1**一起使用，但现在我升级到**2.2**。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T18:22:17.920

如[本期](https://github.com/lecar-red/bootstrapx-clickover/issues/25)所述，您需要添加`html: true`点击选项。

```
$("#spec").clickover({placement:'top', title: "Sensitive information", content: message, width: 170, height: 110, html: true}); 
```

# java - 如何正确解析 RFC 日期？

> ID：14527277
> 
> 赞同：1
> 
> 时间：2013-01-25T17:35:14.220
> 
> 标签：java, simpledateformat

如 SimpleDateFormat 的 JavaDoc 页面上的示例表（倒数第二个条目）中所述，[这](http://docs.oracle.com/javase/1.4.2/docs/api/java/text/SimpleDateFormat.html)应该可以工作：

```
 try {
        System.out.println(new SimpleDateFormat("EEE, d MMM yyyy HH:mm:ss Z")
            .parse("Wed, 4 Jul 2001 12:08:56 -0700"));
    } catch (ParseException e) {
        e.printStackTrace();
    } 
```

但它返回：

```
java.text.ParseException: Unparseable date: "Wed, 4 Jul 2001 12:08:56 -0700"
    at java.text.DateFormat.parse(DateFormat.java:337)
    at de.newsclient.News.main(News.java:42) 
```

这里发生了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T17:37:46.690

这对我来说可以。但是，我建议您使用`dd`for date 而不是简单的`d`.

# ruby-on-rails-3 - 在 routes.rb 中添加 Rack::Offline 配置时出现 Capistrano 错误的 Rails 3.2 部署

> ID：14527278
> 
> 赞同：0
> 
> 时间：2013-01-25T17:35:15.600
> 
> 标签：ruby-on-rails-3, capistrano

在添加之前，我的部署很好......我将以下代码添加到 routes.rb 中，在开发中运行良好，但是在远程服务器 w Capistrano 上再次部署时，部署失败：

```
routes.rb
   Workshop::Application.routes.draw do

    if Rails.env.production?
      offline = Rack::Offline.configure :cache_interval => 120 do      
         cache ActionController::Base.helpers.asset_path("application.css")
         cache ActionController::Base.helpers.asset_path("application.js")
         # cache other assets
         images = ["favicon.ico", "empty_boxes.png", "isabelle.png", "loading.gif", "errors/not_found.jpg", "errors/access_denied.jpg", "gallery/black.png"]
         images.each do |image|
           cache ActionController::Base.helpers.asset_path(image)
          end
         ...
      end 
      ... other routes ..
   end 
```

部署错误与任何缓存操作有关是这个块：

```
 * executing "cd -- /var/www/vhosts/ceramique-isabelle.fr/rails/workshop/
   releases/2013.... && bundle exec rake RAILS_ENV=production 
    RAILS_GROUPS=assets assets:precompile && cp --
  /var/www/vhosts/ceramique-isabelle.fr/rails/workshop/shared/assets/manifest.yml
 /var/www/vhosts/ceramique-isabelle.fr/rails/workshop/releases/2013../assets_manifest.yml"

  servers: ["ceramique-isabelle.fr"]
       [ceramique-isabelle.fr] executing command
       ** [out :: ceramique-isabelle.fr] rake aborted!
        [out :: ceramique-isabelle.fr] application.css isn't precompiled 
```

如果我抑制了一些缓存行，那么它会在以下情况下失败

```
 [out :: ceramique-isabelle.fr] application.js isn't precompiled
         or removing the cache for application.js , it fails on the nex ...
        [out :: ceramique-isabelle.fr] favicon.ico isn't precompiled 
```

有没有办法避免这个错误..我会尝试部署这个块然后再次插入它并再次重新部署，但我想它也会在远程服务器预编译期间失败

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T17:52:46.823

它与此块无关.....而是与 css 预编译错误有关...我尝试在本地进行预编译，但出现错误

“...-border-radius:”后的无效 CSS：预期的伪类或伪元素，为“10px;”

去哪里搜索并修改它....

对不起坏道

# c# - 模拟在非活动进程中按住一个键

> ID：14527282
> 
> 赞同：1
> 
> 时间：2013-01-25T17:35:29.407
> 
> 标签：c#, .net

我正在通过谷歌搜索，找不到任何可行的东西......到目前为止最好的代码如下：

```
Process proc = Process.GetProcessesByName("firefox")[0];
IntPtr ptrFF = proc.Handle;
SetForegroundWindow(ptrFF);
SendKeys.SendWait("{F1}"); 
```

但这并不是我所需要的。这将 Firefox 带到前面并发送一次密钥，但我需要按住密钥，并在非活动进程/最小化窗口上工作。我怎样才能做到这一点？

# c# - 使用生成器对工厂进行单元测试

> ID：14527285
> 
> 赞同：0
> 
> 时间：2013-01-25T17:35:43.133
> 
> 标签：c#, unit-testing, tdd, nunit

我有一个`Factory`类，它使用一个`Generator`类（其中会有几个，每个都有不同的算法）来生成对象数组。我正在尝试使用 TDD 方法对此进行编程，但在决定测试时遇到了很大困难。我才刚刚开始使用 TDD，所以我想我的测试实际上是丑陋的可憎之物。

这些是我对以下内容的测试`Factory`：

```
[TestFixture]
public class MapRegionFactoryTests
{
    [Test,
     Description("Tests if a MapRegion is successfully created.")]
    public void TestBasicRegionCreation()
    {
        var mapRegionFactory = new MapRegionFactory();
        MapRegion mapRegion = mapRegionFactory.GenerateMapRegion();

        Assert.IsTrue(mapRegion != null);
    }

    [Test,
     Description("Tests if a MapRegionFactory's RegionSizeX, RegionSizeY and RegionSizeZ are properly initialized" +
                 "to their default values.")]
    public void TestDefaultPropertyInitialization()
    {
        var mapRegionFactory = new MapRegionFactory();

        Assert.Greater(mapRegionFactory.RegionSizeX, 0);
        Assert.Greater(mapRegionFactory.RegionSizeY, 0);
        Assert.Greater(mapRegionFactory.RegionSizeZ, 0);
    }

    [Test,
     Description("Tests if properties can only be assigned numbers above zero.")]
    public void TestGreaterThanZeroPropetyAssignment()
    {
        var mapRegionFactory = new MapRegionFactory
                               {
                                   RegionSizeX = -8,
                                   RegionSizeY = -3,
                                   RegionSizeZ = 0
                               };

        Assert.Greater(mapRegionFactory.RegionSizeX, 0);
        Assert.Greater(mapRegionFactory.RegionSizeY, 0);
        Assert.Greater(mapRegionFactory.RegionSizeZ, 0);
    }

    [Test,
    Description("Tests if the default RegionFactory can deliver a region filled with tiles.")]
    public void TestRegionCount()
    {
        // Test the count of objects again?
    }
} 
```

和一个单一的测试`Generator`：

```
[TestFixture]
public class MapRegionGeneratorTests
{
    [Test,
     Description("Tests that a region of a certain size is properly filled with Block objects.")]
    public void TestDefaultRegionSize()
    {
        const int regionSize = 16;

        var mapRegionGenerator = new MapRegionGenerator();

        var regionData = mapRegionGenerator.GenerateRegion(regionSize);

        foreach (Block element in regionData)
        {
            Assert.IsNotNull(element);
        }
    }
} 
```

到目前为止，我是否正确地接近这个？我知道这`MapRegionFactory`将`IMapRegionGenerator`通过 Castle.Windsor 进行注入，但是我如何模拟像生成器这样复杂的东西呢？我无法复制整个生成代码，不是吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T19:22:57.790

Why not use **constructor injection**, i.e. pass an instance of `IMapRegionGenerator` type to the constructor of `MapRegionFactory` class?

```
class MapRegionFactory
{
    public MapRegionFactory(IMapRegionGenerator generator)
    {
        ...
    }

    ...
} 
```

After this you can create mock for the `IMapRegionGenerator` type and pass it for testing.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-26T15:36:46.207

I don't know enough about your code to know exactly how this test should look, but it ought to give you a basic idea of how to test the factory with a mock generator.

```
[Test]
public void RegionFactoryDelegatesToRegionGenerator()
{
    var mockGenerator = new Mock<IMapRegiongenerator>();
    var factory = new MapRegionFactory(mockGenerator.Object);

    var expectedRegion = new Region();
    var regionSize = CreateRandomRegionSize();
    mockGenerator.Setup(g=>g.GenerateRegion(regionSize)).Returns(expectedRegion);

    factory.SetRegionSize(regionSize);
    Assert.That(factory.GetRegion(), Is.SameAs(expectedRegion));
} 
```

> how do I mock something as complex as a generator? I can't replicate the whole generating code, no?

For the purpose of testing the factory, you just have to ensure that it uses the generator correctly, whatever correctly means. Your tests, like your production code for the factory, don't and should not care how a generator works, just that it fulfills its contract and returns a Region.

# c# - C# 正则表达式匹配表情符号

> ID：14527292
> 
> 赞同：3
> 
> 时间：2013-01-25T17:35:56.363
> 
> 标签：c#, regex, emoji

我想要一个正则表达式来匹配 C# 中的表情符号字符。如果重要的话，那就是来自 Windows 8 触摸键盘的字符，即。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-25T17:42:37.823

似乎有一个 Emoji-to-Unicode 标准：

[http://en.wikipedia.org/wiki/Emoji#Emoji_in_the_Unicode_standard](http://en.wikipedia.org/wiki/Emoji#Emoji_in_the_Unicode_standard)

因此，您可能可以匹配每个 Unicode 范围。例如，要匹配从 U+1F30x 到 U+1F5Fx 的范围，您可以使用`[\u1F30-\u1F5F]`等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T17:44:03.803

您应该能够插入 unicode 代码值来表示它们：

```
Regex regEx = new Regex(@"\uXXXX\uYYYY"); 
```

您要查找的字符的 unicode 值在哪里`XXXX`以及在哪里`YYYY`（当然要更改正则表达式以满足您的需要）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-12-09T20:56:40.097

我为这个问题使用了 Unicode 通用类别和命名块，并在接受的答案下方的简短评论中对其进行了描述：

> 我试图匹配 ✅ 并看到了这个问题。但答案并没有解决我的问题。最后我将它用于正则表达式模式 `\p{So}`

有关命名块和 Unicode 常规类别的更多信息，请访问[Microsoft 正则表达式帮助主题](https://docs.microsoft.com/en-us/dotnet/standard/base-types/character-classes-in-regular-expressions#SupportedNamedBlocks)。

您可以为 BasicLatin、ExtendedLatin、Arabic、Cyrilic 和 ... 使用不同的名称，还可以使用与`S`家庭匹配的更具体的符号，如货币符号或数学符号。

# c - 如何打印 2 个双精度数组，第二个应该是第一个数组元素的累积总数，在 1 个循环中？

> ID：14527299
> 
> 赞同：0
> 
> 时间：2013-01-25T17:36:17.757
> 
> 标签：c

在书中他说可以使用嵌套循环或 1 循环

用户应为程序提供 8 个双精度数，以在第二个数组中设置累计总数。

这是代码：

```
#include <stdio.h>
#define ASIZE 8

int main()

{
    int index = 0, x, index2;
    double cal;
    double array1[ASIZE], array2[ASIZE];

    printf("Please enter 8 numbers:\n");
    for (index = 0; index < ASIZE; index++)//adding the numbers to the first array 
    {
        scanf("%lf", &array1[index]);
    }

    for (x = 0,index2 = 0,index = 0; x < ASIZE; x++, index2++)//adding the second array the elements
    {
        cal += array1[index++];
        array2[index2] = cal;
    }

    printf("the first array numbers are:\n");//printing the first array numbers 
    for (index = 0; index < ASIZE; index++)
    {
        printf("%.1lf ", array1[index]);
    }
    printf("\n");
    printf("\n");
    printf("the second array numbers are:\n");//printing the second array
    for (index2 = 0; index2 < ASIZE; index2++)
    {
        printf("%.1lf ", array2[index2]);
    }

} 
```

我是 C 的初学者，知道如何变得更好对我来说很重要。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T17:44:43.223

假设您的问题是使用嵌套循环或 1 个循环。当您获得输入时，您可以在一个循环中执行此操作

```
for (index = 0; index < ASIZE; index++)//adding the numbers to the first array 
    {
        scanf("%lf", &array1[index]);
        cal += array1[index];
        array2[index] = cal;
    } 
```

事实上，您可以在同一个`for`循环中打印两个数组。

# android - 定义构造函数

> ID：14527300
> 
> 赞同：0
> 
> 时间：2013-01-25T17:36:17.907
> 
> 标签：android, constructor

TapkeysActivity.java 在“tapdb hon = new tapdb(this);”处出错 . 它告诉定义构造函数 tapdb(new View.OnClickListener(){})。请告诉我如何定义构造函数。相关代码如下：

TapkeysActivity.java

```
package com.android.tusway;

import android.app.Activity;
import android.os.Bundle;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.EditText;
import android.widget.TextView;

public class TapkeysActivity extends Activity  {

private EditText et;
private Button b1,b2,b3,b4,bspace;
private String stringDb="";
private TextView tv;

private void updateTextField() {
    tv.setText(this.stringDb);

}

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

        setContentView(R.layout.main);
        // adjusting key regarding window sizes

        et = (EditText) findViewById(R.id.editText1);

        b1 = (Button) findViewById(R.id.button1);
        b2 = (Button) findViewById(R.id.button2);
        b3 = (Button) findViewById(R.id.button3);
        b4 = (Button) findViewById(R.id.button4);
        bspace = (Button) findViewById(R.id.btspace);

        tv = (TextView) findViewById(R.id.textView1);

        b1.setOnClickListener(new OnClickListener() {

            @Override
            public void onClick(View v) {
                stringDb += "1";
                updateTextField();  

            }
        });

        b2.setOnClickListener(new OnClickListener() {

            @Override
            public void onClick(View v) {
                stringDb += "2";
                updateTextField();  

            }
        });

        b3.setOnClickListener(new OnClickListener() {

            @Override
            public void onClick(View v) {
                stringDb += "3";
                updateTextField();  

            }
        });

        b4.setOnClickListener(new OnClickListener() {

            @Override
            public void onClick(View v) {
                stringDb += "4";
                updateTextField();  

            }
        });

        bspace.setOnClickListener(new OnClickListener() {

            @Override
            public void onClick(View v) {
                stringDb += " ";
                updateTextField();

                long l = Long.parseLong(stringDb);
                tapdb hon = new tapdb(this);
                hon.open();
                String returnedWord = hon.getWord(l);

                hon.close();

                et.setText(returnedWord);

            }
        });

}
   } 
```

Tapdb.java

```
 package com.android.tusway;

 import android.content.Context;
 import android.database.Cursor;
 import android.database.sqlite.SQLiteDatabase;
 import android.database.sqlite.SQLiteOpenHelper;

 public class tapdb {

public static final String KEY_ROWID="_id";
public static final String KEY_CODE="key_code";
public static final String KEY_WORD="word";

public static final String DATABASE_NAME="tapdatabase";
public static final String DATABASE_TABLE="tapData";
public static final int DATABASE_VERSION=1;

private DbHelper ourHelper;
private final Context ourContext;
private SQLiteDatabase ourDatabase;

private static class DbHelper extends SQLiteOpenHelper{

    public DbHelper(Context context) {
        super(context,DATABASE_NAME, null, DATABASE_VERSION);

    }

    @Override
    public void onCreate(SQLiteDatabase db) {

        db.execSQL("CREATE TABLE" + DATABASE_TABLE + "(" +
                KEY_ROWID + "INTEGER PRIMARY KEY AUTOINCREAMENT,"+
                KEY_WORD + "TEXT NOT NULL" +
                KEY_CODE + "LONG);"

        );

    }

    @Override
    public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
        // TODO Auto-generated method stub
        db.execSQL("DROP TABLE IF EXISTS" + DATABASE_TABLE );
        onCreate(db);

    }

}
public tapdb (Context c) {
    ourContext = c;
  }

public tapdb open(){
    ourHelper = new DbHelper(ourContext);
    ourDatabase = ourHelper.getWritableDatabase();
    return this;
}

public void close(){
    ourHelper.close();

}

public String getWord(long l) {
    String[] columns = new String[] {KEY_ROWID, KEY_WORD, KEY_CODE};
    Cursor c = ourDatabase.query(DATABASE_TABLE, columns, KEY_ROWID + "=" + l, null, null, null, null);

    if (c != null) {
            c.moveToFirst();
            String hotness = c.getString(1);

            return hotness;
    }

    return null;
} 
```

}

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-25T17:38:38.573

改变

```
tapdb hon = new tapdb(this); 
```

至

```
tapdb hon = new tapdb(TapkeysActivity.this); 
```

或者

```
tapdb hon = new tapdb(v.getContext()); 
```

当您在匿名内部类中时，`this`不引用 Actviity 实例（在这种情况下，因为您在 中`OnClickListener`，所以`this`引用您的`OnClickListener`实例）因此，您必须通过`TapkeysActivity.this`或 via显式访问它`v.getContext()`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-25T17:39:04.773

改变这一行，

```
tapdb hon = new tapdb(this); 
```

和

```
tapdb hon = new tapdb(TapkeysActivity.this); 
```

# asp.net - 无法加载文件或程序集 'Microsoft.Office.Interop.Excel，版本 = 14.0.0.0

> ID：14527305
> 
> 赞同：4
> 
> 时间：2013-01-25T17:36:50.583
> 
> 标签：asp.net, excel, iis, dll

我有一个使用 MS Excel 文件读/写的网站。

我在网站的 Bin 文件夹中添加了相关的 dll，它在我的本地主机上运行良好（我想是因为我已经在我的电脑上安装了 MS Excel 2010）

但是当我将它上传到远程电脑并运行该站点时，它会抛出一个错误：

> 无法加载文件或程序集“Microsoft.Office.Interop.Excel，版本=14.0.0.0，Culture=neutral，PublicKeyToken=71e9bce111e9429c”或其依赖项之一。找到的程序集的清单定义与程序集引用不匹配。（来自 HRESULT 的异常：0x80131040）

Bin文件夹中的文件是：

```
Microsoft.Vbe.Interop.dll 
office.dll 
Microsoft.Office.Interop.Excel.dll 
Microsoft.Office.Interop.Excel.xml 
office.xml 
```

我已经在远程电脑上安装了“Microsoft Office 2010：Primary Interop Assemblies Redistributable”， [http://www.microsoft.com/en-us/download/details.aspx?id=3508](http://www.microsoft.com/en-us/download/details.aspx?id=3508)

但同样的错误发生。

如何解决这个问题？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T10:55:15.797

一种方法 - 安装 MS Office (MS Excel)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-09-05T13:25:23.073

我知道这个线程有点旧，但我遇到了同样的错误并且我解决了它（它在我的项目中有效）。

在我的 web.config 文件中，我添加了程序集：

`<add assembly="office, Version=14.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c"/>`和许多其他办公室集会。

我所做的是我已经从 web.config 文件中删除了所有程序集，并添加了 dll 作为参考——在这种情况下是 Microsoft.Office.Interop.Excel.dll。

我不是专家，我只是大声思考 web.config 文件正在尝试提取 dll。来自 C:\Windows\assembly\ 的文件，如果无法找到，则返回错误。

您不必在服务器上安装办公室或其他不必要的东西。

希望这对某人有所帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-01-02T11:56:13.103

在 C# 项目中使用 Excel 的正确过程是：

1.  添加对 Excel 互操作库（程序集）的引用
2.  `using`在部分中添加 Excel
3.  现在在你的编码中使用它。

* * *

* * *

如果您的 PC 中安装了 Office(Excel)，则第一步将起作用。如果没有，则安装。然后添加对`Microsoft.Office.Interop.Excel`您需要的版本的引用。

一种。如果列表未显示所需版本，那么您可能对安装了 Excel 的 Office 有另一种看法。顺便说一句，你可以使用任何。

湾。如果您没有找到类似`Microsoft.Office.Interop`THEN 的内容，则可能是未安装 Office，或者您拥有 Office 2013 或更高版本。对于更高版本，您可以通过进入添加引用窗口的**COM**`Microsoft Excel {version-no} Object Library`选项卡添加程序集并添加. 这将添加相同的内容。

C。如果您已经`Microsoft.Office.Interop...`在带有黄色三角形标记的参考文献中，请先将其删除。

* * *

* * *

之后第二步将完全起作用：`using Excel=Microsoft.Office.Interop.Excel;`

* * *

* * *

最后作为第三步，您可以通过创建 Excel 对象`Excel.Application xlApp = new Excel.Application();`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-11-18T05:02:36.840

您无需安装 MS Office-2010，添加参考 -> COM->“Microsoft office 12.0 Object Libaray”

它对我有用。

# c - 是否有任何 C 预处理器变量？

> ID：14527306
> 
> 赞同：5
> 
> 时间：2013-01-25T17:36:52.487
> 
> 标签：c, variables, c-preprocessor

**C**中是否有类似预处理器变量的东西？它可以简化我的定义。

目前我有这样的事情：

```
typedef struct mystruct {
  int val1;
  int val2;
  int val3;
  int val4;
} MYSTRUCT;

typedef struct mysuperstruct {
  MYSTRUCT *base;
  int val;
} MYSUPERSTRUCT;

#define MY_OBJECT_BEGIN(name, val1, val2, val3, val4) \
  MYSTRUCT name##Base = { val1, val2, val3, val4 }; \
  MYSUPERSTRUCT * name##Objs = {

#define MY_OBJECT_VALUE(name, val) \
  { &(name##Base), val },

#define MY_OBJECT_END() \
  NULL \
}; 
```

它是这样使用的：

```
MY_OBJECT_BEGIN(obj1, 1, 2, 3, 4)
MY_OBJECT_VALUE(obj1, 5)
MY_OBJECT_VALUE(obj1, 6)
MY_OBJECT_VALUE(obj1, 7)
MY_OBJECT_END() 
```

这会产生这样的东西：

```
MYSTRUCT obj1Base = { 1, 2, 3, 4 };
MYSUPERSTRUCT * obj1Objs = {
  { &(obj1Base), 5 },
  { &(obj1Base), 6 },
  { &(obj1Base), 7 },
  NULL
} 
```

很明显，重复使用对象名称是多余的。我想将 MY_OBJECT_BEGIN 定义中的名称存储到某个预处理器变量中，以便我可以通过以下方式使用它：

```
MY_OBJECT_BEGIN(obj1, 1, 2, 3, 4)
MY_OBJECT_VALUE(5)
MY_OBJECT_VALUE(6)
MY_OBJECT_VALUE(7)
MY_OBJECT_END() 
```

标准**C**预处理器是否提供了实现此目的的方法？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-25T18:21:02.240

没有标准的 C 预处理器变量。正如[Oli Charlesworth](https://stackoverflow.com/users/129570/oli-charlesworth)建议的那样，如果您只想使用标准 C 来保留X-Macros，那么使用[X-Macros可能是您最好的选择。如果确实有很多关联数据会涉及多个文件，那么您将需要使用代码生成器，例如](http://en.wikipedia.org/wiki/X_Macro)[GNU 自动生成器](http://www.gnu.org/software/autogen/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-06-24T08:39:43.700

在某处创建一个 H 文件，以清除与您的宏相关的所有可能定义，例如：

```
#ifdef OBJECT
#    undef OBJECT
#endif 
```

然后在项目中的某处为该 H 文件定义：

```
#define CLEAR "whatever/path/you/want/clear.h" 
```

让你的宏使用 OBJECT：

```
#define MY_OBJECT_BEGIN(val1, val2, val3, val4) \
  MYSTRUCT OBJECT##Base = { val1, val2, val3, val4 }; \
  MYSUPERSTRUCT * OBJECT##Objs = {

#define MY_OBJECT_VALUE(val) \
  { &(OBJECT##Base), val },

#define MY_OBJECT_END() \
  NULL \
}; 
```

像这样使用它：

```
#include CLEAR
#define OBJECT obj1
MY_OBJECT_BEGIN(1, 2, 3, 4)
MY_OBJECT_VALUE(5)
MY_OBJECT_VALUE(6)
MY_OBJECT_VALUE(7)
MY_OBJECT_END()

#include CLEAR
#define OBJECT obj2
MY_OBJECT_BEGIN(1, 2, 3, 4)
MY_OBJECT_VALUE(5)
MY_OBJECT_VALUE(6)
MY_OBJECT_VALUE(7)
MY_OBJECT_END() 
```

将明文代码放入自己的文件中可以更轻松地以防您将来可能需要为您的对象定义进行多个定义，因为您只需将明文代码修改添加到一个文件中即可。

我知道这并不理想，但这是您能做的最好的事情，因为您无法使用宏参数以某种方式修改预处理器代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-25T18:25:25.263

这是我能想到的最接近的通用技术，用于跨预处理器定义重用变量：

```
#include <stdio.h>

#define INIT_VALS(SIZE) unsigned int value[SIZE]; unsigned int i = 0;
#define DEFINE_VAL(NEW_VAL) value[i++] = NEW_VAL;
#define PRINT_VAL(INDEX) printf("%d\n", value[INDEX]);

int main()
{
    INIT_VALS(3)
    DEFINE_VAL(42)
    DEFINE_VAL(70)
    DEFINE_VAL(80)
    PRINT_VAL(0)
    PRINT_VAL(1)
    PRINT_VAL(2)

    // Output:
    // 42
    // 70
    // 80

    return 0;
} 
```

不过，我不是在宣传这个；如果没有更好的解决方案，请务必仔细考虑。:)

# asp.net-mvc - 为什么我的非必需数据成员给出必需的错误？

> ID：14527308
> 
> 赞同：0
> 
> 时间：2013-01-25T17:36:56.627
> 
> 标签：asp.net-mvc, razor, data-annotations

这真的很奇怪。我有一个 asp.net MVC 应用程序，我正在做一些数据验证。

我有一些不需要的 DateTime 数据成员。事实上，我已经完全删除了所有注释。

这是对遗留内部系统的重写，因此使用文本框可以很好地输入日期。

出于某种原因，这些文本框是按要求呈现的！我什至尝试使用 jQuery 删除 data-val 和 data-val-required 属性。我使用浏览器调试器查看 HTML，并且在 javascript 运行后属性消失了。

这可能是什么原因造成的？

```
From the Razor markup:
@Html.TextBox("MainStartDt", Model.MainStartDt.ToShortDateString(), new {@class="dateedit" })

from the view model:

public DateTime UsersAddedStartDt { get; set; }
public DateTime UsersAddedEndDt { get; set; } 
```

我还可以发布哪些其他信息来提供帮助。这看起来很简单，如果没有这样声明，这些不应该被reuired。

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T17:38:37.720

`DateTime`是不可为空的，因此是必需的。如果您希望它是可选的，请将其设置为可为空。

```
public DateTime? UsersAddedStartDt { get; set; } 
```

这将适用于所有不可为空的（值）类型，包括`int`, `double`, `float`, `short`, `Guid`,`Point`等。

# linux - 将多播流量转发到 RedHat 6 上的单个 NIC 的路由配置

> ID：14527311
> 
> 赞同：1
> 
> 时间：2013-01-25T17:37:15.567
> 
> 标签：linux, redhat, routes, multicast

我正在尝试编辑`/etc/sysconfig/network-scripts/route-eth0`以使所有多播数据包发送到设备 eth0 上`RedHat 6.3`，遵循[本指南](https://access.redhat.com/knowledge/docs/en-US/Red_Hat_Enterprise_Linux/6/html/Deployment_Guide/s1-networkscripts-static-routes.html)。

我试过这样写：

```
224.0.0.0/4 dev eth0 
```

但它从不工作....如何在此文件上指定多播路由？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T17:49:34.077

我认为你应该添加路线`/etc/sysconfig/static-routes`

另一种保存永久路由的替代解决方案是将您的路由命令添加到以下文件中。

```
/etc/rc.local 
```

*   更多选择。

还在内核中启用 MC 路由

```
sysctl -w net.ipv4.conf.all.mc_forwarding=0 
```

确保内核中有 MC 路由支持。例如。

```
# cat /boot/config-`uname -r` | grep IP_MROUTE
CONFIG_IP_MROUTE=y 
```

Netstat 还会告诉你是否启用

```
netstat -g 
```

# sqlite - sqlite 多个唯一性不起作用

> ID：14527312
> 
> 赞同：1
> 
> 时间：2013-01-25T17:37:18.877
> 
> 标签：sqlite, unique-constraint

我有一张桌子：

```
CREATE TABLE IF NOT EXISTS city_recent
            (_id INTEGER PRIMARY KEY AUTOINCREMENT,
            city_id INTEGER NOT NULL,
            language BOOL NOT NULL,
            type BOOL NOT NULL,
            FOREIGN KEY (city_id) REFERENCES city(_id),
            UNIQUE(city_id, type) ON CONFLICT IGNORE) 
```

但独特的不起作用：

![截屏](../Images/822d3ade7544d59e9ee326ce2cf84497.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-25T17:45:31.440

我已经测试了您的代码，它按预期工作（测试如下所示）。最有可能发生的事情是表是在没有`UNIQUE`约束的情况下预先创建的。尝试删除`IF NOT EXISTS`以确认。

```
>>> import sqlite3
>>> con = sqlite3.connect(':memory:')
>>> con.execute('''CREATE TABLE IF NOT EXISTS city_recent
...             (_id INTEGER PRIMARY KEY AUTOINCREMENT,
...             city_id INTEGER NOT NULL,
...             language BOOL NOT NULL,
...             type BOOL NOT NULL,
...             FOREIGN KEY (city_id) REFERENCES city(_id),
...             UNIQUE(city_id, type) ON CONFLICT IGNORE);''')
<sqlite3.Cursor object at 0x01298FA0>
>>> con.execute('insert into city_recent(city_id,language,type) values (0,0,1);')
<sqlite3.Cursor object at 0x0129F120>
>>> con.execute('insert into city_recent(city_id,language,type) values (0,0,1);')
<sqlite3.Cursor object at 0x01298FA0>
>>> con.execute('select * from city_recent').fetchall()
[(1, 0, 0, 1)] # -> note that there is only one row in the table 
```

# sql - 查询具有复杂关系的多个表

> ID：14527314
> 
> 赞同：3
> 
> 时间：2013-01-25T17:37:32.520
> 
> 标签：sql, postgresql

我想要的查询超出了我的 SQL 知识范围，所以我希望在这里得到一些帮助。我想在 postgreSQL 9.2 中将多个表的关系合二为一。我知道程序，但我不知道 SQL。

有 4 个表将进入此查询：

*   **愿望清单：**与一个或多个清单相关联并且有首选商店
*   **list_wishlist：**保存lists和wishlists的关系
*   **item：**与列表相关联并具有首选商店
*   **prefered_stores：**这保存了商店和首选商店之间的关系（每个首选商店是首选商店中的单独行。因此，如果一个项目或愿望清单有多个首选商店，则这些行的首选商店.id 将是相同的）

这些表看起来像这样（删除了不相关的列）： ![在此处输入图像描述](../Images/f96f595ee2ebefce09bfb3c9fdab09f1.png)

生成的表格如下所示： ![在此处输入图像描述](../Images/853c01c5674cd57662a638fb8c5ecaaf.png)

让我解释一下结果表：

*   **item_id：**就是这样，项目的 id
*   **item_stores_comments：**存储/评论对来自与此项目关联的所有prefered_stores 行（商店/评论用逗号分隔，对用分号分隔）
*   **wishlist_stores：**存储与该项目所在的列表相关联的心愿单的首选存储 ID（以逗号分隔）

我已经用上面示例表的实际结果填充了 item_info 表，所以我想应该很清楚，但如果你没有得到任何东西，请告诉我。

我已经按照评论中的建议创建了一个 SQLFiddle：[http](http://sqlfiddle.com/#!12/9fd60) ://sqlfiddle.com/#!12/9fd60 它包含与图像中相同的架构和值。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-25T19:35:13.963

这应该做你想要的：

```
WITH a AS (
  SELECT item.id, string_agg(prefered_store.store::varchar, ',') wishlist_stores
  FROM item, list_wishlist, wishlist, prefered_store
  WHERE item.list=list_wishlist.list
    AND list_wishlist.wishlist=wishlist.id
    AND wishlist.prefered_stores=prefered_store.id
  GROUP BY item.id
), b AS (
  SELECT item.id, 
    string_agg(
      prefered_store.store::varchar || ',' || prefered_store.comment,
      ' ; ') item_stores_comments
    FROM item, prefered_store
    WHERE item.prefered_stores=prefered_store.id
    GROUP BY item.id
)
SELECT a.id,item_stores_comments,wishlist_stores 
FROM a,b
WHERE a.id=b.id 
```

# javascript - 使用javascript比较表单中下拉菜单中的值

> ID：14527316
> 
> 赞同：0
> 
> 时间：2013-01-25T17:37:39.827
> 
> 标签：javascript

在我的表单上，我使用 javascript 来验证用户输入，但是我想比较两个不同下拉菜单的值以检查它们是否相同。两个下拉菜单“接送地点”和“目的地”包含完全相同的城镇名称，因此用户可以轻松地为两者选择相同的城镇，这是我不想要的。如果可能的话，任何想法如何实现这一目标？谢谢

代码：

```
function validateFormOnSubmit(theForm) {
var reason = "";

reason += validatepickuplocation(theForm.pickuplocation);

if (reason != "") {
alert("Some fields need correction:\n" + reason);
return false;
}

return true;
}

function validatePickuplocation(fld) {
var pickuplocation = document.getElementById("pickuplocation");
var destination = document.getElementById("destination");

if (pickuplocation.options[pickuplocation.selectedIndex].value ==   destination.options[destination.selectedIndex].value) {
fld.style.background = 'Yellow';
error = "Make sure 'Pick up location' and 'Destination' are not the same locations.\n"
} else {
fld.style.background = 'White';
}
return error;
} 
```

html:

```
<tr>
<td><label for="pickuplocation">Pick up location:</label></td>
<td><select name="pickuplocation" size="1">
<OPTIONS>
</select></td></tr>

<tr>
<td><label for="destination">Pick up location:</label></td>
<td><select name="destination" size="1">
<OPTIONS>
</select></td></tr> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T17:45:12.973

当然，只需将每个下拉框值设置为单独的变量并比较它们：

```
var a = document.getElementById("dropDownA");
var b = document.getElementById("dropDownB");

if (a.options[a.selectedIndex].value == b.options[b.selectedIndex].value) {
    // Do Some stuff
} else {
    // Do other stuff
} 
```

# php - 从网页中更快地获取图像

> ID：14527323
> 
> 赞同：0
> 
> 时间：2013-01-25T17:38:10.437
> 
> 标签：php, jquery, simple-html-dom

我正在寻找从**FASTER**链接获取图像的插件或简单代码。我一直在使用 [http://simplehtmldom.sourceforge.net/](http://simplehtmldom.sourceforge.net/)从给定链接中提取前 3 张图像。

simplehtmldom 非常慢，我网站上的许多用户都将其报告为问题。

如果我错了，请纠正我，我相信这个插件需要花费大量时间从我传递的 url 中获取完整的 html 代码，然后它会搜索 img 标签。

有人请建议我一种提高获取 html 代码速度的技术或我可以尝试的替代插件吗？

我在想的是获取html代码直到找到前三个img标签然后终止代码获取过程？让事情变得更快。

我不确定是否可以使用 php，但我正在努力使用 jquery 来设计它。

谢谢你的帮助 ！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-25T17:42:42.317

跨站点脚本规则将阻止您在 jQuery/JS 中执行此类操作（除非您控制所有要从中获取内容的域）。在任何情况下，您所做的都不会超快，但请尝试使用与[DOMDocument](http://php.net/manual/en/class.domdocument.php)`file_get_content()`配对的方式编写自己的... DOMDocument方法可能比 simplehtmldom 的方法更快。`getElementsByTagName``find()`

您也可以尝试正则表达式方法。[它不会](http://www.codinghorror.com/blog/2009/11/parsing-html-the-cthulhu-way.html)像真正的 DOM 解析器那样万无一失，但它可能会更快……比如：

```
$html = file_get_contents($url);
preg_match_all("/<img[^']*?src=\"([^']*?)\"[^']*?>/", $html, $arr, PREG_PATTERN_ORDER); 
```

如果您想避免读取整个大文件，您还可以跳过循环`file_get_contents()`中的调用和子程序，`fopen(); while(feof())`并在从远程服务器读取每一行后检查图像。但是，如果您采用这种方法，请确保您输入的是`regex`整个缓冲字符串，而不仅仅是最近的一行，因为您很容易让图像的代码跨越几行。

请记住，HTML 中的实际可变性`regex`充其量只会成为一个不完美的解决方案，但如果速度是一个主要问题，它可能是您的最佳选择。

# mysql - 注入用户选择的时区进行查询

> ID：14527333
> 
> 赞同：0
> 
> 时间：2013-01-25T17:39:00.130
> 
> 标签：mysql, timezone

我已将服务器的时区设置为 UTC。我的用户可以选择他们自己的时区，例如 UTC+2 等。我创建了一个查询来指示班次何时打开或关闭：

```
SELECT DAYNAME(NOW()), start_day
FROM Shifts
WHERE (start_day = LOWER(DAYNAME(NOW()))
       AND start_time < CURTIME()
       AND end_time > CURTIME())
   OR (start_day = LOWER(DAYNAME(DATE_SUB(NOW(), INTERVAL 1 DAY)))
       AND start_time < ADDTIME('24:00:00', CURTIME())
       AND end_time > ADDTIME('24:00:00', CURTIME())) 
```

我想更改此查询 NOW() 和 CURTIME() 以匹配每个用户的设置。我应该如何更改我的查询，以在其中注入自定义 UTC？还有另一种方法来完成我需要的吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T12:51:42.000

[CONVERT_TZ](http://dev.mysql.com/doc/refman/5.1/en/date-and-time-functions.html#function_convert-tz)函数将解决您的问题。

*   句法

    CONVERT_TZ(dt, from_tz, to_tz)。

    **“from_tz”**是您的服务器时区（在您的情况下为 UTC）。

    **"to_tz"**值可以作为表示从**"from_tz"**的偏移量的字符串给出，例如 '+10:00' 或 '-6:00'。

*   例子：

    ```
     SELECT CONVERT_TZ('2004-01-01 12:00:00','UTC','+2:00');
     SELECT CONVERT_TZ(NOW(), 'UTC', '-5:30');
     SELECT CONVERT_TZ(NOW(), '-2:00', '+5:00') 
    ```

# boost-foreach - 带有不可复制对象的 ptr_vector 的 BOOST_FOREACH

> ID：14527338
> 
> 赞同：2
> 
> 时间：2013-01-25T17:39:18.363
> 
> 标签：boost-foreach

我有以下内容：

```
class X : public boost::noncopyable
{...};

class Y 
{
   public:
      const boost::ptr_vector<X>& getXs() const;
   private:
      boost::ptr_vector<X> m_xs;
}

int main()
{
   Y y1;
   //...

   const boost::ptr_vector<X>& mx = y1.getXx();

   BOOST_FOREACH(boost::ptr_vector<X>::value_type x, mx)
   {
       // do something with x!
   }
} 
```

它编译但它不链接！它说这`implicit default copy constructor for X`是 BOOST_FOREACH 需要的。

我如何仅迭代指向 X 的指针...没有复制构造函数，使用`BOOST_FOREACH`.

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T18:07:05.317

Try using references in `BOOST_FOREACH()`, .i.e.

```
BOOST_FOREACH(boost::ptr_vector<X>::value_type &x, mx)
{
    // do something with x!
} 
```

# c# - 在 c# 中通过 wmplib 更改 mp3 播放的音量

> ID：14527339
> 
> 赞同：3
> 
> 时间：2013-01-25T17:39:19.660
> 
> 标签：c#, volume, wmplib

是否有可能改变通过 wmplib 播放的 mp3 文件的音量？改变程序本身的音量也可以。

有什么解决方案可以做到这一点吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-07-21T00:24:58.140

这是一种简单的方法。

例子：

```
WMPlib.WindowsMediaPlayer wmp = new WMPlib.WindowsMediaPlayer(); //Creates an instance of the WMP
wmp.url="URI to media source"; //Sets media source
wmp.settings.volume= 50;  //Volume can be 0-100 (inclusive) 
```

希望对您有所帮助！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-25T18:45:49.200

这个想法是发送[WM_APPCOMMAND 消息](http://msdn.microsoft.com/en-us/library/windows/desktop/ms646275%28v=vs.85%29.aspx)（另见[这个答案](https://stackoverflow.com/a/9203952/490018)）。

对于 WPF 使用[WindowInteropHelper](http://msdn.microsoft.com/en-us/library/system.windows.interop.windowinterophelper.aspx)来获取`Handle`：`Window`

```
class MainWindow : Window
{
    ...

    private const int APPCOMMAND_VOLUME_MUTE = 0x80000;
    private const int WM_APPCOMMAND = 0x319;
    private const int APPCOMMAND_VOLUME_UP = 10 * 65536;
    private const int APPCOMMAND_VOLUME_DOWN = 9 * 65536;

    [DllImport("user32.dll")]
    public static extern IntPtr SendMessageW(IntPtr hWnd, int Msg, IntPtr wParam, IntPtr lParam);

    private void VolumeUp()
    {
        // APPCOMMAND_VOLUME_UP or APPCOMMAND_VOLUME_DOWN
        var windowInteropHelper = new WindowInteropHelper(this);
        SendMessageW(windowInteropHelper.Handle, (IntPtr)WM_APPCOMMAND, windowInteropHelper.Handle, (IntPtr)APPCOMMAND_VOLUME_UP);
    }
} 
```

对于 Windows 窗体，使用[Control.Handle 属性](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.handle.aspx)：

```
class MainForm : Form
{
    ...

    private void VolumeUp()
    {
        SendMessageW(Handle, (IntPtr)WM_APPCOMMAND, Handle, (IntPtr)APPCOMMAND_VOLUME_UP);
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-10-16T19:00:04.667

这对我有用！

```
WMPLib.WindowsMediaPlayer wmsound= new WMPLib.WindowsMediaPlayer();

wmsound.URL = @"C:\Users\USER\sound.mp3";

//Volume 100%
finish_sound.settings.volume = 100; 
```

# c++ - 在 .cpp 中实现静态模板

> ID：14527346
> 
> 赞同：0
> 
> 时间：2013-01-25T17:39:38.040
> 
> 标签：c++, templates, static, header

> **可能重复：**
> [为什么模板只能在头文件中实现？](https://stackoverflow.com/questions/495021/why-can-templates-only-be-implemented-in-the-header-file)

我正在研究一个 Matrix 类，并且我有一个方法 SetMatrix 用于使用标准 c++ 二维数组初始化数组。

```
template <int width, int height>
static void SetMatrix(Matrix& matrix, double array[][width]) {
    if (matrix.height_ != height || matrix.width_ != width) {
        fprintf(stderr, "Incorrect matrix size\n");
        return;
    }
    for (int y = 0; y < height; ++y)
        for (int x = 0; x < width; ++x)
            matrix.matrix_[y][x] = array[y][x];
} 
```

并且该方法运行良好，但是当我尝试将其从头文件移动到 .cpp 实现文件时，出现链接器错误。

矩阵.cpp：

```
template <int width, int height>
void Matrix::SetMatrix(Matrix& matrix, double array[][width]) {
    if (matrix.height_ != height || matrix.width_ != width) {
        fprintf(stderr, "Incorrect matrix size\n");
        return;
    }
    for (int y = 0; y < height; ++y)
        for (int x = 0; x < width; ++x)
            matrix.matrix_[y][x] = array[y][x];
} 
```

g++ 输出：

```
g++ -Wall -Wextra main.cpp Matrix.cpp -o matrix
/tmp/ccMkObBs.o: In function `main':
main.cpp:(.text+0x81): undefined reference to `void Matrix::SetMatrix<2, 3>(Matrix&, double (*) [2])'
collect2: error: ld returned 1 exit status 
```

我想知道如何将它移动到 .cpp 文件，或者我只是运气不好，或者是否有更优雅的方式来做到这一点？我发现的大多数资源都是处理模板类的静态方法，而不是非模板类的静态模板方法。如果有帮助，这也是我的调用代码

```
int main() {
    double input[3][2] = {
        {1, 2},
        {3, 4},
        {5, 6}
    };

    Matrix matrix(2, 3);

    Matrix::SetMatrix<2, 3>(matrix, input);
    matrix.Print();
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T17:51:33.783

`main.cpp`看不到`SetMatrix`成员函数模板的定义，因此在调用 this 时无法*实例化*它。`.cpp`编译器只能依赖于在处理其他翻译单元（即其他文件）时已经或将要生成该函数的代码这一事实。

但是，仅仅存在`SetMatrix`in 函数的定义`matrix.cpp`并不意味着函数模板在此处被*实例化*（事实上，它没有，因为该文件中没有任何代码行调用`SetMatrix`）；因此，不会生成该函数的目标代码。

因此，最终实例化函数模板的代码不会出现在任何翻译单元中，并且会引发链接器错误。

# jquery - 点击透明图片后面的东西？

> ID：14527347
> 
> 赞同：0
> 
> 时间：2013-01-25T17:39:38.633
> 
> 标签：jquery, html

找不到我正在寻找的确切内容，所以如果他已经回答了这个问题，请原谅我。我有一个简单的设置，它是一个带有一些透明点的 PNG 图像，其中我有视频和其他事情。这些当然在 z-index 方面位于图像后面，因此它们被 PNG 掩盖了。但是，我希望用户能够与这些东西进行交互，但他们不能，因为具有更高 z-index 的图像只允许关注该元素。有任何想法吗？

# javascript - Jqbootstrap 验证允许特定单词

> ID：14527348
> 
> 赞同：-1
> 
> 时间：2013-01-25T17:39:38.960
> 
> 标签：javascript, regex, validation, twitter-bootstrap

嗨，我正在使用 jqbootrapvalidation 插件来验证我的表单。我正在使用这个正则表达式来验证 DD-MM-YYYY 格式的日期

`((((0?[1-9]|[12]\d|3[01])[\.\-\/](0?[13578]|1[02])[\.\-\/]((1[6-9]|[2-9]\d)?\d{2}))|((0?[1-9]|[12]\d|30)[\.\-\/](0?[13456789]|1[012])[\.\-\/]((1[6-9]|[2-9]\d)?\d{2}))|((0?[1-9]|1\d|2[0-8])[\.\-\/]0?2[\.\-\/]((1[6-9]|[2-9]\d)?\d{2}))|(29[\.\-\/]0?2[\.\-\/]((1[6-9]|[2-9]\d)?(0[48]|[2468][048]|[13579][26])|((16|[2468][048]|[3579][26])00)|00)))|(((0[1-9]|[12]\d|3[01])(0[13578]|1[02])((1[6-9]|[2-9]\d)?\d{2}))|((0[1-9]|[12]\d|30)(0[13456789]|1[012])((1[6-9]|[2-9]\d)?\d{2}))|((0[1-9]|1\d|2[0-8])02((1[6-9]|[2-9]\d)?\d{2}))|(2902((1[6-9]|[2-9]\d)?(0[48]|[2468][048]|[13579][26])|((16|[2468][048]|[3579][26])00)|00))))`

问题是我希望表格也允许“无”这个词，我环顾四周，我认为应该是

`\bNone\b`但我不能让它工作，有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T19:07:05.693

这很简单`None|((((0?[1-9]|[12]\d|3[01])[\.\-\/](0?[13578]|1[02])[\.\-\/]((1[6-9]|[2-9]\d)?\d{2}))|((0?[1-9]|[12]\d|30)[\.\-\/](0?[13456789]|1[012])[\.\-\/]((1[6-9]|[2-9]\d)?\d{2}))|((0?[1-9]|1\d|2[0-8])[\.\-\/]0?2[\.\-\/]((1[6-9]|[2-9]\d)?\d{2}))|(29[\.\-\/]0?2[\.\-\/]((1[6-9]|[2-9]\d)?(0[48]|[2468][048]|[13579][26])|((16|[2468][048]|[3579][26])00)|00)))|(((0[1-9]|[12]\d|3[01])(0[13578]|1[02])((1[6-9]|[2-9]\d)?\d{2}))|((0[1-9]|[12]\d|30)(0[13456789]|1[012])((1[6-9]|[2-9]\d)?\d{2}))|((0[1-9]|1\d|2[0-8])02((1[6-9]|[2-9]\d)?\d{2}))|(2902((1[6-9]|[2-9]\d)?(0[48]|[2468][048]|[13579][26])|((16|[2468][048]|[3579][26])00)|00)))).`

感谢@FrankieTheKneeMan 为我指明了正确的方向！

# iphone - 在 iPhone 上的另一个 ViewController 上创建一个 View 弹出窗口

> ID：14527350
> 
> 赞同：2
> 
> 时间：2013-01-25T17:39:42.450
> 
> 标签：iphone, ios, uiview, uiviewcontroller, uipopovercontroller

当我在 iPhone 上按下按钮时，我正在尝试制作某种弹出视图。如果我可以使用 ViewController 管理该弹出视图，那就太好了。我发现 UIPopoverController 可能是解决方案，但它似乎只适用于 iPad ......但无论如何，iPhone 是否有类似的解决方案？我正在使用故事板

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-25T19:14:23.350

创建一个单独的视图控制器并调整其 xib 文件的大小并使其看起来像一个弹出窗口。然后将此视图控制器添加为子视图，并将其添加为 childController。

```
[self addChildViewController:self.popOverViewController];
[self.view addSubview:self.popOverViewController.view]; 
```

现在让它最初隐藏。

```
self.popOverViewController.view.hidden = YES; 
```

如果用户点击 Button 然后使用淡入和淡出动画，您可以隐藏/取消隐藏它。如果您想进一步了解它，我可以告诉您如何淡入和淡出，希望您可以轻松做到。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-25T17:47:22.410

在 Github 上查看这些存储库：

*   [https://github.com/werner77/WEPopover](https://github.com/werner77/WEPopover)
*   [https://github.com/50pixels/FPPopover](https://github.com/50pixels/FPPopover)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-25T18:03:43.943

在界面生成器中制作屏幕的 UIView 大小，然后在该 Uiview 中制作另一个样式、大小等以供您弹出。做它的类，把所有东西联系在一起。

```
CustomPopUpView *view = [[CustomPopUpView alloc] initWithFrame.....] 
```

将这一切添加到您的 UIViewController 中

```
[self.view addsubview:view] 
```

然后将一个 tapGestureRecognizer 附加到后视图，在点击时将整个视图动画到屏幕外。所以现在如果他们点击你的弹出视图，它会关闭它，它会在屏幕外显示动画。

希望这是有道理的。

BooRanger

# xpath - 如何从 WebElement 中提取元素

> ID：14527351
> 
> 赞同：0
> 
> 时间：2013-01-25T17:39:49.810
> 
> 标签：xpath, webdriver, selenium-webdriver

有没有办法从 WebElement 中提取多个 WebElement？例如，我有以下内容：

```
 String filterRowXpath = "(//div[@id=\"tabItemFilters\"]//div[@id=\"RowExpGridWidgetGridPanel\"]//div[@class=\"x-grid3-body\"]//tbody)";
    List<WebElement> filterRows = driver.findElements(By.xpath(filterRowXpath)); 
```

我最终得到了一个本身包含 5 个元素的 WebElement，有没有办法让我引用元素 2 和 3？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T18:09:29.133

If you have something like :

```
<tbody>
<webelement>1<webelement/>
<webelement>2<webelement/>
<webelement>3<webelement/>
</tbody> 
```

And you want 2 or 3, you can add [2] or [3] which is equivalent to `[position()=2]` or `[position()=3]`.

So for your XPath it would be ..`//tbody[position()=2 or position()=3]` if you're looking for either of those positions. Note that you cannot use shorthand as in the previous statement if you are searching for multiple positions.

**UPDATE:**

```
filterRowXpath= "(((//div[@id=\"tabItemFilters\"]//div[@id=\"RowExpGridWidgetGridPanel\"]//div[@class=\"x-grid3-body\"]//tbody)[" + i + "])//td)[position()=2 or position()=3] 
```

This will give you two node results back, instead of executing separate xpaths for each one.

```
List<WebElement> filterRows = driver.findElements(By.xpath(filterRowXpath)); 
```

Then apply your condition to the WebElements. You were almost there in the snippet posted in your original question.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T19:14:22.513

这是我想出的：

```
 String ipFromValueXpath; 
    String ipToValueXpath;

    for(int i=1; i<=filterRows.size(); ++i) {
        ipFromValueXpath = "(((//div[@id=\"tabItemFilters\"]//div[@id=\"RowExpGridWidgetGridPanel\"]//div[@class=\"x-grid3-body\"]//tbody)[" + i + "])//td)[2]";
        ipToValueXpath = "(((//div[@id=\"tabItemFilters\"]//div[@id=\"RowExpGridWidgetGridPanel\"]//div[@class=\"x-grid3-body\"]//tbody)[" + i + "])//td)[3]";

        WebElement e1 = driver.findElement(By.xpath(ipFromValueXpath));
        String ipFromValue = e1.getText();

        WebElement e2 = driver.findElement(By.xpath(ipToValueXpath));
        String ipToValue = e2.getText();

        if(ipFromValue.equals(ipFrom) && ipToValue.equals(ipTo)) {
            e1.click();
            element = driver.findElement(By.xpath(deleteFilterButtonXpath));
            element.click();
            Thread.sleep(500);
            AdminFunctions.apply();
            return;
        }

    } 
```

我必须获取每个元素的 Xpath，然后遍历每一行以找到匹配项。我不认为这是最有效的方法。

# javascript - 我可以为所有 AJAX 请求设置全局标头吗？

> ID：14527360
> 
> 赞同：34
> 
> 时间：2013-01-25T17:40:28.910
> 
> 标签：javascript, jquery, ajax, header

这似乎不起作用：

```
$.ajaxSetup({
  headers: {
    Accept: 'application/vvv.website+json;version=1 ',
    Authorization: 'Token token=\"FuHCLyY46\"'
  }
}); 
```

我本来以为会的。如果我将这些过滤器专门添加到我的 AJAX 调用中，那么它们确实可以工作。我想在全球范围内为所有 AJAX 调用执行此操作。

* * *

## 回答 #1

> 赞同：68
> 
> 时间：2013-01-25T17:49:40.513

我做了一些额外的测试，您发布的代码完美运行。如果您在设置参数时遇到问题，您可以随时调用 beforeSend 并自己修改 xml 请求。

```
$.ajaxSetup({
    beforeSend: function (xhr)
    {
       xhr.setRequestHeader("Accept","application/vvv.website+json;version=1");
       xhr.setRequestHeader("Authorization","Token token=\"FuHCLyY46\"");        
    }
}); 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2017-08-01T20:11:25.207

也可以通过猴子修补 open 方法以与框架无关的方式执行此操作：

```
var o = XMLHttpRequest.prototype.open;
XMLHttpRequest.prototype.open = function(){
  var res = o.apply(this, arguments);
  var err = new Error();
  this.setRequestHeader('X-Ajax-Stack', JSON.stringify(err.stack));
  return res;
} 
```

在此示例中，我通过标头发送堆栈跟踪信息，这允许后端知道 Ajax 请求的来源，即使它来自不使用 jQuery 的第三方代码。

（注意：小心标题 [变得太大](https://stackoverflow.com/questions/686217/maximum-on-http-header-values)）

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2013-01-25T18:48:17.813

`beforeSend`答案与直接`header`添加`header`到 ajax 调用不同。所以为了让jQuery正确地做到这一点，我添加了这个：

```
headers: myGlobalHeaders 
```

其中`myGlobalHeaders`是一个全局变量。不幸的是，我必须在每一个 ajax 调用上都写下这额外的一行。糟糕的！也许我会编辑 jQuery 框架来处理这个..

# python - 如何在 Python 中安装 blaze 模块（Continuum 分析）？

> ID：14527364
> 
> 赞同：3
> 
> 时间：2013-01-25T17:41:01.110
> 
> 标签：python, numpy, numeric, blaze

如何在 Python 中本地（即不在虚拟环境中）安装[blaze ？](http://blaze.pydata.org/index.html)我找到的唯一说明在包的文档中（见链接），[在这里](http://www.spontaneoussymmetry.com/blog/archives/436)，在虚拟环境中。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-25T17:41:01.110

我在网上没有找到任何说明，但它相对简单。

关于我使用的平台/工具：

*   Mac OSX（山狮）
*   Python 2.7.3
*   [自制](http://mxcl.github.com/homebrew/)
*   [点子](http://pypi.python.org/pypi/pip)
*   看起来您可能需要安装 Cython，不确定因为我已经安装了它。您可以使用`pip install Cython`.

首先，`brew install llvm`。

这是您需要的软件包。你可以`pip`全部：

*   `llvmpy`
*   `numba`
*   `meta`
*   `ply`
*   `blosc`
*   `sphinx`-- 对于文档
*   `aterm`

一旦你把所有东西都吃光了，

*   `cd /tmp`当然取决于你...
*   `sudo git clone git@github.com:ContinuumIO/blaze-core.git`
*   `cd /tmp/blaze-core`
*   `sudo make build`
*   `sudo make docs`
*   `sudo python setup.py install` （当然，你是否需要 sudo 取决于你把东西放在哪里。）

我在运行测试时遇到了麻烦，看起来`__init__.py`某处的文件中有错误，但我不能确定。我无法让单元测试运行，所以对“成功安装”持保留态度。无论如何，我可以进行抽查以查看模块是否正确导入：

```
>>> import blaze
>>> from blaze import Array, dshape
>>> ds=dshape('2,2,int')
>>> a = Array([1,2,3,4],ds)
>>> a
Array
  datashape := 2, 2, int 
  values    := [CArray(ptr=140454075688080)] 
  metadata  := [manifest, arraylike] 
  layout    := Chunked(dim=0) 
[1 2 3 4] 
```

# django - 设置只读选项 (ForeignKey) 字段的初始值

> ID：14527372
> 
> 赞同：1
> 
> 时间：2013-01-25T17:41:38.730
> 
> 标签：django, forms, django-forms

我正在尝试使 CreateView 具有一个具有设定值的只读字段，但我无法使其工作。

我有一个带有 ForeignKey 到另一个模型的模型：

```
class CompanyNote(TimeStampedModel):
    company = models.ForeignKey(Company)
    note = models.TextField(blank=True) 
```

我有一个 CreateView：

```
class CompanyNoteCreateView(CreateView):
    model = models.CompanyNote
    form_class = CompanyNoteForm 
```

使用自定义 ModelForm：

```
class CompanyNoteForm(forms.ModelForm):

    company = forms.ChoiceField(
        widget=forms.widgets.Select(attrs={'readonly': 'readonly'}))

    class Meta:
        model = models.CompanyNote 
```

如您所见，相关字段的小部件是只读的。这是因为我将公司作为 URL 的一部分，如`company/1/note/add`. 我可以毫不费力地选择“1”并找到正确的公司对象，但我不知道如何设置只读字段。

我试过：

```
def get_initial(self):
    initial = super(CompanyNoteCreateView, self).get_initial()
    initial['company'] = self.get_company().id
    return initial 
```

但这没有用。Widget 是空的，这可能是问题所在。也许我在这里叫错了树。欢迎任何想法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T18:22:37.203

用一个`ModelChoiceField`

```
class CompanyNoteForm(forms.ModelForm):
    company = forms.ModelChoiceField(queryset=models.Company.objects.all(), widget=forms.widgets.Select(attrs={'readonly': 'readonly'})) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-26T06:26:16.940

您是否尝试过在 Form 的 Meta 类中设置属性？

我遇到了一个问题，如果在基类定义中设置表单属性未应用于模型字段，但它们在 Meta 类中正常工作：

```
class CompanyNoteForm(forms.ModelForm):
    class Meta:
        model = models.CompanyNote
        widgets = {'company': forms.widgets.Select(attrs={'readonly': True,
                                                          'disabled': True})} 
```

否则请检查[此答案](https://stackoverflow.com/a/325038/1998376)。

最坏的情况，让公司成为一个隐藏的领域？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-02-12T17:26:59.130

我在任何地方都找不到这个答案，我实际上可以开始工作。但我发现了另一种方法。使用 forms.HiddenInput() 小部件将字段设置为隐藏。然后将分配您从视图中传入的值，但用户无法访问它。

```
widgets = {'field_name': forms.HiddenInput()} 
```

我正在使用 ModelForm 类，所以我的语法可能与您的不同。

# solr - 使用存储的 html 字段突出显示时 Solr Strip html

> ID：14527374
> 
> 赞同：2
> 
> 时间：2013-01-25T17:41:41.827
> 
> 标签：solr, ruby-on-rails-3.1, sunspot-solr

在 Rails 中使用 Solr 和 Sunspot。

我正在使用这样的字段类型搜索 html 字段：

```
<fieldType name="text_html" class="solr.TextField" omitNorms="false">
  <analyzer>
    <tokenizer class="solr.StandardTokenizerFactory"/>
    <charFilter class="solr.HTMLStripCharFilterFactory"/>
    <filter class="solr.StandardFilterFactory"/>
    <filter class="solr.LowerCaseFilterFactory"/>
    <filter class="solr.ISOLatin1AccentFilterFactory"/>
    <filter class="solr.PorterStemFilterFactory"/>
  </analyzer>
</fieldType> 
```

然后我正在执行搜索并使用存储字段，以便我可以在结果中返回突出显示的文本。我遇到的问题是存储的值中有原始的 html 文本。例如：对“新闻”的搜索返回：

"与@@@hl@@@news@@@endhl@@@、体育、本地交易和所有最新对话的社区联系。</div>\n</div>\n</div>"

然后我想用html包装的标签替换标签@@@hl@@@、@@@endhl@@@。

我是否需要自己手动去除原始 html 标签（div 等）标签，或者有​​没有办法让存储的值已经去除了 html 标签？

我知道如何手动执行此操作，只是想确保我没有遗漏 schema.xml 或 solrconfig.xml 中的某些内容。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-25T17:56:23.913

您需要在插入 Solr 之前或从索引中检索之后手动剥离该数据/格式。Solr 中的[分析器、标记器和标记过滤器](http://wiki.apache.org/solr/AnalyzersTokenizersTokenFilters)针对该字段运行，并针对在将标记/术语插入该文档的索引之前或在查询处理期间传递的值执行它们的操作。但是，它将始终以传入的原始表单存储与查询结果一起返回的字段值。

如果您碰巧使用[DataImportHandler](http://wiki.apache.org/solr/DataImportHandler)将数据加载到 Solr，它提供了[HtmlStripTransformer](http://wiki.apache.org/solr/DataImportHandler#HTMLStripTransformer)和/或[RegExTransformer](http://wiki.apache.org/solr/DataImportHandler#RegexTransformer)，您可以利用它来删除 html 标记。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-05-20T11:02:10.020

对于我的项目，我还需要在索引之前去除 HTML 标签，我的谷歌搜索首先把我带到了这里。在对 Paige Cook 链接的文档进行了短暂访问后，我发现了您的问题`schema.xml`可能出在哪里。

根据[Solr 文档](https://wiki.apache.org/solr/AnalyzersTokenizersTokenFilters#solr.HTMLStripCharFilterFactory)，`<charFilter>`标签必须*在*`<tokenizer>`标签之前。

所以我认为你应该有这样的东西：

```
<fieldType name="text_html" class="solr.TextField" omitNorms="false">
  <analyzer>
    <charFilter class="solr.HTMLStripCharFilterFactory"/>
    <tokenizer class="solr.StandardTokenizerFactory"/>
    <filter class="solr.StandardFilterFactory"/>
    <filter class="solr.LowerCaseFilterFactory"/>
    <filter class="solr.ISOLatin1AccentFilterFactory"/>
    <filter class="solr.PorterStemFilterFactory"/>
  </analyzer>
</fieldType> 
```

# xcode - 如何在 Xcode 中设置 $(SRCROOT) 的父路径

> ID：14527376
> 
> 赞同：5
> 
> 时间：2013-01-25T17:41:49.383
> 
> 标签：xcode

从[http://developer.apple.com/library/mac/#documentation/DeveloperTools/Reference/XcodeBuildSettingRef/1-Build_Setting_Reference/build_setting_ref.html%23//apple_ref/doc/uid/TP40003931-CH3-SW38](http://developer.apple.com/library/mac/#documentation/DeveloperTools/Reference/XcodeBuildSettingRef/1-Build_Setting_Reference/build_setting_ref.html%23//apple_ref/doc/uid/TP40003931-CH3-SW38)，我们可以找到 Xcode 的构建设置，例如 $(SRCROOT)。但就我而言，头文件位于 $(SRCROOT) 的父文件夹中。有没有办法在不输入绝对路径的情况下访问它？

谢谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-25T17:47:20.120

该序列`..`指的是几乎所有操作系统中的父目录。

```
$(SRCROOT)/../OtherPath 
```

# javascript - 在 AngularJS 服务中处理数据绑定

> ID：14527377
> 
> 赞同：20
> 
> 时间：2013-01-25T17:41:50.743
> 
> 标签：javascript, service, binding, angularjs

我试图弄清楚当我的数据存储在服务中时如何正确处理绑定。

如果将服务放入 $scope 然后让模板直接绑定到其中，我可以让事情正常工作，但这似乎是一个非常糟糕的主意。

我基本上希望拥有它，以便我的视图/控制器能够轻松地更改服务中的状态并将其反映在任何地方。

感觉我应该能够执行以下操作，但它不起作用（http://jsfiddle.net/aidankane/AtRVD/1/）。

HTML

```
<div ng-controller="MyCtl">
    <select ng-model="drawing" ng-options="d.file for d in drawings"></select>
</div>
<div ng-controller="MyOtherCtl">
    {{ drawing }}
</div> 
```

JS

```
var myApp = angular.module('myApp', []);

myApp.factory('myService', function(){
    var me = {
        drawings: [{'file':'a'}, {'file':'b'}]
    };
    // selected drawing
    me.drawing = me.drawings[0];
    return me;
});

function MyCtl($scope, myService){
    // can do:
    // $scope.mys = myService;
    // and then in html ng-model="mys.drawing"
    // but that seems wrong

    $scope.drawings = myService.drawings;
    $scope.drawing = myService.drawing;

    // can I not do this? it doesn't seem to work anyway...
    $scope.$watch('drawing', function(drawing){
        myService.drawing = drawing;
    });
}

function MyOtherCtl($scope, myService){
    $scope.drawing = myService.drawing;
}

MyCtl.$inject = ['$scope', 'myService'];
MyOtherCtl.$inject = ['$scope', 'myService']; 
```

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2013-01-25T17:46:59.583

`$watch`您可以使用和传递函数绑定到服务：

```
$scope.$watch( function () { return myService.drawing; }, function ( drawing ) {
  // handle it here. e.g.:
  $scope.drawing = drawing;
}); 
```

然后`$scope.drawing`在您的模板中使用，它们将自动更新：

```
<div ng-controller="MyOtherCtl">
  {{ drawing }}
</div> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-09-08T11:30:19.877

我认为，更优雅的是使用 Promise（参见 参考资料`$q.deferred()`）并异步解决它们。然后，您可以在 promise 函数中将数据分配给`$scope`的成员。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-03-05T23:14:43.390

有两种方法可以绑定来自服务的数据：1）按值（将需要如上所述的观察者来检查对服务原始值的变量更改）**2）通过引用（值直接链接）这是我的首选数据绑定方法。**

我只会解释第二种可能性，因为接受的答案已经显示了如何实现观察者。[这个博客很好地描述了我将要解释的内容](http://stsc3000.github.io/blog/2013/10/26/a-tale-of-frankenstein-and-binding-to-service-values-in-angular-dot-js/)。

[我创建了这个 plunk 以通过引用来说明数据绑定。](https://plnkr.co/edit/WkCT6aYao3qCmzJ8t5xg?p=preview)

**这是来自 plunk 的代码：**

HTML

```
<!DOCTYPE html>
<html ng-app="myApp">

  <head>
    <script data-require="angularjs@1.5.0" data-semver="1.5.0" src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.5.0/angular.js"></script>
    <link rel="stylesheet" href="style.css" />
    <script src="script.js"></script>
  </head>

  <body ng-controller="myAppCntrl">
    <h1>Hello Plunker!</h1>
    <h3>By value</h3>
    <p>{{byValue}}</p>
    <p>{{objByValue}}</p>
    <h3>By object in service reference</h3>
    <p>{{byRefence.stringPrimitive}}</p>
    <h3>By reference to service singleton</h3>
    <p>{{myservice.stringPrimitive}}</p>
    <p style="color: green">of course, you can reference an object through the service as well</p>
    <p>{{myservice.objectWithPrimitive.stringPrimitive}}</p>

    <button ng-click=update()>Update strings on service</button>
    <br />
    <button ng-click=setDefaults()>Restore Defaults</button>
  </body>

</html> 
```

JAVASCRIPT

```
var myApp = angular.module("myApp", []);

myApp.controller('myAppCntrl', function($scope, myAppService){
  $scope.myservice = myAppService;
  $scope.byValue = myAppService.stringPrimitive;
  $scope.objByValue = myAppService.objectWithPrimitive.stringPrimitive;
  $scope.byRefence = myAppService.objectWithPrimitive;

  $scope.update = function () {
    myAppService.stringPrimitive = "updated string";
    myAppService.objectWithPrimitive.stringPrimitive = "updated string here too";
  };
  $scope.setDefaults = function () {
    myAppService.stringPrimitive = 'string primitive';
    myAppService.objectWithPrimitive.stringPrimitive = 'string primitive';
  };
});

myApp.service('myAppService', function(){
  this.stringPrimitive = 'string primitive';
  this.objectWithPrimitive = {
    stringPrimitive: 'string primitive'
  };
}); 
```

*那么这是如何工作的呢？*

重要的是要理解这与 Angular 的工作方式无关，而与 Javascript 的工作方式有很大关系。当一个变量在 javascript（整数、字符串等）中设置为等于原始值（或传递给函数）时，**var 由 value 设置**。这意味着新变量是您将其设置为等于内存中新位置的变量的副本。当一个变量在 javascript 中设置为等于一个对象（或传递给一个函数）时**， var 由 reference 设置**。

*这是什么意思？*

当一个 $scope var 被值设置，并且服务变量发生变化时，由于 $scope 变量只是服务变量的一个副本，所以服务变量不再与服务变量有任何关系，并且在服务时也不会改变var 可以。

当 $scope var 设置为等于和对象时，它由 Reference 分配。这意味着当服务对象（请注意，服务是一个对象，因为它是使用 new 关键字实例化的，并且您可以在服务内部使用“this”引用该对象）或服务上被引用的任何对象发生更改时，任何引用这些对象的 $scope 变量也会更新。

# c - 链表的二维数组

> ID：14527384
> 
> 赞同：-1
> 
> 时间：2013-01-25T17:42:24.457
> 
> 标签：c, memory, linked-list

我正在尝试创建一个二维链表来保存一个稀疏矩阵，并编写了这段代码来在正确的位置插入一个新节点：

```
void insertNewNode(node **rowHead, node **columnHead, int value, int row, int column) { 
    //Get to the correct position in the column linked list
    if (*columnHead == NULL) {
        *columnHead = malloc(sizeof(node));
    } else {
        while((*columnHead)->nextColumn != NULL && (*columnHead)->nextColumn->row < row)
            *columnHead = (*columnHead)->nextColumn;
    }

    //Get to the correct position in the row linked list.
    if (*rowHead == NULL) {
        *rowHead = malloc(sizeof(node));
    } else {
        while((*rowHead)->nextRow != NULL && ((*rowHead)->nextRow->column < column))
            *rowHead = (*rowHead)->nextRow;
    }

    node *newNode = malloc(sizeof(node));
    newNode->column = column;
    newNode->row = row;
    newNode->value = value;

    (*columnHead)->nextColumn = newNode;
    (*rowHead)->nextRow = newNode;
} 
```

出于某种原因，最后一行：

```
(*rowHead)->nextRow = newNode; 
```

导致 EXC_BAD_ACCESS 错误，而前一行不是，我不完全确定为什么。谁能看到会发生这种情况的原因？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T17:49:09.217

这可能只是程序中其他地方的问题，即如何分配/维护行数据，而列数据恰好没问题。你检查过 rowHead 的值吗？也许它是空值或垃圾值......然后你可以从那里追溯以找出这是如何发生的。

# jquery - SCRIPT7002：XMLHttpRequest：网络错误 0x2ef3，由于错误 00002ef3 无法完成操作

> ID：14527387
> 
> 赞同：78
> 
> 时间：2013-01-25T17:42:35.013
> 
> 标签：jquery, ajax

当我进行一些 Ajax 调用时，我不断收到此错误...

它甚至可能与地理编码有关，但我真的不知道如何捕获错误以显示对用户有用的内容......甚至如何解决问题，因为它似乎只是在引用某种指针或其他东西： S 0x2ef3

> SCRIPT7002：XMLHttpRequest：网络错误 0x2ef3，由于错误 00002ef3，无法完成操作。

图像可能比错误消息更有帮助：

![在此处输入图像描述](../Images/ca625ba21f302752f8db51d15c89ae05.png)

有什么想法吗？

我的代码在 1 秒内触发 10 个 ajax 调用，由地理编码服务器端处理。

该错误间歇性地出现。有时我得到地理编码的结果，有时我得到那个错误。我会说我有10％的时间得到它。它完全阻止了 ajax 调用在 jQuery 中触发我的错误处理程序。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2013-04-01T17:49:06.000

这是对我有用的修复程序。与您的 json 数据一起发送的 mime 或错误字符集会导致该错误。添加这样的字符集以帮助它避免混淆：

```
$.ajax({
  url:url,
  type:"POST",
  data:data,
  contentType:"application/json; charset=utf-8",
  dataType:"json",
  success: function(){
  ...
  }
}); 
```

参考：

[Jquery - 如何让 $.post() 使用 contentType=application/json？](https://stackoverflow.com/questions/2845459/jquery-how-to-make-post-use-contenttype-application-json)

[由于错误 c00ce56e 无法完成操作](https://stackoverflow.com/questions/10194257/could-not-complete-the-operation-due-to-error-c00ce56e)

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2013-07-19T09:10:12.753

我们也遇到了类似的问题。但是，按照前面的评论设置字符集并没有帮助。我们的应用程序每 60 秒发出一次 AJAX 请求，而我们的网络服务器 nginx 在 60 秒时发送 Keep-Alive 超时。

我们通过将保持活动超时值设置为 75 秒来解决此问题。

这就是我们认为正在发生的事情：

1.  IE 每 60 秒发出一次 AJAX 请求，并在请求中设置 Keep-Alive。
2.  同时 nginx 知道 Keep-Alive 超时值被 IE 忽略了，所以它启动 TCP 连接关闭过程（在 FF/Chrome 的情况下这是由客户端启动的）
3.  IE 收到之前发送的请求的关闭连接请求。由于 IE 不希望这样做，因此它会引发错误并中止。
4.  即使连接已关闭，nginx 似乎仍在响应请求。

Wireshark TCP 转储会提供更清晰的信息，我们的问题已解决，我们不希望在此问题上花费更多时间。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2013-10-08T19:23:03.517

我收到了同样的错误 ( `SCRIPT7002: XMLHttpRequest: Network Error 0x80004004, Operation aborted`)，在我们的例子中是因为 JavaScript 的同源策略。

我们的 Web 应用程序正在端口 8080 上对我们的服务器进行 JQuery AJAX 调用。该调用被拦截并通过 SSL 重新路由（由于服务器规则要求传入流量使用 SSL）。

一旦我们通过 SSL 端口加载我们的 Web 应用程序，问题就得到了解决。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-09-22T01:12:48.290

我遇到了这个问题，一个返回一些 JSON 的 AJAX Post 请求会失败，最终返回 abort，并带有：

> SCRIPT7002：XMLHttpRequest：网络错误 0x2ef3

控制台中的错误。在其他浏览器（Chrome、Firefox、Safari）上，完全相同的 AJAX 请求很好。

跟踪我的问题 - 调查显示响应缺少状态代码。在这种情况下，它应该是 500 内部错误。这是使用需要显式设置错误代码的服务堆栈作为 C# Web 应用程序的一部分生成的。

IE 似乎将连接打开到服务器，最终超时并“中止”请求；尽管收到内容和其他标题。

也许 IE 如何处理帖子中的标题存在问题。

更新 Web 应用程序以正确返回状态代码解决了该问题。

希望这对某人有帮助！

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-03-03T09:49:40.847

这个问题发生在我的项目中，因为使用长 xml 字符串作为参数值的 ajax GET 调用。通过以下方法解决：像这样将其作为对 Java Spring MVC 控制器类方法的 ajax 后调用。

```
$.ajax({
    url: "controller_Method_Name.html?variable_name="+variable_value,
    type: "POST",
    data:{ 
            "xmlMetaData": xmlMetaData // This variable contains a long xml string
    },
    success: function(response)
    {
        console.log(response);
    }
  }); 
```

**在 Spring MVC Controller 类方法内部：**

```
@RequestMapping(value="/controller_Method_Name")
  public void controller_Method_Name(@RequestParam("xmlMetaData") String metaDataXML, HttpServletRequest request)
{
   System.out.println(metaDataXML);
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-03-05T06:56:59.597

我有一段时间遇到此错误并找到了解决方法。此修复适用于 Asp.net 应用程序，奇怪的是它仅在 IE 非兼容模式下失败，但在 Firefox 和 Crome 中有效。为所有/特定用户授予对 webservice 服务文件夹的访问权限解决了该问题。

在 web.config 文件中添加以下代码：

```
 <location path="YourWebserviceFolder">
  <system.web>
   <authorization>
    <allow users="*"/>
   </authorization>
  </system.web>
 </location> 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-01-27T14:39:37.057

`IE11`在尝试使用以下方式上传文件时收到上述错误后，我偶然发现了这个问题和答案`XMLHttpRequest`：

```
var reqObj = new XMLHttpRequest();

//event Handler
reqObj.upload.addEventListener("progress", uploadProgress, false);
reqObj.addEventListener("load", uploadComplete, false);
reqObj.addEventListener("error", uploadFailed, false);
reqObj.addEventListener("abort", uploadCanceled, false);

//open the object and set method of call (post), url to call, isAsynchronous(true)
reqObj.open("POST", $rootUrlService.rootUrl + "Controller/UploadFiles", true);

//set Content-Type at request header.for file upload it's value must be multipart/form-data
reqObj.setRequestHeader("Content-Type", "multipart/form-data");

//Set header properties : file name and project milestone id
reqObj.setRequestHeader('X-File-Name', name);

// send the file
// this is the line where the error occurs
reqObj.send(fileToUpload); 
```

**删除线`reqObj.setRequestHeader("Content-Type", "multipart/form-data");`解决了问题。**

**注意：**此错误在其他浏览器中的显示方式非常不同。即 Chrome 显示类似于连接重置的内容，类似于 Fiddler 报告的内容（由于连接突然关闭而导致的空响应）。

此外，仅当从不同于`WebServer`（本地主机上没有问题）的机器上完成上传时才会出现此错误。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2016-02-23T17:11:16.307

我只想添加为我解决此问题的方法，因为它与上述所有答案都不同。

导致问题的 ajax 调用试图传递一个空的数据对象。看来 IE 不喜欢这样，但其他浏览器不介意。

为了解决这个问题，我只是`data: {},`从 ajax 调用中删除了。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2016-03-15T12:06:49.670

随着 Apache 2 的更改`KeepAliveTimeout` ，将其设置为 60 或更高

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2014-09-29T01:07:40.657

将虚拟主机中 KeepAliveTimeout 的指令提高到 60 为我解决了这个问题。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2016-03-29T05:06:05.340

在我的asp.net项目中遇到了同样的问题，最后我发现问题是目标函数不是静态的，我把关键字静态后问题就解决了。

```
[WebMethod]
public static List<string> getRawData() 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2016-11-29T08:47:18.757

**[解决了]**

我今天才观察到这个错误，但对我来说错误代码是不同的。

> SCRIPT7002：XMLHttpRequest：网络错误 0x2efd，由于错误 00002efd，无法完成操作。

它是随机发生的，并非一直发生。但它注意到的是，如果它用于后续的 ajax 调用。所以我在 ajax 调用之间***放了 5 秒的延迟，它解决了。***

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2018-11-07T15:54:26.160

如果这些解决方案都不够“清晰”，那么基本上 IE/Edge 无法正确解析 AJAX 调用的“数据”字段。您很可能正在发送“编码”JSON 对象。

什么失败： `"data": "{\"Key\":\"Value\"}"`,

什么有效： `"data":'{"Key":"Value"}'`

# c# - 使用 XPath 过滤来自 XmlDataProvider 的 XML 数据

> ID：14527392
> 
> 赞同：2
> 
> 时间：2013-01-25T17:42:47.917
> 
> 标签：c#, wpf, xml, xpath

我有一个`xml`这样的文件：

```
<Organizations xmlns="">
    <Organization  Title ="dfs" Score="70">
        <Layer  Title ="lar"></Layer>
    </Organization>
    <Organization  Title ="srwrg" Score="70">
        <Layer  Title ="asdf"></Layer>
        <Layer  Title ="lfdkj"></Layer>
    </Organization>
</Organizations> 
```

我在我的 WPF 项目中使用这个文件：（这里是一个资源）

```
<XmlDataProvider x:Key="myData" Source="Data\farsDataOrganization.xml" XPath="//Organizations/Organization"/>

<CollectionViewSource x:Key="MyCVS" >
        <CollectionViewSource.Source>
            <Binding Source="{StaticResource myData}"/>
        </CollectionViewSource.Source>
        <CollectionViewSource.SortDescriptions>
            <scm:SortDescription PropertyName="@Title" Direction="Ascending"/>
        </CollectionViewSource.SortDescriptions>
    </CollectionViewSource> 
```

我知道如何根据组织`Title`或图层制作过滤器`Title`：

```
 XmlDataProvider p = (XmlDataProvider)this.FindResource("myData");
 p.XPath = string.Format("//Organizations/Organization[Layer[contains(@Title,\"{0}\")]]", this.layerNameFilter.Text); 
```

**但**我想根据组织`Title`和图层过滤这些数据`Title`。有什么建议吗？如何更改我的`XPath`字符串以便我获得基于它们的过滤器？

**编辑**

我在 a 上显示这些数据`TreeView`：

```
 <TreeView Grid.Row="1" ItemsSource="{Binding Source={StaticResource MyCVS}}">
     <TreeView.Resources>
         <HierarchicalDataTemplate DataType="Organization" ItemsSource="{Binding XPath=Layer}">
             <StackPanel Orientation="Vertical" Width="340" Margin="0,0,0,5">
                 <Label Content="{Binding XPath=@Title}" FontSize="13" Margin="0,0,0,-5"></Label>
            </StackPanel>
        </HierarchicalDataTemplate>
    </TreeView.Resources>
</TreeView> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-25T17:49:38.177

```
XmlDataProvider p = (XmlDataProvider)this.FindResource("myData");
p.XPath = string.Format("//Organizations/Organization[contains(@Title,\"{0}\")]/Layer[contains(@Title,\"{1}\")]", 
                        this.orgTitleFilter.Text, 
                        this.layerNameFilter.Text); 
```

# java - java哈希码返回值

> ID：14527397
> 
> 赞同：1
> 
> 时间：2013-01-25T17:43:08.497
> 
> 标签：java, hash, hashcode

基本上我正在使用 Objects 类中的 hasCode() 来获取一些字符串的哈希码。

我希望该数字代表数组中的一个位置。基本上是一个哈希表。我还没有为此编写代码。

我想到了：

```
 int hashNumber = SomeString.hascode(), pos; 
 String array[] = new String[10];

 if (hashNumber > 0)
   pos = hashNumber % array.length
 if (hasNumber < 0 )
   //dont know what to do 
```

我确实知道 hashCode 可以返回一个负整数。如果是负整数怎么办？我虽然关于添加数组长度

```
 pos = hashNumber + array.length 
```

这是最好的方法吗？

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-25T17:48:11.303

如果`hashNumber`是负数，只需获取`-hashNumber`（将是正数）的 mod：

```
if (hashNumber >= 0)
  pos = hashNumber % array.length
else
  pos = -hashNumber % array.length 
```

或者对于两者都适用的单个表达式：

```
pos = (hashNumber % array.length + array.length) % array.length 
```

请参阅有关 Java 对 mod 和负数的行为的问题的[答案。](https://stackoverflow.com/a/4412200/505154)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T19:25:16.590

[http://docs.oracle.com/javase/specs/jls/se5.0/html/expressions.html#15.17.3](http://docs.oracle.com/javase/specs/jls/se5.0/html/expressions.html#15.17.3)

> 结果的符号等于被除数的符号。

有关更多讨论，请参见此处：[Java 如何使用负数进行模数计算？](https://stackoverflow.com/questions/4403542/how-does-java-do-modulus-calculations-with-negative-numbers)

为了安全起见，您可以简单地使用`pos = Math.abs(hashNumber) % array.length`

# csv - 将 CSV 文件导入 iCal

> ID：14527398
> 
> 赞同：2
> 
> 时间：2013-01-25T17:43:10.573
> 
> 标签：csv, applescript, icalendar

我在 word doc 表中获得了我的教学计划和学期计划。我想知道是否有办法将这些数据输入 iCal。在 iCal 中创建事件比将这些表复制到 excel 文件并从那里导入 iCal 需要更长的时间。

数据将是一天的事件，即 House-Gala Friday 22/02/2013，其余数据将是 2 周或 3 周的事件，即 3 周 - Gr.10 数学 - 主题：指数（这些事件将是 5日事件（周一至周五）重复三周。）

这是我从互联网上获得的脚本 - 但它给出的第一个错误是它无法将 .csv 文件文本转换为 Unicode 类型。

脚本后面的另一个问题是让这 5 天的事件重复 3 或 2 周。

任何帮助将不胜感激。这是我迄今为止所拥有的：

```
 --Convert CSV file to iCal events
  --Prompts for file, then processes
  --expects date,start time,end time,event name,xxxx,calendar name
  --eg 12/01/2006,20:30,22:00,Water Committee,,TestCal
  --change the various text item ns if data order in a file line is different
  --blank lines skipped
  --if other data present (eg location, notes ...) add a line in the tell calendar Calno loop
--to include it eg set location to text item 5 of ThisLine
set OldDelimiters to AppleScript's text item delimiters
set LF to ASCII character 10
set theFile to choose file with prompt "Select CSV calendar file"
set theLines to read theFile
set AppleScript's text item delimiters to {LF}
set theLines to paragraphs of theLines
set AppleScript's text item delimiters to {","}
repeat with ThisLine in theLines
    if (count of ThisLine) > 0 then --ignore blanks
        set StartDate to date (text item 1 of ThisLine & " " & text item 2 of ThisLine)
        set EndDate to date (text item 1 of ThisLine & " " & text item 3 of ThisLine)
        set CalName to word 1 of text item 6 of ThisLine
        tell application "Calendar"
            set CalList to title of every calendar
            if CalName is in CalList then
                repeat with CalNo from 1 to count of CalList
                    if CalName is item CalNo of CalList then exit repeat
                end repeat
            else
                set NewOne to make new calendar at end of calendars with properties {title:CalName}
                set CalNo to 1 + (count of CalList)
            end if
            tell calendar CalNo
                set newItem to make new event at end of events with properties {start date:StartDate}
                set summary of newItem to text item 4 of ThisLine
                set end date of newItem to EndDate
            end tell --calendar
        end tell --iCal
    end if
end repeat
set AppleScript's text item delimiters to OldDelimiters 
```

好的，感谢您的回复，这是我到目前为止所拥有的，我无法使用 NumberCount 作为事件重复的 COUNT：

```
set text item delimiters to ";"
repeat with l in paragraphs of (read "/Users/pienaar0/Desktop/test.csv" as «class utf8»)
if contents of l is not "" then
    set sd to date (text item 1 of l & " ")
    set ed to date (text item 2 of l & " ")
    set NumberWeeks to (text item 4 of l & " ")
    set NumberCount to NumberWeeks - 1
    tell application "Calendar" to tell calendar "Test"
        make new event with properties {allday event:true, start date:sd, end date:ed, summary:text item 3 of l, recurrence:"FREQ=WEEKLY;COUNT=2 * NumberCount"}

    end tell
end if
 end repeat 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T20:07:59.630

```
set text item delimiters to ","
repeat with l in paragraphs of (read "/Users/username/Desktop/test.csv" as «class utf8»)
    if contents of l is not "" then
        set sd to date (text item 1 of l & " " & text item 2 of l)
        set ed to date (text item 1 of l & " " & text item 2 of l)
        tell application "Calendar" to tell calendar "Test"
            make new event with properties {start date:sd, end date:ed, summary:text item 4 of l}
        end tell
    end if
end repeat 
```

测试.csv：

```
01/25/2013,10:30PM,11:00PM,test event
01/26/2013,00:00AM,01:00AM,test event2 
```

# c# - wpf中的依赖属性？在某些情况下禁用更改通知？

> ID：14527399
> 
> 赞同：0
> 
> 时间：2013-01-25T17:43:12.507
> 
> 标签：c#, wpf

> **可能重复：**
> [设置 WPF 依赖项属性而不触发事件](https://stackoverflow.com/questions/154184/setting-wpf-dependency-property-without-triggering-events)

这可能是一个完全的菜鸟问题，但是 WPF 中有没有办法在控件上设置依赖属性但不触发属性更改事件处理程序？

所以，我试图在一个控件上设置一个依赖属性“A”，当“A”发生变化时，该控件具有一些内置的自定义逻辑。

现在，我想设置属性“A”但不触发更改的事件处理程序中的逻辑......？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T18:13:53.337

您可以创建自己的继承自它的控件。然后覆盖您要自定义的事件处理程序并添加逻辑以确定是否取消事件。

# r - 是否可以减少或清除 R 的全局字符串缓存的大小？

> ID：14527401
> 
> 赞同：9
> 
> 时间：2013-01-25T17:43:22.237
> 
> 标签：r

这与我之前的问题有关[释放 R 中的内存](https://stackoverflow.com/questions/14450039/freeing-up-memory-in-r/14513412#comment20253355_14513412)

并且想知道是否可以减少或清除 R 的全局字符串缓存的大小？...我听说它只能上升？

如果有可能，你是怎么做到的？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T14:05:32.743

我不相信这是真的。看起来[垃圾收集器代码](https://github.com/wch/r-source/blob/trunk/src/main/memory.c#L1581)标记了未使用的 CHARSXP（字符向量的各个缓存组件）并将它们删除。

# json - JSON 不验证

> ID：14527407
> 
> 赞同：-1
> 
> 时间：2013-01-25T17:44:06.343
> 
> 标签：json, string, validation

下面是我试图在 json 上验证的代码。但我不断收到“预期字符串”错误。请帮忙

```
 {
'auth.login': {
    'url': 'https: //api.optionshouse.com/m',
    'params': {
        'EZMessage': {
            'action': 'auth.login',
            'data': {
                'userName': 'rspt',
                'password': 'xxx'
            }
        }
    }
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T17:46:05.810

JSON 不允许使用单引号字符串。

您需要使用双引号。

# css - 使用@font-face 定义小型大写字体变体

> ID：14527408
> 
> 赞同：5
> 
> 时间：2013-01-25T17:44:11.197
> 
> 标签：css, font-face

如何添加小型大写字体作为变体？

我正在使用 Jos Buivenga 的 Fontin，它的小型大写字母变体是一种单独的字体，而不是一种 OpenType 风格的功能。这个 CSS 片段正确定义了该系列中的常规、粗体和斜体字体，但没有定义小型大写字体。我怎样才能使这项工作？

```
/* A font by Jos Buivenga (exljbris) -> www.exljbris.com */
@font-face {
    font-family: "Fontin";
    src: url(../Fonts/Fontin-Regular.ttf) format("truetype");
}

@font-face {
    font-family: "Fontin";
    font-style: italic;
    src: url(../Fonts/Fontin-Italic.ttf) format("truetype");
}

@font-face {
    font-family: "Fontin";
    font-weight: bold;
    src: url(../Fonts/Fontin-Bold.ttf) format("truetype");
}

@font-face {
    font-family: "Fontin";
    font-variant: small-caps;
    src: url(../Fonts/Fontin-SmallCaps.ttf) format("truetype");
} 
```

相关：*[如何为同一种字体添加多个字体文件？](https://stackoverflow.com/q/2436749/95580)*并*[在@font-face CSS 规则中正确定义字体系列](https://stackoverflow.com/q/10364458/95580)*。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-25T23:13:56.553

不幸的是，似乎有效的方法是将小型大写字体伪装成一个字体系列，用例如声明它

```
@font-face {
    font-family: "Fontin Small Caps";
    src: url(Fontin-SmallCaps.ttf) format("truetype");
} 
```

（注意缺少`font-style`设置，将其默认为`normal`）并使用类似的规则

```
p { font-family: Fontin Small Caps; } 
```

无需设置`font-style`。

如问题中所述，使用逻辑方式进行测试，并使用[http://www.exljbris.com/fontin.html](http://www.exljbris.com/fontin.html)中的 .ttf 字体我注意到 Firefox、Chrome、Opera 都应用“假小写字母”（即, 缩小大小的大写字母），当我设置`font-family: Fontin; font-variant: small-caps;`. 这很可悲，但并不令人惊讶。

奇怪的是，当我只设置`font-family: Fontin`. 如果我删除`@font-face`具有`font-style: small-caps`. 因此，浏览器对使用小写字母的逻辑方式非常敌对。

# ruby-on-rails - 在 Rails 中将 http://domain.com/subpage 重定向到 http://www.domain.com/subpage

> ID：14527409
> 
> 赞同：1
> 
> 时间：2013-01-25T17:44:14.203
> 
> 标签：ruby-on-rails, redirect, dns

我认为这并不是一个真正困难的问题，但我使用了这么多不同的解决方案，并不真正知道什么是最好的。

我正在使用 Ruby on Rails 并将我的应用程序放在 Heroku 上，我想 301 将我的裸域 (@) 上的所有内容重定向到我的 www 域。例如

[http://domain.com](http://domain.com) --> [http://www.domain.com](http://www.domain.com) http://domain.com/subpage --> [http://www.domain.com/subpage](http://www.domain.com/subpage)

现在我正在用我的 DNS 处理这个问题，首先删除 @ 和 www 条目。然后我将整个网站的重定向设置为[http://www.domain.com](http://www.domain.com)（它为 @ 和 www 重新创建 DNS 条目）。最后，我将我的 www DNS-entry 更改为 CNAME 和 heroku-app 的名称 (http://myapp.herokuapp.com)。

这似乎将[http://domain.com/subpage](http://domain.com/subpage)转发到[http://www.domain.com](http://www.domain.com)（没有子页面）。

我现在正在寻找的是以简单/优雅的方式处理此问题的正确/推荐方法。

域名系统？路线？.ht 访问？（如果是这样，我如何在 RubyOnRails 中更改 .htaccess）

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T17:57:09.050

[这些](https://stackoverflow.com/questions/4372896/rails-ensuring-www-is-in-the-url) [问题](https://stackoverflow.com/questions/5389575/heroku-how-to-redirect-http-to-http-www)可能与您的问题有关，也许看看那些。似乎（根据我的阅读），heroku 不允许访问 .htaccess 之类的东西或任何东西，所以看起来 Rack 中间件是最好的选择。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-25T18:10:39.733

您的域名在哪里注册？如果使用 GoDaddy，他们会提供一项服务来为您处理 301 重定向，但这需要您注册他们的托管计划之一。成本最低（每月约 5 美元）。不是免费的，而是无痛的，不需要编码等。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-25T19:34:48.503

（注意：没有尝试过这个，但它应该可以工作）

有人可能会争辩说，最好的*方法*是使用 DNS 或您的网络服务器功能来做到这一点。但是，如果需要，可以使用 rails 来完成。

总而言之，它的优点是您可以轻松地在过程中保留任何参数/路径，正如您所说的那样。另外，逻辑在应用程序内部，如果您需要扩展/更改域名，也不会丢失。不利的一面是，只要有人使用裸域名，您的完整堆栈就会受到打击。

`before_filter`您可以在您的应用程序控制器中尝试：

```
before_filter :redirect_to_www

def redirect_to_www
  redirect_to subdomain: 'www' unless request.subdomain == 'www'
end 
```

如果您想避免“魔术重定向”并让每个人都清楚，在 rails 3 上，您可以直接在路线中执行此操作：

```
constraints ->(request){ request.subdomain != 'www' } do
  match '(*all)' => redirect( subdomain: 'www' )
end 
```

您还应该将子域添加到您的默认 url 选项（应用程序控制器）：

```
def default_url_options( option = {} )
  {subdomain: 'www'}
end 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-04T07:19:32.310

最后，我要做的是将@-DNS 指向我的普通网络主机（因为@ 需要IP，而Heroku 只接受CNAME）并将www-DNS 指向Heroku。

在我的普通虚拟主机上，我放置了一个 .htaccess，将那里的所有流量重定向到我的 www 域，如下所示：

```
RewriteEngine On

### re-direct to www
RewriteCond %{HTTP_HOST} ^domain.com
RewriteRule (.*) http://www.domain.com/$1 [R=301,L] 
```

# php - 如何使用 regex / PHP / preg_match_all 处理未命中

> ID：14527411
> 
> 赞同：0
> 
> 时间：2013-01-25T17:44:21.550
> 
> 标签：php, wordpress

我正在使用底部的代码从 wordpress 短代码中获取参数。简码本身如下所示：

```
[FLOWPLAYER=http://www.tvovermind.com/wp-content/uploads/2013/01/pll-316-21.jpg|http://www.tvovermind.com/wp-content/uploads/2013/01/PLL316_fv2.h264HD-Clip2.flv,440,280] 
```

或者

```
[FLOWPLAYER=http://www.tvovermind.com/wp-content/uploads/2013/01/pll-316-21.jpg|http://www.tvovermind.com/wp-content/uploads/2013/01/PLL316_fv2.h264HD-Clip2.flv,440,280,false] 
```

我想要发生的是，如果缺少额外的参数（假/真），那么匹配变为“假”，但是如果参数丢失，则使用当前代码永远不会进行匹配。有任何想法吗？

```
function legacy_hook($content){
    $regex = '/\[FLOWPLAYER=([a-z0-9\:\.\-\&\_\/\|]+)\,([0-9]+)\,([0-9]+)\,([a-z0-9\:\.\-\&\_\/\|]+)\]/i';
        $matches = array();
    preg_match_all($regex, $content, $matches);
    if($matches[0][0] != '') {
        foreach($matches[0] as $key => $data) {
            $content = str_replace($matches[0][$key], flowplayer::build_player($matches[2][$key], $matches[3][$key], $matches[1][$key],$matches[4][$key]),$content);
        }   
    }
    return $content;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T17:57:13.047

您的正则表达式正在寻找最后一个逗号以及最后一组括号中的一个或多个字符。就像是

`/\[FLOWPLAYER=([a-z0-9\:\.\-\&\_\/\|]+)\,([0-9]+)\,([0-9]+)(\,[a-z]+)?\]/i`

唯一的问题是你也会在比赛中得到逗号。

可能是你所追求的，那么你必须测试最后一场比赛是否存在。preg_match_all 返回匹配的数量，所以你可以使用它，或者你可以做一个内联 if...

`(count($matches) > 4 ? $matches[4][$key] : false)`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T17:55:47.340

您可以在表达式末尾添加 OR

```
(,true|,false|$) 
```

我没有检查它是否有效，但你明白了。

# c++ - 我怎样才能找到最大的两个小于没有循环的数字的幂？

> ID：14527421
> 
> 赞同：3
> 
> 时间：2013-01-25T17:45:13.577
> 
> 标签：c++, algorithm

我怎样才能找到最大的两个小于没有循环的数字的幂？例子：

```
5 output = 4.
11 output = 8.
100 output = 64. 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-25T17:51:37.807

用 int 做的一个有点摆弄的方法是：

```
// given an int number (which would be the upper value of the range)
number |= number >> 1;
number |= number >> 2;
number |= number >> 4;
number |= number >> 8;
number |= number >> 16;
return (number >> 1) + 1; 
```

这个想法是将 01010 之类的东西变成 01111，移位一次得到 00111，然后加一得到 01000 的结果。

要了解其工作原理，请考虑输入为 0 或非零。如果它是 0，那么结果是 0+1，因为所有的移位和 oring 只会导致 0（2 的 0 次方是 1，2 的最低幂，输入 0 的答案）。

对于非零数字，位中的某处是该值的最高有效设置位。我们想要的答案是该位没有跟踪它的所有次要有效位。所以专注于那一点，因为那是我们真正关心的。当我们对第一个右移 1 进行按位或运算时，我们确保设置的最高有效位仍然被设置，并且比它低 1 的位也被设置，因为 0100 | 0010 = 0110。接下来我们将其与自身进行 OR，但这次移动了 2。这确保我们有 MSB 加上 3 个尾随位。我们一直这样做，直到达到 int 中的位数限制。下面是一个完整的 32 位值示例的分步说明：

```
01000000110100111000000011010011

01000000000100000000000010000010 |
00100000000010000000000001000001 = 01100000000110000000000011000011 (num |= num >> 1)

01100000000110000000000011000011 |
00011000000001100000000000110000 = 01111000000111100000000011110011 (num |= num >> 2)

01111000000111100000000011110011 |
00000111100000011110000000001111 = 01111111100111111110000011111111 (num |= num >> 4)

01111111100111111110000011111111 |
00000000011111111001111111100000 = 01111111111111111111111111111111 (num |= num >> 8)

01111111111111111111111111111111 |
00000000000000000111111111111111 = 01111111111111111111111111111111 (num |= num >> 16) 
```

现在剩下要做的就是将最终值右移一位，然后加一以将所有这些 1 变为 0，除了将我们所需答案的位设置为 1 的最高有效进位。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-01-25T17:52:15.017

假设您想要小于 x 的 2 的最大幂，您可以从

```
Ans=pow(2,floor(log(x)/log(2))); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-25T18:05:42.777

如果 n 是范围的最大数

```
return int(math.log(n, 2)); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-25T18:01:04.113

您可以采用基于 2 的数字的对数，这将为您提供权力，或者，如果它是一个整数，则获取最高位集的位置（但这可能需要一个循环）。

我有一段时间没有做过 C++，但在 C# 中它会是：

```
 double val = 129;
        int power = (int)(Math.Log10(val) / Math.Log10(2)); 
```

使用 log [n] (X) = log [y] (X) / log [y] (n)的规则

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-25T20:18:21.147

```
// This only works if i >= 0, and it may overestimate by one power of 2
// if i is slightly less than a large power of 2\. Fixing these issues is
// not difficult, so it's left as an exercise.
long largest_power_of_two(long i) {
  int exp;
  frexp(double(i), &exp);
  return long(ldexp(0.5, exp));
} 
```

`frexp`并且`ldexp`只是摆弄比特，所以那里甚至没有隐藏循环（可能在微架构层除外）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-26T04:33:54.067

如果可用，您可以使用特殊的 CPU 指令，例如 x86 `BSR`。

如果您可以在没有循环的情况下对数字进行位还原（也许，使用查找表或其他特殊的 CPU 指令），那么您可以还原数字，找到设置为 1 的最低有效位，重置其他位并将其还原。

```
unsigned IsolateLeastSignificantOne(unsigned n)
{
  return n & -n;
}

n = BitRevert(IsolateLeastSignificantOne(BitRevert(n))); 
```

有关小技巧和其他有用的信息，请参阅[此文档](http://www.jjj.de/fxt/)。

# xcode - 当与 Objective-C 宏发生冲突时，在 Objective-C++ 中包含 C++ 头文件

> ID：14527423
> 
> 赞同：2
> 
> 时间：2013-01-25T17:45:15.753
> 
> 标签：xcode, clang, objective-c++

在 Xcode 中，我创建了一个“Cocoa 应用程序”项目。它的依赖项之一是包含 C++ 代码的框架。我将 AppDelegate.m 重命名为 AppDelegate.mm 并包含了框架。

该项目无法编译。问题是框​​架中的 C++ 头文件使用了一些与 Objective-C 或 Cocoa 冲突的符号。

*   C++ 头文件定义了名为`verify()`and的函数`check()`，这与 MacOSX10.8 SDK 中的 /usr/include/AssertMacros.h 冲突。
*   C++ 头文件包含一个名为 的变量`NO`，它与 Objective-C 宏冲突`NO`。

一种解决方法是修改框架中的 C++ 代码以避免这些冲突。但由于它是由另一个组织维护的大型 C++ 项目，这将需要时间，并且可能会在 C++ 项目的未来更新中中断。

有没有办法告诉 Clang/Xcode 将这些 C++ 头文件视为 C++ 而不是 Objective-C++？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T18:51:32.163

通读`/usr/include/AssertMacros.h`Mac OS 10.8 附带的，看起来你可以这样做：

```
#define __ASSERT_MACROS_DEFINE_VERSIONS_WITHOUT_UNDERSCORES 0 
```

在 include 之前`AssertMacros.h`，这将阻止它定义名为`verify()`and的宏`check()`。

关于`NO`：您可以使用预处理器为您重命名该变量。例如：

```
#define NO NO_libraryname_renamed
#include <libraryname.hh>
#undef NO 
```

根据`NO`库使用变量的方式，这可能会导致问题 - 如果标头将其声明为`extern`，那么您的 Cocoa 应用程序将通过错误的名称引用它，并且您将收到未定义符号错误。但只要您不使用该变量，并且该库不依赖于您的应用程序来定义该变量，那么您应该没问题。

*（并且请向有问题的库提交错误报告，要求他们重命名变量。）*

* * *

## 回答 #2

> 赞同：-4
> 
> 时间：2013-01-25T18:11:14.287

混合几种语言*是*需要悲伤的。将Objective C++（本身就是一个奇怪的混合体）与C++混合更是如此。不要这样做。

# xslt - XslCompiledTransform.Transform 将 """ 替换为实引号

> ID：14527431
> 
> 赞同：1
> 
> 时间：2013-01-25T17:45:59.850
> 
> 标签：xslt, double-quotes, xslcompiledtransform

做这样的事情：

```
using (XmlWriter myMamlHelpWriter = XmlWriter.Create(myFileStream, XmlHelpExToMamlXslTransform.OutputSettings))
{
    XmlHelpExToMamlXslTransform.Transform(myMsHelpExTopicFilePath, null, myMamlHelpWriter);
} 
```

在哪里

```
private static XslCompiledTransform XmlHelpExToMamlXslTransform
{
    get
    {
        if (fMsHelpExToMamlXslTransform == null)
        {
            // Create the XslCompiledTransform and load the stylesheet.
            fMsHelpExToMamlXslTransform = new XslCompiledTransform();
            using (Stream myStream = typeof(XmlHelpBuilder).Assembly.GetManifestResourceStream(
                typeof(XmlHelpBuilder),
                MamlXmlTopicConsts.cMsHelpExToMamlTransformationResourceName))
            {
                XmlTextReader myReader = new XmlTextReader(myStream);
                fMsHelpExToMamlXslTransform.Load(myReader, null, null);
            }
        }

        return fMsHelpExToMamlXslTransform;
    }
} 
```

并且每次字符串 """ 替换为结果文件中的实引号。
无法理解为什么会发生这种情况......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T18:07:05.507

**The XSLT processor doesn't know whether a character was represented by a character entity or not. This is because the XML parser substitutes any character entity with its code-value**.

Therefore, the XSLT processor would see exactly the same character, regardless whether it was represented as " or as `&quot;` or as `&#x22;` or as `&#34;`.

What you want can be achieved in XSLT 2.0 by using the so called **["character maps"](http://www.w3.org/TR/xslt20/#character-maps)**.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-25T18:00:12.547

原因是在 XSLT 的内部表示中，`&quot;`与`"`. 它们都代表 ascii 代码点 0x34。看起来，当 XslCompiledTransform 产生其输出时，它使用`"`了合法的地方。我想它仍然会`&quot;`在属性值内输出。

在输出`&quot;`中产生的问题对您来说是一个问题吗？`"`

我刚刚使用任意输入文件在 Visual Studio 中运行了以下 XSLT：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
  <xsl:output method="xml" indent="yes"/>

  <xsl:template match="/*">
    <xml>
      <xsl:variable name="chars">&quot;&apos;&lt;&gt;&amp;</xsl:variable>
      <node a='{$chars}' b="{$chars}">
        <xsl:value-of select="$chars"/>
      </node>
    </xml>
  </xsl:template>
</xsl:stylesheet> 
```

输出是：

```
<xml>
  <node a="&quot;'&lt;&gt;&amp;" b="&quot;'&lt;&gt;&amp;">"'&lt;&gt;&amp;</node>
</xml> 
```

正如您所看到的，即使所有五个字符最初都表示为实体，但撇号的产生是`'`随处可见的，引号是`"`在文本节点中产生的。此外，`a`具有分隔符的属性在输出中`'`使用分隔符。`"`正如我所说，就 XSLT 而言，引号只是一个引号，一个属性只是一个属性。如何在输出中产生这些取决于 XSLT 处理器。

**编辑：**此行为的根本原因似乎是 XmlWriter 类的行为。对于那些想要更多自定义转义的人来说，一般建议是扩展`XmlTextWriter`类。 [这个页面](http://bytes.com/topic/net/answers/178105-xmldocument-converts-quot)有一个看起来相当有前途的实现：

```
public class KeepEntityXmlTextWriter : XmlTextWriter
{
    private static readonly string[] ENTITY_SUBS = new string[] { "&apos;", "&quot;" };
    private static readonly char[] REPLACE_CHARS = new char[] { '\'', '"' };

    public KeepEntityXmlTextWriter(string filename) : base(filename, null) { ; }

    private void WriteStringWithReplace(string text)
    {
        string[] textSegments = text.Split(KeepEntityXmlTextWriter.REPLACE_CHARS);

        if (textSegments.Length > 1)
        {
            for (int pos = -1, i = 0; i < textSegments.Length; ++i)
            {
                base.WriteString(textSegments[i]);
                pos += textSegments[i].Length + 1;

                // Assertion: Replace the following if-else when the number of
                // replacement characters and substitute entities has grown
                // greater than 2.
                Debug.Assert(2 == KeepEntityXmlTextWriter.REPLACE_CHARS.Length);

                if (pos != text.Length)
                {
                    if (text[pos] == KeepEntityXmlTextWriter.REPLACE_CHARS[0])
                        base.WriteRaw(KeepEntityXmlTextWriter.ENTITY_SUBS[0]);
                    else
                        base.WriteRaw(KeepEntityXmlTextWriter.ENTITY_SUBS[1]);
                }
            }
        }
        else base.WriteString(text);
    }

    public override void WriteString( string text)
    {
        this.WriteStringWithReplace(text);
    }
} 
```

另一方面，[MSDN 文档](http://msdn.microsoft.com/en-us/library/system.xml.xmltextwriter.writestring.aspx)建议使用`XmlWriter.Create()`而不是直接实例化 XmlTextWriters。

> > 在 .NET Framework 2.0 版本中，推荐的做法是使用 XmlWriter.Create 方法和 XmlWriterSettings 类创建 XmlWriter 实例。这使您可以充分利用此版本中引入的所有新功能。有关更多信息，请参阅创建 XML 编写器。

解决这个问题的一种方法是使用与上面相同的逻辑，但将其放在一个包装`XmlWriter`. [此页面](https://mvpxml.svn.codeplex.com/svn/Library/Main/Source/Common/XmlWrappingWriter.cs)有一个现成的 XmlWrappingWriter 实现，您可以根据需要对其进行修改。

要将上面的代码与`XmlWrappingWriter`.

```
public class KeepEntityWrapper : XmlWrappingWriter
{
    public KeepEntityWrapper(XmlWriter baseWriter)
        : base(baseWriter)
    {
    }

    private static readonly string[] ENTITY_SUBS = new string[] { "&apos;", "&quot;" };
    private static readonly char[] REPLACE_CHARS = new char[] { '\'', '"' };

    private void WriteStringWithReplace(string text)
    {
        string[] textSegments = text.Split(REPLACE_CHARS);

        if (textSegments.Length > 1)
        {
            for (int pos = -1, i = 0; i < textSegments.Length; ++i)
            {
                base.WriteString(textSegments[i]);
                pos += textSegments[i].Length + 1;

                // Assertion: Replace the following if-else when the number of
                // replacement characters and substitute entities has grown
                // greater than 2.
                Debug.Assert(2 == REPLACE_CHARS.Length);

                if (pos != text.Length)
                {
                    if (text[pos] == REPLACE_CHARS[0])
                        base.WriteRaw(ENTITY_SUBS[0]);
                    else
                        base.WriteRaw(ENTITY_SUBS[1]);
                }
            }
        }
        else base.WriteString(text);
    }

    public override void WriteString(string text)
    {
        this.WriteStringWithReplace(text);
    }
} 
```

请注意，这与 基本相同的代码`KeepEntityXmlTextWriter`，但使用 XmlWrappingWriter 作为基类并使用不同的构造函数。

我不知道`Guard`代码`XmlWrappingWriter`在两个地方使用，但鉴于您将自己使用代码，删除这样的行应该是非常安全的。他们只是确保不会将空值传递给构造函数或（在上述情况下不可访问）`BaseWriter`属性：

```
Guard.ArgumentNotNull(baseWriter, "baseWriter"); 
```

要创建 的实例`XmlWrappingWriter`，您可以根据需要创建一个 XmlWriter，然后使用：

```
KeepEntityWrapper wrap = new KeepEntityWrapper(writer); 
```

然后您将使用此`wrap`变量作为您传递给 XSL 转换的 XmlWriter。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-03-23T14:47:43.263

这是您想要的技巧：

1.  全部替换`&`为`&amp;`
2.  执行 XSLT
3.  全部替换`&amp;`为`&`

# android - Android：进度轮错误

> ID：14527435
> 
> 赞同：-1
> 
> 时间：2013-01-25T17:46:09.227
> 
> 标签：android, eclipse, show, progressdialog, android-progressbar

晚安，我试图在 onClick 函数启动时创建一个进度旋转轮，但我从 eclipse 中得到一个错误，似乎它不起作用。

这是我的代码

```
 hwdebug.setOnClickListener(new View.OnClickListener() {
        @Override
        public void onClick(View v) {
            ProgressDialog MyDialog = ProgressDialog.show( this, "TEST" , "Loading. Please wait ... ", false);
                  // FUNCTION
            MyDialog.dismiss();
                                    }
    } 
```

我从 eclipse 得到的错误是：

> ProgressDialog 类型中的方法 show(Context, CharSequence, CharSequence, boolean) 不适用于参数 (new View.OnClickListener(){}, String, String, boolean)

有什么建议吗？谢谢 ：）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-25T17:47:55.030

改变

```
ProgressDialog MyDialog = 
       ProgressDialog.show( this, "TEST" , "Loading. Please wait ... ", false); 
```

至

```
ProgressDialog MyDialog =
                          ProgressDialog.show( CurrentActivity.this, "TEST" ,
                                 "Loading. Please wait ... ", false); 
```

使用 Current Activity Context 而不是 View 来显示 ProgressDialog 或者您可以通过使用获取 Context`v.getContext()`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T17:47:19.153

用这个 ：

```
ProgressDialog MyDialog = ProgressDialog.show( yourActivity.this, "TEST" , "Loading. Please wait ... ", false); 
```

# jquery - jQuery将表单提交到新标签？

> ID：14527436
> 
> 赞同：24
> 
> 时间：2013-01-25T17:46:10.943
> 
> 标签：jquery

我有一个表单中的操作链接，需要每分钟更新一个令牌。当用户单击提交按钮时，我从 api 调用中获取新的 url/token。我正在使用这样的东西

```
 <form id="somelink" action="http://some.external.url/" target="_blank" />

 $('#somebutton').click(function(e) {
      e.preventDefault();
      var url = '/apicall?id=' + $('#someid').val();                  
      $.post(url, function(data) {
           $('#somelink').attr('action', data);
           $('#somelink').submit(); 
```

问题是，在提交时使用 js/jQuery，它会在一个新窗口中打开，而浏览器中没有典型的菜单和按钮，而且它的大小是弹出窗口的大小。

如果没有 jQuery，如果我只是单击按钮，它将在新选项卡中打开。

我怎样才能用 jQuery 做到这一点？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-01-25T17:53:24.797

不要捕获`click`事件，而是尝试捕获`submit`表单的事件，如果您发现任何错误，您可以使用 event.preventDefault();
**更新** 在这里我用这段代码测试过，它工作正常，

```
<!doctype html />
<html>
  <head>        
    <title></title>
    <script type="text/javascript" src="jquery.js"/></script>
</head>
<body>
  <form action='http://someSite.com' id='somelink' target='_blank'>
    <input type='text' name='lol' id='lol'/>
    <input type='submit'/>
  </form>
  <script type="text/javascript"/>
      $('#somelink').on('submit',function(e) {
          if($('#lol').val() == "poop"){ //Sample error check
              e.preventDefault();
              alert($('#lol').val());
          }
      });
  </script>
</body>
</html> 
```

这样做是，如果您输入“便便”，它不会提交表单，对于其他任何事情，它都会将表单提交到新选项卡。希望这会有所帮助:)
**更新：**
关于您的评论，如果出现错误，您想打开其他选项卡，然后替换`e.preventDefault()`为`$(this).attr({"action":"http://www.someothersite.com"});`. 希望这会有所帮助:)
**更新：**
如果你想异步打开一个标签，那么你会很难，这是它可以得到的最接近的。
HTML 部分

```
<form id="someForm" action="about:blank" target="newStuff" />
<input type="submit" value="12345" id="someid" /> 
```

Javascript 部分

```
$(document).ready(function() {
 $('#someForm').submit(function(e) {
    $.ajax({
        url: 'http://search.twitter.com/search.json?',
        dataType: 'jsonp',
        success: function(data) {
            if (data != "") {     
                var link = "http://www.google.com/";
                window.open(link,'newStuff'); //open's link in newly opened tab!
            }
        }
    });
 });
 }); 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2013-04-25T20:34:50.517

我遇到了同样的问题，这是我解决它的方法：

```
<form action="..." method="POST" target="_blank">
<input type="submit" id="btn-form-submit"/>
</form>
<script>
    $('#btn-submit').click( function(){ $('#btn-form-submit').click(); } );
</script> 
```

这会将表单提交到新选项卡 (_blank) 中，而无需使用本机提交按钮。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-06-19T05:00:16.133

```
jQuery("#availability_players_form").attr("target","_blank");

jQuery("#availability_players_form").submit(); 
```

在哪里`#availability_players_form = form id`

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-01-25T18:21:06.577

您已经定义了目标，`"_blank"`因此请尝试下面的代码并查看示例链接，而不是看到它是如何工作的.. 尝试`$.post`不提交，或者您可以使用`ajax`将数据保存在后台某处并将其发送到新选项卡..

```
$(document).ready(function() {
   $('#YourForm').submit(function() { // <---- Your form submit event
        $(this).target = "_blank"; // <---- to new tab
        $.post(url, function(data) {
            // whatever you wanna post do it here
        });
        window.open($(this).prop('action')); // <---- form action attribute = url
        return false; // <---- prevents submit
   });
});​ 
```

或使用 ajax

```
$(document).ready(function() {
    $('#YourForm').submit(function() { // <---- Your form submit event
        $(this).target = "_blank";  // <---- to new tab
        var json = $.toJSON({ yourjsondata1: data1, yourjsondata2: data2 });
        $.ajax({
            url: "/some/url",
            type: "POST",
            dataType: "json",
            data: json,
            contentType: "application/json; charset=utf-8",
            success: function (data) {
                window.open($(this).prop('action')); // <---- form action attribute = url
            }
        });
        return false; // <---- prevents submit
   });
});​ 
```

看这个例子：

[http://jquerybyexample.blogspot.com/2012/05/open-link-in-new-tab-or-new-popup.html](http://jquerybyexample.blogspot.com/2012/05/open-link-in-new-tab-or-new-popup.html)

**编辑：**

```
 $(document).ready(function() {
     $('#someid').click(function() {
         // lets say you got ur data from your post method
         var url = '/api?id=' + $('#someid').val(); 
         $.post(url, function(data) {
             if (data != '') {
                 // update your link
                 $('#somelink').attr('action', data);
                 // update target to new tab
                 $("#somelink").target = '_blank';
                 // than go
                 window.open($("#somelink").attr('action'));
                 return false;
             } else {
             }
         });
     });
 }); 
```

小提琴：http: [//jsfiddle.net/BerkerYuceer/nfTWL/](http://jsfiddle.net/BerkerYuceer/nfTWL/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-01-25T17:51:51.743

您可以使用`target="_newtab"`

```
<a href="some url" target="_newtab">content of the anchor</a> 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-01-25T17:57:43.500

默认情况下，除非表单位于模态/非模态窗口对话框中，否则表单会提交到同一个窗口。如果您的表单确实位于模态/非模态对话框中，则需要使用表单目标设置窗口名称。

```
<head>
<script type="text/javascript">
window.name = "posthereonly";
</script>
</head> 
```

并将表单目标更改为

```
 <form id="somelink" action="http://some.external.url/" target="posthereonly" /> 
```

看看它是否有帮助:)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-11-12T10:09:49.797

像这样简单的东西对你有用，不需要 Jake Weary - 只是香草 JavaScript：

```
<a href="javascript:document.forms['order_filter'].target='_blank';document.forms['order_filter'].submit();">Print</a> 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2013-06-19T05:08:58.293

这对我来说很好。我试过这个。它可能会帮助你。根据您的要求进行一些更改，它将起作用。

```
<form action="..." method="GET" target="_blank">
   <input type="submit" id-"btn-form-submit"/>
</form>
<script>
   $('#btn-submit').click( function(){ $('#btn-form-submit').click(); } );
</script> 
```

# javascript - Rails 3咖啡脚本控制器协会？

> ID：14527438
> 
> 赞同：0
> 
> 时间：2013-01-25T17:46:30.473
> 
> 标签：javascript, jquery, ruby-on-rails-3, coffeescript

好吧，我是 JS / JQuery / Coffeescript 菜鸟。这对某人来说可能很容易。

在成功实现了 RBate 的嵌套表单模型 railscast 之后，我试图在一个更简单的模型中重现这一点：章节有很多县。

我有一个`chapters.js.coffee`包含以下代码的文件：

```
jQuery ->
  $('form').on 'click', '.remove_fields', (event) ->
    $(this).prev('#destroy').val('1')
    $(this).closest('fieldset').hide()
    event.preventDefault() 
```

此代码在其他模型中运行良好。但不是在这里。

`_chapters_form.html.erb:`

```
<div class="row span12">    
<%= form_for(@chapter) do |f| %>
    <%= render 'shared/error_messages', object: f.object %>
    <div class="span2"><strong>Chapter name:</strong></div>
    <div class="span6"><%= f.text_field :name %></div>
    <div class="span2"><strong>Chapter Number:</strong></div>
    <%= f.number_field :chapter_num, class: "span2" %>
</div>
<div class="row span12">
<div class="span12">
    <%= f.fields_for :counties do |builder| %>
        <%= render 'county_fields', f: builder %>
    <% end %>
</div>
    <% if f.object.new_record? then link = 'Add the Chapter' else link = 'Update Chapter' end %>
      <%= f.submit "#{link}", class: "btn btn-large btn-primary" %>
      <%= link_to "Cancel", chapters_path, class: "btn btn-large btn-primary" %>
    <% end %>
</div> 
```

和：

`_county_fields.html.erb:`

```
<fieldset>
<div class="well span12">
    <div class="row span12">
        <div class="span3">County Number: <br /><i>(6-digit FIPS code)</i></div>
        <div class="span2"><%= f.number_field :county_num %></div>
        <div class="span2">County Name:</div>
        <div class="span5"><%= f.text_field :name %></div>
    </div>
    <div class="row span12"><hr></div>
    <div class="row span12">
        <div class="span6">Move to new Chapter:</div>
        <div class="span6"><%= select(:county, :chapter_id, Chapter.all.collect {|c| [c.name, c.id]}) %></div>
    </div>
    <div class="row span12">
        <div class="pull-right">
            <%= f.hidden_field :_destroy, id: "destroy" %>
            <%= link_to "remove county", "#", class: "remove_fields" %>
        </div>
    </div>
</div>
</fieldset> 
```

JS中没有错误。同样，菜鸟说话，但似乎没有调用 JS。单击`<%= link_to "remove county", "#", class: "remove_fields" %>`只是将 添加`#`到 URI。

我究竟做错了什么？

根据要求，[小提琴](http://jsfiddle.net/chiperific/A24D4/1/)中的 HTML 也不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T19:11:57.333

它们出现的页面——无论它们是如何呈现的——必须是要包含的`chapters_controller`for的操作`chapters.js.coffee`。我敢打赌，脚本根本不包括在内，因为代码看起来不错。查看您在使用此代码时遇到问题的页面：

```
jQuery ->
  console.log "included chapters.js.coffee"
  $('form').on 'click', '.remove_fields', (event) ->
    console.log "clicked .remove_fields"
    $(this).prev('#destroy').val('1')
    $(this).closest('fieldset').hide()
    event.preventDefault() 
```

此外，在您的问题中发布呈现的 HTML

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-27T00:22:48.593

您的 HTML 已损坏。在表单元素之前打开一个 div，然后在关闭表单之前关闭它。如果将表单元素向上移动到容器 div 内部，[它可以工作](http://jsfiddle.net/B638u/)。

```
<body>
  <div class="container-fluid">
    <form accept-charset="UTF-8" action="/chapters/7" class="edit_chapter" id="edit_chapter_7" method="post">
      <div class="row-fluid">
...
     </div>
    </form>
  </div>
</body> 
```

您应该更加小心 HTML 的缩进，以帮助避免这种简单的错误。代码格式很重要。

# android - USB通讯安卓

> ID：14527441
> 
> 赞同：1
> 
> 时间：2013-01-25T17:46:42.817
> 
> 标签：android, com, usb, host

我在与 USBHost 的 android 通信中使用 USBDevice 时仍然遇到一些问题：

按照此文档[http://developer.android.com/reference/android/hardware/usb/UsbDeviceConnection.html](http://developer.android.com/reference/android/hardware/usb/UsbDeviceConnection.html)

```
if (device!=null){

        intface = device.getInterface(0);
        endpoint = intface.getEndpoint(0);
        connection = manager.openDevice(device);
        connection.claimInterface(intface, forceClaim);
  if (connection.bulkTransfer(endpoint, buffer, buffer.length, 2000) >= 0) {

                           for(int it = 0; it < bytes.length; it++){                                                                                                                              

                                                sb.append((char) bytes[i]);

                                                   } 
```

当我展示讲座时，我读了一些额外的东西，比如一个充满“”或“p”或“a”的缓冲区，但与我想我收到的消息无关。

有谁知道我在哪里可以找到有关此功能的任何文档或有关与 android 进行这种通信的任何书籍？

谢谢 ！！！

劳拉。

# android - Windows 7 下的 adb shell 自动完成

> ID：14527443
> 
> 赞同：2
> 
> 时间：2013-01-25T17:46:43.223
> 
> 标签：android, shell, autocomplete, cygwin, adb

关于这篇文章：[adb shell auto-complete under Windows 7?](https://stackoverflow.com/questions/7831466/adb-shell-auto-complete-under-windows-7?answertab=votes#tab-top)

楼主的回答是：“通过在cygwin下重新编译adb解决了这个问题。:)”

不幸的是，我无法发送评论询问他如何在 cygwin 下重新编译 adb。

所以我的问题是：如何在 cygwin 下重新编译 adb 以使自动竞争在 adb 中工作？

编辑：我意识到，当我在 android bash 中输入时，实际上 cygwin 已经自动完成，但是没有显示文本。很奇怪，不是吗？例如：

```
# ls /data/tem 
```

[标签]

```
# ls/data/tem    | <<<--- the cursor jumps to here 
```

[进入]

它列出了**/data/temp**文件夹中的所有文件和文件夹。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-08-26T08:59:33.803

您可以使用 ADB 增强型 Putty

它支持自动完成和着色

![亚行增强型腻子](../Images/6e04a89187d806e56b746e70c3dea696.png)

您可以从 [ADB Putty下载它](https://github.com/sztupy/adbputty/downloads)

只需使用以下命令行启动它：

```
adb-putty.exe -adb -P 5037 transport-usb 
```

在 ADB 增强型 Putty 上阅读更多信息[（替换“adb shell”命令）](http://forum.xda-developers.com/showthread.php?t=803225)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-12-11T19:49:43.983

试试[腻子托盘](https://puttytray.goeswhere.com/)。它为我工作！

1.  通过“adb connect ip:port”连接到手机
2.  运行 Putty Tray，选择 Adb 并单击“打开”

PS。您可以在会话设置中指定设备 ID。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-26T02:57:48.430

我（幸运的是）不是 Windows 用户，但我想问题不在`adb`你的 shell 中，而是在你的 shell 中，它没有让某些键（即**TAB**）到达它。

试试这个，看看 android shell 是否收到了 TAB：

```
adb shell
# printf '%d\n' "'$(dd bs=1 count=1 2>/dev/null)"
<type TAB+ENTER>
9 
```

如果您看不到**9** (ascii **TAB** )，那么您的问题出在 Windows shell 中，您可以尝试 cygwin`bash`来重现测试并查看结果。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-25T19:12:32.913

你是不是对原帖理解有误？我认为那个人是说他停止使用命令提示符并切换到 cygwin。

您也可以在 Windows 命令提示符下进行自动完成工作。只需运行`cmd /f`而不是`cmd`. 另一篇文章有​​关于如何永久启用自动完成的说明。

如果您想使用 cygwin，请专注于尝试让自动完成功能在 cygwin 中工作。我使用 cygwin 已经有好几年了，但我认为它是默认启用的。也许您需要关闭区分大小写？[如何在cygwin文件夹自动完成中停用大写检查？](https://stackoverflow.com/questions/10201900/how-to-deactivate-uppercase-check-in-cygwin-folder-autocompletion)

无论您使用哪种外壳，它只会自动完成文件夹和文件名。

# java - 带注释的收藏袋

> ID：14527450
> 
> 赞同：4
> 
> 时间：2013-01-25T17:47:17.077
> 
> 标签：java, hibernate

我正在观看**Burt Beckwith制作的精彩视频**

[http://www.infoq.com/presentations/GORM-Performance](http://www.infoq.com/presentations/GORM-Performance)

他说：

> “在传统的 Hibernate 中，您可以将集合映射为 Bag，
> 
> 这只是一个没有排序或唯一性保证的常规集合”

如何在没有排序或唯一性的情况下使用注释映射此集合？谢谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-25T17:55:48.457

如果您使用 a`List`作为引用类型但未指定索引号列，您将拥有一个无唯一性要求的无序集合。是的，该列表是 Java 级别的有序集合，但不能保证实体的副本之间具有相同的顺序。

```
@OneToMany
private List<OtherEntity> otherEntities; 
```

就这样！

# asp.net - 在 iis8 上错误地删除了默认网站

> ID：14527455
> 
> 赞同：1
> 
> 时间：2013-01-25T17:47:30.627
> 
> 标签：asp.net, iis-8

我不小心删除了 iis 8 上的默认网站目录。

然后我想添加一个新网站。但是确定按钮被禁用弹出窗口。并且缺少 iis 绑定。![在此处输入图像描述](../Images/61c8e8d40abbc4aa5816ce7cd1d9ebee.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-16T01:20:24.007

我自己刚刚解决了这个问题，这是一个非常随机的解决方案，但它确实有效......

**

*   打开开始菜单。
*   键入并运行打开或关闭 Windows 功能。
*   找到 Internet Internet Information Services，然后取消选中它。
*   重启你的电脑。
*   重复步骤 1 和 2。
*   重新检查 Internet 信息服务。

**

基本上是内置的重新配置。之后应该工作。

# c# - 正则表达式实例即使存在也找不到多个匹配项

> ID：14527460
> 
> 赞同：2
> 
> 时间：2013-01-25T17:48:10.463
> 
> 标签：c#, regex

我正在使用正则表达式，我写了这个：

```
 static void Main(string[] args)
    {
        string test = "this a string meant to test long space recognition      n       a";
        Regex regex = new Regex(@"[a-z][\s]{4,}[a-z]$");
        MatchCollection matches = regex.Matches(test);
        if (matches.Count > 1)
            Console.WriteLine("yes");
        else
        {
            Console.WriteLine("no");
            Console.WriteLine("the number of matches is "+matches.Count);
        }
    } 
```

在我看来，Matches 方法应该同时找到“n n”和“n a”。尽管如此，它只能找到“n n”，我只是不明白为什么会这样..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T17:57:17.363

正`$`则表达式中的 表示模式必须出现在行尾。如果你想找到所有的长空格，这个简单的表达式就足够了：

```
\s{4,} 
```

如果你真的需要知道空格是否被az包围，你可以这样搜索

```
(?<=[a-z])\s{4,}(?=[a-z]) 
```

这使用模式...

```
(?<=prefix)find(?=suffix) 
```

...并查找包含在前缀和后缀之间的位置。前缀和后缀不是匹配的一部分，即`match.Value`只包含连续的空格。因此，您不会得到Jon Skeet 提到的*“n”消耗问题。*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-25T17:52:38.010

你有两个问题：

1）您将匹配锚定到字符串的末尾。所以实际上，匹配的值是“n...a”，而不是“n...n”

2）中间的“n”被第一场比赛消耗掉，所以不能成为第二场比赛的一部分。如果您将“n”更改为“nx”（并删除 $），您将看到“n...n”和“x...a”

简短但完整的示例：

```
using System;
using System.Text.RegularExpressions;

public class Test
{
    static void Main(string[] args)
    {
        string text = "ignored a      bc       d";
        Regex regex = new Regex(@"[a-z][\s]{4,}[a-z]");
        foreach (Match match in regex.Matches(text))
        {
            Console.WriteLine(match);
        }
    }
} 
```

结果：

```
a      b
c       d 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-25T17:59:11.643

`I just do not understand why is that..`

我认为第一场比赛消耗它的“为什么”是为了防止正则表达式`"\\w+s"`，旨在让每个以“s”结尾的单词在与“cats”匹配时返回“ts”、“ats”和“cats” .

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2013-01-25T17:50:49.743

Regex 机器会进行*一次*匹配，如果您想要更多，则必须在第一次匹配后自己重新启动它。

# django - 在 Heroku 中使用美味派管理 X-HTTP-Method-Override？

> ID：14527462
> 
> 赞同：0
> 
> 时间：2013-01-25T17:48:12.423
> 
> 标签：django, heroku, http-headers, tastypie, x-http-method-override

我正在尝试使用标题：（`X-HTTP-Method-Override: PATCH`如[Tastypie Docs](http://django-tastypie.readthedocs.org/en/latest/resources.html)中所述，只需在此处搜索`X-HTTP-Method-Override`）以便`PATCH`在 heroku 中使用tastypie 时可以模拟（heroku 中不支持）。

我正在尝试这个 curl 请求

`curl --dump-header - -H "Content-Type: application/json" -H "X-HTTP-Method-Override: PATCH" -H "Authorization: ApiKey admin:TheApiKey" -X POST --data '{"token": "test1234"}' http://staging.myserver.com/api/v1/devices/449/`

在本地它运行得很好，但是当我在我的 heroku 托管应用程序上尝试它时，我得到：

```
HTTP/1.1 501 NOT IMPLEMENTED
Content-Type: text/html; charset=utf-8
Date: Fri, 25 Jan 2013 17:45:11 GMT
Server: gunicorn/0.15.0
Content-Length: 0
Connection: keep-alive 
```

这里可能是什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T22:40:25.150

501 错误与 Heroku 无关。

我相信这是您的资源的设置。

TastyPie 有一点问题，我会参考文档中的以下行：

“要使 PATCH 起作用，您必须输入您的 detail_allowed_methods 设置。”

IE

> detail_allowed_methods = ['get', 'post', 'put', 'delete', 'patch']

# python - Python - 将 JSON 键/值转换为键/值，其中值是一个数组

> ID：14527465
> 
> 赞同：3
> 
> 时间：2013-01-25T17:48:31.723
> 
> 标签：python, json

我有一个 JSON 文件，其中包含许多这样的条目：

```
 {
    "area1": "California",
    "area2": "Sierra Eastside",
    "area3": "Bishop Area",
    "area4": "Volcanic Tablelands (Happy/Sad Boulders)",
    "area5": "Fish Slough Boulders",
    "grade": "V6 ",        
    "route": "The Orgasm",
    "type1": "Boulder",
    "type2": "NONE",
    "type3": "NONE",
    "type4": "NONE",
}, 
```

我想获取`area`and`type`条目并将它们转换为数组：

```
 {
    "area": ["California","Sierra Eastside","Bishop Area","Volcanic Tablelands (Happy/Sad Boulders)","Fish Slough Boulders"]
    "grade": "V6 ",        
    "route": "The Orgasm",
    "type": ["Boulder","NONE","NONE","NONE"]
}, 
```

我有这个几乎可以工作的代码：

```
json_data=open('../json/routes_test.json')
datas = json.load(json_data)
datas_arrays = []
area_keys = ['area1','area2','area3','area4','area5']
type_keys = ['type1','type2','type3','type4']

for data in datas:
    areaArray = []
    typeArray = []
    deleteArray = []
    for k, v in data.iteritems():
        for area_key in area_keys:
            if (k == area_key):
                areaArray.append(v)
                deleteArray.append(k)
        for type_key in type_keys:
            if (k == type_key):
                typeArray.append(v)
                deleteArray.append(k)
    for k in deleteArray:
        del data[k]
    data['area'] = areaArray
    data['type'] = typeArray
    datas_arrays.append(data)
    print datas_arrays
    print "********"

out = json.dumps(datas_arrays, sort_keys=True,indent=4, separators=(',', ': '))
print out
f_out= open('../json/toues_test_intoarrays.json', 'w')    
f_out.write(out)
f_out.close() 
```

问题是`area`数组完全乱序，`type`数组是向后的，这是我做不到的。我觉得奇怪的是，一个是无序的，一个是有序的，但是是倒序的。对我来说，迭代似乎应该确保它们按顺序排列。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-25T17:53:14.213

Python 字典有任意顺序，它们没有排序。您想改用预先构建的键列表：

```
with open('../json/routes_test.json') as json_data:
    datas = json.load(json_data)
    area_keys = ['area1','area2','area3','area4','area5']
    type_keys = ['type1','type2','type3','type4']

    for data in datas:
        data['area'] = [data[k] for k in area_keys]
        data['type'] = [data[k] for k in type_keys]
        for k in area_keys + type_keys:
            del data[k]

out = json.dumps(datas, sort_keys=True, indent=4, separators=(',', ': '))
print out
with open('../json/toues_test_intoarrays.json', 'w') as f_out:
    f_out.write(out) 
```

这会就地更改字典。

您甚至可以从每个条目中确定`area`和键：`type`

```
 for data in datas:
        keys = sorted(data.keys())

        area_keys = [k for k in keys if k.startswith('area')]
        data['area'] = [data[k] for k in area_keys]

        type_keys = [k for k in keys if k.startswith('type')]
        data['type'] = [data[k] for k in type_keys]

        for k in area_keys + type_keys:
            del data[k] 
```

并完全省略带有`'area1', 'area2'`等硬编码列表的列表文字。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-25T17:54:23.887

按顺序迭代键。

```
for k, v in sorted(data.iteritems()): 
```

一旦超过 9，这将失败，但现在可以。

# r - 读取csv时有没有办法省略第一列

> ID：14527466
> 
> 赞同：-1
> 
> 时间：2013-01-25T17:48:31.860
> 
> 标签：r

> **可能重复：**
> [仅读取 R 中有限数量的列](https://stackoverflow.com/questions/5788117/only-read-limited-number-of-columns-in-r)

我有一个非常大的 csv 文件，所以我只想读取 R 中相关的数据。csv 文件有 4 列宽，向下有几百万行。但是第一列是不必要的，（因为它是每一行的重复字符串）。

有没有办法在读取 csv 文件时只获取第 2 到第 4 列...（它很容易删除原始的第一列帖子读取它...但想知道是否有更有效的方法这个）。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-25T17:56:53.700

扩展约书亚的评论：

```
data <- read.csv("data.csv",colClasses=c("NULL",NA,NA,NA)) 
```

`"NULL"`（注意引号！）表示跳过列，`NA`表示 R 为该列选择适当的数据类型。

# c++ - 与多态一起使用的数组的奇怪输出

> ID：14527467
> 
> 赞同：1
> 
> 时间：2013-01-25T17:48:33.200
> 
> 标签：c++, arrays

> **可能重复：**
> [指向基点的指针可以指向派生对象数组吗？](https://stackoverflow.com/questions/7196172/can-a-pointer-to-base-point-to-an-array-of-derived-objects)

我正在练习学到的东西，我尝试了以下方法：

```
#include <iostream>

struct S {
    S() : val(0) {}

    int val;
};

struct D : S {
    D() : val(1) {}

    int val;
};

void f(S *s) {
    for (int i = 0; i < 5; i++, s++)
        std::cout << s->val;
}

int main() {
    D d[5];
    f(d);
} 
```

我觉得奇怪的是输出`01010`不是`11111`我预期的那样。所以它似乎是从类中获取`val`成员，而不是在每个其他循环中获取类。但为什么？`S``D`

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-25T18:03:23.403

因为`s++`将指针增加`sizeof(S)`, not `sizeof(D)`，但实际上在运行时`s`指向数组。`D`

*   第一次迭代恰好与`S::val`第一个数组元素（即 0）对齐，
*   `D::val`第**一个**元素的第二个（即 1），
*   第三个与`S::val`第二个元素（即 0）
*   等等...

这本质上是一种未定义的行为。如果您的课程看起来不同（或使用了具有不同对齐方式的平台），您将收到不同甚至更令人困惑的结果。

如果您不需要多态性，只需声明函数以接收`D`(not `S`) 的数组。如果确实需要多态性，则应考虑使用（智能）指针数组，而不是具体元素数组（并通过虚拟函数访问数据，而不是直接访问字段）。

# mysql - mySQL "select" 通过 JDBC 区分大小写，但通过命令行不区分大小写

> ID：14527470
> 
> 赞同：1
> 
> 时间：2013-01-25T17:49:04.047
> 
> 标签：mysql, jdbc, applet, case-sensitive, case-insensitive

我正在尝试通过 JDBC 使用 mySQL 搜索我的数据库。当我使用这个语句时：

```
SELECT * FROM tablename WHERE name='joe'; 
```

它进行不区分大小写的搜索并返回任何包含“Joe”或“joe”的行，这正是我想要的。我跑了`select collation(version())`，这返回了“utf8_general_ci”，这显然应该是不区分大小写的。但是，当我在 Java 小程序中使用 JDBC 运行相同的查询时，它会进行区分大小写的搜索。这是我的`query2`功能：

```
try {
        Vector<Vector<String>> out = new Vector<Vector<String>>() ;
        Connection con = connect() ;
        Statement statement = con.createStatement() ;
        System.out.println( "SQL: " + s ) ;
        ResultSet rs = statement.executeQuery(s) ;
        while( rs.next() )
        {
            String r = rs.getString(1) ; // RS is indexed from 1
            Vector<String> q = new Vector<String>() ;
            for( int i = 2 ; i <= tableSize ; i ++ )
            {
                q.add(r) ;
                r = rs.getString(i) ;
            }
            q.add(r) ;
            out.add(q) ;
        }
        con.close() ;
        return( out ) ;
    } catch (SQLException e) {
        System.err.println( "SQL EXCEPTION" ) ;
        System.err.println( s ) ;
        e.printStackTrace();
    } 
```

这是我`select`调用的函数`query2`：

```
public static Vector<Vector<String>> select( String table , List<String> columns , List<String> values )
{
    String statement = "SELECT * from `" + table + "` WHERE " ;
    for( int i = 0 ; i < columns.size(); i ++ )
    {
        statement += columns.get(i) + "='" + values.get(i) + "'" ;
        if( i + 1 < columns.size() )
            statement += " AND " ;
    }
    statement += " ;" ;
    return query2 ( statement , tableSize(table) ) ;
} 
```

知道如何使此查询不区分大小写吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T18:45:21.330

事实证明，我认为使用该`select`功能的搜索实际上使用了不同的功能。该功能从数据库中选择所有内容并在客户端对其进行排序。我测试了该`select`功能，它实际上不区分大小写，无需使用任何给出的提示（但感谢您的建议！）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T18:04:41.373

这条线不需要阅读吗

```
statement += "UPPER("+columns.get(i) + ")='UPPER(" + values.get(i) + ")'" 
```

垮台......不能使用索引，因为它会影响一切。

# jquery - 我可以在对我所做的 jQuery 函数的调用中指定方法和参数吗？

> ID：14527472
> 
> 赞同：0
> 
> 时间：2013-01-25T17:49:05.877
> 
> 标签：jquery, function, closures

这是一个例子。这是根据此处的文档创建的简单函数：http: [//docs.jquery.com/Plugins/Authoring](http://docs.jquery.com/Plugins/Authoring)。

```
(function ($) {
    var methods = {
        init: function (options) {
            // Gets called when no arg provided to myFunction()
        },
        doTask1: function () {
            // Do task #1
        },
        doTask2: function () {
            // Do task #2
        }
    };

    function HelperMethod(item) {
        // some handy things that may be used by one or more of the above functions
    }

    // This bit comes straight from the docs at http://docs.jquery.com/Plugins/Authoring
    $.fn.myFunction = function (method) {
        if (methods[method]) {
            return methods[method].apply(this, Array.prototype.slice.call(arguments, 1));
        } else if (typeof method == "object" || !method) {
            return methods.init.apply(this, arguments);
        } else {
            $.error("Method " + method + " does not exist on jQuery.dcms");
            return null;
        }
    };
})(jQuery); 
```

我可以像这样调用函数：`$('body').myFunction();`，或`$('body').myFunction("doTask1");`

是否有一种惯用的和/或方便的方式来改变用户的偏好，通过调用类似的方法`$('body').myFunction("changePref", "myPrefs");`，或者可能`$('body').myFunction("{changePref: myPrefs}");`？

或者我最好只为用户偏好创建一个单独的函数，只将首选项作为参数？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T17:59:19.927

事实证明，我`init`可以处理任意数量的选项。此外，制作单独的函数被认为是不好的做法，因为这会导致命名空间混乱。请参阅 [http://docs.jquery.com/Plugins/Authoring。](http://docs.jquery.com/Plugins/Authoring.)在标题命名空间下获得一些好的文档。

所以这是一个片段，带有一点评论：

```
(function ($) {
    var methods = {
        init: function (options) {
            // Gets called when no arg provided to myFunction()
            // Also attempts to make use of whatever options provided if they
            // don't match the options below.
        },
        doTask1: function () {
            // Do task #1
        },
        doTask2: function () {
            // Do task #2
        }
    };
//... 
```

`myFunction()`只要我在函数中处理它们，我应该能够传递我想要的任何参数。

# .net - DataGridView - 通过控制触发器对绑定源中的列重新排序来重新排序列

> ID：14527476
> 
> 赞同：0
> 
> 时间：2013-01-25T17:49:13.160
> 
> 标签：.net, vb.net, datagridview

我在 VS 2012 中使用 VB.Net。我有一个绑定到数据集中的数据表的 DGV。DGV 可由用户更新，从而更新绑定到 DGV 的数据表。这一切都很好，我的问题可以在下面的用户流程中描述：

1.  用户打开 DGV
2.  用户通过单击 DGV A 中的标题列重新排序行。列排列和显示适当
3.  用户更新 DGV 行索引 0 处 ID 为 3 的项，但是这个的ID不再匹配DGV上的行索引0的ID，因为用户更新了数据表中的一行，根据新排序的datagridviews行索引。由于 DGV 的行排序并没有对绑定的数据表进行排序，所以更新的项目是错误的。

有没有一种简单的方法告诉 DGV 也根据在 DGV 中单击的标题列对绑定数据表的行进行排序？有什么财产之类的吗？处理这个问题的最佳方法是什么？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T00:05:23.263

如果这是答案

[搜索数据表](http://msdn.microsoft.com/en-us/library/y06xa2h1%28VS.80%29.aspx)

# algorithm - 查找给定纬度和经度坐标的州

> ID：14527485
> 
> 赞同：5
> 
> 时间：2013-01-25T17:49:42.623
> 
> 标签：algorithm, geolocation

我有一组 900 个纬度和经度坐标——我需要一种相对简单的方法来查找这些坐标所指的“状态”。如果有帮助，数据在 excel 中。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-30T20:35:25.430

Google 提供[地理编码](https://developers.google.com/maps/documentation/geocoding/)服务。其中一部分是反向地理编码，它将地理坐标转换为人类可读的地址，包括国家。这个[Demo](https://google-developers.appspot.com/maps/documentation/javascript/examples/geocoding-reverse)说明了可以做什么。您可以使用此服务执行的操作是有限度的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-30T22:21:02.677

[尝试使用此处](http://dev.maxmind.com/geoip/codes/state_latlon)提供的平均值。运气好的话，您的 900 个坐标对中的大多数都属于中心最近的州。[此处](https://stackoverflow.com/questions/6366408/calculating-distance-between-two-latitude-and-longitude-geocoordinates)解释了经度/纬度位置之间距离的计算。

[另一种方法是使用此处](http://www.boutell.com/zipcodes/)提供的带有美国邮政编码的 ZIP 表。一旦您知道邮政编码，您就知道该州，不是吗？我不确定，但每个州都有一个邮政编码区间。一旦你知道一个位置的邮政编码，你就可以找到它所属的区间和状态。

美国位置的坐标列表可以帮助获得更准确的分配：[http](http://www.bcca.org/bahaivision/fast/latlong_us.html) : //www.bcca.org/bahaivision/fast/latlong_us.html 在列表中找到最近的位置并将其状态作为结果。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-02T23:05:31.133

谷歌要求地理编码/反向地理编码与用户可以看到的地图一起使用，所以如果这不是你的选择，我认为最好的方法是使用具有空间功能的数据库。首先，您需要在 NationalAtlas.gov 上免费找到州界。我使用 SQL Server（需要 2008 或 2012 版本），您可以使用 STContains() 方法查找它所属的状态。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-11T21:57:08.660

一个更简单的解决方案是只使用 ezcmd.com 的 rest API 服务。它们提供了两个 API：

[http://ezcmd.com/apps/app_geo_postal_codes#geo_postal_codes_api](http://ezcmd.com/apps/app_geo_postal_codes#geo_postal_codes_api)

1）您所要做的就是给它一个邮政编码和一个国家代码（对于美国，您可以使用美国或美国），并且您可以选择传递距离半径和单位（英里或公里），它会返回给定距离内的所有其他州和省的邮政编码

2）免费搜索，您可以在其中给它任何模糊搜索短语，包括 zip / 城市 / 州 / 省和国家之一，它会返回该搜索短语的最佳匹配。

提示：您可以使用 #2 查找模糊（人类可读）地址的邮政编码，并将该邮政编码传递给 #1 以查找离该邮政编码最近的地方。

他们还有另一个 API 可以返回邮政编码以及给定 IP 地址的完整地理位置信息：

[http://ezcmd.com/apps/app_ezip_locator#ezip_locator_api](http://ezcmd.com/apps/app_ezip_locator#ezip_locator_api)

享受 ！我希望这有帮助。

# c# - .NET 框架库中的 ref 关键字示例

> ID：14527488
> 
> 赞同：3
> 
> 时间：2013-01-25T17:49:46.343
> 
> 标签：c#, .net

`DateTime.TryParse`方法有一个`DateTime` `out`参数。

```
public static bool TryParse(string s, out DateTime result) 
```

`ref`.NET 框架中是否有这样的关键字用法？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-25T17:51:37.340

是的，例如各种重载[`Interlocked.Exchange`](http://msdn.microsoft.com/en-us/library/d3fxt78a.aspx)：

```
public static double Exchange(
ref double location1,
double value
) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-25T17:52:42.563

这用于不同的位置。例如，出于性能原因，XNA`ref`在诸如[Matrix.Add 之类的方法中大量使用。](http://msdn.microsoft.com/en-us/library/bb194950%28v=xnagamestudio.35%29.aspx)许多[互锁方法](http://msdn.microsoft.com/en-us/library/bb297966.aspx)依赖于`ref` 正确操作。

话虽`ref`如此，根据类库的设计指南，应该谨慎使用，这也是它不是很常见的部分原因。甚至还有一个[代码分析警告 (CA1045)](http://msdn.microsoft.com/en-us/library/ms182146.aspx)建议不要使用`ref`，尽管有时有理由不使用它。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-01-25T18:03:51.747

您可以`ref`使用反射（和 LINQ）获取 mscorlib 中所有方法的列表：

```
from type in typeof(object).Assembly.GetExportedTypes()
where !type.IsInterface
from method in type.GetMethods()
where method.GetParameters().Any(
    p => p.ParameterType.IsByRef &&
        !p.GetCustomAttributes(typeof(OutAttribute), false).Any())
select method 
```

过滤掉带有`ref`参数的方法[`OutAttribute`](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.outattribute.aspx)是必要的，因为这就是`out`参数的实际表示方式。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-28T08:57:29.257

实际上，我自己也很好奇，所以我编写了一个小程序来扫描 .NET Framework 程序集并转储出至少具有一个 ref 参数的公共方法。它使用[单 cecil](http://www.mono-project.com/Cecil)静态反射功能。

它丢弃`Obsolete`和`COM`相关的方法（由于它们的性质而具有很多 ref 参数）。

下面是 mscorlib、system 和 system.core 的结果：

```
Assembly mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089
 Type SafeHandle
  Method System.Void DangerousAddRef(System.Boolean& success)
 Type Interlocked
  Method System.Int32 Increment(System.Int32& location)
  Method System.Int64 Increment(System.Int64& location)
  Method System.Int32 Decrement(System.Int32& location)
  Method System.Int64 Decrement(System.Int64& location)
  Method System.Int32 Exchange(System.Int32& location1, System.Int32 value)
  Method System.Int64 Exchange(System.Int64& location1, System.Int64 value)
  Method System.Single Exchange(System.Single& location1, System.Single value)
  Method System.Double Exchange(System.Double& location1, System.Double value)
  Method System.Object Exchange(System.Object& location1, System.Object value)
  Method System.IntPtr Exchange(System.IntPtr& location1, System.IntPtr value)
  Method T Exchange(T& location1, T value)
  Method System.Int32 CompareExchange(System.Int32& location1, System.Int32 value, System.Int32 comparand)
  Method System.Int64 CompareExchange(System.Int64& location1, System.Int64 value, System.Int64 comparand)
  Method System.Single CompareExchange(System.Single& location1, System.Single value, System.Single comparand)
  Method System.Double CompareExchange(System.Double& location1, System.Double value, System.Double comparand)
  Method System.Object CompareExchange(System.Object& location1, System.Object value, System.Object comparand)
  Method System.IntPtr CompareExchange(System.IntPtr& location1, System.IntPtr value, System.IntPtr comparand)
  Method T CompareExchange(T& location1, T value, T comparand)
  Method System.Int32 Add(System.Int32& location1, System.Int32 value)
  Method System.Int64 Add(System.Int64& location1, System.Int64 value)
  Method System.Int64 Read(System.Int64& location)
 Type Volatile
  Method System.Boolean Read(System.Boolean& location)
  Method System.SByte Read(System.SByte& location)
  Method System.Byte Read(System.Byte& location)
  Method System.Int16 Read(System.Int16& location)
  Method System.UInt16 Read(System.UInt16& location)
  Method System.Int32 Read(System.Int32& location)
  Method System.UInt32 Read(System.UInt32& location)
  Method System.Int64 Read(System.Int64& location)
  Method System.UInt64 Read(System.UInt64& location)
  Method System.IntPtr Read(System.IntPtr& location)
  Method System.UIntPtr Read(System.UIntPtr& location)
  Method System.Single Read(System.Single& location)
  Method System.Double Read(System.Double& location)
  Method T Read(T& location)
  Method System.Void Write(System.Boolean& location, System.Boolean value)
  Method System.Void Write(System.SByte& location, System.SByte value)
  Method System.Void Write(System.Byte& location, System.Byte value)
  Method System.Void Write(System.Int16& location, System.Int16 value)
  Method System.Void Write(System.UInt16& location, System.UInt16 value)
  Method System.Void Write(System.Int32& location, System.Int32 value)
  Method System.Void Write(System.UInt32& location, System.UInt32 value)
  Method System.Void Write(System.Int64& location, System.Int64 value)
  Method System.Void Write(System.UInt64& location, System.UInt64 value)
  Method System.Void Write(System.IntPtr& location, System.IntPtr value)
  Method System.Void Write(System.UIntPtr& location, System.UIntPtr value)
  Method System.Void Write(System.Single& location, System.Single value)
  Method System.Void Write(System.Double& location, System.Double value)
  Method System.Void Write(T& location, T value)
 Type LazyInitializer
  Method T EnsureInitialized(T& target)
  Method T EnsureInitialized(T& target, System.Func`1<T> valueFactory)
  Method T EnsureInitialized(T& target, System.Boolean& initialized, System.Object& syncLock)
  Method T EnsureInitialized(T& target, System.Boolean& initialized, System.Object& syncLock, System.Func`1<T> valueFactory)
 Type SafeBuffer
  Method System.Void AcquirePointer(System.Byte*& pointer)
 Type Marshal
  Method System.Int32 QueryInterface(System.IntPtr pUnk, System.Guid& iid, System.IntPtr& ppv)
  Method System.Reflection.MemberInfo GetMethodInfoForComSlot(System.Type t, System.Int32 slot, System.Runtime.InteropServices.ComMemberType& memberType)
 Type EventRegistrationTokenTable`1
  Method System.Runtime.InteropServices.WindowsRuntime.EventRegistrationTokenTable`1<T> GetOrCreateEventRegistrationTokenTable(System.Runtime.InteropServices.WindowsRuntime.EventRegistrationTokenTable`1<T>& refEventTable)
 Type UnmanagedMemoryAccessor
  Method System.Void Write(System.Int64 position, T& structure)
 Type AsyncVoidMethodBuilder
  Method System.Void Start(TStateMachine& stateMachine)
  Method System.Void AwaitOnCompleted(TAwaiter& awaiter, TStateMachine& stateMachine)
  Method System.Void AwaitUnsafeOnCompleted(TAwaiter& awaiter, TStateMachine& stateMachine)
 Type AsyncTaskMethodBuilder
  Method System.Void Start(TStateMachine& stateMachine)
  Method System.Void AwaitOnCompleted(TAwaiter& awaiter, TStateMachine& stateMachine)
  Method System.Void AwaitUnsafeOnCompleted(TAwaiter& awaiter, TStateMachine& stateMachine)
 Type AsyncTaskMethodBuilder`1
  Method System.Void Start(TStateMachine& stateMachine)
  Method System.Void AwaitOnCompleted(TAwaiter& awaiter, TStateMachine& stateMachine)
  Method System.Void AwaitUnsafeOnCompleted(TAwaiter& awaiter, TStateMachine& stateMachine)

Assembly System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089
 Type EventProvider
  Method System.Boolean WriteEvent(System.Diagnostics.Eventing.EventDescriptor& eventDescriptor, System.Object[] eventPayload)
  Method System.Boolean WriteEvent(System.Diagnostics.Eventing.EventDescriptor& eventDescriptor, System.String data)
  Method System.Boolean WriteTransferEvent(System.Diagnostics.Eventing.EventDescriptor& eventDescriptor, System.Guid relatedActivityId, System.Object[] eventPayload)
  Method System.Void SetActivityId(System.Guid& id)

Assembly System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089
 Type IIntellisenseBuilder
  Method System.Boolean Show(System.String language, System.String value, System.String& newValue)
 Type Executor
  Method System.Int32 ExecWaitWithCapture(System.String cmd, System.CodeDom.Compiler.TempFileCollection tempFiles, System.String& outputName, System.String& errorName)
  Method System.Int32 ExecWaitWithCapture(System.String cmd, System.String currentDir, System.CodeDom.Compiler.TempFileCollection tempFiles, System.String& outputName, System.String& errorName)
  Method System.Int32 ExecWaitWithCapture(System.IntPtr userToken, System.String cmd, System.CodeDom.Compiler.TempFileCollection tempFiles, System.String& outputName, System.String& errorName)
  Method System.Int32 ExecWaitWithCapture(System.IntPtr userToken, System.String cmd, System.String currentDir, System.CodeDom.Compiler.TempFileCollection tempFiles, System.String& outputName, System.String& errorName)
 Type Uri
  Method System.Char HexUnescape(System.String pattern, System.Int32& index)
 Type Socket
  Method System.Int32 ReceiveMessageFrom(System.Byte[] buffer, System.Int32 offset, System.Int32 size, System.Net.Sockets.SocketFlags& socketFlags, System.Net.EndPoint& remoteEP, System.Net.Sockets.IPPacketInformation& ipPacketInformation)
  Method System.Int32 ReceiveFrom(System.Byte[] buffer, System.Int32 offset, System.Int32 size, System.Net.Sockets.SocketFlags socketFlags, System.Net.EndPoint& remoteEP)
  Method System.Int32 ReceiveFrom(System.Byte[] buffer, System.Int32 size, System.Net.Sockets.SocketFlags socketFlags, System.Net.EndPoint& remoteEP)
  Method System.Int32 ReceiveFrom(System.Byte[] buffer, System.Net.Sockets.SocketFlags socketFlags, System.Net.EndPoint& remoteEP)
  Method System.Int32 ReceiveFrom(System.Byte[] buffer, System.Net.EndPoint& remoteEP)
  Method System.IAsyncResult BeginReceiveMessageFrom(System.Byte[] buffer, System.Int32 offset, System.Int32 size, System.Net.Sockets.SocketFlags socketFlags, System.Net.EndPoint& remoteEP, System.AsyncCallback callback, System.Object state)
  Method System.Int32 EndReceiveMessageFrom(System.IAsyncResult asyncResult, System.Net.Sockets.SocketFlags& socketFlags, System.Net.EndPoint& endPoint, System.Net.Sockets.IPPacketInformation& ipPacketInformation)
  Method System.IAsyncResult BeginReceiveFrom(System.Byte[] buffer, System.Int32 offset, System.Int32 size, System.Net.Sockets.SocketFlags socketFlags, System.Net.EndPoint& remoteEP, System.AsyncCallback callback, System.Object state)
  Method System.Int32 EndReceiveFrom(System.IAsyncResult asyncResult, System.Net.EndPoint& endPoint)
 Type UdpClient
  Method System.Byte[] Receive(System.Net.IPEndPoint& remoteEP)
  Method System.Byte[] EndReceive(System.IAsyncResult asyncResult, System.Net.IPEndPoint& remoteEP) 
```

这是程序：

```
static void EnumerateMethodsWithRefParameters()
{
    foreach (FileInfo file in new DirectoryInfo(RuntimeEnvironment.GetRuntimeDirectory()).GetFiles("*.dll"))
    {
        AssemblyDefinition asm;
        try
        {
            asm = AssemblyFactory.GetAssembly(file.FullName);
        }
        catch (ImageFormatException)
        {
            continue;
        }

        bool assemblyWritten = false;
        foreach (ModuleDefinition module in asm.Modules)
        {
            foreach (TypeDefinition type in module.Types)
            {
                if (!ChooseType(type))
                    continue;

                bool typeWritten = false;
                foreach (MethodDefinition method in type.Methods)
                {
                    if (!ChooseMethod(method))
                        continue;

                    if (!assemblyWritten)
                    {
                        Console.WriteLine("Assembly " + asm.Name);
                        assemblyWritten = true;
                    }
                    if (!typeWritten)
                    {
                        Console.WriteLine(" Type " + type.Name);
                        typeWritten = true;
                    }
                    Console.WriteLine("  Method " + GetMethodSignature(method));
                }
            }
        }
    }
}

static bool ChooseType(TypeDefinition type)
{
    if (!type.IsPublic)
        return false;

    if (IsComRelatedOrObsolete(type))
        return false;

    return true;
}

static bool ChooseMethod(MethodDefinition method)
{
    if (!method.IsPublic)
        return false;

    foreach (ParameterDefinition parameter in method.Parameters)
    {
        if ((parameter.ParameterType is ReferenceType) && (!parameter.IsOut))
            return true;
    }
    return false;
}

static bool IsComRelatedOrObsolete(TypeDefinition type)
{
    foreach (CustomAttribute att in type.CustomAttributes)
    {
        if (att.Constructor.DeclaringType.FullName == typeof(ObsoleteAttribute).FullName)
            return true;

        if (att.Constructor.DeclaringType.FullName == typeof(InterfaceTypeAttribute).FullName)
        {
            if ((att.Constructor.Parameters.Count > 0) &&
                (att.Constructor.Parameters[0].ParameterType.FullName == typeof(ComInterfaceType).FullName))
                return true;
        }

        if (att.Constructor.DeclaringType.FullName == typeof(ComVisibleAttribute).FullName)
            return true;

        if (att.Constructor.DeclaringType.FullName == typeof(ComConversionLossAttribute).FullName)
            return true;

        if (att.Constructor.DeclaringType.FullName == typeof(ComImportAttribute).FullName)
            return true;
    }
    return false;
}

static string GetMethodSignature(MethodDefinition method)
{
    StringBuilder sb = new StringBuilder(method.ReturnType.ReturnType.FullName);
    sb.Append(' ');
    sb.Append(method.Name);
    sb.Append("(");
    for (int i = 0; i < method.Parameters.Count; i++)
    {
        ParameterDefinition p = method.Parameters[i];
        sb.Append(p.ParameterType.FullName);
        if (!string.IsNullOrEmpty(p.Name))
        {
            sb.Append(' ');
            sb.Append(p.Name);
        }

        if (i != (method.Parameters.Count - 1))
        {
            sb.Append(", ");
        }
    }
    sb.Append(")");
    return sb.ToString();
} 
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2013-01-25T17:52:28.260

```
DateTime dte;
if (DateTime.TryParse("date text", out dte))
{
    // Parse succeeded dte has the value
} 
```

# objective-c - 使用 @[array, of, items] 与 [NSArray arrayWithObjects:]

> ID：14527489
> 
> 赞同：12
> 
> 时间：2013-01-25T17:49:59.200
> 
> 标签：objective-c, nsarray, objective-c-literals

有没有区别

```
NSArray *myArray = @[objectOne, objectTwo, objectThree]; 
```

和

```
NSArray *myArray = [NSArray arrayWithObjects:objectOne, objectTwo, objectThree, nil]; 
```

一个比另一个更受欢迎吗？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2013-01-25T17:55:20.817

它们几乎相同，但不完全一样。[关于Objective-C Literals](http://clang.llvm.org/docs/ObjectiveCLiterals.html)的 Clang 文档指出：

> 数组文字表达式扩展为对 的调用 `+[NSArray arrayWithObjects:count:]`，它验证所有对象都是非零的。可变参数形式`+[NSArray arrayWithObjects:]`使用 nil 作为参数列表终止符，这可能导致数组对象格式错误。

所以

```
NSArray *myArray = @[objectOne, objectTwo, objectThree]; 
```

如果`objectTwo == nil`, 但是会抛出运行时异常

```
NSArray *myArray = [NSArray arrayWithObjects:objectOne, objectTwo, objectThree, nil]; 
```

在这种情况下，将创建一个包含一个元素的数组。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-01-25T17:51:39.927

不。在编译时，`@[...]`文字将更改为`arrayWithObjects:`

唯一的区别是`@[...]`仅在较新版本的 LLVM 编译器中受支持。

# c++ - Python 调用 DLL 调用 Python，“WindowsError：异常：访问冲突读取 0x00000004”

> ID：14527490
> 
> 赞同：3
> 
> 时间：2013-01-25T17:49:59.463
> 
> 标签：c++, python, ctypes, embedding, python-c-api

我有一个用 Python 编写的应用程序。

应用程序调用 dll 中的一些函数（使用 ctypes），这些函数从 python C API 调用一些函数来加载和运行（不同的）python 模块中的一些函数。这会导致`WindowsError: exception: access violation reading 0x00000004`一些 cout 调试告诉我访问冲突发生在对 Python C API 的调用上。

我知道 DLL 成功加载了 python 模块，当我将它作为独立的 .exe 测试时运行完成，但是当它从 python 应用程序运行时，它给出了这个访问冲突错误。

我首先认为也许我应该在 DLL 中使用 Py_NewInterpreter 为这些 python 模块函数创建一个新的独立空间来运行。这似乎很方便，因为不需要应用程序和由 DLL 运行的模块来共享任何数据。 [http://docs.python.org/2/c-api/init.html#Py_NewInterpreter](http://docs.python.org/2/c-api/init.html#Py_NewInterpreter)

然而，我对 Py_NewInterpreter 的初步测试证明是不成功的，只是进一步出错和崩溃。

所以我的问题是我应该如何实现这个/我需要做什么才能使 python 模块的 DLL 加载工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T19:36:35.523

这看起来像取消引用空指针，即指向结构/类的指针为空，并且您正在读取偏移量 4 处的子对象。在整个代码中撒上一些 assert() 以确保您不会错过任何空指针。另请注意，Python C API 会定期返回 null 以防出现异常。

也就是说，您有一个 Python 程序通过 ctypes 导入 DLL。这个 DLL 反过来通过 Python 的 C API 嵌入了一个 Python 解释器。正确的？如果我没记错的话，这实际上是在一个进程中为您提供了两个解释器实例。那里的问题是任何全局对象都在两者之间共享，并且这可能无法协调。

我会尝试编写一个适当的 Python（包装器）模块，而不是使用 ctypes 来导入 DLL。但是，我会同时做另一件事，那就是在 Python 用户邮件列表上询问此设置是否可以工作以及为什么。如果您愿意，还有一个新闻网关。

# wpf - 侦听 WPF TextBlock 控件的 Text 属性中的更改

> ID：14527494
> 
> 赞同：2
> 
> 时间：2013-01-25T17:50:19.213
> 
> 标签：wpf, event-handling, ellipsis

对于 WPF TextBlock，将 TextTrimming 设置为 TextTrimming.CharacterEllipsis 将导致它在文本溢出之前自动切断文本并在末尾添加一些省略号。[本文](http://tranxcoder.wordpress.com/2008/10/12/customizing-lookful-wpf-controls-take-2/)展示了如何检查文本是否被修剪并在修剪时自动在工具提示中显示全文。

它通过注册一个侦听 SizeChanged 事件的事件处理程序来执行此操作，而无需继承 TextBlock：

```
EventManager.RegisterClassHandler(
    typeof( TextBlock ),
    FrameworkElement.SizeChangedEvent,
    new SizeChangedEventHandler( OnTextBlockSizeChanged ),
    true ); 
```

问题是，这只会对大小更改的事件做出反应——如果文本溢出是因为你缩小了控件，它可以正常工作，但如果它因为你更改了文本而溢出，则不会。

不幸的是，虽然 TextBlock 确实有 SizeChangedEvent，但它没有 TextChangedEvent。我想到了听 TargetUpdated 事件：

```
EventManager.RegisterClassHandler(
    typeof(TextBlock),
    Binding.TargetUpdatedEvent,
    new EventHandler<DataTransferEventArgs>(OnTextBlockTextChanged),
    true); 
```

但这并没有任何明显的效果，即使 NotifyOnTargetUpdated 属性设置为 true。我还尝试覆盖 TextProperty 上的元数据，但似乎只能在其静态构造函数中完成 - 在本例中是 TextBlock 的静态构造函数。有没有办法在不继承 TextBlock 的情况下实现这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-25T18:17:09.183

您可以使用[`DependencyPropertyDescriptor`](http://msdn.microsoft.com/en-us/library/system.componentmodel.dependencypropertydescriptor.aspx)：

```
var descriptor = DependencyPropertyDescriptor.FromProperty(TextBlock.TextProperty, typeof(TextBlock));
descriptor.AddValueChanged(...); 
```

PS。为什么地球`TextBlock`上没有`IsTrimmed`财产是我无法理解的。

# c++ - 指向模板树节点的通用（非切片）指针？(C++)

> ID：14527496
> 
> 赞同：1
> 
> 时间：2013-01-25T17:50:30.710
> 
> 标签：c++, templates, octree

我正在研究一个八叉树实现，其中树节点使用它们的维度长度（作为 2 的幂）进行模板化：

```
template<long N>
struct node_t {
    enum { DIM = 1 << N };
    node_t<N+1> * parent;
    node_t<N-1> * children[8];
    long count;
} 
```

并专门用于 N = 0（叶子）指向数据。

```
struct node_t<0> {
    enum { DIM = 1 };
    node_t<1> * parent;
    data_t data;
    long count;
} 
```

（**除此之外：**我想我可能还需要一个不包括父指针的 N​​_MAX 特化，否则 C++ 会生成不断增加的 N 的类型？但这与我的问题并不真正相关。）

我想创建一个函数，它沿着我的八叉树占据的 3D 空间中的一条射线前进，所以表面上我可以只保留一个指向根节点（具有已知类型）的指针，并在每次从根节点遍历八叉树步。但是，我更喜欢“本地”选项，我可以在其中跟踪当前节点，以便尽可能从树的较低位置开始，从而避免不必要地遍历八叉树的上层节点。

但我不知道该类型指针可能是什么（或任何其他实现方式），因此我不会体验切片。

我不受模板的束缚，因为维度可以简单地实现为`long const`. 但是我不知道如何使叶子具有与 inode 不同的子类型。

谢谢你的帮助！

## 更新

我想这样做而不是类似的[原因](https://stackoverflow.com/questions/6281415/octree-raycasting-raytracing-best-ray-leaf-intersection-without-recursion?rq=1)是因为`count`每个节点中的变量：如果计数为 0，我想跳过整个立方体，而不是浪费时间通过叶子我知道是空的。（这是针对光线追踪体素引擎的。）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T22:52:38.520

尽管我很喜欢模板，但您的代码实际上可能更简单：

```
class node {
  node* parent; // NULL for root node
  long dim;
  long count;
  virtual rayTrace(Ray) = 0;
};
class leafNode : node {
  data_t data;
  virtual rayTrace(Ray);
};
class nonLeafNode : node {
  vector<node*> children;
  virtual rayTrace(Ray);
}; 
```

这样做的好处是树可以是你想要的任何深度，包括一些子树可以比其他的更深。它的缺点是必须在运行时计算 dim ，但即使这样也有一线希望，如果你的树变得非常大，你可以将其设为双倍。

# zend-framework - Zend framework 1.11 Gdata Spreadsheets insertRow 很慢

> ID：14527502
> 
> 赞同：0
> 
> 时间：2013-01-25T17:50:50.793
> 
> 标签：zend-framework, google-docs

我正在使用 insertRow 填充一个空的电子表格，它开始需要大约 1 秒来插入一行，然后在 150 行左右后减慢到大约 5 秒。

有没有人经历过这种行为？电子表格中的数据没有任何计算可能会随着更多数据而变得更长。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-10-08T19:05:30.963

我会尽量严格。

如果您查看“Zend_Gdata_Spreadsheets”类，您会发现方法 insertRow() 是以一种非常不理想的方式编写的。看：

```
public function insertRow($rowData, $key, $wkshtId = 'default')
{
    $newEntry = new Zend_Gdata_Spreadsheets_ListEntry();
    $newCustomArr = array();
    foreach ($rowData as $k => $v) {
        $newCustom = new Zend_Gdata_Spreadsheets_Extension_Custom();
        $newCustom->setText($v)->setColumnName($k);
        $newEntry->addCustom($newCustom);
    }

    $query = new Zend_Gdata_Spreadsheets_ListQuery();
    $query->setSpreadsheetKey($key);
    $query->setWorksheetId($wkshtId);

    $feed = $this->getListFeed($query);
    $editLink = $feed->getLink('http://schemas.google.com/g/2005#post');

    return $this->insertEntry($newEntry->saveXML(), $editLink->href, 'Zend_Gdata_Spreadsheets_ListEntry');
} 
```

简而言之，它加载您的整个电子表格只是为了了解此值 $editLink->href 以便将新行发布到您的电子表格中。

解决方法是避免使用这种方法 insertRow。相反，在您的代码中获取一次 $editLink->href ，然后每次通过重现此方法的其余行为来插入新行。即，在您的代码中而不是 $service->insertRow() 使用以下内容：

```
//get your $editLink once:
$query = new Zend_Gdata_Spreadsheets_ListQuery();
$query->setSpreadsheetKey($key);
$query->setWorksheetId($wkshtId);
$query->setMaxResults(1);

$feed = $service->getListFeed($query);
$editLink = $feed->getLink('http://schemas.google.com/g/2005#post');
....
//instead of $service->insertRow:
$newEntry = new Zend_Gdata_Spreadsheets_ListEntry();
$newCustomArr = array();
foreach ($rowData as $k => $v) {
    $newCustom = new Zend_Gdata_Spreadsheets_Extension_Custom();
    $newCustom->setText($v)->setColumnName($k);
    $newEntry->addCustom($newCustom);
}
$service->insertEntry($newEntry->saveXML(), $editLink->href, 'Zend_Gdata_Spreadsheets_ListEntry'); 
```

不要忘记鼓励这个很好的答案，我花了几天时间才弄清楚。我认为 ZF 很棒，但有时在资源优化方面你不想过多地依赖他们的代码。

# ios - 将关系过滤器添加到 NSPredicate

> ID：14527504
> 
> 赞同：1
> 
> 时间：2013-01-25T17:50:56.753
> 
> 标签：ios, core-data, nsfetchrequest

我正在使用最新的 SDK 和 Xcode 4.5.2 开发一个 iOS 应用程序。部署目标是 4.3。

我正在使用 Core Data 来访问这个实体：

![在此处输入图像描述](../Images/5f213d4ab3e25d2aecbbf67c382b8ec8.png)

我想过滤商店，但我不知道该怎么做（这是我的第一个核心数据项目）。

我知道我必须使用`NSFetchRequest`a`NSPredicate`或 a `NSExpression`。

我写这个 if 语句是为了向你展示我想要做什么：

```
if ((shop.acceptRate >= filterCriteria.acceptRate) &&
    (shop.categoryId == filterCriteria.shopCategoryId) &&
    ([shop.productsId indexOfObject:filterCriteria.productCategoryId] != NSNotFound) &&
    ([latestLocation distanceFromLocation:shop.shopLocation] <= (filterCriteria.distance * 1000)))
{
    [ ... ]
} 
```

**我如何使用`NSFetchRequest`a`NSPredicate`或 a来做到这一点`NSExpression`？**

我认为是这样的：

```
NSPredicate* predicate =
   [NSPredicate predicateWithFormat:@"acceptRate >= %@ AND categoryId = %@", filterCriteria.acceptRate, filterCriteria.shopCategoryId]; 
```

但我不知道如何在`NSPredicate`.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T18:34:15.770

根据您提供的信息，这样的事情应该有效：

```
NSPredicate* predicate = [NSPredicate predicateWithFormat:@"acceptRate >= %@ AND categoryId = %@ AND %@ IN products", filterCriteria.acceptRate, filterCriteria.shopCategoryId, filterCriteria.product]; 
```

`filterCriteria.product`类型的 NSManagedObject 实例在哪里`Product`

# macos - Applescript：创建文件夹/子文件夹并移动多个文件

> ID：14527505
> 
> 赞同：0
> 
> 时间：2013-01-25T17:50:55.973
> 
> 标签：macos, applescript, automator

我有一个 Applescript 问题，它比我能构建的要复杂得多。这几天我一直在寻找，我找不到任何这样的脚本，也找不到足够的信息来拼凑我有限的知识。

我有多个具有结构化名称的文件。每个文件具有以下名称结构：

> ttu_collectionname_000001.pdf
> ttu_collectionname_000002.mp3
> ttu_collectionname_000003.pdf ... 等等（每个文件都有不同的文件类型。）

还有一个与每个原始文件关联的 csv 元数据文件。

> ttu_collectionname_000001.csv
> ttu_collectionname_000002.csv
> ttu_collectionname_000003.csv ... 等等（这些文件都是 csv 文件。）

我需要根据带有子和子子文件夹的文件名创建一个文件夹。每个顶级文件夹名称在编号序列中都是唯一的。对于每个顶级文件夹，每个子文件夹和子文件夹的名称都相同。

文件夹结构应如下所示：

> *   ttu_collectionname_000001
>     
>     *   内容
>         
>         *   档案
>         *   展示
>     *   元数据
>         
>         *   档案
>         *   展示
> *   ttu_collectionname_000002
>     
>     *   内容
>         
>         *   档案
>         *   展示
>     *   元数据
>         
>         *   档案
>         *   展示

然后我需要将每个文件移动到特定的子文件夹。

文件**ttu_collectionname_000001.pdf**将被移动到**ttu_collectionname_000001/content/display**文件夹。

文件**ttu_collectionname_000001.csv**将移动到**ttu_collectionname_000001/metadata/display**文件夹。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T18:51:25.063

尝试：

```
set myFolder to "Mac OS X:Users:stark:Main Folder"
tell application "Finder" to set myFiles to folder myFolder's files as alias list
repeat with aFile in myFiles
    tell application "System Events" to set {fileName, fileExt} to {name, name extension} of aFile
    set baseName to text 1 thru ((get offset of "." & fileExt in fileName) - 1) of fileName
    do shell script "mkdir -p " & (quoted form of (POSIX path of myFolder)) & "/" & baseName & "/{\"content\",\"metadata\"}/{\"display\",\"archive\"}"
    tell application "System Events"
        if fileExt is "pdf" then move aFile to (myFolder & ":" & baseName & ":content:display" as text)
        if fileExt is "csv" then move aFile to (myFolder & ":" & baseName & ":metadata:display" as text)
    end tell
end repeat 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T18:47:13.023

假设您的文件在同一个文件夹中， ![前](../Images/d10ead19d7e25d4a216286045ac44fd9.png)

这个 AppleScript：

```
set pathToFolderOfTTUFiles to (path to the desktop as text) & "TTU:"
tell application "Finder"
    set theFiles to every item of folder pathToFolderOfTTUFiles whose name extension is not "csv" and kind is not "Folder"
    repeat with theFile in theFiles
        set lengthOfExtension to (length of (theFile's name extension as text)) + 1
        set fileNameWithoutExtension to text 1 through -(lengthOfExtension + 1) of (theFile's name as text)
        set theFolder to make new folder at folder pathToFolderOfTTUFiles with properties {name:fileNameWithoutExtension}

        set theContentFolder to make new folder at theFolder with properties {name:"content"}
        make new folder at theContentFolder with properties {name:"archive"}
        set theContentDisplayFolder to make new folder at theContentFolder with properties {name:"display"}
        set theMetadataFolder to make new folder at theFolder with properties {name:"metadata"}
        make new folder at theMetadataFolder with properties {name:"archive"}
        set theMetadataDisplayFolder to make new folder at theMetadataFolder with properties {name:"display"}

        move theFile to theContentDisplayFolder
        set pathToCSV to pathToFolderOfTTUFiles & fileNameWithoutExtension & ".csv"
        if exists pathToCSV then move pathToCSV to theMetadataDisplayFolder
    end repeat
end tell 
```

创建这个： ![后](../Images/64fca61068f9693720a5bb55777109fc.png)

# c - 小型便携式数字签名和验证库

> ID：14527506
> 
> 赞同：5
> 
> 时间：2013-01-25T17:51:00.403
> 
> 标签：c, public-key-encryption

我正在寻找一个允许我对发送到嵌入式模块的数据进行身份验证的库。由于硬件限制，它需要占用空间小（代码和内存方面），并且具有与 RSA-1024 相当的安全性。

要求如下

*   嵌入式模块验证（定制 CPU，只有 C89 编译器可用）
*   Windows 中的签名和验证（C/C++ 代码）
*   用 Java 登录（一些数据需要通过网页生成，所以 Java 将是一个很大的优势）

我非常希望不必自己实现类似 PKCS #1 v1.5/PSS 的系统，但我无法找到任何符合上述要求的好的库。开源会很好，但商业解决方案也同样重要。请注意，我需要访问 C 代码，因为必须为自定义 CPU 重新编译它。

[NaCl](http://nacl.cace-project.eu/)看起来很有希望，但它似乎仍在开发中。

我看过[OpenSSL](http://www.openssl.org/)，但它的功能远不止数字签名，而且仅去除签名验证码并非易事。

我看错了吗？我首先尝试实现 SHA+RSA，但我不确定填充步骤是否正确（这意味着它可能不安全），所以我决定在这里发帖寻求帮助。

编辑：澄清，只有验证部分有严格的限制。签名和密钥生成将在普通 PC 上运行。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-25T18:05:33.287

看看[mbed TLS](https://tls.mbed.org/)（以前称为 PolarSSL）：

> mbed TLS（以前称为 PolarSSL）使开发人员可以轻松地在其（嵌入式）产品中包含加密和 SSL/TLS 功能，从而以最小的编码占用空间促进此功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-25T18:03:39.310

如何实现这样的解决方案与我们现有的 CPU 和内存架构有关，因此必须告诉我更多关于您的系统的信息。第一种方法是在云上开发它。另一种选择是[SCL](http://sourceforge.net/projects/scl/)。[此外，您可以在Small RSA 或 DSA lib](https://stackoverflow.com/questions/1735374/small-rsa-or-dsa-lib-without-dependencies)上找到一些没有依赖关系的答案

# android - 如何从android的对话框中添加字符串？

> ID：14527510
> 
> 赞同：0
> 
> 时间：2013-01-25T17:51:28.180
> 
> 标签：android, spinner, android-spinner, android-alertdialog

我需要在运行时将字符串从警报对话框添加到微调器。现在我有一个带有编辑文本和按钮的警报框。请任何人帮我解决这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T18:10:25.267

因此，在 allertdialog 中按钮的 onClickListener 中，通过 finViewById 获取微调器元素并将文本添加到微调器的适配器，例如：

```
AlertDialog.Builder builder = new AlertDialog.Builder(this);
builder.setTitle("My Dialog");
builder.setPositiveButton("Ok", new DialogInterface.OnClickListener() {

        @Override
        public void onClick(DialogInterface dialog, int Id) {
            String value = input.getText().toString();
            Spinner mySpinner = (Spinner) findViewById(R.id.theSpinner);
            ArrayAdapter adapterForSpinner = new ArrayAdapter(this, android.R.layout.simple_spinner_item);
            mySpinner.setAdapter(adapterForSpinner);
            adapterForSpinner.add(value);
            return;
        }
    }); 
```

希望我的回答能解决你的问题。

# c# - Facebook v3 sdk monodroid 绑定

> ID：14527512
> 
> 赞同：5
> 
> 时间：2013-01-25T17:51:34.047
> 
> 标签：c#, facebook, binding, xamarin.android, xamarin

有没有人尝试为 Facebook sdk 的第 3 版创建一个新的 monodroid 绑定？我一直在使用用[Monodroid Facebook Binding](https://github.com/xamarin/monodroid-samples/tree/master/Facebook)创建的旧版 Facebook sdk 。但是新的 Facebook sdk 几乎所有这些方法都已弃用。

我在设置新绑定时遇到了麻烦，基本上`com.facebook.android.Facebook`该类现在已弃用，并且`Facebook.Authorize`替换为`Session`. 我能够创建新的 facebook sdk 的 jar 文件，但是`Session`在查看 .dll 时，该类没有显示在 Visual Studio 的对象浏览器中。该类`Session`是公共的并且实现`java.io.Serializable`了参考中包含的`Mono.Android`。任何帮助或建议将不胜感激。

编辑：在搞砸了几天之后，我能够通过一个实际上并不能解决我的问题的解决方法来解决这个问题，删除`Metadata.xml`.

```
<remove-node path="/api/package[@name='com.facebook']/class[@name='Session.OpenRequest']/method[@name='setPermissions']"/> 
```

这带来了其他问题，可以通过添加更多`<attr>`标签来解决。

```
 <remove-node path="/api/package[@name='com.facebook.model']/class[@name='PropertyName']"/>
  <attr path="/api/package[@name='com.facebook.widget']/class[@name='GraphObjectAdapter']" name="visibility">public</attr>
  <attr path="/api/package[@name='com.facebook.widget']/class[@name='GraphObjectPagingLoader']" name="visibility">public</attr>
  <attr path="/api/package[@name='com.facebook.widget']/class[@name='FacebookFragment']" name="visibility">public</attr>
  <attr path="/api/package[@name='com.facebook.widget']/class[@name='SimpleGraphObjectCursor']" name="visibility">public</attr>
  <attr path="/api/package[@name='com.facebook.widget']/interface[@name='GraphObjectCursor']" name="visibility">public</attr> 
```

在建立了这个尝试之后，我在`GraphObject.SectionAndItem`课堂上遇到了多个错误。

```
Error   41  Argument 1: cannot convert from 'Com.Facebook.Widget.GraphObjectAdapter.SectionAndItem.Type' to 'System.IntPtr' E:\Android\FacebookBinding\FacebookBinding\FacebookBinding\obj\Debug\generated\src\Com.Facebook.Widget.GraphObjectAdapter.cs    345 64  FacebookBinding
Error   39  Operator '!=' cannot be applied to operands of type 'Com.Facebook.Widget.GraphObjectAdapter.SectionAndItem.Type' and 'System.Type'  E:\Android\FacebookBinding\FacebookBinding\FacebookBinding\obj\Debug\generated\src\Com.Facebook.Widget.GraphObjectAdapter.cs    344 9   FacebookBinding
Error   47  Operator '==' cannot be applied to operands of type 'Com.Facebook.Widget.GraphObjectAdapter.SectionAndItem.Type' and 'System.Type'  E:\Android\FacebookBinding\FacebookBinding\FacebookBinding\obj\Debug\generated\src\Com.Facebook.Widget.GraphObjectAdapter.cs    381 9   FacebookBinding
Error   40  The best overloaded method match for 'Android.Runtime.JNIEnv.CreateInstance(System.IntPtr, string, params Android.Runtime.JValue[])' has some invalid arguments E:\Android\FacebookBinding\FacebookBinding\FacebookBinding\obj\Debug\generated\src\Com.Facebook.Widget.GraphObjectAdapter.cs    345 17  FacebookBinding 
```

为了解决这些问题，我删除了与这些问题相关的节点。

```
 <remove-node path="/api/package[@name='com.facebook.widget']/class[@name='GraphObjectAdapter.SectionAndItem']"/>
  <remove-node path="/api/package[@name='com.facebook.widget']/class[@name='GraphObjectAdapter.SectionAndItem.Type']"/> 
```

现在绑定可以成功构建。您可能认为我现在可以构建和部署我的应用程序，但出现了另一个问题。将`.jar`文件和`.dll`文件添加到我的应用程序后，我在构建时遇到这些错误。

```
Error   62   package com.facebook.widget.GraphObjectAdapter does not exist
        com.facebook.widget.GraphObjectAdapter.DataNeededListener
    E:\Android\FacebookBinding\FacebookBinding\FacebookTest\obj\Debug\android\src\mono\com\facebook\widget\GraphObjectAdapter_DataNeededListenerImplementor.java    8   41  FacebookTest
Error   63   package com.facebook.widget.GraphObjectPagingLoader does not exist
        com.facebook.widget.GraphObjectPagingLoader.OnErrorListener
    E:\Android\FacebookBinding\FacebookBinding\FacebookTest\obj\Debug\android\src\mono\com\facebook\widget\GraphObjectPagingLoader_OnErrorListenerImplementor.java  8   46  FacebookTest 
```

我现在不知道如何在这里进行。对到达该地点的任何步骤有任何建议或意见吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T21:44:34.047

Xamarin 正在发布一个新版本的`Mono for Android`4.7.x，它应该会公开更多 Facebook 在其`.jar`文件中使用的 Java 库。我切换到 beta 通道并尝试再次编译它，我可以使用`GraphObject`. 我认为仍然需要对`Metadata.xml`文件进行一些按摩才能获得整个`.jar`绑定，但这是朝着正确方向迈出的一步。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-20T13:00:33.670

如果你使用 xamarin 作为 IDE，你可以直接从组件站点下载 facebook 的 dll，避免绑定 sdk 的问题

[http://components.xamarin.com/](http://components.xamarin.com/)

# excel - Excel 宏 - 从多个 Excel 文件中的 Sheet1 导入特定范围

> ID：14527519
> 
> 赞同：0
> 
> 时间：2013-01-25T17:51:50.650
> 
> 标签：excel, vba, import

我正在尝试从特定文件夹中的所有工作表中从 Sheet1 导入特定范围。我从这个[循环开始，遍历文件夹中所有 Excel 工作簿中的所有工作表，以更改所有单元格中文本的字体、字体大小和对齐方式，](https://stackoverflow.com/questions/9558767/)但是对于 VBA 的新手需要一些帮助来完成以下操作。

具体来说。

*   仅在目录中的每个文件中从 Sheet1 导入 Range("A3:J4")。但将其格式化为从 B 列开始以适应：

*   将 A 列设置为每个范围来自的文件名。

    Range(A3:J4) 将转到第一个文件的 range(B1:K2)，然后是 range(B3:K4) 等。第一个文件的文件名为 A1，然后是第二个文件 A3。然后列表将继续使用此模式为文件夹中的所有文件构建

    ```
    Sub FormatFiles()
    Const fPath As String = "D:\DataFolder\"
    Dim sh As Worksheet
    Dim sName As String

    With Application
        .Calculation = xlCalculationManual
        .EnableEvents = False
        .ScreenUpdating = False
    End With

    sName = Dir(fPath & "*.xls*")

    Do Until sName = ""
        With GetObject(fPath & sName)
            For Each sh In .Worksheets
                With sh
                    .Cells.HorizontalAlignment = xlLeft
                    .Cells.Font.Name = "Tahoma"
                    .Cells.Font.Size = 10
                End With
            Next sh
            .Close True
        End With
        sName = Dir
    Loop

    With Application
        .Calculation = xlAutomatic
        .EnableEvents = True
        .ScreenUpdating = True
    End With
    End Sub 
    ```

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T23:24:22.520

你想要这样的东西吗？

```
Const fPath As String = "z:\docs\xlfiles\"
Dim sName As String
Dim intRow As Integer
Dim strCopyAddress As String
Dim wb As Workbook

strCopyAddress = "A3:J4"

Application.ScreenUpdating = False

sName = Dir(fPath & "*.xls*")
intRow = 1

Do Until sName = ""
    Set wb = Workbooks.Open(fPath & sName)
    ThisWorkbook.Sheets("Sheet1").Cells(intRow, 1) = sName
    wb.Sheets("Sheet1").Range(strCopyAddress).Copy _
       ThisWorkbook.Sheets("Sheet1").Cells(intRow, 2)
    wb.Close False

    intRow = intRow + 2
    sName = Dir
Loop

Application.ScreenUpdating = True 
```

# macos - Brew 医生说：“警告：/usr/local/include 不可写。”

> ID：14527521
> 
> 赞同：394
> 
> 时间：2013-01-25T17:51:53.313
> 
> 标签：macos, homebrew

酿酒医生说：

> 警告：/usr/local/include 不可写。如果您“sudo make install”不是由 Homebrew 管理的软件，就会发生这种情况。
> 
> 如果 brew 尝试将头文件写入此目录，则安装将在链接步骤期间失败。
> 
> 您可能应该`chown`/usr/local/include

我尝试了不同的命令来解决这个问题，但我仍然被困在这里。

我在 10.8.2 上运行自制软件

* * *

## 回答 #1

> 赞同：769
> 
> 时间：2013-01-26T17:26:49.877

拥有它和其中的一切。

Mac OS High Sierra 或更新版本：（在下面的评论中对 Kirk 表示感谢）

```
$ sudo chown -R $(whoami) $(brew --prefix)/* 
```

以前版本的macos：

```
$ sudo chown -R $USER:admin /usr/local/include 
```

然后再做一个

```
$ brew doctor 
```

* * *

## 回答 #2

> 赞同：120
> 
> 时间：2015-11-12T00:32:46.443

对我有用的也是

```
sudo chmod g+w /usr/local
sudo chgrp staff /usr/local 
```

* * *

## 回答 #3

> 赞同：40
> 
> 时间：2014-09-29T22:33:29.253

对我有用的是

```
$ sudo chown -R yourname:admin /usr/local/bin 
```

* * *

## 回答 #4

> 赞同：39
> 
> 时间：2016-06-13T13:03:07.053

在 El Capitan 上唯一对我有用的是：

```
sudo chown -R $(whoami) /usr/local 
```

* * *

## 回答 #5

> 赞同：26
> 
> 时间：2018-04-12T20:32:45.837

如果您在**High Sierra**上并遇到此问题，请按照以下步骤操作（**注意： /usr/local 不能在 High Sierra 中被 chown'd**）：

```
sudo mkdir /usr/local/include
sudo chown -R $(whoami) $(brew --prefix)/* 
```

然后尝试使用 brew link 进行链接。我遇到了类似的问题，上面的解决方案都不适用于 High Sierra。希望这可以帮助某人。

* * *

## 回答 #6

> 赞同：23
> 
> 时间：2018-01-24T08:19:28.590

对于高山脉：

```
/usr/bin/ruby -e "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)" 
```

然后，尝试您的 brew 命令。

[问题 #3285](https://github.com/Homebrew/brew/issues/3285)

* * *

## 回答 #7

> 赞同：12
> 
> 时间：2015-10-06T06:40:48.080

您可以使用别名命令来解决此问题，`.bash_profile`并在每次遇到它时运行它：

在文件末尾`~/.bash_profile`添加：

```
alias fix_brew='sudo chown -R $USER /usr/local/' 
```

现在在您的终端内，您可以运行：

```
$ fix_brew 
```

* * *

## 回答 #8

> 赞同：12
> 
> 时间：2016-09-20T17:27:58.580

这在**macOS 10.12上对我有用**

`sudo chown -R $(whoami) /usr/local`

我在更新自制软件时遇到了以下错误：

```
/usr/local is not writable. You should change the ownership
and permissions of /usr/local back to your user account:
  sudo chown -R $(whoami) /usr/local 
```

* * *

## 回答 #9

> 赞同：8
> 
> 时间：2015-12-21T22:22:38.790

对于某些人来说，这将是：

```
sudo chown -R JonJames:admin /usr/local/lib 
```

其中使用“lib”而不是“bin”或“include”或“其他”

Homebrew**警告**“应该”解释什么具体是不可写的，然后给你一个命令语法来跟随，但是你需要使用“：”而不是警告提到的实际上是不正确的语法？

* * *

## 回答 #10

> 赞同：7
> 
> 时间：2015-10-07T22:30:06.210

为我工作

```
$ sudo chown -R $(whoami):admin /usr/local

$ cd /usr/local/Library && git stash && git clean -d -f 
```

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2017-11-29T18:10:12.943

MacOS 10.13 上的相同错误

`/usr/local/include`并且`/usr/local/` `/usr/lib`没有被创建。我手动创建并`brew link`最终工作。

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2019-06-13T00:21:17.150

首先，您需要创建目录：

```
sudo mkdir /usr/local/include 
```

第二：

```
sudo chown -R $(whoami) $(brew --prefix)/* 
```

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2018-03-01T23:38:44.170

什么对我有用，而我的计算机上有**超过**1 个用户。

使用终端：

*   跑步`brew doctor`
    *   看到多个`/usr/local/...`不可写错误
*   禁用 Mac 的系统完整性保护：[https ://apple.stackexchange.com/a/208481/55628](https://apple.stackexchange.com/a/208481/55628)
*   运行以下
*   `sudo chown -R $(whoami) /usr/local/*`
*   `brew doctor && brew upgrade && brew doctor`

> 运行 Macbook Pro OSX High Sierra（版本 10.13.3。）

编辑1：

> 仅供参考 - 请注意，这会导致在您的 MAC 上运行 MySQL 出现问题。
> 
> 为了能够启动我的本地服务器，我必须运行：

```
sudo chown -R mysql:mysql /usr/local/mysql/data 
```

运行此命令后，您可以启动本地 MySQL 服务器。

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2018-03-07T05:38:46.167

如果 /usr/local/include 和 /usr/local/lib 不存在，则需要创建它们：

```
$ sudo mkdir -p /usr/local/include
$ sudo chown -R $USER:admin /usr/local/include 
```

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2019-01-15T14:48:29.953

```
sudo mkdir -p /usr/local/include /usr/local/lib /usr/local/sbin

sudo chown -R $(whoami) /usr/local/include /usr/local/lib /usr/local/sbin 
```

这将创建所有必需的目录并为其赋予正确的所有权。

运行这些命令后检查：`brew doctor`

这适用于莫哈韦沙漠。

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2016-11-05T00:33:59.080

你需要控制整个`/usr/local`来做你需要做一个递归`chown`下`/usr/local`

`sudo chown -R YOUR_USERNAME:admin /usr/local/`

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2019-04-09T23:52:07.500

我只想回应[sam9046](https://stackoverflow.com/users/3010020/sam9046)的谦虚评论，作为在我的情况下可行的替代方案，并且可能更容易解决：从头开始[卸载](https://docs.brew.sh/FAQ#how-do-i-uninstall-homebrew)并重新[安装自制软件。](https://brew.sh/)不需要 sudo 命令。

如果您需要确保它不会影响您以前安装的软件包，您还可以从上面的链接浏览/修改卸载脚本。就我而言，这只是我的家用机器，所以我刚刚重新开始。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2015-04-23T18:48:44.447

在我们的所有用户都绑定到活动目录（有效地将 UID 从 50x 更改为 ######）之后，我的组织中发生了这种情况。

现在只需将 x 拥有的所有文件的所有权更改为 y 即可。

其中 501 是我的旧数字用户 ID，它仍然与所有自制文件相关联。

可以使用找到旧的用户 ID`ll /usr/local/Cellar`

现在更新所有权 `sudo find /usr/local -user 501 -exec chown -h $USER {} \;`

这样我们就可以避免更改不受自制软件控制或属于其他系统用户的文件的所有权。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2018-11-26T02:31:11.487

进入 /bin 目录并输入：

chown -R $(whoami):admin /usr/local/bin

# android - Android GUI：TextView 不断更新

> ID：14527525
> 
> 赞同：-1
> 
> 时间：2013-01-25T17:52:11.040
> 
> 标签：android, user-interface

我在理解 runOnUiThread() 时遇到了一些问题。我想不断更新 TextView 但没有任何反应。GUI 仍然被阻止。有人可以帮我吗？

```
@Override public void onCreate(Bundle savedInstanceState) {

        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);        
        runner();
    }

public void runner (){
    String[] testFiles = GeneralHelper.getPictureFileList();
    TextView text = (TextView) findViewById(R.id.textfeld); 
    for (int i = 0; i < 2; i++) 
    {   
        runOnUiThread(new Runnable() {
            public void run() {
                text.setText("\n" + GeneralHelper.getPictureFileList()[i]);    
            }

           });
           ...
           // image analysis
}} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T17:58:10.160

循环只有 2 次迭代，它完成得如此之快，以至于你甚至看不到变化。你只看到结果`GeneralHelper.getPictureFileList()[1]` 而且你在 UiThread 里面，所以你不应该使用它。只是：

```
public void runner (){
    String[] testFiles = GeneralHelper.getPictureFileList();
    TextView text = (TextView) findViewById(R.id.textfeld); 
    for (int i = 0; i < 2; i++) 
    {
            text.setText("\n" + GeneralHelper.getPictureFileList()[i]);    
    }
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-25T17:55:38.830

听起来您需要创建自己的计时器类，您可以在其中包含 runOnUiThread() 来更新您的 TextView。这就是我在我编写的程序中所做的，我需要在用户按下按钮时显示每秒计数的时间。

# backbone.js - Backbone - 更改 http/url 请求的根目录（但不用于骨干路由）

> ID：14527527
> 
> 赞同：2
> 
> 时间：2013-01-25T17:52:14.577
> 
> 标签：backbone.js, trigger.io, backbone-routing

我有一个网络应用程序，我正在转换到 trigger.io 应用程序。

我试图让它作为一个单页应用程序工作，目前，它充满了问题。

我现在的一个问题是，这是我们为 api 调用设置 url 的方式：

```
Muse.prototype.url = function() {
  return "/answers/" + this.id + ".json";
}; 
```

显然，它将使用根（本地主机）并调用

```
http://localhost:3000/answers/slug 
```

但由于它是单个文件，它调用

```
file:///file_path/answers/slug 
```

这显然会失败。

如何让它使用我定义的根而不更改主干路由的根？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T20:40:54.910

您可以覆盖[同步方法](http://backbonejs.org/#Sync)：

```
var sync = Backbone.sync;
Backbone.sync = function(method, model, options) {
    options.beforeSend = function (jqXHR, settings) {
        settings.url = 'http://localhost:3000' + settings.url;
    };
    return sync(method, model, options);
}; 
```

# python - Python共享属性父/子

> ID：14527531
> 
> 赞同：2
> 
> 时间：2013-01-25T17:52:25.077
> 
> 标签：python, python-2.7

不好意思问，但我正在使用 webapp2，我正在模板化一个解决方案，以便更容易地[根据这个 google webapp2 路由功能](http://webapp-improved.appspot.com/guide/handlers.html)定义路由。但这一切都取决于能够`TYPE_NAME`在子级别进行定义。这个想法是父母设置一切，孩子只需要实现该`_list`功能。我遇到的问题`TYPE_NAME`是没有，我需要它成为孩子。

```
#main WSGI is extended to have this function 
class WSGIApplication(webapp2.WSGIApplication):
    def route(self, *args, **kwargs):
        def wrapper(func):
            self.router.add(webapp2.Route(handler=func, *args, **kwargs))
            return func

        return wrapper 
```

* * *

```
from main import application
class ParentHandler(RequestHandler):
    TYPE_NAME = None

    @application.route('/', name="list_%s" %TYPE_NAME)
    def list(self):
          return self._list()

class ChildHandler(ParentHandler):
    TYPE_NAME = 'child'

    def _list(self):
         return [] 
```

我尝试了几个使用“类属性”的解决方案，但没有成功。打开其他想法，我基本上只需要子类继承装饰属性并执行它们。

**编辑：**

对于所有坐在座位边缘想知道我如何解决这个问题的人，我无法从装饰器中得到我需要的一切，所以我最终使用了一个元。我还添加了一个`_URLS`参数以允许添加其他“路线”。它将 `custom`功能映射到路线。真的很想使用装饰器，但无法让它工作。

```
class RequestURLMeta(type):
    def __new__(mcs, name, bases, dct):
        result = super(RequestURLMeta, mcs).__new__(mcs, name, bases, dct)
        urls = getattr(result, '_URLS', {}) or {}
        for k,v in urls.iteritems():
            template = v.pop('template')
            app.route(getattr(result, k), template, **v)

        if getattr(result, 'TYPE_NAME', None):
            app.route(result.list, result.ROOT_PATH, methods=['GET'],name="%s" % result.TYPE_NAME)
        #other ones went here..

    return result

class ParentHandler(RequestHandler):
    __metaclass__ = RequestURLMeta

class ChildHandler(ParentHandler):
    TYPE_NAME = 'child'
    _URLS = { 'custom': '/custom', 'TYPE_NAME': 'custom_test' }
    def _list(self):
        return []
    def custom(self):  pass 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T18:29:19.503

我认为要使它起作用，您将需要使用[metaclass](https://stackoverflow.com/a/6581949/505154)。它可能类似于以下内容（未经测试）：

```
from main import application

class RouteMeta(type):
    def __new__(mcs, name, bases, dct):
        type_name = dct.get("TYPE_NAME")
        if type_name is not None:
            @application.route('/', type_name)
            def list(self):
                return self._list()
            dct["list"] = list
        return super(RouteMeta, mcs).__new__(mcs, name, bases, dct)

class ParentHandler(RequestHandler):
    __metaclass__ = RouteMeta

class ChildHandler(ParentHandler):
    TYPE_NAME = 'child'

    def _list(self):
         return [] 
```

Instead of having the `list()` method an attribute of `ParentHandler`, it is dynamically created for classes that inherit from `ParentHandler` and have `TYPE_NAME` defined.

If `RequestHandler` also uses a custom metaclass, have `RouteMeta` inherit from `RequestHandler.__metaclass__` instead of `type`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T18:22:01.383

这段代码：

```
@application.route('/', name="list_%s" %TYPE_NAME)
def list(self):*emphasized text*
    ... 
```

在语义上与此相同：

```
def list(self):
    ...
list = application.route('/', name="list_%s" %TYPE_NAME)(list) 
```

即该方法`route`在范围内被调用`ParentHandler`，无论您尝试什么惰性方法，它都不起作用。你应该尝试一些不同的东西：

```
from main import application

def route_list(klass):
    klass.list = application.route('/',
        name="list_%s" % klass.TYPE_NAME)(klass.list)
    return klass

class ParentHandler(RequestHandler):

    def list(self):
          return self._list()

class ChildHandler(ParentHandler):
    TYPE_NAME = 'child'

    def _list(self):
         return []

# in python3 would be:
# @route_list
# class ChildHandler(ParentHandler):
#   ...
ChildHandler = route_list(ChildHandler) 
```

# mysql - 检索包含字段最大值的整行

> ID：14527532
> 
> 赞同：2
> 
> 时间：2013-01-25T17:52:28.013
> 
> 标签：mysql, sql, greatest-n-per-group

我想计算出借书数量最多的学科领域。我有以下查询：

```
SELECT SubjectArea
FROM (

  SELECT SubjectArea, MAX( Copies_On_Loan ) AS Max
  FROM (

    SELECT
      Section.SubjectArea AS SubjectArea, 
      SUM( LoanBook.Copies_On_Loan ) AS Copies_On_Loan
    FROM Section
      NATURAL JOIN Items
      NATURAL JOIN LoanBook
    GROUP BY Section.SubjectArea
  ) AS Table1
) AS Table2 
```

最里面的查询：

```
 SELECT 
      Section.SubjectArea AS SubjectArea, 
      SUM( LoanBook.Copies_On_Loan ) AS Copies_On_Loan
    FROM Section
      NATURAL JOIN Items
      NATURAL JOIN LoanBook
    GROUP BY Section.SubjectArea 
```

返回下表：

```
SubjectArea Copies_On_Loan
Biology         0
DBMS            3 
```

**但是，整个查询给出的结果是生物学（而不是 DBMS）。请提出为什么会这样**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T18:49:12.517

在我的脑海中，看起来你需要类似的东西：

```
SELECT SubjectArea
FROM Section NATURAL JOIN Items NATURAL JOIN LoanBook
GROUP BY SubjectArea
HAVING SUM(Copies_On_Loan) = (
    SELECT MAX(M) (
        SELECT SUM(Copies_On_Loan) M
        FROM Section NATURAL JOIN Items NATURAL JOIN LoanBook
        GROUP BY SubjectArea
    ) Q1
) Q2 
```

计划中的英语：

*   对每个主题的贷款求和 ( `SUM(Copies_On_Loan) M`) 并找到最大总和 ( `MAX(M)`)。
*   然后只选择 sum 与最大值 ( ) 匹配的那些结果`HAVING`。

* * *

*PS：正如其他人所建议的那样，使用显式列名（代替 NATURAL JOIN）将使您的代码不那么“脆弱”。*

*PPS：你真的应该为这些问题提供数据库结构，或者更好的是一个有效的 sqlfiddle.com 示例，这样我们就可以立即测试答案。*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T18:02:58.160

好的，我想我明白您想要什么——您正在尝试获取具有 Max(Copies_On_Loan) 的主题。如果是这样，这应该可以工作（如果 MySQL 支持 CTE 会更漂亮）：

```
SELECT SubjectArea
FROM (
  SELECT MAX( Copies_On_Loan ) AS Max_Copies_On_Loan 
  FROM (
    SELECT
      Section.SubjectArea AS SubjectArea, 
      SUM( LoanBook.Copies_On_Loan ) AS Copies_On_Loan
    FROM Section
      NATURAL JOIN Items
      NATURAL JOIN LoanBook
    GROUP BY Section.SubjectArea
  ) AS Table1
) AS Table2 JOIN 
(
   SELECT
      Section.SubjectArea AS SubjectArea, 
      SUM( LoanBook.Copies_On_Loan ) AS Copies_On_Loan
    FROM Section
      NATURAL JOIN Items
      NATURAL JOIN LoanBook
    GROUP BY Section.SubjectArea
) Table3 ON Table2.Max_Copies_On_Loan  = Table3.Copies_On_Loan 
```

这是更新的[SQL Fiddle](http://sqlfiddle.com/#!2/cd335/9)。

祝你好运。

# mysql - 在 MySQL Installtaion 中取消选中 Modify Security Settings 时，拒绝访问 root@localhost

> ID：14527541
> 
> 赞同：1
> 
> 时间：2013-01-25T17:52:43.233
> 
> 标签：mysql, passwords, installation, root

我正在使用安装程序在 Windows 上安装 MySql 5.1。

在安全选项步骤中，我没有检查修改安全设置并继续下一步 ![在此处输入图像描述](../Images/a391723ee0d689e1212bc4e3f6c33f27.png)

当我想以 root 身份登录时收到拒绝访问消息

用户 root@ localhost 的访问被拒绝（使用密码：否）

出了什么问题，为什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T09:19:19.700

如果您从未为 MySQL 设置过 root 密码，则服务器根本不需要密码来以 root 身份连接。但不清楚您是如何尝试以 root 身份登录的。

[无论如何，您可以按照以下步骤](http://dev.mysql.com/doc/refman/5.1/en/resetting-permissions.html#idp152165392)重置 root 密码。

# javascript - 关闭会话时未删除移动浏览器（chrome、safari）cookie

> ID：14527544
> 
> 赞同：7
> 
> 时间：2013-01-25T17:52:57.170
> 
> 标签：javascript, android, ios, mobile

移动浏览器（chrome，safari）没有杀死过期时间设置为“0”的cookie，重新打开浏览器时相同的cookie仍然存在......

* * *

## 回答 #1

> 赞同：-3
> 
> 时间：2014-03-28T15:44:34.890

*必须使用与设置相同的参数来删除 Cookie。如果 value 参数是空字符串或 FALSE，并且所有其他参数与之前对 setcookie 的调用匹配，则将从远程客户端删除具有指定名称的 cookie。这是通过将值设置为“已删除”并将到期时间设置为过去一年来在内部实现的。*

来自官方手册： http: [//php.net/manual/en/function.setcookie.php](http://php.net/manual/en/function.setcookie.php)

# xcode - XCode：项目文件不再与项目/故事板链接

> ID：14527546
> 
> 赞同：0
> 
> 时间：2013-01-25T17:53:03.253
> 
> 标签：xcode

最近，对我的一个项目进行了一些修改，该项目必须从 SVN 重新导入。所有文件都在那里，但是在尝试使用某些项目文件时我遇到了奇怪的问题。

例如，当在 IB 中选择一个视图时，助手视图将自动显示该视图的关联头文件。现在，助手视图中的“自动”选项卡下没有任何内容。

此外，当尝试 #import 某些文件并创建它们的实例时，xcode 会返回错误`Unknown type name`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T19:27:58.377

我似乎已经解决了这个问题。我必须创建一个新的 .h 和 .m 文件并将旧 .h 和 .m 的内容复制到新文件中。一旦我在情节提要中设置视图以使用此文件，我就不再收到任何错误。

# git - Git-Workflow 不知道如何引入未合并的存储库

> ID：14527550
> 
> 赞同：0
> 
> 时间：2013-01-25T17:53:16.890
> 
> 标签：git

我遇到了 git-flow 的问题。

我编辑了很多文件，但我不想提交所有文件，所以我只提交了一些文件到我的本地存储库。

因此，当我尝试将存储库推送到主存储库时，它告诉我

```
! [rejected]        
master -> master (non-fast-forward)
error: failed to push some refs to <snip>
To prevent you from losing history, non-fast-forward updates were rejected
Merge the remote changes before pushing again.  See the 'Note about
fast-forwards' section of 'git push --help' for details. 
```

但是我也不能从主仓库中拉出来，因为 git 想让我在之前合并

```
error: Your local changes to <snip> would be overwritten by merge.  Aborting.
Please, commit your changes or stash them before you can merge. 
```

但我不想提交这些，我不知道如何让它们恢复到所有更改之前的状态。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T17:57:54.820

使用存储本地更改

```
git stash 
```

然后拉远程更改

```
git pull 
```

最终恢复您之前隐藏的更改

```
git stash pop 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-25T18:01:14.670

你应该做的是让`master`分支远离上游，并创建你自己的私有分支来玩耍。如果在私人分支机构中烹饪的一些想法变成了烹饪杰作，则将其合并（或变基，或樱桃挑选）`master`并推动结果。通过基于`master`.

[在此处](http://git-scm.com/)阅读一些推荐的 git 工作流程

# c# - 使用 LINQ 在绑定列表中选择符合条件的对象？

> ID：14527555
> 
> 赞同：2
> 
> 时间：2013-01-25T17:54:08.413
> 
> 标签：c#, linq

我有一个包含 100,000 个对象的 BindingList。每个对象都包含一个 bool 属性，指示该对象是否已被修改。我基本上想遍历对象，当我找到一个将该 bool 属性设置为 true 的对象时，我想将其设置为 false。与此类似的东西：

```
foreach (myObject obj in bindingListOfMyObjects)
{
    if (obj.Modified)
    {
        obj.Modified = false;
    }
} 
```

是否可以使用 LINQ 做到这一点？那会比上面的代码更快吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T17:55:26.510

不，在 LINQ 中无法做到这一点。为此，您需要直接在`BindingList`. LINQ 只会返回一个新的`IEnumerable`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-25T18:00:49.660

您可以使用`Enumerable.Where`来过滤集合，并在您的循环中修改它们：

```
foreach (myObject obj in bindingListOfMyObjects.Where(o => o.Modified))
     obj.Modified = false; 
```

这不会更快，尽管理解意图可能会稍微容易一些。

请注意，一般情况下，您不会使用 LINQ 来实际进行修改 - LINQ 查询，就其性质而言，不应引起副作用（更改值）。它们旨在用作*查询*- 因此过滤对象是合适的，然后在循环中设置。有关详细信息，我建议阅读[Eric Lippert 关于 ForEach 与 foreach 的帖子](http://blogs.msdn.com/b/ericlippert/archive/2009/05/18/foreach-vs-foreach.aspx)。

# cucumber - Capybara中表格的复杂断言

> ID：14527556
> 
> 赞同：3
> 
> 时间：2013-01-25T17:54:13.797
> 
> 标签：cucumber, capybara

我的应用程序中有一张桌子。

![在此处输入图像描述](../Images/47b00cdc795855b0a8460628f2470226.png)

使用 Capybara 和 Cucumber，我如何断言值 4.5 和 1.1 仅发生在 Mike 的行中？
在 Capybara 中可以这样断言吗？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-25T19:45:50.437

您可以[在](http://rubydoc.info/github/jnicklas/capybara/master/Capybara/Session#within-instance_method)要搜索特定值的范围内使用：

例如，要断言值 4.5 发生在 Mike 行的第二列，请尝试以下操作：

```
within("table tr:nth-child(2)") do
  find("td:nth-child(2)").text.should == 4.5
end 
```

如果您愿意，可以将它们包装在辅助方法中以便于使用：

```
def within_row(num, &block)
  within("table tr:nth-child(#{num})", &block)
end

def column_text(num)
  find("td:nth-child(#{num})").text
end 
```

现在，您可以通过执行以下操作对 Mike 的行做出相同的断言：

```
within_row(2) do
  column_text(2).should == 4.1
end 
```

希望您会发现其中一种技术对您正在尝试做的事情有用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-25T20:52:07.323

是的，这是可能且容易的：

```
def td_text(n)
  find(:xpath, "./td[#{n}]").text
end

h = {2 => 4.5, 3 => 1.1}

all('table tr').each do |row|
  within row do
    if td_text(1) == 'Mike'
      h.each { |i, value| td_text(i).should == value.to_s }
    else
      h.each { |i, value| td_text(i).should_not == value.to_s }
    end
  end
end 
```

这是可用于测试的[完整脚本](https://gist.github.com/4637735)

**更新：**我想多了。上面的代码会很慢，因为每次调用`find`和`text`in`td_text`都会对浏览器进行新的查询。

我看到的唯一减轻它的方法是使用 JS 和 Nokogiri：

```
source = page.evaluate_script("document.getElementsByTagName('table')[0].innerHTML")

doc = Nokogiri::HTML(source)

def td_text(row, n)
  row.xpath("./td[#{n}]").text
end

h = {2 => 4.5, 3 => 1.1}

doc.css('tr').each do |row|
  if td_text(row, 1) == 'Mike'
    h.each { |i, value| td_text(row, i).should == value.to_s }
  else
    h.each { |i, value| td_text(row, i).should_not == value.to_s }
  end
end 
```

第一个代码变体在我的机器上运行大约 200 毫秒，而第二个变体 - 8 毫秒。好优化！

# python - 具有多处理问题的极小极大算法

> ID：14527558
> 
> 赞同：1
> 
> 时间：2013-01-25T17:54:21.327
> 
> 标签：python, python-3.x, multiprocessing, minimax

我有我认为可能只是这个 Python 代码中的一个同步问题。该代码旨在将极小极大算法应用于井字游戏，通过并行进程而不是单个进程来实现，一一探索所有可能的移动。在将其标记为一个非常糟糕的主意之前，我被要求这样做。

假设未知方法确实与他们的名字所暗示的完全一致，并假设它们可以正常工作（它们已经过手动测试）。我不能 100% 确定的唯一方法是这个，这里是代码：

```
def q_elems(queue):
    li = []
    while not queue.empty(): li.append(queue.get())
    return li 
```

游戏板用一个简单的`Board`类（扩展`list`类）表示。 `SimpleQueue`和`Process`类是从`multiprocessing`Python 模块导入的。 `H`函数是我实现的启发式函数：它返回对玩家 MAX 有利的棋盘正值，对 MIN 返回负值，对平局返回 0。这是算法代码：

```
def minimax(board: Board, depth: int, turn: int, queue: SimpleQueue) -> int:
     queue.put(10000)

     if is_winning(board) or is_tie(board) or depth == 0:
         queue.put(H(board))
         return

     local_queue = SimpleQueue()

     prcs_list = []
     for child_brd in possible_moves(board, MAX if turn == TURN_MAX else MIN):
         p = Process(target=minimax, args=(
             Board(child_brd),                               # board
             depth - 1,                                      # depth
             TURN_MIN if turn == TURN_MAX else TURN_MAX,     # turn
             local_queue)                                    # queue
             )

         prcs_list.append(p)

     [p.start() for p in prcs_list]
     [p.join() for p in prcs_list]

     # turn was MAX
     if turn == TURN_MAX:
         queue.put(max(q_elems(local_queue)))
         return
     # turn was MIN
     else:
         queue.put(min(q_elems(local_queue)))
         return 
```

主要方法很简单：

```
k = SimpleQueue()
minimax(b, MINIMAX_DEPTH, turn=TURN_MAX, queue=k) 
```

我经常遇到这种错误：

```
Traceback (most recent call last):
  File "game.py", line 202, in <module>
    minimax(b, MINIMAX_DEPTH, turn=TURN_MAX, queue=k)
  File "game.py", line 182, in minimax
    queue.put(max(q_elems(local_queue)))
ValueError: max() arg is an empty sequence 
```

但不总是。递归方法有错误吗？我实在想不通。

我的想法是为每一回合建立一个本地队列，然后从该队列中提取最大/最小值，将其带到“上”队列，即前一回合的队列。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T16:12:50.573

我怀疑你们中的任何人都在问自己这里的问题出在哪里，但对于未来可能的读者：该方法在传递给它的队列上`q_elems`执行一个方法，该方法实际上从队列中**弹出**元素，返回它们但也删除它们从队列中。`get`

 **问题解决了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-26T00:03:45.273

因此，从该消息中，听起来 q_elems(local_queue) 正在返回 []，这意味着 local_queue 中没有任何内容。

possible_moves() 是否会返回一个空列表（例如，在棋盘上进行了所有动作之后）？如果 possible_moves 没有产生任何东西，那么您的本地队列中不会有任何东西。**

# r - 如何在不强制转换为数字的情况下迭代日期列表？

> ID：14527564
> 
> 赞同：12
> 
> 时间：2013-01-25T17:54:37.387
> 
> 标签：r, list, date, for-loop

这与[在 Date 或 POSIXct 对象上循环导致数字迭代器有关](https://stackoverflow.com/questions/6434663/looping-over-a-datetime-object-results-in-a-numeric-iterator)

```
> dates <- as.Date(c("2013-01-01", "2013-01-02"))
> class(dates)
[1] "Date"
> for(d in dates) print(class(d))
[1] "numeric"
[1] "numeric" 
```

我有两个问题：

1.  迭代 Date 对象列表的首选方法是什么？
2.  我不明白 Joshua 的答案（从上面链接的问题中接受的答案），我会在这里引用它：“所以你的`Date`向量被强制为，`numeric`因为`Date`对象不是严格的向量”。那么如何确定`Date`应该被强制`numeric`呢？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-01-25T18:03:42.337

这里有两个问题。一个是输入是否被强制从`Date`to `numeric`。另一个是输出是否被强制转换为`numeric`.

**输入**

For 循环强制`Date`输入到`numeric`，因为正如@DWin 和@JoshuaUlrich 指出的那样，`for`循环 take`vectors`和`Date`s 在技术上不是向量。

```
> for(d in dates) print(class(d))
[1] "numeric"
[1] "numeric" 
```

另一方面，`lapply`它的简化子代`sapply`没有这样的限制。

```
> sapply( dates, function(day) class(day) )
[1] "Date" "Date" 
```

**输出**

然而！上面的输出`class()`是一个字符。如果您尝试实际返回日期对象，`sapply`则不是您想要的。

`lapply`不会强制转换为向量，但`sapply`会：

```
> lapply( dates, identity )
[[1]]
[1] "2013-01-01"

[[2]]
[1] "2013-01-02"

> sapply( dates, identity )
[1] 15706 15707 
```

这是因为`sapply`的简化函数将输出强制转换为向量。

**概括**

所以：如果你有一个`Date`对象并且想要返回一个非`Date`对象，你可以使用`lapply`or `sapply`。如果您有一个非`Date`对象，并且想要返回一个`Date`对象，则可以使用`for`循环或`lapply`. 如果您有一个`Date`对象并想要返回一个`Date`对象，请使用`lapply`.

**更多学习资源**

如果您想更深入地研究向量，您可以从[John Cook 的笔记](http://www.johndcook.com/R_language_for_programmers.html#vectors)开始，继续[阅读 R Inferno](http://www.burns-stat.com/pages/Tutor/R_inferno.pdf)，然后继续[阅读 SDA](https://rads.stackoverflow.com/amzn/click/com/1441926127)。

# java - 如何在java中的jtextFiled视图中添加弹出窗口

> ID：14527566
> 
> 赞同：2
> 
> 时间：2013-01-25T17:54:40.033
> 
> 标签：java, swing, user-interface, popup, jtextfield

我开发了一个 java gui，其中包含两个 jTextField 视图，用于显示源文件路径和目标文件路径。而且，用户选择了多个文件路径，我想在附加到 jTextField 的弹出窗口中显示以前的路径。这是几乎所有应用程序的共同功能。有谁知道这是怎么称呼的，以便谷歌如何做到这一点？

![在此处输入图像描述](../Images/aaf880859be3da35e366dca0f7c4c9c3.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-25T17:55:42.503

它被称为可编辑`JComboBox`的。

# c# - 打印 DataGridView 而不将其转换为位图

> ID：14527575
> 
> 赞同：1
> 
> 时间：2013-01-25T17:55:06.287
> 
> 标签：c#, .net, c#-4.0, c#-3.0, c#-2.0

我发现的大多数打印数据网格视图的解决方案都是基于将其转换为位图图像，然后将其发送以进行打印。甚至 MSDN 也在说同样的话。

那么我怎样才能打印唯一的内容呢？我是否必须逐行读取每一行并将它们保存在字符串数组或类似的东西中？

编辑：@Robert 这个想法很好，但我到底该怎么做呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T18:40:01.537

另一种解决方案是使用 Response.Write 创建输出文件，如下所示：

```
 Response.Clear();
                Response.ClearContent();
                Response.ClearHeaders();
                Response.Buffer = true;
                Response.ContentType = "application/vnd.ms-excel";
                Response.Write(@"<!DOCTYPE HTML PUBLIC ""-//W3C//DTD HTML 4.0 Transitional//EN"">");
                Response.AddHeader("Content-Disposition", "attachment;filename=Reports.xls");
                //sets font
                Response.Write("<font style='font-size:10.0pt; font-family:Calibri;'>");
                Response.Write("<br/><br/><br/>");
Response.Write("<table border='1' bgColor='#ffffff' borderColor='#000000' cellSpacing='0' cellPadding='0' style='font-family:Calibri; background:white;'>");
    ...More output data ...            // Send to save
                Response.Write("</table>");
                Response.Flush();
                Response.End(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T17:58:25.333

我为类似项目提出的一种解决方案是将数据导出到 Excel 电子表格，让用户可以选择保存文件或稍后打印。但是，我不确定您是否想走那条路，但这是一个选择。

# javascript - 如何编写智能 onblur 事件

> ID：14527577
> 
> 赞同：1
> 
> 时间：2013-01-25T17:55:11.113
> 
> 标签：javascript, jquery, jquery-ui, javascript-events

假设我们有这个示例代码：

```
<input type="text" onblur="blurHandler()" />
<div class="results">
    <ul>
        <li><a href="#" onclick="clickHandler(this);">sampleText</a></li>
    </ul>
</div> 
```

假设您当前专注于输入标签，然后将鼠标悬停在“a”标签上并单击它。浏览器将首先处理 onblur 事件。

blur 事件的任务是它应该隐藏结果 div，但您仍然希望能够在此之前单击结果 div 中的链接。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T17:56:50.833

*   在`blurHandler`中，用于[`setTimeout()`](https://developer.mozilla.org/en-US/docs/DOM/window.setTimeout)延迟隐藏您的 div。

    ```
    function blurHandler() {
        setTimeout(function () {
            //close the div
        }, 100);
        //do whatever else needs to be done
    } 
    ```

    [jsFiddle 演示](http://jsfiddle.net/b8H4z/)

*   另一种选择是使用链接上的`mouseenter`/`mouseleave`事件，并在事件处理程序之间使用公共标志，以便它们彼此了解。

*   还有一个：你可以用一个简短的动画隐藏 div，所以当点击发生时它实际上仍然存在。像这样的东西：

    ```
     $('.results').hide(1000); 
    ```

    [jsFiddle 演示](http://jsfiddle.net/b8H4z/1/)

* * *

**注意**：你应该看看[高级事件处理](http://www.quirksmode.org/js/events_advanced.html)，内联事件处理程序真的会很快搞砸你的 HTML。关注点分离有助于他人和未来的自己。如果你使用 jQuery（查看你的问题下的标签），你应该使用 jQuery 的事件处理方法，它已经使用了高级模型。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T18:06:53.603

I agree with Marcell's comment, though perhaps more from a usability perspective.

Assigning a timeout (as suggested by bažmegakapa) means you're choosing an arbitrary time limit that may or may not fire before the user has processed what they are supposed to do before that time limit is over. Unless your UI somehow makes it clear that they must react within a given time frame, this is likely to lead to frustrated users.

Even taking for granted that the users have had time to process the directions on screen, there's also transition time between moving from keyboard to mouse (or touch, where it's even worse as you have to deal with the UI shifting to hide the soft-keyboard), which means there's even more variance between different users' and their ability to follow the directions before the time limit you've chosen is over.

Just something to think about, in regard to how your interactivity is set up.

# opengl - glClear() 在 Intel HD 4000 (GL 4.0) 上给出 GL_OUT_OF_MEMORY 但在 GeForce (GL 4.2) 上没有给出……为什么？

> ID：14527578
> 
> 赞同：5
> 
> 时间：2013-01-25T17:55:12.403
> 
> 标签：opengl, go, framebuffer, render-to-texture

现在，这是一个非常奇怪的行为。

TL;DR - 在渲染到纹理设置中，在调整窗口大小（帧缓冲区 0）时，只有下一次调用**glClear(GL_COLOR_BUFFER_BIT)**绑定帧缓冲区 0（窗口的客户区）才会给出**GL_OUT_OF_MEMORY**，仅在两个之一上GPU，但是渲染仍然正确且正确地进行。

现在，所有坚韧不拔的细节：

所以这是在带有两个 GPU 的 Vaio Z 上（可以通过机器上的物理切换按钮切换到）：

1.  OpenGL 4.2.0 @ NVIDIA Corporation GeForce GT 640M LE/PCIe/SSE2（GLSL：4.20 NVIDIA 通过 Cg 编译器）

2.  OpenGL 4.0.0 - Build 9.17.10.2867 @ Intel Intel(R) HD Graphics 4000 (GLSL: 4.00 - Build 9.17.10.2867)

我的程序在使用 GLFW 64 位的 Win 7 64 位下的 Go 1.0.3 64 位。

我有一个相当简单直接的渲染到纹理“迷你管道”。首先，使用最简单的着色器（没有照明，什么都没有，只是纹理三角形网格，它们只是一些立方体和平面）将普通 3D 几何图形渲染到一个帧缓冲区，该帧缓冲区具有作为深度/模板附件的深度/模板渲染缓冲区和一个texture2D 作为颜色附件。对于纹理，所有过滤都被禁用，mip-maps 也是如此。

然后，我使用 texelFetch(tex, gl_FragCoord.xy, 0) 从所述帧缓冲区纹理（颜色附件）中采样渲染一个全屏四边形（实际上是一个“超大”全屏 tri），因此不使用包装。

当我强制核心配置文件和不强制使用核心配置文件时，两个 GPU 都可以很好地呈现这一点。没有为此报告任何 GL 错误，所有渲染也都按预期进行。除非我在使用 Intel HD 4000 GPU 的 GL 4.0 渲染器（在核心配置文件和 Comp 配置文件中）时调整窗口大小。只有在这种情况下，单个调整大小将在帧缓冲区 0（屏幕）上的下一个 glClear(GL_COLOR_BUFFER_BIT) 调用之后直接记录 GL_OUT_OF_MEMORY 错误，但仅在调整大小后记录一次，而不是在每个后​​续循环迭代中。

**有趣的是，我什至实际上并没有对调整大小进行任何分配！**我暂时禁用了窗口调整大小时发生的所有逻辑——也就是说，现在我完全*忽略*了窗口调整大小事件，这意味着 RTT 帧缓冲区及其深度和颜色附件分辨率甚至没有更改/重新创建。这意味着下一个 glViewPort 仍将使用与第一次创建窗口和 GL 上下文时相同的尺寸，但无论如何错误发生在 glClear() 上（不是之前，只是之后，只有一次 - 我已经双重和三重检查了）。

这会是驱动程序错误，还是我在这里做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T18:27:48.710

HD 的 GL 驱动程序中的有趣故障似乎：

当我切换到渲染到纹理设置时，我还在主帧缓冲区 0（即屏幕/窗口）的 GL 上下文创建时将深度/模板位都设置为 0。这是我开始看到这个错误的时候，并且与之前相比，帧率变得相当缓慢。

我实验性地将（严格来说不需要的）深度位设置为 8，这两个问题都消失了。因此，当前的 HD 4000 GL 4.0 驱动程序版本似乎不喜欢在 GL 上下文创建时其深度缓冲区位的值为 0。

# bash - 在函数内执行传递的别名？

> ID：14527581
> 
> 赞同：15
> 
> 时间：2013-01-25T17:55:14.777
> 
> 标签：bash

**背景：**

我正在尝试制作一个以设定的时间间隔运行命令的函数，因为我无权访问“监视”程序。简化为最基本的功能，我要编写的函数是`runit() { $1; }`.

**什么有效：**

当我将不是别名的东西传递给它时，这很好用。例如，`runit "ls -l"`工作正常。我得到了`ls -l`命令的完整输出。

**什么不起作用：**

当我将别名传递给它时，问题就开始了。例如，设置`alias ll="ls -l"`然后调用`runit "ll"`将导致`-bash: ll: command not found`.

**我尝试过的事情：**

当我对 alias 进行硬编码时`runit() { ll; }`，它可以正常工作并给我我所期望的。

* * *

我觉得我可能忽略了某些东西，但我不能完全把手指放在上面。
为什么硬编码别名可以正常工作，但将其传递给函数会失败？
*有没有办法完成我正在尝试做的事情？*

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-25T18:16:10.473

从`bash`别名的手册页讨论（强调我的）：

> **别名在读取命令时扩展**，而不是在执行命令时扩展。因此，与另一个命令出现在同一行的别名定义在读取下一行输入之前不会生效。该行别名定义之后的命令不受新别名的影响。执行函数时，此行为也是一个问题。 **别名在读取函数定义时扩展，而不是在执行函数时扩展**，因为函数定义本身就是一个复合命令。因此，在函数中定义的别名在该函数执行之前不可用。为了安全起见，请始终将别名定义放在单独的行中，并且不要在复合命令中使用别名。

您可以使用 type 命令在函数中观察到这种效果：

```
$ run_it () { ll; }
$ type run_it 
```

您应该看到函数的主体包含对 的调用`ls -l`，而不是`ll`。

别名部分的最后一句话：

> 对于几乎所有用途，别名都被 shell 函数所取代。

我对该行的解释是：如果您认为要使用别名，请先尝试编写一个函数。不要使用别名，除非该功能明显无法满足您的需求。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2015-06-23T03:14:17.590

你可以`eval`这样使用：

```
$ runit() { eval $1; }
$ alias ll="ls -l"
$ runit "ll" 
```

`eval`将在执行之前展开任何别名`$1`。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-01-25T18:00:18.210

解决这个问题的一种方法是定义一个 shell 函数而不是一个别名。

```
ll () {
  ls -l "$@"
} 
```

别名在命令输入时扩展为宏，而 shell 函数在命令执行时匹配。这是一个完美的例子，说明了 shell 的宏处理器语言如何有利于交互式优雅，但却使实际编程变得复杂。

# javascript - AngularJS 在指令运行之前通过 AJAX 检索数据

> ID：14527583
> 
> 赞同：16
> 
> 时间：2013-01-25T17:55:22.237
> 
> 标签：javascript, html, angularjs, angular-ui

我正在使用 AngularUI 的**[uiMap](http://angular-ui.github.com/#directives-map)**指令来实例化谷歌地图。uiMap 指令适用于硬编码数据（`{mapOptions}`和`[myMarkers]`）；但是，当我通过检索此数据时遇到了麻烦`$http.get()`（指令在 AJAX 调用完成之前触发）。

最初我在`GoogleMaps`控制器中执行 GET，但当我意识到事情发生的顺序不正确时，我将 GET 移动到`uiMap`指令中。我有两个问题：

1.  我认为这不是正确的方法。
2.  GET 还检索数据`[myMarkers]`
    *   创建标记的函数/指令无处不在，因为它负责创建所有*覆盖*

所以我的问题是，在指令运行之前，应用程序中是否还有其他地方可以检索数据（并将其应用于范围）？

我阅读了[$q](http://docs.angularjs.org/api/ng.$q)，这听起来像是我想要的，但我不确定我是否可以在我的控制器中而不是在指令中做到这一点（也不确定`$q.defer.resolve()`与 有什么不同`$http.success()`）。

**编辑**我使用的大部分代码是从 AngularUI 的文档中复制/粘贴的，但这里有一个 plunk：[http ://plnkr.co/edit/t2Nq57](http://plnkr.co/edit/t2Nq57)

# 解决方案

根据[安迪的回答](https://stackoverflow.com/a/14528733/758177)，我使用了 uiMap 和**[uiIf](http://angular-ui.github.com/#directives-if)**的组合：

```
<!-- index.html -->
<div
  id="map_container"
  ng-controller="GoogleMaps">

  <div ui-if="mapReady">

    <div
      ng-repeat="marker in markers"
      ui-map-marker="markers[$index]"
      ui-event="{'map-click':'openMarkerInfo(marker)'}"
    ></div>

    <div
      ui-map-info-window="myInfoWindow"
      ng-include="'infobox.html'"
    ></div>

    <div
      id="map_canvas"
      ui-map="myMap"
      ui-options="mapOptions"
    ></div>

  </div>

</div> 
```

**注意事项1** uiIf 不能位于指定控制器提供其条件的同一元素中（uiIf 的优先级高于 ngController，因此在 uiIf 执行之前不会设置其控制器）。

**注意事项2**请务必使用[最新版本的 uiIf](https://github.com/angular-ui/angular-ui/blob/master/modules/directives/if/if.js)（最新标签 v0.3.2 中提供的版本已过时）。旧版本在某些情况下存在导致 TypeError 的错误。

**警告 3** jQuery 必须包含在 AngularJS 之前（在 index.html 中）；否则，您将收到一个 TypeError 说明`Object [object Object] has no method 'trigger'`（或`Object [object HTMLDivElement] has no method 'trigger'`在 Windows 上）。Chrome 将允许您进入触发功能，因为 Chrome 知道它，但 Angular 不知道（并且 Angular 正在抛出错误）。

```
function GoogleMaps( $scope , $http )
{

  var mapDefaults = {
    center:    new google.maps.LatLng(25,-90),//centres on Gulf of Mexico
    zoom:      4,
    mapTypeId: google.maps.MapTypeId.ROADMAP
  };

  $scope.mapOptions = {};
  $scope.mapReady = false;
  $scope.markers = [];

  $http.get('map.json').then(function mapData(response) {

    var map_data = response.data,
      user_defaults = map_data.user.defaults; //{center: [lat,lng], zoom: 15}

    $scope.mapOptions = {
      "center":    (typeof user_defaults.center !== 'undefined') ?
        new google.maps.LatLng(user_defaults.center[0],user_defaults.center[1])
        : mapDefaults.center,
      "zoom":      (typeof user_defaults.zoom !== 'undefined') ?
        parseInt(user_defaults.zoom,10)
        : mapDefaults.zoom,
      "mapTypeId": mapDefaults.mapTypeId
    };

    //working on code to populate markers object

    $scope.mapReady = true;

  });

  // straight from sample on http://angular-ui.github.com/#directives-map
  $scope.addMarker = function($event) { … };
  $scope.openMarkerInfo = function(marker) { … };
  $scope.setMarkerPosition = function(marker, lat, lng) { … };

}//GoogleMaps{} 
```

~~**缺点**uiMap 目前不支持domready 上的渲染制作器。我正在研究这个[GitHub 问题/评论](https://github.com/angular-ui/angular-ui/issues/173#issuecomment-8765849)中建议的 uiMapMarker 的替代版本。~~
此问题的解决方案： [https](https://stackoverflow.com/a/14617167/758177)
://stackoverflow.com/a/14617167/758177工作示例： [http ://plnkr.co/edit/0CMdW3?p=preview](http://plnkr.co/edit/0CMdW3?p=preview)

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2013-01-25T19:09:51.380

您可以延迟执行 ui-map 直到加载数据。

HTML：

```
<div ui-if="loadingIsDone">
  <div ui-map="myMap" ui-options="myOpts"></div>
</div> 
```

JS：

```
$http.get('/mapdata').then(function(response) {
  $scope.myOpts = response.data;
  $scope.loadingIsDone = true;
}); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-01-25T18:56:10.157

通常，您可以做的是设置指令，开始加载并成功完成。我假设您想为指令的所有实例加载一条数据。所以这里有一些你可能想要如何攻击的伪代码：

```
app.directive('myDelayedDirective', ['$http', '$q', function($http, $q) {

  //store the data so you don't load it twice.
  var directiveData,
      //declare a variable for you promise.
      dataPromise;

  //set up a promise that will be used to load the data
  function loadData(){ 

     //if we already have a promise, just return that 
     //so it doesn't run twice.
     if(dataPromise) {
       return dataPromise;
     }

     var deferred = $q.defer();
     dataPromise = deferred.promise;

     if(directiveData) {
        //if we already have data, return that.
        deferred.resolve(directiveData);
     }else{    
        $http.get('/Load/Some/Data'))
          .success(function(data) {
              directiveData = data;
              deferred.resolve(directiveData);
          })
          .error(function() {
              deferred.reject('Failed to load data');
          });
     }
     return dataPromise;
  }

  return {
     restrict: 'E',
     template: '<div>' + 
          '<span ng-hide="data">Loading...</span>' +
          '<div ng-show="data">{{data}}</div>' + 
        '</div>',
     link: function(scope, elem, attr) {
         //load the data, or check if it's loaded and apply it.
         loadData().then(function(data) {
             //success! set your scope values and 
             // do whatever dom/plugin stuff you need to do here.
             // an $apply() may be necessary in some cases.
             scope.data = data;
         }, function() {
             //failure! update something to show failure.
             // again, $apply() may be necessary.
             scope.data = 'ERROR: failed to load data.';
         })
     }
  }
}]); 
```

无论如何，我希望这会有所帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-25T18:35:22.590

我不确定这是否会在不查看代码的情况下有所帮助，但是当我在函数中创建`$scope.markers`对象时遇到了同样的问题。`$http.success`我最终在函数`$scope.markers = []`之前创建了，在`$http`函数内部`.success`，我用返回数据填充了`$scope.markers`数组。

所以 $scope 对象在指令编译时被绑定，并在数据返回时更新。

[更新建议]

您是否尝试过利用`resolve`您的路线？

```
 function($routeProvider) {
    $routeProvider.
      when(
        '/',{
          templateUrl: 'main.html',
          controller: Main,
          resolve: {
               data: function(httpService){
                   return httpService.get()
               }
          }
      }).
      otherwise({redirectTo: '/'});
  } 
```

我通常将我的 $http 请求放在服务中，但您可以直接从您的路由中调用 $http：

```
App.factory('httpService'), function($http){
     return {
       get: function(){
           $http.get(url)
       }
    }
}); 
```

然后，在您的控制器中，注入`data`并将您的`$scope`项目设置为数据。

# java - 如何修复计算机选择总是选择整数 1 的岩石

> ID：14527589
> 
> 赞同：0
> 
> 时间：2013-01-25T17:55:36.637
> 
> 标签：java, swing

我正在尝试使用 Random().nextInt() 函数获取随机数。我不知道这是否正确，或者我的逻辑是否混乱或阅读不正确。此外，for 循环也没有按照预期的方式工作。你能帮忙吗？自从我们上个月开始使用 Java 以来，我一直在努力完成课堂作业。

```
//DECLARE VARIABLES
    String rounds, userChooses;
    Random computerChooses = new Random();
    int round = 1;
    int userChoice = 0;
    final int ONE = 1;
    final int TWO = 2;
    final int THREE = 3;
    int computerChoice = computerChooses.nextInt(3) + 1;

    //ASK USER FOR NUMBER OF ROUNDS
    rounds = JOptionPane.showInputDialog(null, "How many rounds do you want to play?");
    round = Integer.parseInt(rounds);

    //TRACK NUMBER OF ROUNDS
    for (int x = 1; x <= round; x++) {
        JOptionPane.showMessageDialog(null, "This is round " + x + ".");

    //CREATE THE INPUT FOR THE USER
    try {

    //START GAME
    userChooses = JOptionPane.showInputDialog(null, "Enter 1)rock, 2)paper, or 3)scissors!");
    userChoice = Integer.parseInt(userChooses);
    if (userChoice > 3 || userChoice < 1) {
        throw new Exception();
    }

    } catch (Exception ex) {
        JOptionPane.showInputDialog(null, "That wasn't a number!", "Error!", JOptionPane.ERROR_MESSAGE);
        JOptionPane.showMessageDialog(null, "You have not entered correct number! Terminating program!");
        System.exit(0);
    }
    if (userChoice == ONE) {
        if (computerChoice == ONE) {
            JOptionPane.showMessageDialog(null, "You tied the computer.\nYou chose: rock\nComputer chose: rock");
        } else if (computerChoice == TWO) {
            JOptionPane.showMessageDialog(null, "You lost!\nYou chose: rock\nComputer chose: paper");
        } else if (computerChoice == THREE){
            JOptionPane.showMessageDialog(null, "You won!\nYou chose: rock\nComputer chose: scissors");
        }
    } else if (userChoice == TWO) {
        if (computerChoice == ONE) {
            JOptionPane.showMessageDialog(null, "You won!\nYou chose: paper\nComputer chose: rock");
        } else if (userChoice == TWO) {
            JOptionPane.showMessageDialog(null, "You tied!\nYou chose: paper\nComputer chose: paper");
        } else if (userChoice == THREE) {
            JOptionPane.showMessageDialog(null, "You lost!\nYou chose: paper\nComputer chose: scissors");
        }
    } else if (userChoice == THREE) {
        if (computerChoice == ONE) {
            JOptionPane.showMessageDialog(null, "You lost!\nYou chose: scissors\nComputer chose: rock");
        } else if (computerChoice == TWO) {
            JOptionPane.showMessageDialog(null, "You won!\nYou chose: scissors\nComputer chose: paper");
        } else if (computerChoice == THREE) {
            JOptionPane.showMessageDialog(null, "You tied!\nYou chose: scissors\nComputer chose: scissors");
        }
    }
    }

} 
```

每次我选择某些东西时，它都会说计算机总是选择摇滚选项。任何的想法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-25T17:59:05.917

只需使用一个`Random`对象：

```
new Random().nextInt(3) + 1; 
```

至于你的`for`-loop，右大括号应该放在你的`catch Exception`-block 之后而不是之后：`JOptionPane.showMessageDialog(null, "This is round " + round + ".");`

这里有一些似乎效果更好的东西：

```
import java.util.Random;

import javax.swing.JOptionPane;
import javax.swing.SwingUtilities;

public class RockPaperScissors {
    private static final int ROCK = 1;
    private static final int PAPER = 2;
    private static final int SCISSORS = 3;

    private Random computerChooses = new Random();

    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {
            @Override
            public void run() {
                new RockPaperScissors().play();
            }
        });
    }

    protected void play() {
        String rounds;
        String userChooses;
        int round = 0;
        int userChoice;

        // CREATE THE INPUT FOR THE USER
        try {
            rounds = JOptionPane.showInputDialog(null, "How many rounds do you want to play?");
            round = Integer.parseInt(rounds);

            // CREATE COUNTER
            for (int x = 0; x < round; x++) {
                int computerChoice = computerChooses.nextInt(3) + 1;
                JOptionPane.showMessageDialog(null, "This is round " + x + ".");

                // START GAME
                userChooses = JOptionPane.showInputDialog(null, "Enter 1)rock, 2)paper, or 3)scissors!");
                userChoice = Integer.parseInt(userChooses);

                String message = null;
                switch (userChoice) {
                case ROCK:
                    switch (computerChoice) {
                    case ROCK:
                        message = "You tied computer. You both chose rock";
                        break;
                    case PAPER:
                        message = "You win.";
                        break;
                    case SCISSORS:
                        message = "You loose";
                        break;

                    }
                    break;
                case PAPER:
                    switch (computerChoice) {
                    case ROCK:
                        message = "You win.";
                        break;
                    case PAPER:
                        message = "You tied computer. You both chose paper";
                        break;
                    case SCISSORS:
                        message = "You loose";
                        break;

                    }
                    break;
                case SCISSORS:
                    switch (computerChoice) {
                    case ROCK:
                        message = "You loose";
                        break;
                    case PAPER:
                        message = "You win";
                        break;
                    case SCISSORS:
                        message = "You tied computer. You both chose scissors";
                        break;

                    }
                    break;

                }
                JOptionPane.showMessageDialog(null, message);
            }
        } catch (Exception ex) {
            JOptionPane.showInputDialog(null, "That wasn't a number!", "Error!", JOptionPane.ERROR_MESSAGE);
            JOptionPane.showMessageDialog(null, "You have not entered correct number! Terminating program!");
            System.exit(0);
        }
    }
} 
```

# php - Excel - 打开带有元音变音（+其他字符）的网页显示不正确

> ID：14527591
> 
> 赞同：0
> 
> 时间：2013-01-25T17:55:39.147
> 
> 标签：php, excel, translation

我们有一个德语网站，用户输入的数据包括变音符号和其他德语字符。当我们朗读一份报告时，数据会完美显示，但如果我们随后使用 mime-type 在 excel 中打开页面，它会很好地打开文件，但无法正确显示德语字符。

示例如下：

ü 显示为 ü

ö 显示为 Ã¶

我们在使用其他语言时遇到过问题，但通过在打开数据库后将其放入代码中已经解决了这些问题。

```
mysql_query( "set names 'utf8'" ) ; 
```

我们如何让 Excel 显示这些字符。

这是导致问题的代码

```
<?php ob_start(); ?>
<!DOCTYPE html PUBLIC " - //W3C//DTD XHTMKL 1.0 Strict//EN"  "http://www.w3.org/TR/xhtml1/DTD/xhtml1 -strict.dtd">

<html>
<head>
<title>Forum Report</title>
<link rel="shortcut icon" href="../templates/gk_music/favicon.ico" />

</head>
<body>

<form id="discussion" name="discussion" action="Discussion.php" method="post">

<div>
<?php

$message = $_REQUEST['signedin'] ;
if ($message != "YES")
{
header( 'Location: index.php?option=com_user&amp;view=login' ) ;
}

$ID = $_POST['ID'];
$excelselected = $_POST['excel'];
$print = $_POST['printit'];
if ($print == "yes")
{
    $excelselected  = "";
}

if ($excelselected == "excel")
{
<?php
header("Content-Type:  application/x-msexcel"); 
header("Expires: 0"); 
header("Cache-Control: must-revalidate, post-check=0, pre-check=0"); 
header("Content-Disposition: attachment; filename=discussion.xls");
?>
    header(System.Text.UTF8Encoding.Default);
}

$row_count = 0; 
$today = date("F j, Y");
$reporttitle = "Forum Report";

include("../CommCultureIncludes/DB.php");
$link = @mysql_connect($host, $username, $password);
if (! $link){
    die("couldnt connect to mysql ".mysql_error()) ;
}

@mysql_select_db( $database)
or die ("Could Not Connect To Database : ".mysql_error() );

mysql_query( "set names 'utf8'" ) ;

if ($excelselected != "excel")
{
    include("../CommCultureIncludes/ReportHeaders.php");

    if ($print == "yes")
    {
        $divoptions = "display:none";
    }

    print "<div id='divoptions'  style='".$divoptions."' >";            
    print "<select class='dropdown'  name='selectBox' id='selectBox'          onchnge='OnChange(this.form.selectBox);'>";
    print "<option value ='0' >Select Discussion</option>";

    // set up dropdown  
    $result = mysql_query("SELECT DISTINCT thread, subject FROM ".$prefix."kunena_messages WHERE parent = 0 ORDER By Subject");
    while ($data = mysql_fetch_assoc($result))
    {               
        if ($ID == $data["thread"])
        {   
            print "<option selected value =".$data['thread'].">".$data['subject']."</option>";      
        }
        else
        {

            print "<option value   =".$data['thread'].">".$data['subject']."</option>";                 
        }
    }       
    print "</select>";      

    include("../CommCultureIncludes/ReportButtons.php");

    print "<br /><br />";
    print "</div>";
}

// display the results
$SQL = "select a.name user, a.description, b.subject, b.time, c.message, d.id,  d.username from ".$prefix."kunena_categories a, ".$prefix."kunena_messages b,  ".$prefix."kunena_messages_text c, ".$prefix."users d where a.id = b.catid and b.thread = "  .$ID. " and b.userid = d.id and b.id = c.mesid and b.hold = 0 ORDER BY b.time asc" ;
$result = mysql_query( $SQL);   
$num_rows = mysql_num_rows ($result);

print "<table class='detailtable'  width='80%' cellpadding='1' cellspacing='2'  border=\"0\">\n";

while ($a_row = mysql_fetch_assoc( $result ) ) {

    if ( $User != $a_row["user"])
    {
        print "<tr class='reportheaders' nowrap valign='top'>\n";   
        print "\t<td colspan='5' >Category : ".$a_row["user"]."</td>\n";
        print "</tr><tr>";
        print "\t<td colspan='3'  class='reportheaders' >&nbsp;&nbsp;&nbsp;&nbsp;Subject : ".$a_row["subject"]."</td>\n";
        Print "</tr>\n";
        $User = $a_row["user"];

        Print "<tr class='reportheaders'  valign='top'>\n";
        print "\t<td width='20%' >&nbsp;&nbsp;&nbsp;&nbsp;Date</td>\n";
        print "\t<td width='10%' >User Name</td>\n";
        print "\t<td colspan='3' >Message</td>\n";                  

    if ($excelselected == "excel")
    {
        // print full details for excel filtering

        // select all field types 
        $SQL = "select id, name FROM ".$prefix."community_fields where id not in (1,19,20,21) ORDER BY name" ;
        $fieldtypes = mysql_query($SQL);            

        While ($b_row = mysql_fetch_assoc($fieldtypes) ) 
            {   
            print "\t<td>".$b_row["name"]."</td>\n";
            }
        }
    }
    Print "</tr>\n";

    if  ($row_count % 2 != 0) 
    {
        print "<tr align='left'  valign='top' class='reportdetailseven' nowrap>";
    }
    else
    {
        print "<tr align='left' valign='top' class='reportdetailsodd' nowrap>";
    }

    $date = date('d-M-Y',$a_row["time"] );      
    $time = date('H:i:s',$a_row["time"] + 18000);

    print "\t<td width='20%' >&nbsp;&nbsp;&nbsp;&nbsp;".$date." ".$time."</td>\n";
    print "\t<td width='10%' >".$a_row["username"]."</td>\n";
    print "\t<td colspan='3' >".$a_row["message"]."</td>\n";

    if ($excelselected == "excel")
    {
        // print full details for excel filtering

        // for each field type get field value select all field types 
        $SQL = "select id, name FROM ".$prefix."community_fields where id not in (1,19,20,21) ORDER BY name" ;
        $fieldtypes = mysql_query($SQL);

        While ($b_row = mysql_fetch_assoc($fieldtypes) ) 
            {                   
                $fieldvalues =  mysql_query("SELECT *  FROM ".$prefix."community_fields_values a, ".$prefix."users b WHERE a.field_id = '".$b_row   ["id"]."' and a.user_id = b.id AND a.user_id = ".$a_row["id"]) ;                                
                $number  = mysql_num_rows($fieldvalues);

                if ($number == '0') 
                    {
                        print "\t<td>&nbsp;</td>\n";    
                    }
                    else
                    {
                        While ($c_row = mysql_fetch_assoc($fieldvalues) ) 
                        {
                        print "\t<td>".$c_row["value"]."</td>\n";   
                        }
                    }
            }           
    }

    Print "</tr>\n";

    $row_count++; 
}
print"</table>\n";

include("../CommCultureIncludes/HiddenFields.php");

mysql_close( $link );

?>

</div>

</form>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-10-13T09:45:37.667

我们需要页面部分中的以下元标记`<head>`。

```
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/> 
```

富有的

# c# - 以最优化的方式交叉两个集合

> ID：14527595
> 
> 赞同：28
> 
> 时间：2013-01-25T17:55:46.163
> 
> 标签：c#, performance, set

给定两组值，我必须找出它们之间是否有任何共同元素，即它们的交集是否为空。

哪个标准 C# 集合最适合此目的（就性能而言）？我知道`linq`有一个`Intersect`扩展方法来找出两个列表/数组的交集，但我的重点是`Big-O notation`.

如果我还必须找出两组的交集呢？

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2013-01-25T17:57:59.070

好吧，如果您使用 LINQ 的`Intersect`方法，它将构建`HashSet`第二个序列的一个，然后对照它检查第一个序列的每个元素。所以它是 O(M+N)... 你可以用它`foo.Intersect(bar).Any()`来提前退出。

当然，如果您将一个（任何一个）集合存储在 a`HashSet<T>`中，您可以只遍历另一个集合，检查每个步骤的包含情况。不过，您仍然需要先构建集合。

从根本上说，无论你做什么，你都会遇到 O(M+N) 问题——你不会得到比这更便宜的（*总是*有可能你必须查看每个元素），如果你的哈希码是合理的，您应该能够轻松实现这种复杂性。当然，某些解决方案可能比其他解决方案提供更好的常数因子......但这是性能而不是复杂性；）

编辑：如评论中所述，还有[`ISet<T>.Overlaps`](http://msdn.microsoft.com/en-us/library/dd412095%28v=vs.110%29.aspx)- 如果您已经设置了静态类型`ISet<T>`或具体实现，调用`Overlaps`可以更清楚地说明您在做什么。如果您的*两个*集合都静态类型为`ISet<T>`，请使用`larger.Overlaps(smaller)`（根据集合的大小，较大和较小），因为我希望实现`Overlaps`迭代*参数*并根据您调用的集合的内容检查每个元素它在。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2017-03-14T11:51:29.130

如前所述，应用`Any()`会给你一些性能。

我在相当大的数据集上对其进行了测试，它提高了 25%。

同样应用`larger.Intersect(smaller)`而不是相反非常重要，在我的情况下，它提供了 35% 的改进。

在应用 intersect 之前对列表进行排序也得到了另外 7-8%。

要记住的另一件事是，根据用例，您可以完全避免应用相交。

例如，对于整数列表，如果最大值和最小值不在同一个边界内，则不需要应用 intersect 因为它们永远不会。

对于第一个字母具有相同想法的字符串列表也是如此。

再次根据您的情况，尽可能多地尝试找到无法避免调用交集的规则。

# c++ - =* 是什么意思？（温索克 - C++）

> ID：14527599
> 
> 赞同：0
> 
> 时间：2013-01-25T17:55:55.450
> 
> 标签：c++, winsock, operator-keyword

我正在了解 Winsock 并正在查看页面中的代码： [Winsock 教程 1](http://www.win32developer.com/tutorial/winsock/winsock_tutorial_1.shtm)。

程序中有一行包含运算符 =*。谁能告诉我这是什么？我知道 a *= b 等价于 a = a * b。我在stackoverflow上读到=+是+=的过时形式。所以我尝试交换 * 和 = 使其成为 *=，但编译器给了我一个错误。如果有人告诉我这行代码的含义，我将不胜感激：

```
SockAddr.sin_addr.s_addr=*((unsigned long*)host->h_addr); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-25T17:57:18.187

这意味着取消引用某些内容并将其分配给 LHS。

```
SomeType LHS;
SomeType* Something = ....;
LHS = *(Something); 
```

请参阅[取消引用运算符](http://en.wikipedia.org/wiki/Dereference_operator)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-25T18:06:55.913

Operator `=*` existed in nascent versions of C language (as the original form of `*=` operator).

In C++ there's no such operator. `=*` is nothing else than `=` (assignment operator) followed by unary `*` (dereference operator). You can look up the meaning of `=` and unary `*` in your favorite C++ book.

# sql - 如何将 TDateTime 实现为 SQL Server 的参数

> ID：14527600
> 
> 赞同：-4
> 
> 时间：2013-01-25T17:56:02.113
> 
> 标签：sql, sql-server, delphi, delphi-2007

我承认我没有直接在 Delphi 中使用 SQL 的经验。但我现在尝试了一个小项目。它执行这个 SQL

```
SELECT [Type], [Sum] = Count(*) 
FROM   exceptionrow 
WHERE LogDate >= :FromDate
AND LOGDATE <= :ToDate
GROUP  BY [type] 
ORDER  BY [sum] DESC 
```

其中 FromDate 和 ToDate 的参数为 TDateTime。这是要执行的事件。

```
procedure TLogsStats.CollectTopExceptions(aFromDate, aToDate: TDateTime);
begin
  qryTopExceptions.ParamByName('FromDate').AsDate := aFromDate;
  qryTopExceptions.ParamByName('ToDate').AsDate   := aToDate;

  cdsTopExceptions.Close;
  cdsTopExceptions.Open;
end; 
```

我确实在 DBGrid 中得到了结果，但与直接在 SQL Studio 中使用静态日期运行时不同。行数太少。[我从这个项目](http://cc.embarcadero.com/item/27414)复制了设置。我认为运行一个 sql 查询需要 5 个组件很奇怪。见图片。

![SQL 查询](../Images/db279b20f8a777e5649dbc223d898200.png)

可以简化吗？这是我对组件的声明。

```
SQLConnection: TSQLConnection;
qryTopExceptions: TSQLDataSet;
dspTopExceptions: TDataSetProvider;
cdsTopExceptions: TClientDataSet;
dsTopExceptions: TDataSource; 
```

**编辑：** 最后我找到了它不起作用的原因。我怀疑有故障的驱动程序等，但这是一个简单的愚蠢错误。我连接到一个小型测试数据库而不是更大的数据库。现在它适用于 3 个组件和参数。抱歉耽误您的时间:)

```
SQLConnection: TSQLConnection;
qryTopExceptions: TSQLDataSet;
dsTopExceptions: TDataSource; 
```

问候

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-25T22:10:01.457

# 简短回答：不，您不需要 5 个组件

从 Delphi 对数据库运行查询通常涉及两个组件：

*   连接组件，负责建立数据库连接，以及
*   一个支持查询的组件，负责*运行*查询并获取结果。

一些数据层允许您直接使用具有查询功能的组件而无需显式连接组件，但连接组件始终是在幕后创建的。其中之一是 ADO。

因此，如果您使用 ADO，您只需`TADOQuery`在您的 Form/DataModule 中放置一个并针对支持的数据库（例如 SQL Server）执行您的选择（或任何其他）查询。

为了做到这一点，你设置了`ConnectionString`和`ADOQuery`的`SQL`属性，然后你`Open`的查询和数据就在那里。

# 更多信息

**数据访问**

您还可以在不同的可用数据访问权限之间进行选择。有些支持连接到多个数据库，如 DBGo (ADO) 和 DBExpress (DBX)，还有一些支持连接到一个数据库，如 Interbase Express (IBX) 和 Direct Oracle Access (DOA) 等。

如您所见，可用的不同选项为您提供了一组不同的功能和独特的特性。

**那么，为什么要使用 5 个组件呢？**

好吧，您可能正在研究其他人编写的应用程序，或者正在学习教程。

使用这些组件是因为它们添加了更高级和复杂的数据访问功能。

*   TClientDataSet/TDataSetProvider：TClientDataSet 允许您在完全可导航的数据集中拥有数据的内存副本，这也可以在与数据库断开连接的情况下工作，甚至可以将数据与修改一起存储到磁盘或从磁盘检索数据（ delta) 对其进行修改，然后再应用该更改（甚至几天或几个月后）。

    您还可以对数据进行排序、创建内存索引、计算聚合等。

    TDataSetProvider 是源数据集（例如 TSQLQuery）和 TClientDataSet 之间的粘合剂，它使您能够在不进行任何编码的情况下连接两者，从源数据集中提取数据，还可以在晚点。

    如果您想了解更多关于 TClientDataSets 和 TDataSetProviders 的信息，请查看[Cary Jensen 的 ClientDataSets 书](http://www.jensendatasystems.com/cdsbook/)

*   TDataSource：这是 Delphi 数据库架构的一部分，它允许您使用*数据感知*组件，如 TDBEdit、TDBGrid、TDBLabel 等。数据源也用于创建主/从关系。如果您不想使用该组件或关系，则不需要它。

# android - 为android应用程序创建定时通知

> ID：14527603
> 
> 赞同：0
> 
> 时间：2013-01-25T17:56:22.683
> 
> 标签：android, notifications

我在使用 eclipse 创建 android 应用程序方面相对较新。我的问题是我无法创建定时通知。目前，我在[http://www.vogella.com/articles/AndroidNotifications/article.html的帮助下创建了一个使用按钮创建通知的功能](http://www.vogella.com/articles/AndroidNotifications/article.html)

现在我想使用代码中设置的计时器而不是使用按钮。请帮忙！这是我的按钮激活通知代码。

```
 import android.app.Activity;
     import android.app.Notification;
     import android.app.NotificationManager;
     import android.app.PendingIntent;
     import android.content.Intent;
     import android.os.Bundle;
     import android.view.View;

     public class MainActivity extends Activity {

          @Override
          public void onCreate(Bundle savedInstanceState) {
            super.onCreate(savedInstanceState);
            setContentView(R.layout.activity_main);
          }

          public void createNotification(View view) {
            // Prepare intent which is triggered if the
            // notification is selected
            Intent intent = new Intent(this, MainActivity.class);
            PendingIntent pIntent = PendingIntent.getActivity(this, 0, intent, 0);

            // Build notification
            // Actions are just fake
            Notification noti = new Notification.Builder(this)
                .setContentTitle("Medication")
                .setContentText("Subject").setSmallIcon(R.drawable.original)
                .setContentIntent(pIntent)
               .build();
            NotificationManager notificationManager = (NotificationManager) getSystemService(NOTIFICATION_SERVICE);
            // Hide the notification after its selected
            noti.flags |= Notification.FLAG_AUTO_CANCEL;

            notificationManager.notify(0, noti);

             Intent myIntent = new Intent(this , MainActivty.class);     
       AlarmManager alarmManager = (AlarmManager)getSystemService(ALARM_SERVICE);
       PendingIntent pIntent2 = PendingIntent.getService(ThisApp.this, 0, myIntent, 0);

       Calendar calendar = Calendar.getInstance();
           calendar.set(Calendar.HOUR_OF_DAY, 12);
       calendar.set(Calendar.MINUTE, 00);
       calendar.set(Calendar.SECOND, 00);

      alarmManager.setRepeating(AlarmManager.RTC_WAKEUP, calendar.getTimeInMillis(), 24*60*60*1000 , pIntent2);  //set repeating every 24 hours

          }
        } 
```

main_layout.xml

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" >

    <Button
        android:id="@+id/button1"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:onClick="createNotification"
        android:text="Create Notification" >
    </Button>

</LinearLayout> 
```

创建了以下 result.xml 布局文件。

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent" >

    <TextView
        android:id="@+id/textView1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="This is the result activity opened from the notification" >
    </TextView>

</LinearLayout> 
```

我找到了一种使用警报管理器[将通知设置到特定时间](https://stackoverflow.com/questions/8281075/set-notification-to-specific-time)的方法，我将此代码添加到我的代码中，以便它每天中午重复，但它似乎不起作用。

```
Intent myIntent = new Intent(this , MainActivty.class);     
       AlarmManager alarmManager = (AlarmManager)getSystemService(ALARM_SERVICE);
       PendingIntent pIntent2 = PendingIntent.getService(ThisApp.this, 0, myIntent, 0);

       Calendar calendar = Calendar.getInstance();
           calendar.set(Calendar.HOUR_OF_DAY, 12);
       calendar.set(Calendar.MINUTE, 00);
       calendar.set(Calendar.SECOND, 00);

      alarmManager.setRepeating(AlarmManager.RTC_WAKEUP, calendar.getTimeInMillis(), 24*60*60*1000 , pIntent2);  //set repeating every 24 hours 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-01-25T18:04:04.787

你想调查一下[`AlarmManager`](http://developer.android.com/reference/android/app/AlarmManager.html)。把它想象成你的 android 应用程序的 unix cron。简而言之，您计划`Intent`在将来触发。然后你写一个`BroadcastReceiver`来处理意图，并在这里做任何你想做的事情。

当然，魔鬼在细节中。密切注意诸如将任何耗时的工作从广播接收器卸载到线程，并确保您事先抓住唤醒锁。这些是 SO 答案中无法正确涵盖的高级主题。

# c++ - mpi 行列式，代码：11 分段错误

> ID：14527605
> 
> 赞同：1
> 
> 时间：2013-01-25T17:56:27.493
> 
> 标签：c++, mpi

我是 mpi 的新手，我想用 C++ 编写一个程序来计算矩阵的行列式，并且在开始尝试编写它时，在尝试使用 mpi 编译器进行编译时出现此错误。

```
#include "mpi.h"
#include <iostream>
#include <stdio.h>
#include "/usr/include/malloc.h"

using namespace std;

int matrix[3][3] =  {{1,2,3},
                     {4,5,6},
                     {7,8,9}};

//**************

int** MakeMatrix (int** oldMatrix,int I,int J,int m,int n)
{
 int** newMatrix = (int**)malloc(sizeof(int*)*J);
 for(int i=0;i<J;i++)
 {
  newMatrix[i] = (int*)malloc(sizeof(int)*I);
 }
 for(int i=0;i<I-1;i++)
  for(int j=0;j<J-1;j++)
   if(i>=m)
    if(j>=n)
    {
     newMatrix[i][j]=oldMatrix[i+1][j+1];
    }
    else
    {
     newMatrix[i][j]=oldMatrix[i+1][j];
    }
   else
   {
    newMatrix[i][j]=oldMatrix[i][j];
   }
 return newMatrix;
}

 ///////////////////////

int determinan (int** lmatrix,int I,int J)
{
 if(I*J==1)
 {
  return lmatrix[I-1][J-1];
 }

 int minus = -1;
 int sum = 0;
 for(int j=0;j<J-1;j++)
 {
  for(int k=1;k<I+j+1;k++,minus*=minus);
  sum += minus*lmatrix[0][j]*determinan(MakeMatrix(lmatrix,I,J,0,j),I-1,J-1);
 }

 return sum;
}

///*************

int main(int argc,char **argv)
{
 //MPI_Init(&argc,&argv);
 cout<<determinan((int**)matrix,3,3)<<'\n';
 //MPI_Finalize();
 return 0;
} 
```

这是错误消息：

```
===================================================================================
=   BAD TERMINATION OF ONE OF YOUR APPLICATION PROCESSES
=   EXIT CODE: 11
=   CLEANING UP REMAINING PROCESSES
=   YOU CAN IGNORE THE BELOW CLEANUP MESSAGES
===================================================================================
YOUR APPLICATION TERMINATED WITH THE EXIT STRING: Segmentation fault (signal 11)
This typically refers to a problem with your application.
Please see the FAQ page for debugging suggestions 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T18:00:55.463

我确信有多个问题。直接的一个是类型转换：

```
cout<<determinan((int**)matrix,3,3)<<'\n';
                 ^^^^^^^ 
```

这不是有效的强制转换，因为`matrix`它不是指针数组。

# java - 通过套接字从服务器到客户端的图像

> ID：14527607
> 
> 赞同：0
> 
> 时间：2013-01-25T17:56:45.340
> 
> 标签：java, image, sockets

我已经尝试了几种我在互联网上找到的关于如何通过套接字发送多个图像的解决方案，但我无法让它按我想要的方式工作。我有以下设置：

客户：

1.  一个线程拍摄我的屏幕快照并将它们放入队列
2.  多个线程从队列中读取并通过套接字将图像发送到服务器

服务器：

1.  允许多个连接并接收图像并将它们放入队列的套接字服务器
2.  读取队列并将图像写入 JPanel 的线程

我的问题是我很难通过套接字发送图像，例如。保持打开的套接字并仅流式传输图像。我尝试了不同的解决方案，但只发送了第一张图片。如果有人可以分享一些关于如何将多个图像从一个线程写入另一个线程的代码，我将不胜感激。

## 编辑

感觉每张图片都没有刷新？我现在创建 1 个线程以使用打开的连接发送：

```
while(true)
{
  BufferedImage imageQItem = (BufferedImage) queue.dequeue();
  ImageIO.write(imageQItem,"jpg",out);//out is a dataoutputstream
} 
```

然后我读进去（我的套接字服务器为上述客户端的连接创建了一个新线程）

```
while(true)
{
  System.out.println("Reading");
  BufferedImage image = ImageIO.read(in);
  viewer.setBufferedImage(image);
  viewer.repaint();
} 
```

所发生的只是它一直在打印阅读。我似乎没有结束每张图片。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T20:46:23.163

以 .jpg 格式发送（和接收）每个图像`byte[]`，最好使用压缩图像的文件格式，例如 .jpg。不要忘记`flush()`图像之间的流。并确保在尝试读取下一个图像之前读取图像的所有字节。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T20:31:49.403

通过网络发送图像非常困难。原因是文件太大了，如果不先压缩它们，几乎不可能发送它们。试试这个链接，它可能会对你有所帮助，因为没有你的代码我无能为力。[如何在java中通过套接字发送图像数据类型](https://stackoverflow.com/questions/8427675/how-to-send-image-data-type-via-socket-in-java?rq=1)希望对您有所帮助！

# php - 使用 PHP 和 AJAX 插入的问题

> ID：14527610
> 
> 赞同：1
> 
> 时间：2013-01-25T17:56:53.137
> 
> 标签：php, mysql, ajax

我正在运行一个 AJAX 调用，它将一些变量传递给一个 PHP 脚本，该脚本应该是`INSERT`一个表。出于我不知道的原因，不是吗。

**AJAX 调用获得了成功，所以大概是那里的问题。**

```
$('#rate_button').click(function(){
var varate = $('#u_varate').val(),
    fharate = $('#u_fharate').val(),
    usdarate = $('#u_usdarate').val(),
    conv15rate = $('#u_conv15rate').val(),
    conv5rate = $('#u_conv5rate').val(),
    conv20rate = $('#u_conv20rate').val();

$('#varate').val(varate);
$('#fharate').val(fharate);
$('#usdarate').val(usdarate);
$('#conv15rate').val(conv15rate);
$('#conv5rate').val(conv5rate);
$('#conv20rate').val(conv20rate);
var rates = $('#rates').serialize();
    rurl = 'http://www.nexthometown.com/components/com_singleprop/views/singleprop/tmpl/scripts/rates.php?' + rates;

$.ajax({
    url: rurl,
    success: function(){
       $('#success').fadeIn(500).delay(500).fadeOut(500); 
    },
    error: function(){
        alert('Oopsy!');
    }
});
}); 
```

**AJAX 函数调用的 PHP 脚本。我没有收到`error`来自 AJAX 的回调，所以我想这运行正常吗？**

```
<?php
$link = mysql_connect('localhost','user','pass');

$varate = $_GET['varate'];
$fharate = $_GET['fharate'];
$usdarate = $_GET['usdarate'];
$conv15rate = $_GET['conv15rate'];
$conv5rate = $_GET['conv5rate'];
$conv20rate =  $_GET['conv20rate'];

$query = "INSERT INTO singleprop.jos_rates(varate, fharate, usdarate, convfifteen, convfive, convtwenty)VALUES('" . $varate . "', '" . $fharate . "', '" . $usdarate ."', '" . $conv15rate . "', '" . $conv20rate . "');";

$result = mysql_query($query);

mysql_close($link);
?> 
```

此外，当我在浏览器中运行脚本本身并将其`echo`作为变量时，一切都运行良好。

当我复制`INSERT`参数但它在具有适当值的 CMD 中时，它工作正常。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-25T17:59:35.727

问题是您的 sql 有 6 个字段，但只给出了 5 个值。你失踪了`$conv5rate`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T18:03:47.833

这对我来说似乎是个问题：

```
$query = "INSERT INTO singleprop.jos_rates(varate, fharate, usdarate, convfifteen, convfive, convtwenty)VALUES('" . $varate . "', '" . $fharate . "', '" . $usdarate ."', '" . $conv15rate . "', '" . $conv20rate . "');"; 
```

您指定 6 列，但只给它 5 个值。我相信这是插入的 SQL 语法错误。看起来您缺少 $conv5rate 条目。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-25T18:14:14.350

在[此处查看](http://api.jquery.com/jQuery.ajax/)`data`传递给 ajax 的设置对象的属性。如果你使用它，你可以让你的 JS 代码更简单：

```
$('#rate_button').click(function(){
 var data = {varate:$('#u_varate').val(),
            fharate:$('#u_fharate').val(),
            usdarate:$('#u_usdarate').val(),
            conv15rate:$('#u_conv15rate').val(),
            conv5rate:$('#u_conv5rate').val(),
            conv20rate:$('#u_conv20rate').val()
           };

    rurl = 'http://www.nexthometown.com/components/com_singleprop/views/singleprop/tmpl/scripts/rates.php';

$.ajax({
    url: rurl,
    type:'GET',
    data:data,
    success: function(){
       $('#success').fadeIn(500).delay(500).fadeOut(500); 
    },
    error: function(){
        alert('Oopsy!');
    }
});
}); 
```

此外，当您进行 sql 查询时，您应该清理传递给它的变量。否则，您的代码将被打开以进行 sql 注入。你至少可以这样做：

```
$query = "INSERT INTO singleprop.jos_rates(varate, fharate, usdarate, convfifteen, convfive, convtwenty)VALUES('" . mysql_real_escape_string($varate) . "', '" . mysql_real_escape_string($fharate) . "', '" . mysql_real_escape_string($usdarate) ."', '" . mysql_real_escape_string($conv15rate) . "', '" . mysql_real_escape_string($conv5rate) . "', '" . mysql_real_escape_string($conv20rate) . "');"; 
```

以下是有关该功能的更多信息：http: [//php.net/manual/en/function.mysql-real-escape-string.php](http://php.net/manual/en/function.mysql-real-escape-string.php)

此外，为了将来，建议使用 PDO，因为不推荐使用 mysql 扩展并将被删除。

# c# - 我可以发布私有 NuGet 包吗？

> ID：14527615
> 
> 赞同：123
> 
> 时间：2013-01-25T17:57:13.000
> 
> 标签：c#, vb.net, visual-studio, nuget

我制作了一个非常适合我公司团队的组件。我希望能够使用 NuGet 使该程序集可用于我的团队和我公司的类似团队正在从事的其他项目。但是，程序集并不是我想与世界分享的真正代码。

我知道使用 Maven，您可以从本地存储库创建本地存储库和源包。NuGet 是否支持类似的功能？NuGet 有没有办法指定本地存储库或拥有私有包？

* * *

## 回答 #1

> 赞同：101
> 
> 时间：2013-01-25T17:59:10.877

是的！您可以托管自己的 NuGet 服务器！

最简单的方法是在您的服务器上创建一个共享文件夹并将其引用为您的 Nuget 服务器。

您可以在以下位置找到有关如何执行此操作的更多信息：[托管您自己的 NuGet 源](https://docs.microsoft.com/en-us/nuget/hosting-packages/overview)

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2013-01-25T18:27:34.157

托管您自己的 NuGet 服务器的另一个选项是使用 JetBrains TeamCity 作为构建服务器。[此处](http://blogs.jetbrains.com/teamcity/2011/12/01/setting-up-teamcity-as-a-native-nuget-server/)描述了设置。

Team City 服务器充当 NuGet 存储库，将/可以/应该只能在您的公司内部访问。

根据您的使用情况，该软件有免费版本。

它有一些不错的选项，例如能够按需发布新的 NuGet 版本，每次新的持续集成构建等。最有用的部分之一（与所有 NuGet 服务器实现一样）是它将保留数十个旧版本你的程序集，所以如果你有一个项目需要引用最新版本，而另一个项目需要引用旧版本，一切都会好起来的。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2013-01-25T22:52:28.447

查看[ProGet 免费版](http://inedo.com/proget)；我们正是为此目的而建造的。设置所需的时间要少得多，并且提供了许多超出标准 NuGet 服务器提供的功能，例如多个提要、提要聚合和其他存储库类型（npm、Bower 等）

如果您想为企业版付费，您还可以获得使用 LDAP 进行身份验证的能力，以及从连接的源（即 NuGet 的官方源）中按名称/许可证过滤源的能力。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2018-03-22T16:22:52.563

是的，您可以拥有本地提要。设置非常简单，[看看这里](https://docs.microsoft.com/en-us/nuget/hosting-packages/local-feeds)。

[MyGet](https://www.myget.org/)在托管私人提要方面很受欢迎。它不是免费的，但看看[他们的定价](https://www.myget.org/pricing)，也许它很适合你！

# python - 在 python 中自动化整个应用程序输出测试

> ID：14527618
> 
> 赞同：1
> 
> 时间：2013-01-25T17:57:13.977
> 
> 标签：python, automated-tests, integration-testing

我有一个脚本，它获取文件输入和一些信息，使用 subprocess 模块在其上运行几个（可能相互依赖的）程序，并将输出分发到文件系统上。

传统的单元测试只能单独测试少数部分，所以我正在寻找一种方便的方法来自动化集成测试（查看输出文件是否存在于正确的位置、正确的数量、正确的大小， ETC）。

我最初认为默认 unittest 模块中`setUp`的`tearDown`方法可以帮助我，但是每次测试都会重新运行它们，而不是整个测试套件一次，所以它不是一个选项。有什么方法可以让 unittest 模块全局运行`setUp`一次`tearDown`？或者我可以使用的替代模块/工具？Eclipse/PyDev 集成将是一个奖励。

# entity-framework - 获取最大记录，而不是使用 LINQ 分组的值

> ID：14527619
> 
> 赞同：-1
> 
> 时间：2013-01-25T17:57:16.423
> 
> 标签：entity-framework, linq-to-entities

我已经看到分组示例以获取总和或其他聚合函数输出，但我一直在尝试获取与分组标准匹配的“记录”，我不需要聚合值。先说明一下我的情况：

我使用 LINQ to EF，我有一个表，Entity_Revisions 列 Entity_Id、Entity_Revision_Number 和许多其他列。Entity_Revision_Number 就像实体的一个版本。所以我想要一个 LINQ 查询来给我最新版本。以下是数据类型：

```
 Entity_Id Entity_Revision_Number
 1         0
 1         1
 2         0
 3         0
 3         1 
```

我需要一个返回记录 1,1 2,0 和 3,1 的查询。我需要的查询是

```
from e in ENTITY_REVISIONs
<some joins>
<some where>
group e by e.ENTITY_ID into g
select g <where max(g.entity_revision_number)> 
```

是否可以将 ENTITY_REVISIONs 类型作为输出而不是以新{} 匿名类型的形式？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-26T20:44:58.770

按 id 分组，按修订号降序排列每个组，并获得每个组的第一个值应该没问题：

```
var query = from e in ENTITY_REVISIONs
            group e by e.ENTITY_ID into grp
            select grp.OrderByDescending(x => x.entity_revision_number).First(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T18:09:54.217

我想你正在寻找这个：

```
var query = 
 from e in ENTITY_REVISIONs
 group e by e.ENTITY_ID into g
 select new {
   Entity_Id = g.Key,
   Entity_Revision_number = (from e in ENTITY_REVISIONs
                             where e.ENTITY_ID == g.Key
                             select e.entity_revision_number).Max()
 }; 
```

# web-services - 如何通过我的应用程序在 UCM 上进行身份验证？

> ID：14527624
> 
> 赞同：0
> 
> 时间：2013-01-25T17:57:24.687
> 
> 标签：web-services, authentication, ldap, authorization, oracle-ucm

我需要调用需要身份验证的 UCM（Oracle WebCenter Content）Web 服务。我的应用程序使用与 UCM 相同的用户（我正在使用 LDAP），但我不知道他们的密码（它们以加密状态存储在 LDAP 中），因此我无法使用他们的凭据在 UCM 上进行身份验证。我该如何解决我的问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-07T03:25:19.763

您不提供 UCM 的版本或您正在运行的应用服务器。当前的 Oracle UCM 产品（现在称为 WebCenterContent，11.1.1.8）在 App Server 的域内运行。我建议您查看如何在应用服务器中调用将使用其身份验证提供程序的 Web 服务。UCM 不进行自己的身份验证。它由应用服务器完成。在此处阅读有关 Web 服务安全性的信息可能会[有所帮助](http://www.javaworld.com/javaworld/jw-03-2003/jw-0321-wssecurity.html?page=2)

# jquery - 如何动态添加选项以选择元素而无需在 IE 中再次单击

> ID：14527642
> 
> 赞同：1
> 
> 时间：2013-01-25T17:58:44.730
> 
> 标签：jquery, internet-explorer

将文本添加到输入框时，我正在使用 jQuery 向选择元素添加选项。

在 FireFox 和 Chrome 中，一旦添加文本，选择就会更新，单击选择一次会按预期显示新选项。在 IE 中，默认选项会在您键入时立即显示，但第一次单击时不会显示其他选项。在第二次单击选择时，会显示新选项。

如何让 IE 像 Chrome 和 FF 一样立即更新？

```
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js"></script>
<script type="text/javascript">
    $(document).ready(function () {
        $(document).on('paste mouseup keyup change', 'input', function () {
            updateOptions();
        });

        function updateOptions() {
            setTimeout(function () {
                if ($('input').val().length > 0) {
                    newOptions = '<option>' + $('input').val() + '</option><option>A</option><option>B</option><option>C</option>';
                } else {
                    newOptions = '<option></option>'
                }
                $('select').empty().append(newOptions);
            }, 0);
        }
    });
</script>
<input type="text"/>
<select>
    <option>before</option>
</select> 
```

超时用于粘贴事件。示例可以在[http://jsfiddle.net/c7G6L/4/看到](http://jsfiddle.net/c7G6L/4/)

我尝试了几个 SO 解决方案： DIV swap from [JQuery - 动态选择和选项在 IE9 中不起作用，](https://stackoverflow.com/questions/10583316/jquery-dynamic-selects-and-options-not-working-in-ie9)但这似乎给 FireFox 带来了问题。

从添加选项重绘选择[以选择焦点 IE9](https://stackoverflow.com/questions/8979937/adding-options-to-select-on-focus-ie9)没有区别

使用 jQuery html 和 append 而不是 innerHTML[为什么 JQuery 不改变 IE 中的选择选项？](https://stackoverflow.com/questions/11512326/why-doesnt-jquery-change-select-options-in-ie)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-30T23:07:16.280

问题是事件处理程序正在监视粘贴、鼠标操作、键操作和更改。不知何故使IE感到困惑。从列表中删除“更改”解决了这个问题。无论如何，在这种情况下改变是多余的。

```
$(document).on('paste mouseup keyup', 'input', function () {
    updateOptions();
}); 
```

# sql - 将 IN 和 UNION 转换为更有效的东西（可能存在）

> ID：14527647
> 
> 赞同：0
> 
> 时间：2013-01-25T17:59:02.497
> 
> 标签：sql, sql-server, tsql

```
SELECT * 
FROM   sec 
WHERE  sec.cu IN (SELECT s.cu 
                  FROM   sec s WITH (nolock) 
                  WHERE  EXISTS (SELECT * 
                                 FROM   hact h WITH ( nolock), 
                                 JOIN   dport p WITH ( nolock) ON h.ic = p.ic
                                 WHERE  s.cu = h.cu )

                  UNION 
                  SELECT s.cu 
                  FROM   sec s WITH (nolock) 
                  WHERE  EXISTS(SELECT * 
                                FROM   schanges c WITH ( nolock) 
                                WHERE  s.cu = c.cu) 
                  UNION 
                  SELECT s.cu 
                  FROM   sec s WITH (nolock) 
                  WHERE  s.cu IN (SELECT DISTINCT cu 
                                  FROM   suk WITH (nolock))) 
       AND EXISTS (SELECT * 
                   FROM   hact h WITH (nolock) 
                          JOIN port p WITH (nolock) 
                            ON h.ic = p.ic 
                   WHERE  sec.cu = h.cu 
                          AND p.ptype = 'X') 
```

嗨，我有这个查询，我正在尝试优化。我试图将其转换为删除联合和 In 以更具可读性但失败了。我正在努力提高效率，可能只使用 EXISTS 和 NOT EXISTS。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T18:18:44.397

我认为你可以用这种方式重写你的嵌套/存在：

```
SELECT * 
FROM sec 
WHERE sec.cu IN (
  SELECT s.cu 
  FROM sec s 
  INNER JOIN hact h ON s.cu = h.cu, 
  INNER JOIN dport p ON h.ic = p.ic

  UNION ALL

  SELECT s.cu
  FROM sec s
  INNER JOIN schanges c ON s.cu = c.cu) 

  UNION ALL

  SELECT s.cu 
  FROM sec s 
  INNER JOIN suk k ON k.cu = s.cu
  INNER JOIN hact h ON s.cu = h.cu
  INNER JOIN port p ON h.ic = p.ic AND p.ptype = 'X'
) 
```

甚至`sec`完全从子查询中删除表：

```
SELECT * 
FROM sec 
WHERE sec.cu IN (
  SELECT h.cu 
  FROM hact h
  INNER JOIN dport p ON h.ic = p.ic

  UNION ALL

  SELECT cu
  FROM schanges

  UNION ALL

  SELECT k.cu 
  FROM suk k
  INNER JOIN hact h ON s.cu = h.cu
  INNER JOIN port p ON h.ic = p.ic AND p.ptype = 'X'
) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-25T18:15:39.260

这是一个功能相同的简化版本：

```
SELECT s.*
FROM   sec s WITH (nolock) 
WHERE (
  EXISTS (
    SELECT * 
    FROM   hact h WITH ( nolock)
    JOIN   dport p WITH ( nolock) 
      ON h.ic = p.ic
    WHERE  s.cu = h.cu 
  ) OR EXISTS (
    SELECT * 
    FROM   schanges c WITH ( nolock)
    WHERE  s.cu = c.cu
  ) OR EXISTS (
    SELECT *
    FROM   suk WITH (nolock)
    WHERE  s.cu = suk.cu
  )
) AND EXISTS (
  SELECT * 
  FROM   hact h WITH (nolock) 
  JOIN port p WITH (nolock) 
    ON h.ic = p.ic 
  WHERE  
    s.cu = h.cu 
    AND p.ptype = 'X'
) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-25T18:18:25.200

只需将您的 UNION 子句更改为 UNION ALL。仅此一项就应该对一些人有所帮助。

为了能够在不让我们盲目猜测的情况下为您提供更多帮助，您必须向我们提供表、键和索引定义以及查询计划。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-25T18:12:50.593

未经测试，但我认为您可以使用连接来做到这一点

```
select distinct s.*
from   sec s with (nolock)
join   hatch h1 with (nolock)
  on   h1.cu = s.cu
       join  port p1 WITH (nolock) 
         ON  h1.ic = p1.ic
        AND  p1.ptype = 'X'
left join hact h2 WITH ( nolock)
  on   h2.cu = s.cu
       join  port p2 WITH (nolock) 
         ON  h2.ic = p2.ic
left join  schanges c WITH ( nolock) 
  on   s.cu = c.cu 
left join  suc WITH ( nolock) 
  on   s.cu = suc.cu 
where h2.cu  is not null
   or c.cu   is not null
   or suc.cu is not null 
```

union intersect 可能更快取决于查询优化器的智能程度

```
(   
    select s.*
    from   sec s with (nolock)
    join hact h2 WITH (nolock)
      on   h2.cu = s.cu
           join  port p2 WITH (nolock) 
             ON  h2.ic = p2.ic
  union
    select s.*
    from   sec s with (nolock)
    join  schanges c WITH ( nolock) 
      on   s.cu = c.cu 
  union
    select s.*
    from   sec s with (nolock)
    left join  suc WITH ( nolock) 
      on   s.cu = suc.cu
)
  intersect
    select s.*
    from   sec s with (nolock)
    join   hatch h1 with (nolock)
      on   h1.cu = s.cu
           join  port p1 WITH (nolock) 
             ON  h1.ic = p1.ic
            AND  p1.ptype = 'X' 
```

如果是这样，我已经看到优化器在那些二级连接上变得愚蠢

```
select s.*
from   sec s with (nolock)
join hact h1 WITH (nolock)
  on h1.cu = s.cu
  where h1.ic in (select ic from where ptype = 'X') 
```

请参阅我对死锁和 with (nolock) 的评论。
我不考虑使用（nolock）kludge并经常使用它。
如果您看到很多死锁，那么您需要查看它。

索引 cu、ic 和 ptype。
然后测试不同版本的查询，看看执行计划。
这是查询优化器可能遇到问题的查询类型。
查询优化器基于统计数据，甚至可以更改执行计划。
您可能需要包含连接的表提示。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-25T18:14:09.887

我在想：（未经测试，希望保持功能等效）

```
SELECT DISTINCT s.*
FROM   sec s
JOIN hact h WITH (nolock)
  ON s.cu = h.cu
LEFT JOIN dport p WITH (nolock)
  ON h.ic = p.ic
LEFT JOIN schanges c WITH (nolock)
  ON s.cu = c.cu
LEFT JOIN suk WITH (nolock)
  ON suk.cu = s.cu
JOIN port p2 WITH (nolock)
  ON h.ic = p2.ic 
WHERE p2.ptype = 'X' AND
  (p.ic IS NOT NULL OR c.cu IS NOT NULL OR suk.cu IS NOT NULL) 
```

**编辑：**添加了 DISTINCT

# css - MonoTouch Pixate UITableViewCell 样式设置

> ID：14527651
> 
> 赞同：0
> 
> 时间：2013-01-25T17:59:08.270
> 
> 标签：css, xamarin.ios, pixate

很难将样式应用于 UITableViewCell，该 UITableViewCell 具有使用 PIXATE 在其中包含 UIImage 的自定义视图。我尝试了几种变体；

```
PixateEngine.SetStyleId(ctrl.MyImage, “myStyle”);

#myStyle {
    border-radius   : 10px;
} 
```

也试过，

```
PixateEngine.SetStyleClass(ctrl.MyImage, “myStyle”);

.myStyle {
    border-radius   : 10px;
} 
```

此外，我尝试在 nib 文件中设置 styleId 和 styleClass 均无济于事。我缺少的 UITableViewCell 自定义和嵌套对象样式设置有什么特别之处吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T22:43:40.453

这似乎已在最新版本的 Pixate 中得到解决。

# ajax - 使用绑定和 AJAX 下拉

> ID：14527652
> 
> 赞同：3
> 
> 时间：2013-01-25T17:59:07.837
> 
> 标签：ajax, jquery, coldfusion

我是 ColdFusion 的新手，刚开始学习 Ajax。我的问题是，我在网上找到了一些很酷的代码来实现两个下拉菜单，第二个在哪里取决于从第一个中选择的内容。但目标是从选择查询中提取下拉列表中的所有值。

我正在使用我刚刚了解的绑定功能。第一次下拉中的所有内容都正确拉动。但问题是第二个。我从 AJAX 记录器得到的错误是`"Error invoking: Error Executing Database Query"`任何建议将不胜感激。也提前感谢您的帮助。

**选择.cfc**

```
<cfcomponent output="false">

    <!--- Get array of Catagory Description types --->
    <cffunction name="cat_description" access="remote" returnType="array">

        <!--- Define variables --->
        <cfset var data="">
        <cfset var result=ArrayNew(2)>
        <cfset var i=0>

        <!--- Get data --->
        <cfquery name="getServiceCat" datasource="SOME_DATABASE">
            SELECT DISTINCT CAT_DESC
            FROM   service_table
            ORDER BY CAT_DESC
        </cfquery>

        <!--- Convert results to array---> 
        <cfloop index="i" from="1" to="#getServiceCat.recordcount#">
            <cfset result[i][1]=getServiceCat.CAT_DESC[i]>
            <cfset result[i][2]=getServiceCat.CAT_DESC[i]>
        </cfloop>

        <!--- And return it --->
        <cfreturn result>
    </cffunction>

    <!--- Get Service Type by Cat description type --->
    <cffunction name="getServiceType2" access="remote" returnType="array">
        <cfargument name="CAT_DESC" type="string" required="true">

        <!--- Define variables --->
        <cfset var data="">
        <cfset var result=ArrayNew(2)>
        <cfset var i=0>

        <!--- Get data --->
        <cfquery name="getServiceType2" datasource="SOME_DATABASE" dbtype="query">
            SELECT DISTINCT com_service_code, report_desc
            FROM   service_table
            WHERE  CAT_DESC = #ARGUMENTS.CAT_DESC# 
            ORDER BY report_desc
        </cfquery>
        </cfif>

        <!--- Convert results to array --->
        <cfloop index="i" from="1" to="#getServiceType2.recordcount#">
            <cfset result[i][1]=getServiceType2.com_service_code[i]>
            <cfset result[i][2]=getServiceType2.report_desc[i]>
        </cfloop>

        <!--- And return it --->
        <cfreturn result>
    </cffunction>

 </cfcomponent> 
```

以上是处理所有查询的cfc。此解决方案的主要原因之一是表单中所需代码的简单性。

```
 ...
 <td>Select Category: <cfselect name="catdesc"
                                 bind="cfc:select.cat_description()"
                                 bindonload="true"/><br />
 </td>
 ...
 <td>Select Service:  <cfselect name="service"
                                bind="cfc:select.getServiceType2({catdesc})"
                                bindonload="false"/>
 </td> 
```

我已经搜索了将近 2 天，试图找到查询错误的解决方案。我知道查询在 SQL 中工作，所以我相信这个问题与 AJAX 有关，并且没有正确实现第二次下拉的 WHERE 子句。

同样，任何建议或建议都会很棒。此外，如果您以另一种方式执行此解决方案，我也很乐意尝试。正如我所说，我对这种语言非常陌生。仅 2 周。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-25T20:54:32.630

**测试 CFC 的**

在将它们插入 ajax 之前，始终在 CF 中测试 cfc。*在*您验证 cfc 可以正常工作之前，没有必要搞乱绑定，因为如果它不能在 CF 中工作，那么它也不能与 ajax 一起工作。唯一的区别是错误将更难找到。

正如其他人建议的那样，从小处着手。自行测试查询。然后继续使用`<cfinvoke>`或简单地从浏览器中使用测试值来测试 CFC，例如：

```
http://yourserver/path/to/select.cfc?method=getServiceType2&cat_desc= 
http://yourserver/path/to/select.cfc?method=getServiceType2&cat_desc=someValue 
```

**错误**

关于错误，我们需要查看完整的错误消息以提供更具体的建议。但是，查看查询/代码一些可能的原因是：

1.  `CAT_DESC`是一个 varchar 列，在这种情况下，您的参数必须用单引号引起来。否则数据库会认为参数值是对象名（表或列）。

    ```
    WHERE CAT_DESC = '#ARGUMENTS.CAT_DESC#' 
    ```

2.  .. OR`CAT_DESC`是数字列，但您的参数为空。这将导致无效的 sql 语句。您需要确保将有效数字传递到查询中（或者您可以在参数为空时跳过 WHERE 子句，具体取决于所需的结果）。一种常见的方法是使用该[`val()`](http://help.adobe.com/en_US/ColdFusion/9.0/CFMLRef/WSc3ff6d0ea77859461172e0811cbec22c24-6e64.html)函数将空字符串和其他非数字值转换为零，即：

    `WHERE CAT_DESC = #val(ARGUMENTS.CAT_DESC)#`

3.  `</cfif>`在第二个查询之后，您似乎也有一个流浪者。（假设它不是复制/粘贴错误）

4.  另一件事是，您的第二个查询同时指定了`datasource`and `dbtype`。这两个属性是互斥的。两者都*可能会*导致语法错误（我没有尝试过）。无论哪种方式，您都应该只使用其中一个（最有可能`datasource`）。

**SQL 注入**

也就是说 - 上面的查询容易受到 sql 注入的影响。您应该始终使用[`<cfqueryparam>`](http://help.adobe.com/en_US/ColdFusion/9.0/CFMLRef/WSc3ff6d0ea77859461172e0811cbec22c24-7f6f.html)所有变量查询参数来防止 sql 注入。它还有其他好处（性能、数据类型检查等）。但是 sql 注入保护是 Web 应用程序中最关键的。

```
<!--- substitute the correct type for your db column --->
WHERE CAT_DESC = <cfqueryparam value="#ARGUMENTS.CAT_DESC#" 
                         cfsqltype="cf_sql_varchar"> 
```

**改进**

从 CF8.0.1+ 开始，[`cfselect`](http://help.adobe.com/en_US/ColdFusion/9.0/CFMLRef/WSc3ff6d0ea77859461172e0811cbec22c24-7afe.html)可以绑定到查询对象（不仅仅是数组）。因此，无需构建数组，只需从函数返回原始查询。

```
 <cffunction name="getServiceType2" access="remote" returnType="query">
        <cfargument name="CAT_DESC" ....>

        <cfset var data="">

        <cfquery name="data" ..> 
           SELECT TheQueryColumnToDisplay, TheQueryColumnUsedForListValue
           FROM  ... 
           WHERE ... 
        </cfquery>

       <cfreturn data>
    </cffunction> 
```

然后指定用于`display`和`value`属性的列：

```
 <cfselect name="service" 
              bind="cfc:select.getServiceType2({catdesc})"
              display="TheQueryColumnToDisplay"
              value="TheQueryColumnUsedForListValue" ...> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-25T18:23:31.347

我的建议是一次做一件事。针对您的具体情况，

首先，让您的查询使用 cfquery 标记。

其次，让它在一个函数中工作，你将参数传递给函数。

接下来，将函数放在 cfc 中，并使用或通过创建对象并调用函数从 cfc 页面调用它。

最后做绑定。

这种方法将使错误更加明显，以便您可以对它们做一些事情。

其他意见

1.  使用查询参数。
2.  尝试将 id 字段而不是文本描述传递给您的查询

# clojure - 如何在clojure中做到这一点？

> ID：14527659
> 
> 赞同：2
> 
> 时间：2013-01-25T17:59:25.417
> 
> 标签：clojure

我需要执行以下操作：

`(defn make-menu [] (for [i (range 3)] '(+ i 100)))`

我需要 make-menu 返回： ('(+ 0 100) '(+ 1 100) '(+ 2 100))

请注意，向量包含非评估函数。

是否可以在 Clojure 中执行此操作？

谢谢你的帮助！

雅库布

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-25T18:00:22.687

```
(defn make-menu [] (for [i (range 3)] (list '+ i 100))) 
```

或者

```
(defn make-menu [] (for [i (range 3)] `(+ ~i 100))) 
```

第一种形式只是三个元素的列表：符号 + 引用，i 计算为 for 列表理解中绑定的值和 100。

第二种形式是语法引用的示例。注意普通引用和语法引用之间的区别`'`：第二个允许通过前缀来评估子表单`~`。它也完全限定符号，因此`+`变为`clojure.core/+`. 普通引用只是引用引用形式中的每个子元素，因此无法进行评估。

# c# - 匹配 包含 1 个或多个标签的 标签

> ID：14527666
> 
> 赞同：-6
> 
> 时间：2013-01-25T17:59:40.930
> 
> 标签：c#, regex

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T18:10:30.560

你可以使用这个正则表达式

```
<p[^<>]*>.*?<strike>.*?</p> 
```

但不推荐使用正则表达式解析 html 的方法。

而是使用 html 解析器，如[htmlagilitypack](http://htmlagilitypack.codeplex.com/) ..

* * *

您可以使用此代码来检索它`HtmlAgilityPack`

```
HtmlDocument doc = new HtmlDocument();
doc.Load(yourStream);

//strikeNodes contains all the p nodes
var strikeNodes = doc.DocumentNode.SelectNodes("//p[strike]");
//pText contains all p nodes in textual format
List<string> pText= doc.DocumentNode.SelectNodes("//p[strike]").Select(x=>x.OuterHtml); 
```

# symfony - 为每个控制器添加相同的 FlashBag 代码 - Symfony2

> ID：14527667
> 
> 赞同：0
> 
> 时间：2013-01-25T17:59:49.567
> 
> 标签：symfony

我需要为`$session->getFlashBag()->add('foo', $bar);`每个控制器添加一个 FlashBag 代码，以及获取`$bar`. 我想知道是否有更好的方法然后将代码复制+粘贴到每个控制器中？会有某种主控制器吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-25T18:02:58.393

我建议您创建一个侦听器，该侦听器将在您指定的每个控制器之前运行。遵循本指南将显示设置它所需的一切：

[http://symfony.com/doc/2.0/cookbook/event_dispatcher/before_after_filters.html](http://symfony.com/doc/2.0/cookbook/event_dispatcher/before_after_filters.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-26T07:21:45.517

[http://symfony2.ylly.fr/symfony2-simulate-preexecute-postexecute-filters-actions-jordscream/](http://symfony2.ylly.fr/symfony2-simulate-preexecute-postexecute-filters-actions-jordscream/)

您应该尝试实现服务并为其注册`onCoreController`，然后执行`$event->getController()->preAction()`（或您想要的任何函数名称......），然后您可以在控制器中实现您需要功能的那些方法

就像是

```
src/My/Bundle/RequestListener.php:

public function onCoreController(FilterControllerEvent $event) {
  $evntController = $event->getController();
  if (method_exists($evntController[0], 'beforeFilter')) {
    $evntController[0]->beforeFilter();
  }
} 
```

在这里查看更多信息

[http://symfony.com/doc/2.0/book/internals.html#the-event-dispatcher](http://symfony.com/doc/2.0/book/internals.html#the-event-dispatcher)

[http://symfony.com/doc/2.0/book/internals.html](http://symfony.com/doc/2.0/book/internals.html)

[http://symfony.com/doc/current/cookbook/service_container/event_listener.html](http://symfony.com/doc/current/cookbook/service_container/event_listener.html)

# python - 尝试删除从 DLL 返回的非 UTF 字符时出错

> ID：14527671
> 
> 赞同：0
> 
> 时间：2013-01-25T18:00:03.170
> 
> 标签：python, dll, encoding, utf-8

我正在尝试将 dll 返回的结构中的一个字段修复为没有任何非 UTF-8 字符。当我尝试修改字段时出现错误

```
import _portaudio as pa
...
my_dev_info = pa.get_device_info(device_index)
my_dev_info.name = my_dev_info.name.decode('utf-8','ignore')

    my_dev_info.name = my_dev_info.name.decode('utf-8','ignore')
    UnicodeDecodeError: 'utf8' codec can't decode byte 0xce in position 0: invalid c
    ontinuation byte 
```

如果我尝试简单地将 .name 重新分配给其他东西，则会出现不同的错误

```
my_dev_info.name = '???'
AttributeError: Fields read-only: cannot modify values 
```

pa 是从我相信的 dll 导入的。我无法控制它的内容。有什么办法吗？

这适用于简单的字符串，但不适用于 'pa' 对象：

```
>>> s='┼δⁿτΦ foo'
>>> s = s.decode('utf-8','ignore')
>>> s
u' foo'
>>> 
```

# javascript - 在列表项中显示数组值 - Jquery、Backbone.js

> ID：14527672
> 
> 赞同：0
> 
> 时间：2013-01-25T18:00:07.353
> 
> 标签：javascript, jquery, backbone.js

我正在尝试使用主干视图模型通过单击输出数组值，请告知如何在单独的行上输出每个数组值，或者可能通过 jquery 在列表项中显示每个数组值。谢谢 ：）

```
<!DOCTYPE html>
<head>
<meta charset=utf-8" />
<title>Test</title>
        <script type="text/javascript" src="jquery.js"></script>
        <script type="text/javascript" src="underscore.js"></script>
        <script type="text/javascript" src="backbone.js"></script>
</head>

<body>

<button>click</button>
<div class="ctype"></div>

<div class="cexperience"></div>

<script type="text/javascript">
    var Job1 = Backbone.Model.extend({
        defaults:{
        type:'permanent',   
        experience:['html','css','php']
        }

    });

    var myJob1 = new Job1();

    var Jobview1 = Backbone.View.extend({
        el:'button',
        events:{
            'click':'render'
        },
        render: function(){

            var _type = myJob1.get('type');
            var _experience = myJob1.get('experience');

            $('div.ctype').html(_type);
            $('div.cexperience').html(_experience);

            return this
        }

    })

    $(document).ready(function(e) {
            var myJobview1 = new Jobview1();

    });
    </script>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T18:05:16.827

```
_.each(_experience, function (key, value) {
    var tmp = $('<p />');
    tmp.html(value);
    $('.experience').append(tmp);
)}; 
```

这应该有效。也许您需要将键、值切换到值、键。我倾向于忘记参数的顺序。

# c++ - 在 C 或 C++ 中实现 Prolog

> ID：14527682
> 
> 赞同：15
> 
> 时间：2013-01-25T18:00:45.167
> 
> 标签：c++, prolog, compiler-construction

我想知道 C 或 C++ 中的 Prolog 实现会是什么样子。我主要对将其构建为 C 或 C++ 库感兴趣，尽管解释器应用程序也可以。我有兴趣阅读它的内部结构，即查询执行，即找到解决方案和相关的数据类型。如果您向我推荐任何有关主题的读物或任何直接的建议/建议，我会很高兴。读数可能适用于其他 OOP 语言或一般 OOP。大多数令人筋疲力尽的材料将解决这个问题。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-01-26T10:31:36.250

如果您想了解在 C/C++ 中如何将用 C 实现的 Prolog 系统用作库，请查看[SWI-Prolog](http://www.swi-prolog.org)。它提供了一个完全双向的接口，包括 Unix/Mac/Window 的非确定性——等等。想想[约束](https://stackoverflow.com/a/4808998/772868)。

另一方面，您也在询问其实际实施。有两种方法可以解决这个问题。您可以从最底层开始，逐步提高自己的水平。或者你可以从 Prolog 开始，从在 Prolog 中实现 Prolog 的元解释器开始。从这里你可以慢慢挖掘到血块。

传统的方法是首先从最底层的问题开始，研究各种抽象机器。最常被引用的一种是 WAM（沃伦抽象机），然后是 您不应该错过[的 WAM 的替代品。](https://stackoverflow.com/questions/4478615/alternatives-to-the-wam/4504325)做好准备，从这到一个有效的[ISO 实施](https://stackoverflow.com/questions/tagged/iso-prolog)将需要很长的路要走。有许多问题在文献中只是粗略地处理，例如垃圾收集和约束。然而，它们是稳健实施所必需的。

另一种方法是先学习 Prolog，然后详细研究元解释器。通过这种方式，您可能会学会从完全不同的角度看待 Prolog。而且您可能还会获得其他方式无法获得的见解。你可以从经典的三子句元解释器开始，它重用了 Prolog 的大部分功能。然后，根据您的兴趣，您可以开始具体化其中的一部分。好消息是您（就代码大小而言）几乎只为您想要挖掘的部分付费并重用该语言的其他部分。

至少在过去，这种方法导致了各种新的实现技术，例如约束、[Erlang](https://stackoverflow.com/questions/tagged/erlang)、二进制 Prolog 都首先作为“简单”元解释器存在。只有这样，在理解了语言问题之后，才完成了实际的实现。

还有一点支持先从 Prolog 开始：如果你在它中间停止努力，会发生什么？使用自下而上的方法，您最终会得到一组已失效的代码。对于第二种方法，您已经学习了 Prolog。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-01-25T20:15:37.730

前段时间，我用 C++（真的，我的第一个 C++ 程序）编写了一个 Prolog 解释器，并采用了不同的方法，而不是（现在几乎无处不在的）WAM。我们的语言和编译器构建课程的老师谈到了一个 ABC 算法，我实现了它（我看到了“Prolog 实现 ABC 算法”，[这里](https://cs.uwaterloo.ca/research/tr/1984/CS-84-47.pdf)是我找到的 PDF，但我还不知道）：这里是核心求解器

```
//--------------------------
// evaluation core of query
//  use algorithm ABC
//
int IntlogExec::query(const Clause *q)
{
    unsigned nc = 0;

    ProofStack::Env *pcn, *pfn;
    stkpos cn, fn;
#define PCN (pcn = ps->get(cn))
#define PFN (pfn = ps->get(fn))

    UnifyStack us(vs, ts);

    if (!q)
        goto C;

    fn = ps->push(STKNULL);
    PFN->vspos = vs->reserve(q->get_nvars());
    pfn->trail = ts->curr_dim();
    pfn->dbpos = 0;
    pfn->call = 0;

    // current query is empty?
A:  if (!q->get_body()) {

        // search untried calls
A1:     //fn = ps->curr_dim() - 1;
        fn = cn;

        ProofStack::Env *e = ps->get(fn);
        while (e->father != STKNULL) {
            if (tr && e->call && tr->exit(fn, e->call))
                return -1;
            if (e->call && !e->call->is_last())
                break;
            e = ps->get(fn = e->father);
        }
        if (e->father == STKNULL)
            return 1;

        // set call to next untried brother
        cn = ps->push(PFN->father);
        PCN->call = pfn->call->next();
        pcn->vspos = pfn->vspos;
        fn = pfn->father;

    } else {
        cn = ps->push(fn);
        PCN->call = q->get_body();
    }

A2: PFN;
    pcn->dbpos = 0;
    cc = pcn->call;

    if (nc++ == ncycle)
    {
        nc = 0;
        sighandler();
    }

    // trace the call
    if (tr && tr->call(cn, cc))
        return -1;

    switch (cc->get_type()) {

    case CallData::BUILTIN: {
        BuiltIn *btp = cc->get_builtin();

        pcn->trail = ts->curr_dim();
        pcn->vspos = pfn->vspos;

        // if evaluate OK
        if (btp->eval(cc->args(), this, 0)) {

            //          if (tr && tr->exit(cn, cc))
            //              return -1;

            //          if (btp->retry || pcn->call->last())
            //              goto A1;

            //          pcn->call = pcn->call->next();
            //          goto A2;
            goto A1;
        }

        PCN;

        if (tr && tr->fail(cn, pcn->call))
            return -1;

        unbind(pcn->trail);
    }
    goto C1;

    case CallData::CUT: {
        stkpos gf = PFN->father;
        if (    gf != STKNULL &&
                pfn->call->is_last() &&
                pfn->call == pcn->call->next()) {
            // tail recursion optimization
            ProofStack::Env *pgf = ps->get(gf);
            pgf->vspos = pfn->vspos;

            ASSERT(!pcn->call->is_last());

            slist_iter s(tmpt);
            ElemTmp *t;
            while ((t = (ElemTmp*)s.next()) != 0 && t->spos > fn)
                t->spos = fn;

            CallData *cproc = pcn->call;
            cn = ps->pop(cn - fn) - 1;
            PCN->call = cproc->next();
            fn = pcn->father;

            goto A2;
        }

        pcn->trail = ts->curr_dim();
        pcn->vspos = pfn->vspos;
    }
    goto A1;

    case CallData::DISJUNCT:            // replace with catenated try
        pcn->vspos = pfn->vspos;
        pcn->trail = ts->curr_dim();
        cn = ps->push(fn);
        PCN->call = cc->next();         // left side
        goto A2;

    case CallData::DBPRED:

        // initialize DB search
        pcn->dbpos = db->StartProc(cc->get_dbe());

        // DB matching & unification
B:  if (pcn->dbpos && (q = pcn->dbpos->get()) != 0) {

            unsigned nvars = q->get_nvars();
            pcn->vspos = vs->reserve(nvars);
            pcn->trail = ts->curr_dim();

            /*
   if (!unify(  pfn->vspos, cc->args(),
      pcn->vspos, q->h_args(), q->h_arity()))
   */
            if (q->h_arity() > 0) {
                TermArgs pa1 = cc->args(),
                        pa2 = q->h_args();

                us.clear();
                for (int i = q->h_arity() - 1; i > 0; i--) {
                    UnifyStack::termPair *tp = us.push();
                    tp->t1 = pa1.getarg(i);
                    tp->i1 = pfn->vspos;
                    tp->t2 = pa2.getarg(i);
                    tp->i2 = pcn->vspos;
                }
                us.check_overflow();

                if (!us.work(   pa1.getarg(0), pfn->vspos,
                                pa2.getarg(0), pcn->vspos))
                {
                    // undo changes
                    unbind(pcn->trail);
                    vs->pop(nvars);

                    // try next match
                    pcn->dbpos = pcn->dbpos->succ(db);
                    goto B;
                }
            }

            fn = cn;
            goto A;
        }
        break;

    default:
        ASSERT(0);
    }

    if (tr && PCN->call && tr->fail(cn, cc))
        return -1;

    // backtracking
C1: query_fail(ps->curr_dim() - cn);

    // resume top query
C:  cn = ps->curr_dim() - 1;
    unbind(PCN->trail);

C2: if ((fn = pcn->father) == STKNULL)
        return 0;

    if ((cc = pcn->call) == 0)
        goto C1;

    switch (cc->get_type()) {

    case CallData::CUT:  {      // change satisfaction path up to father
        stkpos fvp = PFN->vspos;
        query_fail(cn - fn + 1);
        if ((cn = ps->curr_dim() - 1) != STKNULL) {
            unbind(PCN->trail);
            vs->pop(vs->curr_dim() - fvp);
            goto C2;
        }
        return 0;
    }

    case CallData::BUILTIN: {   // check builtins retry
        BuiltIn *btp = cc->get_builtin();

        if (btp->args & BuiltIn::retry) {

            if (tr && tr->redo(cn, cc))
                return -1;

            // could be resatisfied
            pcn->trail = ts->curr_dim();
            pcn->vspos = PFN->vspos;

            // if evaluate OK
            if (btp->eval(cc->args(), this, 1))
                goto A1;
        }

        // failed
        goto C1;
    }

    case CallData::DISJUNCT:    // evaluate right side
        if (tr && tr->redo(cn, cc))
            return -1;

        pcn->call = cc->get_orelse();
        goto A2;

    case CallData::DBPRED:      // a DB query node to retry
        if (tr) {   // display REDOs (TBD)
            if (pcn->dbpos && pcn->dbpos->succ(db) && tr->redo(cn, cc))
                return -1;
        }
        vs->pop(vs->curr_dim() - pcn->vspos);
        pcn->dbpos = pcn->dbpos->succ(db);
        PFN;
        goto B;

    default:
        ASSERT(0);
    }

    return -1;
} 
```

现在我对那个代码不是很自豪：我最终（通过相当痛苦的调试）而不是 ABC 到 A-A1-A2 B C1-C-C2。

*编辑*：我将完整的解释器[源代码](https://github.com/CapelliC/IL)放在 github 中。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-01-25T18:11:10.997

您可以从检查[这个问题](https://stackoverflow.com/questions/5881432/how-does-prolog-technically-work-whats-under-the-hood)的答案开始。

您还可以检查各种开源 prolog 实现的来源（gnu prolog、swi-prolog、yap prolog 等）（尽管如果您只想要一个“幼稚”的实现或一些类似 prolog 的功能，例如回溯，这可能太复杂了）。

最后，您应该检查序言 ISO。

话虽如此，如果您对结合 C 和 prolog 感兴趣，可以使用一些接口；我不认为实施（有效的）序言是一项微不足道的任务，特别是如果我们考虑到（令人惊讶地）有许多公司/组织致力于它。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-11-13T19:56:20.923

You might also be interested in looking at Mike Spivey's [An Introduction to Logic Programming through Prolog](http://spivey.oriel.ox.ac.uk/corner/Logic_Programming). Both the full text of the book as well as an implementation of a simplified Prolog are available at the previous link (Note: the implementation itself is written in a minimal Pascal dialect, but for compilation this is translated into C. According to the author, this minimal Pascal dialect is more or less the "intersection of Pascal and C", anyway---whatever that means, so while not strictly satisfying the criteria, it should be quite useful for learning about Prolog).

I also noticed Alan Mycroft's [Logic Programming and Functional Nets](http://www.cl.cam.ac.uk/~am21/research/funnel/), following this link you will find a Prolog interpreter in C++, but I don't know much about it.

# geospatial - Arc Gis 10 dosnt 向我展示 arcmap 中的空间分析师

> ID：14527686
> 
> 赞同：-3
> 
> 时间：2013-01-25T18:01:00.220
> 
> 标签：geospatial, arcgis, geo, arcgis-server

我正在使用 Arcgis 10 arcgis 教育版，我正在与空间分析师合作，并且地理处理空间分析可在弧目录的弧工具箱中使用。但如果我想在弧形地图中使用它，则会发生错误：错误 010096 目前没有可用或启用的空间分析许可证

我该如何解决？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-26T05:44:12.147

尝试转到“自定义”菜单，单击“扩展”并查看是否可以选中您感兴趣的扩展框，然后再次尝试这些工具以查看它们是否有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T21:24:34.777

我对这个问题的解决方案是：

定制 >> 扩展 >> 检查

# c++ - C++ 中 Linux 中的虚假 SIGPIPE

> ID：14527691
> 
> 赞同：0
> 
> 时间：2013-01-25T18:01:13.483
> 
> 标签：c++, linux, sigpipe

有人听说过没有明显原因的 SIGPIPE 吗？我有一个程序，它与 SIGPIPE 一起崩溃。我用信号（SIGPIPE，SIG_IGN）防止了崩溃；出于好奇，我什么也没做，即没有错误处理。令我惊讶的是，代码运行良好。我通过一个套接字与另一个程序通信。即使在 SIGPIPE 之后，通过套接字的数据传输也能正常工作。这可能吗？SIGPIPE 由于临时网络中断？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-25T18:07:14.047

这就是套接字在 *nixes 上的工作方式。

基本上发生的事情是您在对等方重置的 TCP 套接字上执行了 write()/send() 或类似操作。默认情况下，这将导致终止应用程序的 SIGPIPE 信号。

解决这个问题的常用方法是像您已经完成的那样简单地忽略 SIGPIPE 信号，而是处理来自 write()/send() 的错误返回值。

更多信息可以在[这里](http://www.faqs.org/faqs/unix-faq/socket/)找到，见章节 2.19 和 2.22

# java - 带有两个 for 循环的 Java 递归函数

> ID：14527693
> 
> 赞同：1
> 
> 时间：2013-01-25T18:01:16.117
> 
> 标签：java, recursion

在我的程序中，最重要的部分是用一些对象填充数组。

这些对象是棋盘上的象。有一些替代功能可以放置主教和它攻击的地方或决定董事会是否被正确填满。

在前几个循环结束时，电路板被填满并回到之前的状态，完成下一次尝试。

问题在于它以某种方式使用的不是旧数组而是最后一个数组，因此数组不断堆积数字，而不是做出所有可能的选择。我究竟做错了什么？

**编辑**：我想我不得不提一下，在结果中，两者应该是这样的。之后，这个计数中没有零，CheckGoedeStand 返回一个。

```
 int SolveBoard(int m,int n,int d,int l) {
        int[][] field = new int[m][n]; // this is the m*n schaakbord. int is standaard 0.
        // probleem opgelost
        System.out.println("aantal lopers: " + l);
        int GoedeStand = Recursie(field,0,0, m, n, d, l);
        PrintFieldImage(field);
        return GoedeStand;  
    }

    //deze fuctie is alleen gekoppeld saan SolveBoard()
    int Recursie(int[][] field, int LopersSet, int AGB, int m, int n, int d, int l) {
        int mcount, ncount;
        int[][] fieldC = field;
        //de rekenlus              
        // 0 is leeg, 1 is aangevallen, 2 is lopers plaats, 3 is dame haar plaats      
        if (LopersSet < l) {
            LopersSet++;
            for (mcount = 0; mcount < m; mcount++) {
                for (ncount = 0; ncount < n; ncount++) {
                    //if (field[mcount][ncount] <= 1) {
                        fieldC = PlaatsLoper(fieldC, m, n, mcount, ncount);
                        //nu de recursie, eerst kopie maken van bord zodat deze niet verloren gaat
                        AGB = Recursie(fieldC, LopersSet, AGB, m, n, d, l);
                    //}
                }
            }
        } else {
            PrintFieldImage(field);
        }
        if (CheckGoedeStand(field, m, n) == 1 && LopersSet == l) {
            //PrintFieldImage(field);
            AGB++;
            //field = new int[m][n];
        }
        return AGB;
    } 
```

如您所见，我从一个空数组开始，d 未使用，并且对于测试，我将 m、n 和 l 设置为 2。

这是我的输出：

```
[2, 0]
[0, 1]

[2, 2]
[1, 1]

[2, 2]
[2, 1]

[2, 2]
[2, 2]

[2, 2]
[2, 2]

[2, 2]
[2, 2]

[2, 2]
[2, 2]

[2, 2]
[2, 2]

[2, 2]
[2, 2]

[2, 2]
[2, 2]

[2, 2]
[2, 2]

[2, 2]
[2, 2]

[2, 2]
[2, 2]

[2, 2]
[2, 2]

[2, 2]
[2, 2]

[2, 2]
[2, 2]

[2, 2]
[2, 2]
AGB= 19 
```

# asp-classic - 类型错误（0x800a01a8）：所需对象：“文档”

> ID：14527696
> 
> 赞同：-1
> 
> 时间：2013-01-25T18:01:40.057
> 
> 标签：asp-classic, vbscript

我在下面的 vbscript 中有一个经典的 asp 页面，但它说 Document 对象不存在，为什么？

```
TypeError (0x800a01a8): Object required: 'Document' 
```

VBScript 代码：

```
<script language="vbscript" RUNAT="Server">
Function getDescriptionEstProc()
    Dim  CONNECTSTRING, QUALIFIER, QueryDescEstProc, dbConnect, res,output, param

    CONNECTSTRING = Session("CONNECTSTRING")
    QUALIFIER = Session("QUALIFIER")

    param = PageParams1.UIDMeterHistory

    QueryDescEstProc = "select e.description from meterhistory mh, meterread m, estimationprocess e where m.uidestproc = e.uidestproc  and m.uidmeter = mh.uidmeter and mh.uidmeterhistory = '"& "0100001" &"'"

    Set dbConnect = Server.CreateObject("ADODB.Connection")
    Set rsWQType = Server.CreateObject("ADODB.Recordset")

    dbConnect.Open CONNECTSTRING

    rsWQType.Open QueryDescEstProc, dbConnect

    res = ""

    Do While Not rsWQType.EOF 
        res = res & rsWQType("description") & ","
    Loop

    Dim TheForm 
    Set TheForm = Document.forms("Form1")
    TheForm.hiddenString.Value = res

    Response.Write res & " - hello"

    getDescriptionEstProc = res

    End Function
</script> 
```

（没有 aspx 文件）.asp 文件：

```
 <form name="Form1" method="post" onkeypress="if (event.keyCode==13) {this.submit();event.returnValue=false;} else event.returnValue=true;">
<input class="lookup" type=hidden name="Id" value="<%=PageParams1.Id%>">
<input type=hidden name="SessionId" value="<%=PageParams1.SessionId%>">
<input type=hidden name="Command" value="">
<input type=hidden name="AccountID" value="<%=PageParams1.AccountID%>">
<input type=hidden name="UIDFACILITY" value="<%=PageParams1.UIDFACILITY%>">
<input type=hidden name="FACILITYID" value="<%=PageParams1.FACILITYID%>">
<input type=hidden name="METERID" value="<%=PageParams1.METERID%>">
<input type=hidden name="UIDMETER" value="<%=PageParams1.UIDMETER%>">
<input type=hidden name="UIDMeterHistory" value="<%=PageParams1.UIDMeterHistory%>">
<input type=hidden name="CustomerName" value="<%=PageParams1.CustomerName%>">
<input type=hidden name="CustomerId" value="<%=PageParams1.CustomerId%>">
<input type=hidden name="EntityParam" value="<%=PageParams1.EntityParam%>">
<input type=hidden name="SORT_BY" value="<%=PageParams1.SORT_BY%>"> 
<input type=hidden name="SORT_ORDER" value="<%=PageParams1.SORT_ORDER%>">
<input type=hidden name="Mode" value="<%=PageParams1.Mode%>">
    <table class="SnapIn" cellpadding="0" cellspacing="0" border=0><tr class="ToolsTabs">
  <td class="Title"><nobr><%=Proxy1.i18n.FM("MeterHistory")%></nobr></td>
  <td class="ToolsLeft">
    <b><%=Proxy1.i18n.FM("ID")%></b> &nbsp; <%=meterId %>
        <%if (PageParams1.Mode == "ServicePoint") {%>
        &nbsp;&nbsp;|&nbsp;&nbsp;<a href="../../ccs/MainWebPart.aspx?Mode=
  <%=PageParams1.Mode%>&SessionId=<%=PageParams1.SessionId%>&Uid=
  <%=Proxy1.Session.GetPropertyValue("SERVICEPOINT_UID")%>">
  <%=Proxy1.i18n.FM("ServicePointSummary")%></a>
    <% } else if (PageParams1.Mode == "MarketParticipant") { %>
        &nbsp;&nbsp;|&nbsp;&nbsp;<a href="../../ccs/MainWebPart.aspx?Mode=
  <%=PageParams1.Mode%>&SessionId=<%=PageParams1.SessionId%>&Uid=
  <%=Proxy1.Session.GetPropertyValue("MARKETPARTICIPANT_UID")%>">
  <%=Proxy1.i18n.FM("MarketParticipantSummary")%></a>
    <% } %>
  </td>
  <td class="ToolsRight"><nobr>&nbsp;
        <%if (PageParams1.AccountID) {%>
      <b><%=Proxy1.i18n.FM("AccountID")%></b>
      <a class="Link" onclick='window.navigate("../viewaccount/Meters.asp?Id=<%= escape(PageParams1.AccountID)%>&SessionId=<%=PageParams1.SessionId%>")'><u><%=PageParams1.AccountID %></u></a>
    &nbsp;&nbsp;
    <%} if (PageParams1.CustomerId) {%>
    <b><%=Proxy1.i18n.FM("CustomerID")%></b>
      <a class='Link' onclick='navigate("../../ccs/MainWebPart.aspx?Id=<%=escape(PageParams1.CustomerId)%>&SessionId=<%=PageParams1.SessionId%>"+"&Mode=Customer")'> 
          <%=PageParams1.CustomerId%>
      </a>
      &nbsp;&nbsp;
      <%} if (PageParams1.UIDFACILITY) {%>
        <b><%=Proxy1.i18n.FM("FacilityID")%></b>
        <a class=Link onclick='navigate("../cust_facility/Basics.asp?UIDFACILITY=<%=PageParams1.UIDFACILITY%>&SessionId=<%=PageParams1.SessionId%>&X_ROWPERPAGE=50")'>
            <%=PageParams1.FACILITYID%>
        </a>
      <%}%>
  </nobr></td>
</tr><tr>
    <td class="TabBox" colspan="3"><%= RenderTabs("MeterRead") %></td>
</tr><tr>
    <td class="Body" colspan="3">
    <%          if (OperationError) ReportError(OperationError)%>

    <%if (PageParams1.Command=='Edit') { %>
            <table width=100%><tr><td class=LinkBox>
              <%if (Proxy1.Allow("//ACCTMGT/ACCTCOMP/ACCTMET/@UPDATE")) {%>
              <a href="javascript: Save()"><%=Proxy1.i18n.FM("Save")%></a> |
              <%}%>
              <%if (PageParams1.EntityParam && Proxy1.Allow("//ACCTMGT/ACCTCOMP/ACCTMET/@REMOVE") ) { %><a href="javascript: Delete()"><%=Proxy1.i18n.FM("Delete")%></a> |<% } %>
              <a href="javascript: Cancel()"><%=Proxy1.i18n.FM("Cancel")%></a>
            </td></tr></table>
    <%} else%>
        <%=tMeterHistoryTable %>

    <%if (PageParams1.Command != 'Edit') { %>
        <table style="width: expression(Math.max(document.body.offsetWidth-55, 540))">
        <tr>
        <td align=left>
        <%
                    if (Proxy1.Allow("//FACILITY/ADD"))
                    {
                %>
                                <a href="javascript: Edit()" ><%=Proxy1.i18n.FM("Add")%></a>&nbsp;&nbsp;&nbsp;
                <%
                    }
                    if (Proxy1.Allow("//FACILITY/REEST_ACTION/@REESTIMATE")) { %>
                                <a href="javascript: reestimate()">Ristima</a>&nbsp;&nbsp;&nbsp;
                <%
                    }
                    if (Proxy1.Allow("//FACILITY/REEST_ACTION_2")) { %>
                                <a href="javascript: reestimate2()">Ristima lettura conferimento</a>&nbsp;&nbsp;&nbsp;
                <%  }
                    if (Proxy1.Allow("//FACILITY/REEST_ACTION/@DISCHARGE")) { %>
                                <a href="javascript: discharge()">Scarta</a>
                <%  } %>
                            </td>
                            <!--Indicazione righe e pagina-->
                            <td align=right>
                            <%= Paginator_b(PageParams1.ROWPERPAGE, PageParams1.PAGENUMBER) %>
                            </td>
                        </tr>
                    </table>
            <%
                } 
            %>
<div class="mAppScroll" style="height:100% width:100%"><% =tTable %></div>
<tr>
                        <td>
                            <!--Cannata Alberto - modifica del 09/10/2006: aggiorniamo i campi LSUSER e LSTIME della METERHISTORY.-->
                            <input type="hidden" name = "OLD_STATUS" value = "<%=oldstatus_str%>">
                            <input type="hidden" name = "X_LSUSER" value = "<%=username_web.toUpperCase()%>">
                            <input type="hidden" name = "X_LSTIME" value = "<%=data_modifica%>">
                        </td>
</tr>
</td>
</tr>
</table><!-- /SnapIn -->
<input type="hidden" id="hiddString" name="hiddenString" value="">
<% 
    getDescriptionEstProc();
%>

<SCRIPT language="javascript">
    appendColumn();
</SCRIPT> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T18:53:27.267

Document.Forms 不用于服务器端`ASP`，它用于客户端代码，例如`Javascript`and `VBScript`。如果您尝试使用表单发布数据，请考虑使用 Request["fieldname"] 来获取您需要的值。

看起来您只是想设置隐藏字段的值？

由于该函数返回您想要的值 (res)，因此只需执行以下操作：

```
<input type="hidden" id="hiddString" name="hiddenString" value="<%=getDescriptionEstProc()%>"> 
```

希望这可以帮助。

祝你好运。

# java - 休眠嵌套对象

> ID：14527698
> 
> 赞同：-1
> 
> 时间：2013-01-25T18:01:46.023
> 
> 标签：java, hibernate, exception, persistence

我正在尝试保存嵌套对象，而我不想保存一个对象。我怎样才能做到这一点？当我运行这个时，我得到了短暂的异常

```
org.hibernate.TransientObjectException: object references an unsaved transient instance. 
```

我知道我在做一些hibernate不推荐的愚蠢的事情。

设想：

```
A, B, C, D are four different tables.

Table A  ( field1, field2 , field3[fk to table B])   
Table B  ( field3, field4 , field5 [fk to table C])   
Table C  ( field5, field7 , field8)  
Table D  ( field6, field9 , field3[fk to table B]) 
```

对象

一个

```
private String field1;   
private String field2;  
@OneToOne(cascade=CascadeType.ALL)  
@JoinColumn(name="field3")  
private B b; 
```

乙

```
private String field3;  
private String field4;    
//Want to save D  
@OneToOne(cascade=CascadeType.ALL)  
@JoinColumn(name="field3")    
private List<D> d;         // This is a list of D  
//Dont want to save C  
@OneToOne  
@JoinColumn(name="field5")  
private C c; 
```

C

```
private String field5;  
private String field7;     
private String field8; 
```

D

```
private String field6;  
private String field9;     
private String field3; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T18:30:46.517

我不清楚你为什么要这样做，但我认为可以做到。

1.  让您的实体图处于您希望它被持久化的状态。这可能意味着将您不想保存的字段设置为空（暂时）。
2.  保存/坚持。
3.  恢复被清空的值。如果您处于事务中，您可能希望在恢复不希望保留的值之前分离实体。

像大多数框架一样，当您遵循 hibernate 旨在支持的模式时，hibernate 非常棒。当您尝试做一些“奇怪的”事情时，事情会变得令人毛骨悚然和痛苦。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T18:39:54.330

当你抛出异常时

> “将瞬态实例传递给期望持久实例的 Session 方法”。

烘焙瞬态实例确保在将该瞬态实例传递给 save 方法之前已加载引用。如果您没有持久引用，则首先保存没有引用其他瞬态实例的对象。

# javascript - 重新加载页面而不重新加载控制台数据

> ID：14527703
> 
> 赞同：6
> 
> 时间：2013-01-25T18:02:06.773
> 
> 标签：javascript, google-chrome, console, refresh

我正在尝试在 google chrome 控制台中运行一些 javascript。在它之间的某个地方我需要执行

```
location.reload(); 
```

因此该页面被刷新，但整个控制台数据（我在 colsole 中定义的函数）被破坏。所以我的问题如下：有没有办法在不重新加载控制台窗口的情况下刷新网页？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-25T18:04:02.777

不，控制台是`window`对象的属性，这是您要重新加载的。

您可以通过在重新加载时保持控制台日志数据来在浏览器级别否决它，但它不会成为新窗口范围的一部分：Chrome：开发人员工具 > 控制台 > 导航时保留日志

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-25T18:06:52.727

在 chrome 开发人员工具中，右键单击控制台-> 导航时保留日志将保留 chrome 控制台，即使您刷新页面也是如此。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-05-28T05:55:29.820

Chrome 解决部分单击设置图标并打开一个弹出窗口，检查保留日志选项。显示所有控制台页面后。

![在此处输入图像描述](../Images/42f3bed50649fd0459eb9dd5176ca45d.png)

# xml - 从 XML 加载数据：如何在/不正确的 XML 文件中跳过错误？

> ID：14527713
> 
> 赞同：0
> 
> 时间：2013-01-25T18:02:42.287
> 
> 标签：xml, simplexml, feed, php

我在数据库中有几个我定期检查的 XML 提要。我如何处理数据：

我从数据库加载这些 XML 链接，并循环通过`simplexml_load_file()`我正在解析数据。但有时脚本会因为 XML 文件格式错误导致的错误而终止，例如：

```
Warning: simplexml_load_file() [function.simplexml-load-file]: URL_ADDRESS:1: parser error : Invalid XML encoding name in path_to_script on line 98

Warning: simplexml_load_file() [function.simplexml-load-file]: <?xml version="1.0" encoding=""?> in path_to_scriptp on line 98

Warning: simplexml_load_file() [function.simplexml-load-file]: ^ in path_to_script on line 98

Warning: Invalid argument supplied for foreach() in path_to_script on line 99 
```

有没有办法处理这个错误，当发生错误时，会跳过这个 XML 提要，脚本会继续下一个吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T18:04:24.740

使用[libxml_use_internal_errors()](http://php.net/manual/en/function.libxml-use-internal-errors.php)抑制所有 XML 错误，然后使用[libxml_get_errors()](http://php.net/manual/en/function.libxml-get-errors.php)对其进行迭代。

[来源](http://php.net/manual/en/function.simplexml-load-file.php)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-27T15:03:57.080

如果 [^(*Docs*)](http://php.net/simplexml_load_file)加载文件失败，会返回. 如果您使用[选项](http://php.net/libxml.constants)[^(Docs)](http://php.net/libxml.constants) [^(*，*)](http://php.net/libxml.constants)也不会报告错误。[`simplexml_load_file`](http://php.net/simplexml_load_file)*`false`[`LIBXML_NOERROR`](http://php.net/libxml.constants)*

 **所以你需要做的就是检查返回值：

```
foreach ($files as $file)
{
    $xml = simplexml_load_file($file, null, LIBXML_NOERROR);

    if ($xml === false) {
        continue;
    }

    ... process $xml ...
} 
```

在线演示：[http ://codepad.viper-7.com/EXG7VP](http://codepad.viper-7.com/EXG7VP)**

# ios - 如何在 iOS 上构建大版本的信息按钮？

> ID：14527717
> 
> 赞同：0
> 
> 时间：2013-01-25T18:03:00.953
> 
> 标签：ios, uibutton

对于我的下一个 iOS 应用程序，我想包含一个用于访问信息屏幕的按钮 - infoButton 的典型用例。但是，我希望它显示的尺寸大于其库存尺寸。有没有办法使用标准的 iOS 图标来做到这一点，还是我必须自己动手？

（请注意，我对增加点击区域不感兴趣，“i”也应该更大。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T18:04:30.637

您可以轻松地找到一些更大的“i”艺术并将其用作自定义按钮，但我认为您无法调整 Apple 的按钮。

# c++ - DirectX 中的全屏捕获和渲染 [性能]

> ID：14527718
> 
> 赞同：5
> 
> 时间：2013-01-25T18:03:04.347
> 
> 标签：c++, winapi, directx, ms-media-foundation

我需要一些方法来获取屏幕数据并将它们传递给我的应用程序中的 DX9 表面/纹理，并在**1600*900**分辨率下以至少**25fps**的速度渲染它，30 会更好。

 **我尝试了 BitBliting，但即使在那之后我还是 20fps，并且在将数据加载到纹理并渲染它之后，我还是 11fps，这远远落后于我的需要。

GetFrontBufferData 是没有问题的。

**[这](http://www.codeproject.com/Articles/5051/Various-methods-for-capturing-the-screen#Windows%20Media%20API%20for%20Capturing%20the%20Screen%20%3a)**是有关**使用 Windows Media API**的一些内容，但我不熟悉它。示例正在将数据直接保存到文件中，也许可以将其设置为为您提供单独的帧，但我还没有找到足够好的文档来自己尝试。

我的代码：

```
m_memDC.BitBlt(0, 0, m_Rect.Width(),m_Rect.Height(), //m_Rect is area to be captured
               &m_dc, m_Rect.left, m_Rect.top, SRCCOPY); 
      //at 20-25fps after this if I comment out the rest

//DC,HBITMAP setup and memory alloc is done once at the begining
GetDIBits( m_hDc, (HBITMAP)m_hBmp.GetSafeHandle(),
    0L,             // Start scan line
    (DWORD)m_Rect.Height(),     // # of scan lines
    m_lpData,                   // LPBYTE
    (LPBITMAPINFO)m_bi,     // address of bitmapinfo
    (DWORD)DIB_RGB_COLORS);     // Use RGB for color table
     //at 17-20fps

IDirect3DSurface9 *tmp;
m_pImageBuffer[0]->GetSurfaceLevel(0,&tmp); //m_pImageBuffer is Texture of same 
                                            //size as bitmap to prevent stretching
hr= D3DXLoadSurfaceFromMemory(tmp,NULL,NULL,
                             (LPVOID)m_lpData,
                             D3DFMT_X8R8G8B8,
                             m_Rect.Width()*4,
                             NULL,
                             &r,                 //SetRect(&r,0,0,m_Rect.Width(),m_Rect.Height();
                             D3DX_DEFAULT,0);
 //12-14fps
IDirect3DSurface9 *frameS;
hr=m_pFrameTexture->GetSurfaceLevel(0,&frameS); // Texture of that is rendered
pd3dDevice->StretchRect(tmp,NULL,frameS,NULL,D3DTEXF_NONE);
//11fps 
```

我发现对于 512*512 正方形，它以 30fps 的速度运行（即 20-25 的 490*450），所以我尝试分割屏幕，但似乎效果不佳。

如果代码中缺少某些内容，请写下来，不要投反对票。谢谢

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2014-03-06T08:38:50.543

从 Windows 8 开始，有一个新的[桌面复制 API](http://msdn.microsoft.com/en-us/library/windows/desktop/hh404487%28v=vs.85%29.aspx)可用于捕获视频内存中的屏幕，包括鼠标光标的变化以及屏幕的哪些部分实际发生了变化或移动。这比任何 GDI 或 D3D9 方法的性能都要高得多，并且非常适合将桌面编码为视频流之类的事情，因为您永远不必从 GPU 内存中提取纹理。新 API 可通过枚举 DXGI 输出并在您要捕获的屏幕上调用[DuplicateOutput来获得。](http://msdn.microsoft.com/en-us/library/windows/desktop/hh404600%28v=vs.85%29.aspx)然后就可以进入一个循环，等待屏幕更新，依次获取每一帧。

要将帧编码为视频，我建议查看[Media Foundation](http://msdn.microsoft.com/en-us/library/windows/desktop/ms694197%28v=vs.85%29.aspx)。具体看一下[Sink Writer](http://msdn.microsoft.com/en-us/library/windows/desktop/ff819461%28v=vs.85%29.aspx)，了解最简单的视频帧编码方法。基本上，您只需要将为每个视频帧获得的 D3D 纹理包装到 IMFSample 对象中。这些可以直接传递到接收器写入器。有关详细信息，请参阅[MFCreateDXGISurfaceBuffer](http://msdn.microsoft.com/en-us/library/windows/desktop/hh162751%28v=vs.85%29.aspx)和[MFCreateVideoSampleFromSurface](http://msdn.microsoft.com/en-us/library/windows/desktop/ms703859%28v=vs.85%29.aspx)函数。为了获得最佳性能，通常您需要使用像 H.264 这样具有良好硬件编码支持的编解码器（在大多数机器上）。

为了全面披露，我在微软拥有桌面复制 API 的团队工作，我个人也使用这种技术编写了将桌面（和视频、游戏等）捕获到 60fps 视频文件的应用程序和许多其他场景一样。这也用于在 Microsoft 内部进行屏幕流式传输、远程协助等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-28T11:42:14.920

如果你不喜欢 FrontBuffer，试试 BackBuffer：

```
LPDIRECT3DSURFACE9  surface;
surface = GetBackBufferImageSurface(&fmt); 
```

将其保存到文件使用

```
D3DXSaveSurfaceToFile(filename, D3DXIFF_JPG, surface, NULL, NULL); 
```**

# entity-framework - 实体框架中的 AsNoTracking()

> ID：14527721
> 
> 赞同：20
> 
> 时间：2013-01-25T18:03:19.877
> 
> 标签：entity-framework

我使用`AsNoTracking()`并知道一级缓存在使用时被禁用。但是使用如何`AsNoTracking()`提高性能呢？使用它有什么好处？

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2013-01-25T20:20:51.287

`AsNoTracking()`意味着实体不会被 ObjectContext 实例在本地缓存。这有一些实际的好处：

1.  **内存使用**：由于 ObjectContext 在返回给您后并未引用实体，因此垃圾收集器可以在您不再引用它们时立即删除它们。通常，ObjectContext 需要在这发生之前被释放。

2.  **性能**：由于 EF 不必尝试将从数据库返回的每条记录与身份映射中的本地实体进行匹配，因此您的查询可能会执行得稍快一些。

3.  **货币**：由于查询直接从数据库结果中返回实体，并且不依赖于本地缓存，因此返回的实体应始终反映数据库中的最新值。

4.  **无状态**：由于 ObjectContext 不跟踪实体，因此您可以无限期地继续使用相同的 ObjectContext 实例进行只读查询，并且不必受到有关拥有短期 ObjectContexts 的常规建议的限制。

`AsNoTracking()`如果您只查询实体，这是一个好主意。如果您需要更新它们，它将无法工作，这就是权衡。

# css - 删除线和项目符号 - WP

> ID：14527723
> 
> 赞同：0
> 
> 时间：2013-01-25T18:03:22.420
> 
> 标签：css, wordpress

[这是我的博客（尚未完成）。](http://Www.louismoore.net/wordpress/)

在侧栏中，您可以看到“最近的帖子”，推特提要的许多部分由行分隔，并且旁边有项目符号点。

我想删除这些，但我不知道如何。查看页面的源代码，我认为行和项目符号点在“a href”类上。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T18:13:17.937

查看 Grey.css 第 95 行。那里有一个定义 background-image gray/bullet.png 和一个border-bottom #b0b0b0。如果您想删除两者，您可以通过将以下内容添加到您的嵌入样式来覆盖它：

```
.widget ul li a:link, .widget ul li a:visited {
    background-image: none; /* this can be your own custom background image if desired */
    border-bottom: none;    /* this can be your own desired color/thickness if desired */
} 
```

# node.js - node.js 对于杂志/新闻网站来说太多了吗

> ID：14527725
> 
> 赞同：-4
> 
> 时间：2013-01-25T18:03:23.607
> 
> 标签：node.js, content-management-system

我知道 node.js 可以构建运行速度超快的 Web 应用程序，但我只是找不到足够的信息来了解它在杂志或新闻风格网站中的表现。我知道像 Joomla 或 Drupal（甚至 wordpress）这样的 CMS 非常擅长它，但是随着用户数量的增长，我看到了一些性能问题。自然地，网络服务器很重要，但由于我想将它托管在云中，我想使用 node 并基于它创建一个简单的 CMS 将满足一旦许多用户可以登录并进行社交时更好的用户体验的需求与网站的主要方面平行的东西，只是一个新闻和评论网站。是否有任何 node.js 编码器知道它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T18:49:26.563

我认为这个问题是相当主观的，因为使用现代和维护语言编写的任何应用程序的性能将主要取决于开发人员的技能，如果您的网站达到一定规模，它不仅取决于语言，而且也在你的分布式系统的架构上。

节点的一些通常优势是它是事件驱动的，前端的单一语言，后端因此开发人员集成应该更容易。它的事件驱动模型为其编写和理解（对于新开发人员）大量使用并发操作（例如跨分布式系统的数据密集型操作）的应用程序提供了一种很好且简单（主观！）的方式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-25T20:55:48.237

同意这是相当主观的，但是说有一些节点经验我不知道在这种情况下使用它有什么特别的优势。我认为像 Django (Python) 和 Rails (Ruby) 这样的框架或多或少是为了适应这种类型的用例而构建的，假设你有 PHP 经验但没有很多节点经验，那么你可能更容易构建和部署一个非常快速的工作 CMS。

根据您的描述，我不知道使用 node 的任何优势都会特别相关，并且使用 node 代替任何其他现代框架和 Web 服务器不太可能对您的网站性能产生巨大影响。

# css - Fontwesome 未加载

> ID：14527734
> 
> 赞同：5
> 
> 时间：2013-01-25T18:03:56.260
> 
> 标签：css, apache, mime-types, font-awesome

我目前在一个项目中使用 Fotawesome。问题是，当我加载网页时，我只看到块而不是图标。字体“在服务器上找不到”，但我确定它们位于正确的位置（我可以自己浏览文件）。当我使用 localhost 加载网页时，一切正常。我的电脑上没有安装 Fontawesome。难道这与mimetypes有关吗？我该如何解决？（我使用的是 apache 服务器）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T20:15:59.773

请记住，Font Awesome 的路径与 CSS 的存储位置相关（如果您使用的是相对路径）。

此外，如果它是一个选项，Bootstrap CDN 使使用 Font Awesome 变得非常容易：http: [//www.bootstrapcdn.com/?v= 01042013155511#tab_fontawesome](http://www.bootstrapcdn.com/?v=01042013155511#tab_fontawesome)

# jquery - 如何使用 jQuery 在“ul”中找到最后一个“li”？

> ID：14527735
> 
> 赞同：10
> 
> 时间：2013-01-25T18:04:00.857
> 
> 标签：jquery

我想检查那`li`是最后一个`li`。`ul`如何使用 jQuery 进行检查？

```
<ul id="ulscroller">
    <li value="1" class="selected">1</li>
    <li value="2">2</li>
    <li value="3">3</li>
    <li value="4">4</li>
    <li value="5">5</li>
    <li value="6">6</li>
    <li value="7">7</li>
    <li value="8">8</li>
    <li value="9">9</li>
    <li value="10">10</li>
    <li value="11">11</li>
    <li value="12">12</li>
    <li value="13">13</li>
    <li value="14">14</li>
    <li value="15">15</li>
    <li value="16">16</li>
    <li value="17">17</li>
    <li value="18">18</li>
    <li value="19">19</li>
    <li value="20">20</li>
</ul> 
```

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-01-25T18:04:50.767

只需使用[:last-child](http://api.jquery.com/last-child-selector/)选择器：

```
$('#ulscroller li:last-child') 
```

演示：http: [//jsfiddle.net/f5v6R/](http://jsfiddle.net/f5v6R/)

例如，如果你想知道它是否有`selected`你可以做的类

```
if ($('#ulscroller li:last-child').hasClass('selected')) {
   // do something
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-25T18:07:17.550

您可以使用`.last()`匹配器

```
$('#ulscroller li').last() 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-25T18:06:37.250

```
$('ul#ulscroller').children('li').last(); 
```

[http://api.jquery.com/last/](http://api.jquery.com/last/)

你也可以这样做：

```
$('ul#ulscroller').children('li:last-child'); 
```

[http://api.jquery.com/last-selector/](http://api.jquery.com/last-selector/)

这是一个例子来说明它：http: [//jsfiddle.net/TheNix/W92vF/](http://jsfiddle.net/TheNix/W92vF/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-25T18:07:59.293

试试这个

```
$(function(){
    alert($('#ulscroller li:last-child').val());
}) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-25T18:08:33.583

只需使用以下

```
if($('#ulscroller li:last-child')[0] == liTocheck)
{
   alert("This is the last li");
} 
```

或者

```
if($('#ulscroller li').last()[0] == liTocheck)
{
   alert("This is the last li");
} 
```

这里`liTocheck`是需要比较的 li

# java - 进行 DOM 节点到字符串的转换，但存在命名空间问题

> ID：14527736
> 
> 赞同：9
> 
> 时间：2013-01-25T18:04:01.217
> 
> 标签：java, xml

所以我们有一个带有自定义命名空间的 XML 文档。（XML 是由我们无法控制的软件生成的。它由*不知道*命名空间的DOM 解析器解析；标准的 Java7SE/Xerces 东西，但也在我们的有效控制之外。）输入数据如下所示：

```
<?xml version="1.0" encoding="ISO-8859-1" standalone="no"?>
<MainTag xmlns="http://BlahBlahBlah" xmlns:CustomAttr="http://BlitherBlither">
    .... 18 blarzillion lines of XML ....
    <Thing CustomAttr:gibberish="borkborkbork" ... />
    .... another 27 blarzillion lines ....
</MainTag> 
```

我们得到的 Document 是可用的、xpath 可查询的和可遍历的等等。

将此文档转换为文本格式以写入数据接收器使用一百个 SO“如何将我的 XML 文档更改为 Java 字符串？”中描述的标准 Transformer 方法。问题：

```
Transformer transformer = TransformerFactory.newInstance().newTransformer();
transformer.setOutputProperty(OutputKeys.OMIT_XML_DECLARATION, "no");
transformer.setOutputProperty(OutputKeys.INDENT, "yes");
StringWriter stringwriter = new StringWriter();
transformer.transform (new DOMSource(theXMLDocument), new StreamResult(stringwriter));
return stringwriter.toString(); 
```

它工作得很好。

但现在我想将该文档中的单个任意节点转换为字符串。`DOMSource`构造函数接受 Node 指针就像它接受 a 一样（`Document`实际上 Document 只是 Node 的一个子类，所以据我所知，它是相同的 API）。因此，在上面的代码片段中传入一个单独的节点来代替“theXMLDocument”效果很好……直到我们到达`Thing`.

此时，`transform()`抛出异常：

```
java.lang.RuntimeException: Namespace for prefix 'CustomAttr' has not been declared.
    at com.sun.org.apache.xml.internal.serializer.SerializerBase.getNamespaceURI(Unknown Source)
    at com.sun.org.apache.xml.internal.serializer.SerializerBase.addAttribute(Unknown Source)
    at com.sun.org.apache.xml.internal.serializer.ToUnknownStream.addAttribute(Unknown Source)
    ...... 
```

这就说得通了。（“com.sun.org.apache”读起来很奇怪，但无论如何。）这是有道理的，因为自定义属性的命名空间是在根节点声明的，但现在转换器从子节点开始，并且可以在树中看不到它“上方”的声明。所以我想我理解这个问题，或者至少是症状，但我不知道如何解决它。

*   如果这是一个字符串到文档的转换，我们将使用一个`DocumentBuilderFactory`实例并可以调用`.setNamespaceAware(false)`，但这是另一个方向。

*   没有任何可用属性`transformer.setOutputProperty()`影响 namespaceURI 查找，这是有道理的。

*   没有这种对应`setInputProperty`或类似的功能。

*   输入解析器不知道命名空间，这就是“上游”代码如何创建它的 Document 交给我们的方式。我不知道如何将特定的状态标志传递给转换代码，我认为这是我真正想做的事情。

*   我*相信*可以（以某种方式）`xmlns:CustomAttr="http://BlitherBlither"`向 Thing 节点添加一个属性，与根 MainTag 相同。但是此时输出不再与读入的 XML 相同，即使它“意味着”相同的东西，并且文本字符串最终将在未来进行比较。在抛出异常之前，我们不知道是否需要它，然后我们可以添加它并重试...... ick。就此而言，更改节点会更改原始文档，这确实应该是只读操作。

建议？有什么方法可以告诉 Transformer，“看，不要对输出是否是孤立的合法 XML 施加压力，它不会被自己解析回来（但你不知道） ，只需生成文本并让我们担心它的上下文”？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-14T23:59:01.680

鉴于您引用的错误消息“尚未声明前缀 'CustomAttr' 的命名空间。”，我假设您的伪代码类似于：

```
<?xml version="1.0" encoding="ISO-8859-1" standalone="no"?>
<MainTag xmlns="http://BlahBlahBlah" xmlns:CustomAttr="http://BlitherBlither">
    .... 18 blarzillion lines of XML ....
    <Thing CustomAttr:attributeName="borkborkbork" ... />
    .... another 27 blarzillion lines ....
</MainTag> 
```

有了这个假设，我的建议是：所以您想从“大”XML 中提取“Thing”节点。标准方法是使用一点 XSLT 来做到这一点。您准备 XSL 转换：

```
Transformer transformer = transformerFactory.newTransformer(new StreamSource(new File("isolate-the-thing-node.xslt")));
transformer.setOutputProperty(OutputKeys.OMIT_XML_DECLARATION, "no");
transformer.setParameter("elementName", stringWithCurrentThing);    // parameterize transformation for each Thing
... 
```

***编辑***：@Ti，请注意上面的参数化指令（和下面的 xslt）。

文件“isolate-the-thing-node.xslt”可能是以下内容：

```
<xsl:stylesheet 
    xmlns:xsl="http://www.w3.org/1999/XSL/Transform" 
    xmlns:custom0="http://BlahBlahBlah"
    xmlns:custom1="http://BlitherBlither"
    version="1.0">
    <xsl:param name="elementName">to-be-parameterized</xsl:param>
    <xsl:output encoding="utf-8" indent="yes" method="xml" omit-xml-declaration="no" />

    <xsl:template match="/*" priority="2" >
            <!--<xsl:apply-templates select="//custom0:Thing" />-->
            <!-- changed to parameterized selection: -->
            <xsl:apply-templates select="custom0:*[local-name()=$elementName]" />
    </xsl:template>

    <xsl:template match="node() | @*" priority="1">
        <xsl:copy>
            <xsl:apply-templates select="node() | @*" />
        </xsl:copy>
    </xsl:template>

</xsl:stylesheet> 
```

希望这能让你克服“事情”的问题:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T18:40:40.300

我已经设法解析提供的文档，获取**Thing**节点并毫无问题地打印它。

看一下[工作示例](http://ideone.com/jFNe1P)：

```
Node rootElement = d.getDocumentElement();
System.out.println("Whole document: \n");  
System.out.println(nodeToString(rootElement));
Node thing = rootElement.getChildNodes().item(1);
System.out.println("Just Thing: \n");  
System.out.println(nodeToString(thing)); 
```

**节点字符串**：

```
private static String nodeToString(Node node) {
  StringWriter sw = new StringWriter();
  try {
    Transformer t = TransformerFactory.newInstance().newTransformer();
    t.setOutputProperty(OutputKeys.OMIT_XML_DECLARATION, "no");
    t.setOutputProperty(OutputKeys.INDENT, "yes");
    t.transform(new DOMSource(node), new StreamResult(sw));
  } catch (TransformerException te) {
    System.out.println("nodeToString Transformer Exception");
  }
  return sw.toString();
} 
```

**输出**：

```
Whole document: 

<?xml version="1.0" encoding="UTF-8"?><MainTag xmlns="http://BlahBlahBlah" xmlns:CustomAttr="http://BlitherBlither">
    <Thing CustomAttr="borkborkbork"/>
</MainTag>

Just Thing: 

<?xml version="1.0" encoding="UTF-8"?><Thing CustomAttr="borkborkbork"/> 
```

当我尝试使用`CustomAttr:attributeName`@marty 建议的相同代码时，它会因原始异常而失败，因此看起来您在原始 XML 中的某处使用该自定义`CustomAttr`命名空间作为属性或节点的前缀。

在后一种情况下，您可以利用 的问题`setNamespaceAware(true)`，这将包括**Thing**节点本身的命名空间信息。

```
<?xml version="1.0" encoding="UTF-8"?><Thing xmlns:CustomAttr="http://BlitherBlither" CustomAttr:attributeName="borkborkbork" xmlns="http://BlahBlahBlah"/> 
```

# maven - 使用 Maven 构建 Groovy 项目时出现源错误

> ID：14527741
> 
> 赞同：1
> 
> 时间：2013-01-25T18:04:06.117
> 
> 标签：maven, groovy, gmaven-plugin

我正在尝试使用 maven 构建我的第一个 groovy 项目，但我从 maven 收到以下错误。它是某种类型的源错误，但我不明白我为什么会得到它。

```
[INFO] BUILD FAILURE
[INFO] ------------------------------------------------------------------------
[INFO] Total time: 3.186s
[INFO] Finished at: Fri Jan 25 15:36:09 EST 2013
[INFO] Final Memory: 15M/163M
[INFO] ------------------------------------------------------------------------
[ERROR] Failed to execute goal org.codehaus.gmaven:gmaven-plugin:1.3:execute (default) on project groovyhello: org.codehaus.groovy.runtime.metaclass.MissingPropertyExceptionNoStack: No such property: project for class: org.smith.Example -> [Help 1]
[ERROR] 
[ERROR] To see the full stack trace of the errors, re-run Maven with the -e switch.
[ERROR] Re-run Maven using the -X switch to enable full debug logging.
[ERROR] 
[ERROR] For more information about the errors and possible solutions, please read the following articles:
[ERROR] [Help 1] http://cwiki.apache.org/confluence/display/MAVEN/MojoExecutionException

Process finished with exit code 1 
```

下面是我的源代码：

```
package org.smith

/**
 * Example Groovy class.
 */
class Example
{
    def show() {
        println 'Hello World'
    }
} 
```

这是我的 pom.xml 文件：

```
<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">

<modelVersion>4.0.0</modelVersion>

<groupId>org.smith</groupId>
<artifactId>groovyhello</artifactId>
<name>Example Project</name>
<version>1.0-SNAPSHOT</version>

<dependencies>
    <dependency>
        <groupId>org.codehaus.groovy.maven.runtime</groupId>
        <artifactId>gmaven-runtime-1.6</artifactId>
        <version>1.0</version>
    </dependency>

    <dependency>
        <groupId>junit</groupId>
        <artifactId>junit</artifactId>
        <version>3.8.1</version>
        <scope>test</scope>
    </dependency>
</dependencies>

<build>
    <plugins>

        <plugin>
            <groupId>org.codehaus.gmaven</groupId>
            <artifactId>gmaven-plugin</artifactId>
            <version>1.3</version>
            <executions>
                <execution>
                    <phase>generate-resources</phase>
                    <goals>
                        <goal>execute</goal>
                    </goals>
                    <configuration>
                        <source>${pom.basedir}/src/main/groovy/org/smith/Example.groovy</source>
                    </configuration>
                </execution>
            </executions>
        </plugin>
    </plugins>
</build> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T18:12:23.147

你的第一个线索是错误：很`No such property: project for class: org.jsmith.Example` 抱歉重申你的错误作为你的答案，但让我解释一下。意思是在您的源代码的某个地方，您有一个对变量的引用`project`。（可能在您未发布的源中，或者在您无意更改之前和发布之前可能在源中？？）

我想你可能在你的类定义之后的包名中有错字或一些额外的测试代码？例如。这样的事情可能会产生这样的错误：

```
package org.smith

/**
 * Example Groovy class.
 */
class Example
{
    def show() {
        println 'Hello World'
    }
}
println project.path 
```

同样，您应该在错误发生时发布更新的代码以及与代码匹配的确切错误。很难根据上面的内容来确定问题所在。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-05-16T16:43:15.287

如果您使用脚本而不是内联，则必须定义项目并绑定到 mavenProject。

```
def project = ${project}; // this will bind to the Maven Project property. 
```

同样地

```
def session = ${session} //will bind to MavenSession 
```

[来源](http://docs.codehaus.org/display/GMAVEN/Executing+Groovy+Code#ExecutingGroovyCode-Examples)- 寻找**自定义属性**

# mongodb - 猫鼬和限制字段模式的结果

> ID：14527748
> 
> 赞同：0
> 
> 时间：2013-01-25T18:04:40.353
> 
> 标签：mongodb, mongoose

我有一个名为“Binders”的集合在这个集合中我有一个名为“docs”的字段，它引用了一个“Docs”模式

我想用 findOne() 按 id 拉一个“Binder”，这没问题。

但我想通过字段比较来限制返回的“文档”

我对猫鼬有点陌生，但如果我有伪我的查询......

```
Binder.findOne({_id: req.binder._id}, {$where {docs.type = 'type1'}}, function(error, binder) { 

// So this would return my full binder but only the docs where their .type = 'type1'

}); 
```

我迷路的地方是基于模式的限制

```
{$where {docs.type = 'type1'}} 
```

因此，如果我拉出一个活页夹，它有 50 个文档，但没有一个文档属于 type1，我仍然会得到我的活页夹信息，但是 Docs 字段中不会有任何文档。

希望这是有道理的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T18:11:27.757

如果我正确地跟随你并且`docs`是一个数组，那么你可以使用[`$elemMatch`](http://docs.mongodb.org/manual/reference/projection/elemMatch/#_S_elemMatch)投影运算符来做到这一点：

```
Binder.findOne({_id: req.binder._id}, {docs: {$elemMatch: {type: 'type1'}}}, ... 
```

# jquery - 当 dateFormat 不包含日期时，Datepicker 会丢失日期值

> ID：14527751
> 
> 赞同：2
> 
> 时间：2013-01-25T18:04:48.343
> 
> 标签：jquery, jquery-ui, jquery-ui-datepicker

我有两个 HTML 输入元素。第一个是显示所选月份和年份的只读文本输入，第二个是保存所选日期的隐藏输入：

```
<input type="text" id="MonthDisplay" readonly="readonly" />
<input type="hidden" name="Month" /> 
```

目标是存储在隐藏字段中选择的实际日期，但在可见的 MonthDisplay 字段中仅显示月份和年份。

这是初始化日期选择器的代码：

```
$('#MonthDisplay')
    .datepicker({
        'dateFormat'  : 'MM yy',
        'changeMonth' : true,
        'changeYear'  : true,
        'yearRange'   : '2010:'+new Date().getFullYear(),
        'altField'    : "input[type=hidden][name=Month]",
        'altFormat'   : "m/d/yy"
    }); 
```

用户第一次选择日期时，一切正常。显示字段和隐藏字段都设置正确。但是用户第二次单击显示字段时，日期选择器不会默认为所选月份。相反，它默认为今天的月份。我很确定这是因为控件无法解析日期 - 当我将 dateFormat 设置为包含日期（使用格式字符串`"dd MM yy"`）时，它工作得很好。但我不想在向用户显示的日期中包含这一天。

所以我的问题是，如何在第二次截取 datepicker 使用的日期时，日期会记住选择的上个月？

或者，作为另一个问题，有没有办法让日期选择器或其他控件只选择月份和年份而不选择日期？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-10-21T17:14:10.057

我从@Muthukumar 提到的“记住”所选月份（使用jQuery .data()）的[SO 问题中得到了这个例子。](https://stackoverflow.com/questions/2208480/jquery-ui-datepicker-to-show-month-year-only)[JSFiddle在这里](http://jsfiddle.net/mnoble01/DBpJe/1328/)

HTML：

```
<label for="startDate">Date :</label>
<input name="startDate" id="startDate" class="date-picker" /> 
```

JS：

```
$(function() {
  $('.date-picker').datepicker( {
    changeMonth: true,
    changeYear: true,
    showButtonPanel: true,
    dateFormat: 'MM yy',
    beforeShow: function(elem, inst) {
      var $this = $(this);
      // set the datepicker date
      $this.datepicker('option', 'defaultDate', $this.data('date'));
      // set the input date
      $this.datepicker('setDate', $this.data('date'));
    },
    onClose: function(dateText, inst) { 
      var month = $("#ui-datepicker-div .ui-datepicker-month :selected").val();
      var year = $("#ui-datepicker-div .ui-datepicker-year :selected").val();
      var date = new Date(year, month, 2);
      $(this).datepicker('setDate', date)
             .data('date', date); // remember the selected date
    }
  });
}); 
```

但是，@CharlieKilian，我根本无法让您的代码使用只读输入。我将您的代码和 html（已注释）放入小提琴中，因此您可以根据需要使用它。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-25T18:16:12.427

以下链接应该让您了解如何实施日期选择器以仅选择月份和年份而不选择日期。

[jQuery UI DatePicker 仅显示月份年份](https://stackoverflow.com/questions/2208480/jquery-ui-datepicker-to-show-month-year-only)

# java - MySQL函数从String返回多个Int

> ID：14527753
> 
> 赞同：0
> 
> 时间：2013-01-25T18:04:49.877
> 
> 标签：java, mysql, function, stored-procedures

我想将来自Java方法的字符串（例如“1,3,5,7,9,0,3”）传递给一个函数，并让该函数将用逗号分隔的每个值作为Int返回然后稍后在存储过程中使用（如下所示）。

```
CREATE PROCEDURE updateLastModifiedDate(IN p_classId VARCHAR(21844), IN p_timestamp VARCHAR(21844))
    BEGIN
        SET @query = CONCAT ('UPDATE class SET LastModifiedDate = ',p_timestamp,' WHERE ClassId IN (', p_classId ,')');
        PREPARE stmt FROM @query;
        EXECUTE stmt;
        DEALLOCATE PREPARE stmt;
    END //
DELIMITER ; 
```

我将如何编写函数？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T12:20:31.477

在您的情况下，该函数的输入是一个逗号分隔的字符串。但是 MySql 不包含用于拆分 COMMA SEPARATED 字符串的内置函数（逗号只是分隔符的示例）。

您提到输入为“1,3,5,7,9,0,3”。这意味着，项目的计数是 7。这个计数需要是恒定的。我可以给你举个例子，但项目的数量应该总是恒定的。

mysql 函数也只能返回一个值。因此，您必须仅从函数内部调用过程（在拆分值之后）。

我给你一个[mysql函数](http://dev.mysql.com/doc/refman/5.0/en/create-procedure.html)，假设输入字符串**总是**包含7个项目并且使用的分隔符是**逗号**。否则，您必须修改该功能。

```
DELIMITER @@

CREATE FUNCTION getCustomerFullName(commaSeparatedString VARCHAR(256))
RETURNS INT
BEGIN
  DECLARE value1 INT DEFAULT 0;
  DECLARE value2 INT DEFAULT 0;
  DECLARE value3 INT DEFAULT 0;
  DECLARE value4 INT DEFAULT 0;
  DECLARE value5 INT DEFAULT 0;
  DECLARE value6 INT DEFAULT 0;
  DECLARE value7 INT DEFAULT 0;

  IF NOT commaSeparatedString IS NULL
    THEN
          SELECT LENGTH(commaSeparatedString) - LENGTH(REPLACE(commaSeparatedString, ',', '')) INTO @commaCount;

          IF  @commaCount = 0
            THEN
                 RETURN 0;  
          ELSE
            SET value1 = REPLACE(SUBSTRING(SUBSTRING_INDEX(commaSeparatedString, ',', 1),LENGTH(SUBSTRING_INDEX(commaSeparatedString, ',', 0)) + 1), ',', '');
            SET value2 = REPLACE(SUBSTRING(SUBSTRING_INDEX(commaSeparatedString, ',', 2),LENGTH(SUBSTRING_INDEX(commaSeparatedString, ',', 1)) + 1), ',', '');
            SET value3 = REPLACE(SUBSTRING(SUBSTRING_INDEX(commaSeparatedString, ',', 3),LENGTH(SUBSTRING_INDEX(commaSeparatedString, ',', 2)) + 1), ',', '');
            SET value4 = REPLACE(SUBSTRING(SUBSTRING_INDEX(commaSeparatedString, ',', 4),LENGTH(SUBSTRING_INDEX(commaSeparatedString, ',', 3)) + 1), ',', '');
            SET value5 = REPLACE(SUBSTRING(SUBSTRING_INDEX(commaSeparatedString, ',', 5),LENGTH(SUBSTRING_INDEX(commaSeparatedString, ',', 4)) + 1), ',', '');
            SET value6 = REPLACE(SUBSTRING(SUBSTRING_INDEX(commaSeparatedString, ',', 6),LENGTH(SUBSTRING_INDEX(commaSeparatedString, ',', 5)) + 1), ',', '');
            SET value7 = REPLACE(SUBSTRING(SUBSTRING_INDEX(commaSeparatedString, ',', 7),LENGTH(SUBSTRING_INDEX(commaSeparatedString, ',', 6)) + 1), ',', '');

        END IF;
  END IF; 

  CALL updateLastModifiedDate(value1, value2, value3, value4, value5, value6, value7);

  RETURN 1;
END;
@@

DELIMITER ; 
```

礼貌：

*   [http://dev.mysql.com/doc/refman/5.0/en/string-functions.html#c7359](http://dev.mysql.com/doc/refman/5.0/en/string-functions.html#c7359)
*   [http://dinushasblog.blogspot.in/2010/12/split-strings-in-mysql.html](http://dinushasblog.blogspot.in/2010/12/split-strings-in-mysql.html)
*   [http://blog.fedecarg.com/2009/02/22/mysql-split-string-function/](http://blog.fedecarg.com/2009/02/22/mysql-split-string-function/)

# backbone.js - 获取集合长度

> ID：14527755
> 
> 赞同：9
> 
> 时间：2013-01-25T18:04:57.593
> 
> 标签：backbone.js

使用backbone.js并尝试从`postsList`数组中获取数据我在chrome console.log中得到了这个

```
d {length: 0, models: Array[0], _byId: Object, _byCid: Object, constructor: function…}
  _byCid: Object
  _byId: Object
  length: 9
  models: Array[9]
  __proto__: f 
```

当我尝试使用时`console.log(postsList.length)`，我得到 0，但里面有 9 个模型。我不知道如何获得它们的数量。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-25T19:51:09.387

是的，这是奇怪的行为:)

Chrome 会在您使用后立即显示对象预览`console.log`。当您输入`console.log(collection)`时它是空的（可能您已经从服务器获取模型）。但是，当您在控制台中展开对象时，Chrome 会显示当前的实际对象参数。

在控制台中试试这个：

```
var object = {key1:{prop:true}};
console.log(object)
object.key2 = true;
console.log(object) 
```

要获取集合长度，请使用以下方式：

```
collection.fetch({context:collection}).done(function() {
  console.log(this.length)
}); 
```

## 编辑

不，不，不 :) 使用`this.length`而不是`this.lenght`.

```
collection.fetch({context:collection}).done(function() {
    // equals to this.length
    console.log(this.size());
    // get all models from collection (array of Backbone.Models)
    console.log(this.models);
    // get all models from collection (like simple array of objects)
    console.log(this.toJSON());
    // get model with index 1
    console.log(this.at(1));
    // get model data with index 1
    console.log(this.at(1).toJSON());
    // get model with id `some-id`
    console.log(this.get('some-id'));
    // get models data where property `id_str` equals to `292724698935070722`
    console.log(this.where({id_str:'292724698935070722'}));
}); 
```

更多信息请看这里： [http ://backbonejs.org/#Collection](http://backbonejs.org/#Collection)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-02-18T13:44:40.527

我认为 Vitaliys 的回答有点危险，因为传递的选项`{context: collection}`是：

*   a) 在主干文档中未提及
*   b) 当 fetch 触发一些 Ajax 调用时，在 jQuery 中进行深入处理。

`success-`相反，可以在 fetch 的and`error-`回调中轻松检查获取的集合的长度，例如：

```
someCollection.fetch({
    success: function(collection) { // the fetched collection!
        if (collection.length) {
            // not empty
        } else {
            // empty
        }
    }
}); 
```

请参阅[http://backbonejs.org/#Collection-fetch](http://backbonejs.org/#Collection-fetch)

# java - 如何在运行时覆盖 jar 中的 log4j 属性文件

> ID：14527759
> 
> 赞同：13
> 
> 时间：2013-01-25T18:05:28.877
> 
> 标签：java, unix, jar, log4j

> **可能重复：**
> [动态更改 log4j 日志级别](https://stackoverflow.com/questions/4598702/dynamically-changing-log4j-log-level)

我有一个包含**log4j**属性文件的**jar**文件。我试着用

 **`-Dlog4j.configuration=file:[filename]`

使用 *java在**运行时*更改属性文件，但它不起作用。我需要在*sh*文件中执行此操作 谁能告诉我该怎么做？我也尝试添加

 **```
-Dlog4j.defaultInitOverride=true 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T05:37:33.683

可以在运行时覆盖 log4j 属性文件。如果你不能，你可能会陷入这种情况：

1.  在您的 jar 或代码中的某处，log4j 系统是手动初始化的，例如

    ```
     URL url=loader.getResource(LOGGER_CONFIG_FILE)
     DOMConfigurator.configure(url); 
    ```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-26T05:44:02.037

这是一个很好的分步教程（带有很好的屏幕截图！），它显示了在运行时更改 log4j 设置的几种不同选择：

*   [http://www.avajava.com/tutorials/lessons/how-do-i-change-my-log4j-settings-while-my-web-application-is-running.html](http://www.avajava.com/tutorials/lessons/how-do-i-change-my-log4j-settings-while-my-web-application-is-running.html)****

# asp.net - Where should i put a timer that call a method every 5 minutes

> ID：14527775
> 
> 赞同：0
> 
> 时间：2013-01-25T18:06:45.133
> 
> 标签：asp.net

Where should i put a timer that call a method every 5 minutes ?

i put it in MasterPage but call every time that i load a page that use this MasterPage but i want to call just every 5 minutes

i use this code in MasterPage

```
<body>
    <form id="form1" runat="server">
            <div id="divNews" class="news" runat="server"></div>

            <asp:ScriptManager ID="ScriptManager1" runat="server" />
            <asp:UpdatePanel runat="server" id="UpdatePanel" updatemode="Conditional">
                <ContentTemplate>
                    <div class="divTit">
                        <table style=" width:100%">
                            <tr style=" width:100%; text-align:right;">
                                <td style=" width:100%;"><!--Inbox-->
                                    <asp:LinkButton CssClass="lblMainMenu1" runat="server" ID="lblInbox" OnClick="inbox_Click"></asp:LinkButton>
                                    <asp:Label Text="Inbox :" runat="server" CssClass="lblMainMenu2"></asp:Label>
                                </td>
                            </tr>
                        </table>
                    </div>
                </ContentTemplate>
                <Triggers>
                    <asp:AsyncPostBackTrigger controlid="timer" EventName="Tick" />
                </Triggers>
            </asp:UpdatePanel>

            <asp:Timer Interval="1" ID="timer" OnTick="timer_Tick" runat="server"></asp:Timer>

        <div id="body" class="divBody">
            <asp:ContentPlaceHolder id="head" runat="server"></asp:ContentPlaceHolder>
            <asp:ContentPlaceHolder id="contentMain" runat="server"></asp:ContentPlaceHolder>
        </div>

    </form>
</body> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T18:36:45.177

我不会在一个页面内这样做。如您所见，您无法以这种方式真正可靠地创建长时间运行的计划任务。

做到这一点的最佳方法实际上取决于您想要做什么。

如果您希望每五分钟更新一次浏览器内的页面，您可以在 JavaScript 中设置一个计时器并执行 AJAX 请求以检索更新的内容。或者 - 更简单，但不太干净 - 您可以使用[HTTP-equiv 元属性](http://www.w3schools.com/tags/att_meta_http_equiv.asp)每五分钟刷新一次整个页面。但是，正如链接所述，这违反了一些可访问性规则。此外，如果您有一个用户正在填写的表单，那么当页面刷新时，他们输入的任何信息都将丢失。

如果您尝试触发一些非用户特定的服务器端任务，您可以使用一些不同的路线：

1.  创建一个在服务器上运行的 Windows 服务（可能是您的 Web 服务器，但它可以在任何地方）。您可以将需要每五分钟运行一次的代码直接放入服务中，或者使用[WebClient](http://www.dotnetperls.com/webclient)之类的东西从您的站点请求一个页面，然后执行您需要的任何任务。

2.  创建使用 WebClient 检索页面的控制台应用程序、PowerShell 脚本等，并将其添加到[Windows 任务计划程序](http://windows.microsoft.com/en-US/windows7/schedule-a-task)以使其每隔几分钟运行一次。这样做的好处是不需要您创建服务，如果这是您不熟悉或不熟悉的东西。

3.  与其编写脚本或控制台应用程序，不如使用[wget for Windows](http://gnuwin32.sourceforge.net/packages/wget.htm)等实用程序。使用上面提到的任务计划程序每隔几分钟运行一次，将所需的 URL 指定为命令行参数。这可能是最简单的，但放弃了其他两个选项提供的一些灵活性。

** 更新 ** 如果您只想按照您所说的定期更新页面中的某些内容（检查消息等），这里有[一个非常简单的教程，不需要您在此处创建任何 JavaScript](http://pankajlalwani.wordpress.com/2010/01/19/refresh-content-in-updatepanel-using-asp-net-ajax-timer-control/)。

出于存档完整性的目的，以下是代码：

```
<%@ Page Language="C#" AutoEventWireup="true" CodeFile="Default.aspx.cs" Inherits="_Default" %>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <title>Update Panel and Timer</title>
</head>
<body>
    <form id="form1" runat="server">
        <asp:ScriptManager ID="ScriptManager1" runat="server" />
        <asp:Timer runat="server" id="UpdateTimer" interval="5000"
          ontick="UpdateTimer_Tick" />
        <asp:UpdatePanel runat="server" id="TimedPanel" updatemode="Conditional">
            <Triggers>
                <asp:AsyncPostBackTrigger controlid="UpdateTimer"
                  eventname="Tick" />
            </Triggers>
            <ContentTemplate>
                <asp:Label runat="server" id="lbldatetime" />
            </ContentTemplate>
        </asp:UpdatePanel>
    </form>
</body>
</html> 
```

在代码隐藏中：

```
protected void UpdateTimer_Tick(object sender, EventArgs e)
{  
lbldatetime.Text = DateTime.Now.ToString();
} 
```

# php - 如果列有字符串来执行语法

> ID：14527779
> 
> 赞同：2
> 
> 时间：2013-01-25T18:07:02.263
> 
> 标签：php, sql, if-statement, case

我想知道是否有办法`IF` `ELSE`在 SQL 语法中执行语句，或者是否有人可以帮助我处理`CASE`. 基本上，如果在列中找到文件名（字符串），`file_url`然后更改我想使用辅助信息的位置。我希望我的例子可以帮助进一步解释我想要做什么。

```
 $sql = "SELECT vm.file_url FROM #__virtuemart_medias AS vm 
        INNER JOIN #__virtuemart_product_medias AS pm ON vm.virtuemart_media_id = pm.virtuemart_media_id 
        WHERE pm.virtuemart_product_id = {$product_id} ";

    $result = mysql_query($sql); 
    $row = mysql_fetch_array($result); 
    $FILEURL = $row["vm.file_url"];  
    if ($FILEURL == "thumb_phone01.jpg"){       
            $sql .= "AND pm.ordering = 2";
    }
    else {
        $sql .= "AND pm.ordering = 1";
        }
            $this->_db->setQuery($sql);
            $img = $this->_db->LoadResult();
            return $img;
        } 
```

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T18:16:39.533

一种选择是使用 CASE 和 REGEXP：

```
SELECT vm.file_url FROM #__virtuemart_medias AS vm 
    INNER JOIN #__virtuemart_product_medias AS pm 
            ON vm.virtuemart_media_id = pm.virtuemart_media_id 
    WHERE pm.virtuemart_product_id = {$product_id}
         AND pm.ordering = CASE 
                             WHEN vm.file_url  REGEXP 'thumb_phone01.jpg' 
                                THEN 2 
                                ELSE 1 
                             END 
```

这是[SQL 小提琴](http://sqlfiddle.com/#!2/48c08/1)。

祝你好运。

# c++ - 我可以从opengl的显示调用我的回调函数吗

> ID：14527780
> 
> 赞同：0
> 
> 时间：2013-01-25T18:07:03.320
> 
> 标签：c++, c, multithreading, opengl, callback

我正在尝试从

```
 void display(void){

    my_draw(&here_is_the_actual_drawing);

 }

 void here_is_the_actual_drawing(){

    glVertex2f(x,y);

 } 
```

在主要的opengl循环调用显示..喜欢

```
 glutDisplayFunc(display); 
```

我的问题是我们可以这样做吗？我在我的代码中尝试了它编译但卡住了.. [my_draw 将创建一个线程，将调用 here_is_the_actual_drawing ---- 好的，所以没有线程只是回调]

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T01:15:58.550

> my_draw 将创建一个线程来调用 here_is_the_actual_drawing ---- 好的，所以没有线程只是回调]

您不能简单地*从*任何线程调用 OpenGL 命令。OpenGL 需要一个上下文，每个 OpenGL 上下文一次只能在一个线程中处于活动状态。在线程之间迁移上下文是完全可能的。但是，这要求您完全控制上下文创建和管理。

通过使用（免费）GLUT、GLFW 或 SDL 等简单框架，您无法控制上下文管理。但从技术上讲，这是可能的。

但并非所有可能的事情都有意义。通常将所有 OpenGL 操作保留在单个线程中，准确地说是主 GUI 线程，是最好的解决方案。多线程 OpenGL 仅在极少数情况下有用，即使在非常有限的情况下也是如此。

BTDT（实际上我当前的项目大量使用了多线程 OpenGL）

# tortoisesvn - 如何查看 Tortoise SVN 存储库中所有冲突文件的列表？

> ID：14527784
> 
> 赞同：16
> 
> 时间：2013-01-25T18:07:10.490
> 
> 标签：tortoisesvn, conflict

有没有办法使用 Tortoise SVN 获取处于（SVN）冲突状态的文件列表？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-04-05T20:15:20.267

为此，请右键单击包含您希望查看的冲突的**文件夹**`Resolve...`，然后单击。

![TortoiseSVN 1.8.8 版本的右键菜单](../Images/96701f9e2824f894dceadbd94f686f95.png)

请注意，这是一种副作用，因为此选项（通常）用于将冲突标记为已解决。但是，它也旨在帮助您实际发现和解决冲突。行为如下：

将出现一个窗口，列出所有文件冲突，旁边有复选框。如果你双击一个文件名，Tortoise 会弹出该文件的合并窗口。当您选择了要标记为已解决的文件（使用复选框）后，您可以通过单击“确定”来完成，或者您可以通过单击“取消”直接退出窗口而不更改任何冲突的解决状态。”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-06T09:57:33.813

你不能用 TSVN 做到这一点，但 CLI 接口相当容易。

只需`svn status`在 WC 中使用并检查输出：

```
 The first seven columns in the output are each one character wide:
    First column: Says if item was added, deleted, or otherwise changed
    ...
      'C' Conflicted 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-07-17T13:49:11.773

在“检查修改”里面还有另一个按钮......

![TortoiseSVN 1.8.8 版本的右键菜单](../Images/96701f9e2824f894dceadbd94f686f95.png)

...“检查存储库”它将显示冲突 ![https://tortoisesvn.net/docs/release/TortoiseSVN_en/images/RepoStatus.png](../Images/0ebc1d4f893a67941896f9397f4140d9.png)

这是[我的来源](http://tortoisesvn.net/docs/release/TortoiseSVN_en/tsvn-dug-wcstatus.html)

# asp.net - 带有下拉列表的 ASP.NET 过滤器访问数据库 Gridview

> ID：14527790
> 
> 赞同：1
> 
> 时间：2013-01-25T18:07:46.330
> 
> 标签：asp.net, visual-studio-2010, gridview, webforms

我正在尝试使用下拉列表过滤网格视图。我的 gridview 和下拉列表由 Access 数据库填充。我想要的是当从下拉列表中选择供应商时，它会将产品的网格视图过滤到具有该供应商ID的产品。

我能够填充下拉列表和网格视图，但是当我选择供应商时没有任何反应。

我尝试添加 FilterExpression="SupplierID Like '{0}%'"，但随后页面错误无法在 System.Int32 和 System.String 上执行 'Like' 操作

这是我的代码。

```
<form id="form" runat="server" style="margin:0 auto;">
<asp:DropDownList ID="DropDownList1" runat="server" 
    DataSourceID="AccessDataSource2" DataTextField="Supplier" DataValueField="ID" AutoPostBack="true" AppendDataBoundItems="true">
    <asp:ListItem Text="All" Value="%" />
</asp:DropDownList>
<asp:AccessDataSource ID="AccessDataSource2" runat="server" 
    DataFile="~/App_Data/Hovden Oil Pricing.accdb" 
    SelectCommand="SELECT [Supplier], [ID] FROM [Suppliers] ORDER BY [Supplier]">
</asp:AccessDataSource>
<asp:GridView ID="GridView2" runat="server" AutoGenerateColumns="False" BackColor="White"
    DataSourceID="AccessDataSource1">

    <Columns>
        <asp:BoundField DataField="SupplierID" HeaderText="SupplierID" 
            SortExpression="SupplierID" />
        <asp:BoundField DataField="Product Number" HeaderText="Product Number" 
            SortExpression="Product Number" />
        <asp:BoundField DataField="Product Name" HeaderText="Product Name" 
            SortExpression="Product Name" />
        <asp:BoundField DataField="Product Type" HeaderText="Product Type" 
            SortExpression="Product Type" />
        <asp:CheckBoxField DataField="Bulked" HeaderText="Bulked" 
            SortExpression="Bulked" />
        <asp:BoundField DataField="UOM" HeaderText="UOM" SortExpression="UOM" />
        <asp:BoundField DataField="Multiple" HeaderText="Multiple" 
            SortExpression="Multiple" />
        <asp:BoundField DataField="$/GAL" HeaderText="$/GAL" SortExpression="$/GAL" />
        <asp:BoundField DataField="$/UNIT" HeaderText="$/UNIT" ReadOnly="True" 
            SortExpression="$/UNIT" />
        <asp:BoundField DataField="TypeID" HeaderText="TypeID" 
            SortExpression="TypeID" />
    </Columns>

</asp:GridView>
<asp:AccessDataSource ID="AccessDataSource1" runat="server" 
    DataFile="~/App_Data/Hovden Oil Pricing.accdb" SelectCommand="SELECT [Supplier Products].SupplierID, Products.[Product Number], Products.[Product Name], [Product Types].[Product Type], Products.Bulked, Products.UOM, Products.Multiple, [Bulk Prices].Volume AS [$/GAL], [$/GAL]*[Multiple] AS [$/UNIT], [Product Types].TypeID
    FROM [Product Types] INNER JOIN ((Products INNER JOIN [Supplier Products] ON Products.[Product Number] = [Supplier Products].[Product Number]) INNER JOIN [Bulk Prices] ON (Products.[Product Number] = [Bulk Prices].[Product Number]) AND (Products.[Product Number] = [Bulk Prices].[Product Number])) ON [Product Types].TypeID = Products.[Product Type]
    WHERE (Products.Bulked)=Yes
    ORDER BY Products.[Product Name];" FilterExpression="SupplierID Like '{0}%'">
    <FilterParameters>
        <asp:ControlParameter Name="SupplierID" ControlID="DropDownList1" PropertyName="SelectedValue" />
    </FilterParameters>
</asp:AccessDataSource>
</form> 
```

我错过了什么吗？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T20:32:17.000

这真的很简单，您正在尝试将 int(SupplierID) 与通配符字符串值进行比较，这就是您收到上述错误的原因。

只需将 SupplierID 转换为字符串即可：

```
<asp:AccessDataSource ID="AccessDataSource1" runat="server" 
    DataFile="~/App_Data/Hovden Oil Pricing.accdb" SelectCommand="SELECT [Supplier Products].SupplierID, Products.[Product Number], Products.[Product Name], [Product Types].[Product Type], Products.Bulked, Products.UOM, Products.Multiple, [Bulk Prices].Volume AS [$/GAL], [$/GAL]*[Multiple] AS [$/UNIT], [Product Types].TypeID
    FROM [Product Types] INNER JOIN ((Products INNER JOIN [Supplier Products] ON Products.[Product Number] = [Supplier Products].[Product Number]) INNER JOIN [Bulk Prices] ON (Products.[Product Number] = [Bulk Prices].[Product Number]) AND (Products.[Product Number] = [Bulk Prices].[Product Number])) ON [Product Types].TypeID = Products.[Product Type]
    WHERE (Products.Bulked)=Yes
    ORDER BY Products.[Product Name];" FilterExpression="Convert(SupplierID , 'System.String') LIKE '{0}%'">
    <FilterParameters>
        <asp:ControlParameter Name="SupplierID" ControlID="DropDownList1" PropertyName="SelectedValue" />
    </FilterParameters> 
```

# javascript - What should I get the height() of to make list fill the screen?

> ID：14527791
> 
> 赞同：2
> 
> 时间：2013-01-25T18:07:48.143
> 
> 标签：javascript, jquery

IT WAS THE DEFAULT MARGIN ON THE `<UL>`!! SORRY I've got a list of anywhere between 5 and 20 items and I want to make the whole list fill the height of the screen. So I'm finding the height of `<html>` and dividing it by the number of `<li>`s and setting this number as the height of each `<li>`. The problem is there is this roughly 20px white space at the bottom that comes up after the list. I think I need to find the height of the window or body or something instead. Here is some of my code:

```
var numRootOptions = $('.wrapper > ul > li').size();
var htmlHeight = $('html').height();
var newliHeight = htmlHeight / numRootOptions;
$('.wrapper > ul > li').css('height', newliHeight);
setInterval(function() {
    var htmlHeight = $('html').height();
    var numRootOptions = $('.wrapper > ul > li').size();
    var newLiHeight = htmlHeight / numRootOptions;
    var liHeight = $('.wrapper > ul > li').height();
    if (liHeight != newliHeight) {
        console.log('Different');
    }
}, 2000); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-25T18:09:10.407

try [**innerHeight()**](http://api.jquery.com/innerHeight/) instead of just .`height()`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-25T18:12:47.780

我会说你应该使用`$(window).height()`or`$('html').innerHeight`之前建议的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-25T18:13:55.863

默认边距`<ul>`是问题所在。对不起这个愚蠢的问题！谢谢大家。

# html - Fit the site in iframe

> ID：14527792
> 
> 赞同：0
> 
> 时间：2013-01-25T18:07:56.253
> 
> 标签：html, iframe

I have the following HTML code in which the images can move.

```
<div id="templatemo_slider">
<!-- This is the container for the carousel. -->
    <div id = "carousel1" style="width:960px; height:280px;background:none;overflow:scroll; margin-top: 20px">            
<!-- All images with class of "cloudcarousel" will be turned into carousel items -->
<!-- You can place links around these images -->
        <a href="http://www.templatemo.com/page/1" rel="lightbox"><img class="cloudcarousel" src="images/slider/02.jpg" alt="CSS Templates 2" title="Website Templates 2" /></a>
        <a href="http://www.templatemo.com/page/2" rel="lightbox"><img class="cloudcarousel" src="images/slider/02.jpg" alt="CSS Templates 2" title="Website Templates 2" /></a>
        <a href="http://www.templatemo.com/page/3" rel="lightbox"><img class="cloudcarousel" src="images/slider/03.jpg" alt="CSS Templates 3" title="Website Templates 3" /></a>
        <a href="http://www.templatemo.com/page/4" rel="lightbox"><img class="cloudcarousel" src="images/slider/04.jpg" alt="CSS Templates 4" title="Website Templates 4" /></a>
        <a href="http://www.flashmo.com/page/1" rel="lightbox"><img class="cloudcarousel" src="images/slider/05.jpg" alt="Flash Templates 1" title="Flash Templates 1" /></a>
    </div>

<!-- Define left and right buttons. -->
    <center>
        <input id="slider-left-but" type="button" value="" />
        <input id="slider-right-but" type="button" value="" />
    </center>
</div> 
```

For screenshot link actual :

![enter image description here](../Images/d9c8f8bfa2bec83429be5c04afc8f012.png)

I want to put webpages instead of images.

For that I have tried using

```
<iframe class="cloudcarousel" src="http://www.bookmyshow.com" width = "800px" height ="1000px"></iframe></a> 
```

It shows the image, but is not properly aligned, after putting width in iframe the frame is moving to left and inside the page bookmyshow is coming incomplete"

Screenshot Link error:

![enter image description here](../Images/53fe369ffb982f62ec4f6cdacd129d6e.png)

# ruby - How do I send an arbitrary number of arguments to a method without using a hash?

> ID：14527794
> 
> 赞同：0
> 
> 时间：2013-01-25T18:08:03.593
> 
> 标签：ruby, http, refactoring

I'm working with Curb, a ruby wrapper around cURL.

I want to start by saying that I know methods such as method missing can accept arbitrary number args and a block if defined like so:

```
def method_missing(meth, *args, &block); ... end 
```

`*args` is an array of parameters.

Now, I'm trying to refactor my calls to the HTTP GET, POST, etc methods, by doing the following with Curb:

```
req = Curl::Easy.send("http_#{method.to_s}", *args) do |curl| ... end 
```

where `args` could be either 1 parameter or 2 parameters, which I'm trying to define as follows:

```
args = [url]
args << data if data 
```

But I get an error when I invoke the `Curl::Easy.send` line.

```
both block arg and actual block given 
```

here are some examples of the methods I'm trying to access from (https://github.com/taf2/curb/blob/master/lib/curl/easy.rb):

```
 def http_get(*args)
        c = Curl::Easy.new *args
        yield c if block_given?
        c.http_get
        c
      end 

      def http_put(url, data)
        c = Curl::Easy.new url
        yield c if block_given?
        c.http_put data
        c
      end

      def http_post(*args)
        url = args.shift
        c = Curl::Easy.new url
        yield c if block_given?
        c.http_post *args
        c
      end

      def http_delete(*args)
        c = Curl::Easy.new *args
        yield c if block_given?
        c.http_delete
        c
      end 
```

all of them are set up to take arbitrary number of arguments, except put. But, really, for `http_get` I only need to pass a URL (with query params in the URL). so, I only want to pass one parametr for `http_get`, and 2 params for the others.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-08-28T19:29:29.490

如果我对您的理解正确，您希望根据方法的参数数量发送 x 个参数。以下将根据给定的数据工作。

```
method_name = "http_#{method.to_s}"
params = Curl::Easy.method(:"#{method_name}").parameters
req = Curl::Easy.send("http_#{method.to_s}", *(args[0..(params.size-1)])) do |curl| ... end``` 
```

但是，您出现的错误是当您将 Proc 作为参数发送并传递一个块时，它会按照您的要求执行，但是如果没有堆栈跟踪来缩小范围，我认为这不会解决您的错误。IE。

```
irb(main):001:0> def tst(&block)
irb(main):002:1> end
=> nil
irb(main):003:0> arg = Proc.new { }
=> #<Proc:0x00000002cd6930@(irb):3>
irb(main):004:0> tst(&arg) do
irb(main):005:1* end
SyntaxError: (irb):5: both block arg and actual block given 
```

作为旁注，#parameters 返回类似的`[[:rest][:args]]`内容，并且 :rest 表示其余参数，因此您始终可以对参数进行更多检查以提供更细粒度的参数。

# android - android.media.MediaExtractor. Anyone got this beast to work? "Failed to instantiate extractor" exception

> ID：14527797
> 
> 赞同：2
> 
> 时间：2013-01-25T18:08:23.420
> 
> 标签：android, video-streaming, media, video-capture, transcoding

Trying to run this (example code from developer.android.com)

```
MediaExtractor extractor = new MediaExtractor();
extractor.setDataSource("/sdcard/myvideo.mp4"); 
```

Getting "Failed to instantiate extractor" exception on the second line. Tried to place the file in internal storage, tried to access via FileDescriptor, nothing helped.

Anyone??

```
I/MonoDroid( 6802): UNHANDLED EXCEPTION: Java.IO.IOException: Exception of type 'Java.IO.IOException' was thrown.
I/MonoDroid( 6802): at Android.Runtime.JNIEnv.CallVoidMethod (intptr,intptr,Android.Runtime.JValue[]) [0x00023] in /Users/builder/data/lanes/monodroid-mac-monodroid-4.4-series/c6e52015/source/monodroid/src/Mono.Android/src/Runtime/JNIEnv.g.cs:368
I/MonoDroid( 6802): at Android.Media.MediaExtractor.SetDataSource (Java.IO.FileDescriptor) [0x0002d] in /Users/builder/data/lanes/monodroid-mac-monodroid-4.4-series/c6e52015/source/monodroid/src/Mono.Android/platforms/android-16/src/generated/Android.Media.MediaExtractor.cs:206
I/MonoDroid( 6802): at AndroidApplication1.Activity1.ExtractVideo () [0x0001e] in c:\Users\pka\Documents\Visual Studio 2012\Projects\AndroidApplication1\AndroidApplication1\Activity1.cs:64
I/MonoDroid( 6802): at AndroidApplication1.Activity1.<OnCreate>b__2 (object,System.EventArgs) [0x00001] in c:\Users\pka\Documents\Visual Studio 2012\Projects\AndroidApplication1\AndroidApplication1\Activity1.cs:53
I/MonoDroid( 6802): at Android.Views.View/IOnClickListenerImplementor.OnClick (Android.Views.View) [0x0000b] in /Users/builder/data/lanes/monodroid-mac-monodroid-4.4-series/c6e52015/source/monodroid/src/Mono.Android/platforms/android-16/src/generated/Android.Views.View.cs:1382
I/MonoDroid( 6802): at Android.Views.View/IOnClickListenerInvoker.n_OnClick_Landroid_view_View_ (intptr,intptr,intptr) [0x00010] in /Users/builder/data/lanes/monodroid-mac-monodroid-4.4-series/c6e52015/source/monodroid/src/Mono.Android/platforms/android-16/src/generated/Android.Views.View.cs:1353
I/MonoDroid( 6802): at (wrapper dynamic-method) object.0b69082c-1c66-4fd6-89c4-1d14273d4245 (intptr,intptr,intptr) <IL 0x00017, 0x00043>
I/MonoDroid( 6802): 
I/MonoDroid( 6802):   --- End of managed exception stack trace ---
I/MonoDroid( 6802): java.io.IOException: Failed to instantiate extractor.
I/MonoDroid( 6802):     at android.media.MediaExtractor.setDataSource(Native Method)
I/MonoDroid( 6802):     at android.media.MediaExtractor.setDataSource(MediaExtractor.java:158)
I/MonoDroid( 6802):     at mono.android.view.View_OnClickListenerImplementor.n_onClick(Native Method)
I/MonoDroid( 6802):     at mono.android.view.View_OnClickListenerImplementor.onClick(View_OnClickListenerImplementor.java:29)
I/MonoDroid( 6802):     at android.view.View.performClick(View.java:4211)
I/MonoDroid( 6802):     at android.view.View$PerformClick.run(View.java:17267)
I/MonoDroid( 6802):     at android.os.Handler.handleCallback(Handler.java:615)
I/MonoDroid( 6802):     at android.os.Handler.dispatchMessage(Handler.java:92)
I/MonoDroid( 6802):     at android.os.Looper.loop(Looper.java:137)
I/MonoDroid( 6802):     at android.app.ActivityThread.main(ActivityThread.java:4898)
I/MonoDroid( 6802):     at java.lang.reflect.Method.invokeNative(Native Method)
I/MonoDroid( 6802):     at java.lang.reflect.Method.invoke(Method.java:511)
I/MonoDroid( 6802):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:1006)
I/MonoDroid( 6802):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:773)
I/MonoDroid( 6802):     at dalvik.system.NativeStart.main(Native Method)
W/dalvikvm( 6802): JNI WARNING: JNI method called with exception pending
W/dalvikvm( 6802):              in Lmono/android/view/View_OnClickListenerImplementor;.n_onClick:(Landroid/view/View;)V (CallObjectMethod)
W/dalvikvm( 6802): Pending exception is:
I/dalvikvm( 6802): java.io.IOException: Failed to instantiate extractor.
I/dalvikvm( 6802):   (raw stack trace not found)
I/dalvikvm( 6802): "main" prio=5 tid=1 NATIVE
I/dalvikvm( 6802):   | group="main" sCount=0 dsCount=0 obj=0x41094508 self=0x40e6f9a0
I/dalvikvm( 6802):   | sysTid=6802 nice=0 sched=0/0 cgrp=apps handle=1074282288
I/dalvikvm( 6802):   | schedstat=( 1587575495 261759711 782 ) utm=108 stm=50 core=3
I/dalvikvm( 6802):   #00  pc 00001260  /system/lib/libcorkscrew.so (unwind_backtrace_thread+27)
I/dalvikvm( 6802):   #01  pc 0005f904  /system/lib/libdvm.so (dvmDumpNativeStack(DebugOutputTarget const*, int)+35)
I/dalvikvm( 6802):   #02  pc 000537ac  /system/lib/libdvm.so (dvmDumpThreadEx(DebugOutputTarget const*, Thread*, bool)+303)
I/dalvikvm( 6802):   #03  pc 00053846  /system/lib/libdvm.so (dvmDumpThread(Thread*, bool)+25)
I/dalvikvm( 6802):   #04  pc 00038e02  /system/lib/libdvm.so
I/dalvikvm( 6802):   #05  pc 00040f60  /system/lib/libdvm.so
I/dalvikvm( 6802):   at mono.android.view.View_OnClickListenerImplementor.n_onClick(Native Method)
I/dalvikvm( 6802):   at mono.android.view.View_OnClickListenerImplementor.onClick(View_OnClickListenerImplementor.java:29)
I/dalvikvm( 6802):   at android.view.View.performClick(View.java:4211)
I/dalvikvm( 6802):   at android.view.View$PerformClick.run(View.java:17267)
I/dalvikvm( 6802):   at android.os.Handler.handleCallback(Handler.java:615)
I/dalvikvm( 6802):   at android.os.Handler.dispatchMessage(Handler.java:92)
I/dalvikvm( 6802):   at android.os.Looper.loop(Looper.java:137)
I/dalvikvm( 6802):   at android.app.ActivityThread.main(ActivityThread.java:4898)
I/dalvikvm( 6802):   at java.lang.reflect.Method.invokeNative(Native Method)
I/dalvikvm( 6802):   at java.lang.reflect.Method.invoke(Method.java:511)
I/dalvikvm( 6802):   at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:1006)
I/dalvikvm( 6802):   at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:773)
I/dalvikvm( 6802):   at dalvik.system.NativeStart.main(Native Method)
I/dalvikvm( 6802): 
E/dalvikvm( 6802): VM aborting
I/mono    ( 6802): Stacktrace:
I/mono    ( 6802): 
I/mono    ( 6802):   at Android.Runtime.JNIEnv.CallObjectMethod (intptr,intptr) [0x00000] in /Users/builder/data/lanes/monodroid-mac-monodroid-4.4-series/c6e52015/source/monodroid/src/Mono.Android/src/Runtime/JNIEnv.g.cs:129
I/mono    ( 6802):   at Java.Lang.Throwable.get_Message () [0x0003e] in /Users/builder/data/lanes/monodroid-mac-monodroid-4.4-series/c6e52015/source/monodroid/src/Mono.Android/platforms/android-16/src/generated/Java.Lang.Throwable.cs:195
I/mono    ( 6802):   at (wrapper runtime-invoke) <Module>.runtime_invoke_object__this__ (object,intptr,intptr,intptr) <IL 0x00050, 0xffffffff>
E/mono    ( 6802): 
E/mono    ( 6802): Unhandled Exception:
E/mono    ( 6802): Java.IO.IOException: Exception of type 'Java.IO.IOException' was thrown.
E/mono    ( 6802): at Android.Runtime.JNIEnv.CallVoidMethod (intptr,intptr,Android.Runtime.JValue[]) [0x00023] in /Users/builder/data/lanes/monodroid-mac-monodroid-4.4-series/c6e52015/source/monodroid/src/Mono.Android/src/Runtime/JNIEnv.g.cs:368
E/mono    ( 6802): at Android.Media.MediaExtractor.SetDataSource (Java.IO.FileDescriptor) [0x0002d] in /Users/builder/data/lanes/monodroid-mac-monodroid-4.4-series/c6e52015/source/monodroid/src/Mono.Android/platforms/android-16/src/generated/Android.Media.MediaExtractor.cs:206
E/mono    ( 6802): at AndroidApplication1.Activity1.ExtractVideo () [0x0001e] in c:\Users\pka\Documents\Visual Studio 2012\Projects\AndroidApplication1\AndroidApplication1\Activity1.cs:64
E/mono    ( 6802): at AndroidApplication1.Activity1.<OnCreate>b__2 (object,System.EventArgs) [0x00001] in c:\Users\pka\Documents\Visual Studio 2012\Projects\AndroidApplication1\AndroidApplication1\Activity1.cs:53
E/mono    ( 6802): at Android.Views.View/IOnClickListenerImplementor.OnClick (Android.Views.View) 
I/mono    ( 6802): [ERROR] FATAL UNHANDLED EXCEPTION: Java.IO.IOException: Exception of type 'Java.IO.IOException' was thrown.
I/mono    ( 6802): at Android.Runtime.JNIEnv.CallVoidMethod (intptr,intptr,Android.Runtime.JValue[]) [0x00023] in /Users/builder/data/lanes/monodroid-mac-monodroid-4.4-series/c6e52015/source/monodroid/src/Mono.Android/src/Runtime/JNIEnv.g.cs:368
I/mono    ( 6802): at Android.Media.MediaExtractor.SetDataSource (Java.IO.FileDescriptor) [0x0002d] in /Users/builder/data/lanes/monodroid-mac-monodroid-4.4-series/c6e52015/source/monodroid/src/Mono.Android/platforms/android-16/src/generated/Android.Media.MediaExtractor.cs:206
I/mono    ( 6802): at AndroidApplication1.Activity1.ExtractVideo () [0x0001e] in c:\Users\pka\Documents\Visual Studio 2012\Projects\AndroidApplication1\AndroidApplication1\Activity1.cs:64
I/mono    ( 6802): at AndroidApplication1.Activity1.<OnCreate>b__2 (object,System.EventArgs) [0x00001] in c:\Users\pka\Documents\Visual Studio 2012\Projects\AndroidApplication1\AndroidApplication1\Activity1.cs:53
I/mono    ( 6802): at Android.Views.View/IOnClickListenerImplementor.OnClick (Android
V/MediaPlayerService( 1901): Delete media recorder client
D/ISecCameraHardware( 1901): stopPreview E
W/ISecCameraHardware( 1901): stopPreview: warning, preview has been stopped
I/SurfaceFlinger( 1898): id=23 Removed TurfaceView idx=2 MapSz=3
D/ISecCameraHardware( 1901): cancelPicture EX
D/SecCameraHardware( 1901): release E
D/ISecCameraHardware( 1901): Camera.... release
W/InputDispatcher( 2253): channel ~ Consumer closed input channel or an error occurred.  events=0x9 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-28T13:52:39.117

我是个白痴......我的程序的另一部分打开了提取器应该读取的同一个文件......

来自Android的相当糟糕的错误消息。

# ios - iOS loading custom fonts dynamically error collection retain

> ID：14527798
> 
> 赞同：1
> 
> 时间：2013-01-25T18:08:27.860
> 
> 标签：ios, fonts

Single stepping until exit from function `__CFTypeCollectionRetain`

```
 NSData *inData =[[NSData alloc] initWithContentsOfFile:@"NafeesWeb.ttf"]; /* your decrypted font-file data */;
    CFErrorRef error;
    CGDataProviderRef provider = CGDataProviderCreateWithCFData((CFDataRef)inData);
    CGFontRef font = CGFontCreateWithDataProvider(provider);
    if (! CTFontManagerRegisterGraphicsFont(font, &error)) {
        CFStringRef errorDescription = CFErrorCopyDescription(error);
        NSLog(@"Failed to load font: %@", errorDescription);
        CFRelease(errorDescription);
    }
    CFRelease(font);
    CFRelease(provider); 
```

I also want to unregister this font after use.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T19:13:23.463

您是否尝试过单步执行或记录`inData`以确保它不是`nil`？

您应该使用绝对路径`initWithContentsOfFile:`，因此您可能不会首先加载数据。

尝试：`NSData *inData =[[NSData alloc] initWithContentsOfFile:[[NSBundle mainBundle] pathForResource:@"NafeesWeb" ofType:@"ttf"]];`

# xml - 与 xmlstarlet 苦苦挣扎

> ID：14527801
> 
> 赞同：2
> 
> 时间：2013-01-25T18:08:35.723
> 
> 标签：xml, xmlstarlet

我有一个非常简单的 XML 文件，需要用 xmlstarlet 解析（我在 Windows 下）：

```
<?xml version="1.0" encoding="utf-8"?>
<Document xmlns="urn:iso:std:iso:20022:tech:xsd:pain.001.001.02" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <pain.001.001.02>
    <GrpHdr>
      <MsgId>IDENTIFYER</MsgId>
      <CreDtTm>2013-01-25T11:15:02</CreDtTm>
      <NbOfTxs>6</NbOfTxs>
      <CtrlSum>6268.07</CtrlSum>
      <Grpg>MIXD</Grpg>
    </GrpHdr>
   <PmtInf>
   </PmtInf>
  </pain.001.001.02>
</Document> 
```

假设我想检索 CtrlSum 元素；当我尝试时它失败了

```
xml sel -t -m "/Document/pain.001.001.02/GrpHdr" -v CtrlSum myfile.xml 
```

但是，如果我从文件中删除 xmlns 和 xmlns:xsi 属性，它就可以工作（但在现实生活中我不能这样做）。我知道我必须使用 -N 选项，但我不知道该怎么做。任何帮助都将非常有价值。

非常感谢 Laurent（或 Lawrence，或 Larry :)）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-26T02:33:37.303

该`xmlns`属性定义了默认命名空间，您在 XML 文件中看到的每个没有前缀的元素（恰好是您发布的示例中的所有元素）都使用默认命名空间。XPath 不允许默认命名空间，因此您必须使用 -N 为其分配前缀并在匹配时使用它：

```
xml sel -N p=urn:iso:std:iso:20022:tech:xsd:pain.001.001.02 -t -v /p:Document/p:pain.001.001.02/p:GrpHdr/p:CtrlSum myfile.xml 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-06-28T18:12:01.073

从版本 1.2.1 开始，您可以使用 de default 命名空间`_`
（删除`-N`参数）

```
xml sel -t -m "/_:Document/_:pain.001.001.02/_:GrpHdr" -v CtrlSum myfile.xml 
```

[如此处](http://xmlstar.sourceforge.net/doc/UG/ch05.html)所述：

> 1.3\. 更方便的解决方案
> 
> XML 文档还可以在文档中的任何元素上使用不同的名称空间前缀。为了更轻松地处理命名空间，XMLStarlet（1.2.1+ 版本）将使用在输入文档的根元素上声明的命名空间前缀。默认命名空间将绑定到前缀“_”和“DEFAULT”（在 1.5.0+ 版本中）。

# php - Javascript contact form submit post

> ID：14527803
> 
> 赞同：-1
> 
> 时间：2013-01-25T18:08:43.820
> 
> 标签：php, javascript, forms

I am trying to validate an email field and if valid submit my form. But the form is giving me an error when i submit it to the server. If i submit it with a submit button it works fine.

```
<script>

function ValidateEmail(inputText)  
{  
var mailformat = /^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/;  
if(inputText.value.match(mailformat))  
{  
document.form1.submit();
}  
else  
{  
alert("You have entered an invalid email address!");  
document.form1.email.focus();  
return false;  
}  
}  

</script>

<form action="mailer.php" id="form1"   name="form1" method="POST">

  <input type="text"  size="19" name="name"/>
<input type="text"  size="19" name="phone"/>
<input type="text"  size="19" name="email"/>

    <a  onclick="ValidateEmail(document.form1.email)" href="#">Submit</a>

</p>
</form>

<?php
if(isset($_POST['submit'])) {

$to = "marshal@smedia.ca"; 
$to2 = $_POST['email'];
$subject = "Lead Gen";
$subject2 = "Coupon2";
$first_field = $_POST['name'];
$email_field = $_POST['email'];
$phone_field = $_POST['phone'];
$headers .= "Content-type: text/html\r\n"; 
$headers .= 'From: Nurray GM <welcome@mycompany.com>' . "\r\n";

$body = "

From: $first_field \n   

E-Mail: $email_field\n 

Phone Number: $phone_field\n ";

$body2 = "

<html>
 <body bgcolor='#DCEEFC'>
    <p>Hello  $first_field,</p> 

    <p>Thank you for applying for pre approval. balbalblah.</p> 

  <img src='www.smedia.ca/clients/leadgen/murray/coupon.jpg' width='500px' height='200px' />

  </body>
</html> 

";

mail($to, $subject, $body, $headers);

mail($to2, $subject2, $body2, $headers );

header("Location: http://www.smedia.ca/clients/leadgen/murray/redirect.html");  
} else {
echo "Sorry - something seems to be wrong. Your message was not sent";
}

?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T18:10:31.217

You shouldn't do it that way. You should attach the validate function to onsubmit event of the form, and decline submitting if there are issues (by returning false or preventing the default behaviour).

```
<form action="mailer.php" id="form1" onsubmit="return mysubmitcheck()"
      name="form1" method="POST"> 
```

.

```
function mysubmitcheck() { if (...) return true; else return false; } 
```

That's the way it was done with pure javascript, and it still works. You should, instead of `a` link, have a regular submit button for submitting forms.

Nowadays people do the same with jquery (like explained [here](https://stackoverflow.com/questions/2360557/submitting-a-form-using-jquerys-validate-function)), but if you're not using jquery anywhere else it doesn't add special value here.

Attaching to events such as `onsubmit` can also be done so that it wouldn't pollute HTML, like

```
window.onload = function() {
  // find the form
  form.onsubmit = mysubmitcheck;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T18:14:29.117

如果您坚持在链接上使用内联脚本，请更改

```
<a  onclick="ValidateEmail(document.form1.email)" href="#">Submit</a> 
```

至

```
<a onclick="ValidateEmail(document.form1.email); return false" href="#">Submit</a> 
```

避免重新加载页面

这是我会怎么做

```
var mailformat = /^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/;  
window.onload=function() {
  document.getElementById("form1").onsubmit=function() {
    if(!this.email.value.match(mailformat)) {  
     alert("You have entered an invalid email address!");  
     this.email.focus();  
     return false;  
    }
    return true;  
  } 
} 
```

并使用 an`<input type="submit" />`而不是链接。如果您希望它看起来像一个链接，我们可以将按钮样式设置为

# c# - 序列化名为“return”的 JSON 对象

> ID：14527804
> 
> 赞同：4
> 
> 时间：2013-01-25T18:08:51.303
> 
> 标签：c#, json, json.net

我正在尝试针对 Mt Gox 的 Http API 编写代码。它返回如下所示的 JSON：

```
{
"result":"success",
"return":
 {
 "high": {"value":"5.70653","value_int":"570653","display":"$5.70653","currency":"USD"},
 "low": {"value":"5.4145","value_int":"541450","display":"$5.41450","currency":"USD"},
 "avg": {"value":"5.561119626","value_int":"556112","display":"$5.56112","currency":"USD"},
 "vwap": {"value":"5.610480461","value_int":"561048","display":"$5.61048","currency":"USD"},
 "vol": {"value":"55829.58960346","value_int":"5582958960346","display":"55,829.58960346\u00a0BTC","currency":"BTC"},
 "last_all":{"value":"5.5594","value_int":"555940","display":"$5.55940","currency":"USD"},
 "last_local":{"value":"5.5594","value_int":"555940","display":"$5.55940","currency":"USD"},
 "last_orig":{"value":"5.5594","value_int":"555940","display":"$5.55940","currency":"USD"},
 "last":{"value":"5.5594","value_int":"555940","display":"$5.55940","currency":"USD"},
 "buy":{"value":"5.53587","value_int":"553587","display":"$5.53587","currency":"USD"},
 "sell":{"value":"5.56031","value_int":"556031","display":"$5.56031","currency":"USD"}
 }
} 
```

我正在尝试将该信息转换为一个对象。我制作了一组如下所示的类：

```
[DataContract]
class MtGoxResponse
{
    public string result { get; set; }
    [DataMember(Name="return")]
    public Resp Resp { get; set; }
}

[DataContract]
class Resp
{
    public HLA high { get; set; }
    public HLA low { get; set; }
    public HLA avg { get; set; }
    public HLA vwap { get; set; }
    public HLA vol { get; set; }
    public HLA last_all { get; set; }
    public HLA last_local { get; set; }
    public HLA last_orig { get; set; }
    public HLA last { get; set; }
    public HLA buy { get; set; }
    public HLA sell { get; set; }
}

[DataContract]
class HLA
{
    public double value { get; set; }
    public int value_int { get; set; }
    public string display { get; set; }
    public string currency { get; set; }
} 
```

`Result`每次都很好，但`Resp`总是为空。我是否缺少具有`DataContract`属性的东西？我假设根本原因是对象的名称，但肯定有办法解决它。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-25T18:21:11.543

我不确定你的`[DataMember]`属性为什么不起作用。从我读过的内容`[DataMember]`来看，每个序列化程序的实现似乎都有不同的解释，所以它很可能是一个错误。

`@`但是，您可以通过简单地使用before 符号来消除使用它的需要`return`，如下所示：

```
[DataContract]
class MtGoxResponse
{
    public string result { get; set; }
    public Resp @return { get; set; }
} 
```

这个前缀在 MSDN 的[C# 关键字](http://msdn.microsoft.com/en-gb/library/x53a06bb.aspx)页面上有些被动地提及。

# android - 列表视图中的搜索功能

> ID：14527812
> 
> 赞同：0
> 
> 时间：2013-01-25T18:09:28.073
> 
> 标签：android, listview, search

我在向我的 ListView 添加搜索功能时遇到了一些问题。我想这样做，以便用户可以搜索 ListView 可点击的所需项目。我已经创建了一个没有可点击实现的搜索 ListView。我尝试使用 EditText 和 TextChangedListener 添加搜索。这对于普通的 ListView 工作正常，但是当我单击列表视图的一项时没有任何反应。我知道我必须为列表视图中的每一行添加意图（例如法拉利），但是我如何实现意图？有任何想法吗

```
public class Main extends Activity {

private ListView lv;

ArrayAdapter<String> adapter;

EditText inputSearch;

ArrayList<HashMap<String, String>> modelist;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    String modeller[] = {"Ferrari","Renault","Porche",};

    lv = (ListView) findViewById(R.id.list_view);
    inputSearch = (EditText) findViewById(R.id.inputSearch);

    adapter = new ArrayAdapter<String>(this, R.layout.list_item, R.id.model_ismi, modeller);
    lv.setAdapter(adapter);

    inputSearch.addTextChangedListener(new TextWatcher() {

        @Override
        public void onTextChanged(CharSequence cs, int arg1, int arg2, int arg3) {

            Main.this.adapter.getFilter().filter(cs);
        }

        @Override
        public void beforeTextChanged(CharSequence arg0, int arg1, int arg2,
                int arg3) {

        }

        @Override
        public void afterTextChanged(Editable arg0) {

        }
    });
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T18:17:05.627

试试这个 ：

```
lv.setOnItemClickListener(new OnItemClickListener(){ 
            @Override
            public void onItemClick(AdapterView<?> parent, View view,int position, long _id){
                switch(position){
                    case 0: // "Ferrari"
                        Intent intent_ferrari=new Intent(Main .this,Ferrari.class);
                        startActivity(intent_ferrari);
                        break;
                    case 1: // "Renault"
                        break;
                    case 2: // "Porche"
                        break;
                    default:
                        break;
                }
            }
}); 
```

# algorithm - 旅行商问题中的起点和终点如何确定？

> ID：14527815
> 
> 赞同：12
> 
> 时间：2013-01-25T18:09:34.963
> 
> 标签：algorithm, traveling-salesman

我有一个求解正常对称 TSP 问题的求解器。该解决方案意味着通过所有节点的最短路径，不限制路径中的第一个节点和最后一个节点。

有没有办法转换问题，以确保一个特定的节点作为开始节点，另一个节点作为结束节点？

一种方法是将 I - 一个非常大的距离 - 添加到这些开始/结束节点和所有其他节点之间的所有距离（将 I 两次添加到开始和结束节点之间的距离），因此求解器很想只访问它们一次（从而使它们成为路径的起点和终点）。

这种方法有什么大的缺点，还是有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-01-25T18:40:10.113

您可以添加一个虚拟节点，它连接到具有权重0的边的开始和结束节点。由于TSP必须包含虚拟节点，因此最终结果必须包含序列开始 - 虚拟节点 - 结束（没有其他方法可以达到虚拟节点）。因此，您可以获得具有指定起点和终点节点的最短哈密尔顿路径。即使图中的边缘为负，此解决方案也应该有效。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2019-12-16T09:52:33.460

下面是“虚拟节点”概念的可视化。左边是一个正常的 TSP，具有相同的开始和结束节点 A，以及最优解 [A, B, E, D, C, A]。右边是同一个TSP，但是起始节点是A，结束节点是E。它的最优解[A,B,C,D,E]显然与正常情况下的那个没有关系。我们可以找到解决方案的方法是“破解” TSP 图的距离矩阵。在距离矩阵的底部插入虚拟节点，它到节点 A 和 E 的距离设置为 0，它到所有其他节点的距离设置为 inf。当求解器尝试搜索距离矩阵以找到节点 A、DUMMY、E 的最优序列时，将保持在一起，例如 [A, B, C, D, E, DUMMY, A]，然后可以清理给出 [A, B, C, D, E]。

[![在此处输入图像描述](../Images/e60c31fa2c720c3863ced22b410cc062.png)](https://i.stack.imgur.com/uM1eY.png)

PS。请注意，这种类型的 hack 会对精确求解器的性能产生严重影响。精确的 TSP 求解器设置有各种几何启发式，并且输入零距离和非距离距离显然会与此混淆。例如，我为协和飞机尝试了这个，但它对此并不满意，有时需要更多时间来找到最佳解决方案。没有找到任何文档来处理这种特定情况，但也许还有其他有能力处理这种特定情况的精确求解器。

# jruby - Myapp::Application::Railties constant missing with Rails 4 beta and Jruby jruby-1.7.2

> ID：14527816
> 
> 赞同：6
> 
> 时间：2013-01-25T18:09:39.850
> 
> 标签：jruby, jrubyonrails, ruby-on-rails-4

I couldn't get jruby to work with Rails 4 without a hack:

In railties/lib/rails/engine.rb, I had to initialize Railties with const_get, otherwise

```
def railties
  @railties ||= self.class.const_get(:Railties).new
  # @railties ||= self.class::Railties.new
 end 
```

Otherwise I get this:

./bin/rake rake aborted! uninitialized constant Myapp::Application::Railties org/jruby/RubyModule.java:2677:in `const_missing' /Volumes/Opt/rails/rails-edge/railties/lib/rails/engine.rb:469:in`railties' /Volumes/Opt/rails/rails-edge/railties/lib/rails/application.rb:241:in `run_tasks_blocks' /Volumes/Opt/rails/rails-edge/railties/lib/rails/engine.rb:444:in`load_tasks' org/jruby/RubyBasicObject.java:1659:in `__send__' org/jruby/RubyKernel.java:2086:in`send' /Volumes/Opt/rails/rails-edge/railties/lib/rails/railtie/configurable.rb:30:in `method_missing' /Volumes/Opt/projects/myapp/Rakefile:6:in`(root)' org/jruby/RubyKernel.java:1046:in `load'

Rails itself won't start up for the same reason. Is this the correct fix or did I mask some underlying problem?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-25T21:55:50.487

并没有真正解决问题，但我补充说

```
Rails::Engine.class_eval do
  def railties
    @railties ||= self.class.const_get(:Railties).new
  end
end 
```

下`Bundler.require`in`application.rb`以避免更改原始文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-22T08:50:14.513

这似乎已通过向 Rails master 提交（对引擎的小改动）得到修复：[https ://github.com/rails/rails/commit/45aabe61520cbb4bd74f6de7dc1023d2ca071e40](https://github.com/rails/rails/commit/45aabe61520cbb4bd74f6de7dc1023d2ca071e40)

我刚刚补充说：

```
gem 'rails', :git => 'git://github.com/rails/rails.git' 
```

要不就

```
gem 'rails', github: 'rails/rails' 
```

到我的 Gemfile 来下载最新版本的 Rails，这样就成功了。能够删除亚历克斯（很好 - 谢谢！）的黑客攻击，一切正常。

# git - 将已删除的现有远程添加到 git 存储库

> ID：14527817
> 
> 赞同：1
> 
> 时间：2013-01-25T18:09:40.420
> 
> 标签：git, repository, git-remote

我不小心执行了`git remote rm <remote_repo_name>`:(`git remote add remote_repo_name <remote_repo_path>`即使遥控器之前已经推送过内容，是否会将其添加回遥控器？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T18:16:47.470

是的。

`git remote add`只是告诉您的存储库有关远程存储库的信息。它对该回购的*内容*没有任何作用。逆运算也是`git remote rm`如此。`git remote add`

当你执行 a`git fetch`时，git 会很聪明，不会再次下载你在本地已经拥有的东西。这是 git 如何在后台工作的结果，与您的问题并不真正相关；您应该只知道意外移除遥控器并没有丢失任何东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T18:18:18.897

是的！

当您删除遥控器时，git 只是将其从已知遥控器列表（位于`.gitconfig`）中删除。再次添加它将执行完全相反的操作。

您的远程引用（`origin/master`等等）在任何情况下都不会被修改，并且您推送内容的事实没有任何关系。

# python - 回溯显示直到装饰器

> ID：14527819
> 
> 赞同：12
> 
> 时间：2013-01-25T18:09:57.007
> 
> 标签：python, decorator, traceback

这个漂亮的小 Python 装饰器可以配置禁用装饰函数：

```
enabled = get_bool_from_config()

def run_if_enabled(fn):
    def wrapped(*args, **kwargs):
        try:
            return fn(*args, **kwargs) if enabled else None
        except Exception:
            log.exception('')
            return None
    return wrapped 
```

唉，如果在回溯中引发异常，则`fn()`仅显示到包装器：

```
Traceback (most recent call last):
  File "C:\my_proj\run.py", line 46, in wrapped
    return fn(*args, **kwargs) if enabled else None
  File "C:\my_proj\run.py", line 490, in a_decorated_function
    some_dict['some_value']
KeyError: 'some_value' 
```

1.  为什么？
2.  我可以解决方法来查看完整的回溯吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-25T18:33:36.547

啊! 好的，现在这是一个有趣的问题！

这是相同的近似函数，但直接从以下位置获取异常`sys.exc_info()`：

```
import sys
import traceback

def save_if_allowed(fn):
    def wrapped(*args, **kwargs):
        try:
            return fn(*args, **kwargs) if enabled else None
        except Exception:
            print "The exception:"
            print "".join(traceback.format_exception(*sys.exc_info()))
            return None
    return wrapped

@save_if_allowed
def stuff():
    raise Exception("stuff")

def foo():
    stuff()

foo() 
```

确实如此：打印的回溯中不包含更高的堆栈帧：

```
$蟒蛇测试.py
例外：
回溯（最近一次通话最后）：
  文件“x.py”，第 21 行，已包装
    如果启用则返回 fn(*args, **kwargs) 否则无
  文件“x.py”，第 29 行，in stuff
    引发异常（“东西”）
例外：东西

```

现在，为了缩小这个范围，我怀疑它正在发生，因为堆栈帧只包含直到最近`try/except`块的堆栈信息......所以我们应该能够在没有装饰器的情况下重新创建它：

```
$ cat test.py
def inner():
    raise Exception("inner")

def outer():
    try:
        inner()
    except Exception:
        print "".join(traceback.format_exception(*sys.exc_info()))

def caller():
    outer()

caller()

$ python test.py
Traceback (most recent call last):
  File "x.py", line 42, in outer
    inner()
  File "x.py", line 38, in inner
    raise Exception("inner")
Exception: inner 
```

啊哈！现在，仔细想想，这在某种意义上确实是有意义的：此时，*异常*只遇到了两个堆栈帧：of`inner()`和 of `outer()`——*异常*还不知道从哪里`outer()`调用。

因此，要获得完整的堆栈，您需要将当前堆栈与异常堆栈结合起来：

```
$ cat test.py
def inner():
    raise Exception("inner")

def outer():
    try:
        inner()
    except Exception:
        exc_info = sys.exc_info()
        stack = traceback.extract_stack()
        tb = traceback.extract_tb(exc_info[2])
        full_tb = stack[:-1] + tb
        exc_line = traceback.format_exception_only(*exc_info[:2])
        print "Traceback (most recent call last):"
        print "".join(traceback.format_list(full_tb)),
        print "".join(exc_line)

def caller():
    outer()

caller()

$ python test.py
Traceback (most recent call last):
  File "test.py", line 56, in <module>
    caller()
  File "test.py", line 54, in caller
    outer()
  File "test.py", line 42, in outer
    inner()
  File "test.py", line 38, in inner
    raise Exception("inner")
Exception: inner 
```

也可以看看：

*   [http://docs.python.org/2/library/sys.html](http://docs.python.org/2/library/sys.html)
*   [http://docs.python.org/2/library/traceback.html](http://docs.python.org/2/library/traceback.html)

# javascript - Does HTML 5's BlobBuilder() still work in Google Chrome?

> ID：14527820
> 
> 赞同：15
> 
> 时间：2013-01-25T18:09:57.323
> 
> 标签：javascript, html, google-chrome, blob

Based in this article [http://cloudevils.wordpress.com/2012/10/18/ajax-file-upload-without-post-using-html5/](http://cloudevils.wordpress.com/2012/10/18/ajax-file-upload-without-post-using-html5/) I created a form to upload files. Initially works fine in chrome but now is not workin more. In FF work fine. I made some debugs and this line

```
var bb = new (window.MozBlobBuilder || window.WebKitBlobBuilder || window.BlobBuilder)(); 
```

seems stop working in chrome. Browsering around I find some info about BlobBuilder() function that is not supported more in chrome.

Can help me?

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2013-01-25T18:14:28.263

它已经消失或被弃用。使用新的 Blob 构造函数。

阅读：[http ://updates.html5rocks.com/2012/06/Don-t-Build-Blobs-Construct-Them](http://updates.html5rocks.com/2012/06/Don-t-Build-Blobs-Construct-Them)

在您的教程中，而不是：

```
var bb = new (window.MozBlobBuilder || window.WebKitBlobBuilder || window.BlobBuilder)();
bb.append(data);
var blob = bb.getBlob(); 
```

做：

```
var blob = new Blob([data]); 
```

# c# - .NET 中的故障安全代码执行

> ID：14527824
> 
> 赞同：0
> 
> 时间：2013-01-25T18:10:19.240
> 
> 标签：c#, .net

> **可能重复：**
> [C# 对象的事务？](https://stackoverflow.com/questions/1765615/transactions-for-c-sharp-objects)

我的问题是 - 确保执行给定段中的所有代码或根本不执行任何代码的最佳方法是什么？Try Catch 在这种情况下不起作用，因为如果第 1 行是更新，它会发生，然后如果第 2 行是发送电子邮件并且由于某种原因失败，它会抛出异常，但更新将会发生已经（而我想要的是这样的——>如果第 40 行失败，请不要执行第 20 行）。

我知道在数据库方面你可以使用事务，但我想知道代码中是否有类似的东西......

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-25T18:12:15.007

事务通过在发生错误时执行回滚来确保原子性。但并非所有操作都可以回滚，例如发送邮件。它从弓中射出，不再回来。

简短的回答是，这是无法做到的。

更新：@JustinNiessner 上面的[评论](https://stackoverflow.com/questions/14527824/fail-safing-code-execution-in-net/14527854#comment20257715_14527824)链接到[这个](https://stackoverflow.com/questions/1765615/transactions-for-c-sharp-objects)很好的问题，建议在这个领域做一些工作。但请注意，除非在最简单的情况下，否则无法保证。具体来说，回滚 i/o 副作用可能非常困难。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T18:17:57.327

一般来说，没有什么可以回滚您编写的任何语句。

但是可以将支持事务添加到代码的某些特定部分。在这种情况下，[分布式事务](http://msdn.microsoft.com/en-us/library/ee818756.aspx)可能很有用。

# ruby-on-rails - Ruby on Rails server not reflecting changes to database records until restart

> ID：14527831
> 
> 赞同：2
> 
> 时间：2013-01-25T18:10:46.120
> 
> 标签：ruby-on-rails, ruby, sqlite, rails-activerecord

If I open the Rails Console and create a new Widget:

```
>> widget = Widget.new
>> widget.name = "Whatever"
>> widget.save 
```

The Widget saves without errors. However, when I run:

```
>> Widget.all 
```

This new Widget does not appear in the returned list of records. However, if I restart the Rails Console and run the same command again:

```
>> Widget.all 
```

The Widget now appears in the list of records. Why is this happening? I'm having the same problem with the Rails Server; if I create or edit a Widget with the scaffold views I generated, those Widgets do not appear in the show view until I restart the Rails Server.

By the way, I'm on Windows 7, using RubyMine as my IDE, and using rails 3.2.4 and sqlite3\.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T18:27:34.573

上面的一位评论者建议我更新到 rails 3.2.11。我更新了 Gemfile 中的版本并运行`bundle update`，这解决了问题。我不知道更新前哪个宝石或它们的组合是问题。

# powershell - Powershell - How to invoke a checkbox windows with multiple choice

> ID：14527832
> 
> 赞同：3
> 
> 时间：2013-01-25T18:10:46.260
> 
> 标签：powershell, checkbox, powershell-2.0

I've seach some way to invoke a windows with many checkbox. Depending on the checkbox checked, that will enable or disable so part of my script.

I don't have any idea how to create the shape and how to set a "true/false" value in var to enable or disable portion of my script.

Anyone know how to create that kind of windows checkbox ?

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-01-25T22:10:09.660

这段代码（在[PrimalScript](http://www.sapien.com/auth)的帮助下构建表单代码）有 3 个复选框。根据状态（选中或未选中），列表框将从某些命令的结果中填充。复制，粘贴和玩它。

```
function GenerateForm {

[reflection.assembly]::loadwithpartialname("System.Windows.Forms") | Out-Null
[reflection.assembly]::loadwithpartialname("System.Drawing") | Out-Null

$form1 = New-Object System.Windows.Forms.Form
$button1 = New-Object System.Windows.Forms.Button
$listBox1 = New-Object System.Windows.Forms.ListBox
$checkBox3 = New-Object System.Windows.Forms.CheckBox
$checkBox2 = New-Object System.Windows.Forms.CheckBox
$checkBox1 = New-Object System.Windows.Forms.CheckBox
$InitialFormWindowState = New-Object System.Windows.Forms.FormWindowState

$b1= $false
$b2= $false
$b3= $false

#----------------------------------------------
#Generated Event Script Blocks
#----------------------------------------------

$handler_button1_Click= 
{
    $listBox1.Items.Clear();    

    if ($checkBox1.Checked)     {  $listBox1.Items.Add( "Checkbox 1 is checked"  ) }

    if ($checkBox2.Checked)    {  $listBox1.Items.Add( "Checkbox 2 is checked"  ) }

    if ($checkBox3.Checked)    {  $listBox1.Items.Add( "Checkbox 3 is checked"  ) }

    if ( !$checkBox1.Checked -and !$checkBox2.Checked -and !$checkBox3.Checked ) {   $listBox1.Items.Add("No CheckBox selected....")} 
}

$OnLoadForm_StateCorrection=
{#Correct the initial state of the form to prevent the .Net maximized form issue
    $form1.WindowState = $InitialFormWindowState
}

#----------------------------------------------
#region Generated Form Code
$form1.Text = "Primal Form"
$form1.Name = "form1"
$form1.DataBindings.DefaultDataSourceUpdateMode = 0
$System_Drawing_Size = New-Object System.Drawing.Size
$System_Drawing_Size.Width = 450
$System_Drawing_Size.Height = 236
$form1.ClientSize = $System_Drawing_Size

$button1.TabIndex = 4
$button1.Name = "button1"
$System_Drawing_Size = New-Object System.Drawing.Size
$System_Drawing_Size.Width = 75
$System_Drawing_Size.Height = 23
$button1.Size = $System_Drawing_Size
$button1.UseVisualStyleBackColor = $True

$button1.Text = "Run Script"

$System_Drawing_Point = New-Object System.Drawing.Point
$System_Drawing_Point.X = 27
$System_Drawing_Point.Y = 156
$button1.Location = $System_Drawing_Point
$button1.DataBindings.DefaultDataSourceUpdateMode = 0
$button1.add_Click($handler_button1_Click)

$form1.Controls.Add($button1)

$listBox1.FormattingEnabled = $True
$System_Drawing_Size = New-Object System.Drawing.Size
$System_Drawing_Size.Width = 301
$System_Drawing_Size.Height = 212
$listBox1.Size = $System_Drawing_Size
$listBox1.DataBindings.DefaultDataSourceUpdateMode = 0
$listBox1.Name = "listBox1"
$System_Drawing_Point = New-Object System.Drawing.Point
$System_Drawing_Point.X = 137
$System_Drawing_Point.Y = 13
$listBox1.Location = $System_Drawing_Point
$listBox1.TabIndex = 3

$form1.Controls.Add($listBox1)

$checkBox3.UseVisualStyleBackColor = $True
$System_Drawing_Size = New-Object System.Drawing.Size
$System_Drawing_Size.Width = 104
$System_Drawing_Size.Height = 24
$checkBox3.Size = $System_Drawing_Size
$checkBox3.TabIndex = 2
$checkBox3.Text = "CheckBox 3"
$System_Drawing_Point = New-Object System.Drawing.Point
$System_Drawing_Point.X = 27
$System_Drawing_Point.Y = 75
$checkBox3.Location = $System_Drawing_Point
$checkBox3.DataBindings.DefaultDataSourceUpdateMode = 0
$checkBox3.Name = "checkBox3"

$form1.Controls.Add($checkBox3)

$checkBox2.UseVisualStyleBackColor = $True
$System_Drawing_Size = New-Object System.Drawing.Size
$System_Drawing_Size.Width = 104
$System_Drawing_Size.Height = 24
$checkBox2.Size = $System_Drawing_Size
$checkBox2.TabIndex = 1
$checkBox2.Text = "CheckBox 2"
$System_Drawing_Point = New-Object System.Drawing.Point
$System_Drawing_Point.X = 27
$System_Drawing_Point.Y = 44
$checkBox2.Location = $System_Drawing_Point
$checkBox2.DataBindings.DefaultDataSourceUpdateMode = 0
$checkBox2.Name = "checkBox2"

$form1.Controls.Add($checkBox2)

    $checkBox1.UseVisualStyleBackColor = $True
    $System_Drawing_Size = New-Object System.Drawing.Size
    $System_Drawing_Size.Width = 104
    $System_Drawing_Size.Height = 24
    $checkBox1.Size = $System_Drawing_Size
    $checkBox1.TabIndex = 0
    $checkBox1.Text = "CheckBox 1"
    $System_Drawing_Point = New-Object System.Drawing.Point
    $System_Drawing_Point.X = 27
    $System_Drawing_Point.Y = 13
    $checkBox1.Location = $System_Drawing_Point
    $checkBox1.DataBindings.DefaultDataSourceUpdateMode = 0
    $checkBox1.Name = "checkBox1"

$form1.Controls.Add($checkBox1)

#Save the initial state of the form
$InitialFormWindowState = $form1.WindowState
#Init the OnLoad event to correct the initial state of the form
$form1.add_Load($OnLoadForm_StateCorrection)
#Show the Form
$form1.ShowDialog()| Out-Null

} #End Function

#Call the Function
GenerateForm 
```

# java - 一个jar中的两个同名文件

> ID：14527833
> 
> 赞同：0
> 
> 时间：2013-01-25T18:10:53.010
> 
> 标签：java, jar

> **可能重复：**
> [每个类在 jar 文件中有两个类文件](https://stackoverflow.com/questions/7122955/each-class-has-two-classfiles-in-jar-file)

您好，我有一个 jar 文件，其中包含相同的文件名：

```
 /ro/sv/base/Monkey.png 
```

有人可以解释发生了什么吗？

我这里有罐子：[已删除]

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-25T18:16:31.057

来自 Ant Jar 任务文档

> 请注意，zip 格式允许在单个存档中存在多个具有相同完全限定名称的文件。这已被记录为会给毫无戒心的用户带来各种问题。如果您希望避免这种行为，您必须将重复属性设置为默认值“add”以外的值。

简而言之，您可以在一个 .zip 文件中拥有多个具有相同完全限定名称的文件，这就是它的工作原理，如果您不想有这种行为，请不要添加第二个 .png。

# cakephp-2.0 - CakePHP 复杂的身份验证（特定控制器/区域的特定用户角色）

> ID：14527837
> 
> 赞同：0
> 
> 时间：2013-01-25T18:11:13.560
> 
> 标签：cakephp-2.0

我正在尝试构建一个包含多个区域的小型 Web 应用程序：

1.  用户区
2.  管理员区

我正在使用 Auth 组件并在登录后进行检查，`Auth->user('role')`但这不会阻止“普通用户”在 URL 中键入管理路径并访问它（他已登录）。自然，管理员应该能够访问任何区域，但这不是我当前的问题 :)

管理和更重要的是实现这些权限/身份验证的最佳方式是什么？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T20:10:19.540

有ACL。但是，如果他们可以远离它，我会劝阻任何人不要使用 ACL。基于角色的身份验证当然很好并且易于实现。他们开始的方式是正确的，但是，您需要`admin routing`在`core.php`文件中启用。

```
Configure::write('Routing.prefixes', array('admin')); 
```

完成后，编码设置准确，身份验证就位，只有具有角色的用户`admin`才能访问任何管理部分，例如`http://www.yoursite.com/admin/users`

角色基础身份验证成功的大部分魔法都是在`AppController`课堂上完成的。

举个例子，我会这样设置`AppController.php`文件：

```
public $components = array(
    'Cookie',
    'Session',
    'Auth' => array(
        'authenticate' => array(
            'Form' => array(
                'userModel' => 'User',
                'fields' => array(
                    'username' => 'username',
                    'password' => 'password'
                )
            )
        ),
        'logoutRedirect' => array('controller' => 'pages', 'action' => 'home'),
        'authorize' => array('Controller')
    )
);

public function isAuthorized($user){        
    if(isset($user['role']) && $user['role'] === 'admin'){
        return true;
    }
    return false;
} 
```

如果你想要一个`admin`布局和一个`members`通用布局，你可以在`beforeFilter()`or`beforeRender()`函数中这样做。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-26T09:07:58.407

我会`isAuthorized`在您的控制器中使用该功能

像这样的样本：

```
class PostsController extends AppController {

    public function isAuthorized() {
        if($this->Auth->user('role_id' != '1')) return false;
    }
} 
```

并在您的`AppController beforeFilter()`添加

```
 $this->Auth->authorize = 'Controller'; 
```

# php - 将给定的天数显示为“#Years, # Months, # Weeks, # Days”

> ID：14527840
> 
> 赞同：-1
> 
> 时间：2013-01-25T18:11:20.030
> 
> 标签：php, sql, datetime

使用 SQL 数据库中的“天数”，如何以更人性化的格式返回它？

例如，对于许多用户来说，这个数字相当高。而不是他们看到“438天”，我想显示：“1年，2个月，1周，5天。”

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T18:33:00.910

```
Select floor(yourfield/365) + ' year(s), ' + 
       floor(mod(yourfield,365)/30) + ' month(s), ' + 
       floor(mod(mod(yourfield,365),30)/7) +' week(s), ' + 
       floor(mod(mod(mod(yourfield,365),30),7)) + ' day(s)'
FROM table

assumes + is valid operator in mySQL for string concat.
assumes 1 year = 365 days
assumes 1 month = 30 days
assumes 1 week = 7 days 
```

鉴于我们不知道考虑月份或闰年中的天数的开始/结束日期是徒劳的。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-01-25T18:14:08.953

你可以使用`strtotime()`和`DateTime`

```
$time = strtotime("438 days ago");
$past = new DateTime(date('Y-m-d', $time));
$present = new DateTime(date('Y-m-d', time()));
$difference = $past->diff($present);
echo $difference->format('%a days %y years'); 
```

[http://php.net/manual/en/function.date-diff.php](http://php.net/manual/en/function.date-diff.php)

# c# - ASP.NET MVC POST 后消息反馈的最佳实践

> ID：14527843
> 
> 赞同：3
> 
> 时间：2013-01-25T18:11:25.470
> 
> 标签：c#, asp.net-mvc-3

我正在尝试在 POST 之后找到一种反馈消息的好方法。

例如，我有这些方法

```
 public ActionResult Index(int id)
    {
        Model model = getModel(id);           

        return View(model);
    }

    [HttpPost]
    public ActionResult Save(Model model)
    {

        Result result = saveModel(result)

        if (Result.Status != Status.SUCCESS)
        {
            ...
        }
        else if(Result.Status != Status.FAILURE)
        {
            ...
        }else
        {
            ...
        }
        return RedirectToAction("Index");
    } 
```

并且 Result 类有一个 message 属性

```
 public class Result
        {
           ...
           public string Message{get;set;}
        } 
```

因此，当我调用 .../Controller/Index/1 时，会显示我的索引视图，并且该视图有一个调用保存操作的提交按钮，但如果业务层出现问题，我想显示错误/警告消息。

那么，问题是解决这种情况的最佳方法是什么？

我读过一些推荐 TempData 的文章，其他推荐 ViewData，将消息传输到索引视图。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-25T18:18:56.703

让我分享一个我开发的一个项目的 ChangePassword 操作示例：

```
[HttpPost]
public ActionResult ChangePassword(LoginModel model)
{
    if (ModelState.IsValid && _userService.ChangePassword(model.Password, model.NewPassword))
        ViewBag.SuccessMessage = UI.PasswordChanged;
    else
        ModelState.AddModelError("Password", ErrorMessages.InvalidPassword);
    return View(model);
} 
```

请记住，如果您重定向到另一个操作，ViewBag 将不起作用。如果要跨一个请求保留信息，则必须使用 TempData。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-25T18:18:51.160

对于失败，您应该使用

```
ModelState.AddModelError("", "The error message"); 
```

因为它会被自动拾取`Html.ValidationSummary(true)`（它会自动添加到所有视图中）

对于通知，您可以使用`TempData`或`ViewBag`。

但是，我不鼓励您重定向所有内容。而是让用户有机会更正任何错误（即使是业务层生成错误）。使用类似的东西：

```
[HttpPost]
public ActionResult Save(Model model)
{
    if (!ModelState.IsValid)
        return View(model);

    Result result = saveModel(result)
    if (Result.Status == Status.SUCCESS)
        return RedirectToAction("Index");

    if (Result.Status != Status.FAILURE)
    {
        ModelState.AddModelError("", "Ooops, failed");
    }
    else
    {
        ModelState.AddModelError("", "Some other error");
    }

    return View(model)
} 
```

# c++ - C++ 和 NTFS 文件：路径名 VS 打开

> ID：14527845
> 
> 赞同：0
> 
> 时间：2013-01-25T18:11:26.050
> 
> 标签：c++, visual-c++, mingw, ntfs

这是这个问题的一个扩展：[fstream not opening files with peaks in pathname](https://stackoverflow.com/questions/14483926/c-fstream-not-opening-files-with-accent-marks-in-pathname#comment20183616_14483926)

问题如下：一个程序打开一个简单的 NTFS 文本文件，路径名中有*重音符号（例如***à** , **ò** , ...）。在我的测试中，我使用了一个路径名为**I:\università\foo.txt**的文件 （*università*是大学的意大利语*翻译*）

以下是测试程序：

```
#include <iostream>
#include <fstream>
#include <string>
#include <cstdio>
#include <errno.h>
#include <Windows.h>

using namespace std;

LPSTR cPath = "I:/università/foo.txt";
LPWSTR widecPath = L"I:/università/foo.txt";
string path("I:/università/foo.txt");

void tryWithStandardC();
void tryWithStandardCpp();
void tryWithWin32();

int main(int argc, char **argv) {
    tryWithStandardC();
    tryWithStandardCpp();
    tryWithWin32();

    return 0;
} 

void tryWithStandardC() {
    FILE *stream = fopen(cPath, "r");

    if (stream) {
        cout << "File opened with fopen!" << endl;
        fclose(stream);
    }

    else {
        cout << "fopen() failed: " << strerror(errno) << endl;
    }
}

void tryWithStandardCpp() {
    ifstream s;
    s.exceptions(ifstream::failbit | ifstream::badbit | ifstream::eofbit);      

    try {
        s.open(path.c_str(), ifstream::in);
        cout << "File opened with c++ open()" << endl;
        s.close();
    }

    catch (ifstream::failure f) {
        cout << "Exception " << f.what() << endl;
    }   
}

void tryWithWin32() {

    DWORD error;
    HANDLE h = CreateFile(cPath, GENERIC_READ, 0, NULL, OPEN_EXISTING, FILE_ATTRIBUTE_NORMAL, NULL);

    if (h == INVALID_HANDLE_VALUE) {
        error = GetLastError();
        cout << "CreateFile failed: error number " << error << endl;
    }

    else {
        cout << "File opened with CreateFile!" << endl;
        CloseHandle(h);
        return;
    }

    HANDLE wideHandle = CreateFileW(widecPath, GENERIC_READ, 0, NULL, OPEN_EXISTING, FILE_ATTRIBUTE_NORMAL, NULL);

    if (wideHandle == INVALID_HANDLE_VALUE) {
        error = GetLastError();
        cout << "CreateFileW failed: error number " << error << endl;
    }

    else {
        cout << "File opened with CreateFileW!" << endl;
        CloseHandle(wideHandle);
    }
} 
```

源文件以 UTF-8 编码保存。我正在使用 Windows 8。

这是使用 VC++ (Visual Studio 2012) 编译的程序的输出

```
fopen() failed: No such file or directory
Exception ios_base::failbit set
CreateFile failed: error number 3
CreateFileW failed: error number 3 
```

这是使用 MinGW g++ 的输出

```
fopen() failed: No such file or directory
Exception basic_ios::clear
CreateFile failed: error number 3
File opened with CreateFileW! 
```

那么让我们来看看问题：

1.  为什么 fopen() 和 std::ifstream 在 Linux 中的类似测试中有效，但在 Windows 中无效？
2.  为什么 CreateFileW() 只能使用 g++ 编译？
3.  是否存在 CreateFile 的跨平台替代方案？

我希望无需特定平台的代码就可以打开具有*通用路径名的**通用*文件，但我不知道该怎么做。

 *提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-25T20:31:14.600

你写：

> “源文件以 UTF-8 编码保存。”

如果您使用的是 g++ 编译器，那么这一切都很好（到目前为止），它具有 UTF-8 作为其默认的基本源字符集。然而，Visual C++ 将默认假定源文件是用 Windows ANSI 编码的，除非有明确的说明。因此，请确保它在开始时有一个 BOM（字节顺序标记），据我所知，它没有记录在案，导致 Visual C++ 将其视为使用 UTF-8 编码。

然后你问，

> “1。为什么 fopen() 和 std::ifstream 在 Linux 中可以在类似的测试中工作，但在 Windows 中却不行？”

对于 Linux，它*可能*会起作用，因为 (1) 现代 Linux 是面向 UTF-8 的，因此如果文件名看起来相同，则很可能与源代码中看起来相同的 UTF-8 编码文件名相同，以及 (2) 在 * nix 文件名只是一个字节序列，而不是一个字符序列。这意味着无论它看起来如何，如果您传递相同的字节序列，相同的值，那么您就会匹配，否则不会。

相比之下，在 Windows 中，文件名是可以以各种方式编码的字符序列。

在您的情况下，源代码中的 UTF-8 编码文件名在可执行文件中存储为 Windows ANSI（是的，使用 Visual C++ 构建的结果取决于 Windows 中选择的 ANSI 代码页，据我所知，这也是未记录的）。然后这个 gobbledegook 字符串向下传递一个例程层次结构并转换为 UTF-16，这是 Windows 中的标准字符编码。结果根本不匹配文件名。

* * *

你进一步问，

> “2。为什么 CreateFileW() 只能用 g++ 编译？”

大概是因为您没有在源代码文件的开头包含 BOM（见上文）。

使用 BOM，一切都可以很好地与 Visual C++ 配合使用，至少在 Windows 7 中是这样：

```
用 fopen 打开的文件！
用 c++ open() 打开的文件
使用 CreateFile 打开的文件！

```

* * *

最后，你问，

> “3。是否存在 CreateFile 的跨平台替代方案？”

并不真地。有Boost文件系统。但是，虽然它的版本 2 确实为标准库的有损窄字符编码提供了解决方法，但该解决方法在版本 3 中被删除，它只使用*标准库的 Visual C++ 扩展，*其中 Visual C++ 实现提供流的宽字符参数版本构造函数和`open`. 即，至少据我所知（我最近没有检查是否已修复），Boost 文件系统通常只适用于 Visual C++，而不适用于例如 g++——尽管它适用于无问题字符文件名。

v2 的解决方法是尝试转换为 Windows ANSI（由`GetACP`函数指定的代码页），如果这不起作用，请尝试`GetShortPathName`，这实际上可以保证可以用 Windows ANSI 表示。

据我了解，删除 Boost 文件系统中的解决方法的部分原因是，原则上用户至少可以在 Windows Vista 和更早版本中关闭 Windows 短名称功能。然而，这不是一个实际问题。这只是意味着如果用户由于故意对系统进行脑叶切除而遇到问题，则可以使用简单的修复程序（即重新打开它）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-25T19:25:06.720

您遇到的问题是您作为路径传递给 fstreams 的编码是特定于实现的。此外，您的程序的行为是实现定义的，因为它在代码中使用 C++ 字符集之外的字符，即重音字符。问题在于有许多不同的编码可以用来表示这些字符。

现在，有解决方案：

*   首先，有一个 MSC 扩展来告诉编译器它应该采用哪种编码。
*   为了获得使用 CreateFileW() 的路径，您可以对路径进行编码，如`wchar_t const path[] = {'f', 0x20ac, '.', 't', 'x', 't'};`. 这不是很舒服，但实际上路径存储在具有某些 Unicode 编码或用户输入的文件中。
*   然后，标准库的实现中有一个扩展，允许您使用 wchar_t 路径，有 _wfopen() 和 fstream 构造函数。
*   然后是 Boost，它有一个文件系统和 iostream 库，专门用于提供可移植性。我一定会看看这个。

请注意，虽然 wchar_t 路径不可移植，但将它们移植到新平台通常不是很复杂。几个#ifdefs，你就准备好了。*

# php - 通过cron php脚本同步两个mysql db，但不是所有行

> ID：14527855
> 
> 赞同：1
> 
> 时间：2013-01-25T18:12:16.273
> 
> 标签：php, mysql, database, cron, sync

我有一个数据库需要同步到另一个但不是数据库中的所有行。

我刚刚浪费了金钱和时间在自由职业者上发布了一个项目，因为项目获胜者想要编辑驱动数据库的站点的文件，但由于它们被加密而无法编辑。

我需要 2 个数据库来同步，不包括一个（表/行）

例如：

```
1 <-> 1
2 <-> 2
3 <-> 3
4 <-> 4
5 <-> 5
6 no 6 
```

我希望它由一个 cron 作业运行，两个数据库都在同一台服务器上

我要求的不是解决方案，而是编写这个项目的更好方法，因为我没有掌握所有行话。

即使有可能，它会做多少工作？

# mysql - SQL从值中删除部分文本

> ID：14527859
> 
> 赞同：11
> 
> 时间：2013-01-25T18:12:30.233
> 
> 标签：mysql, sql

如果存在，我将如何编写 SQL 以从记录值中删除一些文本。

```
Version Column data
 ------------------  
WEB 1.0.1  
WEB 1.0.1  
1.0.2  
1.0.2 
```

我想更新所有包含“WEB”的记录并删除该文本，但保留其余的“1.0.1”。

到目前为止我有`Select * from table`。

数据库是 MySQL 5.5.25

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2013-01-25T18:20:24.910

**MySQL**、**SQL Server**和**PostGres**的`REPLACE`特性将删除所有出现的带有空格的 。******`WEB`******

 ********选择**

```
SELECT REPLACE(Version, 'WEB ', '') FROM MyTable 
```

**更新**

```
UPDATE MyTable SET Version = REPLACE(Version, 'WEB ', '') 
```

或者

```
UPDATE MyTable SET Version = REPLACE(Version, 'WEB ', '') WHERE Version LIKE '%WEB %' 
```

**参考**

*   [替换](http://msdn.microsoft.com/en-us/library/ms186862.aspx)- SQL Server
*   [替换](http://dev.mysql.com/doc/refman/5.0/en/string-functions.html#function_replace)- MySQL
*   [替换](http://www.postgresql.org/docs/9.1/static/functions-string.html)- PostGres
*   我在答案中包含了多个数据库服务器，并由于对问题进行了多次编辑而选择和更新

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-25T18:20:22.490

在 postgres 中，这将是：

```
select substring(Version from 5 for 3) 
from table
where Version like '%WEB%' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-25T18:22:09.747

```
UPDATE Table
SET Version = Replace(Version, 'Web ','')
WHERE Version LIKE 'WEB %' 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-25T19:57:22.677

这是另一个适用于任何 SQL 的示例，因为使用的函数是 ANSI SQL 标准。此示例假定单词“WEB”和第一个数字之间有一个空格。但它可以改进。我认为这是比硬编码 subtr 的开始和结束位置更通用的方法：

```
SELECT TRIM(SUBSTR('WEB 1.0.1', INSTR('WEB 1.0.1', ' ') ) ) as version 
  FROM dual;

 SQL> 

 VERSION
 -------
 1.0.1 
```******

# java - Android AchartEngine

> ID：14527861
> 
> 赞同：1
> 
> 时间：2013-01-25T18:12:44.253
> 
> 标签：java, android, xml, achartengine

我需要实现一个条形图，当用户触摸图表以垂直移动它时，它会读取值。图形向上移动，根据轴记录值。x 轴是值，Y 轴是变量，我需要执行计算。理解的例子

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T16:44:00.313

看看[这个](http://code.google.com/p/achartengine/source/browse/trunk/achartengine/demo/org/achartengine/chartdemo/demo/chart/XYChartBuilder.java)例子。您还可以根据`mChartView.addPanListener`需要执行和处理此事件。

# c - 多子创建代码中的问题

> ID：14527863
> 
> 赞同：7
> 
> 时间：2013-01-25T18:12:48.760
> 
> 标签：c, fork, multiple-processes

> > 这段代码是我的操作系统项目的一部分，该项目要求在应用并发进程的地方做一些事情，我决定制作一个有两个玩家的客户端服务器扑克项目，我使用儿子和孙子进程来确定手牌价值。

代码中应用的方案如下：

[![1](../Images/ffdebadca6fdb6da9dcc66d8fd621277.png)](https://i.stack.imgur.com/F8AkJ.jpg)

代码的问题是，在同一个游戏中，只有第一手被正确评估，事实上第二个是不正确的，在第三场比赛中出现错误并且程序结束，这发生在每个新游戏中

这是代码：

```
void check_hand(int suits[5],int ranks[5],int *point){

    pid_t son[2];
    int i,j;

    for (i = 0; i < 2; i++){
            son[i]=fork();

    /***********************************************
            straight flush son
    ************************************************/

            if(son[i]==0 && i==0){
                    pid_t grandson[3];
                    int k;
                    for(k=0;k<3;k++){
                            grandson[k]=fork();
                            if(grandson[k]==0 && k==0){
                                    exit(F_highcard(ranks));
                            }
                            else if(grandson[k]==0 && k==1){
                                    exit(F_flush(suits));
                            }
                            else if(grandson[k]==0 && k==2){
                                    exit(F_straight(ranks));
                            }
                            else if(grandson[k]<0){
                                    puts("fork failed");
                                    exit(-1);
                            }
                    }
                    int exit_status_straight,exit_status_flush,exit_status_highcard;
                    //waiting his sons
                    waitpid(grandson[0],&exit_status_highcard,0);
                    waitpid(grandson[1],&exit_status_flush,0);
                    waitpid(grandson[2],&exit_status_straight,0);

                    /**checkpoint A****/

                    //elaborate the exit statuses and exit with a value
            }

    /***********************************************
                    full house son
    ************************************************/

            if(son[i]==0 && i==1){
                    pid_t grandson[2];
                    int k;
                    for(k=0;k<2;k++){
                            grandson[k]=fork();
                            if(grandson[k]==0 && k==0){
                                    exit(F_n_pairs(ranks));
                            }
                            else if(grandson[k]==0 && k==1){
                                    exit(F_tris_poker(ranks));
                            }
                            else if(grandson[k]<0){
                                    exit(-1);
                            }
                    }

                    int exit_status_pair,exit_status_tris_or_poker;
                    waitpid(grandson[0],&exit_status_pair,0);
                    waitpid(grandson[1],&exit_status_tris_or_poker,0);

                    /**checkpoint B****/

                    //elaborate the exit statuses and exit with a value
                    }
            }
            if(son[i]<0){
                    puts("fork failed");
                    exit(-1);
            }
    }

    /***********************************************
            analysis exit status of his 2 sons
    ************************************************/
    pid_t pid;
    int status;
    int values[10];
    //initialization
    for(j=0;j<10;j++)values[j]=0;

    for(j=0;j<2;j++ ){
            pid = wait(&status);
            if(pid==son[0]){
                    values[WEXITSTATUS(status)]=1;
            }
            else if(pid==son[1]){
                    values[WEXITSTATUS(status)]=1;
            }
            else if(pid==-1){
                    puts("error");
                    exit(1);
            }
    }

    for(j=9;j>=0;j--){
            if(values[j]==1)break;
    }
    *point=j;
    printf("point=%d\n",*point);
} 
```

在下面的代码中，我放置了一些检查点来查找错误，执行期间的结果对于玩家 1 和玩家 2 的每个新游戏都是相同的：

**1 手（始终正确）**

```
 checkpoint A
 checkpoint B
 point=value 
```

**2手**

```
 checkpoint A
 point=value
 checkpoint B 
```

为什么会这样？父亲必须等待儿子，在这种情况下，他不会等待

**3手**

```
point=-1
and exit 
```

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T08:53:58.257

我有一种强烈的感觉，你的麻烦与你最后的等待循环有关。您只等待两次子进程。无论返回的 PID 是否是您正在检查的孩子之一。

**我的猜测**是您的孙子正在等待返回或返回值 <-1 出于某种原因

**证明**是在输出 PID 的等待循环中放置一个 else 子句，并使用已创建进程的 PID 检查此 PID。

**无论如何，我要做的**`wait`是将您的等待循环更改为仅在两个儿子之一触发呼叫返回时才增加 j 。

# php - mysql_free_result() 期望参数 1 是资源

> ID：14527864
> 
> 赞同：1
> 
> 时间：2013-01-25T18:12:49.017
> 
> 标签：php

我将数据从我的 android 应用程序发送到 localhost 中的 mySQL，我收到警告（警告：mysql_free_result() 期望参数 1 是资源，布尔值在第 17 行的 C:\xampp\htdocs\datatest.php 中给出）

尽管有警告，我仍然可以将数据插入数据库。

我想知道是否可以忽略这一点，或者我该如何解决这个问题？

我尝试了各种论坛和网站都没有解决我的问题。

```
<?php 
$dbcnx = mysql_connect("localhost", "root", "");
$db = "agentdatabase";
mysql_select_db($db, $dbcnx);
$user_id=$_POST['username'];
$passwd=$_POST['password'];
$query = "INSERT INTO agentable (username,password) VALUES ('".$user_id."','".$passwd."')";
echo $query;

$result = mysql_query($query) or die ("<b>Query failed:</b> " . mysql_error());

if($result){
    echo '<br />','pass';
}
else echo mysql_error();

mysql_free_result($result);
mysql_close($dbcnx);
?> 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-25T18:14:47.510

您无法释放`INSERT`查询的结果，因为您[无法释放 boolean](http://php.net/manual/en/function.mysql-query.php#refsect1-function.mysql-query-returnvalues)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-25T18:17:39.980

`mysql_free_result()`仅当您担心返回大型结果集的查询使用了多少内存时才需要调用。

不推荐使用 mysql 扩展，而是使用 MySQLi 或 PDO_MySQL。

mysql_query() 只为 SELECT、SHOW、EXPLAIN 和 DESCRIBE 查询返回资源。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-25T18:17:59.837

旁注，不推荐使用 MySQL PHP 扩展。最好使用[MySQLi](http://php.net/manual/en/book.mysqli.php)或[PDO](http://php.net/manual/en/ref.pdo-mysql.php)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-10-20T19:49:11.917

这是我测试并能够以其他两种不同方式重现此错误的另一个可能原因，此处未提及。

1） **您的 SQL 语法错误**，看起来像这样（注意**field3**后**不正确的额外逗号**：

 **"从 myTable 中选择 field1、field2、**field3** ";

2) **您的 SQL 包含重复字段**，如下所示：

"从 myTable 中选择 field1, **field2** , **field2** ";

在这两种情况下，我都收到了消息，它以不同的功能显示：

***“警告：mysql_result() 期望参数 1 是资源，给定的布尔值”***

***“警告：mysql_free_result() 期望参数 1 是资源，给定的布尔值”***

***“警告：mysql_fetch_assoc() 期望参数 1 是资源，给定的布尔值”***

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-06-02T22:34:51.933

用这个：

```
if (is_bool($result) === false) {
    mysql_free_result($result);
} 
```**

# ruby - Jenkins 在接收电子邮件时执行操作的最简单方法是什么？

> ID：14527868
> 
> 赞同：0
> 
> 时间：2013-01-25T18:12:56.643
> 
> 标签：ruby, email, jenkins

我需要一种方法让 Jenkins 在收到电子邮件时执行操作。我计划发送一封带有 Ruby 脚本和 net/smtp 的电子邮件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T13:04:06.333

I'm also not aware of a plugin for Jenkins to start jobs via email. However, it is easy to use a service like [CloudMailin](http://www.cloudmailin.com) (which converts the incoming email to an HTTP POST) and use a small script of your own to make this interact with the Jenkins API and schedule jobs.

I've done this personally and it works pretty well. I didn't make full use of the API and just used the following URL:

```
http://SERVER_URL/job/JOB_NAME/build?delay=60 
```

You don't need the delay but I found it useful to ask multiple jobs to be set at the same time.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-28T17:03:16.793

有一个插件可以让你通过电子邮件向 Jenkins 发送命令。没有亲自使用过，但这里是：
[https ://wiki.jenkins-ci.org/display/JENKINS/Mail+Commander+Plugin](https://wiki.jenkins-ci.org/display/JENKINS/Mail+Commander+Plugin)

# php - 性能是否有很大差异（PHP循环）

> ID：14527869
> 
> 赞同：0
> 
> 时间：2013-01-25T18:13:05.393
> 
> 标签：php

因此，假设我有一个可查询的数据库，其中包含 100 个数据对象。我想展示 3 个随机的。

我没有任何工作代码，因为这是我刚想到的一个想法。

方法一：

*   使用 3 个随机 id 查询数据库`mt_rand()`

所以基本上`Query for IDs (1, 15, 67)`然后打印每个。

或者

方法二：

*   `mt_rand()`在带有计数器的循环中使用(`$counter = 0; $counter = ++$counter)`

基本上`Query ALL posts`如果`(ID = 1, 15, 67)`然后打印每一个，如果`($counter = 3){ break; }`

方法 2 听起来它会给我一个讨厌的大对象。虽然方法 1 听起来会是一个更昂贵的数据库查询。我认为方法1会更好，但我不确定

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-25T18:16:26.977

如果您的 ID 列被索引，它可能应该是，然后做一个选择

```
WHERE id IN (1, 15, 67) 
```

很便宜。即使您的表中有更多行，它也会扩展。解决方案 2 在选择整个表并将其加载到内存时不会扩展。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-25T18:16:37.780

我确信方法1更好：

在方法 1 中，数据库引擎将遍历您的所有帖子以找到您需要的帖子，然后只发送它选择的 3 个帖子。在方法 2 中，数据库引擎还将遍历您的所有帖子，然后将发送一个更大的对象（包含您的所有帖子），这肯定会花费更多时间。

希望这会有所帮助；）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-25T18:16:29.790

方法1显然。如果您正确设置了索引，那么它不会是一个更昂贵的数据库查询。

如果你真的很好奇，你可以找到自己的答案：

```
<?
$start = microtime();
doMethodOne();
$end = microtime();

echo 'Method 1 took ' . $end - $start . ' ms<br />';

$start = microtime();
doMethodTwo();
$end = microtime();

echo 'Method 2 took ' . $end - $start . ' ms'; 
```

# wordpress - 如何将 WordPress 安装升级和部署为 Git 子模块？

> ID：14527873
> 
> 赞同：2
> 
> 时间：2013-01-25T18:13:40.543
> 
> 标签：wordpress, git, deployment

我正在使用类似于 Mark Jaquith 的[WordPress Skeleton](https://github.com/markjaquith/WordPress-Skeleton)的 WordPress 目录结构，它将 WordPress 与内容作为子模块放在一个单独的目录中：

```
/content
/wp
/local-config.php
/wp-config.php
/index.php 
```

我还使用 git 和 post-receive 挂钩将我的代码更改推送到我的实时服务器。除了我尝试升级 WordPress 并将其推送到实时服务器之外，这一切都很好。

这就是我在本地机器和远程服务器上设置 repo 的方式：

## 本地机器

```
cd /www
git init .
git submodule add git://github.com/WordPress/WordPress.git wp
git commit -m "Add Wordpress submodule."
cd wp
git checkout 3.5 
```

签出标签后，我从 git 收到关于处于“分离 HEAD”状态的警告。由于我不打算对 WordPress 做出任何承诺，我认为这不应该是一个问题。

```
cd ..
git commit -am "Checkout Wordpress 3.5" 
```

## 远程服务器

```
git init --bare
cat > hooks/post-receive
#!/bin/sh
GIT_WORK_TREE=/home/public git checkout -f

chmod +x hooks/post-receive

git remote add web ssh://user@server/home/private/code/wordpress.git

git push web +master:refs/heads/master 
```

我收到此错误：

```
No refs in common and none specified; doing nothing.
Perhaps you should specify a branch such as 'master'.
fatal: The remote end hung up unexpectedly
error: failed to push some refs to 'ssh://userserver/home/private/code/wordpress.git' 
```

经过一番谷歌搜索，看起来我可以使用此命令将主分支同步到服务器（我不知道这是如何工作的）

```
git push web +master:refs/heads/master 
```

但这对我没有帮助，因为我不想跟踪 master，我想跟踪发布标签 3.5。更多的谷歌搜索让我得到了这个命令：

```
git push web +3.5~0:refs/heads/master 
```

要升级子模块，我这样做：

```
cd wp
git fetch && git fetch --tags
git checkout 3.5.1
git push web +3.5.1~0:refs/heads/master 
```

我这样做正确吗？我看到的所有教程都`git push web`已经完成了。大多数甚至不包括升级子模块。这确实**有效**，但如果我不必使用这种奇怪的推送语法，我会觉得不舒服。

如何正确将此分离的 HEAD 状态推送到服务器？

我也尝试过使用分支，`git checkout -b mywp 3.5`但是当需要升级时，我不知道如何将新的 3.5.1 标签引入我的`mywp`分支。

*[在WP Answers](https://wordpress.stackexchange.com/questions/83063/how-to-upgrade-and-deploy-wordpress-install-as-a-git-submodule#comment112509_83063)上问过这个问题，但在这里可能更合适。*

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-30T20:16:54.053

在远程服务器上尝试：

```
git submodule update --init --recursive 
```

这将递归更新您的所有子模块

您还可以发出：

```
git fetch --tags 
```

这将更新您的本地标签，从中央远程仓库获取更新列表。

# java - 使用 C++/NDK（Android 开发）将文件复制到照片库

> ID：14527889
> 
> 赞同：0
> 
> 时间：2013-01-25T18:14:16.207
> 
> 标签：java, android, c++, android-ndk, java-native-interface

我正在使用用 C++ 编写的第三方框架（与 NDK 接口）开发一个 Android 应用程序。所以我无法访问本机 Java 命令，并且对这个过程很陌生。我希望能够将保存在本地应用程序目录（例如缓存）中的图像复制到 sd 卡上的公共照片库。问题是我不知道如何在 C++ 中做到这一点。

在本机 Java 开发中，有诸如 getExternalStoragePublicDirectory() 之类的命令可以简化此过程。有没有办法在 C++ 中实现类似的功能，以便我可以：a）获取当前应用程序目录和要复制的项目的文件路径，b）获取公共照片目录，c）将文件从 a 复制到 b .

非常感谢任何代码片段或示例。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T20:58:08.747

[您可以在 bitbucket 上](https://bitbucket.org/ZephyrSL/modern-tutorials/src/f159fa978ca3/android_wrapper/jni/main.cpp)找到从 C++ 调用 getCacheDir()以及[在 github 上](https://github.com/xbmc/xbmc/blob/master/xbmc/android/activity/XBMCApp.cpp)找到 getExternalStoragePublicDirectory() 的示例。复制文件可以像在循环中读写一样简单，请参阅[如何在 Unix 上使用 C 复制文件？](https://stackoverflow.com/questions/2180079/how-can-i-copy-a-file-on-unix-using-c#2180788).

# wix - 将证书安装为 WiX 包的一部分

> ID：14527890
> 
> 赞同：2
> 
> 时间：2013-01-25T18:14:18.337
> 
> 标签：wix, wix3.6

作为我们的客户端-服务器软件包的一部分，我们有一个发布证书的自定义 CA。我需要能够在每个用户的机器上将我们的 CA 安装为受信任的根 CA。为了实现这一点，我`Certificate`将 IIS 管理包中的元素用于 WiX（证书不适用于 IIS，但这符合我们的目的）。最初，我让安装程序将它放在本地机器存储中，但我们必须让我们的安装程序按用户安装以避免需要提升，所以我现在必须将它存储在本地用户存储中。

我已将存储位置更改为`currentUser`，它可以工作，但是现在每次运行安装程序时都会提示我安装证书的警告，以及在安装新版本时删除和安装证书的警告是运行升级。使用本地机器存储时，我没有收到此类警告。

**有没有办法执行以下任一操作：**

*   让安装程序仅在证书尚不存在时安装证书，并且在卸载时*不*将其删除（因此升级不会首先将其删除，消除一个警告，然后不会安装它，因为它已经存在，消除其他警告）
*   让安装程序在不提示用户的情况下执行删除/安装证书操作

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T23:57:21.063

虽然这不是我所要求的确切解决方案，但我确实找到了适合我的解决方案。

我为我的证书设置`Permanent="true"`了`Component`一个条件，如下所示：

```
<Component Id="MyCert" Permanent="True">
    <Certificate ... />
    <Condition><![CDATA[SKIPCERT <> "YES"]]></Condition>
</Component> 
```

这对我有用，因为我使用引导程序应用程序进行更新，所以我能够传递一个名为我升级时`SKIPCERT`的值的自定义变量。`YES`

与`Permanent="True"`条件相结合意味着在卸载（或升级）时不会删除证书，并且当我安装更新时它不会尝试再次安装它。

# c - 填充 2D 字符数组会导致 C 崩溃

> ID：14527891
> 
> 赞同：0
> 
> 时间：2013-01-25T18:14:24.410
> 
> 标签：c, arrays, multidimensional-array, char

我正在尝试使用文本文件中的字符填充二维数组（mapLayout）。

当我在读取字符时使用 printf 输出字符时，一切看起来都很好，但是将字符添加到数组的实际行似乎导致了崩溃。

```
#include <stdio.h>
#include <stdlib.h>

void createMap();

//height of file being read
int mapHeight, mapWidth = 20;
char mapLayout[20][20];

int main()
{
    createMap();
    return 0;
}

//read in string from file and populate mapLayout with chars
void createMap(){
    FILE *file = fopen("map.txt", "r");
    int col, row = 0;
    int c;

    if (file == NULL)
        return NULL; //could not open file

    while ((c = fgetc(file)) != EOF)
    {
        printf("%c", c);
        printf("\nx:%d, y:%d\n", col, row);

        if(c == '\n'){
            row++;
            col = 0;
        }else{
            mapLayout[col][row] = c;        //<--  This line seems to be the problem
            col++;
        }

    }

    return;
} 
```

我正在阅读的文件是 20 x 20 的地图表示。这里是：

```
xxxxxxxxxxxxxxxxxxxx
xA                 x
x                  x
x                  x
xxxxxxxxxxxxxxxx   x
x                  x
x                  x
x                  x
x                  x
x                  x
x    xxxxxxxxxxxxxxx
x           x      x
x           x      x
x           x      x
x           x      x
x           x      x
x     xxxxxxx      x
x                  x
x                 Bx
xxxxxxxxxxxxxxxxxxxx 
```

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-25T18:17:29.673

`int col, row = 0;`为什么`col`没有初始化为零。如果文件中的第一个字符是，`\n`那么它不会崩溃，对于所有剩余的情况，都会发生崩溃（未定义的行为）。

做

```
int col = 0;
int row = 0; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-25T18:20:36.343

根据您的编译器，它可能是那一行和 mapHeightd 它一开始就没有得到任何值。尝试：int row=0，col=0；

# python - 带小数秒的时间字符串

> ID：14527896
> 
> 赞同：8
> 
> 时间：2013-01-25T18:14:48.763
> 
> 标签：python, time, python-2.7

假设我有一个带格式的字符串，`HHMMSS.SS`如何将其转换为时间对象？

这就是我认为你会这样做的方式：

```
import time
time.strptime(timestring, '%H%M%S') 
```

但是，根据[时间](http://docs.python.org/2/library/time.html)文档`%S`没有考虑秒的分数。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2013-01-25T18:18:00.093

您将不得不使用 %f

```
time.strptime('26/01/12 23:50:32.123', '%d/%m/%y %H:%M:%S.%f') 
```

使用日期时间是正确的

```
>>> from datetime import datetime
>>> a = datetime.strptime('26/01/12 23:50:32.123', '%d/%m/%y %H:%M:%S.%f')
>>> a.microsecond 
```

# windows - RSA_public_decrypt 和 MS Crypto API 等效

> ID：14527898
> 
> 赞同：8
> 
> 时间：2013-01-25T18:15:05.267
> 
> 标签：windows, cryptography, openssl, rsa, cryptoapi

我正在尝试开发许可证验证解决方案。`RSA_private_encrypt`使用 OpenSSL 的功能在服务器上对许可证进行编码。

对于 Mac OX XI 使用`RSA_public_decrypt`，它就像一个魅力。在 Windows 上，我必须使用非常少的代码，所以我不能与 OpenSSL 或其他库链接，我必须使用 MS Crypto API。

我花了几天时间试图找出问题所在，但没有运气。我可以成功导入公钥，但我的成功到此结束。我知道我需要使用 CAPI 反转字节顺序，所以这可能不是问题。

我已经尝试了一切，包括使用不同`CryptVerifyMessageSignatureWithKey`的`CryptDecodeObject`参数加载 blob，但仍然没有运气。

它总是以 结尾`GetLastError() == CRYPT_E_ASN1_BADTAG`，我认为这意味着 BLOB 不是 ASN1 格式的......谷歌没有告诉任何关于 RSA_private_encrypt 的输出格式......所以我在这里完全迷失了。

这是基于 OpenSSL 的 OS X 代码：

```
void cr_license_init(const char* lic) {
    __cr_license_ = lic;
    unsigned char lic_encoded[CR_LIC_LEN];

    BIO* b64 = BIO_new(BIO_f_base64());
    BIO* licIn = BIO_new_mem_buf((void*)lic, -1);
    licIn = BIO_push(b64, licIn);

    if(BIO_read(licIn, lic_encoded, CR_LIC_LEN) == CR_LIC_LEN) {

        const unsigned char* key_data = license_pub_der;
        RSA* r = d2i_RSA_PUBKEY(NULL, &key_data, sizeof(license_pub_der));

        if(r != NULL) {
            if(__cr_license_data_ != NULL) {
                free((void*)__cr_license_data_);
            }
            __cr_license_data_ = malloc(CR_LIC_LEN);
            if(RSA_public_decrypt(CR_LIC_LEN, lic_encoded,
    (unsigned char*)__cr_license_data_, r, RSA_PKCS1_PADDING) &lt= 0) {
                free((void*)__cr_license_data_);
                __cr_license_data_ = NULL;
            }
            RSA_free(r);
        }
    }
    BIO_free_all(licIn);
} 
```

这部分代码在 Windows 上运行良好，所以我认为公钥不是问题。

```
__cr_license_ = lic;
unsigned char lic_encoded[CR_LIC_LEN];

DWORD dwSize;
if(CryptStringToBinaryA(__cr_license_, 0/*autocalculate*/, CRYPT_STRING_BASE64, lic_encoded, &dwSize, NULL, NULL) && dwSize == CR_LIC_LEN) {
HCRYPTPROV hProv;
if(CryptAcquireContext(&hProv, NULL, MS_ENHANCED_PROV, PROV_RSA_FULL, CRYPT_VERIFYCONTEXT)) {
    PCERT_PUBLIC_KEY_INFO pki = NULL;
    DWORD dwKeySize;
    if(CryptDecodeObjectEx(X509_ASN_ENCODING, X509_PUBLIC_KEY_INFO, license_pub_der, sizeof(license_pub_der), CRYPT_ENCODE_ALLOC_FLAG, NULL, &pki, &dwKeySize)) {
        HCRYPTKEY hKey = 0;
        if(CryptImportPublicKeyInfo( hProv, X509_ASN_ENCODING, pki, &hKey)) { 
```

但在那之后，我尝试对消息做的任何事情都会导致`CRYPT_E_ASN1_BADTAG`. 我尝试`CryptMsgOpenToDecode`使用`CryptMsgUpdate`, `CryptDecodeObject`, `CryptVerifyMessageSignatureWithKey`- 没有任何效果。

基本上我认为问题在于 owlstead 提到的 pkcs1 和 pkcs7 不兼容。有没有人有使用 MS CAPI 处理 pkcs1 格式导入/转换/等的经验？

非常感谢任何帮助甚至线索！提前致谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-25T23:28:58.900

您正在混合更高级别和更低级别的签名格式。OpenSSL 默认采用 PKCS#1 v1.5 签名，其中仅包含签名数据。Windows 似乎采用 PKCS#7 容器。这些可能包含 PKCS#1 v1.5，但这些和其他数据使用 ASN.1 BER 标签/长度格式进行包装。如果 Microsoft API 尝试对此进行解码，它将假定原始签名是容器格式，并且解码将失败。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-26T14:59:00.427

除非这很明显以至于您已经尝试过但没有列出它，或者我误解了您的问题，否则我认为您应该使用[CryptDecrypt](http://msdn.microsoft.com/en-us/library/windows/desktop/aa379913%28v=vs.85%29.aspx)来解密许可证，而不是您在问题中提到的功能。请注意，由于您似乎使用带有 PKCS#1 v1.5 填充的 OpenSSL，而 CryptoAPI 似乎不支持该功能（尚未测试，但规范仅列出 PKCS#1 v2 OAEP），您可能必须使用`CRYPT_DECRYPT_RSA_NO_PADDING_CHECK`并验证并在解密后手动删除 PKCS#1 v1.5 填充。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-12-04T16:43:53.600

OpenSSL 导出带有 CryptoAPI 不期望的额外标头的密钥。

私钥的标头（采用 ASN.1 表示法）：

```
Offset| Len  |LenByte|
======+======+=======+======================================================================
     0|   630|      3| SEQUENCE : 
     4|     1|      1|    INTEGER : 0
     7|    13|      1|    SEQUENCE : 
     9|     9|      1|       OBJECT IDENTIFIER : rsaEncryption [1.2.840.113549.1.1.1]
    20|     0|      1|       NULL : 
    22|   608|      3|    OCTET STRING : 
                             ... actual key data go here ... 
```

公钥的标头（采用 ASN.1 表示法）：

```
Offset| Len  |LenByte|
======+======+=======+======================================================================
     0|   159|      2| SEQUENCE : 
     3|    13|      1|    SEQUENCE : 
     5|     9|      1|       OBJECT IDENTIFIER : rsaEncryption [1.2.840.113549.1.1.1]
    16|     0|      1|       NULL : 
    18|   141|      2|    BIT STRING UnusedBits:0 : 
                              ... actual key data go here ... 
```

这些标头是导致 CryptDecodeObjectEx 阻塞的原因。它需要 RAW 密钥数据，没有任何标题。

所以，基本上，你需要：

1.  （可选）使用 CryptStringToBinary 将 .PEM 转换为 .DER。
2.  检查 DER 是否以上述标题开头。为此，您需要阅读 ASN.1 编码的数据。
3.  （可选）跳过上述标题并直接查找密钥的数据（以 SEQUENCE 开头，其中包括 2 INTEGER 用于公钥或 9 INTEGER 用于私钥）。
4.  将结果提供给 CryptDecodeObjectEx(X509_ASN_ENCODING, RSA_CSP_PUBLICKEYBLOB/PKCS_RSA_PRIVATE_KEY)。
5.  使用 CryptImportKey 导入密钥。

# excel - 将 MIN 与 IF 一起使用时如何排除 0？

> ID：14527900
> 
> 赞同：3
> 
> 时间：2013-01-25T18:15:06.017
> 
> 标签：excel, excel-formula

我有一个包含 2 个工作表的工作簿，`Sheet1`并且`Sheet2`.

`Sheet1`有一个要查找的值（产品代码）和一个要填充的空单元格：

```
A      B
A100
A200
B150
C3AB 
```

`Sheet2`有一堆产品代码和成本：

```
A      B
A100   35
A100   14
A100    0
A200   10
A200   12
etc, etc, etc 
```

我在 Sheet1 B1 中使用以下公式从 Sheet2 中查找 MIN 匹配值：

```
=MIN(IF(Sheet2!$A$1:$A$5=A1,Sheet2!$B$1:$B$5)) 
```

我怎样才能排除返回 0 的匹配项？对于产品 A100，我想返回最低的非零匹配，即 14。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T18:38:53.763

尝试在 B1 中将其作为数组公式提交

*未经测试*

```
=MIN(IF(((Sheet2!$A$1:$A$5=A1)*(Sheet2!$B$1:$B$5>0))>0,Sheet2!$B$1:$B$5)) 
```

我认为这会奏效

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-25T23:54:35.453

如果您在工作表 1 上添加 C 列并填写以下内容，会不会更快：

```
=IF(B1=0," ",B1) 
```

然后，作为矩阵输入的原始公式将改为引用 C 列：

```
=MIN(IF(Sheet2!$A$1:$A$5=A1,Sheet2!$C$1:$C$5)) 
```

任何人都可以评论添加另一列的速度吗？听起来这张表最多有 ~20000 行。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-25T18:38:55.357

数组公式：

```
{=SMALL(IF(Sheet2!$B$1:$B$5<>0;IF(A3=Sheet2!$A$1:$A$5;Sheet2!$B$1:$B$5;"");"");1)} 
```

在公式窗口中按 Shift-Ctrl-Enter 插入，大括号由 Excel 插入，而不是由用户插入。

`MIN``0`表现得很奇怪，也为数组中的非数字值发出。`SMALL`改为使用，`#NUM!`对不存在的引用给出错误。

电子表格示例：[http ://www.bumpclub.ee/~jyri_r/Excel/MINimal_value_ exclude_0.xls](http://www.bumpclub.ee/~jyri_r/Excel/MInimal_value_excluding_0.xls)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-25T18:24:01.283

AFAIK：要么使用 VBA 循环遍历这些值，要么：

使用类似于`=IF(a1=0,"",A1)`（为 A 列中的每个值复制下来）的公式创建另一列。然后您可以在此列上使用 min 函数。

高温高压

# mobile - 将 Flurry Analytics 集成到 MonoTouch 应用程序中

> ID：14527901
> 
> 赞同：0
> 
> 时间：2013-01-25T18:15:06.593
> 
> 标签：mobile, xamarin.ios, flurry

我已经安装了 XCode 和 MonoTouch 并构建了一个基本应用程序。

我正在尝试将 Flurry Analytics 集成到我的应用程序中。我注册并下载了 SDK，但我不知道如何处理它。我想我需要一个绑定库，我[在 GitHub 上找到了这个](https://github.com/mono/monotouch-bindings)。

我应该克隆那个存储库还是因为我安装了 MonoDevelop 而它已经安装在某个地方？我应该将它克隆到某个标准吗？

然后，我将应用程序中的引用添加到 FlurryAnalytics.dll。我需要对 FlurryAnalytics SDK 做任何事情吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-25T23:49:00.487

您只需在项目中添加对 FlurryAnalytics.dll 的引用，无需对下载的 SDK 进行任何操作。

但请记住，该 git 存储库中的 dll 可能有些过时，在这种情况下，您应该重建 dll（在这种情况下，您确实需要 SDK）。这是您需要做的：

*   在 SDK 中找到 libFlurry.a 并将其放在存储库的 FlurryAnalytics/binding 目录中。
*   打开终端并导航到存储库的 FlurryAnalytics/binding 目录。
*   执行`make`。

这应该构建一个更新的 FlurryAnalytics.dll。

# python - vim 作为 python ide

> ID：14527902
> 
> 赞同：5
> 
> 时间：2013-01-25T18:15:06.893
> 
> 标签：python, vim

Python 支持集成在最新版本的 emacs 中。例如`C-c C-z`，为我提供了一个解释器并`C-c C-c`自动解释我正在处理的文件，而无需移动到另一个缓冲区。（虽然emacs的方法有一些缺点）

这可以在 vim 中实现，还是像在 emacs 中那样简单，只需两次击键？我知道我可以用 来评估一个表达式`:python`，但这并不是我想要的。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-25T18:25:43.160

要在 python 中执行当前文件，可以使用命令`:!python %`. 您可以通过编辑 vimrc 将其绑定到键盘快捷键。例如，当你在普通模式下`nnoremap \ll :!python %<cr>`键入时，添加到你的 vimrc 将在 python 中执行当前文件。`\ll`（* 更多细节见脚注）。

vim-ipython 插件可以让你在 vim 中打开一个 ipython 窗口。您可能还对 tmux 感兴趣，它允许您将终端垂直分成两部分（这样您就可以让 shell 和 vim 并行运行）。

有很多插件可以将 vim 变成一个非常好的 python IDE。“pyflakes”，它会自动突出语法错误，是我特别喜欢的。

这篇博文广泛描述了适用于 python 的 vim 插件：

[http://sontek.net/blog/detail/turning-vim-into-a-modern-python-ide](http://sontek.net/blog/detail/turning-vim-into-a-modern-python-ide)

* * *

(*) 顺便说一句，您可能希望使此命令特定于 python 文件（在 python 解释器中执行 C++ 源代码实际上没有意义）。这可以通过将其放在目录中的特定`python.vim`文件中来完成`.vim/ftplugin`，或者通过编写

```
autocmd FileType python nnoremap \ll :!python %<cr> 
```

在你的 .vimrc 中。这样，您可以将`\ll`键盘快捷键重新绑定到不同类型文件的不同操作。

另外，如果您只想执行当前文件的一部分，请在可视模式 (SHIFT+v) 中选择相关行并键入`:!python %`命令。选定的行将通过管道传送到 python 解释器！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T18:19:56.830

为了使用击键，请参阅[vim 中的映射键](http://vim.wikia.com/wiki/Mapping_keys_in_Vim_-_Tutorial_%28Part_1%29)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-25T20:02:14.970

是的，我花了一些时间扩展 Vim 来做到这一点。我的大部分尝试都可以在 subversion 存储库中使用。查看[vim 树](https://code.google.com/p/pycopia/source/browse/#svn%2Ftrunk%2Fvim)。

Vim 也可以使用嵌入式 Python 解释器进行编译，您可以使用它来评估缓冲区中的代码行，或使用 Python 添加新功能。试试看`:help python`详情。

我使用 X Windows，所以大部分都在那个环境中工作，并从 Vim 调用一个 shell 包装器，如下所示：

1 $ 猫箱/xpython

```
#!/bin/sh

if [ $# -gt 0 ] ; then
    urxvt -title Python2 -name Python -e python -i "$@"
else
    urxvt -title Python2 -name Python -e bpython
fi 
```

因此，您可以从 Gvim 运行 xpython 而不仅仅是 python，映射到一个键（参见源代码）。这将打开一个新的终端窗口，其中包含一个运行您的代码的新 Python 实例。

# sql - 在 oracle 中查找重复值

> ID：14527903
> 
> 赞同：3
> 
> 时间：2013-01-25T18:15:15.563
> 
> 标签：sql, oracle

我正在使用此查询在表中查找重复值：

```
select col1, 
       count(col1) 
  from table1 
 group by col1 
having count (col1) > 1 
 order by 2 desc; 
```

但我也想从同一个表中添加另一列，如下所示：

```
select col1, 
       col2, 
       count(col1) 
  from table1 
 group by col1 
having count (col1) > 1 
 order by 2 desc; 
```

我收到`ORA-00979`第二个查询错误

如何在搜索中添加另一列？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-25T18:23:02.347

您的查询应该是

```
SELECT * FROM (
select col1, 
col2, 
count(col1) over (partition by col1) col1_cnt
from table1 
)
WHERE col1_cnt > 1 
order by 2 desc; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-25T18:24:41.040

大概你想得到`col2`每个`col1`出现的副本。您不能在单个查询中真正做到这一点^。相反，您需要做的是获取重复项列表，然后使用它来检索任何其他关联值：

```
select col1, col2
from  table1
where col1 in (select col1
               from table1 
               group by col1 
               having count (col1) > 1)
order by col2 desc 
```

* * *

^ 好的，您可以使用解析函数作为@rs。证明了。对于这种情况，我怀疑嵌套查询会更有效，但两者都应该给你相同的结果。

* * *

根据评论，您似乎不清楚为什么不能只添加第二列。假设您有如下示例数据：

```
Col1 | Col2
-----+-----
   1 |   A
   1 |   B
   2 |   C
   2 |   D
   3 |   E 
```

如果你跑

```
select Col1, count(*) as cnt 
from table1 
group by Col1
having count(*) > 1 
```

那么你的结果将是：

```
Col1 | Cnt
-----+-----
   1 |   2
   2 |   2 
```

您不能只添加`Col2`到此查询而不将其添加到`group by`子句，因为数据库将无法知道您实际想要的值（即对于 Col1=1，数据库应该返回“A”还是“B”？）。如果将 Col2 添加到`group by`子句中，则会得到以下结果：

```
select Col1, Col2, count(*) as cnt 
from table1 
group by Col1, Col2
having count(*) > 1

Col1 | Col2 | Cnt
-----+------+----
[no results] 
```

这是因为计数是针对`Col1`and的每个组合`Col2`（每个组合都是唯一的）。

最后，通过使用嵌套查询（如我的回答）或分析函数（如@rs.的回答），您将得到以下结果（查询稍作更改以返回计数）：

```
select t1.col1, t1.col2, cnt 
from  table1 t1
join (select col1, count(*) as cnt
      from table1 
      group by col1 
      having count (col1) > 1) t2
on table1.col1 = t2.col1

Col1 | Col2 | Cnt
-----+------+----
   1 |   A  |   2
   1 |   B  |   2
   2 |   C  |   2
   2 |   D  |   2 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-25T18:20:34.523

您还应该在 group by 子句中列出所有选定的列。

```
select col1, 
       col2, 
       count(col1) 
  from table1 
 group by col1, col2
having count (col1) > 1 
 order by 2 desc; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-25T18:20:36.390

**错误原因**

> 您尝试执行一个 SQL SELECT 语句，该语句包括一个 GROUP BY 函数（即：SQL MIN 函数、SQL MAX 函数、SQL SUM 函数、SQL COUNT 函数）和一个不在 SQL GROUP BY 子句中的 SELECT 列表中的表达式。

```
select col1, 
    col2, 
    count(col1) 
    from table1 
    group by col1,col2
    having count (col1) > 1 
    order by 2 desc; 
```

# mysql - 如果唯一，如何进行 MySQL 插入，但列对于唯一索引来说太长了

> ID：14527907
> 
> 赞同：0
> 
> 时间：2013-01-25T18:15:34.317
> 
> 标签：mysql, indexing

我找到了一个很好的答案，当插入新记录时，如果数据已经存在，请忽略。

1）在列上创建一个唯一索引。

2）插入忽略到...

但我的问题是其中一列是 VARCHAR(2000)**，并且 MySQL 对索引有 1000 个字符的限制。

这些列是：id (int)、type (varchar 35)、data (varchar 2000)

那么有没有办法确保我不会通过单个查询两次添加相同的数据？还是我需要先进行选择以检查是否存在，如果为假，则执行插入？

谢谢。

** 这不是设计，我只是在移动数据，所以没有机会缩小此列。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T18:31:44.050

鉴于您提到的表格设计：

```
CREATE TABLE mydb.mytable
(
    id int not null auto_increment,
    type varchar(35),
    data varchar(2000),
    primary key (id)
); 
```

您最好的机会如下：

```
CREATE TABLE mydb.mytable_new LIKE mydb.mytable;
ALTER TABLE mydb.mytable_new ADD COLUMN data_hash CHAR(40);
ALTER TABLE mydb.mytable_new ADD UNIQUE INDEX (data_hash);

INSERT INTO mydb.mytable_new (id,type,data,data_hash)
  SELECT id,type,data,UPPER(SHA(data)) FROM mydb.mytable;

ALTER TABLE mydb.mytable RENAME mydb.mytable_old;
ALTER TABLE mydb.mytable_new RENAME mydb.mytable;
DROP TABLE mydb.mytable_old; 
```

添加此新列和索引后，表现在应如下所示：

```
CREATE TABLE mydb.mytable
(
    id int not null auto_increment,
    type varchar(35),
    data varchar(2000),
    data_hash char(40),
    primary key (id),
    unique key data_hash (data_hash)
); 
```

只需执行以下操作：

# 插入

```
INSERT INTO mydb.mytable (type,data,data_hash)
VALUES ('somtype','newdata',UPPER(SHA('newdata'))); 
```

如果您尝试重复键插入，则 INSERT 应该在 data_hash 上失败

# 选择

```
SELECT * FROM mydb.mytable
WHERE data_hash = UPPER(SHA('data_I_am_searching_for')); 
```

试试看 ！！！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-10-20T21:36:04.277

哈希有冲突，所以除非你不关心，否则这不是一个万无一失的解决方案

# ruby - NoMethodError .to_i 红宝石

> ID：14527911
> 
> 赞同：0
> 
> 时间：2013-01-25T18:15:39.603
> 
> 标签：ruby, arrays, ruby-on-rails-3

ruby 中的基本代码对我不起作用....错误指定

NoMethodError（未定义的方法 `to_i'

```
row = row.split(",").map { |x| x.to_i } 
```

编辑：

```
NoMethodError (undefined method `to_i' for [["123,123,123,"]]:Array):
  app/controllers/sessions_controller.rb:21:in `import'
  app/controllers/sessions_controller.rb:20:in `each'
  app/controllers/sessions_controller.rb:20:in `import'
  app/controllers/sessions_controller.rb:17:in `each'
  app/controllers/sessions_controller.rb:17:in `import'

  Rendered /Library/Ruby/Gems/1.8/gems/actionpack-3.2.11/lib/action_dispatch/middleware/templates/rescues/_trace.erb (1.0ms)
  Rendered /Library/Ruby/Gems/1.8/gems/actionpack-3.2.11/lib/action_dispatch/middleware/templates/rescues/_request_and_response.erb (0.7ms)
  Rendered /Library/Ruby/Gems/1.8/gems/actionpack-3.2.11/lib/action_dispatch/middleware/templates/rescues/diagnostics.erb within rescues/layout (8.2ms) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-03-23T14:59:29.903

您收到该错误是因为您在数组上调用 .to_i 方法，这是错误的，因为该方法属于 String 类，来源：[http ://www.ruby-doc.org/core-2.1.0 /String.html#method-i-to_i](http://www.ruby-doc.org/core-2.1.0/String.html#method-i-to_i)

所以为了解决这个问题，我们需要从数组中取出那个字符串，这样我们就可以把它变成一个整数，记住你从一个包含数组的数组开始，所以这就是我调用 .pop 两次的原因：

```
 row = [["123, 123, 123"]]
    string_of_numbers = row.pop.pop
    string_of_numbers.split(",").map {|x| x.to_i } 
```

如果觉得在 irb 上玩起来太奇怪了，我通常就是这样尝试解决这些问题的，别忘了总是参考官方文档

# scala - Scala内部类懒惰

> ID：14527913
> 
> 赞同：1
> 
> 时间：2013-01-25T18:15:52.720
> 
> 标签：scala

我有不可变的类 Outer 和 Inner 如下：

```
class Outer(val intra: Outer#Inner) {
    class Inner(val q: Int)
} 
```

我想创建一个相互引用的 Outer 和 Inner 实例，如下所示：

```
val outer = new Outer(inner)
val inner = new outer.Inner(5) 
```

但是，当然，此代码不会编译，因为值“inner”在第一行中被引用，然后在第二行中定义。

如果我在这两行的“val”关键字之前添加了“lazy”关键字，它会编译，但会在运行时产生堆栈溢出异常。

我知道如果我让类 Outer 像这样可变，我可以解决这个问题：

```
class Outer(var intra: Outer#Inner) {
    class Inner(val q: Int)
}
val outer = new Outer()
val inner = new outer.Inner(5)
outer.intra = inner 
```

但我想保持类不可变。我怎么解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T18:28:49.140

您可以像这样更改定义：

```
class Outer(_intra: => Outer#Inner) {
  lazy val intra = _intra
  class Inner(val q: Int)
} 
```

# gtk - 带有 vala 条目的 gtk.combobox 的宽度

> ID：14527914
> 
> 赞同：1
> 
> 时间：2013-01-25T18:15:55.237
> 
> 标签：gtk, vala

我从 vala 开始，我无法设置 Gtk.ComboBox 的宽度。在 Python 中，我可以这样做：

```
combo = Gtk.ComboBox.new_with_entry()
entry = combo.get_child()
entry.set_width_chars(12) 
```

在瓦拉这个：

```
var combo = new ComboBox.with_entry ();
var entry = combo.get_child();
entry.set_width_chars(12); 
```

给出：

```
error: The name `set_width_chars' does not exist in the context of `Gtk.Widget' 
```

尽管如此：

```
var combo = new ComboBox.with_entry ();
var entry = combo.get_child();
if (entry is Gtk.Entry)
    stdout.printf("Entry!\n") 
```

打印“Entry！”，那么问题出在哪里？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-25T18:36:43.587

（免责声明：我对 vala 的了解非常有限，但我希望这会有所帮助）
问题可能是 from 的返回类型`get_child()`，它是`Gtk.Bin`返回的函数，而`Gtk.Widget`不是有效的函数。这是因为子小部件可以是任何小部件。尝试静态类型转换：`Gtk.Entry``set_width_char()``Gtk.Bin`

```
var entry = (Entry)combo.get_child(); 
```

或更复杂的版本

```
var entry = combo.get_child();
((Entry)entry).set_width_chars(12); 
```

至于成功的类型检查`Gtk.Entry`，尽管您拥有`Gtk.Widget`的类型是`Gtk.Entry`作为子项添加`combobox`的条目。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T18:34:54.133

问题是 Vala 不是 Python，没有 set_width_chars() 函数。在 Vala 中有一个 width_chars 属性。试试这个：

```
entry.width_chars = 12; 
```

请查看[http://www.valadoc.org/#!wiki=gtk+-3.0/index](http://www.valadoc.org/#!wiki=gtk+-3.0/index)上的文档。特别是：[http](http://www.valadoc.org/#!api=gtk+-3.0/Gtk.Entry.width_chars) ://www.valadoc.org/#!api=gtk+-3.0/Gtk.Entry.width_chars 。

编辑：实际上有一个 Entry.set_width_chars()。无论如何，在 Vala 有一些属性通常用于这种事情。

# matlab - 使用 Matlab 生成幅度在 [-1 1] 之间的白噪声

> ID：14527915
> 
> 赞同：2
> 
> 时间：2013-01-25T18:16:07.890
> 
> 标签：matlab, random, noise

我正在使用 Matlab 函数`Y = WGN(M,N,P)`生成具有高斯分布的白噪声。此函数使用功率值 (dB Watts) 来计算输出信号的幅度。由于我想获得 -1 V 至 1 V 的输出幅度范围，因此存在“线性”功能模式。

我正在尝试使用“线性”模式来产生输出，但结果是输出幅度范围为 [-4 4]

```
RandomSignal = wgn(10000,1,1,1,'linear');
Time = linspace(0,10,10000);
figure()
plot(Time,RandomSignal)

figure()
hist(RandomSignal,100) 
```

是否有另一个函数可以产生这个结果，或者我只是做错了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-25T21:51:56.017

正如其他人所说，您不能限制高斯分布。您可以做的是将您的范围定义为 6 个标准偏差，然后使用 randn(m,sigma) 生成您的信号。

例如，如果您想要 [-1 1] 的范围，您将选择 sigma=2/6=0.333 和 Mu=0。这将创造 99.7% 的机会在该范围内。然后，您可以向上和向下舍入超出范围的数字。

这将不是纯高斯分布，但这是您可以获得的最接近的分布。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-09-29T07:39:58.853

为什么你只取任何边界的 randn 函数，然后像这个 ex 一样对其进行标准化。

```
 noise=randn(400); noise=noise./max(max(noise)); 
```

所以无论 randn 的输出是什么，最终你都会在 [-1 1] 内有一个 wn。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-25T18:24:27.417

高斯噪声的范围是无限的。（高斯 pdf 的支持是无限的。）

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-01-25T18:36:27.987

您可以使用`rand`而不是高斯生成器。的输出范围`rand`是 0-1，因此要使其在 -1 1 范围内，请使用`rand(args)*2 -1`.

应该注意的是，这个生成器正在采样一个均匀的密度。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-25T18:21:38.220

不想说很不对的东西，但是当我复制你的代码并改变时

```
RandomSignal = .25*wgn(10000,1,1,1,'linear'); 
```

那时没关系。希望它对你有用。（假设随机数据/4 仍然是随机数据）

# c - 如何在C中为变量实现dup函数

> ID：14527928
> 
> 赞同：-2
> 
> 时间：2013-01-25T18:16:56.843
> 
> 标签：c, pointers

我有这个：

```
void duplication(int **tab1, int **tab2, int n, int m) 
```

目标是将 tab1 复制到 tab2 中，所以我会得到相同的两个表。

我该怎么做，因为我知道 using`tab2 = tab1`在我的情况下不起作用:)

对不起，如果这是一个愚蠢的问题，我实际上正在学习 C！

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T18:23:10.210

假设 n 和 m 是维度，并且您知道哪个维度适用于哪个维度，您需要一个类似这样的双循环：

```
for ( int x = 0; x < n; ++x )
{
    for ( int y = 0; y < m; ++y )
    {
        tab2[x][y] = tab1[x][y];
    }
} 
```

鉴于您提供的函数的文档，这是我做出的几个重要假设，但希望代码能让您了解需要做什么，并且您可以在正确的位置替换正确的变量。

为了进一步参考，与这种数据复制相关的术语是所谓的“深度复制”。在处理指针时，复制指针值通常是不够的，而且经常是不安全的。如果您想要更多关于此类代码的参考资料，请搜索“深拷贝”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T18:27:40.200

您可以使用嵌套`for`循环。通常复制任何变量，复制变量的内存分配应该在该函数内完成。复制功能应如下所示。

```
int ** dup_tab(int **sr_table, int n, int m)
{
     int **dest_tabl = NULL;
     int i = 0;
     int j = 0;
     dest_tabl = malloc(sizeof(int *) * n);
     for (i = 0; i < n; i++)
     {
         dest_tabl[i] = malloc(sizeof(int) * m);
     }

     for (i = 0; i < n; i++)
     {
         for (j = 0; j < m; j++)
         {
             dest_tabl[i][j] = sr_table[i][j];
         }
     }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-25T18:34:07.147

您应该建立一个具有底层内存“管理”的观点。

可能您正在寻找类似的功能

```
// defined in <string.h> and conform to C99

void memcpy(void *dest, const void *src, size_t n); 
```

`n`它将字节从 的开头复制`src`到`dest`.

与您的问题相关，如果您想使用此功能，您必须知道指向`N`的对象`*tab1`的大小以及指向的每个对象的大小`M_i`（`tab[i]`使用`i < N`）。如果您有此信息，您可以根据以下内容解决您的问题

[C / C ++如何复制没有嵌套循环的多维char数组？](https://stackoverflow.com/questions/2225850/c-c-how-to-copy-a-multidimensional-char-array-without-nested-loops)

# c# - .Net 自定义 TraceListener.TraceEvent 未触发

> ID：14527942
> 
> 赞同：6
> 
> 时间：2013-01-25T18:18:02.733
> 
> 标签：c#, asp.net, logging, msbuild, tracelistener

我们有一个自定义 TraceListener（继承自 System.Diagnostics.TraceListener），用于我们的 ASP.NET Web 应用程序日志记录。它运行良好 - 没有问题。然后它突然停止在我们的开发环境中工作（TraceListener.TraceEvent() 停止触发）。我们对它为什么停止工作感到困惑。我们真正对代码所做的唯一更改是添加了更多构建配置（Dev、Test、Stage、Prod）。之前，它只有 Debug 和 Release。

我注意到，当我在本地测试使用 Debug 配置构建时，TraceListener.TraceEvent() 被触发得很好。当我切换到另一个构建配置（即测试）时，TraceEvent() 将不再被触发。这是我的网络 .csproj 文件的片段：

```
<PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Debug|AnyCPU' ">
  <DebugSymbols>true</DebugSymbols>
  <DebugType>full</DebugType>
  <Optimize>false</Optimize>
  <OutputPath>bin\</OutputPath>
  <DefineConstants>TRACE;DEBUG;SkipPostSharp</DefineConstants>
  <ErrorReport>prompt</ErrorReport>
  <WarningLevel>4</WarningLevel>
  <ExcludeGeneratedDebugSymbol>false</ExcludeGeneratedDebugSymbol>
  <PlatformTarget>AnyCPU</PlatformTarget>
</PropertyGroup>
<PropertyGroup Condition="'$(Configuration)|$(Platform)' == 'Dev|AnyCPU'">
  <OutputPath>bin\</OutputPath>
  <DefineConstants>TRACE</DefineConstants>
</PropertyGroup>
<PropertyGroup Condition="'$(Configuration)|$(Platform)' == 'Test|AnyCPU'">
  <DebugSymbols>true</DebugSymbols>
  <DebugType>full</DebugType>
  <Optimize>false</Optimize>
  <OutputPath>bin\</OutputPath>
  <DefineConstants>TRACE;DEBUG;SkipPostSharp</DefineConstants>
  <ErrorReport>prompt</ErrorReport>
  <WarningLevel>4</WarningLevel>
  <ExcludeGeneratedDebugSymbol>false</ExcludeGeneratedDebugSymbol>
  <PlatformTarget>AnyCPU</PlatformTarget>
</PropertyGroup>
<PropertyGroup Condition="'$(Configuration)|$(Platform)' == 'Stage|AnyCPU'">
  <OutputPath>bin\</OutputPath>
  <DefineConstants>TRACE</DefineConstants>
</PropertyGroup>
<PropertyGroup Condition="'$(Configuration)|$(Platform)' == 'Prod|AnyCPU'">
  <OutputPath>bin\</OutputPath>
  <DefineConstants>TRACE</DefineConstants>
</PropertyGroup>
<PropertyGroup Condition="'$(Configuration)|$(Platform)' == 'Release|AnyCPU'">
  <OutputPath>bin\</OutputPath>
  <DefineConstants>TRACE</DefineConstants>
</PropertyGroup> 
```

我不确定为什么切换构建配置似乎会关闭我们的日志记录。谁能指出我正确的方向？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-28T16:36:06.113

想通了这个问题。我调用 System.Diagnostics.TraceSource.TraceEvent() 来广播跟踪事件的代码在*另一个*项目中。我需要通过以下方式启用*对该*项目的跟踪：

```
<DefineConstants>TRACE</DefineConstants> 
```

我错误地认为我需要关注的只是主要目标项目（即 Web 项目）。现在有意义 - 调用 System.Diagnostics.TraceSource.TraceEvent() 的项目/程序集必须启用跟踪（通过目标构建配置的项目属性）才能广播这些跟踪。然后您的跟踪侦听器可以听到它们。:)

# jquery-ui-tooltip - jQuery UI 工具提示 - 显示内联内容

> ID：14527943
> 
> 赞同：0
> 
> 时间：2013-01-25T18:18:07.440
> 
> 标签：jquery-ui-tooltip

我无法在 jQuery UI 工具提示小部件中显示隐藏的内联内容。这是我到目前为止所拥有的：

```
$("a.tooltip").tooltip({
        content: function() {
                $('table').show();
                return $('table');              
        }

    }); 
```

有问题的表格默认设置为不显示。上面的代码显示了工具提示中的表格，但是，如果我将鼠标悬停在激活工具提示的链接上并返回到它，则会显示一个空的工具提示，而没有我的内联内容。我怀疑我想在鼠标离开工具提示时调用 destroy() 方法，但不知道该把它放在哪里。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T18:47:19.777

你需要重新绑定内容

```
$("a.tooltip").on('mouseenter', '.sourceItem', function(){
    $(this).find('.table').show();              
    }).on('mouseleave', '.sourceItem', function(){
    $('.tooltip').hide();
}); 
```

使用在功能上使用的 jQuery。将其放在 ready 事件中。

# meteor - 如何获取 selectedItem 并同时处理按钮单击事件？

> ID：14527946
> 
> 赞同：2
> 
> 时间：2013-01-25T18:18:23.123
> 
> 标签：meteor

而不是先选择一个项目，然后使用按钮对所选项目执行一些操作，我希望用户执行一次单击。

它似乎有效，但我担心按钮上的事件必须在 carpool_event 上的事件之后发生。这似乎不正确。有没有更好的方法来处理这个？谢谢！

在我的 HTML

```
<template name="carpool_list">
  <h1>Carpool</h1>
  {{#each carpool_events}}
  <ul>
    {{> carpool_event}}
  </ul>
  {{else}}
    No events yet.
  {{/each}}
</template>

<template name="carpool_event">
  <div class="carpool_event">
    <span class="localDate">{{localDate}}</span>
    <span class="owner">{{owner}}</span>
    {{#if currentUser}}
      <span><input type="button" class="takeEvent" value="Take Event"/></span>
    {{/if}}
  </div>
</template> 
```

对应的js

```
Template.carpool_event.events({
    'click': function () {
      Session.set("selected_carpool_event", this._id);
    }
  });

Template.carpool_list.events({
    /**
     * Take Event Handler
     */
    'click .takeEvent': function () {
      console.log("Take event:"+Session.get("selected_carpool_event"));
    }
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T18:58:53.750

你可以试试这个：

```
Template.carpool_event.events({
"click": function () {
      Session.set("selected_carpool_event", this._id);
      if($(event.target).attr("class") == "takeEvent" && Meteor.userId) {
         console.log("Take event:"+this._id);
      }
    }
}); 
```

或者如果您出于某种其他原因想要两次点击，或者您可以避免捕获第一次点击，您可以直接定位按钮，`this._id`也应该在按钮上工作（您可以为模板内任何位置的按钮分配处理程序到相同`carpool_event`的模板）

```
Template.carpool_event.events({
    /**
     * Take Event Handler
     */
    "click .takeEvent": function () {
       Session.set("selected_carpool_event", this._id);
       if(Meteor.userId) {
           console.log("Take event:"+this._id);
       }
    }
}); 
```

# javascript - 将 css 类存储到 cookie 中

> ID：14527950
> 
> 赞同：-6
> 
> 时间：2013-01-25T18:18:31.803
> 
> 标签：javascript, jquery, css, cookies

我想知道如何将 hide() 方法存储到 cookie 中并在一年内过期

Hide 隐藏了我的 div 标签，标签为 onclick="removeThis(this);"

```
<script type="text/javascript" >
  function removeThissearch(field)
  {
    $(field).parent().hide();
  }
</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T18:21:54.953

您需要将值存储到 cookie 而不是整个方法中。

然后根据 cookie 的值（或者它是否存在），您将通过在页面加载时检查 cookie 值来知道是否显示该字段。

# md5 - VHDL 中的 3 级 MD5 流水线

> ID：14527955
> 
> 赞同：15
> 
> 时间：2013-01-25T18:18:49.993
> 
> 标签：md5, vhdl, fpga, pipelining

我正在尝试根据[此链接](http://www.springer.com/cda/content/document/cda_downloaddocument/9781441980793-c1.pdf)实现 3 阶段 MD5 管道。特别是第 31 页的算法。还有另一个[文档](https://www.jstage.jst.go.jp/article/ipsjtrans/2/0/2_0_15/_pdf)描述了数据转发。[RFC1321](http://www.ietf.org/rfc/rfc1321.txt)中描述了 MD5 算法。这是在 FPGA (Terasic DE2-115) 中完成的。本项目没有原理图，只有VHDL代码

```
library ieee;
use ieee.std_logic_1164.all;
use ieee.numeric_std.all;

entity md5core is
    port (
        CLOCK_50        : in std_logic;
        SW              : in std_logic_vector(17 downto 17)
    );
end entity md5core;

architecture md5core_rtl of md5core is
type r_array is array(0 to 64) of std_logic_vector(7 downto 0);
constant R        : r_array := ( x"07", x"0c", x"11", x"16", x"07", x"0c", x"11", x"16", x"07", x"0c", x"11", x"16", x"07", x"0c", x"11", 
                                 x"16", x"05", x"09", x"0e", x"14", x"05", x"09", x"0e", x"14", x"05", x"09", x"0e", x"14", x"05", x"09",
                                 x"0e", x"14", x"04", x"0b", x"10", x"17", x"04", x"0b", x"10", x"17", x"04", x"0b", x"10", x"17", x"04",
                                 x"0b", x"10", x"17", x"06", x"0a", x"0f", x"15", x"06", x"0a", x"0f", x"15", x"06", x"0a", x"0f", x"15",
                                 x"06", x"0a", x"0f", x"15", others => x"00");

type k_array is array(0 to 66) of std_logic_vector(31 downto 0);
constant K        : k_array := (x"d76aa478", x"e8c7b756", x"242070db", x"c1bdceee",
                                x"f57c0faf", x"4787c62a", x"a8304613", x"fd469501",
                                x"698098d8", x"8b44f7af", x"ffff5bb1", x"895cd7be",
                                x"6b901122", x"fd987193", x"a679438e", x"49b40821", 
                                x"f61e2562", x"c040b340", x"265e5a51", x"e9b6c7aa",
                                x"d62f105d", x"02441453", x"d8a1e681", x"e7d3fbc8",
                                x"21e1cde6", x"c33707d6", x"f4d50d87", x"455a14ed",
                                x"a9e3e905", x"fcefa3f8", x"676f02d9", x"8d2a4c8a",
                                x"fffa3942", x"8771f681", x"6d9d6122", x"fde5380c",
                                x"a4beea44", x"4bdecfa9", x"f6bb4b60", x"bebfbc70",
                                x"289b7ec6", x"eaa127fa", x"d4ef3085", x"04881d05",
                                x"d9d4d039", x"e6db99e5", x"1fa27cf8", x"c4ac5665",
                                x"f4292244", x"432aff97", x"ab9423a7", x"fc93a039",
                                x"655b59c3", x"8f0ccc92", x"ffeff47d", x"85845dd1",
                                x"6fa87e4f", x"fe2ce6e0", x"a3014314", x"4e0811a1",
                                x"f7537e82", x"bd3af235", x"2ad7d2bb", x"eb86d391", others => x"00000000");

type g_array is array(0 to 64) of integer range 0 to 15;
constant g_arr      : g_array := (0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15,
                                          1, 6, 11, 0, 5, 10, 15, 4, 9, 14, 3, 8, 13, 2, 7, 12,
                                          5, 8, 11, 14, 1, 4, 7, 10, 13, 0, 3, 6, 9, 12, 15, 2,
                                          0, 7, 14, 5, 12, 3, 10, 1, 8, 15, 6, 13, 4, 11, 2, 9, 0);                                               

type w_array is array(0 to 15) of std_logic_vector(31 downto 0);
signal W            : w_array;

constant AA        : std_logic_vector(31 downto 0) := x"67452301";
constant BB        : std_logic_vector(31 downto 0) := x"EFCDAB89";
constant CC        : std_logic_vector(31 downto 0) := x"98BADCFE";
constant DD        : std_logic_vector(31 downto 0) := x"10325476";

signal res_A    : std_logic_vector(31 downto 0) := x"00000000";
signal res_B    : std_logic_vector(31 downto 0) := x"00000000";
signal res_C    : std_logic_vector(31 downto 0) := x"00000000";
signal res_D    : std_logic_vector(31 downto 0) := x"00000000";

type in_str_t is array(0 to 5) of std_logic_vector(7 downto 0);
constant in_str    : in_str_t := (x"68", x"65", x"6c", x"6c", x"6f", x"6f");

type pad_str_t    is array(0 to 63) of std_logic_vector(7 downto 0);
signal pad_str    : pad_str_t;

type state_t is (start, padding, init_w, state_1, state_2, state_3, state_4, done);
signal state    : state_t;

signal a, b, c, d, f    : std_logic_vector(31 downto 0) := x"00000000";
signal i                : integer range 0 to 64 := 0;
signal g                        : integer range 0 to 15 := 0;
--signal tmp_b              : std_logic_vector(31 downto 0);

signal akw                  : std_logic_vector(31 downto 0);
signal ak                   : std_logic_vector(31 downto 0);
signal b_tmp                : std_logic_vector(31 downto 0);
begin

    --tmp_b <= std_logic_vector(unsigned(b) + rotate_left(unsigned(a) + unsigned(f) + unsigned(K(i)) + unsigned(W(g)), to_integer(unsigned(R(i)))));

    pipe_p : process(CLOCK_50, SW, a, b, c, d, i)
    begin
        if SW(17) = '0' then
--          ak <= std_logic_vector(unsigned(K(2)) + unsigned(BB));
--          akw <= std_logic_vector(unsigned(W(0)) + 1 + unsigned(K(2)) + unsigned(BB));
            b_tmp <= BB;
        elsif rising_edge(CLOCK_50) and state = state_1 then
            if i = 0 then
                ak <= std_logic_vector(unsigned(K(0)) + unsigned(a));
            elsif i = 1 then
                ak <= std_logic_vector(unsigned(K(1)) + unsigned(a));
                akw <= std_logic_vector(unsigned(W(0)) + unsigned(ak));
            elsif i = 2 then
                ak <= std_logic_vector(unsigned(K(2)) + unsigned(a));
                akw <= std_logic_vector(unsigned(W(1)) + unsigned(ak));
                b_tmp <= std_logic_vector(unsigned(b) + (rotate_left(unsigned(akw) + unsigned(f), to_integer(unsigned(R(0))))));
            else
                ak <= std_logic_vector(unsigned(K(i)) + unsigned(a));
                akw <= std_logic_vector(unsigned(W(g_arr(i-1))) + unsigned(ak));
                b_tmp <= std_logic_vector(unsigned(b) + (rotate_left(unsigned(akw) + unsigned(f), to_integer(unsigned(R(i-2))))));
            end if;
        end if;
    end process pipe_p;

    md5_f_p : process(state, a, b, c, d, i)
    begin 
        case state is
            when state_1 =>
                if i = 0 or i > 4 then
                    f <= (b and c) or ((not b) and d);
                    g <= g_arr(i);
                end if;

            when state_2 =>
            f <= (d and b) or ((not d) and c);
                g <= g_arr(i);

            when state_3 =>
                f <= b xor c xor d;
            g <= g_arr(i);

            when state_4 =>
                f <= c xor (b or (not d));
            g <= g_arr(i);

            when others =>
                f <= x"00000000";
                g <= 0;             

        end case;
    end process md5_f_p;

     md5_p : process(CLOCK_50, SW, a, b, c, d, f, g)
     begin
        if SW(17) = '0' then
            state <= start;
                i <= 0;
                a <= AA;
            b <= BB;
            c <= CC;
            d <= DD;                
            W <= (others => x"00000000");
                pad_str <= (others => x"00");
                --tmp_b := BB;
        elsif rising_edge(CLOCK_50) then
            case state is            
                when start =>

                    pad_str(0) <= in_str(0);
                    pad_str(1) <= in_str(1);
                    pad_str(2) <= in_str(2);
                    pad_str(3) <= in_str(3);
                    pad_str(4) <= in_str(4);
                    pad_str(5) <= in_str(5);
                    state <= padding;

                when padding =>
                    pad_str(6) <= "10000000";
                    pad_str(56) <= std_logic_vector(to_unsigned(in_str'length*8, 8));
                          state <= init_w;

                when init_w =>                
                    W(0) <= pad_str(3) & pad_str(2) & pad_str(1) & pad_str(0);
                    W(1) <= pad_str(7) & pad_str(6) & pad_str(5) & pad_str(4);
                    W(14) <= pad_str(59) & pad_str(58) & pad_str(57) & pad_str(56);
                          state <= state_1;

                when state_1 =>
                          if i = 16 then
                              state <= state_2;
                          else 
                        if i > 2 then
                                    --tmp_b := b;
                                    a <= d;
                                    c <= b;
                                    d <= c;
                                    b <= b_tmp;

--                                  d <= c;
--                                  b <= b_tmp;
--                                  c <= b;
--                                  a <= d;
                                end if;
                                i <= i + 1;
                    end if;

                when state_2 =>
                    if i = 32 then
                        state <= state_3;
                          else                  
                        d <= c;
                        b <= b_tmp;
                                c <= b;
                        a <= d;
                        i <= i + 1;
                    end if;

                when state_3 =>
                    if i = 48 then
                                state <= state_4;
                          else
                        d <= c;
                        b <= b_tmp;
                                c <= b;
                        a <= d;
                        i <= i + 1;
                    end if;

                when state_4 =>
                    if i = 64 then
                                res_A <= std_logic_vector(unsigned(AA) + unsigned(a));
                                res_B <= std_logic_vector(unsigned(BB) + unsigned(b));
                                res_C <= std_logic_vector(unsigned(CC) + unsigned(c));
                                res_D <= std_logic_vector(unsigned(DD) + unsigned(d));
                                state <= done;
                    else
                        d <= c;
                        c <= b;
                                b <= b_tmp;
                        a <= d;
                        i <= i + 1;
                    end if;

                when done =>
                    state <= done;

                when others =>
                    state <= done;

            end case;
        end if;
    end process md5_p;
end architecture md5core_rtl; 
```

使用此代码，我在第 0 轮的第一阶段得到了正确的值`b`，但此后似乎没有什么合适的。从这个模拟中可以看出，第 0 轮的第一阶段是正确的，但之后就不是了。这是`a`在此表达式中使用时：

```
ak <= std_logic_vector(unsigned(K(0)) + unsigned(a)); -- using a 
```

![模拟](../Images/8ad5d5ac07fac855ccd8cb42aa31e551.png)

但是...如果我正确理解了第二个文档，我应该使用`c`而不是`a`（数据转发），但是第 0 轮的第一阶段也不起作用。即，当我这样做时，第 0 轮的第一阶段也会得到错误的数字。

```
ak <= std_logic_vector(unsigned(K(0)) + unsigned(c)); -- changed to c 
```

对于代码 ( `helloo`) 中的特定字符串，以下值是正确的（所有阶段）。

```
i:0 => a:271733878, b:3679623978, c:4023233417, d:2562383102, f:2562383102, g:0
i:1 => a:2562383102, b:268703616, c:3679623978, d:4023233417, f:3421032412, g:1
i:2 => a:4023233417, b:566857930, c:268703616, d:3679623978, f:4291410697, g:2
i:3 => a:3679623978, b:2813098031, c:566857930, d:268703616, f:3658619808, g:3
i:4 => a:268703616, b:3540887984, c:2813098031, d:566857930, f:831002506, g:4
i:5 => a:566857930, b:1416558949, c:3540887984, d:2813098031, f:2748069994, g:5
i:6 => a:2813098031, b:1417573490, c:1416558949, d:3540887984, f:4086081834, g:6
i:7 => a:3540887984, b:412978483, c:1417573490, d:1416558949, f:3614439904, g:7
i:8 => a:1416558949, b:2667121787, c:412978483, d:1417573490, f:1417573494, g:8
i:9 => a:1417573490, b:3587014656, c:2667121787, d:412978483, f:1486847027, g:9
i:10 => a:412978483, b:2424005293, c:3587014656, d:2667121787, f:2631470387, g:10
i:11 => a:2667121787, b:3779826569, c:2424005293, d:3587014656, f:2663976018, g:11
i:12 => a:3587014656, b:2371593944, c:3779826569, d:2424005293, f:2496594569, g:12
i:13 => a:2424005293, b:2829036837, c:2371593944, d:3779826569, f:2439758509, g:13
i:14 => a:3779826569, b:1652927941, c:2829036837, d:2371593944, f:3378230920, g:14
i:15 => a:2371593944, b:343664023, c:1652927941, d:2829036837, f:2917117725, g:15
i:16 => a:2829036837, b:3610776431, c:343664023, d:1652927941, f:1109108165, g:1
i:17 => a:1652927941, b:2356907245, c:3610776431, d:343664023, f:1450852695, g:6
i:18 => a:343664023, b:1950114052, c:2356907245, d:3610776431, f:3346765549, g:11
i:19 => a:3610776431, b:1998115502, c:1950114052, d:2356907245, f:1551601028, g:0
i:20 => a:2356907245, b:2811855282, c:1998115502, d:1950114052, f:1948049836, g:5
i:21 => a:1950114052, b:1476613917, c:2811855282, d:1998115502, f:655922090, g:10
i:22 => a:1998115502, b:1051434612, c:1476613917, d:2811855282, f:3498136348, g:15
i:23 => a:2811855282, b:2313778686, c:1051434612, d:1476613917, f:2123093565, g:4
i:24 => a:1476613917, b:2391742621, c:2313778686, d:1051434612, f:782884220, g:9
i:25 => a:1051434612, b:2587925491, c:2391742621, d:2313778686, f:2412476830, g:14
i:26 => a:2313778686, b:1270631524, c:2587925491, d:2391742621, f:2386958835, g:3
i:27 => a:2391742621, b:2967137637, c:1270631524, d:2587925491, f:449612646, g:8
i:28 => a:2587925491, b:4275359302, c:2967137637, d:1270631524, f:3523005797, g:13
i:29 => a:1270631524, b:221196138, c:4275359302, d:2967137637, f:4208389445, g:2
i:30 => a:2967137637, b:1826025400, c:221196138, d:4275359302, f:1309552482, g:7
i:31 => a:4275359302, b:4266766346, c:1826025400, d:221196138, f:1845489448, g:12
i:32 => a:221196138, b:3855169043, c:4266766346, d:1826025400, f:2678616280, g:5
i:33 => a:1826025400, b:1648727666, c:3855169043, d:4266766346, f:2001627553, g:8
i:34 => a:4266766346, b:3280661187, c:1648727666, d:3855169043, f:2044530795, g:11
i:35 => a:3855169043, b:933955932, c:3280661187, d:1648727666, f:1141263010, g:14
i:36 => a:1648727666, b:1316709518, c:933955932, d:3280661187, f:2523166189, g:1
i:37 => a:3280661187, b:1172621265, c:1316709518, d:933955932, f:3126494993, g:4
i:38 => a:933955932, b:638303819, c:1172621265, d:1316709518, f:1010084355, g:7
i:39 => a:1316709518, b:2518531516, c:638303819, d:1172621265, f:764681492, g:10
i:40 => a:1172621265, b:1723348322, c:2518531516, d:638303819, f:4126327846, g:13
i:41 => a:638303819, b:1796634879, c:1723348322, d:2518531516, f:3601741461, g:0
i:42 => a:2518531516, b:1242042285, c:1796634879, d:1723348322, f:2612260897, g:3
i:43 => a:1723348322, b:3271112123, c:1242042285, d:1796634879, f:1202078256, g:6
i:44 => a:1796634879, b:171818493, c:3271112123, d:1242042285, f:3823583977, g:9
i:45 => a:1242042285, b:4279516322, c:171818493, d:3271112123, f:2194442219, g:12
i:46 => a:3271112123, b:1084087837, c:4279516322, d:171818493, f:936424676, g:15
i:47 => a:171818493, b:4055665426, c:1084087837, d:4279516322, f:3048496962, g:2
i:48 => a:4279516322, b:4279453145, c:4055665426, d:1084087837, f:2975995202, g:0
i:49 => a:1084087837, b:1002426141, c:4279453145, d:4055665426, f:248508137, g:7
i:50 => a:4055665426, b:2580293036, c:1002426141, d:4279453145, f:3236739620, g:14
i:51 => a:4279453145, b:429799967, c:2580293036, d:1002426141, f:2723377331, g:5
i:52 => a:1002426141, b:969799177, c:429799967, d:2580293036, f:1142038355, g:12
i:53 => a:2580293036, b:4081959629, c:969799177, d:429799967, f:1717683268, g:3
i:54 => a:429799967, b:424965883, c:4081959629, d:969799177, f:3466605028, g:10
i:55 => a:969799177, b:2878206675, c:424965883, d:4081959629, f:742112562, g:1
i:56 => a:4081959629, b:3289205483, c:2878206675, d:424965883, f:3068889352, g:8
i:57 => a:424965883, b:932769765, c:3289205483, d:2878206675, f:1294088508, g:15
i:58 => a:2878206675, b:3877873675, c:932769765, d:3289205483, f:3019351302, g:6
i:59 => a:3289205483, b:3573278773, c:3877873675, d:932769765, f:3362476794, g:13
i:60 => a:932769765, b:2755809458, c:3573278773, d:3877873675, f:1004294196, g:4
i:61 => a:3877873675, b:2328479269, c:2755809458, d:3573278773, f:1747304387, g:11
i:62 => a:3573278773, b:198924010, c:2328479269, d:2755809458, f:261064541, g:2
i:63 => a:2755809458, b:3186462216, c:198924010, d:2328479269, f:3509991882, g:9 
```

顺便说一句，`AKM`在文档中是`akw`在代码中。

任何将我引向正确方向的提示或建议将不胜感激。代码将是理想的。如果有不清楚的地方，我会编辑问题并尝试纠正。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T13:51:33.283

问题是，您的“b 路径”中有两个管道（--> 第一阶段是 b_tmp，第二阶段是 b），而分配管道只有一个阶段（例如 a<=d）。我对代码做了一些更改，并用“--***”标记了它们。使用此代码，您将获得正确的第一个结果...

```
library ieee;
use ieee.std_logic_1164.all;
use ieee.numeric_std.all;

entity md5core is
    port (
        CLOCK_50        : in std_logic;
        SW              : in std_logic_vector(17 downto 17)
    );
end entity md5core;

architecture md5core_rtl of md5core is
type r_array is array(0 to 64) of std_logic_vector(7 downto 0);
constant R        : r_array := ( x"07", x"0c", x"11", x"16", x"07", x"0c", x"11", x"16", x"07", x"0c", x"11", x"16", x"07", x"0c", x"11", 
                                 x"16", x"05", x"09", x"0e", x"14", x"05", x"09", x"0e", x"14", x"05", x"09", x"0e", x"14", x"05", x"09",
                                 x"0e", x"14", x"04", x"0b", x"10", x"17", x"04", x"0b", x"10", x"17", x"04", x"0b", x"10", x"17", x"04",
                                 x"0b", x"10", x"17", x"06", x"0a", x"0f", x"15", x"06", x"0a", x"0f", x"15", x"06", x"0a", x"0f", x"15",
                                 x"06", x"0a", x"0f", x"15", others => x"00");

type k_array is array(0 to 66) of std_logic_vector(31 downto 0);
constant K        : k_array := (x"d76aa478", x"e8c7b756", x"242070db", x"c1bdceee",
                                x"f57c0faf", x"4787c62a", x"a8304613", x"fd469501",
                                x"698098d8", x"8b44f7af", x"ffff5bb1", x"895cd7be",
                                x"6b901122", x"fd987193", x"a679438e", x"49b40821", 
                                x"f61e2562", x"c040b340", x"265e5a51", x"e9b6c7aa",
                                x"d62f105d", x"02441453", x"d8a1e681", x"e7d3fbc8",
                                x"21e1cde6", x"c33707d6", x"f4d50d87", x"455a14ed",
                                x"a9e3e905", x"fcefa3f8", x"676f02d9", x"8d2a4c8a",
                                x"fffa3942", x"8771f681", x"6d9d6122", x"fde5380c",
                                x"a4beea44", x"4bdecfa9", x"f6bb4b60", x"bebfbc70",
                                x"289b7ec6", x"eaa127fa", x"d4ef3085", x"04881d05",
                                x"d9d4d039", x"e6db99e5", x"1fa27cf8", x"c4ac5665",
                                x"f4292244", x"432aff97", x"ab9423a7", x"fc93a039",
                                x"655b59c3", x"8f0ccc92", x"ffeff47d", x"85845dd1",
                                x"6fa87e4f", x"fe2ce6e0", x"a3014314", x"4e0811a1",
                                x"f7537e82", x"bd3af235", x"2ad7d2bb", x"eb86d391", others => x"00000000");

type g_array is array(0 to 64) of integer range 0 to 15;
constant g_arr      : g_array := (0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15,
                                          1, 6, 11, 0, 5, 10, 15, 4, 9, 14, 3, 8, 13, 2, 7, 12,
                                          5, 8, 11, 14, 1, 4, 7, 10, 13, 0, 3, 6, 9, 12, 15, 2,
                                          0, 7, 14, 5, 12, 3, 10, 1, 8, 15, 6, 13, 4, 11, 2, 9, 0);                                               

type w_array is array(0 to 15) of std_logic_vector(31 downto 0);
signal W            : w_array;

constant AA        : std_logic_vector(31 downto 0) := x"67452301";
constant BB        : std_logic_vector(31 downto 0) := x"EFCDAB89";
constant CC        : std_logic_vector(31 downto 0) := x"98BADCFE";
constant DD        : std_logic_vector(31 downto 0) := x"10325476";

signal res_A    : std_logic_vector(31 downto 0) := x"00000000";
signal res_B    : std_logic_vector(31 downto 0) := x"00000000";
signal res_C    : std_logic_vector(31 downto 0) := x"00000000";
signal res_D    : std_logic_vector(31 downto 0) := x"00000000";

type in_str_t is array(0 to 5) of std_logic_vector(7 downto 0);
constant in_str    : in_str_t := (x"68", x"65", x"6c", x"6c", x"6f", x"6f");

type pad_str_t    is array(0 to 63) of std_logic_vector(7 downto 0);
signal pad_str    : pad_str_t;

type state_t is (start, padding, init_w, state_1, state_2, state_3, state_4, done);
signal state    : state_t;

signal a, b, c, d, f    : std_logic_vector(31 downto 0) := x"00000000";
signal i                : integer range 0 to 64 := 0;
signal g                        : integer range 0 to 15 := 0;
--signal tmp_b              : std_logic_vector(31 downto 0);

signal akw                  : std_logic_vector(31 downto 0);
signal ak                   : std_logic_vector(31 downto 0);
signal b_tmp                : std_logic_vector(31 downto 0);

begin

    --tmp_b <= std_logic_vector(unsigned(b) + rotate_left(unsigned(a) + unsigned(f) + unsigned(K(i)) + unsigned(W(g)), to_integer(unsigned(R(i)))));

    pipe_p : process(CLOCK_50, SW)--*** removed: , a, b, c, d, i)
    begin
        if SW(17) = '0' then
--          ak <= std_logic_vector(unsigned(K(2)) + unsigned(BB));
--          akw <= std_logic_vector(unsigned(W(0)) + 1 + unsigned(K(2)) + unsigned(BB));
            b <= BB;--*** changed, was: b_tmp
        elsif rising_edge(CLOCK_50) and state = state_1 then
            if i = 0 then
                ak <= std_logic_vector(unsigned(K(0)) + unsigned(a));
            elsif i = 1 then
                ak <= std_logic_vector(unsigned(K(1)) + unsigned(d));--*** changed, was: unsigned(a));
                akw <= std_logic_vector(unsigned(W(0)) + unsigned(ak));
            elsif i = 2 then
                ak <= std_logic_vector(unsigned(K(2)) + unsigned(c));--*** changed, was: unsigned(a));
                akw <= std_logic_vector(unsigned(W(1)) + unsigned(ak));
                b <= std_logic_vector(unsigned(b) + (rotate_left(unsigned(akw) + unsigned(f), to_integer(unsigned(R(0))))));--*** changed, was: b_tmp
            else
                ak <= std_logic_vector(unsigned(K(i)) + unsigned(c));--*** changed, was:  unsigned(a));
                akw <= std_logic_vector(unsigned(W(g_arr(i-1))) + unsigned(ak));
                b <= std_logic_vector(unsigned(b) + (rotate_left(unsigned(akw) + unsigned(f), to_integer(unsigned(R(i-2))))));--*** changed, was: b_tmp
            end if;
        end if;
    end process pipe_p;

    md5_f_p : process(state, a, b, c, d, i)
    begin 
        case state is
            when state_1 =>
                -- if i = 0 or i > 4 then----*** removed
                    f <= (b and c) or ((not b) and d);
                    g <= g_arr(i);
                -- end if;----*** removed

            when state_2 =>
            f <= (d and b) or ((not d) and c);
                g <= g_arr(i);

            when state_3 =>
                f <= b xor c xor d;
            g <= g_arr(i);

            when state_4 =>
                f <= c xor (b or (not d));
            g <= g_arr(i);

            when others =>
                f <= x"00000000";
                g <= 0;             

        end case;
    end process md5_f_p;

     md5_p : process(CLOCK_50, SW)----*** removed: , a, b, c, d, f, g)
     begin
        if SW(17) = '0' then
            state <= start;
                i <= 0;
                a <= AA;
            -- b <= BB; ----*** removed
            c <= CC;
            d <= DD;                
            W <= (others => x"00000000");
                pad_str <= (others => x"00");
                --tmp_b := BB;
        elsif rising_edge(CLOCK_50) then
            case state is            
                when start =>

                    pad_str(0) <= in_str(0);
                    pad_str(1) <= in_str(1);
                    pad_str(2) <= in_str(2);
                    pad_str(3) <= in_str(3);
                    pad_str(4) <= in_str(4);
                    pad_str(5) <= in_str(5);
                    state <= padding;

                when padding =>
                    pad_str(6) <= "10000000";
                    pad_str(56) <= std_logic_vector(to_unsigned(in_str'length*8, 8));
                          state <= init_w;

                when init_w =>                
                    W(0) <= pad_str(3) & pad_str(2) & pad_str(1) & pad_str(0);
                    W(1) <= pad_str(7) & pad_str(6) & pad_str(5) & pad_str(4);
                    W(14) <= pad_str(59) & pad_str(58) & pad_str(57) & pad_str(56);
                          state <= state_1;

                when state_1 =>
                          if i = 16 then
                              state <= state_2;
                          else 
                        if i > 1 then----*** changed, was: --if i > 2 then
                                    --tmp_b := b;
                                    a <= d;
                                    c <= b;
                                    d <= c;
                                    -- b <= b_tmp; --*** removed

--                                  d <= c;
--                                  b <= b_tmp;
--                                  c <= b;
--                                  a <= d;
                                end if;
                                i <= i + 1;
                    end if;

                when state_2 =>
                    if i = 32 then
                        state <= state_3;
                          else                  
                        d <= c;
                        -- b <= b_tmp;--*** removed
                                c <= b;
                        a <= d;
                        i <= i + 1;
                    end if;

                when state_3 =>
                    if i = 48 then
                                state <= state_4;
                          else
                        d <= c;
                        -- b <= b_tmp;----*** removed
                                c <= b;
                        a <= d;
                        i <= i + 1;
                    end if;

                when state_4 =>
                    if i = 64 then
                                res_A <= std_logic_vector(unsigned(AA) + unsigned(a));
                                res_B <= std_logic_vector(unsigned(BB) + unsigned(b));
                                res_C <= std_logic_vector(unsigned(CC) + unsigned(c));
                                res_D <= std_logic_vector(unsigned(DD) + unsigned(d));
                                state <= done;
                    else
                        d <= c;
                        c <= b;
                                -- b <= b_tmp;----*** removed
                        a <= d;
                        i <= i + 1;
                    end if;

                when done =>
                    state <= done;

                when others =>
                    state <= done;

            end case;
        end if;
    end process md5_p;
end architecture md5core_rtl; 
```

![在此处输入图像描述](../Images/d7ba41ea8e7fabe99f933750614bfe5c.png)

```
library ieee;
use ieee.std_logic_1164.all;
use ieee.numeric_std.all;

entity md5core is
    port (
        CLOCK_50        : in std_logic;
        SW              : in std_logic_vector(17 downto 17)
    );
end entity md5core;

architecture md5core_rtl of md5core is
type r_array is array(0 to 64) of std_logic_vector(7 downto 0);
constant R        : r_array := ( x"07", x"0c", x"11", x"16", x"07", x"0c", x"11", x"16", x"07", x"0c", x"11", x"16", x"07", x"0c", x"11", 
                                 x"16", x"05", x"09", x"0e", x"14", x"05", x"09", x"0e", x"14", x"05", x"09", x"0e", x"14", x"05", x"09",
                                 x"0e", x"14", x"04", x"0b", x"10", x"17", x"04", x"0b", x"10", x"17", x"04", x"0b", x"10", x"17", x"04",
                                 x"0b", x"10", x"17", x"06", x"0a", x"0f", x"15", x"06", x"0a", x"0f", x"15", x"06", x"0a", x"0f", x"15",
                                 x"06", x"0a", x"0f", x"15", others => x"00");

type k_array is array(0 to 66) of std_logic_vector(31 downto 0);
constant K        : k_array := (x"d76aa478", x"e8c7b756", x"242070db", x"c1bdceee",
                                x"f57c0faf", x"4787c62a", x"a8304613", x"fd469501",
                                x"698098d8", x"8b44f7af", x"ffff5bb1", x"895cd7be",
                                x"6b901122", x"fd987193", x"a679438e", x"49b40821", 
                                x"f61e2562", x"c040b340", x"265e5a51", x"e9b6c7aa",
                                x"d62f105d", x"02441453", x"d8a1e681", x"e7d3fbc8",
                                x"21e1cde6", x"c33707d6", x"f4d50d87", x"455a14ed",
                                x"a9e3e905", x"fcefa3f8", x"676f02d9", x"8d2a4c8a",
                                x"fffa3942", x"8771f681", x"6d9d6122", x"fde5380c",
                                x"a4beea44", x"4bdecfa9", x"f6bb4b60", x"bebfbc70",
                                x"289b7ec6", x"eaa127fa", x"d4ef3085", x"04881d05",
                                x"d9d4d039", x"e6db99e5", x"1fa27cf8", x"c4ac5665",
                                x"f4292244", x"432aff97", x"ab9423a7", x"fc93a039",
                                x"655b59c3", x"8f0ccc92", x"ffeff47d", x"85845dd1",
                                x"6fa87e4f", x"fe2ce6e0", x"a3014314", x"4e0811a1",
                                x"f7537e82", x"bd3af235", x"2ad7d2bb", x"eb86d391", others => x"00000000");

type g_array is array(0 to 64) of integer range 0 to 15;
constant g_arr      : g_array := (0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15,
                                          1, 6, 11, 0, 5, 10, 15, 4, 9, 14, 3, 8, 13, 2, 7, 12,
                                          5, 8, 11, 14, 1, 4, 7, 10, 13, 0, 3, 6, 9, 12, 15, 2,
                                          0, 7, 14, 5, 12, 3, 10, 1, 8, 15, 6, 13, 4, 11, 2, 9, 0);                                               

type w_array is array(0 to 15) of std_logic_vector(31 downto 0);
signal W            : w_array;

constant AA        : std_logic_vector(31 downto 0) := x"67452301";
constant BB        : std_logic_vector(31 downto 0) := x"EFCDAB89";
constant CC        : std_logic_vector(31 downto 0) := x"98BADCFE";
constant DD        : std_logic_vector(31 downto 0) := x"10325476";

signal res_A    : std_logic_vector(31 downto 0) := x"00000000";
signal res_B    : std_logic_vector(31 downto 0) := x"00000000";
signal res_C    : std_logic_vector(31 downto 0) := x"00000000";
signal res_D    : std_logic_vector(31 downto 0) := x"00000000";

type in_str_t is array(0 to 5) of std_logic_vector(7 downto 0);
constant in_str    : in_str_t := (x"68", x"65", x"6c", x"6c", x"6f", x"6f");

type pad_str_t    is array(0 to 63) of std_logic_vector(7 downto 0);
signal pad_str    : pad_str_t;

type state_t is (start, padding, init_w, state_1, state_2, state_3, state_4, done);
signal state    : state_t;

signal a, b, c, d, f    : std_logic_vector(31 downto 0) := x"00000000";
signal i                : integer range 0 to 65 := 0;--**** changed, was: to 64
signal g                        : integer range 0 to 15 := 0;
--signal tmp_b              : std_logic_vector(31 downto 0);

signal akw                  : std_logic_vector(31 downto 0);
signal ak                   : std_logic_vector(31 downto 0);
signal b_tmp                : std_logic_vector(31 downto 0);

begin

    --tmp_b <= std_logic_vector(unsigned(b) + rotate_left(unsigned(a) + unsigned(f) + unsigned(K(i)) + unsigned(W(g)), to_integer(unsigned(R(i)))));

    pipe_p : process(CLOCK_50, SW)--*** removed: , a, b, c, d, i)
    begin
        if SW(17) = '0' then
--          ak <= std_logic_vector(unsigned(K(2)) + unsigned(BB));
--          akw <= std_logic_vector(unsigned(W(0)) + 1 + unsigned(K(2)) + unsigned(BB));
            b <= BB;--*** changed, was: b_tmp
        elsif rising_edge(CLOCK_50) then --**** removed: and state = state_1 then
                --**** added start
                if state = done then
                    b<=b;
                    ak<=ak;
                    akw<=akw;
                --**** added stop
            elsif i = 0 then
                ak <= std_logic_vector(unsigned(K(0)) + unsigned(a));
            elsif i = 1 then
                ak <= std_logic_vector(unsigned(K(1)) + unsigned(d));--*** changed, was: unsigned(a));
                akw <= std_logic_vector(unsigned(W(0)) + unsigned(ak));
            elsif i = 2 then
                ak <= std_logic_vector(unsigned(K(2)) + unsigned(c));--*** changed, was: unsigned(a));
                akw <= std_logic_vector(unsigned(W(1)) + unsigned(ak));
                b <= std_logic_vector(unsigned(b) + (rotate_left(unsigned(akw) + unsigned(f), to_integer(unsigned(R(0))))));--*** changed, was: b_tmp
            else
                ak <= std_logic_vector(unsigned(K(i)) + unsigned(c));--*** changed, was:  unsigned(a));
                akw <= std_logic_vector(unsigned(W(g_arr(i-1))) + unsigned(ak));
                b <= std_logic_vector(unsigned(b) + (rotate_left(unsigned(akw) + unsigned(f), to_integer(unsigned(R(i-2))))));--*** changed, was: b_tmp
            end if;
        end if;
    end process pipe_p;

    md5_f_p : process(state, a, b, c, d, i)
    begin 
        case state is
            when state_1 =>
                -- if i = 0 or i > 4 then----*** removed
                    f <= (b and c) or ((not b) and d);
--                    g <= g_arr(i);--**** removed
                -- end if;----*** removed

            when state_2 =>
            f <= (d and b) or ((not d) and c);
--                g <= g_arr(i);--**** removed

            when state_3 =>
                f <= b xor c xor d;
--            g <= g_arr(i);--**** removed

            when state_4 =>
                f <= c xor (b or (not d));
--            g <= g_arr(i);--**** removed

            when others =>
                f <= x"00000000";
--                g <= 0;       --**** removed      

        end case;
    end process md5_f_p;

     md5_p : process(CLOCK_50, SW)----*** removed: , a, b, c, d, f, g)
     begin
        if SW(17) = '0' then
            state <= start;
                i <= 0;
                a <= AA;
            -- b <= BB; ----*** removed
            c <= CC;
            d <= DD;                
            W <= (others => x"00000000");
                pad_str <= (others => x"00");
                --tmp_b := BB;
        elsif rising_edge(CLOCK_50) then
            case state is            
                when start =>

                    pad_str(0) <= in_str(0);
                    pad_str(1) <= in_str(1);
                    pad_str(2) <= in_str(2);
                    pad_str(3) <= in_str(3);
                    pad_str(4) <= in_str(4);
                    pad_str(5) <= in_str(5);
                    state <= padding;

                when padding =>
                    pad_str(6) <= "10000000";
                    pad_str(56) <= std_logic_vector(to_unsigned(in_str'length*8, 8));
                          state <= init_w;

                when init_w =>                
                    W(0) <= pad_str(3) & pad_str(2) & pad_str(1) & pad_str(0);
                    W(1) <= pad_str(7) & pad_str(6) & pad_str(5) & pad_str(4);
                    W(14) <= pad_str(59) & pad_str(58) & pad_str(57) & pad_str(56);
                          state <= state_1;

                when state_1 =>
                          if i = 17 then--**** changed, was: 16
                              state <= state_2;
                                    end if; --****added
--                          else --**** removed
                        if i > 1 then----*** changed, was: --if i > 2 then
                                    --tmp_b := b;
                                    a <= d;
                                    c <= b;
                                    d <= c;
                                    -- b <= b_tmp; --*** removed

--                                  d <= c;
--                                  b <= b_tmp;
--                                  c <= b;
--                                  a <= d;
                                end if;
                                i <= i + 1;
--                    end if;--**** removed

                when state_2 =>
                    if i = 33 then--**** changed, was: 32
                        state <= state_3;
                            end if; --****added
--                    else --**** removed                 
                        d <= c;
                        -- b <= b_tmp;--*** removed
                        c <= b;
                        a <= d;
                        i <= i + 1;
--                    end if;--**** removed  

                when state_3 =>
                    if i = 49 then--**** changed, was: 48
                                state <= state_4;
                            end if; --****added
--                          else--**** removed  
                        d <= c;
                        -- b <= b_tmp;----*** removed
                        c <= b;
                        a <= d;
                        i <= i + 1;
--                    end if;--**** removed  

                when state_4 =>
                    if i = 65 then--**** changed, was: 64
--                                res_A <= std_logic_vector(unsigned(AA) + unsigned(a));--**** removed  
--                                res_B <= std_logic_vector(unsigned(BB) + unsigned(b));--**** removed  
--                                res_C <= std_logic_vector(unsigned(CC) + unsigned(c));--**** removed  
--                                res_D <= std_logic_vector(unsigned(DD) + unsigned(d));--**** removed  
                                  state <= done;
                            end if; --****added
--                    else--**** removed  
                        d <= c;
                        c <= b;
                        -- b <= b_tmp;----*** removed
                        a <= d;
                        i <= i + 1;
--                    end if;--**** removed  

                when done =>
                          res_A <= std_logic_vector(unsigned(AA) + unsigned(a));--****added
                          res_B <= std_logic_vector(unsigned(BB) + unsigned(b));--****added
                          res_C <= std_logic_vector(unsigned(CC) + unsigned(c));--****added
                          res_D <= std_logic_vector(unsigned(DD) + unsigned(d));    --****added              
                    state <= done;

                when others =>
                    state <= done;

            end case;
        end if;
    end process md5_p;
end architecture md5core_rtl; 
```

# php - PHP从id更新mysql数据库表

> ID：14527959
> 
> 赞同：1
> 
> 时间：2013-01-25T18:19:01.383
> 
> 标签：php, html, mysql

我想将数据更新到 mysql 数据库我知道查询。查询没问题。。

我面临的问题是我应该如何将 id 页面发送到其他页面..

假设我在页面 Skill_edit.php?id=7 上，然后单击更新按钮，然后使用表单的 POST 方法从 Skill_edit.php 转到 Skills.php。

但是现在我如何将页面的 id 甚至表中的行 id 发送到“skills.php”

我的数据库：

![在此处输入图像描述](../Images/cb6cad03c997ee5754f920d693a97837.png)

我在 Skill_edit.php 中的表格

```
 <form class="form-horizontal row-fluid" method="post" action="skills.php">

        <?php //Skill Name ?>
        <div class="form-row control-group row-fluid">
          <label class="control-label span3" for="with-placeholder">Skill Name</label>
          <div class="controls span7">
            <input type="text" name="skill_name" id="with-placeholder" class="row-fluid" value="<?php echo $showskillname; ?>">
          </div>
        </div>

       <?php //Skill Description ?>
        <div class="form-row control-group row-fluid">
          <label class="control-label span3" for="elastic-textarea">Skill Desc <span class="help-block">My Skill Description</span> </label>
          <div class="controls span7">
            <textarea name="skill_desc" rows="3" style=" height:80px;"  class="row-fluid autogrow" id="elastic-textarea"><?php echo $showskilldesc; ?></textarea>
          </div>
        </div>

        <?php //Selecting Language ?>
        <div class="form-row control-group row-fluid">
          <label class="control-label span3">Select with search</label>
          <div class="controls span7">
            <select name="skill_rating" data-placeholder="Choose a Language...." class="chzn-select">
              <option value="<?php echo $showskillrating; ?>"><?php echo $showskillrating; ?></option>
              <option value="1">1 Star</option>
              <option value="2">2 Star</option>
              <option value="3">3 Star</option>
              <option value="4">4 Star</option>
              <option value="5">5 Star</option>
            </select>
          </div>
        </div>

       <?php //Buttons ?>
        <div class="form-actions row-fluid">
          <div class="span7 offset3">
            <button name="updatebtn" style=" float:left; margin-left:40px;" type="submit" class="btn btn-primary">Save changes</button>
            <button formaction="skills.php" style=" float:right; margin-right:40px;" type="submit" class="btn btn-secondary">Cancel</button>
          </div>
        </div>
      </form> 
```

我在其上获取数据的 Skill.php 页面

```
if(isset($_POST['updatebtn']))
{
$updatedskillname = mysql_real_escape_string($_POST['skill_name']);
$updatedskilldesc = mysql_real_escape_string($_POST['skill_desc']);
$updatedskillrating = mysql_real_escape_string($_POST['skill_rating']);
$last_updated = mysql_real_escape_string(date('F j, Y, g:i a'));

$update=update_skill($updatedskillname, $updatedskilldesc, $updatedskillrating, $last_updated);
} 
```

这是函数的内部

```
//Update Skill
//skills.php
function update_skill($updatedskillname, $updatedskilldesc, $updatedskillrating, $last_updated)
{
        $query="UPDATE cv_skills SET
                            skill_name='$updatedskillname',
                            skill_desc='$updatedskilldesc',
                            skill_rating='$updatedskillrating',
                            last_updated='$last_updated' WHERE skill_id='$pageid'";
$result=mysql_query($query);
$error=mysql_error();

return $error;
} 
```

那么我怎样才能在我的查询中获得 Skill_id 呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-25T18:23:32.907

有几种可能的方法可以做到这一点，但一种方法是：

```
<form class="form-horizontal row-fluid" method="post" action="skills.php?id=<?php echo $_GET['id']; ?>"> 
```

然后，这将回发给自己，而 id 仍然完好无损。另一种方法是您可以使用隐藏字段，以便将 id 发布回表单。

隐：

```
<input type="hidden" name="id" value="<?php echo $_GET['id']; ?>"> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T18:44:05.677

最好的选择是将 id 实际存储在会话或 cookie 变量中，并将其用作限定符——但那是另一天的事了。

```
<?php
//create a login form at post to this script at login...

/*
<form action="" method="post">
<label>Email:</label><br />
<input type="text" name="email" /><br /><br />
<label>Password:</label><br />
<input type="password" name="password" /><br /><br />
<label>Remember Me:</label><br />
<input type="checkbox" name="remember" /><br /><br />
<input type="submit" name="submit" value="Login" /><br /><br />
</form>
*/

//connect to your database here...
//something like..
include('../includes/db_connection.php');

/*
Table "users" fields would contain userid(int), email(varchars), password(varchars) at a minimum...
*/

$submit = $_POST['submit'];
if(isset($submit)) {

//grab the post info at login...
$email = mysql_real_escape_string($_POST['email']);
$password = mysql_real_escape_string($_POST['password']);

//md5 encryption at a minimum...
$password = md5($password);

//this is just to declare the timeframe for the cookie....
$remember = strip_tags($_POST['remember']);

//query the users table..
//for demo purposes, this is a basic where normally
//I would wrap this into a function.
$sql = mysql_query("SELECT * FROM users WHERE email='$email'");
$row = mysql_fetch_array($sql);

//set-up the userid for the cookie...
$userid = strip_tags($row['userid']);

//if user exists
if(mysql_num_rows($sql)>0){

//compare the password
if(strcmp($row['password'],$password)==0){

//set the cookie with the the userid...
if (isset($remember)) {

/* Set cookie to last 1 year */
$expire = time()+60*60*24*365;
setcookie('userid', $userid, $expire);        
}

else {

/* Set cookie until the user logs out */
$expire = false;
setcookie('userid', $userid, false); 
}
//send the user over to their secure account...
header('Location: your_secure_login_area.php');

/*
You would then add the following to the top of any secure page that would be applied to the end-user...

<?php
//you can now reference the userid for any db call...
$userid = $_COOKIE['userid'];
if (isset($userid)) {
}
else if(!isset($userid) || $userid == '' || $_GET['userid'] != $_COOKIE['userid']) {
header('Location: http://yourloginpage.php');
}
?>

*/

}
}

else {
$reponse = 'Error: Invalid Information.';
}
}
?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-25T19:01:42.460

使用 session 或 cookie 来传递 id。因为用户总是可以在提交表单之前篡改 id 名称并修改值。

# pyqt4 - 问题在 QTableView 上呈现选定的单元格

> ID：14527960
> 
> 赞同：0
> 
> 时间：2013-01-25T18:19:10.430
> 
> 标签：pyqt4, qtableview, qabstracttablemodel

我有一个 custom`QTableView`和一个 custom `QAbstractTableModel`。该视图仅允许单个选择。我正在尝试在某些条件下自定义所选单元格的背景颜色，但没有成功。我希望通过将`data`模型的`selectionChanged`方法与视图的方法相结合来做到这一点。例如，假设我想在所选单元格与给定行匹配时更改它的颜色。我的`selectionChanged`方法代码是：

```
def selectionChanged(self, selected, deselected):
    #QtGui.QTableView.selectionChanged(self, selected, deselected)
    # Get the selected indexes from the QItemSelection object
    selection = selected.indexes()
    # Let the model track the selected cell
    self.tmodel.selected_index = selection[0]
    # Desperately try to make it work
    self.tmodel.dataChanged.emit(selection[0], selection[0])
    self.viewport().update() 
```

我对该方法的简化代码`data`是：

```
def data(self, index, role=QtCore.Qt.DisplayRole):
    if not index.isValid():
        return None
    # Some code here dealing with several roles
    if role == QtCore.Qt.DisplayRole:
    ...
    elif role == QtCore.Qt.BackgroundRole:
        if ((index == self.selected_index) and (index.row() == 3)):
            print '++++ displaying selected'
            return QtGui.QColor(QtCore.Qt.yellow)
        else:
            return QtGui.QColor(QtCore.Qt.green)
    else:
        return None 
```

未选中的单元格具有预期的绿色背景。奇怪的是，当我在匹配行中选择一个单元格时，`++++ displaying selected`会打印消息，但所选单元格具有系统默认背景而不是黄色背景。我必须在这里遗漏一些重要/明显的东西，但我不知道它是什么。

**更新**

我知道我可以使用自定义委托并实现其`paint`方法来实现我的目标，但我想知道为什么上面的代码会失败。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T07:42:41.437

好的，我想我明白了。认为默认委托使用返回的值`data`来呈现表格单元格。根据[文档](http://doc.qt.digia.com/qt/model-view-programming.html)：

> 通过为每个角色提供适当的项目数据，模型可以向视图和委托提供关于项目应如何呈现给用户的提示。不同类型的视图可以根据需要自由解释或忽略此信息。

因此问题中描述的行为解释如下：默认委托以标准方式呈现未选择的单元格，这意味着`data`将使用方法返回的颜色。但是，默认委托以不同的方式呈现选定的单元格，`data`在这种情况下，方法返回的值被忽略，因为它使用系统样式提供的背景。

# .net - 没有通道主动错误地监听 WCF 服务的方法

> ID：14527963
> 
> 赞同：1
> 
> 时间：2013-01-25T18:19:23.950
> 
> 标签：.net, wcf, web-services, iis-7, svc

当尝试访问 eDemokratiService.svc 的 GetPostlisteArkivdeler 方法时，我收到以下错误消息：

```
Error occured   25.01.2013 19:06:07
User IP 84.49.196.18
User Agent  Mozilla/5.0 (Windows NT 6.1; WOW64; rv:18.0) Gecko/20100101 Firefox/18.0
Url http://www.roros.kommune.no:80/Templates/eDemokrati/Services/eDemokratiService.svc/GetPostlisteArkivdeler
Referer (none)
Exception details:
HttpException: There was no channel actively listening at 'http://www.roros.kommune.no/Templates/eDemokrati/Services/eDemokratiService.svc/GetPostlisteArkivdeler'. This is often caused by an incorrect address URI. Ensure that the address to which the message is sent matches an address on which a service is listening.
Http status:
404 NotFound
Stack trace:

[HttpException: There was no channel actively listening at 'http://www.roros.kommune.no/Templates/eDemokrati/Services/eDemokratiService.svc/GetPostlisteArkivdeler'. This is often caused by an incorrect address URI. Ensure that the address to which the message is sent matches an address on which a service is listening.]
   at System.Runtime.AsyncResult.End[TAsyncResult](IAsyncResult result)
   at System.ServiceModel.Activation.HostedHttpRequestAsyncResult.End(IAsyncResult result)
   at System.Web.HttpApplication.AsyncEventExecutionStep.OnAsyncEventCompletion(IAsyncResult ar)

[Inner exception EndpointNotFoundException: There was no channel actively listening at 'http://www.roros.kommune.no/Templates/eDemokrati/Services/eDemokratiService.svc/GetPostlisteArkivdeler'. This is often caused by an incorrect address URI. Ensure that the address to which the message is sent matches an address on which a service is listening.]
   at System.ServiceModel.Activation.HostedHttpTransportManager.HttpContextReceived(HostedHttpRequestAsyncResult result)
   at System.ServiceModel.Activation.HostedHttpRequestAsyncResult.HandleRequest()
   at System.ServiceModel.Activation.HostedHttpRequestAsyncResult.BeginRequest() 
```

该站点在 IIS7 上运行。这是 web.config 的一部分：

```
<system.serviceModel>
  <serviceHostingEnvironment>
        <baseAddressPrefixFilters>
            <add prefix="item"/>
            <!-- <add prefix="http://www.roros.kommune.no/"/> -->
        </baseAddressPrefixFilters>
    </serviceHostingEnvironment>

    <client>
      <!--Client configuration for the ImageEditor, the client name has to be "ImageServiceClientEndPoint"-->
      <!-- Only uncomment if the Image Service is hosted in an external application 
      <endpoint
       name="ImageServiceClientEndPoint"
       address="the address of the hosting application"
       binding="the binding the hosting application is using"
       bindingConfiguration="ImageServiceBinding"
       contract="EPiServer.ImageLibrary.IImageService" />
       -->
      <!-- Uncomment this endpoint and the "RemoteEventServiceEndPoint" to enable remote events
        <endpoint name="RemoteEventServiceClientEndPoint"
           address="soap.udp://239.255.255.19:5000/RemoteEventService"
           binding="customBinding"
           bindingConfiguration="RemoteEventsBinding"
           contract="EPiServer.Events.ServiceModel.IEventReplication" />-->
    </client>
    <bindings>
      <!-- Only uncomment if the Image Service is hosted in an external application 
      <binding type used by the Image Service>
        <binding name="ImageServiceBinding" maxReceivedMessageSize="20000000">
          <readerQuotas maxArrayLength="20000000" />
          <security mode="None" />
        </binding>
      </binding type used by the Image Service>
       -->
      <customBinding>
        <binding name="RemoteEventsBinding">
          <binaryMessageEncoding />
          <udpTransport multicast="True" />
        </binding>
      </customBinding>
    </bindings>
    <extensions>
      <bindingElementExtensions>
        <add name="udpTransport" type="Microsoft.ServiceModel.Samples.UdpTransportElement, EPiServer.Events" />
      </bindingElementExtensions>
    </extensions>
    <services>
      <!-- In order to get fault information from the server for debug purposes, add behaviorConfiguration="DebugServiceBehaviour" to the endpoint "RemoteEventServiceEndPoint" -->
      <service name="EPiServer.Events.Remote.EventReplication">
        <!-- Uncomment this endpoint and the "RemoteEventServiceClientEndPoint" to enable remote events
            <endpoint name="RemoteEventServiceEndPoint"
                    contract="EPiServer.Events.ServiceModel.IEventReplication"
                    binding="customBinding"
                    bindingConfiguration="RemoteEventsBinding"
                    address="soap.udp://239.255.255.19:5000/RemoteEventService" />-->
      </service>

      <service name="SSP.Innsyn.Templates.Services.InnsynService">
        <endpoint address="" behaviorConfiguration="SSP.Innsyn.Templates.Services.InnsynServiceAspNetAjaxBehavior" binding="webHttpBinding" contract="SSP.Innsyn.Templates.Services.InnsynService" />
      </service>

    </services>
       <behaviors>
      <endpointBehaviors>
        <behavior name="SSP.Innsyn.Templates.Services.InnsynServiceAspNetAjaxBehavior">
          <enableWebScript />
        </behavior>
      </endpointBehaviors>
      <serviceBehaviors>
        <behavior name="DebugServiceBehaviour">
          <serviceDebug includeExceptionDetailInFaults="true" />
        </behavior>
      </serviceBehaviors>
    </behaviors>
  </system.serviceModel> 
```

网站：[链接](http://www.roros.kommune.no/Politikk/Postliste/Journalpost-info1) 具有相同功能的工作网站：[链接](https://www.fredrikstad.kommune.no/no/eDemokrati/Postliste/Se-postliste1/#/22.01.2013/22.01.2013/)

.svc 文件可用，但它的个别方法不可用。链接到 .SVC 文件：[链接](http://www.roros.kommune.no/Templates/eDemokrati/Services/eDemokratiService.svc)

如何解决此错误？

# linux - 从输出文件中提取类似文本块的第 i 个实例的方法？

> ID：14527964
> 
> 赞同：2
> 
> 时间：2013-01-25T18:19:30.687
> 
> 标签：linux, text, command-line, awk, grep

在 Linux 中，我有一个程序在经过一定次数的迭代时会稍微改变坐标列表。我可以使用 grep -c 来计算迭代次数，并且我想从该程序输出中获取最后一组标签和坐标。

我的源文件看起来像：

```
text
total number of objects with coordinates = n
text
begin coordinates
label1 x1 y1 z1
label2 x2 y2 z2
...
labeln xn yn zn
end coordinates
text
text
begin coordinates
label1 a1 b1 c1
label2 a2 b2 c2
...
labeln an bn cn
end coordinates
text
text 
```

在这种情况下，我想将一组标签及其 a、b 和 c 坐标转储到一个如下所示的文本文件中：

```
label1 a1 b1 c1
label2 a2 b2 c2
...
labeln an bn cn 
```

我的偏好是使用 grep 或 awk 之类的东西来执行此操作，但我对它们还不够熟悉，无法实现这一点。

编辑：我忘了提到标签既不是恒定的也不是唯一的，所以 label2 可以等于 label5 或 labeln。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T18:47:55.680

你需要`awk`.

要获取模式范围的最后一次出现：

```
awk '/label1/ { r="" } /label1/,/labeln/ { r = ( r ? r RS : "") $0 } END { print r }' file 
```

要获得模式范围的第 n 次出现：

```
awk -v n=2 '/label1/ { f++; r="" } f { r = (r ? r ORS : "") $0 } /labeln/ && f==n { print r; f=0 }' file 
```

这将找到第二个匹配项 ( `n=2`)，您可以轻松修改它以找到您想要的匹配项。

* * *

*编辑：*

要获取模式范围的最后一次出现：

```
awk '/begin/ { f=1; r=""; next } f && !/end/ { r = (r ? r ORS : "") $0 } /end/ { f=0 } END { print r }' file 
```

要获得模式范围的第 n 次出现：

```
awk -v n=2 '/begin/ { f++; r=""; next } f && !/end/ { r = (r ? r ORS : "") $0 } /end/ && f==n { print r; r="" }' file 
```

这将找到第二个匹配项 ( `n=2`)，您可以轻松修改它以找到您想要的匹配项。HTH。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-25T19:35:34.123

每当您看到`begin coordinates`时，就开始保存新的文本块。看到时停止保存`end coordinates`。在文件末尾，打印您保存的最后一个文本块。

```
#!/usr/bin/env awk -f

/^begin coordinates/ { text = ""; save = 1 }
save { text = text $0 "\n" }
/^end coordinates/ { save = 0 }
END { print text } 
```

请注意，这`text = text $0 "\n"`是连接变量`text`和`$0`with `\n`。空格是 awk 的连接运算符。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-25T19:32:25.593

当我看到“获取文件中的*最后*一个内容”时，我想到了[`tac`](http://man.cx/tac)——从下到上打印文件：

```
tac file | awk '
    /^begin coordinates/ {exit} 
    p {print} 
    /^end coordinates/ {p=1}
' | tac 
```

# python - 迭代失礼的具体行为

> ID：14527966
> 
> 赞同：2
> 
> 时间：2013-01-25T18:19:34.347
> 
> 标签：python

最近有人问我关于在迭代列表时更改列表的错误。他们提出了以下场景（我现在已经更新了一个更好的例子）作为可能的用例，当行为可能是可取的：

```
>>> jersey_numbers = [4, 2, 3, 5, 1]  # list of places in a race
>>> for jersey_number in jersey_numbers:
        if jersey_number == 2:  # disqualify jersey number 2 for a false start
            t.remove(jersey_number)
>>> t
[4, 3, 5, 1]  # jersey number 3 is now in second place 
```

这种行为是否足够规律，可以在这样的用例中使用？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-25T18:23:43.003

当您从列表中删除一个项目时，列表中的所有内容都会转移...

```
[1, 2, 3, 4, 5]
#remove   ^
[1, 2, 3, 5] 
```

如果您在迭代对象时执行此操作，并且如果您有要移除的项目彼此相邻，那么当您移除第一个项目时，第二个项目将转移到它的位置。for 循环将继续增加列表中它从中提取值的位置，这会导致它跳过碰到的值以代替您删除的项目。

这是一个[参考](http://docs.python.org/2/reference/compound_stmts.html#the-for-statement)——我们都知道这是有据可查的行为:)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-25T18:32:22.140

你应该使用的是：

```
t = filter(None, t)  # or
t = [x for x in t if x] 
```

或者，如果您的情况实际上更复杂：

```
t = filter(lambda x: x != something, t)  # or
t = [x for x in t if x != something] 
```

顺便说一句，`remove`删除第一个匹配元素，不一定是您`x`当前指向的元素，尽管在您的简单案例中行为是等效的。

发生的情况是，当您迭代列表时，您删除了元素并且迭代器不知道它，假设您的列表是`[1,0,0,2]`：

*   迭代器在`1`，没有变化，下一个
*   迭代器在`0`，你删除`0`了第一个，列表改变了大小，现在迭代器指向第二个零，下一个
*   迭代器指向`2`，没有变化

实际上，您的第一个算法每隔一个零就删除一次。

你的第二个算法不应该工作，如果你说它可以工作，也许你没有足够的测试它。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-01-25T18:20:33.990

错误是您在迭代列表时正在修改列表。这与您期望的方式不同（当您删除当前元素时，会跳过下一个元素）。

这是如何完成的：

```
In [18]: t = [5.0, 5.0, 5.0, 4.0, 0.0, 5.0, 0.0, 3.0, 5.0, 5.0, 0.0, 0.0, 4.0, 5.0, 0.0, 5.0, 4.0, 5.0, 3.0, 3.0, 5.0, 5.0, 5.0, 5.0]

In [19]: t[:] = [val for val in t if val != 0] 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-01-25T18:25:38.367

您应该遍历列表的浅表副本，因为您正在修改列表，这可能会导致在迭代期间遗漏某些项目。

对于你正在做的事情，`filter()`是一个不错的选择。

```
filter(lambda x:x != 0.0,t) 
```

使用浅拷贝：

```
In [7]: t = [5.0, 5.0, 5.0, 4.0, 0.0, 5.0, 0.0, 3.0, 5.0, 5.0, 0.0, 0.0, 4.0, 5.0, 0.0, 5.0, 4.0, 5.0, 3.0, 3.0, 5.0, 5.0, 5.0, 5.0]

In [8]: for x in t[:]:   # a shallow copy of t
    if x==0.0:
        t.remove(x)

In [9]: 0.0 in t
Out[9]: False 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-25T18:27:19.180

正如@mgilson 所说，当您删除该`0.0`值时，第二个`0.0`取而代之并被遗漏。

您可以迭代浅拷贝，并将其从原始副本中删除：

```
 >>> t = [1, 2, 3, 3, 3, 4, 5]
 >>> for value in t[:]:
         if value == 3:
             t.remove(value)
 >>> t
 [1, 2, 4, 5] 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-25T18:23:52.567

```
t = [e for e in t if e != 0.0] 
```

# visual-studio-2012 - 我的“最近的项目和解决方案”选项在哪里？

> ID：14527967
> 
> 赞同：0
> 
> 时间：2013-01-25T18:19:37.123
> 
> 标签：visual-studio-2012

我最近安装了 Visual Studio 2012，我一直在用头撞我的桌子，寻找缺失的选项。

我在 Visual Studio 2010 中经常使用“最近的项目和解决方案”菜单选项（在“文件”菜单下），但在 Visual Studio 2012 中没有类似的东西。但是，我的老板有，所以我知道我的安装有**问题**或者我错过的一个选项。

我随便查看了注册表设置中存在于我的 2010 年设置中但不存在于我的 2012 年设置中的“项目”之类的任何内容，结果空手而归。有谁知道如何解决这一问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-23T14:14:51.800

我遇到了完全相同的问题，但我感觉其他菜单项也丢失了。

我所做的是进入工具 => 导入和导出设置，选择重置所有设置，然后选择与我安装 Visual Studio 时相同的配置文件。（一般开发设置。）这解决了这个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-28T16:22:30.427

看起来升级过程的某些部分刚刚为我删除了这个菜单选项。在[这个问题](https://stackoverflow.com/questions/5552535/visual-studio-2010-file-recent-projects-and-solutions-is-not-a-active)的 nithins 链接之后，我按照作者创建的说明重新创建了最近的项目和解决方案菜单项。

对于后代，这些步骤是（在 Visual Studio 2012 中执行）：

1.  在工具菜单下，单击**自定义...**
2.  单击**命令**选项卡。
3.  将下拉列表中的**Menu bar** selected 选项更改为**File**。
4.  单击**添加新菜单**。
5.  单击**Modify Selection**，重命名为Recent Projects and Solutions。
6.  在**菜单栏**下拉列表下，选择**文件 | 最近的项目和解决方案**。
7.  单击**添加命令...**

    （此处应出现“添加命令”菜单。）

8.  在左侧的**类别下，单击****文件**。
9.  当命令列表（在右侧）刷新时，单击**最近项目列表**，然后单击确定。
10.  单击关闭。

愉快的项目切换！

# java - 将 Java 与 Z3 集成

> ID：14527968
> 
> 赞同：-3
> 
> 时间：2013-01-25T18:19:40.963
> 
> 标签：java, z3, smt

我想问一下，如何将 Java 与 SMT Z3 求解器集成？如果不仅要描述理论问题，而且还要描述一些实施经验，那就太好了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-25T19:30:08.233

不确定您正在寻找什么样的集成，但我想我应该提到我们目前正在为 Z3 开发 Java API。这可以在 Z3 的不稳定分支中预览，在[Z3 最新源代码](http://z3.codeplex.com/SourceControl/BrowseLatest)中获得。这还没有在任何二进制包中分发，因此您必须自己构建源代码。它基本上以 jar 包 (+DLL) 的形式提供，源代码附带了如何在示例/java 中使用它的示例。

# opencv - 从 opencv 中立体装置拍摄的图像生成的点云

> ID：14527969
> 
> 赞同：3
> 
> 时间：2013-01-25T18:19:46.703
> 
> 标签：opencv, stereo-3d, point-cloud-library, disparity-mapping

我可以查看点云库提供的点云。但是，问题是我无法查看从立体钻机图像生成的点云。图像的分辨率为 640x480 像素。

但是，每对图像的点云中的点数是不同的（即，不是有 307200 个点，而是有更少的点，如 194261、190472 等）。

为什么我在点云中没有得到 307200 点？

我应该如何使用点云库查看这样的点云？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T18:48:14.843

你可以看看这个例子[Example1](http://blog.martinperis.com/2012/01/3d-reconstruction-with-opencv-and-point.html)和[Example2](http://www.pcl-users.org/saving-data-td4019514.html)。它还取决于您用于图像采集的传感器类型。

# buffer - 禁用 Tcl 的输入缓冲？

> ID：14527974
> 
> 赞同：2
> 
> 时间：2013-01-25T18:20:05.133
> 
> 标签：buffer, tcl

Tcl 是否做任何不受脚本编写者控制的内部输入缓冲？下面的代码可能会浪费熵（读取超过 1 个字节），如果是这样，我该如何防止它？

```
set stream [open "/dev/srandom"]
chan configure $stream -translation binary
set randomByte [chan read $stream 1] 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-25T18:22:07.403

是的，tcl 默认为缓冲并且会浪费熵（就像单个`read`调用会决定移交一样多）。

我以为你可以用

```
chan configure $stream -buffering none 
```

但是不，`-buffering`对输入队列没有影响（它不是内部的单个缓冲区）。

然而，

```
chan configure $stream -buffersize 0 
```

正如我从`stdin`under的实验中看到的那样，可以做到这一点`strace`。它使*任何*输入进入`read`大小为 1 的 s（系统调用）（TCL 的参数`read`无关紧要），因此正常使用会非常慢。

# jquery - 数组值正在滚雪球

> ID：14527975
> 
> 赞同：0
> 
> 时间：2013-01-25T18:20:11.047
> 
> 标签：jquery, arrays, return-value

我首先是使用数组的新手。我正在从一系列 Img 标签中收集所有 css 背景颜色值，并用它构建一个数组。但是数组中的每个值都是它之前的值的雪球。如何在数组中输出每个值？这是我的代码：

```
var slideArray = [];
$('.home-rotator-wrap .cycle-slideshow > div img').each(function() {
    slideArray.push($(this).css('background-color'));
    console.log(slideArray);
}); 
```

我的控制台向我展示了：

```
["rgb(255, 0, 0)"]
["rgb(255, 0, 0)", "rgb(0, 255, 0)"]
["rgb(255, 0, 0)", "rgb(0, 255, 0)", "rgb(0, 0, 255)"]
["rgb(255, 0, 0)", "rgb(0, 255, 0)", "rgb(0, 0, 255)", "rgb(0, 0, 0)"] 
```

我需要四个 img 标签的每一个值，但需要分别返回每一个。

所有这些都是为了能够循环遍历数组的值并在定时动画中返回每个值。用于页面背景，需要配合cycle2滑块的动画。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-25T18:21:14.553

您的代码有效。您只是将`console.log`语句放在错误的位置，因此它会在每次循环后记录数组的进度。如果您只希望它记录一次，请将其移出循环。

* * *

顺便说一句，您不必手动将这些值推送到数组中。您可以[`map`](http://api.jquery.com/map/)为此使用：

```
var slideArray = $('.home-rotator-wrap .cycle-slideshow > div img').map(function() {
    return $(this).css('background-color');
}).get(); 
```

为了获得更好的性能，您应该考虑使用静态`$.css`方法，而不是为集合中的每个元素创建一个新对象：

```
var slideArray = $('.home-rotator-wrap .cycle-slideshow > div img').map(function() {
    return $.css(this, 'background-color');
}).get();

console.log(slideArray); 
```

# mongodb - 你可以在 Mongo 中为 $addToSet 指定一个键吗？

> ID：14527980
> 
> 赞同：81
> 
> 时间：2013-01-25T18:20:29.510
> 
> 标签：mongodb, pymongo

我有一个文件：

```
{ 'profile_set' :
  [
    { 'name' : 'nick', 'options' : 0 },
    { 'name' : 'joe',  'options' : 2 },
    { 'name' : 'burt', 'options' : 1 }
  ] 
} 
```

`profile_set`如果名称尚不存在（无论选项如何），并希望将新文档添加到集合中。

所以在这个例子中，如果我尝试添加：

`{'name' : 'matt', 'options' : 0}`

它应该添加它，但添加

`{'name' : 'nick', 'options' : 2}`

不应该做任何事情，因为一个文件已经存在，名称不同，`nick`即使`option`是不同的。

Mongo 似乎与整个元素匹配，我最终检查它是否相同，我最终得到

```
profile_set containing [{'name' : 'nick', 'options' : 0}, {'name' : 'nick', 'options' : 2}] 
```

有没有办法做到这一点，`$addToSet`或者我必须推送另一个命令？

* * *

## 回答 #1

> 赞同：106
> 
> 时间：2013-01-25T18:40:24.287

您可以`update`使用阻止更新的查询对象限定您`name`的`profile_set`. 在外壳中：

```
db.coll.update(
    {_id: id, 'profile_set.name': {$ne: 'nick'}}, 
    {$push: {profile_set: {'name': 'nick', 'options': 2}}}) 
```

因此，这只会对`$push`具有匹配项`_id`且没有where is`profile_set`元素的文档执行。`name``'nick'`

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2020-12-02T16:46:46.463

从 MongoDB 4.2 开始，有一种方法可以使用[update 中的聚合表达式](https://docs.mongodb.com/manual/tutorial/update-documents-with-aggregation-pipeline/)来做到这一点。

对于您的示例案例，您可以这样做：

```
newSubDocs = [ {'name' : 'matt', 'options' : 0}, {'name' : 'nick', 'options' : 2} ];
db.coll.update( { _id:1 },
[ 
   {$set:  { profile_set:  {$concatArrays: [ 
      "$profile_set",  
      {$filter: {
             input:newSubDocs, 
             cond: {$not: {$in: [ "$$this.name", "$profile_set.name" ]}} 
      }}
   ]}}}
]) 
```

# java - 无法运行 griffon 应用程序

> ID：14527985
> 
> 赞同：0
> 
> 时间：2013-01-25T18:20:37.933
> 
> 标签：java, groovy, griffon

我正在尝试在 griffon 中运行一个测试应用程序。我可以创建应用程序，但是当我运行它时，出现以下错误：

```
2013-01-25 11:12:02,352 [main] INFO  griffon.swing.SwingApplication - Initializing all startup groups: [test1]
2013-01-25 11:12:05,702 [AWT-EventQueue-0] ERROR org.codehaus.griffon.runtime.builder.UberBuilder - An error occurred while building test1.Test1View@63935d75
java.lang.RuntimeException: Failed to create component for 'application' reason: java.awt.HeadlessException
        at org.codehaus.griffon.runtime.builder.UberInterceptorMetaClass.invokeFactoryMethod(UberInterceptorMetaClass.groovy:97)
        at org.codehaus.griffon.runtime.builder.UberInterceptorMetaClass.this$3$invokeFactoryMethod(UberInterceptorMetaClass.groovy)
        at org.codehaus.griffon.runtime.builder.UberInterceptorMetaClass$this$3$invokeFactoryMethod.callCurrent(Unknown Source)
        at org.codehaus.griffon.runtime.builder.UberInterceptorMetaClass.invokeMethod(UberInterceptorMetaClass.groovy:168)
        at test1.Test1View.run(Test1View.groovy:11)
        at org.codehaus.griffon.runtime.builder.UberInterceptorMetaClass.invokeMethod(UberInterceptorMetaClass.groovy:152)
        at org.codehaus.griffon.runtime.builder.UberBuilder.build(UberBuilder.groovy:160)
        at org.codehaus.griffon.runtime.core.AbstractMVCGroup$1.run(AbstractMVCGroup.java:129)
Caused by: java.awt.HeadlessException
        at griffon.swing.SwingUtils.createApplicationFrame(SwingUtils.java:133)
        at griffon.swing.AbstractSwingGriffonApplication.createApplicationContainer(AbstractSwingGriffonApplication.java:99)
        at griffon.core.GriffonApplication$createApplicationContainer.call(Unknown Source)
        at griffon.swing.factory.ApplicationFactory.newInstance(ApplicationFactory.groovy:54)
        ... 8 more
2013-01-25 11:12:05,714 [main] ERROR griffon.util.GriffonExceptionHandler - Uncaught Exception
java.lang.RuntimeException: Failed to create component for 'application' reason: java.awt.HeadlessException
        at org.codehaus.griffon.runtime.builder.UberInterceptorMetaClass.invokeFactoryMethod(UberInterceptorMetaClass.groovy:97)
        at org.codehaus.griffon.runtime.builder.UberInterceptorMetaClass.this$3$invokeFactoryMethod(UberInterceptorMetaClass.groovy)
        at org.codehaus.griffon.runtime.builder.UberInterceptorMetaClass$this$3$invokeFactoryMethod.callCurrent(Unknown Source)
        at org.codehaus.griffon.runtime.builder.UberInterceptorMetaClass.invokeMethod(UberInterceptorMetaClass.groovy:168)
        at test1.Test1View.run(Test1View.groovy:11)
        at org.codehaus.griffon.runtime.builder.UberInterceptorMetaClass.invokeMethod(UberInterceptorMetaClass.groovy:152)
        at org.codehaus.griffon.runtime.builder.UberBuilder.build(UberBuilder.groovy:160)
        at org.codehaus.griffon.runtime.core.AbstractMVCGroup$1.run(AbstractMVCGroup.java:129)
Caused by: java.awt.HeadlessException
        at griffon.swing.SwingUtils.createApplicationFrame(SwingUtils.java:133)
        at griffon.swing.AbstractSwingGriffonApplication.createApplicationContainer(AbstractSwingGriffonApplication.java:99)
        at griffon.core.GriffonApplication$createApplicationContainer.call(Unknown Source)
        at griffon.swing.factory.ApplicationFactory.newInstance(ApplicationFactory.groovy:54)
        ... 8 more 
```

您可以提供的任何见解都会很棒。我的设置是：

Kubuntu Linux 12.10 64 位

```
------------------------------------------------------------
  Griffon 1.2.0
------------------------------------------------------------

   Build: 11-Jan-2013 09:10 AM
  Groovy: 2.0.6
     Ant: 1.8.4
   Slf4j: 1.7.2
  Spring: 3.2.0.RELEASE
     JVM: 1.7.0_09 (Oracle Corporation 23.2-b09)
      OS: Linux 3.5.0-22-generic amd64 
```

谢谢！！

铁螳螂7x

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T19:21:28.227

正如[http://docs.oracle.com/javase/6/docs/api/java/awt/HeadlessException.html](http://docs.oracle.com/javase/6/docs/api/java/awt/HeadlessException.html)的文档中提到的，这应该是键盘、鼠标或显示器的问题。

假设您没有强制“-Djava.awt.headless=true”，这很可能是由于缺少与 X 服务器的连接造成的。

类型

```
echo $DISPLAY 
```

在终端窗口中。通常这会输出“：0”。确保设置了变量（对于终端窗口自动发生），并尝试启动一个非常基本的 X 应用程序，例如“xterm”。如果可行，griffon 应用程序应该会启动并显示。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T22:22:04.397

找到了！！！我需要安装 JRE，但我没有。它正在寻找我需要的依赖项。

# ant - 在 Apache Ant 中，我想替换文件中的字符串，但仅限于字符串的特定出现

> ID：14527988
> 
> 赞同：1
> 
> 时间：2013-01-25T18:20:53.347
> 
> 标签：ant

在 Apache Ant 中，我想替换文件中的字符串，但仅限于字符串的特定出现。我有一个 for 循环，我想只替换循环号出现（第一个循环找到第一个出现，第二个循环找到第二个字符串出现）与它关联的 for 循环参数值。

```
<exec executable="${postgres-bin-dir}/psql" outputproperty="update-primary-keys-values-@table">
   <arg line="-A -t --host ${source-target-comparison-hostname} --port 5432 --username 'postgres' -d ${source-target-comparison-databasename} -c &quot;array_to_string(ARRAY(select ${primary-keys-@{table}} from stage.@{table} t where t not in (select t from public.@{table} t) and t.${primary-keys-@{table}} not in (select ${primary-keys-@{table}} from stage.@{table} where ${primary-keys-@{table}} not in (select ${primary-keys-@{table}} from public.@{table})) order by ${primary-keys-@{table}}), ',')&quot;"/>
</exec>

<for list="${update-primary-keys-values-@table}" param="keys-values">
    <replace file="${updates-dir}/updates@{table}.sql" token=");" value=") WHERE ${primary-keys-@{table}} = @{keys-values};"/>
</for> 
```

# iphone - 通过 iPhone LED 的摩尔斯电码

> ID：14527989
> 
> 赞同：1
> 
> 时间：2013-01-25T18:20:55.583
> 
> 标签：iphone, led, morse-code

我编写了一个可以转换普通文本的应用程序，例如：“你好，我的名字是 XY”

成点和笔画（ ..-. ; --.- ; . ; - ; etc etc）

现在我想将这些点和笔画转换为闪光，点的长度为 0.3 秒，笔画的长度为 0.6 秒。在每个点或笔划之后还有一个点长度的停顿，每个单词之后有一个双停顿，每个句子之后有一个三重停顿/中断。

我的代码中也隐含了中断。

现在的问题是轻描边不够不同。

因为它背后的想法是通过 Arduino Duo 和 fototransistor 将 Light 闪烁转换回 Text。

这是光转换过程的代码段落：

```
- (IBAction)send:(id)sender{ 
```

// 将文本转换为莫尔斯电码等

```
float needTime;
NSString *string = plotter;
for (int d = 0;d < [string length]; d++) {
    NSString *punktoderstrich = [string substringWithRange:NSMakeRange(d, 1)];
    if ([punktoderstrich isEqualToString:@"."]) {
        needTime = needTime + 0.4f;
        [self performSelector:@selector(playpunkt) withObject:nil afterDelay:needTime];
    }
    if ([punktoderstrich isEqualToString:@"-"]) {
        needTime = needTime + 1.0f;
        [self performSelector:@selector(playstrich) withObject:nil afterDelay:needTime];
    }
    if ([punktoderstrich isEqualToString:@" "]) {
        needTime = needTime + 0.4f;
        [self performSelector:@selector(playpause) withObject:nil afterDelay:needTime];

    }
    if ([punktoderstrich isEqualToString:@"/"]) {
        needTime = needTime + 0.3f;
        [self performSelector:@selector(playpause) withObject:nil afterDelay:needTime];

    }
}

- (void)torchAn {
[captureDevice lockForConfiguration:nil];
[captureDevice setTorchMode:AVCaptureTorchModeOn];
[captureDevice setFlashMode:AVCaptureFlashModeOn];
[captureDevice unlockForConfiguration];
}
- (void)torchAus {
[captureDevice lockForConfiguration:nil];
[captureDevice setTorchMode:AVCaptureTorchModeOff];
[captureDevice setFlashMode:AVCaptureFlashModeOff];
[captureDevice unlockForConfiguration];
}
-(void)playstrich{
// AudioServicesPlaySystemSound (outSystemSoundID2);
[self torchAn];
//[self performSelector:@selector(torchAus) withObject:nil afterDelay:0.8f];
}

-(void)playpunkt{
//AudioServicesPlaySystemSound (outSystemSoundID1);
[self torchAn];
//[self performSelector:@selector(torchAus) withObject:nil afterDelay:0.4f];
}

- (void)playpause{
// AudioServicesPlaySystemSound (outSystemSoundID3);
[self performSelector:@selector(torchAus) /*withObject:nil afterDelay:0.4f*/];
} 
```

如您所见，我还导入了声音文件（短和长），但主要目标是发出正确的光信号。

我的问题：

短灯大多是可以的，除了 LED 首次闪烁时的第一个。长光信号实际上并不长。有时我在录制它们时会得到相同的结果。

并且在长灯应该点亮之后，以下短灯不会像正常情况那样短..嗯..

在我评论了声音出来的部分之后，整个过程变得更加稳定。我还将部件（关闭 LED）从它自己的标志移到了休息处。

我希望有人能给我一些小费左右:)

来自德国的问候！

PS：我的设备是iPhone 4s（带手电筒^^）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T10:12:45.177

就像布拉德说的那样，iPhone 闪光灯需要几毫秒才能打开。如果您仍然想使用它，唯一的可能性是（在我看来）更改您的协议并给单个信号更多时间。

这会减慢您的传输速度，但在接收器端，您可以定义一些置信区间（如加减 2 秒）。也许人类无法理解您的摩尔斯电码，因为它可能太慢（但也许他们会），像 iPhone 这样的机器作为接收器将完全能够理解它。

您必须玩弄时间间隔才能找到最短的有效时间间隔。

来自德国的问候。

# actionscript-3 - 如何优化此方法？

> ID：14527992
> 
> 赞同：0
> 
> 时间：2013-01-25T18:21:06.443
> 
> 标签：actionscript-3, optimization, stage3d, starling-framework

我一直致力于创建一个可以`TextureAtlas`在需要时生成动态对象的资产类。具体方法是`Assets.generateTextureAtlas()`，我正在尝试尽可能优化它，因为我经常需要重新生成纹理图集，并希望获得比我平均 53 毫秒更好的时间。

53ms 目前花费了我大约 3 帧，这可以快速增加我需要在我的纹理图集中打包的更多项目以及我需要生成它们的频率。因此，我的代码中所有陷阱的答案会很棒。

[整个类代码可在 github gist 中找到。](https://gist.github.com/a05b932023862abe3091)

该类`RectanglePacker`仅用于将矩形尽可能紧密地打包在一起（类似于 Texture Packer），可以在[此处](https://github.com/xLite/RectanglePacking/tree/patch-1)找到。

供参考，方法如下：

```
public static function generateTextureAtlas(folder:String):void
{
    if (!_initialised) throw new Error("Assets class not initialised.");

    if (_renderTextureAtlases[folder] != null)
    {
        (_renderTextureAtlases[folder] as TextureAtlas).dispose();
    }

    var i:int;
    var image:Image = new Image(_blankTexture);
    var itemName:String;
    var itemNames:Vector.<String> = Assets.getNames(folder + "/");
    var itemsTexture:RenderTexture;
    var itemTexture:Texture;
    var itemTextures:Vector.<Texture> = Assets.getTextures(folder + "/");
    var noOfRectangles:int;
    var rect:Rectangle;
    var rectanglePacker:RectanglePacker = new RectanglePacker();
    var texture:Texture;

    noOfRectangles = itemTextures.length;

    if (noOfRectangles == 0)
    {
        return;
    }

    for (i = 0; i < noOfRectangles; i++)
    {
        rectanglePacker.insertRectangle(Math.round(itemTextures[i].width), Math.round(itemTextures[i].height), i);
    }

    rectanglePacker.packRectangles();

    if (rectanglePacker.rectangleCount != noOfRectangles)
    {
        throw new Error("Only " + rectanglePacker.rectangleCount + " out of " + noOfRectangles + " rectangles packed for folder: " + folder);
    }

    itemsTexture = new RenderTexture(rectanglePacker.width, rectanglePacker.height);

    itemsTexture.drawBundled(function():void
    {
        for (i = 0; i < noOfRectangles; i++)
        {
            itemTexture = itemTextures[rectanglePacker.getRectangleId(i)];
            rect = rectanglePacker.getRectangle(i, rect);

            image.texture = itemTexture;
            image.readjustSize();

            image.x = rect.x + itemTexture.frame.x;
            image.y = rect.y + itemTexture.frame.y;

            itemsTexture.draw(image);
        }
    });

    _renderTextureAtlases[folder] = new TextureAtlas(itemsTexture);

    for (i = 0; i < noOfRectangles; i++)
    {
        itemName = itemNames[rectanglePacker.getRectangleId(i)];
        itemTexture = itemTextures[rectanglePacker.getRectangleId(i)];
        rect = rectanglePacker.getRectangle(i);

        (_renderTextureAtlases[folder] as TextureAtlas).addRegion(itemName, rect, itemTexture.frame);
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T06:15:55.187

仔细阅读项目并找到所有可以优化的东西肯定需要时间。

首先删除对`rectanglePacker.getRectangle(i)`内部循环的多个调用。

例如 ：

```
 itemName = itemNames[rectanglePacker.getRectangleId(i)];
    itemTexture = itemTextures[rectanglePacker.getRectangleId(i)];
    rect = rectanglePacker.getRectangle(i); 
```

也许，可能是：

```
 rect = rectanglePacker.getRectangle(i);
    itemName = itemNames[rect];
    itemTexture = itemTextures[rect]; 
```

如果**getRectangle**确实只是“得到一个矩形”而不设置任何东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-26T13:25:32.923

As others said, it's unlikely that the reason of bad performance is non-optimized AS code. Output from the profiler (Scout, for example) wold be very helpful. However, if your purpose is just adding new textures, I can suggest several optimizations:

1.  Why would you need to re-generate the whole atlas every time (calling `Assets.getTextures()` and creating new render texture)? Why don't you just add new items to the existing atlas? Creation of a new `RenderTexture` (and, thus, a new texture in GPU memory) is very costly operation, because it requires sync between CPU and GPU. On the other hand, drawing into `RenderTexture` is carried out entirely inside GPU, so it takes much less time.

2.  If you place every item on a grid, then you can avoid using `RectanglePacker` as all of your rectangles can have the same dimensions matching the dimensions of a grid.

**Edit:**

To clarify, some time ago I had a similar problem: I had to add new items to the existing atlas on a regular basis. And the performance of this operation was quite acceptable (about 8ms on iPad3 using 1024x1024 dynamic texture). But I used the same `RenderTexture` and the same `Sprite` object that contained my dynamic atlas items. When I need to add a new item, I just create new `Image` with desired texture (stand-alone or from another static atlas), then place it inside the `Sprite` container, and then redraw this container to the `RenderTexture`. Similarly with deletion/modification of an item.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-26T08:39:28.920

我认为手头的更大问题是，为什么你必须在运行时这样做，在这种情况下不能花费更多时间？这是一个扩展操作，无论您如何优化它，在 AS3 中完成时您可能最终会花费大约 40 毫秒或类似的时间。

这就是为什么这些操作应该在编译期间或在“加载屏幕”或其他“转换”期间完成，此时帧速率并不重要并且您可以负担得起。

或者，用 c++ 或其他语言创建另一个系统，该系统实际上可以处理为您提供最终结果的数字运算。

此外，在检查性能时，是的，整个函数需要 53 毫秒，但是，这些毫秒在哪里使用？53ms 什么也没说，只是你发现罪魁祸首的“开销分析”，你需要将它分解成更小的块，以收集一些关于在该函数内部实际需要时间的可靠信息。

我的意思是，在该函数内部，您有 3 个 for 循环、对其他类的多次调用、强制转换、删除、创建。这不像你在做一件事，那个函数可能会导致大约 500 行代码和无数的 cpu 操作。而且，您不知道它在哪里使用。我猜这`rectanglePacker.packRectangles();`需要 60% 的时间，但是如果没有分析，您和我们都不知道要优化什么，我们根本没有足够的数据。

如果您必须在 AS3 的运行时执行此操作，我建议您将其分散在几个帧中，并在 10 帧左右平均分配工作负载。您也可以在另一个线程和工作人员的帮助下完成它。但最重要的是，这似乎是一个设计错误，因为这可能会在其他时间完成。如果不是，那么使用另一种更擅长此类操作的语言。

对此进行分析的最简单方法是添加几个类似于以下内容的时间戳：

`var timestamps:Array = [];`

然后在代码中的不同位置推送`getTimer()`，然后在函数完成时将它们打印出来