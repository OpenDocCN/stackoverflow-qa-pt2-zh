# StackOverflow 问答 14522000-14522999

# sql - 无法对表中的数据进行分组

> ID：14522000
> 
> 赞同：0
> 
> 时间：2013-01-25T12:39:42.680
> 
> 标签：sql, sql-server-2008-r2

```
Id | MenuName      | vc_Link | SubMenu1 | IsMainMenu | TypeOfMenu
-----------------------------------------------------------------------
1  | Home          |  NULL   |  NULL    |     1      |     0
2  | Projects      |  NULL   |  NULL    |     1      |     0
4  | Pr1           |  NULL   |   2      |     0      |     1
5  | Homesub       |  NULL   |   1      |     0      |     1
6  | Pr1Sub1       |  NULL   |   4      |     0      |     2 
```

以上是我的表结构。

1.  MenuName 是菜单和子菜单的名称
2.  SubMenu1 是子菜单属于特定菜单，其 id 保存为 submenu1
3.  MainMenu 有点知道是菜单还是子菜单。
4.  typeofmenu 是那个

> ```
> 0 means main menu
> 1 means submenu
> 2 means submenu's submenu 
> ```

现在我的问题是我想显示如下

```
 1 Home
      5 HomeSub
   2 Projects
     4 Pr1
         6 Pr1Sub1

   Id | MenuName      | vc_Link | SubMenu1 | IsMainMenu | TypeOfMenu
    -----------------------------------------------------------------------
    1  | Home          |  NULL   |  NULL    |     1      |     0
    5  | HomeSub       |  NULL   |  1       |     0      |     1
    2  | Projects      |  NULL   |  NULL    |     1      |     0
    4  | Pr1           |  NULL   |   2      |     0      |     1
    6  | Pr1Sub1       |  NULL   |   4      |     0      |     2 
```

怎么分组这样？只有在像这样分组之后，我才能将此查询的结果作为显示菜单及其子菜单的树结构。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T12:45:46.337

像这样的东西：

```
with menu_tree (id, menuname, level, sort_path) as (
   select id, 
          cast(menuname as varchar(max)), 
          1 as level,
          cast(id as varchar(max)) as sort_path
   from menus
   where submenu1 is null
   union all
   select m.id, 
          cast(replicate('_', p.level * 2) + m.menuname as varchar(max)) as menuname, 
          p.level + 1,
          p.sort_path + '_' + cast(m.id as varchar(max))
   from menus m
     join menu_tree p on p.id = m.submenu1
)  
select id, menuname
from menu_tree
order by sort_path; 
```

SQLFiddle：[http ://sqlfiddle.com/#!3/6c4ba/1](http://sqlfiddle.com/#!3/6c4ba/1)

# api - 你的模型应该知道你的 API 版本吗？

> ID：14522003
> 
> 赞同：1
> 
> 时间：2013-01-25T12:39:51.383
> 
> 标签：api, rest, sinatra, versioning, software-design

我们将为我们的 API 代码实现一个版本控制系统，该系统基于 sinatra 构建，并且将有一个默认的 API 版本，客户端将能够选择添加 HTTP Accept Header 的特定版本。

现在我想了解您是否将 API 版本信息严格保留在控制器中，或者您允许 api 版本以某种方式在您的模型中传递。如果将它保存在控制器中，那么在模型中传播 API 版本有什么缺点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T19:56:20.980

对您的 API 进行版本控制并不意味着您的控制器在内部处理版本控制，然后与也在内部处理版本控制的模型进行通信。相反，这意味着您应该拥有不同版本的控制器和模型，您可以根据请求中的 API 版本在运行时换入和换出。

现在，我从提到 Sinatra 推测您正在使用 Ruby。我对 Sinatra 或 Ruby 知之甚少，但[我为 ASP.NET MVC 4 回答了一个类似的问题，](https://stackoverflow.com/a/15094532/326110)并讨论了由 Sebastiaan Dammann 编写的版本控制框架。

也许看看 Ruby 是否已经存在类似的框架。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T14:01:31.567

在 RESTful API 设计中，版本控制是通过选择媒体类型来完成的，我相信这就是您想要做的。如果我对第二段的理解正确，您是在问版本信息是否也应该在交付的响应中（即文档模型的一部分）？

这样的决定是任意的，但许多格式在其内部携带版本信息，以防它们通过元数据（例如版本信息）可能丢失的有损系统。出于这个原因，我建议将其放入您的模型中。

# c++ - boost::thread::timed_join(0) 是否获得锁？

> ID：14522004
> 
> 赞同：0
> 
> 时间：2013-01-25T12:39:54.157
> 
> 标签：c++, boost, boost-thread

我需要检查我创建的 boost::thread 是否从另一个线程运行。[这个](https://stackoverflow.com/questions/1667420/how-can-i-tell-reliably-if-a-boost-thread-has-exited-its-run-method)SO post 解释了你可以通过调用来做到这一点：

```
boost::posix_time::seconds waitTime(0);
myBoostThread.timed_join(waitTime); 
```

我的客户端线程中不能有任何关键部分。我可以保证`timed_join()`使用 0 时间参数是无锁的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T13:09:05.477

不，没有这样的保证。
即使 boost 实现是完全无锁的（我没有检查过），也不能保证底层操作系统实现是完全无锁的。

也就是说，如果在这里使用锁，我会发现它们不太可能导致应用程序出现任何重大延迟，所以我会毫不犹豫地使用`timed_join`，除非有一个硬的实时截止日期要满足（这不*等同*于 UI 响应能力） ）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-25T16:49:09.597

Boost.Thread 不保证无锁`timed_join()`。但是，总是会发生变化的实现：

*   Boost.Thread 为 pthread 获取互斥锁，然后对条件变量执行定时等待。
*   Boost.Thread 调用[`WaitForMultipleObjects`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms687025%28v=vs.85%29.aspx)窗口。它的文档表明它总是会立即返回。但是，我不知道底层操作系统实现是否是无锁的。

作为替代方案，请考虑使用原子操作。虽然 Boost 1.52 当前不提供公共原子库，但 Boost.Smart_Ptr 和 Boost.Interprocess 在其详细命名空间中都有原子整数。但是，这些都不能保证无锁实现，并且 Boost.Smart_Ptr 的配置之一将使用`pthread mutex`. 因此，您可能需要查阅编译器和系统文档来确定无锁实现。

不过，这里有一个小例子，使用`boost::detail::atomic_count`：

```
#include <boost/chrono.pp>
#include <boost/detail/atomic_count.hpp>
#include <boost/thread.hpp>

// Use RAII to perform cleanup.
struct count_guard
{
  count_guard(boost::detail::atomic_count& count) : count_(count) {}
  ~count_guard() { --count_; }
  boost::detail::atomic_count& count_;
};

void thread_main(boost::detail::atomic_count& count)
{
  // Place the guard on the stack. When the thread exits through either normal
  // means or the stack unwinding from an exception, the atomic count will be
  // decremented.
  count_guard decrement_on_exit(count);
  boost::this_thread::sleep_for(boost::chrono::seconds(5));
}

int main()
{
  boost::detail::atomic_count count(1);
  boost::thread t(thread_main, boost::ref(count));

  // Check the count to determine if the thread has exited.
  while (0 != count)
  {
    std::cout << "Sleeping for 2 seconds." << std::endl;
    boost::this_thread::sleep_for(boost::chrono::seconds(2));
  }
} 
```

在这种情况下，[`at_thread_exit()`](http://www.boost.org/doc/libs/1_52_0/doc/html/thread/thread_management.html#thread.thread_management.this_thread.atthreadexit)扩展可以用作使用[RAII](http://en.wikipedia.org/wiki/Resource_Acquisition_Is_Initialization)的替代方法。

# c# - 实体框架代码优先，与继承1:1关联

> ID：14522007
> 
> 赞同：1
> 
> 时间：2013-01-25T12:40:08.727
> 
> 标签：c#, entity-framework, inheritance, ef-code-first, associations

我有一个抽象类`UserProfile`，它有一个子类`Tenant`，所以关系是 1:1 - 一个“用户”是一个“租户”。

这是在 1:1 的基础上实现 table-per-type 继承的正确方法吗？

```
[Table("UserProfile")]
public abstract class UserProfile
{
    [Key]
    [DatabaseGeneratedAttribute(DatabaseGeneratedOption.Identity)]
    public int UserId { get; set; }
    // ...
}

[Table("Tenant")]
public class Tenant : UserProfile
{
    public string PersonalDescription { get; set; }
    // ...

    // Navigation property on dependant end
    public virtual UserProfile UserProfile { get; set; }
} 
```

*   我将导航属性放在关系的依赖端是否正确？或者它的结局是否重要？

*   我还需要放置一个类型为`Tenant`in 的导航属性`UserProfile`吗？

*   最后，我读到值得让模型中的每个属性`virtual`来帮助 EF 进行更改跟踪 - 这是必要的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T14:03:52.873

在每个类型的表方案中，您不需要导航属性。Tenant 不包含 UserProfile，Tenant 是一个 UserProfile。

EF 应该能够从 Tenant 表中获取 Tenant 字段的值，以及从 UserProfile 表中获取从 UserProfile 继承的字段。看起来很神奇，但它有效，至少对我来说:)

至于 DbSet，如果需要直接使用`Tenant`集合，可以添加`Tenants`DbSet。这将使您能够：

```
myContext.Tenants.Where(t => ... t.PersonalDescription ... t.UserId ...) 
```

这相当于较长且不易发现的

```
myContext.UserProfiles.OfType<Tenant>.Where(t => ....) 
```

我个人的偏好是根本不使用已声明的 DbSet，而是`Set<T>()`直接在包装存储库中使用该方法，该方法公开诸如等方法，但这是个人喜好问题`GetByKey`。`Update`

# c# - 排序重定向到另一个页面

> ID：14522008
> 
> 赞同：2
> 
> 时间：2013-01-25T12:40:14.127
> 
> 标签：c#, asp.net, visual-studio-2010, gridview

我用来对我的列`SortExpression="fieldName"`进行排序。`GridView`并且工作完美！但是现在当我点击“列的标题”时，它会重定向到另一个页面......而且无论我尝试排序哪一列，它总是重定向到同一页面。我不知道它可能是什么。有什么线索吗？
这是我的网格视图：

```
<asp:GridView ID="GridView1" runat="server" AutoGenerateColumns="False" style="font-family: Verdana, Arial, Sans-Serif" 
            DataKeyNames="id"
            CssClass="gridview" DataSourceID="MyDataSource"
            AllowSorting ="True" AllowPaging="True" BackColor="#CCCCCC" 
            BorderStyle="Inset" BorderWidth="2px" BorderColor="GrayText"
            CellPadding="1"
            CellSpacing="5"
            HeaderStyle-HorizontalAlign="Center"
            OnRowDataBound="GridView1_RowDataBound" 
            ForeColor = "Black" RowStyle-CssClass="gridview" 
            onrowcommand="GridView1_RowCommand">            
            <AlternatingRowStyle BackColor="#CCCCCC" />
                <columns>

                    <asp:BoundField HeaderText="ID" DataField="id"  />
                    <asp:BoundField HeaderText="PRIORIDADE" DataField="prioridade" ItemStyle-HorizontalAlign="Center" />
                    <asp:BoundField  HeaderText="SITUAÇÃO"  DataField="situacao" ItemStyle-HorizontalAlign="Center" >
                    <ItemStyle HorizontalAlign="Center" />
                    </asp:BoundField>
                    <asp:BoundField HeaderText="RESPONSAVEL" DataField="responsavel" HeaderStyle-Width="65px" ItemStyle-HorizontalAlign="Center">
                    <HeaderStyle Width="65px" />
                    <ItemStyle HorizontalAlign="Center" />
                    </asp:BoundField>
                    <asp:BoundField HeaderText="DATA DE CADASTRO" DataField="dt_cadastro" SortExpression="dt_cadastro" DataFormatString="{0:dd/MM/yyyy}" HeaderStyle-Width="60px"
                    ItemStyle-HorizontalAlign="Center" >
                    <HeaderStyle Width="60px" />
                    <ItemStyle HorizontalAlign="Center" />
                    </asp:BoundField>
                    <asp:BoundField HeaderText="PREVISÃO DE TÉRMINO" DataField="previsao_termino" DataFormatString="{0:dd/MM/yyyy}" HeaderStyle-Width="60px"
                    ItemStyle-HorizontalAlign="Center">
                    <HeaderStyle Width="60px" />
                    <ItemStyle HorizontalAlign="Center" />
                    </asp:BoundField>
                    <asp:BoundField HeaderText="PROJETO" DataField="projeto"  ItemStyle-HorizontalAlign="Center"></asp:BoundField>
                    <asp:BoundField HeaderText="FUNCIONALIDADE" DataField="funcionalidade" ItemStyle-HorizontalAlign="Center" />
                    <asp:BoundField HeaderText="CLUBE" DataField="clube"  ItemStyle-HorizontalAlign="Center" />

                    <asp:TemplateField HeaderStyle-Width="70px" HeaderText="VISUALIZAR" >
                        <ItemTemplate>
                            <asp:Button ID="Btn_Visualizar" runat="server" Text="VISUALIZAR" CssClass="Btn_Grid"  Font-Size="7pt" Font-Names="Verdana, Arial"  OnClick="Btn_Visualizar_Click"
                            CommandName="visualizar" CommandArgument="<%# ((GridViewRow)Container).RowIndex %>" />                            
                        </ItemTemplate>
                    </asp:TemplateField>
                    <asp:TemplateField HeaderStyle-Width="66px" HeaderText="ALTERAR">
                        <ItemTemplate>
                            <asp:Button ID="Btn_Alterar" runat="server" Text="ALTERAR" CssClass="Btn_Grid" Font-Size="7pt" Font-Names="Verdana, Arial"
                            CommandName="editar" CommandArgument="<%# ((GridViewRow)Container).RowIndex %>" />
                        </ItemTemplate>
                    </asp:TemplateField>

                </columns>
            <EditRowStyle ForeColor="Black" CssClass="GridViewEditRow" />
            <FooterStyle BackColor="#CCCCCC" />
            <HeaderStyle BackColor="Black" Font-Bold="True" ForeColor="White" BorderColor="White" BorderStyle="Solid" BorderWidth="1px" />
            <PagerStyle BackColor="#CCCCCC" ForeColor="Black" HorizontalAlign="Left" />
            <RowStyle BackColor="White" />
            <SelectedRowStyle BackColor="#000099" Font-Bold="True" ForeColor="White" />      
            </asp:GridView> 
```

行命令：

```
protected void GridView1_RowCommand(object sender, GridViewCommandEventArgs e)
        {
            if (e.CommandName == "visualizar")
            {
                Session["id"] = GridView1.Rows[Convert.ToInt32(e.CommandArgument.ToString())].Cells[0].Text;
                Session["editar"] = null;
            }
            else if (e.CommandName == "editar")
            {
                Session["id"] = GridView1.Rows[Convert.ToInt32(e.CommandArgument.ToString())].Cells[0].Text; //Grava o ID do chamado da linha correspondente.
                Session["editar"] = 1; // 1 - Editar   2 - Não Editar .
            }

            Response.Redirect("/Adm/DetalhesChamado.aspx");

        } 
```

Obs：如您所见，我有一个`Button`( `Btn_Alterar`) 重定向到另一个页面，当我单击对列进行排序时，我将重定向到同一页面。我不知道是否与它有关...谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T13:29:15.377

回发是因为`onrowcommand="GridView1_RowCommand`.

当一个`onrowcommand`附加到`GridView`它时，当你点击它时它会被直接触发。尝试删除事件或相应地更新代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T13:00:45.213

很可能，那是一个 postback.coz 的`onrowcommand="GridView1_RowCommand"`

# java - 最终局部变量的寿命

> ID：14522012
> 
> 赞同：0
> 
> 时间：2013-01-25T12:40:18.697
> 
> 标签：java, inner-classes

最终局部变量（在方法内）的生命周期是否与其他局部变量相同，即它们是否在方法调用结束并删除堆栈后立即死亡？
如果是这样，那么我们如何才能在方法局部类中访问最终局部变量，而其他局部变量却不能呢？
请澄清我的查询。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T12:51:58.567

当你创建一个匿名内部类的实例时，你实际上是在创建一个**闭包**，这是一种特殊的语言结构，据说可以“关闭”局部变量。幕后发生的事情是最终变量的值被复制到匿名实例的合成实例变量中。像往常一样，堆栈分配的最终变量本身会随着该方法而死。

# ruby-on-rails - 特定管理员用户的视图中的永久 gravatar

> ID：14522015
> 
> 赞同：0
> 
> 时间：2013-01-25T12:40:37.370
> 
> 标签：ruby-on-rails, gravatar

为用户实例实现 gravatar 是`<%= gravatar_for @user %>`.

如果我想指定另一个用户，一个管理员用户，他会在所有普通用户的视图中拥有一个永久的 gravatar。我将如何实施呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T12:45:07.983

您必须将管理员用户从数据库中拉出并使用`gravatar_for(@admin_user)`或将 gravatar URL 硬编码为`image_tag`.

如果你能摆脱它，就做后者。

# java - 在 for 循环中返回

> ID：14522017
> 
> 赞同：4
> 
> 时间：2013-01-25T12:40:55.050
> 
> 标签：java, for-loop, jls

> **可能重复：**
> [为什么会出错？](https://stackoverflow.com/questions/14521547/why-does-this-get-error)

下面的 3 个方法做的事情完全相同，显然返回 true。

但是，前两个编译但第三个不编译（“缺少返回语句”）。

语言规范的哪一部分规定了这种行为？

```
boolean returnTrue_1() { // returns true
    return true;
}

boolean returnTrue_2() { // returns true
    for (int i = 0; ; i++) { return true; }
}

boolean returnTrue_3() { // "missing return statement"
    for (int i = 0; i < 1; i++) { return true; }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-25T12:48:55.707

> 如果将方法声明为具有返回类型，则如果方法的主体可以正常完成（第 14.1 节），则会发生编译时错误。

见 [方法体](http://docs.oracle.com/javase/specs/jls/se7/html/jls-8.html#jls-8.4.7)

语句的[正常和突然完成](http://docs.oracle.com/javase/specs/jls/se7/html/jls-14.html#jls-14.1)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-25T12:43:38.707

这样的方法必须有一个保证执行的返回语句，而在 v3 中不是这种情况。
在某些情况下，您可以通过人类智能知道调用 return 是有保证的，但编译器却不知道。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-25T13:37:36.933

编译器给出了符合[JLS 8.4.7](http://docs.oracle.com/javase/specs/jls/se7/html/jls-8.html#jls-8.4.7)的错误，因为它确定该方法可以正常完成：

> 如果将方法声明为具有返回类型，则如果方法的主体可以正常完成，则会发生编译时错误。

判断方法能否正常完成，编译器需要判断for循环是否能正常完成，在[JLS 14.21](http://docs.oracle.com/javase/specs/jls/se7/html/jls-14.html#jls-14.21)中有定义：

> 如果以下至少一项为真，则基本 for 语句可以正常完成：
> 
> *   for语句可达，有条件表达式，条件表达式不是值为true的常量表达式。
> *   有一个可到达的 break 语句退出 for 语句。

在第三种方法的情况下，有一个条件表达式，它不是一个常量表达式，因为`i`它不是最终的。所以for语句可以正常完成，结果方法也可以。

QED。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-25T12:47:51.477

Java 确保如果方法具有返回类型，则无论如何都必须返回某些内容。如果返回语句在条件语句中，则它可能会被执行，也可能不会被执行。因此，您必须在 for 循环之外放置一个 return 语句才能编译您的代码。在第二种情况下，没有条件所以没问题

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-25T12:52:57.923

具有某种返回类型的函数必须保证返回语句。任何条件块中的返回语句不保证返回值。所以你可能会收到警告。

但在第 3 种情况下，开始时条件为假，因此您会收到错误消息。

尝试一些前：

```
int abc1(){
    if(x>5)    // warning because return is possible but not assured.
    return x;
}

int abc2(){
x=0        
if(x>0)    // error because return is  not possible
return x;
}

int abc3(){        
if(x>0)    // no error no warning because return is  assured. 
return x;
else
return 1;
} 
```

# mysql - MySQL加入而不是子查询

> ID：14522018
> 
> 赞同：1
> 
> 时间：2013-01-25T12:40:59.400
> 
> 标签：mysql, sql, sql-delete

嘿伙计们，我想要这样的东西：

```
DELETE FROM ClientsFlags 
WHERE clientId = (SELECT id 
                  FROM Client 
                  WHERE emailRegistrationToken = 3) 
AND flagId = 42; 
```

但是使用连接而不是子查询。我不太擅长加入，所以请帮帮我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T12:43:21.180

这是一个加入版本，

```
DELETE  a
FROM    ClientsFlags a
        INNER JOIN Client b
            ON a.clientId = b.id
WHERE   b.emailRegistrationToken = 3 AND            
        a.flagId = 42; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-25T13:24:55.453

试试这个

`Delete C From ClientFlags cf, Client c where cf.lientId=c.Id and email=3 and flagId=42;`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-25T12:44:32.780

你应该尝试这样的事情：

```
 DELETE C FROM ClientsFlags AS CF
 JOIN Client AS C ON C.Id=CF.clientId 
 WHERE email=3 and flagId=42 
```

# android - Android：修改另一个应用程序的 SharedPreferences

> ID：14522037
> 
> 赞同：7
> 
> 时间：2013-01-25T12:42:21.327
> 
> 标签：android, sharedpreferences, root

我正在尝试编写必须在另一个应用程序的共享首选项（`data/data/package_name/shared_prefs/file.xml`）中读取、修改和保存一些设置的应用程序。

这个应用程序不是我的，我有用于测试的 root 设备。

我应该向清单添加哪些 android 权限以及如何访问该文件并对其进行修改？我知道`SharedPreferences`每个 App/APK 都是独一无二的，但我需要在 root 模式下修改它。

我有工作代码来修改 sdcard 上的 xml 文件，但是当我更改它的路径时，`"data/data/package_name/shared_prefs/file.xml"`它会给我一个异常和消息

```
android open failed eacces (permission denied) 
```

有没有办法我可以做到这一点？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-08-08T10:42:52.217

要实际回答您的问题，如果您有根，则可以通过反射来完成。我已经在 android 4.1 上完成了它，在其他平台上它可能会以不同的方式工作。好消息是共享首选项不能仅由系统服务访问，因此您可以通过反射访问“隐藏”方法。把它放在一个try-catch中：

```
Process proc = Runtime.getRuntime().exec(new String[] { "su", "-c", "chmod 777 /data/data/package_name/shared_prefs/package_name_preferences.xml" });
proc.waitFor();
proc = Runtime.getRuntime().exec(new String[] { "su", "-c", "chmod 777 /data/data/package_name/shared_prefs" });
proc.waitFor();
proc = Runtime.getRuntime().exec(new String[] { "su", "-c", "chmod 777 /data/data/package_name" });
proc.waitFor();

File preffile = new File("/data/data/package_name/shared_prefs/package_name_preferences.xml");

Class prefimplclass = Class.forName("android.app.SharedPreferencesImpl");

Constructor prefimplconstructor = prefimplclass.getDeclaredConstructor(File.class,int.class);
prefimplconstructor.setAccessible(true);

Object prefimpl = prefimplconstructor.newInstance(preffile,Context.MODE_WORLD_READABLE | Context.MODE_WORLD_WRITEABLE);

Editor editor = (Editor) prefimplclass.getMethod("edit").invoke(prefimpl);
//put your settings here
editor.commit(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-25T12:56:12.670

看看这个答案：

[https://stackoverflow.com/a/13139280/361230](https://stackoverflow.com/a/13139280/361230)

使用 su 时，您将有权修改文件系统上的任何内容。

但是，我同意 Chris 的观点，即按照自己的意愿去做并不是一件好事。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-02-26T11:19:43.607

我遇到了同样的问题，我尝试了一切，我在 StackOverflow 和网络上的其他地方找到的每一个建议都没有任何帮助。即使我的设备已植根，我总是以“无权限”错误告终。

最后，我想出了一个使用[Xposed](https://www.lifewire.com/xposed-framework-4148451)的优雅解决方案。

在我下面的解决方案中，我挂钩了类的`onCreate`方法`Application`，然后我得到了`Context`我想要编辑它的应用程序的保留`SharedPreferences`，然后我使用. 这里是：`Context``SharedPreferences`

```
public class MainXposed implements IXposedHookLoadPackage{
    private static final String TAG = "MainXposed";

    @Override
    public void handleLoadPackage(XC_LoadPackage.LoadPackageParam loadPackageParam) throws Throwable {
        Log.d( TAG, "handleLoadPackage: loadPackageParam.packageName --> " + loadPackageParam.packageName );
        if ( loadPackageParam.packageName.contains( "com.someapp" ) ) {

            findAndHookMethod("android.app.Application", loadPackageParam.classLoader, "onCreate", new XC_MethodHook() {
                @Override
                protected void beforeHookedMethod(MethodHookParam param) throws Throwable {

                }
                @Override
                protected void afterHookedMethod(MethodHookParam param) throws Throwable {
                    Log.d( TAG, "afterHookedMethod()" );

                    String pkg = "com.someapp";
                    Application application = ( Application ) param.thisObject;
                    Context someappContext = application.getApplicationContext();

                    someappContext.createPackageContext( pkg ,Context.CONTEXT_IGNORE_SECURITY );
                    SharedPreferences someapp_prefs = someappContext.getSharedPreferences(pkg + "_preferences", Context.MODE_PRIVATE );
                    SharedPreferences.Editor editor = someapp_prefs.edit();
                    editor.putString( "some_prefs_key", "someNewValue" );
                    editor.apply();
                }
            });
        }
    }
}
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-01-25T13:34:03.993

除非您是其他应用程序的所有者，否则您不应该这样做。没有 root 的唯一方法是让它成为世界可读的，它已被贬值并且几乎从未使用过。

我怀疑任何人都会给你一个你想要的答案，除非你说明你为什么需要访问。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2013-01-25T12:46:32.037

您不应该更改另一个应用程序的首选项，无论是否植根。

# java - 如何通过在android中单击来缩放图像

> ID：14522038
> 
> 赞同：3
> 
> 时间：2013-01-25T12:42:23.753
> 
> 标签：java, android

我在 android 项目的 xml 文件中有一个图像，当我点击它时我需要缩放它。任何人都可以帮我写什么代码来使我的图像缩放。

以下是我的 xml 代码：

主.xml：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent" >

    <ImageView
        android:id="@+id/imageView1"
        android:layout_width="120dp"
        android:layout_height="120dp"

        android:src="@drawable/rtt" />

</RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2021-09-29T23:50:47.250

尝试使用 setScaleX 和 setScaleY 方法

```
imageview1.setScaleX((float)(1));
imageview1.setScaleY((float)(1)); 
```

放大使用大于 1 的浮点数，缩小使用小于 1 的浮点数，停止放大/缩小使用 1 这是一个示例：

```
imageview1.setOnClickListener(new View.OnClickListener() {
    @Override
    public void onClick(View _view) {
        isZoomOn = !isZoomOn;
        if (isZoomOn) {
            imageview1.setScaleX((float)(1.5d));
            imageview1.setScaleY((float)(1.5d));
        }
        else {
            imageview1.setScaleX((float)(1));
            imageview1.setScaleY((float)(1));
        }
    }
}); 
```

# java - 生成一组对象的所有组合

> ID：14522044
> 
> 赞同：-1
> 
> 时间：2013-01-25T12:42:43.140
> 
> 标签：java, object, combinations, powerset

我在这里遇到一个问题，我需要生成所有可能的对象组合并将它们存储在列表中以供稍后分析..

Internet 上的搜索包括许多算法，这些算法无法满足存储组合的要求。大多数常见的搜索只是通过打印出来来生成组合列表，而其他搜索只处理字符串，而不是对象。

一些算法使用位来表示不同的组合，但这种解决方案最多只能限制 32 个对象，这还不够好。

总的来说，我正在寻找一种算法，我可以在其中生成所有可能的组合（幂集），处理对象（超过 32 个），并且不仅限于打印出组合，而是将这些组合存储在数组。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T13:09:58.760

您是否考虑过这样的想法：不是一次将所有组合生成到一个潜在的巨大且难以管理的数组中，而是为数组中的每个条目编写一个生成器，从而制作一种伪数组，其中访问一个条目会动态创建条目.

`enum`这是我在另一个与之接近的问题中发布的迭代器的代码。虽然它实现了`Iterator`，但它在内部通过解码其索引并动态从索引的位模式中挑选组合来生成每个组合（参见`private Enum[] get(int x)`方法）。如果您愿意，应该可以将其扩展为使用`BigInteger`甚至`byte[]`用于索引。

```
public class EnumIterator implements Iterator<Enum[]> {
  // The enum classes
  private final Class<? extends Enum>[] enums;
  // The pseudo-position in the list.
  private int i = 0;
  // The total entries in the list.
  private final int N;

  // Construct from classes.
  private EnumIterator(Class<? extends Enum>... enums) {
    // Grab the enums.
    this.enums = enums;
    // Work out the Max as the product of all sets of constants.
    int max = 1;
    for (int n = 0; n < enums.length; n++) {
      max *= enums[n].getEnumConstants().length;
    }
    N = max;
  }

  // Get that one from the possibles.
  private Enum[] get(int x) {
    // Make new array.
    Enum[] next = new Enum[enums.length];
    // Fill it with the ith entry.
    for (int j = next.length - 1; j >= 0; j--) {
      Enum[] e = enums[j].getEnumConstants();
      // Pick the right one from it.
      next[j] = e[x % e.length];
      // Fold out that enum.
      x /= e.length;
    }
    return next;
  }

  @Override
  public boolean hasNext() {
    return i < N;
  }

  @Override
  public Enum[] next() {
    if (hasNext()) {
      return get(i++);
    } else {
      throw new NoSuchElementException();
    }
  }

  @Override
  public void remove() {
    throw new UnsupportedOperationException("Not supported.");
  }

  enum ABC {
    A, B, C;
  }

  enum XY {
    X, Y;
  }

  enum IJ {
    I, J;
  }

  enum OneTwoThree {
    ONE, TWO, THREE
  }

  private static void test() {
    // Also works - but constructing from classes is cleaner.
    //Iterator<Enum[]> i = new EnumIterator(ABC.values(), XY.values(), IJ.values());
    System.out.println("ABC x XY x IJ");
    for (Enum[] e : Iterables.in(new EnumIterator(ABC.class, XY.class, IJ.class))) {
      System.out.println(Arrays.toString(e));
    }
    System.out.println("ABC");
    for (Enum[] e : Iterables.in(new EnumIterator(ABC.class))) {
      System.out.println(Arrays.toString(e));
    }
    System.out.println("ABC x OneTwoThree");
    for (Enum[] e : Iterables.in(new EnumIterator(ABC.class, OneTwoThree.class))) {
      System.out.println(Arrays.toString(e));
    }
    System.out.println("MT");
    for (Enum[] e : Iterables.in(new EnumIterator())) {
      System.out.println(Arrays.toString(e));
    }
  }

  public static void main(String args[]) {
    test();
  }
} 
```

# java - Liferay Portlet 可以监听数据库事件吗？

> ID：14522053
> 
> 赞同：2
> 
> 时间：2013-01-25T12:43:16.960
> 
> 标签：java, database, liferay, cluster-computing

**我目前的设置：**

*   多个节点共享相同的数据库来更新值。
*   缓存不在它们之间共享

**要求 ：**

*   当任何一个节点进行数据库更新时，都需要更新 liferay 缓存。

**问题**

*   有没有办法 portlet 可以监听我的数据库并更新它的缓存。
*   缓存独立性是正确的方法吗？（我无法控制这个决定）
*   如果我们进行适当的集群，我们可以关闭一个独立于另一个节点的节点吗？liferay 会自动处理吗？

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T17:19:17.817

I would cluster Liferay and enable propagation of cache invalidation. Then when something changes the data would be automatically updated.

If you by cache independency mean that the cache is not replicated then I would say yes. Replication is costly and propagation of cache invalidation should suffice.

If you have clustering you have to have node balancing in front of Liferay (apache ...). Then when you kill one Liferay the balancer should detect it and ignore the killed node until it goes up again.

# php - 在php，wordpress CMS中将字符串转换为时间

> ID：14522055
> 
> 赞同：1
> 
> 时间：2013-01-25T12:43:20.070
> 
> 标签：php, wordpress

我正在 WordPress 中编写一个函数来将 XML 文件中的数据添加到 MySQL 数据库中。在我从 XML 中获得日期值之后，问题就发生了。这是一个字符串类型，我使用以下代码将其格式化为日期时间：

```
$mysqlDay = date('d/m/Y',strtotime($day)); 
```

`$day`是从 XML 检索的日期值：“25/01/2013”​​(d/m/Y)。的值为`$mysqlDay`“01/01/1970”（d/m/Y）。为什么变量`$mysqlDay`具有开始日的值而不是`$day`？如果我想将它从字符串格式化为日期，我该怎么办？

在与上述类似的问题中，如果我想将格式为“18:00”(H:M) 的字符串转换为时间，我该怎么办？

我在 WordPress 中使用此代码将这些值添加到数据库中：

```
$wpdb->insert('wp_lps',
  array('date'=>$mysqlDay,
  'start'=> $mysqlStartTime, 
  'end'=> $mysqlEndTime),
  array('D/M/Y',
  'H:M',
  'H:M')
  ); 
```

这是正确的吗？`wp_lps`是我创建的表，`$mysqlStartTime`需要`$mysqlEndTime`格式化为H:M。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T12:50:32.190

您可以改用 DateTime ：

```
$mysqlDay = DateTime::createFromFormat('d/m/Y', $day); 
```

它更优雅，面向对象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-25T20:21:45.820

在[我的另一个答案](https://stackoverflow.com/a/14522141/209139)中，我回答了您实际提出的问题。然而，事实证明（在评论中进行了多次讨论之后），这是一个*错误的问题*。

情况如下：您有一些 XML，其中包含 d/m/Y 格式的日期。您可以使用 SimpleXML 获取它。现在您有了一个 SimpleXML 对象。现在你想把它放到数据库中。

1.  将对象转换为字符串：

    ```
    $date = (string)$date; 
    ```

2.  将日期转换为 MySQL 识别为日期的格式。

    ```
    $date = date('Y-m-d', strtotime(str_replace('/', '-', $date))); 
    ```

3.  使用库将日期插入数据库`$wpdb`。

你的问题出在几个地方：

1.  `strtotime()`由于我的其他答案中列出的原因，日期的格式无法识别。
2.  您似乎认为需要一个日期对象才能将日期保存到 MySQL 数据库中。你没有。您想要的是 MySQL 识别为日期格式的字符串。您的代码和数据库之间的所有查询都在一种称为 SQL 的语言中发生，这完全是在字符串中发生的。您可能正在使用一个为您抽象出来的库（`$wpdb`），但它仍然是引擎盖下的字符串。
3.  您似乎认为`date()`和/或`strtotime()`返回了日期对象。他们没有。该`date()`函数返回一个字符串。该`strtotime()`函数返回一个整数（它是一个 UNIX 时间戳）。
4.  您尝试做的是获取格式为 d/m/Y 的日期（字符串），将其转换为表示 UNIX 时间戳的整数，然后将其转换回表示格式为 d/m/ 的日期的字符串Y，然后将其添加到数据库中。这在两个地方失败了：
    *   该`strtotime()`函数假定如果字符串中有斜线，则它是美式日期。
    *   MySQL 实际上也不喜欢这种日期格式。它想要 Ymd。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-25T12:48:27.507

> m/d/y 或 dmy 格式的日期通过查看各个组件之间的分隔符来消除歧义：如果分隔符是斜杠 (/)，则假定为美式 m/d/y；而如果分隔符是破折号 (-) 或点 (.)，则假定为欧洲 dmy 格式。

[文件](http://ie1.php.net/manual/en/function.strtotime.php)说。

所以你想在调用之前将这些斜杠转换为连字符`strtotime()`。

# qt - 关于qdockwidget的问题

> ID：14522057
> 
> 赞同：1
> 
> 时间：2013-01-25T12:43:21.673
> 
> 标签：qt, qdockwidget

我有一个小程序，显示两个 QDockWidgets 在屏幕右侧对齐。

最初，两个停靠小部件在右侧停靠上保持在另一个下方，但是当我最小化并重新显示应用程序时，两个停靠小部件变得间隔开，就好像它们试图均匀地覆盖垂直空间一样。当我再次最小化并重新显示它们时，它们会像开始时一样正确显示。谁能解释发生了什么？我可以控制停靠小部件的布局吗？

另一个问题是当我将停靠小部件从右侧停靠区域中取出时会发生什么。如果我尝试将其中一个停靠小部件放置在已经停靠的小部件之上，一切都很好，但是当我尝试定位在 Qt 下方时，将为每个停靠小部件创建两个选项卡。我不想要这种行为。我希望小部件始终位于另一个之下。这可以用Qt完成吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T14:23:24.747

我找到了解决方案。在主窗口中执行：

setDockOptions(!QMainWindow::AllowTabbedDocks);

# oracle - 将 BLOB 作为流插入比插入字节数组慢得多

> ID：14522062
> 
> 赞同：1
> 
> 时间：2013-01-25T12:43:52.877
> 
> 标签：oracle, spring, hibernate, blob

我有以下场景：客户端正在将文件上传到服务器。该文件通过 Hibernate 存储到 Oracle 数据库中。直到最近，对文件进行建模的实体还具有`byte[]`用于对 Blob 进行建模的数组属性。我们将其更改为 an 是`InputStream`因为我们不想将整个文件放在服务器的 RAM 中。在不久的将来，我们预计会有更多用户上传更大的文件，因此 RAM 确实是一个问题。

我做了一些性能测试，到目前为止的结果表明，与插入字节数组相比，流式传输大约慢了 1.8 倍。以下是为 10 次迭代插入 100MB 文件的一些结果：

```
Method       Mean Duration [ms]  SD [ms]
---------------------------------------
Byte Array   10733.0             264.0
Streaming    18089.0             913.0 
```

客户端和服务器之间的通信是使用 Spring RMI 完成的，而二进制数据本身的流式传输是使用[RMIIO](http://openhms.sourceforge.net/rmiio/)完成的。由于使用了 RMIIO，我们必须编写自己的 Blobtype，从客户端解包二进制文件并将其推送到 blob 的二进制流中。您可以在下面看到此代码。

到目前为止我做过的事情：

*   为了缩小问题所在，我在服务方法中解包 RMIIO 流并将其放入字节数组中，然后将其保存到数据库中。这样做，它产生的性能与一直使用字节数组相同。所以性能消耗不是来自 RMIIO 包，而是来自服务器和数据库之间的某个地方。
*   更改缓冲区大小对性能的影响很小

任何人都可以分享一些关于为什么插入流与插入字节数组相比如此慢的见解吗？

我的配置：

*   春天 3.1.1
*   RMIIO 2.0.0
*   休眠 3.6.10
*   甲骨文 11.2.0.1.0
*   用于 JDBC 10.2.0.5.0 的 Oracle 驱动程序

带有字节数组的旧实体（插入速度更快）：

```
@Entity
@Table(name = "MYBINARYOBJECT")
public class MyBinaryObject {

    @Id
    private Long id;

    @Lob
    private byte[] bytes;

} 
```

具有输入流的新实体（插入速度较慢）：

```
@Entity
@Table(name = "MYBINARYSTREAMOBJECT")
public class MyBinaryStreamObject {

    @Id
    private Long id;

    @Type(type = "MyBlobType")
    private RemoteInputStream bytes;

} 
```

我们的自定义 Blob 类型：

```
public class MyBlobType extends AbstractLobType {

    @Override
    protected Object nullSafeGetInternal(ResultSet rs, String[] names, Object owner, LobHandler lobHandler)
            throws SQLException, IOException, HibernateException {

        RemoteInputStreamServer server = new GZIPRemoteInputStream(lobHandler.getBlobAsBinaryStream(rs, names[0]));
        return server.export();
    }

    @Override
    protected void nullSafeSetInternal(PreparedStatement ps, int index, Object value, LobCreator lobCreator)
            throws SQLException, IOException, HibernateException {

        BufferedInputStream stream = null;
        try {
             ((RemoteInputStream) value).available();
             stream = new BufferedInputStream(
                    RemoteInputStreamClient.wrap((RemoteInputStream) value, RemoteRetry.NEVER), 16384);
             lobCreator.setBlobAsBinaryStream(ps, index, stream, -1);
        } catch (IllegalArgumentException e) {
            throw new MyStreamingException();
        }

    }
} 
```

# wordpress - 如何允许用户通过邮政编码过滤 Wordpress 自定义帖子类型

> ID：14522063
> 
> 赞同：0
> 
> 时间：2013-01-25T12:43:55.313
> 
> 标签：wordpress, filter, content-management-system, custom-post-type, meta-key

我有一个名为“合作伙伴”的自定义帖子类型，每个合作伙伴都有一个名为“postal_code”的自定义字段。我想在前端添加一个输入字段，以便用户可以通过输入（瑞士）四位邮政编码（只有数字）来过滤合作伙伴。例如，它会根据数字邮政编码显示离他们最近的 10 个合作伙伴。

有什么帮助吗？

非常感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T13:01:27.287

[http://codex.wordpress.org/Class_Reference/WP_Query](http://codex.wordpress.org/Class_Reference/WP_Query)

```
$paged = (get_query_var('paged')) ? get_query_var('paged') : 1;
$args= array(
   'post_type' => 'partners',
   'meta_key' => 'custom_field_name',
   'meta_value' => 'ND',
   'paged' => $paged
);

query_posts($args); 
```

或者如果您更喜欢它，请使用 WP_Query。

更多信息：

[http://codex.wordpress.org/Class_Reference/WP_Query#Type_Parameters](http://codex.wordpress.org/Class_Reference/WP_Query#Type_Parameters)

[http://codex.wordpress.org/Class_Reference/WP_Query#Type_Parameters](http://codex.wordpress.org/Class_Reference/WP_Query#Type_Parameters)

# python - django south 错误迁移失败

> ID：14522083
> 
> 赞同：1
> 
> 时间：2013-01-25T12:45:01.860
> 
> 标签：python, django, django-south

尝试使用 sudo python manage.py migrate core 时，谁能向我解释这个错误。谢谢你。

```
(django-env)pc-03:Ares user$ sudo python manage.py migrate core
Running migrations for core:
 - Migrating forwards to 0001_initial.
 > core:0001_initial
FATAL ERROR - The following SQL query failed: CREATE TABLE `country` (`countryID` varchar(255) NOT NULL PRIMARY KEY, `abbreviation` varchar(15) NOT NULL, `name` varchar(105) NOT NULL, `prefix` varchar(15) NOT NULL, `active` longtext NOT NULL, `created` datetime NULL, `modified` datetime NULL);
The error was: (1050, "Table 'country' already exists")
 ! Error found during real run of migration! Aborting.

 ! Since you have a database that does not support running
 ! schema-altering statements in transactions, we have had 
 ! to leave it in an interim state between migrations.

! You *might* be able to recover with:   = DROP TABLE `country` CASCADE; []
   = DROP TABLE `company` CASCADE; []
   = DROP TABLE `campaign` CASCADE; []
   = DROP TABLE `redemptionMethod` CASCADE; []
   = DROP TABLE `incentiveCost` CASCADE; []
   = DROP TABLE `incentive` CASCADE; []
   = DROP TABLE `recipient` CASCADE; []
   = DROP TABLE `code` CASCADE; []
   = DROP TABLE `redeemed` CASCADE; []

 ! The South developers regret this has happened, and would
 ! like to gently persuade you to consider a slightly
 ! easier-to-deal-with DBMS (one that supports DDL transactions)
 ! NOTE: The error which caused the migration to fail is further up.
Error in migration: core:0001_initial 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-25T12:49:46.980

错误是不言自明的：“表 'country' 已经存在”，这意味着您已经在数据库中创建了表 'country'。为避免这种情况，您可以将初始迁移作为假运行：

```
sudo python manage.py migrate core --fake 
```

# ip - HTTP 请求后 IP 更改

> ID：14522086
> 
> 赞同：-2
> 
> 时间：2013-01-25T12:45:07.703
> 
> 标签：ip, httprequest, httpresponse

我想在发出 HTTP 请求期间更改我的 IP 地址。我想知道我是否更改了 IP，如果任何请求尚未得到响应，会发生什么情况。即使此服务器的 IP 地址已更改，响应是否仍会定向到请求者服务器？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T12:49:45.280

http 是基于 tcp 的，这意味着问题和回复会转到同一个套接字（这是一个点对点连接介质）。现在，如果您在请求期间更改您的 IP 地址（即，有流量通过已建立的套接字连接），在所有操作系统上，我知道所有打开的套接字都将关闭（连接您和服务器的链接将被切断）。服务器和客户端都将收到该事件的通知并采取相应的行动，例如客户端可能决定重新打开套接字并重复请求，并且该请求将源自新的 IP 地址。

问题仍然是你在这里真正想要达到什么效果，因为这是一个相当不寻常的事件序列......

# javascript - 碰撞检测性能不佳

> ID：14522092
> 
> 赞同：0
> 
> 时间：2013-01-25T12:45:24.497
> 
> 标签：javascript, html, html5-canvas, kineticjs

我正在使用 KineticJs 构建一个游戏，它使用拖放来移动屏幕上的元素，我遇到了很大的性能问题，因为我检查了 dragmove 事件，如果你拖动的元素与可能的捕捉位置发生碰撞，然后拖动元素得到所有懒惰的。我正在使用内置函数的 kineticJs，但我感觉它们没有得到很好的优化。它实际上在 chrome 中工作得相当不错（你可以看到滞后），但在 Firefox 中它并不好。关于如何优化我的代码的任何想法

```
element.on('dragmove',function(evt){
    var position = stage.getUserPosition(evt);
    var snap = snapGroup.getIntersections(position.x,position.y);
    if(snap.length > 0) snapElement(snap[0]);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T12:49:17.287

找到瓶颈。我猜是这条线：

```
var snap = snapGroup.getIntersections(position.x,position.y); 
```

如果是这样，请设置一个计数器并仅每隔几个更新滴答更新一次。确保进行最终更新，`dragend`以便最终获得正确的最终位置。

**编辑：**

也许这样的事情可能会起作用：

```
var dragUpdateCount = 0;
var dragUpdateRate = 5;
element.on('dragmove',function(evt){
    dragUpdateCount++;
    if (dragUpdateCount >= dragUpdateRate) {
        var position = stage.getUserPosition(evt);
        var snap = snapGroup.getIntersections(position.x,position.y);
        if (snap.length > 0) {
            snapElement(snap[0]);
        }
        dragUpdateCount = 0;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T14:15:16.053

正如@Aram 指出的那样，瓶颈在于 .getIntersections() 函数。

.getIntersections() 函数非常占用内存/处理，因此您需要进行初步检查，将处理限制在某些位置。我制作的一个小游戏也遇到了类似的问题，.getIntersections() 的碰撞检测正在扼杀我的速度，我也尝试了 .intersects() 但它有类似的结果。我所做的是这样的：（不知道这是否适用于旋转）

```
 element.on('dragmove',function(){ //dont think you need the 'evt' passed here
     var position = stage.getUserPosition();
     var snapChildren = snapGroup.getChildren();  //get each snapGroup child
     for(var i=0; i<snapChildren.length; i++){
          if(position.x > snapChild[i].getX() && position.x < snapChild[i].getX()+snapChild[i].getWidth()){ // check horizontal bounding rectangle
                if(position.y > snapChild[i].getY() && position.y < snapChild[i].getY()+snapChild[i].getHeight(){ // check vertical bounding rectangle
                    var snap = snapGroup.getIntersections(position.x,position.y);
                    if(snap.length > 0) snapElement(snap[0]);
                }
           }
     }
 } 
```

所以这是一种“边界矩形”碰撞检测方法，应该尽量减少你必须做的处理。

即使您正在获取所有孩子并在 for 循环中处理它们，它仍然比 .getIntersections() 快

# sql-server - sql server jdbc 驱动程序的 DatabaseMetadata.getColumns 问题

> ID：14522094
> 
> 赞同：0
> 
> 时间：2013-01-25T12:45:25.837
> 
> 标签：sql-server, jdbc

我正在尝试获取表名中具有特殊字符的表的元数据。在正常情况下，我的代码工作正常，但我有一个表“TABLE[]}\|ABC”，其中 getColumns 没有返回任何值。

```
ResultSet rrc = meta.getColumns("SCHEMA_NAME", null, "TABLE_NAME", "%"); 
```

我还发现了一些奇怪的行为。只需在第一个参数中传递您的模式名称，并在其余 3 个参数中传递任何其他值。

```
 ResultSet rrc = meta.getColumns("SCHEMA_NAME", null, null, "%");
 while (rrc.next()) {
    System.out.println("-- col: " + rrc.getString(4));
 } 
```

只需更改`rrc.getString(4)(COLUMN_NAME)`或`rrc.getString(3)(TABLE_NAME)`添加其他组合并查找您收到的相同结果集的记录数。它将根据您的选择而有所不同。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T20:00:46.517

的第三个参数[`DatabaseMetaData.getColumns(...)`](http://docs.oracle.com/javase/7/docs/api/java/sql/DatabaseMetaData.html#getColumns%28java.lang.String,%20java.lang.String,%20java.lang.String,%20java.lang.String%29)称为`tableNamePattern`。它是一种`LIKE`模式，而不是文字。在`LIKE`- 模式中，反斜杠 ( `\`) 是转义字符。因此，如果要匹配名为 的表`TABLE[]}\|ABC`，则需要使用模式`TABLE[]}\\|ABC`（注意双斜杠），它作为 Java 字符串将是`"TABLE[]}\\\\|ABC"`.

# c# - 无法将“数据注释”转换为“布尔”

> ID：14522097
> 
> 赞同：0
> 
> 时间：2013-01-25T12:45:46.400
> 
> 标签：c#, asp.net, customvalidator

来自[http://msdn.microsoft.com/en-us/library/f5db6z8k(v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/f5db6z8k(v=vs.100).aspx)

我创建了一个 customeValidators.cs 页面，用于检查输入的数据是否存在于 Db 中。这行得通。但是，当我尝试从必要的页面中调用它时

```
protected void runUniqueReference(object source, ServerValidateEventArgs args)
{
    args.IsValid = (CustomValidators.UniqueReference(BOQRefTextBox.Text));
} 
```

我收到错误消息`CustomValidators.UniqueReference`，无法将“数据注释”转换为“布尔”任何想法？编辑;

```
 public static ValidationResult UniqueReference(string Reference)
    {
        ContextDB db = new  ContextDB();

        var lisStoredInDB =
            (from Bill in db.Bill_Of_Quantities
             where Bill.Reference == Reference
             select Bill.Reference).ToList();

        if (lisStoredInDB.Count != 0)
        {
            return new ValidationResult(string.Format("This reference is already stored in the database, Please enter another"));
        }

        return ValidationResult.Success;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T12:51:07.723

`args.IsValid`是 type `bool`，并且`CustomValidators.UniqueReference`不能返回该类型的值。所以，

```
args.IsValid = (CustomValidators.UniqueReference(BOQRefTextBox.Text)); 
```

将不起作用，因为您无法将返回值分配`UniqueReference`给`IsValid`.

由于`UniqueReference`返回一个[`ValidationResult`](http://msdn.microsoft.com/en-us/library/system.windows.controls.validationresult.aspx)，它应该看起来像这样：

```
args.IsValid = (CustomValidators.UniqueReference(BOQRefTextBox.Text)).IsValid; 
```

# android - Android 和链接库

> ID：14522100
> 
> 赞同：1
> 
> 时间：2013-01-25T12:46:05.040
> 
> 标签：android, shared-libraries, dalvik

对于 java 用户来说，这个问题可能听起来很傻。对不起，我是菜鸟。

我想知道在`Android`系统运行时如何加载库。

假设我有一个超级简单的 android 应用程序，它只调用位于`javax.net.ssl`包中的函数。

包含东西的jar（dex）`javax.net.ssl`将被插入到apk中（将其变成静态库）？还是在运行时，`Dalvik VM`会链接到android机器上安装的jar（或dex）文件？或者只是`Dalvik VM`被编译为包含每个 javax 包含本身？

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T13:18:04.110

它们实际上是在运行时通过加载存储在设备上的额外优化 dex 代码动态链接的。

实际上，对于许多组件，这在系统启动时发生一次，其中包含的进程和虚拟机成为每个应用程序继承对已在内存中的共享副本的只读访问。

本机库的工作方式大致相同，只是链接发生在虚拟机级别之下，在进程本身中。

# php - 用于超快速部分文本匹配的数据库/语言选项

> ID：14522103
> 
> 赞同：0
> 
> 时间：2013-01-25T12:46:25.953
> 
> 标签：php, python, database, performance, search

我正在构建一个项目，并且需要一种超快速的方式来提供基于部分文本匹配结果的自动完成提要。

我将仅对数据库中的一个字段进行索引/搜索，尽管数据库行将包含其他数据，但我不会对这些字段进行索引。我将有大约。25k 行。

要求：

*   必须匹配该字段中的任何位置（开始键入“Lor”、“Ipsum”、“olor”、“Sit Amet”时会找到 Lorem Ipsum Dolor Sit Amet）
*   需要非常快速地在 JSON 提要中返回结果（尽管数据的原始来源并不重要）
*   针对高流量的可扩展解决方案

我已经审查了几个选项...

*   在 mongoDB 中使用[类似查询的 MongoDB](https://stackoverflow.com/questions/5340045/like-query-in-mongodb)
*   ElasticSearch - 不确定我需要做的事情是否有点矫枉过正，并且没有看到任何匹配上述部分文本的例子
*   SQL LIKE 查询，但想象这还不够快？

编程语言不是什么大问题，但首选 Python 或 PHP。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T12:55:35.933

这听起来像是典型的全文搜索。根据您的应用程序和数据所在的数据库，进程内的[嗖嗖](http://whoosh.readthedocs.org/en/latest/)声可能会满足您的需求（如 Lucene for Java）。

您说得对，`LIKE`与实际的全文索引相比，SQL 查询的执行情况非常糟糕。MongoDB 可能也不是一个很好的选择，但可以根据您的建议进行调整。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-25T13:00:21.903

正如其他人所提到的，执行语言和句法分析（标记化、词干化、大小写和重音规范化等）的全文索引将为您提供最佳结果。但是，如果没有一定数量的设置和配置，就不会出现这种情况。

查看 Solr 的 Suggester 组件：[http](http://wiki.apache.org/solr/Suggester) ://wiki.apache.org/solr/Suggester ，并且有一个新组件 - 我认为它被称为 AnalyzingSuggester 或类似的东西，我认为它仅适用于 Lucene，所以如果你想要您可以使用它的内存解决方案（尽管仅限 Java）。

# javascript - 为什么 NgModelController.$modelValue != $parse(attrs.ngModel)(scope)？

> ID：14522107
> 
> 赞同：4
> 
> 时间：2013-01-25T12:46:32.437
> 
> 标签：javascript, angularjs

代码：[http ://plnkr.co/edit/xPZM5E7tjYqlt5NIabIu?p=preview](http://plnkr.co/edit/xPZM5E7tjYqlt5NIabIu?p=preview) **line-no:17**

在这段代码中，如果我使用`ctrl.$modelValue = nVal;`而不是 `$parse(attrs.ngModel).assign(scope, nVal);`then 它不起作用。你能指出原因吗？

```
angModule.directive('moChangeProxy', function ($parse) {
    return {
        require:'^ngModel',
        restrict:'A',
        link:function (scope, elm, attrs, ctrl) {
            var proxyExp = attrs.moChangeProxy;            
            scope.$watch(proxyExp, function (nVal) {
                if (nVal != ctrl.$modelValue) {
                    //ctrl.$modelValue = nVal;  // This does not work                  
                    $parse(attrs.ngModel).assign(scope, nVal); // This works well
                }
            });
            elm.bind('blur', function () {
                var proxyVal = scope.$eval(proxyExp);
                if(ctrl.$modelValue != proxyVal) {
                    scope.$apply(function(){
                        $parse(proxyExp).assign(scope, ctrl.$modelValue);
                    });
                }
            });
        }
    };
}); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-25T13:11:17.083

我猜“不起作用”是指当发生更改时，它不会像所有 $formatters 那样运行东西并更新 $viewValue？

如果是这样，这是因为 ngModelController 观察“模型表达式”的变化，而不是观察它自己的 $modelValue。

请参阅这些行：[https ://github.com/angular/angular.js/blob/master/src/ng/directive/input.js#L1046-L1065](https://github.com/angular/angular.js/blob/master/src/ng/directive/input.js#L1046-L1065)

如果你更新模型，那么手表就会被触发，所有的机器都会投入使用。如果您使用 $modelValue，则 ngModelController 不会意识到更改。

# android - 在 IDE 上获取 Android 的常量，例如 View.VISIBLE = 0;

> ID：14522113
> 
> 赞同：0
> 
> 时间：2013-01-25T12:46:51.500
> 
> 标签：android, netbeans

如何在 IDE 上获取 Android 的常量，例如`View.VISIBLE = 0;`
我有以下方法调用：`input2.setInputType( *int* );`
如何获取此方法的所有可能常量？我正在使用 Netbeans IDE。所以我会知道要使用哪些常量。

谢谢你！

# c++ - 是否可以在编译 (g++) 之前使用实例化模板查看 C++ 代码？

> ID：14522114
> 
> 赞同：14
> 
> 时间：2013-01-25T12:46:57.723
> 
> 标签：c++, templates, g++, instantiation, abstract-syntax-tree

g++ 编译器有一个生成宏扩展代码（-E）的标志，所以我想知道是否有办法在模板实例化之后在实际编译发生之前查看程序代码？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-25T14:15:25.640

好吧，您可以更接近地阅读编译器生成的 AST/ABT：

*   AST：抽象语法树
*   ABT：抽象绑定树

前者代表编译器理解的语法视图，后者在绑定解析后类似*（*即，`a`这里实际上是在 3 行之前声明的变量，或者`foo`对应于该头文件中定义的函数...）。

Clang 允许转储它的 AST……实际上是 ABT，实际上，它正在被改进；潜行开发者预览：

```
int Test __attribute__((visibility("default")));

int main(int argc, char** argv) {
  int x __attribute__((aligned(4))) = 5;
  int y = 2;
  for (;;)
    if (x != y++)
      break;
  return (x * y);
} 
```

![在此处输入图像描述](../Images/2f13d095de99a7df745b45aa905bfd94.png)

通常你应该看到模板是如何在那里实例化的。

*注意：要获得它，您需要`-ast-dump`通过 clang 前端。*

# ruby-on-rails - 如何使用 hash_id 将数组内容存储在哈希中

> ID：14522118
> 
> 赞同：-4
> 
> 时间：2013-01-25T12:47:05.577
> 
> 标签：ruby-on-rails, ruby, hash, nokogiri

```
require 'nokogiri'
require 'open-uri'
# Get a Nokogiri::HTML::Document for the page we’re interested in...
@doc = Nokogiri::XML(File.open("data.xml"))
# Search for nodes by css

ids = []
@doc.xpath('//itemid').each do |link|
    ids << link.content
end

hash = {}
i = 0
@doc.xpath('//realestate').each do |link|
    hash.store(link.to_s)
    i+=1
    #p hash
    #sleep 2
    #break if i ==1
end

 p hash 
```

一切正常。，除了hash.store。，我想要的是“用hash_id将数据存储在散列中。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T00:22:48.097

我想也许你不想要一个散列：你不是试图将一个数据与另一个相关联。相反，也许您正在寻找一个集合。尝试：

```
require 'set'

s = Set.new

# Later
s << link.to_s 
```

或者更简单地说：

```
require 'set'
links = Set.new( @doc.xpath('//realestate').map(&:to_s) ) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T13:27:29.170

我不知道您的数据结构是什么，但这可以提供帮助：

```
> array = [[1, 'value1'], [2,'value2']]
=> [[1, "value1"], [2, "value2"], [2, "othervalue"]]
> hash = array.group_by { |e| e[0] }
=> {1=>[[1, "value1"]], 2=>[[2, "value2"], [2, "othervalue"]]} 
```

# c++ - basic_istream<>::tellg() 和 basic_ostream<>::tellp() 之间的区别

> ID：14522122
> 
> 赞同：15
> 
> 时间：2013-01-25T12:47:22.377
> 
> 标签：c++, filestream

我只是想知道为什么在类中定义和在类中定义的成员函数`tellg()`有`basic_istream<>`不同`tellp()`的`basic_ostream<>`名称。那是因为`basic_fstream<>`源自`basic_istream<>`and`basic_ostream<>`吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-25T12:51:36.113

`tellg()`获取指针的位置`get`并`tellp()`获取指针的位置`put`，其中一个是您读取的位置，第二个是您在文件中写入的位置。所以这两个函数做不同的事情并返回不同的值。为什么你认为他们应该有相同的名字？

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-01-25T13:48:30.687

你会如何在双向流中区分它们，比如`std::fstream`or `std::stringstream`？流被允许为输入和输出维护单独的指针：`fstream` 没有，但是`stringstream`有。因此，您需要一个标志来指示您想要哪一个（如 中的情况`streambuf`），或者您需要两个单独的函数。

# iphone - 如何将选定的行添加到 iPhone 中的 NSMutableArray

> ID：14522125
> 
> 赞同：0
> 
> 时间：2013-01-25T12:47:27.450
> 
> 标签：iphone, objective-c, uitableview, nsmutablearray

我正在尝试将选定的行添加到我的数组中。当我将第二个选定的行添加到 myArray 中时，第一个对象将替换为第二个对象，并且每次我在 myArray 中只获得一个对象时。这是我的表 didSelectAtIndexPath: 方法代码：

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
    if (cell.accessoryType == UITableViewCellAccessoryNone)        
    {
        cell.accessoryType = UITableViewCellAccessoryCheckmark; 
        myArray = [[NSMutableArray alloc] init];
        [myArray addObject:[Array1 objectAtIndex:indexPath.row]];
        NSLog(@"myArray %@",myArray);   
    }
} 
```

谁能帮我。提前致谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-25T12:49:27.153

问题是由这一行引起的：

```
myArray = [[NSMutableArray alloc] init]; 
```

每次用户单击单元格时，您都会分配此数组。

将其分配在您的`viewDidLoad`.

或在分配之前添加一个条件，例如：

```
if(myArray == nil)
{
    myArray = [[NSMutableArray alloc] init];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T12:52:12.137

```
-(void)viewDidLoad
{
   self.myArray = [[NSMutableArray alloc] init];
   self.Array1 = [[NSMutableArray alloc] init];
}

- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{

    [self.myArray  addObject:[self.Array1 objectAtIndex:indexPath.row]];
} 
```

# php - 我可以从 PHP 的 shell_exec() 输出中修剪开始和结束空格吗？

> ID：14522126
> 
> 赞同：0
> 
> 时间：2013-01-25T12:47:27.667
> 
> 标签：php, trim, shell-exec

我正在运行`shell_exec`（`git log`在此示例中）并且我的响应在字符串的开头和结尾有很多空格。

```
 7baca58 test 3
847ad88 test 3
bcd7340 Nother test
21a5f17 Testing git releases
8faa1c0 Add previously ignored files in attempt to push to server with git 
```

我已经尝试过`$string = preg_replace('/\s+/', ' ', $string);`，但这也删除了换行符。正常`trim`似乎也没有帮助。

我怎样才能删除前导和尾随空格？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T12:55:55.667

删除空格和制表符，应该保留换行符，试试看：

```
$string = preg_replace("/[ \t]+/", " ", $string); 
```

对于只有空格删除 \t

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T12:53:16.643

您的正则表达式`$string = preg_replace('/\s+/', '', $string);`将替换所有空格。要从字符串的开头和结尾修剪空格，请尝试[trim()](http://php.net/manual/en/function.trim.php)。如果您需要修剪字符串中的**所有行，请尝试**

```
$s = '';
foreach(explode("\n", $lines) as $line) {
    $s. = trim($line);
} 
```

# javascript - 使用 Google Calendar API v3 获取重复事件的下一个实例

> ID：14522128
> 
> 赞同：4
> 
> 时间：2013-01-25T12:47:31.710
> 
> 标签：javascript, google-calendar-api

我试图在我的日历中获取某个日期范围内的事件（单个或重复事件）。现在我不一定知道下一个重复事件实例的确切日期时间为 . 对于重复发生的事件，我想要下一次发生的日期而不是第一次发生的日期，因为我收到了下面的请求。我该怎么做呢？

[https://www.googleapis.com/calendar/v3/calendars/](https://www.googleapis.com/calendar/v3/calendars/) {calendarid}/events?fields=items(id,summary,start)&key={APIkey}&timeMax={enddate}&timeMin={startdate}

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-25T19:37:25.083

添加 URL 参数`singleEvents=True`。这会将所有重复发生的事件扩展到它们的单个项目中。如果您还不知道它是什么时候，则没有任何方法可以专门获取系列中的第二个事件，但是使用该参数可以让您解析所有实例并获得您想要的那个。

来源：[https ://developers.google.com/google-apps/calendar/v3/reference/events/list](https://developers.google.com/google-apps/calendar/v3/reference/events/list)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-08-18T03:28:57.017

```
long now = System.currentTimeMillis();

Uri.Builder eventsUriBuilder = CalendarContract.Instances.CONTENT_URI.buildUpon();
ContentUris.appendId(eventsUriBuilder, Long.MIN_VALUE);
ContentUris.appendId(eventsUriBuilder, Long.MAX_VALUE);
String[] projection = new String[]{CalendarContract.Instances.CALENDAR_ID, CalendarContract.Instances.TITLE,
        CalendarContract.Instances.DESCRIPTION, CalendarContract.Instances.BEGIN,
        CalendarContract.Instances.END, CalendarContract.Instances.EVENT_LOCATION,
        CalendarContract.Instances.EVENT_ID};

Uri eventsUri = eventsUriBuilder.build();
Cursor instance_cursor = getActivity().getContentResolver().query(
        eventsUri, projection, CalendarContract.Instances.BEGIN + " >= " + now + " and " + CalendarContract.Instances.BEGIN
                + " <= " + (now + 2592000000L) + " and " + CalendarContract.Instances.VISIBLE + " = 1",
        null, CalendarContract.Instances.DTSTART + " ASC"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-05-18T13:01:29.357

现在有直接的方法可以做到这一点，但您可以组合一种方法来实现这一点。

这个想法是您可以指定时间边界并限制记录数量，这足以完成这项工作。

因此，将设置`timeMin`为现在（或在您的参考事件结束日期之后）`timeMax`设置为足够大的数字，例如从 timeMin 和`maxResults`= 1 开始的一年，如果它存在，将获得下一个实例。

这是如何在 nodejs 中完成的：

```
 let startDate = startTime ? new Date(startTime) : new Date()
    let endDate = endTime ? new Date(endTime) : new Date(startDate.getTime() + 12 * 31 * 24 * 60 * 60 * 1000) // 1 year ahead
    let startDateISO = startDate.toISOString()
    let endDateISO = endDate.toISOString()

    let result = await  calendar.events.instances({
        calendarId: "primary",
        eventId: masterEventId,
        maxResults: 1,
        timeMin: startDateISO,
        timeMax: endDateISO,
        orderBy: "startTime",
        timeZone: "UTC"
    })
    let nextInstance = result.data.items[0] 
```

`timeMin`同样，如果您按降序排列结果并反转时间边界（设置为一年前和`timeMax`参考事件开始之前），您可以获得前一个实例。

# ruby - 动态 RSpec 规范生成

> ID：14522131
> 
> 赞同：10
> 
> 时间：2013-01-25T12:47:39.873
> 
> 标签：ruby, dynamic, rspec, specifications

我想根据外部数据源动态生成一系列规范。具体来说，我有一个已下载的 Google 电子表格，电子表格中的每一行都应用于自己的测试用例：

```
describe "Cases" do
  before(:all) do
    # Download spreadsheet and
    # populate cases in DB
  end

  Cases.each do |case|
    it "Case #{case.num}" do
      # spec
    end
  end
end 
```

这不起作用，因为对于使用 RSpec 的初学者来说，（据我了解）在编译时不会“看到”任何规范，因此`before(:all)`永远不会执行。如果我要放置一个空`it`块，它会`before(:all)`执行，但是我会遇到`Cases.each`在其他任何事情之前评估的问题，这是空的，因为它还没有被`before(:all)`块填充。

简而言之，我很困惑，我对 RSpec 的理解似乎很有限。我想获取数据，使用该数据设置一堆规范，然后让它们由 RSpec 运行。如果 Cases 是预先设置的数组（在 describe 块之外），这将（可能？）工作，但我需要在运行时设置它。我想在 RSpec 中做些什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-25T18:03:40.907

删除`before`块。

a 中的代码在`describe`加载 rspec 时执行。它的缺点是即使不运行这些规范，它也会下载并扫描工作表。

您将不得不处理的下一个问题是数据库在每个规范之后都会被清空。因此，您需要为下面创建的每个规范在 before 块中重新填充数据库。

我会强调我不会推荐这个，我会深入考虑动态拉取测试用例。考虑证明您的代码在没有外部数据的情况下可以正常工作的通用测试。或者提取电子表格的副本，将其保存`spec/assets`并加载，并针对该特定示例进行更直接的测试。

```
describe "Cases" do
  # Download spreadsheet and
  # populate cases in DB
  before(:each) do
    # repopulate the DB
  end

  Cases.each do |case|
    it "Case #{case.num}" do
      # spec
    end
  end

  # clean out the db so that the first executed test is not polluted
end 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-26T10:28:12.810

> 这不起作用，因为... RSpec 没有...在编译时“看到”任何规范...

我想知道为什么，并做了一些研究。如果您检查以下代码和输出，您可以得出一些结论：

*   Ruby 中没有编译时间
*   类/模块的主体被立即评估和执行
*   `describe`方法也是如此
*   块的主体`describe`由 RSpec 立即处理
*   RSpec 存储`before`块和`it`块以供以后执行
*   当文件解析终止时，RSpec 开始报告 `describe`字符串并执行存储的`before/it`示例块

下面的代码演示了这一点。

```
module SO
    puts '>>>>> Ruby sees module SO and executes/evaluates its body'
    cases = [1,2,3]

    describe "SO Cases" do
        puts "in module SO, RSpec sees describe Cases self=#{self}"
        before(:each) do
            puts '  in before(:all)'
        end

        cases.each do |case_|
            puts "    in each loop with case_=#{case_}"
            it "Case #{case_}" do
                puts "        check spec for case #{case_}"
            end
        end
    end
end

module M # to avoid "warning: class variable access from toplevel"
    puts '>>>>> Ruby sees module M and executes/evaluates its body'
    describe "M Cases" do
        puts "in module M, RSpec sees describe Cases self=#{self}, ancestors :"
        ancestors.each {|a| puts "    #{a}"}
        print 'self.methods.grep(/^it/) : '; p self.methods.grep(/^it/).sort
        before(:all) do
            puts "  in before(:all) self=#{self}"
            @@cases = [1,2,3]
            puts "  ... now cases=#{@@cases}"
            File.open('generated_cases.rb', 'w') do |fgen|
                fgen.puts 'puts "\n*** inside generated_cases.rb ***"'
                fgen.puts 'module GenSpecs'
                fgen.puts "puts '>>>>> Ruby sees module GenSpecs and executes/evaluates its body'"
                fgen.puts '    describe "GenSpecs Cases" do'
                fgen.puts '        puts "in module GenSpecs, RSpec sees describe Cases"'
                @@cases.each do |case_|
                    puts "    in each loop with case_=#{case_}"
                    fgen.puts <<-IT_SPECS
        it "Case #{case_}" do
            puts "    some spec for case_=#{case_}"
        end
        IT_SPECS
                end
                fgen.puts '    end'
                fgen.puts 'end # module GenSpecs'
                fgen.puts "puts '>>>>> end of ruby file generated_cases.rb <<<<<'"
            end
            puts 'file generated_cases.rb has been closed'
            require_relative 'generated_cases'
        end

        it 'has loaded Cases' do
            @@cases.should_not be_empty
        end
    end
end
puts '>>>>> end of ruby file t2_spec.rb <<<<<' 
```

执行 ：

```
$ ruby -v
ruby 1.9.2p320 (2012-04-20 revision 35421) [x86_64-darwin12.2.0]
$ rspec --version
2.12.2
$ rspec --format nested t2_spec.rb 
>>>>> Ruby sees module SO and executes/evaluates its body
in module SO, RSpec sees describe Cases self=#<Class:0x007fcaf49a6e80>
    in each loop with case_=1
    in each loop with case_=2
    in each loop with case_=3
>>>>> Ruby sees module M and executes/evaluates its body
in module M, RSpec sees describe Cases self=#<Class:0x007fcaf2852e28>, ancestors :
    #<Class:0x007fcaf2852e28>
    RSpec::Core::ExampleGroup
    ...
self.methods.grep(/^it/) : [:it, :it_behaves_like, :it_should_behave_like, :its]
>>>>> end of ruby file t2_spec.rb <<<<<

SO Cases
  in before(:all)
        check spec for case 1
  Case 1
  in before(:all)
        check spec for case 2
  Case 2
  in before(:all)
        check spec for case 3
  Case 3

M Cases
  in before(:all) self=#<RSpec::Core::ExampleGroup::Nested_2:0x007fcaf2836ca0>
  ... now cases=[1, 2, 3]
    in each loop with case_=1
    in each loop with case_=2
    in each loop with case_=3
file generated_cases.rb has been closed

*** inside generated_cases.rb ***
>>>>> Ruby sees module GenSpecs and executes/evaluates its body
in module GenSpecs, RSpec sees describe Cases
>>>>> end of ruby file generated_cases.rb <<<<<
  has loaded Cases

GenSpecs Cases
    some spec for case_=1
  Case 1
    some spec for case_=2
  Case 2
    some spec for case_=3
  Case 3

Finished in 0.01699 seconds
7 examples, 0 failures 
```

创建一个文件并以这种方式要求它是为了演示，可能不适用于您的情况。我建议分两个阶段进行：首先阅读电子表格并创建一个包含 a`describe`和几个`it`示例的 file.rb。在第二阶段，您启动 Ruby 来处理生成的文件。

# wpf - 作为 ListBoxItem 的扩展器不会触发选择

> ID：14522135
> 
> 赞同：20
> 
> 时间：2013-01-25T12:47:55.960
> 
> 标签：wpf, xaml

我有一个使用`ListBox`a`ListBoxItem`作为其容器的方法。问题是这似乎正在消耗事件（确切地说是部分事件），如果我点击我永远不会得到（但如果你点击它本身它会起作用）。`DataTemplate``Expander``Expander``Click``HeaderSite``Expander``SelectedItem``Expander``ListBoxItem`

关于如何`Expander`玩得很好的任何想法`ListBox`？

这是一个简化的 Xaml，它将重现问题（不需要后面的代码）：

**编辑**代码已更新以更接近我的实际模板，但屏幕截图仍然来自以前的修订版（问题相同 - 这只是为了澄清第一个答案的问题）

```
<Window x:Class="ListBoxSample.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="MainWindow" Height="350" Width="525">
    <StackPanel>
        <TextBlock>
            <Run Text="Selected Item" />
            <Run Text="{Binding ElementName=ListBox, Path=SelectedItem}" />
        </TextBlock>
        <ListBox x:Name="ListBox">
            <ListBoxItem>
                <Expander Header="Expandable Stuff 1">
                    <ListBox>
                        <ListBoxItem>1.1</ListBoxItem>
                        <ListBoxItem>1.2</ListBoxItem>
                    </ListBox>
                </Expander>
            </ListBoxItem>
            <ListBoxItem>
                <Expander Header="Expandable Stuff 2">
                    <ListBox>
                        <ListBoxItem>2.1</ListBoxItem>
                        <ListBoxItem>2.2</ListBoxItem>
                    </ListBox>
                </Expander>
            </ListBoxItem>
        </ListBox>
    </StackPanel>
</Window> 
```

**截图是预先编辑的**

单击`ListBoxItem`结果 a `SelectedItem`：

![点击 <code>ListBoxItem</code> 得到一个 <code>SelectedItem</code>](../Images/96059faa89822937d75209f7ec9070b5.png)

单击 Expander 导致**没有** `SelectedItem`更新（单击是在 Expander 1 上，如虚线轮廓所示）：

![单击 Expander 导致没有 <code>SelectedItem</code> 更新](../Images/74f3f7302bf0ed2550e2d6327742125e.png)

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-25T13:27:14.093

没有代码，你可以做到这一点

```
<ListBox.ItemContainerStyle>
    <Style>
        <Style.Triggers>
            <EventTrigger RoutedEvent="Control.PreviewMouseLeftButtonDown">
                <BeginStoryboard>
                    <Storyboard Storyboard.TargetProperty="(Selector.IsSelected)">
                        <BooleanAnimationUsingKeyFrames Duration="0:0:0">
                            <DiscreteBooleanKeyFrame Value="True" />
                        </BooleanAnimationUsingKeyFrames>
                    </Storyboard>
                </BeginStoryboard>
            </EventTrigger>
        </Style.Triggers>
    </Style>
</ListBox.ItemContainerStyle> 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-01-25T13:04:44.563

那么下面的代码似乎与缺点（或者可能是优点）一起工作，每次只有选定的项目会被扩展。

将以下 2 个属性应用于您的 2 `Expander`s

```
IsHitTestVisible="{Binding RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=ListBoxItem}, Path=IsSelected}"
IsExpanded="{Binding RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=ListBoxItem}, Path=IsSelected}" 
```

通过绑定`IsHitTestVisible`，它还允许与包含在 中的元素`Expander`进行交互。

导致：

```
 <ListBox x:Name="ListBox" IsSynchronizedWithCurrentItem="True">
                <ListBoxItem>
                    <Expander Header="Expandable Stuff 1" IsHitTestVisible="{Binding RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=ListBoxItem}, Path=IsSelected}" IsExpanded="{Binding RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=ListBoxItem}, Path=IsSelected}">
                        1
                    </Expander>
                </ListBoxItem>
                <ListBoxItem>
            <Expander Header="Expandable Stuff 2" IsHitTestVisible="{Binding RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=ListBoxItem}, Path=IsSelected}" IsExpanded="{Binding RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=ListBoxItem}, Path=IsSelected}">
                        2
                    </Expander>
                </ListBoxItem>
            </ListBox> 
```

另一个带有代码的解决方案是这样的：

```
 <ListBox x:Name="ListBox" IsSynchronizedWithCurrentItem="True">
                <ListBoxItem>
                    <Expander Header="Expandable Stuff 1" IsHitTestVisible="False" IsExpanded="{Binding RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=ListBoxItem}, Path=IsSelected}">
                <StackPanel IsHitTestVisible="True">
                    <Label Content="1"/>
                </StackPanel>
            </Expander>
                </ListBoxItem>
                <ListBoxItem>
            <Expander Header="Expandable Stuff 2" ButtonBase.Click="Expander_Click_1" Tag="{Binding  RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=ListBoxItem}}">
                2                     
            </Expander>
                </ListBoxItem>
            </ListBox> 
```

和后面的代码：

```
 private void Expander_Click_1(object sender, RoutedEventArgs e)
    {
        if (sender is Expander)
        {
            Expander senderExp = (Expander)sender;
            object obj = senderExp.Tag;
            if (obj is ListBoxItem)
            {
                ((ListBoxItem)obj).IsSelected = true;
            }
        }            
    } 
```

# asp.net - 3.5 的实际版本号是多少？

> ID：14522137
> 
> 赞同：0
> 
> 时间：2013-01-25T12:48:01.683
> 
> 标签：asp.net

一位客户希望我将他们的网站编译为早期版本的 .net。

对于我的 web.config 类型的版本，3.5 的实际语法是什么？肯定不是 3.5.0.0 吗？或者我可以删除版本吗？

代码：

```
...
        <httpRuntime requestValidationMode="2.0" />
        <pages validateRequest="false" />
        <compilation debug="true" targetFramework="4.0" />
        <authentication mode="Forms">
            <forms loginUrl="index.aspx" defaultUrl="login.aspx" timeout="1440" />
        </authentication>
        <membership>
            <providers>
                <clear />
                <add name="AspNetSqlMembershipProvider" type="System.Web.Security.SqlMembershipProvider, System.Web, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a" connectionStringName="AspnetdbConnString" enablePasswordRetrieval="false" enablePasswordReset="true" requiresQuestionAndAnswer="true" applicationName="/" requiresUniqueEmail="false" passwordFormat="Hashed" maxInvalidPasswordAttempts="5" minRequiredPasswordLength="7" minRequiredNonalphanumericCharacters="1" passwordAttemptWindow="10" passwordStrengthRegularExpression=""/>
            </providers>
        </membership>
        <profile>
            <providers>
                <clear />
                <add name="AspNetSqlProfileProvider" connectionStringName="AspnetdbConnString" applicationName="/" type="System.Web.Profile.SqlProfileProvider, System.Web, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a"/>
            </providers>
        </profile>
        <roleManager enabled="true">
            <providers>
                <clear />
                <add name="AspNetSqlRoleProvider" connectionStringName="AspnetdbConnString" applicationName="/" type="System.Web.Security.SqlRoleProvider, System.Web, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a"/>
                <add name="AspNetWindowsTokenRoleProvider" applicationName="/" type="System.Web.Security.WindowsTokenRoleProvider, System.Web, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a"/>
            </providers>
        </roleManager>
    </system.web>
    <location path="Management">
        <system.web>
            <authorization>
                <allow roles="Managers"/>
                <deny users="*" />
            </authorization>
        </system.web>
    </location>
... 
```

敬茶

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T14:26:42.967

我相信通过视觉工作室最容易做到这一点

1.  打开要更改的项目。

2.  在解决方案资源管理器工具栏中，选择属性按钮。

3.  您还可以在解决方案资源管理器中选择项目节点，打开上下文菜单（通过右键单击节点），然后选择属性。

4.  您应该在“应用程序”选项卡上看到设置。如果没有，请选择它。

5.  在“目标框架”下拉列表中，选择所需的 .NET Framework 版本。然后单击确定按钮。

另外请记住，您希望更改对您当前在项目中获得的任何 4.0 dll 的引用。

参考：http: [//msdn.microsoft.com/en-us/library/vstudio/bb398202.aspx](http://msdn.microsoft.com/en-us/library/vstudio/bb398202.aspx)

# automation - 我怎样才能说出常规语言？

> ID：14522143
> 
> 赞同：-1
> 
> 时间：2013-01-25T12:48:29.647
> 
> 标签：automation, regular-language, dfa, nfa, pumping-lemma

众所周知，使用抽引引理，我们可以很容易地证明语言**L = {WW|W ∈ {a,b}*}**不是正则语言。

然而，语言，L1 = {W1W2| |W1| = |W2|} 是一种常规语言。因为我们可以像下面这样得到 DFA， ![在此处输入图像描述](../Images/6ae060f54ff99817384fad664981a69e.png)

我的问题是，**L = {WW|W ∈ {a,b}*}**也有偶数长度的字符串（|w|=|w|，绝对），L 仍然可以有一些像上面那样的 dfa。怎么不是普通语言？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T06:31:43.147

您误解了语言`ww`，而语言`DFA`是 L1：

**[问题]**：

*   `L ={ ww| w = w}`是正则语言`(RL)`。因为我们可以得到`DFA`像下面这样是可能的。

    ```
    DFA:  L1 ={ w1w2| |w1| = |w2|, where w1 , w2 ∈ {a, b}* } 

    --►((even))------a,b---------►(odd)  
          ▲                         |  
          |--------a,b--------------| 
    ```

**[怀疑]**

> 什么是**L** ={ ww | w ∈ {a, b}* } 是哪里？

L 是由偶数长度字符串组成的`a`，`b`即有一些前缀子字符串等于后缀子字符串。一些例子`L`是`{ aa, bb, abab, aaaa, bbbb, abaaba, abbabb, .....}`

> **DFA**或 L1的语言是什么 ={ w1w2| |w1| = |w2|，其中 w1 , w2 ∈ {a, b}* } ？

所有偶数长度的`a`字符串都由`b`例如`L1``{ab, ba, aabb, baab, ab, aa, bb, ababa, baba, abbba, ...}`

*注意：* 所有偶数长度的字符串都包含`a`并且`b`不在`L`例如`{ab, ba, aabb, baab, ab}`，但是这个字符串在`DFA`'s language = L1\.

所以，`L(DFA)=L1 != L`

**[疑问-1]**

> `L`和之间的关系`L(DFA)=L1`？

正如我在*注释*中所写的，`L ⊆ L(DFA)`因此属于`L`DFA 语言元素的每个字符串都接受了您`DFA`。（*这是你的困惑*）

此外，语言`L ={ ww| |w| = |w| }` 不是常规语言。我们不能`DFA`为这种语言绘图。两种语言都不一样！`(L != L1)`

`L`那时受到很大限制`L(DFA)`

`L`=`{ WW|W }`不规则可以使用抽引引理证明。

[`L`甚至不是上下文无关语言，而是上下文相关语言]

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T04:14:15.053

我在 cs.stackexchange 中发布了这个主题，Ran 为我提供了答案。[https://cs.stackexchange.com/questions/9175/how-come-ww-isnt-regular-when-uv-uv-is](https://cs.stackexchange.com/questions/9175/how-come-ww-isnt-regular-when-uv-u-v-is)

两种语言的主要区别是第一种语言不需要记住它的内容仅仅计算长度就足够了，而第二种语言需要分析 w 和 w 是否相同。

谢谢@Ran、@Grijesh 和@dema80 :-)

# c# - 使用 ASP.NET MVC Web API 时如何注册已知类型以进行序列化

> ID：14522144
> 
> 赞同：7
> 
> 时间：2013-01-25T12:48:37.447
> 
> 标签：c#, asp.net-mvc, asp.net-web-api, datacontractserializer

我有一个返回的 ASP.NET MVC Web API 控制器`public IEnumerable<IMessage> Get()`

它抛出异常，我需要注册从`IMessage`传递给的已知类型集合中派生的类型`DataContractSerializer`。

如何注册“已知类型”以便在 MVC Web API 项目中使用`DataContractSerializer`和使用？`DataContractJSONSerializer`

*KnownType 属性不能放在接口上。*

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-25T13:06:51.490

你需要把`KnownTypeAttribute`你的`IMessage`实现：

```
public interface  IMessage
{
    string Content { get; }
}

[KnownType(typeof(Message))]
public class Message : IMessage {
    public string Content{ get; set; }
}

[KnownType(typeof(Message2))]
public class Message2 : IMessage
{
    public string Content { get; set; }
} 
```

因此，当调用以下操作时：

```
 public IEnumerable<IMessage> Get()
 {
     return new IMessage[] { new Message { Content = "value1" }, 
                             new Message2 { Content = "value2" } };
 } 
```

结果将是这样的：

```
<ArrayOfanyType xmlns:i="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://schemas.microsoft.com/2003/10/Serialization/Arrays">
    <anyType xmlns:d2p1="http://schemas.datacontract.org/2004/07/MvcApplication3.Controllers" i:type="d2p1:Message">
        <d2p1:Content>value1</d2p1:Content>
    </anyType>
    <anyType xmlns:d2p1="http://schemas.datacontract.org/2004/07/MvcApplication3.Controllers" i:type="d2p1:Message2">
       <d2p1:Content>value2</d2p1:Content>
    </anyType>
</ArrayOfanyType> 
```

但这只会以一种“方式”起作用。因此，您不能回发相同的 XML。

为了以下操作应该起作用：

```
public string Post(IEnumerable<IMessage> messages) 
```

您需要全局注册已知类型，`DataContractSerializer`并在`GlobalConfiguration.Configuration.Formatters`

```
GlobalConfiguration.Configuration
                   .Formatters
                   .XmlFormatter.SetSerializer<IEnumerable<IMessage>>(
                       new DataContractSerializer(typeof(IEnumerable<IMessage>), 
                           new[] { typeof(Message), typeof(Message2) })); 
```

使用配置，您不需要`KnownTypeAttribute`实现类型。

# java - Apache Avro ThreadLocal 对象在 Tomcat 取消部署时徘徊

> ID：14522161
> 
> 赞同：5
> 
> 时间：2013-01-25T12:49:43.330
> 
> 标签：java, tomcat, avro

我们使用 Apache Avro 作为 Python 应用程序和我们在 Tomcat 服务中运行的一些第三方 Java 库之间的 JSON 接口。我们决定简单地扩展 org.apache.avro.ipc.ResponderServlet 类来实现我们自己的 servlet。servlet 非常简单，因为它在构造函数中实例化了 ResponderServlet 超类，并重写了 init() 和 destroy() 方法来为我们在 servlet 中运行的第三方库做一些内务处理。

然而，当 Tomcat 取消部署我们的 web 应用程序时，我们会看到许多严重错误警告，警告 ThreadLocal 相关的内存泄漏。

```
SEVERE: The web application [/hotwire] created a ThreadLocal with key of type [org.apache.avro.Schema$3] (value [org.apache.avro.Schema$3@4464784f]) and a value of type [java.lang.Boolean] (value [true]) but failed to remove it when the web application was stopped. Threads are going to be renewed over time to try and avoid a probable memory leak.
Jan 24, 2013 2:19:36 AM org.apache.catalina.loader.WebappClassLoader checkThreadLocalMapForLeaks
SEVERE: The web application [/hotwire] created a ThreadLocal with key of type [org.apache.avro.generic.GenericDatumReader$1] (value [org.apache.avro.generic.GenericDatumReader$1@2016ad9d]) and a value of type [org.apache.avro.util.WeakIdentityHashMap] (value [org.apache.avro.util.WeakIdentityHashMap@30e02ee0]) but failed to remove it when the web application was stopped. Threads are going to be renewed over time to try and avoid a probable memory leak. 
```

我们可能在某处做一些幼稚的事情，因为我们无法在网络上的任何地方为这种情况找到任何帮助。尽管如此，我们希望这里有人能告诉我们哪里出了问题。

这是对我们的 servlet 的一瞥。

```
public class HotWire extends ResponderServlet{
    public HotWire() throws IOException
    {
              super(new SpecificResponder(Engine.class, new EngineImpl()));
    }

    @Override
        public void init() {
        try {
         super.init();
                 try {
                      init_engine();                
                      } catch (EngineInitException e) {
                      e.printStackTrace();
                      }
            } catch (ServletException e) {
                 e.printStackTrace();
            }
        }

        @Override
        public void destroy() {
            super.destroy();
            shutdown_engine();
        }

        public static class EngineImpl implements EngineInterface  {
            public Boolean create(Parameters message) {
                Boolean status = null;
                try {
                    status = engine.create_object(message);
                } catch (SemanticException | IOException e) {
                    e.printStackTrace();
                }
                return status;
            }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2019-04-23T22:21:46.020

我看到了类似的问题。如果你看这里有一个静态 ThreadLocal 缓存被填满，无法删除它：

[https://github.com/apache/avro/blob/master/lang/java/avro/src/main/java/org/apache/avro/generic/GenericDatumReader.java#L106](https://github.com/apache/avro/blob/master/lang/java/avro/src/main/java/org/apache/avro/generic/GenericDatumReader.java#L106)

```
 private static final ThreadLocal<Map<Schema, Map<Schema, ResolvingDecoder>>> RESOLVER_CACHE = ThreadLocal
      .withInitial(WeakIdentityHashMap::new); 
```

在我的例子中，每个请求都有不同的模式，所以我的 Spring Boot 服务最终会耗尽内存并死掉。

这也是类加载器泄漏的一个例子： [ThreadLocal & Memory Leak](https://stackoverflow.com/questions/17968803/threadlocal-memory-leak)

我可以在这里看到 JIRA 请求进行**改进**： [https ://issues.apache.org/jira/browse/AVRO-1595](https://issues.apache.org/jira/browse/AVRO-1595)

更新：我能够解决内存泄漏的问题。有一个 ExecutorService 正在重用线程。现在我关闭了导致线程完成的服务。这允许对 ThreadLocal 内存进行 GC。

正如有人指出的那样，RESOLVER_CACHE 使用了 WeakIdentityHashMap，它应该允许缓存被 GC 处理，但这对我来说并没有发生。

# c# - sqlite 的 oledb 提供程序

> ID：14522164
> 
> 赞同：3
> 
> 时间：2013-01-25T12:49:55.577
> 
> 标签：c#, .net, sqlite, oledb

我在 .net (c#) 中使用 sqlite3 时遇到问题。我找不到适合 sqlite 的 oledb 提供程序。我找到了一个（[http://cherrycitysoftware.com/ccs/Providers/ProvSQLite.aspx](http://cherrycitysoftware.com/ccs/Providers/ProvSQLite.aspx)），但在这里您必须等待几周才能激活它（至少要获得免费激活）。

.net 中是否还有其他用于 sqlite 的 oledb 提供程序？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-01-18T16:04:01.480

有些人似乎混淆了 ADO.NET 驱动程序和 OLEDB 提供程序。这个[32Bit OLEDB-Provider](https://github.com/mobileFX/SQLiteOLEDB)为我工作

# asp.net - asp.net + ImageButton 带有不需要的边框

> ID：14522165
> 
> 赞同：1
> 
> 时间：2013-01-25T12:50:02.853
> 
> 标签：asp.net, css

我有一个 asp.net ImageButton，周围有一个不需要的边框。BorderStyle 已设置为无。我也试过 Border-Width:0 没有成功。我偶然发现了这个链接：

[http://weblogs.asp.net/reganschroder/archive/2008/01/22/remove-border-width-0px-from-asp-image-or-asp-imagebutton.aspx](http://weblogs.asp.net/reganschroder/archive/2008/01/22/remove-border-width-0px-from-asp-image-or-asp-imagebutton.aspx)

显然也无济于事。有人可以帮忙。谢谢。

```
<div class="squareButtonFrame "><asp:ImageButton ID="imgDelete" runat="server" CssClass="imgButtonImg imgDelete" BorderStyle="none" CommandName="Delete"/></div>

.squareButtonFrame /* This is the square frame which already has a border */
{
    margin-top: 3px;
    padding-bottom: 3px;
    display:inline-block; 
    height:32px; 
    width:35px; 
    border: thin solid #E1E1E1; 
    background-color: #FCFCFC;
    text-align:center;
    cursor:pointer
}

.imgButtonImg 
{
    margin: 0; 
    padding: 0;
    display:inline-block;
    height: 35px;
    width: 35px;
 } 

.imgDelete 
{
  background: url('/Images/Delete.png')  no-repeat center center;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T13:35:25.063

这应该有一个技巧：

```
.imgButtonImg 
{
    margin: 0; 
    padding: 0;
    display:inline-block;
    height: 35px;
    width: 35px;
    border: 0; // note this line
 } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T14:24:28.397

我猜这个问题是由于没有设置 ImageUrl。我实际上是在使用 CSS 来设置背景。

# c++ - std::vector 的缓存行为

> ID：14522166
> 
> 赞同：1
> 
> 时间：2013-01-25T12:50:08.923
> 
> 标签：c++

我的问题很简单，给定以下数据结构`std::vector<std::pair<int, std::unique_ptr<foo>>>`，如果我有以下内容：

```
auto it = std::find_if(begin(v), end(v), [&](std::pair<...> const& p){ return p.first == some_value; }); 
```

我可以期望指针指向的任何内容都不会被提取（我不希望它被提取，稍后会根据需要预提取）到缓存中纯粹用于查找操作吗？或者这是不可能确定的（如果是这样，我会结束这个问题..）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T13:05:01.770

当“查找”在向量中搜索时，它将查看向量中条目的值，并将其与您正在搜索的内容相匹配。因此，它将使用 find 提供的任何“equal”函数，如果没有提供 find 函数，则使用“operator==”。

由于在这种情况下，您只是将对中的 int 值与您的预期值进行比较， `unique_ptr<foo>`因此不会取消引用（因此指向的数据`unique_ptr<foo>`不会进入缓存）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T13:09:52.790

严格来说你不...现在我看不出为什么这个循环应该从存储的指针中预取smth。从机器的角度来看，您已经迭代了一个充满整数和指针的连续内存块，其中只有整数被访问......没有理由预取指针内容......但是，也许稍后在你的代码中（非常接近`find_if`）有另一个循环会取消引用该指针，所以该死的智能编译器可以决定在第一个循环中插入一个 fetch 指令（这`find_if`无论如何都不会影响，所以它可以！）......我们不知道 - 它是编译器 +优化选项+架构取决于......我们甚至不知道下一个英特尔的 BlahBlahBridge 不会在没有任何编译器指令的情况下做到这一点......

# wpf - “System.Windows.Controls.Button”类型中的方法“get_Command”未实现

> ID：14522170
> 
> 赞同：4
> 
> 时间：2013-01-25T12:50:25.023
> 
> 标签：wpf, powerbuilder, powerbuilder.net

我正在尝试在 powerbuilder .net 12.5 中开发应用程序。但是我不断收到以下编译错误。

```
Unknown build error, 'Method 'get_Command' in type 'System.Windows.Controls.Button' 
from     assembly 'PresentationFramework, Version=4.0.0.0, Culture=neutral,    
PublicKeyToken=31bf3856ad364e35' does not have an implementation. Line 3 Position 4.' 
```

该应用程序非常简单。这是一个带有显示消息框的按钮的单个 wpf 窗口。我在不同的测试应用程序中遇到过这个错误，但我看不出是什么导致了这个问题。

我在网上发现其他人也有同样的问题，但他们似乎都使用 .net 4.5。和 Windows 8。似乎编译器使用了错误的 .net 版本。但是我没有.net 4.5

如果有人能指出我正确的方向，那就太好了

编辑：

我发现了一些额外的信息。我的解决方案中有两个目标。一个 .net 程序集目标和一个 wpf 目标。在我将 wpf 目标中的引用添加到我的 .net 程序集目标之前，一切正常。然后发生此错误。从参考列表中删除程序集并不能解决问题

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-28T13:36:07.833

我找到了解决方案。当您在 powerbuilder 目标中引用 DLL 时，它会将 presentationcore.dll 引用更改为 gac 中的引用。这个 dll 不是正确的版本（至少在我的电脑上不是。）通过使用记事本（++）编辑项目，我将路径更改为原始的presentationcore.dll，现在它再次编译。

# apache - httpd.exe 应用程序错误

> ID：14522171
> 
> 赞同：2
> 
> 时间：2013-01-25T12:50:24.977
> 
> 标签：apache

尝试通过 Wamp Server 安装 Apache 服务时，出现以下错误：

httpd.exe - 应用程序错误 应用程序无法正确启动 (0xc000007b)。单击确定关闭应用程序。

80 端口实际上并未被使用。

我在 Windows 7 机器上运行它。我已经尝试卸载它，删除文件夹和注册表项，但错误仍然存​​在。

任何帮助将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T18:38:21.810

即使您有 64 位 Windows 7，也请尝试安装 wampserver（32 位和 php 5.3）2.2E。我遇到了同样的问题。尝试了一切。但最终这奏效了。我安装了 64 位 Windows 7。

# ios - UITextview - UIKeyboard 关闭

> ID：14522176
> 
> 赞同：1
> 
> 时间：2013-01-25T12:50:44.807
> 
> 标签：ios, uitextview, uikeyboard

当我进入时，我必须关闭`UIKeyboard`输入“完成”按钮`UITextView`。

注意：我用`UITextView`. 它工作正常，我想在 UITextview 中实现相同的概念。我试过了

```
- (BOOL)textView:(UITextView *)textView shouldChangeTextInRange:(NSRange)range replacementText:(NSString *)text 
```

方法，但这有问题。

这可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-01-14T01:12:43.460

**迅速：**

```
func textView(textView: UITextView, shouldChangeTextInRange range: NSRange, replacementText text: String) -> Bool {
    if text == "\n" {
        theTextView.resignFirstResponder()
        return false
    }
    return true
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-25T12:53:45.117

UITextView 没有完成按钮的选项，因为它需要有返回按钮。您可以按下返回按钮，但实际上并不推荐。编辑 UITextView 时关闭键盘的推荐方法是在主视图或其他元素上点击手势识别器。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-25T13:03:01.303

**使用以下代码，可能对您有用:)**

```
- (BOOL)textView:(UITextView *)textView shouldChangeTextInRange:(NSRange)range replacementText:(NSString *)text 
{

        if([text isEqualToString:@"\n"]) 
        {
            [textView resignFirstResponder];
            return NO;
        }

        return YES;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-25T13:20:08.457

Ivan Alek 是对的，`UITextView`需要返回按钮才能将光标移动到下一行。您可以在键盘上添加视图并从按钮关闭键盘。像这样：

```
UIToolbar       *toolbar    = [[[UIToolbar       alloc] initWithFrame:CGRectMake(0, 0, screenWidth, 30)] autorelease];
UIBarButtonItem *item2      = [[[UIBarButtonItem alloc] initWithBarButtonSystemItem:UIBarButtonSystemItemDone target:self action:@selector(closeKeyboard)] autorelease];
UIBarButtonItem *item1      = [[[UIBarButtonItem alloc] initWithBarButtonSystemItem:UIBarButtonSystemItemFlexibleSpace target:nil action:nil] autorelease];

[toolbar setItems:[NSArray arrayWithObjects:item1 , item2, nil]];
[textView setInputAccessoryView:toolbar]; 
```

然后在该`closeKeyboard`方法中，您可以辞去第一响应者的职务。

希望这可以帮助。

干杯!

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-25T13:18:45.563

在键盘的辅助视图上添加完成按钮并实现完成方法

```
 [textView resignFirstResponder]; 
```

并且不要忘记为 textView 设置委托。

# codeigniter - CI 不创建会话

> ID：14522177
> 
> 赞同：0
> 
> 时间：2013-01-25T12:50:53.963
> 
> 标签：codeigniter

大家好，你认为为什么会这样？

```
$veri = array("uye_kadi" => $this->input->post('kadi'), 'oturum' => TRUE);
$this->session->set_userdata($veri); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T12:55:08.033

首先确保您已包含会话库

来自自动加载配置文件：

```
 $autoload['libraries'] = array('session'); 
```

或来自控制器：

```
 $this->load->library('session'); 
```

然后将您的代码替换为：

```
 $veri = array("uye_kadi" => $this->input->post('kadi'), 'oturum' => TRUE);
 $this->session->set_userdata('sess_var_name',$veri);

 echo $this->session->userdata('sess_var_name'); 
```

数组 with 可以用作：

```
 $ar = array('user_id'=>900,
        'username'=>'John Doe');

 $this->session->set_userdata('user_details',$ar);

 $this->session->userdata('user_details','user_id'); //Return 900; 
```

希望它会有所帮助！

# node.js - nodejs在mongodb中获取查找结果

> ID：14522178
> 
> 赞同：2
> 
> 时间：2013-01-25T12:51:01.163
> 
> 标签：node.js, mongodb

我正在尝试获取查询结果，但我在所有变量中都获得了相同的信息：db、collection 和 res：

```
var mongodb = require("mongodb");
var mongoserver = new mongodb.Server("localhost", 27017);
var instance = new mongodb.Db("test", mongoserver);

instance.open(function(err, db)
{
  console.log('db:');
  console.log(db);
  db.collection('kurtsoa', function(err, collection)
  {
    console.log('collection:');
    console.log(collection);
    collection.find({}, function(err, res)
    {
      console.log('res:');
      console.log(res);
    });
  });
}); 
```

我怎样才能得到“查找”的结果？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-01-25T13:01:46.013

[`.find()`](https://github.com/mongodb/node-mongodb-native#find)将返回一个[Cursor](https://github.com/mongodb/node-mongodb-native/blob/master/lib/mongodb/cursor.js)对象供您使用。如果您感兴趣的只是将所有结果放在一个数组中，您可以这样做：

```
collection.find().toArray(function(err, docs) {
    console.log(docs);
}); 
```

但您也可以迭代游标：

```
collection.find().each(function(err, doc) {
    //called once for each doc returned
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-25T12:55:39.507

你可以使用这个：

```
 collection.find().toArray(function(err, docs){
                console.log(docs);
    )}; 
```

# c# - Html.Editor用于丢失数据

> ID：14522182
> 
> 赞同：1
> 
> 时间：2013-01-25T12:51:03.977
> 
> 标签：c#, asp.net-mvc-3

我目前正在处理一个大型项目，该项目有一个包含 TimesheetEntries 列表的 Timesheet 类。有一个编辑页面，如下所示：

```
<!-- Other timesheet properties -->
@Html.EditorFor(model => model.TimesheetEntries) 
```

这很好用，我为每个时间表条目获得一行。当我保存时间表（POST 到服务器）时，自定义模型绑定器会在将时间表传递给控制器​​之前删除空行，换句话说，时间表可以包含比 POST 数据更少的行。

如果出现验证错误，我会重新显示编辑页面，这就是问题出现的地方。

如果`model.TimesheetEntries`包含`n`记录从 POST 数据中`Html.EditorFor()`复制第一`n`行（包括空行），而不是为我传递的数据创建 HTML！这意味着我在表格底部丢失了许多行，这显然是不需要的。

谁能解释为什么会发生这种情况，或者更好地告诉我如何让 EditorFor 按我的预期工作？

这是一张图片来描述这个过程：

![时间表流程](../Images/509311df03386a7a6bc0d93ea8650a4e.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T13:10:52.597

您可能想看看这篇文章中提供的答案[Asp:net MVC 3: @Html.EditorFor a subcollection of my model in a template?](https://stackoverflow.com/questions/9125809/aspnet-mvc-3-html-editorfor-a-subcollection-of-my-model-in-a-template) 它可能会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-28T15:15:30.013

结果是 Html.EditorFor 在使用您传递的值之前先在 ModelState 中查找......所以为了让它获取我传递的值，我需要先从 ModelState 中清除相关的值，呃。

[这个](https://stackoverflow.com/questions/7414351/mvc-3-html-editorfor-seems-to-cache-old-values-after-ajax-call)问题/答案更详细地介绍了它。

# sql - 将 3 个步骤组合成一个 SQL 脚本

> ID：14522191
> 
> 赞同：2
> 
> 时间：2013-01-25T12:51:36.673
> 
> 标签：sql, database, oracle

我对 SQL 很陌生，所以很容易回答我的问题。

这是我想做的事情：

1.  停用约束：

    停用数据库中的约束：

    ```
    begin
        for cur in (select fk.owner, fk.constraint_name , fk.table_name 
               from all_constraints fk, all_constraints pk 
               where fk.CONSTRAINT_TYPE = 'R' and 
                     pk.owner = 'USER1' and
                     fk.R_CONSTRAINT_NAME = pk.CONSTRAINT_NAME ) loop
            execute immediate 'ALTER TABLE '||cur.owner||'.'||cur.table_name||' MODIFY CONSTRAINT '||cur.constraint_name||' DISABLE';
        end loop;
    end; 
    ```

2.  从表中删除：

    ```
    delete from USER_TEST.Table1;                
    delete from USER_TEST.Table2;               
    delete from USER_TEST.Table3; 
    ```

3.  重新激活约束：

    ```
    begin
      for cur in (select fk.owner, fk.constraint_name , fk.table_name 
                  from all_constraints fk, all_constraints pk 
                  where fk.CONSTRAINT_TYPE = 'R' and 
                        pk.owner = 'USER1' and
                        fk.R_CONSTRAINT_NAME = pk.CONSTRAINT_NAME ) loop
           execute immediate 'ALTER TABLE '||cur.owner||'.'||cur.table_name||' MODIFY CONSTRAINT '||cur.constraint_name||' ENABLE NOVALIDATE';
       end loop;
    end; 
    ```

有谁知道如何将这些步骤组合到一个`.sql`脚本中，以便我可以在 Oracle SQLDeveloper 上运行它？或者也许是一种更优雅的方式来执行从表中删除？

我会非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T11:53:13.220

如果只是从具有彼此外键的表中删除，则始终可以按约束顺序删除（“孩子优先”）。然后，您将根本不必弄乱您的约束。不要忘记在最后提交。

如果它与速度有关，那么您可能希望禁用约束并通过 TRUNCATE 而不是 DELETE 清空表。但是，您不应该删除模式的所有约束，而应该只删除受影响表的指向另一个受影响表的外键。这将防止你射中你的脚。您可以在不循环的情况下做到这一点，只需明确禁用约束即可。乙

所以整个脚本应该是这样的

```
Alter Table User_test.Table1 Modify Constraint FK... Disable;
Alter Table User_test.Table2 Modify Constraint FK... Disable;
...

Trunacte Table user_test.Table1;
Trunacte Table user_test.Table2;
...

Alter Table User_test.Table1 Modify Constraint FK... Enable;
Alter Table User_test.Table2 Modify Constraint FK... Enable;
... 
```

# qt - 在 Windows 中使用 QT 应用程序连接到 SQL Server

> ID：14522193
> 
> 赞同：0
> 
> 时间：2013-01-25T12:51:46.207
> 
> 标签：qt, qt4, sql-server-2008-r2

我正在尝试使用 Windows 中的 qt 应用程序连接到 SQL Server 2008R2，但出现错误。这就是我正在做的事情：

```
#include "ui_test1.h";
#include "QtSql/QtSql";

void Test1::on_btnsnd_clicked()
{
    QSqlDatabase db = QSqlDatabase::addDatabase("ODBC");

    db.setHostName("ITPL_PC1");
    db.setDatabaseName("Test");
    db.setUserName("sa");
    db.setPassword("insforia");
    db.open();
    QSqlQueryModel *model = new QSqlQueryModel;

    QString query = "insert into qttable(PID) values('ARUP')";
    model->setQuery(query, db);

    db.close();
} 
```

我收到此错误 27 次：

```
 test1.obj:-1: error: LNK2019: unresolved external symbol "__declspec(dllimport)        public: __thiscall QSqlDatabase::~QSqlDatabase(void)" (__imp_??1QSqlDatabase@@QAE@XZ) referenced in function "private: void __thiscall Test1::on_btnsnd_clicked(void)" (?on_btnsnd_clicked@Test1@@AAEXXZ) 
```

我不知道该怎么做（我在谷歌找到了这个。）

我应该怎么做才能修复它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T13:37:23.220

如果您使用 MSVC，您应该添加`%QTDIR%/lib/QtSql4.lib`到项目的发布配置和`%QTDIR%/lib/QtSqld4.lib`调试之一。如果您使用 Qt 5.0，您应该将`4`文件名更改为 。`500`所以，文件名是`%QTDIR%/lib/QtSql500.lib`和`%QTDIR%/lib/QtSqld500.lib`

![项目属性](../Images/2df114c83fa1515a7c4f366d5df9e935.png)

* * *

如果您使用 QtCreator，您应该在`.pro`文件中添加下一行

```
QT += sql 
```

**更新：**添加了 QtCreator`.pro`文件的描述

# c++ - 与向量一起使用的 boost::shared_ptr 很慢？

> ID：14522194
> 
> 赞同：0
> 
> 时间：2013-01-25T12:51:48.283
> 
> 标签：c++, memory-management, boost

我使用了一个 boost 共享指针向量

```
class Example{

vector<boost::shared_ptr<Point3f> > vec1;
vector<boost::shared_ptr<Point3f> > vec2;
vector<boost::shared_ptr<Point3f> > vec3;

}; 
```

point3f 是具有 3 个浮点数的结构，我在 vec1、vec2、vec3 中 push_back 50000 个元素。它工作得很好。但是这种向量的使用增加了这个类的销毁时间。我能想到的一个可能的解释是，每当向量对象被销毁时，对于向量内的每个对象，都会调用析构函数。那么是不是让破坏变慢了呢？

我应该使用 C 风格的 malloc 和 free 还是 C++ 风格的 new 和 delete 来管理内存？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T12:59:48.223

A`shared_ptr`具有执行引用计数的额外开销。例如

```
vec1.push_back(sp);
vec2.push_back(sp);
vec3.push_back(sp); 
```

对于每个副本，引用计数器都会递增。对于每次销毁，引用计数器都会递减。只有当它到达 时`0`，对象本身才会被销毁。

无论如何，如果对象是非平凡的，则销毁将花费一些时间，`shared_ptr`只有当析构函数比递增/递减操作大得多时，由 引入的开销才会明显。

要查看源是否实际上是您对 的使用`shared_ptr`，您可以将现在的时间与仅使用原始指针并手动删除它们进行比较。

确保向量不会重新分配。预先指定大小，或者使用`reserve`or `resize`- 这可能是大向量与智能指针相结合的瓶颈。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-25T22:31:25.187

`boost::ptr_vector`如果您不需要引用计数对象，则应该使用。

```
#include <boost/ptr_container/ptr_vector.hpp>

boost::ptr_vector<Point3f> vector;
vector.push_back(new Point3f()); // safe! 
```

或者，使用 C++11，您可以使用`std::unique_ptr`来实现相同的目标，因为与 不同`boost::scoped_ptr`，它具有复制语义。

```
#include <memory>
#include <vector>

std::vector<std::unique_ptr<Point3f>> vector;
vector.push_back(std::unique_ptr<Point3f>(new Point3f())); // also safe! 
```

这两种方法的性能几乎与原始指针向量的性能相同，当然更容易使用，使用起来也更安全。

# java - 使用数组基于公共键添加值

> ID：14522201
> 
> 赞同：1
> 
> 时间：2013-01-25T12:52:14.297
> 
> 标签：java, arrays, map

我有 2 个数组`String key[]`，`long value[]`. 键可以重复。我需要唯一键及其映射中值的总和。下面是我正在尝试的代码，但我得到 Array out of bound 异常

```
public HashMap < String, Long > getValueMap(String key[], long value[]) {
    Map newmap = new HashMap();
    long count = 0;
    for (int i = 0; i < value.length; i++) {
        for (int j = 0; j < value.length; j++) {
            if (key[i] == key[j]) {
                count = count + value[j];
            }
        }
        newmap.put(key[i], count);

        count = 0;
    }
    return (HashMap < String, Long > ) newmap;

}

long[] value = {};
String key[] = {};
int i = 0;
        if(!worklogs.isEmpty()){
            for(Worklog wl:worklogs){
                value[i]=wl.getValue();
                key[i]=wl.getAuthor();i++;

            }
        }

HashMap < String, Long > newhm = getValueMap(key, value);
Iterator entries = newhm.entrySet().iterator();
while (entries.hasNext()) {
    Map.Entry entry = (Map.Entry) entries.next();
    String newkey = (String) entry.getKey();
    Long newvalue = (Long) entry.getValue();
    System.out.println("Key = " + newkey + ", Value = " + newvalue);
} 
```

修改了上面的代码，使其看起来简单。请问有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T12:57:22.117

`Key[]`可能比 短`value[]`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-25T13:00:08.613

代替

```
 for(i,i<10,i++){ 
```

和

```
for(i, i<Value.length(); i++){ 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-25T13:00:43.820

这里数组长度等于0

```
long[] value = {}; 
```

在这里你尝试设置值并得到一个错误，因为数组长度 == 0

```
value[i] = wl.getValue(); 
```

使用`value.length`幻数 10 代替

```
for(int i = 0; i < value.length; i++){  
   key[i] = wl.getAuthor();
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-25T13:11:33.953

这可能是因为数组 value 和 key 在尝试向它们添加值之前尚未初始化。

`long[] value= new long[10];`

`String key[]= new String[10];`

为什么需要使用数组而不是列表？因为如果您需要变量的长度，我认为这将是一种更舒适的方法。

# ios - 如何在特定日期触发下载

> ID：14522204
> 
> 赞同：0
> 
> 时间：2013-01-25T12:52:27.693
> 
> 标签：ios, nsdate, nstimer, nscalendar, nsdatecomponents

在我的 iPhone 应用程序中，我想在每周的每个星期一、每月的第 10 个工作日、每月的第 3 天等触发下载。我做了一些研发，发现 NSDate、NSDateComponents 和 NSCalendar 类需要用于这种情况。有人可以像我一样帮助我使用日期和时间。

此外，如果应用程序未处于运行状态或移动设备已关闭，则触发来临时..如何处理这些情况。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T12:55:20.777

唯一合法的方法是将 NSLocalNotification 安排到所需的日期。当通知被触发并且用户点击它时，应用程序将启动，您应该从那里开始下载。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-25T12:56:05.880

如果您的设备已关闭/出现故障/应用程序未运行，您将无能为力。

苹果不允许你自动启动，所以下载和保存的问题有点远。

您可以做的是，每当您的应用程序启动时，您都可以从 plist 或 userdefaults 中读取时间（每月的第 3 天）并与上次保存的日期进行比较，如果是一个月后，那么是下载和显示的时间了这样做的弹出窗口。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-25T13:44:35.757

本地通知的文档：[本地通知](https://developer.apple.com/library/ios/#documentation/NetworkingInternet/Conceptual/RemoteNotificationsPG/IPhoneOSClientImp/IPhoneOSClientImp.html)

您可以阅读：[iOS 定时后台处理](https://stackoverflow.com/questions/6245763/ios-timed-background-processing)

也可以通过[本教程](http://mobile.tutsplus.com/tutorials/iphone/ios-multitasking-local-notifications/)。我也在读书。对我来说也有新的东西。最好的是 NSLocalNotifications。看看这个：[提醒应用程序](https://stackoverflow.com/questions/8892619/creating-a-time-based-reminder-app-in-iphone)

# php - PHP Ajax文件上传，最后没有重定向

> ID：14522205
> 
> 赞同：1
> 
> 时间：2013-01-25T12:52:30.813
> 
> 标签：php, ajax, file-upload

我看过很多 ajax 文件上传示例，全部使用 jquery 以及 iframe 的肮脏使用。谁能建议一个没有jquery的例子，也不需要进度条，我可以用加载器gif来做吗？另外，很多人建议使用 php 5.4 中可用的 apc 或 session 变量，它们是新标准而不是我们的旧`$_FILES`数组吗？

请有人建议如何在没有成功消息重定向到同一页面的情况下通过 ajax 实现文件上传？很像 google plus 和 facebook 在上传文件时使用的东西。任何人都可以指导他们如何做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T13:06:56.840

如果你对 jquery 没问题，那么最好是[jquery.form](http://malsup.com/jquery/form/#ajaxForm)插件。

**HTML**

```
<form action='upload.php' method='post' id='myForm' >
      <input type='file' name='img' />
      <input type='submit' name='submit' value='Upload' />
</form>
<div id='output'></div> 
```

**jQuery**

```
$(document).ready(function() {
      var options = { 
          target:        '#output1',
          beforeSubmit:  showRequest,
          success:       showResponse
      }; 
      $('#myForm').ajaxForm(options); 
}) 
```

# c# - 组合框项目预览

> ID：14522210
> 
> 赞同：-3
> 
> 时间：2013-01-25T12:52:47.597
> 
> 标签：c#

我有一个带有项目的组合框（使用 opendialog 打开文件的路径）。

[截图 http://screenshotuploader.com/i/01/0k8n94fka.png](http://screenshotuploader.com/i/01/0k8n94fka.png)

如何在 combobx 预览中仅显示文件名？

```
 OpenFileDialog openFileDialog1 = new OpenFileDialog();
    openFileDialog1.Title = "Выбрать фаил для загрузки";
    openFileDialog1.InitialDirectory = System.Environment.CurrentDirectory;
    openFileDialog1.Multiselect = true;
    if (openFileDialog1.ShowDialog() == DialogResult.OK)
    {
        foreach (String file in openFileDialog1.FileNames)
        {
            comboBox1.Items.Add(file);
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T12:58:51.683

我认为您需要一个自定义类，如下所示：

```
public class ComboBoxItem
{
     public string Display{get;set;}
     public string Value{get;set;}
     public override ToString()
     {
          return this.Display.ToString();
     }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-25T13:36:36.420

看不到这里的任何其他答案是如何工作的，所以我想我会帮忙

只需使用[SafeFileNames](http://msdn.microsoft.com/en-us/library/system.windows.forms.openfiledialog.safefilenames.aspx)而不是`FileNames`,

`SafeFileNames:`获取对话框中所有选定文件的文件名和扩展名数组。**文件名不包括路径。**

例如

```
if (openFileDialog1.ShowDialog() == DialogResult.OK)
{
    foreach (String file in openFileDialog1.SafeFileNames)
    {
        comboBox1.Items.Add(file);
    }
} 
```

会给你想要的结果。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-25T12:57:10.883

ru 将组合框与整个路径绑定..??

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-25T13:09:21.437

只需尝试此代码即可提取文件名 **Path.GetFileName(YourPath);** 将结果字符串添加到组合框

# prolog - gprolog 中的错误处理？

> ID：14522212
> 
> 赞同：0
> 
> 时间：2013-01-25T12:52:57.960
> 
> 标签：prolog, gnu-prolog

为了在一个简单的查询中运行一组查询，我标记了这些查询并使用`forall/2`它们来调用它们：

```
query_all :-
    forall(query(Q), (Q ->
        format('yes: ~w~n',[Q]) ;
        format('no : ~w~n',[Q]))). 
```

所以如果我定义类似的东西`query(true).`，我就可以`yes: true`从输出中看到。

这里的问题是`query( ... )`并不总是存在，当 prolog 找不到任何标记的内容`query`时，`forall/2`将失败并导致异常说“error(existence_error(procedure,query/1),forall/2)”

我想处理这个异常，但不想破坏整个控制流。

我知道[catch/3](http://www.gprolog.org/manual/gprolog.html#htoc68)会帮助我，但我不知道如何使用它，我的代码是：

```
catch(query_all, error(existence_error(procedure,_),_), recovery).

recovery :-
    format('error occurred.~n',[]). 
```

但序言说“不能重新定义本机代码过程 catch/3”。有什么我错过的吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-25T13:48:53.320

您可以`query/1`在代码中添加以下行声明为动态：

```
:-dynamic(query/1). 
```

或`catch/3`按照您的建议使用，但是您不必重新定义它，而是使用它，例如：

```
query_all :-
  catch(
    forall(query(Q), (Q ->
        format('yes: ~w~n',[Q]) ;
        format('no : ~w~n',[Q]))),
        error(existence_error(procedure, _), _), format('error occurred.~n', [])). 
```

# voip - 使用 Asterisk Sip 拨出 - 电路忙错误

> ID：14522217
> 
> 赞同：3
> 
> 时间：2013-01-25T12:53:15.417
> 
> 标签：voip, asterisk, sip-server

Okeyİ处理了我的问题，

## 问题是提供者。我的请求被拒绝了！所有问题提供者，这意味着主干！

我有一个星号服务器 1.6 和一个主干。当我打电话给我的手机时，我试图在中继（提供商）上拨打我的手机，它给了我：

```
-- Executing [0506610XXXX@phone:1] NoOp("SIP/1001-0000009b", "") in new stack
-- Executing [0506610XXXX@phone:2] Dial("SIP/1001-0000009b", "SIP/312XXXXXXX
/0506610XXXX") in new stack
== Using SIP RTP CoS mark 5
    -- Called 312XXXXXXX/0506610XXXX
    -- SIP/3XXXXXXXX-0000009c is circuit-busy
  == Everyone is busy/congested at this time (1:0/1/0)
    -- Executing [0506610XXXX@phone:3] Hangup("SIP/1001-0000009b", "") in new stack
  == Spawn extension (phone, 0506610XXXX, 3) exited non-zero on 'SIP/1001-0000009b' 
```

我尝试了各种东西；

#sip show peers - 一切正常，所有已注册 #sip show registry - 我的主干已正常注册

我的 sip.conf

```
[general] 
register=>XXXXXX:XXXXXX@ipaddress/312911
[312911]
type=friend 
secret=XXXXX 
username=312911
 host=ipaddress
insecure=invite ,port
context=aaa
[1001]
type=friend
dtmfmode=rfc2833
context=phone
host=dynamic
secret=XX
callerID="1001"<1001>
nat=yes 
```

我的 extension.conf

```
[myphones]
exten=> _XXX.,1,NoOp()
exten=> _XXX.,n,Dial(SIP/312911/${EXTEN})

exten=> _XXX.,n,Hangup()

[incoming]
exten=>_X.,1,NoOp()
exten=>_X.,n,Dial(SIP/1001)
exten=> _X.,n,Hangup()

[internal]
exten=>_1XXX,1,Dial(SIP/${EXTEN})
exten=>_1XXX,n,Hangup()

[phone]
include=>internal
include=>myphones

[aaa]
include=>incoming
include=>myphones 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-03-31T14:13:43.420

会产生这种错误的一些常见原因：

**1）**提供者需要注册，而您没有提供注册，而只创建了对等点。

**2)**格式错误。有些提供商需要 00 作为 ISD，有些则不需要。因此，请检查您使用的数字格式是否正确。

**3)**出站线路已满。它发生在提供者端没有频道或您不允许创建更多频道的情况下。

**4)**一些提供商不支持多个注册表。

有关更多详细信息，您需要启用“sip set debug ip <provider ip address>，然后进行调用并检查每个数据包。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T21:13:28.907

在星号控制台上：设置详细 0 // 可选设置调试 0 // 可选

设置 sip 调试

您的中继似乎无法正常工作（号码格式错误，登录/密码无效，...）

在 sip 消息中你会看到真正的错误

# javascript - 从 ember.js 中的内部函数创建视图时访问对象内容

> ID：14522218
> 
> 赞同：1
> 
> 时间：2013-01-25T12:53:15.523
> 
> 标签：javascript, model-view-controller, ember.js

我有一个覆盖该方法的 ember.js 对象，`create`因此我可以将一些未知结构的 json 传递给对象内容变量。

```
//model
App.Order = Ember.Object.extend({

  content: null,

  create: function(data) {
    this.set('content', data);
    return this._super();
  },

  getView: function() { 
    var self = this;
    return Ember.View.create({
      templateName: 'order-dialogue',
      classNames: ['card'],
      content: self.get('content'),
      name: 'house'
    });
  }

}); 
```

我有一个为对象生成视图的函数，但是我无法访问父对象的内容。每次我尝试，`self.get('content')`返回`null`。

问题：

函数中生成的视图如何`getView`访问父对象的内容？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T13:27:03.693

> 我有一个覆盖 create 方法的 ember.js 对象，因此我可以将一些未知结构的 json 传递给对象内容变量。

实际上，您的对象并没有覆盖 create 方法。它在实例上定义了一个创建函数。因此，使用您发布的代码，

```
var order = App.Order.create({test: true}); 
console.log(order.get('content')); // undefined 
```

要覆盖 create 方法，您需要`reopenClass`这样：

```
App.Order.reopenClass({
  create: function(data) {
    order = this._super();
    order.set('content', data);
    return order;
  }
}); 
```

有了它：

```
var order = App.Order.create({test: true}); 
console.log(order.get('content')); // {"test": true} 
```

> getView 函数中生成的视图如何访问父对象的内容？

正是你编码它的方式。视图没有任何问题，它实际上是返回父对象的内容。只是父对象的内容不是你所期望的。

有关工作示例，请参阅[此 jsbin](http://jsbin.com/idexok/2/edit)

# asp.net - 获取共享点列表的可用视图并填充到下拉列表中？

> ID：14522220
> 
> 赞同：0
> 
> 时间：2013-01-25T12:53:17.587
> 
> 标签：asp.net, c#-4.0, sharepoint-2010

```
 1\. Here the sample code i tried for getting the available views for the
                sharepoint list and populating into the dropdownlist

          protected void Page_Load(object sender, EventArgs e)
            {
                if (!Page.IsPostBack)
                {
                    SPSite site = new SPSite(SPContext.Current.Site.Url);
                    foreach (SPWeb web in site.AllWebs)
                    {
                        SPListCollection spListCollection = web.GetListsOfType(SPBaseType.GenericList);

                        foreach (SPList splist in spListCollection)
                        {
                            ListNameList.Items.Add(splist.Title.ToString());                        
                        }
                        ListNameList.Items.Insert(0, "--Select--");

                    }
                }
}

                       protected void ListNameList_SelectedIndexChanged(object sender,EventArgs e)
                           {
                            SPSite site = new SPSite(SPContext.Current.Site.Url);
                            SPWeb web = site.OpenWeb();
                            SPList selectedlist = web.Lists[ListNameList.SelectedValue];
                            foreach (SPView views in selectedlist.Views)
                            {
                                ViewNameList.Items.Add(views.Views.ToString());
                            }
                          } 
```

1.  我在共享点列表中创建了视图，但是在上面的代码中，循环时我得到了正确的视图名称，但是当填充到下拉列表中时，我得到的输出类似于 Microsoft.Sharepoint 而不是视图名称。

    ```
     Can you help me out of this? 
    ```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T15:24:21.800

我认为您只需要编辑将新项目添加到 ViewNameList 的行即可使用 view.Title

```
protected void ListNameList_SelectedIndexChanged(object sender,EventArgs e)
{
    SPSite site = new SPSite(SPContext.Current.Site.Url);
    SPWeb web = site.OpenWeb();
    SPList selectedlist = web.Lists[ListNameList.SelectedValue];
    foreach (SPView views in selectedlist.Views)
    {
        ViewNameList.Items.Add(views.Title);
    }
} 
```

如果集合未按您想要的顺序返回视图，您可能还需要对视图进行排序。

# java - 想要在 JTree 列出的元素上移动鼠标时更改光标

> ID：14522221
> 
> 赞同：1
> 
> 时间：2013-01-25T12:53:20.250
> 
> 标签：java, swing, cursor, jlist, jtree

`JTree`当光标仅在列出的元素上时，我想将光标更改为鼠标移到组件上的手光标，而不是整个组件。

以下代码用于`Jlist`组件。我想要相同的`JTree`，但`JTree` *没有* `getCellBound()`。还有其他方法吗？

```
final JList list = new JList(new String[] {"a","b","c"});
list.addMouseMotionListener(new MouseMotionListener() {
@Override
public void mouseMoved(MouseEvent e) {
    final int x = e.getX();
    final int y = e.getY();
    // only display a hand if the cursor is over the items
    final Rectangle cellBounds = list.getCellBounds(0, list.getModel().getSize() - 1);
    if (cellBounds != null && cellBounds.contains(x, y)) {
        list.setCursor(new Cursor(Cursor.HAND_CURSOR));
    } else {
        list.setCursor(new Cursor(Cursor.DEFAULT_CURSOR));
    }
}

@Override
public void mouseDragged(MouseEvent e) {
}
}); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-25T13:34:00.747

你正在寻找这样的东西，我猜：

```
import java.awt.Cursor;
import java.awt.Rectangle;
import java.awt.event.MouseAdapter;
import java.awt.event.MouseEvent;

import javax.swing.JFrame;
import javax.swing.JScrollPane;
import javax.swing.JTree;
import javax.swing.SwingUtilities;
import javax.swing.tree.DefaultMutableTreeNode;
import javax.swing.tree.DefaultTreeModel;
import javax.swing.tree.TreePath;

public class TestTreeSelection {

    protected void initUI() {
        final DefaultMutableTreeNode root = new DefaultMutableTreeNode("Root");
        fillTree(root, 5, "Some tree label");
        final DefaultTreeModel model = new DefaultTreeModel(root);
        final JTree tree = new JTree(model);
        tree.addMouseMotionListener(new MouseAdapter() {
            @Override
            public void mouseMoved(MouseEvent e) {
                boolean inside = false;
                TreePath path = tree.getPathForLocation(e.getX(), e.getY());
                if (path != null) {
                    Rectangle pathBounds = tree.getPathBounds(path);
                    inside = pathBounds.contains(e.getPoint());
                }
                if (inside) {
                    tree.setCursor(Cursor.getPredefinedCursor(Cursor.HAND_CURSOR));
                } else {
                    tree.setCursor(Cursor.getDefaultCursor());
                }
            }
        });
        JFrame f = new JFrame();
        f.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        f.add(new JScrollPane(tree));
        f.setSize(400, 600);
        f.setLocationRelativeTo(null);
        f.setVisible(true);
    }

    private void fillTree(DefaultMutableTreeNode parent, int level, String label) {
        for (int i = 0; i < 5; i++) {
            DefaultMutableTreeNode node = new DefaultMutableTreeNode(label + " " + i);
            parent.add(node);
            if (level > 0) {
                fillTree(node, level - 1, label);
            }
        }
    }

    public static void main(String[] args) {

        SwingUtilities.invokeLater(new Runnable() {

            @Override
            public void run() {
                new TestTreeSelection().initUI();
            }
        });
    }

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-15T21:34:20.553

此代码有效：

```
 tree_object.addMouseMotionListener(new MouseMotionListener() {

                @Override
                public void mouseDragged(MouseEvent e) {

                }

                @Override
                public void mouseMoved(MouseEvent e) {
                    TreePath tp = ((JTree)e.getSource()).getPathForLocation(e.getX(), e.getY());

                    if(tp != null)
                    {
                        ((JTree)e.getSource()).setCursor(new Cursor(Cursor.HAND_CURSOR));
                    }
                    else
                    {
                        ((JTree)e.getSource()).setCursor(new Cursor(Cursor.DEFAULT_CURSOR));
                    }
                }
         }); 
```

# android - 试图显示 ProgressDialog - 给出错误

> ID：14522222
> 
> 赞同：1
> 
> 时间：2013-01-25T12:53:21.507
> 
> 标签：android, dialog

我有一个在后台线程中获取 Google 地图坐标的活动，我想显示一个进度对话框以显示后台线程何时完成。

*地图类*

```
package com.example.androidbasic12;

public class map extends FragmentActivity{
private static LatLng SYDNEY = new LatLng(-33.88,151.21);
public static  LatLng sala = new LatLng(59.91602, 16.594108);
int travel = 0;
int MapTypeInt = 0;
private GoogleMap mMap;
GoogleMapOptions options = new GoogleMapOptions();
String username;

String Lat1;
String Lng1;
Double lat;
Double lng;
ProgressDialog dialog = new ProgressDialog(this);

// JSON response node names
private static String KEY_SUCCESS = "success";
private static String KEY_ERROR = "error";
private static String KEY_NAME = "name";
private static String KEY_LAT = "lat";
private static String KEY_LNG = "lng";

String errorhandler = "";

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.maps);
    setUpMapIfNeeded();

    UserFunctions userFunc = new UserFunctions();
    ArrayList<String> cordarr = new ArrayList<String>();
    cordarr = userFunc.getCoords(getApplicationContext(), Lat1, Lng1);
    if(cordarr != null && cordarr.size()> 1 ){
        Log.d("LOG", "I got lat long");
        Lat1 = cordarr.get(0);
        Lng1 = cordarr.get(1);
        lat = goDouble(Lat1);
        lng  = goDouble(Lng1);
        LatLng sala = new LatLng(lat, lng);
        mMap.addMarker(new MarkerOptions().position(sala).title("Coords: " 
        + lat + ", "
        + lng));
        options.mapType(GoogleMap.MAP_TYPE_NORMAL)
        .compassEnabled(true)
        .rotateGesturesEnabled(true)
        .tiltGesturesEnabled(true);
    } else {
        Log.d("LOG", "no lat long found");
    }

    new getCord().execute();

    //Button that sends the user to Sala by default, and to Sydney if Sala
    Button btnSyd =  (Button) findViewById(R.id.btnSyd);
    btnSyd.setOnClickListener(new View.OnClickListener() {
        @Override
        public void onClick(View v) {
            // TODO Auto-generated method stu

            if (travel == 0){
                travelToSala();
                travel = 1;
            } else if (travel == 1) {
                travelToSydney();
                travel = 0;
            }
        }
    });
    //Button for setting map type to satellite if normal, to normal if satellite
    final ImageButton changeBtn =(ImageButton) findViewById(R.id.changeBtn);
    changeBtn.setOnClickListener(new View.OnClickListener() {
        @Override
        public void onClick(View v) {
            // TODO Auto-generated method stub
            changeMapType(changeBtn);
        }
    });     
}
//method that changes maptype
private void changeMapType(ImageButton button){
    if(MapTypeInt == 0){
        mMap.setMapType(GoogleMap.MAP_TYPE_HYBRID);
        button.setImageResource(R.drawable.normal_map);
        MapTypeInt = 1;
    } else if (MapTypeInt == 1) {
        mMap.setMapType(GoogleMap.MAP_TYPE_NORMAL);
        button.setImageResource(R.drawable.satellite);
        MapTypeInt = 0;
    }
}
//Function that travels user to Sydney
private void travelToSydney(){
    mMap.animateCamera(CameraUpdateFactory.newLatLngZoom(SYDNEY, 15));
    Button btnSyd = (Button) findViewById(R.id.btnSyd);
    btnSyd.setText("travel to Sala");
}
//Function that travels user to Sala
private void travelToSala(){
    mMap.animateCamera(CameraUpdateFactory.newLatLngZoom(sala, 15));
    Button btnSyd = (Button) findViewById(R.id.btnSyd);
    btnSyd.setText("travel to Sydney!");
}
//Checks if map is setup, and if it isn't, set's up the map
private void setUpMapIfNeeded() {
    if (mMap == null) {
        mMap = ((SupportMapFragment) getSupportFragmentManager().findFragmentById(R.id.map)).getMap();
        mMap.animateCamera(CameraUpdateFactory.newLatLngZoom(sala, 15));
        if(mMap != null){
            //The map is veriefied
        }
    } 
}

class getCord extends AsyncTask<String, String, String>{

    @Override
    protected String doInBackground(String... params) {
        // TODO Auto-generated method stub
        UserFunctions userFunction = new UserFunctions();
        username = userFunction.getUsername(getApplicationContext(), "uname"); 
        JSONObject json = userFunction.getCarcoord(username);

        try {
            if (json.getString(KEY_SUCCESS) != null){
                String res = json.getString(KEY_SUCCESS);
                if (Integer.parseInt(res)==1){
                    //Successfully found users car coordinates
                    DatabaseHandler db = new DatabaseHandler(getApplicationContext());
                    JSONObject json_coord = json.getJSONObject("user");

                    //clear previous entries in table "TABLE_COORD"
                    userFunction.resetCarcoord(getApplicationContext());
                    db.addCoord(json_coord.getString(KEY_NAME), json_coord.getString(KEY_LAT), json_coord.getString(KEY_LNG));
                    errorhandler = "2";

                }
            } else if(json.getString(KEY_ERROR) != null) {
                String res = json.getString(KEY_ERROR);
                if(Integer.parseInt(res) == 1){
                    //Some error in getting registration, should not happen though
                    errorhandler = "1";
                }

            }

        }catch (JSONException e) {
            e.printStackTrace();
        }
        return null;
    }

    @Override
    protected void onPreExecute() {
        // TODO Auto-generated method stub
        super.onPreExecute();
        dialog.setCancelable(true);
        dialog.setMessage("Loading car coordinats");
        dialog.show();

    }

    @Override
    protected void onPostExecute(String result) {
        // TODO Auto-generated method stub
        super.onPostExecute(result);
        dialog.cancel();
        if(errorhandler == "1"){
            Toast toast = Toast.makeText(getApplicationContext(),
                    "User has not got car", Toast.LENGTH_LONG);
            toast.show();
            errorhandler = "";
        } else if (errorhandler == "2" ) {
            // Error in login
            Toast toast = Toast.makeText(getApplicationContext(),
                    "Successfully got coords for car", Toast.LENGTH_LONG);
            toast.show();
            errorhandler = "";
        }
    }
}
public Double goDouble(String Latlng) {
    Double goDouble = Double.parseDouble(Latlng);
    return goDouble;
} 
```

} *错误信息*

```
01-25 13:51:00.721: E/AndroidRuntime(7780): FATAL EXCEPTION: main
01-25 13:51:00.721: E/AndroidRuntime(7780): java.lang.RuntimeException: Unable to instantiate activity ComponentInfo{com.example.androidbasic12/com.example.androidbasic12.map}: java.lang.NullPointerException
01-25 13:51:00.721: E/AndroidRuntime(7780):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1891)
01-25 13:51:00.721: E/AndroidRuntime(7780):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1992)
01-25 13:51:00.721: E/AndroidRuntime(7780):     at android.app.ActivityThread.access$600(ActivityThread.java:127)
01-25 13:51:00.721: E/AndroidRuntime(7780):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1158)
01-25 13:51:00.721: E/AndroidRuntime(7780):     at android.os.Handler.dispatchMessage(Handler.java:99)
01-25 13:51:00.721: E/AndroidRuntime(7780):     at android.os.Looper.loop(Looper.java:137)
01-25 13:51:00.721: E/AndroidRuntime(7780):     at android.app.ActivityThread.main(ActivityThread.java:4511)
01-25 13:51:00.721: E/AndroidRuntime(7780):     at java.lang.reflect.Method.invokeNative(Native Method)
01-25 13:51:00.721: E/AndroidRuntime(7780):     at java.lang.reflect.Method.invoke(Method.java:511)
01-25 13:51:00.721: E/AndroidRuntime(7780):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:980)
01-25 13:51:00.721: E/AndroidRuntime(7780):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:747)
01-25 13:51:00.721: E/AndroidRuntime(7780):     at dalvik.system.NativeStart.main(Native Method)
01-25 13:51:00.721: E/AndroidRuntime(7780): Caused by: java.lang.NullPointerException
01-25 13:51:00.721: E/AndroidRuntime(7780):     at android.content.ContextWrapper.getApplicationInfo(ContextWrapper.java:139)
01-25 13:51:00.721: E/AndroidRuntime(7780):     at android.view.ContextThemeWrapper.getTheme(ContextThemeWrapper.java:65)
01-25 13:51:00.721: E/AndroidRuntime(7780):     at android.app.AlertDialog.resolveDialogTheme(AlertDialog.java:142)
01-25 13:51:00.721: E/AndroidRuntime(7780):     at android.app.AlertDialog.<init>(AlertDialog.java:98)
01-25 13:51:00.721: E/AndroidRuntime(7780):     at android.app.ProgressDialog.<init>(ProgressDialog.java:77)
01-25 13:51:00.721: E/AndroidRuntime(7780):     at com.example.androidbasic12.map.<init>(map.java:42)
01-25 13:51:00.721: E/AndroidRuntime(7780):     at java.lang.Class.newInstanceImpl(Native Method)
01-25 13:51:00.721: E/AndroidRuntime(7780):     at java.lang.Class.newInstance(Class.java:1319)
01-25 13:51:00.721: E/AndroidRuntime(7780):     at android.app.Instrumentation.newActivity(Instrumentation.java:1026)
01-25 13:51:00.721: E/AndroidRuntime(7780):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1882)
01-25 13:51:00.721: E/AndroidRuntime(7780):     ... 11 more 
```

任何人都可以看到问题是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-25T13:02:46.573

像这样更改您的进度对话框声明

```
progressDialog = new ProgressDialog(youractivity.this); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-25T12:59:40.997

尝试

```
ProgressDialog dialog ;

    @Override
    protected void onPreExecute() {
        // TODO Auto-generated method stub

          dialog = ProgressDialog.show(Map.this,
                   "Loading car coordinats", "Please wait ...", true, true);
          super.onPreExecute();
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-25T13:01:28.637

问题是您正在创建`ProgressDialog`如下

```
ProgressDialog dialog = new ProgressDialog(this); 
```

这`this`是您的`FragmentActivity`. 但是在构造函数中，您应该传递`activity`. 因此使用这个

```
ProgressDialog dialog = new ProgressDialog(this.getActivity()); 
```

# .net - 使用 .Net 远程处理和 ipv6

> ID：14522223
> 
> 赞同：3
> 
> 时间：2013-01-25T12:53:37.680
> 
> 标签：.net, remoting, ipv6

我正在使用`Activator.CreateInstance(type, "http://localhost/blah")`Windows 7 上的 .Net 3.5 中的远程调用服务。

据我了解，Windows 7 默认使用 IPv6（当然，如果我 ping localhost，它会解析为 ::1）所以我希望这个 URL 能够建立 IPv6 连接，但在我的测试中，它总是以 IPv4 连接

如何在我想使用 IPv6 的远程处理 URL 中指定？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-11T11:19:00.813

发生这种情况是因为 .net 远程服务器默认侦听 IPv4。如果您的网络配置为同时使用 IPv6 和 IPv4，Windows 7 将首先将主机名解析为 IPv6，然后解析为 IPv4，这是远程服务器侦听的默认地址。

所以为了使用 IPv6 URL，你必须设置远程服务器来监听 IPv6。如果您使用的是 app.config，请执行以下操作：

```
<system.runtime.remoting>
  <application>
    <service>
      <wellknown mode="Singleton" type="MyApplication.MyServer, MyAssembly" objectUri="MyServer" />
    </service>
    <channels>
      <channel ref="tcp" name="tcp6" port="9000" bindTo="[::]" />
      <channel ref="tcp" name="tcp4" port="9000" bindTo="0.0.0.0" />
    </channels>
  </application>
</system.runtime.remoting> 
```

或者以编程方式配置：

```
IDictionary properties = new Hashtable();
properties["name"] = "tcp6";
properties["port"] = 9000;
properties["bindTo"] = "[::]";
TcpServerChannel channel = new TcpServerChannel(properties, null);
ChannelServices.RegisterChannel(channel,  false); 
```

有关详细信息，请参阅[此博客文章](http://www.ookii.org/Blog/net_remoting_and_ipv6)。

# sql-server - 如何保留 SQL Server 存储过程修订的历史记录

> ID：14522224
> 
> 赞同：5
> 
> 时间：2013-01-25T12:53:44.840
> 
> 标签：sql-server, stored-procedures, version-control

注意：我不是在询问完整的版本控制。

有什么方法可以自动保留 SQL Server 上存储过程的历史记录。

类似于 Google Docs 自动保存文档版本的历史，而 Wikipedia 自动保存文章版本的历史。

我不希望用户更新存储过程也必须维护存储过程的存储库。这是太多的工作，人们不会这样做。

希望这是我可以在 SQL Server 中打开的东西......

（我所说的存储过程实际上是指函数、触发器等。基本上是可编程性下的所有内容。）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-25T12:58:06.287

您可以每小时运行一次[RedGate SQL 比较](http://www.red-gate.com/products/sql-development/sql-compare/)，将所有定义写入磁盘。如果同一个作业将该目录提交到源代码控制，您将获得数据库的每小时历史记录。

您也可以使用[RedGate SQL Source Control](http://www.red-gate.com/products/sql-development/sql-source-control/)，但这需要每个人手动提交。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T13:02:06.357

看起来这可能会有所帮助：[SQL Server stored procedure restores to previous one](https://stackoverflow.com/questions/10820024/sql-server-stored-procedure-restores-to-previous-one?rq=1)

但可以肯定的是，这是内置的，或者可以通过一些已经存在的插件来实现......

# android - 检测android应用程序是否在后台运行

> ID：14522228
> 
> 赞同：1
> 
> 时间：2013-01-25T12:53:56.303
> 
> 标签：android

我想检查我的应用程序是否在后台模式下运行。

问题是我有很多活动（列表活动、地图活动等）。最初，我尝试在生命周期的 resume 和 pause( 或`onUserLeaveHint`) 方法中将静态布尔值设置为 true 或 false 并以这种方式工作。但这显然行不通，因为当我从一项活动转移到另一项活动时，前一项活动会暂停。

另外，我在 stackoverflow 上读到`getRunningTasks()`应该仅用于调试目的。我进行了大量研究，但找不到解决方案。我想做的就是能够检测应用程序是否在后台运行。任何人都可以向我提出一种方法，或表达任何关于我该怎么做的想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T13:01:56.530

您可以尝试相同的机制（布尔属性），但在应用程序端而不是活动端。创建一个扩展类，`Application`在清单文件中声明它`<application android:name=YourClassApp>`。

编辑：我假设您知道这`activities`不适用于后台处理，如果不是，您应该查看`Services`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-25T13:48:24.100

我不知道这是否会有所帮助，但您可以使用

`getApplicaton().registerActivityLifecycleCallbacks(`[你的班](http://developer.android.com/reference/android/app/Application.ActivityLifecycleCallbacks.html)`);`

鸟瞰您的活动在 FG 中的显示方式。（对于较旧的软件，您[可以使用它](https://stackoverflow.com/a/14470379/68805)）

* * *

如果您的应用程序有一个服务，您可以有一个访问静态变量的静态 get/set。但是不要在活动中这样做，它会导致内存泄漏。

但实际上，如果您的应用程序正在运行，则没有一种整洁的方法可以跟踪。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-08-01T14:42:33.590

我在覆盖 Firebase 推送消息默认行为时遇到了同样的问题（仅在后台显示通知）我通过查看 .class 文件 com.google.firebase.messaging.zzb:53（firebase-messaging :19.0.1) 在我们看来是 getRunningAppProcesses。请注意，FireBase 是由 Google 他们自己创建的。所以我假设它非常节省使用。清理版：

```
List<ActivityManager.RunningAppProcessInfo> runningApps;            
boolean isInForeground =false;
        if ((runningApps = ((ActivityManager)this.getApplication().getSystemService(Context.ACTIVITY_SERVICE)).getRunningAppProcesses()) != null) {
            Iterator runningApp = runningApps.iterator();
            int myPid = Process.myPid();
            while(runningApp.hasNext()) {
                ActivityManager.RunningAppProcessInfo processInfo;
                if ((processInfo = (ActivityManager.RunningAppProcessInfo)runningApp.next()).pid == myPid) {
                    isInForeground = processInfo.importance == 100;
                    break;
                }
            }
        } 
```

# jquery - 使用 DOM 的 jquery 表单嵌套数据的 data() 函数

> ID：14522229
> 
> 赞同：0
> 
> 时间：2013-01-25T12:53:59.833
> 
> 标签：jquery

我正在寻找 DOM 元素的嵌套数据。像这样的东西

```
$("div").data( "test", { 
    first: 16,
    last: "pizza!"
}); 
```

这是我制作类似格式的努力。但是 RefAttrValue 变量不表现为变量。

```
for (var i = 0; i < reference.attributes.length; i++) {
    var RefAttrValue = (reference.attributes.item(i).name);
    $(tableCaption).data("referenceData").RefAttrValue = reference.attributes.item(i).value;
} 
```

这里“参考”的值是一个 XML。具有如下值或可以包含任何类似的 XML。

```
<facilityreference Name="qtitem_fac" AttrTable='table1' colVal='table1colValue'></facilityreference> 
```

**我想以下面的“动态”**格式设置`data()`格式。

 **```
$("div").data("test",{ Name: "qtitem_fac", last: "table1colValue" }); 
```

请帮忙。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T13:00:02.243

据我了解，您需要这样的东西：

```
var datObj = {};
for (var i = 0; i < reference.attributes.length; i++) {
    var RefAttrValue = (reference.attributes.item(i).name);
    datObj[RefAttrValue] = reference.attributes.item(i).value;
}
$(tableCaption).data("referenceData", datObj ); 
```

在您的代码中，我看到了一些问题： 首先：如果您`$(tableCaption).data("referenceData", {...})`在运行代码之前什么都不做，`$(tableCaption).data("referenceData")`则行将返回 undefined，这将导致异常。

如果您在变量中有一个字段名称（`RefAttrValue`在您的情况下），您需要执行类似`$(tableCaption).data("referenceData")[RefAttrValue]`. 这种表示法是同义词，如果`RefAttrValue = "Name"`，则`$(tableCaption).data("referenceData").Name`

这样做`$(tableCaption).data("referenceData").RefAttrValue`您只需使用 name 访问 referenceData 的属性`RefAttrValue`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-25T13:03:17.483

未测试：

```
 obj = {};

    $('facilityreference').each(function(){
       $.each(this.attributes, function(i, attrib){
           obj[attrib.name] = attrib.value;
      });

    }); // then do something with you object 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-01-25T13:06:02.307

```
use this...Hopefully this will solve the requirement.!
str = $('#id').data('test');var json = JSON.stringify(eval("(" + str + ")"));alert(json); 
```**

# android - 带有片段的 Viewpager 和带有 viewswitcher 的 gridview

> ID：14522232
> 
> 赞同：0
> 
> 时间：2013-01-25T12:54:36.833
> 
> 标签：android, android-viewpager, fragment

Android 使用了多少寻呼机片段`FragmentPagerAdapter`？在我看来，它在左侧保存了八个片段，因为它们没有正确加载，所以它们似乎没有重建。我可以更改要保留的片段数吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T12:58:03.790

[FragmentPagerAdapter](https://developer.android.com/reference/android/support/v4/app/FragmentPagerAdapter.html)实际上并没有删除任何片段，它只是分离片段（这意味着它的状态被保留，但它的视图被破坏）。

如果您希望完全删除 Fragment，请改用[FragmentStatePagerAdapter](https://developer.android.com/reference/android/support/v4/app/FragmentStatePagerAdapter.html)。

# java - 测试两个目录树是否相等

> ID：14522239
> 
> 赞同：18
> 
> 时间：2013-01-25T12:55:09.477
> 
> 标签：java, unit-testing, junit

我正在对我的代码的某些部分进行集成测试，这些代码在 SVN 下创建目录树。这需要我测试目录结构和其中的文件是否符合我的预期。

一方面，我有我想要的文件的预期目录树，另一方面，从 SVN 导出文件（宁愿`svn export`避免`svn co`噪音`.svn`）。

但是，有没有可以断言两个目录树的库？我想到的最后手段是自己进行迭代比较。

基本上我正在寻找一个可以接受两个目录并告诉我它们是否相等的 API。

有点意思

```
boolean areDirectoriesEqual(File dir1, File dir2) 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2016-09-20T01:05:14.657

我没有使用第三方库，而是使用标准 jdk 库。

```
private static void verifyDirsAreEqual(Path one, Path other) throws IOException {
    Files.walkFileTree(one, new SimpleFileVisitor<Path>() {
        @Override
        public FileVisitResult visitFile(Path file,
                BasicFileAttributes attrs)
                throws IOException {
            FileVisitResult result = super.visitFile(file, attrs);

            // get the relative file name from path "one"
            Path relativize = one.relativize(file);
            // construct the path for the counterpart file in "other"
            Path fileInOther = other.resolve(relativize);
            log.debug("=== comparing: {} to {}", file, fileInOther);

            byte[] otherBytes = Files.readAllBytes(fileInOther);
            byte[] theseBytes = Files.readAllBytes(file);
            if (!Arrays.equals(otherBytes, theseBytes)) {
                throw new AssertionFailedError(file + " is not equal to " + fileInOther);
            }  
            return result;
        }
    });
} 
```

注意：这只是比较两个文件夹下的实际文件。如果你有空文件夹等你也想比较，你可能需要做一些额外的事情。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-25T13:27:59.460

我不知道有任何`areDirsEqual`图书馆；我能想到的最接近的是 Commons 中的 listFiles 方法[`FileUtils`](http://commons.apache.org/io/api-release/org/apache/commons/io/FileUtils.html)。

如果将结果集合放在 a 中`HashSet`，您应该能够有效地比较这两个集合。它可以在 2 行中完成，甚至可以是单行。

这条线上的东西：

```
public static boolean areDirsEqual(File dir, File dir2) {
  return (new HashSet<File>(FileUtils.listFiles(dir1,..))).
          containsAll(FileUtils.listFiles(dir2, ..))
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-11-24T13:35:11.213

我遇到了同样的问题，跟随 Patrick 和 Lorenzo Dematté，我找到了一个适合我的解决方案。以下代码遍历文件夹和：

*   对于每个子文件夹检查文件列表是否相同
*   为每个文件比较内容（在我的情况下，我必须比较两个包含 csv 文件的文件夹）

我在linux上测试过。

```
 private static void verifyDirsAreEqual(File expected, File generated) 
                throws IOException {

    // Checks parameters 
    assertTrue("Generated Folder doesn't exist: " + generated,generated.exists());
    assertTrue("Generated is not a folder?!?!: " + generated,generated.isDirectory());

    assertTrue("Expected Folder doesn't exist: " + expected,expected.exists());
    assertTrue("Expected is not a folder?!?!: " + expected,expected.isDirectory());     

    Files.walkFileTree(expected.toPath(), new SimpleFileVisitor<Path>() {
        @Override
        public FileVisitResult preVisitDirectory(Path dir,
                BasicFileAttributes attrs)
                  throws IOException {
            FileVisitResult result = super.preVisitDirectory(dir, attrs);

            // get the relative file name from path "expected"
            Path relativize = expected.toPath().relativize(dir);
            // construct the path for the counterpart file in "generated"
            File otherDir = generated.toPath().resolve(relativize).toFile();
            log.debug("=== preVisitDirectory === compare " + dir + " to " + otherDir);
            assertEquals("Folders doesn't contain same file!?!?",
                    Arrays.toString(dir.toFile().list()),
                    Arrays.toString(otherDir.list()));
            return result;
        }
        @Override
        public FileVisitResult visitFile(Path file,
                BasicFileAttributes attrs)
                throws IOException {
            FileVisitResult result = super.visitFile(file, attrs);

            // get the relative file name from path "expected"
            Path relativize = expected.toPath().relativize(file);
            // construct the path for the counterpart file in "generated"
            File fileInOther = generated.toPath().resolve(relativize).toFile();
            log.debug("=== comparing: " + file + " to " + fileInOther);
            String expectedContents = FileUtils.readFileToString(file.toFile());
            String generatedContents = FileUtils.readFileToString(fileInOther);
            assertEquals("("+fileInOther+")  csv standard doesn't match expected ("+file+")!", expectedContents, generatedContents);                    
            return result;
        }
    });
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2018-03-01T17:56:50.597

对我来说，Patrick 的解决方案似乎是一个很好的解决方案，但结合骆驼（Fuse ESB）我遇到了最后一个父文件夹仍然被 Fuse 进程阻止的问题 => 对我来说，以下解决方案似乎是更好的方法。我通过 SimpleVistor 遍历其他目录并制作了一组可比较的展位目录

```
public boolean compareFolders(final Path pathOne, final Path pathSecond) throws IOException {

    // get content of first directory
    final TreeSet<String> treeOne = new TreeSet();
    Files.walkFileTree(pathOne, new SimpleFileVisitor<Path>() {
        @Override
        public FileVisitResult visitFile(Path file, BasicFileAttributes attrs) throws IOException {
            Path relPath = pathOne.relativize(file);
            String entry = relPath.toString();
            treeOne.add(entry);
            return FileVisitResult.CONTINUE;
        }
    });

    // get content of second directory
    final TreeSet<String> treeSecond = new TreeSet();
    Files.walkFileTree(pathSecond, new SimpleFileVisitor<Path>() {
        @Override
        public FileVisitResult visitFile(Path file, BasicFileAttributes attrs) throws IOException {
            Path relPath = pathSecond.relativize(file);
            String entry = relPath.toString();
            treeSecond.add(entry);
            return FileVisitResult.CONTINUE;
        }
    });
    return treeOne.equals(treeSecond);
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-01-25T13:16:46.007

好的，所以我不知道有任何现成的代码可以做到这一点，搜索也没有帮助。所以这就是我将如何实现它

1.  递归迭代所有文件夹和文件
2.  将所有具有相对路径的文件名保存在哈希集中，其中相对路径是键/值
3.  在第二个目录结构上递归迭代并从每个路径创建一个以匹配哈希集中的键（如果文件夹/文件存在）

如果只想将树标记为已更改/未更改，可以保存每个文件的hash，那么需要一个hashmap而不是hashset，其中每个文件内容的hash就是hashmap的值

希望这可以帮助

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-02-12T16:02:37.457

这是一个使用 Java NIO 包的简单迭代解决方案（不使用访问者模式，因此它也可以适用于早期的 Java 版本）。

当然可以对其进行调整，但目前这是一个简单的解决方案，可以从两个目录的视图中检查每个文件是否出现，并可选择使用 Apache Commons FileUtils 比较文件内容。

```
/**
 * checks if the directory file lists and file content is equal
 * 
 * @param directory
 *            the directory
 * @param compareDirectory
 *            the directory to compare with
 * @param checkFileContent
 *            also compare file content
 * @return true if directory and compareDirectory are equal
 * @throws IOException
 */
public static boolean isEqualDirectories(Path directory, Path compareDirectory, boolean checkFileContent) throws IOException {
    boolean check = isEverythingInCompareDirectory(directory, compareDirectory, checkFileContent);
    boolean checkOpposite = check && isEverythingInCompareDirectory(directory, compareDirectory, checkFileContent);
    return check && checkOpposite;

}

/**
 * checks if the directory file lists and file content is equal
 * 
 * @param directory
 *            the directory
 * @param compareDirectory
 *            the directory to compare with
 * @param checkFileContent
 *            also compare file content
 * @return true if directory and compareDirectory are equal
 * @throws IOException
 */
public static boolean isEverythingInCompareDirectory(Path directory, Path compareDirectory, boolean checkFileContent)
        throws IOException {

    try {
        LOGGER.info("checking directory " + directory);

        File directoryFile = directory.toFile();
        File compareFile = compareDirectory.toFile();

        // check, if there is the same number of files/subdirectories
        File[] directoryFiles = directoryFile.listFiles();
        File[] compareFiles = compareFile.listFiles();

        if (directoryFiles.length == compareFiles.length) {
            return compareDirectoryContents(directory, compareDirectory, checkFileContent);

        } else {
            LOGGER.info("number of files in directory are different " + directoryFiles.length + " vs compareDirectory: " + compareFiles.length);
            return false;
        }

    } catch (IOException e) {
        throw new RuntimeException("Failed to assert that all files are equal", e);
    }
}

public static boolean compareDirectoryContents(Path directory, Path compareDirectory, boolean checkFileContent) throws IOException {
    try (DirectoryStream<Path> directoryStream = Files.newDirectoryStream(directory)) {

        for (Path directoryFilePath : directoryStream) {

            // search for directoryFile in the compareDirectory
            Path compareFilePath = compareDirectory.resolve(directoryFilePath.getFileName());

            if (compareFilePath != null) {

                File directoryFile = directoryFilePath.toFile();
                if (directoryFile.isFile()) {
                    LOGGER.info("checking file " + directoryFilePath);
                    if (checkFileContent && !FileUtils.contentEquals(compareFilePath.toFile(), directoryFile)) {
                        LOGGER.info("files not equal: compare: " + compareFilePath.toFile() + ", directory: " + directoryFilePath.getFileName() + "!");
                        return false;
                    }

                } else {
                    LOGGER.info("going into recursion with directory " + directoryFilePath);
                    boolean result = isEverythingInCompareDirectory(directoryFilePath, compareFilePath, checkFileContent);
                    // cancel if not equal, otherwise continue processing
                    if (!result) {
                        return false;
                    }

                }
            } else {
                LOGGER.info(directoryFilePath.toString() + ": compareFilepath not found");
                return false;
            }

        }
    }

    return true;
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-11-26T14:38:54.837

我在 Kotlin 中编写了这个小代码。它不检查文件的内容，而是完全依赖于 apache 的 md5。

```
import org.apache.commons.codec.digest.DigestUtils

fun File.calcMD5() = DigestUtils.md5Hex(FileUtils.readFileToByteArray(this))

fun compareTwoDirs(dir1: File, dir2: File): Boolean {
    val files1 = dir1.listFiles().sorted()
    val files2 = dir2.listFiles().sorted()
    if (files1.size != files2.size) return false
    return files1.zip(files2).all { equate(it.first, it.second) }
}

fun equate(fl: File, fl2: File): Boolean {
    if (fl.isFile && fl2.isFile) return fl.calcMD5() == fl2.calcMD5()
    if (fl.isDirectory && fl2.isDirectory) return compareTwoDirs(fl, fl2)
    return false
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-05-29T23:00:25.257

我知道这是一个老问题，但我会尝试解决它。这是一个打开 2 个目录并比较它们的内容的代码。如果在一个文件中找到的文件在另一个文件中丢失，或者它们的内容不同，则返回 false。为此，我浏览了 2 个目录的内容，并递归地比较找到的文件和目录（按字母顺序）。

```
// Comparison of 2 files
private static boolean compareFiles(File f1, File f2) {
    long i1 = f1.length();
    long i2 = f2.length();
    if (i1 != i2) {
        return false;
    }
    try {
        byte b1, b2;
        DataInputStream dis = new DataInputStream(
                new BufferedInputStream(
                        new FileInputStream(f1)));
        DataInputStream dis1 = new DataInputStream(
                new BufferedInputStream(
                        new FileInputStream(f2)));
        while (true) {
            b1 = dis.readByte();
            b2 = dis1.readByte();
            if (b1 != b2) {
                return false;
            }
        }
    } catch (IOException ex) {
        return true;
    }
}

// Recursive comparison of 2 files.
// The idea is that if 2 directories are the same, 
// they will have the same files and the same under directories
private static boolean areDirsEqual(File dir1, File dir2) {
    File[] list1 = dir1.listFiles(), list2 = dir2.listFiles();
    if (list1.length != list2.length) {
        return false;
    }
    for (int i = 0; i < list2.length; i++) {
        if (list1[i].isFile() && list2[i].isFile()) {
            if (!compareFiles(list1[i], list2[i])) {
                return false;
            }
        } else if (list1[i].isDirectory() && list2[i].isDirectory()) {
            if (!areDirsEqual(list1[i], list2[i])) {
                return false;
            }
        } else {
            return false;
        }
    }
    return true;
} 
```

* * *

## 回答 #9

> 赞同：-5
> 
> 时间：2013-01-25T13:00:00.183

```
import java.io.File;

/**
 * 
 * FileUtils is a collection of routines for common file system operations.
 * 
 * @author Dan Jemiolo (danj)
 * 
 */

public final class FileUtils {

  /**
   * 
   * This is a convenience method that calls find(File, String, boolean) with
   * the last parameter set to "false" (does not match directories).
   * 
   * @see #find(File, String, boolean)
   * 
   */
  public static File find(File contextRoot, String fileName) {
    return find(contextRoot, fileName, false);
  }

  /**
   * 
   * Searches through the directory tree under the given context directory and
   * finds the first file that matches the file name. If the third parameter is
   * true, the method will also try to match directories, not just "regular"
   * files.
   * 
   * @param contextRoot
   *          The directory to start the search from.
   * 
   * @param fileName
   *          The name of the file (or directory) to search for.
   * 
   * @param matchDirectories
   *          True if the method should try and match the name against directory
   *          names, not just file names.
   * 
   * @return The java.io.File representing the <em>first</em> file or
   *         directory with the given name, or null if it was not found.
   * 
   */
  public static File find(File contextRoot, String fileName, boolean matchDirectories) {
    if (contextRoot == null)
      throw new NullPointerException("NullContextRoot");

    if (fileName == null)
      throw new NullPointerException("NullFileName");

    if (!contextRoot.isDirectory()) {
      Object[] filler = { contextRoot.getAbsolutePath() };
      String message = "NotDirectory";
      throw new IllegalArgumentException(message);
    }

    File[] files = contextRoot.listFiles();

    //
    // for all children of the current directory...
    //
    for (int n = 0; n < files.length; ++n) {
      String nextName = files[n].getName();

      //
      // if we find a directory, there are two possibilities:
      //
      // 1\. the names match, AND we are told to match directories.
      // in this case we're done
      //
      // 2\. not told to match directories, so recurse
      //
      if (files[n].isDirectory()) {
        if (nextName.equals(fileName) && matchDirectories)
          return files[n];

        File match = find(files[n], fileName);

        if (match != null)
          return match;
      }

      //
      // in the case of regular files, just check the names
      //
      else if (nextName.equals(fileName))
        return files[n];
    }

    return null;
  }

} 
```

# c# - VS 2012 试用版和代码覆盖率

> ID：14522243
> 
> 赞同：0
> 
> 时间：2013-01-25T12:55:29.327
> 
> 标签：c#, c++, visual-studio-2012, code-coverage

是否可以从 VS 2012 试用版工具中获取代码覆盖率？

当我在检测后（手动）运行我的测试用例时，`.coverage`文件显示我的`.pdb's may not be present or may be incorrect.`

还有什么我需要做的吗？

对于仪表，我执行以下操作：

*   使用带有覆盖标志的 vsinstr 并检测 .dll 和 .exe
*   复制所有 .dll、.exe 和 .pdb 文件
*   我执行测试用例。

我正在使用`Visual Studio ultimate 2012`从 MSDN 网站下载的试用版

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T13:42:41.150

尝试这个 ：

`tools ->options ->debugging->symbols->tick the check mark against microsoft symbol server`

并单击确定。

# iphone - 了解应用程序是否被授权即时接收推送通知

> ID：14522246
> 
> 赞同：2
> 
> 时间：2013-01-25T12:55:38.843
> 
> 标签：iphone, push-notification, apple-push-notifications

考虑这种情况。应用程序运行并且**application:didRegisterForRemoteNotificationsWithDeviceToken:**接收应用程序被授权接收推送通知的信息。

用户将应用程序置于后台并删除应用程序在设备配置上接收通知的授权。

用户再次运行应用程序。从后台返回，应用程序仍然认为它有权接收推送通知。application: didRegisterForRemoteNotificationsWithDeviceToken **:**或**application:didFailToRegisterForRemoteNotificationsWithError:**此时都没有收到任何内容。

有没有办法知道应用程序是否有权接收推送通知（从设备的通知首选项中读取某些内容）？

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-25T13:23:29.467

您可以检查`[[UIApplication sharedApplication] enabledRemoteNotificationTypes]`应用程序每次从后台返回的时间。

请参阅：[iOS - 检查应用程序中的推送通知支持](https://stackoverflow.com/questions/7898752/ios-check-for-push-notification-support-in-the-app)

> 一旦我确认用户已禁用它，是否有办法以编程方式将用户定向到设备配置上的通知设置？

不适用较新的 iOS 版本。根据[Navigate to settings screen in iphone](https://stackoverflow.com/questions/10549053/navigate-to-settings-screen-in-iphone)和[iOS Launching Settings -> Restrictions URL Scheme](https://stackoverflow.com/questions/8246070/ios-launching-settings-restrictions-url-scheme)，您可以使用`-[[UIApplication sharedApplication] openURL:]`导航到*设置*屏幕，但仅适用于运行 iOS 5.0 及更低版本的设备。

# php - PHP file_exists 间歇性失败

> ID：14522248
> 
> 赞同：3
> 
> 时间：2013-01-25T12:55:40.437
> 
> 标签：php, iis-7

我有一个 PHP 文件使用 file_exists 函数检查服务器上是否存在文件。这是我所知道的：

*   该路径是相对于 PHP 文件的，并且确实存在，尽管 PHP 告诉我它不存在。
*   file_exists 每次都适用于管理员帐户，但对于“域用户”组的用户会间歇性地失败（超过 90% 的时间）。
*   域用户组被临时授予对文件所在目录的完全控制权，但问题仍然存在。
*   IUSR 和 IIS AppPool\AppPoolIdentifier 都具有对该目录的适当访问权限。
*   PHP 安全模式已关闭

使用 IIS 7 运行 PHP 版本 5.2.6 和 Windows Server 2008 r2。

为什么非管理员用户组的 file_exists 会间歇性失败？谢谢你的帮助。

# git - 在 Github 中更改本地 repo 目录

> ID：14522251
> 
> 赞同：0
> 
> 时间：2013-01-25T12:55:48.380
> 
> 标签：git, github, repository, github-for-mac

我有一个 Github 远程仓库并与我的本地仓库同步。没关系。但是现在，创建一个新目录，它有最后一个真实的文件。

如何通过 Git 更改我的本地仓库？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T12:58:50.757

我不确定你是什么意思。为什么不直接将 repo 克隆到新目录？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-01-17T17:18:53.020

我为我的 Windows 操作系统做了这个。打开 GitHub 的快捷链接。选择运行。选择右上角的链轮。选择选项... 在右侧，您应该会看到克隆路径。在这里您可以浏览到您想要的文件路径。我希望这会有所帮助，并且是您想知道的。

# c# - 与 VS 一起使用时 SOAP 服务返回错误

> ID：14522258
> 
> 赞同：0
> 
> 时间：2013-01-25T12:56:24.433
> 
> 标签：c#, soap, joomla, request, virtuemart

几天前，我开始使用 C# 客户端连接的 Joomla 和 VirtueMart 的 SOAP 服务。我尝试了一些功能，它工作正常。当我尝试使用它时，只有一个功能我遇到了错误。开发人员向我发送了一个对他有用的请求（使用我的服务器），但我只看到一些我认为不重要的不同之处......也许有人可以帮助我并向我展示可能导致麻烦的请求的重要不同之处? 这是使用 Felx 完成的工作请求（作为我无法插入 XML 的 URL： [Working Request](http://it-bergmann.de/works.xml)

这是我返回服务器故障的请求： [不工作请求](http://it-bergmann.de/error.xml)

请问有人有什么想法吗？Fiddler 也返回一个违规，但我认为在这种情况下这并不重要：内容长度不匹配：响应头指示 8.958 字节，但服务器发送 8.959 字节。

还有一个提示如何调试可能很有用。

# spring - GenericConversionService.convert() 更新到 Spring 3.2.1 后抛出 IllegalArgumentException

> ID：14522260
> 
> 赞同：2
> 
> 时间：2013-01-25T12:56:41.767
> 
> 标签：spring

将 Spring 从 3.2.0.RELEASE 更新到 3.2.1.RELEASE 后，出现以下错误：

```
[skip]
java.lang.IllegalArgumentException: The source to convert from must be an instance of @org.hibernate.validator.constraints.NotEmpty @javax.validation.constraints.Size @javax.validation.constraints.Pattern java.lang.String; instead it was a ru.mystamps.web.model.ActivateAccountForm
    at org.springframework.core.convert.support.GenericConversionService.convert(GenericConversionService.java:164)
    at org.springframework.validation.AbstractPropertyBindingResult.formatFieldValue(AbstractPropertyBindingResult.java:125)
    at org.springframework.validation.AbstractBindingResult.getFieldValue(AbstractBindingResult.java:222)
    at org.springframework.web.servlet.support.BindStatus.<init>(BindStatus.java:120)
    at org.springframework.web.servlet.tags.form.AbstractDataBoundFormElementTag.getBindStatus(AbstractDataBoundFormElementTag.java:179)
    at org.springframework.web.servlet.tags.form.AbstractDataBoundFormElementTag.getPropertyPath(AbstractDataBoundFormElementTag.java:199)
    at org.springframework.web.servlet.tags.form.LabelTag.autogenerateFor(LabelTag.java:130)
    at org.springframework.web.servlet.tags.form.LabelTag.resolveFor(LabelTag.java:120)
    at org.springframework.web.servlet.tags.form.LabelTag.writeTagContent(LabelTag.java:90)
    at org.springframework.web.servlet.tags.form.AbstractFormTag.doStartTagInternal(AbstractFormTag.java:103)
    at org.springframework.web.servlet.tags.RequestContextAwareTag.doStartTag(RequestContextAwareTag.java:80)
    at org.apache.jsp.WEB_002dINF.tiles.body.account.activate_jsp._jspx_meth_form_label_2(activate_jsp.java:667)
    at org.apache.jsp.WEB_002dINF.tiles.body.account.activate_jsp._jspService(activate_jsp.java:224)
[skip] 
```

型号声明：

```
@FieldsMismatch(first = "login", second = "password")
public class ActivateAccountForm implements ActivateAccountDto {                                    
     @Size(max = ValidationRules.LOGIN_MAX_LENGTH)
    private String login;

    ...
} 
```

控制器：

```
@RequestMapping(value = Url.ACTIVATE_ACCOUNT_PAGE, method = RequestMethod.POST)                 
public String processActivationForm(@Valid ActivateAccountForm form, BindingResult result) {
    ...
} 
```

在这种情况下我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T01:42:07.693

这听起来像是一个潜在的错误，但我无法复制它。您能否提供有关[https://jira.springsource.org/browse/SPR-10243的更多信息](https://jira.springsource.org/browse/SPR-10243)

# .net - 部署新的 CSS 或 JavaScript 文件后，如何确保客户端浏览器缓存已刷新？

> ID：14522262
> 
> 赞同：3
> 
> 时间：2013-01-25T12:56:44.597 元素
> 
> 标签：.net, iis, browser-cache, bundling-and-minification, web-optimization

我正在使用`Microsoft ASP.NET Web Optimization Framework`

您可能知道，它可以将所有 JS/CSS 连接到单个文件中。您可以在配置中定义输出文件名，并确保用户浏览器将获取更新的 JS/CSS，它添加了类似的参数`v=yUVjELgc9foFnhZgsvMfx2DhVRLKWK-w69IoCVhJ_aM1`

链接看起来像：

```
src="/scripts/js/jquery?v=yUVjELgc9foFnhZgsvMfx2DhVRLKWK-w69IoCVhJ_aM1" 
```

我听说并非所有浏览器都支持该参数并且不刷新缓存。

我可以确定所有浏览器都会使用这种方法更新缓存还是我必须手动生成新文件名？是否有任何表格，我可以在其中看到不支持的浏览器？

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-25T13:02:13.293

> 我听说并非所有浏览器都支持该参数并且不刷新缓存。

浏览器不需要“支持”它。

其目的是将 URL 更改为脚本。

由于 URL 不同，因此该 URL 处的资源不会被缓存。

要使该技术无法工作，浏览器必须有一个严重的错误（其中特殊的查询字符串用于缓存处理）。这会破坏大量的网络，因为（例如）在谷歌搜索“小猫”，然后搜索“小狗”会显示小狗搜索的缓存小猫结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T13:05:15.420

这**将**适用于浏览器，因为当您发送一个以前从未见过的完全不同的 URL 时，浏览器*不应该*使用缓存响应，因为它*无法*验证它是否正确。

**[RFC-2616](http://www.ietf.org/rfc/rfc2616.txt)**

> 13.1.1 缓存正确性
> 
> **正确的缓存必须使用缓存所持有的适合**请求的最新响应来响应请求

* * *

如果您仍然担心并希望坚持标准中更明确定义的内容，您还**可以**[`Last-Modified`](http://en.wikipedia.org/wiki/List_of_HTTP_header_fields)在发送这些文件时为这些文件设置标题。

浏览器发出一个请求`If-Modified-Since`，当他们请求一个旧版本时，服务器不会返回 304 Not Modified，而是返回一个新的副本，防止缓存文件被使用。

# asp.net-mvc - 在 ASP.Net MVC 3 中使用 jQgrid 发布表单

> ID：14522263
> 
> 赞同：0
> 
> 时间：2013-01-25T12:56:52.917
> 
> 标签：asp.net-mvc, asp.net-mvc-3, jqgrid

我试图将我的搜索表单发布到控制器并将 json 结果加载到 jQGrid 中。但我总是在我的控制器中得到空值。

```
public class SearchViewModel
{
public string Name{get;set;}
public string Location{get;set;}
public string EmployeeId{get;set;}
}

@model UI.ViewModel.SearchViewModel

<div id="search-panel">
    @{Html.EnableClientValidation();}
    @using (Html.BeginForm("Search", "Home", 
                 FormMethod.Post, new { id = "search-form" }))
    {
        @Html.AntiForgeryToken()
        <div class="formfield-container">
            <label>
                <span class="column">Name:</span>
                @Html.TextBoxFor(m => m.Name)
            </label>
        </div>
        <div class="formfield-container">
            <label>
                <span class="column">Emp Id:</span>
                @Html.TextBoxFor(m => m.EmployeeId)
            </label>
        </div>
        <div class="formfield-container">
            <label>
                <span class="column">Location:</span>
               @Html.TextBoxFor(m => m.Location)
            </label>
        </div>
 } 
```

这是我的 jQGrid 代码

```
jQuery("#list").jqGrid({
    //start
    url: 'Home/Search',
    datatype: "json",
    postData: {
        viewModel: function () { return $("#search-form").serialize(); }
    },
    mtype: "POST",
   //etc.. other config goes
 }); 
```

这是我的控制器代码

```
 [HttpPost]
 public JsonResult Search(SearchViewModel viewModel)
 {
  //viewModel parameter is always null
  var searchResult=//getting records from DB and preparing structure for jQGrid
  //Request["PostData"] gives json array sting of my form field and its value
  Json(searchResult);

 } 
```

我也尝试关注这篇文章。[jQgrid 在加载时发布自定义数据](https://stackoverflow.com/questions/8565848/jqgrid-posting-custom-data-on-load)。但 SearchViewModel 对象为空。

> 但我可以在 Requst["PostData"] 值中看到它作为我的表单字段名称及其值的 JSON 字符串。这意味着我的表单已成功发布到服务器，数据为 JSON 字符串。**我怎样才能直接获取那些 JSON 字符串来指导强类型模型**。

**但我可以看到 Request.Params["viewModel"] 包含表单元素详细信息**

> **任何人都可以帮助将我的表单发布为视图模型？还是我需要** ***编写自己的自定义模型绑定器？***

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T13:21:24.940

我们正在使用一个小函数将表单序列化为一个对象：

```
$.fn.serializeObject = function()
{
    var o = {};
    var a = this.serializeArray();
    $.each(a, function() {
        if (o[this.name] !== undefined) {
            if (!o[this.name].push) {
                o[this.name] = [o[this.name]];
            }
            o[this.name].push(this.value || '');
        } else {
            o[this.name] = this.value || '';
        }
    });
    return o;
}; 
```

然后在 jQgrid 中：

```
jQuery("#list").jqGrid({
    ...
    beforeRequest: GridOnBeforeRequest,
    ...
});

function GridOnBeforeRequest()
{
    var data = $("#search-form").serializeObject();
    $("#list").jqGrid('setGridParam', { postData: data });
} 
```

然后刷新网格：

```
$("#list").trigger('reloadGrid'); 
```

# c++ - 使用 OpenCV 和 C++ 更改图像上特定位置的 HSV 的 V

> ID：14522265
> 
> 赞同：0
> 
> 时间：2013-01-25T12:56:58.753
> 
> 标签：c++, opencv, hsv

我是 OpenCV 的新手，我用它来改变图像的亮度。在我的图片中，在这里：[https](https://docs.google.com/file/d/0B9LaMgEERnMxQUNKbndBODJ5TXM/edit) ://docs.google.com/file/d/0B9LaMgEERnMxQUNKbndBODJ5TXM/edit ，有一个很大的空间反映了其中一部分的氛围光。起初，我可以改变图像上的所有亮度。现在，我正在尝试减少这个空间，这意味着在图像的特定位置，使用 HSV 的 V，这里是代码：在此处输入代码

```
 Mat newImg;
cvtColor(img, newImg, CV_BGR2HSV);

imwrite("C:/Users/amanda.brito/Desktop/test.jpg", newImg);

vector<Mat> hsv_planes; 
split(newImg, hsv_planes); //geting the color plans of image
int param = -70; // the value that I'm seting for V
    for (int y = 0; y < newImg.rows; y++) {
    for (int x = 0; x < newImg.cols; x++) {

        Vec3b pixel = hsv_planes[2].at<Vec3b>(y, x);
        pixel[0] = 0;
        pixel[1] = 0;
        pixel[2] = param;

        hsv_planes[2].at<Vec3b>(y, x) = pixel;

    }
}

    merge(hsv_planes, newImg);
Mat imagem;
cvtColor(newImg, imagem, CV_HSV2BGR);

imwrite("C:/Users/amanda.brito/Desktop/final.jpg", imagem); 
```

好吧，无论发生这种情况还是什么都没有发生，或者编译器会停止程序。我已经到处看了，但没有运气。我究竟做错了什么？

从现在开始，感谢您的帮助。

# java - 何时允许对 Session 进行序列化/反序列化？

> ID：14522266
> 
> 赞同：1
> 
> 时间：2013-01-25T12:57:02.047
> 
> 标签：java, session, servlets, session-variables

分析服务器应用程序我发现了一些观点，与会话序列化和反序列化有关可能是危险的。很多地方的servlet层使用session来存储对象。

考虑顺序：

1）对象A保存到会话

2）对象A被修改

3）从会话中读取对象A作为对象B

是否有可能在 1) 和 2) 发生序列化之前，读取为 B 的对象是从 3 更改之前对象 A 的反序列化版本？

或者我保证，只要 1、2、3 发生在同一个请求中，A 和 B 就会相等？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T13:19:55.913

您的代码不应依赖于您放入会话中的对象是同一个实例，只要它们在*语义上*与方法所暗示的相同，那么这就`equals`足够了。

当然，会话可以序列化有多种原因，无论是会话在服务器重新启动后仍然存在，还是因为服务器是集群的一部分。

# javascript - javascript：一次预加载一张图片

> ID：14522277
> 
> 赞同：1
> 
> 时间：2013-01-25T12:57:38.787
> 
> 标签：javascript, jquery

我目前有一个旋转背景，可以在加载页面时预加载图像。但是，如果可能的话，我想一次预加载一张图片。

我的代码：

```
function preload(arrayOfImages) {
        $(arrayOfImages).each(function(){

            $('<img/>')[0].src = this;
        // Alternatively you could use:
        // (new Image()).src = this;
        });
    }
    $(document).ready(function () {

    var b = [<? $img = getContents(ROOT."/img/backgrounds/");
            foreach($img as $i)
            {   echo "\"" . $i . "\"";
                if($i != end($img)) echo ",";
            }
        ?>];
    preload(b);

    var r=Math.floor(Math.random()*b.length)
    $('#bg1').css("background-image", "url('/img/backgrounds/"+b[r]+"')");

    var alt = false;
    var delay = 50000;
    var speed = ((delay / 3)*2);
    var opacity = 1;

    setInterval(function() {
        var r=Math.floor(Math.random()*b.length);

        //put the individual preload code here

        switch(alt)
        {   case true:
                $('#bg1').css("background-image", "url('/img/backgrounds/"+b[r]+"')");
                $('#bg1').fadeTo(speed,opacity);
                $('#bg2').fadeOut(speed);
            break;
            case false:
                $('#bg2').css("background-image", "url('/img/backgrounds/"+b[r]+"')");
                $('#bg2').fadeTo(speed,opacity);
                $('#bg1').fadeOut(speed);
            break;
        }
        alt = !alt;
        }, delay);

    }); 
```

上面的代码工作正常。如果有更好的方法请告诉我！但否则我怎么能一次只预加载一张图片呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T13:24:19.190

```
function preload(arrayOfImages, index) {
    index = index || 0;

    if (arrayOfImages && arrayOfImages.length > index) {
        var img = new Image();
        img.onload = function() {
            console.log(arrayOfImages[index] + " loaded successfully");
            preload(arrayOfImages, index + 1);
        };
        img.src = arrayOfImages[index];
    }
} 
```

[小提琴](http://jsfiddle.net/fzaYw/)

# php - 用 PHP 字符串中的 base64 编码 id 替换电子邮件

> ID：14522286
> 
> 赞同：2
> 
> 时间：2013-01-25T12:58:11.057
> 
> 标签：php, regex, preg-replace, preg-match

我想用电子邮件的图像替换字符串中的所有电子邮件。

我已经有一个 PHP 函数来创建提供给它的文本的图像。所以我只是在寻找如何用相应的 basse64engoded 字符串替换电子邮件。

这正是我想要的：

```
"my email is example@example.com and my phone no is 349080353" 
```

我想要一个函数将上述字符串转换为以下内容：

```
my email is <img src="image.php?id=ZG5zLWFkbWluQ437yifhb2dsZS5jb20="> and my phone no is 349080353 
```

电子邮件的 id 用 编码`base64_encode`。所以，我想要一个函数来搜索和替换带有以下 img 标签的电子邮件，并对每封电子邮件进行编码`base64_encode`并将其提供给“id”。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T13:19:05.647

试试这个代码

```
$email_pattern = '/[a-z0-9!#$%&\'*+\/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&\'*+\/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?/';

$html = preg_replace_callback($email_pattern, "encode_email", "my email is example@example.com and my phone no is 349080353");

echo $html;

function encode_email($matches){
    return '<img src="image.php?id='. base64_encode($matches[0]) .'">';
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T13:00:57.490

```
$content = "my email is example@example.com and my phone no is 349080353"
preg_match("/[_a-z0-9-]+(\.[_a-z0-9-]+)*@[a-z0-9-]+(\.[a-z0-9-]+)*(\.[a-z]{2,3})/i", $content, $matches);

print $matches[0]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-25T13:11:13.547

检查了这个作品:)

```
<?php 
 $string = "my email is example@example.com and my phone no is 349080353";
 $pattern = "/[^@\s]*@[^@\s]*\.[^@\s]*/";
 $replacement = '<img src="">';
 $string1 = preg_replace($pattern, $replacement, $string);
 echo $string1
?> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-05-07T10:39:58.543

```
<?php
$content = "my email is example@example.com, my 2nd email is example2@example.com and my phone no is 349080353";
$c='a-zA-Z-_0-9'; // allowed characters in domainpart
$la=preg_quote('!#$%&\'*+-/=?^_`{|}~', "/"); // additional allowed in first part (localpart)
$email="[$c$la][$c$la\.]*[^.]@[$c]+\.[$c]+";
preg_match_all("/\b$e\b/", $content, $matches);
foreach ($matches[0] as $e){
  $content = preg_replace("/\b($email)\b/", '<img src="'.base64_encode($e).'">', $content);
}
echo $content; 
```

要真正捕获所有有效的电子邮件地址，请参阅：电子邮件地址[中允许使用哪些字符？](https://stackoverflow.com/questions/2049502/what-characters-are-allowed-in-an-email-address)

# css - 模式弹出在高分辨率显示器上移动

> ID：14522287
> 
> 赞同：0
> 
> 时间：2013-01-25T12:58:12.013
> 
> 标签：css

我的网页上弹出了 AJAX 模式并更改为随页面滚动。

在简单的显示器中一切正常。但是在高分辨率显示器中，当我从模式下拉列表中选择任何项目时，它会移动。

下拉菜单甚至没有回发

Modal 是可滚动的，所以它的 X 和 Y 为 0

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T13:18:55.553

尝试固定高度和宽度值

# windows - 是否可以将 DLL 转换为 LIB 文件以避免依赖？

> ID：14522289
> 
> 赞同：1
> 
> 时间：2013-01-25T12:58:32.920
> 
> 标签：windows, dll, linker

我对链接提示感到很困惑。假设我有一个使用 dll 的应用程序，但我不想使用它，我想与 lib 静态链接并避免对 dll 的依赖。是否可以？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T13:03:45.580

如果您想要解决问题而不是一堆新问题，那么不尝试是*不可能的。*

（我已经成功完成了几次类似的工作。一个变体使用 MemoryModule 并从内存加载，另一个变体使用启发式方法来查找跨段重定位并将它们修复以重新分离代码和数据部分。两者都不像您可能向对链接提示感到困惑的人推荐的东西）。

# macros - 如何在 qtp 中调用宏脚本并在 excel 中运行该宏脚本

> ID：14522290
> 
> 赞同：0
> 
> 时间：2013-01-25T12:58:39.717
> 
> 标签：macros, qtp

我通过在excel中录制创建了一个宏脚本。现在我需要通过 QTP (Vb script) 在新打开的 excel 中运行这个宏脚本。谁能建议我，qtp中可以使用什么调用函数在excel中运行这个宏脚本？我的宏脚本是

```
Sub csi()
    ' csi Macro
    ' Keyboard Shortcut: Ctrl+c
    ActiveCell.FormulaR1C1 = "test test test "
    Range("B1").Select
End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T16:00:20.093

正如[对类似问题的回答](https://stackoverflow.com/questions/10232150/run-excel-macro-from-outside-excel-using-vbscript-from-command-line)所解释的那样，这并不是很困难：

```
Set objExcel = CreateObject("Excel.Application")
objExcel.Application.Run "test.xls!csi" 
```

或者

```
objExcel.Application.Run "test.xls!sheet1.csi" 
```

取决于宏是位于 a`module`还是位于 a 中`sheet`。

# javascript - javascript：防止第二个_blank窗口在浏览器中打开？

> ID：14522295
> 
> 赞同：1
> 
> 时间：2013-01-25T12:58:51.020
> 
> 标签：javascript, html, login, popup

当用户登录并在 html 表单上点击提交时，我正在使用 javascript 启动“shadowbox”jquery 灯箱窗口。

首先，我希望 jquery 窗口仅在成功提交时启动，而不是在不成功提交时启动。（即如果用户的电子邮件和密码正确） - 有没有办法做到这一点？

我遇到的另一个问题是此时 jquery 窗口按预期弹出，但第二个目标 _blank 窗口同时打开，因为我正在使用`'this.target = 'formpopup';'`

我试图用来`'e.preventDefault();'`阻止第二个窗口打开，这确实阻止了第二个窗口打开，但它也阻止了表单登录用户。无论如何我可以阻止第二个窗口在新窗口中打开_blank 窗口而不删除，`'this.target = 'formpopup';'`因为这是打开 jquery 窗口所必需的。

请有人告诉我该怎么做，谢谢。

HTML表格：

```
 <form id="myform" form action="login.php" method="post" class="loginform">

Email
  <input type="text" name="email" maxlength="30" />

Password
<input type="password" name="password" maxlength="30" />

<input type="image" src="../PTB1/assets/img/icons/loginarrow1.png" name="submit" class="loginbutton" value="Login" />

            </form> 
```

JAVASCRIPT：

```
<script>
    $(document).ready(function() {
    $('#myform').submit(function() {
        Shadowbox.open({
        content:    '<iframe src="loginin.php" width="500" height="300" scrolling="no" style="overflow:hidden; border:none;"></iframe>',
        player:     "html",
        height:     300,
        width:      500
    });

        this.target = 'formpopup';
          e.preventDefault();

    });
});
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T13:01:44.467

如果添加`target="aNameOfTheWindow"`，您将一遍又一遍地打开同一个窗口。

# php - move_uploaded_file 失败但权限似乎正确

> ID：14522308
> 
> 赞同：0
> 
> 时间：2013-01-25T12:59:50.113
> 
> 标签：php, linux, apache, plesk

我正在将我的网站从共享主机转移到 VPS。在我的 VPS 上进行测试时，我注意到突然之间我无法再通过网络表单上传文件了。

错误： `Warning: move_uploaded_file(/uploads/logoklein.jpg): failed to open stream: No such file or directory in /var/www/vhosts/denkproducties.nl/httpdocs/denkproducties/upload.php on line 26 Warning: move_uploaded_file(): Unable to move '/tmp/php01nhmx' to '/uploads/logoklein.jpg' in /var/www/vhosts/denkproducties.nl/httpdocs/denkproducties/upload.php on line 26`

SO上有很多关于这个的问题，它们几乎都涉及设置权限。我将 TMP 和上传目录都更改为 0777（不寒而栗），但无济于事。我知道 0777 不是明智之举，但我想确保这不是这些文件夹的权限问题。

由于唯一改变的是 VPS，我认为问题一定出在服务器上。我想也许网络服务器是以“无人”的身份运行的，所以它无法访问 tmp 文件夹。我跑了：

```
ps aux | grpe httpd 
```

这向我展示了：

```
root   27371   0.0  2.3   340860   24726  ?   SNs   12:57   0:00   /usr/sbin/httpd
apache 27372   0.0  0.9   240994    9820 ?    SN    12:57   0:00   /usr/sbin/httpd
apache 27373   0.0  1.6   341671   16700 ?    SN    12:57   0:00   /usr/sbin/httpd
apache 27374   0.0  1.6   341671   16700 ?    SN    12:57   0:00   /usr/sbin/httpd
apache 27375   0.0  1.6   341671   16700 ?    SN    12:57   0:00   /usr/sbin/httpd
apache 27376   0.0  1.6   341671   16700 ?    SN    12:57   0:00   /usr/sbin/httpd
apache 27377   0.0  1.6   341671   16700 ?    SN    12:57   0:00   /usr/sbin/httpd
apache 27378   0.0  1.6   341671   16700 ?    SN    12:57   0:00   /usr/sbin/httpd
root   27817   0.0  0.0   103244     824 tty1 S+    13:40   0:00   grep httpd 
```

顺便说一句，我的服务器正在运行 fCGI。

为了完整起见，我制作了一个带有 Web 表单的小型上传脚本：

```
$allowed_filetypes = array('.jpg','.gif','.bmp','.png'); // 这些将是通过验证的文件类型。
   $max_filesize = 1024000; // 以 BYTES 为单位的最大文件大小（当前为 1MB）。
   $upload_path = '/上传/'; // 文件将上传到的位置（当前为“上传”目录）。

   $filename = $_FILES['userfile']['name']; // 获取文件名（包括文件扩展名）。
   $ext = substr($filename, strpos($filename,'.'), strlen($filename)-1); // 从文件名中获取扩展名。

   // 检查文件类型是否允许，如果不允许则 DIE 并通知用户。
   if(!in_array($ext,$allowed_filetypes))
      die('您尝试上传的文件不被允许。');

   // 现在检查文件大小，如果文件太大，则 DIE 并通知用户。
   if(文件大小($_FILES['userfile']['tmp_name']) > $max_filesize)
      die('您尝试上传的文件太大。');

   // 检查是否可以上传到指定路径，如果不行就DIE通知用户。
   //if(!is_writable($upload_path))
   // die('你不能上传到'.$upload_path .'指定目录，请CHMOD到777。');

   // 将文件上传到您指定的路径。
   if(move_uploaded_file($_FILES['userfile']['tmp_name'],$upload_path . $filename)){
         echo '您的文件上传成功，请在此处查看文件'; // 有效。
     } 别的 {
         echo '上传文件时出错。请再试一次。'; //它失败了:(。
 }

```

我在这里想念什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-02-27T02:40:59.500

评论中的 Louis Huppenbauer 对我的类似问题有正确的答案。

使用相对路径不起作用，它需要完整路径。尝试将 /uploads/ 更改为主机的完整目录，例如：D:\InetPub\Vhosts\website.com\website2.com\uploads\

# php - 使用相同的 ssh2.sftp 资源分离 PHP 进程

> ID：14522318
> 
> 赞同：2
> 
> 时间：2013-01-25T13:00:15.330
> 
> 标签：php, sftp, conflict, resource-id

我正在使用 PECL ssh2 模块将 XML 数据输出到 sftp 服务器。我有两个完全独立的 PHP 脚本，它们收集不同的数据并将输出发送到 stfp 服务器上的不同文件。

客户出口：

```
$conn = ssh2_connect(SFTP_SERVER, SFTP_PORT);
ssh2_auth_password($conn, SFTP_USER, SFTP_PWD);
$sftp = ssh2_sftp($conn);
$file = 'ssh2.sftp://' . $sftp . CUSTOMER_EXPORT_PATH . CUSTOMER_EXPORT_FILENAME;
$doc = new DOMDocument('1.0','UTF-8');
CustomerExportXML($doc);
if (file_exists($file)) {
    unlink($file);
}
$bytes_saved = $doc->save($file); 
```

产品出口：

```
$conn = ssh2_connect(SFTP_SERVER, SFTP_PORT);
ssh2_auth_password($conn, SFTP_USER, SFTP_PWD);
$sftp = ssh2_sftp($conn);
$file = 'ssh2.sftp://' . $sftp . PRODUCT_EXPORT_PATH . PRODUCT_EXPORT_FILENAME;
$doc = new DOMDocument('1.0','UTF-8');
ProductExportXML($doc);
if (file_exists($file)) {
    unlink($file);
}
$bytes_saved = $doc->save($file); 
```

在每种情况下，该`XxxExportXML($doc)`函数都需要几分钟来收集相关数据并将其填充到 $doc 中。

每个脚本都按原样工作并将正确的数据导出到正确的位置。

问题是当它们的执行重叠时，只有最后一个执行的实际写入 sftp 服务器。如果我回显 $file 变量，那么在每种情况下它们都具有相同的资源 ID `ssh2.sftp://ResourceID#150/Customer/Customer.xml`，即`ssh2.sftp://ResourceID#150/Product/Product.xml`

所以我的问题是为什么这两个进程会相互干扰，我该如何修复它以便它们可以同时运行？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T18:41:34.800

所以它们是两个不同的脚本？这很奇怪。也许尝试[phpseclib，一个纯 PHP SFTP 实现](http://phpseclib.sourceforge.net/)，而不是。例如。

```
<?php
include('Net/SFTP.php');

$sftp = new Net_SFTP('www.domain.tld');
if (!$sftp->login('username', 'password')) {
    exit('Login Failed');
}

// puts a three-byte file named filename.remote on the SFTP server
$sftp->put('filename.remote', 'xxx'); 
```

# c# - Position of Textbox

> ID：14522319
> 
> 赞同：-1
> 
> 时间：2013-01-25T13:00:20.427
> 
> 标签：c#, wpf, silverlight

How do i move Texbox inside of a Grid's Row 20px from the left? I don't care if it is done in code or in XAML. I know it seems like a simple solution, but can't find any property to do this.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T13:02:27.063

Use the [`Margin`](http://msdn.microsoft.com/en-us/library/system.windows.frameworkelement.margin.aspx) property:

```
<TextBox Margin="20,0,0,0" /> 
```

# java - 速度零点异常

> ID：14522321
> 
> 赞同：1
> 
> 时间：2013-01-25T13:00:22.367
> 
> 标签：java, spring, velocity

我想使用速度模板发送邮件。

我的配置基于 Spring 3.1 文档。

我有一个带有配置的 xml 文件：

```
<?xml version="1.0" encoding="UTF-8"?> 
```

http://www.springframework.org/schema/beans/spring-beans-3.1.xsd">

```
<bean id="sendMail" class="com.myclass.app.SendMail">
    <property name="mailSender" ref="mailSender"/>
    <property name="velocityEngine" ref="velocityEngine"/>
</bean>

<bean id="velocityEngine" class="org.springframework.ui.velocity.VelocityEngineFactoryBean">
    <property name="velocityProperties">
        <value>
            resource.loader=class
            class.resource.loader.class=org.apache.velocity.runtime.resource.loader.ClasspathResourceLoader
        </value>
    </property>
</bean> 
```

然后我上课：

```
@Controller
public class SendMail{

    private static final Logger logger = Logger.getLogger(SendMail.class);

    private JavaMailSender mailSender;
    private VelocityEngine velocityEngine;

    public void setMailSender(JavaMailSender mailSender) {
        this.mailSender = mailSender;
    }

    public void setVelocityEngine(VelocityEngine velocityEngine) {
        this.velocityEngine = velocityEngine;
    }

    @RequestMapping(value = "/sendEmail", method = RequestMethod.GET)
    public @ResponseBody void send(){

        sentEmail();

    }

    private void sentEmail(){

        try {

//            SimpleMailMessage msg = new SimpleMailMessage(mailMessage);

            MimeMessage message = mailSender.createMimeMessage();
            MimeMessageHelper helper = new MimeMessageHelper(message,
                    true, "UTF-8");
            helper.setFrom("from@from.com");
            helper.setTo("myEmail");

            helper.setSubject("title");

            Map map = new HashMap();
            map.put("user", "Piotr");
            map.put("test", "TEST");

            String text1 = VelocityEngineUtils.mergeTemplateIntoString(
                    velocityEngine, "velocity.vm", map );

            logger.info(text1);

            String text = "test";

                helper.setText(text, true);

            mailSender.send(message);

        } catch (Exception ex) {
            System.out.println(ex.getStackTrace());
            System.out.println(ex.getMessage());
        }

    }

} 
```

我的 vm 文件位于“资源”文件夹中。

而我收到的所有id都是“Null point Exception”；

回应并没有给我更多。

你有什么想法，怎么办？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T13:33:28.430

您的模板不能在资源中，它们需要在您可以在 applicationContext.xml 的 velocityEngine 中配置的类路径中：

```
<bean id="mailSender" class="org.springframework.mail.javamail.JavaMailSenderImpl">
  <property name="host" value="ADDRESS_OF_YOUR_SMTP_SERVER"/>
  <property name="defaultEncoding" value="UTF-8"/>
  <property name="port" value="XX_PORT_SERVER"/>
  <property name="javaMailProperties">  
      <props>
        <prop key="mail.smtps.auth">false</prop> <!-- depending on your smtp server -->
        <prop key="mail.smtp.starttls.enable">false</prop>
      </props>
  </property>
</bean>

<bean id="velocityEngine" class="org.springframework.ui.velocity.VelocityEngineFactoryBean" p:resourceLoaderPath="classpath:META-INF/velocity" /> 
```

不要忘记命名空间 xmlns:p="http://www.springframework.org/schema/p" 以使用上面示例的属性。

在您的 Java 类 SendMail 中，不要忘记添加注释 @Autowired ：

```
@Autowired
public void setMailSender(JavaMailSender mailSender) {
    this.mailSender = mailSender;
}

@Autowired
public void setVelocityEngine(VelocityEngine velocityEngine) {
    this.velocityEngine = velocityEngine;
} 
```

最后，要发送您的电子邮件，请使用 MimeMessagePreparator：

```
 MimeMessagePreparator preparator = new MimeMessagePreparator() {
            @Override
            public void prepare(MimeMessage mimeMessage) throws Exception {
               MimeMessageHelper message = new MimeMessageHelper(mimeMessage);
               message.setTo("blabla@test.com");
               message.setSubject("Email test");

               String text = VelocityEngineUtils.mergeTemplateIntoString(
                   velocityEngine, template, keywords);
               message.setText(text, true);

             }
          };

          //Send email using the autowired mailSender
          this.mailSender.send(preparator); 
```

# c++ - 在 C++ Firemonkey 平台中克隆对象

> ID：14522322
> 
> 赞同：1
> 
> 时间：2013-01-25T13:00:26.540
> 
> 标签：c++, delphi, components, firemonkey, cloning

我正在 embarcadero 的 Firemonkey XE2 平台上创建（用于学习目的）一个 2D 游戏。就游戏领域的视觉表现而言，这是一款类似于太空侵略者的游戏，但要复杂得多。

我正在尝试生成动画敌人。我创建了一个模板 TImage 并为其分配了一个带有六张图片的 BitmapListAnimation。然后我只是使用 Clone() 克隆它。这是克隆代码：

```
virtual void CreateMe(TForm* pForm);
void CBaseEnemy::CreateMe(TForm *pForm)
{
    TImage* pSource = dynamic_cast<TImage*>(this->pToClone);
    pSource->Visible = true;
    TImage* pDest = dynamic_cast<TImage*>(pSource->Clone(pForm));
    pDest->Parent = pForm;

    TBitmapListAnimation* pAnimSource = dynamic_cast<TBitmapListAnimation*>(pForm->FindComponent("BitmapListAnimation1"));
    pAnimSource->Parent = pDest;
    pAnimSource->Start();
    TBitmapListAnimation* pAnimDest = dynamic_cast<TBitmapListAnimation*>(pAnimSource->Clone(pForm));
} 
```

它可以工作，只是非常复杂，您能否建议一种克隆整个模板的方法（一个组件，例如 TImage 及其所有子组件）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T16:06:49.097

刚刚发布的 Embarcadero 博客文章涵盖了以下内容：[博客](http://blogs.embarcadero.com/vsevolodleonov/2013/02/06/clone-firemonkey-objects/)

# angularjs - 在 AngularJS 中设置 JSONP 回调函数

> ID：14522336
> 
> 赞同：3
> 
> 时间：2013-01-25T13:01:28.920
> 
> 标签：angularjs, jsonp

我正在尝试通过 Angular $resource 服务从 Web API 获取数据。该服务公开 JSONP 接口，但不允许设置回调名称。一切正常，我的请求发出，数据返回，脚本被注入，然后由于未定义回调函数而失败。

Angular 文档在这方面非常稀疏，但 Angular 设置的默认回调函数似乎是：`JSON_CALLBACK`，并且没有信息如何更改它以匹配外部 API 返回的函数。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T21:39:51.303

我认为没有任何规定可以覆盖该回调。

$resource 是基于 $http 服务的高级 Restful api。

您可以使用 $http apis 返回 http 承诺对象并让您编写成功回调，您可以在其中处理从 ajax 请求返回的数据。

[例如 http://docs.angularjs.org/api/ng.$http#jsonp](http://docs.angularjs.org/api/ng.%24http#jsonp)

# javascript - jQuery 动画

> ID：14522337
> 
> 赞同：3
> 
> 时间：2013-01-25T13:01:34.187
> 
> 标签：javascript, jquery, animation

这是简单的上滑动画。问题是当我更改 myDiv 类的“top”参数时，动画工作不正确，它不是向上滑动，而是从顶部向下滑动。只有当我第一次单击按钮时它才能正常工作。当我将 myDiv 的顶部参数更改为更大的数字时，就没有问题了。你能帮我找出代码有什么问题吗？

```
 <style>
    .box {
        position:relative;
        width: 200px;
        height: 500px;
    }
    .myDiv {
        position: absolute;
        width:100%;
        overflow: hidden;
        bottom:0px;
        top:10px;
        left:500;
    }
</style>
<script>
    var swt = 0;
    $(document).ready(function () {
        $(".b1").click(function () {

            var div = $(".myDiv");
            if (swt == 0) {
                div.animate({
                    top: '300px',
                    opacity: '1'
                }, "slow");
                //  div.animate({height:'300px', opacity:'1'},"slow");
                swt++;
            } else {
                div.animate({
                    top: '500px',
                    opacity: '1'
                }, "slow");
                //  div.animate({height:'0px', opacity:'1'},"slow");
                swt--;
            }
        });
    });
</script>
</head>
<body>
    <button class="b1">Start Animation</button>
    <p>posds</p>
    <div class="box">
        <div class="myDiv" style="background:#7549B1; width:200px;"></div>
    </div>
</body>

</html> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-25T13:10:39.583

我不太确定你想要什么效果，但也许它正在改变`bottom`值而不是`top`：

```
if(swt==0){
    div.animate({bottom:'500px', opacity:'1'}, "slow");
    swt++;  
} else {
    div.animate({bottom:'300px', opacity:'1'}, "slow");
    swt--;
} 
```

[http://jsbin.com/ixigaf/1/edit](http://jsbin.com/ixigaf/1/edit)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-25T13:12:02.153

不要在同一个元素上使用`bottom`and `top`，会产生冲突。用负值定义高度和动画顶部：

[**这是jsFiddle。**](http://jsfiddle.net/thGFN/11/)

```
if(swt==0){
       div.animate({top:'-300px', opacity:'1'}, "slow");
        swt++;  
}else{
      div.animate({top:'-500px', opacity:'1'}, "slow");
        swt--;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-25T13:18:27.707

[http://jsfiddle.net/Cyber​​ek/yLBeK/](http://jsfiddle.net/Cyberek/yLBeK/)

据我了解，这是错误的，但是如果您将 css 顶部从 10px 更改为 100px（与 js 中的顶部相同），一切都应该没问题。

```
.myDiv {
        position: absolute;
        width:100px;
        height: 100px;
        overflow: hidden;
        top:100px;
        left:100px;
        background: red;
}

$(".b1").click(function () {

            var div = $(".myDiv");
            if (swt == 0) {
                div.animate({
                    top: '100px',
                    opacity: '1'
                }, "slow");
                //  div.animate({height:'300px', opacity:'1'},"slow");
                swt++;
            } else {
                div.animate({
                    top: '200px',
                    opacity: '1'
                }, "slow");
                //  div.animate({height:'0px', opacity:'1'},"slow");
                swt--;
            }
        }); 
```

# android - 如何在Android后台运行OpenCV实时物体识别

> ID：14522346
> 
> 赞同：1
> 
> 时间：2013-01-25T13:02:12.307
> 
> 标签：android, opencv

我设法创建了一个可以实时识别对象的应用程序，但现在我真的很难在后台运行它，例如当用户按下主页按钮并尝试运行另一个应用程序时。我正在使用 OpenCV，我的解决方案基于人脸检测示例，您可以在其中训练级联分类器，全部用 Java 编码。有什么建议么？很多谢谢。

# ruby - 如何在红宝石中跳过要求？

> ID：14522350
> 
> 赞同：2
> 
> 时间：2013-01-25T13:02:32.790
> 
> 标签：ruby, rubygems, require

我可以有条件地跳过需要 Ruby 中的文件吗？

```
begin
  require 'aws-sdk'
rescue LoadError
  puts "aws-sdk gem not found"
end

namespace :db do
  desc "import local postgres database to heroku. user and database name is hardcoded"
  task :import_to_heroku => [:environment, "db:dump_for_heroku"] do
    # code using aws-sdk gem
  end
end 
```

在上面的代码中，我可以要求 Ruby 在`rescue LoadError`
我可以将整个代码包装在条件中之后不要阅读，但这很不优雅。我试过`next`了`return`。

编辑：在[我可以有条件地跳过在同一个文件中加载“更多”红宝石代码吗？](https://stackoverflow.com/questions/14526268/can-i-conditionally-skip-loading-further-ruby-code-in-the-same-file). 对不起。没有正确地问这个问题

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-25T13:04:34.510

也许`exit`在日志之后添加一个：

```
begin
  require 'aws-sdk'
rescue LoadError
  puts "aws-sdk gem not found"
  exit
end

namespace :db do
  desc "import local postgres database to heroku. user and database name is hardcoded"
  task :import_to_heroku => [:environment, "db:dump_for_heroku"] do
    # code using aws-sdk gem
  end
end 
```

此外，中止功能是在同一个调用中记录和退出：

```
abort("aws-sdk gem not found") 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-25T14:51:36.823

> 我已经救出了 LoadError，但我希望如果 LoadError 被执行，则不应执行进一步的代码。在给出的示例中，不应调用 rake 任务 db:import_to_heroku

然后做：

```
begin
  require 'aws-sdk'

  namespace :db do
    desc "import local postgres database to heroku. user and database name is hardcoded"
    task :import_to_heroku => [:environment, "db:dump_for_heroku"] do
      # code using aws-sdk gem
    end
  end
rescue LoadError
  puts "aws-sdk gem not found"
end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-01-31T17:01:49.940

[新增](https://bugs.ruby-lang.org/issues/4840)“顶级回归”功能。

现在可以`return`在顶层使用关键字，正如您所说，在提出问题时它不起作用。[在这里进一步讨论](https://stackoverflow.com/questions/34347134/is-it-possible-to-conditionally-stop-ruby-from-evaluating-a-required-file-withou)。

# sql - 将存储过程的结果附加到先前执行的存储过程

> ID：14522351
> 
> 赞同：3
> 
> 时间：2013-01-25T13:02:35.440
> 
> 标签：sql, sql-server, sql-server-2005

我有一个存储过程，它接受一个包含单个值的参数。我想将一组值一个一个地传递给过程，并将组合结果放入一个表中。这可能吗 ？

目前我正在使用游标在循环中执行过程，但只能获得传递集合中第一个值的结果。

```
declare @clientid varchar(10)

create table #tmpp(secid varchar(10))
insert into #tmpp values(2319)
insert into #tmpp values(2855)
insert into #tmpp values(1303)

    declare cur CURSOR LOCAL for
        select secid from #tmpp 

    open cur

    fetch next from cur into @seclientid

    while @@FETCH_STATUS = 0 BEGIN

    exec getReportforclient @clientid
        fetch next from cur into @clientid
    END

    close cur
    deallocate cur
    drop table #tmpp 
```

如果这太模糊/不清楚/愚蠢，有人可以为我提供替代方案吗？非常感谢任何帮助。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T13:09:16.047

可能有一种不使用游标的方法，但是如果不查看您的存储过程，我们对此无能为力。您可以创建一个与您的 sp 结果具有相同结构的表（临时或非临时）并将结果插入其中。像这样的东西：

```
DECLARE @clientid VARCHAR(10)

CREATE TABLE #tmpp(secid VARCHAR(10))
INSERT INTO #tmpp VALUES(2319)
INSERT INTO #tmpp VALUES(2855)
INSERT INTO #tmpp VALUES(1303)

CREATE TABLE #Results(col1 INT, col2.... -- create the table that will hold your 
                                         -- results

DECLARE cur CURSOR LOCAL for
SELECT secid 
FROM #tmpp 

OPEN cur
FETCH NEXT FROM cur INTO @seclientid
WHILE @@FETCH_STATUS = 0 
BEGIN
    INSERT INTO #Results
    exec getReportforclient @clientid

    FETCH NEXT FROM cur INTO @clientid
END

CLOSE cur
DEALLOCATE cur
DROP TABLE #tmpp

SELECT *
FROM #Results 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-25T17:30:29.617

没有 CURSOR 的循环

```
IF OBJECT_ID('tempdb.dbo.#tmpp') IS NOT NULL DROP TABLE #tmpp   
CREATE TABLE #tmpp(Clientid varchar(10))
INSERT #tmpp values(2319), (2855), (1303)

IF OBJECT_ID('tempdb.dbo.#Results') IS NOT NULL DROP TABLE #Results  
CREATE TABLE #Results(--output columns of procedure)                                        

DECLARE @Clientid int = (SELECT MIN(Clientid) FROM #tmpp)

WHILE (@Clientid IS NOT NULL)
BEGIN  
  INSERT INTO #Results
  EXEC getReportforclient @Clientid   
SELECT @Clientid = MIN(Clientid) FROM #tmpp WHERE Clientid > @Clientid
END 
```

[**SQLFiddle**](http://sqlfiddle.com/#!3/7ef6e/3/0)上的简单示例[](http://sqlfiddle.com/#!3/7ef6e/3/0)

# javascript - 正则表达式无法正常工作

> ID：14522355
> 
> 赞同：0
> 
> 时间：2013-01-25T13:02:50.990
> 
> 标签：javascript, regex

我对 JavaScript 正则表达式有疑问。我已经在这个网站上对其进行了测试，它工作正常 - [http://www.pagecolumn.com/tool/regtest.htm](http://www.pagecolumn.com/tool/regtest.htm)。

```
 var str = "Stalowa Wola;Nisko;Rzeszow";
     var re = new RegExp("Stalowa Wola[a-zA-Z\W]*Rzeszow", "i");
     var myArray = str.match(re);
     console.log(myArray); 
```

但是当我尝试在我的网站上运行此代码时，它不起作用。控制台返回“null”，我不知道为什么。我注意到当我从 RegExp 中删除 'Rzeszow' 时，它开始工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T13:04:43.503

```
var str = "Stalowa Wola;Nisko;Rzeszow";
var re = new RegExp("Stalowa Wola[a-zA-Z\\W]*Rzeszow", "i");
var myArray = str.match(re);
console.log(myArray); 
```

您需要转义反斜杠。

或者使用此表示法：

```
var str = "Stalowa Wola;Nisko;Rzeszow";
var re = /Stalowa Wola[a-zA-Z\W]*Rzeszow/i;
var myArray = str.match(re);
console.log(myArray); 
```

缺点是您必须在运行前了解正则表达式的结构。

[http://www.regular-expressions.info/javascript.html](http://www.regular-expressions.info/javascript.html)

# zooming - 使用 -ms-content-zooming 使内容居中

> ID：14522361
> 
> 赞同：2
> 
> 时间：2013-01-25T13:03:02.630
> 
> 标签：zooming, image, center, winjs, winapp

我一直在使用此示例创建“可缩放”内容： [http ://code.msdn.microsoft.com/windowsapps/Scrolling-panning-and-47d70d4c](http://code.msdn.microsoft.com/windowsapps/Scrolling-panning-and-47d70d4c)

我的 HTML：

```
<div id="zoomElement" class="zoomElement ManipulationContainer">
    <img id="zoomContent" class="zoomContent" alt="" src="sample.jpg" />
</div> 
```

我的 CSS：

```
.zoomElement {
    overflow: auto;
    -ms-content-zooming: zoom;
    -ms-scroll-rails: none;
    -ms-content-zoom-limit-min: 20%;
    -ms-content-zoom-limit-max: 500%;
} 
```

现在，无论如何，当 img 未缩放时，我无法将其居中放在其容器中。

# android - 在 Android CDT 中添加外部库

> ID：14522362
> 
> 赞同：3
> 
> 时间：2013-01-25T13:03:07.487
> 
> 标签：android, eclipse-cdt

我正在使用带有 CDT 8.0.2.+NDK 支持的 Linux 的 android ADT 包。我需要添加一个外部库。我在这里查看了 Eclipse 论坛，例如：

[链接外部库](http://wiki.eclipse.org/CDT/User/FAQ#How_do_I_add_an_external_library_to_my_C.2B.2B_project.3F)

问题是看起来 Android CDT 没有相同的设置。这三种解决方案都不能应用。

有没有人找到在 Eclipse 中使用 CDT 添加外部 .so 库的方法？

在添加 Native spport 之前，我曾经在 libs 文件夹中有 .so 文件。现在每次构建项目时都会清除 libs 文件夹。所以我需要把它放在别的地方。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T17:21:50.510

我设法通过将以下行添加到 Android.mk 来做到这一点

包括 $(CLEAR_VARS)

LOCAL_MODULE:=库名

LOCAL_SRC_FILES:= path-to-lib/libname.so

包括 $(PREBUILT_SHARED_LIBRARY)

# java - 理解 Java 对“闭包”的近似

> ID：14522363
> 
> 赞同：4
> 
> 时间：2013-01-25T13:03:07.540
> 
> 标签：java, closures

所以，这就是我的理解：Java 不支持闭包，因此它会将变量从包含范围复制到嵌套范围中，以便以后可以使用。因为这是一个副本，所以无法同步原始和副本，并且变量被强制为最终变量，因此开发人员无法更改它并期望它被更新。这种理解部分来自这些[答案](https://stackoverflow.com/questions/1299837/cannot-refer-to-a-non-final-variable-inside-an-inner-class-defined-in-a-differen)

这将我们带到了这段代码的工作中：

```
public class SimpleClosure {

    public static void main(String[] args) {
        new SimpleClosure().doStuff();
    }

    public void doStuff() {
        final int number = 3;

        new Thread() {
            @Override
            public void run() {
                try {
                    Thread.sleep(1000);
                } catch (InterruptedException e) {
                    e.printStackTrace();
                }
                System.out.println(Integer.toString(number));
            }
        }.start();
    }
} 
```

很好。现在，问题是，最终修饰符只会阻止我更改变量指向的对象，但我可以毫无问题地更改对象。如果进行了“复制”，则不应反映对对象内容的更改。因此，问题是，为什么下面的代码有效？

```
import java.util.HashMap;
import java.util.Map;

public class StretchingClosure {

    public static void main(String[] args) {
        new StretchingClosure().doStuff();
    }

    public void doStuff() {
        final Map<String, String> map = new HashMap<String, String>();
        map.put("animal", "cat");

        new Thread() {
            @Override
            public void run() {
                try {
                    Thread.sleep(1000);
                } catch (InterruptedException e) {
                    e.printStackTrace();
                }
                System.out.println(map.get("animal")); // Outputs dog See (1)
            }
        }.start();
        map.put("animal", "dog");
    }
} 
```

不用说，我遗漏了一些东西，或者我过度简化了编译器处理这些情况的方式。有人可以请教我吗？

(1)：正如@trashgod 所指出的，在大多数平台上大部分时间输出都是正确的，但由于缺乏同步，不能保证。这对于示例来说已经足够了，但通常是不好的做法。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-25T13:08:54.447

不要将变量与对象混淆：确实复制了局部变量的**引用，但它仍然引用同一个对象，在您的情况下是映射。**有一个广为人知的习语可以解决这个`final`限制，涉及数组：

```
final int[] x = {1};
... use in an anonymous instance...
System.out.println(x[0]); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-25T13:06:49.803

Java 在那里执行与常规方法参数相同的操作：

方法参数通过引用值传递，因此虽然您无法更改对象本身，但如果它是可变的并提供了改变其内部状态的方法，您可以更改该状态。例如，您不能更改字符串，但可以更改集合中的项目。

引用按值传递 = 引用被复制。对象本身不是。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-25T13:24:26.807

该评论`// Outputs dog`具有误导性，因为它在大多数平台上的大部分时间都是正确的。`Map`一秒钟是在初始线程上更新的充足时间，但除非对共享数据的访问正确同步，否则无法保证匿名线程中更新值的*可见性。*有关. [*_*](http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/package-summary.html#MemoryVisibility) _`java.util.concurrent`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-25T13:06:45.583

匿名类不获取变量的副本，而是获取对象引用的副本，这就是为什么在 1s 之后您会获得在匿名类之外更改的“正确”值。

# jquery - 可缩放的 div 网格以适应浏览器大小

> ID：14522366
> 
> 赞同：0
> 
> 时间：2013-01-25T13:03:22.407
> 
> 标签：jquery, css, scalability

我正在努力创建一个可扩展的 div / 图像网格，该网格将根据浏览器的大小进行调整，如下所示：[http](http://svla.co/)
://svla.co/我不知道是否可以使用 CSS 并且可能需要 jQuery，我完全不确定。这是我的代码：

```
<div id="journal-overview">
    <a href="#"><div class="journal-thumbs" style="background-color: #f3f3f4; width: 315px; height: 196px"></div></a>
    <a href="#"><div class="journal-thumbs" style="background-color: #f3f3f4; width: 315px; height: 196px"></div></a>
    <a href="#"><div class="journal-thumbs" style="background-color: #f3f3f4; width: 315px; height: 196px"></div></a>
    <a href="#"><div class="journal-thumbs" style="background-color: #f3f3f4; width: 315px; height: 196px"></div></a>
    <a href="#"><div class="journal-thumbs" style="background-color: #f3f3f4; width: 315px; height: 196px"></div></a>
    <a href="#"><div class="journal-thumbs" style="background-color: #f3f3f4; width: 315px; height: 196px"></div></a>
    <a href="#"><div class="journal-thumbs" style="background-color: #f3f3f4; width: 315px; height: 196px"></div></a>
    <a href="#"><div class="journal-thumbs" style="background-color: #f3f3f4; width: 315px; height: 196px"></div></a>
    <a href="#"><div class="journal-thumbs" style="background-color: #f3f3f4; width: 315px; height: 196px"></div></a>
    <a href="#"><div class="journal-thumbs" style="background-color: #f3f3f4; width: 315px; height: 196px"></div></a>
    <a href="#"><div class="journal-thumbs" style="background-color: #f3f3f4; width: 315px; height: 196px"></div></a>
    <a href="#"><div class="journal-thumbs" style="background-color: #f3f3f4; width: 315px; height: 196px"></div></a>
    <a href="#"><div class="journal-thumbs" style="background-color: #f3f3f4; width: 315px; height: 196px"></div></a>
</div> 
```

还有一个 jsfiddle：http: [//jsfiddle.net/KgpTT/](http://jsfiddle.net/KgpTT/)
任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T13:30:51.283

如果您的目标浏览器支持它，请查看新的 CSS flexbox 功能。它将处理这个早餐用例，不仅包括重新布局，还包括动态调整各个元素的大小。请参阅[http://www.w3.org/TR/css3-flexbox/](http://www.w3.org/TR/css3-flexbox/)。它本质上支持响应式设计。您的问题可能会通过`display: flex;`在容器上放置 CSS 属性这样简单的方法来解决。即使您不能将其用于此项目，也值得一看。

# wpf - XAML 中的样式不起作用

> ID：14522371
> 
> 赞同：0
> 
> 时间：2013-01-25T13:03:40.090
> 
> 标签：wpf, xaml, button, styles, tabitem

为什么它的颜色`TabItems`总是黑色的？我想要`Background`黑白字母。也`Button`应该是白色的，但它也是黑色的并且不可见。有一些冲突，但找不到在哪里。有任何想法吗？提前感谢您的帮助。

```
<UserControl x:Class="Test.Test"
         xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
         xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
         xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
         xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
         xmlns:i="http://schemas.microsoft.com/expression/2010/interactivity"
         xmlns:cal="http://www.caliburnproject.org"   
         xmlns:cm="clr-namespace:Caliburn.Micro;assembly=Caliburn.Micro"
         mc:Ignorable="d" d:DesignHeight="252" d:DesignWidth="894" Background="#FF111111">    

<Grid>        
    <TextBlock HorizontalAlignment="Left" TextWrapping="Wrap" VerticalAlignment="Top" Foreground="White" FontSize="48" Margin="70,-14.668,0,0" FontWeight="Light"><Run Language="de-at" Text="test test"/></TextBlock>
    <Button x:Name="Close" Content="➔" HorizontalAlignment="Left" VerticalAlignment="Top" Width="58" Foreground="White" Height="58" RenderTransformOrigin="0.5,0.5" FontSize="40" Margin="-7.625,-8,0,0" Padding="1,-5,1,1" Clip="M50.333,8 L-1.667,8 L-1.667,59.843 L50.333,59.843 z" cm:Message.Attach="Close()">
        <Button.RenderTransform>
            <TransformGroup>
                <ScaleTransform ScaleY="1" ScaleX="-1"/>
                <SkewTransform AngleY="0" AngleX="0"/>
                <RotateTransform Angle="0"/>
                <TranslateTransform/>
            </TransformGroup>
        </Button.RenderTransform>
    </Button>

    <TabControl Margin="42,52,0,0">
        <TabItem Header="Start">

        </TabItem>
            <TabItem Foreground="White" Header="Start 1" >

        </TabItem>
        <TabItem Foreground="White" Header="Start 1">

        </TabItem>
        <TabItem Foreground="White" Header="Start 1">

        </TabItem>
        <TabItem Foreground="White" Header="Start 1">

        </TabItem>
    </TabControl>       
</Grid> 
```

我尝试了很多东西，但没有奏效。所以我所做的就是在`TextBlock`里面放一个`TabItem.Header`：

```
<TabItem>
    <TabItem.Header>
        <TextBlock FontSize="25" Text="Start1" />
    </TabItem.Header>
</TabItem> 
```

现在我可以更改`TextBlock`with的颜色`Foreground`。但是如果我点击 不知道如何更改`TextBlock`颜色`TabItem`。也许我应该为此开一个新话题。感谢大家的贡献。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T14:37:56.907

您根本没有设置您的`Background`或`Foreground`属性`TabControl`，因此它使用默认颜色。

`Background`任何`Control`对象的属性的默认颜色是`Brushes.Transparent`（[source](http://msdn.microsoft.com/en-us/library/system.windows.controls.control.background.aspx)），而默认`Foreground`属性基于您的系统颜色（[source](http://msdn.microsoft.com/en-us/library/system.windows.controls.control.foreground.aspx)）。

您可以使用隐式样式`UserControl.Resources`为指定类型的所有对象设置属性，例如对所有 Control 对象使用此样式：

```
<UserControl.Resources>
    <Style TargetType="{x:Type Control}">
        <Setter Property="Background" Value="Black" />
        <Setter Property="Foreground" Value="White" />
    </Style>
</UserControl.Resources> 
```

或者，如果您可以添加一个新 Brush`.Resources`并将其设置为[SystemColors](http://blogs.msdn.com/b/wpf/archive/2010/11/30/systemcolors-reference.aspx)`x:Key`之一的 System Key ，如下所示：

```
<UserControl.Resources>
    <SolidColorBrush x:Key="{x:Static SystemColors.WindowColorKey}" Color="Black"/>
    <SolidColorBrush x:Key="{x:Static SystemColors.ControlTextBrush}" Color="White"/>
</UserControl.Resources> 
```

（您可能需要进行一些测试以确定要使用的正确 SystemColors 键。您可以在[此处](http://blogs.msdn.com/b/wpf/archive/2010/11/30/systemcolors-reference.aspx)找到它们的列表）

# android - 如何从android中的图像生成直方图

> ID：14522376
> 
> 赞同：0
> 
> 时间：2013-01-25T13:03:53.597
> 
> 标签：android, histogram

我想从 Android 中的图像生成直方图。我确实在java中找到了几个例子，但我没有成功移植它。

以下是我使用的代码 - 目前我正在`NoClassDefFoundException`上课`javax.imageio.ImageIo`。

```
public static byte[] histogramEqualization(String path) {

        int red;
        int green;
        int blue;
        int alpha;
        int newPixel = 0;

        original = null;
        try {
            original = ImageIO.read(new URL(path));
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        } catch (Exception e) {
            e.printStackTrace();
        }

        // Get the Lookup table for histogram equalization
        ArrayList<int[]> histLUT = histogramEqualizationLUT(original);

        BufferedImage histogramEQ = new BufferedImage(original.getWidth(), original.getHeight(), original.getType());

        for(int i=0; i<original.getWidth(); i++) {
            for(int j=0; j<original.getHeight(); j++) {

                // Get pixels by R, G, B
                alpha = new Color(original.getRGB (i, j)).getAlpha();
                red = new Color(original.getRGB (i, j)).getRed();
                green = new Color(original.getRGB (i, j)).getGreen();
                blue = new Color(original.getRGB (i, j)).getBlue();

                // Set new pixel values using the histogram lookup table
                red = histLUT.get(0)[red];
                green = histLUT.get(1)[green];
                blue = histLUT.get(2)[blue];

                // Return back to original format
                newPixel = colorToRGB(alpha, red, green, blue);

                // Write pixels into image
                histogramEQ.setRGB(i, j, newPixel);

            }
        }

      //create a ByteArrayOutputStream
        ByteArrayOutputStream baos = new ByteArrayOutputStream();
        byte[] imageInByte = null;
        //write our image to it
        try {
            ImageIO.write( histogramEQ, "png", baos );
             //flush the stream
            baos.flush();

            //get the image in byte form
            imageInByte = baos.toByteArray();

            //close the stream
            baos.close();
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }

//        return histogramEQ;
        return imageInByte;

    }

    // Get the histogram equalization lookup table for separate R, G, B channels
    public static ArrayList<int[]> histogramEqualizationLUT(BufferedImage input) {

        // Get an image histogram - calculated values by R, G, B channels
        ArrayList<int[]> imageHist = imageHistogram(input);

        // Create the lookup table
        ArrayList<int[]> imageLUT = new ArrayList<int[]>();

        // Fill the lookup table
        int[] rhistogram = new int[256];
        int[] ghistogram = new int[256];
        int[] bhistogram = new int[256];

        for(int i=0; i<rhistogram.length; i++) rhistogram[i] = 0;
        for(int i=0; i<ghistogram.length; i++) ghistogram[i] = 0;
        for(int i=0; i<bhistogram.length; i++) bhistogram[i] = 0;

        long sumr = 0;
        long sumg = 0;
        long sumb = 0;

        // Calculate the scale factor
        float scale_factor = (float) (255.0 / (input.getWidth() * input.getHeight()));

        for(int i=0; i<rhistogram.length; i++) {
            sumr += imageHist.get(0)[i];
            int valr = (int) (sumr * scale_factor);
            if(valr > 255) {
                rhistogram[i] = 255;
            }
            else rhistogram[i] = valr;

            sumg += imageHist.get(1)[i];
            int valg = (int) (sumg * scale_factor);
            if(valg > 255) {
                ghistogram[i] = 255;
            }
            else ghistogram[i] = valg;

            sumb += imageHist.get(2)[i];
            int valb = (int) (sumb * scale_factor);
            if(valb > 255) {
                bhistogram[i] = 255;
            }
            else bhistogram[i] = valb;
        }

        imageLUT.add(rhistogram);
        imageLUT.add(ghistogram);
        imageLUT.add(bhistogram);

        return imageLUT;

    }

    private static int colorToRGB(int alpha, int red, int green, int blue) {

        int newPixel = 0;
        newPixel += alpha; newPixel = newPixel << 8;
        newPixel += red; newPixel = newPixel << 8;
        newPixel += green; newPixel = newPixel << 8;
        newPixel += blue;

        return newPixel;

    }

    public static ArrayList<int[]> imageHistogram(BufferedImage input) {

        int[] rhistogram = new int[256];
        int[] ghistogram = new int[256];
        int[] bhistogram = new int[256];

        for(int i=0; i<rhistogram.length; i++) rhistogram[i] = 0;
        for(int i=0; i<ghistogram.length; i++) ghistogram[i] = 0;
        for(int i=0; i<bhistogram.length; i++) bhistogram[i] = 0;

        for(int i=0; i<input.getWidth(); i++) {
            for(int j=0; j<input.getHeight(); j++) {

                int red = new Color(input.getRGB (i, j)).getRed();
                int green = new Color(input.getRGB (i, j)).getGreen();
                int blue = new Color(input.getRGB (i, j)).getBlue();

                // Increase the values of colors
                rhistogram[red]++; ghistogram[green]++; bhistogram[blue]++;

            }
        }

        ArrayList<int[]> hist = new ArrayList<int[]>();
        hist.add(rhistogram);
        hist.add(ghistogram);
        hist.add(bhistogram);

        return hist;

    } 
```

这是我得到的错误。

```
01-25 18:05:37.548: E/AndroidRuntime(3514): FATAL EXCEPTION: main
01-25 18:05:37.548: E/AndroidRuntime(3514): java.lang.NoClassDefFoundError: javax.imageio.ImageIO
01-25 18:05:37.548: E/AndroidRuntime(3514):     at com.example.histogramsample.MainActivity.histogramEqualization(MainActivity.java:57)
01-25 18:05:37.548: E/AndroidRuntime(3514):     at com.example.histogramsample.MainActivity.onCreate(MainActivity.java:33)
01-25 18:05:37.548: E/AndroidRuntime(3514):     at android.app.Activity.performCreate(Activity.java:4465)
01-25 18:05:37.548: E/AndroidRuntime(3514):     at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1053)
01-25 18:05:37.548: E/AndroidRuntime(3514):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1934)
01-25 18:05:37.548: E/AndroidRuntime(3514):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1995)
01-25 18:05:37.548: E/AndroidRuntime(3514):     at android.app.ActivityThread.access$600(ActivityThread.java:128)
01-25 18:05:37.548: E/AndroidRuntime(3514):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1161)
01-25 18:05:37.548: E/AndroidRuntime(3514):     at android.os.Handler.dispatchMessage(Handler.java:99)
01-25 18:05:37.548: E/AndroidRuntime(3514):     at android.os.Looper.loop(Looper.java:137)
01-25 18:05:37.548: E/AndroidRuntime(3514):     at android.app.ActivityThread.main(ActivityThread.java:4514)
01-25 18:05:37.548: E/AndroidRuntime(3514):     at java.lang.reflect.Method.invokeNative(Native Method)
01-25 18:05:37.548: E/AndroidRuntime(3514):     at java.lang.reflect.Method.invoke(Method.java:511)
01-25 18:05:37.548: E/AndroidRuntime(3514):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:790)
01-25 18:05:37.548: E/AndroidRuntime(3514):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:557)
01-25 18:05:37.548: E/AndroidRuntime(3514):     at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-04T04:00:23.160

javax.imageio.ImageIO 是来自 JRE 的一个类，它在 Dalvik 机器中不存在。因此，您的代码将在传统的 Java 机器（我的意思是 JRE）上运行，而不是在 Android 上运行。解决方案：

1.  尝试在 Android 上找到 ImageIO 的包装类。
2.  为自己编写一个类，就像 ImageIO 一样，它完全符合您的要求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T13:08:58.080

这一行：

```
java.lang.NoClassDefFoundError: javax.imageio.ImageIO 
```

表明您没有将所有正确的代码库链接到您的项目。您需要确保此类可用。

# mysql - mysql_close 不工作

> ID：14522378
> 
> 赞同：0
> 
> 时间：2013-01-25T13:04:06.997
> 
> 标签：mysql, database, mysql-connect

我想使用 mysql_close() 关闭打开的连接，但是当我进入服务器并检查服务器中打开的连接数量时，连接增加了！例如，我的 mysql 数据库中有 100 个打开的连接

我有一个包含此代码的页面：

```
<?php include "configa/configuration.php";
$con = mysql_connect($sql['host'],$sql['user'],$sql['password']);
if ($con) echo "connected<br>";
mysql_close($con);  
if (!$con) echo "disconnected";
?> 
```

每次我刷新页面时，都会初始化一个新连接，并且只有 connectid 显示在页面中。什么可能是错的

以这种方式刷新 1000 页我的 sql 服务器断开连接

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T13:14:51.580

`Connection.close()`实际上并没有从连接池中删除连接。尝试使用`Connection.Dispose()`完全释放连接。但是您无法再次打开该 dispose 连接，因此在关闭它之前要小心。

有关关闭的更多信息：[关闭](http://dev.mysql.com/doc/refman/5.0/es/connector-net-examples-mysqlconnection.html#connector-net-examples-mysqlconnection-close) 或者您可以将连接池设置为 false。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T14:33:56.660

SHOW STATUS 中的“Connections”值本质上是 MySQL 服务器自启动以来已建立的连接数的计数器；这不是当前打开的连接数。

要显示当前连接（仍然打开的连接），请使用

```
SHOW PROCESSLIST 
```

# php - 如何以原始格式从 PDF 中提取图像

> ID：14522380
> 
> 赞同：8
> 
> 时间：2013-01-25T13:04:16.793
> 
> 标签：php, pdf, xpdf

我正在使用`pdfimages -j bar.pdf /tmp/image`从 PDF 中提取图像。我的目标是让它们在添加时处于原始状态。所以如果是.tif，我想得到一个.tif，如果是jpg，我想得到一个.jpg。对于我提取的所有内容，我不断获得 .ppm。

是否可以获得原始格式的图像或者 ppm 我唯一的选择？

**更新：**我想要这样做的主要目标是检查文档中包含的所有图像的 DPI，或者检查它们是否是矢量。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-24T16:40:54.810

**首先**，在 PDF 中称为“图像”，根据定义始终是光栅图像。没有“矢量图像”之类的东西。即使转换为 PDF 的原始文件包含矢量图形，转换程序也可能决定将这些图像包含为光栅图像。如果你提取它，你不会得到你的矢量图形，而是一个光栅图像。保存在 PDF 中的光栅图形无法通过`pdfimages`.

**其次，***您*不需要使用`pdfimages`. *如果您使用的是“Poppler”*分支的当前版本（高于 v0.20.2），则`pdfimages`可以使用该`-list`参数获取特定范围 PDF 页面上所有图像的列表：

```
pdfimages -list -f 7 -l 8 ct-magazin-14-2012.pdf

  页面编号类型宽度高度颜色comp bpc enc interp 对象ID
  -------------------------------------------------- ------------------
     7 0 图像 581 838 rgb 3 8 jpeg no 39 0
     7 1 图像 4 4 RGB 3 8 图像编号 40 0
     7 2 图像 314 332 RGB 3 8 jpx 无 44 0
     7 3 图像 358 430 RGB 3 8 jpx 无 45 0
     7 4 图像 4 4 RGB 3 8 图像编号 46 0
     7 5 图像 4 4 RGB 3 8 图像编号 47 0
     7 6 图像 4 6 RGB 3 8 图像编号 48 0
     7 7 图像 596 462 RGB 3 8 jpx 无 49 0
     7 8 图像 4 6 RGB 3 8 图像编号 50 0
     7 9 图像 4 4 RGB 3 8 图像编号 51 0
     7 10 图像 8 10 RGB 3 8 图像编号 41 0
     7 11 图像 6 6 RGB 3 8 图像编号 42 0
     7 12 图像 113 27 RGB 3 8 jpx 无 43 0
     8 13 图像 582 839 灰色 1 8 jpeg no 2080 0
     8 14 图像 344 364 灰色 1 8 jpx 无 2079 0

```

*再次注意*：这个版本`pdfimages`是来自 Poppler 的版本（来自 XPDF 的版本不**（**还？）支持这个新功能）。

如您所见，这列出了图像的相应宽度和高度。然而，这并没有（还）给你任何关于 DPI 的线索。如果将较大的光栅图像压缩到 PDF 页面上的小空间中，您的 DPI 值会非常高。（这就是 plinth 对他自己的回答的评论也强调的......）

为了计算 DPI，您必须测量页面上显示的图像的宽度/高度（您可以使用 Acrobat/Reader 中的工具之一进行测量），然后使用来自上面的输出来计算 DPI。

* * *

## 更新

`pdfimages`现在的最新版本*直接*在附加列中显示包含图像的 DPI 中的实际分辨率。获取此信息是问题的最初目标：

```
  pdfimages -list -f 6 -l 7 示例.pdf
  page num type width height color comp bpc enc interp object ID x-ppi y-ppi size ratio
  -------------------------------------------------- ------------------------------------------
     6 0 图像 1901 1901 RGB 3 8 图像无 632 0 1818 1818 468K 4.4%
     6 1 图像 1901 1901 RGB 3 8 图像无 645 0 1818 1818 521K 4.9%

```

新的输出格式还显示了每个图像（*'x-ppi'*，*'y-ppi'*）各自的水平和垂直分辨率。它还根据存储（*'size'*）及其压缩比（*'ratio'*）给出图像的实际大小。

[（感谢@Eric 建议更新暗示这些新功能`pdfimages`。）]

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-01-25T13:56:20.120

通过查看 PDF 中的图像，您无法（可靠地）知道源图像文件格式。例如，TIFF 图像可以使用（在我脑海中）无、RLE、CCITT（情侣变体）、LZW、Flate、Jpeg 进行压缩。如果 PDF 中的图像使用 DCT (jpeg) 压缩，您如何确定源是 TIFF 还是 Jpeg？如果是用Flate压缩的，怎么区分TIFF和PNG呢？此外，决定压缩的是生成 PDF 的软件，因此我可以使用 Flate 压缩的 TIFF 图像并将其编码为使用 JPEG2000 或 CCITT 压缩图像的 PDF 并使用 Jbig2 或 jpeg 图像压缩，将其压缩为8 位调色图像并使用 Flate 压缩。

TL; DR 你不知道。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-25T14:08:37.550

我同意 plinth，您可能无法确定使用的原始图像格式。ppm 不是您唯一的输出选项。

> pdfimages 读取 PDF 文件，扫描一页或多页，并为每个图像写入一个**PPM、PBM 或 JPEG文件，image-root-nnn.xxx，其中 nnn 是图像编号，** **xxx 是图像类型（.ppm， .pbm，.jpg）**。

[http://linux.die.net/man/1/pdfimages](http://linux.die.net/man/1/pdfimages)

此外，您当然可以使用例如[image magick's convert来更改格式](http://www.imagemagick.org/Usage/basics/#convert)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-08-27T18:35:38.167

我正在添加另一个答案，它处理原始问题的*“更新” ：*

> *“我想要这样做的主要目标是检查文档中包含的所有图像的 DPI，或者检查它们是否是矢量。”*

您可以使用 Ghostscript 选择性地删除（或保留）每一页上的*文本*、*像素图像*和*矢量图形区域。*

关键是应用新的 CLI 参数

*   *`-dFILTERIMAGE`*,
*   *`-dFILTERTEXT`*和/或
*   *`-dFILTERVECTOR`*

因此。

此处描述了此方法的详细信息；答案包含可视化结果的屏幕截图：

**[如何从 PDF 中删除所有图像？](https://stackoverflow.com/a/37858893/359307)**

[**顶行，**从左到右：所有“文本”被删除；删除所有“图像”；删除了所有“向量”。**底行，**左起：只保留“文本”；只保留“图像”；只保留“向量”。]
[![顶行，左起：全部](../Images/9c658c8b8ad12cb2c7b8292392e9e793.png)](https://i.stack.imgur.com/Aerzl.png)

* * *

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-26T17:29:16.707

您将需要获取图像 XObject（其中包含原始图像的宽度和高度），然后是实际显示的尺寸，然后您就可以解决这个问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-03-28T10:32:58.737

对于那些仍然想知道的人来说，`pdfimages -all`现代解决方案是：

> -all：以原始格式写入 JPEG、JPEG2000、JBIG2 和 CCITT 图像。CMYK 文件被写入为 TIFF 文件。所有其他图像都写为 PNG 文件。这等效于指定选项 -png -tiff -j -jp2 -jbig2 -ccitt。

# django - ForeignKey 字段在 Django 中变为 NULL，为什么？

> ID：14522384
> 
> 赞同：0
> 
> 时间：2013-01-25T13:04:36.737
> 
> 标签：django, foreign-key-relationship

我有这个代码：

```
if formPedido.is_valid() and formsetItens.is_valid():

        my_db_alias = profile.dbname
        cursor = connections[my_db_alias].cursor()

        cursor.execute('select id_retorno from prc_sequenciadora(' + str(profile.idempresa) + ', %s, %s, 0, 0)', ('VENDA_PEDIDO', 'IDVENDA_PEDIDO'))# calls PROCEDURE named LOG_MESSAGE which resides in MY_UTIL Package
        res = cursor.fetchone()
        transaction.commit_unless_managed(using=profile.dbname)

        idvendapedido = res[0]

        pedido = formPedido.save(commit=False)
        itens = formsetItens.save(commit=False)

        pedido.idpedido = idvendapedido
        pedido.idrepresentante = profile.id_comerx3c # passando o id do representante
        pedido.idempresa = profile.idempresa # passando o id da empresa
        pedido.idtabpreco = profile.idtabela_preco # passando o id da tabela de preco usada
        pedido.programado = 'S'
        pedido.internet = 'S'

        for forms in itens:
            forms.idempresa = profile.idempresa # passando o id da empresa
            forms.idvenda_pedido_itens = -1
            forms.idvenda_pedido = pedido
            forms.internet = 'S' 
```

我需要将“pedido”实例传递给我的 itens.idvenda_pedido ... itens.idvenda_pedido 是 Pedido 模型的 ForeignKey。

在这一行中，我得到了新的整数值：**pedido.idpedido = idvendapedido** 但这个新值不会进入我的“itens”

我该怎么做这些？我不能使用 AutoField，因为我需要使用存储过程来获得我的价值......

此致，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T13:56:46.760

您是否将每个表单保存在“for forms in itens”迭代中？

# javascript - 如何在javascript中从字符串替换\ Z

> ID：14522389
> 
> 赞同：0
> 
> 时间：2013-01-25T13:05:06.217
> 
> 标签：javascript, regex

我有一个代表正则表达式的字符串，`str = "[A-z]\Z";` 我想用 $ 替换 \Z，因为 javascript 正则表达式不支持 \Z。

有没有办法做到这一点？我通过为 \Z 创建一个正则表达式尝试了一些字符串替换，但它们没有按预期工作。它也适用于任何出现的 Z。有没有办法实现这一点？这是我的示例代码有问题

```
var expression = "[abczZ]\Z";
var regEx = new RegExp("\\Z", "g"); 
a=  expression.replace(regEx, "\\s");
alert(a); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-25T13:09:48.270

您需要额外的转义层：

```
var regEx = new RegExp("\\\\Z", "g"); 
```

因为您将正则表达式作为字符串提供，所以一个转义层将被字符串“吃掉”，仅保留`\Z`与文字匹配的正则表达式`Z`。

您还可以使用正则表达式文字，在这种情况下您不需要双重转义：

```
var regEx = /\\Z/g; 
```

当然，要在您的字符串上测试它，您首先需要修复您的字符串。就目前而言，它根本不包含任何反斜杠。`var expression = "[abczZ]\Z"`导致`expression`包含字符串`"[abczZ]Z"`，因为您没有转义反斜杠。与前两段中描述的问题完全相同。

在 JS 控制台中自己尝试一下：

```
> "[abczZ]\Z"
"[abczZ]Z"
> "[abczZ]\\Z"
"[abczZ]\Z"
> "[abczZ]\Z".replace(new RegExp("\\\\Z", "g"), "$")
"[abczZ]Z"
> "[abczZ]\\Z".replace(new RegExp("\\\\Z", "g"), "$")
"[abczZ]$" 
```

# multithreading - 如何为每个 MPICH 进程设置不同的 MKL 线程数

> ID：14522390
> 
> 赞同：0
> 
> 时间：2013-01-25T13:05:07.530
> 
> 标签：multithreading, mpich

我想为每个 MPICH 进程创建不同数量的 MKL 线程。

例如，假设我有 4 个 MPICH 进程。我想要的是：

进程 1=4 MKL 线程，进程 2=3 MKL 线程，进程 3=5 MKL 线程，等等。

我知道`export MKL_NUM_THREADS=4; export MKL_DOMAIN_NUM_THREADS="MKL_ALL=1, MKL_BLAS=4"`，但我不知道在我的具体情况下我必须做什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T16:24:12.217

如果您想要实现的是 MPI 作业中的不同等级使用不同数量的 MKL 线程，您可以通过两种不同的方式来实现。

您可以根据进程等级设置代码中的线程数，例如

```
#define NUM_PROCS 4

int threads_per_proc[NUM_PROCS] = { 4, 3, 5, 5 };
int rank;
MPI_Comm_rank(MPI_COMM_WORLD, &rank);
// ...
// Signal an error if rank >= 4
// ...
mkl_set_num_threads(threads_per_proc[rank]); 
```

也可以使用`mpiexec`(or `mpirun`) 的 MPMD 启动模式，但是会有点麻烦：

```
mpiexec -env MKL_NUM_THREADS 4 -n 1 ./program : \
        -env MKL_NUM_THREADS 3 -n 1 ./program : \
        -env MKL_NUM_THREADS 5 -n 2 ./program 
```

为简洁起见，我省略了要设置的选项`MKL_DOMAIN_NUM_THREADS`。这将启动 MPI 程序的一个副本，并将`./program`其`MKL_NUM_THREADS`设置为`4`（该副本变为等级 0）；一个副本`MKL_NUM_THREADS`设置为`3`（哪个副本成为排名 1）；`MKL_NUM_THREADS`设置为的两个副本`5`（这些副本成为等级 2 和 3）。

# android - android：添加日历事件时的EXDATE格式

> ID：14522393
> 
> 赞同：6
> 
> 时间：2013-01-25T13:05:19.543
> 
> 标签：android, android-contentprovider, android-calendar, android-event

`EXDATE`有人可以解释在将事件添加到 android 日历时如何使用吗？该文档对于`EXDATE`应该放置的格式非常不清楚。我尝试了许多格式，其中一些是：

```
values.put(Events.EXDATE, "TZID=Europe/London:20130116T080000");
values.put(Events.EXDATE, "20130116T080000Z");
values.put(Events.EXDATE, "20130116T080000");
values.put(Events.EXDATE, "20130116"); 
```

但它们都不起作用。知道如何使事件不会出现在特定日期，如果`RRULE`它应该出现吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-01T21:55:12.400

正确的格式是：

`values.put(Events.EXDATE, "20130116T080000Z");`

但是，您必须确保它是 UTC 时间。从 PST 开始我遇到了同样的问题，所以我只需要增加 8 小时才能让它工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-08-16T08:43:22.527

除了@kee23 的回答，下一个变体对多个**EXDATE**值有效：

```
contentValues.put(CalendarContract.Events.EXDATE, "20130116T080000Z,20130118T080000Z"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-03-27T14:34:55.983

我在@kee23 出色而正确的答案之上添加：

我刚刚意识到，在 android 中，你*不能将*EXDATE 持久化到一个*无限重复*的事件中，比如说`RRULE:FREQ=DAILY`。您需要限制出现次数，如`RRULE:FREQ=DAILY;COUNT=600`.

谷歌没有记录这一点，如果您尝试使用 EXDATE 保持无休止的重复，也不会出现错误消息。就我而言，它只是默默地放弃了 RRULE 和 DURATION。

# asp.net-mvc - 无法访问 .NET MVC 客户端验证上的 ValidationParameters

> ID：14522400
> 
> 赞同：2
> 
> 时间：2013-01-25T13:06:00.073
> 
> 标签：asp.net-mvc, validation, validationattribute, validationrule

我正在为我的 .NET MVC 4 应用程序编写自定义验证。这是第一个使用参数的验证，我发现了一些麻烦。

这是我的 C# 代码：

验证属性：

```
namespace Validations
{
    [AttributeUsage(AttributeTargets.Field | AttributeTargets.Property, AllowMultiple = false, Inherited = true)]
    public class MinRequiredPasswordLengthValidationAttribute : ValidationAttribute, IClientValidatable
    {
        public MinRequiredPasswordLengthValidationAttribute()
        : base("The password is invalid")
        {

        }

        public override string FormatErrorMessage(string name)
        {
            return String.Format(CultureInfo.CurrentCulture, ErrorMessageString, name.ToLower(), Membership.MinRequiredPasswordLength);
        }

        public override bool IsValid(object value)
        {
            if (value == null || String.IsNullOrEmpty(value.ToString()))
            {
                return true;
            }

            return value.ToString().Length >= Membership.MinRequiredPasswordLength;
        }

        public IEnumerable<ModelClientValidationRule> GetClientValidationRules(ModelMetadata metadata, ControllerContext context)
        {
            ModelClientMinRequiredPasswordLengthValidationRule rule = new ModelClientMinRequiredPasswordLengthValidationRule(FormatErrorMessage(metadata.GetDisplayName()), Membership.MinRequiredPasswordLength);
            yield return rule;
        }
    }
} 
```

模型客户端验证规则：

```
namespace Validations
{
    public class ModelClientMinRequiredPasswordLengthValidationRule : ModelClientValidationRule
    {
        public ModelClientMinRequiredPasswordLengthValidationRule(string errorMessage, int minRequiredPasswordLength)
        {
            ErrorMessage = errorMessage;
            ValidationType = "minrequiredpasswordlength";
            ValidationParameters.Add("minlength", minRequiredPasswordLength);
        }
    }
} 
```

这是JS代码，我的问题：

```
jQuery.validator.addMethod("minrequiredpasswordlength", function (value, element, params) {
    if (value.length == 0) {
        return true; //empty
}

return true; //dummy return
}, "");

jQuery.validator.unobtrusive.adapters.add("minrequiredpasswordlength", {}, function (options) {
    //XXX Here I should get the minlength parameter, but 'options' is a empty object
    options.messages["minrequiredpasswordlength"] = options.message;
}); 
```

非常感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-01-16T13:13:01.900

看看这个链接是否有帮助：

[带有参数的 ASP.NET MVC 3 客户端验证](https://stackoverflow.com/questions/4784943/asp-net-mvc-3-client-side-validation-with-parameters)

另外，尝试将您的 javascript 代码更改为：

```
$.validator.addMethod('minrequiredpasswordlength', function (value, element, params) {
    var minLength = params.minLength;

    // minLength should contain your value.
    return true; // dummy return
});

jQuery.validator.unobtrusive.adapters.add('minrequiredpasswordlength', [ 'minlength' ], function (options) {

    options.rules['minrequiredpasswordlength'] = {
            minLength: options.params['minlength']
        };

    //XXX Here I should get the minlength parameter, but 'options' is a empty object
    options.messages["minrequiredpasswordlength"] = options.message;
}); 
```

这里的秘诀是使用 [ 'minlength' ] 而不是 {} 我第一次学习这个时花了很多时间。我希望这有帮助。

# android - 在 Android 中包含 .a 库

> ID：14522403
> 
> 赞同：0
> 
> 时间：2013-01-25T13:06:03.220
> 
> 标签：android, shared-libraries, native

我想在 Android 本机代码中包含 6 个库，它们的扩展名为 .a

我还想知道 .a 和 .so 库之间的区别，以及是否对正在运行的操作系统有任何依赖？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T13:13:20.727

*.a 和 *.so 库之间的区别在于 *.a 是静态库，而 *.so 是动态库（共享对象）。在存档库 *.a 的情况下，完整的预编译源应该在那里，所以您需要做的就是添加

```
LOCAL_STATIC_LIBRARIES := yourlib 
```

在你的 Android.mk 中。有关更多详细信息，请参见[此处](https://stackoverflow.com/questions/5463518/android-ndk-link-using-a-pre-compiled-static-library)。

# .htaccess - Mod重写适用于一个站点，但不适用于另一个

> ID：14522404
> 
> 赞同：1
> 
> 时间：2013-01-25T13:06:03.727
> 
> 标签：.htaccess, mod-rewrite

我有一个 mod 重写，看起来像这样：

```
rewriteRule ^info/([0-9]+).html$ info.php?n=$1 
```

这有效： `mydomain1.com/info/8.html`到`mydomain1.com/info.php?n=8`

在一个域上，但不在另一个域上：

`mydomain2.com/info/8.html`

域在同一台服务器上，唯一的区别是 mydomain2.com 作为插件域托管在 mydomain1.com 下的文件夹中

它适用于一个域但不适用于另一个域的原因可能是什么？

# jquery - jQuery：如何检查 DOM 元素是否具有内联样式

> ID：14522405
> 
> 赞同：0
> 
> 时间：2013-01-25T13:06:06.993
> 
> 标签：jquery, dom

我想删除不需要的嵌套。

如何从 DOM 中选择具有此表单的元素：

```
<div style="display: block;">
..
</div> 
```

这似乎是一个严格的过滤，如：

```
var unwanted_nest = $('.webform-client-form').find('div:not([id])').filter('div:not([class])'); 
```

只会显示如下形式：..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T13:08:56.767

试试这个

```
$('div[style="display: block;"]'); 
```

[在这里摆弄](http://jsfiddle.net/bipen/g7Pqr/)

`style= display : block`但是，如果这是你想要的，这会选择所有带有 attr 的 div

# django - 在编辑视图中预填充动态添加的表单集

> ID：14522407
> 
> 赞同：0
> 
> 时间：2013-01-25T13:06:13.270
> 
> 标签：django, django-forms, formsets

我的应用程序中有不同的模型，主模型有一些其他模型的多个实例。

模型.py：

```
class Person(models.Model):
    ...

class Pet(models.Model):
    owner = models.ForeignKey(Person)
    ... 
```

表格.py：

```
class PersonForm(forms.ModelForm):
    class Meta:
        model = Person

PetFormSet = inlineformset_factory(Person, Pet, extra = 1) 
```

视图.py：

```
def add_template(request):
    person_form = PersonForm(prefix = 'person_form')
    pet_form = PetFormSet(instance = Person(), prefix = 'pet_form')
    ... # check is_valid(), render when no POST data is present, etc. 
```

关键是添加工作完美，将每个实例存储在相应的数据库表中等。我使用jquery.formset-1.2.js来管理“add.html”中表单的动态添加-删除。

但是我稍后想通过视图编辑存储的信息，即从我在请求中传递的对象中加载数据，并使用从数据库中获取的数据渲染表单集（如果有3只宠物与正在编辑的人相关） , 显示“宠物”的 3 个表单实例，并显示它们的值）。

我还想添加新的宠物并删除现有的宠物，以及更改现有的字段值。

我已经尝试在 FormSet 创建中使用查询集，但它没有显示任何内容。

知道如何缓解这个问题吗？也许使用应用程序来简化表单集管理？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T13:51:07.220

我不确定我是否正确理解了您的问题。如果要显示所有`Pets`属于`Person`:

```
def show_pets(request, person_id=None):
person = get_object_or_404(Person.objects.select_related(), id=person_id)
if request.method == 'POST':
   person_form = PersonForm(request.POST, instance=person)
   pet_formset = PetFormSet(request.POST, instance=person)
   # Rest of your code here
else:
   person_form = PersonForm(instance=person)
   pet_formset = PetFormSet(instance=person)
return render_to_response('your_template.html', {'person_form': person_form,
                                                        'pet_formset': pet_formset)}) 
```

然后你只需要在你的模板中渲染两个表单并添加`add`和`delete`功能

# c# - 如何更改 windows phone 中滑块控件的高度？

> ID：14522408
> 
> 赞同：1
> 
> 时间：2013-01-25T13:06:15.373
> 
> 标签：c#, silverlight, windows-phone-7, xaml

它一定很简单，但我无法弄清楚。如何更改 windows phone 中滑块控件的高度？无论我为它设置的值有多大，`Height`它都保持原样

```
<Slider Width="100" Height="600" /> 
```

![在此处输入图像描述](../Images/0511d35b45177427d65e8694ed7ea165.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-25T15:46:10.123

在 Expression Blend 中打开页面

1.  右键单击 Page 上的滑块控件。
2.  选择编辑模板并根据需要选择编辑当前/编辑副本。
3.  *在 Expression Blend 中更改属性Horizo​​ntalTrack、Horizo​​ntalFill、* Horizo​​ntalThumb 的 Render 选项卡的 Scale 子选项卡中的宽度值，您将看到差异。

保存页面并返回 Visual Studio，您的自定义模板将添加到页面资源中。

*我附上了 Expression Blend 的图像。*

![在此处输入图像描述](../Images/f5222a4dee5bab30229d160e9714b2bc.png)

结果会像

![在此处输入图像描述](../Images/29d75686cd02daf82a07711c10cf1f49.png)

模板代码：- 这可能对您有所帮助。

```
<phone:PhoneApplicationPage.Resources>
    <ControlTemplate x:Key="PhoneSimpleRepeatButton" TargetType="RepeatButton">
        <Rectangle Fill="Transparent"/>
    </ControlTemplate>
<Style x:Key="SliderStyle1" TargetType="Slider">

    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="Slider">
                <Grid Background="Transparent">
                    <Grid x:Name="HorizontalTemplate" Margin="{StaticResource PhoneHorizontalMargin}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="12"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Rectangle x:Name="HorizontalFill" Fill="{TemplateBinding Foreground}" Height="12" IsHitTestVisible="False" Margin="0,22,0,50" RenderTransformOrigin="0.5,0.5">
                            <Rectangle.RenderTransform>
                                <CompositeTransform ScaleY="2.9"/>
                            </Rectangle.RenderTransform>
                        </Rectangle>
                        <Rectangle x:Name="HorizontalTrack" Grid.Column="2" Fill="{TemplateBinding Background}" Height="12" IsHitTestVisible="False" Margin="0,22,0,50" Opacity="0.2" RenderTransformOrigin="0.5,0.5">
                            <Rectangle.RenderTransform>
                                <CompositeTransform ScaleY="2.9"/>
                            </Rectangle.RenderTransform>
                        </Rectangle>
                        <RepeatButton x:Name="HorizontalTrackLargeChangeDecreaseRepeatButton" IsTabStop="False" Template="{StaticResource PhoneSimpleRepeatButton}"/>
                        <RepeatButton x:Name="HorizontalTrackLargeChangeIncreaseRepeatButton" Grid.Column="2" IsTabStop="False" Template="{StaticResource PhoneSimpleRepeatButton}"/>
                        <Thumb x:Name="HorizontalThumb" Grid.Column="1" Height="12" Margin="0,22,0,50" Width="12" RenderTransformOrigin="0.5,0.5">
                            <Thumb.RenderTransform>
                                <CompositeTransform ScaleY="4.65"/>
                            </Thumb.RenderTransform>
                            <Thumb.Template>
                                <ControlTemplate>
                                    <Canvas Background="{StaticResource PhoneForegroundBrush}" Height="12" Width="12">
                                        <Rectangle Fill="Transparent" Height="84" IsHitTestVisible="True" Canvas.Left="-24" Canvas.Top="-22" Width="60"/>
                                    </Canvas>
                                </ControlTemplate>
                            </Thumb.Template>
                        </Thumb>
                    </Grid>
                </Grid>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style> 
```

并在控制中使用它，例如：-

```
 <Slider Margin="0,49,56,348" HorizontalAlignment="Right" Width="360" Style="{StaticResource SliderStyle1}" /> 
```

# android - 从 BroadcastReceiver 启动 Activity - 解除它不应返回到我的应用程序堆栈中的先前活动

> ID：14522410
> 
> 赞同：1
> 
> 时间：2013-01-25T13:06:19.210
> 
> 标签：android, android-activity, activity-stack

这是我的场景 - 应用程序以 Activity A 开始，它是主要的启动点。还有从 A 启动的各种其他活动，比如 B 和 C。从 A 到 B 应该是可逆的（按下实际上返回），所以我需要在活动堆栈上的每个 A，对于 A => C 和返回也是如此。默认情况下，所有这些都可以正常工作。

现在变得棘手了：我有另一个活动，比如 X，它可以从后台进程（广播接收器）启动。当 X 启动时，它应该替换当前屏幕上的任何内容——那部分没有问题。然后 X 可以被用户解雇（以 finish() 和 startActivity(A) 结尾 - 所以我没有 X 在堆栈上）。它也可以由后台进程完成（广播接收器接收另一个意图） - 在后一种情况下我有问题。

我仍然在 X 上调用 finish()，现在发生了以下情况：无论哪个 Activity 先前处于活动状态（比如 A），都会再次显示。如果 A 在 X 启动之前显示，那很好，但是，如果我的应用程序在后台，一旦 X 被关闭，我希望恢复启动 X 之前的状态（所以要么显示主屏幕，要么显示在 X 之前运行的任何应用程序推出）。如果您想知道..我为什么要打扰用户-这是有充分理由的（这是一个电话应用程序，来电应该中断）。

似乎当我在 X 上调用dismiss时，应用程序将返回到活动堆栈中的任何其他内容。如果应用程序在 X 启动时处于前台，那很好，但如果不是，我希望 X 被关闭，并且无论哪个应用程序处于活动状态，都可以再次处于顶部。

以下是我在启动 X 时使用的意图标志： FLAG_ACTIVITY_NEW_TASK FLAG_ACTIVITY_CLEAR_TOP FLAG_ACTIVITY_NEW_TASK

我已经尝试过 FLAG_ACTIVITY_MULTIPLE_TASK 但结果不太令人满意（如果我的应用程序在后台运行，这会阻止它在 X 在没有用户干预的情况下被关闭时出现在顶部，但是在应用程序历史记录中，它会显示 X并且 X 永远不应该在那里显示，而且如果用户实际选择了它，肯定会启动 X，这很糟糕。

这么简单

电话处于状态 S1 X 已启动 X 通过调用 finish() 在没有用户交互的情况下关闭 电话应返回状态 S1

这可以以某种方式实现吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T11:23:08.923

尝试使用标志[`FLAG_ACTIVITY_EXCLUDE_FROM_RECENTS`](http://developer.android.com/reference/android/content/Intent.html#FLAG_ACTIVITY_EXCLUDE_FROM_RECENTS)：

> 如果设置，则新活动不会保留在最近启动的活动列表中。

# r - Nelder-Mead 优化方法

> ID：14522412
> 
> 赞同：1
> 
> 时间：2013-01-25T13:06:20.030
> 
> 标签：r, optimization

中`R`，`optim`命令使用 Nelder-Mead 方法优化功能。一篇文章指出

> ```
> The parameters to be estimated are optimized over initial values. As a result,
> different initial values will lead to different estimates. 
> ```

这是什么意思`the parameters to be estimated are optimized over initial values`？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-25T13:27:54.150

@GavinSimpson 引用您的消息来源的请求是有根据的。

也就是说，这是一个基本的优化概念。通常，您必须为参数选择起始值（或者例程必须为您猜测它们）。因为优化通常会找到局部最小值或最大值，所以如果您从不是全局最小值的局部最小值附近开始，您可能会找到局部最小值，而不是全局最小值。

这是一个例子。首先，创建并绘制一个 6 阶多项式（具有多个局部最小值）。然后从三个不同的点开始优化。

```
f <- function(x)  {
  1/30 * (x+3.5)*(x+2)*(x+1)*(x-1)*(x-3)*(x-4) + 2
}
vec <- seq(-4,4, .01)
plot( f(vec) ~ vec, type="l" )

for( startX in c(-3.5,-.5,3) ) {
  opt <- optim( list(x=startX), fn=f )
  points( x=opt$par, y=opt$value, pch="x", col="red"  )
} 
```

看看起始值有多重要？

![阴谋](../Images/08ae4c5e9ff5f10f1f961346b02c9b24.png)

NB 我意识到 Nelder-Mead 对于单变量分布并不理想，但为了简单起见，我在这里使用它，因为它说明了这一点。

# ios - Core Plot 1.1：编译 Core Plot 示例时出现编译错误

> ID：14522413
> 
> 赞同：4
> 
> 时间：2013-01-25T13:06:27.433
> 
> 标签：ios, objective-c, cocoa-touch, core-plot

尝试在 Xcode 4.6 中编译以下 CorePlot 1.1 示例时，出现编译器错误。

*   `DatePlot`
*   `CPTTestApp - iPad`

编译器错误`CPTUtilities.m`：`Operand of ? changes signedness: 'int' to 'NSUInteger' (aka 'unsigned int')`

```
NSRange CPTExpandedRange(NSRange range, NSInteger expandBy)
{
    NSUInteger loc = MAX(0, (NSInteger)range.location - expandBy);
    NSUInteger lowerExpsion = range.location - loc; // Here is the error
    NSUInteger length = (NSUInteger)( (NSInteger)(range.length + lowerExpansion) + expandBy);

    return NSMakeRange(loc, length);
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-26T02:35:20.370

是的，答案放在那里，只是简单地改变了功能，我留下了一个副本，正确的代码如何：

```
 NSRange CPTExpandedRange(NSRange range, NSInteger expandBy)

//NSUInteger loc            = MAX(0, (NSInteger)range.location - expandBy);
//NSUInteger lowerExpansion = range.location - loc;
//NSUInteger length         = (NSUInteger)( (NSInteger)(range.length + lowerExpansion) + expandBy );

NSInteger loc            = MAX(0, (NSInteger)range.location - expandBy);
NSInteger lowerExpansion = (NSInteger)range.location - loc;
NSInteger length         = MAX(0, (NSInteger)range.length + lowerExpansion + expandBy);

//return NSMakeRange(loc, length);
return NSMakeRange( (NSUInteger)loc, (NSUInteger)length ); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-28T07:26:36.693

Core Plot 团队现已修复此问题（问题 #501）：

[问题 501 已修复](http://code.google.com/p/core-plot/issues/detail?id=501&can=1&sort=-id)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-08T15:44:19.107

抱歉，但我找不到如何修复此编译器错误。我和亚历克斯的情况一样。尝试编译示例并得到相同的错误。在 XCode 4.6 和 Mountain Lion 上运行。CorePlot 1.1 并尝试过目标 5.1、6.0 和 6.1

谢谢你的帮助。

# git - 为什么在我从 cvs 切换到 git 后，我 的 qt makefile 会覆盖我的 makefile？

> ID：14522414
> 
> 赞同：0
> 
> 时间：2013-01-25T13:06:31.083
> 
> 标签：git, qt, makefile, cvs

```
cvs version 1.11.22
git 1.7.41
qt 3.3.3
qt 3.3.6
Red Hawk 5.4.12 (from uname)
gmake (???? the machines in question are not connected to the internet and are hard to update) 
```

所以为了证明我们从 cvs 到 git 的转换进展顺利，我从 cvs checkout 和 git checkout 构建了一个。

但是现在我们注意到 git 被覆盖了 qt makefile cvs 和 git 存储库都有正确的文件，但只有 git 版本显示 makefile 被重新生成（并且错误）。

关于在哪里看的想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T17:51:16.040

那么我能够重现这个问题！这帮助我确定它只发生在新的 git checkout 上，因此这是一个 cvs vs git 问题。

当您从 cvs 检查某些内容时，文件的日期是随机的。（我从来没有打算弄清楚文件日期在 cvs 中的来源。）

在 git 中，所有文件都有今天的日期。

因此，当 qmake 查看 filename.pro 时，它发现它比 Makefile 更新，因此需要重新生成 Makefile。当 Makefile 现在再次被检出时，它的日期比 filename.pro 更新，并且 Makefile 不再重新生成。

所以我可以删除 filename.pro 以便 qmake 无法重新制作 Makefile 或更新 filename.pro 以包含我需要的额外库并制作 Makefile。

# javascript - AngularJS $resource 参数不替换为它的真实值？

> ID：14522415
> 
> 赞同：1
> 
> 时间：2013-01-25T13:06:32.553
> 
> 标签：javascript, angularjs

我最近决定使用`$resource`REST 服务，但很快就遇到了麻烦。我有一个简单的网址：

> /r/interface/activate/:active/addr/:address

但是在单元测试中调用它会使其失败：

```
// expected: POST /r/interface/activate/false/addr/123
// got     : POST /r/interface/activate/false/addr/@address 
```

我定义的资源是：

```
module.factory('NetworkInterfaceActivationService', function ($resource) {
    return $resource("/r/interface/activate/:active/addr/:address", {}, {
        activate:{method:'POST', params:{active:"true", address:'@address'}, isArray:false},
        deactivate:{method:'POST', params:{active:"false", address:'@address'}, isArray:false}
    });
}); 
```

这就是我如何称呼我的服务！

```
$scope.deactivateNetworkAddress = function (address) {
   NetworkInterfaceActivationService.deactivate({address:address});
}; 
```

我错过了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-09-20T09:16:14.150

我用 Angular 1.3 尝试了你的代码，但我无法重现这个问题。

[jsFiddle](http://jsfiddle.net/plantface/ehbtv771/)

```
<button ng-click="parentCtrl.doIt('123foobar')">execute</button> 
```

```
app.controller('ParentCtrl', function (NetworkInterfaceActivationService) {
    this.doIt = function (address) {
        NetworkInterfaceActivationService.deactivate({address:address});
    };
})

app.factory('NetworkInterfaceActivationService', function ($resource) {
    return $resource("/r/interface/activate/:active/addr/:address", {}, {
        activate:{method:'POST', params:{active:"true", address:'@address'}, isArray:false}
    });
}); 
```

控制台中的 HTTP 调用：

> POST .../r/interface/activate/false/addr/123foobar

# python - windows xp中的django startproject异常

> ID：14522416
> 
> 赞同：1
> 
> 时间：2013-01-25T13:06:37.510
> 
> 标签：python, django, windows

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-25T13:09:55.047

You need to upgrade to Django 1.5c1 (still in development). You appear to be running a development version that predates even 1.5a1\. The error you see is due to a syntax change between the major Python versions and was [fixed 9 months ago](https://github.com/django/django/commit/3904b74a3f2f92fefe1d39281ed683c52f2fef03).

Or better still, use Python 2.7 instead; even in Django 1.5 the Python 3 support is labelled as experimental.

# html - IE 为下拉菜单子项添加阴影

> ID：14522420
> 
> 赞同：1
> 
> 时间：2013-01-25T13:06:51.460
> 
> 标签：html, css, internet-explorer

我刚刚在 IE 中测试了一个网站，除了 IE 中的下拉菜单正在为文本添加阴影之外，一切正常。它在 Chrome 和 firefox 中看起来不错，只是在 IE 中不起作用。

地址是：www.rbc.org.uk

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T13:19:26.217

IE 8,9`text-shadow`不像其他标准浏览器那样支持。您应该这样做：
[**静态过滤器**](http://msdn.microsoft.com/en-us/library/ms673539%28VS.85%29.aspx)
示例：

```
.shadow { 
    filter: progid:DXImageTransform.Microsoft.Shadow(color=#0000FF,direction=45);
} 
```

有关更多信息，我强烈建议您谷歌并查看以下问题：
[**css3 text-shadow in IE9**](https://stackoverflow.com/questions/6905658/css3-text-shadow-in-ie9)

# boost - 二维随机提升

> ID：14522421
> 
> 赞同：2
> 
> 时间：2013-01-25T13:06:51.727
> 
> 标签：boost, random, boost-random

我正在尝试使用增强随机生成器使随机点均匀分布在平面上。我有以下链接可以在一个维度上进行操作：

*   [Boost随机数生成器](https://stackoverflow.com/questions/2254909/boost-random-number-generator)

在这里，它们用于`boost::uniform_int<>`生成`int`单一维度的数字。

但就我而言，我希望`float`在平面上生成二维数字。

是否有任何分布类型可以在二维中使用它？（我见过`boost::uniform_on_sphere`，但它适用于球面。）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T13:11:39.630

使用`uniform_01`分布并生成两个随机数，为您提供 x 和 y 坐标。相应地缩放:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T13:16:22.000

如果`x`遵循均匀分布 0 到`a`并`y`遵循均匀分布 0 到，`b`则点`(x, y)`在矩形上均匀分布，`(0,0)-(a,b)`无需任何特殊方法。只需生成两个随机数而不是一个。

这些将需要以不同的方式分布它们，例如在圆的边缘（当你谈论球体时）。

# module - 在verilog中实例化一个模块

> ID：14522422
> 
> 赞同：2
> 
> 时间：2013-01-25T13:06:53.207
> 
> 标签：module, instantiation, verilog

在 verilog 文件中实例化模块时出现错误。我正在像这样实例化：

```
module lab3(input clk,set,reset,plus,minus,start,button,output reg [3:0]led,output reg [6:0]y);

wire [3:0] indicesgu[3:0];
reg [1:0] going;
reg alsogoing,yes;

if (going==1 && alsogoing)
begin
 up_counter up_0 
 indicesgu  ,
 indices    ,
 alsogoing
 );
end 
```

我的 up_counter 模块开始为：

```
module up_counter(input [3:0] indices_in [3:0],output [3:0]indices[3:0],output alsogoing);

reg [3:0]indices[3:0];
reg [2:0]current,setting; 
```

当我尝试在 Xilinx 中编译时，它显示出意外的令牌 up_counter。提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T13:30:26.790

`lab3`你的模块有几个问题。

1.  你最后需要一个`endmodule`。
2.  您不应该`up_counter`在`if`. Verilog 不支持这样的条件实例。
3.  您需要在实例名称之后添加一个左括号`up_0`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-25T13:31:38.470

您的代码中有（多个）语法错误。其中之一是您需要在组件端口列表周围使用方括号 ()

```
up_counter up_0 (indicesgu  ,
                 indices    ,
                 alsogoing
                 ); 
```

检查[Verilog 语法](http://www.verilog.com/VerilogBNF.html#REF79)以获取更多信息。

这至少会修复“意外令牌 up_counter”错误。

# html - 范围销毁上的销毁指令/子范围

> ID：14522426
> 
> 赞同：12
> 
> 时间：2013-01-25T13:07:30.067
> 
> 标签：html, angularjs

我有一个指令编译另一个指令并将其附加到具有相同范围的主体传递。这与“父”指令的位置不同。

当父指令被破坏时，是否有某种方法可以让子指令和作用域也被破坏？我问是因为在检查了 DOM 之后，子指令仍然存在。

目前我挂钩了父母 $destroy 事件，但很好奇它是否可以自动处理。

**jsFiddle：http:** [//jsfiddle.net/FPx4G/1/](http://jsfiddle.net/FPx4G/1/)

当您切换父母时，孩子会留在那里，但我想被摧毁。最好的方法是什么？

**html:**

```
<div ng-app="app">
    <div ng-controller="ParentCtrl">
        <button data-ng-click="toggleParent()">Toggle Parent</button>
        <div data-ng-switch data-on="displayDirective">
            <div data-ng-switch-when="true">
                <div class="parentDirective">Parent Directive</div>
            </div>
        </div>
    </div>
</div> 
```

**javascript:**

```
angular.module('app', [])
    .directive("parentDirective", function($compile){
        return {
            restrict: 'C',
            link: function(scope, element){
                var secondDirective = angular.element(document.createElement("div"));
                secondDirective.addClass("childDirective");

                document.body.appendChild(secondDirective[0]);

                $compile(secondDirective)(scope);
            }
        }
    })
    .directive("childDirective", function(){
        return {
            restrict: 'C',
            template: '<div>Child Directive</div>',
            link: function(scope, element){
                scope.$on("destroy", function(){
                   alert(1); 
                });
            }
        }
    });

function ParentCtrl($scope){
   $scope.displayDirective = true;
    $scope.toggleParent = function(){
        $scope.displayDirective = !$scope.displayDirective;
    }
} 
```

通常，我只会在原始指令的模板中包含子元素，以便正确定位。问题实际上归结为处理 z-index。父元素位于可以滚动的容器中，因此如果子元素（在一种情况下为自定义下拉菜单）大于容器，则子元素（在一种情况下为*自定义*下拉菜单）将被隐藏/切断。为了解决这个问题，我改为在文档正文中创建实际的孩子并将其相对于父母定位。它还会监听滚动事件以重新定位自己。我有这一切工作，很好。当我需要删除父母时会发生这种情况......孩子仍然在那里。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-01-25T19:32:18.457

```
directive("childDirective", function(){
    return {
        restrict: 'C',              
        template: '<div >Child Directive</div>',                
        link: function(scope, element){                  
            scope.$on("$destroy",function() {
                element.remove();
            }); 
        }
    }
}); 
```

更新小提琴：http: [//jsfiddle.net/C8hs6/](http://jsfiddle.net/C8hs6/)

# php - 无法加载 ZIP 压缩字体，因为 ZIP PHP 扩展不可用

> ID：14522427
> 
> 赞同：0
> 
> 时间：2013-01-25T13:07:34.413
> 
> 标签：php

我想使用这个[Figlet](http://bolknote.ru/files/figlet/)，我得到了错误：`Cannot load ZIP compressed fonts since ZIP PHP extension is not available`

这是什么错误，因为我找不到错误

我有 php 5.2.17

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-30T10:09:22.790

最后，我只是解压缩文件，并使用它们。

# sql - 显示一个存储过程

> ID：14522428
> 
> 赞同：2
> 
> 时间：2013-01-25T13:07:35.197
> 
> 标签：sql, stored-procedures

我的存储过程有问题，运行时出现此错误：

> *ADO EROR：关键字“ where”附近的语法不正确*

我想显示 2 个按归档计数的归档，其中我有公司在 2012 年之前选择了该区域

这是我的查询：

```
 ALTER PROCEDURE ProceduraCalculareAuto
      AS
       SELECT ФИРМА.НаимПредпр
         FROM  dbo.ФИРМА  LEFT OUTER JOIN
                  dbo.АВТОМОБ ON dbo.АВТОМОБ.КодПредпр = dbo.ФИРМА.КодПредпр INNER JOIN
                      dbo.КАРНЕТ ON dbo.КАРНЕТ.КодПредпр = dbo.ФИРМА.КодПредпр 
                  INNER JOIN
    (SELECT Tegaci = COUNT
            (CASE [КодПриц/Тягач]
                  WHEN 4 THEN  [КодПриц/Тягач] 
                END),
            Auto = COUNT
         (CASE [КодПриц/Тягач]
          WHEN 3 THEN  [КодПриц/Тягач] 
                         END)
          FROM     dbo.АВТОМОБ
                 GROUP BY dbo.АВТОМОБ.[КодПриц/Тягач] )
      WHERE(dbo.КАРНЕТ.ДтВыдачи BETWEEN CONVERT(DATETIME, '2012-01-01 00:00:00',  
       102) AND CONVERT(DATETIME, '2012-12-31 00:00:00', 102))
      GROUP BY ФИРМА.НаимПредпр

 RETURN 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-25T13:11:10.230

您缺少子查询的别名。在 SQL Server 中，每个派生表和子查询都需要一个别名。您还缺少将`ON`子查询连接到其余查询的子句：

```
SELECT ФИРМА.НаимПредпр
FROM  dbo.ФИРМА  
LEFT OUTER JOIN dbo.АВТОМОБ 
  ON dbo.АВТОМОБ.КодПредпр = dbo.ФИРМА.КодПредпр 
INNER JOIN dbo.КАРНЕТ 
  ON dbo.КАРНЕТ.КодПредпр = dbo.ФИРМА.КодПредпр 
INNER JOIN
(
  SELECT Tegaci = COUNT
            (CASE [КодПриц/Тягач]
                  WHEN 4 THEN  [КодПриц/Тягач] 
                END),
            Auto = COUNT
         (CASE [КодПриц/Тягач]
          WHEN 3 THEN  [КодПриц/Тягач] 
                         END)
  FROM     dbo.АВТОМОБ
  GROUP BY dbo.АВТОМОБ.[КодПриц/Тягач] 
)  src 
   -- this needs an alias and it also needs a join condition. 
  on etc = src.
WHERE(dbo.КАРНЕТ.ДтВыдачи BETWEEN CONVERT(DATETIME, '2012-01-01 00:00:00',  
       102) AND CONVERT(DATETIME, '2012-12-31 00:00:00', 102))
GROUP BY ФИРМА.НаимПредпр 
```

我猜测连接列，但我想你可能想要这个：

```
SELECT ФИРМА.НаимПредпр
FROM  dbo.ФИРМА  
LEFT OUTER JOIN dbo.АВТОМОБ 
  ON dbo.АВТОМОБ.КодПредпр = dbo.ФИРМА.КодПредпр 
INNER JOIN dbo.КАРНЕТ 
  ON dbo.КАРНЕТ.КодПредпр = dbo.ФИРМА.КодПредпр 
INNER JOIN
(
  SELECT Tegaci = COUNT
            (CASE [КодПриц/Тягач]
                  WHEN 4 THEN  [КодПриц/Тягач] 
                END),
            Auto = COUNT
         (CASE [КодПриц/Тягач]
          WHEN 3 THEN  [КодПриц/Тягач] 
                         END),
      dbo.АВТОМОБ.[КодПриц/Тягач]
  FROM     dbo.АВТОМОБ
  GROUP BY dbo.АВТОМОБ.[КодПриц/Тягач] 
)  src 
   -- this needs an alias and it also needs a join condition. 
  on dbo.АВТОМОБ.[КодПриц/Тягач] = src.[КодПриц/Тягач] 
WHERE(dbo.КАРНЕТ.ДтВыдачи BETWEEN CONVERT(DATETIME, '2012-01-01 00:00:00',  
       102) AND CONVERT(DATETIME, '2012-12-31 00:00:00', 102))
GROUP BY ФИРМА.НаимПредпр 
```

# wordpress - Wordpress - 在两个小数字之间使用 meta_query

> ID：14522430
> 
> 赞同：2
> 
> 时间：2013-01-25T13:07:51.167
> 
> 标签：wordpress, metadata

我正在尝试使用 meta_query 参数来获取两个值之间的值的帖子，问题是它不适用于所有数字。

这是工作：

```
$array[] = array(
    'key' => 'd_weight',
    'value' => array(0,0.5),
    'compare' => 'BETWEEN',
    'type' => 'NUMERIC'
); 
```

但由于某种原因，这不起作用：

```
$array[] = array(
    'key' => 'd_weight',
    'value' => array(0.1,0.5),
    'compare' => 'BETWEEN',
    'type' => 'NUMERIC'
); 
```

问题只出现在小于 1 的数字上，在更大的数字上没有问题...

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-25T13:59:39.690

对于十进制数，您应该使用“DECIMAL”代替“NUMERIC”

```
$array[] = array(
    'key' => 'd_weight',
    'value' => array(0.1,0.5),
    'compare' => 'BETWEEN',
    'type' => 'DECIMAL'
); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-09-23T17:23:17.257

Mridul 的回答部分正确，但在 OP 的情况下还有更多内容，特别是在处理 BETWEEN 比较时。从 type=NUMERIC 更改为 type=DECIMAL 后，您还需要特殊处理来过滤 WP 类型转换为 DECIMAL 数据类型的方式（否则它将使用默认精度。）以下非常粗略的示例：

```
function wp_get_meta_sql_cast_decimal_precision($meta_query) {
    $meta_query['where'] = str_replace('DECIMAL', 'DECIMAL(10,3)', $meta_query['where']);
    return $meta_query;
}
add_filter('get_meta_sql', 'wp_get_meta_sql_cast_decimal_precision'); 
```

# php - openTBS 中的 changepic 函数是如何工作的？

> ID：14522431
> 
> 赞同：0
> 
> 时间：2013-01-25T13:07:56.810
> 
> 标签：php, openoffice.org, opentbs, tinybutstrong

我目前正在尝试使用带有 openTBS 插件的 TinyButStrong 库来编辑 OpenOffice 编写器模板。

如果我理解正确，您可以使用以下方法将默认图片更改为其他内容：

```
[b.number;ope=changepic;from='pic_[val].png';default=current;adjust] 
```

我尝试将其更改`from='pic_[val].png'`为`from='example.jpg'`，但这并没有改变图片。

任何人都知道如何让这个工作？帮助将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-26T23:49:15.960

在参数“from”中放置一个固定值应该强制图像（它对我有用）。

如果您的字段已被合并（即它没有出现在结果文件中）并且您没有错误消息，那么保持图像不变意味着找不到目标文件。

我认为该`'example.jpg'`文件应该放在管理 TBS 和 OpenTBS 的脚本的文件夹中。否则，您必须指定路径。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-25T19:35:41.077

你实际上不需要'from'参数来切换图片。OpenTBS 从第一个参数获取图片的路径 - 在您的情况下为 b.number （希望包含图像的路径）。也不需要调整，除非您正在调整图片大小。

```
[b.number;ope=changepic;default=current;] 
```

假设：

```
$b->number = '/path/to/image.png' 
```

还要记住，如果 b.number 是一个块，您可能需要定义块边界以填充数据。（如果您能够在`$TBS->PlugIn(OPENTBS_DEBUG_XML_SHOW)`模式下看到路径，请不要担心）`[b.number]`如果您不确定您的数据是否正在处理，请尝试使用。

# javascript - 播放 YouTube 视频而不调用在 phonegap android 中接管屏幕的播放器？

> ID：14522435
> 
> 赞同：1
> 
> 时间：2013-01-25T13:08:05.557
> 
> 标签：javascript, android, html, cordova

我正在 android 2.3.5 上的 phonegap 中创建一个应用程序。我的应用程序中有一个 YouTube 视频，我想以类似的方式显示它在浏览器上显示（即在浏览器窗口内），但是单击视频图像会调用一个接管屏幕的外部视频播放器。有没有办法在我的应用程序的窗口内播放视频而不占用屏幕（与在网络浏览器上显示的方式相同）？

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T09:47:23.420

要安装插件，请将 www/video.js 移动到项目的 www 文件夹，并在 html 文件中 phonegap.{ver}.js 之后包含对它的引用。

1.  在您的项目中创建一个名为“src/com/phonegap/plugins/video”的目录并将“src/com/phonegap/plugins/video/VideoPlayer.java”复制到其中。

2.  在您的 res/xml/plugins.xml 文件中添加以下行：

安装后，您将能够通过调用来播放视频：window.plugins.videoPlayer.play(url); url 参数可以是以下三种类型之一：

1.  播放设备本机内容的 file:// 协议，例如：window.plugins.videoPlayer.play("file:///sdcard/MyMovie.mp4");
2.  在 Internet 上播放某些东西的 http:// 协议，例如：window.plugins.videoPlayer.play(" [http://path.to.my/file.mp4](http://path.to.my/file.mp4) ");
3.  http:// 协议指向 YouTube 上的视频，例如：window.plugins.videoPlayer.play(" [http://www.youtube.com/watch?v=E0UV5i5jY50](http://www.youtube.com/watch?v=E0UV5i5jY50) "); 只要您的网址包含“youtube.com”并包含视频 ID（即 v 参数），VideoPlayer 就应该能够在您的手机上启动 YouTube 应用来播放视频，而无需任何额外的用户交互。但是，如果手机没有 YouTube 应用程序，那么您就不走运了。将来我可能会为此添加一个检查，要求用户首先安装 YouTube 应用程序。

遗憾的是，此时 VideoPlayer 不支持从您的 android 资产目录播放视频。这是以后的增强。

所以，如果你真的需要在你的 Android PhoneGap 应用程序中播放视频，你就可以使用一个非常简单易用的插件。

# android - DialogFragment 内的 VideoView

> ID：14522439
> 
> 赞同：4
> 
> 时间：2013-01-25T13:08:16.793
> 
> 标签：android, border, android-videoview, android-dialogfragment

我刚刚创建了一个自定义 DialogFragment，里面有一个 VideoView，但我遇到了一些问题。

*   视频正在播放，但出于某种奇怪的原因，视频顶部有一种黑色且非常透明的层。当然，我尝试从我的应用程序中的其他地方（不是对话窗口）播放相同的视频，并且它显示正确。很奇怪...

*   此外，对话框窗口的顶部和左侧边框消失 - 如果删除 VideoView，它们不会消失。

任何想法？提前致谢！

**编辑**

控制器

```
public class VideoPlayerFragment extends DialogFragment
{
    String json_string;

    // Constructor
    public static VideoPlayerFragment newInstance(String json_string_arg)
    {
        VideoPlayerFragment fragment = new VideoPlayerFragment();

        Bundle arguments = new Bundle();
        arguments.putString("json_string", json_string_arg);
        fragment.setArguments(arguments);

        return fragment;
    }

    @Override
    public void onCreate(Bundle savedInstanceState)
    {
        super.onCreate(savedInstanceState);

        // Set style
        setStyle(DialogFragment.STYLE_NO_TITLE, 0);
    }

    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState)
    {
        View view = inflater.inflate(R.layout.video_player, container, false);

        return view;
    }

    @Override
    public void onActivityCreated(Bundle savedInstanceState)
    {
         super.onActivityCreated(savedInstanceState);

         // Set video holder
         VideoView video_view = (VideoView) getView().findViewById(R.id.video_view);

         // Set URL
         Uri video = Uri.parse("android.resource://" + getActivity().getPackageName() + "/" + R.raw.test);
         video_view.setVideoURI(video);

         // Start video
         video_view.start();
    }
} 
```

看法

```
 <LinearLayout android:id="@+id/video"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:padding="@dimen/video_player_margin"
        android:orientation="vertical" >

        <VideoView android:id="@+id/video_view"
            android:layout_gravity="center_horizontal|center_vertical"
            android:layout_width="700dp"
            android:layout_height="400dp" />

    </LinearLayout> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-09T10:09:41.807

我遇到了同样的情况：DialogFragment中的videoview。

问题1：[这里](https://stackoverflow.com/a/5898766/1251276)可以帮助你，我也发现了；

问题 2：我认为您在方法 onActivityCreated() 中需要这些代码（此行隐藏黑色边框）

```
getDialog().getWindow().setBackgroundDrawable(new ColorDrawable(Color.TRANSPARENT)); 
```

ps：这是我在 onCreateView(,,) 中的初始化代码

```
if (getShowsDialog())
    {
        getDialog().getWindow().requestFeature(Window.FEATURE_NO_TITLE);

        getDialog().setCanceledOnTouchOutside(false);
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-30T04:33:11.787

```
 public class VideoPlayerFragment extends DialogFragment
        {
            String json_string;

            // Constructor
            public static VideoPlayerFragment newInstance(String json_string_arg)
            {
                VideoPlayerFragment fragment = new VideoPlayerFragment();

                Bundle arguments = new Bundle();
                arguments.putString("json_string", json_string_arg);
                fragment.setArguments(arguments);

                return fragment;
            }

        @Override
            public Dialog onCreateDialog(Bundle savedInstanceState) {
                Dialog dialog = new Dialog(getActivity());
                dialog.getWindow().requestFeature(Window.FEATURE_NO_TITLE);
                dialog.requestWindowFeature(Window.FEATURE_NO_TITLE);
                dialog.getWindow().setLayout(LayoutParams.MATCH_PARENT, LayoutParams.MATCH_PARENT);
                dialog.getWindow().setSoftInputMode(
                        WindowManager.LayoutParams.SOFT_INPUT_ADJUST_PAN|WindowManager.LayoutParams.SOFT_INPUT_STATE_HIDDEN);
                dialog.setCancelable(true);
                View parent= getActivity().getLayoutInflater().inflate(R.layout.video_player, null);
LinearLayout.LayoutParams layoutParams = new LinearLayout.LayoutParams(LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT);
dialog.setContentView(parent, layoutParams);
                return dialog;
            }
         @Override
            public void onActivityCreated(Bundle savedInstanceState)
            {
                 super.onActivityCreated(savedInstanceState);

                 // Set video holder
                 VideoView video_view = (VideoView) getView().findViewById(R.id.video_view);

                 // Set URL
                 Uri video = Uri.parse("android.resource://" + getActivity().getPackageName() + "/" + R.raw.test);
                 video_view.setVideoURI(video);

                 // Start video
                 video_view.start();
            } 
```

朋友尝试上面的代码。而不是创建视图尝试创建没有对话框标题的 onCreateDialog ....

# java - Determine MS Excel file type with Apache POI

> ID：14522441
> 
> 赞同：22
> 
> 时间：2013-01-25T13:08:21.507
> 
> 标签：java, excel, apache-poi

Is there a way to determine MS Office Excel file type in Apache POI? I need to know in what format is the Excel file: in Excel '97(-2007) (.xls) or Excel 2007 OOXML (.xlsx).

I suppose I could do something like this:

```
int type = PoiTypeHelper.getType(file);
switch (type) {
case PoiType.EXCEL_1997_2007:
   ...
   break;
case PoiType.EXCEL_2007:
   ...
   break;
default:
   ...
} 
```

Thanks.

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2013-01-25T14:58:42.160

Promoting a comment to an answer...

If you're going to be doing something special with the files, then [rjokelai's answer](https://stackoverflow.com/questions/14522441/determine-ms-excel-file-type-with-apache-poi/14522512#14522512) is the way to do it.

However, if you're just going to be using the HSSF / XSSF / Common SS usermodel, then it's much simpler to have POI do it for you, and use [WorkbookFactory](http://poi.apache.org/apidocs/org/apache/poi/ss/usermodel/WorkbookFactory.html) to have the type detected and opened for you. You'd do something like:

```
 Workbook wb = WorkbookFactory.create(new File("something.xls")); 
```

or

```
 Workbook wb = WorkbookFactory.create(request.getInputStream()); 
```

Then if you needed to do something special, test if it's a `HSSFWorkbook` or `XSSFWorkbook`. When opening the file, [use a File rather than an InputStream if possible](http://poi.apache.org/spreadsheet/quick-guide.html#FileInputStream) to speed things up and save memory.

If you don't know what your file is at all, use [Apache Tika](http://tika.apache.org/) to do the detection - it can detect a huge number of different file formats for you.

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2013-01-25T13:12:15.940

You can use:

```
// For .xlsx
POIXMLDocument.hasOOXMLHeader(new BufferedInputStream( new FileInputStream(file) ));

// For .xls
POIFSFileSystem.hasPOIFSHeader(new BufferedInputStream( new FileInputStream(file) )); 
```

These are essentially the methods that the `WorkbookFactory#create(InputStream)` uses for determining the type

Please note, that both method supports only streams supporting "mark" feature (or PushBackInputStream), so simple FileInputStream is not supported. Use BufferedInputStream as a wrapper. For this reason after the detection you can simply reuse the stream, since it will be reseted to the starting point.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-04-29T15:17:51.547

This can be done using the **FileMagic** class. See below JavaDoc - [https://poi.apache.org/apidocs/org/apache/poi/poifs/filesystem/FileMagic.html](https://poi.apache.org/apidocs/org/apache/poi/poifs/filesystem/FileMagic.html)

**Sample code snippet:**

`FileMagic.valueOf(inputStream).equals(FileMagic.OOXML) // XLSX`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-06-17T10:16:41.720

Based on the lib implementation of `org.apache.poi.ss.usermodel.WorkbookFactory#create(java.io.InputStream)`

We can mimic the `WorkbookFactory`'s logic, remove irrelevant bits and return file type instead.

```
public static TYPE fileType(File file) {
    try (
            InputStream inp = new FileInputStream(file)
    ) {
        if (!(inp).markSupported()) {
            return getNotMarkSupportFileType(file);
        }
        return getType(inp);
    } catch (IOException e) {
        LOGGER.error("Analyse FileType Problem.", e);
        return TYPE.INVALID;
    }
}

private static TYPE getNotMarkSupportFileType(File file) throws IOException {
    try (
            InputStream inp = new PushbackInputStream(new FileInputStream(file), 8)
    ) {
        return getType(inp);
    }
}

private static TYPE getType(InputStream inp) throws IOException {
    byte[] header8 = IOUtils.peekFirst8Bytes(inp);
    if (NPOIFSFileSystem.hasPOIFSHeader(header8)) {
        NPOIFSFileSystem fs = new NPOIFSFileSystem(inp);
        return fileType(fs);
    } else if (DocumentFactoryHelper.hasOOXMLHeader(inp)) {
        return TYPE.XSSF_WORKBOOK;
    }
    return TYPE.INVALID;
}

private static TYPE fileType(NPOIFSFileSystem fs) {
    DirectoryNode root = fs.getRoot();
    if (root.hasEntry("EncryptedPackage")) {
        return TYPE.XSSF_WORKBOOK;
    }
    return TYPE.HSSF_WORKBOOK;

}

public enum TYPE {
    HSSF_WORKBOOK, XSSF_WORKBOOK, INVALID
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-10-03T11:12:16.020

This is the way i have identified the requested file is of Office type.

```
public static boolean isOfficeDoc(String filePath) {
         FileMagic fileMagic = getFileMagicObj(filePath);
            return fileMagic != null && (fileMagic == FileMagic.OLE2 || fileMagic == FileMagic.OOXML);
        }

    private static FileMagic getFileMagicObj(String filePath) {

        try (InputStream is = new FileInputStream(filePath);
             InputStream magicIS = FileMagic.prepareToCheckMagic(is)) {

            return FileMagic.valueOf(magicIS);
        } catch (FileNotFoundException e) {
            e.printStackTrace();
            return null;
        } catch (IOException e) {
            e.printStackTrace();
            return null;
        }
    } 
```

# entity-framework - 为什么 System.Data.Metadata 异常？

> ID：14522444
> 
> 赞同：0
> 
> 时间：2013-01-25T13:08:31.640
> 
> 标签：entity-framework, asp.net-mvc-4, entity-framework-4.1, entity-framework-5

突然我得到以下异常。为了使用实体框架加载或任何与 Db 相关的操作。看不懂，有什么问题！！！！

```
 at System.Data.Metadata.Edm.StoreItemCollection.Loader.ThrowOnNonWarningErrors()
   at System.Data.Metadata.Edm.StoreItemCollection.Loader.LoadItems(IEnumerable`1 xmlReaders, IEnumerable`1 sourceFilePaths)
   at System.Data.Metadata.Edm.StoreItemCollection.Init(IEnumerable`1 xmlReaders, IEnumerable`1 filePaths, Boolean throwOnError, DbProviderManifest& providerManifest, DbProviderFactory& providerFactory, String& providerManifestToken, Memoizer`2& cachedCTypeFunction)
   at System.Data.Metadata.Edm.StoreItemCollection..ctor(IEnumerable`1 xmlReaders)
   at System.Data.Entity.ModelConfiguration.Edm.Db.DbDatabaseMetadataExtensions.ToStoreItemCollection(DbDatabaseMetadata database)
   at System.Data.Entity.ModelConfiguration.Edm.Db.Mapping.DbDatabaseMappingExtensions.ToMetadataWorkspace(DbDatabaseMapping databaseMapping)
   at System.Data.Entity.Internal.CodeFirstCachedMetadataWorkspace..ctor(DbDatabaseMapping databaseMapping)
   at System.Data.Entity.Infrastructure.DbCompiledModel..ctor(DbModel model)
   at System.Data.Entity.Infrastructure.DbModel.Compile()
   at System.Data.Entity.Internal.LazyInternalContext.CreateModel(LazyInternalContext internalContext)
   at System.Data.Entity.Internal.RetryLazy`2.GetValue(TInput input)
   at System.Data.Entity.Internal.LazyInternalContext.InitializeContext()
   at System.Data.Entity.Internal.InternalContext.Initialize()
   at System.Data.Entity.Internal.InternalContext.GetEntitySetAndBaseTypeForType(Type entityType)
   at System.Data.Entity.Internal.Linq.InternalSet`1.Initialize()
   at System.Data.Entity.Internal.Linq.InternalSet`1.get_InternalContext()
   at System.Data.Entity.Internal.Linq.InternalSet`1.get_Local()
   at System.Data.Entity.DbSet`1.get_Local() 
```

请帮我。它与数据库 Skima 有什么关系吗？无法执行任何类型的数据库操作，至少 15 分钟前，一切正常。不知道，怎么解决？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T18:03:02.967

实际问题，因为模型中的**TypeName**声明错误。它实际上与 Db Schema 不同。

# eclipse - Eclipse 市场停留在“计算需求和依赖关系”上

> ID：14522449
> 
> 赞同：2
> 
> 时间：2013-01-25T13:09:05.203
> 
> 标签：eclipse, eclipse-marketplace

在eclipse中，当我选择：安装新软件...我总是必须取消选中“在安装过程中联系所有更新站点以查找所需的软件”，否则整个事情会永远停留在计算要求和依赖项上。

我在 Marketplace 中找不到这样的选项，这会使整个市场变得毫无用处，因为我被困在同一个地方。

有没有一个选项可以解决这个问题，或者我可以用另一种方式解决它。或者我应该切换到 IntelliJ IDEA ...？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2019-11-20T10:46:26.193

如果您从 zip 或 jar 文件在本地安装插件，您可以简单地取消选中该选项：“在安装过程中联系所有更新站点以查找所需的软件”

但是，这并不能完全解决问题，并且在 Eclipse Marketplace 中没有这样的选项可以取消选中，您可能会永远被“计算需求和依赖项”所困扰。

真正的问题是 Eclipse 中提供的可用软件站点。基本上，上面的选项将让 Eclipse 连接到每个启用的站点并等待所有站点响应。因此，即使只有 1 个站点有问题并且没有响应，Eclipse 也会永远等待。

您可以通过在“安装新软件...”或“Windows -> 首选项 -> 安装/更新 -> 可用软件站点”中选择“添加”旁边的“管理”按钮进行配置

它就像测试列表中的每个站点并禁用/删除任何无法连接的站点一样简单，尤其是用户添加的可能包含拼写错误的外部站点。

上述解决方案在大多数情况下应该可以工作，但如果不能，请检查您的连接并禁用代理、防火墙或允许 Eclipse 通过它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-07-26T05:16:04.317

在 Eclipse Oxygen（2017 年 6 月）和可用软件站点中，我已将“Eclipse Orbit Composite”的位置更新为[http://download.eclipse.org/tools/orbit/downloads/中的最后一个 buid 存储库](http://download.eclipse.org/tools/orbit/downloads/)

示例：来自：...download.eclipse.org/tools/orbit/downloads/drops/R20150821153341/repository/

至： ...download.eclipse.org/tools/orbit/R-builds/R20170516192513/repository

更新：将 DNS 路由器更改为 DNS google 8.8.8.8/8.8.4.4 对我有用！

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2013-06-06T01:41:05.133

按着这些次序。

1.  启动 Eclipse，然后选择帮助 > 安装新软件...。单击右上角的添加。
2.  在出现的 Add Repository 对话框中，为 Name 输入“ADT Plugin”，为 Location 输入以下 URL： [https](https://dl-ssl.google.com/android/eclipse/) ://dl-ssl.google.com/android/eclipse/单击 OK

注意：如果您在获取插件时遇到问题，请尝试在 Location URL 中使用“http”，而不是“https”（出于安全原因，首选 https）

1.  在可用软件对话框中，选中开发人员工具旁边的复选框，然后单击下一步。在下一个窗口中，您将看到要下载的工具列表。点击下一步。阅读并接受许可协议，然后单击完成。

注意：如果您收到无法确定软件真实性或有效性的安全警告，请单击“确定”。安装完成后，重新启动 Eclipse。

# jquery - WordPress - 嵌入内容滑块（最简单的方法）

> ID：14522454
> 
> 赞同：0
> 
> 时间：2013-01-25T13:09:17.630
> 
> 标签：jquery, wordpress, slider, embed

我真的不确定出了什么问题。我怀疑这是许多人会遇到的问题，因为这是一种愚蠢的做法。我已经搜索了一段时间的答案，但要么找不到答案，要么太高级以至于我无法理解（PHP 与 WordPress 代码混合）

我对 PHP 的了解为零。HTML 和 CSS 适中。

我用一个 jQuery 插件（不是 WordPress 插件）制作了一个内容滑块，你可以在这里看到：http: [//invigoratebusiness.com/ax1/Slider.html](http://invigoratebusiness.com/ax1/Slider.html)

我有一个 WordPress 网站，我也想添加滑块，但我想尽可能快速和轻松地完成它。我想使用 iframe 或嵌入。

这是我嵌入它的方式：

```
<embed src="http://invigoratebusiness.com/ax1/Slider.html" width="960" height="590"> 
```

还添加了 scrolling="no" 但无济于事

我通过 HTML 页面编辑器将它添加到 WordPress（与“视觉”编辑器相对）。

现在的问题是：

[1] 其上方或下方的空白区域过多。一旦它被添加到 WordPress 并且如果我缩小嵌入代码中的“height="590"（滑块的高度不太像 450 - 500 px），它会不必要地添加滚动条并且仍然有太多的空白空间。

例如：http: [//i.imgur.com/DPtZ6V0.png](http://i.imgur.com/DPtZ6V0.png)

[2] 我注意到，一旦添加到 WordPress 中，它也没有出现在 Chrome 中（适用于 Safari、Opera 并且没有测试 Moz），并且当它**没有嵌入**到 Chrome 中时，滑块本身也能正常工作。

希望我已经解释清楚了！不是很容易。我真的很感激一些帮助或建议......或其他方法（如果简单的话）滑块包括 jQuery、一个单独的 CSS 文件和 HTML。滑块基于 SudoSlider：

```
webbies.dk/SudoSlider/ 
```

非常感谢您的时间！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T10:59:47.607

换成`embed`，`iframe`你的身高也差了很多。它应该是：

```
<iframe width="960" height="460" src="http://invigoratebusiness.com/ax1/Slider.html"> 
```

现在非常适合我。

# google-app-engine - 从 blobstore 读取 Excel 文件时出错

> ID：14522458
> 
> 赞同：0
> 
> 时间：2013-01-25T13:09:30.773
> 
> 标签：google-app-engine, gwt, blobstore

我正在使用 gwt 2.4。我可以读取 txt 文件，但无法读取 Excel 文件。我也可以加载图像，但我看不到问题。
我的代码如下：

```
FileService fileService = FileServiceFactory.getFileService();
BlobKey blobKey = new BlobKey("NGIaxo54x--DEHtPBy5bLw");
AppEngineFile appFile = fileService.getBlobFile(blobKey);

FileReadChannel readChannel = fileService.openReadChannel(appFile, false);
BufferedReader reader =  new BufferedReader(Channels.newReader(readChannel, "UTF8"));
String line = reader.readLine();
System.out.println("Data : "+line); 
```

我收到以下错误：

```
java.nio.charset.MalformedInputException: Input length = 1
at java.nio.charset.CoderResult.throwException(Unknown Source)
at sun.nio.cs.StreamDecoder.implRead(Unknown Source)
at sun.nio.cs.StreamDecoder.read(Unknown Source)
at java.io.BufferedReader.fill(Unknown Source)
at java.io.BufferedReader.readLine(Unknown Source)
at java.io.BufferedReader.readLine(Unknown Source)
at com.wa.gwtamazon.server.BlobServiceImpl.getPicture(BlobServiceImpl.java:75)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
at java.lang.reflect.Method.invoke(Unknown Source)
at com.google.appengine.tools.development.agent.runtime.Runtime.invoke(Runtime.java:104)
at com.google.gwt.user.server.rpc.RPC.invokeAndEncodeResponse(RPC.java:569)
at com.google.gwt.user.server.rpc.RemoteServiceServlet.processCall(RemoteServiceServlet.java:208)
at com.google.gwt.user.server.rpc.RemoteServiceServlet.processPost(RemoteServiceServlet.java:248)
at com.google.gwt.user.server.rpc.AbstractRemoteServiceServlet.doPost(AbstractRemoteServiceServlet.java:62)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:637)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
at org.mortbay.jetty.servlet.ServletHolder.handle(ServletHolder.java:511)
at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1166)
at com.google.appengine.tools.development.HeaderVerificationFilter.doFilter(HeaderVerificationFilter.java:35)
at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
at com.google.appengine.api.blobstore.dev.ServeBlobFilter.doFilter(ServeBlobFilter.java:60)
at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
at com.google.apphosting.utils.servlet.TransactionCleanupFilter.doFilter(TransactionCleanupFilter.java:43)
at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
at com.google.appengine.tools.development.StaticFileFilter.doFilter(StaticFileFilter.java:122)
at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
at com.google.appengine.tools.development.BackendServersFilter.doFilter(BackendServersFilter.java:97)
at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
at org.mortbay.jetty.servlet.ServletHandler.handle(ServletHandler.java:388)
at org.mortbay.jetty.security.SecurityHandler.handle(SecurityHandler.java:216)
at org.mortbay.jetty.servlet.SessionHandler.handle(SessionHandler.java:182)
at org.mortbay.jetty.handler.ContextHandler.handle(ContextHandler.java:765)
at org.mortbay.jetty.webapp.WebAppContext.handle(WebAppContext.java:418)
at com.google.appengine.tools.development.DevAppEngineWebAppContext.handle(DevAppEngineWebAppContext.java:78)
at org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:152)
at com.google.appengine.tools.development.JettyContainerService$ApiProxyHandler.handle(JettyContainerService.java:362)
at org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:152)
at org.mortbay.jetty.Server.handle(Server.java:326)
at org.mortbay.jetty.HttpConnection.handleRequest(HttpConnection.java:542)
at org.mortbay.jetty.HttpConnection$RequestHandler.content(HttpConnection.java:938)
at org.mortbay.jetty.HttpParser.parseNext(HttpParser.java:755)
at org.mortbay.jetty.HttpParser.parseAvailable(HttpParser.java:218)
at org.mortbay.jetty.HttpConnection.handle(HttpConnection.java:404)
at org.mortbay.io.nio.SelectChannelEndPoint.run(SelectChannelEndPoint.java:409)
at org.mortbay.thread.QueuedThreadPool$PoolThread.run(QueuedThreadPool.java:582) 
```

我还发现，这是一个错误，但仍然没有找到任何解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T13:25:54.030

当字符编码出现问题时，将引发[MalformedInputException 。](http://docs.oracle.com/javase/1.4.2/docs/api/java/nio/charset/MalformedInputException.html)

检查文件是否确实在`UTF-8,`接下来检查您的 IDE，最后但并非最不重要的，您的代码。

希望这可以帮助 ：）

# c# - 通过给定的 PnpDeviceID 确定 COM 端口号：COM 端口设备的 DeviceID 是否始终为“COMx”？

> ID：14522460
> 
> 赞同：0
> 
> 时间：2013-01-25T13:09:34.303
> 
> 标签：c#, serial-port, wmi, device-manager

我需要确定即插即用设备的 COM 端口。我有 PnPDeviceID。这是一个蓝牙 USB 加密狗。

因此，我使用 WMI 检索有关设备的信息，就像[本网站](http://www.creativecodedesign.com/node/39)的第一个示例一样。WMI 查询的结果包含一个属性“DeviceID”，它是一个字符串。我的值是“COM3”。

当我这样做时，我得到了相同的值（而不是使用 WMI）

```
string[] names = System.IO.Ports.SerialPort.GetPortNames(); 
```

现在我想知道，如果 COM-Devices 的 DeviceId 总是具有“COMx”格式？我实际上需要一个名为“Port”的属性，其值为整数。

还有另一种方法可以检查注册表，但我不知道是否建议这样做。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T20:40:57.383

见 Hans Passant 的评论。它们通常被命名为 COMx。你应该让用户选择。

对我来说更重要的是：通常没有必要将 com 端口号作为整数，因为 Com 端口名称（字符串）被广泛用作标识符，例如 System.io... 他们采用字符串“COM3”或驱动程序特定名称。

# java - .CDB 文件在 java 堆栈跟踪中代表什么？

> ID：14522464
> 
> 赞同：0
> 
> 时间：2013-01-25T13:09:46.613
> 
> 标签：java, stack-trace

问起来似乎有点幼稚，但我真的很想知道 *.CDB 是什么类型的源文件？

例如，

```
 at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:236)
   at     com.tangosol.coherence.component.util.daemon.queueProcessor.service.peer.acceptor.TcpAcceptor$TcpProcessor.onRead(TcpAcceptor.CDB:53)
    at   com.tangosol.coherence.component.util.daemon.queueProcessor.service.peer.acceptor.TcpAcceptor$TcpProcessor.onSelect(TcpAcceptor.CDB:44)
   at com.tangosol.coherence.component.util.daemon.queueProcessor.service.peer.acceptor.TcpAcceptor$TcpProcessor.onNotify(TcpAcceptor.CDB:13)
   at com.tangosol.coherence.component.util.Daemon.run(Daemon.CDB:42)
   at java.lang.Thread.run(Thread.java:619) 
```

您可以看到所有 com.tangosol 类都有针对 *.CDB 文件的行号，而其他类以 *.java 文件结尾。

# xml - 用于读取数据驱动单元测试的 XML 文件测试数据的连接字符串

> ID：14522471
> 
> 赞同：2
> 
> 时间：2013-01-25T13:10:01.910
> 
> 标签：xml

我有一个 XML 数据文件，其中包含用于数据驱动单元测试的测试数据。现在我想在单元测试项目中添加一个连接字符串和一个数据源。我曾尝试遵循连接字符串，但它没有用。

```
<add name="MyXMLConn" connectionString="Provider=Microsoft.Jet.OLEDB.4.0; Data Source=C:\XMLData.xml;" providerName="System.Data.OleDb" /> 
```

有人可以在这方面帮助我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-17T16:33:49.120

我不确定，但它可能是`;`连接字符串末尾的分号吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-06-15T08:47:37.000

应该是这样的：-

"<"add name="MyXML" connectionString="|DataDirectory|\\xmlFileName.xml" providerName="Microsoft.VisualStudio.TestTools.DataSource.XML"/>

添加前删除双引号

并在测试方法上方添加此行

[DeploymentItem(@"..\..\Data.xml")] //我把.xml文件放到测试项目的根目录下 [DataSource("MyXMLDataSource")]

我希望它有帮助

# ios - 在 iOS 应用中通过选择广播队列中的时间段购买广告

> ID：14522472
> 
> 赞同：0
> 
> 时间：2013-01-25T13:10:02.003
> 
> 标签：ios, in-app-purchase, ads

我有这样的需求，

1.  用户转到应用程序中的广告部分，所有广告都显示在表格中。他将选择需要在广播队列中显示的广告以及何时显示。在插入队列之前需要购买广告。

2.  队列是向用户广播的一系列音频对象。这类似于收音机。

有人可以告诉我应该如何在应用程序中实施广告购买吗？我是否需要通过应用内购买或通过第三方支付选项（如贝宝等）进行。请提供一些输入。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T13:49:57.857

由于您销售的“广告”是数字商品，因此您必须使用 Apple 应用内购买系统。这是苹果的要求。

您只能使用 Paypal API（或任何其他支付网关）购买实物商品。还有慈善捐款。

[这是一个详细描述它的链接。](http://www.absoluteripple.com/1/post/2012/02/apples-in-app-purchase-when-do-we-have-to-use-it.html)

# java - 如何在 JBoss7.1.1.Final 中创建多个持久化单元名称

> ID：14522478
> 
> 赞同：2
> 
> 时间：2013-01-25T13:10:25.623
> 
> 标签：java, hibernate, jpa, persistence, jboss7.x

我正在将 jboss 服务器 4.1.2 升级到 jboss 7.1.1，所以出现异常是

```
15:51:24,655 ERROR [org.jboss.msc.service.fail] (MSC service thread 1-4) MSC00001: Failed to start service jboss.deployment.unit."mobeeadmin.war".DEPENDENCIES: org.jboss.msc.service.StartException in service jboss.deployment.unit."mobeeadmin.war".DEPENDENCIES: Failed to process phase DEPENDENCIES of deployment "mobeeadmin.war"
    at org.jboss.as.server.deployment.DeploymentUnitPhaseService.start(DeploymentUnitPhaseService.java:119) [jboss-as-server-7.1.1.Final.jar:7.1.1.Final]
    at org.jboss.msc.service.ServiceControllerImpl$StartTask.startService(ServiceControllerImpl.java:1811) [jboss-msc-1.0.2.GA.jar:1.0.2.GA]
    at org.jboss.msc.service.ServiceControllerImpl$StartTask.run(ServiceControllerImpl.java:1746) [jboss-msc-1.0.2.GA.jar:1.0.2.GA]
    at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886) [rt.jar:1.6.0_37]
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908) [rt.jar:1.6.0_37]
    at java.lang.Thread.run(Thread.java:662) [rt.jar:1.6.0_37]
Caused by: java.lang.IllegalArgumentException: JBAS011470: Persistence unitName was not specified and there are 3 persistence unit definitions in application deployment "mobeeadmin.war".  Either change the application to have only one persistence unit definition or specify the unitName for each reference to a persistence unit.
    at org.jboss.as.jpa.container.PersistenceUnitSearch.resolvePersistenceUnitSupplier(PersistenceUnitSearch.java:69)
    at org.jboss.as.jpa.processor.JPAAnnotationParseProcessor.getPersistenceUnit(JPAAnnotationParseProcessor.java:284)
    at org.jboss.as.jpa.processor.JPAAnnotationParseProcessor.getBindingSource(JPAAnnotationParseProcessor.java:220)
    at org.jboss.as.jpa.processor.JPAAnnotationParseProcessor.processField(JPAAnnotationParseProcessor.java:151)
    at org.jboss.as.jpa.processor.JPAAnnotationParseProcessor.processPersistenceAnnotations(JPAAnnotationParseProcessor.java:118)
    at org.jboss.as.jpa.processor.JPAAnnotationParseProcessor.deploy(JPAAnnotationParseProcessor.java:90)
    at org.jboss.as.server.deployment.DeploymentUnitPhaseService.start(DeploymentUnitPhaseService.java:113) [jboss-as-server-7.1.1.Final.jar:7.1.1.Final]
    ... 5 more 
```

应用环境为seam2.1.2，集成了jpa、richfaces、jsf。如何在 jboss 7.1.1 中声明多个持久性单元。

我的 components.xml

```
<core:init debug="false" jndi-pattern="@jndiPattern@" transaction-management-   enabled="true"/>
<core:manager concurrent-request-timeout="2000"
    conversation-id-parameter="cid" conversation-timeout="120000"

<web:hot-deploy-filter url-pattern="/*.mobee" />

<persistence:entity-manager-factory
    installed="@seamBootstrapsPu@" name="entityManagerFactory"
    persistence-unit-name="pu1" />
<persistence:managed-persistence-context 
    auto-create="true" entity-manager-factory="@seamEmfRef@" name="entityManager"
    persistence-unit-jndi-name="@puJndiName@" />

 <persistence:entity-manager-factory name="empEntityManagerFactory" 
                  persistence-unit-name="pu2"/>

    <persistence:managed-persistence-context name="empEntityManager"
    auto-create="true" entity-manager-factory="#{empEntityManagerFactory}"
    persistence-unit-jndi-name="java:/pu2Database"/>

<async:quartz-dispatcher />

<security:identity authenticate-method="#{authenticator.authenticate}" />

<web:rewrite-filter view-mapping="*.mobee" />

<event type="org.jboss.seam.security.notLoggedIn">
    <action execute="#{redirect.captureCurrentView}" />
</event>

<event type="org.jboss.seam.security.loginSuccessful">
    <action execute="#{redirect.returnToCapturedView}" />
</event>
<mail:mail-session host="localhost" port="25" /> 
```

持久性.xml

```
<persistence-unit name="pu1" transaction-type="JTA">
        <provider>org.hibernate.ejb.HibernatePersistence</provider>
        <jta-data-source>java:/sample1</jta-data-source>

        <mapping-file>META-INF/orm.xml</mapping-file>

        <exclude-unlisted-classes>true</exclude-unlisted-classes>
        <properties>

            <property name="hibernate.dialect" value="org.hibernate.dialect.OracleDialect" />
            <property name="hibernate.hbm2ddl.auto" value="update" />
            <property name="hibernate.jdbc.batch_size" value="20" />
            <property name="hibernate.cache.use_second_level_cache"
                value="false" />
            <property name="hibernate.show_sql" value="false" />

            <property name="hibernate.transaction.manager_lookup_class"
                value="@transactionManagerLookupClass@" />

          <property name="jboss.entity.manager.factory.jndi.name" value="@puJndiName@ "/>
        </properties>
    </persistence-unit>

    <persistence-unit name="pu2" transaction-type="JTA">
        <provider>org.hibernate.ejb.HibernatePersistence</provider>
        <jta-data-source>java:/sample2</jta-data-source>

        <mapping-file>META-INF/emp2Orm.xml</mapping-file>

        <exclude-unlisted-classes>true</exclude-unlisted-classes>
        <properties>

            <property name="hibernate.dialect" value="org.hibernate.dialect.OracleDialect" />
            <property name="hibernate.hbm2ddl.auto" value="update" />
            <property name="hibernate.jdbc.batch_size" value="20" />
            <property name="hibernate.cache.use_second_level_cache"
                value="false" />
            <property name="hibernate.show_sql" value="false" />

                <property name="hibernate.transaction.manager_lookup_class"
                value="org.hibernate.transaction.JBossTransactionManagerLookup" />

               <property name="jboss.entity.manager.factory.jndi.name" value="java:/pu2Database" />

        </properties>
    </persistence-unit> 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2014-04-25T18:01:46.107

我也在做同样的事情。我正在将我的 spring 应用程序移动到 Jboss 8 (WildFly)。我得到了同样的错误。谷歌搜索了几个小时后，我终于找到了解决方案。

转到 \\standalone\configuration。

打开standalone.xml。并寻找

子系统 xmlns="urn:jboss:domain:jpa:1.1

注释该标签，然后重新启动服务器。它现在应该可以工作了。 ![在此处输入图像描述](../Images/a124d05f1f0ada493092912e5b86155a.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T21:08:26.090

我将比 JBoss 绕过 Seam 注入机制注入实体管理器。

[似乎让接缝 2 在 JBoss 7 上工作，您需要进行一些更改](https://docs.jboss.org/author/display/AS71/Example+Applications+-+Migrated+to+AS7)

[我发现另一个似乎要求 JBoss 不关心 JPA](http://www.solutionsfit.com/2012/10/19/upgrading-a-seam-2-app-to-jboss-7/)

另一个解决方案是升级到 Seam 3。

# google-maps - 即使 lat long 设置为其他地方，地方自动完成总是返回芝加哥结果

> ID：14522479
> 
> 赞同：1
> 
> 时间：2013-01-25T13:10:33.073
> 
> 标签：google-maps, location, google-places-api

我正在使用 Google Places API 检查附近的地点并让用户选择一个。一切正常，但我遇到了位置问题，如果我将经度和纬度发送到 api 调用进行搜索，例如“麦当劳”，我会在芝加哥而不是旧金山得到结果......

任何想法可能发生什么？这是我的查询：

```
https://maps.googleapis.com/maps/api/place/autocomplete/json?input=mcdonald&types=establishment&location=37.76999,-122.44696&sensor=false&key=hereIsWhereMyKeyGoes 
```

这是谷歌的文档：[https ://developers.google.com/places/documentation/autocomplete](https://developers.google.com/places/documentation/autocomplete)

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T15:48:28.077

您需要定义`radius`要在其中搜索。

```
https://maps.googleapis.com/maps/api/place/autocomplete/json?input=mcdonald&types=establishment&location=37.76999,-122.44696&radius=20&sensor=false&key=hereIsWhereMyKeyGoe 
```

我曾经对来自芝加哥的结果有类似的问题，因此它必须是某种默认搜索区域。要在某个位置附近搜索，您必须提供`location`and`radius`参数。

# java - 如何在 Eclipse 中运行 doclet

> ID：14522481
> 
> 赞同：0
> 
> 时间：2013-01-25T13:10:39.343
> 
> 标签：java, javadoc, doclet

参考帖子中给出的示例：[http ://www.javaworld.com/jw-08-2000/jw-0818-javadoc.html#resources](http://www.javaworld.com/jw-08-2000/jw-0818-javadoc.html#resources)

帖子中的示例：SimpleDoclet 和 SimpleOrder

我需要知道我需要在哪里放置 SimpleDoclet 和 SimpleOrder 以及如何运行这个 doclet 来生成输出？

我尝试将 Generate JavaDoc 与以下数据一起使用：

有两个包：newPack 包含我应该为其生成 javadoc 的类和 oldPack 存在 SimpleDoclet

你能告诉我一个解决方案吗？ ![Javadoc](../Images/69267861bc59ff67bfc9372c18413c18.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-22T15:14:51.717

我有同样的问题; 这是我的解决方案：

1.  我`SimpleDoclet`在包中创建`codegen.samples`
2.  我已经导出`SimpleDoclet`为`jarname.jar``C:\xx`
3.  在 Eclipse 中，设置 Doclet Name:`codegen.samples.SimpleDoclet`和 Doclet 类路径： `c:\xx\jarname.jar`
4.  要求私有可见性（获取所有 atts 和方法）

# decode - 了解 ASN.1 整数 PER 编码

> ID：14522483
> 
> 赞同：3
> 
> 时间：2013-01-25T13:10:40.397
> 
> 标签：decode, wireshark, asn.1

考虑 h225 Ras 注册请求 (RRQ) 的 Wireshark 跟踪：

![在此处输入图像描述](../Images/ee6eab046b1a39d2737ac3d5fd3160eb.png)

如您所见，Wireshark 解码`requestSeqNum`为 25601，但字节表示为 0x6400，即 25600。我查看了 ASN.1 PER 编码规则，但找不到必须将值增加 1 的原因。我的问题，wireshark 是否正确解码，如果是，我在哪里可以在规范中找到它？

ASN.1 代码：

```
RequestSeqNum       ::= INTEGER (1..65535) 
```

事实上，Wireshark 始终`requestSeqNum`为所有 h225 消息加 1。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T16:20:04.133

没关系，

在[规范](http://www.itu.int/rec/dologin_pub.asp?lang=e&id=T-REC-X.691-200811-I!!PDF-E&type=items)中找到它：

> 11.5.7.3（两个八位字节的情况。）如果“范围”的值大于或等于 257 且小于或等于 64K，则该值（“n”-“lb”）应编码为两个八位字节的位域（对齐变体中的八位字节对齐）作为 11.3 中指定的非负二进制整数编码。

lb （下限）在这种情况下是 1 ，所以这解释了我的问题。我在看规范中的错误位置，阅读规范让我头疼:)

# javascript - 仅显示 Javascript 中的浏览器版本

> ID：14522485
> 
> 赞同：2
> 
> 时间：2013-01-25T13:10:47.637
> 
> 标签：javascript

我有以下代码：

```
var N = navigator.appName, ua = navigator.userAgent, tem;
    var M = ua.match(/(opera|chrome|safari|firefox|msie)\/?\s*(\.?d+(\.\d)*)/i);
    if (M && (tem = ua.match(/version\/([\.\d]+)/i)) != null) M[2] = tem[1];
    M = M ? [M[1], M[2]] : [N, navigator.appVersion, '-?'];
        document.write(M); 
```

给我输出：

铬，24.0.1312.56

我想知道是否可以只显示版本类型，如下所示：24.0.1312.56

我不知道如何使用此代码执行此操作，我在互联网上找到了它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T13:14:15.543

更改`document.write(M);`为`document.write(M[1]);`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T13:18:57.203

以下是 Chrome、Firefox、Opera、Safari 和 IE 的代码：

```
"use strict";
var BrowserDetect = {
    init: function () {
        this.browser = this.searchString(this.dataBrowser) || "An unknown browser";
        this.version = this.searchVersion(navigator.userAgent)
            || this.searchVersion(navigator.appVersion)
            || "an unknown version";
        this.OS = this.searchString(this.dataOS) || "an unknown OS";
    },
    searchString: function (data) {
        for (var i=0;i<data.length;i++) {
            var dataString = data[i].string;
            var dataProp = data[i].prop;
            this.versionSearchString = data[i].versionSearch || data[i].identity;
            if (dataString) {
                if (dataString.indexOf(data[i].subString) != -1)
                    return data[i].identity;
            }
            else if (dataProp)
                return data[i].identity;
        }
    },
    searchVersion: function (dataString) {
        var index = dataString.indexOf(this.versionSearchString);
        if (index == -1) return;
        return parseFloat(dataString.substring(index+this.versionSearchString.length+1));
    },
    dataBrowser: [
        {
            string: navigator.userAgent,
            subString: "Chrome",
            identity: "Chrome"
        },
        {
            string: navigator.vendor,
            subString: "Apple",
            identity: "Safari",
            versionSearch: "Version"
        },
        {
            prop: window.opera,
            identity: "Opera",
            versionSearch: "Version"
        },
        {
            string: navigator.userAgent,
            subString: "Firefox",
            identity: "Firefox"
        },
        {
            string: navigator.userAgent,
            subString: "MSIE",
            identity: "Explorer",
            versionSearch: "MSIE"
        }
    ],
    dataOS : [
        {
            string: navigator.platform,
            subString: "Win",
            identity: "Windows"
        },
        {
            string: navigator.platform,
            subString: "Mac",
            identity: "Mac"
        },
        {
            string: navigator.platform,
            subString: "Linux",
            identity: "Linux"
        }
    ]

};
BrowserDetect.init();

alert("*Browser: " + BrowserDetect.browser);
alert("*Version: " + BrowserDetect.version); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-25T13:13:29.333

也许尝试使用这种方法：[http ://www.quirksmode.org/js/detect.html](http://www.quirksmode.org/js/detect.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-25T13:14:58.883

```
var nVer = navigator.appVersion;
var nAgt = navigator.userAgent;

var fullVersion  = ''+parseFloat(navigator.appVersion); 

// In Opera, the true version is after "Opera" or after "Version"
if ((verOffset=nAgt.indexOf("Opera"))!=-1) {
fullVersion = nAgt.substring(verOffset+6);
if ((verOffset=nAgt.indexOf("Version"))!=-1) 
fullVersion = nAgt.substring(verOffset+8);
}
// In MSIE, the true version is after "MSIE" in userAgent
else if ((verOffset=nAgt.indexOf("MSIE"))!=-1) {
fullVersion = nAgt.substring(verOffset+5);
}
// In Chrome, the true version is after "Chrome" 
else if ((verOffset=nAgt.indexOf("Chrome"))!=-1) {
fullVersion = nAgt.substring(verOffset+7);
}
// In Safari, the true version is after "Safari" or after "Version" 
else if ((verOffset=nAgt.indexOf("Safari"))!=-1) {
fullVersion = nAgt.substring(verOffset+7);
if ((verOffset=nAgt.indexOf("Version"))!=-1) 
fullVersion = nAgt.substring(verOffset+8);
}
// In Firefox, the true version is after "Firefox" 
else if ((verOffset=nAgt.indexOf("Firefox"))!=-1) {
fullVersion = nAgt.substring(verOffset+8);
}
// In most other browsers, "name/version" is at the end of userAgent 
else if ( (nameOffset=nAgt.lastIndexOf(' ')+1) < 
      (verOffset=nAgt.lastIndexOf('/')) ) 
{
fullVersion = nAgt.substring(verOffset+1);

}
// trim the fullVersion string at semicolon/space if present
if ((ix=fullVersion.indexOf(";"))!=-1)
fullVersion=fullVersion.substring(0,ix);
if ((ix=fullVersion.indexOf(" "))!=-1)
fullVersion=fullVersion.substring(0,ix);

majorVersion = parseInt(''+fullVersion,10);
if (isNaN(majorVersion)) {
fullVersion  = ''+parseFloat(navigator.appVersion); 
majorVersion = parseInt(navigator.appVersion,10);
}

document.write(''
+'Full version  = '+fullVersion+'<br>'
) 
```

# php - MySQL 连接在 PHP 中有效，但在 ASP 中无效

> ID：14522487
> 
> 赞同：2
> 
> 时间：2013-01-25T13:10:54.593
> 
> 标签：php, mysql, database, asp-classic, connection

我必须使用 ASP 与远程服务器建立 MySQL 数据库连接。当我使用普通的 PHP 时，一切都很好。如果我使用以下 ASP 代码

```
Set oConn = Server.CreateObject("ADODB.Connection")
oConn.Open "Provider=MSDASQL;" & _  
           "Driver={SQL Server};" & _
           "Server=mysqlsvr.domain.com;" & _
           "Database=database1;" & _
           "Uid=username;" & _
           "Pwd=password" 
```

我总是收到无法访问数据库或权限被拒绝的错误......但是使用 PHP 一切正常？！你知道问题出在哪里吗？

提前致谢。问候。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T13:24:03.517

连接字符串错误。尝试：

```
"DRIVER={MySQL ODBC 3.51 Driver}; SERVER=mysqlsvr.domain.com; DATABASE=database1; UID=username;PASSWORD=password;" 
```

您需要安装 Mysql ODBC 驱动程序

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T13:45:36.767

无需 DSN 即可连接

**'定义连接字符串，指定数据库驱动**

```
ConnString = "DRIVER={MySQL ODBC 3.51 Driver}; SERVER=localhost; DATABASE=Your_Mysql_DB; " &_ "UID=mysql_username;PASSWORD=mysql_password; OPTION=3" 
```

**'创建 ADO 连接和记录集对象的实例**

```
 Set Connection = Server.CreateObject("ADODB.Connection")
 Set Recordset = Server.CreateObject("ADODB.Recordset") 
```

与 DSN 的连接

**'创建 ADO 连接和记录集对象的实例**

```
Set Connection = Server.CreateObject("ADODB.Connection")
Set Recordset = Server.CreateObject("ADODB.Recordset") 
```

**'打开与数据库的连接**

```
Connection.Open "DSN=dsn_name" 
```

**'打开执行SQL语句的记录集对象并返回记录**

```
Recordset.Open SQL,Connection 
```

# java - 使用 MTOM 进行 WS 下载操作

> ID：14522489
> 
> 赞同：2
> 
> 时间：2013-01-25T13:11:02.240
> 
> 标签：java, performance, web-services, weblogic, mtom

我想通过带有 MTOM 的 WS 直接从 Oracle 数据库 blobs 文件流式传输到 WS 客户端。

我以为我找到了这里描述的方法：

[http://www.java.net/forum/topic/glassfish/metro-and-jaxb/mtom-best-practices](http://www.java.net/forum/topic/glassfish/metro-and-jaxb/mtom-best-practices)

但是在我查看了 InputStreamDataSource 和 javax.mail.util.ByteArrayDataSource 之后，我意识到它们实际上是内存中“文档”的一个字节 []，这意味着流媒体的想法是徒劳的，因为我试图避免的是多个文档在同一时间完全在内存中。

那么如何通过 WS 和 MTOM 从 DB 流式传输到 WS 客户端？

任何想法 ？

谢谢

克里斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T18:06:22.393

我尝试了试验，最后我得到了一些积极的结果。

为了从 DB 直接流式传输到客户端浏览器，上述内容是有效的，但 InputStreamDataSource 应该是这样的：

```
public class InputStreamDataSource implements DataSource {
    private InputStream inputStream;

    public InputStreamDataSource(InputStream inputStream) {
        this.inputStream = inputStream;
    }

    public InputStream getInputStream() throws IOException {
        return inputStream;
    }

    public OutputStream getOutputStream() throws IOException {
        throw new UnsupportedOperationException("Not implemented");
    }

    public String getContentType() {
        return "*/*";
    }

    public String getName() {
        return "InputStreamDataSource";
    }
} 
```

我害怕的是，一旦我自己关闭了输入流...... ws 客户端没有收到二进制内容......

比我检查，实际上 DataHandler 创建了一个新线程并关闭了输入流

我能够将 500MB 从 DB 快速流式传输到客户端，并且内存占用少！

# c++ - 使用 const 引用删除引用

> ID：14522496
> 
> 赞同：10
> 
> 时间：2013-01-25T13:11:17.570
> 
> 标签：c++, templates, c++11, std

对于参数类 C，无论指针、常量或引用修饰符如何，我都希望始终获得“原始”类型。

```
template<typename __T>
class C
{
public:
    typedef std::some_magic_remove_all<__T>::type T;
}

int main()
{
    C<some_type>::type a;
} 
```

例如，对于`some_type`等于：

*   `int&`
*   `int**`
*   `int*&`
*   `int const &&`
*   `int const * const`
*   等等

我想要`a`的总是类型`int`。我怎样才能实现它？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-25T13:45:21.870

如果你想更多地使用标准库，你可以这样做：

```
#include <type_traits>
template<class T, class U=
  typename std::remove_cv<
  typename std::remove_pointer<
  typename std::remove_reference<
  typename std::remove_extent<
  T
  >::type
  >::type
  >::type
  >::type
  > struct remove_all : remove_all<U> {};
template<class T> struct remove_all<T, T> { typedef T type; }; 
```

它会删除东西，直到不再改变类型。使用更新的标准，这可以缩短为

```
template<class T, class U=
  std::remove_cvref_t<
  std::remove_pointer_t<
  std::remove_extent_t<
  T >>>>
  struct remove_all : remove_all<U> {};
template<class T> struct remove_all<T, T> { typedef T type; };
template<class T> using remove_all_t = typename remove_all<T>::type; 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-01-25T13:21:48.720

```
template<class T> struct remove_all { typedef T type; };
template<class T> struct remove_all<T*> : remove_all<T> {};
template<class T> struct remove_all<T&> : remove_all<T> {};
template<class T> struct remove_all<T&&> : remove_all<T> {};
template<class T> struct remove_all<T const> : remove_all<T> {};
template<class T> struct remove_all<T volatile> : remove_all<T> {};
template<class T> struct remove_all<T const volatile> : remove_all<T> {};
//template<class T> struct remove_all<T[]> : remove_all<T> {};
//template<class T, int n> struct remove_all<T[n]> : remove_all<T> {}; 
```

我最初也剥离了范围（数组），但 Johannes 注意到这会导致 的歧义`const char[]`，并且问题没有提及它们。如果我们还想剥离数组（另请参阅评论中提到的想法），以下内容不会使事情变得太复杂：

```
#include <type_traits>
template<class U, class T = typename std::remove_cv<U>::type>
struct remove_all { typedef T type; };
template<class U, class T> struct remove_all<U,T*> : remove_all<T> {};
template<class U, class T> struct remove_all<U,T&> : remove_all<T> {};
template<class U, class T> struct remove_all<U,T&&> : remove_all<T> {};
template<class U, class T> struct remove_all<U,T[]> : remove_all<T> {};
template<class U, class T, int n> struct remove_all<U,T[n]> : remove_all<T> {}; 
```

或使用辅助类但只有一个模板参数：

```
#include <type_traits>
template<class T> struct remove_all_impl { typedef T type; };
template<class T> using remove_all =
  remove_all_impl<typename std::remove_cv<T>::type>;
template<class T> struct remove_all_impl<T*> : remove_all<T> {};
template<class T> struct remove_all_impl<T&> : remove_all<T> {};
template<class T> struct remove_all_impl<T&&> : remove_all<T> {};
template<class T> struct remove_all_impl<T[]> : remove_all<T> {};
template<class T, int n> struct remove_all_impl<T[n]> : remove_all<T> {}; 
```

如果所有变体开始看起来都差不多，这是正常的；-)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-05-15T10:10:35.720

您也可以使用该`remove_cvref_t`功能，它从 c++20 开始可用

```
#include <iostream>
#include <type_traits>

int main()
{
    std::cout << std::boolalpha
              << std::is_same_v<std::remove_cvref_t<int>, int> << '\n'
              << std::is_same_v<std::remove_cvref_t<int&>, int> << '\n'
              << std::is_same_v<std::remove_cvref_t<int&&>, int> << '\n'
              << std::is_same_v<std::remove_cvref_t<const int&>, int> << '\n'
              << std::is_same_v<std::remove_cvref_t<const int[2]>, int[2]> << '\n'
              << std::is_same_v<std::remove_cvref_t<const int(&)[2]>, int[2]> << '\n'
              << std::is_same_v<std::remove_cvref_t<int(int)>, int(int)> << '\n';
} 
```

# c# - FileVersionInfo.GetVersionInfo 的意外行为

> ID：14522497
> 
> 赞同：2
> 
> 时间：2013-01-25T13:11:19.503
> 
> 标签：c#, .net, powershell

为什么会`System.Diagnostics.FileVersionInfo.GetVersionInfo()`返回意外的文件版本信息？我正在寻找有关 MPIO 驱动程序的版本信息。目标操作系统是 Server 2008R2 SP1，它应该返回 FileVersion 6.1.7601。取而代之的是，我得到了 6.1.7600 的 2008R2 RTM 版本。

除了不正确的文件版本之外，OriginalFilename 也不是我所期望的。它是 mpio.sys.mui，尽管 FileName 是正确的。

使用资源管理器检查文件属性时会显示正确的版本信息。

这是设计使然，错误还是我使用 FileVersionInfo 错误的方式？是否有任何解决方法，最好是在 Powershell 上？

```
$mpioPath = 'c:\windows\system32\drivers\mpio.sys'
$v = [System.Diagnostics.FileVersionInfo]::GetVersionInfo($mpioPath)
$v | fl -Property *

Comments           :
CompanyName        : Microsoft Corporation
FileBuildPart      : 7601
FileDescription    : MultiPath Support Bus-Driver
FileMajorPart      : 6
FileMinorPart      : 1
FileName           : c:\windows\system32\drivers\mpio.sys
FilePrivatePart    : 17619
FileVersion        : 6.1.7600.16385 (win7_rtm.090713-1255)
InternalName       : mpio.sys
IsDebug            : False
IsPatched          : False
IsPrivateBuild     : False
IsPreRelease       : False
IsSpecialBuild     : False
Language           : English (United States)
LegalCopyright     : © Microsoft Corporation. All rights reserved.
LegalTrademarks    :
OriginalFilename   : mpio.sys.mui
PrivateBuild       :
ProductBuildPart   : 7601
ProductMajorPart   : 6
ProductMinorPart   : 1
ProductName        : Microsoft® Windows® Operating System
ProductPrivatePart : 17619
ProductVersion     : 6.1.7600.16385
SpecialBuild       : 
```

使用 C# 程序可以实现相同的结果，因此这似乎更多的是 .Net 功能而不是 Powershell 特定的功能。

```
namespace Foo {
  class GetFileVersionInfo {
    static void Main(string[] args) {
      string mpio = @"c:\windows\system32\drivers\mpio.sys";
      System.Diagnostics.FileVersionInfo fvInfo;
      fvInfo = System.Diagnostics.FileVersionInfo.GetVersionInfo(mpio);
      System.Console.WriteLine("Original file name: " + fvInfo.OriginalFilename);
      System.Console.WriteLine("FileVersion: " + fvInfo.FileVersion);
    }
  }
} 
```

使用 FileVer.exe 返回正确的版本信息：

```
filever $mpioPath
--a-- W32  DRV ENU  6.1.7601.17619 shp    156,544 05-20-2011 mpio.sys 
```

如果没有其他方法，我可以使用 FileVer 并解析它的输出。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-02-28T11:42:52.560

在[GetFileVersionInfo 的 MSDN 页面上，](http://msdn.microsoft.com/en-us/library/windows/desktop/ms647003%28v=vs.85%29.aspx)它说：

> 文件版本信息有固定和非固定部分。固定部分包含版本号等信息。非固定部分包含字符串之类的东西。过去 GetFileVersionInfo 从二进制文件 (exe/dll) 中获取版本信息。目前，它正在从语言中性文件（exe/dll）中查询固定版本和从mui文件中查询非固定部分，合并它们并返回给用户。

所以这与您所看到的完全一致：一个版本号来自`c:\windows\system32\drivers\mpio.sys`，另一个来自`c:\windows\system32\drivers\[your language]\mpio.sys.mui`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-25T14:01:30.630

我猜 FileVer.exe 和 expolrer.exe 做的和你在 powershell 中做的一样：

```
$mpioPath = 'c:\windows\system32\drivers\mpio.sys'
$v = [System.Diagnostics.FileVersionInfo]::GetVersionInfo($mpioPath)

$ver = "{0}.{1}.{2}.{3}" -f $v.FileMajorPart, $v.FileMinorPart, $v.FileBuildPart, $v.FilePrivatePart 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-12-22T19:50:00.130

To my knowlege the fields "FileVersion" and "ProductVersion" are unicode **strings**. In contrast the fields "FileMajorPart", "FileMinorPart", "FileBuildPart" and "FilePrivatePart" are **DWORD values**. The fields "ProductMajorPart", "ProductMinorPart", "ProductBuildPart" and "ProductPrivatePart" are DWORD values too:

[http://msdn.microsoft.com/en-us/library/windows/desktop/ms646997%28v=vs.85%29.aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/ms646997%28v=vs.85%29.aspx)

The applications used to create the VersionBlock might allow inconsistencies between the strings and the DWORD fields. Some versions of Visual Studio for example will always update the DWORD fields to reflect the changes made to the strings. However an update to the DWORD value alone does not reflect in the strings. Thus depending on the applications used for coding **different degrees of inconsistencies are possible**. In my experience you will get the best results with the DWORD fields alone (as it has been proposed in the answer to your question).

# c# - 如何打破事件处理程序

> ID：14522504
> 
> 赞同：2
> 
> 时间：2013-01-25T13:11:54.557
> 
> 标签：c#, .net, events

我不知道如何破坏事件处理程序方法列表。
例如我有跟随代码。我应该在IF语句中写什么？

```
public event EventHandler myEvent;
...
myEvent += new EventHandler(met1);
myEvent += new EventHandler(met2);
myEvent += new EventHandler(met3);
...
public void met2(object sender, EventArgs e)
{
...
     if(myCondition)
     {
     //there I want to break execution of all methods assiciated with myEvent event
     //I want to break met2 and don't allow to execute met3
     }
...
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-25T13:15:17.290

您可以定义您的*委托*，因此您`custom event handler`的自定义`EventArgs`，带有布尔值。

例子：

```
public class MyEventArg : EventArgs {

    public bool Handle {get;set;}

}

myEvent += new MyEventHandler(met1);

public void met2(object sender, MyEventArgs e)
{

   if(e.Handled)
      return;

   if(myCondition)
   {
       e.Handled = true;
       return;
   }
...
} 
```

这样，如果我们在处理它之前在*任何*其他事件处理程序中，检查是否`Handled == true`有一次它被其中一个设置为该状态，其他人将跳过该事件处理。

只是一个想法示例，您必须对其进行更改以适合您的代码确切需求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T13:18:52.013

查看 KeyDownEventArgs，有一个`Handled`可以设置为 true 的属性。
你可以做类似的事情：

```
class myClass {
    public event EventHandler myEvent;

    myEvent += new EventHandler(met1);
    myEvent += new EventHandler(met2);
    myEvent += new EventHandler(met3);

    public void metN(object sender, MyCustomEventArgs e)
    {
        if(e.Cancel)
            return;

        // Do whatever you like

        if(<someBooleanStatement>)
        {
            e.Cancel = true;
            return;
        }

        // Do whatever you like
    }
} 
```

# jquery - 使用 jQuery（或任何方法）淡出 swfObject

> ID：14522508
> 
> 赞同：0
> 
> 时间：2013-01-25T13:12:01.570
> 
> 标签：jquery, fadeout, swfobject

我正在使用 swfobect 将 youtube 视频嵌入到页面中。我有使用 jQuery hide() 隐藏视频的事件监听器；摆脱视频一旦完成。

替换隐藏（）；与淡出（'慢'）; 不起作用，尽管它在同时应用于另一个元素时确实起作用。

显然这与 swfobject 有关，但我不知道更多。

[http://goo.gl/7zEwm](http://goo.gl/7zEwm) - 显示所有代码的 jsfiddle 链接。

如果有人对如何使#ytplayer1 元素淡出有任何想法，那就太好了。

提前致谢。奥利

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T13:36:50.600

您需要更改 html、css 和脚本。我把你的小提琴叉到这里：

[新小提琴](http://jsfiddle.net/aaaheatair/4kHWj/1/)

确保你的 html 是这样的：

```
 <div id="wrapper">
<div id="popupVideoContainer1">You need Flash and JavaScript in order to view the video.</div>
<div id="videoStatus">status</div>
    </div> 
```

# objective-c - Cocoa：关闭菜单前闪烁的项目

> ID：14522509
> 
> 赞同：0
> 
> 时间：2013-01-25T13:12:04.580
> 
> 标签：objective-c, macos, cocoa, menu

在 OSX 上单击菜单项时，该项目会在菜单关闭前闪烁一次（on-off-on-close）。

我在问自己如何模仿这种行为？（我已经使用 NSCollectionView 重新实现了一个菜单，选择和单击项目都可以）

我试过 2 认为没有用：

```
mouseOver = false;
[self drawRect:self.bounds];
mouseOver = true;
[self drawRect:self.bounds];

[[self window] performSelector:@selector(orderOut:) withObject:nil afterDelay:0.1]; 
```

和

```
mouseOver = false;
[self setNeedsDisplayInRect:self.bounds];
[self needsDisplay];
mouseOver = true;
[self setNeedsDisplayInRect:self.bounds];
[self needsDisplay];

[[self window] performSelector:@selector(orderOut:) withObject:nil afterDelay:0.1]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T13:57:38.283

我去了那个解决方案：

```
-(void)mouseDown:(NSEvent *)theEvent {
    [super mouseDown:theEvent];

    [self performSelector:@selector(blinkItemOnce:) withObject:[NSNumber numberWithBool:NO] afterDelay:0.0];
    [self performSelector:@selector(blinkItemOnce:) withObject:[NSNumber numberWithBool:YES] afterDelay:0.05];
    [[self window] performSelector:@selector(orderOut:) withObject:nil afterDelay:0.15];
}

-(void) blinkItemOnce:(NSNumber*) b {
    mouseOver = [b boolValue];
    [self setNeedsDisplayInRect:self.bounds];
    [self setNeedsDisplay:YES];
} 
```

# makefile - Makefile 中的简单字符串替换

> ID：14522510
> 
> 赞同：3
> 
> 时间：2013-01-25T13:12:09.957
> 
> 标签：makefile, gnu-make, substitution

我想`libswscale.so.2`用（分别称为和的`libswscale.so`变量）替换字符串。这是我在 Makefile 中尝试的：`$(SLIBNAME_WITH_MAJOR)``$(SLIBNAME)`

```
$(SUBDIR)$(SLIBNAME_WITH_MAJOR): $(OBJS) $(SUBDIR)lib$(NAME).ver
    [...]
    @echo SHFLAGS=$(SHFLAGS)
    @echo SLIBNAME_WITH_MAJOR=$(SLIBNAME_WITH_MAJOR)
    @echo SLIBNAME=$(SLIBNAME)
    @echo A $(patsubst $(SLIBNAME_WITH_MAJOR),$(SLIBNAME),$(SHFLAGS))
    @echo B $(SHFLAGS:$(SLIBNAME_WITH_MAJOR)=$(SLIBNAME))
    @echo C $($(SHFLAGS):$(SLIBNAME_WITH_MAJOR)=$(SLIBNAME))
    @echo D $(SHFLAGS:$(SLIBNAME_WITH_MAJOR)=$(SLIBNAME))
    @echo E $(subst $(SLIBNAME_WITH_MAJOR),$(SLIBNAME),$(SHFLAGS))
    @echo F $(subst l,L,$(SHFLAGS)) 
```

输出是

```
SHFLAGS=-shared -Wl,-soname,libswscale.so.2 -Wl,-Bsymbolic -Wl,--version-script,libswscale/libswscale.ver
SLIBNAME_WITH_MAJOR=libswscale.so.2
SLIBNAME=libswscale.so
A -shared -Wl,-soname,libswscale.so.2 -Wl,-Bsymbolic -Wl,--version-script,libswscale/libswscale.ver
B -shared -Wl,-soname,libswscale.so.2 -Wl,-Bsymbolic -Wl,--version-script,libswscale/libswscale.ver
C
D -shared -Wl,-soname,libswscale.so.2 -Wl,-Bsymbolic -Wl,--version-script,libswscale/libswscale.ver
E -shared -Wl,-soname,libswscale.so.2 -Wl,-Bsymbolic -Wl,--version-script,libswscale/libswscale.ver
F -shared -WL,-soname,libswscale.so.2 -WL,-BsymboLic -WL,--version-script,LibswscaLe/LibswscaLe.ver 
```

最后一个（F）特别荒谬。这里有什么问题？是因为它`$(SHFLAGS)`也是由变量组成的吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-25T13:30:16.453

找到它：`$(SHFLAGS)`被定义为

```
SHFLAGS=-shared -Wl,-soname,$$(@F) blablafoo 
```

`$$(@F)`并且在实际评估之前使用任何替换都不起作用（在我的情况下`libswscale.so.2`）。

我通过替换变量引用解决了它：

```
@echo $(subst $$(@F),$(SLIBNAME),$(SHFLAGS)) 
```

* * *

关于分配的小提示：`VAR = $(OTHERVAR)`使用时`VAR := $(OTHERVAR)`评估，立即评估。

# .net - 来自数据集的 xml 的 xslt

> ID：14522511
> 
> 赞同：-1
> 
> 时间：2013-01-25T13:12:14.437
> 
> 标签：.net, xslt

我的数据集中有以下数据格式。我需要使用 xslt 制作一个 xml。我尝试了一些不起作用的 xslt 东西。一个例子可以帮助我很多。

我尝试以下链接：http: [//msdn.microsoft.com/en-us/library/8fd7xytc.aspx](http://msdn.microsoft.com/en-us/library/8fd7xytc.aspx)

我的数据集

```
name    color   city
====    =====   ====
rice    white   city1
rice    white   City2 
```

我需要的 xml 输出

```
<xml>

<name>  rice    </name>

<color> White   </color>

<cities>        

<city>  city1   </city>

<city>  city2   </city>

</cities>       

</xml> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T13:50:22.817

我相信这会奏效。如果您可以向我们展示您的输入 XML，我可以验证和完善这个答案：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:output method="xml" indent="yes"/>

  <xsl:template match="/*">
    <xml>
      <xsl:apply-templates select="*[1]/name | *[1]/color"/>
      <cities>
        <xsl:apply-templates select="*/city" />
      </cities>
    </xml>
  </xsl:template>

  <xsl:template match="/*/*/*">
    <xsl:element name="{local-name()}">
      <xsl:value-of select="." />
    </xsl:element>
  </xsl:template>
</xsl:stylesheet> 
```

# ruby-on-rails - 嵌套（和同时未嵌套）资源更好的方法

> ID：14522513
> 
> 赞同：3
> 
> 时间：2013-01-25T13:12:25.703
> 
> 标签：ruby-on-rails, ruby, nested, dry

我有两个这样的模型

```
class Plan < ActiveRecord::Base
    belongs_to :profile 
```

和

```
class Profile < ActiveRecord::Base
    has_many :plans 
```

像这样的**路线：（**我需要）

```
resources :profiles do
    resources :plans
end
resources :plans 
```

所以，跟进[ruby​​-on-rails - Problem with Nested Resources](https://stackoverflow.com/questions/4441229/ruby-on-rails-problem-with-nested-resources)，我让我的**PLANS**索引控制器像这样，同时工作 NESTED 和**UNESTED**（我现在找到的唯一方法）：

```
def index
  if params.has_key? :profile_id
    @profile = Profile.find(params[:profile_id])
    @plans = @profile.plans
  else
    @plans = Plan.all
end 
```

**有更清洁的方法吗？**

*在这种情况下，我有另一个模型，并且将所有动作放在所有控制器中都表现得像这样很麻烦。*

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T15:16:54.617

你给了我一个想法：

模型/用户.rb：

```
class User < ActiveRecord::Base
  has_many :posts
  attr_accessible :name
end 
```

模型/post.rb：

```
class Post < ActiveRecord::Base
  belongs_to :user
  attr_accessible :title, :user_id
end 
```

控制器/posts_controller.rb：

```
class PostsController < ApplicationController
  belongs_to :user # creates belongs_to_user filter

  # @posts = Post.all # managed by belongs_to_user filter

  # GET /posts
  # GET /posts.json
  def index
    respond_to do |format|
      format.html # index.html.erb
      format.json { render json: @posts }
    end
  end
end 
```

现在的实质：

控制器/application_controller.rb：

```
class ApplicationController < ActionController::Base
  protect_from_forgery

  def self.belongs_to(model)
                                                      # Example: model == :user
    filter_method_name = :"belongs_to_#{model}_index" # :belongs_to_user_index
    foreign_key        = "#{model}_id"                # 'user_id'
    model_class        = model.to_s.classify          # User

    class_eval <<-EOV, __FILE__, __LINE__ + 1
      def #{filter_method_name}                                                # def belongs_to_user_index
        if params.has_key? :'#{foreign_key}'                                   #   if params.has_key? :user_id
          instance_variable_set :"@#{model}",                                  #     instance_variable_set :"@user",
                                #{model_class}.find(params[:'#{foreign_key}']) #                           User.find(params[:user_id])
          instance_variable_set :"@\#{controller_name}",                       #     instance_variable_set :"@#{controller_name}",
                                @#{model}.send(controller_name.pluralize)      #                           @user.send(controller_name.pluralize)
        else                                                                   #   else
          instance_variable_set :"@\#{controller_name}",                       #     instance_variable_set :"@#{controller_name}",
                                controller_name.classify.constantize.all       #                           controller_name.classify.constantize.all
        end                                                                    #   end
      end                                                                      # end
    EOV

    before_filter filter_method_name, only: :index # before_filter :belongs_to_user_index, only: :index
  end
end 
```

如果你有 Ruby 元编程的概念，那么代码并不复杂理解：它声明了一个 before_filter，它声明了实例变量，从控制器名称和关联中推断名称。它仅针对索引操作实现，这是唯一使用复数实例变量版本的操作，但为其他操作编写过滤器版本应该很容易。

# windows - Powershell 通过命令行控制 Windows 搜索

> ID：14522514
> 
> 赞同：1
> 
> 时间：2013-01-25T13:12:28.913
> 
> 标签：windows, powershell

我正在尝试编写一个 powershell 脚本，该脚本将在某些驱动器上禁用索引，但在其他驱动器上保持激活状态（例如：C:)。

以前有人做过吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T13:34:57.813

试试这个，（未测试）：

```
function Disable-Indexing{
    Param($Drive)
    $obj = Get-WmiObject -Class Win32_Volume -Filter "DriveLetter='$Drive'"
    $indexing = $obj.IndexingEnabled
    if("$indexing" -eq $True){
        write-host "Disabling indexing of drive $Drive"
        $obj | Set-WmiInstance -Arguments @{IndexingEnabled=$False} | Out-Null
    }
}

use:

disable-indexing "c:" 
```

# process - 绑定9.7。当多个命名进程在运行时，如何判断是哪个进程在提供服务？

> ID：14522516
> 
> 赞同：0
> 
> 时间：2013-01-25T13:12:35.633
> 
> 标签：process, bind, named, proc

例如，我多次执行“ *sudo named ”，因此有几个命名进程在运行。*当我使用“ *pidof named* ”时，我得到了几个 pid。

我想计算BIND进程的CPU使用率，所以我需要从“ */proc/pid/stat ”中获取一些参数，所以我需要***真正提供域解析服务**的命名进程的pid 。

 **提供服务的命名进程与其他进程有什么区别？你能给我一个详细的解释吗？

非常感谢~

（我是第一次用stackoverflow，用英文问问题，语法错误请忽略。）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T13:32:46.843

应该只有*一个*名为 running，管理服务的脚本确保这一点。你不应该那样启动它，你应该使用你的发行版来启动它，可能类似于`service bind start`（可能是 RedHat 主义）或`/etc/rc.d/bind start`（对于沼泽标准 SysVinit）。

我在这里负责 DNS 很长一段时间。一些技巧：

*   DNS 是一项*非常*关键的服务，请格外小心地配置和监控。请阅读有关设置和管理的内容，在您完全清楚之前不要继续。
*   找人作为你不在的情况下的备份，并确保他们理解前一点。
*   DNS 不是 CPU 密集型的（好吧，有签名域和可能已经改变的新奇东西），它是内存密集型的（和网络密集型的，或者至少对延迟敏感）。我们的主 DNS 服务器一次运行了几个月，在 IIRC 的那种时间段内占用了大约半小时的 CPU 时间。
*   将您的主服务器（负责域）与客户端查询的服务器（缓存服务器）分开。存在格式错误的问题或未询问的问题的“答案”污染数据库的漏洞
*   主服务器将在 RAM 中拥有所有域信息，请确保您有足够的信息
*   确保您管辖范围内的所有机器都使用相同的缓存服务器。不止一个是没有意义的，这破坏了缓存的想法。
*   随着时间的推移，缓存服务器会收集大量数据。此数据很少对性能至关重要，因此为它们配置大量交换空间以适应溢出。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-07-27T08:23:12.110

绑定与您拥有的 CPU 一样多的命名进程：

man named: -n #cpus 创建 #cpus 工作线程以利用多个 CPU。如果未指定，named 将尝试确定存在的 CPU 数量并为每个 CPU 创建一个线程。如果无法确定 CPU 的数量，将创建单个工作线程。

外部源：

[https://unix.stackexchange.com/questions/140986/multiple-named-processes-for-bind9-in-debian](https://unix.stackexchange.com/questions/140986/multiple-named-processes-for-bind9-in-debian)**

# php - 在 Code igniter 中显示 Bootstrap 弹出框

> ID：14522520
> 
> 赞同：0
> 
> 时间：2013-01-25T13:12:53.890
> 
> 标签：php, javascript, codeigniter, jquery, twitter-bootstrap

我从[这里](http://twitter.github.com/bootstrap/javascript.html#popovers)使用这个工具提示弹出窗口..我想要的是在从控制器获取数据后在这个工具提示中显示数据..我不知道我该怎么做..我有一个文本框，我在其中应用了模糊功能所以如果用户在输入框中输入内容，它会在工具提示中显示针对它的数据。我不知道如何在我的脚本中使用此工具提示

我在视图页面中的文本框

```
 Bill No:<?php echo form_input($bill_no); ?>
   <input type="hidden" class="hiddenUrl"> 
```

在这个范围内，我想在输入框的前面或上方显示工具提示

```
 <span class="text">  </span> 
```

我的 javascript

```
<script type="text/javascript">

    $(document).ready(function(){

        $('#bill_no').blur(function(){

            if( $('#bill_no').val().length >= 3 )
                {
                  var bill_no = $('#bill_no').val();
                  getResult(bill_no); 
                }
            return false;
        })
        function getResult(billno){
            var baseurl = $('.hiddenUrl').val();
          //  $('.checkUser').addClass('preloader');
            $.ajax({
                url : baseurl + 'returnFromCustomer_Controller/checkBillNo/' +     billno,
                cache : false,
                dataType: 'json',
                success : function(response){
                     $(".text").html(response.result);
                }
            })
        }
    })

  </script> 
```

我的控制器...

```
 function checkBillNo($billno)
  {
$this->load->model('returnModel');

$query = $this->returnModel->checkBillNo($billno);

$billno =   $this->uri->segment(3);
$billno_results  = $this->returnModel->sale($billno);

//header('Content-Type: application/x-json; charset=utf-8');
echo    json_encode($billno_results); 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T13:52:10.990

您可以使用`$.attr()`这样设置属性值：

```
success : function(response){
                     $(".text").attr('data-title', response.result);
                } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T13:52:36.837

您必须将返回的文本插入到`data-content`属性中：

```
 function getResult(billno){
        var baseurl = $('.hiddenUrl').val();
        //$('.checkUser').addClass('preloader');
        $.ajax({
            url : baseurl + 'returnFromCustomer_Controller/checkBillNo/' +     billno,
            cache : false,
            dataType: 'json',
            success : function(response){
                 $("#bill_no").attr("data-content", response.result);
            }
        })
    } 
```

或者

```
$('#bill_no').popover({html: response.text}) 
```

# php - 处理php页面时加载gif覆盖

> ID：14522523
> 
> 赞同：0
> 
> 时间：2013-01-25T13:13:05.893
> 
> 标签：php, image-processing, overlay

我有一个链接，它加载了一个使用 imagemagick 处理图像和覆盖的 php 页面。有没有办法让您所在的当前页面加载请等待覆盖它覆盖的位置或让用户知道等待？

我已经看到它附加到图像上，但当您单击页面链接时却没有。这也不是我见过的解决方案的表单提交。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T13:32:51.443

有一个非常好的 Jquery 插件可以实现这一点。它被称为查询加载器。它就像一个页面预加载器。请参考以下链接，

[查询加载器 - 页面预加载器](http://www.gayadesign.com/diy/queryloader-preload-your-website-in-style/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T13:41:13.727

尝试通过 document.ready 函数上的 ajax 向内容页面发送请求并显示加载图像，当收到该页面的内容时隐藏图像并显示内容。

# mysql - mysql查询：左加入时的空值行为

> ID：14522524
> 
> 赞同：1
> 
> 时间：2013-01-25T13:13:07.010
> 
> 标签：mysql, sql, select, left-join

这个问题可能很简单，但我不明白空值在 mysql 语法中的行为方式。假设我有这个准备好的请求：

```
select t1.* 
from table1 t1 
left join table2 t2 
   on t1.id = t2.id 
   and some_entry = :value 
where t2.the_id is null 
```

some_entry 是 table2 条目，t2.the_id 是 table2 的增量索引。如果 table2 为空，输出会是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T13:16:02.770

```
What will be the output if table2 is empty? 
```

即使`table2`为空，它仍然会显示所有记录，`table1`因为您使用了`LEFT JOIN`.

# php - PHP随机数生成与条件

> ID：14522525
> 
> 赞同：4
> 
> 时间：2013-01-25T13:13:16.183
> 
> 标签：php, random, numbers

我最近接到了一项任务，但我失败了。我通常不要求逻辑，但今天我不得不问。这是任务。

我不允许使用php的rand()函数。相反，我可以使用此功能。

```
function getRandom()
{
     return rand(1,5);
} 
```

好的，我试过这个函数，但它一定会返回从 3 到 7 的值。

```
function getMoreRandom()
{
    $value = getRandom();
    return $value + 2;

} 
```

现在我必须定义一个 php 函数，它可以返回范围为 1 到 7 的随机数。我该怎么做？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-25T13:28:04.283

```
function getMoreRandom()
{
    do {
        $temp = 5 * (getRandom() - 1) + getRandom();
    } while ($temp > 21);

    return $temp % 7 + 1;
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-25T13:51:18.747

flov 的回答是正确的：

```
function getMoreRandom()
{
    do {
        $temp = 5 * (getRandom() - 1) + getRandom();
    } while ($temp > 21);

    return $temp % 7 + 1;
} 
```

测试它：

```
$aryResults = array_pad(array(),8,0);
foreach(range(0,100000) as $i) $aryResults[getMoreRandom()]++;
$intSum = array_sum($aryResults);
foreach($aryResults as $intValue => $intCount) printf("Value %d Count %d (%.2f)\n",$intValue,$intCount,$intCount/$intSum); 
```

产生矩形分布

```
Value 0 Count 0 (0,00)
Value 1 Count 14328 (0,14)
Value 2 Count 14316 (0,14)
Value 3 Count 14185 (0,14)
Value 4 Count 14197 (0,14)
Value 5 Count 14322 (0,14)
Value 6 Count 14361 (0,14)
Value 7 Count 14292 (0,14) 
```

抱歉，我没有对答案发表评论。显然我不能，因为我缺乏声誉（我是新来的）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-25T14:22:16.273

它不会是一个统一的分布（而且你没有指定它需要是）。

对于最简单的解决方案，您不需要进行缩放或循环，您可以将随机 1 到 5，然后添加随机 0 到 2；

```
function getMoreRandom()
{
    return getRandom() + getRandom() % 3;
} 
```

快速测试看看分布是什么样的：

```
$results = array_fill(1, 7, 0);

for ($i = 0; $i < 1000000; $i++) {
    $results[rand(1,5) + rand(1,5) % 3]++;
}

var_dump($results); 
```

如前所述，并非设计为均匀随机。

```
array(7) {
  [1]=>
  int(39550) // 4%
  [2]=>
  int(120277) // 12%
  [3]=>
  int(200098) // 20%
  [4]=>
  int(199700) // 20%
  [5]=>
  int(200195) // 20% 
  [6]=>
  int(160200) // 16%
  [7]=>
  int(79980) // 8%
} 
```

稍微复杂一点，和@flovs 不同的方法（我不喜欢他的循环***可能***永远持续的方式 - 嘿，这就是随机性）

```
function getMoreRandom()
{
    for (
        $i = 0, $v = 0;
        $i < 7;
        $i++, $v += getRandom()
    );

    return $v % 7 + 1;
} 
```

这会产生均匀分布

```
array(7) {
  [1]=>
  int(14397)
  [2]=>
  int(14218)
  [3]=>
  int(14425)
  [4]=>
  int(14116)
  [5]=>
  int(14387)
  [6]=>
  int(14256)
  [7]=>
  int(14201)
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-25T13:41:27.863

我的解决方案：

```
<?php

function getRandom()
{
     return rand(1,5);
}

$random_number = getRandom();
$random_number += time();

$random_number = ($random_number % 7) + 1; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-25T15:49:19.123

只是为了提出一个很好的问题，我认为这可能更通用。这意味着我们可能不希望基于 rand(1,5) 的 1-7 而是 3-7 或 1-10 等。

该函数适用于数字 1-25，因为我正在使用另一种二维数组的解决方案。

```
function getMoreRand($start, $end){
        $restart = $start; //Save $start value, to restart if we reach the $end number 
        $parser = 0; //Count number elements in 2d array
        $result = 0; //Return the result based on rand(1,5)

        //Create a 2d array(), 5x5 to simulate the 1-5 random number selection from rand(1,5)
        for($row = 0; $row < 5; $row++){
            for($col = 0; $col < 5; $col++){
                $vars[$row][$col] = $start;

                //If the array elements left <= selected range left
                if((25-$parser) <= ($end-$start)){
                    $vars[$row][$col] = 0;
                }else{
                    if($start == $end){
                        $start = $restart;
                    }else{
                        $start++;
                    }
                }       
                $parser++;

            }//END OF FOR COL LOOP
        }//END OF FOR ROW LOOP

        while($result == 0){
            $i = getRandom(); //Choose 1-5
            $j = getRandom(); //Choose 1-5
            $result = $vars[$i-1][$j-1]; //Get number from 2d array, based on rand(1,5)
        }

        echo $result;
    } 
```

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2013-01-25T13:20:08.930

```
function getMoreRandom()
{
    $value = 0;
    for($i=1;$i<=5;$i++) $value += getRandom();
    return ($value % 7) + 1;
} 
```

*   首先，调用`getRandom`5 次，得到 5 到 25 的范围。这正好有 21 个值 - 7 的倍数。
*   然后，找到 7 的模数。这会产生一个介于 0 和 6 之间的数字，每个数字都有 3 比 21 或 1 比 7 出现的机会。
*   然后，为正确的范围添加一个。

# facebook - 解决应用程序被阻止为垃圾邮件

> ID：14522530
> 
> 赞同：4
> 
> 时间：2013-01-25T13:13:35.463
> 
> 标签：facebook, offline, spam, blocked

因此，我们编写了一个应用程序并将其集成到我们的服务中，作为用户在他们的墙上分享他们的签到的功能（我们的是基于位置的签到服务）。集成在 SMS（离线令牌）和 Android（SDK 集成）上运行。

我们在过去 2-3 周内运行良好，但今天早些时候收到了 400 条回复，其中包含此消息“警告：此消息包含被阻止的内容：此消息中的某些内容已被 Facebook 用户报告为滥用。”，“键入":"OAuthException","code":368"

这影响了我们在 SMS 上的集成（Android 工作正常）。我们认为这是因为当用户通过 SMS 共享时发布的消息类似于用户传递的相同参数，在一天中非常频繁地用于基本上执行相同的操作（签入）。

所以我的问题，或者请求帮助真的是：我们需要做什么才能让我们的应用程序畅通无阻？我们需要和谁说话？以及采取哪些措施确保这种情况不再发生？

干杯。

# iphone - AVAudioplayer 不在后台播放

> ID：14522531
> 
> 赞同：0
> 
> 时间：2013-01-25T13:13:46.167
> 
> 标签：iphone, avaudioplayer

这***不是***我在每个地方都搜索过的重复问题，但不幸的是我没有找到任何解决方案。

我的问题我想在应用程序处于后台时播放音乐文件，它应该在调用任何本地通知时开始播放。

我有一个功能，我正在检查应用程序是否存在于后台，然后我写了播放音乐文件的语句，但***[avaudioplayer play]***总是返回 NO。我检查了错误代码，但它显示为空。

我还编辑了 info.plist 文件以将音频文件设置设置为在后台播放。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T20:53:44.643

像这样设置音频会话：（audioPlayer 是这里的 AVPlayer 的实例）

```
- (void)observeValueForKeyPath:(NSString *)keyPath ofObject:(id)object change:(NSDictionary *)change context:(void *)context
{
    NSLog(@"inside observer");
    if (self.audioPlayer.status == 1)
    {
        [[AVAudioSession sharedInstance] setCategory:AVAudioSessionCategoryPlayback
                                               error:nil];
        [[AVAudioSession sharedInstance] setActive:YES
                                             error:nil];
        [[UIApplication sharedApplication] beginReceivingRemoteControlEvents];
        [self.audioPlayer play];
    }
} 
```

还有一件事要做在应用程序的 appname-info.pist 中添加一个字段，即“必需的背景模式”，并向该数组添加一个名为“App 播放音频”的项目。

那么它肯定会起作用:)

# javascript - 需要代码返回数组坐标

> ID：14522532
> 
> 赞同：2
> 
> 时间：2013-01-25T13:13:47.513
> 
> 标签：javascript, object

新手问题在这里.. 我正在尝试从数组中返回 LAT LNG 值。

我有以下三个功能：

```
function City(ridge)
{
    var city=   {
    ABC:"Bethel, AK",
    ABR:"Aberdeen, SD",
    ABX:"Albuquerque, NM"};
    return city[ridge];
} 
```

和

```
function BBox(ridge,product)
{
    var yx= {
    NOR:
    {
    ABC:[64.835517,56.735755,-157.448578,-166.284681]
    ,
    ABR:[48.270508,42.631241, -95.331912,-101.483839]
    ,
    ABX:[37.565036,32.726169,-104.179217,-109.457981]}};
    var xy=yx[product][ridge];
    return {x0:xy[2],x1:xy[3],y0:xy[0],y1:xy[1]};
} 
```

和

```
function initialize()
{
var ridge =  'ABC';
var product ='NOR';
var getCityInfoFromRidgeName = City(ridge);
var boundries=BBox(ridge,product);
alert(getCityInfoFromRidgeName);
alert(boundries);
} 
```

**City**的警报按预期返回“Bethel，AK”.. 但**BBox**的警报返回“objec Object”，而不是希望的 LAT LNG 信息。

我可能有点不知所措，但是如何将 LAT LNG 从 BBox 返回到 var？

窝

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T13:17:42.867

boundries 是一个持有 x 和 y 坐标的对象。您可以使用以下代码获取坐标：

```
alert(boundries.x0);
alert(boundries.x1);
alert(boundries.y0);
alert(boundries.y1); 
```

为了将来参考，javascript中的对象可以这样创建：

```
var anObject={property:'value'};
var anotherObject={
    message:'Hello',
    location:'World',
    aNumber:23
}; 
```

然后可以使用点访问对象的某些部分 - 如下所示：

```
anObject.property;
alert(anotherObject.message + ' ' + anotherObject.location); 
```

您可以在此处了解有关 javascript 对象的更多信息：http: [//net.tutsplus.com/tutorials/javascript-ajax/the-basics-of-object-oriented-javascript/](http://net.tutsplus.com/tutorials/javascript-ajax/the-basics-of-object-oriented-javascript/)

# r - R巧妙地决定函数中的par-mfrow

> ID：14522534
> 
> 赞同：4
> 
> 时间：2013-01-25T13:13:51.483
> 
> 标签：r, par

我想根据数据框中具有超过 10 个唯一值的变量的数量来打印输出。这可以是任意数量的变量。我正在寻找一种方法来实现这一点，以将绘图窗口设置为非常适合变量数量。

它应该是这样的：

*   2 个变量 -> 1 乘 2
*   3 个变量 -> 1 乘 3
*   4 个变量 -> 2 乘 2
*   5 个变量 -> 2 乘 3
*   6 个变量 -> 2 乘 3
*   ......
*   ......
*   16 个变量 -> 4 乘 4
*   16+ 变量 -> 4 乘 4

是否有一个逻辑公式？

如何使这成为成功的`par(mfrow=(c(x,y)))`？

另外，如何确定何时达到标准限制，`click`对于下一个窗口，当我有超过 16 个时我无法单击，而只是覆盖以前的图表。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-25T13:25:51.230

## 获取设备的行数和列数

是为此目的而`n2mfrow()`设计的，尽管它往往比列更快地改变行，因此与您想要的相反。例如：

```
> n2mfrow(2)
[1] 2 1 
```

表示 2 行乘 1 列。当然，`rev()`可以很容易地得到你想要的输出：

```
> rev(n2mfrow(3))
[1] 1 3 
```

这是`n2mfrow()`2 到 16 个总图的输出，列变化更快：

```
t(sapply(2:16, function(x) rev(n2mfrow(x))))

> t(sapply(2:16, function(x) rev(n2mfrow(x))))
      [,1] [,2]
 [1,]    1    2
 [2,]    1    3
 [3,]    2    2
 [4,]    2    3
 [5,]    2    3
 [6,]    3    3
 [7,]    3    3
 [8,]    3    3
 [9,]    3    4
[10,]    3    4
[11,]    3    4
[12,]    4    4
[13,]    4    4
[14,]    4    4
[15,]    4    4 
```

## 使这个互动

对于“16 点后点击”位。如果在`for(i in numplots)`循环中进行绘图，当`i`> 16 调用时`devAskNewPage(ask = TRUE)`，将提示用户激活下一个绘图。

例如：

```
np <- 18 ## number of plots
rc <- ifelse(np > 16, 16, np)
op <- par(mfrow = rev(n2mfrow(rc)))
for(i in seq_len(np)) {
  if(i == 2) {
    devAskNewPage(ask = TRUE)
  }
  plot(1:10)
}
par(op)
devAskNewPage(ask = FALSE) 
```

可以使用类似的方法`locator(1)`来强制单击以在 16 后的地块上移动，但它需要做更多的工作：

```
np <- 18 ## number of plots
rc <- ifelse(np > 16, 16, np)
op <- par(mfrow = rev(n2mfrow(rc)))
for(i in seq_len(np)) {
  if((i %% 16) + 1 == 2 && i > 1) {
    message("Page filled. Click on device to continue...")
    locator(1)
  }
  plot(1:10)
}
par(op) 
```

# c - 如何在 python 中使用 struct 模块解压字节？

> ID：14522535
> 
> 赞同：1
> 
> 时间：2013-01-25T13:13:52.077
> 
> 标签：c, struct, python-3.x

我正在尝试在 python 中解压缩字节：-

```
import struct

c_struct_exp='struct lokesh { int i=5;} lm;'
result=struct.unpack('!i',bytes(c_struct_exp,'utf-8'))  
print(result) 
```

错误：

```
 struct.error: unpack requires a bytes object of length 4 
```

请帮我解包方法中的格式字符串表达式。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-25T13:23:13.697

[`unpack`](http://docs.python.org/2/library/struct.html)用于解压缩**二进制数据**，而不是 C 源代码。按照您的单个整数成员结构的示例：

```
>>> from struct import *
>>> pack('i', 134)
'\x86\x00\x00\x00'
>>> unpack('i', '\x86\x00\x00\x00')
(134,)
>>> 
```

# visual-studio-2010 - XNA Mono 触控游戏 - 触控不起作用

> ID：14522536
> 
> 赞同：2
> 
> 时间：2013-01-25T13:14:10.650
> 
> 标签：visual-studio-2010, xamarin.ios, xna-4.0, tablet, monogame

我已经安装了 Visual Studio 2012 Express 和 Mono SDK，所以我可以进行 XNA 游戏开发。

我今天开始阅读有关触摸屏和 Microsoft.XNA.Framework.Input.Touch 命名空间的信息。我已将以下代码放入主游戏类的 Initialize() 方法中：

```
TouchPanelCapabilities tc = new TouchPanelCapabilities();

if (tc.IsConnected)
        {
            int i = tc.MaximumTouchCount;
        } 
```

但 tc.IsConnected 返回 false。我正在触摸 Windows 8 平板电脑上开发，所以不明白为什么它会返回 false。任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-25T13:42:29.543

您正在初始化一个空结构。您需要致电：

```
TouchPanelCapabilities tc = TouchPanel.GetCapabilities(); 
```

那么`IsConnected`应该是真的。

# python - Python将元素添加到一个实例的列表也会将它添加到另一个实例的列表中

> ID：14522537
> 
> 赞同：5
> 
> 时间：2013-01-25T13:14:13.220
> 
> 标签：python, class, instance-variables

> **可能的重复：**
> [Python 中的“Least Astonishment”：可变默认参数](https://stackoverflow.com/questions/1132941/least-astonishment-in-python-the-mutable-default-argument)

我创建了一个 Person 类，它有一个名字和一个孩子的列表。孩子们属于同一个 Person 类。如果我创建两个 Person 实例，并将一个子实例添加到其中一个 person 实例，它会被添加到两个 Person 实例中。我认为应该只将孩子添加到 person1 的孩子而不是 person2，但它会被添加到两者中。我一定是在做一些明显的错误，但我看不到。

类似的问题表明人们将变量定义添加到类本身而不是构造函数，但这不是这里发生的事情。任何帮助都将不胜感激，这让我的大脑感到煎熬！

请参阅下面的代码和输出：

```
class Person(object):

    def __init__(self, name, children=[]):
        self.name = name
        self.children = children

    def __repr__(self):
        return '<' + self.name + '>'

    def add_child(self, child):
        self.children.append(child)

def main():
    person1 = Person('Person1')
    person2 = Person('Person2')

    person1.add_child(Person("Person 1's child"))

    print "Person 1's children:", person1.children
    print "Person 2's children:", person2.children

if __name__ == "__main__":
    main() 
```

这段代码的输出是：

```
Person 1's children: [<Person 1's child>]
Person 2's children: [<Person 1's child>] 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-25T13:15:43.487

问题出在`children`参数的默认值上。如果你使用一个可变对象（例如列表）并在头部初始化它，它只会被初始化一次，然后在所有实例中使用。

[此处](https://stackoverflow.com/questions/1132941/least-astonishment-in-python-the-mutable-default-argument)已对此进行了讨论。

尝试更换

```
def __init__(self, name, children=[]):
    self.name = name
    self.children = children 
```

和

```
def __init__(self, name, children=None):
    self.name = name
    if children is None:
        self.children = []
    else:
        self.children = children 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-25T13:16:13.327

对于您的 init，请改用：

```
def __init__(self, name, children=None):
    self.name = name
    if children is None:
        self.children = []
    else:
        self.children = children 
```

发生的情况是两个 Person 对象在后台使用相同的列表（列表在定义函数时绑定，而不是在执行时绑定）。看看[这个问题](https://stackoverflow.com/questions/1132941/least-astonishment-in-python-the-mutable-default-argument)进行更多讨论。

# python - Python - 在命令行应用程序中传递参数

> ID：14522539
> 
> 赞同：1
> 
> 时间：2013-01-25T13:14:17.697
> 
> 标签：python, parameters, python-2.7

我需要编写一个命令行应用程序，比如 shell。所以它将包括命令等。问题是我不知道如何将参数传递给模块中的函数。例如：

用户写道：function1 folder1 程序现在应该将 'folder1' 参数传递给 function1 函数，并运行它。但它还必须支持具有不同参数的其他功能，例如：

用户输入：function2 folder2 --exampleparam

如何使它工作？我的意思是，我可以只编写一个模块，将其导入 python 并使用 python 控制台，但事实并非如此。我需要一个接受命令输入并运行它的脚本。

我尝试使用 eval()，但这并不能解决 params 的问题。或者也许是这样，但我没有看到？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-25T13:32:08.547

问题的第一部分——解析命令行——可以用[argparse](http://docs.python.org/2/howto/argparse.html)来解决。

第二部分——将函数的字符串名称转换为函数调用——可以使用[exec](http://docs.python.org/2/reference/simple_stmts.html#the-exec-statement)或从字符串映射到函数对象的调度 dict 来完成。

我建议**不要**使用`exec`它，因为允许用户从命令行调用任意 Python 函数可能很危险。相反，制作一个允许功能的白名单：

```
import argparse

def foo(path):
    print('Running foo(%r)' % (path, ))

def bar(path):
    print('Running bar(%r)' % (path, ))

dispatch = {
    'foo': foo,
    'bar': bar,
}

parser = argparse.ArgumentParser()
parser.add_argument('function')
parser.add_argument('arguments', nargs='*')
args = parser.parse_args()

dispatch[args.function](*args.arguments) 
```

* * *

```
% test.py foo 1
Running foo('1')
% test.py bar 2
Running bar('2')
% test.py baz 3
KeyError: 'baz' 
```

* * *

当命令输入到命令行本身时，上述方法有效。如果命令被输入到`stdin`中，那么我们需要做一些不同的事情。

一个简单的方法是调用`raw_input`从`stdin`. 然后我们可以使用 argparse 解析字符串，就像我们上面所做的那样：

**shmod.py**：

```
import argparse

def foo(path):
    print('Running foo(%r)' % (path, ))

def bar(path):
    print('Running bar(%r)' % (path, ))

dispatch = {
    'foo': foo,
    'bar': bar,
}

def parse_args(cmd):
    parser = argparse.ArgumentParser()
    parser.add_argument('function')
    parser.add_argument('arguments', nargs='*')
    args = parser.parse_args(cmd.split())
    return args 
```

**主.py**：

```
import shmod

while True:
    cmd = raw_input('> ')
    args = shmod.parse_args(cmd)
    try:
        shmod.dispatch[args.function](*args.arguments)
    except KeyError:
        print('Invalid input: {!r}'.format(cmd)) 
```

* * *

另一种更复杂的处理方法是使用[cmd 模块](http://docs.python.org/2/library/cmd.html)，正如@chepner 在评论中提到的那样。

```
from cmd import Cmd

class MyInterpreter(Cmd):

    prompt = '> '

    def do_prompt(self, line):
        "Change the interactive prompt"
        self.prompt = line + ': '

    def do_EOF(self, line):
        return True

    def do_foo(self, line):
        print('Running foo {l}'.format(l=line))

    def do_bar(self, line):
        print('Running bar {l}'.format(l=line))

if __name__ == '__main__':
    MyInterpreter().cmdloop() 
```

有关如何使用 cmd 模块的更多信息，请参阅[Doug Hellman 的优秀教程。](http://www.doughellmann.com/PyMOTW/cmd/index.html)

* * *

运行上面的代码会产生如下结果：

```
% test.py
> foo 1
Running foo 1
> foo 1 2 3
Running foo 1 2 3
> bar 2
Running bar 2
> baz 3
*** Unknown syntax: baz 3 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-25T13:45:17.660

`optparse`自 python 2.7 以来已被弃用，无论如何 argparse 更加灵活。unutbu 的方法是安全的，但是如果您提供白名单，我建议您让用户知道接受哪些功能

```
dispatch = {
    'foo': foo,    
    'bar': bar,
}

parser = argparse.ArgumentParser()
parser.add_argument('function', choices=dispatch.keys() ) 
```

仅供参考：如果解析不是太复杂，[docopt](http://docopt.org/)看起来像一个非常好的包

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-25T13:18:16.367

[sys.argv](http://docs.python.org/2/library/sys.html)怎么样？有关更高级的内容，请查看[argsparse](http://docs.python.org/2/library/argparse.html#module-argparse)。`optparse`现在似乎贬值了，但是这里有[很多](https://stackoverflow.com/questions/1009860/command-line-arguments-in-python)关于这个问题的答案。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-25T13:25:02.863

看看 python 中的**optparse**模块。这正是您需要的：

```
http://docs.python.org/2/library/optparse.html 
```

或者您可以编写自己的自定义 opt-parser（虽然简约）

```
def getopts(argv):
   opts = {}
   while argv:
      if argv[0][0] == '-': # find "-name value" pairs
         opts[argv[0]] = argv[1] # dict key is "-name" arg
         argv = argv[2:]
      else:
         argv = argv[1:]
   return opts

if __name__ == '__main__':
from sys import argv # example client code
myargs = getopts(argv)
# DO something based on your logic here 
```

但如果您的脚本需要在 python 3 及更高版本上运行，您需要考虑[argparse](http://docs.python.org/2/library/argparse.html#module-argparse)模块。\

希望有帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-25T13:17:39.307

看看[optparse](http://docs.python.org/2/library/optparse.html)。这可以帮助将 shell 样式参数传递和接收到 python 脚本。

更新：显然`optparse`现在已弃用，[argparse](http://docs.python.org/2/library/argparse.html#module-argparse)现在是解析命令行参数的首选选项。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-25T13:20:36.977

```
import sys

def main(arg):
    return arg

print main(sys.argv[1]) 
```

其中 sys.argv[0] 是您正在运行的 .py 文件，之后的所有文件都是每个参数。您可以检查列表的长度，然后遍历它，并根据需要解析它们并将正确的东西传递给每个函数

# c# - 几秒钟后关闭 MessageBox

> ID：14522540
> 
> 赞同：90
> 
> 时间：2013-01-25T13:14:23.383
> 
> 标签：c#, winforms, messagebox

我有一个 Windows 窗体应用程序 VS2010 C#，我在其中显示一个 MessageBox 以显示消息。

我有一个好的按钮，但如果他们走开，我想超时并在 5 秒后关闭消息框，自动关闭消息框。

有自定义 MessageBox（继承自 Form）或其他报告表单，但有趣的是不需要表单。

有什么建议或样品吗？

**更新：**

对于 WPF
[在 C# 中自动关闭消息框](https://stackoverflow.com/questions/4362235/automatically-close-messagebox-in-c-sharp)

自定义MessageBox（使用Form继承）
[http://www.codeproject.com/Articles/17253/A-Custom-Message-Box](http://www.codeproject.com/Articles/17253/A-Custom-Message-Box)

[http://www.codeproject.com/Articles/327212/Custom-Message-Box-in-VC](http://www.codeproject.com/Articles/327212/Custom-Message-Box-in-VC)

[http://tutplusplus.blogspot.com.es/2010/07/c-tutorial-create-your-own-custom.html](http://tutplusplus.blogspot.com.es/2010/07/c-tutorial-create-your-own-custom.html)

[http://medmondson2011.wordpress.com/2010/04/07/easy-to-use-custom-c-message-box-with-a-configurable-checkbox/](http://medmondson2011.wordpress.com/2010/04/07/easy-to-use-custom-c-message-box-with-a-configurable-checkbox/)

可滚动消息框
[C# 中的可滚动消息框](https://stackoverflow.com/questions/4681936/a-scrollable-messagebox-in-c-sharp)

异常报告者
[https://stackoverflow.com/questions/49224/good-crash-reporting-library-in-c-sharp](https://stackoverflow.com/questions/49224/good-crash-reporting-library-in-c-sharp)

[http://www.codeproject.com/Articles/6895/A-Reusable-Flexible-Error-Reporting-Framework](http://www.codeproject.com/Articles/6895/A-Reusable-Flexible-Error-Reporting-Framework)

**解决方案：**

也许我认为以下答案是很好的解决方案，无需使用表单。

[https://stackoverflow.com/a/14522902/206730](https://stackoverflow.com/a/14522902/206730)
[https://stackoverflow.com/a/14522952/206730](https://stackoverflow.com/a/14522952/206730)

* * *

## 回答 #1

> 赞同：129
> 
> 时间：2013-01-25T13:41:45.467

尝试以下方法：

```
AutoClosingMessageBox.Show("Text", "Caption", 1000); 
```

类`AutoClosingMessageBox`实现如下：

```
public class AutoClosingMessageBox {
    System.Threading.Timer _timeoutTimer;
    string _caption;
    AutoClosingMessageBox(string text, string caption, int timeout) {
        _caption = caption;
        _timeoutTimer = new System.Threading.Timer(OnTimerElapsed,
            null, timeout, System.Threading.Timeout.Infinite);
        using(_timeoutTimer)
            MessageBox.Show(text, caption);
    }
    public static void Show(string text, string caption, int timeout) {
        new AutoClosingMessageBox(text, caption, timeout);
    }
    void OnTimerElapsed(object state) {
        IntPtr mbWnd = FindWindow("#32770", _caption); // lpClassName is #32770 for MessageBox
        if(mbWnd != IntPtr.Zero)
            SendMessage(mbWnd, WM_CLOSE, IntPtr.Zero, IntPtr.Zero);
        _timeoutTimer.Dispose();
    }
    const int WM_CLOSE = 0x0010;
    [System.Runtime.InteropServices.DllImport("user32.dll", SetLastError = true)]
    static extern IntPtr FindWindow(string lpClassName, string lpWindowName);
    [System.Runtime.InteropServices.DllImport("user32.dll", CharSet = System.Runtime.InteropServices.CharSet.Auto)]
    static extern IntPtr SendMessage(IntPtr hWnd, UInt32 Msg, IntPtr wParam, IntPtr lParam);
} 
```

**更新：** 如果您想在用户在超时之前选择某些内容时获取底层 MessageBox 的返回值，您可以使用此代码的以下版本：

```
var userResult = AutoClosingMessageBox.Show("Yes or No?", "Caption", 1000, MessageBoxButtons.YesNo);
if(userResult == System.Windows.Forms.DialogResult.Yes) { 
    // do something
}
...
public class AutoClosingMessageBox {
    System.Threading.Timer _timeoutTimer;
    string _caption;
    DialogResult _result;
    DialogResult _timerResult;
    AutoClosingMessageBox(string text, string caption, int timeout, MessageBoxButtons buttons = MessageBoxButtons.OK, DialogResult timerResult = DialogResult.None) {
        _caption = caption;
        _timeoutTimer = new System.Threading.Timer(OnTimerElapsed,
            null, timeout, System.Threading.Timeout.Infinite);
        _timerResult = timerResult;
        using(_timeoutTimer)
            _result = MessageBox.Show(text, caption, buttons);
    }
    public static DialogResult Show(string text, string caption, int timeout, MessageBoxButtons buttons = MessageBoxButtons.OK, DialogResult timerResult = DialogResult.None) {
        return new AutoClosingMessageBox(text, caption, timeout, buttons, timerResult)._result;
    }
    void OnTimerElapsed(object state) {
        IntPtr mbWnd = FindWindow("#32770", _caption); // lpClassName is #32770 for MessageBox
        if(mbWnd != IntPtr.Zero)
            SendMessage(mbWnd, WM_CLOSE, IntPtr.Zero, IntPtr.Zero);
        _timeoutTimer.Dispose();
        _result = _timerResult;
    }
    const int WM_CLOSE = 0x0010;
    [System.Runtime.InteropServices.DllImport("user32.dll", SetLastError = true)]
    static extern IntPtr FindWindow(string lpClassName, string lpWindowName);
    [System.Runtime.InteropServices.DllImport("user32.dll", CharSet = System.Runtime.InteropServices.CharSet.Auto)]
    static extern IntPtr SendMessage(IntPtr hWnd, UInt32 Msg, IntPtr wParam, IntPtr lParam);
} 
```

**又一个更新**

我用按钮检查了@Jack 的案例，`YesNo`发现发送`WM_CLOSE`消息的方法根本不起作用。[我将在单独的AutoclosingMessageBox](https://github.com/DmitryGaravsky/AutoClosingMessageBox)库的上下文中
提供*修复。*这个库包含重新设计的方法，我相信它对某人有用。 它也可以通过[NuGet 包](https://www.nuget.org/packages/AutoClosingMessageBox)获得：

```
Install-Package AutoClosingMessageBox 
```

**发行说明 (v1.0.0.2)：**
- 新的 Show(IWin32Owner) API 以支持最流行的场景（在[#1](https://github.com/DmitryGaravsky/AutoClosingMessageBox/issues/1)的上下文中）；
- 新的 Factory() API 提供对 MessageBox 显示的完全控制；

* * *

## 回答 #2

> 赞同：42
> 
> 时间：2014-10-17T05:03:44.397

适用于 WinForms 的解决方案：

```
var w = new Form() { Size = new Size(0, 0) };
Task.Delay(TimeSpan.FromSeconds(10))
    .ContinueWith((t) => w.Close(), TaskScheduler.FromCurrentSynchronizationContext());

MessageBox.Show(w, message, caption); 
```

基于关闭拥有消息框的表单也会关闭该框的效果。

Windows 窗体控件要求必须在创建它们的同一线程上访问它们。Using`TaskScheduler.FromCurrentSynchronizationContext()`将确保，假设上面的示例代码在 UI 线程或用户创建的线程上执行。如果代码在来自线程池（例如计时器回调）或任务池（例如在使用`TaskFactory.StartNew`或`Task.Run`使用默认参数创建的任务）的线程上执行，则该示例将无法正常工作。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2013-01-25T16:08:23.233

# 应用激活！

如果您不介意混淆您的参考资料，您可以包含`Microsoft.Visualbasic,`并使用这种非常简短的方式。

显示消息框

```
 (new System.Threading.Thread(CloseIt)).Start();
    MessageBox.Show("HI"); 
```

关闭功能：

```
public void CloseIt()
{
    System.Threading.Thread.Sleep(2000);
    Microsoft.VisualBasic.Interaction.AppActivate( 
         System.Diagnostics.Process.GetCurrentProcess().Id);
    System.Windows.Forms.SendKeys.SendWait(" ");
} 
```

现在去洗手吧！

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2013-01-25T13:38:09.980

你可以试试这个：

```
[DllImport("user32.dll", EntryPoint="FindWindow", SetLastError = true)]
static extern IntPtr FindWindowByCaption(IntPtr ZeroOnly, string lpWindowName);

[DllImport("user32.Dll")]
static extern int PostMessage(IntPtr hWnd, UInt32 msg, int wParam, int lParam);

private const UInt32 WM_CLOSE = 0x0010;

public void ShowAutoClosingMessageBox(string message, string caption)
{
    var timer = new System.Timers.Timer(5000) { AutoReset = false };
    timer.Elapsed += delegate
    {
        IntPtr hWnd = FindWindowByCaption(IntPtr.Zero, caption);
        if (hWnd.ToInt32() != 0) PostMessage(hWnd, WM_CLOSE, 0, 0);
    };
    timer.Enabled = true;
    MessageBox.Show(message, caption);
} 
```

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2013-11-20T14:19:48.337

System.Windows.MessageBox.Show() 方法有一个重载，它将所有者 Window 作为第一个参数。如果我们创建一个不可见的所有者窗口，然后在指定时间后关闭它，它的子消息框也会关闭。

```
Window owner = CreateAutoCloseWindow(dialogTimeout);
MessageBoxResult result = MessageBox.Show(owner, ... 
```

到目前为止，一切都很好。但是如果 UI 线程被消息框阻塞并且 UI 控件无法从工作线程访问，我们如何关闭窗口呢？答案是 - 通过向所有者窗口句柄发送 WM_CLOSE 窗口消息：

```
Window CreateAutoCloseWindow(TimeSpan timeout)
{
    Window window = new Window()
    {
        WindowStyle = WindowStyle.None,
        WindowState = System.Windows.WindowState.Maximized,
        Background =  System.Windows.Media.Brushes.Transparent, 
        AllowsTransparency = true,
        ShowInTaskbar = false,
        ShowActivated = true,
        Topmost = true
    };

    window.Show();

    IntPtr handle = new WindowInteropHelper(window).Handle;

    Task.Delay((int)timeout.TotalMilliseconds).ContinueWith(
        t => NativeMethods.SendMessage(handle, 0x10 /*WM_CLOSE*/, IntPtr.Zero, IntPtr.Zero));

    return window;
} 
```

这是 SendMessage Windows API 方法的导入：

```
static class NativeMethods
{
    [DllImport("user32.dll", CharSet = CharSet.Auto)]
    public static extern IntPtr SendMessage(IntPtr hWnd, UInt32 Msg, IntPtr wParam, IntPtr lParam);
} 
```

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2015-12-05T03:42:21.660

[CodeProject 的RogerB](http://www.codeproject.com/script/Membership/View.aspx?mid=716667)对此答案有最巧妙的解决方案之一，他早在 04 年就做到了，现在仍然很成功

基本上，你[去他的项目并下载 CS 文件](http://www.codeproject.com/Articles/7968/MessageBox-with-a-timeout-for-NET)。万一该链接失效，我在这里有一个备份[要点](https://gist.github.com/the-nose-knows/b933ab0a041cc482834c2184ccb27c3d)。将 CS 文件添加到您的项目中，或者如果您愿意，可以将代码复制/粘贴到某处。

然后，你所要做的就是切换

```
DialogResult result = MessageBox.Show("Text","Title", MessageBoxButtons.CHOICE) 
```

至

```
DialogResult result = MessageBoxEx.Show("Text","Title", MessageBoxButtons.CHOICE, timer_ms) 
```

你可以走了。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2013-01-25T13:25:57.760

[这里](http://www.codeproject.com/Articles/93429/messageBox-with-Timeout)有一个可用的 codeproject 项目，可以提供这种功能。

在 SO 和其他板上遵循许多线程，这不能用普通的 MessageBox 完成。

编辑：

我有一个想法，有点嗯嗯嗯..

使用计时器并在 MessageBox 出现时开始。如果您的 MessageBox 只收听 OK 按钮（只有 1 种可能性），则使用 OnTick-Event 模拟 ESC-Press`SendKeys.Send("{ESC}");`并停止计时器。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2017-03-08T12:25:51.360

DMitryG 的代码“获取底层的返回值`MessageBox`”有一个错误，因此 timerResult 永远不会真正正确返回（`MessageBox.Show`调用`OnTimerElapsed`完成后返回）。我的修复如下：

```
public class TimedMessageBox {
    System.Threading.Timer _timeoutTimer;
    string _caption;
    DialogResult _result;
    DialogResult _timerResult;
    bool timedOut = false;

    TimedMessageBox(string text, string caption, int timeout, MessageBoxButtons buttons = MessageBoxButtons.OK, DialogResult timerResult = DialogResult.None)
    {
        _caption = caption;
        _timeoutTimer = new System.Threading.Timer(OnTimerElapsed,
            null, timeout, System.Threading.Timeout.Infinite);
        _timerResult = timerResult;
        using(_timeoutTimer)
            _result = MessageBox.Show(text, caption, buttons);
        if (timedOut) _result = _timerResult;
    }

    public static DialogResult Show(string text, string caption, int timeout, MessageBoxButtons buttons = MessageBoxButtons.OK, DialogResult timerResult = DialogResult.None) {
        return new TimedMessageBox(text, caption, timeout, buttons, timerResult)._result;
    }

    void OnTimerElapsed(object state) {
        IntPtr mbWnd = FindWindow("#32770", _caption); // lpClassName is #32770 for MessageBox
        if(mbWnd != IntPtr.Zero)
            SendMessage(mbWnd, WM_CLOSE, IntPtr.Zero, IntPtr.Zero);
        _timeoutTimer.Dispose();
        timedOut = true;
    }

    const int WM_CLOSE = 0x0010;
    [System.Runtime.InteropServices.DllImport("user32.dll", SetLastError = true, CharSet = System.Runtime.InteropServices.CharSet.Auto)]
    static extern IntPtr FindWindow(string lpClassName, string lpWindowName);
    [System.Runtime.InteropServices.DllImport("user32.dll", CharSet = System.Runtime.InteropServices.CharSet.Auto)]
    static extern IntPtr SendMessage(IntPtr hWnd, UInt32 Msg, IntPtr wParam, IntPtr lParam);
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2021-02-11T10:50:45.607

我知道这个问题已有 8 年历史了，但是为此目的存在并且有更好的解决方案。它一直在那里，现在仍然是：`MessageBoxTimeout()`在`User32.dll`.

这是 Microsoft Windows 使用的一个未记录的函数，它完全符合您的要求，甚至更多。它也支持不同的语言。

C# 导入：

```
[DllImport("user32.dll", SetLastError = true)]
public static extern int MessageBoxTimeout(IntPtr hWnd, String lpText, String lpCaption, uint uType, Int16 wLanguageId, Int32 dwMilliseconds);

[DllImport("user32.dll", SetLastError = true)]
public static extern IntPtr GetForegroundWindow(); 
```

如何在 C# 中使用它：

```
uint uiFlags = /*MB_OK*/ 0x00000000 | /*MB_SETFOREGROUND*/  0x00010000 | /*MB_SYSTEMMODAL*/ 0x00001000 | /*MB_ICONEXCLAMATION*/ 0x00000030;

NativeFunctions.MessageBoxTimeout(NativeFunctions.GetForegroundWindow(), $"Kitty", $"Hello", uiFlags, 0, 5000); 
```

更聪明地工作，而不是更努力地工作。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2019-07-17T12:08:53.363

Vb.net 库有一个使用交互类的简单解决方案：

```
void MsgPopup(string text, string title, int secs = 3)
{
    dynamic intr = Microsoft.VisualBasic.Interaction.CreateObject("WScript.Shell");
    intr.Popup(text, secs, title);
}

bool MsgPopupYesNo(string text, string title, int secs = 3)
{
    dynamic intr = Microsoft.VisualBasic.Interaction.CreateObject("WScript.Shell");
    int answer = intr.Popup(text, secs, title, (int)Microsoft.VisualBasic.Constants.vbYesNo + (int)Microsoft.VisualBasic.Constants.vbQuestion);
    return (answer == 6);
} 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2019-07-26T11:33:31.193

我是这样做的

```
var owner = new Form { TopMost = true };
Task.Delay(30000).ContinueWith(t => {
owner.Invoke(new Action(()=>
{
      if (!owner.IsDisposed)
      {
          owner.Close();
      }
   }));
});
var dialogRes =  MessageBox.Show(owner, msg, "Info", MessageBoxButtons.YesNo, MessageBoxIcon.Information); 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2021-02-02T06:09:43.210

**如果有人想要C++**中的AutoClosingMessageBox，我已经实现了等效代码，这里是[gists的链接](https://gist.github.com/haseeb-heaven/a97ea40c4ca3b6ba6d5a1b8348bd0585)

```
static intptr_t MessageBoxHookProc(int nCode, intptr_t wParam, intptr_t lParam)
{
    if (nCode < 0)
        return CallNextHookEx(hHook, nCode, wParam, lParam);

    auto msg = reinterpret_cast<CWPRETSTRUCT*>(lParam);
    auto hook = hHook;

    //Hook Messagebox on Initialization.
    if (!hookCaption.empty() && msg->message == WM_INITDIALOG)
    {
        int nLength = GetWindowTextLength(msg->hwnd);
        char* text = new char[captionLen + 1];

        GetWindowText(msg->hwnd, text, captionLen + 1);

        //If Caption window found Unhook it.
        if (hookCaption == text)
        {
            hookCaption = string("");
            SetTimer(msg->hwnd, (uintptr_t)timerID, hookTimeout, (TIMERPROC)hookTimer);
            UnhookWindowsHookEx(hHook);
            hHook = 0;
        }
    }

    return CallNextHookEx(hook, nCode, wParam, lParam);
} 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2016-12-21T06:44:53.133

user32.dll 中有一个名为 MessageBoxTimeout() 的未记录 API，但它需要 Windows XP 或更高版本。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2019-05-22T07:45:03.997

使用`EndDialog`而不是发送`WM_CLOSE`：

```
[DllImport("user32.dll")]
public static extern int EndDialog(IntPtr hDlg, IntPtr nResult); 
```

# c# - DataReader 光标倒带

> ID：14522541
> 
> 赞同：4
> 
> 时间：2013-01-25T13:14:32.593
> 
> 标签：c#, sql-server, database, cursor, sqldatareader

如何将 DataReader 的光标倒回到开头？

对于一个 DataReader 结果，我需要运行两个`while`循环，但必须从头开始。它们是一个结果集中的两次迭代，运行一次查询。

例子：

```
dr = command.ExecuteReader(cmd);

while (dr.Read()) { 
    // do some...
}

// rewind cursor here

while (dr.Read()) {
    // do another things...
} 
```

我查看了 DataReader 文档，但一无所获，因此如果 DataReader 无法实现，我可能会更改适合此目的的类。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-25T13:15:49.290

您不能（除非您再次执行该命令）：它是单向流。如果您想多次查看数据，则必须自己将其缓冲在内存中，例如在 a `List<T>`(for some `T`) 或 (yeuch) as a`DataTable`中。

# android - 图片和文本编辑器，如 PicSay 安卓应用

> ID：14522542
> 
> 赞同：0
> 
> 时间：2013-01-25T13:14:39.443
> 
> 标签：android, photo, resize-image, text-editor

我正在开发像[PicSay](https://play.google.com/store/apps/details?id=com.shinycore.picsayfree&hl=en) android 应用程序这样的图像编辑应用程序，其中我必须将文本放在具有自定义背景的图像上，并且用户可以通过屏幕上的触摸/控制器调整文本大小。我尝试了很多东西，但我做不到，请帮助我，Android 中是否有任何 API 可用于图像编辑器？

纳克斯， ![在此处输入图像描述](../Images/40a5477cb0a958a6f1ed277ef3105aec.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-09T16:05:22.693

您可以使用[Aviary SDK](http://www.aviary.com/android)开发照片编辑项目。

*或者*

您可以使用[OPENCV 进行图像处理](http://ubaa.net/shared/processing/opencv/)。

我希望这可以帮助你。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-25T14:43:04.267

我认为使用此演示代码可能会对您有所帮助。

爪哇

```
public class MainActivity extends Activity implements OnTouchListener{

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        /*Put you code */
    }

    @Override
    public boolean onTouch(View v, MotionEvent event) {
        // TODO Auto-generated method stub

        return false;
    }

} 
```

xml

```
<FrameLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:id="@+id/root"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    tools:context=".MainActivity" >

    <EditText
        android:id="@+id/editText1"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:background="@drawable/test"
        android:ems="10"
        android:gravity="center"
        android:textColor="#FFFFFF" >
    </EditText>

</FrameLayout> 
```

# html - NodeJS 中的 HTML5 Web Worker？

> ID：14522543
> 
> 赞同：7
> 
> 时间：2013-01-25T13:14:40.950
> 
> 标签：html, node.js, web-worker

任何人都知道 NodeJS 中 Web Worker 支持的状态是什么？我找到了一个两年前的实现，node-webworkers，但它没有在当前的 NodeJS 版本中运行。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2014-11-07T19:35:57.767

现在有[https://github.com/audreyt/node-webworker-threads](https://github.com/audreyt/node-webworker-threads)似乎正在积极维护。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2019-11-17T20:10:02.393

[工作线程](https://nodejs.org/docs/latest-v12.x/api/worker_threads.html)在 12 LTS 中达到稳定状态。使用示例

> ```
> const {
>   Worker, isMainThread, parentPort, workerData
> } = require('worker_threads');
> 
> if (isMainThread) {
>   module.exports = function parseJSAsync(script) {
>     return new Promise((resolve, reject) => {
>       const worker = new Worker(__filename, {
>         workerData: script
>       });
>       worker.on('message', resolve);
>       worker.on('error', reject);
>       worker.on('exit', (code) => {
>         if (code !== 0)
>           reject(new Error(`Worker stopped with exit code ${code}`));
>       });
>     });
>   };
> } else {
>   const { parse } = require('some-js-parsing-library');
>   const script = workerData;
>   parentPort.postMessage(parse(script));
> } 
> ```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-25T13:28:00.463

您可以使用[子进程](http://nodejs.org/api/child_process.html)，它们可以解决类似的问题。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2020-10-25T11:38:44.093

您可以查看 HTML5 WebWorker 源代码的细节。

稍加注意，您可以通过添加可能看起来像这样的前奏来“纠正” WebWorker 以适应 Node.js 工作者：

```
const { parentPort } = require('worker_threads')

global.postMessage = function(msg){
    parentPort.postMessage(msg)
}

var handler

global.addEventListener = function(kind, callback){
    handler = callback    
}

parentPort.on('message', msg => {
    handler(msg)
}) 
```

特定的 HTML5 工作人员使用 添加了一个`message`事件处理程序`addEventListener`，因此我在其中注册了这样一个函数`global`并保存了该处理程序。我还必须提供一个`postMessage`实现。最后，我注册了一个调用 HTML5 处理程序的 Node.js 消息处理程序。

一切都很完美。不需要任何特殊的依赖，只需查看 HTML5 工作代码并确定它处理消息的点。

# android - 自定义 ExpandableListAdapter 中的 Android 自定义字体

> ID：14522545
> 
> 赞同：1
> 
> 时间：2013-01-25T13:14:47.120
> 
> 标签：android, expandablelistview, expandablelistadapter

我正在尝试在自定义可扩展列表视图中使用自定义字体。但是，当我尝试执行此操作时，最初，当加载 Viewpager 片段（我使用的）时，ExpandableListView 的文本和字体不可见。

一旦我单击可扩展列表视图中的空白文本，就会显示文本和字体。这个问题似乎只发生在自定义字体上。如果我使用任何其他自定义功能（例如更改 textview 的颜色等），它会运行良好。请帮助

请参阅所附图片以供进一步参考： ![1](../Images/c629798f46857c54025468ecd10cd4f5.png) ![2](../Images/ca67ee6f7c18d10d93f65dbfe494b758.png)

我的自定义可扩展列表适配器代码的相关部分：

```
public class MyExpandableListAdapter extends SimpleExpandableListAdapter {

    View cntView;
    LayoutInflater inflater;
    Context cxt;
    TextView tvGrp, tvChild;

    public MyExpandableListAdapter(Context context,
            List<? extends Map<String, ?>> groupData, int groupLayout,
            String[] groupFrom, int[] groupTo,
            List<? extends List<? extends Map<String, ?>>> childData,
            int childLayout, String[] childFrom, int[] childTo) {
        super(context, groupData, groupLayout, groupFrom, groupTo, childData,
                childLayout, childFrom, childTo);
        cxt=context;
    }

    @Override
    public View getGroupView(int groupPosition, boolean isExpanded,
            View convertView, ViewGroup parent) {

        super.getGroupView(groupPosition, isExpanded, convertView, parent);
        View tmp;

        if (convertView == null) {  // if it's not recycled, initialize some attributes
            tmp=new View(cxt);
            inflater=(LayoutInflater)cxt.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
            tmp=inflater.inflate(R.layout.explistgroup, null);
        }else{
            tmp = (View)convertView;
        }

        tvGrp=(TextView) tmp.findViewById(R.id.rowTextView);
        tvGrp.setTypeface(FontLoader.loadTypeface(cxt,R.raw.roboto_regular));  // This does not work. It shows a blank textview initially. Only after I click it, the typeface and the text come into effect
        //tvGrp.setText("ambit"); -- This works well

        return tmp;

    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T15:09:54.157

尝试从资产加载自定义字体，例如：

```
Typeface tf = Typeface.createFromAsset(getAssets(), "<your font name>.ttf");
tvGrp.setTypeface(tf); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-04T16:32:35.700

好的，这是您需要做的事情： 1- 在 Activity 中初始化一个公共静态变量，您在其中使用自定义适配器为您的可扩展列表视图说 MainListActivity，如下所示：

`public static Typeface typeFace;`

2- 现在像 Natali 在同一个 Activity 中提到的那样初始化它，如下所示：

`tf = Typeface.createFromAsset(getAssets(), "<your font name>.ttf");`

3- 现在按照 Natali 先生的指示在您的自定义适配器中使用以下内容，但稍作更改

`tvGrp.setTypeface(MainListActivity.typeFace);`

如果问题仍然存在，请尝试扩展自定义适配器类`BaseExpandableListAdapter`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-04T16:45:15.833

您只创建一个视图，而不是为其设置文本。`text`xml中有没有？我认为这个方法应该是这样的：

```
@Override
public View getGroupView(int groupPosition, boolean isExpanded,
        View convertView, ViewGroup parent) {

    ViewGroup tmp = (ViewGroup)super.getGroupView(groupPosition, isExpanded, convertView, parent);
    tvGrp=(TextView) tmp.findViewById(R.id.rowTextView);
    tvGrp.setTypeface(FontLoader.loadTypeface(cxt,R.raw.roboto_regular));  // This does not work. It shows a blank textview initially. Only after I click it, the typeface and the text come into effect
    //tvGrp.setText("ambit"); -- This works well

    return tmp;

} 
```

或者您的创建和初始化而不是调用 super.

这应该可以正常工作。

# jasper-reports - 将 JasperReports 与依赖 CDI 的数据源一起使用

> ID：14522551
> 
> 赞同：0
> 
> 时间：2013-01-25T13:15:00.067
> 
> 标签：jasper-reports, cdi

我有一些类在他们的 getter 中使用 CDI 注入的 bean，例如：

```
class MyBean() {
    @Inject
    private TranslationBean translationBean;

    private String chosenValue;

    public void setChosenValue(String c) { chosenValue = c;}
    public String getChosenValue() {
        return translationBean.getTranslatedValue(chosenValue);
    }
} 
```

底层`chosenValue`从数据库中加载并保存到数据库中。

现在我想创建一个 JasperReport 生成的 PDF，其中包含`DataSource`. 我打电话：

```
JasperFillManager.fillReport("myFile.jasper", new HashMap<String, Object>(), new JRBeanCollectionDataSource(Arrays.asList(myBean)); 
```

显然，来自 Weld 的错误消息最终将是没有上下文处于活动状态。

我现在看到两种可能性：

1.  为 JasperReports创建一个包装类`MyBean`，其中所有需要的字段都填充了实际数据，并且不需要 CDI 依赖项。问题将是：大量的代码带有大量的样板和重复代码。
2.  不知何故，设法围绕调用包装一个上下文，`JasperFillManager`以便它在一个/当前活动的 CDI 上下文中运行。

第二种选择可行吗？还有比提议的方法之一更好的方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T15:12:35.190

如果可以包装所有 JasperStuff，您可能正在考虑创建一个新范围。[查看https://github.com/seam/reports](https://github.com/seam/reports)中的 Seam Reports 内容，它可能会有所帮助或启发。

# android - 包含 Android 地图 v2 片段时，RequestFactory 验证失败

> ID：14522553
> 
> 赞同：0
> 
> 时间：2013-01-25T13:15:16.117
> 
> 标签：android, requestfactory, android-maps-v2

我已经`RequestFactory`在我的 Android 应用程序中成功使用了很长时间，但是现在在尝试升级到 maps v2 时，当我包含

```
<fragment
        xmlns:android="http://schemas.android.com/apk/res/android"
        android:id="@+id/map"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        class="com.google.android.gms.maps.SupportMapFragment" /> 
```

在我的 XML 布局文件中，出现错误：

> ```
> 01-25 08:08:41.978: E/AndroidRuntime(19854):
> java.lang.RuntimeException: Unable to resume activity{com.xx/com.xx.MyActivity}:
> java.lang.RuntimeException: The RequestFactory ValidationTool must be
> run for the com.xx.client.MyRequestFactory RequestFactory type 
> ```

如果我从布局 XML 文件中删除片段代码，一切正常。

这个片段如何影响我的 RequestFactory 验证，我该如何修复它？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T04:26:14.060

[正如如何在 Android SyncAdapter 中使用 GWT-RequestFactory 中](https://stackoverflow.com/questions/8049351/how-to-use-the-gwt-requestfactory-in-android-syncadapter-always-getting-validat)所指出的（总是得到 ValidationTool-Error）

如果添加

```
Thread.currentThread().setContextClassLoader(mContext.getClassLoader()); 
```

前

```
requestFactory = RequestFactorySource.create(factoryClass); 
```

问题已解决。

# python - Python for 循环执行

> ID：14522556
> 
> 赞同：1
> 
> 时间：2013-01-25T13:15:36.477
> 
> 标签：python, for-loop, python-2.7

```
for a in sorted(arr):
    doSomething() 
```

对比

```
sArr = sorted(arr)
for a in sArr:
    doSomething() 
```

这两个是否完全相同，或者一个会消耗更多的 CPU 周期然后另一个？

意思是， sorted(arr) 在第一个示例中的每个循环都会被调用吗？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-25T13:18:12.983

它们几乎相同。

[文档](http://docs.python.org/2/reference/compound_stmts.html#for)说：

> 表达式列表被评估一次；它应该产生一个可迭代的对象。

因此，`sorted()`在上面的代码中，不会有多次调用的风险。

第一种形式仍然更好，因为它更短更简洁，并且可以更好地优化（因为解释器可以确定循环结束后排序列表完全超出范围）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-25T13:20:42.983

它们并不完全相同，但差异很小。如有疑问，请使用该`dis`模块找出：

```
>>> import dis
>>> def f():
...     for a in sorted(arr):
...         doSomething()
... 
>>> def g():
...     sArr = sorted(arr)
...     for a in sArr:
...         doSomething()
... 
>>> dis.dis(f)
  2           0 SETUP_LOOP              27 (to 30)
              3 LOAD_GLOBAL              0 (sorted)
              6 LOAD_GLOBAL              1 (arr)
              9 CALL_FUNCTION            1
             12 GET_ITER            
        >>   13 FOR_ITER                13 (to 29)
             16 STORE_FAST               0 (a)

  3          19 LOAD_GLOBAL              2 (doSomething)
             22 CALL_FUNCTION            0
             25 POP_TOP             
             26 JUMP_ABSOLUTE           13
        >>   29 POP_BLOCK           
        >>   30 LOAD_CONST               0 (None)
             33 RETURN_VALUE        
>>> dis.dis(g)
  2           0 LOAD_GLOBAL              0 (sorted)
              3 LOAD_GLOBAL              1 (arr)
              6 CALL_FUNCTION            1
              9 STORE_FAST               0 (sArr)

  3          12 SETUP_LOOP              21 (to 36)
             15 LOAD_FAST                0 (sArr)
             18 GET_ITER            
        >>   19 FOR_ITER                13 (to 35)
             22 STORE_FAST               1 (a)

  4          25 LOAD_GLOBAL              2 (doSomething)
             28 CALL_FUNCTION            0
             31 POP_TOP             
             32 JUMP_ABSOLUTE           19
        >>   35 POP_BLOCK           
        >>   36 LOAD_CONST               0 (None)
             39 RETURN_VALUE 
```

如您所见，该`g()`函数添加了一个`STORE_FAST`and`LOAD_FAST`操作。您还使用了更多的内存，因为已排序的结果会保留在`sArr`变量被清理之前，而在`f()`循环结束后可以立即清理已排序的结果。

执行函数`CALL_FUNCTION`；`sorted()`它只执行一次。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-25T13:18:24.783

`sorted()`返回一个随后被迭代的对象。它只被调用一次。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-25T13:21:09.770

和其他人说的一样。请记住，当有疑问时（尽管在这种情况下微不足道且显而易见），请始终在源代码上运行反汇编。或者，您可以通过 cProfile 运行它，即使反汇编不同，cProfile 也会对性能给出一个公平的概念

```
>>> def foo():
    total = 0
    arr = range(10000000,1,-1)
    for a in sorted(arr):
        total += a

>>> def bar():
    total = 0
    for a in sorted(range(10000000,1,-1)):
        total += a

>>> cProfile.run("bar()")
         5 function calls in 2.614 seconds

   Ordered by: standard name

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    1.914    1.914    2.614    2.614 <pyshell#88>:1(bar)
        1    0.000    0.000    2.614    2.614 <string>:1(<module>)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        1    0.266    0.266    0.266    0.266 {range}
        1    0.434    0.434    0.434    0.434 {sorted}

>>> cProfile.run("foo()")
         5 function calls in 2.477 seconds

   Ordered by: standard name

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    1.779    1.779    2.346    2.346 <pyshell#86>:1(foo)
        1    0.130    0.130    2.477    2.477 <string>:1(<module>)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        1    0.152    0.152    0.152    0.152 {range}
        1    0.415    0.415    0.415    0.415 {sorted}

>>> 
```

正如你会在这里观察到的

1.  在这两种情况下，Sorted 只被调用一次
2.  每种情况下有 5 个函数调用
3.  它们的性能几乎相同。

# c# - 在对象成员中使用变量

> ID：14522558
> 
> 赞同：3
> 
> 时间：2013-01-25T13:15:41.830
> 
> 标签：c#

我从 C# 中的对象中提取了几个数据元素。它们都在对象内的同一个“位置”，如下所示：

```
objectContainer.TableData.Street.ToString());
objectContainer.TableData.City.ToString());
objectContainer.TableData.State.ToString());
objectContainer.TableData.ZipCode.ToString()); 
```

我想使用 foreach 循环将它们全部拉出，并能够通过添加到数组中来添加更多。

```
string[] addressFields = new string[] { "Street", "City", "State", "ZipCode" };
foreach(string add in addressFields) 
{
  objectContainer.TableData.{add}.ToString());
} 
```

可以这样做吗？如果可以，正确的程序是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-25T13:19:07.390

您需要使用反射来实现这一点：

```
var type = objectContainer.TableData.GetType();

foreach(var addressFieldName in addressFieldNames)
{
    var property = type.GetProperty(addressFieldName);
    if(property == null)
        continue;
    var value = property.GetValue(objectContainer.TableData, null);
    var stringValue = string.Empty;
    if(value != null)
        stringValue = value.ToString();
} 
```

请注意：此代码非常具有防御性：

*   如果不存在具有指定名称的属性，它不会崩溃。
*   如果属性的值为 ，它不会崩溃`null`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T13:21:42.360

您可以使用反射来执行此操作。

```
string[] addressFields = new string[] { "Street", "City", "State", "ZipCode" };
foreach(string add in addressFields) 
{
  var myVal = objectContainer.TableData.GetType().GetProperty(add).GetValue(objectContainer.TableData).ToString();
} 
```

请注意，这不允许在 objectContainer.TableData 上没有相应属性的数组值。

# c++ - 增加gsl最小化器的尺寸

> ID：14522560
> 
> 赞同：1
> 
> 时间：2013-01-25T13:15:47.430
> 
> 标签：c++, gsl, optimization

我必须开发一个优化器来计算隐藏马尔可夫链的 14 个参数（我知道它很多但可能:)）。我已经使用 IMSL（我在实习期间使用过）完成了相同的优化器，我知道这是可能的，但我现在没有 IMSL 的许可证，因为我正在做一个学生项目，我正在尝试制作C++ 中的相同优化器。

但是我收到了这个错误（我已经在它出现的代码中评论过）：

```
gsl：simplex.c：288：错误：遇到非有限函数值

调用默认 GSL 错误处理程序。

中止

```

我正在使用`GSL library`，更具体地说是子库`multimin`。

稍后我将在这里向您展示我的代码，如果您需要，我会很乐意对其进行更多评论，但我可以将其与数据一起发送给任何可以帮助我的人。

非常感谢您的时间和帮助。

本杰明，

我们需要的优化器结构：

```
 struct dataMom {
            int         n;    /* Number of data points */
            gsl_vector *Rmom;    /* Response data */
            gsl_vector *Rm;    /* Covariate */
    }; 
```

计算值的函数

```
double my_f (const gsl_vector *v, void *params) {
    struct dataMom *p = (struct dataMom *) params;
    int i;

    double loglik = 0; 
```

所以你可以看到我们有 14 个参数需要优化。

```
 double alphaC = gsl_vector_get (v, 0);
    double beta0C =gsl_vector_get (v, 1);
    double betaUC =gsl_vector_get (v, 2);
    double sigmamomC =gsl_vector_get (v, 3);
    double muC =gsl_vector_get (v, 4);
    double sigmamC =gsl_vector_get (v, 5);
    double probaC =gsl_vector_get (v, 6);

    double alphaT= gsl_vector_get (v, 7);
    double beta0T =  gsl_vector_get (v, 8);
    double betaUT= gsl_vector_get (v, 9);
    double sigmamomT= gsl_vector_get (v, 10);
    double muT =gsl_vector_get (v, 11);
    double sigmamT = gsl_vector_get (v, 12);
    double probaT =gsl_vector_get (v, 13);

    double epsilonmomC;
    double epsilonmC;
    double epsilonmomT;
    double epsilonmT;
    double Rmomentum;
    double Rmarket;
    double IUT;
    double Pc;
    double Pt;
    double PC;
    double PT;
    double PI = 3.14159;

    double probac = (1-probaT)/(2-probaC-probaT);
    double probat = 1-probac;

    for (i=0;i<p->n;i++) {

        Rmomentum = gsl_vector_get(p->Rmom, i)*0.01;
        Rmarket = gsl_vector_get(p->Rm, i)*0.01;
        if (Rmarket>0){IUT = 1;}
        else {IUT = 0;}

        epsilonmomC = (1/sigmamomC)*(Rmomentum - alphaC - (beta0C + IUT*betaUC)*Rmarket);
        epsilonmC = (1/sigmamC)*(Rmarket-muC);

        epsilonmomT = (1/sigmamomT)*(Rmomentum - alphaT - (beta0T + IUT*betaUT)*Rmarket);
        epsilonmT = (1/sigmamT)*(Rmarket-muT);

        Pc = ((1/(sigmamomC*sqrt(2*PI)))*exp(-(epsilonmomC*epsilonmomC)/2)) * ((1/(sigmamC*sqrt(2*PI)))*exp(-(epsilonmC*epsilonmC)/2));
        Pt = ((1/(sigmamomT*sqrt(2*PI)))*exp(-(epsilonmomT*epsilonmomT)/2)) * ((1/(sigmamT*sqrt(2*PI)))*exp(-(epsilonmT*epsilonmT)/2));

        PC = Pc * (probaC*probac + (1-probaC)*(probat));
        PT = Pt * ((1-probaT)*(probac) + probaT*probat);

        loglik -=log(PC+PT);

        probac = PC / (PC+PT);
        probat = PT / (PC+PT);

    }
    return loglik;
} 
```

主要的：

```
int main (void) {
    /* Initialise data and model parameters */
    //these are 2 vectors of return from txt files that i can give you
    vector<double> Benchmark;
    vector<double> Momentum;

    //these are the 2 fonctions i'm using to get the return for the txt files
    Benchmark = readBenchmark();
    Momentum = readMomentum();

    int i, n=Benchmark.size(), nparas=14;
    double initial_p[14] = {0.0204,0.41,-0.52,0.0432 , 0.0098 , 0.0362 , 0.97, 0.0402 , -0.26 , -1.28 , 0.1105 , -0.0070 , 0.0904 , 0.92};
    struct dataMom myStruct;
    myStruct.n = n;
    myStruct.Rmom = gsl_vector_alloc(myStruct.n);
    myStruct.Rm = gsl_vector_alloc(myStruct.n);

    vector<double>::iterator itbenchmark;
    vector<double>::iterator itmomentum;
    double tempmom;
    double tempm;
    itbenchmark = Benchmark.begin();
    itmomentum = Momentum.begin();

    for (i=0;i<myStruct.n;i++) {

        tempmom = *itmomentum;
        tempm = *itbenchmark;
        gsl_vector_set (myStruct.Rmom, i, tempmom);
        gsl_vector_set (myStruct.Rm, i, tempm);
        itbenchmark++;
        itmomentum++;
    }

    /* Starting point */
    gsl_vector *paras;
    paras = gsl_vector_alloc (nparas);
    for (i=0;i<nparas;i++)
    gsl_vector_set (paras, i, initial_p[i]);

    /* Initialise algorithm parameters */
    size_t iter = 0;
    int status;
    double size;

    /* Set initial STEP SIZES to 1 */
    gsl_vector *ss;
    ss = gsl_vector_alloc (nparas);
    gsl_vector_set_all (ss, 0.5);

    const gsl_multimin_fminimizer_type *T = gsl_multimin_fminimizer_nmsimplex;
    gsl_multimin_fminimizer *s = NULL;
    gsl_multimin_function minex_func;

    /* Initialize method and iterate */
    minex_func.n = nparas;
    minex_func.f = my_f;
    minex_func.params = &myStruct;
    s = gsl_multimin_fminimizer_alloc (T, nparas); 
```

直到这里没有问题，但下一行会生成此错误：

```
gsl：simplex.c：288：错误：遇到非有限函数值

调用默认 GSL 错误处理程序。

中止（核心转储）

```

```
 gsl_multimin_fminimizer_set (s, &minex_func, paras, ss);

    do {
        iter++;
        status = gsl_multimin_fminimizer_iterate(s);

        if (status)
            break;

        size = gsl_multimin_fminimizer_size (s);
        status = gsl_multimin_test_size (size, 1);

        if (status == GSL_SUCCESS)
            printf ("converged to minimum at\n");

        for (int z = 0 ; z<14 ; z++)
        {
            cout <<gsl_vector_get (s->x, z)<<endl;
        }
    }

    while (status == GSL_CONTINUE && iter < 10000);

    gsl_multimin_fminimizer_free (s);
    gsl_vector_free(myStruct.Rmom);
    gsl_vector_free(myStruct.Rm);
    gsl_vector_free(paras);
    gsl_vector_free(ss);

    return status;
} 
```

# wpf - 为 WPF 应用程序创建用户

> ID：14522565
> 
> 赞同：0
> 
> 时间：2013-01-25T13:16:08.767
> 
> 标签：wpf, visual-studio-2010, wpf-controls

我正在创建一个我希望不同用户使用它的应用程序。我想插入一个变量，只能在开发模式下修改。我认为也许应该有一种使用`App.Settings`WPF 应用程序的方法，但是，经过一个小时的谷歌搜索，我还没有一个明确的想法。

所以，我需要：

*   使 WPF 应用程序在管理或客户端范围内运行的变量
*   如果我在特定角色中有该变量，我想禁用一些控件

关于在哪里寻找解决方案的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T14:37:32.413

好吧，您可以添加到`ViewModels`包含反映模式的值的属性的基类中。作为下一步，您可以将`IsEnabled`具有此行为的控件的属性绑定到其相关`ViewModel`.

由于您也不想提供具有不同状态的不同模式，因此这似乎是最好的方法。

# internet-explorer - Video.js 和 Internet Explorer - 视频未播放且屏幕完全空白

> ID：14522569
> 
> 赞同：1
> 
> 时间：2013-01-25T13:16:18.747
> 
> 标签：internet-explorer, html5-video, video.js

我正在使用 video.js 在网站上播放视频。

在 Firefox、Chrome、Safari 中一切正常，但在 Internet Explorer 中不行。我只是在屏幕上看到一个黑色矩形，没有海报图像，没有视频控件，也没有视频。

我提供三种不同格式的视频：mp4、webm 和 ogv

你可以在这里看到这个 - [http://demo.clarkedesign.co.uk/video-js/](http://demo.clarkedesign.co.uk/video-js/)

请任何人帮助显示海报图像并让视频控件显示并在 IE 中播放视频？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T13:38:59.403

刚刚使用 Internet Explorer 7-9 检查了您的演示。对我来说，它在所有这些版本的 IE 中都可以正常工作。显示海报图像以及视频控件和视频本身。

您确定您没有在安全设置中禁用 Javascript 吗？

# c - 不同的电脑不同的输出

> ID：14522572
> 
> 赞同：2
> 
> 时间：2013-01-25T13:16:33.967
> 
> 标签：c, arrays, dev-c++

我在我的 WxDev C++ 上编译了这段代码。从理论上讲，它应该输出用户的答案和正确答案。它确实如此，除了 coranswers 数组的数组编号 0 外，只显示一个空格。我尝试在其他 PC 上编译它，但问题不存在。我尝试重新安装 WxDev，甚至用代码块替换它。好像问题出在我的电脑上。我该怎么办？

```
#include<stdio.h>
int main(){
char coranswers[20] = {'A', 'B', 'C', 'D', 'E', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A'};
char answers[20];
int count;
int grade = 0;

for(count = 0; count < 20; count++){
          printf("No.%d ", count+1);
          scanf("%s", &answers[count]);
          }
for(count = 0; count < 20; count++){
          printf("No.%d ", count+1);
          printf("Your answers : %c\n", answers[count]);
          if(answers[count] == coranswers[count]){
                            grade++;
                            }
          else{
               printf("Wrong answer, correct answer is %c\n", coranswers[count]);
          }
          }
          return 0;
          } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-25T13:19:32.053

您不想将字符串读入 char 数组

```
scanf("%s", &answers[count]); // the format string should be "%c" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T13:24:27.200

你没有得到一个角色。

将 scanf 中的格式说明符从**%s**更改为**%c**

```
scanf("%c", &answers[count]) 
```

对于不同系统之间的输出差异，这可能是一个原因。

```
scanf("%s", &answers[count]) 
```

由于`answers`是一个**char**数组，所以当你得到一个字符串时不需要**& 。**你可能正在腐败`&answers`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-25T13:27:42.343

通常我`%s`只用于偶数字符，但有点不同->

```
char temp[8];

scanf("%s", temp);
answers[count] = temp[0]; 
```

# php - CakePHP 控制器单元测试的发布数据

> ID：14522574
> 
> 赞同：1
> 
> 时间：2013-01-25T13:16:41.157
> 
> 标签：php, unit-testing, cakephp-2.0

我正在为我的一种控制器方法编写单元测试，它需要一些后置参数。因此，我尝试将它与像这样调用 testAction 一起传递：

```
$post_data = array("param1" => "value1", "param2" => "value2");
$this->testAction("/path/to/action", 
                  array('data' => $post_data, 'method' => 'post')); 
```

但是这些值在我的控制器方法中不可用。任何想法如何做到这一点？

# jsf - 如何在primefaces的过滤器中显示水印？

> ID：14522576
> 
> 赞同：0
> 
> 时间：2013-01-25T13:17:02.660
> 
> 标签：jsf, user-interface, jsf-2, primefaces, watermark

我有列过滤器。

在这里我想在过滤器中显示水印（如图红圈所示）

我正在使用素面 3.4

我试过这个

```
<h:form id="parametersListForm" prependId="false">      
    <p:dataTable id="parameteresList" value="#{parameterController.lstParameter}" 
                     var="parameters" selectionMode="single"  
                     selection="#{parameterController.selectedParameter}" 
                     styleClass="tnt-main-table"> 

            <p:ajax event="rowSelect" update=":parameterDetailsForm"
                    listener="#{parameterController.onParametersRowSelect}" />

      <p:column id="colomnRefType" filterBy="#{parameters.beRefType}" 
                 headerText="#{msgs['parameters.beRefType.label']}"
                 filterMatchMode="contains">
                                <h:outputText value="#{parameters.beRefType}"/>
            <p:watermark value="Ref Type" 
                         forElement= ":parameteresList:colomnRefType_filter">
             </p:watermark>
        </p:column>
      </p:dataTable>              
    </h:form> 
```

![在此处输入图像描述](../Images/2d9130e4461a453c3691a090b4a4c07a.png)

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T14:35:14.000

有一个属性`forElement`。应包含 html 输入组件的 jquery 选择器的`p:watermark`规范状态。`forElement`但是根据[这里](http://code.google.com/p/primefaces/issues/detail?id=4213)和[这里](http://forum.primefaces.org/viewtopic.php?f=3&t=22650)的这些线程，`forElement`严格来说应该只是`client ID`html 输入组件的。

因此，您可以执行以下操作：

```
<p:dataTable id="battingStyleTable" ... ... ..>

    <p:column id="myColumn"
        filterBy="#{battingStyle.battingStyleString}" 
        filterMatchMode="contains">

        <f:facet name="header">Name</f:facet>
        <h:outputText value="#{battingStyle.battingStyleString}" />

        <p:watermark value="Watermark text"
            forElement='battingStyleTable:myColumn_filter'></p:watermark>
        <!-- Please note that the prependId of my form is false, and id of the datatable is battingStyleTable and id of the column is myColumn. Thats why the id of the textfield of the filter will be battingStyleTable:myColumn_filter. Please change it accordingly. If you can't do prependId="false" to your form then you must include form id in the start also, like myFormId:myDatatableId:myColumnId_filter -->
    </p:column>
    ...............
    ..........
    ................
</p:dataTable> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T09:30:30.577

终于得到解决方案。

```
<h:form id="parametersListForm">      

    <p:dataTable id="parameteresList" value="#{parameterController.lstParameter}"
                 var="parameters" styleClass="tnt-main-table"> 

    <p:column id="columnRefType" filterBy="#{parameters.beRefType}" >
        <h:outputText value="#{parameters.beRefType}" />
        <p:watermark forElement="parametersListForm:parameteresList:columnRefType:filter"
                     value="#{msgs['parameters.beRefType.label']}"/>  
        </p:column>
     </p:dataTable>              
</h:form> 
```

希望它对某人有所帮助:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-02-19T16:15:53.700

尝试使用此语法来处理过滤器字段。使用 Primefaces 6.1 为我工作。

```
<h:form id="f_myForm">
  <p:dataTable id="dt_myTable">
    <p:column id="col_myCol>
      <h:outputText id="ot_myText" />
      <p:watermark for="@(#f_myForm\\:dt_myTable\\:col_myCol\\:filter)" value="MyPlaceholder" />
    </p:column>
  </p:dataTable>
</h:form> 
```

# javascript - 在 d3.js 的 x 轴上以不同格式打印日期

> ID：14522577
> 
> 赞同：2
> 
> 时间：2013-01-25T13:17:13.560
> 
> 标签：javascript, d3.js

我正在使用 D3.js 来构建这个折线图。它工作正常。但我无法以缩写形式在 x 轴上打印月份（jan，feb ....）

这里我是如何解析日期的。

```
var parseDate = d3.time.format("%m-%Y").parse; 
```

x轴的代码

```
var xAxis = d3.svg.axis().scale(x).orient("bottom"); 
```

以及打印和附加

```
svg.append("g")
  .attr("class", "x axis")
  .attr("transform", "translate(0," + height + ")")
  .call(xAxis); 
```

帮我解决这个问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-11-20T17:33:58.607

只需在内部使用带有 d3.time.format 的 tickFormat

```
var xAxis = d3.svg.axis().scale(x).orient("bottom").tickFormat(d3.time.format("%H")) 
```

# java - IBM WAS 中的 DataStoreAdapterException 连接到 SQL 服务器数据库

> ID：14522579
> 
> 赞同：2
> 
> 时间：2013-01-25T13:17:28.327
> 
> 标签：java, sql-server-2008

我无法从 IBM WAS6 连接 Sql server db。它抛出异常，我已经在类路径中添加了 sqljdbc4.jar。

com.ibm.ws.rsadapter.exceptions.DataStoreAdapterException: DSRA8050W: 找不到指定的 DataStoreHelper 类：com.ibm.websphere.rsadapter.MicrosoftSQLServerDataStoreHelper

不确定它是否需要任何新的 JAR 文件？你能帮我解决这个问题吗？

# symfony - 了解 Symfony2 导入链中的优先级

> ID：14522583
> 
> 赞同：2
> 
> 时间：2013-01-25T13:17:42.437
> 
> 标签：symfony

假设您有以下三个 symfony2 配置文件（非常简化），其中 AppKernel 作为当前环境加载的文件是第一个，app/config/config_env.yml：

应用程序/config/config_env.yml：

```
imports:
    - { resource: config2.yml }
    - { resource: config3.yml }
parameters:
    param: one 
```

应用程序/config/config2.yml：

```
imports:
    - { resource: config4.yml }
parameters:
    param: two 
```

应用程序/config/config3.yml：

```
imports:
    - { resource: config5.yml }
parameters:
    param: three 
```

应用程序/config/config4.yml：

```
parameters:
    param: four 
```

应用程序/config/config5.yml：

```
parameters:
    param: five 
```

每当我从代码中引用 param 时，您能帮我理解与 param 相关的值是什么（一、二、三、四或五），为什么？或者，换句话说，关于导入的 Symfony2 优先规则是什么？

谢谢，

罗德里戈

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-15T17:51:35.050

让我们想想 symfony 在做什么。

首先，它加载 config_env.yml。

```
imports:
    - { resource: config2.yml }
    - { resource: config3.yml }
parameters:
    param: one 
```

下一步：加载导入。

```
imports:
    - { resource: config4.yml }
parameters:
    param: two
imports:
    - { resource: config5.yml }
parameters:
    param: three
parameters:
    param: one 
```

下一步：将它们结合起来

```
imports:
    - { resource: config4.yml }
    - { resource: config5.yml }
parameters:
    param: two
    param: three
    param: one 
```

下一步：加载导入

```
parameters:
    param: four
parameters:
    param: five
parameters:
    param: two
    param: three
    param: one 
```

下一步：将它们结合起来

```
parameters:
    param: four
    param: five
    param: two
    param: three
    param: one 
```

现在重要的是要知道 symfony 会覆盖设置参数。那么答案是什么？最后参数是一。尝试一下。

# java - 如何使用谷歌云中的文件服务将文件存储为 blob 值

> ID：14522585
> 
> 赞同：1
> 
> 时间：2013-01-25T13:17:49.833
> 
> 标签：java, google-app-engine, google-cloud-storage

借助 Google 文档[将文件写入 blob 存储](https://developers.google.com/appengine/docs/java/blobstore/overview#Writing_Files_to_the_Blobstore)

我可以通过以下方式将文件存储在 Google Cloud 中，

```
 //My servlet Class
  private StorageService storage = new StorageService();
  FileService fileService = FileServiceFactory.getFileService();
  AppEngineFile file = fileService.createNewBlobFile(mime, fileName);
  boolean lock = true;
  FileWriteChannel writeChannel = fileService.openWriteChannel(file, lock);
  byte[] b1 = new byte[BUFFER_SIZE];
  int readBytes1;
  storage.init(fileName, mime); // Calling my Java Class Here
  while ((readBytes1 = is1.read(b1)) != -1) {
  writeChannel.write(ByteBuffer.wrap(b1, 0, readBytes1));
  storage.storeFile(b1, readBytes1);}
  writeChannel.closeFinally(); 
```

我有一个存储 java 类来将数据存储在下面的谷歌云中，

```
//My Storage Class 
  public class StorageService {
  public static final String BUCKET_NAME = "MyBucket";  
  public void init(String fileName, String mime) throws Exception {
  GSFileOptionsBuilder builder = new GSFileOptionsBuilder().setAcl("public_read").setBucket(BUCKET_NAME).setKey(fileName).setMimeType(mime); 
  AppEngineFile writableFile = fileService.createNewGSFile(builder.build());
boolean lock = true;
writeChannel = fileService.openWriteChannel(writableFile, lock);
bos = new BufferedOutputStream(Channels.newOutputStream(writeChannel));
public void storeFile(byte[] b, int readSize) throws Exception { 
 bos.write(b,0,readSize);
bos.flush();
}} 
```

从上面的参考资料中，我可以将文件直接存储在谷歌云中。但我需要使用文件服务将这些文件存储为 blob 值。

任何人都可以建议我一个想法。

您的帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T15:14:24.803

您是否将 appengine 服务帐户添加到 Google API 控制台项目中？如果您还没有完成，您应该准备 Google API 控制台项目。

1.  在 GAE 管理控制台的“应用程序设置”选项卡上确认您的 appengine 服务帐户
2.  [在Google API 控制台](https://code.google.com/apis/console/)上创建新项目。或为您现有的存储桶打开 API 控制台项目。
3.  在“服务”选项卡中启用“谷歌云存储”。
4.  在 API 控制台“团队”选项卡上将 appengine 服务帐户添加为团队。

# java - Java中类似于XNA的更新方法

> ID：14522586
> 
> 赞同：1
> 
> 时间：2013-01-25T13:17:52.363
> 
> 标签：java, timer

我目前正在制作一个需要我在屏幕上显示实时计时器的 Java 应用程序。我已成功创建计时器，并在按下按钮时更新。但是我希望它不断更新自己。

是否可以制作类似于 XNA 中使用的更新方法？我希望它每秒调用自己多次。

干杯。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T13:20:43.687

如果这是在 Swing 应用程序的上下文中，您应该使用 Swing Timer：

[http://docs.oracle.com/javase/6/docs/api/javax/swing/Timer.html](http://docs.oracle.com/javase/6/docs/api/javax/swing/Timer.html)

这是一个教程：

[http://docs.oracle.com/javase/tutorial/uiswing/misc/timer.html](http://docs.oracle.com/javase/tutorial/uiswing/misc/timer.html)

# css - css clear:both 和 width 100%？

> ID：14522587
> 
> 赞同：2
> 
> 时间：2013-01-25T13:17:54.623
> 
> 标签：css, css-float

我不完全确定我从哪里得到这个，但作为一个习惯规则，如果我在一些浮动元素之后有一个清晰的 div，我会执行以下操作。

```
<div class='clear'></div> 
```

然后在css中

```
.clear{ clear:both; width 100% } 
```

在大多数情况下，这让我作为一名开发人员经历了多年，直到今天。

今天我发现 100% 宽度位打破了 IE7 中的布局，删除了固定它的宽度。

我的问题很简单：**是否有任何理由为什么需要在清晰的 div 上设置宽度？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-25T13:39:17.540

在不需要额外 HTML 元素的浮动元素之后，有一种更好的清除方法。通常，您希望 HTML 尽可能直观和语义化，并将所有设计和视觉辅助工具留给 CSS。

如果我有以下 HTML：

```
<div class="container">
    <div class="floated-left"></div>
    <div class="floated-right">
</div></div>
<div class="some-non-floating-content"></div> 
```

CSS：

```
overflow approach:
.container {
    overflow: auto;
    width: 100%;
}
:after approach:
.container:after {
    content: '';
    display: block;
    height: 0;
    clear: both; 
} 
```

您可以在此处阅读有关这些语义化方法的更多信息：http: [//css-tricks.com/all-about-floats/](http://css-tricks.com/all-about-floats/)和此处[http://www.positioniseverything.net/easyclearing.htmls](http://www.positioniseverything.net/easyclearing.htmls)

为了回答您关于宽度的具体问题，我只知道在应用溢出以确保容器不会崩溃时需要它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T13:22:04.203

我总是使用`clear: both`或只使用左/右以避免 IE 上的额外空格（[示例](https://stackoverflow.com/questions/473143/extra-vertical-space-in-ie-after-div-clear)）。

所以，如果总是对我有用，在所有浏览器中，AFAIK 没有一般的原因`width: 100%`。

# windows - 拆卸卸载模块

> ID：14522596
> 
> 赞同：3
> 
> 时间：2013-01-25T13:18:26.273
> 
> 标签：windows, debugging, windbg

得到一个以卸载模块结束的堆栈跟踪。为了确保堆栈有意义，我想反汇编卸载的模块（另外检查是否可以在给定地址上开始调用（访问冲突：尝试从无效地址读取））。我可以加载模块（windbg）：

```
.reload Unloaded.Dll=base,size 
```

但是在重新加载之后，我无法反汇编代码。有没有办法做到这一点？提前感谢您的帮助！G更多

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-29T16:28:59.010

Marc Sherman 的提示（参见上面的评论）：使用 windbg，您可以将 dll 作为故障转储加载。加载后键入“lm”命令并在相对于给定基数的所需地址上反汇编。

# c - 以指数方式更新和打印一个数字

> ID：14522597
> 
> 赞同：1
> 
> 时间：2013-01-25T13:18:26.787
> 
> 标签：c, algorithm

我的问题是找到一种方法来减少 updateAccelerometer 调用的数量。

```
int count = 0;
int accelerometer = updateAccelerometer();
while (accelerometer <= 500) {
  printf("Actual: %lf", accelerometer);
  accelerometer = updateAccelerometer();
  count++;
} 
```

这使：

```
Actual: 9
Actual: 28
Actual: 47
Actual: 65
Actual: 84
Actual: 103
Actual: 122
Actual: 141
Actual: 159
Actual: 178
Actual: 197
Actual: 216
Actual: 235
Actual: 253
Actual: 272
Actual: 291
Actual: 310
Actual: 329
Actual: 347
Actual: 366
Actual: 385
Actual: 404
Actual: 423
Actual: 442
Actual: 460
Actual: 479
Actual: 498 
```

现在我的问题是**我不想每次都更新加速度计**，而是以指数比例比率，例如。如果我引入“线性比例比”

我只会做：

```
if (count % 2 = 0) accelerometer = updateAccelerometer(); 
```

这意味着，将读取一个值，不会读取一个值，等等等等，因为每次我调用 updateAccelerometer 可能需要时间，我想在我远离时取更少的值，当我靠近时取更多的值。

所以这个想法是有一个指数函数，它只返回标有 x 的那些，**不是因为我不打印其他的，而是因为我不更新加速度计**

```
Actual: 9
Actual: 28
Actual: 47
Actual: 65
Actual: 84
Actual: 103x
Actual: 122
Actual: 141
Actual: 159
Actual: 178
Actual: 197
Actual: 216
Actual: 235x
Actual: 253
Actual: 272
Actual: 291
Actual: 310
Actual: 329x
Actual: 347
Actual: 366
Actual: 385
Actual: 404x
Actual: 423
Actual: 442
Actual: 460x
Actual: 479
Actual: 498x 
```

这不是一个非常具体的问题，因为在许多其他情况下我遇到了指数级跳过更新的问题，有什么问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-25T13:36:11.047

看起来在您下一次采样加速器之前的计数应该约为`sqrt(fabs(500 - accelerometer)) / 3.25`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T13:29:00.543

有很多方法可以做到！设置应打印数据时的预定义迭代索引，某种数学函数来确定它。

然而，我会选择这样的东西：

```
int count = 0;
int timeToPrint = 5;
int timeSincePrinted = 0;
int minPrintSpan = 2;
int accelerometer = updateAccelerometer();
while (accelerometer <= 500) {
  timeSincePrinted++;
  if (timeToPrint == timeSincePrinted && timeSincePrinted >= minPrintSpan) {
    printf("Actual: %lf and %d", accelerometer, count);
    timeSincePrinted=0;
    timeToPrint--;
  }
  accelerometer = updateAccelerometer();
  count++;
} 
```

那就是你有一个相当简单、低复杂性和易于调整的功能。希望这可以帮助。

# c# - Windows Forms dataGridView - 如何在点击事件上设置行启用

> ID：14522609
> 
> 赞同：0
> 
> 时间：2013-01-25T13:18:57.383
> 
> 标签：c#, winforms, visual-studio-2010

我正在使用 Visual Studio 2010，我正在制作一个表单，`DataGridView`但我没有选中所有`Enables`的列和行，并且我添加了一个按钮`Add New`，其想法是在单击时添加一个新行。但我无法弄清楚如何做到这一点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T13:35:40.847

我认为最简单的方法是使用您需要的结构创建一个 DataTable。将数据集添加到您的项目（项目 -> 添加新项目 -> 数据集（在数据部分内））。在那里，您可以创建具有所需结构的 DataTable（右键单击 -> 添加 -> DataTable）。然后您可以将以下代码绑定到您使用的按钮： `MyDataSet dsMyDataSet = new MyDataSet() dsMyDataSet.MyDataTable[0] = value; // repeat this line for each column, or place it into a loop to do it for you` 然后您使用此行显示您的数据： `dataGridView1.DataSource = dsMyDataSet.MyDataTable;`

这应该可以解决您的问题。

# reporting-services - Reporting Services 权限管理

> ID：14522613
> 
> 赞同：1
> 
> 时间：2013-01-25T13:19:12.780
> 
> 标签：reporting-services, reporting

我有一个下拉列表，它列出了所有员工的姓名。当员工选择他/她的名字时，报告会显示有关所选人员的所有信息。但是，我想应用这样的东西；

-例如，我将授予部门主管的完全访问权限。这意味着当他们点击下拉列表时，他们将能够看到所有员工名单。其他未访问的员工只会在该下拉列表中看到他们的姓名。

我该如何管理？

```
 Employee_Info_View
      ----------------
        NAME             ID
       Employee_A        1
       Employee_B        2
       Employee_C        3
       Employee_D        4
       Employee_E        5 
```

例如，我只允许 Employee_A 查看他的每月绩效报告。当他打开报告时，他必须在姓名下拉列表中看到他的姓名。此外，如果我向 Employee_B 授予完全权限，那么他必须看到该下拉列表中的所有名称。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T07:57:03.060

报告服务可以获取当前用户 ID。这可以自动链接到您的员工表以显示那里的信息。在您的表达式中使用以下内容：

```
=User!UserID 
```

此外，使用它您可以查看运行报告的用户是否是其他员工的经理，并显示这些员工。

**首选此方法，因为用户不需要选择增加报告安全性的名称。**

**编辑：**

我希望员工表具有用户 ID、员工和经理。然后是一个查询，例如：

```
select *
from   employee e, employee m
Where  (e.userid = @userid or m.userid = @userid)
       And e.manager = m.employee 
```

如果不是这种情况，那么您应该设置一个链接两个人的表并创建一个类似的查询。然后这将再次自动运行并提高安全性。

那么`@userid`参数将是`=User!UserID`.

# jquery - jquery 内容隐藏/显示面板

> ID：14522614
> 
> 赞同：1
> 
> 时间：2013-01-25T13:19:16.070
> 
> 标签：jquery

我自己没有编写此代码，但一所大学要求我帮助解决问题。我对谷歌没有太多关注，所以我想在这里试一试。

```
function($) {
 var accordion = $('dl > dd').hide().slice(0, 1).show();

 $('dl > dt > a').click(function() {
 accordion.slideUp();
 if($(this).parent().next().is(':hidden'))
 { 
   $(this).parent().next().slideDown();
 }
 return false;
});
})(jQuery); 
```

此代码应该打开和关闭页面上的面板。

如果我们改变这一行

```
 var accordion = $('dl > dd').hide().slice(0, 1).show(); 
```

到这条线

```
 var accordion = $('dl > dd').hide(); 
```

一切正常，但我们希望第一个面板在页面加载时显示。

使用打开面板时的代码，打开的面板不会关闭。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T14:21:38.467

这将是我对手风琴的实现。

CSS

```
<style type="text/css">
    dd {
        display: none;
    }
</style> 
```

HTML

```
<dl>
    <dt><a href="#">Slide1</a></dt>
    <dd>
    Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud
    exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla
    pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
    </dd>
    <dt><a href="#">Slide2</a></dt>
    <dd>
    Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud
    exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla
    pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
    </dd>
    <dt><a href="#">Slide3</a></dt>
    <dd>
    Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud
    exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla
    pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
    </dd>
</dl> 
```

jQuery

```
(function ($)
    {
        var accordionTitle = $('dl > dt > a'),
            accordionSlide = $('dl > dd');

        accordionTitle
            .first()
            .addClass('active')
            .parent()
            .next()
            .slideDown();

        accordionTitle.click(function (e)
        {
            e.preventDefault();

            if (!$(this).hasClass('active'))
            {
                accordionSlide.slideUp();

                $(this).parent().next().stop().slideToggle();

                accordionTitle.removeClass('active');
                $(this).addClass('active');
            }
        });
    })(jQuery); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-25T13:24:20.033

这与过滤和隐藏/显示后存储在手风琴变量中的内容有关。您想要实现的目标实际上可以在不调用 .show 的情况下实现

```
var accordion = $('dl > dd');
accordion.not(':first').hide(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-25T13:24:32.280

问题是您正在使用`slice`方法过滤元素，最后手风琴是一个 jQuery 对象，它只有 1 个选定元素，而不是所有*手风琴*元素，您可以使用`end`方法：

```
var accordion = $('dl > dd').hide().first().show().end(); 
```

或者：

```
var accordion = $('dl > dd').hide(); 
accordion.first().show(); 
```

# android - 发送电子邮件时包含附件

> ID：14522619
> 
> 赞同：1
> 
> 时间：2013-01-25T13:19:52.613
> 
> 标签：android, android-intent, email-attachments

我的应用程序正在发送带有附件的电子邮件，但问题是它发送电子邮件但没有附件。该文件确实存在于 SD 卡中，我可以将其分离并查看该文件。

这是代码**Email.java**

```
Intent i = new Intent(Intent.ACTION_SEND);
i.setType("text/plain");
i.putExtra(Intent.EXTRA_EMAIL, new String[] { "" });
i.putExtra(Intent.EXTRA_SUBJECT, "");
i.putExtra(Intent.EXTRA_STREAM,Uri.parse("file://mnt/sdcard/fun/itisfun.csv"));    
i.putExtra(Intent.EXTRA_TEXT, "");
i.setType("message/rfc822");
startActivity(Intent.createChooser(i,"gmail :")); 
```

这是我在**Menifest中尝试过的权限**

```
<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" />
<permission  android:name="android.permission.INTERNET"></permission> 
```

我会感谢你的帮助。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-25T13:25:40.067

尝试如下：

> ```
>  File pngDir = new File(Environment.getExternalStorageDirectory(),"fun/"); 
>             if (!pngDir.exists())
>             {
>                 pngDir.mkdirs();
>             }              
>             File pngfile=new File(pngDir,"itisfun.csv");
>             Uri pngUri =Uri.fromFile(pngfile);
>             Intent emailIntent = new Intent(android.content.Intent.ACTION_SEND);
>             emailIntent.setType("text/plain");
>             emailIntent.putExtra(android.content.Intent.EXTRA_EMAIL,new String[]{""});
>             emailIntent.putExtra(android.content.Intent.EXTRA_SUBJECT, "");
>             emailIntent.putExtra(android.content.Intent.EXTRA_TEXT, "");
>             emailIntent.putExtra(android.content.Intent.EXTRA_STREAM,pngUri);
>             emailIntent.setType("message/rfc822");
>             startActivity(Intent.createChooser(emailIntent, "Send mail...")); 
> ```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T13:25:04.170

这是我用来将文件附加到电子邮件（Gmail 应用程序）的代码：

```
final Intent emailIntent = new Intent(android.content.Intent.ACTION_SEND_MULTIPLE);
        emailIntent.setType("message/rfc822");
        emailIntent.putExtra(android.content.Intent.EXTRA_EMAIL, 
            new String[]{emailTo});
        //has to be an ArrayList
        ArrayList<Uri> uris = new ArrayList<Uri>();
        //convert from paths to Android friendly Parcelable Uri's
        for (String file : filePaths)
        {
            File fileIn = new File(file);
            Uri u = Uri.fromFile(fileIn);
            uris.add(u);
        }
        emailIntent.putExtra(android.content.Intent.EXTRA_TEXT, emailText);
        emailIntent.putExtra(android.content.Intent.EXTRA_SUBJECT,subject);
        emailIntent.putParcelableArrayListExtra(Intent.EXTRA_STREAM, uris);
        context.startActivity(Intent.createChooser(emailIntent, "Send mail via")); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-25T13:26:21.643

试试这个代码：

```
Intent emailIntent = new Intent(android.content.Intent.ACTION_SEND);
// emailIntent.putExtra(android.content.Intent.EXTRA_TEXT, emailSignature);
emailIntent.putExtra(android.content.Intent.EXTRA_EMAIL, toSenders);
emailIntent.putExtra(android.content.Intent.EXTRA_SUBJECT, subjectText);
emailIntent.putExtra(android.content.Intent.EXTRA_TEXT, messageText+"\n\n"+emailSignature); 

emailIntent.setType("image/jpeg");
File bitmapFile = new File(Environment.getExternalStorageDirectory()+
        "/"+FOLDER_NAME+"/picture.jpg");
myUri = Uri.fromFile(bitmapFile);
emailIntent.putExtra(Intent.EXTRA_STREAM, myUri);
startActivity(Intent.createChooser(emailIntent, "Send your email in:")); 
```

希望它会帮助你。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-25T13:27:30.467

试试下面的代码

```
 Intent i = new Intent(Intent.ACTION_SEND);
                i.setType("text/plain");
                i.putExtra(Intent.EXTRA_EMAIL, new String[] { "" });
                i.putExtra(Intent.EXTRA_SUBJECT, "");
                i.putExtra(Intent.EXTRA_STREAM,Uri.parse("file://sdcard/fun/itisfun.csv"));    
                i.putExtra(Intent.EXTRA_TEXT, "");
                i.setType("message/rfc822");
                startActivity(Intent.createChooser(i,"gmail :")); 
```

# eclipse - STS 中复合组件属性的自动完成

> ID：14522621
> 
> 赞同：0
> 
> 时间：2013-01-25T13:19:59.707
> 
> 标签：eclipse, jsf, composite-component, code-completion, spring-tool-suite

我在 STS 3.1.0 的 JSF 项目中创建了一些复合组件。当我在这样的视图中声明它们时：

```
xmlns:asw="http://java.sun.com/jsf/composite/asw-tags 
```

然后一切正常，但是对于在复合组件上定义的属性，我没有任何代码完成。如何在 STS 中启用代码完成？

# android - 启动 Google Maps Native Application Android phonegap

> ID：14522628
> 
> 赞同：1
> 
> 时间：2013-01-25T13:20:38.643
> 
> 标签：android, google-maps, cordova, jquery-mobile

我有一个 kml 文件，我需要从 phonegap android 应用程序显示在谷歌地图**本机应用程序中。**我可以通过文件的简单 a href 加载 kml，然后 Google Map 启动

我遇到的问题是，当用户点击手机上的后退按钮时，它会回到我的应用程序的开头，即登录页面，而不是他们从中启动 kml 文件的页面。

所以我可以看到 2 个解决方案，但在实施方面需要帮助

1.  修复返回按钮问题
2.  尝试使用网络意图执行某些操作以加载 kml 文件或显示加载标记

任何帮助都会受到极大的欢迎

谢谢，J

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T09:47:09.627

尝试将此添加到您的 AndroidManifest.xml

```
 android:launchMode="singleInstance" 
```

并取消选中开发人员选项->不保留活动

# java - 如何从剪贴板复制/粘贴样式文本？

> ID：14522630
> 
> 赞同：1
> 
> 时间：2013-01-25T13:20:42.467
> 
> 标签：java, copy-paste, jtextpane, styledtext, defaultstyleddocument

我有我`JTextPane`，我正在`DefaultStyledDocument`用作文本模型。我目前使用`JTextPane`'s 默认值`copy()`和`paste()`方法进行复制和粘贴，但如您所知，它们仅复制/粘贴纯文本。例如，我需要能够从浏览器复制样式文本，并将其粘贴到`JTextPane`保留样式中。

有谁知道我怎么能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T15:58:43.530

当剪贴板中的内容具有可以由安装的 EditorKit 处理的表示时，JTextPane 会自动识别内容并相应地处理更新 Document 的内容。

例如，如果您设置 RTFEditorKit 并粘贴从 MS Word（具有文本/rtf 风格）复制的内容，则内容将被正确处理。

# scala - this.getClass 在 Scala 特征中的用法

> ID：14522633
> 
> 赞同：5
> 
> 时间：2013-01-25T13:20:47.977
> 
> 标签：scala, traits

有人可以解释为什么这段代码以这种方式工作吗？我想制作自己的概念证明 Loggable 特征。计划是实例化一个记录器实例，以便继承的类不必做这项工作。但正如我所见，这不是我想要的。

这是代码：

```
package hu.jonas.simple

trait Loggable {
  val logger = java.util.logging.Logger.getLogger(this.getClass.getName)

  def whoAmI = {
    logger.info(this.getClass.getName)
  }
}

class Service extends Loggable {
  def answer = {
    whoAmI
  }
}

object Main extends App {
  new Service().answer
} 
```

它产生了以下日志消息：

```
Jan 25, 2013 2:02:07 PM hu.jonas.simple.Loggable$class whoAmI
INFO: hu.jonas.simple.Service 
```

为什么这两个 this.getClass.getName 不同？此外，当我实例化记录器以获得此信息时，我应该写什么：

```
Jan 25, 2013 2:02:07 PM hu.jonas.simple.Service whoAmI
INFO: hu.jonas.simple.Service 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-25T14:24:40.653

在您的代码中，两次出现都`getClass.getName`返回相同的值。但是记录器在格式化输出消息时只是使用源类（它可以通过检查堆栈知道）而不是记录器的名称（在您的情况下对应于`getClass.getName`）。所以记录器在输出日志记录的头部时，实际上是使用了调用所在的类的名称`log`，而日志消息的内容是实例的运行时类的名称。所以这就像一个*静态*与*运行时*类型的问题。如果你想知道`Loggable$class`从哪里来，碰巧在一个名为 trait 的方法实现位于一个名为`T`的 JVM 类中`T$class`。

现在来做个说明。在下面的代码中，我更改了日志处理程序，以便从源类中删除信息。这会强制记录器使用记录器名称而不是源类名称，并且您会得到预期的行为。

```
import java.util.logging._
trait Loggable {
  val logger = Logger.getLogger(this.getClass.getName)

  logger.getParent.getHandlers.foreach{ handler => 
    val formatter = handler.getFormatter
    handler.setFormatter( new java.util.logging.Formatter {
      def format( record: LogRecord ) = {
        record.setSourceClassName( null )
        formatter.format( record )
      }
    })
  }

  def whoAmI = {
    logger.info(this.getClass.getName)
  }
}

class Service extends Loggable {
  def answer = {
    whoAmI
  }
}

object Main extends App {
  new Service().answer
} 
```

现在，为了正确解决您的问题，您可以设置一个名为的属性`java.util.logging.SimpleFormatter.format`来更改默认日志格式。使用它让日志使用记录器名称而不是源类。请参阅[http://docs.oracle.com/javase/7/docs/api/index.html?java/util/logging/SimpleFormatter.html](http://docs.oracle.com/javase/7/docs/api/index.html?java/util/logging/SimpleFormatter.html)。请注意，它需要 Java 7。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T14:49:12.630

您正在查看的是调用记录器的方法，不一定是记录器的类。在你的情况下是`Loggable.whoAmI`. 实例化的类是 type `hu.jonas.simple.Service`，但是由于方法是 on `Loggable`，所以显示出来了。该信息通常通过查看堆栈跟踪来检索。

在下面的示例中，您将通过自己拉堆栈跟踪获得相同的结果：

```
trait Loggable { 
  val logger = java.util.logging.Logger.getLogger(this.getClass.getName)

  def whoAmI = {
    val stackTrace = Thread.currentThread.getStackTrace();
    logger.info("Class: %s, Method: %s".format(stackTrace(1).getClassName, 
      stackTrace(1).getMethodName))
    logger.info(this.getClass.getName)
  }
} 
```

这将产生输出：

```
Jan 25, 2013 9:39:28 AM $line99.$read$$iw$$iw$Loggable$class whoAmI
INFO: Class: $line99.$read$$iw$$iw$Loggable$class, Method: whoAmI

Jan 25, 2013 9:39:28 AM $line99.$read$$iw$$iw$Loggable$class whoAmI
INFO: $line100.$read$$iw$$iw$Service 
```

您可以看到与 Logger 显示的内容一致。如果你继续向下堆栈，你会看到你可以在调用层次结构中`stackTrace(3)`最终产生：

```
Jan 25, 2013 9:43:58 AM $line107.$read$$iw$$iw$Loggable$class whoAmI
INFO: Class: $line108.$read$$iw$$iw$Service, Method: answer 
```

我不确定如何更改它，`java.util.Logger`但正如另一个答案中所指定的那样 - 也许使用格式化程序可以获得所需的输出。否则，您可以尝试使用其他日志引擎或使用上述信息自行开发。

# spring-security - Spring security oauth 2 简单示例

> ID：14522634
> 
> 赞同：7
> 
> 时间：2013-01-25T13:20:48.617
> 
> 标签：spring-security, oauth-2.0, spring-security-oauth2

我尝试根据官方教程[**Sparklr2/Tonr2**](https://github.com/spring-projects/spring-security-oauth/tree/master/samples/oauth2)实现我自己的示例。`web.xml`一切看起来都不错，但是当我从**Tonr2**实现中删除时，弹簧安全过滤器出现异常：

> 没有为当前请求建立重定向 URI

我不明白我应该使用哪个 URL。这是我的代码，用于客户端实现：

```
<!--apply the oauth client context -->
<oauth:client id="oauth2ClientFilter" />

<!--define an oauth 2 resource for sparklr -->
<oauth:resource id="provider" type="authorization_code" client-id="client" client-secret="secret" 
    access-token-uri="http://localhost:8080/provider/oauth/token" user-authorization-uri="http://localhost:8080/provider/oauth/authorize" scope="read,write" />

<beans:bean id="clientController" class="com.aouth.client.ClientController">
    <beans:property name="trustedClientRestTemplate">
        <oauth:rest-template resource="provider" />
    </beans:property>
</beans:bean> 
```

对于提供者：

```
<http pattern="/oauth/token" create-session="stateless" authentication-manager-ref="clientAuthenticationManager" xmlns="http://www.springframework.org/schema/security">
    <intercept-url pattern="/oauth/token" access="IS_AUTHENTICATED_FULLY" />
    <anonymous enabled="false" />
    <http-basic />
</http>

<authentication-manager id="clientAuthenticationManager" xmlns="http://www.springframework.org/schema/security">
    <authentication-provider user-service-ref="clientDetailsUserService" />
</authentication-manager>

<bean id="clientDetailsUserService" class="org.springframework.security.oauth2.provider.client.ClientDetailsUserDetailsService">
    <constructor-arg ref="clientDetails" />
</bean>

<!-- The OAuth2 protected resources are separated out into their own block so we can deal with authorization and error handling 
    separately. This isn't mandatory, but it makes it easier to control the behaviour. -->
<http pattern="/secured" create-session="never" access-decision-manager-ref="accessDecisionManager" xmlns="http://www.springframework.org/schema/security">
    <anonymous enabled="false" />
    <intercept-url pattern="/secured" access="ROLE_USER,SCOPE_READ" />
    <custom-filter ref="resourceServerFilter" before="PRE_AUTH_FILTER" />
    <http-basic />
</http>

<bean id="accessDecisionManager" class="org.springframework.security.access.vote.UnanimousBased" xmlns="http://www.springframework.org/schema/beans">
    <constructor-arg>
        <list>
            <bean class="org.springframework.security.oauth2.provider.vote.ScopeVoter" />
            <bean class="org.springframework.security.access.vote.RoleVoter" />
            <bean class="org.springframework.security.access.vote.AuthenticatedVoter" />
        </list>
    </constructor-arg>
</bean>

<oauth:resource-server id="resourceServerFilter" resource-id="resource" token-services-ref="tokenServices" />

<bean id="tokenServices" class="org.springframework.security.oauth2.provider.token.DefaultTokenServices">
    <property name="tokenStore" ref="tokenStore" />
    <property name="supportRefreshToken" value="true" />
    <property name="clientDetailsService" ref="clientDetails"/>
</bean>

<bean id="tokenStore" class="org.springframework.security.oauth2.provider.token.InMemoryTokenStore" />

<http auto-config="true" xmlns="http://www.springframework.org/schema/security">
    <intercept-url pattern="/test" access="ROLE_USER" />
    <intercept-url pattern="/" access="IS_AUTHENTICATED_ANONYMOUSLY" />
</http>

<authentication-manager alias="authenticationManager" xmlns="http://www.springframework.org/schema/security">
    <authentication-provider>
        <user-service>
            <user name="pr" password="pr" authorities="ROLE_USER" />
        </user-service>
    </authentication-provider>
</authentication-manager>

<oauth:authorization-server client-details-service-ref="clientDetails" token-services-ref="tokenServices" >
    <oauth:authorization-code />
    <oauth:implicit />
    <oauth:refresh-token />
    <oauth:client-credentials />
    <oauth:password />
</oauth:authorization-server>

<oauth:client-details-service id="clientDetails">
    <oauth:client client-id="client" resource-ids="resource" authorized-grant-types="authorization_code, implicit"
        authorities="ROLE_CLIENT" scope="read,write" secret="secret" />
</oauth:client-details-service> 
```

我只是希望我的客户在没有弹簧安全的情况下工作。当我需要受保护的资源时，我只想在提供者端登录。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-25T15:57:24.443

您在此处粘贴的第二个 XML 是**oauth-provider**和**protected-resource**的 Spring XML ，在您的情况下，它们在同一个 webapp 中运行。（当然，如果您愿意，您可以将它们分开）。

客户端（第一个粘贴的 XML）是另一回事。如果我理解正确，您希望您的客户端在没有 Spring 帮助的情况下运行（成为常规 webapp，而不是 spring-security-oauth-client webapp）。

您必须了解 oAuth 的工作原理：客户端尝试访问受保护的资源；如果它没有访问令牌，它将被重定向到 oAuth-provider（显示登录页面并提供令牌）。[按照标准](https://www.rfc-editor.org/rfc/rfc6749#section-4.1.3)，访问令牌的请求必须包含“redirect-uri”参数，因此在成功登录后，oAuth 提供者知道将客户端重定向到哪里。oAuth 客户端会为您执行此操作，如果您从 web.xml 中删除“oauth 客户端”，您现在必须自己实现它。

> 感谢您的回答。但我仍然不明白 spring 安全性如何影响我的 oAuth 客户端。我可以在没有spring-security的情况下用于客户端spring-oauth（spring-mvc）吗？

当您在 XML 中编写此行时：

```
< oauth:client id="oauth2ClientFilter" /> 
```

这意味着您使用 spring-security-oauth，这是一个专用于 oauth 的包，建立在 spring-security 之上。如果您深入研究，它会在处理与客户端相关的 oAuth 内容的链中放置一个特殊过滤器 (OAuth2ClientContextFilter)。其中之一是发送带有所有参数的请求（“redirect-uri”就是其中之一）。

如果你决定不使用 spring-security-oauth，那么 - 你将不得不自己实现这个逻辑......

希望有帮助！

# c# - 是否可以在不打开 Quick book 软件的情况下从公司文件中读取数据？

> ID：14522639
> 
> 赞同：1
> 
> 时间：2013-01-25T13:21:17.287
> 
> 标签：c#, quickbooks, quickbooks-online

是否可以在不从 QB 打开公司文件的情况下获取数据。

我有以下情况：

在我的客户端系统中只有 QuickBooks 数据库文件（没有 QuickBook s/w）。是否可以从公司数据库中获取数据。

如果 QB 正在运行，我已成功获取数据。

如果客户没有 QB S/W，我该如何处理。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-28T13:55:28.053

您可以使用传统的 QBSDK 来访问您的数据。但是，第一次连接应用程序时，必须打开 QB 才能验证您的应用程序。在身份验证期间，请确保您选择在 QB 未运行时允许访问的选项。

此时，您可以访问 QB 公司文件，而无需打开 QB UI。

威廉

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-25T14:08:53.947

似乎有一个 Quickbook [SDK](https://ipp.developer.intuit.com/0085_QuickBooks_Windows_SDK/010_qb)应该可以满足您的需求。

# r - ggplot2如何获得2个y值的直方图=一个计数/两者计数的总和

> ID：14522640
> 
> 赞同：0
> 
> 时间：2013-01-25T13:21:17.103
> 
> 标签：r, ggplot2, histogram

我想我的问题很简单（即使标题不是......）但我还没有找到任何明确的答案。我想在心理物理学任务中绘制反应时间的直方图。我需要将其中两个绘制在同一个图上：一个用于正确响应，另一个用于错误响应。

我不想绘制绝对计数，而是绘制对应于：

对于正确的回答：`count(correct==1) / sum(count(correct==1) + count(correct==0))`

对于不正确的回答：`count(correct==0) / sum(count(correct==1) + count(correct==0))`

现在我有：

```
ggplot(data, aes(x=RT, color=correct)) 
    + geom_histogram(aes(y = ..count../sum(..count..))) 
    + stat_bin(breaks = seq(5,800,by=10)) 
```

但我不确定它是否在做我想要的（总和是否对应于正确和错误响应的总和？）。我对 ..count.. 等感到不舒服，有人对这方面的文档有很好的建议吗？

提前致谢。

**编辑：**输入数据是：

```
df <- structure(list(RT = c(359L, 214L, 219L, 206L, 120L, 166L, 156L, 
       181L, 135L, 122L, 110L, 101L, 139L, 215L, 106L, 217L, 162L, 135L, 
       114L, 205L), correct = c(1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 
       1L, 1L, 1L, 0L, 1L, 1L, 1L, 0L, 1L, 0L, 0L)), .Names = c("RT", 
       "correct"), class = "data.frame", row.names = c(NA, -20L)) 
```

这是我之前使用 base R 制作的图的链接，这正是我最后想要的输出。 [https://www.dropbox.com/s/nqn83pkoq7o0stv/RTexample.png](https://www.dropbox.com/s/nqn83pkoq7o0stv/RTexample.png) 这些是线条（但基于直方图，黄色表示正确==1，蓝色表示正确==0）。我想要的特定功能是两条线的总和为 1。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T15:04:17.490

如果我理解正确，`position="fill"`应该可以满足您的需求：

```
ggplot(df,aes(x=RT,fill=factor(correct,labels=c("Incorrect","Correct")))) +
 geom_bar(breaks=seq(5,800,by=10),position="fill") +
  scale_y_continuous("",labels=percent) + scale_fill_discrete("") 
```

![在此处输入图像描述](../Images/777157354e73bfc18226c477ba009290.png)

一个直方图基于（零级）在底部，另一个在顶部。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T15:16:03.613

肖拉，

布赖恩汉森是绝对正确的。您真的应该停止尝试将您的转换作为“ggplot”功能的一部分。我知道这很诱人，但“ggplot”的图中转换方法应该更多地用于数据探索，而不是创建预先确定的图表。您可以快速使用“hist”功能获取所需数据、转换数据，然后将其输入“ggplot”以进行实际绘图。手动转换数据的最佳部分是您可以看到所有数据的运行情况，并且您不会遇到问题（如您的问题）猜测答案是否正确。

您需要确切地决定如何安排这两个图，但这都可以使用“ggplot”来完成。以下是外部转换的示例：

**第 1 步**：获取 [正确]=1 的直方图值。

```
correct_Hist <- hist(data[correct==1, 1], breaks=seq(5, 800, by=10), plot=FALSE) 
```

**第 2 步**：获取 [正确]=0 的直方图值。

```
incorrect_Hist <- hist(data[correct==0, 1], breaks=seq(5, 800, by=10), plot=FALSE) 
```

**第 3 步**：转换计数。您在问题中的解释有点模棱两可，可以采取几种不同的方式。对于这个答案，我假设您不需要直方图，而是想要一个条形图，显示不正确或正确的响应代表特定范围的 RT 值的百分比。现在我们有了计数，这很简单。

```
correct_Bar_Values <- correct_Hist$counts / (correct_Hist$counts + incorrect_Hist$counts)
incorrect_Bar_Values <- incorrect_Hist$counts / (correct_Hist$counts + incorrect_Hist$counts) 
```

**第 4 步**：随心所欲地绘制它。现在您有了想要绘制的原始值，您可以使用各种方法来绘制它。我推荐 'geom_bar' 层，而不是 'geom_hist' 层，因为您已经完成了计算。您还必须指定您希望“ggplot”使用的两个不同的“网格”视口，但如果您需要帮助，请提交第二个问题。这是您可以快速将数据制作成条形图的方法：

```
# The percentage of answers that were not correct
qplot(incorrect_Hist$mids,y=incorrect_Bar_Values, geom="bar", stat="identity", ylim=c(0,1))

# The percentage of answers that were correct
qplot(correct_Hist$mids,y=correct_Bar_Values, geom="bar", stat="identity", ylim=c(0,1)) 
```

# 3d - vtkgdcmimagereader 用于体绘制

> ID：14522655
> 
> 赞同：0
> 
> 时间：2013-01-25T13:22:21.793
> 
> 标签：3d, vtk, dicom, volume-rendering, gdcm

我想阅读一系列 2D dicom 图像。然后，我将其显示为 3D 体积。为此，我按照以下步骤操作：

1- ipp 排序器 2- setfilenames 3- vtkimagechangeinformation

在这些之后，我尝试使用 vtkimageviewer2 将它们可视化。我正在发送我编写的几乎所有代码。我很确定它会加载和排序图像。但它给出了一个错误，如

> *排序成功：0.5*
> 
> *排序成功：1.5*
> 
> *程序意外结束。*

这是我的代码：

```
vtkGDCMImageReader *dicomReader =
vtkGDCMImageReader::New();

std::vector<std::string> filenames;
const char *filename = "/home/telemed/Downloads/Dentascan";

gdcm::Directory d;
d.Load( filename, false);

filenames = d.GetFilenames();

gdcm::IPPSorter s;

s.SetComputeZSpacing( true );

s.SetZSpacingTolerance( 1e-3 );

bool b = s.Sort( filenames );

if( !b )

{

    std::cerr << "Failed to sort:" << "s" << std::endl;

    return 1;

}

std::cout << "Sorting succeeded:" << s.GetZSpacing() << std::endl;

//s.Print( std::cout );

const std::vector<std::string> & sorted = s.GetFilenames();

vtkStringArray *files =vtkStringArray::New();

std::vector< std::string >::const_iterator it = sorted.begin();

for( ; it != sorted.end(); ++it)

{

    const std::string &f = *it;

    files->InsertNextValue( f.c_str() );

}

dicomReader->SetFileNames( files );

//dicomReader->Update();

vtkImageChangeInformation *changer =

vtkImageChangeInformation::New();

changer->SetInputConnection(dicomReader->GetOutputPort());

changer->SetOutputSpacing(VTK_DOUBLE_MAX,VTK_DOUBLE_MAX, 2.0);

changer->Update();

vtkInteractorStyleImage *imageStyle =vtkInteractorStyleImage::New();

vtkRenderWindowInteractor *interactor =vtkRenderWindowInteractor::New();

/ Calculate the center of the volume

dicomReader->GetOutput()->UpdateInformation();
int extent[6];

double spacing[3];

double origin[3];

dicomReader->GetOutput()->GetWholeExtent(extent);

dicomReader->GetOutput()->GetSpacing(spacing);

dicomReader->GetOutput()->GetOrigin(origin);

spacing[2] = 1.5;

vtkImageData* image = vtkImageData ::New();

image->SetSpacing(spacing);

std::cout << "Sorting succeeded:" << spacing[2] << std::endl;

double center[3];

center[0] = origin[0] + spacing[0] * 0.5 * (extent[0] + extent[1]);

center[1] = origin[1] + spacing[1] * 0.5 * (extent[2] + extent[3]);

center[2] = origin[2] + spacing[2] * 0.5 * (extent[4] + extent[5]);

// Matrices for axial, coronal, sagittal, oblique view orientations

static double axialElements[16] = {
    1, 0, 0, center[0],

    0, 1, 0, center[1],

    0, 0, 1, center[2],

    0, 0, 0, 1 };

static double coronalElements[16] = {

    1, 0, 0, center[0],

    0, 0, 1, center[1],

    0,-1, 0, center[2],

    0, 0, 0, 1 };

static double sagittalElements[16] = {

    0, 0,-1, center[0],

    1, 0, 0, center[1],

    0,-1, 0, center[2],

    0, 0, 0, 1 };

// Set the slice orientation

vtkMatrix4x4 *resliceAxes = vtkMatrix4x4::New();

resliceAxes->DeepCopy(coronalElements);

vtkImageReslice *Reslice = vtkImageReslice::New();

Reslice->SetInputConnection(changer->GetOutputPort());

Reslice->SetOutputDimensionality(3);

Reslice->SetResliceAxes(resliceAxes);

Reslice->SetInterpolationModeToLinear();

vtkImageViewer2 *viewer = vtkImageViewer2::New();

viewer->SetupInteractor(interactor);

viewer->SetSize(500,500);

viewer->SetColorWindow(1024);

viewer->SetColorLevel(800);

viewer->SetInputConnection(Reslice->GetOutputPort());

// Create a greyscale lookup table

vtkLookupTable *table = vtkLookupTable::New();

table->SetRange(0, 200); // image intensity range

table->SetValueRange(0.0, 1.0); // from black to white

table->SetSaturationRange(0.0, 0.0); // no color saturation

table->SetRampToLinear();

table->Build();

// Map the image through the lookup table

vtkImageMapToColors *color = vtkImageMapToColors::New();

color->SetLookupTable(table);

color->SetInputConnection(Reslice->GetOutputPort());

// Display the image

vtkImageActor *actor = vtkImageActor::New();

actor->SetInput(color->GetOutput());

vtkRenderer *renderer = vtkRenderer::New();

renderer->AddActor(actor);

vtkRenderWindow *window = vtkRenderWindow::New();

window->AddRenderer(renderer);

interactor->SetInteractorStyle(imageStyle);

window->SetInteractor(interactor);

window->Render();

interactor->Start(); 
```

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-06T10:08:16.310

尝试实现 VTK_gdcmorthoplanes。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T15:27:43.047

您能否尝试简化代码并确定问题出在哪里。使用分而治之的方法。注释掉代码的后半部分，重新​​编译并运行它。

# cakephp - Cakephp 检查引用者是否来自本地 url

> ID：14522661
> 
> 赞同：0
> 
> 时间：2013-01-25T13:22:47.567
> 
> 标签：cakephp, if-statement, cakephp-2.1, referer

我的 Cakephp 2.1 应用程序有点困难。

如果引用者来自外部 url，我想呈现不同的布局。可悲的是，这不起作用：

```
 if($this->referer(null, true))
     {
        $this->layout = 'lightview';
     }
     else 
     {
        $this->layout = 'default';
     } 
```

有什么想法可以解决这个问题吗？

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T13:37:54.817

你在这里遇到了一个逻辑错误：

```
$this->referer(null, true) // true as second param: only internal 
```

只会返回 lightview 布局，如果

*   有推荐人（并非总是如此）
*   内部推荐人

所以这可能不是你想要的。

你不能轻易做到这一点。有时只是没有推荐人。即使有，你可能仍然不知道这个人是否来自其他地方，只是“隐藏”了推荐人。或者然后浏览您的网站（从这里开始创建内部推荐人）。

您需要在会话中存储第一次访问时的初始结果，以便稍后检查。但即便如此，您的方法也非常不一致，而且很可能会破坏......

# c# - aspx.cs 文件没有更新？

> ID：14522663
> 
> 赞同：0
> 
> 时间：2013-01-25T13:22:52.830
> 
> 标签：c#, asp.net

我在设计器文件中添加了一些控件，但 cs 文件不接受这些控件，它说 textbox1 在当前上下文中不存在。我已经尝试过这些解决方案：1）转换为 Web 应用程序 2）重新创建文件 .aspx 和 .aspx.cs 但它没有解决我的问题？任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T13:43:37.387

当您创建一个新的 aspx 页面时，请确保您选择将代码放在单独的文件中。如果没问题，然后在创建 aspxx 文件后，从工具箱的标准选项中拖放一个文本框。然后从属性窗口检查文本框的 id。像这样使用id `textbox1.Text`。如果您使用的是 html 文本框，则制作它`runat="server"`并使用文本框的 id。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T13:36:06.063

很难分析情况....可能是因为容器（如面板）尝试这样

```
TextBox tb=(TextBox)<"container name">.FindControl("textbox1"); 
```

# .net - .NET：ApplicationSettingsBase 不可靠？

> ID：14522666
> 
> 赞同：0
> 
> 时间：2013-01-25T13:23:04.677
> 
> 标签：.net, applicationsettingsbase

在使用应用程序设置的较大应用程序中，有时某些设置不会保存。

执行以下代码时，一切正常：

```
Properties.Settings.Default.SomeSetting.X = 42;
Properties.Settings.Default.SomeSetting.Y = true;
Properties.Settings.Default.Save(); 
```

但是这段代码

```
Properties.Settings.Default.SomeSetting.X = 42;
Properties.Settings.Default.Save();
Properties.Settings.Default.SomeSetting.Y = true;
Properties.Settings.Default.Save(); 
```

`Y`确实在第一次调用时调用了 getter `Save()`，但在第二次调用时不调用`Save()`，并且写入的 XML 文件中的值`Y`不会改变。

代码当然更复杂，设置也复杂得多，语句也不是一个接一个，但基本是这样的。我试图用一个简单的程序重现这个，但没有成功（还没有？）。

顺便说一句：设置文件总是被正确写入。没有例外，处理或未处理。

我还在调查，但是我想问你：`ApplicationSettingsBase`工作可靠吗？有这方面的经验吗？

谢谢！

# javascript - 如何配置 flot 以在 y 轴上的零点绘制缺失的时间序列？

> ID：14522667
> 
> 赞同：5
> 
> 时间：2013-01-25T13:23:13.297
> 
> 标签：javascript, jquery, graph, time-series, flot

我正在使用 flot （[github 上](https://github.com/flot/flot)的 flot ）绘制具有以下时间序列数据的图形：

```
[
    [1357171200000, 1],
    [1357344000000, 1],
    [1357430400000, 2],
    [1357516800000, 2],
    [1357689600000, 3],
    [1357776000000, 1]
] 
```

如您所见，图表中有一些点显示了给定日期的销售额。我的 json 响应不包含未发生销售的日子的销售计数/数据。例如 1 月 4 日。我如何配置 flot 以在 y 轴上的零点绘制缺失的天数（因为没有销售）？正如您在图像中看到的那样，flot 确实连接了这些点，因此图中没有零点。

![图形](../Images/36316362abf79aab64c1537aab8c603b.png)

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-01-25T22:38:48.040

这是一个解决方案，它创建一个新的数组，添加缺失的天数并将它们的值设置为零：

```
/* create and return new array padding missing days*/
function newDataArray(data) {
  var startDay = data[0][0],
    newData = [data[0]];

  for (i = 1; i < data.length; i++) {
    var diff = dateDiff(data[i - 1][0], data[i][0]);
    var startDate = new Date(data[i - 1][0]);
    if (diff > 1) {
      for (j = 0; j < diff - 1; j++) {
        var fillDate = new Date(startDate).setDate(startDate.getDate() + (j + 1));
          newData.push([fillDate, 0]);
      }
    }
    newData.push(data[i]);
  }
  return newData;
}

/* helper function to find date differences*/
function dateDiff(d1, d2) {
  return Math.floor((d2 - d1) / (1000 * 60 * 60 * 24));
} 
```

要使用：

```
var data = [
  [1357171200000, 1],
  [1357344000000, 1],
  [1357430400000, 2],
  [1357516800000, 2],
  [1357689600000, 3],
  [1357776000000, 1]
];

var newData=newDataArray(data);
/* pass newData to flot*/ 
```

演示：http: [//jsfiddle.net/LK2gD/3/](http://jsfiddle.net/LK2gD/3/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-25T13:42:12.600

所以，你有每日计数。然后，您可以遍历每个条目并找到当前条目和下一个条目之间的天数，然后您只需要用 0 填充数组。

最好使用零填充数组，然后仅添加当前数组中日期的计数，这样您就不需要对日期进行任何检查。

你每天间隔

```
var millisInDay = 1000*60*60*24; 
```

这将为您提供每日间隔的数量

```
 var intervals = parseInt(((lastDateInMillis - startDateInMillis)/
                                  millisInDay) + 1); 
```

然后当你迭代你的日期数组时

```
[[1357171200000, 1], [1357344000000, 1], [1357430400000, 2], 
[1357516800000, 2], [1357689600000, 3], [1357776000000, 1]] 
```

检查哪个时间间隔是日期，并更新“时间间隔”数组中的计数 ( `counts`)

```
var interval = ((currentDateMillis - startDateInMillis) / millisInDay);
counts[interval] += currentCount; 
```

然后您可以使用`index`特定日期映射计数：

```
function getEpochStartInterval(index){
  return startDateInMillis + (index * millisInDay);
}

function getEpochEndInterval(index){
  return startDateInMillis + ((index + 1) * millisInDay);
} 
```

# python - 如何打包 scons 工具进行分发和安装

> ID：14522670
> 
> 赞同：2
> 
> 时间：2013-01-25T13:23:17.713
> 
> 标签：python, installation, package, scons

我正在以 python 包（带有`__init__.py`文件的目录）的形式编写一个用于 scons 的工具，可以通过将其复制到许多可能的`site_scons/site_tools`目录之一来使用它。

是否有标准工具或方法来打包此类工具以进行分发和安装？例如，自动安装程序可能会询问他们是要在站点范围内安装它还是只为特定用户安装它，或者只为特定项目安装它，然后找到合适的位置来安装它。我想自己编写这个安装程序不会太难，但如果已经有一些被广泛使用的东西，我宁愿坚持下去。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-30T06:32:12.843

鼓励在 scons 分发之外的工具作为**DVCS**内的 python 包分发。最好在[**SCons ToolsIndex**](http://www.scons.org/wiki/ToolsIndex)上进行描述他们还建议您在[wiki 条目](http://www.scons.org/wiki)中写一些关于构建器的信息。

这当然不是一般意义上的包，但是对于使用 scons 的开发者来说，能够找到并安装它是最简单的方式。您当然可以创建一个安装程序，为您在[正确的位置](http://www.scons.org/wiki/ToolsIndex/#Install_and_usage)克隆 repo ，但我猜大多数 scons 工具的用户都擅长将其克隆到[正确的位置](http://www.scons.org/wiki/ToolsIndex/#Install_and_usage)。

# sql - 在 PostgreSQL 8.3 中实现总订单排名

> ID：14522671
> 
> 赞同：0
> 
> 时间：2013-01-25T13:23:17.790
> 
> 标签：sql, postgresql, rank, postgresql-8.3

8.3 的问题`rank()`是在 8.4 中引入的。

考虑数字 [10,6,6,2]。
我希望获得排名等于行号的那些数字的排名：

```
rank | score
-----+------
1    | 10
2    | 6
3    | 6
4    | 2 
```

部分解决方案是自连接并计算得分更高或相等的项目。这会产生：

```
1    | 10
3    | 6
3    | 6
4    | 2 
```

但这不是我想要的。
有没有办法排名，甚至只是按分数排序，然后提取该行号？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T16:57:59.217

如果您想要一个与[窗口函数](https://www.postgresql.org/docs/current/functions-window.html)等效的**行号**，您可以在 8.3 版（或任何版本）中使用 (temporary) 即兴创作：[`row_number()`](https://www.postgresql.org/docs/current/functions-window.html)[`SEQUENCE`](https://www.postgresql.org/docs/current/sql-createsequence.html)

```
CREATE TEMP SEQUENCE foo;

SELECT nextval('foo') AS rn, *
FROM   (SELECT score FROM tbl ORDER BY score DESC) s; 
```

*db<>fiddle [here](https://dbfiddle.uk/?rdbms=postgres_13&fiddle=0e9d2c652ae12201e1ad71d13029d2cd)*
[旧[sqlfiddle](http://sqlfiddle.com/#!17/09150d/1)]

子查询是在调用 *之前*`nextval()`对行进行排序所必需的。

请注意，序列（像任何临时对象一样）...

*   仅在创建它的同一会话中可见。
*   隐藏任何其他同名的表对象。
*   在会话结束时自动删除。

要在每个查询之前重复运行同一会话中的序列：

```
SELECT setval('foo', 1, FALSE); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-25T15:38:58.697

有一种方法使用适用于 PG 8.3 的数组。在性能方面，它可能不是很有效，但如果没有很多值，它就可以了。

这个想法是对临时数组中的值进行排序，然后提取数组的边界，然后将其连接起来`generate_series`以一一提取值，数组的索引是行号。

假设表是示例查询`scores(value int)`：

```
SELECT i AS row_number,arr[i] AS score
 FROM (SELECT arr,generate_series(1,nb) AS i
   FROM (SELECT arr,array_upper(arr,1) AS nb
     FROM (SELECT array(SELECT value FROM scores ORDER BY value DESC) AS arr
     ) AS s2
   ) AS s1
 ) AS s0 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-25T14:04:12.187

你有这个表的PK吗？

只需自我加入并计算具有以下条件的项目：更高或相等的分数**和更高的 PK**。

PK 比较将打破平局并为您提供所需的结果。

升级到 9.1 后使用`row_number()`.

# visual-studio-2012 - 为 Windows 上运行的 Apache 2.4.3 HTTP Server 编译 mod_spnego

> ID：14522677
> 
> 赞同：0
> 
> 时间：2013-01-25T13:23:44.980
> 
> 标签：visual-studio-2012, apache2, windows-server-2008-r2, kerberos

有没有人设法为在 Windows 上运行的 Apache 2.4 HTTP Server 编译 mod_spnego 0.2.0？我真的很想使用 mod_auth_kerb 5.4，但从我读过的内容来看，在 Windows 上编译几乎是没有希望的。

我目前在 Windows 2008 R2 机器上运行 Apache HTTP Server 2.4.3。我正在尝试使用 Visual Studio 2012 编译 mod_spnego，我认为我快到了，但我不断收到以下错误：

```
mod_spnego.obj : error LNK2001: unresolved external symbol _ap_requires 
```

显然，`ap_requires()`Apache 2.4 不再支持该功能。

我已经用谷歌搜索了这个问题，我能找到的最佳回复如下：

> 它需要注册一个身份验证提供程序。作为一个简单的例子，比较捆绑模块 mod_authz_dbm.c 的 2.2 和 2.4 版本。

老实说，我不知道我应该如何进行。谁能指出我正确的方向？关于 mod_auth_kerb 的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-30T21:11:07.833

最后我对 mod_spnego 进行了大量修改，因为原始版本太不稳定了。它现在可以在[https://github.com/ibauersachs/mod_spnego](https://github.com/ibauersachs/mod_spnego)获得，但它仍然使用 ap_requires。

根据 2.4 发行说明，ap_requires 应替换为向 ap_register_auth_provider 注册“Require”。如果你懂一点 C，在我的修改版本中实现这一点应该比在原始版本中容易得多。

# javafx-2 - javafx 选择框事件

> ID：14522680
> 
> 赞同：12
> 
> 时间：2013-01-25T13:23:51.623
> 
> 标签：javafx-2, javafx

我在 javafx 中有一个选择框，其中包含 3 个项目，让 AB 和 C 等更改此项目的选择我想执行某些任务，那么我该如何处理这些事件？

```
 final ChoiceBox cmbx=new ChoiceBox();
    try {
        while(rs.next())
         {
            cmbx.getItems().add(rs.getString(2));

          }
         } 
        catch (SQLException e) 
           {
        // TODO Auto-generated catch block
        e.printStackTrace();
        } 
```

我将项目从数据库添加到选择框...现在我想知道如何处理 javafx 中的选择框事件

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-01-25T14:08:47.350

向 ChoiceBox 的 selectionmodel 和 selectedIndexProperty 添加一个 ChangeListener：

```
final ChoiceBox<String> box = new ChoiceBox<String>();

    box.getItems().add("1");
    box.getItems().add("2");
    box.getItems().add("3");

    box.getSelectionModel().selectedIndexProperty().addListener(new ChangeListener<Number>() {
      @Override
      public void changed(ObservableValue<? extends Number> observableValue, Number number, Number number2) {
        System.out.println(box.getItems().get((Integer) number2));
      }
    }); 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2016-02-09T02:05:48.020

Sebastian 解释得很好，如果您只对选择框中选择的实际值感兴趣并且不太关心索引，那么您可以使用 selectedItemProperty 而不是 selectedIndexProperty。

ChangeListener 也是函数式接口，当你使用 java 8 时，你可以在这里使用 lambda。我只是稍微修改了 Sebastian 的示例。newValue 是新选择的值。

```
ChoiceBox<String> box = new ChoiceBox<String>();
box.getItems().add("1");
box.getItems().add("2");
box.getItems().add("3");

box.getSelectionModel()
    .selectedItemProperty()
    .addListener( (ObservableValue<? extends String> observable, String oldValue, String newValue) -> System.out.println(newValue) ); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2021-01-14T01:50:00.797

我知道这是一个老问题，但更简单的方法是使用[`ChoiceBox.setOnAction(EventHandler)`](https://openjfx.io/javadoc/15/javafx.controls/javafx/scene/control/ChoiceBox.html#setOnAction(javafx.event.EventHandler))：

```
ChoiceBox<String> box = ...;
box.setOnAction(event -> {
    System.out.println(box.getValue());
}); 
```

或在 FXML 中：

```
<ChoiceBox fx:id="id" onAction="#controllerMethod"> 
```

# javascript - Javascript库扩展方式

> ID：14522681
> 
> 赞同：0
> 
> 时间：2013-01-25T13:23:52.407
> 
> 标签：javascript, object, extend

我正在编写自己的 JavaScript 库。我该怎么做才能以这种方式扩展我的对象？

```
_.mymethod(); 
```

这是我的代码：

```
(function (window, undefined) {
    "use strict";

    var emptyArray = [];

    function _(id) {
        return new _.fd.init(id);
    }

    _.fd = _.prototype = {
        init: function (selector) {
            this.el = document.getElementById(sel);
            return this;
        },
        replaceText: function (text) {
            this.el.innerHTML = text;
            return this;
        },
        changeTextColor: function (color) {
            this.el.style.color = color;
            return this;
        }
    };

    _.fd.init.prototype = _.fd;
    _.extend = function (target) {};
    _.extend({});

    window._ = _;
}(window)); 
```

关键是，如何扩展使用方法，如

```
_.method(); 
```

# python - 通过python执行perforce命令

> ID：14522682
> 
> 赞同：1
> 
> 时间：2013-01-25T13:23:57.863
> 
> 标签：python, perforce

我正在编写一个简单的脚本，它将通过 python 同步一个 perforce 目录但是我不能这样做。它不允许我通过脚本执行该 [perforce] 目录中的任何内容。有人可以建议我如何在该目录中运行 p4 login、p4 sync 等命令吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-01-25T06:40:13.947

[perforce](http://www.perforce.com/perforce/doc.current/manuals/p4script/03_python.html)有一个官方支持的python API 。

您应该使用它而不是`subprocess`因为它允许您将 p4 连接视为对象并使用 API 操作它，而不是手动解析 p4 命令的输出。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-25T13:48:54.473

在没有任何其他参数的情况下运行“p4 sync”将同步当前客户端工作区映射到当前目录的文件。从 Python 脚本运行命令时，您需要了解脚本实际运行的位置。

出于调试目的，请先尝试运行“p4 info”：它将显示当前工作目录是什么，以及向您显示 Perforce 环境的其余详细信息。

如果您总是希望脚本同步同一个目录，无论您在哪里运行它，您都可能需要考虑指定同步路径。例如：

*   仓库语法：p4 sync //depot/path/to/dir/...
*   本地语法 (Windows)： p4 sync c:\users\user\path\to\dir...
*   本地语法 (*nix): p4 sync /home/user/path/to/dir/...

如果您是客户端工作区，用户或 perforce 服务器配置由 P4CONFIG 基于目录配置或由 P4V 设置，您可能希望将这些设置的全局选项作为全局选项添加到命令中。例如：

*   p4 -p server:1666 -c client_ws -u 用户同步 //depot/path/to/dir/...

当您从 Python 运行命令时，您可能会发现 P4Python 脚本 API 使配置更容易： [https ://www.perforce.com/perforce/r14.2/manuals/p4script/python.programming.html](https://www.perforce.com/perforce/r14.2/manuals/p4script/python.programming.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-01-27T18:36:06.523

如果 P4Python 比您想要处理的更多，Perforce Workshop 中有一个 Python 类，它提供了使用 P4Python 接口包装命令行的功能。

[用于 Python 的 P4Python 式 CLI 包装器](https://swarm.workshop.perforce.com/files/guest/lester_cheung/p4util/p4util/p4cli.py)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-10-29T16:23:19.087

I have had good success running Perforce commands from Python, using the ActiveState Python 2.7, with the P4Python plugin. You will need a p4 definition line, like the following:

```
p4Params = {'Port': "perforce_server_name:1666", \
            'Pass': "mypassword", \
            'User': "myname", \
            'Client': "myclient"} 
```

Plus you'll need the P4 and P4Exception libraries:

```
from P4 import P4,P4Exception 
```

With that in hand, you can perform most any Perforce command with the following construct. This function syncs to Rev #0 to remove all controlled files from some depot location "depotPath":

```
 def removeWorkFiles(depotPath,p4Params):
  """Tell Perforce to remove the version files from the workspace"""
    p4 = P4(client=p4Params['Client'], port=p4Params['Port'], password=p4Params['Pass'])
    p4.user = p4Params['perfUser']  
    try:
      p4.connect()                 # Connect to the Perforce Server
      p4.run_login()
      deletePath = depotPath + "#0"
      p4.run("sync", "-f", deletePath) # force to version "0", ie remove from workspace
      p4.disconnect()
    except P4Exception:
      for e in p4.errors:          # Display errors
        logging.error( e) 
```

I highly recommend you read Perforce's P4 Python help page at:

[https://www.perforce.com/perforce/r14.2/manuals/p4script/python.programming.html](https://www.perforce.com/perforce/r14.2/manuals/p4script/python.programming.html)

This will give you some perspective, though it is not complete. Hope this helps

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-25T13:31:22.757

如果您知道可以在 CMD shell 中运行的确切 perforce 命令，则可以使用 os.system('cmd')。你也可以看看[os.popen](http://docs.python.org/2/library/subprocess.html)和[subprocess.call](http://docs.python.org/2/library/os.html#os.popen)来做同样的事情。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-10-12T17:19:54.900

有 p4swamp，它也是 CLI 的包装器

```
from p4swamp import p4

result = p4('sync')
print(result) 
```

# linux - 日期更改时的 Cron 意外行为

> ID：14522684
> 
> 赞同：0
> 
> 时间：2013-01-25T13:24:10.053
> 
> 标签：linux, unix, cron, crontab

我有一个在 ELINOS4 环境中的嵌入式设备中执行的 cron 实例。这个设备有问题，我认为与电池有关，它改变了系统日期。

对于嵌入式应用程序来说不是问题，因为应用程序会重新同步日期。但是对于 cron 守护进程会影响其调度程序，从而导致在很远的将来对下一次执行进行编程。使用标志执行 cron 我得到以下日志：

```
[3933] TargetTime=1359121500, sec-to-wait=60
...
[3933] spool dir mtime unch, no load needed.
[3933] tick(45,13,24,0,5) user [root:0:0:...] cmd="/etc/logrotate /etc/logrotate.conf"
[3933] TargetTime=1359121560, sec-to-wait=1130199663
[3933] sleeping for 1130199663 seconds 
```

我尝试手动更改日期，但 cron 未检测到此更改（它正在休眠[https://stackoverflow.com/a/4141239](https://stackoverflow.com/a/4141239)）。

一种快速破解方法是修改 cron 的源代码，但是否存在更好的解决方案？

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T13:29:47.033

除了明显的“修复你的硬件”之外，直接的建议是让一个守护进程检查时间，如果它看到它向后跳（或向前？）超过几秒钟，重新启动 crond（以及任何其他进程）可以使用这种方法来确定“下次醒来”）。

# actionscript-3 - 拦截 EventListener ActionScript

> ID：14522687
> 
> 赞同：1
> 
> 时间：2013-01-25T13:24:25.320
> 
> 标签：actionscript-3, event-handling

我正在尝试扩展 Button 类并通过以下方式删除默认 EventListener：

```
removeEventListener(MouseEvent.CLICK, clickHandler); 
```

然后添加如下内容：

```
 protected function _clickHandler(event:MouseEvent):void{
        Alert.show("Are you sure about this operation", "Alert", 3, this, execute);
        function execute(e:CloseEvent):void{
            if(e.detail == Alert.YES)
                super.clickHandler(event);
        }
    } 
```

这样，我将拥有一个默认组件，该组件将触发带有 YES 或 NO 选项的消息警报，并防止我不得不在触发服务器的每个按钮上编写它。不幸的是，它不是那样工作的。

1.  尝试删除默认功能并添加我在侦听器上编写的功能；
2.  尝试直接覆盖clickHandler，也不行；

* * *

编辑：这就是我想要的：当用户单击将在我的应用程序中进行服务调用的按钮时，我总是会弹出一个窗口让他告诉我他是否确定。我想要的是为此构建一个自动组件，如下所示：

```
package screen{
import flash.events.KeyboardEvent;
import flash.events.MouseEvent;
import flash.ui.Keyboard;

import mx.controls.Alert;
import mx.controls.Button;
import mx.events.CloseEvent;

public class CommonButton extends Button{
    public function CommonButton(){
        super();
        //removeEventListener(MouseEvent.CLICK, clickHandler)
        //addEventListener(MouseEvent.CLICK, clickHandler);
        addEventListener(KeyboardEvent.KEY_DOWN, function (e:KeyboardEvent):void{
            if(e.altKey == Keyboard.ENTER)
                dispatchEvent(new MouseEvent(MouseEvent.CLICK));
        });
    }

    private var _saveEvent:MouseEvent;
    override protected function clickHandler(event:MouseEvent):void{
        _saveEvent = event;
        event.stopImmediatePropagation();
        Alert.show("Are you sure about this operation", "Alert", 3, this, execute);         
    } 

    private function execute(e:CloseEvent):void{
        if(e.detail == Alert.YES)
            super.clickHandler(_saveEvent);
    }
}
} 
```

进而：

```
 <mx:Script>
    <![CDATA[
        import mx.controls.Alert;
        private function test():void{
            //if the user clicked No, this method will never be called.
            Alert.show("You clicked YES");
        }
    ]]>
</mx:Script>
<screen:CommonButton click="test()" /> 
```

* * *

最终编辑解决方案：

```
package screen{
import flash.events.KeyboardEvent;
import flash.events.MouseEvent;
import flash.ui.Keyboard;

import mx.controls.Alert;
import mx.controls.Button;
import mx.events.CloseEvent;

public class CommonButton extends Button{
    public function CommonButton(){
        super();
        addEventListener(KeyboardEvent.KEY_DOWN, function (e:KeyboardEvent):void{
            if(e.altKey == Keyboard.ENTER)
                dispatchEvent(new MouseEvent(MouseEvent.CLICK));
        });
    }

    private var _stopProp:Boolean = true;
    override protected function clickHandler(event:MouseEvent):void{
        if(_stopProp){
            event.stopImmediatePropagation()
            Alert.show("Are you sure about this operation", "Alert", 3, this, execute);
        }else
            _stopProp = true;

    } 

    private function execute(e:CloseEvent):void{
        if(e.detail == Alert.YES){
            _stopProp = false;
            dispatchEvent(new MouseEvent(MouseEvent.CLICK));
        }
    }
} 
```

}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T16:05:12.830

为什么还要为此烦恼？只需将您的自定义事件处理程序添加到扩展组件并允许正常事件处理程序触发即可。您可以将多个处理程序注册到同一个事件。我认为这是一个问题的唯一原因是，如果您将其作为库发布并希望阻止用户自己附加点击处理程序，但您不是。您根本不需要在此处删除或停止默认的单击处理程序。

编辑：这是提问者想要在这里发生的事情的一个例子。

```
public class AButton extends Button
{
    private var stopProp:Boolean = true;

    public function AButton()
    {
        super();
        this.addEventListener(MouseEvent.CLICK,this.clickHandlers);
    }

    private function clickHandlers( e:MouseEvent ):void{
        if ( stopProp ) {
            e.stopImmediatePropagation();

            trace( "clicked in button" );
            Alert.show( "Continue with event", "Warning!", Alert.YES|Alert.NO, null, this.closeHandler  );
        }
    }

    private function closeHandler( e:CloseEvent ):void {
        if ( e.detail == Alert.YES ) {
            this.stopProp = false;
            this.dispatchEvent( new MouseEvent( MouseEvent.CLICK ) );
            this.stopProp = true;
        }
    }
} 
```

`stopProp`如果属性为真，这将阻止事件继续进行。然后它会提示用户。如果用户选择“是”，它会将 stopProp 设置为 false，从按钮重新调度 click 事件，并将 stopProp 重置为 false 以供下次使用。如果他们选择“否”，则不会发生任何事情。

我做了一个快速原型来测试它，它确实有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T14:28:37.367

使用 Event 类的 stopImmediatePropagation() 方法。

```
protected function _clickHandler(event:MouseEvent):void{
    event.stopImmediatePropagation();

    Alert.show("Are you sure about this operation", "Alert", 3, this, execute);
    function execute(e:CloseEvent):void{
        if(e.detail == Alert.YES)
            super.clickHandler(event);
    }
} 
```

# java - java.lang.IllegalStateException：没有可用的事务性 EntityManager

> ID：14522691
> 
> 赞同：25
> 
> 时间：2013-01-25T13:24:29.600
> 
> 标签：java, spring, hibernate, maven, jpa

项目使用 Hibernate (JPA)、Spring 和 Maven。我的实体和 DAO 在一个单独的 JAR 中。

pom.xml：

```
<project ...>
    ...
    <artifactId>database</artifactId>

    <dependencies>
        <dependency>
            <groupId>org.hibernate</groupId>
            <artifactId>hibernate-entitymanager</artifactId>
            <version>3.5.4-Final</version>
        </dependency>
    </dependencies>    
</project> 
```

道：

```
public class AbstractDAO<T extends BaseEntity> implements GenericDAO<T> {

    private final Class<T> persistentClass;

    private EntityManager entityManager;

    public AbstractDAO(Class<T> entityClass) {
        super();
        this.persistentClass = entityClass;
    }

    @PersistenceContext
    public void setEntityManager(EntityManager entityManager) {
        this.entityManager = entityManager;
    }

    public EntityManager getEntityManager() {
        return entityManager;
    }

    ...

    public void fooBar() {
       //Exception from this line
       Session session = getEntityManager().unwrap(Session.class);
       ...
    }

    .... 
```

}

我有一个使用 Spring 的模块。

pom.xml：

```
<project ...>
...
<artifactId>api</artifactId>

<dependencies>
    <dependency>
        <groupId>org.springframework</groupId>
        <artifactId>spring-core</artifactId>
        <version>${spring.version}</version>
    </dependency>

    <dependency>
        <groupId>org.springframework</groupId>
        <artifactId>spring-context</artifactId>
        <version>${spring.version}</version>
    </dependency>

    <dependency>
        <groupId>org.springframework</groupId>
        <artifactId>spring-orm</artifactId>
        <version>${spring.version}</version>
    </dependency>
    ....
</dependencies>

 ...    
</project> 
```

AppContext.xml：

```
<bean id="authService" scope="singleton" class="com.test.management.AuthServiceImpl" />

    <bean id="entityManagerFactory" class="org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean" name="EntityManagerFactory">
        <property name="persistenceUnitName" value="default"></property>
        <property name="dataSource" ref="dataSource"></property>
        <property name="jpaVendorAdapter">
            <bean class="org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter">
                <property name="showSql" value="true" />
                <property name="generateDdl" value="true" />
                <property name="databasePlatform" value="${db.dialect}" />
            </bean>
        </property>     
    </bean>

    <!-- Values are defined in db.properties -->
    <bean id="dataSource" class="org.apache.commons.dbcp.BasicDataSource" destroy-method="close">
        <property name="driverClassName" value="${db.driver}" />
        <property name="url" value="${db.url}" />
        <property name="username" value="${db.username}" />
        <property name="password" value="${db.password}" />
    </bean>

    <bean id="transactionManager" class="org.springframework.orm.jpa.JpaTransactionManager" name="TransactionManager">
        <property name="entityManagerFactory" ref="entityManagerFactory"></property>
    </bean>

    <tx:annotation-driven />

    <bean id="userDAO" scope="singleton" class="com.test.database.dao.impl.UserDAOImpl">
    </bean>

    <bean class="org.springframework.orm.jpa.support.PersistenceAnnotationBeanPostProcessor" />

</beans> 
```

服务：

```
public class AuthServiceImpl implements AuthService {

    @Autowired
    private UserDAO userDAO;

    @Override
    public void authorization() {
        userDAO.fooBar();

    }
} 
```

当我试图从 EntityManager 获取会话时，我发现了这个异常：

```
java.lang.IllegalStateException: No transactional EntityManager available
    at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:223)
    at $Proxy121.unwrap(Unknown Source) 
```

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2013-06-07T09:40:52.527

您必须使用 @Transactional 注释包围该方法：

```
@Transactional
public void fooBar() {
   //Exception from this line
   Session session = getEntityManager().unwrap(Session.class);
   ...
} 
```

并在你的 spring 的 xml 配置文件中使用以下声明启用 spring @Transactional 处理（txManager 是你的经理的 id）。

```
<tx:annotation-driven transaction-manager="txManager" /> 
```

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2013-07-31T21:31:26.003

试试这个 ？

```
entityManager=entityManager.getEntityManagerFactory().createEntityManager();
Session session = (Session) entityManager.unwrap(Session.class); 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2015-10-14T05:35:51.163

这些都不适合我，我终于发现问题是我正在制作我的方法@Transactional，而不是我需要这个类是@Transactional

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-06-12T08:52:43.707

就我而言，这是另一个问题（对于那些对@Transactional 有问题的人）：

*@Transactional*工作需要动态代理才能工作。正是基于接口（JDK 代理。在这种情况下，CGLIB 不起作用）需要它的代理。因此，制作接口并通过服务实现它，*@Transactional*注解将起作用。

# objective-c - Xcode使用正则表达式查找多行

> ID：14522693
> 
> 赞同：3
> 
> 时间：2013-01-25T13:24:36.997
> 
> 标签：objective-c, regex, xcode, cocoa, replace

我在很多地方的代码中都有以下几行。我想一次找到所有这些，并用新评论替换每个这样的块。但是我可以一次搜索单行。但我不知道如何在我的正则表达式中包含新行以进行搜索，请帮助。

```
// Block Solver
// We develop a block solver that includes the joint limit.
// when the mass has poor distribution (leading to large torques about..
// 
```

提前致谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-28T06:59:54.620

搜索：

```
^(?://.*\n?)+ 
```

并一无所有。

这将找到所有以`//`.

# javascript - 根据选择的选项验证下拉列表以获取正确的日期

> ID：14522697
> 
> 赞同：0
> 
> 时间：2013-01-25T13:24:54.643
> 
> 标签：javascript, asp.net, date, drop-down-menu

**-**我有一个**下拉**列表，其中有一些选项可供用户选择。

**- 选项为 1 天、1 周、2 周、1 个月和 6 个月**

**-**现在，当我**选择选项 1 day**时，**今天的日期应该增加一并**显示下一个日期。

**-**如果我**选择 1 周，则应显示一周后的日期**。

**-**现在的问题是当我选择一个选项时，它**有时会显示 date 大于 30/31**。

**-**我使用以下`javacript`功能：

```
 function select_duration(ddlcupon) {

            var skillsSelect = document.getElementById("ddlcupon");
            var selectedText = skillsSelect.options[skillsSelect.selectedIndex].text;

            if (selectedText == "1 Day") {

                var currentTime = new Date();
                var month = currentTime.getMonth() + 1;
                var day = currentTime.getDate() + 1;
                var year = currentTime.getFullYear();
                var exdate = month + "/" + day + "/" + year;

                document.getElementById('<%=txtEventDate.ClientID%>').value = exdate.toString();

            }
            if (selectedText == "1 Week") {

                var currentTime = new Date();
                var month = currentTime.getMonth() + 1;
                var day = currentTime.getDate() + 7;
                var year = currentTime.getFullYear();
                var exdate = month + "/" + day + "/" + year;

                document.getElementById('<%=txtEventDate.ClientID%>').value = exdate.toString();
            }
            if (selectedText == "2 Weeks") {

                var currentTime = new Date();
                var month = currentTime.getMonth() + 1;
                var day = currentTime.getDate() + 14;
                var year = currentTime.getFullYear();
                var exdate = month + "/" + day + "/" + year;
                document.getElementById('<%=txtEventDate.ClientID%>').value = exdate.toString();
            }
            if (selectedText == "1 Month") {

                var currentTime = new Date();
                var month = currentTime.getMonth() + 2;
                var day = currentTime.getDate();
                var year = currentTime.getFullYear();
                var exdate = month + "/" + day + "/" + year;
                document.getElementById('<%=txtEventDate.ClientID%>').value = exdate.toString();
            }
            if (selectedText == "6 Months") {

                var currentTime = new Date();
                var month = currentTime.getMonth() + 7;
                var day = currentTime.getDate();
                var year = currentTime.getFullYear();
                var exdate = month + "/" + day + "/" + year;
                document.getElementById('<%=txtEventDate.ClientID%>').value = exdate.toString();
            } 
```

**-**有人可以帮我找个**合适的约会吗？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T13:38:24.537

问题是你在增加日、月和年。因此，如果月份是 12，您将得到 13。您可以直接使用毫秒。例如：

```
var d = new Date('01/31/2013'); // Thu Jan 31 2013 00:00:00 GMT-0200 (BRST)
var addDay = 1000 * 60 * 60 * 24;
var currentMs = d.getTime();
d.setTime(currentMs + addDay);
console.log(d); // Fri Feb 01 2013 00:00:00 GMT-0200 (BRST) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-25T13:46:01.407

尝试使用这个

```
var dt1 = new Date();    
var dt2 = new Date(dt1.getTime() + (86400000 * numberOfDay) ); 
```

如果您的日期增加了一天，请尝试

```
var dt2 = new Date(dt1.getTime() + (86400000 * 1 ) ); //so on 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-25T13:38:22.133

[Date.js](http://www.datejs.com/)是用于各种 JavaScript 日期操作的便捷脚本。

将 n 天添加到当天的语法是

```
// Add 3 days to Today
Date.today().add(3).days(); 
```

在这种情况下，将 3 天添加到当前日期。

# tsql - SQL 限制查询

> ID：14522702
> 
> 赞同：2
> 
> 时间：2013-01-25T13:25:20.507
> 
> 标签：tsql, sql-server-2000

我遇到了限制 SQL 查询的问题。我使用的是 SQL 2000，所以我不能使用任何函数，如`ROW_NUMBER(),CTE OR OFFSET_ROW FETCH`.

我已经尝试过这种`Select TOP limit * FROM`方法并排除了已经显示的结果，但是这样查询非常慢，因为有时我的结果查询会获取超过 10000 条记录。

我也尝试了以下方法：

```
SELECT * FROM (
 SELECT DISTINCT TOP 100 PERCENT i.name, i.location, i.image ,  
 ( SELECT count(DISTINCT i.id) FROM image WHERE i.id<= im.id ) AS recordnum 
 FROM images AS im 
 order by im.location asc, im.name asc) as tmp 
 WHERE recordnum between 5 AND 15 
```

这里有同样的问题加上问题，因为我无法在记录 um 的子查询中添加 ORDER 选项。我已将这两种解决方案都放在存储过程中，但查询执行仍然很慢。

所以我的问题是：有没有一种有效的方法来限制查询在 SQL 2000 中为大量数据（即超过 10000 条）每页提取 20 条记录？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T15:27:51.553

现在子查询仅
在 im2.id 为 null 的情况下运行一次，将跳过前 40 行

```
SELECT top 25 im1.* 
FROM images im1 
left join ( select top 40 id from images order by id ) im2
on im1.id = im2.id
where im2.id is null
order by im1.id 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T13:34:55.033

查询方面，没有很好的执行方式。如果性能至关重要并且数据将始终按相同的方式分组/排序，则可以添加一个 int 列并根据分组/排序通过触发器设置值。索引它，读取速度应该非常快；写入会慢一些。

此外，请确保您在 image 和 images 的 Id 列上有索引。

# sql - 按前 2 或 3 个字符对 SQL 字符串进行排序

> ID：14522704
> 
> 赞同：1
> 
> 时间：2013-01-25T13:25:28.813
> 
> 标签：sql, sql-server, sorting

我被要求按升序对位置表进行排序。表中的数据目前看起来像这样：

*   100F01
*   105B02
*   10B01
*   GK1-A01
*   201E12
*   20A01

但是，当此数据显示在屏幕上时，我希望它按升序对数字结果进行排序，然后按字母顺序对字符串结果进行排序。输出应如下所示：

*   10B01
*   20A01
*   100F01
*   105B02
*   201E12
*   GK1-A01

我尝试使用以下代码

```
SELECT location FROM freelocations
ORDER BY CAST(SUBSTRING(location, 1, 2) AS INT) 
```

但是，正如预期的那样，这会返回一条错误消息，因为某些位置不以数字开头：

> 将 varchar 值“GK”转换为数据类型 int 时转换失败。

任何想法或提示将不胜感激

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-25T13:46:38.227

也许是这样的？

```
select location 
from freelocations
order by 
    case 
       when patindex('%[^0-9]%', location) = 1 then 9999999999
       else cast(substring(location, 1, patindex('%[^0-9]%', location) - 1) as int)
    end,
    location 
```

（由于 SQL Server 缺少正则表达式替换功能，有点笨拙）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T13:41:24.100

在投射之前，您应该检查前 2 个或 3 个字符是否真的是数字：

```
SELECT
  location
FROM
  freelocations
ORDER BY
  CASE
    WHEN location like '[0-9][0-9][0-9]%' THEN cast(substring(location,1,3) AS INT)
    WHEN location like '[0-9][0-9]%' THEN cast(substring(location,1,2) AS INT)
    ELSE 9999
  END 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-25T13:43:38.440

按 FIELD(string+0,1),string+0 排序

但请注意，“10e20”会被误解！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-25T13:50:32.507

试试这个以避免铸造：

```
SELECT 
    x,
    RIGHT('000' +LEFT (x,patindex('%[^0-9]%',x)-1),3) sort1,
    RIGHT (x,LEN(x)-patindex('%[^0-9]%',x)+1) sort2
FROM
(
    SELECT '123asdf' x
    UNION
    SELECT '12asdf'     
    UNION
    SELECT '13asdf'  
    UNION
    SELECT '12zsdf'  
) X
ORDER BY sort1 ,sort2 
```

# log4net - Log4net 按日期滚动

> ID：14522706
> 
> 赞同：0
> 
> 时间：2013-01-25T13:25:34.080
> 
> 标签：log4net

我要求 log4net 在创建日志文件时以“Application.20130125.txt”的日志文件名为“Application.20130125.txt”的格式创建日期，而不是在晚上 12 点更改日期时创建日期。

并且当日期更改时，它应该创建新的日志文件为“Application.20130126.txt”

您能否建议对以下代码进行哪些更改，以便首先创建日期并在滚动时创建一个日期为“Application.20130126.txt”的新文件

```
 LogPath = "C:\Logs\"
            fileName = "ApplicationName" & "..txt"

            hierarchy = DirectCast(LogManager.GetRepository(), Hierarchy)
    patternLayout.ConversionPattern = "%m%n"
    patternLayout.ActivateOptions()
    roller.Layout = patternLayout
    roller.RollingStyle = RollingFileAppender.RollingMode.Date
    roller.DatePattern = "yyyyMMdd"
    roller.AppendToFile = True
    roller.StaticLogFileName = True
    roller.File = LogPath & fileName
    roller.PreserveLogFileNameExtension = True
    roller.ActivateOptions()
    hierarchy.Root.AddAppender(roller)
    hierarchy.Root.Level = Level.Debug
    hierarchy.Configured = True
    log = LogManager.GetLogger("RollingFileAppender") 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T14:29:20.373

请在下面找到我使用过的示例，该示例会根据您的需要写入文件：

```
 Dim fileappender = New log4net.Appender.RollingFileAppender()
    fileappender.AppendToFile = True
    fileappender.Threshold = log4net.Core.Level.Debug
    fileappender.File = "MyLogFile_"
    fileappender.DatePattern = "yyyyMMdd"
    fileappender.StaticLogFileName = False
    fileappender.Layout = New log4net.Layout.SimpleLayout()
    fileappender.RollingStyle = log4net.Appender.RollingFileAppender.RollingMode.Date
    fileappender.ActivateOptions()
    DirectCast(log4net.LogManager.GetRepository(), log4net.Repository.Hierarchy.Hierarchy).Root.AddAppender(fileappender)
    log4net.Config.BasicConfigurator.Configure(fileappender) 
```

以上将创建一个文件名为“MyLogFile_20130125”的日志文件，一旦日期时间更改，它将写入一个新文件为“MyLogFile_20130126”

您也可以通过将 datePattern 设置为`"yyyyMMddhhmm"`并且每分钟写入一个新的日志文件来测试它。

# asp.net-mvc-3 - 没有“IEnumerable”类型的 ViewData 项 ' 具有键 'SalutationName'

> ID：14522714
> 
> 赞同：0
> 
> 时间：2013-01-25T13:26:13.453
> 
> 标签：asp.net-mvc-3, razor

现在我是 MVC 的新手..请解决我的问题..谢谢提前

```
**This is MY View**

   @Html.DropDownList("SalutationName", (IEnumerable<SelectListItem>)ViewBag.Titles, "--------------Select-------------", new { id = "R_title" })

**This is My Controller**

  public ActionResult Index()
       {  var list=RoleID();
            IList<salutation> p = list;
            ViewBag.Titles = new SelectList(p.AsEnumerable(), "SalutationID", "SalutationName");
            return View();
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T09:06:37.687

尝试这个

```
@Html.DropDownList("Salutation",ViewBag.Titles as SelectList,"---select---",new { id = "R_title" }) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T13:29:40.583

尝试

```
@Html.DropDownList("SalutationName",ViewBag.Titles, "--------------Select-------------", new { id = "R_title" }) 
```

# android - 将指令从 UI 线程传递到渲染线程 (GLSurfaceView)

> ID：14522715
> 
> 赞同：2
> 
> 时间：2013-01-25T13:26:15.403
> 
> 标签：android, glsurfaceview

**设置：**如图所示，带有 GLSurfaceView 和按钮的 RelativeLayout。

![在此处输入图像描述](../Images/dea77adf16cd72ceea2f3df7af1e17f2.png)

**问题：**假设我有其他三角形模型（图片中的那个是初始模型）......我希望通过单击按钮循环更改模型。由于按钮在 UI 线程上并且 glSurfaceView 在单独的线程上运行，我不完全知道如何将信息/指令传递给它。我知道 Android 中有一个叫做[Handler](http://developer.android.com/reference/android/os/Handler.html)的东西，在这种情况下可能很有用......但我需要一些帮助......

**编辑：**如果 Handler 是正确的方法，我需要知道如何将[Looper](http://developer.android.com/reference/android/os/Looper.html)添加到该 Handler ......文档说`looper.prepare()`在 run() 方法的开头添加。但是 glSurfaceView 隐式创建线程，导致没有 run()方法直接可用..

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-12T10:20:59.800

我认为没有必要使用处理程序来解决这个问题，但您可能需要调整组织课程的方式。

以下是可能解决您的问题的组织结构示例：

**活动课**

```
public class MainActivity extends Activity {

    private int modelNumber = 0;
    private ArrayList<Model> models = new ArrayList<Model>();
    private YourRendererClass renderer;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        ...

        // Setup GLSurfaceView
        GLSurfaceView surface = new GLSurfaceView(this);
        setContentView(surface);

        renderer = new YourRendererClass();
        surface.setRenderer(renderer);

        // Set up models
        models.add(new Model(x, y, size etc..));
        models.add(new Model(x, y, size etc..));
        models.add(new Model(x, y, size etc..));
        etc.

        // Display first model
        renderer.setCurrentModel(models.get(modelNumber));

        ...
    }

    // Called by the button press:
    // Use android:onClick="onClick"
    // in your layout xml file within button
    public void onClick(View view){
        // Make it loop round
        modelNumber++;
        if(modelNumber>=models.size()){
            modelNumber=0;
        }

        // Display current model
        renderer.setCurrentModel(models.get(modelNumber));

    }
} 
```

**渲染器类**

```
public class YourRendererClass implements Renderer {

    private Model currentModel;

    @Override
    public void onDrawFrame(GL10 gl) {

        // ** Your existing set-up code **//

        // Draw model
        if (currentModel!=null){
            currentModel.draw(gl);
        }

    }

    public void setCurrentModel(Model model){
        currentModel = model;
    }

} 
```

**模型类**

```
public class Model {
    // Holds model information
    private int size;
    private int x;
    private int y;
    // etc...

    public model(int x, int y, int size etc...){
        this.x=x;
        this.y=y;
        this.size=size;
        // etc....
    }

    public void draw(GL10 gl) {
        // ** Draw model based on model information fields above **
    }
} 
```

上面的代码未经测试，因为我无权访问您的绘图代码，但如果正确实施，该结构应该可以工作。我试图说明您必须在哪里插入自己的代码才能使其工作。特别是我不确定是什么定义了每个不同的模型，因此您需要在 Model 类中包含足够的局部变量来定义它们。

希望我的回答对你有帮助，有什么问题可以私信我。

蒂姆

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-06-09T09:29:16.393

你应该看看 queueEvent！这是将信息从 UI Thread 传递到渲染器 Thread 的一种非常方便的方法：

```
queueEvent(new Runnable(){
    @Override
    public void run() {
        mRenderer.method();
}}); 
```

# vb.net - 下载文件然后执行

> ID：14522716
> 
> 赞同：2
> 
> 时间：2013-01-25T13:26:16.090
> 
> 标签：vb.net, download

我正在创建一个下载一些应用程序（如 FireFox、WinRar、RealPlayer）的应用程序，然后使用 Shell 命令静默安装它们。这是代码：

```
My.Computer.Network.DownloadFile("URL", "path\file.exe")
Shell("path\file.exe /s") 
```

问题是 shell 命令在下载完成之前启动，所以我收到“找不到文件”错误。所以我的问题是：

1.  下载完成后如何执行Shell命令？
2.  我可以使用 process.start`S`参数而不是 Shell 命令吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T13:31:37.240

这应该可以下载文件并等到它结束：

```
Dim wc As WebClient = New WebClient()
wc.DownloadFile(sURL, sFile) 
```

# c# - 如何将用户重定向到 ACS 默认登录页面

> ID：14522717
> 
> 赞同：3
> 
> 时间：2013-01-25T13:26:17.820
> 
> 标签：c#, azure, acs

我`Access Control System (ACS)`在我的 Web 应用程序中使用 azure 对来自不同身份提供者的用户进行身份验证。我成功注册了我的应用程序以使用 ACS。现在我通过从 web.config 文件中删除以下内容来删除我的 ACS 完整网站安全性：

```
<authorization>
  <deny users="?" />
</authorization> 
```

删除后，我的用户无需登录即可访问我的网站主页。现在在我的主页上我设置了一个链接`SignIn`。**我想知道当用户单击登录链接时如何将我的用户重定向到 ACS 默认登录页面？**（*类似地，当 asp.net 应用程序将用户重定向到 ACS 登录页面时，如果用户未通过身份验证并尝试访问由 Authorize 属性修饰的控制器*）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-12-15T23:52:53.350

以下代码会将您重定向到联合帐户登录页面：

```
public class AccountController : Controller
{
    public ActionResult SignIn(string returnUrl)
    {
        if (String.IsNullOrEmpty(returnUrl))
        {
            returnUrl = Url.Content("~/");
        }

        var signInRequest = FederatedAuthentication.WSFederationAuthenticationModule.CreateSignInRequest(
            "passive",
            returnUrl,
            FederatedAuthentication.WSFederationAuthenticationModule.PersistentCookiesOnPassiveRedirects);

        return Redirect(signInRequest.RequestUrl);            
    }

    // SignOut, SignOutCallback below from typical MVC template
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-25T13:58:35.750

您可以使用 SignInRequestMessage 类手动构建 URL，也可以调用

FederatedAuthentication.WSFederationAuthenticationModule.RedirectToIdentityProvider() (IIRC)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-25T14:45:50.647

另外 - 我相信 WIF 包含一个[控件](http://msdn.microsoft.com/en-us/library/ee517283.aspx)，它将为您显示该登录链接

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-25T22:33:54.013

以下是我在 MVC 应用程序中的做法。

允许用户在 web.cofig 中使用此声明访问所有未受保护的页面：

```
<location path="FederationMetadata">
<system.web>
  <authorization>
    <allow users="*" />
  </authorization>
</system.web> 
```

在我的登录方法上使用 RequireHttps 属性：

```
[HttpGet]
[RequireHttps]
public ActionResult LogOn(string returnUrl)
{
     if (string.IsNullOrWhiteSpace(returnUrl))
       returnUrl = "/reports";

     return LogOnCommon(returnUrl);
} 
```

并使用我的登录页面所在的 web.config 的身份验证部分：

```
<system.web>
  <authentication mode="Forms">
    <forms loginUrl="~/account/logon" timeout="2880" />
  </authentication>
</system.web> 
```

# java - 有没有办法*不*在锡耶纳坚持一个领域

> ID：14522718
> 
> 赞同：1
> 
> 时间：2013-01-25T13:26:19.200
> 
> 标签：java, google-app-engine, siena

我使用 siena 和谷歌引擎。我有一个模型类，其中包含一个`secret`我不想保留的字段（名为 ）。（我不希望在谷歌数据存储中创建该列）

类似的东西

```
Class person {
   @Id 
   public Long id ; 

   public String name ; 

   @Ignore
   public String secret ;

} 
```

该字段`secret`必须是公开的。

你有什么想法来实现这一目标吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-25T13:31:57.693

您可以使用 Java 的瞬态关键字：

```
public transient String secret; 
```

这应该阻止它被持久化。

# c - 将动态多维数组的元素传递给函数

> ID：14522722
> 
> 赞同：0
> 
> 时间：2013-01-25T13:26:35.780
> 
> 标签：c, dynamic, multidimensional-array

我的代码已经可以工作，但正在尝试扩展它。

```
unsigned char **data_ptr; 
```

为第一个“数组”分配内存

```
data_ptr = (unsigned char **)malloc(sizeof(unsigned char **) * no_of_rows); 
```

然后在循环中初始化每一行

```
data_ptr[index] = (unsigned char *)malloc(sizeof(unsigned char*), rowsize)); 
```

然后我将数组的地址传递给库函数。如果我只是通过一行的开头，它就可以正常工作......

```
LibFunction( info_ptr,  &data_ptr[index] )  //OK 
```

但是我需要传递我希望函数开始写入数据的连续位置的地址。这些都编译但运行失败

```
LibFunction( info_ptr,(unsigned char **)data_ptr[index] + 1); 
```

或者..

```
LibFunction( info_ptr,(unsigned char **)data_ptr[index][1]); 
```

LibFunction 的形式为

```
LibFunction(..., unsigned char **) 
```

我分配的内存比我需要的多，所以我不认为我超出了数组。正如我所说，如果我将它传递给一行的开头，则代码可以正常工作，但如果我尝试传递任何其他元素，则会出错。可能还有其他问题，但我需要先知道我的语法是否正常。

关于传递动态二维数组的单个元素的地址，在网上找不到其他任何东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T13:43:18.957

```
LibFunction( info_ptr,(unsigned char **)data_ptr[index] + 1); 
```

是错误的，因为`data_ptr`是一个`unsigned char **`，所以`data_ptr[index]`是一个`unsigned char *`。省略演员表并更正您正在调用的函数，它应该接受一个`unsigned char *`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-25T13:44:37.317

从前几行观察到您的程序中的一些更正

自从，

```
unsigned char **data_ptr; // a pointer to a char pointer 
```

获取 sizeof(char*) 并始终避免对 malloc() 返回的指针进行类型转换

```
data_ptr = malloc(sizeof(unsigned char *) * no_of_rows); 
```

并为行分配，

```
data_ptr[index] = (unsigned char *)malloc(sizeof(unsigned char*)* rowsize)); 
```

要传递您希望函数开始写入数据的行中的地址，请将函数签名更改为

```
LibFunction(..., unsigned char *) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-25T13:54:49.347

`But I need to pass the address of where in a row I want the function to begin writing data`

因此，让我们从简单的开始，使数组具有正确的大小，忘记尝试获取`sizeof`复杂类型，我们可以简单地这样做：

```
unsigned char **data_ptr;
data_ptr = malloc(sizeof(data_ptr) * no_of_rows); //Just sizeof your var 
```

现在您已经获得了正确的内存 malloc，接下来您可以轻松地为其余的内存分配内存：

```
for(index = 0; index < no_of_rows; index++)
  data_ptr[index] = malloc(sizeof(unsigned char*) * rowsize); 
```

最后一点，现在我们已经完成了所有设置，你应该初始化你的数组：

```
for(index = 0; index < no_of_rows; index++)
  for(index2 = 0; index2 < rowsize; index2++)
     data_ptr[index][index2] = 0; 
```

至于您的函数，您希望它采用数组的“部分”，因此我们需要它采用数组和大小（要初始化的数组的长度）：

```
void LibFunction(unsigned char data[], int size); 
```

然后我们就可以存储一些数据了，这很简单：

```
LibFunction(&data_ptr[1][2], 3);  // store data in second row, 3rd column, store
                                  // three values. 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-25T13:32:49.390

你可以这样做：

```
unsigned char* ptr = &data[0][1];
LibFunction(info_ptr, &ptr); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-25T13:47:13.560

您没有为`no_of_rows`指向指针的指针分配空间；里面的星号太多了。`malloc()`另外，你真的[不应该在 C][1]中转换 , 的返回值。

您的第一个分配应该是：

```
data_ptr = malloc(no_of_rows * sizeof *data_ptr); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-25T13:45:14.780

它应该是`LibFunction(&data_ptr[row][start_here])`，就像它只是一个`unsigned char[ROWS][COLUMNS];`.

一般来说，根据我的经验，如果你认为你需要在现代 C 中进行强制转换，那么你很可能对你正在尝试做的事情感到困惑。一个不错的阅读是对 Linus Torvalds 在 / 上的帖子的[评论。](http://wordaligned.org/articles/two-star-programming)在这种东西上。

# php - 如果 Apache/PHP 中的实际请求 URL 不存在并且用户被重定向到 404 错误页面，如何获取它？

> ID：14522724
> 
> 赞同：0
> 
> 时间：2013-01-25T13:26:43.250
> 
> 标签：php, apache, url, httprequest

我想获取客户端发出的请求的实际 URL，我该怎么做？我的意思是，如果有人请求一个不存在的页面，例如`http://localhost/invalid.php`，并且我已将 404 自定义错误文件设置为`http://localhost/test.php`，那么我如何知道用户请求的实际 URL 是什么。

我已经在 IIS7 中尝试过这个。我已将自定义错误页面设置为 /test.php，并且每当用户请求一个不存在的 URL 时，我仍然可以使用 /test.php 中的 $_SERVER['REQUEST_URI'] 访问该 URL，并且浏览器中的 URL 仍然保持原样。

但我在 Apache 中做同样的事情时遇到问题。我已将自定义错误页面设置为 /test.php，但是当用户请求一个不存在的页面时，用户被重定向到 /test.php，我无法访问用户请求的实际 URL。我已经尝试过了，但在数组`print_r($_SERVER)`中的任何位置都没有找到实际的请求 URL 。`$_SERVER`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-03T00:57:38.210

我相信您可以通过使用`RewriteCond`错误 404 来做到这一点。

```
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^(.*)$ test.php?errpath=$1 
```

第一行检查文件是否确实存在。
第二个将客户端路由到`test.php`.

然后在`test.php`你输入类似的东西：

```
<?php
    if ($_GET['errpath'] == "" || $_GET['errpath'] == "/") {
        require("index.php");
    }
    else {
        echo "The url ".$_GET['errpath']." does not exist.";
    }
?> 
```

这会检查是否`errpath`什么都不是，或者只是一个正斜杠（意味着通常会显示客户端`index.php`），并且确实如此，需要它。否则为 404 错误页面做任何你想做的事。

P.S. Sorry if the explanations seem patronizing, I just hate it when people tell me to do something and I don't understand. I don't want to do that to anyone else.

# analytics - 使用 apache mahout 进行增量监督学习的用例

> ID：14522726
> 
> 赞同：0
> 
> 时间：2013-01-25T13:26:51.833
> 
> 标签：analytics, mahout, classification

商业案例：现场燃料消耗预测。

假设油耗 C，取决于各种因素 x1,x2,...xn。所以从数学上讲，C = F{x1,x2,...xn}。我没有任何方程式可以说明这一点。

我确实有历史数据集，从中我可以得到 C 与 x1,x2 .. 等的相关性。C,x1,x2,.. 都是定量的。对于像我这样统计知识有限的人，对于变量方程，找出相关性似乎很困难。

所以，我正在考虑使用一些有监督的机器学习技术。我将使用历史数据训练分类器，以预测下一次消费。

问题：我的想法是否正确？问：如果这是正确的，我的系统应该是一个不断发展的系统。因此，我将向系统提供的真实数据越多，这将改进我的模型，以便下次做出更好的预测。这是一个正确的理解吗？

如果上述陈述属实，那么 Mahout 中的 AdaptiveLogisticRegression 算法对我有帮助吗？

在这里向专家寻求建议！

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-30T19:13:48.043

好的，相关性不是预测模型。相关性只是基于协方差将数据集之间的某种关系归因于。

为了开发预测模型，您需要执行的是回归。

最简单的回归形式是线性单变量，其中 C = F (x1)。这可以在 Excel 中轻松完成。但是，您声明 C 是多个变量的函数。为此，您可以使用线性多元回归。有可以执行此操作的标准包（例如在 Excel 中），或者您可以使用 Matlab 等。

现在，我们假设 C 和 X 的分量（输入向量）之间存在“线性”关系。如果关系不是线性的，那么您将需要更复杂的方法（非线性回归），这很可能会采用机器学习方法。

最后，一些系列表现出自相关。如果是这种情况，那么您可能会忽略 C = F(x1, x2, x3...xn) 关系，而是使用时间序列技术（例如 ARMA 等）直接对 C 函数本身进行建模复杂的变体。

我希望这会有所帮助，Srikant Krishna

# jboss - 在 IntelliJ 中使用 Arquillian 进行调试 - 托管容器

> ID：14522734
> 
> 赞同：2
> 
> 时间：2013-01-25T13:27:20.987
> 
> 标签：jboss, junit, intellij-idea, jboss-arquillian

我曾多次尝试在托管容器环境中调试测试。

我收到*JDWP Transport Error*，*socket failed to initialize*之类的错误。意味着我无法使用以下*属性*标签初始化 arquillian。

我的 arquillian.xml 文件如下所示：

```
<arquillian xmlns="http://jboss.org/schema/arquillian"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="
http://jboss.org/schema/arquillian
http://jboss.org/schema/arquillian/arquillian_1_0.xsd">
<engine>
<property name="deploymentExportPath">target/arq.deployments</property>
</engine>

<container qualifier="jboss" default="true">
<protocol type="jmx-as7">
<property name="executionType">MANAGED</property>
</protocol>
<configuration>
<property name="javaVmArguments">-Xrunjdwp:transport=dt_socket,address=55407,server=y,suspend=y -Xmx512m -XX:MaxPermSize=128m</property>
</configuration>
</container>
</arquillian> 
```

我错过了什么吗？

![截屏](../Images/b67c7eab7cd4716aeaf5f075dc86142c.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-25T19:36:07.743

在这种情况下运行了 3 个 JVM。所以这是一个特殊的调试案例。

1.  第一个 JVM-> 由 Arquillian/Junit 启动以执行测试。
2.  第二个 JVM-> 由 Arquillian 启动以运行托管 Jboss。
3.  3rd JVM-> 这是一个**远程调试**配置，必须移植到 2 号 JVM 才能调试 2nd JVM。看看这个[博客](http://rockycode.com/blog/debugging-remote-tomcat-intellij/)

所以这就是想法，运行测试（第二个 JVM 将被挂起，直到一个 JVM 连接到它），然后运行一个新的*远程配置*，一旦启动，过去的 JVM 就会运行。

这有点令人困惑，但有效。

请注意，如果您只有 2 个处于简单调试模式的 JVM，您将调试 arquillian/junit JVM，这不是您感兴趣的。

![在此处输入图像描述](../Images/aabb89b38ae640c1ca881a2abf4988da.png)

# matlab - 在进行层次聚类和生成树状图时，如何在 MATLAB 中显示单独的断开连接的树？

> ID：14522737
> 
> 赞同：2
> 
> 时间：2013-01-25T13:27:28.600
> 
> 标签：matlab, plot, cluster-analysis, hierarchical-clustering, dendrogram

我正在使用`MATLAB`，并且我有一个邻接矩阵：

```
mat =

 0     1     0     0     0     0
 1     0     0     0     1     0
 0     0     0     1     0     0
 0     0     1     0     0     1
 0     1     0     0     0     0
 0     0     0     1     0     0 
```

这不是完全连接的。节点`{1,2,5}`是连接的，并且`{3,4,6}`是连接的（边是有向的）。

我想在单个图上的[树状图中看到单独的簇。](http://www.mathworks.co.uk/help/stats/dendrogram.html)由于没有从一个集群到下一个集群的路径，我希望看到每个集群具有不同根的单独树。我正在使用命令：

```
mat=zeros(6,6)
mat(1,2)=1;mat(2,1)=1;mat(5,2)=1;mat(2,5)=1;
mat(6,4)=1;mat(4,6)=1;mat(3,4)=1;mat(4,3)=1;
Y=pdist(mat)
squareform(Y)
Z=linkage(Y)
figure()
dendrogram(Z) 
```

[分层聚类](http://www.mathworks.co.uk/help/stats/hierarchical-clustering.html?s_tid=doc_12b)建议使用这些命令。并附上结果：[imageDendrogram](http://i.stack.imgur.com/O7Psm.jpg)。除了标签没有意​​义之外，整个树是连接的，我连接弄清楚如何有几个断开连接的树来反映数据的断开连接性质。我想避免使用多个图，因为我希望使用可能具有许多不相交集群的较大数据集。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T20:34:22.757

我看到这是不久前有人问过的，但如果您仍然感兴趣，可以尝试以下方法：

首先从邻接矩阵中提取对角线以上的值，如下所示：

```
>> matY = [];
>> for n = 2:6
for m = n:6
matY = [matY mat(n,m)];
end
end
>> matY

matY =

  Columns 1 through 13

     0     0     0     1     0     0     1     0     0     0     0     1     0

  Columns 14 through 15

     0     0 
```

现在你有一些看起来像`Y`向量`pdist`会产生的东西。但是这里的值与您可能想要的相反；未连接的顶点的“距离”为零，连接的顶点相距一。让我们解决这个问题：

```
>> matY(matY == 0) = 10

matY =

  Columns 1 through 13

    10    10    10     1    10    10     1    10    10    10    10     1    10

  Columns 14 through 15

    10    10 
```

更好的。现在我们可以计算一个常规的簇树，它将连接的顶点表示为“靠近在一起”，将非连接的顶点表示为“相距很远”：

```
>> linkage(matY)

ans =

     3     6     1
     1     5     1
     2     4     1
     7     8    10
     9    10    10

>> dendrogram(ans) 
```

结果图：

![邻接树状图](../Images/7609f3703a5709a84225445d74a3cf41.png)

希望这是您正在寻找的一个不错的近似值。

# google-bigquery - 访问被拒绝，但内容设置为公开

> ID：14522742
> 
> 赞同：0
> 
> 时间：2013-01-25T13:27:40.483
> 
> 标签：google-bigquery

尝试在我的应用程序中使用 BigQuery。我收到了这个错误，我不知道为什么。有关后续步骤的任何反馈。事物设置为“公开”，因此它不是 GS 访问被拒绝消息。

```
{"kind"=>"bigquery#job", "etag"=>"\"GwY6LdvTeqT4YdFN4PyQz2tXZdQ/0q_--jbh-hteL0v2xbStstv0h40\"", "id"=>"tempusgroup.com:omagoog:job_7d07a09c108a49f686c7580461816048", "selfLink"=>"https://www.googleapis.com/bigquery/v2/projects/tempusgroup.com:omagoog/jobs/job_7d07a09c108a49f686c7580461816048", "jobReference"=>{"projectId"=>"tempusgroup.com:omagoog", "jobId"=>"job_7d07a09c108a49f686c7580461816048"}, "configuration"=>{"load"=>{"sourceUris"=>["gs://omaload/mentions_94354.utf-8.bigquery"], "schema"=>{"fields"=>[{"name"=>"created_at", "type"=>"STRING"}, {"name"=>"keyword", "type"=>"STRING"}, {"name"=>"phrases", "type"=>"RECORD", "mode"=>"REPEATED", "fields"=>[{"name"=>"phrase", "type"=>"STRING"}]}]}, "destinationTable"=>{"projectId"=>"tempusgroup.com:omagoog", "datasetId"=>"omadata", "tableId"=>"mentions_test"}, "createDisposition"=>"CREATE_IF_NEEDED", "sourceFormat"=>"NEWLINE_DELIMITED_JSON"}}, "status"=>{"state"=>"DONE", "errorResult"=>{"reason"=>"accessDenied", "message"=>"Access Denied: File gs://omaload/mentions_94354.utf-8.bigquery: Access Denied"}, "errors"=>[{"reason"=>"accessDenied", "message"=>"Access Denied: File gs://omaload/mentions_94354.utf-8.bigquery: Access Denied"}]}, "statistics"=>{"startTime"=>"1358707905511", "endTime"=>"1358707905511"}} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T15:54:20.993

作业中的 google 存储文件似乎不公开：

```
$ gsutil cat gs://omaload/mentions_94354.utf-8.bigquery | head
GSResponseError:: status=403, code=None, reason=Forbidden. 
```

# php - 我无法在 mysql 中插入单词

> ID：14522748
> 
> 赞同：1
> 
> 时间：2013-01-25T13:27:59.047
> 
> 标签：php

```
if(isset($_POST['zodis'])) { 
strpos($_POST['zodis'], ' ');
if($pos > 0) {
    print '<h2> Only 1 word. </h2>';
} else {
        $query = "INSERT INTO `zodziai` (`id` ,`zodis` ,`date`)VALUES (NULL , '"$_POST['zodis']"',CURRENT_TIMESTAMP);";
        mysql_query($query) or die(mysql_error());

    }
} 
```

我在哪里做错了？我是 PHP 新手

表明

> `C:\wamp\www\php_mysql.php`解析错误：语法错误，第 19 行出现意外的 T_VARIABLE

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T13:33:10.930

```
$query = "INSERT INTO zodziai (id,zodis,date)VALUES (NULL, '".$_POST['zodis']."',".time().");"; 
```

你的 id 字段不是自动增量的吗？你的日期字段是什么类型的字段？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-25T13:33:12.853

你忘了`.`.

```
 $query = "INSERT INTO `zodziai` (`id` ,`zodis` ,`date`)VALUES (NULL , '" . $_POST['zodis'] . "',CURRENT_TIMESTAMP);"; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-25T13:43:20.283

您没有初始化`$pos`. 尝试这个 ：

```
$pos = strpos($_POST['zodis'], ' '); 
```

您还忘记了`.`查询中的连接运算符 ( )。

```
$query = "INSERT INTO `zodziai` (`id` ,`zodis` ,`date`)VALUES (NULL , '" . $_POST['zodis'] . "',CURRENT_TIMESTAMP);"; 
```

还要避免使用 mysql_ 函数，PHP 不鼓励使用 mysql_ 函数，并且 mysql_ 函数将很快被弃用，而是使用 mysqli 类或 PDO。

另一个建议，而不是`CURRENT_TIMESTAMP`在查询中发送，使用以下约束创建表字段

```
`date` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP 
```

然后传入`NULL`查询，这将自动将`date`相应行中的字段设置为`CURRENT_TIMESTAMP`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-25T13:36:40.570

如果混合使用字符串和变量，则应使用“.”。连接它们：

...VALUES (NULL, '".$_POST['zodis']."',CURRENT_TIMESTAMP)...

（注意 $_POST 变量前后的点 (.)）。

这就是我所看到的快速浏览，也许还有更多。

# python - 被调用者是否可以强制其调用者在 python 中返回？

> ID：14522757
> 
> 赞同：1
> 
> 时间：2013-01-25T13:28:35.783
> 
> 标签：python, introspection

被调用者是否可以强制其调用者在 python 中返回？如果是这样，这是一个好方法吗？它不违反*显式优于隐式。*[Python之禅](http://www.python.org/dev/peps/pep-0020/)那句话？

例子：

```
import inspect

class C(object):
    def callee(self):
        print 'in callee'
        caller_name = inspect.stack()[1][3]
        caller = getattr(self, caller_name)
        # force caller to return
        # so that "in caller after callee" gets never printed

        caller.return() # ???

    def caller(self):
        print 'in caller before calle'
        self.callee()
        print 'in caller after callee'

c = C()

c.caller()

print 'resume' 
```

输出：

```
in caller before callee
in callee
resume 
```

最后，感谢@Andrew Jaffe 关于*上下文管理器*的建议，我用一个简单的装饰器解决了它。

```
# In my real code this is not a global variable
REPORT_ERRORS = True

def error_decorator(func):
    """
    Returns Event instance with result of the
    decorated function, or caught exception.
    Or reraises that exception.
    """

    def wrap():
        error = None
        user = None

        try:
            user = func()
        except Exception as e:
            error = e
        finally:
            if REPORT_ERRORS:
                return Event(user, error)
            else:
                raise error 
    return wrap

@error_decorator
def login():

    response = fetch_some_service()

    if response.errors:
        # flow ends here
        raise BadResponseError

    user = parse_response(response)

    return user 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-25T13:32:20.177

What's wrong in returning a value from the callee, to be read by caller and thus behave accordingly?

instead of

```
caller.return() # ??? 
```

write

```
return False 
```

and in

```
def caller(self):
        print 'in caller before calle'

        rc = self.callee()
        if not rc:
             return
        print 'in caller after callee' 
```

~~and off course you can raise exception and catch it in the callee and behave accordingly or simply less it fall through~~

*Duplicate of mgilson*

Reason I would argue for Return Value based check

1.  `Explicit is better than implicit`
2.  被调用者不应控制调用者行为。这是一种糟糕的编程习惯。相反，调用者应该根据被调用者的行为改变其行为。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-25T13:31:01.727

从某种意义上说，你可以用异常来做到这一点......只是在最后引发一个异常，`callee`而不是在`caller`......你为什么要这样做？似乎有更好的方法来做你正在尝试的任何事情......

* * *

As far as creating a jump in the callee, it looks like that is impossible. From the [Data Model](http://docs.python.org/2/reference/datamodel.html) section on Frame objects (emphasis is mine)

> f_lineno is the current line number of the frame — writing to this from within a trace function jumps to the given line **(only for the bottom-most frame)**. A debugger can implement a Jump command (aka Set Next Statement) by writing to f_lineno.

# mootools - Mootools 覆盖淡入

> ID：14522772
> 
> 赞同：0
> 
> 时间：2013-01-25T13:29:50.017
> 
> 标签：mootools, mootools1.2, mootools-events

嗨，你如何让 div 在 mootools 中很好地淡入？

```
var el = $$('div.img_wrapper');

el.addEvents({
    mouseenter: function(){
        fade in div
    },
    mouseleave: function(){
        fade out div
    }
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T02:02:29.430

```
mouseenter: function(){
  this.fade('in');
}, 

//this can't be zero or the mouseenter won't fire
mouseleave: function(){
  this.fade(.001);   
} 
```

# mysql - PHP 类析构函数中的 mysql_query（无法建立到服务器的链接）

> ID：14522781
> 
> 赞同：2
> 
> 时间：2013-01-25T13:30:19.000
> 
> 标签：mysql, oop, class, destructor

通过阅读stackoverflow，我几乎解决了所有问题。但现在我有一个非常“特殊”的我无法解释。数小时的谷歌搜索和研究，但没有解决方案。

班级：

```
class Beitrag_Loeschen {
private $debug;
private $do_debug;

function __construct() {
    $this->do_debug = TRUE;
}

function __destruct() {
    if ($this->do_debug == TRUE) {
        mysql_query("INSERT INTO `seite_log` (`id`, `timestamp`, `benutzer_ip`, `benutzer_id`, `datei`, `referrer`, `fehler`, `kommentar`) VALUES (NULL, UNIX_TIMESTAMP(), '', 1, '', '', '', '')");
    }
}

private function _deleteDir($dir) { 
    // more code
}

// SQL-Query
private function _queryDelete($tabelle, $spalte, $id) {
    $query = "DELETE FROM `".sql($tabelle)."` WHERE `".sql($spalte)."`='".sql($id)."';";
    mysql_query($query);
    $this->debug .= $query."<br/>";
}
private function _queryDeleteKat($tabelle, $kat, $kat_id) {
    $query = "DELETE FROM `".sql($tabelle)."` WHERE `kat`='".sql($kat)."' AND `kat_id`='".sql($kat_id)."'";
    mysql_query($query);
    $this->debug .= $query."<br/>";
}
private function _seiteSuchbegriffe($ergebnis_typ, $ergebnis_id) {
    $query = "DELETE FROM `seite_suchbegriffe` WHERE `ergebnis_id`='".sql($ergebnis_id)."' AND `ergebnis_typ`='".sql($ergebnis_typ)."'";
    mysql_query($query);
    $this->debug .= $query."<br/>";
}

// Kommentare
function bewertungKommentar($id) {
    $this->_queryDelete('bewertungen_kommentare',   'id',               $id); // bewertungen_kommentare
}
function fotoKommentar($id) {
    $this->_queryDelete('fotos_kommentare',         'id',               $id); // fotos_kommentare
}
function rezeptKommentar($id) {
    $this->_queryDelete('rezepte_kommentare',           'id',               $id); // rezepte_kommentare
}

// Bewertung
function bewertung($id) {
    $this->_queryDelete('bewertungen_burger',           'id',               $id); // bewertungen_burger
    $this->_queryDelete('bewertungen_kommentare',   'bewertung_id',     $id); // bewertungen_kommentare
    // more code
}

// Foto
function foto($id) {
    $this->_queryDelete('fotos_kommentare',             'foto_id',          $id); // fotos_kommentare
    // more code
}

// Burger
function burger($id) {
    $this->_queryDelete('burger',                       'id',               $id); // burger
    $this->_queryDeleteKat('benutzer_aktionen',         'favorit_burger', $id); // benutzer_aktionen
    // more code
}

// Lokalität
function lokalitaet($id) {
    $this->_queryDeleteKat('seite_korrekturen',         'lokalitaet',       $id); // seite_korrekturen
    $this->_queryDeleteKat('seite_hits',                'lokalitaeten',     $id); // seite_hits
    // more code
}
} 
```

我的概念：如果你想，例如，删除一个位置，你必须从几个表中删除行。为此，我编写了这个小的 PHP 类。在删除这些东西时，在许多表中执行了许多 mysql 查询，因此我需要一种调试方法。

调试信息存储在 $debug 中。

```
$this->debug .= $query."<br/>"; 
```

最后，$debug 应该存储在数据库中（调用类后有一个“header（”Location：...“）”，所以我无法执行“echo”）。为此的数据库查询在析构函数中调用（信息：查询只是一个虚拟的。所以我可以避免查询语法没有问题）：

```
function __destruct() {
    if ($this->do_debug == TRUE) {
        mysql_query("INSERT INTO `seite_log` (`id`, `timestamp`, `benutzer_ip`, `benutzer_id`, `datei`, `referrer`, `fehler`, `kommentar`) VALUES (NULL, UNIX_TIMESTAMP(), '', 1, '', '', '', '')");
    }
} 
```

这个类是这样调用的：

```
$del = new Beitrag_Loeschen();
$del->bewertungKommentar($id);
//header("Location: ".$referer); 
```

问题：析构函数中似乎没有数据库连接，因为我一直收到这个错误：

```
Warning: mysql_query() [function.mysql-query]: Access denied for user ''@'localhost' (using password: NO) in /[...]/classes/beitrag_loeschen.inc.php on line 12
Warning: mysql_query() [function.mysql-query]: A link to the server could not be established in /[...]/classes/beitrag_loeschen.inc.php on line 12 
```

（第 12 行是析构函数中的 mysql_query）

我究竟做错了什么？类中的其他 mysql_query 运行良好。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T13:38:19.530

除非您明确地调用`__destruct()`函数或非常密切地处理对对象的引用并且确切地知道它何时被取消设置，否则无法保证何时`__destruct()`会被语言调用。到它被调用时，该语言已经释放了用于连接数据库的资源。`mysql_query()`尝试使用默认服务器参数创建新连接，但由于没有空白用户而失败。

要可靠地记录您的信息，您需要显式调用以运行查询。如果您依赖`__destruct()`于此，您可能总是会遇到一些与您遇到的问题类似的问题。

# java - -Xlint 在 java 中未选中

> ID：14522783
> 
> 赞同：0
> 
> 时间：2013-01-25T13:30:26.913
> 
> 标签：java, compilation, javac, unchecked

> **可能重复：**
> [是什么导致 javac 发出“使用未经检查或不安全的操作”警告](https://stackoverflow.com/questions/197986/what-causes-javac-to-issue-the-uses-unchecked-or-unsafe-operations-warning)

我收到以下警告。什么是 -xlint:unchecked。如果我在 build.xml 中包含 -xlint:unchecked，我会收到很多警告。

```
Note: Some input files use unchecked or unsafe operations.
    [javac] Note: Recompile with -Xlint:unchecked for details. 
```

如何解决这个问题。请帮忙

# vb.net - 使用 Visual Basic .net 下载间接链接文件

> ID：14522785
> 
> 赞同：-1
> 
> 时间：2013-01-25T13:30:39.783
> 
> 标签：vb.net, download

要使用 vb.net 从互联网下载文件，有几种方法可以使其正常工作，但问题是某些链接在下载时出现问题，我认为问题是链接不是直接的，所以无论如何下载带有间接链接的文件谢谢:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T23:26:10.717

`HttpWebClient.AllowAutoRedirect`允许自动重定向。但是，`AllowAutoRedirect`默认为 true，因此您可能需要查看代码中的其他位置。

# ruby - Rails、CanCan 管理所有和其他角色

> ID：14522791
> 
> 赞同：-1
> 
> 时间：2013-01-25T13:30:53.883
> 
> 标签：ruby, ruby-on-rails-3, cancan

```
class Ability
  include CanCan::Ability
  def initialize(user)
    @user = user || User.new

    can :manage, :all
    can :custom_action, User, role: 'admin'
  end
end 
```

并且在视野中

```
if can? :custom_action, @user
  SHOW SOMETHING 
```

如果总是显示“显示某些东西”，不明白为什么会发生这种情况。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T13:53:23.590

嗯，那是因为在你的能力等级中，你给了每个用户所有的权利。

您可能正在寻找这样的东西：

```
def initialize(user)
  @user = user || User.new

  can :manage, :all

  # When user is an admin, grant her extra privileges
  if @user.is_admin?
    can :custom_action
  end
end 
```

这样，您可以`can`有条件地定义能力（通过使用）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-26T19:59:10.383

解决方案是：

类能力包括 CanCan::Ability def initialize(user) @user = user || 新用户

```
can :manage, :all
cannot :custom_action, User, role: 'admin' 
```

结束结束

鉴于：

```
if can? :custom_action, @user

return 
  user = true
  admin = false 
```

这不是完美的解决方案，但它的作品

# selenium - Capybara、Selenium 和 Redactor 富文本编辑器

> ID：14522795
> 
> 赞同：5
> 
> 时间：2013-01-25T13:31:12.790
> 
> 标签：selenium, rspec, capybara, redactor

我遇到了 Capybara 和 Selenium 的一个有趣问题。我有一些 Capybara 请求规范，需要在完成表单时启用 javascript。其中一种形式是使用 Redactor 富文本编辑器的文本区域。

```
<div class="control-group">
<%= f.label :description, "Description", class: "control-label" %>
    <div class="controls">
        <%= f.text_area :description, rows: 10, class: "redactor"%>
    </div>
</div> 
```

当测试运行并触发 Selenium（在 FF 和 Chrome 驱动程序中）时，Selenium 在以下命令上失败：

```
`fill_in "Description", with: "some description"` 
```

它返回的错误是：

```
Selenium::WebDriver::Error::InvalidElementStateError:
   Element is not currently interactable and may not be manipulated 
```

Selenium 似乎无法再识别富文本编辑器/文本区域。如果我删除`class="redactor"`which 是触发 Redactor JS 针对描述文本区域呈现的原因，它可以正常工作。

所以我的问题是，1\. 是否有解决方法来填写？2\. 或者，我可以以某种方式禁用编辑器 js 只是为了这个测试？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-08-28T15:49:09.513

您可能需要考虑使用 Redactor 的 API 来填充编辑器字段：

```
def fill_in_redactor(options)
  if options[:in]
    node = "('#{options[:in]}')"
  else
    node = "('.redactor')"
  end

  page.execute_script( "$#{node}.redactor('set', '#{options[:with]}')" )

end 
```

如果没有传递 :in 选项，它将找到第一个具有 .redactor 类的字段。否则，它假定 :in 值是有效的 css finder 值。

这避免了必须手动填写隐藏的 text_area 字段。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-06-17T15:00:59.487

正如 narath 提到的，Capybara 现在支持 contenteditable div。我能够写：

`find('.redactor_editor').set('text')`

由于某种原因，fill_in 对我不起作用。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-25T20:45:09.753

看起来水豚将包括填充内容可编辑 div 的功能（请参阅[https://github.com/jnicklas/capybara/pull/911](https://github.com/jnicklas/capybara/pull/911)）。

同时，我使用以下内容：（您的场景需要 :js => true ）

```
# fill_in_redactor :in => find(".text1"), :with => "Hello world"
def fill_in_redactor(options)
  if options[:in]
    parent = "('#{options[:in]}').find"
  else
    parent = ""
  end

  page.execute_script( "$#{parent}('.redactor_editor').html('#{options[:with]}')" )
  page.execute_script( "$#{parent}('.redactor').html('#{options[:with]}')" )
end

def no_redactor
  page.execute_script("$('.redactor').destroyEditor();");
end 
```

# svn - 存储库根目录的实时迁移

> ID：14522796
> 
> 赞同：1
> 
> 时间：2013-01-25T13:31:13.180
> 
> 标签：svn, visualsvn-server

我们的 VisualSVN 服务器 (SE) 当前将其存储库存储在“C:\Repositories”中，但鉴于我们存储库的增长，C: 驱动器开始填满。我们希望将整个存储库根目录移动到服务器中的第二个驱动器 (D:)，在可预见的未来它有足够的空间。

我发现[这个问题](https://stackoverflow.com/questions/1107620/how-to-change-where-subversion-repositories-are-stored)告诉我如何更改根目录，但是由于该问题涉及全新安装，因此不必担心现有数据的保存。经过一些研究，我发现有几种方法可以保留现有存储库：

*   资源管理器中的直接文件副本：应该保留所有数据，但我不愿信任 Windows 来完成这项任务
*   `svnadmin dump`到转储文件，然后在新位置加载转储文件
*   `svnadmin hotcopy`存储库到新位置

我想听听您对哪种方法更可取的意见。如果它足够强大，我更喜欢 hotcopy 方法，因为转储所有存储库需要相当长的时间。转储方法在[此处](https://stackoverflow.com/questions/1516140/upgrading-subversion-server-from-1-5-5-to-1-6-5-dump-upgrade-reload-exact-ste)进行了描述，但似乎包括对我的情况而言不必要的步骤，因为我将所有内容都保存在同一台服务器上。

此外，我想问一下我们将如何最好地进行此迁移以将停机时间降至最低。我想防止用户在复制文件时提交更改。我可以在更改根目录和复制文件时关闭 SVN 服务吗？

最后，我想借此机会将服务器从 2.5.2 升级到 2.5.8。我应该在文件复制后这样做吗？我应该先重新启动服务，然后再次将其关闭，以便它处理并检查移动的存储库吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T15:35:47.230

我建议您使用`svnadmin hotcopy`每个存储库或`xcopy /E /H C:\Repositories D:\Repositories`. 不要忘记复制授权文件（authz、authz-windows 和 htpasswd）。您必须在迁移之前停止 VisualSVN Server。

`svnadmin dump`不是必需的，正如你提到的那样非常耗时的过程。

最好在存储库迁移和需要重新配置后升级 VisualSVN 服务器。在某些升级中，VisualSVN 服务器需要访问存储库文件夹以进行升级。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-25T15:50:47.387

这些是您可以使用的一些步骤。使用此 python 脚本将使您的任务更轻松，并在将来对您的存储库进行每日备份时受益。

1.  在 VisualSVNServer 上，转到属性并将存储库根更改为您的新位置。假设“D:\Repositories”。
2.  下载 Python 2.7（如果您尚未安装它）。
3.  下载“热备份.py”
4.  从命令窗口执行以下操作。

    ```
    hot-backup.py C:\Repositories\<YourRepoName>  D:\Repositories\<YourRepoName> 
    ```

5.  升级您的 SVN 版本

这应该可以解决问题。祝你好运 ！！！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-25T16:30:53.730

*   Xcopy SVN-Parent 到新位置
*   （手动）编辑 VisualSVN 服务器的 httpd.conf，`SVNParentPath`参数
*   从它的 MMC 小程序重新启动 VisualSVN 服务器

# java - 密钥库加载

> ID：14522799
> 
> 赞同：4
> 
> 时间：2013-01-25T13:31:24.200
> 
> 标签：java, ssl, keystore

我想知道以下 java 中的等价物是什么：

```
-Djavax.net.ssl.trustStore=keystore.jks -Djavax.net.ssl.keyStore=keystore.jks
-Djavax.net.debug=ssl -Djavax.net.ssl.keyStorePassword=test JavaFile 
```

我想加载密钥库，而不是从命令行将其作为参数发送。我一直在与：

```
private TcpLink createSSL() {
        KeyStore keyStore = null;
        TrustManagerFactory tmf = null;
        SSLContext ctx = null;
        SSLSocket socket = null;
        TcpLink smscLink = null;

        try {
            keyStore = KeyStore.getInstance(KeyStore.getDefaultType());
            LOGGER.info("Got keystore");
            keyStore.load(new FileInputStream("/root/keystore.jks"), "test".toCharArray());
            LOGGER.info("Loaded keystore");
            tmf = TrustManagerFactory.getInstance(TrustManagerFactory.getDefaultAlgorithm());
            tmf.init(keyStore);
            LOGGER.info("Inited keystore");
            ctx = SSLContext.getInstance("TLSv1");
            ctx.init(null, tmf.getTrustManagers(), null);
            SSLSocketFactory factory = ctx.getSocketFactory();
            socket = (SSLSocket)factory.createSocket("100.100.201.189", 8807);
            LOGGER.info("Got socket");
            smscLink = new TcpLink(socket);

            return smscLink;

        } catch (KeyStoreException e) {
            LOGGER.error("Key store exception : " + e);
        } catch (NoSuchAlgorithmException e) {
            LOGGER.error("NoSuchAlgorithmException : " + e);
        } catch (CertificateException e) {
            LOGGER.error("CertificateException : " + e);
        } catch (FileNotFoundException e) {
            LOGGER.error("FileNotFoundException : " + e);
        } catch (IOException e) {
            LOGGER.error("FileNotFoundException : " + e);
        } catch (KeyManagementException e) {
            LOGGER.error("KeyManagementException : " + e);
        } catch (Exception e) {
            LOGGER.error("Exception : " + e);
        }
        return null;
    } 
```

但我得到：

```
javax.net.ssl.SSLException: Connection has been shutdown: javax.net.ssl.SSLHandshakeException: Received fatal alert: handshake_failure
        at com.sun.net.ssl.internal.ssl.SSLSocketImpl.checkEOF(SSLSocketImpl.java:1293)
        at com.sun.net.ssl.internal.ssl.AppInputStream.read(AppInputStream.java:65)
        at java.io.BufferedInputStream.fill(BufferedInputStream.java:218) 
```

欢迎任何想法！

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T13:46:39.910

您可以这样设置系统属性：

```
System.setProperty("javax.net.ssl.keyStore", '/path/to/keystore.jks');
System.setProperty("javax.net.ssl.keyStorePassword", 'your-password-here'); 
```

它们将在系统范围内使用（在此 JVM 实例中），因此您可能希望在初始化时执行此操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-04T07:30:10.957

它使用这段代码工作：

```
KeyManagerFactory kmf =  
    KeyManagerFactory.getInstance(KeyManagerFactory.getDefaultAlgorithm());
KeyStore keyStore = KeyStore.getInstance(KeyStore.getDefaultType());
keyStore.load(this.getCertificateContent(), "test".toCharArray());
kmf.init(keyStore, "test".toCharArray());

TrustManagerFactory tmf =
    TrustManagerFactory.getInstance(TrustManagerFactory.getDefaultAlgorithm());
tmf.init(keyStore);
SSLContext ctx = SSLContext.getInstance("TLSv1");
ctx.init(kmf.getKeyManagers(), tmf.getTrustManagers(), null);
SSLSocketFactory factory = ctx.getSocketFactory();
socket = (SSLSocket)factory.createSocket("100.125.100.1", 8775); 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2015-07-23T13:14:48.983

如果您愿意，这里有一个 API 可以轻松创建 SSLSocket 和 SSLServerSocket：

[https://github.com/gpotter2/SSLKeystoreFactories](https://github.com/gpotter2/SSLKeystoreFactories)

它不需要任何其他 jars.... 只需获取文件并像这样使用它们：

```
SSLSocket s = SSLSocketKeystoreFactory.getSocketWithCert(ip, port, Main.class.getResourceAsStream("/mykey.jks"), "password") 
```

或者：

```
SSLServerSocket s = SSLServerSocketKeystoreFactory.getSocketWithCert(port, Main.class.getResourceAsStream("/mykey.jks"), "password") 
```

这更容易使用:)

# php - 如何在 Smarty 模板中渲染 Silex 表单？

> ID：14522800
> 
> 赞同：1
> 
> 时间：2013-01-25T13:31:24.210
> 
> 标签：php, symfony, smarty, silex

我只是停留在一点。

在 Smarty 模板中呈现表单。好吧，smarty 在我的 silex 项目中配置得很好。

这是我的控制器类中的代码。

```
$loginForm = $app['form.factory']
            ->createBuilder(new Form\UserLogin())
            ->getForm();

$app['smarty']->assign('loginForm', $loginForm->createView());

return $app['smarty']->render('login.tpl'); 
```

这是我的 tpl 文件中的代码

```
{block name="headline"}
<h1>User Login</h1>
{/block}

{block name="content"}
<div>
    {form_widget(loginForm)}
</div>
{/block} 
```

我得到了这个例外。

```
SmartyCompilerException: 
Syntax Error in template "/home/Symfony/demo/App/View/login.tpl" on line 8
"{form_widget(loginForm)}" unknown function "form_widget" 
```

编辑：

好的，我发现了问题，但没有得到解决方案。

以下是 SmartyServiceProvider 类。

```
<?php

namespace App\ServiceProvider;

use Silex\Application;
use \Symfony\Component\HttpFoundation\Request;
use Silex\ServiceProviderInterface;
use App\Classes\Smarty;
use NoiseLabs\Bundle\SmartyBundle\Form\SmartyRendererInterface;
use \NoiseLabs\Bundle\SmartyBundle\Extension\AbstractExtension;
use \NoiseLabs\Bundle\SmartyBundle\Extension\FormExtension;
use \NoiseLabs\Bundle\SmartyBundle\Form;

class SmartyServiceProvider implements ServiceProviderInterface
{

    public function register(Application $app)
    {
        $app['smarty.auto-render'] = true;
        $app['smarty.extension'] = $app->protect(
            function (AbstractExtension $extension, Smarty $smarty = null) use ($app) {
                if ($smarty == null) {
                    $smarty = $app['smarty'];
                }
                /** @var $plugin \NoiseLabs\Bundle\SmartyBundle\Extension\Plugin\AbstractPlugin */
                /** @var $filter \NoiseLabs\Bundle\SmartyBundle\Extension\Filter\AbstractFilter */
                foreach ($extension->getPlugins() as $plugin) {
                    //print $plugin->getName() . " | " . $plugin->getType() . "<br>";
                    $smarty->registerPlugin($plugin->getType(), $plugin->getName(), $plugin->getCallback());
                }
                foreach ($extension->getFilters() as $filter) {
                    $smarty->registerFilter($filter->getType(), $filter->getCallback());
                }
            }
        );
        $app['smarty.extensions'] = $app->protect(
            function (array $extensions, Smarty $smarty = null) use ($app) {
                foreach ($extensions as $extension) {
                    $app['smarty.extension']($extension, $smarty);
                }
            }
        );
        $app['smarty'] = $app->share(
            function () use ($app) {

                $app['directory.smarty.plugins'] = $app['directory.root.app'] . '/Classes/Smarty/Plugins';

                $smarty = isset($app['smarty.instance']) ? $app['smarty.instance'] : new Smarty(
                    $app,
                    isset($app['smarty.primary.template.dir'])
                            ? $app['smarty.primary.template.dir']
                            : $app['directory.root.view'],
                    false
                );

                if (isset($app["smarty.options"]) && is_array($app["smarty.options"])) {
                    foreach ($app["smarty.options"] as $smartyOptionName => $smartyOptionValue) {
                        $smarty->$smartyOptionName = $smartyOptionValue;
                    }
                }

                $smarty->assign("app", $app);

                if (isset($app['smarty.configure'])) {
                    $app['smarty.configure']($smarty);
                }

                $extensions = [];
                //$extensions[] = new \NoiseLabs\Bundle\SmartyBundle\Extension\FormExtension();
                $extensions[] = new \NoiseLabs\Bundle\SmartyBundle\Extension\RoutingExtension($app['url_generator']);
                $extensions[] = new \App\Classes\Smarty\HookExtension();
                $app['smarty.extensions']($extensions, $smarty);

                return $smarty;
            }
        );
    }

    public function boot(Application $app)
    {
    }

} 
```

在那个类中，我在这里加载了 SmartyBundle 的扩展。在这里，我必须加载 FormExtensions。

```
$extensions = [];
$extensions[] = new \NoiseLabs\Bundle\SmartyBundle\Extension\FormExtension('Don't know how to get SmartyRendererInterface instance here');
$extensions[] = new \NoiseLabs\Bundle\SmartyBundle\Extension\RoutingExtension($app['url_generator']);
$extensions[] = new \App\Classes\Smarty\HookExtension();
$app['smarty.extensions']($extensions, $smarty); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-03-25T15:20:36.820

表单小部件的正确语法是：

```
{form_widget form=$loginForm} 
```

从您的示例中，不清楚 $loginForm->createView() 的输出，并且您缺少通常围绕 Form 小部件的表单标签（ ie ）。如果 createView 包含这些，则不需要表单小部件，只需将整个表单 HTML 输出为：

```
{$loginForm} 
```

# tfs - 使用没有映射到本地文件夹的 TFS 源代码管理文件夹

> ID：14522801
> 
> 赞同：-3
> 
> 时间：2013-01-25T13:31:32.330
> 
> 标签：tfs, alm

我的源代码管理文件夹中有很多项目，我可以从服务器存储库工作而不映射本地文件夹吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T15:42:27.880

不，但您可以将本地工作区配置为仅映射到您感兴趣的文件夹。您还可以创建多个工作区。

例如：

1.  创建名为“Project A”的工作区
2.  创建从`$/TeamProject/Stuff/MoreStuff/ProjectA`到的映射`C:\Code\ProjectA`

重复您感兴趣的其他项目。

您现在可以选择要在 Source Control Explorer（和 Pending Changes）中使用的工作区。当您在工作区上执行“获取最新”时，您只会获得已映射的文件。

# algorithm - 使用线段树查找重叠区间的总长度？

> ID：14522808
> 
> 赞同：5
> 
> 时间：2013-01-25T13:31:52.900
> 
> 标签：algorithm, tree, discrete-mathematics

我们有一些区间，例如 [1;4] [7;13] [9;14] 输入应该返回 3+6+1=10。当可以动态插入或删除间隔时，有什么方法可以使用线段树来查找这些间隔的总长度？

PS：我想在不使用段树的情况下这样做，但时间复杂度并不让我满意。

先感谢您

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-05-05T20:56:46.013

Kobi/Maureinik 的答案非常接近，但我必须为 maxEnd 添加一个变量并检查 differenceFromPrevious 是否为非负数。该算法仍然假设范围在开始元素上排序（即数组[i，0]）

```
int totalInterval = array[0, 1] - array[0, 0];
int maxEnd = array[0, 1];
for(int index = 1; index < array.length ; index++) {
  int currentIntrval = array[index, 1] - array[index, 0];
  int differnceFromPrevious = array[index, 1] - maxEnd;
  if(differenceFromPrevious >= 0) {
    totalInterval += (currentIntrval > differnceFromPrevious) ? differnceFromPrevious : currentIntrval;
  }
  maxEnd = (maxEnd >= array[index, 1]) ? maxEnd : array[index, 1];
}
return totalInterval; 
```

编辑：修复了无效的原始 totalInterval 逻辑的意外副本。如果 differenceFromPrevoius < 0，则应不理会 totalInterval。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-01T17:05:56.167

假设间隔存储在数组 [m,n] 中。另一个假设是数组已排序。

您需要做的就是找到较小的差异：

```
 int totalIntervales = 0;
 for(int index = 0; index < array.length ; index++)
 {
     int currentIntrval = array[index, 1] - array[index, 0];
     int differnceFromPrevious = array[index, 1] - array[index- 1, 1]
     totalIntervale += currentIntrval  > differnceFromPrevious ? differnceFromPrevious : currentIntrval;
 }
 return totalIntervale; 
```

只需小心处理 0 位置。

# regex - Regexf 或出现不超过一次的字符

> ID：14522812
> 
> 赞同：0
> 
> 时间：2013-01-25T13:32:11.217
> 
> 标签：regex, character, comma

我试图避免一个字符在字符串中出现多次。在这种情况下，我需要一个逗号在一堆数字中只出现一次。

正确匹配：

```
,111111
11111,1111
11111, 
```

不正确的匹配：

```
1111,,11111
11,111,111 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-25T13:45:36.377

**尝试这个**

```
(?im)^[0-9]*,[0-9]*$ 
```

或者，***更准确地说***

```
(?im)^([0-9]*,[0-9]+|[0-9]+,[0-9]*)$ 
```

**解释**

```
<!--
(?im)^([0-9]*,[0-9]+|[0-9]+,[0-9]*)$

Match the remainder of the regex with the options: case insensitive (i); ^ and $ match at line breaks (m) «(?im)»
Assert position at the beginning of a line (at beginning of the string or after a line break character) «^»
Match the regular expression below and capture its match into backreference number 1 «([0-9]*,[0-9]+|[0-9]+,[0-9]*)»
   Match either the regular expression below (attempting the next alternative only if this one fails) «[0-9]*,[0-9]+»
      Match a single character in the range between “0” and “9” «[0-9]*»
         Between zero and unlimited times, as many times as possible, giving back as needed (greedy) «*»
      Match the character “,” literally «,»
      Match a single character in the range between “0” and “9” «[0-9]+»
         Between one and unlimited times, as many times as possible, giving back as needed (greedy) «+»
   Or match regular expression number 2 below (the entire group fails if this one fails to match) «[0-9]+,[0-9]*»
      Match a single character in the range between “0” and “9” «[0-9]+»
         Between one and unlimited times, as many times as possible, giving back as needed (greedy) «+»
      Match the character “,” literally «,»
      Match a single character in the range between “0” and “9” «[0-9]*»
         Between zero and unlimited times, as many times as possible, giving back as needed (greedy) «*»
Assert position at the end of a line (at the end of the string or before a line break character) «$»
--> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-25T13:55:12.287

如果您想正确包含 1111，请使用以下内容：

```
^[0-9]*,?[0-9]*$ 
```

如果没有...使用：

```
^[0-9]*,[0-9]*$ 
```

解释：

```
^ = start of string  
[0-9]* = zero numbers or multiple numbers  
,? = a comma zero or 1 time  
,(without the ? following) = a comma must be here 
$ = the end of string 
```

检查表达式的好网站
[http://regexpal.com/](http://regexpal.com/)
（确保检查顶部的“^$ match at line breaks”并在每行末尾按 Enter）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-25T14:05:59.687

在 Java 中，可以使用以下方法（不使用正则表达式）来完成，因为我们只需要检查一个字符。

```
private static boolean checkValidity(String str, char charToCheck) {
    int count = 0;
    char[] chars = str.toCharArray();
    for (char ch : chars) {
        if (ch == ',' && ++count > 1) {
            return false;
        }
    }

    return true;
} 
```

按如下方式使用它：

```
public static void main(String args[]) {
    System.out.println(checkValidity("111,111,111", ','));
    System.out.println(checkValidity("111,,111", ','));
    System.out.println(checkValidity("111,111", ','));
} 
```

输出将是：

```
false
false
true 
```

根据您的要求。

# frameworks - yii 中其他模型字段的必填字段

> ID：14522813
> 
> 赞同：3
> 
> 时间：2013-01-25T13:32:13.933
> 
> 标签：frameworks, yii, validationrules

我需要在第一个模型中存储一条记录。它有大约 10 个字段。现在，我需要为我存储在 SECOND 模型中的一个字段应用所需的规则，并且我从第三个模型中获取该字段的这些值。（它是一个下拉字段）

如何在 yii 中强制填写此字段？

任何人都可以帮忙吗..

非常感谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T23:14:19.497

您可以向模型添加其他属性和规则。您不必只使用与数据库表中的字段直接相关的属性。让我们看一个基本的例子。您有一个用户（用户）表，其中包含以下字段：

*   ID
*   电子邮件
*   密码

并且您有另一个存储用户配置文件 (UserProfile) 信息的表，其结构如下：

*   ID
*   用户身份
*   国家

当用户创建他们的帐户时，您将拥有一个捕获他们信息的表单。您的用户模型将具有如下规则：

```
array('email, password', 'required'),
array('email', 'unique', 'message'=>'Email already in use'),
... 
```

您可以将**国家**/地区的属性添加到您的用户模型中，如下所示：

```
class User extends CActiveRecord {
    public $country;
    ... 
```

然后在您的规则中，您可以添加新属性：

```
array('email, password, country', 'required'),
array('email', 'unique', 'message'=>'Email already in use'),
... 
```

country 属性现在将成为您的 User 模型的一部分。您现在可以将其添加到您的表单中：

```
<?php echo $form->dropDownList($model,'country',CHtml::listData(Country::model()->findAll(),'id','country_name'),array('empty'=>'-- select a country --')); ?> 
```

现在在您提交表单时，该`$model->validate()`方法将验证国家/地区字段。您可以将其手动保存到您的第二个模型（UserProfile），例如：

```
if(isset($_POST['User'])){
   if ($model->validate()){
       $user_profile = new UserProfile;
       $user_profile->user_id = $model->id;
       $user_profile->country = $model->country;
       $user_profile->save();
      ... 
```

希望这能回答你的问题。

# mysql - 如何执行涉及两个表连接的MySQL查询

> ID：14522814
> 
> 赞同：1
> 
> 时间：2013-01-25T13:32:15.987
> 
> 标签：mysql, sql, select, join

我在数据库中有两个表。

第一个表`books`有字段*number* ,*title*, *subject area* , *author*。
其他表`borrowed_items`有字段 *item_number* ， *user_id* ，*issue date*和*return date*。

如何进行查询以查找学科领域为“物理”且被借阅的书名，即存在于借阅项目表中？

borrowed_items 表中的“item_number”字段对应于“books”表中的“number”字段。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T13:35:04.807

```
SELECT  a.*, b.*       -- you can select your desired columns here
FROM    books a
        INNER JOIN borrowed_items b
            ON a.`number` = b.item_number
WHERE   a.`subject area` = 'Physics' 
```

要进一步了解有关联接的更多信息，请访问以下链接：

*   [SQL 连接的可视化表示](http://www.codeproject.com/Articles/33052/Visual-Representation-of-SQL-Joins)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T13:34:49.417

```
SELECT books.title 
FROM   books JOIN borrowed_items ON borrowed_items.item_number = books.number
WHERE  books.`subject area` = 'Physics' 
```

# castle-windsor - Nuget，温莎城堡客户资料与完整资料

> ID：14522815
> 
> 赞同：0
> 
> 时间：2013-01-25T13:32:19.890
> 
> 标签：castle-windsor, log4net, nuget

我正在尝试将 Castle Windsor 与 Log4Net 设施一起使用。我已经通过 Nuget 安装了这些软件包。

这样做的要求是使用完整配置文件 Castle.LoggingFacility。Nuget 引用了客户端配置文件版本。

如何强制 Nuget 安装完整配置文件版本？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T20:30:29.483

我可能错了，但这听起来像是您项目中目标框架设置的问题：要让 Castle.Windsor 工作，它必须设置为`.NET Framework 4`而不是`.NET Framework 4 Client Profile`.

您可以通过打开项目属性、选项卡应用程序（在 Visual Studio 中）或仅编辑项目文件来配置它。

如果这毕竟是关于包的版本，那么通常使用 NuGet 你可以附加一个标志`install-package Castle.Windsor -version 2.5.3`来指定要安装哪个，但是当涉及到`Castle.LoggingFacility`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-04T10:23:31.383

我之前遇到了同样的问题，我认为你应该检查你的`packages.config`文件。可能有`targetFramework="net40-client"`，

它指向`NUGet`目录`packages\Castle.LoggingFacility.3.2.0\lib\net40-client`。

只需将其更改为`net40`，一切就完成了。

# c# - SqlDependency 依赖_OnChange 信息“查询”

> ID：14522820
> 
> 赞同：2
> 
> 时间：2013-01-25T13:32:49.167
> 
> 标签：c#, .net, sqldependency

我有一个非常令人沮丧的问题。我的 .net 4 应用程序已成功使用该`SqlDependency`对象一段时间来接收来自 SQL 服务器的 INSERT 或 UPDATE 通知。

然而，它接收通知的数据库刚刚更新（它是第 3 方应用程序的后端，所以我不知道更新需要什么），现在当我重新启动我的`SqlDependency`应用程序时，它的行为不正常。在`StartSQLDependency()`方法期间，这一行触发了`dependency_OnChange`事件：

```
using (SqlDataAdapter adapter = new SqlDataAdapter(_SqlCommand))
    adapter.Fill(_datatable); 
```

与`SqlNotificationEventArgs`：

```
e.Info "Query"
e.Source "Statement"
e.Type "Subscribe" 
```

以前我只见过：

```
e.Info "Update" or "Insert"
e.Source "Data"
e.Type "Change" 
```

任何人都可以建议我在数据库中所做的更改导致这种情况吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-12-10T13:49:14.143

我知道这是旧的，但对于后代......

在尝试研究 SqlDependency 触发器时，我遇到了一个[CodeProject](http://www.codeproject.com/Articles/12335/Using-SqlDependency-for-data-change-events)，它说带有这些参数的事件表明用于通知的查询不正确（大约在文章的一半）。

Microsoft 有[一篇](http://msdn.microsoft.com/library/ms181122.aspx)关于受支持的通知语句（适用于 SQL Server 2008）以及如何正确构建它们以避免此错误事件的文章。

# wcf - 使用 byte[] 的 WCF 服务方法

> ID：14522823
> 
> 赞同：1
> 
> 时间：2013-01-25T13:32:52.290
> 
> 标签：wcf, c#-4.0, memory-management

我有一个用 C# 编写的 WCF 服务，并作为 Windows 服务托管。大多数客户端的关键和广泛使用的方法如方法签名所示。

公共字符串 storeDocument(byte[] 文档)

byte[] 在存储到数据库之前被传递给几个共享方法。

如何清理内存？

由于这个方法被很多客户端调用并且被广泛使用，而且我们最近注意到这个服务在服务器上的内存使用量是 60 到 100 MB，CPU 使用率有时会达到 80%。

我想知道有什么方法可以确保它不使用那么多内存。

请帮忙。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T13:49:11.757

WCF 还支持流式传输。如果您使用大量数据，也许这是一个更好的解决方案。请参阅[http://msdn.microsoft.com/en-us/library/ms733742.aspx](http://msdn.microsoft.com/en-us/library/ms733742.aspx)

# java - 具有对称结果的 HashMap 上的双重迭代（跳过冗余情况）

> ID：14522824
> 
> 赞同：1
> 
> 时间：2013-01-25T13:32:58.993
> 
> 标签：java, hashmap, double, iteration, symmetric

我有一个 LinkedHashMap，我正在对其进行双重迭代，如下面的代码所述：

```
LinkedHashMap<Integer,Integer> nmResultMap = getResultMap();
float[][] results = new float[nmResultMap.size()][nmResultMap.size()];

    for (Entry<Integer,Integer> e :nmResultMap.entrySet()){
        for (Entry<Integer,Integer> t :nmResultMap.entrySet()){

            results[e.getValue()][t.getValue()] = doSomthng(e.getKey(),t.getKey());
        }
    } 
```

这很好用，但由于结果是对称`doSomthng(e.getKey(),t.getKey())==doSomthng(t.getKey(),e.getKey())`的（数组：

```
for (int i  =0;i<array.length();i++){ 
    for (int j=i+1;j<array.length();j++){
        doSomthng(array[i][j]);
    }
} 
```

感谢您的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T13:40:34.180

将 entrySet 转换为数组，循环遍历这个数组：

```
Entry<Integer,Integer> entries = 
    nmResultMap.entrySet().toArray(new Entry<Integer,Integer>[0]); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-26T13:39:59.670

通过我正在使用的 JB Nizet 答案激励：

```
for (Entry<Integer,Integer> entry:h.getResultMap().entrySet()){
        nmResultList.add(entry);
    }
    float[][] results = new float[nmResultList.size()][nmResultList.size()];
    for (int i=0;i<nmResultList.size();i++){
        for (int j =i+1; j<nmResultList.size();j++){

            results[nmResultList.get(i).getValue()][nmResultList.get(j).getValue()] = doSomthng(h.data[nmMap.get(nmResultList.get(i).getKey())], h.data[nmMap.get(nmResultList.get(j).getKey())]);
        }
    } 
```

这正是我想要的，非常感谢您的帮助。

# objective-c - Objective-C ...为什么 if 语句不起作用？

> ID：14522826
> 
> 赞同：-4
> 
> 时间：2013-01-25T13:33:02.173
> 
> 标签：objective-c, cocoa

```
#import <Foundation/Foundation.h>

@interface Calculator : NSObject

@property int numerator, denominator;

-(void) print;
-(double) convertToNum;
@end 
```

* * *

```
#import "Calculator.h"

@implementation Calculator

@synthesize numerator, denominator;

-(void) print
{
    NSLog(@"%i/%i", numerator, denominator);
}

-(double) convertToNum
{

    if (denominator != 0)
    {
        return (double) numerator / denominator;
    }
    else
    {
        return 25.68;
    }
}
@end 
```

* * *

```
#import <Foundation/Foundation>
#import "Calculator.h"

int main(int argc, const char * argv[])
{

    Calculator *myCalc = [[Calculator alloc] init];

    @autoreleasepool
    {
        //int numerator, denominator;
        //NSLog(@"Enter two numbers...");
        //scanf("%i %i", &numerator, &denominator);

        [myCalc setNumerator: 8];
        [myCalc setDenominator: 0];
        NSLog(@"The value of myFraction is: ");

        [myCalc convertToNum];
        [myCalc print];
    }
    return 0;
} 
```

由于某种原因，它总是将其作为分数返回。我将它设置为 8 和 0 只是为了举例，它返回 8/0 而不是我选择的随机数来检查 else 是否正常工作。任何帮助都会很棒。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T17:14:24.347

您的`convertToNum`方法*返回结果*，但不会更改对象内的任何状态。因此，对 print 的调用会`print`打印出它所做的事情，因为从中返回的值`convertToNum`被完全忽略了。

将您更改`print`为：

```
-(void) print
{
    NSLog(@"%i/%i = %f", numerator, denominator, [self convertToNum]);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-25T13:35:56.157

在您的打印方法中，您只能以这种方式打印它：

按照代码中的建议进行更改

```
-(void) print
{
    //NSLog(@"%i/%i", numerator, denominator);
    NSLog(@"%f", numerator/denominator);
} 
```

* * *

这种方法有什么`[myCalc convertToNum];`价值，但你正在丢弃它！！！

您应该将其用作：

```
double value=[myCalc convertToNum];
[self print:value]; 
```

然后将其发送`value`到`print`

```
-(void) print:(double)value{
        NSLog(@"%f", value);
} 
```

# php - PHP OOP：类中的重复代码

> ID：14522831
> 
> 赞同：0
> 
> 时间：2013-01-25T13:33:17.863
> 
> 标签：php, mysql, sql

我有一个带有两种方法的 PHP 类。一个连接到 MySQL 数据库进行输出，另一个连接到 MySQL 数据库进行输入。

我的问题是，对于这两个函数，我重复了连接数据库的代码。有什么更好的方法可以让类中的第三个函数连接到数据库并让其他两个函数调用该函数来建立连接，而不是重复两次代码？我是一名 PHP n00b，试图改进我的 OOP 编码。请注意我是如何连接到数据库两次的——使用完全相同的代码：

```
class output_mysql {
var $db_name = 'database';
var $db_username = 'name';
var $db_password = 'mypassword';

function print_table_cell($tbl_name, $colm_name, $array_index_num) {
    try {
        $pdo = new PDO("mysql:host=localhost;dbname=$this->db_name", $this->db_username, $this->db_password);
        $pdo->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
    }
    catch (PDOException $e) {
        $error = 'Unable to connect to the database server.';
        include 'output_mysql_error.php';
        exit();
    }
    try {
        $sql = "SELECT $colm_name FROM $tbl_name";
        $result = $pdo->query($sql);
    }
    catch (PDOException $e) {
        $error = 'Error fetching content: ' . $e->getMessage();
        include 'output_mysql_error.php';
        exit();
    }
    while ($row = $result->fetch()) {
        $all_content[] = $row["$colm_name"];
    }
    echo $all_content[$array_index_num];
}

function update_content($tbl_name, $colm_name, $error_message_text, $id_num) {
    try {
        $pdo = new PDO("mysql:host=localhost;dbname=$this->db_name", $this->db_username, $this->db_password);
        $pdo->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
    }
    catch (PDOException $e) {
        $error = 'Unable to connect to the database server.';
        include 'output_mysql_error.php';
        exit();
    }
    try {
        $sql = 'UPDATE website_content SET
            content = :content,
            date_added = CURDATE()
            WHERE id = :id';
    $s = $pdo->prepare($sql);
    $s->bindValue(':content', $error_message_text);
    $s->bindValue(':id', $id_num);
    $s->execute();
    }
    catch (PDOException $e) {
        $error = 'Error: ' . $e->getMessage();
        include 'output_mysql_error.php';
        exit();
    }
}
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-25T13:40:03.550

这个问题被标记为 [oop]，但其中的代码与 OOP 相差甚远。

你的方法做得太多了。您应该做的是将数据库连接注入到`output_mysql`类的构造函数中（顺便说一句，这是一个可怕的名字）。

```
namespace App\Page;

class Content
{
    private $dbConnection;

    public function __construct(\PDO $dbConnection)
    {
        $this->dbConnection = $dbConnection
    }

    public update($id, $content)
    {
        $stmt = $this->dbConnection->prepare('UPDATE website_content SET content = :content, date_added = CURDATE() WHERE id = :id');
        $stmt->execute([
            'id' => $id,
            'content' => $content,
        ]);
    }

} 
```

```
$dbConnection = new \PDO("mysql:host=localhost;dbname=$this->db_name", $this->db_username, $this->db_password);
$dbConnection->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
$dbConnection->setAttribute(PDO::ATTR_EMULATE_PREPARES, false);

$pageContent = new \App\Page\Content($dbConnection);
$pageContent->update(1, 'new content'); 
```

如果您有一个名为的方法，`print_table_cell`那么您可能做错了 OOP，因为这可能意味着您的代码做的太多并且可能违反了[单一职责原则](http://en.wikipedia.org/wiki/Single_responsibility_principle)。我的意思是几乎所有情况下的类都不需要访问任何表的任何列。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-25T13:42:51.600

```
class Model
{
    protected $pdo;

    /**
     * Inject the pdo driver in the model.
     */
    public function __construct(PDO $pdo)
    {
        $this->pdo = $pdo;
    }

    public function print_table_cell($tbl_name, $colm_name, $array_index_num)
    {
        // Use the pdo object $this->pdo
    }
}

// Create the connection
$dbName = '';
$dbUsername = '';
$dbPassword = '';

$pdo = new PDO("mysql:host=localhost;dbname=$dbName", $dbUsername, $dbPassword);
$pdo->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);

// Create your model and inject the pdo object.
$model = new Model($pdo);
$model->print_table_cell() ... 
```

如上所述，您需要使用准备好的语句，因为 PDO 将转义防止 SQL 注入的值。但无论如何，必须过滤所有输入数据：您有一些基本过滤器[http://php.net/manual/fr/function.filter-var.php](http://php.net/manual/fr/function.filter-var.php)。

模型类应该只与数据库交互，并且不打印任何东西。

对于打印输出，您可以使用所谓的 View 类从模型中获取数据并显示它。

```
class View
{
    protected $model;

    public function __construct(Model $model)
    {
        $this->model = $model;
    }

    public function render()
    {
        echo $this->model->getData();
    }
}

class Model
{
    protected $pdo;

    public function __construct(PDO $pdo)
    {
        $this->pdo = $pdo;
    }

    public function getData()
    {
        // Do your query here with $this->pdo and prepared statement.
        // and return the data
    }
}

$pdo = new PDO(...);
$model = new Model($pdo);
$view = new View($model);
$view->render(); 
```

# vb.net - 如何在 VB.NET 中处理 ListBox 的 SelectedIndex 和双击事件？

> ID：14522834
> 
> 赞同：0
> 
> 时间：2013-01-25T13:33:27.927
> 
> 标签：vb.net, listbox, vb6-migration

我有一个关于**双击**已经有**SelectedIndexChanged**事件的 ListBox 的功能。vb6 中的相同事件工作正常，但是当我单击双击时，SelectedIndexChanged 事件总是触发。

我曾尝试使用计时器并阻止 SelectedIndexChanged 事件，但总是触发 SelectedIndexChanged 事件是没有用的。

与 VB.NET 相比，Vb 中的事件序列是不同的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T13:54:53.690

ListBox 有两个事件来处理*双击*

1.  双击事件
2.  鼠标双击事件

msdn：[Control.DoubleClick 事件](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.doubleclick.aspx)

带有项目的 DoubleClick 事件示例：[C# 列表框项目双击事件](https://stackoverflow.com/a/4454519/1080742)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-12-09T09:36:20.237

您不能同时拥有 MouseDoubleClick 和 SelectedIndexChanged。当使用 SelectedIndexChanged 时，它将取代 MouseDoubleClick。尝试使用其中一种。

更准确地说，当控件为空时，会触发 MouseDoubleClick，但一旦添加了一个项目，就会触发 SelectedIndexChanged 而不是 MouseDoubleClick。

希望这可以帮助。

# ssas - 我可以在 SSAS 的维度上创建新的计算成员吗？

> ID：14522839
> 
> 赞同：1
> 
> 时间：2013-01-25T13:33:50.973
> 
> 标签：ssas

我使用 FactFinance 表创建了一个多维数据集。我在度量上创建了计算成员。我只想知道，我可以在维度表上创建计算成员吗？

如果是，你能告诉步骤吗？

我对父层次结构和父成员感到困惑。我尝试在父层次结构中选择 DimTime.CalendarYear，但它在父成员中返回错误。什么都看不见。请帮忙。我对这个工具完全陌生。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T16:52:53.180

在数据源视图中的维度表上创建计算成员。

# javascript - 你如何在Javascript中检查日期是否为UTC？

> ID：14522846
> 
> 赞同：3
> 
> 时间：2013-01-25T13:34:40.403
> 
> 标签：javascript, datetime

我读过这个问题： [如何将 JavaScript 日期转换为 UTC？](https://stackoverflow.com/questions/948532/how-do-you-convert-a-javascript-date-to-utc)

基于此，我在 dateTools 模块中实现了这种转换，如下所示：

**[更新]**

```
var dt, utcTime;
dt = new Date();
utcTime = new Date(Date.UTC(dt.getFullYear(), 
                                        dt.getMonth(), 
                                        dt.getDate(), 
                                        dt.getHours(), 
                                        dt.getMinutes(), 
                                        dt.getSeconds(), 
                                        dt.getMilliseconds())); 
```

现在我想编写单元测试。我的想法是检查结果是否实际上是 UTC，但我不知道如何。

对于输入（非 UTC）和输出（UTC）日期，所有 toString、toUTCString 和类似方法似乎都是相同的。

只有 getTime 方法的结果不同。

有没有办法在javascript中检查日期是否为UTC？如果没有，是否有更好的想法对此进行单元测试？

提供更多上下文：

仅将其转换为 UTC 字符串并没有多大帮助，因为在下一步中，日期将发送到 Asp.net 服务，因此转换为如下字符串：

```
'/Date([time])/' 
```

使用此代码

```
var aspDate = '/Date(' + date.getTime() + ')/'; 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-25T14:36:36.493

```
var aspDate = '/Date(' + date.getTime() + ')/'; 
```

[这将](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Date/getTime)输出表示时间戳的内部[UNIX`epoch`值 (UTC) 。](http://en.wikipedia.org/wiki/Unix_time)您可以使用各种`toString`方法来获取该时间戳的更详细的字符串表示形式：

*   [`.toString()`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Date/toString)使用用户时区，结果类似于`"Fri Jan 25 2013 15:20:14 GMT+0100"`（至少对我而言，您可能生活在不同的时区）
*   [`.toUTCString()`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Date/toUTCString)使用 UTC，结果看起来像`"Fri, 25 Jan 2013 14:20:15 GMT"`
*   [`.toISOString()`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Date/toISOString)使用 UTC，并根据 ISO 格式化日期字符串：`"2013-01-25T14:20:20.061Z"`

那么我们如何构建我们想要的时间价值呢？

*   `new Date()`或`Date.now()`导致当前日期时间。无论用户的时区是什么，时间戳都只是当前时刻。
*   `new Date(year, month, …)`使用用户时区从单个值构造时间戳。如果您希望这在您的用户社区中是相同的，那您就完蛋了。即使不使用时间值而只使用日期，它也可能导致[奇怪的一对一错误](https://stackoverflow.com/q/12885743/1048572)。
    *   您可以使用`setYear`, `setMonth`, ... 和`getYear`, `getMonth`... 方法根据用户时区设置/获取现有日期的单个值。这适用于用户的输入/输出。
    *   `getTimezoneOffset()`允许您查询将用于所有这些的时区
*   `new Date(timestring)`并且`Date.parse`不能被信任。如果你给他们一个没有明确时区表示的字符串，UA 可以随机行事。而且，如果您想提供格式正确的字符串，您将能够找到不接受它的浏览器（尤其是旧的 IE）。
*   `Date.UTC(year, month, …)`允许您从 UTC 时区中的值构造时间戳。这对于 UTC 字符串的输入/输出非常有用。
    *   每个 get/set 方法都有一个 UTC 等效项，您也可以将其用于这些事情。

您现在可以看到，您获取用户时区值并像使用 UTC 一样使用它们的方法肯定是有缺陷的。这意味着要么要么`dt`有`utcTime`错误的值，尽管使用错误的输出方法可能会让它看起来是正确的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T13:51:54.883

*   getTimezoneOffset

    语法：object.getTimezoneOffset() 此方法返回本地时间和格林威治标准时间之间的分钟差。正如您可能认为的那样，由于使用夏令时的做法，该值不是一个常数。

IE

```
var myDate = new Date;
var myUTCDate = new Date(myDate - myDate.getTimezoneOffset() * 60000);
alert(myUTCDate); 
```

注意：60000 是一分钟的毫秒数；

# wix - 蜡。安装后设置环境变量并运行应用程序

> ID：14522865
> 
> 赞同：1
> 
> 时间：2013-01-25T13:35:58.773
> 
> 标签：wix, environment-variables

我使用 WIX 为 .NET 应用程序开发了一个自定义安装程序。
在这个安装程序中，我设置了环境变量

```
<Environment Id="COMPLUS_Version" Action="set" Part="all" Name="COMPLUS_Version" 
                 Permanent="yes" System="yes" Value="v4.0.30319" /> 
```

安装后我运行应用程序（需要设置此环境变量以正确运行应用程序）。

```
<UI Id="MyWixUI_Mondo">
  <UIRef Id="WixUI_Advanced" />
  <Publish Dialog="ExitDialog"
      Control="Finish"
      Event="DoAction"
      Value="LaunchApplication">WIXUI_EXITDIALOGOPTIONALCHECKBOX = 1 and NOT Installed</Publish>
</UI>
<Property Id="WixShellExecTarget" Value="[#Application]" /> 

<CustomAction Id="LaunchApplication"
    BinaryKey="WixCA"
    DllEntry="WixShellExec"
    Impersonate="yes" /> 
```

但是，有时它不起作用。例如，在 Windows 7 Enterprise x86 应用程序在安装后运行时出现错误（仅在安装后）。

UPD。禁用 UAC 时会出现此问题。

# indexeddb - 最佳 IndexedDB 包装器

> ID：14522868
> 
> 赞同：41
> 
> 时间：2013-01-25T13:36:08.527
> 
> 标签：indexeddb

我只是在探索 IndexedDB Wrapper 的各种选项，我遇到了很多选项，如下所示：

1.  YDN
2.  jQuery IndexedDb 插件
3.  IDB 包装器
4.  DB.js

但我无法找出其中哪一个是最好的？我想将 IndexedDB 用于离线 HTML5 驱动的应用程序来保存本地数据。等待大家最好的回应！

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2013-02-19T06:08:07.910

我编写了[db.js](https://github.com/aaronpowell/db.js)库，所以我可能有点偏见，但它的主要目标是：

*   添加基于[Promise](http://wiki.commonjs.org/wiki/Promises/A)的回调处理，而不是将事件连接到`onsuccess`等
*   添加一个简单而流畅的 API 用于查询，该 API 依赖于方法链，最终看起来像 JavaScript 代码
*   使用 JavaScript 对象来定义您的数据库架构
*   处理连接“池”

它并不是要花哨或解决任何真正复杂的*实现*问题，只是 API 问题（或**我**认为的 API 问题）。

另一方面，[PouchDB是一个更复杂的解决方案，试图解决在线和离线数据存储问题，因为它可以很好地同步到 CouchDB 实例。](http://pouchdb.com/)

在我看来，jQuery IndexedDB 和 IDBWrapper 更像是概念验证，而不是为 IndexedDB 提供编程接口的完全成熟尝试，尤其是 jQuery 接口，我不明白为什么它需要 jQuery，你没有工作与 DOM。

最终这里没有*正确*的答案，您最好尝试其中一个库，如果它不适合您，然后继续下一个并继续前进，直到找到最适合您的项目的库。

# debugging - Visual Studio 2012 - 局部变量窗口中缺少变量

> ID：14522875
> 
> 赞同：6
> 
> 时间：2013-01-25T13:36:41.393
> 
> 标签：debugging, visual-studio-2012

我以前从未见过这种情况，也不知道是什么原因造成的。

当我在下面的代码末尾放置断点时，本地窗口中未列出 elapsedSeconds 变量。如果我尝试观看它，Value =“当前上下文中不存在名称'elapsedSeconds'”。这怎么可能？？？

```
public ActionResult Index()
{
    Stopwatch sw = Stopwatch.StartNew();

    var userID = WebSecurity.GetUserId(User.Identity.Name);

    var model = ModelHelper.GetModel(userID);

    long elapsedSeconds = 0;
    elapsedSeconds = sw.ElapsedMilliseconds;

    return View(model);
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-25T13:47:06.593

在项目属性窗口中选择“代码优化”属性为“已禁用”，以防您想查看该值。正是编译器优化过程使得评估该变量变得不必要。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-29T17:17:17.950

重建解决方案有助于恢复可变悬停功能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-06-12T11:30:35.940

我在一个 Web 项目中也得到了这个。重新启动 Visual Studio 或此线程中的任何其他解决方案都没有解决它。

我的解决方案是重新启动 IIS。之后，我重建了项目并启动了它，让当地人再次工作。

# c# - 数据绑定到类的实例

> ID：14522876
> 
> 赞同：0
> 
> 时间：2013-01-25T13:36:44.250
> 
> 标签：c#, binding, collections

我正在尝试将类的实例绑定到 C# 中的 ListBox。

在我的 MainPage.xaml.cs

```
 protected override void OnNavigatedTo(NavigationEventArgs e)
        {
            if (fan == null)
                fan = (Fanfou)e.Parameter;

            RefreshHomeTimeLine(fan.oauth_token, fan.oauth_token_secret);

        }

        private async void RefreshHomeTimeLine(string access, string access_secret)
        {
            string text=await fan.getFanfouApi("http://api.fanfou.com/statuses/home_timeline.json", access, access_secret);
            fanfouHomeTL = JsonConvert.DeserializeObject<FanfouHTL>(text);
        } 
```

fanfouHomeTL 很好，包含状态集合。

该类的声明是：

```
public class FanfouHTL
{
    private ObservableCollection<Status> statuses;

    public ObservableCollection<Status> Statuses
    {
        get
        {
            return statuses;
        }
        set
        {
            statuses = value;
        }
    }

} 
```

现在我正在尝试将该实例绑定`ListBox`到`MainPage.xaml`. 我已经为此创建`ItemTemplate`了`ListBox`. 好像如果我把`DataContext`Grid的 放到`FanfouHTL`（class）里面， ; 里面什么都不会显示`ListBox`。如果我将 DC 设置为`fanfouHomeTL`（实例），`MainPage`将在`InitializeComponent`.

任何提示将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T14:46:18.923

你在初始化实例吗？尝试创建 FanfouHTL 的公共属性实例，将列表框的数据上下文设置为您的控件，然后绑定到属性的集合，如下所示

```
public FanfouHTL Foobar {get;private set;}
//...snip...

public MyComponent(){
  Foobar = new FanfouHTL();
  InitialiseComponent();
} 
```

然后，在您的 XAML 中

```
<UserControl x:Name="MyComponent" DataContext="{Binding RelativePath=Self}">
<!--(can't remember exact syntax here off the top of my head, but run with it)-->
    <ListBox ItemSource="{Binding Path=Foobar.Statuses}" />
</UserControl> 
```

# mysql - 当连接表之一中没有可用的行时，左连接不返回任何行

> ID：14522878
> 
> 赞同：2
> 
> 时间：2013-01-25T13:36:48.760
> 
> 标签：mysql

```
SELECT * 
FROM `user` 
LEFT JOIN `user_group` 
  ON `user_group`.`userid` = `user`.`userid` 
LEFT  JOIN `email_template` 
  ON `email_template`.`user_id`=`user`.`userid` 
WHERE `user`.`agent_id`='123' 
 AND `email_template`.`type`='advertise' 
```

那是我的sql语句。我正在加入表用户、用户组和 email_template。问题是对于我正在查询的用户，表中没有广告类型的 email_template，因此整个查询不返回任何行。相反，我想要 1 行，其中 email_template 类型列为空。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-25T13:40:20.620

您是否尝试将`email_template`过滤器移动到连接条件？

这样做会在连接而不是`WHERE`子句上应用过滤器。如果您在上应用过滤器，`WHERE`那么您基本上是在执行一个`INNER JOIN`如果没有任何符合条件的行将导致不返回任何行：

```
SELECT * 
FROM `user` 
LEFT JOIN `user_group` 
  ON `user_group`.`userid` = `user`.`userid` 
LEFT  JOIN `email_template` 
  ON `email_template`.`user_id`=`user`.`userid` 
  AND `email_template`.`type`='advertise'
WHERE `user`.`agent_id`='123' 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-25T13:40:46.113

移动条件以选择`email_templatetype='advertise'`您加入的时间。基本上，该`WHERE`子句导致记录被过滤，它确实符合条件。

```
SELECT  * 
FROM    `user` 
        LEFT JOIN `user_group` 
          ON `user_group`.`userid` = `user`.`userid` 
        LEFT  JOIN `email_template` 
          ON `email_template`.`user_id`=`user`.`userid` AND 
                `email_template`.`type`='advertise'
WHERE   `user`.`agent_id`='123' 
```

# cruisecontrol.net - CruiseControl.NET 电子邮件仅发送给修改用户

> ID：14522884
> 
> 赞同：1
> 
> 时间：2013-01-25T13:37:09.863
> 
> 标签：cruisecontrol.net

是否可以将成功构建的邮件发送给仅通过 CruiseControl.NET 动态修改用户？

在 CCNET 构建日志中有一个关于修改用户的部分，但那里只存在用户代码值。

是否可以将此信息与交换服务器集成并获取用户电子邮件，然后仅向所有修改用户发送类似邮件`Your modifications successfully transferred vs vs`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-07-30T15:04:23.330

据我所知，CC.NET 中的电子邮件块是静态的。我不认为您可以动态创建电子邮件收件人，除非您使用 CC.NET 之外的机制，例如 Powershell。

您总是可以运行一个脚本来生成您的电子邮件列表（基于您的源代码控制信息），并将该电子邮件收件人字符串列表设置为环境变量中的系统级变量，然后在 CC 的电子邮件块中引用该环境变量。网。

# ruby-on-rails - Rails SaaS 应用程序为每个客户端创建新数据库

> ID：14522885
> 
> 赞同：1
> 
> 时间：2013-01-25T13:37:12.900
> 
> 标签：ruby-on-rails, ruby-on-rails-3, rails-activerecord

我正在创建 Rails SaaS 应用程序，因为我想为每个客户端创建一个新数据库。如何做到这一点并管理它？有什么例子吗？任何的想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-25T22:30:16.937

看看公寓宝石： [https ://github.com/influitive/apartment](https://github.com/influitive/apartment)

如果您计划使用 PostgreSQL 作为您的数据库（推荐），您可以改为为每个帐户创建一个新*模式*，而不是一个全新的数据库。

Ryan Bigg 目前也在写一本关于这个主题的书。他摇摆不定。[https://leanpub.com/multi-tenancy-rails](https://leanpub.com/multi-tenancy-rails)

# wordpress - 如何包含 init.php（最好在 'init' WordPress 钩子上）

> ID：14522886
> 
> 赞同：1
> 
> 时间：2013-01-25T13:37:17.603
> 
> 标签：wordpress, plugins, initialization

您好我正在尝试添加一些代码以允许我的 wordpress 网站上的自定义元框：

github：[https ://github.com/jaredatch/Custom-Metaboxes-and-Fields-for-WordPress](https://github.com/jaredatch/Custom-Metaboxes-and-Fields-for-WordPress)

它指出我需要在 init wordpress 钩子中包含提供的 init.php，但我只是想知道如何去做？

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-25T13:53:54.980

```
add_action('init', 'include_init_file');
function include_init_file() {
    // use correct path here
    require_once get_stylesheet_directory() . '/metabox/init.php';
} 
```

上面的代码在主题的functions.php 文件中。您必须更正`init.php`文件的路径。上面的示例假设路径为`[theme_directory]/metabox/init.php`

# visual-studio-2012 - VsTemplate：TemplateGroupID 的使用

> ID：14522887
> 
> 赞同：2
> 
> 时间：2013-01-25T13:37:17.567
> 
> 标签：visual-studio-2012, vs-extensibility, visual-studio-templates

无论`HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\VisualStudio\11.0\Projects\`我使用哪个 ID，它们都不起作用！当我设置`ShowByDefault`为`false`时，“添加新项目”窗口中不会显示任何内容。在我的示例中，我使用`SharePointItemTemplateGroupID`，但也`Web`不起作用。我不知道我做错了什么。

**我的 *.vs 模板：**

```
<?xml version="1.0" encoding="utf-8"?>
<VSTemplate Version="3.0.0" Type="Item" xmlns="http://schemas.microsoft.com/developer/vstemplate/2005" xmlns:sdk="http://schemas.microsoft.com/developer/vstemplate-sdkextension/2010">
  <TemplateData>
    <Name>My User Control</Name>
    <Description>My User Control with My-specific content.</Description>
    <Icon>MyUserControl.ico</Icon>
    <TemplateID>b83fe377-e03a-40a8-9366-a04988fae2a7</TemplateID>
    <ProjectType>CSharp</ProjectType>
    <SortOrder>1</SortOrder>
    <RequiredFrameworkVersion>2.0</RequiredFrameworkVersion>
    <NumberOfParentCategoriesToRollUp>1</NumberOfParentCategoriesToRollUp>
    <DefaultName>MyUserControl.ascx</DefaultName>
    <TemplateGroupID>SharePointItemTemplateGroupID</TemplateGroupID>
    <ProjectSubType>SharePointItemTemplateGroupID</ProjectSubType>
    <ShowByDefault>true</ShowByDefault>
  </TemplateData>
  <TemplateContent>
    <References>
      <Reference>
        <Assembly>Microsoft.SharePoint</Assembly>
      </Reference>
      <Reference>
        <Assembly>System</Assembly>
      </Reference>
      <Reference>
        <Assembly>System.Web</Assembly>
      </Reference>
    </References>
    <ProjectItem ReplaceParameters="true" TargetFileName="$fileinputname$.$fileinputextension$">MyUserControl.ascx</ProjectItem>
    <ProjectItem ReplaceParameters="true" TargetFileName="$fileinputname$.$fileinputextension$.cs">MyUserControl.ascx.cs</ProjectItem>
    <ProjectItem ReplaceParameters="true" TargetFileName="$fileinputname$.$fileinputextension$.designer.cs">MyUserControl.ascx.designer.cs</ProjectItem>
    <CustomParameters>
      <CustomParameter Name="MappedFolderType" Value="UserControl" />
      <CustomParameter Name="$UC$" Value="UserControl" />
      <CustomParameter Name="$baseclass$" Value="UserControl"/>
    </CustomParameters>
  </TemplateContent>
  <WizardExtension>
    <Assembly>Microsoft.VisualStudio.SharePoint.ProjectExtensions.Wizards, Version=11.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a</Assembly>
    <FullClassName>Microsoft.VisualStudio.SharePoint.ProjectExtensions.Wizards.GenericMappedFolderWizard</FullClassName>
  </WizardExtension>
</VSTemplate> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T15:47:36.230

我不知道注册表项，但如果您希望您的项目模板显示在“新建项目”对话框的某个文件夹中，请将其放在文件系统上的相应文件夹中。例如，将您的压缩模板文件放在这里：

`C:\Users\<yourusername>\Documents\Visual Studio 2012\Templates\ProjectTemplates\CSharp\SharePoint\`

该`CSharp`文件夹是语言文件夹，因此可以替换为`Visual Basic`您需要的任何语言。此外，`SharePoint`上述路径中不存在该文件夹，因此您必须创建它。此文件夹的内容与安装的文件夹合并在：

`\VisualStudioInstallationDirectory\Common7\IDE\ProjectTemplates\`

请参阅[MSDN](http://msdn.microsoft.com/en-us/library/y3kkate1%28v=vs.110%29.aspx)。

# php - 是更好的解析和数组还是对 Mysql 的许多查询？

> ID：14522890
> 
> 赞同：1
> 
> 时间：2013-01-25T13:37:28.180
> 
> 标签：php, mysql

我有一个包含许多操作的表，一个字段是使用操作的日期时间“创建”的。我需要返回一个数组，其中包含我在周期范围内每小时、每周、每天、每月注册的操作数。

最好做一个独特的数据库请求并解析所有结果

```
 foreach($scans as $s) {
        $data['total']++;
        $t = strtotime($s['Scan']['created']);
        //week day
        @$data['weekday'][date('w',$t)]++;
        @$data['hour'][date('H',$t)]++;
        @$data['day'][date('d',$t)]++;
        @$data['month'][date('n',$t)]++;
    } 
```

还是 5 个带有 count() 函数的查询？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T13:44:15.527

数据库能够以最佳效率准确执行此类任务。您应该将大部分数据处理卸载到数据库系统，它会为您进行各种优化，并让 PHP 进行管理和演示。原则上，您应该避免在 PHP 中循环数据来进行处理，除非您正在做演示文稿。

因此，您应该在一个查询中完成您的全部工作，并从您的数据库中获取最终结果。查看您的查询并尝试将您想要的所有内容组合到其中。如果您无法提出正确的查询，也许您可​​以尝试从 Stack Overflow 获得帮助（但要为它打开另一个问题）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T13:40:57.110

一个唯一的数据库请求并解析所有结果。网络开销会更少。

# php - HTML 表单在使用 JQuery 提交时重新加载新数据库信息不起作用（PHPBB overal_header）

> ID：14522895
> 
> 赞同：0
> 
> 时间：2013-01-25T13:37:42.073
> 
> 标签：php, jquery, forms, phpbb

我正在尝试创建一个在运行时生成大部分站点的网页。为此，我必须使用 JQuery 并将其包含在 overalheader 中（我正在使用 PHPBB），如下所示：

```
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js"></script> 
```

我想使用 HTML/JS 表单的提交链接：

```
<a href="#" onclick="$('#pagina').val('{menu.BUTTONTEXT}'); $('#input').submit(); return false;">{menu.BUTTONTEXT}</a> 
```

（在运行时从 Chrome 复制，所有值都正确加载）

```
<a href="#" onclick="$('#buurt').val('buurt 1'); $('#input').submit(); return false;">buurt 1</a> 
```

形式：

```
<form id="input" action="index.php" method="post">
    <input type="hidden" id="pagina" name="pagina" value="{PAGINA_NAME}"/>
    <input type="hidden" id="buurt" name="buurt" value="{BUURT}"/>
</form> 
```

从 PHP 页面生成的所有变量都在工作，但是当我单击链接时，Chrome 会给我这个错误：

```
Uncaught ReferenceError: $ is not defined localhost:33
onclick 
```

我正在使用 Xampp 来尝试这段代码，但它找不到 $. 我做错了什么还是我必须添加一个函数来将 $ 定义为 Jquery？

# android - Android TextView 未设置

> ID：14522896
> 
> 赞同：2
> 
> 时间：2013-01-25T13:37:52.410
> 
> 标签：android, android-asynctask, textview

我现在正在学习 Android 开发，我想尝试我在 iOS 开发中完成的任何基本程序。问题是获取一个地方的天气状况并在TextView中设置条件。

**代码**

```
package com.bh.weather;

import java.io.BufferedReader;
import java.io.InputStreamReader;

import org.apache.http.HttpResponse;
import org.apache.http.client.methods.HttpGet;
import org.apache.http.impl.client.DefaultHttpClient;
import org.json.JSONObject;

import android.os.AsyncTask;
import android.os.Bundle;
import android.app.Activity;
import android.util.Log;
import android.view.Menu;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.TextView;

class WeatherTask extends AsyncTask<String, Void, String> {

    protected void onPostExecute(String json) {
        try {
            JSONObject jsonObject = new JSONObject(json);
            String value = jsonObject.getJSONObject("data")
                    .getJSONArray("current_condition").getJSONObject(0)
                    .getJSONArray("weatherDesc").getJSONObject(0)
                    .getString("value");
            Log.d("bh", value);
            MainActivity m = new MainActivity();
            m.setTextView(value);
        } catch (Exception e) {
            e.printStackTrace();
        }
    }

    @Override
    protected String doInBackground(String... urlTojson) {
        String json = new String();
        try {
            DefaultHttpClient defaultClient = new DefaultHttpClient();
            HttpGet httpGetRequest = new HttpGet(urlTojson[0]);
            HttpResponse httpResponse = defaultClient.execute(httpGetRequest);
            BufferedReader reader = new BufferedReader(new InputStreamReader(httpResponse.getEntity().getContent(), "UTF-8"));
            json = reader.readLine();
        } catch (Exception e) {
            e.printStackTrace();
        }
        return json;
    }
}

public class MainActivity extends Activity implements OnClickListener {

    private TextView tv = null;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        Button button = (Button) findViewById(R.id.button1);
        button.setOnClickListener(this);

    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        getMenuInflater().inflate(R.menu.activity_main, menu);
        return true;
    }

    @Override
    public void onClick(View v) {
    //changed the API key here to xxxxxxxxxxxxxxxx
        new WeatherTask().execute("http://free.worldweatheronline.com/feed/weather.ashx?q=Bangalore,India&format=json&num_of_days=1&key=xxxxxxxxxxxxxxxxx");
    }

    public void setTextView(String v) {
        Log.d("bh","Inside setTextView:"+v);
        if(v.equals("")) {
            Log.d("bh","Value not received");
        }
        else {
            tv = (TextView) findViewById(R.id.textView3);
            tv.setText(v);
        }
    }
} 
```

生成的 JSON 如下所示（jsonviewer.stack.hu 可用于查看）：

```
{
  "data": {
    "current_condition": [
      {
        "cloudcover": "0",
        "humidity": "30",
        "observation_time": "01:29 PM",
        "precipMM": "0.0",
        "pressure": "1017",
        "temp_C": "25",
        "temp_F": "77",
        "visibility": "10",
        "weatherCode": "113",
        "weatherDesc": [
          {
            "value": "Clear"
          }
        ],
        "weatherIconUrl": [
          {
            "value": "http:\/\/www.worldweatheronline.com\/images\/wsymbols01_png_64\/wsymbol_0008_clear_sky_night.png"
          }
        ],
        "winddir16Point": "E",
        "winddirDegree": "90",
        "windspeedKmph": "13",
        "windspeedMiles": "8"
      }
    ],
    "request": [
      {
        "query": "Bangalore, India",
        "type": "City"
      }
    ],
    "weather": [
      {
        "date": "2013-01-25",
        "precipMM": "0.0",
        "tempMaxC": "29",
        "tempMaxF": "84",
        "tempMinC": "15",
        "tempMinF": "59",
        "weatherCode": "113",
        "weatherDesc": [
          {
            "value": "Sunny"
          }
        ],
        "weatherIconUrl": [
          {
            "value": "http:\/\/www.worldweatheronline.com\/images\/wsymbols01_png_64\/wsymbol_0001_sunny.png"
          }
        ],
        "winddir16Point": "E",
        "winddirDegree": "97",
        "winddirection": "E",
        "windspeedKmph": "17",
        "windspeedMiles": "11"
      }
    ]
  }
} 
```

**activity_main.xml**

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    tools:context=".MainActivity" >

    <TextView
        android:id="@+id/textView1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentTop="true"
        android:layout_centerHorizontal="true"
        android:layout_marginTop="22dp"
        android:text="@string/title" />

    <TextView
        android:id="@+id/textView2"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_below="@+id/textView1"
        android:layout_marginLeft="32dp"
        android:layout_marginTop="30dp"
        android:text="@string/place_name"
        android:textAppearance="?android:attr/textAppearanceLarge" />

    <TextView
        android:id="@+id/textView3"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignLeft="@+id/textView2"
        android:layout_below="@+id/textView2"
        android:layout_marginTop="36dp"
        android:layout_marginLeft="0dp"
        android:text="@string/weather_condition" />

    <Button
        android:id="@+id/button1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_below="@+id/textView1"
        android:layout_centerVertical="true"
        android:layout_marginTop="140dp"
        android:layout_marginLeft="120dp"
        android:text="@string/show_weather" />

</RelativeLayout> 
```

从代码中可以看出，我解析后得到值“Clear”（使用互联网权限集）。但由于某种原因，这没有在 TextView 中设置。我不知道我在这里犯了什么错误。Logcat 正确显示记录的值。请帮忙。

干杯。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T13:41:40.670

您将需要在`AsyncTask`内部使用 Constructor 传递活动上下文，而不是在 AsyncTask 内部创建它。将您的代码更改为：

```
class WeatherTask extends AsyncTask<String, Void, String> {
public Context context;
  public WeatherTask(Context context){

     this.context=context;
  }
    protected void onPostExecute(String json) {
        try {
            JSONObject jsonObject = new JSONObject(json);
            String value = jsonObject.getJSONObject("data")
                    .getJSONArray("current_condition").getJSONObject(0)
                    .getJSONArray("weatherDesc").getJSONObject(0)
                    .getString("value");
            Log.d("bh", value);

            context.setTextView(value); 

        } catch (Exception e) {
            e.printStackTrace();
        }
    }
 //your code here.... 
```

并从 MainActivity 传递 Activity 上下文：

```
 WeatherTask weatherobj=new WeatherTask(MainActivity.this);
        weatherobj.execute("http://free.worldweatheronline.com/feed/
weather.ashx?q=Bangalore,India&format=json&num_of_days=1&key=xxxxxxxxxxxxxxxxx"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-25T13:44:47.620

尝试

```
 class WeatherTask extends AsyncTask<String, Void, String> {
    MainActivity mActivity;
     public WeatherTask(MainActivity mActivity){

          this.mActivity=mActivity;
                  }

protected void onPostExecute(String json) {
    try {
        JSONObject jsonObject = new JSONObject(json);
        String value = jsonObject.getJSONObject("data")
                .getJSONArray("current_condition").getJSONObject(0)
                .getJSONArray("weatherDesc").getJSONObject(0)
                .getString("value");
        Log.d("bh", value);

        mActivity.setTextView(value);
    } catch (Exception e) {
        e.printStackTrace();
    }
}

@Override
protected String doInBackground(String... urlTojson) {
    String json = new String();
    try {
        DefaultHttpClient defaultClient = new DefaultHttpClient();
        HttpGet httpGetRequest = new HttpGet(urlTojson[0]);
        HttpResponse httpResponse = defaultClient.execute(httpGetRequest);
        BufferedReader reader = new BufferedReader(new InputStreamReader(httpResponse.getEntity().getContent(), "UTF-8"));
        json = reader.readLine();
    } catch (Exception e) {
        e.printStackTrace();
    }
    return json;
}
}

 public class MainActivity extends Activity implements OnClickListener {

private TextView tv = null;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);
    Button button = (Button) findViewById(R.id.button1);
    button.setOnClickListener(this);

}
@Override
public boolean onCreateOptionsMenu(Menu menu) {
    getMenuInflater().inflate(R.menu.activity_main, menu);
    return true;
}

@Override
public void onClick(View v) {
//changed the API key here to xxxxxxxxxxxxxxxx
    new WeatherTask(this).execute("http://free.worldweatheronline.com/feed/weather.ashx?q=Bangalore,India&format=json&num_of_days=1&key=xxxxxxxxxxxxxxxxx");
}

public void setTextView(String v) {
    Log.d("bh","Inside setTextView:"+v);
    if(v.equals("")) {
        Log.d("bh","Value not received");
    }
    else {
        tv = (TextView) findViewById(R.id.textView3);
        tv.setText(v);
        }
    }
} 
```

# javascript - JavaScript 在 ASP.NET 中无法正常工作

> ID：14522899
> 
> 赞同：0
> 
> 时间：2013-01-25T13:37:59.727
> 
> 标签：javascript, asp.net

我对 JavaScript 还是很陌生，并且在某一点上卡住了：我正在使用 asp 控件文件上传来上传一些文件并将它们存储到数据库中，我正在使用 asp 转发器控件在前端显示数据库中的所有文档并关联了一个 html每个文档的复选框：问题是当我选中或取消选中复选框时，删除按钮会相应地启用/禁用，但是当我单击“全选”按钮时，我会调用这两个函数 - 选中所有复选框并启用按钮，不知何故，删除按钮没有启用..请帮忙。

这是启用删除按钮的 JavaScript 代码：-

```
function EnableButton() {
            var rpt = document.getElementById('<%= rptWordDoc.ClientID  %>');
            var chkbx = document.getElementsByTagName('input');
            var x = document.getElementById("btnDelWordDoc");
            for (i = 0; i <= chkbx.length; i++) {
                var id = "rptWordDoc_chkWordDoc_" + i
                var y = document.getElementById(id);
                if (y == null) {
                    break;
                }
                if (y.checked == true) {
                    x.disabled = false;
                    break;
                }
                else {
                    x.disabled = true;
                }
            }

        } 
```

这就是我调用函数的方式：-

```
<asp:Button ID="btnSelectAll" runat="server" Text="Select All" OnClientClick="fnSelectAll(); JavaScript:EnableButton();" /> 
```

通过复选框：-

```
<input type="checkbox" id="chkWordDoc" runat="server" onclick="JavaScript:EnableButton();" /> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T13:47:31.253

您调用了两个函数`fnSelectAll();` ，并且`JavaScript:EnableButton();`可能在执行第一个函数后未执行第二个函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-26T19:32:45.493

终于找到了原因：实际上我正在使用 asp: button control for Select All & Clear All 功能，因此它正在回发到服务器并将删除按钮启用属性的值设置回 false。

我为 Select All & clear all 按钮添加了一个 html 控件而不是 asp 按钮，并且没有添加 runat=server 属性，因为不需要服务器端事件。

谢谢你的建议..干杯..:)

# tomcat - Cloud Foundry：通过 Manifest.yml 设置环境变量

> ID：14522913
> 
> 赞同：1
> 
> 时间：2013-01-25T13:38:57.927
> 
> 标签：tomcat, environment-variables, cloud-foundry, jvm-arguments

我的问题很简单

**有没有什么方法可以通过 Manifest.yml** *设置环境变量*而不** 运行*vmc 命令 set-env [application name] key = value* ??

在亚马逊上，可以使用 .ebextension 文件执行以下操作

*option_settings：-命名空间：aws：elasticbeanstalk：容器：tomcat：JVMOPTIONS

     option_name：JVM 选项

     价值：=价值-DKEY*

另外我想设置这个变量从 Eclipse 部署应用程序而不使用 vmc

我的战争

       源代码

       清单.yml

或类似的东西。

我设法通过 set-env vmc 命令实现了它，但是在使用 Eclipse 插件时非常不舒服，这样当您删除或删除应用程序变量时就会消失。

因此，最好在 manifest.yml 中设置这些变量 .... 但我无法得到它或没有给出正确的语法。

谢谢你。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-28T07:42:37.600

您可能想尝试将此部分添加到 manifest.yml：

```
env:
  {name}: {value} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T16:06:05.133

查看清单处理的当前代码（https://github.com/cloudfoundry/vmc-plugins/blob/master/manifests/lib/manifests-vmc-plugin.rb）我猜不支持env-vars清单.yml。

我建议您为此提出问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-03T13:05:07.280

我尝试了很多方法都没有结果。

1.  我通过 Eclipse Pluggin for Cloud Foundry 进行部署。
2.  我在战争项目下方创建了一个 manifest.yml 文件。
3.  VMC 版本：0.4.7

manifest.yml 仅包含：

* * *

应用：

-- 名称：myapp

环境：

```
 my_env_var: hello 
```

**没有结果**，没有办法（：-

我还进行了 gem 更新（并找到了 Eclipse 插件的任何更新......）

更新已安装的 gem

更新 manifests-vmc-plugin

获取：manifests-vmc-plugin-0.5.0.gem (100%)

**成功安装 manifests-vmc-plugin-0.5.0**

Gems 更新： manifests-vmc-plugin 为 manifests-vmc-plugin-0.5.0 安装 ri 文档... 为 manifests-vmc-plugin-0.5.0 安装 RDoc 文档...

但是什么都没有……

# python - 如何运行这个程序，dump_video.py？

> ID：14522920
> 
> 赞同：0
> 
> 时间：2013-01-25T13:39:34.517
> 
> 标签：python, video, python-2.7

我想运行这个程序，[http](http://pymedia.org/tut/src/dump_video.py.html) ://pymedia.org/tut/src/dump_video.py.html 它将视频文件转换为图像文件。我已经安装了所有模块。当我通过在 Python IDLE 中运行来执行它时，它会在程序末尾打印 Usage... 同样的东西。我的视频文件是 .avi，xvid 编解码器，在 pymedia 页面上说它支持它。我相信程序和我的文件没有连接，但是如何将我的文件（test.avi）输入到程序中？我将视频文件放在与程序相同的文件夹中。[在页面http://pymedia.org/tut/index.html](http://pymedia.org/tut/index.html)的末尾说了一些东西，放入 cmd，我做了，但我一直收到关于使用情况的相同消息。它在文件末尾的 if 语句中。我在python中工作了一点，但从来没有使用过函数，所以请帮忙。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T14:35:42.447

[源代码](http://pymedia.org/tut/src/dump_video.py.html)包含此用法消息：

```
print 'Usage: dump_video <file_name> <image_pattern> <format_number>\n<format_number> can be: RGB= 2'+\
    '\n<image_patter> should include %d in the name. ex. test_%d.bmp.'+ \
    '\nThe resulting image will be in a bmp format' 
```

根据评论，`dump_video.py`可以这样调用：

```
dump_video.py myvideo.avi myvideo_%d.bmp 2 
```

这将尝试将 myvideo.avi 中的帧保存到 myvideo_%d.bpm 形式的 BMP 文件中，其中`%d`将替换为数字。我不确定最后一个参数，即所谓的“格式号”是`2`做什么的。

# javascript - d3.js 中 x 轴的缩写月份格式

> ID：14522921
> 
> 赞同：8
> 
> 时间：2013-01-25T13:39:48.027
> 
> 标签：javascript, d3.js

如何通过此函数将完整的月份名称转换为缩写名称

```
axis.ticks(d3.time.months, 1) 
```

此函数在完整的一月二月打印月份名称

我应该用什么将其更改为缩写名称。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-01-25T14:25:40.003

您可以添加[timeFormat](https://github.com/mbostock/d3/wiki/Time-Formatting)，如下所示：

```
axis.ticks(d3.time.months, 1)
   .tickFormat(d3.time.format("%b")); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2018-01-30T10:27:46.563

接受的答案在 d3 版本 4 发布之前得到了回答。如果您想对 d3 版本 4 执行相同操作，请执行以下操作：

```
axis.ticks(d3.timeMonth, 1)
  .tickFormat(d3.timeFormat('%b')); 
```

# python - 如何从循环中的函数中断 Python while 循环

> ID：14522923
> 
> 赞同：2
> 
> 时间：2013-01-25T13:40:08.900
> 
> 标签：python

```
while True:
    input = raw_input("enter input: ")
    result = useInput(input)

def useInput(input):
    if input == "exit":
        break   #return 0 / quit / etc.. i want to break the while loop from within this function 
```

我知道我可以将“if 逻辑”直接放在 while 循环中，但我希望它在函数中。有没有办法从循环中调用的函数中中断while循环？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T13:41:53.727

1.  引发异常，您可以在 While 循环之外进行处理
2.  返回要由调用者捕获的标志并进行相应处理。请注意，`"if logic" directly in the while loop,`, 将是最优选的方式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-25T14:08:05.127

Python 在生成器中有一个很酷的特性——它们允许您轻松地生成与`for`循环一起使用的迭代器，这可以简化这种代码。

```
def input_until(message, func):
    """Take raw input from the user (asking with the given message), until 
    when func is applied it returns True."""
    while True:
        value = raw_input(message)
        if func(value):
            return
        else:
            yield value

for value in input_until("enter input: ", lambda x: x == "exit"):
    ... 
```

循环将`for`一直循环，直到迭代器停止，当用户输入时我们创建的迭代器停止`"exit"`。请注意，我已经对此进行了一些概括，为简单起见，您可以将检查硬编码`"exit"`到生成器中，但如果您在一些地方需要类似的行为，则可能值得保持通用。

请注意，这也意味着您可以在[列表推导](http://www.youtube.com/watch?v=pShL9DCSIUw)中使用它，从而也可以轻松构建结果列表。

编辑：或者，我们可以使用以下方式构建它[`itertools`](http://docs.python.org/3.3/library/itertools.html)：

```
def call_repeatedly(func, *args, **kwargs):
    while True:
        yield func(*args, **kwargs)

for value in itertools.takewhile(lambda x: x != "exit", 
                                 call_repeatedly(raw_input, "enter input: ")):
    ... 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-25T13:52:23.563

我通常这样做：

```
def getInput():
    while True:
        yield raw_input("enter input: ")

for input in getInput():
    if input == 'exit': 
        break
    result = useInput(input) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-25T13:41:40.380

您可以引发异常并在`while`...之外处理它，但这可能会导致一些令人困惑的代码...

```
def useInput(in_):
    if in_ == "exit":
        raise RuntimeError
try:
    while True:
        input = raw_input("enter input: ")
        result = useInput(input)

except RuntimeError:
    pass 
```

最好**只**返回一个布尔标志，然后根据该标志的值中断或不中断。如果您担心自己已​​经有想要返回的东西，请不要担心——python 会很乐意让您的函数返回不止一件东西：

```
def func()
    ...
    return something,flag

while True:
    something,flag = func()
    if flag:
        break 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-25T19:00:26.527

好吧，如果它只是美学那就是让你无法将它放在 while 循环中，那么上述任何一个都可以工作......但不是 try/except 的粉丝。只要知道将它放在自己的功能中不会有任何性能差异。这是我认为也符合您的要求的一个:-)

```
# you have to define the function first if your while isn't in a function
def UseInput():
   input = raw_input("enter input: ")
   if input == "exit":
      return False
   elif input == "pass":
      return True

   # Do stuff
   return True

while UseInput():
   pass 
```

# c# - 在datagridview中更改行背景颜色

> ID：14522930
> 
> 赞同：2
> 
> 时间：2013-01-25T13:40:48.150
> 
> 标签：c#, winforms, datagridview, backcolor

我在 Windows 窗体中更改行颜色时遇到问题。我用 Columns 做了它，并对 Rows 做了同样的尝试，但它没有用。有人可以告诉我怎么做吗？

到目前为止我的代码：

```
 public partial class Form1 : Form
{
    public Form1()
    {
        InitializeComponent();
        abc();
    }

    void abc()
    {
        DataTable hh = new DataTable();
        hh.Columns.Add("1", typeof(string));
        hh.Columns.Add("2", typeof(string));
        hh.Columns.Add("3", typeof(string));

        hh.Rows.Add(new object[] { "a", "b", "c" });
        hh.Rows.Add(new object[] { "a1", "b1", "c1" });
        hh.Rows.Add(new object[] { "a2", "b2", "c2" });

        dataGridView1.DataSource = hh;

        foreach (DataGridViewRow dr in dataGridView1.Rows) // trying to change all rows to orange
            dr.DefaultCellStyle.BackColor = Color.Orange;  // but it doesn't work

        dataGridView1.Rows[0].DefaultCellStyle.BackColor = Color.Orange; // doesn't work
        dataGridView1.Refresh();
        dataGridView1.Update();

        dataGridView1.Columns[0].DefaultCellStyle.BackColor = Color.Beige; // this works

    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-25T13:49:21.180

使用 Datagridview CellPainting 事件。只需在此处复制此代码即可。

```
 if (e.RowIndex == -1)
        {
            SolidBrush br= new SolidBrush(Color.Blue);
            e.Graphics.FillRectangle(br, e.CellBounds);
            e.PaintContent(e.ClipBounds);
            e.Handled = true;
        }
        else
        {
                SolidBrush br= new SolidBrush(Color.Orange);
                e.Graphics.FillRectangle(br, e.CellBounds);
                e.PaintContent(e.ClipBounds);
                e.Handled = true;

        } 
```

if 检查它是否是 Header。使用你想要的颜色。如果你不想绘制标题，只需删除 if 中的所有代码。

我想要渐变背景色告诉我..

编辑：

这是用一种颜色绘制成对行并在另一种颜色中削弱的代码。您也必须使用 Cellpainting 事件..

```
else
        {
            if (e.RowIndex % 2 == 0)
            {
                SolidBrush br = new SolidBrush(Color.Gainsboro);

                e.Graphics.FillRectangle(br, e.CellBounds);
                e.PaintContent(e.ClipBounds);
                e.Handled = true;
            }
            else
            {
                SolidBrush br = new SolidBrush(Color.White);
                e.Graphics.FillRectangle(br, e.CellBounds);
                e.PaintContent(e.ClipBounds);
                e.Handled = true;
            }
        } 
```

编辑 2： cellpainting 事件在哪里？

![在此处输入图像描述](../Images/8bfe805cacf73730b2a21824dc65f060.png)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-25T13:55:02.817

使用[DataGridView.RowsDefaultCellStyle](http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridview.rowsdefaultcellstyle.aspx)为所有行设置背景颜色：

```
dataGridView1.RowsDefaultCellStyle.BackColor = Color.Orange; 
```

更新（如果你只想画一些行）你可以使用[CellFormatting](http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridview.cellformatting.aspx)事件：

```
void dataGridView1_CellFormatting(object sender, DataGridViewCellFormattingEventArgs e)
{
    if (e.RowIndex > 2) // condition
        e.CellStyle.BackColor = Color.YellowGreen;
} 
```

[您可以在 msdn 上](http://msdn.microsoft.com/en-us/library/1yef90x0.aspx)阅读有关更改 DataGridView 样式的更多信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-12-07T12:00:17.640

```
 Private Sub Coloriage()
    Dim fin As Integer = Gridarticles.Rows.Count - 1
    Dim i As Integer
    For i = 0 To fin
        If Gridarticles("stock", i).Value < 0 Then
            Gridarticles.Rows(i).DefaultCellStyle.BackColor = Color.Red
        ElseIf Gridarticles("stock", i).Value = 0 Then
            Gridarticles.Rows(i).DefaultCellStyle.BackColor = Color.Gray
        End If
    Next
End Sub 
```

# java - 如何将标头添加到 SOAP 请求？

> ID：14522931
> 
> 赞同：20
> 
> 时间：2013-01-25T13:40:50.870
> 
> 标签：java, web-services, jax-ws, webservice-client

我尝试通过 java 代码调用 HTTPS SOAP Web 服务：

```
 URL url = new URL("https://somehost:8181/services/"SomeService?wsdl");
    QName qname = new QName("http://services.somehost.com/", "SomeService");
    Service service = Service.create(url, qname);
    SomeService port = service.getPort(SomeService .class);
    port.doSomething(); 
```

但得到例外：

```
threw an unexpected exception: javax.xml.ws.soap.SOAPFaultException: Security Requirements not met - No Security header in message 
```

当我分析正确的请求样本时，我确定它必须包含标头：

```
 <S:Header>
  <To xmlns="http://www.w3.org/2005/08/addressing">http://somehost:8181/services/SomeService</To>
  <Action xmlns="http://www.w3.org/2005/08/addressing">https://somehost:8181/services/"SomeService/doSomethingRequest</Action>
  <ReplyTo xmlns="http://www.w3.org/2005/08/addressing">
     <Address>http://www.w3.org/2005/08/addressing/anonymous</Address>
  </ReplyTo>
  <MessageID xmlns="http://www.w3.org/2005/08/addressing">uuid:3428539e-d645-72ae-adc0-5423c1e68942</MessageID>
  <wsse:Security S:mustUnderstand="true">
     <wsu:Timestamp wsu:Id="_1" xmlns:ns14="http://docs.oasis-open.org/ws-sx/ws-secureconversation/200512" xmlns:ns13="http://schemas.xmlsoap.org/soap/envelope/">
        <wsu:Created>2013-01-15T16:36:30Z</wsu:Created>
        <wsu:Expires>2014-01-15T14:06:30Z</wsu:Expires>
     </wsu:Timestamp>
  </wsse:Security> 
```

那么如何将此标头添加到我的 SOAP 请求中呢？

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2013-01-25T14:34:48.593

我个人添加了两个类：HeaderHandler 和 HeaderHandlerResolver：

```
import java.util.HashSet;
import java.util.Set;

import javax.xml.namespace.QName;
import javax.xml.soap.SOAPElement;
import javax.xml.soap.SOAPEnvelope;
import javax.xml.soap.SOAPHeader;
import javax.xml.soap.SOAPMessage;
import javax.xml.ws.handler.MessageContext;
import javax.xml.ws.handler.soap.SOAPHandler;
import javax.xml.ws.handler.soap.SOAPMessageContext;

public class HeaderHandler implements SOAPHandler<SOAPMessageContext> {

public boolean handleMessage(SOAPMessageContext smc) {

    Boolean outboundProperty = (Boolean) smc.get(MessageContext.MESSAGE_OUTBOUND_PROPERTY);

    if (outboundProperty.booleanValue()) {

        SOAPMessage message = smc.getMessage();

        try {

            SOAPEnvelope envelope = smc.getMessage().getSOAPPart().getEnvelope();
            SOAPHeader header = envelope.addHeader();

            SOAPElement security =
                    header.addChildElement("Security", "wsse", "http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd");

            SOAPElement usernameToken =
                    security.addChildElement("UsernameToken", "wsse");
            usernameToken.addAttribute(new QName("xmlns:wsu"), "http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd");

            SOAPElement username =
                    usernameToken.addChildElement("Username", "wsse");
            username.addTextNode("test");

            SOAPElement password =
                    usernameToken.addChildElement("Password", "wsse");
            password.setAttribute("Type", "http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText");
           password.addTextNode("test321");

            //Print out the outbound SOAP message to System.out
            message.writeTo(System.out);
            System.out.println("");

        } catch (Exception e) {
            e.printStackTrace();
        }

    } else {
        try {

            //This handler does nothing with the response from the Web Service so
            //we just print out the SOAP message.
            SOAPMessage message = smc.getMessage();
            message.writeTo(System.out);
            System.out.println("");

        } catch (Exception ex) {
            ex.printStackTrace();
        } 
    }

    return outboundProperty;

}

public Set getHeaders() {
    // The code below is added on order to invoke Spring secured WS.
    // Otherwise,
    // http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd
    // won't be recognised 
    final QName securityHeader = new QName(
            "http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd",
            "Security", "wsse");

    final HashSet headers = new HashSet();
    headers.add(securityHeader);

    return headers;
}

public boolean handleFault(SOAPMessageContext context) {
    //throw new UnsupportedOperationException("Not supported yet.");
    return true;
}

public void close(MessageContext context) {
//throw new UnsupportedOperationException("Not supported yet.");
}
} 
```

和

```
import java.util.ArrayList;
import java.util.List;
import javax.xml.ws.handler.Handler;
import javax.xml.ws.handler.HandlerResolver;
import javax.xml.ws.handler.PortInfo;

public class HeaderHandlerResolver implements HandlerResolver {

public List<Handler> getHandlerChain(PortInfo portInfo) {
  List<Handler> handlerChain = new ArrayList<Handler>();

  HeaderHandler hh = new HeaderHandler();

  handlerChain.add(hh);

  return handlerChain;
   }
} 
```

在 HeaderHandler 类中，您可以添加所需的凭据。最后使用它们：

```
HeaderHandlerResolver handlerResolver = new HeaderHandlerResolver();
service.setHandlerResolver(handlerResolver); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2015-06-18T07:11:14.143

I have followed the steps mentioned by @LaabidiRaissi. The code works fine but it never appends the security element under the header. I have confirmed it by printing out the outbound SOAP message to System.out. After a deep research, I have found that the SOAPMessage needs to be explicitly saved for reflecting the updated message header.

```
soapMessage.saveChanges(); 
```

For more reference - [Check this link](http://www.java2s.com/Code/JavaAPI/javax.xml.soap/SOAPElementaddTextNodeStringtext.htm)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2018-06-17T10:48:14.290

示例主类：

```
package test;

import java.util.ArrayList;
import java.util.List;
import javax.xml.ws.BindingProvider;
import javax.xml.ws.handler.Handler;

// next headers is generated from "NetBeans New Webservice Client"
import sk.firma.wstest.definitions.*;
import sk.firma.wstest.schemas.*;

/**
 *
 * @author Jan
 */
public class TestWSService {

    /**
     * @param args the command line arguments
     */
    public static void main(String[] args) {

        try {

            WsService service = new WsService();
            Ws port = service.getWsKsSoap11();

            // This is the block that apply the Ws Security to the request
            BindingProvider bindingProvider = (BindingProvider) port;
            @SuppressWarnings("rawtypes")
            List<Handler> handlerChain = new ArrayList<Handler>();
            handlerChain.add(new WSSecurityHeaderSOAPHandler("username", "password"));
            bindingProvider.getBinding().setHandlerChain(handlerChain);

            // Initialize and Run Service
            InVal inVal = new InVal();
            ReturnValue retVal = port.test(inVal);

        } catch (Exception e) {
            e.printStackTrace();
        }       
    }
} 
```

现在 WS-Security Header SOAP 处理程序：

```
package test;

import java.text.DateFormat;
import java.text.SimpleDateFormat;
import java.util.Date;
import java.util.HashSet;
import java.util.Set;
import java.util.TimeZone;

import javax.xml.namespace.QName;
import javax.xml.soap.SOAPElement;
import javax.xml.soap.SOAPEnvelope;
import javax.xml.soap.SOAPHeader;
import javax.xml.ws.handler.MessageContext;
import javax.xml.ws.handler.soap.SOAPHandler;
import javax.xml.ws.handler.soap.SOAPMessageContext;

public class WSSecurityHeaderSOAPHandler implements SOAPHandler<SOAPMessageContext> {

    private static final String URL_WSSE_NAMESPACE = "http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd";
    private static final String URL_WSU_NAMESPACE = "http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd";

    private final String usernameText;
    private final String passwordText;

    public WSSecurityHeaderSOAPHandler(String usernameText, String passwordText) {
        this.usernameText = usernameText;
        this.passwordText = passwordText;

    }

    public String getCurrentDateTime() {
        /* e.g. 2001-10-13T09:00:00Z */
        final SimpleDateFormat FORMATTER_DATETIME_NO_MS = new SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss");

        DateFormat dfETC = FORMATTER_DATETIME_NO_MS;
        dfETC.setTimeZone(TimeZone.getTimeZone("CET"));

        StringBuffer dateETC = new StringBuffer(dfETC.format(new Date()));
        dateETC.append('Z');
        return dateETC.toString();
    }

    public String getCurrentDateTimePlusDelay(long delayInSeconds) {
        /* e.g. 2001-10-13T09:00:00Z */
        final SimpleDateFormat FORMATTER_DATETIME_NO_MS = new SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss");

        DateFormat dfETC = FORMATTER_DATETIME_NO_MS;
        dfETC.setTimeZone(TimeZone.getTimeZone("CET"));
        Date date = new Date();

        long timeInMsecs = date.getTime();
        date.setTime(timeInMsecs + delayInSeconds*1000L);
        StringBuffer dateETC = new StringBuffer(dfETC.format(date));
        dateETC.append('Z');
        return dateETC.toString();
    }

    @Override
    public boolean handleMessage(SOAPMessageContext soapMessageContext) {

        Boolean outboundProperty = (Boolean) soapMessageContext.get(MessageContext.MESSAGE_OUTBOUND_PROPERTY);

        if (outboundProperty) {

            try {
                SOAPEnvelope soapEnvelope = soapMessageContext.getMessage().getSOAPPart().getEnvelope();

                SOAPHeader header = soapEnvelope.getHeader();
                if (header == null) {
                    header = soapEnvelope.addHeader();
                }

                SOAPElement securityHeaderElement = header.addChildElement("Security", "wsse", URL_WSSE_NAMESPACE);
                securityHeaderElement.addAttribute(soapEnvelope.createName("S:mustUnderstand"), "1");

                // Add Timestamp element to "Security" soapHeaderElement
                // Sample:  <u:Timestamp>
                //              <u:Created>2011-10-13T08:20:01.183Z</u:Created>
                //              <u:Expires>2011-10-13T17:25:01.183Z</u:Expires>
                //          </u:Timestamp>
                javax.xml.soap.Name timestampElementName = soapEnvelope.createName("Timestamp", "wsu", URL_WSU_NAMESPACE);
                SOAPElement timestampSOAPElement = securityHeaderElement.addChildElement(timestampElementName);
                String created = getCurrentDateTime(); 
                String expires = getCurrentDateTimePlusDelay(60L*60L); /* 60 minutes delay */

                // Add Created to Timestamp
                SOAPElement createdSOAPElement = timestampSOAPElement
                        .addChildElement("Created"/* local name */, "wsu" /* prefix */, URL_WSU_NAMESPACE);
                createdSOAPElement.addTextNode(created);

                // Add Expires to Timestamp
                SOAPElement expiresSOAPElement = timestampSOAPElement
                        .addChildElement("Expires"/* local name */, "wsu" /* prefix */,URL_WSU_NAMESPACE);
                expiresSOAPElement.addTextNode(expires);

                // Add usernameToken to "Security" soapHeaderElement
                javax.xml.soap.Name usernameTokenElementName = soapEnvelope.createName("UsernameToken", "wsse", 
                                            URL_WSSE_NAMESPACE);
                SOAPElement usernameTokenSOAPElement = securityHeaderElement.addChildElement(usernameTokenElementName);

                // Add Username to usernameToken
                SOAPElement userNameSOAPElement = usernameTokenSOAPElement
                        .addChildElement("Username"/* local name */, "wsse" /* prefix */, URL_WSSE_NAMESPACE);
                userNameSOAPElement.addTextNode(this.usernameText);

                // Add password to UsernameToken
                javax.xml.soap.Name passwordElementName = soapEnvelope.createName("Password", "wsse", URL_WSSE_NAMESPACE);
                SOAPElement passwordSOAPElement = usernameTokenSOAPElement.addChildElement(passwordElementName);

                /* Add "Type" attribute to <Password> header element */
                //passwordSOAPElement.addAttribute(soapEnvelope.createName("Type", "", ""), 
                //      "http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText");
                passwordSOAPElement.addTextNode(this.passwordText);

            } catch (Exception e) {
                throw new RuntimeException("Error on wsSecurityHandler: " + e.getMessage());
            }

        }

        return true;
    }

    @Override
    public void close(MessageContext context) {
        // TODO Auto-generated method stub
    }

    @Override
    public boolean handleFault(SOAPMessageContext context) {
        // TODO Auto-generated method stub
        return true;
    }

    @Override
    public Set<QName> getHeaders() {
        // throw new UnsupportedOperationException("Not supported yet.");
        final QName securityHeader = new QName("http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd", 
                                                    "Security", "wsse");
        final HashSet headers = new HashSet();
        headers.add(securityHeader);

        return headers;
    }

} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-09-25T10:10:17.423

您还可以使用 Apache wss4j 轻松添加标头并加密您的密码。

```
import org.apache.ws.security.WSConstants;
import org.apache.ws.security.message.WSSecHeader;
import org.apache.ws.security.message.WSSecUsernameToken;

import javax.xml.namespace.QName;
import javax.xml.soap.SOAPMessage;
import javax.xml.soap.SOAPPart;
import javax.xml.ws.handler.MessageContext;
import javax.xml.ws.handler.soap.SOAPHandler;
import javax.xml.ws.handler.soap.SOAPMessageContext;
import java.io.ByteArrayOutputStream;
import java.util.Set;

public class WSSecurityHeaderSOAPHandler implements SOAPHandler<SOAPMessageContext> {

    private final String usernameText;
    private final String passwordText;

    public WSSecurityHeaderSOAPHandler(String usernameText, String passwordText) {
        this.usernameText = usernameText;
        this.passwordText = passwordText;
    }

    @Override
    public boolean handleMessage(SOAPMessageContext context) {
        Boolean outboundProperty = (Boolean) context.get(MessageContext.MESSAGE_OUTBOUND_PROPERTY);

        if (outboundProperty.booleanValue()) {

            try {
                SOAPMessage soapMessage = context.getMessage();
                soapMessage.removeAllAttachments();

                SOAPPart soappart = soapMessage.getSOAPPart();
                WSSecHeader wsSecHeader = new WSSecHeader();
                wsSecHeader.insertSecurityHeader(soappart);
                WSSecUsernameToken token = new WSSecUsernameToken();
                token.setPasswordType(WSConstants.PASSWORD_DIGEST);
                token.setUserInfo(usernameText, passwordText);
                token.build(soappart, wsSecHeader);

                soapMessage.saveChanges();
            } catch (Exception e) {
                throw new RuntimeException("Error on wsSecurityHandler: " + e.getMessage());
            }

        }

        return true;
    }

    @Override
    public boolean handleFault(SOAPMessageContext context) {
        return false;
    }

    @Override
    public void close(MessageContext context) {

    }

    @Override
    public Set<QName> getHeaders() {
        return null;
    }
} 
```

您需要像这样更新您的请求：

```
// This is the block that apply the Ws Security to the request
BindingProvider bindingProvider = (BindingProvider) portType;
List<Handler> handlerChain = new ArrayList<>();
handlerChain.add(new WSSecurityHeaderSOAPHandler("username", "password"));
bindingProvider.getBinding().setHandlerChain(handlerChain); 
```

Maven依赖：

```
 <dependency>
            <groupId>org.apache.ws.security</groupId>
            <artifactId>wss4j</artifactId>
            <version>1.6.19</version>
        </dependency> 
```

# php - 注意：使用未定义的常量 DB_HOST - 在第 31 行的 C:\xampp\htdocs\blog\system\functions.php 中假定为“DB_HOST”

> ID：14522932
> 
> 赞同：5
> 
> 时间：2013-01-25T13:40:51.460
> 
> 标签：php

遇到几个错误，我一辈子都看不到我跌倒的地方。下面是函数文件

```
<?php
include('config.php');

function getAllPosts()
{
    try {
        $dbh = new PDO(DB_HOST, DB_USER, DB_PASS);
    } catch (PDOException $e) {
        echo $e->getMessage();
    }

    $stmt = $dbh->prepare('SELECT id, title, content FROM posts ORDER BY created_at DESC');
    $stmt->execute();
    $results = $stmt->fetchAll(PDO::FETCH_ASSOC);
    return $results;
}

function getSinglePost($id)
{
    try {
        $dbh = new PDO(DB_HOST, DB_USER, DB_PASS);
    } catch (PDOException $e) {
        echo $e->getMessage();
    }
    $stmt = $dbh->prepare('SELECT title, content FROM posts WHERE id = ?');
    $bindings = array($id);
    $stmt->execute($bindings);
    $result = $stmt->fetch(PDO::FETCH_ASSOC);
    return $result;
}

?> 
```

还想我应该包含我正在运行的页面以生成错误

```
<?php include('system/functions.php'); ?>
<html>
<head>
<title>Create A New Post | My First Blog</title>

<link rel="stylesheet" type="text/css" href="style.css">

</head>

<body>
<div id="form">
<?php if (isset($_GET['id'])){ ?>

<h2>Single Post:</h2>

<?php $post = getSinglePost($_GET['id']); ?>
<?php print_r($post); ?>

<?php } ?>
<fieldset>
</fieldset>
</div>

</body>
</html> 
```

任何帮助都非常感谢这些都是错误的。

注意：使用未定义的常量 DB_HOST - 在第 31 行的 C:\xampp\htdocs\blog\system\functions.php 中假定为“DB_HOST”

注意：使用未定义的常量 DB_USER - 在第 31 行的 C:\xampp\htdocs\blog\system\functions.php 中假定为“DB_USER”

注意：使用未定义的常量 DB_PASS - 在 C:\xampp\htdocs\blog\system\functions.php 中的第 31 行无效数据源名称中假定为“DB_PASS” 注意：未定义变量：C:\xampp\htdocs\blog\ 中的 dbh第 37 行的 system\functions.php

致命错误：第 37 行 C:\xampp\htdocs\blog\system\functions.php 中的非对象调用成员函数 prepare()

也应该包含配置文件

```
<?php
define('DB_HOST','mysql:host=localhost;dbname=blog');
define('DB_USER','root');
define('DB_PASS','');
?> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-25T13:43:32.097

您正在使用的常量，`Host`尚未定义。你的可能有问题。`User``Password``config.php`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-25T13:51:44.957

这意味着在当前上下文中`DB_HOST`未定义或`DB_HOST`不可访问。

尝试将这些变量放在脚本的开头而不是`include('config.php');`

```
define('DB_HOST','mysql:host=localhost;dbname=blog');
define('DB_USER','root');
define('DB_PASS',''); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-02-18T19:26:53.390

使用特定术语代替参考...

例如

```
$dbh = new PDO(DB_HOST, DB_USER, DB_PASS); 
```

改成...

```
$dbh = new PDO('localhost', 'root', '') 
```

那会奏效。

# android - Android：不同的分享取决于应用程序

> ID：14522933
> 
> 赞同：0
> 
> 时间：2013-01-25T13:40:54.073
> 
> 标签：android, android-intent, sharing

我需要为我的应用程序实现共享。

问题是客户希望我以这样一种方式实现这一点：如果用户点击“Facebook”，则将共享某个文本、图像、url、描述等，而例如，如果他点击 twitter，则某个字符串将写入少于 140 个字符。

有没有办法做到这一点？

提前非常感谢！

编辑：不幸的是，我遇到了这篇文章[Android 共享意图选择器](https://stackoverflow.com/questions/4431386/android-share-intent-chooser)，它说没有办法做到这一点。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-25T14:08:18.247

> 有没有办法做到这一点？

不容易，主要是因为从 Android 的角度来看，没有 Facebook，也没有 Twitter。

Facebook 和 Twitter 是网站。他们还拥有 API/SDK，可用于开发 Android 应用程序。关键是有*apps*，复数。Twitter 本身发布的应用程序不止一款，更不用说第三方客户端了。

您无法知道是否安装了任何适用于网站 XYZ 的应用程序。一些彻头彻尾的白痴会说“哦，只检查这个包名”。即使 this-and-so 包名称存在，也没有证据表明用户使用它——它可能是预安装的并且无法删除，所以它会徘徊。而且，不能保证官方应用程序会永远保持这个包名，或者永远支持通过`ACTION_SEND`相同的方式共享内容等。

当然欢迎您让您的应用程序共享多种类型的东西。但是，用户需要先选择事物的*类型*，*然后再*选择支持该类型的*任何应用程序。*如果用户想在 Facebook、Gmail 或 Evernote 上使用“小于 140 个字符的某个字符串”而不是 Twitter，那是*他们的选择*。您可以滚动您自己的选择器，显示`ACTION_SEND`应用程序，然后让用户选择要发送的内容，但是由于您不知道他们选择的内容是否恰好是 Twitter 客户端，因此您无法可靠地为底层 Web 定制内容地点。

# php - 调用运行时创建的函数

> ID：14522937
> 
> 赞同：2
> 
> 时间：2013-01-25T13:41:05.390
> 
> 标签：php

我正在尝试为我正在处理的项目动态创建数据库实体泛化的基础。我基本上想为扩展它的任何类中的属性动态创建一组标准方法和工具。就像您通过 Python/Django 免费获得的工具一样。

我从这个人那里得到了这个想法：http: [//www.stubbles.org/archives/65-Extending-objects-with-new-methods-at-runtime.html](http://www.stubbles.org/archives/65-Extending-objects-with-new-methods-at-runtime.html)

所以我已经实现了上面帖子中描述的 __call 函数，

```
public function __call($method, $args) {
    echo "<br>Calling ".$method;
    if (isset($this->$method) === true) {
        $func = $this->$method;
        $func();
    }
} 
```

我有一个函数，它通过 get_object_vars 为我提供对象公共/受保护的属性，

```
public function getJsonData() {
    $var = get_object_vars($this);
    foreach($var as &$value) {
        if (is_object($value) && method_exists($value, 'getJsonData')) {
            $value = $value->getJsonData;
        }
    }
    return $var;
} 
```

现在我想为他们创建一些方法：

```
public function __construct() {
    foreach($this->getJsonData() as $name => $value) {
        // Create standard getter
        $methodName = "get".$name;
        $me = $this;
        $this->$methodName = function() use ($me, $methodName, $name) { 
            echo "<br>".$methodName." is called";
            return $me->$name; 
        };
    }
} 
```

感谢 Louis H. 在下面指出了“使用”关键字。这基本上会即时创建一个匿名函数。该函数是可调用的，但它不再位于其对象的上下文中。它会产生“致命错误：无法访问受保护的财产”

不幸的是，我绑定到 PHP 5.3 版，它排除了 Closure::bind。[因此，在 PHP](https://stackoverflow.com/questions/6445392/lazy-loading-class-methods-in-php)中延迟加载类方法中建议的解决方案在这里不起作用。

我在这里很困惑......还有其他建议吗？

**更新**

为简洁起见进行了编辑。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T13:46:11.330

像这样尝试（你必须使你需要的变量可用于方法）

```
$this->$methodName = function() use ($this, $methodName, $name){ 
    echo "<br>".$methodName." is called";
    return $this->$$name; 
}; 
```

您应该可以通过`$this`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-29T11:35:59.430

我没有更新上面的原始问题，而是在此处为遇到相同问题的任何人提供了完整的解决方案：

首先，由于闭包不能访问真正的对象，我需要在创建闭包函数时将实际值包含在“use”声明中（参见上面的原始 __construct 函数）：

```
$value =& $this->$name;
$this->$methodName = function() use ($me, $methodName, &$value)  { 
    return $value; 
}; 
```

其次，__call 魔术方法不仅需要调用闭包函数，还需要从它返回任何输出。所以我不只是调用 $func()，而是返回 $func();

这成功了！:-)

# c++ - 检查结构中是否存在字段

> ID：14522939
> 
> 赞同：0
> 
> 时间：2013-01-25T13:41:12.930
> 
> 标签：c++, templates, struct

> **可能重复：**
> [如何检测类中是否存在特定的成员变量？](https://stackoverflow.com/questions/1005476/how-to-detect-whether-there-is-a-specific-member-variable-in-class)

我有一个模板化函数，它以结构体为参数。如果结构包含字段“id”，则函数可能会继续，例如：

```
template<typename PointT>
void doSomething(PointT point) {
  if (containsField(point, "id")) {
    //do stuff
  }
} 
```

我知道专业化，不幸的是 PointT 可以是任何具有字段 id 的类型我相信我在 boost 中看到过类似的东西 ao 但找不到了

有任何想法吗？？

# apache - WLS 负载平衡查询

> ID：14522947
> 
> 赞同：0
> 
> 时间：2013-01-25T13:41:31.980
> 
> 标签：apache, ejb, weblogic, load-balancing, weblogic11g

我有一个 Weblogic 集群，Apache 充当前端代理。默认情况下，Weblogic 集群和插件使用循环算法，假设如果我将负载平衡算法更改为基于权重或随机，weblogic 插件将如何了解 WLS 集群端的负载平衡算法更改。为了达到这个目的，我们需要一个硬件负载均衡器吗？Apache 作为带有 WLS 插件的前端代理将只支持循环算法还是支持其他负载均衡算法。对于 HA 大规模生产环境，我们更喜欢带有 WLS 插件的 Apache 还是像 bigip 或 cisco lb 这样的硬件负载均衡器作为前端Weblogic 的终结。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T09:35:01.403

正如评论已经指出的那样，仅 EJB 和 RMI 对象支持基于权重的方法。请参考 WLS 集群文档：[http ://docs.oracle.com/cd/E23943_01/web.1111/e13709/load_balancing.htm#CHDGFIBD](http://docs.oracle.com/cd/E23943_01/web.1111/e13709/load_balancing.htm#CHDGFIBD)

如果您想对 Web 会话进行负载平衡，您可能需要研究专门的硬件或软件组件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T15:16:53.467

评论是对的。apache 插件仅使用 Round Robin。对于其他负载均衡策略，您必须选择 HW 负载均衡器。

关于你的最后一个问题，我们通常更喜欢 HW 负载均衡器而不是 Apache + 插件，因为负载均衡策略有更多选择，更好的管理界面以及负载均衡器提供的一些额外功能，例如压缩，SPDY 支持等。但是如果你有很多对于静态内容，Apache + 插件是不错的选择，因为它可以直接提供静态内容而不会影响 weblogic 集群，从而减少 WLS 服务器负载。还有一个常见的架构设计是硬件负载均衡器 --> apache --> weblogic 集群。因此apache服务器上也有负载平衡和HA。

# jquery - jQuery 选择器不是 html 标签或类或 id

> ID：14522954
> 
> 赞同：0
> 
> 时间：2013-01-25T13:41:52.737
> 
> 标签：jquery, css-selectors, handle

我想知道以下是否可能。

*   当您想将句柄分配给 id 时，它用作 $("#idhere")
*   当您想为类名分配句柄时，它用作 $(".classname")
*   当您想为 htmltag 分配句柄时，它用作 $("div")

可以说我需要一个结合了所有这些东西的东西。（就此而言，它必须是一个不区分上述任何一种的选择器。

例如，当我有类似的东西时：

```
<input name="whatever" my_custom_trigger="my_identifier"> 
```

或者

```
<div id="thisid" class="thisclass" my_custom_trigger="my_identifier">output</div> 
```

例如，我需要将 .click 分配给 [my_custom_trigger]，因为触发器将分配给所有类型的 html 项目（div、input、span 或任何需要的）

所以基本上我会有类似的东西

```
$("my_custom_trigger=>my_identifier").click(function(){
    //rest of code
}); 
```

这可能吗？

@mods：抱歉，如果之前处理过，但我发现很难搜索这个问题，因为我不知道找到相同问题的关键字！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-25T13:44:22.083

你正在寻找这样一个sintax

```
$("[my_custom_trigger='my_identifier']").first().click(function(){
    //rest of code
}); 
```

但是使用 data-my_custom_trigger 作为属性名称，因为 HTML5 标准要求 data- 在所有自定义属性前面。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T13:45:56.117

如果它是一个属性，您可以使用[`[attribute='value']`](http://api.jquery.com/attribute-equals-selector/)选择器：

```
$("[my_custom_trigger='my_identifier']").click(function(){
    //rest of code
}); 
```

但这将搜索您的 DOM 中的每个元素，开始时不会那么快，并且它不是有效的 html 标记，如果您使用的是 HTML5，您可以将它包含在`data-attributename`（并将属性名称更改为您想要的任何内容）并绑定事件那样，但你应该让嘶嘶声更容易找到元素。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-25T13:46:10.677

您可以使用以下方法轻松识别您自己的选择器：

```
$('*[my_custom_trigger="my_identifier"]').click(function(){
    // do what you wish.
}); 
```

# c# - 使用页面路由的链接问题

> ID：14522956
> 
> 赞同：1
> 
> 时间：2013-01-25T13:42:03.633
> 
> 标签：c#, asp.net, routes

我正在使用 a`RouteTable`为我的网站注册一些路线。现在，它看起来像这样：

**全球.asax**

```
void Application_Start(object sender, EventArgs e)
{    
    RemoteReaderPlugin.Current.AllowRemoteRequest += Current_AllowRemoteRequest;

    RegisterRoutes(RouteTable.Routes);
}

public static void RegisterRoutes(RouteCollection routes)
{
    //routes.Ignore("{resource}.axd/{*pathInfo}");

    //Clan
    routes.MapPageRoute("","Clan/{address}","~/Clan/Default.aspx");
    routes.MapPageRoute("", "Clan/Register", "~/Clan/Register.aspx");
    routes.MapPageRoute("", "Member/GameRanking/{address}", "~/Member/GameRanking.aspx");

    //Member
    routes.MapPageRoute("", "Member/{address}", "~/Member/Default.aspx");
    routes.MapPageRoute("", "Member/Register", "~/Member/Register.aspx");
    routes.MapPageRoute("", "Member/GameRanking/{address}", "~/Member/GameRanking.aspx");

    //Site
    routes.MapPageRoute("", "{address}", "~/{address}.aspx");
    routes.MapPageRoute("", "{address}/{resource}", "~/{address}/{resource}.aspx");
} 
```

当我将浏览器指向`http://localhost:27950/OCDB/Default`.

但是，当我将浏览器指向 时`http://localhost:27950/OCDB/`，我单击的任何链接都会导致此错误：

```
Server Error in '/OCDB' Application.

The HTTP verb POST used to access path '/OCDB/' is not allowed.

Description: An unhandled exception occurred during the execution of the current web request. Please review the stack trace for more information about the error and where it originated in the code. 

Exception Details: System.Web.HttpException: The HTTP verb POST used to access path '/OCDB/' is not allowed.

Source Error: 

An unhandled exception was generated during the execution of the current web request. Information regarding the origin and location of the exception can be identified using the exception stack trace below.

Stack Trace: 

[HttpException (0x80004005): The HTTP verb POST used to access path '/OCDB/' is not allowed.]
   System.Web.DefaultHttpHandler.BeginProcessRequest(HttpContext context, AsyncCallback callback, Object state) +2523961
   System.Web.CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute() +301
   System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously) +155

Version Information: Microsoft .NET Framework Version:4.0.30319; ASP.NET Version:4.0.30319.18034 
```

有没有办法解决这个错误？或者强制浏览器`/Default`在任何事情之前。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T14:48:39.380

如果替换此行会发生什么：

```
routes.MapPageRoute("", "{address}", "~/{address}.aspx"); 
```

和

```
routes.MapPageRoute("", "{address}", "~/{address}.aspx", true, defaults: new RouteValueDictionary { { "address", "default" } }); 
```

希望这会有所帮助

# ios - 需要帮助弄清楚为什么我的 UIImageView 不会缩放/平移 - 包含代码片段

> ID：14522959
> 
> 赞同：1
> 
> 时间：2013-01-25T13:42:22.423
> 
> 标签：ios, objective-c, cocoa, xamarin.ios

我已经放置了很多代码来尝试让 UIImageView 进行缩放/平移。在下面的代码中，我有一个带有分页的大滚动视图，并且在每个页面中我都放入了一个滚动视图，其中包含一个我希望能够平移和缩放的 imageView。我已经阅读了很多文章，但仍然无法进行缩放和平移。也许专家可以帮助我弄清楚我错过了什么。我是 iOS/MonoTouch 开发的新手。

需要注意的一件事是，当我放置断点时，我的 DidZoom (scrollViewDidZoom) 委托没有被击中。ZoomingStarted 被击中，但它不是我需要的代表。

```
//TODO: Code to put here to load image or whateer you want to display on this panel/page

    //Each page will have it's own scrollview for scrolling and zooming that image on the page
    var panelScrollView = new UIScrollView();

    panelScrollView.CanCancelContentTouches=false;
    panelScrollView.ClipsToBounds = true; 

    panelScrollView.MinimumZoomScale = 1.0f;
    panelScrollView.MaximumZoomScale = 3.0f;
    panelScrollView.MultipleTouchEnabled = true;
    //panelScrollView.Delegate = this;

    panelScrollView.BackgroundColor=UIColor.Black;
    if (page == 1)
    {
        panelScrollView.BackgroundColor=UIColor.Red;
    }

    panelScrollView.ScrollEnabled = true;
    panelScrollView.UserInteractionEnabled=true;
    var ui = new UIImage (_assetImages[page], 1.0f, UIImageOrientation.Up);

    //UIImageView imgView = new UIImageView(new RectangleF(100,100,1000,1000));
    //imgView.Image = ui;

    UIImageView imgView = new UIImageView(ui);

    panelScrollView.ContentSize = new SizeF(imgView.Frame.Size.Width, imgView.Frame.Size.Height);

    //Position the panelScrollView in the right page on the main scrollview
    RectangleF frame = scrollView.Frame;
    PointF location = new PointF();
    location.X = frame.Width * (_numberOfPanels - 1);
    frame.Location = location;

    panelScrollView.Frame = frame;
    //panelScrollView.ContentSize = new SizeF(1000,1000);
    panelScrollView.BackgroundColor=UIColor.Green;
    /*imgView.Frame = new RectangleF(panelScrollView.Frame.Width /2,
                                   panelScrollView.Frame.Height/2,
                                   imgView.Frame.Width,
                                   imgView.Frame.Height);*/
    imgView.Center = new PointF(panelScrollView.Frame.Width /2,
                                panelScrollView.Frame.Height/2);

    imgView.ContentMode=UIViewContentMode.ScaleAspectFit;

    //panelScrollView.ContentSize = panelScrollView.Bounds.Size;

    panelScrollView.ZoomingStarted += (object sender, UIScrollViewZoomingEventArgs e) => 
    {
        int x;
    };

    panelScrollView.DidZoom += (object sender, EventArgs e) => {
        //ScrollViewDidZoom handler
        //handle zooming and positioning of the panel scroll view (aka, scrollview of the image)
        var innerFrame = imgView.Frame;
        var scrollerBounds = panelScrollView.Bounds;

        if ( ( innerFrame.Size.Width < scrollerBounds.Size.Width ) || ( innerFrame.Size.Height < scrollerBounds.Size.Height ) )
        {
            var x = imgView.Center.X - ( scrollerBounds.Size.Width / 2 );
            var y = imgView.Center.Y - ( scrollerBounds.Size.Height / 2 );
            PointF myScrollViewOffset = new PointF(x, y);

            panelScrollView.ContentOffset = myScrollViewOffset;

        }

        UIEdgeInsets anEdgeInset =  new UIEdgeInsets(0, 0, 0, 0);
        if ( scrollerBounds.Size.Width > innerFrame.Size.Width )
        {
            anEdgeInset.Left = (scrollerBounds.Size.Width - innerFrame.Size.Width) / 2;
            anEdgeInset.Right = -anEdgeInset.Left;  // I don't know why this needs to be negative, but that's what works
        }
        if ( scrollerBounds.Size.Height > innerFrame.Size.Height )
        {
            anEdgeInset.Top = (scrollerBounds.Size.Height - innerFrame.Size.Height) / 2;
            anEdgeInset.Bottom = -anEdgeInset.Top;  // I don't know why this needs to be negative, but that's what works
        }
        panelScrollView.ContentInset = anEdgeInset;

};

panelScrollView.AddSubview(imgView);
scrollView.AddSubview(panelScrollView); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T13:55:38.823

如果您通过触摸图像本身来获得缩放事件，则默认情况下禁用图像视图的用户交互。设置“imgView.userInteractionEnabled = YES”或者如果缩放事件来自任何委托方法（在您的情况下可能是 UIScrollView 的委托），然后添加一个委托侦听器，如“panelScrollView.delegate = self”

我认为委托实现应该采用以下方式。

在代码中提到这一行，panelScrollView.delegate = self; 并在 self 类中添加以下方法。如果您收到未定义 UIScrollViewDelegate 的任何警告，请在头文件中添加**UIScrollViewDelegate 。**

```
- (void)scrollViewWillBeginZooming:(UIScrollView *)scrollView withView:(UIView *)view
{
}

- (UIView *)viewForZoomingInScrollView:(UIScrollView *)scrollView
{
}

- (void)scrollViewDidEndZooming:(UIScrollView *)scrollView withView:(UIView *)view atScale:(float)scale
{
} 
```

添加此代码后，应调用委托方法。

# java - 如何从 JSONObject 中检索日期

> ID：14522960
> 
> 赞同：1
> 
> 时间：2013-01-25T13:42:22.803
> 
> 标签：java, json, gson

如何从[Google Gson JSONObject](http://google-gson.googlecode.com/svn/trunk/gson/docs/javadocs/com/google/gson/JsonObject.html)检索 java.util.Date ？

```
{ ..., "date":"2012-12-21 00:58:06.0, ...} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-25T13:46:26.490

```
SimpleDateFormat formatter = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss.SSS");
Date date  = formatter.parse(object.getString("date"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-25T13:46:12.097

这里关于处理日期的部分可能会有所帮助：[https ://github.com/upgradingdave/javajing/tree/master/json-using-gson](https://github.com/upgradingdave/javajing/tree/master/json-using-gson)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-25T13:46:35.087

你不能直接做。您将需要解析此日期（字符串）以创建 java.util.Date。看看这里：[如何在java中验证这个时间/日期字符串？](https://stackoverflow.com/questions/12168668/how-to-verify-this-time-date-string-in-java/12168765#12168765)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-25T14:04:22.073

你试过这个：

```
Date date = gson.fromJson(json, Date.class);
//Where gson = new Gson(); 
```

# ios - 使用 CATextLAyer 嵌入富文本

> ID：14522968
> 
> 赞同：0
> 
> 时间：2013-01-25T13:43:00.673
> 
> 标签：ios, database, text, layer, catextlayer

我已经能够使用 CATextLayer 添加一个带有文本的图层。但是，我发现文本的呈现方式非常基本。我想用引号写段落，有时用粗体，斜体等......

有没有办法用 CATextLayer 做到这一点？

如果没有，我该如何管理它，特别是如果文本是从数据库中提取出来的？

例如，我希望能够以这种方式编写以下文本：

“那篇文章是关于就业的。他立刻翻阅了一遍。他的焦虑感再次浮现，他合上了杂志。

——嗯……他喘了口气。

——你找工作很久了吗？旁边的陌生人问道。”

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T13:46:33.657

如果您只想换行，则不需要富文本。添加`\n`一个换行符。所以：

```
layer.text=@"The article was about employment. He leafed through it in an instant. His feeling of anxiety resurfaced and he closed the magazine.\n\n-Hm…, he breathed.\n\n-Have you been looking for work long?, asked the stranger at his side." 
```

* * *

真正的富文本是不可能的 AFAIK

# c# - 将 vtkWarpLens 应用于相机与场景数据

> ID：14522973
> 
> 赞同：3
> 
> 时间：2013-01-25T13:43:16.487
> 
> 标签：c#, vtk

任何人都可以帮助我使用 vtkWarpLens 吗？

我想要做的是在相机上实现一个失真模式来修改数据的显示方式。

这是代码的核心（它在 C# 中，我使用的是 Activis）

```
 vtkPolyData pd = vtkPolyData.New();

        CreateFromFile(pd); // this creates a triangle representation of a height field

        double [] sr = pd.GetScalarRange();

        vtkLookupTable lut = vtkLookupTable.New();
        lut.SetNumberOfColors(16);
        lut.SetHueRange(0.667, 0.0);
        lut.Build();

        wl = vtkWarpLens.New();
        wl.SetInputConnection(pd.GetProducerPort());
        wl.SetPrincipalPoint(0.5, 0.5);
        wl.SetFormatWidth(1);
        wl.SetFormatHeight(1);
        wl.SetImageWidth(1000);
        wl.SetImageHeight(1000);
        wl.SetK1(0.01307);
        wl.SetK2(0.0003102);
        wl.SetP1(1.953e-005);
        wl.SetP2(-9.655e-005);

        vtkDataSetMapper dsmDistorted = vtkDataSetMapper.New();
        dsmDistorted.SetInputConnection(wl.GetOutputPort());
        dsmDistorted.SetLookupTable(lut);
        dsmDistorted.SetScalarRange(sr[0]+20, sr[1]);

        vtkActor dsDistortedActor = vtkActor.New();
        dsDistortedActor.SetMapper(dsmDistorted);

        m_renDistorted.AddActor(dsDistortedActor);
        m_renWin.SetDesiredUpdateRate(0);
        m_renWin.Render();
        m_renDistorted.ResetCamera(); 
```

因此，基本上，我正在使用多边形创建地形表示，将其传递给 warplens，将其传递给数据集映射器以赋予其漂亮的颜色，然后显示它。

问题是“扭曲”对于地形来说似乎是静态的，而不是相机。我对 VTK 很陌生，所以我可能不明白交互器和相机是如何相关的。

有人可以帮忙吗？

# .net - 如果继承了其中一个属性，如何设置复合主键？

> ID：14522976
> 
> 赞同：0
> 
> 时间：2013-01-25T13:43:22.430
> 
> 标签：.net, entity-framework, inheritance, ef-code-first, code-first

我正在尝试使用 ef 代码优先方法。我有一个基类：

```
 [Serializable]
    [Table("PayerEntity")]
    public abstract class PayerEntity
    {
      [DatabaseGenerated(DatabaseGeneratedOption.Identity)]
      public int PayerEntityId { get; set; }
    } 
```

另一个是它的后代：

```
 [Serializable]
    [Table("Group")]
    public class Group : PayerEntity
    {
      public int GroupId { get; set; }

      [MaxLength(50,ErrorMessage = "Max 50")]
      public string SomeGroupProp { get; set; }
    } 
```

在上下文类中，我重写了 OnModelCreating 方法：

```
 protected override void OnModelCreating(DbModelBuilder modelBuilder)
    {
      modelBuilder.Entity<Group>().HasKey(p => new { p.PayerEntityId, p.GroupId });
      base.OnModelCreating(modelBuilder);
    } 
```

但只有“PayerEntityId”列才是主键。我真的很感激任何帮助。

谢谢，彼得

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T17:20:52.827

您似乎想在具有不同键设置的表之间创建一对一的关系。这不可能进行约束（至少在 SQL 中），因此似乎 EF 正在尽最大努力定义一对一的关系，让两个表使用相同的键。

如果您想要 和 之间的一对多关系`PayerEntity`，`Group`您应该创建不相互继承的类。

```
[Table("PayerEntity")]
public  class PayerEntity
{
  public PayerEntity()
  {
        this.Groups = new HashSet<Group>();
  }

  [Key]
  public int PayerEntityId { get; set; }
  public virtual ICollection<Group> Groups { get; set; }
}

[Table("Group")]
public class Group
{
  public int PayerEntityId { get; set; }
  public int GroupId { get; set; }
  public virtual PayerEntity PayerEntity { get; set; }
}

protected override void OnModelCreating(DbModelBuilder modelBuilder)
{
  modelBuilder.Entity<Group>().HasKey(p => new { p.PayerEntityId, p.GroupId });
  base.OnModelCreating(modelBuilder);

  modelBuilder.Entity<Group>()
        .HasRequired(a => a.PayerEntity)
        .WithMany(b => b.Groups)
} 
```

# java - 查找字符串是否符合特定模式

> ID：14522979
> 
> 赞同：5
> 
> 时间：2013-01-25T13:43:34.860
> 
> 标签：java, string

我最近接受了谷歌软件工程职位的面试，问题是关于构建模式匹配器。

所以你必须建立

```
boolean isPattern(String givenPattern, String stringToMatch) 
```

执行以下操作的函数：

`givenPattern`是一个字符串，包含：

```
a) 'a'-'z' chars
b) '*' chars which can be matched by 0 or more letters
c) '?' which just matches to a character - any letter basically 
```

所以电话可能是这样的

`isPattern("abc", "abcd")`- 返回 false，因为它与模式不匹配（'d' 是额外的）

`isPattern("a*bc", "aksakwjahwhajahbcdbc")`, 这是真的，因为我们在开头有一个 'a'，后面有很多字符，然后它以 "bc" 结尾

`isPattern("a?bc", "adbc")`当模式的每个字符在给定字符串中匹配时返回 true。

在采访中，时间很短，我想可以通过模式来查看一个字符是字母、* 还是？然后分别匹配给定字符串中的字符。但这最终变成了一组复杂的 for 循环，我们未能在给定的 45 分钟内得出结论。

有人可以告诉我他们将如何快速有效地解决这个问题吗？

非常感谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-25T13:53:46.883

假设您被允许使用正则表达式，您可以编写如下内容：

```
static boolean isPattern(String givenPattern, String stringToMatch) {
    String regex = "^" + givenPattern.replace("*", ".*").replace("?", ".") + "$";

    return Pattern.compile(regex).matcher(stringToMatch).matches();
} 
```

`"^"`是字符串的开头是字符串
`"$"`的结尾
`.`是“任何字符”，恰好一次
`.*`是“任何字符”，0次或更多次

注意：如果您只想将`*`和限制`?`为字母，您可以使用`[a-zA-Z]`代替`.`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-25T14:01:03.523

```
boolean isPattern(String givenPattern, String stringToMatch) {
    if (givenPattern.empty)
        return stringToMatch.isEmpty();
    char patternCh = givenPatter.charAt(0);
    boolean atEnd = stringToMatch.isEmpty();
    if (patternCh == '*') {
        return isPattenn(givenPattern.substring(1), stringToMatch)
            || (!atEnd && isPattern(givenPattern, stringToMatch.substring(1)));
    } else if (patternCh == '?') {
        return !atEnd && isPattern(givenPattern.substring(1), 
            stringToMatch.substring(1));
    }
    return !atEnd && patternCh == stringToMatch.charAt(0)
          && isPattern(givenPattern.substring(1), stringToNatch.subtring(1);
} 
```

（递归最容易理解。）

# zend-framework - Zend_Controller_Action_Exception 未显示 404 页面

> ID：14522982
> 
> 赞同：0
> 
> 时间：2013-01-25T13:43:38.383
> 
> 标签：zend-framework, error-handling, zend-controller

如果数组包含少于 10 个元素，我试图让 Zend 抛出 404 错误，但它目前只是向我发送一个通用的“错误”页面。我知道 404 异常配置正确，因为它们在站点的其他地方工作，所以它一定是我的参数或其他东西的问题......

我尝试了几种不同的格式，并且检查了 Zend API 以确保我传递的参数正常并且它们似乎是正确的，但我一定做错了什么。

我的代码目前如下：

```
$properties = array(1,2,3,4,5,6,7,8,9)

if (count($properties) < 10){
    throw new Zend_Controller_Action_Exception('Page does not exist.', 404);
}
$this->view->rows = $properties; 
$this->callRender(); 
```

谢谢你的时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T10:26:43.393

查看[ErrorHandler 插件文档](http://framework.zend.com/manual/1.12/en/zend.controller.plugins.html#zend.controller.plugins.standard.errorhandler)以及它[在 MVC](http://framework.zend.com/manual/1.12/en/zend.controller.exceptions.html)中的工作方式。您会注意到默认情况下，errorHandler 作为`postDispatch()`插件工作。您尝试描述为“404”的活动完全在调度循环之外，因此它被视为任何其他程序错误。

我没有任何代码给你，但我很确定你可以在这 2 个参考中找到可用的答案。

# javascript - JavaScript - 如何返回一个值并传递它

> ID：14522983
> 
> 赞同：0
> 
> 时间：2013-01-25T13:43:44.140
> 
> 标签：javascript, position

我正在开发一个将发布一些数据的功能 - 图像槽 api 上标志/引脚的位置。

我在传递职位详细信息时遇到问题。

```
function sendOnClick() {
    function get_posx() {
        var relx = $("#image_edit").click(function(e) {
            var relX = e.pageX - this.offsetLeft;
            return relX
        });
        return relx;
    }

    jQuery.post('{% url case_image_detail_api case.pk image.pk %}', {
        'id' : '{{image.id}}',
        'image_posx' : get_posx(),
        'image_posy' : get_posx(),
    });
}; 
```

错误：NS_ERROR_XPC_BAD_CONVERT_JS：无法转换 JavaScript 参数

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T13:51:26.430

正如上面的评论所说，`sendOnClick`应该是事件处理程序：

```
function sendOnClick(e) {
    var relX = e.pageX - this.offsetLeft;
    var relY = e.pageY - this.offsetTop;

    jQuery.post('{% url case_image_detail_api case.pk image.pk %}', {
        'id' : '{{image.id}}',
        'image_posx' : relX,
        'image_posy' : relY
    });
};

$("#image_edit").click(sendOnClick); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T13:53:41.527

您的`get_posx`return `relx`，它是一个 jQuery 对象 ( `$("#image_edit").click(…);`)。这对于 HTTP 参数是不可序列化的，因为它包含 DOM 元素，并且 XMLHTTPRequest 会抱怨它。

如果您想在用户单击图像时发送请求，则需要将`$.post`调用放在事件处理程序中！

```
$("#image_edit").click(function sendOnClick(e) {
    var relx = e.pageX - this.offsetLeft,
        rely = e.pageY - this.offsetTop;

    jQuery.post('{% url case_image_detail_api case.pk image.pk %}', {
        'id' : '{{image.id}}',
        'image_posx' : relx,
        'image_posy' : rely
    });
}); 
```

# mysql - 按工作日分组

> ID：14522992
> 
> 赞同：2
> 
> 时间：2013-01-25T13:44:29.803
> 
> 标签：mysql, sql, group-by

拥有一张大桌子 T 的这一部分；

```
+---------------+------------+
| session_id    | visit_time       |
+---------------+------------+
| 4f89cebc109f9 | 1334431476 |
| 4f89cf283d21c | 1334431528 |
| 4f89cf283d21c | 1334431534 |
| 4f89cf3b350a6 | 1334431547 |
| 4f89cf42ab640 | 1334431554 |
+---------------+------------+ 
```

我想在工作日找到 session_id 的数量。Session_id 不是主键。所以我尝试了：

```
select count(distinct(session_id)) from T group by weekday(from_unixtime(time)) 
```

但这不起作用，因为如果相同`session_id`的`visit_time`两个星期天有相同的星期天，那么它将它们计为`1`，尽管当相同的星期天有相同的星期天时它正确地计`session_id`为1 `visit_time`。

预期的事情是：我想知道有多少 session-ids 访问日为 sun、mon 等。如果 session_id 在两个不同的星期天访问过，那么它们被计算两次，但如果在同一个星期天，那么只有 1 个计数。那么我该如何在 Mysql 中做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-25T13:46:36.267

使用`WEEK`而不是`WEEKDAY`

```
SELECT  WEEK(FROM_UNIXTIME(time)) WeekNo,
        DATE_FORMAT(FROM_UNIXTIME(time),'%a') WeekName,
        COUNT(DISTINCT(session_id)) 
FROM    T 
GROUP   BY WEEK(FROM_UNIXTIME(time)),
           DATE_FORMAT(FROM_UNIXTIME(time),'%a') 
```

*   [星期](http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_week)

# snapshot - AccuRev CLI 列表快照

> ID：14522998
> 
> 赞同：0
> 
> 时间：2013-01-25T13:44:57.043
> 
> 标签：snapshot, accurev

有什么方法可以使用 AccuRev CLI 检索 Depot/Stream 中所有快照的列表？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T21:35:44.433

您将需要创建一个脚本来解析快照流。

查看 accurev "show" 命令。

此命令将列出您的仓库中的所有流。

accurev 显示 -p 流

您将需要使用 -fx 选项来生成 xml 格式以仅解析出快照流。

# forms - 如果表单无效，则使用 jQuery validate 防止 jQuery Ajax 调用

> ID：14522999
> 
> 赞同：1
> 
> 时间：2013-01-25T13:44:57.810
> 
> 标签：forms, jquery

我正在尝试使用 jQuery validate 来验证表单并处理表单提交，但似乎无法正确获取语法，并且无法在 API 中找到像我这样的示例。我的代码如下：

```
$("#beta_form").validate({
    rules: {   
        p_emailaddress: {
            required: true,
            email :true
        } 
    }
    submitHandler : function() {
        $.ajax({
            type:'POST',
            url :'websiteUrlWithService',
            data: $('#beta_form').serialize(),
            complete: function() { 
                $('#dialog').jqmHide();
                $('#formSubmissionThanks').jqmShow();               
            }               
        });
    }
}); 
```

表单 HTML 如下：

```
 <form class="login_form" id="beta_form" name="beta_form">

            <label for="p_name" class="login_label">Name:</label>
            <input type="hidden" id="p_enquiry" name="p_enquiry" value="Beta Enquiry" />
            <input type="text" id="p_name" name="p_name" class="login_input" value="" />
             <br />
            <br/>
            <label for="emailaddress" class="login_label">Email Address:</label>
            <input type="text" id="p_emailaddress" name="p_emailaddress" class="login_input" value="" />
            <br />
            <br/>
            <label for="role" class="login_label">Current Role:</label>
            <select size="1" id="p_role" name="p_role">  
                  <option value="1">None Selected</option>
                  <option value="2">Recruiter</option>
                  <option value="3">HR Role</option>
                  <option value="4">Self Employed</option>

                </select>
            <br/>
            <br/>
            <label for="terms" class="login_label">Include me in the Beta testing selection?</label>

            <input type="checkbox" id="p_terms" name="p_terms" class="boxes login_label"/>
            <br />
            <br/>
            <input type="submit" id="submitbuttonbeta" class="login_submitbutton" value="Submit" />
            </form> 
```

当我使用 Firebug 运行它时，它表明我`}`在属性列表之后缺少 a，`submitHandler`但据我所知，语法是正确的。此错误阻止我的表单完全触发。

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T13:47:39.137

我认为您只是在定义规则对象后缺少一个“，”，实际上......

```
$("#beta_form").validate({
   rules: {   
     p_emailaddress: {
        required: true,
        email :true
     } 
    },

   submitHandler : function() {
    $.ajax({
        type:'POST',
        url :'websiteUrlWithService',
        data: $('#beta_form').serialize(),
        complete: function() { 
            $('#dialog').jqmHide();
                $('#formSubmissionThanks').jqmShow();               
            }               
    });

   }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T13:49:14.893

你少了逗号

```
$("#beta_form").validate({
       rules: {   
         p_emailaddress: {
            required: true,
            email :true
         } 
        },
       submitHandler : function() {
        $.ajax({
            type:'POST',
            url :'websiteUrlWithService',
            data: $('#beta_form').serialize(),
            complete: function() { 
                $('#dialog').jqmHide();
                    $('#formSubmissionThanks').jqmShow();               
                }               
        });

       }
    }); 
```