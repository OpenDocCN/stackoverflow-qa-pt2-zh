# StackOverflow 问答 14082000-14082999

# mysql - 比较mysql中的平均值

> ID：14082001
> 
> 赞同：2
> 
> 时间：2012-12-29T13:10:33.377
> 
> 标签：mysql, sql

我有两张桌子；一个包含学生`names`和另一个是包含和他们`sids`的“接受”表。`sids of students``grades`

我想显示平均大于学生名字“Peter-Parker”的学生的名字。

我已经尝试了下面的查询，但它不起作用。

```
SELECT s.sid, s.fname, s.lname
FROM student s, take t
WHERE s.sid = t.sid AND AVG(t.grade) > ALL(
SELECT AVG(grade)
FROM take, student
WHERE student.fname = 'Ali' and student.lname='Demir');
 WITH AliAv(avg) AS
 (SELECT AVG(grade) from take t, student s
 where t.sid = s.sid ands.fname = 'Ali' and s.lname = 'Demir')
 select student.sid, student.fname, student.lname
 from student, take
 where student.sid = take.sid Group by student.sid
 having avg(take.grade) > AliAv.av; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T13:30:37.217

```
SELECT s.sid, s.fname, s.lname, AVG(t.grade) AS average
FROM student AS s
JOIN take AS t ON t.sid = s.sid
GROUP BY s.sid
HAVING average > (
    SELECT AVG(t2.grade)
    FROM student AS s2
    JOIN take AS t2 ON t2.sid = s2.sid
    WHERE s2.fname = 'Peter' and s2.lname = 'Parker'
) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T13:42:02.110

这适用于 SQL Server，我不知道该语法在 MySQL 中是否有效：

```
SELECT *
FROM Student s
WHERE
  (SELECT AVG(Grade) FROM Take WHERE SID=s.ID) > (SELECT AVG(Grade) FROM Take WHERE SID = (SELECT SID FROM Student WHERE FName='Peter' AND LName='Parker')) 
```

# java - 在一个参数化类（junit）中创建多个参数集

> ID：14082004
> 
> 赞同：60
> 
> 时间：2012-12-29T13:10:38.900
> 
> 标签：java, junit, parameterized, parameterized-unit-test

目前，我必须为要使用多个不同输入测试的每个方法创建一个参数化测试类。有没有办法将这些添加到一个文件中？

现在有`CalculatorTestAdd.java`一组参数用于检查`Add()`函数是否正常工作。我是否有可能将此集合“连接”到`Add()`函数并创建一个用于该`Subtract()`方法的附加集合并将此方法添加到同一个测试类中，从而生成一个名为的文件`CalculatorTest.java`？

* * *

## 回答 #1

> 赞同：69
> 
> 时间：2014-10-23T09:55:41.193

这个答案类似于 Tarek 的答案（参数化部分），尽管我认为它更具可扩展性。还可以解决您的问题，如果一切正确，您将不会失败测试：

```
@RunWith(Parameterized.class)
public class CalculatorTest {
    enum Type {SUBSTRACT, ADD};
    @Parameters
    public static Collection<Object[]> data(){
        return Arrays.asList(new Object[][] {
          {Type.SUBSTRACT, 3.0, 2.0, 1.0},
          {Type.ADD, 23.0, 5.0, 28.0}
        });
    }

    private Type type;
    private Double a, b, expected;

    public CalculatorTest(Type type, Double a, Double b, Double expected){
        this.type = type;
        this.a=a; this.b=b; this.expected=expected;
    }

    @Test
    public void testAdd(){
        Assume.assumeTrue(type == Type.ADD);
        assertEquals(expected, Calculator.add(a, b));
    }

    @Test
    public void testSubstract(){
        Assume.assumeTrue(type == Type.SUBSTRACT);
        assertEquals(expected, Calculator.substract(a, b));
    }
} 
```

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2018-02-02T13:35:53.630

在我看来，另一个纯 JUnit 但优雅的解决方案是将每个参数化测试封装在它们自己的内部静态类中，并在顶级测试类上使用[封闭式测试运行器。](http://junit.org/junit4/javadoc/4.12/org/junit/experimental/runners/Enclosed.html)这使您不仅可以为每个测试单独使用不同的参数值，还可以使用完全不同的参数测试方法。

这就是它的样子：

```
@RunWith(Enclosed.class)
public class CalculatorTest {

  @RunWith(Parameterized.class)
  public static class AddTest {

    @Parameters
    public static Collection<Object[]> data() {
      return Arrays.asList(new Object[][] {
          { 23.0, 5.0, 28.0 }
      });
    }

    private Double a, b, expected;

    public AddTest(Double a, Double b, Double expected) {
      this.a = a;
      this.b = b;
      this.expected = expected;
    }

    @Test
    public void testAdd() {
      assertEquals(expected, Calculator.add(a, b));
    }
  }

  @RunWith(Parameterized.class)
  public static class SubstractTest {

    @Parameters
    public static Collection<Object[]> data() {
      return Arrays.asList(new Object[][] {
          { 3.0, 2.0, 1.0 }
      });
    }

    @Parameter(0)
    private Double a;
    @Parameter(1)
    private Double b;
    @Parameter(2)
    private Double expected;

    @Test
    public void testSubstract() {
      assertEquals(expected, Calculator.substract(a, b));
    }
  }

  @RunWith(Parameterized.class)
  public static class MethodWithOtherParametersTest {

    @Parameters
    public static Collection<Object[]> data() {
      return Arrays.asList(new Object[][] {
          { 3.0, 2.0, "OTHER", 1.0 }
      });
    }

    private Double a;
    private BigDecimal b;
    private String other;
    private Double expected;

    public MethodWithOtherParametersTest(Double a, BigDecimal b, String other, Double expected) {
      this.a = a;
      this.b = b;
      this.other = other;
      this.expected = expected;
    }

    @Test
    public void testMethodWithOtherParametersTest() {
      assertEquals(expected, Calculator.methodWithOtherParametersTest(a, b, other));
    }
  }

  public static class OtherNonParameterizedTests {

    // here you can add any other test which is not parameterized

    @Test
    public void otherTest() {
      // test something else
    }
  }
} 
```

`@Parameter`注意 中注释的用法`SubstractTest`，我认为它更具可读性。但这更多的是品味问题。

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2018-09-02T17:57:58.910

好吧，现在**JUnit-5**为您提供了一个解决方案 - 通过重新定义编写参数化测试的方法。**现在可以使用@ParameterizedTest**在方法级别定义参数化测试，并且可以使用@MethodSource 为方法源提供方法源 **。**

因此，在您的情况下，您可以有 2 个单独的数据源方法来为您的 add() 和 subtract() 测试方法提供输入数据，它们都在同一个类中。你的代码应该是这样的：

```
public class CalculatorTest{
    public static int[][] dataSetForAdd() {
        return new int[][] { { 1 , 2, 3 }, { 2, 4, 6 }, { 121, 4, 125 } };
    }

    public static int[][] dataSetForSubtract() {
        return new int[][] { { 1 , 2, -1 }, { 2, 4, -2 }, { 121, 4, 117 } };
    }

    @ParameterizedTest
    @MethodSource(names = "dataSetForAdd")
    void testCalculatorAddMethod(int[] dataSetForAdd) {
        Calculator calculator= new Calculator();
        int m1 = dataSetForAdd[0];
        int m2 = dataSetForAdd[1];
        int expected = dataSetForAdd[2];
        assertEquals(expected, calculator.add(m1, m2));
    }

    @ParameterizedTest
    @MethodSource(names = "dataSetForSubtract")
    void testCalculatorAddMethod(int[] dataSetForSubtract) {
        Calculator calculator= new Calculator();
        int m1 = dataSetForSubtract[0];
        int m2 = dataSetForSubtract[1];
        int expected = dataSetForSubtract[2];
        assertEquals(expected, calculator.subtract(m1, m2));
    }
} 
```

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2014-08-23T18:22:31.360

我确定你不再有这个问题了，但我想到了 3 种方法可以做到这一点，每种方法都有其优点和缺点。使用参数化运行器，您必须使用一种解决方法。

# - 通过参数化使用更多参数

如果您必须从外部加载参数，您只需为预期结果添加一个参数。

**优点**：更少的编码，它运行所有的测试。

**缺点**：每组不同测试的新参数。

```
@RunWith(Parameterized.class)
public class CalculatorTest extends TestCase {
    private Calculator calculator;
    private int operator1;
    private int operator2;
    private int expectedSum;
    private int expectedSub;

    public CalculatorTest(int operator1, int operator2, int expectedSum, int expectedSub) {
        this.operator1 = operator1;
        this.operator2 = operator2;
    }

    @Params
    public static Collection<Object[]> setParameters() {
        Collection<Object[]> params = new ArrayList<>();
        // load the external params here
        // this is an example
        params.add(new Object[] {2, 1, 3, 1});
        params.add(new Object[] {5, 2, 7, 3});

        return params;
    }

    @Before
    public void createCalculator() {
        calculator = new Calculator();
    }

    @Test
    public void addShouldAddTwoNumbers() {
        assertEquals(expectedSum, calculator.add(operator1, operator2));
    }

    @Test
    public void subtractShouldSubtractTwoNumbers() {
        assertEquals(expectedSub, calculator.subtract(operator1, operator2));
    }

    @After
    public void endTest() {
        calculator = null;
        operator1 = null;
        operator2 = null;
        expectedSum = null;
        expectedSub = null;
    }
} 
```

# - 不使用参数化运行器

如果您以编程方式设置参数，这可以正常工作。

**优点**：您可以进行任意数量的测试，而无需设置大量参数。

**缺点**：更多的编码，它会在第一次失败时停止（这可能不是一个缺点）。

```
@RunWith(JUnit4.class)
public class CalculatorTest extends TestCase {
    private Calculator calculator;

    @Before
    public void createCalculator() {
        calculator = new Calculator();
    }

    @Test
    public void addShouldAddTwoNumbers() {
        int[] operator1 = {1, 3, 5};
        int[] operator2 = {2, 7, 9};
        int[] expectedResults = {3, 10, 14};

        for (int i = 0; i < operator1.length; i++) {
            int actualResult = calculator.add(operator1[i], operator2[i]);
            assertEquals(expectedResults[i], actualResult);
        }
    }

    @Test
    public void subtractShouldSubtractTwoNumbers() {
        int[] operator1 = {5, 8, 7};
        int[] operator2 = {1, 2, 10};
        int[] expectedResults = {4, 6, -3};

        for (int i = 0; i < operator1.length; i++) {
            int actualResult = calculator.subtract(operator1[i], operator2[i]);
            assertEquals(expectedResults[i], actualResult);
        }
    }

    @After
    public void endTest() {
        calculator = null;
    }
} 
```

# - 使用 JUnitParams

我与实用主义者没有任何关系，我几天前才发现这个。该框架在 JUnit 之上运行，并以不同的方式处理参数化测试。参数直接传递给测试方法，因此您可以在同一个类中为不同的方法设置不同的参数。

**优点**：无需变通方法即可实现与上述解决方案相同的结果。

**缺点**：也许您的公司不允许您向项目添加新的依赖项或强制您使用一些奇怪的编码规则（例如专门使用参数化运行器）。让我们面对现实吧，它发生的比我们想的要多。

[这](http://www.javacodegeeks.com/2013/12/parameterized-junit-tests-with-junitparams.html)是 JUnitParams 的一个很好的例子，你可以在这个[Github](https://github.com/Pragmatists/junitparams)页面上获取项目/检查代码。

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2012-12-29T13:40:08.603

您可以使用[https://github.com/piotrturski/zohhak](https://github.com/piotrturski/zohhak)的参数：

```
@TestWith({
   "1, 7, 8",
   "2, 9, 11"
})
public void addTest(int number1, int number2, int expectedResult) {
    BigDecimal result = calculator.add(number1, number2);
    assertThat(result).isEqualTo...
} 
```

如果要从文件中加载参数，可以使用[http://code.google.com/p/fuzztester/](http://code.google.com/p/fuzztester/)或[http://code.google.com/p/junitparams/](http://code.google.com/p/junitparams/)

如果您需要真正的灵活性，您可以使用 junit 的 @Parameterized 但它会使您的代码混乱。你也可以使用 junit 的理论——但这对于计算器测试来说似乎有点过头了

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2012-12-29T13:22:45.047

是的。你没有什么特别的事情要做。对于参数的每一组值，每个@Test 方法都运行一次，因此只需一个方法测试 add() 和另一个方法测试减法()。

我还可以补充一点，口述此要求的人是被误导的。规定“适用于所有情况”的某些设计模式没有什么价值——还不如雇佣训练有素的猴子。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2018-11-07T17:27:16.973

使用 Junit Jupiter： [https ://www.petrikainulainen.net/programming/testing/junit-5-tutorial-writing-parameterized-tests/](https://www.petrikainulainen.net/programming/testing/junit-5-tutorial-writing-parameterized-tests/)

```
import intf.ICalculator;

public class Calculator implements ICalculator {
    @Override
    public int plus(int a, int b) {return a + b; }

    @Override
    public int minuis(int a, int b) {return a - b;}

    @Override
    public int multy(int a, int b) {return a * b;}

    @Override  // check in junit byZero
    public int divide(int a, int b) {return a / b;}

} 
```

测试类：

```
import static org.junit.Assert.assertEquals;

import org.junit.jupiter.api.DisplayName;
import org.junit.jupiter.params.ParameterizedTest;
import org.junit.jupiter.params.provider.CsvSource;

class CalculatorJupiter5Test {

    Calculator calculator = new Calculator();

    @DisplayName("Should calculate the correct sum")
    @ParameterizedTest(name = "{index} => a={0}, b={1}, sum={2}")
    @CsvSource({
            "5, 3, 8",
            "1, 3, 4",
            "6, 6, 12",
            "2, 3, 5"
    })
    void sum(int a, int b, int sum) {
        assertEquals(sum, calculator.plus(a, b) );
    }

    @DisplayName("Should calculate the correct multy")
    @ParameterizedTest(name = "{index} => a={0}, b={1}, multy={2}")
    @CsvSource({
        "5, 3, 15",
        "1, 3, 3",
        "6, 6, 36",
        "2, 3, 6"
    })
    void multy(int a, int b, int multy) {
        assertEquals(multy, calculator.multy(a, b) );
    }

    @DisplayName("Should calculate the correct divide")
    @ParameterizedTest(name = "{index} => a={0}, b={1}, divide={2}")
    @CsvSource({
        "5, 3, 1",
        "14, 3, 4",
        "6, 6, 1",
        "36, 2,  18"
    })
    void divide(int a, int b, int divide) {
        assertEquals(divide, calculator.divide(a, b) );
    }

   @DisplayName("Should calculate the correct divide by zero")
   @ParameterizedTest(name = "{index} => a={0}, b={1}, divide={2}")
   @CsvSource({
      "5, 0, 0",
   })
    void divideByZero(int a, int b, int divide) {
     assertThrows(ArithmeticException.class,
         () -> calculator.divide(a , b),
         () -> "divide by zero");
    }

    @DisplayName("Should calculate the correct minuis")
    @ParameterizedTest(name = "{index} => a={0}, b={1}, minuis={2}")
    @CsvSource({
        "5, 3, 2",
        "1, 3, -2",
        "6, 6, 0",
        "2, 3, -1"
    })
    void minuis(int a, int b, int minuis) {
        assertEquals(minuis, calculator.minuis(a, b) );
    }
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-04-09T09:19:25.887

我使用`junitparams`，它允许我在每个测试中传递不同的参数集。JunitParams 使用方法返回参数集，并且在测试中，您提供方法名称作为参数输入源，因此更改方法名称将更改数据集。

```
import com.xx.xx.xx.Transaction;
import junitparams.JUnitParamsRunner;
import junitparams.Parameters;
import org.junit.Before;
import org.junit.Test;
import org.junit.runner.RunWith;

import javax.validation.ConstraintViolation;
import javax.validation.Validation;
import javax.validation.Validator;
import javax.validation.ValidatorFactory;
import java.util.Arrays;
import java.util.List;
import java.util.Set;

import static org.junit.Assert.assertFalse;
import static org.junit.Assert.assertTrue;

@RunWith(JUnitParamsRunner.class)
public class IpAddressValidatorTest {

    private Validator validator;

    @Before
    public void setUp() {
        ValidatorFactory factory = Validation.buildDefaultValidatorFactory();
        validator = factory.getValidator();

    }

    public static List<String> goodData() {
        return Arrays.asList(
                "10.10.10.10",
                "127.0.0.1",
                "10.136.182.1",
                "192.168.1.1",
                "192.168.1.1",
                "1.1.1.1",
                "0.0.0.0"
        );
    }

    public static List<String> badData() {
        return Arrays.asList(
                "01.01.01.01",
                "255.255.255.256",
                "127.1",
                "192.168.0.0"
        );
    }

    @Test
    @Parameters(method = "goodData")
    public void ipAddressShouldBeValidated_AndIsValid(String ipAddress) {
        Transaction transaction = new Transaction();
        transaction.setIpAddress(ipAddress);
        Set<ConstraintViolation<Transaction>> violations = validator.validateProperty(transaction, "ipAddress");
        assertTrue(violations.isEmpty());
    }

    @Test
    @Parameters(method = "badData")
    public void ipAddressShouldBeValidated_AndIsNotValid(String ipAddress) {
        Transaction transaction = new Transaction();
        transaction.setIpAddress(ipAddress);
        Set<ConstraintViolation<Transaction>> violations = validator.validateProperty(transaction, "ipAddress");
        assertFalse(violations.isEmpty());
    }

} 
```

# c# - C# MVVM：添加新的 ViewModel（严格的非暴露模型设计）

> ID：14082006
> 
> 赞同：4
> 
> 时间：2012-12-29T13:10:44.710
> 
> 标签：c#, mvvm, viewmodel

我一直在使用 C# 开发 MVVM 应用程序，但在处理我的视图摘要的 ViewModels 集合时始终遇到一些问题。具体来说，它们都倾向于与 Model 作为 ViewModel 的私有成员的问题有关。

这方面的一个例子是创建新的 ViewModel（根据 View 的要求）。对于一些序言（尽管您可能不需要这些来帮助我）这里是示例模型和视图模型类：

```
Private Class Model()
{
    public string Name { get; set; }
}

Public Class ViewModel()
{
    Private Model _Model;

    Public Void ViewModel(Model model)
    {
        _Model = model;
    }

    Public String Name
    { 
        get
        {
            return _Model.Name;
        }
        set
        {
            _Model.Name = value;
        }
    }
} 
```

整个模型永远不会直接作为 ViewModel 的公共成员公开。MainWindowViewModel 处理模型（私有，视图看不到这些）和 ViewModel（公共用于视图消化）的集合：

```
Public Class MainWindowViewModel
{
    Private List<Model> _NamesModel;
    Private ObservableCollection<ViewModel> _NamesViewModel;

    Public Void MainWindowViewModel()
    {
        //Lets pretend we have a service that returns a list of models
        _NamesModel = Service.Request();
        foreach(Model model in _NamesModel)
        {
            ViewModel viewmodel = new ViewModel(model);
            _NamesViewModel.Add(viewmodel);
        }
    }

    Public ObservableCollection<ViewModel> NamesViewModel
    {
        get
        {
            return _NamesViewModel;
        }
    }
} 
```

现在这就是序言，但现在我有一个问题。如何添加新的 ViewModel？我的视图中的方法是否会创建一个新的 ViewModel 并填充它？作为一个纯粹主义者，我假设视图根本不应该被允许创建或填充模型。我的 ViewModel 是否应该包含一个不接受任何内容（即没有底层模型）而是创建一个空白来填充的构造函数？

这类问题不断涌现出“纯”MVVM 方法。我不得不在我的 ViewModel (bool compare(Model model)) 中创建一个公共方法，它将一个模型（准备删除等）与它的内部模型进行比较。如果模型被公开（破坏纯度），那么做一些事情会容易得多，比如找到连接到模型的 ViewModel。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T13:32:47.640

我可以同情其中一些问题。我最近编写了一个 MVVM 应用程序，其中经常出现类似的问题。诀窍之一是确定 - 明确 - 哪个类将负责 Model 实例。你想让它成为你的 MainWindowViewModel 吗？还是你的 NameViewModel？您不想在这两个类之间分担创建/删除模型的责任；你会有相当大的后勤噩梦。

其次，即使是“纯”的 MVVM 方法也没有规定您不能公开公开模型。你自己说过这样做可以省去很多麻烦：去做吧。MVVM 仅规定 ViewModel 不了解/访问 View。有许多“官方”MVVM 示例使用 INotifyPropertyChanged 接口来实现它们的模型，并直接绑定到模型上的属性。

就个人而言，我认为我会将 NameModel 的控制权交给 NameViewModel。这意味着您应该从 MainWindowViewModel 中完全删除 NameModel 列表。如果你想给 NameViewModel 一个可选的构造函数，它接受一个模型，那也很好。

我是这种方法的粉丝：

```
public NameViewModel : ViewModelBase
{
    public NameModel Model
    { 
        get { /* get stuff */ }
        set { /* set stuff */ }
    } 

    // Default constructor creates its own new NameModel
    public NameViewModel()
    {
        this.Model = new NameModel();
    }

    // Constructor has a specific model dictated to it
    public NameViewModel(NameModel model)
    {
        this.Model = model;
    }

    //Model wrapper properties
    public String Name
    { 
        get { return Model.Name; }
        set { Model.Name = value; }
    }
} 
```

和...

```
public class MainWindowViewModel
{
    Private ObservableCollection<ViewModel> _NameViewModels;

    Public Void MainWindowViewModel()
    {
        //Lets pretend we have a service that returns a list of models
        var nameModels = Service.Request();
        foreach(Model model in nameModels)
        {
            ViewModel viewmodel = new NameViewModel(model);
            NameViewModel.Add(viewmodel);
        }
    }

    Public ObservableCollection<ViewModel> NameViewModels
    {
        get
        {
            return _NameViewModels;
        }
    }
} 
```

这样，您的 MainWindowViewModel 不会保留完全独立的模型副本；它只跟踪 NameViewModels。每个 NameViewModel 负责自己的底层模型，同时仍然提供选项以在构建期间将*特定*模型传递给它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T13:43:39.357

所有与创建相关的问题都可以通过引入[工厂设计模式](http://en.wikipedia.org/wiki/Factory_method_pattern)来解决。工厂将负责根据提供的模型创建**视图模型**。

```
public class MainWindowViewModel
{
    private List<Model> _NamesModel;
    private ObservableCollection<ViewModel> _NamesViewModel;
            private IViewModelFactory factory;

    public void MainWindowViewModel(IViewModelFactory factory)
    {
        //Lets pretend we have a service that returns a list of models
        _NamesModel = Service.Request();
        _NamesViewModel = factory.CreateNamesViewModels(_NamesModel);
    }

    public ObservableCollection<ViewModel> NamesViewModel
    {
        get
        {
            return _NamesViewModel;
        }
    }
} 
```

更重要的是，您甚至可以摆脱`Service`视图模型中的依赖关系并将其移至工厂本身，从而减少将模型保留在视图模型中的需要（尽管如此，在更复杂的场景中删除模型可能不起作用）：

```
public ObservableCollection<ViewModel> CreateNamesViewModels()
{
    var models = Service.Request();
    return new ObservableCollection(models.Select(m => new ViewModel(m)));
} 
```

此外，您的主窗口视图模型可以公开[`commands`](http://msdn.microsoft.com/en-us/library/system.windows.input.icommand.aspx)利用工厂创建任何新实例。这样，没有模型泄漏到查看，也没有暴露创建细节（因为命令将隐藏实际实现）。

# shell - $() 和 `` 的区别

> ID：14082015
> 
> 赞同：-2
> 
> 时间：2012-12-29T13:12:32.757
> 
> 标签：shell

正如几个论坛和这里所提到的，[在 stackoverflow 上](https://stackoverflow.com/questions/4708549/shell-programming-whats-the-difference-between-command-and-command)，这两种在 shell 中替换命令的方式没有区别。

但是还有。这是一个真实的例子：

```
# this command works fine:
$(cat $LOG_FILE | gawk "(\$1 \$2) > $TIME")

# this one does not:
`cat $LOG_FILE | gawk "(\$1 \$2) > $TIME"` 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T13:12:32.757

这背后的全部内容是，当 bash 看到第一个时```，它会尝试找到另一个，`\$, \` and \\`并在途中全部替换，

这导致替换`\$1`为`$1`，然后，

当替换 a 中的所有内容时`"..."`，`$1`不再转义并被视为 shell 脚本本身中的第一个 agrument（在我的情况下是一个空字符串），而不是按原样传递`$1`给 gawk。

``...``这是不在shell 中使用的另一个原因。

# php - 整数运算的问题

> ID：14082017
> 
> 赞同：0
> 
> 时间：2012-12-29T13:12:50.290
> 
> 标签：php

```
function sendSms($toPhone,$message){
    $toPhone=intval(trim($toPhone));
    if(strlen($toPhone)== 8 && $toPhone{0}==9){

                    //sending sms

    }else{
        return "error";
    }

} 
```

我正在尝试验证用于发送 SMS 的手机号码。第一行修剪电话号码字符串，然后将其转换为整数。在`if`语句中，我想确保数字长度为 8 位并且以 9 开​​头。`else`即使数字正确（8 位并以 9 开​​头），此功能也始终适用。这里可能是什么问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T13:17:00.330

为什么不是正则表达式？

```
$valid = preg_match('/^9[0-9]{7}$/', trim($phone)); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T13:21:11.023

您可以从 $toPhone 中删除所有非数字

```
function sendSms($toPhone,$message){
    $_phone = '';
    for ($i = 0; $i < strlen($toPhone); $i++)
    {
        if (is_numeric($toPhone[$i]))
           $_phone .= $toPhone[$i];
    }

    if(strlen($_phone)== 8 && $_phone[0]=='9'){
           //sending sms
    }else{
       return "error";
    }    
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-29T13:22:50.070

使用 , 将电话号码转换为整数后`$toPhone=intval(trim($toPhone));`，您无法以尝试使用 的方式访问数字`$toPhone{0}`，**因为您操作的是数字而不是字符串**。

请参阅这个孤立的示例：

```
$number = 987654321;
var_dump($number{0}); //NULL 
```

但是，`substr`将能够做到这一点：

```
$number = 987654321;
var_dump(substr($number, 0, 1)); //string(1) "9" 
```

**无论如何，将整数转换为整数并不是一个好主意**，因为用户输入的数字之间可能有空格或像`+`and之类的符号`/`。更好地搜索现有的方法来验证电话号码。

看看这里，其中更详细地介绍了“验证手机号码”主题：[电话号码验证的综合正则表达式](https://stackoverflow.com/questions/123559/a-comprehensive-regex-for-phone-number-validation/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-29T13:20:29.213

您将变量转换为整数，显然 $toPhone[0] 仅适用于字符串。

没有 intval() 的相同功能可以按您的意愿工作。

```
function sendSms($toPhone, $message)
{
    $toPhone = trim($toPhone);
    if(strlen($toPhone) == 8 && $toPhone[0] == 9){
        //sending sms
    } else {
        return "error";
    }
} 
```

# msbuild - 使用 Visual Studio 2012 时 SignTool.exe 或“Windows Kits”目录的路径

> ID：14082020
> 
> 赞同：45
> 
> 时间：2012-12-29T13:13:06.877
> 
> 标签：msbuild, visual-studio-2012, signtool

使用 Visual Studio 2012 时如何获取 SignTool.exe 的路径？

在 Visual Studio 2010 中，您可以使用

```
<Exec Command="&quot;$(FrameworkSDKDir)bin\signtool.exe&quot; sign /p ... /> 
```

`$(FrameworkSDKDir)`在哪里

```
"c:\Program Files (x86)\Microsoft SDKs\Windows\v7.0A\Bin\" 
```

但在 Visual Studio 2012 中，`$(FrameworkSDKDir)`是

```
 "C:\Program Files (x86)\Microsoft SDKs\Windows\v8.0A\bin\" 
```

和 SignTool 在

```
 "c:\Program Files (x86)\Windows Kits\8.0\bin\x64\" 
```

除了硬编码（我试过`FrameworkSDKDir`and `WindowsSDKDir`，但都指向 v8.0A 目录）之外，有没有办法获得这个目录的路径。

*（我知道[SignFile](http://msdn.microsoft.com/en-us/library/ms164304.aspx) [MSBuild](http://en.wikipedia.org/wiki/MSBuild)任务，但我不能使用它，因为它不接受证书密码。）*

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2013-01-02T09:42:40.770

我刚刚遇到了同样的问题。从 Visual Studio 2012 命令提示符运行构建工作，但它在 IDE 中失败。寻找详细或诊断日志导致我到[MSBuild 日志的默认位置是什么？](https://stackoverflow.com/questions/11526552/what-is-the-default-location-for-msbuild-logs)，这告诉我 Visual Studio 无法提供我真正需要的诊断信息。

这是我最终修复它的方法。

打开一个普通的命令提示符（不是 Visual Studio 命令提示符），然后通过完全限定 MSBuild 的路径 (%SystemRoot%\Microsoft.NET\Framework\v4.0.30319\MSBuild.exe) 来运行 msbuild。这最终给了我在 Visual Studio 2012 中收到的相同错误消息（错误代码 9009）。

然后，通过附加 /v:diag 开关，使用“诊断”日志记录（显示所有属性和项目值）运行相同的构建。

从这个输出中，我了解到它确实有一些新属性，可用于获取 signtool.exe 的位置（摘录如下）：

```
windir = C:\Windows
windows_tracing_flags = 3
windows_tracing_logfile = C:\BVTBin\Tests\installpackage\csilogfile.log
WindowsSDK80Path = C:\Program Files (x86)\Windows Kits\8.0\
WIX = C:\Program Files (x86)\WiX Toolset v3.7\ 
```

因此，我对这个问题的解决方案是将以下内容添加到我的 *.targets 文件中：

```
<SignToolPath Condition=" Exists('$(WindowsSDK80Path)bin\x86\signtool.exe') and '$(SignToolPath)'=='' and '$(PROCESSOR_ARCHITECTURE)'=='x86' ">$(WindowsSDK80Path)bin\x86\signtool.exe</SignToolPath>
<SignToolPath Condition=" Exists('$(WindowsSDK80Path)bin\x64\signtool.exe') and '$(SignToolPath)'=='' and '$(PROCESSOR_ARCHITECTURE)'=='AMD64' ">$(WindowsSDK80Path)bin\x64\signtool.exe</SignToolPath> 
```

希望这对你也有帮助。我包括了我如何到达这一点的序言，因为还有其他可用的属性可能更适合您的目的。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2015-12-03T08:38:16.737

好的，因为这是“在 buildserver 上找不到 SignTool.exe”在 google 上的第一次点击，我将为 VisualStudio 2015 和 Windows 10 Enterprise 64bit 添加附加信息。

我必须在 VisualStudio 设置中添加 ClickOnce 发布工具： [![Visual Studio 2015 安装程序，您可以在其中添加 ClickOnce](../Images/a539270e408c792db791649e1ac0d7f0.png)](https://i.stack.imgur.com/DBG5J.png)

在此之后，您会在以下位置找到 signtool.exe

*   c:\Program Files (x86)\Windows 工具包\8.1\bin\ **x64** \
*   c:\Program Files (x86)\Windows 工具包\8.1\bin\ **x86** \
*   c:\Program Files (x86)\Windows Kits\8.1\bin\ **arm** \

**安装Visual Studio 2017**后，它位于

*   C:\Program Files (x86)\Windows Kits\10\bin\arm\signtool.exe
*   C:\Program Files (x86)\Windows Kits\10\bin\arm64\signtool.exe
*   C:\Program Files (x86)\Windows Kits\10\bin\x64\signtool.exe
*   C:\Program Files (x86)\Windows Kits\10\bin\x86\signtool.exe

在**Visual Studio 2017 15.7.4**中，路径会根据您安装的所选 Windows 10 工具包再次更改。

您将通过启动**Visual Studio 2017 的开发人员命令提示符获得通用路径** [![在此处输入图像描述](../Images/3d4af22b7f9fab45c28dfb175dc155e4.png)](https://i.stack.imgur.com/yLtX6.png)

并输入 `where signtool.exe`

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2015-12-08T19:34:25.307

以下是一种更通用的方法，可用于`SignToolPath`根据构建机器的特定配置查找和设置变量；通过阅读注册表：

```
<PropertyGroup>
    <WindowsKitsRoot>$([MSBuild]::GetRegistryValueFromView('HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows Kits\Installed Roots', 'KitsRoot81', null, RegistryView.Registry32, RegistryView.Default))</WindowsKitsRoot>
    <WindowsKitsRoot Condition="'$(WindowsKitsRoot)' == ''">$([MSBuild]::GetRegistryValueFromView('HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows Kits\Installed Roots', 'KitsRoot', null, RegistryView.Registry32, RegistryView.Default))</WindowsKitsRoot>
    <SignToolPath Condition="'$(SignToolPath)' == ''">$(WindowsKitsRoot)bin\$(Platform)\</SignToolPath>
</PropertyGroup> 
```

这假定`$(Platform)`解析为`arm`、`x86`或之一`x64`。否则用适当的目录替换`$(Platform)`宏。

**编辑**（2017.07.05）：
这是一个更新`<PropertyGroup>`，它遵循新的 Windows 10 工具包并强制`($Platform)=='AnyCPU'`执行`x86`：

```
<PropertyGroup>
  <WindowsKitsRoot>$([MSBuild]::GetRegistryValueFromView('HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows Kits\Installed Roots', 'KitsRoot10', null, RegistryView.Registry32, RegistryView.Default))</WindowsKitsRoot>
  <WindowsKitsRoot Condition="'$(WindowsKitsRoot)' == ''">$([MSBuild]::GetRegistryValueFromView('HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows Kits\Installed Roots', 'KitsRoot81', null, RegistryView.Registry32, RegistryView.Default))</WindowsKitsRoot>
  <WindowsKitsRoot Condition="'$(WindowsKitsRoot)' == ''">$([MSBuild]::GetRegistryValueFromView('HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows Kits\Installed Roots', 'KitsRoot', null, RegistryView.Registry32, RegistryView.Default))</WindowsKitsRoot>
  <SignToolPath Condition=" '$(SignToolPath)' == '' And '$(Platform)' == 'AnyCPU' ">$(WindowsKitsRoot)bin\x86\</SignToolPath>
  <SignToolPath Condition="'$(SignToolPath)' == ''">$(WindowsKitsRoot)bin\$(Platform)\</SignToolPath>
</PropertyGroup> 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2017-06-28T08:31:16.780

```
Resolve-Path  "C:\Program Files*\Windows Kits\*\bin\*\signtool.exe" 
```

**输出：**

```
Path
----
C:\Program Files (x86)\Windows Kits\8.0\bin\x64\signtool.exe
C:\Program Files (x86)\Windows Kits\8.0\bin\x86\signtool.exe
C:\Program Files (x86)\Windows Kits\8.1\bin\arm\signtool.exe
C:\Program Files (x86)\Windows Kits\8.1\bin\x64\signtool.exe
C:\Program Files (x86)\Windows Kits\8.1\bin\x86\signtool.exe 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2020-07-20T22:03:29.913

因为对我来说，今天（20/07/2020），以前的所有建议都失败了，尽管它们中的大多数在过去都有效，但我决定发布一个更全面的方法，它也解决了后来的 Windows 10 SDK 位置，同时仍然使用旧的那些作为后备。

```
<PropertyGroup Label="UserDefinedVariables">

    <!-- Get Windows SDK root folder-->

    <WindowsKitsRoot>$([MSBuild]::GetRegistryValueFromView('HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows Kits\Installed Roots', 'KitsRoot10', null, RegistryView.Registry32, RegistryView.Default))</WindowsKitsRoot>
    <WindowsKitsRoot Condition="'$(WindowsKitsRoot)' == ''">$([MSBuild]::GetRegistryValueFromView('HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows Kits\Installed Roots', 'KitsRoot81', null, RegistryView.Registry32, RegistryView.Default))</WindowsKitsRoot>
    <WindowsKitsRoot Condition="'$(WindowsKitsRoot)' == ''">$([MSBuild]::GetRegistryValueFromView('HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows Kits\Installed Roots', 'KitsRoot', null, RegistryView.Registry32, RegistryView.Default))</WindowsKitsRoot>

    <!-- Evaluates the most recent Windows SDK folder containing SignTool.exe -->

    <!-- add new versions here, duplicating following line -->
    <SignToolFolder Condition="'$(SignToolFolder)' == '' And exists('$(WindowsKitsRoot)bin\10.0.18362.0\x64\Signtool.exe')">$(WindowsKitsRoot)bin\10.0.18362.0\x64\</SignToolFolder>
    <SignToolFolder Condition="'$(SignToolFolder)' == '' And exists('$(WindowsKitsRoot)bin\10.0.17763.0\x64\Signtool.exe')">$(WindowsKitsRoot)bin\10.0.17763.0\x64\</SignToolFolder>
    <SignToolFolder Condition="'$(SignToolFolder)' == '' And exists('$(WindowsKitsRoot)bin\10.0.17134.0\x64\Signtool.exe')">$(WindowsKitsRoot)bin\10.0.17134.0\x64\</SignToolFolder>
    <SignToolFolder Condition="'$(SignToolFolder)' == '' And exists('$(WindowsKitsRoot)bin\10.0.16299.0\x64\Signtool.exe')">$(WindowsKitsRoot)bin\10.0.16299.0\x64\</SignToolFolder>
    <SignToolFolder Condition="'$(SignToolFolder)' == '' And exists('$(WindowsKitsRoot)bin\10.0.15063.0\x64\Signtool.exe')">$(WindowsKitsRoot)bin\10.0.15063.0\x64\</SignToolFolder>
    <SignToolFolder Condition="'$(SignToolFolder)' == '' And exists('$(WindowsKitsRoot)bin\10.0.14393.0\x64\Signtool.exe')">$(WindowsKitsRoot)bin\10.0.14393.0\x64\</SignToolFolder>
    <SignToolFolder Condition="'$(SignToolFolder)' == '' And '$(Platform)' == 'AnyCPU' ">$(WindowsKitsRoot)bin\x64\</SignToolFolder>
    <SignToolFolder Condition="'$(SignToolFolder)' == ''">$(WindowsKitsRoot)bin\$(Platform)\</SignToolFolder>

    <!-- Now we should be able to calculate SignTool.exe fullpath -->

    <SignToolExe Condition=" '$(SignToolFolder)' != '' ">$(SignToolFolder)SignTool.exe</SignToolExe>

</PropertyGroup>

<!-- Finally, I would suggest you add the following lines to your project file because they will be quite usefull when things go wrong (and they will) -->

<!-- Send indivual compile bessages to MSBuild output so you check the value of each variable -->
<Target Name="ShowUserDefinedVariables" BeforeTargets="BeforeBuild">
    <Message Importance="High" Text="WindowsKitsRoot = $(WindowsKitsRoot)" />
    <Message Importance="High" Text="SignToolFolder = $(SignToolFolder)" />
    <Message Importance="High" Text="SignToolExe = $(SignToolExe)" />
</Target> 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2021-01-15T12:07:12.963

我使用的这种方法仅依赖于标准构建事件：

```
powershell -Command "(Resolve-Path \"C:\Program Files (x86)\\Windows Kits\\10\\bin\\*\\x64\" | Select-Object -Last 1).Path" > stpath
set /p STPATH=<stpath
del stpath

"%STPATH%\signtool.exe" sign .......... 
```

随着新的 Windows SDK 安装并选择最新的，它将应对新的路径。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-08-12T07:26:06.453

我假设正在使用 signtool 对可执行文件或 dll 进行签名。在 Visual Studio 2019 中，有一个 Developer 命令行，它提供了 Developer Cmd 和 Developer Powershell。这两个选项都可以自动解析signtool，而无需担心当前的Windows SDK。

[![正在解析的signtool截图](../Images/52ac9a76a4ceb44b605d5ee9cda1ba2a.png)](https://i.stack.imgur.com/yUbt5.png)

如果我们想从本机 powershell 使用 Developer Powershell，那么我们只需要为 Developer Powershell 导入模块。要导入模块，我们需要在本机 powershell 中运行以下行：

```
&{Import-Module "C:\Program Files (x86)\Microsoft Visual Studio\2019\Professional\Common7\Tools\Microsoft.VisualStudio.DevShell.dll"; Enter-VsDevShell 5ee267ff} 
```

每台机器的位置`5ee267ff`不同。您可以在 Developer Powershell 快捷方式的属性中找到它。

导入模块后，我们甚至可以从本机 powershell 解析 signtool。最后，我们可以在项目的构建后事件中添加一个脚本，以便该脚本导入 Developer powershell，然后我们可以简单地使用 signtool 进行签名。

# git - 仅合并代码文件

> ID：14082023
> 
> 赞同：1
> 
> 时间：2012-12-29T13:13:13.187
> 
> 标签：git

我怎样才能在 Git 中合并源代码文件，比如`*.h`and ？`*.cpp`

Github 上的存储库包含整个解决方案文件，包括项目和编译器数据以及构建可执行文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T15:31:42.357

您可以在文件中声明合并驱动程序[`.gitattributes`](http://git-scm.com/docs/gitattributes)，以便：

*   如果*不是*`.cpp`或，请保留您的目标版本`.h`（如[本答案所示](https://stackoverflow.com/a/2920807/6309)）
*   ~~git checkout 源到您当前分支的另一个文件（这将触发该文件的合并~~，如“ [Git 提示：如何“合并”来自另一个分支的特定文件](http://jasonrudolph.com/blog/2009/02/25/git-tip-how-to-merge-specific-files-from-another-branch/)”中所述，在“[如何使用 git-merge 合并选择性文件？](https://stackoverflow.com/a/1355990/6309) ”中引用）
    实际上没有简单的方法来触发合并

[此答案](https://stackoverflow.com/a/7292109/6309)中描述了另一个选项：

```
git merge --no-commit branchSource
# for each non .cpp or .h files:
git checkout branchDestination -- file 
```

但这有点麻烦。

* * *

话虽如此，合并应该涉及提交的*所有*内容，这就是为什么不*您不想合并的版本控制元素是一个好主意。
当可以随意生成这些元素（构建可执行文件）时，这是一个好主意（正如[KingCrunch](https://stackoverflow.com/users/421223/kingcrunch)[评论](https://stackoverflow.com/questions/14082023/merge-only-code-files/14083146#comment19472040_14082023)的那样）。

# php - 致命错误：调用未定义函数 smug_1()

> ID：14082025
> 
> 赞同：-1
> 
> 时间：2012-12-29T13:13:19.560
> 
> 标签：php, mysql, fatal-error

很抱歉打扰所有忙碌的人，我只是无法弄清楚为什么该功能不起作用。反复试验花了 50 分钟。给出的错误是针对第 15 行“case 'smug': smug_1(); break;”

```
<?php
include "globals.php";

if ($ir['jailtime'] > 0) {
    print "<center>The docks are closed to jail birds come back when thay release you</center>";
    exit;
}
if ($ir['hospital'] > 0) {
    print "<center>You cant go sailing while in hospital</center>";
    exit;
}
switch ($_GET['action']) {
case 'smug':
    smug_1();
    break;
case 'smugsub':
    smug_1_sub();
    break;
case 'smug2':
    smug_2();
    break;
case 'smugsub':
    smug_2_sub();
    break;
case 'smug3':
    smug_3();
    break;
case 'smug3sub':
    smug_3_sub();
    break;
case 'smug4':
    smug_4();
    break;
case 'smug4sub':
    smug_4_sub();
    break;
case 'smug5':
    smug_5();
    break;
case 'smug5sub':
    smug_5_sub();
    break;
case 'smug6':
    smug_6();
    break;
case 'smug6sub':
    smug_6_sub();
    break;
default:
    smug_index('action');
    break;
}

function smug_index()
{
    global $ir, $c, $userid;
    print "<center><h3>Crystal Smuggling</h3></center>
    <center>You have {$ir['csmuggling']} Smuggling Turns Left.<br />
    Welcome to the crystal smuggling docks. You can go to these location, more will be available when you are a higher level:</center>
    [<a href='csmuggling.php?action=smug'>&gt; France</a>]";
    if ($ir['level'] > 5) {
        print "[<a href='csmuggling.php?action=smug2'>&gt; Holland</a>]";
        if ($ir['level'] > 10) {
            print "[<a href='csmuggling.php?action=smug3'>&gt; Germany</a>]";
            if ($ir['level'] > 20) {
                print "[<a href='csmuggling.php?action=smug4'>&gt; Portugal</a>]";
                if ($ir['level'] > 30) {
                    print "[<a href='csmuggling.php?action=smug5'>&gt; Spain</a>]";
                    if ($ir['level'] > 70) {
                        print "[<a href='csmuggling.php?action=smug6'>&gt; Switzerland</a>]</center>";
                    }

                    function smug_1()
                    {
                        global $db, $ir, $c, $userid;
                        $rand_gems = rand(1, 3);
                        echo "<center>You get over to France And Managed To Smuggle $rand_gems crystals back.</center>";
                        mysql_query("UPDATE users SET crystals=crystals+$rand_gems WHERE userid=$userid");
                        mysql_query("UPDATE users SET csmuggling=smuggling-1 WHERE userid=$userid");
                        print "<center>[<a href='explore.php'>&gt; Back</a>]</center>";
                    }

                    function smug_2()
                    {
                        global $db, $ir, $c, $userid;
                        $rand_gems = rand(2, 6);
                        echo "<center>You get over to Holland And Managed To Smuggle $rand_gems crystals back.</center>
                        ";
                        mysql_query("UPDATE users SET crystals=crystals+$rand_gems WHERE userid=$userid");
                        mysql_query("UPDATE users SET csmuggling=smuggling-1 WHERE userid=$userid");
                        print "<center>[<a href='explore.php'>&gt; Back</a>]</center>";
                    }

                    function smug_3()
                    {
                        global $db, $ir, $c, $userid;
                        $rand_gems = rand(4, 9);
                        echo "<center>You get over to Germany And Managed To Smuggle $rand_gems crystals back.</center>
                        ";
                        mysql_query("UPDATE users SET crystals=crystals+$rand_gems WHERE userid=$userid");
                        mysql_query("UPDATE users SET csmuggling=smuggling-1 WHERE userid=$userid");
                        print "<center>[<a href='explore.php'>&gt; Back</a>]</center>";
                    }

                    function smug_4()
                    {
                        global $db, $ir, $c, $userid;
                        $rand_gems = rand(9, 12);
                        echo "<center>You get over to Portugal And Managed To Smuggle $rand_gems crystals back.</center>
                        ";
                        mysql_query("UPDATE users SET crystals=crystals+$rand_gems WHERE userid=$userid");
                        mysql_query("UPDATE users SET csmuggling=smuggling-1 WHERE userid=$userid");
                        print "<center>[<a href='explore.php'>&gt; Back</a>]</center>";
                    }

                    function smug_5()
                    {
                        global $db, $ir, $c, $userid;
                        $rand_gems = rand(11, 15);
                        print "<center>You get over to Spain And Managed To Smuggle $rand_gems crystals back.</center>
                        ";
                        mysql_query("UPDATE users SET crystals=crystals+$rand_gems WHERE userid=$userid");
                        mysql_query("UPDATE users SET csmuggling=smuggling-1 WHERE userid=$userid");
                        print "<center>[<a href='explore.php'>&gt; Back</a>]</center>";
                    }

                    function smug_6()
                    {
                        global $db, $ir, $c, $userid;
                        $rand_gems = rand(13, 17);
                        echo "<center>You get over to Switzerland And Managed To Smuggle $rand_gems crystals back.</center>
                        ";
                        mysql_query("UPDATE users SET crystals=crystals+$rand_gems WHERE userid=$userid");
                        mysql_query("UPDATE users SET csmuggling=smuggling-1 WHERE userid=$userid");
                        print "<center>[<a href='explore.php'>&gt; Back</a>]</center>";
                    }
                }
            }
        }
    }
} 
```

感谢您花时间帮助我。:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T13:18:31.387

您的函数是在`if() ...`块内定义的，因此在匹配 if 块之前它们不可用于解析器。`if()`在你的块之外定义它们！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T13:27:00.067

您必须在输出 .php 文档开始之前加载/包含所有功能（功能代码）...

所以

1.  必须首先包含/加载函数（并由 PHP 读取）
2.  然后你可以在一个文件中调用它们！

显然，您的“输出”代码是在函数代码之前设置的（因此 PHP 无法执行函数，因为它不知道此时存在函数）。因此，您必须以其他方式编写代码。

```
<?php

include "globals.php";

//first functions

function smug_1()
{
global $db,$ir,$c,$userid;
$rand_gems = rand(1,3);
echo "<center>You get over to France And Managed To Smuggle $rand_gems crystals back.</center>
";
mysql_query("UPDATE users SET crystals=crystals+$rand_gems WHERE userid=$userid");
mysql_query("UPDATE users SET csmuggling=smuggling-1 WHERE userid=$userid");
print "<center>[<a href='explore.php'>&gt; Back</a>]</center>
";
}
function smug_2()
{
global $db,$ir,$c,$userid;
$rand_gems = rand(2,6);
echo "<center>You get over to Holland And Managed To Smuggle $rand_gems crystals back.</center>
";
mysql_query("UPDATE users SET crystals=crystals+$rand_gems WHERE userid=$userid");
mysql_query("UPDATE users SET csmuggling=smuggling-1 WHERE userid=$userid");
print "<center>[<a href='explore.php'>&gt; Back</a>]</center>
";
}
function smug_3()
{
global $db,$ir,$c,$userid;
$rand_gems = rand(4,9);
echo "<center>You get over to Germany And Managed To Smuggle $rand_gems crystals back.</center>
";
mysql_query("UPDATE users SET crystals=crystals+$rand_gems WHERE userid=$userid");
mysql_query("UPDATE users SET csmuggling=smuggling-1 WHERE userid=$userid");
print "<center>[<a href='explore.php'>&gt; Back</a>]</center>
";
}
function smug_4()
{
global $db,$ir,$c,$userid;
$rand_gems = rand(9,12);
echo "<center>You get over to Portugal And Managed To Smuggle $rand_gems crystals back.</center>
";
mysql_query("UPDATE users SET crystals=crystals+$rand_gems WHERE userid=$userid");
mysql_query("UPDATE users SET csmuggling=smuggling-1 WHERE userid=$userid");
print "<center>[<a href='explore.php'>&gt; Back</a>]</center>
";
}
function smug_5()
{
global $db,$ir,$c,$userid;
$rand_gems = rand(11,15);
print "<center>You get over to Spain And Managed To Smuggle $rand_gems crystals back.</center>
";
mysql_query("UPDATE users SET crystals=crystals+$rand_gems WHERE userid=$userid");
mysql_query("UPDATE users SET csmuggling=smuggling-1 WHERE userid=$userid");
print "<center>[<a href='explore.php'>&gt; Back</a>]</center>
";
}
function smug_6()
{
global $db,$ir,$c,$userid;
$rand_gems = rand(13,17);
echo "<center>You get over to Switzerland And Managed To Smuggle $rand_gems crystals back.</center>
";
mysql_query("UPDATE users SET crystals=crystals+$rand_gems WHERE userid=$userid");
mysql_query("UPDATE users SET csmuggling=smuggling-1 WHERE userid=$userid");
print "<center>[<a href='explore.php'>&gt; Back</a>]</center>
";
}

function smug_index()
{
global $ir,$c,$userid;
print "<center><h3>Crystal Smuggling</h3></center>
<center>You have {$ir['csmuggling']} Smuggling Turns Left.<br />

Welcome to the crystal smuggling docks. You can go to these location, more will be available when you are a higher level:
  </center>
<center>
[<a href='csmuggling.php?action=smug'>&gt; France</a>]
";
if ($ir['level'] > 5) {
print "[<a href='csmuggling.php?action=smug2'>&gt; Holland</a>]
";
if ($ir['level'] > 10) {
print "[<a href='csmuggling.php?action=smug3'>&gt; Germany</a>]
";
if ($ir['level'] > 20) {
print "[<a href='csmuggling.php?action=smug4'>&gt; Portugal</a>]
";
if ($ir['level'] > 30) {
print "[<a href='csmuggling.php?action=smug5'>&gt; Spain</a>]
";
if ($ir['level'] > 70) {
print "[<a href='csmuggling.php?action=smug6'>&gt; Switzerland</a>]

</center>";
}

}
}
}
}
}

 //then output codes

if ($ir['jailtime'] > 0){
print "<center>The docks are closed to jail birds come back when thay release you</center>";
exit;
}
if ($ir['hospital'] > 0){
print "<center>You cant go sailing while in hospital</center>";
exit;
}
switch($_GET['action'])
{
case 'smug': smug_1(); break;
case 'smugsub': smug_1_sub(); break;
case 'smug2': smug_2(); break;
case 'smugsub': smug_2_sub(); break;
case 'smug3': smug_3(); break;
case 'smug3sub': smug_3_sub(); break;
case 'smug4': smug_4(); break;
case 'smug4sub': smug_4_sub(); break;
case 'smug5': smug_5(); break;
case 'smug5sub': smug_5_sub(); break;
case 'smug6': smug_6(); break;
case 'smug6sub': smug_6_sub(); break;
default: smug_index('action'); break;
}

?> 
```

试试看。唯一的问题是 globals.php 可以在函数之前或之后（因为我不知道 globals.php 做了什么）.centersmugsub

# c++ - 使用流和缓冲区的 C++ 更好实践

> ID：14082026
> 
> 赞同：0
> 
> 时间：2012-12-29T13:13:42.053
> 
> 标签：c++

我知道一种从流中读取并使用它的方法，如下所示：

```
strstream s; // It can be another standard stream type
// ...
while (!s.eof())
{
  char buf[MAX];
  s.read(buf, sizeof (buf));
  int count = s.gcount();

  THIRD_PARTY_FUNCTION(buf, count);
  // ...
} 
```

但是这段代码有一个滥用点，它首先将数据从流复制到`buf`，然后传递`buf`到`THIRD_PARTY_FUNCTION`。

有什么方法可以将代码改写为如下所示（我的意思是下面的代码避免了额外的副本）？

```
strstream s; // It can be another standard stream type
// ...
while (!s.eof())
{

  char *buf = A_POINTER_TO_DATA_OF_STREAM(s);
  int count = AVAIABLE_DATA_SIZE_OF_STREAM(s);
  // Maybe it needs s.seekg(...) here

  THIRD_PARTY_FUNCTION(buf, count);
  // ...
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T13:29:38.440

像这样的东西可能对你有用。

```
char           buffer[2000];
std::istream&  s = getStreamReference();
s.rdbuf()->pubsetbuf(buffer, 2000);

while(s)
{
    THIRD_PARTY_FUNCTION(buffer, s.rdbuf()->in_avail());
    s.ignore(s.rdbuf()->in_avail());

    // Not sure this may go into an infinite loop.
    // Its late here so I have not tested it.
} 
```

请注意，我关心复制 2K 缓冲区的成本。
在我考虑进行这种优化之前，分析必须表明这是一个导致性能显着下降的真正热点。在 99% 的时间里，可读性将是我最重要的因素。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T13:27:09.817

您可以将 std::stringstream 转换为 c 风格的字符串，方法是首先调用其成员方法[str](http://www.cplusplus.com/reference/sstream/stringstream/str/)以获取 std::string，然后调用其成员函数[c_str](http://www.cplusplus.com/reference/string/string/c_str/)将其转换为 c 风格的空终止字符 [ ]。

# heroku - 如何在 heroku 上为应用创建子子域：（例如 sub.myapp.herokuapp.com）

> ID：14082029
> 
> 赞同：14
> 
> 时间：2012-12-29T13:13:51.243
> 
> 标签：heroku, subdomain

我正在运行一个多租户应用程序，该应用程序为 Heroku 上的租户使用子域。在生产中，我有一个域，其中子域指向我的 heroku 应用程序。（这一切都很好）

对于暂存，我想在不创建另一个域的情况下进行测试。由于我的应用程序使用它看到的第一个子域来查找当前租户，因此我希望使用如下 URL：tenant.myapp.herokuapp.com。但是，这不起作用（heroku 返回“没有这样的应用程序”错误。）

我发现2 年前的[这篇文章说应该是可能的，但我在引用的文档中不再看到这个附加组件/选项。](https://getsatisfaction.com/heroku/topics/subsubdomains_for_appname_heroku_com_domains)

我尝试通过运行将子域添加为heroku中的通配符

`heroku domains:add *.myapp.herokuapp.com`

但这又回来了

`! Trying to hijack another Heroku app? Tsk, tsk.`

有谁知道这是否仍然可以完成，如果可以，如何？

*注意：*我目前正在通过 CNAMING *.staging.myapp.com 到 myapp.heroku.com 使用我的暂存环境，但想清理它。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-02-26T23:45:36.263

以下是您如何在 heroku 中使用子域

[完整的细节在这里](https://devcenter.heroku.com/articles/custom-domains#custom-subdomains)

> ### 自定义子域
> 
> 对于要附加到应用程序的每个自定义子域（例如 www.example.com），请使用`domains:add`Heroku CLI 中的命令：

```
$ heroku domains:add www.example.com`
Adding www.example.com to example... done 
```

* * *

**这不再有效：** “子域目前在 heroku 上是不可能的*”*

# image-processing - 从两个文件 (RGB+Alpha) 创建 DDS(DXT5)。命令行工具需要

> ID：14082030
> 
> 赞同：0
> 
> 时间：2012-12-29T13:14:04.903
> 
> 标签：image-processing

我需要一些命令行工具来从两个 .png 文件创建 dds（dxt5 格式）——一个带有 rgb 通道，一个带有 alpha。这是因为我有大量的图像要处理——我不能手动处理。创建用于生成批处理文件的脚本以逐个处理所有图像对我来说没问题，但是我需要从两个 png-s 创建 dds 的工具。

有人知道这样的命令行工具吗？

谢谢。

PS nvDXT.exe 非常好，但它不能将不同文件中的 rgb 和 alpha 结合起来。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-12-29T13:19:24.313

如果你有 Photoshop，你总是可以使用批处理脚本（参见[批处理脚本教程](http://designertoday.com/tutorials/photoshop/1387/batch.scripting.adobe.photoshop.tutorial.aspx)的例子）来合并通道（安装了 NVidea 插件，你甚至可以做 DDS 转换）。只是一个想法。

# security - Jboss 安全问题 CVE-2010-0738

> ID：14082033
> 
> 赞同：0
> 
> 时间：2012-12-29T13:14:33.063
> 
> 标签：security, jboss, jboss-4.2.x

我有三个实时运行的 jboss 服务器，它们从一个 http 池提供给我的组织外部。

问题是关于 jboss jmx-console 安全问题。众所周知，jboss 安全漏洞是作为代码 CVE-2010-0738 发布的。但是，即使我从 web.xml 中删除了 http-method GET 和 POST 行，问题仍然存在。

任何帮助，将不胜感激。

非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-03T15:03:48.347

您不能将服务器绑定到外部地址并禁止仅从本地地址访问 jmx-console。

jboss-4.2.3 默认禁用 jmx-console 的安全性，因此您必须激活它。你需要做三个步骤。

1.  取消 jmx-console/WEB-INF/web.xml 中最后一部分 web.xml 的注释（带有 security-constraint、login-config 和 security-role 的部分）
2.  取消注释 jboss-web.xml 中的一行（行）
3.  在 server/ `<profile>`/conf/props/jmx-console-users.properties中更改密码

现在您只能使用 jmx-console-users.properties 中设置的用户和密码以及 jmx-console-roles.properties 中的角色 JBossAdmin 访问 jmx-console

并且不要忘记删除已经提到的部分：

```
<http-method>GET</http-method>
<http-method>POST</http-method> 
```

您也可以完全禁用 jmx-console，只需从部署目录中删除整个 jmx-console。

# javascript - KendoUI 数据属性事件处理程序和“this”范围

> ID：14082034
> 
> 赞同：7
> 
> 时间：2012-12-29T13:14:33.380
> 
> 标签：javascript, this, kendo-ui, unobtrusive-javascript

似乎 kendo 的 unobtrusive-javascript 样式事件调用`this`在我的方法上下文中中断。

假设我有一个对象`Foo`，实例化为`bar = new Foo()`

```
function Foo(){};

Foo.prototype.name = "Herring";
Foo.prototype.doSomething = function(e) {
   alert(this.name);
};

bar = new Foo(); 
```

并使用 data-click 例如附加事件

```
<a data-role="button" data-click="bar.doSomething">Click Me</a> 
```

对象上下文`bar`被替换（不知道为什么，因为我们有方便的`element`容器。）所以`this.name`是未定义的。

我已经`var self = this;`在对象构造函数中尝试过旧的，但它不起作用，有谁知道解决这个问题的最佳方法是什么？

## 更新：哈克解决方法

因为我真的不想失去将模块包装为类的好处，所以我创建了事件调用函数包装器，然后调用适当对象上的方法。

例如，将标记连接到包装函数。

```
<a data-role="button" data-click="doSomething">Click Me</a> 
```

包装函数只调用object.method。

```
function doSomething(e){ bar.doSomething(e) }; 
```

现在，这达到了预期的结果，但它非常可怕，**从标记调用的每个事件都必须具有**像上面那样的代理函数。所以想象一下你有 300 个事件的场景......你会立即明白为什么这很可怕。

如果没有其他解决方案，我非常希望有。我将发布此解决方法作为答案，但就我而言，它远非理想。

# 脚注

老实说，这似乎是剑道的主要架构缺陷，因为这种从标记中调用事件的方法是“剑道方式”。显然它不能被修补，因为可能已经有相当多的代码`this`作为对 html 元素的引用来处理。

能够覆盖它，或者能够通过可以传递调用的通用处理程序来路由这些事件调用，本质上是通用代理函数，是可以处理这种情况的可能方式。它也可以是`kendo.`对象上的简单可配置值。

# 理论解决方案

如果可行，我将发布后续操作，理论上可以在通用代理上引发事件，并让它调用适当范围的函数。

假设我们使用事件属性来调用代理，然后创建一个单独的属性来传达对象/方法调用。例如。

```
<a data-role="button" data-click="prox" data-prox="o.eventHandler">Click Me</a> 
```

代理函数将从`prox`属性数据集中提取：

# 方法 - 使用 eval

不是因为我是邪恶的，而是必须的。

```
// sitting in global namespace 
function prox(e){
    var p = e.sender.element.data['prox'];
    // make sure our delegate is a function.
    if("function" == eval("typeof "+p)) { 
        eval(p + "(e)");
    }
} 
```

显然我想要一个更好的方法来做到这一点，但至少它是干燥的。

（我一会儿会做一个非评估方法......）

# 开始评估...

让我们使用窗口上下文来定位对象/方法。

```
function prox(e) {
   var p = e.sender.element.data['prox'];
   if(p.indexOf(".") == -1){
      // global function : where *this* is window.
      // check you've got the function if not ditch it.
      if("function" == typeof window[p]) window[p](e);
   } else {
      // object/method (one level deep only.)
      var s = p.split(".");
      var o = s[0], m = s[1];
      // check the object/method is a function before executing it.
      if("function" == typeof window[o][p]) window[o][p](e);
   }
} 
```

当然对于全局（窗口）范围的函数， this 作为元素可能更有用，但在这种情况下，你可以选择，我会省略

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T09:11:35.667

# 正在使用的版本。

```
// dynamic proxy for retaining object context on methods called by
// data- attributes in Kendo.
// 
// e.g.
//
//     data-click="o.method" 
//
// Would lose context with `o` - context would be set in the same
// way as JQuery handlers, which is an inconvenience.
// 
// Alternatively we use the prox method
//
//     data-click="prox"
// 
// We'd then set `data-prox` on the same element, to the
// object.method pair.
//
//     data-prox="o.method"
//
// This is read by prox, transformed into a method call, type
// checked and executed if it's a valid method.
//
// A `data-prox` value in any form other than `object.method` will
// be ignored, for example, `object.child.method` will fail. If
// you're doing that sort of thing, feel free to hack it.
// 
// There's a backup eval() to locate the object if window doesn't
// own it. It should be possible to remove it under most
// circumstances, it's here for compatability with
// JSFiddle. (JSBin works without it.)
function prox(e) {
    var p = this.element.data().prox;
    if(p.indexOf(".") > -1){
        var s = p.split("."); if(s.length > 2) return; 
        var o = s[0], m = s[1];
        if("object" == typeof window[o]) {
            o = window[o];
        } 
        if("function" == typeof o[m]) o[m](e);
        // comment this out in production:
        l( "prox called " + s[0] + "::" + s[1] );
    }
}

function l(s) { console.log(s); } 
```

# 注意事项

如果您在同一个元素上有多个处理程序，则不`prox()`适合，例如，如果您有`data-init`,`data-show`等，`prox`则无法区分，并且会失败。

我可能会更新这个，特别是如果这对我来说成为一个普遍的用例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T08:38:26.393

我暂时尝试了第三种方法，使用非通用技术，它的工作原理是这样的。

### 伪代码：

```
MyObject {

   method : function(e) {
      if (this instanceof MyObject) {
        // Do something with this
      } else {
        myInstance.method(e); // otherwise re-call the method to set this properly.
      }
   }
}
myInstance = new MyObject(); 
```

不如 prox 方法灵活，但适合我的用例，并且至少不需要单独的函数代理远离我们要使用的方法。我们可以通过预先进行类型检查和重新调用来使其更简洁。

例如

```
MyObject = {
   method : function(e) {
      if (! this instanceof MyObject) myInstance.method(e); // re-call

      // Method body... 

   }
}
myInstance = new MyObject(); 
```

这也意味着我的标记中不需要自定义`data-`属性。

**注意：**此方法对于将具有多个实例的对象是有问题的，但是，我应用的对象是单个实例。

如果您有需要特定于实例的处理程序（这是我提出这个问题的主要原因），则该`prox`方法比这更合适，这只是一种执行**每个事件**代理功能的更简洁的方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-19T11:53:07.747

您可以使用 jQuery 代理 ( [http://api.jquery.com/jQuery.proxy/](http://api.jquery.com/jQuery.proxy/) )。

```
function Foo(){};

Foo.prototype.name = "Herring";
Foo.prototype.doSomething = function(e) {
   alert(this.name);
};

bar = new Foo();

$("btn").click($.proxy(bar.doSomething), bar); 
```

或用于内部使用

```
$("btn").click($.proxy(this.doSomething), this); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-06-21T12:40:14.117

我使用 JS Proxy Polyfill 开发了一种代理方法，该方法通过 custon html data-* 属性中的参数简化了调用自定义逻辑。

包括[https://raw.githubusercontent.com/GoogleChrome/proxy-polyfill/master/proxy.js](https://raw.githubusercontent.com/GoogleChrome/proxy-polyfill/master/proxy.js)

```
function makeGridTemplateEventProxy(o) {
    return new Proxy(o, {
        get(target, eventName) {
            return function (options) {
                return templateEventProxy(options, eventName);
            }
        }
    });
}

templateEventProxy: function (options, attribute) {
    if (!options.sender.element.attr('data-proxy-' + attribute)) {
        throw new Error('Cannot find attribute data-proxy-' + attribute + ' on ' + options.sender.name + ' widget');
    }
    var proxyParams = JSON.parse(options.sender.element.attr('data-proxy-' + attribute));

    method = $("#" + proxyParams.id).data(proxyParams.widget).element.data(proxyParams.method);

    if (method && typeof method == 'function') {
        return $.proxy(method, this)(options);
    }

    return null;

}

var eventproxy = makeGridTemplateEventProxy({}); 
```

例如上传组件

```
<input type=file ... 
       data-success="eventproxy.customsuccesshandler"
       data-proxy-customsuccesshandler='{widget:"kendoGrid",method:"<myJqueryDataDefinedMethod>",id:"<gridId>"}'
       ....
/> 
```

用您的参数替换**myJqueryDataDefinedMethod**和**gridId**

如您所见，您可以在 data-success 中定义具有动态名称的事件代理

```
data-success="eventproxy.CUSTOMKEY" 
```

并在定义自定义属性之后

```
data-proxy-CUSTOMKEY 
```

data-proxy-CUSTOMKEY 包含可用于实现自定义逻辑的参数（JSON 编码），

我建议自定义逻辑，它可以通过 $.data 检索存储在 kendo 小部件网格上的 JS 方法

```
$("#" + proxyParams.id).data(proxyParams.widget).element.data(proxyParams.method) 
```

例如，您可以将方法绑定到网格

```
$('#my-grid-id').data("kendoGrid").element.data('methodName',function(e){ 
    // my implementation 
}); 
```

# c++ - 将二维矢量写入文件？C++

> ID：14082035
> 
> 赞同：3
> 
> 时间：2012-12-29T13:14:55.450
> 
> 标签：c++, file-io, map, vector, sfml

我想知道如何将二维向量输出到值之间有空格的文件。它是以用户选择的指定大小将映射写入文件。我已经从那里动态加载地图。我有该功能的基础，但接下来我有点迷失了。

```
void Map::SetMapSize(int sizeX, int sizeY, const char *filename)
{
    std::ofstream out(filename);
    out << "[Map]" << std::endl;
    MapSizeVector[sizeX][sizeY];

    for(int i = 0; i <= sizeX; i++)
    {
        for(int j = 0; j <= sizeY; j++)
        {
            std::ostream_iterator<std::string> output_iterator(out, " ");
        }
    }
} 
```

Map.txt 如下所示：

```
[Map]
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
0 0 1 1 0 0 0 1 1 0 0 1 1 1 1 1 1 0 0
0 0 1 1 0 0 0 1 1 0 0 1 1 1 1 1 1 0 0
0 0 1 1 0 0 0 1 1 0 0 0 0 1 1 0 0 0 0 
0 0 1 1 0 0 0 1 1 0 0 0 0 1 1 0 0 0 0
0 0 1 1 1 1 1 1 1 0 0 0 0 1 1 0 0 0 0
0 0 1 1 1 1 1 1 1 0 0 0 0 1 1 0 0 0 0
0 0 1 1 0 0 0 1 1 0 0 0 0 1 1 0 0 0 0
0 0 1 1 0 0 0 1 1 0 0 0 0 1 1 0 0 0 0
0 0 1 1 0 0 0 1 1 0 0 1 1 1 1 1 1 0 0
0 0 1 1 0 0 0 1 1 0 0 1 1 1 1 1 1 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
```

它下面还有一些细节。基本上，我想将该 [Map] 部分重写为用户在 [Details] 上方请求的任何大小 x 和 y 并替换现有的 [Map] 部分。数字为 0 很好。谢谢！

Map.h 中的向量声明

```
std::vector <std::vector <int> > MapSizeVector; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T13:52:58.300

您的函数应如下所示：

```
void Map::SetMapSize(int sizeX, int sizeY, const char *filename)
{
    std::ofstream out(filename);
    out << "[Map]" << std::endl;
    MapSizeVector.resize(sizeX);

    for(int i = 0; i < sizeX; i++)
    {
        MapSizeVector[i].resize(sizeY);
        for(int j = 0; j < sizeY; j++)
        {
            char str[20];
            sprintf(str, "%d ", MapSizeVector[i][j]);
            out << str;
        }
        out << '\n';
    }
} 
```

# java - Android/Java：如何根据本地化设置编写 if 语句？

> ID：14082036
> 
> 赞同：0
> 
> 时间：2012-12-29T13:14:56.060
> 
> 标签：java, android, localization, locale, culture

现在我开始考虑我的 ANDROID 应用程序的本地化。我正在用 JAVA 编码，并且正在使用 ADT 环境。该应用程序应该在完成后以德语和英语运行。我发现了很多关于如何基于设备 UI 访问字符串、标签图像等资源的不错的教程。

但是，我需要根据应用程序运行的语言在我的代码中做出决定。让我给你一个简短的例子，说明我想用一些伪代码实现什么（仅作为一个例子）：

```
If ("language-is-german") {

  start an audiostream playing a .wav-file saying "Guten morgen lieber Benutzer!!!";
  Integer intErgebnis = 2 + 4;

}
Else If ("language-is-english") {

  start an audiostream playing a .wav-file saying "Good morning dear user!!!";
  Integer intResult = 2 + 9;

} 
```

基本的想法是播放不同的声音文件（我知道你也可以通过指向不同的资源来实现）——但它们需要以不同的顺序播放等等。我添加了计算只是为了向你展示我真的想做基于用户计算机上设置的语言的不同事物。

如何在后面的代码中检查它（即我必须输入什么而不是`language-is-german`上面的伪代码？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-29T13:48:42.750

[`Locale.getDefault()`](http://developer.android.com/reference/java/util/Locale.html#getDefault%28%29)返回用户的首选语言环境。

测试它的语言是否等于`Locale.FRENCH.getLanguage()`或`Locale.GERMAN.getLanguage()`。

# css - 样式属性文本阴影给出错误无效参数

> ID：14082040
> 
> 赞同：0
> 
> 时间：2012-12-29T13:15:52.393
> 
> 标签：css, google-apps-script

我正在传递这种 css 格式

`"text-shadow": "5px 5px 0 red",`

到`.setStyleAttributes(_label)` 文本标签的方法，它返回以下错误：

*无效参数：5px 5px 0 red*

gs 中不支持文本阴影（尚未）还是我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T23:43:41.737

这是一个简短的答案，虽然不是 100% 的结论，但应该会有所帮助。HtmlService 中的 CSS 白名单通常比 UiApp 更宽松，这主要是因为我们可以依靠 Caja 项目中的出色工作来真正考虑每个属性的后果。如果一个 CSS 属性在 HtmlService 中有效，而在 UiApp 中无效，请提交增强请求，它可能会得到修复（最近已经通过这种方式修复了一些）。如果该属性在 HtmlService 中不起作用，则几乎可以肯定它是故意禁用而不是被忽略的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T14:06:16.010

"text-shadow":"5px 5px 0 red" 与`setStyleAttribute`.

您正在尝试使用上述内容强制执行 setStyleAttribute **。**

链式样式应该是这样的：

`setStyleAttributes({textShadow:"5px 5px 0 red", background:"red"})`

如果您使用的是 James Ferreira 技术，请从使用 setStyleAttribute 开始。

最终不支持您使用的样式：[支持的样式属性](https://developers.google.com/apps-script/ui_supportedStyles)

见参考：

*   [设置样式属性](https://developers.google.com/apps-script/class_label#setStyleAttributes)
*   [设置样式属性](https://developers.google.com/apps-script/class_label#setStyleAttribute)

# cocoa - NSComboBox 绑定到 NSTreeController

> ID：14082041
> 
> 赞同：0
> 
> 时间：2012-12-29T13:16:07.630
> 
> 标签：cocoa, cocoa-bindings, nsoutlineview, nstreecontroller, nscombobox

我有一个带有孩子的 NSTreeController/NSOutlineView 和一个 NSComboBox。我只想在组合框中显示顶级对象而不是子项。无法弄清楚如何做到这一点。有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T13:26:53.177

好吧，刚刚证实我是傻子。

刚刚添加了一个 NSArrayController 并使用绑定来代替。

# c# - 如何从列表中删除 高效（C#）？

> ID：14082042
> 
> 赞同：6
> 
> 时间：2012-12-29T13:16:13.483
> 
> 标签：c#, .net, generics, collections, generic-collections

如果我理解正确（如果我错了请纠正我），列表是由 .NET 中的数组实现的，这意味着每次删除列表中的项目都会导致重新分配所有列表（这反过来意味着`O(n)`）。

我正在开发一个游戏，在游戏中，我有很多子弹在任何给定的时刻都在空中飞行，比如说 100 颗子弹，每一帧我将它们移动几个像素并检查与游戏中物体的碰撞，我需要移除从列表中每个碰撞的子弹。

所以我将碰撞的子弹收集在另一个临时列表中，然后执行以下操作：

```
foreach (Bullet bullet in bulletsForDeletion)
    mBullets.Remove(bullet); 
```

因为循环是`O(n)`，而删除是`O(n)`，我花`O(n^2`了 ) 时间来删除。

有没有更好的方法来删除它，或者更适合使用的集合？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-29T13:19:11.857

集合和链表都具有恒定的时间删除。您可以使用其中任何一种数据结构吗？

没有办法避免从`List<T>`. 如果这对您来说是个问题，您将需要使用不同的数据结构。它也可能使计算 bulletsToRemove 的代码感觉更好。

`ISet<T>`有很好的方法来计算对象集之间的差异和交集。

使用集合会丢失排序，但鉴于您正在接受子弹，我猜这不是问题。您仍然可以在恒定时间内枚举它。

* * *

在您的情况下，您可能会写：

```
mBullets.ExceptWith(bulletsForDeletion); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-29T13:21:49.960

创建一个新列表：

```
var newList = `oldList.Except(deleteItems).ToList()`. 
```

尽可能使用功能性习语。不要修改现有的数据结构，创建新的。

由于散列，该算法是 O(N)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-29T13:18:41.420

你不能从`List`（相当于Java的`ArrayList`突出显示）切换到`LinkedList`？LinkedList 需要 O(1) 来删除特定元素，但 O(n) 需要按索引删除

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-29T13:19:06.780

您不应该考虑如何在内部实现列表。您应该在该抽象级别与列表进行交互。

如果您确实有性能问题并且您将它们精确到列表中，那么是时候看看它是如何实现的了。

至于从列表中删除项目 - 您可以使用`mBullets.RemoveAll(predicate)`, where`predicate`是一个表达式，用于标识已碰撞的项目。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-29T13:25:58.927

`RemoveAt(int index)`比后面要快，`Remove(T item)`因为后面用了第一个在里面，做反射，这是每个函数里面的代码。

此外，`Remove(T)`还有函数`IndexOf`，它内部有一个第二个循环来评估每个项目的索引。

```
public bool Remove(T item)
{
  int index = this.IndexOf(item);
  if (index < 0)
    return false;
  this.RemoveAt(index);
  return true;
}

public void RemoveAt(int index)
{
  if ((uint) index >= (uint) this._size)
    ThrowHelper.ThrowArgumentOutOfRangeException();
  --this._size;
  if (index < this._size)
    Array.Copy((Array) this._items, index + 1, (Array) this._items, index, this._size - index);
  this._items[this._size] = default (T);
  ++this._version;
} 
```

我会做一个这样的循环：

```
for (int i=MyList.Count-1; i>=0; i--) 
{
    // add some code here
    if (needtodelete == true)
    MyList.RemoveAt(i);
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-29T14:20:17.833

本着“usr”建议的功能习语的精神，您可能会考虑根本不从您的列表中删除。相反，让您的更新例程获取一个列表并返回一个列表。返回的列表仅包含“仍然活着”的对象。然后，您可以在游戏循环结束时（或立即，如果合适）交换列表。我自己做过这个。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2022-03-05T10:12:31.683

理想情况下，考虑 C# 如何实现其 List 方法并不重要，并且有点不幸的是，它`i`在执行索引后重新分配了所有数组元素`somelist.RemoveAt(i).` ，但有时需要围绕标准库实现进行优化。

如果您发现在使用 RemoveAt 从列表中删除列表元素时，您的执行花费了无法接受的重排，则一种可能对您有用的方法是将其与末尾交换，然后`RemoveAt`从列表末尾交换：

```
if (i < mylist.Count-1) {
     mylist[i] = mylist[mylist.Count-1];
}
mylist.RemoveAt(mylist.Count-1); 
```

这当然是一个 O(1) 操作。

# javascript - JavaScript 中的对象是如何存储在内存中的？

> ID：14082043
> 
> 赞同：10
> 
> 时间：2012-12-29T13:16:16.513
> 
> 标签：javascript, json, node.js

关于[JSON的官方文档](http://www.json.org)

> 对象是一组无序的名称/值对。对象以 {（左大括号）开始，以 }（右大括号）结束。每个名称后跟 :（冒号），名称/值对用 ,（逗号）分隔。

**注意** 我是 Javascript 新手，从名称 JSON（Javascript 对象表示法）本身来看，我假设 Javascript 中的对象与 JSON 相同。请纠正我，以防我弄错了。

从上面的定义看来，Javascript 对象很可能是由 hashmap 或 BST 或一些类似的数据结构实现的。

**但是当我在Node** shell中插入键值对时，它们是以序列化的方式插入的。这是我在节点外壳中尝试过的

```
> var a = {}
undefined
> a['k1'] = 'a1'
'a1'
> a['k3'] = 'a3'
'a3'
> a['k2'] = 'a2'
'a2'
> a['k4'] = 'a4'
'a4'
> a['k5'] = 'a5'
'a5'
> a
{ k1: 'a1',
  k3: 'a3',
  k2: 'a2',
  k4: 'a4',
  k5: 'a5' } 
```

现在，在打印`a`时，键值对以与插入相同的顺序返回。所以我的问题是：

*   我可以快速查找密钥吗？我的意思是 O(log(n)) 或更好的复杂度。
*   如果 JSON 不使用 BST、hashmap 或类似 DS 之类的数据结构，那么 JSON 对象到底是如何放置在内存下的？

**更新** 好的，那么 Javascript 对象呢。有人可以评论Javascript对象的底层实现吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-29T13:18:31.110

你混淆了[JSON](http://json.org/)，它**只是**一种基于文本的序列化格式，可以进行简单的数据交换，而普通的 javascript 对象是**无**序列的属性列表。

正如[MDN](https://developer.mozilla.org/en-US/docs/JavaScript/Guide/Working_with_Objects)所说：

> 对象是属性的集合，属性是名称和值之间的关联。属性值可以是函数，然后称为对象的方法。

对象属性可以看作是哈希映射，因为它们没有排序。但它通常有点复杂：当对象是基于原型的时，在对象上找不到的属性会向上搜索它所基于的原型。

使用 javascript 对象，您可以获得保证的快速查找，因为这是实现的重要组成部分。但是实现不是由规范定义的，每个引擎都可以有自己的。

**更新**

从 2021 年几乎所有浏览器和 JS 服务器都有的 ES6 开始，object 中非整数键的顺序是插入顺序。

# linux - 用于 ARM 的 linux IRQ 中断处理程序的启动代码

> ID：14082048
> 
> 赞同：2
> 
> 时间：2012-12-29T13:17:06.107
> 
> 标签：linux, arm, linux-device-driver, interrupt-handling

在过去的几天里，我正在研究很多关于 linux 第 10 章书 ldd3 的内容。我有一些疑问，请澄清他们。有些是我的分析，如有错误，请提出建议。

> > 对于 ARM，有一个中断向量表地址用于 -- IRQ 中断 -- 0x00000018 然后芯片制造商可以为那里的硬件（如 USART、SPI、I2C、外部中断）提供单独的中断线，并将它们多路复用到单个 IRQ 线手臂。并有寄存器（他们选择）来确定哪个触发了中断。
> > 
> > 此外，如果有一个可用于 GPIO 引脚电平变化中断的中断线。根据以下链接的单个中断线可以由不同设备驱动程序的许多处理程序共享。
> > 
> > [fiq & irq handler -- arm](https://stackoverflow.com/questions/13777229/fiq-irq-handler-arm) 通常中断控制器是一个硬件单元，它将多条中断线复用在一起，生成单条线到 CPU。当中断发生时，控制器断言 IRQ 线。CPU 停止执行并通过 IRQ 向量（位置不同）跳转到中断处理程序。中断处理程序读取中断控制器上的寄存器以确定中断线，并调用正确的中断处理程序，然后清除中断 - 允许另一个中断发生。
> > 
> > [http://www.makelinux.net/ldd3/chp-10-sect-2](http://www.makelinux.net/ldd3/chp-10-sect-2) 这个链接描述了如何注册一个中断处理程序。
> > 
> > [https://unix.stackexchange.com/questions/47306/how-does-the-linux-kernel-handle-shared-irqs](https://unix.stackexchange.com/questions/47306/how-does-the-linux-kernel-handle-shared-irqs) Linux 调用同一共享行的所有 intruppt 处理程序。

我的问题是作为设备驱动程序程序员，我只是在调用....request_irq()。

谁提供通用代码——IRQ 中断@0x00000018 地址——读取供应商特定寄存器以确定哪个中断线引发了 IRQ。然后告诉 linux 功能——调用为该 IRQ 行注册的所有共享中断处理程序？

是芯片组的 GCC 编译器启动代码为我们做这项工作吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-29T14:02:26.323

实际的中断处理由[linux/arch/arm/kernel/entry-armv.S 设置](http://lxr.linux.no/linux+*/arch/arm/kernel/entry-armv.S)。然后，解码和运行中断处理程序涉及一长串代码。

实际的 request_irq 是通用代码，它设置了一个“描述符”，irq_desc，定义在[linux/include/linux/irqdesc.h](http://lxr.linux.no/linux+*/include/linux/irqdesc.h#L38)中。

“哪个中断是哪个”的实际处理是在板的特定设置中配置的。我在这里给出了一个 omap2/omap3 板的示例（随机选择，因为我使用过这些板，但不在 Linux 中）： [linux/arch/arm/mach-omap2/irq.c](http://lxr.linux.no/linux+*/arch/arm/mach-omap2/irq.c#L222)

我希望这有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-05-28T10:26:33.673

在 entry-armv.S 文件中，您可以找到填充 IRQ 行的代码，如下所示：

```
/*
 * Interrupt handling. Preserves r7, r8, r9
 */
.macro  irq_handler
get_irqnr_preamble r5, lr
1:  get_irqnr_and_base r0, r6, r5, lr
movne   r1, sp
@
@ routine called with r0 = irq number, r1 = struct pt_regs *
@
adrne   lr, BSYM(1b)
bne asm_do_IRQ 
```

宏`get_irqnr_and_base`应该是特定于机器的，因此包含在文件 arch/arm/mach_/include/entry-macro.S 中。你可以看到这个宏在不同的基于 arm 的机器上以不同的方式实现。这就是如何根据不同的硬件完成 IRQ 线路的识别。

# php - 使用 PHP 的 Ajax 返回值

> ID：14082052
> 
> 赞同：0
> 
> 时间：2012-12-29T13:17:21.537
> 
> 标签：php, javascript, jquery, ajax

嗨，我在制作函数结构时遇到了一些问题。将不胜感激任何帮助。

**首先，一旦从index.php**触发**OnChange**事件，此函数应删除地图标记。并将 post 值发送到**xmlmapquery.php**以进行数据检索。一旦检索到，数据应该存储回我的**index.php**中******`<div id='content'>`******

 ******```
function filter()
{ 
   for (var i = 0; i < markersArray.length; i++ ) {
      markersArray[i].setMap(null);
   }
   markersArray.length = 0;

   var lgu = $('#lgu').val();
   var category = $('#category').val();
   var type = $('#type').val();
   $.get('xmlmapquery.php', { filter: lgu, filter2: category, filter3: type},function(data){
        $('#content').text(data);
   )};
}; 
```

现在这是**xmlmapquery.php**

```
<?php  
  include('connection_db.php');
  // Start XML file, create parent node
  $dom = new DOMDocument("1.0");
  $node = $dom->createElement("markers");
  $parnode = $dom->appendChild($node); 

  if(isset($_POST['filter']) && isset($_POST['filter2']) && isset($_POST['filter3'])){
     $query = "SELECT * FROM markers WHERE type='".$_POST['filter']."' and type='".$_POST['filter2']."'
                                        and type='".$_POST['filter3']."'";
  } 
  // Select all the rows in the markers table
  $result = mysql_query($query);
  if (!$result) {  
     die('Invalid query: ' . mysql_error());
  } 

  header("Content-type: text/xml"); 

  // Iterate through the rows, adding XML nodes for each
  while ($row = @mysql_fetch_assoc($result)){  
    // ADD TO XML DOCUMENT NODE  
    $node = $dom->createElement("marker");  
    $newnode = $parnode->appendChild($node);   
    $newnode->setAttribute("name",$row['name']);
    $newnode->setAttribute("address", $row['address']);  
    $newnode->setAttribute("lat", $row['lat']);  
    $newnode->setAttribute("lng", $row['lng']);  
    $newnode->setAttribute("type", $row['type']);
  } 
  echo $dom->saveXML();
?> 
```

将不胜感激这方面的帮助。目前，即使删除标记也不起作用，该功能也不起作用**。**一旦我得到这个东西，我将向函数添加更多命令，这些命令将获取数据并为我的地图创建新标记。提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T14:43:55.883

假设您的脚本逻辑正常，并且没有`die()`或其他 php 方法返回 null 或 false（无论如何您应该在浏览器控制台中看到）。

要做的事情是：

1 - 启动请求时检查 firebug/chrome/browser 控制台（如果请求以某种方式隐藏，请使用控制台中的“保存”请求方法进行检查）

2 - 使用`var_dump($dom->saveXML());`而不是`echo $dom->saveXML();`

3 - 尽可能检查服务器/php 日志

4 - 确保您的请求 uirl 完整且有效，我指的是`$.get('xmlmapquery.php');`

如果您按照这一行调试，除非幽灵不存在，否则您将能够轻松运行您的脚本。

希望它会有所帮助******

# eclipse - 如何将 Bugzilla-bug-version 添加到 SVN 提交描述？

> ID：14082056
> 
> 赞同：2
> 
> 时间：2012-12-29T13:17:23.330
> 
> 标签：eclipse, svn, bugzilla, mylyn

我正在使用：带有 Mylyn 的 Eclipse Juno、SVN Subversive 插件、Bugzilla 4.2.4。

我努力实现将 SVN 提交与 bugzilla 任务松散关联的总体目标。感谢 Mylyn，我检索到了大量准备附加到提交描述的信息。目前很好。

但是，我希望将与错误相关的版本添加到提交描述中。在 Eclipse 中，我们可以添加任务变量（Window、Preferences、Mylyn、Team、Commit Comment Templates）。默认有： ${task.status} - ${connector.task.prefix} ${task.key}: ${task.description} ${task.url}

不幸的是，没有像 ${task.version} 这样的东西。是否有解决方法可以将 Bugzilla 版本的 bug 添加到提交描述中？

多谢，

# networking - Go 中的服务器，重定向到标准输出

> ID：14082063
> 
> 赞同：2
> 
> 时间：2012-12-29T13:17:56.030
> 
> 标签：networking, tcp, go

我如何在 Go 中实现一个服务器，它将每个传入行发送到 stdout ？

```
package main

import (
    "io"
    "log"
    "net"
)

func main() {
    srv, err := net.Listen("tcp", ":2000")
    for {
        conn, err := srv.Accept()
        go func(c net.Conn) {

            //How to split here by lines ?

            c.Close()
        }(conn)
    }
} 
```

运行服务器后

```
./server 
```

并运行 telnet

```
telnet localhost 2000
Trying 127.0.0.1...
Connected to localhost.
Escape character is '^]'.
test 123
foobar 
```

我想在标准输出上看到我启动服务器的位置：

```
test 123
foobar 
```

我知道这段代码缺少错误处理，但这只是为了清楚地显示我正在尝试做的事情。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-29T13:35:55.000

由于 a`net.Conn`是 an `io.Reader`，您可以将其包装在 a 中`bufio.Reader`并在该类型上使用该`ReadString`方法。你的功能会变成

```
func(c net.Conn) {
    f := bufio.NewReader(c)
    for {
        ln, err := f.ReadString('\n')
        if err == io.EOF {
            break
        } else if err != nil {
            panic(err)
        }
        fmt.Print(ln)
    }
    c.Close()
} 
```

（我不确定标准输出是否在 Go 中同步；在单独的 goroutine 中循环的共享通道上发送行可能更清晰。）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-31T04:06:43.567

如果这就是你想要的，只需将套接字复制到标准输出。

```
package main

import (
    "io"
    "log"
    "net"
    "os"
)

func main() {
    srv, err := net.Listen("tcp", ":2000")
    if err != nil {
        log.Fatalf("Error listening: %v", err)
    }
    for {
        conn, err := srv.Accept()
        if err != nil {
            log.Fatalf("Error accepting: %v", err)
        }
        go func(c net.Conn) {
            defer c.Close()
            io.Copy(os.Stdout, c)
        }(conn)
    }
} 
```

# django - 新的基于类的通用视图和 urlpatterns

> ID：14082064
> 
> 赞同：0
> 
> 时间：2012-12-29T13:17:56.747
> 
> 标签：django, django-views

以前的通用观点，我有这样的东西

```
link_info_dict = {
    'queryset' : Link.objects.all(),
    'date_field' : 'pub_date',
}
patterns('django.views.generic.date_based',
    url(r'^links/$', 'archive_index', link_info_dict, 'coltrane_link_archive_index'),
....
) 
```

现在有了新的基于类的通用视图，我发现以下似乎可行：

```
from django.views.generic.dates import ArchiveIndexView
....
urlpatterns = patterns('',
url(r'^links/$', ArchiveIndexView.as_view(**link_info_dict), name='coltrane_link_archive_index'),
....
) 
```

我想知道我是否以最好的方式做事。因为我必须调用'as_view'方法，所以我必须先导入视图，所以我不能“分解”“django.views.generic.date_based”。我实际上使用了几乎所有基于 date_based 的通用视图。首先导入所有这些视图并让模式（''空前缀是正确的方法吗？如果我将所有应用程序迁移到这种新样式的视图，我宁愿以正确的方式做事:)

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-01T05:47:49.810

这看起来不错 - 你确定没有其他问题吗？这与[示例](https://docs.djangoproject.com/en/dev/ref/class-based-views/generic-date-based/#django.views.generic.dates.ArchiveIndexView)一致。

```
from django.views.generic.dates import ArchiveIndexView

from myapp.models import Article

urlpatterns = patterns('',
    url(r'^archive/$',
        ArchiveIndexView.as_view(model=Article, date_field="pub_date"),
        name="article_archive"),
) 
```

它与[文档一致](https://docs.djangoproject.com/en/dev/topics/class-based-views/#simple-usage-in-your-urlconf)

> 传递给 as_view() 的任何参数都将覆盖类上设置的属性。

# drupal - 用于在节点缓存上设置到期时间的钩子是什么？

> ID：14082065
> 
> 赞同：1
> 
> 时间：2012-12-29T13:17:57.480
> 
> 标签：drupal, drupal-6

我想根据节点的发布日期单独缓存一个节点。旧节点的缓存时间可能比新节点长。我以为我可以单独使用 cache_set 进行缓存，但我意识到默认情况下会缓存节点，因此最好在缓存上设置到期时间。关于如何做到这一点的任何想法？也许是一个钩子？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-02T22:17:58.507

Drupal 本身没有节点缓存。如果您为匿名用户打开了页面缓存，则节点的缓存数据可能分布在三个表中：

1.  缓存内容

    > 此表缓存未通过输入过滤器的字段值，例如 file_fields 或选择“纯文本”的文本区域。

2.  缓存过滤器

    > 此表缓存富文本字段的过滤值，例如正文或选中“富文本”的 CCK 文本区域。

3.  缓存页面

    > 此表缓存匿名访问者看到的整个重新渲染的页面输出

我不知道有一种方法可以准确地规定这些缓存行何时过期，所以你需要创建一个函数

如果要根据自定义规则清除特定节点的所有缓存，可以使用[HOOK_cron中的](http://api.drupal.org/api/drupal/developer!hooks!core.php/function/hook_cron/6)[cache_clear_all](http://api.drupal.org/api/drupal/includes!cache.inc/function/cache_clear_all/6)函数来完成。您首先需要确定哪些节点符合您的缓存删除标准，然后您可以使用带有“cid”通配符参数的 cache_clear_all。类似的东西（这将进入自定义模块中的 HOOK_cron 函数，并要求设置正确的 cron 作业）：

```
<?php
$wildcard = //Your criteria for the cache_content table;
cache_clear_all($wildcard, 'cache_content', TRUE);

$wildcard = //Your criteria for the cache_filter table;
cache_clear_all($wildcard, 'cache_filter', TRUE);

$wildcard = //Your criteria for the cache_page table;
cache_clear_all($wildcard, 'cache_page', TRUE); 
```

我认为这里的重点是覆盖 Drupal 的内置缓存到期非常困难。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T08:37:59.857

你*可以*试试[`hook_flush_caches()`](http://api.drupal.org/api/drupal/developer!hooks!core.php/function/hook_flush_caches/6)，但我不完全确定这是否是你要找的……只是一个想法。

另一种可能的途径是[`drupal_page_cache_header()`](http://api.drupal.org/api/drupal/includes!bootstrap.inc/function/drupal_page_cache_header/6).

HTH。:)

# sql - 大型文本文件的集中存储

> ID：14082067
> 
> 赞同：0
> 
> 时间：2012-12-29T13:18:03.887
> 
> 标签：sql, file, optimization, nosql

系统应该做什么：存储/管理集中的大型（100 - 400 mb）文本文件

存储内容：文本文件中的行，对于某些文件，行必须是唯一的，有关文件的元数据（文件名、注释、上次更新等）也必须存储在文件中的位置（对于不同的应用程序，同一文件上的位置可能不同）

操作：同时从文件中获取行（100 - 400 行查询），添加行（也是 100 - 400 行），导出不是关键 - 可以安排

那么使用 SQL DBMS 的存储 - 太慢了，我想，也许是 noSQL 解决方案？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T13:24:55.440

NoSQL：Cassandra 是一种选择（我猜您可以逐行或多行存储它），Voldemort 还不错，您甚至可以使用 MongoDB，但不确定它是否符合“大文件”要求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T13:31:00.870

400 MiB 将完全从每个非荒谬数据库服务器上的缓存中提供。就目前而言，数据库的选择并不重要，任何数据库都可以快速交付（尽管有不同类型的“快速”，这取决于您的需求）。

如果您真的非常渴望原始速度，则可以使用类似`redis`. 同样，400 MiB 对此毫无挑战。

SQL 可能会稍微慢一些（但不是*那么*慢），但具有灵活的巨大优势。灵活性、通用性和“内置编程语言”的存在并不是免费的，但它们应该不会产生太糟糕的影响，因为从缓冲区缓存返回数据的任何一种方式都或多或少地以 RAM 的速度工作。

如果您以后需要一个不同的数据库，SQL 将允许您使用一些命令来完成，或者如果您想要其他一些您没有计划的东西，SQL 会做。无法保证使用简单的键值存储来做不同的事情是可行的。

就个人而言，我不会担心这种相当“小”的数据集的性能。真的，每一种数据库都可以很好地发挥作用，不用担心。当您的数据集大小达到几十 GB 时，再来一次。

如果你 100% 确定你*永远*不需要完全成熟的 SQL 数据库系统提供的额外功能，那么使用 NoSQL 可以减少几微秒的时间。否则，请坚持使用它以确保安全。

**编辑：**
详细地说，考虑到现在“有点低级”的桌面有超过 2 GiB（通常是 4 GiB），而典型的“没什么大不了”的服务器有 32 GiB 之类的东西。鉴于此，400 MiB 不算什么。服务器上的典型网络上行链路（除非您愿意支付额外费用）为 100 mibit/s。

一个 400 MiB 的文本文件可能有大约一百万行。这归结为“典型 SQL 服务器”的 6-7 次内存访问，以及 2 次内存访问加上计算“典型 NoSQL 服务器”的哈希所需的时间。也就是说，给或取几十个周期，在任何一种情况下都是一样的——在一个相对较慢的系统上大约是半**微秒。**

再加上第一次执行查询时的几十微秒，因为如果您使用 SQL，则必须对其进行解析、验证和优化。

如果幸运的话，网络延迟大约是 2 到 3**毫秒。**这对于建立连接、向服务器发送请求和接收应答要多 3 到 4 个数量级。与此相比，担心查询需要 517 微秒还是 519 微秒似乎很荒谬。如果中间有1-2个路由器，它会变得更加明显。
带宽也是如此。理论上，您可以在 1 Gibit/s 的链路上推动大约 119 MiB/s，假设最大大小的帧并假设没有 ACK 并假设绝对没有其他流量，并且数据包丢失为零。RAM 可以毫无问题地以每秒数十 GiB 的速度提供。

# c# - 如何在windows 2008服务器和linux服务器之间交换数据

> ID：14082072
> 
> 赞同：0
> 
> 时间：2012-12-29T13:18:51.953
> 
> 标签：c#, .net, soap

我有一个运行 Web 应用程序的 Windows 2008 服务器。应用程序每隔几秒接收一次用户输入 {x,y,z}，我对它们执行某些操作以获得结果 {a,b,c}。完成此操作后，我将 a、b、c 存储在 Windows 服务器上的 SQL Server 2008 中。

我现在在 Linux 服务器上设置了另一个 Web 应用程序，我需要在其上实时（或几乎）显示这些结果 {a,b,c}，因为它们是在我的 Windows 服务器中生成的。

对于我在 Linux VPS 上收到的每条记录或一组记录，我需要返回一个确认，该确认会反映/存储在 Windows 服务器的 SQL Server 中。

有哪些选择可以实现这一目标？

我正在考虑在 Windows VPS 中使用 C# SOAP 客户端，在 Linux VPS 中通过 https 使用 tornado/python SOAP 服务器？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T04:29:25.847

我会考虑使用[SignalR](https://github.com/SignalR/SignalR)或[Redis](http://redis.io/)

# android - 如何从 .c（C 文件）为 Arm 处理器创建 .so（共享对象库文件）？

> ID：14082073
> 
> 赞同：0
> 
> 时间：2012-12-29T13:19:00.820
> 
> 标签：android, android-ndk, ffmpeg

我想从**.c**文件为**ARM**处理器创建一个预建共享库**.so 。**请给我一些步骤来做到这一点，以及如何在 android 中包含和访问它的功能。

 ***** * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T15:02:10.343

您正在寻找：

```
LOCAL_PATH       := $(call my-dir)
include $(CLEAR_VARS)
LOCAL_MODULE     := my_static_lib
LOCAL_C_INCLUDES := src
LOCAL_SRC_FILES  := src/main_main.c
# Use this one to build a *.a file - static library
include $(BUILD_STATIC_LIBRARY) 
# Use this one to build a *.so file - a shared library
include $(BUILD_SHARED_LIBRARY) 
```****

# scala - 一个函数，用于确定一个数字是否是 Scala 中 foldLeft 参数中另一个数字的因数

> ID：14082082
> 
> 赞同：0
> 
> 时间：2012-12-29T13:19:47.710
> 
> 标签：scala, functional-programming, primes

我正在尝试在 Scala 中定义一个函数来确定一个数字是否为素数，如下所示：

```
def isPrime(n: Int): Boolean = {
   if (n == 2) true
   else {
      List(3 to math.sqrt(n)).foldLeft(isFactor(),0)
   }
   def isFactor(x:Int, n:Int):Boolean=(n%x)==0
} 
```

鉴于我已经定义了 isFactor，给 foldLeft 调用提供什么参数？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T13:45:17.607

我猜你想知道列表中的任何项目是否是 n 的因子。所以对于一个空列表，你应该从 false 开始，因为一个空列表不包含 n 的因子。但是，您必须不断将收集到的结果与 isFactor 结果进行比较。最简单的当然是检查 list.exists(...) 方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T17:44:38.207

感谢@thoredge 的建议，我已经能够使用 exists() 做到这一点，如下所示：

```
def isPrime(n: Int): Boolean = n match {
  case 2 => true
  case _ => !(2 to math.sqrt(n).ceil.toInt).exists((x) => n % x == 0)
} 
```

# unit-testing - C# 中的模拟和存储库/服务层

> ID：14082088
> 
> 赞同：3
> 
> 时间：2012-12-29T13:20:38.727
> 
> 标签：unit-testing, nunit, moq, rhino-mocks

我正在尝试编写一些单元测试来测试我的服务层，我认为我做得很好，服务层作为对存储库的依赖，所以我正在使用 RhinoMocks 模拟存储库，所以我正在测试服务层“没有”命中很棒的数据库。

现在我需要测试我的存储库层，它直接连接到数据库，所以我必须测试它不是吗？除了测试，我别无选择？

如果我测试另一个没有命中数据库的存储库实现，那么这不是测试我的实现。

我已经设法模拟出所有较低层，因此任何依赖于需要一段时间才能运行的代码的东西。存储库，然后我嘲笑了这一点。结果是我对存储库下层的所有测试都快速完成并且不会命中数据库。

问题是我现在如何处理存储库。我必须对其进行测试，但它依赖于 SQL 数据库。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-29T13:29:35.820

嗯，一般的答案是这样的。我会编写单元测试来验证存储库层的逻辑，并在一个新类中分解 sql 依赖项并在 repo 的测试中模拟它。如果存储库层只包含一个 sql 连接并且没有逻辑，那么我认为没有什么可以进行单元测试的。那么你更适合与数据库连接的集成测试。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T13:23:58.460

因此，模拟您不拥有的代码是一种[不好的做法](http://freshbrewedcode.com/derekgreer/2012/04/01/tdd-best-practices-dont-mock-others/)，我认为对您来说最好的选择是通过验收/集成测试来测试存储库

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-29T14:53:28.977

您当然可以在不与数据库对话的情况下测试您的存储库层。大多数 ADO.net 类都是可模拟的，如果您注意如何创建它们并且注意耦合到接口而不是具体化。不幸的是，ADO.net 是在 mocking 成为一种非常流行的做法之前创建的，而且它仍然有点痛苦。

我心中真正的问题是您是否*应该*尝试嘲笑它们。模拟的好处是双重的：它们运行得更快，并且它们迫使您封装有关数据库的更多细节（如果您想这样做，可以更容易地切换出数据库技术）。功能测试的好处是它们还可以测试您的数据库层（存储过程等），可以说它们更容易编写，并且更容易维护，因为如果进行了数据库更改，集成测试会自动通知，而不是你们寻找模拟出来的测试。

我会说“最好”的方法是使用最小起订量和真实数据库来测试它们，因为这可以让你两全其美。然而，这当然是相当昂贵的。

# jsf - JavaServer faces：模板中的部分

> ID：14082090
> 
> 赞同：1
> 
> 时间：2012-12-29T13:20:42.747
> 
> 标签：jsf

我刚刚看了 JavaServer Faces，尤其是 PrimeFaces。

我目前缺少的是像 Ruby on Rails 中的部分内容，这样我就不必在每个模板中重复所有内容。所以只是一些简单的东西，比如：

```
<%= render :partial => 'common/menu' %> 
```

也许这是一个简单的问题，但我在网上一无所获。有没有办法做这样的事情？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T13:28:21.587

我不知道 Ruby on Rails 但您可能正在寻找的是[facelets](http://docs.oracle.com/javaee/6/tutorial/doc/giepx.html)。

它既可以用于创建具有页面基本结构的模板，也可以将多个元素组合成一个组合，然后可以重复使用。

# android - 如何从数据库中选择随机数据并在 textview 中显示？

> ID：14082095
> 
> 赞同：0
> 
> 时间：2012-12-29T13:21:29.733
> 
> 标签：android, sql, database

我正在制作一个使用数据库中数据的 android 报价应用程序。当我单击下一步按钮时，我想在列表视图中显示随机报价。顺便说一句，每次打开我的应用程序时如何保存我的选择？请帮忙！这是我的数据库类：

```
 public class SQLiteAdapter {
    public static final String MYDATABASE_NAME = "MY_DATABASE";
    public static final String MYDATABASE_TABLE = "MY_TABLE";
    public static final int MYDATABASE_VERSION = 1;
    public static final String KEY_ID = "_id";
    public static final String KEY_CONTENT = "Content";

//create table MY_DATABASE (ID integer primary key, Content text not null);
private static final String SCRIPT_CREATE_DATABASE =
    "create table " + MYDATABASE_TABLE + " ("
    + KEY_ID + " integer primary key autoincrement, "
    + KEY_CONTENT + " text not null);";

private SQLiteHelper sqLiteHelper;
private SQLiteDatabase sqLiteDatabase;

private Context context;

public SQLiteAdapter(Context c){
    context = c;
}

public SQLiteAdapter openToRead() throws android.database.SQLException {
    sqLiteHelper = new SQLiteHelper(context, MYDATABASE_NAME, null,  MYDATABASE_VERSION);
    sqLiteDatabase = sqLiteHelper.getReadableDatabase();
    return this;    
}

public SQLiteAdapter openToWrite() throws android.database.SQLException {
    sqLiteHelper = new SQLiteHelper(context, MYDATABASE_NAME, null, MYDATABASE_VERSION);
    sqLiteDatabase = sqLiteHelper.getWritableDatabase();
    return this;    
}

public void close(){
    sqLiteHelper.close();
}

public long insert(String content){

    ContentValues contentValues = new ContentValues();
    contentValues.put(KEY_CONTENT, content);
    return sqLiteDatabase.insert(MYDATABASE_TABLE, null, contentValues);
}

public int deleteAll(){
    return sqLiteDatabase.delete(MYDATABASE_TABLE, null, null);
}

public Cursor queueAll(){
    String[] columns = new String[]{KEY_ID, KEY_CONTENT};
    Cursor cursor = sqLiteDatabase.query(MYDATABASE_TABLE, columns, 
            null, null, null, null, null);

    return cursor;
}

public class SQLiteHelper extends SQLiteOpenHelper {

    public SQLiteHelper(Context context, String name,
            CursorFactory factory, int version) {
        super(context, name, factory, version);
    }

    @Override
    public void onCreate(SQLiteDatabase db) {
        // TODO Auto-generated method stub
        db.execSQL(SCRIPT_CREATE_DATABASE);
    }

    @Override
    public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
        // TODO Auto-generated method stub

    }

}

} 
```

这是我显示报价的 xml 文件：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent"
tools:context=".MainActivity" >

<TextView
    android:id="@+id/textView1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentTop="true"
    android:layout_centerHorizontal="true"

  />

<Button
    android:id="@+id/next"
    android:layout_width="80dip"
    android:layout_height="wrap_content"
    android:layout_alignParentBottom="true"
    android:layout_alignRight="@+id/textView1"
    android:paddingBottom="5dip"
    android:paddingTop="5dip"
    android:text="Next"
    android:textColor="@android:color/black" /> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T13:45:46.010

代码已经**过测试并且可以正常工作**。祝你的项目好运。[http://uploaded.net/file/9dqsjc9j](http://uploaded.net/file/9dqsjc9j) **提示**：如果 eclipse 在您的 java 文件中**缺少导入**，请按**CTRL+SHIFT+O**

AndroidSqlite.java

```
@Override
public void onCreate(Bundle savedInstanceState) {
    // ....
    mySQLiteAdapter = new SQLiteAdapter(this);
    mySQLiteAdapter.openToWrite();
    mySQLiteAdapter.deleteAll();

    mySQLiteAdapter.insert("A for Apply");
    // ....
    mySQLiteAdapter.insert("Z for Zoo");

    final TextView tv = (TextView)findViewById(R.id.textView1);
    Button btn = (Button)findViewById(R.id.next);
    btn.setOnClickListener(new OnClickListener(){
        public void onClick(View v)
        {
        tv.setText(mySQLiteAdapter.getRandomQuote());
        }

    });
}

@Override
public void onDestroy()
{
    super.onDestroy();
    mySQLiteAdapter.close();
} 
```

把它放在你的 SQLiteAdapter.java

```
public String getRandomQuote()
{
Cursor c = sqLiteDatabase.query(MYDATABASE_TABLE + " ORDER BY RANDOM() LIMIT 1",
        new String[] { KEY_CONTENT }, null, null, null, null, null);

if(c.moveToFirst())
  return c.getString(c.getColumnIndex(KEY_CONTENT));
else 
  return "nothing";
} 
```

# c++ - 如何在图中找到 3 条边的负加权循环？

> ID：14082098
> 
> 赞同：4
> 
> 时间：2012-12-29T13:21:51.683
> 
> 标签：c++, algorithm, matlab, graph, cycle

我有一个包含大约 10,000 个节点的有向图。所有边都被加权。我想找到一个只包含 3 个边的负循环。有没有比 O(n^3) 更快的算法？

示例代码：（g 是我的图表）

```
if (DETAILS) std::printf  ("Calculating cycle of length 3.\n");
for (int i=0;i<NObjects;i++)
{
    for (int j=i+1;j<NObjects;j++)
    {
        for (int k=j+1;k<NObjects;k++)
        {
            if ((d= g[i][j]+g[j][k]+g[k][i])<0)
            {
                results[count][0] = i;
                results[count][1] = j;
                results[count][2] = k;
                results[count][3] = d;
                count++;
                if (count>=MAX_OUTPUT_SIZE3)
                    goto finish3;
            }

            if ((d= g[i][k]+g[k][j]+g[j][i])<0)
            {
                results[count][0] = j;
                results[count][1] = i;
                results[count][2] = k;
                results[count][3] = d;
                count++;
                if (count>=MAX_OUTPUT_SIZE3)
                    goto finish3;
            }
        }

    }
}
finish3: 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T16:55:09.247

我想不出任何复杂度低于 O(n ³ ) 的算法，但常数因子在实践中也很重要。以下算法允许修剪以加快找到权重总和为负的长度为 3 的循环 - 或检查不存在这样的循环。

1.  根据权重对（有向）边进行排序
2.  取权重最小的边作为起始边。
3.  尝试连接到起始边的结束顶点的所有边，其权重不低于起始边（第一次修剪），并在关闭循环时检查权重总和。如果你找到一个负和的循环，你就完成了。
4.  继续以具有下一个最低权重的边缘作为起始边缘。如果它的权重为负 goto 3 - 否则你就完成了（第二次修剪）

这个想法是，具有负和的循环的至少一个边缘必须具有负权重。我们可以在循环中权重最低的边缘开始一个循环。

如果您知道具有负权重的边数为 O(n)，那么该算法将为 O(n ² ld n)，因为该算法将由步骤 1 主导（= 根据其权重对边进行排序）。

# jquery - 父获取滚动条后获取元素的宽度

> ID：14082107
> 
> 赞同：0
> 
> 时间：2012-12-29T13:23:11.193
> 
> 标签：jquery, css, width

**[小提琴](http://jsfiddle.net/BramVanroy/j9SkE/)**

所以，我一直在尝试找到一种好的 jQuery 方法来查找客户端的滚动条宽度。我以为我已经在我的小提琴中弄清楚了，但显然添加滚动条不会改变孩子的宽度。即使在开发工具（chrome，FF）中，宽度也减少了。

```
function scrollbarWidth() {
    var div = $('<div class="outer"><div class="inner"></div>');
    $('body').append(div);

    var w1 = $(".inner").width();
    $(".test-text span:first").text(w1);
    console.log(w1);

    $(".test-div").css('overflow-y', 'scroll');
    var w2 = $(".inner").width();
    $(".test-text span:last").text(w2);

    console.log(w2);
}

scrollbarWidth();​ 
```

使用`innerWidth`并没有什么不同。

这怎么可能？解决方案是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T16:02:41.420

这是一个获取滚动条宽度的函数：

```
function getScrollBarWidth() {
    var inner = $('<p />', {style:'width:100%;height:200px;'}),
        outer = $('<div />', {style:'position:absolute;top:0;left:0;visibility:hidden;width:200px;height:150px;overflow:hidden;'});

    outer.append(inner).appendTo($('body'));

    var w1 = inner.get(0).offsetWidth;
    outer.css('overflow', 'scroll');
    var w2 = inner.get(0).offsetWidth;
    if (w1 == w2) w2 = outer.get(0).clientWidth;

    outer.remove();
    return (w1 - w2);
} 
```

[**小提琴**](http://jsfiddle.net/j9SkE/8/)

**[get()](http://api.jquery.com/get/)**函数获取本机 javascript DOM 元素，这是`offsetWidth`本机 javascript 方法所必需的，并且不适用于 jQuery“元素”。它也可以写成：

```
var w1 = inner[0].offsetWidth; 
```

# iphone - 调用多个webservice并解析xml

> ID：14082108
> 
> 赞同：-1
> 
> 时间：2012-12-29T13:23:13.617
> 
> 标签：iphone, objective-c, ios, xcode, xml-parsing

我被困在我的应用程序中，我需要在同一个视图控制器中调用两个 web 服务，并解析 xml。但我不知道如何解析这两个 web 服务的数据。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T14:12:08.890

在问之前先搜索，已经问了很多此类问题。这是[在同一视图控制器上调用多个 Web 服务的链接](https://stackoverflow.com/questions/6433517/multiple-web-service-calls-on-same-viewcontroller-iphone)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T13:40:03.997

这个问题很笼统。

在类似的情况下，我遇到了必须处理 2 个 Web 服务的情况。您可以保存请求（与委托回调进行比较并知道哪个请求是哪个请求），也可以使用 AFNetworking 之类的东西： [https://github。 com/AFNetworking/AFNetworking](https://github.com/AFNetworking/AFNetworking)

它可以为您提供块方法中的响应。如果您一次需要所有数据 - 您应该调用一个检查请求和数据解析是否发生的函数。

要解析 XML 本身，您可以使用 AFNetworking 扩展，例如： [https ://github.com/AFNetworking/AFKissXMLRequestOperation](https://github.com/AFNetworking/AFKissXMLRequestOperation)

或者您可以寻求更简单的解决方案（适用于任何网络框架），例如： [https ://github.com/nicklockwood/XMLDictionary](https://github.com/nicklockwood/XMLDictionary)

（假设您不想使用内置的 iOS6 方法）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-29T14:11:17.757

它很简单，我认为您可能有两个不同的 URL 可以正确发送请求，而您只有一种方法可以正确获得该响应，所以我遇到了这个问题，但它很简单，请保持标志

```
if(flag)
{
   then your first response
}
else
{
   your second response
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-29T15:20:02.787

1.  您可以通过为两个 Web 服务方法调用创建两个不同的连接对象来实现此目的。然后在连接委托方法中通过比较连接对象执行相应的任务。还可以通过比较连接对象来
    解析 xml 响应调用
    connectionDidFinishLoading 方法中的方法
    。
2.  另一种方法是在调用请求后，在 connectionDidFinishLoading 方法中将接收到的响应转换为 NSString 并找到区分两个响应的任何字符串以
    调用各自的解析方法

# c# - 如何映射数据合约以引用 JSON 对象中的正确字段？

> ID：14082109
> 
> 赞同：1
> 
> 时间：2012-12-29T13:23:43.300
> 
> 标签：c#, json, parsing, datacontractserializer

我正在接收一个类似于以下示例的 JSON 对象。

> {
> "name1":{"name1a":"value1a","name1b":"value1b"},
> "name2":{"name2a":"value2a","name2b":"value2b"}
> }

我已经为它建立了一个数据合约（因为我现在只需要访问一个数据字段）就像这样。

```
[DataContract]
public class MyThingy
{
  [DataMember(Name="name1b")]
  public string Name1b { get; set; }

  public MyThingy() { }

  public MyThingy(String name1b)
  {
    Name1b = name1b;
  }
} 
```

当我序列化对象时，我尝试将其打印出来（这很有效，因为我得到了类的字符串描述）并将它们打印出来`Name1b`。最后一部分不起作用，我要`null`到那里了。我的猜测是我一定是错误地映射了数据合约，但我不知道如何纠正它。

类应该如何`MyThingy`声明？

*[我的 JSON 对象是按照这篇文章](https://stackoverflow.com/questions/14081550/jsonserializer-cant-read-stream-from-streamreader/14081839#14081839)中的描述获取的。*

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T13:59:26.400

我会在这里使用[JavaScriptSerializer](http://msdn.microsoft.com/en-us/library/system.web.script.serialization.javascriptserializer.aspx)，

```
string json = @"{
    ""name1"":{""name1a"":""value1a"",""name1b"":""value1b""},
    ""name2"":{""name2a"":""value2a"",""name2b"":""value2b""}
    }";

var obj = new JavaScriptSerializer()
          .Deserialize<Dictionary<string, Dictionary<string, string>>>(json);

Console.WriteLine(obj["name1"]["name1b"]); 
```

您还可以将[Json.Net](http://json.codeplex.com/)和`dynamic`一起使用

```
dynamic  obj = JsonConvert.DeserializeObject(json);

Console.WriteLine(obj.name1.name1b); 
```

# ios - 重新排序旋转的uitableviewcell

> ID：14082111
> 
> 赞同：3
> 
> 时间：2012-12-29T13:24:07.870
> 
> 标签：ios, uitableview, cgaffinetransform

我有一个 uitableview，我已经旋转了 180 度，但我的单元格我已经旋转了 -180 度。效果是我从表格视图的底部加载我的数据。这很好用。当我尝试重新排序单元格时，问题就来了。如果我尝试拖动一个单元格，它的移动会反转并立即跳转到表格视图的顶部/底部，具体取决于我拖动的方向。

看到这一点的最简单方法是使用带有核心数据的主详细信息模板开始一个新项目。在 OIMasterViewConroller.m 文件的地方

```
CGAffineTransform transform = CGAffineTransformMakeRotation(-3.14159);
self.tableView.transform = transform; 
```

在 viewDidLoad 方法中，并放置

```
CGAffineTransform transform = CGAffineTransformMakeRotation(-3.14159);
cell.transform = transform; 
```

在 configureCell 方法中。最后把canMoveRowAtIndexPath改成返回YES，实现留空

```
-(void)tableView:(UITableView *)tableView moveRowAtIndexPath:(NSIndexPath *)fromIndexPath toIndexPath:(NSIndexPath *)toIndexPath {

} 
```

运行项目并使用 + 按钮向 tableview 添加一些项目。然后单击编辑按钮并尝试重新排序。

我相信问题出在单元格上，因为移除单元格上的旋转将停止这种奇怪的行为，即使桌子是倒置的。

我想只是旋转单元格内的文本，但是删除按钮是颠倒的，以及在错误的一侧。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-14T19:15:06.420

所以，我最终将表格视图和表格视图中使用的单元格子类化了。以下是我所做的一些事情：

在 tableview 子类中，我重载了 layoutsubviews：

```
- (void)layoutSubviews
{
    [super layoutSubviews];

    for (UIView *subview in self.subviews) {
        if ([NSStringFromClass([subview class]) isEqualToString:@"UIShadowView"]) {
            subview.hidden = YES;
        }
    }
} 
```

这将删除投影。如果您在重新排序时没有在 tableviewcells 顶部显示阴影。

对于 tableviewcell 子类，我像这样更改了它的 layoutSubviews：

```
- (void)layoutSubviews
{
    [super layoutSubviews];

      for (UIView *subview in self.subviews) {        
        if ([NSStringFromClass([subview class]) isEqualToString:@"UITableViewCellDeleteConfirmationControl"]) {
            CGRect newFrame = subview.frame;
            newFrame.origin.x = 0;
            subview.frame = newFrame;
            subview.transform = CGAffineTransformMakeRotation(-M_PI);
        }
        else if ([NSStringFromClass([subview class]) isEqualToString:@"UITableViewCellEditControl"]) {
            CGRect newFrame = subview.frame;
            newFrame.origin.x = 320-newFrame.size.width;
            subview.frame = newFrame;
            subview.transform = CGAffineTransformMakeRotation(-M_PI);
        }
        else if ([NSStringFromClass([subview class]) isEqualToString:@"UITableViewCellReorderControl"]) {
            CGRect newFrame = subview.frame;
            newFrame.origin.x = 0;
            subview.frame = newFrame;
        }else if([NSStringFromClass([subview class]) isEqualToString:@"UIButton"]) {
            CGRect newFrame = subview.frame;
            newFrame.origin.x = 0;
            subview.frame = newFrame;
            subview.transform = CGAffineTransformMakeRotation(-M_PI);
        }else{
            subview.transform = CGAffineTransformMakeRotation(-M_PI);
        }
    }  
} 
```

这会旋转并移动所有删除按钮/指示器等。需要注意的重要一点是，我们不会旋转 UITableViewCellReorderControll。旋转这个子视图是导致重新排序混乱的原因。

# c# - Mesh.Effects 输入 XNA

> ID：14082113
> 
> 赞同：2
> 
> 时间：2012-12-29T13:24:11.740
> 
> 标签：c#, .net, matrix, xna

我不太明白什么是`effect.World`等`effect.View`以及为什么我们将矩阵放入其中？

```
foreach (ModelMesh mesh in model1.Meshes)
        {
            foreach (BasicEffect effect in mesh.Effects)
            {
                effect.World = Matrix.CreateWorld(Vector3.Zero, Vector3.Forward, Vector3.Up);
                effect.View = Matrix.CreateLookAt(Vector3.Zero, Vector3.Zero, Vector3.Up);
            }
        } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T16:49:44.470

effect.World 不是代表世界的矩阵。它是一个矩阵，表示 3d 对象（网格、模型）相对于 3d 游戏世界的位置和方向。每个对象将具有不同的效果。如果它们的位置不同和/或指向不同，则世界矩阵。

effect.View 是一个矩阵，表示（以倒置形式）相机相对于同一个 3d 游戏世界的位置和方向。大多数时候，只有一个摄像头，但可以有更多（例如，后视镜将拥有自己的视图矩阵，而不是显示赛车游戏挡风玻璃视图的主屏幕）。

1.  模型的顶点很难对局部空间进行建模。
2.  然后 effect.World 将它们转换为游戏世界空间。
3.  然后 effect.View 将它们转换为相机空间。
4.  然后 effect.Projection 将它们转换为 2d 屏幕空间和“volia”，您的像素着色器知道在哪里绘制什么。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T13:30:14.643

来自 MSDN；

[`BasicEffect.World`](http://msdn.microsoft.com/en-us/library/microsoft.xna.framework.graphics.basiceffect.world.aspx)

> 获取或设置世界矩阵。**使用这个矩阵来改变模型的位置，使用世界坐标**。

[`BasicEffect.View`](http://msdn.microsoft.com/en-us/library/microsoft.xna.framework.graphics.basiceffect.view.aspx)

> 获取或设置视图矩阵。**使用这个矩阵来改变相机的位置和方向**。

我认为粗线可以解释它们的区别。我还发现了一些有用的文章；

*   [如何：使用 BasicEffect](http://msdn.microsoft.com/en-us/library/bb203926%28v=xnagamestudio.10%29.aspx)
*   [XNA 游戏中的每个实体都需要它自己的 BasicEffect 实例吗？](https://gamedev.stackexchange.com/questions/36026/does-every-entity-in-an-xna-game-need-its-own-basiceffect-instance)
*   [了解半像素和半纹素偏移](http://drilian.com/2008/11/25/understanding-half-pixel-and-half-texel-offsets/)
*   [http://blogs.msdn.com/b/shawnhar/archive/2010/04/05/spritebatch-and-custom-shaders-in-xna-game-studio-4-0.aspx](http://blogs.msdn.com/b/shawnhar/archive/2010/04/05/spritebatch-and-custom-shaders-in-xna-game-studio-4-0.aspx)
*   [http://msdn.microsoft.com/en-us/library/bb219690(VS.85).aspx](http://msdn.microsoft.com/en-us/library/bb219690(VS.85).aspx)

# asp.net - 更改连接对代码的影响

> ID：14082117
> 
> 赞同：2
> 
> 时间：2012-12-29T13:24:57.537
> 
> 标签：asp.net, mysql, sql-server, oracle, c#-4.0

我正在使用 asp.net，目前正在使用 SQL SERVER 2008。在我的代码中，所有 DML 操作都是在 SqlConnection、SqlCommand、SqlDataAdapter 的帮助下进行的。

但是当我的数据库迁移到**ORACLE**或**MySQL**时，我需要为 ORACLE 编写代码——OLEDBConnection、OLEDBCommand、OLEDBDataAdapter MySQL——需要包含一个 MySQL dll。

现在由于这个巨大的变化，我需要再次编写整个代码。

1.  有什么办法可以克服这个问题，我们一次编写代码并且不依赖于数据库提供者？
2.  实体框架是否出现在这张图片中的任何地方？

请指导我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T13:28:22.677

如果您使用基类和 中的其他类编写数据访问层[`DbConnection`](http://msdn.microsoft.com/en-us/library/system.data.common.dbconnection.aspx)，则可以传入并使用*任何*继承类型。[`DbCommand`](http://msdn.microsoft.com/en-us/library/system.data.common.dbcommand.aspx)[`System.Data.Common`](http://msdn.microsoft.com/en-us/library/9tahwysy.aspx)

 *这意味着您只需编写一次数据访问层，但*注入*您使用的实际类型，可能使用[IoC](http://en.wikipedia.org/wiki/Inversion_of_control)容器。

大多数 ORM，包括 EF，都使用这种技术与数据库无关。*

# objective-c - 是什么导致此代码 #2 中的“错过方法”？

> ID：14082123
> 
> 赞同：0
> 
> 时间：2012-12-29T13:26:06.597
> 
> 标签：objective-c, ios5, game-center

我在这个线程中遇到了同样的问题：[是什么导致了这段代码中的“错过方法”？](https://stackoverflow.com/questions/6323244/what-causes-missed-method-in-this-code)

但我不明白如何解决这个问题，或者它是否是一个问题。

我正在做“Beginning iOS Game Center and Game Kit”一书中的教程并遇到这个问题。我总是得到“......错过的方法”，并试图理解为什么，不幸的是我没有。我也尝试使用上面线程上的答案，但无济于事。

我非常感谢对此提供的一些帮助。

我目前使用的代码：

```
#import "GameCenterManager.h"

@implementation GameCenterManager

@synthesize delegate;

+(BOOL)isGameCenterAvailable {
Class gcClass = (NSClassFromString(@"GKLocalPlayer"));

NSString *reqSysVer = @"4.1";
NSString *currSysVer = [[UIDevice currentDevice]systemVersion];

BOOL osVersionSupported = ([currSysVer compare:reqSysVer options:NSNumericSearch] != NSOrderedAscending);

return (gcClass && osVersionSupported);
}

-(void)retrieveFriendsList {

if ([GKLocalPlayer localPlayer].authenticated == YES) {
    [[GKLocalPlayer localPlayer]loadFriendsWithCompletionHandler:^(NSArray *friends, NSError *error) {
        [self callDelegateOnMainThread:@selector(friendsFinishLoading:error:) withArg:friends error:error];
    }];
} else {
    NSLog(@"...You must authenticate first");
}
}

-(void)authenticateLocalUser {

if ([GKLocalPlayer localPlayer].authenticated) {
    return;
}

[[GKLocalPlayer localPlayer] authenticateWithCompletionHandler:^(NSError *error){
    [self callDelegateOnMainThread:@selector(processGameCenterAuthentication:) withArg:NULL error: error];
}];
}

-(void)callDelegateOnMainThread:(SEL)selector withArg: (id) arg error:(NSError*) err {
dispatch_async(dispatch_get_main_queue(), ^(void) {
    [self callDelegate:selector withArg: arg error: err];
});
}

-(void)callDelegate: (SEL) selector withArg: (id) arg error: (NSError*) err {
assert([NSThread isMainThread]);

if ([delegate respondsToSelector: selector]) {
    if(arg != NULL) {
        [delegate performSelector: selector withObject: arg withObject: err];

    } else {
        [delegate performSelector: selector withObject: err];
    }
} else {
    NSLog(@"...Missed Method");
}
} 
```

GC授权后输出：

```
...Missed Method 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T13:32:08.577

您编写的调用`[self callDelegateOnMainThread:@selector(processGameCenterAuthentication:) withArg:NULL error: error];`最终以方法 ( `callDelegate:withArg:error:`) 结束，该方法检查您的类是否实现了该`processGameCenterAuthentication:`方法。你得到了`Missed Method`输出，因为你似乎没有实现它。

# java - 如果上下文和根名称不同，则获取 Java Web 应用程序中的根目录名称

> ID：14082132
> 
> 赞同：1
> 
> 时间：2012-12-29T13:27:04.780
> 
> 标签：java, web-applications, servlets, root, contextpath

我有一个 Web 应用程序，其中上下文名称与我的根名称不同。例如，我的根目录名称是`myapp`，上下文路径是`app`. 那么如何从 Java Web 应用程序中获取根名称（myapp）呢？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-29T13:34:02.830

如果应用程序未使用 war 文件部署，您可以使用此代码返回应用程序运行的整个地址。

```
//request variable is the Java HTTP servlet request object received from an action 
request.getSession().getServletContext().getRealPath("/"); 
```

我给出的代码是我在我的一个 Java EE 项目中使用的代码，由于某些原因，我没有将我的项目部署为 war 文件

并获取 Web 应用程序位置可用于获取您的根目录名称

# string - Scala中的单词计数示例？

> ID：14082133
> 
> 赞同：1
> 
> 时间：2012-12-29T13:27:09.073
> 
> 标签：string, scala, associative-array

我看到很多 Scala 教程，其中包含递归遍历或解决数学问题等示例。在我的日常编程生活中，我感觉我的大部分编码时间都花在了诸如字符串操作、数据库查询和日期操作之类的普通任务上。有没有人有兴趣给出以下 perl 脚本的 Scala 版本的示例？

```
#!/usr/bin/perl
use strict;
#opens a file with on each line one word and counts the number of occurrences 
# of each word, case insensitive
print "Enter the name of your file, ie myfile.txt:\n";
my $val = <STDIN>;
chomp ($val);
open (HNDL, "$val") || die "wrong filename";

my %count = ();
while ($val = <HNDL>)
{
        chomp($val);
    $count{lc $val}++;
}
close (HNDL);

print "Number of instances found of:\n";
foreach my $word (sort keys %count) {
        print "$word\t: " . $count{$word} . " \n";
} 
```

总之：

*   询问文件名
*   读取文件（每行包含 1 个字）
*   取消行尾（cr、lf 或 crlf）
*   小写单词
*   单词的增量计数
*   打印出每个单词，按字母顺序排序，以及它的计数

TIA

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-29T14:06:49.260

像这样的简单字数可以写成如下：

```
import io.Source
import java.io.FileNotFoundException

object WC {

  def main(args: Array[String]) {
    println("Enter the name of your file, ie myfile.txt:")
    val fileName = readLine

    val words = try {
      Source.fromFile(fileName).getLines.toSeq.map(_.toLowerCase.trim)
    } catch {
      case e: FileNotFoundException =>
        sys.error("No file named %s found".format(fileName))
    }

    val counts = words.groupBy(identity).mapValues(_.size)

    println("Number of instances found of:")
    for((word, count) <- counts) println("%s\t%d".format(word, count))

  }

} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-30T11:52:32.870

如果您想要简洁/紧凑，您可以在 2.10 中：

```
// Opens a file with one word on each line and counts
// the number of occurrences of each word (case-insensitive)
object WordCount extends App {
  println("Enter the name of your file, e.g. myfile.txt: ")
  val lines = util.Try{ io.Source.fromFile(readLine).getLines().toSeq } getOrElse
    { sys.error("Wrong filename.") }
  println("Number of instances found of:")
  lines.map(_.trim.toLowerCase).toSeq.groupBy(identity).toSeq.
    map{ case (w,ws) => s"$w\t: ${ws.size}" }.sorted.foreach(println)
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-08-07T19:52:39.637

```
 val lines : List[String] = List("this is line one" , "this is line 2", "this is line three")

  val linesConcat : String = lines.foldRight("")( (a , b) => a + " "+ b)

  linesConcat.split(" ").groupBy(identity).toList.foreach(p => println(p._1+","+p._2.size)) 
```

印刷 ：

```
this,3
is,3
three,1
line,3
2,1
one,1 
```

# java - 在 Eclipse 中将对象实例分配给整数 var

> ID：14082136
> 
> 赞同：1
> 
> 时间：2012-12-29T13:27:57.823
> 
> 标签：java, eclipse

在 main 方法中创建一个 Object 实例并将其分配给一个整数变量。当抛出异常时，使用 try catch 处理它并在 catch 子句中打印一条消息。我不知道该怎么做。我这样做了：

```
public class Ch7LU1Ex4{

   public static void main(String argv[]) {   

     try{

       Object o = new Integer(10);
       int b = (Integer) o;

     }catch(Exception e){
       System.out.print("Exception caught");
     }

  }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T13:32:15.827

你已经完成了任务要求的事情（尽管我会在没有自动拆箱的情况下将其编码为`Integer i = (Intsger)o;`），但是你不会得到异常，因为强制转换会起作用 - 将 Integer 强制转换为 Integer 不会导致异常。

尝试这个：

```
Object o = new Object(), 
```

然后，您将练习您的捕获代码

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-29T13:32:18.383

这个作业很奇怪（它告诉你实现一个错误，基本上），但我认为老师想要的是：

```
public static void main(String args[]) {   
    try {
        Object o = new Object();
        Integer b = (Integer) o;
    }
    catch (ClassCastException e) {
        System.out.print("An Object is not an Integer. The above makes no sense");
    }
} 
```

也许让你意识到只有 Integer 实例可以转换为 Integer。

# python - 重复的瞬态套接字连接 - 内存泄漏风险？

> ID：14082142
> 
> 赞同：1
> 
> 时间：2012-12-29T13:28:28.513
> 
> 标签：python, sockets, memory-leaks

我正在编写一个脚本，它打开一个文本文件并循环遍历每一行（每行之间暂停几秒钟）。对于每一行，它都会打开一个瞬态客户端套接字连接并将文本发送到主机服务器。主机响应可能会或可能不会出现；无论哪种方式都没关系。

我已经遇到了 Python 套接字限制，您无法重新连接现有的套接字对象（因为这样做会触发异常`EBADF, 'Bad file descriptor'`）。所以我正在为每个瞬态连接创建一个新的套接字实例。那么诀窍当然就是如何避免内存泄漏。

我解决这个问题的方法是将创建、使用和关闭套接字的整个部分推送到一个函数——在我完成后依靠 Python 的垃圾收集来删除每个实例：

```
    导入套接字，选择，时间

    def 瞬态连接（主机、端口、发送数据）：
        响应 = ''
        sendSocket = socket.socket()
        sendSocket.connect((serverHost,serverPort))
        sendSocket.send(线)
        gotData = select.select([sendSocket],[],[],2)
        if (gotData[0]):response = sendSocket.recv(65535)
        sendSocket.close()
        返回响应

    scriptLines = open('testScript.txt','r').readlines()
    服务器主机 = '127.0.0.1'
    服务器端口 = 15004
    对于 scriptLines 中的行：
        响应 = 瞬态连接（服务器主机、服务器端口、线路）
        打印（响应）
        时间.sleep(3.0)

```

我的问题：（1）这种方法可以避免任何内存泄漏吗？(2) 是否有更直接的方法来确保在我完成后消除每个实例？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T14:06:18.543

首先，一次交换只使用一个套接字是正常的。请参阅[套接字 HOWTO](http://docs.python.org/2/howto/sockets.html)。

python 的优点之一是通常您不必担心垃圾收集。除非你有真正的内存使用问题，否则你不应该这样做。

在[此网页](http://eli.thegreenplace.net/2009/06/12/safely-using-destructors-in-python/)中，请记住：

> “当对象超出范围时，Python 不会清理它。当对它的最后一个引用超出范围时，它会清理它。”

因此，如果在函数内部创建的套接字没有在其他地方引用，它应该超出范围并被释放（但不是 gc-ed）。以下内容可能特定于 cpython。阅读文档以[`gc.set_threshold()`](http://docs.python.org/2/library/gc.html#gc.set_threshold)了解垃圾收集在 cpython 中的工作原理。尤其：

> “当分配数减去解除分配数超过*threshold0*时，收集开始。”

阈值的标准值（在 cpython 中）是：

```
In [2]: gc.get_threshold()
Out[2]: (700, 10, 10) 
```

所以在你运行 gc 之前会有相当数量的分配。您可以通过运行*强制*垃圾收集[`gc.collect()`](http://docs.python.org/2/library/gc.html#gc.collect)。

# emacs - 如何指定一个窗口作为 Emacs 中所有链接的目标？

> ID：14082145
> 
> 赞同：4
> 
> 时间：2012-12-29T13:29:16.297
> 
> 标签：emacs, org-mode

我正在尝试创建一个设置，其中在框架的左侧有 2 个窗口，包含 Org 模式缓冲区，在框架的右侧有一个大窗口，我想成为所有链接的目标在左侧缓冲区中。

如何强制在右侧窗口中打开组织模式链接？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-29T19:31:46.760

你可以做

```
M-: (set-window-dedicated-p (selected-window) t) 
```

在要保持不变的窗口上。

# ios6 - 如何以编程方式向下滑动 UITableView 以显示底层 UIRefreshControl

> ID：14082149
> 
> 赞同：23
> 
> 时间：2012-12-29T13:30:08.730
> 
> 标签：ios6, uitableview, uirefreshcontrol

以编程方式更新表格时如何显示 UIRefreshControl？使用 [self.refreshControl beginRefreshing] 使微调器动画但不显示它。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-12-31T23:48:32.160

您必须自己手动更改`contentOffset`。`UITableView`一定要考虑到`contentInset.top`。它应该很简单：

```
CGPoint newOffset = CGPointMake(0, -[myTableView contentInset].top);
[myTableView setContentOffset:newOffset animated:YES]; 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2013-04-27T10:08:30.987

这会成功的

```
- (void)beginRefreshingTableView {

    [self.refreshControl beginRefreshing];

    // check if contentOffset is zero
    if (fabsf(self.tableView.contentOffset.y) < FLT_EPSILON) {

        [UIView animateWithDuration:0.25 delay:0 options:UIViewAnimationOptionBeginFromCurrentState animations:^(void){

            self.tableView.contentOffset = CGPointMake(0, -self.refreshControl.frame.size.height);

        } completion:^(BOOL finished){

        }];

    }
} 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2016-02-15T00:52:39.833

对于 Swift 3，这是我根据 Peter Lapisu 的回答得出的：

```
override func viewDidLoad() {
    super.viewDidLoad()
    self.refreshControl?.addTarget(self, action: #selector(refresh), forControlEvents: UIControlEvents.ValueChanged)
    // ...
}

func refresh(sender:AnyObject) {
    self.refreshControl?.beginRefreshing()

    if let yOffsetTable = self.tableView?.contentOffset.y {
        if yOffsetTable < CGFloat(Float.ulpOfOne) {
            UIView.animate(withDuration: 0.25, delay: 0, options: UIViewAnimationOptions.beginFromCurrentState, animations: {
                if let refreshControlHeight = self.refreshControl?.frame.height {
                    self.tableView?.contentOffset = CGPoint(x: 0, y: -refreshControlHeight)
                }
            }, completion: nil)
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2019-04-14T10:42:53.033

对于 Swift 5，这是我唯一的工作版本。

```
extension UIRefreshControl {

    func beginRefreshingManually() {
        if let scrollView = superview as? UIScrollView {
            scrollView.setContentOffset(CGPoint(x: 0, y: scrollView.contentOffset.y - frame.height), animated: false)
        }
        beginRefreshing()
        sendActions(for: .valueChanged)
    }

} 
```

# sqlite - sqlite3：没有这样的文件或目录

> ID：14082152
> 
> 赞同：4
> 
> 时间：2012-12-29T13:30:42.740
> 
> 标签：sqlite, android-sdk-tools

我下载了 ADT Bundle，现在无法`sqlite`从该`tools`目录运行。

```
red-planet@desktop:~/Adt-bundle/sdk/tools$ ls 
adb_has_moved.txt  ddms            emulator64-mips  etc1tool         lint          proguard           templates
android            dmtracedump     emulator64-x86   hierarchyviewer  mksdcard      source.properties  traceview
ant                draw9patch      emulator-arm     hprof-conv       monitor       sqlite3            uiautomatorviewer
apkbuilder         emulator        emulator-mips    jobb             monkeyrunner  support            zipalign
apps               emulator64-arm  emulator-x86     lib              NOTICE.txt    systrace
red-planet@desktop:~/Adt-bundle/sdk/tools$ sqlite3 
bash: /home/red-planet/Adt-bundle/sdk/tools/sqlite3: No such file or directory
red-planet@desktop:~/Adt-bundle/sdk/tools$ 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T14:53:51.113

**解决方案。**

我找到了解决方案。我在 64 位 Ubuntu 上工作，必须让 64 位应用程序在 64 位操作系统上运行。

`sudo apt-get install ia32-libs` [https://help.ubuntu.com/community/32bit_and_64bit](https://help.ubuntu.com/community/32bit_and_64bit)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-29T13:43:59.190

`./` 在linux中的可执行文件之前添加。试试这个

```
./sqlite3 
```

# wordpress - apache重定向与现有的mod重写（wordpress）

> ID：14082153
> 
> 赞同：0
> 
> 时间：2012-12-29T13:30:57.780
> 
> 标签：wordpress, apache, mod-rewrite, redirect

我正在更改 wordpress 站点的域，并且我希望旧站点的任何 url 重定向到新站点，只重写域。

换句话说：

*   site.com 应该重定向到 en.site.se
*   site.com/page 应该重定向到 en.site.se/page
*   site.com/something/about/someone/and/so/on.jpg 应该重定向到 en.site.se/something/about/someone/and/so/on.jpg

当前的 mod_rewrite 如下所示：

```
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /
RewriteRule ^index\.php$ - [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.php [L]
</IfModule> 
```

我自己确实尝试了一些新的重写规则，但我没有设法让事情正常工作。[我正在考虑做一些事情，比如用http://en.site.se](http://en.site.se)替换一次 index.php

这是一些失败的代码：

```
#RewriteRule . http://en.site.se/$1 [R=301,L]
#RewriteRule ^(.*)$ http://en.site.se/$1 [R=301,L] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T16:16:37.577

```
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /

RewriteCond %{HTTP_HOST} ^site.se$ [NC]
RewriteRule (.*) http://en.site.se/$1 [R=302,L]

RewriteRule ^index\.php$ - [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.php [L]
</IfModule> 
```

一旦你开始工作，将 302 更改为 301。

# arrays - 使用 Repa 并行数组的惯用期权定价和风险

> ID：14082158
> 
> 赞同：28
> 
> 时间：2012-12-29T13:31:36.790
> 
> 标签：arrays, performance, haskell, repa

假设我想使用有限差分法为看涨期权定价并重新计算，那么下面的工作就完成了：

```
import Data.Array.Repa as Repa

r, sigma, k, t, xMax, deltaX, deltaT :: Double
m, n, p :: Int
r = 0.05
sigma = 0.2
k = 50.0
t = 3.0
m = 3
p = 1
xMax = 150
deltaX = xMax / (fromIntegral m)
n = 800
deltaT = t / (fromIntegral n)

singleUpdater a = traverse a id f
  where
    Z :. m = extent a
    f _get (Z :. ix) | ix == 0   = 0.0
    f _get (Z :. ix) | ix == m-1 = xMax - k
    f  get (Z :. ix)             = a * get (Z :. ix-1) +
                                   b * get (Z :. ix) +
                                   c * get (Z :. ix+1)
      where
        a = deltaT * (sigma^2 * (fromIntegral ix)^2 - r * (fromIntegral ix)) / 2
        b = 1 - deltaT * (r  + sigma^2 * (fromIntegral ix)^2)
        c = deltaT * (sigma^2 * (fromIntegral ix)^2 + r * (fromIntegral ix)) / 2

priceAtT :: Array U DIM1 Double
priceAtT = fromListUnboxed (Z :. m+1) [max 0 (deltaX * (fromIntegral j) - k) | j <- [0..m]]

testSingle :: IO (Array U DIM1 Double)
testSingle = computeP $ singleUpdater priceAtT 
```

但现在假设我想并行定价期权（比如做一个现货阶梯），那么我可以这样做：

```
multiUpdater a = fromFunction (extent a) f
     where
       f :: DIM2 -> Double
       f (Z :. ix :. jx) = (singleUpdater x)!(Z :. ix)
         where
           x :: Array D DIM1 Double
           x = slice a (Any :. jx)

priceAtTMulti :: Array U DIM2 Double
priceAtTMulti = fromListUnboxed (Z :. m+1 :. p+1)
                [max 0 (deltaX * (fromIntegral j) - k) | j <- [0..m], _l <- [0..p]]

testMulti :: IO (Array U DIM2 Double)
testMulti = computeP $ multiUpdater priceAtTMulti 
```

问题：

1.  在 repa 中是否有更惯用的方式来做到这一点？
2.  上述方法实际上会并行定价吗？
3.  如何确定我的代码是否真的在生成将并行执行的东西？

我尝试了 3 次，但遗憾的是在 ghc 中遇到了一个错误：

```
bash-3.2$ ghc -fext-core --make Test.hs
[1 of 1] Compiling Main             ( Test.hs, Test.o )
ghc: panic! (the 'impossible' happened)
 (GHC version 7.4.1 for x86_64-apple-darwin):
    MkExternalCore died: make_lit 
```

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2012-12-29T16:22:47.510

您的错误与您的代码无关——它是您用来`-fext-core`以外部核心格式打印编译输出的。只是不要这样做（要查看核心，我使用[ghc-core](http://hackage.haskell.org/package/ghc-core)）。

`-O2`用和编译`-threaded`：

```
$ ghc -O2 -rtsopts --make A.hs -threaded 
[1 of 1] Compiling Main             ( A.hs, A.o )
Linking A ... 
```

然后运行`+RTS -N4`，例如，使用 4 个线程：

```
$ time ./A +RTS -N4
[0.0,0.0,8.4375e-3,8.4375e-3,50.009375,50.009375,100.0,100.0]
./A  0.00s user 0.00s system 85% cpu 0.008 total 
```

所以它完成得太快而看不到结果。我会把你的`m`和`p`参数增加到 1k 和 3k

```
$ time ./A +RTS -N2
./A +RTS -N2  3.03s user 1.33s system 159% cpu 2.735 total 
```

所以是的，它确实并行运行。1.6x 在 2 核机器上，第一次尝试。它是否有效是另一个问题。使用 +RTS -s 可以查看运行时统计信息：

任务：4（1 个绑定，3 个高峰工人（总共 3 个），使用 -N2）

所以我们有 3 个线程并行运行（2 个可能用于算法，1 个用于 IO 管理器）。

[您可以通过调整 GC 设置](http://donsbot.wordpress.com/2010/07/05/ghc-gc-tune-tuning-haskell-gc-settings-for-fun-and-profit/)来减少运行时间。例如，通过使用`-A`我们可以减少 GC 开销，并产生真正的并行加速。

```
$ time ./A +RTS -N1 -A100M   
./A +RTS -N1 -A100M  1.99s user 0.29s system 99% cpu 2.287 total

$ time ./A +RTS -N2 -A100M   
./A +RTS -N2 -A100M  2.30s user 0.86s system 147% cpu 2.145 total 
```

您有时可以通过使用 LLVM 后端来提高数值性能。这似乎也是这种情况：

```
$ ghc -O2 -rtsopts --make A.hs -threaded -fforce-recomp -fllvm
[1 of 1] Compiling Main             ( A.hs, A.o )
Linking A ...

$ time ./A +RTS -N2 -A100M                                    
./A +RTS -N2 -A100M  2.09s user 0.95s system 147% cpu 2.065 total 
```

没什么了不起的，但是您正在改善单线程版本的运行时间，而且我没有以任何方式修改您的原始代码。要真正改善事物，您需要进行分析和优化。

重新访问 -A 标志，我们可以在初始线程分配区域上使用更严格的界限来进一步缩短时间。

```
$ ghc -Odph -rtsopts --make A.hs -threaded -fforce-recomp -fllvm

$ time ./A +RTS -N2 -A60M -s
./A +RTS -N2 -A60M 1.99s user 0.73s system 144% cpu 1.880 total 
```

因此，通过使用并行运行时、LLVM 后端并小心使用 GC 标志，将其从 2.7 降低到 1.8 秒（提高了 30%）。您可以查看 GC 标志表面以找到最佳值：

![在此处输入图像描述](../Images/181d0614b085ea25104dae23fabbaa08.png)

周围的波谷`-A64 -N2`是数据集大小的理想选择。

我也强烈考虑在你的内核中使用手动[公共子表达式消除，以避免过度重新计算。](http://www.haskell.org/haskellwiki/GHC_optimisations#Common_subexpression_elimination)

正如 Alp 所建议的，要查看程序的运行时行为，请编译 threadscope（来自 Hackage）并运行如下：

```
$ ghc -O2 -fllvm -rtsopts -threaded -eventlog --make A.hs

$ ./A +RTS -ls -N2 -A60M 
```

你会得到两个核心的事件跟踪，如下所示：

![在此处输入图像描述](../Images/a65c6e246e81968443648f1be8263382.png)

那么这里发生了什么？您有一个初始阶段（0.8 秒）的设置时间 - 分配您的大列表并将其编码到一个 repa 数组中 - 正如您通过 GC 和执行的单线程交错所看到的那样。然后在最后 300 毫秒发生实际并行工作之前，单核上还有 0.8 秒的时间。

因此，虽然您的实际算法可能很好地并行化，但所有周围的测试设置基本上都会淹没结果。如果我们[序列化您的 dataset](http://hackage.haskell.org/packages/archive/repa-io/3.2.3.1/doc/html/Data-Array-Repa-IO-Binary.html)，然后从磁盘加载它，我们可以获得更好的行为：

```
$ time ./A +RTS -N2 -A60M
./A +RTS -N2 -A60M  1.76s user 0.25s system 186% cpu 1.073 total 
```

现在您的个人资料看起来更健康了：

![在此处输入图像描述](../Images/904e6a76415f31732c4f9cbd8f5d6c84.png)

这看起来很棒！很少的 GC（98.9% 的生产力），我的两个内核愉快地并行运行。

所以，最后，我们可以看到你得到了很好的并行性：

1核1.855s

```
$ time ./A +RTS -N1 -A25M
./A +RTS -N1 -A25M  1.75s user 0.11s system 100% cpu 1.855 total 
```

2核1.014s

```
$ time ./A +RTS -N2 -A25M   
./A +RTS -N2 -A25M  1.78s user 0.13s system 188% cpu 1.014 total 
```

* * *

现在，具体回答您的问题：

1.  在 repa 中是否有更惯用的方式来做到这一点？

一般来说，repa 代码应该由并行遍历、消费者和生产者以及可内联的内核函数组成。所以只要你这样做，那么代码可能是惯用的。如有疑问，请查看[教程](http://www.haskell.org/haskellwiki/Numeric_Haskell:_A_Repa_Tutorial)。我通常会将您的工作内核（如`f`）标记为内联。

1.  上述方法实际上会并行定价吗？

如果您使用并行组合器（如`computeP`各种映射和折叠），代码将并行执行。所以是的，它应该并且确实并行运行。

1.  如何确定我的代码是否真的在生成将并行执行的东西？

通常，您会*先验地*知道，因为您使用并行操作。如果有疑问，请运行代码并观察加速。然后您可能需要优化代码。

# r - 创建从 0 开始的序列

> ID：14082159
> 
> 赞同：1
> 
> 时间：2012-12-29T13:31:43.490
> 
> 标签：r, seq

我喜欢使用`seq()`R 中的命令来创建从零开始的序列。但是当我输入例如

```
seq(0:14) 
```

我得到以下输出：

```
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-12-29T15:33:39.687

正如其他人所说，你想要`0:14`或`seq(from=0,to=14)`得到你不想要的结果的原因也值得注意。

在这种情况下，冒号运算符本身（如 中所述`?':'`）正在生成所需的常规整数序列，然后您将其提供给`seq()`.

`seq()`猜测您的意思`seq(along.with = 0:14)`是返回与您提供的东西长度相同的序列。当然，它使用的是默认值`from = 1`。所以它给你一个从一个开始的十五个整数的序列。大致类似于这样：

```
(x <- 0:14)
# [1]  0  1  2  3  4  5  6  7  8  9 10 11 12 13 14

seq(along.with = x, from = 1)
# [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 
```

尽管导致您遇到错误，但此`along.with`功能对于制作与某些向量/列表/矩阵长度相同的序列显然很有用：

```
seq(c(1,"w",5,6,NA))
# [1] 1 2 3 4 5 
```

而且我们不能说`?seq`没有警告我们命名我们的论点：

> seq 和 seq.int 的未命名参数的解释不标准，建议在编程时始终命名参数。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-12-29T13:33:23.727

你的意思是做

```
0:14 
```

或者

```
seq(0, 14) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-29T15:35:31.913

您的问题在于语法。i:j 创建一个从数字 i 到 j 的序列；例如 1:5 可以读作 1 到 5 或 1,2,3,4,5。

另一方面，函数 seq 接受一个 'to' 参数和一个 'from' 参数，这两个参数都必须是单个数字。输入 seq(0:14) 意味着将一个向量——而不是单个数字——传递给 seq 的参数之一。

你想要的是

```
seq(from=0, to=14) 
```

希望有帮助

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-12-29T13:37:48.063

`seq(0, 14)`为我得到以下输入：

```
[1]  0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 
```

# actionscript-3 - 通过 RTMFP 在 ByteArray 中发送语音

> ID：14082160
> 
> 赞同：0
> 
> 时间：2012-12-29T13:31:58.690
> 
> 标签：actionscript-3, apache-flex, netstream, voice-recording

我正在构建一个操纵语音数据的语音聊天。我从 Microphone 获取 SAMPLE_DATA (ByteArray) 并通过 NetStream send() 方法发送它。然后我必须**将其转换回声音**。我该怎么做？

这是建立连接、捕获和发送语音数据的类（我知道这很丑，但它是临时版本）。

```
package app.net {

public class CirrusConnection extends EventDispatcher {
    private const SERVER_ADDRESS:String = "rtmfp://p2p.rtmfp.net/";
    private const DEVELOPER_KEY:String = "bla-bla-bla";

    // Net objects ~~~~~~~~~~
    private var nc:NetConnection;

    private var sendStream:NetStream;
    private var recvStream:NetStream;

    private var myPeerID:String;
    private var farPeerID:String;

    // User output handler
    private var chatTextArea:TextArea;

    //---
    private var mic:Microphone;
    //---

    public function CirrusConnection() { }

    public function initConnection():void {
        nc = new NetConnection();
        nc.addEventListener(NetStatusEvent.NET_STATUS, netStatusHandler);
        nc.connect(SERVER_ADDRESS + DEVELOPER_KEY);

        mic = Microphone.getMicrophone();
        mic.rate = 8;
        mic.setUseEchoSuppression(true);
        mic.gain = 50;
    }

    private function netStatusHandler(event:NetStatusEvent):void {
        trace("CirrusConnection: " + event.info.code);
        switch(event.info.code) {
            case "NetConnection.Connect.Success":
                myPeerID = nc.nearID;
                openSendStream();
                dispatchEvent(new Event(NetEvent.CIRRUS_SENT_KEY));
                break;
            case "NetStream.Play.Start":
                dispatchEvent(new Event(NetEvent.CLIENT_IS_CALLING ));
                break;
        }
    }

    public function getNetConnection():NetConnection {
        return nc;
    }

    public function getMyPeerID():String {
        return myPeerID;
    }

    public function isConnected():Boolean {
        return Boolean(myPeerID);
    }

    public function setChatTextArea(chatTextArea:TextArea):void {
        this.chatTextArea = chatTextArea;
    }

    private function openSendStream():void {
        var sendStreamClient:Object = new Object();
        sendStreamClient.onPeerConnect = function(callerns:NetStream):Boolean {
            if (!Boolean(farPeerID)) {
                connectToPeer(callerns.farID);
            }
            return true;
        }

        sendStream = new NetStream(this.nc, NetStream.DIRECT_CONNECTIONS);
        sendStream.addEventListener(NetStatusEvent.NET_STATUS, netStatusHandler);
        sendStream.client = sendStreamClient;
        sendStream.publish("media");
    }

    public function connectToPeer(id:String):void {
        farPeerID = id;
        recvStream = new NetStream(nc,farPeerID);
        recvStream.addEventListener(NetStatusEvent.NET_STATUS,netStatusHandler);
        recvStream.client = this;
        recvStream.play("media");
    }

    public function read(data:ByteArray):void {
        var snd:Sound = new Sound();
        data.position = 0;
        snd.loadPCMFromByteArray(data, data.length >> 3);
        snd.play();
    }

    public function beginStreamMicrophoneData():void {
        mic.addEventListener("sampleData", streamData);
    }

    public function streamData(event:SampleDataEvent):void {
        sendStream.send("read", event.data as ByteArray );
    }

}

} 
```

捕获麦克风数据时调用 streamData 函数。它正在向第二个对等方发送 ByteArray。第二个对等方正在读取功能中获取它。会有东西解码它。现在它正在工作，但我的扬声器中的声音很糟糕。我将不胜感激，并提前感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T13:49:14.000

尽管我一直在流媒体源和接收器之间看到媒体服务器，但您的方法似乎是合理的。您可以尝试设置`Red5`（或类似方法），将音频流式传输为“实时”源，然后从另一端播放。

虽然传输中*可能是*PCM（尽管有几种压缩方式可用），但您可能会听到噪音，因为您错过了翻译步骤。

# java - 如何在 GUI 文本字段中显示日期？

> ID：14082162
> 
> 赞同：0
> 
> 时间：2012-12-29T13:31:59.793
> 
> 标签：java

我正在尝试在文本字段中显示日期，这就是我所做的

```
java.util.Date date=new java.util.Date();
this.DateObject.setText(date); 
```

但它显示错误...

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-29T13:37:19.247

试试下面的代码。

```
 Date now = new Date();
        //Set date format as you want
        SimpleDateFormat sf = new SimpleDateFormat("dd-MM-yy"); 
        this.DateObject.setText(sf.format(now)); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T13:34:28.530

您可能需要对其进行`toString`操作

```
this.DateObject.setText(date.toString()); 
```

# oracle - JPQL for Oracle 中的时间比较

> ID：14082172
> 
> 赞同：0
> 
> 时间：2012-12-29T13:32:48.483
> 
> 标签：oracle, jpa

我想用 JPQL 从 DB 中选择最后 15 分钟的记录，我的命名查询是

```
@NamedQuery(
  name="Request.Select", 
  query="SELECT b FROM EVCRequest b  WHERE b.timein > :timein") 
```

我查询如下

```
Query query = em.createNamedQuery("Request.Select");
query.setParameter("timein", new Timestamp(System.currentTimeMillis() - 900000)); 
```

但它没有提供预期的结果

在数据库中的日期格式是

```
"dd-MMM-yy hh:mm:ss aa" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T10:49:15.923

我通过应用如下本机查询解决了问题

SELECT * FROM EVCRequest b WHERE b.timein > sysdate-15/1440

问候，

# html - 占位符 CSS 调用问题

> ID：14082173
> 
> 赞同：4
> 
> 时间：2012-12-29T13:32:49.303
> 
> 标签：html, css, css-selectors

通常我们使用这个想法（不同的类用逗号分隔）**.Test, .test1 {}**，但这里只有我们单独调用类才能正常工作。

为什么这个问题？在这里演示 [http://jsfiddle.net/6AR8n/](http://jsfiddle.net/6AR8n/)

```
/* seperate classes  */

#red input:-moz-placeholder{
    color:red;
}
#red input::-webkit-input-placeholder{
    color:red;
}

/* Classes with coma */

#green input:-moz-placeholder, input::-webkit-input-placeholder{
    color:green;
}

<div id="red">
    <input type="text"  placeholder="Without Coma" >
</div>
<br>
 <div id="green">
    <input type="text"  placeholder="Coma" >
</div> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-29T13:52:56.193

这是因为浏览器在遇到无法识别的选择器时应该丢弃整个规则。来自[CSS2.1 规范](http://www.w3.org/TR/CSS21/syndata.html#rule-sets)：

> 选择器总是与声明块一起使用。当用户代理无法解析选择器（即，它不是有效的 CSS 2.1）时，它也必须[忽略](http://www.w3.org/TR/CSS21/syndata.html#ignore)选择器和以下声明块（如果有）。

这包括带前缀的选择器，例如`:-moz-placeholder`和`::-webkit-input-placeholder`在您的示例中，因为浏览器不应该尝试解析它不支持的前缀；对于某个解析器，外来前缀与任何其他语法错误一样无效。

此外，正如评论中提到的，该`#green`部分需要在逗号分隔组中的两个选择器上复制，如下所示：

```
#green input:-moz-placeholder, #green input::-webkit-input-placeholder{
    color:green;
} 
```

但这与手头的问题完全无关。

# android - NFC 对等模式 - Android Beam - ISO 18092

> ID：14082178
> 
> 赞同：5
> 
> 时间：2012-12-29T13:34:17.220
> 
> 标签：android, nfc, nfc-p2p, android-beam

我需要了解如何在 Android Beam 中管理 P2P 模式。

我发现了一些关于 P2P 的一般信息：

有一种主动 P2P 模式（NFC 论坛不推荐）和一种被动模式（NFC 论坛推荐），其中无源设备像智能卡一样工作（卡模拟模式）。

我也知道 NFC 阅读器设备通常执行以下步骤：

1.  场上

2.  检查卡或 P2P 无源设备

3.  如果找到则与设备通信，如果没有则关闭

4.  场外

5.  至少检查大约 500ms-1s 的外部场

6.  如果检测到外部场作为卡或 P2P 被动目标。接收命令并作为目标执行事务

7.  等到没有检测到更多字段

8.  转到 1

现在我的问题是，在 Android Beam 中，将 2 部手机放在一起会发生什么？

1.  我认为他们都创建了用于扫描的字段，并且他们都通过显示 Android Beam 界面（带有发送信息的较小窗口）来识别它们
2.  然后，用户在屏幕上打字，得到发起者，而另一个进入被动接收者。
3.  它们通过 P2P 被动配对并通过 LLCP 更改信息
4.  回调被发送到发起者和结束。

我不知道这是否正确，有人有这方面的信息吗？

当 2 个智能手机/设备放在一起时，Android Beam 会发生什么，它们处于哪种模式，当主动/被动时谁获得以及使用哪种模式（P2P 主动或被动）？

在 LLCP 中没有主/从，所以两者都是主从，这到底是什么意思？

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-28T15:42:00.060

据我记得是这样的：

1.  The initiator initiates the transmission, i.e., it is the one that begins the communication - comparable with *first come first serve* - independent of the direction of the data flow.

2.  In a second step, the initiator dictates the kind of transmission mode, i.e., passive or active in peer-to-peer mode, or RFID mode (reader/writer mode). The chosen mode depends what kind of modes the initiator and/or the target supports. The passive mode is used when the initiator has enough power to drive both devices (itself and target). Whereas the active mode can be used if power should be shared among initiator and target device.

3.  When two NFC devices are put together, the device which wants to communicate first, will be the initiator. Therefore, passive devices like tags are always targets. However, there is no peer-to-peer mode between NFC devices and RFID tags.

4.  LLCP is just a top level protocol to transmit data in either way. Therefore, the initiator asks the target to transmit or receive data. The good thing about the NFC peer-to-peer mode is, that the NFC devices can swap its roles after each successful communication.

# bluetooth - 将音频发送到支持蓝牙的扬声器，IOS

> ID：14082182
> 
> 赞同：2
> 
> 时间：2012-12-29T13:34:40.200
> 
> 标签：bluetooth, core-audio, speaker, a2dp

我想在我的应用程序中添加一个功能，用户可以在其中选择在启用蓝牙的扬声器上播放音频。我的车里有一个 Parrot Easydrive，它适用于电话，例如 Dictafoon 应用程序等。

我知道我应该使用 Core Audio 框架。当连接蓝牙设备时，据说很容易将音频流式传输到该连接。我现在正在寻找 Core Audio 示例代码（或一本书），其中解释了使用 Core Audio 连接和流式传输到蓝牙设备。

任何人都可以对此有所了解吗？如果有其他我可以使用的框架或示例代码，请提及！

提前谢谢了！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-03T05:03:19.287

您无需编写任何特定的 Core Audio 代码，它与通过 AirPlay 播放音频的过程相同。

基本上，您将[MPVolumeView](http://developer.apple.com/library/ios/#documentation/mediaplayer/reference/MPVolumeView_Class/Reference/Reference.html)放入您的 UI，底层框架将为您重定向音频输出。实现此功能后，您将能够在您的应用程序中使用蓝牙和任何支持 AirPlay 的设备。

# php - 从 PHP 向 Arduino 驱动的热敏打印机发送二进制命令

> ID：14082184
> 
> 赞同：5
> 
> 时间：2012-12-29T13:34:51.933
> 
> 标签：php, arduino

我在玩 Arduino（Uno rev 3）和热敏打印机（此型号[https://www.sparkfun.com/products/10438](https://www.sparkfun.com/products/10438)）时玩得很开心。Arduino 每 10 秒向我的本地机器（通过以太网屏蔽）发出一个请求，并将响应（如果 200）存储在 SD 卡上。[然后它使用这个库https://github.com/adafruit/Adafruit-Thermal-Printer-Library](https://github.com/adafruit/Adafruit-Thermal-Printer-Library)打印出来。

到目前为止，我已经正确地轮询、存储和打印基本文本，但现在我正在尝试使用一些更高级的命令（下划线、反向等）。我的最终目标是发送图像并在服务器 ala [http://printer.gofreerange.com/](http://printer.gofreerange.com/)上处理所有渲染。

问题是我发送的命令被输出为文本字符。一些命令有效（换行），但其他命令是乱码。我已经附上了 Arduino 代码和它调用的基本 PHP 脚本。有什么帮助吗？

阿杜诺：

```
#include <SPI.h>
#include <Ethernet.h>
#include <SD.h>
#include <SoftwareSerial.h>
#include "Adafruit_Thermal.h"

byte mac[] = { 0xDE, 0xAD, 0xBE, 0xEF, 0xFE, 0xED };
const char host[] = "192.168.1.100";
char cacheFilename[] = "TMP";

const byte printer_RX_Pin = 8; // this is the green wire
const byte printer_TX_Pin = 9; // this is the yellow wire
const byte SD_Pin = 4;         // the SD Card SPI pin

bool downloadWaiting = false;
bool statusOk = false;
unsigned long content_length = 0;

EthernetClient client;
Adafruit_Thermal printer(printer_RX_Pin, printer_TX_Pin);

void die(unsigned int times) {
  while(true);
}

void checkForDownload() {

  Serial.println("checkForDownload");

  content_length = 0;
  statusOk = false;
  unsigned long length = 0;

  if (SD.exists(cacheFilename)) {
    if (!SD.remove(cacheFilename)) {
      die(4);
    }
  }
  File cache = SD.open(cacheFilename, FILE_WRITE);

  if(client.connect(host, 80)) {

    client.println("GET /printer.php HTTP/1.1");
    client.print("Host: "); client.println(host);
    client.println("User-Agent: arduino-ethernet");
    client.println("Connection: close");
    client.println();

    bool parsingHeader = true;

    while(client.connected()) {
      while(client.available()) {

        if (parsingHeader) {

          client.find((char*)"HTTP/1.1 ");
          char statusCode[] = "000";
          client.readBytes(statusCode, 3);
          statusOk = (strcmp(statusCode, "200") == 0);

          client.find((char*)"Content-Length: ");
          char c;
          while (isdigit(c = client.read())) {
            content_length = (content_length * 10) + (c - '0');
          }

          client.find((char*)"\n\r\n");
          parsingHeader = false;

        } else {
          if(length < content_length) {
            cache.write((byte)client.read());
            length++;
          } else {
              client.read();
          }
        }

      }
    }

    client.stop();
    cache.seek(0);

    if (statusOk && content_length > 0 && (content_length == length) && (content_length == cache.size())) {
      downloadWaiting = true;
    }

  } else {
    client.stop();
  }

  cache.close();

}

void printFromDownload() {

  Serial.println("printFromDownload");

  File cache = SD.open(cacheFilename);
  byte b;

  while (content_length--) {
    printer.write((byte)cache.read());
  }

  printer.feed();

  cache.close();
  downloadWaiting = false;

}

void setup(){

  pinMode(SD_Pin, OUTPUT);
  if (!SD.begin(SD_Pin)) {
    die(2);
  }

  if (Ethernet.begin(mac) == 0) {
    die(3);
  }

  Serial.begin(9600);
  printer.begin(255);

  delay(1000);

}

void loop() {
  if (downloadWaiting) {
    printFromDownload();
    delay(5000);
  } else {
    checkForDownload();
    if (!downloadWaiting) {
      delay(10000);
    }
  }
} 
```

PHP：

```
<?php

ob_start();

// Turn on Inverse mode
// Doesn't work
echo pack('S', 29);
echo pack('S', 66);
echo pack('S', 1);

$string = 'Testing 1, 2, 3';

foreach(str_split($string) as $char) {
  echo pack('S', ord($char)); // works
}

// Turn off Inverse mode
echo pack('S', 29);
echo pack('S', 66);
echo pack('S', 0);

// Line feed
echo pack('S', 10); // works

$content = ob_get_clean();
$length = strlen($content);
header("Content-Length: $length");

echo $content; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-12T23:32:52.343

看来不能直接用printer.write() 打印位图数据。如您在 printBitmap() 方法中所见，打印机需要一些特殊字节来打开位图打印模式。(writeBytes(18, 42, chunkHeight, rowBytesClipped))

```
void Adafruit_Thermal::printBitmap(
 int w, int h, const uint8_t *bitmap, bool fromProgMem) {
  int rowBytes, rowBytesClipped, rowStart, chunkHeight, x, y, i;

  rowBytes        = (w + 7) / 8; // Round up to next byte boundary
  rowBytesClipped = (rowBytes >= 48) ? 48 : rowBytes; // 384 pixels max width

  for(i=rowStart=0; rowStart < h; rowStart += 255) {
    // Issue up to 255 rows at a time:
    chunkHeight = h - rowStart;
    if(chunkHeight > 255) chunkHeight = 255;

    writeBytes(18, 42, chunkHeight, rowBytesClipped);

    for(y=0; y < chunkHeight; y++) {
      for(x=0; x < rowBytesClipped; x++, i++) {
        PRINTER_PRINT(fromProgMem ? pgm_read_byte(bitmap + i) : *(bitmap+i));
      }
      i += rowBytes - rowBytesClipped;
    }
    timeoutSet(chunkHeight * dotPrintTime);
  }
  prevByte = '\n';
} 
```

您的草图需要了解来自 PHP 的数据，并知道何时使用printer.write() 将单个字符作为字节发送，何时使用printer.printBitmap() 将字节作为图像发送。通过这种方式，打印机正在接收正确的命令来准备打印相应的数据。您需要围绕要在 PHP 中打印的内容构建一些元数据并将其发送到 Arduino。JSON 格式可能如下所示：

```
{"reciept": [
  {
    "type": "text",
    "style": "bold",
    "value": "Thank you for your purchase"
  },
  {
    "type": "bitmap",
    "pos": "center",
    "value": ".... binary data ..."
  }
]} 
```

现在您的 Arduino 草图将了解何时以文本形式单独发送字节以及何时以位图形式发送大量数据。

更紧凑的格式可能会使用换行符作为段之间的中断：

```
F|bold
T|Thank you for shopping with us\r
P|Center
B|...binary data (with \r escaped)... \r 
```

或者，您可以发送每个段的数据量，以避免转义二进制数据，就像 HTTP 的 Content-Length 标头一样

```
F4|boldT32|Thank you for shopping with us\rP6|CenterB3000|...binary data... 
```

# objective-c - NSManagedObjectContext 在 Core Data 应用程序 (iOS) 中返回 nil

> ID：14082185
> 
> 赞同：1
> 
> 时间：2012-12-29T13:34:55.233
> 
> 标签：objective-c, ios, core-data, nsmanagedobject, nsmanagedobjectcontext

每次按下按钮时，我都会尝试将字符串保存到数据库中，但是当我运行项目时，我会在控制台上得到它`'NSInvalidArgumentException', reason: '+entityForName: nil is not a legal NSManagedObjectContext parameter searching for entity name 'Info''`：

参考数据模型，我创建了一个 .xcdatamodeld，其中包含一个名为“Info”的实体，并在其中创建了一个名为“path”的属性，其类型为字符串。

我创建了三个函数。"enterdata" 通过调用 "findData" 检查名称是否可用。如果该名称可用，则通过“newData”记录一个新数据，如果没有，则查找不同的名称。

我一直在寻找一些类似的问题，我发现了[这个](https://stackoverflow.com/questions/11596487/entityforname-nil-is-not-a-legal-nsmanagedobjectcontext-parameter-core-data/11596607#11596607)。它说必须将 de ManagedObjectContext 传递给 View Controller，但我不明白这是什么意思。

这是我的 .h 代码：

```
@property (readonly, strong, nonatomic) NSManagedObjectContext *managedObjectContext; 
```

这是我的 .m 代码：

```
#import <CoreData/CoreData.h>

@synthesize managedObjectContext;

int  iSavedNum = 1;
bool bCanSave;

//Enter data
- (IBAction) enterdata:(id)sender {

    //Search if data is already registered
    NSString *docDir = [NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES) objectAtIndex:0];
    NSString *path = [NSString stringWithFormat:@"%@/info%i.png",docDir, iSavedNum];
    [self findData:path :@"path"];

    //If data is already saved, save it with new name.
    if (bCanSave == NO) {
        for (iSavedNum = 1; bCanSave == YES; iSavedNum++) {
            [self findData:path :@"path"];
            if (bCanSave == YES) {
                [self newData:path :@"path"];
            }
        }
    } else {
        [self newData:path :@"path"];
    }

}

//Input new data
- (void) newData:(NSString *)value:(NSString *)key {

    //Create ManagedObjectContext and ManagedObjectModel
    __0AppDelegate *appDelegate = (__0AppDelegate *)[[UIApplication sharedApplication] delegate];
    NSManagedObjectContext *context = [appDelegate managedObjectContext];
    NSManagedObjectModel *newRecord;

    //Put the data to the Entity
    NSString *entityName = @"Info";
    newRecord = [NSEntityDescription insertNewObjectForEntityForName:entityName inManagedObjectContext:context];
    [newRecord setValue:value forKey:key];

    //Errors management and cheking
    NSError *error;
    [context save:&error];
    NSLog(@"Info Saved. Value: %@ Key: %@", value, key);

}

//Find Data
- (void) findData:(NSString *)valor:(NSString *)key {

    //Create ManagedObjectContext
    __0AppDelegate *appDelegate = (__0AppDelegate *)[[UIApplication sharedApplication] delegate];
    NSManagedObjectContext *context = [appDelegate managedObjectContext];

    //Call the Entity and make a request
    NSString *entityName = @"Info";
    NSEntityDescription *entityDesc = [NSEntityDescription entityForName:entityName inManagedObjectContext:context];
    NSFetchRequest *request = [[NSFetchRequest alloc] init];
    [request setEntity:entityDesc];

    //Create predicate to call specific info
    NSPredicate *pred = [NSPredicate predicateWithFormat:@"(%@ = %@)", key, valor];
    [request setPredicate:pred];

    //Errors management and creation of an array with found info
    NSError *error;
    NSArray *objects = [context executeFetchRequest:request error:&error];

    //Set if the name is avaliable or not
    if ([objects count] == 0) {
        bCanSave = YES;
    } else {
        bCanSave = NO;
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T13:43:01.923

它准确地告诉您错误是什么：

> nil 不是合法的 NSManagedObjectContext 参数

这意味着在这条线上：

```
newRecord = [NSEntityDescription insertNewObjectForEntityForName:entityName
                                          inManagedObjectContext:context]; 
```

变量`context`是`nil`。这意味着您的`managedObjectContext`方法无法正常工作。您没有显示此内容，因此我们无法添加更多内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-19T07:28:01.083

在`application:didFinishLaunchingWithOptions:`中`appDelegate`

```
/*initiate the managed Object Context */  
CoreDataManager *coreDataManager = [CoreDataManager sharedDataManager];
    coreDataManager.managedObjectContext = self.managedObjectContext; 
```

`CoreDataManager`我的核心日期管理器 在哪里，它明确包含所有核心数据保存、删除方法

或者

```
yourClassObject.managedObjectContext = self.managedObjectContext; 
```

所以上下文被初始化

# artificial-intelligence - 信号分类 - 使用 AI 识别信号

> ID：14082188
> 
> 赞同：1
> 
> 时间：2012-12-29T13:35:39.337
> 
> 标签：artificial-intelligence, signal-processing, neural-network

我在识别信号时遇到问题。假设信号是准周期信号，周期时间有有限的限制。信号的“形状”必须符合某些标准，因此实际算法使用信号处理技术，如滤波、推导信号、寻找最大值和最小值。它在找到良好信号方面的速度很高，但问题是它也检测到错误的形状。

所以我想使用人工智能——主要是神经网络——来克服这个问题。我认为具有一些平均输入（可以减少信号）和一个输出的多层网络应该显示从 0..1 开始的“匹配”。但是问题是我从来没有做过这样的事情，所以我在寻求帮助，如何实现这样的事情？如何教神经网络得到预期的结果？（假设我有输入向量，应该给出 1 作为输出）

或者这整个想法是对问题的错误近似？我愿意接受任何学习算法或想法来学习和使用来克服这个问题。

所以这里有一个关于测量信号的图（现在不关心值和时间），你可以看到很多“错误”的信号，如上所述，检测到的最多的信号是好的。 ![在此处输入图像描述](../Images/85da3e4ae4705b98f362a2e53ad42bca.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T21:32:49.677

您可以尝试使用[Neuroph](http://neuroph.sourceforge.net/)构建神经网络。[您可以从“http://neuroph.sourceforge.net/TimeSeriesPredictionTutorial.html”](http://neuroph.sourceforge.net/TimeSeriesPredictionTutorial.html)中获得启发。另一方面，可以使用傅里叶变换来近似信号。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-03T03:05:21.577

您的问题可以得到广泛的回答。您应该考虑对其进行编辑以防止它被关闭。

但不管怎样，[Matlab](http://www.mathworks.com/products/matlab/)内置了很多支持人工智能的函数和工具箱，有很多示例代码可供您修改和参考。[您可以在Matlab FileExchange](http://www.mathworks.com/matlabcentral/fileexchange/index?utf8=%E2%9C%93&term=fast%20convolution%20signal%20processing)中找到一些。

而且我知道阅读大量人工智能技术论文是一项艰巨的任务，祝你好运！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-02-27T00:57:42.653

您可以尝试一维卷积。所以基本的想法是你给每个时间戳的每个信号值一个标签 0：坏，1：好。在此之后，您可以建模

```
model = Sequential()
model.add(Conv1D(filters=64, kernel_size=3, activation='relu', padding = 'same', input_shape=(1,1)))
model.add(Bidirectional(LSTM(20, return_sequences=True)))
model.add(Conv1D(filters=64, kernel_size=3, activation='relu', padding = 'same'))
model.add(Dropout(0.5))
model.add(Flatten())
model.add(Dense(100, activation='sigmoid'))
model.add(Dense(2, activation='softmax'))

model.compile(loss='binary_crossentropy', optimizer='adam', metrics=['accuracy']) 
```

训练模型，然后给它一个新的信号来预测。它会将给定的系列预测为 0 和 1 值。如果 0 的计数大于 1 的计数，则信号不好。

# asp.net - 如何在客户端电脑上查看互联网并使用 C# 在 asp.net 中向他提供天气预报？

> ID：14082194
> 
> 赞同：0
> 
> 时间：2012-12-29T13:36:19.153
> 
> 标签：asp.net

我在 windows xp 上的 IIS 上有一个网站。我正在显示我的局域网用户的实时天气报告，但我的一些局域网用户无法访问互联网，但他们可以访问我在局域网上的网站。

我如何检查互联网在客户端 PC 上不起作用并向他显示消息，或者我应该如何管理即使 LAN 用户也可以访问的天气报告？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T13:46:22.233

您将必须通过 Javascript 检查互联网访问，您无法从服务器端进行检查，并且您可能不想检查互联网访问本身，但要访问您从中获取天气报告的网站（如果该网站被阻止通过防火墙规则，则无法显示结果）。

您可以通过[ping 网站](https://stackoverflow.com/questions/4282151/is-it-possible-to-ping-a-server-from-javascript)来做到这一点，然后使用该 Javascript ping 的结果来显示两个 div 之一 - 天气预报或“抱歉，您无法访问天气服务”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T13:46:34.160

使用 ASP.NET 客户端回调，我们可以检查互联网连接。从客户端尝试下载一个简单的网页。如果页面下载成功，则用户已连接到互联网，否则他未连接。您的虚拟页面（您要下载的页面）应该非常小才能获得良好的性能。

在此处查看示例代码

[http://highoncoding.com/Articles/316_Find_User_s_Internet_Connectivity_Using_ASP_NET_2_0_Client_Callback.aspx](http://highoncoding.com/Articles/316_Find_User_s_Internet_Connectivity_Using_ASP_NET_2_0_Client_Callback.aspx)

# internationalization - 维护 Chrome 扩展程序的翻译

> ID：14082199
> 
> 赞同：3
> 
> 时间：2012-12-29T13:37:16.843
> 
> 标签：internationalization, google-chrome-extension

我正在考虑使用[此处](https://developer.chrome.com/extensions/i18n.html)描述的 Chrome 扩展的国际化支持。

进行翻译的建议方法是首先创建英语 messages.json 文件，然后将其复制并翻译成给定的语言。

我的问题是这适用于初始翻译，但是当已经有一些翻译并且扩展中发生了一些更改时，我看不到更新翻译的简单方法。

我想我需要工具来完成这些任务：

*   检测新的未翻译字符串
*   检测以英语更改的字符串，这些字符串可能也需要在其他语言中进行修改
*   检测不再使用的字符串

我想通过保留原始的英文 messages.json 文件并使用差异工具，我可以手动完成，但我想知道是否有任何工具可以帮助解决这个问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T15:48:09.673

您可以尝试[https://webtranslateit.com/](https://webtranslateit.com/)。我们正在使用它。

# android - 如何在 android 上接听拨出电话并将您包括在默认应用程序列表中

> ID：14082205
> 
> 赞同：2
> 
> 时间：2012-12-29T13:37:59.543
> 
> 标签：android

当用户开始拨打电话时，android 会提出选择，可以使用哪个应用程序拨打电话（如 Skype）。简单的问题 - 我的应用程序如何在该列表中以及我如何获取号码，哪个用户被放入系统拨号器？

我做了一个所有问题，这在两个答案中都有建议，但是，如果客户在电话拨号盘上按下呼叫，我仍然看到：

拨打电话： - Skype - 电话

并且列表中没有我的应用程序。

**已编辑**

现在该代码的问题已解决，现在我的应用程序在列表中并打开了：（错误>符号）

```
 <activity
        android:name=".PhonePadActivity"
        android:label="@string/app_name"
        android:screenOrientation="portrait"
        android:theme="@android:style/Theme.Black.NoTitleBar.Fullscreen" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />
            <category android:name="android.intent.category.LAUNCHER" />

            <action android:name="android.intent.action.CALL" />
            <data android:scheme="tel" />
            <category android:name="android.intent.category.DEFAULT" />
            <action android:name="android.intent.action.CALL_PRIVILEGED" />
       </intent-filter>

    </activity> 
```

问题的第二部分 - 获取用户在标准拨号盘中拨打的电话号码，但仍未解决：

onCreated 中的代码：

```
Intent intent = getIntent();

String number = intent.getStringExtra(Intent.EXTRA_PHONE_NUMBER);
Toast.makeText(this, "Call was made to-->>" + number, 5000).show(); 
```

给出空值。

**第二版**

上次我收到来自 Google 的通知，他们限制 CALL_PRIVILEGED（bcs 我们不支持他们的紧急呼叫。）如果没有 CALL_PRIVILEGED，我的应用程序不会再次出现在列表中。有人知道那件事的新解决方案吗？我现在正在与谷歌支持讨论这个问题，我们现在进行了一些迭代但没有成功。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T13:45:26.650

将您的 Activity 声明为将其添加到调用应用程序的选项列表中

```
<activity android:name="Makecall" >
        <intent-filter> 

            <action android:name="android.intent.action.CALL" />
           <data android:scheme="tel" />
           <category android:name="android.intent.category.DEFAULT" />
           <action android:name="android.intent.action.CALL_PRIVILEGED" />

        </intent-filter>
    </activity> 
```

并调用任何号码`Intent.ACTION_DIAL`用作：

```
Uri numberuri = Uri.parse("tel:"  + edit_text_number);
Intent intent_call = new Intent(Intent.ACTION_DIAL, numberuri);
startActivity(intent_call); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T13:43:18.207

您需要做的是在要拨打电话的 Activity 上设置 Intent 过滤器。您可以在 AndroidManifest.xml 文件中执行此操作。修改您的活动定义以包含此意图过滤器：

```
<intent-filter>
    <action android:name="android.intent.action.CALL" />
    <category android:name="android.intent.category.DEFAULT" />
    <data android:scheme="tel" />
</intent-filter> 
```

要获取正在拨打电话的电话号码，请在广播接收器中使用以下方法，

```
public void onReceive(Context context, Intent intent) 
    {
        String number = intent.getStringExtra(Intent.EXTRA_PHONE_NUMBER);
        Toast.makeText(context, "Call was made to-->>" + number, 5000).show();

    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-30T06:08:51.867

要回答问题的第二部分，即如何从意图对象中提取电话号码，您可以调用：

```
String schemeSpecificPart = intent.getData().getSchemeSpecificPart(); 
```

如果您想将其解析为结构化对象，可以使用 Google 的 libphonenumber 库：[https ://code.google.com/p/libphonenumber/](https://code.google.com/p/libphonenumber/)

例如

```
PhoneNumberUtil phoneUtil = PhoneNumberUtil.getInstance();
TelephonyManager manager = (TelephonyManager)getSystemService(Context.TELEPHONY_SERVICE);
Phonenumber.PhoneNumber number;
try {
     number = phoneUtil.parse(schemeSpecificPart, deviceCountry);
} catch (NumberParseException e) {
     // handle the exception
} 
```

# iphone - 在 ARC 模式下返回 UITextField 对象是否有问题？

> ID：14082206
> 
> 赞同：1
> 
> 时间：2012-12-29T13:38:07.120
> 
> 标签：iphone, memory, automatic-ref-counting, memory-leaks

我在 xcode 中使用 ARC 并编写这样的便捷方法：

```
 +(UITextField *) addTextField:(NSString *)text x:(int)_x y:(int)_y width:(int)_width height:(int)_height {
       UITextField *v_txt = [[UITextField alloc] init];
       v_txt.frame= CGRectMake(_x, _y, _width, _height);
       v_txt.borderStyle = UITextBorderStyleRoundedRect;
       return v_txt;
} 
```

许多视图控制器调用这个类方法来返回`UITextField`我的应用程序中自动释放的对象。这里有一些内存泄漏吗？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T13:43:05.623

不，在 ARC 下的便捷方法中没有内存泄漏：编译器足够聪明，可以`v_txt`在最后一个强引用消失时释放它，如果有必要，在幕后使用自动释放。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T13:43:46.617

它将处理`v_txt` 为`autorelease`. 因此，您的代码中没有内存泄漏。

并且只是为了您的指导，请尝试**遵循变量命名约定**。

正如我们大多数人会觉得 _x、_y、_width 和 _height 是当前/自我类的属性，但在您的情况下，它是方法的参数。

# php - 在 wordpress 插件中定义动态页面

> ID：14082207
> 
> 赞同：4
> 
> 时间：2012-12-29T13:38:17.580
> 
> 标签：php, wordpress, php-5.2

我正在创建我的第一个 wordpress 插件。在其中，用户可以选择添加新城市并查看这些城市的事件。

我的客户要求是 URL 必须是这样的

```
SITE_NAME/cities/NY 
```

或者

```
SITE_NAME/cities/Califonia 
```

决定的是我将创建一个文件夹城市，如果用户尝试创建一个新城市，我将在该文件夹中创建一个包含该城市的文件，此外，我还将将该条目添加到数据库中。我将插入 PHP 代码也进入文件。

是 WP 插件的新手。我的方法是否正确（用于创建文件）？还有其他方法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-03T06:03:55.413

如果您不使用 Wordpress，您的方法会起作用，但我绝对不建议您在 Wordpress 框架中执行您的建议。

与其尝试重新发明轮子，不如使用现有的插件来实现您想要的一切。我绝对建议您走这条路，特别是如果您对 Wordpress 插件编程没有太多经验。

## 步骤1：

### 安装[WordPress](http://wordpress.org/download/)

不言自明。没有这个就什么都做不了。

## 第2步：

### 安装[类型](http://wordpress.org/extend/plugins/types/)

安装[Types Plugin](http://wordpress.org/extend/plugins/types/)将为您提供一个很好的界面，用于注册您自己的[自定义帖子类型](http://codex.wordpress.org/Post_Types)和许多其他用于扩展 Wordpress 核心功能的功能。

## 第 3 步：

### 注册您的[自定义帖子类型](http://codex.wordpress.org/Post_Types)

这就是事情开始变得复杂的地方。使用类型，注册一个名为事件的自定义帖子类型。您希望将每个事件都作为自己的帖子的原因是因为每个事件都是独一无二的。城市旨在封装和定义事件组，这将我们带到了下一步：

## 第4步：

### 注册您的[自定义分类](http://codex.wordpress.org/Taxonomies)

将分类法​​视为对事物进行分类的一种方式。Wordpress 带有两个默认分类法：类别（分层）和标签（非分层）。在您的情况下，您需要为新的 Event Post Type 定义一个名为“Cities”的非分层分类法。

## 第 5 步：

### 注册您的[自定义字段](http://codex.wordpress.org/Custom_Fields)

自定义字段是简单的部分。什么定义了您的活动？也许某些字段定义了该特定事件的开始和结束时间？表示免费茶点的复选框？天空是极限。所有事件都具有哪些定义特征使其成为事件？以自定义字段的形式添加它们。这些将以元框的形式显示在您的事件编辑器上。如果您在编辑页面上没有看到特定事件的元框，请务必通过单击屏幕右上角的屏幕选项并勾选您的字段所在的复选框来启用它。

## 第 6 步：

### 配置您的[永久链接](http://codex.wordpress.org/Using_Permalinks)

其中大部分可以通过类型本身（在配置自定义分类法时）或通过 .htaccess 重写，甚至可能通过 Wordpress 永久链接设置（尽管它相当有限）来完成。我的建议是在弄乱 .htaccess 之前先调整您的自定义分类法和永久链接设置。

就是这样！希望这足以让您开始所需的一切。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-07T15:55:42.107

maiorano84 写了一个相当全面的指南来设置你需要的东西，而不是依赖插件，我更愿意向你展示如何编写一个插件来注册自定义帖子类型和分类。为此，我编写了一个小插件，它应该可以满足您的所有需求，并且它有大量的注释和文档链接，以便您了解事情的*原因*。

## 代码

### [https://github.com/fyaconiello/WP_Cities_Events](https://github.com/fyaconiello/WP_Cities_Events)

这个插件做了几件事

1.  创建自定义帖子类型事件
2.  创建自定义分类城市
3.  将自定义元框添加到事件
4.  将城市分类添加到事件

这个插件不需要安装任何额外的插件，它是无依赖的，只使用 WP 核心。

## 网址

至于获得正确的**URL Structure**，我建议您仔细阅读：[http](http://codex.wordpress.org/Using_Permalinks) ://codex.wordpress.org/Using_Permalinks 。

### 我不明白你想要的结构

```
CITY is a single term w/i the taxonomy *cities*
EVENT is the post single 
```

1.  `SITE_URL/cities/CITY`*将生成该CITY*中所有*EVENT*帖子的页面
**   您需要一个网址，例如：`SITE_URL/cities/CITY/EVENT`阅读特定城市中的特定事件*

 *## 编辑如何获取网址：

在您的`Settings -> Permalinks`管理面板中选择：“帖子名称”并保存。

![截屏](../Images/61807b1f286a89f3650e7fb4d276d276.png)

然后，转到您的 Ce`Events -> Cities`管理屏幕。

![截图 2](../Images/680e82c1dee26271b72a2ba2b6497614.png)

将鼠标悬停在您的一个条款上（在我的情况下是纽约市）并单击查看。

![截图 3](../Images/c712bebba668a3783609cdb83d54b9a6.png)

它应该打开该术语（城市）的列表视图，并且 url 结构如下所示：[http://wp.local/city/new-york-city/](http://wp.local/city/new-york-city/)

如果您需要`city`阅读`cities`，请修改我与您共享的主插件文件的第 102 行：

```
'rewrite' => array('slug' => 'city'), 
```

## 编辑 2

![测试活动不属于城市，它是按城市分类的帖子](../Images/e04d594d6504c18104b32de32feb499b.png)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-05T12:41:22.750

不要那样做。WordPress 为您提供了一个 goog API 来做您想做的事情：管理漂亮的 URL（slug）、数据库操作（您不需要为此编写/读取文件）以及用于注册和触发操作的正确代码工作流程。

因此，我认为您必须开始阅读有关[WordPress 插件](http://codex.wordpress.org/Plugin_API)的基础知识（其理念和 API），然后再决定是要使用其自定义帖子类型（即用型）还是要创建特定的内容类型。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-30T02:01:12.190

为什么不将 City 创建为[自定义帖子类型](http://codex.wordpress.org/Post_Types)？然后，您可以定义一个 slug 'cities' 并获得该结果，还可以添加类别和标签等分类法以进一步帮助导航。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-29T14:12:19.903

是的，这是很好的方法。您可以做的另一件事是，不要在文件中添加代码。从数据库中选择代码。在数据库中创建一个表，创建一个以varchar为数据类型的列，并在其中插入公共代码。*

# google-chrome-extension - 从 localStorage 迁移到 chrome.storage

> ID：14082214
> 
> 赞同：2
> 
> 时间：2012-12-29T13:39:43.143
> 
> 标签：google-chrome-extension, local-storage

我想使用 chrome.storage API 来保存我的用户的设置，而不是我的 Chrome 扩展程序中的 localStorage。

目前我的 options.js（带有 localStorage 和 JSON）文件如下所示：

```
$(function(){ //jQuery Ready

// INIT
$("#notifysav").hide();

// STORAGE
if(localStorage['options']){
    var o = JSON.parse(localStorage['options']);
    $("#option1").attr('checked', o.option1);
            $("#option2").attr('checked', o.option2);
    .... [list of options]
}

// Save Button Click event
 $("#save").live('click', function(){
    localStorage['options'] = JSON.stringify({
        "option1":$("#option1").attr('checked'),
        "option2":$("#option2").attr('checked'),
        .... [list of options]
    });
            // notification
    $("#notifysav").fadeIn("slow").delay(2000).fadeOut("slow");
            // reload to apply changes
    chrome.extension.sendRequest({action: 'reload'});
});

});// #jQuery ready 
```

我的问题是如何将我当前的代码转换为使用 chrome.storage API。据我了解，我将应用这些更改：

```
$(function(){

// INIT
var storage = chrome.storage.sync;
$("#notifysav").hide();

// Load Options
loadOptions();

// Save Button Click Event
$("#save").live('click',function(){ saveOptions(); });

function loadOptions() {
     storage.get(         /* Something */           )
}

 function saveOptions() {

 var option1 = $("#option1").attr('checked');
 var option2 = $("#option2").attr('checked');

  storage.set({"option1":option1,"option2":option2}, function() {
   // Notification
   $("#notifysav").fadeIn("slow").delay(2000).fadeOut("slow");
   // Reload Event to apply changes
   chrome.extension.sendRequest({action: 'reload'});
   });
     }
}); 
```

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T18:30:10.947

如果我理解正确，您的主要问题是如何从存储中检索数据。这是可以做的：

```
chrome.storage.local.get(null, function(all){console.log(all)}); 
```

将返回一个对象，其中包含存储在存储中的所有键和值，在您的情况下，它将输出：

```
Object {option1: "value1", option2: "value2"} 
```

您也可以只获得其中一个键：

```
chrome.storage.local.get("optionkey", function(all){console.log(all)}); 
```

或一组键：

```
chrome.storage.local.get(["opt1", "opt2"], function(all){console.log(all)}); 
```

在任何情况下，您都可以通过键名访问回调中的数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T18:45:13.943

感谢您的回复。我终于设法通过更改我的原始代码来获得一些工作，如下所示：

```
$(function(){

 // INIT
 const storage = chrome.storage.sync;
 var options = new Array(); 

 $("#notifysav").hide();

 loadOptions();

 // STORAGE

  // Save Button Click event
  $("#save").live('click', function(){ saveOptions(); });

function loadOptions() {
  storage.get('options', function(o) { 

     $("#option1").attr('checked', o.options[0]);
     $("#option2").attr('checked', o.options[1]);
     ...
    });
 }

function saveOptions() {
     options[0] = $("#option1").prop('checked');
     options[1] = $("#option2").prop('checked');
     ...

//console.log(options);

     storage.set({'options':options},function(){
       $("#notifysav").fadeIn("slow").delay(2000).fadeOut("slow");
       chrome.extension.sendRequest({action: 'reload'});
      });
    }

  }); 
```

# java - 最大公约数 - 前置条件和后置条件

> ID：14082216
> 
> 赞同：0
> 
> 时间：2012-12-29T13:40:08.583
> 
> 标签：java, uml, preconditions, post-conditions

下面提供了 gcd 方法的前置条件和后置条件。

```
pre: x > 0 & y > 0 
post: result > 0 &
      x mod result = 0 & y mod result = 0 &
      ∀t:Integer · t > 0 & x mod t = 0 & y mod t = 0 ⇒ result mod t = 0 
```

但是，我在遵循后置条件时遇到了麻烦......对我来说，它基本上说找到任何可以被两者整除的整数。它如何获得最大除数，实际条件是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T13:44:39.120

这保证了它`result`是所有公约数中最大的。

```
∀t:Integer·t>0 & x mod t=0 & y mod t = 0 ⇒ result mod t = 0 
```

它说 any`t`是`x`and`y`的公约数，也是 的除数`result`

编辑：你应该像这样阅读上面的行：

```
∀t:Integer·((t>0 & x mod t=0 & y mod t = 0) ⇒ result mod t = 0) 
```

# c - 条件变量 - 意外行为

> ID：14082218
> 
> 赞同：-1
> 
> 时间：2012-12-29T13:40:36.560
> 
> 标签：c, multithreading, pthreads, posix, condition-variable

我试图让我的程序做到这一点：

*   接受输入：`nrNodes` `NrWorkers`
*   3个线程（工作者）一次只能访问列表（读取），但只有1个可以写入。
*   当 5 个节点已完成（sqrt 值）时，它应该停止并让在链表中清除所有已完成节点的更清洁线程，而不是将访问权返回给剩余的有工作的线程

    Thread1: 获取 semaphoreSlot(); 工作; 如果条件完成发送信号；直到列表被解析；

    Thread2：等待信号；干净的; 返回对thread1的访问；

    清理后：遇到问题；停止，不退出；

代码 ：

```
#include <stdio.h>
#include <stdlib.h>
#include <pthread.h>
#include <unistd.h>
#include <math.h>
#include <semaphore.h>

#define doneLimit 5

struct dataBlock{
    struct node *root;
    int listSize;
    int forIndex;
};

struct node { // std linked list node
    int value;
    int worker;
    struct node *next;
};

int done = 0;

sem_t sem;

pthread_mutex_t mutp;   // mutex
pthread_cond_t  condvar;   //condvar

void *deleteDoneNodes(void *n){
    pthread_cond_wait( &condvar, &mutp );
    struct node *root = n;
    struct node *it = root;
    struct node *prev = NULL;

    printf("Cleaning 1's \n");   
        do{
            if(it->value == 1){
                struct node *next = it->next;
                if (prev != NULL) {
                    prev->next = next;
                }
                if (it == root) {
                    root = next;
                }
                free(it);
                it = next;
            }
            else {
                prev = it;
                it = it->next;
            }
        }while(it !=  NULL);
        done = 0;

    pthread_exit(NULL);
}

void * worker( void *data ){
    // get list
    int wFlag;
    struct dataBlock *inData = ( struct dataBlock * ) data;
    struct node *root = inData->root;
    int forIndex = inData->forIndex;
    free(data);

    // parse
    while(1){
        if( sem_wait( &sem )  != 0 ){
            printf( " > waiting...  \n" );
        }
        struct node *it = root;

        printf("    Thread >>>  %d  ---  %lu \n", forIndex, pthread_self() );
        do{
            wFlag = 0;
            pthread_mutex_lock( &mutp );
            if( forIndex == it->worker ){
                if( it->value > 2 ){

                    while( it->value != 1 ){
                        it->value = sqrt(it->value);
                        }
                        printf("! node done\n");
                    pthread_mutex_unlock( &mutp );
                    wFlag += 1;
                    done += 1;
                    if( done == doneLimit ){ // limit 5
                        pthread_cond_signal( &condvar );
                    }
                    break;
                }
            }
            else{
                printf("...parsed done node. \n");
            }
            it = it->next;
            pthread_mutex_unlock( &mutp );
        }while(it !=  NULL);

        sem_post(&sem); 
        sleep(1); // "create" concurrancy envi. 
        if ( wFlag == 0 ){
            break;
        }
    }
    pthread_exit(NULL);
}

int main( int argc, char *argv[] ){
    if ( argc != 3 ){
        printf( "Programm must be called with \n NR of elements and NR of workers! \n " );
        exit( 1 );
    }
    int i;
    struct node *root;
    struct node *iterator;  

//prepare list for task
    int listSize = atoi(argv[1]);
    int nrWorkers = atoi(argv[2]);
    root = malloc(sizeof( struct node) );

    root->value = rand() % 100;
    root->worker = 0;
    iterator = root;

    for( i=1; i<listSize; i++ ){
        iterator->next = malloc(sizeof(struct node));
        iterator = iterator->next;
        iterator->value = rand() % 100;
        iterator->worker = i % nrWorkers;
        printf("node #%d worker: %d  value: %d\n", i, iterator->worker,iterator->value);
    }
    iterator->next = NULL;
    printf("? List got populated\n");
// init semaphore > keeps max 3 threads working over the list

    if( sem_init(&sem,0,3) < 0){
      perror("semaphore initilization");
      exit(0);
    }

// Create all threads to parse the link list
    int ret;    
    pthread_mutex_init( &mutp,NULL );
    pthread_cond_init( &condvar, NULL );

    pthread_t w_thread;
    pthread_t* w_threads = malloc(nrWorkers * sizeof(w_thread));

    for( i=0; i < nrWorkers; i++ ){         
        struct dataBlock *data = malloc(sizeof(struct dataBlock));
        data->root = root;
        data->listSize = listSize;
        data->forIndex = i;
        ret = pthread_create ( &w_threads[i], NULL, worker, (void *) data );
        if( ret ) {
            perror("Worker creation fail \n");
            exit(2);    
        }   
    } 
// Create Cleaning thread
    pthread_t c_thread;
    ret = pthread_create(&c_thread, NULL, deleteDoneNodes, (void *) root);
    if ( ret ){
        printf("Cleaner cration fail \n");
    }

// Join threads
    for ( i = 0; i < nrWorkers; i++ ){
        pthread_join(w_threads[i],NULL);
    }

    iterator = root;
    for ( i = 0; i < listSize; i++){
        printf("val: %d  worker: %d _  \n", iterator->value, iterator->worker);
        iterator = iterator->next;
    }

    free( root );
    pthread_mutex_destroy( &mutp );
    pthread_cond_destroy( &condvar );
    sem_destroy( &sem );

    return 0;
} 
```

**PS**：它有效 ./s 1 1 ./s 1 4 ./s 4 4 ./s 4 1

调用清洁器后失败：当 x >= 5 时，它在 ./sxn 处失败

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T14:12:42.047

至少您没有正确处理条件变量和互斥锁的使用。

互斥锁应在`pthread_cond_wait()`调用后者之前由线程调用锁定。

逐字逐句`man pthread_cond_wait`：

> **pthread_cond_wait** 以原子方式解锁互斥锁（根据 pthread_unlock_mutex）并等待条件变量 cond 发出信号。线程执行被挂起并且在条件变量发出信号之前不会消耗任何 CPU 时间。调用线程必须在进入 pthread_cond_wait 时锁定互斥锁。在返回调用线程之前，pthread_cond_wait 重新获取互斥锁（根据 pthread_lock_mutex）。

此外，互斥锁在从调用返回后被锁定，`pthread_cond_wait()`并且必须在某个时候解锁。

# php - 动态更改文本输入值

> ID：14082219
> 
> 赞同：0
> 
> 时间：2012-12-29T13:41:02.877
> 
> 标签：php, javascript, jquery, input, replace

我的问题对你们来说可能很容易，但对我来说很难......

我有一个文本字段，我想在`<label id="some_id">`单击一次之间更改它的值。直到我现在描述的，我可以自己用 jQuery 来做，但这里是复杂的部分（显然对我来说）：

我有两个我想要的文本字段值，一旦单击它，它就会`<label>`切换到未显示的值，但是一旦我们**再次**单击它，它就会返回到文本字段包含的原始文本。

我必须将我的 jQuery/JS 保留在内部，因为我从数据库中获取了所需的值并且我不想制作我的`.js`文件`.php`。

这就是我得到的：

```
<label for="html" onclick="$('#html').val('<?php echo $image->convert('html_b', $image_data['image_link']); ?>')">HTML:</label>
<input type="text" id="html" value="<?php echo $image->convert('html_a', $image_data['image_link']); ?>" readonly /> 
```

它完成了我需要的第一部分，将字段的值更改为新值，但是一旦再次单击该按钮，我想要原始文本。

谢谢你。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-29T13:53:29.467

首先，不要使用内联 JavaScript。

您可以为此使用[`.toggle()`](http://api.jquery.com/toggle-event/)和`data-*`属性的组合。例如，`data-toggle`为要切换的值使用属性。

```
<label for="html" data-toggle="This is a placeholder">HTML:</label>
<input type="text" id="html" value="This is my real value" readonly>​ 
```

```
$("label[for][data-toggle]").each(function() {
    var $this = $(this);
    var $for = $("#" + $this.attr("for"));
    var originalValue;
    $this.toggle(function() {
        originalValue = $for.val();
        $for.val($this.data("toggle"));
    }, function() {
        $for.val(originalValue);
    });
});​ 
```

[**看这里。**](http://jsfiddle.net/PAkKS/)

## 更新#1

`for`我添加了属性的用法`<label>`。

## 更新#2

`.toggle()`如果由于弃用通知而不想使用。

```
$("label[for][data-toggle]").each(function() {
    /* cache */
    var $this = $(this);
    var $for = $("#" + $this.attr("for"));
    var originalValue = $for.val();
    /* state variable */
    var which = 0;
    $this.click(function() {
        $for.val(which ? originalValue : $this.data("toggle"));
        which = 1 - which;
    });
});​ 
```

[**请参阅此处的非`.toggle()`替代方案。**](http://jsfiddle.net/JNvcN/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-29T13:59:53.833

您可以将其当前值与可用的可能性进行比较。

```
<label id="toggle" for="stuff">I'm a label</label>
<input type="text" val="" name="stuff" id="stuff">​ 
```

```
var possibilities = ["foo", "bar"];

$('#toggle').click(function(){
    var old_val = $("#stuff").val(), new_val;
    if (old_val == possibilities[0])
        new_val = possibilities[1];
    else
        new_val = possibilities[0];

    $("#stuff").val(new_val);

});​ 
```

### [演示](http://jsfiddle.net/BXKBY/)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-12-29T13:45:44.293

为此，在第一次单击按钮时，您需要将输入的当前值存储在某个变量中，然后在第二次单击时，您可以将该变量分配给输入值。如果你不想有js文件，你可以简单地使用`<script></script>`标签来编写jquery。

```
 `<label id="label" onclick="replaceText('newvalue')">Click Mee</label>
<input id="html" type="text" value="some value">

    <script>
        var currentValue="";
   function replaceText(newval){
       currentValue= $("#html").val();
        if(currentValue!=newval)
        $("#html").val(newval);
   $("#label").attr("onclick","replaceText('"+currentValue+"')");// Here we assigned the other value to label onclick function so that it will keep on toggling the content.
   }
    </script>` 
```

[在这里演示](http://jsfiddle.net/jPTzJ/1/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-29T13:47:15.403

您可以将值存储到 JavaScript 变量中，并使用 jQuery`click`方法而不是`onclick`属性。

```
var def = "<?php echo $image->convert('html_a', $image_data['image_link']); ?>",
    up = "<?php echo $image->convert('html_b', $image_data['image_link']); ?>";

$('label[for=html]').click(function() {
    $('#html').val(function(i, currentValue) {
        return currentValue === def ? up : def;
    });
}); 
```

# mysql - mysqli 是 symfony 控制器中的未知类

> ID：14082229
> 
> 赞同：1
> 
> 时间：2012-12-29T13:42:23.450
> 
> 标签：mysql, symfony

我决定工作`Symfony`三周，实现一个要测试的小项目。在控制器内部，我使用 MySQL 本机没有问题。现在我想更改为 MySQLi 并且没有任何运行。

通过以下方式连接到数据库：

```
$mysqliName = new mysqli('localhost', 'user', 'psasswd,', 'database'); 
```

失败：

```
"Class 'blabla\HaloBundle\Controller\mysqli' not found in /Applications/MAM.../HaloController.php" 
```

我可以在 Symfony 之外的“正常”php 中运行 MySQL，而不会出现问题。我必须做什么才能在控制器中使用 MySQLi 类？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T07:29:23.683

使用 \mysqli 作为全局命名空间，它可以工作。

# blackberry - vmplayer 上的黑莓 7

> ID：14082235
> 
> 赞同：-1
> 
> 时间：2012-12-29T13:43:20.393
> 
> 标签：blackberry, blackberry-simulator, vmware-workstation

下载 blackberry 7 以安装在 VMplayer 中的 URL。

我需要在 Blackberry 7 中测试我们的 SenchTouch 应用程序。在模拟器 senchtouch 不工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T14:56:09.730

没有可以在 VMWare 下运行的 BlackBerry OS 7 版本。您的选择是与 JDE 和 Plugin for Eclipse 捆绑在一起的模拟器（也可以作为不同版本的独立下载）；或实际设备。

# objective-c - 如何重用 UIView 和方法 - iOS 中的 DRY 代码

> ID：14082240
> 
> 赞同：2
> 
> 时间：2012-12-29T13:43:52.063
> 
> 标签：objective-c, ios, design-patterns, dry, code-reuse

我有 2 种方法可以在 iOS 键盘上方添加上一个、下一个和完成的工具栏并处理这些操作。我正在寻找一种方法来对这些方法进行一次编码并在多个 UITableViewControllers 中重用它。（干码）

我发现自己将这些方法复制并粘贴到每个 UITableViewController 中。如果我做了一个小改动，我必须在各处复制并粘贴该更改。下面的代码只是一个例子，我似乎在我的代码中重复了很多次。

这是我想重用的代码示例：

```
- (void) createInputAccessoryView
{
    _inputAccView = [[UIView alloc] initWithFrame:CGRectMake(10,0,310,42)];

    UIToolbar *keyboardToolbar = [[UIToolbar alloc] init];
    keyboardToolbar.barStyle = UIBarStyleBlackTranslucent;
    [keyboardToolbar sizeToFit];

    _segmentedControl = [[UISegmentedControl alloc] initWithItems:[NSArray arrayWithObjects:@"Previous", @"Next", nil]];
    [_segmentedControl setSegmentedControlStyle:UISegmentedControlStyleBar];
    [_segmentedControl addTarget:self action:@selector(nextPrevious:) forControlEvents:UIControlEventValueChanged];

    UIBarButtonItem *nextPrevButton = [[UIBarButtonItem alloc] initWithCustomView:_segmentedControl];

    UIBarButtonItem *flexSpace = [[UIBarButtonItem alloc] initWithBarButtonSystemItem:UIBarButtonSystemItemFlexibleSpace target:self action:nil];

    UIBarButtonItem *doneBtn = [[UIBarButtonItem alloc] initWithBarButtonSystemItem:UIBarButtonSystemItemDone target:self action:@selector(resignKeyboard)];

    NSArray *barItems = [NSArray arrayWithObjects:nextPrevButton, flexSpace, doneBtn, nil];
    [keyboardToolbar setItems:barItems];

    [_inputAccView addSubview:keyboardToolbar];

}

- (void) nextPrevious:(id) sender
{
    switch(_activeTxtField.tag) {
        case 1:
            //Recipe Name
            if (_segmentedControl.selectedSegmentIndex == 1){
                [_descriptionTextField becomeFirstResponder];
                _activeTxtField = _descriptionTextField;
            }
            break;
        case 2:
            //Recipe Description
            if (_segmentedControl.selectedSegmentIndex == 0){
                [_nameTextField becomeFirstResponder];
                _activeTxtField = _nameTextField;
            }
        default:
            break;
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T13:58:57.213

创建一个定义`UIView`通用输入附件视图的自定义。应该包括一个委托的定义，以允许使用附件视图的类处理，例如，适当的上一个/下一个按钮点击。这是键盘附件视图的头文件示例：

```
#import <UIKit/UIKit.h>

@class KeyboardAccessoryView;

@protocol KeyboardAccessoryViewDelegate <NSObject>

-(void)accessoryNext:(id)sender;
-(void)accessoryPrevious:(id)sender;

@end

@interface InputAccessoryView : UIView

@property (nonatomic, weak) id<KeyboardAccessoryViewDelegate> delegate;
@property (nonatomic, setter = enablePrevious:) BOOL previousEnabled;
@property (nonatomic, setter = enableNext:) BOOL nextEnabled;

-(id)initPreviousNextAccessory;

@end 
```

编辑 - 显示在`UIViewController`.

.h 文件：

```
#import <UIKit/UIKit.h>
#import "KeyboardAccessoryView.h"

@interface MyViewController : UIViewController <KeyboardAccessoryViewDelegate>

//...

@end 
```

.m 文件：

```
#import "MyViewController.h"

@interface MyViewController () {
    KeyboardAccessoryView *inputAccessoryView;
}

@end

@implementation MyViewController

//...

-(void)viewWillAppear:(BOOL)animated{
    [super viewWillAppear:animated];
    inputAccessoryView = [[KeyboardAccessoryView alloc] initPreviousNextAccessory];
    inputAccessoryView.delegate = self;

    //...
}

-(void)accessoryNext:(id)sender{
    // handle Next
}

-(void)accessoryPrevious:(id)sender{
    // handle Previous
}

//...

@end 
```

# nginx - 独角兽多机设置

> ID：14082243
> 
> 赞同：1
> 
> 时间：2012-12-29T13:44:08.027
> 
> 标签：nginx, unicorn, high-availability

我对 Unicorn 配置和 Nginx 的结合有很好的经验，经过优化和调整程序后它工作得非常好。但是现在我有一个问题，使用 Unicorns 将负载分散到多台机器上的最佳方法是什么。

问题是你有 3 台机器（Nginx 负载均衡器，2 台带有 Unicorns 的 APP 服务器），你如何管理 Unicorns 的负载均衡与服务静态资产。

您现在通过 TCP 连接到 Unicorn 是否有任何缺点（超时、连接丢失），是否有任何其他方法可以通过网络进行上游套接字连接（可能通过 SSH 进行端口转发）？Unicorn 设计为无状态，但您如何管理边缘情况？

我不想从平衡器节点提供静态服务，所以可以在每个 APP 服务器上设置 Nginx 并在它们前面设置哑 Nginx 平衡器吗？

PS 我当前的配置已经过很好的测试，可以在[Github](https://gist.github.com/3052776)上找到，但是在同一台机器上使用 Nginx+Unicorn 的设置已经成为瓶颈。

**更新**：开发完全取决于特定的服务器配置。瓶颈的发生不仅是因为开发人员的决定，还因为他运行它的环境。Stackoverlow 充满了高度标记的问答，这些问答与关于特定配置的难以了解的细节有关。下面回答的 Alex 与 Github 合作，非常感谢有这样合格的人回复！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-01T22:52:13.863

不要通过 TCP/网络访问 Unicorns。

您的设置似乎很好，您可以简单地在 APP 服务器前添加一个负载均衡器，但我建议[Keepalived](https://github.com/acassen/keepalived) (LVS ftw) 作为负载均衡器而不是 Nginx。

您可以让它们通过套接字平衡与运行 Nginx+Unicorns 的 APP 服务器的连接。

# java - 在 Spring MVC 中为任何包含 Tile 的 Tiles 布局提供对象

> ID：14082248
> 
> 赞同：1
> 
> 时间：2012-12-29T13:45:04.270
> 
> 标签：java, spring, jsp, spring-mvc, tiles

我有一个磁贴，其中列出了提供给它的对象中的文章。此图块是大多数页面的一部分，但不是全部。有什么方法可以自动将对象仅提供给需要它的页面（包含特定图块）？现在我在每个控制器中都有@ModelAttribute，它指向包含磁贴的页面，但这不是很灵活，因为如果你改变布局，你也需要改变控制器。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T14:06:08.697

如果您有任何规则，如果需要文章列表，则可以决定请求 url，然后您可以实现[`HandlerInterceptor`](http://static.springsource.org/spring/docs/2.0.x/api/org/springframework/web/servlet/HandlerInterceptor.html).

即拦截`postHandle`方法中的所有请求，并添加文章列表，如果“规则”说应该添加。

# java - JSP 国际化 RTL/LTR

> ID：14082252
> 
> 赞同：5
> 
> 时间：2012-12-29T13:45:30.947
> 
> 标签：java, jsp, internationalization, tiles2, right-to-left

我想创建一个可以用两种语言查看的网站，一种 LTR 和一种 RTL。这意味着所有内容都应以两种语言中的任何一种显示。

我的框架是 Spring，我使用的是 Tiles2，但我认为这个问题不是特定于框架的。

支持两种语言的明显解决方案是将所有内容加倍（所有 JSP、片段等），并且您将获得适合您选择的语言的树部分。但这在更改网站时会导致问题（您可能忘记更新其他 JSP），并且不可扩展（尝试对 5 或 10 种语言进行此操作）。

我知道我可以使用属性文件来托管不同语言的字符串，但是我的网站将是一个巨大的 spring:message 标签集合，并且会更难维护（如果我有 100 行的段落会发生什么，这一切都进入一个单一的属性行吗？）

有没有解决这个问题的框架、插件、*其他？*有没有人遇到过这个问题的巧妙解决方案？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-03T15:26:29.307

我从来没有实现过一个完整的项目，只是一些测试。如果你遵循一些简单的规则，我认为这个问题并不像看起来那么大。这是我会尝试做的事情：

*   用 指定方向`<body dir='ltr/rtl'>`。这是首选而不是 CSS 方向属性。

*   避免在所有 CSS 中使用不同的左右边距或填充。如果你必须打破这个规则，你可能需要使用包含所有这些不同元素的两个不同文件（ltr.css 和 rtl.css）。

*   有时您需要将一些元素从左向右移动，反之亦然。例如，在 LTR 中，您希望菜单在左侧，但在 RTL 中，您希望在右侧。您可以使用 CSS 实现这一点，但如果您不是专家，这有时会很复杂，您必须在所有浏览器中进行测试。另一种选择是根据情况使用一些 IF。如果您使用基于网格的 CSS 库（如 Bootstrap），最后一个选项将非常适合。

*   仔细选择您将使用的 CSS 和 JS 库。显然，选择那些提供 RTL/LTR 支持的。

*   不要太担心图像。如果您必须根据语言更改一张图像，可能是因为其中包含一些文本。所以，无论如何，你必须使用不同的图像。这是与 i18n 相关的问题，而不是文本方向问题。

*   不要让您的客户对此过于挑剔。我认为通过这些规则（可能还有更多规则），您可以获得一个好的结果。但是，如果您的客户开始抱怨这里有一个像素而那里有另一个像素，那么您需要将这一切复杂化，并且可能没有必要。

*   关于您的语言属性文件。是的，使用它们。总是。即使您只使用一种语言，这也是一个很好的做法：HTML 结构与内容分离，很容易更正或翻译，一些单词或句子只在一个文件中......

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-29T13:58:55.653

通常，Web 框架用于构建 Web 应用程序而不是网站，并且很少有长的静态段落。大多数内容是动态的并且来自数据库。但是，是的，通常的做法是将所有内容外部化到资源包中，通常以属性文件的形式。

将长段落放入属性文件不会造成太大问题，因为您可以通过以反斜杠结束每行来将长段落分成多行：

```
home.welcomeParagraph=This is a long \
    paragraph splitted into several lines \
    thanks to backslashes. 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-01T19:49:16.087

RTL 和 LTR 是 i18n 的高级和更困难的问题之一。

基本上它是 MVC 模型的视图范围的问题。这可能还包括图片和情感差异，例如人的皮肤颜色。在这种情况下，您最好放弃 HTML+CSS 为您提供的解决方案。

例如：

```
<style type="text/css">
    *:lang(ar) { direction:rtl }
    *:lang(de) { direction:ltr }
</style> 
```

最佳做法是询问受众群体的成员网页对他们的影响。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-07T13:57:27.557

我同意这里提供的大多数解决方案。您的问题更多是面向设计（架构）而不是技术。您需要选择路径是否需要将此国际化逻辑保留在服务器（java）端或静态文件中。

如果您想使用 java 端（首选解决方案），您需要保留两个属性文件并使用 jstl 标签。如果您以后想添加另一种语言，这可以最大限度地减少您的工作。这是可维护的解决方案。我见过支持超过 15 种语言和时区的应用程序。事实上，发布过程变得非常容易。

如果您想保留多个 css 和其他静态文件，您很快就会发现事情很快就用完了。我不认为这是一个可维护的解决方案。

说了这么多，我会把这个选择留给应用程序的架构师。他将能够根据应用程序的性质和给予他的限制来判断走哪条路。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-10T11:25:26.233

你不想到处使用。很遗憾，因为这正是你应该这样做的方式。如果需要国际化，将硬编码文本保存在 jsp 中是一种不好的做法。

此外，大多数现代 IDE 允许您通过 ctrl+左键单击（或悬停键）进入变量声明，因此代码中包含大量变量不应该成为维护问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-10T11:38:58.773

首先，对于每个文本元素，您必须区分它是用户界面元素（例如按钮标签）还是编辑内容。

用户界面元素标签将存储在必须为每种支持的语言翻译的属性文件中（并提供默认值作为后备）

编辑内容将存储在内容管理系统中，您将组织该系统以便轻松找到内容的本地化版本

# jquery - jQuery-ui 对话框自动获取 z-index

> ID：14082255
> 
> 赞同：2
> 
> 时间：2012-12-29T13:45:40.820
> 
> 标签：jquery, jquery-ui, z-index

我有一个名为的`tools`元素`z-index: 400000`。我希望它始终位于所有元素的首位。此外，在同一页面上还有一个带有选项的 jQuery-ui 对话框：

```
$("#dialog").dialog({ stack: false, zIndex: 1000 }); 
```

第一次打开该对话框时，我可以看到`tool`顶部的元素，但由于它关闭并再次打开，对话框会`400001`自动获取 z-index。

如何解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T13:52:12.773

我认为 jquery 对话框或模态框旨在漂浮在所有元素上以达到其目的。同样，您可以尝试添加`!important`到`tools`元素的 z-index css 属性。例子

```
.tools{
    z-index:40000 !important;
} 
```

如果它不能解决这种情况，那么您可以简单地扩展 jquery 对话框插件并覆盖自动将 z-index 设置为最大的行为。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T15:02:42.647

尝试复制问题和对话`z-index`始终保持不变。由于覆盖位置是固定的并填充了整个视口，我发现必须确保`tools`有位置`relative, absolute, or fixed`才能在覆盖到位时可见

[演示](http://jsfiddle.net/Dd4bZ/1/)

# ed - 临时文件已删除

> ID：14082256
> 
> 赞同：2
> 
> 时间：2012-12-29T13:45:42.470
> 
> 标签：ed

我正在研究 ed（是的，编辑器）源代码。该程序使用一个用 tmpfile 打开的临时文件作为缓冲区。但是，每当我运行程序时， lsof 总是将临时文件报告为已删除！（实际上它不存在）。为什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2019-07-08T18:17:50.690

因为文件可以存在于磁盘上而没有与之关联的文件名，所以许多程序会打开一个文件，然后立即取消链接。文件内容可以通过文件上的打开文件句柄继续修改和读取，并且在所有打开的文件句柄关闭之前实际上不会从磁盘中删除。

（这适用于 *nix/POSIX 平台 AFAICT；Windows 以不同方式处理文件，如果程序的文件句柄仍然打开，则防止取消链接，因此升级通常需要重新启动以强制关闭那些打开的文件句柄，以便文件内容可以更换）

# java - Event 和 even 类有什么区别？

> ID：14082266
> 
> 赞同：1
> 
> 时间：2012-12-29T13:47:02.237
> 
> 标签：java

`import java.awt.event.*`和 和有什么不一样`import java.awt.Event`？他们不是同一个进口吗？我必须实现 ActionListener 并且我正在导入 .Events 并且没有工作。后来我把 E 改成了 e 就成功了！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T14:17:17.450

> import java.awt.event.* 和 import java.awt.Events 有什么区别？他们不是同一个进口吗？

不，它们根本不是同一个进口。

`java.awt.event`是一个包，其中包含许多与 awt 系统中的事件相关的类。

`java.awt.Events`不存在，但我怀疑你的意思是`java.awt.Event`哪个是一个类。它已过时，仅用于向后兼容，不应使用。

# joomla - Joomla 2.5 不完整地显示文章/类别的添加/编辑表单

> ID：14082267
> 
> 赞同：0
> 
> 时间：2012-12-29T13:47:12.597
> 
> 标签：joomla, joomla2.5, joomla-article

当我点击添加新文章时，Joomla 显示页面不完整。

它甚至没有完全显示表单本身。

![在此处输入图像描述](../Images/5481bb2a1744f289a564ae5dadf42a01.png)

即使现在我已经启用了调试模式，它也没有显示任何内容。我认为这是`die()`将页面输出到浏览器的过程。

请注意，我的 joomla 安装没有**问题**。不久前它工作得很好。

我还没有更改深层核心设置。我认为我只更改了看起来与问题无关的 jcomment 设置。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T16:02:05.073

在此文件中添加此代码`root/administrator/components/com_content/content.php`

```
ini_set('display_errors', '1');
error_reporting(E_ALL ^ E_NOTICE); 
```

如果没有错误出现，请使用任何具有搜索功能的编辑器检查 die 或 exit 语句。如果这也不起作用，请重命名管理员的 com_content 并上传新的。

让我知道它是否不起作用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T23:48:35.380

禁用该插件。

您是添加还是更新？
如果文件在那里，请检查所有权。

# python - Scrapy 不使用 curl 命令抓取

> ID：14082273
> 
> 赞同：1
> 
> 时间：2012-12-29T13:48:34.903
> 
> 标签：python, scrapy

我有一个scrapy项目。我可以使用“scrapy crawl somespider”命令运行蜘蛛。但是，现在我正在尝试使用 scrapyd 进行爬网。当我跑

```
curl http://localhost:6800/schedule.json -d project=crawlers -d spider=someproject 
```

我得到的输出是

```
{"status": "ok", "jobid": "e0ace24c51bd11e28372079b5fff36ad"} 
```

现在，当我检查

```
http://localhost:6800/jobs 
```

我看到没有待处理的作业，只有一个已完成的作业存在

```
0:00:00.457973 time. 
```

可能是什么问题？

请帮忙。谢谢

# scala - 实现 flatMap 功能

> ID：14082278
> 
> 赞同：1
> 
> 时间：2012-12-29T13:49:03.493
> 
> 标签：scala

免责声明：这是家庭作业的一部分。我想为自定义 List 对象实现 flatMap。我已经成功实现了地图，但是我对 flatMap 有问题。我不知道如何展平从地图中获得的列表列表。我不知道我是否真的应该使用地图。

```
trait List[+A] {
  /** The first element */
  def head: A
  /** The rest of the elements */
  def tail: List[A]
  def flatMap[B](f: A => List[B]): List[B]
  def map[B](f: A => B): List[B]

  // Concatenate two lists
  def concat[B >: A](that: List[B]): List[B] = this match {
    case Empty => that
    case NonEmpty(head, tail) => NonEmpty(head, tail concat that)
  }
}

case object Empty extends List[Nothing] {
  def head = throw new UnsupportedOperationException("Empty.head")
  def tail = throw new UnsupportedOperationException("Empty.tail")
  def flatMap[B](f: Nothing => List[B]): List[B] = Empty
  def map[B](f: Nothing => B): List[B] = Empty

  override def toString = "Empty"
}

case class NonEmpty[A](head: A, tail: List[A]) extends List[A] {

  def map[B](f: A => B): List[B] = {

    NonEmpty(f(head), tail.map(f))

  }
def flatMap[B](f: A => List[B]): List[B] = {
    val a = this.map(f)
    for (x <- a; y <- x) yield y
  }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T14:33:50.333

由于这是一个家庭作业，我不想给你一个完整的解决方案，只是一些提示。

1.  您不需要`map`实现`flatMap`（实际上相反更容易实现）
2.  你有你需要的一切（`flatMap`接受一个返回 a`List[B]`并`List`已`concat`定义的函数）
3.  实施第`flatMap`一个`Empty`;-)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-29T15:23:01.167

您必须为长度为 n 的列表编写 flatMap。假设您已经解决了一个长度为 n-1 的列表，请尝试解决它。如果你能做到这一点，那么你就解决了这个问题，因为 n => n-1 => ... => 1 => 0，而对于 0，你已经有了解决方案。

这种思维适合你的List，因为它是递归类型。

你已经用 map 做了这件事，用 flatMap 做同样的事情。这两个函数都是从List[A]到List[B]的转换，唯一的区别是他们可以使用的工具，map有一个将A转换为B的函数，而flatMap有一个将A转换为List[B]的函数

# objective-c - UILabel 中文本前面的垂直线。像块引用

> ID：14082281
> 
> 赞同：1
> 
> 时间：2012-12-29T13:49:22.483
> 
> 标签：objective-c, ios, ios6, uilabel, nsattributedstring

我正在构建一个小应用程序并且不想在 UITableView 中显示引号。我正在使用带有一堆 UILabel 的自定义 UITableViewCells，一个用于标题，一个用于引用，更多标签用于获取更多信息。

我想在文本前面的左侧用一条垂直线显示引号。像一些块引用。这是 Reeder-App 的一个示例，它完全按照我想要的方式进行。

![示例图片](../Images/1471fc254d5759a4ff988032c5c5ac93.png)

有没有一种简单的方法可以做到这一点，也许使用属性字符串？提示会很棒，因为我没有解决它的想法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T13:52:05.427

获取 textheight 如下：

```
CGSize textHeight = [textLabel.text sizeWithFont:textLabel.font constrainedToSize:CGSizeMake(textLabel.frame.size.width, 99999999)]; 
```

然后像这样画线：

```
UIView *lineView = [[UIView alloc]initWithFrame:CGRectMake(10, 10, 5, textHeight.height)];
lineView.backgroundColor = [UIColor grayColor];
[self.view addSubview:lineView]; 
```

# python - 在类方法上创建线程

> ID：14082282
> 
> 赞同：1
> 
> 时间：2012-12-29T13:49:24.423
> 
> 标签：python, multithreading, oop

如何在传递“自我”的类方法上调用线程？我有一个定义如下的类，并想在新线程中以 self 作为参数调用类方法。我尝试关注但 self 没有作为参数传递

```
cust_obj = Customer()
thread.start_new_thread(cust_obj.process, ())  

class Customer():
    def __init__(self):
        pass
    def process(self):
        self.fetch_data()
        self.serialize_data()
    def fetch_data(self):
        # Fetch data logic
        pass
    def serialize_data(self):
        # Serialize fetched data
        pass 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T14:14:54.747

我相信您应该将类​​定义放在实例创建之前。然后它将起作用。

```
class Customer():
    ...
cust_obj = Customer()
thread.start_new_thread(cust_obj.process, ()) 
```

# c# - 获取节点下的多个属性值

> ID：14082283
> 
> 赞同：0
> 
> 时间：2012-12-29T13:49:25.523
> 
> 标签：c#, .net, xml, linq, linq-to-xml

我很难解析同时具有属性和后代的节点。

我需要进入客户节点并将其下方的所有内容解析为在网页上使用的值。

```
var contacts = from c in xdoc.Descendants("contact")
               select new Contact
               {              
                   Email = (string)c.Element("email"),
                   HomePhone = (string)c.Element("phone").Attribute("type") // ?
               }; 
```

还有我的 XML：

```
 <customer>
          <contact>
            <name part="first">Rick</name>
            <name part="last">Smith</name>
            <email>rick@yahoo.com</email>
            <phone type="home">2299998989</phone>
            <phone type="work">2298887878</phone>
            <phone type="cell">2297778878</phone>
            <address type="home">
              <street line="1">4001 Coleman Rd</street>
              <street line="2">Ste. 99</street>
              <city>Tempe</city>
              <regioncode>AZ</regioncode>
              <postalcode>43444</postalcode>
            </address>
          </contact>
          <comments>Customer comments</comments>
        </customer>

        <vendor>
          <contact>
            <name part="full" type="salesperson">Joe Smith</name>
          </contact>
        </vendor> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T14:11:50.767

```
XDocument xdoc = XDocument.Load(path_to_xml);
var customers = 
    from c in xdoc.Descendants("customer")
    let contact = c.Element("contact")        
    let names = contact.Elements("name")
    let phones = contact.Elements("phone")
    let address = contact.Element("address")
    let streets = address.Elements("street")
    select new Customer {
        Contact = new Contact {
            FirstName = (string)names.SingleOrDefault(n => (string)n.Attribute("part") == "first"),
            LastName = (string)names.SingleOrDefault(n => (string)n.Attribute("part") == "last"),
            Email = (string)contact.Element("email"),
            HomePhone = (string)phones.SingleOrDefault(p => (string)p.Attribute("type") == "home"),
            CellPhone = (string)phones.SingleOrDefault(p => (string)p.Attribute("type") == "cell"),
            WorkPhone = (string)phones.SingleOrDefault(p => (string)p.Attribute("type") == "work"),
            Address = new Address {
                    Type = (string)address.Attribute("type"),
                    StreetLine1 = (string)streets.SingleOrDefault(s => (int)s.Attribute("line") == 1),
                    StreetLine2 = (string)streets.SingleOrDefault(s => (int)s.Attribute("line") == 2),
                    City = (string)address.Element("city"),
                    RegionCode = (string)address.Element("regioncode"),
                    PostalCode = (string)address.Element("postalcode")
                }
        },
        Comments = (string)c.Element("comments")
    }; 
```

您需要以下类来保存解析的数据：

```
public class Customer
{
    public Contact Contact { get; set; }
    public string Comments { get; set; }
}

public class Contact
{
    public string FirstName { get; set; }
    public string LastName { get; set; }
    public string Email { get; set; }
    public string HomePhone { get; set; }
    public string WorkPhone { get; set; }
    public string CellPhone { get; set; }
    public Address Address { get; set; }
}

public class Address
{
    public string Type { get; set; }
    public string StreetLine1 { get; set; }
    public string StreetLine2 { get; set; }
    public string City { get; set; }
    public string RegionCode { get; set; }
    public string PostalCode { get; set; }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T13:56:49.240

要获取家庭电话号码，您应该使用：

```
HomePhone = (string)c.Elements("phone").SingleOrDefault(e => (string)e.Attribute("type") == "home"); 
```

# ruby - 如何在变量值之后创建数组名称

> ID：14082285
> 
> 赞同：0
> 
> 时间：2012-12-29T13:49:56.657
> 
> 标签：ruby, variables

我正在尝试在某些线程中创建一些数组，并在 1 到 30 之间的 fixnum 之后命名它们，如下所示：

```
times = 30
n=0
thread = []
while n < times
  thread << Thread.new(n)  {|x|
    array#{x} = Array.new()
    ... 
  }
end 
```

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T14:49:34.730

Ruby 不允许您以与 PHP 相同的方式从字符串创建变量名。在这种情况下，您可以改用数组或散列。

```
times = 30
n=0

arrays = []
thread = []

while n < times

  thread << Thread.new(n)  {|x|

    arrays[x] = Array.new()
    ... 
  }
end 
```

您还可以使用更多的 ruby​​ish 构造来代替 while，例如`Fixnum#times`.

```
arrays = []
threads = 30.times.map do |n|
  Thread.new do
    arrays[x] = Array.new
    # ...
  end
end

> arrays
#=> [[], [], [], ....]
> threads
#=> [#<Thread:0x007fe3f22a2320 dead>, #<Thread:0x007fe3f22a2208 dead>, ...] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T19:50:01.580

如果你不介意使用实例变量而不是局部变量，你可以做你想做的事情（以这种方式设计代码是否是一个好主意是另一个问题）。

```
1.upto(times) do |i|
  instance_variable_set("@array#{i}".to_sym, [])
end 
```

# php - 为什么浮点数的打印方式如此不同？

> ID：14082287
> 
> 赞同：12
> 
> 时间：2012-12-29T13:50:00.127
> 
> 标签：php, javascript, ruby, floating-point, ieee-754

众所周知，（大多数）浮点数没有精确存储（当使用 IEEE-754 格式时）。所以不应该这样做：

```
0.3 - 0.2 === 0.1; // very wrong 
```

...因为它将导致`false`，除非使用了某些特定的任意精度类型/类（[Java](http://docs.oracle.com/javase/7/docs/api/java/math/BigDecimal.html) / [Ruby](http://www.ruby-doc.org/stdlib-1.9.3/libdoc/bigdecimal/rdoc/BigDecimal.html)中的 BigDecimal ，PHP 中的[BCMath ，Perl 中的](http://php.net/manual/en/book.bc.php)[Math::BigInt](https://metacpan.org/module/Math::BigInt) / [Math::BigFloat](https://metacpan.org/module/Math::BigFloat)等等）。

然而我想知道为什么当一个人试图打印这个表达式的结果时`0.3 - 0.2`，脚本语言（[Perl](http://ideone.com/V2J2cg)和[PHP](http://ideone.com/YeKifV)）给出`0.1`了，但是“虚拟机”语言（[Java](http://ideone.com/CU9wJ3)、[JavaScript](http://jsfiddle.net/Ugs34/)和[Erlang](http://ideone.com/9J7arJ)）给出了更相似的东西`0.09999999999999998`呢？

为什么它在 Ruby 中也不一致？[1.8.6 版（键盘）](http://codepad.org/M3o2EhuN)给出`0.1`，[1.9.3 版（ideone）](http://ideone.com/vYpRxd)给出`0.0999...`

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-29T14:16:40.720

至于 php，输出与精度的 ini 设置有关：

```
ini_set('precision', 15);
print 0.3 - 0.2; // 0.1

ini_set('precision', 17);
print 0.3 - 0.2; //0.099999999999999978 
```

这也可能是其他语言的原因

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-29T17:21:52.643

浮点数的打印方式不同，因为打印是为了不同的目的而进行的，因此对于如何进行打印做出了不同的选择。

打印浮点数是一种转换操作：以内部格式编码的值被转换为十进制数字。但是，对于转换的细节有一些选择。

**(A)**如果你在做精确的数学运算，想看到内部格式表示的实际值，那么转换必须是精确的：它必须产生一个与输入值完全相同的十进制数字。（每个浮点数只代表一个数字。在 IEEE 754 标准中定义的浮点数不代表一个区间。）有时，这可能需要产生非常多的数字。

**(B)**如果您不需要确切的值，但确实需要在内部格式和十进制之间来回转换，那么您需要将其精确地（并且准确地）转换为十进制数字，以将其与任何其他结果区分开来。也就是说，您必须生成足够多的数字，以使结果与通过转换内部格式中相邻的数字所获得的结果不同。这可能需要产生大量的数字，但不能多到难以管理。

**(C)**如果您只想让读者了解数字，而不需要生成确切的值以使您的应用程序按需要运行，那么您只需要生成您的应用程序所需的尽可能多的数字特定的应用。

其中哪些应该转换？

不同的语言有不同的默认值，因为它们是为不同的目的而开发的，或者因为在开发过程中做所有必要的工作以产生准确的结果并不方便，或者出于各种其他原因。

(A) 需要仔细的代码，并且某些语言或它们的实现不提供或不保证提供这种行为。

我相信（B）是Java所要求的。但是，正如我们在[最近的一个问题](https://stackoverflow.com/questions/14063936/why-is-65-12-2-not-equal-to-63-12-in-java)中看到的那样，它可能会有一些意想不到的行为。(`65.12`打印为“65.12”，因为后者有足够的位数将其与附近的值区分开来，但`65.12-2`打印为“63.120000000000005”，因为它和 63.12 之间还有另一个浮点值，因此您需要额外的数字来区分它们。 )

(C) 是某些语言默认使用的。从本质上讲，这是错误的，因为对于要打印的位数，没有一个值可以适用于所有应用程序。事实上，几十年来我们已经看到它助长了对浮点的持续误解，主要是通过隐藏所涉及的真实值。然而，它很容易实现，因此对一些实现者很有吸引力。理想情况下，语言应该默认打印浮点数的正确值。如果要显示的位数较少，则应仅由应用程序实施者选择位数，希望包括考虑适当的位数以产生所需的结果。

Worse, some languages, in addition to not displaying the actual value or enough digits to distinguish it, do not even guarantee that the digits produced are correct in some sense (such as being the value you would get by rounding the exact value to the number of digits shown). When programming in an implementation that does not provide a guarantee about this behavior, you are not doing engineering.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-29T14:17:21.953

PHP 自动将数字四舍五入到任意精度。

浮点数通常不准确（正如您所指出的），`round()`如果您只需要比较几位小数，则应该使用特定于语言的函数。否则，取方程的绝对值，并测试它们是否在给定范围内。

[来自php.net](http://php.net/manual/en/language.types.float.php)的 PHP 示例：

```
$a = 1.23456789;
$b = 1.23456780;
$epsilon = 0.00001;
if(abs($a - $b) < $epsilon) {
  echo "true";
} 
```

至于 Ruby 问题，他们似乎使用了不同的版本。Codepad使用`1.8.6`，而 Ideaone 使用`1.9.3`，但它更可能与某处的配置有关。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-29T15:27:40.413

如果我们想要这个属性

*   每两个不同的浮点数都有不同的打印表示

或者更强大的对 REPL 有用

*   印刷表示应重新解释不变

然后我看到了 3 个解决方案，用于将具有基数 2 内部表示的浮点数/双精度数打印到基数 10

1.  打印确切的表示。
2.  打印足够的十进制数字（适当的四舍五入）
3.  打印可以重新解释不变的最短十进制表示

由于以 2 为底，浮点数为 an_integer * 2^an_exponent，其以 10 为底的精确表示具有有限位数。
不幸的是，这可能会导致很长的字符串...例如 1.0e-10 完全表示为 1.0000000000000000364321973154977415791655470655996396089904010295867919921875e-10

解决方案 2 很简单，您使用 IEEE-754 双倍的 17 位 printf...
缺点：它不准确，也不是最短的！如果输入 0.1，则得到 0.100000000000000006

解决方案 3 是 REPL 语言的最佳解决方案，如果您输入 0.1，它会打印 0.1
不幸的是，它在标准库中找不到（很遗憾）。
至少，Scheme、Python 和最近的 Squeak/Pharo Smalltalk 做得对，我认为 Java 也是。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-29T15:23:31.573

至于 Javascript，base2 在内部用于计算。

```
> 0.2 + 0.4
0.6000000000000001 
```

为此，如果生成的 base2 数字不是周期性的，Javascript 只能传递偶数。

0.6`0.10011 10011 10011 10011 ...`在 base2（周期性）中，而`0.5`没有因此正确打印。

# mysql - 根据用户位置插入值

> ID：14082289
> 
> 赞同：0
> 
> 时间：2012-12-29T13:50:09.783
> 
> 标签：mysql, sql

在 mySql 中，是否可以基于某些东西进行插入？就我而言，我想根据用户的位置进行插入。这些地点就像美国、英国、澳大利亚、加利福尼亚等。所以如果地点是美国，我想做 1-0001、1-0002 等，英国 2-001、2-002 等。

也许通过使用类似的情况是可能的？

我当前的插入是这样的：

```
insert into prodClassifieds (userId, userName, classStatus, classCountry, classId)
   select
     $userId, 
     '$userName', 
     1,
     '$userCountry',
     IFNULL((MAX(classId)+1) ,0)
   FROM prodClassifieds 
```

编辑：我可以在 1-0001 中省略 - 。MAX(col) 也是 MAX(classId) 不是我最初发布的那个。下一个值是 1 + 那里的当前值。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T13:58:19.540

使用 CASE WHEN 如下：

```
insert into prodClassifieds (userId, userName, classStatus, classCountry, classId)
   select
     $userId, 
     '$userName', 
     CASE '$userCountry' WHEN 'US' THEN 10000 WHEN 'UK' THEN 20000 ELSE 90000 END CASE
     + 1,
     '$userCountry',
     IFNULL((MAX(sc_stack_id)+1) ,0)
   FROM prodClassifieds 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T13:54:20.343

是的，这是可能的，

```
insert into prodClassifieds 
(userId, userName, classStatus, classCountry, classId) 
select $userId, '$userName', 1,
'$userCountry', 
 case when userCountry='US' then 
MAX(sc_stack_id)+1 else 0 end
FROM prodClassifieds 
```

您可以根据需要添加几个条件

# objective-c - tableView 不显示任何内容

> ID：14082290
> 
> 赞同：0
> 
> 时间：2012-12-29T13:50:24.720
> 
> 标签：objective-c, tableview

我确定我的代码是我们的错误，因为我有两个相同的 tableViews 并且都具有相同的代码、相同的内容和相同的设计。但我不明白为什么我的一个 tableViews 显示，而另一个没有。我正在使用动态原型内容、分组样式，并且两个 tableViews 都在其他 ViewController 的容器视图中。这是代码：

表.h

```
#import <UIKit/UIKit.h>

@interface table : UIViewController <UITableViewDataSource, UITableViewDelegate>

{
    NSArray *tabledata;
    NSIndexPath* checkedIndexPath;
}
@property (nonatomic, retain) NSArray *tabledata;
@property (nonatomic, assign) int number;
@property (nonatomic, retain) NSIndexPath* checkedIndexPath;
@property (strong, nonatomic) IBOutlet UITableView *tableView;
+(table*)instance;
@property (nonatomic) NSInteger selectedRow;

@end 
```

表.m

```
#import "table.h"

@interface table ()

@end

@implementation table
@synthesize tabledata;
@synthesize tableView;
@synthesize checkedIndexPath;
@synthesize number;
+(InstrumentsI*)instance {
    static table *statInst;
    static dispatch_once_t onceToken;
    dispatch_once(&onceToken, ^{
        statInst = [[table alloc] init];
    });
    return statInst;
}
@synthesize selectedRow;

- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
    if (self) {
        // Custom initialization
    }
    return self;
}

- (void)viewDidLoad
{
    [super viewDidLoad];
    tabledata = [[NSArray alloc] initWithObjects:@"row1", @"row2", @"row3", nil];
    self.selectedRow = 0;
}

- (void)didReceiveMemoryWarning
{
    [super didReceiveMemoryWarning];
}

#pragma mark - TableView Data Source methods

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
    return [tabledata count];
}

- (UITableViewCell *)tableView:(UITableView *)tableview cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    UITableViewCell *cell = nil;
    cell = [tableview dequeueReusableCellWithIdentifier:@"identifer"];
    if (cell == nil)
    {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:@"identifer"];
    }

    cell.textLabel.text = [tabledata objectAtIndex:indexPath.row];

    if (indexPath.row == self.selectedRow)
    {
        cell.accessoryType = UITableViewCellAccessoryCheckmark;
    } else {
        cell.accessoryType = UITableViewCellAccessoryNone;
    }

    return cell;
}

#pragma mark TableView Delegate methods

- (void)tableView:(UITableView *)tableview didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
    [table instance].selectedRow = indexPath.row;
    if (indexPath.row != self.selectedRow) {
        self.selectedRow = indexPath.row;
    }
    [tableView reloadData];
}

- (void)viewDidUnload {
    [self setTableView:nil];
    [super viewDidUnload];
}
@end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T14:09:49.667

检查您是否已实现所有委托和数据源方法。

还要确认您已将文件的所有者或控制器设置为委托和数据源。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T13:56:35.420

加载数据后尝试重新加载tableview，例如：

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    tabledata = [[NSArray alloc] initWithObjects:@"row1", @"row2", @"row3", nil];
    self.selectedRow = 0;
    [self.tableView reloadData];
} 
```

# mysql - MySQL Innodb：大型复合 PK 没有其他索引

> ID：14082293
> 
> 赞同：3
> 
> 时间：2012-12-29T13:50:50.433
> 
> 标签：mysql, primary-key, innodb, composite-index

我正在创建一个包含四列的 Innodb 表。

桌子

```
 column_a (tiny_int)
 column_b (medium_int)
 column_c (timestamp)
 column_d (medium_int)

 Primary Key -> column_a, column_b, column_c 
```

从逻辑的角度来看，A、B、C 列必须一起组成一个 PK。但是，为了提高性能并能够直接从索引中读取（使用索引），我正在考虑一个包含所有 4 列的 PK（A , B, C, D)。

问题

将附加列附加到 Innodb 表上的主键的性能是什么？

注意事项

*   代理主键绝对不可能
*   此表上不存在其他索引
*   表是读/写密集型（两者大致相等）

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T16:47:58.947

在 InnoDB 中，`PRIMARY KEY`索引结构包括所有非键字段，并且会自动使用它们来覆盖索引查询和行消除。`PRIMARY KEY`除了索引结构之外，没有单独的“数据”结构。无需向`PRIMARY KEY`定义本身添加其他字段。`Using index`请注意，当它在 InnoDB 表上使用时它不会显示`PRIMARY KEY`，因为它是不同的代码路径，不会触发添加该消息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-03T20:06:21.647

A few things to consider:

1.  Unless the query in question uses all of the columns in the index, the index will not be used.
2.  As jeremycole notes: in the Innodb structure all row data is stored in the B-tree leaf nodes of the clustered index (PRIMARY INDEX)

This concept is covered: [http://www.innodb.com/wp/wp-content/uploads/2009/05/innodb-file-formats-and-source-code-structure.pdf](http://www.innodb.com/wp/wp-content/uploads/2009/05/innodb-file-formats-and-source-code-structure.pdf) http://blog.johnjosephbachir.org/2006/10/22/everything-you-need-to-know-about-designing-mysql-innodb-primary-keys/

... and in jeremy's blog post here: [http://blog.jcole.us/2013/01/07/the-physical-structure-of-innodb-index-pages/](http://blog.jcole.us/2013/01/07/the-physical-structure-of-innodb-index-pages/)

As such, a query on A, B, C will be sufficient for efficiently obtaining all values on this Innodb table.

# d - 使用 std.range.Lockstep 作为输入范围

> ID：14082294
> 
> 赞同：3
> 
> 时间：2012-12-29T13:51:20.723
> 
> 标签：d, phobos

复制[http://forum.dlang.org/thread/arlokcqodltcazdqqlby@forum.dlang.org](http://forum.dlang.org/thread/arlokcqodltcazdqqlby@forum.dlang.org)来比较回答速度:)

我基本上希望能够做这样的事情：

`auto result = map!( (a, b) => a+b )( lockstep(range1, range2) );`

是否有任何标准的简短方法可以使用 opApply （即 Lockstep ）将输入范围包装在 struct 周围？

另外，如何将 Lockstep 重新设计为适当的范围？我可以提出拉取请求，但不确定当前的意图。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T18:12:56.690

[D.learn 和 Simen Kjaeraas](http://forum.dlang.org/post/mailman.3092.1356790779.5162.digitalmars-d-learn@puremagic.com)获得了奖品：

* * *

改用 std.range.zip ：

```
auto result = map!( (a, b) => a+b )( zip(range1, range2) ); 
```

有两种方法的原因是锁步更适用于 foreach：

```
foreach (a, b; lockstep(A, B) ) {
    // Use a and b here.
} 
```

与 zip 对比：

```
foreach (a; zip(A, B) ) {
  // Use a[0] and a[1] here.
} 
```

已经有人建议在语言中更好地集成元组，因此将来 zip 可能具有锁步的所有优点（反之亦然），但不要交叉手指。

# jsp - struts2 jquery 应用程序的所有 jar 列表

> ID：14082302
> 
> 赞同：0
> 
> 时间：2012-12-29T13:52:28.730
> 
> 标签：jsp, struts2, struts2-jquery

谁能列出：

1.  struts2 Jquery 网格应用程序所需的所有 jars、javascript 和 Css 文件。如果有的话，还包括 jars，用于 struts-2 jquery 可搜索网格。

    应用程序将使用 get 方法以及一些请求参数向 struts2 操作类发出 ajax 请求。动作类将填充一个数组列表，该列表将在 jsp 中使用 jquery 网格显示。

2.  我看到在 web.xml 中配置的 FilterDispatcher 已被弃用。还请列出用于相应 jar 的新类名，并且解释的应用程序需要任何其他配置。
3.  还请列出、更改（如果有）在 struts2 中配置操作名称/类/结果标签。XML 文件和 Action 类。

我正在尝试从过去 14 天开始制作简单的 struts2 jquery 网格应用程序。谷歌代码示例没有列出所有需要的罐子，所以它适用于 . 添加最新的 struts2.3 jar 时会出现找不到类的问题。

谢谢！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T14:25:17.820

将所有 jar 文件放入服务器的运行时 lib 文件夹 Java jars：

> Struts2.jars
> Json.jar - 用于将数据转换为 json 对象
> Jqgrid.jar Jackson.jar
> Javascript
> 
> 文件：
> Jquery.js
> Jqgrid.js

# java - 如何在 ListFragment 中使用 setEmptyView() 和自定义列表布局

> ID：14082303
> 
> 赞同：6
> 
> 时间：2012-12-29T13:52:36.160
> 
> 标签：java, android, xml, android-layout, listview

我正在使用带有几个`Fragments`.

`Fragment`当列表 ( )中没有条目时，我想显示一条消息。

我尝试使用`Textview`with`android:id="@id/android:empty`但它不起作用。

自定义列表布局代码：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:padding="@dimen/padding_medium" >

    <TextView
        android:id="@+id/label_value"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_centerVertical="true"
        android:layout_marginLeft="@dimen/padding_medium"
        android:text="@string/label_value"
        android:textColor="@android:color/white"
        android:textSize="18sp" />

    <TextView
        android:id="@+id/label_date"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentRight="true"
        android:layout_centerVertical="true"
        android:layout_marginRight="@dimen/padding_medium"
        android:text="@string/title_time"
        android:textColor="@android:color/white"
        android:textSize="16sp" />

</RelativeLayout> 
```

列出适配器类：

```
public class JournalAdapter extends ArrayAdapter<String> {

    private final Context context;
    private final List<String> values;
    private final List<String> dates;

    public JournalAdapter(Context context, List<String> values,
            List<String> dates) {
        super(context, R.layout.layout_journal_list, values);

        this.context = context;
        this.values = values;
        this.dates = dates;
    }

    @Override
    public View getView(int position, View convertView, ViewGroup parent) {
        LayoutInflater inflater = (LayoutInflater) context
                .getSystemService(Context.LAYOUT_INFLATER_SERVICE);

        View rowView = inflater.inflate(R.layout.layout_journal_list, parent, false);

        TextView value = (TextView) rowView.findViewById(R.id.label_glucose);
        TextView date = (TextView) rowView.findViewById(R.id.label_date);

        value.setText(values.get(position));
        date.setText(dates.get(position));

        return rowView;
    }

} 
```

列表解析方法：

```
private void initListView() {
        values = dataSource.getAllValues();

        List<String> values = new ArrayList<String>();
        List<String> dates = new ArrayList<String>();

        for (Value value : values) {
            values.add(Double.toString(value.getValue()));
            dates.add(secondsToDate(value.getDate()));
        }

        setListAdapter(new JournalAdapter(context, values, dates));

        listView = getListView();
        listView.setEmptyView(noItems("NO ITEMS"));
        listView.setOnItemClickListener(this);
    } 
```

`noItems`方法：

```
private TextView noItems(String text) {
        TextView emptyView = new TextView(context);
        emptyView.setLayoutParams(new LayoutParams(LayoutParams.FILL_PARENT,
                LayoutParams.FILL_PARENT));
        emptyView.setText(text);
        emptyView.setTextColor(Color.WHITE);
        emptyView.setTextSize(20);
        emptyView.setVisibility(View.GONE);
        emptyView.setGravity(Gravity.CENTER_VERTICAL
                | Gravity.CENTER_HORIZONTAL);

        return emptyView;
    } 
```

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2013-04-13T17:50:24.297

[这对我有用（从William Remacle](https://stackoverflow.com/users/406761/william-remacle)提出的[这个问题](https://stackoverflow.com/questions/4088711/android-listview-default-text-when-no-items)中得到了解决方案）。您可能错过的是**将 created 添加****到****布局父**级（下面方法底部的第二行代码）：**`TextView``ListView`**`noItems`

在我的`ListFragment`我使用以下方法来获取空视图的视图：

```
private TextView noItems(String text) {
    TextView emptyView = new TextView(getActivity());
    //Make sure you import android.widget.LinearLayout.LayoutParams;
    emptyView.setLayoutParams(new LayoutParams(LayoutParams.MATCH_PARENT,
            LayoutParams.MATCH_PARENT));
    //Instead of passing resource id here I passed resolved color 
    //That is, getResources().getColor((R.color.gray_dark))
    emptyView.setTextColor(getResources().getColor(R.color.gray_dark));
    emptyView.setText(text);
    emptyView.setTextSize(12);
    emptyView.setVisibility(View.GONE);
    emptyView.setGravity(Gravity.CENTER_VERTICAL
            | Gravity.CENTER_HORIZONTAL);

    //Add the view to the list view. This might be what you are missing
    ((ViewGroup) getListView().getParent()).addView(emptyView);

    return emptyView;
} 
```

然后在设置空视图的`onStart()`方法中：`ListFragment`

```
@Override
public void onStart() {
    super.onStart();
    getListView().setEmptyView(
            noItems(getResources().getString(R.string.widget_empty)));
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-29T14:17:43.920

```
 android:id="@android:id/empty" 
```

并不是

```
 android:id="@id/android:empty" 
```

# javascript - 将 onclick 转换为 onchange

> ID：14082305
> 
> 赞同：1
> 
> 时间：2012-12-29T13:52:41.387
> 
> 标签：javascript, forms, google-chrome, onclick, onchange

在过去的几天里，我一直在为我的网站创建联系表格，该表格可能是专业的，并且包含 display:none/block 和 disabled:true/false 区域。我成功了。但是一个小时前我被告知 Chrome 不支持“onclick”功能，所以现在我必须将所有“onlick”内容更改为“onchange”.. 但它似乎并不清晰（仍然无法正常工作）......

ONCLICK 工作正常：

```
<script language="javascript">
    function enableField() { some function here }
    function disableField() { some function here }
</script>

<select class="list" id="topic">
    <option onclick="javascript:disableField()" selected="selected">Select Your topic</option>
    <option onclick="javascript:enableField()">Topic 1</option>
    <option onclick="javascript:enableField()">Topic 2</option>
    <option onclick="javascript:disableField()">Topic 3</option>
    <option onclick="javascript:disableField()">Topic 4</option>
</select> 
```

ONCHANGE 不会：

```
<script language="javascript">
    function enableField() { some function here }
    function disableField() { some function here }
</script>

<select class="list" id="topic" onchange="javascript:this.value()">
    <option value="disableField" selected="selected">Select Your topic</option>
    <option value="enableField">Topic 1</option>
    <option value="enableField">Topic 3</option>
    <option value="disableField">Topic 3</option>
    <option value="disableField">Topic 4</option>
</select> 
```

我只是想在“javascript:X()”中将“值”插入为“X”，这样这个函数就可以像在“ONLICK”选项中那样工作。

我一直在尝试不同的方式，但这些都不起作用。

请帮忙。问候，迈克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T13:59:17.447

一种方法

```
<select class="list" id="topic" onchange="window[this.value]()">
    <option value="disableField" selected="selected">Select Your topic</option>
    <option value="enableField">Topic 1</option>
    <option value="enableField">Topic 3</option>
    <option value="disableField">Topic 3</option>
    <option value="disableField">Topic 4</option>
</select> 
```

* * *

但我会这样做

```
<script language="javascript">
    function enableField() { some function here }
    function disableField() { some function here }
    function handle(value){
       if (value === 'enableField'){
           enableField();
       } else {
           disableField();
       }
    }
</script>

<select class="list" id="topic" onchange="handle(this.value)">
    <option value="disableField" selected="selected">Select Your topic</option>
    <option value="enableField">Topic 1</option>
    <option value="enableField">Topic 3</option>
    <option value="disableField">Topic 3</option>
    <option value="disableField">Topic 4</option>
</select> 
```

* * *

***注意：**对于诸如 等的事件属性`onclick`，`onchange`您不必`javascript:...`说它是隐含的..*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T13:59:37.057

```
this.value() 
```

是一个字符串；你不能调用一个字符串。你想要的是在全局范围内找到函数：

```
window[this.value]() 
```

此外，最好将函数存储在专用对象中：

```
funcs = {
  disableField: function(){...},
  enableField: function(){...},
}

...

funcs[this.value]() 
```

# sencha-touch - 我应该使用哪个事件来加载将在 Sencha Touch 中填充表单的商店？

> ID：14082308
> 
> 赞同：-1
> 
> 时间：2012-12-29T13:52:57.910
> 
> 标签：sencha-touch, sencha-touch-2

当视图被带入视口时，我希望能够加载存储并将检索到的模型设置到视图中的表单上。但是，我不太确定我应该为此目的使用哪个事件。

这是否应该在视图的“Painted”事件中完成，视图是否应该返回到控制器，然后填充视图，或者是否有其他推荐的方法？

目前在我看来有这个：

```
 listeners: {
        painted: function () {
            var contactStore = Ext.getStore("theContactDetailsStore");

             contactStore.load({
                    scope: this,
                    callback: function (record, operation, success) {
                        if (success && record[0]) {                            
                            this.setRecord(record[0]);                                     
                        }
                    }
                });
       }
   } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T14:08:06.827

绘制事件应该用于执行一些低级别的 DOM 操作，如修复元素大小、位置等。这是我建议你的：

*   首先加载商店，最终在之前用“正在加载...”消息掩盖视口，这样如果操作需要时间，用户就不会觉得应用程序崩溃了。
*   在商店“加载”回调中显示您的表单视图，将所需数据模型作为“记录”配置参数传递。

通过这种方式，您的表格将立即显示为您的记录数据。

PS：如果您在加载商店之前屏蔽视口，请记住在显示表单之前在“加载”回调中取消屏蔽它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T04:47:13.317

有两种方法可以处理这个问题：

1.  Create view first and in its initialize function create & load store. The code for creating an loading could easily be part of controller by firing corresponding event from initialize. This might look ugly because your view might not look good without data , but still this would be faster so please take care of masking & unmasking(in load callback of store) the view.

2.  Create your store first and in its load callback fire the event with data(store records etc) which will create the view using that data. This would look slow initially because you won't see any part of view until store is loaded.

# php - 文本框防止空格

> ID：14082313
> 
> 赞同：-2
> 
> 时间：2012-12-29T13:53:56.760
> 
> 标签：php, textbox

```
<?php
$varray = $database->getProfileVillages($session->uid);
for($i=0;$i<=count($varray)-1;$i++) {
    echo "<tr><th>Köy ismi</th><td><input tabindex=\"6\" type=\"text\" name=\"dname$i\" value=\"".$varray[$i]['name']."\" maxlength=\"20\" class=\"text\"></td></tr>";
} 
?>
<tr><td colspan="2" class="desc2"><textarea tabindex="8" name="be2"><?php echo $session->userinfo['desc1']; ?></textarea></td></tr> 
```

我希望如果用户输入“”（空格）然后系统将其更改为 - （hiphen）。

**例子**

（“Soul Man”变成“Soul-Man”）&（“”变成“-”）。

你能把代码替换成我的代码吗？
提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T13:57:08.463

### 采用`str_replace()`

给的时候`echo`，给这个：

```
echo str_replace(" ", "-", $str); 
```

字符串在哪里`$str`，您想将其中的空格替换为破折号。

* * *

### 代替：

```
$varray[$i]['name'] 
```

### 和：

```
str_replace(" ", "-", $varray[$i]['name']); 
```

* * *

### 复制粘贴这段代码：

```
echo "<tr><th>Köy ismi</th><td><input tabindex=\"6\" type=\"text\" name=\"dname$i\" value=\"", str_replace(" ", "-", $varray[$i]['name']), "\" maxlength=\"20\" class=\"text\"></td></tr>"; 
```

# ruby-on-rails - 设计邀请码

> ID：14082315
> 
> 赞同：1
> 
> 时间：2012-12-29T13:54:05.677
> 
> 标签：ruby-on-rails, devise

我想为用户在我的应用程序中注册添加邀请码要求。我调查了[devise_invitable](https://github.com/scambra/devise_invitable) gem 的设计，这看起来很有希望。但是，应该不可能像 devise_invitable 那样不断地邀请人们加入应用程序。

为了解决这个问题，我需要在我的应用程序中植入用户级别。我在 github 上找到[了这个项目](https://github.com/iulery/Gamify)，现在我有了以下想法：一旦用户注册（由另一个现有用户邀请），它就会从级别 1 开始，并且必须完成任务才能存档经验点。他工作到下一个级别，他可以邀请 1 个新成员，然后在下一个级别，他可以邀请 1 个其他成员，在下一个级别，用户可以邀请 2 个成员，依此类推。

我对 Ruby 很陌生，我想知道如何实现这一点，并想知道这是否可以插入到我的用户控制器中。

感谢您阅读，祝您有美好的一天。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T14:17:16.340

这应该是一个相当简单的过程，因为用户拥有的邀请数只是存储在数据库中的一个整数。它可能很简单：

```
def level_up(level)
  self.invitation_limit += level
  self.save
end 
```

虽然实现非常简单，但您只需传入用户级别，将其添加到他们当前的邀请数量中，然后保存用户。这完全取决于您想要获得的花哨程度，但这实际上归结为基本数学，并将其保存到数据库中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-06-28T12:55:26.613

我不确定自 2012 年提出问题以来这是否发生了变化，但 devise_invitable 有一个`invitation_limit`参数：

> 邀请限制：用户可以发送的邀请数量。默认值 nil 表示用户可以发送任意数量的邀请，对任何用户没有限制，不使用invitation_limit 列。设置为 0 表示他们无法发送邀请。设置 n > 0 意味着他们可以发送 n 个邀请。您可以更改某些用户的邀请限制列，以便他们可以发送更多或更少的邀请，即使全局邀请限制 = 0。

您可以通过查看[此处](https://github.com/scambra/devise_invitable/blob/bddef56c5e5cd37fb9b322de7047b5ab28e94ce4/lib/devise_invitable/inviter.rb)的源代码来了解如何使用此参数。一个重要的部分：

```
# Return true if this user has invitations left to send
def has_invitations_left?
  if self.class.invitation_limit.present?
    if invitation_limit
      return invitation_limit > 0
    else
      return self.class.invitation_limit > 0
    end
  else
    return true
  end
end 
```

# iphone - 相对于另一个动态创建的标签对齐标签

> ID：14082317
> 
> 赞同：1
> 
> 时间：2012-12-29T13:54:22.890
> 
> 标签：iphone, xcode, cocoa-touch, ios6, alignment

我正在编写一个动态创建标签并相对于创建的最后一个标签重新对齐标签的代码。我正在使用以下代码来创建标签的高度并调整其大小以适应内容。

```
// Create label
UILabel *label =  [[UILabel alloc] initWithFrame:CGRectZero];
label.text = SomeVariatingTextContent;
[self.scrollView addSubview:label];
// Resize Label
UIFont* font = label.font;
CGSize constraintSize = CGSizeMake(label.frame.size.width, MAXFLOAT);
CGSize labelSize = [label.text sizeWithFont:font constrainedToSize:constraintSize lineBreakMode:UILineBreakModeTailTruncation];
label.frame = CGRectMake(label.frame.origin.x, label.frame.origin.y, 280, labelSize.height); 
```

如何找到前一个标签的标识符，以便我可以重新对齐正在创建的下一个标签，使其始终比创建的前一个标签低 8 点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T14:08:00.447

尝试使用 CGRectGetMinY 等（看这里：[CGGeometry Reference](https://developer.apple.com/library/mac/#documentation/graphicsimaging/reference/CGGeometry/Reference/reference.html)以获取先前 UILabel 的边缘，例如：

```
CGFloat *yPos =  CGRectGetMinY(previousLabelRect);
nextLabel.frame = CGRectMake(x,yPos+8,width,height); 
```

**编辑**

我可以假设最后一个 UILabel 是您添加到视图中的最后一个，因此您可以：

```
 UILabel lastLabel = [[self.view subviews]lastObject]; 
```

Br 请注意，如果您稍后添加了其他子视图，则需要过滤数组以仅获取 UILabels。如果顺序是问题，您可以获取所有标签并检查它们的 y 位置以获取最后一个。

另一种方法是在创建标签的循环末尾保存指向 UILabel 的指针，并在每次创建新标签时更新该指针。

# c# - 在不注入 dll 的情况下注入文本进行处理

> ID：14082318
> 
> 赞同：0
> 
> 时间：2012-12-29T13:54:33.510
> 
> 标签：c#, graphics

> **可能重复：**
> [有没有办法将应用程序覆盖在全屏程序上？](https://stackoverflow.com/questions/10339295/is-there-a-way-to-overlay-an-application-over-a-full-screened-program)

是否可以在 C# 中注入要处理的文本（例如 fraps），但不使用任何 .dll 注入？

提前感谢您的回复。

@update "A text" 表示一些快速刷新的标签或其他东西，它将显示信息，例如：

```
Name:Test
Pos: x=123,y=456,z=0
Level: Unknown
Something..... 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T13:57:32.297

您可以使用自动化将键盘操作等发送到另一个程序。否则，如果没有暴露的 API，那么事情看起来很惨淡。有关用于发送击键的方法的概述，[请参阅此问题。](https://stackoverflow.com/questions/2744111/sending-keystrokes-to-a-program)

**编辑**：您要的不是注入，而是覆盖。您要做的是控制显示缓冲区，以便您的叠加层始终具有比正在呈现的任何内容更高的 z-index。看看[这个答案](https://stackoverflow.com/questions/10339295/is-there-a-way-to-overlay-an-application-over-a-full-screened-program)

# ios - 如何在文本视图中输入文字和图像？

> ID：14082324
> 
> 赞同：0
> 
> 时间：2012-12-29T13:56:25.853
> 
> 标签：ios, textview, core-text

我想制作一个视图（可能是文本视图）可以让我输入文字和图像，如情感。有什么办法吗？我听说过 DTRichTextEditor，但它似乎并不便宜。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T14:04:57.263

为什么不使用 UIWebView 并将内容加载为 HTML。然后使用真实的图像`<img>`标签来表示表情符号。

另一种方法是对每个表情符号使用 UILabel 并将其背景设置为图像，例如：

```
myLabel.backgroundColor = [UIColor colorWithPatternImage:[UIImage imageNamed:@"emoticon"]]; 
```

尝试将图像放入 UItextView 肯定会涉及黑客攻击，这可能会随着 ios 版本的更改而在您的应用程序中引入崩溃。

我希望这有帮助！

# android - Android 自定义相机照片未显示在图库中

> ID：14082326
> 
> 赞同：1
> 
> 时间：2012-12-29T13:56:47.697
> 
> 标签：android, android-camera

我正在创建自定义 android 相机布局。

我使用了来自[http://developer.android.com/guide/topics/media/camera.html#basics](http://developer.android.com/guide/topics/media/camera.html#basics)的信息。除了一件事，一切都很好。

该照片未显示在手机的图库中。方法是：

```
private Camera.PictureCallback cameraCallback = new Camera.PictureCallback() {

    @Override
    public void onPictureTaken(byte[] data, Camera camera) {

        File pictureFile = getOutputMediaFile();
        if (pictureFile == null){
            Log.d(Values.APPLICATION_TAG + ACTIVITY_TAG, "Error creating media file, check storage permissions: ");
            return;
        }

        try {
            FileOutputStream fos = new FileOutputStream(pictureFile);
            fos.write(data);
            fos.flush();
            fos.close();
            createPhotoAndShowPreview(Uri.fromFile(pictureFile));
        } catch (FileNotFoundException e) {
            Log.d(Values.APPLICATION_TAG + ACTIVITY_TAG, "File not found: " + e.getMessage());
        } catch (IOException e) {
            Log.d(Values.APPLICATION_TAG + ACTIVITY_TAG, "Error accessing file: " + e.getMessage());
        }
    }
};

private static File getOutputMediaFile(){

    File galleryDir = new File(Environment.getExternalStoragePublicDirectory(
            Environment.DIRECTORY_PICTURES), "MyCameraApp"); 
    if (!galleryDir.exists()) {
        if (!galleryDir.mkdir())
        {
            Log.d(Values.APPLICATION_TAG, "failed to create directory");
            return null;
        }
    }

    String timeStamp = new SimpleDateFormat("yyyyMMdd_HHmmss").format(new Date());
    File mediaFile;
    mediaFile = new File(galleryDir.getPath() + File.separator +
            "gfranq_"+ timeStamp + ".jpg");

    return mediaFile;
} 
```

方法 createPhotoAndShowPreview(Uri.fromFile(pictureFile)); 工作正常，文件在运行时存在，我可以使用它，但是当我退出应用程序时，库中没有文件。我使用文件管理器检查文件是否被删除，但它没有被删除，退出应用程序后它存在，但系统不识别它是图像。

更新：将手机连接到电脑后，照片出现在画廊中。但是在我将手机与电脑连接并断开连接之前，新照片仍然不会出现在图库中。重启手机也有同样的效果。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T14:20:06.220

您需要发送广播：

context.sendBroadcast(new Intent(Intent.ACTION_MEDIA_SCANNER_SCAN_FILE, Uri.fromFile(imageFile)));

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-03-31T11:39:23.097

```
MediaScannerConnection.scanFile(this, new String[]{file.toString()}, null,
            new MediaScannerConnection.OnScanCompletedListener() {
                public void onScanCompleted(String path, Uri uri) {
                    Log.i("ExternalStorage", "Scanned " + path + ":");
                    Log.i("ExternalStorage", "-> uri=" + uri);
                }
            }); 
```

# html - Firefox 图标字体过粗抗锯齿

> ID：14082329
> 
> 赞同：6
> 
> 时间：2012-12-29T13:56:59.480
> 
> 标签：html, css, firefox, antialiasing

我知道不同的浏览器以不同的方式呈现文本——在某种程度上，我对此很满意。然而，在尝试为一个项目使用图标字体时，Firefox 尤其让我恼火。

本质上，我有一排社交媒体图标，通过@font-face 和一些伪类显示。除了 Firefox 在渲染它们方面有一点问题......

这是它们看起来像 Chrome 与 Firefox 的对比。

**铬 23.0.1271.101 (Mac)**

[http://cl.ly/image/0M3t2S3N2A38/](http://cl.ly/image/0M3t2S3N2A38/)

（完美的）

**火狐 17.0.1 (Mac)**

[http://cl.ly/image/053d2J0J312K](http://cl.ly/image/053d2J0J312K)

（不太完美）

您可能会看到我遇到的问题...

我还检查了其他几个浏览器，看看它是否不仅仅是 firefox。它只是火狐。甚至 IE 也做得更好。

**编码：**

CSS

```
@font-face {
    font-family: 'icomoon';
    src:url('fonts/icomoon.eot');
    src:url('fonts/icomoon.eot?#iefix') format('embedded-opentype'),
    url('fonts/icomoon.svg#icomoon') format('svg'),
    url('fonts/icomoon.woff') format('woff'),
    url('fonts/icomoon.ttf') format('truetype');
    font-weight: normal;
    font-style: normal;
}

[class^="icon-"]:before, 
[class*=" icon-"]:before {
    font-family: 'icomoon';
    font-style: normal;
    speak: none;
    font-weight: normal;
    line-height: 1;
    text-align: center;
}

.icon-flkr:before {
    content: "\2b";
}
.icon-fbk:before {
    content: "\2c";
}
.icon-twitter:before {
    content: "\3e";
}
.icon-lfm:before {
    content: "\24";
}
.icon-lkdin:before {
    content: "\25";
}
.icon-inst:before {
    content: "\26";
} 
```

HTML

```
<ul id="footer_social_list" class="group">
    <li><a href="#" class="icon-twitter" title="Follow me on Twitter"></a></li>
    <li><a href="#" class="icon-fbk"></a></li>
    <li><a href="#" class="icon-lkdin"></a></li>
    <li><a href="#" class="icon-flkr"></a></li>
    <li><a href="#" class="icon-inst"></a></li>
    <li><a href="#" class="icon-lfm"></a></li>
</ul> 
```

我已经尝试了很多东西来尝试解决这个问题。从用 CSS 改变不透明度；尝试文字阴影；更改@font-face、类和继承样式的权重；使用“数据图标”；甚至确保每个图标都与像素网格对齐。

在 Firefox 中还没有任何改进，我想说除了 IE9 中的 Instagram 图标稍有例外，每个浏览器中的一切看起来都不错。

那么为什么 Firefox 会这样做呢？我能做些什么来让它正常运行吗？

PS：我没有添加 -webkit-font-smoothing: antialiased; 并不是说它无论如何都会影响 Firefox。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-08-13T17:11:25.543

```
-moz-osx-font-smoothing: grayscale; 
```

[See the discussion leading to this new vendor prefixed solution for Firefox.](https://bugzilla.mozilla.org/show_bug.cgi?id=857142)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T02:12:13.567

```
font-weight:normal !important; 
```

这似乎是显而易见的答案，但没有人提到它。很可能你`!important`的锚标签上有一个沿线的某个地方，使它们不会再次被正常加权。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-26T18:53:40.903

这是另一个没有人提到的明显答案：

您所说的在所有浏览器中都会发生：当您在深色背景上使用浅色文本时，文本看起来更“重”。图标字体也是如此……小细节会膨胀。（有 CSS font-smoothing 和 text-rendering 属性可以帮助纠正这个问题，但它们在所有浏览器中的工作方式不一定相同。[见这里。](https://stackoverflow.com/questions/5082632/same-font-yet-its-weight-seems-different-on-different-browsers)）

如果你想要一个较浅的圆形（不使用 SVG）上的深色图标，你可以绕过它的一种方法是使用没有圆圈的图标，然后使用 CSS 创建你自己的圆形背景。

你不会得到真正的淘汰赛（图标实际上不会是圆圈中的负空间，因此按钮后面的任何背景图案都不会通过图标显示），但你会避免深色文本-背景出血。

当然，你也会在旧版本的 IE 中失去你的边界半径......所以**权衡**（咳咳）更重要的是。

# g++ - 找不到 -lgpg 错误

> ID：14082339
> 
> 赞同：2
> 
> 时间：2012-12-29T13:57:56.477
> 
> 标签：g++, makefile, ld, static-linking, dynamic-linking

我正在做一个需要编译源代码的项目。该代码使用 PBC 库（它又需要 GMP，两者都已安装）。Makefile 有这一行：

```
node: node.o $(COMMON_OBJS)
g++ -m32 -g -static -o $@ $^ -L../PBC -lPBC -lpthread -lgnutls -lpbc -lgmp -lgcrypt -lgpg-error -ltasn1 -lz 
```

但是当我运行 make 时，我得到了这个错误：

```
/usr/bin/ld : cannot find -lgpg-error 
```

现在这很令人沮丧，因为我不知道如何解决它。我尝试安装 libgcrypt11-div（在某个站点上看到了建议）。没用。

我注意到 libgpg-error.so 安装在 /usr/lib/i386-linux-gnu/ 中。所以我在 /usr/bin/ 中创建了带有 ln -s 的链接。还是行不通。

添加 -v 开关后：

> `g++ -m32 -g -static -o node node.o application.o networkmessage.o usermessage.o buddy.o buddyset.o systemparam.o bipolynomial.o polynomial.o lagrange.o commitment.o commitmentmatrix.o commitmentvector.o io.o timer.o message.o -L../PBC -lPBC -lpthread -lgnutls -lpbc -lgmp -lgcrypt -lgpg-error -ltasn1 -lz -v`
> 
> `Using built-in specs.`
> `COLLECT_GCC=g++`
> `COLLECT_LTO_WRAPPER=/usr/lib/gcc/i686-linux-gnu/4.6.1/lto-wrapper`
> `Target: i686-linux-gnu`
> `Configured with: ../src/configure -v --with-pkgversion='Ubuntu/Linaro 4.6.1-9ubuntu3' --with-bugurl=file:///usr/share/doc/gcc-4.6/README.Bugs --enable-languages=c,c++,fortran,objc,obj-c++,go --prefix=/usr --program-suffix=-4.6 --enable-shared --enable-linker-build-id --with-system-zlib --libexecdir=/usr/lib --without-included-gettext --enable-threads=posix --with-gxx-include-dir=/usr/include/c++/4.6 --libdir=/usr/lib --enable-nls --with-sysroot=/ --enable-clocale=gnu --enable-libstdcxx-debug --enable-libstdcxx-time=yes --enable-plugin --enable-objc-gc --enable-targets=all --disable-werror --with-arch-32=i686 --with-tune=generic --enable-checking=release --build=i686-linux-gnu --host=i686-linux-gnu --target=i686-linux-gnu`
> 
> `Thread model: posix`
> `gcc version 4.6.1 (Ubuntu/Linaro 4.6.1-9ubuntu3)`
> 
> `COMPILER_PATH=/usr/lib/gcc/i686-linux-gnu/4.6.1/:/usr/lib/gcc/i686-linux-gnu/4.6.1/:/usr/lib/gcc/i686-linux-gnu/:/usr/lib/gcc/i686-linux-gnu/4.6.1/:/usr/lib/gcc/i686-linux-gnu/ LIBRARY_PATH=/usr/lib/gcc/i686-linux-gnu/4.6.1/:/usr/lib/gcc/i686-linux-gnu/4.6.1/../../../i386-linux-gnu/:/usr/lib/gcc/i686-linux-gnu/4.6.1/../../../../lib/:/lib/i386-linux-gnu/:/lib/../lib/:/usr/lib/i386-linux-gnu/:/usr/lib/../lib/:/usr/lib/gcc/i686-linux-gnu/4.6.1/../../../:/lib/:/usr/lib/`
> 
> `COLLECT_GCC_OPTIONS='-m32' '-g' '-static' '-o' 'node' '-L../PBC' '-v' '-mtune=generic' '-march=i686'`
> `/usr/lib/gcc/i686-linux-gnu/4.6.1/collect2 --build-id --no-add-needed --as-needed -m elf_i386 --hash-style=gnu -static -z relro -o node /usr/lib/gcc/i686-linux-gnu/4.6.1/../../../i386-linux-gnu/crt1.o /usr/lib/gcc/i686-linux-gnu/4.6.1/../../../i386-linux-gnu/crti.o /usr/lib/gcc/i686-linux-gnu/4.6.1/crtbeginT.o -L../PBC -L/usr/lib/gcc/i686-linux-gnu/4.6.1 -L/usr/lib/gcc/i686-linux-gnu/4.6.1/../../../i386-linux-gnu -L/usr/lib/gcc/i686-linux-gnu/4.6.1/../../../../lib -L/lib/i386-linux-gnu -L/lib/../lib -L/usr/lib/i386-linux-gnu -L/usr/lib/../lib -L/usr/lib/gcc/i686-linux-gnu/4.6.1/../../.. node.o application.o networkmessage.o usermessage.o buddy.o buddyset.o systemparam.o bipolynomial.o polynomial.o lagrange.o commitment.o commitmentmatrix.o commitmentvector.o io.o timer.o message.o -lPBC -lpthread -lgnutls -lpbc -lgmp -lgcrypt -lgpg-error -ltasn1 -lz -lstdc++ -lm --start-group -lgcc -lgcc_eh -lc --end-group /usr/lib/gcc/i686-linux-gnu/4.6.1/crtend.o /usr/lib/gcc/i686-linux-gnu/4.6.1/../../../i386-linux-gnu/crtn.o`
> `/usr/bin/ld: cannot find -lgpg-error`
> `collect2: ld returned 1 exit status`
> `make: *** [node] Error 1`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T16:06:38.707

尝试移除`-static`开关。

如果你想 -static 你需要将它包裹在你想要静态的库周围并让其他库保持动态，否则 gcc/g++ 将尝试进入每个库并静态编译所有内容，这可能是不可能的。

请参阅此 SO 帖子，[gcc 中共享库函数的静态链接](https://stackoverflow.com/questions/725472/static-link-of-shared-library-function-in-gcc)。

例如静态编译苹果汁，而其他一切都保持动态：

```
gcc object1.o object2.o -Wl,-Bstatic -lapplejuice -Wl,-Bdynamic -lorangejuice 
```

# sql - Postgres 9.1 - 为行组编号

> ID：14082341
> 
> 赞同：6
> 
> 时间：2012-12-29T13:58:03.170
> 
> 标签：sql, postgresql

我有一些代表不同“行动”的数据。这些“动作”共同构成一个“事件”。

数据如下所示：

```
 EventID   |   UserID   |   Action   |        TimeStamp
--------------+------------+------------+-------------------------
       1      |    111     |   Start    |   2012-01-01 08:00:00
       1      |    111     |   Stop     |   2012-01-01 08:59:59
       1      |    999     |   Start    |   2012-01-01 09:00:00
       1      |    999     |   Stop     |   2012-01-01 09:59:59
       1      |    111     |   Start    |   2012-01-01 10:00:00
       1      |    111     |   Stop     |   2012-01-01 10:30:00 
```

如您所见，每个“事件”都由一个或多个“动作”（或我认为的“子事件”）组成。

**我需要识别每个“子事件”并给它一个标识符。**这就是我要找的：

```
 EventID   |   SubeventID   |   UserID   |   Action   |        TimeStamp
--------------+----------------+------------+------------+-------------------------
       1      |       1        |    111     |   Start    |   2012-01-01 08:00:00
       1      |       1        |    111     |   Stop     |   2012-01-01 08:59:59
       1      |       2        |    999     |   Start    |   2012-01-01 09:00:00
       1      |       2        |    999     |   Stop     |   2012-01-01 09:59:59
       1      |       3        |    111     |   Start    |   2012-01-01 10:00:00
       1      |       3        |    111     |   Stop     |   2012-01-01 10:30:00 
```

我需要一些可以开始计数的东西，但只有在某些列具有特定值时才会增加（比如“Action”='Start'）。

我一直在尝试为此使用窗口函数，但收效甚微。我似乎无法找到我认为可行的解决方案......有什么想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-29T14:11:23.650

如果您有一些可以排序的字段，则可以使用以下查询（未经测试）：

```
SELECT 
    sum(("Action" = 'Start')::int) OVER (PARTITION BY "EventID" ORDER BY "Timestamp" ROWS UNBOUNDED PRECEDING)
FROM 
    events 
```

请注意，如果第一个 SubEvent 不以 Start 开头，它的事件 id 将为 0，这可能不是您想要的。

* * *

您也可以使用`COUNT()`代替`SUM()`：

```
SELECT 
    EventID 
  , COUNT(CASE WHEN Action = 'Start' THEN 1 END) 
        OVER ( PARTITION BY EventID 
               ORDER BY TimeStamp 
               ROWS UNBOUNDED PRECEDING ) 
      AS SubeventID 
  , UserID 
  , Action 
FROM 
    tableX AS t ; 
```

SQL-Fiddle 上的测试：**[测试](http://sqlfiddle.com/#!1/2c938/6)**

# java - facebook 登录 使用 javascript sdk 的服务器端应用程序

> ID：14082343
> 
> 赞同：1
> 
> 时间：2012-12-29T13:58:19.023
> 
> 标签：java, javascript, facebook, google-app-engine, facebook-login

我已经在 stackoverflow 中搜索了一个完整的示例或一些博客，这些示例解释了如何使用 javascript sdk 制作 facebook 登录服务器端应用程序，但没有找到任何东西。

我搜索了 developer.facebook.com 网站，我唯一得到的是一个 php 示例[https://developers.facebook.com/docs/howtos/login/server-side-login/](https://developers.facebook.com/docs/howtos/login/server-side-login/)。问题是我必须使用 JavaScript。

我为什么要这样做？原因是我想将文件上传到服务器（google-app-engine（Java Sdk））并使用 facebook 用户 ID 将它们保存在数据库中，并通过他的用户 ID 检索它们。

另一个问题是，如果他动态上传，我该如何调试我的 javascript 代码？代码辅助呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T18:05:30.947

那么我可以帮你解决这个问题。如果你需要使用FB的JS SDK，那么你必须在客户端或浏览器上做所有事情，因为Facebook在服务器端没有任何对Java的支持。

因此，我建议您可以在客户端上对用户进行身份验证，定义访问用户配置文件的范围，一旦通过用户身份验证，您将获得 JSON 对象的响应，您可以使用 ajax 将其发送到 AppEngine 后端。

我正在分享我使用 FB 登录并访问用户的个人资料信息以及相册和视频中的照片的链接。

[http://demositeunicfyp.appspot.com/fb-pictures.html](http://demositeunicfyp.appspot.com/fb-pictures.html)

[http://demositeunicfyp.appspot.com/facebook.html](http://demositeunicfyp.appspot.com/facebook.html)

您可以在浏览器中调试 JS 代码，以查看您从 Facebook API 返回的响应对象类型。

```
$(document).ready(function() {
        // Initializing the Facebook SDK
        FB.init({
            appId : 'XXXXXXXXXXXXXXXX',
            status : true,
            cookie : true,
            xfbml : true,
            oauth : true
        });

        // Method to check if a user is looged in to FB or Not
        FB.getLoginStatus(updateButton);

        $("#logout").live("click", function(event) {
            event.preventDefault();
            // FB.getLoginStatus(updateButton);
            FB.logout(function(response) {
                $("#loginDiv").show();
                $("#logoutDiv").hide();
            });
        });

        $("#fbLoginButton").live("click", function(event) {
            //event.preventDefault();
            FB.getLoginStatus(updateButton);
        });

        function updateButton(response) {
            var button = document.getElementById("fbLoginButton");

            if (response.authResponse) {
                // user is already logged in and connected
                // button.innerHTML = 'Facebook Logout';
                //$("#loginDiv").hide();
                //$("#logoutDiv").show();
                //window.location = '/confirm';

                FB.api('/me', function(response) {
                    $("#userName").text(response.name);
                    $("#userEmail").text(response.email);
                });

            } else {
                // user is not connected to your app or logged out
                // button.innerHTML = 'Facebook Login';

                button.onclick = function() {
                    FB.login(function(response) {
                        if (response.authResponse) {
                            // button.innerHTML = 'Facebook Logout';
                            $("#loginDiv").hide();
                            $("#logoutDiv").show();

                            FB.api('/me', function(response) {
                                $("#userName").text(response.name);
                                $("#userEmail").text(response.email);
                            });
                        } else {
                            //user cancelled login or did not grant authorization hence do nothing
                        }
                    }, {
                        scope : 'email,publish_actions'
                    });
                }
            }
        }
   }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T10:15:49.727

取自 SDK 下载中的 JS.php

```
 <?php

require '../folderTo/facebook.php';

$facebook = new Facebook(array(
  'appId'  => '',
  'secret' => '',
));

// See if there is a user from a cookie
$user = $facebook->getUser();

if ($user) {
  try {
    // Proceed knowing you have a logged in user who's authenticated.
  $user_profile = $facebook->api('me?fields=photos');  } catch (FacebookApiException $e) {
    echo '<pre>'.htmlspecialchars(print_r($e, true)).'</pre>';
    $user = null;
  }
}

?>
<!DOCTYPE html>
<html xmlns:fb="http://www.facebook.com/2008/fbml">
  <body>
    <?php if ($user) { ?>
      Your user profile is
      <pre>
        <?php print htmlspecialchars(print_r($user_profile, true)) ?>
      </pre>
    <?php } else { ?>
      <fb:login-button></fb:login-button>
    <?php } ?>
    <div id="fb-root"></div>
    <script>
      window.fbAsyncInit = function() {
        FB.init({
          appId: '<?php echo $facebook->getAppID() ?>',
          cookie: true,
          xfbml: true,
          oauth: true
        });
        FB.Event.subscribe('auth.login', function(response) {
          window.location.reload();
        });
        FB.Event.subscribe('auth.logout', function(response) {
          window.location.reload();
        });
      };
      (function() {
        var e = document.createElement('script'); e.async = true;
        e.src = document.location.protocol +
          '//connect.facebook.net/en_US/all.js';
        document.getElementById('fb-root').appendChild(e);
      }());
    </script>
  </body>
</html> 
```

这里的工作示例：http: [//slicethegreen.com/examples/js.php](http://slicethegreen.com/examples/js.php)

# javascript - jQuery - 按钮的 hasClass 延迟工作

> ID：14082349
> 
> 赞同：1
> 
> 时间：2012-12-29T13:59:08.787
> 
> 标签：javascript, jquery, twitter-bootstrap

我正在使用引导复选框按钮来拥有一个按钮组。当用户单击其中一个按钮时，它会变为活动状态。

我使用下面的函数来检查哪个按钮是活动的，哪个不是活动的，然后在函数的其余部分使用这些数据。

正如您在 jsfiddle 中看到的那样，结果被延迟了，如果我更改`is`为`was`. 但我需要在我正在使用的函数中进行测试，而不是在下一次调用该函数时进行测试。

有人可以向我解释为什么会发生这种情况以及我的`hasClass`检查对于这种情况是否正确？

HTML：

```
<div class="box btn-group" data-toggle="buttons-checkbox">
    <button data-filter="a" id="a" name="button" type="button" class="btn">A</button>
    <button data-filter="b" id="b" name="button" type="button" class="btn">B</button>
</div>​ 
```

CSS：

```
$(".box").on('click', function(){
    alert("a is " + ($("#a").hasClass("active") ? "active" : "not-active"));
    alert("b is " + ($("#b").hasClass("active") ? "active" : "not-active"));
});​ 
```

[jsfiddle](http://jsfiddle.net/AvXUb/3/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T14:58:33.040

Twitter Bootstrap 自动绑定在`document`级别上工作，这意味着您`click`的级别上的事件`.box`仍然不知道按钮状态的变化。

您可以删除自动绑定，删除`data-toggle`这组复选框的属性，并`.button()`按照[Twitter Bootstrap API](http://twitter.github.com/bootstrap/javascript.html#buttons)中的说明使用。

```
<div class="box btn-group">
    <button data-filter="a" id="a" name="button" type="button" class="btn">A</button>
    <button data-filter="b" id="b" name="button" type="button" class="btn">B</button>
</div>​ 
```

```
$(".box").on('click', '.btn', function(){
    $(this).button("toggle");    
    alert("a is " + ($("#a").hasClass("active") ? "active" : "not active"));
    alert("b is " + ($("#b").hasClass("active") ? "active" : "not active"));
}); 
```

[**看这里。**](http://jsfiddle.net/ye22d/)

# c# - 我不能将一个值从一个类传递到另一个类

> ID：14082358
> 
> 赞同：-1
> 
> 时间：2012-12-29T14:00:22.847
> 
> 标签：c#

我不能将一个值从一个类传递给另一个类，当我尝试时，该值传递给 0 而不是第一个类的值。

我有这个：一个方法将检查人员是否在数据库中，并且变量 IDautor 将获得 id 在数据库中，它将进入 if 子句，然后位置 1 中的数组 id2 将保存值IDautor ...我假装在Artigo类中使用该值，但该值始终为0，我不知道为什么Class Autor

```
 public bool Login(TextBox txtUser, TextBox txtPassword)

    {

        string utl, pass;

        try
        {
            utl = txtUser.Text;
            pass = txtPassword.Text;

            _Sql = "Select Count(IDAutor) From Autor Where uUser = @uUser and Pass = @Pass";

            SqlCommand cmd = new SqlCommand(_Sql, Conn);

            cmd.Parameters.Add("@uUser", SqlDbType.VarChar).Value = utl;
            cmd.Parameters.Add("@Pass", SqlDbType.VarChar).Value = pass;

            Conn.Open();

            IDautor = (int)cmd.ExecuteScalar();                
            if (IDautor > 0)
            {
                MessageBox.Show("Bem Vindo");                        
                Conn.Close();
                id2[1] = IDautor;
                return true;
            }
            else
            {
                MessageBox.Show("Tera que tentar de novo");
                Conn.Close();
                return false;
            }                
        }
        catch(Exception ex)
        {
            MessageBox.Show("ERRO Message: "+ ex);
            Conn.Close();
            return false;
        }
    }

public int[] id2 
    {
        get { return this.id2; }
    } 
```

并尝试将值保存在数组 id2 中并在另一个类中使用该值

类Artigo

```
public string AddArtigo(string newArtigo)
   {
       if (newArtigo == null)
       {
           return "Nao selecionou o PDF desejado. Tente de novo";               
       }
       if (newArtigo != null)
       {
           using (FileStream st = new FileStream(newArtigo, FileMode.Open, FileAccess.Read))
           {
               SqlConnection Conn = new SqlConnection(@"Data Source=.\SQLEXPRESS;AttachDbFilename=C:\Users\Convidado1\Desktop\Aplicaçao C#\Aplicaçao\ITArtiConf\ITArtiConf\Database1.mdf;Integrated Security=True;User Instance=True");

               Autor au = new Autor();

               byte[] buffer = new byte[st.Length];
               st.Read(buffer, 0, (int)st.Length);
               st.Close();

               Conn.Open();
               SqlCommand cmd = Conn.CreateCommand();
               cmd.CommandText = "insert into Artigo (idAutor) values('" + au.id2[1] + "')";
               cmd.ExecuteNonQuery();
               Conn.Close();

               SqlCommand cmd1 = new SqlCommand("UPDATE SomeTable SET Artigo=@Artigo WHERE idAutor =" + au.id2[1], Conn);
               cmd1.Parameters.AddWithValue("@Artigo", buffer);
               Conn.Open();
               int i = cmd1.ExecuteNonQuery();
               Conn.Close();                   
           }
           return "Guardado";
       }

       return "Error";           
   } 
```

au.id2[1] 变为 0 而不是其他类的值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T14:04:42.873

```
Autor au = new Autor(); 
```

这行代码创建了一个新`Author`对象，该对象的所有属性都设置为默认值。在尝试获取值之前，您不会对该对象再调用任何内容`id`，因此它的值为 0。

您应该考虑制作该属性`static`，什么会使它的价值持久。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T14:51:45.133

**将Author**对象传递给另一个类。使用此 Author 对象，您可以访问值。

作者 _author = 新作者（）；

int 值 = _author.id[1];

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T15:01:50.680

最好的方法是不使用`Autor au = new Autor();`，而是更改 的构造函数`Artigo`以接受 an`Autor`并将其或某些属性保存为成员`Artigo`或更改签名`AddArtigo`以接受`Autor`.

所以，要么：

```
Autor au = new Autor();    
au.Login(user, pass); // this should really accept strings and not TextBoxes...
Artigo art = new Artigo(au); // this saves id2[1] as a member somewhere
art.AddArtigo(newArtigo); // why does the Artigo class have an AddArtigo method? 
```

或者

```
Autor au = new Autor();    
au.Login(user, pass);    
Artigo art = new Artigo();
art.AddArtigo(newArtigo, au); 
```

Either way, there are multiple little issues with your solution (from having an array `id2`, to a `Login` method accepting `TextBoxes` and an `Artigo` that adds itself, most likely that code would be better suited as part of the `Artigo` constructor).

# c++ - 需要有关在 VS2010 中运行程序的帮助

> ID：14082359
> 
> 赞同：0
> 
> 时间：2012-12-29T14:00:29.863
> 
> 标签：c++, visual-studio-2010, opencv, compiler-errors

我是 VS201O 和 OpenCV 编程的新手。我正在尝试实现 SIFT 算法。谁能告诉我错误代表什么？如果有人需要整个程序，我会把它发送给他。先感谢您。您的帮助将非常宝贵。

以下是错误：

```
1>------ Build started: Project: sift, Configuration: Debug Win32 ------
1>  sift.cpp
1>c:\users\dell\documents\visual studio 2010\projects\sift\sift\sift.cpp(2): warning            C4627: '#include <iostream>': skipped when looking for precompiled header use
1>          Add directive to 'StdAfx.h' or rebuild precompiled header
1>c:\users\dell\documents\visual studio 2010\projects\sift\sift\sift.cpp(3): warning C4627: '#include "opencv2/core/core.hpp"': skipped when looking for precompiled header use
1>          Add directive to 'StdAfx.h' or rebuild precompiled header
1>c:\users\dell\documents\visual studio 2010\projects\sift\sift\sift.cpp(4): warning C4627: '#include "opencv2/features2d/features2d.hpp"': skipped when looking for precompiled header use
1>          Add directive to 'StdAfx.h' or rebuild precompiled header
1>c:\users\dell\documents\visual studio 2010\projects\sift\sift\sift.cpp(5): warning C4627: '#include "opencv2/highgui/highgui.hpp"': skipped when looking for precompiled header use
1>          Add directive to 'StdAfx.h' or rebuild precompiled header
1>c:\users\dell\documents\visual studio 2010\projects\sift\sift\sift.cpp(83): fatal error C1010: unexpected end of file while looking for precompiled header. Did you forget to add '#include "StdAfx.h"' to your source?
========== Build: 0 succeeded, 1 failed, 0 up-to-date, 0 skipped ========== 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T15:19:51.917

您需要将其`#include <StdAfx.h>`用作项目中每个 .cpp 文件的**第一行**。那是因为 StdAfx.h 是预编译的头文件，一些特殊的规则适用于它。因此，即使您不使用它，也必须包含它。

# c++ - pthread vs intel TBB 以及它们与 OpenMP 的关系？

> ID：14082360
> 
> 赞同：10
> 
> 时间：2012-12-29T14:00:36.980
> 
> 标签：c++, multithreading, pthreads, openmp, intel

对于多线程编程，考虑到与HPC应用程序（MPI）的组合，哪个更好，我们是否可以说，在功能上，Intel TBB（thread building block）是否可以与pthread相媲美？我只在 open mp 方面有经验，但我听说 TBB 和 Pthread 与 open mp 相比提供了更精细的线程控制，但 TBB 或 TBB+OpenMP 与 pthread 相比能否提供类似的功能？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-29T14:19:48.130

pthread 是操作系统基础架构之上的一个瘦包装器。它允许您使用给定的线程主函数和一些同步原语（互斥信号量等）创建线程。`clone(2)`在 Linux 下 pthread 是在系统调用之上实现的。Windows 下的等价物称为`CreateThread`. 所有其他线程的东西都建立在这个基础之上。

英特尔 TBB 是更高级别的，它提供了`parallel_for`类似于`parallel_reduce`OpenMP 的更高级别的构造，但实现为库而不是语言扩展。

OpenMPI 甚至更高级别仍然具有多机分布式基础架构，但它非常老式且有点笨重。

我的建议是先学习 pthread 库，直到您完全理解它，然后再查看更高级别的库。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-29T14:19:00.503

TBB 允许您在本机线程功能之上编写可移植代码，因此它使代码在不同的操作系统架构上更具可移植性。我不认为它比 pthread“更有效”。

我个人没有使用过 open MP，但过去我曾与使用 open MP 的开发人员合作过（作为他们正在使用的处理器的技术专家），它似乎在某些事情上工作得相当好，但其他事情更难在 open mp 中使用而不是编写自己的代码。这完全取决于你在做什么。openmp 的好处之一当然是您可以在没有 openmp 选项的情况下重新编译代码，并且代码可以直接按照您的预期工作 [但当然不会散开]。

使用程序线程方法，您可以更好地控制在哪个线程上发生的事情，是的。但这也意味着更多的工作......

# django - Django：扩展用户模型避免数据库连接

> ID：14082363
> 
> 赞同：0
> 
> 时间：2012-12-29T14:01:02.317
> 
> 标签：django, django-models, django-users

在我的 Django 应用程序中，我需要创建一个带有一些额外字段的用户模型。对于数据库性能，我想避免每次我想访问这些字段时都加入。在数据库级别，我想在用户表上生成一个 ALTER TABLE 来添加这些字段，或者甚至是一个包含应用程序初始化所需的所有字段的 CREATE TABLE 都可以，因为我仍在开发中。

我找到了两种扩展用户模型的解决方案（如下所述），但两者都与我避免加入的选择不一致。

```
models.py (Solution 1)
from django.db import models

class Person(models.Model):
    # Aggregate using a OneToOneField on User
    user = models.OneToOneField(User)
    age = models.PositiveSmallIntegerField()

models.py (Solution 2)
from django.contrib.auth.models import User

class Person(User):
     # Inheriting from User
     age = models.PositiveSmallIntegerField() 

SQL (Solution 1)
/* Aggregate using a OneToOneField on User */
BEGIN;
CREATE TABLE "people_person" (
 "id" integer NOT NULL PRIMARY KEY,
 "user_id" integer NOT NULL UNIQUE REFERENCES "auth_user" ("id"),
 "age" smallint unsigned NOT NULL
);
 COMMIT;

SQL (Solution 2)
/* Inheriting from User */
BEGIN;
CREATE TABLE "people_person" (
 "user_ptr_id" integer NOT NULL PRIMARY KEY REFERENCES "auth_user" ("id"),
 "age" smallint unsigned NOT NULL
);
 COMMIT; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T14:11:02.543

从 django 1.5 开始，可以替换用户模型而不是扩展它。

[https://docs.djangoproject.com/en/dev/releases/1.5/#configurable-user-model](https://docs.djangoproject.com/en/dev/releases/1.5/#configurable-user-model)

在 django 1.4 或更早的版本中，用户的“profile”属性会获得一些特殊的缓存，这可能足以满足您的要求，也可能不够好。

# php - is_callable 通过 __autoload 加载“pcu2phmmr6pam3”

> ID：14082365
> 
> 赞同：1
> 
> 时间：2012-12-29T14:01:15.073
> 
> 标签：php, autoload

我遇到了一个奇怪的问题。在将其上传到我的主机服务器之前，我正在 xampp 服务器上开发我的网站 localhost。我终于完成了我网站的基本组件，这样它就可以加载主页了。一切都按计划进行。

所以我决定将它上传到主机服务器，然后设置 MySQL 凭据，现在它应该可以工作了。嗯..不，它没有。空白页。

所以我戴上手套，开始用随机表达式挖掘代码， `echo 'test';`这样我就可以跟踪发生了什么。它似乎运行得很好，直到`is_callable()`被执行。

`is_callable()`应该运行`__autoload($class)`，所以我尝试了`var_dump($class)`

它给了我这个结果：

```
string(11) "Initializer" 
string(8) "Database" 
string(14) "PageController" 
string(14) "BaseController" 
string(14) "pcu2phmmr6pam3" 
string(14) "pcu2phmmr6pam3" 
```

现在，除了最后两个之外，这里列出的每个类都应该在那里。我**不**知道那个名字是从哪里来的，因为它不是我在任何地方设置的字符串。

谷歌向我展示的唯一结果`pcu2phmmr6pam3`是另一个有类似问题的网站。

现在发生了*真正*奇怪的事情，我的自动加载函数如下所示：

```
function __autoload($class) {
    var_dump($class);
    if (file_exists(ROOT_PATH . DS . 'site' . DS . 'class' . DS . $class . '.class.php')) {
        require_once(ROOT_PATH . DS . 'site' . DS . 'class' . DS . $class . '.class.php');
    } else if (file_exists(ROOT_PATH . DS . 'site' . DS . 'controller' . DS . $class . '.class.php')) {
        require_once(ROOT_PATH . DS . 'site' . DS . 'controller' . DS . $class . '.class.php');
    } else if (file_exists(ROOT_PATH . DS . 'site' . DS . 'model' . DS . $class . '.class.php')) {
        require_once(ROOT_PATH . DS . 'site' . DS . 'model' . DS . $class . '.class.php');
    } else{
        throw new Exception('Class `' . $class . '` could not be loaded!');
    }
} 
```

它应该加载的每个类都已加载。如果我想创建一个不存在的类，那么它会引发异常。

但是对于`pcu2phmmr6pam3`“类”，情况也并非如此。没有抛出异常，现在屏幕上打印了错误，即使我已经设置`error_reporting(E_ALL)`

这是周围的代码`is_callable()`：

```
 $controllerName = ucfirst($this->structure) . 'Controller';
    $action = strtolower(((!empty($this->uri[1]))?$this->uri[1]:'index'));

    if (is_callable(array($controllerName, $action))) {
        $controller = new $controllerName($this->uri, $this->database, $this->structure, $action, $page);
        $controller->$action();
    } else if (is_callable(array($controllerName, 'index'))) {
        $controller = new $controllerName($this->uri, $this->database, $this->structure, 'index', $page);
        $controller->index();
    } else {
        $controller = new NotfoundController($this->uri, $this->database, 'Notfound', 'index', $page);
        $controller->index();
    } 
```

我可以给你的最后一点信息：

我的 localhost xampp 服务器运行 PHP 5.4.7，我的主机服务器运行 PHP 5.3.20。

* * *

解决了，不知道奇怪的类名是如何出现的，如果有人知道，我想知道为什么:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-12-17T14:12:14.087

我在调用静态方法时遇到了类似的问题。（与 相同`spl_autoload_register()`）

```
function __autoload ($className) {
  echo $className."\n";
}

class ClassName {
  function functionName () {
  }
}

//calls __autoload twice with class name 'a22h1pd_t'
is_callable( array('ClassName', 'functionName') );

//doesn't call __autoload
is_callable('ClassName::functionName'); 
```

看这个最小的例子很明显。缺少`static`关键字 for 。`functionName`添加它解决了我的问题，两种语法都按预期运行。

# windows - Windows 完全重定向键盘输入

> ID：14082366
> 
> 赞同：2
> 
> 时间：2012-12-29T14:01:32.687
> 
> 标签：windows, redirect, keyboard

有带 2 个 USB 键盘 KeyboardA 和 KeyboardB 的 PC

User1 在 KeyboardA 上工作。

有时 User2 在 KeyboardB 上键入。

任务：来自 KeyboardB 的所有输入都重定向到文件。

如果我使用 SetWindowsHookEx 我可以挂钩输入和停止消息，但无法检测到 KeyboardA 或 KeyboardB（有没有办法检测到什么键盘？）

如果我使用 RegisterRawInputDevices，我会检测到 KeyboardA 或 KeyboardB，但无法停止消息，并且来自 KeyboardB 的输入会转换为 User1 界面（有办法停止消息吗？）。

可能我需要另一种将数据从键盘重定向到特定位置的方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-03T10:28:14.507

我的解决方案：

1.  使用 SetWindowsHookEx 阻止所有输入

2.  在 RawInput 中确定键盘

3.  如果是键盘在活动窗口中重新发送输入

4.  如果是 KeyboardB 重定向输入

5.  对于第 1 项中的禁用块，我检查 LLKHF_INJECTED 上的 KeyboardHookStruct.Flags 而不是块

[细节](http://ase.com.ua/?p=130)

# jquery - jQuery 查看器坐标 onZoom

> ID：14082367
> 
> 赞同：0
> 
> 时间：2012-12-29T14:02:00.707
> 
> 标签：jquery, zooming

我一直在使用[jQuery iviewer 插件](https://github.com/can3p/iviewer)来做一些图像处理。我可以`zoom/location`使用`onClick(ev, point)`事件处理程序保存图像的状态。处理程序返回用户单击位置的坐标。由此，我可以存储用户选择的坐标和缩放级别。我正在调用以下内容：

```
$('#image-container').iviewer('set_zoom', zoom, false, coords); 
```

这将放大并移动到用户保存的正确位置。

现在，如果用户使用鼠标滚动放大图像，我正在尝试执行类似的操作。该`afterZoom(zoom)`方法仅返回缩放级别。我正在尝试使用缩放级别和坐标保存图像的状态。我在代码中注意到，如果你打电话

```
coords = $('#image-container').iviewer('info', 'coords'); 
```

这将返回任何给定时间的坐标。但是，返回的坐标是负值。为什么他们是消极的？我似乎无法弄清楚如何将这些坐标转换为适当的值，以便我可以将图像移动和缩放到用户保存的位置。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-01T15:19:43.550

我找到了比使用这个库更好的解决方案。决定使用 OpenLayers 来提供缩放/平移功能。

# java - Eclipse RCP：如何管理用户对资源的访问权限？

> ID：14082368
> 
> 赞同：3
> 
> 时间：2012-12-29T14:02:20.847
> 
> 标签：java, eclipse, rcp, emf

Eclipse 生态系统中有没有办法管理对资源的访问权限？

我需要 Linux 文件系统权限之类的东西来允许/拒绝访问我的 Eclipse RCP 应用程序中的数据。IE：

*   用户和组管理

*   登录管理

*   我的资源的读写权限管理（即我的数据库记录）

*   基于 EMF（它不是强制性的，但非常有用）

我可以从头开始开发，但我认为这是一个普遍的需求，所以我想也有一些事情要做。

还是我错了？

谢谢。

*编辑：主题固定。对不起*

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T18:21:06.247

我不知道 Eclipse 中有一种通用的授权、身份验证和数据安全解决方案，但是您可以通过多种方式构建自己的解决方案。

[在Eclipse Bugzilla](https://bugs.eclipse.org/bugs/show_bug.cgi?id=201052)中，对使用 Eclipse RCP 为 UI 元素实现基于角色的访问控制的不同方法进行了冗长的讨论。[本文](http://www.ibm.com/developerworks/library/os-ecl-rcpsec/index.html?ca=drs)是一个示例，说明如何使用 Eclipse 扩展点来处理授权。

使用登录对话框进行身份验证的最佳方式是什么取决于您的 Eclipse 版本。这是在 Eclipse e4 中构建样式登录对话框的[一种复杂方法。](http://www.toedter.com/blog/?p=896)

# java - 如何避免在android中连续单击相同按钮的按钮

> ID：14082372
> 
> 赞同：1
> 
> 时间：2012-12-29T14:02:44.823
> 
> 标签：java, android, eclipse

我想避免在同一个按钮上连续单击事件（即）连续单击同一个按钮

不管它是否可能

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T14:09:36.810

是的，有可能以不同的方式：

1）第一种方法：使用布尔变量并在需要时更新它：

```
boolean isClickable = true;
Button btn;
// other declarations.. 
```

**// 在 onCreate 方法中：**

```
btn = (Button) findViewById(R.id.btn);
btn.setOnClickListener(this); 
```

**`onClick()`方法 ：**

```
@Override
public void onClick(View v) {
  if(isClickable) {
      //this code will be executed only when you set the boolean isClickable to true
//your code here
  }
} 
```

当您想停用时，请单击按钮；只需将布尔值设置为 false ：

isClickable = false;

2）第二种方法：

View 上有一种方法可以让您的按钮不可点击；然后停用您的按钮上的侦听器，因此没有对象会像这样侦听单击您的按钮的事件：

```
 btn.setClickable(false);
    btn.setOnClickListener(null); 
```

***注意：***当您想再次单击按钮时，只需将侦听器设置为此并使其再次可单击（对于第二种方法）：

```
btn.setClickable(true);
btn.setOnClickListener(this); 
```

或者只是更新布尔 isClickable 的值（对于第一种方法）

```
isClickable = true; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T15:29:04.457

当您想要禁用此事件的处理时，您可以将 onClickListener 设置为 null，并将其设置回您之前拥有的相同侦听器以重新启用它。

当然，正如 Houcine 所写的那样，有很多解决方案。

# javascript - 合并 2 个数组而不使用 concat()

> ID：14082376
> 
> 赞同：-1
> 
> 时间：2012-12-29T14:03:54.537
> 
> 标签：javascript, arrays, merge

> **可能重复：**
> [添加两个数组而不使用 concat 方法](https://stackoverflow.com/questions/5240335/add-two-arrays-without-using-the-concat-method)

我想在不使用 concat() 函数的情况下在 javascript 中合并 2 个数组。

我试图通过推动来做到这一点`indexOf`

但它不工作也许我输入错了`array1.push(indexOf(array2))`。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T14:09:19.837

从[添加两个数组而不使用 concat 方法](https://stackoverflow.com/questions/5240335/add-two-arrays-without-using-the-concat-method)

```
>>> var x = [1, 2, 3], y = [4, 5, 6];
>>> x.push.apply(x, y) // or Array.prototype.push.apply(x, y)
>>> x
[1, 2, 3, 4, 5, 6] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T14:06:45.187

遍历array2并推送array1中的项目。

```
for(var k=0; k < array2.length; k++){

    array1.push(array2[k]);
} 
```

如果您不想修改array1。创建新数组。

```
var merged_array = [];
    for(var k=0; k < array1.length; k++){    
        merged_array .push(array2[k]);
    }

   for(var k=0; k < array2.length; k++){    
        merged_array .push(array2[k]);
    }
console.log(merged_array ); 
```

# java - Java中的“线程Main中的异常......”错误

> ID：14082377
> 
> 赞同：-3
> 
> 时间：2012-12-29T14:03:59.023
> 
> 标签：java, exception

我真的是 Java 的新手，但我正在尝试使用这个程序。这是一个执行基本数学计算的程序，但需要用户输入。

```
import java.io.*;  
import java.util.Scanner;  

public class Math 
{
public static void main(String[] args) 
    {
    BufferedReader br = new BufferedReader(new InputStreamReader(System.in)); 

        Scanner in = new Scanner(System.in);  

        int sa1, sa2, ss1, ss2, sm1, sm2, s;  
    boolean c = false;  
    double sd1, sd2;  

        while(c==false)  
        {
        System.out.print("Do you want to: \n[1] Add. \n[2] Subtract.  \n[3] Multiply.  \n[4] Divide. \n[5] Exit \nPlease insert an option number below and press enter:  ");  
        s = in.nextInt();  

        if (s==1)  
            {
            System.out.print("You have chosen option 1 \nPlease enter your first number: ");  
            sa1 = in.nextInt();  
            System.out.print("Please enter your second number: ");  
            sa2 = in.nextInt();  
            System.out.print(sa1+ " + " +sa2+ " = " +(sa1+sa2));  
            }
        if (s==2)  
            {
            System.out.print("You have chosen option 2 \nPlease enter your first number: ");  
            ss1 = in.nextInt();  
            System.out.print("Please enter your second number: ");  
            ss2 = in.nextInt();  
            System.out.println(ss1+ " - " +ss2+ " = " +(ss1-ss2));  
            }
        if (s==3)
            {
            System.out.print("You have chosen option 3 \nPlease enter your first number: ");  
            sm1 = in.nextInt();  
            System.out.print("Please enter your second number: ");  
            sm2 = in.nextInt();  
            System.out.println(sm1+ " x " +sm2+ " = " +(sm1*sm2));  
            }
        if (s==4)       
            {       
            System.out.print("You have chosen option 4 \nPlease enter your first number: ");  
            sd1 = in.nextDouble();  
            System.out.print("Please enter your second number: ");  
            sd2 = in.nextDouble();  
            System.out.println(sd1+ " divided by " +sd2+ " = " +(sd1/sd2));    
            }       
            if(s>=6)  
            {
            System.out.println("You have entered an incorrect option");    
            }
        System.out.print("Would you like to try again? (Y/N): ");   
        String ans = in.nextLine();//prob with this line   
        char ans1 = ans.charAt(0);//or this line  
            if (ans1=='N' || ans1=='n')  
            {
            c = true;   
            }
            if(s==5)   
            {
            c = true;  
            }       
        } 

    }

} 
```

当我编译它时，我收到一个错误：线程“主”java.lang.StringIndexOutOfBoundsException 中的异常：字符串索引超出范围：0 at java.lang.String.charAt(Unknown Source) at Math.main(Math.java:58 )

我试过到处寻找答案。谁能帮我这个？它需要能够从用户那里读取“Y”或“N”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T14:10:56.103

运行它时会出现异常。不是在编译时。错误消息说：

> 您正在尝试获取字符串索引 0 处的字符，但该字符串没有索引 0。此异常发生在 Main.java 的第 58 行。

在索引 0 处没有字符的字符串是空字符串。

这可能会发生，因为您从 SYStem.in() 读取的最后一件事是一个数字，并且读取一个数字不会消耗后面的行尾。在读取用户的“是”或“否”之前添加对 readLine() 的调用。并且不要假设用户会做你告诉他做的事情。这几乎不是真的。验证您读取的输入。

# php - 为什么 MySQL 中的连接太多

> ID：14082378
> 
> 赞同：2
> 
> 时间：2012-12-29T14:04:15.233
> 
> 标签：php, mysql, cakephp, connection

最近我发现我的 MySQL 数据库中有太多的连接：

```
mysql> show status like 'Conn%';
+---------------+-------+
| Variable_name | Value |
+---------------+-------+
| Connections   | 39    |
+---------------+-------+
1 row in set (0.00 sec)

mysql> show full processlist;
+----+-------+-----------+--------+---------+------+-------+-----------------------+
| Id | User  | Host      | db     | Command | Time | State | Info                  |
+----+-------+-----------+--------+---------+------+-------+-----------------------+
| 38 | enrmr | localhost | cakedb | Query   |    0 | NULL  | show full processlist |
+----+-------+-----------+--------+---------+------+-------+-----------------------+ 
```

我最近安装了 CakePHP，每次刷新主页 (F5) 时，连接数都会加一。此外，如果我再次重新启动 mysql，连接数仍然是 39。

我的 netstat 输出

```
netstat -n -a | grep 3306
tcp        0      0 127.0.0.1:3306          0.0.0.0:*               ESCUCHAR 
```

我想我有类似“mysql 僵尸连接”之类的东西。我怎么能杀了他们？以及每次刷新网页时如何停止创建新连接？（我可以只有一个连接吗？）谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-29T14:21:15.640

首先，`Connections`是一个增量计数器，它不是当前连接。它是与 MySQL 实例建立和/或关闭的连接总数。

如果您想查看当前连接`Threads_connected`，而不是`Connections`.

其次，39个连接并不多，即使是连接的线程总数。这一切都取决于应用程序，尽管只有一个 CakePHP 实例可能只使用一个线程。

# linux - 将图像从 sRGB 转换为索引。调色板约为 400 种颜色，最终图像最多使用 70 种颜色

> ID：14082380
> 
> 赞同：1
> 
> 时间：2012-12-29T14:04:27.710
> 
> 标签：linux, scripting, imagemagick, gimp

**我想做的事：**

我想将图像更改为索引，提供颜色映射，并将图像中的最大颜色数设置为提供的 400 中的 70。我希望以某种基于文本的格式导出最终图像。

**到目前为止我所拥有的：**

我在 excel 电子表格中将调色板作为约 400 个十六进制值及其 RGB 等效值的文本列表。我可以创建所需的两种格式（十六进制或 RGB）中的任何一种的 csv 或制表符分隔文件。使用 imagemagik，`-remap`参数将进行调色板转换，`-color`参数将颜色数限制为 70。如果索引图像保存为 bmp，我可以轻松地将 BMP 导入 c++/python/matlab/octave 并对数组进行一些操作并将其写入文本文件。

**我被困在哪里：**

我正在努力有效地将基于文本的 ascii 值列表转换为可以提供给`-remap`参数的漂亮颜色图图像。我知道我可以通过煞费苦心地创建图像并在颜色图中为每种颜色制作一个像素来手动创建一个，但必须有更好的方法！

**其他的东西：**

如果您对我上面提到的过程有任何其他建议，或者关于如何更好/更快/更有效地做到这一点的任何建议，我全都听好了！

# html - 使用 HTML 输入元素（type="submit"），我们如何自定义 GET 字段？

> ID：14082381
> 
> 赞同：0
> 
> 时间：2012-12-29T14:04:32.743
> 
> 标签：html, input, get

使用`<form method="get">`包含`<input type="submit">`元素的元素，我们可以有一种方法来获取包含元素指定的某些字段的网页`<input type="text" name="studentId">`，但是我可以自定义这些字段吗？

例如：我总是想`action=true`在 GET url 中添加一个，让 URL 像这样：`http://example.com/?studentId=123&action=true`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T14:06:33.717

利用`<input type="hidden" name="action" value="true" />`

在你的表格里面。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T14:06:59.083

您可以添加一个隐藏的表单字段，尽管名称`action`不是一个好名称，因为`form`它有一个`action`属性，并且在编写表单脚本时此名称可能会发生冲突：

```
<input type="hidden" id="something" name="something" value="somthingelse" /> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T14:14:49.453

```
 <div id="gbqffd">
   <input type="hidden" value="en" name="h1">
   <input type="hidden" value="d" name="tbo">
   <input type="hidden" value="search" name="output">
   <input type="hidden" value="psy-ab" name="sclient">
 </div> 
```

谷歌总是有答案；在这种情况下，我不必进行搜索，只需查看源代码 :)

# android - 如何从 android 应用程序上使用的 sqlite 获取日期

> ID：14082382
> 
> 赞同：-3
> 
> 时间：2012-12-29T14:04:39.603
> 
> 标签：android, string, sqlite, date

```
 tv=(TextView)findViewById(R.id.textView1);
    SQLiteDatabase sqLiteDatabase = SQLiteDatabase.openOrCreateDatabase("/sdcard/assets.db", null);
    Cursor c=sqLiteDatabase.rawQuery("select datetime('now')", null);       
    if(c.moveToFirst()){
            tv.setText(c.getString(0));
    }
    tv.setText("1234");
    c.close();
    sqLiteDatabase.close(); 
```

我编写了这段代码来操作`SQLite`数据库以获取当前日期并在 textView 中显示日期。当我运行代码时，它没有显示错误，但最终结果显示 sql 状态`select datetime('now')`没有返回当前日期。textView 显示“1234”但不显示日期。

请告诉我代码有什么问题，或者这种方法是否是错误的方法。ps我知道如何使用java日历获取日期，这个问题只询问我是否可以通过查询SQLite数据库直接获取日期。

感谢帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T14:09:59.597

将您的代码更改为：

```
if(c.getCount() >0)

  c.moveToFirst();

  tv.setText(c.getString(0));

 }
 else{
     tv.setText("1234"); 
  }
    c.close();
    sqLiteDatabase.close(); 
```

把 last `tv.setText`放在 else 里面。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T17:32:50.970

为了处理日期，请尝试以下方法

SQLite 表中归档的日期将为 TEXT，日期数据应存储为“2012-12-31 00:12:00”格式，比较不会给您带来麻烦，如果我们认为字段是 date_from 和 date_to 并且我们正在存储当前日期在 to_date 那么我们应该得到当前日期如下和

```
 SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss");
    String to_date = sdf.format(new Date()); 
```

并且 SQL 查询应该是

```
crs = db.rawQuery(
  "SELECT _id, date_from, date_to, done_or_not, list_name " +
  "FROM list_tbl " +
  "WHERE " +
  "date_from <= Datetime('"+to_date+"') AND date_to >= Datetime('"+to_date+"')", null); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T14:18:14.470

是笑话吗？在textview中设置日期后，在textview中重写1234，看不到日期是正常的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-29T14:37:02.793

if 之后没有 else 表达式，这是你的问题。

尝试这个：

```
 tv=(TextView)findViewById(R.id.textView1);
    SQLiteDatabase db = this.getWritableDatabase();
    Cursor cursor = null;
    try{ 
        cursor = db.rawQuery(selectQuery, null);

        // looping through all rows and adding to list or get object
        if (cursor.moveToFirst()) {
            do {
                tv.setText(c.getString(0));
            } while (cursor.moveToNext());
        }
        else{
                tv.setText("1234");
        }
    }
    catch (Exception e) {

    }
    finally{
        if(cursor != null)
            cursor.close();
        if(!db.equals(null) || db != null)
            db.close();
    } 
```

# php - 控制提交按钮是否被点击一次或多次

> ID：14082385
> 
> 赞同：0
> 
> 时间：2012-12-29T14:04:49.220
> 
> 标签：php, wordpress, registration

我有一个团体注册表格，有 2 个提交按钮：（1）添加参与者，（2）提交群组注册。

当第一次单击“添加参与者”时，我想在某个“组”表中创建一个数据库条目（这会将添加到该组中的任何参与者组合在一起）。但是，当随着组注册过程的继续而添加更多参与者时，我当然不希望在此表中再有任何条目。就一次。

这听起来可能很愚蠢，但我似乎无法找到轻松做到这一点的方法。任何想法？（我在 WordPress 中使用 PHP）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-01T16:43:45.650

这不是一个愚蠢的问题，我看不到在表单上没有至少两个按钮或类似按钮的元素的方法。这是很常见的。例如，“继续购物”和“去结账”，更不用说“取消”按钮了。这不应该令人困惑，但不要被它冲昏了头脑。

此评论似乎是您提出问题的主要原因：

> 有人决定一次注册几个人以获得团体折扣

基于此声明，我假设每个人都必须同时注册才能使此折扣生效。也就是说，你不能注册三个人，然后再回来注册三个。

基本问题似乎是您想跟踪表单提交的次数。不要那样做。跟踪表单提交了多少次将是一个真正令人头疼的问题。与其在某人第一次注册时自动生成一个组，不如使用一个用于组注册的中介表格。你会有：

1.  注册（可选：说明页面与实际注册表格的链接）
2.  注册组（您可以只生成一个 ID 或让人们为组命名。此 ID 被传递到“添加成员”表单）
3.  添加成员（您可以提交一个成员并将另一个成员重定向回此表单，或点击“完成”并转到“组”结帐表单）
4.  在“结帐”表格中，您列出了小组成员并提供了付款方式。不知道您打算如何接受付款，但这没关系。大概您有一些第三方（Paypal 等）来处理。

基本上，您会尽可能密切地跟踪大型购物网站如何处理购买，以便让整个事情尽可能地熟悉。

如果需要，您还可以拥有“单一”注册表单。

我不知道你打算如何防止这种形式的垃圾邮件。我建议在群组注册​​阶段进行电子邮件验证。也就是说，要求注册组的任何人提供一些联系信息，发送电子邮件并锁定该组的注册，直到返回电子邮件。垃圾邮件发送者不太可能跳过那个圈。

您提到您正在使用 WordPress，因此可以[`wp_cron`](http://codex.wordpress.org/Category%3aWP-Cron_Functions)在一段时间后清理失败或放弃的注册 - 24 小时，三天，等等。

一旦系统工作，您可以使用 Javascript 劫持它并使其更具动态性，如果您愿意的话。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T14:14:51.830

有一个可用于“创建参与者”的组列表。如果为“新组”选择了单选按钮（或类似按钮）（填写了适当的信息），则在提交参与者数据时创建它。不过，请先检查重复项。

正如@ayman 所说 - 有两个提交按钮不是一个好方法。你会让你的用户感到困惑。

# wordpress - 如何根据属性数量更改价格？

> ID：14082387
> 
> 赞同：1
> 
> 时间：2012-12-29T14:05:12.043
> 
> 标签：wordpress, e-commerce, woocommerce

我正在将 Woocommerce 与 WordPress 一起使用。如何根据选择的属性数量计算定价，如图所示。例如，当前订单应达到卢比。9100，因为有 9 个属性的价格为卢比。每个1000卢比。100 为产品基本价格。

产品的总数量始终为一。 ![在此处输入图像描述](../Images/328ccb49e5102a1b811647873cac6572.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T13:38:45.743

我能够通过为 woocommerce 使用重力表单和重力表单插件来解决这个问题。

接下来，我创建了添加多个产品字段，这些字段自动附带*数量*字段并完成*总*字段。

接下来，我创建了一个产品并将其与我刚刚创建的重力形式集成在一起......瞧......

编辑：如果你们有任何其他创意这样做。请在下面回答。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T17:11:15.980

您需要设置产品`attributes`并连接`variations`，因此 1 个产品可以有多个选项，这些选项都会影响价格。这里解释：

[http://wcdocs.woothemes.com/user-guide/product-variations/](http://wcdocs.woothemes.com/user-guide/product-variations/)

# python - 修复错误的 unicode 字符串

> ID：14082397
> 
> 赞同：5
> 
> 时间：2012-12-29T14:07:24.673
> 
> 标签：python, unicode

错误的 unicode 字符串是其中包含意外编码字节的字符串。例如：

文本：`שלום`，Windows-1255 编码：`\x99\x8c\x85\x8d`，Unicode `u'\u05e9\u05dc\u05d5\u05dd'`：，错误的 Unicode：`u'\x99\x8c\x85\x8d'`

在解析 MP3 文件中的 ID3 标签时，我有时会碰到这样的字符串。如何修复这些字符串？（例如转换`u'\x99\x8c\x85\x8d'`为`u'\u05e9\u05dc\u05d5\u05dd'`）

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-29T14:12:41.233

您可以转换`u'\x99\x8c\x85\x8d'`为`'\x99\x8c\x85\x8d'`使用`latin-1`编码：

```
In [9]: x = u'\x99\x8c\x85\x8d'

In [10]: x.encode('latin-1')
Out[10]: '\x99\x8c\x85\x8d' 
```

但是，这似乎不是有效的 Windows-1255 编码字符串。你也许是说`'\xf9\xec\xe5\xed'`？如果是这样，那么

```
In [22]: x = u'\xf9\xec\xe5\xed'

In [23]: x.encode('latin-1').decode('cp1255')
Out[23]: u'\u05e9\u05dc\u05d5\u05dd' 
```

转换`u'\xf9\xec\xe5\xed'`为`u'\u05e9\u05dc\u05d5\u05dd'`与您发布的所需 unicode 匹配的。

* * *

如果你真的想转换`u'\x99\x8c\x85\x8d'`成`u'\u05e9\u05dc\u05d5\u05dd'`，那么这恰好可行：

```
In [27]: u'\x99\x8c\x85\x8d'.encode('latin-1').decode('cp862')
Out[27]: u'\u05e9\u05dc\u05d5\u05dd' 
```

* * *

上面的编码/解码链是使用这个脚本找到的：

**猜测链编码.py**

```
"""
Usage example: guess_chain_encodings.py "u'баба'" "u'\xe1\xe0\xe1\xe0'"
"""
import six
import argparse
import binascii
import zlib
import utils_string as us
import ast
import collections
import itertools
import random

encodings = us.all_encodings()

Errors = (IOError, UnicodeEncodeError, UnicodeError, LookupError,
          TypeError, ValueError, binascii.Error, zlib.error)

def breadth_first_search(text, all = False):
    seen = set()
    tasks = collections.deque()
    tasks.append(([], text))
    while tasks:
        encs, text = tasks.popleft()
        for enc, newtext in candidates(text):
            if repr(newtext) not in seen:
                if not all:
                    seen.add(repr(newtext))
                newtask = encs+[enc], newtext
                tasks.append(newtask)
                yield newtask

def candidates(text):
    f = text.encode if isinstance(text, six.text_type) else text.decode
    results = []
    for enc in encodings:
        try:
            results.append((enc, f(enc)))
        except Errors as err:
            pass
    random.shuffle(results)
    for r in results:
        yield r

def fmt(encs, text):
    encode_decode = itertools.cycle(['encode', 'decode'])
    if not isinstance(text, six.text_type):
        next(encode_decode)
    chain = '.'.join( "{f}('{e}')".format(f = func, e = enc)
                     for enc, func in zip(encs, encode_decode) )
    return '{t!r}.{c}'.format(t = text, c = chain)

def main():
    parser = argparse.ArgumentParser()
    parser.add_argument('start', type = ast.literal_eval, help = 'starting unicode')
    parser.add_argument('stop', type = ast.literal_eval, help = 'ending unicode')
    parser.add_argument('--all', '-a', action = 'store_true')    
    args = parser.parse_args()
    min_len = None
    for encs, text in breadth_first_search(args.start, args.all):
        if min_len is not None and len(encs) > min_len:
            break
        if type(text) == type(args.stop) and text == args.stop:
            print(fmt(encs, args.start))
            min_len = len(encs)

if __name__ == '__main__':
    main() 
```

跑步

```
% guess_chain_encodings.py "u'\x99\x8c\x85\x8d'" "u'\u05e9\u05dc\u05d5\u05dd'" --all 
```

产量

```
u'\x99\x8c\x85\x8d'.encode('latin_1').decode('cp862')
u'\x99\x8c\x85\x8d'.encode('charmap').decode('cp862')
u'\x99\x8c\x85\x8d'.encode('rot_13').decode('cp856') 
```

等等

# objective-c - cocos2d 单元测试。未定义的符号

> ID：14082402
> 
> 赞同：1
> 
> 时间：2012-12-29T14:08:24.297
> 
> 标签：objective-c, unit-testing, cocos2d-iphone, tdd, sentestingkit

为了让自己相信单元测试和 TDD 的好处，我决定将测试包含在我最新的 Cocos2D 项目中。启动并运行最初的样板测试工作正常，但可惜，在此之后我无法走得很远。测试台对每一个 Cocos2D 类都犹豫不决：

```
Undefined symbols for architecture i386:
  "_OBJC_CLASS_$_CCLayer", referenced from:
      _OBJC_CLASS_$_NORControlLayer in NORControlLayer.o
  "_OBJC_METACLASS_$_CCLayer", referenced from:
      _OBJC_METACLASS_$_NORControlLayer in NORControlLayer.o
ld: symbol(s) not found for architecture i386 
```

NORControlLayer 是上例中 CCLayer 的子类。现在，显而易见的解决方案是简单地将 CCLayer 链接到测试台，但这似乎打开了一个马蜂窝，每个添加的类都需要另外十倍的类链接。

**有没有办法创建一个模拟（或其他一些巧妙的技巧）来让 SenTestingKit 接受 NORControlLayer 和未来的 Cocos2D 子类？**

PS：我实际上已经将每个 cocos2d-class 都包含为测试包的目标，但最终出现了一百多个类似的错误......

# php - 在 php 中发送和读取 JSON

> ID：14082403
> 
> 赞同：0
> 
> 时间：2012-12-29T14:08:40.990
> 
> 标签：php, json

我正在使用 JSON 从我的网站发送电子邮件。我这样做是因为简单地通过`<form>`控件发送它似乎绕过了我正在做的一点 DIY“你是人类”验证：

```
<script type="text/javascript">
    $("#contact-submit").click(function() {
        if ($("#contact-captcha").text != "green") {
            $("#contact-captcha").text = "Incorrect";
            $("#contact-captcha").css("border-color", "#7c0707");
        }
        else
        {
            sendMail();
        }
    });

    function sendMail() {
        $.ajax({
            type: "POST",
            url: 'includes/contact.php',
            data: { to: 'me@this.com', from: $('#contact-email').text(), subject: $('#contact-subject').val(), message: $('#contact-message').val() }
        });
    }
</script> 
```

现在的问题是我无法弄清楚如何在`contact.php`.

我已经看过在 php 代码中定义 JSON 的教程，然后使用 json_decode() 来读取它，这不好，因为我不能在那里定义 JSON。

任何人都可以在此处提供有关如何阅读 JSON 的任何指导吗？我想过使用查询字符串，但不知道如何在这里做到这一点。

任何帮助将不胜感激。

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T14:15:50.190

使用时

```
data: { to: 'me@this.com', from: $('#contact-email').text(), subject: $('#contact-subject').val(), message: $('#contact-message').val() } 
```

您将在 、 等中获取`$_POST['to']`数据`$_POST['from']`。

更好的方法（仍然不是 JSON 方法）是使用这样的方法：

```
var serialized = $("form").serialize();
serialized.to = "you@example.com";
$.ajax { ... data: serialized ... } 
```

并且具有`from`、`subject`和`message`是`name`输入字段的属性。

```
From: <input type="text" name="from"/> 
```

如果您确实想发送 JSON（我看不出有任何理由这样做），您可以这样做：

```
json = JSON.stringify({ to: 'me@this.com', from: $('#contact-email').text(), subject: $('#contact-subject').val(), message: $('#contact-message').val() }); 
```

并使用 发送它`data: { json: json }`，最后做

```
json_decode($_POST['json']); 
```

获取关联数组。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T14:21:35.260

在contacts.php

```
print_r($_POST) 
```

或者使用 Firebug 并在提交期间检查控制台，您可以轻松找到您的数据是否正确发送（或者它是否是 JSON.. 等等）

（我不确定您是如何进行“人工验证”检查的，但是，检查字段值**$("#contact-captcha").text != "green"**不是正确的方法（易于篡改和绕过它因为它在表单本身中）。您需要使用“随机”文本在服务器端创建一个哈希并将其会话（或发送到表单），用户必须输入文本并将其作为 POST 发送到服务器。最后验证通过散列用户输入文本并与您创建的文本进行比较。如果您做得正确，请忽略这一点。^^")

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T14:26:35.417

如果不是必须使用 JSON，那么您可以这样做。

使用您用于将数据发送到contacts.php 并遵循PHP 代码的jquery 代码。

在 Contact.php 中

```
if(isset($_POST['to']) && $_POST['to'] != ''){

    $filterTO = $_POST['to'];

    //filter value and get filtered value back in $filterTO here and use it further
} 
```

您也可以以相同的方式使用其他变量。

**注意**：强烈建议在使用前过滤变量。我只展示了对你来说有问题的部分。这不是整个标准过程。

# objective-c - 在目标 c 中调用方法

> ID：14082407
> 
> 赞同：1
> 
> 时间：2012-12-29T14:09:06.763
> 
> 标签：objective-c, ios, xcode

我正在努力学习目标c。我有 xcode 4，并且正在阅读一本关于如何制作 iphone 应用程序的初学者书籍。

我可以很好地编写 c 尖锐的代码，但 c 显然较低级别并且涉及相当多的内存管理，所以我认为这就是我在这里摔倒的地方。

无论如何，我正在尝试创建一个返回类型为 double 的方法。在c Sharp中，我会将其写为

```
public double test()
{
    return 12;
} 
```

然后我希望能够从另一个方法调用我的方法。这是我迄今为止所做的部分工作。

```
- (double)test
{
    return 1985;
}

- (IBAction)btnConvert_Click:(id)sender
{
    double str = [double test];

    NSString *hello = txtAmount.text;
    double myDouble = [hello doubleValue] * exrate;
    lblResult.text = [NSString stringWithFormat: @"%.2f", str];
} 
```

在我尝试建立双重方法 str“预期表达式”时，它会引发错误。我想做的是传入 myDouble 进行测试，然后进行一些计算，然后返回值。

我该怎么做？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T14:12:31.823

如下图使用

```
double str = [self test]; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-29T14:12:31.890

您只需要调用`[self test]`即可调用您的方法

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-29T14:12:55.193

而不是`double str = [double test];`你应该写`double str = [self test];`，因为你正在调用你自己的类的方法，而不是`double`

# iphone - ios中嵌套数据库查询的错误循环迭代.while循环没有运行正确的次数

> ID：14082408
> 
> 赞同：0
> 
> 时间：2012-12-29T14:09:17.420
> 
> 标签：iphone, objective-c, ios, sqlite

如果注释部分保持注释，则代码运行良好。while 循环应该运行两次，它确实导致线程表中只有两行。但是，如果我取消注释注释代码，while 循环只运行一次，这是错误的输出

```
sql = "select thread_id,timestamp from threads";

    if(sqlite3_prepare_v2(database, sql, -1, &selectstmt, NULL) == SQLITE_OK) {

        while(sqlite3_step(selectstmt) == SQLITE_ROW) {

            NSString* abc = [NSString stringWithUTF8String:(char *)sqlite3_column_text(selectstmt, 0)];
            NSString* def = [NSString stringWithUTF8String:(char *)sqlite3_column_text(selectstmt, 1)];

            NSLog(@"%@",abc);
            NSLog(@"%@",def);
            NSString* threadid = abc;
            NSString *sql2 = [NSString stringWithFormat:@"select * from my where t_id=\"%@\"",threadid];

**Commented code begin**               
            /* sqlite3_finalize(selectstmt);

            sqlite3_open([path UTF8String], &database);
                if(sqlite3_prepare_v2(database, [sql2 UTF8String], -1, &selectstmt2, NULL) == SQLITE_OK) {
                int a = sqlite3_data_count(selectstmt2);
                NSLog(@"%d",a);

                    if (a==1) {

                    sql2 = [NSString stringWithFormat:@"select timestamp from my where t_id=\"%@\"",threadid];
                        if(sqlite3_prepare_v2(database, [sql2 UTF8String], -1, &selectstmt2, NULL) == SQLITE_OK) {

                            while(sqlite3_step(selectstmt) == SQLITE_ROW) {

                            NSString* abc = [NSString stringWithUTF8String:(char *)sqlite3_column_text(selectstmt2, 0)];
                            NSLog(@"%@",abc);
                            }
                        }  
                    } 

                    if(a==0) {

                    char* error;
                    sql2 = [NSString stringWithFormat:@"insert into my(t_id,time) values(\"%@\",\"%@\")",threadid,@"0"];

                    int i = sqlite3_exec(database, [sql2 UTF8String], NULL, NULL, &error) ;
                    NSLog(@"inserted");
                    sqlite3_finalize(selectstmt);
                    }
              }*/

**Commented code end**

**program end** 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T14:50:26.330

您正在完成准备好的语句，在您处理它的同一个循环中。毫不奇怪，下次您尝试使用该语句时，它会失败。请注意，您对语句进行的每个调用在完成后都会返回一个错误代码，您可以在继续执行其他逻辑之前检查该错误代码。

# java - java.util.concurrent.BlockingQueue 的实现

> ID：14082411
> 
> 赞同：0
> 
> 时间：2012-12-29T14:09:29.930
> 
> 标签：java, concurrency, blockingqueue

> **可能重复：**
> [在 ArrayBlockingQueue 中，为什么要将最终成员字段复制到本地最终变量中？](https://stackoverflow.com/questions/2785964/in-arrayblockingqueue-why-copy-final-member-field-into-local-final-variable)

查看 java.util.concurrent.DelayQueue 的实现，我看到了一个我不太理解的模式。

```
public class DelayQueue<E extends Delayed> extends AbstractQueue<E>
implements BlockingQueue<E> {

private transient final ReentrantLock lock = new ReentrantLock();
private transient final Condition available = lock.newCondition();
private final PriorityQueue<E> q = new PriorityQueue<E>();

public boolean offer(E e) {
    **final ReentrantLock lock = this.lock;**//(*)
    lock.lock(); 
    try { ... }
    finally {lock.unlock();}

}

public E poll() {
    **final ReentrantLock lock = this.lock**;//(*)
    lock.lock(); 
    try { ... }
    finally {lock.unlock();}
 }} 
```

(*) 行（使用对字段的临时引用）的目的是什么，可以在 BlockingQueue 接口的方法实现中找到，其中涉及一些并发（锁）？考虑一下，如果锁定字段是最终字段，并且在字段初始化期间与其他最终字段一起分配。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T14:15:31.650

不在本地复制锁定变量不会对代码的正确性产生任何影响。

这样做可能会带来非常小的性能提升，但我无法理解为什么会这样。除此之外，这可能是作者认为的可读性改进。

# java - 在java中将int数组转换为bufferedImage

> ID：14082417
> 
> 赞同：2
> 
> 时间：2012-12-29T14:10:23.700
> 
> 标签：java, arrays, bufferedimage, fisheye

我想知道如何将 java 中的 int 数组构造成缓冲图像。我知道你可以通过做

```
int[] srcpixels = ((DataBufferInt)in.getRaster().getDataBuffer()).getData(); 
```

但我不知道该怎么做。我需要这个来对缓冲图像应用鱼眼效果，我在这里找到了如何做[http://popscan.blogspot.com/2012/04/fisheye-lens-equation-simple-fisheye.html](http://popscan.blogspot.com/2012/04/fisheye-lens-equation-simple-fisheye.html)但它只适用于整数数组。请帮忙，谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T19:02:14.360

使用 WritableRaster：

```
final int w = bitmap.getWidth();
final int h = bitmap.getHeight();

final WritableRaster wr = bitmap.getData();
int []data = wr.getPixels(0, 0, w, h, data);

// do processing here

wr.setPixels(0, 0, w, h, data); 
```

# image-processing - 可编写脚本的图像处理

> ID：14082418
> 
> 赞同：0
> 
> 时间：2012-12-29T14:10:31.187
> 
> 标签：image-processing, shader, pixel-shader

我迫切需要一些软件。我正在寻找的是某种类型的图像编辑器，它通过某种类型的脚本语言支持像素级操作（想想 HLSL/GLSL 像素着色器。）

要求：

*   从脚本访问像素数据。
*   支持带 alpha 的 32 位浮点图像
*   可以读写多种文件格式（TIFF、PNG、BMP...）

这样的东西已经存在了吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T10:55:35.907

Adobe 的 PixelBender 有一些这样的功能。铬也是如此。您并没有真正指定上下文，但是...作为图像编辑器，请查看 Pixel Bender。

# javascript - 在 chrome 扩展中操作 DOM

> ID：14082419
> 
> 赞同：2
> 
> 时间：2012-12-29T14:10:31.547
> 
> 标签：javascript, google-chrome, google-chrome-extension

我正在尝试了解 chrome 扩展，但我无法理解如何`DOM`使用`content_scripts`.

**清单.json**

```
{
    "name": "First",
    "version": "1.0",
    "manifest_version": 2,
    "description": "First extension",
    "background": {
        "scripts": ["test.js"]
    },

    "page_action": {

        "default_icon": "icon.png",
        "default_popup": "popup.html"
    },

    "content_scripts": [ {
        "js": [ "jquery.min.js", "popup1.js"  ],
        "matches": [ "http://*/*", "https://*/*" ]

    } ],

    "permissions" : [
        "tabs",
        "http://*/*"
            ]
} 
```

**测试.js**

```
function check(tab_id, data, tab){

    if(tab.url.indexOf("google") > -1){
        chrome.pageAction.show(tab_id);
            }

};
chrome.tabs.onUpdated.addListener(check); 
```

**popup1.js**

```
function myfunc(){

    var x = $('#options option:selected').text();
    $("body").append('Test');
    alert(x);
    //window.close();

}

$(document).ready(function(){

    $('#options').change(myfunc);

}); 
```

上面的代码/扩展工作正常，因为`myfunc`被调用但它没有`Test`注入`google.com`.

那么，我在访问/操作 DOM 时哪里出错了。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-29T17:21:54.763

如果您想在弹出事件中使用浏览器选项卡 DOM。在这种情况下，您必须将消息传递给`content script`from`background script`或`inject JavaScript`into `content script`：看看

清单.json

```
{
    "name": "First",
    "version": "1.0",
    "manifest_version": 2,
    "description": "First extension",
    "background": {
        "scripts": ["test.js"]
    },    
    "page_action": {
        "default_icon": "icon.png",
        "default_popup": "popup.html"
    },    
    "content_scripts": [ {
        "js": [ "jquery.min.js", "content_script.js"  ],
        "matches": [ "http://*/*", "https://*/*" ]    
    } ],

    "permissions" : [
        "tabs",
        "http://*/*"
            ]
} 
```

content_script.js

```
function myfunc(){
    var x = $('#options option:selected').text();
    $("body").append('<div style="width:200px; height:200px; border: 1px solid red;"></div>');
}

$(document).ready(myfunc); 
```

现在您将到达`A box with red border`页面底部。

**popup.js**

```
function myfunc(){
    var x = $('#options option:selected').text();
    chrome.extension.sendMessage({sel_text: x});
}

$(document).ready(function(){
    $('#options').change(myfunc);
}); 
```

**test.js（在后台使用）**

```
chrome.extension.onMessage.addListener(
  function(request, sender, sendResponse) {
    appendTextToBody(request.sel_text);
  });

function appendTextToBody(text) {
  chrome.tabs.getSelected(null, function(tab) {
    chrome.tabs.executeScript(tab.id, {"code" : '$("body").append("Test : "'+text+');'}) ;
  });
}

function check(tab_id, data, tab){
    if(tab.url.indexOf("google") > -1){
        chrome.pageAction.show(tab_id);
    }
};
chrome.tabs.onUpdated.addListener(check); 
```

# telerik - 没有 Javascript 经验的 KendoUI 或 DevExpress？

> ID：14082423
> 
> 赞同：0
> 
> 时间：2012-12-29T14:11:05.383
> 
> 标签：telerik, devexpress, kendo-ui

我来自 Powerbuilder 背景，我们公司转向 .NET。

我们讨论使用什么平台。.NET、Web、C#、Entity Framework，但我们需要一个“客户端”组件解决方案......有点 RAD（如果在 Web 开发中有这样的话）

我们对 javascript、json 等知之甚少

考虑到这一点，您认为哪个平台更容易开发，KendoUI 还是 DevExpress？

我只看过剑道

（我们想要客户端的东西……整个服务器组件都很重要，让我们在 PB 呆了这么久）

等待您的建议！谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T04:46:08.873

当我为 Telerik 作为一名传道者工作时，我可能在这里有偏见。话虽如此，我自己也是一个铁杆程序员，所以这是基于我的经验。

5 年多来，我更像是一个 Windows 平台的人，我的工作让我转向了这个。但大约 10 年前，我开始成为一名网络人。大约几年前，当我开始将 Web 视为将自己重新构建在 Web 上时，我不得不开始理解 JQuery，因为在我看来，JQuery 已成为默认的 JS。所以当剑道问世时——就好像剑道在赞美 JQuery。对我来说没有新的语法或新的学习曲线。当然，作为一个框架，它有自己的方法、属性和事件，但没有新语言。

kendo 的另一个最大因素是 - 它完全基于 HTML5 并且完全是客户端 UI 框架。它是你需要的所有东西的一个包，而不是你通常会做的 100 多个插件。

Kendo UI 来自 Telerik - 因此有明确的发布周期和世界级的支持支持它。

这是一个活生生的例子，展示了如何使用剑道 ui 来构建真实世界的应用程序

[http://www.kendouimusicstore.com/](http://www.kendouimusicstore.com/)

音乐商店是微软在 ASP.NET MVC 上的一个著名例子。使用 Kendo UI 为后端的 UI 和 WebAPI 提供支持已重新完成了相同的示例。

希望这可以为您的决策提供一些见解。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T18:58:06.123

根据我的经验，DevExpress DXTREME 提供了框架和相应的向导，可让您快速创建[多渠道应用程序](http://www.devexpress.com/Products/mobile.xml)（适用于 iOS 和 Android）的原型。

同时，Kendo UI 提供了对所用小部件的 JavaScript 代码的[更“清晰”的访问。](http://www.kendoui.com/mobile.aspx)但这可能需要对 JavaScript 进行额外的努力。

无论如何，我相信只有在尝试使用它们两者来构建某些东西时，您才能做出决定。这仍然取决于你。祝你好运！

# flash - Haxe for Flash 中的 __new__ 是什么意思？

> ID：14082426
> 
> 赞同：1
> 
> 时间：2012-12-29T14:11:22.670
> 
> 标签：flash, haxe

我看到了一些代码（为 Flash 编写），如下所示：

```
var _array:Array<Int> = untyped __new__(Array, 10); 
```

我发现它创建了`Array`一个`length`10 的和。但是，当我尝试类似的东西时：

```
var _array:Array<Int> = untyped __new__(Array, 1, 2); 
```

它创建一个`Array`有两个元素的。我对此感到困惑，真正的含义是`__new__`什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T17:54:18.707

它是 Haxe 的“魔法”，请参阅[wiki](http://old.haxe.org/doc/advanced/magic)。

是`__new__`调用本地构造函数，在 的情况下`Array`，它与 Haxe 公开的不同（[`Array`在 Haxe doc](http://haxe.org/api/array)中vs[`Array`在 AS3 doc 中](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/Array.html)）。

基本上使用使用长度和/或值来`__new__`初始化，而无需手动执行：`Array`

```
var array = [];
for(i in 0...len) array.push(0); 
```

# templates - Backbone：带有模板的动态视图层次结构

> ID：14082429
> 
> 赞同：0
> 
> 时间：2012-12-29T14:11:25.200
> 
> 标签：templates, backbone.js, views

我有三个不同的视图模板：“发布”、“评论”、“添加新评论”。主要模板是“post”。我需要了解如何将“评论”和“添加新评论”模板放入“帖子”模板中的 div 中。或任何其他方法来制作这个结构：

```
    - 邮政
        - 评论
        - 添加新的帖子表单
    - 邮政
    ...

```

它类似于脸书墙

用于骨干网的 Javascript：

```
// Post View
var PostView = Backbone.View.extend({
    template: $("#post").html(),
    ...
    render: function () {
        var tmpl = _.template(this.template);
        var thisPost = this.model.toJSON();
        this.$el.html(tmpl(thisPost));
    }
});
var postView = new PostView();
postView.render();

// Comments List
var CommentsListView = Backbone.View.extend({
    el: '#comments', // how to place it to #comments div in "post" template? This line doesn't work
    ...
    addNewCommentForm: function (post_id) {
        var tmpl = _.template($("#addCommentTemplate").html());
        this.$('#addNewComment').append(tmpl()); // How to place it to #addNewComment div in "post" template? This line doesn't work
    }
}); 
```

HTML：

```
<script id="post" type="text/template">
    <%= text %>
    <div id='comments'>...</div>
    <div id='addNewComment'>...</div>
</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T15:05:48.173

您的代码有很多问题。第一个是您实际上并没有将其`PostView.el`放入 DOM 中。通过`PostView.render()`，您正在填充`PostView.$el`和随后`PostView.el`，但实际上并没有将其放入页面（DOM）中。此外，通过设置`el`on `CommentsListView`，您实际上并没有在那里做任何事情。如果您想将 设置`el`为现有元素，则可以执行以下操作：`el: $('#comments')`. 或者，如果您想`CommentsListView`动态渲染并将其注入 DOM，那么您只需通过定义 id 属性来使元素具有“comments”的 id，如下所示`id: 'comments'`：这些只是代码中最明显的两个问题。我在这里运行了一个半工作示例：[http://codepen.io/jayd3e/pen/hAEDv](http://codepen.io/jayd3e/pen/hAEDv)。

# jquery - 奇怪的 JQuery 错误

> ID：14082430
> 
> 赞同：0
> 
> 时间：2012-12-29T14:11:31.890
> 
> 标签：jquery

请查看我的网站并打开浏览器控制台进行错误检查： http: [//mayy.in/stp.html](http://mayy.in/stp.html)

我正在 Chrome 控制台中查看它，它给了我错误：

```
Uncaught SyntaxError: Unexpected token ILLEGAL 
```

在第 44 行

可能是什么问题呢？它是一个非常简单的代码，如下所示：

```
$('div').each("click", function() {

$(this).remove();​​​​​​​
});​ 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-29T14:13:55.027

我不认为你的代码是正确的。您可以在所有元素上绑定事件而无需迭代。通过每一个。

我调试了你的代码，发现你的代码中有一些特殊字符![在此处输入图像描述](../Images/04764080d08ecc315aafbe39ce3bf63d.png)

删除';'后我能够运行代码 .

```
$('div').click( function() {

$(this).remove();​​​​​​​
});​ 
```

或者

$('div').on('click', function() {

```
$(this).remove();​​​​​​​
});​ 
```

# c# - 无法传递符合泛型约束的类型变量

> ID：14082431
> 
> 赞同：3
> 
> 时间：2012-12-29T14:11:39.003
> 
> 标签：c#, generics, interface, generic-constraints

```
public interface ILovable<T> where T : IEquatable<T>
{
    T Care(T t);
}

public class Me : ILovable<int>
{
    public int Care(int i)
    {
        return i;
    }
} 
```

说我有以上。现在下面的功能失败：

```
private static void Colour<T>(ILovable<T> me) where T : IEquatable<T>
{
    var z = me.Care(1); //cannot convert from 'int' to 'T'
} 
```

上面的代码有什么问题？`ILovable<T>`有一个`Care`函数，它吸收 a `T`which is `IEquatable<T>`。在上面的函数中，我调用了相同的`Care`函数并传递`T`了`int`类型。`int`毕竟是`IEquatable<int>`。

*我究竟做错了什么？有什么办法可以解决吗？*

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T14:21:14.847

您的方法签名没有指定 a `ILovable<int>`，它指定了`ILovable<T>`. 例如，这将起作用：

```
private static void Colour(ILovable<int> me)
{
    var z = me.Care(1); //cannot convert from 'int' to 'T'
} 
```

问题是编译器不知道`T`在您的示例中这是一个“int”；它可以是任何满足约束的类型。这是另一种可行的方法：

```
private static void Colour<T>(ILovable<T> me, T valueToCareAbout) where T : IEquatable<T>
{
    var z = me.Care(valueToCareAbout);
}
//use like this
Colour(me, 1); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T14:20:33.623

我得到的错误是：

```
Argument type 'int' is not assignable to parameter type 'T' 
```

我很确定这是因为您将其定义`me`为`ILovable<T>`. 因此，它不会自动解析为`Me`int 定义为的类型`T`。

这将修复错误，因为`Me`定义`T`为`int`：

```
private static void Colour<T>(Me me) where T : IEquatable<T>
        {
            var z = me.Care(1); 
        } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-29T14:25:24.633

那是因为方法 Color 说会有 ILovable< T > 类型的参数，而 T 将在稍后解析，所以在编译时我告诉方法 T 是 int 类型。

因此，要么您将 ILovable 作为参数传递，要么将 T 为 int 的被授予者

```
void Colour<T>(ILovable<int> me) 
```

或者直接通过 type Me

```
void Colour<T>(Me me) 
```

因为否则 me.Care 期望类型 T 而不是 int 作为特定

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-29T17:37:02.727

更改以下

```
private static void Colour<T>(ILovable<T> me) where T : IEquatable<T> 
```

至

```
private static void Colour<Int32>(ILovable<int> me) 
```

及以上将工作。

* * *

现在是神秘部分

您在关注时遇到错误

```
private static void Colour<T>(ILovable<T> me) where T : IEquatable<T> 
```

因为`Care`是 期待`T`, 而 你 是 提供`int`.
它与

`Care((T)1)`.

或者

```
 T t = (T)1; //This is the cause of error as int cannot be changed to T. Remember Int32 is sealed so T cannot derive from int

 Care(t); // This is fine 
```

要进行上述工作，`T`必须`int`. 为此，Colur 方法语法应该像

```
 private static void Colour<Int32>(ILovable<int> me) 
```

如果你想将字符串传递给`Care`，`T`应该是`string`。

```
 private static void Colour<string>(ILovable<string> me) 
  {
     me.Care("Hello");
  } 
```

`Colour`现在，如果我们必须修复 T，那么问题就出现了，为什么在定义中根本需要 T。

答案-> 对于非密封类中的不处理继承类型。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-31T02:47:51.897

简短的回答是在泛型方法（或类）中用更派生的类型覆盖类型的变量`T`是不可能的，因为编译器没有明确知道`T`更多派生类型（在我们的例子`T`中是`int`），因为`T`可以是任何其他派生的在运行时键入。

长答案：`me`变量是类型`ILovable<T>`。现在`me.Care`函数需要指定类型的参数`ILovable<T>`是`T`。`Care`函数之外`T`可以是任何东西`IEquatable<T>`，所以`int`没关系。但在函数内部，`T`必须是 just`T`而不是另一个派生类型`IEquatable<T>`. 否则这样的场景会出现运行时错误：

```
private static void Colour<T>(ILovable<T> me) where T : IEquatable<T>
{
    var z = me.Care(1); 
}

...

Colour(""); 
```

现在，`T`调用时是字符串`Colour("")`。`me`也是如此`ILovable<string>`。所以`me.Care`函数需要一个`string`作为参数，但提供的是一个`int`，那就是灾难。

# multithreading - 在多线程控制台应用程序中调用 WCF 服务操作

> ID：14082432
> 
> 赞同：-1
> 
> 时间：2012-12-29T14:11:43.200
> 
> 标签：multithreading, wcf, c#-3.0

我有以下应用程序：

1.  它的 Windows 控制台 .NET 3.0 应用程序
2.  我正在创建 20 个工作负载并将它们分配给线程池进行处理。
3.  ThreadPool 中的每个线程都会创建 WCF 客户端并使用分配的工作负载创建的请求调用服务。

有时在生产服务器 [12 核心机器] 上，我得到以下异常：

使用 WCF 客户端调用操作时出现反映类型“xyz”的错误。这开始出现在所有线程中。一段时间后，它突然消失并再次出现。

代码：

伪代码：

```
for(int i=0;i<20;i++)
{

MultiThreadedProcess proc =new MultThreadedProcess(someData[i]);
ThreadPool.QueueUserWorkItem(proc.CallBack,i);

} 
```

在类 MultiThreadedProcess 中，我执行以下操作：

```
public void Callback(object index)
{

MyServiceClient client = new MyServiceClient();
MyServiceResponse response =client.SomeOperation(new MyServiceRequest(proc.SomeData));
client.close();
//Process Response
} 
```

任何人都可以为这个问题提出一些解决方案吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T16:36:05.483

如果您可以打开诊断，在我看来是序列化问题，则可能某些数据成员/值无法正确反序列化以进行操作调用。

# android - 从广播接收器启动一个活动会调出默认活动

> ID：14082440
> 
> 赞同：2
> 
> 时间：2012-12-29T14:12:39.420
> 
> 标签：android, android-activity, taskaffinity

我的应用程序包含两个活动，一个小部件和一个广播接收器。

第一个活动是默认活动，由家庭启动器调用。第二个活动是一个提醒对话框活动，它播放 MP3 并有一个关闭按钮。它将出现在主屏幕上。

我的小部件是一个自定义时钟，它设置一个闹钟，每分钟调用一个广播接收器，负责更新时钟。在特定时间有一些提醒，广播接收者调用提醒活动。

我的应用程序现在可以正常工作了，但是有一个小问题：当应用程序在后台打开时（它不在屏幕上），当广播接收器启动提醒活动时，默认活动首先出现并显示提醒活动。但是当我关闭应用程序时，主屏幕上会出现提醒活动并且没有问题。

这是我用来从接收器 startActivity 的代码：

```
context.startActivity(new Intent(context, ActivityReminder.class).setFlags(Intent.FLAG_ACTIVITY_NEW_TASK | Intent.FLAG_ACTIVITY_CLEAR_TOP | Intent.FLAG_ACTIVITY_SINGLE_TOP)); 
```

这是android清单：

```
 <activity android:name=".MyActivity"
        android:theme="@android:style/Theme.Black.NoTitleBar"
        android:label="@string/app_name"
        android:screenOrientation="portrait" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN"/>
            <category android:name="android.intent.category.LAUNCHER"/>
        </intent-filter>
    </activity>

    <activity android:name=".ActivityReminder" android:label="@string/reminder" android:screenOrientation="portrait" android:theme="@style/Theme.CustomDialog"  />

    <receiver android:name=".widget"
        android:label="@string/app_name">
        <intent-filter>
            <action android:name="android.appwidget.action.APPWIDGET_UPDATE" />
        </intent-filter>
        <meta-data android:name="android.appwidget.provider"
            android:resource="@xml/widget" />
    </receiver>

    <receiver android:name=".UpdaterReceiver" /> 
```

现在我在默认活动中使用这个解决方法来解决问题，它就像关闭应用程序一样工作：

```
@Override
protected void onPause()
{
    super.onPause();
    finish();
} 
```

我发现了更烦人的事情。如果主要活动未关闭，则广播接收器的每个调用都会再次打开活动，即使它已经打开。虽然如果主要活动关闭，后续调用将不会做任何事情。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2015-03-04T19:37:55.963

你的问题是**taskAffinity**。当您启动时`ActivityReminder`，Android 会尝试找到一个合适的任务来启动它。如果您的应用程序没有运行，它将找不到合适的任务，因此它将启动一个新任务，并且 Activity 将自行显示在任务中。但是，如果您的应用程序已经在后台运行，Android 会将现有任务带到前台并启动`ActivityReminder`该任务。

要解决此问题，请将以下内容添加到 的`<activity>`定义中`ActivityReminder`：

```
android:taskAffinity="" 
```

这告诉 Android 它不应该寻找“匹配”的任务来启动`ActivityReminder`。

# javascript - 局部函数/变量封装

> ID：14082444
> 
> 赞同：1
> 
> 时间：2012-12-29T14:13:00.877
> 
> 标签：javascript, code-injection

我见过一些使用匿名立即调用函数进行封装的代码看起来像这样

```
(function(){
    var ABC = ...

    function XYZ(){
        ....
    }
})(); 
```

ABC 或 XYZ() 是否完全无法访问（通过脚本注入/劫持）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T14:17:02.250

一旦范围内有 0 个变量引用其中任一

*   对象本身
*   O 是其后代属性的任何对象
*   已关闭上述任何一项的功能

在这种情况下，上述任何一项都不可用：您没有`ABC`对 IIFE 范围之外的内容的引用，并且您没有对作为其属性的任何对象的引用。这意味着它现在无法访问。但是，如果您要关闭`ABC`,`XYZ`并返回`XYZ`，现在可以通过`ABC` *访问* `XYZ`：

```
var outerXYZ = (function(){
    var ABC = "foo";

    function XYZ(){
        return ABC;
    }

    return XYZ;
})();

// no way to access ABC directly, but

var outerABC = outerXYZ(); 
```

脚本注入/劫持部分太模糊，无法有意义地回答。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T14:16:16.930

在您提供的示例中，变量和函数在自调用函数范围之外是完全不可访问的

# c++ - 如何使 C++ 继承保留访问说明符

> ID：14082445
> 
> 赞同：1
> 
> 时间：2012-12-29T14:13:04.607
> 
> 标签：c++

> **可能重复：**
> [什么是访问说明符？我应该以私有、受保护还是公共继承？](https://stackoverflow.com/questions/5447498/what-are-access-specifiers-should-i-inherit-with-private-protected-or-public)

如何在 C++ 中创建一个派生类，它保留属性和方法的访问说明符，如下所示：

```
class Base
{
private:
    void base_private();

protected:
    void base_protected();

public:
    void base_public();
};

class A: [what type is appropriate here?] Base
{
public:
    void test() {
        base_protected(); // Ok
    }
};

class B: [what type is appropriate here?] A
{
public:
    void test() {
        base_protected(); // Ok
    }
};

int main()
{
    A a;
    B b;

    a.base_public();        // Ok
    a.base_protected();     // Not Ok
    b.base_protected();     // Not Ok
    b.test();               // Ok

    return 0;
} 
```

我的意思是`base_protected()`方法在派生类中仍然受到保护，但是`base_public()`是公共的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T14:25:02.857

让我们考虑以下成员的可用性`Base`：

*   `base_private`对客户不可用，但对`Base`自己可用
*   `base_protected`对客户不可用，但对`Base`自己可用
*   `base_public`可供客户和`Base`

现在，如果你有`class A : public Base`（公共继承），成员的可用性`Base`将是：

*   `base_private`对客户*不可用*，对`A`自身不可用
*   `base_protected`对客户不可用，但对`A`自己可用
*   `base_public`可供客户和`A`

现在，您要问的是如何为两个类保持相同的客户端界面，`Base`并且`A`. 如果您查看上面列表中客户的成员的可用性，您会发现它完全相同，`Base`并且`A`：`base_private`不可用；`base_protected`不可用；并且`base_public`可用。

`Base`和之间唯一不同的`A`是`A`不能访问私有的成员`Base`。这就是`protected`访问控制的全部意义——它使派生类可以访问它们的基类成员，而不使它们对客户可用。

所以`public`继承是你需要的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T14:23:54.793

派生类可以访问基类的`public`和成员，`protected`无论您是继承还是。`private``protected``public`

当您继承`private`基类的所有成员时，都会考虑`private`为`A`. 类似的`protected`继承，派生类`A`可以访问`protected`和`public`成员`Base`。

在这两种情况下，`private`以及`protected`继承中，`Base`“公众”都无法访问 的成员。

现在回答您的问题，使用`public`继承来保留基类的访问说明符。

# c - 如果 (x==0||7||14||21||-7||-14) {y=星期四;}

> ID：14082446
> 
> 赞同：-5
> 
> 时间：2012-12-29T14:13:22.773
> 
> 标签：c, if-statement

你能像这样连续使用一堆或吗？

```
 if (x==0||7||14||21||-7||-14){y=THURSDAY;} 
```

它似乎对我不起作用。怎么了？可以|| 不能用于具有相同 then 谓词的两个 else if 条件？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-29T14:15:48.820

在 c 中，除 0 以外的任何值都被视为布尔值。所以你的 if 可以读成这样：如果 x==0 或 true 或 true 或 true ......你可能的意思是`if (x==0 || x==7 || x==14 ...)`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-29T14:32:37.107

所有的答案都是正确的..但重要的是为什么......当使用布尔表达式时，你不能让编译器假设 if(x == 0 || .... < 指的是同一个变量)，因此你应始终指定您正在评估的变量。

```
if(x == 0 || x == 7 || ...) { ... } 
```

此外，这是真的，大多数编。语言有它们的简写，例如在 c 中，任何不是 0 的都是正确的，但同样不适用于 java；用速记区分基础知识时要非常小心。

问候

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-29T14:21:01.507

您可以使用一堆 if，但由于存在重复模式，因此模数之类的东西更合适。IE

```
if( x>= -14 && x<= 21 && (x %7) == 0) 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-29T15:28:35.693

表达方式

```
x == 0||7||14||21||-7||-14 
```

不是简写**_**

```
x == 0 || x == 7 || x == 14 || ... 
```

相反，它与表达式的*结果*`x`进行比较，结果为1。 *`0 || 7 || 14 || ...`*

 *请记住，`||`运算符首先评估其左操作数；如果它是 0 值，则计算正确的操作数。如果两个操作数都是 0 值，则表达式的计算结果为 0（假）。如果左侧操作数非零，则表达式的计算结果为 1 (true)，而右侧操作数根本不计算。

基本上，您的代码被评估为

```
x == 0 || (7 || (14 || (21 || (-7 || -14)))) 
```

左操作数为 0，因此我们计算右操作数（子表达式`(7 || (14 || (21 ||...)`。由于`7`非零，表达式计算结果为 1（不计算剩余操作数）。

如果要`x`针对多个值进行测试，则需要编写多个相等表达式，如

```
if (x == 0 || x == 7 || x == 14 || ...) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-29T14:15:46.527

将 if 语句更改为以下内容：

```
if (x==0 || x==7 || x==14 || x==21 || x==-7 || x==-14)
{
  y=THURSDAY;
} 
```

您不能一次针对多个值测试一个变量。

在`C`中，出于布尔逻辑的目的，所有非零值都评估为真。因此，原始`or`语句中的每个数字都代表它自己的条件。所以`7`评估为真，并且条件得到满足。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-12-29T14:15:53.547

尝试

```
 if (x==0||x==7||x==14||x==21||x==-7||x==-14)
    {
     y=THURSDAY;
    } 
```

您编写它的方式，7,14.. 将被评估为 true。

0 为假，其余为真。*

# visual-studio-2010 - 是否可以将 Matlab 编译器链接到 Visual C++ 编译器？

> ID：14082450
> 
> 赞同：2
> 
> 时间：2012-12-29T14:14:22.517
> 
> 标签：visual-studio-2010, matlab, mcc

我正在使用 Matlab 2010 和 VS2010。我的系统中安装了 Matlab 编译器运行时。每当运行命令时`mcc -setup`，我只会得到一个编译器`lcc`。当使用部署工具构建 C++ 共享库时，此编译器会出现很多错误。它仅正确构建 C 共享库。

我还可以将 VC++ 编译器与 MCC 连接吗？？？？

我该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T08:12:26.367

你读过[这篇](http://www.mathworks.co.uk/support/compilers/R2010a/win64.html)文章吗？特别是注2？他们在那里谈论一个类似的错误。

附言

Matlab 使用 mexopts 文件与编译器交互，位于

```
matlabroot\bin\win64\mexopts\ 
```

因此，您几乎可以自己添加任何编译器。

*   一些 mexopt 可通过 Mathworks 文件交换获得。
*   如果您可以访问较新的 matlab 安装，则可以从那里获得 mexopts。
*   您可以根据现有文件编写自己的一组 mexopts。一般来说，它很容易制作，比如说VS2010 mexopts out of VS2008。

[这是](http://www.mathworks.co.uk/support/solutions/en/data/1-1B365/index.html?product=CO&solution=1-1B365)关于此的官方文章。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T22:27:56.073

Matlab 2010 和 VS2010 存在问题。似乎 Matlab 是在 VS 之前发布的，因此它没有自动配置 VS2010 的方式。

我曾经遇到过这个问题，我最好的建议是下载VS2008 express edition ...

这很蹩脚，但它是让 Matlab 2010 与 VS 一起工作的最快方法。

对不起。

# dart - 递归删除Dart中包含文件的整个目录？

> ID：14082453
> 
> 赞同：7
> 
> 时间：2012-12-29T14:14:43.657
> 
> 标签：dart

如何递归删除 Dart 中的整个目录以及所有文件？

例如：

```
/path/to/project/foo.dart
/path/to/project/remove/all/of/these 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-12-29T14:29:19.177

这比听起来容易。

如果我理解正确，它会是这样的：

```
import 'dart:io';

main() {
  // Deletes the directory "remove" with all folders and files under it.
  new Directory('remove').delete(recursive: true);
} 
```

# php - 当缺少函数在 if 中时如何显示错误

> ID：14082455
> 
> 赞同：-1
> 
> 时间：2012-12-29T14:14:49.083
> 
> 标签：php

今天我注意到缺少的函数在 if 中时会显示错误。以及看到该错误的原因，因为很难调试

```
<?php if(3 >1): ?>

    <?php echo missingFunction(3); ?>

<?php else: ?>

    <?php echo missingFunction(3); ?>

<?php endif; ?> 
```

如果我自己调用该函数

// 这将表明缺少该函数

```
<?php echo missingFunction(4); ?> 
```

在文件的开始我有

```
ini_set('display_errors', 1);
error_reporting(E_ALL); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T14:53:41.060

PHP 中函数的存在仅在解释器执行语句的最后一分钟才确定。

因此，如果您在永远不会评估为 的条件中缺少函数，`true`则不会触发任何错误。

例如：

```
if (false) {
    this_function_does_not_exist(); // this never gets run
}
// no errors 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T14:43:41.873

如果 xy 函数位于（负数）内部，则看不到错误`if`-仅在其触发时。不可能。

但是您可以像这样（检查）文件，并且您应该手动（硬编码）编写“可疑/可疑/隐藏/如果”函数.. 总比没有好。

```
$maybe_fns = (function1,function2); //... you should type in `if` functions here, manually 
$check    = @explode(',', $maybe_fns);

    while (list($key,$xxx) = each($check))
    {
    if(!function_exists($xxx)
    {
    echo '<b>Warning:</b> No function <b>'.$xxx.'</b><br>';
    }
    } 
```

在 alpha 和 beta 测试中可能会派上用场，而且肯定比阅读一堆函数文件更好。

# css - input[type="button"], input[type="submit"], 按钮 CSS 行为不正常

> ID：14082458
> 
> 赞同：5
> 
> 时间：2012-12-29T14:15:17.837
> 
> 标签：css

我正试图让它工作，但仍然有一些不正确的地方。

我想用 css 设置提交按钮的样式以匹配我已有的按钮。

`<input type="submit" name="save_settings" value="Opslaan">`

风格：

```
input[type="button"], input[type="submit"], button
{
   background: url("http://gasterijdebakker.nl/email/php/pages/images/layout/bg-btn-left.png") no-repeat scroll left top transparent;
   display: inline-block;
   line-height: 35px;
   padding:7px 0 15px 12px;
   margin:0;
   border:0;
   color: #FFFFFF;
   font-size: 15px;
   font-weight: bold;
   letter-spacing: -1px;
   text-shadow: 0 1px 1px #70A7E0; 
```

}

[jsFiddle](http://jsfiddle.net/VY8xs/70/)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T14:24:12.200

最好不要使用背景图像，而是使用 css3 渐变。就像是：

```
input[type="button"], input[type="submit"], button
{

  background-color: #a3d4ff;
  background-image: -webkit-gradient(linear, left top, left bottom, from(#a3d4ff), to(#88bcf2));
  background-image: -webkit-linear-gradient(top, #a3d4ff, #88bcf2);
  background-image:    -moz-linear-gradient(top, #a3d4ff, #88bcf2);
  background-image:      -o-linear-gradient(top, #a3d4ff, #88bcf2);
  background-image:         linear-gradient(to bottom, #a3d4ff, #88bcf2);
border-radius:3px;
    display: inline-block;
    line-height: 22px;
    padding:7px 12px;
    margin:0;
    border: 1px solid #88bcf2; 
    color: #FFFFFF;
    font-size: 15px;
    font-weight: bold;
    letter-spacing: -1px;
    text-shadow: 0 1px 1px #70A7E0;
    cursor:pointer;
}​ 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-29T16:09:58.180

`input`元素不能完全样式化。

相反，使用一个`button`元素。

> 按钮元素比输入元素更容易设置样式。您可以添加内部 HTML 内容（想想 em、strong 甚至 img），并利用 :after 和 :before 伪元素来实现复杂的渲染，而 input 只接受文本值属性。

资源：

Mozilla 开发者网络

[https://developer.mozilla.org/en-US/docs/HTML/Element/button](https://developer.mozilla.org/en-US/docs/HTML/Element/button)

# mysql - MySQL中的复杂SELECT查询

> ID：14082465
> 
> 赞同：2
> 
> 时间：2012-12-29T14:16:05.497
> 
> 标签：mysql, sql, select, join, tags

我有以下表格：

```
articles: id, title, content
tags: id, tag, tagCategory
tags2articles: id, idTag, idArticle
categories: id, title, someOtherFields 
```

在一个页面中，我需要选择所有具有多个标签的文章。我正在使用这个：

```
SELECT
   SQL_CALC_FOUND_ROWS a.* 
FROM 
  articles AS a
  JOIN tags2articles AS ta  ON a.id=ta.idArticle
  JOIN tags AS t ON ta.idTag=t.id
WHERE 
  t.id IN (12,13,16) 
GROUP BY a.id
HAVING
  COUNT(DISTINCT t.id)=3 
```

这将选择所有具有 ID 为 12,13 和 16 的标签的文章，并且工作正常。但是，所选文章也可能具有其他标签，这些标签可能仅特定于其中一个或多个。

棘手的部分来了：我想使用这些标签来制作一些过滤器，所以我需要另一个查询来选择上面文章所具有的所有不同标签。像这样的东西：

```
╔═══════╦══════╦═══════════╦════════════════╗
║ TagID ║ Tag  ║ Category  ║ SomeOtherField ║
╠═══════╬══════╬═══════════╬════════════════╣
║ id1   ║ tag1 ║ category1 ║ field1         ║
║ id2   ║ tag2 ║ category2 ║ field2         ║
║ id3   ║ tag3 ║ category1 ║ field1         ║
║ id4   ║ tag4 ║ category3 ║ field3         ║
╚═══════╩══════╩═══════════╩════════════════╝ 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-29T14:24:24.243

使用与您已有的类似查询作为要加入的派生表（但没有所有`a.*`列），您可以执行`INNER JOIN`反对`tags2articles`以获取这些文章 ID 具有的剩余标签。

这应该导致任何匹配文章持有的*所有标签的不同列表。*

```
SELECT 
  DISTINCT
  t.id,
  t.tag, 
  c.title AS Category
FROM
  tags2Articles t2a 
  INNER JOIN tags t ON t.id = t2a.idTag
  INNER JOIN categories c ON t.tagCategory = c.id
  /* Subquery join returns article ids having all 3 tags you filtered */
  /* Joining against tags2articles again will get the remaining tags for these articles */
  INNER JOIN (
    SELECT
     a.id 
    FROM 
     articles AS a
     JOIN tags2articles AS ta  ON a.id=ta.idArticle
     JOIN tags AS tsub ON ta.idTag=tsub.id
    WHERE 
      tsub.id IN (12,13,16) 
    GROUP BY a.id
    HAVING COUNT(DISTINCT tsub.id)=3 
  ) asub ON t2a.idArticle = asub.id 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-29T15:57:48.927

这是对迈克尔答案的重写，删除了无关的连接：

```
SELECT DISTINCT t.id, t.tag, c.title AS Category
FROM tags2Articles t2a INNER JOIN
     tags t
     ON t.id = t2a.idTag INNER JOIN
     categories c ON t.tagCategory = c.id inner join
     /* Subquery join returns article ids having all 3 tags you filtered */
     /* Joining against tags2articles again will get the remaining tags for these articles */
     (SELECT t2a.idArticle
      FROM tags2articles t2a
      WHERE t2a.idTag IN (12,13,16) 
      GROUP BY t2a.idArticle
      HAVING COUNT(DISTINCT t2a.idTag)=3 
    ) asub
    ON t2a.idArticle = asub.idArticle 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-30T15:20:02.333

这可能看起来很难看，但它可能会更快

```
SELECT a.*
FROM articles AS a
WHERE 1=1
AND EXISTS (
  SELECT *
  FROM tags2articles AS ta   
  JOIN tags AS t ON ta.idTag=t.id
  WHERE  a.id=ta.idArticle AND t.id = 12
  )
AND EXISTS (
  SELECT *
  FROM tags2articles AS ta  
  JOIN tags AS t ON ta.idTag=t.id
  WHERE  a.id=ta.idArticle AND t.id = 13
  )
AND EXISTS (
  SELECT *
  FROM tags2articles AS ta  
  JOIN tags AS t ON ta.idTag=t.id
  WHERE  a.id=ta.idArticle AND t.id = 16
  )
  ; 
```

顺便说一句：由于`ta.idTag=t.id`.

# asp.net - 当我从后面的代码中添加 LinkBut ton 的 Click 事件时，它不会调用

> ID：14082471
> 
> 赞同：1
> 
> 时间：2012-12-29T14:16:55.753
> 
> 标签：asp.net

我使用下面的代码设置点击`LinkButton`但不调用事件，当我点击链接按钮时，它隐藏了

```
LinkButton lnk = new LinkButton();
lnk.Text = "....";
lnk.Click+=new EventHandler(lnk_Click);
pnl.Controls.Add(lnk); // pnl is Panel in GridView's cell

//event
protected void lnk_Click(object sender, EventArgs e)
{
   //...
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T14:18:46.257

您还必须`void`将`protected`

`protected void lnk_Click(object sender, EventArgs e) { }`

在标记中，您需要添加`OnClick="lnk_Click"`您的`LinkButton`.

编辑：我注意到您正在`LinkButton`从后面创建代码。

要添加`OnClick`事件，您可以使用`lnk.Attributes.Add("onclick", Page.ClientScript.GetPostBackEventReference(this, lnk.ID.ToString()));`

[http://msdn.microsoft.com/en-us/library/ms153112.aspx](http://msdn.microsoft.com/en-us/library/ms153112.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T14:22:59.440

用这个

```
LinkButton lnk = new LinkButton();
lnk.Text = "....";
lnk.Click+=new EventHandler(lnk_Click);
pnl.Controls.Add(lnk); // pnl is Panel in GridView's cell

protected void lnk_Click(object sender, EventArgs e)
{
LinkButton lnk = sender as LinkButton;
// your work
} 
```

# bash - Bash，正则表达式，文件参数

> ID：14082473
> 
> 赞同：0
> 
> 时间：2012-12-29T14:17:04.097
> 
> 标签：bash

我有一个任务，我必须向文件发送无限的参数列表，文件必须打印以下列方式重复的字符串：

> NumNumNumCharCharChar...

*   号码
*   字符

**每三个后面的数字都相同，以及接下来的三个字符，**然后是另外三个数字，然后是另外三个字符。字符串必须以数字开头并以重复的方式以字符结尾。

为了解决这个问题，你可以*只* `grep`使用/ `egrep`— 取决于你，这意味着解决方案是在正则表达式中。

好的，这就是我想为 egrep 做的事情：

```
egrep "^([0-9][0-9][0-9][a-b][a-b][a-b])\1*$" 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T16:09:49.917

你的尝试几乎是正确的。反向引用`\1`将需要匹配字符串的重复，而不是匹配模式。允许模式重复。在重复中，您确实需要反向引用：

```
egrep '^(([0-9])\2{2}([a-z])\3{2})+$' file 
```

作为一个 shell 脚本调整，我切换到单引号（双引号不太安全）并将小写类扩展为`[a-z]`. 请注意，外括号是第 1 组，因此对内括号表达式的反向引用将是`\2`and `\3`。

# c++ - 为日志记录提供回调的最佳方法是什么？

> ID：14082476
> 
> 赞同：1
> 
> 时间：2012-12-29T14:17:16.903
> 
> 标签：c++

我有调用宏进行日志记录的第三方库。在该宏中，他们使用 fprintf 进行日志记录。我正在考虑修改代码以定义用于日志记录的自定义回调，但我不确定什么是最好的方法。

我想要的解决方案是：

*   用户可以为日志记录定义回调。
*   如果未定义回调，请使用 fprint。

所以我正在寻找某种类型的具有默认定义的静态函数，如果我愿意，我可以覆盖它。

这样做的最佳方法是什么？由于我们不能重载静态函数，所以每个人都需要定义他们对日志函数的定义。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T14:38:43.353

像这样的东西：

```
typedef void (*logfuncp)(...);

logfuncp callbackfuncp = NULL;

void logfunction(...)
{
   if (callbackfuncp) 
       callbackfuncp(...);
   else
       fprintf(logfile, ...);
}

void setcustomlogfunction(logfuncp newcallback)
{
    callbackfuncp = newcallback;
} 
```

应该管用。代表您的`...`日志记录参数，当然可以是使用真正的`...`C 语法的 var-args，但不一定是。一切都取决于您的日志记录是什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T14:34:14.743

上次遇到类似问题时，我使用了函数指针。

让记录器使用函数指针调用函数。

默认情况下，将指针设置为您的默认方法（调用 fprintf ）。

如果用户想要覆盖该行为，他们将使用自己的功能。

....只是另一种解决方案

# c# - C#在Windows 8上执行路径中带有空格的外部进程

> ID：14082482
> 
> 赞同：4
> 
> 时间：2012-12-29T14:17:33.817
> 
> 标签：c#

当 Windows 8 上的路径中有空格时，我在 C# 中启动进程时遇到问题，*即使路径是双引号！*

以下代码在我们的 XP 和 Windows 7 机器上运行良好多年，但我们最近将一些开发框切换到 Windows 8，现在我们收到以下错误：

`'D:\Workspace\Visual' is not recognized as an internal or external command, operable program or batch file.`

代码：

```
string command = "\"D:\\Workspace\\Visual Studio 2010\\Dev\\Tools\\Editors\\AssetManager\\bin\\Tools\\TextureAtlasBuilder.exe\"";
string arguments = "\"D:\\Local\\Temp\\xu2twc4d.cg1\" \"environment-textures\"";

ProcessStartInfo startInfo = new ProcessStartInfo
{
    CreateNoWindow = true,
    UseShellExecute = false,
    WindowStyle = ProcessWindowStyle.Hidden,
    RedirectStandardError = true,
    RedirectStandardOutput = true,
    FileName = string.Format(CultureInfo.InvariantCulture, @"{0}\cmd.exe", Environment.SystemDirectory),
    Arguments = string.Format(CultureInfo.InvariantCulture, "/C {0} {1}", command, arguments)
};

Process process = new Process
{
    StartInfo = startInfo
};

process.OutputDataReceived += new DataReceivedEventHandler(StandardOutputHandler);
process.ErrorDataReceived += new DataReceivedEventHandler(StandardErrorHandler);

process.Start(); 
```

我试过带和不带双引号的文字字符串，带和不带双引号的逐字字符串，我总是得到同样的错误！

我究竟做错了什么？！

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T14:47:33.760

从参数字符串中删除 "。

这很棘手，因为 /C 的 cmd 行为对使用 " 非常严格，这可以从 cmd /? 中找到。如果全部失败：将命令行和参数写入临时 cmd 文件并启动该文件...

> 如果指定了 /C 或 /K，则切换后的命令行的其余部分作为命令行处理，其中使用以下逻辑处理引号 (") 字符：
> 
> ```
> 1\.  If all of the following conditions are met, then quote characters
>     on the command line are preserved:
> 
>     - no /S switch
>     - exactly two quote characters
>     - no special characters between the two quote characters,
>       where special is one of: &<>()@^|
>     - there are one or more whitespace characters between the
>       two quote characters
>     - the string between the two quote characters is the name
>       of an executable file.
> 
> 2\.  Otherwise, old behavior is to see if the first character is
>     a quote character and if so, strip the leading character and
>     remove the last quote character on the command line, preserving
>     any text after the last quote character. 
> ```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T14:23:00.713

我正在使用以下路径，并且它已成功接受。

```
string command1 = @"C:\test\ab ab\1.txt";
Process.Start(command1); 
```

# java - Java Arrays - 如何使用静态方法创建数组

> ID：14082485
> 
> 赞同：0
> 
> 时间：2012-12-29T14:18:08.103
> 
> 标签：java, arrays, methods

我正在搜索代码行以使用名为 insertRow(int[] row) 的方法创建一个新数组。使用这种方法，用户可以插入 5 个数字组成一个数组。那么这个数组应该命名为row2。请帮忙。

```
public class App 
{

    public static void main(String[] args) 
    {
        int[] row = new int[5];
        int[] row1 = {2,7,1,9,4};
        //int[] row2 = insertRow(row); this is wrong
    }

    public static void insertRow(int[] row)
    {
        for (int i = 0; i < row.length; i++)
        {
            int number;
            do
                number = Integer.parseInt(JOptionPane.showInputDialog("Insert the " + (i+1) + "th positif number"));
            while (getal < 0);

            row[i] = number;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T14:20:40.897

您走在正确的轨道上：将方法的签名更改为 return `int[]`，分配`row`内部，并将您的代码放在`...`下面：

```
public static int[] insertRow() {
    int[] row = new int[5];
    ...
    return row;
} 
```

现在这将起作用：

```
int[] row2 = insertRow(); // this is no longer wrong :) 
```

# python - 正则表达式捕获具有积极后视的组（python）

> ID：14082489
> 
> 赞同：2
> 
> 时间：2012-12-29T14:18:41.570
> 
> 标签：python, regex

如何将捕获的组与积极的后视相结合？

我想匹配以下示例：

```
DS
DS,x=y
一些 DS,key=value
一些DS测试，key=value&key2=value2
一些DS测试，key=value&key2=value2|key3=value3

```

我想出了以下正则表达式来匹配除逗号之外的所有内容：

```
^(?P<ds_title>[\w \|\-\=\&æøåÆØÅ]+)(?P<filters>[\w \|\-\=\&æøåÆØÅ]+)?$ 
```

我发现，我需要插入的正则表达式是：

```
(?<=\,) 
```

但我不知道在哪里插入它。无论我将它插入到哪里，它似乎都破裂了。有谁知道如何正确地做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T14:56:29.770

你是不是想多了？

```
^(?P<ds_title>[^,]+)(?:,(?P<filters>.+))?$ 
```

为什么不只允许任何字符串，而不是将其限制在您的列表中？

* * *

事实上，为什么要使用正则表达式呢？

```
parts = data.split(',', 2)
if len(parts) == 1:
    title, = parts
else:
    title, filters = parts 
```

# java - 错误：读取输入后无法写入输出

> ID：14082492
> 
> 赞同：-1
> 
> 时间：2012-12-29T14:18:47.560
> 
> 标签：java, inputstream, bufferedreader

我想从 java 桌面应用程序登录到一个网站，但主要问题是每次请求都会更改**ID**。`textbox`

`<input type="text" maxlength="10" name="UserName_88515" id="UserName_88515" />`

这里的 id 保持不变，直到`_`，接下来的 5 位数字随着每个请求而变化。所以我决定先阅读网页并检索 5 位数字。然后我尝试写入数据以登录网站。但是我收到了上面提到的错误。请帮忙。

```
public class LoginHandler {

static boolean isLoggedIn = false;
static String toastText, myText;

public void login(String usrname, String password, String cookys, String sessionCode) {

        try {

            URL url = new URL("http://www.somewebsite.com/home.php?session="
                    + sessionCode);
            HttpURLConnection conn = (HttpURLConnection) url.openConnection();
            conn.setDoOutput(true);
            conn.setRequestMethod("GET");
            conn.setRequestProperty("User-Agent",
                    "Mozilla/5.0 (Windows NT 6.1; WOW64; rv:17.0) Gecko/20100101 Firefox/17.0");
            conn.setRequestProperty("Cookie", cookys);
            conn.setDoOutput(true);

            final BufferedReader rd = new BufferedReader(new InputStreamReader(conn.getInputStream()));

            final StringBuilder response = new StringBuilder();
            myText = response.toString();
            String line;

            while ((line = rd.readLine()) != null) {
                response.append(line);
            }
            rd.close();

            final String text1 = response.toString();
            final int starIndex = text1.indexOf("UserName_");
            final int endIndex = starIndex + 15;
            System.err.println("This is starIndex" + starIndex);
            System.err.println("This is endIndex" + endIndex);
            final String avc = text1.substring(starIndex, endIndex);
            System.err.println("This is avc\n" + avc);
            final String fin = avc.substring(10, 15);
            System.err.println("This is fin\n" + fin);

            final String data1 = URLEncoder.encode("MessageLength", "UTF-8")
                    + "=" + URLEncoder.encode("140", "UTF-8") + "&"
                    + URLEncoder.encode("UserName_" + fin, "UTF-8") + "="
                    + URLEncoder.encode("username", "UTF-8") + "&"
                    + URLEncoder.encode("Password_" + fin, "UTF-8") + "="
                    + URLEncoder.encode("password", "UTF-8") + "&"
                    + URLEncoder.encode("LoginNowbtnDiv", "UTF-8") + "="
                    + URLEncoder.encode("Login Now", "UTF-8") + "&"
                    + URLEncoder.encode("LoginNow", "UTF-8") + "="
                    + URLEncoder.encode("Login Now", "UTF-8");

            System.err.println("THIS IS Data1:\n " + data1);

            final OutputStreamWriter wr = new OutputStreamWriter(conn.getOutputStream());
            wr.write(data1);
            wr.flush();

            final BufferedReader rd1 = new BufferedReader(new InputStreamReader(conn.getInputStream()));

            final StringBuilder response1 = new StringBuilder();
            String line1;

            while ((line1 = rd1.readLine()) != null) {
                response1.append(line1);
            }

            final String text2 = response1.toString();
            System.err.println("This is second response\n" + text2);
            rd1.close();
        } catch (Exception ex) {
            ex.printStackTrace();
        }
    }
} 
```

**编辑**

```
SEVERE: java.net.ProtocolException: Cannot write output after reading input.
at sun.net.www.protocol.http.HttpURLConnection.getOutputStream(HttpURLConnection.java:1083)
at mypack.UltooSender.send(UltooSender.java:80)
at mypack.NewServlet.processRequest(NewServlet.java:41)
at mypack.NewServlet.doGet(NewServlet.java:63)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:668)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:770)
at org.apache.catalina.core.StandardWrapper.service(StandardWrapper.java:1542)
at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:281)
at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:175)
at org.apache.catalina.core.StandardPipeline.doInvoke(StandardPipeline.java:655)
at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:595)
at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:161)
at org.apache.catalina.connector.CoyoteAdapter.doService(CoyoteAdapter.java:331)
at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:231)
at com.sun.enterprise.v3.services.impl.ContainerMapper$AdapterCallable.call(ContainerMapper.java:317)
at com.sun.enterprise.v3.services.impl.ContainerMapper.service(ContainerMapper.java:195)
at com.sun.grizzly.http.ProcessorTask.invokeAdapter(ProcessorTask.java:849)
at com.sun.grizzly.http.ProcessorTask.doProcess(ProcessorTask.java:746)
at com.sun.grizzly.http.ProcessorTask.process(ProcessorTask.java:1045)
at com.sun.grizzly.http.DefaultProtocolFilter.execute(DefaultProtocolFilter.java:228)
at com.sun.grizzly.DefaultProtocolChain.executeProtocolFilter(DefaultProtocolChain.java:137)
at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:104)
at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:90)
at com.sun.grizzly.http.HttpProtocolChain.execute(HttpProtocolChain.java:79)
at com.sun.grizzly.ProtocolChainContextTask.doCall(ProtocolChainContextTask.java:54)
at com.sun.grizzly.SelectionKeyContextTask.call(SelectionKeyContextTask.java:59)
at com.sun.grizzly.ContextTask.run(ContextTask.java:71)
at com.sun.grizzly.util.AbstractThreadPool$Worker.doWork(AbstractThreadPool.java:532)
at com.sun.grizzly.util.AbstractThreadPool$Worker.run(AbstractThreadPool.java:513)
at java.lang.Thread.run(Thread.java:722)

SEVERE:     at sun.net.www.protocol.http.HttpURLConnection.getOutputStream(HttpURLConnection.java:1083)
SEVERE:     at mypack.UltooSender.send(UltooSender.java:80)
SEVERE:     at mypack.NewServlet.processRequest(NewServlet.java:41)
SEVERE:     at mypack.NewServlet.doGet(NewServlet.java:63)
SEVERE:     at javax.servlet.http.HttpServlet.service(HttpServlet.java:668)
SEVERE:     at javax.servlet.http.HttpServlet.service(HttpServlet.java:770)
SEVERE:     at org.apache.catalina.core.StandardWrapper.service(StandardWrapper.java:1542)
SEVERE:     at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:281)
SEVERE:     at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:175)
SEVERE:     at org.apache.catalina.core.StandardPipeline.doInvoke(StandardPipeline.java:655)
SEVERE:     at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:595)
SEVERE:     at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:161)
SEVERE:     at org.apache.catalina.connector.CoyoteAdapter.doService(CoyoteAdapter.java:331)
SEVERE:     at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:231)
SEVERE:     at com.sun.enterprise.v3.services.impl.ContainerMapper$AdapterCallable.call(ContainerMapper.java:317)
SEVERE:     at com.sun.enterprise.v3.services.impl.ContainerMapper.service(ContainerMapper.java:195)
SEVERE:     at com.sun.grizzly.http.ProcessorTask.invokeAdapter(ProcessorTask.java:849)
SEVERE:     at com.sun.grizzly.http.ProcessorTask.doProcess(ProcessorTask.java:746)
SEVERE:     at com.sun.grizzly.http.ProcessorTask.process(ProcessorTask.java:1045)
SEVERE:     at com.sun.grizzly.http.DefaultProtocolFilter.execute(DefaultProtocolFilter.java:228)
SEVERE:     at com.sun.grizzly.DefaultProtocolChain.executeProtocolFilter(DefaultProtocolChain.java:137)
SEVERE:     at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:104)
SEVERE:     at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:90)
SEVERE:     at com.sun.grizzly.http.HttpProtocolChain.execute(HttpProtocolChain.java:79)
SEVERE:     at com.sun.grizzly.ProtocolChainContextTask.doCall(ProtocolChainContextTask.java:54)
SEVERE:     at com.sun.grizzly.SelectionKeyContextTask.call(SelectionKeyContextTask.java:59)
SEVERE:     at com.sun.grizzly.ContextTask.run(ContextTask.java:71)
SEVERE:     at com.sun.grizzly.util.AbstractThreadPool$Worker.doWork(AbstractThreadPool.java:532)
SEVERE:     at com.sun.grizzly.util.AbstractThreadPool$Worker.run(AbstractThreadPool.java:513)
SEVERE:     at java.lang.Thread.run(Thread.java:722) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T14:40:09.927

如果您在获取 HttpURLConnection.getInputStream() 之后尝试获取 HttpURLConnection.getOutputStream()，则会出现此异常。

在这一行中，您将获得 InputStream，

```
final BufferedReader rd = new BufferedReader(new InputStreamReader(conn.getInputStream())); 
```

在这一行中，您试图获取 outputStream，

```
final OutputStreamWriter wr = new OutputStreamWriter(conn.getOutputStream()); 
```

# php - PHP中的MySql表锁

> ID：14082493
> 
> 赞同：5
> 
> 时间：2012-12-29T14:18:52.763
> 
> 标签：php, mysql, web-services, pdo, locking

我在 PHP 中创建一个 web 服务，它基于从表中选择的内容进行一系列计算，然后使用新结果更新表。

但是，我想防止另一个人在另一个人的会话仍在进行更新时调用同一个 Web 服务的情况。

锁定整个表然后再次解锁它是正确的吗？如果是这样，我如何使用 PHP pdo 锁定和解锁 mysql 表？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T14:26:26.727

像 MySQL 这样的数据库管理系统足够聪明，可以防止这样的并发冲突。

查找数据库隔离级别（未提交读、已提交读、可重复读、可序列化）和可能的问题（脏读、不可重复读...）-> [Wikipedia](http://en.wikipedia.org/wiki/Isolation_%28database_systems%29)。

就个人而言，我不建议在您的情况下使用表锁。你最好**将你的计算和数据库操作包装在一个事务中**，并依靠 DBMS 来管理你的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T14:25:11.173

我发表了一条评论：

> 不是直接的答案，但我认为这没有任何问题。从数据库中计算和获取数据在几毫秒内完成。两个人同时互动的机会太小了，以至于大多数人都懒得做这样的锁。

但是，如果这些计算很关键，您可以通过添加一个新字段并简单地调用它来防止这个问题`occupied`，`busy`或者类似的东西。

运行脚本时，检查此字段是否设置为例如 1，如果是，则让脚本休眠 1-2-3 秒，然后重试。如果此字段设置为 0，请将其更新为 1，进行计算并再次将其设置回 0。

这将防止两个人同时访问相同的值。

# opengl - 如何从 opengl FrameBufferObject 获取 RGB 像素以进行 libx264 编码？

> ID：14082495
> 
> 赞同：-1
> 
> 时间：2012-12-29T14:19:06.960
> 
> 标签：opengl, rgb, pixels, fbo, libx264

我想从 FrameBufferObject 中获取 RGB 像素：fboName。有什么方法吗？从 GPU 到 CPU 的内存映射会花费大量时间吗？

```
 glGenFramebuffers(1, &fboName);
    glBindFramebuffer(GL_FRAMEBUFFER, fboName);     
    glFramebufferTexture2D(GL_FRAMEBUFFER, GL_COLOR_ATTACHMENT0, GL_TEXTURE_2D, colorTexture, 0);
    glFramebufferRenderbuffer(GL_FRAMEBUFFER, GL_DEPTH_ATTACHMENT, GL_RENDERBUFFER, depthRenderbuffer); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T15:47:15.953

用于`glReadPixels`从帧缓冲区读取图像。您可以直接打包到客户端内存，也可以使用中间像素缓冲区对象来允许异步操作和内存映射。

> 从 GPU 到 CPU 的内存映射会花费大量时间吗？

无论如何，您都必须将数据从 GPU 内存复制到系统内存。如果它是通过内存映射（即通过页面错误触发 DMA 传输）或通过 glGetBufferSubData（使用 PBO）或 glReadPixels 显式完成的，那么在带宽利用率和性能方面没有太大差异。最重要的是，请求的像素格式与 GPU 端的数据格式相匹配，否则必须执行昂贵的转换。

由于您想将数据提供给`libx264`我会说使用映射缓冲区效果最好，这样您就可以将前一帧的 libx264 处理与下一帧的异步传输交错。

# javascript - 在其他内部的 JQuery 中创建元素

> ID：14082496
> 
> 赞同：1
> 
> 时间：2012-12-29T14:19:13.210
> 
> 标签：javascript, jquery, dom

我知道如何使用 JQuery 创建一个元素，但我不知道如何将该元素放置在我想要的位置。

```
<form action="/register" enctype="multipart/form-data" method="POST">
  <span class="help-block">Username</span>
  <input id="checkuser" type="text" name="nuser" placeholder="Username"/>
  <span class="help-block">Email</span>
  <input id="mail" type="text" name="nmail" placeholder="Your m@il"/>
  <span class="help-block">Password</span>
  <input type="password" name="npass" placeholder="Your password"/>
  <span class="help-block">Avatar</span>
  <input type="file" name="navatar" accept="image/*">
  <br/>
  <input type="submit" value="Submit"/>
</form> 
```

我正在使用 JQuery 进行 AJAX 请求，因此，取决于请求的结果，我创建或不是输入左侧的元素。我该怎么做？

谢谢提前！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T14:24:10.203

如果输入*左侧*的意思是在它之前，那么您可以使用[`.insertBefore()`](http://api.jquery.com/insertBefore/).

```
$("<span/>", {
  text: "My newly created span element"
}).insertBefore("input#checkuser"); 
```

或者，您也可以使用[`.before()`](http://api.jquery.com/before/).

# mysql - mysql错误号150

> ID：14082498
> 
> 赞同：0
> 
> 时间：2012-12-29T14:19:14.620
> 
> 标签：mysql, sql, foreign-keys

我有两个表“成员”和“书”定义为：

```
create table member(

      mem_id bigint(11) unsigned auto_increment not null primary key,
      firstname varchar(20) not null,
      lastname varchar(20) not null,
      gender varchar(1) not null
);

create table book(

      book_id varchar(15) not null primary key,
      isbn varchar(15) not null,
      book_name varchar(100) not null
); 
```

现在我想创建名为'return_book'的下表：

```
create table return_book(

      mem_id bigint(11) unsigned not null,
      book_id varchar(15) , 
      date date,    
      primary key(mem_id, book_id),
      foreign key(mem_id) references member(mem_id) 
      ON DELETE CASCADE,
      foreign key(book_id) references book(book_id)
      ON DELETE NO ACTION
      ON UPDATE CASCADE            
); 
```

但我总是收到以下错误：“无法创建表 return_book”请帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T14:21:39.247

您有语法错误

```
create table return_book(
mem_id bigint(11) unsigned not null,
book_id varchar(15) , 
date date,  
  primary key(mem_id, book_id),
  foreign key(mem_id) references member(mem_id) 
  ON DELETE CASCADE,
  foreign key(book_id) references book(book_id)
  ON DELETE NO ACTION
  ON UPDATE CASCADE            
); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T17:13:29.370

'member' 表中的列名 'mem_id' 有错字：D！此外，我还了解到引用列和引用列必须具有相同的类型。

# visio - 使用 C# 从 Visio 主组文件中获取单个元素

> ID：14082502
> 
> 赞同：1
> 
> 时间：2012-12-29T14:19:32.717
> 
> 标签：visio

我需要创建一个 Visio 文档并从 .vss 文件中添加形状。我能够添加简单的形状并向其添加文本，而不会出现任何问题。但是当我尝试添加一个形状时遇到问题，该形状是 4 个矩形组合在一起的集合（我相信它被称为母版）并向每个形状添加文本。

我想在组中的每个矩形形状中填充值（添加文本）。一旦我将此母版放到 Visio 页面中，它就会显示为一个组。我可以使用该`Ungroup()`方法取消对每个矩形的分组。但我不知道如何从这个组中获取每个单独的元素。有没有一种方法可以唯一标识该组中的每个元素？或者遍历组并找到每个元素？请看下面的代码，到目前为止我做了什么。

```
Visio.Document doc = application.Documents.Add(@"\example.vst");
Visio.Page page = application.Documents[1].Pages[1];
Visio.Documents vdocs = application.Documents;
Visio.Document visioStencil = vdocs.OpenEx(@"\sample.vss", (short)Microsoft.Office.Interop.Visio.VisOpenSaveArgs.visOpenDocked);
Visio.Page visioPage = application.ActivePage;
Visio.Shapes visShapes = visioPage.Shapes;
//the following shape in the setensil is the group of 4 rectanle I was referring 
Visio.Master visioConvMaster = visioStencil.Masters.get_ItemU(@"Conveyance");
Visio.Shape visioConvShape = visioPage.Drop(visioConvMaster, 4.25, 5.5);
//try to ungroup to get each 
visioConvShape.Ungroup(); 
```

知道我应该如何进一步进行吗？我对 Microsoft 技术真的很陌生。我正在使用 Visual Studio 2012 专业版和 Visio 2010 高级版。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-10T17:27:14.107

Visio.Shape 对象具有属性“Shapes”，它是子形状的集合。不要取消分组；首先，遍历 Shapes 集合（visioConvShape.Shapes[0]、visioConvShape.Shapes[1] 等），然后如果您需要取消分组，请在至少执行了您需要的任何操作或识别它们之后执行此操作和/或给他们可重用的名称。

# iphone - MapKit：对 CGPathCreateMutableCopyByTransformingPath 的访问不正确

> ID：14082508
> 
> 赞同：1
> 
> 时间：2012-12-29T14:20:14.460
> 
> 标签：iphone, objective-c, ios, mapkit

这是我的崩溃

![在此处输入图像描述](../Images/642c286b7aebae60dbb862719459a72c.png)

崩溃地址要么是，要么`0x00000000`有时`0x00000001`甚至是`0x00000002`

![在此处输入图像描述](../Images/cae20c77925845981b4401bec2e566c7.png)

![在此处输入图像描述](../Images/fd49dc4f2517ca2328d55099ae36b559.png)

我在使用 Map Kit 时崩溃了。我正在从数据库向地图添加大量叠加层。此崩溃看起来与将实际叠加层绘制到地图上有关。我以通常的方式添加 MKPolyLines。

```
MKPolyline* pathOverlay = [MKPolyline polylineWithCoordinates:locations count:pathIndex];
free(locations);
[overlays addObject:pathOverlay];
...
[self.mapView addOverlays:overlays]; 
```

有没有人有什么建议？如果需要，我可以发布更多代码。

谢谢。

# java - 我无法使用 JAX-WS 返回数组 String[]

> ID：14082509
> 
> 赞同：2
> 
> 时间：2012-12-29T14:20:16.083
> 
> 标签：java, arrays, web-services, jax-ws

我在 JAX-WS 中返回简单 String[] 有问题。我有一个@WebMethod：

```
 public String[] getUserInfo() {
        MessageContext mc = wsContext.getMessageContext();
        HttpSession session = ((javax.servlet.http.HttpServletRequest) mc.get(MessageContext.SERVLET_REQUEST)).getSession();
        String username = (String) session.getAttribute("username");
        String[] userInfo = new String[4];
        Session hibSess = HibernateUtil.getSessionFactory().openSession();
        hibSess.beginTransaction();
        String query = "select id, login, email, active from User as user where user.login ='Mrl'";
        Query queryResult = hibSess.createQuery(query);
        java.util.List user = queryResult.list();
        int i;
        int j;
        Object object = null;
        for (i = 0; i < user.size(); i++) {
            Object[] obj = (Object[]) user.get(i);
            for (j = 0; j < obj.length; j++) {
                userInfo[j] = obj[j].toString();
            }
        }
        /* Here is the moment when I check the array on server side - it's fine */
        System.out.println("US:"+user.size() + ", userInfo length" +userInfo.length+"\n"+userInfo[0]
                +"\n"+userInfo[1]+"\n"+userInfo[2]+"\n"+userInfo[3]);
        return userInfo;
    } 
```

数组应该有四个元素。在服务器上它有四个元素，它们包含正确的数据。

当我尝试在我的客户端上获取该数组时，我没有收到任何错误。我只是得到一个空的单元素数组。

这是客户端代码：

```
@XmlAccessorType(XmlAccessType.FIELD)
@XmlType(name = "getUserInfo")
public class GetUserInfo {
}

@XmlAccessorType(XmlAccessType.FIELD)
@XmlType(name = "getUserInfoResponse", propOrder = {
    "_return"
})
public class GetUserInfoResponse {
@XmlElement(name = "return")
protected String[] _return;

public String[] getReturn() {
    return _return;
}

public void setReturn(String[] value) {
    this._return = value;
}

} 
```

为了运行我使用的客户端：

```
SimpleWebService proxy = new SimpleWebServiceService().getSimpleWebServicePort();
    ((BindingProvider)proxy).getRequestContext().put(BindingProvider.SESSION_MAINTAIN_PROPERTY,true);
proxy.connect();
String[] userArray = proxy.getUserInfo(); 
```

服务器 wsdl 片段：

```
<message name="getUserInfo"/>
<message name="getUserInfoResponse">
    <part xmlns:ns2="http://jaxb.dev.java.net/array" name="return" type="ns2:stringArray"/>
</message> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T16:22:44.147

您可以使用`List`而不是数组，这是 jax-ws 中的默认设置。

但是，`XmlAdapter`如果您真的坚持使用该数组类型，则可以使用自定义，它在 jax-ws 可以理解的类型和自定义的新类型之间进行调整。

您需要注释：

```
@XmlElement(name = "return")
@XmlJavaTypeAdapter(StringArrayXmlAdapter.class)
protected String[] _return; 
```

**StringArrayXmlAdapter**：

```
import java.util.ArrayList;
import java.util.Arrays;
import java.util.List;

import javax.xml.bind.annotation.adapters.XmlAdapter;

public class StringArrayXmlTypeAdapter extends
        XmlAdapter<List<String>, String[]> {
    @Override
    public List<String> marshal(String[] arg) throws Exception {
        return new ArrayList<String>(Arrays.asList(arg));
    }

    @Override
    public String[] unmarshal(List<String> arg) throws Exception {
        return arg.toArray(new String[] {});
    }
} 
```

我没有尝试使用数组，所以我不能保证它完全像这样工作。

# iphone - 从 monotouch 将 iphone 应用程序部署到单部手机的最低成本是多少？

> ID：14082513
> 
> 赞同：1
> 
> 时间：2012-12-29T14:20:26.077
> 
> 标签：iphone, ios, xamarin.ios, monodevelop

如果我只想在我的手机上部署一个 iphone 应用程序（而不是应用程序商店出售给其他人），您需要购买的最少东西是多少？

如果我只想构建一个只有我会使用的应用程序，我 是否必须[在 monotouch 上](https://store.xamarin.com/)花费399 美元和[每年 99 美元的苹果开发者费用？](https://developer.apple.com/programs/ios/)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-30T16:17:16.923

您需要向 Apple 支付 99，向 Xamarin 支付 399 才能使用 MonoTouch

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-12-29T14:39:48.900

您每年只需支付 99 美元的苹果开发者费用。

# sql - 根据另一列中的不同值设置列值

> ID：14082515
> 
> 赞同：0
> 
> 时间：2012-12-29T14:20:39.050
> 
> 标签：sql, distinct, inner-join

我正在尝试做与这个问题非常相似的事情：[mysql - UPDATEing row based on other rows](https://stackoverflow.com/questions/4908245/mysql-updateing-row-based-on-other-rows)

我有一个名为 modset 的表，格式如下：

```
member    year    y1    y2    y3    y1y2    y2y3    y1y3    y1y2y3 
a         1       0     0     0     0       0       0       0
a         2       0     0     0     0       0       0       0
a         3       0     0     0     0       0       0       0
b         1       0     0     0     0       0       0       0
b         2       0     0     0     0       0       0       0
c         1       0     0     0     0       0       0       0
c         3       0     0     0     0       0       0       0
d         2       0     0     0     0       0       0       0 
```

列 3:9 是二进制标志，用于指示成员记录的年份组合。所以我希望 SQL 更新的结果如下所示：

```
member    year    y1    y2    y3    y1y2    y2y3    y1y3    y1y2y3 
a         1       0     0     0     0       0       0       1
a         2       0     0     0     0       0       0       1
a         3       0     0     0     0       0       0       1
b         1       0     0     0     1       0       0       0
b         2       0     0     0     1       0       0       0
c         1       0     0     0     0       0       1       0
c         3       0     0     0     0       0       1       0
d         2       0     1     0     0       0       0       0 
```

上面链接的问题中的代码做了一些非常接近的事情，但只有当它是成员拥有记录的不同年份的计数时。我需要将列基于成员拥有记录的年份的特定值。

提前致谢！

**解决方案**

```
SELECT member,
    case when min(distinct(year)) = 1 and max(distinct(year)) = 1 then 1 else 0 end y1,
    case when min(distinct(year)) = 1 and max(distinct(year)) = 2 then 1 else 0 end y1y2,
    case when min(distinct(year)) = 1 and max(distinct(year)) = 3 and count(distinct(year)) = 2 then 1 else 0 end y1y3,
    case when min(distinct(year)) = 1 and max(distinct(year)) = 3 and count(distinct(year)) = 3 then 1 else 0 end y1y2y3,
    case when min(distinct(year)) = 2 and max(distinct(year)) = 2 then 1 else 0 end y2,
    case when min(distinct(year)) = 2 and max(distinct(year)) = 3 then 1 else 0 end y2y3,
    case when min(distinct(year)) = 3 then 1 else 0 end y3
INTO temp5
FROM modset
GROUP BY member;

UPDATE modset M
SET y1 = T.y1, y2 = T.y1, y3 = T.y3, y1y2 = T.y1y2, y1y3 = T.y1y3, y2y3 = T.y2y3, y1y2y3 = T.y1y2y3
FROM temp5 T
WHERE T.member = M.member; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T15:16:04.510

您使用什么查询来返回成员有记录的年份的指标？

听起来您希望获取查询结果并在更新中使用它：

[http://dev.mysql.com/doc/refman/5.0/en/update.html](http://dev.mysql.com/doc/refman/5.0/en/update.html)

它可能看起来像这样：

```
UPDATE targetTable t, sourceTable s 
SET t.y1 = s.y1, t.y2 = s.y2 -- (and so on...)
WHERE t.member = s.member AND t.year = m.year; 
```

# google-fusion-tables - 奇数融合表地图嵌入 - 所有红色区域

> ID：14082518
> 
> 赞同：0
> 
> 时间：2012-12-29T14:20:48.867
> 
> 标签：google-fusion-tables

我正在开发一个带有填充区域的融合表地图。在 Google Fusion Table 网络应用程序上，它可以正常工作（[链接](https://www.google.com/fusiontables/DataSource?docid=1gjBg_x5myM7p609Gz-mBJel5B8VLitg4E29R-Ok#map%3aid=3)）。但是当我尝试嵌入它时，所有区域都变成了红色（[链接](http://www.datajournalist.it/obiettori/EN_ru486.html)）。

为什么会这样？我试图从另一台计算机打开该站点 - 但同样的问题。

谢谢，

酶联免疫吸附试验

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-01T13:43:11.670

[Fusion Tables Users Group 中的](https://groups.google.com/group/fusion-tables-users-group/browse_frm/thread/24cc7a875ebbfeaa#)这个线程（以及其中引用的线程）可能适用。“新”外观中现在有多种样式可用，如果您不引用正确的样式，您将无法获得您配置的样式。

您可能需要适当地设置样式 ID。此查询将样式 id 设置为 2：

```
var layer = new google.maps.FusionTablesLayer({ 
  query: { 
    select: locationColumn, 
    from: tableId 
  }, 
  styleId: 2, 
  map: map 
}); 
```

这[在 Fusion Tables 文档中有所描述](https://developers.google.com/fusiontables/docs/v1/using#WorkingStyles)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T20:21:13.123

我通过回滚到经典外观解决了。请团队，检查新外观的情况。

# sql - 无法绑定多部分标识符

> ID：14082520
> 
> 赞同：5
> 
> 时间：2012-12-29T14:20:54.823
> 
> 标签：sql, sql-server-2008, inner-join, multiple-select-query

试试这个

```
select tblPersonalInfo.companyname, tblJobBudget.title,tblJobBudget.lastmodifiedby,
tblJobAdv.advtitle, tblJobAdv.userId,       
tblApplication.advid, tblApplication.position
from tblJobAdv 
inner join tblApplication
ON tblJobAdv.advid = tblApplication.advid
inner join tblPersonalInfo
On tblJobBudget.lastmodifiedby = tblPersonalInfo.userid 
```

给出错误

```
Msg 4104, Level 16, State 1, Line 8
The multi-part identifier "tblJobBudget.lastmodifiedby" could not be bound.
Msg 4104, Level 16, State 1, Line 2
The multi-part identifier "tblJobBudget.title" could not be bound.
Msg 4104, Level 16, State 1, Line 2 
```

无法绑定多部分标识符“tblJobBudget.lastmodifiedby”。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-29T14:42:55.820

这是因为没有任何带有`tblJobBudget`标识符的表或表别名。

你的桌子是：

*   `tblJobAdv`
*   `tblApplication`
*   `tblPersonalInfo`

但不是：

*   `tblJobBudget`

如果您需要表中的列，`tblJobBudget`则应将其包含`tblJobBudget`在带有`join`子句的表中：

```
from       tblJobAdv 
inner join tblApplication
   ON tblJobAdv.advid = tblApplication.advid
inner join tblJobBudget                              <--here
   ON ...
inner join tblPersonalInfo
   ON ... 
```

# sql - 在单个数据库中内连接超过 2 个表

> ID：14082524
> 
> 赞同：0
> 
> 时间：2012-12-29T14:21:16.383
> 
> 标签：sql, inner-join

我想在一个数据库中的一个选择查询中内联超过 3 个表，所有这些表都将 rm_id 作为一个公共列，但我想在一个 sql 查询中显示所有表的行是否有可能，如果是这样的话，我会真诚地请求你提供一些代码

```
select * from 
        bk_det inner join
        bk_rep inner join
        bk_sec inner join
        mut_det inner join
        rm_det inner join
        soil_det 
on
          bk_det.rm_id =   bk_rep.rm_id =  bk_sec.rm_id =  mut_det.rm_id = rm_det.rm_id = soil_det.rm_id 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-29T14:26:11.297

每个内部连接都需要一个 on 子句。例如

```
select * from a 
inner join b on a.id = b.id 
inner join c on b.id = c.id 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-29T14:27:12.377

您缺少`ON`每个连接的子句：

```
select * 
from bk_det 
inner join bk_rep 
  on bk_det.rm_id =  bk_rep.rm_id
inner join bk_sec 
  on bk_rep.rm_id = bk_sec.rm_id
inner join mut_det 
  on bk_sec.rm_id =  mut_det.rm_id
inner join rm_det 
  on mut_det.rm_id = rm_det.rm_id
inner join soil_det 
    on rm_det.rm_id = soil_det.rm_id 
```

*注意：您必须检查连接条件列名，因为我不知道您的表结构*

如果您在学习连接语法方面需要帮助，这里是[对连接的一个很好的可视化解释](http://www.codinghorror.com/blog/2007/10/a-visual-explanation-of-sql-joins.html)。

由于您使用的是，如果每个表中都存在，`INNER JOIN`则这将返回记录。`rm_id`

您可能需要使用`LEFT JOIN`：

```
select * 
from bk_det 
left join bk_rep 
  on bk_det.rm_id =  bk_rep.rm_id
left join bk_sec 
  on bk_rep.rm_id = bk_sec.rm_id
left join mut_det 
  on bk_sec.rm_id =  mut_det.rm_id
left join rm_det 
  on mut_det.rm_id = rm_det.rm_id
left join soil_det 
    on rm_det.rm_id = soil_det.rm_id 
```

# r - 如何计算时间序列的一阶导数

> ID：14082525
> 
> 赞同：17
> 
> 时间：2012-12-29T14:21:29.753
> 
> 标签：r, derivative

我将使用两个变量计算时间序列的一阶导数（dpH/dtime），`time`并且`pH`.

在 R 中是否有任何类型的函数可以做到这一点，或者我应该计算一个额外的函数来做到这一点？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-12-29T15:01:51.247

假设`pH`和`time`是普通向量试试这个：

```
library(pspline)
predict(sm.spline(time, pH), time, 1) 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-12-29T14:37:19.283

您可能想从`stats::deriv` 或`diff.ts`按照 Matt L 的建议开始。请记住我的一位教授曾经对所有学生说的话：数值微分被称为“误差乘数”。

编辑：澄清一下——他警告的是，数据中的任何噪音都会使导数估计偏离。有人说积分是低通滤波器，微分是高通滤波器。因此，重要的是在计算导数之前对数据进行一些平滑处理。因此，Gabor 建议使用`predict.spline`. 但请记住，修改样条参数会使您的数据平滑到不同的水平，因此请始终查看结果以确保您删除了明显的噪声但不是所需的特征。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T16:49:57.047

这是“数值微分”的链接。

[http://en.wikipedia.org/wiki/Numerical_differentiation](http://en.wikipedia.org/wiki/Numerical_differentiation)

这是描述基于泰勒级数展开的方法的链接：

[http://ocw.usu.edu/civil_and_environmental_engineering/numerical_methods_in_civil_engineering/ODEsMatlab.pdf](http://ocw.usu.edu/civil_and_environmental_engineering/numerical_methods_in_civil_engineering/ODEsMatlab.pdf)

# android - Corona 构建的 apk 不会安装在三星 Galaxy S2 上

> ID：14082528
> 
> 赞同：1
> 
> 时间：2012-12-29T14:21:38.097
> 
> 标签：android, android-emulator, lua, coronasdk

我已经尝试了许多为回答这个问题而提供的解决方案，但没有任何效果。我试图在 eclipse android 模拟器上安装一个 corona apk 文件，但我收到了这个错误：

```
C:\Program Files (x86)\Android\android-sdk\platform-tools>adb install Stuck_scen
es_new.apk
119 KB/s (4927673 bytes in 40.242s)
        pkg: /data/local/tmp/Stuck_scenes_new.apk
Failure [INSTALL_PARSE_FAILED_NO_CERTIFICATES]

C:\Program Files (x86)\Android\android-sdk\platform-tools> 
```

我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T15:49:09.743

生成的 apk 没有被证书签名。遵循[本页中提到的任何方法](http://developer.android.com/tools/publishing/app-signing.html)

具体来说，您可以使用此命令对您的应用程序进行签名

```
$ jarsigner -verbose -sigalg MD5withRSA -digestalg SHA1 -keystore my-release-key.keystore
my_application.apk alias_name 
```

# .net - DDD 与存储库中的身份冲突

> ID：14082532
> 
> 赞同：2
> 
> 时间：2012-12-29T14:21:57.243
> 
> 标签：.net, domain-driven-design, ddd-repositories

我在示例应用程序中遵循**数据库优先方法。**POCO 类是通过 t4 模板生成的，它将具有它从数据库中携带的 Identity 属性。对于我在域中用作实体的某些类，id 的**类型**可以是**int、string 和 Guid**。

我没有看到我可以在域中生成并将其传递给存储库的字符串或 Guid 的问题。在 int 的情况下，我也可以这样做，但我想利用**SQL Database 的 AUTOINCREMENT 选项**。

我的问题是：

1.  谁的责任是为实体生成身份。它是域还是存储库？

2.  如何在存储库和域之间完成身份同步？例如，我可以为域中的**客户创建一个 1000 的 id，并要求存储库保存它。**当存储库保存它时，新标识可能是 2000（AUTOINCREMENT 选项设置新标识）。现在这两个实体是不同的，如果域中的 Customer 实体（假设它被缓存以供将来操作）与**Department**等其他实体一起使用，则可能会导致域中的问题。id 为 1000 的域中的缓存实体 ( **Customer** ) 将作为新实体保存在 SQL 数据存储中。存储库不知道客户是缓存的还是新的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T15:15:37.837

> 谁的责任是为实体生成身份。它是域还是存储库？

实体的身份可以由域直接分配或通过客户端请求分配。这种类型的身份通常是用一个`Guid`或另一个普遍唯一的值生成的。身份也可以由存储库分配以反映数据库生成的身份，例如增量身份列。

> 如何在存储库和域之间完成身份同步？

当实体的身份来自数据库生成的身份列时，域不应分配自己的身份。具有完整身份的临时实体最初将具有身份值 0。当临时实体成为持久实体时，存储库将分配身份值。那时，正如您所指出的，由于身份值已更改，因此新持久实体实例的缓存实例可能存在一些问题。有几种方法可以解决这些问题，但我尽量避免首先引用缓存（或其他任何地方）中的瞬态实体。这可以通过确保一个实体在持久化之前不会在很多地方被引用来更容易地完成。如果你最终在不同的地方引用了一个瞬态实体实例，你可以确保它的 . NET 运行时标识在实例的生命周期内保持不变。为此，您必须通过比较实体`object.ReferenceEquals``GetHashCode`在身份值检查之前，您必须在对象生命周期内缓存通过生成的哈希码。

# html - 列表元素的背景图片不会在 Chrome 中显示

> ID：14082533
> 
> 赞同：0
> 
> 时间：2012-12-29T14:22:07.147
> 
> 标签：html, css, google-chrome

我有一个简单的列表，每个元素中都有一个背景图像。该图像在 Firefox 中显示，但在 Chrome（Windows 操作系统）中没有。这些是附加到列表中的样式：

```
ul li
{
  position: relative;
  border-bottom-width: 1px;
  border-bottom-style: dotted;
  border-bottom-color: #777777;
  width: 378px;
  float: left;
  padding-top: 6px;
  padding-right: 0px;
  padding-left: 30px;
  font-size: 12px;
  font-family: Arial,Helvetica,sans-serif;
  color: #575656;
  line-height: 19px;
  background-color: transparent;
  background-image: url("../images/tir.png");
  background-repeat: no-repeat;
  background-attachment: scroll;
  background-position: left top 6px;
  background-clip: border-box;
  background-origin: padding-box;
  background-size: auto auto;
  padding-bottom: 3px;
} 
```

有人可以发现这有什么问题吗？

小提琴：http: [//jsfiddle.net/kgeDr/](http://jsfiddle.net/kgeDr/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T14:39:35.103

该代码似乎工作.. [http://jsfiddle.net/LZKG6/](http://jsfiddle.net/LZKG6/) （我在 Ubuntu 中使用 Chrome）

可能这是错误的：

```
background-position: left top 6px; 
```

我认为额外的“6px”是无效的。

W3schools 仅指定 2 个值，而不是 3 个： [http ://www.w3schools.com/cssref/pr_background-position.asp](http://www.w3schools.com/cssref/pr_background-position.asp)

# java - 在 String[][] 中执行搜索

> ID：14082534
> 
> 赞同：0
> 
> 时间：2012-12-29T14:22:11.180
> 
> 标签：java, arrays, types, comparison

给出一个基本类型为 String 的二维数组 T 和一些字符串 str （可以将其视为 String 类型的数组）我想检查 T 是否包含某些部分 str 作为其条目。我试过这个：

```
int indeksck = str.indexOf("C");

while(k<T.length){
    if(T[k][2] == str.substring(indeksck+1)){
        if(T[k][1] == str.substring(6, indeksck)){
            int ile_o = Integer.parseInt(T[k][0]);
            T[k][0]= Integer.toString(ile_o+1);
            T[k][3] = T[k][3]+"X"+str.substring(1,6);
            k = T.length+1;
        } else {
            k++;
        }

    } else {
        k++;

        if(k==T.length){
            k = 0;
            while(k<T.length){
                if(T[k][0]==null){
                    T[k][0] = Integer.toString(1);
                    T[k][1] = str.substring(6,indeksck);
                    T[k][2] = str.substring(indeksck+1);
                    T[k][3] = str.substring(1,6);
                    k = T.length+1;
                } else {
                    k++;
                }
            }
        }
    }
} 
```

问题是我的代码的第一部分被忽略了（即使应该满足条件）。我将不胜感激并提出解决此问题的建议。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-29T14:28:36.290

您不能使用 == 进行字符串比较。尝试：

```
if(T[k][2].equals(str.substring(indeksck+1))) { 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-29T14:32:20.397

`==`Java中的运算符用于参考比较。要检查对象的等价性（字符串也是如此），您需要使用`equals()`方法。

# ruby-on-rails - 弹性搜索和轮胎。搜索具有嵌套属性的对象

> ID：14082535
> 
> 赞同：0
> 
> 时间：2012-12-29T14:22:12.043
> 
> 标签：ruby-on-rails, ruby-on-rails-3, elasticsearch, nested-attributes, tire

我花了几个小时试图解决这个问题。我希望有一个人可以帮助我。

首先，这里有一些代码来说明结构：

```
class Company < ActiveRecord::Base
  include Tire::Model::Search
  include Tire::Model::Callbacks

  attr_accessible :name, :website, :addresses_attributes

  has_many :addresses, dependent: :destroy
  accepts_nested_attributes_for :addresses, allow_destroy: true

  after_touch() { tire.update_index }

  include_root_in_json = false

  mapping do
    indexes :name, boost: 10
    indexes :addresses do
      indexes :street
    end
  end

  def self.search(params)
    s = tire.search(load: true) do

    query do
      boolean do
        must { string params[:query] } if params[:query]
        must { term "addresses.street", params[:location] } if params[:location]
      end
    end

    s.results
  end

  def to_indexed_json
    to_json( include: { addresses: { only: [:street] } } )
  end
end

class Address < ActiveRecord::Base
  # Attributes
  attr_accessible :street

  # Associations
  belongs_to :company, touch: true
end 
```

当我试图搜索具有特定街道名称的公司时（打电话`Company.search({location: 'example_street_name', query: 'example_name'})`我没有得到任何结果。

索引对我来说看起来不错。这是请求之一：

```
curl -X POST "http://localhost:9200/companies/company/1351" -d '{
  "created_at": "2012-12-29T13:41:17Z",
  "name": "test name",
  "updated_at": "2012-12-29T13:41:17Z",
  "website": "text.website.com",
  "addresses": [
    {
      "street": "test street name"
    }
  ]
}' 
```

我已经尝试了很多事情来获得结果。没有任何效果。看来我一定错过了一些基本的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T09:51:51.840

您正在使用`term`未分析的“addresses.street”字段的查询，因此您必须传入小写等值。

尝试使用`match`查询。

# php - 对于每个数组修改

> ID：14082536
> 
> 赞同：1
> 
> 时间：2012-12-29T14:22:16.563
> 
> 标签：php, arrays

我有以下代码：

> ```
> foreach ($animals as $animal) {
>     $animal = getOffSpring($animal);
> } 
> ```

由于我将 $animal 设置为一个新字符串，我是否也要修改数组？

我的运行表明我的数组保持不变，但我希望用新值对其进行修改。这是错误吗？

换句话说，我希望我的数组中的所有动物都被修改为它们的后代

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T14:26:06.477

我认为您正在尝试这样做。
当您获取`$animal`变量并将其传递给函数或在`foreach`循环内修改它时，您将使用独立变量，该变量不会以`$animals`任何方式链接到数组（如果您自己不链接它），因此所有更改都应用于它，不要导致`$animals`数组的修改。

```
foreach ( $animals as $i => $animal )
{
    $animals[ $i ] = getOffSpring( $animal );
} 
```

正如@AlecTMH 在他的评论中提到的，[`array_map`](http://ee1.php.net/manual/en/function.array-map.php)这也是一个解决方案。

```
array_map( 'getOffSpring', $animals ); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-29T14:26:56.710

您可以使用参考：

```
foreach ($animals as &$animal) {
    $animal = getOffSpring($animal);
}
unset($animal); 
```

`unset`after 循环清除引用。否则，您会在循环之后保留对最后一个数组元素的引用，`$animal`如果您忘记这一点，然后`$animal`稍后再用于其他事情，这将导致烦人的问题。

另一种选择是使用密钥来替换它：

```
foreach ($animals as $key => $animal) {
    $animals[$key] = getOffSpring($animal);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T14:27:48.013

您可以使用对数组中值的引用

```
foreach ($animals as &$animal) {
    $animal = getOffSpring($animal);
} 
```

# shell - 在 shell 脚本中一次运行一个命令

> ID：14082537
> 
> 赞同：0
> 
> 时间：2012-12-29T14:22:22.337
> 
> 标签：shell, zsh

我正在使用 Mac OS 和 zsh。我正在运行一个启动多个 Java 程序的 shell 脚本。一旦创建了输出（它们本质上是脚本），它们就会终止。但是，我当前的脚本似乎一次启动了所有 Java 程序，这非常耗费资源。

目前我的 shell 脚本如下所示：

```
java -Xmx2048M -jar gha.jar params1.yaml
java -Xmx2048M -jar gha.jar params2.yaml
java -Xmx2048M -jar gha.jar params3.yaml 
```

当我运行它时，我的内存不足。如何修改我的脚本，使其仅在第一个 Java 程序终止后才启动下一个 Java 程序，以便在两者之间刷新内存？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T14:32:53.750

你误会了。shell 将一次运行这些。唯一可能的解释是这些程序是否启动后台进程，在这种情况下，shell 无法知道如何等待它们完成。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T08:41:31.320

正如上面提到的@bmargulies 所说，您的命令应该一次运行一个命令。

尝试修改您的 shell 脚本，如下所示。仅当前一个命令成功完成（至少在理论上）时，才运行命令下方的构造。

```
java -Xmx2048M -jar gha.jar params1.yaml && java -Xmx2048M -jar gha.jar params2.yaml && java -Xmx2048M -jar gha.jar params3.yaml 
```

如果这不起作用，请在后台运行脚本并列出当前正在运行的进程。希望这能让您了解系统上正在运行的内容。

# objective-c - Core Data 持久存储保护

> ID：14082547
> 
> 赞同：2
> 
> 时间：2012-12-29T14:23:45.243
> 
> 标签：objective-c, ios, core-data, encryption, data-protection

我正在创建一个非常依赖 Core Data 的应用程序。它是一个内容驱动的应用程序，主要向用户提供问题/答案。

在第一次加载时，应用程序委托将大量数据从 SQLite 提取到应用程序的持久存储中。数据基本上是大量内容，不仅可以在应用内购买，而且还受版权保护。

通常，需要对 Core Data 进行加密/保护的开发人员需要它来存储敏感的用户数据。但是，就像在这个（我的）案例中一样，我需要保护持久存储免受**任何人或任何来源**（包括用户）的外部访问，纯粹是因为我不希望有人能够下载应用程序的全部知识产权来自持久存储。

我注意到在 iPhone 模拟器上找到持久存储并打开它（使用 SQLite 浏览器）一点也不麻烦。这有点令人担忧，因此，如果这对于设备上的发布安装也尽可能容易，那么我想知道：

我不一定要全力以赴加密，因为我已经找到了逐行（懒惰地）执行此操作的方法，那么**有没有一种快速的方法来混淆/加扰持久性存储？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-22T07:53:41.987

[本文](http://blog.artlogic.com/2012/07/30/securing-your-core-data-with-transformable-attributes/)展示了如何加密单个属性（当然您可以加密所有属性）。

# android - 编译 FFMPEG + x264 - 未定义的引用

> ID：14082551
> 
> 赞同：0
> 
> 时间：2012-12-29T14:24:16.567
> 
> 标签：android, compilation, include, ffmpeg, x264

几天来，我一直试图在网上找到解决方案，但没有成功。我正在使用 Ubuntu 并尝试编译支持 x264 的最新 FFMPEG 稳定版本（1.0.1）。我确保我卸载了任何现有的 x264，然后我下载了最新的 x264 源并使用以下配置对其进行了编译：

```
./configure --prefix=$PREFIX \
    --enable-shared \
    --enable-static \
    --disable-gpac \
    --extra-cflags=" -I$ARM_INC -fPIC -DANDROID -fpic -mthumb-interwork -ffunction-sections -funwind-tables -fno-short-enums -D__ARM_ARCH_5__ -D__ARM_ARCH_5T__ -D__ARM_ARCH_5E__ -D__ARM_ARCH_5TE__ -Wno-psabi -march=armv5te -msoft-float -mthumb -Os -fomit-frame-pointer -fno-strict-aliasing -finline-limit=64 -DANDROID -Wa,--noexecstack -MMD -MP " \
    --extra-ldflags=" -nostdlib -Bdynamic -Wl,--no-undefined -Wl,-z,noexecstack -Wl,-z,nocopyreloc -Wl,-soname,/usr/lib/libz.so -Wl,-rpath-link=$ARM_LIB,-dynamic-linker=/system/bin/linker -L$ARM_LIB -lc -lm -ldl -lgcc" \
    --cross-prefix=${ARM_PRE}- \
    --disable-asm \
    --host=arm-linux \

    make clean
    make install 
```

一切顺利，我检查了安装的版本：

```
x264 -V
    x264 0.129.x
    built on Dec 27 2012, gcc: 4.6.1
    configuration: --bit-depth=8 --chroma-format=all
    x264 license: GPL version 2 or later 
```

然后我尝试使用以下选项编译 FFMPEG：

```
./configure --target-os=linux \
    --enable-libx264 \
    --enable-gpl \
    --prefix=$PREFIX \
    --extra-cflags="-I/home/tishu/Workspaces/ffmpeg/ffmpeg/jni/ffmpeg-1.0.1/android/armv7-a/include -I/home/tishu/Workspaces/ffmpeg/ffmpeg/jni/x264 -O3 -fpic -DANDROID -DHAVE_SYS_UIO_H=1 -Dipv6mr_interface=ipv6mr_ifindex -fasm -Wno-psabi -fno-short-enums  -fno-strict-aliasing -finline-limit=300 $OPTIMIZE_CFLAGS " \
    --extra-ldflags="-Wl,-rpath-link=$PLATFORM/usr/lib -L/home/tishu/Workspaces/ffmpeg/ffmpeg/jni/ffmpeg-1.0.1/android/armv7-a/lib -L$PLATFORM/usr/lib -nostdlib -lc -lm -ldl -llog" \
    --enable-cross-compile \
    --extra-libs="-lgcc" \
    --arch=arm \
    --cc=$PREBUILT/bin/arm-linux-androideabi-gcc \
    --cross-prefix=$PREBUILT/bin/arm-linux-androideabi- \
    --nm=$PREBUILT/bin/arm-linux-androideabi-nm \
    --sysroot=$PLATFORM \ 
```

configure 和 make clean/make install 运行良好，但是当我尝试创建 .so 文件时，以下命令失败：

```
/home/tishu/Apps/android-ndk-r8d/toolchains/arm-linux-androideabi-4.4.3/prebuilt/linux-x86/bin/arm-linux-androideabi-ld 
    -rpath-link=./android/armv7-a/usr/lib -L/home/tishu/Apps/android-ndk-r8d/platforms/android-14/arch-arm/usr/lib -soname libffmpeg.so -shared -nostdlib  -z,noexecstack -Bsymbolic \
    --whole-archive --no-undefined -o ./android/armv7-a/libffmpeg.so libavcodec/libavcodec.a libavformat/libavformat.a libavutil/libavutil.a libswscale/libswscale.a -lc -lm -lz -ldl -llog  \
    --warn-once \
    --dynamic-linker=/system/bin/linker /home/tishu/Apps/android-ndk-r8d/toolchains/arm-linux-androideabi-4.4.3/prebuilt/linux-x86/lib/gcc/arm-linux-androideabi/4.4.3/libgcc.a 
```

这失败了，输出如下：

```
libavcodec/libavcodec.a(libx264.o): In function `X264_frame':
/home/tishu/Workspaces/ffmpeg/ffmpeg/jni/ffmpeg-1.0.1/libavcodec/libx264.c:159: undefined reference to `x264_picture_init'
/home/tishu/Workspaces/ffmpeg/ffmpeg/jni/ffmpeg-1.0.1/libavcodec/libx264.c:179: undefined reference to `x264_encoder_reconfig'
/home/tishu/Workspaces/ffmpeg/ffmpeg/jni/ffmpeg-1.0.1/libavcodec/libx264.c:190: undefined reference to `x264_encoder_encode'
/home/tishu/Workspaces/ffmpeg/ffmpeg/jni/ffmpeg-1.0.1/libavcodec/libx264.c:196: undefined reference to `x264_encoder_delayed_frames'
libavcodec/libavcodec.a(libx264.o): In function `encode_nals':
/home/tishu/Workspaces/ffmpeg/ffmpeg/jni/ffmpeg-1.0.1/libavcodec/libx264.c:101: undefined reference to `x264_bit_depth'
libavcodec/libavcodec.a(libx264.o): In function `X264_close':
/home/tishu/Workspaces/ffmpeg/ffmpeg/jni/ffmpeg-1.0.1/libavcodec/libx264.c:231: undefined reference to `x264_encoder_close'
libavcodec/libavcodec.a(libx264.o): In function `X264_init':
/home/tishu/Workspaces/ffmpeg/ffmpeg/jni/ffmpeg-1.0.1/libavcodec/libx264.c:284: undefined reference to `x264_param_default'
/home/tishu/Workspaces/ffmpeg/ffmpeg/jni/ffmpeg-1.0.1/libavcodec/libx264.c:292: undefined reference to `x264_param_default_preset'
/home/tishu/Workspaces/ffmpeg/ffmpeg/jni/ffmpeg-1.0.1/libavcodec/libx264.c:314: undefined reference to `x264_param_parse'
/home/tishu/Workspaces/ffmpeg/ffmpeg/jni/ffmpeg-1.0.1/libavcodec/libx264.c:459: undefined reference to `x264_param_apply_fastfirstpass'
/home/tishu/Workspaces/ffmpeg/ffmpeg/jni/ffmpeg-1.0.1/libavcodec/libx264.c:490: undefined reference to `x264_param_apply_profile'
/home/tishu/Workspaces/ffmpeg/ffmpeg/jni/ffmpeg-1.0.1/libavcodec/libx264.c:533: undefined reference to `x264_encoder_open_129'
/home/tishu/Workspaces/ffmpeg/ffmpeg/jni/ffmpeg-1.0.1/libavcodec/libx264.c:544: undefined reference to `x264_encoder_headers' 
```

它正在寻找的 x264 版本 (129) 是使用 --eanable-shared 成功安装和编译的版本。显然，当我不包含 libx64 时，所有编译都很好。

**问题：**如何为最后一个命令指定包含路径？我尝试将路径添加到 $PATH 并将其添加为没有运气的参数：-I/home/tishu/Workspaces/ffmpeg/ffmpeg/jni/x264

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2019-02-06T14:17:03.620

对于追随者（甚至不是android，而是类似的消息），

```
/.../mingw-w64-i686/lib/gcc/.../i686-w64-mingw32/bin/ld: 
libavcodec/libavcodec.a(libx264.o):libx264.c:(.text+0x3c): 
undefined reference to `x264_bit_depth'
: undefined reference to `x264_encoder_open_152' 
```

似乎这个常数在 2017 年初被“删除”了，见[https://trac.ffmpeg.org/ticket/6966](https://trac.ffmpeg.org/ticket/6966)和[https://trac.ffmpeg.org/ticket/6932](https://trac.ffmpeg.org/ticket/6932)

修复：更新 ffmpeg，或更新 libx264 ......或其他东西......

虽然这些天它应该也支持旧版本的 libx264 ......

# javascript - 如何过滤数组并更新同一数组中的结果？

> ID：14082555
> 
> 赞同：1
> 
> 时间：2012-12-29T14:24:29.173
> 
> 标签：javascript, arrays

过滤数组并将结果保存在同一个数组中的最佳方法是什么

例如 ：

```
var OBJ = function(x, y) {this.x = x; this.y = y};
obj1 = new OBJ(1, 2);
obj2 = new OBJ(2, 3);
obj3 = new OBJ(3, 2);
obj4 = new OBJ(3, 1);
obj5 = new OBJ(4, 5);

var array_1 = new Array(); array_1.push(obj1, obj2, obj3, obj4, obj5);

var array_2 = array_1.filter(function(el){
    return (el.x > 2);
}); 
```

输出 ：

array_1 = [obj1，obj2，obj3，obj4，obj5]；

数组_2 = [obj3，obj4，obj5]；

我希望 array_1 像 array_2 一样更新

最好的方法是什么？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T14:26:54.103

```
array_1 = array_1.filter(function(el){
    return (el.x > 2);
}); 
```

很简单。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T14:30:44.857

如果你真的想在原地做，你需要这样的东西：

```
function filterInPlace(a, ff) {
  var s, d;

  for (s = d = 0; s < a.length; ++s) {
    if (ff(a[s]))
      a[d++] = a[s];
  }
  a.length = d;
} 
```

你会这样称呼它：

```
filterInPlace(array_1, function(element) { ... }); 
```

# php - 如果它的值在数据库中，请选中一个复选框。PHP

> ID：14082557
> 
> 赞同：0
> 
> 时间：2012-12-29T14:24:44.930
> 
> 标签：php, checkbox

我有一个来自 MySql 表“练习”的复选框循环，格式如下所示：

```
<form id="form1" name="form1" method="POST" action="insertDrills.php">

  <table width="100%" border="1" cellspacing="0" cellpadding="0">
    <?php do { ?>
      <tr>
        <td>

<input type="checkbox" name="drillSelect[]" value="<?php echo $row_Recordset1['drillID']; ?>" id="drillSelect" />

        <?php echo $row_Recordset1['rubrik']; ?>

        </td>
      </tr>
      <?php } while ($row_Recordset1 = mysql_fetch_assoc($Recordset1)); ?>
    <tr>
      <td colspan="2">

      <input name="spelarID" type="hidden" id="spelarID" value="<?php echo $row_rsSpelare['id']; ?>" />
      <input name="date" type="hidden" id="date" value="<? print date("Y-m-d h:i:s"); ?>" />
  <input type="submit" name="submit" id="submit" value="Välj övningar" />
  <input type="button" value="Avbryt" onclick="window.close();"></button>

      </td>
    </tr>
  </table>
</form> 
```

隐藏字段“spelarID”的值与复选框数组中的值一起插入到查找表“exercise_spelare_ref”中：

```
<?php
$id = $_POST['spelarID']; 
$drills = $_POST['drillSelect'];
$date = $_POST['date']; 

$inserts = array(); 
foreach ($drills as $drills)
    $inserts[] = "('$id','$drills','','$date')"; 

$query = "REPLACE INTO exercise_spelare_ref VALUES ". implode(", ", $inserts);

//echo "query = $query"; // for debugging purposes, remove this once it is working 
mysql_query($query) or die(mysql_error()); 
?> 
```

如何使查找表中的值在表单中标记为“已检查”？

这里有一个解决方案[https://stackoverflow.com/a/4069477](https://stackoverflow.com/a/4069477)由 Martin Bean 编写，但我无法让它工作？

我一直被困在这里，希望有人能帮助我！

我尝试了 Martin Beans 脚本，例如：

```
$uid = $row_rsSpelare['id']; // your logged in user's ID

$exercise = array();

// get an array of exercise
$sql = "SELECT drillID FROM exercise";
$res = mysql_query($sql);
while ($row = mysql_fetch_object($res)) {
    $exercise[$row->id] = $row->drillID;
}

// get an array of exercise user has checked
$sql = "SELECT DISTINCT drillID FROM exercise_spelare_ref WHERE id = '$uid'";
$res = mysql_query($sql);
while ($row = mysql_fetch_object($res)) {
    $checked[] = $row->drillID;
}

// this would be templated in a real world situation
foreach ($exercise as $id => $drillID) {
    $checked = "";
    // check box if user has selected this exercise
    if (in_array($checked, $id)) {
        $checked = 'checked="checked" ';
    }
    echo '<input type="checkbox" name="drillSelect[]" value="'.$id.'" '.$checked.'/>';
} 
```

但收到警告：

警告：in_array() 期望参数 2 是数组，字符串在第 158 行的 /customers/b/d/e/teeview.se/httpd.www/analys_kund/selectDrills.php 中给出

第 158 行是：

```
 if (in_array($checked, $id)) { 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T14:28:14.230

好吧，您需要`SELECT`从表中获取项目，将它们存储到一个数组中，如果当前复选框的 ID 与数组中的某些内容匹配，`checked`则在 HTML 中将属性添加到它。

# javascript - Ember.js 入门

> ID：14082561
> 
> 赞同：5
> 
> 时间：2012-12-29T14:25:15.307
> 
> 标签：javascript, ember.js

我没有找到任何开始使用 Ember.js 的好文档。请帮助我，这是我从[http://emberjs.com/documentation/](http://emberjs.com/documentation/)尝试的一个简单示例，但屏幕上没有显示任何内容。

```
Error:  MyApp is not defined 
```

Javascript：app.js

```
 MyApp.president = Ember.Object.create({
  firstName: "Barack",
  lastName: "Obama",
  fullName: function() {
    return this.get('firstName') + ' ' + this.get('lastName');
  // Tell Ember that this computed property depends on firstName
  // and lastName
  }.property('firstName', 'lastName')
}); 
```

HTML

```
<p>
<script type="text/x-handlebars">
  The President of the United States is {{MyApp.president.fullName}}.
</script>
</p> 
```

我包含了入门工具包中的所有 JS 文件。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-29T14:47:45.443

你忘了定义 MyApp，它必须是 Ember.Application 的一个实例：

```
var MyApp = Ember.Application.create({}); 
```

这是我几周前发现的一个非常全面的教程，也许它对您的学习目的有用：http: [//www.appliness.com/flame-on-a-beginners-guide-to-ember-js/](http://www.appliness.com/flame-on-a-beginners-guide-to-ember-js/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-29T14:41:15.010

你必须定义`MyApp`

我在[这里](http://jsfiddle.net/wqhwn/139/)创建了一个工作示例。单击**运行**按钮以查看结果。

**HTML**

```
<p>
<script type="text/x-handlebars">
  The President of the United States is {{MyApp.president.fullName}}.
</script>
</p>​ 
```

**代码**

```
window.MyApp = Ember.Application.create();

MyApp.president = Ember.Object.create({
  firstName: "Barack",
  lastName: "Obama",
  fullName: function() {
    return this.get('firstName') + ' ' + this.get('lastName');
  }.property('firstName', 'lastName')
});
​ 
```

# java - Quartz 错过的作业没有执行

> ID：14082563
> 
> 赞同：2
> 
> 时间：2012-12-29T14:25:22.733
> 
> 标签：java, quartz-scheduler, spring-3

我正在使用带有 Spring 的 Quartz 调度程序。Quartz 的版本是 2.1.6，Spring 的版本是 3.1.3。

这是配置：

```
<bean class="org.springframework.scheduling.quartz.SchedulerFactoryBean">
    <property name="autoStartup" value="true" />
    <property name="applicationContextSchedulerContextKey" value="applicationContext" />
    <property name="waitForJobsToCompleteOnShutdown" value="true" />
    <property name="overwriteExistingJobs" value="true" />
    <property name="dataSource" ref="dataSource" />
    <property name="transactionManager" ref="transactionManager" />
    <property name="quartzProperties">
        <props>             
            <prop key="org.quartz.jobStore.driverDelegateClass">org.quartz.impl.jdbcjobstore.StdJDBCDelegate</prop>
        </props>
    </property>

    <property name="triggers">
        <list>
            <ref bean="ldapSynchJob" />
        </list>
    </property>
</bean>

<bean id="ldapSynchJob" class="org.springframework.scheduling.quartz.CronTriggerFactoryBean">
    <property name="jobDetail" ref="ldapSynch" />
    <property name="cronExpression" value="0 45 0 * * ?" />
    <property name="misfireInstructionName" value="MISFIRE_INSTRUCTION_FIRE_ONCE_NOW" />
</bean>

<bean id="ldapSynch" class="org.springframework.scheduling.quartz.JobDetailFactoryBean">
    <property name="jobClass" value="com.edfx.adb.ldap.scheduler.LDAPSynchronizer" />
</bean> 
```

我想要这样，如果服务器停止并重新启动，如果调度程序错过了一个作业，那么一旦服务器启动它就会执行错过的作业。所以我使用了持久存储，数据库。但它似乎不起作用。

当我第一次在数据库中看到启动服务器时，在 qrtz_triggers 表中，列 NEXT_FIRE_TIME 的值为 1356808500000，这意味着 IST 2012 年 12 月 30 日 00:45:00 。调度程序执行后，它更改为 1356894900000，即 12 月 31 日 00 日： 2012 年 IST 45:00。然后我停止了服务器并更改了系统时间并将系统时间设置为 12 月 31 日上午 12:47。然后我再次启动我的服务器。我期待调度程序会在服务器启动后立即执行，因为它错过了一项工作。但是 NEXT_FIRE_TIME 值没有触发作业，而是更改为 1356981300000，即 Tue Jan 01 00:45:00 IST 2013。

显然这是不希望的，我无法找到发生这种情况的原因。任何建议都会对我很有帮助。

`SessionFactory`我使用的是并且`org.springframework.orm.hibernate4.LocalSessionFactoryBean`已`hibernate.hbm2ddl.auto`设置为`update`.

## 更新

这是扩展的类`QuartzJobBean`

```
public class LDAPSynchronizer extends QuartzJobBean {

    @Override
    protected void executeInternal(JobExecutionContext context) throws JobExecutionException {
        List<Attributes> currentUsersAttributes = LDAPManager.getManager().getCurrentUsersAttributes();
        List<Attributes> pastUsersAttributes = LDAPManager.getManager().getPastUsersAttributes();       
        getLDAPSynchService(context).synchronizeUser(currentUsersAttributes, pastUsersAttributes);
    }   

    private ILDAPSynchService getLDAPSynchService(JobExecutionContext context)  {
        ApplicationContext applicationContext = null;

        try {
            applicationContext = (ApplicationContext) context.getScheduler().getContext().get("applicationContext");
        } catch (Exception e) {         
        }

        if(applicationContext == null) {
            applicationContext = ContextLoader.getCurrentWebApplicationContext();
        }

        return (ILDAPSynchService) applicationContext.getBean("ldapSynchService");
    }
} 
```

## 更新

每次服务器在控制台中启动时，我都会收到以下日志：

```
01:28:24,586 INFO  [org.quartz.core.QuartzScheduler] (MSC service thread 1-10) Scheduler meta-data: Quartz Scheduler (v2.1.6) 'org.springframework.scheduling.quartz.SchedulerFactoryBean#0' with instanceId 'NON_CLUSTERED'
  Scheduler class: 'org.quartz.core.QuartzScheduler' - running locally.
  NOT STARTED.
  Currently in standby mode.
  Number of jobs executed: 0
  Using thread pool 'org.quartz.simpl.SimpleThreadPool' - with 10 threads.
  Using job-store 'org.springframework.scheduling.quartz.LocalDataSourceJobStore' - which supports persistence. and is not clustered.

01:28:24,596 INFO  [org.quartz.impl.StdSchedulerFactory] (MSC service thread 1-10) Quartz scheduler 'org.springframework.scheduling.quartz.SchedulerFactoryBean#0' initialized from an externally provided properties instance.
01:28:24,596 INFO  [org.quartz.impl.StdSchedulerFactory] (MSC service thread 1-10) Quartz scheduler version: 2.1.6
01:28:24,596 INFO  [org.quartz.core.QuartzScheduler] (MSC service thread 1-10) JobFactory set to: org.springframework.scheduling.quartz.AdaptableJobFactory@1014d1b6
01:28:24,666 INFO  [stdout] (MSC service thread 1-10) Hibernate: SELECT * FROM QRTZ_TRIGGERS WHERE SCHED_NAME = 'org.springframework.scheduling.quartz.SchedulerFactoryBean#0' AND TRIGGER_NAME = ? AND TRIGGER_GROUP = ?

01:28:24,706 INFO  [stdout] (MSC service thread 1-10) Hibernate: SELECT * FROM QRTZ_CRON_TRIGGERS WHERE SCHED_NAME = 'org.springframework.scheduling.quartz.SchedulerFactoryBean#0' AND TRIGGER_NAME = ? AND TRIGGER_GROUP = ?

01:28:24,716 INFO  [stdout] (MSC service thread 1-10) Hibernate: SELECT * FROM QRTZ_LOCKS WHERE SCHED_NAME = 'org.springframework.scheduling.quartz.SchedulerFactoryBean#0' AND LOCK_NAME = ? FOR UPDATE

01:28:24,716 INFO  [stdout] (MSC service thread 1-10) Hibernate: SELECT JOB_NAME FROM QRTZ_JOB_DETAILS WHERE SCHED_NAME = 'org.springframework.scheduling.quartz.SchedulerFactoryBean#0' AND JOB_NAME = ? AND JOB_GROUP = ?

01:28:24,716 INFO  [stdout] (MSC service thread 1-10) Hibernate: UPDATE QRTZ_JOB_DETAILS SET DESCRIPTION = ?, JOB_CLASS_NAME = ?, IS_DURABLE = ?, IS_NONCONCURRENT = ?, IS_UPDATE_DATA = ?, REQUESTS_RECOVERY = ?, JOB_DATA = ?  WHERE SCHED_NAME = 'org.springframework.scheduling.quartz.SchedulerFactoryBean#0' AND JOB_NAME = ? AND JOB_GROUP = ?

01:28:24,726 INFO  [stdout] (MSC service thread 1-10) Hibernate: SELECT * FROM QRTZ_TRIGGERS WHERE SCHED_NAME = 'org.springframework.scheduling.quartz.SchedulerFactoryBean#0' AND TRIGGER_NAME = ? AND TRIGGER_GROUP = ?

01:28:24,726 INFO  [stdout] (MSC service thread 1-10) Hibernate: SELECT * FROM QRTZ_CRON_TRIGGERS WHERE SCHED_NAME = 'org.springframework.scheduling.quartz.SchedulerFactoryBean#0' AND TRIGGER_NAME = ? AND TRIGGER_GROUP = ?

01:28:24,726 INFO  [stdout] (MSC service thread 1-10) Hibernate: SELECT * FROM QRTZ_LOCKS WHERE SCHED_NAME = 'org.springframework.scheduling.quartz.SchedulerFactoryBean#0' AND LOCK_NAME = ? FOR UPDATE

01:28:24,736 INFO  [stdout] (MSC service thread 1-10) Hibernate: SELECT J.JOB_NAME, J.JOB_GROUP, J.IS_DURABLE, J.JOB_CLASS_NAME, J.REQUESTS_RECOVERY FROM QRTZ_TRIGGERS T, QRTZ_JOB_DETAILS J WHERE T.SCHED_NAME = 'org.springframework.scheduling.quartz.SchedulerFactoryBean#0' AND J.SCHED_NAME = 'org.springframework.scheduling.quartz.SchedulerFactoryBean#0' AND T.TRIGGER_NAME = ? AND T.TRIGGER_GROUP = ? AND T.JOB_NAME = J.JOB_NAME AND T.JOB_GROUP = J.JOB_GROUP

01:28:24,736 INFO  [stdout] (MSC service thread 1-10) Hibernate: DELETE FROM QRTZ_SIMPLE_TRIGGERS WHERE SCHED_NAME = 'org.springframework.scheduling.quartz.SchedulerFactoryBean#0' AND TRIGGER_NAME = ? AND TRIGGER_GROUP = ?

01:28:24,736 INFO  [stdout] (MSC service thread 1-10) Hibernate: DELETE FROM QRTZ_CRON_TRIGGERS WHERE SCHED_NAME = 'org.springframework.scheduling.quartz.SchedulerFactoryBean#0' AND TRIGGER_NAME = ? AND TRIGGER_GROUP = ?

01:28:24,736 INFO  [stdout] (MSC service thread 1-10) Hibernate: DELETE FROM QRTZ_TRIGGERS WHERE SCHED_NAME = 'org.springframework.scheduling.quartz.SchedulerFactoryBean#0' AND TRIGGER_NAME = ? AND TRIGGER_GROUP = ?

01:28:24,746 INFO  [stdout] (MSC service thread 1-10) Hibernate: SELECT TRIGGER_NAME FROM QRTZ_TRIGGERS WHERE SCHED_NAME = 'org.springframework.scheduling.quartz.SchedulerFactoryBean#0' AND TRIGGER_NAME = ? AND TRIGGER_GROUP = ?

01:28:24,746 INFO  [stdout] (MSC service thread 1-10) Hibernate: SELECT TRIGGER_GROUP FROM QRTZ_PAUSED_TRIGGER_GRPS WHERE SCHED_NAME = 'org.springframework.scheduling.quartz.SchedulerFactoryBean#0' AND TRIGGER_GROUP = ?

01:28:24,746 INFO  [stdout] (MSC service thread 1-10) Hibernate: SELECT TRIGGER_GROUP FROM QRTZ_PAUSED_TRIGGER_GRPS WHERE SCHED_NAME = 'org.springframework.scheduling.quartz.SchedulerFactoryBean#0' AND TRIGGER_GROUP = ?

01:28:24,746 INFO  [stdout] (MSC service thread 1-10) Hibernate: INSERT INTO QRTZ_TRIGGERS (SCHED_NAME, TRIGGER_NAME, TRIGGER_GROUP, JOB_NAME, JOB_GROUP, DESCRIPTION, NEXT_FIRE_TIME, PREV_FIRE_TIME, TRIGGER_STATE, TRIGGER_TYPE, START_TIME, END_TIME, CALENDAR_NAME, MISFIRE_INSTR, JOB_DATA, PRIORITY)  VALUES('org.springframework.scheduling.quartz.SchedulerFactoryBean#0', ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)

01:28:24,756 INFO  [stdout] (MSC service thread 1-10) Hibernate: INSERT INTO QRTZ_CRON_TRIGGERS (SCHED_NAME, TRIGGER_NAME, TRIGGER_GROUP, CRON_EXPRESSION, TIME_ZONE_ID)  VALUES('org.springframework.scheduling.quartz.SchedulerFactoryBean#0', ?, ?, ?, ?) 
```

之后我看到`PREV_FIRE_TIME`QUARTZ_TRIGGERS 表设置为 -1。并且行数永远不会超过1。我不知道这是否正常。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T07:16:37.343

经过两天的学习和搜索，我终于能够解决这个问题。这是正确的代码：

```
<bean class="org.springframework.scheduling.quartz.SchedulerFactoryBean">
    <property name="autoStartup" value="true" />
    <property name="applicationContextSchedulerContextKey" value="applicationContext" />
    <property name="waitForJobsToCompleteOnShutdown" value="true" />
    <property name="dataSource" ref="dataSource" />
    <property name="transactionManager" ref="transactionManager" />
    <property name="quartzProperties">
        <props>
            <prop key="org.quartz.jobStore.driverDelegateClass">org.quartz.impl.jdbcjobstore.StdJDBCDelegate</prop>
        </props>
    </property>

    <property name="triggers">
        <list>
            <ref bean="ldapSynchJob" />
        </list>
    </property>
</bean>

<bean id="ldapSynchJob" class="org.springframework.scheduling.quartz.CronTriggerFactoryBean">
    <property name="jobDetail" ref="ldapSynch" />
    <property name="misfireInstructionName" value="MISFIRE_INSTRUCTION_FIRE_ONCE_NOW" />
    <property name="cronExpression" value="0 17 12 * * ?" />
</bean>

<bean id="ldapSynch" class="org.springframework.scheduling.quartz.JobDetailFactoryBean">
    <property name="jobClass" value="com.edfx.adb.ldap.scheduler.LDAPSynchronizer" />       
</bean> 
```

`<property name="overwriteExistingJobs" value="true" />`导致了这个问题。它正在覆盖表的`NEXT_FIRE_TIME`值`QRTZ_TRIGGERS`。

# php - 从两个表中获取最高总和值

> ID：14082565
> 
> 赞同：1
> 
> 时间：2012-12-29T14:25:30.607
> 
> 标签：php, mysql, html-table

这是我的代码：

```
$query1 = "select user, sum(column) as total1 from table1 GROUP BY user";
$result = mysql_query(query1);
$row_query1 = mysql_fech_assoc($result);

do{
    $user = $row_query1['user'];
    $query2 = "select names, sum(column1) as total2 from table2 WHERE names ='$user' GROUP BY names";
    $result2 = mysql_query($query2);
    $row_query2 = mysql_fetch_assoc($result2);
    $sum = $row_query1['total1'] + $row_query2['total1'];
    <tr> <?php echo $sum; ?></tr>
}while($row_query1 = mysql_fech_assoc($result)); 
```

我需要从此循环中获得 $sum 的最高值。任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T14:34:00.837

你可以这样做......取一个临时变量（$temp），它可以检查总和变量（$sum）。

```
 $query1 = "select user, sum(column) as total1 from table1 GROUP BY user";
     $result = mysql_query(query1);
     $row_query1 = mysql_fech_assoc($result);
     $temp = 0;

    do{

    $user = $row_query1['user'];

    $query2 = "select names, sum(column1) as total2 from table2 WHERE names ='$user' GROUP BY names";
    $result2 = mysql_query($query2);
    $row_query2 = mysql_fetch_assoc($result2);

    $sum = $row_query1['total1'] + $row_query2['total1'];

    if($temp < $sum)
    $temp = sum;

    echo "<tr>$sum</tr>";

   }while($row_query1 = mysql_fech_assoc($result));
   echo "maximum sum :".$temp; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T14:38:54.953

我建议做一个 JOIN 而不是自己执行子查询：

```
select user, sum(column) + sum(column1) as total
from table1 
INNER JOIN table2 ON names = user
GROUP BY user 
```

其余的在代码中应该是直截了当的。

# jsf - JSF 其中 src 是动态的和 primefaces

> ID：14082566
> 
> 赞同：2
> 
> 时间：2012-12-29T14:25:39.140
> 
> 标签：jsf, primefaces, uiinclude

我正在努力解决一个问题，我试图使用 JSF 2.1 和 Primefaces 为一种 CMS 项目动态生成页面。我的问题是我正在尝试使用自定义 ResourceResolver 动态包含一个存在于数据库中的页面（该部分效果很好）。问题是我正在使用请求参数来确定要服务的页面（即：http: [//xxx.xxx.com/context/public/](http://xxx.xxx.com/context/public/?p=2) ?p=2 ）。在我想使用任何 Ajax 或更具体的 Primefaces（在我的情况下是我需要使用 actionListeners 的调度组件）之前，这工作正常。我发现在发出 ajax 请求时我的视图没有得到解决，可能是因为它是请求范围的。下面是一段代码：

```
<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
  xmlns:h="http://java.sun.com/jsf/html"
  xmlns:p="http://primefaces.org/ui" 
  xmlns:ui="http://java.sun.com/jsf/facelets">
<ui:composition template="/WEB-INF/view/public/templates/public-template.xhtml">
    <ui:define name="body"> 
        <p:outputPanel autoUpdate="false" rendered="#{empty publicBean.site}">
            <div>No site found!</div>
        </p:outputPanel>

        <p:outputPanel autoUpdate="false" rendered="#{! empty publicBean.page and empty publicBean.page.pageTemplate}">
            <div>No valid page template found!</div>
        </p:outputPanel>

        <ui:include src="#{publicBean.view}" />
    </ui:define>
</ui:composition>
</html> 
```

视图的数量是未知的并且是动态创建的，所以我不能只做一个丑陋的 ui:includes 块然后有条件地渲染。

所以我看到的是，当我这样做时，我的基于 ajax 的表单（例如使用 p:commandButton）不起作用。我从来没有看到在我的 bean 上执行的操作。但是，如果我对从“#{publicBean.view}”返回的视图进行硬编码，使其始终返回相同的视图，那么一切正常。所以我假设在 ajax 调用期间 publicBean.view 可能返回 null 或者在我的情况下是 AgoraConstants.CUSTOM_VIEW_NOT_FOUND。这是我的支持 bean 中的代码：

```
public String getView()
{
     // If this below is uncommented, the form with ajax/primefaces works
    //if ( 1 == 1 )
    //{
    //    return "/X-AGORA-VIEW/districtOfficeCalendarTemplate.xhtml";
    //}
    if ( page != null && page.getPageTemplate() != null )
    {
        return AgoraConstants.CUSTOM_VIEW_PREFIX + page.getPageTemplate().getName() + ".xhtml";
    }
    else if ( site != null && site.getLandingPage() != null && site.getLandingPage().getPageTemplate() != null )
    {
        return AgoraConstants.CUSTOM_VIEW_PREFIX + site.getLandingPage().getPageTemplate().getName()+".xhtml";
    }
    return AgoraConstants.CUSTOM_VIEW_NOT_FOUND;
} 
```

所以这是我的问题，我怎样才能绕过请求参数，以便我可以使用 ajax 和 primefaces 以我想要的方式工作？我可以把它扔到会话中，但是如果用户在两个具有不同视图的选项卡中打开站点，事情可能会变得混乱并且无法正常运行。基本上，我应该如何保留请求变量，以便我可以确保 getView() 为 ajax 请求返回相同的视图？似乎应该有一个简单的解决方案来解决这个问题，但我没有看到任何帮助，将不胜感激。

** 编辑 **

我还尝试将我的支持 bean 更改为查看范围（来自请求），但这似乎没有帮助（但我不知道为什么）。下面是更多的支持 bean 代码。我添加了 init 方法，该方法在使用 @PostConstruct 创建 bean 时调用。

```
public void init()
{       
    site = null;
    page = null;

    logger.info("Loading public view...");

    if (  getFacesContext().getExternalContext().getRequestParameterMap().containsKey(AgoraConstants.PUBLIC_PAGE_REQUEST_VAR) )
    {
        logger.info("Restoring Page...");
        long value = parseLong((String)getFacesContext().getExternalContext().getRequestParameterMap().get(AgoraConstants.PUBLIC_PAGE_REQUEST_VAR));
        if ( value >= 0 )
        {
            logger.info("Attempting to restore: {}", value);    
            try
            {
                page = pageService.getItem(value);
                if ( page != null )
                {
                    if ( ! page.isEnabled() )
                    {
                        page = null;
                    }
                }
            }
            catch(Exception e)
            {
                logger.warn("Failed to load site: {}", e.getLocalizedMessage());
            }
        }
    }

    if (  page == null && getFacesContext().getExternalContext().getRequestParameterMap().containsKey(AgoraConstants.PUBLIC_SITE_REQUEST_VAR) )
    {
        logger.info("Restoring Site...");
        long value = parseLong((String)getFacesContext().getExternalContext().getRequestParameterMap().get(AgoraConstants.PUBLIC_SITE_REQUEST_VAR));
        if ( value >= 0 )
        {
            logger.info("Attempting to restore: {}", value);    
            try
            {
                site = siteService.getItem(value);
            }
            catch(Exception e)
            {
                logger.warn("Failed to load site: {}", e.getLocalizedMessage());
            }
        }
    }

    if ( page != null && page.getSite() != null)
    {
        site = page.getSite();
    }

    if ( site == null )
    {
        site = siteService.getDefaultSite();
    }
}

public String getView()
{
//        if ( 1 == 1 )
//        {
//            return "/X-AGORA-VIEW/districtOfficeCalendarTemplate.xhtml";
//        }
    if ( page != null && page.getPageTemplate() != null )
    {
        logger.info("a" + AgoraConstants.CUSTOM_VIEW_PREFIX + page.getPageTemplate().getName() + ".xhtml");
        return AgoraConstants.CUSTOM_VIEW_PREFIX + page.getPageTemplate().getName() + ".xhtml";
    }
    else if ( site != null && site.getLandingPage() != null && site.getLandingPage().getPageTemplate() != null )
    {
        logger.info("b" + AgoraConstants.CUSTOM_VIEW_PREFIX + site.getLandingPage().getPageTemplate().getName()+".xhtml");
        return AgoraConstants.CUSTOM_VIEW_PREFIX + site.getLandingPage().getPageTemplate().getName()+".xhtml";
    }
    logger.info("c");
    return AgoraConstants.CUSTOM_VIEW_NOT_FOUND;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T17:46:50.743

在这种情况下你应该使用 view scoped bean，但是在使用 view scope 和动态 ui:include 时会出现问题。您可以对其进行测试，例如在构造函数中放置断点，您将看到在每个请求中都创建了 bean。如果您使用例如 c:if 或 c:for，也存在问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T14:25:41.550

好吧，我的整个问题是因为回发不包括 ajax 请求的请求参数，所以我正在使用漂亮的面孔来解决这个问题。有了漂亮的面孔，我设置了映射以在回发时包含请求参数，这解决了我的问题。这可能不适用于所有情况，但对我来说似乎效果很好。

# asp.net-mvc - 如何触发 Http Post Action 到 Form

> ID：14082567
> 
> 赞同：0
> 
> 时间：2012-12-29T14:25:43.823
> 
> 标签：asp.net-mvc

我是 Asp.net MVC 的新手，并且在使用以下代码时遇到问题。

```
 @model SportsStore.Domain.Entities.ShippingDetails

@{
    ViewBag.Title = "SportsStore: Checkout";
}

<h2>Check out now</h2>
Please enter your details and we'll send your goods right away!
@using (Html.BeginForm("Checkout", "Cart"))
{
    @Html.ValidationSummary()

    <h3>Ship to</h3>
    <div>Name: @Html.EditorFor(x => x.Name)</div>

    <h3>Address</h3>
    <div>Line 1: @Html.EditorFor(x => x.Line1)</div>
    <div>Line 2: @Html.EditorFor(x => x.Line2)</div>
    <div>Line 3: @Html.EditorFor(x => x.Line3)</div>
    <div>City: @Html.EditorFor(x => x.City)</div>
    <div>State: @Html.EditorFor(x => x.State)</div>
    <div>Zip: @Html.EditorFor(x => x.Zip)</div>
    <div>Country: @Html.EditorFor(x => x.Country)</div>

    <h3>Options</h3>
    <label>
    @Html.EditorFor(x => x.GiftWrap)
    Gift wrap these items
    </label>

        <p align="center">
            <input class="actionButtons" type="submit" value="Complete order"/>           
        </p>

} 
```

我希望 submit 类型的输入从我的控制器调用 Post version Checkout 操作，如下所示

```
 using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.Mvc;
using SportsStore.Domain.Abstract;
using SportsStore.Domain.Entities;
using SportsStore.WebUI.Models;

namespace SportsStore.WebUI.Controllers
{
    public class CartController : Controller
    {
        private IProductsRepository repository;
        private IOrderProcessor orderProcessor;

        public CartController(IProductsRepository repo, IOrderProcessor proc)
        {
            repository = repo;
            orderProcessor = proc;
        }

        [HttpPost]
        public ViewResult Checkout(ShippingDetails shippingDetails, Cart cart)
        {
            var test = Request.Form["Line1"];
            if (cart.Lines.Count() == 0)
            {
                ModelState.AddModelError("", "Sorry, your cart is empty!");
            }
            if (ModelState.IsValid)
            {
                orderProcessor.ProcessOrder(cart, shippingDetails);
                cart.Clear();
                return View("Completed");
            }
            else
            {
                return View(shippingDetails);
            }
        }

        public RedirectToRouteResult AddToCart(Cart cart, int productId, string returnUrl)
        {
            Product product = repository.Products.FirstOrDefault(p => p.ProductID == productId);

            if (product != null)
            {
                cart.AddItem(product, 1);
            }

            return RedirectToAction("Index", new { returnUrl });
        }

        public RedirectToRouteResult RemoveFromCart(Cart cart, int productId, string returnUrl)
        {
            Product product = repository.Products.FirstOrDefault(p => p.ProductID == productId);

            if (product != null)
            {
                cart.RemoveLine(product);
            }

            return RedirectToAction("Index", new { returnUrl });
        }

        public ViewResult Index(Cart cart, string returnUrl)
        {
            return View(new CartIndexViewModel { Cart = cart, ReturnUrl = returnUrl });
        }

        public ViewResult Summary(Cart cart)
        {
            return View(cart);
        }

        [HttpGet]
        public ViewResult Checkout()
        {
            return View(new ShippingDetails());
        }

        private Cart GetCart()
        {
            Cart cart = (Cart)Session["Cart"];
            if (cart == null)
            {
                cart = new Cart();
                Session["Cart"] = cart;
            }
            return cart;
        }

    }
} 
```

但是，每当我按下这个输入按钮时，什么都没有发生。

有人可以告诉我有什么问题吗？我认为提交类型的输入按钮会调用该操作的发布版本，但显然这不起作用。

编辑：

我尝试禁用浏览器中的所有 javascript，但这并不能解决问题。

这是我的路由信息​​：

```
public static void RegisterRoutes(RouteCollection routes)

 {
        routes.IgnoreRoute("{resource}.axd/{*pathInfo}");

        routes.MapRoute(null,"", // Only matches the empty URL (i.e. /)
            new
            {
            controller = "Product",
            action = "List",
            category = (string)null,
            page = 1
            }
            );

        routes.MapRoute(null, "Page{page}", new { Controller = "Product", action = "List" });

        routes.MapRoute(null,"{category}", // Matches /Football or /AnythingWithNoSlash
            new { controller = "Product", action = "List", page = 1 });

        routes.MapRoute(null,
        "{category}/Page{page}", // Matches /Football/Page567
        new { controller = "Product", action = "List" }, // Defaults
        new { page = @"\d+" } // Constraints: page must be numerical
        );

        routes.MapRoute(null, "{controller}/{action}");
    } 
```

这是我在 Global.asax 中的 ApplicationStart 方法

```
protected void Application_Start()
    {
        AreaRegistration.RegisterAllAreas();

        RegisterGlobalFilters(GlobalFilters.Filters);
        RegisterRoutes(RouteTable.Routes);

        ControllerBuilder.Current.SetControllerFactory(new NinjectControllerFactory());
        ModelBinders.Binders.Add(typeof(Cart), new CartModelBinder());
    } 
```

我真的不知道还能做什么。如果有人有任何想法，请告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T14:29:07.223

> 我希望提交类型的输入从我的控制器调用 Post version Checkout 操作

你为什么期待这样的事情？您似乎没有在您的表格上注明：

```
@using (Html.BeginForm("Checkout", "Cart"))
{
    ...
} 
```

如果在渲染表单时没有明确指定要调用的操作和控制器名称，那么与渲染此视图的操作相同的操作将使用 HttpPost 调用。因此，例如，如果此视图是从`Index`操作呈现的，那么如果您使用`Html.BeginForm`，ASP.NET MVC 将在同一控制器上查找带有 HttpPost 的 Index 操作。

例如：

```
public ActionResult Index()
{
    ... render the form
}

[HttpPost]
public ActionResult Index(ShippingDetails shippingDetails, Cart cart)
{
    ... process the form submission
} 
```

这就是约定。如果您不想遵循约定，则需要使用 Html.BeginForm 的重载，它允许您指定要调用的操作和控制器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T20:09:45.753

您必须明确指定要发布表单。默认情况下，它执行 GET。

```
@using(Html.BeginForm("Checkout", "Cart", FormMethod.Post))
{
    ...
} 
```

# google-chrome - 如何让谷歌检测网站搜索引擎？

> ID：14082568
> 
> 赞同：24
> 
> 时间：2012-12-29T14:25:52.357
> 
> 标签：google-chrome

谷歌浏览器有一个功能，你可以点击标签来搜索网站。然后，Chrome 导航到该站点自己的搜索引擎并运行输入的查询。Chrome 文档表明，仅当 Google 在您尝试搜索的网站上检测到搜索引擎时，此功能才可用。

情况确实如此，因为写作`stackoverflow.com<Tab>test<Enter>`使 Chrome 浏览[到这里](https://stackoverflow.com/search?q=test)，而`facebook.com<Tab>test<Enter>`因为 tab 键标签超出了地址行，所以什么也不做。

我想知道的是如何向谷歌表明我的网站有一个搜索引擎，以及谷歌需要如何格式化查询，以便在使用标签搜索功能时将 Chrome 用户正确重定向到我的网站。是元标签吗？它在 robots.txt 中吗？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-12-29T14:25:52.357

经过一番挖掘，我找到了描述这[一点](http://blog.coredumped.org/2012/04/opensearch-how-to-get-google-chrome-to.html)的页面。您还可以阅读 Stackoverflow 的源代码并找到这行代码：

```
<link rel="search" type="application/opensearchdescription+xml" title="Stack Overflow" href="/opensearch.xml"> 
```

它的作用是向谷歌表明如何在`/opensearch.xml`包含以下内容的文件中使用您的搜索引擎的描述：

```
<?xml version="1.0" encoding="UTF-8" ?>
<OpenSearchDescription xmlns="http://a9.com/-/spec/opensearch/1.1/" xmlns:moz="http://www.mozilla.org/2006/browser/search/">
  <ShortName>Stack Overflow</ShortName>
  <Description>Search Stack Overflow: Q&amp;A for professional and enthusiast programmers</Description>
  <InputEncoding>UTF-8</InputEncoding>
  <Image width="16" height="16" type="image/x-icon">http://sstatic.net/stackoverflow/img/favicon.ico</Image>
  <Url type="text/html" method="get" template="http://stackoverflow.com/search?q={searchTerms}"></Url>
</OpenSearchDescription> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2019-01-13T21:16:57.753

当我为我的在线克林贡词典实现搜索功能时，我发现 Chrome 不需要 OpenSearch 描述即可将其自动检测为搜索引擎。

*注意：虽然这是一种更简单的方法，但它不允许使用高级功能，例如指定搜索模板、自定义网站图标（Chrome 自动使用网站的网站图标）等。它也可能不适用于 Chrome 以外的其他浏览器。*

我从[Search Engine Autodiscovery: Google Chrome Autodiscovery](https://martin-thoma.com/search-engine-autodiscovery/#google-chrome-autodiscovery)的说明开始，其中说：

> 有趣的是，自动发现仅在搜索引擎位于主页时才有效。您必须有一个类型的输入字段`search`或`text`具有名称的类型`s`：
> 
> ```
> <form>
>   <input type="search" name="s" />
> </form> 
> ```
> 
> 或者
> 
> ```
> <form>
>   <input type="text" name="s" />
> </form> 
> ```

我让 Chrome 在我的网站[klingonska.org](http://klingonska.org/)上自动检测搜索引擎，而不使用 OpenSearch 描述。

但是我偏离了上面的描述，因为我发现我不需要调用`s`或使用字段`type="search"`。我的最终`<form>`外观是这样的（简化形式）。

```
<form method=get action="dict/">
  <input name=q placeholder="Search dictionary…">
  <button type=submit>Search</button>
</form> 
```

关键因素似乎是表单位于根页面`http://<domain>/`页面（*而不是*子页面之类`http://<domain>/<dir>/<something>.html`）。而且，IIRC，搜索表单只包含一个字段。

# sql - 我应该避免连接中的循环吗？

> ID：14082580
> 
> 赞同：4
> 
> 时间：2012-12-29T14:27:11.230
> 
> 标签：sql, database, join, business-objects

我记得我被教导在 sql 中加入表时**永远不要创建循环。**实际上，使用业务对象它甚至可以告诉我在 Universe 中定义的模式中是否存在循环。
我试图在网上搜索有关此声明的信息，但找不到参考。
为什么这样做很危险？

***编辑：也许我太简洁了。***

我的问题不是关于作为“FOR LOOP”或类似的循环。我在 SELECT 语句中谈论了类似 WHERE 子句的内容：

```
WHERE TABLE1.foo = TABLE2.foo
  AND TABLE2.bar = TABLE3.bar
  AND TABLE3.baz = TABLE1.baz 
```

如果绘制关系，您将在连接中看到“循环”。从正确性和/或性能的角度来看，这是否危险？
谢谢大家。

***编辑2：添加了一个例子。***

我只是想了一个例子，也许它不是最好的，但我认为它有助于理解。

```
------------          -----------------      ----------------------
- DELIVERY -          - DELIVERY_DATE -      -  DELIVERY_DETAILS  -
------------          -----------------      ----------------------
- id       - <---     - id            - <----- date_id            -
- company  -     |----- delivery_id   -      - product            -
- year     -          - date          -      - quantity           -
- number   -          -----------------      - datetime_of_event  - 
- customer -                                 ----------------------
- ----------          

             1 <-----> N               1 <----> N 
```

*   在 DELIVERY 表中，每个交货只出现一次
*   在 DELIVERY_TABLE 中，我们有处理交货的每个日期的列表。因此，交货可能会在几天内准备好。
*   在最后一张表中，我们有每次交付的详细信息。因此，在此表中，我们跟踪与交付准备相关的每个事件

因此，每对表的基数是 1:N。

连接非常简单：

```
DELIVERY.id = DELIVERY_DATE.delivery_id AND 
DELIVERY_DATE.id = DELIVERY_DETAILS.date_id 
```

现在，假设我想加入另一个表，其中我有一些关于某个日期的交货的其他信息。让我们定义它：

```
------------  
- EMPLOYEE -
------------
- company  -
- year     -
- number   -
- date     -
- employee -
------------ 
```

现在加入应该是：

```
DELIVERY.id = DELIVERY_DATE.delivery_id AND 
EMPLOYEE.company = DELIVERY.company AND
EMPLOYEE.year = DELIVERY.year AND
EMPLOYEE.number = DELIVERY.number AND
EMPLOYEE.date = DELIVERY_DATE.date 
```

总而言之，我将结束让 EMPLOYEE 同时加入 DELIVERY 和 DELIVERY_DATE，并在加入中加入循环。
我应该以这种方式重写它吗？

```
EMPLOYEE.company = DELIVERY.company AND
EMPLOYEE.year = DELIVERY.year AND
EMPLOYEE.number = DELIVERY.number AND
EMPLOYEE.date IN (SELECT date FROM DELIVERY_DATE d WHERE d.delivery_id = DELIVERY.id) 
```

***编辑3：终于找到了一个链接***

像往常一样，当您放弃搜索链接时，您会找到它。
所以，**[这篇文章](http://www.bidw.org/business-objects/universe-design/understanding-loops-and-its-resolution-technique-in-universe/)**解释了一切。它与业务对象相关，但内容是通用的。
感谢大家的时间。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T02:30:47.723

编辑：我从更新中看到这是一个特定于 BO 设计器的问题，其中一个表被多次使用，但 BO 自动组合连接子句，然后错误地（或者，更确切地说，无意地）限制结果集。这个问题实际上与循环无关，就其本身而言，它实际上是关于在同一查询中的多个上下文中使用实体。我将在下面留下我原来的答案，即使它并没有真正解决 OP 的问题。

免责声明：这是一个非答案的答案，因为它既是答案又是问题。可能应该是评论，但除非您提出/回答问题，否则您无法发表评论，但既然我真的想提供帮助，我会尽我所能，即使这不是这里的做法。所以起诉我。

简短的回答是否定的，您不应该避免连接中的循环（或“循环”）。

更重要的是，构造查询是为了声明正确的逻辑条件以生成您正在寻找的数据。相同的逻辑条件通常可以通过多种不同的方式建立，因此有时询问一种方式是否优于另一种方式是有意义的。当性能很重要时，这变得特别有趣。但首先，查询必须返回正确的结果集。这如何完成取决于底层架构。这才是你真正应该关注的。

在您的示例中，为什么 EMPLOYEE 在 DELIVERY 表中扮演角色？你为什么要加入这些专栏？这意味着员工与交付具有相同的“日期”？我知道这是一个人为的例子，但我想说的是，连接是否在图中创建一个循环完全（嗯，主要是）取决于特定结果集的逻辑*含义*是什么。

在 JOIN 语法问题上，使用 JOIN...ON 子句比 WHERE 子句更可取，因为它将实体与数据过滤操作结合起来需要做的事情分开。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T15:03:24.523

嗯，你的问题很简单。您不应该使用`where`子句来执行连接。你应该使用`on`从句。您的联接可以表示为：

```
from Table1 join
     Table2
     on Table1.foo = Table2.foo join
     Table3
     on Table2.bar = Table3.bar and
        Table1.baz = Table3.baz 
```

这是否合适取决于您的数据结构。有时是的。你不应该担心它。

顺便说一句，我不会将此称为“循环”，它与编程中的“for 循环”和 SQL 中的嵌套循环连接密切相关。您可以将此称为连接条件中的循环。

最大。. . 至于新的连接语法。这不仅仅是“品味”问题。`from`子句中的“，”*表示*“交叉连接”。在大多数情况下，这是一项非常昂贵的操作。清楚你想要完成的事情要好得多：

```
FROM A cross join B 
```

比：

```
FROM A, B 
```

其次，如果你把“，”去掉，你仍然有有效的语法：

```
FROM A B 
```

但是，这意味着一些非常不同的事情（将别名 B 分配给表 A）。

第三个原因是最重要的原因。旧语法没有表达`left outer join`,`right outer join`和的方法`full outer join`。

因此，要编写更清晰的查询、避免错误并访问更好的功能，您应该学习新语法。

# c++ - 没有 O(number_of_vertices) 使用内存或时间的 BGL 中的有限深度搜索？

> ID：14082581
> 
> 赞同：2
> 
> 时间：2012-12-29T14:27:28.863
> 
> 标签：c++, boost-graph

是否可以在不访问、过滤、索引等图形中的所有顶点的情况下进行深度或广度优先搜索/访问到 BGL 中某个顶点的某个距离？

我设法写的最接近的是（创建图 0<->1<->2<->3<->4<->5 但只访问顶点 0 到 3）：

```
#include <iostream>
#include <boost/graph/adjacency_list.hpp>
#include <boost/graph/depth_first_search.hpp>

using namespace std;

struct custom_dfs_visitor : public boost::default_dfs_visitor {
    template < typename Vertex, typename Graph >
    void discover_vertex(const Vertex& v, const Graph& g) const {
        std::cout << v << std::endl;
    }
};

struct Terminator {
    template<class Vertex, class Graph>
    bool operator()(const Vertex& v, const Graph& g) {
        return v > 2;
    }
};

int main()
{
    typedef boost::adjacency_list<
        boost::vecS,
        boost::vecS,
        boost::undirectedS
    > Graph_T;

    Graph_T g(6);
    boost::add_edge(0, 1, g);
    boost::add_edge(1, 2, g);
    boost::add_edge(2, 3, g);
    boost::add_edge(3, 4, g);
    boost::add_edge(4, 5, g);

    std::vector<boost::default_color_type> color_map(boost::num_vertices(g));
    boost::depth_first_visit(
        g,
        boost::vertex(0, g),
        custom_dfs_visitor(),
        boost::make_iterator_property_map(
            color_map.begin(),
            boost::get(boost::vertex_index, g),
            color_map[0]
        ),
        Terminator()
    );

    return 0;
} 
```

它只打印 0 1 2 3 而不是访问所有顶点，但代码仍然需要与整个图一样大的颜色图（boost::num_vertices(g)）。有没有办法让搜索复杂度与图中的边/顶点总数不相上下？

使用捆绑颜色是可以接受的，因为许多搜索将在图形的不同部分进行，但是是否可以从 O(number_of_vertices) 降低同一图形中每个单独搜索的复杂性？当 Terminator 返回 true 时，顶点的初始着色也有望停止，但这似乎已经处理好了。也许是一个相关的问题：如果图形使用 vecS 以外的东西，那么索引呢？在这种情况下，BFS/DFS 可以不使用索引吗？谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-05T18:43:17.763

事实证明，使用捆绑属性是完成此任务的最简单方法。color 属性包含在每个顶点中的事实比每次 dfs 完成时为每个顶点创建 color 属性要好。图表类型应该是

```
typedef boost::adjacency_list<
    boost::vecS,
    boost::vecS,
    boost::undirectedS,
    property<vertex_color_t, boost::default_color_type>
> Graph_T; 
```

对 dfv 的调用是

```
depth_first_visit(
    g,
    vertex(0, g),
    custom_dfs_visitor(),
    get(vertex_color_t(), g),
    Terminator()
); 
```

如上所述，在具有 100 M 个顶点的图形中执行有限的 dfs 不会增加内存消耗（占总内存的 76.2%），而在搜索时使用外部颜色向量的内存使用率从 76.2% 增加到 78.5%。

# c# - 向空数据集添加值

> ID：14082583
> 
> 赞同：0
> 
> 时间：2012-12-29T14:27:51.110
> 
> 标签：c#, dataset, nullreferenceexception

我有一个空数据集添加到我的应用程序中。我想用一些内容填充它。我按以下方式进行

```
DataRow newrow = filteredLeads.Tables["filterLeads"].NewRow();
String fn = row.Field<String>("First Name");
String ln = row.Field<String>("Last Name");
Double ph = row.Field<Double>("Phone");
String ad = row.Field<String>("Address");

newrow["First Name"] = fn;
newrow["Last Name"] = ln;
newrow["Phone"] = ph;
newrow["Address"] = ad;

filteredLeads.Tables["Leads"].Rows.Add(newrow); 
```

但是我在最后一行说 system.nullReferenceException 出现错误。我的数据集是空的，我在其上定义了一个名为 filterLeads 的表。发生了什么。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T14:29:50.127

你`DataSet`有名称为`filterLeads`not的表`Leads`。正如您在问题中所说，在*其上定义了一个名为 filterLeads 的表*

*改变*

```
filteredLeads.Tables["Leads"].Rows.Add(newrow); 
```

*至*

```
filteredLeads.Tables["filterLeads"].Rows.Add(newrow); 
```

# asp.net-mvc - ASP.NET MVC POST 动作请求保护

> ID：14082584
> 
> 赞同：0
> 
> 时间：2012-12-29T14:27:55.713
> 
> 标签：asp.net-mvc

想象一下，我有一个 HTTP POST 操作，其方法签名为：

```
RegisterUser(string email, string password) 
```

该方法的实现会进行一些基本的验证（例如，查看用户存储库中是否不存在电子邮件），然后将此信息作为记录存储在用户存储库中。

假设我接着从“注册”视图对该操作进行 AJAX 调用。如果某些恶意用户在客户端查看该视图的标记，他们将很容易看到 RegisterUser 操作的 URL 并确定他们需要传递给它的内容（电子邮件和密码）。

那么是什么阻止了该用户编写一个调用这个动作 1 亿次的程序呢？我可以设置哪些安全防护措施？我应该在 ASP.NET MVC 中阅读哪些内容可以保护我免受此类 POST 攻击？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T17:54:06.317

我建议您[`Dynamic IP Restrictions`](http://www.iis.net/learn/manage/configuring-security/using-dynamic-ip-restrictions)在 IIS 中安装该模块或[`throttling solution`](https://stackoverflow.com/a/1318059/29407)在您的应用程序中实现一个。这将防止同一用户向控制器操作发送多个请求。但它不会保护您免受[`DDOS`](http://en.wikipedia.org/wiki/Denial-of-service_attack#Distributed_attack)攻击，因为在这类攻击中，请求来自不同的 IP 地址。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T14:32:46.793

您所描述的防止拒绝服务 (DOS) 攻击的最常见形式是使用某种类型的[验证码](http://en.wikipedia.org/wiki/CAPTCHA)。

虽然[这个问题](https://stackoverflow.com/questions/2286688/how-to-use-captcha-in-asp-net-mvc)已经结束，但它应该提供一些关于在 ASP.NET MVC 中实现它的有用信息

# git - Git - 一种删除/撤销提交的方法

> ID：14082585
> 
> 赞同：0
> 
> 时间：2012-12-29T14:28:09.800
> 
> 标签：git, github

如果您时间紧迫，请跳过以下完全非技术性的无关 3 段。

我已经与网络上的文本流斗争了几个小时，只是为了了解如何恢复提交，后来发现这是不必要的、不需要的或错误的。有很多关于 git 的介绍性和高级教程/手册，当事情变得复杂时，其中大部分都无法提供实用的指导。即使是stackoverflow上的漂亮答案有时也可能会变得飘忽不定和误导，因为最终我们是尝试实施这些答案的菜鸟，大多失败了几十次，并且对生活感到沮丧=/

当这些问题与我们可爱、珍贵的项目有关时，它会变得越来越可怕和压力，而 git 是一个复杂的生物，大多数时候都不愿意合作，这让事情变得更加困难（！）

对于冗长的介绍非常抱歉，我知道大多数人可能并非如此，但对我和其他人来说，手册、帮助和指南有时是无助的，你靠自己的运气、洞察力和耐力。这就是为什么，我今天不打算问一个问题，而是在它成为我对我的问题的可爱解决方案之后回答一个可能的问题，希望它能帮助你摆脱痛苦=）

* * *

`Problem`：如果您对项目进行了更改但想恢复它，即使有很多方法可以做到这一点，这个对我来说已经很亮了：`git rebase`. 不管你是否推送你的更改，我们都可以恢复那个提交，但是如果你已经推送了，我们需要再次推送以更新 github 上的 master 分支，我稍后会回来.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T14:35:41.873

*   第 1 步：跟踪您不需要的提交的顺序 -->`git log`

*   第 2 步：执行 rebase 以操纵提交 --> `git rebase -i HEAD~n`，这样 'n = 不需要的提交的顺序'。示例：如果要恢复最近的提交，请将 n 替换为 1。

*   第 3 步：将向您介绍一个编辑器，您必须在该编辑器上编辑页面顶部的行，那些没有以#开头的行。每行按顺序代表一个提交（最近的提交显示在顶部）。选择您要删除的提交并删除整个相应的行。然后按`ctrl+x`您的键盘，`'y'`最后按`enter`。

*   第 4 步：如果一切顺利，你很好，该提交被删除，你准备好跳“第 9 步”。但是，如果不是这种情况，并且如果您收到错误消息，则意味着在各种提交之间存在链接更改，这些更改在这些提交之间创建了依赖关系。这就是为什么你不能像这样删除一个提交，因为它被另一个依赖。首先，我们必须解决这个冲突。

*   第 5 步：由于出现错误，`rebase`让您进入 git 的边缘，使您能够进行更改，例如更改文件的路径，而无需您在任何分支上在线。无论如何，此时，检查状态-->`git status`

*   第 6 步：如您所见，有`'changes to be committed'`or/and `'unmerged paths'`。您首先必须通过此命令逐个添加它们-->`git add any_file_path`

*   第 7 步：现在是提交的时候了。这些更改将更新另一个现有提交，这取决于您删除的提交。请记住，错误是由于冲突而显示的，通过提交更新，错误将得到解决。-->`git commit`

*   第 8 步：现在，您可以检查`git log`是否删除了不需要的提交。是时候继续前进了。-->`git rebase --continue`

*   步骤 9：执行`git status`并查看是否需要“强制推送”。如果您之前推送过不需要的提交，您将在“状态”上看到您与“主/原点”不同。您还可以看到 'origin/master' 的提交比现在多，因为您在一分钟前删除了一些。现在，是时候更新 github 上的 master 分支了。如果状态上一切正常（这意味着您之前没有推送不需要的提交），则跳过下一步。

*   第 10 步：为了更新 github，只需执行强制推送。-->`git push origin +master`

*   第 11 步：恭喜！你完成了你的目标。现在，您可以从本地 repo 和 github 上的不需要的提交中解脱出来。从`git status`您可以看到，由于您已同步，您不再与“origin/master”不同，并且`git log`您可以确认不需要的提交的死亡。您还可以登录“github”并通过单击“提交”从那里进行检查。

* * *

目前为止就这样了。我可能犯了错误，并会感谢任何正确的编辑。

# javascript - 如何在我的javascript球移动时给它一个滚动动画？

> ID：14082588
> 
> 赞同：7
> 
> 时间：2012-12-29T14:28:20.817
> 
> 标签：javascript, jquery, animation

我有以下 HTML 代码：

`<img src="game_files/ball.png" id="ball" />` 这是一个包含球图像的 div（球的顶视图）

这个球我可以用我的箭头键和一些 javacript 向上、向左、向右、向下等移动。我使用以下代码执行此操作：

```
var ball = function  () {
    var inited = false,
        el,
        xcheck = 50,
        x = 50,
        ycheck = 50,
        y = 50,
        xspeed = 0,
        yspeed = 0,
        power = 0.4,
        friction = 0.99,
        xwind = 0,
        ywind = 0,
        dead = true,
        timer = function(keys) {
            if (dead === true) {
                return;
            }
            if (keys[38] === true) {
                yspeed += power;
            }
            if (keys[40] === true) {
                yspeed -= power;
            }
            if (keys[37] === true) {
                xspeed += power;
            }
            if (keys[39] === true) {
                xspeed -= power;
            }
            xspeed = xspeed * friction - xwind;
            yspeed = yspeed * friction - ywind;
            if (Math.abs(xspeed) < 0.004) {
                xspeed = 0;
            }
            if (Math.abs(xspeed) < 0.004) {
                xspeed = 0;
            }
            x -= xspeed;
            y -= yspeed;
            plane.move(x,y);
        };
    return {
        init: function() {
            if (inited != true) {
                inited = true;
                el = document.getElementById('ball');
                roller.register(timer, 'time');
            }
        }
    };
}(); 
```

这一切都有效，但球没有滚动动画！图像只是向左或向右滑动如何添加？我找到了这个教程：[http](http://www.emanueleferonato.com/2007/06/10/creation-of-realistic-spheres-in-flash-with-textures-and-masking/) ://www.emanueleferonato.com/2007/06/10/creation-of-realistic-spheres-in-flash-with-textures-and-masking/我认为可以帮助我。

不幸的是，这是一个闪光球（我希望这也适用于 JS）。本教程正是我想要的：一个带有滚动动画的球（请参阅教程末尾附近的教程页面 豹皮球，就在下面：第 26-37 行：如果纹理相对于球的位置。 ..)。

我怎样才能把它应用到我的 JS 球上？有什么想法吗？

亲切的问候和新年快乐

ps 我也使用/加载 jquery

- 编辑 - - - -

创建了一个小提琴：http: [//jsfiddle.net/mauricederegt/dhUw5/](http://jsfiddle.net/mauricederegt/dhUw5/)

1-打开小提琴

2-点击 1

3- 使用箭头键移动球，留在绿地上！

4-看，没有滚动效果

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T18:48:24.303

要获得与您链接的 Flash 示例中相同的效果，您只需向元素添加背景并相应地移动它。

我用跨度替换了您的 img 元素，并通过 CSS 和边框半径为其提供了背景图像以使其圆形。在您的 plane.move 函数中，我添加了以下行：

```
document.getElementById('ball').style.backgroundPosition = x + 'px ' + y +'px'; 
```

瞧，与 Flash 示例中的效果相同：http: [//jsfiddle.net/dhUw5/1/](http://jsfiddle.net/dhUw5/1/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-29T15:48:37.810

您可能会使用 HTML5 画布。您将使用剪裁部分用作球表面的图像[`drawImage`](http://www.w3schools.com/tags/canvas_drawimage.asp)，然后[对其进行遮罩以获得圆形](http://blog.teamtreehouse.com/create-vector-masks-using-the-html5-canvas)。然后，您可以通过重新绘制画布为其设置动画，并以与您链接到的 flash 示例类似的方式更改剪辑位置（sx、sy）。（以下内容未经测试；如果您想尝试，请使用您的原始代码制作一个 jsfiddle。）

```
// ... when the user moves
this.sy += yspeed;
this.sx += xspeed;
if (this.sx > textureSize) {
    this.sx -= textureSize;
}
else if (this.sx < 0) {
    this.sx += textureSize;
}
if (this.sy > textureSize) {
    this.sy -= textureSize;
}
else if (this.sy < 0) {
    this.sy += textureSize;
}

// ... redraw the ball once every frame
context.clearRect(0, 0, canvasWidth, canvasHeight); // clear the canvas
context.save();
context.beginPath();
context.arc(this.x, this.y, ballRadius, Math.PI * 2, false);
context.clip();    
context.drawImage(ballImage, this.sx, this.sy, 
                  ballDiameter, ballDiameter, 
                  this.x, this.y,
                  ballDiameter, ballDiameter);      // redraw the ball      
context.restore(); 
```

或者，您可以使用带有纹理的 div 作为背景图像，并使用 CSS3 或通过覆盖另一个图像对其进行遮罩以制作圆形（请参阅[HTML5 中遮罩图像的最佳方法](https://stackoverflow.com/questions/8337570/best-way-to-mask-an-image-in-html5)）。然后您将使用更改背景图像（纹理）的坐标

`ballElement.style.backgroundPosition = this.sx + 'px ' + this.sy + 'px';`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-29T18:30:41.667

如果您使用 CSS 转换，这非常容易。在此示例中，旋转速度是根据球当前运动速度的标量值确定的：

```
 var increment = Math.round(Math.sqrt(Math.pow(xspeed, 2) + Math.pow(yspeed, 2)));
    if (!isNaN(increment)) {
        currangle = currangle + ((xspeed < 0 ? 1 : -1) * increment);
    }

    $('#ball').css({
        '-webkit-transform': 'rotate(' + currangle + 'deg)'
    });

    $('#ball').css({
        '-moz-transform': 'rotate(' + currangle + 'deg)'
    }); 
```

此代码进入`move`. `plane`这是一个演示：http: [//jsfiddle.net/BahnU/show/](http://jsfiddle.net/BahnU/show/)

# php - php - 访问在另一个函数中定义的函数中的变量？

> ID：14082589
> 
> 赞同：0
> 
> 时间：2012-12-29T14:28:27.403
> 
> 标签：php, function, variables, tags, defined

我试图从我在该函数中调用的另一个函数中获取我在函数中定义的变量，例如：

```
$thevar = 'undefined';
Blablahblah();
echo $thevar; (should echo blaaah)
function Blahedit(){

     echo $thevar; (should echo blah)
     $thevar = 'blaaah';

}
function Blablahblah(){

     global $thevar;
     $thevar = 'blah';
     Blahedit();

} 
```

我想知道是否有另一种方法可以在不将参数传递给 Blahedit() 的情况下执行此操作，get_defined_vars 在函数中为我提供 vars 而不是 $thevar... 并且调用 global $thevar 只会给我以前未编辑的版本。

请帮忙 ）：

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T14:31:23.657

你可以使用这个： http: [//php.net/manual/en/reserved.variables.globals.php](http://php.net/manual/en/reserved.variables.globals.php)

或者最好看看 oop

[http://php.net/manual/en/language.oop5.php](http://php.net/manual/en/language.oop5.php) http://php.net/manual/en/language.oop5.basic.php

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T14:33:16.477

您可以将变量[作为参考参数](http://php.net/manual/en/language.references.pass.php)传递（如下所示），将您的代码封装在一个类中并将您的变量用作类属性或让函数返回更改后的变量。

```
$thevar = 'undefined';
Blablahblah($thevar);
echo $thevar; 

function Blahedit(&$thevar){
     echo $thevar;
     $thevar = 'blaaah';
}

function Blablahblah(&$thevar){
     $thevar = 'blah';
     Blahedit($thevar);
} 
```

**在函数内部使用全局变量被认为是一种不好的做法**。但是，通过引用传递大量变量也不是好的风格。

如果你想让你的代码按原样工作，你必须在`global $thevar`你的编辑函数中添加一个：

```
function Blahedit(){
     global $thevar;
     echo $thevar; (should echo blah)
     $thevar = 'blaaah';
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T14:36:45.550

只是 blahedit 中的全局 $thevar。

```
function Blahedit(){
    global $thevar;
    echo $thevar; //(should echo blah)
    $thevar = 'blaaah';

} 
```

# mysql - MySQL GROUP BY 在迁移到 SQL Server 2012 时不起作用

> ID：14082592
> 
> 赞同：2
> 
> 时间：2012-12-29T14:28:42.100
> 
> 标签：mysql, sql, sql-server

我正在将我的 Delphi 应用程序从 MySQL 移动到 SQL Server 2012。在 MySQL 中，我有这个查询：

```
SELECT *,(XS+S+M+L+XL+XXL+[1Size]+Custom) as Total FROM StockData  
GROUP BY StyleNr,Customer,Color  
ORDER BY StyleNr,Customer,Color 
```

它工作得很好。但在 Microsoft SQL Server 2012 中，这个查询说

> 消息 8120，级别 16，状态 1，行 1
> 列“StockData.ID”在选择列表中无效，因为它不包含在聚合函数或 GROUP BY 子句中。

如果我将查询更改为：

```
SELECT *,([XS]+[S]+[M]+[L]+[XL]+[XXL]+[1Size]+[Custom])  total
 FROM [dbo].[stockdata]
 GROUP BY ID,StyleNr,Customer,Color
 ORDER BY StyleNr,Customer,Color 
```

然后我得到这个错误：

> 消息 8120，级别 16，状态 1，行 1
> 列 'dbo.stockdata.XS' 在选择列表中无效，因为它不包含在聚合函数或 GROUP BY 子句中。

有任何想法吗？

这是表的设计视图：

![在此处输入图像描述](../Images/1c1ca29dbac5aeacce4aca572089363a.png)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-29T14:32:02.423

SQL Server 正在按预期工作。您必须将`SELECT`列表中的所有项目包含在 a`GROUP BY`或聚合函数中：

```
SELECT *,(XS+S+M+L+XL+XXL+[1Size]+Custom) as Total 
FROM StockData  
-- GROUP BY ID,StyleNr,Customer,Color, XS,S,M,L,XL,XXL,[1Size],Custom
ORDER BY StyleNr,Customer,Color 
```

或者您可以使用：

```
SELECT StyleNr,Customer,Color, SUM(XS+S+M+L+XL+XXL+[1Size]+Custom) as Total 
FROM StockData  
GROUP BY StyleNr,Customer,Color
ORDER BY StyleNr,Customer,Color; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T14:31:45.950

聚合查询中的所有列必须由聚合函数或 group by 使用。尝试只选择您需要的列而不是 * 即选择 stylenr, customer, color, ([...] ) 作为 Total from。

这是处理聚合的 SQL 标准方式，您会在 Oracle 中遇到类似的错误。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-29T14:41:07.247

您也可以使用这种方法：

```
with OrdinalOnGroup
(
    SELECT 
        Ordinal = rank() over(partition by StyleNr, Customer, Color order by id) 
        , *, (XS+S+M+L+XL+XXL+[1Size]+Custom) as Total 
    FROM StockData  
)
select * 
from OrdinalOnGroup
where Ordinal = 1; 
```

PARTITION BY 表示相关信息的分组，这称为[加窗](https://www.simple-talk.com/sql/learn-sql-server/working-with-window-functions-in-sql-server/)

# dns - 主 DNS 矿井辅助公共？

> ID：14082601
> 
> 赞同：0
> 
> 时间：2012-12-29T14:30:23.873
> 
> 标签：dns

我正在使用 Windows Server 创建我自己的 DNS 服务器，其他用户将使用我的 DNS 服务器，并认为如果它出现故障，我应该有一个备份，如果用户将我的 DNS 设置为 Primary 和 Secondary 可以类似于 google public dns ? 它将如何运作？如果它无法使用我的 DNS 解析它会尝试谷歌的？它会尝试每个请求吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T16:25:45.873

由于您提到了 Google 的公共 DNS 服务器，我假设您在谈论用作递归解析器的名称服务器（而不是作为包含区域的权威服务器）。

DNS 不区分“主要”和“次要”名称服务器。实际发生的事情取决于客户。

有些客户可能会按顺序查询域名服务器，因此他们会先查询您的域名服务器，然后只有在没有收到您的回复时才查询 Google 的域名服务器。其他客户端可能会从列表中为每个查询选择一个随机服务器，因此他们有时会查询您的服务器，有时会查询 Google 的服务器。还有一些人可能会跟踪每个名称服务器的统计信息，并更喜欢通常会提供更快响应的名称服务器。最后一个选项需要一个有状态的客户端，这是另一个充当转发器的名称服务器可能会做的事情。

实际上，这并不重要，因为您的递归解析器和 Google 的公共递归解析器*应该*为每个查询提供相同的响应。

# localization - 使用资源在 ASP.NET MVC4 中本地化 ViewModel

> ID：14082602
> 
> 赞同：4
> 
> 时间：2012-12-29T14:30:26.197
> 
> 标签：localization, asp.net-mvc-4

首先，我想澄清一下，我目前正在使用 ASP.NET MVC 的`Model`实体，`ViewModel`因为我的项目是基于 MVCVM 的，所以我并不是简单地将两者混淆。

无论如何，MVC 会自动为我创建一些 ViewModel 实体的属性，如下所示（来自向导，本地化为意大利语）

```
public class LoginModel
{
    [Required]
    [Display(Name = "Nome utente")]
    public string UserName { get; set; }

    [Required]
    [DataType(DataType.Password)]
    [Display(Name = "Password")]
    public string Password { get; set; }

    [Display(Name = "Memorizza account")]
    public bool RememberMe { get; set; }
} 
```

`Display`将属性替换为`[Display(Name = LoginViewModelResources.lblUsername)]`会导致编译错误：“参数必须是常量表达式、类型表达式或矩阵创建表达式”。简而言之，属性引用是禁忌。

Razor 视图使用如下标签来生成 HTML

```
@Html.LabelFor(m => m.UserName)
@Html.TextBoxFor(m => m.UserName)
@Html.ValidationMessageFor(m => m.UserName) 
```

**如何本地化 ViewModel 以便在前端显示正确的消息？**

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-29T14:36:41.890

像这样：

```
[Required]
[Display(Name = "lblUsername", ResourceType = typeof(LoginViewModelResources))]
public string UserName { get; set; } 
```

为此，您必须定义一个`LoginViewModelResources.resx`文件`Custom Tool=PublicResXFileCodeGenerator`（您在资源文件的属性中设置）并包含一个标签，该标签`lblUsername`将保存本地化资源。

# css - 使用 Sass 的媒体查询不会编译

> ID：14082604
> 
> 赞同：8
> 
> 时间：2012-12-29T14:31:08.723
> 
> 标签：css, sass

我在使用媒体查询混合编译我的 Sass 文件时遇到错误。我遵循了几个教程，但它不会编译。我正在使用`Sass 3.3.0.alpha.67 (Bleeding Edge)`.

**这是我的代码**

```
/* Included at the end */
@mixin mobile-only {
    @media (max-width : 320px) {
        @content;
    }
}

/* Included where the rest of my sass is */
body { @include mobile-only { 
            display: none; 
    } 
} 
```

我正在使用 Scout 来编译和观察变化。还有什么我需要做的吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-05-31T14:53:42.420

似乎不再是问题了。在这个codepen [http://codepen.io/danielcgold/pen/RRNrPQ中解释了](http://codepen.io/danielcgold/pen/RRNrPQ)*稍微*修改的代码。

```
@mixin start-desktop-size {
  @media (min-width: 1024px) {
    @content;
  }
}

body { 
  @include start-desktop-size { 
    background: red; 
  } 
} 
```

# sql - 触发器中是否有任何方法可以跳过 DB2 中特定用户的更新/插入？

> ID：14082605
> 
> 赞同：0
> 
> 时间：2012-12-29T14:31:11.970
> 
> 标签：sql, database, triggers, db2

我对TRIGGERS知之甚少，以下是我的疑问，请提出任何答案。

系统：我有一个名为 A 的带有触发器的表，它的设计方式是，如果发生任何更新/插入，它将在表 B 中更新/插入相同的内容。

过程：表 A 将由多个用户更新

我的问题：我想阻止一个用户/批量作业。即，如果此用户/BatchJob 在表 A 中执行任何更新/插入，则不会传播到表 B。

在 DB2 触发器中是否可行？如果是这样，请帮助我。提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T14:36:12.067

您可以将包含要阻止的用户的新表添加到数据库（或将列添加到现有用户表）。

然后像这样改变你的触发器

```
if current_user is not in blocked_user_table
then
    insert in table b
end 
```

# c++ - 将变量传递给类方法

> ID：14082608
> 
> 赞同：1
> 
> 时间：2012-12-29T14:31:52.143
> 
> 标签：c++

我在一个名为 Man 的类中有一个名为 update 的方法。在我的 main.cpp 中，我调用：

```
int age=0;
Man person;
person.Update(age); 
```

这会在方法中更新人的年龄。但是，当我回到主文件时，它没有更新的年龄。所以变量是在类方法中设置的，但不会返回到 main.cpp 上下文。

# 编辑

```
Man::Update(int age)
{
    age++;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T14:35:41.307

```
void Man::Update(int & age)
{
   age++;
} 
```

它应该工作

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-29T14:36:32.087

对于要在调用范围内反映回变量的更改，必须将对该变量的引用传递给函数。传递引用时，函数范围内的变量有效地引用 / 是调用范围内的变量。

```
Man::Update(int &age) //The ampersand reflects that it is a reference
{
    age++;
} 
```

您正在做的事情称为按值传递。在这种情况下，会在函数作用域中创建变量的新副本，所做的任何更改都不会反映在调用作用域中。

看这个以获得[详细的解释](http://www.cplusplus.com/doc/tutorial/functions2/)，看这个以获得[问答风格的解释](https://stackoverflow.com/questions/410593/pass-by-reference-value-in-c)。

但是，您在这种特定情况下所做的事情根本不需要类或成员函数。可以使用单个*普通*函数来完成。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-29T14:36:54.917

您正在*按 value*`age`传递参数。这意味着它被复制到函数中并且该副本被修改。您需要*通过引用*传递参数。这在 C++ 中很容易完成，因为它提供了引用类型。具有引用类型的名称充当它所绑定的对象的别名。您所要做的就是在您的类型中添加一个 & 符号 ( )：*`Update`*`&`**

 **```
void Man::Update(int& age)
{
  age++;
} 
```

当您这样做时，`person.Update(age);`您将对象绑定到函数`age`中的引用`age`。

其他人可能会为您提供使用指针的替代方法（获取`int*`参数并传递`&age`给函数）。这就是它在 C 中的实现方式——但我们不是在编写 C。不要让他们愚弄你！采用引用类型比使用指针更安全、更具表现力。

但是，我质疑为什么您有一个名为`Man`并且`age`不是`Man`. 类是一种将相关数据作为对象一起存储的方法。我认为年龄是代表男性的数据的一部分。**

# ruby-on-rails - Rails 客户端验证不适用于简单的表单关联

> ID：14082609
> 
> 赞同：3
> 
> 时间：2012-12-29T14:31:56.603
> 
> 标签：ruby-on-rails, ruby, simple-form, client-side-validation

我有一个模型用户

```
class User < ActiveRecord::Base
  validates :goal, :presence => true, :on => :update
  belongs_to :goal, :class_name => Goal, :foreign_key => "goal_id"
  ...
end 
```

在我的表格上

```
<%= simple_form_for @users,:remote => true, :url => registration_path(resource_name), :html => { :method => :put, :multipart => true }, :validate => true do |f| %>
 <%= f.association :goal,:label => "My overall goal is clearing", :input_html => {:class => 'goals'},:include_blank => true %> 
```

但是 Rails 客户端验证并没有接受关联验证，它让我可以为目标填写空白。

Rails 客户端验证 gem 是否适用于简单的表单关联？

我在我的 html 页面上得到以下脚本

```
if (window.ClientSideValidations == undefined) window.ClientSideValidations = {};
if (window.ClientSideValidations.forms == undefined) window.ClientSideValidations.forms = {};
window.ClientSideValidations.forms['edit_user_14'] = {
    "type": "SimpleForm::FormBuilder",
    "error_class": "error",
    "error_tag": "span",
    "wrapper_error_class": "field_with_errors",
    "wrapper_tag": "div",
    "wrapper_class": "input",
    "wrapper": "default",
    "validators": {
        "user[mobile_number]": {
            "format": [{
                "message": "should be 10 digits",
                "with": /^\d{10}$/i
            }]
        },
        "user[profile_pic]": {
            "integrity": [{
                "message": "translation missing: en.activerecord.errors.models.user.attributes.profile_pic.integrity"
            }],
            "processing": [{
                "message": "translation missing: en.activerecord.errors.models.user.attributes.profile_pic.processing"
            }],
            "download": [{
                "message": "translation missing: en.activerecord.errors.models.user.attributes.profile_pic.download"
            }],
            "format": [{
                "message": "Wrong file format",
                "with": /\.(gif|jpeg|jpg|png)$/i,
                "allow_blank": true
            }]
        }
    }
}; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-08-12T22:22:33.747

这里的关键区别是使用`validates :goal_id ...`not`validates :goal ...`

由于这是一个关联，因此您的 ActiveRecord 模型（以及基础数据存储中）的真实属性是`goal_id`. 这就是`client_side_validations`默认情况下要查找的内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T15:27:02.323

看起来`ClientSideLavodation`gem 找不到适当的关联验证，所以只需添加

```
validates :goal_id, :presence => true, :on => :update 
```

到你的模型。

# ssh - Gitolite 设置：无法使用 ssh 密钥登录

> ID：14082611
> 
> 赞同：1
> 
> 时间：2012-12-29T14:32:02.450
> 
> 标签：ssh, centos, gitolite

我正在尝试在我的服务器（Centos 6.3）上设置 Gitlab，并面临 Gitolite 设置的一些问题。

我创建了两个用户（如指南中所述:)）。gitlab 和 git。为 gitlab 创建 ssh 密钥并将公钥（gitlab.pub）复制到 git 的家。并设置它`gitolite setup -pk gitlab.pub`。

现在，当我尝试从 gitlab 帐户打开 ssh 会话时，它会要求输入密码。命令如下

```
ssh git@localhost
git@localhost's password:  #asks for password here 
```

没有错误或警告。复制测试回购失败并出现同样的问题。谁能帮我找出问题所在。

我使用的指南是
1\. [Gitlab 安装](https://github.com/gitlabhq/gitlabhq/blob/stable/doc/install/installation.md)（适用于 ubuntu）
2\. [https://gist.github.com/4362544](https://gist.github.com/4362544)（特定于centos）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T14:35:12.493

你能发个指南的链接吗？也许我可以看到你错过了哪一步。

但一般来说，您需要为您尝试 ssh 到 git 的用户创建自己的密钥对，然后将其公钥放入 gitolite 配置。

根据您的指南，这些是与密钥身份验证有关的步骤：

```
# adduser --system --shell /bin/sh --comment 'git version control' --user-group --create-home --home-dir /home/git git
# adduser --shell /bin/bash --create-home --home-dir /home/gitlab gitlab
# su - gitlab
$ ssh-keygen -t rsa
$ exit
# cp ~gitlab/.ssh/id_rsa.pub ~git/gitlab.pub
# chmod 0444 ~git/gitlab.pub
# su - git
$ git clone git://github.com/gitlabhq/gitolite ~/gitolite
$ echo -e "PATH=\$PATH:/home/git/bin\nexport PATH" >> ~/.profile
$ source ~/.profile
$ gitolite/src/gl-system-install
$ sed -i 's/0077/0007/g' share/gitolite/conf/example.gitolite.rc
$ gl-setup -q /home/git/gitlab.pub
$ exit 
```

所以，检查你有没有`~gitlab/.ssh/id_rsa.pub`，检查你有没有`~git/gitlab.pub`。

然后，仅密钥连接将仅从`gitlab`用户工作，因此请确保您正在尝试`ssh git@localhost`以 user 身份登录`gitlab`。

如果这就是您正在做的事情，您可以查看`/var/log/messages`或`/var/log/syslog`出于关键拒绝的原因。此外，验证是否在 中启用了基于密钥的身份验证`/etc/ssh/sshd_config`，如果没有启用它并重新启动`sshd`。

# javascript - 从函数返回的数据未定义

> ID：14082613
> 
> 赞同：0
> 
> 时间：2012-12-29T14:32:20.757
> 
> 标签：javascript, jquery, ajax, asynchronous, return

我在将数据从 ajax 返回到调用者函数时遇到问题。当我 console.loging 它是未定义的。

我相信我的问题是由于 js 是异步的，当我在 console.loging 数据时它还没有准备好。我能做些什么来解决它？

```
FooFunction: function(userInput){

    var fooData = FooFunction2(userInput);
    console.log(fooData);     // <--- undefined
},

FooFunction2: function(userInput) {

    $.ajax({
         url:'./php/test.php',
         type:'post',
         dataType:'json',
         data:{ 
             fooData: userInput
         },
         success:function(data) {
             ...manipulating the data...

             console.log(manipulatedData);    // <--- ['foo', 'foo2'];
             return manipulatedData;
         }
    });
}, 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T14:40:29.843

ajax 调用是异步的，所以返回不起作用。更改您的代码以使用在 ajax 调用完成时调用的回调。

我改变了你的代码来做到这一点：

```
FooFunction: function(userInput){
    var callbackfunc = function(ajaxData)
    {
        console.log(ajaxData); //ajax is complete!
    };

    this.FooFunction2(userInput, callbackfunc);
},

FooFunction2: function(userInput, callbackfunc) {

    $.ajax({
         url:'./php/test.php',
         type:'post',
         dataType:'json',
         data:{ 
             fooData: userInput
         },
         success:function(data) {
             ...manipulating the data...

             console.log(manipulatedData);    // <--- ['foo', 'foo2'];
             callbackfunc(manipulatedData);
         }
    });
}, 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T14:36:38.793

`FooFunction2`是对象使用的属性`this.FooFunction2`

你不能从异步方法返回。使 ajax 调用同步或 proivde 回调。

```
FooFunction: function(userInput){

    var fooData = this.FooFunction2(userInput);
    console.log(fooData);     // <--- undefined
}, 
```

修改后的代码

```
FooFunction: function(userInput){

     this.FooFunction2(userInput, function(fooData){
          console.log(fooData);     // <--- undefined
    });

},

FooFunction2: function(userInput, cb) {

    $.ajax({
         url:'./php/test.php',
         type:'post',
         dataType:'json',
         data:{ 
             fooData: userInput
         },
         success:function(data) {
             ...manipulating the data...

             console.log(manipulatedData);    // <--- ['foo', 'foo2'];
             cb(manipulatedData);
         }
    });
}, 
```

# java - 如何让 Java 在 System.exit(0) 上释放所有内存？

> ID：14082619
> 
> 赞同：1
> 
> 时间：2012-12-29T14:32:51.833
> 
> 标签：java, winapi, memory-leaks

我们的应用程序是 Java 和本机代码的混合体。它会泄漏内存。

最可能的原因是本机代码，并且确实存在泄漏，但是，它们似乎并不是唯一的贡献者。

无论如何，我使用本地分析器来分析应用程序，使用我在本地构建的 OpenJDK 6，因此我有 Java 本身的完整源代码和完整符号。

方法很简单——我运行应用程序，然后在某个时候我发出信号让它优雅地终止。优雅终止包括三个步骤：

1.  发信号通知本机代码进行清理。
2.  停止 http 服务器（Restlet + 简单）
3.  调用 System.exit(0)

显然，Java 严重依赖操作系统来释放它占用的内存，因为我可以看到多次调用 VirtualAlloc 来保留一些内存，但它永远不会被保留。

但这只是一个例子，有大量已提交的未释放内存，无法确定操作系统有意释放的内容以及泄漏的内容。现在，我不怪 Java，这些泄漏可能是我们做错了的结果。我不知道。

**一个重要的说明。**我不是在谈论在该过程的生命周期内进行清理。有关于 SO 处理它的问题，它们都与我的无关。我希望 Java 在退出时进行清理，以查看真正泄漏了多少内存。

那么，有没有办法告诉 Java 在退出时进行清理以使这种事后泄漏分析可行？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T14:39:03.353

一个好的 java 分析器（例如 YourKit 或 JProfiler）会直接告诉你，如果你通过持有引用泄漏了 java 对象。这将回答您关于非 JNI 泄漏的问题。

对于 JNI 泄漏，（我是根据经验写的），您需要确保您的本机代码可以在*java 之外*进行测试，这样特定于 Java 的链接的可能性很小，您可以小心处理阅读。或与橡皮鸭交谈。

# android - 在Android中失去焦点时不要隐藏对话框

> ID：14082623
> 
> 赞同：2
> 
> 时间：2012-12-29T14:33:17.403
> 
> 标签：android, android-dialog

我在这里的简单代码显示了 Android 中的对话框。当用户在对话框外单击或对话框失去焦点时，我不想隐藏对话框。我该怎么做？

```
DialogInterface.OnClickListener dialogClickListener = new DialogInterface.OnClickListener() {
  public void onClick(DialogInterface dialog, int which) {
    switch (which) {
      case DialogInterface.BUTTON_POSITIVE:
        Toast.makeText(getApplicationContext(), "yes", Toast.LENGTH_LONG).show();
        break;
      case DialogInterface.BUTTON_NEGATIVE:
        Toast.makeText(getApplicationContext(), "no", Toast.LENGTH_LONG).show();
        break;
      }
    }
  }; 
```

按钮代码是：

```
AlertDialog.Builder builder = new AlertDialog.Builder(this);
builder.setMessage("Are you sure?")
  .setPositiveButton("Yes", dialogClickListener)
  .setNegativeButton("No", dialogClickListener).show(); 
```

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-29T14:37:03.087

如果在外面单击，则使用它来隐藏 `dialog.setCanceledOnTouchOutside(true);`

或者如果点击外侧，则使用它不隐藏`dialog.setCanceledOnTouchOutside(false);`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-05-03T14:10:39.727

使用`dialog.setCanceledOnTouchOutside(false)`将阻止对话框隐藏，但如果他单击 Android 设备上的“后退”按钮则不会；

使用`dialog.setCancelable(false)`将防止两者。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T15:56:58.737

此示例代码运行良好，

```
final Dialog dialog = new Dialog(context);
        dialog.setContentView(R.layout.activity_test);
        dialog.setTitle("Title...");
        dialog.setCanceledOnTouchOutside(false);
        dialog.show(); 
```

# syntax-error - if语句上的括号解析错误

> ID：14082627
> 
> 赞同：0
> 
> 时间：2012-12-29T14:34:08.807
> 
> 标签：syntax-error, php, brackets

尝试将一些稍微棘手的表单验证（在本例中用于复选框）与网球锦标赛的注册表单相关

```
<?php 
if ( ( isset($_POST['ms'])&&isset($_POST['ws']) )
        || (isset($_POST['mc'])&&isset($_POST['ws']))
        || (isset($_POST['md'])&&isset($_POST['ws']))
        || (isset($_POST['ms'])&&isset($_POST['wc']))
        || (isset($_POST['ms'])&&isset($_POST['wd']))
        || (isset($_POST['mc'])&&isset($_POST['wc']))
        || (isset($_POST['mc'])&&isset($_POST['wd']))
        || (isset($_POST['md'])&&isset($_POST['wd']))
    ){
      $error_message .=('You can only play as one sex! <br />');
  }

if ( (isset($_POST['mc'])&&isset($_POST['md']) ) { //***
  $error_message .=('You cannot play in both the cadet tournament and mens doubles <br />');
  } 
```

但是，这会导致带有三个星号的行出现解析错误。

> 意外的'{'

大概我做错了什么，不是在使用大括号，而是在使用圆括号......但我看不到在哪里......

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T14:36:12.597

您在第二个`if`语句中缺少右括号，请使用：

```
if ((isset($_POST['mc']) && isset($_POST['md']))) 
```

将来我建议在复杂的语句中计算你的左括号和右括号，以确保它们是平衡的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T14:52:30.740

```
<?php 
if((isset($_POST['ms']) && isset($_POST['ws']))
        || (isset($_POST['mc'])&&isset($_POST['ws']))
        || (isset($_POST['md'])&&isset($_POST['ws']))
        || (isset($_POST['ms'])&&isset($_POST['wc']))
        || (isset($_POST['ms'])&&isset($_POST['wd']))
        || (isset($_POST['mc'])&&isset($_POST['wc']))
        || (isset($_POST['mc'])&&isset($_POST['wd']))
        || (isset($_POST['md'])&&isset($_POST['wd']))
    )){

      $error_message .=('You can only play as one sex! <br />');
  }

if((isset($_POST['mc']) && isset($_POST['md'])){ //***

    $error_message .=('You cannot play in both the cadet tournament and mens doubles <br />');
  } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T15:19:33.003

`(`如果必须删除第二个中的第一个

```
if( isset($_POST['mc']) && isset($_POST['md']) ){ //***
    $error_message .=('You cannot play in both the cadet tournament and mens doubles <br />');
} 
```

# c# - InvalidCastException 试图将 Object[] 数组转换为字符串数组

> ID：14082629
> 
> 赞同：-1
> 
> 时间：2012-12-29T14:34:22.187
> 
> 标签：c#

我有一个将 ArrayList 对象作为参数的方法。

然后我尝试将此 arrayList 转换为字符串数组，但得到 InvalidCastException。

ArrayList 包含七个随机数。由于它们属于对象类型，因此我假设将其转换为字符串应该不是问题。

这是我调用的方法

```
p.matches(winningNumber);

public void matches(ArrayList al)
    {
        try
        {
            string nameFile;

            string[] winningNumber = (string[])al.ToArray(typeof(string));

            Console.WriteLine("Please enter the name of the file you want to Read from");
            nameFile = Console.ReadLine(); 
```

正是在尝试铸造时，我得到了一个例外。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T14:38:28.910

你得到这个异常是因为为了转换为字符串数组，元素本身也必须是字符串。不过，您可以使用 LINQ 来做到这一点：

```
string[] winningNumber = al.Cast<object>().Select(o => o.ToString()).ToArray(); 
```

要处理`null`s，请替换`o.ToString()`为`""+o`或检查`null`s 的条件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T14:37:25.803

改变

```
string[] winningNumber = (string[])al.ToArray(typeof(string)); 
```

到

```
string[] winningNumber = al.Cast<object>.Select(x=> x==null ? string.Empty : x.ToString()).ToArray(); 
```

如果您有一些不是字符串的项目，则可以使用[Enumerable.OfType](http://msdn.microsoft.com/en-us/library/bb360913.aspx)。它将忽略非字符串类型。

```
string[] winningNumber = al.OfType<string>().ToArray(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-29T14:37:51.353

```
string[] winningNumber = al.Cast<object>.Select(x=>Convert.ToString(x)).ToArray(); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-29T14:40:40.453

您只需要在调用 ToArray 之前使用[**Enumerable.Cast**](http://msdn.microsoft.com/en-us/library/bb341406.aspx)

```
string[] winningNumber = al.Cast<string>().ToArray(); 
```

# c# - 时间：2019-05-10 标签：c#applicationautostartwindows7

> ID：14082630
> 
> 赞同：0
> 
> 时间：2012-12-29T14:34:27.030
> 
> 标签：c#, windows, windows-installer, uac

我有一个项目，我在其中添加了一个安装程序项目。我正在关注这个（[自定义安装程序](http://www.codeproject.com/Articles/19560/Launching-Your-Application-After-Install-using-Vis)）

我添加了一个自定义安装程序类。这样做的一个目的是将程序添加到注册表中，以便在任何用户登录时自动启动。我以管理员身份运行 Visual Studio（在 Visual Studio 顶部这样说 - 注意：在计算机管理中我不是管理员）。然而，我的笔记本电脑也使用了一个名为 powerbroker 的应用程序。要安装应用程序，我右键单击并选择运行提升。从阅读其他帖子运行提升与管理员不同，这可能是问题所在。

无论如何，问题是：在Visual Studio中没有产生错误（代码运行良好）来添加密钥（我写了一个单独的应用程序来测试这个。但是密钥没有被写入——我不明白为什么？

当我将代码放入我的安装程序并运行提升时，不会抛出任何错误并且密钥也没有写入 - 至少如果它出错并回滚安装......

我确实尝试为当前用户设置密钥，并且效果很好，但对我没有用....

我还创建了一个本地用户，该用户是管理员的成员，并且也没有访问权限。

总结一下我想弄清楚的是：如何抛出注册表写入失败的错误并回滚安装（请记住，代码当前在提升的权限下不会抛出错误但实际上不起作用）

有解决这个问题的方法吗？

谢谢达摩

**C# 安装程序类代码**

```
using System;
using System.Diagnostics;
using System.Windows.Forms;
using System.Collections;
using System.ComponentModel;
using System.Configuration.Install;
using System.Reflection;
using System.IO;
using Microsoft.Win32;

namespace OffLine.Installer
{
    // Taken from:http://msdn2.microsoft.com/en-us/library/
    // system.configuration.configurationmanager.aspx
    // Set 'RunInstaller' attribute to true.

    [RunInstaller(true)]
    public class InstallerClass : System.Configuration.Install.Installer
    {
        public InstallerClass()
            : base()
        {
            // Attach the 'Committed' event.
            this.Committed += new InstallEventHandler(MyInstaller_Committed);
            // Attach the 'Committing' event.
            this.Committing += new InstallEventHandler(MyInstaller_Committing);
        }

        // Event handler for 'Committing' event.
        private void MyInstaller_Committing(object sender, InstallEventArgs e)
        {
            // **** Beta Only **** Set program to autostart
            try
            {

                RegistryKey add = Registry.LocalMachine.OpenSubKey("SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run", true);

                add.SetValue("FactoryAuditEventNotification", "\"" + Application.ExecutablePath.ToString() + "\"");

            }
            catch (Exception ex)
            {
                MessageBox.Show(ex.Message.ToString());             

            }

        }

        // Event handler for 'Committed' event.
        private void MyInstaller_Committed(object sender, InstallEventArgs e)
        {
            try
            {
                Directory.SetCurrentDirectory(Path.GetDirectoryName
                (Assembly.GetExecutingAssembly().Location));
                Process.Start(Path.GetDirectoryName(
                  Assembly.GetExecutingAssembly().Location) + "\\FactoryAuditEventNotification.exe");
             }
            catch 
            {
                // Do nothing... 

            }
        }

        // Override the 'Install' method.
        public override void Install(IDictionary savedState)
        {
            base.Install(savedState);
        }

        // Override the 'Commit' method.
        public override void Commit(IDictionary savedState)
        {
            base.Commit(savedState);
        }

        // Override the 'Rollback' method.
        public override void Rollback(IDictionary savedState)
        {
            base.Rollback(savedState);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T18:40:27.707

我想这是你的情况
[在 C# 中添加注册表项显示当我读回它时，但不是在 regedit](https://stackoverflow.com/questions/1541053/adding-registry-key-in-c-sharp-shows-when-i-read-it-back-but-not-in-regedit)

**如何确认**
如评论中所建议，使用 ProcMon util 并且在重定向的情况下关键读/写操作的结果将是**REPARSE**。

# ios - 这个核心情节代码在 iphone 上运行，但在 ipad 上不运行

> ID：14082632
> 
> 赞同：0
> 
> 时间：2012-12-29T14:35:06.593
> 
> 标签：ios, ios5, charts, ios6, core-plot

此核心情节创建自：[http](http://codejunkster.wordpress.com/2011/11/23/core-plot-2-bar-plot/#comment-85) ://codejunkster.wordpress.com/2011/11/23/core-plot-2-bar-plot/#comment-85 。我用相同的代码创建了 2 个应用程序，一个用于 iPhone，另一个用于 iPad。iphone 应用程序运行良好，但 ipad 应用程序显示 x 坐标和 y 坐标以及标题而不是列我不知道如何修复它。请帮助我。这将是一个很大的帮助。使用 Xcode 4.5.2 ios6。在此先感谢。

BarPlotViewController.h

```
#import <UIKit/UIKit.h>
#import "CorePlot-CocoaTouch.h"

@interface BarPlotViewController : UIViewController
<CPTBarPlotDataSource, CPTBarPlotDelegate>

@property (nonatomic, retain) NSMutableArray *data;
@property (nonatomic, retain) CPTGraphHostingView *hostingView;
@property (nonatomic, retain) CPTXYGraph *graph;

- (void) generateBarPlot;

@end 
```

BarPlotViewController.m

```
#import "BarPlotViewController.h"

@interface BarPlotViewController ()

@end

@implementation BarPlotViewController

#define BAR_POSITION @"POSITION"
#define BAR_HEIGHT @"HEIGHT"
#define COLOR @"COLOR"
#define CATEGORY @"CATEGORY"

#define AXIS_START 0
#define AXIS_END 50

@synthesize data;
@synthesize graph;
@synthesize hostingView;

- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
    if (self) {

        self.data = [NSMutableArray array];

        int bar_heights[] = {20,30,10,40};
        UIColor *colors[] = {
            [UIColor redColor],
            [UIColor blueColor],
            [UIColor orangeColor],
            [UIColor purpleColor]};
        NSString *categories[] = {@"Plain Milk", @"Milk + Caramel", @"White", @"Dark"};

        for (int i = 0; i < 4 ; i++){
            double position = i*10; //Bars will be 10 pts away from each other
            double height = bar_heights[i];

            NSDictionary *bar = [NSDictionary dictionaryWithObjectsAndKeys:
                                 [NSNumber numberWithDouble:position],BAR_POSITION,
                                 [NSNumber numberWithDouble:height],BAR_HEIGHT,
                                 colors[i],COLOR,
                                 categories[i],CATEGORY,
                                 nil];
            [self.data addObject:bar];

        }
        [self generateBarPlot];
    }
    return self;
}

- (void)generateBarPlot
{
    //Create host view
    self.hostingView = [[CPTGraphHostingView alloc]
                        initWithFrame:[[UIScreen mainScreen]bounds]];
    [self.view addSubview:self.hostingView];

    //Create graph and set it as host view's graph
    self.graph = [[CPTXYGraph alloc] initWithFrame:self.hostingView.bounds];
    [self.hostingView setHostedGraph:self.graph];

    //set graph padding and theme
    self.graph.plotAreaFrame.paddingTop = 20.0f;
    self.graph.plotAreaFrame.paddingRight = 20.0f;
    self.graph.plotAreaFrame.paddingBottom = 70.0f;
    self.graph.plotAreaFrame.paddingLeft = 70.0f;
    [self.graph applyTheme:[CPTTheme themeNamed:kCPTDarkGradientTheme]];

    //set axes ranges
    CPTXYPlotSpace *plotSpace = (CPTXYPlotSpace *)self.graph.defaultPlotSpace;
    plotSpace.xRange = [CPTPlotRange plotRangeWithLocation:
                        CPTDecimalFromFloat(AXIS_START)
                                                    length:CPTDecimalFromFloat((AXIS_END - AXIS_START)+5)];
    plotSpace.yRange = [CPTPlotRange plotRangeWithLocation:
                        CPTDecimalFromFloat(AXIS_START)
                                                    length:CPTDecimalFromFloat((AXIS_END - AXIS_START)+5)];

    CPTXYAxisSet *axisSet = (CPTXYAxisSet *)self.graph.axisSet;
    //set axes' title, labels and their text styles
    CPTMutableTextStyle *textStyle = [CPTMutableTextStyle textStyle];
    textStyle.fontName = @"Helvetica";
    textStyle.fontSize = 14;
    textStyle.color = [CPTColor whiteColor];
    axisSet.xAxis.title = @"CHOCOLATE";
    axisSet.yAxis.title = @"AWESOMENESS";
    axisSet.xAxis.titleTextStyle = textStyle;
    axisSet.yAxis.titleTextStyle = textStyle;
    axisSet.xAxis.titleOffset = 30.0f;
    axisSet.yAxis.titleOffset = 40.0f;
    axisSet.xAxis.labelTextStyle = textStyle;
    axisSet.xAxis.labelOffset = 3.0f;
    axisSet.yAxis.labelTextStyle = textStyle;
    axisSet.yAxis.labelOffset = 3.0f;
    //set axes' line styles and interval ticks
    CPTMutableLineStyle *lineStyle = [CPTMutableLineStyle lineStyle];
    lineStyle.lineColor = [CPTColor whiteColor];
    lineStyle.lineWidth = 3.0f;
    axisSet.xAxis.axisLineStyle = lineStyle;
    axisSet.yAxis.axisLineStyle = lineStyle;
    axisSet.xAxis.majorTickLineStyle = lineStyle;
    axisSet.yAxis.majorTickLineStyle = lineStyle;
    axisSet.xAxis.majorIntervalLength = CPTDecimalFromFloat(5.0f);
    axisSet.yAxis.majorIntervalLength = CPTDecimalFromFloat(5.0f);
    axisSet.xAxis.majorTickLength = 7.0f;
    axisSet.yAxis.majorTickLength = 7.0f;
    axisSet.xAxis.minorTickLineStyle = lineStyle;
    axisSet.yAxis.minorTickLineStyle = lineStyle;
    axisSet.xAxis.minorTicksPerInterval = 1;
    axisSet.yAxis.minorTicksPerInterval = 1;
    axisSet.xAxis.minorTickLength = 5.0f;
    axisSet.yAxis.minorTickLength = 5.0f;

    // Create bar plot and add it to the graph
    CPTBarPlot *plot = [[CPTBarPlot alloc] init] ;
    plot.dataSource = self;
    plot.delegate = self;
    plot.barWidth = [[NSDecimalNumber decimalNumberWithString:@"5.0"]
                     decimalValue];
    plot.barOffset = [[NSDecimalNumber decimalNumberWithString:@"10.0"]
                      decimalValue];
    plot.barCornerRadius = 5.0;
    // Remove bar outlines
    CPTMutableLineStyle *borderLineStyle = [CPTMutableLineStyle lineStyle];
    borderLineStyle.lineColor = [CPTColor clearColor];
    plot.lineStyle = borderLineStyle;
    // Identifiers are handy if you want multiple plots in one graph
    plot.identifier = @"chocoplot";
    [self.graph addPlot:plot];

}

-(NSUInteger)numberOfRecordsForPlot:(CPTPlot *)plot
{
    if ( [plot.identifier isEqual:@"chocoplot"] )
        return [self.data count];

    return 0;
}

-(CPTLayer *)dataLabelForPlot:(CPTPlot *)plot recordIndex:(NSUInteger)index
{
    if ( [plot.identifier isEqual: @"chocoplot"] )
    {
        CPTMutableTextStyle *textStyle = [CPTMutableTextStyle textStyle];
        textStyle.fontName = @"Helvetica";
        textStyle.fontSize = 14;
        textStyle.color = [CPTColor whiteColor];

        NSDictionary *bar = [self.data objectAtIndex:index];
        CPTTextLayer *label = [[CPTTextLayer alloc] initWithText:[NSString stringWithFormat:@"%@", [bar valueForKey:@"CATEGORY"]]];
        label.textStyle =textStyle;

        return label;
    }

    CPTTextLayer *defaultLabel = [[CPTTextLayer alloc] initWithText:@"Label"];
    return defaultLabel;

}

-(CPTFill *)barFillForBarPlot:(CPTBarPlot *)barPlot
                  recordIndex:(NSUInteger)index
{
    if ( [barPlot.identifier isEqual:@"chocoplot"] )
    {
        NSDictionary *bar = [self.data objectAtIndex:index];
        CPTGradient *gradient = [CPTGradient gradientWithBeginningColor:[CPTColor whiteColor]
                                                            endingColor:[bar valueForKey:@"COLOR"]
                                                      beginningPosition:0.0 endingPosition:0.3 ];
        [gradient setGradientType:CPTGradientTypeAxial];
        [gradient setAngle:320.0];

        CPTFill *fill = [CPTFill fillWithGradient:gradient];

        return fill;

    }
    return [CPTFill fillWithColor:[CPTColor colorWithComponentRed:1.0 green:1.0 blue:1.0 alpha:1.0]];

}

- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view from its nib.
}

- (void)didReceiveMemoryWarning
{
    [super didReceiveMemoryWarning];
    // Dispose of any resources that can be recreated.
}

@end 
```

AppDelegate.h

```
#import <UIKit/UIKit.h>
#import "BarPlotViewController.h"

@interface AppDelegate : UIResponder <UIApplicationDelegate>

@property (strong, nonatomic) UIWindow *window;
@property (strong, nonatomic) BarPlotViewController *barPlotViewController;

@end 
```

AppDelegate.m

```
#import "AppDelegate.h"

@implementation AppDelegate

@synthesize window = _window;
@synthesize barPlotViewController;

- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    self.window = [[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]];
    // Override point for customization after application launch.
    self.window.backgroundColor = [UIColor whiteColor];

    barPlotViewController = [[BarPlotViewController alloc] init];
    [self.window setRootViewController:barPlotViewController];
    [self.window makeKeyAndVisible];
    return YES;
}
@end 
```

Ipad 上的模拟器图片： ![在此处输入图像描述](../Images/ce93c47c041260905749f448279b4e0f.png)

这是它在 iphone 相同代码上的外观：![在此处输入图像描述](../Images/dd4eab7a39d1b232c3a71f3e92410a77.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T17:23:37.290

您的数据源需要实现以下方法之一：

```
-(NSArray *)numbersForPlot:(CPTPlot *)plot
                     field:(NSUInteger)fieldEnum
          recordIndexRange:(NSRange)indexRange;

-(NSNumber *)numberForPlot:(CPTPlot *)plot
                     field:(NSUInteger)fieldEnum
               recordIndex:(NSUInteger)idx;

-(double *)doublesForPlot:(CPTPlot *)plot
                    field:(NSUInteger)fieldEnum
         recordIndexRange:(NSRange)indexRange;

-(double)doubleForPlot:(CPTPlot *)plot
                 field:(NSUInteger)fieldEnum
           recordIndex:(NSUInteger)idx;

-(CPTNumericData *)dataForPlot:(CPTPlot *)plot
                         field:(NSUInteger)fieldEnum
              recordIndexRange:(NSRange)indexRange;

-(CPTNumericData *)dataForPlot:(CPTPlot *)plot
              recordIndexRange:(NSRange)indexRange; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T20:04:40.693

我已将所有设置更改为 iPad，除了目标 --> 设备 --> iPad 。然后它开始工作。这是有史以来最严重的错误，也是对时间的严重浪费。

# if-statement - if(x==10 || x==12) 的语法糖，为什么不呢？

> ID：14082633
> 
> 赞同：0
> 
> 时间：2012-12-29T14:35:09.810
> 
> 标签：if-statement

我最近看到[了这个](https://stackoverflow.com/questions/14082446/if-x-071421-7-14-y-thursday/14082462#14082462)问题。其中包含（我相信是）一个非常常见的早期程序员写作错误，`if(x==10 || 12)`当你的意思是`if(x==10 || x==12)`这让我想知道。为什么（据我所知）没有对此的支持`if(x==10 || 12)`看似更自然的语法，或者至少不支持一些类似的语法。所以我的问题是：

1）在任何更常见的语言（c、c++、java、c#）中，这种表达式是否存在某种语法糖/宏扩展/速记。如果不是，为什么不呢？

2）有没有办法使用java和eclipse来添加它（作为编译器宏扩展或任何其他可用的解决方案）？

编辑：澄清，我并不是说我希望改变`if(x==10 || 12)`. 我一直在寻找比它更短`if(x==10 || x==12)`但在功能上等效的语法糖。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T14:50:12.153

`if (x == 10 || 12)`那是因为完全按照它的书面解释更有意义。那就是“如果 x 等于 10，或者 12 是真的”。如果您想完成某件事，请明确地写出来。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T14:53:21.003

您可以在支持数组或集合的紧凑表示的语言中使用数组或集合查找。

Javascript（以及 PHP 和 Java）具有数组文字：

```
if( [10,12].indexOf(x) != -1) ... 
```

您还可以使用按位否定作为以下的快捷方式`!=-1`：

```
if(~[10,12].indexOf(x)) ... 
```

Php 5.4 也有数组文字，你可以在没有 5.5 的临时变量的情况下使用它们（我认为）。这也应该是超线性的，但是会生成通知，除非您使用`@`or `in_array`：

```
if(@[10=>true, 12=>true][$x]) ... 
```

正则表达式查找也是支持紧凑正则表达式语法并且您正在匹配字符串的语言中的一个选项。这样做的好处是可能比数组搜索更快：

```
if(/^(10|12)$/.test(x)) ... 
```

还建议了一个开关：

```
switch(x){
  case 10:
  case 12:
    ...
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-29T14:38:08.567

您可以在 C# 中使用带有对接 case 语句的 switch case。你不能过多地使用 ifs，因为你会破坏更多的合法案例并降低可读性。它将是语法盐而不是糖。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-29T15:02:41.863

如果允许，您将如何编写这样的条件：

```
if( x == a || b ) 
```

哪里`x`和`a`是字符或整数，`b`可以是`true`或`false`？

例如：

```
x = 'a';
b = true;

// later in the program
if( x == 'c' || b ) 
```

# jenkins - 使 URL 成为 Hudson 构建的结果

> ID：14082635
> 
> 赞同：15
> 
> 时间：2012-12-29T14:35:16.287
> 
> 标签：jenkins, hudson

我有一个将结果上传到某个 URL 的构建作业。

如何在构建页面上显示指向该 URL 的链接？

我试图创建一个带有重定向的 html 页面并将其添加到工件中，但这似乎有点奇怪。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-01-02T16:48:42.790

每个作业运行？还是整个工作的全球性？

如果您的链接始终是静态的（例如：仅最新的工件），您可以使用侧边栏链接插件。[https://wiki.jenkins-ci.org/display/JENKINS/Sidebar-Link+Plugin](https://wiki.jenkins-ci.org/display/JENKINS/Sidebar-Link+Plugin)将为每个作业放置一个静态链接（适用于所有运行）。

如果您的链接每次运行都发生变化，这就是我在我的环境中所做的。`<a href>`我用标签更新了运行的描述。该链接不会显示在运行页面上，但它在构建历史记录中工作得相当好。

![在此处输入图像描述](../Images/cbdf2af3bcc84f52b7a61486dced22ac.png)
请注意，`[Debug]`和`[Release]`是每个特定构建的唯一链接。

为此，您需要 Description Setter 插件。[https://wiki.jenkins-ci.org/display/JENKINS/Description+Setter+Plugin](https://wiki.jenkins-ci.org/display/JENKINS/Description+Setter+Plugin)。而在插件中（它是构建后操作），只需编写纯 HTML。您可以在那里使用常用的环境变量

```
<a href="http://whatever/${BUILD_NUMBER}">Link here</a> 
```

编辑：请注意，现在将 html 放入构建历史描述中并不是那么容易（如果可能的话）。它确实适用于单个构建页面。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2018-01-21T07:21:31.333

如果您希望这样对待标记，则必须启用它：Manage Jenkins > Global Security > Markup Formatter = Safe HTML

然后，对于 Jenkins 脚本化管道，您可以简单地`currentBuild.description`使用一些 HTML 设置属性。例子：

```
currentBuild.description = "Click <a href='http://yourlink'>here</a>" 
```

呈现的 HTML 将显示在构建历史记录和构建页面上。

如果您在 Markup Formatter 下拉菜单中没有看到“Safe HTML”，您可能需要安装 OWASP Markup Formatter 插件。

在撰写本文时，Blue Ocean GUI 不会显示构建描述的 HTML。在此处查看问题：[https ://issues.jenkins.io/browse/JENKINS-45719](https://issues.jenkins.io/browse/JENKINS-45719)

这个 Chrome 扩展可以作为一种解决方法： [https ://chrome.google.com/webstore/detail/blue-ocean-description-ht/maahpenodjcdhodbonmdkfgnceddigae](https://chrome.google.com/webstore/detail/blue-ocean-description-ht/maahpenodjcdhodbonmdkfgnceddigae)

# emacs - windmove 是否支持环绕 Emacs 中的导航？

> ID：14082636
> 
> 赞同：3
> 
> 时间：2012-12-29T14:35:19.167
> 
> 标签：emacs

我正在使用windmove在窗口之间切换。默认情况下，windmove 不会环绕，例如，`windmove-up`当您已经在窗口顶部时，它会失败。但是，我希望它环绕并导航到底部窗口。

我设法让它工作，但解决方案是一个相当黑客（如果有错误只需反转方向并继续直到它再次失败）：

```
(define-key my-keys-minor-mode-map (kbd "C-M-k") (lambda () (interactive)
                            (unless
                                (ignore-errors (windmove-up))
                                (while (ignore-errors (windmove-down)) ())))) 
```

有没有更优雅的解决方案？windmove 是否提供了一种简单的方法来做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T16:31:33.637

```
M-x customize-variable RET windmove-wrap-around RET 
```

是这样吗？该变量基本上位于`windmove.el`.

如果不想打开源文件，

```
M-x customize-group RET windmove RET 
```

将向您显示属于此模式的所有可自定义变量。两个都。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T17:26:39.673

对于更改窗口，您可能想尝试[这个](https://github.com/dimitri/switch-window/blob/master/switch-window.el)包：

`switch-window`：调用时，它允许您从选项​​中选择一个窗口（它覆盖从 1 到窗口上的窗口数量的数字选择）。选择一个数字将切换到相关窗口。

这可能更容易用于窗口导航目的。至于您回答的直接问题，我确实会以类似的方式对其进行编程，尽管我也认为有一个更合适的答案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-29T18:19:30.733

将此添加到您的`.emacs`文件中：

```
(setq windmove-wrap-around t) 
```

# c++ - 在 C++ 中解析 JSON 数组

> ID：14082643
> 
> 赞同：1
> 
> 时间：2012-12-29T14:35:54.287
> 
> 标签：c++, arrays, json, parsing

我正在编写一个服务器客户端程序。服务器是用 C++ 编写的，我使用 JSON 字符串来发送数据。[这个库](http://code.google.com/p/jsonplus/)对我有很大帮助，而且一切正常，但我有一个问题：如何将 JSON 字符串数组解析为普通的 C++ 数组？我在文档中搜索了方法，但没有找到任何方法。我必须编写自己的函数吗？

例如，`s`JSON 字符串在哪里`{"msg":"message", "content":["content1", "content2"]}`：

```
CJsonObject *obj = CJsonParser::Execute(s); 
string msg = (*obj)["msg"]->ToString();
string content = (*obj)["content"]->ToString();
cout << msg << endl; // message
cout << content << endl; // ["content1", "content2"] 
```

但我想要一个“content1”、“content2”的数组/向量。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T14:58:33.010

它看起来像`CJsonObject::operator[]`返回一个`const CJsonValue*`可能指向具有动态类型的对象`CJsonArray`。即`(*obj)["content"]`返回指向类型对象的指针`CJsonArray`。你可以做一个`dynamic_cast<CJsonArray*>`来确定。

`CJsonArray`有一个被调用的成员函数`GetValue`，它接受一个`std::vector<CJsonValue*>`引用并用数组中的值填充它。

因此，您可以执行以下操作（未经测试）：

```
if (auto array = dynamic_cast<const CJsonArray*>((*obj)["content"])) {
  std::vector<CJsonValue*> vec;
  array->GetValue(vec);
  for (auto& value : vec) {
    std::cout << value->ToString() << std::endl;
  }
} 
```

或 C++03 等价物：

```
if (const CJsonArray* array = dynamic_cast<const CJsonArray*>((*obj)["content"])) {
  typedef std::vector<CJsonValue*> ValueVector;
  ValueVector vec;
  array->GetValue(vec);
  for (ValueVector::iterator it = vec.begin(); it != vec.end(); it++) {
    std::cout << (*it)->ToString() << std::endl;
  }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T14:59:10.120

您可以检查 Json 对象的真实类型并使用强制转换来检索`CJsonArray`对象。

在动态转换之后，您的对象结果是一个`CJsonArray`，它有一个方法：`getValue`.

```
if (content.getType() == JV_ARRAY) {
  std::vector <CJsonValue*> values;

  (dynamic_cast<CJsonArray*>(content))->getValue(values);

} 
```

`value`向量包含，因此`CJsonValue`您可以`ToString()`用于每个元素。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T14:49:09.993

为此目的使用 boost::spirit 可能是一个可行的选择。JSON 是一个很容易解析的东西，你将能够通过与 boost::phoenix 的交互来填充你的数组。

# sql - 列出两个文件之间的重复项并删除

> ID：14082659
> 
> 赞同：1
> 
> 时间：2012-12-29T14:37:43.367
> 
> 标签：sql, sql-server-2008

使用 SQL Server 2008 并将两个文件导入到一个表中。第一个文件 (2048) 有 6,721 行，第二个文件有 (2209) 4,707 行，列是：`Billed, FirstName, LastName, FileID`. 表称为`Claims`。

需要查询以列出每个`FileId`（2209 和 2048）显示每个文件中的重复项，并从其中一个文件中删除重复项。

运行此查询：

```
SELECT firstname
, lastname
, duplicatecount = COUNT(1)
FROM Claims
WHERE fileid IN (2209, 2048)
GROUP BY
firstname
, lastname
HAVING COUNT(1) > 1
ORDER BY COUNT(1) DESC 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T14:43:37.420

这将为您提供每个文件中的重复项，

```
SELECT firstname , lastname , count(*) as duplicatecount 
FROM Claims WHERE fileid IN (2209, 2048) 
GROUP BY firstname , lastname HAVING COUNT(*) > 1 
ORDER BY 1,2 DESC 
```

试试这个

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T15:19:23.503

你可以尝试这样的事情：

```
WITH counted_and_marked AS (
  SELECT
    *
    rnk = ROW_NUMBER() OVER (PARTITION BY firstname, lastname ORDER BY fileid)
  FROM Claims
  WHERE fileid IN (2209, 2048)
)
DELETE FROM marked_and_counted
WHERE rnk > 1
; 
```

公用表表达式只是从中`marked_and_counted`检索所有行，按 的顺序`Claims`独立排列每个的重复项。然后，DELETE 语句只删除排名大于 1 的行。`(firstname, lastname)``fileid`

您可以看到 DELETE 直接以 CTE 为目标，这在本例中是允许的，因为 CTE 仅引用一个表。

此查询适用于任意数量的文件。它将删除所有重复项，每个`(firstname, lastname)`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T15:44:51.520

这些是重复的。所以从你的查询开始：

```
with todelete as (<your query here>)
delete from Claims
    from todelete
    where todelete.firstname = claims.firstname and
          todelete.lastname = claims.lastname and
          fileid = 2209 
```

您要删除*重复*值，而不是全部，因此您需要指定要删除的值。我随意选择了2209。

# java - Bukkit - 无法启动 runTaskTimerAsynchronously();

> ID：14082660
> 
> 赞同：1
> 
> 时间：2012-12-29T14:37:46.333
> 
> 标签：java, plugins, timer, minecraft, bukkit

我正在创建一个 bukkit 插件，但每隔几分钟发送一条消息时遇到问题。它曾经可以工作，但我现在使用的是 bukkit 1.4.6 测试版，但事实并非如此。以前的方法已被弃用，但它给了我同样的错误，所以我决定切换到它的替代品，但没有运气。

这是我的代码：

```
Bukkit.getServer().getScheduler().runTaskTimerAsynchronously((Plugin) this, new Runnable() {
    public void run() {
        Bukkit.broadcastMessage(ChatColor.DARK_PURPLE + "" + ChatColor.MAGIC + "aaaaaa" + ChatColor.RESET + "    Important    " + ChatColor.DARK_PURPLE + "" + ChatColor.MAGIC + "aaaaaa" + ChatColor.RESET + ":");
        Bukkit.broadcastMessage("");
        Bukkit.broadcastMessage("  Hacks are stricly prohibited. A list of approved mods is available on our website. Use of mods not approved by the arenacraft team may lead to a permanent ban.");
    }}, 60L, 36000L);
} 
```

我正在使用[它](http://jd.bukkit.org/doxygen/df/dfa/interfaceorg_1_1bukkit_1_1scheduler_1_1BukkitScheduler.html#a08981807328a2291346884e6ab773212)。

控制台给了我以下信息：

```
me.silvershad0wz.arenacraft.Notices (the class this code is from) Cannot be cast to org.bukkit.plugin.Plugin. 
```

随之而来的是许多错误。源于此

```
Bukkit.getServer().getScheduler().runTaskTimerAsynchronously((Plugin) this, new Runnable() { 
```

线。

感谢您提供任何帮助，因为我不知道“无法转换为”错误是什么意思。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T19:26:58.160

您是否从扩展 JavaPlugin 的主类调用调度程序？如果你不是，那么你将不得不通过更改它所说的位置来获取插件的`(Plugin) this`实例`Bukkit.getServer().getPluginManager().getPlugin("YOUR_PLUGIN_NAME")`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-03T23:18:27.410

您的插件的主类扩展了 JavaPlugin，而不是 Plugin。:)

我认为只是改变

```
.runTaskTimerAsynchronously((Plugin) this, new Runnable() 
```

到

```
.runTaskTimerAsynchronously((JavaPlugin) this, new Runnable() 
```

会工作，甚至

```
.runTaskTimerAsynchronously(this, new Runnable() 
```

**如果**在您的主类中调用它。

来源：[http ://wiki.bukkit.org/Plugin_Tutorial#Creating_the_Plugin.27s_Class](http://wiki.bukkit.org/Plugin_Tutorial#Creating_the_Plugin.27s_Class)

# ruby - 来自文件数组的 stub_request 链 to_return

> ID：14082663
> 
> 赞同：0
> 
> 时间：2012-12-29T14:38:01.503
> 
> 标签：ruby, rspec2, webmock

我有一个使用 web_mock 的 raw_responses 数组，我想将它们*用作***to_return**方法的参数并链接到**stub_request**方法：

```
#["file1.txt", "subfolder/file_n.txt", "awsome_name.txt"]
rr = Dir.glob(File.expand_path("../../markups/*.txt", __FILE__))
stub_request(:get, "www.google.de").to_return(rr[0]).to_return(rr[1]).to_return(rr[2]) 
```

如何使用枚举器或类似 tap 的东西重写最后一个字符串以使用*rr*的所有数组？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T14:47:40.803

如[README](https://github.com/bblimke/webmock#multiple-responses-for-repeated-requests)中所述，您只需将多个响应`to_return`作为参数传递给方法。基本上你想要这样的东西：

```
stub_request(:get, "www.google.de").to_return(rr[0], rr[1], rr[2]) 
```

但是像这样列出数组值有点笨拙（并且不适用于可变数量的响应），因此您应该改用 Ruby 的 splat 运算符：

```
responses = Dir[File.expand_path("../../markups/*.txt", __FILE__)].map{|f| File.read(f)}
stub_request(:get, "www.google.de").to_return(*responses) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T14:48:00.480

最后我这样做了

```
stub = stub_request(:get, "www.google.de")
rr.each { |rf| stub.tap { |s| s.to_return(File.new(rf)) } } 
```

# c++ - 错误构建简单的 MongoDB C++ 客户端示例

> ID：14082666
> 
> 赞同：2
> 
> 时间：2012-12-29T14:38:13.817
> 
> 标签：c++, mongodb

我已经在 ubuntu 12.10 上安装了 MongoDB，在 mongo shell 上进行了测试，它工作正常。

[然后，我从http://dl.mongodb.org/dl/cxx-driver/](http://dl.mongodb.org/dl/cxx-driver/)安装了 cxx-driver

这是我正在尝试构建的 MongoDB 客户端示例：

```
#include <cstdlib>
#include <iostream>
#include "mongo/bson/bsonobjbuilder.h"
#include "mongo/client/dbclient.h"
#include "mongo/client/dbclientcursor.h"
#include <boost/shared_ptr.hpp>

using namespace mongo;

void run() {
  DBClientConnection c;
  c.connect("localhost");
boost::shared_ptr<DBClientCursor> cursor =
    c.query("test", BSONObj());
  while (cursor->more())
      std::cout << cursor->next().toString() << std::endl;
}

int main() {
  try {
    run();
    std::cout << "connected ok" << std::endl;
  } catch( const DBException &e ) {
    std::cout << "caught " << e.what() << std::endl;
  }
  return EXIT_SUCCESS;
} 
```

但这失败并出现此错误：

```
In file included from /home/lurscher/third_party/usr/local/include/mongo/bson/oid.h:22:0,
                 from /home/lurscher/third_party/usr/local/include/mongo/bson/bsonelement.h:25,
                 from /home/lurscher/third_party/usr/local/include/mongo/bson/bsonobjbuilder.h:29,
                 from test_mongo.cpp:3:
/home/lurscher/third_party/usr/local/include/mongo/bson/util/misc.h: In member function ‘time_t mongo::Date_t::toTimeT() const’:
/home/lurscher/third_party/usr/local/include/mongo/bson/util/misc.h:96:42: error: ‘verify’ was not declared in this scope
In file included from /home/lurscher/third_party/usr/local/include/mongo/util/hex.h:22:0,
                 from /home/lurscher/third_party/usr/local/include/mongo/bson/oid.h:23,
                 from /home/lurscher/third_party/usr/local/include/mongo/bson/bsonelement.h:25,
                 from /home/lurscher/third_party/usr/local/include/mongo/bson/bsonobjbuilder.h:29,
                 from test_mongo.cpp:3:
/home/lurscher/third_party/usr/local/include/mongo/bson/util/builder.h: In member function ‘void mongo::StringBuilderImpl<Allocator>::appendDoubleNice(double)’:
/home/lurscher/third_party/usr/local/include/mongo/bson/util/builder.h:302:28: error: there are no arguments to ‘verify’ that depend on a template parameter, so a declaration of ‘verify’ must be available [-fpermissive]
/home/lurscher/third_party/usr/local/include/mongo/bson/util/builder.h:302:28: note: (if you use ‘-fpermissive’, G++ will accept your code, but allowing the use of an undeclared name is deprecated)
/home/lurscher/third_party/usr/local/include/mongo/bson/util/builder.h:303:33: error: there are no arguments to ‘verify’ that depend on a template parameter, so a declaration of ‘verify’ must be available [-fpermissive]
/home/lurscher/third_party/usr/local/include/mongo/bson/util/builder.h: In member function ‘mongo::StringBuilderImpl<Allocator>& mongo::StringBuilderImpl<Allocator>::SBNUM(T, int, const char*)’:
/home/lurscher/third_party/usr/local/include/mongo/bson/util/builder.h:336:28: error: there are no arguments to ‘verify’ that depend on a template parameter, so a declaration of ‘verify’ must be available [-fpermissive]
/home/lurscher/third_party/usr/local/include/mongo/bson/util/builder.h:337:33: error: there are no arguments to ‘verify’ that depend on a template parameter, so a declaration of ‘verify’ must be available [-fpermissive]
In file included from /home/lurscher/third_party/usr/local/include/mongo/bson/oid.h:23:0,
                 from /home/lurscher/third_party/usr/local/include/mongo/bson/bsonelement.h:25,
                 from /home/lurscher/third_party/usr/local/include/mongo/bson/bsonobjbuilder.h:29,
                 from test_mongo.cpp:3:
/home/lurscher/third_party/usr/local/include/mongo/util/hex.h: In function ‘int mongo::fromHex(char)’:
/home/lurscher/third_party/usr/local/include/mongo/util/hex.h:33:23: error: ‘verify’ was not declared in this scope
In file included from /home/lurscher/third_party/usr/local/include/mongo/bson/bsonobjbuilder.h:29:0,
                 from test_mongo.cpp:3:
/home/lurscher/third_party/usr/local/include/mongo/bson/bsonelement.h: In member function ‘const char* mongo::BSONElement::codeWScopeCode() const’:
/home/lurscher/third_party/usr/local/include/mongo/bson/bsonelement.h:265:70: error: ‘massert’ was not declared in this scope
/home/lurscher/third_party/usr/local/include/mongo/bson/bsonelement.h: In member function ‘int mongo::BSONElement::codeWScopeCodeLen() const’:
/home/lurscher/third_party/usr/local/include/mongo/bson/bsonelement.h:272:70: error: ‘massert’ was not declared in this scope
/home/lurscher/third_party/usr/local/include/mongo/bson/bsonelement.h: In member function ‘const char* mongo::BSONElement::binData(int&) const’:
/home/lurscher/third_party/usr/local/include/mongo/bson/bsonelement.h:309:39: error: ‘verify’ was not declared in this scope
/home/lurscher/third_party/usr/local/include/mongo/bson/bsonelement.h: In member function ‘mongo::BinDataType mongo::BSONElement::binDataType() const’:
/home/lurscher/third_party/usr/local/include/mongo/bson/bsonelement.h:328:39: error: ‘verify’ was not declared in this scope
/home/lurscher/third_party/usr/local/include/mongo/bson/bsonelement.h: In member function ‘const char* mongo::BSONElement::regex() const’:
/home/lurscher/third_party/usr/local/include/mongo/bson/bsonelement.h:335:35: error: ‘verify’ was not declared in this scope
/home/lurscher/third_party/usr/local/include/mongo/bson/bsonelement.h: In member function ‘const char* mongo::BSONElement::dbrefNS() const’:
/home/lurscher/third_party/usr/local/include/mongo/bson/bsonelement.h:409:63: error: ‘uassert’ was not declared in this scope
/home/lurscher/third_party/usr/local/include/mongo/bson/bsonelement.h: In member function ‘const mongo::OID& mongo::BSONElement::dbrefOID() const’:
/home/lurscher/third_party/usr/local/include/mongo/bson/bsonelement.h:414:63: error: ‘uassert’ was not declared in this scope
/home/lurscher/third_party/usr/local/include/mongo/bson/bsonelement.h: In constructor ‘mongo::BSONElement::BSONElement(const char*, int)’:
/home/lurscher/third_party/usr/local/include/mongo/bson/bsonelement.h:439:72: error: ‘uassert’ was not declared in this scope
/home/lurscher/third_party/usr/local/include/mongo/bson/bsonelement.h: In member function ‘const mongo::BSONElement& mongo::BSONElement::chk(bool) const’:
/home/lurscher/third_party/usr/local/include/mongo/bson/bsonelement.h:477:83: error: ‘massert’ was not declared in this scope
/home/lurscher/third_party/usr/local/include/mongo/bson/bsonelement.h: In member function ‘int mongo::BSONElement::canonicalType() const’:
/home/lurscher/third_party/usr/local/include/mongo/bson/bsonelement.h:522:21: error: ‘verify’ was not declared in this scope
In file included from /home/lurscher/third_party/usr/local/include/mongo/bson/bsonobjbuilder.h:30:0,
                 from test_mongo.cpp:3:
/home/lurscher/third_party/usr/local/include/mongo/bson/bsonobj.h: In member function ‘void mongo::BSONObj::appendSelfToBufBuilder(mongo::BufBuilder&) const’:
/home/lurscher/third_party/usr/local/include/mongo/bson/bsonobj.h:456:31: error: ‘verify’ was not declared in this scope
In file included from /home/lurscher/third_party/usr/local/include/mongo/bson/bsonobjbuilder.h:31:0,
                 from test_mongo.cpp:3:
/home/lurscher/third_party/usr/local/include/mongo/bson/bsonmisc.h: At global scope:
/home/lurscher/third_party/usr/local/include/mongo/bson/bsonmisc.h:173:9: error: ‘auto_ptr’ in namespace ‘std’ does not name a type
/home/lurscher/third_party/usr/local/include/mongo/bson/bsonmisc.h: In member function ‘bool mongo::BSONObjBuilderValueStream::haveSubobj() const’:
/home/lurscher/third_party/usr/local/include/mongo/bson/bsonmisc.h:171:42: error: ‘_subobj’ was not declared in this scope
In file included from test_mongo.cpp:3:0:
/home/lurscher/third_party/usr/local/include/mongo/bson/bsonobjbuilder.h: In member function ‘virtual mongo::BSONObjBuilder& mongo::BSONObjBuilder::append(const mongo::BSONElement&)’:
/home/lurscher/third_party/usr/local/include/mongo/bson/bsonobjbuilder.h:124:30: error: ‘verify’ was not declared in this scope
/home/lurscher/third_party/usr/local/include/mongo/bson/bsonobjbuilder.h: In member function ‘virtual mongo::BSONObjBuilder& mongo::BSONObjBuilder::appendAs(const mongo::BSONElement&, const mongo::StringData&)’:
/home/lurscher/third_party/usr/local/include/mongo/bson/bsonobjbuilder.h:131:30: error: ‘verify’ was not declared in this scope
/home/lurscher/third_party/usr/local/include/mongo/bson/bsonobjbuilder.h: In member function ‘mongo::BSONObjBuilder& mongo::BSONObjBuilder::appendObject(const mongo::StringData&, const char*, int)’:
/home/lurscher/third_party/usr/local/include/mongo/bson/bsonobjbuilder.h:148:29: error: ‘verify’ was not declared in this scope
/home/lurscher/third_party/usr/local/include/mongo/bson/bsonobjbuilder.h: In member function ‘virtual mongo::BSONObj mongo::BSONObjBuilder::obj()’:
/home/lurscher/third_party/usr/local/include/mongo/bson/bsonobjbuilder.h:554:65: error: ‘massert’ was not declared in this scope
/home/lurscher/third_party/usr/local/include/mongo/bson/bsonobjbuilder.h: In member function ‘char* mongo::BSONObjBuilder::decouple(int&)’:
/home/lurscher/third_party/usr/local/include/mongo/bson/bsonobjbuilder.h:589:23: error: ‘verify’ was not declared in this scope
/home/lurscher/third_party/usr/local/include/mongo/bson/bsonobjbuilder.h: In member function ‘mongo::Labeler mongo::BSONObjBuilder::operator<<(const mongo::Labeler::Label&)’:
/home/lurscher/third_party/usr/local/include/mongo/bson/bsonobjbuilder.h:629:74: error: ‘massert’ was not declared in this scope
/home/lurscher/third_party/usr/local/include/mongo/bson/bsonobjbuilder.h: In member function ‘void mongo::BSONArrayBuilder::fill(int)’:
/home/lurscher/third_party/usr/local/include/mongo/bson/bsonobjbuilder.h:836:102: error: ‘uassert’ was not declared in this scope
In file included from /home/lurscher/third_party/usr/local/include/mongo/db/jsobj.h:41:0,
                 from /home/lurscher/third_party/usr/local/include/mongo/client/authentication_table.h:23,
                 from /home/lurscher/third_party/usr/local/include/mongo/client/dbclientinterface.h:26,
                 from /home/lurscher/third_party/usr/local/include/mongo/client/connpool.h:23,
                 from /home/lurscher/third_party/usr/local/include/mongo/client/dbclient.h:32,
                 from test_mongo.cpp:4:
/home/lurscher/third_party/usr/local/include/mongo/db/../bson/bson-inl.h: In member function ‘void mongo::BSONObjBuilderValueStream::endField(const char*)’:
/home/lurscher/third_party/usr/local/include/mongo/db/../bson/bson-inl.h:359:9: error: ‘_subobj’ was not declared in this scope
/home/lurscher/third_party/usr/local/include/mongo/db/../bson/bson-inl.h: In member function ‘mongo::BSONObjBuilder* mongo::BSONObjBuilderValueStream::subobj()’:
/home/lurscher/third_party/usr/local/include/mongo/db/../bson/bson-inl.h:365:13: error: ‘_subobj’ was not declared in this scope
/home/lurscher/third_party/usr/local/include/mongo/db/../bson/bson-inl.h:366:16: error: ‘_subobj’ was not declared in this scope
test_mongo.cpp: In function ‘void run()’:
test_mongo.cpp:15:28: error: conversion from ‘std::auto_ptr<mongo::DBClientCursor>’ to non-scalar type ‘boost::shared_ptr<mongo::DBClientCursor>’ requested
In file included from /home/lurscher/third_party/usr/local/include/mongo/util/hex.h:22:0,
                 from /home/lurscher/third_party/usr/local/include/mongo/bson/oid.h:23,
                 from /home/lurscher/third_party/usr/local/include/mongo/bson/bsonelement.h:25,
                 from /home/lurscher/third_party/usr/local/include/mongo/bson/bsonobjbuilder.h:29,
                 from test_mongo.cpp:3:
/home/lurscher/third_party/usr/local/include/mongo/bson/util/builder.h: In member function ‘void mongo::StringBuilderImpl<Allocator>::appendDoubleNice(double) [with Allocator = mongo::TrivialAllocator]’:
/home/lurscher/third_party/usr/local/include/mongo/db/../bson/bson-inl.h:702:42:   instantiated from here
/home/lurscher/third_party/usr/local/include/mongo/bson/util/builder.h:302:13: error: ‘verify’ was not declared in this scope
/home/lurscher/third_party/usr/local/include/mongo/bson/util/builder.h: In member function ‘mongo::StringBuilderImpl<Allocator>& mongo::StringBuilderImpl<Allocator>::SBNUM(T, int, const char*) [with T = int, Allocator = mongo::TrivialAllocator, mongo::StringBuilderImpl<Allocator> = mongo::StringBuilderImpl<mongo::TrivialAllocator>]’:
/home/lurscher/third_party/usr/local/include/mongo/bson/util/builder.h:272:53:   instantiated from ‘mongo::StringBuilderImpl<Allocator>& mongo::StringBuilderImpl<Allocator>::operator<<(int) [with Allocator = mongo::TrivialAllocator, mongo::StringBuilderImpl<Allocator> = mongo::StringBuilderImpl<mongo::TrivialAllocator>]’
/home/lurscher/third_party/usr/local/include/mongo/bson/bsonelement.h:469:64:   instantiated from here
/home/lurscher/third_party/usr/local/include/mongo/bson/util/builder.h:336:13: error: ‘verify’ was not declared in this scope
/home/lurscher/third_party/usr/local/include/mongo/bson/util/builder.h: In member function ‘mongo::StringBuilderImpl<Allocator>& mongo::StringBuilderImpl<Allocator>::SBNUM(T, int, const char*) [with T = unsigned int, Allocator = mongo::TrivialAllocator, mongo::StringBuilderImpl<Allocator> = mongo::StringBuilderImpl<mongo::TrivialAllocator>]’:
/home/lurscher/third_party/usr/local/include/mongo/bson/util/builder.h:275:53:   instantiated from ‘mongo::StringBuilderImpl<Allocator>& mongo::StringBuilderImpl<Allocator>::operator<<(unsigned int) [with Allocator = mongo::TrivialAllocator, mongo::StringBuilderImpl<Allocator> = mongo::StringBuilderImpl<mongo::TrivialAllocator>]’
/home/lurscher/third_party/usr/local/include/mongo/db/../bson/bson-inl.h:493:66:   instantiated from here
/home/lurscher/third_party/usr/local/include/mongo/bson/util/builder.h:336:13: error: ‘verify’ was not declared in this scope
/home/lurscher/third_party/usr/local/include/mongo/bson/util/builder.h: In member function ‘mongo::StringBuilderImpl<Allocator>& mongo::StringBuilderImpl<Allocator>::SBNUM(T, int, const char*) [with T = long long int, Allocator = mongo::TrivialAllocator, mongo::StringBuilderImpl<Allocator> = mongo::StringBuilderImpl<mongo::TrivialAllocator>]’:
/home/lurscher/third_party/usr/local/include/mongo/bson/util/builder.h:284:55:   instantiated from ‘mongo::StringBuilderImpl<Allocator>& mongo::StringBuilderImpl<Allocator>::operator<<(long long int) [with Allocator = mongo::TrivialAllocator, mongo::StringBuilderImpl<Allocator> = mongo::StringBuilderImpl<mongo::TrivialAllocator>]’
/home/lurscher/third_party/usr/local/include/mongo/db/../bson/bson-inl.h:693:50:   instantiated from here
/home/lurscher/third_party/usr/local/include/mongo/bson/util/builder.h:336:13: error: ‘verify’ was not declared in this scope
/home/lurscher/third_party/usr/local/include/mongo/bson/util/builder.h: In member function ‘mongo::StringBuilderImpl<Allocator>& mongo::StringBuilderImpl<Allocator>::SBNUM(T, int, const char*) [with T = long long unsigned int, Allocator = mongo::TrivialAllocator, mongo::StringBuilderImpl<Allocator> = mongo::StringBuilderImpl<mongo::TrivialAllocator>]’:
/home/lurscher/third_party/usr/local/include/mongo/bson/util/builder.h:287:55:   instantiated from ‘mongo::StringBuilderImpl<Allocator>& mongo::StringBuilderImpl<Allocator>::operator<<(long long unsigned int) [with Allocator = mongo::TrivialAllocator, mongo::StringBuilderImpl<Allocator> = mongo::StringBuilderImpl<mongo::TrivialAllocator>]’
/home/lurscher/third_party/usr/local/include/mongo/db/../bson/bson-inl.h:776:48:   instantiated from here
/home/lurscher/third_party/usr/local/include/mongo/bson/util/builder.h:336:13: error: ‘verify’ was not declared in this scope 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T15:05:08.380

尝试这个...

```
#include <cstdlib>
#include <iostream>
#include "mongo/client/dbclient.h"

using namespace mongo;

void run() {
  mongo::DBClientConnection c;
  c.connect("localhost");

  auto_ptr<DBClientCursor> cursor = c.query("test.test", BSONObj());
  while (cursor->more())
      std::cout << cursor->next().toString() << std::endl;
}

int main() {
  try {
    run();
    std::cout << "connected ok" << std::endl;
  } catch( const DBException &e ) {
    std::cout << "caught " << e.what() << std::endl;
  }
  return EXIT_SUCCESS;
} 
```

它们可以编译使用...

```
g++ test.cpp  -pthread -lmongoclient -lboost_thread-mt -lboost_filesystem -lboost_program_options -lboost_system -o test 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-03-12T15:57:50.377

您的代码不起作用的原因是您包含的顺序。你只需要把`dbclient.h`前面的 mongo 包括进来。实际上，您*只*需要`dbclient.h`，因为它包含所有其他必要的标题。

`shared_ptr`为了`DBClientConnection::query()`返回 a ，您还需要使用 a进行强制转换`std::auto_ptr`。

下面的代码应该可以正常工作：

```
#include "mongo/client/dbclient.h"

using namespace mongo;

void run() {
  DBClientConnection c;
  c.connect("localhost");
boost::shared_ptr<DBClientCursor> cursor =
   (boost::shared_ptr<DBClientCursor>)  c.query("test", BSONObj());
  while (cursor->more())
      std::cout << cursor->next().toString() << std::endl;
}

int main() {
  try {
    run();
    std::cout << "connected ok" << std::endl;
  } catch( const DBException &e ) {
    std::cout << "caught " << e.what() << std::endl;
  }
  return EXIT_SUCCESS;
} 
```

# css - 使用 css 设置 html5 画布字体颜色

> ID：14082669
> 
> 赞同：1
> 
> 时间：2012-12-29T14:38:50.710
> 
> 标签：css, html, canvas

如果我想要不同颜色主题的样式表，如何将画布字体和线条颜色保留在外部 CSS 文件中？

我可以制作隐藏的 dom 元素并将它们用作变量。

我可以只使用 javascript 来读取当前主题并使用 javascript 变量设置颜色，但这样就违背了 css 文件的目的。我还希望其他人无需编写 javascript 即可编辑样式和颜色。

有没有办法将设置存储在 css 文件中并使用 javascript（没有 ajax 或 jquery）轻松读取它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T14:43:37.707

画布元素中的线条颜色等不受 CSS 影响，因此没有办法直接这样做。您可以做的最好的事情是使用某种数据文件，该文件以 JSON 格式存储对象，其中包含每个主题的适当画布变量值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T14:44:30.967

画布绘图独立于 CSS。您使用 Canvas API 方法设置字体和颜色，而不是通过 CSS 样式设置。我能想到的最好的与外部 CSS 文件对应的是外部 JavaScript 文件，您只需将值分配给代码中用于在画布上绘图的变量。该文件可以非常简单，只需赋值，因此不需要对 JavaScript 有任何实质性的了解即可对其进行编辑。

# jasmine - 使用 Jasmine / PhantomJS 进行 CLI 测试

> ID：14082672
> 
> 赞同：1
> 
> 时间：2012-12-29T14:39:10.920
> 
> 标签：jasmine, phantomjs, yeoman

运行`yeoman server:test`在我的浏览器中打开 Jasmine 并说我的测试已通过。现在我想尝试同样的方法，但没有浏览器 - 在 CLI 上使用 PhantomJS。不幸的是，运行`yeoman test`只会抛出一个：

```
Running "jasmine:all" (jasmine) task
Running specs for index.html
>> 0 assertions passed in 0 specs (0ms) 
```

为什么它没有找到任何测试，即使所有内容都包含在我的`test/index.html`并且使用得很好`yeoman server:test`？

我使用`yeoman init jasmine:app --force`了我的项目并按照[此处](https://github.com/yeoman/yeoman/issues/437)`Gruntfile.js`所述进行了调整。它看起来像这样：

```
...
// headless testing through PhantomJS
jasmine: {
    all: ["test/**/*.html"]
},
...
// Alias the `test` task to run the `jasmine` task instead
grunt.registerTask("test", "jasmine");
... 
```

注意：我的测试是用 CoffeeScript 编写的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T22:33:27.983

经过一些研究，我发现 PhantomJS 无法在与 'yeoman server' 相同的位置找到文件`yeoman server:test`。

我在另一个线程中提出了我的问题：[在无头和浏览器中运行测试](https://stackoverflow.com/questions/14086501/running-tests-in-both-headless-and-browser)

# jquery - 将数据拉入客户网站

> ID：14082673
> 
> 赞同：1
> 
> 时间：2012-12-29T14:39:23.183
> 
> 标签：jquery, html, css, ajax

我想知道是否有人能够就实施以下内容的最佳方式提供一些建议：

我们希望提供一些独立的代码，无论平台如何，任何客户都应该能够将其构建到他们的网站中，这些代码需要从我们的网站中提取信息并将其显示给客户。

目前我正在 jquery 中开发这个解决方案来拉下 html/css，然后简单地用结果内容填充一个 div，客户需要做的就是添加一个具有正确名称的 div 并拉入我们的javascript？

有没有“更好”的方法来做这种事情，还是我走在正确的道路上？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T14:54:53.893

最简单的方法是创建一个动态 html 页面，编写一个小的可定制 iframe 脚本并将其提供给您的客户。

**您的网站** `http://ads.your-site.com/client-name`会显示此特定客户的广告列表

**客户网站** `<iframe src="http://ads.your-site.com/client-name"></iframe>`将该列表嵌入客户网站。

当然，您可以使用 jQuery 和 ajax 请求以及所有这些来使其更加精美。

# google-chrome-extension - chrome扩展定时器

> ID：14082674
> 
> 赞同：1
> 
> 时间：2012-12-29T14:39:26.587
> 
> 标签：google-chrome-extension

> **可能重复：**
> [Chrome 扩展延迟条件](https://stackoverflow.com/questions/14023983/chrome-extension-delay-condition)

我是扩展的初学者，通过从这里和那里收集代码，我创建了一个简单的代码，它收集选项卡的 url（适用于特定网站）并使用 ajax 将其发送到我的服务器以便将其存储在我的数据库中。我想要做的是添加一个计时器，如果上一次点击发生在不到 5 秒的时间内，浏览器按钮将被禁用（或什么都不做）。

下面是扩展的结构：

**显现：**

```
{
"name": "The name",
"icons": { "16": "Big.png",
       "48": "Big.png",
       "128": "Big.png" },
"version": "1.0",
"manifest_version": 2,
"description": "and the description",
"browser_action": {
"default_icon": "icon.png",
"default_popup": "popup.html"
},
"permissions": ["tabs", "<all_urls>"]
} 
```

**popup.js：**

```
chrome.tabs.getSelected(null,function(tab) {
var Mp=tab.url
if(Mp=='http://www.examplesite.com')
{
var xhr=new XMLHttpRequest();
var Params;
xhr.open("POST", "http://myserver.com/post_from_extension.asp", true);
xhr.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
Params='Url=' + tab.url;
xhr.onreadystatechange=function()
    {
        if(xhr.readyState==4)
        {
        message.innerHTML=xhr.responseText;
        }
    }
xhr.send(Params);
}
else
{
message.innerHTML='<span style="font-family: Segoe UI, Tahoma;color: #f00">This is not a valid url</span>';
}
}); 
```

**popup.html**

```
<!DOCTYPE html>
<html style=''>
<head>
<script src='popup.js'></script>
</head>
<body style="width:400px;">
<div id='message'><span style="font-family: Segoe UI, Tahoma;color: #00f">Sending request</span></div>
</body>
</html> 
```

作为一个附带问题，如果不使用 Ajax，是否有任何其他方法可以将 url 发布到我的数据库中？

谢谢你读我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T15:14:19.873

我认为你应该在你的扩展中添加一个背景页面（脚本）——这是一种应用程序状态。在清单中添加：

```
"background": {
    "scripts": ["background.js"]
  }, 
```

然后在页面中，您可以定义一个数组，存储上次为每个选项卡执行浏览器操作的时间。

```
var timers = []; 
```

您可以从您的 更新此数组的元素`popup.js`，类似于（在`getSelected`回调中）：

```
chrome.extension.getBackgroundPage().timers[tabId] = new Date();
chrome.browserAction.disable(tabId);
chrome.browserAction.setIcon({path: "icon-disabled.png", tabId: tabId}); 
```

请注意如何禁用浏览器操作并将其外观更改为禁用/灰色。

当注册时间超过 5 秒后，您应该从后台页面重新启用该按钮。

```
var currentTime = new Date();
if(currentTime - chrome.extension.getBackgroundPage().timers[tabId] > 5000)
{
  chrome.browserAction.enable(tabId);
  chrome.browserAction.setIcon({path: "icon-enabled.png", tabId: tabId});
} 
```

您可以从回调中执行此代码，`setInterval`并在一个循环内遍历`timers`数组中的所有元素。

# xml - 如何使用 XSL 在 href 中查找具有特定关键字的元素？

> ID：14082675
> 
> 赞同：2
> 
> 时间：2012-12-29T14:39:27.777
> 
> 标签：xml, xslt

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T14:57:09.000

`href`要删除属性中包含不需要的字符串的锚点，请展开`match`XPath 表达式：

```
<xsl:template match="a[not(contains(@href,'Foo'))]">... 
```

`Foo`可能是`spammycrap.com`或其他。

此外，您可以为空锚和非空锚指定不同的模板。因此，对于非空锚点，您将使用：

```
<xsl:template match="a[not(contains(@href,'Foo')) and not(count(node()) = 0)]">... 
```

其次是非空锚的模板。然后对于空锚：

```
<xsl:template match="a[not(contains(@href,'Foo')) and not(node())]">... 
```

其次是空锚的模板。

总的来说，这变成：

```
<xsl:template match="a[not(contains(@href,'Foo')) and not(count(node()) = 0)]">[url="<xsl:value-of select="@href"/>"]<xsl:apply-templates/>[/url]</xsl:template>

<xsl:template match="a[not(contains(@href,'Foo')) and not(node())]">[url]<xsl:value-of select="@href"/>[/url]</xsl:template> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T15:15:05.060

您可以使用空模板忽略特定元素，例如

```
<xsl:template match="a[contains(@href, 'badurl')]" /> 
```

要查找非空`a`元素，您可以使用

```
<xsl:template match="a[*|text()[normalize-space(.)]]">
  <xsl:text>[url="</xsl:text>
  <xsl:value-of select="@href"/>
  <xsl:text>"]</xsl:text>
  <xsl:apply-templates/>
  <xsl:text>[/url]</xsl:text>
</xsl:template> 
```

它匹配任何具有不完全空白的子元素或文本节点的锚点。与此模式不匹配的锚点将被通用`match="a"`模板拾取

```
<xsl:template match="a">[url]<xsl:value-of select="@href" />[/url]</xsl:template> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T17:45:35.713

**这种转变**：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

 <xsl:template match="a[starts-with(@href, 'http://spammy')]"/>

 <xsl:template match="a[not(*|text()[normalize-space(.)])]">
  <xsl:text>[url]</xsl:text>
    <xsl:value-of select="@href"/>
  <xsl:text>[/url]&#xA;</xsl:text>
 </xsl:template>

 <xsl:template match="a">
  <xsl:text>[url="</xsl:text>
  <xsl:value-of select="@href"/>"]<xsl:text/>
  <xsl:value-of select="."/>
  <xsl:text>[/url]&#xA;</xsl:text>
 </xsl:template>
</xsl:stylesheet> 
```

**应用于此 XML 文档时：**

```
<html>
    <a href="http://spammycrap.tld">Foo</a>
    <a href="http://empty.tld"></a>
    <a href="http://empty2.tld">    </a>
    <a href="http://okay.tld">Baz</a>
</html> 
```

**产生想要的正确结果：**

```
[url]http://empty.tld[/url]
[url]http://empty2.tld[/url]
[url="http://okay.tld"]Baz[/url] 
```

# jquery - Adobe Edge/JQuery：动画不起作用

> ID：14082679
> 
> 赞同：1
> 
> 时间：2012-12-29T14:39:52.830
> 
> 标签：jquery, animation, adobe-edge

对于大学作业，我必须在 Adob​​e Edge Animate 中为 Smegg 冰箱开发一个产品网站。我的问题是我希望徽标在完全不透明度和比如说 30% 之间有一个恒定的不透明度过渡，然后再回到 100%，这会一直循环。我写了一些 jQuery 代码，但它不起作用。对不起我的英语不好，这不是我的母语。这是代码：

```
//Edge symbol: 'stage'
(function(symbolName) {

  Symbol.bindElementAction(compId, symbolName, "document", "compositionReady", function(sym, e) {
     // insert code to be run when the composition is fully loaded here

     var timer = $.timer(logoHandler, 1000);

        function logoHandler() { 
            var state = true;

        if ( state ) {
            $( "#smegLogo" ).animate({
                opacity: 0.3
            }, 500 );
        } else {
            $( "#smegLogo" ).animate({
                opacity: 1
            }, 500 );
        }
        state = !state;

        };

     timer.play();

  }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T15:08:48.143

像这样的东西？

[http://jsbin.com/abecoz/1/edit](http://jsbin.com/abecoz/1/edit)

```
var c=0;
var op = [ '0.3' , '1' ];
function loopLogo(){  
  $("#smegLogo").animate({opacity: op[c++%2]},400, loopLogo); // <- ani. callback
}

loopLogo(); // start loop 
```

# laravel - 如何在 Laravel 中返 回数据库表名

> ID：14082682
> 
> 赞同：42
> 
> 时间：2012-12-29T14:39:59.813
> 
> 标签：laravel, eloquent

有没有一种方法可以让我所在的模型正在使用当前数据库表？我看到 Laravel/Database/Eloquent/model.php 中有一个 table() 函数，但我一直没有成功调用它从我所在的模型中调用它。

* * *

## 回答 #1

> 赞同：91
> 
> 时间：2013-12-28T07:55:27.287

[Eloquent\Model](http://laravel.com/api/class-Illuminate.Database.Eloquent.Model.html)中定义了一个公共 getTable() 方法，因此您应该可以使用`$model->getTable()`.

* * *

## 回答 #2

> 赞同：58
> 
> 时间：2014-06-29T16:23:22.257

泰勒[回答](https://github.com/laravel/framework/issues/1436)了你的问题：

在模型类中，您可以执行以下操作：

```
return with(new static)->getTable(); 
```

如果您希望所有模型都能够静态返回表名，那么就像这样：

```
class BaseModel extends Eloquent {

    public static function getTableName()
    {
        return with(new static)->getTable();
    }

}

class User extends BaseModel {

}

User::getTableName(); 
```

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2012-12-29T14:45:20.530

**2019 年 4 月编辑：此答案现已过时。查看 Flyn San 的新正确答案**

是的 - Eloquent 有一个`$table`变量。您可以通过两种方式访问​​它：

```
class yourModel extends Eloquent {

        public static $table = "differentTable";

        function someFunction()
        {
             return yourModel::$table;
        }
} 
```

**或者**

```
class yourModel extends Eloquent {

    public function someFunction()
    {
        return $this->table();

    }
} 
```

然后在你的代码中

```
Route::get('/', function () {
    $model = new yourModel();   
    dd($model->someFunction());
}); 
```

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2018-01-10T10:07:37.693

就我而言，我使用的是 laravel 5.4

`return (new static)->getTable();`

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2015-08-11T15:16:42.350

由于`table`是 Model 类（Laravel >= 5）中的受保护属性，因此您将需要 Model 的实例。

这是一个案例示例：

```
 DB::table( (new YourModelClassname)->getTable() )
            ->update(['field' => false]); 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2020-06-30T09:31:56.853

您可以通过以下代码获取模型表的名称：

如果我们有一个 Model 作为 ModelName：

```
ModelName::query()->getQuery()->from 
```

在模型中定义的自定义表名的情况下，此方法也可以正常工作`protected $table = 'custom_table_name'`。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2020-02-05T07:38:12.423

根据[Lucky Soni 的回答](https://stackoverflow.com/a/24477971/1940489)，如果您想直接从**Vontroller**或**View**调用它，还有另一个简单的技巧。

在 Laravel 6 中测试，如果您是讨厌额外行实例声明的“单行**程序员” ，我会继续使用它。**模型文件中也不需要额外的行。

```
$string_table_name = with(new \App\Model\TableModelName)->getTable(); 
```

或者更好的是，您也可以只调用它

```
$string_table_name = (new \App\Model\TableModelName)->getTable(); 
```

即使您`$table`在模型类中重命名变量，它也会返回表格名称的纯字符串。

**编辑 ：**

减去代表？？也许你应该首先在你的**控制器**中尝试这个，而不是在模型类中创建新函数只是为了获取表名并且在调用时不需要声明对象。

`with()`本身是 Laravel 辅助函数，它返回类的对象。并且扩展模型的内部类已经具有功能`getTable()`。因此，您不必在模型类中添加另一个新的冗余函数。好像是最新版本，直接调用`(new Class)`就可以了`with()`。

这个答案和 Lucky 的答案之间的区别，我的没有在 Model 类中创建任何新函数来获取表名，即使你可以只调用 Controller 和 View 中的函数而不声明模型类的对象。这是为了美化代码。

虽然 Lucky 的答案在 Model 类中创建了新函数，但您需要从对象中调用该函数。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2020-09-03T09:10:29.887

通过以下方式从 Laravel 模型中获取表名的简单方法：

```
$tableName = app(\App\User::class)->getTable(); 
```

不要忘记更换：

> \应用\用户

带模型路径。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2020-10-17T18:03:57.320

根据裁缝 Otwell 的[回答](https://github.com/laravel/framework/issues/1436#issuecomment-18618393)，您可以使用以下内容：

```
with(new Model)->getTable(); 
```

注意：在 5.x、6.x、7.x、8.x 版本上测试并且运行良好。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2021-10-28T07:22:57.883

它将从模型中返回表名。在 laravel 8 上完美运行

```
app(Modelname::class)->getTable() 
```

你必须用你的模型类替换 Modelname

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2021-08-04T09:40:25.173

这是另一种方法，您可以静态获取模型的表名。

1.  定义一个特征：`app/Traits/CanGetTableNameStatically.php`

```
<?php namespace App\Traits;

trait CanGetTableNameStatically
{
    public static function tableName()
    {
        return (new static)->getTable();
    }
} 
```

2.  扩展您的要求`Model`或`BaseModel`与`use`声明。

`app/Models/BaseModel.php`

```
<?php namespace App\Models;

use Illuminate\Database\Eloquent\Model;
use App\Traits\CanGetTableNameStatically;

class BaseModel extends Model
{
    use CanGetTableNameStatically;

    // ...
} 
```

在您的模型上，如果您在 Laravel 的保留属性上设置自定义表名：`protected $table`那么它仍然可以工作并返回正确的表名。

`app/Models/Customer.php`

```
<?php namespace App\Models\Master;

use App\Models\BaseModel;

class Customer extends BaseModel
{
    protected $table = 'my_customers';

    // ...
} 
```

**用法**：随便打电话`YourModel::tableName()`。

在视图中：

```
{{ \App\Models\Customer::tableName() }} 
```

进行联接时：

```
DB::table( Product::tableName() . ' AS p' )
->leftJoin( ProductCategory::tableName() . ' AS pc', 'pc.id', '=', 'p.category_id')
// ... etc 
```

注意：我在需要但完全公开的地方使用了这种方法，我在[这里](https://stackoverflow.com/a/62613885/4311336)找到了另一个具有完全相同方法的答案，所以我复制粘贴在这里以供参考，当然要感谢[@topher](https://stackoverflow.com/users/2695256/topher)

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2021-03-16T12:10:38.263

另一种解决方案是`resolve`像这样使用助手：

```
resolve('\\App\\Models\\User')->getTable() 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2021-09-24T08:57:34.857

如果您使用的是表名前缀，那么到目前为止，所有答案都不会为您提供带有前缀的表名。这时候，如果我们想要数据库表的真实名称，似乎需要我们自己将前缀与表名连接起来。

以下是获取包含表前缀的表名的方法：

```
echo \App\MyModel::query()->getQuery()->getGrammar()->getTablePrefix() . app(\App\MyModel::class)->getTable(); 
```

* * *

## 回答 #14

> 赞同：-3
> 
> 时间：2019-08-22T21:20:13.000

我只想为来自搜索引擎的人添加以下内容：

如果您根本不想实例化模型（更快？）：

```
$model = 'App\User';
$modelTable = str_replace('\\', '', Str::snake(Str::plural(class_basename($model))));
dd($modelTable); // will return "users" 
```

这可能看起来很难看，但这正是 getTable() 方法在后台解决它的方式，所以......

您将需要`use Illuminate\Support\Str;`在您的文件之上。

附录：暗示您遵循框架的标准（即：`Post`模型有`posts`表，用户模型有`users`表等）

* * *

## 回答 #15

> 赞同：-4
> 
> 时间：2014-03-09T18:40:04.983

在**Laravel 4 中**使用**静态**方法

```
$table_name = Model::getTable(); 
```

或Eloquent 模型中的“ **self ”**

```
$table_name = self::getTable(); 
```

# javascript - 用于将 HTML 屏幕元素绑定到 Javascript 结构的框架/库？

> ID：14082686
> 
> 赞同：0
> 
> 时间：2012-12-29T14:40:10.553
> 
> 标签：javascript, jquery, html

专家们，

我想使用 HTML、JQuery 和 Javascript 创建一个富客户端应用程序。是否有框架或库可以轻松地将 HTML 页面元素（如表单或 div）绑定或转换为 Javascript 结构？

示例：假设我想在我的客户端应用程序中管理“汽车”类。这辆车有一些我想存储在 Javascript 变量中的属性。“汽车”应该有一个编辑对话框，可以让您编辑属性（例如颜色、型号）。在编辑对话框中更新属性时，我还想编辑 Javascript 变量属性，以便可以通过 ajax 在服务器端执行更新。

我可以在 javascript 或 jquery 中手动执行此操作，但我想知道是否有框架或库可以自动执行此操作。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T14:52:12.603

您应该查看具有视图模型绑定功能（如[CanJS](http://canjs.us/)、[Knockout](http://knockoutjs.com/)等）的[javascript MV* 框架的数量](http://net.tutsplus.com/articles/web-roundups/20-javascript-frameworks-worth-checking-out/)

# java - 我怎样才能重新抛出异常？

> ID：14082691
> 
> 赞同：0
> 
> 时间：2012-12-29T14:41:02.613
> 
> 标签：java, exception

> **可能重复：**
> [有没有办法在不添加 throws 声明的情况下抛出异常？](https://stackoverflow.com/questions/4519557/is-there-a-way-to-throw-an-exception-without-adding-the-throws-declaration)

我想知道当方法已经定义并且没有子句时，是否有一种方法可以封装`Exception`并重新抛出它。`Exception``throws`

一个例子（使用 JMS`onMessage`方法）：

```
 public void onMessage(Message message) {

    if(message instanceof ObjectMessage){

        ObjectMessage objectMessage = (ObjectMessage)message;

        try {
            Object object = objectMessage.getObject();
        } catch (JMSException e) {
            throw new CustomException("blah blah", e); // ERROR HERE : Unhandled exception type CustomException
        }

     }

 } 
```

那么，我该如何`CustomException`在我的代码中封装和发送呢？有办法吗？谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T14:43:39.677

您需要使用`RuntimeException`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-29T14:47:08.747

如果一个方法没有声明任何异常，唯一的办法就是抛出一个异常，它的子类是`RuntimeException`.

在您的情况下`CustomException`应该扩展`RuntimeException`.

[Oracle](http://docs.oracle.com/javase/tutorial/essential/exceptions/throwing.html)关于异常的一点理论。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-29T14:49:20.243

如果 CustomException 是未经检查的异常（运行时异常），这将起作用。您可以在此处阅读有关已检查与未检查异常的信息 [-Java：已检查与未检查异常说明](https://stackoverflow.com/questions/6115896/java-checked-vs-unchecked-exception-explanation)

# symfony - Symfony2 具有集合类型的表单（多对多）

> ID：14082699
> 
> 赞同：1
> 
> 时间：2012-12-29T14:41:35.593
> 
> 标签：symfony, doctrine-odm

## 我有的

我有一个数据库表“ **Teams** ”和一个表“ **Players** ”，它们与一个 Teams_has_Players 表（多对多关系）相连。我生成了我的实体。我现在可以通过执行以下操作成功地从团队中检索球员：`$players = $team->getPlayers()->toArray();`

## 我正在尝试做的事情

我正在尝试制作一个表格，您可以在其中编辑所有球队的球员**姓名**和他们在球场上的**位置**。所以我基本上希望有一些行，每行都有一个带有名称的输入字段和一个带有他位置的输入字段。

## 我试图做的

所以我读了很多关于 Symfony2 Collection 类型的文章并尝试了这个：

```
$form = $this->createFormBuilder(null)
    ->add('name', 'text', array('label' => 'Name', 'data' => $team->getName()))
    ->add('players', 'collection', array('data' => $team->getPlayers()->toArray()))
    ->getForm(); 
```

在我看来，我试过这个：

```
<ul>
    {% for player in form.players %}

        <li>
            {{ form_widget(player.name) }}{{ form_widget(player.position) }}
        </li>
    {% endfor %}
</ul> 
```

但我得到这个错误：

> 表单的视图数据应为标量、数组或 \ArrayAccess 的实例类型，但它是 MatchTracker\Bundle\AppBundle\Entity\Players 类的实例。您可以通过将“data_class”选项设置为“MatchTracker\Bundle\AppBundle\Entity\Players”或添加一个视图转换器来将 MatchTracker\Bundle\AppBundle\Entity\Players 类的实例转换为标量、数组或\ArrayAccess 的一个实例。

所以我添加了`'data_class' => 'MatchTracker\Bundle\AppBundle\Entity\Players'`，但后来我收到一个错误，表单的视图数据应该是 MatchTracker\Bundle\AppBundle\Entity\Players 类的实例，但它是一个（n）数组。您可以通过将“data_class”选项设置为 null 来避免此错误

谁能帮我解决这个问题？我只想在表格中编辑球队的球员姓名/位置/..。如果可行，我将扩展表单，以便[添加/删除玩家](http://symfony.com/doc/master/reference/forms/types/collection.html#adding-and-removing-items)。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T17:37:22.793

[这就是您正在尝试做的事情。](http://symfony.com/doc/master/cookbook/form/form_collections.html)

# python - Python 和 Thread：实例没有 __call__ 方法

> ID：14082708
> 
> 赞同：1
> 
> 时间：2012-12-29T14:42:56.243
> 
> 标签：python, multithreading

我在 Python 中扩展 Thread 类时遇到问题。这是我的简单代码：

```
import threading

class position:

    def __init__(self,id):
        self.id = id

class foo(threading.Thread):

    def __init__(self):
        self.start = position(0)
        threading.Thread.__init__(self)

    def run(self):
        pass

if __name__ == '__main__':
    f = foo()
    f.start() 
```

显示的错误是：

```
Traceback (most recent call last):
  File "foo.py", line 19, in <module>
    f.start()
AttributeError: position instance has no __call__ method 
```

错误在哪里？我花了 3 个小时寻找解决方案，但我找不到。我在工作期间多次扩展 Thread 类，但这次它不起作用。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-29T14:45:37.403

您已经用您的实例覆盖了该`start`方法。`position`以不同的方式命名您的`position`财产。

例如

```
import threading

class position:

    def __init__(self,id):
        self.id = id

class foo(threading.Thread):

    def __init__(self):
        self.start_position = position(0)   # self.start is now unharmed
        threading.Thread.__init__(self)

    def run(self):
        pass

if __name__ == '__main__':
    f = foo()
    f.start() 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-29T14:46:47.280

您已经在构造函数中隐藏了`Thread.start`带有`start`字段的方法。

重命名该字段（例如，将其命名为 startedAt），或者如果您坚持将其命名为`start`，请使用`foo.start(f)`

# types - 表示一组函数及其键入规则

> ID：14082709
> 
> 赞同：1
> 
> 时间：2012-12-29T14:43:03.410
> 
> 标签：types, ocaml, typing, static-typing

我想表示一组函数及其键入规则，并且正在考虑数据结构......例如，

```
For function "PLUS":
PLUS-integer: Integer -> Integer -> Integer, with priority high
PLUS-boolean: Boolean -> Boolean -> Integer, with priority high
...

For function "Unary Minus":
UM-0: Integer -> Integer, with priority high
UM-1: Date -> Date, with priority high
...

For function "Unary Minus":
UM-error: Date -> Error, with priority low
... 
```

一些评论： 函数和规则的名称总是唯一的；一个函数（例如 PLUS）总是有固定数量的参数，并且可以有几个与之相关的打字规则；一个打字规则有一个名称（例如，加号整数）、一个前提、一个结论和一个优先级。可能有 2 个打字规则共享相同的前提，但给出不同的结论，在这种情况下，是优先级造成了差异。

稍后，我需要定义如下函数：

```
add_rule: add a rule to a function
get_rules: get all the rules from a function
get_first_rule: get the most priority rule from a function and a premise
get_conclusions: get all the conclusions that a function can give
get_errors: get all the rules whose conclusion is an error
get_function: get the function from a typing rule
set_priority: set a priority for a rule
... 
```

为此，我不知道是否有定义这些类型的常规方式......目前，我想象一种方式如下：

```
type func =
    { name: string;
      ... }

type rule =
    { name: string;
      premise: Type.t list;
      conclusion: Type.t;
      priority: Priority.t
      ... }

type rules = rule list 
```

几个问题：

1)与数组相比，定义`rules`为 的列表是否是个好主意...`rule`

2）关于 和 的关系`func`，`rules`有几种选择：`rules`做为 的记录字段`func`；制作`func`为记录字段`rule`；`func`制作和的哈希表`rules`；`func`从到制作地图`rules`。我真的不知道哪种方式更好...

另一个需要考虑的方面是这个数据库的启蒙，要输入的东西很多，所以我希望我选择的类型能让启蒙容易进入，看起来很直观……

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T20:07:59.927

1 - 使用数组或列表或其他东西，取决于您打算如何访问基础数据。

如果您需要对规则进行随机索引访问，并且数据集没有太大变化，请使用`array`. 如果数据集定期重建，并且您按顺序访问元素，请使用`list`. 如果您需要通过连续整数范围以外的其他方式对元素进行索引，请使用 a `assoc list`、 a`map`或 a`hashtable`

2 - 与上面相同，它最终取决于访问模式。选择在你的算法中看起来最方便的东西，如果一段时间后它碰巧是错误的选择，不要害怕重构你的代码。

顺便说一句，如果需要， `rules`and`func`类型可以是相互依赖的，例如：

```
type func = {
    rules : rule list;
   (* ... *)
}
and rule = {
    funcs : func list;
   (* ... *)
};; 
```

# c# - 从路径正则表达式获取文件名

> ID：14082710
> 
> 赞同：0
> 
> 时间：2012-12-29T14:43:08.790
> 
> 标签：c#

```
C:\Users\asus\AppData\Local\Temporary Projects\ConsoleApplication1\bin\Release\sfref.txt 
```

如何拆分字符串以仅获取`sfref.txt`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-29T14:45:03.970

你不需要正则表达式...

```
System.IO.Path.GetFilename(fullpath); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-29T14:45:07.967

使用[Path.GetFileName](http://msdn.microsoft.com/en-us/library/system.io.path.getfilename.aspx)方法：

```
var path = @"C:\Users\asus\AppData\Local\Temporary Projects\ConsoleApplication1\bin\Release\sfref.txt";
string name = Path.GetFileName(path); // sfref.txt 
```

如果您真的需要使用正则表达式来做到这一点（我不建议这样做）：

```
string name = Regex.Match(path, @"[^\\]*$").Value; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T15:10:31.847

您可以使用[FileInfo](http://msdn.microsoft.com/en-us/library/system.io.fileinfo.aspx)。[姓名](http://msdn.microsoft.com/en-us/library/system.io.fileinfo.name.aspx)

```
new FileInfo(@"C:\Users\asus\AppData\Local\Temporary Projects\ConsoleApplication1\bin\Release\sfref.txt").Name 
```

# php - 子查询在第二次插入时返回超过 1 行

> ID：14082711
> 
> 赞同：0
> 
> 时间：2012-12-29T14:43:17.333
> 
> 标签：php, html, insert, phpmyadmin

我有 2 张桌子：

tbl用户：

```
+------+-----------+
|  id  |   Name    |
+------+-----------+ 
```

tblItems（此表接受多个复选框值，具体取决于选择的用户数量）：

```
+------+-----------+---------------+
|  id  |  items    |    name_id    |
+------+-----------+---------------+ 
```

`name_id`将获得 id 中的值`tblUser`。
我使用此代码来获取 id 的值`tblUser`to `name_id`：

```
for ($i=0; $i<sizeof($checkbox);$i++){
    $sql2="INSERT INTO tbl_trainings VALUES (NULL, '".$checkbox[$i]."', (SELECT id FROM tbl_info))";
    $result2=mysql_query($sql2);
 } 
```

它适用`INSERT`于数据库中看起来像这样的第一个数据：

```
+------+-----------+---------------+
|  id  |  items    |    name_id    |
+------+-----------+---------------+
|  1   |  Bucket   |    1          |
+------+-----------+---------------+
|  2   |  Tree     |    1          |  
+------+-----------+---------------+
|  3   |  House    |    1          |
+------+-----------+---------------+ 
```

但在下一秒或下一秒`INSERT`的数据就会出错。错误是

**子查询**从`mysql_error();`

顺便说一句，这是完整的代码：

```
if($_POST["Submit"]=="Submit"){
    $sql1="INSERT INTO tblUser VALUES (NULL, '$fname', '$lname')";
    $result1=mysql_query($sql1);
    for ($i=0; $i<sizeof($checkbox);$i++){
    $sql2="INSERT INTO tblItems VALUES (NULL, '".$checkbox[$i]."', (SELECT id FROM tblUser))";
        $result2=mysql_query($sql2);
    }
}

if($result2 && result1){
    echo"<center>";
    echo"<h1>";
    echo "SUCCESSFUL!";
    echo"</h1>";
    echo"</center>";
}
else {
    echo "ERROR". mysql_error();
} 
```

数据库中所需的输出将是：

```
+------+-----------+---------------+
|  id  |  items    |    name_id    |
+------+-----------+---------------+
|  1   |  Bucket   |    1          |
+------+-----------+---------------+
|  2   |  Tree     |    1          |  
+------+-----------+---------------+
|  3   |  House    |    1          |
+------+-----------+---------------+
|  4   |  Tree     |    2          |  
+------+-----------+---------------+
|  5   | Air plane |    2          |
+------+-----------+---------------+
|  6   | Bucket    |    3          |
+------+-----------+---------------+ 
```

任何帮助，将不胜感激。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T14:49:58.923

```
SELECT id FROM tblUser 
```

返回表中的所有 id。

你需要使用 mysql last_insert_id 代替：

```
$sql1="INSERT INTO tblUser VALUES (NULL, '$fname', '$lname')";
$result1=mysql_query($sql1);
$user_id = mysql_insert_id();
for ($i=0; $i<sizeof($checkbox);$i++){
    $sql2="INSERT INTO tblItems VALUES (NULL, '".$checkbox[$i]."', $user_id)";
    $result2=mysql_query($sql2);
} 
```

请注意，不推荐使用标准的 mysql 函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T14:55:51.223

出于安全原因，您应该使用准备好的语句 [http://php.net/manual/en/pdo.prepared-statements.php](http://php.net/manual/en/pdo.prepared-statements.php)

# c# - 整数变量的 C# 性能

> ID：14082712
> 
> 赞同：-3
> 
> 时间：2012-12-29T14:43:22.513
> 
> 标签：c#, performance, integer, generic-list

我已经知道建议在 for 循环中使用 int 变量只是对性能感到好奇，建议使用除 int C# 之外的其他整数类型，何时使用？

这个问题的真正目的是我必须创建一个 T 类型的通用列表，其中 T 是一个包含字符串和整数类型字段的结构。所以我认为优化结构会对整个列表的优化产生立竿见影的效果

我怀疑我的名单会很长......

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T14:48:01.543

（通常的过早优化警告适用于此答案。我假设您确实需要最高性能。）

通过使用最小的可行类型来优化类和结构的大小是一种有效的优化。在您的情况下，您将不会获得任何东西，因为这两个结构`string,int`并且`string,byte`由于填充而具有相同的大小。

一般来说，这种技术是有效的。您可以节省内存使用量并获得参考位置、缓存使用率和减少的内存带宽。

将循环计数器变量更改为更小的类型不会获得任何好处，因为对小于整数的任何操作都会`int`变宽回 int。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T15:08:41.153

可能是我必须对性能的东西不那么敏感

我只是回顾了我的需求，发现更改类型最多可以节省 24*N*bits，其中 N 是列表 N~10K 的长度，所以 ~240kbits 这没什么大不了的！

# c# - 在 C# 中将字典输出到文本框

> ID：14082713
> 
> 赞同：0
> 
> 时间：2012-12-29T14:43:26.023
> 
> 标签：c#, forms, dictionary, textbox, output

我有一个包含字符串和双精度的字典 myDataItems。我将值从 2 个文本框传递给字典，1 个文本框传递字符串值，另一个传递双精度值。我想知道如何在我用于输出目的的第三个文本框（txtOutput）中显示字典项目？

```
public partial class Form1 : Form 
{
   private Dictionary<string, double> myDataItems = new Dictionary<string, double>();
   private string dataName;
   private double dataCost;

   private void dataItemSend_Click(object sender, EventArgs e)
   {
      dataName = dataNameInput.Text;
      dataCost = Convert.ToDouble(dataCostInput.Text);
      myDataItems.Add(dataName, dataCost);
      txtOutput.Text = myDataItems.ToString();
   }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T14:52:11.590

一个简单的方法：

```
var lines = myDataItems.Select(kv => kv.Key + ": " + kv.Value.ToString());
txtOutput.Text = string.Join(Environment.NewLine, lines); 
```

记得添加`using System.Linq;`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T15:51:00.123

```
txtOutput.Lines = myDataItems.Select(x => x.Key + " : " + x.Value).ToArray(); 
```

# c++ - 对于使用 Clang 构建的目标文件，我需要将哪些库与 MinGW 链接？

> ID：14082720
> 
> 赞同：0
> 
> 时间：2012-12-29T14:43:58.637
> 
> 标签：c++, c++11

我正在使用用 Clang 构建的目标文件。但无论我传递给什么库参数`ld.exe`，它似乎总是吐回未解析的引用，诸如`memcpy`标准库之类的东西，以及诸如 _cxa_atexit 之类的实现东西。

我需要将哪些库（以及以什么顺序？）传递给 MinGW 链接器以使其将我的目标文件链接到可执行文件中？

编辑：

我将三元组从“i686-pc-mingw”更改为“i686-pc-mingw32”，它解决了大部分问题 - Clang 使用了旧的 D3D9 技巧“当输入明显错误且无法输出时静默失败可能是正确的”。但我只剩下两个未解决的外部问题——它是一些`std::_Hash_impl`for`float`和`double`，没有变化。该程序只是“你好，世界！”。奇怪的是，clang++.exe 和 g++.exe 在编译源代码时都没有问题，但是如果我使用 Clang C++ API 将其编译为 .o，然后将其传递回 MinGW，我会得到未解析的外部文件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T14:53:35.803

一般来说，在构建二进制文件时使用不同的工具链并不是一个好主意。完全有可能不同工具对符号名称的想法不匹配。

不过，试图回答你的实际问题：

`-lstdc`将是最低要求，`-lstdc++`如果它是 C++ 代码。如果不知道您的代码做了什么，就不可能说您是否需要更多代码。

# algorithm - 层序遍历的时间复杂度

> ID：14082721
> 
> 赞同：7
> 
> 时间：2012-12-29T14:44:20.410
> 
> 标签：algorithm, data-structures, big-o, time-complexity, tree-traversal

二叉树级顺序遍历的时间复杂度是多少？是 O(n) 还是 O(log n)？

```
void levelorder(Node *n)
{    queue < Node * >q;
     q.enqueue(n);

     while(!q.empty())
      {
         Node * node = q.front();
         DoSmthwith node;
         q.dequeue();          
         if(node->left != NULL)
         q.enqueue(node->left);
         if (node->right != NULL)
         q.enqueue(node->right);
      }

} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-29T14:48:04.253

它是`O(n)`，或者准确地说`Theta(n)`。

查看树中的每个节点 - 每个节点最多“访问”3次，并且至少一次） - 发现时（所有节点），从左儿子（非叶子）回来时以及来时从右儿子（非叶子）返回，因此最多总共访问 3*n 次，每个节点至少访问 n 次。每次访问都是`O(1)`（队列推送/弹出），总计 - `Theta(n)`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-09-19T23:01:41.913

解决此问题的另一种方法是确定级别顺序遍历与图的[广度优先搜索](http://en.wikipedia.org/wiki/Breadth-first_search)非常相似。广度优先遍历具有时间复杂度，`O(|V| + |E|)`其中`|V|`是顶点数，`|E|`是边数。

在树中，边的数量大约等于顶点的数量。这使得它在节点数量上总体**呈线性关系。**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T15:24:17.543

时间和空间复杂度为 O(n)。n = 没有。的节点。

> 空间复杂度 - 队列大小与节点数量成正比 O(n)
> 
> 时间复杂度 - O(n) 每个节点被访问两次。在入队操作期间一次，在出队操作期间一次。

这是 BFS 的一个特例。您可以阅读有关 BFS（广度优先搜索）[http://en.wikipedia.org/wiki/Breadth-first_search](http://en.wikipedia.org/wiki/Breadth-first_search)的信息。

# ios - iphone - 字符串不保持其价值

> ID：14082728
> 
> 赞同：0
> 
> 时间：2012-12-29T14:45:24.110
> 
> 标签：ios, string, null, syntax-error

当我在情节提要中切换到另一个 ViewController 时，该字符串`selectedSong`不会保持其值。即使我所有的视图控制器都连接到 ViewController 类。我已经这样做了

第一视角：

```
- (IBAction)selectTheSong {
    selectedSong = @"test";
    NSLog(@"%@", selectedSong);
} 
```

并在那里返回`test`日志中的值。

第二种观点：

```
 NSLog(@"%@", selectedSong);

if (audioPlayer == nil) {

NSString* soundPath =[[NSBundle mainBundle] pathForResource:selectedSong ofType:@"mp3"];
NSURL *soundURL = [NSURL fileURLWithPath:soundPath];

NSError *error = nil;

self.audioPlayer = [[AVAudioPlayer alloc] initWithContentsOfURL:soundURL error:&error];

[self.audioPlayer prepareToPlay];
}
[self.audioPlayer play]; 
```

这次它`(null)`在日志中返回。

字符串设置不正确？我尝试将其设为属性等，但没有奏效。请帮忙！谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T14:58:15.617

您需要`strong`在类接口中将字符串设置为具有保留类型的属性。

例如。

```
@property (nonatomic, strong) NSString *myString; 
```

此外，始终使用关键字访问该字符串实例，`self`以确保调用合成的访问器方法。

IE

```
self.myString = @"Hello!"; 
```

希望有帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T14:52:27.877

使用属性是要走的路。你是如何将字符串的值从一个 ViewController 传递到另一个的？你应该在`prepareForSegue:`方法中这样做。

# c# - C# - 异步 Web 客户端 - 获取 URL

> ID：14082732
> 
> 赞同：0
> 
> 时间：2012-12-29T14:46:15.317
> 
> 标签：c#, url, asynchronous, webclient

在 DownloadStringAsync 之后，如何在 DownloadStringCompletedEventHandler 中获取 url？

我正在尝试尽快阅读一堆网址。我正在考虑使用一组 Webclients，但我需要在我的事件句柄中识别 url。我这样做是处理返回的 html 代码的唯一方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T15:01:17.423

在调用 DownLoadStringAsync 时添加用户状态。另一个不太推荐的方法是反射到 WebClient 中以获取内部字段 m_WebRequest。该对象包含原始 Url，但这在新版本的框架中可能会失败。

```
 var wc = new WebClient();

    wc.DownloadStringCompleted += (sender, e) => 
    { 
        WebClient compWC = (WebClient) sender;
        string url = e.UserState as string;
        Console.WriteLine(compWC.ResponseHeaders[HttpResponseHeader.Server]);
        Console.WriteLine(url);
    };                

    wc.DownloadStringAsync(new Uri("http://www.google.nl"), "http://www.google.nl"); 
```

# matlab - 将数据集观察名称设置为第一列

> ID：14082733
> 
> 赞同：0
> 
> 时间：2012-12-29T14:46:22.283
> 
> 标签：matlab

我正在尝试将数据集的第一列设置为观察名称。每个观察都是数据集“投资组合”中的一个单独的股票。

我试过这个命令：

```
portfolio.Properties.ObsNames = portfolio.ticker 
```

我收到错误消息

```
Error using dataset/subsasgnDot (line 31)
NEWNAMES must be a nonempty string or a cell array of nonempty strings.

Error in dataset/subsasgn (line 83)
a = subsasgnDot(a,s,b); 
```

我查看了代码，但没有看到哪里出错了。

我尝试投射到一个单元阵列，但它没有用。我使用了这段代码：

```
portfolio.Properties.ObsNames = dataset2cell(portfolio.ticker) 
```

并收到此错误消息

```
Undefined function 'dataset2cell' for input arguments of type 'cell'. 
```

接下来我应该尝试什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T04:34:44.043

我设法通过在单独的行上进行投射来投射它。

# node.js - npm 如何检测 Windows 机器上安装了哪些节点包？

> ID：14082735
> 
> 赞同：0
> 
> 时间：2012-12-29T14:46:39.650
> 
> 标签：node.js, npm

我想知道在某个地方（可能在 node js 网站上）是否有关于与包相关的下一个情况的解释：

*   我安装了一个示例应用程序，比如说在**d:\samples\backbone**目录中，这意味着节点包也是在那里创建的。

*   **从d:\samples\backbone\option2**目录中的命令行 使用**npm list 列出**已安装的包将向我显示已安装的包，如果我在**d:\samples\backbone**中运行相同。如果在**d:\samples**目录中运行，则不再显示包。

 ******我猜该节点会在所有目录中搜索已安装的软件包，直到根目录，但在文档中提到它的某个地方？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T14:55:17.287

任何全局安装的模块（例如：npm install -g express）都安装在`C:\Program Files (x86)\nodejs\node_modules`

任何已在本地安装的东西（例如 async、mysql）都放在您的文件夹内的`./node_modules/`目录中。

在这种情况下，您的主干应用程序具有本地依赖项，因此其软件包本地安装在**d:\samples\backbone\node_modules 中**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T23:19:31.147

如果您查看 Node.js 的文档，请在模块页面 - [http://nodejs.org/api/modules.html](http://nodejs.org/api/modules.html) - 查看以下部分：

*   核心模块
*   文件模块
*   从 node_modules 文件夹加载

你会发现如何`require()`解决。******

# c# - Winforms Listbox 或 Listview 图像和文本

> ID：14082743
> 
> 赞同：-1
> 
> 时间：2012-12-29T14:47:15.700
> 
> 标签：c#, winforms

我对c#不是很有经验。我正在使用 winforms，我正在寻找一种方法来创建类似于此模板的元素列表，类似于 Visual Studio 的自动完成列表。有可能吗？我应该使用列表框还是列表视图？

编辑对不起，我的问题不清楚我不想创建自动完成，但我想要创建的是这样[的](http://www.homeandlearn.co.uk/csharp/images/csharp_2010/intellisense_console.gif)东西列表，该东西的文本旁边有一个图标。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T16:55:59.693

这是在 Listview 控件中使用图像的快速而肮脏的示例。由于我没有太多关于你打算做什么的信息，所以我尽量保持简单。

简而言之，您需要将一些图像加载到 Listview 控件中内置的 ImageList（Large 或 Small）之一并为其分配键，以便您可以在添加它们时将它们分配给特定的列表项。

诀窍是确定用于特定列表项的图像（假设有不同的图像分配给不同的列表项，具体取决于某些差异化因素。在此示例中，我使用了“汽车”或“卡车”的任意分配并简单地决定列表中的前五个项目是汽车，最后五个是卡车。然后，我在添加每个列表视图项目时使用 image 键适当地分配了每个图像。您可以为更复杂的场景执行此操作，并且使用图像键时，添加项目的顺序无关紧要。

对于此用例，您需要创建或使用尺寸为 16 x 16 像素的图像。我继续在我的项目资源文件中添加了两个图像，然后使用项目`Properties.Resources`名称空间简单地访问它们。还有其他方法可以做到这一点，但这对我来说是最方便的。

希望有帮助。

```
public partial class Form1 : Form
{
    static string CAR_IMAGE_KEY = "Car";
    static string TRUCK_IMAGE_KEY = "Truck";

    public Form1()
    {
        InitializeComponent();
    }

    private void Form1_Load(object sender, EventArgs e)
    {
        this.SetupListview();
        this.LoadListView();
    }

    private void SetupListview()
    {
        var imgList = new ImageList();
        imgList.Images.Add("Car", Properties.Resources.jpgCarImage);
        imgList.Images.Add("Truck", Properties.Resources.jpgTruckImage);

        var lv = this.listView1;
        lv.View = View.List;
        lv.SmallImageList = imgList;            
    }

    private void LoadListView()
    {
        for(int i = 1; i <= 10; i++)
        {
            string currentImageKey = CAR_IMAGE_KEY;
            if(i > 5) currentImageKey = TRUCK_IMAGE_KEY;
            var item = this.listView1.Items.Add("Item" + i.ToString(), currentImageKey);
        }
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T15:17:05.613

正如我从您的问题中了解到的那样，您可以创建自定义`UserControl`或创建一个`Form`并放入`ListBox`其中。如果您使用`From`确保更改边框样式布局，只需将其设置为无。创建以供使用后，您应该创建表单并将其显示在您想要的位置，如下所示：

```
FrmAutoComplete x = new FrmAutoComplete();
x.Show(); 
```

您可以将此表单放入 ToolTipItem 并显示它。

祝你好运。

# c++ - C++ 矩阵类重载运算符按引用返回

> ID：14082745
> 
> 赞同：3
> 
> 时间：2012-12-29T14:47:25.787
> 
> 标签：c++, matrix, return, binary-operators

我正在编写模板化的矩阵类，当从运算符按值返回时出现堆栈溢出：+、-、* 对于较大的矩阵。我宁愿以某种方式通过引用返回以减轻堆栈并避免额外的复制，但是，我将不得不返回一个用**new**构造的对象，并打破“对每个**new使用****delete** ”的一般规则。由于复制开销和堆栈限制问题，我无法按值返回，并且由于内存泄漏，我也无法按引用返回，那我该怎么办？

 **这是我的产品功能（矩阵包含二维数组元素）：

```
 template<typename T, unsigned int n, unsigned int m> template<unsigned int m2>
Matrix<T,n,m2> Matrix<T,n,m>::operator*(Matrix<T,m,m2>& M) {
    T prod[n][m2];
    if(n*m < GPUAccelerationThreshold)
        for(int i = 0; i < n; i++)
            for(int j = 0; j < m2; j++) {
                prod[i][j] = elems[i][0] * M(0, j); 
                for(int p = 1; p < m; p++)
                    prod[i][j] += elems[i][p] * M(p, j); 
            }
    else {
        array_view<T, 2> product(n, m2, *prod);
        array_view<T, 2> a(n, m, *elems);
        array_view<T, 2> b(m, m2, M.elems[0]);

        parallel_for_each(
            product.extent, 
             [=](index<2> idx) restrict(amp) {
                int row = idx[0];
                int col = idx[1];
                for (int inner = 0; inner < m; inner++) {
                    product[idx] += a(row, inner) * b(inner, col);
                }
            }
        );
        product.synchronize();
    }

    return Matrix<T,n,m2>(prod);
} 
```

我正在写这门课，因为我想在 GPU（使用 MS amp）上增强一些矩阵运算。我搜索了一个现有的解决方案，找到了 GPU 加速的线性代数库，但我在其中找不到一个带有 +、-、* 运算符的简单矩阵类。也许有人可以推荐我吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T15:38:12.287

三个快速评论：

*   传统上，`Matrix`类使用动态分配。您不显示您的`Matrix`班级，但如果您的数据是：

    ```
    T myData[n][m];

    ```

    您可能希望将其更改为：

    ```
        std::vector myData;

    ```

    ，将其初始化为`n * m`构造函数中的大小，并计算其中的单个索引`operator[]`（如果您想进行任何边界检查，它应该返回一个代理）。或者，您可以使用`operator()( int i, int j )`访问元素：是否访问`myMatrix( i, j )`或 `myMatrix[i][j]`首选访问取决于您询问的人。尽管此解决方案略微增加了总内存使用量（但非常轻微），但它将堆栈占用量减少到几十个字节，而与矩阵的大小无关。
*   同样传统上，矩阵类没有将维度作为其模板参数的一部分。这是否是一件好事是有争议的。您可以使用您的解决方案获得更好的类型检查（以及编译时的错误，而不是运行时），但如果维度是构造函数的参数，而不是模板参数，您可以从命令行或配置文件或其他任何内容中读取它们. 这是经典的安全性与灵活性的权衡。关于您的问题，没有维度作为模板参数意味着所有类型的矩阵`T`都具有相同的类型。因此，您可以访问从成员函数返回的矩阵的内部，并且不再需要中间的`T prod[n][m2]`. 当然，你可以进行所有的实例化`Matrix`朋友，或者只是使用访问函数来设置值。无论如何，您*不*想要中间件`T prod[n][m2]`；这不仅需要大量的堆栈内存，还意味着您必须复制结果。
*   最后，这有点更高级：在最好的矩阵类中，`operator*`不返回矩阵，而是返回一个辅助类，类似于：template class MatrixMultiply { L const* myLhs; R 常量* myRhs; 公共：typedef T value_type；MatrixMultiply( L const& lhs, R const& rhs ) : myLhs( &lhs ) , myRhs( &rhs ) { } int getX() const { return myLhs->getX(); } int getY() const { return myRhs->getY(); } T get( int i, int j ) const { return calculateIJ( myLhs, myRhs ); } }; 然后，您提供一个模板化的构造函数和赋值运算符，它使用`getX()`,`getY()`和`get( i, j )`. 您的 `operator*`也是一个模板，它返回一个 `MatrixMultiply`： template MatrixMultiply operator*( L const& lhs, R const& rhs ) { return MatrixMultiply( lhs, rhs ); （请注意，如果`L::value_type`和`R::value_type`不相同，这将不会编译。这是您想要的，除了错误消息将很不明确。）结果是您实际上从未构建中间的临时矩阵。可以想象，上面的解决方案被大大简化了。您将需要额外的代码来处理错误，而且我认为并行化并不是微不足道的。但它避免了所有中间矩阵的构造，即使是复杂的表达式。（同样的技术也可以用在抽象基类上，比如说`MatrixAccessor`，用纯虚拟的 getter 和派生 `Matrix`所有的助手都喜欢`MatrixMultiply`它。恕我直言，这更具可读性，并且来自编译器的错误消息肯定会更容易理解。只要编译器实际内联所有成员函数，结果就会相同。但这是一个很大的*if*，因为可能存在重要的函数嵌套。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T14:59:09.797

没有简单的方法可以解决这个问题。您不能返回堆栈局部变量作为参考，因为当您返回时，变量“后面”的内存将消失。所以你必须在某个地方有一些专用的存储空间。它不一定来自新/删除，但在制作数据副本时确实需要某种存储。

一种解决方案当然是使用三操作数操作，所以不是：

```
a = b + c; 
```

你使用一个函数：

添加（a，b，c）；

其中 a、b 和 c 是引用。

它确实使代码变得更加混乱，但我想不出任何更明显的方法来解决问题 - 如果您不想编写自己的分配器/删除函数（或垃圾收集器）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-29T15:41:21.357

其实我不能完全理解你的想法......二元运算符需要两个参数并创建结果。事实上，您可以看到您正在返回一个新创建的对象。所以这是编写程序的唯一方法：分配内存，使用它，然后删除它。事实上，我什至不明白你的构造函数是做什么的。如果它只是将指针复制到“prod”，那么当您从函数返回时结果矩阵会被破坏，因为“prod”内存将在函数返回后立即被删除（因为它是在堆栈上创建的）。所以你也不能通过引用返回它。

我看到解决方案在矩阵构造函数中分配内存的方式。如果您根据矩阵大小将其制作为模板，则矩阵的大小可以从模板参数中得知（我发现制作以矩阵大小作为参数的模板很奇怪。这有什么意义？）。因此，您在构造函数中使用“new”分配内存，并在析构函数中使用“delete”将其删除。因此，该内存将根据在 OOP 中运行良好的 RAII 方法进行分配。然后您实现诸如 setElement(i, j, value) 之类的方法，并在二元运算符中将元素设置在新创建的矩阵中并返回它。

有一些问题，但是我希望你照顾。复制构造函数必须真正复制矩阵而不仅仅是一个指针（或者几个析构函数会尝试破坏相同的内存），或者您可以编写“延迟复制”模型，在更改时实际复制矩阵（参见 wiki）。或者您可以在不实现的情况下将复制构造函数设为私有（以完全防止复制）。如果由于您不希望库的用户更改矩阵值而不允许创建诸如“setElement”之类的方法，则可以访问私有数据和方法（即使在我们作为参数或新创建的对象中） ) 在此类运算符中，因为您在类方法中。

如果您需要将原始指针传递给其他计算函数，就像在“else”部分完成的那样，您可以从只复制一个指针的指针创建一个构造函数（但这是危险的方式。如果您传递一个指针，则不能访问它无处可去，因为矩阵类现在是老板）或完全复制数据（速度较慢，但​​您可以根据您的意愿从堆栈中传递指针或需要控制的指针），并且析构函数将在矩阵破坏时清除它。或者您甚至可以创建私有方法，例如“getRawMatrix()”，它将从矩阵返回指向数据的原始指针并将此指针传递给您的计算函数，或者甚至简单地获取原始数据指针，因为您在矩阵类的方法中.

通常您在构造函数中分配内存并制作“惰性复制”模型，因为矩阵可能很大。允许在类内部访问私有数据和成员，这就是类的创建。我希望它会有用..**

# glsl - shader - CG/GLSL/HLSL 如何实现抖动

> ID：14082752
> 
> 赞同：0
> 
> 时间：2012-12-29T14:47:50.593
> 
> 标签：glsl, shader, hlsl, sampling, cg

在计算机图形学中，将抖动应用于采样位置以避免可见的采样模式是一种常见的技术。

将抖动应用于片段着色器中的采样位置的正确方法是什么？我能想到的一种方法是将噪声纹理输入着色器，然后根据该噪声纹理的 texlvalue 更改任何想要采样的采样位置。

有没有更好的方法来实现抖动？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T10:52:32.130

各种硬件驱动程序 AA 方案通常已经基于抖动——每个供应商都有自己喜欢的模式。不幸的是，用户/玩家经常会弄乱设置并打开和关闭东西。

这可能会让你认为没有“正确”的方法——你是对的！有一些方法，其中一些对于某些任务是正确的。学习和使用你喜欢的东西。

对于表面纹理抖动，您可以尝试以下操作：

1.  在 Photoshop 中，制作一个 256x512 rgb 图像（或 256x511，对于某些版本的 NVIDIA DDS 导出器），用随机噪声填充它，用“使用现有的 mip 贴图”保存为 DDS。无论纹理缩放多少（至少在许多有用的大小范围内），这都会为您提供大致均匀的噪声。

2.  在您的着色器中，读取噪声纹理，然后将其应用于 UV，然后读取您的其他纹理，例如

    float4 噪声 = tex2D(noiseSampler,OriginalUV);

    float2 newUV = OriginalUV + someSmallScale*(noise.xy-0.5);

    float4 jitteredColor = tex2D(colorSampler,newUV);

根据需要尝试其他变体。请注意，强烈的纹理抖动会导致大量纹理缓存未命中，这可能会降低性能，并且在法线贴图周围要小心，因为您会将高频分量引入已经过滤的信号中。

# ios - 查看定位问题

> ID：14082753
> 
> 赞同：0
> 
> 时间：2012-12-29T14:47:53.740
> 
> 标签：ios, view

我的 ViewController 的 View 有几个子视图。在用户的操作中，我添加了更多的子视图，并尝试修改所有子视图的位置。只有新添加的子视图的位置在变化，旧的没有。

如果我更改旧子视图的位置而不将新子视图添加到我的视图中，一切都会按预期工作。

我也试过改变它们的尺寸。这似乎奏效了。问题只是位置。

有人遇到过类似的问题吗？提前致谢！

**编辑：**

我已经尝试通过改变中心和改变框架的原点。

```
[UIView animateWithDuration:3
                      delay:0
                    options:UIViewAnimationOptionCurveEaseInOut
                 animations:^{
                     for (UIView *view in self.oldSubviews) {
                         view.center = center1;
                     }
                     for (UIView *view in self.newSubviews) {
                         view.center = center2;
                     }
                 } completion:^(BOOL finished) {
                 }]; 
```

当`newSubviews`未将视图中的视图添加为子视图时，一切都很好。我已经打印了数组，`self.view.subviews`新旧子视图之间没有明显的区别。

这是我对框架的尝试：

```
for (UIView *view in self.oldSubviews) {
     CGRect frame = view.frame;
     frame.origin = CGPointZero;
     frame.size = CGSizeMake(150, 300);
     view.frame = frame;
} 
```

它们的大小已更改，但不会移动到左上角。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T05:54:42.493

好的，发现问题了，我猜。我在 viewWillLayoutSubviews 方法中做了一些设置。我不知道，它是在您添加一些子视图后调用的。谢谢您的帮助

# clojure - 如何改进这个 Enlive 模板？

> ID：14082758
> 
> 赞同：1
> 
> 时间：2012-12-29T14:48:56.267
> 
> 标签：clojure, enlive

我使用这个 Enlive 模板将它下面的 HTML 转换为下面的 HTML。基于一组 twitter 名称，我生成了一个带有链接的表。我怎样才能摆脱里面的打嗝`enlive/clone-for`？

```
(enlive/deftemplate usernames-table-body
  "public/whoisnotfollowingme.html"
  [usernames]
  [:table.names :tbody :tr]
  (enlive/clone-for [username usernames]
                    [:td]
                    (enlive/html-content
                     (html [:a {:href (str "https://twitter.com/intent/user?screen_name=" username)} username])))) 
```

HTML 输入

```
<!DOCTYPE html>
<html>
  <head>
    <link rel="stylesheet" href="/bootstrap/css/bootstrap.css"/>
  </head>
  <body>
    <script type="text/javascript" src="//platform.twitter.com/widgets.js"></script>
    <div class="container">
      <div class="hero-unit">
        <p class="names">These people who you are following are not following you back!</p>
      </div>
      <table class="names table table-striped">
        <thead>
          <tr>
            <th>Username</th>
          </tr>
          </thead>
          <tbody>
            <tr>
              <td>name</td>
            </tr>
          </tbody>
      </table>
    </div>
  </body>
</html> 
```

HTML 输出

```
<html> 
   <head>
    <link href="/bootstrap/css/bootstrap.css" rel="stylesheet" />
  </head> 
   <body> 
     <script src="//platform.twitter.com/widgets.js" type="text/javascript"></script> 
     <div class="container"> 
       <div class="hero-unit">
        <p class="names">These people who you are following are not following you back!</p>
      </div> 
       <table class="names table table-striped"> 
         <thead>
          <tr>
            <th>Username</th>
          </tr>
          </thead> 
           <tbody> 
             <tr> 
               <td> < a   href =" https://twitter.com/intent/user?screen_name=foo " > foo </ a > </td> 
             </tr> <tr> 
               <td> < a   href =" https://twitter.com/intent/user?screen_name=bar " > bar </ a > </td> 
             </tr> 
           </tbody> 
       </table> 
     </div> 
   </body> 

 </html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T18:32:23.883

您可以从以下位置更改 tbody.tr 模板：

```
<tr>
  <td>name</td>
</tr> 
```

至：

```
<tr>
  <td><a href="https://twitter.com/intent/user?screen_name=foo">foo</a></td>
</tr> 
```

现在您的 HTML 资源是您想要的输出的一个工作示例。

然后修改您的 deftemplate 以支持它：

```
(enlive/deftemplate usernames-table-body
  "public/whoisnotfollowingme.html"
  [usernames]

  [:table.names :tbody :tr]
  (enlive/clone-for [username usernames]
                    [:td :a]
                    (enlive/do->
                     (enlive/set-attr :href (str "https://twitter.com/intent/user?screen_name=" username))
                     (enlive/content username)))) 
```

编辑：如果您想摆脱代码中的 URL，请尝试将您的 href 更改为 ?screen_name= ，然后将代码修改为：

```
 (enlive/do->
                     (fn [node] (update-in node [:attrs :href] #(str % username)))
                     (enlive/content username)))) 
```

你也可以利用它。参见例如[附加到 Enlive 中的属性](https://stackoverflow.com/questions/12586849/append-to-an-attribute-in-enlive)。

# java - Elastic Beanstalk (AWS) 的休眠配置

> ID：14082759
> 
> 赞同：1
> 
> 时间：2012-12-29T14:49:05.197
> 
> 标签：java, hibernate, amazon-web-services, amazon-elastic-beanstalk, hibernate.cfg.xml

我正在使用**Hibernate**开发 Java 应用程序。我想将它部署在**Elastic Beanstalk**（亚马逊网络服务）上，以便能够相应地扩展。

RDS 是我要使用的数据库。

但是，我不知道如何将我的配置设置提供给 Elastic Beanstalk。显然，现在可以，无需创建 AMI 并将此 AMI 用于每个新服务器（自动缩放时）。

我用 ：

*   休眠.cfg.xml
*   server.xml（链接到 hibernate.cfg.xml）

但我想轻松扩展，所以没有“EC2 实例的手动配置”来输入这些文件。那么如何在没有这两个文件的情况下将这些设置提供给我的应用程序呢？

如何使用这些信息在 Elastic Beanstalk 上进行部署？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T15:54:16.767

Amazon Relational Database Service (RDS) 是一种用于在云中设置关系数据库的 Web 服务。RDS支持MySQL、Oracle、SqlServer等关系型数据库引擎。对于 MySQL，更改 hibernate.cfg.xml 如下

```
<session-factory>
    <property name="dialect">org.hibernate.dialect.MySQLInnoDBDialect</property>
    <property name="connection.driver_class">com.mysql.jdbc.Driver</property>
    <property
name="connection.url">jdbc:mysql://my_sports_entertainment_db_url/news</property>
    <property name="connection.username">my_username</property>
    <property name="connection.password">my_password</property>
  </session-factory> 
```

另请查看[如何以最小的应用程序影响从 MySQL“切换”到 Amazon RDS？](https://stackoverflow.com/questions/1887438/how-to-switch-from-mysql-to-amazon-rds-with-minimal-application-impact)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T19:38:00.737

我可以看到一种方法来做到这一点，但它并不漂亮。

您的实例配置文件可以包含[容器命令](http://docs.aws.amazon.com/elasticbeanstalk/latest/dg/customize-containers-ec2.html#customize-containers-format-container_commands)。它们在容器和应用程序安装之后、应用程序启动之前运行。此时，可以编辑 Tomcat`context.xml`文件以添加数据源。您需要添加的文本是[通常的数据源配置](http://tomcat.apache.org/tomcat-7.0-doc/jndi-resources-howto.html#JDBC_Data_Sources)。您的问题是您必须从脚本中执行此操作。最简单的事情可能是编写配置并将其与您的应用程序一起交付，然后使用容器命令应用强大的[sed](http://www.grymoire.com/Unix/Sed.html)将其拼接到`context.xml`.

您还有一个问题，即您需要编写的实际配置必须包括诸如 RDS 的主机名、用户名和密码之类的内容，而在开发过程中您将不会拥有这些内容。[AWS 确实通过系统属性](http://docs.aws.amazon.com/elasticbeanstalk/latest/dg/create_deploy_Java.rds.html#create_deploy_Java.rds.newDB)将这些暴露给 Java ，因此信息必须在机器上的某个地方。如果你能找到它，你可以在拼接到`context.xml`.

虽然这可能是可能的，但正如我所说，它并不漂亮。感觉就像一个黑客。必须有更好的方法来做到这一点。

# windows - 在 Windows 上从源代码构建 CompassApp（jruby 应用程序）可执行文件

> ID：14082763
> 
> 赞同：1
> 
> 时间：2012-12-29T14:49:21.123
> 
> 标签：windows, build, rubygems, jruby, compass-sass

我想构建**CompassApp**的可执行文件，这是一个 GUI 应用程序，它允许网页设计师使用 SASS 和 Compass 编译样式表，而无需使用命令行。

可以在 GitHub 上找到源代码：[https](https://github.com/handlino/CompassApp) ://github.com/handlino/CompassApp 。

CompassApp 是一个用**Jruby**开发的应用程序。

从项目的 GitHub 网页：

> 如果要构建自己的副本，则需要**JRuby**和**rawr**

我正在使用 Windows 7 作为我的网页设计项目的操作系统。我从未从源代码构建过 jruby 应用程序。似乎在 linux 上安装所需的东西更容易，反正我现在使用的是 Windows。

首先，我克隆了 GitHub 存储库。

然后我安装了jruby。

现在我应该安装 rawr ( [https://github.com/rawr/rawr](https://github.com/rawr/rawr) )

看来rawr也需要**javac**和**rake**

我看到 rawr 和 rake 是 2 颗红宝石。

1.  那么如何在**Windows**上为 jruby 安装这 2 个 ruby​​ gem ？
2.  在我拥有所需的一切之后，如何从源代码构建 CompassApp？

> 我需要从安装需求到构建应用程序的分步指南。

（我过去从未使用过 jruby）。

如果你们中的某个人在 jruby 中开发应用程序，我认为这可以很容易地帮助我。

我提前谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T19:49:19.157

我正在尝试做类似的事情，但在我的情况下，只将 gem 打包在一个独立的可执行 jar 中。文档的描述性不是很好，有些已经过时了。

我尝试了rawr，但设法与[莺走得更远](https://github.com/jruby/warbler)

这是我所做的：我创建了一个名为 jrcompass 的文件夹并将 compass 安装到其中：

```
c:\test\jrcompass>%JRUBY%\jruby -S gem install compass -i . 
```

我安装了 warbler，然后在该文件夹中运行 warble 命令：

```
C:\test\jrcompass>c:\apps\jruby\bin\jruby -S warble 
```

它创建了一个名为 jrcompass.jar 的 ~20MB jar 文件，它比我使用 rawr 得到的要远。

现在我正在尝试使用以下命令执行 jar：

```
C:\test\jrcompass>java -jar jrcompass.jar 
```

我在下面收到以下错误。我希望这会帮助你取得进步。如果你弄清楚了，请告诉我。

```
Gem::LoadError: Could not find compass (>= 0) amongst [rake-0.9.2.2]
to_specs at jar:file:/C:/Users/Admin/AppData/Local/Temp/jruby1564362137331239458extract/jruby-stdlib-1.7.1.jar!/META-INF/jruby.home/lib/ruby/shared/rubygems/dependency.rb:247
to_spec at jar:file:/C:/Users/Admin/AppData/Local/Temp/jruby1564362137331239458extract/jruby-stdlib-1.7.1.jar!/META-INF/jruby.home/lib/ruby/shared/rubygems/dependency.rb:256
   gem at jar:file:/C:/Users/Admin/AppData/Local/Temp/jruby1564362137331239458extract/jruby-stdlib-1.7.1.jar!/META-INF/jruby.home/lib/ruby/shared/rubygems.rb:1231
(root) at file:/C:/Apps/test/jrcompass/jrcompass.jar!/jrcompass/bin/compass:22
  load at org/jruby/RubyKernel.java:1046
(root) at file:/C:/Apps/test/jrcompass/jrcompass.jar!/META-INF/main.rb:1
require at org/jruby/RubyKernel.java:1027
(root) at file:/C:/Apps/test/jrcompass/jrcompass.jar!/META-INF/main.rb:1
(root) at jar:file:/C:/Users/Admin/AppData/Local/Temp/jruby1564362137331239458extract/jruby-stdlib-1.7.1.jar!/META-INF/jruby.home/lib/ruby/shared/rubygems/custom_require.rb:1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-29T15:57:46.013

@Fabio 嗨，我们制作了 Compass.app 和 Fire.app :-)

在 OS X 或 Linux 上构建 Compass.app 很容易。我们在 GitHub wiki 上有一个（几乎）关于构建 Fire.app 的分步指南，它也可以应用于[Compass.app：https://github.com/handlino/FireApp/wiki](https://github.com/handlino/FireApp/wiki)

我们从未尝试在 Windows 上构建它，也不认为它可以轻松完成。

# debugging - 使用 WDK 8.0 编译的 FileSystem MiniFilter 驱动程序不显示 DbgPrint 输出（DbgView/Win7 32 位）

> ID：14082764
> 
> 赞同：2
> 
> 时间：2012-12-29T14:49:22.060
> 
> 标签：debugging, driver, wdk, debugview, minifilter

我使用适用于 Windows 7 32 位的 WDK 7.0 构建实用程序编写并编译了一个微过滤器驱动程序。然后我使用 OSR 的驱动程序加载实用程序将它安装在运行在 VMWare 上的 Windows 7（32 位）机器上。当我运行 DbgView 时，我可以准确地看到 DbgPrint 输出。

然后我使用集成在 Microsoft Visual Studio Pro 2012 for Windows 7（32 位）中的 WDK 8.0 编译了相同的驱动程序。结果创建了 3 个文件，一个 sys、cat 和 inf 文件。我在 VMWare 上运行的 Windows 7（32 位）机器上安装了驱动程序，方法是右键单击 inf 文件并选择“安装”。然后我从启动正常的命令提示符启动服务。但即使它是相同的代码/驱动程序，我也无法从使用 WDK 8.0/VS2012 Pro 编译的驱动程序中看到 DbgView 中的 DbgPrint 输出。以下是实际执行打印的代码（IRP_MJ_CREATE 的后操作回调函数）：

```
FLT_POSTOP_CALLBACK_STATUS CreateFilePostOpCallback(__in PFLT_CALLBACK_DATA Data, __in PCFLT_RELATED_OBJECTS FltObjects,
                                                    __in_opt PVOID CompletionContext, __in FLT_POST_OPERATION_FLAGS Flags)
{
    PFLT_FILE_NAME_INFORMATION fileNameInfo;
    NTSTATUS status;

    UNREFERENCED_PARAMETER(FltObjects);
    UNREFERENCED_PARAMETER(CompletionContext);
    UNREFERENCED_PARAMETER(Flags);

    status = FltGetFileNameInformation(Data, FLT_FILE_NAME_NORMALIZED|FLT_FILE_NAME_QUERY_DEFAULT, &fileNameInfo);

    if(!NT_SUCCESS(status))
        return FLT_POSTOP_FINISHED_PROCESSING;

    FltParseFileNameInformation(fileNameInfo);

    DbgPrint("%wZ created/opened", &fileNameInfo->Name);

    FltReleaseFileNameInformation(fileNameInfo);

    return FLT_POSTOP_FINISHED_PROCESSING;
} 
```

我在这里想念什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-01T07:59:10.867

在 vista 及更高`DbgPrint`版本中，默认情况下会屏蔽消息。

在你的 WinDbg 提示符下试试这个

```
ed Kd_DEFAULT_Mask 8 
```

有关更多详细信息，请参阅此问题[Kernel trace Windows 7 WinDbg](https://stackoverflow.com/questions/4734335/kernel-trace-windows-7-windbg)或本文[DbgPrint in vista and later](http://www.osronline.com/article.cfm?article=295)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-04T09:58:09.813

您是否尝试过为 Windows 8/Windows server 2012 使用 WDK 8 进行编译

对于使用 WinDDK 编译的 Windows 7，调试打印工作，但对于 Windows 8/Server 2012，它必须使用 WDK 8 编译并且调试信息不​​打印。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-01-26T19:02:58.387

或者，您可以简单地编写一个默认启用它们的小 reg 脚本。有问题的注册表项是：

1.  **HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\Debug 打印过滤器**
2.  值：**默认**
3.  数据：**0x8**

还要检查[这个](https://docs.microsoft.com/en-us/windows-hardware/drivers/devtest/reading-and-filtering-debugging-messages)。

# android - Android 不显示 ProgressDialog

> ID：14082769
> 
> 赞同：0
> 
> 时间：2012-12-29T14:50:03.650
> 
> 标签：android, android-asynctask, android-progressbar

我试图在加载 Activity 时显示 ProgressDialog，但它没有显示出来。

*这是在 Activity onCreate*上调用的方法

 *```
 private void loadBuilding(String[] b) {

        ProgressDialog pd = new ProgressDialog(this);
        pd.setProgressStyle(ProgressDialog.STYLE_HORIZONTAL);
        pd.setMax(6);

        pd.setTitle(R.string.loading);

        pd.show();

        LoadBuilding lb = new LoadBuilding();
        lb.initialize(this,  pd);

        lb.execute(b);

        try {
              lb.get();
        } catch (Exception e) {
              e.printStackTrace();
        } 

        pd.dismiss();

        if (building == null) 
              showError();
  } 
```

LoadBuilding是一个*AsyncTask ，**我*在其中加载建筑物并设置进度。

 *谢谢大家。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T15:08:54.320

## 使用 AsyncTask 进行后台处理和在前台更新进度。我认为这最适合您的任务。

```
private class DownloadFilesTask extends AsyncTask<URL, Integer, Long> {
 protected Long doInBackground(URL... urls) {
     int count = urls.length;
     long totalSize = 0;
     for (int i = 0; i < count; i++) {
         totalSize += Downloader.downloadFile(urls[i]);
         publishProgress((int) ((i / (float) count) * 100));
         // Escape early if cancel() is called
         if (isCancelled()) break;
     }
     return totalSize;
 }

 protected void onProgressUpdate(Integer... progress) {
     setProgressPercent(progress[0]);
 }

 protected void onPostExecute(Long result) {
     showDialog("Downloaded " + result + " bytes");
 }
} 
```

尝试在 try and catch 块中添加您的 progressDismiss()

```
try
 {
   pg.dismiss();
  }
Catch()
{
 } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T14:58:12.057

问题是**progressDialog.dismiss()**必须在：

*   代码中显示的try/catch 的**捕获**
*   AsyncTask的**onPostExecute**方法。

此外，我使用的数据太少进行测试，所以它的上升和下降太快了。**

# java - 如何在java中复制粘贴和剪切粘贴文件或文件夹？

> ID：14082770
> 
> 赞同：3
> 
> 时间：2012-12-29T14:50:03.930
> 
> 标签：java, swing, copy, paste

我用netbeans平台用java制作了一个桌面应用程序。在我的应用程序中，我想为文件或文件夹提供单独的复制粘贴和剪切粘贴选项。

那么我该怎么做呢？我试过了`Files.copy(new File("D:\\Pndat").toPath(),new File("D:\\212").toPath(), REPLACE_EXISTING);`。但我没有得到确切的输出。

如果还有其他选择，那么建议我。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T15:10:43.403

在“剪切粘贴”的情况下，您可以`renameTo()`这样使用：

```
File source = new File("////////Source path");
File destination = new File("//////////destination path");

if (!destination.exists()) {
    source.renameTo(destination);
} 
```

在“复制粘贴”的情况下，您需要读取输入和输出流。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-30T09:05:43.560

使用来自 apache io 的 FileUtils 并[执行](http://commons.apache.org/io/api-release/index.html?org/apache/commons/io/package-summary.html)`FileUtils.copyDirectory(sourceDir, destDir);`

**还可以进行以下文件操作**

*   写入文件
*   从文件中读取
*   创建一个包含父目录的目录
*   复制文件和目录
*   删除文件和目录
*   与 URL 相互转换
*   按过滤器和扩展名列出文件和目录
*   比较文件内容
*   文件上次更改日期

[apache i/o jar 的下载链接](http://commons.apache.org/io/download_io.cgi)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-28T01:21:56.367

我认为这个问题与使用系统剪贴板复制 Java 应用程序中指定的文件以及使用操作系统“粘贴”功能将文件复制到文件夹有关。这是一个简短的说明性示例，它将向您展示如何将单个文件添加到操作系统剪贴板，以便稍后执行操作系统“粘贴”功能。根据需要进行调整并根据需要添加错误/异常检查。

作为辅助，此代码还将文件名放在剪贴板上，以便您可以将文件名粘贴到文档编辑器中。

```
package com.example.charles.clipboard;

import java.awt.Toolkit;
import java.awt.datatransfer.Clipboard;
import java.awt.datatransfer.ClipboardOwner;
import java.awt.datatransfer.DataFlavor;
import java.awt.datatransfer.Transferable;
import java.io.File;
import java.io.FileNotFoundException;
import java.util.ArrayList;
import java.util.List;

public class JavaToSystemClipboard {

public static void main(final String[] args) throws Exception {
    final File fileOut = new File("someFileThatExists");
    putFileToSystemClipboard(fileOut);

}

public static void putFileToSystemClipboard(final File fileOut) throws Exception {
    final Clipboard clipboard = Toolkit.getDefaultToolkit().getSystemClipboard();
    final ClipboardOwner clipboardOwner = null;

    final Transferable transferable = new Transferable() {
        public boolean isDataFlavorSupported(final DataFlavor flavor) {
            return false;
        }
        public DataFlavor[] getTransferDataFlavors() {
            return new DataFlavor[] { DataFlavor.javaFileListFlavor, DataFlavor.stringFlavor };
        }
        public Object getTransferData(final DataFlavor flavor) {
            if (flavor.equals(DataFlavor.javaFileListFlavor)) {
                final List<String> list = new ArrayList<>();
                list.add(fileOut.getAbsolutePath());
                return list;
            }
            if (flavor.equals(DataFlavor.stringFlavor)) {
                return fileOut.getAbsolutePath();
            }
            return null;
        }
    };
    clipboard.setContents(transferable, clipboardOwner);
}
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-30T08:34:11.420

**您可以使用FileOutputStream**和**FileInputStream**自己编写内容，也可以使用**Apache Camel**。

# java - 在 JAVA 中读取数组后，我无法打印数组

> ID：14082772
> 
> 赞同：-3
> 
> 时间：2012-12-29T14:50:08.083
> 
> 标签：java, printing

读取数组后，我在打印数组时遇到问题。打印后，打印的是内存地址，而不是数组的值。我能做些什么呢？

```
public class MyClass
{
     Student St = new Student();

     Student[]Array1 = new Student[10];

     void AddList()
     {

            Scanner Scan = new Scanner(System.in);

            for (int i=0; i<Array1.length & i<ArrayF1.length; i++)
            {
                System.out.println("Enter Student NAME Number " + (i+1) + ":");
                Array1[i] = new Student();
                Array1[i].setName(Scan.next());

                //System.out.println("Enter Student MARK Number " + (i+1) + ":");
                //St.setMark(Scan.nextFloat());
            }

    } 
```

这是我的打印方法。打印的结果是这样的

(studentproject.Student@1a758cb)

```
 void PrintList()
 {

            for (int i=0; i<Array1.length; i++)
            {

                System.out.println(Array1[i]);

            }
 } 
```

这是我的学生类，我有我所有的 setter 和 getter 方法......所以我有 3 个类，我如何使用这 3 个类，其中一个获取数据，另一个打印标记数据，第三个类打印学生姓名数据...我该怎么做...我做了一些代码，但我不知道它是否正确...谢谢您的帮助...

```
public class Student
{
private String Name;
private float Mark;

/**
 * @return the Name
 */
public String getName() {
    return Name;
}

/**
 * @param Name the Name to set
 */
public void setName(String Name) {
    this.Name = Name;
}

/**
 * @return the Mark
 */
public float getMark() {
    return Mark;
}

/**
 * @param Mark the Mark to set
 */
public void setMark(float Mark) {
    this.Mark = Mark;
}

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T14:51:06.007

只需覆盖类中的`toString()`方法`Student`，并在打印实例时返回要打印的适当字符串。

它可能看起来像： -

```
@Override
public String toString() {
    return "Name: " + studentName;
} 
```

`toString()`目前，调用类方法的默认实现，`Object`您看到的是从该方法返回的格式，其形式为 -`Type@hashCode`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T15:06:26.717

在这里，我添加了一些如何`toString()`覆盖方法的内容

```
public class Student {

    private String name;
    private int id;
    float mark;

    public Student() {
    }

    public Student(String name, int id) {
        this.name = name;
        this.id = id;
    }

    public int getId() {
        return id;
    }

    public void setId(int id) {
        this.id = id;
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    public float getMark() {
        return mark;
    }

    public void setMark(float mark) {
        this.mark = mark;
    }

    @Override
    public String toString() {
        return "Student[ID:" + id + ",Name:" + name + ",Mark:"+mark+"]";
    }

    public void printStudentInfo() {
        // print all the details of student
    }
    public static void main(String[] args) {
        Student[] students = new Student[10];
        Scanner scanner = new Scanner(System.in);

        for (int i = 0; i < students.length; i++) {
            System.out.println("Enter Student Name " + (i + 1) + ":");
            String name = scanner.nextLine();
            Student student = new Student(name, i + 1);
            System.out.println("Enter Student MARK Number " + (i + 1) + ":");
            float mark = scanner.nextFloat();
            student.setMark(mark);
            students[i]=student;
        }
        for(Student student:students) {
            // by default toStirng method is called
            System.out.println(student);
            //or you can call like
            //student.printStudentInfo();
        }
    }
} 
```

# objective-c - ObjectiveC 块和变量

> ID：14082775
> 
> 赞同：2
> 
> 时间：2012-12-29T14:50:16.957
> 
> 标签：objective-c, ios, objective-c-blocks

我有以下方法可以从我的 iOS 应用程序（使用 Restkit）进行 Web 服务调用...

```
BOOL valid = NO;

RKObjectManager *objectManager = [RKObjectManager sharedManager];
NSString *servicePath = [WebServiceHelper pathForServiceOperation:[NSString stringWithFormat:@"/security/isSessionValid/%@", username]];
[objectManager getObjectsAtPath:servicePath parameters:nil success:^(RKObjectRequestOperation *operation, RKMappingResult *mappingResult) {
    BooleanServiceResponse *resp = [mappingResult firstObject];
    valid = resp.value;
} failure:^(RKObjectRequestOperation *operation, NSError *error) {
    NSLog(@"Error while validating session for user %@ : %@", username, error);
}];

return valid; 
```

但是，我在变量上得到一个错误`valid`，说它是在块外声明的并且不可分配。我用谷歌搜索了一下，发现了一个我这样声明有效的建议......

```
__block BOOL valid = NO; 
```

这摆脱了错误。但是，我发现无论我`valid`在我的块中设置什么值，退出块时都没有正确设置。如何设置此值以便我的方法返回预期值？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-29T14:57:22.593

我想你不明白积木是如何工作的。这不是可变可见性的问题，尽管`__block`是正确的。

您的 block 是一个异步执行的函数，因此无论何时执行该 block`valid`都会设置为`resp.value`，这很可能发生在您的 return 语句之后。

您需要更改您的设计，因为到目前为止您正在返回一个不能保证设置的对象。

**编辑**

例子

```
- (void)didFinishValidation:(BOOL)valid {
   // Do whatever you like with the `valid` value
   if (valid) {
     //...
   } else {
     //...
   }
} 
```

你的积木变成

```
[objectManager getObjectsAtPath:servicePath parameters:nil success:^(RKObjectRequestOperation *operation, RKMappingResult *mappingResult) {
    BooleanServiceResponse *resp = [mappingResult firstObject];
    valid = resp.value;
    [self didFinishValidation:valid];
} failure:^(RKObjectRequestOperation *operation, NSError *error) {
    NSLog(@"Error while validating session for user %@ : %@", username, error);
}]; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-29T14:53:08.830

通常，需要将变量定义为 __block 以便从块中对其进行变异。这里的问题是在调用块之前调用了“return” - 处理这种情况的最佳方法不是将此方法定义为 - (BOOL)... 而是定义为 - (void)... 并返回通过委托或块回调结果异步。

# android - 拨打android电话并从edittext框中获取号码

> ID：14082779
> 
> 赞同：1
> 
> 时间：2012-12-29T14:50:55.483
> 
> 标签：android, phone-call

从edittext获取号码时如何拨打电话？我试试这个，但它不起作用。我有一个问题，将变量号传递给 Uri.parse() 必须在 gettext 的 void 内？

```
public String string;
public String number;
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

     EditText txtcallnumber;
     txtcallnumber = (EditText)findViewById(R.id.callnumber);
     string = txtcallnumber.getText().toString().trim();//There no work call
       number = "tel:" + string;

    Button button = (Button) findViewById(R.id.button1);
    button.setOnClickListener(new OnClickListener() {

        public void onClick(View v) {
          call();
        }
      });
}

public void call() {
try {
   Intent callIntent = new Intent(Intent.ACTION_CALL);
    //callIntent.setData(Uri.parse("tel:xxxxxxx")); //This work
    string = txtcallnumber.getText().toString().trim();
       number = "tel:" + string;//There work call
    callIntent.setData(Uri.parse(number));
    startActivity(callIntent);

} catch (ActivityNotFoundException activityException) {
     Log.e("helloandroid dialing example", "Call failed");
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T17:00:00.597

在 onCreate 方法中不需要：

```
 string = txtcallnumber.getText().toString().trim();
 number = "tel:" + string; 
```

因为 onCreate 几乎用于设置显示，并且在设置屏幕之前用户不会输入，但是在输入文本并按下按钮后的 onCall 方法中，它会......你知道的。

另外你应该有这个来检查没有输入：

```
if(string!=null){
  try{try {
Intent callIntent = new Intent(Intent.ACTION_CALL);

string = txtcallnumber.getText().toString().trim();
   number = "tel:" + string;
startActivity(new Intent(Intent.ACTION_CALL, Uri.parse(number)));

} catch (ActivityNotFoundException activityException) {
 Log.e("helloandroid dialing example", "Call failed");

      }}else{
    Log.d("helloandroid dialing example","nothing entered");} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T14:59:50.497

您需要在清单文件中添加权限::

```
<uses-permission android:name="android.permission.CALL_PHONE"> 
```

在您的 call() 方法中尝试使用这些 Intent::

```
number=edittext.getText().trim();
no="tel:"+number;

startActivity(new Intent(Intent.ACTION_CALL, Uri.parse(no))); 
```

# file-upload - Uploadify 在将文件直接保存到 Amazon S3 时给出 HTTP 错误 (403)

> ID：14082780
> 
> 赞同：0
> 
> 时间：2012-12-29T14:51:03.407
> 
> 标签：file-upload, amazon-s3, uploadify, http-status-code-403

这是我的[Uploadify](http://www.uploadify.com)的以下代码，用于将文件直接上传到[Amazon S3](http://aws.amazon.com/s3/)：

```
<html>
     <head>
          <link rel="stylesheet" href="uploadify.css" type="text/css" media="screen" />
          <script type="text/javascript" src="http://code.jquery.com/jquery-1.7.2.min.js"></script>
          <script type="text/javascript" src="jquery.uploadify-3.1.min.js"></script>
          <script type="text/javascript">
             $(function() {
                    $('#file_upload').uploadify({
                        'requeueErrors' : true,
                        'fileDataName'  : 'file',
                        'method'        : 'post',
                        'formData'      : { 
                                            'key': 'uploads/${filename}', 
                                            'AWSAccessKeyId': 'xxxxxxxxxxxxxxxxxxx',    
                                            'bucket': 'mybucket', 
                                            'acl': 'authenticated-read', 
                                            'policy': 'xxxxxxxxxxxxxxxxx', 
                                            'signature': 'xxxxxxxxxxxxx', 
                                             'Content-Type': 'text' 
                                           },
                         'fileObjName'  : 'file',
                         'cancelImg'    : 'cancel.png',
                         'uploader'     : 'http://mybucket.s3.amazonaws.com',
                         'swf'          : 'uploadify.swf',
                         'auto'         : false,
                         'fileType'     : 'text',
                         'onUploadStart': function(file)
                                           {
                                                console.log('Attempting to upload: ' + file.name);
                                            },
                         'onUploadSuccess': function(file, data, response)
                                            {
                                                 alert('The file was saved to: ' + data);
                                            }
                       });
              });
          </script>
    </head>

    <body>
       <form>
           <p><input type="file" name="file_upload" id="file_upload" /></p>
           <p><a href="javascript:$('#file_upload').uploadify('upload')">Upload Files</a></p>
        </form>
    </body>
 </html> 
```

当我尝试将文件上传到[Amazon S3](http://aws.amazon.com/s3/)时，出现以下错误：**HTTP 错误 (403)** 请帮助解决代码中的问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T09:08:03.327

我有同样的问题并使用以下方法解决。

1.  我正在使用ubuntu，所以使用wireshark我发现了s3返回的错误xml。这个错误让我们知道出了什么问题。
2.  错误告诉我 acl 已经在策略文档中，所以它不应该是 n formData。检查你是否有相同的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T11:50:56.233

我也在使用uploadify在Amazon S3上上传文件，我建议你尝试实施我的策略

首先，我使用uploadify在我的服务器上上传文件，然后将它们上传到Amazon S3，上传后我从我的服务器中删除上传的文件，这是一种简单的方法

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-17T14:07:46.870

**编辑：看起来我正在使用旧版本的uploadify，不确定我现在的答案有多准确。很快就会更新**

我正在为另一个问题寻求帮助，但我想我停下来帮助你一点。

我看到你在上传器参数中设置了亚马逊网址：

```
'uploader'     : 'http://mybucket.s3.amazonaws.com',
'swf'          : 'uploadify.swf', 
```

我有一些不同的东西可以完美地工作，我还在其他示例中看到上传程序链接到 uploadify.swf 和脚本到您希望上传的路径。

像这样：

```
'uploader'  : '/resources/js/uploadify/uploadify.swf',
'script'    : '<?php echo $uploadPath; ?>', 
```

上传路径变量是（在我的代码中）：

```
$uploadPath = 'http://s3.amazonaws.com/' . $bucket; 
```

这是我拥有的和有效的完整示例：

```
$('#file_mainfile').uploadify({
    'uploader'  : '<?php echo WPDEPOSIT_URL; ?>/resources/js/uploadify/uploadify.swf',
    'script'    : '<?php echo $uploadPath; ?>',
    'cancelImg' : '<?php echo WPDEPOSIT_URL; ?>/resources/images/cancel.png',
    'folder'    : '<?php echo $fileFolder; ?>',
    'auto'      : true,
    'fileExt'   : '*.zip',
    'buttonText': '<?php _e('Upload .zip', WPD_SHOPPER_NAME); ?>',
    'method'    : 'post',
    'fileDataName'  : 'file',
    'auto'          : 'true',
    'scriptData' : {
            "AWSAccessKeyId"                                : "<?php echo $amazonClass->AWS_ACCESS_KEY; ?>",
            "key"                       : "${filename}",
            "acl"                       : "public-read",
            "policy"                    : "<?php echo $policy; ?>",
            "signature"                 : "<?php echo $signature; ?>",
            "success_action_status"                         : "201",
            "key"                       : encodeURIComponent(encodeURIComponent("<?php echo $folder; ?>${filename}")),
            "fileext"                   : encodeURIComponent(encodeURIComponent("")),
            "Filename"                  : encodeURIComponent(encodeURIComponent(""))
    },
    'onError'     : function (event,ID,fileObj, response) {

    },
    'onComplete': function(event, ID, fileObj, response, data) {
            var filePath = $(response).find("location").text();
            displayMessage('success', 'file_mainfile', '<?php _e('Successfully uploaded to Amazon S3 server.', WPD_QA_NAME); ?>', filePath);
            window.wpds_thumbnail = filePath;

    }
}); 
```

我将所有内容上传到一个单独的文件夹中，这就是您在代码中看到文件夹变量的原因。

# objective-c - 如何在objective-c中正确处理AVAudioPlayer

> ID：14082781
> 
> 赞同：1
> 
> 时间：2012-12-29T14:51:04.237
> 
> 标签：objective-c, avfoundation, avaudioplayer, background-music

我正在开发小游戏，但背景音乐有问题。我`AVAudioPlayer`用来播放循环音乐。如下所示：

```
NSString *path = [[NSBundle mainBundle] pathForResource:@"background" ofType:@"ogg"];
NSError *error;

AVAudioPlayer *player = [[AVAudioPlayer alloc] initWithContentsOfURL:[NSURL URLWithString:path] error:&error];

NSLog(@"%@", [error description]);

[player setNumberOfLoops:-1];
player.delegate = self;
[player play]; 
```

我在`Supproting Files`文件`background.ogg`中`background.mp3`，`background.wav`没有人玩。它有什么问题？

当我`NSLog`用来打印描述错误时，我得到了：

```
Error Domain=NSOSStatusErrorDomain Code=1954115647 "The operation couldn’t be completed. (OSStatus error 1954115647.)" 
```

请帮忙。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-12-29T05:30:15.107

有时，只是因为您的音频文件的质量不符合它需要的采样率，例如采样率。请检查您的音频采样率是否低于 24kHz。我测试了一些音频，我发现当音频采样率高于 44kHz 时，它工作得很好，但是如果它低于 44kHz 和高于 22kHz，AudioToolbox 不能先播放声音，而 AVAudioPlayer 可以工作一些次。如果它低于 22kHz，它们都将无法播放这些音频文件。（我测试的这些音频文件格式只是“m4a”、“mp3”、“wav”）

顺便说一句，如果你想将低采样率的音频转换为 44kHz "m4a" 文件使用 iTunes，它也无法工作。不要在这上面浪费你的时间。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-12-29T15:13:14.453

那太容易了。还有一件事。当您使用例如时`NSTimer`，您必须`ivalidate`在某个地方使用它。当你使用时，`AVAudioPlayer`你必须`stop`在某个地方使用它。

```
[player stop]; 
```

# jquery - 使用 append() 添加元素时未注册元素的单击事件

> ID：14082783
> 
> 赞同：0
> 
> 时间：2012-12-29T14:51:06.863
> 
> 标签：jquery

> **可能重复：**
> [动态创建的元素上的事件绑定？](https://stackoverflow.com/questions/203198/event-binding-on-dynamically-created-elements)

我通过 if 语句添加了一些链接，如下所示：

```
if(jQuery.inArray(keywords[i].toLowerCase(), wordFilter) == -1) {
    $('p.suggestions').append('<a href="#" class="suggestion">' + keywords[i] + "</a> ");
} 
```

链接已正确添加。我使用这样的建议类注册每个链接的点击：

```
$('p.suggestions a').click(function(e) {
    e.preventDefault();
    t.add($(this).text());
}); 
```

当我在我的 html 文件中硬编码一个链接时，它工作正常，并且单击已注册并执行 t.add()。但是，当使用 if 语句添加链接时，它就不再起作用了。有人知道这是怎么回事吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T14:53:23.423

使用[jQuery](http://api.jquery.com/on/)

```
$(document).on('click','p.suggestions a',function(e) {
    e.preventDefault();
    t.add($(this).text());
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T14:53:51.363

您应该将其“实时”绑定`on`

```
$(document).on( 'click', 'p.suggestions a', function(e) {
    e.preventDefault();
    t.add($(this).text());
}); 
```

仅通过绑定时`click`，处理程序绑定到所有选定的（意味着：所有现有的）元素。如果出现一个新元素，它对处理程序一无所知。使用所谓的“实时”绑定，您还可以通过侦听特殊选择器将处理程序绑定到现在不存在的元素。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-29T14:53:56.800

动态添加元素时，最好将事件与 jQuery 绑定`on`-> [http://api.jquery.com/on/](http://api.jquery.com/on/)

以前，`live`是`delegate`建议，但现在`on`是要走的路。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-29T14:53:53.547

对于动态内容使用 on() 函数 Jquery！不推荐使用 live() 和 delegate()

```
$(document).on('click','p.suggestions a',function(e) {
    e.preventDefault();
    t.add($(this).text());
}); 
```

# java - java的list add方法传值问题

> ID：14082786
> 
> 赞同：0
> 
> 时间：2012-12-29T14:51:33.447
> 
> 标签：java, arraylist, pass-by-reference, pass-by-value

```
ArrayList<ArrayList<String>> list1 = new ArrayList<ArrayList<String>>();
ArrayList<String> list2 = new ArrayList<String>();

list2.add("foo");
System.out.println(list2); //[foo]
list1.add(list2);
System.out.println(list1); //[[foo]]
list2.set(0, "bar");
System.out.println(list2); //[bar]
System.out.println(list1); //[[bar]] 
```

上面的代码显示了 2 个列表。当我将`list2`（包含`foo`）添加到`list1`它们时，它们现在都包含`foo`. 但是当我修改`list2`为`bar`,`list1`也会改变。我一直认为 add 方法只提供 to 的副本，`list2`而`list1`我所做的 to`list2`不会改变`list1`.

`list2`我怎样才能让它成为我添加`list1`但允许`list2`在未来自由修改所以`list1`不会再次受到影响？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-29T14:54:06.973

在 Java中，*引用*是按值传递的，而不是引用的对象。这意味着`list2.add(list1);`不能更改引用`list1`，但它需要对同一对象的引用，并且如果您更改它是可见的。

你应该写这个的方式是

```
List<List<String>> list1 = new ArrayList<List<String>>();
List<String> list2 = new ArrayList<String>();

list2.add("foo");
System.out.println(list2); //[foo]
list1.add(new ArrayList<String>(list2)); // take a copy of the list.
System.out.println(list1); //[[foo]]
list2.set(0, "bar");
System.out.println(list2); //[bar]
System.out.println(list1); //[[foo]] 
```

或者

```
list1.add(list2); 
list2 = new ArrayList<String>();
list2.add("bar");
System.out.println(list2); //[bar]
System.out.println(list1); //[[foo]] 
```

> 我上面的例子很简单，但我的实际问题隐藏在嵌套循环等中。

```
List<List<String>> list1 = new ArrayList<List<String>>();

for(some loop) {
    List<String> list2 = new ArrayList<String>();
    // populate list2, can be smaller than the previous list2 !!
    list1.add(list2);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T14:54:44.087

怎么样`list1.add(list2.clone());`？这将创建`list2`（分配内存、克隆内容等）的副本并将对它的引用放入`list1`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T14:55:22.497

您应该克隆每个项目并添加到新列表中。

# ruby-on-rails - select_date rails 3 中的占位符

> ID：14082788
> 
> 赞同：1
> 
> 时间：2012-12-29T14:51:41.753
> 
> 标签：ruby-on-rails, ruby-on-rails-3, forms, placeholder

我通常可以使用类似的东西在表单中放置一个占位符

```
:placeholder => "something" or {:placehoder => "something"} 
```

我对如何在 select_date 中放置月份和年份的占位符感到有些困惑。我正在使用这个

```
<%= select_date(date = Date.current, :order => [:month, :year]) %> 
```

我想要月份和年份的占位符

任何人都知道如何实现这一点

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-29T15:14:48.913

选择的占位符？没听说过这样的事。也许你想要：

```
 <%=  select_date(date = Date.current, :order => [:month, :year], :prompt => { :month => 'Select month', :year => 'Select year' }  %> 
```

[这是启发我的答案](https://stackoverflow.com/a/1423974/877581)，因此您可能要归功于philipth。我只是根据你的情况调整了它。如果您需要更多内容，可以查看[文档。](http://api.rubyonrails.org/classes/ActionView/Helpers/DateHelper.html)你可以在那里找到这样的例子：

```
# Generates a date select with custom prompts.
date_select("article", "written_on", :prompt => { :day => 'Select day', :month => 'Select month', :year => 'Select year' }) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-11-04T17:33:30.117

您应该使用`prompt: true`I18n 翻译

```
date_select :user, :date_of_birth, prompt: true 
```

翻译键是

```
fr:
  datetime:
    prompts:
      day: Jour
      hour: Heure
      minute: Minute
      month: Mois
      second: Seconde
      year: Année 
```

# xslt - 对于每个奇数行 xsl

> ID：14082795
> 
> 赞同：2
> 
> 时间：2012-12-29T14:52:25.527
> 
> 标签：xslt, xpath

我如何**处理**`for-each`所有**奇数** 行？XML 看起来像这样：

 **```
<dsQueryResponse ViewStyleID="" BaseViewID="" TemplateType="" RowLimit="">
  <Rows>
    <Row title="A"/>
    <Row title="B"/>
    <Row title="C"/>
    <Row title="D"/>
    <Row title="E"/>
    <Row title="F"/>
</Rows>
</dsQueryResponse> 
```

这不起作用：

```
 <xsl:for-each  select="../Row[position() mod 2 =1]" /> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T15:05:23.273

您的基本技术（使用`position() mod 2`）是正确的，如下面的完整样式表所示：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

    <xsl:template match="/dsQueryResponse/Rows">
        <xsl:for-each  select="Row[position() mod 2 = 1]">
            <xsl:value-of select="./@title"/>
        </xsl:for-each>
    </xsl:template>
</xsl:stylesheet> 
```

您的问题可能与您所期望的特定*环境不同；*但是由于您没有显示其余代码，因此我们无法帮助您。**

# mysql - 用于更改数据库中记录的正则表达式

> ID：14082798
> 
> 赞同：0
> 
> 时间：2012-12-29T14:52:32.203
> 
> 标签：mysql, regex, database

我的朋友前几天问我要更改她的几条数据库记录，但问题是，它不仅仅是几条记录，它大约有 1000 条记录，我没有足够的时间和精力手动更改。可以用某种正则表达式来改变它吗？

我将数据库表导出到 XML 以便更好地查看，这里是它的片段：

```
 <table name="rozdzialy">
        <column name="nrrozdzialu">1</column>
        <column name="link">http://www.4shared.com/file/97583406/1770dfa5/AAA_vol_1_ch_1_MiA.html</column>
        <column name="link2">AAA/[MiA] AAA vol. 1 ch. 1.zip</column>
        <column name="idtomu">14</column>
    </table>
    <table name="rozdzialy">
        <column name="nrrozdzialu">1</column>
        <column name="link">http://www.4shared.com/file/96401389/bd0b05e2/7th_Period_is_a_Secret_vol_1_ch_1_MiA.html</column>
        <column name="link2">7th Period is a Secret/[MiA] 7th Period is a Secret vol. 1 ch. 1.zip</column>
        <column name="idtomu">17</column>
    </table> 
```

“link1”是旧链接的记录，“link2”是新链接的位置（其他记录为空）。“link1”包含创建新链接所需的所有数据。例如： .../file/97583406/1770dfa5/ **AAA_vol_1_ch_1** _MiA.html 该地址的新链接将如下所示：“AAA/[MiA] AAA vol. 1 ch. 1.zip

有可能做到吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T15:01:21.190

如果您只想替换整个 URL：

```
UPDATE rozdzialy SET link = link2 
```

或者，如果您想在保留前面的 hsot/path 的同时替换文件名部分：

```
UPDATE rozdzialy SET link = CONCAT(
  LEFT(link, CHAR_LENGTH(link) - CHAR_LENGTH(SUBSTRING_INDEX(link, '/', -1))),
  link2
) 
```

# java - Weka 无法使用字符串作为属性对文本进行分类

> ID：14082800
> 
> 赞同：0
> 
> 时间：2012-12-29T14:52:46.387
> 
> 标签：java, algorithm, machine-learning, weka

我有一个分类任务，它将一个字符串作为输入并将其分类为一些标签。训练数据如下：

```
Text1: label_1
Text2: label_2
Text3: label_1 
```

当我使用 weka 时，很多分类给出了例外：

```
weka.core.UnsupportedAttributeTypeException: weka.classifiers.functions.MultilayerPerceptron: Cannot handle string attributes!
    at weka.core.Capabilities.test(Capabilities.java:979)
    at weka.core.Capabilities.test(Capabilities.java:868)
    at weka.core.Capabilities.test(Capabilities.java:1084)
    at weka.core.Capabilities.test(Capabilities.java:1022)
    at weka.core.Capabilities.testWithFail(Capabilities.java:1301) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T15:04:05.520

很难理解您到底想要实现什么，但在机器学习中，大多数分类器都在寻找**数字/二进制属性**，而不是字符串属性。

您可以做的一件事是使用某些模型**将您的特征空间转换为数字/二进制属性。**词[袋模型](http://en.wikipedia.org/wiki/Bag-of-words_model)是一种常见的解决方案。

根据这个模型，你要做的是：

1.  遍历数据库中的所有“特征”（字符串），为每个字符串/单词分配一个数字/特征
2.  对于每个分类示例，创建一个具有修改的特征空间的新实例 - 对于每个单词/字符串，您现在有一个数字（从步骤 1 开始），因此将匹配此数字的属性设置为该单词在文本中的出现次数. 标签保持不变
3.  使用新的（数字）特征空间在修改后的示例上运行学习算法
4.  在分类过程中，如果您遇到一个无法识别的单词（您之前没有它并且没有分配给它的属性编号） - 您可以默默地忽略它，或者使用一些启发式方法来预测它是否以某种方式连接对你确实看到的一个词。对于初学者，我会忽略它，稍后再回来执行此步骤以进行以后的优化。

# python - 在 Python 中根据特定条件过滤获取的 JSON 数据

> ID：14082802
> 
> 赞同：1
> 
> 时间：2012-12-29T14:52:56.107
> 
> 标签：python, json, musicbrainz

我是 python 新手，正在尝试使用 urllib 从 musicbrainz 获取 JSON 数据，并且能够解析一些数据。但是，对于某些艺术家来说，JSON 数据中的某些字段/键并不存在，因为它们可能不是必需的。我不确定如何根据进一步的过滤条件过滤获取的 JSON 数据。

在下面的示例中，我需要过滤获取的 JSON 数据，仅针对那些 release-list>>release>>release-group>>type 为“Single”的数据。获取的 JSON 有时可以进行多达 50 次的迭代，但我只是将其进一步过滤到仅属于“单一”类别的那些。请让我知道如何去做。谢谢！

示例 JSON：

```
{
    "created": "2012-12-27T13:22:55.834Z",
    "recording-list": {
        "count": 3,
        "offset": 0,
        "recording": [{
            "score": "100",
            "title": "Stronger",
            "artist-credit": {
                "name-credit": [{
                    "artist": {
                        "name": "Britney Spears",
                        "sort-name": "Spears, Britney"
                    }
                }]
            },
            "release-list": {
                "release": [{
                    "id": "13c5511f-1f99-4ffe-97d5-562c05e9d8d5",
                    "title": "Hit Hammer 2001 (disc 1)",
                    "status": "Official",
                    "artist-credit": {
                        "name-credit": [{
                            "artist": {
                                "id": "89ad4ac3-39f7-470e-963a-56509c546377",
                                "name": "Various Artists"
                            }
                        }]
                    },
                      "release-group": {
                        "id": "6c4c2cc3-3d8e-3a19-9d46-da076c34b6e9",
                        "type": "Compilation",
                        "primary-type": "Album",
                        "secondary-type-list": {
                            "secondary-type": ["Compilation"]
                        }
                    },
                    "medium-list": {
                        "track-count": 20,
                        "medium": [{
                            "position": 1,
                            "track-list": {
                                "count": 20,
                                "offset": 0,
                                "track": [{
                                    "number": "1",
                                    "title": "Stronger",
                                    "length": 203266
                                }]
                            }
                        }]
                    }
                }]
            }
        }, {
            "id": "feb9acbf-1d3d-4395-9512-bfbdcfa72eb9",
            "score": "100",
            "title": "Stronger",
            "artist-credit": {
                "name-credit": [{
                    "joinphrase": "",
                    "artist": {
                        "name": "Britney Spears",
                        "sort-name": "Spears, Britney"
                    }
                }]
            },
            "release-list": {
                "release": [{
                    "id": "45e2a271-2f6b-4029-b11e-b6d94d169f9a",
                    "title": "Stronger: The Remixes",
                    "status": "Official",
                    "release-group": {
                        "id": "4d018ba8-f05e-4817-8c70-34307161a0fc",
                        "type": "Single",
                        "primary-type": "Single"
                    },
                    "date": "2000-12-12",
                    "country": "US",
                    "medium-list": {
                        "track-count": 6,
                        "medium": [{
                            "position": 1,
                            "format": "CD",
                            "track-list": {
                                "count": 6,
                                "offset": 0,
                                "track": [{
                                    "number": "1",
                                    "title": "Stronger",
                                    "length": 203000
                                }]
                            }
                        }]
                    }
                }]
            },
            "puid-list": {
                "puid": [{
                    "id": "28550845-c68a-314d-90c1-010dff730f4a"
                }]
            }
        }]
    }
} 
```

蟒蛇代码：

```
def get_mbid(artist, song):
    artist=urllib.quote_plus(artist)
    song=urllib.quote_plus(song)
    recording_url = 'http://search.musicbrainz.org/ws/2/recording/?&fmt=json&query=artist:"'+artist+'"%20AND%20recording:"'+song+'"'
    search_results = urllib.urlopen(recording_url)

    json = simplejson.loads(search_results.read())
    search_results.close()
    if json['recording-list']['count'] == 0:
        return get_mbid_artist(artist)
    else:
        recordings = json['recording-list']['recording']
        for recording in recordings:
            mbid = recording['artist-credit']['name-credit'][0]['artist']['id']
            print mbid 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T02:41:28.303

[http://musicbrainz.org/ws/2/recording?&query=artist%3A%22Britney+Spears%22+AND+recording%3A%22Stronger%22+AND+primarytype%3ASingle](http://musicbrainz.org/ws/2/recording?&query=artist%3A%22Britney+Spears%22+AND+recording%3A%22Stronger%22+AND+primarytype%3ASingle)

会给你录音`primarytype` `Single`。

那是没有编码：

`artist:"Britney Spears" AND recording:"Stronger" AND primarytype:Single`

另请参阅：[Web 服务搜索](http://musicbrainz.org/doc/Development/XML_Web_Service/Version_2/Search#Recording)。当然，您可以`fmt=json`再次添加。我刚刚删除了那部分，因为在浏览器中阅读 XML 更容易。

* * *

我还想指出，当前版本的[XML Web Service有一个](http://wiki.musicbrainz.org/Development/XML_Web_Service/Version_2)[python 库](http://python-musicbrainzngs.readthedocs.org/)。

# .net - 是否可以通过谷歌地理编码器通过城市/州/地址进行地理编码，而不仅仅是地址？

> ID：14082804
> 
> 赞同：0
> 
> 时间：2012-12-29T14:53:13.463
> 
> 标签：.net, google-maps-api-3, google-geocoder

我创建了很多使用 Google Maps Api V3 的应用程序。我刚刚遇到一个实例，我有一个城市、州、地址，我需要对所有这三个部分进行地理编码。我在代码中看到和当前使用的每个示例都特别偏离了地址。我在地理编码中看到的和看到的与我在此处粘贴的 Google 的主要示例非常相似。：

```
function codeAddress() {
    var address = document.getElementById("address").value;
    geocoder.geocode( { 'address': address}, function(results, status) {
      if (status == google.maps.GeocoderStatus.OK) {
        map.setCenter(results[0].geometry.location);
        var marker = new google.maps.Marker({
            map: map,
            position: results[0].geometry.location
        });
      } else {
        alert("Geocode was not successful for the following reason: " + status);
      }
    });
  } 
```

正如您所看到的，它只是在地址之外，我无法为我的应用程序执行此操作，因为我的某些地址非常模糊，并且会返回大量结果，只是想知道是否有人知道如何执行此操作？

我在这里搜索了论坛，发现了一些类似的问题，但没有真正的答案。非常感谢任何评论/建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T15:03:41.713

好的，完全误解了这个地址字段的工作原理。您可以将城市州推到地址字段的末尾。

[http://www.jasonfulps.com/node/288](http://www.jasonfulps.com/node/288)

# javascript - HTML Canvas：使用 createPattern 打印的图像被放大

> ID：14082818
> 
> 赞同：1
> 
> 时间：2012-12-29T14:54:15.833
> 
> 标签：javascript, html, canvas

我有一个问题，我传递给 createPattern 的任何图像都放大了 2 倍以上。我尝试使用：

```
contextInQuesiton.scale(1,1) 
```

但是图像仍然在我的明确指示下最初放大。

有任何想法吗？

代码看起来像这样

```
app.canvas = document.getElementById('thecanvas');
app.context = app.canvas.getContext('2d');

var bgImg  = new Image();
bgImg.src  = 'bg.png';

bgImg.onload = function() {
    var bgDraw = app.context.createPattern(bgImg, 'repeat-y');
    app.context.rect(0, 0, 1000, 600);
    app.context.fillStyle = bgDraw;
    app.context.fill();
} 
```

**编辑：解决方案：**

问题是我没有在画布元素本身上设置宽度和高度。我一开始是用 javascript 设置的，然后是用 css 设置的。这两种方法都导致了缩放问题。当我将高度和宽度放回标签上时，一切都恢复正常。诡异的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T15:16:38.890

`contextInQuestion.scale(1, 1)`不做任何事情。它将画布上的所有点映射到它们的当前位置，这没有任何可见的效果。

如果画布上的所有内容都是您想要的两倍大，并且您想将其缩放到当前大小的一半，您将使用：`contextInQuestion.scale(0.5, 0.5)`

# objective-c - 在 NSButton 的子类中实例化变量并将新按钮与 Interface Builder 连接

> ID：14082819
> 
> 赞同：-1
> 
> 时间：2012-12-29T14:54:17.713
> 
> 标签：objective-c, cocoa, mouse, subclass, nsbutton

为了访问按钮中的 -mouseUp 和 -mouseDown 事件，我将 NSButton 子类化，并且我还想在对象中存储一些额外的变量：

```
@interface MoveButton : NSButton{

    unsigned char cmd[3];
    unsigned char stop[3];
    int r;
    struct libusb_device_handle *devh;

}

-(void)mouseDown:(NSEvent *)theEvent;
-(void)mouseUp:(NSEvent *)theEvent;
-(void) setcommand:(char*)first:(char*)second:(char*)third (libusb_device_handle*)device_handle;
-(void) setLight: (char*) light;

@end 
```

在我的窗口控制器中，我有许多子类实例，每个实例都通过 IBOutlet 连接到 Interface Builder 中的一个元素。

```
@interface MainWindowController(){

    IBOutlet MoveButton * base_cw;
    IBOutlet MoveButton * base_ccw;

@end 
```

在 initWithWindow 函数中，每个按钮都被初始化：

```
 base_cw = [[MoveButton alloc] init];
 base_ccw = [[MoveButton alloc] init];
 [base_cw setcommand:"00" :"00" :"00":devh];
 [base_ccw setcommand:"00" :"00" :"00":devh]; 
```

在界面生成器中，我已将每个按钮的类属性更改为 MoveButton 并将其连接到正确的 IBOutlet。但是，当实际单击按钮时，会引发 UI 错误，因为它尝试使用的实例变量为空。是我没有将代码内对象与 UI 元素正确连接，还是我只是以错误的方式进行操作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T17:17:51.220

有线条

```
base_cw = [[MoveButton alloc] init];
base_ccw = [[MoveButton alloc] init]; 
```

在你的执行中`-initWithWindow:`是一个错误。`-windowDidLoad`假设您已在 Interface Builder 中将控件（您`MoveButton`的 s）连接到`MainWindowController`（文件的所有者），这些值将在调用时被覆盖。如果您*没有*在 Interface Builder 中连接控件（的实例`MoveButton`），您将遇到更多问题。

在仔细检查您已连接`MainWindowController`的 ivars`base_cw`和Interface Builder`base_ccw`中的适当`MoveButton`s 之后，您只需将配置按钮的行添加到`-windowDidLoad`：

```
- (void)windowDidLoad
{
    //...
    [base_cw setcommand:"00" :"00" :"00":devh];
    [base_ccw setcommand:"00" :"00" :"00":devh];
} 
```

* * *

您的选择器`setcommand::::`不符合 Objective-C 约定。一个更好的名字应该是

```
- (void)setFirstCommand:(char *)firstCommand 
        secondCommand:(char *)secondCommand 
        thirdCommand:(char *)thirdCommand 
        deviceHandle:(libusb_device_handle *)deviceHandle; 
```

请注意每个参数的标签使用（`secondCommand`for`secondCommand`等）和驼峰大小写的使用（`setFirstCommand:...`而不是 `setfirstcommand:... 等）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T18:17:45.650

固定的！通过使用声明

```
IBOutlet MoveButton * base_cw; 
```

它并没有真正将代码内对象链接到 UI 对象。

将其替换为：

```
IBOutlet id base_cw 
```

链接已正确建立，更改 ivars 的消息正在发送到正确的对象。

非常感谢提供的帮助。

# php - CodeIgniter URL 格式

> ID：14082822
> 
> 赞同：0
> 
> 时间：2012-12-29T14:54:53.080
> 
> 标签：php, codeigniter

此刻，我正在像这样访问我的项目页面，并且这种格式工作正常：

```
http://localhost/Seven/index.php/admin_login/login  (FOR LOGIN PAGE)

http://localhost/Seven/index.php/secure/admin_news  (FOR ADMIN NEWS SECTION)

config.php

$config['base_url'] = 'http://localhost/Seven/';

$config['index_page'] = 'index.php'; 
```

目前，我没有使用任何`.htaccess`文件，因为我无法访问我的[CSS](http://en.wikipedia.org/wiki/Cascading_Style_Sheets)的内容。

### 我的问题

1.  如何从我的 URL 中删除“index.php”位，以便我可以访问我的项目页面，如下所示？

    ```
    http://localhost/Seven/admin_login/login  (FOR LOGIN PAGE)

    http://localhost/Seven/secure/admin_news  (FOR ADMIN NEWS SECTION) 
    ```

    和所有其他页面？？？？

2.  我的项目根目录（“Seven”）中有两个用于图像和 CSS 的用户文件夹，即“images”和“css”。我正在使用这样的 CSS 和图像：

    ```
    http://localhost/Seven/images/test-logo.jpg 
    ```

    和

    ```
    ../Seven/css/default.css 
    ```

当我试图摆脱绝对路径时，我无法访问我网页上的图像和 CSS 内容。我该如何处理这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T14:58:01.027

打开`config/config.php`，第 31 行：

改变

```
$config['index_page'] = 'index.php'; 
```

到

```
$config['index_page'] = ''; 
```

然后使用它`.htaccess`（把它放到主根`/Seven`）：

```
RewriteEngine On
RewriteBase /Seven
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ /Seven/index.php/$1 [L] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-29T15:31:35.503

`base_url`只是一个让你的生活更轻松的注释：除非你真的需要它，否则不要在配置中提供。

我从来没有在我的任何项目中提供过它，这使得上传到多个地方时不那么痛苦（CodeIgniter 可以弄清楚）。

# javascript - 以特定形式引用输入

> ID：14082825
> 
> 赞同：1
> 
> 时间：2012-12-29T14:55:08.313
> 
> 标签：javascript, jquery

我正在以以下方式捕获使用 twitter bootstrap 创建的表单的数据异步：

```
 $('form[data-async]').live('submit', function(event) {
        var $form = $(this);
        var $target = $($form.attr('data-target'));
        var target_id = $target[0].id;

  ....
 } 
```

我想在有问题的表单中引用名称为“用户名”的输入...我尝试了 $form.username,$form['username']，但无济于事，我找不到如何获取输入。我知道我可以使用

```
 $('#formid input[name=bla]') 
```

但由于我已经有了表单对象，如果可能的话，我想使用它。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T14:55:49.353

您可以使用`.find()`：

```
var $input = $form.find('input[name=bla]'); 
```

*编辑*——评论者 Jack 指出表单 DOM 元素还有 HTML5“元素”属性。这使您可以按名称或 ID 或数字索引获取输入。

```
var input = this.elements['bla']; 
```

由于该机制还考虑元素“id”属性（事实上，我认为这些属性优先），因此按名称访问很复杂。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-29T15:00:11.247

在您的提交处理程序中，`username`可以通过以下方式简单地引用输入字段：

```
this.elements['username'] 
```

不需要花哨的 jQuery :)

**更新**

没有意识到`elements`这是一个相当新的添加。在此之前，您可以使用：

```
this.username 
```

**更新 2**

垫片版本如下所示：

```
var field = this.elements ? this.elements['username'] : this.username; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-29T14:57:19.733

您可以使用表单对象作为[**上下文和选择器**](http://api.jquery.com/jQuery/)来查找上下文中的元素。

句法：`jQuery( selector [ , context ] )`

```
$('input[name=bla]', $form ); 
```

您可以使用它，因为它代表您的表单。

```
$('form[data-async]').live('submit', function(event) {

     $('input[name=bla]', this ); // this is your form

 }) 
```

# css - 使用 Google 字体时，引导图标 (Glyphicons) 的位置略微向上，我该如何解决这个问题？

> ID：14082826
> 
> 赞同：15
> 
> 时间：2012-12-29T14:55:12.600
> 
> 标签：css, twitter-bootstrap, document, google-font-api, glyphicons

如果我在文档的 head 标记中添加以下 Google 字体

```
<link href="http://fonts.googleapis.com/css?family=Muli|Dosis:500,400|Open+Sans" rel="stylesheet"> 
```

引导图标（Glyphicons）稍微向上定位，您可以在此链接中看到：[http ://www.acarrilho.com/wp-content/uploads/2012/07/icon_off.png](http://www.acarrilho.com/wp-content/uploads/2012/07/icon_off.png)

![在此处输入图像描述](../Images/e5878dad9a959879e8b514e5f8b8e882.png)

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-30T15:18:16.587

我认为问题不在于 Google 字体，而在于字体大小和垂直对齐的组合。Bootstrap 中图标的默认字体大小为 14px，在`icon-`我们的声明中`vertical-align: text-top;`，请参见下面的代码。

```
[class^="icon-"],
[class*=" icon-"] {
  display: inline-block;
  width: 14px;
  height: 14px;
  margin-top: 1px;
  *margin-right: .3em;
  line-height: 14px;
  vertical-align: text-top;
  background-image: url("../img/glyphicons-halflings.png");
  background-position: 14px 14px;
  background-repeat: no-repeat;
} 
```

在您的“仪表板”按钮中，字体大小似乎大于 14 像素，也许是 22 像素？一种解决方案可能是为您的按钮创建替代/扩展选择器并更改`vertical-align`为`baseline`：

```
[class^="icon-"] .my-class,
[class*=" icon-"] .my-class {
  vertical-align: baseline;
} 
```

但请记住，视觉中心取决于单词；例如，“仪表板”没有下降器（请参阅有关[排版结构的](http://www.fontshop.com/glossary/)更多信息）。如果`baseline`看起来不好，请尝试其他一些，请参阅[此处的规范](http://reference.sitepoint.com/css/vertical-align)。

@user1751766 建议的解决方案也是可能的。但我建议`.my-class`从 Bootstrap 的默认声明中确定这个替代声明的范围。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-10-09T05:18:28.590

转到 Bootstrap.css

```
.glyphicon {
  position: relative;
  **top: 11px;**
  display: inline-block;
  font-family: 'Glyphicons Halflings';
  -webkit-font-smoothing: antialiased;
  font-style: normal;
  font-weight: normal;
  line-height: 1; 
```

弄乱，`top`直到它按照你喜欢的方式排列。11px 对我有用，但它可能取决于哪个图标/您尝试使用它的方式。只是修补，直到它看起来不错。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-07-26T16:16:02.627

这对我来说效果很好：

```
span.glyphicon {
    vertical-align: middle;
    margin-top: -5px;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-29T15:30:26.053

我过去曾在 Bootstrap 中使用过这样的 CSS：

```
[class^="icon-"] {
margin-top: 3px;
} 
```

只需使用 margin-top 直到它看起来正确。

祝你好运！

# java - eclipse - 项目方面 - java v1.7 不可用

> ID：14082827
> 
> 赞同：1
> 
> 时间：2012-12-29T14:55:14.947
> 
> 标签：java, version, java-7, facets

我有一个使用 java v1.7 的 Eclipse 项目 - 我将项目克隆到我的 Mac 上，现在有一个方面的问题。jre7 已安装并包含在构建路径中。我已经清理并重新启动了 Eclipse，但 Java v 1.7 在 Project Facets 选项卡的版本列表中不可用。请指教

# macos - 使用 macports 在 mac 10.7.5 上安装 xmms2 失败

> ID：14082830
> 
> 赞同：0
> 
> 时间：2012-12-29T14:55:39.440
> 
> 标签：macos, osx-lion, macports

尝试以下操作时出现的错误：

```
$cd /opt/local/var/macports/build/_opt_local_var_macports_sources_rsync.macports.org_release_tarballs_ports_audio_xmms2/xmms2/work/xmms2-0.8DrO_o
$sudo ./waf build 
```

是：

```
Build failed
 -> task failed (exit status 1): 
    {task 4561778192: c avcodec.c -> avcodec.c.1.o} 
```

我收到一个错误：

```
error: implicit declaration of function 'avcodec_init' is invalid in C99 [-Werror,-Wimplicit-function-declaration] 
```

和四个警告：

```
warning: 'avcodec_alloc_context' is deprecated [-Wdeprecated-declarations]

warning: 'avcodec_open' is deprecated [-Wdeprecated-declarations]

warning: 'avcodec_decode_audio3' is deprecated [-Wdeprecated-declarations]

warning: 'avcodec_decode_audio3' is deprecated [-Wdeprecated-declarations] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T13:36:52.720

尝试安装`xmms2`. 类型`port variants xmms2`

```
xmms2 has the variants:
   cpp: C++ development support
   perl: Perl development support
   ruby: Ruby development support
   universal: Build for multiple architectures 
```

`cpp`试试这个命令来安装`xmms2`

```
sudo port install xmms2 +cpp 
```

# ruby-on-rails-3 - 配置 Nginx 以使用 Rails 3 资产管道

> ID：14082833
> 
> 赞同：0
> 
> 时间：2012-12-29T14:56:01.850
> 
> 标签：ruby-on-rails-3, nginx

我正在尝试将 Nginx 配置为与 Rails 3 资产管道一起使用。

```
http {
    passenger_root /home/ubuntu/.rvm/gems/ruby-1.9.3-p327/gems/passenger-3.0.18;
    passenger_ruby /home/ubuntu/.rvm/wrappers/ruby-1.9.3-p327/ruby;

    include       mime.types;
    default_type  application/octet-stream;
    sendfile        on;

    #keepalive_timeout  0;
    keepalive_timeout  65;

    server {
        listen       80;
        server_name  myprojecthost.com *.myprojecthost.com;
        #charset koi8-r;

        #access_log  logs/host.access.log  main;
        root /var/www/<my proj>/current/public;

        location / {
            passenger_enabled on;
            rails_env staging;
                root /var/www/<my proj>/current/public;
        }

        location ~ ^/(assets)/{
                root /var/www/<my proj>/current/public;
                expires max;
                add_header Cache-Control public;
        }
      }
  } 
```

Rails 配置如下：

```
MyProj::Application.configure do
  # Code is not reloaded between requests
  config.cache_classes = true

  # Full error reports are disabled and caching is turned on
  config.consider_all_requests_local       = false
  config.action_controller.perform_caching = true

  # Disable Rails's static asset server (Apache or nginx will already do this)
  config.serve_static_assets = true

  # Compress JavaScripts and CSS
  config.assets.compress = true

  # Don't fallback to assets pipeline if a precompiled asset is missed
  config.assets.compile = true

  # Generate digests for assets URLs
  config.assets.digest = true

  # Defaults to Rails.root.join("public/assets")
  # config.assets.manifest = YOUR_PATH

  # Specifies the header that your server uses for sending files
  # config.action_dispatch.x_sendfile_header = "X-Sendfile" # for apache
  config.action_dispatch.x_sendfile_header = 'X-Accel-Redirect' # for nginx

  # Force all access to the app over SSL, use Strict-Transport-Security, and use secure cookies.
  # config.force_ssl = true

  # See everything in the log (default is :info)
  config.log_level = :debug

  # Use a different logger for distributed setups
  # config.logger = SyslogLogger.new

  # Enable locale fallbacks for I18n (makes lookups for any locale fall back to
  # the I18n.default_locale when a translation can not be found)
  config.i18n.fallbacks = true

  # Send deprecation notices to registered listeners
  config.active_support.deprecation = :notify
end 
```

我的 css 文件返回 404 错误。如果我删除块“位置〜^ /（资产）/ {”它工作得很好，但它非常慢。

有人能帮我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T16:22:06.210

你在预编译你的资产吗？`rake assets:clean`和`rake assets:precompile`？

# backbone.js - 加载动态 Require.js 模块

> ID：14082834
> 
> 赞同：0
> 
> 时间：2012-12-29T14:56:06.223
> 
> 标签：backbone.js, requirejs, marionette

花了一整天的时间在这上面，我认为是时候大喊大叫了。我正在使用 require.js 在我的主干应用程序中包含模块。这就是我所拥有的：

我的requirejs配置：

```
paths:
 jquery: "backbone/initializers/jquery_loader"
 jqueryui: "backbone/initializers/jqueryui_loader"   
modules:
 - name: 'application'
 - name: 'jquery'
  exclude: ['application']
 - name: 'jqueryui'
  exclude: ['application', 'jquery']
 - name: 'email'
  exclude: ['application']
 - name: 'department_home'
  exclude: ['application']
priority: ['application', 'jquery', 'jqueryui'] 
```

我的 jquery_loader：

```
define ["jquery.min"], () ->
 jQuery = $
 jQuery.noConflict(true) 
```

我的 jqueryui_loader：

```
define ['jquery.ui.all'], () -> 
```

我的电子邮件模块：

```
define ['marionette', 'jqueryui', 'tags'], (Marionette, ui, tags) -> 
```

我的部门主页模块

```
define ['marionette', 'jqueryui', 'dept_tags'], (Marionette, ui, tags) -> 
```

一切都按预期工作并编译，但也许我不明白或者我遗漏了什么，电子邮件模块在点击事件上动态加载，并且它包含 jqueryui，我相信这只是一个 r.js 优化文件。

现在我在加载电子邮件模块后执行另一个单击事件，我看到部门模块中也有 jquerui，两者都是 90KB，我期望部门模块使用电子邮件模块已经加载的 jqueryui。

感谢你的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T11:29:20.110

我认为你不应该像这样使用 jquery loader。您应该使用 shim 属性来初始化 noConflict。[前几天我也回答过类似的问题](https://stackoverflow.com/a/14034840/1916258)。

在你的情况下，它会是这样的（但在咖啡脚本中）：

```
require.config({
    paths: {
        jquery: "path/to/jquery",
        jqueryui: "path/to/jqueryui"
    },
    shim: {
        jquery: {
          exports: 'jQuery',
          init: function() {
             return this.jQuery.noConflict();
          },
        jqueryui: {
          deps: ['jquery']
       }
    } 
}); 
```

# php - yii活动记录如何查询5张专辑的最后一张图片

> ID：14082836
> 
> 赞同：1
> 
> 时间：2012-12-29T14:56:18.423
> 
> 标签：php, sql, activerecord, yii

我使用 Yii 框架开发一个网站，我想知道如何通过使用 Yii 活动记录和纯 SQL 来获取按 create_time 排序但不在同一个相册中的最后 5 张图像。

这是我的专辑表：

```
CREATE TABLE IF NOT EXISTS `tbl_album` (
  `album_id` int(11) NOT NULL AUTO_INCREMENT,
  `album_name` varchar(45) DEFAULT NULL,
  `album_folder_name` int(11) DEFAULT NULL,
  `create_time` datetime DEFAULT NULL,
  `create_user_id` int(11) DEFAULT NULL,
  `update_time` datetime DEFAULT NULL,
  `update_user_id` int(11) DEFAULT NULL,
  PRIMARY KEY (`album_id`)
) ENGINE=InnoDB  DEFAULT CHARSET=utf8 AUTO_INCREMENT=55 ; 
```

这是我的图片表：

```
CREATE TABLE IF NOT EXISTS `tbl_image` (
  `image_id` int(11) NOT NULL AUTO_INCREMENT,
  `image_name` varchar(100) DEFAULT NULL,
  `image_description` varchar(100) DEFAULT NULL,
  `image_album_id` int(11) NOT NULL,
  `create_time` datetime DEFAULT NULL,
  `create_user_id` int(11) DEFAULT NULL,
  `update_time` datetime DEFAULT NULL,
  `update_user_id` int(11) DEFAULT NULL,
  PRIMARY KEY (`image_id`),
  KEY `fk_image_album` (`image_album_id`)
) ENGINE=InnoDB  DEFAULT CHARSET=utf8 AUTO_INCREMENT=9 ; 
```

请注意，我使用“create_time”对图像进行排序。

同样，我需要一个查询来获取由 create_time 排序的最后 5 张图像，但它们不在 Yii 活动记录和普通 SQL 的同一张专辑中。

例如最后 7 张图片是：

```
a.jpg in the album 7
b.jpg in the album 5
c.jpg in the album 7
d.jpg in the album 6
e.jpg in the album 3
f.jpg in the album 4
g.jpg in the album 2
h.jpg in the album 1 
```

我需要查询结果如下：

```
a.jpg in album 7
b.jpg in album 5
d.jpg in album 6
e.jpg in album 3
f.jpg in album 4 
```

不像下面这样：

```
a.jpg in album 7
b.jpg in album 5
c.jpg in album 7
d.jpg in album 6
e.jpg in album 3 
```

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T15:08:03.337

试试这个：

```
SELECT
  a.album_name,
  i1.image_name
FROM tbl_album a
INNER JOIN tbl_image i1 ON i1.image_album_id = a.album_id
INNER JOIN
(
   SELECT image_album_id, MIN(image_id) image_id
   FROM tbl_image
   GROUP BY image_album_id
) i2  ON i2.image_album_id = i1.image_album_id 
     AND i1.image_id = i2.image_id
ORDER BY a.album_name DESC
LIMIT 5; 
```

与`JOIN`：

```
 SELECT image_album_id, MIN(image_id) image_id
   FROM tbl_image
   GROUP BY image_album_id 
```

将确保对于每个相册，将返回第一张图片。因此，每张专辑您只会得到一张图片，然后`LIMIT 5`将结果集限制为只有 5 张专辑。

## [SQL 小提琴演示](http://sqlfiddle.com/#!2/16c9a/4)

**请注意：**该`ORDER BY`子句将确定该子句将返回哪五个专辑`LIMIT 5`。因此，不要期望专辑以它们在您问题中的预期结果的存储方式返回，因为表中的记录没有特定的顺序。它们存储为一个集合，您必须`ORDER BY`在查询中指定一个子句才能按特定顺序获取它们。

* * *

**更新：**如果您正在为每个专辑寻找最后创建的图像，请使用`MAX(creaet_time)`如下所示：

```
SELECT
  a.album_name,
  i1.image_name,
  date_format(i1.create_time, '%Y-%m-%d') create_time
FROM tbl_album a
INNER JOIN tbl_image i1 ON i1.image_album_id = a.album_id
INNER JOIN
(
   SELECT image_album_id, MAX(create_time) LatestCreateTime
   FROM tbl_image
   GROUP BY image_album_id
) i2  ON i2.image_album_id = i1.image_album_id 
     AND i1.create_time = i2.LatestCreateTime
ORDER BY i1.create_time DESC
LIMIT 5; 
```

## [更新的 SQL Fiddle 演示](http://sqlfiddle.com/#!2/279f9/4)

* * *

**更新 2：**对于重复值，请使用`DISTINCT`关键字，或者您可以使用 the`MAX(image_id)`代替，因为`image_id`是自动增量的，如下所示：

```
SELECT
  a.album_name,
  i1.image_name,
  date_format(i1.create_time, '%Y-%m-%d') create_time
FROM tbl_album a
INNER JOIN tbl_image i1 ON i1.image_album_id = a.album_id
INNER JOIN
(
   SELECT image_album_id, MAX(image_id) LatestId
   FROM tbl_image
   GROUP BY image_album_id
) i2  ON i2.image_album_id = i1.image_album_id 
     AND i1.image_id = i2.LatestId
ORDER BY i1.create_time DESC
LIMIT 5; 
```

## [更新的 SQL Fiddle 演示](http://sqlfiddle.com/#!2/a15dc/7)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T21:24:24.170

我为我的问题找到了另一种解决方案！

```
SELECT *
FROM tbl_image 
WHERE image_id IN (SELECT MAX(image_id) 
                   FROM tbl_image 
                   GROUP BY image_album_id) 
ORDER BY create_time DESC 
LIMIT 5; 
```

它给了我相同的结果，不使用会降低性能的内部连接，您对此解决方案有何看法？

[**SQL小提琴**](http://sqlfiddle.com/#!2/60aa8/4)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T15:11:45.617

试试这个，让我知道它返回了什么，

```
select m.image_name,a.album_name
from tbl_album a inner join
tbl_image m on a.album_id=m.image_id
group by m.image_name,a.album_name
order by 2 LIMIT 5 
```

# tridion - 在列表视图中从 Tridion Anguilla 获取 WebDavURL

> ID：14082844
> 
> 赞同：4
> 
> 时间：2012-12-29T14:57:14.710
> 
> 标签：tridion, tridion-2011

我想使用 Anguilla 为 GUI 扩展获取列表视图中项目的 WebDavURL 属性。

我有以下代码，但未返回 WebDavURL：

```
selectedItem = selection.getItems()[0];
var item = $models.getItem(selectedItem);
var webDavUrl = item.getInfo().webDavUrl(); 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-29T16:13:18.557

您必须实际加载 webDavUrl... item.loadWebDavUrl()。您必须设置一个事件处理程序，以便在 WebDav URL 作为其异步方法加载后进行通知。这是一个包含加载和设置事件处理程序的示例：

```
var item = $models.getItem(selectedItem),
    webDavUrl = item.getWebDavUrl();

if (!webDavUrl) {
    // WebDavUrl for cached item hasn't been loaded yet, so lets load it.
    $evt.addEventHandler(item, "loadwebdavurl", function (event) {
        webDavUrl = item.getWebDavUrl(); // also could do event.source.getWebDavUrl()
    });
    item.loadWebDavUrl();
} 
```

希望有帮助！

# android - 谷歌地图的“错误膨胀类片段”

> ID：14082851
> 
> 赞同：15
> 
> 时间：2012-12-29T14:58:08.673
> 
> 标签：android, android-maps-v2

我尝试使用谷歌地图制作一个示例项目，但我做不到。请帮帮我！

测试设备：Android 4.0.4

错误信息 ：

```
12-29 23:45:32.605: E/AndroidRuntime(9437): FATAL EXCEPTION: main
12-29 23:45:32.605: E/AndroidRuntime(9437):
java.lang.RuntimeException: Unable to start activity
ComponentInfo{com.example.test_googlemap/com.example.test_googlemap.MainActivity}:
android.view.InflateException: Binary XML file line #2: Error
inflating class fragment 12-29 23:45:32.605: E/AndroidRuntime(9437):
android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1968)
12-29 23:45:32.605: E/AndroidRuntime(9437):     at
android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1993)
12-29 23:45:32.605: E/AndroidRuntime(9437):     at
android.app.ActivityThread.access$600(ActivityThread.java:127) 12-29
23:45:32.605: E/AndroidRuntime(9437):   at
android.app.ActivityThread$H.handleMessage(ActivityThread.java:1159)
12-29 23:45:32.605: E/AndroidRuntime(9437):     at
android.os.Handler.dispatchMessage(Handler.java:99) 12-29
23:45:32.605: E/AndroidRuntime(9437):   at
android.os.Looper.loop(Looper.java:137) 12-29 23:45:32.605:
E/AndroidRuntime(9437):     at
android.app.ActivityThread.main(ActivityThread.java:4507) 12-29
23:45:32.605: E/AndroidRuntime(9437):   at
java.lang.reflect.Method.invokeNative(Native Method) 12-29
23:45:32.605: E/AndroidRuntime(9437):   at
java.lang.reflect.Method.invoke(Method.java:511) 12-29 23:45:32.605:
E/AndroidRuntime(9437):     at
com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:790)
12-29 23:45:32.605: E/AndroidRuntime(9437):     at
com.android.internal.os.ZygoteInit.main(ZygoteInit.java:557) 12-29
23:45:32.605: E/AndroidRuntime(9437):   at
dalvik.system.NativeStart.main(Native Method) 12-29 23:45:32.605:
E/AndroidRuntime(9437): Caused by: android.view.InflateException:
Binary XML file line #2: Error inflating class fragment 12-29
23:45:32.605: E/AndroidRuntime(9437):   at
android.view.LayoutInflater.createViewFromTag(LayoutInflater.java:697)
12-29 23:45:32.605: E/AndroidRuntime(9437):     at
android.view.LayoutInflater.inflate(LayoutInflater.java:466) 12-29
23:45:32.605: E/AndroidRuntime(9437):   at
android.view.LayoutInflater.inflate(LayoutInflater.java:396) 12-29
23:45:32.605: E/AndroidRuntime(9437):   at
android.view.LayoutInflater.inflate(LayoutInflater.java:352) 12-29
23:45:32.605: E/AndroidRuntime(9437):   at
com.android.internal.policy.impl.PhoneWindow.setContentView(PhoneWindow.java:271)
12-29 23:45:32.605: E/AndroidRuntime(9437):     at
android.app.Activity.setContentView(Activity.java:1835) 12-29
23:45:32.605: E/AndroidRuntime(9437):   at
com.example.test_googlemap.MainActivity.onCreate(MainActivity.java:11)
12-29 23:45:32.605: E/AndroidRuntime(9437):     at
android.app.Activity.performCreate(Activity.java:4465) 12-29
23:45:32.605: E/AndroidRuntime(9437):   at
android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1052)
12-29 23:45:32.605: E/AndroidRuntime(9437):     at
android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1932)
12-29 23:45:32.605: E/AndroidRuntime(9437):     ... 11 more 12-29
23:45:32.605: E/AndroidRuntime(9437): Caused by:
java.lang.ClassCastException: com.google.android.gms.maps.MapFragment
cannot be cast to android.support.v4.app.Fragment 12-29 23:45:32.605:
E/AndroidRuntime(9437):     at
android.support.v4.app.Fragment.instantiate(Fragment.java:394) 12-29
23:45:32.605: E/AndroidRuntime(9437):   at
android.support.v4.app.Fragment.instantiate(Fragment.java:369) 12-29
23:45:32.605: E/AndroidRuntime(9437):   at
android.support.v4.app.FragmentActivity.onCreateView(FragmentActivity.java:272)
12-29 23:45:32.605: E/AndroidRuntime(9437):     at
android.view.LayoutInflater.createViewFromTag(LayoutInflater.java:669)
12-29 23:45:32.605: E/AndroidRuntime(9437):     ... 20 more 
```

源代码 ：

```
package com.example.test_googlemap;

import android.os.Bundle;
import android.support.v4.app.FragmentActivity;

public class MainActivity extends FragmentActivity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
    }

} 
```

活动主.xml：

```
 <?xml version="1.0" encoding="utf-8"?>
    <fragment xmlns:android="http://schemas.android.com/apk/res/android"
           android:id="@+id/map"
           android:layout_width="match_parent"
           android:layout_height="match_parent"
           class="com.google.android.gms.maps.MapFragment"/> 
```

清单.xml：

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.example.test_googlemap"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk
        android:minSdkVersion="3"
        android:targetSdkVersion="15" />

    <application
        android:allowBackup="true"
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/AppTheme" >
        <activity
            android:name="com.example.test_googlemap.MainActivity"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>

        <meta-data
            android:name="com.google.android.maps.v2.API_KEY"
            android:value="I removed it!"/>
        </application>    
    <permission
        android:name="com.example.Test_GoogleMap.permission.MAPS_RECEIVE"
        android:protectionLevel="signature"/>
    <uses-permission android:name="com.example.Test_GoogleMap.permission.MAPS_RECEIVE"/>

    <uses-permission android:name="android.permission.INTERNET"/>
    <uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE"/>
    <uses-permission android:name="com.google.android.providers.gsf.permission.READ_GSERVICES"/>
    <uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION"/>
    <uses-permission android:name="android.permission.ACCESS_FINE_LOCATION"/>

    <uses-feature
        android:glEsVersion="0x00020000"
        android:required="true"/>

</manifest> 
```

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2012-12-29T15:54:17.267

您正在扩展`FragmentActivity`，表明您正在尝试使用 Android Support 包 backport 的片段。但是，您的`<fragment>`元素指的是`MapFragment`，它适用于原生 API 级别 11 版本的片段。

替换`MapFragment`为`SupportMapFragment`, 应该可以清除这个特定的崩溃。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-08-09T16:00:36.190

我遇到了同样的问题，我犯了一个错误，只添加了以下 2 个标签之一。 **请注意，您还缺少这两个之一**

> ```
>  <meta-data
>             android:name="com.google.android.maps.v2.API_KEY"
>             android:value="<YOUR VALUE>"/>
>         <meta-data
>             android:name="com.google.android.gms.version"
>             android:value="@integer/google_play_services_version" /> 
> ```

实际错误确实具有误导性，因为您可能正在考虑一些 API 级别的 UI 问题。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-04-30T20:08:10.410

有时您同时使用两者 -

```
<meta-data
android:name="com.google.android.maps.v2.API_KEY"
android:value="<YOUR VALUE>"
/>
<meta-data
android:name="com.google.android.geo.API_KEY"
android:value="<YOUR VALUE>"
/> 
```

确保不要同时使用...如果您需要 Location , Places 和 maps 然后使用 geo.API_KEY 如果您需要 places 和 maps 然后使用 maps.v2.API_KEY

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-01-10T06:37:15.877

接受的答案是正确的，但我与您分享的有意义的信息，可能是任何人都面临我面临的同样问题

> 如果一切都与谷歌代码一样，那么请检查清单文件，在我的情况下，我添加了地理键和地图键，这就是发生异常的原因，

**注意 - 不要在清单文件中添加两个键删除映射键**

```
meta-data
        android:name="com.google.android.maps.v2.API_KEY"
        android:value="@string/google_maps_key"/> 
```

上面的代码并添加此代码。

```
 <meta-data
        android:name="com.google.android.geo.API_KEY"
        android:value="@string/auto_location"/>

 <meta-data
        android:name="com.google.android.gms.version"
        android:value="@integer/google_play_services_version"/> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-09-02T05:26:44.507

当由于 andriod_manifest.xml 文件中的 SDK 版本不兼容而无法扩展 activity_main.xml（或 res/layout 下存在的 XML 文件）中提到的 Fragment 类时，也会出现此问题。

在模拟器上获取地图的 SDK 级别的正确版本是：

```
 <uses-sdk
    android:minSdkVersion="11"
    android:targetSdkVersion="21" /> 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-01-08T10:03:51.670

即使这是一个已经回答的问题，如果您`super.onCreateView`在片段中调用，也会出现此错误。它会在运行时崩溃。

确保您覆盖了该`onCreateView`方法并夸大了您的布局：

```
@Override
public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {
    View view = inflater.inflate(R.layout.my_fragment, container, false);
    return view;
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-04-20T06:29:07.253

就我而言，我必须进行两次更正才能使此异常消失。

1.  活动应该扩展 FragmentActivity 而不是 Activity
2.  清单文件需要 ACCESS_NETWORK_STATE 的使用权限（我的文件已经拥有 INTERNET 权限）

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2016-05-27T13:53:44.630

此缺陷已在播放服务库 v9.0.0 中得到解决。[https://code.google.com/p/gmaps-api-issues/issues/detail?id=9021#makechanges](https://code.google.com/p/gmaps-api-issues/issues/detail?id=9021#makechanges)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-12-29T15:03:25.410

使用互联网权限成为清单文件的直接子级。像下面一样尝试..

此外，您应该具有以下使用地图：

`Map activity`1.应该在你的活动文件中扩展

2.应该有 API 密钥我没有在你的代码中看到任何密钥。

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.example.test_googlemap"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-permission android:name="android.permission.INTERNET"/>
    <uses-sdk
        android:minSdkVersion="3"
        android:targetSdkVersion="15" /> 
```

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2012-12-29T15:05:01.737

1.  你有有效的谷歌地图 API 密钥吗？
2.  尝试使用

    ```
    public class MainActivity extends MapActivity{
     ... } 
    ```

# android - 向 ViewPager 添加标题

> ID：14082854
> 
> 赞同：15
> 
> 时间：2012-12-29T14:58:19.760
> 
> 标签：android, android-viewpager

我已经为可滑动标签设置了 ViewPager，现在我想在页面顶部添加标题以指示正在显示的片段。

这是到目前为止的代码：

**activity_main.xml**

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" >

    <android.support.v4.view.ViewPager
        android:id="@+android:id/viewpager"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent" />

</LinearLayout> 
```

**MainActivity.java**

```
public class MainActivity extends FragmentActivity {

    private PagerAdapter mPagerAdapter;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        super.setContentView(R.layout.activity_main);

        this.initialisePaging();
    }

    private void initialisePaging() {

        List<Fragment> fragments = new Vector<Fragment>();

        // Add fragments here
        fragments.add(Fragment.instantiate(this, PickerFragment.class.getName()));
        fragments.add(Fragment.instantiate(this, DisplayFragment.class.getName()));

        this.mPagerAdapter  = new PageAdapter(super.getSupportFragmentManager(), fragments);
        ViewPager pager = (ViewPager)super.findViewById(R.id.viewpager);
        pager.setAdapter(this.mPagerAdapter);
    }

} 
```

**PageAdapter.java**

```
public class PageAdapter extends FragmentPagerAdapter {

    private List<Fragment> fragments;

    public PageAdapter(FragmentManager fm, List<Fragment> fragments) {
        super(fm);
        this.fragments = fragments;
    }

    @Override
    public Fragment getItem(int position) {
        return this.fragments.get(position);
    }

    @Override
    public int getCount() {
        return this.fragments.size();
    }
} 
```

这可行，我可以在两个标签之间滑动，但没有标题。

我想最终得到如下所示的东西：

![谷歌播放](../Images/c936e944b76f976cd13e525a0976f5d8.png)

对于如何设置它，我将不胜感激。

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2012-12-29T15:22:48.397

在查看[PagerTitleStrip](http://developer.android.com/reference/android/support/v4/view/PagerTitleStrip.html)之后，按照评论中的建议，我做了以下事情：

我在**activity_main.xml添加了一个****PagerTitleStrip**：

 **```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" >

    <android.support.v4.view.ViewPager
        android:id="@+android:id/viewpager"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent" >

        <android.support.v4.view.PagerTitleStrip
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_gravity="top" />
    </android.support.v4.view.ViewPager>

</LinearLayout> 
```

然后在**PageAdapter.java**我添加了以下方法：

```
@Override
public CharSequence getPageTitle(int position) {
    return "Title Here";
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2017-02-01T06:01:02.037

由于 Android 支持[设计库 22.2.0](https://android-developers.googleblog.com/2015/05/android-design-support-library.html)，您可以使用`TabLayout`类。它与 非常相似`PagerTitleStrip`，您只需要在 ViewPagerAdapter 上指定标题。

```
@Override
public CharSequence getPageTitle(int position) {
    return titleList.get(position);
} 
```

并将其添加到您的 xml 中的任何位置。

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical">

    <android.support.design.widget.TabLayout
        android:layout_width="match_parent"
        android:layout_height="wrap_content" />

    <android.support.v4.view.ViewPager
        android:id="@+id/viewpager"
        android:layout_width="match_parent"
        android:layout_height="match_parent" />
</LinearLayout> 
```

最后，把你的`ViewPager`and绑`TabLayout`在一起。

```
TabLayout tabLayout = (TabLayout) findViewById(R.id.tab_layout);
tabLayout.setupWithViewPager(viewPager); 
```

在我看来，它看起来比`PagerTitleStrip`. `TabLayout`也适用于类似 Google Play 的标签。如果您想像@cjayem13 所说的那样进行自定义（更改选项卡颜色、文本颜色、选定颜色等），这很容易实现。有关更多详细信息，请参阅[官方文档](https://developer.android.com/reference/android/support/design/widget/TabLayout.html)或[CodePath 指南](https://guides.codepath.com/android/google-play-style-tabs-using-tablayout)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-04-21T18:51:31.747

主要的技巧是嵌套的viewpager。关于viewpager和标题的一个很好的描述性讨论。 [https://github.com/codepath/android_guides/wiki/ViewPager-with-FragmentPagerAdapter](https://github.com/codepath/android_guides/wiki/ViewPager-with-FragmentPagerAdapter)

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2012-12-29T15:15:07.133

您不需要自己实现适配器。简单地执行以下操作：

```
mPagerAdapter  = new PageAdapter(super.getSupportFragmentManager() );

mPagerAdapter.addFragment(Fragment.instantiate(this, "Title that you want"); 
```

而且您的布局缺少 PagerTitleStrip，请参阅此[链接](https://stackoverflow.com/questions/8597242/does-someone-know-how-to-use-pagertitlestrip-in-android)

ViewPager 只是容器。PagerTitleStrip 应该包含在 ViewPager 布局中，这就是标题。**

# graphics - 是否可以将我的 3D 模型（dae/blend/3ds/...）转换/导出为 GLSL ES 2.0？

> ID：14082860
> 
> 赞同：-1
> 
> 时间：2012-12-29T14:59:17.957
> 
> 标签：graphics, opengl-es, 3d, glsl, blender

是否可以将我的 3D 模型导出或转换为 GLSL ES 2.0？对于创建 GLSL ES 2.0 代码的 Blender/3DS MAX/Maya 等任何编辑器程序，是否存在任何转换器或任何导出器工具/插件？

我想在上述任何编辑器中方便地创建我的模型，然后我想将它们导出/转换为 GLSL ES 2.0。

我已经有一个显示我的着色器的模板 WebGL 代码。我想用转换器或导出器工具自动创建的 GLSL ES 代码替换我的片段着色器和顶点着色器部分。

我想做这样的事情（但对于 GLSL ES 2.0）： [Blender to GLSL](http://blenderartists.org/forum/showthread.php?233186-Export-Materials-to-GLSL-Code)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-29T15:06:06.357

您在这里将苹果与汽车进行比较。OpenGL 是一种绘图 API，GLSL 是一种用于实现着色器代码的编程语言。

3D 模型都不是。唯一的问题“如何将我的 3D 模型转换为 OpanGL？” 没有意义。

> 是否可以？

不，因为那不是 GLSL 的目的

选择一个模型文件格式（最好是直接实现读取解析器）实现解析器，填充适当的数据结构并将其提供给 OpenGL 的正确部分，进行正确的调用来绘制它们。

OpenGL 本身不处理模型、场景甚至文件。GLSL 甚至不是一种文件格式，它是一种语言。

* * *

我会从 OBJ 或 STL 文件开始。它们相当容易阅读和解释，并且非常接近 OpenGL 使用的原始类型。

可能最难阅读的格式是 .blend 文件；实际上，.blend 文件是 Blender 进程内存映像的转储。它需要一个功能齐全的 Blender（或与之非常相似的东西）来理解 .blend 文件。

* * *

* * *

### 由于评论而更新：

请仔细阅读您链接到的此导出器脚本的作用：它需要对象*材质设置*（不是模型本身）并生成 GLSL 代码，当在正确的框架中使用时（即适当的统一和属性名称、矩阵设置等.) 将导致与这些材质设置尽可能接近的着色操作。**该脚本不导出模型！**

您询问了有关导出 3D 模型的问题。那将是模型的网格和将其放置在世界中的属性。材料不是存储在 OBJ 或 STL 文件中的内容。它们是纹理，是的，着色器。但它们完全独立于模型数据本身。完全可以在多个模型上使用相同的材​​质设置，或者自由地交换模型的材质（纹理和着色器），只要模型提供所有必需的顶点属性以使该材质工作。

* * *

* * *

### 由于评论更新2：

您甚至了解着色器的作用吗？如果没有，这里有一个简短的概要：您有顶点属性数据（在缓冲区中）。这些索引属性被提交给 OpenGL。使用对 glDrawElements 或 glDrawArrays 的调用，属性被解释为基元（点、线或三角形（或旧 OpenGL 版本上的四边形））。然后对每个基元进行多次转换。

*强制：*第一步是顶点着色器，负责确定其在视口中的最终位置。

*可选：*在对顶点着色后，由顶点形成的图元进行镶嵌着色。Tesselation 用于细化几何图形，例如向地形添加细节或使曲面更平滑。

*可选：*接下来是几何着色，它可以用（少量）顶点替换单个顶点。几何着色器甚至可以改变基元类型。因此，例如可以用三角形替换单个点（对于渲染粒子系统很有用）。

*强制：*最后一步是对基元进行片段着色。在确定了图元在视口中的位置后，它所覆盖的每个像素都会在一个或多个片段中进行处理。片段着色器是一个程序，用于确定目标帧缓冲区中的最终颜色和半透明度。

每个着色步骤都由用户定义的程序控制。正是这些程序，它们被称为着色器，是用 GLSL 编写的。不是几何，没有模型。*程式！*还有非常简单的程序。它们不会从无到有地生成几何图形，它们总是处理传递给 OpenGL 的现有几何图形。

着色器不用于定义或存储模型。他们只是在渲染时修改它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-14T09:56:11.027

看看[http://www.inka3d.com](http://www.inka3d.com)，它将您的 Maya 着色器转换为 GLSL。对于模型，您需要 WebGL 还是 OpenGL ES 2.0？

# sql - 通过 for xml 路径连接字符串

> ID：14082863
> 
> 赞同：3
> 
> 时间：2012-12-29T14:59:48.240
> 
> 标签：sql, sql-server-2008, string-concatenation, for-xml-path

你好！今天我学习`for xml path`了在 mssql 中连接字符串的技术。由于我从未在 mssql 中使用过 xml，而 google 也没有帮助，所以我需要问你。

让我们想象一下默认情况。我们需要连接表中的一些字符串：

```
declare @xmlRepNames xml = (
    select          
        ', [' + report_name + ']'
    from (
        select distinct
            report_order,
            report_name
        from #report
    ) x
    order by
        report_order
    for xml path(''), type)

select
    stuff((select @xmlRepNames.value('.', 'nvarchar(max)')), 1, 1, '') 
```

所以我得到这样的东西：

```
[str1], [str2], [strn] 
```

行。它工作正常。但我有两个非常相似的连接块。不同之处在于结果字符串的样子：

*   `[str1], [str2], [strn]`
    和
*   `isnull([str1], 0) as [str1], isnull([str2], 0) as [str2], isnull([strn], 0) as [strn]`

因此，我可以使用不同的字符串构造函数编写 2 个非常相似的代码块（已经完成，顺便说一句），或者尝试将以前的代码扩展为包含 2 种构造函数的 xml 变量，然后通过 xml 节点类型连接。做第二种方式我遇到了一些问题 - 我写了这个：

```
declare @xmlRepNames xml = (
    select
        ', [' + report_name + ']' as name,
        ', isnull([' + report_name + '], 0) as [' + report_name + ']' as res
    from (
        select distinct
            report_order,
            report_name
        from #report
    ) x
    order by
        report_order
    for xml path(''), type)

select
    stuff((select @xmlRepNames.value('/name', 'nvarchar(max)')), 1, 1, ''),
    stuff((select @xmlRepNames.value('/res', 'nvarchar(max)')), 1, 1, '') 
```

但它会引发错误`"XQuery [value()]: 'value()' requires a singleton (or empty sequence), found operand of type 'xdt:untypedAtomic *'"`。
替换，例如，`'/name'`to`'/name[1]'`或任何其他`'/name[x]'`，将仅返回第 x 个“名称”记录，但不是所有连接的“名称”记录。
**[问题]**：是否有可能像我想要的那样以第二种方式解决问题，如果可能，那么如何解决？
**[免责声明]**：这个问题现在对我来说并不是很严重（第一种方式有点丑但也很好），但是如何过来看起来很有趣:) 谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T15:39:58.863

您的子查询不能返回两个值。如果您只想连接字符串，则根本不需要`xml`数据类型。您可以`stuff()`在单个语句中执行 and 子查询：

```
declare @Rep1Names nvarchar(max) = (
    stuff((select ', [' + report_name + ']' as name
           from (select distinct report_order, report_name
                 from #report
                ) x
           order by report_order
           for xml path('')
          )
         ), 1, 1, '');

declare @Rep2Names nvarchar(max) = (
    stuff(select ', isnull([' + report_name + '], 0) as [' + report_name + ']' as res
           from (select distinct report_order, report_name
                 from #report
                ) x
           order by report_order
           for xml path('')
          )
   ), 1, 1, ''); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-07T11:00:29.760

好的，所以我对 Gordon Linoff 建议的方式并不完全满意，因为我发现这种问题对我来说很实际，所以我在这里添加了另一个解决方案，而不使用`for xml path`：

```
declare
    @pivot_sequence nvarchar(max),
    @columns_sequence nvarchar(max)

select
    @pivot_sequence = coalesce(@pivot_sequence + ', [', '[') 
        + col_name + ']',
    @columns_sequence = coalesce(@columns_sequence + ', ', '')
        + 'isnull([' + col_name + '], 0) as [' + col_name + ']'
from some_table
order by
    /* some_columns if needed to order concatenation */ 
```

显然，它的工作速度会慢得多，但在行数不多的情况下，它不会对性能产生巨大影响。在我的情况下，我有动态数据透视查询，这些字符串是为它构建的 - 我不会在数据透视中有很多列，所以这对我来说很好。

# css - Susy：基于最大 px 值的流体网格

> ID：14082867
> 
> 赞同：0
> 
> 时间：2012-12-29T15:00:03.303
> 
> 标签：css, sass, compass-sass, susy-compass, grid-layout

我正在尝试制作一个流体网格，其最大宽度具有以下值：

[http://gridcalculator.dk/#/1224/12/40/56](http://gridcalculator.dk/#/1224/12/40/56)

当浏览器的大小调整到 1264px 以下（允许主体上的 20px 填充）时，所有内容（边距、装订线和列）都应该按比例缩小。这可能吗？

我已经尝试过这些方法：

第一次尝试：

```
$total-columns  : 12;
$column-width   : 56px;
$gutter-width   : 40px;
$grid-padding   : 56px; 
```

这不起作用，因为填充固定在 56px 并且不会缩小。

第二次尝试：

```
$total-columns  : 12;
$column-width   : 4.575163%;
$gutter-width   : 3.267973%;
$grid-padding   : 4.575163%;

$container-width: 1224px; 
```

这几乎可以工作，但由于某种原因，网格填充大于列宽......

我错过了什么？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T16:35:16.107

Susy 1.0 处理网格填充与列和排水沟不同。为了实现您正在寻找的东西，我们必须对连续的第一个和最后一个元素都要求特殊类。这就是 Susy 0.9 的工作方式，但它为大多数人抱怨的功能增加了很多复杂性。现在，将网格填充添加到容器而不是元素中，您想要的东西是不可能的。

网格填充现在直接添加到容器中，无需任何数学运算。在您的第一个示例中，这意味着它不会弯曲。在您的第二个示例中，浏览器将其解释为整个视口的百分比，而排水沟是容器的百分比，因此导致宽度不同。

# android - Android 不支持 ldpi 限定符

> ID：14082868
> 
> 赞同：0
> 
> 时间：2012-12-29T15:00:04.600
> 
> 标签：android, android-layout, dpi, android-drawable

我想区分以下两种设备的布局/可绘制对象：

```
1) 7" hdpi
2) 7" ldpi 
```

所以我使用以下合格的目录：

```
1) layout-sw600dp-hdpi / drawable-sw600dp-hdpi
2) layout-sw600dp-ldpi / drawable-sw600dp-ldpi 
```

但是当我在屏幕尺寸为 480x764 的 7" ldpi 设备上运行时，Android (V4.0.3) 会选择 hdpi 版本。为什么？当我阅读文档时，ldpi 应该更适合。

当我完全删除 layout-sw600dp-hdpi / drawable-sw600dp-hdpi 时，它确实选择了 2)，一切都很好。但我也需要 hdpi 版本。

那么如何区分 7" 设备的 ldpi/hpdi 版本呢？

谢谢！

安德烈

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T11:29:51.823

我再也找不到参考了，但我认为我在某处读到过，您不应该同时使用 minimumWidth (swdp) 或 Avilable width (wdp) 而不是屏幕像素密度（ldpi、hdpi 等）和这种组合的结果是不确定的。

如果您要针对不同的屏幕像素密度显示不同的可绘制对象，则应将它们放在自己的可绘制目录中，例如 drawable-ldpi/icon.png 或 drawable-hdpi/icon.png，与布局目录分开并仅保留 swdp这些布局库的术语。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T15:26:27.103

如果对多个屏幕的支持不起作用，那么您可以手动进行：

创建带有标志的 bools-ldpi、bools-hdpi：

bools-ldpi 包含名称为“lowDp”的字段 = true bools-hdpi 包含名称为“highDp”的字段 = true 等。

在代码中，您制作 if-else if-else ：

```
if ( getresource "lowDp" ) 
    ...
else if ( getresource "highDp" ) 
    ...
... 
```

# c++ - 重载可以区分非静态成员方法和其他函数的模板函数

> ID：14082869
> 
> 赞同：3
> 
> 时间：2012-12-29T15:00:07.590
> 
> 标签：c++, templates, overloading, class-method

```
struct A // some class
{
  void method(); // non-static member method
  static void function(); // static member method
};
void function(); // global function
vector<A> vi; // any such `std` like container 
```

我想要一个`Iterate()`可以通过以下方式调用的函数（比如）：

```
Iterate(vi, &A::method);  // (1)
Iterate(vi, &A::function); // (2a)
Iterate(vi, &function); // (2b) 
```

(2a) 和 (2b) 完全相同。

现在`Iterate()`原型如下（1）和（2）：

```
template<typename Container, typename Method>
void Iterate (Container &container, Method method); // for (1)

template<typename Container, typename Function>
void Iterate (Container &container, Function function); // for (2a), (2b) 
```

自然两者完全相同，这会导致编译器错误。
有没有办法`Iterate()`在 C++03 中重载/专门化，这将允许两个函数共存？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T15:03:19.693

您可以使一个功能比另一个功能更具体：

```
template<typename Container, typename Functor>
void Iterate (Container &container, Functor fun); 

template<typename Container, typename R, typename ..Args>
void Iterate (Container &container, R (Container::value_type::*fun)(Args...)); 
```

第一个模板适用于常规函数、函数对象和静态成员函数，而第二个模板仅适用于非静态成员函数。

在 C++03 中，您可以通过编写重载来模拟可变参数模板，如下所示：

```
template<typename Container, typename R>
void Iterate (Container &container, R (Container::value_type::*fun)());

template<typename Container, typename R, typename Arg>
void Iterate (Container &container, R (Container::value_type::*fun)(Arg));

template<typename Container, typename R, typename Arg1, typename Arg2>
void Iterate (Container &container, R (Container::value_type::*fun)(Arg1, Arg2));

//add more overloads to handle member functions 
//that take 3 or more arguments 
```

当然，如果您必须以不同的方式实现它们。例如，调用成员函数`(obj.*fun)(a1,a2,a3);`的语法是，而仿函数调用语法是 just `fun(a1,a2,a2)`。我不知道您会将哪些参数传递给函数（成员或仿函数）。我假设这不是真正的代码，您只是想探索语法。

重要的一点是，调用函子不需要（从容器中），但您可以将其作为参数传递给**它**`obj`。

# php - PHP 是否在函数结束后立即释放局部变量？

> ID：14082870
> 
> 赞同：8
> 
> 时间：2012-12-29T15:00:09.447
> 
> 标签：php, memory

该代码更好地说明了我的要求：

```
function foo(){

  $var = get_huge_amount_of_data();

  return $var[0];
}

$s = foo();

// is memory freed here for the $var variable created above?

do_other_stuff(); // need memory here lol 
```

所以我知道 $var 在某些时候会被释放，但是 PHP 能有效地做到这一点吗？或者我是否需要手动取消设置昂贵的变量？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2015-04-01T18:42:05.290

是的，它确实被释放了。

您可以使用以下方法进行检查：

```
function a() {
    $var = "Hello World";
    $content = "";
    for ($i = 0; $i < 10000; $i++) {
        $content .= $var;
    }
    print '<br>$content size:'.strlen($content);
    print '<br>memory in function:'.memory_get_usage();
    return null;
}

print '<br>memory before function:'.memory_get_usage();
a();
print '<br>memory after function:'.memory_get_usage(); 
```

输出：

```
memory before function:273312
$content size:110000
memory in function:383520
memory after function:273352 
```

在函数 PHP 使用 273312 字节之前。
在函数完成之前，我们再次检查了内存使用情况，它使用了 383520。
我们检查了 $content 的大小，即 110000 字节。
273312 + 110000 = 383312
剩下的 208 字节来自其他变量（我们只计算了 $content）
函数完成后，我们再次检查内存使用情况，它恢复到（几乎（40 字节差异））和之前一样.

40 字节的差异很可能是函数声明和 for 循环声明。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-26T20:02:46.320

你可以在一个类上看到这个例子，那是因为你可以在类的析构函数中“捕捉”释放一个变量：

```
class a {
  function __destruct(){
    echo "destructor<br>";
  }
}

function b(){ // test function
  $c=new a();
  echo 'exit from function b()<br>';
}

echo "before b()<br>";
b();
echo "after b()<br>";

die(); 
```

该脚本输出：

```
before b()
exit from function b()
destructor
after b() 
```

所以现在很清楚，变量在函数退出时被销毁。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-29T15:14:40.870

> 所以我知道 $var 在某些时候会被释放，但是 PHP 能有效地做到这一点吗？或者我是否需要手动取消设置昂贵的变量？

是的，PHP 做得很好。这是一个你永远不需要考虑的问题。在您的情况下，我宁愿考虑 and 之间的时刻`$var = ..`，`return ..`因为那是您无法避免内存消耗的时刻。您应该尝试找到一个解决方案，您不需要通过`get_huge_amount_of_data()`然后选择单个项目来获取整个数据集，而只需要您需要的数据。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-29T15:02:46.567

是的，这是因为`$var`它在堆栈上声明并在超出范围后立即清除

你可以参考这个[https://stackoverflow.com/a/5971224/307157](https://stackoverflow.com/a/5971224/307157)

# hadoop - Hadoop CDH3 错误。无法启动 Hadoop 数据节点守护程序

> ID：14082872
> 
> 赞同：0
> 
> 时间：2012-12-29T15:00:15.967
> 
> 标签：hadoop, startup, bigdata, cloudera

我在 VPS 上以伪分布式模式部署 Hadoop CDH3。

所以我已经安装了CDH3，然后我执行了

`sudo apt-get install hadoop-0.20-conf-pseudo`

但是如果我尝试启动所有守护进程

`for service in /etc/init.d/hadoop-0.20-*; do sudo $service start; done`

它抛出

`ERROR. Could not start Hadoop datanode daemon`

相同的安装和启动命令适用于我的笔记本。

我不明白原因。实际上日志文件是空的。可用 RAM 约为 900MB，可用磁盘空间为 98G。哪个可能是原因或我该如何发现它？我排除错误来自配置文件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T03:10:59.270

考虑使用[Cloudera Manager](https://ccp.cloudera.com/display/SUPPORT/Cloudera+Manager+Downloads)，它可以为您节省一些时间（特别是如果您使用多个节点）。Youtube 上有一段很好的[视频](http://www.youtube.com/watch?v=CobVqNMiqww) ，展示了部署过程

# iphone - 启动 safari 后返回我的应用程序

> ID：14082878
> 
> 赞同：2
> 
> 时间：2012-12-29T15:01:25.877
> 
> 标签：iphone, xcode, safari

我使用此代码启动 safari 并为客户发布消息：

```
NSURL *url = [NSURL URLWithString:@"http://www.Mysite.com/testok.html"];
[[UIApplication sharedApplication] openURL: url]; 
```

我想要做的是，在启动 safari 几秒钟后，它会自动关闭并返回到我的应用程序。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T15:06:43.847

您可以为自定义 URL 方案注册您的应用程序，并从您的网站通过 Java 脚本调用它。有关 URL 方案的更多信息，请查看[iOS App Programming Guide](http://developer.apple.com/library/ios/documentation/iPhone/Conceptual/iPhoneOSProgrammingGuide/AdvancedAppTricks/AdvancedAppTricks.html#//apple_ref/doc/uid/TP40007072-CH7-SW50)。

也许更好的解决方案是使用`UIWebView`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T15:51:16.670

使用以下步骤。`URLScheme`是最佳解决方案。我希望它对你有用。

1.  在 iPhone Info.plist 中制作`URLSchemas`如下链接

    [客户端（iPhone 项目）设置](http://mobiledevelopertips.com/cocoa/launching-your-own-application-via-a-custom-url-scheme.html)

2.  将以下 Html 代码添加到 Safari 浏览器中的重定向按钮。

    ```
    <html><head>
    <script type="text/javascript">

    function redirection() {
        var userAgent = window.navigator.userAgent;
        if (userAgent.match(/iPad/i) || userAgent.match(/iPhone/i)) {
            window.location = "myapp://"    // This is your app name. make sure it's like URLScheme Name
        }
    }
    </script>
    </head>
    <body>
    Some html page
    <input type="button" value="back" onclick="redirection()"/>
    </body>
    </html> 
    ```

# javascript - 检测 div 中单击的水平位置

> ID：14082880
> 
> 赞同：0
> 
> 时间：2012-12-29T15:01:31.387
> 
> 标签：javascript, css

当我单击流媒体栏时，将从浏览器窗口的左边缘检测位置，但在此**[演示](http://www.olmasigereken.com/demo3/)**`#progressBar`中必须从div 的左边缘检测位置。因此，由于在单击的水平位置上添加了 200px 的定位 div 。`#progressBar``left: 200px;`

我的简单检测功能：

```
function point_it(e){
      var x=e.clientX; 
      var seekSecond = Math.floor((x/1100) * ytplayer.getDuration()); //1100 is width of the progress bar 
      seekTo(seekSecond);
      document.getElementById("xPos").innerHTML=x;
    } 
```

风格：

```
 #progressBar{
position: relative;
top: 400px;
left: 200px;
width: 1100px;
height: 4px;
border: 2px solid gray;
margin: 10px;
z-index: 8;
}

#elapsedBar{
position: relative;
top: -1px;
width:0px;
height:3px;
border:1px solid;
border-color: #660033;
background-color: #660033;
margin:0px;
z-index: 10;
}

#loadedBar{
position: relative;
top: 0px;
width: 0px;
height:4px;
border:1px solid;
border-color: gray;
background-color: gray;
margin:0px;
z-index: 9;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T15:11:05.770

您可以从单击位置减去左侧位置，我只知道 jQuery 这样做的方式：

```
// Get the "left" value
var leftPos = $("#progressBar").css("left");
// Remove "px"
var leftPos = leftPos.replace("px", ""); 
```

`leftPos`然后从你得到的值中减去

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T15:17:13.783

只需`e.offsetX`在您的函数中使用而不是`e.clientX`.

`e.client...`与浏览器窗口`e.offsett...`有关，与单击的目标元素有关。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-29T15:34:03.797

你必须减去 10`x`因为`margin: 10px;`. `var x=e.clientX;`单击栏的左侧时，这将导致为 10。

# android - 从嵌套库继承的 Activity 中找不到资源

> ID：14082881
> 
> 赞同：1
> 
> 时间：2012-12-29T15:01:34.300
> 
> 标签：android, android-resources, android-library

我为 3 个应用程序创建了两个具有共享代码和资源的 android 库项目。其中一个库（我将其称为库 A）具有由所有 3 个应用程序共享的代码和资源，另一个具有仅由三个应用程序中的两个共享的代码和资源（我们将其称为库 B）。

所以我让库 B 依赖于 A。我遇到的问题是依赖于库 B 的两个应用程序。在启动第一个 Activity 时，尝试访问库 B 中定义的 xml 布局中的元素时，我得到 NoSuchFieldErrors 或 NullPointerExceptions . 似乎在labbrary B中找不到Super class的资源。我创建了一个重现问题的小例子。

**在图书馆 A：**

*AActivity.java：*

```
public class AActivity extends Activity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        doStuff();
    }

    protected void doStuff() {
    }

} 
```

*AndroidManifest.xml：*

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.example.testlib"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk
        android:minSdkVersion="10"
        android:targetSdkVersion="16" />

    <application
        android:allowBackup="true"
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/AppTheme" >
        <activity
            android:name="com.example.testliba.AActivity"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
    </application>

</manifest> 
```

**在图书馆 B：**

*BActivity.java：*

```
public class BActivity extends AActivity {

@Override
protected void onCreate(Bundle savedInstanceState) {
    setContentView(R.layout.activity_main_b);
    super.onCreate(savedInstanceState);

    AlertDialog alertDialog = new AlertDialog.Builder(this).create();
    alertDialog.setMessage(getResources().getString(R.string.buttonText));
}

@Override
protected void doStuff() {
    Button b = (Button) findViewById(R.id.button1);
    b.setText("I'm a button");
}
} 
```

*res/layout/activity_main_b.xml:*

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    tools:context=".MainActivity" >

    <TextView
        android:id="@+id/textView1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_centerHorizontal="true"
        android:layout_centerVertical="true"
        android:text="@string/hello_world" />

    <Button
        android:id="@+id/button1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignLeft="@+id/textView1"
        android:layout_below="@+id/textView1"
        android:layout_marginTop="56dp"
        android:text="@string/buttonText" />

</RelativeLayout> 
```

*AndroidManifest.xml：*

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.example.testlib"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk
        android:minSdkVersion="10"
        android:targetSdkVersion="16" />

    <application
        android:allowBackup="true"
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/AppTheme" >
        <activity
            android:name="com.example.testlibb.BActivity"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
    </application>

</manifest> 
```

**在依赖库 B 的应用程序中：**

*MainActivity.java：*

```
public class MainActivity extends BActivity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        // Contents specific for this Activity
    }
} 
```

在应用程序的*gen*目录中，我发现生成了三个*R.java*：

*   com.example.testapp
*   com.example.testlibb
*   com.example.testliba

并且*id.button1*存在于*testapp*和*testlibb的**R.java*中，并且它们在两者中具有相同的值。仍然在运行时找不到它。

 **提前致谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-09T11:57:48.493

问题原来是两个库项目中的 AndroidManifest.xml 具有相同的默认包

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.example.testlib" 
```

这在生成 R.java 时会导致问题。所以要解决这个问题，我只需要更改库项目的默认包，以便它们彼此不同：

**在图书馆 A**

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.example.testliba" 
```

**在图书馆 B**

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.example.testlibb" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T15:32:13.640

在 BActivity 中，您正在调用`super.onCreate(savedInstanceState);` AActivity 中的以下内容之后

```
super.onCreate(savedInstanceState);
doStuff(); 
```

做东西（）; 被 BActivity 覆盖

所以按钮 b = (Button) findViewById(R.id.button1); 被调用，但 setContentView(R.layout.activity_main_b); 此时仍未被调用**

# json - 超级对象 - 全部提取

> ID：14082886
> 
> 赞同：6
> 
> 时间：2012-12-29T15:01:53.907
> 
> 标签：json, delphi, delphi-xe2, superobject

如何从**通用 JSON中获取****所有“id”成员值**。**在不知道它的结构的情况下**。因为它非常复杂并且有很多子对象。它必须遍历所有子对象。

 ******对于那些不断询问示例 JSON 在哪里的人来说。我的问题是关于如何从包含该成员的任何通用 JSON 中提取我的案例“id”中的成员值**。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-29T17:12:51.783

如果您不知道从某处收到的 JSON 的结构，请务必注意 JSON“简单地”是一种复合模式，您可以像任何其他复合结构一样遍历它。以下示例遍历 JSON 文本中的完整结构并打印任何名为“id”的成员的路径。

```
procedure ParseJSON;
var
  JSONText: string;
  JSON: ISuperObject;
begin
  // Retrieve JSON as a string into JSONText variable any way you like.
  JSON := SO(JSONText);
  ProcessObject(JSON.AsObject);
end;

procedure ProcessObject(const aAsObject: TSuperTableString; const aPrefix: string = '');
var
  Names: ISuperObject;
  Name: string;
  Items: ISuperObject;
  Item: ISuperObject;
  idx: Integer;
  Value: string;
  ArrayItem: ISuperObject;
begin
  if Assigned(aAsObject) then
  begin
    Names := aAsObject.GetNames;
    Items := aAsObject.GetValues;

    for idx := 0 to Items.AsArray.Length - 1 do
    begin
      Name := Names.AsArray[idx].AsString;
      Item := Items.AsArray[idx];
      if Item.DataType = stObject then
        Value := '<Object>'
      else if Item.DataType = stArray then
        Value := '<Array>'
      else
        Value := Item.AsString;

      if SameText(Name, 'id') then
        WriteLn(Format('%s: %s', [aPrefix + Name, Value]));

      if Item.DataType = stArray then
        for ArrayItem in Item do
          ProcessObject(ArrayItem.AsObject, aPrefix + Name + '.');

      if Item.DataType = stObject then
        ProcessObject(Item.AsObject, aPrefix + Name + '.');
    end;
  end;
end; 
```****

# c - Ncurses 和实时（在 C、unix 中实现）

> ID：14082887
> 
> 赞同：5
> 
> 时间：2012-12-29T15:02:16.563
> 
> 标签：c, ncurses, time.h

我正在尝试在 C 中使用 ncurses 实现游戏。我必须显示当前时间（时间必须每秒更新），而我的 while 循环看起来像这样

```
while(1)
{
    clk = time(NULL);
    cur_time = localtime(&clk);
    mvprintw(0,1,"%d %d %d",cur_time->tm_hour,cur_time->tm_min,cur_time->tm_sec);
    int key = getch()
    //other stuff
} 
```

我的问题是只有当我按下一个键时时间才会刷新。这是一种无需按键即可刷新时间（并同时实现此功能）的方法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-02T22:01:14.370

您可以使用几个功能：

1.  节点层
2.  暂停

int nodelay(WINDOW *win, bool bf);

设置 bf true 使 getch() 非阻塞

无效超时（int延迟）；

延迟以毫秒为单位，因此如果将其设置为 1000，则 getch 将在一秒钟后超时。

在这两种情况下，如果没有输入，getch 将返回 ERR。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T15:32:10.870

这里的解决方案是使用非阻塞 IO 或使用线程。然而，使用线程会给你带来一个新问题，那就是在任何给定时间只有一个线程可以使用curses，所以你需要使用锁或类似的东西来防止其他线程在那个时候使用curses时间。当然，一种解决方案是让一个线程负责更新屏幕内容，而其他线程只需向该线程发送“我想在 X，Y 屏幕上显示”的消息

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T18:59:57.293

这是一个非常丑陋的 hack，它只支持一个 stdio 函数：fgetc()。其他*可以*添加，顺便说一句。它通过设置计时器来工作，如果在读取单个字符之前警报响起，则返回 -2 值（请记住：-1 表示 EOF）

它**不适**用于任何其他 curses 的 wgetXXX() 函数，这些函数可能会直接调用 fgetc() （等）。YMMV。

但是，在一般情况下，我认为您应该调查 wgetch_events()。

```
#include <stdio.h>
#include <string.h>
#include <unistd.h>
#include <signal.h>
#include <setjmp.h>

sigjmp_buf the_jump;

int my_fgetc(FILE *fp, unsigned timeout);
void sig_handler(int signr);

void sig_handler(int signr) {
        switch (signr) {
        case SIGALRM:
              siglongjmp(the_jump,1);
              break;
        default:
              break;
        }
}

int my_fgetc(FILE *fp, unsigned timeout)
{
alarm( timeout);

switch (sigsetjmp(the_jump, -1)) {
case 0:
        alarm(0);
        return fgetc (fp);
case 1:
        return -2;
default:
        return -3;
        }
}

int main()
{
int rc;
signal(SIGALRM, sig_handler);

rc = setvbuf(stdin, NULL, _IONBF, 0);
printf("setvbuf(_IONBF) = %d\n", rc);
while (1) {
        rc = my_fgetc(stdin, 1);
        printf("my_fgetc(NULL) = %d\n", rc);
        }

return 0;
} 
```

# wordpress - 如何在没有插件的情况下将食谱丰富片段添加到 WordPress 网站？

> ID：14082888
> 
> 赞同：1
> 
> 时间：2012-12-29T15:02:20.597
> 
> 标签：wordpress, microdata

我是一名美食博主，最近了解了食谱丰富的片段。我在网上找到了一些资料，主要是关于插件的。我尝试使用[ZipList 插件](http://wordpress.org/extend/plugins/ziplist-recipe-plugin/)，这实际上非常好，但是

1.  对于某些帖子，我无法在食谱框中添加图片，并且

2.  我无法在我的图片中添加替代文字（我发现这对 SEO 非常不友好，或者是吗？）。

所以，我正在考虑尝试自己在我的网站上实现它。
关于如何做的任何好的链接或建议？我试着在谷歌上寻找，但我只是想出插件教程。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T20:42:06.457

是的，您的搜索结果是正确的。

如果您不想使用插件，则必须自己编写代码。但这是您不希望附加到主题`functions.php`（“没有插件”）的东西。因为您必须能够交换主题并保留此功能。主题用于设计和内容展示。功能插件。所有那些结合了 SEO 的主题都是愚蠢的。

因此，您最终会编写自己的插件。请参阅这篇文章：[创建功能插件而不是使用 Functions.php](http://www.doitwithwp.com/create-functions-plugin/)。

> ### 什么是功能插件？
> 
> 传统上，如果您想为您的博客创建一个新函数以添加其功能，建议将代码片段添加到主题的 functions.php 文件中。现在一切都很好，它会正常工作，但是当您更改站点的主题（您可以保证至少每隔几年发生一次）或主题更新时会发生什么？由于 functions.php 位于您的活动主题文件夹中，因此如果您更改主题，它本质上就会失效。

话虽如此，我建议您创建一个自定义帖子类型来处理您的食谱片段。您将拥有根据您的需要定制的 WordPress 的所有默认功能。CPT 可能只有标题、内容和特色图片，最终是您自己的分类（食谱类别）。

有用的链接：

*   [CPT 文件](http://codex.wordpress.org/Post_Types#Custom_Types)
*   [粉碎杂志教程](http://wp.smashingmagazine.com/2012/11/08/complete-guide-custom-post-types/)
*   [WP Tuts 教程](http://wp.tutsplus.com/tutorials/plugins/a-guide-to-wordpress-custom-post-types-creation-display-and-meta-boxes/)

或者你可以使用一个[不错的插件](http://wordpress.org/extend/plugins/custom-post-type-ui/)来创建你的 CPT :)

# javascript - SickGrid 失控列名行

> ID：14082890
> 
> 赞同：0
> 
> 时间：2012-12-29T15:02:27.533
> 
> 标签：javascript, slickgrid

浏览我的第一个 SlickGrid 示例。我遇到了这个问题，其中显示列名的标题行将简单地运行通过表本身。

我附上了显示不当行为的屏幕截图。请注意列名出现的标题的长度。

![在此处输入图像描述](../Images/ca5f5e78650e918bd8a7c0009bff1f7a.png) 我的代码如下。请帮忙。

```
<html>
<head>
        <link rel="stylesheet" href="./slick/slick.grid.css" type="text/css"/>
        <link rel="stylesheet" href="./slick/examples/examples.css" type="text/css"/>

    <script src="./slick/lib/jquery-1.7.min.js"></script>
    <script src="./slick/lib/jquery-ui-1.8.16.custom.min.js"></script>
    <script src="./slick/lib/jquery.event.drag-2.0.min.js"></script>

    <script src="./slick/slick.editors.js"></script>
    <script src="./slick/slick.core.js"></script>
    <script src="./slick/slick.grid.js"></script>
 </head>

<body>
<div id="container"></div>

<script>

     var grid,
      data = [],
      columns = [
        { id: "col1", name: "Col1", field: "col1"},
        { id: "col2", name: "Col2", field: "col2" },
        { id: "col3", name: "Col3", field: "col3" },
        { id: "col4", name: "Col4", field: "col4" },
        { id: "col5", name: "Col5", field: "col5" },
        { id: "col6", name: "Col6", field: "col6" }
      ],
      options = {
        editable: false,
        enableAddRow: true,
        enableCellNavigation: false,
        autoHeight: true
      };
  for (var i = 5; i-- > 0;) {
        data[i] = {
          col1: "",
          col2: "",
          col3: "",
          col4: "",
      col5: "",
      col6: ""
    };
  }
  grid = new Slick.Grid("#container", data, columns, options);  
</script>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T17:11:32.297

将 div 容器的宽度设置为表格的确切宽度可以解决此问题。

```
<div id="container" style="width:480px;"></div> 
```

# java - 在 Java 中实现备忘录模式的不同方法

> ID：14082892
> 
> 赞同：3
> 
> 时间：2012-12-29T15:02:28.950
> 
> 标签：java, design-patterns, memento

我正在对纪念品模式进行一些研究，似乎我遇到的大多数示例似乎都比较相似（将字符串保存到数组中并在需要时恢复它）如果我错了，现在纠正我，但我相信我刚刚描述的方法是“对象克隆”，但是实现备忘录模式的其他方法是什么？

从我也了解到可以使用序列化，但似乎有一个灰色区域，人们说它违反了对象的封装，因此不是实现 Memento 模式的方法。

那么任何人都能够阐明实现该模式的方法吗？我的研究提出了一种所有不同事物的混合体，只是让一切变得混乱。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-07T19:14:26.230

memento 实现可能带来的一个常见问题是，通常需要许多类来表示不同类型对象的内部状态。或者 memento 实现必须将对象状态序列化为其他形式（例如序列化的 java 对象）。

这是一个备忘录实现的草图，它不依赖于每个类的特定备忘录类，其状态将被捕获以支持撤消/重做。

首先要介绍一个基本概念：

```
public interface Reference<T> {
    T get();
    void set(T value);
} 
```

这是 的抽象`java.lang.ref.Reference`，因为该类用于垃圾收集目的。但是我们需要将它用于业务逻辑。基本上，引用封装了一个字段。所以他们打算这样使用：

```
public class Person {
    private final Reference<String> lastName;
    private final Reference<Date> dateOfBirth;

    // constructor ...

    public String getLastName() {
        return lastName.get();
    }

    public void setLastName(String lastName) {
        this.lastName.set(lastName);
    }

    public Date getDateOfBirt() {
        return dateOfBirth.get();
    }

    public void setDateOfBirth(Date dateOfBirth) {
        this.dateOfBirth.set(dateOfBirth);
    }
} 
```

请注意，使用这些引用进行对象实例化可能不是那么简单，但我们将其留在这里。

现在这里是 memento 实现的详细信息：

```
public interface Caretaker {

    void addChange(Change change);
    void undo();
    void redo();
    void checkpoint();   
}

public interface Change {

    Change createReversal();
    void revert();
} 
```

基本上 a`Change`表示对可识别对象状态的单个可识别更改。`Change`通过调用方法可以恢复A `revert`，并且可以通过恢复由`createReversal`方法创建的 Change 来恢复该更改的反转。通过该方法`Caretaker`累积对对象状态的更改`addChange`。通过调用`undo`and`redo`方法，`Caretaker`恢复或重做（即恢复更改的反转）所有更改，直到到达下一个检查点。检查点表示所有观察到的更改将累积到将所有更改对象的所有状态从一个有效配置转换为另一个有效配置的更改的点。检查点通常在操作之前或之前创建。这些是通过创建的`checkpoint`方法。

现在这里是如何使用`Caretaker`with `Reference`：

```
public class ReferenceChange<T> implements Change {

    private final Reference<T> reference;
    private final T oldValue;
    private final T currentReferenceValue;

    public ReferenceChange(Reference<T> reference, T oldValue,
            T currentReferenceValue) {
        super();
        this.reference = reference;
        this.oldValue = oldValue;
        this.currentReferenceValue = currentReferenceValue;
    }

    @Override
    public void revert() {
        reference.set(oldValue);
    }

    @Override
    public Change createReversal() {
        return new ReferenceChange<T>(reference, currentReferenceValue,
                oldValue);
    }
}

public class CaretakingReference<T> implements Reference<T> {

    private final Reference<T> delegate;
    private final Caretaker caretaker;

    public CaretakingReference(Reference<T> delegate, Caretaker caretaker) {
        super();
        this.delegate = delegate;
        this.caretaker = caretaker;
    }

    @Override
    public T get() {
        return delegate.get();
    }

    @Override
    public void set(T value) {
        T oldValue = delegate.get();
        delegate.set(value);
        caretaker.addChange(new ReferenceChange<T>(delegate, oldValue, value));
    }
} 
```

存在`Change`表示 a 的值如何`Reference`变化的 a。这`Change`是在`CaretakingReference`设置时创建的。在这个实现中，需要嵌套`Reference`在`CaretakingReference`实现中，因为 a`revert`不`ReferenceChange`应该`addChange`通过`CaretakingReference`.

集合属性不需要使用`Reference`. 在这种情况下，应该使用触发照顾的自定义实现。基元可以与自动装箱一起使用。

此实现通过始终使用引用而不是直接使用字段来推断额外的运行时和内存成本。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-29T15:30:26.710

Java Collections 框架定义了`Queue`，它可以提供帮助。

候选代码：

```
public final class Memento<T>
{
    // List of saved values
    private final Queue<T> queue = new ArrayDeque<T>();

    // Last entered value, whether it has been saved or not
    private T currentValue;

    // No initial state, ie currentValue will be null on construction, hence
    // no constructor

    // Set a value, don't save it
    public void set(final T value)
    {
        currentValue = value;
    }

    // Persist the currently saved value
    public void persist()
    {
        queue.add(currentValue);
    }

    // Return the last saved value
    public T lastSaved()
    {
        return queue.element();
    }

    // Return the last entered value
    public T lastEntered()
    {
        return currentValue;
    }
} 
```

这段代码中明显缺少很多东西，但很容易实现：

*   恢复到上次保存的值；
*   不检查空值；
*   `T`不执行`Serializable`；
*   便捷方法（例如，添加一个值并使其成为最后保存的状态）；
*   **代码不是线程安全的**！

等等。

示例代码：

```
public static void main(final String... args)
{
    final Memento<String> memento = new Memento<String>();

    memento.set("state1");
    System.out.println(memento.lastEntered()); // "state1"
    memento.persist();
    memento.set("state2");
    System.out.println(memento.lastEntered()); // "state2"
    System.out.println(memento.lastSaved()); // "state1"
} 
```

实际上：这是一个可以改进的脑死实现，但可以用作基础——扩展它取决于您的需要；）

# c# - 如何在 Windows Store App 中编辑和保存照片？

> ID：14082901
> 
> 赞同：4
> 
> 时间：2012-12-29T15:03:28.393
> 
> 标签：c#, windows-8, windows-store-apps

我制作了一些编辑照片并将其保存在其他位置的应用程序。所以我发现了一个[问题](https://stackoverflow.com/questions/12349611/how-to-resize-image-in-c-sharp-winrt-winmd)，它显示了如何在 Windows 应用商店应用程序中调整照片大小。然后我在我的程序中实现它：

```
private async void ResizeButton_Click(object sender, RoutedEventArgs e)
{
    uint width, height;
    if (uint.TryParse(WidthTextBox.Text, out width) && uint.TryParse(HeightTextBox.Text, out height) 
        && _folderWithPhoto != null && _targetFolder != null)
        //_folderWithPhoto and _targetFolder are StorageFolder values get from FolderPicker
    {
        var files = await _folderWithPhoto.GetFilesAsync();
        foreach (StorageFile item in files)
        {
            if (item.ContentType.Contains("image"))
            {
                StorageFile targetFile = await item.CopyAsync(_targetFolder, item.Name, NameCollisionOption.GenerateUniqueName);

                var fileStream = await targetFile.OpenAsync(Windows.Storage.FileAccessMode.ReadWrite);
                BitmapDecoder decoder = await BitmapDecoder.CreateAsync(fileStream);

                InMemoryRandomAccessStream ras = new InMemoryRandomAccessStream();
                BitmapEncoder enc = await BitmapEncoder.CreateForTranscodingAsync(ras, decoder);

                enc.BitmapTransform.ScaledHeight = height;
                enc.BitmapTransform.ScaledWidth = width;

                await enc.FlushAsync();
            }
        }
    }
} 
```

**问题**

此代码的结果是保存在`_targetFolder`目录中的同一张照片。所以我不知道如何解决它。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T17:12:53.877

Mateusz 在你的 foreach 循环中会不会有这样的东西我不确定

```
ras.Seek(0);
fileStream.Seek(0);
fileStream.Size = 0;
await RandomAccessStream.CopyAsync(ras, fileStream);

fileStream.Dispose();
ras.Dispose(); 
```

# mysql - 根据另一个查询对查询进行排序 AVG

> ID：14082906
> 
> 赞同：0
> 
> 时间：2012-12-29T15:03:44.833
> 
> 标签：mysql

这是我当前获取交易的查询：

```
SELECT deals.*, SUM(orders.cost) AS 'revenue' FROM deals
LEFT JOIN orders ON (orders.deal_id = deals.id)
WHERE 1
AND (orders.status = 'new' OR orders.status = 'delivered')
GROUP BY deals.ID
ORDER BY revenue ASC 
```

现在这很好用，我可以通过（排序依据）我希望在订单或交易表中的任何字段对这个查询进行排序。

然后，当我遍历交易并使用 foreach() 显示它们时，我有这个查询来从客户那里获取交易的平均评论星数：

```
SELECT ROUND(AVG(stars)) as 'avg_stars' FROM deals_reviews WHERE deal_id = *THE DEAL_ID* AND active = '1' 
```

现在我想从平均星级中将所有交易 ASC/DESC 排序出来。

为此，我需要将该查询与上述查询合并，当我需要显示 avg_stars 时，我从第一个也是唯一一个查询而不是第二个查询中获取该值。

我怎样才能将该查询“合并”到第一个查询中？所以当那完成后，我们可以做 ORDER BY avg_stars DESC 并且它会按这个排序？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T15:24:42.330

我不确定我是否理解正确，但这应该是解决方案

```
SELECT deals.*, SUM(orders.cost) AS 'revenue' FROM deals
LEFT JOIN orders ON (orders.deal_id = deals.id)
LEFT JOIN deals_reviews ON (deals.id = deals_reviews.deal_id AND active = '1')
WHERE 1
AND (orders.status = 'new' OR orders.status = 'delivered')
GROUP BY deals.ID
ORDER BY ROUND(AVG(stars)) as 'avg_stars' ASC 
```

# listbox - Google Script - 无法在同一脚本上组合来自 listBox 和 SubmitButton 的多项选择

> ID：14082907
> 
> 赞同：0
> 
> 时间：2012-12-29T15:03:57.813
> 
> 标签：listbox, google-apps-script, submit-button

我正在尝试在 google app 上编写代码，但遇到了一个问题。例如，让我们考虑一下谷歌网站上的这个示例代码（链接在这里[https://developers.google.com/apps-script/class_formpanel](https://developers.google.com/apps-script/class_formpanel)）

```
 function doGet() {
 var app = UiApp.createApplication();
 var form = app.createFormPanel();
 var flow = app.createFlowPanel();
 flow.add(app.createTextBox().setName("textBox"));
 flow.add(app.createListBox().setName("listBox").addItem("option 1").addItem("option 2"));
 flow.add(app.createSubmitButton("Submit"));
 form.add(flow);
 app.add(form);
 return app;
 }

 function doPost(eventInfo) {
 var app = UiApp.getActiveApplication();
 app.add(app.createLabel("Form submitted. The text box's value was '" +
   eventInfo.parameter.textBox +
   "' and the list box's value was '" +
   eventInfo.parameter.listBox + "'"));
 return app;
  } 
```

我的问题是我想在列表框中选择多个值。然后我更改第 6 行

```
 flow.add(app.createListBox(true).setName("listBox").addItem("option 1").addItem("option 2")); 
```

允许多选。但结果是只取最后一个选择的值，防止多选。显然，这是由于提交按钮。我需要保留 formPanel，因为在进一步的代码中，我想结合上传文件和 listBox 多项选择。我该如何解决？十分感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-19T14:38:14.063

作为对 Mogsdad 答案的补充，请注意，此错误/问题仅与 doPost 结构化处理程序有关……如果您不需要文件上传功能，则可以使用带有 callbackElement 的简单 doGet + 处理程序，在这种情况下为多选列表可用并按预期工作。

测试功能：

```
function doGet() {
  var app = UiApp.createApplication().setTitle('test listBox');
  var panel = app.createHorizontalPanel().setStyleAttribute('padding','40px');
  var sHdlr = app.createServerHandler('validateList').addCallbackElement(panel);
  var items = ['category 1','category 2','category 3'];
  var list1 = app.createListBox(true).setName('list1');
  for(var i =0;i<items.length;++i){list1.addItem(items[i],i)}
  panel.add(list1).add(app.createButton('validate',sHdlr));
  app.add(panel);
  return app;
}

function validateList(e){
  var app = UiApp.getActiveApplication();
  app.add(app.createLabel("Value(s) in list : "+e.parameter.list1).setStyleAttribute('margin-left','40'));
  return app;
} 
```

以下是问题跟踪器中描述的解决方法的工作示例。我使用文本框来显示该过程，将其设置为可见（假）或在“真实”应用程序中使用隐藏的小部件。（[可在此处进行测试](https://script.google.com/macros/s/AKfycbziU3gNTqr2y48QsbqgJDkXgEnE3o20YRemoreO2wMycea3Plk/exec)）

```
function doGet() {
  var app = UiApp.createApplication().setTitle('test listBox');
  var panel = app.createHorizontalPanel().setStyleAttribute('padding','40px');
  var listHandler = app.createServerHandler('updlistVal').addCallbackElement(panel);
  var items = ['category 1','category 2','category 3'];
  var list1 = app.createListBox(true).setName('list1').addChangeHandler(listHandler);
  for(var i =0;i<items.length;++i){list1.addItem(items[i])}
  panel.add(list1).add(app.createTextBox().setText(items[0]).setId('listboxVal').setName('listboxVal').setWidth('200'));// set a default value in case the user is happy with that and doesn't touch the listBox
  var submitBtn = app.createSubmitButton('test').setStyleAttribute('margin-left','40');
  app.add(app.createFormPanel().add(panel.add(submitBtn)));
  return app;
}

function doPost(e){
  var app = UiApp.getActiveApplication();
  app.add(app.createLabel().setStyleAttribute('padding','40').setText("Submitted value(s) from list : "+e.parameter.listboxVal));
  return app;
}

function updlistVal(e){
  var app = UiApp.getActiveApplication();
  app.getElementById('listboxVal').setValue(e.parameter.list1);
  return app;
} 
```

* * *

**编辑 2：** 正如在这篇文章的评论中提到的，我们必须找到一种方法来防止在隐藏/文本小部件的值更新为有效值之前完成提交。我上面使用的“默认值”是一种可能的解决方案，另一种是仅当 listValue（或其在隐藏小部件中的值）正确时才使用客户端处理程序来验证提交按钮。这是执行此操作的代码（仅复制了 doGet，所有其他功能都相同。

```
function doGet() {
  var app = UiApp.createApplication().setTitle('test listBox');
  var panel = app.createHorizontalPanel().setStyleAttribute('padding','40px');
  var submitBtn = app.createSubmitButton('test').setStyleAttribute('margin-left','40').setEnabled(false);
  var listHandler = app.createServerHandler('updlistVal').addCallbackElement(panel);
  var items = ['category 1','category 2','category 3'];
  var listVal = app.createTextBox().setText('not defined yet').setId('listboxVal').setName('listboxVal').setWidth('200');
  var list1 = app.createListBox(true).setName('list1').addChangeHandler(listHandler).addItem('choose one or more item(s)');
  for(var i =0;i<items.length;++i){list1.addItem(items[i])}
  var clientH = app.createClientHandler().forTargets(submitBtn).setEnabled(true).validateMatches(list1, 'category');
  list1.addClickHandler(clientH);
  panel.add(list1).add(listVal);// set a default value in case the user is happy with that and doesn't touch the listBox
  app.add(app.createFormPanel().add(panel.add(submitBtn)));
  return app;
} 
```

使用隐藏的小部件作为验证源会导致一个小问题，因为我们需要在 listBox 上单击两次才能使其工作......如果表单上有其他问题，这将通过触发客户端处理程序与所有其他小部件来解决，所以双击将不再是必要的，但恐怕这变得有点*“脱离主题”了。*

* * *

**编辑 3：**

只是为了好玩，最后一个版本显然没有问题......

[在这里测试](https://script.google.com/macros/s/AKfycbzJqJ9TMjO5gLIKT3hrzSKS5_ouL6hB48dmELo6cPjyw6AdA9o/exec)

```
function doGet() {
  var app = UiApp.createApplication().setTitle('test listBox');
  var panel = app.createHorizontalPanel().setStyleAttribute('padding','40px');
  var submitBtn = app.createSubmitButton('test').setStyleAttribute('margin-left','40').setEnabled(false).setId('sbmt');
  var wait = app.createImage('https://dl.dropboxusercontent.com/u/211279/loading3T.gif').setId('wait').setVisible(false);
  var listHandler = app.createServerHandler('updlistVal').addCallbackElement(panel);
  var items = ['category 1','category 2','category 3'];
  var listVal = app.createTextBox().setText('not defined yet').setId('listboxVal').setName('listboxVal').setWidth('200');
  var list1 = app.createListBox(true).setName('list1').addChangeHandler(listHandler).addItem('choose one or more item(s)');
  for(var i =0;i<items.length;++i){list1.addItem(items[i])}
  var clientH = app.createClientHandler().forTargets(wait).setVisible(true).forTargets(submitBtn).setEnabled(false);
  list1.addChangeHandler(clientH);
  panel.add(list1).add(listVal);// set a default value in case the user is happy with that and doesn't touch the listBox
  app.add(app.createFormPanel().add(panel.add(submitBtn).add(wait)));
  return app;
}

function doPost(e){
  var app = UiApp.getActiveApplication();
  app.add(app.createLabel().setStyleAttribute('padding','40').setText("Submitted value(s) from list : "+e.parameter.listboxVal));
  return app;
}

function updlistVal(e){
  var app = UiApp.getActiveApplication();
  app.getElementById('listboxVal').setValue(e.parameter.list1);
  app.getElementById('sbmt').setEnabled(true);
  app.getElementById('wait').setVisible(false);
  return app;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-19T13:43:16.687

这是问题跟踪器[Issue 959](https://code.google.com/p/google-apps-script-issues/issues/detail?id=959)中的一个已知错误。访问并为其加注星标以获取更新。

如果您相信支持团队添加的注释，那么它自 2011 年 12 月以来就已为人所知并“开始工作”。其他用户提供了一种解决方法，它的修改版本显示在下面。

想法是将处理函数附加到 ListBox，它将接收来自 ListBox 的所有选定项。然后，处理程序会将这些值写入表单中的隐藏元素。提交表单后，选择列表将`doPost()`通过隐藏元素提供给 。

```
 ...
  var listbox = app.createListBox(true).setName("listBox").addItem("option 1").addItem("option 2");
  flow.add(listbox);

  // Issue 959 ListBox Workaround: http://code.google.com/p/google-apps-script-issues/issues/detail?id=959
  var listboxHidden= app.createHidden("listboxHidden", "").setId("listboxHidden");
  flow.add(listboxHidden);
  var fixListBoxHandler = app.createServerHandler('fixListBoxHandler');
  fixListBoxHandler.addCallbackElement(listbox);
  listbox.addChangeHandler(fixListBoxHandler);

  ...
}

function fixListBoxHandler(e) {

  var app = UiApp.getActiveApplication();
  app.getElementById('listboxHidden').setValue(e.parameter.listbox);
  return app;

} 
```

注意：不幸的是，这种解决方法是时间敏感的；处理程序可能需要几秒钟来更新隐藏值。如果在处理程序完成其工作之前点击提交按钮，则 post() 会在调用处理程序*之前接收隐藏元素中的内容。*

# python - 将文件中的数据读取到python中的不同数组中

> ID：14082909
> 
> 赞同：0
> 
> 时间：2012-12-29T15:04:06.560
> 
> 标签：python, blender, readfile

我正在为搅拌机创建一个简单的脚本，我需要一些帮助来从我之前通过 python 创建的文件中获取一些数据。

该文件的结构如下：

```
name first morph
values -1.0000 1.0000
data 35 0.026703 0.115768 -0.068769
data 36 -0.049349 0.015188 -0.029470
data 37 -0.042880 -0.045805 -0.039931
data 38 0.000000 0.115775 -0.068780
name second morph
values -0.6000 1.2000
data 03 0.037259 -0.046251 -0.020062
data 04 -0.010330 -0.046106 -0.019890
… 
```

等更多 2k 行；p

我需要的是创建一个循环，为我逐行读取这些数据并将值放入三个不同的数组中：names[] values[] 和 data[] 取决于文件行的第一个单词。

```
Manualy it should be like that:
names.append('first morph')
values.append( (-1.0000,1.0000))
data.append((35, 0.026703, 0.115768, -0.068769))
data.append((36, -0.049349, 0.015188, -0.029470))
data.append((37, -0.042880, -0.045805, -0.039931))
data.append((38, 0.000000, 0.115775, -0.068780))
names.append('second morph')
values.append( (-0.6000,1.2000))
… 
```

我不知道为什么我尝试创建这种“for line in file:”循环创建的错误多于完整数据，我不知道为什么超出范围或没有获取正确的数据

请帮助如何自动化该过程，而不是手动编写每一行，因为我已经将所需的参数导出到文件中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T15:19:04.610

```
names = []
values = []
data = []
with open('yourfile') as lines:
    for line in lines:
        first, rest = line.split(' ', 1)

        if first == 'name':
            names.append(rest)

        elif first == 'values':
            floats = map(float, rest.split())
            values.append(tuple(floats))

        elif first == 'data':
            int_str, floats_str = rest.split(' ', 1)
            floats = map(float, floats_str.split())
            data.append( (int(int_str),) + tuple(floats) ) 
```

你为什么需要这样？您如何知道下一个名称在数据和值列表中的起始位置？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T15:19:12.143

这是一个简单的python“for line in”解决方案......你可以打电话`processed.py`......

```
fp = open("data1.txt", "r")

data = fp.readlines()
fp1 = open("processed.py", "w")

fp1.write("names = []\nvalues=[]\ndata=[]\n")

for line in data:
    s = ""
    if "name" in line:
        s = "names.append('" + line[5:].strip() + "')"
    elif "values" in line:
        s = "values.append((" + ", ".join(line[7:].strip().split(" ")) + "))"
    elif "data" in line:
        s = "data.append((" + ", ".join(line[5:].strip().split(" ")) + "))"

    fp1.write(s + "\n");

fp1.close()
fp.close() 
```

# php - 更改 SQL 查询的日期格式

> ID：14082911
> 
> 赞同：0
> 
> 时间：2012-12-29T15:04:12.077
> 
> 标签：php, mysql, sql

我通过表单（月份和年份）将一些变量传递到 SQL 查询中，该查询根据选定的月份和年份显示结果。我有一个月份和年份的选择菜单。我的日期时间戳是 (yyyy,mm,dd) 当我回显结果而不是数值时，如何显示月份的全文？这是我的查询

```
 // Query For Contract Items
    if(isset($_GET['month'])){
    $month = $_GET['month'];
    $year = $_GET['year'];
    $ds = (int)$year."-". (int)$month;
    $result = mysql_query("SELECT * FROM projects WHERE  end_date LIKE '$ds%' AND status!='Invoiced' AND status!='Done' AND status!='Delayed' AND billed='Contract' ORDER BY client, start_date DESC");

$result2 = mysql_query("SELECT SUM(amount) * 100 AS sum_ammount FROM projects WHERE end_date LIKE '$ds%' AND status!='Invoiced' AND status!='Done' AND status!='Delayed' AND billed='Contract' ORDER BY client, start_date DESC");
$information = mysql_fetch_array($result2);
}

<form action="est.php" method="get">
                          <table width="920" border="0" cellspacing="0" cellpadding="0">
                            <tr>
                              <td align="left" valign="top">
                                  <fieldset style="float:left; margin-right:20px;">
                                   <label>Month</label>
                                    <select name="month">
                                    <option value='01' >January</option>
                                    <option value='02'>February</option>
                                    <option value='03'>March</option>
                                    <option value='04'>April</option>
                                    <option value='05'>May</option>
                                    <option value='06'>June</option>
                                    <option value='07'>July</option>
                                    <option value='08'>August</option>
                                    <option value='09'>September</option>
                                    <option value='10'>October</option>
                                    <option value='11'>November</option>
                                    <option value='12'>December</option>
                                  </select>
                                  </fieldset>
                                    <fieldset style="float:left; margin-right:20px;">
                                   <label>Year</label>
                                   <input type=text name="year" size="4" style="width:100px;" value="<?php echo $year; ?>"></fieldset>
                                  <fieldset style="float:left; margin-right:20px;">
                                  <input type="submit" style="margin-top:16px;" value="Crunch Numbers">
                                  </fieldset>
      </td></tr></table>
      </form>
  <div style="clear:both"></div>

<h3><?php echo $month; ?> / <?php echo $year; ?> Contract</h3>
<table id="myTable" class="tablesorter" cellpadding="0" cellspacing="0">
            <thead>
                <tr>
                    <th width="10%">Client</th>

                    <th width="10%">Project</th>

                    <th width="10%">Designer</th>

                    <th width="5%">Start Date</th>

                    <th width="5%">End Date</th>

                    <th width="10%">Time</th>

                    <th width="10%"></th>
                </tr>
            </thead>

            <tbody>

            <?php
                            while ($row = mysql_fetch_assoc($result)) {

                                                                $id = $row['id'];
                                                                $client = $row['client'];
                                                                $title = $row['title'];
                                                                $assigned = $row['assigned'];
                                                                $start_date = date('F d, Y', strtotime($row['start_date']));
                                                                $end_date = date('F d, Y', strtotime($row['end_date']));
                                                                $status = $row['status'];
                                                                $amount = $row['amount'];
                                                                $billed = $row['billed'];

                                                        ?>

                            <?php 

                            $x++; 

                            $class = ($x%2 == 0)? 'whiteBackground': 'graybackground';

                            echo "<tr class=\"$class\">";

                            ?>

                    <td width="10%"><strong><span class="sentanceCase"><?php echo $client; ?></span></strong></td>

                    <td width="10%"><?php echo $title; ?><br/>

                   <span class="gray"><?php echo $billed; ?></span>

                   <span class="hours">...............................</span><br />
                   <?php echo $status; ?>

                   </td>

                    <td width="5%"><?php echo $assigned; ?></td>

                    <td width="10%"><span class="hours"><?php echo $start_date; ?></span></td>

                    <td width="10%">

                    <?
                    if (strtotime($row['end_date']) <= strtotime(date('Y-m-d'))) {

                        echo ' <span style="color:red;">';
                        echo $end_date;
                        echo ' <span>';
                    }
                    else{
                         echo $end_date;
                    }

                    ?>

                  </td>

                    <td width="10%">

                    <?php echo $amount; ?> Est. Hrs<br />

                    <span class="hours">...............................</span> <br />

                    <?php
                    if ( $feeA >= 1 )
                    {
                        echo $feeA;
                        echo ' Mang/Coord <br/>';
                    }

                    ?> <?php
                    if ( $feeB >= 1 )
                    {
                        echo $feeB;
                        echo ' Coord/Res <br/>';
                    }

                    ?> <?php
                    if ( $feeC >= 1 )
                    {
                        echo $feeC;
                        echo ' Design & Dev <br/>';
                    }

                    ?> <?php
                    if ( $feeD >= 1 )
                    {
                        echo $feeD;
                        echo ' Art D <br/>';
                    }

                    ?> <?php
                    if ( $feeE >= 1 )
                    {
                        echo $feeE;
                        echo ' Web Design <br/>';
                    }

                    ?> <?php
                    if ( $feeF >= 1 )
                    {
                        echo $feeF;
                        echo ' Copy <br/>';
                    }

                    ?> <?php
                    if ( $feeG >= 1 )
                    {
                        echo $feeG;
                        echo ' Photography <br/>';
                    }

                    ?> <?php
                    if ( $feeH >= 1 )
                    {
                        echo $feeH;
                        echo ' Enviro Design <br/>';
                    }

                    ?> <?php
                    if ( $feeI >= 1 )
                    {
                        echo $feeI;
                        echo ' Photo Manip <br/>';
                    }

                    ?> <?php
                    if ( $feeK >= 1 )
                    {
                        echo $feeK;
                        echo ' Marketing <br/>';
                    }

                    ?> <?php
                    if ( $feeL >= 1 )
                    {
                        echo $feeL;
                        echo ' Strategy Dev <br/>';
                    }

                    ?>
                    <?php
                    if ( $feeM >= 1 )
                    {
                        echo $feeM;
                        echo ' Web Level 1 <br/>';
                    }

                    ?>

                     <?php
                    if ( $feeN >= 1 )
                    {
                        echo $feeN;
                        echo ' Web Level 2 <br/>';
                    }

                    ?>

                     <span class="hours">...............................</span> <br />

                    <?php
                    if ( $billing_need == 'Yes' )
                    {
                        echo '<span style="color:red">';
                        echo $extended_billing;
                        echo '<span>';
                    }

                    ?>

                    </td>

                    <td width="10%">
                    <div id="changes">

                    <div id="edit"><a id="editBTN" href="edit.php?id=<?php echo $id; ?>" alt="Edit Project" title="Edit Project" ></a></div>
                    <div id="trash"><a id="trashBTN" href="delete.php?id=<?php echo $id; ?>" alt="Trash Project" title="Trash Project" ></a></div>

                    </div>
                    </td>
                </tr><?php
                                                        }

                                                        ?>
            </tbody>

            <tfoot>
                <tr>
                    <th width="10%">Client</th>

                    <th width="10%">Project</th>

                    <th width="5%">Designer</th>

                    <th width="10%">Start Date</th>

                    <th width="10%">End Date</th>

                    <th width="10%">Times</th>

                    <th width="10%"></th>
                </tr>
            </tfoot>
        </table>
        <?php echo $information['sum_ammount']; ?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T15:08:16.627

[http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_date-format](http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_date-format)

```
SELECT SUM(amount) * 100 AS sum_ammount, DATE_FORMAT(end_date, '%Y, %b') AS date FROM projects WHERE end_date LIKE '$ds%' AND status!='Invoiced' AND status!='Done' ORDER BY end_date DESC 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T15:10:10.310

假设我理解您的意思，您应该能够在 SQL 查询中执行以下操作

`select MONTHNAME(end_date), sum(amount)*100 as sum_ammount from projects where ...`

那应该返回月份的名称。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T15:07:11.170

您可以为此使用该功能`date()`。

```
date('F', [$timestamp]); 
```

将显示月份。如果 $timestamp 将被省略，则使用当前时间戳。在您的示例中，您必须准备一个时间戳。你可以用`strtotime()`这个。

# objective-c - NSDate 日期不给我正确的时间

> ID：14082912
> 
> 赞同：-2
> 
> 时间：2012-12-29T15:04:28.847
> 
> 标签：objective-c, ios, nsdate

我正在尝试获取当前日期：

```
NSLog(@"DATE NOW : %@", [NSDate date]); 
```

但是当我执行它时，显示的日期和当前日期之间有一个小时的差异。

[登录 http://data.imagup.com/12/1171458807.5637png](http://data.imagup.com/12/1171458807.5637png)

我找到了有关此类问题的主题，但没有一个给我答案。我该如何改变呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T15:05:42.697

您需要设置正确的时区。如您所见，默认值为 UTC。

您可以使用日期格式化程序来执行此操作。

```
NSDateFormatter * dateFormatter = [[NSDateFormatter alloc] init];
NSTimeZone * timezone = [NSTimeZone timeZoneWithName:@"Europe/Rome"];
[dateFormatter setTimeZone:timezone];
[dateFormatter setTimeStyle:NSDateFormatterFullStyle
 ];
[dateFormatter setDateStyle:NSDateFormatterFullStyle];    

NSLog(@"%@", [dateFormatter stringFromDate:[NSDate date]]); 
```

有关可用时区的列表，您可以使用

```
NSArray *timeZoneNames = [NSTimeZone knownTimeZoneNames]; 
```

或在此 Rails[文档页面](http://api.rubyonrails.org/classes/ActiveSupport/TimeZone.html)上查看常量。

# excel - 将一个工作簿复制到另一个工作簿时不复制特定单元格

> ID：14082914
> 
> 赞同：1
> 
> 时间：2012-12-29T15:04:50.123
> 
> 标签：excel, excel-2010, vba

我正在使用的代码将工作表作为数组并将它们复制为 XlValues，但是很少有单元格包含我想保留并粘贴为 xlFormats 的公式。我怎样才能做到这一点？

```
Sub CopyPasteSave()
Dim NewName As String
Dim nm As Name
Dim ws As Worksheet
Dim Path As String, rcell As Range
Set rcell = Sheets("EPF Daily Report").Range("I5")
Path = "D:\"

If MsgBox("Copy specific sheets to a new workbook" & vbCr & _
"New sheets will be pasted as values, named ranges removed" _
, vbYesNo, "NewCopy") = vbNo Then Exit Sub

With Application
.ScreenUpdating = False

' Copy specific sheets
' *SET THE SHEET NAMES TO COPY BELOW*
' Array("Sheet1", "Sheet2"))
' Sheet names go inside quotes, seperated by commas
On Error GoTo ErrCatcher
Sheets(Array("InletManifold", "Separator", "Crude Strippers & Reboilers ", "Water Strippers  & Reboilers ", "Crude Storage&Export", "GSU,FLARE & GEN", "EPF Utility", "EPF Daily Report", "Choke Size")).Copy
On Error GoTo 0

' Paste sheets as values
' Remove External Links, Hperlinks and hard-code formulas
' Make sure A1 is selected on all sheets
For Each ws In ActiveWorkbook.Worksheets
ws.Cells.Copy
ws.[A1].PasteSpecial Paste:=xlValues
Application.DisplayAlerts = False

ws.Cells.Hyperlinks.Delete
Application.CutCopyMode = False
Cells(1, 1).Select
ws.Activate
Next ws
Cells(1, 1).Select

' Remove named ranges
For Each nm In ActiveWorkbook.Names
nm.Delete
Next nm

' Input box to name new file
'NewName = InputBox("Please Specify the name of your new workbook", "New Copy")

' Save it with the NewName and in the same directory as original
ActiveWorkbook.SaveAs Filename:=Path & " " & "EPF Daily Report" & " " & rcell.Value & ".xls"
ActiveWorkbook.Close SaveChanges:=True

.ScreenUpdating = False

End With
Exit Sub

ErrCatcher:
MsgBox "specified sheets do not exist within this work book"
End Sub 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T16:54:07.390

在将工作表复制为值之后，我在下面所做的是复制您从原始工作簿中指定的单元格，`PasteSpecial`以保持其公式不变。几点注意事项：

*   添加了一个数组 ，`CellsToCopy`其中包含您要使用公式复制的地址，例如 B11 和 B12。Mdoify 这个根据需要。
*   添加`wbSource`和`wbTarget`工作簿变量，在`PasteSpecial`
*   清理您的代码，`DisplayAlerts`重新打开并添加到错误处理中
*   摆脱了您的`Select`陈述并替换为 `Application.GoTo`

另外，请注意，您不必做任何特殊的事情来保留格式，因为作为值的副本不会更改它们。

```
Sub CopyPasteSave()
Dim wbSource As Excel.Workbook
Dim wbTarget As Excel.Workbook
Dim nm As Name
Dim ws As Worksheet
Dim CellsToCopy() As String
Dim i As Long
Dim Path As String
Dim rcell As Range

If MsgBox("Copy specific sheets to a new workbook" & vbCr & _
          "New sheets will be pasted as values, named ranges removed" _
 , vbYesNo, "NewCopy") = vbNo Then
    Exit Sub
End If
Set wbSource = ActiveWorkbook
Set rcell = Sheets("EPF Daily Report").Range("I5")
Path = "D:\"
'Enter cells to copy with formulas
CellsToCopy = Split(("B11,B12"), ",")
Application.ScreenUpdating = False
' Copy specific sheets
' *SET THE SHEET NAMES TO COPY BELOW*
' Sheet names go inside quotes, separated by commas
On Error GoTo ErrCatcher
wbSource.Sheets(Array("InletManifold", "Separator", "Crude Strippers & Reboilers ", "Water Strippers  & Reboilers ", "Crude Storage&Export", "GSU,FLARE & GEN", "EPF Utility", "EPF Daily Report", "Choke Size")).Copy
On Error GoTo 0
' Paste sheets as values
' Remove External Links, Hyperlinks and hard-code formulas
' Make sure A1 is selected on all sheets
Set wbTarget = ActiveWorkbook
For Each ws In wbTarget.Worksheets
    With ws
        .Cells.Copy
        .[A1].PasteSpecial Paste:=xlValues
        For i = LBound(CellsToCopy) To UBound(CellsToCopy)
            wbSource.Worksheets(ws.Name).Range(CellsToCopy(i)).Copy
            ws.Range(CellsToCopy(i)).PasteSpecial xlPasteFormulas
        Next i
        Application.CutCopyMode = False
        Application.DisplayAlerts = False
        .Cells.Hyperlinks.Delete
        Application.DisplayAlerts = True
        Application.Goto .Range("A1")
    End With
Next ws
With wbTarget
   ' Remove named ranges
    For Each nm In .Names
        nm.Delete
    Next nm
    ' Input box to name new file
    'NewName = InputBox("Please Specify the name of your new workbook", "New Copy")
    ' Save it with the NewName and in the same directory as original
    .SaveAs Filename:=Path & " " & "EPF Daily Report" & " " & rcell.Value & ".xls"
    .Close SaveChanges:=True
End With

Exit_Point:
Application.ScreenUpdating = False
Application.DisplayAlerts = True
Exit Sub

ErrCatcher:
MsgBox "specified sheets do not exist within this work book"
Resume Exit_Point
End Sub 
```

# vb.net - VB.NET AlphaNumeric 转换成整数

> ID：14082917
> 
> 赞同：1
> 
> 时间：2012-12-29T15:05:03.127
> 
> 标签：vb.net

如果`Textbox1.text`包含一个字符串值`ZU4`，我如何将该字符串转换为它的数字 ASCII 代码，并将其输出到第二个文本框？

我想使用`FOR LOOP`条件语句来执行此操作，该语句将读取 INPUT 中的每个字符？

样本：

```
INPUT  Textbox1.Text = ZU4
OUTPUT Textbox2.Text = 908552 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T15:30:08.800

你也可以使用 LINQ：

```
TextBox2.Text = String.Join(String.Empty, From c In Textbox1.Text.ToCharArray Select (Asc(c).ToString)) 
```

可能对一些工作面试有用...... :)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T15:07:50.077

这是 C# 中的一种方法：

```
Textbox2.Text = string.Empty;
foreach(var c in Textbox1.Text)
{
  Textbox2.Text += ((int)c).ToString();
} 
```

VB.NET：

```
Textbox2.Text = String.Empty
For Each c As Char In Textbox1.Text
  Textbox2.Text = Textbox2.Text + Convert.ToInt32(c).ToString()
Next 
```

它：

*   清除`Textbox2.Text`
*   循环输入中的每个字符
*   将整数值输出作为字符串连接到输出文本

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T15:11:20.213

```
TextBox2.Text = ""
For i As Integer = 0 To TextBox1.TextLength - 1
    TextBox2.Text += Asc(TextBox1.Text(i)).ToString()
Next 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-29T15:11:36.750

我修改了这个[链接的代码](http://www.devx.com/vb2themax/Tip/19462)

```
Function AsciiEncode(ByVal value As String) As String
            Dim encValue As New System.Text.StringBuilder(value.Length * 6)
            Dim c As Char
            For Each c In value
                encValue.Append(Convert.ToInt32(c))
            Next
            Return encValue.ToString()
End Function 
```

**用法：**

```
 Private Sub TextBox1_TextChanged(sender As System.Object, e As System.EventArgs) Handles TextBox1.TextChanged
        TextBox2.Text = AsciiEncode(TextBox1.Text)
    End Sub 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-29T19:11:23.847

所有其他答案都适用于您给定的示例，但是，一些建议使用 unicode 编码而不是 ASCII。如果严格遵守 ASCII 编码很重要，那么您应该明确指定要使用的编码。

`Convert.ToInt32`使用 UTF-16 编码。我不确定`CInt`会做什么，但我怀疑它的工作方式相同。使用`Asc`更好，但它仍然依赖于线程的代码页设置，所以它仍然不是完全安全的。除此之外，`Asc`是 VB.NET 中提供的一个旧的 VB6 函数，主要是为了向后兼容。

因此，我建议改用`ASCIIEncoding`该类。您可以使用命名空间中类的共享`ASCII`属性获取`Encoding`该类的`System.Text`实例，例如：

```
Public Function ConvertTextToAsciiDigits(text As String) As String
    Dim builder As New StringBuilder()
    For Each b As Byte In Encoding.ASCII.GetBytes(text)
        builder.Append(b.ToString())
    Next
    Return builder.ToString()
End Function 
```

然后，您可以像这样调用该函数：

```
Textbox2.Text = ConvertTextToAsciiDigits(Textbox1.Text) 
```

但是，我无法想象生成的字符串将可用，除非每个字符都产生一个两位数。因此，我会通过执行以下操作将其强制为两位数：

```
Public Function ConvertTextToAsciiDigits(text As String) As String
    Dim builder As New StringBuilder()
    For Each b As Byte In Encoding.ASCII.GetBytes(text)
        If b > 99 then
            Throw New FormatException()  ' Throws an exception if the value is three digits
        End If
        builder.Append(b.ToString("00"))  ' Adds a leading zero to one-digit values
    Next
    Return builder.ToString()
End Function 
```

要在每第四个数字后添加一个连字符，正如您在下面的评论中提到的，您可以跟踪自最后一个连字符以来添加的总数字，如下所示：

```
Public Function ConvertTextToAsciiDigits(text As String) As String
    Dim builder As New StringBuilder()
    Dim digitsSinceHyphen As Integer = 0
    For Each b As Byte In Encoding.ASCII.GetBytes(text)
        If b > 99 then
            Throw New FormatException()
        End If
        builder.Append(b.ToString("00"))
        digitsSinceHyphen += 2
        If digitsSinceHyphen >= 4 Then
            builder.Append("-")
            digitsSinceHyphen = 0
        End If
    Next
    Return builder.ToString()
End Function 
```

# java - Java和C++之间的进程间通信

> ID：14082921
> 
> 赞同：0
> 
> 时间：2012-12-29T15:05:32.220
> 
> 标签：java, c++, ipc

> **可能重复：**
> [Java 和 C/C++ 之间进程间通信的最快（低延迟）方法](https://stackoverflow.com/questions/2635272/fastest-low-latency-method-for-inter-process-communication-between-java-and-c)

我想问是否有人可以建议我在同一台机器上的两个进程之间传输大量数据的最快方法，一个用 Java 构建，另一个用 C++ 构建

我必须在互联网上构建一个具有客户端-服务器架构的业务应用程序，其结构如下->

Java 客户端应用程序---（Java 套接字）-----> Java Servlet----> C++ 业务逻辑。

它需要高度可移植，因为我们不能事先说客户端的目标环境，所以我认为 java 将是它的最佳选择。它将通过 java 套接字与 java serverlet 交互。serverlet 应该与 C++ 中构建的业务逻辑进行交互。

我将仅将 java 用于通信部分，所有其余的业务逻辑都将在 C++ 中。

我是一名业余 Java 程序员，并且在 C++ 方面拥有丰富的经验。

任何形式的建议都会受到欢迎..

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-29T15:12:14.650

我会在环回上使用 Socket，假设数据量不需要超过从客户端应用程序获得或返回到它的数据量，并且延迟不需要小很多倍。

使用 Socket 是最便携的，如果你必须在不同的机器上运行它们，你可以。

使用 Java，您可以通过 Socket 获得几 Gb/秒的延迟，延迟低于 10 微秒。

# php - 表单元素名称中的 zend 方括号

> ID：14082922
> 
> 赞同：0
> 
> 时间：2012-12-29T15:05:40.543
> 
> 标签：php, mysql, zend-framework, zend-form

Zend Framework 有一个问题。我在表单中包含了 MultiCheckbox 元素，它在 HTML 中的名称中添加了方括号（例如，我需要带有名称标签的元素，但 ZF 将其设为标签 []）。

当我在我的家庭开发服务器中使用此表单时，一切正常。但是后来我将代码上传到生产服务器它只是出错了。放入数据库时​​，我必须创建名为 tags[] 的列，并且因为 php 对数组使用方括号，所以一切都崩溃了，我无法在我的视图中使用它。

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T17:12:52.150

`$_GET`方括号是为与和方法一起使用的数据定义数组的常用`$_POST`方法。

在您的 PHP 脚本中，您需要对数组进行反序列化并解析或对数组执行您想要的操作。

```
<?php 
    //Example for $_REQUEST["item"] = "item[]=1&item[]=2"

    $arr = unserialize($_REQUEST["item"]); 
    foreach($arr as $index => $position)
    {
        //Do what you want
    }
?> 
```

# php - 使用 bcrypt 进行用户身份验证

> ID：14082924
> 
> 赞同：1
> 
> 时间：2012-12-29T15:05:44.667
> 
> 标签：php, authentication, pdo, bcrypt

我是基于我的 bcrypt 创建[**这个站点**](http://www.gregboggs.com/php-blowfish-random-salted-passwords/) 我已经对其进行了一些更改所以这是我的代码版本：[**我的 bcrypt 版本**](http://pastebin.com/wLxDEhD7)

我已经开始处理我的登录表单，并且我普遍认为要检查用户凭据，您必须：

1.  重新创建 bcrypt

2.  将提交的 $_POST['password'] 与您存储在数据库中的密码进行比较。

3.  返回行数，因此如果返回您重新创建的密码与已存储密码匹配的行，则行数必须 == 1

**我感到困惑的是：**

1.  如何让 checklogin 表单知道 bcrypt 函数的开头是什么？我必须包括注册脚本吗？- 还是我必须复制并粘贴 bcrypt 函数？

我试图在我的用户身份验证中实现这一点，但由于某种原因它对我不起作用。

这是我的[**代码**](http://pastebin.com/hipNQePd)，希望有人看到我没有看到的问题。

任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T15:26:13.517

您的代码尝试执行的操作类似于`md5()`查找旧的未加盐哈希的方式；php 计算哈希，然后根据该哈希值和用户名完成数据库查找。

因为您的代码每次需要验证给定密码时都使用不同的盐，所以在数据库中的查找实际上永远不会起作用。

使用 bcrypt，它的工作方式如下：

1.  根据用户名获取数据库记录。

2.  使用其中存储的密码哈希与发布的密码进行比较：

    ```
    if (crypt($form_password, $db_hash) === $db_hash) { ... } 
    ```

**尖端**

为 bcrypt 生成盐会容易得多（您不需要 10k 个字符）：

```
rtrim(strtr(base64_encode(openssl_random_pseudo_bytes(16)), '+', '.'), '='); 
```

此外，17 的成本参数非常大……除非您运行的是严肃的硬件，否则当有人试图暴力破解密码时，您将关闭该站点。

# asp.net-mvc-3 - 如何在 Orchard CMS 中存储逗号分隔的列表？

> ID：14082926
> 
> 赞同：0
> 
> 时间：2012-12-29T15:05:52.577
> 
> 标签：asp.net-mvc-3, orchardcms

使用 Orchard CMS，我正在处理记录和部分代理，但无法弄清楚如何将其保存到数据库中。事实上，我承认我什至不知道如何将我试图保存的项目放入这个范例中。我最初使用`enum`'s 进行选择：

`MyEmum.cs`：

```
public enum Choices { Choice1, Choice2, Choice3, Choice4 } 
```

`MyRecord.cs`：

```
public virtual string MyProperty { get; set; } 
```

`MyPart.cs`：

```
public IEnumerable<string> MyProperty
{
    get
    {
        if (String.IsNullOrWhiteSpace(Record.MyProperty)) return new string[] { };
        return Record
            .MyProperty
            .Split(new[] { '.' }, StringSplitOptions.RemoveEmptyEntries)
            .Select(r => r.Trim())
            .Where(r => !String.IsNullOrEmpty(r));
    }
    set { Record.MyProperty = value == null ? null : String.Join(",", value); }
} 
```

现在，在我的服务类中，我尝试了类似的方法：

```
public MyPart Create(MyPartRecord record)
{
    MyPart part = Services.ContentManager.Create<MyPart>("My");
    ...
    part.MyProperty = record.MyProperty; //getting error here
    ...
    return part;
} 
```

但是，我收到以下错误：`Cannot implicitly convert 'string' to System.Collections.Generic.IEnumerable<string>'`

本质上，我试图将复选框列表（一个或多个选择）中的选择保存为数据库中的逗号分隔列表。

这甚至没有让我解决如何使用`enum`. 有什么想法吗？

对于一些背景：

我知道处理这种关系的适当方法是创建一个单独的表并使用`IList<MyEnum>`. 然而，这是一个简单的列表，我不打算通过编辑来操作（事实上，在这个场景中没有使用驱动程序，因为我在前端使用控制器和路由处理这个）。我只是为了统计/历史目的捕获数据并在管理视图中重新显示它。我什至可以考虑去掉 Part（考虑以下帖子：[Bertrand 的博客文章](http://weblogs.asp.net/bleroy/archive/2011/02/21/storing-non-content-data-in-orchard.aspx)。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T22:30:46.437

它应该是：

```
part.MyProperty = new[] {"foo", "bar"}; 
```

例如。该部分的设置器会将记录属性上的值存储为逗号分隔的字符串，该字符串将持久保存到数据库中。

如果要使用枚举值，则应使用 .NET 在 Enum 上提供的`Parse`和`ToString`API。

# javascript - 从参数生成 XHTML 的 JavaScript 库/框架？

> ID：14082930
> 
> 赞同：1
> 
> 时间：2012-12-29T15:06:25.417
> 
> 标签：javascript, html, eclipse, xhtml, html-generation

我有一个相当复杂的问题:)

我想以 json 的形式从服务器向客户端发送数据。

javascript 将使用该数据从该数据生成 XHTML。

现在我正在寻找一个库/框架来帮助我从 JSON 生成这个 XHTML。

例如，一种解决方案可能是使用包含变量的特殊 XHTML“模板”文件，这些变量按名称映射到 javascript 方法，并且该方法采用 JSON 数组并用 JSON 数组中的变量填充 XHTML 的某些部分。

示例模板文件（伪代码）：

文件名：TemplateA.something

```
<html>
Hello my name is %VARIABLE1% !
</html> 
```

然后框架为我生成了一个类似的方法（伪代码）：

```
generateXHTMLfromTemplate(templatename, data); 
```

它会返回 XHTML。

例如，我会这样称呼它（伪代码）：

```
container.html(generateXHTMLfromTemplate('TemplateA', '{"VARIABLE1" : "Earl"}')); 
```

像这样的东西会很棒，最好的办法是在 eclipse 中完成这些“模板”文件的代码；）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T15:31:44.487

尽管我可能会被遗忘，但我会提出一个非常简单的替代方案。

如果您需要一个非常简单的功能，那么您可以使用一个非常简单的插件 as `$.fn.loadtemplate`，它是我之前的一个修改[`$.fn.simpletemplate`](https://github.com/aeurielesn/jQuery.fn/tree/master/%24.fn.simpletemplate)。

```
$.fn.loadtemplate = function(resource, variables) {
    return this.each(function() {
        var $self = $(this);
        $.ajax({
            url: resource,
            dataType: "html",
            success: function(html) {
                html = html.replace(/{{(.+)}}/g, function(match, variable) {
                    return variables[variable];
                });
                $self.html(html);
            }
        });
    });
}; 
```

所有`{{variable}}`标记都将被传递给函数的给定对象的适当属性替换。

```
<!-- template.tpl -->
<h1>Hello my name is {{name}}!</h1> 
```

```
$("#selector").loadtemplate("template.tpl", {
  name: "World"
});​ 
```

[**一个例子小提琴here。**](http://jsfiddle.net/XNpbT/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T15:08:14.350

摘自帖子的评论：

> 像这样的东西？[github.com/janl/mustache.js](http://github.com/janl/mustache.js) – 昨天的搅拌机

> 其他可供选择：[doT](http://olado.github.com/doT/)，[Handlebars](http://handlebarsjs.com/)，[Underscore](http://underscorejs.org/#template)。– 昨天尖尖的

# javascript - Firefox 中索引数据库的无效状态错误

> ID：14082932
> 
> 赞同：8
> 
> 时间：2012-12-29T15:06:29.690
> 
> 标签：javascript, html, indexeddb

在 Firefox 上打开 indexedDB 数据库时出现错误。此代码在 Chrome 中运行良好，但在 Firefox 中失败。

```
<script type="text/javascript">
  var indexedDB = window.indexedDB || window.webkitIndexedDB || window.mozIndexedDB || window.msIndexedDB;
  var request = indexedDB.open("TestDB", 1);  
</script> 
```

Javascript 错误发生在该行上`indexedDB.open("TestDB", 1)`。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-25T00:57:34.563

就我而言，此错误是由于 Firefox 中的隐私设置造成的。在首选项面板中将历史设置设置为“Firefox 将：记住历史”可以启用 IndexedDB。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-03-25T08:06:35.923

indexedDB 对象是窗口实例的方法，所以它必须是

```
<script type="text/javascript">
  window.indexedDB = window.indexedDB || window.webkitIndexedDB || window.mozIndexedDB ||  window.msIndexedDB;
var request = indexedDB.open("TestDB", 1);  
</script> 
```

在您的代码中，indexedDB 成为本地函数。显然，它不起作用。

# apache - Apache 虚拟子域

> ID：14082938
> 
> 赞同：0
> 
> 时间：2012-12-29T15:07:33.247
> 
> 标签：apache, xampp, subdomain

我正在尝试创建虚拟子域，但在我编辑 httpd-vhosts.conf 后 apache 无法启动，并且错误日志中没有错误。

```
<VirtualHost 127.0.0.1:80>
  ServerAlias *.localhost
  UseCanonicalName Off    
  VirtualDocumentRoot C:/xampp/htdocs/%1
</VirtualHost> 
```

注意：我在 Windows 上通过 xampp 运行 apache。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T01:20:58.000

前段时间为同样的问题苦苦挣扎。您必须启用 vhost_alias 模块。

在**apache/conf/httpd.conf 中**找到这一行并取消注释

```
#LoadModule vhost_alias_module modules/mod_vhost_alias.so 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T05:45:45.710

我知道我正在写的不是解决方案。但尝试使用[Ampps](http://www.ampps.com)。它提供了一个创建子域的界面，这对于不太了解 Apache 配置的用户很有用。

# matlab - 如何在matlab中从起点绘制向量并遵循特定方向的度数？

> ID：14082940
> 
> 赞同：0
> 
> 时间：2012-12-29T15:07:46.607
> 
> 标签：matlab

我想从北 55 度和东 20 度的特定点开始绘制一些向量，并根据随机角度（用 randn 生成）遵循一个方向。我想过用循环来做，但没有成功：

```
for i=1:100
    a=50+ 20.*randn;
    b = [a];
    i = i + 1;
    route = [20,50] + b * 
    plot(route, 'color', 'magenta')
    hold on
end 
```

»»» route = [20,50] + b * 我是这样尝试的，因为对我来说它看起来像是 y = a+ bx 类型的愚蠢线性方程......我只是不知道 x 用什么...同样这样它只会绘制 1 条路线，我需要 100 条......

（所以我需要在一张图上从同一个点开始的一百个向量，其中唯一变化的参数是方向）

希望可以有人帮帮我。有任何想法吗？

ps：我刚开始matlab。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T16:16:33.770

1 - 为一行有方向的尝试以下代码：

```
%Initial line information
startPoint = [20 50] ;
direction  = [4 3] ;
lineLength = 100;

%Initialize line points with zeros
x  = zeros(lineLength);
y  = zeros(lineLength);

% Update line points
for i = 1 : lineLength
    x(i) = startPoint(1) + direction(1) * i;
    y(i) = startPoint(2) + direction(2) * i;
end

%Plot the line
plot( y , x ,'r.'); 
```

2 - 如果您希望每个点的方向都发生变化，

使用以下代码：

```
%Initial line values
startPoint = [20 50] ;
lineLength = 100;

%create random direction vector
randomMax  = 100;
direction  = randi(randomMax,lineLength,2);

%Initialize line points with zeros
x  = zeros(lineLength);
y  = zeros(lineLength);

%set first points
x(1) = startPoint(1);
y(1) = startPoint(2);

% Update line points accumulating on previous point
for i = 2 : lineLength
    x(i) = x(i - 1) + direction(i,1) * i;
    y(i) = y(i - 1) + direction(i,2) * i;
end

%Plot the line
plot( y , x ,'r.'); 
```

3 - 对于每条具有不同方向的线，请使用以下代码：

```
%Initial line values
startPoint = [20 50] ;
lineLength = 100;

%create random the 100 directions vector
randomMax  = 100;
directions = randi(randomMax,lineLength,2);

%Initialize line points with zeros
x  = zeros(lineLength,100);
y  = zeros(lineLength,100);

%set first points
x(1) = startPoint(1);
y(1) = startPoint(2);

h3 = figure;

% Update line points accumulating on previous point
for k = 1 : 100
    for i = 2 : lineLength

        x(i,k) = x(i - 1,k) + directions(k,1) * i;
        y(i,k) = y(i - 1,k) + directions(k,2) * i;

    end
    %hold the figure and plot the k-th line
    hold on;    
    plot( y(: , k) , x(: , k) , 'r.');
end 
```

# c# - 将结果复制到剪贴板

> ID：14082942
> 
> 赞同：0
> 
> 时间：2012-12-29T15:07:50.763
> 
> 标签：c#

大家好，我编写了一个控制台应用程序：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Net;
using System.IO;
using System.Text.RegularExpressions;

namespace ConsoleApplication1
{
    class Program
    {
        public static void Main(String[] args)
        {
            if (args.Length == 0)
            {
                Console.WriteLine("No file to upload...");
                Environment.Exit(0);
            }
            else
                Console.WriteLine("[~] Trying to upload: " + args[0]);
            string name = Regex.Match(args[0], @"[^\\]*$").Value;
            ftp ftpClient = new ftp(@"ftp://site.ru/", "dfgd", "QWERTY_123");
            ftpClient.upload("www/site.ru/upload/" + name, args[0]);
            Console.WriteLine("[+] Upload File Complete");
            Console.ReadKey();
        }
    }
} 
```

`Console.WriteLine("[+] Upload File Complete");`复制`args[0]`到剪贴板后如何？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-12-29T15:10:10.467

首先，您必须在应用程序中添加对**System.Windows.Forms的引用。**

转到 Project -> Add reference，从刚刚打开的窗口中的 .NET 选项卡中选择 System.Windows.Forms。

您必须通过将 STAThread 属性应用于 Main() 函数来避免 ThreadStateException。然后您可以毫无问题地使用剪贴板功能。

```
using System;
using System.Windows.Forms;

class Program 
{
    [STAThread]
    static void Main(string[] args) 
    {
         Clipboard.SetText("this is in clipboard now");
    }
} 
```

如果您不想使用对**System.Windows.Forms**的引用，您可以通过**P/Invoke来完成**

平台调用剪贴板 API 是一种可能的解决方案。例子：

```
using System.Runtime.InteropServices;
class Program
{
    [DllImport("user32.dll")]
    internal static extern bool OpenClipboard(IntPtr hWndNewOwner);

    [DllImport("user32.dll")]
    internal static extern bool CloseClipboard();

    [DllImport("user32.dll")]
    internal static extern bool SetClipboardData(uint uFormat, IntPtr data);

    [STAThread]
    static void Main(string[] args)
    {
        OpenClipboard(IntPtr.Zero);
        var yourString = "Hello World!";
        var ptr = Marshal.StringToHGlobalUni(yourString);
        SetClipboardData(13, ptr);
        CloseClipboard();
        Marshal.FreeHGlobal(ptr);
    }
} 
```

这只是一个例子。在代码周围添加一些错误处理，例如检查 P/Invoke 函数的返回值将是一个很好的补充。

[`SetClipboardData`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms649051%28v=vs.85%29.aspx)有趣的是，您还需要确保打开和关闭剪贴板。

作为第`13`一个参数传入的是数据格式。13[表示 unicode 字符串](http://msdn.microsoft.com/en-us/library/windows/desktop/ff729168%28v=vs.85%29.aspx)。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-07-11T13:22:10.360

Marshal.StringToHGlobalUni 函数实际上以不适合 SetClipboardData 的方式分配内存（使用带有 LMEM_FIXED 的 LocalAlloc），这可能会导致崩溃。（你不会期望它给出方法名称，但进入代码，例如使用 ReSharper 会揭示这一点。）根据文档，SetClipboardData 需要 GlobalAlloc 和 GMEM_MOVABLE：[MSDN 上](http://msdn.microsoft.com/en-us/library/windows/desktop/ms649051(v=vs.85).aspx)的 SetClipboardData 。

这是 MIT 许可的 System.Windows.Forms 替代方案，经过测试并完成错误处理：[Clippy](https://github.com/kolibridev/clippy)

（剪贴板推送代码本身可以在这里找到：[Clippy.cs](https://github.com/kolibridev/clippy/blob/master/Clippy/Clippy.cs)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T15:09:38.343

您需要使用[**ClipBoard.SetText**](http://msdn.microsoft.com/en-us/library/tbfb3z56.aspx)方法

```
 Clipboard.SetText(args[0], TextDataFormat.Text); 
```

# mysql - 是否可以根据字符串中具有特定字符的列删除 MySQL 中的一行？

> ID：14082946
> 
> 赞同：1
> 
> 时间：2012-12-29T15:08:18.067
> 
> 标签：mysql

我有一个 MySQL 表，为此目的说数据库名称是“A_blah”，它有几列，但我有兴趣根据包含具有特定字符的字符串的特定列删除行。例如，有一列包含：

```
A
A{
B
B{
AA
AA{ 
```

我要做的是删除此列中字符串中包含“{”的每一行，留下：

```
A
B
AA 
```

这是否可以通过查询进行，如果可以，您可以展示和解释吗？非常感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T15:12:23.327

假设这是您处理简单的唯一角色：

```
DELETE FROM A_Blah WHERE col LIKE '%{%'; 
```

应该够了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T15:22:42.857

您还可以使用 MySQL 正则表达式

```
DELETE FROM A_blah WHERE column_name REGEXP '[A-Z]*[{][A-Z]*' 
```

# asp.net - Windows Server 2012 中的 .svc 文件以“405 Method not Allowed”响应

> ID：14082950
> 
> 赞同：3
> 
> 时间：2012-12-29T15:08:32.107
> 
> 标签：asp.net, iis, iis-8, windows-server-2012

当我使用 .svc-ASP.Net 4 服务将我的网站从 Windows Server 2008 复制到 Windows Server 2012 时，Silverlight 应用程序触发的每个 .svc-Request 都会收到 405 响应。

在 Windows Server 2008 中，一切都运行良好。

我尝试了 aspnet_regiis 和 WCF Register (ServiceModelReg)。.svc 文件也包含在 IIS 8 的模块映射中。我还卸载了 ASP.NET 4.5+3.5 并重新安装了它和 WCF HTTP 托管。

所有网站都受到此迁移的影响。

要求：

```
POST /Data/search.svc HTTP/1.1
Accept  */* 
```

回复：

```
HTTP/1.1 405 Method Not Allowed
Allow:  GET, HEAD, OPTIONS, TRACE 
```

文件如下所示，我还尝试添加“WebInvoke”。

```
[ServiceContract]
public interface IPackages
{
    /// <summary>
    /// Gets a package by a public key
    /// </summary>
    /// <param name="publicKey">Used public key</param>
    /// <returns>Information about the package</returns>
    [OperationContract]
    PackageInformation GetPackageByPublicKey(string publicKey);

// NOTE: You can use the "Rename" command on the "Refactor" menu to change the class name "Packages" in code, svc and config file together.
public class Packages : IPackages
{
    /// <summary>
    /// Gets a package by a public key
    /// </summary>
    /// <param name="publicKey">Used public key</param>
    /// <returns>Information about the package</returns>
    public PackageInformation GetPackageByPublicKey(string publicKey)
    {
            return packageManager.GetPackageByPublicKey(publicKey);
    }
} 
```

感谢您的任何提示。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-12-10T16:49:44.413

在 Windows 2012 上，您需要转到服务器管理器，然后添加角色和功能。单击下一步几次，直到进入“服务器角色”选项。从那里展开应用程序服务器并选择“Web 服务器 (IIS) 支持”。接下来您需要选择 Http Activation 和 TCP Activation（我都做了），这就是在 2012 年启用 WCF 支持的原因。

它应该为您选择所有必要的依赖项，但您可能还需要转到“Web 服务器（IIS）”部分，然后是“应用程序开发”并选择您需要的 ASP.NET 选项（我已经安装了这些选项首先，所以我不知道是否有必要这样做，如果只做支持选项）。这将为您创建 .svc 处理程序。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-29T15:58:30.037

我必须使用以下类型为 *.svc 创建一个新的托管处理程序：

```
 System.ServiceModel.Activation.ServiceHttpHandlerFactory, System.ServiceModel.Activation, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35 
```

很奇怪，默认情况下没有这样做。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-12-12T14:24:07.777

澄清和扩展已接受的答案，以期在未来有所帮助（它对我帮助很大，我讨厌在旧版应用程序中使用 SilverLight）......

1.  在 Windows 2012 上，您转到服务器管理器，然后单击添加角色和功能。

2.  单击下一步几次，直到进入“服务器角色”选项。

3.  从那里，检查应用程序服务器并单击下一步两次。

4.  选择“Web Server (IIS) Support”，将出现一个列出功能的弹出窗口，单击“添加功能”按钮，然后单击“下一步”按钮，然后单击“安装”按钮。

5.  “接下来你需要选择 Http Activation 和 TCP Activation（我都做了），这就是 2012 年支持 WCF 的原因。”

6.  为此，请返回服务器管理器并单击添加角色和功能。

7.  单击下一步几次，直到进入“服务器角色”选项，然后在左侧面板中单击“功能”条目。

8.  然后展开.Net 4.5，再展开WCF Services，然后选择HTTP Activation（此时其他类型可用，根据需要添加），继续安装。

这些步骤为我解决了 405 问题。

我只需要 HTTP 激活。

# api - 在 soundcloud API 上使用 license 参数时如何获得更多结果？

> ID：14082953
> 
> 赞同：1
> 
> 时间：2012-12-29T15:08:44.850
> 
> 标签：api, licensing, limit, soundcloud

有谁知道使用 license 参数时获取更多曲目的方法。当它到位时，它似乎被限制为 250。但是，当我不使用 license 参数时，我最多可以返回 8000。

有许可证（250 返还）

[https://api.soundcloud.com/tracks.json?client_id=76c1334ef21c70d72dc89661e638258f&limit=1&offset=249&license=cc-by-sa](https://api.soundcloud.com/tracks.json?client_id=76c1334ef21c70d72dc89661e638258f&limit=1&offset=249&license=cc-by-sa)

没有许可证：（最多 8000 个） [https://api.soundcloud.com/tracks.json?client_id=76c1334ef21c70d72dc89661e638258f&limit=1&offset=7500&q=sound](https://api.soundcloud.com/tracks.json?client_id=76c1334ef21c70d72dc89661e638258f&limit=1&offset=7500&q=sound)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T14:40:47.813

谢谢你的问题。

我们目前正在为此努力，预计许可证分类抵消的到达时间是本月底。

# c - 如何向其他线程发送带有更多信息的信号？

> ID：14082955
> 
> 赞同：5
> 
> 时间：2012-12-29T15:08:49.797
> 
> 标签：c, multithreading, pthreads, signals, multiprocessing

我正在用 C 语言用 pthread 编程。我希望一个线程告诉其他线程它已将消息放入消息队列中，以便其他线程知道他们可以从消息队列中获取消息。但是，发送信号的线程应该向其他线程提供更多信息，例如线程 id、消息标签等。怎么做 ？

我知道 pthread_kill 函数，但似乎需要的信息很少。当我使用线程向其他线程发送信号时，我可以获取更多信息吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-29T15:20:01.883

C 意义上的信号不能获取“更多信息” - 如果您想发送更多信息，那么您需要将其作为消息的一部分包含在 message_queue 中，而不是作为信号的一部分。

我很确定有几十种选择。只是你没有想到他们。就像我说的，如果你想使用信号，那么使用信号来指示有消息（如电话响铃），然后使用消息队列来传达实际信息（正在通话）。我们不使用电话铃声信号通过电话传达信息，对吧？

但我担心你在某种程度上误解了线程和信号的使用。我很确定您应该解决您正在做的任何事情的方式不是正确的方式。

由于您的问题是“我如何在信号中发送多个整数，我认为您应该接受 Arno 的回答，如果没有帮助，请再试一次 - 并描述您的总体问题是您试图解决的问题解决 - 现在您正在与机械师讨论如何丢失螺栓，但您真正需要做的是修复爆胎，因此您可能过于专注于如何解决细节，而无法混淆您没有的事实甚至连千斤顶都没有把车抬离地面……

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-29T17:26:17.313

一个进程的线程共享相同的地址空间。因此，为线程间通信构建一个**互斥保护消息队列是很常见的。**请参阅[此答案](https://stackoverflow.com/a/4577987/1504523)以了解详细信息。消息队列可以是定制设计，例如链表结构，它可以包含元素，如`sender ThreadID`、`receiver ThreadID`、`the message`和可选的任意数量的`additional parameters`类似消息状态或其他内容。它还可能包含一个`unique message ID`和一个参数来告诉接收线程如何继续，例如是否从队列中删除消息。仍然可以使用信号来避免轮询消息队列以获取新消息。信号将触发线程读取受互斥体保护的消息队列以获取新消息。另一种方法是建立一个事件方案，如中所述[这个答案](https://stackoverflow.com/a/178962/1504523)。但这实际上也是一个受互斥体保护的全局标识符，它被设置并且等待线程正在轮询更改（所谓的忙等待）。可以立即对受互斥体保护的消息队列进行忙碌等待。有关更多信息，请参阅[此链接](http://pubs.opengroup.org/onlinepubs/7908799/xsh/pthread_cond_wait.html)`pthread_cond_wait`。

# android - 如何分离出嵌入在 Android 字符串中的 JSON 对象？

> ID：14082958
> 
> 赞同：0
> 
> 时间：2012-12-29T15:08:58.830
> 
> 标签：android, json, ksoap2

我正在使用一个包含 JSON 的字符串，该字符串由 ASP Web 服务传递给 Android。我在我的 Android 应用程序中收到的字符串如下：

```
GetCustomerListResponse{GetCustomerListResult=[{"VehicleID":"KL-9876","VehicleType":"Nissan","VehicleOwner":"Sanjiva"}]; } 
```

**假设我想从 JSON 字符串中获取车辆类型，我该怎么做？**

我完整的**Android代码**如下：

```
package com.example.objectpass;

import android.app.Activity;
import android.os.Bundle;
import android.util.Log;
import android.widget.ArrayAdapter;
import android.widget.Spinner;
import android.widget.TextView;
import org.ksoap2.*;
import org.ksoap2.serialization.SoapObject;
import org.ksoap2.serialization.SoapSerializationEnvelope;
import org.ksoap2.transport.*;

public class MainActivity extends Activity {
    TextView resultA;
    Spinner spinnerC;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        String[] toSpinnerSum;
        toSpinnerSum = new String[9];

        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        spinnerC = (Spinner) findViewById(R.id.spinner1);
        resultA = (TextView) findViewById(R.id.textView2);

        final String NAMESPACE = "http://tempuri.org/";
        final String METHOD_NAME = "GetCustomerList";
        final String SOAP_ACTION = "http://tempuri.org/GetCustomerList";
        final String URL = "http://192.168.1.100/WebService4/Service1.asmx";

        SoapObject Request = new SoapObject(NAMESPACE, METHOD_NAME);
        SoapSerializationEnvelope soapEnvelope = new SoapSerializationEnvelope(
                SoapEnvelope.VER11);
        soapEnvelope.dotNet = true;
        soapEnvelope.setOutputSoapObject(Request);
        AndroidHttpTransport aht = new AndroidHttpTransport(URL);

        try {
            aht.call(SOAP_ACTION, soapEnvelope);
            SoapObject response = (SoapObject) soapEnvelope.bodyIn;

            resultA.setText(response.toString());
        } 
        catch (Exception e) {
            e.printStackTrace();
        }
    }
} 
```

任何帮助将不胜感激。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T15:13:03.940

您可以使用[JSONObject](http://developer.android.com/reference/org/json/JSONObject.html)类。教程可以在[这里](http://www.technotalkative.com/android-json-parsing/)找到。相关问题[在这里](https://stackoverflow.com/questions/2818697/sending-and-parsing-json-in-android)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T15:31:20.877

将当前 Json 字符串解析为：

```
 //Convert String to JsonArray
 JSONArray jArray = new JSONArray(response.toString());

 for(int i=0;i<jArray.length();i++){
    // get json object from json Array
  JSONObject jsonobj = jArray.getJSONObject(i);

  //get VehicleType from jsonObject
   String str_VehicleType=jsonobj.getString("VehicleType");

  //get VehicleOwner from jsonObject
   String str_VehicleOwner=jsonobj.getString("VehicleOwner");

 } 
```

有关我们如何在 android 中解析 josn 字符串的更多信息，请参见

[http://www.technotalkative.com/android-json-parsing/](http://www.technotalkative.com/android-json-parsing/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-29T15:39:25.597

在这里，试试这个：

```
final int jsonBeginIdx = response.firstIndexOf("=");
final int jsonEndIdx = response.lastIndexOf(";");

if(jsonBeginIdx > 0 && jsonEndIdx > jsonBeginIdx) {
    final String jsn = response.substring(jsonBeginIdx + 1, jsonEndIdx);
    final JSONObject jsonObj = new JSONObject(json);
} else {
    // deal with malformed response here
} 
```

# node.js - 如何加密 dnode 连接？

> ID：14082960
> 
> 赞同：1
> 
> 时间：2012-12-29T15:09:12.747
> 
> 标签：node.js, ssl, dnode

我在我的 Node.js 应用程序中使用[dnode](https://github.com/substack/dnode)作为 RPC 样式的库。

现在我想使用公钥密码术来确保 dnode 的安全连接。我想无论如何使用 Node.js 的 TLS 模块这应该是可能的，但我从未使用过它，因此我错过了一些经验。

是否有人已经这样做了，并且可以提供一个小而完整的示例来说明如何设置加密和安全的 dnode 连接？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-25T13:39:24.660

`upnode`子堆栈在页面上有一个示例

[https://github.com/substack/upnode/#ssl-stream-example](https://github.com/substack/upnode/#ssl-stream-example)

所以如果你想使用，就`dnode`换掉`upnode`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T19:04:05.847

好的，我明白了。

您需要做的就是创建一个 TLS 服务器/客户端并将其流传输到 dnode。

例如，请参阅我的问题[如何验证连接实际上是 TLS 安全的？](https://stackoverflow.com/questions/14085444/how-to-verify-that-a-connection-is-actually-tls-secured)

# jquery - 跨度不包裹在 div 内

> ID：14082962
> 
> 赞同：0
> 
> 时间：2012-12-29T15:09:16.640
> 
> 标签：jquery, html, css

我试图通过`div`在我的字段后面放置一个并复制这些值来突出显示文本区域的单词。

```
$("div").html($("textarea").text()
   .replace("bad-word", "<span style='background-color: red'>bad-word</span>")) 
```

我模拟了它，它在 Chrome 中运行良好。但是在 IE 中，当单词太大而无法容纳该行时，似乎`span`s 不会跳到 s 的下一行。`div`取而代之的是，它似乎会强制产生断词的效果-这`textarea`不会，因此单词不再对齐。在 IE8 + 9 中测试。

![IE 9 截图](../Images/2a597d0fc572b8ef21c4b246ca7d25ac.png) *屏幕截图，IE 9 中的代码结果*

这是一个[小提琴](http://jsfiddle.net/Zt2Az/15/)。尝试在 textarea 的开头添加一个字母，你会明白我的意思。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T15:18:02.220

**[现场演示](http://jsfiddle.net/Zt2Az/25/)**

```
$("#g1").val("This is me talking about pizza, cheese and also other pizza too hello! how are you?");

$("#g1").keyup(function(e) {
    keyUp(this);
})

function keyUp( el ) {
    var txtArea = $(el);
    var txtAVal = txtArea .val();
    txtAVal = txtAVal.replace(/pizza/gi, "<span style='background:red'>pizza</span>");
    $("#g2").html(txtAVal );
} 
```

# cuda - CUDA 分配对齐是 256 字节 - 认真吗？

> ID：14082964
> 
> 赞同：9
> 
> 时间：2012-12-29T15:09:31.370
> 
> 标签：cuda, textures

在“CUDA C Programming Guide 5.0”中，p73（[也在这里](https://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#device-memory-accesses)）说“驻留在全局内存中或由驱动程序或运行时 API 的内存分配例程之一返回的变量的任何地址始终与至少 256 个字节对齐”。我不知道这句话的确切含义。谁能给我举个例子？非常感谢。

一个衍生问题：那么，如何分配基本元素（如 int）或自定义元素的一维数组？数组的起始地址会是256B的倍数，而数组中每个元素的地址不一定是256B的倍数？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-29T15:50:06.157

通过使用任何 CUDA 运行时的设备内存分配函数分配的指针，例如`cudaMalloc`或`cudaMallocPitch`保证是 256 字节对齐的，即地址是 256 的倍数。

考虑以下示例：

```
char *ptr1, *ptr2;

int bytes = 1;

cudaMalloc((void**)&ptr1,bytes);
cudaMalloc((void**)&ptr2,bytes); 
```

假设返回的地址`ptr1`是 256 的某个倍数，那么返回的地址`ptr2`将是 atleast `(ptr1 + 256)`。

这是分配内存的设备所施加的限制。大多数情况下，指针是出于性能目的而对齐的。（一些 NVIDIA 的家伙应该能够判断是否还有其他原因）。

# 重要的：

**指针对齐并不总是 256**。在我的设备（GTX460M）上，它是512。您可以通过`cudaDeviceProp::textureAlignment`字段获得设备指针对齐。

指针的对齐也是将指针绑定到纹理的要求。

# c# - 何时为 ItemsControl 调用 ConvertBack？

> ID：14082966
> 
> 赞同：0
> 
> 时间：2012-12-29T15:09:47.720
> 
> 标签：c#, wpf, xaml, itemscontrol, updatesourcetrigger

我有以下项目数据类，以及一个转换器。

```
class ListBoxViewItem
{
    public String Name { get; set; }
    public Boolean IsChecked { get; set; }
}

[ValueConversion(typeof(List<String>),typeof(List<ListBoxViewItem>))]
class ListToItemConverter : IValueConverter
{
    public object Convert(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
    {
        if (value == null) return null;
        IEnumerable<String> l = value as IEnumerable<String>;
        return (from n in l select new ListBoxViewItem() { IsChecked = true, Name = n });
    }

    public object ConvertBack(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
    {
        throw new NotImplementedException();
    }
}

class ListBoxData
{
    public List<String> AllData
    {
        get
        {
            return new List<string>()
            {
                "FOO",
                "BAR"
            };
        }
        set
        {

        }
    }
} 
```

我将 的实例绑定`ListBoxData`到列表框控件的`ItemsSource`. 如下：

```
 <ListBox>
        <ListBox.ItemsSource>
            <Binding>
                <Binding.Path>AllData</Binding.Path>
                <Binding.Converter>
                    <local:ListToItemConverter />
                </Binding.Converter>
                <Binding.Mode>TwoWay</Binding.Mode>
            </Binding>
        </ListBox.ItemsSource>
        <ListBox.ItemTemplate>
            <DataTemplate>
                <CheckBox IsChecked="{Binding IsChecked,Mode=TwoWay}"
                          Content="{Binding Name}"/>
            </DataTemplate>
        </ListBox.ItemTemplate>
    </ListBox> 
```

所以我的问题是，`Convert`当列表框显示时调用该函数，但是由于此列表框中的每个项目都是一个复选框，虽然我使用`TwoWay`绑定来绑定实例和列表框，但是`ConvertBack`当我选中/取消选中复选框时不会调用这个列表框。

我不确定是否`ConvertBack`设计为按预期工作。但是，如果我想`ConvertBack`在检查状态更改时触发可以，我该怎么办？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T15:45:51.973

当在 Mode=TwoWay 的绑定中使用 Converter 时，将触发 ConvertBack 方法。例如，它用于绑定到 TextBox 的 Text 属性。在 TextBox 中显示值时，当值更改时会触发“Convert”方法，当用户更改 TextBox 值时会触发“ConvertBack”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T15:17:56.603

将[UpdateSourceTrigger](http://msdn.microsoft.com/en-us/library/system.windows.data.updatesourcetrigger%28v=vs.95%29.aspx)`ConvertBack`添加到具有函数反向功能的绑定和实现`Convert`函数。

更改以下

```
<CheckBox IsChecked="{Binding IsChecked,Mode=TwoWay}"> 
```

至

```
 <CheckBox IsChecked="{Binding IsChecked,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"> 
```

ConvertBack函数如下

```
public object ConvertBack(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
{
    if (value is IEnumerable<ListBoxViewItem>) 
    {
      var l = (IEnumerable<ListBoxViewItem>)value;
      return l.Select(l.IsChecked);
    }

   return null;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T17:03:27.697

你正在转换`ListBox.ItemsSource`，而不是`CheckBox.IsChecked`

我认为`ListBox.ItemsSource`甚至不会使用`TwoWay`绑定，因为默认情况下 ListBoxes 不会更改其 ItemsSource 的源集合。

如果您希望转换器在您更改时运行`CheckBox.IsChecked`，那么您需要指定要在`IsChecked`绑定中使用的转换器

```
<CheckBox IsChecked="{Binding IsChecked, 
                              Converter={StaticResource MyCheckboxConverter}}"
          Content="{Binding Name}"/> 
```

但在这种情况下，不需要转换器，因为`IsChecked`它已经是一个布尔值，所以你根本不需要转换它。

如果您试图在`CheckBox.IsChecked`更改时触发某些内容，则最好确保`IsChecked`触发通知，并在包含该属性的类的事件中`PropertyChange`执行代码。`PropertyChanged``IsChecked`

# e-commerce - 亚马逊购物车与 Inline Checkout 的集成

> ID：14082968
> 
> 赞同：5
> 
> 时间：2012-12-29T15:10:02.417
> 
> 标签：e-commerce, amazon, shopping-cart, checkout

我正在使用亚马逊结账车（亚马逊履行）。我想将在线结账与亚马逊购物车集成。我找不到任何文档来集成两者。

是否有可能做到这一点。请指导我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-02T21:44:40.760

今天，我收到了亚马逊的回复，根本不可能：

> 恐怕您无法集成这两项服务，因为亚马逊购物车使用的 Checkout By Amazon 版本比 Inline Checkout 使用的版本更旧。我们建议您自己创建购物车并通过标准结账或内联结账进行集成。

# objective-c - UIImage > NSData > NSString 失败

> ID：14082974
> 
> 赞同：1
> 
> 时间：2012-12-29T15:10:12.823
> 
> 标签：objective-c, nsstring, uiimage, nsdata

我知道这个问题已被多次质疑，但我的问题有点不同。我有一张图片（shared.image），我想将数据上传到服务器。这是代码（img: 位只是让服务器知道这是图像而不是字符串的一种方式）：

```
NSString *imageString = [NSString stringWithFormat:@"img:%@", UIImagePNGRepresentation(shared.image)];
NSData *imageData = [imageString dataUsingEncoding:NSUTF8StringEncoding];
[shared.outputStream write:[imageData bytes] maxLength:[imageData length]]; 
```

当服务器响应（作为字符串）时，这是另一个代码（shared.array 是一个数组，它在数据包碎片的情况下对所有字符串进行分组。img：位被删除）：

```
string = [shared.imageArray componentsJoinedByString:@""];
NSData *data = [string dataUsingEncoding:NSUTF8StringEncoding];
imageView.image = [UIImage imageWithData:data]; 
```

我 nslogged [UIImage imageWithData:data] 并返回 nil。我究竟做错了什么 ？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-01-22T11:26:43.767

对于 IOS >= 7

```
- (NSString *)imageToNSString:(UIImage *)image
{
    NSData *imageData = UIImagePNGRepresentation(image);

    return [imageData base64EncodedStringWithOptions:NSDataBase64Encoding64CharacterLineLength];
}

- (UIImage *)stringToUIImage:(NSString *)string
{
    NSData *data = [[NSData alloc]initWithBase64EncodedString:string
                                                      options:NSDataBase64DecodingIgnoreUnknownCharacters];

    return [UIImage imageWithData:data];
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-29T15:26:47.530

`NSString`当你有二进制数据时，为什么要往返于 a ？如果要加载`imageData`图像的内容，则完全绕过`NSString`：

```
NSData *imageData = UIImagePNGRepresentation(shared.image); 
```

如果您的服务器接受二进制数据，这就是您所需要的。

如果它需要文本字符串，那么您提出的代码将无法完成这项工作，而是您应该使用 Base64 之类的东西对其进行编码（例如，使用[Matt Gallager 的 NSData+Base64 类别](http://www.cocoawithlove.com/2009/06/base64-encoding-options-on-mac-and.html)）。例如：

```
NSData *imageData = UIImagePNGRepresentation(shared.image);
NSString *imageString = [NSString stringWithFormat:@"img:\"%@\"", [imageData base64EncodedString]]; 
```

请注意，在回复中，我建议将 Base64 编码的字符串括在引号中。这样，收件人就可以检测到 Base64 编码字符串的结尾。仅供参考，我已尝试尊重您的接口`img:`，但您也可以考虑使用标准[数据 URI 方案](http://en.wikipedia.org/wiki/Data_URI_scheme)，可能类似于：

```
NSString *imageString = [NSString stringWithFormat:@"img:\"data:image/png;base64,%@\"", [imageData base64EncodedString]]; 
```

由你决定。

在解析服务器响应方面，同样的问题是它是一个字符串（在这种情况下它应该是数据的 Base64 表示），还是它是否是二进制数据（在这种情况下，你应该只是附加数据到你`NSMutableData`，然后只是使用`imageWithData`）。

# python - 当文件没有 .py 扩展名时为 python 运行 flymake

> ID：14082975
> 
> 赞同：3
> 
> 时间：2012-12-29T15:10:29.053
> 
> 标签：python, emacs, lisp, flymake, pyflakes

我根本不是一个 lisp 人，但我的主要脚本环境存在于 emacs 上，当文件上没有 .py 扩展名时，我需要一些帮助才能让我的 flymake/pyflakes 运行。因为我工作中的一些脚本没有 .py 扩展名。

当我读取/编码具有 .py 扩展名的文件时，这非常适合 pylint、pep8、pychecker 等。

```
;; flymake for python
(add-to-list 'load-path "~/.emacs.d/plugins/flymake")

(when (load "flymake" t)
  (defun flymake-pylint-init (&optional trigger-type)
    (let* ((temp-file (flymake-init-create-temp-buffer-copy
                       'flymake-create-temp-with-folder-structure))
           (local-file (file-relative-name
                        temp-file
                        (file-name-directory buffer-file-name)))
           (options (when trigger-type (list "--trigger-type" trigger-type))))
      (list "~/.emacs.d/plugins/flymake/pyflymake.py" (append options (list local-file)))))
  (add-to-list 'flymake-allowed-file-name-masks
               '("\\.py\\'" flymake-pylint-init)))

(add-hook 'find-file-hook 'flymake-find-file-hook)

;; flymake help on minibuffer
(defun my-flymake-show-help ()
  (when (get-char-property (point) 'flymake-overlay)
   (let ((help (get-char-property (point) 'help-echo)))
    (if help (message "%s" help)))))

(add-hook 'post-command-hook 'my-flymake-show-help) 
```

当没有 .py 扩展名时，我试图让这个工作初始化片段。我用 python-mode-hook 包装了上面的代码，并将 \.py\ 部分更改为 \.*\ 之类的东西。

然而，这不仅为 python 文件调用 flymake-pylint-init 函数。它称它为在 emacs 中打开的任何东西。

顺便说一句，我无法在无扩展文件上使用 mx flymake-mode，它没有打开那个次要模式。

我很想知道让它工作的任何想法。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T01:43:51.880

首先让我说下面的代码通常不是解决 Emacs 问题的方法。我所做的是加载 flymake 然后踩到其中一个核心功能。由于 flymake 的编写方式，我找不到挂钩函数甚至使用建议的方法。如果 flymake 改变了这个函数或它的调用方式，它将不再起作用。也就是说，它多年来一直为我工作:)

这是基本代码：

```
(require 'flymake)

(defun flymake-get-file-name-mode-and-masks (file-name)
  "Return the corresponding entry from `flymake-allowed-file-name-masks'."
  (unless (stringp file-name)
    (error "Invalid file-name"))
  (let ((fnm flymake-allowed-file-name-masks)
        (mode-and-masks nil)
        (matcher nil))
    (while (and (not mode-and-masks) fnm)
      (setq matcher (car (car fnm)))
      (if (or (and (stringp matcher) (string-match matcher file-name))
              (and (symbolp matcher) (equal matcher major-mode)))
          (setq mode-and-masks (cdr (car fnm))))
      (setq fnm (cdr fnm)))
    (flymake-log 3 "file %s, init=%s" file-name (car mode-and-masks))
    mode-and-masks)) 
```

然后从你上面的代码，而不是这个：

```
(add-to-list 'flymake-allowed-file-name-masks '("\\.py\\'" flymake-pylint-init)) 
```

做这个：

```
(add-to-list 'flymake-allowed-file-name-masks '(python-mode flymake-pylint-init)) 
```

你可以对 Perl 等做同样的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T18:59:28.137

AFAIU 结尾仅对自动检测所需的缓冲模式很重要。您可以显式调用模式，分别。任何文件的交互式 Mx python 模式。

# python - 检查所有可能性需要多长时间？

> ID：14082984
> 
> 赞同：0
> 
> 时间：2012-12-29T15:11:43.747
> 
> 标签：python

我想制作一个python程序来运行python中的字符串：

```
a = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789' 
```

为该字符串找到所有可能的 16 字符组合是否需要很长时间？

有没有一种明智的方式来做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T15:15:23.593

您可以尝试使用`combinations`from `itertools`。

例子：

```
>>> import itertools
>>> [x  for x in itertools.combinations("ABC", 2)]
[('A', 'B'), ('A', 'C'), ('B', 'C')] 
```

# event-handling - 使用 smalltalk 访问事件处理程序中的实例变量

> ID：14082987
> 
> 赞同：1
> 
> 时间：2012-12-29T15:12:02.503
> 
> 标签：event-handling, smalltalk, squeak

我对 smalltalk 还很陌生，一个看似简单的问题让我抓狂。我自己的类继承自 Morphic 类并覆盖 keyStroke

```
keyStroke: anEvent
Transcript show: myDigitClass.
(((anEvent keyValue) > 47) and: ((anEvent keyValue) < 58)) ifTrue: [
    "myDigitClass dropADigit"
    "myDigitClass setADigit: (anEvent keyValue) asCharacter."
    Transcript show: (anEvent keyValue) asCharacter
    ] 
```

到目前为止有效，转录显示我在键盘上输入的内容，*但*实例变量 myDigitClass 为 NIL，即使我初始化了这个变量并通过一个 setter 方法将它传递给这个类。如果通过我写的 getter 方法访问 myDigitClass 就可以了。

我调用 showPane 方法并将输入参数 digitMD 分配给实例 Var。

```
showPane: digitMD
  |pane|
  myDigitClass := digitMD.

  pane := DigitMorph new.
  pane extent: 340@340.
  ^pane openInWorld. 
```

在工作区中，我执行以下操作：

```
 myDigitClass := DigitClass new.
 myTest := DigitMorph new.
 myTest showPane: myDigitClass. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T16:16:27.280

您可以通过发送 object 直接访问实例变量`#instVarNamed:`。这是一种私有方法，只有在您知道自己在做什么或调试时才应使用。

假设您的类的实例变量被调用，您将`#instVarNamed:`在示例中使用以下方式`theDigit`：

```
...
Transcript show: (myDigitClass instVarNamed: 'theDigit').
... 
```

成绩单将显示有效存储的值（例如`nil`）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T23:01:12.883

这个问题很模糊......
你怎么知道实例变量是 NIL ( `nil`?) ？
这是你在成绩单中得到的吗？

请注意，`Transcript show:`惯用语通常与 String 参数一起使用。
否则，它将 asString 发送到参数（至少在 Squeak 中）。

`yourMorph yourDigitGetter asString`会回答什么？

# cross-domain - 跨域集线器与signalR的连接

> ID：14082990
> 
> 赞同：1
> 
> 时间：2012-12-29T15:12:41.047
> 
> 标签：cross-domain, signalr

从这个例子来看，跨不同域的持久连接似乎工作正常：

[http://jsfiddle.net/GSEJp](http://jsfiddle.net/GSEJp)

但是当我尝试改用“hubConnection”时，因为我的应用程序使用集线器而不是原始连接，浏览器会抱怨 CORS。在浏览器中打开 Javascript 控制台并运行这个小提琴：

[http://jsfiddle.net/GSEJp/4/](http://jsfiddle.net/GSEJp/4/)

即使我的 Global.asax 包含以下代码：

```
 protected void Application_BeginRequest(object sender, EventArgs e)
    {
        this.Context.Response.AddHeader("Access-Control-Allow-Origin", "*");

        if (this.Context.Request.HttpMethod == "OPTIONS")
        {
            this.Context.Response.AddHeader("Access-Control-Allow-Methods", "GET, POST");
            this.Context.Response.AddHeader("Access-Control-Allow-Headers", "Content-Type, Authorization, Accept");
            this.Context.Response.End();
        }
    } 
```

那么有什么问题呢？仅仅是 hubConnections 在不同的域中不能很好地工作，还是我这边的问题？我应该提一下，我可以从本地 REST 客户端（邮递员）向同一个 MVC 应用程序运行正常的 XHR 请求，所以这对我来说应该没有什么问题。

谢谢！

编辑：

经过一番挖掘后，我发现在第一个 jsfiddle 中使用的信号器 js 文件具有此“xdomain”属性的定义。但是它没有“hubConnection”的定义，所以这就是我切换到query.signalR-0.5.3.js的原因。但是那个没有“xdomain”的定义。这可能就是我收到 CORS 错误的原因。

是否有同时支持 xdomain 和 hubConnection 的 signalr js 客户端版本？

再次感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T19:49:22.553

正如 dfowler 在他的评论中所写，问题在于我使用的是旧版本的 SignalR。

阅读本文的其他人请注意：您需要在连接选项中设置 jsonp: true 才能使其正常工作。

# iphone - 在 iOS6 中 gethostbyname() 失败

> ID：14082992
> 
> 赞同：2
> 
> 时间：2012-12-29T15:13:10.320
> 
> 标签：iphone, ios6

我使用 gethostbyname() 来获取设备 IP。在 iOS5 中，它运行良好。但是在 iOS6 中，gethostbyname() 返回的主机值是 NULL。下面是我获取设备当前本地 IP 的代码。

```
// retun the host name
- (NSString *)hostname
{
    char baseHostName[256];
    int success = gethostname(baseHostName, 255);
    if (success != 0) return nil;
    baseHostName[255] = '\0';

#if !TARGET_IPHONE_SIMULATOR
    return [NSString stringWithFormat:@"%s.local", baseHostName];
#else
    return [NSString stringWithFormat:@"%s", baseHostName];
#endif
}

// return IP Address
- (NSString *)localIPAddress
{
    struct hostent *host = gethostbyname([[self hostname] UTF8String]);
    if (!host) {
        herror("resolv");
        return nil;
    }
    struct in_addr **list = (struct in_addr **)host->h_addr_list;
    return [NSString stringWithCString:inet_ntoa(*list[0]) encoding:NSUTF8StringEncoding];
} 
```

请注意，模拟器适用于 iOS5 和 iOS6。只有 iOS6 设备失败。gethostbyname() 有什么区别？或者你有什么其他解决方案可以在 iOS6 中获取本地 ip？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-29T17:13:37.767

有几个*可能的*问题：

*   也许您有一个 IPv6 地址（`gethostbyname()`仅适用于 IPv4），
*   或者从主机名到 IP 地址的名称解析无法正常工作。

以下代码将所有本地地址作为字符串数组返回。它不依赖于名称解析，适用于 IPv4 和 IPv6 地址。

```
#include <sys/types.h>
#include <sys/socket.h>
#include <ifaddrs.h>
#include <net/if.h>
#include <netdb.h>

// return all local IP addresses
- (NSArray *)localIPAddresses
{
    NSMutableArray *ipAddresses = [NSMutableArray array] ;

    struct ifaddrs *allInterfaces;

    // Get list of all interfaces on the local machine:
    if (getifaddrs(&allInterfaces) == 0) {
        struct ifaddrs *interface;

        // For each interface ...
        for (interface = allInterfaces; interface != NULL; interface = interface->ifa_next) {
            unsigned int flags = interface->ifa_flags;
            struct sockaddr *addr = interface->ifa_addr;

            // Check for running IPv4, IPv6 interfaces. Skip the loopback interface.
            if ((flags & (IFF_UP|IFF_RUNNING|IFF_LOOPBACK)) == (IFF_UP|IFF_RUNNING)) {
                if (addr->sa_family == AF_INET || addr->sa_family == AF_INET6) {

                    // Convert interface address to a human readable string:
                    char host[NI_MAXHOST];
                    getnameinfo(addr, addr->sa_len, host, sizeof(host), NULL, 0, NI_NUMERICHOST);

                    [ipAddresses addObject:[[NSString alloc] initWithUTF8String:host]];
                }
            }
        }

        freeifaddrs(allInterfaces);
    }
    return ipAddresses;
} 
```

# c# - 下载所有数据后是否引发 WebClient.OpenReadCompleted 事件？

> ID：14082995
> 
> 赞同：2
> 
> 时间：2012-12-29T15:13:29.450
> 
> 标签：c#, windows-phone-7, webclient

我正在使用 WebClient.OpenReadAsync 方法从 Windows Phone 7 上的 Web 服务器下载数据。在某些时候，会引发 OpenReadCompleted 事件，并且我会获得一个可用于读取数据的流。

我可以假设发生这种情况时数据已经下载吗？即读取流结束将是一个本地操作，不会涉及任何更多的网络访问？还是读取流实际上会触发下载数据？

如果数据已经下载，存储在哪里？如果数据量很大并且无法容纳任何地方，而我只想阅读其中的一小部分怎么办？

我在文档中找不到有关它的任何信息。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T15:15:58.390

> 我可以假设发生这种情况时数据已经下载吗？

不，你不能这样假设。当打开包含资源的流的异步操作完成时引发此事件。一旦您开始读取流，该流将从网络套接字读取，从而导致网络 I/O 操作。

> 如果数据已经下载，存储在哪里？

在引发此事件的那一刻，任何地方都不会下载任何数据。因此，如果服务器返回的数据很大，则由您在内存中以块的形式读取它并将其写入其他一些 Stream（如文件或数据库或其他东西）。

# objective-c - 仅打印视图错误地布置子视图

> ID：14082997
> 
> 赞同：1
> 
> 时间：2012-12-29T15:13:52.923
> 
> 标签：objective-c, cocoa, autolayout

我正在尝试打印（到 PDF）一个未显示在屏幕上且没有父视图的 NSView。

为了显示打印对话框，我在我的应用程序委托中添加了以下行`applicationDidFinishLaunching:`：

```
[myPrintView print:self]; 
```

![子视图从下到上](../Images/397752495e5abc2995961bf440885d71.png)

在打印对话框的预览中，子视图自下而上显示。首先显示底部子视图，然后是应该在底部视图上方的子视图等，最后显示顶部子视图。

当我将打印视图添加到滚动视图时，使其在打印调用之前显示在屏幕上，滚动视图和打印预览中的顺序都是正确的。

```
self.scrollView.documentView = myPrintView; 
```

![正确顺序的子视图](../Images/c51b5af30ec1056a863187745f1aaaf0.png)

我将我的打印视图更改为不翻转，它在两种情况下都以正确的顺序显示，但它放在纸的底部。

![正确的顺序，但在页面底部](../Images/129e8fc2086afb63ed5902d63963a052.png)

我该如何解决这个问题？保持翻转并解决错误的顺序，还是保持翻转 = NO 并使用不同的方法将其粘贴到页面顶部？

我已将我的项目添加到[https://bitbucket.org/bpeiren/print-experiments](https://bitbucket.org/bpeiren/print-experiments)以防万一。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T19:18:31.197

听起来您的布局不明确，这意味着您的 nib 没有足够的约束来确保子视图出现在您想要的位置。您看到的两个布局都满足约束，因此您需要约束布局的更多方面，以便子视图出现在您想要的位置。

从您发布的两张布局图片来看，我建议您尝试：

1.  将顶视图的顶部固定到容器的顶部
2.  固定顶视图和底视图之间的垂直间距

**补充：**我刚刚下载[了您的.xib](https://bitbucket.org/bpeiren/print-experiments/raw/46935c8d1bf17c9ca2094d9bed37b4729eb8df1c/Print%20Experiments/en.lproj/MainMenu.xib)，很明显您将顶部子视图限制在视图的顶部，以及子视图的垂直间距，在页面下方。所以这不会解决问题。高度是可变的吗？如果没有，请尝试限制容器的高度。为什么要在 NSViews 中包含文本和图像字段？把它们拿出来可能更简单。（您不会收到有关不可满足约束的日志消息，对吧？）

这个 WWDC 视频，[自动布局简介](https://developer.apple.com/videos/wwdc/2012/?id=228)给出了我见过的模糊布局的最佳解释。

出于调试目的，您可以将视图添加到窗口，然后使用[这个好答案描述](https://stackoverflow.com/a/8192491/893113)的自动布局。

或者，您可以关闭此笔尖的自动布局。由于您的视图很简单，您可以使用弹簧和支柱很容易地管理布局。