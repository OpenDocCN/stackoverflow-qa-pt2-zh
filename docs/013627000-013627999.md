# StackOverflow 问答 13627000-13627999

# android - 自定义列表项未响应选择器中的 state_checked

> ID：13627000
> 
> 赞同：13
> 
> 时间：2012-11-29T13:34:10.260
> 
> 标签：android, listview, android-adapter

我将首先说我已经详细阅读了几乎所有关于 SO 的问题，我可以找到与自定义可检查列表项和选择器相关的问题。他们中的许多人都有*类似*的问题，但没有一个答案能解决我的问题。

在我的应用程序中，我展示了一个自定义列表活动。创建后，它会从调用它的意图中检索一组静态数据，并将该数据传递给它的自定义数组适配器。每个列表项都是一个简单的 RelativeLayout，它实现了[Checkable](http://developer.android.com/reference/android/widget/Checkable.html)接口。默认情况下，如果您单击其中一项，则会显示一个新活动，其中显示有关所选联系人的详细信息。但是，如果长按列表中的项目，则会启动 ActionMode。此时单击列表中的项目不会显示详细活动，它只是将项目设置为选中。然后，如果用户选择动作模式项之一，它会对选中的项执行动作。

要理解的重要一点是，在两种选择“模式”中，单击列表项会将其设置为选中。

我上面描述的所有内容都很完美。我**唯一**的问题与设置为选中时未突出显示的列表项的背景有关，即使使用默认选择器也是如此。

我想要做的是有两个选择器：每个选择模式一个。在第一种情况下，检查项目时背景不会改变，而在第二种情况下会改变。我尝试过实现自定义选择器，但即使在那些 state_checked 中也被忽略了！选择器的其他部分工作正常，但不是 state_checked。

我对 CheckableListItem 的实现结合了许多不同示例的想法，所以如果我做错了什么，或者是否有更好的方法，请告诉我！

**注意**：有趣的一点是，如果我将 results_list_item.xml 中的列表项的背景设置为我的选择器，而不是 ListView 的 listSelector 属性，则在检查项目时背景*会*发生变化。但是，这样做会导致我的选择器中的长按转换不起作用。

**结果活动.java**：

```
public class ResultsActivity extends ListActivity implements OnItemLongClickListener {

    private ListView listView;          // Reference to the list belonging to this activity
    private ActionMode mActionMode;     // Reference to the action mode that can be started
    private boolean selectionMode;      // Detail mode or check mode

    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_results);

        // When the home icon is pressed, go back
        ActionBar actionBar = getActionBar();
        actionBar.setDisplayHomeAsUpEnabled(true);

        // Get a reference to the list
        listView = getListView();

        // Initially in detail mode
        selectionMode = true;

        // Get the contacts from the intent data and pass them to the contact adapter
        @SuppressWarnings("unchecked")
        ArrayList<Contact> results = ((ArrayList<Contact>)getIntent().getSerializableExtra("results"));
        Contact[] contacts = new Contact[results.size()];
        ContactArrayAdapter adapter = new ContactArrayAdapter(this, results.toArray(contacts));
        setListAdapter(adapter);

        // We will decide what happens when an item is long-clicked
        listView.setOnItemLongClickListener(this);
    }

    /**
     * If we are in detail mode, when an item in the list is clicked
     * create an instance of the detail activity and pass it the
     * chosen contact
     */
    public void onListItemClick(ListView l, View v, int position, long id) {
        if (selectionMode) {
            Intent displayContact = new Intent(this, ContactActivity.class);
            displayContact.putExtra("contact", (Contact)l.getAdapter().getItem(position));
            startActivity(displayContact);
        }
    }

    public boolean onCreateOptionsMenu(Menu menu) {
        return super.onCreateOptionsMenu(menu);
    }

    /**
     * If the home button is pressed, go back to the
     * search activity
     */
    public boolean onOptionsItemSelected(MenuItem item) {
        switch (item.getItemId()) {
            case android.R.id.home:
                Intent intent = new Intent(this, SearchActivity.class);
                intent.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
                startActivity(intent);
                return true;
            default:
                return super.onOptionsItemSelected(item);
        }
    }

    /**
     * When an item is long-pressed, switch selection modes 
     * and start the action mode 
     */
    public boolean onItemLongClick(AdapterView<?> adapter, View view, int position, long i) {
        if (mActionMode != null)
            return false;

        if (selectionMode) {
            toggleSelectionMode();
            listView.startActionMode(new ListActionMode(this, getListView()));
            return true;
        }
        return false;
    }

    /**
     * Clear the list's checked items and switch selection modes
     */
    public void toggleSelectionMode() {
        listView.clearChoices();
        ((ContactArrayAdapter)listView.getAdapter()).notifyDataSetChanged();
        if (selectionMode) {
            selectionMode = false;
        } else {
            selectionMode = true;
        }
    }
} 
```

**活动结果.xml**：

```
<ListView xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@android:id/list"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:choiceMode="multipleChoice" 
    android:listSelector="@drawable/list_selector" /> 
```

**list_selector.xml**：

```
<selector xmlns:android="http://schemas.android.com/apk/res/android" >
    <item android:state_pressed="true" android:drawable="@drawable/blue_transition" />
    <item android:state_checked="true" android:drawable="@drawable/blue" />
</selector> 
```

**双线阵列适配器**：

```
public abstract class TwoLineArrayAdapter extends ArrayAdapter<Contact> {

    private int mListItemLayoutResId;

    public TwoLineArrayAdapter(Context context, Contact[] results) {
        this(context, R.layout.results_list_item, results);
    }

    public TwoLineArrayAdapter(Context context, int listItemLayoutResourceId, Contact[] results) {
        super(context, listItemLayoutResourceId, results);
        mListItemLayoutResId = listItemLayoutResourceId;
    }

    public View getView(int position, View convertView, ViewGroup parent) {

        LayoutInflater inflater = (LayoutInflater)getContext().getSystemService(Context.LAYOUT_INFLATER_SERVICE);

        View listItemView = convertView;
        if (convertView == null) {
            listItemView = inflater.inflate(mListItemLayoutResId, parent, false);
        }

        // Get the text views within the layout
        TextView lineOneView = (TextView)listItemView.findViewById(R.id.results_list_item_textview1);
        TextView lineTwoView = (TextView)listItemView.findViewById(R.id.results_list_item_textview2);

        Contact c = (Contact)getItem(position);

        lineOneView.setText(lineOneText(c));
        lineTwoView.setText(lineTwoText(c));

        return listItemView;
    }

    public abstract String lineOneText(Contact c);

    public abstract String lineTwoText(Contact c);

} 
```

**联系人数组适配器**：

```
public class ContactArrayAdapter extends TwoLineArrayAdapter {

    public ContactArrayAdapter(Context context, Contact[] contacts) {
        super(context, contacts);
    }

    public String lineOneText(Contact c) {
        return (c.getLastName() + ", " + c.getFirstName());
    }

    public String lineTwoText(Contact c) {
        return c.getDepartment();
    }

} 
```

**CheckableListItem.java**：

```
public class CheckableListItem extends RelativeLayout implements Checkable {

    private boolean isChecked;
    private List<Checkable> checkableViews;

    public CheckableListItem(Context context, AttributeSet attrs,
            int defStyle) {
        super(context, attrs, defStyle);
        initialise(attrs);
    }

    public CheckableListItem(Context context, AttributeSet attrs) {
        super(context, attrs);
        initialise(attrs);
    }

    public CheckableListItem(Context context, int checkableId) {
        super(context);
        initialise(null);
    }

    private void initialise(AttributeSet attrs) {
        this.isChecked = false;
        this.checkableViews = new ArrayList<Checkable>(5);
    }

    public boolean isChecked() {
        return isChecked;
    }

    public void setChecked(boolean check) {
        isChecked = check;
        for (Checkable c : checkableViews) {
            c.setChecked(check);
        }
        refreshDrawableState();
    }

    public void toggle() {
        isChecked = !isChecked;
        for (Checkable c : checkableViews) {
            c.toggle();
        }
    }

    private static final int[] CheckedStateSet = {
        android.R.attr.state_checked
    };

    protected int[] onCreateDrawableState(int extraSpace) {
        final int[] drawableState = super.onCreateDrawableState(extraSpace + 1);
        if (isChecked()) {
            mergeDrawableStates(drawableState, CheckedStateSet);
        }
        return drawableState;
    }

    protected void onFinishInflate() {
        super.onFinishInflate();
        final int childCount = this.getChildCount();
        for (int i = 0; i < childCount; i++) {
            findCheckableChildren(this.getChildAt(i));
        }
    }

    private void findCheckableChildren(View v) {
        if (v instanceof Checkable) {
            this.checkableViews.add((Checkable) v);
        }
        if (v instanceof ViewGroup) {
            final ViewGroup vg = (ViewGroup) v;
            final int childCount = vg.getChildCount();
            for (int i = 0; i < childCount; i++) {
                findCheckableChildren(vg.getChildAt(i));
            }
        }
    }
} 
```

**results_list_item.xml**：

```
<com.test.mycompany.Widgets.CheckableListItem
    android:id="@+id/results_list_item"
    xmlns:android="http://schemas.android.com/apk/res/android" 
    android:layout_width="match_parent"
    android:layout_height="wrap_content" 
    android:paddingLeft="10dp"
    android:paddingRight="10dp"
    android:paddingTop="5dp"
    android:paddingBottom="5dp" >

    <TextView android:id="@+id/results_list_item_textview1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:textSize="20sp"
        android:textColor="#000000"
        android:focusable="false" />

    <TextView android:id="@+id/results_list_item_textview2"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_below="@id/results_list_item_textview1"
        android:textSize="16sp"
        android:textColor="@android:color/darker_gray" 
        android:focusable="false" />

</com.test.mycompany.Widgets.CheckableListItem> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-29T07:18:02.420

如果这还没有解决，请尝试为您的“可检查布局”提供一个背景可绘制，其中包含选择器以及其中的状态和颜色定义。否则，drawableStateChanged 不会做任何事情，因为 mBackground 为空。（例如 android:background="@drawable/list_selector"）

然后确保您使用`listview.setChoiceMode(AbsListView.CHOICE_MODE_MULTIPLE)`允许检查多个项目。

您不必实施`setOnItemClickListener`它来检查项目，因为设置选择模式已经自动完成。（也不要将 Checkable 布局设置为可点击）

好吧，至少这就是我解决我的问题的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T17:35:36.403

我更改并添加了这些方法`CheckedListItem`，它对我有用：

```
@Override
public boolean onTouchEvent( MotionEvent event ) {

    int action = event.getAction() & MotionEvent.ACTION_MASK;
    if ( action == MotionEvent.ACTION_UP ) {
        toggle();
    }

    return true;
}

public void toggle() {

    setChecked( !isChecked() );
}

private static final int[] CheckedStateSet = { android.R.attr.state_checked }; 
```

似乎问题在于单击时，您从未处理过切换视图的选中状态。

# wordpress - 建立一个大型的wordpress网站

> ID：13627005
> 
> 赞同：1
> 
> 时间：2012-11-29T13:34:28.467
> 
> 标签：wordpress, content-management-system, installation

我目前正在从事一个涉及在 WordPress 中设置大菜单的项目。为此，我使用 WordPres 中的页面部分在此菜单中创建页面，并将顶级页面添加到菜单部分。这样做的原因是客户端不需要在每次添加页面时都更改菜单。菜单自动选择它。

当我谈到新闻部分（您想在其中显示帖子概述）之类的东西时，这会有点棘手。为此，我在页面上创建了一个自定义元框，客户可以在该页面中选择要在该页面上显示的帖子或帖子类别。此外，菜单还包含很多具有相同信息的项目，例如联系人部分或路线描述。我想要的是输入一次此信息并在菜单中的不同页面上使用。那是页面的自定义元框再次派上用场。

现在的问题......也许这是一个意见问题，但我不禁想知道上述方法是否是要走的路......只使用页面和许多自定义脚本。

有人有这方面的经验吗？谢谢您的帮助。

欢呼，J

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-02T16:39:16.217

新 wordpress 中的菜单功能是配置菜单的好方法。但是如果你想在每次用户添加页面时改变菜单，你可以在 wordpress 上使用旧的菜单样式，代码如下

`<ul> <?php wp_list_pages('title_li='); ?> </ul>`

只需检查此页面[http://codex.wordpress.org/Function_Reference/wp_list_pages](http://codex.wordpress.org/Function_Reference/wp_list_pages)

# jquery - 如何在 Rails 中从 JQuery 更改 CSS（背景图像）？

> ID：13627009
> 
> 赞同：2
> 
> 时间：2012-11-29T13:34:43.100
> 
> 标签：jquery, css, ruby-on-rails, coffeescript, background-image

我正在尝试更改`body`Rails 应用程序标签中的背景图像。我已经从 items.js.coffee （我有名为 items 的表）和 application.js 中尝试过它。我不能让它工作。

我试图更改背景颜色，这可以从 application.js 工作，但不能从 items.js.coffee 工作。

所以我的问题是：如何更改背景图像，CSS 中的所有更改都必须从 application.js 完成吗？

items.js.coffee：

```
$ ->
    $(document).ready ->
        if something
            $("body").css "background-image", "url(rails.png)" 
```

bootstrap_and_overrides.css.less：

```
body { 
    padding-top: 60px;
    background-color: black;
    background-image:url('HypeTrans.png');
    background-repeat:no-repeat;
    background-attachment:fixed;
    background-position: 50% 50%;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T13:43:02.693

似乎最可能的解释是，如果您使用资产管道，您的布局或 application.js 中没有包含 items.js 文件。

在开发模式下，查看渲染页面的源代码*并确认页面中包含 items.js。如果不是，并且假设您使用的是 Rails 3.1+ - 我建议您查看[Asset Pipeline Rails 指南](http://guides.rubyonrails.org/asset_pipeline.html#manifest-files-and-directives)以了解如何将文件添加到清单中。

*   我建议这样做，因为无论您是否使用资产管道，它都应该工作，因为在您的 application.js 清单中的开发模式文件是单独包含的。

**更新**

与此相关的是，如果您指的是从资产管道提供的资产，它们将出现在 /assets 下，因此您的代码应该是

```
$("body").css "background-image", "url('/assets/rails.png')" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T13:53:31.887

我向你展示了一种用 javascript 编写 css 代码的方法，所以你可以试试这个

```
$(function(){
    if(something){
        $("body").css({
            'background-image':'url(path of the image)'
        })
    }
}) 
```

这样就可以写css

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-29T14:02:14.633

为什么不将背景图像更改为背景

```
bootstrap_and_overrides.css.less 
```

所以让它看起来像这样

```
body { 
padding-top: 60px;
background-color: black;
background:url('HypeTrans.png');
background-repeat:no-repeat;
background-attachment:fixed;
background-position: 50% 50%; 
```

}

# openjpa - 如何使用 Pax Logging 配置 OpenJPA 日志记录？

> ID：13627019
> 
> 赞同：1
> 
> 时间：2012-11-29T13:35:20.590
> 
> 标签：openjpa, apache-karaf, pax

如何配置 OpenJPA 以在 Karaf 中使用 Pax 日志记录？根据我发现的几个线程（例如[pax-logging 的 log4j 错误](http://mail-archives.apache.org/mod_mbox/karaf-dev/201102.mbox/%3C20110209160651.GE30164@coprime.kabsi.at%3E)），似乎设置

```
<property name="openjpa.Log" value="commons" /> 
```

（或`slf4j`）在 persistence.xml 和

```
log4j.category.openjpa.Tool=INFO
log4j.category.openjpa.Runtime=INFO
log4j.category.openjpa.Remote=INFO
log4j.category.openjpa.DataCache=INFO
log4j.category.openjpa.MetaData=INFO
log4j.category.openjpa.Enhance=INFO
log4j.category.openjpa.Query=INFO
log4j.category.openjpa.jdbc.SQL=INFO
log4j.category.openjpa.jdbc.SQLDiag=INFO
log4j.category.openjpa.jdbc.JDBC=INFO
log4j.category.openjpa.jdbc.Schema=INFO 
```

在 org.ops4j.pax.logging.cfg 中*应该可以*工作，但它不适合我。版本为：OpenJPA 2.2.0、Karaf 2.3.0、Pax Logging 1.7.0。OpenJPA 日志记录导入正确解析为 Pax 日志记录：

```
karaf@root> imports 106
...
OPS4J Pax Logging - API (4): org.apache.commons.logging; version=1.1.1
OPS4J Pax Logging - API (4): org.apache.commons.logging; version=1.0.4
OPS4J Pax Logging - API (4): org.apache.log4j; version=1.2.15
OPS4J Pax Logging - API (4): org.slf4j; version=1.7.1
OPS4J Pax Logging - API (4): org.slf4j; version=1.6.6
OPS4J Pax Logging - API (4): org.slf4j; version=1.5.11
OPS4J Pax Logging - API (4): org.slf4j; version=1.4.3
... 
```

编辑：我刚刚注意到这个版本的 Pax Logging exports `org.apache.log4j`，但如果我设置`openjpa.Log`为`log4j`，我的包无法正确启动：

```
2012-11-29 17:40:28,931 | INFO  | rint Extender: 1 | BlueprintContainerImpl           | container.BlueprintContainerImpl  330 | 7 - org.apache.aries.blueprint.core - 1.0.1 | Bundle ru.focusmedia.odp.server.datastore.jpa is waiting for dependencies [(&(&(!(org.apache.aries.jpa.proxy.factory=*))(osgi.unit.name=ODP_Server))(objectClass=javax.persistence.EntityManagerFactory))] 
```

并且由于某种原因无法获得这种依赖关系。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T09:55:38.520

我正在使用以下内容，它非常适合我：

```
<property name="openjpa.Log" value="slf4j" /> 
```

如果需要，您也可以添加*log4j.category.openjpa*，不过我不需要它。

# android - 使用 Android 加速度计的活动识别

> ID：13627022
> 
> 赞同：1
> 
> 时间：2012-11-29T13:35:27.280
> 
> 标签：android, accelerometer, gesture-recognition

> **可能重复：**
> [将方向存储到数组 - 并比较](https://stackoverflow.com/questions/6368618/store-orientation-to-an-array-and-compare)
> [处理加速度计数据](https://stackoverflow.com/questions/13453517/processing-accelerometer-data)

我正在使用 Android 开发一个移动应用程序，我想在其中使用加速度计传感器确定用户的活动（主要是行走和站立）。有人知道一些可以使用或开始的免费图书馆吗？由于我正在使用 Android，因此我正在寻找轻量级的东西。除了几十篇理论论文，我在谷歌上找不到太多东西。

我知道这是一个相当广泛的问题，但我认为它可以帮助处于相同情况的每个人。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T16:31:35.017

我想所有的链接对于理解如何做都是最重要的。链接如下：- [Imp Link for Understanding](http://developer.android.com/guide/topics/sensors/sensors_motion.html#sensors-motion-accel) with another link:- [Main Link with Example](http://www.techrepublic.com/blog/app-builder/a-quick-tutorial-on-coding-androids-accelerometer/472)。

也试试这个链接：-用这个链接[解释示例](http://www.vogella.com/articles/AndroidSensor/article.html)：-[堆栈链接](https://stackoverflow.com/questions/6274129/how-to-use-accelerometer-values-to-move-an-image-in-android)。现在这个链接非常有用，其中包括：- [Accelerometer Basic Usage](http://indyvision.net/2010/03/android-accelerometer-basic-usage/)并[使用 accelerometer](https://sites.google.com/site/androidhowto/how-to-1/use-the-accelerometer)。

# iphone - 如何从 iPhone 画廊钛获取图像？

> ID：13627029
> 
> 赞同：0
> 
> 时间：2012-11-29T13:35:50.607
> 
> 标签：iphone, image, mobile, titanium, gallery

我需要从 iPhone 照片库中选择一张图片并上传到服务器。我在画廊中有 10kb 的图像。

```
Titanium.Media.openPhotoGallery({
                    success : function(e) {
                        var image = e.media;

                    },
                    cancel : function() {
                        Ti.API.info('user cancelled galary.');
                    },
                    error : function(error) {
                        var alert = Titanium.UI.createAlertDialog({
                            title : 'Sorry!',
                            message : 'Error: ' + error.code
                        });
                        alert.show();
                    },
                    mediaTypes : Ti.Media.MEDIA_TYPE_PHOTO
                }); 
```

我使用上面的代码，e.media 返回 40kb 大小的图像。为什么？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T13:54:32.837

可能是您服务器端的错误。检查文件的某种格式或大小是否有限制。顺便说一句，我正在使用此代码上传文件并且工作正常

```
var xhr = Titanium.Network.createHTTPClient();
    xhr.onerror = errorCallback;
    xhr.onload = loadCallback;
    xhr.onsendstream = progressCallback;
    // open the client
    xhr.setTimeout(30000);
    xhr.open('POST', url);
    xhr.setRequestHeader("ContentType", "image/jpeg");

    // send the data
    xhr.send({
        media : media
    }); 
```

# c# - 如何在使用安装程序安装 ASP.NET 应用程序时隐藏代码？

> ID：13627030
> 
> 赞同：0
> 
> 时间：2012-11-29T13:35:53.273
> 
> 标签：c#

我想使用安装程序文件（exe 或 msi）安装 Web 应用程序。当我安装它时，文件后面的代码中的所有代码都是可见的。有没有办法在安装时隐藏代码？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T13:41:51.333

您必须先预编译应用程序，然后再将其打包到安装程序中。

有关详细信息，请参阅此链接：http: [//msdn.microsoft.com/en-us/library/ms228015.aspx](http://msdn.microsoft.com/en-us/library/ms228015.aspx)

最简单的方法是使用`Publish`Visual Studio 中的选项。

# php - 致命错误：在第 183 行的 ...\model.php 中超过了 30 秒的最大执行时间

> ID：13627031
> 
> 赞同：0
> 
> 时间：2012-11-29T13:35:55.863
> 
> 标签：php, mysql

我在本地机器上。我只在插入|创建|删除后第一次加载页面时收到该错误。然后它加载非常快。然后，如果我修改数据库，第一次（有时是第二次）访问页面时会出现该错误。我不明白。

**为什么我在修改数据库后第一次访问该站点时才收到该错误？**

```
$sth = $this->dbh->prepare("SELECT g.t_tree_c_parent AS gp ,h.t_tree_c_parent AS hp
                FROM t_tree a INNER JOIN (t_data b, t_data c, t_tree d, t_data e, t_data f, t_tree g, t_tree h, t_tree i) 
                ON a.t_tree_c_child=b.t_data_c_space
                AND b.t_data_c_object=c.t_data_c_object
                AND c.t_data_c_space=d.t_tree_c_child
                AND d.t_tree_c_parent=e.t_data_c_object
                AND e.t_data_c_space=f.t_data_c_object
                AND f.t_data_c_space=g.t_tree_c_child
                AND g.t_tree_c_parent=h.t_tree_c_child
                AND e.t_data_c_space=i.t_tree_c_child
                AND i.t_tree_c_parent=?
                WHERE a.t_tree_c_child=?");
$sth->execute(array($this->glob['children'], $child)); //  <- LINE:183 
```

我将拆分该查询以进行测试。但我问也许我错过了一些东西。

@jcho360 要求更新：

```
CREATE TABLE `t_data` (
`t_data_c_space` VARCHAR(50) NOT NULL DEFAULT '0.00000000000',
`t_data_c_object` VARCHAR(50) NULL DEFAULT NULL,
`t_data_c_timestamp` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
PRIMARY KEY (`t_data_c_space`)
 )
COLLATE='utf8_general_ci'
ENGINE=InnoDB;

CREATE TABLE `t_tree` (
`t_tree_c_parent` VARCHAR(50) NOT NULL,
`t_tree_c_child` VARCHAR(50) NOT NULL,
`t_tree_c_timestamp` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
)
COLLATE='utf8_general_ci'
ENGINE=InnoDB; 
```

在 HeidiSQL 中为孩子（在项目中，此查询在递归函数中）：

第一次在 db 中进行小更新后第一次为 2.137 秒，然后为 0.000 秒

我开始认为这是 Leandro Barreto 建议的 mysql 缓存。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T13:47:19.077

我会在这里给你一个疯狂的猜测：数据库缓存。

第一次执行页面时，查询不会缓存在数据库中，因此需要更长的时间，从而超过了 PHP 的时间限制。

在其他时候，查询要快得多。

如前所述，您可以拆分查询，也可以尝试增加脚本的时间限制：

```
set_time_limit(0); //No time limit
set_time_limit(60); //60 seconds 
```

可以肯定的是，您可以使用[它](https://stackoverflow.com/questions/5231678/clear-mysql-query-cache-without-restarting-server)来清理数据库缓存并始终使用它，因此您将始终在清理缓存上运行页面。

# javascript - Highcharts (Highstocks) - 可点击的旗帜图像

> ID：13627035
> 
> 赞同：1
> 
> 时间：2012-11-29T13:36:09.227
> 
> 标签：javascript, jquery, highcharts, jquery-events

将标志添加到图表并使用图像作为标志的形状时，结果不是我所期望的。似乎标志的可点击区域实际上并不是放置图像的位置 - 而且文本标题也偏离中心绘制。

![JSFiddle 截图](../Images/776c984584155c17f00c53dc9294d7e6.png)

例如，单击图像左侧不会记录单击。在此示例中，单击事件将简单地提醒标志的 ID。

下面是我要添加的标志的 JavaScript 对象：

```
{
    "type": "flags",
    "onSeries": "dataseries",
    "shadow": false,
    "width": 32,
    "shape": "url(http://www.highcharts.com/demo/gfx/sun.png)",
    "data": [{
        "x": 4,
        "title": "This is flag one",
        "text": "Click to edit",
        "id": "flag-01",
        "events": {
            "click": flagClick,
        },
    }],
} 
```

请问有人可以告诉我如何纠正这个问题吗？我已经开始了一些我想要在 JSFiddle 中实现的简单代码：

[http://jsfiddle.net/g105b/jR5kU/](http://jsfiddle.net/g105b/jR5kU/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T20:14:04.103

这是**一个已知问题，已在**4 天前修复。
您可以在以下链接中看到它的报告。
[https://github.com/highslide-software/highcharts.com/issues/1378#issuecomment-10885280](https://github.com/highslide-software/highcharts.com/issues/1378#issuecomment-10885280)

# java - 三元的未采用分支中出现意外的 NullPointerException？

> ID：13627038
> 
> 赞同：-1
> 
> 时间：2012-11-29T13:36:23.220
> 
> 标签：java

我有两个变量：

```
final Long a;
if(...) {
     a = ...;
} else
     a = null;
String b  = "A";
.... 
```

然后，分配给另一个`Long`是抛出一个`NullPointerException`：

```
final Long c = b.equals("B")? a*1000: a; 
```

我期待`c`是`null`if `a`is `null`，并且我期待`b`，我*知道*在这种情况下不会`B`阻止它被取消引用。

那么它为什么会抛出`NullPointerException`?

***更新***：谜团解开了，它在三元运算符中自动拆箱。见[https://stackoverflow.com/a/13627200/15721](https://stackoverflow.com/a/13627200/15721)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T13:38:33.923

因为 if `a`is `null`，因为它是 a`Long`它会评估为`null.longValue()`抛出 a`NullPointerException`

**编辑：**

我希望三元运算符的计算结果为 long，因为您正在进行乘法运算，然后即使它进入第二个分支，`a`也会被评估为 a `long`(unboxed)

**Edit2：** 您最终找到自己的答案的速度更快；）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T13:38:45.347

当你这样做时`a * 1000`，`a`被拆箱。

因此如果`a`是`null`，则`a * 1000`抛出一个`NullPointerException`！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-29T13:46:57.127

啊哈，通过找到有效的代码，我可以推断出正在发生的事情：

```
Long a = ....; 
Long b = ... a != null? a*1000: a; 
```

因为`a*1000`是`a`开箱，十元表情`long`不是`Long`。

```
Long a = ....; 
Long b = ... a != null? new Long(a*1000): a; 
```

保持最终结果`Long`并按预期工作。

# python - 在 Python 中替换同一边界内的多个模式

> ID：13627040
> 
> 赞同：-1
> 
> 时间：2012-11-29T13:36:37.000
> 
> 标签：python, regex

要搜索的文本：

```
{ Field1:Value Field2:Value Field1:Value } 
```

然后，我想在 Field 的每个实例等于某个值时查找并替换它，但前提是该字段位于 { & } 边界内。

**注意：**在 { 之后但在第一个字段之前可以有可变空格。以及不同数量的字段。

正则表达式：

```
({\s*)(?:Field1)(:(?:.*?)}) 
```

允许我将文本分成组，允许我重新创建具有不同字段名称的新文本。

例如：

```
\1Field3\2 
```

但是，这将仅匹配 Field1 的**第一个**实例并忽略第二个实例，因为正则表达式引擎从关闭 } 继续

我当时想用 Lookbehind 和 Lookahead，买 Python 不支持这些方法的变量重复，所以就放弃了。

“re.sub”方法返回文本，如果找到/替换了正则表达式，则更改，但实际上并没有说明是否完成了替换，所以我什至不能循环直到没有找到匹配项，除非我做一个第二个正则表达式来验证哪个感觉不对。

有什么办法可以在一个正则表达式中做到这一点？

**- - - 编辑 - - -**

尽管仍处于多个阶段，但我设法将 Emmanuel 和 Ωmega 的解决方案提炼成我正在寻找的解决方案，但是我认为在这种情况下，多个步骤是唯一的解决方案。

伊曼纽尔的代码（为我的解决方案工作）

```
s = '{ Field1:Value Field2:Value Field1:Value } Field1:Value {Field1:Value}'
for insider in re.findall(r'{\s*Field1:.*?}', s):
    new = re.sub(r'Field1:', r'NewField:', insider)
    s = s.replace(insider, new) 
```

Ωmega 的代码（适用于我的解决方案）

```
def evaluate(m):
  return re.sub('Field1:', 'NewField:', m.group(0))
input = '{ Field1:Value Field2:Value Field1:Value } Field1:Value {Field1:Value}'
output = re.sub('{[^{}]*?}', evaluate, input) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T13:47:45.520

Python 确实支持前瞻断言中的无限重复。因此，除非您有嵌套的`{`/`}`结构（这*将*无法用 Python 的正则表达式引擎处理），否则您可以简单地检查下一个大括号是否是右大括号：

```
>>> import re
>>> subject = "{Field1:Value Field2:Value} Field3:Value {Field4:Value}"
>>> re.sub(r"Field(\d+):(\w+)(?=[^{}]*\})", r"NewField\1:\2", subject)
'{NewField1:Value NewField2:Value} Field3:Value {NewField4:Value}' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T14:03:39.110

```
def evaluate(m):
  return re.sub(r'(\w+):(' + re.escape(value) + r'\b)', field + ":\\2", m.group(0))

output = re.sub(r'\{[^{}]*\}', evaluate, input) 
```

请参阅**[此演示](http://ideone.com/mDuR8f)**。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-29T14:05:08.457

蒂姆的回答真的很棒。矿井分两步进行：

*   获取大括号之间的所有内容
*   循环所有这些以进行有效替换

这给出了：

```
>>> s = '{ Field1:Value Field2:Value Field1:Value } Field4:Value {Field5:Value    }'
>>> for insider in re.findall(r'{((?:\s*Field\d+:Value\s*)*)}', s):
    new = re.sub(r'\s*Field(\d+):(\w+)\s*', r' NewField\1:\2', insider)
    s = s.replace(insider, new)

>>> s
'{ NewField1:Value NewField2:Value NewField1:Value} Field4:Value { NewField5:Value}' 
```

# python - 维护一个整洁的命名空间

> ID：13627041
> 
> 赞同：4
> 
> 时间：2012-11-29T13:36:37.813
> 
> 标签：python, namespaces

tl;dr：如何在 some 中创建一个新的命名空间`__init__.py`，并将另一个命名空间的选择位复制到其中，而不需要在新目录中使用子模块？

完整问题：

假设我在一个包中有一对模块，目录结构如下：

```
foo/mod_1.py
foo/mod_2.py
foo/__init__.py 
```

`mod_1.py`如下：

```
import numpy

__all__ = ['test1']

def test1():
    return numpy.zeros(10) 
```

`mod_2.py`如下：

```
import numpy

def test2():
    return numpy.zeros(20) 
```

如下`__init__.py`：

```
from mod_1 import *
import mod_2

del mod_1 
```

这或多或少产生了所需的命名空间：

```
In [7]: dir(foo)
Out[7]: 
['__builtins__',
 '__doc__',
 '__file__',
 '__name__',
 '__package__',
 '__path__',
 'mod_2',
 'test1'] 
```

*除了*现在`numpy`在`foo.mod_2`命名空间中。如果我尝试在`__init__.py`, with中删除它`del mod_2.numpy`，则该模块不再存在，因此`mod_2.test2`已损坏。

`mod_2`我可以通过创建一个包含的额外目录来实现我想要的`mod_2.py`，但如果可能的话，我想保持目录结构不变。

因此，我最初的问题。

编辑：我不介意做一些名字修饰来阻止一个名字踩在另一个名字上。假设将相关位`mod_2.py`放入`foo._mod_2`.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T13:46:12.143

你*不想*这样做，因为你发现你破坏了你的代码。

Python 是一种动态语言，自省让我们可以不受限制地访问解释器所能访问的几乎所有内容。这也适用于您的模块。

如果它让你感觉更好，同样的事情也适用于标准库：

```
>>> import unittest
>>> unittest.sys
<module 'sys' (built-in)>
>>> unittest.types
<module 'types' from '/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/types.pyc'>
>>> dir(unittest)
['FunctionTestCase', 'TestCase', 'TestLoader', 'TestProgram', 'TestResult', 'TestSuite', 'TextTestRunner', '_CmpToKey', '_TextTestResult', '_WritelnDecorator', '__all__', '__author__', '__builtins__', '__doc__', '__email__', '__file__', '__metaclass__', '__name__', '__package__', '__unittest', '__version__', '_makeLoader', '_strclass', 'defaultTestLoader', 'findTestCases', 'getTestCaseNames', 'main', 'makeSuite', 'os', 'sys', 'time', 'traceback', 'types'] 
```

*从外部可以看到模块在其全局命名空间中所需的*一切。***这是正常的**。*

 *正如您已经发现的那样，使用`__all__`来控制`from modulename import *`通配符导入，否则请单独保留模块名称空间。

当然，如果你想为你的包的用户提供一个干净的 API，没有什么能阻止你将作为 API 一部分的名称导入顶级包`__init__.py`，或者使用`api.py`模块。

导入只是意味着在当前模块中添加与变量相同的名称；`mod_2.numpy`是完全相同的东西`sys.modules['numpy']`，或者`numpy`在你运行后的当前模块中`import numpy`。*

# php - 在窗口关闭时提交表格？

> ID：13627044
> 
> 赞同：0
> 
> 时间：2012-11-29T13:36:41.040
> 
> 标签：php, javascript, jquery, forms

谁能告诉我如何在两页上提交表单，如果表单在第二页上关闭，这仍会自动提交第一页的信息？

例如

第 1 页：全名 电子邮件 电话号码

用户点击提交...

第 2 页：感谢提交您的详细信息，请选择回电时间..

然后，用户将关闭窗口或输入回调时间并按提交，但即使他们关闭第二页上的窗口并且不输入回调时间，我也需要提交原始信息。

我在想也许可以使用会话变量来存储信息，然后如果窗口关闭，可能使用 javascript/jquery 来提交表单？

谁能建议最好的办法是这样做？

我可能还应该提到我将数据插入到 MySQL 表中，然后使用 CURL 发布数据。因此，如果提交了回调时间，我可以很容易地插入数据库，然后只需在最后一个 id 上执行更新语句。

但是如果窗口在第二个表单页面上关闭，我不知道如何发布最后一条 MySQL 记录？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T13:43:04.937

```
$(window).bind('beforeunload', function() { 
    $("#form-submit").click();
}); 
```

其中#form-submit 是您的提交按钮的ID。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T13:52:24.403

每当用户出于任何原因离开您的页面时，都会触发该`beforeunload`事件。

例如，如果用户提交表单、单击链接、关闭窗口（或选项卡）或使用地址栏、搜索框或书签进入新页面，它将被触发。

您可以使用以下代码排除表单提交和超链接（其他框架除外）：

```
var inFormOrLink;
$('a').live('click', function() { inFormOrLink = true; });
$('form').bind('submit', function() { inFormOrLink = true; });

$(window).bind("beforeunload", function() { 
    return inFormOrLink || confirm("Do you really want to close?"); 
}) 
```

该`live`方法不适用于提交事件，因此如果您添加一个新表单，您还需要将处理程序绑定到它。

请注意，如果不同的事件处理程序取消提交或导航，如果稍后实际关闭窗口，您将丢失确认提示。你可以通过记录`submit`和`click`事件中的时间来解决这个问题，并检查是否在`beforeunload`几秒钟后发生。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-29T14:04:38.643

你真的不能。

```
$(window).bind('beforeunload', function() { 
    // Do submit here
}); 
```

可能看起来有效，但是

a) 在 beforeunload 阶段不允许进行常规表单提交（即使用 POST 或 GET 重定向到另一个页面），因此无法正常工作。

b) AJAX 表单提交*将*触发，但您永远无法确定它们是否会到达，因为浏览器不会等待回调发生，而是会在您的代码运行后简单地关闭窗口。

# css - CSS：使用三个 div 元素及其宽度和高度大小的百分比的问题

> ID：13627045
> 
> 赞同：1
> 
> 时间：2012-11-29T13:36:44.707
> 
> 标签：css, html, two-column-layout

我有一个名为的外部 div 元素和两个名为和的`container`内部 div 元素`firstDiv``secondDiv`

firstDiv 将浮动到左侧，而 secondDiv 将浮动到右侧。

我希望外部 div 元素尽可能多地占用宽度，这意味着 100% 的可用宽度。

我还希望两个内部元素占用一半空间，这意味着`container`div 的 50%。

这是一些基本代码：

```
<html>
    <head>

    <style type="text/css">
        #container{
            width:100%;
            height:100%;
            border-style:solid;
        }
    </style>
    </head>

    <body>
        <div id="container">
            <div id="firstDiv"> </div>
            <div id="secondDiv"> </div>
        </div>
    </body>
</html> 
```

**问题 1**

我期待一个简单的实体边框围绕 body 元素，看起来确实如此，但是我在浏览器的 y 维度上有一个滚动条。为什么会这样？我说我想要 100% 的 body 宽度和高度，看起来浏览器使用的不止这些。

现在我添加了以下 CSS 代码：

```
 #firstDiv{
        width:50%;
        height:100%;
        border-style:solid;
        } 
```

**问题 2** 似乎 div 占据了“容器”div 的 50%，但高度似乎超过了 100%。为什么会这样？图片： ![enter image description here](../Images/bb499852e2b2311d5d2b6f29aa62d6aa.png)

我对第二个 div 执行相同的操作，并通过使用以下 CSS 代码来包含 float 属性：

```
 #container{
        width:100%;
        height:100%;
        border-style:solid;
    }
    #firstDiv{
        width:50%;
        height:100%;
        border-style:solid;
        float:left;
        }
    #secondDiv{
        width:45%;
        height:100%;
        border-style:solid;
        float:right;
        } 
```

**问题 3** 我希望两个 div 元素组成一个两列页面。然而，第二个 div 元素再次比前一个元素占用更多的高度，而且发生的情况是当我调整浏览器大小时，第二个 div 位于第一个下方。

![enter image description here](../Images/4bdbd6cc530e8b669506734d68a7c6e6.png)

为什么会发生这种情况，我该如何避免？

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T13:42:18.193

All your questions are due to the box-model you misunderstood. height: 100% makes the content-height 100%. When you have a border AND height: 100% this leads to 100% + border-width, which obviously is more than 100%.

A possible solution is to use box-sizing: border-box;

The only browser not supporting this property are IE<8\. If these are relevant to you, you could create a workaround with CSS-expressions for them. Handle with care!

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-29T13:43:04.603

Borders are not counted when calculating the width of an element. They are supplements to the specified width. This explains your slight inconsistencies. There is no 100% airtight solution to this problem as far as I know that will do *exactly* what you want (close to it, yes, but exactly, no). The most reliable is to use a table, but that isn't a valid solution for designing a page layout as you already certainly know. Another option is to float right and left but have the width specified as either a slightly lower percentage than 50 (such as 48-48) or have a width specified in `px` which would allow you to calculate precisely the exact sizes that you need.

When browsers begin to uniformly implement CSS3, the `box-sizing` property will be able to solve this problem. `box-sizing` specifies what to take into account when calculating the size of an element. Applying `box-sizing:border-box;` will take the border into account, but for the moment this isn't widely enough implemented across browsers to use reliably in your code.

# c# - 我是否需要使用 PushSharp 等待每条消息的 Sent/Failure 事件

> ID：13627051
> 
> 赞同：1
> 
> 时间：2012-11-29T13:37:08.930
> 
> 标签：c#, push-notification, apple-push-notifications

我可以发送`APNS`通知，`PushSharp`但我需要能够向多个设备发送消息，我找不到更多信息`PushSharp`并且有一些问题：

1.  在发送下一条消息之前，我应该等待`OnNotificationSent`/`OnNotificationSendFailure`事件触发吗？

2.  如何唯一标识`OnNotificationSent`/中的消息`OnNotificationSendFailureevent`？

3.  如果我对多条消息进行排队，那么`OnNotificationSent`/会`OnNotificationSendFailureevent`为所有消息触发吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T09:22:55.620

1.  在发送下一条消息之前，您不应等待响应。无需等待即可全部发送。

2.  然后，您应该能够唯一标识该消息。Notification 对象有一个 Tag 属性。您可以设置它的值并在 OnNotificationSent/OnNotificationSendFailure 事件处理程序中获取它。

3.  是的。这些方法应该为所有消息触发

# objective-c - NSCombobox 绑定问题

> ID：13627056
> 
> 赞同：2
> 
> 时间：2012-11-29T13:37:26.780
> 
> 标签：objective-c, xcode, nsarraycontroller, nscombobox

我希望我可以从 NSCombobox“A”中选择风险区域，然后它的“费用”会自动出现在单元格“B”中。这是因为我必须将“表面”和“速率”相乘。

列“A”绑定：值绑定到：粒子控制器键：排列对象模型键路径：名称。

NSCombobox 绑定：内容绑定到：Area Rischio 控制器键：排列对象

内容值绑定到：arrangeObjects 模型键路径：nome ![在此处输入图像描述](../Images/0f26a19e092a7b745e97dea610671d40.png) ![在此处输入图像描述](../Images/782d73409bc38e0683a3b166381bda02.png) 通过此设置，组合框向我显示包含的风险区域，并且一旦选择了所需记录的风险区域。现在我想一旦您选择了风险区域出现在它旁边的字段中的费用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T09:12:16.523

我看到两个选项：

*   将 Tariffa 字段的列绑定到与 Area di Rischio 相同的属性。添加一个可以检索正确值的值转换器。
*   使用行上的代表对象并通过键路径导航到您想要的值。

在我看来，名称和关税都是关税的两种代表。所以 keypath 或 value 转换器应该可以得到你想要的。

# .net - 接收从 libwww-perl 到 IIS / ASP.NET 的帖子时出错

> ID：13627057
> 
> 赞同：0
> 
> 时间：2012-11-29T13:37:33.050
> 
> 标签：.net, perl, iis, libwww-perl

我正在尝试从 Web 服务接收到 IIS 7.5 上的 URL 的帖子。就好像请求在到达 .NET 之前就被拒绝了。我已经使用 ASP.NET MVC 操作或纯 .ASPX 文件进行了尝试。

这是通过的请求：

```
2012-11-29 01:52:40 W3SVC9 Server-Name xxx.xxx.xxx.xxx POST /posttest.aspx - 443 - xxx.xxx.xxx.xxx HTTP/1.1 libwww-perl/5.837 - - site.com 500 0 0 6357 1226 343 
```

现在 6357 是 sc-win32-status 代码。但它在此页面上不存在：

[IIS sc-win32-状态码](https://stackoverflow.com/questions/4223446/iis-sc-win32-status-codes)

从 libwww-perl 到 IIS 的请求是否存在问题？

是否缺少标头或 IIS 正在挑剔的东西？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T22:12:34.090

500 错误表示 Web 服务器在执行“程序”时出现问题。

我会寻找服务器错误日志。

# php - 如何在 CodeIgniter 中检查 set_status_header 是否设置为 404？

> ID：13627058
> 
> 赞同：1
> 
> 时间：2012-11-29T13:37:35.033
> 
> 标签：php, codeigniter

这就是我设置标题**$this->output->set_status_header('404'); 的方式** 在控制器中：

```
<?php
class custom404 extends CI_Controller
{
    public function __construct()
    {
            parent::__construct();
    }

    public function index()
    {
        $this->output->set_status_header('404');
        $this->view_data['page_title'] = 'Page not found';
        $this->view_data['main_content'] = 'error404';
        $this->load->view('template', $this->view_data);
    }
}
?> 
```

然后我需要以某种方式检查视图中的状态标题 404？

除了在 $this->view_data 中发送另一个变量之外还有什么建议吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T13:58:11.997

使用以下代码在 application/core 文件夹中创建一个名为 MY_Output.php 的文件：

```
<?php

if (!defined('BASEPATH'))
    exit('No direct script access allowed');

class MY_Output extends CI_Output {

    function set_status_header($code = 200, $text = '')
    {
        set_status_header($code, $text);
        $this->last_set_status_code = $code;
        return $this;
    }

    function get_status_header()
    {
        return $this->last_set_status_code;
    }

}

?> 
```

您现在可以回显您设置的最后一个状态代码，如下所示：

```
$this->output->set_status_header('404');
echo $this->output->last_set_status_code; // outputs '404'
// or get it like so:
echo $this->output->get_status_header(); // outputs '404' 
```

# iphone - UINavigationItem 离开 UIBarButtonItem 作为自定义按钮

> ID：13627062
> 
> 赞同：0
> 
> 时间：2012-11-29T13:37:37.920
> 
> 标签：iphone, ios, uinavigationitem

> **可能重复：**
> [自定义 UINavigationBar 的后退按钮？](https://stackoverflow.com/questions/6003082/custom-uinavigationbars-backbutton)

我想将自定义按钮添加为左侧 UIBarButtonItem。我使用了以下代码

```
UIBarButtonItem *menuButton = [[UIBarButtonItem alloc] initWithImage:[UIImage imageNamed:@"menu.png"] style:UIBarButtonItemStylePlain target:self action:@selector(showMenu:)];
self.navigationBar.leftBarButtonItem = menuButton; 
```

这不显示按钮，但我可以单击并正确调用选择器。

我也尝试了以下方式：

```
UIButton *menuButton = [UIButton buttonWithType:UIButtonTypeCustom];
[menuButton setImage:[UIImage imageNamed:@"menu.png"] forState:UIControlStateNormal];
[menuButton addTarget:self action:@selector(showMenu:) forControlEvents:UIControlEventTouchUpInside];
UIBarButtonItem *barMenuItem = [[UIBarButtonItem alloc] initWithCustomView:menuButton];
self.navigationItem.leftBarButtonItem = barMenuItem; 
```

这显示了按钮 & 也可点击，但按钮宽度等于默认的后退按钮宽度。我的按钮图像宽度小于默认的后退按钮图像。因此，它将图像居中在具有拉长宽度的按钮中。

任何帮助表示赞赏。

萨亚利

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T13:49:48.787

简单的方法就是您创建一个新视图并添加按钮，然后将此视图添加到左按钮上，如果有任何问题评论我，这对我来说可以正常工作并且很好

# google-maps-api-3 - google api v3 密钥在本地（开发）中有效，但在生产中无效

> ID：13627063
> 
> 赞同：1
> 
> 时间：2012-11-29T13:37:46.023
> 
> 标签：google-maps-api-3, api-key

我正在尝试在我的网站中使用 Google Places Autocomplete API，但是当我提交 url（在这种情况下，通过 php 上的 cURL）时，页面没有返回任何结果（完全空白页面）。但是只有当我从我的虚拟主机调用页面时才会发生这种情况；本地主机开发应用程序工作正常。如果我将下面的 url 粘贴到浏览器中，它也可以正常工作。我的 php 测试页面是这样的：

```
    函数 curl_file($url, $timeout=0){
        $ch = curl_init();
        curl_setopt($ch, CURLOPT_URL, $url);
        //curl_setopt ($ch, CURLOPT_HEADER, 1);
        curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
        curl_setopt($ch, CURLOPT_CONNECTTIMEOUT, $timeout);
        $str = curl_exec($ch);
        curl_close($ch);
        返回 $str;
    }

    $content = curl_file("https://maps.googleapis.com/maps/api/place/autocomplete/json?input=flamboyant&location=-16.698053,-49.268947&radius=20000&sensor=false&key=AIzaSyBzdiVqEIh2CXBm3gNUsvWdIl1Z-NvW298");
    回声$内容；

```

变量**内容**应回显与浏览器中相同的 JSON 响应，但页面显示完全空白。有人可以帮我解决这个问题吗？

ps：我的 google api 密钥设置为“允许任何推荐人”。我尝试将 Rerefers URL site *.imoveisgo.com/* 放在上面，但也不起作用。

谢谢大家！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T17:36:08.853

我认为这是 cURL 的 SSL 问题。请尝试以下代码：

```
function curl_file($url, $timeout=0){
  $ch = curl_init();
  curl_setopt( $ch, CURLOPT_URL, $url );
  //curl_setopt ($ch, CURLOPT_HEADER, 1);
  curl_setopt( $ch, CURLOPT_SSL_VERIFYPEER, FALSE);
  curl_setopt( $ch, CURLOPT_RETURNTRANSFER, 1 );
  curl_setopt( $ch, CURLOPT_CONNECTTIMEOUT, $timeout );
  $str = curl_exec( $ch );
  if(curl_errno($ch)) {
    echo "Err#".curl_error($ch);
    echo curl_error($ch);
  }
  curl_close( $ch );
  return $str;
} 

$content = curl_file("https://maps.googleapis.com/maps/api/place/autocomplete/json?input=flamboyant&location=-16.698053,-49.268947&radius=20000&sensor=false&key=AIzaSyBzdiVqEIh2CXBm3gNUsvWdIl1Z-NvW298");
echo $content; 
```

# ios - UIWebView 将用户发送回登录

> ID：13627068
> 
> 赞同：0
> 
> 时间：2012-11-29T13:38:16.157
> 
> 标签：ios, ios5, uiwebview

我有一个 iPhone 应用程序，它是网站的简单包装器。它在 iOS5 之前运行良好，但之后出现任何问题。它可以很好地加载网站，从一个简单的登录页面开始。登录后，用户可以正常浏览页面。但是，问题在于，当用户尝试通过站点（简单的 Web 表单）发送消息时，它会将它们发送回登录页面。当通过桌面浏览器，甚至通过 iPhone 上的 Safari 访问该站点时，它工作得很好并且没有这个问题。

这是代码：

```
[webView loadRequest:[NSURLRequest 
    requestWithURL:[NSURL URLWithString: @"https://xxxxxx"]]];
webView.scalesPageToFit = YES;
webView.opaque = NO;
webView.backgroundColor = [UIColor clearColor];
for (int x = 0 ; x < 10 ; ++x ){ 
    [[[[[webView subviews] objectAtIndex:0] subviews] objectAtIndex:x]setHidden:YES];
} 
```

就像我说的，这很简单。它的行为与 Safari 移动浏览器不同。我怀疑它可能与cookie有关，所以我尝试设置NSHTTPCookieAcceptPolicyAlways，但这没有任何效果。

有任何想法吗？

谢谢！

# eclipse - 如何设置 ZendStudio 不删除尾随空格？

> ID：13627070
> 
> 赞同：2
> 
> 时间：2012-11-29T13:38:20.910
> 
> 标签：eclipse, ubuntu, zend-studio

我刚刚安装了 ZendStudio 9.0.4 Trial 的最新 Linux 版本来测试它。现在，当我保存文件时，它会删除该文件中“损坏”SVN 的所有尾随空格。

我知道该选项`Preferences->PHP->Editor->Save Action->Remove trailing whitespace`，并且在首选项或项目特定首选项内都没有检查它。当它被检查时，它没有任何区别。

**我的问题是**有某种快速修复，也许我应该在设置文件的某个地方写一些东西，或者这只是一个错误，我必须等到它修复？

**编辑：**它发生在所有内置编辑器中

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T10:21:06.633

在花了很多时间在首选项中搜索后，我终于找到了复选框 udner

```
Window->Preferences->General->Editors->AnyEdit Tools 
```

在“自动转换”选项卡内有一个“删除拖尾空格”复选框

# ruby-on-rails - Rails 请求参数中出现的附加属性

> ID：13627075
> 
> 赞同：2
> 
> 时间：2012-11-29T13:38:30.163
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, httprequest

我一直在我的 rails 应用程序中看到一些功能，其中我传递给 rails 的参数被封装在控制器中的请求和参数之间的某个位置。

以前没关系，但我最近遇到了一个问题，因此决定尝试找出它发生的原因。我没有运气，希望这里有人能指出我正确的方向。

我的客户端请求有效负载如下所示：

```
{
    "id"=>"1",
    "email" => "peter.hamilton10@imperial.ac.uk",
    "first_name" => "Peter",
    "last_name" => "Hamilton",
    "year" => 3,
    "private_attr" => "something"
} 
```

在rails中，日志显示了这一点

```
Started PUT "/students/1" for 127.0.0.1 at 2012-11-29 13:20:56 +0000
Processing by StudentsController#update as JSON
  Parameters: {"id"=>"1",
               "email" => "peter.hamilton10@imperial.ac.uk",
               "first_name" => "Peter",
               "last_name" => "Hamilton",
               "year" => 3,
               "private_attr" => "something",
               "student" => {
                   "email"=>"peter.hamilton10@imperial.ac.uk",
                   "first_name"=>"Peter",
                   "last_name" => "Hamilton",
                   "year"=>3
               }
              } 
```

**`student`这个属性来自哪里，它的字段是如何生成的？**

我知道无法批量分配的属性不会出现（如上图所示`private_attr`），所以我假设它为当前控制器的模型提取字段，否则我有点不知所措......

**更新：型号**

```
# Schema
# create_table "students" do |t|
#   t.string   "email"
#   t.string   "first_name"
#   t.string   "last_name"
#   t.integer   "year"
#   t.integer   "private_attr"
# end
class Student < ActiveRecord::Base
  attr_accessible :email, :first_name, :last_name, :year
end 
```

（注意：我不希望 private_attr 通过，我只是将其作为测试并认为它可能有用）

该请求实际上并非来自表单，而是来自手动生成的 ajax 请求。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-03T16:20:18.927

看看包装参数：

[http://edgeapi.rubyonrails.org/classes/ActionController/ParamsWrapper.html](http://edgeapi.rubyonrails.org/classes/ActionController/ParamsWrapper.html)

我不知道您是否使用 Rails 4，但这是幕后发生的最新版本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-16T13:11:06.120

在控制器中添加以下代码：

**wrap_parameters :model，包括：Model.column_names + [:attr]**

模型 - 你的模型， :attr - 附加属性

# android - 如何从android中的可扩展拖放列表视图中删除项目

> ID：13627085
> 
> 赞同：1
> 
> 时间：2012-11-29T13:39:01.973
> 
> 标签：android, drag-and-drop, expandablelistview

我在我的 android 应用程序中使用了可扩展的拖放列表视图。我希望​​从列表中拖动特定项目并将项目放在删除框中（意味着从可扩展列表视图中删除该项目）。我搜索了很多链接，但我没有任何有用的链接。请建议我链接和源代码。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T14:12:07.677

您需要更改以更改填充列表的元素（以删除要删除的项目），然后在适配器上调用 notifyDataSetChanged() 方法。

这是我看到的一个很好的 SO 问题：[ListView adapter data change without ListView was notice](https://stackoverflow.com/questions/4636679/listview-adapter-data-change-without-listview-being-notified)

# c++ - c++软件传参方法

> ID：13627091
> 
> 赞同：0
> 
> 时间：2012-11-29T13:39:26.407
> 
> 标签：c++, api, node.js, command-line-arguments

我有一个与将参数传递给 C++ 编译的可执行文件有关的问题。该程序模拟特定推理引擎的行为：引擎的设置是在运行时从 XML 文件加载的，然后我想用不同的输入值从命令行调用它。输入的特点是：

*   每次调用程序，输入结构都不一样，因为系统本身不一样。
*   输入是一组对 { *name, value* }，一个用于系统的每个部分。
*   我必须将配置 XML 与输入分开。
*   我从 PHP 或 Node.js 服务器调用程序，因为它返回我通过 API 向外部公开的结果。
*   输入值是从 HTTP 发布请求中获得的。

到目前为止，我已经尝试了这些解决方案：

1.  从命令行传递它，例如：“ *./mysoftware input1 value1 input2 value2 ...etc* ”。有点不舒服，因为我有多达 200 个输入。
2.  创建一个包含所有情侣*名称、值*的文件，然后调用解析文件的程序，然后在最后销毁。这是我的 API 的性能瓶颈，因为在每次调用时我都必须创建和销毁文件。

有谁知道解决这个问题的更好方法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-29T13:45:06.300

3\. 通过标准输入流将值传递给程序并从`std::cin`C++ 程序内部读取它们。

# c# - 绑定列表 到中继器

> ID：13627097
> 
> 赞同：0
> 
> 时间：2012-11-29T13:39:54.297
> 
> 标签：c#, asp.net, repeater

我有一组生成的扩展自定义控件`CompositeControl`，定义为：

```
[PersistChildren(true)]
[ToolboxData("<{0}:ContractControl runat=server></{0}:ContractControl>")]
public class ContractControl : CompositeControl
{
    private int contractID = 0;
    private ContractTileControl tileControl = null;
    private ContractDetailControl detailControl = null;

    private HtmlGenericControl contractMainDiv = null;

    public int ContractID
    {
        get { return this.contractID; }
        set { this.contractID = value; }
    }

    public ContractTileControl TileControl
    {
        get { return this.tileControl; }
        set { this.tileControl = value; }
    }

    public ContractDetailControl DetailControl
    {
        get { return this.detailControl; }
        set { this.detailControl = value; }
    }

    public ContractControl()
    {
        this.contractMainDiv = new HtmlGenericControl("div");
        this.contractMainDiv.ID = "contractMainDiv";
        this.contractMainDiv.Attributes.Add("class", "contractMain");
    }

    #region protected override void OnPreRender(EventArgs e)
    protected override void OnPreRender(EventArgs e)
    {
        base.OnPreRender(e);
        //CreateChildControls();
    }
    #endregion

    #region protected override void CreateChildControls()
    protected override void CreateChildControls()
    {
        base.CreateChildControls();
        if (tileControl != null)
        {
            this.contractMainDiv.Controls.Add(tileControl);
        }

        if (detailControl != null)
        {
            this.contractMainDiv.Controls.Add(detailControl);
        }
        this.Controls.Add(contractMainDiv);
        //base.CreateChildControls();
    }

    #endregion

    protected override void OnLoad(EventArgs e)
    {
        base.OnLoad(e);
        CreateChildControls();
    }

    protected override void OnInit(EventArgs e)
    {
        base.OnLoad(e);
        EnsureChildControls();
    }
} 
```

在哪里`ContractTileControl`以及`ContractDetailControl`是从`CompositeControl`.

当我将它们添加到`asp:PlaceHolder`控件集时，它们呈现得很好，但是当我定义一个中继器时，例如：

```
<asp:Repeater ID="myRepeater" runat="server" >
    <HeaderTemplate>
        <table border="0" cellpadding="0" cellspacing="0">
    </HeaderTemplate>

    <ItemTemplate>
        <tr><td><easit:ContractControl ID="contractControl" runat="server" />
        </td></tr>
    </ItemTemplate>
    <FooterTemplate>
        </table>
    </FooterTemplate>
</asp:Repeater> 
```

并将它们绑定到它：

```
private void FillContractPlaceHolder()
    {

        List<ContractControl> controls = new List<ContractControl>();
        foreach(KeyValuePair<Customer, List<TFSContract>> pair in contractList)
        {
            Label customerNameLbl = new Label();
            customerNameLbl.ID = "customerNameLbl";
            customerNameLbl.CssClass = "customerName";
            customerNameLbl.Text = pair.Key.Name;
            contractListPlaceHolder.Controls.Add(customerNameLbl);

            foreach (TFSContract contract in pair.Value)
            {
                ContractStatusBarControl status = new ContractStatusBarControl();
                status.WidthPercent = GetFillPercent(contract.NumberOfTasks, contract.NumberOfFinishedTasks);

                string[] contractNameParts = Regex.Split(contract.Contract.Name, @"[A-Z]{3}-[0-9|A-Z]{2}-[0-9|A-Z]{2}", RegexOptions.IgnoreCase);

                ContractDetailControl detail = new ContractDetailControl();
                detail.ContractName = contractNameParts.Last();
                detail.DateStarted = contract.StartDate;
                detail.DateFinished = contract.FinishDate;
                detail.StatusBar = status;

                ContractTileControl tile = new ContractTileControl();
                Match match = Regex.Match(contract.Contract.Name, @"[A-Z]{3}-[0-9|A-Z]{2}-[0-9|A-Z]{2}", RegexOptions.IgnoreCase);
                if (match.Value.Length != 0)
                {
                    tile.ContractNumber = match.Value;
                }

                tile.ContractTasksFinished = contract.NumberOfFinishedTasks;
                tile.ContractTasksTotal = contract.NumberOfTasks;

                ContractControl contractControl = new ContractControl();
                contractControl.ContractID = contract.Contract.Id;
                contractControl.TileControl = tile;
                contractControl.DetailControl = detail;
                //contractListPlaceHolder.Controls.Add(contractControl);
                controls.Add(contractControl);
            }

        }

        myRepeater.DataSource = controls;
        myRepeater.DataBind();

    } 
```

该表被创建，但只有非复合部分`contractMainDiv`被`ContractControl`渲染，因为中继器坚持认为`tileControl`和`detailControl`都是空的，即使它们被正确设置为各自类型的实例。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T15:11:06.727

当是数据绑定时，它为数据源中的每个项目`Repeater`创建一个实例，将其设置为数据源中的项目，并数据绑定子项。`ItemTemplate``DataItem`

在这种情况下，数据源中的项目是 your 的一个实例`ContractControl`，并且 your`ItemTemplate`没有数据绑定，因此`ContractControl`对于添加到列表中的每个项目，最终都会得到一个空白实例。

快速而肮脏的解决方案是为`ItemDataBound`您的事件添加一个处理程序`Repeater`，并将属性复制到真实控件：

```
protected void myRepeater_ItemDataBound(object sender, RepeaterItemEventArgs e)
{
   switch (e.Item.ItemType)
   {
      case ListItemType.Item:
      case ListItemType.AlternatingItem:
      case ListItemType.SelectedItem:
      case ListItemType.EditItem:
      {
         var source = (ContractControl)e.Item.DataItem;
         var destination = (ContractControl)e.Item.FindControl("contractControl");
         destination.ContractID = source.ContractID;
         destination.TileControl = source.TileControl;
         destination.DetailControl = source.DetailControl;
         break;
      }
   }
} 
```

更好的解决方案是将您绑定`Repeater`到`TFSContract`对象列表，然后移动代码以将其构建`ContractControl`到`ItemDataBound`事件处理程序中。

**编辑**
更新为仅处理真实项目，忽略页眉、页脚等。

# java - 何时在小程序中使用 AccessController.doPrivileged()？

> ID：13627098
> 
> 赞同：0
> 
> 时间：2012-11-29T13:39:54.410
> 
> 标签：java, applet, access-control

`AccessController.doPrivileged()` 确实，只有当我的小程序与 JavaScript 通信时，我才需要在（签名的）小程序中使用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T22:11:28.387

不会。如果不受信任的小程序访问此小程序并调用其方法，则可能会发生同样的情况。

此外，您永远无法完全确定小程序将如何被其他人部署或使用（即使它是由您编写并嵌入到您的站点中）。

# python - 使用 numpy/scipy 从 3D 数组计算等值面

> ID：13627104
> 
> 赞同：4
> 
> 时间：2012-11-29T13:40:01.943
> 
> 标签：python, numpy, scipy

我有一个 3D numpy 数组，其中包含给定函数的值。我想计算一个 2D 等值面，或一组表示该函数的某些值的等值面。

在这种特殊情况下，`column = myarray[i, j, :]`可以独立处理 3D 数组的每个 1D 列 ( )。所以我想知道的是函数等于某个值的最后一个索引位置（二维数组），比如说`myvalue`。

一些（慢）代码来举例说明：

```
# myarray = 3D ndarray
import numpy as np
from scipy import interpolate

result = np.zeros(nx, ny)
z_values = np.arange(nz)

for i in range(nx):
    for j in range(ny):
        f = interpolate.interp1d(my_array[i, j], z_values)
        result[i, j] = f(myvalue) 
```

我知道这可以通过其他技巧加快速度`np.ndenumerate`，但想知道是否已经有一种更简单的方法来做这种等值面。`ndimage`我在图书馆或其他图书馆找不到任何东西。我知道 mayavi2 和 vtk 有很多工具可以处理等值面，但我的目标不是可视化——我想对这些等值面值进行计算，而不是显示它们。另外，vtk 的很多等值面方法似乎都涉及多边形等，而我需要的只是每个等值面值的二维位置数组。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-05-10T22:13:33.060

仅使用,和正确的数组操作`numpy`可以获得一个很好的解决方案。下面的函数使用加权平均来计算等值面：`argsort``sort``take`

```
def calc_iso_surface(my_array, my_value, zs, interp_order=6, power_parameter=0.5):
    if interp_order < 1: interp_order = 1
    from numpy import argsort, take, clip, zeros
    dist = (my_array - my_value)**2
    arg = argsort(dist,axis=2)
    dist.sort(axis=2)
    w_total = 0.
    z = zeros(my_array.shape[:2], dtype=float)
    for i in xrange(int(interp_order)):
        zi = take(zs, arg[:,:,i])
        valuei = dist[:,:,i]
        wi = 1/valuei
        clip(wi, 0, 1.e6, out=wi) # avoiding overflows
        w_total += wi**power_parameter
        z += zi*wi**power_parameter
    z /= w_total
    return z 
```

此解决方案不处理有多个`z`对应于 的情况`my_value`。以下代码中给出了构建等值面的应用示例：

![在此处输入图像描述](../Images/242d27d8f7f3998333da51e7c80a3cca.png)

```
from numpy import meshgrid, sin, cos, pi, linspace
from mpl_toolkits.mplot3d import Axes3D
import matplotlib.pyplot as plt
dx = 100; dy =  50; dz = 25
nx = 200; ny = 100; nz = 100
xs = linspace(0,dx,nx)
ys = linspace(0,dy,ny)
zs = linspace(0,dz,nz)
X,Y,Z = meshgrid( xs, ys, zs, dtype=float)
my_array = sin(0.3*pi+0.4*pi*X/dx)*sin(0.3*pi+0.4*pi*Y/dy)*(Z/dz)

fig = plt.figure()
ax = fig.gca(projection='3d')

z = calc_iso_surface( my_array, my_value=0.1, zs=zs, interp_order=6 )
ax.plot_surface(X[:,:,0], Y[:,:,0], z, cstride=4, rstride=4, color='g')

z = calc_iso_surface( my_array, my_value=0.2, zs=zs, interp_order=6 )
ax.plot_surface(X[:,:,0], Y[:,:,0], z, cstride=4, rstride=4, color='y')

z = calc_iso_surface( my_array, my_value=0.3, zs=zs, interp_order=6 )
ax.plot_surface(X[:,:,0], Y[:,:,0], z, cstride=4, rstride=4, color='b')

plt.ion()
plt.show() 
```

您还可以使用不同的插值函数。请参阅下面的一个示例，该示例取两个最接近的平均值`zs`：

```
def calc_iso_surface_2(my_array, my_value, zs):
    '''Takes the average of the two closest zs
    '''
    from numpy import argsort, take
    dist = (my_array - my_value)**2
    arg = argsort(dist,axis=2)
    z0 = take(zs, arg[:,:,0])
    z1 = take(zs, arg[:,:,1])
    z = (z0+z1)/2
    return z 
```

# jpa - JPQL IN 子句与其他参数，使用序数参数

> ID：13627108
> 
> 赞同：1
> 
> 时间：2012-11-29T13:40:36.937
> 
> 标签：jpa, parameters, jpql, ordinal

我在使用序数参数和 IN 子句的命名查询方面遇到问题。

这是我的命名查询：

```
@NamedQuery(name = "Photo.getByIds", query = "FROM Photo i WHERE i.User.idUser = ?1 AND i.idPhoto IN ?2") 
```

这是获取照片列表的代码：

```
TypedQuery<Photo> q = entityManager.createNamedQuery("Photo.getByIds", Photo.class);

q.setParameter(1, 50);
q.setParameter(2, Arrays.asList(50, 51));

List<Photo> photoList = q.getResultList(); 
```

这就是我不断收到的错误：

```
org.hibernate.QueryException: Named parameter does not appear in Query: 1 [FROM entity.Photo i WHERE i.User.idUser = ?1 AND i.idPhoto IN (:x20_, :x21_)] <java.lang.IllegalArgumentException: org.hibernate.QueryException: Named parameter does not appear in Query: 1 [FROM entity.Photo i WHERE i.User.idUser = ?1 AND i.idPhoto IN (:x20_, :x21_)]>java.lang.IllegalArgumentException: org.hibernate.QueryException: Named parameter does not appear in Query: 1 [FROM br.gov.sus.cadsus.entity.CadsusImagemFoto i WHERE i.cadsusFotografia.coSeqFotografia = ?1 AND i.coSeqImagem IN (:x20_, :x21_)]
at org.hibernate.ejb.AbstractEntityManagerImpl.convert(AbstractEntityManagerImpl.java:1376)
at org.hibernate.ejb.AbstractEntityManagerImpl.convert(AbstractEntityManagerImpl.java:1317)
at org.hibernate.ejb.QueryImpl.getResultList(QueryImpl.java:255)

Caused by: org.hibernate.QueryException: Named parameter does not appear in Query: 1 [FROM entity.Photo i WHERE i.User.idUser = ?1 AND i.idPhoto IN (:x20_, :x21_)]
at org.hibernate.hql.classic.QueryTranslatorImpl.getNamedParameterLocs(QueryTranslatorImpl.java:551)
at org.hibernate.loader.Loader.bindNamedParameters(Loader.java:1910)
at org.hibernate.loader.Loader.bindParameterValues(Loader.java:1845)
at org.hibernate.loader.Loader.prepareQueryStatement(Loader.java:1716)
at org.hibernate.loader.Loader.doQuery(Loader.java:801)
at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:274)
at org.hibernate.loader.Loader.doList(Loader.java:2542)
at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2276)
at org.hibernate.loader.Loader.list(Loader.java:2271)
at org.hibernate.hql.classic.QueryTranslatorImpl.list(QueryTranslatorImpl.java:940)
at org.hibernate.engine.query.HQLQueryPlan.performList(HQLQueryPlan.java:196)
at org.hibernate.impl.SessionImpl.list(SessionImpl.java:1268)
at org.hibernate.impl.QueryImpl.list(QueryImpl.java:102)
at org.hibernate.ejb.QueryImpl.getResultList(QueryImpl.java:246)
... 25 more 
```

怎么了？我检查了这些方法/函数/jpql 的语法，一切似乎都正常。我也尝试过使用命名参数，它奏效了。但这不是我的解决方案。我需要使用序数参数。

有人有线索吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-11-29T18:51:00.687

缺少选择。查询应该是

```
@NamedQuery(name = "Photo.getByIds", query = "SELECT i FROM Photo i WHERE i.User.idUser = ?1 AND i.idPhoto IN ?2") 
```

# javascript - 使用 HTML5 的画布绘制带有外部笔划的文本

> ID：13627111
> 
> 赞同：25
> 
> 时间：2012-11-29T13:40:40.447
> 
> 标签：javascript, html, canvas, html5-canvas

我目前正在使用 HTML5 的画布使用 fillText 方法呈现多个字符串。这很好用，但我也想给每个字符串一个 1px 黑色外笔划。不幸的是，strokeText 函数似乎应用了内部笔划。为了解决这个问题，我编写了一个 drawStrokedText 函数来实现我想要的效果。不幸的是，它太慢了（原因很明显）。

有没有一种快速、跨浏览器的方式来使用原生画布功能实现 1px 的外部笔划？

```
drawStrokedText = function(context, text, x, y)
{
    context.fillStyle = "rgb(0,0,0)";
    context.fillText(text, x-1, y-1);
    context.fillText(text, x+1, y-1);
    context.fillText(text, x-1, y);
    context.fillText(text, x+1, y);
    context.fillText(text, x-1, y+1);
    context.fillText(text, x+1, y+1);

    context.fillStyle = "rgb(255,255,255)";
    context.fillText(text, x, y);
}; 
```

下面是一个工作效果的例子：

![在此处输入图像描述](../Images/a6f2ee7b922fd73ea314a7571543a5ce.png)

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2012-11-29T23:43:45.143

中风是怎么回事？由于一半的笔画将在形状之外，因此您始终可以先绘制笔画，线宽为您想要的两倍。所以如果你想要一个 4px 的外部笔划，你可以这样做：

```
function drawStroked(text, x, y) {
    ctx.font = '80px Sans-serif';
    ctx.strokeStyle = 'black';
    ctx.lineWidth = 8;
    ctx.strokeText(text, x, y);
    ctx.fillStyle = 'white';
    ctx.fillText(text, x, y);
}

drawStroked("37°", 50, 150); 
```

这使得：

![在此处输入图像描述](../Images/19f418408e8fb87cb3248260205376f7.png)

现场小提琴：http: [//jsfiddle.net/vNWn6/](http://jsfiddle.net/vNWn6/)

* * *

如果碰巧在较小的文本渲染比例下看起来不那么准确，您总是可以将其画大但按比例缩小（在上述情况下，您会这样做`ctx.scale(0.25, 0.25)`）

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2014-03-07T20:16:09.933

西蒙的回答是一个很好的解决方案，但在某些情况下可能会出现斜接故障，尤其是大写字母“M”、“V”和“W”：

```
drawStroked("MVW", 50, 150); 
```

[http://jsfiddle.net/hwG42/1/](http://jsfiddle.net/hwG42/1/)

在这种情况下，最好使用：

```
ctx.miterLimit=2; 
```

[http://jsfiddle.net/hwG42/3/](http://jsfiddle.net/hwG42/3/)

祝你好运！

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2017-07-04T12:39:29.387

对于平滑的阴影，你可以试试这个

```
ctx.beginPath();
ctx.fillStyle = 'white';
ctx.font = "bold 9pt Tahoma";
ctx.shadowBlur = 3;
ctx.textAlign = "center";
ctx.shadowColor = "#000000";
ctx.shadowOffs = 0;                 
ctx.fillText('www.ifnotpics.com', 100, 50);        
ctx.closePath(); 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2019-04-22T06:30:40.190

上面的答案很棒，使用其中一些解决方案*和我自己的一些想法，我在下面的小提琴中做了一个快速参考和一些创造性的替代方案。

**在小提琴代码中到期的所有学分*

```
drawStrokedText   ( text, x, y );
drawShadowedText  ( text, x, y, shadowBlur);
drawGlowingText   ( text, x, y, glowColorHex, glowDistance);
drawBlurredText   ( text, x, y, blurAmount);
drawReflectedText ( text, x, y, reflectionScale, reflectionOpacity); 
```

[https://jsfiddle.net/vtmnea8/](https://jsfiddle.net/vtmnyea8/)

```
// Author: Aaron Edmistone
// Text effects using HTML5 Canvas with 2D Context.
// https://stackoverflow.com/questions/7814398/a-glow-effect-on-html5-canvas

var canvas = document.getElementById('myCanvas');
var ctx = canvas.getContext('2d');

// prepare the presentation of the canvas
ctx.fillStyle = 'black';
ctx.fillRect(0,0,250,450);
ctx.fillStyle = 'gray';
ctx.fillRect(250,0,250,450);
ctx.fillStyle = 'white';
ctx.fillRect(500,0,250,450);
ctx.fillStyle = '#0066CC';
ctx.fillRect(750,0,250,450);

// prepare the font and fill
ctx.font = "80px Sans-serif";
ctx.fillStyle = "white";

function drawStrokedText(text, x, y)
{
        // using the solutions from @Simon Sarris and @Jackalope from
    // https://stackoverflow.com/questions/7814398/a-glow-effect-on-html5-canvas
        ctx.save();
    ctx.strokeStyle = 'black';
    ctx.lineWidth = 8;
    ctx.lineJoin="round";
      ctx.miterLimit=2;
    ctx.strokeText(text, x, y);
    ctx.fillText(text, x, y);
    ctx.restore();
}

function drawShadowedText(text, x, y, shadowBlur = 3)
{
        ctx.save();
    ctx.shadowBlur = shadowBlur;
    ctx.shadowColor = "#000000";
    ctx.shadowOffsetX = 4;
    ctx.shadowOffsetY = 4;
    ctx.fillText(text, x, y);
    ctx.restore();
}

function drawGlowingText(text, x, y, glowColorHexString, glowDistance = 10)
{
        ctx.save();
    ctx.shadowBlur = glowDistance;
    ctx.shadowColor = glowColorHexString;
    ctx.strokeText(text, x, y);

    for(let i = 0; i < 3; i++)
        ctx.fillText(text, x, y); //seems to be washed out without 3 fills

    ctx.restore();
}

function drawBlurredText(text, x, y, blur = 5)
{
    //using technique from https://www.html5rocks.com/en/tutorials/canvas/texteffects/
    ctx.save();
  let width = ctx.measureText(text).width + blur * 2;
  ctx.shadowColor = ctx.fillStyle;
  ctx.shadowOffsetX = width + x + ctx.canvas.width;
  ctx.shadowOffsetY = 0;
  ctx.shadowBlur = blur;
  ctx.fillText(text, -width + -ctx.canvas.width, y);
  ctx.restore();
}

function drawReflectedText(text, x, y, reflectionScale = 0.2, reflectionAlpha = 0.10)
{
    ctx.save();
  ctx.fillText(text, x, y);
    ctx.scale(1, -reflectionScale);
  ctx.globalAlpha = reflectionAlpha;
  ctx.shadowColor = ctx.fillStyle;
  ctx.shadowBlur = 15;
    ctx.fillText(text, x, -(y * (1 / reflectionScale)));
  ctx.restore();
}

for(let i = 0; i < 4; i++)
{
    drawStrokedText     ("MVW", 20 + i * 250, 80 * 1);
    drawShadowedText    ("MVW", 20 + i * 250, 80 * 2, 3);
  drawGlowingText       ("MVW", 20 + i * 250, 80 * 3, "#FF0000", 10);
  drawBlurredText       ("MVW", 20 + i * 250, 80 * 4, 5);
  drawReflectedText ("MVW", 20 + i * 250, 80 * 5, 0.5, 0.5);
}
```

```
<canvas id="myCanvas" width="1000" height="500"></canvas>
```

## 小提琴的输出：

[![下面小提琴的输出](../Images/ab649a7be43d1f9b302fd789fd155cf6.png)](https://i.stack.imgur.com/2ads0.png)

## 它支持什么：

*   大纲文本
*   阴影文字
*   发光的文字
*   文字模糊
*   反射文本

## 一些性能指标：

考虑在游戏中或以高帧速率使用它？使用上述方法检查这个**jsperf 。**

[https://jsperf.com/various-text-effects-html5-2d-context](https://jsperf.com/various-text-effects-html5-2d-context)

# sql - 在多个表的 GROUP BY 之后获取“最新”行

> ID：13627114
> 
> 赞同：1
> 
> 时间：2012-11-29T13:41:02.660
> 
> 标签：sql, postgresql, greatest-n-per-group, postgresql-9.1, rails-postgresql

我最好先查询下面列出的查询，然后按分组`stories.id`，但我收到以下错误：

`ERROR: column "u.first_name" must appear in the GROUP BY clause or be used in an aggregate function LINE 1: SELECT "s".*, "u"."first_name", "u"."last_name", ("i"."filen...`

第二个查询有效，但不分组`stories.id`并生成错误的结果。是否可以从多个表中选择而不是按所有表分组？

该表`panels`也有一列`updated_at`。我想`file`根据`panels.updated_at`.

```
 SELECT 
        "s".*, 
        "u"."first_name", 
        "u"."last_name", 
        ("i"."filename" || '.' || "i"."extension") AS "file" 
    FROM 
        "stories" "s" 
    LEFT JOIN "panels" "p" ON("p"."story_id" = "s"."id") 
    LEFT JOIN "users" "u" ON("s"."user_id" = "u"."uid")
    LEFT JOIN "images" "i" ON ("p"."image_id" = "i"."id") 
    WHERE 
        "s"."complete" = false AND 
        "s"."created_by" = 205700489 
    GROUP BY 
        "s"."id", 
    ORDER BY 
        "s"."created_at" DESC 
```

* * *

```
 SELECT 
        "s".*, 
        "u"."first_name", 
        "u"."last_name", 
        ("i"."filename" || '.' || "i"."extension") AS "file" 
    FROM 
        "stories" "s" 
    LEFT JOIN "panels" "p" ON("p"."story_id" = "s"."id") 
    LEFT JOIN "users" "u" ON("s"."user_id" = "u"."uid")
    LEFT JOIN "images" "i" ON ("p"."image_id" = "i"."id") 
    WHERE 
        "s"."complete" = false AND 
        "s"."created_by" = 205700489 
    GROUP BY 
        "s"."id", 
        "u"."first_name", 
        "u"."last_name", "i"."filename", 
        "i"."extension" 
    ORDER BY 
        "s"."created_at" DESC 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T15:47:37.017

澄清问题后更新：

```
SELECT DISTINCT ON (s.created_at, s.id)
       s.*
      ,u.first_name
      ,u.last_name
      ,concat_ws('.', i.filename, i.extension) AS file
FROM   stories s 
LEFT   JOIN users  u ON u.uid = s.user_id
LEFT   JOIN panels p ON p.story_id = s.id
LEFT   JOIN images i ON i.id = p.image_id
WHERE  s.complete = false
AND    s.created_by = 205700489 
ORDER  BY s.created_at DESC, s.id, p.updated_at DESC; 
```

[按主键分组](http://www.postgresql.org/docs/current/interactive/release-9-1.html#AEN112891)需要 PostgreSQL 9.1。
我使用[`concat_ws()`](http://www.postgresql.org/docs/current/interactive/functions-string.html#FUNCTIONS-STRING-OTHER), 因为我不知道哪些列可能是`NULL`. 如果同时定义`i.filename`和，则可以简化。`i.extension``NOT NULL`

附加`ORDER BY`项目的效果是每个故事都会选择`p.updated_at DESC`“最新” 。`file`在这个相关问题下完整解释了查询技术：
[Select first row in each GROUP BY group?](https://stackoverflow.com/questions/3800551/sql-select-first-row-in-each-group-by-group)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T13:58:31.450

您可以编写如下内容：

```
 SELECT 
        "s".*, 
        (SELECT "u"."first_name" 
         FROM "users" "u"
         WHERE "s"."user_id" = "u"."uid"
         LIMIT 1) , 
        (SELECT "u"."last_name" 
         FROM "users" "u"
         WHERE "s"."user_id" = "u"."uid"
         LIMIT 1), 
        (SELECT "i"."filename" || '.' || "i"."extension"
         FROM "panels" "p" 
         JOIN "images" "i" ON ("p"."image_id" = "i"."id")
         WHERE "p"."story_id" = "s"."id" 
         LIMIT 1) AS "file" 
    FROM 
        "stories" "s" 
    WHERE 
        "s"."complete" = false AND 
        "s"."created_by" = 205700489 
    ORDER BY 
        "s"."created_at" DESC 
```

它只会从 中的每条记录中获取 1`"users"`条`"panels" JOIN "images"`记录`"stories"`。

添加`ORDER BY`，额外`WHERE`或一些聚合以获取您需要的内容`"users"`和`"panels" JOIN "images"`

UPD 此外，您可以使用以下内容：

```
SELECT *
FROM (
SELECT DISTINCT ON ("s"."id") 
    "s".*, 
    "u"."first_name", 
    "u"."last_name", 
    ("i"."filename" || '.' || "i"."extension") AS "file" 
FROM 
    "stories" "s" 
LEFT JOIN "panels" "p" ON("p"."story_id" = "s"."id") 
LEFT JOIN "users" "u" ON("s"."user_id" = "u"."uid")
LEFT JOIN "images" "i" ON ("p"."image_id" = "i"."id") 
WHERE 
    "s"."complete" = false AND 
    "s"."created_by" = 205700489 
ORDER BY 
    "s"."id"
) t ORDER BY "t"."created_at" DESC 
```

它只会为每个不同的`"s"."id"`

# error-handling - 在我的网站页面上出现 500 内部服务器错误

> ID：13627116
> 
> 赞同：-1
> 
> 时间：2012-11-29T13:41:03.990
> 
> 标签：error-handling, internal-server-error

当我打开我的网站和任何网站页面时，我收到“500 内部服务器错误”。在主机中，不存在 .htaccess 文件。

该网站运行正常，但是当我打开任何网站页面时，它会出现 500 内部服务器错误。

请告诉我网站有什么问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T13:44:24.937

通常，您可以在网络服务器的错误日志文件中找到有关发生的内部服务器错误类型的更多信息。（例如，许多系统上的 /var/log/httpd/error_log）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-10-22T06:45:25.930

您可能正在本地服务器中使用新版本的 php。但是您的托管服务器可能有旧版本的 php。只需在 cpanel 中升级您的 php 版本即可 [升级 php 版本](https://i.stack.imgur.com/niaP5.jpg)

# c# - 如何在运行时打开没有 PropertyGrid 的复杂属性的属性对话框

> ID：13627120
> 
> 赞同：3
> 
> 时间：2012-11-29T13:41:39.680
> 
> 标签：c#, winforms, uitypeeditor

考虑一个带有一些 custom`UserControl`和`Button`.

在 Visual Studio 设计器中，您可以单击属性右侧的按钮（就像您更改控件上的其他常用属性时一样，例如`Font`或`Image`）并为此属性使用编辑器。

在运行时，如果您已将 a 添加`PropertyGrid`到表单并将其指向 this `UserControl`，您还可以在运行时单击该复杂属性右侧的按钮并获得相同的`UITypeEditor`对话框。

我怎样才能让这个编辑器窗口在运行时通过说，一个按钮点击而不`PropertyGrid`在表单上出现？

虽然我已经从这个描述符中得到了 the`PropertyDescriptor`和 the `UITypeEditor`，但我不知道调用什么来获取实例`ITypeDescriptorContext`以及`IServiceProvider`调用什么时候`UITypeEditor.EditValue`让编辑器显示。

这与为属性构建自定义 UITypeEditor 相关：[Building Windows Forms Controls and Components with Rich Design-Time Features](http://msdn.microsoft.com/en-us/magazine/cc164145.aspx "构建具有丰富设计时功能的 Windows 窗体控件和组件")。在这种情况下，我已经配置了所有这些并且一切都运行良好，所以我只想在运行时调用编辑器窗口。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-02T19:25:49.960

我你已经设法实现了`TypeDescriptor`，你几乎完成了。
这可能是您的开始：

```
public class MyEditor: UITypeEditor {

    public override UITypeEditorEditStyle GetEditStyle(ITypeDescriptorContext context) {
        return UITypeEditorEditStyle.DropDown;
    }

    public override object EditValue(ITypeDescriptorContext context, IServiceProvider provider, object value) {
        IWindowsFormsEditorService  service = (IWindowsFormsEditorService)provider.GetService(typeof(IWindowsFormsEditorService));
        if (service != null) {
            SomeControl ctrl = new SomeControl();
            ctrl.XYZ = ...
            service.DropDownControl(ctrl);
            value = ctrl.XYZ;
        }
        return value;
    } 
```

WinForms 处理其余部分。

如果您有表单而不是控件，则返回`UITypeEditorEditStyle.Modal`表单`GetEditStyle`并使用。`service.ShowDialog(ctrl)`

# html - IE8 内容问题

> ID：13627121
> 
> 赞同：-2
> 
> 时间：2012-11-29T13:41:46.737
> 
> 标签：html, css, internet-explorer, web, internet-explorer-8

您好，我在[http://www.jn-design.co.uk/WirralPT有一个网站](http://www.jn-design.co.uk/WirralPT)

它在除 IE8 之外的所有其他浏览器中看起来都不错，我什至还没有尝试低于 8。

主页列表和页脚不是应有的样子，请在 chrome 或更新的浏览器中查看，看看应该是什么样子。

我已经验证了我所有的 HTML 和 CSS 代码，它是完全有效的。

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T13:45:41.107

`nav`Internet Explorer 8 及更低版本不支持和`footer`html5 元素。尝试使用[html5shiv使用 javascript 添加它们](http://code.google.com/p/html5shiv/)

# regex - 使用 Yahoo Pipes 过滤掉描述少于 3 个字符的 RSS 项目

> ID：13627125
> 
> 赞同：0
> 
> 时间：2012-11-29T13:42:06.850
> 
> 标签：regex, filter, rss, yahoo-pipes

我正在尝试使用此 Yahoo Pipe 过滤掉具有空描述或描述短于 3 个字符的项目： http://pipes.yahoo.com/pipes/pipe.edit?_id= [966d5a5006cad6b2825d4f744b1ebb50#eefd469cf1c28d4d6cb6bd6c6c1ab6b8](http://pipes.yahoo.com/pipes/pipe.edit?_id=966d5a5006cad6b2825d4f744b1ebb50#eefd469cf1c28d4d6cb6bd6c6c1ab6b8)

这是管道的工作流程：

“获取提要”模块 - 获取提要 “创建 RSS” 模块 - 创建新提要并使用项目描述作为新提要的项目标题 “正则表达式” 模块 - 从标题中删除 html 标签 “过滤器” 模块 - 我想阻止具有要么是空的描述，要么是少于 3 个字符的描述，我不知道该放什么——“null”、“*”……？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T14:10:42.090

尝试更改您的过滤器以**允许**匹配而不是阻止的项目，并将您的正则表达式更改为以下内容：

`^.{3,}$`

# mysql - MYSQL interdepedent Query，我该怎么写

> ID：13627129
> 
> 赞同：0
> 
> 时间：2012-11-29T13:42:18.480
> 
> 标签：mysql

表一是

```
Posts -> id, comments, threadBelongID
Threads -> id, title 
```

现在我想首先使用匹配项在线程内部找到一个线程，然后让它返回一个 id，使用该 id 我想在帖子中运行查询，其中从线程返回的 id 用于搜索匹配 WHERE threadId = (SELECT id FROM threads WHERE match AGAINST()...)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T13:55:00.877

我不确定我是否正确理解了你的问题，但我想你正在寻找这样的东西：

```
SELECT * FROM Posts WHERE threadBelongID IN (SELECT id FROM Threads MATCH(title, content, whatever) AGAINST 'Search term'); 
```

在这里查看 MySQL 子查询：

[http://dev.mysql.com/doc/refman/5.5/en//subqueries.html](http://dev.mysql.com/doc/refman/5.5/en//subqueries.html)

# axis - org.xml.sax.SAXParseException；行号：1；列号：1；序言中不能有内容

> ID：13627135
> 
> 赞同：1
> 
> 时间：2012-11-29T13:42:39.227
> 
> 标签：axis, invoke, saxparseexception

这是我用来访问我得到 org.xml.sax.SAXParseException 的 web 服务的 Axis 客户端代码；行号：1；列号：1；序言中不能有内容。这是当我发送一个肥皂消息时，如果我发送带有 UTF-8 编码的 XML，我会得到一个套接字超时

两个异常都发生在调用

有没有办法我可以忽略 call.invoke 上的 BOM 标记，这似乎是个问题。

快速帮助将不胜感激..谢谢

公共类 WSTestClient { public static void main(String [] args) { try{

```
 String acordXMLUrl = "C:\\request.xml";

        File xmlFile = new File(acordXMLUrl);

        InputStream in = new FileInputStream(xmlFile);
        Reader reader = new InputStreamReader(in, "UTF-8");
        int c;
        StringBuffer sb = new StringBuffer();
        while ((c = in.read()) != -1)
        sb.append((char) c);
        String acordXML = sb.toString();

        Message msg = new Message(acordXMLUrl);

        SOAPEnvelope se;       

        String endpoint ="https://somewebservice/getme";

    Service  service = new Service();

        Call     call    = (Call) service.createCall();
        call.setTimeout(5000);

        call.setTargetEndpointAddress( new java.net.URL(endpoint) );

        call.setOperationName(new QName("http://soapactionurl","getme"));

        System.out.println("Calling into webservice" );

        String ret="";

        try{
       //ret = (String) call.invoke( new Object[] {acordXML} );

        se =  call.invoke( msg);
        }
        catch (RemoteException e) {

        System.err.println(e.toString());

        }

        System.out.println("Return is:"+ ret);

        }

        catch (Exception e) {

        System.err.println(e.toString());

        }}} 
```

# scala - 任何支持 SBT 的 IDE？

> ID：13627137
> 
> 赞同：4
> 
> 时间：2012-11-29T13:42:47.853
> 
> 标签：scala, plugins, ide, sbt

是否有任何 IDE 以适当的方式支持 SBT（例如 Maven）？因为我找到了很多*生成 IDE 相关配置文件*的工具，但是我还没有找到任何支持 IDE 中 SBT 交互形式的插件。

我想制作一个基于 SBT 的与 IDE 无关的项目，但我也希望能够使用 IDE 提供的全部功能，而不仅仅是将其用作编辑器并从控制台执行所有其他操作。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-29T13:44:49.433

[Intellij](http://www.jetbrains.com/idea/)符合要求吗？它有一个[SBT 插件](http://plugins.intellij.net/plugin?pluginId=5007)（当然还有一个 Scala 插件！）

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-11-29T15:38:10.180

我知道这并不完全是您正在寻找的东西，但把它放在这里作为在 eclipse 中使用 SBT 的解决方法，供任何感兴趣的人使用。

SBT 生成 eclipse 配置文件，但是在你导入它之后，它可以在 eclipse 中正常工作。您只需要首次在 Eclipse 之外设置项目，运行 SBT 以解决依赖关系，使用 eclipse sbt 插件生成 eclipse 结构并导入到 Eclipse 中。之后，您可以直接从 Eclipse 运行代码，它工作正常。

以下是详细步骤：

1.  创建文件夹结构如下： ![ScalaSBT项目](../Images/374611bae4abb1bdbce220ce0fd01fb6.png)

2.  在文件夹中创建一个名为`plugins.sbt`的`project`文件，并向其中添加以下行：

    ```
    addSbtPlugin("com.typesafe.sbteclipse" % "sbteclipse-plugin" % "2.1.0") 
    ```

3.  `build.sbt`在根目录下创建ie `ScalaSBTProject`，内容类似如下。我在这里使用 akka，但可以根据需要添加和删除库：

    ```
    name := "ScalaSBTProject"

    version := "1.0"

    scalaVersion := "2.10.0-RC2"

    resolvers += "Typesafe Repository" at "http://repo.typesafe.com/typesafe/releases/"

    libraryDependencies += "com.typesafe.akka" % "akka-cluster-experimental_2.10.0-RC2" % "2.1.0-RC2" 
    ```

4.  打开命令提示符并`sbt`在目录中运行`ScalaSBTProject`。SBT 将下载并解决所需的任何依赖项

5.  `eclipse`在 SBT 命令行中运行该命令。这将生成所有与eclipse相关的项目文件

6.  使用工作区导入`ScalaSBTProject`Eclipse `File->Import->Existing Project`，并确保选中`Import into workspace`

编辑：就像 Post-Script 一样，您可以很容易地创建一个批处理文件来获取项目的名称并生成与 eclipse 兼容的项目，这只是一种加快进程的方法。

# php - 即使不存在记录，发布的结果也不会保存到 mysql 数据库

> ID：13627146
> 
> 赞同：0
> 
> 时间：2012-11-29T13:43:43.423
> 
> 标签：php, mysql, if-statement, while-loop

我正在使用以下内容进行测验，它检查表格以查看用户是否已经发布了问题的答案并且没有敲击提交按钮，我遇到的问题是它没有将信息发布到数据库出于某种奇怪的原因。如果我取出 if 语句和第一个数据库查找并发布数据它工作正常，但是当我首先检查第一个查询的结果时，它似乎不起作用，即使用户没有提交回答呢。

```
 <?php
 $quizID = $_GET['quiz'];
$userID = $_GET['user'];
$quizselectanswer = $_POST['quizselectanswer'];
$cf_created = date("y/m/d");
$questionID = $_POST['questionID'];

// Check to see if user answered question already
 $result = mysql_query("SELECT questionID,userID FROM itsnb_chronoforms_data_answerquiz WHERE     questionID='$questionID' AND userID='$userID' LIMIT 1") or die(mysql_error());

while($row = mysql_fetch_array($result))
{ 
if (empty($row))
{
    mysql_query("INSERT INTO itsnb_chronoforms_data_answerquiz (cf_created,     questionID,quizselectanswer,quizID, userID)
    VALUES ('$cf_created', '$questionID', '$quizselectanswer', '$quizID','$userID')") 
    or     
    die(mysql_error());
}else{

}
}
?> 
```

我的数据库看起来像这样`itsnb_chronoforms_data_answerquiz` `cf_id`, `cf_uid`, `cf_created`, `cf_modified`, `cf_ipaddress`, `cf_user_id`, `questionID`, `quizselectanswer`, `quizID`, `userID`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T14:23:00.973

像这样尝试它可能会帮助你

```
// Check to see if user answered question already
 $result = mysql_query("SELECT * FROM itsnb_chronoforms_data_answerquiz WHERE questionID='$questionID' AND userID='$userID' LIMIT 1") or die(mysql_error());

$row = mysql_fetch_array($result);
if(!empty($row)) 
{
    while($row){
        //some statement
    }
}else{
    mysql_query('INSERT INTO itsnb_chronoforms_data_answerquiz (cf_created, questionID,quizselectanswer, quizID, userID)
    VALUES ("'.$cf_created.'", "'.$questionID.'", "'.$quizselectanswer.'", "'.$quizID.'","'.$userID.'")') or die(mysql_error());
}
?> 
```

# java - 计算图中的所有顶点

> ID：13627151
> 
> 赞同：0
> 
> 时间：2012-11-29T13:44:03.503
> 
> 标签：java, graph, vertex, edges

我对 java 还很陌生，我已经为这个练习苦苦挣扎了两个星期（这是我学校的家庭作业）。我需要创建一个拓扑排序并打印出所有可能的连接。我现在已经阅读了很多关于拓扑排序的内容，但是我们必须使用这行特定的代码。当我有顶点列表时，我很确定我可以进行拓扑排序。我的问题是，我不知道如何列出这个给定代码中的所有顶点。谁能给我一些提示或线索或者一个例子，我真的很感激。

这是我们需要使用的给定代码：

```
import java.util.*;

public class Answer {

   public static void main (String[] args) {
      Answer a = new Answer();
      a.run();
   }

   public void run() {

      // TODO!!! YOUR TESTS HERE!

      Graph g = new Graph ("G");
      Vertex a = new Vertex ("A");
      Vertex b = new Vertex ("B");
      Vertex c = new Vertex ("C");
      g.first = a;
      a.next = b;
      b.next = c;
      Edge ab = new Edge ("AB");
      Edge ac = new Edge ("AC");
      Edge ba = new Edge ("BA");
      Edge ca = new Edge ("CA");
      a.first = ab;
      b.first = ba;
      c.first = ca;
      ab.next = ac;
      ab.target = b;
      ac.target = c;
      ba.target = a;
      ca.target = a;
      System.out.println (g);
   }

   class Vertex {

      String id;
      Vertex next;
      Edge first;

      Vertex (String s, Vertex v, Edge e) {
         id = s;
         next = v;
         first = e;
      } 

      Vertex (String s) {
         this (s, null, null);
      }

      @Override
      public String toString() {
         return id;
      }

      // TODO!!! Your Vertex methods here!

   } // Vertex

   class Edge {

      String id;
      Vertex target;
      Edge next;

      Edge (String s, Vertex v, Edge e) {
         id = s;
         target = v;
         next = e;
      }

      Edge (String s) {
         this (s, null, null);
      }

      @Override
      public String toString() {
         return id;
      }

      // TODO!!! Your Edge methods here!

   } // Edge

   class Graph {

      String id;
      Vertex first;

      Graph (String s, Vertex v) {
         id = s;
         first = v;
      }

      Graph (String s) {
         this (s, null);
      }

      @Override
      public String toString() {
         String nl = System.getProperty ("line.separator");
         StringBuffer sb = new StringBuffer (nl);
         sb.append (id + nl);
         Vertex v = first;
         while (v != null) {
            sb.append (v.toString() + " --> ");
            Edge e = v.first;
            while (e != null) {
               sb.append (e.toString());
               sb.append ("(" + v.toString() + "->" 
                  + e.target.toString() + ") ");
               e = e.next;
            }
            sb.append (nl);
            v = v.next;
         }
         return sb.toString();
      }

      // TODO!!! Your Graph methods here!

   } // Graph
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T13:55:01.873

显然，该图具有对第一个顶点的引用，并且这些顶点本身链接在一起形成一个单链表。这段代码应该是您将顶点收集到 Java 列表中所需的全部内容：

```
public List<Vertex> allVertices(Graph g) {    
  final List<Vertex> vertices = new ArrayList<>();
  for (Vertex v = g.first; v != null; v = v.next)
     vertices.add(v);
  return vertices;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T13:55:47.690

我建议您将“lastvisited”整数字段添加到设置为零的边缘，或使用布尔值“visited”（真/假）。然后从一个顶点开始。假设图是连接的，您将通过遍历一个顶点的未访问边来到达所有顶点，然后沿着边到达它通向的顶点，将边标记为跟随，并递归地调用该顶点的计数函数。

```
I.E.: count(node) = sum(my unvisited edges) mark_edge_as_visited(edge), count(edge.target) 
```

请注意，您还必须考虑该图似乎是有向图，因此从 a 到 b 和从 b 到 a 的边被计为两条边。

编辑：我犯了一个错误，您还需要将顶点标记为已访问，否则它将被访问两次（我在考虑无向图）。

# objective-c - 我将如何使用 AFNetwork 为网络服务器创建 GET 方法

> ID：13627159
> 
> 赞同：0
> 
> 时间：2012-11-29T13:44:39.980
> 
> 标签：objective-c, ios, xcode, afnetworking

我想知道如何让 AFNetworking 代码访问我的 Web 服务器（PHP 脚本）上的链接并获取响应数据，并将其放入字符串中？

任何人都可以发布一个例子吗？

非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T14:22:29.257

这是使用 AFNETWorking 从服务器获取响应所需的代码。只需添加 AFNetworking 库和所需的框架。之后使用下面的代码。

```
NSURL *url = [[NSURL alloc] initWithString:@"http://itunes.apple.com/search?term=harry&country=us&entity=movie"];
        NSURLRequest *request = [[NSURLRequest alloc] initWithURL:url];

        AFJSONRequestOperation *operation = [AFJSONRequestOperation JSONRequestOperationWithRequest:request success:^(NSURLRequest *request, NSHTTPURLResponse *response, id JSON) {
            NSLog(@"JSON");

            self.movies = [JSON objectForKey:@"results"];
            [self.tbleView reloadData];

           } failure:^(NSURLRequest *request, NSHTTPURLResponse *response, NSError *error, id JSON) {
            NSLog(@"Request Failed with Error: %@, %@", error, error.userInfo);
        }]; 
```

self.movi​​es 是可变数组的名称，您可以使用任何名称代替它。

你也可以在这里查看

[https://github.com/AFNetworking/AFNetworking](https://github.com/AFNetworking/AFNetworking)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T13:52:16.413

AFHTTPRequests 获得默认的 NSURLRequest 对象。库存的 - AFNetwork 没有修改

要构建 THAT，请参阅 [如何将 GET 参数添加到 ASIHttpRequest？](https://stackoverflow.com/questions/9159663/how-to-add-get-parameters-to-an-asihttprequest)

# php - json_decode 奇怪的问题

> ID：13627161
> 
> 赞同：0
> 
> 时间：2012-11-29T13:44:46.720
> 
> 标签：php, json

我有一个很奇怪的问题，

我正在尝试用 php 解析一些 json 字符串，字符串在数组中，如果我使用简单

```
json_decode($my_array[0],true) 
```

它不起作用，但是，如果我只是从 var_dump($my_array) 复制一个字符串并尝试解码它，它可以 100% 正常工作。

有什么想法可能是错的吗？

json字符串：

```
 {"mode":"view","pid":"243","documentId":"193"} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T13:48:29.017

库巴，

以下是将 json 数组转换为 php 关联数组的语法：

```
$my_array = '{"mode":"view","pid":"243","documentId":"193"}';
$new_array = json_decode($my_array,true);

echo $new_array['mode']; //return: view
echo $new_array['pid']; //return: 243
echo $new_array['documentId']; //return: 193 
```

**var_dump() 结果：**

```
array (size=3)
  'mode' => string 'view' (length=4)
  'pid' => string '243' (length=3)
  'documentId' => string '193' (length=3) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T16:22:30.240

好的，我找到了解决方案，在数据序列化之后，我使用 base64_encode 对字符串进行了编码，然后以这种形式将它推送到其他脚本。

我仍然不知道为什么我必须用 base64 对其进行编码，也许是因为这个字符串用于 javascript 脚本，然后在 php 中解码？

# cakephp - 在cakephp中重写url以在所有url前面添加www

> ID：13627165
> 
> 赞同：0
> 
> 时间：2012-11-29T13:44:58.190
> 
> 标签：cakephp

我有一个 cakephp 2 应用程序。我在其中添加了 ssl，站点中有一个表单，其字段使用 JavaScript 填充，表单是使用 JavaScript 提交的。启用安全组件后，我无法提交网站。我知道原因是在这个表单中我没有在某些部分使用表单助手。我确信有一些方法可以绕过特定方法的安全组件。我尝试了很多，但它不起作用。

以下是代码。

应用程序/控制器/appcontroller.php

```
class AppController extends Controller {
      public $components = array('Session',
                                  'Auth'=> array(
                                  'authenticate' => `array('Form' =>array('fields'=>array('username' => 'email'))))`,
                                   'Acl'   ,

                                  'Email' => array('from' => 'donotreply@qpaper.in',    'sendAs' => 'html',
                 )
                                ,'Security'=> array( 'allowedControllers'=>array('tests','live_tests'),'allowedActions'=>array('taketest','create_test'))
                                                                );
      public $helpers            =   array('Html', 'Form','Session','Js');

    function beforeFilter() {
    Security::setHash('md5');
    $this->Auth->loginAction = array('controller' => 'users', 'action' => 'login');
    $this->Auth->loginError = 'Invalid Username or Password.';
    $this->Auth->authError = "You are not authorized to access.";
    $this->Auth->logoutRedirect = array('controller' => 'users', 'action' => 'login');
    $this->Auth->authorize = 'Actions';
    $this->Auth->actionPath = 'Controllers/';

            $this->Security->blackHoleCallback = 'forceSSL';
            $this->Security->requireSecure();

}   
  public function forceSSL() {
        $this->redirect('https://' . env('SERVER_NAME') . $this->here);
    }

} 
```

我在 appcontroller 中强制使用 https

我要使用的表单在一个名为 testcontroller 的控制器和一个名为 test 的方法中

感谢您的时间！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T14:24:46.590

如果您想尝试使用 apache config 来执行此操作。试试这个

```
RewriteCond %{HTTP_HOST} !^www\.
RewriteCond %{HTTPS}s ^on(s)|
RewriteRule ^ http%1://www.%{HTTP_HOST}%{REQUEST_URI} [R=301,L] 
```

# jquery - 通过 AJAX 获取值并将其显示在元素 CodeIgniter 上

> ID：13627168
> 
> 赞同：0
> 
> 时间：2012-11-29T13:45:12.383
> 
> 标签：jquery, ajax, codeigniter

首先让我澄清一下，我完全是 AJAX 和 CodeIgniter 的初学者。

我正在阅读这篇文章开始，我想我理解了一些：

[http://www.amitavroy.com/justread/content/articles/getting-ajax-data-using-views-codeigniter](http://www.amitavroy.com/justread/content/articles/getting-ajax-data-using-views-codeigniter)

我需要做的是`Input Field`在更改`select`html 元素时更新表单中的 a 。

```
<select class="select" name="formulario">
  <?php
  foreach($listaForms as $form) {
    echo "<option value={$form}>{$form}</option>";
  }
  ?>
</select> 
```

我知道该怎么做：

1）用jquery，听`change()`。2) 使用 POST 制作 ajax 功能。3）制作公共函数来检索数据。

嗯，问题出在这里...

在我正在阅读的教程中，这个人得到了 HTML 响应。

我只需要一个值或多个值。在这种特殊情况下，我只需要一个值，即最后打印的数字（存储在文本文件中）。

问题是，我如何确定我需要的值，假设响应是：

```
LastPrintedNumber=>23
OtherValue=>20 
```

如何使用 Javascript 正确识别响应中所需的值，然后更改它？

我想一旦我识别并获得了值，我只需要更改`value`输入文本字段的值。

谢谢！！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T14:23:45.983

服务器的响应应该是 JSON 格式。使用 PHP 的 json_encode 函数。您的 PHP（服务器端）代码应该是这样的：

```
// if it's a json request
if(!empty($_POST['data']) && 'ajax' == $_POST['data'])
{
    $res = array('LastPrintedNumber' => 23, 'OtherValue' => 20);
    header('Content-type: application/json');
    echo json_encode($res);
    exit; // no need to render the template
} 
```

修改您的 jQuery 代码，以便它可以处理/解析 JSON 响应：

```
 $(function(){
    $('#formulario').change(function() {
      $.ajax({
        type: 'POST',
        url: '/migup',
        data: {'data' : 'ajax', 'selectedValue' : $(this).val()},
        dataType: 'json',
        success: function(val) {
          console.log('LastPrintedNumber: ' + val.LastPrintedNumber);
          alert('OtherValue:' + val.OtherValue);
        }        
      });
    });
  }); 
```

希望有帮助。干杯!

# php - 如何在保留 html 格式的同时使用 PHP 将 div 的内容作为电子邮件发送？

> ID：13627170
> 
> 赞同：0
> 
> 时间：2012-11-29T13:45:15.617
> 
> 标签：php, html

让我们想象一下这个简单，我在一个包含以下内容的表单中有一个 div (myDiv)：

```
<div id=myDiv>Hi Same, please click <a href="http://www.test.com">Click here</a></div> 
```

现在我需要一个 php 脚本，它将这个 div 发送到某人的电子邮件，完全保持正确的 html 格式，如下所示：

你好，请[点击这里](http://www.test.com)

问题是当我在文本框中有此内容时，它会将其全部作为文本发送。我需要发送 div 内容。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T13:49:22.230

您需要发送带有`content-type=text/html`标题的电子邮件。

这告诉电子邮件客户端将电子邮件呈现为 HTML。

具体如何操作取决于您使用的是内置的 php 函数还是诸如 swiftmailer 或 phpmailer 之类的库。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T13:49:53.513

你可以使用[PHPMailer](http://phpmailer.worxware.com/)，如果你使用这个方法：

```
$mail->IsHTML(true); 
```

该消息将作为 HTML 发送，因此它应该可以工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-29T14:01:26.693

当您使用 formtoemail.com 的免费服务时，您应该从他们的网站下载文件。在那里找到这一行：

```
mail($my_email,$subject,$message,$headers); 
```

并在它之前添加

```
$headers .= PHP_EOL;
$headers .= "Content-type: text/html;"; 
```

所以最后你将拥有：

```
$headers .= PHP_EOL;
$headers .= "Content-type: text/html;";
mail($my_email,$subject,$message,$headers); 
```

# java - 在 Windows 7 64 位中使用 Graphics2D 问题使图像变暗

> ID：13627171
> 
> 赞同：1
> 
> 时间：2012-11-29T13:45:17.957
> 
> 标签：java, image, swing, graphics2d, paint

我的小型 Java 程序试图使 png 图像变暗。它在我的 Mac 上运行良好，但是当我尝试在安装了 java 1.7_07 的 Windows PC 上运行它时，除了一个空的 JPanel 之外什么都没有显示，图像完全消失了。

这是代码：

```
class MapCanvas extends JPanel {
    private Color color;
    RescaleOp op;
    BufferedImage sourceImage, bi;

    public MapCanvas() {
        try {
            sourceImage = ImageIO.read(new File(MAP_FILENAME));

            bi = new BufferedImage(sourceImage.getWidth(), sourceImage.getHeight(), BufferedImage.TYPE_INT_ARGB);

            op = new RescaleOp(.8f, 0, null);
            bi = op.filter(bi, null);

            Graphics2D g = bi.createGraphics();

            g.drawImage(sourceImage, 0, 0, 500, 382, null);
            g.dispose();

        } catch (Exception e) {
            e.printStackTrace();
        }

        // set size for the panel
        Dimension size = new Dimension(500, 382);
        this.setBackground(new Color(34, 102, 187));
        setPreferredSize(size);
        setSize(size);
        setLayout(null);
    }

    @Override
    public void paintComponent(Graphics g) {
        super.paintComponent(g);
        g2d = (Graphics2D) g;

        g2d.drawImage(bi, op, 0, 0);  
    }
} 
```

有谁知道我为什么会得到这个？非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T22:34:25.733

我似乎没有任何问题，但是，关于这个例子，我突然想到了几件事......

首先，我不明白你为什么这样做......

```
try {
    sourceImage = ImageIO.read(new File("C:/Users/shane/Dropbox/issue453.jpg"));

    bi = new BufferedImage(sourceImage.getWidth(), sourceImage.getHeight(), BufferedImage.TYPE_INT_ARGB);

    op = new RescaleOp(.1f, 0, null);
    bi = op.filter(bi, null);

    Graphics2D g = bi.createGraphics();

    g.drawImage(sourceImage, 0, 0, 500, 382, null);
    g.dispose();

} catch (Exception e) {
    e.printStackTrace();
} 
```

然后做了这个...

```
public void paintComponent(Graphics g) {
    super.paintComponent(g);

    g2d = (Graphics2D) g;
    g2d.drawImage(bi, op, 0, 0);
} 
```

你基本上是双重应用`RescaleOp`。

它可以简单地`RescaleOp`直接应用于`sourceImage`...

```
public void paintComponent(Graphics g) {
    super.paintComponent(g);

    g2d = (Graphics2D) g;
    g2d.drawImage(sourceImage, op, 0, 0);
} 
```

除非你关心性能，在这种情况下你应该简单地绘制`bi`没有任何`BufferedImageOp`

```
g2d.drawImage(bi, 0, 0, this); 
```

其次，您的示例将无法编译，因为您尚未`g2d`在`paintComponent`方法中定义。这要么是疏忽（这很好），要么是您正在缓存`Graphics`对象，这不好。

`Graphics`对象是无状态的，它们不会在重绘之间持续存在，你不应该缓存它们或依赖`getGraphics`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T22:42:30.960

谢谢你指出我的错误。我的问题中缺少一些代码（Graphics2D g2d - 它只是一个未分配的变量），因此无法编译。对于那个很抱歉。

这就是我修复它的方法：

```
 `sourceImage = ImageIO.read(new File(MAP_FILENAME));

            bi = new BufferedImage(sourceImage.getWidth(), sourceImage.getHeight(), BufferedImage.TYPE_INT_ARGB);

            float[] scales = { .5f, .5f, .5f, 1f };
            float[] offsets = new float[4];
            op = new RescaleOp(scales, offsets, null);

            Graphics2D g1 = bi.createGraphics();

            g1.drawImage(sourceImage, 0, 0, 500, 382, null);
            g1.dispose();

            op.filter(sourceImage, bi);` 
```

我只是在 scales 数组中使用相同的 RGB 值（这就是它应该是的）然后绘制过滤后的图像。

```
 `g2d.drawImage(bi, 0, 0, 500, 382, null);` 
```

干杯

# nservicebus - 错误队列和消息的批量发送

> ID：13627172
> 
> 赞同：0
> 
> 时间：2012-11-29T13:45:19.920
> 
> 标签：nservicebus

希望这是一个简单的问题，但我需要验证我的假设是否正确：如果我在一批发送中发送 4 条消息，并且 4 条消息中的一条导致错误并且在其处理程序中重试失败，那么该单条消息是否会被转发到错误队列还是整个批处理消息都放入错误队列？

常识告诉我，当批处理消息被解包并委托给它的处理程序时，单个消息将被移动到错误队列中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T00:13:02.177

事务边界是处理程序，因此每条消息都有自己的重试集。唯一的复杂性是，如果您使用消息处理程序的管道，您还必须考虑如果任何处理程序对给定消息失败，将发生重试。

# sql - 唯一索引在 INFORMATION_SCHEMA 中不是唯一的

> ID：13627173
> 
> 赞同：0
> 
> 时间：2012-11-29T13:45:24.113
> 
> 标签：sql, sql-server-ce

考虑以下非常简单的外键约束：

```
CREATE TABLE [Person]([id] uniqueidentifier NOT NULL, [name] nvarchar(400) NULL)
GO

CREATE TABLE [Order]([id] uniqueidentifier NOT NULL, [pid] uniqueidentifier NOT NULL)
GO

/****** Index: [uindex] ******/
CREATE UNIQUE INDEX [uindex] on [Person] ([id])
GO

/****** ForeignKey: [FK_Order_Person] ******/
ALTER TABLE [Order] ADD  CONSTRAINT [FK_Order_Person] FOREIGN KEY([pid])
REFERENCES [Person] ([id])
GO 
```

您首先会注意到 上没有 PK `[Person]`，只有一个唯一索引允许我创建对 . 的外键引用`[Person].[id]`。

`[INFORMATION_SCHEMA].[REFERENTIAL_CONSTRAINTS]`显示了我所期望的：将外键名称`[FK_Order_Person]`与唯一约束名称链接的行`[uindex]`。

所以我的问题是：强制`INFORMATION_SCHEMA`在 SQL Server Compact 中使用，我从哪里获取索引的表和列信息`[uindex]`？

`[KEY_COLUMN_USAGE]`因为我没有主键，所以连接不会产生任何结果。

在此示例中，我可以加入`[INFORMATION_SCHEMA].[INDEXES]`，但没有规则强制此名称在表或模式之间是唯一的，因此如果存在另一个具有相同名称的唯一键，那么我将无法确定该外键指向的位置。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T14:13:53.373

```
 "SELECT KCU1.TABLE_NAME AS FK_TABLE_NAME,  KCU1.CONSTRAINT_NAME AS FK_CONSTRAINT_NAME, KCU1.COLUMN_NAME AS FK_COLUMN_NAME, " +
            "KCU2.TABLE_NAME AS UQ_TABLE_NAME, KCU2.CONSTRAINT_NAME AS UQ_CONSTRAINT_NAME, KCU2.COLUMN_NAME AS UQ_COLUMN_NAME, RC.UPDATE_RULE, RC.DELETE_RULE, KCU2.ORDINAL_POSITION AS UQ_ORDINAL_POSITION, KCU1.ORDINAL_POSITION AS FK_ORDINAL_POSITION " +
            "FROM INFORMATION_SCHEMA.REFERENTIAL_CONSTRAINTS RC " +
            "JOIN INFORMATION_SCHEMA.KEY_COLUMN_USAGE KCU1 ON KCU1.CONSTRAINT_NAME = RC.CONSTRAINT_NAME " +
            "JOIN INFORMATION_SCHEMA.KEY_COLUMN_USAGE KCU2 ON  KCU2.CONSTRAINT_NAME =  RC.UNIQUE_CONSTRAINT_NAME AND KCU2.ORDINAL_POSITION = KCU1.ORDINAL_POSITION AND KCU2.TABLE_NAME = RC.UNIQUE_CONSTRAINT_TABLE_NAME " +
            "WHERE KCU1.TABLE_NAME = '" + tableName + "' " +
            "ORDER BY FK_TABLE_NAME, FK_CONSTRAINT_NAME, FK_ORDINAL_POSITION" 
```

然后需要对它们进行分组，有关详细信息，请参阅我的脚本 API，

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-17T17:50:08.260

此语句中有一个错误的假设：“在此示例中，我可以加入 [INFORMATION_SCHEMA].[INDEXES]，但没有规则强制此名称在表或模式之间是唯一的，因此如果存在另一个具有相同名称的唯一键，则我将无法计算出这个外键指向的位置。”

在 Sql Compact 中只有一个模式，因此表名和索引名组合是唯一的。此外，视图 INFORMATION_SCHEMA.REFERENTIAL_CONSTRAINTS 确实包含唯一约束表的名称以及唯一约束名称。（这与等效的 Sql Server 视图不同）

但是请注意，INDEXES 视图实际上每个索引列包含一行（没有索引定义视图），但这意味着您可以将外键列和唯一索引列关联起来。

# url - 如何修复plone的baseurl？

> ID：13627174
> 
> 赞同：0
> 
> 时间：2012-11-29T13:45:23.260
> 
> 标签：url, plone, multilingual, linguaplone

我用 linguaplone 创建了多语言网站。现在我应该将 baseurl 修复`.../en`为`...../de`两个版本。

我应该怎么办？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T09:10:35.580

# php - 如何一次将多个值发送到 Web 服务器

> ID：13627179
> 
> 赞同：3
> 
> 时间：2012-11-29T13:45:36.627
> 
> 标签：php, android, mysql, database, hosting

我的问题是，我每秒跟踪用户的位置，它在一分钟内在一个数组中生成 60 个值。我在我的服务器中编写了一个简单的 php 来将数据保存到 mysql 表中。由于连接的性质（据我所知），我可以在 android 端使用简单的 httppost 对象为每个请求保存一条记录。（请求类似于：xxx.com/writelocation.php?lat=33.76&lon=45.0 &alt=12000) 我试图通过使用 asynctask 来解决这个问题，但它没有用。连接速度慢，数据量大。连接完成需要一秒钟多的时间，每秒钟都有一条新记录出现。我正在寻找一种方法，每分钟左右一次发送多个值。到目前为止，除了使用直接访问远程数据库之外，我找不到其他解决方案。但是我的主机不提供对我的 mysql 数据库的远程访问。

我需要一个聪明而廉价的解决方案来解决我的问题:) 你有什么建议？仅使用远程数据库（通过数据库托管）解决方案吗？

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T14:23:59.773

**PHP**

使用 PHP 可以构造一个多维 POST/GET 数组，如下所示：

（假设这是查询字符串的一部分）
`id[]=1&id[]=2&id[]=3`

产生：

```
array(1) {
   "ID" => array(3) {
       [1] => string(1) "1"
       [2] => string(1) "2"
       [3] => string(1) "3"
   }
} 
```

同样，如果将文本放在方括号之间，则可以利用 PHP 的关联数组功能：

`form[fName]=John&form[lName]=Doe&form[age]=20`

生产

```
array(1) {
   "form" => array(3) {
       ["fName"] => string(4) "John"
       ["lName"] => string(3) "Doe"
       ["age"]   => string(2) "20"
   }
} 
```

不用说，这适用于 POST 和 GET。您可以在您的应用程序中使用它，如下所示：

loc1[lon]=经度&loc1[lat]=纬度&loc2[lon]=经度&loc2[lat]=纬度

所以你得到：

```
array(2) {
   "loc1" => array(2) {
       "longitude" => string(9) "longitude"
       "latitude"  => string(8) "latitude"
   }
   "loc2" => array(2) {
       "longitude" => string(9) "longitude"
       "latitude"  => string(3) "latitude"
   }
} 
```

**MySQL**

只是一个旁注：您可以一次插入所有数据并获得一些速度优势，而不是运行多个插入查询。例如。

```
INSERT INTO `users` ( `fName`, `lName`, `age` ) VALUES ( "John", "Doe", "20" ),( "John", "Citizen", "42" ) 
```

在上面，我们插入了两行数据......

```
( "John", "Doe", "20" )
( "John", "Citizen", "20" ) 
```

此外，请确保您的数据已正确[转义](http://php.net/manual/en/mysqli.real-escape-string.php)。这可能因您使用的数据库 API 而异。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-29T13:49:31.410

Json 编码速度非常快，带宽消耗非常小。我建议您使用 json 发送这些数据，然后在服务器端解析 json 并将数据插入数据库中。

要了解更多关于 android 中的 json，请参阅[http://www.vogella.com/articles/AndroidJSON/article.html](http://www.vogella.com/articles/AndroidJSON/article.html)

你有什么想法 ？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-29T13:51:13.157

使用 INSERT DELAYED 而不是 INSERT。对于这种情况，MySQL 也不是一个真正可扩展的解决方案，也许最好使用 MongoSQL 来处理这么多的请求。您还可以将服务器上的请求保存为文本文件，并每隔几秒或几分钟批量运行查询

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-11-29T14:02:39.200

试图每秒发送每个新位置是一个基本的设计缺陷，我建议避免这种策略，因为您无法保证移动设备的网络可用性和延迟。

这样做的方法是在本地缓冲数据，并以块的形式将其提交给服务器。例如，收集十分钟的数据并一次性发送。请记住，除了您已经发现的网络延迟限制之外，建立然后断开连接还会产生网络开销和电池寿命影响。因此，出于许多原因，最好在本地缓冲数据并在合理的间隔后发送缓冲区。

每次将数据发送到服务器时，请在 POST 请求中执行此操作。这种请求应该用于提交任何显着大小的数据，这也意味着如果您以后需要，可以使用 TLS 对数据进行加密。

# linux - 如何检测shell脚本的输出行号

> ID：13627186
> 
> 赞同：0
> 
> 时间：2012-11-29T13:45:47.827
> 
> 标签：linux, shell, unix

我正在使用以下脚本，

```
clear
tput cup 1
echo "1";
tput cup 2
echo "2";
tput cup 4
echo "3"; 
```

然后输出就像

```
1
2
3 
```

如果我使用错误的脚本，例如，

```
clear
tput cup 1
echo "1";
tput cup 2
echo ;"2";
tput cup 3
echo "3"; 
```

然后输出是

```
1

3/var.sh: line 5: 2: command not found 
```

这意味着在第三行 3 打印和 2 行错误也打印。那么有什么方法可以检测错误行号以在错误后打印 3 吗？

**编辑：**

当我使用 -x 时，输出是

```
[root@srinivas Installation]# sh -x  var.sh 
+ clear

+ tput cup 1
+ echo 1
+ echo
+ echo 3up 2
3 2
[root@srinivas Installation]#  found
+ tput cup 3 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T13:47:50.793

如果您使用该`-x`选项运行 shell 脚本，它会在执行时向您显示每一行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T14:50:47.620

这是因为标准输出和标准错误以不同的方式打印 - 标准输出是同步的，这意味着行将在它们到达时按顺序打印，而标准错误是异步的，这意味着它在终端可以容纳时打印。解决此问题的一种方法是将标准错误与标准输出一起分块：

```
/var.sh 2>&1 
```

[Greg 的 wiki](http://mywiki.wooledge.org/BashFAQ/106)中的更多详细信息。

PS：文件中的所有分号都是不必要的 - 如果您的命令由换行符分隔，则永远不需要分号。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-29T15:29:51.137

该输出看起来应该是预期的。这是顺序：

```
tput cup 1
echo "1" 
```

移动到第 1 行并输出 1。这可以正常工作。

```
tput cup 2
echo ;"2"; 
```

移到第 2 行，然后输出一个空行（`echo`不带参数），移到第 3 行。然后执行名为 的程序`2`，脚本找不到该程序，导致在第`./var.sh: line 5: 2: command not found`3 行打印错误消息。

```
tput cup 3
echo "3"; 
```

移动到第 3 行并输出 3，它会覆盖`.`上述错误消息中的。导致您注意到的最终明显输出，即使它不是按照严格的从左到右从上到下的顺序产生的。

# sql-server - Oracle 到 SQL Server 迁移：相当于 SQL Server 2008 中的 Oracle GROUP_ID() 函数

> ID：13627187
> 
> 赞同：0
> 
> 时间：2012-11-29T13:45:52.060
> 
> 标签：sql-server, oracle, sql-server-2008, migration

我正在寻找一种等效的方法：

**`HAVING (GROUP_ID()=0) -- ORACLE`**

在 SQL Server 2008 中。

谢谢 ：）

# asp.net-mvc - 分享 Orchard CMS 博客文章 - 覆盖模板

> ID：13627192
> 
> 赞同：1
> 
> 时间：2012-11-29T13:46:20.340
> 
> 标签：asp.net-mvc, razor, orchardcms

我正在使用 Orchard CMS 并希望能够显示共享链接（想想[AddThis.com](http://www.addthis.com)或[Shareaholic.com](http://www.shareaholic.com)）到网站上的博客文章。

在开始之前，我意识到 Orchard 库中已经存在类似的模块，但是 a，我无法使模块工作，b，我想进一步了解 Orchard。

我最初的想法只是添加一个新的博客小部件层并添加一个包含上述共享代码的新 HTML 小部件。这种方法的问题是；

1.  层规则将强制我的所有博客页面都必须位于某个公共 url 下，即使用类似于以下内容的层规则。不一定是坏事，但当客户发布新帖子时可能会错过一些事情。

    网址（“〜/博客*”）

2.  共享代码包含空的 html 锚元素，当我保存在 Orchard 编辑器中时，这些元素已从 html 中剥离。

我认为#2 取决于我的主题中使用的模板。我从 Bertrand Le Roy 的博客中阅读了一篇关于覆盖模板的文章，这让我开始思考。我可以直接覆盖 Orchard 博客模板并将共享代码放在那里吗？显然，这在未来不太可定制，但我对此很满意。在考虑 Orchard 性能和加载时间时，我还在考虑减少层、模块、小部件或其他任何可能不是坏事的东西。现在，无论网站上的每篇博客文章都在哪里，我都会有我的共享图标。

问题是在这种情况下我应该推翻什么观点？我尝试在 Modules\Orchard.Blogs\Views 中编辑博客视图，希望看到一些变化，但我什么也没得到。

人们会建议什么是最好的前进方式？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T15:49:04.760

恕我直言，最好的方法是将代码添加到两个（或两个）模板之一中：

1.  `Content-BlogPost.Summary.cshtml`当博客文章显示在列表中时（您可以从 复制代码`/Core/Contents/Views/Content.Summary.cshtml`）和
2.  `Content-BlogPost.Detail.cshtml`当博客文章显示在单独的页面中时（您可以从 复制代码`/Core/Contents/Views/Content.cshtml`）

# ios - Fresh SpeakHere 示例应用在 Simulator/Xcode 中录制音频时出错

> ID：13627193
> 
> 赞同：2
> 
> 时间：2012-11-29T13:46:21.150
> 
> 标签：ios, xcode, audio-recording

我无法使用 Apple 的[SpeakHere](http://developer.apple.com/library/ios/#samplecode/SpeakHere/Introduction/Intro.html)示例应用程序录制音频。当我在 Xcode 中的 Simulator 中运行应用程序时，它可以正常启动，但是当我按下录制按钮时，会出现错误“线程 1：EXC_BREAKPOINT (code=EXC_I386_BPT, subcode=0x0)”：![出现问题后的截图](../Images/6db64717f64ed0099a2311485579111f.png)

在发生上述错误之前，关于应用程序启动时缺少根视图控制器的日志消息已经存在，并且可能与我的问题无关。

我已经从链接的网站下载了 SpeakHere 示例项目（请参阅此问题的顶部），在 Xcode 中打开全新下载并直接启动应用程序。我没有修改任何设置，也没有修改任何代码行。我也在google和stackoverflow上搜索过这个问题，没有找到解决方案，虽然这个问题一定很笼统。

我使用 Xcode 版本 4.5.2 (4G2008a) 和 2009 年末的 MacBook Pro 和 Mac OS X 10.8。

我也有一个朋友在他的电脑上尝试过，他也遇到了同样的问题。他有相同的操作系统，他的 XCode 版本也是 4.5.2。

我现在会尝试较旧的 Xcode 版本，但现在我不喜欢下载几 GB 以在我的连接上进行试错法。

任何帮助表示赞赏，包括“适用于我的 Xcode 版本......”之类的报告。谢谢！

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-11-29T16:45:06.643

出现问题是因为在 method`AQRecorder::StartRecord(CFStringRef inRecordFile)`中，函数`CFURLCreateWithString()`失败并返回一个指向 nil 的指针。这没有被检测到，后来代码调用`CFRelease()`了这个 nil 指针，这导致了 EXC_BREAKPOINT。

该方法的目的`CFURLCreateWithString()`基本上是将 url 字符串作为输入并返回指向 CFURL 对象的指针作为输出。这里的问题是输入不是 url 字符串。相反，它只是本地文件系统上的路径，没有`file:/`或类似的前缀。因此，此方法失败。

解决方法是去掉对方法的无效调用`CFURLCreateWithString()`，转而调用相关方法，即`CFURLCreateWithFileSystemPath()`准备取本地文件系统路径并将其转换为 CFURL 的方法：

在方法`AQRecorder::StartRecord(CFStringRef inRecordFile)`中，替换或注释掉该行

```
url = CFURLCreateWithString(kCFAllocatorDefault, (CFStringRef)recordFile, NULL); 
```

并插入

```
url = CFURLCreateWithFileSystemPath(kCFAllocatorDefault, (CFStringRef)recordFile, kCFURLPOSIXPathStyle, false); 
```

在它的位置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T02:06:03.470

```
url = CFURLCreateWithFileSystemPath(kCFAllocatorDefault, (CFStringRef)recordFile, kCFURLPOSIXPathStyle, false); 
```

上面的代码使我的 xcoce 4.6 在模拟器中编译和运行，但它没有从我的 USB 麦克风录制我的声音，我在 garash band 应用程序中测试我的麦克风并成功录制和播放我的声音，dbmeter 根本不动，无论如何，当我将它移植到它工作的真实设备时，它都无法在我的模拟器中录制和播放语音。

# java - Java for android 局域网共享数据库

> ID：13627195
> 
> 赞同：0
> 
> 时间：2012-11-29T13:46:31.613
> 
> 标签：java, android, database, lan

您好，我一直在使用此[http://www.codeproject.com/Articles/155282/A-Complete-TCP-Server-Client-Communication-and-在 Visual Studio 2012 中通过我的 LAN 编写应用程序（客户端/服务器） RMI#ScsServerside](http://www.codeproject.com/Articles/155282/A-Complete-TCP-Server-Client-Communication-and-RMI#ScsServerside)作为客户端和服务器之间通信的基础。

现在我开始研究android开发和eclipse，我想知道java上是否有类似于这个框架的东西？如果不是，也许有人可以指出我通过 LAN 调用方法的方式，如果可能的话，不使用 tomcat 上的洞网络服务：pi 无法真正理解它是如何工作的，因为我打算出售应用程序，所以我不知道使用会产生什么影响这些组件带来了..而我正在研究的这个框架不需要任何东西..它只是运行应用程序（服务器），并在开放端口蚂蚁上的机器的IP地址上提供服务..任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T15:25:57.783

在您的问题中添加更多信息会很有用。例如：您在服务器上*接受哪种呼叫？*或者，换句话说，您使用的是什么协议？只是普通的旧 HTTP？RESTful HTTP？FTP？SSH？什么？

无论如何，您很可能不需要任何第三方框架来创建自己的 Android 客户端。Android 和 Java 已经为您提供了一个 HTTP 库和一个 HTTP 客户端，可用于与 HTTP 服务器进行通信。只需浏览文档。

如果您必须使用不同的协议，您很可能会找到可以在项目中使用的 Java 客户端/库。Java 拥有最大的即用型组件库，因此通常很容易找到可以解决您的问题的东西。

# javascript - 使用 JQuery 加载元素后如何调用方法？

> ID：13627196
> 
> 赞同：0
> 
> 时间：2012-11-29T13:46:42.357
> 
> 标签：javascript, jquery, fullcalendar

我需要`mymethod()`在日历加载时调用一个方法。在文档中我没有找到任何东西。最初我正在显示月视图并且没有事件。

显示日历后如何调用`mymethod()`..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T13:48:34.467

您想在所有内容加载后调用 mymethod 函数吗？如果是这样的话：

```
$(document).ready(function(){

// everything has loaded

function mymethod {

// function logic goes here

}

mymethod();

}); 
```

# php - 将sql文件导入sqlite数据库

> ID：13627197
> 
> 赞同：1
> 
> 时间：2012-11-29T13:46:48.263
> 
> 标签：php, sqlite, pdo

也许有类似的问题，但我没有找到用 php.ini 写的。

我有一个 sql 文件，我想将它导入 sqlite db。

```
$database = new PDO( 'sqlite:'.$tempdb );

if( $database->exec( $sql ) === false )
{
    die( print_r( $database->errorInfo(), true ) );
} 
```

SQL 示例：

```
INSERT INTO table (id,title) VALUES
(1,'title 1'), 
(2,'title 2'),
(3, 'more title'); 
```

回报：

```
Array ( [0] => HY000 [1] => 1 [2] => near ",": syntax error ) 
```

问题似乎是 sqlite`PDO::bindParams()`用于插入的事实。

有什么解决方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T09:29:12.620

`table`是关键字；您必须将其引用为`"table"`.

但假设您的实际表名不同：`INSERT`仅从 SQLite 3.7.11 开始支持使用一个命令插入多条记录；PHP 的内置 SQLite 可能较旧。

# java - 在java中读取ms word文档中的表格

> ID：13627198
> 
> 赞同：4
> 
> 时间：2012-11-29T13:46:51.027
> 
> 标签：java, apache-poi

嗨，我正在使用 Apache POI XWPF 阅读 word 文档，但我无法阅读 word 文档中的表格。任何帮助，将不胜感激 。提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T23:17:02.807

我还建议直接/或通过 poi 解析和更改 xml 文件。如果您将 docx 文件重命名为 zip 并解压缩，您可以执行全文搜索以找到正确的 xml 并发现要更改的 r'。

# visual-studio - VS 2010/2012 中未显示随附 XML 文档文件中的注释

> ID：13627207
> 
> 赞同：0
> 
> 时间：2012-11-29T13:47:15.600
> 
> 标签：visual-studio, dll, .net-assembly, xml-documentation

在某些时候，我们检测到来自 .NET 程序集（DLL 组件）的 XML 文档文件中的注释既没有显示在 VS 2010 中，也没有显示在 VS 2012 中。可能是什么原因？我们是否需要一些特殊设置（在注册表中等）才能使其正常工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T10:37:41.613

找到了为什么会这样。我们正在使用我们的内部工具为我们的产品生成 XML 文档文件——但不是等效的 C# 编译器功能（实际上是编译器的 /doc 开关）。我们的文档工具生成 Unicode 格式的 XML 注释文件，但令人惊讶的是 VS 2010/2012 没有处理它！既不是大端也不是小端。C# 编译器为我们提供了一个 ANSI XM 注释文件，它工作正常。

如果您不仅需要 ANSI 字符集怎么办？使用 UTF-8。我检查了这个——在 VS 中工作正常。

# php - PHP-购物车删除项目？

> ID：13627208
> 
> 赞同：0
> 
> 时间：2012-11-29T13:47:17.330
> 
> 标签：php, postgresql

我正在使用 PHP 和 PostgreSQL 创建购物车。我已经设法使用存储在数组中的参考号将商品放入购物车。我正在尝试通过允许用户单击复选框来创建删除功能（就像我在将商品添加到购物车时所做的那样）然后删除该商品，但它似乎所做的只是刷新页面和删除表。

到目前为止我的代码：

```
<form action="shoppingcart.php" method="post" style="width: 80%">
    <input type="submit" name="RemoveFromCart" value="Remove">

    <?php
    if(isset($_POST['itemsre']))
    {
        $n = count($_POST['itemsre']);
        for($i = 0; $i < $n; $i++)
        {

        }

        $items = array();
        foreach($_POST['itemsre'] as $item)
        {
            $items[] = pg_escape_string($con, $item);
        }

        if(!$_SESSION["deletingrows"])
        {

            $item_string = "'" . implode("','", $items) . "'";

            $result = pg_query($con, "SELECT title, platform, description, price FROM CSGames  WHERE refnumber IN ($item_string)");

            while($result)
            {
                unset($result);
            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T14:10:09.260

第一个烦恼：你应该关闭你的`<input>`标签，只是为了 XHTML。

```
<input type="submit" name="RemoveFromCart" value="Remove" /> 
```

我不确定这是做什么用的：

```
$n = count($_POST['itemsre']);
for($i = 0; $i < $n; $i++)
{

} 
```

它似乎在您的文件中未使用。同样，它不应该对问题产生太大影响，但它会在确实不需要代码的地方添加代码。

我认为问题最终在于：

```
while($result)
{
    unset($result);
} 
```

PHP`unset`基本上破坏了局部变量。这将运行一次，destroy `$result`，然后抛出一个 E_NOTICE 声明`$result`未定义。查看您的使用方式，您可能希望将查询更改为以下内容：

```
$result = pg_query($con, "DELETE FROM CSGames WHERE refnumber IN ($item_string)"); 
```

这将从您的 CSGames 表中删除，其中参考号在您的项目字符串中。但是，如果多个用户正在使用它，删除一个人的购物车项目可能会删除另一个人的购物车项目。您需要维护一个 cartID（如果用户不登录，可以将其设置为会话 ID，如果用户必须登录，则可以设置为用户 ID）。

因此，您的目标如下：

```
<form action="shoppingcart.php" method="post" style="width: 80%">
    <input type="submit" name="RemoveFromCart" value="Remove" />

    <?php
    if(isset($_POST['itemsre']))
    {

        $items = array();
        foreach($_POST['itemsre'] as $item)
        {
            $items[] = pg_escape_string($con, $item);
        }

        if(!$_SESSION["deletingrows"])
        {

            $item_string = "'" . implode("','", $items) . "'";
            $cartID = $_SESSION['userID']; // This must be changed to how you maintain unique users!
            $result = pg_query($con, "DELETE FROM CSGames WHERE cartID=$cartID AND refnumber IN ($item_string)");
        }
    } 
```

# jquery - 保存多个选择器的变量

> ID：13627213
> 
> 赞同：0
> 
> 时间：2012-11-29T13:47:31.043
> 
> 标签：jquery, variables

我有很多选择器，我需要在脚本中多次操作它们。

到目前为止，我已经这样做了：

```
var allSelectors3 = $('#icon20,#icon21,#icon22,#icon23,#icon24,#icon25,#icon26,#icon27,#icon28,#icon29,#icon30,#icon31,#icon32');
var allSelectors2 = $('#icon12,#icon13,#icon14,#icon15,#icon16,#icon17,#icon18,#icon19'); 
var allSelectors = $('#icon2,#icon3,#icon4,#icon5,#icon6,#icon7,#icon8,#icon9,#icon10,#icon11');

$(allSelectors).show();
$(allSelectors2, allSelectors3).hide(); 
```

这是最好的方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T13:50:16.670

不，不需要第二个`$()`。

```
var allSelectors = $('#icon20,#icon21,#icon22,#icon23,#icon24,#icon25,#icon26,#icon27,#icon28,#icon29,#icon30,#icon31,#icon32');
allSelectors.show() 
```

结合 2 个列表使用`.add`

```
allSelectors2.add(allSelectors3).hide(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T13:55:45.103

由于没有人提到**jQuery 性能规则**，这里是[性能规则](http://www.artzstudio.com/2009/04/jquery-performance-rules/)。

在变量中声明选择器很好（如果你有大量的选择器），我看到你做对了。

另一种选择是为 Selectors1 中的每个元素添加一个类`class="selector1"`，依此类推。然后使用：

```
$(".Selectors").show();
$(".Selectors2").hide();
$(".Selectors3").hide(); 
```

这看起来很漂亮，但是当您阅读性能规则时，按类和其他属性进行选择比较慢。

也不**需要第二个 $()**。直接使用这个：

```
var allSelectors3 = $('#icon20,#icon21,#icon22,#icon23,#icon24,#icon25,#icon26,#icon27,#icon28,#icon29,#icon30,#icon31,#icon32');
var allSelectors2 = $('#icon12,#icon13,#icon14,#icon15,#icon16,#icon17,#icon18,#icon19'); 
var allSelectors = $('#icon2,#icon3,#icon4,#icon5,#icon6,#icon7,#icon8,#icon9,#icon10,#icon11');

allSelectors.show();
allSelectors2.hide();
allSelectors3.hide(); 
```

# ajax - 如果 this.className.match Ajax 完成

> ID：13627214
> 
> 赞同：0
> 
> 时间：2012-11-29T13:47:34.320
> 
> 标签：ajax, jquery

我正在尝试确定用户是否单击了确认或拒绝链接。

如果确认...完成时：

```
idurl = '<?php echo $siteUrl ?>/profile.php?userid='+id+'';
if (idurl == window.location.href) {
     window.location = idurl;
} 
```

否则，如果拒绝：

```
parent.slideUp(300,function() {});
$('.friend-count').load('<?php echo $siteUrl ?>/friendrequestscount.php').fadeIn("fast"); 
```

以下脚本在没有以下情况下运行良好：

```
complete: function() {
        if (this.className.match("confirm")){ 
```

我如何检查它的confirmfriend.php 是否已经完成？

```
<script>
   $('.friendaction').click(function() {
       var id = this.getAttribute('data-userid');
       var requestto = this.getAttribute('data-requestto'),
       parent = $(this).closest("li"),
           url = this.className.match("confirm") 
              ? "confirmfriend.php" 
              : "removefriend.php", 
           liReference = $(this).parent();
       $.ajax(url + "?userid=" + id, {
           complete: function() {
            if (this.className.match("confirm")){
                      idurl = '<?php echo $siteUrl ?>/profile.php?userid='+id+'';
                      if (idurl == window.location.href) {
                          window.location = idurl;
                      }
            } else {
                    parent.slideUp(300,function() {});
                    $('.friend-count').load('<?php echo $siteUrl ?>/friendrequestscount.php').fadeIn("fast");
            }
           }
       });
   });
</script> 
```

提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T13:53:39.957

```
<script>
   $('.friendaction').click(function() {
       var id = this.getAttribute('data-userid');
       var requestto = this.getAttribute('data-requestto'),
       parent = $(this).closest("li"),
           url = this.className.match("confirm") 
              ? "confirmfriend.php" 
              : "removefriend.php", 
           liReference = $(this).parent();
       $.ajax(url + "?userid=" + id, {
           complete: function() {
            if (url == "confirmfriend.php"){
                      idurl = '<?php echo $siteUrl ?>/profile.php?userid='+id+'';
                      if (idurl == window.location.href) {
                          window.location = idurl;
                      }
            } else {
                    parent.slideUp(300,function() {});
                    $('.friend-count').load('<?php echo $siteUrl ?>/friendrequestscount.php').fadeIn("fast");
            }
           }
       });
   });
</script> 
```

# c - 我在 C 中的递归有什么问题？

> ID：13627215
> 
> 赞同：0
> 
> 时间：2012-11-29T13:47:39.273
> 
> 标签：c, function, recursion, combinations

我为我的作业编写了一个递归函数来进行以下计算：

对于输入：
`1 2 3 4`

它应该这样做:
`((1*3)+2) + ((1*4)+3) = 13`, 小于, `((2*4)+3) + ((1*4)+2) = 17`, 所以它返回 13。用字母它应该做这个计算:`((A*C)+B) + ((A*D)+C)`并将它与其他选项进行比较, 在这种情况下有 2 个选项: `((B*D)+C) + ((A*D)+C)`。

几句话。数字表示段每一端的“螺钉”数量。该段始终由 2 个数字组成。分段 A {1 2}、B {2 3}、C {3 4}。

任务是加入所有 N 个段。我必须找到“最便宜”的方法来做到这一点。每次我加入两个部分（例如 A 和 B）时，我都会这样做：

A 的“底部螺钉”（1 - 第一个数字）* B 的“顶部螺钉”（3 - 第三个数字）+“连接螺钉”（2 - 之间的数字）。

我必须按顺序加入它们，它总是必须以 ABCD 顺序结束。但我可以选择从哪里开始。我可以加入 A 到 B，然后 AB 到 C，或者我可以加入 B 到 C，然后 A 到 BC。基本上在其中一种情况下，“成本”将是最低的，这就是要返回的价值。

现在我已经这样做了，但我很困惑：

这`*help`是一个相互计算数组，我用它来存储递归中得到的新值。

```
int *help; 
```

这`*mezi`是一个动态分配的数组，定义为：

```
int *mezi; 
```

里面看起来像`{0,4,1,2,3,4,-1}`。

```
mezi[0] = here is stored the total prize in the recursion.

mezi[1] = here is stored the number of values in the array, 4 for 4 values (3 segments).

mezi[n+2] = the last number (-1), its just an identifier to find out the number of values. 
```

这是我的代码：

```
int findmin(int *mezi, int *pomocny)
{
    int i,j,k;
    int prize, prizemin, mini, minih;

    for (i=3;i<mezi[1];i++) {

        prize = mezi[i-1] * mezi[i+1] + mezi[i];
        if (i==3) { mini = i; minih = prize; }

        if (prize < minih) { mini = i; minih = prize; }

        if (mezi[1] > 3){

            k=2;
            for (j=2;j<mezi[1];j++) {
                if (j != mini) help[k] = mezi[j];
                k++;
            }
            help[1] = (mezi[1]-1);
        }
        help[0] += prize;

        findmin(help,help);
    }
    prizemin = help[0];

    return prizemin;
} 
```

我是个新手，不久前我开始使用 C，递归函数让我很困惑。我会感谢您的帮助。谢谢 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-01T06:45:40.250

您的程序逻辑存在很多问题。

```
int findmin(int *mezi, int *pomocny)
{
    int i,j,k;
    int prize, prizemin, mini, minih;

    for (i=3;i<mezi[1];i++) 
    {
        prize = mezi[i-1] * mezi[i+1] + mezi[i];
        if (i==3) { mini = i; minih = prize; } //This is a redundant test and 
        //initialization. i == 3 is true only in the first run of the loop. These
        //initialization should be done in the loop itself

        if (prize < minih) { mini = i; minih = prize; }

        if (mezi[1] > 3){  //This is also redundant as mezi[3] is always greater than 3 
        // otherwise the loop wont run as you check for this in your test expression

            k=2;
            for (j=2;j<mezi[1];j++) {
                if (j != mini) help[k] = mezi[j];
                k++;
            }
            help[1] = (mezi[1]-1);
        }
        help[0] += prize;

        //The only base case test you have is mezi[1]<3 which you should make sure is 
        // present in your data set

        findmin(help,help);
    }
    prizemin = help[0];

    return prizemin;
} 
```

# javascript - 检查 JavaScript 对象中是否存在值

> ID：13627221
> 
> 赞同：10
> 
> 时间：2012-11-29T13:47:58.467
> 
> 标签：javascript, jquery

如果存在特定项目（在我的情况下是 ID 为 2 的 MachineId），我将如何检查我的对象数组？

```
[{"MachineID":"1","SiteID":"20"},{"MachineID":"2","SiteID":"20"},{"MachineID":"3","SiteID":"20"},{"MachineID":"4","SiteID":"20"}] 
```

我试过这个：

```
if (index instanceof machineIds.MachineID) {
    alert('value is Array!');
} else {
    alert('Not an array');
} 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-11-29T13:51:25.250

在跨浏览器的方式中，您可以使用[`jQuery.grep()`](http://api.jquery.com/jQuery.grep/)它的方法：

```
var item = $.grep(machineIds, function(item) {
    return item.MachineID == index;
});

if (item.length) {
    alert("value is Array!");
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-29T13:49:38.183

最容易理解的解决方案是遍历数组，并检查每一个。

```
var match;
for (var i = 0; i < yourArray.length; i++) {
   if (yourArray[i].MachineId == 2) 
        match = yourArray[i];
} 
```

请注意，如果有多个匹配项，这将返回最后一个。您也可以在函数中修饰它。

```
function findByMachineId(ary, value) {
   var match;
    for (var i = 0; i < ary.length; i++) {
       if (ary[i].MachineId == value) 
            match = ary[i];
    }
    return match;
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-11-29T13:56:03.713

有许多**标准**解决方案，您不需要第三方库或迭代循环。

*   [数组`some`方法](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/some)- 从 JavaScript 1.6 开始。
*   [数组`find`方法](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/find)- 从 ES6 开始
*   [数组`findIndex`方法](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/findIndex)- 从 ES6 开始

例如，使用`some()`;

```
var yourArray = [{"MachineID":"1","SiteID":"20"},{"MachineID":"2","SiteID":"20"},{"MachineID":"3","SiteID":"20"},{"MachineID":"4","SiteID":"20"}];

var params = {searchedID: "2", elementFound: null};
var isCorrectMachineID = function(element) {
    if (element.MachineID == this.searchedID);
        return (this.elementFound = element);
    return false;
};

var isFound = yourArray.some(isCorrectMachineID, params) 
```

数组`some`方法接受两个参数：

*   callback - 测试每个元素的函数。
*   thisObject - 执行回调时用作 this 的对象。

回调函数不与迭代代码耦合，并且使用 thisObject 参数，您甚至可以向调用者返回找到的元素或更多数据。如果找到这样的元素，`some` **立即**返回 true

[http://jsfiddle.net/gu8Wq/1/](http://jsfiddle.net/gu8Wq/1/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-12-10T00:57:25.973

在这一点上的老问题，但这是一个使用[Array.find](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/find)的 ES6 解决方案：

```
let machine2 = machines.find((machine) => machine.id === '2');
if (machine2) {
    // ...
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-29T13:50:24.657

你可以使用这个条件：

```
if (arr.filter(function(v){return this.MachineID == 2;}).length > 0) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-09-06T11:48:31.367

```
var item = [{"MachineID":"1","SiteID":"20"},{"MachineID":"2","SiteID":"20"},{"MachineID":"3","SiteID":"20"},{"MachineID":"4","SiteID":"20"}];

var newItem = item.filter(function(i) {
  return i.MachineID == 2;  //it will return an object where MachineID matches with 2
});

console.log(newItem);  // will print [{"MachineID":"2","SiteID":"20"}] 
```

# backbone.js - 骨干事件和 Twitter 引导弹出窗口

> ID：13627230
> 
> 赞同：9
> 
> 时间：2012-11-29T13:48:42.770
> 
> 标签：backbone.js, twitter-bootstrap

在 twitter bootstrap popover 中插入主干渲染视图，如下所示。问题是当插入该视图的内容选项主干事件时不会触发。我在 div 中插入视图以进行测试，使用 $(selector).html admissionShow.render().el 事件可以正常工作。先感谢您

```
 attendance = new Attendance()
      attendance.url = "#{attendanceUrl}/#{attendanceId}" 
      attendance.fetch
        success: ->
          attendanceShow = new ExamAttendanceShow({model: attendance })
          currentTarget.popover
            html : true
            content: ->
              attendanceShow.render().el 
```

最好的问候，乔治。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T03:44:17.703

据我了解，根据您的代码和您的描述，您只是创建了弹出框的一个实例，但从未显示它。我有一个现场演示，但不能使用 CoffeeScript（我个人讨厌 CoffeeScript），你可以在下面和[这个 jsfiddle](http://jsfiddle.net/erickrdch/kgGwv/)看到代码。

数据1.json

```
{"content": "lorem ipsum dolor sit amet"} 
```

索引.html

```
<div class="container">
    <div class="row">
        <button class="btn" data-target="popover">Popover</button>
    </div>
    <div class="row">&nbsp;</div>
    <div class="row">
        <button class="btn" data-action="change-content">Change Content</button>
    </div>
</div> 
```

main.js

```
var Main = Backbone.View.extend({
    model: null,
    item: null,
    popover: false,

    events: {
        'click .btn[data-target]': 'button_click',
        'click .btn[data-action="change-content"]': 'change_content'
    },

    initialize: function() {
        _.bindAll(this);

        this.model = new PopoverModel();
        this.model.view = new PopoverContentView({model: this.model});

        this.item = this.$('.btn[data-target]');
        this.item.popover({
            html: true,
            content: this.model.view.render().el
        });
    },

    button_click: function(event) {
        if (!this.popover) {
            this.model.url = 'js/data1.json';
            this.model.fetch({
                success: this.model_fetched
            });
        } else {
            this.popover = false;
        }
    },

    model_fetched: function() {
        if (!this.popover) {
            this.item.popover('show');
        } else {
            this.item.popover('hide');
        }

        this.popover = !this.popover;
    },

    change_content: function(event) {
        this.model.set('content', 'Some random content... ' + parseInt(Math.random() * 10));
    }
});

var PopoverModel = Backbone.Model.extend({
    defaults: {
        content: ''
    }
});

var PopoverContentView = Backbone.View.extend({
    initialize: function() {
        _.bindAll(this);
        this.listenTo(this.model, 'change', this.render);
    },

    render: function() {
        this.$el.html(_.template('<%= content %>', this.model.toJSON()));
        return this;
    }
});

var main = new Main({
    el: '.container'
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-25T21:36:43.627

我有一个类似的问题，要扩展 Georgi 的答案，请试试这个：

在弹出窗口中放置一个按钮或链接（而不是放置的动态文本）并处理一个事件，比如点击事件。

# php - 用于双语网络的带有 IP 检查的 PHP DoubleEcho 突然停止工作

> ID：13627233
> 
> 赞同：0
> 
> 时间：2012-11-29T13:48:45.403
> 
> 标签：php

再会，

很抱歉给您带来麻烦，但我已经没有选择了。在我的网站上，在头部分的顶部，我有一个 PHP 代码，它定义（或定义）如果您从捷克或斯洛伐克连接（基于 IP 地址检查），您将获得捷克内容，其余 IP地址将获得英文内容。这是通过定义 DoubleEcho 函数的参数来完成的。它工作得很好，但是突然停止了。代码的基础是好的，我仍然可以手动切换内容，但自动选择不知何故崩溃了。我一直得到英文内容。拜托，如果你能看看下面的代码，我真的很高兴。非常感谢！

托尼·S。

```
<?php

// Language - URL check
if(isset($_GET['en']))
  $lang = 'en';
elseif (isset($_GET['cz']))
  $lang = 'cs';
// Language - IP check
else {
  $pc = gethostbyaddr($_SERVER["REMOTE_ADDR"]);
  $ext = array_pop(explode('.', $pc));
  if($ext == 'cz' OR $ext == 'sk')
    $lang = 'cs';
  else
    $lang = 'en';
}

    // Language - Echo function
function DoubleEcho($text_cs, $text_en)
{
  global $lang;
  if($lang == 'cs')
    echo $text_cs;
  else
    echo $text_en;
}
?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
        "http://www.w3.org/TR/2000/REC-xhtml1-20000126/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="<?php echo $lang; ?>" lang="<?php echo $lang; ?>">
 <head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-language" content="<?php echo $lang; ?>" /> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T13:52:24.823

如果他们通过代理或直接连接到负载平衡器，则 IP 地址不会改变。

此功能将让您了解在更多情况下检测 IP：

```
function getRemoteInfo () {
    $proxy="";
    $IP = "";
    if (isSet($_SERVER)) {
        if (isSet($_SERVER["HTTP_X_FORWARDED_FOR"])) {
            $IP = $_SERVER["HTTP_X_FORWARDED_FOR"];
            $proxy  = $_SERVER["REMOTE_ADDR"];
        } elseif (isSet($_SERVER["HTTP_CLIENT_IP"])) {
            $IP = $_SERVER["HTTP_CLIENT_IP"];
        } else {
            $IP = $_SERVER["REMOTE_ADDR"];
        }
    } else {
        if ( getenv( 'HTTP_X_FORWARDED_FOR' ) ) {
            $IP = getenv( 'HTTP_X_FORWARDED_FOR' );
            $proxy = getenv( 'REMOTE_ADDR' );
        } elseif ( getenv( 'HTTP_CLIENT_IP' ) ) {
            $IP = getenv( 'HTTP_CLIENT_IP' );
        } else {
            $IP = getenv( 'REMOTE_ADDR' );
        }
    }
    if (strstr($IP, ',')) {
        $ips = explode(',', $IP);
        $IP = $ips[0];
    }
    $RemoteInfo[0]=$IP;
    $RemoteInfo[1]=@GetHostByAddr($IP);
    $RemoteInfo[2]=$proxy;
    return $RemoteInfo;
} 
```

而且，如果您想花哨的话，我编写了一个在城市级别上运行的快速 c++ geoip 守护程序。他们也有一个免费的国家层面，以同样的方式运作。

[https://github.com/homer6/geoipd](https://github.com/homer6/geoipd)

# log4j - Log4j：多个记录器、级别和附加程序

> ID：13627235
> 
> 赞同：48
> 
> 时间：2012-11-29T13:48:51.953
> 
> 标签：log4j

使用 log4j 写入多个日志文件时，我遇到了重复日志消息的问题。

目前，我正在尝试在我的文件中`INFO`记录名为**foobar**`foo.log`的特定记录器的级别数据（及以上） ，然后为文件中的**所有记录器记录**`WARN`所有级别的日志消息（及以上）。**`bar.log`**

 **结果，重复的日志消息被写入`foo.log`文件（每行记录两次），经过一些快速研究，我发现解决这个问题的建议是添加`log4j.additivity.foobar=false`到我的属性文件中。

这样做的问题是，尽管它停止了重复的行，但`WARN`来自**foobar**记录器的消息永远不会写入`bar.log`文件。

**我的 log4j 属性文件如下：**

```
log4j.rootLogger = WARN, FOO, BAR
log4j.logger.foobar = INFO, FOO
log4j.additivity.foobar = false

log4j.appender.FOO = org.apache.log4j.RollingFileAppender
log4j.appender.FOO.layout = org.apache.log4j.PatternLayout
log4j.appender.FOO.layout.ConversionPattern = %d{ISO8601} %-5p %c ~ %m%n
log4j.appender.FOO.File = foo.log

log4j.appender.BAR = org.apache.log4j.RollingFileAppender
log4j.appender.BAR.layout = org.apache.log4j.PatternLayout
log4j.appender.BAR.layout.ConversionPattern = %d{ISO8601} %-5p %c ~ %m%n
log4j.appender.BAR.File = bar.log 
```

有谁知道我如何将日志消息写入两个日志文件（就像我开始设置`additivity`属性之前所做的那样）并且仍然防止重复的日志消息？

*请注意，这是对问题的简化摘要。在现实世界的场景中，有多个记录器和两个以上的日志文件*

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2012-11-29T15:28:37.807

这个问题可以分两部分来解决。

**1.防止重复的日志消息**

日志消息被写入两次，因为我们在**rootLogger**和**log4j.logger.foobar**类别中都列出了**FOO** appender 。所以我们必须移除 appender 并且只在 category 中定义日志级别：

 ****```
log4j.rootLogger = WARN, FOO, BAR
log4j.logger.foobar = INFO 
```

这意味着来自**log4j.logger.foobar的****INFO**级别消息将向上传播到**rootLogger**中的**附加程序**的所有记录器，但只会写入每个日志文件一次。

 ********2.防止INFO级别消息写入bar.log**

由于**log4j.logger.foobar**类别的所有 INFO 级别日志消息都由 rootLogger 中的 appender 继承，因此**我们**需要停止`BAR`appender 以记录**INFO**级别消息。

我们可以通过设置**BAR** appender 本身的**Threshold**属性来实现这一点：

 **```
log4j.appender.BAR.Threshold = WARN 
```

这将防止在**bar.log文件中记录****INFO**级别的语句，因为它只接受**WARN**及更高级别。

 ******所以完整的 log4j 属性文件如下：**

```
log4j.rootLogger = WARN, FOO, BAR
log4j.logger.foobar = INFO

log4j.appender.FOO = org.apache.log4j.RollingFileAppender
log4j.appender.FOO.layout = org.apache.log4j.PatternLayout
log4j.appender.FOO.layout.ConversionPattern = %d{ISO8601} %-5p %c ~ %m%n
log4j.appender.FOO.File = foo.log
log4j.appender.FOO.Threshold = INFO

log4j.appender.BAR = org.apache.log4j.RollingFileAppender
log4j.appender.BAR.layout = org.apache.log4j.PatternLayout
log4j.appender.BAR.layout.ConversionPattern = %d{ISO8601} %-5p %c ~ %m%n
log4j.appender.BAR.File = bar.log
log4j.appender.BAR.Threshold = WARN 
```******************

# libraries - Java：如何打开一个库？

> ID：13627237
> 
> 赞同：0
> 
> 时间：2012-11-29T13:48:54.967
> 
> 标签：libraries, java

我想打开库，因为目前我想查看用于绘图的算法，修改它们并在我的程序中实现它们。例如：我尝试自己为线条创建一个算法。但我失败了。即使我成功了，我担心它可能不会给出与库中的算法相同的结果。我不希望这种情况发生。这就是为什么我想复制用于库中方法的算法。我真的希望这将帮助我创建我目前正在使用的应用程序以及将来与其他应用程序一起使用。

我试图用代码编辑器打开库。但是我很难找到这些库——我真的不知道它们放在哪里，也不知道它们的代码存储在哪些文件中。

如何打开一个Java库？或者网上有没有上传代码的地方？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-29T13:56:25.340

听起来您想要的是进入标准 Java 库（这样您就可以看到类似方法的代码`Graphics.drawLine()`）。

如果您使用的是 Windows 或 Linux，您可以从获得 JDK 的同一位置下载源文件。对于 Mac，请参阅[此问题](https://stackoverflow.com/questions/2767220/is-there-a-src-jar-in-osx)。您甚至可以设置 Eclipse，以便您可以调试该源代码，就好像它是您自己的代码一样。

但是，您可能不会在这些库中找到 Java 中的线条绘制代码 - Graphics 实现几乎肯定会使用本机方法，并且可能只是调用操作系统中的现有方法。

如果您专门寻找线条绘制算法，另一种选择是查看 Wikipedia 页面的[Bresenham](http://en.wikipedia.org/wiki/Bresenham%27s_line_algorithm)（锯齿）或[Wu](http://en.wikipedia.org/wiki/Xiaolin_Wu%27s_line_algorithm)（抗锯齿）算法。

**编辑：**

Graphics2D 调用中实际将像素放在屏幕上的部分可能在系统调用内部，因此源将不可用。

像[Batik](http://xmlgraphics.apache.org/batik/)这样的 java 矢量图形库可能有其中一些算法的源代码，但可能依赖于大多数算法的 Graphics2D 调用。因此，您可能会寻找用 Java 以外的语言编写的综合矢量图形库，其中这些图形调用默认情况下尚不存在。

或者，检查[计算机图形书籍](http://books.google.com/books/about/Computer_Graphics_Algorithms.html?id=_4WzSQAACAAJ)的目录可能会指出您可以在 Wikipedia 上查找的各种算法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-29T14:01:20.920

对于任何给定的库：

### 确保在使用他人代码时遵守所有许可

*   如果你指的是 Java SDK 源代码，你可以在这里找到它：http: [//grepcode.com/](http://grepcode.com/)
*   如果项目是开源的，通常可以从项目网站获取源代码。没问题，但请确保遵守他们的许可。
*   如果该项目不是开源的，那么你在pickle许可方面是明智的，所以我不认可这一点，但是，你需要使用Java反编译器，比如[JD-Gui](http://java.decompiler.free.fr/?q=jdgui)

* * *

至于要使用什么绘图算法，有很多不同的算法（显然，人们多年来一直在尝试快速绘图），最好的办法是弄清楚你需要做什么，然后搜索特定的需要分开。除了维基百科之外，实际上并没有一个很好的存储库。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-29T13:59:01.187

如果您正在使用它们在您的类路径中的库。查看如何在您使用的任何 IDE 中找出您的类路径，您可以找到您所依赖的 JAR。如果它们与源打包在一起，您只需解压缩它们并查看源。

如果您无权访问源代码，则可以使用[Java Decompiler](http://java.decompiler.free.fr/)获取代码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-29T14:03:39.747

如果您正在尝试查看标准 Java 库，请参阅有关将源代码获取到 JDK 的其他答案。

如果您对开源库（例如由 Apache 项目维护的东西）感兴趣，请在项目站点上查找可以使用标准 zip 实用程序打开的“源 jar”。

如果你想要的库不是开源的或者你找不到它的源代码，你可以尝试反编译它。如果您使用的是 Eclipse，请试试[这个反编译器](http://java.decompiler.free.fr/)。

# html - 在工作灯中使用带有 Dojomobile 和 phonegap 的 android 后退按钮

> ID：13627242
> 
> 赞同：2
> 
> 时间：2012-11-29T13:49:19.977
> 
> 标签：html, css, cordova, ibm-mobilefirst, dojox.mobile

我正在使用 Worklight 创建一个应用程序（相当大的一个）。当我在安卓手机中测试应用程序并按下后退按钮时，它会关闭应用程序..现在我希望它返回一页。现在页面导航是用 dojox 移动实现的系统。这边走：

```
<button data-dojo-type="dojox.mobile.ToolBarButton" data-dojo-props="transition:'fade',dir:'1',moveTo:'Contact'" class="buttonHem" style="color:black; font-size:1em;">Kontakta Oss</button> 
```

有没有办法使用android后退按钮而不必重做所有事情？

我们有两周的最后期限，所以真的没有时间用 jquery mobile 重做应用程序..

答案将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T14:37:22.367

后退按钮功能应该可以在 Dojo Mobile 中使用。查看 ToolBarButton 的文档，我认为您需要做的是在下一个视图前面使用 # 来表示 moveTo 属性。在您的示例中，它将是 moveTo:'#Contact' 查看以下文档中的 moveTo 属性以获取更多信息。

[http://dojotoolkit.org/reference-guide/1.8/dojox/mobile/ToolBarButton.html](http://dojotoolkit.org/reference-guide/1.8/dojox/mobile/ToolBarButton.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-29T15:57:15.477

如果您谈论的是硬件 Android 后退按钮，那么您有一个 WL API 来覆盖它的行为。WL.App.overrideBackButton(function() { doSomething }); 和 WL.App.resetBackButton();

# database - Grails/GORM 域保存 - 瞬态对象解决方法

> ID：13627243
> 
> 赞同：3
> 
> 时间：2012-11-29T13:49:21.760
> 
> 标签：database, grails, grails-orm

我找到了解决我遇到的问题的方法，我想知道它是否有效。这是一个类似的问题：[Grails Gorm : Object references an unsaved transient instance](https://stackoverflow.com/questions/4810574/grails-gorm-object-references-an-unsaved-transient-instance)

假设我有两个域对象（更改名称以保护有罪者）。

```
public class Shelf {
    String name
    Set<Book> books = [] as Set

    static hasMany = [books: Book]
} 
```

和

```
public class Book {
    String title
    Shelf shelf
} 
```

所以这意味着 1 Shelf 包含 0 到许多 Books，而一本书只能在一个 Shelf 上。

这个架子很大。在某个时候，它包含 80,000 本书。都很好地存储在数据库中。当然，添加新书越来越慢。

这是通过以下方式完成的：

```
 Book book1 = new Book("Awesome Title")
  existingShelf.addToBooks(book1)
  existingShelf.save(flush: true)      // super slow 
```

这很慢。主要是（我假设）因为 GORM 必须确认其他 80,000 条记录。

所以我这样做是为了尝试解决慢点。

```
 Book book2 = new Book("Awesome Title 2")
  book2.save(flush: true) 
```

这给了我一个“对象引用了一个未保存的瞬态实例”，我想这是有道理的——“架子”值是空的。

所以我做了一些有点奇怪的事情：

```
 Book book3 = new Book("Awesome Title 3")
  book3.shelf = new Shelf()
  book3.shelf.id = <known/valid id here>
  book2.save(flush: true) 
```

这行得通。它节省。没有参考错误。取决于此的进一步代码......有效。我只是在最后几分钟打了一个电话，然后把它缩短到几秒钟。但这似乎太容易了。我确信我在某种程度上围绕着 Grails 魔法工作。并且可能在此过程中破坏了某些东西。

建议？解释？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-29T15:52:46.230

是的，使用 addTo* 方法可能会很慢。如果您查看生成的 SQL，您就会明白为什么。执行以下操作：

```
new Book(title: "GORM Performance", shelf: grailsShelf).save() 
```

会更快，并且在技术上没有任何问题。请注意，在您从数据库中刷新集合之前，您的 grailsS​​helf.books 实例不会包含新书。这是 addTo* 方法为您所做的一部分。

边注：

```
Set<Book> books = [] as Set 
```

是不必要的。

# qt - Qt mp3 文件到数据流

> ID：13627246
> 
> 赞同：0
> 
> 时间：2012-11-29T13:49:23.967
> 
> 标签：qt, stream, qt4, phonon, qtcpsocket

`QDataStream`我的主要目标是使用,`QTcpServer`和.通过网络发送 mp3 文件`QTcpSocket`。但我已将这项任务分解成更小的部分。首先，我需要将 mp3 文件转换为正确的格式，以便它可以“输入”到数据流中。

我应该如何做到这一点？我认为这将是最容易使用 Phonon 的？但`MediaObject`似乎没有提供某种`getData`方法。

任何有关我应该如何做的帮助将不胜感激。如果需要，我可以对此进行更多解释。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T11:18:42.587

没有“正确的格式”。此外，您的问题不是 MP3 特有的。您对所有文件执行相同操作，无论它们包含何种数据。您打开文件，从中读取字节并发送这些字节，直到没有任何东西可以发送。

你不需要 Phonon 或任何与 MP3 相关的东西。您只需要打开文件并从中读取字节。`write()`然后，您使用 QTcpSocket 对象的函数将这些字节写入套接字。您甚至不需要 QDataStream，因为您只处理不需要解析的数据。

# jvectormap - jvectormap 自定义美国地图

> ID：13627248
> 
> 赞同：1
> 
> 时间：2012-11-29T13:49:29.187
> 
> 标签：jvectormap

我们正在使用 jquery-jvectormap-us-aea-en.js 文件来显示 JVectorMap 美国地图。要求是我们需要显示北加利福尼亚和南加利福尼亚来代替加利福尼亚。我在哪里可以找到相同的 Jvectormap 坐标。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T12:01:16.290

您可以通过以下两种方式之一进行操作：

1.  获取或生成包含北加州和南加州的美国地图/shapefile，然后`.JS`使用生成文件`Converter.py`
2.  这将是一项手动工作，但由于您只需要为一个州做这件事，您就可以做到。即，在`js`文件中创建加利福尼亚的副本，将旧副本称为北加利福尼亚，将新副本称为南加利福尼亚，并读取/修改`Path`属性以使其工作。

# asp.net - 如何通过网络表单将部分 HTML 代码提交到 SQL Server 数据库？

> ID：13627250
> 
> 赞同：0
> 
> 时间：2012-11-29T13:49:29.723
> 
> 标签：asp.net

我有这张简单的桌子。其中一个字段称为**Content**，带有**Nvarchar(max)**。

如果我使用 SQL Server Management 直接在数据库中编辑该字段，并在下面添加以下文本，它会很好地存储它。

文本：

```
Do you open the menu at a restaurant ever expanding multi-cultural tourist hub, Chinatown has a lot to offer to meet your culinary desires, from China and beyond.<br /></br>This tour will be the first in a series the food. 
```

但是，如果我尝试使用 ASPX 页面 webform 将上面相同的文本提交到数据库，我会收到下面的错误，我假设是因为 2`<br />`代码

> 从客户端检测到一个潜在危险的 Request.Form 值（tbTourDetails="...nd 超出。
> 此游览..."）。

我怎样才能解决这个问题，以便我可以有一个将部分 HTML 提交到我的数据库的 web 表单？

敬茶

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T14:06:54.953

由于您尝试存储 html 代码，因此需要将 requestValidationMode="2.0" 添加到 web.config 的 httpRuntime 配置部分。

```
<httpRuntime requestValidationMode="2.0" /> 
```

现在在存储之前对其进行编码：

```
String TestString = "This is a <Test String>.";
String EncodedString = Server.HtmlEncode(TestString); 
```

并对其进行解码以显示为文本：

```
Label1.Text = HttpUtility.HtmlDecode(dbValue); 
```

**参考：** [HtmlEncode 方法](http://msdn.microsoft.com/en-us/library/w3te6wfz.aspx) [HtmlEncode、HtmlDecode](http://www.dotnetperls.com/htmlencode-htmldecode)

# java - java.io.RandomAccessFile 可扩展性（或其他选项）

> ID：13627257
> 
> 赞同：5
> 
> 时间：2012-11-29T13:49:56.117
> 
> 标签：java, multithreading, io

我正在编写一些 Java 代码，这些代码最终将在应用服务器中用于访问一些非常大的文件（超过 1GB，低于 20GB），这些文件可能托管在 NFS 共享上。为单个请求提供服务将涉及执行以下操作：

1.  找到我需要阅读的大文件
2.  导航到该文件中的随机点
3.  从该文件中读取字节（通常小于 1MB）
4.  返回那些字节

我现在有一些简单的 POC 代码，它只是打开一个新的只读文件并关闭它：

```
RandomAccessFile raf=new RandomAccessFile(myFileName, "r");
try{
   byte[] buffer = new byte[size];
   raf.seek(position);
   raf.reafFully(buffer);
   return buffer;
}
finally{
   raf.close();
} 
```

我想知道这是否是一种优雅简单的方法，应该可以很好地工作，还是一种愚蠢的简单方法，在重负载下会出现很多问题（也许我需要建立一个线程安全的读者池等）。显然测试这个假设是最好的，但我想知道这两种方法是否有任何最佳实践或已知问题。到目前为止，我还无法弄清楚谷歌搜索...

谢谢！

PS。目前尚不清楚最终版本是托管在 Windows 还是 *nix 上。也不清楚如何共享大文件。聚苯乙烯。应用服务器可能配置在集群中，因此两个不同的应用服务器可能需要同时读取同一个大型共享文件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T15:54:48.910

另一种选择是java NIO，即FileChannel。FileChannel 也是可导航的，它可能比 RandomAccessFile 更快，因为它可以使用所谓的直接缓冲区。它有一些更有趣的特性，例如它是可中断的。

# yii - Yii框架上的JQRelcopy中如何添加CJuiDatePicker

> ID：13627261
> 
> 赞同：10
> 
> 时间：2012-11-29T13:50:03.750
> 
> 标签：yii, yii-extensions, yii-components, yii1.x, yii-events

Yii 框架上的模块 JQRelcopy 中的 CJuiDatePicker 有问题。

我使用这个模块，因为我有一个带有日期选择器字段的表单，可以根据用户的意愿多次复制。

如果我放置一个普通字段（没有 datepicker），该模块可以正常工作，但是一旦我添加模块 CJuiDatePicker 这也是 Yii 框架的一个模块，我就会出现一个空白页面。我遵循了以下教程：[http](http://www.yiiframework.com/extension/jqrelcopy/) : //www.yiiframework.com/extension/jqrelcopy/ 以包含 CJuiDatePickerm 的形式解释了集成 jqrelcopy，这正是我所需要的。

我研究了这个问题，我发现当我在我的小部件 JQRelcopy 的属性中添加以下行时，就会出现问题：

> 'jsAfterNewId' => JQRelcopy::afterNewIdDatePicker($datePickerConfig),

在

> $this->widget('ext.jqrelcopy.JQRelcopy', 数组(
> 
> ```
>  'id' => 'copylink',
>   'removeText' => 'remove',
> 
>   //add the datapicker functionality to the cloned datepicker with the same options
>   'jsAfterNewId' => JQRelcopy::afterNewIdDatePicker($datePickerConfig), 
> ```
> 
> ));

我查看了几个论坛以及任何与我有相同问题的人。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-06-30T09:56:00.427

只需在顶部的表单文件中导入 ext.jqrelcopy.JQRelcopy

```
Yii::import('ext.jqrelcopy.JQRelcopy'); 
```

如果有任何问题让我知道我会进一步协助，您的问题将得到解决。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T22:35:40.960

过去我能做到这一点的唯一方法是放弃 CJuiDatePicker 并使用 JQuery 的[on](http://api.jquery.com/on/)方法。

```
$('body').on('focus', '.idata', function(){
        jQuery(this).datepicker(
            jQuery.extend(
                {showMonthAfterYear:false},
                jQuery.datepicker.regional['pt-BR'],
                {'showAnim':'fold','dateFormat':'dd/mm/yy'}
            )
        );
    }); 
```

或者，您可以使用实时方法...

# sql-server - 如何选择一个列，它是同一个表中两列的串联？

> ID：13627263
> 
> 赞同：1
> 
> 时间：2012-11-29T13:43:36.737
> 
> 标签：sql-server, sql-server-2008, subquery

Column`fieldid`是`EmpId`和的串联`Reason`。有时，由于代码逻辑编写不当，可能会发生连接不正确的情况，并且它使用了`EmpId`与当前记录不同的连接。

我如何找出这些错误的记录？

我已经尝试过了，但不必停留，它很愚蠢。

```
SELECT * FROM Table WHERE fieldid IN (SELECT Empid + Reason FROM EmployeeAttendance) 
```

我正在使用 SQL SERVER 2008\. `Empid`，`Reason`并且`fieldid`是 varchars。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T14:54:30.867

对于 SQL 服务器：

```
SELECT * 
FROM TableX 
WHERE fieldid <> Empid + Reason 
   OR fieldid IS NULL     AND (Empid + Reason) IS NOT NULL
   OR fieldid IS NOT NULL AND (Empid + Reason) IS NULL ; 
```

# xaml - Gridview滚动口吃

> ID：13627268
> 
> 赞同：4
> 
> 时间：2012-11-29T13:50:26.040
> 
> 标签：xaml, gridview, windows-8, visual-studio-2012

我一直在尝试使用 Windows 8 和 Visual Studio 2012 express，但我无法实现我的目标。

我一直在尝试创建一个水平扩展的瓷砖网格（就像“开始”屏幕一样）。
这些项目是在运行时添加的，虽然水平滚动有效，但还不够好。
使用我的触摸板时，它似乎会夹在某些东西上，在平板电脑上这会感觉很迟钝。
用光标滚动似乎很好。

我想知道如何通过使用 XAML 给它一个流畅的体验，不幸的是我不太擅长它（还）。

XAML：（堆栈面板应该没有意义，但我正在试验）

```
<Grid Background="White" ScrollViewer.HorizontalScrollBarVisibility="Visible">
    <Grid.RowDefinitions>
        <RowDefinition Height="19*"/>
        <RowDefinition Height="109*"/>
    </Grid.RowDefinitions>
    <StackPanel x:Name="stackPanel1" HorizontalAlignment="Left" Height="622" Margin="97,93,0,0" VerticalAlignment="Top" Width="0" Orientation="Horizontal" Grid.RowSpan="2"/>
    <GridView x:Name="gridView1" ItemTemplate="{StaticResource Standard250x250ItemTemplate}" Margin="0,0,0,0" Background="Red" Grid.Row="1" ScrollViewer.HorizontalScrollBarVisibility="Hidden"/>
    <Image HorizontalAlignment="Left" Height="90" Margin="1206,11,0,0" VerticalAlignment="Top" Width="106" Source="Assets/SmallLogo.png"/>
</Grid> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T07:34:42.090

不是 100% 确定这是否是您面临的问题，但也许它有帮助：默认情况下`ItemsTemplatePanel`， GridView 的`VirtualizingStackPanel`. 如果您的 GridView 中没有很多项目，则 GridView 的滚动确实看起来很卡顿。

尝试将 设置`ItemsPanelTemplate`为 a`StackPanel`而不是`VirtualizingStackPanel`（除非您坚持让控件 GridView 虚拟化其项目）。

```
<GridView.ItemsPanel>
<ItemsPanelTemplate>
    <StackPanel Width="Auto" 
            HorizontalAlignment="Left" 
            Orientation="Horizontal" />
</ItemsPanelTemplate>
</GridView.ItemsPanel> 
```

希望这可以帮助！

# asp.net-mvc - 如何使用 Automapper 正确映射？

> ID：13627269
> 
> 赞同：1
> 
> 时间：2012-11-29T13:50:38.003
> 
> 标签：asp.net-mvc, asp.net-mvc-4, castle-windsor, automapper, automapper-2

我正在开发一个使用来自 Nuget 的 Automapper、工作单元、实体框架 5、ASPNET MVC 4、WebApi 和 Windsor Castle 的应用程序。

我不确定是否应该映射它或者它应该由 Automapper 自动映射

```
public IEnumerable<StoreDto> Get()
{
    return Uow.Stores.GetAll().OrderBy(s => s.Name);
} 
```

`Uow.Stores.GetAll().OrderBy(s => s.Name)`返回一个`IOrderedQueryable<Store>`.

我收到错误消息

> *无法将表达式类型 IOrderedQueryable 转换为类型 IEnumerable*

我应该做一个 foreach 并将每个返回的对象转换`GetAll`为Automapper`StoreDto`的方法吗？`Mapper.Map`Automapper 不会为我转换它吗？

这就是我使用 Automapper 以及注册它的方式。请让我知道是否应该/可以改进。

`AutomapperInstaller.cs`：

```
 public class AutoMapperInstaller : IWindsorInstaller
    {
        public void Install(IWindsorContainer container, IConfigurationStore store)
        {
            Mapper.Initialize(x => x.ConstructServicesUsing(container.Resolve));

            RegisterProfilesAndResolvers(container);
            RegisterMapperEngine(container);
        }

        private void RegisterMapperEngine(IWindsorContainer container)
        {
            container.Register(Component.For<IMappingEngine>().Instance(Mapper.Engine));
        }

        private void RegisterProfilesAndResolvers(IWindsorContainer container)
        {
            // register value resolvers
            container.Register(AllTypes.FromAssembly(Assembly.GetExecutingAssembly()).BasedOn<IValueResolver>());

            // register profiles
            container.Register(AllTypes.FromThisAssembly().BasedOn<Profile>());
            var profiles = container.ResolveAll<Profile>();

            foreach (var profile in profiles)
            {
                Mapper.AddProfile(profile);
            }
        } 
```

`WebWindsorInstaller`：

```
internal class WebWindsorInstaller : IWindsorInstaller
    {
        public void Install(IWindsorContainer container, IConfigurationStore store)
        {
            container.Register(Component
                .For<RepositoryFactories>()
                .ImplementedBy<RepositoryFactories>()
                .LifestyleSingleton());

            container.Register(Component
                .For<IRepositoryProvider>()
                .ImplementedBy<RepositoryProvider>()
                .LifestylePerWebRequest());

            container.Register(Component
                .For<IProjUow>()
                .ImplementedBy<ProjUow>()
                .LifestylePerWebRequest());

            container.Register(Classes
                .FromAssemblyContaining<Api.StoresController>()
                .BasedOn<IHttpController>()
                .If(t => t.Name.EndsWith("Controller"))
                .LifestylePerWebRequest());

            RegisterMapping(container, store);
        }

        private void RegisterMapping(IWindsorContainer container, IConfigurationStore store)
        {
            Mapper.CreateMap<Store, StoreDto>();
        }
} 
```

`Store.cs`：

```
public class Store
    {
        public Store()
        {
            this.Branches = new List<Branch>();
        }

        public int Id { get; set; }
        public string Name { get; set; }
        public System.Data.Spatial.DbGeography Location{ get; set; }

        public virtual ICollection<Branch> Branches{ get; set; }
    } 
```

`StoreDto.cs`（现在和商店一样）

```
public class StoreDto
    {
        public StoreDto()
        {
            this.Branches = new List<BranchDto>();
        }

        public int Id { get; set; }
        public string Name { get; set; }
        public System.Data.Spatial.DbGeography Location{ get; set; }

        public virtual ICollection<BranchDto> Branches{ get; set; }
    } 
```

这就是我调用安装程序的方式`IocConfig.cs`：

```
Container = new WindsorContainer()
                .Install(new AutoMapperInstaller())
                .Install(new ControllersInstaller()); 
```

我不确定我是否应该包括在内

```
.AddFacility<FactorySupportFacility>() 
```

# php - Display remote text file on php page

> ID：13627273
> 
> 赞同：0
> 
> 时间：2012-11-29T13:50:54.690
> 
> 标签：php

I'm using this code now to display a text file on a php/html page.

```
<?php
foreach (glob("example.txt") as $filename) {
    echo nl2br(file_get_contents($filename));
    echo "<br></br>";
}
?> 
```

I'm looking for a way to display the example.txt file from another server with URI.

Something like this: [http://address.com/dir/example.txt](http://address.com/dir/example.txt)

Is there a simple way to do this?

(I would use an iframe but it's not possible to style the text without Java or JQuery).

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T13:55:58.223

You could just use

```
file_get_contents('http://address.com/dir/example.txt'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T13:53:34.900

You will have to use [CURL](http://php.net/manual/en/book.curl.php) to fetch the content of the file first and then display it.

Another option is to use iframes and set the target of iframe to the desired text file.

Yet another option is to use ajax to fetch the content from client end as suggested in comment.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-29T13:56:02.683

Check [`fopen()`](http://www.php.net/manual/en/function.fopen.php) / [`fread()`](http://www.php.net/manual/en/function.fread.php) and your available [transport wrappers](http://www.php.net/manual/en/wrappers.php).

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-29T14:03:39.030

**For normal length text file you can use:**

```
 <?PHP
 $file = fopen("http://www.xyz.com/textfile.txt", "rb");
 $output = fread($file, 8192);
 fclose($file);
 echo($output);
 echo "<br>";
 ?> 
```

**For longer files:**

```
 <?PHP
 $file = fopen("http://www.xyz.com/textfile.txt", "rb");
 $output = '';
 while (!feof($file)) {
 $output .= fread($file, 8192);
 }
 fclose($file);
 echo($output);
 echo "<br>";
 ?> 
```

It will prevent packet exceed issues in longer files by concatenating the file together in several groupings using while loop

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-29T14:07:53.593

You code is totally wrong

```
 foreach (glob("example.txt") as $filename) {
                    ^------------------------- searching for a file 
```

They can only one `example.txt` file in a folder at a time except you want to get all text files should should be like this in the first place

```
 foreach (glob("*.txt") as $filename) { 
```

If that is not the case the code would work for both remote and local file

```
error_reporting(E_ALL);
ini_set("display_errors", "on");
$fileName = "example.txt" ; // or http://oursite.com/example.txt 
echo nl2br(file_get_contents($fileName));
echo "<br></br>"; 
```

# python - 分析趋势并发现异常行为

> ID：13627275
> 
> 赞同：0
> 
> 时间：2012-11-29T13:51:01.543
> 
> 标签：python, mysql, database, analytics

我正在创建一个用于记录传感器数据的系统。（只是一串数字）

我希望能够将系统置于“学习”模式几天，这样它就可以看到它的“正常”操作值是什么，并且一旦超出这个范围，任何偏离此行为的任何偏差都超过了某个点可以标记。数据全部存储在 MySQL 数据库中。

欢迎任何有关如何执行此操作的建议，以及进一步阅读该主题的位置。

我最好使用 python 来完成这项任务。

在白天访问和使用的温度控制区域中每 5 分钟的数据温度和湿度值。这意味着它在使用时会有波动和一些温度变化。但是需要检测与此不同的任何东西，例如冷却或加热系统故障

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T11:23:10.520

本质上，您应该关注的是[密度估计](http://en.wikipedia.org/wiki/Density_estimation)：确定某些变量如何表现的模型的任务，以便您可以寻找与它的偏差。

这是一些*非常*简单的示例代码。我假设温度和湿度在其未转换的尺度上具有独立的正态分布：

```
import numpy as np
from matplotlib.mlab import normpdf
from itertools import izip

class TempAndHumidityModel(object):
    def __init__(self):
        self.tempMu=0
        self.tempSigma=1
        self.humidityMu=0
        self.humiditySigma=1

    def setParams(self, tempMeasurements, humidityMeasurements, quantile):
        self.tempMu=np.mean(tempMeasurements)
        self.tempSigma=np.std(tempMeasurements)
        self.humidityMu=np.mean(humidityMeasurements)
        self.humiditySigma=np.std(humidityMeasurements)

        if not 0 < quantile <= 1:
            raise ValueError("Quantile for threshold must be between 0 and 1")

        self._thresholdDensity(quantile, tempMeasurements, humidityMeasurements)

    def _thresholdDensity(self, quantile, tempMeasurements, humidityMeasurements):
        tempDensities = np.apply_along_axis(
            lambda x: normpdf(x, self.tempMu, self.tempSigma),0,tempMeasurements)
        humidityDensities = np.apply_along_axis(
            lambda x: normpdf(x, self.humidityMu, self.humiditySigma),0,humidityMeasurements)

        densities = sorted(tempDensities * humidityDensities, reverse=True)
        #Here comes the massive oversimplification: just choose the
        #density value at the quantile*length position, and use this as the threshold
        self.threshold = densities[int(np.round(quantile*len(densities)))]

    def probOfObservation(self, temp, humidity):
        return normpdf(temp, self.tempMu, self.tempSigma) * \
               normpdf(humidity, self.humidityMu, self.humiditySigma)

    def isNormalMeasurement(self, temp, humidity):
        return self.probOfObservation(temp, humidity) > self.threshold

if __name__ == '__main__':
    #Create some simulated data
    temps = np.random.randn(100)*10 + 50
    humidities = np.random.randn(100)*2 + 10

    thm = TempAndHumidityModel()
    #going to hard code in the 95% threshold
    thm.setParams(temps, humidities, 0.95) 

    #Create some new data from same dist and see how many false positives
    newTemps = np.random.randn(100)*10 + 50
    newHumidities = np.random.randn(100)*2 + 10

    numFalseAlarms = sum(~thm.isNormalMeasurement(t,h) for t,h in izip(newTemps,newHumidities))
    print '{} false alarms!'.format(numFalseAlarms)

    #Now create some abnormal data: mean temp drops to 20
    lowTemps = np.random.randn(100)*10 + 20
    normalHumidities = np.random.randn(100)*2 + 10

    numDetections = sum(~thm.isNormalMeasurement(t,h) for t,h in izip(lowTemps,normalHumidities))
    print '{} abnormal measurements flagged'.format(numDetections) 
```

示例输出：

```
>> 3 false alarms!
>> 77 abnormal measurements flagged 
```

现在，我不知道正态性假设是否适合您的数据（您可能希望将数据转换为不同的比例，以便它适合）；假设温度和湿度之间的独立性可能非常不准确；并且我用来查找与请求的分布分位数相对应的密度值的技巧应该被使用分布的逆 CDF 的东西代替。但是，这应该让您了解该做什么。

另外请注意，有许多很好的非参数密度估计器：[核密度估计器](http://en.wikipedia.org/wiki/Kernel_density_estimation)立即浮现在脑海。如果您的数据看起来不像任何标准分布，这些可能更合适。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T14:11:34.470

您似乎正在尝试执行[异常检测](http://en.wikipedia.org/wiki/Anomaly_detection)，但您对数据的描述含糊不清。通常，您应该首先尝试定义/限制数据“正常”的含义。

1.  每个传感器是否有不同的“正常”？
2.  传感器测量是否以某种方式依赖于它之前的测量？
3.  “正常”会在一天内发生变化吗？
4.  传感器的“正常”测量值能否用统计模型来表征（例如，数据是高斯正态还是对数正态）？

回答完这些类型的问题后，您可以使用数据库中的一批数据训练分类器或异常检测器，并使用结果来评估未来的日志输出。如果机器学习算法适用于您的数据，您可以考虑使用[scikit-learn](http://scikit-learn.org/stable/)。对于统计模型，您可以使用[SciPy](http://www.scipy.org/)`stats`的子包。当然，对于 Python 中的任何类型的数值数据操作，[NumPy](http://numpy.scipy.org/)都是您的朋友。

# jpa - JPA 1.9 中的 Varchar 到 int 类型转换

> ID：13627276
> 
> 赞同：1
> 
> 时间：2012-11-29T13:51:04.070
> 
> 标签：jpa, jpql

我想在 jpql 中将 varchar 转换为 int。该字段是 varchar，但所有数据都将仅采用整数格式。我的 JPA 库版本是 1.9

我已经使用了 CAST 和 CONVERT 方法，但是没有用。

我的查询是：

```
select SUM(Cast(model.wagonsRequired as INT)) from IptRailcargolines model where model.iptRailwayindent.id=7 
```

或者

```
select SUM(CONVERT(INT, model.wagonsRequired)) from IptRailcargolines model where model.iptRailwayindent.id=7 
```

我的java控制台错误是：

```
Caused by: Exception [TOPLINK-8025] (Oracle TopLink Essentials - 2.0 (Build b40-rc (03/21/2007))): oracle.toplink.essentials.exceptions.EJBQLException
Exception Description: Syntax error parsing the query [select SUM(FUNCTION(CONVERT(INT, model.wagonsRequired))) from IptRailcargolines model where model.iptRailwayindent.id=:headId], line 1, column 20: unexpected token [(].
Internal Exception: line 1:20: unexpected token: ( 
```

请帮我解决问题。

感谢你的回复...

我正在使用 MyEclipse IDE。所以，可能在内部它会使用 Eclipselink。你能告诉我在哪里可以找到我的 EclipseLink 版本吗？以及如何在我的 JPA 查询中使用 FUNC / FUNCTION 方法。（我使用的是 SQLSERVER 2008。）

我想我在 myeclipse 中找到了 eclipseLink 版本。Windows > 首选项 > JPA

版本是 1.0

请告诉我解决方案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T14:41:40.680

CAST 和 CONVERT 不是 JPA 的一部分（1.0 或 2.0，并且没有 1.9）。

您似乎正在使用 EclipseLink，但也没有 1.9 版本。EclipseLink 2.4 支持这些函数，以前 (2.3) 您可以使用 FUNC 运算符调用数据库函数，或使用本机 SQL 查询。

# c# - 无法复制文件“C:\...\packages\...WebApi.Core.4.0.20710.0...System.Web.Http.dll”

> ID：13627278
> 
> 赞同：1
> 
> 时间：2012-11-29T13:51:10.817
> 
> 标签：c#, asp.net-mvc, visual-studio-2010, dll

我正在使用 ASP.Net MVC4，在构建应用程序时出现以下错误：

**无法将文件“C:\Visual Studio 2010\Projects\Dia\packages\Microsoft.AspNet.WebApi.Core.4.0.20710.0\lib\net40\System.Web.Http.dll”复制到“bin\System.Web. Http.dll”。拒绝访问路径“bin\System.Web.Http.dll”。**

我不明白这个错误在开发中是什么新的。试图用谷歌搜索，但似乎没有匹配项。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-29T13:56:41.247

1.  关闭VS。
2.  解决方案中每个项目的删除`bin`和`obj`目录（主要是构建错误的项目）。
3.  在 VS 中打开解决方案。
4.  清洁溶液。
5.  重建

# android - Android：从麦克风记录分贝

> ID：13627284
> 
> 赞同：0
> 
> 时间：2012-11-29T13:51:38.977
> 
> 标签：android, microphone, spl, decibel

我在 Android 中实现此功能时遇到问题...我只需要输出从麦克风重新录制的分贝，这是我无法理解的事情：

```
public class Noise extends Activity{
@Override
protected void onCreate(Bundle savedInstanceState){
    super.onCreate(savedInstanceState);
    MediaRecorder recorder=new MediaRecorder();
    recorder.setAudioSource(MediaRecorder.AudioSource.MIC);
    Timer timer=new Timer();
    timer.scheduleAtFixedRate(new RecorderTask(recorder), 0, 500);
}
private class RecorderTask extends TimerTask{
    TextView risultato=(TextView) findViewById(R.id.risultato_recorder);
    private MediaRecorder recorder;
    public RecorderTask(MediaRecorder recorder){
        this.recorder = recorder;
    }
    public void run(){
        risultato.setText(""+recorder.getMaxAmplitude());
    }
}
} 
```

在textview中，只打印第一次的结果，结果为0，然后app crash with: 11-29 14:43:27.133: E/AndroidRuntime(25785): android.view.ViewRoot$CalledFromWrongThreadException: Only the创建视图层次结构的原始线程可以触及其视图。

我四处搜索，但我找不到一个全面的例子......只有很多我不需要的东西和类的例子。我可以解决这个问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T13:55:20.397

UI 组件只能从 UI 线程修改。

您的任务在后台线程中运行，因此您需要强制`TextView`在 UI 线程中完成更新。您可以使用该`Activity.runOnUiThread`方法实现它。

试试这个：

```
public void run(){
    runOnUiThread(new Runnable() {
        @Override
        public void run() {
            risultato.setText("" + recorder.getMaxAmplitude());
        }
    });
} 
```

代替

```
public void run(){
    risultato.setText(""+recorder.getMaxAmplitude());
} 
```

# c - va_arg(argp, float) 正在崩溃

> ID：13627289
> 
> 赞同：2
> 
> 时间：2012-11-29T13:52:04.880
> 
> 标签：c, avr-gcc

我正在尝试编写自定义 printf 函数。

```
void debug_print(const char *fmt, ...)
{
    const char *p;
    va_list argp;
    int i;
    double f;
    char *s;
    char fmtbuf[80];

    va_start(argp, fmt);

    for(p = fmt; *p != '\0'; p++)
    {
        if(*p != '%')
        {
            uart_putchar(*p);
            continue;
        }

        switch(*++p)
        {
            case 'c':
                        ...
            break;

            case 'f':
            f = va_arg(argp, float); // ??????
            s = dtostrf(f, 10, 6, fmtbuf);
            uart_puts(s);
            break;

...
// then in the main part of the program
debug_print("%f", 123.456); 
```

当程序到达 f = va_arg(argp, float) 时，它永远不会从该行返回。如果我将其更改为 f = va_arg(argp, double) 它返回 0。

在设备（ATMega328P）和 Atmel Studio 6 模拟器上都试过，结果相同。

听起来像是与链接器选项有关？

**更新：**

现在只需要找出为什么`va_arg(argp, double)`返回 0。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T13:53:09.397

当您`float`在变量参数列表中传递 a 时，编译器会将其隐式提升为 a `double`。因此，您必须使用`va_arg(argp, double)`它从变量参数列表中获取它。

当您尝试将参数作为 a 获取时`float`，则

> `type`与实际下一个参数的类型不兼容（根据默认参数提升）[并且]行为未定义

（标准 §7.16.1.1，`va_arg`宏。根据 §6.2.7，`float`不`double`兼容。）

# c# - 通过比较两个数据表来避免重复值

> ID：13627292
> 
> 赞同：-1
> 
> 时间：2012-11-29T13:52:15.243
> 
> 标签：c#, datatable, duplicate-data

> **可能重复：**
> [比较两个数据表并获取重复值](https://stackoverflow.com/questions/13626900/comparing-two-datatable-and-getting-the-duplicate-values)

我有两个 DataTable t1 和 t2。

```
t1 has 2 fields (SPARTE_ID, SPARTE both as string)

t2 has 2 fields (sparte_id, sparte both as string)

all rows (value) of SPARTE(of t1) is null

I have to bring values from t2 (if sparte_id == SPARTE_ID) and update t1. 
```

我可以轻松完成所有这些。

但问题是，我必须找出 t2 是否有超过 1 个具有不同 sparte 值的相同 sparte_id。如果我得到这样的东西，我不能在这个 SPARTE_ID 上更新 t1 的 SPARTE 字段，并且必须列出这些 sparte_id 和那里的 sparte。

如果有人能告诉我如何在这种情况下获得值，我会很高兴？我在 .NetFramework 3.5 上使用 VS-2010。

**它们都不是主键或唯一键。

**如果你有什么不明白的请问我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T14:20:31.360

这是一种查找模棱两可的 ID-Sparte 组合的方法：

```
var t2IdDups = t2.AsEnumerable()
    .GroupBy(r => r.Field<string>("SPARTE_ID"))
    .Where(g => g.Count() > 1);
var t2Ambiguous = t2IdDups
    .Where(g =>
        g.Any(r =>
            r.Field<string>("SPARTE") != g.First().Field<string>("SPARTE")))
    .Select(g => new
    {
        SparteID = g.Key,
        Spartes = string.Join(",", g.Select(r => r.Field<string>("SPARTE")))
    });
foreach (var x in t2Ambiguous)
    Console.WriteLine("ambiguous ID={0} Spartes={1}"
        , x.SparteID, x.Spartes); 
```

# ruby-on-rails - Rails Carrierwave 头像更新验证

> ID：13627294
> 
> 赞同：0
> 
> 时间：2012-11-29T13:52:15.753
> 
> 标签：ruby-on-rails, ruby-on-rails-3, validation, upload, carrierwave

我在使用 Carrierwave gem 上传头像时遇到了一个奇怪的问题。头像只是用户个人资料中的一列。

如果之前没有上传头像 - 所有验证（至少存在验证）都可以正常工作。

但是，如果上传了头像，并且用户想要更新它（上传新头像） - 那么由于某些未知原因，位于 Profile 模型中的所有验证都将被完全**跳过**。

已安装的上传器（AvatarUploader）中的验证正在工作，但（一直）

所有的代码几乎都是默认的，所以，甚至没有理由在这里写。

有谁知道，如何解决这个问题？:(

# .htaccess - Modrewrite 到 lighttpd，AIS：自适应图像样式

> ID：13627301
> 
> 赞同：1
> 
> 时间：2012-11-29T13:52:51.360
> 
> 标签：.htaccess, mod-rewrite, drupal-7, lighttpd

我有以下.htaccess：

```
# AIS: Adaptive Image Style
  RewriteBase /
  RewriteCond %{REQUEST_URI} ^(.+)/files/styles/adaptive/(.+)$
  RewriteCond %{REQUEST_URI} !/modules/image/sample.png
  RewriteCond %{HTTP_COOKIE} ais=([a-z0-9-_]+)
  RewriteRule ^(.+)/files/styles/adaptive/(.+)$ $1/files/styles/%1/$2[R=302,L] 
```

如何将其转换为 lighttpd？

# python - 在 PyDev 中查看函数文档字符串的热键？

> ID：13627307
> 
> 赞同：3
> 
> 时间：2012-11-29T13:53:12.720
> 
> 标签：python, eclipse, user-interface, pydev, docstring

在 PyDev 中，当光标悬停在函数名称上时，会出现带有文档字符串文本的工具提示。

有没有办法为此事件分配一个热键，以便仅使用键盘查看文档字符串？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-30T23:41:47.483

据我所知，在使用 PyDev 时没有直接的键盘快捷键。对于 JDT，CDT 或 PDT`F2`应该可以工作，但在 PyDev 中不行。

但是，作为替代方案，您可以点击`CTRL`+`SPACE`来调出内容辅助，它会在旁边显示文档。

顺便说一句：悬停工具提示不仅显示文档字符串，还显示方法的全部内容。

以下是内容辅助的外观：

[![在此处输入图像描述](../Images/a648326469a0799a2c702a02896a1da8.png)](https://i.stack.imgur.com/FYfMG.png)

[python](/questions/tagged/python "显示标记为“python”的问题") [pydev](/questions/tagged/pydev "显示标记为“pydev”的问题") [eclipse](/questions/tagged/eclipse "显示标记为“日食”的问题")[键盘快捷键](/questions/tagged/keyboard-shortcuts "显示标记为“键盘快捷键”的问题")[docstring](/questions/tagged/docstring "显示标记为“文档字符串”的问题")

# javascript - 给数字添加 st、nd、rd 和 th（序数）后缀

> ID：13627308
> 
> 赞同：213
> 
> 时间：2012-11-29T13:53:13.727
> 
> 标签：javascript, jquery, numbers

我想根据当天动态生成一串文本。因此，例如，如果是第 1 天，那么我希望我的代码生成 =“Its the <dynamic>1*<dynamic string> *st* </dynamic string>*</dynamic>”。

总共有 12 天，所以我做了以下工作：

1.  我已经设置了一个循环 12 天的 for 循环。

2.  在我的 html 中，我给了我的元素一个唯一的 id 来定位它，见下文：

    ```
    <h1 id="dynamicTitle" class="CustomFont leftHeading shadow">On The <span></span> <em>of rest of generic text</em></h1> 
    ```

3.  然后，在我的 for 循环中，我有以下代码：

    ```
    $("#dynamicTitle span").html(i);
    var day = i;
    if (day == 1) {
        day = i + "st";
    } else if (day == 2) {
        day = i + "nd"
    } else if (day == 3) {
        day = i + "rd"
    } 
    ```

*更新*

这是请求的整个 for 循环：

```
$(document).ready(function () {
    for (i = 1; i <= 12; i++) {
        var classy = "";
        if (daysTilDate(i + 19) > 0) {
            classy = "future";
            $("#Day" + i).addClass(classy);
            $("#mainHeading").html("");
            $("#title").html("");
            $("#description").html("");
        } else if (daysTilDate(i + 19) < 0) {
            classy = "past";
            $("#Day" + i).addClass(classy);
            $("#title").html("");
            $("#description").html("");
            $("#mainHeading").html("");
            $(".cta").css('display', 'none');
            $("#Day" + i + " .prizeLink").attr("href", "" + i + ".html");
        } else {
            classy = "current";
            $("#Day" + i).addClass(classy);
            $("#title").html(headings[i - 1]);
            $("#description").html(descriptions[i - 1]);
            $(".cta").css('display', 'block');
            $("#dynamicImage").attr("src", ".." + i + ".jpg");
            $("#mainHeading").html("");
            $(".claimPrize").attr("href", "" + i + ".html");
            $("#dynamicTitle span").html(i);
            var day = i;
            if (day == 1) {
                day = i + "st";
            } else if (day == 2) {
                day = i + "nd"
            } else if (day == 3) {
                day = i + "rd"
            } else if (day) {
            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：451
> 
> 时间：2012-11-29T14:09:18.343

[规则](http://en.wikipedia.org/wiki/Ordinal_indicator#English)如下：

> *   st 与以 1 结尾的数字一起使用（例如 1st，首先发音）
> *   nd 用于以 2 结尾的数字（例如 92nd，发音为 90 秒）
> *   rd 用于以 3 结尾的数字（例如 33rd，发音为 33）
> *   作为上述规则的例外，所有以 11、12 或 13 结尾的“青少年”数字都使用 -th（例如，11th，发音为 11th，112th，发音为 100 [and] 12th）
> *   th 用于所有其他数字（例如 9th，发音为 9th）。

以下 JavaScript 代码（在 2014 年 6 月重写）实现了这一点：

```
function ordinal_suffix_of(i) {
    var j = i % 10,
        k = i % 100;
    if (j == 1 && k != 11) {
        return i + "st";
    }
    if (j == 2 && k != 12) {
        return i + "nd";
    }
    if (j == 3 && k != 13) {
        return i + "rd";
    }
    return i + "th";
} 
```

0-115 之间数字的示例输出：

```
 0  0th
  1  1st
  2  2nd
  3  3rd
  4  4th
  5  5th
  6  6th
  7  7th
  8  8th
  9  9th
 10  10th
 11  11th
 12  12th
 13  13th
 14  14th
 15  15th
 16  16th
 17  17th
 18  18th
 19  19th
 20  20th
 21  21st
 22  22nd
 23  23rd
 24  24th
 25  25th
 26  26th
 27  27th
 28  28th
 29  29th
 30  30th
 31  31st
 32  32nd
 33  33rd
 34  34th
 35  35th
 36  36th
 37  37th
 38  38th
 39  39th
 40  40th
 41  41st
 42  42nd
 43  43rd
 44  44th
 45  45th
 46  46th
 47  47th
 48  48th
 49  49th
 50  50th
 51  51st
 52  52nd
 53  53rd
 54  54th
 55  55th
 56  56th
 57  57th
 58  58th
 59  59th
 60  60th
 61  61st
 62  62nd
 63  63rd
 64  64th
 65  65th
 66  66th
 67  67th
 68  68th
 69  69th
 70  70th
 71  71st
 72  72nd
 73  73rd
 74  74th
 75  75th
 76  76th
 77  77th
 78  78th
 79  79th
 80  80th
 81  81st
 82  82nd
 83  83rd
 84  84th
 85  85th
 86  86th
 87  87th
 88  88th
 89  89th
 90  90th
 91  91st
 92  92nd
 93  93rd
 94  94th
 95  95th
 96  96th
 97  97th
 98  98th
 99  99th
100  100th
101  101st
102  102nd
103  103rd
104  104th
105  105th
106  106th
107  107th
108  108th
109  109th
110  110th
111  111th
112  112th
113  113th
114  114th
115  115th 
```

* * *

## 回答 #2

> 赞同：236
> 
> 时间：2015-07-24T16:38:16.473

从[Shopify](https://ecommerce.shopify.com/c/ecommerce-design/t/ordinal-number-in-javascript-1st-2nd-3rd-4th-29259)

```
function getNumberWithOrdinal(n) {
  var s = ["th", "st", "nd", "rd"],
      v = n % 100;
  return n + (s[(v - 20) % 10] || s[v] || s[0]);
}

[-4,-1,0,1,2,3,4,10,11,12,13,14,20,21,22,100,101,111].forEach(
  n => console.log(n + ' -> ' + getNumberWithOrdinal(n))
);
```

* * *

## 回答 #3

> 赞同：87
> 
> 时间：2016-09-13T09:15:25.203

### 序数后缀的最小单行方法

```
function nth(n){return["st","nd","rd"][((n+90)%100-10)%10-1]||"th"} 
```

（这是用于正整数，其他变化见下文）

### 解释

从带有后缀的数组开始`["st", "nd", "rd"]`。我们希望将以 1、2、3（但不以 11、12、13 结尾）结尾的整数映射到索引 0、1、2。

其他整数（包括以 11、12、13 结尾的整数）可以映射到其他任何东西——在数组中找不到的索引将评估为`undefined`. 这在 javascript 中是错误的，并且使用逻辑或 ( `|| "th"`) 表达式将返回`"th"`这些整数，这正是我们想要的。

表达式`((n + 90) % 100 - 10) % 10 - 1`进行映射。分解它：

*   `(n + 90) % 100`：此表达式采用输入整数 - 10 mod 100，映射 10 到 0，... 99 到 89，0 到 90，...，9 到 99。现在以 11、12、13 结尾的整数位于较低的位置结束（映射到 1、2、3）。
*   `- 10`：现在 10 映射到 -10、19 到 -1、99 到 79、0 到 80、... 9 到 89。以 11、12、13 结尾的整数映射到负整数（-9、-8、 -7)。
*   `% 10`：现在所有以 1、2 或 3 结尾的整数都映射到 1、2、3。所有其他整数都映射到其他东西（11、12、13 仍然映射到 -9、-8、-7）。
*   `- 1`: 减一给出 1, 2, 3 到 0, 1, 2 的最终映射。

### 验证它是否有效

```
function nth(n){return["st","nd","rd"][((n+90)%100-10)%10-1]||"th"}

//test integers from 1 to 124
for(var r = [], i = 1; i < 125; i++) r.push(i + nth(i));

//output result
document.getElementById('result').innerHTML = r.join('<br>');
```

```
<div id="result"></div>
```

### 变化

允许负整数：

```
function nth(n){return["st","nd","rd"][(((n<0?-n:n)+90)%100-10)%10-1]||"th"} 
```

```
function nth(n){return["st","nd","rd"][(((n<0?-n:n)+90)%100-10)%10-1]||"th"}

//test integers from 15 to -124
for(var r = [], i = 15; i > -125; i--) r.push(i + nth(i));

//output result
document.getElementById('result').innerHTML = r.join('<br>');
```

```
<div id="result"></div>
```

在 ES6 粗箭头语法（匿名函数）中：

```
n=>["st","nd","rd"][(((n<0?-n:n)+90)%100-10)%10-1]||"th" 
```

### 更新

正整数的一个更短的替代方法是表达式

```
[,'st','nd','rd'][n%100>>3^1&&n%10]||'th' 
```

请参阅[此帖子](https://codegolf.stackexchange.com/a/119563/69032)以获取说明。

### 更新 2

```
[,'st','nd','rd'][n/10%10^1&&n%10]||'th' 
```

* * *

## 回答 #4

> 赞同：48
> 
> 时间：2019-08-16T03:50:44.903

# `Intl.PluralRules`，*标准*方法。

我只想在这里放弃这样做的规范方式，因为似乎没有人知道它。

如果你希望你的代码是

*   自我记录
*   易于本地化
*   符合现代标准

——**这是要走的路。**

```
const english_ordinal_rules = new Intl.PluralRules("en", {type: "ordinal"});
const suffixes = {
    one: "st",
    two: "nd",
    few: "rd",
    other: "th"
};
function ordinal(number) {
    const suffix = suffixes[english_ordinal_rules.select(number)];
    return (number + suffix);
}

const test = Array(201)
    .fill()
    .map((_, index) => index - 100)
    .map(ordinal)
    .join(" ");
console.log(test);
```

*   [构造`Intl.PluralRules`函数（ECMA-402 草案）](https://tc39.es/ecma402/#sec-intl-pluralrules-constructor)
*   [Unicode 的六个复数类别](http://cldr.unicode.org/index/cldr-spec/plural-rules)

* * *

## 回答 #5

> 赞同：19
> 
> 时间：2019-10-23T15:10:40.860

您可以使用[矩库本地数据功能](https://momentjs.com/docs/#/i18n/locale-data/)。

**代码：**

```
moment.localeData().ordinal(1)
//1st 
```

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2013-08-17T13:44:46.990

通过将数字拆分为数组并反转，我们可以使用`array[0]`和轻松检查数字的最后 2 位数字`array[1]`。

如果一个数字是十几岁`array[1] = 1` ，它需要“th”。

```
function getDaySuffix(num)
{
    var array = ("" + num).split("").reverse(); // E.g. 123 = array("3","2","1")

    if (array[1] != "1") { // Number is not in the teens
        switch (array[0]) {
            case "1": return "st";
            case "2": return "nd";
            case "3": return "rd";
        }
    }

    return "th";
} 
```

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2012-11-29T14:09:22.290

你只有12天？我很想把它变成一个简单的查找数组：

```
var suffixes = ['','st','nd','rd','th','th','th','th','th','th','th','th','th']; 
```

然后

```
var i = 2;
var day = i + suffixes[i]; // result: '2nd' 
```

或者

```
var i = 8;
var day = i + suffixes[i]; // result: '8th' 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2014-05-14T06:29:26.017

```
function getSuffix(n) {return n < 11 || n > 13 ? ['st', 'nd', 'rd', 'th'][Math.min((n - 1) % 10, 3)] : 'th'} 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2013-09-20T11:39:00.843

我写了这个函数来解决这个问题：

```
// this is for adding the ordinal suffix, turning 1, 2 and 3 into 1st, 2nd and 3rd
Number.prototype.addSuffix=function(){
    var n=this.toString().split('.')[0];
    var lastDigits=n.substring(n.length-2);
    //add exception just for 11, 12 and 13
    if(lastDigits==='11' || lastDigits==='12' || lastDigits==='13'){
        return this+'th';
    }
    switch(n.substring(n.length-1)){
        case '1': return this+'st';
        case '2': return this+'nd';
        case '3': return this+'rd';
        default : return this+'th';
    }
}; 
```

有了这个，您可以`.addSuffix()`输入任何数字，它会产生您想要的结果。例如：

```
var number=1234;
console.log(number.addSuffix());
// console will show: 1234th 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2017-02-07T21:52:59.920

序数函数的替代版本可能如下：

```
function toCardinal(num) {
    var ones = num % 10;
    var tens = num % 100;

    if (tens < 11 || tens > 13) {
        switch (ones) {
            case 1:
                return num + "st";
            case 2:
                return num + "nd";
            case 3:
                return num + "rd";
        }
    }

    return num + "th";
} 
```

变量命名更明确，使用驼峰式约定，并且可能更快。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2021-07-01T04:41:39.153

```
const getOrdinalNum = (n) => n + (n > 0 ? ['th', 'st', 'nd', 'rd'][(n > 3 && n < 21) || n % 10 > 3 ? 0 : n % 10] : ''); 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2013-07-24T15:11:35.717

前几天我写了这个简单的函数。尽管对于某个日期您不需要更大的数字，但这也可以满足更高的值（1013th、36021st 等......）

```
var fGetSuffix = function(nPos){

    var sSuffix = "";

    switch (nPos % 10){
        case 1:
            sSuffix = (nPos % 100 === 11) ? "th" : "st";
            break;
        case 2:
            sSuffix = (nPos % 100 === 12) ? "th" : "nd";
            break;
        case 3:
            sSuffix = (nPos % 100 === 13) ? "th" : "rd";
            break;
        default:
            sSuffix = "th";
            break;
    }

    return sSuffix;
}; 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2013-09-27T00:28:37.503

`function ordsfx(a){return["th","st","nd","rd"][(a=~~(a<0?-a:a)%100)>10&&a<14||(a%=10)>3?0:a]}`

[请参阅https://gist.github.com/furf/986113#file-annotated-js](https://gist.github.com/furf/986113#file-annotated-js)上的注释版本

短小精悍且高效，就像实用函数应该具备的那样。适用于任何有符号/无符号整数/浮点数。（即使我无法想象需要对浮点数进行排序）

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2018-08-31T23:17:33.280

强烈推荐优秀的[date-fns](https://date-fns.org/)库。快速、模块化、不可变，适用于标准日期。

```
import * as DateFns from 'date-fns';

const ordinalInt = DateFns.format(someInt, 'do'); 
```

请参阅 date-fns 文档：[https ://date-fns.org/v2.0.0-alpha.9/docs/format](https://date-fns.org/v2.0.0-alpha.9/docs/format)

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2016-12-17T02:34:42.920

这是另一种选择。

```
function getOrdinalSuffix(day) {

   	if(/^[2-3]?1$/.test(day)){
   		return 'st';
   	} else if(/^[2-3]?2$/.test(day)){
   		return 'nd';
   	} else if(/^[2-3]?3$/.test(day)){
   		return 'rd';
   	} else {
   		return 'th';
   	}

}

console.log(getOrdinalSuffix('1'));
console.log(getOrdinalSuffix('13'));
console.log(getOrdinalSuffix('22'));
console.log(getOrdinalSuffix('33'));
```

注意到青少年的例外了吗？少年太难了！

编辑：忘记了 11 号和 12 号

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2017-10-12T08:54:18.970

我想为这个问题提供一个实用的答案来补充现有的答案：

```
const ordinalSuffix = ['st', 'nd', 'rd']
const addSuffix = n => n + (ordinalSuffix[(n - 1) % 10] || 'th')
const numberToOrdinal = n => `${n}`.match(/1\d$/) ? n + 'th' : addSuffix(n) 
```

我们已经创建了一个特殊值的数组，要记住的重要一点是数组有一个从零开始的索引，所以 ordinalSuffix[0] 等于 'st'。

我们的函数 numberToOrdinal 检查数字是否以青少年数字结尾，在这种情况下，在数字后面加上“th”，因为所有数字序数都是“th”。如果数字不是青少年，我们将数字传递给 addSuffix，它将数字添加到由数字是否减去 1（因为我们使用基于零的索引）决定的序数 mod 10 的余数为 2或者更少，它是从数组中获取的，否则它是'th'。

样本输出：

```
numberToOrdinal(1) // 1st
numberToOrdinal(2) // 2nd
numberToOrdinal(3) // 3rd
numberToOrdinal(4) // 4th
numberToOrdinal(5) // 5th
numberToOrdinal(6) // 6th
numberToOrdinal(7) // 7th
numberToOrdinal(8) // 8th
numberToOrdinal(9) // 9th
numberToOrdinal(10) // 10th
numberToOrdinal(11) // 11th
numberToOrdinal(12) // 12th
numberToOrdinal(13) // 13th
numberToOrdinal(14) // 14th
numberToOrdinal(101) // 101st 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2017-12-16T04:23:04.940

我为我的东西做的旧...

```
function convertToOrdinal(number){
    if (number !=1){
        var numberastext = number.ToString();
        var endchar = numberastext.Substring(numberastext.Length - 1);
        if (number>9){
            var secondfromendchar = numberastext.Substring(numberastext.Length - 1);
            secondfromendchar = numberastext.Remove(numberastext.Length - 1);
        }
        var suffix = "th";
        var digit = int.Parse(endchar);
        switch (digit){
            case 3:
                if(secondfromendchar != "1"){
                    suffix = "rd";
                    break;
                }
            case 2:
                if(secondfromendchar != "1"){
                    suffix = "nd";
                    break;
                }
            case 1:
                if(secondfromendchar != "1"){
                    suffix = "st";
                    break;
                }
            default:
                suffix = "th";
                break;
         }
            return number+suffix+" ";
     } else {
            return;
     }
} 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2018-10-20T15:09:36.807

我为更高的数字和所有测试用例编写了这个函数

```
function numberToOrdinal(num) {
    if (num === 0) {
        return '0'
    };
    let i = num.toString(), j = i.slice(i.length - 2), k = i.slice(i.length - 1);
    if (j >= 10 && j <= 20) {
        return (i + 'th')
    } else if (j > 20 && j < 100) {
        if (k == 1) {
            return (i + 'st')
        } else if (k == 2) {
            return (i + 'nd')
        } else if (k == 3) {
            return (i + 'rd')
        } else {
            return (i + 'th')
        }
    } else if (j == 1) {
        return (i + 'st')
    } else if (j == 2) {
        return (i + 'nd')
    } else if (j == 3) {
        return (i + 'rd')
    } else {
        return (i + 'th')
    }
} 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2019-07-26T14:59:47.913

这是一种略有不同的方法（我认为其他答案不会这样做）。我不确定我是喜欢它还是讨厌它，但它确实有效！

```
export function addDaySuffix(day: number) { 
  const suffixes =
      '  stndrdthththththththththththththththththstndrdthththththththst';
    const startIndex = day * 2;

    return `${day}${suffixes.substring(startIndex, startIndex + 2)}`;
  } 
```

* * *

## 回答 #20

> 赞同：-1
> 
> 时间：2019-01-31T12:12:05.037

**我强烈推荐这个，它非常容易阅读。我希望它有帮助？**

*   它避免使用负整数，即小于 1 的数字并返回 false
*   如果输入为 0，则返回 0

```
function numberToOrdinal(n) {

  let result;

  if(n < 0){
    return false;
  }else if(n === 0){
    result = "0";
  }else if(n > 0){

    let nToString = n.toString();
    let lastStringIndex = nToString.length-1;
    let lastStringElement = nToString[lastStringIndex];

    if( lastStringElement == "1" && n % 100 !== 11 ){
      result = nToString + "st";
    }else if( lastStringElement == "2" && n % 100 !== 12 ){
      result = nToString + "nd";
    }else if( lastStringElement == "3" && n % 100 !== 13 ){
      result = nToString + "rd";
    }else{
      result = nToString + "th";
    }

  }

  return result;
}

console.log(numberToOrdinal(-111));
console.log(numberToOrdinal(0));
console.log(numberToOrdinal(11));
console.log(numberToOrdinal(15));
console.log(numberToOrdinal(21));
console.log(numberToOrdinal(32));
console.log(numberToOrdinal(43));
console.log(numberToOrdinal(70));
console.log(numberToOrdinal(111));
console.log(numberToOrdinal(300));
console.log(numberToOrdinal(101)); 
```

**输出**

```
false
0
11th
15th
21st
32nd
43rd
70th
111th
300th
101st 
```

* * *

## 回答 #21

> 赞同：-1
> 
> 时间：2020-03-25T20:11:02.630

这是给一个班轮和 es6 爱好者的

```
let i= new Date().getDate 

// I can be any number, for future sake we'll use 9

const j = I % 10;
const k = I % 100;

i = `${i}${j === 1 &&  k !== 11 ? 'st' : j === 2 && k !== 12 ? 'nd' : j === 3 && k !== 13 ? 'rd' : 'th'}`}

console.log(i) //9th 
```

+be number 的另一个选项是：

```
console.log(["st","nd","rd"][((i+90)%100-10)%10-1]||"th"] 
```

另外要摆脱序数前缀，只需使用这些：

```
console.log(i.parseInt("8th"))

console.log(i.parseFloat("8th")) 
```

随意修改以满足您的需要

* * *

## 回答 #22

> 赞同：-7
> 
> 时间：2015-03-26T06:08:29.790

```
<p>31<sup>st</sup> March 2015</p>
```

您可以使用

`1<sup>st</sup> 2<sup>nd</sup> 3<sup>rd</sup> 4<sup>th</sup>`

用于定位后缀

# php - Yii NestedSetBehavior 内存使用

> ID：13627309
> 
> 赞同：2
> 
> 时间：2012-11-29T13:53:16.970
> 
> 标签：php, memory-management, yii, model

我在我的项目中使用 NestedSetBehavior 模型扩展来将 db 表用作树。

我写了一个例子：

```
 $model = SiteMap()->findAll();
    $log .= $this->debug_memory('used')."<br>";
    $ancestors = null;
    foreach ($model as $item) {
        $ancestors = $item->ancestors()->findAll();
    }
    $log .= $this->debug_memory('used')."<br>";
    echo $log; 
```

（debug_memory 源只返回友好的 memory_get_usage()，$model 有 50 个项目）

结果是：

```
used: 10525440
used: 15892712 
```

经过简单的计算 - 内存使用量增加了 5,24 Mb。

但我必须使用 $item->ancestors()->findAll(); 循环多次，所以我的内存增加了 138 Mb。我得到@out of memory 错误”。

我尝试使用 unset()：

```
 $model = SiteMap()->findAll();
    $log .= $this->debug_memory('used')."<br>";
    $ancestors = null;
    foreach ($model as $item) {
       $ancestors= $item->ancestors()->findAll();
    }
    $ancestors = null;
    unset($ancestors);
    $log .= $this->debug_memory('used')."<br>";
    echo $log; 
```

但我得到了结果：

```
used: 10525984
used: 15893320 
```

行为祖先函数源码为：

```
public function ancestors($depth=null)
{
    $owner=$this->getOwner();
    $db=$owner->getDbConnection();
    $criteria=$owner->getDbCriteria();
    $alias=$db->quoteColumnName($owner->getTableAlias());

    $criteria->mergeWith(array(
        'condition'=>$alias.'.'.$db->quoteColumnName($this->leftAttribute).'<'.$owner->{$this->leftAttribute}.
            ' AND '.$alias.'.'.$db->quoteColumnName($this->rightAttribute).'>'.$owner->{$this->rightAttribute},
        'order'=>$alias.'.'.$db->quoteColumnName($this->leftAttribute),
    ));

    if($depth!==null)
        $criteria->addCondition($alias.'.'.$db->quoteColumnName($this->levelAttribute).'>='.($owner->{$this->levelAttribute}-$depth));

    if($this->hasManyRoots)
    {
        $criteria->addCondition($alias.'.'.$db->quoteColumnName($this->rootAttribute).'='.CDbCriteria::PARAM_PREFIX.CDbCriteria::$paramCount);
        $criteria->params[CDbCriteria::PARAM_PREFIX.CDbCriteria::$paramCount++]=$owner->{$this->rootAttribute};
    }

    return $owner;
} 
```

所以，我的问题是，为什么这个函数使用这么多内存，为什么当我取消设置变量内存时没有清理？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-01T18:08:47.657

注释掉`protected/config/main.php`文件中的日志记录。（或者您定义配置设置的任何位置。）

您所看到的可能是所有日志都写入每个 Active Record 调用的结果，这可以解释为什么取消设置对象不会释放内存：使用的内存不在模型中，而是在日志中。

尝试并报告结果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-06-10T14:08:25.093

## 回答

禁用日志（正如@willem-renzema 已经说过的那样）以防止它使用内存（尤其是在测试泄漏时）总是好的。

但是，您应该**`detachBehaviors()`**在示例代码中调用每个祖先来阻止它泄漏内存。在使用之前对每个带有附加行为的对象实例执行此操作`unset`以防止发生内存泄漏是一种很好的行为。即使您没有明确地“取消设置”对象（例如，您的变量正在超出范围）。

*有关NestedSetBehavior 中此问题的更多信息，请参阅[https://github.com/yiiext/nested-set-behavior/issues/25 。](https://github.com/yiiext/nested-set-behavior/issues/25)*

*另请参阅[https://github.com/yiisoft/yii/issues/1329#issuecomment-18729026](https://github.com/yiisoft/yii/issues/1329#issuecomment-18729026)，了解有关 PHP 和 Yii 中的内存泄漏和循环引用的更一般性讨论。*

* * *

## 笔记

您可能很想使用析构函数 ( `__destruct()`) 为您处理行为分离。但在这种特定情况下，由于[这里提到的析构函数规则](http://nl1.php.net/manual/en/function.unset.php#84911)**，它不起作用**。

> “对象只会 在*所有*`__destruct()`引用都未设置时释放它们的资源并触发它们的方法。即使它们*在*对象中......叹息！” -（俄勒冈州的氮氧化物，2009 年）。

 **仅在“祖先”上使用不会满足此规则，`unset`因为 NestedSetBehavior 仍然具有对存储在名为的静态数组中的“祖先”实例的引用：`$_cached`。只有通过销毁 NestedSetBehavior 实例本身才能清除此引用，这将在您调用`detachBehaviors()`行为的“所有者”对象时发生。**

# sql - 将 SQL 查询从 Access 表单传递到外部数据库很热？

> ID：13627317
> 
> 赞同：0
> 
> 时间：2012-11-29T13:53:46.427
> 
> 标签：sql, vba, ms-access

我在 postgreSql 中创建了数据库，并使用 Microsoft 访问表单处理前端应用程序。我想按一下按钮发送查询：

```
Private Sub Command5_Click()
Dim strSQL As String
strSQL = "INSERT INTO public_failedestimate (est_num,issue_date) SELECT est_num,issue_date FROM public_estimate WHERE est_num=1 ;"
DoCmd.RunSQL strSQL
End Sub 
```

它在调试时有效，但在我单击按钮时无效。顺便说一句，它位于按钮的点击事件中。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T14:30:16.680

你所拥有的应该工作。如果表单绑定记录集中的当前记录有任何可能是脏的，那么您需要确保在运行此代码之前将记录写入表。

您可以在 RunSQL 命令之前添加这 3 行代码

```
If me.dirty = true then
   Me.dirty = false
End if 
```

# c++ - 无法理解 iostream 错误

> ID：13627320
> 
> 赞同：0
> 
> 时间：2012-11-29T13:54:07.913
> 
> 标签：c++, iostream

我在程序中使用这个类复杂来解析方程

```
class complex
{
    double real;
    double imag;
    stringstream complexStr;

public:
    complex(double re = 0, double im = 0)
    {
        real = re;
        imag = im;
        complexStr<<real<<"+j"<<imag;
    }

    complex(complex &t)
    {
        real = t.real;
        imag = t.imag;
    }

    void StrtoComplex(char *temp)
    {
        int i;

        for(i = 0; i < strlen(temp); i++)
            if(temp[i] == 'j' || temp[i] == 'i')
                break;

        real = atof(temp);//takes till the last valid char so after + or whitespace it ignores
        imag = atof(temp + i + 1);

        complexStr<<real<<"+j"<<imag;
    }

    friend complex operator+(complex &a, complex &b);
    friend complex operator-(complex &a, complex &b);
    friend complex operator-(complex &a);
    friend complex operator*(complex &a, complex &b);
    friend complex operator/(complex &a, complex &b);
    friend ostream &operator<<(ostream &s, complex &t);
    friend istream &operator>>(istream &s, complex &t);
};

//overloading + to add complex numbers
complex operator +(complex &a, complex &b)
{
    complex t;
    t.real = a.real + b.real;
    t.imag = a.imag + b.imag;
    return(t);
}
//overaloading - to subtract 2 complex no's
complex operator -(complex &a, complex &b)
{
    complex t;
    t.real = a.real - b.real;
    t.imag = a.imag - b.imag;
    return(t);
}

//overloading unary -
complex operator -(complex &a)
{
    complex t(-a.real, -a.imag);
    return(t);
}

//overloading * to multiply 2 complex no's
complex operator *(complex &a, complex &b)
{
    complex t;
    t.real = (a.real*b.real) - (a.imag*b.imag);
    t.imag = (a.real*b.imag) + (a.imag*b.real);
    return(t);
}
//overloading / to divide 2 complex no's
complex operator /(complex &a, complex &b)
{
    complex t;
    t.real = ((a.real*b.real) + (a.imag*b.imag))/(b.real*b.real + b.imag*b.imag);
    t.imag = ((a.real*b.imag) - (a.imag*b.real))/(b.real*b.real + b.imag*b.imag);
    return(t);
}

ostream &operator<<(ostream &s, complex &t)
{
    s<<t.complexStr.str();
    return s;
}

istream &operator>>(istream &s, complex &t)
{
    char *temp;

    s>>temp;
    t.StrtoComplex(temp);
    return s;
} 
```

我收到了这个错误：

```
 error C2248: 'std::basic_ios<_Elem,_Traits>::basic_ios' : cannot access private member declared in class 'std::basic_ios<_Elem,_Traits>'
1>          with
1>          [
1>              _Elem=char,
1>              _Traits=std::char_traits<char>
1>          ]
1>          c:\program files (x86)\microsoft visual studio 10.0\vc\include\ios(176) : see declaration of 'std::basic_ios<_Elem,_Traits>::basic_ios'
1>          with
1>          [
1>              _Elem=char,
1>              _Traits=std::char_traits<char>
1>          ]
1>          This diagnostic occurred in the compiler generated function 'std::basic_stringstream<_Elem,_Traits,_Alloc>::basic_stringstream(const std::basic_stringstream<_Elem,_Traits,_Alloc> &)'
1>          with
1>          [
1>              _Elem=char,
1>              _Traits=std::char_traits<char>,
1>              _Alloc=std::allocator<char>
1>          ] 
```

请帮助我尝试四处搜索，但答案似乎是特定于程序的，所以发布了这个问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-29T14:01:29.623

你的`complex`班级有一个`std::stringstream`成员。当编译器为 生成复制构造函数时`complex`，它会尝试调用 的复制构造函数`std::stringstream`。但这失败了，因为`stringstream`无法复制对象。

我建议您删除该`stringstream`成员，然后将所需的字段写入您的输出流`operator<<`。如果您想让字符串表示成为类的成员，请改用`std::string`成员。

如果你真的想要一个`stringstream`成员（不推荐），你需要创建自己的复制构造函数，而不是编译器生成的。

# file - 将文本拆分为行excel

> ID：13627323
> 
> 赞同：0
> 
> 时间：2012-11-29T13:54:27.417
> 
> 标签：file, vba, excel

我有一个 VBA 代码，我用它将一个 txt 文件导入一个单元格。这是代码（它不是那么重要）：

```
Sub ReadFile()
     ' Requires a reference to Microsoft Scripting Runtime (Tools > References)
    Dim FSO As FileSystemObject
    Dim FSOFile As File
    Dim FSOStream As TextStream

    Dim Rand
    Dim ws As Worksheet
    Set ws = Worksheets("Sheet1")

   Set FSO = New FileSystemObject
   Set FSOFile = FSO.GetFile("C:\Users\sdagfsgedg\Desktop\20121122.log")
   Set FSOStream = FSOFile.OpenAsTextStream(ForReading, TristateUseDefault)
   Rand = 1
   Do While Not FSOStream.AtEndOfStream
        ws.Cells(Rand, 1).Value = FSOStream.ReadAll
   Loop
End Sub 
```

文本文件 20121122.log 有大约 20.000 行，它们全部导入一个单元格中。如何将该单元格拆分为 20.000 个单元格（如果日志有 20.000 行）。我不想逐行阅读文本文件...我想全部阅读（这样更快）然后将每一行拆分为单独的行。

稍后编辑：或者如果有另一种解决方案来读取日志文件并将文本作为行粘贴到行（不是像我现在那样在一个单元格中的所有内容）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T14:21:47.637

// 代码未经测试

```
Sub ReadFile()
  Dim FSO As FileSystemObject
  Dim FSOFile As File
  Dim FSOStream As TextStream

  Dim Rand
  Dim row
  Dim ws As Worksheet
  Set ws = Worksheets("Sheet1")

  Set FSO = New FileSystemObject
  Set FSOFile = FSO.GetFile("C:\Users\sdagfsgedg\Desktop\20121122.log")
  Set FSOStream = FSOFile.OpenAsTextStream(ForReading, TristateUseDefault)
  Rand = 1
  Dim content As String
  Dim lines As Variant
  Dim intIndex As Integer

  content = FSOStream.ReadAll
  lines = split(content, Chr(10))

  For intIndex = LBound(lines) To UBound(lines)
    ws.Cells(Rand, 1).Value = lines(intIndex)
    Rand = Rand + 1
  Next

End Sub 
```

# c# - 使用 SqlBulkCopy 插入 GUID

> ID：13627325
> 
> 赞同：8
> 
> 时间：2012-11-29T13:54:33.420
> 
> 标签：c#, sql-server, sql-server-2008, sqlbulkcopy

我正在尝试使用`SqlBulkCopy`SQL Server 管理导入导出向导创建的平面文件中的类进行批量插入。文件以逗号分隔。

文件中的一行可能如下所示：

> {DCAD82A9-32EC-4351-BEDC-2F8291B40AB3},,{ca91e768-072d-4e30-aaf1-bfe32c24008f},900001:1792756,900001:1792757,basladdning,2011-04-29 02:54,basladning8,2010-54:153\. 04-29 02:54:15.380000000,{20A3C50E-8029-41DE-86F1-DDCDB9A78BA5}

我得到的错误是：

> *System.InvalidOperationException 未处理
> Message=来自数据源的 String 类型的给定值无法转换为指定目标列的 uniqueidentifier 类型。*

所以问题是从字符串转换为 GUID。

我尝试了以下方法：

*   尝试了不同的编码，UTF8 和 ANSI
*   移除了 GUIDS 周围的 { }
*   在 GUIDS 周围添加了“”，有和没有 {}

有什么建议么？在 '' 所在的平面文件中，是一个也具有 Guid 作为数据类型的列。该列是 NULL，向导将其导出为 ''。这可能是问题吗？

编码：

```
using (var file = new StreamReader(filePath))
using (var csv = new CsvReader(file, false)) 
using (var bcp = new SqlBulkCopy(CreateConnectionString()))
{
    bcp.DestinationTableName = "table";
    bcp.WriteToServer(csv);
} 
```

表定义：

```
CREATE TABLE [beata].[T_FeatureInstance]( 
    [FeatureInstanceId] [uniqueidentifier] NOT NULL, 
    [FeatureInstanceParentId] [uniqueidentifier] NULL, 
    [FeatureTypeAliasId] [uniqueidentifier] NOT NULL, 
    [Uuid] [varchar](1000) NOT NULL, 
    [VersionId] [varchar](50) NOT NULL, 
    [SkapadAv] [varchar](255) NULL, 
    [Skapad] [datetime] NOT NULL, 
    [UppdateradAv] [varchar](255) NOT NULL, 
    [Uppdaterad] [datetime] NOT NULL, 
    [Gs] [uniqueidentifier] NOT NULL, 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2016-11-25T17:10:29.080

在您`DataTable.Columns.Add`包含数据类型作为第二个参数。这应该够了吧。例子：

```
DataTable dt = new DataTable();
dt.Columns.Add("ID", typeof(Guid)); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-29T16:03:10.283

问题是 in 中的空列`{DCAD82A9-32EC-4351-BEDC-2F8291B40AB3},,{ca91e768-072d-4e30-aaf1-bfe32c24008f}`被解释为`''`而不是`NULL`. 我刚刚在我的本地数据库上尝试了一个`INSERT STATEMENT`，当我指定`NULL`而不是`''` 你可能会得到另一个错误时，那个错误就消失了：

```
Conversion failed when converting date and/or time from character string. 
```

这样做的原因是 SQL 只允许毫秒的 3 位十进制精度。所以你必须四舍五入`'2011-04-29 02:54:15.380000000'`到`'2011-04-29 02:54:15.380'`，它会正常工作。

[一种方法是在这里](http://www.tek-tips.com/viewthread.cfm?qid=1685838)提到 或者，您可以修改 CsvReader 代码以在 CsvReader.GetValue(int) 函数中的值为 string.Empty 时返回 DBNULL。看看[这里](http://social.msdn.microsoft.com/Forums/en-US/adodotnetdataproviders/thread/7284f567-7454-4dc6-b5bc-a2c69d572ea5/)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-02-07T01:18:24.880

我想我为那些使用流行的免费软件代码类 BulkDataReader 的人找到了答案。我有同样的问题，我试图在不久前发布这个，但是因为我问了另一个问题并且没有提供答案，所以帖子被删除了。没关系，我没有意识到这是违反规则的。

这一次，我得到了答案，所以希望这篇文章能留在这里。我将保留我的问题的设置部分，以便它定义明确，并且没有人对为什么解决方案不适合他们感到困惑。我从一位同事那里获得了 BulkDataReader 类的代码，看来他可能是从另一个著名的答案来源获得的，所以每个人都会知道如何从搜索引擎中找到 BuldDataReader。

这个问题是这样设置的：

我也尝试了 CSV 文件中 GUIDS 的各种格式，包括：N'3192E434-F479-4B32-B516-AC658F4B7B89' {3192E434-F479-4B32-B516-AC658F4B7B89} (3192E434-F479-4B32-B516-AC658F4B7B7B89} ) “{3192E434-F479-4B32-B516-AC658F4B7B89}”</p>

我的 CSV 中的真实示例行是：1,AAPL,452.2012,2013-01-24 13:24:27.000,3192E434-F479-4B32-B516-AC658F4B7B89,3192E434-F479-4B32-B516-AC658F4B7B89

如果我删除 2 Guids 并导入没有这些列的表，它工作正常。使用 Guids to Unique Identifier 列我收到此错误：Message = {“来自数据源的 String 类型的给定值无法转换为指定目标列的类型唯一标识符。”}

我的控制代码非常基本，但 BulkDataReader 非常麻烦，因此如果您尝试调试它，请做好准备。

```
using (IDataReader reader = new BulkDataReader(new StreamReader("C:\\test.csv"), false))
        {
            String connectionStr = GetConnString();
            SqlConnection connection = new SqlConnection(connectionStr);
            connection.Open();

            SqlTransaction transaction = connection.BeginTransaction();
            try
            {
                SqlBulkCopy copy = new SqlBulkCopy(connection, SqlBulkCopyOptions.TableLock, transaction);
                copy.DestinationTableName = "TestTable6";
                copy.WriteToServer(reader); //ERROR OCCURS HERE: The given value of type String from the data source cannot be converted to type uniqueidentifier of the specified target column
                transaction.Commit();
            }
            catch (Exception exe)
            {
                transaction.Rollback();
            }
            finally
            {
                connection.Close();
            }
        } 
```

所以错误实际上发生在 .NET SqlBulkCopy 类中。但是，它发生在 BulkDataReader 读取 Guid 值之后。该 GetValue 方法是从外部代码调用的，这意味着它隐藏在 BulkDataReader 的 streamReader 和 SqlBulkCopy 类中的 StreamWriting 内容之间的管道中。没有必要使用我最喜欢的反射实用程序深入研究所有内容。我发现当 BulkDataReader 的方法 IDataRecord.GetValue(int i) 返回一个真正是 Guid 的字符串时，SqlBulkCopy 无法将该字符串转换为唯一标识符，无论它采用什么格式。可能有一些晦涩的编码格式，但我可以找不到一个可以工作的。但是，如果我只是将值作为正确的 System.Guid 类型返回，那么 SqlBulkCopy 会将其转换为唯一标识符就好了。因此，一个似乎是噩梦般的序列化问题的简单解决方案。只需复制整个 IDataRecord.GetValue(int i) 方法，它应该可以工作。我尝试了许多从 CLR 到 SQL 的数据类型，但不是全部，所以可能还有另一个你必须玩这个反序列化游戏的地方，但这应该在很大程度上解决了这个问题。

```
 object IDataRecord.GetValue(int i)
    {
        ValidateDataReader(DataReaderValidations.IsInitialized | DataReaderValidations.IsNotClosed);

        if (((IDataRecord)this).IsDBNull(i))
            return DBNull.Value;
        else
        {
            //For some reason the SqlBulkCopy.WriteToServer method will call this GetValue method when reading 
            //the value and it doesn't seem to know how to convert the string value of a Guid to a unique identifier.
            //However, it does actually know how to convert a System.Guid to a UniqueIdentifer so we can return that if
            //the value parses to Guid
            if (IsGuid(this[i]))
                return Guid.Parse(this[i]);
            else
                return this[i];
        }
    }

    bool IsGuid(object value)
    {
        if (value != null)
        {
            Guid testGuid = Guid.Empty;
            if (Guid.TryParse(value.ToString(), out testGuid))
                return true;
        }

        return false;
    } 
```

我希望这对某人有所帮助，很抱歉我第一次违反了博客规则。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-29T14:10:20.093

向 uniqueidentifier 列中的标准插入看起来像这样（经过测试并且有效），因此可以回答格式化问题。该列是否允许空值？

插入 dbo.TableName（[GUID]）值（'20A3C50E-8029-41DE-86F1-DDCDB9A78BA5'）

# php - 指向 Zend 框架模块的 Apache 虚拟主机

> ID：13627326
> 
> 赞同：0
> 
> 时间：2012-11-29T13:54:33.200
> 
> 标签：php, apache, zend-framework, zend-framework2, virtualhost

有没有办法设置 apache 虚拟主机，使其根指向 zend 框架模块？

这个模块的地址只是一个路由，服务器上没有物理文件夹。

默认模块：

```
www.myintranet.com 
```

另一个模块地址：

```
www.myintranet.com/mymodule/ 
```

“mymodule”不是一个物理文件夹，只是一个路由。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T08:22:06.980

我看不出你为什么*要这样做*？ZF2 使用特定模块的路由，这是优势之一。通过将文件隐藏在 document_root 之外，您还可以获得额外的安全性，人们无法尝试直接利用您的 php 文件来访问您的系统。除此之外，如果您的应用程序有多个模块并且其中一个模块出现问题，您可以简单地暂时禁用该模块，而无需处理 apache 重写规则等。

然而，对您的问题的直接回答是，您可以将 apache 指向您的模块目录，但是您需要更改和更新所有当前的重写规则以处理 index.php 自动加载器和 PATH 相关变量。这将比实际学习路由更多的工作。一旦你弄清楚它会让你的生活变得更轻松。

我在这里发布了一个答案：[ZF2 Routing as in ZF1](https://stackoverflow.com/questions/12370788/zf2-routing-as-in-zf1/13216091#13216091)

在 ZF1 -> ZF2 路由上，因为它似乎让很多人感到困惑，并且该路由器应该有望让您上路，因为我怀疑这是您遇到的问题...

# objective-c - @property 或 init 设置实例变量

> ID：13627328
> 
> 赞同：3
> 
> 时间：2012-11-29T13:54:40.190
> 
> 标签：objective-c, xcode

在做我的项目时，我想知道是否应该通过 viewcontrollers @synthezied 属性为 viewcontroller 设置我的实例变量，或者创建一个新的 init 函数，该函数在调用 init 时设置实例变量。

对我来说，使用@properties 设置实例变量似乎更干净。

你怎么看？

我不使用笔尖或情节提要...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T13:58:34.150

合成属性只是让您免于编写 setter 和 getter 的麻烦。仅使用`@synthesize`不会初始化您的属性。您绝对应该初始化它们 - 无论是在`-init`声明它们时还是在声明它们时。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-29T14:02:44.850

我会选择指定的初始化方法，就像设置实例变量一样，然后可以通过`@synthesized`属性使用。初始化视图控制器然后设置其属性会使对象处于不一致的状态。

指定初始化器：

```
MyViewController * viewController = [[MyViewController alloc] initWithParam1:@"foo" param2:@5];
// now viewController is consistent as presumably it has all properties set 
```

通过 setter 设置属性：

```
MyViewController * viewController = [[MyViewController alloc] init];
// here viewController is inconsistent as it does not have default properties set
[viewController setParam1:@"foo"];
[viewController setParam2:@5];
// only here viewController is consistent and can be used normally 
```

根据初始化程序的实现，您可以为属性设置默认值，而不将它们作为参数传递给初始化程序，因此如果 init 将 param1`@foo`和 param2静默设置为 ，我的第二个示例可能会出错`@5`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-29T16:43:37.010

一般来说，您指定的初始化程序应该只具有严格必要的参数。任何可选的东西通常都会放在其他地方，比如作为一个可读写的@property。这里有一定的余地，由您自行决定 - 有时您会包含一个可选参数，因为它实际上在绝大多数时间都在使用（如果不是，它有一个简单的默认值，如 nil 或 0）。

这个想法是任何由 init 方法返回的对象都应该以某种方式使用。需要额外的步骤来配置它几乎总是表明设计不佳。

遵循这一原则也鼓励不可变实例（因为在许多情况下，您可以预先指定*所有*必要的参数），这有很多原因 - 简单性、可预测性、线程安全性、保留复制等，等等。

具体来说，对于视图控制器，通常你会有一个初始化程序，它接受要控制的视图，并将其他所有内容保留为 @properties。你的视图控制器应该在某种程度上只使用视图集；所有其他属性都应该有合理的默认值。

# php - 使用 PHP 从 LAMP 服务器读取 Windows Samba 共享目录

> ID：13627331
> 
> 赞同：0
> 
> 时间：2012-11-29T13:54:59.530
> 
> 标签：php, linux, windows, file-permissions, samba

我有一个来自 Windows 网络的 Samba 共享安装到我基于 Linux 的 Web 服务器上的目录中。我已按如下方式安装目录：

```
mount -t cifs -o username=admin,password='passsword',domain=mydomain.local,file_mode=0644,dir_mode=0777,uid=client_user,gid=client_user '//192.168.0.x/d$' /home/client_user/mnt 
```

挂载工作，我可以浏览操作系统中的文件和目录。但是，我希望能够通过从浏览器运行的 PHP 脚本来访问它。但是，对共享的任何文件操作都会导致权限被拒绝错误。我做了一点实验，用apache替换了uid和gid参数值，但还是没有运气。

任何建议都非常感谢

**编辑**

在进一步的测试中，我创建了一个包含以下代码的文件：

```
if(is_readable('/path/to/mnt')) {
  echo 'Readable';
}
else {
  echo 'Not';
} 
```

从服务器上的命令行运行它会导致打印 Readable。我已经以 root 和服务器上的用户身份运行它，但它无法在浏览器中运行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T16:07:17.857

因此，经过反复试验，我发现 SELinux 不允许 httpd 访问文件夹。

运行此命令允许 httpd 访问 cifs：

```
setsebool -P httpd_use_cifs on 
```

然而，进一步的调查显示我可以只在挂载的文件夹上设置 httpd 上下文。所以我卸载了驱动器并修改了我的安装命令以包括：

```
context="system_u:object_r:httpd_sys_rw_content_t:s0", 
```

完整的命令：

```
mount -t cifs -o context="system_u:object_r:httpd_sys_rw_content_t:s0",username=admin,password='passsword',domain=mydomain.local,file_mode=0644,dir_mode=0777,uid=client_user,gid=client_user '//192.168.0.x/d$' /home/client_user/mnt 
```

# spring - 在春季使用对象作为地图（树形图）中的键

> ID：13627333
> 
> 赞同：0
> 
> 时间：2012-11-29T13:55:04.870
> 
> 标签：spring, jstl

我试图在 FormBean 中的 Map 中显示 JSP 页面对象的属性。地图定义为

```
Map<KeyObject, ValueObject> m 
```

KeyObject 有两个属性

```
public class KeyObject implements Comparable<KeyObject> {
    private Integer a;
    private Integer b;

    getters/setters/and rest basic methods
} 
```

在 JSP 上，我想获得类似下面的代码：

```
<c:forEach items="${formBean.m}" item="itm">
    ...
    <form:input path="m[itm.key].propertyName" />
    ...
</c:forEach> 
```

我需要：

*   以正确的顺序显示元素
*   提交对象到地图

那么有什么简单的解决方案或者我应该做一些“魔术”吗？

谢谢你的时间。

斯特凡

* * *

更多信息。每个对象都会有其他“视图”，所以我尝试使用 c:import

```
<c:forEach items="${formBean.m}" item="itm">
    <c:import url=${itm.value.name}Page.jsp" />
</c:forEach> 
```

在 ...Page.jsp 上，我想使用表单的输入。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T14:01:43.630

```
<c:forEach items="${formBean.m}" varStatus="itm">
    <tr>      
      <td>${itm.key.propertyName}</td>
      <td>${itm.value.propertyName}</td> <!--which is same as below ...  -->
      <td>${formBean.m[itm.key].propertyName}</td>
    </tr>
</c:forEach> 
```

您可以像上面一样遍历映射键和值，并根据需要输出不同的字段。

# c# - 使用 SSIS 脚本任务读取 Excel 单元格值

> ID：13627337
> 
> 赞同：3
> 
> 时间：2012-11-29T13:55:21.910
> 
> 标签：c#, excel, ssis, datatable

我正在尝试通过**SSIS ScriptTask**读取 Excel 文件以检查该工作表中的某些单元格值。

在代码示例中，您可以看到**strSQL**设置为“ **H4:H4** ”以仅读取一个单元格。这个单元格只能有一个真值或假值。因为我还需要检查**B1**中的某个字符串值，所以我想扩展这个版本。

```
 string filePath = "c:\\test\\testBoolean.XLSX";
  string tabName = "testSheet$";
  string strSQL = "Select * From [" + tabName + "H4:H4]";
  String strCn = "Provider=Microsoft.ACE.OLEDB.12.0;Data Source="
                  + filePath + ";Extended Properties=\"Excel 12.0;HDR=NO;IMEX=1\";";
  OleDbConnection cn = new OleDbConnection(strCn);
  int iCnt = 0;
  OleDbDataAdapter objAdapter = new OleDbDataAdapter(strSQL, cn);
  DataSet ds = new DataSet();
  objAdapter.Fill(ds, tabName);
  DataTable dt = ds.Tables[tabName];

  foreach (DataRow row in dt.Rows)
  {
      iCnt = iCnt + 1;
      // some processing....
  } 
```

我不明白为什么我用上面的**strSQL**语句或任何包含相同行号的语句得到一个布尔值，如下所示：

```
string strSQL = "Select * From [" + tabName + "F4:H4]"; 
```

调试输出：

```
row.ItemArray[2]    false   object {bool} 
```

**但是**当我设置一个像这样的不同范围时：

```
string strSQL = "Select * From [" + tabName + "F1:H4]"; 
```

我失去了对 bool 值的认识：

```
row.ItemArray[2]   "FALSE"  object {string} 
```

我更愿意将 bool 值用于其他处理任务。

除了读取 B2 值之外，我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-02T17:53:52.527

您指定的连接字符串`IMEX=1`，它告诉驱动程序将混合数据类型视为文本。[（请参阅 MSDN 文章Excel 连接管理器](http://msdn.microsoft.com/en-us/library/ms141683.aspx)的“使用注意事项”部分。）

因此，当您指定单行时

```
string strSQL = "Select * From [" + tabName + "F4:H4]"; 
```

第三列只有一种可能的数据类型，驱动程序能够正确推断它。但是，当您指定多行时

```
string strSQL = "Select * From [" + tabName + "F1:H4]"; 
```

and **any** value in the range H1:H4 was not a `bool`, the driver translated **all** values in that column to `string`s.

Assuming that you do in fact have mixed data types in column H and only care about the values in two particular cells, the simplest solution is to query each cell individually. See [Import a single Excel cell into SSIS](https://stackoverflow.com/questions/7646397/import-a-single-excel-cell-into-ssis?rq=1) for some ideas on how to do that.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-01T11:26:57.857

我将克隆大部分代码以生成两个单独的 SELECT 语句，以使用单独的 SQL 语句查询您所在的两个不同的单元格。

实际上，我可能会更进一步，将整个脚本分解为 SSIS 组件，例如执行 SQL 任务或数据流任务。

# sorting - XPage ViewColumnHeader 排序上的 Javascript 事件

> ID：13627340
> 
> 赞同：2
> 
> 时间：2012-11-29T13:55:25.853
> 
> 标签：sorting, view, xpages, lotus

我最近正在使用 XPages，但在容器控件中的数据排序方面遇到了麻烦。我已经能够通过多个解决方案、视图面板、数据表和重复控件很好地显示数据，但排序似乎只能通过视图面板正常工作。（在做了一些研究并意识到 Java.Util.TreeMap 为其他容器提供了一些实用程序之后）。但是，我遇到的问题是查看列标题添加用于排序的图像不是我想要的。

所以，我的问题是：有什么方法可以改变 XPages 查找这些图像的位置（知道我可以通过 Image.ViewColumnHeaderSort 在该图像标签上设置一个类，因为无法访问该事件而无济于事）或者可以我访问该事件是为了设置一个作用域变量，我可以用它来计算我的 TH 元素上的一个类。

在此先感谢 Aaron Brake 4CTechnologies

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T11:46:47.787

这是此问题的解决方法，它使用 URL 参数对视图面板列进行排序。

示例 XPage：

```
<?xml version="1.0" encoding="UTF-8"?>
<xp:view xmlns:xp="http://www.ibm.com/xsp/core">
    <xp:this.resources>
        <xp:script src="/jssViewSort.jss" clientSide="false"></xp:script>
    </xp:this.resources>

    <xp:viewPanel rows="30" id="viewPanel2">
        <xp:this.facets>
            <xp:pager partialRefresh="true" layout="Previous Group Next"
                xp:key="headerPager" id="pager2">
            </xp:pager>
        </xp:this.facets>
        <xp:this.data>
            <xp:dominoView var="view1" viewName="_YOUR_VIEW_"></xp:dominoView>
        </xp:this.data>
        <xp:viewColumn columnName="Form" id="viewColumn3">
            <xp:viewColumnHeader value="Form" id="viewColumnHeader3" iconSrc="#{javascript:getViewSortIcon(this)}">
            <xp:this.attrs>
                    <xp:attr name="onclick">
                        <xp:this.value><![CDATA[#{javascript:getViewSortLink(this)}]]></xp:this.value>
                    </xp:attr>
                </xp:this.attrs>
            </xp:viewColumnHeader>
        </xp:viewColumn>
    </xp:viewPanel>

</xp:view> 
```

使用的视图有一个名为“Form”的可排序列，可双向排序。

这是 SSJS 库，未优化且未记录：

```
/**
 * returns a link for sorting a view panel
 * 
 * @author Sven Hasselbach
 * @version 0.1
 */
function getViewSortLink( colHeader:com.ibm.xsp.component.xp.XspViewColumnHeader ){

    var col:com.ibm.xsp.component.xp.XspViewColumn = colHeader.getParent();
    var vp:com.ibm.xsp.component.xp.XspViewPanel = col.getParent();
    var ds:com.ibm.xsp.model.domino.DominoViewData = vp.getDataSource();
    var curSortOrder = vp.getDataSource().getSortOrder();

    var sortCol = context.getUrlParameter("sortColumn");
    var sortOrder = context.getUrlParameter("sortOrder");

    if( sortCol === col.getColumnName() ){
        if( curSortOrder === null || curSortOrder === "" )
            sortOrder = "ascending";

        if( curSortOrder === "ascending" )
            sortOrder = "descending";

        if( curSortOrder === "descending" )
            sortOrder = ""

    }else{
        sortOrder = "ascending";
        sortCol = col.getColumnName();
    }

    return "window.location='" + context.getUrl().getPath() + "?sortColumn=" + sortCol + "&sortOrder=" + sortOrder + "'";
}

/**
 * returns a view icon for sorting
 * 
 * @author Sven Hasselbach
 * @version 0.1
 */
function getViewSortIcon( colHeader:com.ibm.xsp.component.xp.XspViewColumnHeader ){

    var col:com.ibm.xsp.component.xp.XspViewColumn = colHeader.getParent();
    var vp:com.ibm.xsp.component.xp.XspViewPanel = col.getParent();
    var ds:com.ibm.xsp.model.domino.DominoViewData = vp.getDataSource();
    var curSortOrder = vp.getDataSource().getSortOrder();

    var sortCol = context.getUrlParameter("sortColumn");

    if( sortCol !== col.getColumnName() )
        return "http://www.google.de/images/icons/product/chrome-48.png";

    if( curSortOrder === "ascending" )
        return "https://www.google.com/intl/de/images/icons/feature/alert-b42.png"

    if( curSortOrder === "descending" )
        return "https://www.google.com/intl/de/images/icons/product/calendar-42.png"    

    return "http://www.google.de/images/icons/product/chrome-48.png";

} 
```

可以使用 CSS 调整图像。

希望这可以帮助！

# objective-c - “处理事件”是什么意思？

> ID：13627342
> 
> 赞同：0
> 
> 时间：2012-11-29T13:55:37.847
> 
> 标签：objective-c, ios

我在阅读 iOS 的[Event Types 和 Delivery](https://developer.apple.com/library/ios/#documentation/EventHandling/Conceptual/EventHandlingiPhoneOS/EventsiPhoneOS/EventsiPhoneOS.html#//apple_ref/doc/uid/TP40009541-CH2-SW1)文档时遇到问题。为了这：

> 如果第一响应者或命中测试视图不处理事件

“处理事件”是什么意思？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T13:57:49.437

处理事件意味着有一个方法在事件触发时被调用。例如，如果您单击一个按钮，并且在单击该按钮时调用了一个方法，该方法会响应该按钮，然后它会处理该事件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T14:01:42.557

用户是对的。补充一点，不处理事件是当您发送无法正确执行任何方法的事件时。例如，再次按下按钮。假设您按下了它，但您将其操作分配给了引发异常的方法。该按钮未处理该事件。此外，如果您将按钮分配给 IBAction，但忘记对操作进行编码，则该按钮无法处理该事件。

处理一个事件仅仅意味着一个动作正确地执行了它分配的方法。

# android - 不仅在第一次运行时加载原始资源

> ID：13627346
> 
> 赞同：0
> 
> 时间：2012-11-29T13:55:46.497
> 
> 标签：android, dictionary, resources, runtime

我正在尝试更改可搜索字典示例的代码（[此处](http://www.java2s.com/Code/Android/Database/SearchableDictionary.htm)为完整代码），以便我可以修改“description.txt”，并且当我将程序从 Eclipse 构建到我的应用程序时它会更新它。

我认为它在第一次之后没有考虑修改，因为字典已经加载，这个函数：

```
 private void loadDictionary() {
        new Thread(new Runnable() {
            public void run() {
                try {
                    loadWords();
                } catch (IOException e) {
                    throw new RuntimeException(e);
                }
            }
        }).start();
    } 
```

任何人都知道如何更改它，以便它始终加载新的“definition.txt”并且我可以继续修改它而不必一直重新安装应用程序？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-06T11:42:23.860

在此特定代码中，解决方案是在 DictionaryDatabase.java 中增加数据库版本：

私有静态最终 int DATABASE_VERSION = 3;

# php - 如何让我的 html 代码显示在像谷歌搜索页面这样的页面中间？

> ID：13627351
> 
> 赞同：-1
> 
> 时间：2012-11-29T13:55:59.477
> 
> 标签：php, javascript, python, html

> **可能重复：**
> [在页面上垂直和水平居中 <div> 的最佳方法？](https://stackoverflow.com/questions/356809/best-way-to-center-a-div-on-a-page-vertically-and-horizontally)

我的结果如何在 Html 或 javascript 代码的帮助下显示在页面中间。正如你们都在搜索页面中看到的谷歌。我的结果在顶部中心，但我想像谷歌页面一样在中间。我的 HTML 代码是：

```
<html>
<head>
    <title> Search</title>
<body>

    <center>Search: <input type="Text" Name="">
    <input type="Submit" value="Go"></center>

</body>
</html 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-29T13:59:20.733

```
<html>
  <head></head>
  <body style="width: 100%; height: 100%;">

    <div style="top: 50%; left: 50%; position: absolute;">
        <div>Centered text</div>
    </div>

  </body>
</html> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T14:14:01.313

这是您的解决方案：

在css中设置你想要的宽度和高度。

HTML：

```
<html> 
    <head>         
        <title> Search</title>
    </head>           
        <body>
            <div id="centered">                               
                Search: <input type="Text" Name="">     
                <input type="Submit" value="Go">
            </div>                           
        </body>           
</html> 
```

CSS：

```
#centered{
width:200px;
height:50px;
margin:auto;
position:absolute;
top:0;
bottom:0;
right:0;
left:0;       
} 
```

[http://jsfiddle.net/y6x3e/](http://jsfiddle.net/y6x3e/)

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2012-11-29T14:04:20.440

如果要将内容放在页面中间，则必须从顶部添加一些边距，请使用此代码并从顶部调整边距

```
<div style="margin-top:200px;" align="center">Search: <input type="Text" Name="">
<input type="Submit" value="Go"></div> 
```

# git - 从 github master 运行服务器

> ID：13627354
> 
> 赞同：0
> 
> 时间：2012-11-29T13:56:04.323
> 
> 标签：git, github

快速提问，也许有人可以提供一些关于最佳方法的见解。

我们使用 Github 进行开发，并以这样的方式工作，即主分支是我们开发服务器上的镜像。一旦开发服务器获得批准，我们将其复制到生产中。

我想知道，有没有办法让我的服务器环境与 Github master 同步并运行，这样如果我们进行 master 合并，它将自动成为我们开发服务器上运行的内容？如果不在开发服务器上运行 git，这可能吗？

如果没有，人们发现还有哪些其他解决方案可以避免到处复制文件？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T14:12:45.903

人们通常为此使用的是[钩子](http://git-scm.com/docs/githooks)，基本上是在您的存储库中的某些操作上执行的脚本。对于这种情况，最合适的 hook 是*post-receive* hook。在将更改推送到您的存储库后，它会被执行。然后，您可以在钩子执行时更新您的其他存储库，并在主分支更改时开始部署。

在 GitHub 上，您的存储库的管理部分中提供了挂钩（“服务挂钩”）。如果您没有运行特定的系统，则可以只使用 WebHook，它本质上会在执行 post-receive 挂钩时发布带有信息的自定义 URL。这允许您在服务器上放置一个公共触发脚本，该脚本在执行时会启动更新和部署。为了增加安全性，您应该检查 IP 地址是否是 GitHub 页面上列出的地址之一。

# c# - NavigationServices.Navigate 不工作

> ID：13627357
> 
> 赞同：1
> 
> 时间：2012-11-29T13:56:23.387
> 
> 标签：c#, windows-phone-7

嗨，我是 Windows Phone 开发的新手，可能是我在编写代码时做了一些尴尬的事情，我可以做类似的事情吗

```
button_click()
{
this.NavigationService.Navigate(new Uri("/HttpHandler.xaml", UriKind.Relative));
            WebHandler.Make_url_HandleResponse("someurl", 1);  
}

/*In HttpHandler Class having object Webhandler in previous class*/
     public void Make_url_HandleResponse(string Uri, int req_id)
        {
            try
            {
                uri = new Uri(Uri);
            }
            catch (Exception exception)
            {
                Debug.WriteLine(exception.Message);
                MessageBox.Show(exception.Message);
            }

       request = (HttpWebRequest)HttpWebRequest.Create(uri.AbsoluteUri);

            Debug.WriteLine("The url is" + uri);

        }

public void request_CallBack(IAsyncResult result)
    {
        try
        {
            //var request = (HttpWebRequest) result.AsyncState; 
            Stream stream;
            string ext_str;
            char[] separator = { '/' };

            HttpWebResponse response = (HttpWebResponse)request.EndGetResponse(result);

            using (stream = response.GetResponseStream())
            {

               /* here I want to navigate to a new page*/
                    Deployment.Current.Dispatcher.BeginInvoke(delegate()
                    {
                        try
                        {
                             downloadingProgress.IsIndeterminate = false;
                             downloadingProgress.Visibility = Visibility.Collapsed;
                            stkDownloading.Visibility = Visibility.Collapsed;
                            this.NavigationService.Navigate(new Uri("/NewUser.xaml",UriKind.Relative));
                            }
                            catch (Exception e)
                            { }
                        }); 
    } 
```

我只是想问我是否可以从 httphandler 页面导航到另一个页面。提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T16:53:37.230

确保两个页面的名称空间相同（源页面和目标页面），否则您必须在 uri 字符串中提及路径。导航到另一个屏幕的代码是相同的：

NavigationService.Navigate(new Uri("/pageNmae.xaml", UriKind.Relative));

# xquery - 如何在没有 xml 数据库的情况下使用 Xquery

> ID：13627359
> 
> 赞同：3
> 
> 时间：2012-11-29T13:56:25.133
> 
> 标签：xquery

我正在试验 Xquery，并使用 sedna 和 basex 作为 xml 数据库。我在互联网上找到的所有示例都依赖于数据库，因此所有连接都需要用户名/密码。但是，我需要将 Xquery 与 XML 文件（而不是数据库）结合使用。

创建与文件的连接并执行查询的最佳方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-29T14:21:51.043

BaseX 提供多种操作模式。例如，它可以用作命令行工具（参见[http://docs.basex.org/wiki/Startup_Options](http://docs.basex.org/wiki/Startup_Options)）...

```
basex -i input.xml "/your/query" 
```

..或来自Java（参见例如[https://github.com/BaseXdb/basex-examples/blob/master/src/main/java/org/basex/examples/query/RunQueries.java](https://github.com/BaseXdb/basex-examples/blob/master/src/main/java/org/basex/examples/query/RunQueries.java)）。

在所有情况下，都不需要显式创建数据库实例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T15:34:56.230

[您还可以尝试XmlPrime](http://www.xmlprime.com/xmlprime/doc/1.0/xquery-command-line-reference.htm)或 Saxon提供的 XQuery 命令行工具。

# mysql - 使用 Percona pt-query-digest 仅分析特定数据库的慢查询日志

> ID：13627360
> 
> 赞同：0
> 
> 时间：2012-11-29T13:56:32.963
> 
> 标签：mysql, percona, mysql-slow-query-log, pt-query-digest

Percona 工具脚本 pt-query-digest 看起来对于分析 MySQL 慢查询日志非常有用。有人知道我如何让脚本只查看与特定数据库相关的查询吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-10T00:21:11.083

```
pt-query-digest --filter '$event->{db} eq "mydatabase"' ...other arguments... 
```

# python - 将 python 脚本从 sqlite3 更改为 mysql 的语法

> ID：13627364
> 
> 赞同：1
> 
> 时间：2012-11-29T13:56:44.567
> 
> 标签：python, mysql-python

我有一个工作 python 脚本，它从 sqlite3 db 中检索数据。不过，我需要将其转换为与 mysql db 对话，这是让我感到悲伤的第一行：

```
PRODUCT_CODE_ID = "SELECT id FROM localsite_productcode WHERE localsite_productcode.product_code=?"
cur.execute(PRODUCT_CODE_ID,(product_code,)) 
```

当我尝试使用 mysql 时，出现以下错误：

```
Traceback (most recent call last):
  File "gen-csv.py", line 85, in <module>
    cur.execute(PRODUCT_CODE_ID,(product_code,))
  File "/usr/lib/pymodules/python2.6/MySQLdb/cursors.py", line 151, in execute
    query = query % db.literal(args)
TypeError: not all arguments converted during string formatting 
```

我在这里做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T14:02:52.090

我不认为 MySQL 的 DB API 支持`?`作为占位符 - 只是尝试`%s`。

# vb.net - 在运行时编译和运行代码

> ID：13627368
> 
> 赞同：3
> 
> 时间：2012-11-29T13:56:59.063
> 
> 标签：vb.net, reflection

我正在尝试在运行时编译和运行代码。我正在使用下面的代码来实现这一点。但是，当我尝试调用该方法时，只会打开一个“查找源”文件浏览器对话框，并且代码不会运行。任何人都可以在这里帮助我。

```
Dim VBP As New VBCodeProvider
Dim CVB As System.CodeDom.Compiler.ICodeCompiler

CVB = VBP.CreateCompiler
Dim PM As New System.CodeDom.Compiler.CompilerParameters

PM.GenerateInMemory = True
PM.GenerateExecutable = True
PM.OutputAssembly = "RunCode.dll"
PM.MainClass = "MainClass"
PM.IncludeDebugInformation = True

Dim ASM As System.Reflection.Assembly
For Each ASM In AppDomain.CurrentDomain.GetAssemblies
    PM.ReferencedAssemblies.Add(ASM.Location)
Next
Dim CompileResults As System.CodeDom.Compiler.CompilerResults

CompileResults = CVB.CompileAssemblyFromSource(PM, sCode)

Dim CompileErrors As System.CodeDom.Compiler.CompilerError

For Each CompileErrors In CompileResults.Errors
    RTMainScript.AppendText(vbCrLf & CompileErrors.ErrorNumber & ": " & CompileErrors.ErrorText & ", " & CompileErrors.Line)
Next

Dim objRun As New Object
Dim vArgs() As Object

objRun = CompileResults.CompiledAssembly.CreateInstance("RunCode.MainClass", False, BindingFlags.CreateInstance, Nothing, vArgs, Nothing, Nothing)
If Not objRun Is Nothing Then
    Dim oMethodInfo As MethodInfo = objRun.GetType().GetMethod("Main")
    Dim oRetObj As Object = oMethodInfo.Invoke(objRun, BindingFlags.Static Or BindingFlags.Instance Or BindingFlags.Public Or BindingFlags.NonPublic, Nothing, Nothing, Nothing) 'Find source dialog appears here
Else
    MsgBox("Compile Error")
End If 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T03:13:58.087

确保您的线程模型是 STA。

如果线程模型设置为 MTA，OpenFileDialog 和类似对象将无法正确运行。如果您出于其他原因必须使用 MTA，那么您可以创建自己的自定义 OpenFileDialog 类；有点糟糕。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T19:19:34.167

您提供的代码不完整。您正在使用此方法编译代码：

```
CompileResults = CVB.CompileAssemblyFromSource(PM, sCode) 
```

但是您实际上从未指定过是什么`sCode`。如果你得到一个打开的文件浏览器对话框，那么我很确定你`sCode`是它的原因。它必须在计算变量值以打开文件时设置在某个地方。

如果您尝试更改用于从文件编译的一段代码，那么将方法从更改`CompileAssemblyFromFile()`为`CompileAssemblyFromSource()`是不够的。您需要深入研究代码并更改所有相关方法。

# javascript - latlng 函数参数

> ID：13627371
> 
> 赞同：3
> 
> 时间：2012-11-29T13:57:20.607
> 
> 标签：javascript, asp.net, vb.net, google-maps, variables

我使用该程序的主要目标是生成一个显示特定建筑物位置的谷歌地图。

由于谷歌的限制原因，我已经为我在 MS SQL 数据库（它是一个房地产网站）中分析的所有建筑物生成并存储了所有纬度和经度。每次选择一栋建筑物时，我都会检索其相应的纬度和经度并将其存储在两个 asp:Label 中。我在 Javascript 中使用脚本来处理通过两个 asp:Label 传递的纬度和经度。我的问题是，由于某种原因，LatLng 函数似乎不起作用，我的地图没有显示它们应该显示的坐标。我想我可能对 LatLng 期望的变量类型有疑问。我已经尝试过传递的默认字符串并将变量转换为真实类型。这是脚本。任何帮助或建议表示赞赏：

```
 <script type="text/javascript">
      (function () {

          // Defining global variables
          var map, geocoder, marker, infowindow, propertyaddress, selectedbuilding, maplatitude, maplongitude, buildinglatlng, latlng, myOptions;

          function InitializeMap() {
              //propertyaddress = '400 Alton Road, Miami Beach, FL 33139';
              propertyaddress = document.getElementById('<%=lblselectedHiddenBuildingAddress.ClientID%>').innerText;
              selectedbuilding = document.getElementById('<%=lblMainBuilding.ClientID%>').innerText;

              //maplatitude = parseFloat(document.getElementById('<%=lblCoordinateLatitud.ClientID%>').innerText);
              //maplongitude = parseFloat(document.getElementById('<%=lblCoordinateLongitud.ClientID%>').innerText);
              maplatitude = document.getElementById('<%=lblCoordinateLatitud.ClientID%>').innerText;
              maplongitude = document.getElementById('<%=lblCoordinateLongitud.ClientID%>').innerText;
              buildinglatlng = new google.maps.LatLng(maplatitude, maplongitude);

              //window.alert("Processed propertyaddress");

              //latlng = new google.maps.LatLng(25.76804, -80.132743);

              // Creating an object literal containing the properties
              // we want to pass to the map
               myOptions = {
                  zoom: 15,
                  center: new google.maps.LatLng(maplatitude, maplongitude),
                  //center: buildinglatlng,
                  mapTypeId: google.maps.MapTypeId.ROADMAP,
                  scaleControl: true,
                  streetViewControl: true,
                  disableDefaultUI: true,
                  mapTypeControl: true,
                  mapTypeControlOptions: {
                      style: google.maps.MapTypeControlStyle.HORIZONTAL_BAR,
                      position: google.maps.ControlPosition.TOP_LEFT,
                      mapTypeIds: [
                google.maps.MapTypeId.ROADMAP,
                google.maps.MapTypeId.TERRAIN,
                google.maps.MapTypeId.SATELLITE
            ]
                  },
                  navigationControl: true,
                  navigationControlOptions: {
                      position: google.maps.ControlPosition.TOP_LEFT
                  }
              };
              // Creating the map
              map = new google.maps.Map(document.getElementById("map"), myOptions);
          }
          window.onload = InitializeMap;
      })();
</script> 
```

#

添加了有效但使用地理编码器的代码

#

例如，以下代码可以完美运行，但它使用了地理编码器。传递变量不是问题。LatLng 以及它对传递的变量的作用有些奇怪。不过，它确实获得了所有重要位置的值。

```
 <script type="text/javascript">
      (function () {

          // Defining global variables
          var map, geocoder, marker, infowindow, propertyaddress, selectedbuilding, maplatitude, maplongitude, buildinglatlng, latlng, myOptions;

          function InitializeMap() {
              //propertyaddress = '400 Alton Road, Miami Beach, FL 33139';
              propertyaddress = document.getElementById('<%=lblselectedHiddenBuildingAddress.ClientID%>').innerText;
              selectedbuilding = document.getElementById('<%=lblMainBuilding.ClientID%>').innerText;

              //maplatitude = parseFloat(document.getElementById('<%=lblCoordinateLatitud.ClientID%>').innerText);
              //maplongitude = parseFloat(document.getElementById('<%=lblCoordinateLongitud.ClientID%>').innerText);
              maplatitude = document.getElementById('<%=lblCoordinateLatitud.ClientID%>').innerText;
              maplongitude = document.getElementById('<%=lblCoordinateLongitud.ClientID%>').innerText;
              buildinglatlng = new google.maps.LatLng(maplatitude, maplongitude);

              //window.alert("Processed propertyaddress");

              //latlng = new google.maps.LatLng(25.76804, -80.132743);

              if (!geocoder) {
                  geocoder = new google.maps.Geocoder();
              }

              // Creating a GeocoderRequest object
              var geocoderRequest = {
                  address: propertyaddress
              }

              geocoder.geocode(geocoderRequest, function (results, status) {
                  // Check if status is OK before proceeding
                  if (status == google.maps.GeocoderStatus.OK) {
                      // Center the map on the returned location
                      //map.setCenter(results[0].geometry.location);
                      // Creating an object literal containing the properties
                      // we want to pass to the map
                      myOptions = {
                          zoom: 15,
                          //center: new google.maps.LatLng(maplatitude, maplongitude),
                          center: results[0].geometry.location,
                          mapTypeId: google.maps.MapTypeId.ROADMAP,
                          scaleControl: true,
                          streetViewControl: true,
                          disableDefaultUI: true,
                          mapTypeControl: true,
                          mapTypeControlOptions: {
                              style: google.maps.MapTypeControlStyle.HORIZONTAL_BAR,
                              position: google.maps.ControlPosition.TOP_LEFT,
                              mapTypeIds: [
                                google.maps.MapTypeId.ROADMAP,
                                google.maps.MapTypeId.TERRAIN,
                                google.maps.MapTypeId.SATELLITE
                                ]
                          },
                          navigationControl: true,
                          navigationControlOptions: {
                              position: google.maps.ControlPosition.TOP_LEFT
                          }
                      };
                      // Creating the map
                      map = new google.maps.Map(document.getElementById("map"), myOptions); 

                      // Check to see if we've already got a Marker object
                      if (!marker) {
                          // Creating a new marker and adding it to the map
                          marker = new google.maps.Marker({
                              map: map,
                              animation: google.maps.Animation.DROP
                          });
                          google.maps.event.addListener(marker, 'click', toggleBounce);
                      }
                      // Setting the position of the marker to the returned location
                      marker.setPosition(results[0].geometry.location);
                      // Check to see if we've already got an InfoWindow object

                      google.maps.event.addListener(marker, 'click', function () {
                          if (!infowindow) {
                              // Creating a new InfoWindow
                              infowindow = new google.maps.InfoWindow();
                          }
                          // Creating the content of the InfoWindow to the address
                          // and the returned position
                          var content = '<h2>' + selectedbuilding + '</h2>';
                          //content += 'Lat: ' + results[0].geometry.location.lat() + '<br />';
                          //content += 'Lng: ' + results[0].geometry.location.lng();
                          // Adding the content to the InfoWindow
                          infowindow.setContent(content);
                          // Opening the InfoWindow
                          infowindow.open(map, marker);
                      });

                      // Triggering the click event
                      google.maps.event.trigger(marker, 'click');
                  };
              });

          }

          function toggleBounce() {
              if (marker.getAnimation() != null) {
                  marker.setAnimation(null);
              } else {
                  marker.setAnimation(google.maps.Animation.BOUNCE);
              }
          }

          window.onload = InitializeMap;
      })();
</script> 
```

问候， 埃利亚斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T14:05:31.280

您是否已验证`maplatitude`并`maplongitude`包含您期望的值（例如，使用调试器）？

预期位置与地图上显示的实际位置之间是否存在关联（例如，如果建筑物位于 N21.7684，而标记位于 N21.0000，则可能已丢失小数位）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T18:19:27.137

我刚刚从 Google 找到了一篇帖子，他们更改了 LatLng 函数，现在您必须使用 NUMBER() 转换这两个参数。他们声称人们将字符串传递给 LatLng 函数并产生了不可预测的结果。所以我在我的新代码中添加了更改......只花了三天时间就找到了这个修复程序！！！！:-(我想知道为什么没有更多的人遇到这个。这是代码：

```
 <script type="text/javascript">
      (function () {

          // Defining global variables
          var map, geocoder, marker, infowindow, propertyaddress, selectedbuilding, maplatitude, maplongitude, buildinglatlng, latlng, myOptions;

          function InitializeMap() {
              //propertyaddress = '400 Alton Road, Miami Beach, FL 33139';
              propertyaddress = document.getElementById('<%=lblselectedHiddenBuildingAddress.ClientID%>').innerText;
              selectedbuilding = document.getElementById('<%=lblMainBuilding.ClientID%>').innerText;

              //maplatitude = parseFloat(document.getElementById('<%=lblCoordinateLatitud.ClientID%>').innerText);
              //maplongitude = parseFloat(document.getElementById('<%=lblCoordinateLongitud.ClientID%>').innerText);
              maplatitude = document.getElementById('<%=lblCoordinateLatitud.ClientID%>').innerText;
              maplongitude = document.getElementById('<%=lblCoordinateLongitud.ClientID%>').innerText;
              buildinglatlng = new google.maps.LatLng(Number(maplatitude), Number(maplongitude));

              //window.alert("Processed propertyaddress");

                      myOptions = {
                          zoom: 15,
                          center: new google.maps.LatLng(Number(maplatitude), Number(maplongitude)),
                          mapTypeId: google.maps.MapTypeId.ROADMAP,
                          scaleControl: true,
                          streetViewControl: true,
                          disableDefaultUI: true,
                          mapTypeControl: true,
                          mapTypeControlOptions: {
                              style: google.maps.MapTypeControlStyle.HORIZONTAL_BAR,
                              position: google.maps.ControlPosition.TOP_LEFT,
                              mapTypeIds: [
                                google.maps.MapTypeId.ROADMAP,
                                google.maps.MapTypeId.TERRAIN,
                                google.maps.MapTypeId.SATELLITE
                                ]
                          },
                          navigationControl: true,
                          navigationControlOptions: {
                              position: google.maps.ControlPosition.TOP_LEFT
                          }
                      };
                      // Creating the map
                      map = new google.maps.Map(document.getElementById("map"), myOptions); 

                      // Check to see if we've already got a Marker object
                      if (!marker) {
                          // Creating a new marker and adding it to the map
                          marker = new google.maps.Marker({
                              map: map,
                              animation: google.maps.Animation.DROP
                          });
                          google.maps.event.addListener(marker, 'click', toggleBounce);
                      }
                      // Setting the position of the marker to the returned location

                      marker.setPosition(buildinglatlng);

                      // Check to see if we've already got an InfoWindow object

                      google.maps.event.addListener(marker, 'click', function () {
                          if (!infowindow) {
                              // Creating a new InfoWindow
                              infowindow = new google.maps.InfoWindow();
                          }
                          // Creating the content of the InfoWindow to the address
                          // and the returned position
                          var content = '<h2>' + selectedbuilding + '</h2>';

                          // Adding the content to the InfoWindow
                          infowindow.setContent(content);
                          // Opening the InfoWindow
                          infowindow.open(map, marker);
                      });

                      // Triggering the click event
                      google.maps.event.trigger(marker, 'click');

          }

          function toggleBounce() {
              if (marker.getAnimation() != null) {
                  marker.setAnimation(null);
              } else {
                  marker.setAnimation(google.maps.Animation.BOUNCE);
              }
          }

          window.onload = InitializeMap;
      })();
</script> 
```

# css - 为 WordPress 更改 22 日的移动菜单？

> ID：13627373
> 
> 赞同：0
> 
> 时间：2012-11-29T13:57:30.500
> 
> 标签：css, wordpress, wordpress-theming

我正在为 wordpress [http://wordpress.org/extend/themes/twentytwelve](http://wordpress.org/extend/themes/twentytwelve)使用主题 21 ，并更改了菜单，使其看起来适合桌面。在移动版本中，菜单按钮会显示，但是当您单击它时会出现我的常规菜单。我想在不影响我的正常菜单的情况下调整移动菜单的样式，但找不到在哪里做。我的网站不在线，所以我无法提供指向我网站的链接

二十二演示[http://twentytwelvedemo.wordpress.com/](http://twentytwelvedemo.wordpress.com/)

这是我的桌面菜单，看起来不错。 ![桌面菜单](../Images/74a127f68658ff0b3e5f0fb719bf6cd0.png)

这是我想要在不影响桌面菜单的情况下设置样式的移动菜单 ![移动菜单](../Images/1ddd1453b3942dceafe916336da40be7.png)

已更改以下 css 以设置我的桌面菜单样式

```
.main-navigation ul.nav-menu,
    .main-navigation div.nav-menu > ul {
        border-bottom: 2px solid #f68a1f;
        border-top: none;
                margin: 0 0 2px 0;
                padding: 0px;
                padding-top: 50px;
        width: 550px;
    }
    .main-navigation ul {
        float: right;
                margin: 0;
                padding: 0;
                list-style: none;
    }
    .main-navigation li a,
    .main-navigation li {
        list-style: none;
                float: left;
                width: 90px;
                margin:0px;
    }
    .main-navigation li a {
        color: #292A2B;
            display: block;
            padding: 5px 5px;
            text-align:center;
            text-decoration: none;
            font-weight: normal;
            font-size: 14px;
            line-height: 30px;

            border-radius: 10px 10px 0px 0px;
            -moz-border-radius: 10px 10px 0px 0px;
            -webkit-border-bottom-right-radius: 0px;
            -webkit-border-bottom-left-radius: 0px;
    }
    .main-navigation li a:hover {
        color: #ffffff;
    background-color: #f68a1f;

    border-radius: 10px 10px 0px 0px;
    -moz-border-radius: 10px 10px 0px 0px;
    -webkit-border-bottom-right-radius: 0px;
    -webkit-border-bottom-left-radius: 0px;
    }
    .main-navigation li {
        margin: 0 40px 0 0;
        margin: 0 1rem 0 0;
        position: relative;
    }
    .main-navigation li ul {
        display: none;
        margin: 0;
        padding: 0;
        position: absolute;
        top: 100%;
        z-index: 1;
    }
    .main-navigation li ul ul {
        top: 0;
        left: 100%;
    }
    .main-navigation ul li:hover > ul {
        color: #ffffff;
    background-color: #f68a1f;

    border-radius: 10px 10px 0px 0px;
    -moz-border-radius: 10px 10px 0px 0px;
    -webkit-border-bottom-right-radius: 0px;
    -webkit-border-bottom-left-radius: 0px;
    }
    .main-navigation li ul li a {
        color: #292A2B;
                display: block;
            padding: 5px 5px;
            text-align:center;
            text-decoration: none;
            font-weight: normal;
            font-size: 14px;
            line-height: 30px;

    border-radius: 10px 10px 0px 0px;
    -moz-border-radius: 10px 10px 0px 0px;
    -webkit-border-bottom-right-radius: 0px;
    -webkit-border-bottom-left-radius: 0px;
    }
    .main-navigation li ul li a:hover {
        color: #ffffff;
                background-color: #f68a1f;

    border-radius: 10px 10px 0px 0px;
    -moz-border-radius: 10px 10px 0px 0px;
    -webkit-border-bottom-right-radius: 0px;
    -webkit-border-bottom-left-radius: 0px;
    }

    .main-navigation .current-menu-item > a,
    .main-navigation .current-menu-ancestor > a,
    .main-navigation .current_page_item > a,
    .main-navigation .current_page_ancestor > a {
        color: #ffffff;
                background-color: #f68a1f;
    } 
```

[来自主题http://pastebin.com/SFaT4BCn](http://pastebin.com/SFaT4BCn)的整个 css 文件

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T14:20:30.420

你使用媒体查询吗？尝试使用媒体查询来设置特定设备分辨率的样式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-30T09:02:58.280

找到 /* =媒体查询 /* 最小宽度为 600 像素。*/ 在 CSS 和主题中首先使用移动设备。刚刚将我的代码移至该部分。

# windows-8 - 如何通过代码获取应用程序名称？

> ID：13627375
> 
> 赞同：4
> 
> 时间：2012-11-29T13:57:42.913
> 
> 标签：windows-8, microsoft-metro

如何在基于 Windows 8 的应用程序中通过 javascript 代码获取应用程序名称？

编辑：更准确地说：我想要 package.appxmanifest 中的字符串 -> 应用程序 UI -> 显示名称

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-04-30T13:44:08.913

```
var package = Windows.ApplicationModel.Package.current;
var displayName = package.displayName; 
```

在 8.1 中添加

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-10T09:18:21.260

Marco 的回答很有帮助，但事实证明，由于 XML 命名空间要求记录不充分，因此转换为 Javascript 有点困难。LINQ-to-XML 与 XDocument 一样在 WinJS 中不可用，但在 Marco 引用的 C# 资源中使用。

这是我获得应用程序名称的方式。请注意，它是异步的；AFAIK 没有同步方式来获取应用程序名称。

```
var appname; 

(function() {
    Windows.ApplicationModel.Package.current.installedLocation.getFileAsync("AppxManifest.xml").then(function(file) {
        Windows.Storage.FileIO.readTextAsync(file).done(function (text) {
            var xdoc = new Windows.Data.Xml.Dom.XmlDocument();
            xdoc.loadXml(text);
            appname = xdoc.selectNodesNS("m:Package/m:Applications/m:Application/m:VisualElements",
                "xmlns:m=\"http://schemas.microsoft.com/appx/2010/manifest\"")[0]
                .attributes.getNamedItem("DisplayName").nodeValue;
        });
    });
})(); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-29T14:29:32.510

根据[this reference](http://social.msdn.microsoft.com/Forums/en-IE/winappswithcsharp/thread/1ac548fc-0b83-49b9-bb6b-3eabef5024c3)，无法获取显示名称。您可以从[Package.Id](http://msdn.microsoft.com/en-us/library/windows/apps/windows.applicationmodel.package.id.aspx)获取包名称，但听起来您想要显示名称。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-29T14:28:27.767

您可以查看包含在 Callisto Control Toolikit 中的[AppManifestHelper类。](https://github.com/timheuer/callisto/blob/master/src/Callisto/Controls/Common/AppManifestHelper.cs)**GetManifestVisualElementsAsync**方法返回一个具有**DisplayName**属性的**VisualElement**对象，这就是您要查找的内容。

 **请注意，此代码是用 C# 编写的，因此您需要将其转换为 Javascript。**

# javascript - 如何在 RequireJS 中混入 Underscore 插件？

> ID：13627376
> 
> 赞同：11
> 
> 时间：2012-11-29T13:57:44.633
> 
> 标签：javascript, asynchronous, requirejs, underscore.js, dynamic-script-loading

加载时在 Underscore 上执行代码的正确方法是什么？我正在尝试执行以下代码以在模块需要时自动扩展 _ 导出的命名空间：

```
_.mixin(_.str.exports()); 
```

文档有点含糊，但我想我把它放在了 shim init 部分？我尝试了以下方法，但我什至无法在 init 中找到断点：

```
require.config({
    paths: {
        jquery: 'libs/jquery/jquery.min',
        underscore: 'libs/underscore/lodash.min',
        underscorestring: 'libs/underscore/underscore.string.min'
    },

    shim: {
        underscore: {
            exports: '_'
        }
        underscorestring: {
            deps: ['underscore'],
            init: function (_) {
                //Mixin plugin to namespace
                _.mixin(_.str.exports());

                return _;
            }
        }
    }
}); 
```

当我尝试执行此操作并使用下划线字符串时，我收到此错误：

> 未捕获的类型错误：对象函数 s(e){return new o(e)} 没有方法“startsWith”

文件：

*   [http://requirejs.org/docs/api.html#config-shim](http://requirejs.org/docs/api.html#config-shim)
*   [http://requirejs.org/docs/api.html#config-callback](http://requirejs.org/docs/api.html#config-callback)

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-03-09T05:48:39.383

我不知道这是否是正确的方法，但我通过反转事物来使其工作，以便下划线取决于 underscore.string。此外，这样您就不必要求 underscore.string。

```
require.config({
  shim: {
    'backbone': {
      deps: ['underscore', 'jquery'],
      exports: 'Backbone'
    },
    'underscore': {
      deps: ['underscore.string'],
      exports: '_',
      init: function(UnderscoreString) {
        _.mixin(UnderscoreString);
      }
    }
  },
  paths: {
    'backbone'          : 'lib/backbone',
    'jquery'            : 'lib/jquery/jquery',
    'text'              : 'lib/require/text',
    'underscore'        : 'lib/underscore',
    'underscore.string' : 'lib/underscore.string'
  }
}); 
```

.

**更新：2014 年 3 月 14 日**

Underscore.js v1.6.0 恢复了 AMD 兼容性，`init()`并已从 RequireJS 中删除，因此需要进行一些重构。为了继续使用 Underscore.string 预加载 Underscore，我制作了一个混音器模块将它们拉到一起。

[新的 Require.js 配置]

```
requirejs.config({
  paths: {
    'backbone'            : '../lib/backbone/backbone',
    'backbone.base'       : '../lib/backbone/backbone.base',
    'backbone.extensions' : '../lib/backbone/backbone.extensions',
    'jquery'              : '../lib/jquery/jquery',
    'text'                : '../lib/require/text',
    'underscore'          : '../lib/underscore/underscore',
    'underscore.mixed'    : '../lib/underscore/underscore.mixed',
    'underscore.string'   : '../lib/underscore/underscore.string'
  },
  shim: {
    'backbone.base': {
      deps: ['underscore.mixed', 'jquery'],
      exports: 'Backbone'
    },
  }
}); 
```

[下划线混合]

```
define([
  'underscore',
  'underscore.string'
], function(_, _s) {
  _.mixin(_s.exports());
  return _;
}); 
```

最后一步是替换模块定义中的所有`'underscore'`实例`'underscore.mixed'`。我尝试将 Underscore 移动到一个名为的文件中，并将混音器设为`underscore.base.js`常规`underscore`（如 Backbone 设置）以避免此步骤。Underscore 作为一个*命名*模块，不同意这个计划。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-04T14:36:56.350

你在某处*需要*下划线吗？因为如果它不是必需的，它将不会被加载。我设法让它与您发布的几乎完全相同的代码一起工作：

```
require.config({
    paths: {
        underscore: [
            '//raw.github.com/documentcloud/underscore/master/underscore-min'
        ,   'lib/underscore'
        ]
    ,   underscorestring: 'https://raw.github.com/epeli/underscore.string/master/dist/underscore.string.min'
    }
,   shim: {
        underscore: { exports: '_' },
        underscorestring: {
            deps: ['underscore'],
            init: function(_) { 
                _.mixin(_.str.exports());
                return _; // guess, this is not needed.
            }
        }
    }
,   exclude: ['underscore']
});

require(['underscore', 'underscorestring'], function(_) {
    console.log( _.chars("i'm a happy string.") );
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-10-25T07:02:27.627

在我明白我做错了什么之前与这个斗争了几个小时

这就是我做错的

您不应该重命名 main.js 中的文件 underscore.string

即使在我的库中我确实将路径中的文件重命名为“underscore.string”

这就是你的**main.js**应该是什么样子

```
require.config({
paths: {
    underscore: 'lib/underscore', 
    'underscore.string' : 'lib/_string' ,
},
shim: { 
    underscore: {
        exports: '_', 
        deps: [ 'jquery', 'jqueryui' ]
    }, 
    'underscore.string': { 
        deps: [ 'underscore' ]
    },
} 
.... 
```

然后你可以像我为我的 mixin 文件所做的那样在你的 shim中添加它作为**依赖项**

```
shim: { 
    mixin : {
        deps: [ 'jquery',  'underscore', 'underscore.string' , 'bootstrap'  ] 
    }, 
```

或者只是在您的不同页面中**定义它，例如**

```
/*global define */
define([    
    'underscore.string'
], function ( ) { 
```

它现在可以工作了，您可以通过 _.str 或 _.string 访问它

这就是**为什么**您应该这样做，而不是尝试将其命名为其他名称

在 underscore.string.js 的第 663 行

```
 // Register as a named module with AMD.
  if (typeof define === 'function' && define.amd)
    define('underscore.string', [], function(){ return _s; }); 
```

这意味着如果您定义“underscore.string”，它只会向 AMD 要求 JS 注册它

对于混合，你可以只定义

```
 /*global define */
define([     
    'underscore',
    'underscore.string'
], function ( ) {   
  _.mixin(_.str.exports()); 
```

# objective-c - 更改 UICollectionViewLayout 时检测隐式动画的结束

> ID：13627377
> 
> 赞同：3
> 
> 时间：2012-11-29T13:57:45.850
> 
> 标签：objective-c, ios, uicollectionview

我目前正在使用 UICollectionView 并在使用 setCollectionViewLayout:animated: 将布局从一个更改为另一个之后：我想在动画完成后执行一些代码。知道如何实现吗？

干杯，

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-10-19T17:09:08.487

只是为了记录，现在有一个`-setCollectionViewLayout:animated:completion:`方法 on `UICollectionView`，在 iOS 7 中引入。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-29T23:22:36.533

我发现为了能够控制动画，而不是使用隐式动画，`setCollectionViewLayout:animated:`您可以使用标准 UIView`animationWithDuration`并更改`animations`块中的布局，如下所示：

```
[UIView animateWithDuration:0.4
                      delay:0
                    options:UIViewAnimationCurveEaseOut
                 animations:^{
                     self.oldView.collectionViewLayout = self.otherLayout;
                     self.newView.alpha = 1.0;
                 }
                 completion:^(BOOL finished){
                     self.oldView.alpha = 0.0;
                     self.otherLayout = nil;
                 }]; 
```

我不知道这是否是推荐的方法，但它可以让您控制动画并在完成后执行代码。

# javascript - 无法在 focusout jQuery 事件中检索 .val()

> ID：13627385
> 
> 赞同：-3
> 
> 时间：2012-11-29T13:58:12.587
> 
> 标签：javascript, jquery

尝试使用 jQuery 对某些输入字段的焦点输出（模糊或失去焦点）进行总计一些值。

以下是我正在使用的函数，但无论触发事件时在输入中找到什么，“newAmount”警报都完全空白：

```
//update personnel list total on blur
$('.personnel-list').focusout(function(){
    var currTotal = $('#personnel-office-total').val();
    var newAmount = $(this).val();
    var newTotal = currTotal+newAmount;
    $('#personnel-office-total').val(newTotal);
    alert(currTotal);
    alert(newAmount);
});

<li><label for="personnel-office-other">Other</label><input type="text" class="small-input personnel-input" name="personnel-office-other-dummy" id="personnel-office-other" /></li>
<li><label for="personnel-office-total">Total <em class="formee-req">*</em></label><input readonly="readonly" type="text" class="required small-input" name="personnel-office-managers-total" id="personnel-office-total" value="0" /></li> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T14:03:57.710

```
$('.personnel-input').focusout(function(){

}); 
```

而不是你所拥有的。

# android - 按钮的概念应该能够按下超过 30 秒

> ID：13627386
> 
> 赞同：1
> 
> 时间：2012-11-29T13:58:16.503
> 
> 标签：android, button, touch, long-press, motionevent

是否有机会实现一个能够在 MotionEvent Action_up 超时自动触发之前被按下的时间超过**30 秒的****元素？**

 **也许做这项工作的另一个概念？

目前我已经通过使用 onTouchListener 和 action_up 和 action_down 定义更改了 ImageButton 的图像。但是这个概念正在被`action_up`来自android的汽车所破坏。

**编辑：** 问题可能是由三星 android mod 引起的。它出现在 Galaxy Tab2 7.0 Wifionly 版本上，但不在 HTC Sensation XE 上。有没有人有 Galaxy Tab2 来交叉检查这种行为？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T15:57:39.930

试试这个代码作为你的解决方案，我想这会对你有所帮助。

```
@Override
public boolean onKeyLongPress(int keyCode, KeyEvent event) {
    if (keyCode == KeyEvent.KEYCODE_CALL) {
        // a long press of the call key.
        // do our work, returning true to consume it.  by
        // returning true, the framework knows an action has
        // been performed on the long press, so will set the
        // canceled flag for the following up event.
        return true;
    }
    return super.onKeyLongPress(keyCode, event);
} 
```

以下链接将引导您使用硬键的其他用途获得正确的结果。链接如下：- [Imp Link](http://android-developers.blogspot.in/2009/12/back-and-other-hard-keys-three-stories.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T08:50:34.910

我在其他三星平板电脑上测试了这个问题。结果是完全没有问题。只是我使用**三星 Galaxy Tab 2 WiFi 7.0 (P3110)**的平板电脑出现了这个问题。**

# ruby-on-rails - 在rails生产环境中上传文件后文件路径不会更新

> ID：13627391
> 
> 赞同：0
> 
> 时间：2012-11-29T13:58:36.000
> 
> 标签：ruby-on-rails, ruby, file-upload, passenger

`assets/books_icon`我有一个 Rails 应用程序，它将在用户创建书籍时上传名称与书籍 ID 相同的图像。

```
upload_icon(params[:book][:image_upload])

# upload_image when create/update book
    def upload_icon(uploaded_io)
       photo_directory = "app/assets/images/"

       # only when user upload the iphoto
       if uploaded_io.present?

         # upload to the exact location with category_id
         extension = File.extname(uploaded_io.original_filename)
         photo_location = 'books_image/'+ @book.id.to_s + extension

         # open in binary mode
         photo_full_location = photo_directory + photo_location
         File.open(photo_full_location, 'wb') do |file|
           file.write(uploaded_io.read)
         end

         # only have to state which is the directory, 
         # image_tag will use assets piepline which will add 'assets/images/' as prefix in src 
         @book.update_attribute(:image_url, photo_location)
       end
     end 
```

它在开发模式下工作。然后，我在以mysql为数据库的mac Apache2服务器上部署了带有乘客的rails应用程序，并`config.assets.compile = true`在开发配置文件中进行了更改。

在生产模式下，我可以创建新书并将图像上传到`assets/books_icon`. 但是，我刚刚上传的图像的文件路径不会`update`。

比如我新建了一本id为2的书，里面有2.jpg `assets/books_icon`。但是rails应用程序会告诉我`http://localhost/assets/images/books_icon/2.jpg`丢失了。

但是，当我重新启动 apache 服务器时，我可以在以下位置查看图片`http://localhost/assets/images/books_icon/2.jpg`

有什么办法可以解决这类`caching`问题吗？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T14:10:04.940

在这种情况下，上传的图像并不真正被视为“资产”——将其视为您碰巧存储在其他地方的数据。（图像资产可能是徽标或背景图像等）。Rails 的资产管道做了一些非常棘手的事情，以便在实际资源（例如图像）是资产时解析简单的文件路径。

默认情况下，Rails 将该`app/public`文件夹设置为文档根目录，因此您可以将图像上传到一个位置——也许在一个名为“upload/img”的子目录中，在这种情况下，您可以使用 path 引用它`/upload/img/mybook.jpg`。

然而，这种方法往往很脆弱，因为图像实际上直接与数据库中的数据相关联，但位于服务器的文件系统上。当您从开发转移到登台或生产服务器时，它开始分崩离析。

我*不*推荐的一种方法是上传图像并将其作为 blob 类型存储在数据库中。我建议的另一个*方法*是拥有另一个“中央”服务器，您可以将图像上传到它作为数据库的扩展。许多人使用亚马逊AWS“S3”服务来处理这种事情。看看[CarrierWave gem](https://github.com/jnicklas/carrierwave)，它在使所有这些变得非常简单、灵活和强大方面做得非常出色。

# performance - Kinetic-js：如何将完整的图层缓存为图像

> ID：13627393
> 
> 赞同：4
> 
> 时间：2012-11-29T13:58:51.333
> 
> 标签：performance, caching, kineticjs

我有一个问题，希望找到任何解决方案。

我正在使用 Kinetic.js 创建具有特殊外观的 HMI 解决方案。因此，我创建了一个为舞台创建 3 层的函数：一个带有网格的背景层，一个用于 HMI 屏幕基本布局的静态形状层和一个用于所有交互元素（如按钮、值显示等）的第三层在...）。现在我想缓存网格和静态层以提高性能，因为在整个 HMI 屏幕发生变化之前，这些层永远不会改变......

作为测试，我开始使用以下代码编写网格层的缓存：

```
// Create a grid layer if showGrid is set to TRUE...
console.log('Start to create background grid if required');
if (this.actualPageConfig.showGrid) {
    var grid = new Kinetic.Layer();
    for (var x=1; x <= this.cols; x++) {
        var eLoc = LCARSElements.posToRealPos(x, 1, this.cols, this.rows);
        if (x <= this.actualPageConfig.columns) {
            grid.add(new Kinetic.Line({
                points: [eLoc.x, eLoc.y, eLoc.x, eLoc.height],
                stroke: "red",
                strokeWidth: 1,
                lineCap: "round",
                lineJoin: "round" 
            }));
        }
    }
    for (var y=1; y <= this.rows; y++) {
        var eLoc = LCARSElements.posToRealPos(1, y, this.cols, this.rows);
        if (y <= this.actualPageConfig.rows) {
            grid.add(new Kinetic.Line({
                points: [eLoc.x, eLoc.y, eLoc.width, eLoc.y],
                stroke: "red",
                strokeWidth: 1,
                lineCap: "round",
                lineJoin: "round"
            }));
        }
    }

    // Add grid layer to stage
    //this.stage.add(grid);  <-- to be replaced by cache image

    // Convert grid into an image and add this to the stage
    console.log('convert grid to image to increase performance');
    grid.toImage({
        width:      displayManager.stage.getWidth(),
        height:     displayManager.stage.getHeight(),
        callback:   function(img) {
            var cacheGrid = new Kinetic.Image({ 
                image:  img,
                x:      0,
                y:      0,
                width:  displayManager.stage.getWidth(),
                height: displayManager.stage.getHeight()
            });
            console.log('insert grid-image to stage');
            displayManager.stage.add(cacheGrid);
            console.log('redraw stage...');
            displayManager.stage.draw();
        }
    });
} 
```

我的问题是，这不起作用。网格不再可见，控制台日志显示以下错误信息：

```
Type error: layer.canvas is undefined
layer.canvas.setSize(this.attrs.width, this.attrs.height);      kinetic.js (Zeile 3167) 
```

正如我已经发现当代码“displayManger.stage.add(cacheGrid) 将被执行时错误上升（displayManager 是这段代码被剪断的外部类）。任何人都可以看到我在哪里犯了错误？当我直接添加时图层网格一切正常...

我创建了一个 jsfiddle 来演示这个问题：[jsfiddle](http://jsfiddle.net/bruns8234/gw4JR/4/)

在小提琴中，您可以通过更改一个参数来运行这两个版本。希望这可以帮助....

感谢帮助。

最好的问候托尔斯滕

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-02T03:13:24.220

实际上，问题比您想象的要简单 - 将图层缓存到图像后，您尝试将图像对象直接添加到舞台（您不能这样做）。

要解决此问题，您需要创建一个新层，例如 cahcedLayer，将图像添加到 cachedLayer，然后将 cachedLayer 添加到舞台。

查看 KineticJS 信息页面以了解有关节点嵌套的更多信息：

[https://github.com/ericdrowell/KineticJS/wiki](https://github.com/ericdrowell/KineticJS/wiki)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-01T22:06:03.543

[http://rvillani.com/testes/layer-to-image/](http://rvillani.com/testes/layer-to-image/) 我已经做了这个测试并且它有效。首先，我在一个图层上绘制 1000 个正方形，将此图层添加到隐藏阶段，然后使用 stage.toDataURL() 从该阶段制作图像。当回调返回时，我只是从数据中创建一个图像，并从图像中创建一个 Kinetic.Image。然后我将它添加到我的主（可见）舞台上的一个图层中。代码（确保有一个名为“不可见”的 div）：

```
window.onload = function()
{
    var stage = new Kinetic.Stage({
        width: 520,
        height: 480,
        container: 'container'
    });

    var outerStage = new Kinetic.Stage({
        width: stage.getWidth(),
        height: stage.getHeight(),
        container: 'invisible'
    });

    var layerToCache = new Kinetic.Layer();
    var layer = new Kinetic.Layer();
    var group = new Kinetic.Group({offset: [stage.getWidth(), stage.getHeight()]});

    var anim = new Kinetic.Animation(function(frame){
        group.rotate(0.02);
    }, layer);

    var fills = ['red', 'green', 'blue', 'orange', 'purple', 'cyan',
        'black', 'brown', 'forestgreen', 'gray', 'pink'];
    for (var i = 0; i < 10000; ++i)
    {
        (function ()
         {
            var size = Math.random() * 60 + 20;
            var square = new Kinetic.Rect({
                width: size,
                height: size,
                fill: fills[i % fills.length],
                x: Math.random() * stage.getWidth() - 20,
                y: Math.random() * stage.getHeight() - 20
            });
            layerToCache.add(square);
         })();
    }

    var squaresImg = new Kinetic.Image();
    outerStage.add(layerToCache);
    outerStage.toDataURL({
        callback: function (dataURL){
            outerStage.clear();

            var img = new Image();
            img.src = dataURL;
            img.onload = function () {
                squaresImg.setImage(img);
                squaresImg.setX(squaresImg.getWidth() >> 1);
                squaresImg.setY(squaresImg.getHeight() >> 1);
                group.setX(stage.getWidth() >> 1);
                group.setY(stage.getHeight() >> 1);

                group.add(squaresImg);
                layer.add(group);
                layer.draw();
                anim.start();
            }
        }
    });

    var div = document.getElementById('invisible');
    div.parentNode.removeChild(div);

    stage.add(layer);
} 
```

# php - 使用 PDO 发送空值会导致错误

> ID：13627400
> 
> 赞同：2
> 
> 时间：2012-11-29T13:59:18.167
> 
> 标签：php, postgresql, pdo, double, postgresql-8.4

我们有类似下面的 PDO 语句，用于与 PostgreSQL 8.4 DB 进行通信。

```
$st = $db -> prepare("INSERT INTO Saba.Betriebskosten (personalkosten)
                                            VALUES(:kd_personalkosten)");
$st -> bindParam(':kd_personalkosten', $val['kd_personalkosten']); 
```

$val['kd_personalkosten'] 为空/null 或包含双精度值。在它为空/null的情况下，我们只想插入一个空值，但我们收到以下错误：

```
SQLSTATE[22P02]: Invalid text representation: 7 ERROR:  invalid input syntax for type double precision: ''; 
```

这意味着空/空被转换为与双精度字段不兼容的空字符串。如何规避这个错误？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T14:22:57.393

在我看来，值是“”（空字符串），bindParam 在 SQL 查询中转换为“”，并且由于 personalkosten 是 Double 类型，因此会引发错误。

这应该使用空文本来解决此问题，以进行双重转换：

```
$st -> bindParam(':kd_personalkosten', (float) $val['kd_personalkosten']); 
```

如果你真的想在变量为空时插入 NULL 值，那么你应该这样做：

```
$value = $val['kd_personalkosten'];
if ($value === '' or $value === NULL) {
    $st->bindValue(':kd_personalkosten', NULL, PDO::PARAM_NULL); // note the bindValue() instead of bindParam()
} else {
    $st->bindParam(':kd_personalkosten', $value);
} 
```

关于php 手册中的[bindValue vs bindParam](http://www.php.net/manual/en/pdostatement.bindparam.php)：

> 绑定参数（）
> 
> 将 PHP 变量绑定到用于准备语句的 SQL 语句中的相应命名或问号占位符。与 PDOStatement::bindValue() 不同，该变量被绑定为引用，并且只会在调用 PDOStatement::execute() 时进行评估。
> 
> 大多数参数是输入参数，即以只读方式用于构建查询的参数。一些驱动程序支持调用将数据作为输出参数返回的存储过程，而一些驱动程序还支持作为输入/输出参数发送数据并更新以接收数据的存储过程。

基本上 bindValue 允许您绑定直接值或常量，而 bindParam 需要传入变量或引用。

# asp.net - 在 Umbraco 中仍然可以查看奇怪的内容和已删除的页面

> ID：13627401
> 
> 赞同：2
> 
> 时间：2012-11-29T13:59:19.463
> 
> 标签：asp.net, xslt, web, iis-6, umbraco

我正在运行 umbraco v 4.0.3。我的网络服务器是 Windows Server 2003。

我注意到除了它托管的控件之外，我的一个页面还显示了来自父节点的内容。由于该页面仅用作 ascx 控件的宿主，因此它没有自己的内容。

节点的内容区域是空的，所以我不知道这些内容的来源。

我已经做了以下事情来试图解决这个问题，但没有一个会导致有问题的页面发生变化。页面仍然存在。

*   我再次发布了节点。
*   我点击了取消发布按钮，然后发布了节点。
*   我已经清除了我的浏览器缓存。
*   我用过多个浏览器。
*   我在 Chrome 上使用了隐身模式。
*   我已经更改了节点所基于的模板，这应该阻止宏运行，但它没有。
*   我已将内容添加到节点。新内容没有出现。
*   我已经更改了节点的名称。当我以旧名称重新加载页面时，它仍然存在。
*   我已经触及 web.config 以重新启动应用程序。没有变化。
*   我已经停止并启动了该网站。
*   我已经右键单击站点的顶部节点，然后选择“重新发布”
*   我已经手动删除了 data 文件夹下的 umbraco.conf 文件。
*   我什至删除了节点。

**当我导航到页面时，我所做的**任何事情都不会改变出现的内容。**此时，我应该得到一个 404，但页面仍然加载并且仍然运行宏。**

 **在这一点上，我不知所措，但我猜这与 IIS 或 Dot.Net 和缓存有关。

有人知道如何解决这个问题吗？

**编辑**

我发现，如果我从构建已删除页面的模板中删除了 XSLT 宏引用，则在浏览器中加载已删除页面时，父页面的副本就会消失。由于这是我的主要问题，我重新创建了页面并继续。我仍然对为什么我删除的页面能够从多个浏览器加载感到困惑。

我删除的宏在我们网站的 1,500 多个页面中的大多数中使用，并且在它们中都没有在子页面上复制父文档，在*我看来*，XSLT 宏也不可能到达XML 缓存。我查看了代码，没有看到任何对其他数据存储的引用。我承认 XSLT 对我来说很新。

下面列出了我删除其引用的宏的代码。

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE xsl:Stylesheet [ <!ENTITY nbsp "&#x00A0;"> ]>
<xsl:stylesheet 
  version="1.0" 
  xmlns:xsl="http://www.w3.org/1999/XSL/Transform" 
  xmlns:msxml="urn:schemas-microsoft-com:xslt"
  xmlns:umbraco.library="urn:umbraco.library"
  xmlns:custom="urn:custom.library"
  exclude-result-prefixes="msxml umbraco.library custom">

<xsl:output method="xml" omit-xml-declaration="yes"/>

<msxml:script language="C#" implements-prefix="custom">

  public System.Xml.XPath.XPathNodeIterator SplitMultiPageText(string unsplitText, 
                                                               string pageDelimeter) {
    System.Xml.XmlDocument xmlDoc = new System.Xml.XmlDocument();
    string[] splitPages = System.Text.RegularExpressions.Regex.Split(unsplitText, pageDelimeter);

    System.Xml.XmlElement pagesElement = xmlDoc.CreateElement("pages");

    foreach (string page in splitPages) {
      System.Xml.XmlElement pageElement = xmlDoc.CreateElement("page");
      pageElement.AppendChild(xmlDoc.CreateCDataSection(page));
      pagesElement.AppendChild(pageElement);
    }

    return pagesElement.CreateNavigator().Select(".");
  }

</msxml:script>

<xsl:param name="currentPage"/>

<xsl:variable name="content" select="/macro/content" />
<xsl:variable name="pageNumber" select="/macro/pageNumber" />
<xsl:variable name="joinContent">
  <xsl:choose>
    <xsl:when test="/macro/joinContent = ''">
      <xsl:value-of select="boolean(false)" />
    </xsl:when>
    <xsl:otherwise><xsl:value-of select="/macro/joinContent" /></xsl:otherwise>
  </xsl:choose>
</xsl:variable>

<xsl:variable name="splitExpr">&lt;hr class=&quot;pagebreak&quot; /&gt;</xsl:variable>

<xsl:template match="/">

  <xsl:variable name="pages" select="custom:SplitMultiPageText($content, $splitExpr)" />
  <xsl:variable name="pageCount" select="count($pages/page)" />

  <xsl:choose>
    <xsl:when test="$pageCount = 1 or string($joinContent) = 'true'">

      <xsl:for-each select="$pages/page">
        <xsl:value-of
          select="umbraco.library:RenderMacroContent(., $currentPage/@id)"
          disable-output-escaping="yes" />
      </xsl:for-each>

    </xsl:when>
    <xsl:otherwise>
      <p class="multiPageNotice">This document is split among multiple pages. To view
      the other pages, use the <strong>page selector</strong> near the bottom of the screen.</p>
      <xsl:for-each select="$pages/page">
        <xsl:if test="position() = $pageNumber or ( $pageNumber = '' and position() = 1 )">
          <xsl:value-of
            select="umbraco.library:RenderMacroContent(., $currentPage/@id)"
            disable-output-escaping="yes" />
        </xsl:if>
      </xsl:for-each>
    </xsl:otherwise>
  </xsl:choose>

  <xsl:if test="$pageCount &gt; 1 and string($joinContent) != 'true'">
    <div class="pageSelector">
      <p>Page: </p>
      <ul>
        <xsl:for-each select="$pages/page">
          <li>
            <xsl:choose>
              <xsl:when test="position() = $pageNumber or ( $pageNumber = '' and position() = 1 )">
                <xsl:value-of select="position()" />
              </xsl:when>
              <xsl:otherwise>
                <a href="{umbraco.library:NiceUrl($currentPage/@id)}/page/{position()}">
                  <xsl:value-of select="position()" />
                </a>
              </xsl:otherwise>
            </xsl:choose>
          </li>
        </xsl:for-each>
      </ul>
    </div>
  </xsl:if>

</xsl:template>

</xsl:stylesheet> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T09:05:35.437

鉴于您的评论，宏可能会将内容保存到独立于应用程序/umbraco 配置的存储中，例如 xml 文件或基于 db 的会话。这显然会在应用程序重新启动之外保留数据。显然，我们将不得不查看宏的代码。**

# r - 在 R 中转换日期时如何处理空白项

> ID：13627405
> 
> 赞同：5
> 
> 时间：2012-11-29T13:59:28.487
> 
> 标签：r, na, missing-data, as.date

我从管理信息系统下载了 csv 数据。有一些变量是日期，并以“2012/11/16 00:00:00”格式的字符串形式写入 csv。

读取 csv 文件后，我使用 as.Date() 函数将日期变量转换为日期。这适用于所有不包含任何空白项的变量。

对于那些确实包含空白项目的人，我收到以下错误消息：“字符串不是标准的明确格式”

如何让 R 用“0000/00/00 00:00:00”之类的东西替换空白项目，以便 as.Date() 函数不会中断？您还有其他方法可以推荐吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T14:10:48.917

如果它们是字符串，做一些简单的事情

```
mystr <- c("2012/11/16 00:00:00","   ","")
mystr[grepl("^ *$",mystr)] <- NA
as.Date(mystr) 
```

工作？（正则表达式`"^ *$"`查找由字符串开头（`^`）、零个或多个空格（`*`）以及字符串结尾（`$`）组成的字符串。更一般地说，我认为您可以使用它`"^[[:space:]]*$"`来捕获其他类型的空格（制表符等.)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-11-13T14:14:49.453

更好的是，在读取 CSV 时正确插入 NA：

```
read.csv(..., na.strings='') 
```

或指定应读取为 NA 的所有值的向量...

```
read.csv(..., na.strings=c('','  ','   ')) 
```

# mysql - 如何在mysql中使用group by更新表数据

> ID：13627406
> 
> 赞同：0
> 
> 时间：2012-11-29T13:59:34.270
> 
> 标签：mysql

我遇到了一种情况，我有两列（**col1，col2**）的表，我添加了布尔列（**col3**）。现在我必须更新具有不同 col1 和 col2 的第一次出现的行（即）与我们从 group by col1 获得的行相同，其中**col3 为 true**。

```
 create table my_table( col1 integer, col2 integer, col3 tinyint(1));

 insert into my_table(col1,col2) values(1,2);
 insert into my_table(col1,col2) values(1,1);
 insert into my_table(col1,col2) values(2,1);
 insert into my_table(col1,col2) values(2,2);
 insert into my_table(col1,col2) values(2,8);
 insert into my_table(col1,col2) values(3,2);
 insert into my_table(col1,col2) values(3,1);
 insert into my_table(col1,col2) values(3,5);
 insert into my_table(col1,col2) values(3,6);
 insert into my_table(col1,col2) values(4,3);
 insert into my_table(col1,col2) values(4,6);
 insert into my_table(col1,col2) values(4,5);
 insert into my_table(col1,col2) values(4,2); 
```

当我添加新的列表时，col3 null 具有以下值。

```
 COL1   COL2    COL3
  1     2      (null)
  1     1      (null)
  2     1      (null)
  2     2      (null)
  2     8      (null)
  3     1      (null)
  3     2      (null)
  3     5      (null)
  3     6      (null)
  4     3      (null)
  4     6      (null)
  4     5      (null)
  4     2      (null) 
```

我想要一个查询来更新我的表，如下所示：

```
 COL1  COL2    COL3
  1     2        1
  1     1      (null)
  2     1        1
  2     2      (null)
  2     8      (null)
  3     1        1
  3     2      (null)
  3     5      (null)
  3     6      (null)
  4     3        1
  4     6      (null)
  4     5      (null)
  4     2      (null) 
```

SQLFiddle 架构链接：[http ://sqlfiddle.com/#!2/0ddce/1](http://sqlfiddle.com/#!2/0ddce/1)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T15:59:25.287

我在您的示例数据上对此进行了测试，并且可以正常工作：

```
UPDATE  my_table

SET     col3 = 1

WHERE   col2 = (SELECT col2
                  FROM   my_table m
                  WHERE  m.col1 = col1
                  LIMIT 1
                 ); 
```

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-11-29T14:08:35.877

如果您不介意在更新中出错，您可以将 col1 定义为主键。这将确保如果 col1 存在于您的表中，则无法再次添加它。

# in-app-purchase - 在应用内购买，不同类型的产品

> ID：13627413
> 
> 赞同：0
> 
> 时间：2012-11-29T14:00:10.197
> 
> 标签：in-app-purchase, in-app-billing

我想创建一个用户可以使用 14 天的应用程序，可以说是试用版，然后用户必须支付一次，如果他继续使用该应用程序，我该如何实现？我应该使用什么产品类型？我应该使用“消耗品”还是“非消耗品”或“自动续订订阅”或“免费订阅”或“非续订订阅”。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T09:04:11.330

我将使用非续订订阅，我在文档中找到了答案。

```
Non-Renewing Subscription allow the sale of services with a limited duration. 

Non-Renewing Subscriptions must be used for in-app purchases that offer time-based 
access to static content and are only available to iOS apps.
If you use non-renewing subscription, your app is responsible for delivering the
subscription to all the user's devices.

Because a non-renewing subscription requires a user to renew each time, your app 
must contain code that recognizes when the subscription is due to expire. It must 
also prompt the user to purchase a new subscription. 
```

# jsf - 使包含页面的控制器的 PostConstruct 运行

> ID：13627417
> 
> 赞同：0
> 
> 时间：2012-11-29T14:00:18.730
> 
> 标签：jsf

我有一个模板：

```
<html xmlns="blahblah">
<h:commandLink></h:commandLink>

 <ui:insert name="body" />
</html> 
```

使用此模板的页面：

```
<ui:composition xmlns="blahblah"
    template="/templates/template_main.xhtml">

    <ui:define name="body">
#{controller1.blahblah}
       </ui:define>

</ui:composition> 
```

使用此模板的另一个页面：

```
<ui:composition xmlns="blahblah"
    template="/templates/template_main.xhtml">

    <ui:define name="body">
#{controller2.blahblah}
       </ui:define>

</ui:composition> 
```

当我单击模板中的命令链接时，我希望`controller1`'s 或`controller2`'s运行。`@PostConstruct`

或者，如果这是不可能的，我如何获取当前包含页面的信息，以及它的控制器 bean 来调用它的`@PostConstruct`.

# sql - 如何在普通 SQL 中换行

> ID：13627419
> 
> 赞同：0
> 
> 时间：2012-11-29T14:00:23.430
> 
> 标签：sql, hibernate, jdbc

我有一个`import.sql`用于预填充 Arquillian 测试的数据库。有些行太长了，我想把它们格式化成几行。不幸的是，我找不到任何有用的建议——我只找到了不适用于普通 SQL 的示例，而是适用于用不同编程语言表示 SQL 的字符串。

我尝试过疯狂的猜测，通过按 Return 或在它们之间插入不同的字符来分隔行 - `\`、`/`、`_`，`&`但`+`没有任何效果。当 Hibernate 拾取并执行文件时，`JdbcSQLException`会抛出 a：

```
JdbcSQLException: Syntax error in SQL statement "INSERT INTO KVS_MIPO(LSTORT, LOGIN, NAME, LANR)/[*] "; expected "DIRECT, SORTED, DEFAULT, VALUES, SET, (, SELECT, FROM"; SQL statement: 
```

原行工作正常：

```
insert into KVS_MIPO(LSTORT, LOGIN, NAME, LANR) values ('123456789', 'x123456789', 'Name', 'lanr') 
```

# android - Flurry（Android），如何记录用户交互之间的时间？

> ID：13627420
> 
> 赞同：0
> 
> 时间：2012-11-29T14:00:29.143
> 
> 标签：android, flurry

我有点惊讶 Flurry-Android 的文档如此简陋。让我们举个例子：你的应用程序有用户完成的级别，你如何记录用户完成每个级别所花费的时间？

这是事件的基本 API 调用：

```
FlurryAgent.logEvent(String eventId, Map < String, String\> parameters, boolean timed)  
FlurryAgent.logEvent(String eventId, boolean timed) 
```

你应该把它放在哪里`levelindex`以及时间是如何工作的？数据将如何呈现？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T22:03:13.960

你需要打电话`endTimedEvent`。在您记录用户完成关卡所需时间的示例中，您将在关卡开始时执行以下操作：

```
Map<String, String> params = new HashMap<String, String>();
params.put("index","1");
FlurryAgent.logEvent("PlayingLevel", params, true); 
```

...以及关卡结束时的以下内容：

```
FlurryAgent.endTimedEvent("PlayingLevel"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T12:18:00.387

注意：Flurry 有关于如何在线记录事件持续时间的文档。查看第 3 层事件部分的示例代码。

[http://support.flurry.com/index.php?title=Analytics/GettingStarted/Events/Android](http://support.flurry.com/index.php?title=Analytics/GettingStarted/Events/Android)

# javascript - 什么是“匹配选择器”？

> ID：13627423
> 
> 赞同：1
> 
> 时间：2012-11-29T14:00:39.140
> 
> 标签：javascript, jquery, jquery-selectors

这是一个小的 jQuery 插件，我用于在查询没有返回选择器时获取 console.warn

```
(function($, w, c){
if(!w.jQuery || !c) return;
c.w = c.warn || c.log; // safely use either warn or log
// jQuery and console.warn/log are available, we're good to go

var _find = $.find,
    _attr = $.fn.attr;

// 'duck punch' jQuery.find - Replace with a wrapper function with our warning which returns the original result
$.find = function(){
    var result = _find.apply(this, arguments);
    if(!result.length) c.w('jQuery Selector "' + result.selector + '" returned no matches');
    return result;
};

$.fn.attr = function(attr){
    if(arguments.length === 1) {
        var result = _attr.call(this, attr);
        if(result === void 0) {
            c.w('jQuery Attribute Getter for "' + attr + '" returned undefined for selector "' + $(this).selector + '"');
        }
        return result;
    } else {
        _attr.apply(this, arguments);
        return this;
    }
};

w.jQuery = w.$;

}(jQuery, window, console)); 
```

当有一个空选择器时，我在控制台中得到的是：

```
Uncaught TypeError: Object function (){
    var result = _find.apply(this, arguments);
    if(!result.length) c.w('jQuery Selector "' + result.selector + '" returned no matches');
    return result;
} has no method 'matchesSelector' 
```

我不明白它是什么`matchesSelector`以及它来自哪里

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-29T14:08:02.070

您正在覆盖`$.find`但没有替换 jQuery 所依赖的属性。`$.find`有许多属性，例如`matchesSelector`,`matches`等，因为它们没有分配给您的函数而丢失。

你不应该覆盖`$.find`

您可以将它们附加回来，但我有一种不好的感觉，仍然遗漏了一些其他问题：

```
var _find = $.find,
    empty = function() {};

$.find = function() {};

for (var key in _find) {
                                      //ignore standard function properties
    if (_find.hasOwnProperty(key) && !empty.hasOwnProperty(key)) {
        $.find[key] = _find[key];
    }
} 
```

在整个 jQuery 源代码中都有对属性的硬编码引用`$.find`，例如：

```
 jQuery.find.matchesSelector(cur, selectors) ) { 
```

用这些填充普通对象的结果：

```
var myObj = {}, empty = function(){};

for (var key in $.find) {
    if ($.find.hasOwnProperty(key) && !empty.hasOwnProperty(key)) {
        myObj[key] = $.find[key];
    }
}

myObj
Object
attr: function (a,c,d,e){var g,h,i,j=a.nodeType;if(!!a&&j!==3&&j!==8&&j!==2){if(e&&c in f.attrFn)return f(a)[c](d);if(typeof a.getAttribute=="undefined")return f.prop(a,c,d);i=j!==1||!f.isXMLDoc(a),i&&(c=c.toLowerCase(),h=f.attrHooks[c]||(u.test(c)?x:w));if(d!==b){if(d===null){f.removeAttr(a,c);return}if(h&&"set"in h&&i&&(g=h.set(a,d,c))!==b)return g;a.setAttribute(c,""+d);return d}if(h&&"get"in h&&i&&(g=h.get(a,c))!==null)return g;g=a.getAttribute(c);return g===null?b:g}}
contains: function (a,b){return a!==b&&(a.contains?a.contains(b):!0)}
error: function (a){throw new Error("Syntax error, unrecognized expression: "+a)}
filter: function (a,c,d,e){var f,g,h,i,j,k,l,n,p,q=a,r=[],s=c,t=c&&c[0]&&m.isXML(c[0]);while(a&&c.length){for(h in o.filter)if((f=o.leftMatch[h].exec(a))!=null&&f[2]){k=o.filter[h],l=f[1],g=!1,f.splice(1,1);if(l.substr(l.length-1)==="\\")continue;s===r&&(r=[]);if(o.preFilter[h]){f=o.preFilter[h](f,s,d,r,e,t);if(!f)g=i=!0;else if(f===!0)continue}if(f)for(n=0;(j=s[n])!=null;n++)j&&(i=k(j,f,n,s),p=e^i,d&&i!=null?p?g=!0:s[n]=!1:p&&(r.push(j),g=!0));if(i!==b){d||(s=r),a=a.replace(o.match[h],"");if(!g)return[];break}}if(a===q)if(g==null)m.error(a);else break;q=a}return s}
find: function (a,b,c){var d,e,f,g,h,i;if(!a)return[];for(e=0,f=o.order.length;e<f;e++){h=o.order[e];if(g=o.leftMatch[h].exec(a)){i=g[1],g.splice(1,1);if(i.substr(i.length-1)!=="\\"){g[1]=(g[1]||"").replace(j,""),d=o.find[h](g,b,c);if(d!=null){a=a.replace(o.match[h],"");break}}}}d||(d=typeof b.getElementsByTagName!="undefined"?b.getElementsByTagName("*"):[]);return{set:d,expr:a}}
getText: function (a){var b,c,d=a.nodeType,e="";if(d){if(d===1||d===9){if(typeof a.textContent=="string")return a.textContent;if(typeof a.innerText=="string")return a.innerText.replace(k,"");for(a=a.firstChild;a;a=a.nextSibling)e+=n(a)}else if(d===3||d===4)return a.nodeValue}else for(b=0;c=a[b];b++)c.nodeType!==8&&(e+=n(c));return e}
isXML: function (a){var b=(a?a.ownerDocument||a:0).documentElement;return b?b.nodeName!=="HTML":!1}
matches: function (a,b){return m(a,null,null,b)}
matchesSelector: function (a,c){c=c.replace(/\=\s*([^'"\]]*)\s*\]/g,"='$1']");if(!m.isXML(a))try{if(e||!o.match.PSEUDO.test(c)&&!/!=/.test(c)){var f=b.call(a,c);if(f||!d||a.document&&a.document.nodeType!==11)return f}}catch(g){}return m(c,null,null,[a]).length>0}
selectors: Object
uniqueSort: function (a){if(u){h=i,a.sort(u);if(h)for(var b=1;b<a.length;b++)a[b]===a[b-1]&&a.splice(b--,1)}return a} 
```

# error-handling - 抑制整个脚本的错误

> ID：13627425
> 
> 赞同：8
> 
> 时间：2012-11-29T14:00:47.370
> 
> 标签：error-handling, vbscript, gpo

我想抑制所有可能出现在我的 VBS 登录脚本中的错误。

我可以用以下内容围绕整个 500 行脚本：

```
On Error Resume Next

'[... whole script (~500 lines of code) ...]

On Error GoTo 0 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-29T14:40:42.817

你**可以**这样做——即使没有 OEG0 行——但你不应该这样做，因为脚本将继续执行 i ... last 行，即使 i-1 行中的错误使你对必要先决条件的所有假设都无效这些行中的动作。你的策略相当于闭着眼睛开车，以免被其他汽车的车头灯弄得眼花缭乱。

如果您不能对选定的操作进行本地限制的错误处理 -

```
...
On Error Resume Next
  risky_action
  save Err
On Error GoTo 0
If ErrorOccurred Then
   something sensible
   If can't continue Then
      WScript.Quit 4711
   End If
End If
... 
```

试图摆脱

```
Sub Main()
  ... you 500 lines ...
End Sub 

On Error Resume Next
  Main
  If Err.Number Then
     WScript.Echo "aborted"
     WScript.Quit 4711
  End If 
```

这种方法确保错误后的行不会被执行。

# c# - 如何从 CompositionContainer 注销 ComposablePart

> ID：13627428
> 
> 赞同：1
> 
> 时间：2012-11-29T14:00:52.167
> 
> 标签：c#, memory-leaks, mef, composition

我正在使用带有静态 CompositionContainer 的 MEF。我的班级像这样使用这个容器：

```
public void SomeClass
{
    [Import(typeof(AnotherClass)]
    private AnotherClass Instance {get;set;}

    public SomeClass()
    {
        MEFContext.RegisterAttributedPart(this); // this basically calls CompositionContainer.ComposeParts(this);
    }
} 
```

现在的问题是，SomeClass 的实例永远不会被释放，因为 CompositionContainer 为它保留了一个实例。我怎样才能释放这个实例？

附加信息：

*   AnotherClass 有一个 PartCreationPolicy 和 CreationPolicy.Shared

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T19:25:10.740

[CompositionContainer](http://msdn.microsoft.com/en-us/library/system.componentmodel.composition.hosting.compositioncontainer.aspx)实现 IDisposable。您是在 CompositionContainer 上调用 Dispose 还是 using 模式并释放对它的引用？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T10:36:08.417

在 .NET 4 中，MEF 的使用实现似乎不支持子容器和过滤目录。我通过创建一个新容器并使用仅包含必要项目的目录解决了上述问题。这个容器在我不再需要时被丢弃。在 .NET 4.5 中，这可以通过子容器来解决。

# http-headers - 冒号和等号在 http 标头中的处理方式相同吗？

> ID：13627438
> 
> 赞同：2
> 
> 时间：2012-11-29T14:01:28.183
> 
> 标签：http-headers

在以下示例中，冒号 (:) 和等号 (=) 都用于发送 http 标头。

```
 header('Content-Type: text/html; charset=iso-8859-1'); 
```

它们可以互换吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T14:04:06.693

不，他们不是。实际上，

```
Content-Type: text/html; charset=iso-8859-1 
```

意味着`Content-Type`具有价值

```
text/html; charset=iso-8859-1 
```

即，您的标题中没有`charset`字段。

# ruby - 我如何确保一个进程正在运行，即使它会杀死自己？（然后需要重新启动）

> ID：13627440
> 
> 赞同：2
> 
> 时间：2012-11-29T14:01:38.840
> 
> 标签：ruby, linux, process, cron, boot

我正在使用Linux。我希望每次启动计算机时都运行一个进程（一个 irc 机器人）。但是我遇到了一个问题：网络不好，经常断开连接，所以我需要每天手动重启几次机器人。我该如何自动化呢？

附加信息： bot 创建一个名为 bot.pid 的 pid 文件 bot 重新连接自身，但只有几次。网络太糟糕了，所以机器人有时会因为没有响应而自杀。

我目前所做的（也就是我的方法；））我`startbot.rb`每 5 分钟执行一次 cron 作业。（脚本本身与机器人位于同一目录中）

剧本：

```
#!/usr/bin/ruby
require 'fileutils'

if File.exists?(File.expand_path('tmp/bot.pid'))
  @pid = File.read(File.expand_path('tmp/bot.pid')).chomp!.to_i
  begin
    raise "ouch" if Process.kill(0, @pid) != 1
  rescue
    puts "Removing abandoned pid file"
    FileUtils.rm(File.expand_path('tmp/bot.pid'))
    puts "Starting the bot!"
    Kernel.exec(File.expand_path('./bot.rb'))
  else
    puts "Bot up and running!"
  end
else
  puts "Starting the bot!"
  Kernel.exec(File.expand_path('./bot.rb'))
end 
```

这是做什么的：它检查 pid 文件是否存在，如果是，它检查是否`kill -s 0 BOT_PID == 1`（如果机器人正在运行）并在两个检查之一失败/不正确时启动机器人。

我的方法似乎很脏，所以我该如何做得更好？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-29T14:19:49.317

重新启动应用程序是一个糟糕的解决方法，而不是解决方案。

我建议查看你的机器人的文档，寻找一个选项来配置它退出多少次错误重试或如何完全禁用此功能。如果 bot 是开源的，您还可以查看其源代码并修改重试代码。尝试找到一个干净的解决方案。

编辑：如今，如果您的系统使用 systemd 而不是 init，请为您的机器人创建一个服务文件 /etc/systemd/system/bot.service，如下所示：

```
[Unit]
Description=bot service
After=network.target

[Service]
Type=simple
Restart=always
RestartSec=10
ExecStart=/usr/bin/ruby /path/to/bot.rb

[Install]
WantedBy=multi-user.target 
```

这将在 10 秒后重新启动机器人。还可以考虑使用该`User=`指令，这样它就不会在不需要时在 root 权限下运行，或者使用 systemd 的用户实例。有关选项的更多信息，请参阅 systemd[文档](http://www.freedesktop.org/software/systemd/man/systemd.service.html)。对于用户 systemd 服务，请参阅[这个问题](https://superuser.com/questions/476379/how-do-i-setup-a-systemd-service-to-be-started-by-a-non-root-user-as-a-user-daem)、[arch linux wiki](https://wiki.archlinux.org/index.php/Systemd/User)和[官方文档](https://www.freedesktop.org/software/systemd/man/systemd.unit.html)。

然后用**systemctl enable bot**启动它（重启后启动机器人）和**systemctl start bot**

或者，我会创建一个循环运行机器人的 shellscript。确保 bot.rb 不会分叉到后台：

```
#/bin/bash
for (( ; ; ))
do
     ./bot.rb
done 
```

您可以运行该脚本， `nohup ./startscript.sh &` 以便在关闭控制台时它不会终止。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-29T14:07:18.757

有一个名为 daemontools 的工具，用于监督和管理 UNIX 服务

从此[链接](http://cr.yp.to/daemontools.html)您可以学习和使用它。

# java - Java项目（包括前端技术）中如何计算KLOC？

> ID：13627444
> 
> 赞同：3
> 
> 时间：2012-11-29T14:01:51.973
> 
> 标签：java, jsp, freemarker, metrics, lines-of-code

我想知道我的项目的总 KLOC，包括他们的前端技术（例如 freemarker）。我们使用 IntelliJ IDE 和 Jacoco 来收集 Java（仅限）文件的指标。标准技术栈大致如下：

1.  Java、Spring、JSP、Freemarker 模板、iBatis（XML 中的查询）、Hibernate

2.  Java、Groovy 和 Grails（前端的 gsp）

您如何计算每种类型项目的整个堆栈的总 KLOC？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T14:33:27.967

试试[ohcount](https://github.com/blackducksw/ohcount)。这将为许多不同的语言生成一个很好的报告，其中包含注释和空格。

# mysql - HAVING COUNT(DISTINCT `goodfor_what`.`name`) = 3 导致错误消息

> ID：13627446
> 
> 赞同：1
> 
> 时间：2012-11-29T14:01:57.557
> 
> 标签：mysql, sql

我收到错误消息

> 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在 GROUP BY name HAVING COUNT(DISTINCT goodfor_when.name) = 1 附近使用正确的语法。

这是发生错误的查询的一部分

```
 ....
        WHERE 
        ( `city`.`name` = "London" ) AND 
        `goodfor_what`.`name` IN ("Beers","Wine","Food") 
        GROUP BY name 

        HAVING COUNT(DISTINCT `goodfor_what`.`name`) = 3 AND `goodfor_when`.`name` IN ('Daytime') GROUP BY name
        HAVING COUNT(DISTINCT `goodfor_when`.`name`) = 1 ORDER BY `t`.`name`, `t`.`id`; 
```

但如果删除线有效

```
HAVING COUNT(DISTINCT `goodfor_what`.`name`) = 3 AND `goodfor_when`.`name` IN ('Daytime') GROUP BY name 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-29T14:04:32.853

同一查询中不能有两个`HAVING`或两个命令，并且必须放在. 因此，例如：`GROUP BY``GROUP BY``HAVING`

```
GROUP BY name
HAVING (COUNT(DISTINCT `goodfor_what`.`name`) = 3 AND `goodfor_when`.`name` IN ('Daytime'))
OR COUNT(DISTINCT `goodfor_when`.`name`) = 1 
ORDER BY `t`.`name`, `t`.`id`; 
```

还有更多，除非`t.id`是聚合列，否则你必须`SELECT t.id`并且`GROUP BY t.id`如果你想`ORDER BY t.id`

# java - 在 JFace 数据绑定中，如果验证失败，是否可以取消小部件中的更改？

> ID：13627448
> 
> 赞同：2
> 
> 时间：2012-11-29T14:02:00.853
> 
> 标签：java, data-binding, swt, jface, eclipse-databinding

在处理组合框查看器时，它的选择被绑定并为它设置了一个验证器。我想知道如果选择呈现无效值是否可以取消选择的更改？

我问这个的原因是，当更改发生时，如果验证器在此更改上失败，则模型将不会更新。但是，小部件仍然发生了变化；在这种情况下，在我看来，小部件和模型处于不一致状态。

我在这里错过了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T16:43:40.347

我认为您应该在验证失败后立即调用`org.eclipse.core.databinding.Binding.updateModelToTarget()`以将值从模型同步到目标。

# java - 自己创建一个 ResultSet 对象

> ID：13627449
> 
> 赞同：2
> 
> 时间：2012-11-29T14:02:10.550
> 
> 标签：java, resultset

我想为一个类创建一个Testclass，它从数据库中读取数据并进行转换。测试类应该测试这个转换函数。但是我可以测试这个函数，我需要一个 ResultSet 对象。

如何在不连接数据库的情况下在 ResultSet 对象中填充一些数据？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T14:10:46.333

从数据库读取涉及**集成测试**，而不是**单元测试**。因此，您可以并且应该使用原始`ResultSet`版本，因为集成测试需要考虑真正的后端（例如您的数据库）。

如果您尝试对您的逻辑进行单元测试，请存根或模拟您称为部分的特定 DAO，以便返回要测试的样本数据。但是在这种情况下根本不要调用数据库（不要处理`ResultSet`）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T14:11:44.300

类似于下面的代码：您需要一个接口来访问数据库。您在代码和测试代码中使用的这个接口： myDbConnectionMock 是一个 Mock 对象，它与 Db 连接具有相同的接口，但它是一个您创建的对象，您可以在其中填写您想要的内容：

我不会使用 Mockito 或更糟糕的 EasyMock。

我在文本编辑器中输入的代码（希望是可编译的，也许不是）：

```
public void testDBConnection() {

  IDataBaseConnection conn = new MyDbConnectionMock();

  conn.connect();
  Set<Result> result = conn.readData();

  assertTrue(result.size > 0);
} 
```

在哪里

```
 // Interface for DB connection, adapt to real DB connection
    public interface IDataBaseConnection {
       boolean connect();
       Set<Result> readData();
    } 
```

和

```
// DB connection Mock
class MyDbConnectionMock implements IDbConnection {
  public void connect() {
     return true;
  }

  public Set<ResultSet> readData() {
     Set<Result> resultSet = new HashSet<Result>();
     Result res1 = new Result(20);
     resultSet.add(res1);

     Result res1 = new Result(30);
     resultSet.add(res2);
     return resultSet;
   }
} 
```

# iphone - CustomTableCellView 的 -layoutSubviews 实现需要调用 super , NSInternalInconsistencyException

> ID：13627452
> 
> 赞同：8
> 
> 时间：2012-11-29T14:02:15.150
> 
> 标签：iphone, ios, uitableview, ios6

在 tableView xib 的自定义单元格中使用 autoLayout 时，我收到以下错误。

**在iOS 6模拟器运行时** CustomCells的-layoutSubviews的实现需要调用super

```
Assertion failure in 

-[CustomCells layoutSublayersOfLayer:], /SourceCache/UIKit_Sim/UIKit-2372/UIView
     *** Terminating app due to uncaught exception 'NSInternalInconsistencyException', reason: 'Auto Layout still required after executing -layoutSubviews. CustomCells's implementation of -layoutSubviews needs to call super.'
    *** First throw call stack: 
```

**在 iOS 5 模拟器中运行时**

```
*** Terminating app due to uncaught exception 'NSInternalInconsistencyException', reason: 'The NIB data is invalid.'
*** First throw call stack: 
```

**临时修复：**

如果在自定义单元格中禁用自动布局，它工作正常。但在这种情况下，方向处理并不好。请帮忙。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-05-19T22:42:01.880

```
layoutSubviews needs to call super 
```

可以通过将所有内容放在容器视图中的自定义 tableview 单元格中来解决 iOS6 问题。即创建一个新视图来填充单元格，然后在其中放置控件等。还要确保你设置：

```
[theContainerView setTranslatesAutoresizingMaskIntoConstraints:NO]; 
```

对于容器和子视图

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T21:02:53.890

iOS 5.1 及更早版本不兼容 AutoLayout。它仅适用于 iOS 6.0+。

假设您正在使用情节提要，如果您想使用 AutoLayout 但仍保持与 6.0 之前的 iOS 版本的兼容性，则需要创建两个目标：一个用于 iOS 6，另一个用于 iOS 5（或更早版本）。对于每一个，设置一个单独的故事板，一个启用 AutoLayout（对于 iOS 6），一个不启用（对于 iOS 5）。

这是一个 StackOverflow 线程，用于了解 AutoLayout 的最佳实践以及与 iOS 5 的向后兼容性： [在 iOS 6 中启用自动布局，同时保持与 iOS 5 的向后兼容](https://stackoverflow.com/questions/12411980/enabling-auto-layout-in-ios-6-while-remaining-backwards-compatible-with-ios-5)。

根据我的经验，如果您想要向后兼容，那么使用 AutoLayout 是不值得的。如果您使用情节提要，要同步 2 个目标和 2 个情节提要是一件令人头疼的事情。如果您不使用情节提要，则需要针对 iOS 5 和 iOS 6 使用单独的代码，这将需要更长的时间来测试和更新。

# c - c：不透明数据类型创建，“'sizeof'对不完整类型的无效应用”

> ID：13627455
> 
> 赞同：1
> 
> 时间：2012-11-29T14:02:18.990
> 
> 标签：c

我试图隐藏我的结构的实现。结构的定义位于`Board.h`：

```
typedef struct Board* BoardP;
typedef const struct Board* ConstBoardP; 
```

我想根据需要分配内存`Board.c`：

```
#include <stdio.h>
#include <stdlib.h>
#include "Board.h"
#define TARGET_LENGTH 5
#define DEFAULT_BOARD_SIZE 10

 struct Board*
 newBoard(int r, int c)
{
    struct Board *b = (struct Board*) malloc(sizeof(struct Board));

     char ** array;
     int i;
     array = (char**) malloc( r*sizeof(char*) );
     for (i=0; i<r; i++)
     {
        array[i] = malloc( c*sizeof(char) );
     }
     b->_values = array;
     b->_last_player = 'X';
     b->_size_r = r;
     b->_size_c = c;
    return b;
} 
```

但我得到了错误：

> 'sizeof' 对不完整类型'struct Board' 的无效应用</p>

![在此处输入图像描述](../Images/d0c8a6cfe284f8478c08c9d6ea7cf41c.png)

我现在在圈子里跑了几个小时，需要有人来清理我造成的混乱。如果我想动态地为结构内的数组分配内存，我该如何事先定义结构？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-29T14:05:09.767

您必须首先*定义*`Board`结构：`Board.c`

```
//Board.c
struct Board {
 ....
}; 
```

或者在其他地方，`#include`无论如何`Board.c`，编译器需要查看它的定义以确定它在使用`sizeof()`和访问它的成员时的大小。[维基百科页面](http://en.wikipedia.org/wiki/Opaque_pointer#C)中也有一个示例。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-29T14:07:02.350

您似乎忘记了实际进行定义，它必须去*某个地方*，对吗？

中的代码`newBoard`必须可以访问确切的定义，因为它正在执行以下操作：

```
b->_values = array; 
```

必须声明该`struct Board`类型有一个名为`_values`.

另外，请[不要`malloc()`在 C](https://stackoverflow.com/a/605858/28169)中转换返回值。并且避免使用`sizeof (char)`，这只是一种冗长的写作方式`1`（当然，您不需要经常乘以这种方式）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-29T14:54:40.393

您不能`sizeof`在不透明（不完整）类型上使用。

由于您使用的是动态分配，因此您应该考虑将分配移动到不透明类型的 init 函数中，即：

```
Board* BoardInit (...)
{
  Board* something = malloc(...);

  return something ;
} 
```

另一种方法是在 board.h 中声明一个全局常量`extern const size_t sizeof_Board;`，然后在 board.c 中将其定义为`const size_t sizeof_Board = sizeof(Board)`.

此外，**永远不要 typedef away pointers**。不透明类型也不例外。

# neural-network - Matlab在gui中模拟神经网络mat文件

> ID：13627457
> 
> 赞同：1
> 
> 时间：2012-11-29T14:02:27.987
> 
> 标签：neural-network, matlab-load

我在 .mat 中保存了一个神经网络，我想在我的 gui 中模拟这个文件。是否有必要将此文件导入工作区，然后仅从工作区导入到 gui，**或者**我们可以在 gui 中加载它而不必首先将其导入工作区？

谢谢您，非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T15:32:16.330

查看MATLAB 文档中的[此页面](http://www.mathworks.se/help/matlab/import_export/ways-to-load-mat-files.html)。我引用：

以下命令从示例文件 durer.mat 加载所有变量：

```
load('durer.mat') 
```

要将变量加载到结构体数组中，请为加载函数指定一个输出变量：

```
durerStruct = load('durer.mat') 
```

因此，通过这种方式，您可以避免使用工作区。还描述了另一种可能性：

matfile 函数允许您导入变量的一部分，这比加载整个变量需要更少的内存。例如，将 topography.mat 中变量 topo 的前 50 行加载到名为 partOfTopo 的变量中：

```
topography = matfile('topography.mat');
partOfTopo = topography.topo(1:50,:); 
```

# matlab - 用于移动窗口过滤器的嵌套 for 循环

> ID：13627458
> 
> 赞同：-2
> 
> 时间：2012-11-29T14:02:32.093
> 
> 标签：matlab, octave

我想在 MATLAB 中实现嵌套 for 循环，第一个循环应该从 3 运行到 n，在这个循环内，第二个 for 循环应该运行 1:5。我的问题是我想取 5 个数字的平均值，但要取一个移动平均线。所以我应该从第一行的元素 1 到 5 的平均值开始，第二行的元素 2 到 6 的平均值，第三行的元素 3 到 7 的平均值。

请帮我解决这个问题。

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T17:25:42.833

我的*假设*是，您正在寻找这样的东西......没有*嵌套的 for-loop*：

```
for i = 3:n
  some_average(i) = mean(some_data_matrix(i, i:(i+4)));
end 
```

不过，您的问题需要进一步澄清。

# javascript - Jquery/JS：在 Jquery-function 外调用 Jquery-function 的函数

> ID：13627462
> 
> 赞同：1
> 
> 时间：2012-11-29T14:02:38.673
> 
> 标签：javascript, jquery, function

```
(function($){
    $.fn.the_func = function() {

        function my_func(){
            alert('it works');
        }

        my_func();

        // other code

    };
})(jQuery);

$(window).load(function(){
    my_func(); // This way?
    $.the_func().my_func(); // Or this way? No?
    $.the_func.my_func(); // No?
    // ?
});

$(document).ready(function(){
    $('div').the_func();
}); 
```

如何在包装它的函数之外调用这个函数？
我想`my_func()`在这个代码示例中调用。
（window-load 函数只是一个例子。）
我想`my_func()`从“无处不在”调用而不执行`the_func()`. 但我想使用`the_func()`. 我想更新存储在参数中的
值。`my_func()``the_func()`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T14:44:04.597

这是我通常如何编写插件并可以应用于您的情况的示例：

[http://jsfiddle.net/pMPum/1/](http://jsfiddle.net/pMPum/1/)

```
(function ($) {
    function my_func(element) {
        console.log("it works: " + element.innerHTML);
    }

    var methods = {
        init: function (options) {
            console.log("from init");
            console.log("options for init: " + JSON.stringify(options));
            my_func(this);
        },

        my_func: function (options) {
            console.log("from my_func");
            console.log("options for my_func: " + JSON.stringify(options));
            my_func(this);
        }
    };

    $.fn.the_func = function (method) {
        var args = arguments;
        var argss = Array.prototype.slice.call(args, 1);

        return this.each(function () {
            if (methods[method]) {
                methods[method].apply(this, argss);
            }
            else if (typeof method === "object" || !method) {
                methods.init.apply(this, args);
            }
            else {
                $.error("Method " + method + " does not exist on jQuery.the_func");
            }
        });
    };
})(jQuery);

$(document).ready(function () {
    $("div").the_func({    // Same as passing "init" and { } as params
        test: "testing"
    });
}); 
```

`my_func`请注意我是如何在可以调用的范围内创建一个通用函数的。`my_func`in 方法`methods`是通过插件语法向世界公开的，`.the_func()`函数`my_func`是私有的，不能直接访问。

调用不同方法的语法与大多数/大量 jQuery 插件相同。

# tumblr - 如何在 tumblr 主题中禁用照片集

> ID：13627465
> 
> 赞同：0
> 
> 时间：2012-11-29T14:02:45.340
> 
> 标签：tumblr

我想禁用照片集，只在网格框中显示一张图像，我在 img 标签之外使用了 {block:Photos}{/block:Photos}，但是它仍然不起作用，我不知道为什么。

代码：

```
 {block:photoset}

               {block:Photos} 
                    <img src="{PhotoURL-500}" border="0" />
               {/block:Photos} 

           {block:Caption}
           <div class="entry">
             <blockquote>{Caption}</blockquote>
           </div>
           {/block:Caption}
         {/block:photoset} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T18:53:29.300

如果您只想显示 Photoset 的第一张图片，您必须这样做：

HTML：

```
{block:Photoset}
    <div class="my-photoset">
        {block:Photos}
            <img src="{PhotoURL-500}" border="0" />
        {/block:Photos}
    </div>

    {block:Caption}
    <div class="entry">
        <blockquote>{Caption}</blockquote>
    </div>
    {/block:Caption}
{/block:Photoset} 
```

CSS：

```
.my-photoset img {
    display: none;
}

.my-photoset img:first-child {
    display: block;
} 
```

您可以将课程更改为您想要的任何内容，我只是将它们作为示例。您可能已经可以在主题中加入一些课程。

# git - 重新打开 Gerrit 中接受的更改

> ID：13627469
> 
> 赞同：3
> 
> 时间：2012-11-29T14:02:57.690
> 
> 标签：git, branch, gerrit, git-push

我之前发送到 Gerrit 的代码被接受并合并到 master 分支，但结果证明该解决方案不够经济高效，因此我不得不对其进行修改。它现在又准备好了，所以我想将它推送到同一功能分支上的 Gerrit，但我收到以下错误：

```
 ! [remote rejected] HEAD -> refs/for/master (change 175 closed) 
```

有没有办法重新打开更改或者我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T14:34:03.240

我必须创建一个新的本地分支并将更改迁移到新分支，然后我设法推送更改。

# java - 我想在 Android 中扩展 StringBuffer 类

> ID：13627473
> 
> 赞同：0
> 
> 时间：2012-11-29T14:03:34.397
> 
> 标签：java, android

然而，在我开始之前...... - 从字面上看，这是我编写的所有代码：

```
package com.my.package;

public class SBuffer extends StringBuffer
{

} 
```

Eclipse 给了我这个错误：

```
The type SBuffer cannot subclass the final class StringBuffer. 
```

所以，StringBuffer 是一个 FINAL 类，在我开始之前，我似乎已经很沉了。我想我应该向（比我知识渊博的）社区寻求一些解决此问题的建议。

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T14:14:01.517

[一种解决方法是从这里](http://download.java.net/openjdk/jdk7/)获取源代码（至少来自标准 JDK）并将代码复制到您的类中并扩展它

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-29T14:17:53.220

您需要复制`StringBuffer` **and** `AbstractStringBuilder`，更改它们各自的包，并修改`StringBuffer`为您想要的。

您不能简单地复制/修改`StringBuffer`，因为它扩展`AbstractStringBuilder`并且后者是包私有的。

* * *

另一种方法可能是创建 and 的自定义子`Appendable`类`CharSequence`。这使您可以选择`StringBuffer`省略不需要的功能，并且在您的特定用例中可能对性能有害。

您的类*不能*是真实`StringBuffer`类的子类这一事实意味着不再需要模仿`StringBuffer`API 或符合其行为。

# java - Java 正则表达式替换为捕获长度

> ID：13627480
> 
> 赞同：0
> 
> 时间：2012-11-29T14:04:03.480
> 
> 标签：java, regex

```
String pw="pw:(abc)";//Maybe "pw:(12)","pw:(ab123)"...
pw=pw.replaceFirst("\\(.+\\)", "*");

//pw == result:pw:* 
```

我想要结果：`pw:*****`. `(abc)`必须是`*`x 5

匹配内容长度的星号

我可以使用`String.replaceFirst`还是`String.replaceAll`唯一的方式来实现它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T14:46:44.923

```
 String var = "lalala(pw:)()pw:(abc12)lalala()(pw:(a12)pw:() lala";

    for(;;){
        String oldVar= var;
        var = var.replaceAll("(pw\\:\\()([*]{0,})([a-zA-Z0-9]{1})(.{1,})", "$1$2*$4");
        if(oldVar.equals(var)){
            break;
        }
    }
    var = var.replaceAll("(pw\\:)\\(([*]{1,})\\)","$1*$2*");
    System.out.println(var);

RESULT: lalala(pw:)()pw:*******lalala()(pw:*****pw:() lala 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T14:27:33.640

你可以这样做：

```
final String pw = "pw:(abc)";

final String anon = pw.replaceAll("[^pw:]", "*");

System.out.println(pw);
System.out.println(anon); 
```

这将导致：

```
pw:(abc)
pw:***** 
```

编辑：如果密码中包含 p/w/: 则不起作用...将尝试修复..

编辑＃2：这比我想象的要难，不得不采用另一种方法：

```
 final String input = "pw:(abc) something!";

    Matcher matcher = Pattern.compile("\\(.*\\)").matcher(input);

    if (matcher.find()) {
        final String onlyPw = matcher.group();
        final String stars = StringUtils.repeat("*", onlyPw.length());

        System.out.println(input.replace(onlyPw, stars));
    } 
```

所以，首先找到由“({something})”组成的字符串。然后创建一个由该字符串中的星数组成的字符串。然后用输入中的星号替换字符串。

注意：如果密码或 ) 后面的文本包含括号，这不起作用，但是我再次怀疑你会找到一个这样做的正则表达式..

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-29T14:13:40.410

```
String resultString = null;
try {
    Pattern regex = Pattern.compile( "pw:\\((.*?)\\)", Pattern.CANON_EQ );
    Matcher regexMatcher = regex.matcher( subjectString );
    if (regexMatcher.find()) {
        resultString = regexMatcher.group();
        return resultString.length();
    } 
} catch (PatternSyntaxException ex) {
    // Syntax error in the regular expression
} 
```

# javascript - 基本的 Knockout JS 映射到单个 JSON 对象

> ID：13627483
> 
> 赞同：7
> 
> 时间：2012-11-29T14:04:08.407
> 
> 标签：javascript, json, knockout.js, knockout-mapping-plugin

我对淘汰赛很陌生，正在创建一个想要获得淘汰赛好处的 jquery 移动应用程序。我花了最后一天的时间来解决一个非常简单的问题。我已经删除了代码并手动进行了手动绑定（因此几乎违背了使用 KO 而不是 jquery 的目的）。无论如何，如果有人可以告诉我如何改变我必须使用 KO 的真正力量，那么这对我来说是一个很好的基础。我能找到的任何代码示例总是针对比这更复杂的问题（处理数组等）

我的 JSON：

```
{"id":9,"fullName":"John Doe","firstName":"John","lastName":"Doe","referenceNumber":"BUY-08","position":"Buyer","type":"Buyer","telephone":"028 82 240780","email":"m@email.com","departmentId":3,"departmentName":"DEPT B","country":"United Kingdom"} 
```

我的 HTML：

```
 <div>
    Full Name: <input data-bind="value: fullName" disabled="disabled"/> <br />
    Ref: <input data-bind="value: reference" disabled="disabled"/> <br />
    Position: <input data-bind="value: position" disabled="disabled"/> <br />
    Email: <input data-bind="value: email" disabled="disabled"/> <br />
    Dept: <input data-bind="value: departmentName" disabled="disabled"/> <br />
    Country: <input data-bind="value: country" disabled="disabled"/> <br />
</div> 
```

我的Javascript：

```
$(document).ready(function () { 

    function DetailsViewModel() {
        var self = this; 
        self.fullName = ko.observable("");
        self.reference = ko.observable("");
        self.email = ko.observable("");
        self.position = ko.observable("");
        self.departmentName = ko.observable("");
        self.country = ko.observable("");

        var success = function (data) {
            self.fullName(data.fullName);
            self.reference(data.referenceNumber);
            self.email(data.email);
            self.position(data.position);
            self.departmentName(data.departmentName);
            self.country(data.country);
            $.mobile.loading('hide');
        };

        webAPICall("api/user/getcurrentuser",
            "GET", success); // simple wrapper I'm using for ajax calls

    } 
    ko.applyBindings(new DetailsViewModel()); 
}); 
```

非常感谢任何帮助，谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-29T14:27:42.277

如果您不需要任何额外的功能或为您的视图模型计算，则使用映射插件非常简单。您应该将 JSON 传递给 ko.mapping.fromJS：

```
var viewModel = {};

function success(data) {
    viewModel = ko.mapping.fromJS(data);
    ko.applyBindings(viewModel);
}
webAPICall("api/user/getcurrentuser", "GET", success); 
```

`fromJS`如果数据是 JS 对象并且`fromJSON`是 JSON 字符串，则使用函数。并确保您在`data-bind`attributes 和`json`.

这是工作示例：http: [//jsfiddle.net/axrwkr/5t5fj/50/](http://jsfiddle.net/axrwkr/5t5fj/50/)

# ruby - 如何将字符串拆分为数组，保持换行符？

> ID：13627484
> 
> 赞同：2
> 
> 时间：2012-11-29T14:04:09.673
> 
> 标签：ruby, string, split

我想在 Ruby 中分割一个 Unicode 字符串。切片应保持不可见字符完好无损。

这是输入的示例：

```
Foo\r\n
\r\n
\r\n
Bär 1.234 Foo test\r\n
blub 
```

应该变成：

```
Array=["Foo\r\n\r\n\r\n","Bär","1.234,"Foo","test\r\n","blub"] 
```

基本上我想标记字符串并保持格式不变。

当我做类似的事情时：

```
String.split(/ /) 
```

我最终得到类似的东西：

```
Array=["Foo\r\n\r\n\r\nBär","1.234","Foo"] 
```

而且，类似：

```
String.split(/\W/) 
```

杀死格式。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T14:13:10.190

代替 using `split`，`scan`用于第一部分：

```
text = "Foo\r\n\r\n\r\nBär 1.234 Foo test\r\nblub"
text.scan(/^.+[\r\n]*/)
=> ["Foo\r\n\r\n\r\n", "Bär 1.234 Foo test\r\n", "blub"] 
```

然后有条件地应用您的拆分，如下所示：

```
text.scan(/^.+[\r\n]*/).map{ |s| s[' '] ? s.split(/ /) : s }.flatten
=> ["Foo\r\n\r\n\r\n", "Bär", "1.234", "Foo", "test\r\n", "blub"] 
```

或者：

```
text.scan(/^.+[\r\n]*/).flat_map{ |s| s[' '] ? s.split(/ /) : s }
=> ["Foo\r\n\r\n\r\n", "Bär", "1.234", "Foo", "test\r\n", "blub"] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T14:15:46.440

你必须使用 unicode：

```
s.split(/\u0020/) 
```

它不完全是您想要的输出，但它非常接近，然后您可以使用 flat_map 就可以了。

# python - 使用 python 在远程 Windows 机器上运行命令

> ID：13627485
> 
> 赞同：2
> 
> 时间：2012-11-29T14:04:11.097
> 
> 标签：python, windows, remote-debugging, configuration-management

这次我问的是在远程 Windows 机器上运行命令。让我在这里更具描述性。
**我有一台安装了 python 的机器，我想运行一些 powershell 和 cmd 命令，或者我想将一个 cmd 文件发送到远程 Windows 机器，以便它可以在那里运行，并且每个输出都像错误，stdout 我可以得到回到射击机器。
就像我想从 python 远程管理远程机器一样。如果可能的话，我可以在多台机器上同时使用 python 远程触发命令。
*请记住，其他系统上没有安装任何 python。***

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-09-21T12:16:08.183

这有点像雷区，但是做到这一点的“正确”方法（python 控制没有 python 的远程 win 机器）是使用用于 WMI 或 WRM 的库。

有一个[由 Tim Golden](http://timgolden.me.uk/python/wmi/contents.html)（他是 Python-on-Windows 世界的权威）的 WMI 模块、[来自 Dell 的 WSMAN 库](http://en.community.dell.com/techcenter/systems-management/w/wiki/3560.python-wsman-api-open-source.aspx)和一个[pywinrm 模块](https://pypi.python.org/pypi/pywinrm/)。选择你的毒药——它们都有自己的弱点（必须先在服务器上启用 WRM，然后才能使用它，尽管这不需要任何额外的软件，它都是 Windows；WMI 在 DCOM 上工作，所以你会必须弄清楚 DCOM 安全性等）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-09-03T07:12:21.413

您可以`ssh`按照[khagler 的](https://stackoverflow.com/users/1867980/khagler)建议使用它。但我更喜欢在两边都安装 Python，因为 Python 让我在远程端有更多的控制权。

例如，`ssh`只在两台计算机之间提供一个通道。这意味着我必须折叠`stdout`并`stderr`在远程侧通过电线发送它。使用远程 Python 服务器，我可以运行更复杂的脚本，我可以准确控制我想要公开的内容（如果您允许远程访问，则可以执行*任何*命令）并且错误处理更加简单。

或两者的结合：在远程计算机上安装 Python，然后使用它`ssh`来启动 Python 脚本。然后，您可以使用自定义协议与它进行通信，而不受命令行/shell 界面的限制。您甚至可以使用`scp`远程安装新脚本。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-01T08:46:14.737

你可以在Windows机器上安装一个ssh服务器（听说[freeSSHd](http://www.freesshd.com/)不错），然后使用[paramiko](https://github.com/paramiko/paramiko/)模块与之通信。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-09-06T10:45:10.833

知道这是一个很老的帖子，

到目前为止，我能想到的最佳选择是使用 PowerShell 进行窗口远程管理。

下面是如何使用 PowerShell 在远程 PC 中执行命令以及如何在 Python 中执行命令。

PowerShell 启动服务：

```
Get-Service -ComputerName aaa0001 -Name Tomcat9 | Start-Service 
```

现在，接下来是如何使用 Python 执行此操作，

```
import subprocess

subprocess.call(["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe","Get-Service -ComputerName aaa0001 -Name Tomcat9 | Start-Service"]) 
```

这个例子展示了如何在 Windows 中启动 Tomcat9 windows 服务。（*“aaa0001”*只是计算机名称）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-29T14:08:27.120

您可以尝试将[Pyro4 之](http://pypi.python.org/pypi/Pyro4)类的东西与[`subprocess.popen`](http://docs.python.org/2/library/subprocess.html#popen-constructor).

Pyro4 是一个远程方法调用框架，`subprocess.popen`用于创建底层操作系统进程。

# sql - 从大型数据集中随机抽样

> ID：13627486
> 
> 赞同：5
> 
> 时间：2012-11-29T14:04:11.470
> 
> 标签：sql, sql-server, sql-server-2008, tsql

有一个大型数据库，我从中提取了一个研究人群。出于比较的目的，我想选择一个具有相似特征的对照组。我想匹配的两个标准是年龄和性别。为我提供匹配目的的数字的查询是

```
select sex, age/10 as decades,COUNT(*) as counts
        from
        (
            select distinct m.patid
                ,m.sex,DATEPART(year,min(c.admitdate)) -m.yrdob as Age
                from members as m
                inner join claims as c on c.patid=m.PATID
                group by m.PATID, m.sex,m.yrdob
        )x group by sex, Age/10 
```

结果集看起来像

![在此处输入图像描述](../Images/0190681cc5fdf27be78851826ff9341d.png)

这个时代的十年列由表达式给出

```
(DATEPART(year,min(c.admitdate)) -m.yrdob)/10 
```

这用于使用整数除法查找年龄范围为 20-29、30-39 等的人。例如，我想从更大的数据集中选择 507 位 20 多岁的女性。查找较大数据集特征的查询是

```
select distinct m.patid
        ,m.sex
        ,(DATEPART(year,min(c.admitdate)) -m.yrdob)/10 as decades
        from members as m
        inner join claims as c on c.patid=m.PATID
        group by m.PATID, m.sex,m.yrdob 
```

编辑：第二个查询的结果 ![在此处输入图像描述](../Images/cdcd8327fd84c20f3671038303686a7d.png)

所以我需要`sum`第二个查询中的十年列在第一个查询中相等`counts`。我尝试的（并返回零结果）如下。我需要做什么来匹配这些年龄？

运行但不返回结果的查询：

```
select x.PATID--,x.sex,x.decades,y.counts
    from
    (

    select distinct m.patid
        ,m.sex
        ,(DATEPART(year,min(c.admitdate)) -m.yrdob)/10 as decades
        from members as m
        inner join claims as c on c.patid=m.PATID
        group by m.PATID, m.sex,m.yrdob
    ) as x 
    inner join 
    (

        select sex, age/10 as decades,COUNT(*) as counts
        from
        (
            select distinct m.patid
                ,m.sex,DATEPART(year,min(c.admitdate)) -m.yrdob as Age
                from members as m
                inner join claims as c on c.patid=m.PATID
                group by m.PATID, m.sex,m.yrdob
        )x group by sex, Age/10
    ) as y on x.sex=y.sex and x.decades=y.decades
    group by y.counts,x.PATID,x.sex,y.sex
    having SUM(x.decades)=y.counts and x.sex=y.sex 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T15:41:53.490

```
select
   T1.sex,
   T1.decades,
   T1.counts,
   T2.patid

from (

   select 
      sex, 
      age/10 as decades,
      COUNT(*) as counts
   from (

      select  m.patid,
         m.sex,
         DATEPART(year,min(c.admitdate)) -m.yrdob as Age
      from members as m
      inner join claims as c on c.patid=m.PATID
      group by m.PATID, m.sex,m.yrdob
   )x 
   group by sex, Age/10
) as T1
join (
   --right here is where the random sampling occurs
    SELECT TOP 50--this is the total number of peolpe in our dataset
      patid
      ,sex
      ,decades

   from (
      select  m.patid,
         m.sex,
         (DATEPART(year,min(c.admitdate)) -m.yrdob)/10 as decades
      from members as m
      inner join claims as c on c.patid=m.PATID
      group by m.PATID, m.sex, m.yrdob

   ) T2
      order by NEWID()
) as T2
on T2.sex = T1.sex
and T2.decades = T1.decades 
```

编辑：我发布了另一个与此类似的问题，我发现我的结果实际上并不是随机的，但它们只是前 N 个结果。我在最外层的查询中排序，`newid()`所做的只是围绕完全相同的结果集进行改组。从现在关闭的问题中，我发现我需要在上述查询的注释行中使用`TOP`关键字。`order by newid()`

# exchange-server-2010 - 使用传输代理将纯文本电子邮件转换为 HTML (Exchange 2010)

> ID：13627487
> 
> 赞同：1
> 
> 时间：2012-11-29T14:04:12.423
> 
> 标签：exchange-server-2010

我正在尝试使用 Exchange 2010 上的传输代理将所有符合特定条件的外发电子邮件转换为 HTML 格式的电子邮件。我已正确连接了 TA；我不知道如何更改消息内容类型。我得到的最接近的是这个，它只会导致一个空白的电子邮件正文：

```
 If body.BodyFormat <> BodyFormat.Html Then
    Dim oTextToHTML As New Microsoft.Exchange.Data.TextConverters.TextToHtml()
    Dim html As New ConverterReader(body.GetContentWriteStream(), oTextToHTML)
    newBodyContent = body.GetContentWriteStream()
    oTextToHTML.Convert(html, newBodyContent)
 End If 
```

如果我对这些行发表评论或发送已经是 HTML 格式的电子邮件，那么消息会正确到达，这对我来说意味着这是问题（和解决方案）的根源。

# mysql - 用于 MySQL 的 SQL SERVER SSIS 和 ADO.NET 驱动程序

> ID：13627492
> 
> 赞同：1
> 
> 时间：2012-11-29T14:04:40.360
> 
> 标签：mysql, sql-server, ssis

我是否需要安装[MySQL ADO.net](http://www.mysql.com/downloads/connector/net/)驱动程序才能在 MS SQL Server 上使用 mySQL DB 连接来获取使用此驱动程序运行的 SSIS 包？在我的服务器上安装它会破坏任何东西吗？

非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T14:07:17.793

您的查询的简单答案是肯定的，它不会破坏任何东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-30T09:07:22.990

我做了类似的事情，但使用 MySQL ODBC 驱动程序。您还可以创建链接服务器并使用它，也可以与 ODBC 驱动程序一起使用。

# oracle - 在“IN”子句中使用绑定变量

> ID：13627493
> 
> 赞同：4
> 
> 时间：2012-11-29T14:04:42.747
> 
> 标签：oracle, plsql, oracle10g, bind-variables

我想将一个数字列表查询到一个 plsql 变量中，并在另一个 sql 查询的 in 子句中使用它。我在下面创建了一个我想要做的测试用例。

我为解决方案搜索了谷歌，我认为它一定是可能的，但我只是没有让它运行。请帮助我提供编译解决方案。

```
CREATE OR REPLACE PROCEDURE PROCEDURE1 
as
  type t_id is table of number;
  v_ids t_id;
  v_user_ids number;
BEGIN

-- fill variable v_id with id's, user_id is of type number
select user_id
bulk collect into v_ids
from user_users;

-- then at a later stage ... issue a query using v_id in the in clause
select user_id into v_user_ids from user_users
-- this line does not compile ( local collection type not allowed in SQL statements)
where user_id in ( v_ids );

END PROCEDURE1; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-29T15:03:33.100

使用 SQL 类型：

```
SQL> create type t_id is table of number;
  2  /

Type created.

SQL> CREATE OR REPLACE PROCEDURE PROCEDURE1
  2  as
  3    v_ids t_id;
  4    v_user_ids number;
  5  BEGIN
  6
  7    -- fill variable v_id with id's, user_id is of type number
  8    select user_id
  9    bulk collect into v_ids
 10    from user_users
 11    where user_id between 100 and 120;
 12
 13    select user_id into v_user_ids
 14      from user_users
 15     where user_id in (select /*+ cardinality(t, 10) */ t.column_value from table(v_ids) t)
 16       and rownum = 1;
 17
 18    dbms_output.put_line(v_user_ids);
 19
 20  END PROCEDURE1;
 21  /

Procedure created.

SQL> exec procedure1
100 
```

where`cardinality(t, 10)`应该是对数组中有多少元素的合理猜测。

注意：像您一样使用无限制的批量收集：

```
 8    select user_id
  9    bulk collect into v_ids
 10    from user_users; 
```

如果您的数组最终可以包含数千行或更多行，通常情况并不好，因为您对内存施加了太大的压力并最终会使代码崩溃。最好使用显式游标`open x for ..`和循环中的大容量获取以及限制子句，即`fetch x bulk collect into v_ids limit 100`分批处理 100-1000。

# php - PHP / MySQL - 选择 IN

> ID：13627496
> 
> 赞同：0
> 
> 时间：2012-11-29T14:04:54.070
> 
> 标签：php, mysql

这是我的一个查询的 SQL：

```
private static function getFixedFare($post_code_a, $post_code_b) {

    $pdo = new SQL();
    $dbh = $pdo->connect(Database::$serverIP, Database::$serverPort, Database::$dbName, Database::$user, Database::$pass);

    try {

        $query =   "SELECT VehicleSystemId, Fare FROM tblfixedfares
                    WHERE ShortPostCodeA = '$post_code_a'
                    AND ShortPostCodeB = '$post_code_b'
                    AND DayHalf = :day_half
                    AND VehicleSystemId IN ('Car', '6B')";

        $stmt = $dbh->prepare($query);

        $stmt->bindParam(':day_half', self::$day_half, PDO::PARAM_STR);

        $stmt->execute();

        $result = $stmt->fetchAll(PDO::FETCH_ASSOC|PDO::FETCH_GROUP);

        $stmt->closeCursor();

        $dbh = null;

        var_dump($result['Car']);

    }

    catch (PDOException $pe) {
        die("Error: " .$pe->getMessage(). " Query: ".$stmt->queryString);
    }

} 
```

当我这样做时，`var_dump($result['Car']);`我得到以下响应：

```
array(1) {
  [0]=>
  array(1) {
    ["Fare"]=>
    string(3) "100"
  }
} 
```

我将如何获得价值'100'......所以基本上 ['Car'] ['Fare'] 的 $result ？

编辑 ：：

`var_dump($cars);`显示：

```
 array(2) {
       ["Car"]=>
       array(1) {
       [0]=>
       array(1) {
       ["Fare"]=>
       string(3) "100"
       }
     }
     ["6B"]=>
     array(1) {
     [0]=>
     array(1) {
     ["Fare"]=>
     string(3) "700"
     }
    } 
```

我试过了; $result['Car']['Fare'] - 但这是返回 NULL；

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T14:07:02.913

你会得到与你解释的完全一样的值'100'，`$fare = $result['Car']['Fare']; //$fare is 100`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T14:10:06.950

试试这个：

```
$value = $result['Car'][0]['Fare']; 
```

的值`$result['Car']`是一个数组，第一个元素的索引是**0**；第一个元素的值又是一个数组（一个项目，键**'Fare'**，值**100**）。

# cordova - 使用cordova-android create，导致cordova-2.2.0.jar: No such file or directory

> ID：13627497
> 
> 赞同：1
> 
> 时间：2012-11-29T14:04:56.147
> 
> 标签：cordova

当我将 create 命令与 cordova-2.2.0 一起使用时，它会导致错误：

> cordova-2.2.0/incubator-cordova-android/framework/cordova-2.2.0.jar：没有这样的文件或目录

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T04:45:58.630

您很可能已经下载了 Cordova s​​rc 并提取了 cordova-android.zip 文件。相反，只需下载 Phonegap 下载并将其解压缩并 cd 到 phonegap/lib/android/bin 文件夹中执行创建。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T14:17:59.280

抱歉。我使用了错误的工具。我必须下载 phonegap 2.2.0。然后运行。

# c# - N 层 WCF 应用程序中的 SignalR

> ID：13627502
> 
> 赞同：2
> 
> 时间：2012-11-29T14:05:15.747
> 
> 标签：c#, asp.net-mvc, wcf, signalr, n-tier-architecture

我有一个 n 层应用程序，它有一个 WCF 服务公开我的所有业务逻辑，作为 Windows 服务托管，MVC 应用程序作为客户端，使用这些服务。

大多数示例都显示了 MVC 应用程序中的 SignalR。我尝试将集线器提取到一个单独的 DLL 中，如下所示：

集线器.dll

```
public class Chat : Hub
{

    public void Send(string message)
    {
        Clients.All.addMessage(message);
    }
} 
```

并尝试从我的 MVC cshtml 调用 Send()，即使在添加 Hub.dll 作为参考之后，也不起作用。

这是我的 cshtml 文件中的 javascript：

```
<script type="text/javascript">
    $(function() {
        // Proxy created on the fly          
        var chat = $.connection.chat;

        // Declare a function on the chat hub so the server can invoke it          
        chat.client.addMessage = function(message) {
            $('#messages').append('<li>' + message + '</li>');
        };

        // Start the connection
        $.connection.hub.start().done(function() {
            $("#broadcast").click(function() {
                // Call the chat method on the server
                chat.server.send($('#msg').val());
            });
        });
    });
</script> 
```

虽然上面的代码是一个非常基本的示例，但我想要完成的示例类似于那些 SignalR 进度条教程，除了进度报告将由我的业务层完成。

为了进一步阐述，我想做这样的事情：

1) MVC 客户端通过托管的 WCF 服务调用 PerformLongRunningTaskA()。

2）WCF服务调用业务层方法

3）业务层启动PerformLongRunningTaskA()

4) 业务层向 MVC 客户端报告进度 10%..20%..etc 直到 100%（使用 SignalR？）

我的项目结构大致如下： 演示文稿 - MVC 应用服务层 - WCF 服务（托管在 Windows 服务上） 业务层 - 我的所有业务逻辑数据层 - 实体框架

编辑：

以上现在有效。这是我的一些javascript错误。

我创建了另一个控制台应用程序，以模拟我的业务 DLL 以触发信号器以广播如下事件：

```
class Program
{
    static void Main(string[] args)
    {
      Say("HEY");
    }
    public static void Say(string message)
    {
        var context = GlobalHost.ConnectionManager.GetHubContext<Chat>();
        context.Clients.All.say(message);
    }
} 
```

我已添加 Hub.dll 作为对我的控制台项目的引用，但以上内容现在不起作用。没有错误信息，什么都没有。它只是正常运行，但我的 MVC 应用程序不显示该消息。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-04T06:35:00.143

如果您假装广播消息，您需要处于“服务上下文”中，我的意思是您必须有权访问托管的 Hub 上下文。

如果您需要从控制台应用程序进行广播，您可以在 Hub 中创建允许您这样做的方法，并使您的控制台应用程序成为主 SignalR 服务器的客户端。有关如何创建 .net 控制台 SignalR 客户端的详细信息：[SignalR 客户端中心](https://github.com/SignalR/SignalR/wiki/SignalR-Client-Hubs)

如果您需要在控制台应用程序中拥有“托管上下文”，请尝试 SelfHost [SignalR SelfHost](https://github.com/SignalR/SignalR/wiki/Self-host)

干杯，

# python - 如何添加持续时间？

> ID：13627503
> 
> 赞同：1
> 
> 时间：2012-11-29T14:05:15.773
> 
> 标签：python, xml, datetime

我想使用 Python 2.7 在 xml 文件中添加持续时间属性。

```
import xml.etree.ElementTree as ET
import time

for k in root.findall('TC'):
    ttt= k.get('time')
    s = time.strptime(ttt, "%H:%M:%S")
    total_time = total_time + s 
```

我不能使用`+`运算符，错误是`unsupported operand types (+) None_Type, time.struct_time`.

我如何定义`total_time`为`struct_time`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T14:06:34.020

您需要将`struct_time`组件转换为[`datetime.timedelta`对象](http://docs.python.org/2/library/datetime.html#datetime.timedelta)以合理地处理持续时间：

```
import datetime
import time

total_time = datetime.timedelta()
for k in root.findall('TC'):
    ttt= k.get('time')
    s = time.strptime(ttt, "%H:%M:%S")
    total_time = total_time + datetime.timedelta(
        hours=s.tm_hour, minutes=s.tm_minute, seconds=s.tm_second) 
```

没有其他简单的方法可以将`struct_time`信息转换为持续时间；它实际上是用于日期时间值，尽管`.strptime()`用于解析持续时间并不是一个坏主意。

你的`total_time`价值现在是一个`datetime.timedelta()`对象。要获取总秒数，请使用上面的[`.total_seconds()`方法](http://docs.python.org/2/library/datetime.html#datetime.timedelta.total_seconds)：

```
print total_time.total_seconds() 
```

# ruby-on-rails - 在 Ruby on Rails 中使用自动加载的类时，如何省略模块名称？

> ID：13627505
> 
> 赞同：0
> 
> 时间：2012-11-29T14:05:23.590
> 
> 标签：ruby-on-rails, ruby

假设我有以下文件：

```
|- app
|  |- helpers
|  |  |- application_helper.rb
|- config
|- |- application.rb
|- lib
|  |- my_module
|  |  |- my_class.rb 
```

我正在尝试让 Rails 自动加载`my_module`。在`application.rb`我设置

```
config.autoload_paths += %W(#{config.root}/lib) 
```

我还设法获得了一个秘密知识，即为了使自动加载工作，模块和类的名称必须与目录和文件的名称匹配，所以`my_class.rb`看起来像这样：

```
module MyModule
  class MyClass
    # ...
  end
end 
```

现在我想`MyClass`在我的`application_helper.rb`：

```
module ApplicationHelper

  include MyModule

  def some_method(active_entry = nil)
    someobject = MyClass.new
    #...
  end

end 
```

但我收到一个错误

```
uninitialized constant ApplicationHelper::MyClass 
```

为了使这段代码工作，我必须更换

```
someobject = MyClass.new 
```

和

```
someobject = MyModule::MyClass.new 
```

这是丑陋的。我认为它`include`会像 C++ `using namespace`、 C#`using`或 Java一样工作，`import`但显然不是。那么Ruby中是否有与上述语句等效的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T14:35:50.073

@ChuckE 很接近，您需要做的是将 config.autoload_paths 更改为

```
config.autoload_paths += Dir["#{config.root}/lib/**/"] 
```

以下对我有用

*   创建目录`app/lib/my_module`
*   在那里创建文件称为`my_module.rb`

文件内容：

```
module MyModule
  class MyClass
    def self.hello
      puts "Hello"
    end
  end
end 
```

*   确保`config.autoload_paths`如上所述
*   跑`rails console`

输出：

```
[tharrison@mbpro:~/Sites/test] rails c
Loading development environment (Rails 3.2.9)
1.9.3-p194 :001 > include MyModule
 => Object 
1.9.3-p194 :002 > MyClass.hello
Hello
 => nil 
```

我还没有从应用程序中尝试过这个，但看不出为什么它与从 rails 控制台运行有什么不同。

哦，还有信用应得的：从[Rails 3 中从 lib 文件夹加载模块/类的最佳方式得到这个？](https://stackoverflow.com/questions/3356742/best-way-to-load-module-class-from-lib-folder-in-rails-3)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T14:09:00.683

而不是这个：

```
config.autoload_paths += %W(#{config.root}/lib) 
```

尝试这个：

```
config.autoload_paths += Dir["#{config.root}/lib"] 
```

# android - 使用 DownloadManager 获取 HTTP 错误响应正文

> ID：13627506
> 
> 赞同：2
> 
> 时间：2012-11-29T14:05:27.240
> 
> 标签：android

我正在使用内置的 DownloadManager 下载大文件

[http://developer.android.com/reference/android/app/DownloadManager.html](http://developer.android.com/reference/android/app/DownloadManager.html)

服务器可能会回复 4xx 状态，并在其响应正文中包含一些额外的错误信息。

有没有办法使用 DownloadManager 获取此响应正文？

编辑：我想基本上模拟 HttpURLConnection 类的 getErrorStream

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T17:50:17.297

答案似乎是否定的。

我们可以从 COLUMN_* 值中获得有关下载结果的唯一信息，并且没有任何内容可以获取错误正文。

# memory-management - ColdFusion JVM 无缘无故地使用内存

> ID：13627512
> 
> 赞同：5
> 
> 时间：2012-11-29T14:05:37.830
> 
> 标签：memory-management, coldfusion, java, coldfusion-10

在 CF-10 上使用服务器监控时，我注意到我公司的一台测试服务器上有一个奇怪的行为。这是服务器上 JVM 内存使用情况的屏幕截图，CF 站点上根本没有发生任何事情，没有任何流量![在此处输入图像描述](../Images/f69ac964f9f1613f622abf726870479e.png)。

正如您所看到的，已用内存稳步上升，直到 GC 启动（我假设）并将已用内存重新降低，然后该过程重复。这会指向某种内存泄漏吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-29T14:12:57.567

恕我直言，除非您有其他证据，否则这可能是一个健康的服务器。ColdFusion / Tomcat中有一堆后台进程可以清理并记录监控数据（包括将数据提供给您的监控工具：也许这是一种Heisenbehaviour）。这些都在运行时分配内存，并且会逐渐在堆中乱扔垃圾，直到达到阈值，此时会触发次要 GC，并且您的内存会返回到下限。

如果基线（上图中锯齿的底部）在每个连续步骤中都更高，那么对我来说表明内存泄漏的情况。垃圾收集后的点显示仍在使用多少内存，并且在您的图表上看起来坚如磐石。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T18:17:35.150

有关垃圾收集的详细信息

[https://www.jaspersoft.com/sunopenjdk-jvm-garbage-collection-tuning-tutorial](https://www.jaspersoft.com/sunopenjdk-jvm-garbage-collection-tuning-tutorial)

另请参阅 Java 7 中使用的 G1 垃圾收集器

[http://www.oracle.com/technetwork/java/javase/tech/g1-intro-jsp-135488.html](http://www.oracle.com/technetwork/java/javase/tech/g1-intro-jsp-135488.html)

您还可以更改收集垃圾的速率。**不建议这样做**，但可以这样做。在执行此操作之前，请确保您知道如何恢复 CF JVM 设置

[http://www.oracle.com/technetwork/java/javase/tech/vmoptions-jsp-140102.html](http://www.oracle.com/technetwork/java/javase/tech/vmoptions-jsp-140102.html)

你可以建议垃圾收集。**不建议这样做**，但可以

[http://rip747.wordpress.com/2008/09/29/help-force-coldfusion-to-release-memory/](http://rip747.wordpress.com/2008/09/29/help-force-coldfusion-to-release-memory/)

# https - IE10 websocket 允许InsecureFromHttps

> ID：13627516
> 
> 赞同：32
> 
> 时间：2012-11-29T14:05:46.300
> 
> 标签：https, websocket, internet-explorer-10

我有一个 websocket 实现，我正在尝试**跨浏览器工作**。

在某个时候，我们将迁移到 wss://（即加密的 websockets），但现在，它都是 ws://。当我们从 https 提供一个重定向到 ws 主机的页面时，我们会看到以下内容：

1.  铬没问题。
2.  如果 allowInsecureFromHttps 设置为 true，Firefox 就可以了。
3.  IE10 吐槽。

我知道正确的路径是简单地实现 wss，但与此同时，我想知道是否有任何配置可以应用于 IE10，类似于 firefox 的 allowInsecureFromHttps 将允许从 https 打开 ws:// 链接：// 页。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-05-14T12:18:32.600

不好意思，IE10没有这样的配置。你需要为它实现 wss 。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-06-09T13:37:40.397

如果没有更好的方法，可以引导用户使用 chrome 或 firefox，但这不是最好的方法。如果可以提供帮助，请尝试使用 javascript。

# android - 如何更改标准系统按钮的背景透明度

> ID：13627518
> 
> 赞同：1
> 
> 时间：2012-11-29T14:05:52.543
> 
> 标签：android, button, view, android-widget

我的一个活动中有一组按钮。这些按钮看起来不错，因为它们来自 Android 系统（灰色），因为我的活动的背景是灰色的。我试过以下

```
button.setBackgroundColor(Color.argb(125, 200, 200, 200)); 
```

这会创建所需的透明度，但我会丢失按钮状态，例如按下、向上等。

如何保持 android 附带的按钮状态并且只降低不透明度？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T14:22:23.327

在您的课程中，使用以下代码：

```
alpha = new AlphaAnimation(0.3F, 0.3F); //Set opacity - Range 0.0 to 1.0
alpha.setDuration(0); // Set animation duration
alpha.setFillAfter(true); // Maintaining the effect to the button
yourButton.startAnimation(alpha); 
```

我希望我有所帮助。

再见！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T14:12:58.880

在所需按钮的 xml 中，您应该可以简单地输入：

android:background="@android:color/transparent"

我用它来显示没有默认灰色背景的drawable。

-干杯

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-29T14:23:03.983

动态方式：

Button.getBackground()，如果将位图设置为背景，通常返回 BitmapDrawable，如果将颜色设置为背景，则返回 ColorDrawable。
即
ColorDrawable colorDrawable = (ColorDrawable) button.getBackground();
colorDrawable.setAlpha(125);

这会很好。

静态方式：
在布局中，设置背景颜色如#7EC8C8C8

# dataset - 任何开源或可许可的支出分析前端工具包？

> ID：13627519
> 
> 赞同：-1
> 
> 时间：2012-11-29T14:05:56.280
> 
> 标签：dataset, visualization, dashboard

我正在寻找任何库或代码工具包来创建各种前端，用户可以在其中向下钻取数据、应用过滤器、对最近购买的支出进行分析。外面有这样的东西吗？我的想法类似于 Rails 应用程序的管理主题，它们为您提供一些基本的数据查看功能，除了我想要一些可用于过滤和深入研究数据集并显示汇总分类数据的图形和图表的东西。

对“支出分析仪表板”的图像搜索给出了我正在考虑的 GUI 工具包样式的一些很好的例子。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T20:21:37.950

[Spotfire](http://spotfire.tibco.com/)和[Tableau](http://www.tableausoftware.com/)是用于分析多变量数据集的令人惊叹的商业工具，尤其是 Spotfire 非常容易用于并排探索大量可视化。两者都有桌面版本和在线网络播放器（[Spotfire 演示库](http://spotfire.tibco.com/demo/default.aspx)、[Tableau 演示库](http://www.tableausoftware.com/learn/gallery)）。它们都具有高度可扩展性，可扩展到数百万行。两者都很昂贵，但都有免费试用。

如果您想了解如何对数据集进行交互式过滤，并在此过程中创建许多不同的图表，您应该查看 CHI '12 中的这篇论文及其[演示视频](http://youtu.be/Wic49KHXf88?hd=1)。

*   Dunne C、Riche NH、Lee B、Metoyer RA 和 Robertson GG（2012 年），“GraphTrail：分析大型多元、异构网络，同时支持勘探历史”，在 CHI '12：Proc。2012年计算系统中的人为因素国际会议。第 1663-1672 页。[DOI:10.1145/2207676.2208293](http://dx.doi.org/10.1145/2207676.2208293) [PDF 链接](http://www.cs.umd.edu/~cdunne/hcil/pubs/Dunne12GraphTrail_analyzinglarge.pdf)。 *免责声明：我是作者之一。*

![GraphTrail 接口](../Images/73380afc73c4f71ae6e91b45de3c9be0.png)

# android - 发送带有附件的电子邮件 - ICS 和 JB 之间的变化？

> ID：13627520
> 
> 赞同：4
> 
> 时间：2012-11-29T14:05:57.613
> 
> 标签：android, xamarin.android, email-attachments

我正在使用以下代码使用 M4A 发送带有多个附件的电子邮件（应该可以轻松转移到 Java）：

```
 Intent intent = new Intent(Intent.ActionSendMultiple);
                intent.SetType("text/plain");
                intent.PutExtra(Intent.ExtraText, "Mail body");
                intent.PutExtra(Intent.ExtraSubject, "Mail subject");

                DirectoryInfo di = new DirectoryInfo(Android.App.Application.Context.FilesDir.AbsolutePath);
                List<Android.Net.Uri> fileList = new List<Android.Net.Uri>();
                foreach (FileInfo file in di.GetFiles("MyAppLogFile*"))
                { 
                    Java.IO.File myFile = new Java.IO.File(file.FullName);
                    var uri = Android.Net.Uri.FromFile(myFile);
                    fileList.Add(uri);
                }
                if (fileList.Count > 0)
                    intent.PutParcelableArrayListExtra(Intent.ExtraStream, fileList.ToArray());

                StartActivity(Intent.CreateChooser(intent, "Send email")); 
```

这在 ICS 设备上运行良好，但在 Jelly Bean 上，邮件程序仍然显示附件，但它们没有被发送。由于文件来自属于应用程序的文件系统的受保护部分，我怀疑 ICS（在 Galaxy S3 上尝试过）和 JB（在 Galaxy S3 和 Galaxy Nexus 上尝试过）的权限系统可能发生了一些变化 -后者运行 JB 4.2)。

有没有人成功地在 JB 上发送带有附件的电子邮件，其中要发送的文件位于应用程序目录或其子目录中？

谢谢斯蒂芬

# c# - 如何找出弹出窗口是如何关闭的

> ID：13627524
> 
> 赞同：1
> 
> 时间：2012-11-29T14:06:25.363
> 
> 标签：c#, wpf, popup

我创建了一个带有按钮的文本框，所以它看起来像一个组合框。对于下拉菜单，我使用弹出菜单。我这样做是因为我在下拉菜单中有一个树视图，以及在树视图中作为 SelectedItem 选择的内容的一个小摘要。

这是我的问题：当我在弹出窗口打开时单击按钮时，它首先关闭弹出窗口，然后由于按钮的单击事件，弹出窗口再次打开，我想阻止这种行为。

我对解决方案的想法是有一个 bool 变量，当弹出窗口关闭时设置为 true，因为单击按钮并且按钮单击事件仅在变量为 false 时打开弹出窗口。但这仅适用于您确切知道您没有点击其他任何地方的情况。

有人解决这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T13:05:22.357

`IsEnabled`好吧，我可以通过将按钮设置为`false`打开弹出窗口并将其设置回`true`调用弹出窗口的 Closed-Event 时来解决我的问题。

# php - CActiveRecord::find() 不给出一个记录或对象。试图从非对象获取属性

> ID：13627528
> 
> 赞同：0
> 
> 时间：2012-11-29T14:06:35.363
> 
> 标签：php, orm, yii

`<td><?= PersoonHasStdtaak::model()->findByPk(array('idPlanning' => $modelPlanning->idPlanning, 'idStdTaak' => $modelStdtaak->idStdTaak))->idPersoon0->Naam ?></td>`

我有这个。不知何故，当我让它只打印它而不打印它时，`idPersoon0->Naam`它会定期打印这种形式的复合主键，`#-#-#`例如`1-2-3`where`1`代表`Person` `2`代表 the`Planning`并且`3`代表`Taak`.

为什么它给我“ `Trying to get property from non-object.`”？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T15:11:24.640

好吧..“我”犯的愚蠢错误

我正在遍历一些可能没有这些主键组合的记录的东西。因此它返回`NULL`。而且从`NULL-object`它不可能得到任何属性:)（doH）

祝任何找到这个的人好运。看看它是否返回一个`NULL object`.

# c++ - 设计问题 - 多重继承，C++

> ID：13627531
> 
> 赞同：2
> 
> 时间：2012-11-29T14:06:50.377
> 
> 标签：c++, visual-c++, inheritance, multiple-inheritance

首先我会给出一些代码，然后描述一个问题：

```
class CGUIObject
{
protected:
    int m_id;
    bool m_bVisible;

    // Other non-relevant fields and methods specific for gui object...
};

class CClickable
{
private:
    bool m_bClicked;
public:
    bool isClicked();
    void setClicked(bool bClicked);

    virtual bool wasClicked(const TPoint& clickPos) = 0;

    // Other non-relevant fields and methods specific for clickable object...
};

class CComponent : public CGUIObject
{
    // The only important part of this class is that it derives from CGUIObject
};    

class CButton : public CComponent, CClickable
{
    // The only important part of this class is that it derives from CComponent and CClickable
};

// Now there is a method in my EventManager which informs all clickables about left mouse click event
void CEventManager::lMouseButtonClickEvent(const CPoint& clickPos)
{
    // Go through all clickables
    for(unsigned int i = 0; i < m_clickableObjectsList.size(); i++)
    {
         TClickable* obj = m_clickableObjectsList[i];

         // Here I would like to also check if obj is visible
         if(obj->wasClicked(clickPos))
         {
          obj->setClicked(true);
          if(obj->m_pOnClickListener != nullptr)
               obj->m_pOnClickListener->onClick();
         return; // Only one object can be clicked at once
         }
    }
} 
```

好的，如您所见：

*   CButton 派生自 CComponent 和 CClickable
*   CComponent 派生自 CGUIObject
*   CGUIObject 有`m_bVisible`对我很重要的字段
*   在 EventManager 我创建了一个 CClickable* 对象列表

现在我想通知被点击的特定 CClickable 对象，但前提是它是可见的。我知道所有可点击对象也派生自 CGUIObject（例如 CButton），但它是 CClickable* 的列表，因此我无法访问`m_bVisible`字段是可以理解的。我知道这只是表明我在设计中犯了一个错误，但是有没有办法以一种优雅而简单的方式解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T14:13:34.533

如果您*知道*所有可点击内容都来自`CGUIObject`，则可以使用`dynamic_cast`：

```
CClickable* obj = m_clickableObjectsList[i];

// Here I would like to also check if obj is visible
if(obj->wasClicked(clickPos) && dynamic_cast<CGUIObject*>(obj)->m_bVisible)
{
  //... 
```

如果可点击不是 GUI 对象，则`dynamic_cast`在这种情况下将返回空指针，您应该在取消引用结果之前检查这一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T14:30:51.847

而不是使用类似 a 的东西`dynamic_cast`，你必须实现`wasClicked`in`CButton`来说明按钮是否不可见，它没有被点击。

```
bool CButton::wasClicked() {
    if(!m_bVisible) return false;
    /*previous logic*/
} 
```

# php - 会话不能在服务器上进行其他页面

> ID：13627532
> 
> 赞同：0
> 
> 时间：2012-11-29T14:06:52.667
> 
> 标签：php

我正在处理一个 php 项目。我正在使用会话变量。

我已经制作了 2 个文件来测试这个问题。

在 Test1 文件中，我在 session.below 中设置了值是代码。

```
<?php
session_start();
$_SESSION['test']="demo";
?> 
```

在 test2 文件中，我打印了这个会话。

```
<?php
session_start();
echo $_SESSION['test'];
?> 
```

会话值在 test2 文件中显示为空白，但在设置会话的 test1 文件中显示值。哪个会话值未在其他页面上进行。这在 localhost 上完美运行，但在服务器上不起作用。服务器上有问题吗？我附上了服务器会话详细信息图像。![在此处输入图像描述](../Images/5fe11bfb55e3f24b9009d64cc1a2f155.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T14:26:02.273

您是否尝试过“告诉”PHP 它应该跟踪哪个会话？

例如：如果您的会话 id 变量在 $_GET['session']; 中传递；

在执行 session_start() 之前运行以下命令：

```
session_id($_GET['session']); 
```

**编辑**

尝试这个：

```
<?php
if( $_GET['SID'] != '' ) session_id($_GET['SID']);
session_start();
$sid = session_id();
print '<script>window.location = window.location + "&SID="' . $sid . '</script>';
?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T14:35:20.900

检查会话保存路径是否可被 Web 服务器写入。

确保你打开了cookies..（当我关闭它们来测试某些东西时我忘记了）

使用带有 firebug 扩展的 firefox 来查看 cookie 是否被设置并传回。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-29T14:26:49.317

这在过去发生在我身上。您必须确保在 session_start() 之前没有向浏览器输出任何内容。这似乎很明显，但有时您在文件的开头（在您的开始`<?php`标记之前）有前导空白字符。或者另一种可能性是您使用的文本编辑器/编码在`<?php session_start();`

当然，我敢肯定还有其他的可能性，但这种情况以前发生在我身上。

# vim - Vim - NERDTree - 如何在 NERDTree 插件中打开隐藏文件夹（.name）？

> ID：13627539
> 
> 赞同：30
> 
> 时间：2012-11-29T14:07:02.847
> 
> 标签：vim, nerdtree

我有一个名称以 . 开头的隐藏文件夹。（点）我正在使用父文件夹编辑文件，但希望能够从 vim 下的 NERDTree 插件中访问隐藏文件夹中的文件。

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2012-11-29T14:10:46.677

如果你点击`SHIFT``i`，NERDTree 也会显示隐藏文件。

如果您`?`在 NERDTree 窗口中点击或键入`:he NERDTree`（具体：`:he NERDTreeMappings)`.

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2018-11-14T14:02:34.040

要默认显示隐藏文件/文件夹，请将此行添加到您的 .vimrc 文件中：

```
let NERDTreeShowHidden=1 
```

点击`SHIFT``i`以在显示和隐藏隐藏文件/文件夹之间切换。

如果您在 NerdTree 中忽略文件/文件夹（如 .git/ 、 .DS_Store/ 等），请将此行添加到您的 vim 脚本中：

```
let NERDTreeIgnore=['\.DS_Store$', '\.git$'] " ignore files in nerd tree 
```

# sql-server - SQL Server 2008 R2 中的存储过程调用错误

> ID：13627541
> 
> 赞同：0
> 
> 时间：2012-11-29T14:07:15.437
> 
> 标签：sql-server, stored-procedures, sql-server-2008-r2

我的 SQL Server 中有一个以这些行代码开头的存储过程：

```
CREATE PROCEDURE [dbo].[SP_Notify]
-- Add the parameters for the stored procedure here
@UserName nvarchar(50),
@lastDate datetime
AS
BEGIN

-- my code... 
```

我尝试使用以下代码调用存储过程：

```
DECLARE @data datetime
DECLARE @Username nvarchar(50)
SET @Username = CAST('myUserName' AS nvarchar(50))
SET @data = GetDate()
SP_Notify @Username , @data 
```

但这会导致此错误：

> *消息 102，级别 15，状态 1，第 10 行
> “SP_Notify”附近的语法错误。*

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-29T14:09:07.390

您需要[`EXEC`](http://msdn.microsoft.com/en-us/library/aa258848%28v=sql.80%29.aspx)在存储过程调用之前添加：

```
DECLARE @data datetime
DECLARE @Username nvarchar(50)
SET @Username = CAST('myUserName' AS nvarchar(50))
SET @data = GetDate()
EXEC SP_Notify @Username , @data 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-29T14:09:24.007

尝试：

```
DECLARE @data datetime
DECLARE @Username nvarchar(50)
SET @Username = CAST('myUserName' AS nvarchar(50))
SET @data = GetDate()

EXEC SP_Notify @Username = @Username, @lastDate = @data 
```

我添加了`EXEC`, 并指定了参数值，而不是依赖于序数位置来传递它们（否则这可能会反过来咬你，也许如果你将来修改 SP，重新排序和/或添加参数）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-29T14:12:16.500

利用`exec SP_Notify @Username,@data`

# vim - 在 VIM 中，有没有办法为模板尖括号定义同步区域而不会与小于号冲突？

> ID：13627544
> 
> 赞同：5
> 
> 时间：2012-11-29T14:07:19.177
> 
> 标签：vim, vim-syntax-highlighting

至于`{`, `}`and `[`, `]`and `(`, `)`, 我真的很希望能够定义`syntax region`for `<`,`>`用于 C++ 模板用法，如下所示：

`a<b>`

但是，有没有办法创建这样一个语法区域而不会与以下内容发生冲突：

`if( a < b<c>::d )`

第一个`<`显然是“小于”运算符，应该作为模板参数区域的开始而被丢弃。

我尝试使用多个选项，但无法使其工作。尝试使用复杂的正则表达式来识别模板 args 区域并且不少于操作似乎确实是不可能的，它只能通过使用嵌套自引用模式检查平衡对来工作。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-29T19:24:45.370

基于@ingo-karkat 的回答，我对空格的使用进行了进一步的思考，我认为我得到了一个足够好的匹配模式（我认为这可以捕获 90% 以上的情况）。

```
syn region AngleBrackets matchgroup=AngleBracketContents 
start='[[:space:]<]\@<!<<\@!'
end='>' 
```

`start`*前面*`<`没有空格或. 的匹配项。检查是否有***空格***是一个关键因素，因为大多数时间关系操作将被空格包围，而且，非常常见的做法是不要在模板开括号之前使用空格。*`<`*

 ***我还检查它是否没有立即被另一个`<`.

[这是我正在做](https://github.com/oblitum/rainbow)的事情的快照（区域内的操作员获取区域的颜色，嵌套区域更改颜色，它建立在彩虹括号改进的一些小的修正上）：

![VIM 快照](../Images/d34a1f2c36fc6dcc9cc49737b23e8723.png)

### 更新

刚刚将我的 VIM 正则表达式更改为：

```
\v%(<operator\_s*)@<!%(%(\_i|template\_s*)@<=\<[<=]@!|\<@<!\<[[:space:]<=]@!) 
```

最后一个实际上将帮助我实施良好的代码风格。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T14:32:46.950

只要您为*80% 的解决方案*拍摄并将其中的文本限制`<...>`为非空白标识符（假设您的编码风格围绕带有空白的比较运算符），通过使用`:syntax match`而不是`:syntax region`（它已经在开始匹配时触发，而不检查结束匹配的存在），应该可以工作（因为单个正则表达式必须同时匹配开始和结束）。

关于解析 C++（在真正的编译器中）的困难已经说了很多，所以不要指望使用正则表达式的通用解析解决方案是完美的。（另外，不要忘记语法高亮只是一种视觉*辅助*，你不应该过分依赖它）。***

# iphone - 用户将 NSNumbers 输入变量的好方法

> ID：13627548
> 
> 赞同：0
> 
> 时间：2012-11-29T14:07:48.230
> 
> 标签：iphone, objective-c, ios

我正在为我的足球俱乐部制作一个应用程序，以便彼此进行小赌注。我正在尝试找到一种从用户那里接收价格输入的方法。我需要这个数字的形式`N(X).XX`在小数点前有多少 X 并不重要。我已经考虑了几个选项，但我只是没有足够的经验来决定哪个是最好的。

到目前为止我的想法是：

1.  创建一个显示数字键盘的文本字段。然后我可以使用`[numberFormatter numberFromString: text];`. 然而，这似乎有点太冒险了。例如，如果用户要输入`XX.XXX`或`X.XX.X`或类似的东西，那么应用程序会接受这些值，从而导致稍后出现问题。

2.  我的另一个想法是使用某种选择器，但是我们将被限制在一组固定的值上。

你有什么建议吗？我可能会使用文本字段对正确的格式输入进行某种检查，但我不完全确定我将如何去做。

**编辑**：刚刚检查了 eBay 应用程序，他们有一个非常好的方法。他们使用限制为小数点后两位数的文本字段。我到底要怎么编程呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T14:27:17.720

数字键盘没有“.”。在类似的情况下，我使用了数字和标点键盘，并且必须实现 UITextFieldDelegate 方法

```
- (BOOL)textField:(UITextField *)textField shouldChangeCharactersInRange:(NSRange)range replacementString:(NSString *)string 
```

在那里，我阻止了任何不是数字或“。”的字符。

我的代码如下。这个想法来自stackoverflow上的另一个答案，但我现在找不到它，所以向提供它的人致敬。

```
- (BOOL)textField:(UITextField *)textField shouldChangeCharactersInRange:(NSRange)range replacementString:(NSString *)string
{
    if ([string length] == 0)
        return YES;

    if ([textField keyboardType]==UIKeyboardTypeNumbersAndPunctuation)
    {
        NSMutableCharacterSet *_alnum = [NSMutableCharacterSet characterSetWithCharactersInString:@"."];

        NSCharacterSet *numberSet = [NSCharacterSet decimalDigitCharacterSet];
        [_alnum formUnionWithCharacterSet:numberSet];
        NSCharacterSet *nonNumberSet = [_alnum invertedSet];

        return ([string stringByTrimmingCharactersInSet:nonNumberSet].length > 0);
    }else{
        return YES;
    }
} 
```

在同样的方法中，您可以以类似的方式检查 textField.text 以查看小数点后有多少位并阻止输入更多

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T14:43:58.510

为了建立@SteveC 的正确答案，需要一些额外的检查来限制小数点后的位数；但是小数点的数量（正如你在原始问题中提到的那样。）：

```
- (BOOL)textField:(UITextField *)textField shouldChangeCharactersInRange:(NSRange)range replacementString:(NSString *)string
{
    if ([string length] == 0)
        return YES;
    NSInteger firstDecimalLocation = [[textField text] rangeOfString:@"."].location;
    if( firstDecimalLocation != NSNotFound ) {
        if( [string isEqualToString:@"."] ) {
            return NO;
        }
        if( firstDecimalLocation == range.location - 3 ) {
            return NO;
        }
    }
    NSMutableCharacterSet *_alnum = [NSMutableCharacterSet characterSetWithCharactersInString:@"."];

    NSCharacterSet *numberSet = [NSCharacterSet decimalDigitCharacterSet];
    [_alnum formUnionWithCharacterSet:numberSet];
    NSCharacterSet *nonNumberSet = [_alnum invertedSet];

    return ([string stringByTrimmingCharactersInSet:nonNumberSet].length > 0);
} 
```

请注意，这假定您正在使用 a `UIKeyboardTypeNumbersAndPunctuation`，而不是在`UITextFieldDelegate`方法中对其进行测试。

# django - REST API - 媒体类型参数中的属性过滤器

> ID：13627551
> 
> 赞同：3
> 
> 时间：2012-11-29T14:07:52.197
> 
> 标签：django, rest

我想寻求一些关于设计 REST / hipermedia API 的建议，特别是关于使用[django-rest](http://django-rest-framework.org/)框架的实现。

取而代之的是通用的“实体”示例，我将使用更普通的“文档”实体。

**问题 1。**

```
GET /document/?[query] 
```

获取文档列表。问题是“文档”只有几十个属性，并且在许多情况下，客户端只关心少数几个（尤其是在此搜索中） - 响应的大小可能不同（最多 10 次），而且服务器查询可能会更快。另外，我不得不提到我们更喜欢无模式。

我发现了像

```
GET /document/attr1, attr2../?[query] 
```

我觉得这很不适合 REST。

另一篇文章建议使用 Content-Types（实际上是接受，因为它是用于请求的），但是缺少示例并且仍然有复杂的感觉。就像是：

```
Accept: application/json; attrs="attr1,attr2" 
```

我不确定这是否尊重 HTTP 的语义，以及媒体类型参数的这种使用是否合适（毕竟我想要不同的资源表示形式——过滤掉一些属性）。

**问题2。**

如果以上是或多或少可以接受的解决方案，我想知道[django-rest](http://django-rest-framework.org/)中是否有关于解析自定义媒体类型属性的东西。从我在他的文档中可以看到，媒体类型参数没有单独解析（或处理）。

**编辑**

一些附加信息：应用程序的大部分是 OLTP（不可缓存）。架构是带有静态文件的 JSON 服务器，JS 重客户端。

**编辑 2**

实际上，我发现一些观点认为搜索本质上是创建新的（易失性）资源（结果），因此 POST 方法更合适。这消除了正在讨论的问题。我对创建的实体（结果）有一些问题，因为我不想坚持下去，但我认为这不是强制性的。问题是在“位置”标头中放入什么（伪造的 URL，没有位置标头或其他）？对我来说，唯一一致的行为正是我不想做的——search POST 执行搜索，将结果存储在服务器端并返回 201 并带有指向它的链接。然而，这是不合理的持久性负载......

关于浏览器测试，MIME 类型 text/html 可能会呈现用户友好的搜索形式。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T15:20:46.383

架构风格告知架构，哪些约束设计，然后实施。REST 是一种架构风格。您发现设计 URI 很困难，这不是因为实现选项有限，而是因为架构不匹配。您的客户“希望”通过减小消息大小来最大化效率。但是您选择的架构风格（REST）[使用缓存来最大化效率](http://www.ics.uci.edu/~fielding/pubs/dissertation/rest_arch_style.htm#sec_5_1_4)，这自然会导致更大的消息（因此更少的资源）。如果你的架构没有使用缓存来最大化效率，那么它就偏离了 REST 风格（并且可能会创建一种新风格；Roy 应该对这种非常常见的风格进行架构分析）。

解决方案是选择不同的架构风格（RPC 通过减少消息的大小来最大化效率），或者影响您的客户想要 REST，因为它带来[的质量优势](http://www.ics.uci.edu/~fielding/pubs/dissertation/net_arch_styles.htm#sec_3_5_4)：可扩展性、简单性、效率、可演化性和用户感知的性能.

# c++ - 使用 GLUT 的多重纹理

> ID：13627558
> 
> 赞同：2
> 
> 时间：2012-11-29T14:08:10.120
> 
> 标签：c++, opengl, geometry, textures, glut

我有一个代码应该渲染两个球体，每个球体都有不同的纹理，但它不起作用，即使构建成功。它说：变量'textureId'周围的堆栈已损坏。原始代码（仅适用于一个纹理和一个球体）在这里。[http://www.dreamincode.net/forums/topic/253361-texture-mapping-and-glutsolidsphere/](http://www.dreamincode.net/forums/topic/253361-texture-mapping-and-glutsolidsphere/)

编码 ：

```
#include <iostream>
#include <fstream>
#include <stdlib.h> 
#include <cmath>
#include <GL/glut.h>
using namespace std;

const float SIZE = 10.0f;
#define M_PI    (3.14159265)
GLUquadricObj *sphere = NULL;
GLUquadricObj *sphere2 = NULL;

float _angle = 0;
GLuint _textureId[2];

namespace {
//Converts a four-character array to an integer, using little-endian form
int toInt(const char* bytes) {
    return (int)(((unsigned char)bytes[3] << 24) |
        ((unsigned char)bytes[2] << 16) |
        ((unsigned char)bytes[1] << 8) |
        (unsigned char)bytes[0]);
}

//Reads the next four bytes as an integer, using little-endian form
int readInt(ifstream &input) {
    char buffer[4];
    input.read(buffer, 4);
    return toInt(buffer);
}
}

class Image {
public:
    Image(char* ps, int w, int h);
    ~Image();

    /* An array of the form (R1, G1, B1, R2, G2, B2, ...) indicating the
     * color of each pixel in image.  Color components range from 0 to 255.
     * The array starts the bottom-left pixel, then moves right to the end
     * of the row, then moves up to the next column, and so on.  This is the
     * format in which OpenGL likes images.
     */
    char* pixels;
    int width;
    int height;
};

Image::Image(char* ps, int w, int h) : pixels(ps), width(w), height(h) {

}
Image::~Image() {

}

Image* loadBMP(const char* filename);

Image* loadBMP(const char* filename) {
ifstream infile(filename, ifstream::binary);
infile.seekg(10, std::ios::cur);
int dataOffset = readInt(infile);

//Read the header
int headerSize = readInt(infile);
int width = readInt(infile);
int height = readInt(infile);

//Read the data
int bytesPerRow = ((width * 3 + 3) / 4) * 4 - (width * 3 % 4);
int size = bytesPerRow * height;
char* pixels = new char[size];
infile.seekg(dataOffset, ios_base::beg);
infile.read(pixels, size);
infile.close();
//Get the data into the right format
char* pixels2 = new char[width * height * 3];
for(int y = 0; y < height; y++) {
    for(int x = 0; x < width; x++) {
        for(int c = 0; c < 3; c++) {
            pixels2[3*(width*y + x) + c] = pixels[bytesPerRow*y + 3*x (2 - c)];
        }
    }
}
delete[] pixels;
return new Image(pixels2, width, height);
}

GLuint loadTextureFromImage(Image* image) {
GLuint textureId;
glGenTextures(2, &textureId); //Make room for our texture
//glBindTexture(GL_TEXTURE_2D, textureId);

//Map the image to the texture
glTexImage2D(GL_TEXTURE_2D, 
    0,
    GL_RGB,
    image->width, image->height,
    0,
    GL_RGB,
    GL_UNSIGNED_BYTE,
    image->pixels);
return textureId;
}

void initRendering() {
glEnable(GL_DEPTH_TEST);
glEnable(GL_LIGHTING);
glEnable(GL_LIGHT0);
glShadeModel(GL_SMOOTH);
glEnable(GL_COLOR_MATERIAL);
glDisable(GL_CULL_FACE);
glEnable(GL_TEXTURE_2D);

Image* img = loadBMP("earth.bmp");
_textureId[1] = loadTextureFromImage(img);
delete img;

glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_LINEAR);
glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_LINEAR);

sphere = gluNewQuadric();
gluQuadricDrawStyle(sphere, GLU_FILL);
gluQuadricTexture(sphere, GL_TRUE);
gluQuadricNormals(sphere, GLU_SMOOTH);

Image* image = loadBMP("sky.bmp");
_textureId[2] = loadTextureFromImage(image);
delete image;

glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_LINEAR);
glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_LINEAR);

sphere2 = gluNewQuadric();
gluQuadricDrawStyle(sphere2, GLU_FILL);
gluQuadricTexture(sphere2, GL_TRUE);
gluQuadricNormals(sphere2, GLU_SMOOTH);
}

void handleResize(int w, int h) {
glViewport(0, 0, w, h);
glMatrixMode(GL_PROJECTION);
glLoadIdentity();
gluPerspective(45.0, (float)w / (float)h, 1.0, 200.0);
}

void drawScene() {
glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);

glMatrixMode(GL_MODELVIEW);
glLoadIdentity();

glBindTexture(GL_TEXTURE_2D, _textureId[1]);

glTranslatef(0.0f, 0.0f, -20.0f);
glRotatef(_angle, 0, 1, 0);

gluSphere(sphere, 5.0, 20, 20);

glBindTexture(GL_TEXTURE_2D, _textureId[2]);

glTranslatef(0.0f, 0.0f, -30.0f);
glRotatef(_angle, 0, 1, 0);

gluSphere(sphere, 5.0, 20, 20);

glutSwapBuffers();
}

//Called every 25 milliseconds
void update(int value) {
_angle += 1.5f;
if (_angle > 360) {
    _angle -= 360;
}

glutPostRedisplay();
glutTimerFunc(25, update, 0);
}

int main(int argc, char** argv) {
glutInit(&argc, argv);
glutInitDisplayMode(GLUT_DOUBLE | GLUT_RGB | GLUT_DEPTH);
glutInitWindowSize(400, 400);

glutCreateWindow("Sphery sky");
initRendering();

glutDisplayFunc(drawScene);
glutReshapeFunc(handleResize);
glutTimerFunc(25, update, 0);

glutMainLoop();
return 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T14:20:09.793

glGenTextures 不绑定纹理。您必须在使用 glTexImage2D 之前绑定纹理。另请注意，您的 glGenTextures 调用确实分配了 2 个纹理名称，但您只为一个名称提供空间。loadTextureFromImage 的语义表明 glGenTextures 的第一个参数应该是 1。而且你不检查错误。

# php - 站点地图脚本：file_get_contents 上未执行的 php 代码

> ID：13627559
> 
> 赞同：0
> 
> 时间：2012-11-29T14:08:10.200
> 
> 标签：php

您好我正在尝试为我的网站创建站点地图（我不想使用任何应用程序或准备使用代码）

这是我的代码的工作方式。首先它扫描根目录中的文件并将它们放入一个数组中。然后它循环遍历数组并获取该文件的内容，然后它将解析链接的内容（一个标签）

扫描目录

```
public function scan($directory)
{
        $dir = dir($directory);
        while (($file = $dir->read()) !== false) {
       $type  = ($this->is_directory($directory.$file)) ? 'dir' : 'link' ;
           $this->files[] =  array('address'=>$directory.DIRECTORY_SEPARATOR.$file , 'type'=>$type); 
       }
       sort($this->files);    
       $dir->close();      
} 
```

循环槽文件并解析其内容

```
 public function get_links(){
         foreach($this->files as $f )
         {
             if($f['type']  == 'link' )
             { 
                    $contents =  file_get_contents($f['address']);
                    $DOM = new DOMDocument();
                    $DOM->loadHTML($contents);
                    $a = $DOM->getElementsByTagName('a');
                    foreach($a as $link){
                        $this->links[] =  $link->getAttribute('href');
                    }

             }
         }
     } 
```

现在的问题是，当我在第二段代码中获取文件的内容时，该文件中的 php 代码没有被执行。所以我可能会得到类似的东西：

```
www.site.com/<?php echo $a; ?>.html
or
www.site.com/news.php?id=<?php echo $a; ?> 
```

我该如何解决这个问题？我应该去卷曲吗？但这不适用于文件，它只适用于 url 地址

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T14:14:03.760

你必须在你的网络服务器上玩乒乓球，并使用像 http://mysite.com/myfile.php 这样的 URL 访问文件

有多种获取 http 内容的方法。例如，请参见此处： [fopen 无法在我的服务器上运行](https://stackoverflow.com/questions/9038694/fopen-is-not-working-on-my-server)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T14:10:53.667

是的，您将不得不使用 curl。`file_get_contents()`逐字节读取硬盘上的文件。这意味着它将读取您的代码而不执行它。

澄清一下：您不必严格使用 cURL，但任何可以让您通过网络服务器而不是文件系统请求页面的东西。因此，如果您的服务器支持它，您可以这样做`file_get_contents('http://example.org')`，但是您将无法使用 URL。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-29T14:12:00.970

这取决于您的 php 文件有多复杂。如果您使用的是 MVC 或框架，它可能不像加载文件内容那么简单。如果你有简单的 php 文件（一些包含一些类的独立页面），你可以这样做：

```
ob_start();
include($f['address']);
$content = ob_get_contents();
ob_end_clean(); 
```

# asp.net - 为什么 Visual Studio 给出语法错误是这个 ASP 标记？

> ID：13627560
> 
> 赞同：2
> 
> 时间：2012-11-29T14:08:14.060
> 
> 标签：asp.net, html, markup

使用 Visual Studio 2012，以下代码在语法上是正确的：

```
<asp:Label runat="server" Text='<%# Eval("Name", "Name : {0}") %>' /> 
```

而以下是`Newline in constant`在 ASP 标记中引发错误（注意`&nbsp;`）（`~`'s 是确切的 VS 红色下划线）：

```
<asp:Label runat="server" Text='<%# Eval("Name", "Name&nbsp;: {0}") %>' />
                                                 ~~~~~~~~~~~~~~ 
```

尽管有错误，第二个代码“按预期”工作，即。在 .之前添加一个不可破坏的空格`:`。

知道为什么吗？

# java - 多态性，包，

> ID：13627561
> 
> 赞同：-4
> 
> 时间：2012-11-29T14:08:17.827
> 
> 标签：java

大家好，我正在做作业，但我被卡住了，所以我需要一些反馈。

我在一个包中有一个抽象类 Gear 和枚举类型 Info，然后我有 InfoTest，它使用 assert 和 junit 测试来测试 Gear 和 Info 的正确性。

问题出在 InfoTest 中。我有`Info g = some Value;`然后`g.getWeight()`哪个方法在 Gear 类中，我无法通过 Info 对象从 InfoTest 访问 getWeight() 方法。

所以我想知道是否有一种方法可以使用 InfoTest 中的 Info 对象访问 getWeight() 或者我的老师犯了一个错误。谢谢。

OKKKKKKKKKKK 这里是一些代码示例。

> 公共抽象类齿轮{
> 
> ```
> /**
>  * weight stores the weight of the item in kg
>  */
> protected int weight;
> 
> /**
>  * code store the code for the item (bedding, food, medical or sanitary, but it is better to use array.
>  */
> protected char code;
> 
> /**getWeight gets the weight of the item.
>  * 
>  * @return weight
>  */        
> public int getWeight() {
>     return weight;
> }
> 
> /**setWeight sets the weight for the item
>  * 
>  * @param weight 
>  */
> public void setWeight(int weight) {
>     this.weight = weight;
> }
> 
> /**getCode() gets the code of the item.
>  * 
>  * @return code
>  */
> public char getCode() {
>     return code;
> }
> 
> /**setCode sets the code of the item.
>  * 
>  * @param code 
>  */
> public void setCode(char code) {
>     this.code = code;
> } } 
> ```
> 
> 公共枚举信息{
> 
> ```
> /**
>  * BLANKETS represent the blankets.
>  */
> BLANKETS,
> 
> /**
>  * PILLOWS represent the pillows 
>  */
> PILLOWS,
> 
> /**
>  * FOOD represent the food
>  */
> FOOD,
> 
> /**
>  * MEDKIT represent the medical kit.
>  */
> MEDKIT,
> 
> /**
>  * OXYGEN represent the oxygen 
>  */
> OXYGEN,
> 
> /**
>  * NAPKINS represent the napkins.
>  */
> NAPKINS,
> 
> /**
>  * SICKNESSBAG represent the sickness bags.
>  */
> SICKNESSBAG
>  } 
> ```

```
> public class InfoTest {  
      /**
>      * Test of getWeight() method, of class Info. 
>      */
>     @Test
>     public void testGetWeight() {
>       System.out.print("\tChecking weights in Info");
>       Info g = Info.BLANKETS;
>       final int expectedValue1 = 2;
>       assertEquals(expectedValue1, g.getWeight()); }
> 
> } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T14:23:20.630

问题是 Info 是一个枚举类，它目前无法访问 Gear 类。很难准确计算出你的作业范围是什么。

像这样的东西......首先创建另一个扩展你的抽象类的类（比如SubGear）

```
public SubGear extends Gear 
```

在这个类中有一个构造函数，它接受 Info 对象并填充 Gear 类的字段，如下所示：

```
public SubGear (Info info, int weight, char code){
    this.code = code;
    this.weight= weight;
    this.info = info
}

public void setInfo(Info info){
     this.info = info;
}

public Info getInfo(){
    return info;
} 
```

然后在您的测试中创建一个新的 SubGear 对象，以便根据需要访问 getWeight

# encoding - 某些字符（例如 £）出现是问号

> ID：13627563
> 
> 赞同：0
> 
> 时间：2012-11-29T14:08:23.243
> 
> 标签：encoding

好的，不知道为什么，但在此页面（我的测试站点）[http://www.prxa.info/](http://www.prxa.info/)上，一些字符（如 £ 符号）应该显示为带有问号的黑色菱形。

我知道我一定是在字符集上做错了，但不确定是什么？数据库设置为 UTF8，页面编码也是如此吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T16:22:34.523

然后，您需要以 UTF-8 编码向您发送页面。这可以通过两种方式完成。最简单的方法如下。

对于 HTML，可以`<head>`在文档顶部附近的元素中包含此信息：

`<meta http-equiv="Content-Type" content="text/html; charset=utf-8">`

或者对于 html5，您可以使用更短的语法：

`<meta charset="utf-8">`

来源：[http ://en.wikipedia.org/wiki/Character_encodings_in_HTML#Specifying_the_document.27s_character_encoding](http://en.wikipedia.org/wiki/Character_encodings_in_HTML#Specifying_the_document.27s_character_encoding)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T16:45:35.530

查看 HTML 源代码（至少在 Firefox 提供它时），该字符作为替换字符 U+FFFD 提供。您需要确保在从编辑器到数据库到网站的任何时候都不会更改编码。确保您用于将数据插入数据库的任何数据库客户端也使用 UTF8。

# c++ - 如何分析、查找和修复 C++ 函数中的安全漏洞？

> ID：13627567
> 
> 赞同：0
> 
> 时间：2012-11-29T14:08:30.743
> 
> 标签：c++, security

作为一个工作示例，我们可以处理以下代码：

```
 #include <sys/socket.h>

    #define size_t   SOCKET

    int receive_socket_data(SOCKET sock,//socket representing remote connection
                            unsigned long& version_number,//validPtr->version #
                            unsigned long& message_size,//validPtr->sizeof packet
                            char*& buf // where to copy data from packet
                           )
    {
       int nlen = 0;
       buf = NULL;

       // Receive version_number from the packet
       nlen = recv(sock, (char*) &version_number, sizeof(version_number), 0);
       if (nlen == 0 || nlen == -1) return ERROR_RECEIVING;
       version_number = ntohl(version_number);

       // Receive message_size from the entire packet 
       // (ulong + ulong + sizeof data)
       nlen = recv(sock, (char*) &message_size, sizeof(message_size), 0);
       if (nlen == 0 || nlen == -1) return ERROR_RECEIVING;
       message_size = ntohl(message_size);
       // Allocate a buffer to copy the data part of the packet
       buf = new char[message_size + 1 - 2 * sizeof(unsigned long)];
       buf[message_size - 2 * sizeof(unsigned long)] = '\0';

      // Copy the data part from the packet to the buffer
      if (recv(sock, (char*) buf, message_size-2*sizeof(unsigned long), 0) == -1)
         return ERROR_RECEIVING;

      return SUCCESS_RECEIVING;
    } 
```

*例如，我想到的事情是 operator new*可能引发错误。
我不确定数组的索引计算是否也会导致问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-29T16:00:09.300

您可以帮助确定功能是否安全的一种方法是通过证明和测试以及防御性编码以及审查和经验。

防御性编码，因为任意代码不值得分析。使您的代码更易于分析和更安全，然后分析问题。您*不能*分析任意程序。即使是那些理论上可分析的，难度也会有很大差异。

证明，如正式证明您的功能是正确的。这需要充分理解和形式化您的代码与之交互的所有内容。请注意，防御性编码和简化代码使这在某种程度上成为可能。

测试，因为证明只在你认为代码在做什么的情况下才有效。您的代码模型可能不完整——哎呀，我什至会说它肯定是不完整的。您没有一个模型来说明当前未知的物理如何导致您的代码将运行的每个硬件中的位翻转，这是一个关于您的模型不完整的荒谬示例。几乎可以肯定的是，您的代码模型不完整的方式会变得不那么荒谬。

回顾一下，因为会有一些你没有想到的事情，并且通过让更有能力的人说服自己你的代码是正确的，可以增加你没有集体错过某些事情的机会。

经验，因为知道将注意力集中在哪里很重要。经验是记住你过去是如何搞砸的，或者亲眼目睹了别人的所作所为。

安全必须有多安全？一般来说，编写安全代码并不容易。这就是为什么编写密码系统的第一条规则是“不要”。

1.  摆脱所有手动缓冲区管理。
2.  在静态断言、动态断言和注释中包括形式证明，证明您的缓冲区大小算法没有缺陷。
3.  包括每个被调用函数的正式描述，并包括为什么你的正式描述是准确的证据。包括每个被调用函数的单元测试，以验证它们是否按照您声称的方式执行，并以预期的方式失败。
4.  切勿在没有检查和正式证明其格式正确的情况下取消引用指针或索引缓冲区。
5.  不要做任何像预处理宏一样愚蠢的事情。找到一种方法来确保您正在编写的代码是已编译的代码：必须在您正在编写的令牌不是读取的内容的环境中进行证明是毫无意义的困难。
6.  验证函数可能返回的每个可能值。即`recv` ——您检查 0 或 -1。如果它返回 -2 或 -(2^31) 会发生什么？保证不会发生？然后证明。
7.  找一个真正的专家，让他们告诉你想做，或者付钱让他们去做。（我不是这方面的专家）

完成所有这些之后，您会想要攻击您的代码并尝试破坏它。

你会希望别人做同样的事情。

# php - PHP：5层模型

> ID：13627570
> 
> 赞同：4
> 
> 时间：2012-11-29T14:08:35.940
> 
> 标签：php, design-patterns, service, model, dao

我对如何“正确”编写我的应用程序有疑问。

我想遵循 service/DAO/mapper/entity 模型，我认为我完全理解它，但我发现我想做的一些事情可能与这个模型的一般概念相冲突。

我有这些数据库表： ![产品表及其相关表 - 制造商](../Images/31e9f82df3d1001b914ae1fd1f4075dc.png)

我有简单的 ProductDbMapper ，它从数据库中获取产品的数据并将它们作为产品实体返回，所以我可以像这样使用它：

```
echo $productEntity->getName();
$productEntity->setPrice(29.9); 
```

我认为能够像这样使用 somethink 会很棒：

```
echo $productEntity->getManufacturer()->getName(); 
```

“getManufacturer()”方法将简单地通过 id 查询制造商的另一个服务/DAO。我知道如何获得产品制造商的正确方法是：

```
$product = $productService->getProduct(5);
$manufacturer = $manufacturerService->getManufacturerByProduct($product); 
```

但我认为“流畅”的解决方案要简单得多——它易于理解且使用起来很有趣。其实这很自然。我试图通过回调来实现这一点。我将调用制造商服务的回调传递给我的 ProductMapper 中的 Product 实体。

问题是看起来我正在尝试遵循 5 层模型，同时我正在尝试避免它。所以我的问题是：这看起来像一个好的解决方案吗？是否有意义？我怎样才能以更好的方式实现相同的（魔术）？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-01T20:22:42.577

如果您想坚持使用 Data Mapper 模式，您可以从数据库中加载产品及其所有依赖项（制造商、库存、税收），也可以使用延迟加载。第一个选项不是一个好习惯。但是要使用延迟加载，您需要通过虚拟代理获得一个额外的层。

为什么？因为否则你将不得不在你的实体中放置一些数据库代码，而关于这些层的整个想法就是解耦。

# 那么，什么是虚拟代理？

根据 Martin Fowler (2003) 的说法：

> 虚拟代理是一个看起来像应该在字段中的对象，但实际上不包含任何内容的对象。只有当它的方法之一被调用时，它才会从数据库中加载正确的对象。

# 例子

该接口定义了将由真实实体和虚拟代理实现的方法：

```
// The interface
interface ManufacturerInterface
{
    public function getName();
} 
```

这是实体，您可能也在扩展一些通用模型类：

```
// The concrete Manufacturer class
class Manufacturer implements ManufacturerInterface
{
    private $name;

    public function __construct($name)
    {
        $this->name = $name;
    }

    public function getName()
    {
        return $this->name;
    }
} 
```

这是代理：

```
// The proxy
class ManufacturerProxy implements ManufacturerInterface
{
    private $dao;
    private $manufacturer;
    private $manufacturerId;

    public function __construct($dao, $manufacturerId)
    {
        $this->dao = $dao;

        // set manufacturer to NULL to indicate we haven't loaded yet
        $this->manufacturer = null;
    }

    public function getName()
    {
        if ($this->manufacturer === null)
        {
            $this->lazyLoad();
        }
        return $this->manufacturer->getName();
    }

    private function lazyLoad()
    {
        $this->manufacturer = $this->dao->getById($this->manufacturerId);
    }
} 
```

当实例化与制造商有某种关系的其他类（如产品）时，数据映射器将使用代理。因此，当一个产品被实例化时，它的字段被填充，并且制造商字段接收到 ManufacturerProxy 的实例而不是 Manufacturer。

Data Mapper 的实现会有所不同，所以我举一个简单的例子：

```
class ProductMapper {
    private $dao;
    private $manufacturerDao;

    // .......

    public function find($id) {
        // call the DAO to fetch the product from database (or other source)
        // returns an associative array
        $product = $this->dao->find($id);

        // instantiate the class with the associative array
        $obj = new Product($product);

        // create the virtual proxy
        $obj->manufacturer = new ManufacturerProxy($this->manufacturerDao, $product['manufacturer_id']);

        return $obj;
    }
} 
```

正如我所说，上面的例子非常简单。在您使用 DAO 时，我已将其包含在内，但像 Martin Fowler 这样的作者将处理 SQL 查询或任何其他底层技术的任务交给了 Data Mapper。但是也有像 Nock (2004) 这样的作者同时使用了 Data Mapper 和 Data Accessor。

使用更复杂的 Data Mapper，您只能拥有 XML 或 YAML 等语言的文件，类似 Doctrine 或 Hibernate。

刚刚结束，服务：

```
class ProductService {
    private $productMapper;

    /**
     * Execute some service
     * @param {int} $productId The id of the product
     */
    public function someService($producId) {
        // get the product from the database
        // in this case the mapper is handling the DAO
        // maybe the data mapper shouldn't be aware of the DAO
        $product = $this->productMapper->find($productId);

        // now the manufacturer has been loaded from the database
        $manufacturerName = $product->manufacturer->getName();
    }
} 
```

也许您可以让 DAO 调用 Data Mapper 来创建实体，然后在服务中使用 DAO。它实际上更简单，因为您不需要重复两次方法，但这取决于您。

# 替代方案

如果你不想实现虚拟代理，但仍然想要一个流畅的界面，你可以切换到 Active Record 模式。有一些库可以完成这项工作，例如[PHP-ActiveRecord](https://github.com/kla/php-activerecord)和[Paris](https://github.com/j4mie/paris)。或者如果你想自己做，你可以看看[这里](http://derivante.com/2009/05/14/php-activerecord-with-php-53/)和[这里](http://www.devshed.com/c/a/PHP/Using-the-Active-Record-Pattern-with-PHP-and-MySQL/)。Martin Fowler 的书也是一个好的开始。

### 参考

福勒，马丁。**企业应用架构模式**。艾迪生-韦斯利，2003 年。诺克，克利夫顿。**数据访问模式：面向对象应用程序中的数据库交互**。艾迪生-韦斯利，2004 年。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-07T18:07:51.457

几天来我一直在做一些研究，我得出的结论是，实现我想要的最好方法是停止尝试自己编写代码，而只是学习使用现有的 ORM。因为我一直在尝试做的一切都是创建我自己的 ORM。我知道这是个坏主意。我会坚持教义2。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-01T18:45:49.847

不要误会我的意思，我不想成为批评家。为什么不加入这两个表，然后只让一个类扩展另一个类？就像那样，您将拥有`$this->manufacturer_name = $row['name']`. 对于其他制造商行也是如此。

# c++ - 我的源字符串使用哪种编码？

> ID：13627571
> 
> 赞同：3
> 
> 时间：2012-11-29T14:08:38.257
> 
> 标签：c++, windows, winapi, visual-c++, character-encoding

当我有这样的 C++ 代码时：

```
std::string narrow( "This is a narrow source string" );
std::string n2( "Win-1252 (that's the encoding we use for source files): ä,ö,ü,ß,€, ..." );

// What encoding should I pass to Win32's `MultiByteToWideChar` function
// to convert these string to a propoer wchar_t (= UTF-16 on Windows)? 
```

如果那是我们的 cpp 文件的（隐式）编码，我可以总是假设 Win-1252 吗？Visual-C++ 编译器如何决定源文件的字符编码？

例如，如果开发人员使用一台机器，其中“普通”文本文件默认为另一种单/多字节编码，会发生什么？

我假设编码只是用于编译代码的机器上的一个问题？也就是说，一旦构建了可执行文件，将静态字符串从固定的窄编码转换为 Windows 的 UTF-16 wchar_t 将始终产生相同的结果，而不管用户 PC 上的语言/区域设置如何？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-29T14:37:18.567

注意：由于编写了以下答案，VC++ 为源和执行字符集编码添加了额外的选项。[见这里](https://docs.microsoft.com/en-us/cpp/build/reference/utf-8-set-source-and-executable-character-sets-to-utf-8?view=msvc-160)。

* * *

对于宽文本 VC++ 将始终生成 UTF-16，对于窄文本 VC++ 将始终从源编码转换为主机（运行编译器的系统）上设置的“非 Unicode 程序编码”。因此，只要 VC++ 正确识别您将获得的源编码、UTF-16 和非 Unicode 程序的编码。

确定源编码 VC++ 检测所谓的 BOM。它将识别 UTF-16 和 UTF-8。如果没有 BOM，则假定源是使用系统对非 Unicode 程序的编码进行编码的。

如果这导致使用了错误的编码，那么编译器对字符和字符串文字执行的任何转换都将导致 ASCII 范围之外的任何字符的值错误。

* * *

一旦程序被编译然后是的，就这些编译时转换而言，语言环境将不再重要，因为数据是静态的。

不过，编码可能对其他事情很重要，例如，如果您将这些字符串之一打印到控制台。您要么必须对控制台正在使用的任何内容执行适当的转换，要么确保将控制台设置为接受您正在使用的编码。

* * *

注意事项`#pragma setlocale`

`#pragma setlocale`仅影响到宽文本的转换，它既不会通过设置源编码也不会通过更改宽执行编码来实现。坦率地说，它的实际作用是可怕的。举个例子，以下断言*失败*：

```
#pragma setlocale(".1251")
static_assert(L'Я' != L'ß', "wtf..."); 
```

如果您对源代码使用任何 Unicode 编码，则绝对应该避免这种情况。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-29T14:23:23.430

语言规范只是说源字符以实现定义的方式映射。您需要查阅您正在使用的编译器的文档，以了解该实现的定义所说的内容。例如，Microsoft Visual C++ 用于[`#pragma setlocale`](http://msdn.microsoft.com/en-us/library/3e22ty2t%28v=vs.71%29.aspx)指定代码页。

# installation - Web.config 永远不会更新

> ID：13627574
> 
> 赞同：0
> 
> 时间：2012-11-29T14:08:48.670
> 
> 标签：installation, wix, windows-installer, wix3.5

我有一个使用 Wix 3.5 构建的 MSI 安装程序，我正在尝试在安装过程中使用以下命令编辑 web.config xml 文件：

```
<Component Id="EditWebConfigToUseCertificate" Guid="xxx">   
    <util:XmlConfig Id="configureX509Value"
            File="[WebServiceFolder]web.config"
            ElementPath="configuration/system.serviceModel/behaviors/serviceBehaviors/behavior[\[]1[\]]/serviceCredentials/serviceCertificate"
            Name="x509FindType"
            Value="FindBySubjectName"
            Sequence="1" /> 
</Component> 
```

我不能让它工作，我不能让它改变文件上的任何属性。MSI 安装正常，但 web.config 从未更改。我检查了文件路径（硬编码），XPath 也是正确的。为什么不修改文件？安装日志显示没有错误。

这是我的 web.config：

```
<configuration> 
   <system.web>
    <compilation debug="true" targetFramework="4.0">
        <assemblies>
                <add assembly="Microsoft.IdentityModel, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E31" />
        </assemblies>
    </compilation>
        <!-- do not use asp.net authentication -->
        <authentication mode="None" />
    </system.web>

    <system.serviceModel>
        <behaviors>
            <serviceBehaviors>
                <clear />
                <behavior name="AuthenticationServiceBehavior">
                    <serviceMetadata httpGetEnabled="true" httpsGetEnabled="true" />                    
                    <serviceDebug includeExceptionDetailInFaults="false" />
                    <!-- service credentials -->
                    <serviceCredentials>
                        <serviceCertificate storeLocation="LocalMachine" storeName="My" x509FindType="FindBySerialNumber" findValue="00 91 d9 2e 07 82 d8 99 c0" />
                    </serviceCredentials>
                </behavior>
                <behavior>                  
                    <serviceMetadata httpGetEnabled="true" httpsGetEnabled="true" />                    
                    <serviceDebug includeExceptionDetailInFaults="false" />
                    <!-- service credentials -->
                    <serviceCredentials>
                        <serviceCertificate storeLocation="LocalMachine" storeName="My" x509FindType="FindBySerialNumber" findValue="00 91 d9 2e 07 82 d8 99 c0" />
                    </serviceCredentials>               
                </behavior>
        </serviceBehaviors>
     </behaviors>
</configuration> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T14:38:15.147

我最终使它工作。对我有用的代码是这样的：

```
<util:XmlConfig Id='configureX509Value' File='[WebServicesFolder]web.config'
                                Action='create' 
                                Name='findValue'
                                Node='value'
                                ElementPath="//configuration/system.serviceModel/behaviors/serviceBehaviors/behavior[\[]0[\]]/serviceCredentials/serviceCertificate"
                                Value="[CERT_SERIAL_NUMBER]"
                                On='install' 
                                PreserveModifiedDate='yes'
                                VerifyPath="//configuration/system.serviceModel/behaviors/serviceBehaviors/behavior[\[]0[\]]/serviceCredentials/serviceCertificate" /> 
```

# firefox-addon - 新更新的 Firefox 中的 JS-Ctypes

> ID：13627575
> 
> 赞同：0
> 
> 时间：2012-11-29T14:08:50.307
> 
> 标签：firefox-addon, jsctypes

由于安全原因，在上周（2012 年 11 月中旬）更新后，enablePrivelege 不再在 Firefox 中工作。

因此，使用 JS-Ctypes 的 Web 应用程序不再工作。但是，我读到 JS-Ctypes 可以在扩展中使用它。

那么问题来了，JS-Ctypes 在新更新后是否可以扩展工作？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-11T09:45:50.147

我刚刚用最新的 FF (17.0.1) 和 Addon-SDK (1.12) 测试了 JS-Ctypes，一切正常。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-11T09:34:54.227

是的，它确实。我没有看到我的任何问题。

# python - 将多个文件中的数据导入数组的 Pythonic 方法

> ID：13627576
> 
> 赞同：10
> 
> 时间：2012-11-29T14:08:51.667
> 
> 标签：python, arrays, file, import, numpy

我对 Python 比较陌生，想知道如何最好地将数据从多个文件导入单个数组。我有很多包含 50 行两列数据（以列分隔）的文本文件，例如：

```
Length=10.txt:     
1, 10    
2, 30    
3, 50   
#etc
END OF FILE 
```

-

```
Length=20.txt
1, 50.7
2, 90.9
3, 10.3
#etc
END OF FILE 
```

假设我有 10 个文本文件要导入并导入到一个名为*data*的变量中。

我想创建一个包含所有数据的单个 3D 数组。这样，我可以通过`data[:,:,n]`where`n`引用文本文件的索引来引用数据，从而轻松地绘制和操作数据。

我认为我这样做的方法是拥有一个形状数组（50、2、10），但不知道如何最好地使用 python 来创建它。我考虑过使用循环将每个文本文件导入为 2D 数组，然后将它们堆叠以创建 2D 数组，虽然找不到合适的命令来执行此操作（我在 numpy 中查看了 vstack 和 column_stack 但这些似乎没有添加额外的维度）。

到目前为止，我已经编写了导入代码：

```
 file_list = glob.glob(source_dir + '/*.TXT') #Get folder path containing text files

    for file_path in file_list:
      data = np.genfromtxt(file_path, delimiter=',', skip_header=3, skip_footer=18) 
```

但是这段代码的问题是，我只能在 for 循环中处理数据。

我真正想要的是从文本文件中导入的所有数据的数组。

任何帮助将不胜感激谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-29T14:27:41.997

*“但这段代码的问题在于，我只能在 for 循环中处理数据。”*

假设您的代码有效：

```
# Get folder path containing text files
file_list = glob.glob(source_dir + '/*.TXT')
data = []
for file_path in file_list:
    data.append(
        np.genfromtxt(file_path, delimiter=',', skip_header=3, skip_footer=18))
# now you can access it outside the "for loop..."
for d in data:
    print d 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T14:25:51.837

您是否正在寻找 [txt column1, txt column2, filename] 的数组？

```
file_list = glob.glob(source_dir + '/*.TXT') #Get folder path containing text files

for num,file_path in enumerate(file_list):
  data = np.genfromtxt(file_path, delimiter=',', skip_header=3, skip_footer=18)
  data = np.vstack((data.T,np.ones(data.shape[0])*num)).T
  if num==0: Output=data
  else: Output=np.vstack((Output,data)) 
```

如果您不想转置两次，则另一种选择。

```
 data = np.vstack((data,(np.ones(data.shape[0])*num).reshape(-1,1))) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-29T14:27:22.320

如果所有数据都具有相同的形状，则只需附加到列表中。

```
all_data = [] 
```

在你的循环中：

```
all_data.append(data) 
```

最后你有

```
asarray(all_data) 
```

这是一个形状 (10,50,2) 的数组（如果需要，可以转置）。如果形状不匹配，那么这不起作用，numpy 无法处理不同形状的行。然后你可能需要另一个循环来创建最大形状的数组，然后复制你的数据。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-29T14:38:23.367

粗略但快速

```
listFiles=["1.txt","2.txt", ... ,"xxx.txt"]
allData=[]
for file in listFiles:
    lines = open(file,'r').readlines()

    filedata = {}
    filedata['name'] = file
    filedata['rawLines'] = lines
    col1Vals = []
    col2Vals = []
    mapValues = {}

    for line in lines:           
       values = line.split(',')
       col1Vals.append(values[0])
       col2Vals.append(values[1])
       mapValues[values[0]] = values[1]
    filedata['col1'] = col1Vals
    filedata['col2'] = col2Vals
    filedata['map'] = mapValues
    allData.append(filedata) 
```

如果您想从特定目录获取文件列表，请查看[os.walk](http://docs.python.org/2/library/os.html#os.walk)

由于不清楚您将如何想要数据，我已经展示了许多存储它的方法

`allData`是一个字典列表

从你可以做的第三个文件中获取第二列数据`allData[2]['col2']`

如果您想要第三个文件的名称`alldata[2]['name']`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-05-28T22:01:08.647

也许你可以这样做：

```
file_list = glob.glob(source_dir + '/*.TXT') # Get folder path containing text files
data = [np.genfromtxt(file_path, delimiter=',', skip_header=3, skip_footer=18)
        for file_path in file_list] 
```

# smarty - 我应该在哪里找到新的翻译条目？

> ID：13627577
> 
> 赞同：0
> 
> 时间：2012-11-29T14:08:58.057
> 
> 标签：smarty, prestashop

在模板中，我使用以下语法：

```
{l s="some text" mod="module"} 
```

我遇到的问题是我在模块内或其他任何地方的任何翻译文件中都找不到“某些文本”的任何条目。

我相信我应该运行某种构建，但找不到任何提示。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T14:53:04.907

Prestashop 不会保存您的文本，它会保存您的文本的哈希值。这意味着您需要使用标准管理面板进行模块翻译。之后，将在您的模块文件夹中创建带有翻译的文件。

问候

# php - 使用正则表达式规范化电影标题

> ID：13627579
> 
> 赞同：0
> 
> 时间：2012-11-29T14:09:02.850
> 
> 标签：php, regex

我正在研究一个 php 脚本，该脚本从 web 服务中获取电影列表，并将它们存储到数据库中。

没什么特别的，我现在唯一需要解决的是一个*排序标题*，它是电影的标题（必要时）从通常的“ *The* ”/“ *An* ”/“ *A* ”中剥离。

例如

*   黑暗骑士
*   教育
*   一次分离

应该成为

*   黑暗骑士
*   教育
*   分离

就这么简单，但考虑到我在正则表达式领域的菜鸟，我正在寻求帮助。希望我说清楚了。如果您发现自己有疑问，请要求澄清。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T14:16:35.050

你可以试试

```
$titles = array("The Dark Knight","An Education","A Separation");
$words = array('a','the','an');
$regex = '/\b^(' . implode('|', $words) . ')\b/i' ;

echo "<pre>";
foreach ( $titles as $title ) {
    echo preg_replace($regex, '', $title), PHP_EOL;
} 
```

输出

```
 Dark Knight
 Education
 Separation 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T14:25:21.007

试试这个：

```
^(The|An|A) (.+)$ 
```

用于`\2`返回不带定冠词的电影标题，例如`Dark Knight`

或用于`\2, \1`返回`Dark Knight, The`

# jquery - JQuery 选项卡中的 ui 元素访问

> ID：13627580
> 
> 赞同：3
> 
> 时间：2012-11-29T14:09:05.657
> 
> 标签：jquery

我使用这个简单的示例来禁止访问第二个选项卡。返回 false 可以正常工作，但我必须先查看要选择哪个选项卡。ui 参数是一个对象，alert(ui)，但我不能使用任何 ui 变量或函数。我必须将对象投射到某些东西上吗？

```
<!doctype html>
<html lang="de">
<head>
    <meta  http-equiv="content-type" content="text/html; charset=ISO-8859-1" />
    <title>tabs demo</title>
    <link rel="stylesheet" href="css/jquery-ui.css">
    <script src="libraries/jquery-1.8.3.js"></script>
    <script src="libraries/jquery-ui.js"></script>
</head>
<body>

<div id="tabs" style="position:absolute;top:0px;left:0px;width:800px;height:600px">
    <ul>
        <li><a href="#fragment-1"><span>Überblick</span></a></li>
        <li><a href="#fragment-2"><span>System</span></a></li>
    </ul>
    <div id="fragment-1">
        <p>First tab is active by default:</p>
        <pre><code>$( "#tabs" ).tabs(); </code></pre>
    </div>
    <div id="fragment-2">
        Lorem ipsum dolor sit amet, consectetuer adipiscing elit, sed diam nonummy nibh     
    Lorem ipsum dolor sit amet, consectetuer adipiscing elit, sed diam nonummy nibh euismod 
    </div>
</div>

<script>

$(function() {
   $( "#tabs" ).tabs({

        beforeActivate: function( event, ui ) { alert( ui.newTab.id ); }
    });
});

</script>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T14:12:37.833

你为什么不直接禁用标签。

> 禁用（索引）
> 
> 禁用选项卡。无法禁用选定的选项卡。要一次禁用多个选项卡，请设置 disabled 选项：$( "#tabs" ).tabs( "option", "disabled", [ 1, 2, 3 ] )。

[http://api.jqueryui.com/tabs/#method-disable](http://api.jqueryui.com/tabs/#method-disable)

让用户相信，他可以点击一个元素，实际上，他不能是糟糕的 UI 设计！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T14:18:08.913

尝试这个：

```
$("#tabs").tabs({

    beforeActivate: function(event, ui) {
        alert(ui.newTab.find("a").attr("href"));
        return false;
    }
});​ 
```

# java - 为基于 JVM 的项目创建帮助程序“脚本”

> ID：13627582
> 
> 赞同：2
> 
> 时间：2012-11-29T14:09:08.310
> 
> 标签：java, scala, sbt

我习惯用 Python 编程。每当我创建一个项目时，通常都会有一个`bin/`文件夹，其中保存着各种脚本，例如：

*   从 ORM 创建数据库模式
*   基于其他东西生成一些代码（css、javascript等）
*   以图形方式可视化某些数据的脚本

**在 Scala（和 Java）中做这类事情的最佳实践是什么。**自定义 Maven 目标，也许？

我读过，有 sbt 任务，但他们不能使用应用程序本身的编译库。

*更新：这是一个地方，它说我不能使用应用程序代码进行构建：[sbt Task classpath](https://stackoverflow.com/questions/9837191/sbt-task-classpath)*

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T21:38:04.497

我将对事物的Java方面进行一些说明。如果您使用的是 Maven，请从 Maven 可以生成的简单项目原型开始。它将为您创建目录结构，您可以开始在其中添加内容。有一个`bin`脚本目录非常好。也就是说，我仍然更喜欢在惯用的 Java 中创建模式，而不是生成一些 SQL 文件。在我看来，从长远来看，它更安全、更可持续。例如，Hibernate 使用注释，将在您初始化休眠会话后立即为您创建数据库/更新它，这样您就不必为生成模式和将该 sql 文件签入到您的 vcs 等而烦恼。 Maven 确实有很多插件可以做你想做的事情，所以这将是首选路线。如果他们不这样做，您总是可以让 Maven 在`bin`目录中执行您的脚本之一。

例如，在我的 API 项目中，我在 servlet 初始化时创建/更新我的 Cassandra 键空间和列族。这样，您就知道您的数据存储将始终是最新的（假设每个人都将他们的更改/更新添加到该 init 方法）。这消除了所有杂耍......“废话它不起作用”“......哦，那是因为你没有创建列族......从我们的git获取那个文件......但它可能不是是最新的，所以请 CassandraGuy 为您导出最新的架构，然后将其导入您的 cassandra 实例”这并不能解决所有问题。人们仍然需要自律并思考他们正在做出哪些改变。

# php - 适用于 Windows XP 32 位的 PHP 内存缓存

> ID：13627583
> 
> 赞同：1
> 
> 时间：2012-11-29T14:09:12.633
> 
> 标签：php, memcached

如何在 Windows XP 32 位中安装 memcached？

我可以成功安装 memcache 并且可以使用下面的代码

```
$m = new Memcache;
$m->connect('localhost',11211); 
```

但我需要像这样使用 memcached，

```
$m = new Memcached();
$servers = array(
    array('localhost', 11211)
    );
    $m->addServers($servers); 
```

现在上面的代码显示没有找到 Memcached 类。因为没有安装。那么如何在 Windows XP 32 位中安装 memcached

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-10-22T02:13:11.203

我遇到了类似的问题，对于那些不想（或由于某种原因不能）运行虚拟机的人，我最终得到了在 Windows 上运行与在 linux 上运行不同的代码。

当我运行以下内容时：

```
$m = new Memcache;
print_r(get_class_methods($m)); 
```

我注意到它`Memcache`没有`AddServers()`方法，这是为了`Memcached`（请参阅[Memcache 类上的](http://www.php.net/manual/en/class.memcache.php "关于 Memcache 类的 php.net 文档")[php.net 文档与 Memcached 类上的 php.net 文档](http://www.php.net/manual/en/class.memcached.php "Memcached 类上的 php.net 文档")相比，并注意还有*更多*内容`Memcached`！）。

因此，对于 Windows（您需要使用的地方`Memcache`，没有`Memcached`可用的），解决方案是创建自己的短循环来添加多个服务器：

```
$m = new Memcache();
$servers = array(
    array('localhost', 11211),
    // ... other servers here
);
foreach ($servers as $s) $m->addServer($s[0], $s[1]); 
```

如果您需要同时提供适用于 Windows 和 Linux 的两组代码，您始终可以将上述内容包含在其中`if (PHP_OS == 'WINNT')`，并将您的 Linux 代码放在后面的 else 语句中。所以，类似于：

```
$servers = array(
    array('localhost', 11211),
    // ... other servers here
);
if (PHP_OS == 'WINNT') {
    $m = new Memcache();
    foreach ($servers as $s) $m->addServer($s[0], $s[1]);
}
else {
    $m = new Memcached();
    $m->addServers($servers);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-30T08:07:33.857

和你有同样的问题。

在阅读了[http://shikii.net/blog/installing-memcached-for-php-5-3-on-windows-7/](http://shikii.net/blog/installing-memcached-for-php-5-3-on-windows-7/)之后，我发现由于 libmemcached，Memcached 是为 linux 设计的。

仍在等待有关此问题的适当解决方案。

有没有人可以帮助我们？谢谢你。

*对不起，我的英语不好。

# javascript - 如何添加下拉菜单图标？

> ID：13627588
> 
> 赞同：3
> 
> 时间：2012-11-29T14:09:22.070
> 
> 标签：javascript, css, drop-down-menu, content-management-system

我有一个关于向导航中具有下拉菜单的按钮添加某种类型的图标或指示器的问题。该菜单在所有浏览器中看起来都不错，只有少数例外。菜单本身内置在 Ektron CMS 中。我的导航中有 7 个按钮，其中 5 个有下拉菜单。正如您在我的网站上看到的那样，我有一个小右箭头，指示哪些有下拉菜单。箭头是一个 unicode 字符，幸运的是在 CMS 的菜单控件中添加它时可以使用。我对结果相当满意，但我不确定这是否是创建图标的最佳方式。

是否有更好或更有效的方法来创建此类指标？只有在存在子菜单的情况下，JavaScript 才有办法分配符号或图标吗？

尽管我的解决方案有效，但有一个问题我无法解决。在 IE7+、Chrome 和 Safari 中，所有按钮都完美对齐。在 FireFox 中，没有下拉菜单的 2 个按钮比有下拉菜单的按钮高 4px。一旦我添加了 unicode 箭头字符，就会发生这种情况。我添加了一个小的 CSS hack 来纠正 FF 中的问题，但现在我在 Chrome 中遇到了一个问题，最后两个按钮比其他按钮低 4px。我不确定如何有效地纠正这个问题。

这是我网站的链接。感谢您提供的任何帮助。

[http://www.clinicaltrialsummit.com/](http://www.clinicaltrialsummit.com/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T16:20:45.433

感谢您的回复，但我应该提到您上面引用的样式是我的 css hack。我将尝试解释我使用它的原因。

我需要一种方法来挑选出我的最后一个导航按钮，而不能将类直接应用于 li。由于菜单本身是使用我的 CMS 中的控件创建的，因此 HTML 标记是动态生成的。我不想使用 :last-child 伪类，但我还需要一种将额外的填充像素添加到 FF 的方法。我知道 IE 会忽略 :last-child。但是，这就是我失败的地方，因为它也在 Chrome 中添加了它，我相信 Safari。我可以把整个风格拿出来，这可能会帮助你更好地看到我的问题。您会看到除了 FF 之外的所有浏览器中的垂直对齐方式都是正确的。

在我添加了我的 UTF-8 字符之前，整个对齐是完美的。那是它变得错位的时候，但仅在FF中。

如何添加 CSS 箭头？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T15:38:58.910

尝试删除此样式：

```
#nav li a:last-child[href="http://www.healthtech.com/press.aspx"] { 
    padding: 16px 0.4em 0 
} 
```

您有 14px 的默认填充顶部，但上面的规则为具有特定 href 的最后一个子元素设置了 16px 的填充。

在您的 jsfiddle 示例中，没有此 css 规则。

您可以使用 css 箭头代替 UTF-8 符号或使用图标，但我认为像您一样使用 UTF-8 符号是可以的。

# c# - 为什么资源文件中的标签大小会发生变化？

> ID：13627591
> 
> 赞同：5
> 
> 时间：2012-11-29T14:09:28.530
> 
> 标签：c#, visual-studio-2010, visual-studio, .net-4.0, resx

使用 VisualStudio 2010 SP1 C#、.Net4.0、Visual Source Safe、Windows7

我正在与奥地利的一位同事从事同一个项目，我目前在瑞士。当我在 VisualStudio 中单击我的同事创建的表单时，.resx 文件会立即被修改。文件中的所有标签大小都是自动修改的。然后将表单中的所有控件推到表单的左角。这使我无法编辑他的任何表格。

这可能与语言本地化有关吗？VisualStudio 中某处的隐藏设置，它会自动尝试调整标签大小？

也许是 .Net 配置或其他 Windows 配置？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-29T14:37:10.373

这是因为表单的 Designer.cs 文件中有一个自动生成的分配，它看起来类似于：

```
this.AutoScaleDimensions = new System.Drawing.SizeF(6F, 13F); 
```

当您的同事创建表单时，此处的值是不同的。那是因为他在他的机器上以不同的分辨率运行视频适配器，每英寸点数设置与您的不匹配。一个非常常见的设置是 96 dpi。但是像 Vista 和更高版本的操作系统可以很容易地更改此设置，它看起来像一把尺子。常见停止在 125% (120 dpi) 和 150% (144 dpi)。

更改此设置可以更轻松地阅读文本，程序将在具有更高 DPI 设置的视频适配器上使用更大的字体（以*磅为单位，1 磅 = 1/72 英寸）。*但这也需要像 Label 和 TextBox 这样的控件在像素上变得更大以仍然适合文本。这是自动完成的，这就是如果您启用本地化，您会看到表单的 .resx 文件发生变化的原因。

这是确保您的设计在具有其他 dpi 设置的机器上仍然看起来不错的绝佳方式。但是当你在你们两个之间进行设计时，它可能有点像皮塔饼。除了同意 dpi 设置之外，没有真正的解决方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T14:53:09.817

这是montior配置。同事设置为 100% 标准，我的设置为大 150%。

# mongodb - 让 Mongoid 在 active_record 旁边使用 rails 3

> ID：13627592
> 
> 赞同：1
> 
> 时间：2012-11-29T14:09:37.160
> 
> 标签：mongodb, mongoid, mongoid3

在 mongoid 3 的安装指南中，它还解释了如何禁用活动记录，

问题是我正在尝试将 Mongoid 集成到一个广泛使用 active_record 和 mysql 的现有项目中，我无意改变它。

我也在active_record上使用squeel。

无论如何，在我添加 gem 并尝试对活动记录执行任何操作后，我都会收到以下错误；

Mongoid 是否不再需要与 active_record 一起运行？我在过去使用过大小 active_record 的 Mongoid 2 并取得了巨大的成功。这是怎么回事？

我正在使用导轨 3.2.9。

谢谢任何帮助，

这是我得到的错误：

NoMethodError：来自/home/miki/.rvm/gems/ruby-1.9.3-p327@simplee/gems/activerecord-3.2.9/lib/active_record/sanitization.rb:59:in expand_hash_conditions_for_aggregates'中的未定义方法`to_sym' for #<Origin::Key:0x0000000851d788> from /home/miki/.rvm/gems/ruby-1.9.3-p327@simplee/gems/activerecord-3.2.9/lib/active_record/sanitization.rb:60:in`块`each' from /home/miki/.rvm/gems/ruby-1.9.3-p327@simplee/gems/activerecord-3.2.9/lib/active_record/sanitization.rb:59:in`来自 /home/miki/.rvm/gems/ruby-1.9.3-p327@simplee/gems/squeel-1.0.13/lib/squeel/adapters/active_record/relation_extensions.rb:248:in `block in build_where' from /home/miki/.rvm/gems/ruby-1.9.3-p327@simplee/gems/squeel-1.0.13/lib/squeel/adapters/active_record/relation_extensions.rb:243:in`map' 来自 /home/ miki/.rvm/gems/ruby-1.9.3-p327@simplee/gems/squeel-1.0.13/lib/squeel/adapters/active_record/relation_extensions.rb:243:in `build_where' from /home/miki/.rvm/gems/ruby-1.9.3-p327@simplee/gems/activerecord-3.2.9/lib/active_record/relation/query_methods.rb:136:in`where' from /home/miki/.rvm /gems/ruby-1.9.3-p327@simplee/gems/squeel-1.0.13/lib/squeel/adapters/active_record/relation_extensions.rb:218:in `where' from /home/miki/.rvm/gems/ruby-1.9.3-p327@simplee/gems/activerecord-3.2.9/lib/active_record/querying.rb:9:in`where'

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T04:06:46.253

这里有一些[代码](http://blog.hashrocket.com/posts/bridging-activerecord-and-mongoid)可能有助于弥合两者之间的差距。

# bash - 在 bash 脚本中将标志传递给程序

> ID：13627594
> 
> 赞同：1
> 
> 时间：2012-11-29T14:09:46.233
> 
> 标签：bash, flags

**背景**

我有一个`prog`从标准输入获取输入并对其进行处理的程序。它还需要一个标志`-f FILE`来查找操作期间使用的数据文件。

我希望创建一个 bash 脚本来充当这个程序的包装器，这样就不需要使用这个标志。所以我写了以下脚本`progwrap.sh`：

```
#!/bin/bash

/path/to/prog -f /path/to/data 
```

这可以解决基本功能的问题，这样我就可以做类似的事情

```
$ cat somedata.txt | progwrap.sh 
```

并得到我想要的。

**目标**

现在，事实证明，`prog`它还需要其他一些形式的标志`-h`，`-u`等...我希望能够将这些传递给，`progwrap.sh`以便它们反过来传递给`prog`。所以我修改`progwrap.sh`如下：

```
#!/bin/bash

/path/to/prog -f /path/to/data "$@" 
```

允许它接受参数并据说将它们输入到`prog`脚本中。

**问题**

然而，这在某种程度上是行不通的，因为：

```
$ cat somedata.txt | progwrap.sh -h 
```

产生完全相同的输出

```
$ cat somedata.txt | progwrap.sh 
```

这不是正确的行为（即，由于将 -h 标志传递给 progwrap.sh，输出应该以不同的格式输出）。

事实上，提供没有任何支持且通常会导致抛出错误的`progwrap`无意义参数并没有任何作用。我得出结论，传递给的参数被脚本中的调用忽略。`prog``prog``progwrap.sh``prog`

**问题**

我究竟做错了什么？如何将标志传递给`progwrap.sh`以便这些标志随后`prog`在我的脚本中传递给？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T14:19:55.847

感谢用户 melpomene 的帮助。事实证明，上面的脚本可以很好地传递标志，而错误在于`prog`忽略`-f File`. 该脚本在修改为：

```
#!/bin/bash

/path/to/prog "$@" -f /path/to/data 
```

谢谢！

PS。在我的辩护中，这种标志行为没有被`prog`.

# .net - 在定义的目录中加载具有所需引用的程序集

> ID：13627596
> 
> 赞同：3
> 
> 时间：2012-11-29T14:09:48.327
> 
> 标签：.net, filesystems, .net-assembly

**情况**

从文件加载任何模块（exe 文件）程序集时，会出现错误，即找不到该程序集所需的引用。如果我在 Windows 资源管理器中启动程序集一切正常。

所需的引用似乎有问题，因为它们位于子文件夹中。

结构看起来是这样的

```
..\MainApplication.exe 
..\Plugins\Plugin01.exe (needs Interactivity.dll) 
..\Plugins\Interactivity.dll 
```

**问题**

如何判断所需的 Interactivity.dll 引用不在主应用程序的根文件夹中，而是在与插件相同的文件夹中？

**代码示例**

将 TAssembly 调暗为 System.Reflection.Assembly TAssembly = System.Reflection.Assembly.LoadFrom("C:\MyProject\Plugins\Plugin01.exe")

**原始错误消息**

```
{"Zeilennummer \"33\" und Zeilenposition \"18\" von \"Bei der Initialisierung von 
\"Microsoft.Windows.Controls.Ribbon.RibbonApplicationMenu\" 
wurde eine Ausnahme ausgelöst.\"."} 
```

.

```
Die Datei oder Assembly "Microsoft.Windows.Shell, PublicKeyToken=31bf3856ad364e35" 
oder eine Abhängigkeit davon wurde nicht gefunden. 
Das System kann die angegebene Datei nicht finden. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T16:59:03.483

您还可以将所需的程序集作为嵌入式资源放入程序中，然后使用 AssemblyResolve 事件将程序集传递到您的程序中。只需确保在开发时静态链接到实际的 .dll，以便获得设计器和智能感知支持。

# wix - 为什么 x64 合并模块文件不包含在 msi 文件中

> ID：13627597
> 
> 赞同：2
> 
> 时间：2012-11-29T14:09:48.547
> 
> 标签：wix, wix3.6

我的第一个 WIX 安装程序（我有 InstallShield 经验）。我已经包含了这个合并模块......

```
Merge Id="CRT" Language="0" SourceFile="$(env.LIBRARY_ROOT)\microsoft-merge-modules\vs2010-sp1\Microsoft_VC100_CRT_x64.msm" DiskId='1' 
```

媒体如下...

```
Media Id='1' Cabinet='product.cab' CompressionLevel='high' EmbedCab='yes' 
```

我在 ORCA 中打开 MSI 文件并看到组件表中列出的两个 mscv... 文件，但是安装程序解决方案的 Visual Studio 2010 版本（除了创建 msi 文件）还创建了一个 WIN\SYSTEM64 文件夹，其中包含两个文件（`msvcr100.dll`和`msvcp100.dll`）。

当我在我的测试系统上运行安装程序时，（如果我不带上 Win 文件夹），我得到“从文件中读取错误：`c:\lou\win\system32\msvcp100.dll`”。

然后，我再次添加了我自己创建的另一个产品合并模块，这些文件（正在安装到 ProgramFilesx64）不在 msi 中，而是在需要复制的单独文件夹“Program Files 64\productfolder”中到目标系统。

为什么这些文件不包含在 MSI 文件中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-02-07T15:58:12.230

从 WIX 文档中，对 Package 元素上的 Compression 属性的描述：

Compressed YesNoDefaultType 包有效负载应该嵌入容器中还是作为外部有效负载保留。

# git - 如何获得完整上下文的 git diff？

> ID：13627598
> 
> 赞同：138
> 
> 时间：2012-11-29T14:09:48.953
> 
> 标签：git, diff, git-diff

如何创建适合在坩埚中查看的补丁？

```
git diff branch master --no-prefix > patch 
```

这仅生成 3 行上下文。所以我做了以下

```
git diff --unified=2000 branch master --no-prefix > patch 
```

希望所有文件的行数少于 2000 行。有没有办法告诉 git 将文件中的所有行都包含在补丁中，而不必指定最大行数？

* * *

## 回答 #1

> 赞同：112
> 
> 时间：2014-07-24T11:07:47.893

[这](http://trillworks.com/nick/2013/06/26/git-diff-with-full-context/)似乎工作得很好：

```
git diff --no-prefix -U1000 
```

需要注意的是：

> 该`-U`标志指定上下文行。如果更改之间的行数超过 1000 行，则可能需要增加此值。

* * *

## 回答 #2

> 赞同：67
> 
> 时间：2016-11-18T18:11:03.967

我知道这是旧的，但我也不喜欢硬编码的解决方案，所以我测试了这个：

```
git diff -U$(wc -l MYFILE) 
```

使用 -U 似乎是解决该问题的唯一方法，但使用行数可以保证它适用于非常大的文件中的微小更改。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2012-12-10T08:36:03.923

注意：[git1.8.1rc1 公告（2012 年 12 月 8 日）](http://article.gmane.org/gmane.linux.kernel/1407184)包括：

> 一个新的配置变量“ **`diff.context`**”可用于在补丁输出中给出默认的上下文行数，以覆盖 3 行的硬编码默认值。

这样可以帮助在这里生成更完整的上下文。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2018-05-23T19:52:45.623

得到了灵感，所以我添加了一个 git 别名。

```
$ cat ~/.gitconfig | fgrep diff
        df = "!git diff -U$(wc -l \"$1\" | cut -d ' ' -f 1) \"$1\""
$ git df <file> 
```

更新：

刚刚发现“git df”有时不起作用，因为执行 git alias 时目录更改。（参见[git aliases 在错误的目录中操作](https://stackoverflow.com/questions/26243145/git-aliases-operate-in-the-wrong-directory)）。所以这是更新版本：

```
$ cat ~/.gitconfig | fgrep df
        df = "! [ \"$GIT_PREFIX\" != \"\" ] && cd \"$GIT_PREFIX\"; ~/bin/git_df.sh"
$ 
$ cat ~/bin/git_df.sh
#!/bin/bash
for FILE in $@; do
    git diff -U$(wc -l "${FILE}" | cut -d ' ' -f 1) "${FILE}"
done
exit 0 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-01-02T12:36:29.703

这在 macOS 上对我有用：

```
git diff -U$(wc -l main.htm | xargs) 
```

请参阅[“如何从 Bash 变量中修剪空白？”](https://stackoverflow.com/a/12973694/322020)

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2020-02-15T04:55:31.517

*查看特定*文件/提交时，以前接受的解决方案对我不起作用（该`-U`选项似乎与 rev/path 解析混淆），但`--inter-hunk-context=`在这种情况下适用于`git version 2.24.0`：

```
git diff \
    --no-prefix \
    --inter-hunk-context=2000 \
    master -- \
        path/to/file.py 
```

如果您不知道文件大小，您当然可以使用`wc -l`而不是硬编码来找到它：

```
git diff \
    --no-prefix \
    --inter-hunk-context=$(wc -l path/to/file.py) \
    master -- \
        path/to/file.py 
```

# python - OpenERP树结构缩进和颜色

> ID：13627600
> 
> 赞同：2
> 
> 时间：2012-11-29T14:09:49.793
> 
> 标签：python, openerp, erp

```
<record id="view_category_list" model="ir.ui.view">
        <field name="name">res.partner.category.tree</field>
        <field name="model">res.partner.category</field>
        <field name="type">tree</field>
        <field name="field_parent">child_ids</field>
        <field name="arch" type="xml">
            <tree string="Partner Categories">
                <field name="name"/>
                <field name="parent_id" invisible="1"/>
            </tree>
        </field>
</record>

<record id="action_category_list" model="ir.actions.act_window">
        <field name="name">Tree Structure</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">res.partner.category</field>
        <field name="view_type">tree</field>
</record>

<record id="action_category_list_view" model="ir.actions.act_window.view">
        <field eval="10" name="sequence"/>
        <field name="view_mode">tree</field>
        <field name="view_id" ref="view_cr_category_list"/>
        <field name="act_window_id" ref="action_category_list"/>
</record>

<menuitem 
    name="Tree structure" 
    action="action_category_list" 
    id="menuitem_category_list" 
    parent="menu_category_main"/> 
```

你好！在 OpenERP 中，我在上面的示例中有树结构的树视图。当我单击**树结构**菜单项时，我得到树结构视图，但父母和孩子之间没有**缩进。**拜托，有人可以解释一下如何进行缩进。另外，如果有人解释我如何给父母上色。

我试过以下：

```
<tree colors="blue:parent_id==0"/>
<tree colors="blue:parent_id==None"/>
<tree colors="blue:parent_id==False"/> 
```

但不工作。任何建议都会有所帮助。谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-30T07:36:01.153

尝试以下 XML 代码

```
<record id="view_category_list" model="ir.ui.view">
        <field name="name">res.partner.category.tree</field>
        <field name="model">res.partner.category</field>
        <field name="type">tree</field>
        <field name="field_parent">child_ids</field>
        <field name="arch" type="xml">
            <tree string="Partner Categories">
                <field name="name"/>
                <field name="parent_id" invisible="1"/>
            </tree>
        </field>
</record>

<record id="action_category_list" model="ir.actions.act_window">
        <field name="name">Tree Structure</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">res.partner.category</field>
        <field name="view_type">tree</field>
        <field name="view_id" ref="view_category_list"/>
        <field name="domain">[('parent_id','=',False)]</field>
</record>

<menuitem 
    name="Tree structure" 
    action="action_category_list" 
    id="menuitem_category_list" 
    parent="club_menu"/> 
```

# python - 在一行 Python 3.2.2 上打印一个 for 循环

> ID：13627603
> 
> 赞同：1
> 
> 时间：2012-11-29T14:09:58.840
> 
> 标签：python, python-3.x

我正在尝试打印一行代码，但是代码很多，我认为如果我将它们全部打印在一行上会看起来更整洁。我正在尝试使用 for 循环打印一个列表，并且我想将它全部打印在同一行上。

```
 for i in ALLROOMS:
            print(i.name) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-29T14:10:42.493

使用`end=" "`：

`print (i.name, end=" ")`

例子：

```
In [2]: for i in range(5):
   ...:     print(i, end=" ")
   ...:     
0 1 2 3 4 
```

帮助`print()`：

```
print(value, ..., sep=' ', end='\n', file=sys.stdout)

Prints the values to a stream, or to sys.stdout by default.
Optional keyword arguments:
file: a file-like object (stream); defaults to the current sys.stdout.
sep:  string inserted between values, default a space.
end:  string appended after the last value, default a newline. 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-29T14:21:46.343

你的意思是：

```
 print "|".join(str(v) for v in L)  # => 1|2|3
#still can add condition
print "|".join(str(v) for v in L if v>0) # =>1|2|3 
```

当然也可以换成“|” 任何你喜欢的角色。

如果列表中的所有项目都是字符串，你可以

```
打印 "".join(L)

```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-29T14:13:53.457

您可能还需要考虑[pprint 模块](http://docs.python.org/2/library/pprint.html)模块：

```
from pprint import pprint
pprint(i.name) 
```

它不一定会在同一行上打印，但它可以在宽度等方面进行定制——通常是产生“更具可读性”输出的好方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-29T14:16:09.197

你可以做

```
print(*tuple(i.name for i in ALLROOMS)) 
```

# android - 在android中打开软键盘时如何向上移动整个布局

> ID：13627608
> 
> 赞同：1
> 
> 时间：2012-11-29T14:10:08.047
> 
> 标签：android, android-layout

我想移动我的布局，其中有几个视图，所以当用户触摸编辑文本然后键盘打开并且我的布局小部件上升时。我什至在清单中使用了代码 android:windowSoftInputMode="adjustPan" 然后 android:windowSoftInputMode="adjustPan|adjustResize" 没什么用，所以请帮助我
这是我的 xml

```
 <?xml version="1.0" encoding="utf-8"?>
    <RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:background="@color/theme_color"
        android:orientation="vertical" >

        <RelativeLayout
            android:id="@+id/relativeLAyoutId"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:layout_alignParentLeft="true"
            android:layout_centerVertical="true"
            android:focusable="true"
            android:focusableInTouchMode="true" >

            <ImageView
                android:id="@+id/imageView1"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_alignParentTop="true"
                android:layout_centerHorizontal="true"
                android:src="@drawable/osmosis_label" />

            <EditText
                android:id="@+id/login_screen_username_editText1"
                android:layout_width="220dp"
                android:layout_height="40dp"
                android:layout_below="@+id/imageView1"
                android:layout_centerHorizontal="true"
                android:layout_marginTop="15dp"
                android:ellipsize="start"
                android:ems="10"
                android:gravity="left"
                android:hint="@string/username_editbox_text"
                android:imeOptions="actionNext"
                android:singleLine="true" >

                <requestFocus />
            </EditText>

            <EditText
                android:id="@+id/login_screen_password_editText2"
                android:layout_width="220dp"
                android:layout_height="40dp"
                android:layout_alignLeft="@+id/login_screen_username_editText1"
                android:layout_below="@+id/login_screen_username_editText1"
                android:layout_marginTop="15dp"
                android:ellipsize="start"
                android:ems="10"
                android:gravity="left"
                android:hint="@string/password_editbox_text"
                android:imeOptions="actionDone"
                android:inputType="textPassword"
                android:textColor="@color/login_layout" >
            </EditText>

            <ImageView
                android:id="@+id/login_screen_submit_button1"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_below="@+id/login_screen_password_editText2"
                android:layout_centerHorizontal="true"
                android:layout_marginTop="15dp"
                android:src="@drawable/log_in"
                android:text="Login" />

            <TextView
                android:id="@+id/textView1"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_below="@+id/login_screen_submit_button1"
                android:layout_centerHorizontal="true"
                android:layout_marginTop="15dp"
                android:text="@string/registered_textview_id"
                android:textColor="@color/grey_color"
                android:textSize="18sp"
                android:textStyle="bold" />
        </RelativeLayout>

    </RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-06-14T14:32:54.360

把它放在你的 oncreate 中。

```
getWindow().setSoftInputMode(WindowManager.LayoutParams.SOFT_INPUT_STATE_VISIBLE|WindowManager.LayoutParams.SOFT_INPUT_ADJUST_RESIZE); 
```

# mysql - 存储过程的 OUT 参数错误

> ID：13627609
> 
> 赞同：0
> 
> 时间：2012-11-29T14:10:09.497
> 
> 标签：mysql, sql, stored-procedures

执行 SP 时出现以下错误：

```
You have an error in your SQL syntax; check the manual that corresponds to your MySQL   
server version for the right syntax to use near '; select @nodata_issue,@dateof_issue' 
at line 1 
```

和

```
SQL Error (1414): OUT or INOUT argument 2 for routine proc1 is 
not a variable or NEW pseudo-variable in BEFORE trigger 
```

这些参数声明如下：

```
PROCEDURE proc1(IN `idpap` INT, OUT `nodata_issue` TINYINT, OUT `dateof_issue` DATE) 
```

*编辑：已更改并引发问题的代码块：

```
PROCEDURE proc1(IN `idpapel` INT, OUT `nodata_issue` TINYINT, OUT `dateof_issue` DATE)
  DETERMINISTIC
BEGIN
DECLARE primeira_mov, data_anterior DATE;
select data into primeira_mov from excel.trade_mov where papel = idpapel order by data LIMIT 1;

BLOCK1: begin

DECLARE ...
DECLARE cur1 CURSOR FOR select data, valor_split, valor_div from excel.trade_correcao where data >= primeira_mov and id_papel = idpapel order by data DESC;
DECLARE CONTINUE HANDLER FOR NOT FOUND SET done = TRUE;
DECLARE CONTINUE HANDLER FOR 1329 BEGIN
        SET nodata_issue = 1;
        SET dateof_issue = datasplit;
    END;

set data_anterior = "2200-01-01";
set valor_aplicavel = 1;
set preco_fator = 1;
SET nodata_issue = 0;
SET dateof_issue = null;

CALL create_temp_tables();
TRUNCATE TABLE tbl1;

-- START TRANSACTION;

OPEN cur1;

read_loop_1: LOOP 
```

关于导致此错误的任何想法？

# c++ - 在 C++ 结构中处理未知类型的最佳方法是什么？

> ID：13627616
> 
> 赞同：5
> 
> 时间：2012-11-29T14:10:26.427
> 
> 标签：c++, pointers, interpreter, void-pointers

我正在为一种简单的、类似 Lisp 的编程语言编写解释器。它将代码处理成节点，所有节点都有类型，其中一些可能有索引顺序的子节点。由于信息性质的不同，我不能对所有节点值使用相同长度的类型。它们类型的名称是枚举类型，但我对值类型的唯一想法是`void *`. 但是当我使用这个时，我认为我必须非常小心。我的意思是，我不能使用任何默认析构函数，我必须编写一个关心节点类型的析构函数。此外，即使访问值，我也必须使用大量强制转换。

这就是我所说的：

```
enum NodeType {/* Some node types */}

class Node
{
public:
    Node(string input_code);
private:
    NodeType type; // Having this I can know the type of value
    void* value;
}; 
```

有没有一种更安全的方法，可以编写更好的代码，但仍然与使用 void 指针一样有效？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-29T14:23:57.850

我能想到的有两种选择。一种是使用多态性，其中您有一个抽象基类`Node`和许多特定于类型的子类。也许是这样的：

```
class Node
{
public:
  virtual ~Node() = 0;
};

class String : public Node
{
public:
  ~String() {}
};

class Float : public Node
{
public:
  ~Float() {}
}; 
```

存储这些节点时，您将存储`Node*`而不是`void*`. 基类中（抽象）虚拟析构函数的存在使得可以通过基类指针正确销毁具体对象，如下所示：

```
Node* obj = new String;
delete obj; 
```

如果这些方法在基类中是虚拟的，您还可以调用基类中声明的方法并让它们在正确的派生类中执行代码。这些通常也是纯虚拟的，例如：

```
class Node
{
public:
  std::string Speak() const = 0; // pure virt
};

class String : public Node
{
public:
  std::string Speak() const { return "Hello"; }
}; 
```

另一种选择是使用某种变体类。C++ 本身没有内置到语言中的变体类，但是已经编写了一些库，例如 Boost，它们提供了这样的类。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-29T14:17:50.527

使用继承/接口：

```
struct BaseNode {
    std::vector<BaseNode*> _children;
    /*Some functions here*/
} 
```

为每`type`一个`enum NodeType`创建一个继承的新类`BaseNode`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-29T14:16:11.907

您需要使用某种变体类型。Boost 有一个，详细信息可以在[这里](http://www.boost.org/doc/libs/1_52_0/doc/html/variant.html)找到。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-29T15:25:30.787

这是一个`boost::variant`基于节点系统的快速草图：

```
class Node;
struct Empty {};

// Keep enum and variant in sync:
enum NodeType {
  eEmptyNode,
  eStringNode,
  eIntNode,
  eListNode,
};
typedef std::vector< const Node > NodeList;
typedef boost::variant< std::string, int, NodeList > NodeData;

// Keep this in sync with types in Node and enum:
NodeType GetNodeType( Empty const& ) { return eEmptyNode; }
NodeType GetNodeType( std::string const& ) { return eStringNode; }
NodeType GetNodeType( int const& ) { return eIntNode; }
NodeType GetNodeType( NodeList const& ) { return eListNode; }

// Some helper code:
struct GetNodeType_visitor
{
  typedef NodeType return_type;
  template<typename T>
  NodeType operator()( T const& t ) const { return GetNodeType(t); }
};

template<typename T, typename Function>
struct OneType_visitor
{
  typedef bool return_type;
  Function func;
  OneType_visitor( Function const& f ):func(f) {}
  template<typename U>
  bool operator()( U const& u ) const { return false; }
  bool operator()( T const& t ) const { func(t); return true; }
};

struct Node
{
  NodeData data;
  NodeType GetType() { return boost::apply_visitor( GetNodeType_visitor, data ); }
  template<typename T, typename Function>
  bool Apply( Function const& func ) const
  {
    return boost::apply_visitor( OneType_visitor<T>(func), data );
  }
  template<typename T>
  Node( T const& t ):data(t) {}
  Node():data(Empty()) {}
};

// example usage:
int main()
{
  NodeList nodes;
  nodes.push_back( Node<int>( 7 ) );
  nodes.push_back( Node<std::string>( "hello" ) );
  Node root( nodes );

  Assert( root.GetType() == eListNode );
  std::function<void(Node const&)> PrintNode;
  auto PrintInt = [](int const& i) { std::cout << "#" << i; };
  auto PrintString = [](std::string const& s) { std::cout << "\"" << s << "\""; };
  auto PrintList = [&](NodeList const& list) {
    std::cout << "[";
    for (auto it = list.begin(); it !=list.end(); ++it)
    {
      if (it != list.begin()) std::cout << ",";
      PrintNode( *it );
    }
    std::cout << "]";
  }
  auto PrintEmpty = [](Empty const&) { std::cout << "{}"; }
  PrintNode = [&](Node const& n)
  {
    bool bPrinted = false;
    bPrinted = n.Apply<int>( PrintInt ) || bPrinted;
    bPrinted = n.Apply<std::string>( PrintString ) || bPrinted;
    bPrinted = n.Apply<NodeList>( PrintList ) || bPrinted;
    bPrinted = n.Apply<Empty>( PrintEmpty ) || bPrinted;
    Assert(bPrinted);
  }
  PrintNode(root);
} 
```

代码未经测试，但基本思想应该成立。

请注意，我使用的是不可变节点，因为这是用于类似 lisp 的语言。真的我应该使用`std::shared_ptr<const Node>`或类似的东西，所以两棵树可以共享数据。

`boost::variant`处理动态类型问题。

# blackberry-cascades - 黑莓 10 级联 onClick 不起作用

> ID：13627625
> 
> 赞同：1
> 
> 时间：2012-11-29T14:10:47.000
> 
> 标签：blackberry-cascades

我`onClick`在 BB-10 中编写了一个函数，单击时我无法通过单击函数推送另一个 qml 文件

```
NavigationPane {
    id: navigationPane
    Button {
        text: "LOG IN"
        onClicked: {
            var test = screen.createObject();
            navigationPane.push(test);
        }

        attachedObjects: ComponentDefinition {
            id: screen
            source: "y.qml"
        }
    }
} 
```

代码`y.qml`如下

```
NavigationPane {
    id:navigationPane

    Page {
        Container {
            ImageButton {
                defaultImageSource: "asset:///tabs/home_unf.png"
                pressedImageSource: "asset:///tabs/home.png"
                disabledImageSource: "asset:///group.png"

                onClicked: {
                    var _home = home.createObject()
                    navigationPane.push(_home);
                }
            }
        }

        attachedObjects: [
            ComponentDefinition {
                id: home
                source: "z.qml"
            }
        ]
    }
} 
```

我无法查看`y.qml`同时单击（`text: "LOG IN"`）以及单击图像按钮进入`z.qml`页面时，任何人都可以发送一些解决方案（代码，示例）来解决这个问题吗？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-11T07:39:51.640

你不能把一个推`navigationPane`到另一个这里是样本

您的`x.qml`

```
NavigationPane {
    id: navigationPane

    Button {
        text: "LOG IN"
        onClicked: {
            var test = screen.createObject();
            navigationPane.push(test);
        }

        attachedObjects: ComponentDefinition {
            id: screen
            source: "y.qml"
        }
    }
} 
```

您的`y.qml`

```
Page {
    Container {
        ImageButton {
        defaultImageSource: "asset:///tabs/home_unf.png"
            pressedImageSource: "asset:///tabs/home.png"
            disabledImageSource: "asset:///group.png"

            onClicked: {
                var _home = home.createObject()
                navigationPane.push(_home);
            }
        }
    }

    attachedObjects: [
        ComponentDefinition {
            id: home
            source: "z.qml"
        }
    ]
} 
```

和通话一样`z.qml`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T20:16:19.677

您不应该直接在 NaviagationPane 上将 Button 更改为 main.qml

```
NavigationPane
{
    id: navigationPane
    Page
    {
       Container
       {
            Button
            {
                text: "LOG IN"
                onClicked:
                {
                    var test = screen.createObject();
                    navigationPane.push(test);
                }
                attachedObjects: ComponentDefinition
                {
                    id: screen
                    source: "y.qml"
                }
            }
        }
    }
} 
```

# ruby-on-rails - 是否可以在 Rails 中为 Ajax 调用编写测试？

> ID：13627627
> 
> 赞同：0
> 
> 时间：2012-11-29T14:10:52.730
> 
> 标签：ruby-on-rails, testing

我正在学习在我的项目中编写 Rails 测试。

在我的 Web 应用程序中，大部分部分都是使用 Ajax 加载的。

我是否可以使用任何 gem 编写 Rails 测试来测试此 Ajax 调用及其响应？

如果是这样，请考虑以下示例并建议我如何编写测试和使用哪个 gem

*   单击按钮时，ajax 调用会从服务器加载时间。考虑传递给 url 的请求说`/gettime`

谢谢，巴兰

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-09T02:32:38.170

结帐这个问题，它提供了一个技巧，可以让你让它工作

7193923 [ajax 计时问题](https://stackoverflow.com/questions/7193923/how-can-i-alleviate-timing-ajax-woes-using-capybara-capybara-webkit-rspec-click)

# jsf-2 - JBoss 开发模式

> ID：13627630
> 
> 赞同：0
> 
> 时间：2012-11-29T14:10:58.907
> 
> 标签：jsf-2, jboss7.x, portlet, liferay-6

我最近开始在 JSF portlets liferay 中工作，所有项目都在 JBoss AS7 下运行

我使用集成了嵌入式 JBoss 的 liferay 6.1.1，因此我有义务在项目中的每次更改都部署所有内容并放入“部署”目录以查看会发生什么！即使是客户端代码（xhtml 页面、jsf bean ...）的更改也是如此

我想知道是否有可能在开发模式下与 JBoss 一起工作，这使我有可能避免通过接口或客户端的任何更改来部署我的应用程序

先感谢您

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-06T09:41:11.723

我们使用[JRebel](http://zeroturnaround.com/software/jrebel/)为 JBoss AS7 上的 Liferay 开发 JSF portlet，它工作得很好。在 liferay 主页上有一个关于它的[wiki 页面。](https://www.liferay.com/community/wiki/-/wiki/Main/JRebel)

# mysql - 我可以在一个表中创建几个表吗，mysql？

> ID：13627632
> 
> 赞同：1
> 
> 时间：2012-11-29T14:11:04.923
> 
> 标签：mysql, database, xampp, categories

我有一个包含 6 个表的数据库。

其中一张表名为类别，其中包含 5 或 6 个类别。

*例如：具有喜剧、戏剧、惊悚、恐怖、爱情子类别等的电影类别。*

那么我可以在表格中添加子类别，还是应该像表格一样创建它们？

如果我有很多数据要添加到数据库中，有没有更简单的方法呢？

我正在使用**xampp**。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T14:23:00.040

在表格中添加一个`categoryOf`字段`category`，它将用于存储“父类别”的 id。

对于子类别，使用此字段指向它是子类别的类别。将（主要）类别条目的字段留空

例如：

```
id  name         categoryOf
0   comedy       NULL
1   drama        NULL
2   sub-comedy   0
3   sub-drama    1
4   sub-comedy2  0 
```

注意：使用此方法，您甚至可以根据需要添加子子类别...

# sql - SQL Server 查询排除所有空值

> ID：13627639
> 
> 赞同：1
> 
> 时间：2012-11-29T14:11:31.280
> 
> 标签：sql, sql-server, sql-server-2008

我正在尝试形成一个查询，该查询允许我**只**计算非**NULL的行**

```
SELECT count(*) 
FROM jSettings 
WHERE linkToJData = '56211010105' 
  AND tblName1 IS NOT NULL 
  AND tblName2 IS NOT NULL; 
```

我有名为`tblName1`-的列`tblName25`。

我想要完成的只是找出`tblNameXX`有多少`without`个`NULL`.

`1`上面的查询每次只产生一个。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-29T14:32:33.070

```
SELECT
 sum(case when tblName1 is null then 0 else 1 end) +
 sum(case when tblName2 is null then 0 else 1 end) +
 sum(case when tblName3 is null then 0 else 1 end) +
 sum(case when tblName4 is null then 0 else 1 end) +
 sum(case when tblName5 is null then 0 else 1 end) +
 sum(case when tblName6 is null then 0 else 1 end) +
 sum(case when tblName7 is null then 0 else 1 end) +
 sum(case when tblName8 is null then 0 else 1 end)   
FROM jSettings 
WHERE linkToJotData = '56211010105' 
```

无需合并多个结果集。这种技术只需要对数据进行一次传递。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T14:19:27.340

这里的问题在于 AND 条件。如果您提供 AND 条件，您将仅获得填充了 TBLNAME1..25 的所有值的那些记录。但是您的要求是单独查找有多少记录不具有空值。

您可以对每列使用联合并分别获取计数，然后将它们相加以获得非空值的总数。

让我知道这是否是预期的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-29T14:20:15.627

那是因为您正在查找 tblName1 和 tblName2 都为空的记录。这是你的意图吗？如果不是，那么您可以尝试：

```
Select count(*) totalrows 
From jSettings 
where linkToJData = '56211010105' 
  and (tblName1 IS NOT NULL OR tblName2 IS NOT NULL) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-29T14:27:20.637

你可以这样做

```
declare @Data xml = 
(
    select *
    from jSettings
    where linkToJData = '56211010105'
    for xml path('row')
)

select count(*)
from @Data.nodes('/row/*[local-name(.) != "linkToJData"]') as T(C); 
```

如果你不想使用 xml，你可以使用这个查询：

```
select count(*)
from jSettings as j
    outer apply (values
        (j.tblName1),
        (j.tblName2),
        (j.tblName3),
        (j.tblName4),
        (j.tblName5)
    ) as C(name)
where j.linkToJData = '56211010105' and c.name is not null; 
```

如果您有很多列并且不想手动指定它：

```
declare @stmt nvarchar(max)

select @stmt =
    isnull(@stmt + ', ', '') + '(j.' + c.name + ')'
from sys.syscolumns as c
where id = object_id('dbo.jSettings') and c.name <> 'linkToJData'

select @stmt = '
select count(*)
from jSettings as j
    outer apply (values ' + @stmt + ') as C(name)
where j.linkToJData = @linkToJData and c.name is not null'

exec sp_executesql
    @stmt = @stmt,
    @params = N'@linkToJData nvarchar(128)',
    @linkToJData = '56211010105' 
```

**`[sql fiddle demo](http://sqlfiddle.com/#!3/51178/7)`**

我建议第 1 个或第 3 个 - 这样您就不必更改新列的查询

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-29T14:34:14.270

```
Select 'tblName1',count(*) totalrows1 
From jSettings 
where linkToJData = '56211010105' 
  and tblName1 IS NOT NULL
union
Select 'tblName2',count(*) totalrows2
From jSettings 
where linkToJData = '56211010105' 
  and tblName2 IS NOT NULL 
```

尝试此代码以获取个人计数。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-29T14:49:59.307

```
SELECT
 sum(case when tblName1 is null then 0 else 1 end) +
 sum(case when tblName2 is null then 0 else 1 end) +
 sum(case when tblName3 is null then 0 else 1 end) +
 sum(case when tblName4 is null then 0 else 1 end) +
 sum(case when tblName5 is null then 0 else 1 end) +
 sum(case when tblName6 is null then 0 else 1 end) +
 sum(case when tblName7 is null then 0 else 1 end) +
 sum(case when tblName8 is null then 0 else 1 end)   
FROM jSettings 
WHERE linkToJotData = '56211010105' 
```

这确实报告了**7**，这是正确的，因为唯一具有*NULL*的表是 tblName8。

# ssis - 如何从 ssis 中的变量读取缓冲区路径？

> ID：13627645
> 
> 赞同：-2
> 
> 时间：2012-11-29T14:11:48.263
> 
> 标签：ssis

在设计 ssis 包时，我将缓冲区路径指定为 ("E:\ SSIS_Temp")。配置后，我已将此包部署在另一台服务器上。在该服务器中没有 E: 驱动器。在这种情况下，如何为此包分配本地缓冲区路径。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T15:45:51.553

创建一个变量来保存缓冲区路径（在此示例中`file_storage_path`），当您选择相应的数据流任务时，从属性列表中编辑表达式，如下所示：

![在此处输入图像描述](../Images/6f66f6dd70a45a18ee9296132ac44914.png)

之后，您可以根据执行位置和方法传递不同的参数值。

# asp.net - 将值绑定到页面加载中 MySQL 数据库列表中的下拉列表

> ID：13627646
> 
> 赞同：-1
> 
> 时间：2012-11-29T14:11:51.290
> 
> 标签：asp.net, mysql, mysqlconnection

我对将数据库中的值填充到 asp.net 中的下拉列表有疑问。

我正在使用名称空间->

```
using MySql.Data.MySqlClient; 
```

我如何在页面加载时绑定下拉列表？我还想从下拉列表中检索值以在文本控件中显示数据。任何人都可以提出帮助吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T14:16:00.913

我想你正在寻找这样的东西：

[http://dev.mysql.com/doc/connector-net/en/connector-net-tutorials-entity-framework-databinding-linq-entities.html](http://dev.mysql.com/doc/connector-net/en/connector-net-tutorials-entity-framework-databinding-linq-entities.html)

# javascript - 背景图像交换全屏

> ID：13627648
> 
> 赞同：1
> 
> 时间：2012-11-29T14:11:56.820
> 
> 标签：javascript

我正在使用背景图像交换，每次刷新都会改变。它工作正常，body 标签具有 onLoad 功能。但我希望图像能够正确缩放，现在我只得到一张图像。有人对缩放有任何想法吗？

```
<script type="text/javascript">
    function randomize(min, max) {
        if (!min)
            min = 0;
        if (!max)
            max = 1;
        return Math.floor(Math.random()*(max+1)+min);
    }
    function randomBg() {
        var bgs = new Array();
        bgs.push("images/bg/bg1.jpg");
        bgs.push("images/bg/bg2.jpg");
        bgs.push("images/bg/bg3.jpg");
        bgs.push("images/bg/bg4.jpg");
        bgs.push("images/bg/bg5.jpg");
        bgs.push("images/bg/bg6.jpg");
        bgs.push("images/bg/bg7.jpg");
        bgs.push("images/bg/bg8.jpg");
        bgs.push("images/bg/bg9.jpg");
        bgs.push("images/bg/bg10.jpg");
        document.body.style.backgroundImage = "url(" + bgs[randomize(0, bgs.length-1)] + ")";
    }
</script> 
```

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T14:15:33.217

看看 CSS [`background-size`](https://developer.mozilla.org/en-US/docs/CSS/background-size#Syntax)。
( `document.body.style.backgroundSize = ''`)

即使在调整窗口大小时，这也会创建一个背景层来填充文档：

```
document.body.style.backgroundSize = '100% 100%';
document.body.style.backgroundRepeat = 'no-repeat'; 
```

# php - php - 有人可以帮我做一个 sql 排序来获得 2 个价格值之间的列表吗？

> ID：13627651
> 
> 赞同：0
> 
> 时间：2012-11-29T14:11:59.980
> 
> 标签：php, sql

我需要对该表进行排序以显示使用文本框设置的 2 个值之间的价格，但我尝试了很多验证，但它在这里不起作用是文本框的形式和我认为查询应该是什么（来自 index2.php ):

```
<form action ="index2.php" method="post">
                        Games priced<input action="index2.php" method="post" type="text" name="min">
                        Between<input action="index2.php" method="post" type="text" name="max">
                        <input type="submit" value="Sort">

                        <?php

                        $query = "SELECT * FROM CSGames WHERE price <=min AND >=max ";
                        $result = pg_query("SELECT * FROM CSGames WHERE price <=min AND >=max ");

                        ?> 
```

这是我正在使用的 sql 数据库

```
<?php
$con = pg_connect("bla bla");
    if (!$con)
        {
    die('Could not connect: ' . pg_error());
        }
    $result = pg_query("SELECT * FROM CSGames");
    echo "<table>
    <tr>
    <th>Title</th>
    <th>Platform</th>
    <th>Description</th>
    <th>Price</th>
    <th>Select</th>
    </tr>";

    while($row = pg_fetch_array($result)){
    echo"<tr>";
    echo "<td>" . $row['1'] . "</td>";
    echo "<td>" . $row['2'] . "</td>";
    echo "<td>" . $row['3'] . "</td>";
    echo "<td>" . $row['4'] . "</td>";
    echo '<td><input type="checkbox" name="games[]" value="' . $row['1'] . '|||' . $row['2'] . '|||'. $row['3'] . '|||' . $row['4'] . '"/></td>';

    echo"</tr>";      
        }
    echo"</table>";

pg_close($con); 
```

?>

我认为这只是错误的查询，但我不确定它是否有帮助这是我正在处理的页面 [http://users.aber.ac.uk/edd14/cs25010/index.php](http://users.aber.ac.uk/edd14/cs25010/index.php)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T14:15:30.183

在这里，一个 between 子句仅适用于这些情况：

```
SELECT * FROM `CSGames`
WHERE `price` BETWEEN min AND max; 
```

文档：[http ://dev.mysql.com/doc/refman/5.0/en/comparison-operators.html](http://dev.mysql.com/doc/refman/5.0/en/comparison-operators.html)

将 min 和 max 替换为表单中经过*清理*的$_POST 变量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T14:13:34.513

```
 $query = "SELECT * FROM CSGames WHERE price >=min AND price <=max ";
     $result = pg_query("SELECT * FROM CSGames WHERE price >=min AND price <=max "); 
```

# c# - 异步调用和上下文

> ID：13627654
> 
> 赞同：0
> 
> 时间：2012-11-29T14:12:10.517
> 
> 标签：c#, .net, asynchronous

是否可以使用与主函数相同的上下文异步调用函数而不在参数中发送上下文？

## 例如

**方法1**：

*   做一些工作...
*   异步调用`Method2`（使用任务或委托等）而不在参数中发送任何上下文
*   做点别的工作...

**方法2**：

*   从上下文开始`Method1`（不设置上下文）
*   做一些工作...

我正在开发一个应该在服务器上运行的控制台 (C#/.NET) 项目。编辑：我忘了说：我正在使用 VS 2010（无 Async/Await）
我需要这个，因为一些个人对象与上下文一起工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T14:33:13.863

如果我正确理解了您的问题，那么您可能需要一个私有属性。您创建一个类，其中包含您需要在它们之间操作的每个属性，并将其存储在两个方法都可以访问的地方。类似于以下内容：

```
//  Context class you create
public class Ctx{
    //  context data properties
    //  methods, etc
}

public class DoStuff{

    private Ctx context;

    public void M1(){
        context = new Ctx();
        //  do stuff

        //  use some beginInvoke or whatever
        //  to call M2()

        //  do the rest of your stuff
    }

    public void M2(){

        Ctx tmp = context;

        //  do stuff

    }
} 
```

请记住，像这样共享内容可能会导致并发问题，为此您应该创建一个线程安全的上下文类，或者确保仅在 lock 语句中访问上下文对象。类似于：

```
public class Ctx{
    public readonly Object _lock = new Object();

    private int v1 = 0;
    public int V1{
        get{
            lock(_lock)
                return v1;
        }
        set{
            lock(_lock)
                v1 = value;
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T14:24:08.620

绝对地。执行此操作的常见模式是将上下文中所需的所有内容封装到单个类对象中。如果您只有一个上下文，并且不打算有多个并发调用，则不*必将*其分离到自己的类中。（注意：在采用这条捷径之前，您需要真正确保没有违反此规定的边缘情况。）但是这样做更干净，而且不需要太多额外的工作。

有很多方法可以做到这一点，其中之一如下。

```
public class ExampleClass
{
    private object _myContextInfo; //This can be multiple objects, or a single structured object or whatever you need.
    public void Main()
    {
        _myContextInfo = new object();//Set this to whatever you need
        var bw = new BackgroundWorker();
        bw.DoWork += DoSomethingAsync;
        bw.RunWorkerCompleted += TakeActionOnCompletion;
        bw.RunWorkerAsync();

        //Do whatever you want done in parallel to your other item here
    }

    private void DoSomethingAsync(object sender, DoWorkEventArgs e)
    {
        //Do whatever you need and use the class fields however you want;
    }

    private void TakeActionOnCompletion(object sender, RunWorkerCompletedEventArgs e)
    {
        //Use the results however you need and read/manipulte the class fields however you want;
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-29T14:33:11.257

我认为，您可以执行以下操作：

```
static void Method2() { }

static void Method1()
{
    var sc = SynchronizationContext.Current;
    sc.Post(delegate { Method2(); }, null);
} 
```

我在某处读到 await 的实现类似于他的（不幸的是我找不到我的来源）这是您要找的吗？

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-11-29T14:24:45.783

要异步调用另一个方法，我会为该方法创建一个新线程。在该线程中，您仍然可以在完成后立即调用回调方法。

[这是一个可能会有所帮助的教程。](http://www.albahari.com/threading/)

# forms - 从子窗体调用主窗体

> ID：13627656
> 
> 赞同：2
> 
> 时间：2012-11-29T14:12:11.590
> 
> 标签：forms, vba, ms-access, subforms

我有一个访问数据库，它有一个带有 VBA 填充日期的表单。

每次表单加载时，日期都会自动填充到标有“日期”的文本框中。在同一个表单上，我有一个子表单链接到一个单独的表格以进行计算。

我希望将该“日期”字段中的相同日期保存在我的子表单计算表中。

有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T14:56:33.217

对于您的计算，您可以像这样引用父表单上的日期控件（*未经测试*）

```
Me.Parent.lblDate 
```

假设你想在 3 天前计算

```
DateAdd("d",-3,Me.Parent.lblDate) 
```

# dynamics-crm-2011 - Dynamics CRM 超出其存储限制，但“正在使用的资源”表示仅使用了 28%

> ID：13627659
> 
> 赞同：3
> 
> 时间：2012-11-29T14:12:18.003
> 
> 标签：dynamics-crm-2011, dynamics-crm, dynamics-crm-online

我们有一个动态 CRM 在线实例，我们正在向其中上传大约 220 万条记录。

我们之前（多次）为试用实例做过这个，没有问题。通常它们会占用 5GB 存储限制的 50% 左右。

昨晚我们开始导入一个新的 CRM 实例——一个链接到一个共享点和一个活动的 Office 365 帐户的实例。

大约 75% 的导入进入，但现在我们在 CRM 的系统通知部分也显示了一条错误消息。消息是“您的组织 XXXX，已超出其存储限制...”。

但是，当我查看 CRM 中的“正在使用的资源”页面时，它告诉我我们只使用了 5GB 限制的 28%。

有任何想法吗？

![使用中的资源截图](../Images/67de0ecb1c2b9c66db46f594055705bc.png)

![有关超出存储限制的系统通知](../Images/620ea2e30aa45c5579d6c43873e508ed.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-04T00:25:44.217

由于以下几个原因，实际和报告的存储数据之间可能存在差异：

1.  您的导入可能会触发系统作业。系统作业记录通常会在以后删除，但是当它们存在时可能会消耗大量存储空间，一旦这些作业被删除，这些存储空间就会被释放。删除作业后，您可能正在查看“正在使用的资源”页面。
2.  CRM Online 的存储分析是批量执行的（但我不确定频率）。因此，在加载/删除记录和查看存储资源利用率变化之间通常存在延迟。

无论哪种情况，您都可能需要联系 CRM 在线支持来确定如何最好地解决您的问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-06T16:19:33.287

Microsoft 支持今天解决了这个问题。

他们对我的回应包括：

“......很遗憾，组织报价设置不正确，运营团队已将其设置回 5GB。问题出在我们这边，不是由您或导入数据引起的......”

# c# - 选择列表时提高性能

> ID：13627660
> 
> 赞同：2
> 
> 时间：2012-11-29T14:12:33.177
> 
> 标签：c#, performance, linq

我有如下方法：

```
public static IList<MedicalRecord> UpdateServicePrice(
                         IList<MedicalRecord> mListMedicalRecord, 
                         IList<ServicePrice> listAllServicePrice)
{
    foreach (MedicalRecord medical in mListMedicalRecord)
    {
        medical.mListServicePrice =
            (from p in listAllServicePrice
             where p.MedicalRecordID == medical.MedicalRecordID
            select p).ToList();
    }
    return mListMedicalRecord;
} 
```

但它运行得很慢。任何人都可以帮助我提高上述方法的性能？非常感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T14:27:35.707

这是一个`Join`基于 - 的方法，应该可以实现相同的目标，但速度更快：

```
public static IList<MedicalRecord> UpdateServicePrice(
    IList<MedicalRecord> mListMedicalRecord,
    IList<ServicePrice> listAllServicePrice)
{
    foreach (var j in mListMedicalRecord.GroupJoin(listAllServicePrice,
        mr => mr.MedicalRecordID,
        sp => sp.MedicalRecordID,
        (mr, sps) => new { Record = mr, Prices = sps }))
    {
        j.Record.mListServicePrice = j.Prices.ToList();
    }
    return mListMedicalRecord;
} 
```

您的代码循环遍历`ServicesPrices`每个`MedicalRecord`. Join 遍历价格一次，按记录 ID 对它们进行分组，然后将它们连接到正确的记录。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T14:16:13.410

通过将 'where' 替换为 'join' 子句，您可能会获得显着的改进。

# python - 如何保存在 IPython 会话中编写的代码？

> ID：13627662
> 
> 赞同：17
> 
> 时间：2012-11-29T14:12:37.527
> 
> 标签：python, ipython

> **可能重复：**
> [如何保存 Python 交互式会话？](https://stackoverflow.com/questions/947810/how-to-save-a-python-interactive-session)

有没有可能，如果有，我该如何保存我在 IPython 会话中编写的代码？

理想情况下，我只会输出运行时没有错误的代码，但我想，导出所​​有代码也会有很长的路要走。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-11-29T14:33:41.380

`%save my_useful_session 10-20 23`

将输入行 10 到 20 和 23 保存到`my_useful_session.py`

# oauth - 测试用户通过 FB.login() 登录时没有 authResponse

> ID：13627664
> 
> 赞同：1
> 
> 时间：2012-11-29T14:12:39.177
> 
> 标签：oauth, authorization, facebook-javascript-sdk

我尝试使用 javascript SDK 构建一个 facebook 应用程序。我想登录我的应用程序并尝试使用以下说明：[https ://developers.facebook.com/docs/howtos/login/getting-started/#step4](https://developers.facebook.com/docs/howtos/login/getting-started/#step4)

我的完整代码现在看起来像这样：

```
if(jQuery) (function(jQuery){

jQuery(document).ready(function() {

    $('body').prepend('<div id="fb-root"></div>');
    FB.init({appId: MY_APP_ID, status: true, cookie: true, xfbml: true, oauth: true});

    FB.getLoginStatus(function(response) {
        if(response.status === "connected") {
            console.log("welcome facebook user.");
        } else if (response.status === "not_authorized") {
            console.log("not authorized");

            FB.login(function(loginStat) {
                if(loginStat.authResponse) {
                    console.log("now logged in");
                    console.log(loginStat);
                } else {
                    console.log("still not authorized");
                    console.log(loginStat);
                }
            });
        }   
    });
}); 
```

})(jQuery);

我可以使用此代码使用我创建该应用程序的 Facebook 帐户登录自己，但如果我尝试使用我的测试 Facebook 帐户登录，则会出现“注册您的应用程序”弹出窗口，我可以单击“转到应用程序”。但它总是会出现在“仍然未授权”的分支中，loginStat 对象如下所示：status="not_authorized", authResponse=null。

有谁知道为什么？

# c# - mvc3 checkboxfor enum 没有枚举在模型中

> ID：13627668
> 
> 赞同：2
> 
> 时间：2012-11-29T14:12:48.437
> 
> 标签：c#, asp.net-mvc-3, html-helper

**问题：**

我想显示基于枚举的复选框列表：例如 item1[] item2[] item3[]

但是，需要根据逗号分隔列表的内容检查这些复选框`model.platforms`

例如：如果`model.platforms`= "1,3,5"，那么页面上的输出应该是：

项目1[x] 项目2[] 项目3[x] 项目4[] 项目5[x]

**到目前为止我所做的：** 到目前为止，我已经尝试创建一个自定义帮助程序，它接受枚举类型和我的“model.platforms”。目的是在逗号处拆分平台，然后在遍历枚举时，选中复选框如果`value`枚举在列表中。

***我什至接近这个权利吗？***我知道 MVC/C# 的方式，但这些助手对我来说确实是新的。任何能指引我正确方向的指导将不胜感激

我试图在 SO 上查找各种解决方案，但其中大多数都围绕作为模型一部分的枚举，由于模型的生成方式，这对我来说并不实用（而且我真的不想添加此特定场景的视图模型）

**到目前为止的代码**

--helper.cs--

```
public static MvcHtmlString PlatformList<enumType>(this HtmlHelper htmlHelper, string platformList)
{
  List<string> selectedPlatforms = platformList.Split('/').ToList(); //This will come from model.platforms ("platform1/platform2/etc")
  TagBuilder tg = new TagBuilder("div");
  string innerhtml = "";
  foreach (var item in Enum.GetValues(typeof(enumType)))
  {

    innerhtml = innerhtml + "{build up here}";

  }
  tg.SetInnerText(innerhtml);
  return new MvcHtmlString(innerhtml);
} 
```

--枚举.cs--

```
public enum en_GamePlatforms
{
  [Display(Name = "PC")]
  PC =1,
  [Display(Name = "DOS")]
  DOS = 2,
  ...{etc}...
  } 
```

- 看法 -

```
 @(Html.Raw(Html.PlatformList<MagpieEnumerations.en_GamePlatforms>(Model.Platform).ToString())) 
```

* * *

以下是我真正不喜欢的原始方法，但在页面上提供了正确的输出。（但它关闭了枚举名称而不是值:()）

```
 @{
                List<string> platformsActive = Model.Platform.Split(',').ToList();

            }
            @foreach (myenums.en_GamePlatforms item in Enum.GetValues(typeof(myenums.en_GamePlatforms)))
            {
                <span>
                    @Html.Label("SelectedPlatform" + item, Enum.GetName(typeof(myenums.en_GamePlatforms), item))
                    @{bool t = platformsActive.Contains(item.ToString(Model));}
                    <input name="Selectedtypes" id="Selectedtypes" type="checkbox"  @(t ? "checked='checked'" : "")  value="@item"/> | 
                </span>
            } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T09:53:13.893

您可以使用以下代码来实现它。

```
public static IHtmlString CheckboxListForEnum<T>(this HtmlHelper html, string name, T modelItems) where T : struct
{
    StringBuilder sb = new StringBuilder();

    foreach (T item in Enum.GetValues(typeof(T)).Cast<T>())
    {
        TagBuilder builder = new TagBuilder("input");
        long targetValue = Convert.ToInt64(item);
        long flagValue = Convert.ToInt64(modelItems);

        if ((targetValue & flagValue) == targetValue)
            builder.MergeAttribute("checked", "checked");

        builder.MergeAttribute("type", "checkbox");
        builder.MergeAttribute("value", item.ToString());
        builder.MergeAttribute("name", name);
        builder.InnerHtml = item.ToString();

        sb.Append(builder.ToString(TagRenderMode.Normal));
    }

    return new HtmlString(sb.ToString());
} 
```

请[在 asp.net MVC 中参考这个 url checkboxlist](https://stackoverflow.com/questions/6217747/checkboxlist-in-asp-net-mvc)

# java - JFace TableViewer：使单元格背景颜色闪烁

> ID：13627676
> 
> 赞同：3
> 
> 时间：2012-11-29T14:13:11.600
> 
> 标签：java, swt, background-color, tableviewer, blink

我目前正在开发一个 Eclipse RCP 应用程序，该应用程序显示多个`TableViewer`包含可编辑单元格的 s。这些单元通过 EMF 数据绑定连接到我的模型。

现在我希望编辑后的单元格闪烁绿色，这意味着将背景颜色设置为绿色然后淡出。为了更容易上手，我想将单元格背景颜色设置为绿色，然后在 1 秒后恢复为白色。

起作用的原因是将背景颜色设置为绿色，但我无法在一秒钟后将其设置回白色，因为`ViewerCell`那时我正在编辑的会自动设置为空，我不知道为什么.

这是我的代码摘录（不起作用）`CellLabelProvider`：

```
@Override
public void update(final ViewerCell cell) {
     //this works:
     cell.setBackground(new Color(Display.getCurrent(), 0, 255, 0));        
     Display.getCurrent().timerExec(1000, new Runnable() {
          public void run() {
                //for this I get a NullPointerException:
                cell.setBackground(new Color(Display.getCurrent(), 255, 255, 255));
          }
     });
} 
```

任何帮助将非常感激！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-29T15:35:22.997

[有一个与在https://bugs.eclipse.org/bugs/show_bug.cgi?id=201280](https://bugs.eclipse.org/bugs/show_bug.cgi?id=201280)`ViewerRow`中设置为 null的修复相关的错误`ViewerCell`

要解决您遇到的问题，您不应使用`ViewerCell`.

试试这个代码

```
col.setLabelProvider(new ColumnLabelProvider() {
          @Override
          public void update(final ViewerCell cell) {
               cell.setBackground(Display.getDefault().getSystemColor(SWT.COLOR_DARK_GREEN)); 
               final int index = cell.getColumnIndex();
               final TableItem item = (TableItem) cell.getItem();
               Display.getCurrent().timerExec(1000, new Runnable() {
                    public void run() {
                      //make sure table is not disposed
                      item.setBackground(index, Display.getDefault().getSystemColor(SWT.COLOR_WHITE));
                    }
               });
          }
        }); 
```

# vba - 响应单元格值变化自动执行

> ID：13627677
> 
> 赞同：1
> 
> 时间：2012-11-29T14:13:13.257
> 
> 标签：vba, excel, automation, execution

我知道代码可能不是很好，但我仍在学习 VBA。

我创建了一个工作表来组织我的大学课程列表，但我试图让它在我更改前两列中的值时自动执行代码。

第一列中的“x”将其选择为已完成的课程，从所需的总小时数中减去该课程的学分。第二列中的“S”和一些数字表示一个学期，并总结了每学期要修读的学分，例如，如果我在“工程学习和职业”旁边输入“S1”，那么它将占用该课程的 1 个学分，并将其添加到整个学期的总学时中。

这两个代码完全相互独立。

工作表截图：http: [//i.imgur.com/G850X.png](http://i.imgur.com/G850X.png)

代码：

```
Private Sub Calculations()

    Dim creditsLeft As Integer creditsLeft = 130

    For i = 3 To 43
        If Cells(i, 1).Value = "x" Then creditsLeft = (creditsLeft - Cells(i, 8)) Next i

    Range("J3").Value = creditsLeft

    Dim S1creds, S2creds, S3creds, S4creds, S5creds, S6creds As Integer

    For i = 3 To 43
        If Cells(i, 2).Value = "S1" Then S1creds = (S1creds + Cells(i, 8))
        If Cells(i, 2).Value = "S2" Then S2creds = (S2creds + Cells(i, 8))
        If Cells(i, 2).Value = "S3" Then S3creds = (S3creds + Cells(i, 8))
        If Cells(i, 2).Value = "S4" Then S4creds = (S4creds + Cells(i, 8))
        If Cells(i, 2).Value = "S5" Then S5creds = (S5creds + Cells(i, 8))
        If Cells(i, 2).Value = "S6" Then S6creds = (S6creds + Cells(i, 8)) 
    Next i

    Range("J9").Value = "Sem 1 Hrs: " 
    Range("J10").Value = "Sem 2 Hrs: "
    Range("J11").Value = "Sem 3 Hrs: " 
    Range("J12").Value = "Sem 4 Hrs: "
    Range("J13").Value = "Sem 5 Hrs: " 
    Range("J14").Value = "Sem 6 Hrs: "

    Range("K9").Value = S1creds 
    Range("K10").Value = S2creds
    Range("K11").Value = S3creds 
    Range("K12").Value = S4creds
    Range("K13").Value = S5creds 
    Range("K14").Value = S6creds

    End Sub 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T14:41:52.990

你甚至不需要 VBA。

I3：`=130-SUMIF(A3:A43,"x",H3:H43)`
K9：`=SUMIF(B3:B43,"S1",H3:H43)`
K10：`=SUMIF(B3:B43,"S2",H3:H43)`
K11：`=SUMIF(B3:B43,"S3",H3:H43)`
K12：`=SUMIF(B3:B43,"S4",H3:H43)`
K13：`=SUMIF(B3:B43,"S5",H3:H43)`
K14：`=SUMIF(B3:B43,"S6",H3:H43)`

# django - SIGWINCH 被忽略。没有被守护

> ID：13627678
> 
> 赞同：2
> 
> 时间：2012-11-29T14:13:14.613
> 
> 标签：django, gunicorn

我的 gunicorn 日志中不断出现以下内容：

```
SIGWINCH ignored. Not daemonized 
```

我正在`./manage.py run_gunicorn --workers=4`通过`screen`.

这条消息是什么意思？我应该担心吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-05-16T09:43:40.387

这是 Github 上的这个问题解释（[问题链接](https://github.com/benoitc/gunicorn/issues/449)）

如果终端调整大小，则会发生这种情况

# sql-server - 何时使用 sp_getapplock

> ID：13627679
> 
> 赞同：2
> 
> 时间：2012-11-29T14:13:31.023
> 
> 标签：sql-server, concurrency

我有以下情况：存储过程间歇性地使用两个表。我必须同时执行这个 sp（比如同时执行 50 个）。这让我在大约 33% 的情况下陷入僵局。问题是：在这里使用 sp_getapplock 合适吗？我要做的就是添加：

```
exec sp_getapplock @Resource = 'resource_name', @LockMode = 'exclusive',@LockTimeout = '60000', @DbPrincipal = 'dbo' 
```

作为事务中的第一个命令，一切似乎都在工作。除了并发，但没关系。令人不安的是，我正在尝试做数据库实际应该做的事情。也许这种方法有更好的选择或严重的缺点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-25T21:50:42.040

您现在可能已经解决了这个问题，但以防万一。负载下的大型复杂数据库几乎肯定会不时遇到死锁。数据库很难预测到能够确定在流程后期是否存在资源争用所需的程度。您可以做很多事情来最大程度地减少死锁，包括良好的索引、结构良好的表访问等等（那里有大量信息）。但是，有时您可能无法以避免死锁的方式构建代码，并利用`sp_getapplock`绝对不是坏事。正如您所指出的，它确实会导致瓶颈，因为您不再具有并发性。但是消除死锁的好处可能不仅仅是在性能方面弥补了它。对我来说不幸的是，我在我的一个 SP 中尝试了类似的东西，但调用`sp_getapplock`本身会导致死锁 - 所以它并不总是能保证解决问题。

从根本上说，它确实归结为您想要实现的目标。但请确保您使用的数据库越复杂，您需要手动调整它的各个方面的机会就越大——它不会为您完成所有工作，这就是为什么仍然需要优秀的数据库专家的原因。我想说的是，除非您对 SP 是单线程有特定要求，否则使用`sp_getapplock`不应该是您解决问题的第一次尝试——我只使用了 3 次或其他什么。但是，鉴于您的情况，我肯定会选择它，因为它可以解决您的问题，不需要您了解 SP 的复杂内部结构，并且可能没有任何不良副作用。最有可能的是它可能会变慢 - 但听起来你没有注意到这一点？

# java - 为树状数据寻找更好的结构

> ID：13627684
> 
> 赞同：4
> 
> 时间：2012-11-29T14:13:42.750
> 
> 标签：java, data-structures, tree

我有一个可扩展的树（在 HTML 页面中）：

```
+ Category 1
- Category 2
  + Subcategory 1
  - Subcategory 2
    |- Foo
    |- Bar
    |- Link 42 
```

它由一个结构表示（在后端定义）：

```
class Demo {
  static ImmutableList<Item> sample() {
    return ImmutableList.of(
        new Item("Category 1", ImmutableList.of(
            new Item("Some link title", "resource_id_1"),
            new Item("Another link title", "resource_id_2"))),
        new Item("Category 2", ImmutableList.of(
            new Item("Subategory 1", ImmutableList.of(
                new Item("Another link title", "resource_id_3"))),
            new Item("Subcategory 2", ImmutableList.of(
                new Item("Foo", "resource_id_1"),
                new Item("Bar", "resource_id_2"),
                new Item("Link 42", "resource_id_42"))))));
  }
} 
```

定义`Item`如下：

```
public class Item {
  private String readableName;
  private String resourceId;
  private ImmutableList<Item> children;

  Item(String name, String resourceId) {
    this.readableName = name;
    this.resourceId = resourceId;
  }

  Item(String name, ImmutableList<Item> children) {
    this.readableName = name;
    this.children = children;
  }

  public String getReadableName() {
    return readableName;
  }

  public String getResourceId() {
    return resourceId;
  }

  public ImmutableList<Item> getChildren() {
    return children;
  }
} 
```

`resourceId`可以有不同的可读名称，并且可以在整个结构中多次放置，但在当前类别/子类别中只能放置一次。

当前，当用户单击链接**或**写入 URL 时，资源会被加载（例如链接*Foo*映射到`/showResource?id=resource_id_1:uniqe_magic_id`）并展开树。它之所以起作用，只是因为 hack - 前端创建自己的结构副本，将一些`:uniqe_magic_id`字符串附加到每个资源 id（每个叶子），并且在向后端发送请求时，它会删除魔术部分。`:uniqe_magic_id`仅由前端用于扩展上面显示的树中的适当项目。这对我来说似乎是一个巧妙的解决方案（我正在重构这段代码并删除`cleanId`了我认为没有必要但在向后端发送请求之前剥离魔法的方法......），我正在寻找一个更好的解决方案。

我可以修改前端和后端。我想到了某种带有节点的树，例如：

```
class Node {
  Node next;
  Node child;
  String readableName;
  String resourceId;
  String someUniqueHash;
} 
```

并使用`someUniqueHash`.

有没有更好的方法来实现相同的结果而不在前端复制整个结构？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-06T20:06:48.483

仅仅断言项目的 id 对于您正在创建的菜单是本地唯一的，并且当子项附加到每个项目时更新对父项的引用，怎么样？

这将允许您扩展 url 中关注的任何内容的子树，前端（假设为 html）将动态导航向用户呈现各种类别的菜单。

*通过添加一个名为Menu*的新类并使Menu 中的*子*项可变，可以通过工厂模式断言项目的本地唯一性。

```
class Menu {
    final HashMap<String, Item> items = new HashMap<String, Item>();
    final List<Item> root = new ArrayList<Item>();

    public Item createItem(String title, String id, Item parent) {
        if (items.containsKey(id)) {
            raise SomeRuntimeException();
        }

        final Item item = new Item(title, id, parent, this);

        if (parent == null) {
            root.add(item);
        }
        else {
            parent.addChild(item);
        }

        items.put(id, item);
    }

    /* default to have no parent, these are root items. */
    public Item createItem(String title, String id, Item parent) {
        return addItem(title, id, null);
    }
} 
```

对 Item 类的一些修改。

```
class Item {
    private final Menu menu;
    private final Item parent;
    private final List<Item> children = new ArrayList<Item>();

    public Item(String name, String resourceId, Menu menu, Item parent) {
        ...
        this.menu = menu;
        this.parent = parent;
    }

    public Item addChild(String name, String resourceId) {
        final Item item = this.menu.createItem(name, resourceId, this);
        this.children.add(item);
        return item;
    }
} 
```

现在我牺牲了一些不变性，因为我相信这种模式在处理错误时比提供一组嵌套列表更具表现力。

**生成不可变菜单**

如果不可变性很*重要*，您可以随时将 Menu 和 Item 更改为接口并实现复制原始 Menu 和 Item 的不可变变体，然后将*copyImmutable*方法添加到将构建请求结构的 Menu 类。

```
class MenuBuilder {
    /* ... contains all things previously declared in Menu ... */
    Menu copyImmutable() {
        ImmutableList<Item> root = ...
        ImmutableMap<String, Item> items = ...
        return new ImmutableMenu(root, items)
    }
} 
```

这意味着您递归地对所有项目执行相同的操作。

**生成菜单的算法**

1.  从*Menu*类中查找项目（处理潜在错误）
2.  将每个父级迭代到该菜单并记录***pathTaken***。
3.  当到达根节点时，将其存储为***activeRoot***。
4.  *从Menu*中按顺序迭代所有根节点并渲染它们。当点击***activeRoot***时，递归渲染所有子节点，但只输入在***pathTaken***中注册的子节点。

我希望这描述了一个解决方案，可以为您提供如何解决问题的灵感！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-13T15:47:46.967

在前端制作树的副本是必要的，因为它代表不同的概念：后端的树代表*模型*，前端的树代表模型*的视图*。这是一个非常重要的区别：后端的树说明要显示什么，而前端的树说明如何显示。具体来说，前端知道树的哪些部分被扩展了：后端不应该知道，因为树节点的打开/关闭状态对于不同的用户会有所不同。

也许你应该做的是明确职责分离。与其制作树的副本并将唯一标识符添加到其资源 ID，不如创建一个单独的类`VisualItem`，封装实际项目的 ID，并拥有自己的唯一 ID（唯一 ID 永远不会进入后端):

```
class VisualItem {
    String resourceId;
    ImmutableList<VisualItem> children;
    String uniqueId;    // Used only in the front end
    boolean isExpanded; // Tells you if the subtree is expanded or not
    // You can add more attributes here to avoid requesting the Item.
    // For example, you could add a readableName here
} 
```

确保 ID 唯一性的一种方法是[使用`UUID`class](http://docs.oracle.com/javase/6/docs/api/java/util/UUID.html)：它提供了一种非常方便的[`randomUUID()`](http://docs.oracle.com/javase/6/docs/api/java/util/UUID.html#randomUUID%28%29)方法，为您提供唯一标识符。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-13T13:20:23.453

如果我理解正确，您正在尝试可靠地识别项目在树结构中的位置，只给定一个非唯一的 ID。

生成的 URL 是否是“永久链接”，即用户可以安全地为它们添加书签并在树结构可能发生变化的 n 年后返回？树结构会改变吗？特别是，您是否曾经将资源移动到不同的类别，但希望其*旧*链接将用户带到*新*位置？

**如果是后者**，您别无选择，只能为每个资源 ID 生成或指定唯一标识符。您可以生成/使用 UUID，或者让用户指定一个 ID 并让代码强制执行唯一性。

**否则**，您可以使用树中项目的位置来为您提供唯一 ID（因为树结构不会改变，或者如果资源急剧移动，用户不能依赖保存的指向未来工作的资源的链接树内）。

例如后者，给定一棵树：

```
- A
  |- Resource1
- B
  + X
  + Y
  - Z
    |- Resource1
    |- Resource24 
```

因此，可以根据每个项目在树中的位置及其非唯一资源标识符为每个项目分配一个复合资源 ID 服务器端。例如，“A/Resource1”和“B/Z/Resource1”。

或者，如果您不想依赖显示名称或始终分配 ID，请使用每个类别在其父类别中的序号位置，例如“1/Resource1”（第一个类别，然后是 Resource1）可以与“2/ 3/Resource1"（第 2 个类别，然后是它的第 3 个子项，然后是 Resource1）。

这正是普通文件系统所做的：识别没有唯一名称的资源（文件/文件夹），给定项目的唯一路径。

（由于服务器端可以执行此分配 - 将 Parent 字段添加到 Item，然后添加一个简单的 getUniqueResourceId() 方法，该方法通过 Parent 链接迭代树以组成唯一路径 + getResourceId()，并将其传递给客户端而不是 getResourceId() - 不需要影响 HTML 前端。）

# python - 如何避免使用 Python 2.7 在 OS X 10.8 上创建 .pyc 文件？

> ID：13627686
> 
> 赞同：8
> 
> 时间：2012-11-29T14:13:51.003
> 
> 标签：python, macos, python-2.7, osx-mountain-lion, pyc

似乎在 OS X 10.8（使用 Python 2.7）上，`.pyc`即使您设置了环境变量，也会创建文件`PYTHONDONTWRITEBYTECODE=1`

如何防止这种情况发生，或者如何说服 Python 不要在与源文件相同的位置创建这些文件。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-12-15T01:55:45.453

我刚刚对此进行了测试，它在 10.8.2 和 Apple 安装的 Python 2.7 上运行良好。

```
$ echo -e 'import bar\n' > foo.py
$ echo -e 'pass\n' > bar.py
$ export PYTHONDONTWRITEBYTECODE=1
$ python foo.py
$ ls -l bar.py*
-rw-r--r--  1 abarnert  staff    6 Dec 14 17:25 bar.py
$ unset PYTHONDONTWRITEBYTECODE
$ python foo.py
$ ls -l bar.py*
-rw-r--r--  1 abarnert  staff    6 Dec 14 17:25 bar.py
-rw-r--r--  1 abarnert  staff  118 Dec 14 17:26 bar.pyc 
```

您可以`python`用`python2.7`、`python2.6`或替换`python2.5`，您将得到相同的结果。

它还适用于 Apple 安装的 10.5-10.7 中的所有 Python，以及我在可用的各种机器上拥有的所有 python.org、Enthought、MacPorts 和 Homebrew Python，以及两个上的标准 python 包不同的Linux发行版。

因此，如果这*是*一个错误，它是一个非常具体的错误，这意味着您必须准确地告诉我们哪个 Python（以及您如何安装它，如果没有库存），以及哪个 OS X 10.8。

更有可能`PYTHONDONTWRITEBYTECODE`不在python的环境中。正如 Mark Ransom 所建议的，您可以通过添加以下内容来验证这一点：

```
import os
print 'PYTHONDONTWRITEBYTECODE is', os.environ.get('PYTHONDONTWRITEBYTECODE', None) 
```

如果它说`None`，这就是问题所在。

所以，`PYTHONDONTWRITEBYTECODE`不在你的环境中。但是你说它*在*你的调用环境中。这怎么可能？好吧，如果您正在使用`bash`，最可能的原因是您忘记了`export`它。在所有愚蠢的方法中，这是我做得最多的一种。但这里有一些我做过的愚蠢的事情：

*   忘记`export`. 你可以`echo $PYTHONDONTWRITEBYTECODE`你想要，它已经清楚地设置了，但`python`还没有看到它……
*   记住`export`，但忘记设置它。`bash`让你`export PYTHONDONTWRITEBYTECODE`即使它没有被定义为任何东西。
*   `export $PYTHONDONTWRITEBYTECODE`. （您可以通过将其设置为非有效标识符来避免这种情况，例如`1`.）
*   记住`export`，但是`export`错误的变量（通常是不小心误用历史以试图节省一些击键）。
*   错字。不管看多少次`PYTHONDOTWRITEBYTECODE`都很好……</li>
*   在终端中进行一些设置，切换到另一个窗口，回到错误的终端窗口，然后运行`python`​​.
*   编辑`~/.bash_profile`，而不是重新加载它或启动一个新的外壳，而是想“我会直接做同样的事情”，然后做一些愚蠢的错字，然后花半个小时看看`.bash_profile`我之前做错了什么想看看我的shell历史。
*   `subprocess`使用/ /whatever从另一个 Python 脚本启动一个 Python 脚本`os.exec*`，不遗余力地要求一个干净的环境，然后想知道为什么我的环境变量没有出现。
*   `execl`使用而不是从 C 启动 Python `execle`，因此您的预期`envp`参数无效。（在某些平台上，这可能是段错误，但不是 x86/x64 OS X。）

无论如何，如果您在终端中手动尝试过，请再试一次。

如果您在您的`.bash_profile`、启动器 shell 脚本、启动器 Python 脚本或其他任何东西中执行此操作，请向我们展示相关代码，有人会立即发现您的愚蠢错误。如果他们嘲笑你，告诉他们阅读我的回答，这样他们就可以嘲笑我了。

PS，请注意，我在测试中做了`export PYTHONDONTWRITEBYTECODE=1`而不是单独的`PYTHONDONTWRITEBYTECODE=1`和`export PYTHONDONTWRITEBYTECODE`行。我总是这样做，除了必须是可移植的 shell 脚本，因为调试在没有直接导出语法的老式 shell 上尝试这个时得到的明显错误比调试由我在上面列出的所有愚蠢错误。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-11-29T16:20:02.607

您可以避免同时创建 .pyc 和 .pyo 文件：`python -B script.py`

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-12-16T21:35:24.417

按照 abarnert 的描述设置环境确实是正确的方法，但如果由于某种原因在您的设置中不可能，您可以在运行时在代码中设置它。

只需将以下内容添加到脚本的顶部：

```
import sys
sys.dont_write_bytecode = True 
```

这将阻止 python 在该点之后生成任何字节码。

```
$ cat > foo.py
#sample module
FOO="BAR"

$ python
>>> import sys
>>> sys.dont_write_bytecode = True
>>> import foo
>>> foo.FOO
'BAR'
>>> ^D

$ ls *.pyc
ls: *.pyc: No such file or directory 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-18T11:53:12.390

我会在你的 python 脚本的顶部建议这个：

```
#!/usr/bin/env python -B 
```

或者，使用[sys.dont_write_bytecode](http://docs.python.org/2/library/sys.html#sys.dont_write_bytecode)方法。

另请参阅：[如何避免 .pyc 文件？](https://stackoverflow.com/questions/154443/how-to-avoid-pyc-files)这提出了一些其他的解决方案，包括一种在 2.6 之前的 python 中工作的方法。

# facebook - Facebook 喜欢按钮未发布到 Facebook

> ID：13627690
> 
> 赞同：1
> 
> 时间：2012-11-29T14:13:59.137
> 
> 标签：facebook, facebook-like

我在这个网站的顶部有一个 facebook like 按钮：[点击这里](http://www.pbjpublishing.com/app/hansel-and-gretel/)

当您单击按钮时，您成功地喜欢该页面，但“发布到 facebook”功能不起作用。模态窗口只是停留在那里。

这一直很好，直到前几天我对网站进行了一些更改，但即使在我删除了这些更改之后，“发布到 facebook”问题仍然存在。

我已经尝试调试该页面，但无济于事。我想也许 facebook 一直在惩罚该网站，因为它太多地弄乱了“like”按钮，但我不确定这是否是 facebook 所做的事情。

任何帮助，将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T15:13:19.257

它工作正常。我点了赞，它出现在用户个人资料页面上： [http ://cl.ly/image/2Q2k3z3W3E0l](http://cl.ly/image/2Q2k3z3W3E0l)

我输入了一个状态并分享了它。它还显示在 Facebook 上： [http ://cl.ly/image/3c1R412x021d](http://cl.ly/image/3c1R412x021d)

我没有看到任何问题。

# c# - 查找递归函数的执行时间

> ID：13627697
> 
> 赞同：1
> 
> 时间：2012-11-29T14:14:13.170
> 
> 标签：c#, function, recursion, timer, stopwatch

我可以使用秒表来查找代码的执行时间

例子：

```
timer.Start();
for(int i=0; i<100; i++)
{
    ...
}
timer.Stop();
lTime.Text = timer.Elapsed.TotalMilliseconds.ToString(); 
```

但是如果我调用一个使用递归的函数呢？

```
timer.Start();
recur(a, b);
timer.Stop();
lTime.Text = timer.Elapsed.TotalMilliseconds.ToString(); 
```

它的显示执行时间为 0。

编辑：这段代码运行良好......我在递归函数中有一个错误......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T14:21:07.350

以下对我有用：

```
using System.Diagnostics;

namespace StackOverflow.Demos
{
    class Program
    {
        public static void Main(string[] args) 
        {
            Stopwatch timer = new Stopwatch();
            timer.Start();
            recur(10000, new object());
            timer.Stop();
            Console.WriteLine( timer.Elapsed.TotalMilliseconds.ToString());
            Console.ReadKey();
        }
        private static void recur(int a, object b)
        {
            if (a > 0)
                recur(--a, b);
        }
    }
} 
```

# c++ - 从 openCV 保存多个帧，并以时间为名称

> ID：13627698
> 
> 赞同：0
> 
> 时间：2012-11-29T14:14:15.730
> 
> 标签：c++, opencv, video-capture

我正在尝试编写一个代码来保存来自 openCV 视频流的一些帧。保存图像的名称应该是时间：这是我的代码：

```
#include "opencv2/opencv.hpp"
#include <opencv2/core/core.hpp>
#include <opencv2/highgui/highgui.hpp>
#include<conio.h>
#include <time.h>
using namespace cv;
using namespace std;

 int main(){

int key = 0;
char dateStr[9];
char timeStr[9];
_strdate(dateStr);
_strtime(timeStr);
char buffer[20];

 VideoCapture cap(1); // open the default camera
if(!cap.isOpened())  // check if we succeeded
    return -1;

namedWindow("image",1);
while(key!=27)
{
    Mat frame;
    cap >> frame; // get a new frame from camera
    imshow("image", frame);

    if(key==13){
        sprintf(buffer,"%s%s.tif",dateStr,timeStr);
        imwrite(buffer,frame);

        }
    key = waitKey(1000); 
} 

destroyAllWindows();
// the camera will be deinitialized automatically in VideoCapture destructor
return 0;

} 
```

当我运行此程序时，什么都没有发生，并且我不止一次地按了 enter 按钮，而且流太慢了。任何想法！！. 感谢您的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T14:33:23.830

2件事：

流式传输很慢，因为您等待的时间太长。更改值`key = waitKey(1000);`以更改程序的帧速率。

此外，如果您按 Enter 键，您只会保存*下一*帧，而不是您当前看到的帧。您应该将该语句移到该`key = waitKey(1000);`语句之前`if`。

# javascript - 如何计算两个输入表单字段并将值放入另一个使用JS和提交按钮？

> ID：13627701
> 
> 赞同：0
> 
> 时间：2012-11-29T14:14:26.447
> 
> 标签：javascript, forms, submit

我知道这是一个非常基本的问题，但我只是在互联网上找不到任何有用的东西。我有 2 个输入框，我想计算该输入并使用提交按钮将结果放入输出中并按表单 ID 导航。

```
<script>
function Calculate()
{

  var resources = GetFieldValue( "Resources" );
  var minutes = GetFieldValue( "Minutes" ); 
  var permin = parseFloat(resources) / 60;
  var result = parseFloat(permin) * parseFloat(minutes);
</script> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T14:24:43.770

```
<body>
<input type='text' id='Resources'/>
<input type='text' id='Minutes' onblur='Calculate();'/>
<form name ="testarea" Method="Get" Action="youpage.html" id='form1'>
<input type='text' id='answer' name='ans' />
</form>
</body>
<script>

function Calculate()
{
  var resources = document.getElementById('Resources').value;
  var minutes = document.getElementById('Minutes').value; 
  var permin = parseFloat(resources) / 60;
  document.getElementById('answer').value=parseFloat(permin) * parseFloat(minutes);
  document.form1.submit();
}
</script> 
```

您的表单将提交，您的答案在 url 中，例如

```
youpage.html?ans=youranswer 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T14:23:44.540

使用 HTML 按钮标签： [http ://www.w3schools.com/tags/tag_button.asp](http://www.w3schools.com/tags/tag_button.asp)

```
<button onClick="Calculate();" value="calculate"> 
```

在函数中计算而不是 GetFieldValue 使用

```
document.getElementbyId("Resources").value; 
```

在哪里

```
<input type="text" id="Resources"> 
```

采用

```
document.getElementbyId("Result").value = result; 
```

填写另一个输入元素。

# ios - 如何正确地从启动画面重定向到 tabBarController？

> ID：13627704
> 
> 赞同：0
> 
> 时间：2012-11-29T14:14:41.023
> 
> 标签：ios

在基于标签栏的应用程序中，我创建了一个初始屏幕并将其设置为根视图控制器。在 splashViewController 中，我想将 tabbar 控制器设置为 windows rootViewController。

```
 SplashViewController *splashViewController = [[SplashViewController alloc]initWithNibName:nil bundle:nil];
splashViewController.loginview = loginview;

self.window.rootViewController = splashViewController; 
```

//SplashViewController

```
[NSTimer scheduledTimerWithTimeInterval:5 target:self selector:@selector(animationFinished) userInfo:nil repeats:nil];

-(void)animationFinished
{
    Appdelegate *delegate = (AppDelegate*)([UIApplication sharedApplication].delegate);
    delegate.window.rootViewController = delegate.tabBarController;
} 
```

所有代码运行没有任何错误，动画完成方法也被调用。但是，即使在我将 Windows rootViewController 设置为 tabbar Controller 之后，启动画面始终保持不变，并且用户不会重定向到 tabBarController。我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T14:38:59.360

从标签栏控制器开始作为应用程序的根会更简单，如果您绝对必须有启动屏幕，请将其呈现为模式显示。这样，当您关闭模态控制器时，您只需继续实际应用程序。

# python - 给定两个整数列表，找到彼此距离 < O(N^2) 内的每一对

> ID：13627711
> 
> 赞同：6
> 
> 时间：2012-11-29T14:15:04.870
> 
> 标签：python, algorithm

我有两个排序的整数列表。我想分别从第一个和第二个列表中找到所有在一定距离内的整数对。

天真的方法是检查每一对，导致 O(N^2) 时间。我确信有一种方法可以在 O(N*logN) 或更短的时间内完成。

在 python 中，朴素的 O(N^2) 方法如下：

```
def find_items_within(list1, list2, within):
    for l1 in list1:
        for l2 in list2:
            if abs(l1 - l2) <= within:
                yield (l1, l2) 
```

pythonic答案的加分。

**应用说明**

我只是想指出这个小谜题的目的。我正在搜索一个文档，并希望在另一个术语的一定距离内找到一个术语的所有出现。首先，您找到这两个术语的术语向量，然后您可以使用下面描述的算法来确定它们是否在给定距离内。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-29T14:17:00.620

没有办法做得更好，`O(n^2)`因为有`O(n^2)`对，因为`within = infinity`你需要让它们全部产生。

* * *

要找到这些对的*数量*是另一回事，可以通过找到每个元素的第一个索引来`e`完成`within-e < arr[idx]`。`idx`例如，可以使用二进制搜索有效地找到索引- 这将为您`O(nlogn)`提供找到这些对的*数量*的解决方案。

它也可以`O(n)`在线`[a,b]`性时间`[a',b']`（具有两个指针和“永不回头”的列表以获得线性时间复杂度。`a>a'``b>=b'`

**伪代码：（**用于线性时间解）

```
numPairs <- 0
i <- 0
a <- 0
b <- 0
while (i < list1.length):
  while (a < i && list1[i] - list2[a] > within):
      a <- a+1
  while (b < list2.length && list2[b] - list1[i] < within):
      b <- b+1
  if (b > a):
      numPairs <- numPairs + (b-a)
  i <- i+1
return numPairs 
```

（我从最初的伪代码中做了一些修复——因为第一个的目标是在单个列表中查找范围内的对数——而不是两个列表之间的匹配，对此感到抱歉）

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-11-29T15:49:39.387

此代码为 O(n*log(n)+m)，其中 m 是答案的大小。

```
def find_items_within(l1, l2, dist):
    l1.sort()
    l2.sort()
    b = 0
    e = 0
    ans = []
    for a in l1:
        while b < len(l2) and a - l2[b] > dist:
            b += 1
        while e < len(l2) and l2[e] - a <= dist:
            e += 1
        ans.extend([(a,x) for x in l2[b:e]])
    return ans 
```

在最坏的情况下，可能是`m = n*n`，但如果答案只是所有可能对的一小部分，这会快很多。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-29T14:41:42.390

这里有一些与你给出的界面相同的东西：

```
def find_items_within(list1, list2, within):
    i2_idx = 0
    shared = []
    for i1 in list1:
        # pop values to small
        while shared and abs(shared[0] - i1) > within: 
            shared.pop(0)
        # insert new values 
        while i2_idx < len(list2) and abs(list2[i2_idx] - i1) <= within:
            shared.append(list2[i2_idx])
            i2_idx += 1
        # return result
        for result in zip([i1] * len(shared), shared):
            yield result

for item in find_items_within([1,2,3,4,5,6], [3,4,5,6,7], 2):
    print item 
```

不是很漂亮，但它应该可以解决问题`O(N*M)`，其中`N`list1 的长度和`M`每个 Item 的共享对列表（假设删除和附加到的元素`shared`平均是恒定的）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-29T22:35:07.307

[您](https://stackoverflow.com/q/4542892/4279)可以使用[“](https://stackoverflow.com/q/12946497/4279)扫描**线**”技术在线`list2`性`[x - within, x + within]`时间`x`（`list1`**`O(n)`**

 **要从`list1`您需要的`O(m)`时间枚举相应的时间间隔，其中`m`是时间间隔的数量，即，整体算法是`O(n*m)`：

```
from collections import namedtuple
from heapq import merge

def find_items_within(list1, list2, within):
    issorted = lambda L: all(x <= y for x, y in zip(L, L[1:]))
    assert issorted(list1) and issorted(list2) and within >= 0

    # get sorted endpoints - O(n) (due to list1, list2 are sorted)
    Event = namedtuple('Event', "endpoint x type")
    def get_events(lst, delta, type):
        return (Event(x + delta, x, type) for x in lst)
    START, POINT, END = 0, 1, 2 
    events = merge(get_events(list1, delta=-within, type=START),
                   get_events(list1, delta=within, type=END),
                   get_events(list2, delta=0, type=POINT))

    # O(n * m), m - number of points in `list1` that are 
    #               within distance from given point in `list2`
    started = set() # started intervals
    for e in events:  # O(n)
        if e.type is START: # started interval
            started.add(e.x) # O(m) is worst case (O(1) amortized)
        elif e.type is END: # ended interval
            started.remove(e.x)  # O(m) is worst case (O(1) amortized)
        else:  # found point
            assert e.type is POINT
            for x in started:  # O(m)
                yield x, e.x 
```

允许重复值`list1`；`x`您可以为每个输入添加索引`Event`并使用字典`index -> x`而不是`started`集合。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-29T14:35:44.700

根据列表中值的*分布*，您可以通过使用 binning 来加快速度：取所有值所在的范围 ( `min(A+B), max(A+B)`)，然后将该范围划分为与`D`您的距离相同大小的 bin重新考虑。然后，要查找所有对，您只需要比较一个 bin 内或相邻 bin 内的值。如果您的值在许多箱之间拆分，这是避免进行 M*N 比较的简单方法。

另一种在实践中可能同样简单的技术：做一种有界线性扫描。从头开始维护列表 A 和列表 B 的索引。在每次迭代中，将索引推进到列表 A（从第一个元素开始），将此元素称为 A0。然后，将索引推进到列表 B。记住 B 的最后一个小于 A0-D 的值（这是我们要开始下一次迭代的地方）。但是，当您在 A0-D 和 A0+D 之间找到值时，请继续前进——这些是您正在寻找的对。一旦 B 中的值变得大于 A0+D，停止此迭代并开始下一个迭代 — 将一个元素进一步推进 A，并从 B < A0-D 的最后一个位置开始扫描 B。

如果平均每个元素附近有恒定数量的对，我认为这应该是 O(M+N)？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-29T14:29:23.803

这似乎有效：

```
from itertools import takewhile
def myslice(lst,start,stop,stride=1):
    stop = len(lst) if stop is None else stop
    for i in xrange(start,stop,stride):
        yield lst[i]

def find_items_within(lst1,lst2,within):
    l2_start = 0
    for l1 in lst1:
        try:
            l2_start,l2 = next( (i,x) for i,x in enumerate(myslice(lst2,l2_start,None),l2_start) if abs(l1-x) <= within )
            yield l1,l2
            for l2 in takewhile(lambda x:(abs(l1-x) <= within), myslice(lst2,l2_start+1,None)):
                yield l1,l2
        except StopIteration:
            pass

x = range(10)
y = range(10)
print list(find_items_within(x,y,2.5)) 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-11-29T14:43:00.783

此方法使用一个字典，其键是 的可能值`list2`，其值是 的值的列表，这些值`list1`在 的该值的距离内`list2`。

```
def find_items_within(list1, list2, within):
    a = {}
    for l1 in list1:
        for i in range(l1-within, l1+within+1):
            if i not in a:
                a[i] = []
            a[i].append(l1)
    for l2 in list2:
        if l2 in a:
            for l1 in a[l2]:
                yield(l1, l2) 
```

这个复杂度有点傻。对于大小为 M 的列表 1 和大小为 N 的列表 2 和大小为 W 的范围内，它是 O(log(M*W) * (M*W + N))。在实践中，我认为它对小 W 非常有效。

**奖励**：这也适用于未排序的列表。**

# html - 在 Boilerplate 上禁用响应

> ID：13627712
> 
> 赞同：0
> 
> 时间：2012-11-29T14:15:06.380
> 
> 标签：html, css, html5boilerplate

我只是想知道如何禁用样板框架上的响应式 css。

到目前为止，我所做的是替换不同的属性，如下所示。它似乎适用于 chrome，但不适用于 IE 和 Firefox，所以我不确定如何真正做到这一点。

```
@media only screen and (min-width: 480px) { 
```

经过

```
@media only screen and (max-width) { 
```

有人能帮我吗 ？

韩国

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T15:57:26.180

我不知道有一种方法可以轻松地用另一组规则全局覆盖一组规则。不过也有选择。

0）只需删除有问题的样式表。（我知道这不是你想要的答案，但它绝对是最可靠的方式）。

1) 如果可行，您可以创建第二个样式表，撤消第一个表中您不想要的所有内容。这很难维护，但会给你你想要的。只要所有规则都相同并且它们在文档中的媒体规则之后，它们就会覆盖它们。

2) 使用 javascript，您可以完全禁用单个样式表，或操纵单个规则。退房`document.styleSheets`。它是一个包含样式表对象的数组。您可以说`document.styleSheets[0].disabled = true`禁用页面上的第一个样式表。您还可以遍历`document.styleSheets[0].cssRules`以操作样式表的所有 css 规则。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T18:16:47.907

`@media`如果您不想要响应式样式，则应该删除。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-01T23:46:17.273

HTML5 Boilerplate 中没有包含响应式 CSS，只有占位符媒体查询。它们不会对您的网站产生任何影响，因此您不必尝试禁用任何东西。

# java - 如何以编程方式使手机进入睡眠状态

> ID：13627714
> 
> 赞同：6
> 
> 时间：2012-11-29T14:15:10.613
> 
> 标签：java, android, standby, powermanager

我需要做一个关闭移动屏幕并以编程方式进入睡眠的应用程序。例如，如果屏幕在没有 user_present 的情况下打开超过 5 分钟，我应该将其关闭。我尝试使用 PowerManager（goToSleep() 函数应该完全符合我的要求，但它似乎不起作用）：

```
PowerManager pm = (PowerManager) m_context.getSystemService(Context.POWER_SERVICE);

  if (pm.isScreenOn() )
   {
    pm.goToSleep(System.currentTimeMillis() + 1000
   } 
```

我的清单中有以下权限：

```
<uses-permission android:name="android.permission.DEVICE_POWER"/> 
```

它抛出异常：java.lang.SecurityException：用户 10068 和当前进程都没有 android.permission.DEVICE_POWER。但我的清单中有这个权限。

有没有另一种方法可以做到这一点，而无需植根我的手机？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T14:47:21.967

`android.permission.DEVICE_POWER`仅授予系统应用程序，第三方应用程序没有此权限。

如果你没有持有wakelock并且如果你减少`SCREEN_OFF_TIMEOUT`了，那么你应该能够在5分钟后实现自动睡眠

# javascript - javascript“单击一次”样式

> ID：13627715
> 
> 赞同：-2
> 
> 时间：2012-11-29T14:15:15.090
> 
> 标签：javascript

> **可能重复：**
> [HTML 5 离线缓存](https://stackoverflow.com/questions/1207150/html-5-offline-caching)

我来自桌面应用程序世界，但更多地进入 javascript 和网络世界。我使用 javascript 的次数越多，我就越喜欢它的功能。我讨厌页面重新加载，并使用 ajax 进行在网站初始页面加载之外我需要的任何通信。到目前为止，我的应用程序是 100% 客户端，并使用本地存储来存储它的信息，并能够根据用户请求和当互联网访问可用时上传到服务器端数据库。

标题中的“单击一次”引用是我想从这个应用程序中获得的那种功能。由于该应用程序是 100% 客户端，因此需要离线使用。有没有办法可以将此应用程序视为一种“单击一次”样式，当您第一次访问网页时，它会下载该页面。然后，从那时起，每次您尝试访问该页面时，都能够检测用户是否有足够快的互联网连接（此检查显然需要很快），如果是这样，则以某种方式检查服务器是否对应用程序进行了任何更改制作（此时无需重新下载整个页面，只需简单地检查差异，并带有小的是/否响应）。如果没有更改，只需打开站点的本地缓存。如果更改重新下载页面，现在将其设置为新的本地缓存。

有没有办法获得这个功能？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T14:20:42.633

[这](https://en.wikipedia.org/wiki/The_cache_manifest_in_HTML5)可能是您正在寻找的。

2018 年编辑：改用这个[https://en.wikipedia.org/wiki/Web_worker](https://en.wikipedia.org/wiki/Web_worker)

# objective-c - 没有+符号的Objective C中电话号码验证的正则表达式

> ID：13627716
> 
> 赞同：2
> 
> 时间：2012-11-29T14:15:18.230
> 
> 标签：objective-c, ios

> **可能重复：**
> [用于电话号码验证的综合正则表达式](https://stackoverflow.com/questions/123559/a-comprehensive-regex-for-phone-number-validation)

没有 + 符号的只有 13 位电话号码的正则表达式是什么？

数字可以从 0 到 9 开始。只允许数字。[没有 + 符号和 . ]

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T14:18:58.437

你可以试试这个： -

```
 @"^\d{13}$" 
```

或者

```
 @"\d{13}" 
```

`\d`表示匹配任何数字

和

`{13}`意味着13次

# programming-languages - 哪种语言适合 http 请求和 html/xml 解析？

> ID：13627719
> 
> 赞同：0
> 
> 时间：2012-11-29T14:15:32.410
> 
> 标签：programming-languages

几个月前，我创建了一个主要使用 db 连接/http 请求的 shellscript（更多信息在本文之后）。但是在我觉得我需要改变我做这件事的方式到“正确的语言”之后。现在，我有相同的程序，用 perl 和 python 编写。但是我不确定哪个对于大多数情况下的小程序/成熟脚本来说“更好”（不是更好，但最合适）：

-DB 查询/插入

- 具有基本身份验证和代理身份验证的 Http 请求

-ftp 连接

- 正则表达式使用

-XML/HTML 解析

我相信我会得到一些反对票，但我需要知道我是否走对了路。要点是，由于该程序的重​​点，我现在避免使用 java。

目前，我坚持使用 python 主要是因为现在，该应用程序是一个命令行程序（使用 pyInstaller ），但我计划在未来做一个 gui，我对使用 wxPython 感到很舒服。

那么，选择 python 是不错的选择吗？考虑所描述的方面？

谢谢阅读。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T14:38:36.820

几乎所有现代、高级和动态语言都针对这类问题。你可以使用 Python、Ruby、Perl、Clojure，我相信还有其他的。这主要取决于 (a) 您的个人喜好；(b) 您拥有的任何部署限制。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T14:19:29.340

我认为 Python 是一个不错的选择，听起来你也倾向于这种方式。

# c# - 对来自流式阅读器的过滤数据执行小计

> ID：13627720
> 
> 赞同：0
> 
> 时间：2012-11-29T14:15:35.963
> 
> 标签：c#, streamreader

编辑为问题未回答

我有一个基于 1 个标准的过滤输出（前 3 个数字是 110,210 或 310，以提供 3 个不同的组）从流读取器进行控制台。问题已编辑，因为第一个答案是我给出的具体示例的文字解决方案，我使用的真实字符串长度为 450 个 ASCII 字符。我已经调整了示例字符串来解决这个问题，任何适用于示例数据的东西都适用于我所拥有的。

所以我真正需要的是可以根据前3个数字从预先指定的已知位置获取3个字母的东西（对于210，它将是字符槽14-16，然后将其用作子类别，总结所有条目在字符槽 33-37 中，并输出那些）。

示例字符串：

```
210!!!!123244AAA75AWEHUIHJUAS!!!11111
210???1223455ABC76554HJHSDFQ????22222
210--32455623ABCFFCDGHDSFAS-----33333
310         1232451    2ABC34       GAERsASDFASDG1234523   44444
310 1234a354GDSAASDR  3 AAA  GF234523653hfdssdgSDASDF      11111
310 12378HJK1234        ABC HJHJK123462 ASDHDFS FA REW     22222
4101111ASDJF     1ABCASF        D1234    ASGF66666
4102222QW12362ER2 ABC 23459876HJKXC          11111
41033333T123 1RWE AAA  ASDFHJKRTR  WQ        22222 
```

最后，我的输出将是：

```
210 AAA 11111
210 ABC 55555
310 ABC 66666
310 AAA 11111
410 ABC 77777
410 AAA 22222 
```

ABC、AAA 等对于相同的起始编号始终位于同一位置，但每个起始编号会有所不同。

同样，汇总金额的位置也仅在每个起始数字的相同位置。

我尝试将一些 string.split 添加到现有代码（如下），但没有任何运气。

```
// Read in a file line-by-line, and store in a List.
List<string> list = new List<string>();
using (StreamReader reader = new StreamReader("file.dat"))
{
    string line;
    while ((line = reader.ReadLine()) != null)
    {
        var beginning = line.Substring(0, 3);
        if (beginning != "210" && beginning != "310" && beginning != "410")
            continue;
        list.Add(line); // Add to list.
        Console.WriteLine(line); // Write to console.
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T14:31:46.703

```
string input = File.ReadAllText("file.dat");
var result = Regex.Matches(input, "(210|310|410).*?([A-C]{3})([0-9]{5})")
    .Cast<Match>()
    .Select(m => new { 
        P1 = m.Groups[1].Value, 
        P2 = m.Groups[2].Value, 
        P3 = Convert.ToInt32(m.Groups[3].Value)
    })
    .GroupBy(x => new{x.P1,x.P2})
    .Select(x=>String.Format("{0} {1} {2}",x.Key.P1,x.Key.P2,x.Sum(y=>y.P3)))
    .ToList(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-30T11:14:08.577

（在此处发布此答案，因为另一个问题已关闭。）对于大文件，使用 ReadAllText 效率低下。

```
public static class LinqToTextReader {
    public static IEnumerable<string> AsEnumerable(this TextReader reader) {
        string line;
        while ((line = reader.ReadLine()) != null) {
            yield return line;
        }
    }
}

class Program {
    static void Main(string[] args) {
        using (StreamReader reader = new StreamReader("file.dat")) {
            var locations = new Dictionary<string, int[]>() {
                {"210", new [] {406, 409, 129, 140, 142, 153}},
                {"310", new [] {322, 325, 113, 124, 126, 137}},
                {"410", new [] {478, 481, 113, 124, 126, 137}}
            };

            var query =
                from line in reader.AsEnumerable()
                let lineStart = line.Substring(0, 3)
                where lineStart == "210" || lineStart == "310" || lineStart == "410"
                let currentLocations = locations[lineStart]
                select new {
                    letters = line.Substring(currentLocations[0], currentLocations[1]),
                    value =
                        int.Parse(line.Substring(currentLocations[2], currentLocations[3])) +
                        int.Parse(line.Substring(currentLocations[4], currentLocations[5]))
                };

            //It should be possible to combine the two queries
            var query2 = 
                from item in query
                group item by item.letters into letterGroup
                select new {
                    letters = letterGroup.Key,
                    total = letterGroup.Sum(item => item.value)
                };

            foreach (var item in query2) {
                Console.WriteLine(item.letters);
                Console.WriteLine(item.total);
            }
        }
    }
} 
```

# ms-access - CRecordset 使用 2 个不同的查询

> ID：13627722
> 
> 赞同：1
> 
> 时间：2012-11-29T14:15:40.377
> 
> 标签：ms-access, mfc

我正在使用 CRecordset 类在我的类和 Access 数据库之间进行数据交换。这个类是使用 VC 6 中的 ClassWizard 生成的。CRecordset 是使用 SQL SELECT * FROM Table 查询打开的，它工作正常。稍后在我的代码中，我有另一种方法来查找数据库中的记录数。因此，使用相同的 CRecordSet 并使用 SQL SELECT count(*) FROM Table 我偶尔会得到结果，错误时会引发未知异常。

因此，可以将 ClassWizard 生成的 CRecordset 类型的类用于不同的查询。

# xml - 如何在 xmlCIM 中关联实例？

> ID：13627723
> 
> 赞同：3
> 
> 时间：2012-11-29T14:15:39.900
> 
> 标签：xml, xsd, wbem

我正在使用[通用信息模型 (CIM)](http://dmtf.org/standards/cim/cim_schema_v2340)为基础设施建模。该模型描述了不同 IT 系统的多个类。它是全面的，因此它由一系列层次结构而不是一个层次结构组成。例如，要表示一个物理服务器机箱，您可以定义一个 CIM_Chassis 实例。然后，为了表示将在该硬件上运行的逻辑服务器，您定义了一个 CIM_ComputerSystem 实例。然后您应该将两者与 CIM_SystemPackaging 的一个实例相关联，以注意其中一个是由另一个提供的。任何一个类中都没有可以将一个设置为另一个的属性的属性。它们是两个独立的类，由第三个相关联。该模型将使用 XML 进行描述，并通过当前用于 CIM 的 XML 模式进行验证。我不了解 CIM_SystemPackaging 的 XSD，它应该包含什么内容。

此 XML 演示了该问题（chassis 是 CIM_Chassis.xsd 等的别名）：

```
<chassis:CIM_Chassis>
  <chassis:CreationClassName>CIM_Chassis</chassis:CreationClassName>    
  <chassis:Manufacturer>Cisco</chassis:Manufacturer>
  <chassis:Model>Catalyst 6000</chassis:Model>
  <chassis:Tag>6548431</chassis:Tag>
</chassis:CIM_Chassis>

<computer:CIM_ComputerSystem>
  <computer:CreationClassName>CIM_ComputerSystem</computer:CreationClassName>
  <computer:Name>Switch1</computer:Name>
</computer:CIM_ComputerSystem>

<sp:CIM_SystemPackaging>
  <sp:Antecedent>?</sp:Antecedent>
  <sp:Dependent>?</sp:Dependent>
</sp:CIM_SystemPackaging> 
```

我应该把什么放在哪里？是？架构文档对此事保持沉默，并且网络上似乎没有 XML 示例。这不验证：

```
E [Xerces] cvc-complex-type.2.4.b: The content of element 'sp:Antecedent' is not complete. One of '{WC[##other:"http://schemas.dmtf.org/wbem/wscim/1/common",""]}' is expected. 
```

在 Schema 中，Dependent 和 Antecedent 属于 cimReference 类型，即：

```
<xs:complexType name="cimReference">
  <xs:sequence>
    <xs:any namespace="##other" maxOccurs="unbounded" processContents="lax"/>
  </xs:sequence>
  <xs:anyAttribute namespace="##any" processContents="lax"/>
</xs:complexType> 
```

所以这对我帮助不大。我想知道我是否打算将实例嵌入到先行词中：

```
<sp:CIM_SystemPackaging>
  <sp:Antecedent>
    <chassis:CIM_Chassis>
      ...etc...
    </chassis:CIM_Chassis>
  </sp:Antecedent>
  <sp:Dependent>
    <computer:CIM_ComputerSystem>
      ...etc...
    </computer:CIM_ComputerSystem>
  </sp:Dependent>
</sp:CIM_SystemPackaging> 
```

这验证正常，但似乎无法扩展。由于机箱内的每个硬件都可能有一个对象，并且它们都需要与具有相似关联类的机箱相关联，因此很快就会变得不可能。这似乎也违背了整个关联模型。是否有人对 CIM 足够熟悉来解释它应该如何工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T13:43:58.747

我最终在[DSP0230](http://dmtf.org/sites/default/files/standards/documents/DSP0230_1.1.0.pdf)中找到了以下内容：

“此定义中的 xs:any 元素 [cim:cimReference] 表示单个传输引用的结构，该结构唯一地标识被引用实体的消息可能指向的位置。此结构可以是表示完整的单个元素运输参考或一系列元素，如果运输参考需要多个元素来唯一标识一个位置。”

给定示例：

```
<AssociatedComponent xmlns:wsa="http://www.w3.org/2005/08/addressing">
  <wsa:Address>. . .</wsa:Address>
</AssociatedComponent> 
```

鉴于 CIM 旨在用于网络管理而不是静态表示，因此它是对其他地方的引用而不是其他东西是有道理的。我得出结论，我可以放入任何我喜欢的东西，并且需要在我的应用程序逻辑中处理引用。由于大多数对象都有一个 InstanceID 元素，我将使用它作为参考目标：

```
<chassis:CIM_Chassis>
  <chassis:CreationClassName>CIM_Chassis</chassis:CreationClassName>    
  <chassis:InstanceID>uniqueid1</chassis:InstanceID>
  <chassis:Manufacturer>Cisco</chassis:Manufacturer>
  <chassis:Model>Catalyst 6000</chassis:Model>
  <chassis:Tag>6548431</chassis:Tag>
</chassis:CIM_Chassis>

<computer:CIM_ComputerSystem>
  <computer:CreationClassName>CIM_ComputerSystem</computer:CreationClassName>
  <computer:InstanceID>uniqueid2</computer:InstanceID>
  <computer:Name>Switch1</computer:Name>
</computer:CIM_ComputerSystem>

<sp:CIM_SystemPackaging>
  <sp:Antecedent>
    <chassis:InstanceID>unqiueid1</chassis:InstanceID>
  </sp:Antecedent>
  <sp:Dependent>
    <computer:InstanceID>unqiueid2</computer:InstanceID>
  </sp:Dependent>
</sp:CIM_SystemPackaging> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-25T07:04:43.163

尽管您放弃了 CIM，但我觉得我应该为他人的利益回答这个问题。

(1) 关于将什么值放入关联的问题：您找到了正确答案，该值是对 CIM 实例的引用，在 DSP0230 中定义的 XML 使用 WS-Addressing 的情况下。[DSP0004](http://dmtf.org/sites/default/files/standards/documents/DSP0004_2.7.0.pdf)中描述了 CIM 的一般概念，包括参考资料。

(2) 关于使用 CIM 来静态表示 IT 元素：CIM（模型）能够做到这一点。但是，您需要将键值分配给表示的 CIM 实例（就像您所做的那样）。当您从 WBEM 服务器（例如 WMI 或其他服务器）检索 CIM 实例时，您基本上可以模拟运行时发生的情况。

(3) 您可以选择表示格式。您使用了 DSP0230 中描述的 WS-CIM，它具有其 XSD 依赖于模型的属性。这对你来说可能是好事也可能是坏事，取决于你想做什么。还有具有固定 XML 模式的 CIM-XML（DSP0201、DSP8044）（但当然比 WS-CIM 更臃肿，正因为如此）。DSP0211 中描述的最新 JSON 表示仅用于 WBEM 操作的协议表示，它不支持表示 CIM 模式。

(4) 在您对您说 CIM 很复杂的回答的评论中：如果您试图仅从 CIM 模式定义中理解 CIM 模型，那可能有其自身的困难。有一个概念叫做“管理配置文件”。它们准确定义了 CIM 模式中的类如何用于特定的管理领域。请参阅[DMTF 发布的管理配置文件](http://dmtf.org/standards/profiles)。

安迪

# windows-8 - 使用背景音频移至下一曲目

> ID：13627726
> 
> 赞同：0
> 
> 时间：2012-11-29T14:15:55.237
> 
> 标签：windows-8, windows-runtime, windows-store-apps, background-audio

我正在使用 C#/XAML 实现背景音频 Windows 8 Store App，并且我设法在后台运行音频，使用带有 BackgroundCapableMedia 的 MediaElement。根据[那篇博文](http://blogs.msdn.com/b/windowsappdev/archive/2012/08/23/media-playback-what-you-need-to-know-about-playing-media-to-make-your-app-shine-in-windows-8.aspx)，我应该可以播放播放列表。

但是，当曲目完成后，我找不到如何移动到下一个曲目。如果我使用`mediaElement.MediaEnded`，则当应用程序在后台时不会调用事件处理程序。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T15:40:47.447

基本上你必须制作自己的播放列表并自己实现逻辑。您的播放列表可以只是一个集合，您可以获取集合中的下一首曲目并播放它。我的代码中的一个例子：

```
internal ObservableCollection<StoryViewModel> Playlist { get; set; }

void me_MediaEnded(object sender, Windows.UI.Xaml.RoutedEventArgs e)
{
    Debug.WriteLine("me_MediaEnded");

    // Zero or one tracks only, so just end...
    if (Playlist.Count <= 1)
    {
        return;
    }
    else
    {
        // We have more tracks we need to play
        Playlist.RemoveAt(0);
        PlayPlaylist();
    }
}

internal void PlayPlaylist()
{
    if (Playlist.Count == 0)
        return;

    // Set the MediaControls metadata
    MediaControl.ArtistName = _svm.ProgramTitle ?? "NPR";
    MediaControl.TrackName = _svm.Title;

    // This centralized dispatcher object is updated by each page to ensure it is current
    _dispatcher.RunAsync(
        CoreDispatcherPriority.Normal, () =>
        {
            // Set the MediaElement to the audio and play
            Me.Source = _svm.Mp3Uri;
            Me.Play();
        });
} 
```

# c# - 一种循环遍历 Windows 列表框中的项目并应用自动换行的有效方法

> ID：13627730
> 
> 赞同：0
> 
> 时间：2012-11-29T14:16:09.213
> 
> 标签：c#, listbox, word-wrap, listbox-control

我有一个自动换行，它是列表框的宽度，如果超出此换行，我如何拆分填充此列表框的文本并将其推送到另一行？我需要将此应用于列表框中的每一行文本。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T14:50:17.893

我认为您想要的是[所有者绘制的 listbox](http://msdn.microsoft.com/en-us/library/ms229679%28v=vs.90%29.aspx)。

# javascript - 将元素列表克隆到警报窗口

> ID：13627732
> 
> 赞同：0
> 
> 时间：2012-11-29T14:16:12.280
> 
> 标签：javascript, jquery, html, web-applications, clone

我有一个由下面的代码创建的客户列表，每个客户都有一个指向其目的地的链接（它是一个聊天应用程序）：

```
$('#clientList').append('<a id="'+i+'" href="#null"><li><div>'+appClient +'</div></li></a>'); 
```

我想要做的是将可能的列表及其链接目的地克隆到警报窗口，有没有比使用 JQuery 更好的方法`clone()`？

# r - stat_contour 行上带有数据标签

> ID：13627735
> 
> 赞同：19
> 
> 时间：2012-11-29T14:16:14.597
> 
> 标签：r, ggplot2

`ggplot2`我想知道如何在轮廓线上获取数据标签。谢谢

```
require(grDevices) # for colours

x <- seq(-4*pi, 4*pi, len = 27)
y <- seq(-4*pi, 4*pi, len = 27)
r <- sqrt(outer(x^2, y^2, "+"))

rx <- range(x <- 10*1:nrow(volcano))
ry <- range(y <- 10*1:ncol(volcano))
ry <- ry + c(-1, 1) * (diff(rx) - diff(ry))/2

plot(
    x = 0
  , y = 0
  , type = "n"
  , xlim = rx
  , ylim = ry
  , xlab = ""
  , ylab = ""
  )

contour(
    x = x
  , y = y
  , z = volcano
  , add = TRUE
  )

library(ggplot2)
library(reshape2)
volcano3d <- melt(volcano)
names(volcano3d) <- c("x", "y", "z")

# Basic plot
v <- ggplot(volcano3d, aes(x, y, z = z))
v + stat_contour() 
```

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-11-29T14:39:56.630

使用 directlabels 包并从中挑选解决[方案](https://groups.google.com/forum/?fromgroups=#!topic/ggplot2/C2Gy-wk8HM8)

```
# Basic plot
v <- ggplot(volcano3d, aes(x, y, z = z))
library(directlabels)
v2 <- v + stat_contour(aes(colour = ..level..))
direct.label(v2, method="bottom.pieces") 
```

![在此处输入图像描述](../Images/5c60581e10a7c2814044bad1b6a2e20b.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2019-05-24T16:01:41.713

这是一个已经回答的老问题，但我做了很多等高线图，我认为使用包metR（[https://rdrr.io/github/eliocamp/metR/ ）有一种更简单、更通用的方法来做到这一点f/vignettes/Visualization-tools.Rmd](https://rdrr.io/github/eliocamp/metR/f/vignettes/Visualization-tools.Rmd)）。这个包有函数 geom_label_contour() 提供了一种简单的方法来绘制轮廓标签。还提供了很多绘制地图的功能。

```
library(ggplot2)
library(reshape2)
library(metR)
volcano3d <- melt(volcano)
colnames(volcano3d) <- c('x','y','z')

ggplot(data = volcano3d, aes(x=x,y=y,z=z)) + geom_contour() +
  geom_label_contour() 
```

# wpf - 如何拆分 WPF 控件以呈现更小的块？

> ID：13627740
> 
> 赞同：3
> 
> 时间：2012-11-29T14:16:37.013
> 
> 标签：wpf, datagrid, rendering, itemscontrol

问题是：我可以拆分我的 DataGrid 或 ItemsControl 以在更小的块中呈现控件，以便 UI 不会被阻塞 15 秒来呈现整个控件吗？

我实际上认为渲染不会阻塞 UI，因为它是在不同的线程中制作的。

* * *

我的 ItemsControl 托管了几个（最多 20 个）数据网格。其中一些可以包含多达 100 行，而一些只有 1 行短。当我填充项目的底层 ObservableCollection 时，我遇到了严重的滞后。

这是我要做什么的简要说明：

1.  在 UIThread 我选择了一些数据。
2.  此数据将发送到 VM 2.5。VM 设置 IsBusy 标志，使 ItemsControl 将模板更改为加载占位符屏幕。
3.  VM 在 BackgroundWorker 中发出多个数据库请求
4.  VM BackgroundWorker Dispatcher.Invokes DataViews 返回到 VM 的 ObservableCollection 一次一个 DataView 到目前为止一切正常：UI 负责，进度条更新等等，但是：
5.  VM 信号：IsBusy=false => ItemsControl 将其模板更改回其原始状态
6.  UI**挂起**约 15 秒以呈现 ItemsControl 中的所有 DataGrid（我可以看到 CPU 高 CPU 使用率）

这是一些代码：

XAML（我将 ItemsControl 放在 ScrollViewer 中，因为我发现这是使内容可滚动的唯一方法。）：

```
<ScrollViewer VerticalScrollBarVisibility="Auto" Grid.Column="1" Grid.Row="0" 
                      VirtualizingStackPanel.IsVirtualizing="True"
                      VirtualizingStackPanel.VirtualizationMode="Recycling">
    <ItemsControl 
                  DataContext="{Binding Source={StaticResource TerminalMaskVM}}"
                  VirtualizingStackPanel.IsVirtualizing="True"
                  VirtualizingStackPanel.VirtualizationMode="Recycling"
                  Style="{StaticResource LoadingControl}"
                  ItemsSource="{Binding Source={StaticResource TerminalMaskVM}, Path=TerminalMasks}"
                  x:Name="MaskContainer">
        <ItemsControl.ItemsPanel>
            <ItemsPanelTemplate>
                <DockPanel
                    VirtualizingStackPanel.IsVirtualizing="True"
                    VirtualizingStackPanel.VirtualizationMode="Recycling"
                    IsItemsHost="True"/>
            </ItemsPanelTemplate>
        </ItemsControl.ItemsPanel>
        <ItemsControl.ItemContainerStyle>
            <Style>
                <Setter Property="DockPanel.Dock" Value="Top"/>
            </Style>
        </ItemsControl.ItemContainerStyle>
        <ItemsControl.ItemTemplate>
            <DataTemplate>
                <Expander IsExpanded="True" Header="{Binding MaskTableName}">
                        <gui:DataGrid ItemsSource="{Binding MaskTable}"
                                      EnableColumnVirtualization="True"
                                      VirtualizingStackPanel.IsVirtualizing="True"
                                      VirtualizingStackPanel.VirtualizationMode="Recycling"
                         ...columns definitions, etc..
                         ...closing tags here 
```

我对这个问题进行了广泛的搜索，并尝试了以下方法：

1.  指定 VirtualizingStackPanel.IsVirtualizing="True" 和 VirtualizingStackPanel.VirtualizationMode="Recycling"
2.  试图将 ItemsControl 容器切换到 DockPanel
3.  将 RowHeight 和 columns Width 设置为固定值

所有这些都不会影响渲染时间。

# php - 从响应中获取值作为函数

> ID：13627741
> 
> 赞同：0
> 
> 时间：2012-11-29T14:16:41.207
> 
> 标签：php, facebook, graph

```
$args = array(
'name' => 'test',
'description' => 'xxxx',
'start_time' => 'xxxx',
'end_time' => 'xxxxx'
); 
$target_url = "https://graph.facebook.com/me/events";

$ch = curl_init();
curl_setopt($ch, CURLOPT_URL, $target_url);
curl_setopt($ch, CURLOPT_POST, 1);
curl_setopt($ch, CURLOPT_POSTFIELDS, $args);
$result = curl_exec($ch);
curl_close($ch); 
```

退货

```
 {"id":"xxxx"} 
```

我希望这个 id 在 php 中作为 $id 所以我也可以进一步使用它.. 谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T14:21:11.433

你会使用`json_decode`这个，看看这个例子：

```
$Object = json_decode($result);
$id = $Object->id;

echo $id; //return: xxxx 
```

您总是可以只使用 $Object->id 来代替将其重置为 $id 变量，但这并不重要。

`json_decode()`文档：[http ://us2.php.net/json_decode](http://us2.php.net/json_decode)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T14:21:35.473

我不确定是否理解您在说什么，但如果您要求一种方法来检索您的**id**的值，您可以随时执行以下操作

```
$_GET["id"] if GET Request was sent

$_POST["id"] if POST Request was sent 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-29T14:22:42.007

```
<?php
$obj = json_decode($result);
$id = $obj->id;
echo $id;
?> 
```

# mutt - 使用 mutt 发送带有附件的 html 电子邮件

> ID：13627742
> 
> 赞同：8
> 
> 时间：2012-11-29T14:16:49.887
> 
> 标签：mutt

我一直在使用 mutt 发送带有 pdf 附件的纯文本电子邮件，使用：

> mutt -s "主题" -a file.pdf < mybody.txt

和没有附件的 html 电子邮件使用：

> mutt -e "my_hdr Content-Type: text/html" -s "主题" < mybody.html

但我现在想发送一封带有 pdf 附件的 html 电子邮件，并且：

> mutt -e "my_hdr Content-Type: text/html" -s "主题" -a file.pdf < mybody.html

不起作用。

html 和编码的 pdf 以及它们的标题都在电子邮件正文中显示为纯文本。

有人知道怎么做吗？

干杯

加里

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2014-03-04T17:55:34.510

通过迦勒罗杰戴维斯

笨蛋版本：1.5.21

在同事的一些研究和帮助下，我能够让它工作（将 html 文件作为正文和 pdf 附件发送）。

我将 .html 文件和 .pdf 作为单独的文件。在发送之前，我在 .html 文件中进行了一些关键字替换（替换客户名称等）。

这是有效的 bash 脚本。

如果有人感兴趣，我想我也可以让它与 sendmail 一起使用。

```
#!/bin/bash
START=`date`

# --------------------------------------------------------------------------------------
# can be comma delimited list of email addresses
FROM=me@mycom.com
TO=me@mycom.com

subject="Monthly PDF report"
attachments="../src/test/resources/my.pdf ../src/test/resources/my2.pdf"

html_file="../src/main/resources/email_template.html"

# --------------------------------------------------------------------------------------
# send html with pdf attachment
# You can send additional attachments, the attachment list can be terminated with the "--"
mutt -e "set content_type=text/html" -s "$subject" $TO -a $attachments -- < $html_file

END=`date`
echo "START=$START"
echo "END=$END" 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-11-29T15:49:50.700

你真的不能这样做。Mutt 不是用来以编程方式发送消息的，它是一个交互式邮件客户端。用于发送消息的命令行标志仅作为次要附加组件存在，以这种方式不可能实现很多。

该`my_hdr`命令不应该用于设置 MIME 标头，例如`Content-Type`. 即使您不包含附件，它也不会真正起作用。第二个命令的消息将有两个`Content-Type`标题；mutt 生成的第一个声明消息是`text/plain`，而您指定的第二个。碰巧您用来检查消息的客户端正在查看您的标题。对我来说，mutt 会将该消息显示为 HTML，但 Thunderbird 会显示未渲染的文档。

当尝试结合发送 HTML 和附件时，会发生同样的事情。有多个`Content-Type`标题。第一个来自 mutt 说消息是`multipart/mixed`，第二个说它是`text/html`。在我的测试中，mutt 将再次尊重第二个标题，因此尝试将整个消息（包括附件）呈现为 HTML。Thunderbird 再次尊重第一个`Content-Type`标头，因此找到了两个部分，HTML 和附件，但 HTML 部分没有自己的`Content-Type`标头指定它是 HTML，因此它不会按原样呈现，而是原始源是显示。

通过将 HTML 和 PDF 作为附件发送，正文为空，您可以稍微接近一点：

```
mutt -s "Subject" -a mybody.html -a file.pdf -- user@example.com < /dev/null 
```

但是您可能最好使用实际上旨在以编程方式发送更复杂消息的工具。

# html - 使用 ArcGIS API 的 HTML 元素的多个属性

> ID：13627745
> 
> 赞同：0
> 
> 时间：2012-11-29T14:17:15.617
> 
> 标签：html, arcgis

我使用 ArcGIS API JavaScript 将值从 REST 服务获取到表中。

主 ID 需要在第一个`<th>`字段中，但值名称有时不同。

我有这个：

```
<th field="NR">Nummer</th> 
```

但 NR 属性值也可以是 NUMMER，

如果我改用：

```
<th field="NR">Nummer</th>
<th field="NUMMER">Nummer</th> 
```

我总是得到一个`NULL`领域，我不想要那个..

有没有办法为一个`<th>`元素分配多个属性值。

**像这样？**

```
if (strUser==="Sporen"){

    findTask = new esri.tasks.FindTask("https://gis.strukton.com/ArcGIS/rest/services/ProRail_Data/MapServer");
     var findParams = new esri.tasks.FindParameters();
    findParams.returnGeometry = true;
    findParams.layerIds = [31];
    findParams.searchFields = ["NR"];
var field1 = $('.selected').data('field1');

    findParams.outSpatialReference = map.spatialReference;

    findParams.searchText = dojo.byId("ownerName").value;
    findTask.execute(findParams,showResults); 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T14:20:45.167

我建议以 html5 方式进行操作。我会是这样的：

```
<th data-field1="NR" data-field2="NUMMBER" class="selected">Nummer</th> 
```

然后在 jquery 中，您可以通过以下方式访问：

```
$('.selected').data('field1');
$('.selected').data('field2'); 
```

或者，如果您不希望 field2 在其中，而只想获取可以执行的文本：

```
<th data-field1="NR" class="selected">Nummer</th>
var field1 = $('.selected').data('field1');
var field2 = $('.selected').text(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T16:10:07.993

使用 arcgis 看起来你可以换行：

```
findParams.searchFields = ["NR"]; 
```

至

```
findParams.searchFields = ["NR","NUMMER"]; 
```

# c++ - 如何在 C++ 中实现多维关联数组？

> ID：13627748
> 
> 赞同：3
> 
> 时间：2012-11-29T14:17:26.137
> 
> 标签：c++, system-verilog, systemc

我正在将一些 SystemVerilog 移植到 SystemC/C++ 并且遇到了多维关联数组的问题。考虑在 SV 中声明这个数组。

```
// assume typ_one, typ_two, typ_three are struct or enum types
typ_one mda[typ_two][typ_two][typ_three]; 
```

我知道一维关联数组可以使用映射，二维数组可以使用嵌套映射，我相信类似的方法可以解决多维数组，但它会变得非常混乱。

```
typ_one mda[typ_two];
map< typ_two, typ_one >;

typ_one mda[typ_two][typ_two];
map< typ_two, map< typ_two, typ_one > >;

typ_one mda[typ_two][typ_two][typ_three];
map< typ_two, map< typ_two, map< typ_three, typ_one > > >; 
```

所以我的问题是，

(1) 上述是否正确，从某种意义上说，形式的操作`mda[x][y][z]`将返回与 SV 代码相同的预期值？

(2) 有没有更好、更清洁的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T16:19:55.183

```
 template<class T1, class T2, class ... Ts>
  struct MultiDimensionalMap{
      typedef std::map<T1, typename MultiDimensionalMap<T2,Ts...>::map_type> map_type;
  };

  template<class T1, class T2>
  struct MultiDimensionalMap<T1,T2>{
      typedef std::map<T1,T2> map_type;

  }; 
```

有了这个，对于您的示例，您将使用以下内容

```
MultiDimensionalMap<type_two,type_two,type_three,type_one>::map_type m; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T15:35:17.803

您的 std::map 示例将执行您想要的操作。

不幸的是，没有更干净的方法，因为 C++ 没有像普通数组那样的关联数组的特殊语法（不幸的是，这些是原始的“原始”数组，而不是 Java/C# 中的数组对象）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-29T16:51:58.150

至少有两种方法可以实现它。

*   第一种是使用嵌套地图，正如您在问题中建议的那样：地图或地图等地图到所需的嵌套级别。

*   第二种是使用普通的线性映射，其中键是索引元组（即 3D 关联数组的 3 个索引）。

我实际上会考虑采用第二种方法，除非你有特定的理由坚持第一种。

# c++ - 如何将数组传递给函数？

> ID：13627752
> 
> 赞同：2
> 
> 时间：2012-11-29T14:17:47.617
> 
> 标签：c++, arrays, function

我正在尝试将用户定义的数组（此处定义为 matrix1）传递给函数（det），目的是计算行列式。任何帮助将不胜感激，我确信有一种简单的方法可以做到这一点，但是我使用指针/向量的各种尝试都是徒劳的！

```
#include <iostream>
#include <math.h>
#include <vector>

using namespace std;

int c, d;

int matrix1(int nS)
{
    cout << "Enter the elements of first matrix: ";
    int matrix1[10][10];
    for (c = 0 ; c < nS ; c++ )
    for (d = 0 ; d < nS ; d++ )
        cin >> matrix1[c][d];

for (c = 0 ; c < nS ; c++ )
    {   
        for (d = 0 ; d < nS ; d++ )
            cout << matrix1[c][d] << "\t";
            cout << endl;
    }
}

int det(int nS, int matrix)
{
    int det;
    int iii;
    for (iii = 0; iii < nS; iii++)
    {
        double a;
        double b;
        int c;
        for (c = 0; c<nS; c++)
        {
//          cout << (iii+c)%nS << endl;
//          cout << (nS-1) - (iii+c)%nS << endl;
        int z = (iii+c)%nS;
        cout << c << ", " << z << endl;
            a *= matrix[c][z];
            b *= matrix[c][(nS-1) - (iii+c)%nS];
        }

    det+= a-b;
    }
    cout << det << endl;
}

int main()
{
    cout << "Enter the number of rows and columns of matrix: ";
    int nS;
    cin >> nS;

    matrix1(nS);

    det(nS, matrix1);

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T14:20:28.417

您必须在 main 函数中声明该数组，以便其他函数也可以访问它。在除 main 之外的函数内声明的数组在堆栈上具有本地范围，并且在函数体执行后立即销毁。

话虽如此，您有两个同名实体，一个矩阵数组和一个函数。这不会编译器使它们的名称独一无二。像这样在 main 中声明你的矩阵数组。

```
int matrix[10][10] ; 
```

现在像这样将它传递给您的输入函数`matrix1`。

```
matrix1(matrix, nS) ; 
```

你的矩阵函数会是这样的。

```
int matrix1(int matrix[][10], int nS)
{
  //code runs here
} 
```

`det`您也可以以类似的方式将其传递给函数。最好设置行号和列号，`const`以便稍后在程序中轻松更改它们。

```
const int ROWS = 10 ;
const int COLS = 10 ; 
```

您可以在此处的类似答案中了解有关传递列号的原因以及如何将二维数组传递给函数的更多信息。

[二维数组作为函数的参数](https://stackoverflow.com/questions/12652598/2d-array-as-argument-to-function/12653518#12653518)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T14:58:41.080

在 C++ 中，通常有两种传递数组的方法。一种确实使用模板并且是 C++ 特定的，另一种不使用模板并且可以在 C 和 C++ 程序中使用。以下是模板版本的示例：

```
#include <cstddef>   // for std::size_t
#include <iostream>  // for std::cout
#include <algorithm> // for std::copy
#include <iterator>  // for std::ostream_iterator

template <std::size_t length>
static void accept_array(const int (&array)[length])
{
    std::cout << "Got array of " << length << " elements:\t";
    std::copy(array, array+length, std::ostream_iterator<int>(std::cout, ", "));
    std::cout << " and that's all.\n";
}

int main()
{
    int arr[10] = { 10, 9, 8, 7, 6, 5, 4, 3, 2, 1 };
    accept_array(arr);
} 
```

这是非模板方式的示例：

```
#include <cstddef>   // for std::size_t
#include <iostream>  // for std::cout
#include <algorithm> // for std::copy
#include <iterator>  // for std::ostream_iterator

static void accept_array(const int *array, std::size_t length)
{
    std::cout << "Got array of " << length << " elements:\t";
    std::copy(array, array+length, std::ostream_iterator<int>(std::cout, ", "));
    std::cout << " and that's all.\n";
}

int main()
{
    int arr[10] = { 10, 9, 8, 7, 6, 5, 4, 3, 2, 1 };
    accept_array(arr, 10);
} 
```

请注意，在这两种情况下，数组本身都会衰减为指针。换句话说，它在两种情况下都被传递给`accept_array()`函数。`const int *array`唯一的区别是在模板版本中，编译器会帮助您自动确定数组的大小。

但是请注意，编译器并不总是知道数组的长度（数组下标）。例如，代码可能更复杂并涉及动态分配，在这种情况下，编译器唯一知道的是它是一个指向一个或多个元素的指针，但它不知道有多少元素（如果有的话） :-))。这是一个使用模板版本不方便的示例（即使坚持不懈的程序员仍然可以通过潜在的不安全类型转换来使用它）：

```
#include <cstddef>   // for std::size_t
#include <iostream>  // for std::cout
#include <algorithm> // for std::copy
#include <iterator>  // for std::ostream_iterator

static void accept_array(const int *array, std::size_t length)
{
    std::cout << "Got array of " << length << " elements:\t";
    std::copy(array, array+length, std::ostream_iterator<int>(std::cout, ", "));
    std::cout << " and that's all.\n";
}

int main()
{
    int *a1 = new int[5];
    for (int i = 0; i < 5; ++i)
        a1[i] = i+1;
    accept_array(a1, 5); // In here, we know we have just allocated 5 elements.
                         // But compiler doesn't really know it. So calling a
                         // template version just like that won't work. We must
                         // know how the length of the array...
    delete [] a1; // Never forget to free what you have allocated :)
} 
```

因此，对于动态数组，您始终必须知道长度。但是，有时当程序员不想携带数组的长度时，他们可以引入一个用于确定数组结尾的约定（以避免访问无效的内存/元素）。例如，程序员可能会说，无论数组有多长，最后一个元素将始终为 0。并且在构建代码时考虑到了这一点（这有点危险，需要格外小心，并且可能不允许存储某些数组中的值——如果没有其他代码认为它是数组结束指示符而不是正常值，你不能在数组中有 0 值）。大多数情况下，这种方法用于指针数组，程序员同意 nil 指针是结束的指示符。但是字符串是这种方法的一个很好的例子`\0`是字符串结束指示符。例如：

```
#include <iostream>

static unsigned int my_strlen(const char *value)
{
    // How long is our string? We don't really know unless we
    // go through its characters and count them until we see '\0'.
    // WARNING: Please do not use this function in your code as it is
    //          extremely inefficient and serves an example purpose:
    unsigned int result = 0;
    while (value[result] != '\0')
        ++result;
    return result;
}

int main()
{
    const char str[] = "Hello, world!";
    std::cout << "The length of '" << str << "' is " << my_strlen(str)
              << " bytes.\nThe size of the array where the data is stored is "
              << sizeof(str)/sizeof(str[0]) << " bytes.\n";
} 
```

此外，模板版本在某些情况下可能非常有用。例如，您可以使用编译时断言来确保数组长度足够或数组不会太大。您也可以将两种方法混合在一起。这是一个完整的示例供您参考：

```
#include <cstddef>
#include <iostream>
#include <algorithm>
#include <iterator>

static void accept_array(const int *array, std::size_t length)
{
    std::cout << "Got array of " << length << " elements:\t";
    std::copy(array, array+length, std::ostream_iterator<int>(std::cout, ", "));
    std::cout << " and that's all.\n";
}

template <std::size_t length>
static void accept_array(const int (&array)[length])
{
    // Generally, we can just call a non-template version.
    // However, in this case "length" is a compile-time expression
    // and we can benefit from that. For example, by not letting users
    // compile if array length is more than 10 elements:
    static_assert(length <= 10, "Array is way too large"); // Beware: C++11 feature.
    accept_array(array, length);
}

int main()
{
    int *a1 = new int[5];
    for (int i = 0; i < 5; ++i)
        a1[i] = i+1;

    accept_array(a1, 5);
    delete [] a1;

    int a2[10] = { 10, 9, 8, 7, 6, 5, 4, 3, 2, 1 };
    accept_array(a2);
    accept_array(a2, sizeof(a2)/sizeof(a2[0]));

    // The below code would fail to compile:
    // int a3[11] = { 10, 9, 8, 7, 6, 5, 4, 3, 2, 1 };
    // accept_array(a3);
} 
```

哦，我差点忘了给你看一个矩阵的例子。它的工作原理完全相同。为了保持简短，我不会做模板版本，因为您的程序不知道编译时矩阵的长度，而是使用运行时用户的输入。以下是我将如何编写您的代码：

```
#include <cstdlib>
#include <iostream>
#include <cmath>

static void grab_matrix(int **matrix, int nS)
{
    std::cout << "Enter the elements of first matrix ("
              << nS << " by " << nS << "): " << std::flush;

    for (int c = 0; c < nS; ++c)
        for (int d = 0 ; d < nS; ++d)
            std::cin >> matrix[c][d];

    std::cout << "Thank you! You have entered the following:\n";

    for (int c = 0; c < nS; ++c) {
        for (int d = 0 ; d < nS ; d++ )
            std::cout << matrix[c][d] << "\t";
        std::cout << '\n';
    }

    std::cout << std::flush;
}

static void det(int **matrix, int nS)
{
    std::cout << "Calculations:\n" << std::flush;
    double d = 0;
    for (int i = 0; i < nS; ++i) {
        double a = 0;
        double b = 0;
        for (int c = 0; c < nS; ++c) {
            int z = (i + c) % nS;
            a *= matrix[c][z];
            b *= matrix[c][(nS - 1) - (i + c) % nS];
            std::cout << c << ", " << z << '\n';
        }
        d += a - b;
    }
    std::cout << d << std::endl;
}

int main()
{
    std::cout << "Enter the number of rows and columns of matrix: "
              << std::flush;

    int nS = 0;
    std::cin >> nS;

    if (nS <= 0) {
        std::cerr << "Sorry, that's not a good number. Try again later!\n";
        return EXIT_FAILURE;
    }

    int **matrix = new int*[nS];
    for (int i = 0; i < nS; ++i)
        matrix[i] = new int[nS];

    grab_matrix(matrix, nS);
    det(matrix, nS);

    for (int i = 0; i < nS; ++i)
        delete [] matrix[i];
    delete [] matrix;
} 
```

希望能帮助到你。祝你好运！

# javascript - Javascript将xml值与用户输入字符串进行比较

> ID：13627757
> 
> 赞同：0
> 
> 时间：2012-11-29T14:17:58.590
> 
> 标签：javascript, xml, encoding, comparison

我正在开发一个 JSP，它读取一个 XML 来呈现一个练习。用户需要填写一些字段，这些字段将与 XML 文件中的数据进行比较。现在，问题是 XML 中的值包含`&#x00E0;`à 之类的字符，但我们确实希望用户填写 à。

我已经尝试过取消转义和重新编码等等，但我仍然没有找到正确的方法来做到这一点。有人说只是写一个重新编码每个字母的函数，但是字母可以是单词的一部分，所以每个字母转换整个答案字母似乎有点矫枉过正？

有人对这个问题有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T14:33:22.243

Javascript 理解 UTF，因此编码/解码和评估相等性的客户端方法应该可以解决问题。

[这是](http://mathiasbynens.be/notes/javascript-encoding "javascript 内部 unicode")一篇关于这个问题的好文章。

这里有一些关于如何实现客户端功能来完成你需要的东西的阅读[。](https://stackoverflow.com/questions/834316/how-to-convert-large-utf-8-strings-into-ascii "将 UTF 转换为 ASCII")

要回答您的问题 - 是的，将数据发送到服务器进行转换/评估会有点过分，但也不会 - 通过javascript处理这个（整个单词转换）客户端也不会过分。

# css - 为什么链接的文本会溢出 div 框？

> ID：13627762
> 
> 赞同：3
> 
> 时间：2012-11-29T14:18:20.777
> 
> 标签：css, html, href

在chrome和safari中，链接不听width:500px；在 CSS 中。文本有，但链接没有。

[请参见此处的打印屏幕 1](https://dl.dropbox.com/u/2160796/1.0_links/Screen%20Shot%202012-11-29%20at%2013.41.13.png)

[在此处查看简单示例](https://dl.dropbox.com/u/2160796/1.0_links/Screen%20Shot%202012-11-29%20at%2014.00.49.png)

有任何想法吗？
非常感谢帮助。
谢谢艾玛
_

我也尝试了一个非常简单的测试。见代码：

```
<html>
<head>
<style type="text/css">
#main {width:100px;}
</style>
</head>

<body>
<div id="main">Content for  id "main" Goes Here Content for  id "main" Goes Here Content for  id "main" Goes Here Content for  id "main" Goes Here <a href="http://www.thesun.co.uk/sol/homepage/showbiz/4672063/kristen-stewart-flashes-bra-award-bash-jim-jams.html">http://www.thesun.co.uk/sol/homepage/showbiz/4672063/kristen-stewart-flashes-bra-award-bash-jim-jams.html</a></div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T14:21:09.097

这是因为链接通常被视为一个单词（除非其中有连字符，这就是为什么您的链接最终会在文件名处中断的原因）。

您可以做的一件事是使用`word-wrap: break-word`div 上的样式，但这不适用于所有浏览器。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-29T14:21:01.453

试试这个代码： [DEMO](http://jsfiddle.net/m8nRy/)

```
<html>
  <head>
    <style type="text/css">
      #main {width:100px;}
      #main p{word-wrap: break-word;}
      #main a{word-wrap: break-word;}
    </style>
   </head>

   <body>
     <div id="main"><p>Content for  id "main" Goes Here Content for  id "main" Goes Here Content for  id "main" Goes Here Content for  id "main" Goes Here <a href="http://www.thesun.co.uk/sol/homepage/showbiz/4672063/kristen-stewart-flashes-bra-award-bash-jim-jams.html">http://www.thesun.co.uk/sol/homepage/showbiz/4672063/kristen-stewart-flashes-bra-award-bash-jim-jams.html</a></p>
      </div>
   </body>
</html>​ 
```

# c#-4.0 - 通过评估视频源的视频流来确定视频源的位置

> ID：13627765
> 
> 赞同：1
> 
> 时间：2012-11-29T14:18:34.693
> 
> 标签：c#-4.0, kinect, kinect-sdk, ransac

步骤是什么

a) 通过评估它的传感器数据（即深度流、视频流、音频流）来获取 kinect 的位置

b）通过评估其传感器数据（即视频流）来获取常规相机的位置

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-02T01:22:29.430

也许加速度计数据可以帮助你。看看这个[http://www.youtube.com/watch?v=GWvcgZkADUU](http://www.youtube.com/watch?v=GWvcgZkADUU)

# android - Android：OnUpgarde 中的 DatabaseObjectNotClosedException 虽然已关闭

> ID：13627766
> 
> 赞同：0
> 
> 时间：2012-11-29T14:18:36.930
> 
> 标签：android, database, exception

编辑：我的数据库有 2 个表。一张表是更新后需要保存和恢复的用户数据。另一个表是常量数据，每次更新时都会从 assets 文件夹中加载。

因此，当我升级数据库时，我首先将表一保存到外部数据库。然后我用“常量”表覆盖数据库`copyDataBase();`，然后将保存的表复制回来。

在我复制数据库之前，我需要关闭它，否则数据很奇怪。我总是得到一个

```
close() was never explicitly called on database '/data/data/com.myproject/databases/mdb.sqlite' 
```

调用 openOrCreateDatabase 的位置。这很奇怪，因为我之前打电话给 close 。我能做些什么？

```
public void onUpgrade(SQLiteDatabase db,
        int oldVersion, int newVersion) {

//save db tables to other db ...

db.close(); 
copyDataBase();
db = SQLiteDatabase.openOrCreateDatabase(databaseFile, null);

//... save back to db
} 
```

谢谢欧里博尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T14:57:42.907

我强烈建议在执行时*不要*关闭打开的数据库`onUpgrade`。你正在干扰一个明智的行动，这会造成很多麻烦！

您应该考虑其他机制来确定数据库是否已升级并进行备份/复制。

*编辑*

如果你只想替换 assets 文件夹中的一张表，为什么不直接复制 sdcard 上的数据库，打开连接，将内部的表内容替换为 assets 数据库中的表内容？这可以在 onUpgrade 中完成，而无需关闭内部数据库。

您不应该仅仅为了替换/更新单个表而复制数据库文件。

# linux - 从 bash 在默认编辑器中打开文件

> ID：13627767
> 
> 赞同：9
> 
> 时间：2012-11-29T14:18:37.003
> 
> 标签：linux, macos, bash, shell, terminal

如何使用 bash 打开使用默认 GUI 编辑器生成的脚本文件？

在 OS X 上有 command `open`，但据我所知，在 linux 上不存在。什么是好的跨平台替代品？

（`open somefile.ext`在 OS X 上执行就像我在 Finder 中双击文件一样）。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-11-29T14:26:17.303

最接近这一点的是[`xdg-open`](http://linux.die.net/man/1/xdg-open)：

```
$ xdg-open somefile.ext 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-29T14:25:54.740

在 linux 上，您拥有`kde-open`特定`gnome-open`的桌面环境，并且`xdg-open`更通用，但仍必须从 DE 运行。

在 Windows 上，（显然不是`bash`但是`cmd.exe`），我相信类似的命令是`start`.

使用 bash 的跨平台代码可以是：

```
if which xdg-open &> /dev/null; then
    xdg-open $file       # linux
else
    open $file           # mac
fi 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-29T14:43:42.397

在您的 .profile 上

> 导出 EDITOR='~/bin/mate -w'

你的 bash 使用这个编辑器

# matlab - 如何绘制这两个类以便区分它们？

> ID：13627771
> 
> 赞同：0
> 
> 时间：2012-11-29T14:18:45.657
> 
> 标签：matlab, plot, octave

在下面的代码中，我如何告诉它用不同的符号绘制每个类的数据，比如 x 和 circle：

```
C_11=[3;3.5;4;4.5;5;5.5;7];
C_12=[15;16;17];
C_1=[C_11;C_12];
C_21=[0;0.5;1;2];
C_22=[8;9;10;11;12;13];
C_23=[20;25;30];
C_2=[C_21;C_22;C_23];

%to make the two classes linearly separable
mu_11=MEAN(C_11);
mu_12=MEAN(C_12);
S_11=VAR(C_11,1,1);
S_12=VAR(C_12,1,1);

x=[C_1;C_2]
y= exp(-0.5*(abs(x-mu_11))./S_11)+exp(-0.5*(abs(x-mu_12))./S_12);
x_new=ones([23 2])
plot(x,y,'r+') 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T14:32:52.113

您可以使用该`Marker`物业。

举个简单的例子：

```
x = 1:100;
y1 = sin(x);
y2 = cos(x);

plot(x, y1, 'Marker', 'x', 'Color', 'blue');
hold ('on');
plot(x, y2, 'Marker', 'o', 'Color', 'red'); 
```

[您可以在此处](http://www.mathworks.com/help/matlab/ref/line_props.html)找到其他线路属性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-29T14:32:52.973

使用以下代码：

```
plot(x1,y1,'ro',x2,y2,'bx') 
```

`ro``bx`这里表示标记（它们的颜色和类型）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-29T14:27:39.783

您可以使用不同的参数多次调用 plot 。用于`hold on`保存旧行。

# java - 将值添加到数组中并找到java中最大的一个

> ID：13627776
> 
> 赞同：0
> 
> 时间：2012-11-29T14:19:19.290
> 
> 标签：java, arrays

我试图弄清楚这个小问题：用户输入了他/她想要的尽可能多的标记，但是一旦输入小于 0 或大于 100 的标记，程序应该停止并找出输入的最大标记。

我正在考虑获取所有标记并将它们添加到数组中（然后我发现使用 ArrayList 更好，所以我改用它）。

这是我到目前为止所得到的：

```
import java.util.*;

...
Scanner input = new Scanner(System.in);
System.out.println("Enter your mark:");

int mark = input.nextInt();
List<String> list = new ArrayList<String>();
while (mark >= 0 && mark <= 100)
{
    list.add(mark);
} 
```

该行`list.add(mark);`给了我错误，说没有找到添加 int 的方法。

我是 java 新手，我不确定我是否正确理解了 arrayList。如果我错了，谁能纠正我？此外，一旦我对将值添加到数组中的问题进行排序，我将如何找到其中的最大数字？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T14:21:31.220

`mark`是一个`int`，你的列表保存`String`。你可以把它改成这个

```
List<Integer> list = new ArrayList<Integer>();
if (mark >= 0 && mark <= 100) {
    list.add(mark);
} 
```

让它工作。

但是你有一个**无限循环**！更改`while`为`if`解决此问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T14:21:17.403

首先，您要声明一个`ArrayList`字符串：-

```
List<String> list = new ArrayList<String>(); 
```

你正在向它添加一个整数。编译器会为此哭泣。声明你的`List`as `List<Integer>`。

* * *

其次，最好在每次输入内容时保持最大值，以`List`避免以后使用。`search``List`

因此，我会将您的代码修改为：-

```
 int maximum = -1;
    int mark = input.nextInt();

    List<Integer> list = new ArrayList<Integer>();
    if (mark >= 0 && mark <= 100) {

        if (maximum < mark) {
            maximum = mark;
        }

        list.add(mark);
    } 
```

现在我把它留给你把它转换`if`成一个`do-while`循环，以便继续向用户询问分数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-29T14:21:50.130

对于列表，您可以定义里面有哪些类型的项目`< >`

改变

```
List<String> list = new ArrayList<String>(); 
```

到

```
List<Integer> list = new ArrayList<Integer(); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-29T14:21:56.027

```
 List<Integer> list = new ArrayList<Integer>();
    do {
       try
       {
         Integer mark = input.nextInt(); //get your input in the loop
         list.add(mark);
       }
       catch(NumberFormatException exception) 
       {
          exception.printStackTrace() ;
       }
    }while (mark >= 0 && mark <= 100); 
```

在循环中获取您的输入，您可能需要使用 do while 循环，以便它至少运行*一次*。还假设用户是恶意的，会导致你的程序崩溃。所以使用`try catch block`. 我刚刚使用`printStackTrace`但显示了更好的错误消息。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-29T14:21:27.393

定义列表时，您将其定义为类型，然后将原始 int 添加到列表中。您需要确保这些匹配。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-29T14:39:25.503

以下是您需要做的更正：

1.您正在尝试创建整数列表，但您正在声明字符串列表。您需要在声明中使用整数（整数的包装类）。列表不能与原始类型一起使用。

```
List<Integer> list = new ArrayList<Integer>(); 
```

2.您只需输入一次并在循环的检查条件中使用它，因为如果输入标记满足条件，则循环将连续运行。您需要做的是在循环中放置一个输入语句。

```
 Scanner input = new Scanner(System.in);
    System.out.println("Enter your mark:");
    int mark = input.nextInt();
    int max=-1;
    while (mark >= 0 && mark <= 100) {
        list.add(mark);
         if (max < mark) {
        max = mark;
    }

      System.out.println("Enter your mark:");
         mark = input.nextInt();
    } 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-11-29T14:50:44.283

**要求：**用户输入任意数量的标记，但一旦输入小于 0 或大于 100 的标记，程序应停止并找出输入的最大标记。

为什么要使用数组？如果您不需要使用数组，那么此代码段将完成这项工作......

```
String instr;
int val, maxval = 0;
BufferedReader input = new BufferedReader(new InputStreamReader(System.in));
while ((instr = input.readLine())!=null) { 
    val = Integer.parseInt(instr);
    if (val < 0 || val > 100) break;
    maxval = Math.max(maxval, val);
}
input.close();
System.out.println(maxval); 
```

# jquery - 使用 jquery 但不使用画布检查 .png 图像的透明度

> ID：13627780
> 
> 赞同：0
> 
> 时间：2012-11-29T14:19:29.963
> 
> 标签：jquery, html, css

我正在开发一个应用程序，在该应用程序中放置了 div 背景，并用 .PNG 图像对其进行掩蔽。在那个 .PNG 图像中有一个透明区域，用户可以从中看到 div 的背景图像。我想知道用户是点击透明区域还是 .PNG 图像的白色区域。

我找到了这个例子： [fiddle example using canvas](http://jsfiddle.net/cwolves/GaEeG/2/)

但我想在不使用画布的情况下做到这一点。可能吗？

我只是将 png 图像附加到我的名为 drop 的 div 上。

```
var url = "url(./img/imagesapp/background.jpg?"+Math.random()+")";
$('.drop').css('background-image', url)          
var id=triangle;
var test="<img id='img"+id+"' class='shapeOfAC' src='./img/shapes/"+id+".png'/>";
$(".drop").append(test); 
```

提前致谢 ：）![我的应用程序的图像](../Images/0fecf218f9badd2912ce12342c22415e.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T14:50:23.683

我能想到的唯一真正的替代方案（没有服务器端帮助）是编写一些代码来检查 PNG 图像，以制作每个像素的透明度映射，并将其转换为仅包含 alpha 通道的长字符串，您可以通过javascript。

但是，问题在于它会包含大量数据。如果您仅将其存储为 HEX 的一部分，则长度为 2xHxW 字节。尽管您可以通过 gzip 压缩数据并在 javascript 中解压缩它来改善这一点。

# javascript - 如何在谷歌地图中用经度和纬度绘制折线

> ID：13627781
> 
> 赞同：1
> 
> 时间：2012-11-29T14:19:34.790
> 
> 标签：javascript, google-maps, google-maps-api-3

我是 Javascript 和`Google Maps API`. 我正在尝试在特定道路上绘制折线图层。我可以轻松获得经度和纬度坐标。

有谁知道该怎么做？教程也会有所帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T14:22:33.943

看看[http://openlayers.org/](http://openlayers.org/)一个 javascript 库

# mysql - SQL 时间戳 - 计算 SLA

> ID：13627782
> 
> 赞同：1
> 
> 时间：2012-11-29T14:19:39.823
> 
> 标签：mysql, sql, timestamp

我有几张票，想提供一份基于 PHP 服务水平协议的报告。

新工单可能具有具有特定时间戳的“新”状态，并且在一段时间后具有特定时间戳的“关闭”状态。

应该计算这两个时间戳之间的差异，但是只有从周一到周五（上午 8 点到下午 4.30）的工作时间应该是相关的。因此，如果工单在周五下午 4 点创建并在下周一上午 9 点关闭，则经过的时间应为 1.5 小时。

有人知道如何从数据库中获取异常结果吗？

数据库是mysql数据库，bugtracking系统是开源的BTS Mantis Bugtracker。

数据库表的一个非常简单的部分：

表错误：

身份证 | 状态 | date_created (TIMESTAMP) | last_modified (TIMESTAMP)

表历史

身份证 | bug_id（参考错误）| 状态_旧 | 新状态 | date_modified (TIMESTAMP)

我在 PHP 中的查询：获取在特定时间范围内设置为状态 30 的所有错误。对于最高 SLA 级别，此帧介于 0 到 2 小时之间。查询工作正常 - 但时间范围不关心工作时间......

选择 bug.id 作为 ID 从 mantis_bug_table 作为 bug，mantis_bug_history_table 作为历史 WHERE history.new_status = 30 和 history.bug_id = bug.id AND (history.date_modified - bug.date_submitted) < '{$timeframe_end}' AND (history.date_modified - bug.date_submitted) > '{$timeframe_start}'";

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T14:56:21.330

您需要一张显示所有工作时段的表格，例如：

```
create table WorkingPeriod (
    dtPeriodStart datetime primary key,
    dtPeriodEnd datetime,
    unique(dtPeriodEnd, dtPeriodStart)
) 
```

您必须确保工作期间不重叠。

然后你可以计算工作时间。它将是整个周期的数量，加上开始和结束的部分周期。此示例应该适用于 Microsoft T-SQL，但您可能必须对 MySQL 使用 TIMESTAMPDIFF 或进行其他简单更改。

```
create function dbo.GetWorkingTimeSeconds(@dtStart, @dtEnd)
returns int 
as
begin
   declare @a int
   -- Add up all the WorkingPeriods between @dtStart and @dtEnd
   -- SUM adds them all up
   select @a = SUM(
       -- Get the number of seconds between the start of the period and the end
       datediff(
           -- We want the difference in seconds
           second,

           -- BUT if @dtStart is after the start of the period, 
           --  use @dtStart instead - so we don't count the part
           -- of the period before @dtStart
           case 
           when @dtStart < dtPeriodStart then dtPeriodStart
           else @dtStart 
           end,

           -- If @dtEnd is BEFORE the end of the period, 
           -- use @dtEnd instead, so we don't count the part of the period after @dtEnd
           case
           when @dtEnd > dtPeriodEnd then dtPeriodEnd
           else @dtEnd
           end
       )
    )
    from
        WorkingPeriods 
        -- Only include periods which overlap our time range
        where dtPeriodEnd >= @dtStart and dtPeriodStart < @dtEnd

    -- return the value
    Return @a
  end 
```

为什么要用桌子？

*   您可以考虑公共假期，但不包括它们
*   如果未来的工作日发生变化，表格可以针对未来的日期进行更改，而过去的日期保持不变，因此过去事件的工作时间计算继续正确。
*   您甚至可以排除午餐时间、周末休息半天或其他任何您想要的时间。

# java - 如何检查 JScrollPane 中的 JComponent 是否对用户可见？

> ID：13627783
> 
> 赞同：7
> 
> 时间：2012-11-29T14:19:43.770
> 
> 标签：java, swing, jscrollpane, visibility, jcomponent

想象一下，您添加了一个`JScrollPane`和许多`JLabel`s 或任何其他`JComponent`s。

**您将如何检查某个组件是否对用户可见/部分可见/不可见？**（滚动）

我试过谷歌，但找不到简单的解决方案。我是否缺少一些现有的方法，或者我们必须处理坐标和矩形比较？

UPD：以下不适用于我的情况。它似乎与 JLabel.setVisible(true/false) 有关，但不在 JScrollPane 内

```
JLabel.isVisible(); 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-11-29T14:32:39.803

看看 JComponent java doc：

```
Rectangle r = child.getVisibleRect();
if (r.getSize().equals(child.getSize())) {
   // fully visible
} else if (r.isEmpty()) {
   // not visible
} else {
  // partly visible
} 
```

**编辑**

将不可见的条件更改为使用 Rectangle api - 感谢@mKorbel 提醒我:-)

# facebook-javascript-sdk - Facebook Javascript API 默认图片错误 url

> ID：13627791
> 
> 赞同：0
> 
> 时间：2012-11-29T14:20:19.930
> 
> 标签：facebook-javascript-sdk

运行 Javascript Facebook API，它会在默认个人资料图片上显示错误的 url

```
<fb:profile-pic uid="loggedinuser" linked="true" size="thumb" facebook-logo="false"></fb:profile-pic> 
```

这是初始化脚本。

```
<script src="//connect.facebook.net/en_US/all.js"></script>
<script language="javascript" type="text/javascript">
    FB.init({
        appId: '000000000000000000',
        status: true, 
        cookie: true, 
        xfbml: true
    });    

    // Event: login process
    function loginUser() {
    }                   
</script> 
```

是个烦人的问题，默认图片有一个坏的URL [http://static.ak.fbcdn.netrsrc.php/v1/yi/r/odA9sNLrE86.jpg](http://static.ak.fbcdn.netrsrc.php/v1/yi/r/odA9sNLrE86.jpg)

...缺少一个斜线：**static.ak.fbcdn.net/rsrc ...**

怎么可能？Facebook发布错误？

# javascript - 无法将文本复制到剪贴板

> ID：13627799
> 
> 赞同：0
> 
> 时间：2012-11-29T14:20:38.567
> 
> 标签：javascript, jquery, html

我正在使用它来将文本复制到剪贴板..

```
http://www.steamdev.com/zclip/ 
```

我试过这样，但我无法将复制的文本放入剪贴板..

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>

<script type="text/javascript" src="js/jquery-1.8.3.js"></script>
<script type="text/javascript" src="js/jquery.zclip.js"></script>

<script>

    $(document).ready(function(){

        $('textarea#showthis').zclip({
            path:'js/ZeroClipboard.swf',
            copy:function(){return $('#showthis').val();}
        });

    });

    function myfunc2()
    {
         var selectedobj=document.getElementById('showthis');

        if(selectedobj.className=='hide')
        {  //check if classname is hide 
            selectedobj.style.display = "block";
            selectedobj.readOnly=true;
            selectedobj.className ='show';
         } else {
            selectedobj.style.display = "none";
            selectedobj.className ='hide';
         }
    }
</script>
 </head>

 <body>
   <label onclick="myfunc2()">Click here</label>
   <textarea id="showthis" style="display:none" class="hide"  readonly>hi, how are you?</textarea>
 </body>
</html> 
```

请告诉我出了什么问题！（我不知道 javascript 和 jquery 的东西！）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T14:31:12.210

```
 function myfunc2() {
   if($('#showthis').css('display') == 'none'){
    $('#showthis').show().removeClass('hide').addClass('show');
  }else{
    $('#showthis').hide().removeClass('show').addClass('hide');
  }
 } 
```

# vector - VHDL 表达式不是恒定的

> ID：13627809
> 
> 赞同：0
> 
> 时间：2012-11-29T14:21:12.317
> 
> 标签：vector, compiler-errors, vhdl

我正在 quartus II 上为 CYCLONE III EP3C25 FPGA 编写 VHDL 程序，但遇到了问题。

这是我的程序的重要部分：

```
odata : out std_logic_vector(15 downto 0);

signal buf_data : std_logic_vector(255 downto 0);

signal nb_word : integer :=0;

Process(clk,RST)
begin
    if(RST='0') then
        nb_word<=0;
    elsif(clk'event and clk='0') then
        if(Current_state_w=s2) then
            if(nb_word<=X"F0") then
                nb_word<=nb_word+16;
            else
                nb_word<=0;
            end if;
        end if;
    end if;
end process;

Process(clk,RST)

begin
    if(RST='0') then
        odata<=(OTHERS=>'0');
    elsif(clk'event and clk='0') then
            odata<=buf_data(nb_word+15 downto nb_word);
    end if;
end process; 
```

这段代码编译得很好，但没有做我想做的事，然后我只想改变：

```
odata<=buf_data(nb_word+15 downto nb_word); 
```

在

```
odata<=buf_data(nb_word downto nb_word-15); 
```

我将 nb_word 的初始化和重置值更改为 15 而不是 0。

问题是，当我这样做并尝试编译时，我得到了这个错误：

```
Error (10779): VHDL error at VL_control.vhd(99): expression is not constant 
```

该行对应于 odata 行的更改。

我真的不明白为什么我会收到这个错误。为什么可以做加法而不是减法？我还尝试定义另一个信号并在像这样寻址缓冲区之前对信号进行减法：

```
nb_word1 := (nb_word-15);
odata<=buf_data(nb_word downto nb_word1); 
```

但我仍然得到同样的错误。这是哪里来的？？？？？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T15:06:26.717

您应该限制`nb_word`在一个整数范围内，这样合成工具就可以确定 的值`nb_word - 15`不能为负数。

另外，为什么要将整数与位字符串文字进行比较？为什么不直接说`if nb_word < 15`？

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-29T15:03:44.130

使用正确的测试可能更容易

```
if nb_word < X"F0" then 
```

代替

```
if(nb_word<=X"F0") then 
```

并单独留下“odata”过程。

但是，我不确定为什么您的解决方案无法编译，只要您在所需的所有三个地方都更改了 nb_word 的初始值（您只提到了两个）。

布尔表达式周围无意义的括号的流行从何而来？好像有很多关于...

# objective-c - 目标 C，无法创建 XML 发布操作

> ID：13627810
> 
> 赞同：0
> 
> 时间：2012-11-29T14:21:12.867
> 
> 标签：objective-c, ios, xml, post, soap

我正在尝试在 Objective-C（用于 iOS 应用程序）中向 Biztalk 服务器发送一个 XML 文件

我找到了以下[教程](http://www.robertkuzma.com/2011/07/making-a-post-in-objective-c-xcode-to-sharepoint-webservice-requiring-windows-ntlm-authenticaton-for-iphone-or-ipad/)并使用了它。代码编译成功，当我尝试发布时，我没有收到任何关于发布的错误消息（通过 `didFailWithError` 函数）。但是当我检查 Biztalk 时，我注意到数据没有被传输......

我发布到的链接是 https 链接（而不是 http），这可能是问题吗？

我错过了什么吗？

谢谢！

编辑：这是发出 SOAP 请求后按顺序调用的函数：

```
-(void)connection:(NSURLConnection *)connection willSendRequestForAuthenticationChallenge:(NSURLAuthenticationChallenge *)challenge
-(void)connection:(NSURLConnection *)connection didReceiveResponse:(NSURLResponse *)response
-(void)connection:(NSURLConnection *) connection didReceiveData:(NSData *)data
-(void)connectionDidFinishLoading:(NSURLConnection *)connection
-(void)parser:(NSXMLParser *)parser didStartElement:(NSString *)elementName namespaceURI:(NSString *)namespaceURI qualifiedName:(NSString *)qName attributes:(NSDictionary *)attributeDict
-(void)parser:(NSXMLParser *)parser foundCharacters:(NSString *)string
-(void)parser:(NSXMLParser *)parser didStartElement:(NSString *)elementName namespaceURI:(NSString *)namespaceURI qualifiedName:(NSString *)qName attributes:(NSDictionary *)attributeDict
-(void)parser:(NSXMLParser *)parser foundCharacters:(NSString *)string
-(void)parser:(NSXMLParser *)parser didStartElement:(NSString *)elementName namespaceURI:(NSString *)namespaceURI qualifiedName:(NSString *)qName attributes:(NSDictionary *)attributeDict
-(void)parser:(NSXMLParser *)parser foundCharacters:(NSString *)string
-(void)parser:(NSXMLParser *)parser didEndElement:(NSString *)elementName namespaceURI:(NSString *)namespaceURI qualifiedName:(NSString *)qName
-(void)parser:(NSXMLParser *)parser foundCharacters:(NSString *)string
-(void)parser:(NSXMLParser *)parser didEndElement:(NSString *)elementName namespaceURI:(NSString *)namespaceURI qualifiedName:(NSString *)qName
-(void)parser:(NSXMLParser *)parser foundCharacters:(NSString *)string
-(void)parser:(NSXMLParser *)parser didStartElement:(NSString *)elementName namespaceURI:(NSString *)namespaceURI qualifiedName:(NSString *)qName attributes:(NSDictionary *)attributeDict
-(void)parser:(NSXMLParser *)parser foundCharacters:(NSString *)string 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T14:38:26.813

你可以使用[https://github.com/RestKit/RestKit](https://github.com/RestKit/RestKit)

是一个很好的 REST Actions 框架

# javascript - IE7中未显示的css按钮内的绝对定位跨度

> ID：13627814
> 
> 赞同：1
> 
> 时间：2012-11-29T14:21:23.050
> 
> 标签：javascript, html, css, internet-explorer-7, prototypejs

我在让我的 3 个点的 js 动画在 IE7 中工作时遇到问题。这似乎与由于位置问题或 z-index 问题而导致 3 个点未显示的跨度问题有关。我已经尝试过弄乱 z-index 并在我的跨度周围添加一个 div，但在这种情况下它们似乎没有帮助。

行为不端的跨度是：

```
.dots {
  position: absolute;
  top: -3px;
  font-size: 40px; 
  line-height: 10px;   
} 
```

它在里面：

```
.button {
  font-family: 'PT Sans Narrow', sans-serif;
  font-size: 16px;
  display: inline-block;
  background-clip: padding-box;
  border: 1px solid #6F4D38;
  font-weight: bold;
  text-transform: uppercase;
  margin: 9px 9px 10px 9px;
  padding: 3px 8px 3px 10px;
  border-radius: 22px;
  position: relative;
  -webkit-box-shadow: inset 0px 1px 4px #fff, 0 1px 0px 0px black;-moz-box-shadow:    inset 0px 1px 4px #fff, 0 1px 0px 0px #000;box-shadow:         inset 0px 1px 4px #fff, 0 1px 0px 0px black;
  letter-spacing: 3px;
  z-index: 1;
  overflow: none;
} 
```

我正在处理的代码位于[http://jsfiddle.net/gYjEH/1/](http://jsfiddle.net/gYjEH/1/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T19:07:49.397

[http://jsfiddle.net/gYjEH/6/show/](http://jsfiddle.net/gYjEH/6/show/)

要在 IE7`line-height`中显示点`span`应该等于它的`font-size`，否则您只会看到跨度的顶部空白部分（点位于最底部）。

# c# - 关于 DbSet 和 DbContext

> ID：13627829
> 
> 赞同：48
> 
> 时间：2012-11-29T14:22:03.987
> 
> 标签：c#, entity-framework

我看到一段混合在一起的`DbSet`代码`DbContext`。我不擅长实体框架。我以为它们是不同的东西。

有人可以给我一点解释吗？

```
public class testContext : DbContext
{
    public testContext();

    public string IPAddress { get; set; }
    public DbSet<WSettings> Settings { get; set; }
    public string UserName { get; set; }

    public override int SaveChanges();
} 
```

* * *

## 回答 #1

> 赞同：88
> 
> 时间：2012-11-29T14:25:19.620

直观地说，DbContext 对应于您的数据库（或数据库中的表和视图的集合），而 DbSet 对应于数据库中的表或视图。因此，您将得到两者的结合是完全合理的！

您将使用 DbContext 对象来访问表和视图（将由 DbSet 表示），并且您将使用 DbSet 来访问、创建、更新、删除和修改表数据。

如果您的数据库中有 10 个表并且您的应用程序使用其中的 5 个（让我们称它们为 Table1 - Table 5），那么使用 MyAppContext 对象访问它是有意义的，其中 MyAppContext 类是这样定义的：

```
public class MyAppContext : DbContext
{
    public MyAppContext () : ;

    public DbSet<Table1> Table1 { get; set; }
    public DbSet<Table2> Table2 { get; set; }
    public DbSet<Table3> Table3 { get; set; }
    public DbSet<Table4> Table4 { get; set; }
    public DbSet<Table5> Table5 { get; set; }
} 
```

请注意，例如，标识符 Table1 既用作类型的名称，也用作定义的上下文类型中的属性名称。你在上面看到的很典型。下面给出了对应于表模式的类的示例：

```
public class Table1 
{
   public int Id {get; set;}
   public string AStringField {get; set;}
   //etc.
} 
```

在这里查看更多信息：[http ://entityframeworktutorial.net/](http://entityframeworktutorial.net/)

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2012-11-29T14:23:59.380

`DbContext`一般表示一个数据库连接和一组表。`DbSet`用于表示一个表。

您的代码示例不符合预期的模式。首先，它是不完整的。此外，有些属性确实不属于。

这种模式比较典型：

```
class User
{
   public string IPAddress { get; set; }
   public ICollection<Settings> Settings { get; set; }
   public string UserName { get; set; }
}

class MyContext : DbContext
{
   public DbSet<User> Users { get; set; }
   public DbSet<Settings> Settings { get; set; }
} 
```

# c# - 在数据表中查找信息

> ID：13627836
> 
> 赞同：0
> 
> 时间：2012-11-29T14:22:25.140
> 
> 标签：c#, asp.net, datatable

我有一个`DataTable`. 我需要从`DataTable`. 例如，假设`DataTable`有多个列，我想检索其中两个，例如 Id、Name

```
var item = new ListItem("k");
            item.Selected = true;
            this.formatOfReport.Items.Add(item);
            item = new ListItem("n");
            this.formatOfReport.Items.Add(item); 
```

我想替换名称以替换 k 和 n 值，数据在第 1 行和第 2 行，例如 steve 和 mike 我想要 steve = k 和 mike =n，但我不想做硬代码参考如下

```
var item = new ListItem(dt.Rows[0][1].ToString(), dt.Rows[0][1].ToString());
            item.Selected = true;
            this.formatOfReport.Items.Add(item);
            item = new ListItem(dt.Rows[1][1].ToString(), dt.Rows[1][1].ToString());
            this.formatOfReport.Items.Add(item); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T14:32:13.890

你有两个选择：

```
// DataSource approach
formatOfReport.DataTextField = "Name";
formatOfReport.DataValueField = "Id";
formatOfReport.DataSource = dt;
formatOfReport.DataBind();

// programmatically
foreach (DataRow row in dt.Rows)
{
    int ID = row.Field<int>("Id");
    string name = row.Field<string>("Name");
    var item = new ListItem(name, ID.ToString());
    formatOfReport.Items.Add(item);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T15:16:23.443

*如果我理解正确，*您需要**select** `Id and Name columns` and `filter rows using couple of given Ids` **from your datatable**。

```
int[] idList = new int[] { 11, 12 }; //Your Required Ids 

var results = (from r in dt.AsEnumerable()
               where idList.Contains(r.Field<int>("Id"))
               select new {Id = r.Field<int>("Id"),
                           Name = r.Field<string>("Name")}).ToList();

ddl.DataSource = results;
ddl.DataTextField = "Id";
ddl.DataValueField = "Name";
ddl.DataBind(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-29T14:35:31.573

它看起来像你想要绑定 DropDownList，你可以这样做

```
 DropDownList1.DataSource = dt;
  DropDownList1.DataValueField="Id";
  DropDownList1.DataTextField="Name";
  DropDownList1.SelectedValue=//your Id
  DropDownList1.DataBind(); 
```

# php - 在 HTML 中查找链接

> ID：13627843
> 
> 赞同：0
> 
> 时间：2012-11-29T14:22:51.537
> 
> 标签：php, regex, web-scraping

> **可能重复：**
> [如何使用 PHP 解析和处理 HTML？](https://stackoverflow.com/questions/3577641/how-to-parse-and-process-html-with-php)

我正在编写一个脚本，该脚本应该废弃页面的 html 并在页面上找到“联系”或“联系我们”网址。所以我拥有的是 url，我能够使用 curl 获取页面的 html。

现在我需要做的就是找到联系链接并尝试提取电子邮件地址和电话号码。

我的问题是我如何喜欢联系网址？我应该寻找什么？也许链接文本应该包含单词contact，或者url应该包含单词contact？正则表达式会是什么样子？

其次，我认为一旦我有了联系页面，我应该能够在线找到一个正则表达式，它将提取电子邮件地址和电话号码。所以我只需要找到联系链接。我正在抓取的这些页面是博客。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T15:09:23.883

要查找联系页面 URL，我认为您最好使用 XML 解析器来“扫描”DOM（例如：标签）。

如果您了解 jQuery，则可以使用[phpQuery](http://code.google.com/p/phpquery/)，这是一个模仿 jQuery 选择器的 PHP HTML 解析器。

基本上，使用 Regex 解析 HTML 通常是一个坏主意，请参阅[Parsing Html The Cthulhu Way](http://www.codinghorror.com/blog/2009/11/parsing-html-the-cthulhu-way.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T15:34:48.903

您可以卷曲该联系页面，然后只需 preg_match $result = curl_exec($resource)

```
preg_match_all("/[\._a-zA-Z0-9-]+@[\._a-zA-Z0-9-]+/i", $result, $matches);
  print_r($matches[0]); 
```

# css - 如何在 CSS 中使字体清晰？

> ID：13627848
> 
> 赞同：19
> 
> 时间：2012-11-29T14:23:01.537
> 
> 标签：css

大家好，我正在尝试在 CSS 中使用像 photoshop 这样的锐利属性，但我该怎么做？

这是我的CSS

```
#login_text
{
 position:absolute;
 top:10px;
 left:18px;
 font-size:13pt;
 font-weight:bold;
 font-family:Arial;

} 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-11-29T14:37:30.640

除了提到的 CSS3`text-rendering`属性 AMK 之外，还有一个针对抗锯齿的 Webkit (Chrome) 特定 hack：（`-webkit-font-smoothing: antialiased;`我相信默认值是`subpixel-antialiased`）很好用，因为 Webkit Webfont 渲染在 Windows 机器上可能不太理想。 [更多信息可以在这里找到](http://maxvoltar.com/archive/-webkit-font-smoothing)。

还有一个旧的提议的`font-smooth`CSS3 属性（[见这里](http://www.w3.org/TR/WD-font/#font-smooth-prop)），但据我所知，它没有实现，也没有做任何事情（至少我看不到）。

可悲的现实是，您不会在 Web 上获得 Photoshop 质量的字体渲染，尤其是在 Windows 机器上。你可以通过选择好的网络字体和选择自然缩放的字体大小来弥补这一点，但你能做的只有这么多。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2014-12-04T02:11:35.713

Firefox 25 添加了一个新的 Mac-OS-only 非标准属性**-moz-osx-font-smoothing**等效于 WebKit 的 -webkit-font-smoothing。

# 元素 {

```
-webkit-font-smoothing: antialiased;
-moz-osx-font-smoothing: grayscale; 
```

}

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-29T14:25:20.500

虽然没有“尖锐”的价值，但我认为 CSS3[`text-rendering`](https://developer.mozilla.org/en-US/docs/CSS/text-rendering)属性是最好的选择。这种效果在较小的字体大小上最为明显，对大字体没有太大影响。

请注意，对此的支持非常有限，但据我所知，这是唯一可用的方法。

您的另一个选择（如果您使用自定义字体）是简单地获得更高质量的矢量。

* * *

## 回答 #4

> 赞同：-4
> 
> 时间：2015-07-24T05:33:15.827

看这个例子。Henrique Baldy 解释了锐化的可能方法是什么[https://www.linkedin.com/grp/post/2071438-268918276](https://www.linkedin.com/grp/post/2071438-268918276)

# c++ - 处理 C++ 目标中的 ANTLR3 错误

> ID：13627850
> 
> 赞同：1
> 
> 时间：2012-11-29T14:23:04.327
> 
> 标签：c++, antlr

如何在我的语法中捕获 ANTLR3 异常？我发现了很多 Java 示例，但我无法让 C++ 工作。
例如，a 在语法中有以下行：

`func_expression : 'lengthof' '(' longid ')';`

';'时如何处理错误 不见了？
我尝试`catch`在几乎所有地方添加试图捕获 ANTLRexceptions，如此处[所述](http://www.antlr.org/wiki/display/ANTLR3/Custom+Syntax+Error+Recovery)。
我还尝试按照[此处](http://www.antlr.org/wiki/display/ANTLR3/Error+reporting+and+recovery)`displayRecognitionError()`所述进行覆盖。

也许我只是做错了。我想为 C++ 目标获取一个简单的代码示例。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-27T09:39:08.747

解决方案是阴影

`displayRecognitionError(ANTLR_UINT8**, Parser::ExceptionBaseType*)`

parser::context 部分中的函数（它不是虚拟的）。

# asp.net-mvc-3 - 本地化-ASP-NET-MVC3

> ID：13627853
> 
> 赞同：1
> 
> 时间：2012-11-29T14:23:14.023
> 
> 标签：asp.net-mvc-3, globalization, cultureinfo, access-modifiers

我正在创建一个本地化应用程序 ASP NET MVC3，但问题是当我在根文件夹中添加 Resource.resx 文件时，访问修饰符被禁用，因此帮助启用访问修饰符这是我的 LanguageResources.Designer.cs 文件的代码

```
namespace Resources {
using System;      [global::System.CodeDom.Compiler.GeneratedCodeAttribute("Microsoft.VisualStudio.Web.Application.StronglyTypedResourceProxyBuilder", "10.0.0.0")]
        [global::System.Diagnostics.DebuggerNonUserCodeAttribute()]
        [global::System.Runtime.CompilerServices.CompilerGeneratedAttribute()]
        internal class LanguageResources {

            private static global::System.Resources.ResourceManager resourceMan;

            private static global::System.Globalization.CultureInfo resourceCulture;

            [global::System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1811:AvoidUncalledPrivateCode")]
            internal LanguageResources() {
            }

            /// <summary>
            ///   Returns the cached ResourceManager instance used by this class.
            /// </summary>
            [global::System.ComponentModel.EditorBrowsableAttribute(global::System.ComponentModel.EditorBrowsableState.Advanced)]
            internal static global::System.Resources.ResourceManager ResourceManager {
                get {
                    if (object.ReferenceEquals(resourceMan, null)) {
                        global::System.Resources.ResourceManager temp = new global::System.Resources.ResourceManager("Resources.LanguageResources", global::System.Reflection.Assembly.Load("App_GlobalResources"));
                        resourceMan = temp;
                    }
                    return resourceMan;
                }
            }

            [global::System.ComponentModel.EditorBrowsableAttribute(global::System.ComponentModel.EditorBrowsableState.Advanced)]
            internal static global::System.Globalization.CultureInfo Culture {
                get {
                    return resourceCulture;
                }
                set {
                    resourceCulture = value;
                }
            }

            /// <summary>
            ///   Looks up a localized string similar to Hii this my site.
            /// </summary>
            internal static string welcome {
                get {
                    return ResourceManager.GetString("welcome", resourceCulture);
                }
            }
        }
    } 
```

我还在 web.config 文件中添加了全球化

```
<system.web>
<globalization uiCulture="auto" culture="auto"/>
</system.web> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T14:45:41.000

我建议您将资源文件放在单独的类库中，并且您必须将`Custom Tool`资源文件的类型设置为`PublicResXFileCodeGenerator`.

有关更多信息，请参阅此[帖子](http://odetocode.com/blogs/scott/archive/2009/07/16/resource-files-and-asp-net-mvc-projects.aspx)。

# php - UDK Scaleform 4 AS3 跨域 URLRequest 可能吗？

> ID：13627859
> 
> 赞同：3
> 
> 时间：2012-11-29T14:23:22.423
> 
> 标签：php, actionscript-3, http, unreal-development-kit, scaleform

我想通过 HTTP 请求使用在线 Mysql 数据库、Scaleform 4 (AS3) 和 PHP 向我的网络服务器发布并获取我的 UDKGame 的高分。不幸的是，我认为这可能是不可能的，考虑到这个文件： http: [//gameware.autodesk.com/documents/gfx_4.0_flash_support.pdf](http://gameware.autodesk.com/documents/gfx_4.0_flash_support.pdf)。

我尝试从我的 GFx 电影播放器​​发送 URLRequest，但它似乎不起作用。这是我在第 1 帧中用于 GFx 电影播放器​​的 AS3 代码：

```
getScore();

function getScore():void {
//var url:String = "http://myserver.com/getScore.php";
    var request:URLRequest = new URLRequest(url);
    var requestVars:URLVariables = new URLVariables();
    requestVars.foo = "bar";
    request.data = requestVars;
    //request.method = URLRequestMethod.POST;
    //Security.allowDomain("myserver.com"); 
    //var context:LoaderContext = new LoaderContext();
    //context.securityDomain = SecurityDomain.currentDomain

    var urlLoader:URLLoader = new URLLoader();
    urlLoader = new URLLoader();
    urlLoader.dataFormat = URLLoaderDataFormat.TEXT;
    urlLoader.addEventListener(Event.COMPLETE, loaderCompleteHandler, false, 0, true);
    urlLoader.load(request);

    }

function loaderCompleteHandler(e:Event):void {
    trace(e.target.data);
    Object(this).response.text= "response:"+e.target.data;

} 
```

有什么方法可以在不编写 .dll 或使用手动 TCP 连接到我的网络服务器的情况下实现我的目标？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T21:31:50.043

不幸的是，UDK (4.0.16) 附带的 Scaleform 没有内置任何网络支持。您必须让 UDK 通过 dll 绑定或其他方式解决该问题。Scaleform 4.2 添加了网络支持，但该版本的 Scaleform 尚未完全集成到 UDK 中。不过，它正在整合过程中，所以希望我们很快就能看到它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-08-04T09:00:31.873

确实 SF4.0 不支持这一点。SF4.2**可能**会，而且它只对 UE3 被许可人提供，通过 Epic 的 Perforce 库。

你可以在虚幻脚本中做到这一点。然而，使用 dll 或 TCP 连接有点矫枉过正。使用[**HttpRequestInterface**](http://uncodex.com/2012-03/engine/httprequestinterface.html)。这是一个直接来自随 UDK 提供的源示例的示例。它非常简单，您可以将其缩减到只用几行代码调用您的 Web 服务所必需的严格要求。

```
/**
 * Simple function to illustrate the use of the HttpRequest system.
 */
exec function TestHttp(string Verb, string Payload, string URL, optional bool bSendParallelRequest)
{
    local HttpRequestInterface R;

    // create the request instance using the factory (which handles
    // determining the proper type to create based on config).
    R = class'HttpFactory'.static.CreateRequest();
    // always set a delegate instance to handle the response.
    R.OnProcessRequestComplete = OnRequestComplete;
    `log("Created request");
    // you can make many requests from one request object.
    R.SetURL(URL);
    // Default verb is GET
    if (Len(Verb) > 0)
    {
        R.SetVerb(Verb);
    }
    else
    {
        `log("No Verb given, using the defaults.");
    }
    // Default Payload is empty
    if (Len(Payload) > 0)
    {
        R.SetContentAsString(Payload);
    }
    else
    {
        `log("No payload given.");
    }
    `log("Creating request for URL:"@URL);

    // there is currently no way to distinguish keys that are empty from keys that aren't there.
    `log("Key1 ="@R.GetURLParameter("Key1"));
    `log("Key2 ="@R.GetURLParameter("Key2"));
    `log("Key3NoValue ="@R.GetURLParameter("Key3NoValue"));
    `log("NonexistentKey ="@R.GetURLParameter("NonexistentKey"));
    // A header will not necessarily be present if you don't set one. Platform implementations
    // may add things like Content-Length when you send the request, but won't necessarily
    // be available in the Header.
    `log("NonExistentHeader ="@R.GetHeader("NonExistentHeader"));
    `log("CustomHeaderName ="@R.GetHeader("CustomHeaderName"));
    `log("ContentType ="@R.GetContentType());
    `log("ContentLength ="@R.GetContentLength());
    `log("URL ="@R.GetURL());
    `log("Verb ="@R.GetVerb());

    // multiple ProcessRequest calls can be made from the same instance if desired.
    if (!R.ProcessRequest())
    {
        `log("ProcessRequest failed. Unsuppress DevHttpRequest to see more details.");
    }
    else
    {
        `log("Request sent");
    }
    // send off a parallel request for testing.
    if (bSendParallelRequest)
    {
        if (!class'HttpFactory'.static.CreateRequest()
            .SetURL("http://www.epicgames.com")
            .SetVerb("GET")
            .SetHeader("Test", "Value")
            .SetProcessRequestCompleteDelegate(OnRequestComplete)
            .ProcessRequest())
        {
            `log("ProcessRequest for parallel request failed. Unsuppress DevHttpRequest to see more details.");
        }
        else
        {
            `log("Parallel Request sent");
        }
    }
}

/** Delegate to use for HttpResponses. */
function OnRequestComplete(HttpRequestInterface OriginalRequest, HttpResponseInterface Response, bool bDidSucceed)
{
    local array<String> Headers;
    local String Header;
    local String Payload;
    local int PayloadIndex;

    `log("Got response!!!!!!! Succeeded="@bDidSucceed);
    `log("URL="@OriginalRequest.GetURL());
    // if we didn't succeed, we can't really trust the payload, so you should always really check this.
    if (Response != None)
    {
        `log("ResponseURL="@Response.GetURL());
        `log("Response Code="@Response.GetResponseCode());
        Headers = Response.GetHeaders();
        foreach Headers(Header)
        {
            `log("Header:"@Header);
        }
        // GetContentAsString will make a copy of the payload to add the NULL terminator,
        // then copy it again to convert it to TCHAR, so this could be fairly inefficient.
        // This call also assumes the payload is UTF8 right now, as truly determining the encoding
        // is content-type dependent.
        // You also can't trust the content-length as you don't always get one. You should instead
        // always trust the length of the content payload you receive.
        Payload = Response.GetContentAsString();
        if (Len(Payload) > 1024)
        {
            PayloadIndex = 0;
            `log("Payload:");
            while (PayloadIndex < Len(Payload))
            {
                `log("    "@Mid(Payload, PayloadIndex, 1024));
                PayloadIndex = PayloadIndex + 1024;
            }
        }
        else
        {
            `log("Payload:"@Payload);
        }
    }
} 
```

# svn - SVN问题：提交需要多长时间才能进行更改

> ID：13627862
> 
> 赞同：0
> 
> 时间：2012-11-29T14:23:25.397
> 
> 标签：svn

我正在开发一些 Web 应用程序，我使用 SVN 将本地代码更改提交到服务器。我已经提交了一些代码，但没有注意到任何变化。需要多长时间才能进行更改？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T14:26:18.497

也许问题是由于您的本地时间与 SVN 服务器时间不同。
您可以检查您的计算机和服务器之间的时间。
如果有差异，请尝试同步时间。

# c# - 如何将整数格式化为 ASCII/Unicode 字符（不只是转换为 char）

> ID：13627863
> 
> 赞同：3
> 
> 时间：2012-11-29T14:23:29.070
> 
> 标签：c#

有没有办法将整数格式化为 C# 中等效的 ASCII/Unicode 字符？例如，如果我有以下代码：

```
int n = 65;
string format = ""; // what?

string s = string.Format(format, n); 
```

我需要在字符串中放入什么`format`才能导致写入单个字符“A” `s`- 基本上我正在寻找在 C 中执行以下操作的等价物：

```
int n = 65;
char s[2];
char format = "%c";

sprintf(s, format, n); /* s <- 'A' */ 
```

**编辑**

我可能应该更多地解释一下我正在尝试做的事情，因为显而易见的答案“将其转换为 char”并没有帮助。

我有一种情况，我有一个表示银行帐户校验位的整数值，但对于某些国家/地区需要输出为字符，而对于其他国家/地区需要输出为（0 填充）数字字符串。我想知道是否有一种方法可以通过更改格式字符串在两者之间切换，这样我就可以保存一个适当格式字符串的字典，键入国家代码。

**编辑 2**

（对于 Oded）这样的事情......

```
IDictionary<string, string> ccFormat = new Dictionary<string, string>()
{
  { "GB", "{0:D}" },  // 0-9
  { "PT", "{0:D2}" }, // 00-99
  { "US", "{0:D3}" }, // 000-999
  { "IT", ???? }      // A-Z -- What should ???? be?
};

string FormatCheckDigits(int digits, string country)
{
  return string.Format(ccFormat[country], digits);
} 
```

目前我在方法中有`????`as`null`和一些特殊情况代码：

```
string FormatCheckDigits(int digits, string country)
{
  string format = ccFormat[country];

  if (string.IsNullOrEmpty(format)) 
  {
    // special case: format as A-Z
    return ((char) digits).ToString();
  }
  else 
  {
    // Use retrieved format string
    return string.Format(format, digits);
  }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-29T14:27:03.493

您可以将其`int`转换为`char`：

```
string s = ((char)n).ToString(); 
```

* * *

没有办法告诉`string.Format`将整数格式化为字符。没有[自定义](http://msdn.microsoft.com/en-us/library/0c899ak8.aspx)或[标准](http://msdn.microsoft.com/en-us/library/dwhawy9k.aspx)的数字格式字符串可以对此有所帮助。

您当前的解决方案简单且有效，因此您应该保留它，除非您开始涉足更多选择。如果发生这种情况，您可能需要引入一个抽象，该抽象将为国家/地区返回正确的表示形式（例如`CountryCheckDigitFormatter`，将包含国家/地区和`ToString`每个国家/地区的自定义方法）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-29T14:26:51.073

这可以接受吗？

```
string a = Char.ConvertFromUtf32(65);

Console.WriteLine(a); //prints 'A' 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-29T14:26:48.060

好吧，要获得一个*角色*，您只需施放：

```
char c = (char) n; 
```

如果您需要将其作为字符串获取，您可以调用`ToString`：

```
string x = c.ToString(); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-29T14:35:12.070

简单的：

```
int i = 65;
char c = Convert.ToChar(i); 
```

# erlang - 退出：{bad_return，{{ejabberd_app，开始，[正常，[]]}

> ID：13627864
> 
> 赞同：0
> 
> 时间：2012-11-29T14:23:31.613
> 
> 标签：erlang, ejabberd

我在 Ejabberd 上使用 erlang R14B01，当我在我的 Lion 上启动 Ejabberd 时，它显示错误，谁能告诉我原因，谢谢！我有主机配置`{hosts, ["localhost"]}.`

```
=INFO REPORT==== 2012-09-18 23:35:10 ===
    application: ejabberd
    exited: {bad_return,
                {{ejabberd_app,start,[normal,[]]},
                 {'EXIT',
                     {badarg,
                         [{erlang,port_control,
                              [stringprep_port,2,"localhost"],
                              []},
                          {stringprep,control,2,[]},
                          {jlib,nodeprep,1,[]},
                          {ejabberd_config,normalize_hosts,2,[]},
                          {ejabberd_config,add_hosts_to_option,2,[]},
                          {lists,foldl,3,[{file,"lists.erl"},{line,1197}]},
                          {ejabberd_config,load_file,1,[]},
                          {ejabberd_config,start,0,[]}]}}}}
    type: temporary

=ERROR REPORT==== 2012-09-18 23:44:32 ===
Error in process <0.2102.0> on node 'ejabberd@localhost' with exit value: {{case_clause,{error,{open_error,-16}}},[{ejabberd_app,init,0,[]}]}

=INFO REPORT==== 2012-09-18 23:44:32 ===
    application: ejabberd
    exited: {bad_return,
                {{ejabberd_app,start,[normal,[]]},
                 {'EXIT',
                     {badarg,
                         [{erlang,port_control,
                              [stringprep_port,2,"localhost"],
                              []},
                          {stringprep,control,2,[]},
                          {jlib,nodeprep,1,[]},
                          {ejabberd_config,normalize_hosts,2,[]},
                          {ejabberd_config,add_hosts_to_option,2,[]},
                          {lists,foldl,3,[{file,"lists.erl"},{line,1197}]},
                          {ejabberd_config,load_file,1,[]},
                          {ejabberd_config,start,0,[]}]}}}}
    type: temporary 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T18:38:32.373

从崩溃报告来看，问题似乎出在 stringprep 上，这是一个驱动程序（用 C 编写，链接到 ejabberd VM）。根据我的经验，大多数情况下，当 ejabberd 使用一个 erlang 版本编译但尝试使用另一个版本运行时，就会出现此类错误。尝试使用 R14B01 进行干净的重新编译

# python - 是否可以在 Python 的函数中定义全局变量

> ID：13627865
> 
> 赞同：49
> 
> 时间：2012-11-29T14:23:32.800
> 
> 标签：python, function, global-variables

如何在 Python 的函数中声明全局变量？

也就是说，它不必在之前声明，但可以在函数之外使用。

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2012-11-29T14:24:28.803

是的，但是为什么？

```
def a():
    globals()['something'] = 'bob' 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2012-11-29T14:30:36.043

```
def function(arguments):
    global var_name
    var_name = value #must declare global prior to assigning value 
```

这将适用于任何功能，无论它是否在同一个程序中。

这是另一种使用方式：

```
def function():
    num = #code assigning some value to num
    return num 
```

注意：使用`return`内置将自动停止程序（或功能），无论它是否完成。

您可以在这样的函数中使用它：

```
if function()==5 #if num==5:
    #other code 
```

这将允许您在函数之外使用变量。不一定要声明为全局的。

此外，要将变量从一个函数使用到另一个函数，您可以执行以下操作：

```
import primes as p #my own example of a module I made
p.prevPrimes(10) #generates primes up to n
for i in p.primes_dict:
    if p.primes_dict[i]: #dictionary contains only boolean values
        print p.primes_dict[i] 
```

这将允许您在另一个函数或程序中使用该变量，而无需使用全局变量或`return`内置变量。

# html - 使用 HTML 将图像放在另一个图像之上？

> ID：13627868
> 
> 赞同：2
> 
> 时间：2012-11-29T14:23:46.797
> 
> 标签：html, css, image, browser, web

我想知道如何将一个图像作为背景，并将其他按钮图像放在 HTML 中？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T14:26:27.827

您需要将它们放在容器中`div`，然后相对放置。

像这样的东西可以做到：

```
<div style="position:relative; left:0; top:0;">
  <img src="x.png" style="position:relative; top:0; left:0;"/>
  <img src="y.png" style="position:absolute; top:30; left:70;"/>
</div> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-29T14:27:22.373

是的，你绝对可以这样做……这篇文章可以给你一些定位图像的技巧……

[制作相对于页面顶部的图像位置](https://stackoverflow.com/questions/5250739/making-an-image-position-relative-to-the-top-of-the-page)

# string - 将字符串类型传递给函数

> ID：13627871
> 
> 赞同：1
> 
> 时间：2012-11-29T14:23:58.397
> 
> 标签：string, function, powershell, function-parameter

我有以下代码：

```
cls
$input = 'Hello World'
Write-Host '$input.GetType() = ' + $input.GetType()

function some-string-function($input)
{
    Write-Host 'In the function now'
    Write-Host '$input.GetType() = ' + $input.GetType()
    Write-Host '$input (value)   = ' + $input
    return $input.length
}

$result = some-string-function $input

"`$result = $result" 
```

我得到以下信息：

```
$input.GetType() =  + System.String
In the function now
$input.GetType() =  + System.Collections.ArrayList+ArrayListEnumeratorSimple
$input (value)   =  + System.Collections.ArrayList+ArrayListEnumeratorSimple
$result = 
```

有人可以指出我实际上如何将字符串传递给PowerShell中的函数吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T14:32:50.413

澄清我的评论`$input`是保留的自动变量。如果您`some-string-function`使用另一个命名变量更改它，您将获得预期的行为。

# xcode - Xcode 4 Interface Builder - 设计时自动调整大小

> ID：13627874
> 
> 赞同：2
> 
> 时间：2012-11-29T14:24:04.043
> 
> 标签：xcode, xcode4, resize, interface-builder, window

我刚刚迁移到 Xcode 4，并且 Interface Builder 的工作方式与 Xcode 3 中的不太一样。当我设计我的用户界面时，每当我调整包含任何子视图的视图（包括窗口本身）时，例如一个 NSBox 或一个自定义视图，所有的子视图都会随之重新缩放！

我明白为什么这是有道理的，因为它显示了应用程序在运行时的行为，但在设计时却很烦人；每次我想向窗口添加更多控件时，我都需要扩展窗口，然后将所有子视图的大小调整回原来的样子，然后添加新控件。它快把我逼疯了！

我一直在寻找一种方法来阻止这种情况发生，但似乎无法做到。首先，我认为，由于它正在模拟运行时行为，因此如果我在 Windows 视图属性中取消选中“自动调整子视图”，则会停止自动调整大小。但这没有用。

然后我在 Interface Builder User Guide 中找到了这个：

> Interface Builder 提供了两种调整窗口大小的行为：
> 
> *   您可以仅调整窗口大小。
>     
>     
> *   您可以调整窗口及其所有内容的大小。
>     
>     
> 
> 默认情况下，调整窗口大小只会调整窗口大小。要调整窗口及其内容的大小，请在单击并拖动窗口的调整大小手柄的同时按住 Command 键。按住 Command 键会导致 Interface Builder 应用当前对窗口包含的视图进行的自动调整大小行为。此技术可让您查看窗口的运行时调整大小行为或将窗口及其内容缩放到所需大小。
> 
> 您可以通过从菜单中选择布局 > 实时自动调整大小来切换默认调整大小模式。切换时，按住 Command 键仅调整窗口大小。

我在菜单中找不到这个，而是：Editor > Canvas > Live Autoresizing（也许文档在这方面有点过时了？）

有趣的是它被禁用了。我以任何方式打开和关闭它只是为了确保，但自动调整大小仍在发生！

有没有其他人遇到过这个问题，或者是我错过了 Xcode 4 中的某些更改？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T14:30:39.807

Xcode4 非常不同。

> 您可以调整窗口及其所有内容的大小。

在您查看对象-> 属性检查器-> 自动调整子视图大小 ![在此处输入图像描述](../Images/c521682af6a4fecbfa54a2b8231dd44a.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T14:44:33.270

啊哈！我刚刚在网上找到了答案：

[http://www.goodbyehelicopter.com/2012/02/arggh-xcode-4-3-auto-layout-is-on-by-default-how-to-turn-off-auto-layout/](http://www.goodbyehelicopter.com/2012/02/arggh-xcode-4-3-auto-layout-is-on-by-default-how-to-turn-off-auto-layout/)

问题是在 Xcode 4.3 或更高版本中默认启用了“自动布局”功能！

要禁用此功能，请转到 nib 的文件检查器并在“Interface Builder Document”下，取消选中“Use Auto Layout”

通过禁用此功能，Interface Builder 的工作方式看起来更像 Xcode 3把我的脑袋转过来！

# php - Symfony：如何使用尚未在数据库中的表单中的对象

> ID：13627877
> 
> 赞同：0
> 
> 时间：2012-11-29T14:24:12.677
> 
> 标签：php, forms, symfony, entity

我有三个实体：

*   人
*   联系
*   个人隶属关系。

在表单中，用户可以通过单击按钮（添加现有的从属关系）来创建一个新人并添加一些现有的从属关系。现有的隶属关系将添加到 PersonAffiliation 实体中。

问题是当用户开始创建一个新人时，他必须点击添加现有的隶属关系，而这个人还没有出现在数据库中。

是否有可能在从属关系选择期间在第二个表单中使用表单中的 Person 对象，然后将选定的从属关系设置为此 Person 对象并返回到用户必须提交 Person 创建的第一个表单。

非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T19:52:11.960

您可以通过两种可能的方式执行此操作：

1.  被称为嵌入的表单集合。[您可以在Symfony 文档](http://symfony.com/doc/current/cookbook/form/form_collections.html)中了解它。如果您不完全知道如何称呼它，则很难找到。
2.  创建人员表单并在成功完成人员提交后，然后重定向到已填写人员 ID 的附属表单。

# javascript - 从 json 渲染页面时跳过重复项

> ID：13627878
> 
> 赞同：1
> 
> 时间：2012-11-29T14:24:14.923
> 
> 标签：javascript, jquery, ajax, json, jquery-mobile

我正在使用 ajax 和 json 渲染页面。我的 json 结构是`{"status":"ok","rewards":[{"id":201,"points":500},{"id":202,"points":500}]` 如果“点”在任何散列中重复，我如何使 ajax 加载数据仅一次？

例如，我有很少散列的 json，其中“点”具有相同的值这是我的代码

```
 $("#page").live('pagecreate', function(e) {
        var request = $.ajax({
            type: "GET",
            url: "example.com/file.json",
            dataType: "json",
            error: function (data, tex

tStatus){
           console.log( status );
          console.log( data );},
        success: function (data, textStatus){
        console.log( "success" );

        console.log( status );
           console.log( data );
         }
        })
        request.success(function(data, textStatus){
            var lis = "";
            var seen = {};
            $.each(data.rewards, function(key, val){
            lis += "<div class = 'reward-ui ui-block-" + String.fromCharCode(97 + key%3) + "'><a href ='#' class ='ui-link-inherit'>" + val.points + "</a></div>";
            });
            $(".ui-grid-b").html(lis);

            });
            //$('.even-odd').listview('refresh');
        })
      }); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T14:32:57.810

添加一个本地数组，它将存储所有使用的项目。在 $.each 函数中推入此数组，然后在执行 lis += " " 之前检查临时数组中是否已存在该值。

除此之外，您可以在检索数据之前尝试服务器端排序......就像上面建议的那样。

# python - 使用 fff_shift 时的递归问题

> ID：13627882
> 
> 赞同：0
> 
> 时间：2012-11-29T14:24:31.997
> 
> 标签：python, numpy, scipy

我正在编写一个程序来从列表中读取数据，傅里叶变换并在绘图之前对其进行移位。到目前为止，代码从 DICOM 文件中获取光谱数据并将其放入列表中，每个元素都是一个包含每个 FID/光谱值的数组。

```
from pylab import *
import dicom

plan=dicom.read_file("")

all_points = array(plan.SpectroscopyData)
cmplx_data = all_points[0::2] + 1j*all_points[1::2]
frames = int(plan.NumberOfFrames)
fid_pts = len(cmplx_data)/frames

fid_list = []
for fidN in arange(frames):
    offset = fidN * fid_pts 
    current_fid = cmplx_data[offset:offset+fid_pts]
    fid_list.append(current_fid) 
```

这可以很好地对数据进行分组，但是在尝试使用生成的数组时遇到了问题。首先，当试图只显示数据的复杂部分时，例如：

```
plot(complex(fid_list[0])) 
```

退货

```
Traceback (most recent call last)
/home/dominicc/Desktop/<ipython-input-37-4146b7fbfd7c> in <module>()
----> 1 plot(complex(fid_list[0]))

TypeError: only length-1 arrays can be converted to Python scalars 
```

其次，也是最重要的是，在尝试绘制 FFT 数据的零频移时，我遇到了无限递归：

```
plot(fftshift(fft(fid_list[0]))) 
```

收到以下错误

```
/home/dominicc/Desktop/New_Script.py in fftshift(fid_in)
     23 
     24 def fftshift(fid_in):
---> 25         fft_fid_in = fft(fid_in)
     26         plot(fftshift(fft_fid_in))
     27         show()

/usr/lib/python2.7/dist-packages/numpy/fft/fftpack.pyc in fft(a, n, axis)
    162     """
    163 
--> 164     return _raw_fft(a, n, axis, fftpack.cffti, fftpack.cfftf, _fft_cache)
    165 
    166 

/usr/lib/python2.7/dist-packages/numpy/fft/fftpack.pyc in _raw_fft(a, n, axis, init_function, work_function, fft_cache)
     43 def _raw_fft(a, n=None, axis=-1, init_function=fftpack.cffti,
     44              work_function=fftpack.cfftf, fft_cache = _fft_cache ):
---> 45     a = asarray(a)
     46 
     47     if n is None:

RuntimeError: maximum recursion depth exceeded 
```

任何人都可以提出改进我的代码以避免这些问题的方法吗？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T14:36:57.300

**第一个错误**

在你的 for 循环中，你有：

```
current_fid = cmplx_data[offset:offset+fid_pts]
fid_list.append(current_fid) 
```

因此，fid 是一个多维列表。之所以如此，是因为`[foo,bar].append([some,list])`导致`[foo,bar,[some,list]]`

`complex(fid_list[0])`期望它得到的任何列表的长度为 1。该行`current_fid = cmplx_data[offset:offset+fid_pts]`表示 fid_list[0] 的长度`fid_pts`

**第二个错误**

所以递归函数需要在内部处理两个分支。一个是终止分支（这可以阻止事物螺旋式上升到无穷大），另一个分支是尝试上述螺旋式的分支。

fftshift 不负责终止分支，因此您需要为此添加一些代码。

像这样重写函数并运行它以查看这一点的说明：

```
def fftshift(fid_in):
    print('fftshift 1')
    fft_fid_in = fft(fid_in)
    print('fftshift 2')
    foo = fftshift(fft_fid_in)
    print(' fftshift3') 
```

这将打印：

```
fftshift 1
fftshift 2
fftshift 1
fftshift 2
fftshift 1
fftshift 2
etc etc recursion error 
```

递归函数的最简单形式是：

```
def my_recursive_fn(foo):
    if some_condition:   #the terminating condition
        return bar #this should NOT call my_recursive_fn in any way
    moo = do_processing(foo)
    return my_recursive_fn(foo)

    plot(foo)
    show() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T12:44:35.343

通过在 fftshit 之前添加傅里叶转换数据的另一个 for 循环来解决：

```
fft_list = []
for i in range(0, frames):
    current_fid = fft(fid_list[i])
    fft_list.append(current_fid) 
```

# javascript - 放带有 javascript 的 Firefox 附加组件中的值

> ID：13627889
> 
> 赞同：4
> 
> 时间：2012-11-29T14:24:51.687
> 
> 标签：javascript, file-upload, firefox-addon

我面前有以下场景：

我正在使用 Selenium 来驱动我的浏览器填写一些表格，效果非常好。

现在我到了这一点，我还想通过给定的网络表单上传文件（不能改变它的处理方式，只能操作 Javascript/HTML/DOM）。正如我所发现的，出于安全原因，单击该字段时会立即弹出文件上传窗口。并且也无法通过普通的 Javascript 进行操作。也有道理...

不过我发现，Firefox 附加组件应该能够做到这一点。我最接近答案的是[关于这个主题的另一个 Stack Overflow 线程](https://stackoverflow.com/questions/10510593/browser-auto-select-file-through-file-input-tag-via-browser-extension)。如果我让这个为我工作，那就太棒了！:-) 但不幸的是我还没有……

最小的例子：

```
<form method="post" url="http://www.example.com">
<input type="file" id="fileInput"/>
</form> 
```

调用时（从 Firebug 中的控制台）

```
document.getElementById('fileInput').value = "C:\\image.png"; 
```

在获取“错误：操作不安全。” 这是我所期望的。

当在 Firefox 附加组件中的 contentScriptFile 中调用相同的内容时（我正在使用附加组件构建器来创建它），脚本会简单地中断而不会出现错误。我的指标是，我之前确实看到了警报，但在那条线之后没有看到

现在的问题不是为什么我没有收到错误，而是：
1\. 我在正确的轨道上吗？这应该工作吗？
2\. 我如何使这项工作？我不确定上面链接中提到的“chrome authority”是否与我相关。我是否必须以某种方式扩展脚本权限？如果是这样，怎么做？

谢谢！
桑德罗

PS 当我尝试通过 jQuery 设置值时，Firefox 完全崩溃了。
PPS 目前这仅适用于我的个人计算机，跨浏览器问题或类似问题因此不相关

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-05T10:31:28.647

我现在找到了一个可行的解决方案。部分问题似乎是我一直在使用 Selenium VBA 包装器。然后我用 C# 实现和一个快速的 Powershell 脚本来尝试它，它就像一个魅力。

摘要：原始目标：使用 Selenium 上传具有给定表单的文件解决方案：在“文件”类型的输入元素上使用 SendKeys 方法以提供文件的完整路径 Powershell 中的示例脚本：

```
add-type -path C:\path\To\the\dll\on\your\harddrive\webdriver.dll
$driver = New-Object OpenQA.Selenium.Firefox.FirefoxDriver
#the following page contains an element <input type='file' id='fileInput'/>
$driver.Url = "http://pathToTheSite.com/fileUploadFormPage.html"

$element = $driver.FindElementById("fileInput")

$element.SendKeys("C:\Image.png") 
```

完毕！！！文件附上，表格一次性提交

# php - Kohana ORM - 表名不正确

> ID：13627891
> 
> 赞同：0
> 
> 时间：2012-11-29T14:25:01.253
> 
> 标签：php, kohana, kohana-3, kohana-orm, kohana-3.2

我对 Kohana (3.2) ORM 查询生成器有一个奇怪的问题，我不知道出了什么问题。我得到“不正确的表名”异常：

```
 Database_Exception [ 1103 ]: Incorrect table name '' [ SELECT ``.* FROM `` JOIN `user_plugins` ON (`user_plugins`.`plugin_id` = ``.`id`) WHERE `user_plugins`.`user_id` = '9' ] 
```

如您所见，查询中的表为空。

控制器：

```
 $user = ORM::factory('user', Auth::instance()->get_user()->id);

  if ($user->loaded() ) 
  {
     $result = $user->plugin->find_all();
  } 
```

用户型号：

```
 class Model_User extends Useradmin_Model_User
  {
    protected $_has_many = array(
      'plugin' => array( 'through' => 'user_plugins'),
    );
  ... 
```

user_plugin 模型

```
 class Model_user_plugin extends ORM
  {
     protected $_belongs_to = array(
         'plugin' => array(),
         'user' => array()
     );
  ... 
```

插件模型

```
 class Model_Plugin extends ORM
  {
     protected $_has_many = array(
         'user' => array('through' => 'user_plugins')
     );
  ... 
```

有人知道这里有什么问题吗？非常感谢任何帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-01T10:57:34.767

用户模型应该是这样的

```
class Model_User extends Useradmin_Model_User
{
   protected $_has_many = array(
      'plugin' => array('model' => 'plugin', 'through' => 'user_plugins'),
   );
... 
```

插件模型应该是这样的

```
class Model_Plugin extends ORM
{
    protected $_has_many = array(
        'user' => array('model' => 'user', 'through' => 'user_plugins')
    ); 
```

您根本不需要 user_plugin 模型，两个模型中的“user_plugins”指的是表名，而不是模型名。只需确保您拥有带有 user_plugins 的表，该表具有以下字段，

id、user_id、plugin_id

我希望这有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-01T11:04:48.213

按照`$_has_many`惯例， 必须始终使用复数名称，除非您`$_object_name`在目标模型中指定名称。所以应该是：

```
class Model_Plugin extends ORM
{
  protected $_has_many = array(
     'users' => array('through' => 'users_plugins')
  );
  //... 
```

```
class Model_User extends ORM
{
  protected $_has_many = array(
     'plugins' => array('through' => 'users_plugins')
  );
  //... 
```

```
class Model_user_plugin extends ORM
{
  protected $_belongs_to = array(
     'plugin' => array(),
     'user' => array()
  );
  //... 
```

# ruby - Ruby - 对数组值进行排序并选择新数组

> ID：13627892
> 
> 赞同：0
> 
> 时间：2012-11-29T14:25:13.593
> 
> 标签：ruby, arrays, sorting

我在将数组排序为升序时遇到问题，然后从数组中选择一个值放入新数组中。

```
# Splitting dance scores with "," and putting into arrays.
for dancers in results
  a = dancers.split(",")

  couplenumber = a[0]
  score1 = a[1]
  score2 = a[2]
  score3 = a[3]
  score4 = a[4]
  score5 = a[5]
  score6 = a[6]
  score7 = a[7]
  dancescores << Dancer.new(couplenumber, score1, score2, score3, score4, score5, score6, score7)
  # Sorts the array into ascending order, and shows the 4 lowest values.
  #p dancescores.sort.take(4)

  # Getting the m value, from picking the 4th lowest number.
  m = a[4]
  newtest = [couplenumber, m]
  coupleandscore << newtest
  coupleandscore
end
puts coupleandscore 
```

现在它给了我新数组中的原始值，这是它应该的。但如果我尝试做

```
p dancescores.sort.take(4) 
```

我会收到这个错误：

```
[#<Dancer:0x10604a388 @score7=5, @score3=3, @score6=6, @score2=2, @score5=1, @score1=1,     @couplenumber="34", @score4=3>]
examtest.rb:43:in `sort': undefined method `<=>' for #<Dancer:0x10604a388> (NoMethodError) 
```

任何形式的帮助将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T15:08:35.010

你应该更准确地解释你想要做什么。

据我了解：

```
class Dancer

  attr_reader :number
  attr_reader :scores

  def initialize(number,scores)
    @number=number
    @scores=scores.sort
  end  
end

dancescores=[]

results.each do |result|
  scores = result.split(',')
  couplenumber = scores.shift
  dancescores << Dancer.new(couplenumber, scores)
end

# Now you can get the 4th score for each couple
dancescores.each do |dancers|
  p dancers.scores[3]
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T14:35:27.187

你可以`<=>`像这样在 Dancer 上实现

```
class Dancer
  def sum_scores
    @score1 + @score2 + @score3 + @score4 + @score5 + @score6 + @score7
  end
  def <=> other_dancer
    sum_scores <=> other_dancer.sum_scores
  end
end 
```

我假设分数只是加起来总和。

**更新：**评分基于排序分数中的第四个值

```
class Dancer
  def scores
    [@score1,@score2,@score3,@score4,@score5,@score6,@score7]
  end
  def <=> other_dancer
   scores.sort[3] <=> other_dancer.scores.sort[3]
  end
end 
```

现在在您的代码中执行以下操作：

```
for dancers in results
  a = dancers.split(",")

  couplenumber = a[0]
  score1 = a[1]
  score2 = a[2]
  score3 = a[3]
  score4 = a[4]
  score5 = a[5]
  score6 = a[6]
  score7 = a[7]
  dancescores << Dancer.new(couplenumber, score1, score2, score3, score4, score5, score6, score7)
end
puts dancescores.sort.map{|d| [d.couplenumber,d.scores.sort[3]]} 
```

# mysql - 在MYSQL中选择行作为列

> ID：13627905
> 
> 赞同：3
> 
> 时间：2012-11-29T14:26:11.983
> 
> 标签：mysql, sql, pivot

你好我想弄清楚怎么做我有一个mysql表

```
| ID |    ACC_ID  | line_id | code     |
| 1  |          1 |    5960 | DCA      |
| 2  |          1 |    5960 | AAA      |
| 3  |          1 |    5960 | DDD      | 
| 4  |          1 |    5960 | DER      |
| 5  |          1 |    5054 | DCB      |
| 6  |          1 |    5054 | AAC      |
| 7  |          1 |    5011 | DDE      |
| 8  |          1 |    5012 | DEQ      | 
```

等数据库下降了大约 10000 行

我想做一个 mysql select 语句来执行此操作

```
| ACC_ID     | line_id | code     | code     | code     | code     | 
|   1        | 5960    | DCA      | AAA      | DDD      | DER      | 
|   1        | 5054    | DCB      | DER      |          |          |
|   1        | 5011    | DDE      |          |          |          |
|   1        | 5012    | DEQ      |          |          |          | 
```

每个 line_id 最多可以有十个代码

现在我的问题是可以使用 select 语句进行上述查询。

感谢大家的帮助

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T14:33:42.070

这是一个`PIVOT`，但 MySQL 没有`PIVOT`函数，但您可以使用聚合函数和`CASE`语句复制它。MySQL 也没有按组分配行号的最简单方法，但以下是如何使用 SQL 实现此目的的示例。既然你说你最多可以有 10 个代码，`line_id`我硬编码了一个可能的解决方案。：

```
select acc_id,
  line_id,
  max(case when group_row_number = 1 then code end) Code1,
  max(case when group_row_number = 2 then code end) Code2,
  max(case when group_row_number = 3 then code end) Code3,
  max(case when group_row_number = 4 then code end) Code4,
  max(case when group_row_number = 5 then code end) Code5,
  max(case when group_row_number = 6 then code end) Code6,
  max(case when group_row_number = 7 then code end) Code7,
  max(case when group_row_number = 8 then code end) Code8,
  max(case when group_row_number = 9 then code end) Code9,
  max(case when group_row_number = 10 then code end) Code10
from
(
  select ACC_ID,
    line_id,
    code, 
    @num := if(@ACC_ID = `ACC_ID` AND @line_id = `line_id`, @num + 1, 1) as group_row_number,
    @ACC_ID := `ACC_ID` as dummy,
    @line_id := `line_id` as linedummy
  from yourtable
) src
group by acc_id, line_id
order by line_id desc 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!2/92824/7)

结果：

```
| ACC_ID | LINE_ID | CODE1 |  CODE2 |  CODE3 |  CODE4 |  CODE5 |  CODE6 |  CODE7 |  CODE8 |  CODE9 | CODE10 |
-------------------------------------------------------------------------------------------------------------
|      1 |    5960 |   DCA |    AAA |    DDD |    DER | (null) | (null) | (null) | (null) | (null) | (null) |
|      1 |    5054 |   DCB |    AAC | (null) | (null) | (null) | (null) | (null) | (null) | (null) | (null) |
|      1 |    5012 |   DEQ | (null) | (null) | (null) | (null) | (null) | (null) | (null) | (null) | (null) |
|      1 |    5011 |   DDE | (null) | (null) | (null) | (null) | (null) | (null) | (null) | (null) | (null) | 
```

# ruby-on-rails-3 - 与工厂女孩一起使用回形针，没有图像处理程序错误

> ID：13627906
> 
> 赞同：8
> 
> 时间：2012-11-29T14:26:15.643
> 
> 标签：ruby-on-rails-3, paperclip, factory-bot

我正在尝试将回形针与 factory_girl gem 一起使用，但收到“未找到处理程序错误”消息。

> test_should_update_category(CategoriesControllerTest): Paperclip::AdapterRegistry::NoHandlerError: No handler found for "/system/categories/images/000/000/001/original/tel1.JPG?1354197869"

工厂女孩档案：

```
FactoryGirl.define do
factory :category do
name "MyString"
description "MyText"
image { File.new(File.join(Rails.root, 'test','tel1.JPG')) }
end
end 
```

类别迁移::----------------

```
class CreateCategories < ActiveRecord::Migration
def up
create_table :categories do |t|
t.string :name
t.text :description
t.string :image

  t.timestamps
end
add_attachment :categories, :image
end 
```

模型：

```
class Category < ActiveRecord::Base
attr_accessible :description, :image, :name
has_attached_file :image, :styles => { :thumb => "100x100>" }

end 
```

类别控制器测试文件：

```
require 'test_helper'

class CategoriesControllerTest < ActionController::TestCase
setup do
@category = FactoryGirl.create(:category)
end 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-13T18:12:44.457

我让它在我的应用程序/工厂中使用以下代码：

```
FactoryGirl.define do
  factory :upload do
    permalink "unique"
    upload Rack::Test::UploadedFile.new(Rails.root + 'spec/files/uploads/unique.jpg', 'image/jpg')
  end  
end 
```

因此，在您的应用程序中，您应该将您的类别工厂更改为以下内容：

```
FactoryGirl.define do
  factory :category do
    name "MyString"
    description "MyText"
    image Rack::Test::UploadedFile.new(Rails.root +'test/tel1.JPG', 'image/jpg')
  end
end 
```

# google-visualization - 谷歌图表轴标签问题折线图

> ID：13627912
> 
> 赞同：0
> 
> 时间：2012-11-29T14:26:32.743
> 
> 标签：google-visualization

我正在创建谷歌图表来显示过去 7 天的谷歌分析数据。当我有某些数据时，我遇到了 X 轴标签堆叠在一起的问题（或者至少我能说的只是不同。）

我正在使用这个 gem 生成 API 调用：[https](https://github.com/mattetti/googlecharts) ://github.com/mattetti/googlecharts我查看了 URL 的每个部分都在做什么，但找不到问题，但我确定我我错过了一些东西。

这是同一时间段内两个站点数据的示例，第一个显示问题，第二个是工作示例：

![破损的图表](../Images/960119afc788cf66d20a7d42ac51632f.png)

![工作表](../Images/6dc0abe39ab6e228559043284cc14c5c.png)

这是 URL，这些是为便于阅读而编码的文本，但在切换到简单或扩展编码时也会出现同样的问题：

损坏的版本：

```
https://chart.apis.google.com/chart?chxl=0:|11-22|11-23|11-24|11-25|11-26|11-27&chxt=x&chco=58838C,BF996B,BF5841,A61C1C&chf=bg,s,ffffff&chd=t:979,807,681,653,580,509|822,724,602,562,519,455|540,409,381,375,336,301|307,156,173,176,155,133&chds=0,979&chdl=Visits|Visitors|New+Visits|Organic+Searches&chtt=Google+Analytics+-+Last+7+Days&cht=lc&chs=600x200&chxr=0,979,979|1,822,822|2,540,540|3,307,307 
```

工作版本：

```
https://chart.apis.google.com/chart?chxl=0:|11-22|11-23|11-24|11-25|11-26|11-27&chxt=x&chco=58838C,BF996B,BF5841,A61C1C&chf=bg,s,ffffff&chd=t:1385,1395,981,947,863,731|1083,1222,832,715,690,546|580,566,427,413,387,329|247,151,151,171,162,135&chds=0,1395&chdl=Visits|Visitors|New+Visits|Organic+Searches&chtt=Google+Analytics+-+Last+7+Days&cht=lc&chs=600x200&chxr=0,1385,1395|1,1083,1222|2,580,580|3,247,247 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T17:07:07.830

chxr 值不正确。gem 为多个轴生成它们，而它应该只为一个轴生成它们。我手动覆盖了 gem 中的最小值、最大值和步长，它起作用了。

这是我使用 gem 的代码，首先从我的所有数据点中获取最大值：

```
[@visits,@visitors,@new_visits,@organic_searches].each do |array|
  array.values.each do |value|
    @max_value = value if (value > @max_value)
  end
end

# Chart it
chart = Gchart.line(
  :title => prop.to_s.upcase + ' Google Analytics - Past 7 Days',
  :size => '600x200',
  :bg => 'ffffff',
  :axis_with_labels => ['x'],
  :axis_labels => [@visits.keys],
  :legend => ['Visits','Visitors','New Visits','Organic Searches'],
  :line_colors => ['58838C','BF996B','BF5841','A61C1C'],
  :encoding => 'text',
  :data => [@visits.values,@visitors.values, @new_visits.values, @organic_searches.values],
  :max_value => @max_value,
  :axis_range => [nil, [0, @max_value, (@max_value / 10).to_i]],
  :format => 'image_tag') 
```

# php - php数组多维

> ID：13627915
> 
> 赞同：-2
> 
> 时间：2012-11-29T14:26:42.717
> 
> 标签：php, arrays

我刚刚编写了一个抓取脚本，它可以工作。现在我得到这个输出：

```
Array
(
    [0] => Array
        (
            [0] => example stuff
            [1] => example stuff
            [2] => example stuff
            [3] => example stuff
        )

[1] => Array
    (
        [0] => /spellen/thumbs/a/aladdinwildride_6524.jpg
        [1] => /spellen/thumbs/t/toystory3_3476.jpg
        [2] => /spellen/thumbs/f/fred-flintstone-bobsled_2180.jpg
        [3] => /spellen/thumbs/m/madagascar-2.jpg
    )

[2] => Array
    (
        [0] => spel Alladin Wide Rit
        [1] => spel Toy Story 3
        [2] => spel Bedrock Bobsledding blowout
        [3] => spel Madagascar 2 Ontsnap naar Afrika

    )

[3] => Array
    (
        [0] => /spellen/cartoons/2096/alladin-wide-rit.html
        [1] => /spellen/cartoons/1989/toy-story-3.html
        [2] => /spellen/cartoons/1362/bedrock-bobsledding-blowout.html
        [3] => /spellen/cartoons/237/madagascar-2-ontsnap-naar-afrika.html

    )

[4] => Array
    (
        [0] => l
        [1] => l
        [2] => l
        [3] => l

    )

[5] => Array
    (
        [0] => Speel Alladin Wide Rit online
        [1] => Speel Toy Story 3 online
        [2] => Speel Bedrock Bobsledding blowout online
        [3] => Speel Madagascar 2 Ontsnap naar Afrika online

    )

[6] => Array
    (
        [0] => e
        [1] => e
        [2] => e
        [3] => e

    )

[7] => Array
    (
        [0] => /images/thumb_frame_top.gif
        [1] => /images/thumb_frame_top.gif
        [2] => /images/thumb_frame_top.gif
        [3] => /images/thumb_frame_top.gif

    )

[8] => Array
    (
        [0] => f
        [1] => f
        [2] => f
        [3] => f

    ) 
```

)

现在我想要一个简单`foreach`的，返回我每个`$matches[1][0]`，`$matches[2][0]`和`$matches[3][0]`。

我已经尝试了几个小时，但没有运气。有谁能够帮助我？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T14:28:36.697

```
$result = array();
foreach ($matches as $match) {
    $result[] = array(
        $match[1],
        $match[2],
        $match[3],
    );
    // or unset($match[0]); if you don't need the original array anymore
    // or array_splice($match, 0, 1); if you also want to rearrange the keys
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T14:29:09.850

```
foreach($matches as $match){

    // $match[0] is what you need

} 
```

如果要将结果包装在新数组中，可以将原始数组减少为：

```
$newArray = array_reduce($matches, function(&$result, $match){

  $result[] = $match[0];

}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-29T14:30:40.793

这是你想要的吗？

```
for ($i = 0; $i < count($matches); $i++)
{
    print $matches[$i][0];
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-29T14:35:57.507

```
foreach ($matches as $j => $match) {
   foreach ($match as $i => $mi) {
       if ($i != 0) unset($matches[$j][$i]);
   }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-29T14:37:21.873

如果你只想要前三个：

```
$newArray = array(
    $matches[1][0],
    $matches[2][0],
    $matches[3][0]
); 
```

结果：

```
 Array
    (
        [0] => /spellen/thumbs/a/aladdinwildride_6524.jpg
        [1] => spel Alladin Wide Rit
        [2] => /spellen/cartoons/2096/alladin-wide-rit.html
    ) 
```

# sproutcore - Sproutcore 中协议目录的用途是什么？

> ID：13627918
> 
> 赞同：1
> 
> 时间：2012-11-29T14:26:48.793
> 
> 标签：sproutcore

在学习 sproutcore 中的构建工具时，我遇到了下面的配置选项，它允许将名为“protocols”的目录中的文件包含在构建中。

`:load_protocols => {Boolean}`

但我的主要问题是这个`protocols`目录是什么？它有什么意义？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T16:07:20.833

今天，我在工作中得到了前辈的答复。我喜欢与社区分享

存在协议以便方法可以使用 JSDoc 记录，而无需包含在类中。

例如，SC.ResponderProtocol 记录了诸如 mouseDown 之类的方法。如果您在 SC.View 子类中实现 mouseDown，它将被调用。但是，如果您不实现它，SC.View 中就没有默认（空）实现，这只会增加进行无操作方法调用的开销。

协议目录存在一个将它们收集在一起的地方，但由于实现只是占位符，并没有在任何地方实际使用，它们不包含在生产构建中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-30T01:51:07.817

协议是没有实现的各种接口。如果您希望一个对象实现一组特定的方法，您将为此定义一个协议；然后将其放置在协议目录中。

# visual-studio-2010 - 使用opencv相机校准的失真系数

> ID：13627921
> 
> 赞同：1
> 
> 时间：2012-11-29T14:27:02.070
> 
> 标签：visual-studio-2010, opencv, camera-calibration

我正在使用 opencv 库在 Visual C++ 中编写。我使用带有棋盘图案的 calibrateCamera 函数来提取内在、外在和失真值。问题是我不知道如何在 CCD 上的 2D 点上使用 distCoeffs 矩阵 (1x5)。有人能帮我吗？提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T16:26:14.180

[文档](http://docs.opencv.org/doc/tutorials/calib3d/camera_calibration/camera_calibration.html)的相关部分是

发生切向畸变是因为图像拍摄镜头与成像平面不完全平行。通过以下公式进行更正：

```
x_{corrected} = x + [ 2p_1xy + p_2(r^2+2x^2)] 
y_{corrected} = y + [ p_1(r^2+ 2y^2)+ 2p_2xy] 
```

所以我们有五个失真参数，它们在 OpenCV 中被组织成一个 5 列 1 行的矩阵：

```
Distortion_{coefficients}=(k_1 k_2 p_1 p_2 k_3) 
```

您还可以使用[undistort](http://opencv.willowgarage.com/documentation/cpp/camera_calibration_and_3d_reconstruction.html#cv-undistort)、[undistort points](http://opencv.willowgarage.com/documentation/cpp/camera_calibration_and_3d_reconstruction.html#cv-undistortpoints)或[initUndistortRectifyMap](http://opencv.willowgarage.com/documentation/cpp/camera_calibration_and_3d_reconstruction.html#cv-initundistortrectifymap)与[remap结合使用](http://opencv.willowgarage.com/documentation/cpp/geometric_image_transformations.html#cv-remap)

# android - 带有clickhandler的android中的微调器和按钮

> ID：13627928
> 
> 赞同：0
> 
> 时间：2012-11-29T14:27:24.100
> 
> 标签：android, button, spinner

我尝试使用 clickHandler 制作微调器和按钮

这是我的 nyoba.java

```
import android.app.Activity;
import android.content.Intent;
import android.os.Bundle;
import android.view.View;
import android.widget.AdapterView;
import android.widget.ArrayAdapter;
import android.widget.Button;
import android.widget.Spinner;
import android.widget.TextView;

public class nyoba extends Activity {
    String[] nama_hari = {"Senin", "Selasa", "Rabu","Kamis","Jum'at","Sabtu","Minggu"};
    /** Called when the activity is first created. */
     Spinner  spinner1;
     Button btnSubmit;
     TextView textView1;
     String tes;
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
        btnSubmit = (Button)findViewById(R.id.btnSubmit);
        textView1 = (TextView)findViewById(R.id.textView1);
        spinner1 = (Spinner)findViewById(R.id.spinner1);
        ArrayAdapter<String> aa = new ArrayAdapter<String>(this,android.R.layout.simple_spinner_item, nama_hari);
           aa.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
            spinner1.setAdapter(aa);
    }
    public void onItemSelected(AdapterView<?> arg0, View arg1,  
            int arg2, long arg3) {  
            tes =  nama_hari[arg2]; 
    }  
    public void clickHandler(View view){
        switch (view.getId()){
        case R.id.btnSubmit:
         textView1.setText(tes); 
            break;
}
    }
} 
```

这是我的 main.xml 文件

```
<?xml version="1.0" encoding="utf-8"?>
<ScrollView
  xmlns:android="http://schemas.android.com/apk/res/android"
  android:layout_width="fill_parent"
  android:layout_height="fill_parent"
  android:fillViewport="true">
  <RelativeLayout 
        android:layout_width="fill_parent"
        android:layout_height="wrap_content" android:background="#ffffff">

        <LinearLayout
          xmlns:android="http://schemas.android.com/apk/res/android"
          android:orientation="vertical"
          android:layout_width="match_parent"
          android:layout_height="wrap_content"
          android:padding="10dip"
          >

          <Spinner
        android:id="@+id/spinner1"
        android:layout_width="match_parent"
        android:layout_height="wrap_content" />

    <Button
        android:id="@+id/btnSubmit"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:onClick="clickHandler"
        android:text="Submit" />

    <TextView
                android:id="@+id/textView1"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                 />

        </LinearLayout>

  </RelativeLayout>
</ScrollView> 
```

但是当我将它运行到模拟器时，我在微调器中选择 1 个选项并单击按钮，TextView 不会显示我选择的微调器中的单词

（例如，我在微调器处选择“senin”，然后单击按钮，但文本“senin”没有出现在 TextView 中）

我检查了DDMS，没有错误.....

代码错了吗？你能帮我看看哪一个是错的吗？

还是谢谢....

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T14:30:48.043

我认为您没有在微调器上设置选择侦听器。

但实际上您可以`getSelectedItemPosition`在按钮的单击处理程序中检索微调器的选定位置：

试试这个：

```
public void clickHandler(View view) {
    switch (view.getId()) {
    case R.id.btnSubmit:
        textView1.setText(nama_hari[spinner1.getSelectedItemPosition()]);
        break;
    }
} 
```

# java - 列表的返回方法列表

> ID：13627931
> 
> 赞同：2
> 
> 时间：2012-11-29T14:27:38.467
> 
> 标签：java

我有以下方法，现在返回最后一个条目，但是如何发送注释列表？

**我想从循环中返回所有注释列表**

```
public EList<Annotation> getAnnotation()
{
  EList<Annotation> annotations = null;
  for (Sc currSc : sche)
  {
    for (EntityS entitys : ent)
    {
      // Get annotation
      annotations = entitys.getAnnotations();
    }
  }
  return annotations;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T14:36:43.287

如果你想把所有的`Annotation`s 放在一起，你需要创建一个全新的`EList`，然后将它们全部添加，即

```
public EList<Annotation> getAnnotation()
{
  // Create the new list that will hold ALL the annotations
  EList<Annotation> annotations = new BasicEList<Annotation>();
  for (Sc currSc : sche)
  {
    for (EntityS entitys : ent)
    {
      // Get annotation
      annotations.addAll(entitys.getAnnotations());
    }
  }
  return annotations;
} 
```

# php - Doctrine 找不到 PostgreSQL PDO 驱动？

> ID：13627938
> 
> 赞同：1
> 
> 时间：2012-11-29T14:27:52.407
> 
> 标签：php, postgresql, symfony, doctrine

我看到这个问题非常相似，但我安装了 PDO 和 pdo_pgsql

*   [为什么 Doctrine 说找不到 PDO 驱动程序？](https://stackoverflow.com/questions/7451945/why-doctrine-says-it-can-not-find-the-pdo-driver)

这是我的错误信息：

```
 php app/console doctrine:mapping:convert yml ./src/Vendor/Bundle/MyBundle/Resources/config/doctrine/metadata/orm --from-database --force

  [PDOException]         
  could not find driver  

doctrine:mapping:convert [--filter="..."] [--force] [--from-database] [--extend[="..."]] [--num-spaces[="..."]] [--namespace[="..."]] [--em[="..."]] to-type dest-path 
```

这是我的 config.yml 设置

```
doctrine:
    dbal:
      connections:
        my_database:
          driver:   pdo_pgsql
          port:     5432
          dbname:   blah
          user:     foo
          password: bar
          charset:  UTF8 
```

主机在 prod 和 dev yaml 文件中配置如下

```
doctrine:
    dbal:
      connections:
        my_database:
          host: localhost 
```

在命令行上运行`php -m`我看到 PDO、pdo_pgsql 和 pgsql 都已安装

```
PDO
pdo_pgsql
pgsql 
```

我错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T16:19:21.423

啊..

您必须首先在 parameters.yml 文件中设置默认数据库

好吧，这对我有用

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-08-06T14:42:12.483

在 Symfony 2.7 或更高版本中，通过编辑*app/config/config.yml*文件将其留给指示驱动程序的数据库来解决问题：

```
doctrine:
    dbal:
        driver: "%database_driver%" 
```

当使用不同驱动程序的多个数据库时，此解决方案也很有用，例如，一个 MySQL 数据库，另一个 PostgreSQL 数据库，...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-11-18T15:42:07.987

首先，验证您的**php.ini**文件：必须启用扩展*php_pdo_pgsql*和*php_pdo 。*确保你在你的**symfony 项目**正在使用的 php.ini 文件上应用这些更改（我想你正在使用 symfony 的 app/console 工具），在*localhost/path_to_your_project/web/config.php*上检查这个。您知道是否启用了此扩展执行函数 phpinfo()。

这个命令也很有帮助：php -m。它在控制台上列出了所有加载的 php 模块。

提示：查看您的**Apache 错误日志**，您的扩展加载可能有问题。该文件根据您的服务器配置定位。

# extjs - 启用框架时 IE8 中的部分面板背景颜色

> ID：13627940
> 
> 赞同：1
> 
> 时间：2012-11-29T14:28:01.903
> 
> 标签：extjs, internet-explorer-8, frame

我有一个 extJS 面板，我想在其中有一个灰色的背景和灰色的框架。我有以下设置：

```
 var defaults = {
    layout: 'hbox',
    border: false,
    frame:true,
    style: {background:'#333333 !important'},
    bodyStyle: {background: '#333333', border: 'none'},
    items: [
        baseFilters,
        advFilters
    ]} 
```

当我在 chrome 中渲染它时，它工作正常。背景为灰色，框架存在，框架背景为灰色。但是，在IE8中启用时，项目下方的背景是灰色的，框架背景是灰色的，但面板中而不是项目下方的区域是原来的蓝色。在框架内的整个面板周围还有一个蓝色轮廓，它是蓝色的（可能大约 7px 宽）。

在此之前有没有人遇到过这些问题，可以提供一些关于如何去除蓝色的见解？

PS。

使用这些设置在 chrome 和 firefox 中渲染效果很好

# php - MySQL INNER 连接取决于 php 变量是否等于字段

> ID：13627941
> 
> 赞同：0
> 
> 时间：2012-11-29T14:28:04.573
> 
> 标签：php, mysql

我正在为内部连接的 SQL 查询而苦苦挣扎。我想拥有它，以便它加入与 $user_id 不同的字段。希望这是有道理的，这可能更容易理解：

```
if ($user_id = wallfriends.mem_id_from) {
INNER JOIN wallfriends ON wallusers.mem_id = wallfriends.mem_id_to
} else if ($user_id = wallfriends.mem_id_to) {
INNER JOIN wallfriends ON wallusers.mem_id = wallfriends.mem_id_from
} 
```

我当前的查询：

```
SELECT * FROM wallusers 
INNER JOIN wallfriends ON wallusers.mem_id = wallfriends.mem_id_from
WHERE ((wallfriends.mem_id_from =".$user_id.") OR (wallfriends.mem_id_to =".$user_id.")) AND wallfriends.confirm=1 
```

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T14:37:45.240

我认为您需要的是对 sql 字符串进行三元比较

```
$sql = " SELECT * FROM wallusers 
INNER JOIN wallfriends ON wallusers.mem_id = ".( $user_id == "wallfriends.mem_id_to"?"wallfriends.mem_id_from":"wallfriends.mem_id_to")."
WHERE wallfriends.confirm=1"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T14:29:48.963

试试这个 ：：

```
SELECT * 
FROM wallusers 
INNER JOIN wallfriends ON wallusers.mem_id = wallfriends.mem_id_from
WHERE 
(wallfriends.mem_id_from =".$user_id.") 
OR 
(wallfriends.mem_id_to =".$user_id.") 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-29T14:35:10.697

```
SELECT * FROM wallusers 
INNER JOIN wallfriends ON 
wallusers.mem_id = 
CASE WHEN 
wallfriends.mem_id_from =".$user_id." 
THEN wallfriends.mem_id_to 
ELSE wallfriends.mem_id_from
END
WHERE wallfriends.confirm=1 
```

# c# - PrivateFontCollection 在 appharbor 上失败

> ID：13627943
> 
> 赞同：3
> 
> 时间：2012-11-29T14:28:08.113
> 
> 标签：c#, fonts, appharbor

我正在尝试加载自定义字体（ttf 文件）并使用 Graphics 对象绘制到图像中。此代码在本地运行良好：

```
PrivateFontCollection fonts = new PrivateFontCollection();

string path = context.Server.MapPath("~/App_Data/Futura LT Bold.ttf");

if (!System.IO.File.Exists(path))
{
    throw new InvalidOperationException("Font file is not deployed: " + path);
}

fonts.AddFontFile(path); 
```

但是，当在 appharbor 上运行时，对 AddFontFile 的调用会失败并出现以下异常：

```
System.ArgumentException: Font 'Futura LT Book' does not support style 'Regular'.
at System.Drawing.Font.CreateNativeFont()
at System.Drawing.Font.Initialize(FontFamily family, Single emSize, FontStyle style, GraphicsUnit unit, Byte gdiCharSet, Boolean gdiVerticalFont)
at System.Drawing.Font..ctor(FontFamily family, Single emSize)
at LumenboxWeb.Controllers.GalleryController.FontTest() in d:\temp\h5oqslma.udd\input\src\LumenboxWeb\Controllers\GalleryController.cs:line 59
at lambda_method(Closure , ControllerBase , Object[] )
at System.Web.Mvc.ActionMethodDispatcher.Execute(ControllerBase controller, Object[] parameters)
at System.Web.Mvc.ReflectedActionDescriptor.Execute(ControllerContext controllerContext, IDictionary`2 parameters) 
```

我尝试了不同的字体，它们都在本地工作，但在 appharbor 上都没有。

是否可以在 appharbor 上动态加载字体？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T17:02:46.000

```
string path = context.Server.MapPath("~/App_Data/Futura LT Bold.ttf");
fonts.AddFontFile(path); 
```

您可以从 .ttf 名称中看出为什么会引发异常。请注意文件名中的“粗体”。这使得您可以使用 FontStyle = Regular 创建该字体的实例的可能性相当低。但很有可能 FontStyle = Bold 会起作用。

一个字体通常有*多个*.ttf 文件，每个 FontStyle 一个。假设您有其他文件，您还必须添加它们。

# svg - 如何根据 d3.js 中的索引分配颜色？

> ID：13627944
> 
> 赞同：2
> 
> 时间：2012-11-29T14:28:15.730
> 
> 标签：svg, d3.js

我正在尝试根据 metricValue 变量（整数）获取颜色，但下面的代码返回相同的颜色 #1f77b4。我究竟做错了什么？

```
function getColorForNode(d) {
    var p=d3.scale.category10();
    var metricValue = metrics.getScore(d.id)
    return(p(metricValue)); // Returns the same color independently of metricValue
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-30T01:13:43.803

这与没有为此序数尺度指定域的事实有关。

确实，您不需要按照文档 (https://github.com/mbostock/d3/wiki/Ordinal-Scales#wiki-ordinal_domain) 中的描述为序数比例指定域。在这种情况下，它会在您使用秤时自动构建一个域。它在规模实例中跟踪该域。

问题是，在您的情况下，您为每次调用 getColorForNode 创建一个新的比例实例。因此，没有持久域。每次从头开始构建域时，它都会输出第一个范围值：#1f77b4。

所以，基本上有两种解决方案：

选项 1：将规模实例构造保留在函数之外

```
var p = d3.scale.category10();
function getColorForNode(d) {
  var metricValue = metrics.getScore(d.id);
  return p(metricValue);
} 
```

选项 2：明确指定域

```
function getColorForNode(d) {
  var p = d3.scale.category10().domain(d3.range(10));
  var metricValue = metrics.getScore(d.id);
  return p(metricValue);
} 
```

# php - 在 YiiBooster TbTabs 小部件中动态添加选项卡

> ID：13627948
> 
> 赞同：0
> 
> 时间：2012-11-29T14:28:40.957
> 
> 标签：php, yii, yii-extensions

我已经创建了 bootstrap.widgets.TbTabs 如下，如何在客户端动态添加新选项卡。是否有任何事件可以用来添加新选项卡，就像下面代码中的“显示”事件一样。

```
<?php $this->widget('bootstrap.widgets.TbTabs', array(
    'id' => 'mytabs',
    'type' => 'tabs',
    'tabs' => array(
            array('id' => 'tab1', 'label' => 'Tab 1', 'content' => $this->renderPartial('tab1', null, true), 'active' => true),
            array('id' => 'tab2', 'label' => 'Tab 2', 'content' => 'loading ....'),
            array('id' => 'tab3', 'label' => 'Tab 3', 'content' => 'loading ....'),
    ),
    'events'=>array('shown'=>'js:loadContent')
));?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T17:28:03.893

我认为在控制器内渲染包含的视图不是一个好习惯。

我发现这在视图中对我有用：

```
$this->widget('bootstrap.widgets.TbTabs', array(
    'type'=>'tabs',
    'tabs'=>array(
        array( //
            'label'=>'Comments ('.$model->commentCount.')',
            'content'=>$this->renderPartial( '_comments', array( 'model'=>$model ), true ),
        ),
    )
)); 
```

显然，要使其正常工作，您需要存在“_comments.php”...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-30T09:27:50.393

没有，但这并不意味着您不能自己创建它。

只需通过控制器传递“选项卡”部分，如下所示：

在您的**控制器**中：

```
$tabs => array(
        array('id' => 'tab1', 'label' => 'Tab 1', 'content' => $this->renderPartial('tab1', null, true), 'active' => true),
        array('id' => 'tab2', 'label' => 'Tab 2', 'content' => 'loading ....'),
        array('id' => 'tab3', 'label' => 'Tab 3', 'content' => 'loading ....'),
);

$this->render('pageName', array('tabs' => $tabs)); 
```

在您**看来**：

```
<?php $this->widget('bootstrap.widgets.TbTabs', array(
    'id' => 'mytabs',
    'type' => 'tabs',
    'tabs' => $tabs,
    'events'=>array('shown'=>'js:loadContent')
));?> 
```

如果你想在你的主布局中实现类似的东西，你可以创建一个从 CActiveRecord 扩展的模型并将选项卡存储在数据库中。之后，您可以在模型类中使用静态方法来调用和检索选项卡。然后在您的布局视图中，您可以执行以下操作：

```
<?php $this->widget('bootstrap.widgets.TbTabs', array(
    'id' => 'mytabs',
    'type' => 'tabs',
    'tabs' => Model::getTabs(),
    'events'=>array('shown'=>'js:loadContent')
));?> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-01T07:34:30.263

在标题中添加新选项卡链接，添加新选项卡，显示新选项卡

```
$('#tabHeaders').append($('<li><a href="#newtab">New Tab</a></li>'));
$('#tabContent').append($('<div class="tab-pane" id="newtab"></div>'));
$('#newtab').tab('show'); 
```

注意 YiiBooster 自动生成元素 id，需要使用合适的 jquery 选择器

# apache - 为 Apache Tomcat 6 启用状态码 206

> ID：13627949
> 
> 赞同：2
> 
> 时间：2012-11-29T14:28:46.723
> 
> 标签：apache, tomcat, tomcat6

我想通过 HTML5 视频标签从我的 webapp 文件夹中播放一些 mp4 和 webm 视频文件。

但是我的问题是tomcat的状态码只有200：

```
Request URL:http://localhost:8080/resources/1.mp4
Request Method:GET
Status Code:200 OK 
```

但是，当我从 apache 网络服务器执行相同操作时，我会得到状态码 206：

```
Request URL:http://localhost/1.mp4
Request Method:GET
Status Code:206 Partial Content 
```

是否可以为 apache tomcat 激活代码 206。默认情况下，web.xml 中的 useAcceptRanges 为 [true]。

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T14:36:07.007

您需要自己实现 HTTP 范围支持。看到[这个](https://stackoverflow.com/questions/13325345/serving-audio-data-from-a-java-servlet-for-an-html5-audio-control)，几乎相同的问题/答案。

# c++ - 在 C++ 中包装来自不同库的自定义类型

> ID：13627950
> 
> 赞同：4
> 
> 时间：2012-11-29T14:28:47.097
> 
> 标签：c++, types, casting, conflicting-libraries

在使用不同的库时，我总是发现每个库都有相同的“真实单词实体”的自定义类型。

假设我有一个使用 3 维点的项目，我只使用来自 OpenCv 和 PCL（点云库）的算法。我发现自己有这些类型：

*   OpenCv 的 Point3_
*   用于 PCL 的 PointXYZ
*   Point3d 我的自定义类型

现在我有了为我的 Point3d 编写的算法，但我也想使用这些库中的算法。来回将大集合中的每个点从一种类型转换为另一种类型需要内存和时间。

对此进行某种抽象的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T15:36:12.667

你可以做这样的事情

```
template<class T>
    struct Getter{

};

template<class T>
struct Getter<Point3_<T>>{
     typedef T& type;
     static type getx(Point3_<T>& p){
         return p.x;
     }
};
template<>
struct Getter<PointXYZ>{
     typedef float& type;
     static type getx(PointXYZ& p){
         return p.x;
     }
};

template <class T>
point_x(T& p) -> Getter<T>::type{
      return Getter<T>::getx(p);

} 
```

对 y 和 z 执行相同操作然后修改您的算法以采用模板而不是使用 px = ... 使用

```
getx(p) = ..
auto x = getx(p) 
```

# javascript - 使用 amCharts 格式化 labelText

> ID：13627951
> 
> 赞同：2
> 
> 时间：2012-11-29T14:28:48.150
> 
> 标签：javascript, jquery, charts, amcharts

我正在尝试使用 amCharts 格式化数字。我想以 2 的精度格式化数字，但是当我插入时：

```
graph.numberFormatter = {precision:2, decimalSeparator:'.', thousandsSeparator:','}; 
```

它仅格式化工具提示中的数字，并且正如您在图像上看到的那样，并非所有数字都被格式化。

![堆积柱形图](../Images/c8891b0800684e50706a5268ba01e802.png)

```
graph.labelText = "[[coding]] €"; 
```

如何格式化标签文本？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-11-17T14:25:28.770

不要直接引用您的“valueField”。而是使用内置标签 [[value]]。所以你的例子会变成

```
graph.labelText = "[[value]] €"; 
```

就我而言，我在使用时遇到了完全相同的问题

```
"graphs" : [{
        "labelText" : "[[s1]]",
        "valueField" : "s1",
        ...
    }
], 
```

将其更改为

```
"graphs" : [{
        "labelText" : "[[value]]",
        "valueField" : "s1",
        ...
    }
], 
```

成功了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-07-19T11:28:16.603

这是我的建议：

```
"graphs":[{
     "labelText":"[[value]]",
     "labelFunction": function(graphDataItem, graph){
            var value = graphDataItem.values.value;
            value = formatTextLabel(value);
            return value;
      }
 }] 
```

formatTextLabel 是一个函数，例如：

```
function formatTextLabel(value){
    value = value.toString();
    var pattern = /(-?\d+)(\d{3})/;
    while (pattern.test(value))
        value = value.replace(pattern, "$1,$2") + "$";
    return value;
} 
```

# css - 表格居中与表格布局

> ID：13627954
> 
> 赞同：0
> 
> 时间：2012-11-29T14:29:01.880
> 
> 标签：css

[小提琴](http://jsfiddle.net/WhEFk/)- 在这里你有 2 个完全相同风格的桌子。TD 的宽度由`table-layout.`It works ok 自动调整，当只有一行文本时。但是当有更多的文本并且文本被扭曲时，似乎宽度是由所有文本计算的（就像它在一行中一样），而不是文本中最长的扭曲部分。

问题是如何将第 nr 2 表的内容以与第 1 表相同的方式居中？（atm 它看起来根本不像居中......）

![在此处输入图像描述](../Images/63f4a03d4219e230a976acd70e65d27e.png)- 这就是它应该看起来的样子（下一个） - 不需要的黄色空间应该被切割以使表格居中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T14:32:39.243

`td { text-align:center }`

第一个表中的文本实际上并未居中。它只是这样出现，因为它在细胞的两侧都没有呼吸空间。

像上面这样进行全局声明将允许对剩余的单元格进行额外的调整。

`td.first { text-align:left; font-weight:700 }`， ETC。

**编辑**

如果不声明宽度，您将无法实现该效果。默认情况下，表格不像`div`s，所以我给了它`display:block, width:80%`，现在表格中心，`td`没有正确填充它的父级，所以我给了它`width:100%`。

我认为这就是你所追求的：http: [//jsfiddle.net/hJXb9/](http://jsfiddle.net/hJXb9/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T14:41:46.337

我想你正在寻找这个。

```
 <table style="width:60%;margin-left:20%;margin-right:20%;">
    <tr>
        <td style="background:green;text-align: center; vertical-align: middle;">
            TADA
        </td>
        <td style="background:yellow;text-align:center; vertical-align: middle;">
            Lorem ipsum dolorsitamet kjfldslggfh;l</td>
        </tr>
    </table> 
```

[现场演示](http://jsfiddle.net/Mack28/9NKqM/)

希望，我会帮助你。谢谢。！！

# c# - 隐式运算符应该处理 null 吗？

> ID：13627956
> 
> 赞同：15
> 
> 时间：2012-11-29T14:29:05.437
> 
> 标签：c#, exception, implicit-conversion

我们有一个具有隐式字符串运算符的类型。它看起来像这样：

```
public class Foo
{
    readonly string _value;

    Foo(string value)
    {
        _value = value;
    }

    public static implicit operator string(Foo foo)
    {
        return foo._value;
    }

    public static implicit operator Foo(string fooAsText)
    {
        return new Foo(fooAsText);
    }

} 
```

我们刚刚遇到了一个场景，其中**传递给隐式运算符的实例是`null`**. 显然，我们最终得到了一个`NullReferenceException`.

我认为这很公平，毕竟，什么是 null 类型的字符串表示 - 很难说 - 所以异常似乎是有效的，我们不应该拦截/抑制/处理/忽略。我的推理是‘有人给了我一个空值，我为什么要返回空值。我不会在其他方法中这样做'。我想，'我知道，我会在转换之前检查 null'，比如：

`string s = foo == null ? null : foo;`

但这不起作用，因为它现在在与 null 比较***之前*****转换为字符串。***当然，这种比较会起作用：*

 *```
Foo f = null;
string s;
if (f != null)
{
    s = f;
} 
```

......但这很丑陋。

我阅读了[Essential C# 5 第 4 版](http://techbus.safaribooksonline.com/book/programming/csharp/9780133117868/chapter-9dot-well-formed-types/ch09lev1sec2)中的部分（关于 Safari 的“Rough Cuts”书），它说：

> 不要从隐式转换中抛出异常。

这说不要**抛出**异常，但这让我想知道我应该**抑制**异常吗？

最明显的做法是跳入方法并将其更改为：

```
public static implicit operator string(Foo foo)
{
    return foo == null ? null : foo._value;
} 
```

问题解决了。但是我觉得很脏。我觉得我通过检查 null 来隐藏一个潜在的错误。我是偏执狂/肛门/愚蠢吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-11-29T14:32:08.540

在这种情况下，我建议的是可能失败的运算符应该是显式的而不是隐式的。隐式转换的想法是它正在扩大（即它永远不会失败）。另一方面，显式转换被理解为有时会失败。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2020-02-07T07:15:03.383

我想`Foo`表现得和`string`. 所以，我期待

```
Foo foo = null;
string.Equals(null, foo); 
```

是真实的。

string.Equals 将尝试转换`foo`为字符串，因此它将调用隐式运算符。空值`foo`应该公开与空值相同的值`string`，即`null`.

因此，如果您确实想要一个隐式运算符，我会将其实现为：

```
public static implicit operator string(Foo foo)
{
    return foo?._value;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-01-28T13:43:35.530

在隐式转换运算符中“抑制”异常是完全可以的。事实上，正如您所指出的，这是推荐的方法。

考虑这种情况：

```
Foo actualFoo = null;
string stringFoo = actualFoo; 
```

如果编译得很好，为什么要让第二行在运行时抛出异常？那没有任何意义。

这同样适用：

```
string stringFoo = null;
Foo actualFoo = stringFoo; 
```

如果您这样定义两个隐式转换运算符，则意味着您希望以与使用类型**string**相同的方式处理和使用类型**Foo**。在这种情况下，上述两种情况都是完全有效的构造（您的编译器确认）并且应该产生 null 而不是抛出异常。

 **现在，正如 Dan 所指出的，如果这不是您想要的，那么您将需要定义一个显式转换。

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2018-09-07T11:55:40.703

您试图将 null 转换为 Foo 类型，因为双方的类型`:`必须相等。

```
string s = foo == null ? null : foo; 
```

所以你应该使用

```
string s = foo == null ? (string)null : foo; 
```

或者

```
string s = foo == null ? null : (string)foo; 
```***

# objective-c - 将 UINavigationBar 的外观从实体更改为透明

> ID：13627963
> 
> 赞同：1
> 
> 时间：2012-11-29T14:29:28.377
> 
> 标签：objective-c, uinavigationcontroller, uinavigationbar

我想实现与 iPad 上的照片应用程序完全相同的效果：图库控制器期间的纯黑色导航栏，然后在查看照片时透明。

在 AppDelegate 中初始化导航控制器后，我可以使用以下代码更改样式，但不能在 AppDelegate 之外更改。但是，一旦导航控制器出现在屏幕上并设置一次，navigationBar 就会成为只读属性。

如果有人可以分享这是如何完成的，我将不胜感激。谢谢。

```
 self.navigationController.navigationBar.tintColor = [UIColor clearColor];
    self.navigationController.navigationBar.translucent = YES;
    self.navigationController.navigationBar.barStyle = UIBarStyleBlackTranslucent; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T15:31:17.273

UINavigationBar in`UIBarStyleBlackTranslucent` `barStyle`不会像通常在其他样式中那样修复它的位置。在`UIBarStyleBlackTranslucent`样式上它只是与您的视图重叠，并且视图的内容被向上翻译并且`view`高度也增加了。

如果您要显示照片，则首先隐藏您的导航栏：

```
[[self navigationController] setNavigationBarHidden:YES animated:NO]; 
```

现在将导航栏的样式设置为`UIBarStyleBlackTranslucent`

```
[self.navigationController.navigationBar setBarStyle:UIBarStyleBlackTranslucent]; 
```

然后显示您的图像视图（或带有图片的滚动视图 - 取决于您的逻辑）。然后点击您的图像视图，您可以显示和隐藏栏）

```
 // Show/Hide bar
 // Let say you've a bool 'shown' for current status of navbar's visibility.
if (!shown) {
    [[self navigationController] setNavigationBarHidden:YES animated:YES];
}else{
     [[self navigationController] setNavigationBarHidden:NO animated:YES];
}
shown = !shown; 
```

希望这会做到。一旦你退出画廊，永远不要忘记将 barStyle 重新调整为 UIBarStyleBlackOpaque。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T17:18:08.973

似乎您想在画廊中显示导航栏，因此无需更改任何内容，但选择照片后，将导航栏隐藏在 PhotoViewController 中。

```
-(void) viewDidLoad
 {
  self.navigationController.navigationBar.barStyle=UIBarStyleBlackTranslucent;
  self.navigationController.navigationBar.hidden = NO;
 } 
```

并在 ViewWillAppear

```
-(void) viewWillAppear 
 {
  self.navigationController.navigationBar.hidden = YES;
 } 
```

然后创建一个实现 UITapGestureRecognizer 的自定义方法，通过将 hidden 属性设置为 YES，单击即可显示 navigationBar。

# r - 具有分组置信区间的ggplot条形图

> ID：13627966
> 
> 赞同：1
> 
> 时间：2012-11-29T14:29:38.490
> 
> 标签：r, ggplot2

![在此处输入图像描述](../Images/3629c53d97f1a1ddb1e43dfef38be744.png)

```
a <- structure(list(
  X1 = structure(c(1L, 2L, 3L, 4L, 5L, 6L, 7L, 8L, 1L, 2L, 3L, 4L, 5L, 6L, 7L, 8L, 1L, 2L, 3L, 4L, 5L, 6L, 7L, 8L), 
                  .Label = c("V1", "V2", "V3", "V4", "V5", "V6", "V7", "V8"), class = "factor"), 
   X2 = structure(c(1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 2L, 2L, 2L, 2L,  2L, 2L, 2L, 2L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L), 
                    .Label = c("A", "B", "C"), class = "factor"), 
  value = c(0.03508924, 0.03054929, 0.03820896, 0.18207091, 0.25985142, 0.03909991, 0.03079736, 
            0.41436334, 0.02957787, 0.03113289, 0.03239794, 0.1691519, 0.16368845, 0.0287741, 0.02443448, 
            0.33474091, 0.03283068, 0.02668754, 0.03597605, 0.17098721, 0.23048966, 0.0385765, 0.02597068, 0.36917749), 
   se = c(0.003064016, 0.003189752, 0.003301929, 0.006415592, 0.00825635, 0.003479607, 
          0.003195332, 0.008754099, 0.005594554, 0.006840959, 0.006098068, 0.012790908, 0.014176414, 
          0.006249045, 0.005659445, 0.018284739, 0.005051873, 0.004719352, 0.005487301, 0.011454206, 
          0.01290797, 0.005884275, 0.004738851, 0.014075813)), 
  .Names = c("X1", "X2", "value", "se"), class = "data.frame", row.names = c(NA, -24L)) 
```

我正在绘制上述数据（保存在数据集“a”中），但我无法让置信区间位于组图的中间。到目前为止，我的尝试只设法将线条放在每个侧面栏，而不是像 geom_errorbar 帮助文件那样在中间。我试图操纵闪避参数，但它只会让它变得更糟。图表需要保持翻转，在下面的代码中我使用了 geom_linerange 但 geom_errorbar 会更好。我还没有完全设法做的另一件事是将比例更改为整数（不增加原始表）。

我在 a<-a[1:16,] （前两组）上使用了下面的代码。当我在整个表上使用相同的代码时，置信区间的结果会更差。有人能帮忙吗？提前谢谢了。

```
limits <- aes(ymax = value + se, ymin=value - se)
 p<-ggplot(data = a, aes(x = X1, y =value))+   
    geom_bar(aes(fill=X2),position = "dodge") +    
    scale_x_discrete(name="")+
    scale_fill_manual(values=c("grey80","black","red"))+
    scale_y_continuous(name="%")+   
    theme(axis.text.y = element_text(face='bold'),
          legend.position ="top",
          legend.title=element_blank())+   
     coord_flip()
p + geom_linerange(limits) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T15:34:56.800

尝试这个 ，

```
p<-ggplot(data = df, aes(x = X1, y =value,fill= X2))+   
    geom_bar(position=position_dodge()) +
    geom_errorbar(aes(ymax = value + 2* se, ymin=value,colour = X2),position=position_dodge(.9))

p <- p + scale_x_discrete(name="")+
   scale_fill_manual(values=c("grey80","black","red"))+
   scale_y_continuous(name="%")+   
   theme(axis.text.y = element_text(face='bold'),
         legend.position ="top",
         legend.title=element_blank())+   
   coord_flip() 
```

![在此处输入图像描述](../Images/21243e793e0df998fe0968bedea079f9.png)

# c# - 服务定位器模式下的单元测试

> ID：13627971
> 
> 赞同：2
> 
> 时间：2012-11-29T14:29:55.503
> 
> 标签：c#, unit-testing, moles

我正在使用 moles 框架对我的代码进行单元测试。

有一个单例类的实现

1.  私有（空）构造函数
2.  公共静态只读实例变量

这个类实现了一个抽象类。

如何规避我的单例类的初始化函数？这个初始化函数是从抽象基类的构造函数中调用的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T14:38:04.340

您可以将您的单例子类化以制作“用于测试”的版本。您可以使您的初始化函数抽象化，并让您真正的单例实现您当前正在做的事情，并让测试版本实现一些东西来初始化您的测试版本。

# java - 使用来自不同类的数组

> ID：13627972
> 
> 赞同：0
> 
> 时间：2012-11-29T14:29:56.247
> 
> 标签：java

```
public class NewClass { 
    int[] anArray = {1,2,3,4};
}

public class NewerClass {     
    public static void main(String[] args){
        sendToMethod(NewClass.anArray);
    } 
} 
```

显然我上面写的方法不起作用，我想知道如何（如果可能的话）它可以完成？

基本上我想要一个数组类（`NewClass`），并希望能够将它们与`NewerClass`while 的 main 方法中的方法一起使用`NewerClass`。

它不是必需的，我只是在玩弄想法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T14:32:22.237

如果你有这样的东西，它会起作用：

```
public class NewClass {
    public static final int[] anArray = {1,2,3,4};
    // final is optional.
} 
```

但我不知道你想要达到什么目的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-29T14:32:24.383

您可以通过访问器方法公开它：

```
public class NewClass {
    private int[] anArray = { 1, 2, 3, 4 };

    public int[] getAnArray() {
        return anArray;
    }
}

public class NewerClass {
    public static void main(String[] args) {
        NewClass myNewClass = new NewClass();
        sendToMethod(myNewClass.getAnArray());
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-29T14:32:54.050

你可以做

```
public class   NewClass { static int[] anArray = {1,2,3,4}; } 
```

或者

```
public class NewerClass { 
    public static void main(String[] args){  
        sendToMethod(new NewClass().anArray); 
    }
} 
```

# c - 这是什么类型的声明？

> ID：13627974
> 
> 赞同：16
> 
> 时间：2012-11-29T14:30:03.780
> 
> 标签：c, gcc, struct

[从这个问题](https://stackoverflow.com/questions/13626246/typedef-a-struct-before-its-declared)延伸

我很难理解这段代码。

```
struct foo myfoo;  // --> Is it forward declaration or object creation. ?

struct foo
{
 int a;
};

int main()
{

return 0;
} 
```

代码中标有箭头的`-->`是前向声明还是对象创建。?

如果那是前向声明，那么什么`struct foo;`叫做？如果是对象创建或实例化，那么它如何在结构定义之前创建对象。

在`gcc`编译器上它工作正常，但其他编译器给出错误。

```
gcc -Werror -Wall tst.c -o tst 
```

关于这种行为的任何建议或解释`gcc`？我无法在任何地方找到它的记录。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-11-29T14:36:15.487

看起来像暂定定义，`myfoo`并且因为提供了结构的定义，所以您不会出错。

当未定义类型时，clang 提供了全面的诊断。

```
prasoon@ats-VPCEB3AGG:~$ cat tst.c
struct foo myfoo;

//struct foo{
//  int x ;
//} ;

int main()
{
}
prasoon@ats-VPCEB3AGG:~$ clang tst.c
tst.c:1:12: error: tentative definition has type 'struct foo' that is never
      completed
struct foo myfoo; 
```

我不认为它是 gcc 错误，clang 以及[comeau online](http://www.comeaucomputing.com/tryitout/)正在编译代码。

$6.9.2/2

> 具有文件范围的对象的标识符声明没有初始化程序，并且没有存储类说明符或具有存储类说明符 static，构成暂定定义。如果翻译单元包含一个或多个标识符的暂定定义，并且翻译单元不包含该标识符的外部定义，则行为与翻译单元包含该标识符的文件范围声明完全相同，复合类型为翻译单元的末尾，初始化器等于 0。
> 
> * * *

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-11-29T14:31:37.730

```
 struct foo myfoo; 
```

`foo`那是一个名为的类型的 C 变量定义`myfoo`。C 要求您在变量声明`struct`的前面显式声明。`struct`

现在，你的代码不应该编译，因为编译器不知道你定义你的地方`myfoo`，什么样的类型`foo`。编译器应该抱怨`foo`是一个不完整的类型。

编辑：

废话，这将被称为**暂定定义**。

# javascript - 悬停时jQuery不完整的动画

> ID：13627979
> 
> 赞同：0
> 
> 时间：2012-11-29T14:30:38.947
> 
> 标签：javascript, jquery, html, animation

我正在为我的网站开发导航系统。这个想法是在父级悬停时显示内容。

但是，当内容快速悬停时，动画是不完整的，它会在两者之间停止。

完整的工作和代码在下面的演示链接中。有关更改代码的任何建议都会有所帮助。

## 演示：http: [//jsfiddle.net/vaakash/yH9GE/](http://jsfiddle.net/vaakash/yH9GE/)

> **当“两个”箭头同时悬停时（从一个箭头快速移动到另一个箭头）它们停止并且不完整**

我使用的代码是

```
$('.anpn-wrap').mouseenter(function(){           

    $wrap = $(this);
    $txt = $(this).find('.anpn-text');
    $cnt = $(this).find('.anpn-cnt');

    $txt.hide();
    $cnt.css({ 'opacity': 0, 'margin-top': '-50px', 'width': '200px' });
    $wrap.stop().animate({ 'width': $cnt.outerWidth() });
    $cnt.show().animate({ 'opacity': 1, 'margin': 0});

});

$('.anpn-wrap').mouseleave(function(){

    $wrap = $(this);
    $txt = $(this).find('.anpn-text');
    $cnt = $(this).find('.anpn-cnt');

    $cnt.show().stop().animate({ 'opacity': 0, 'margin-top': '-50px' }, function(){
        $cnt.hide();
        $wrap.stop().animate({ 'width': $txt.outerWidth() });
        $txt.fadeIn();
    });

});​ 
```

![在此处输入图像描述](../Images/9cd31a5eb15ea8859f92b78d027ea1e7.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T16:48:08.387

通过不本地化`$wrap`,`$txt`和`$cnt`，它们将是全局的，因此如果在较早的 mouseleave 动画完成之前发生 mouseenter 事件，这些变量将被覆盖，并且第一个动画中的回调将处理其他按钮的元素。

解决方案是在两个处理程序中声明`$wrap`和with 。`$txt``$cnt``var`

试试这个：

```
$('.anpn-wrap').mouseenter(function() {
    var $wrap = $(this).stop();
    var $txt = $wrap.find('.anpn-text').hide();
    var $cnt = $wrap.find('.anpn-cnt').css({
        'opacity': 0,
        'margin-top': '-50px',
        'width': '200px'
    }).show().animate({
        'opacity': 1,
        'margin': 0
    });
    $wrap.animate({
        'width': $cnt.outerWidth()
    });
}).mouseleave(function() {
    var $wrap = $(this);
    var $txt = $wrap.find('.anpn-text');
    var $cnt = $wrap.find('.anpn-cnt').show().stop().animate({
        'opacity': 0,
        'margin-top': '-50px'
    }, function() {
        $cnt.hide();
        $wrap.stop().animate({
            'width': $txt.outerWidth()
        });
        $txt.fadeIn();
    });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T14:37:56.330

我不知道你想要什么，但你可以传递参数[`stop()`](http://api.jquery.com/stop/)来强制完成动画。

```
stop(true, true) 
```

看到这个版本：http: [//jsfiddle.net/yH9GE/2/](http://jsfiddle.net/yH9GE/2/)

# ruby-on-rails - Sunspot 只返回一个匹配项而忽略其余项？

> ID：13627985
> 
> 赞同：0
> 
> 时间：2012-11-29T14:31:02.910
> 
> 标签：ruby-on-rails, sunspot

我刚刚安装了[太阳黑子](https://github.com/sunspot/sunspot)gem

这是我的设置：

post.rb:

```
class Post < ActiveRecord::Base
  include ActionView::Helpers

  attr_accessible :title, :content, :category_id, :tag_list

  has_many :replies, dependent: :destroy

  searchable do
    text :title, boost: 5
    text :content
    text :replies do
      replies.map { |reply| reply.content }
    end
  end
  .
  .
  . 
```

**post_controller.rb：**

```
class PostsController < ApplicationController

  def index
    if signed_in?
      @search = Post.search do
        fulltext params[:search]
      end
      #@post = current_user.posts.build
      #@feed_items = current_user.feed.results.paginate(page: params[:page])
      @feed_items = @search.results
    end
    .
    .
    . 
```

**路线.rb：**

```
 resources :posts do
    resources :votes
    resources :replies
  end 
```

当我搜索帖子`:title`和`:content`. 搜索回复`:content`属性时发生了一些奇怪的事情。

我在 3 个不同的帖子中搜索了 3 个不同的术语：`scala, groovy, python`. 只是`'scala'`返回一些东西。我什至在另一篇文章中创建了另一个带有 text 的回复`'scala'`，但结果只返回了第一个。

这是输出（只有第一个返回结果）：

![在此处输入图像描述](../Images/92d8c628a675f9a729367e43c8d458aa.png)

![在此处输入图像描述](../Images/87508ef7b3ab46fe90e81324b32333f2.png)

![在此处输入图像描述](../Images/68a00a2fedb63d755151e3001be8b262.png)

这可能是什么原因造成的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T23:23:40.553

我想通了。我不得不这样做：

```
bundle exec rake sunspot:solr:reindex 
```

# regex - 用空格分割字符串，除非包含在引号中

> ID：13627986
> 
> 赞同：12
> 
> 时间：2012-11-29T14:31:06.903
> 
> 标签：regex, r, strsplit

一段时间以来，我一直试图在 R 中用双引号分割一个空格分隔的字符串，但没有成功。一个字符串的例子如下：

*降雨降雪“渠道蓄水”“小溪蓄水”*

这对我们很重要，因为这些是必须与后续数据匹配的列标题。这个网站上还有其他关于如何解决这个问题的建议，但它们似乎不适用于 R。一个例子：

[正则表达式用于在没有被单引号或双引号包围时使用空格分割字符串](https://stackoverflow.com/questions/366202/regex-for-splitting-a-string-using-space-when-not-surrounded-by-single-or-double)

这是我一直在尝试的一些代码：

```
str <- 'rainfall snowfall "Channel storage" "Rivulet storage"'
regex <- "[^\\s\"']+|\"([^\"]*)\""
split <- strsplit(str, regex, perl=T) 
```

我想要的是

```
[1] "rainfall" "snowfall" "Channel storage" "Rivulet storage" 
```

但我得到的是：

```
[1] ""  " " " " " " 
```

向量的长度是正确的（这是令人鼓舞的），但字符串当然是空的或包含一个空格。有什么建议么？

提前致谢！

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-11-29T14:54:35.430

`scan`会为你做这个

```
scan(text=str, what='character', quiet=TRUE)
[1] "rainfall"        "snowfall"        "Channel storage" "Rivulet storage" 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-29T15:09:41.917

正如 mplourde 所说，使用`scan`. 这是迄今为止最干净的解决方案（除非您想保留`\"`, 即...）

如果您想使用正则表达式来执行此操作（或无法通过 轻松解决的问题`scan`），您仍然以错误的方式看待它。您的正则表达式返回您想要的，因此如果您在您的中使用`strsplit`它，它将删除您想要保留的所有内容。

在这些情况下，您应该查看函数`gregexp`，它返回匹配的起始位置并将匹配的长度添加为属性。这个结果可以传递给函数`regmatches()`，如下所示：

```
str <- 'rainfall snowfall "Channel storage" "Rivulet storage"'
regex <- "[^\\s\"]+|\"([^\"]+)\""

regmatches(str,gregexpr(regex,str,perl=TRUE)) 
```

但是，如果您只需要字符向量作为 mplourde 的解决方案返回，那就去做吧。无论如何，这很可能就是您所追求的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-29T21:17:27.107

您可以使用 gsubfn 包中的 strapply。在 strapply 中，您可以定义匹配字符串而不是拆分字符串。

```
str <- "rainfall snowfall 'Channel storage' 'Rivulet storage'"
strapply(str,"\\w+|'\\w+ \\w+'",c)[[1]]

[1] "rainfall"          "snowfall"          "'Channel storage'" "'Rivulet storage'" 
```

# android - 当用户在 ViewPager 中的第一个和最后一个项目上滚动时如何制作 Toast？

> ID：13627987
> 
> 赞同：2
> 
> 时间：2012-11-29T14:31:09.823
> 
> 标签：android, android-viewpager

我正在尝试实现 View Pager 并取得成功。
目前我正在使用侦听器在选择页面时从数据库加载一些内容但是我不知道当用户尝试滚动超出 ViewPager 中的第一个和最后一个项目时如何祝酒。
这是我的听众

```
.setOnPageChangeListener(new OnPageChangeListener() {    

            @Override
            public void onPageSelected(int arg0) {

                getMonthdays(arg0);
                Global.setSelectedMonth(""+(currentpos+1));

            }

            @Override
            public void onPageScrolled(int arg0, float arg1, int arg2) {

            }

            @Override
            public void onPageScrollStateChanged(int arg0) {
                System.out.println(" onPageScrollStateChanged : "+arg0);

            }
        }); 
```

我认为可以使用 onPageScrollStateChanged 但我不知道该怎么做...
请帮助我，欢迎任何想法和建议

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T14:33:34.937

在以下方法中检查项目的索引

```
 @Override
        public void onPageScrolled(int arg0, float arg1, int arg2) {

        } 
```

然后如果索引是最后一个，则显示 Toast。简单的 ：）

为了检测用户的手势覆盖这个方法并做一些数学运算。

```
 @Override
public boolean onTouchEvent(MotionEvent event) {
    // TODO Auto-generated method stub
    return super.onTouchEvent(event);
} 
```

或者你可以参考[这里的代码](https://stackoverflow.com/questions/11307560/onfling-set-gesturedetector-to-all-child-views)

# python - Sublime 文本键盘映射启动“扩展”

> ID：13627993
> 
> 赞同：1
> 
> 时间：2012-11-29T14:31:54.250
> 
> 标签：python, text, editor, sublimetext2

基本上我使用 Sublime Text 2 来编辑和（希望）运行 Python 文件。不过此刻，要运行一个文件，我必须点击`Ctrl`++ ，输入至少两个字母 (P, Y) 并`Shift`点击. 然后脚本运行。我想将其分配给热键。因此，我冒险进入了 sublime-keymap 文件的世界，几乎厌倦了。`P``enter`

示例命令：

```
{ "keys": ["ctrl+v"], "command": "paste" }, 
```

我的尝试：

```
{ "keys": ["f5"], "command": "SublimeREPL: Python - RUN current file" }, 
```

有人可以告诉我我犯了什么错误吗？我怎样才能不犯那个错误？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-30T04:51:29.280

您可以按照 morphyn 的建议尝试构建系统，但我将解决使用 SublimeRepl（和键绑定）的问题。您想要的命令不是命令面板中的文本，而是实际运行的命令。快速浏览插件后，我在[此处找到](https://github.com/wuub/SublimeREPL/blob/master/config/Python/Default.sublime-commands "关联")了命令文件。此文件指定将在命令面板中显示的内容，以及选择时将运行的内容。对于您的特定情况，您将希望在用户定义的键映射中创建以下内容（可通过 访问`Preferences -> Key Bindings - User`，但我认为您已经找到了）。

```
{
    "keys": ["f5"],
    "command": "run_existing_window_command", "args":
    {
        "id": "repl_python_run",
        "file": "config/Python/Main.sublime-menu"
    }
} 
```

我自己没有运行它，但这应该可以。

希望有帮助。

# r - 使用匹配函数在 R 中的数据框中查找和替换缺失值（已关闭）

> ID：13627998
> 
> 赞同：3
> 
> 时间：2012-11-29T14:32:16.453
> 
> 标签：r

我有以下数据框

```
t <- strptime(c("2012-01-01 00:00:00","2012-01-01 01:00:00", "2012-01-01 02:00:00", "2012-01-01 05:00:00", "2012-01-01 06:00:00"), format ="%Y-%m-%d %H:%M:%S");t
d1 <- 2:6
d2 <- 15:11
dfr <- data.frame(t, d1, d2);dfr

                   t d1 d2
 2012-01-01 00:00:00  2 15
 2012-01-01 01:00:00  3 14
 2012-01-01 02:00:00  4 13
 2012-01-01 05:00:00  5 12
 2012-01-01 06:00:00  6 11 
```

您会注意到“2012-01-01 03:00:00”和“2012-01-01 04:00:00”时间的数据丢失了。

为了找出丢失的数据，我首先生成了一个正确的时间步，然后将其与下面的“t”列进行比较。

```
 t1Gen <- strptime("2012-01-01 00:00:00",format="%Y-%m-%d %H:%M:%S");
    t2Gen <- strptime("2012-01-01 06:00:00",format="%Y-%m-%d %H:%M:%S");

    tGen <- seq(t1Gen,t2Gen, 3600);tGen

"2012-01-01 00:00:00 CET" 
"2012-01-01 01:00:00 CET" 
"2012-01-01 02:00:00 CET" 
"2012-01-01 03:00:00 CET" 
"2012-01-01 04:00:00 CET" 
"2012-01-01 05:00:00 CET" 
"2012-01-01 06:00:00 CET"

mdfr <- match(tGen,dfr$t);mdfr
[1]  1  2  3 NA NA  4  5
subfr <- subset(mdfr, is.na(mdfr));subfr
[1] NA NA 
```

使用 match 函数，用“NA”挑出 2 个元素缺失。现在我的目标是用“-99”填充两个缺失的行，以表明数据丢失，生成的数据框如下所示；

```
 t d1 d2
 2012-01-01 00:00:00  2 15
 2012-01-01 01:00:00  3 14
 2012-01-01 02:00:00  3 14
 2012-01-01 03:00:00 -99-99
 2012-01-01 04:00:00 -99-99
 2012-01-01 05:00:00  5 12
 2012-01-01 06:00:00  6 11 
```

我坚持这一点，对此的任何帮助表示赞赏。PS：任何其他代码也将受到欢迎。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T14:48:00.820

你可以`merge` `dfr`和`tGen`向量（将后者变成data.frame之后）。指定`all = TRUE`允许您用 NA 填充缺失的行。

```
dfrM <- merge(dfr, data.frame(t = tGen), all = TRUE) 
```

然后确定缺少哪些值并替换为`-99`：

```
dfrM[is.na(dfrM)] <- -99

> dfrM
                    t  d1  d2
1 2012-01-01 00:00:00   2  15
2 2012-01-01 01:00:00   3  14
3 2012-01-01 02:00:00   4  13
4 2012-01-01 03:00:00 -99 -99
5 2012-01-01 04:00:00 -99 -99
6 2012-01-01 05:00:00   5  12
7 2012-01-01 06:00:00   6  11 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T14:47:17.690

您快到了！

```
dfr[subfr, -1] <-  -99   
# assumes that time is your first column, and the rest of the row gets -99 
```

* * *

如果您愿意，还可以合并几行：

```
dfr[is.na(match(tGen,dfr$t)), -1] <-  -99 
```