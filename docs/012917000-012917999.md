# StackOverflow 问答 12917000-12917999

# html - 确保页脚始终位于底部的最佳方法是什么

> ID：12917001
> 
> 赞同：0
> 
> 时间：2012-10-16T14:29:28.307
> 
> 标签：html, css, styles, footer

我有这个网站：[http ://test.tamarawobben.nl](http://test.tamarawobben.nl)

实现页脚始终位于屏幕底部的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T14:34:42.387

这取决于你所说的“总是在底部”是什么意思。有两种“始终位于底部”的页脚：固定页脚和粘性页脚。

固定页脚始终位于*浏览器窗口*的底部，而粘性页脚始终位于*页面内容或浏览器的底部，以较低者为准*。

对于粘性页脚，您可以查看[此页面上](http://ryanfait.com/sticky-footer/)的代码。对于固定页脚，您只需为其赋予以下属性：

```
#footer {
    position: fixed;
    bottom: 0px;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T14:30:55.290

页脚的 CSS

```
footer {
   position:absolute;
   bottom:0;
   width:100%;
   height:60px;   /* Height of the footer */
   background:#6cf;
} 
```

有关此的完整文章：[如何将页脚保留在页面底部](http://matthewjamestaylor.com/blog/keeping-footers-at-the-bottom-of-the-page)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-16T14:32:43.290

查看本教程以了解如何执行此操作 - [http://matthewjamestaylor.com/blog/keeping-footers-at-the-bottom-of-the-page](http://matthewjamestaylor.com/blog/keeping-footers-at-the-bottom-of-the-page)。

应该能得到你想要的东西。

# html - #test div 出现在某些图像上，而不是其他图像

> ID：12917005
> 
> 赞同：0
> 
> 时间：2012-10-16T14:29:40.007
> 
> 标签：html, css, wordpress

此页面上的文本有一个测试 div，我可以使用 CSS 重新定位。

[http://www.theshowroomonline.co.uk/clothing](http://www.theshowroomonline.co.uk/clothing)

```
 <div id="test"><a href="http://www.theshowroomonline.co.uk/product/1980s-stanley-platos-dress">1980&#8242;s Stanley Platos Dress</a></div>          
        <div class="wrapper-price">
                        <div class="entry-price">
            &pound;106.00               </div><!-- entry-price -->

                        <div class="entry-post-thumbnail">
                <a class="tcp_size-medium" href="http://www.theshowroomonline.co.uk/product/1980s-stanley-platos-dress"><img width="200" height="300" src="http://www.theshowroomonline.co.uk/wp-content/uploads/2012/10/stanley-platos-dress-front-200x300.jpg" class="attachment-medium wp-post-image" alt="stanley-platos-dress-front" title="stanley-platos-dress-front" /></a>
            </div><!-- .entry-post-thumbnail -->
                    </div><!-- .wrapper-price -->

   #tcp_shortcode_all_clothing #test {
        position: relative;
        top: 298px;
    } 
```

但是 div 似乎没有出现在其他页面上，所以我无法重新定位文本：

[http://www.theshowroomonline.co.uk/outerwear](http://www.theshowroomonline.co.uk/outerwear)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T14:37:54.097

如果您在提供的页面（http://www.theshowroomonline.co.uk/outerwear）上查看源代码，您将看到该元素实际上并未包含在 id="test" 的元素中，这似乎是您的问题您正在为这些页面使用两个不同的模板。

来自问题页面的示例：

```
<tr class="tcp_first-row">
    <td id="td-post-480" class="tcp_col tcp_4_cols tcp_col_1">
            <div id="post-480" class="post-480 tcp_product type-tcp_product status-publish hentry">
<a href="http://www.theshowroomonline.co.uk/product/vintage-gianfranco-ferre-coat">Vintage Gianfranco Ferre Coat</a>            
            <div class="wrapper-price">
                            <div class="entry-price">
                &pound;180.00               </div><!-- entry-price -->

                            <div class="entry-post-thumbnail">
                    <a class="tcp_size-medium" href="http://www.theshowroomonline.co.uk/product/vintage-gianfranco-ferre-coat"><img width="200" height="300" src="http://www.theshowroomonline.co.uk/wp-content/uploads/2012/10/gianfranco-coat-front-200x300.jpg" class="attachment-medium wp-post-image" alt="gianfranco-coat-front" title="gianfranco-coat-front" /></a>
                </div><!-- .entry-post-thumbnail -->
                        </div><!-- .wrapper-price --> 
```

与工作页面相比：

```
<tr class="tcp_first-row">
    <td id="td-post-491" class="tcp_col tcp_4_cols tcp_col_1">
            <div id="post-491" class="post-491 tcp_product type-tcp_product status-publish hentry">

                            <div id="test"><a href="http://www.theshowroomonline.co.uk/product/1980s-stanley-platos-dress">1980&#8242;s Stanley Platos Dress</a></div>          
            <div class="wrapper-price">
                            <div class="entry-price">
                &pound;106.00               </div><!-- entry-price -->

                            <div class="entry-post-thumbnail">
                    <a class="tcp_size-medium" href="http://www.theshowroomonline.co.uk/product/1980s-stanley-platos-dress"><img width="200" height="300" src="http://www.theshowroomonline.co.uk/wp-content/uploads/2012/10/stanley-platos-dress-front-200x300.jpg" class="attachment-medium wp-post-image" alt="stanley-platos-dress-front" title="stanley-platos-dress-front" /></a>
                </div><!-- .entry-post-thumbnail -->
                        </div><!-- .wrapper-price --> 
```

也就是说，如上所述，您确实需要将其切换`id="test"`为`class="test"`ID 应该是页面唯一的。

# entity-framework-5 - 忽略 OnModelCreating 中的属性

> ID：12917006
> 
> 赞同：2
> 
> 时间：2012-10-16T14:29:44.947
> 
> 标签：entity-framework-5, fluent-interface, navigation-properties

我正在尝试在 Entity Framework 5.0 中使用有界 (Db) 上下文，但在从特定上下文中包含的类之一中排除属性时遇到问题。这是信息（为简洁起见，我将缩短）

BaseContext.cs

```
public class BaseContext<TContext> : DbContext where TContext : DbContext
{
    static BaseContext()
    {
        Database.SetInitializer<TContext>(null);
    }

    protected BaseContext()
        : base("name=Development")
    {

    }
} 
```

IContext.cs

```
public interface IContext : IDisposable
{
    int SaveChanges();
    void SetModified(object entity);
    void SetAdded(object entity);
} 
```

ISuiteContext.cs

```
public interface ISuiteContext : IContext
{
    IDbSet<Organizations> Organizations { get; set; }
    ...
} 
```

SuiteContext.cs

```
public class SuiteContext : BaseContext<SuiteContext>, ISuiteContext
{
    public IDbSet<Organizations> Organizations { get; set; }
    ...
    ...

    protected override void OnModelCreating(DbModelBuilder modelBuilder)
    {
        modelBuilder.Configurations.Add(new OrganizationsConfiguration());
        ...
        ...

        modelBuilder.Ignore<Colors>();
    }
} 
```

组织.cs：

```
public class Organizations
{
    public Organizations()
    {
        Colors = new List<Colors>();
        ...
        ...
    }

    public int Organization_ID { get; set; }
    public string Name { get; set; }
    public string Address_1 { get; set; }
    public string Address_2 { get; set; }
    public string City { get; set; }
    public string State { get; set; }
    public string ZipCode { get; set; }

    public ICollection<Colors> Colors { get; set; }
    ...
    ...
} 
```

组织配置.cs：

```
public class OrganizationsConfiguration : EntityTypeConfiguration<Organizations>
{
    public OrganizationsConfiguration()
    {
        ToTable("Organizations");

        HasKey(o => o.Organization_ID);

        ...
        ...
        HasMany(o => o.Colors);
    }
} 
```

我如何使用（Web API 测试项目）

```
public class ValuesController : ApiController
{
    private readonly IUnitOfWork _uow;
    private readonly IOrganizationRepository _orgRepo;

    public ValuesController()
    {
        _uow = new UnitOfWork<SuiteContext>(new SuiteContext());
        _orgRepo = new OrganizationRepository(_uow);
    }

    // GET api/values
    public IEnumerable<Organizations> Get()
    {
        return _orgRepo.RetrieveAll().AsEnumerable();
    }
} 
```

以及正在发生的异常：

> 导航属性“颜色”不是“组织”类型上声明的属性类型。验证它没有从模型中排除，并且它是一个有效的导航属性

我想要的只是让“SuiteContext”能够访问组织，但不能访问子项（颜色和其他一些）

我错过了什么？也许我错误地解释了异常？

* * *

***更新#1***

我试过（没有成功 - 同样的例外）：

```
modelBuilder.Entity<Organizations>().Ignore(o =>o.Colors);

modelBuilder.Ignore<Colors>(); 
```

***更新#2***

我似乎与`OrganizationsConfiguration.cs`类和`HasMany()`方法有关。如果我取出`HasMany(o => o.Colors)`，那么我可以按照我的意图忽略类/属性。但是，这也会导致数据库创建在重新创建时失败。如果我这样做该死，如果我不这样做该死！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T14:52:04.030

看起来您忽略了该类，但您还需要忽略该属性。

```
Ignore(o => o.Colors); 
```

我之前忽略了应用程序中的标量属性（并且在您看到的视频中这样做了:)）但没有忽略导航属性，所以我只是测试以确保模型构建器对此感到满意。它是。但是您应该只做一些集成测试，以确保它在您的应用程序中按预期工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-01-15T18:18:14.890

我知道这是一篇旧帖子，您可能已经弄清楚了，尽管这可能对其他人有所帮助。在`Ignore`1-1 场景中效果很好。1-Many 是问题所在。

在上面的示例中，您需要执行以下操作：

```
 modelBuilder.Ignore<ICollection<Color>>(); 
```

# ios - Icecast流源客户端iOS

> ID：12917011
> 
> 赞同：1
> 
> 时间：2012-10-16T14:30:04.153
> 
> 标签：ios, core-audio, audio-streaming, icecast

我想使用 iPhone 作为 ICEcast 流的音频源。

1) AudioQueueInputCallback 是我应该发送这个流的地方吗？

2）我已经能够识别ICEcast [Icecast 2的协议：协议描述，使用C＃流式传输](https://stackoverflow.com/questions/5215019/icecast-2-protocol-description-streaming-to-it-using-c-sharp/9985297#9985297) 但是，我不确定如何在回调代码中执行此操作（即如何发送二进制音频）

更新

```
static void MyAQInputCallback( void *inUserData, 
  AudioQueueRef inQueue,
  AudioQueueBufferRef inBuffer,
  const AudioTimeStamp *inStartTime,
  UInt32 inNumPackets,
  cont AudioStreamPacketDescription *inPacketDesc)
{

    if (inNumPackets > 0)
    {
       // instead of
       //     AudioFileWritePackets(someFile, FALSE, 
       //           inBuffer->mAudioDataByteSize,
       //           inPacketDesc, recordPacketNumber, 
       //           &inNumPackets, inBuffer->mAudioData);

       // I want to send to http://myicecastserver
       // instead
    }

} 
```

更新

我将打开与我的 icecast 服务器的套接字连接以发送数据。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T16:41:17.020

这是一个不平凡的问题。您提到的“协议”只是一些嗅探几个数据包并做出一些猜测的人。如果您检查 ICES 源代码，您可以看到发送到 Icecast 服务器的实际方法，它是一个高度复杂的自定义流协议。相关代码位于两个文件中：stream.c 和 stream_shared.c 假设您的流已经编码为 PCM。为了了解这种流算法的复杂性，下面是来自发送方的一小段摘录：

```
 else if (sdsc->enc)
    {
        ogg_page og;
        int be = (sdsc->input->subtype == INPUT_PCM_BE_16)?1:0;
        int ret=1;

        /* We use critical as a flag to say 'start a new stream' */
        if(buffer->critical)
        {
            if(sdsc->resamp) {
                resample_finish(sdsc->resamp);
                encode_data_float(sdsc->enc, sdsc->resamp->buffers,
                        sdsc->resamp->buffill);
                resample_clear(sdsc->resamp);
                sdsc->resamp = resample_initialise (sdsc->stream->channels,
                        sdsc->stream->resampleinrate, sdsc->stream->resampleoutrate);
            }
            encode_finish(sdsc->enc);
            while(encode_flush(sdsc->enc, &og) != 0)
            {
                if ((ret = stream_send_data(sdsc, og.header, og.header_len)) == 0)
                    return 0;
                if ((ret = stream_send_data(sdsc, og.body, og.body_len)) == 0)
                    return 0;
            }
            encode_clear(sdsc->enc);

            if(sdsc->input->metadata_update)
            {
                vorbis_comment_clear(&sdsc->vc);
                vorbis_comment_init(&sdsc->vc);

                sdsc->input->metadata_update(sdsc->input->internal, &sdsc->vc);
            } 
```

正如我所说，这只是代码的 10% 左右。字面上有页面和页面的错误检查、元数据传输等。如果你想创建一个自定义的 Icecast 源客户端，你必须复制所有这些代码，将其移植到你的程序，然后将你的输入编码为 PCM，然后打包它用于传递给 stream.c 和 stream_shared.c 中的例程。

# php - 在循环外使用包含查询结果的 php 变量

> ID：12917013
> 
> 赞同：1
> 
> 时间：2012-10-16T14:30:07.140
> 
> 标签：php, variables

我有一个 PHP 循环，其中包含循环内的查询我设置了两个变量以包含某些结果，然后我想在循环外使用这些变量。但是，当我这样做时，它们只是返回未定义。代码如下：

```
<?php 
$standardresult = mssql_query("SELECT Price FROM Extras WHERE ExtraID = 5 ");

while ($standardrow = mssql_fetch_array($standardresult )) { 
    $toughresult = mssql_query("SELECT Price FROM Extras WHERE ExtraID = 6 ");

    while ($toughrow = mssql_fetch_array($toughresult)) {
        $toughprice = $toughrow['Price'];
        $standardprice = $standardrow['Price'];
        echo $standardrow['Price'];
        echo $toughrow['Price'];
        ?>

        <td align="center">
            <input type="radio" name="triple" value="yes" onclick="showPrice('<?php echo $standardrow['Price']; ?>','<?php echo $toughrow['Price']; ?>')" /> yes
        </td>
        <td>&nbsp;</td>
        <td align="center">
            <input type="radio" name="triple" value="no" onclick="showPrice('0','0')" checked="checked" /> no
        </td>

        <?php 
    } 
} 
?>

</tr>
</table>

<input type="hidden" name="ToughPrice" value="<?php echo $toughprice; ?>" />
<input type="hidden" name="StanPrice" value="<?php echo $standardprice; ?>" /> 
```

有问题的变量是 $toughprice 和 $standardprice。谁能告诉我哪里出错了，或者如果可能的话？感谢您的任何帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-16T14:37:07.423

```
$standardresult = mssql_query("SELECT Price FROM Extras WHERE ExtraID = 5 ");
while ($standardrow = mssql_fetch_array($result)) { 

$toughresult = mssql_query("SELECT Price FROM Extras WHERE ExtraID = 6 ");
while ($toughrow = mssql_fetch_array($result)) { 
```

？？？我想应该是

```
$standardresult = mssql_query("SELECT Price FROM Extras WHERE ExtraID = 5 ");
while ($standardrow = mssql_fetch_array($standardresult)) { 

$toughresult = mssql_query("SELECT Price FROM Extras WHERE ExtraID = 6 ");
while ($toughrow = mssql_fetch_array($toughresult)) { 
```

也许它会有所作为......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-16T14:35:53.267

除了值未定义的标签之外，您还有其他输出吗？如果不是，则您的查询之一没有返回结果，并且您从未在 while 语句之外定义变量。

在 java 中，您甚至会遇到这种方法的语法错误，因为您在这里所做的事情并不可靠。执行完最后的 while 语句后，您对变量的期望是什么？只有您通过查询收到的可能条目集中的最后一个条目？如果您不希望超过一行，则不需要 WHILE，只需获取第一个结果。我不知道“LIMIT 1”的 MSSQL 语句——但这也有帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-16T14:36:07.737

您的代码看起来不错，但是您犯了逻辑错误-`while`如果**没有**更多数据分配给您的`$toughresult`. 所以一旦循环结束，`$toughresult`不包含任何可用数据：

> 成功时返回 MS SQL 结果资源，如果没有返回行，则返回 TRUE，错误时返回 FALSE。

因此，只需`var_dump($toughresult);`验证这一点。如果你想使用你的数据，要么打破循环，要么将你的数据复制到另一个不会被覆盖的变量中。

为避免将来出现此类问题，请始终确保您检查手册以获取可能的返回值，并确保您的代码正确处理它，包括。边缘情况。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-16T14:49:13.880

`undefined`表示使用的变量未初始化。如果代码从未通过您的第二个`$toughprice`循环，那将是正确的 。从页面上呈现的 html 可以明显看出这一点，因为不应创建动态创建的（在本例中为 s ）。`$standardprice``while``html``td`

根据您的代码，在以下情况下会出现这种情况：

1.  第一个查询不返回任何结果或
2.  第一个查询确实返回了一些结果，但第二个查询没有。

因此，调试这些查询以查看问题所在。

PS：我不确定你为什么使用两个嵌套`while`循环，内部不需要来自外部的数据。您有两个可以相互独立的静态查询。如果由于某种原因您需要对第一个循环的每个项目进行迭代第二个循环的结果，请在执行数据库查询*后执行。*现在第二个查询 N 次得到*相同*的结果（N 是第一个查询的行）

最后，如果由于某种原因没有任何结果是预期的情况，则在循环*之前*`while`初始化变量以消除`undefined`错误

例如：

```
<?php  
$toughprice = 0; // default value
$standardprice = 0; //default value

... 
while (...) {  
    while (...) { 
        $toughprice = ...        
        $standardprice = ... 
    }
}
...

<input type="hidden" name="ToughPrice" value="<?php echo $toughprice; ?>" /> 
<input type="hidden" name="StanPrice" value="<?php echo $standardprice; ?>" /> 
```

# javascript - Zepto 活动

> ID：12917020
> 
> 赞同：2
> 
> 时间：2012-10-16T14:30:24.523
> 
> 标签：javascript, zepto

我是 Zepto 的新手，我正在尝试做一些非常简单的事情，但似乎我无法尝试任何方式。我正在尝试将函数绑定到 Zepto 中的单击事件，但即使未触发该事件，该函数也会被执行......

这是我的 js 文件的内容：

```
$(document).ready(function() {

    if (!$('.page').hasClass('.current')) {
        $('#home').addClass('current');
        $('.page .content').css('display', 'none');
    $('#home .content').css('display', 'block');
}

$('#menu-trigger').on('click', switchPage('search', 'fade'));

function switchPage(pageID,switchType) {
    oldPageID = '#' + $('.page.current').attr('id');
    newPageID = '#' + pageID;
    if(switchType =='fade') { // Fade Effect
        // $(oldPageID).hide();
        alert('done');
    }
}
}); 
```

问题是该函数在我重新加载 html 后立即执行，而不是等待“点击”事件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T03:21:33.373

区别在于指定哪个对象将用作回调，以及让函数实际执行并将该返回值指定为回调。

您的代码应为：

```
$('#menu-trigger').on('click', switchPage);
function switchPage(pageID,switchType) {
    oldPageID = '#' + $('.page.current').attr('id');
    newPageID = '#' + pageID;
    if(switchType =='fade') { // Fade Effect
        // $(oldPageID).hide();
        alert('done');
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T14:32:38.283

当您只使用`switchPage('search', 'fade')`JS 评估函数并尝试设置它的返回值时，请改用它。

```
 $('#menu-trigger').on('click', function () { switchPage('search', 'fade') }); 
```

如果你使用没有参数的函数，你可以使用

```
 $('#menu-trigger').on('click', switchPage ); 
```

# perl - 在 perl 中使用嵌套映射是一种好习惯吗？

> ID：12917022
> 
> 赞同：1
> 
> 时间：2012-10-16T14:30:29.080
> 
> 标签：perl, map, weak-typing

```
my @c= map {
        my $v=$_;
        map {$_ * $v } @m
} @a; 
```

像这样使用`map`是一种好习惯吗？为什么不？如果没有，还有什么其他方法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-16T14:35:01.897

我无法回答这是否是好的做法。一般来说，在很多情况下，我会大量使用嵌套地图。它很简短，简明扼要。

然而，这样的嵌套地图总是有变得有点太大和笨拙的危险，在这种情况下它们变得比它们必须的更难阅读（`$_`在这种情况下哪个列表确实指的是！？）。所以使用它们，是的，但要谨慎使用——就像所有其他使 Perl 如此简洁和富有表现力的类似事物一样。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-16T14:33:42.820

我不确定你是什么意思。它会很好地工作，还是您在询问可读性？`map`与等效的 foreach 循环相比，读取 long 可能更难。

```
my @c;
for my $v (@a) {
   push @c, map { $_ * $v } @m;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-16T15:43:00.270

`map`对于指挥部，我总​​是有复杂的感觉。使用 . 有很多陷阱`map`，这是让 Python 人幸灾乐祸的原因之一。 Perl 是多么不可读。此外，它`map`并没有比使用常规循环更有效。

当 map 修改 的值时有一个[陷阱](http://search.cpan.org/~thaljef/Perl-Critic-1.118/lib/Perl/Critic/Policy/ControlStructures/ProhibitMutatingListFunctions.pm)`$_`， 因为它实际上只是原始数组中值的别名。Modify `$_`，然后您修改原始数组。也许这就是您想要的，但是该`map`命令可能会掩盖这一点。[Perl Monks](http://perlmonks.org/index.pl?node_id=743445)中有一个关于`map`.

即使您对 inside 的使用`map`确实`map`有效（确实为您`map`本地化，因此in与另一个不同），也存在可读性和可维护性的问题。`$_``$_``map``$_``map`

仅在用法`map`清晰且易于理解上下文时使用。保存电子邮件签名的聪明 Perl 技巧。我不会使用地图内地图。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-16T15:58:43.603

嵌套`map`与任何其他嵌套结构具有相同的问题和相同的解决方案，除了因需要重新分配而略微放大`$_`。嵌套不流动的事实`map`是代码异味：您的代码试图告诉您应该稍微不同的结构。

适当的更改是将内部操作变成函数调用，这样读者就不必同时跟踪两个作用域。在这种情况下，您会得到：

```
sub scale {
    my ($factor, @numbers) = @_;

    return map { $factor * $_ } @numbers;
}

my @c = map { scale($_, @m) } @a; 
```

# java - 使用 Java 小程序裁剪从网络摄像头拍摄的图像

> ID：12917028
> 
> 赞同：3
> 
> 时间：2012-10-16T14:30:45.597
> 
> 标签：java, image, applet, resizable

我的要求如下。

> 使用网络摄像头拍摄照片并提供编辑按钮以使用可调整大小的矩形裁剪和保存图像。

我已经完成了网络摄像头的编码并使用小程序拍摄了照片并成功保存了图像。但是很难使用可调整大小的矩形来启用编辑功能。我可以使用 Jcrop、jquery 进行裁剪，但问题是如何将图像从 applet 获取到 JSP。

或者有什么方法可以使用 Applet 本身来使用矩形裁剪图像。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-16T19:36:54.013

就像是...

![在此处输入图像描述](../Images/875747c15ad981e39b71b2246b46af51.png)

```
public class ResizeCrop {

    public static void main(String[] args) {
        new ResizeCrop();
    }

    public ResizeCrop() {
        EventQueue.invokeLater(new Runnable() {
            @Override
            public void run() {
                try {
                    UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
                } catch (ClassNotFoundException ex) {
                } catch (InstantiationException ex) {
                } catch (IllegalAccessException ex) {
                } catch (UnsupportedLookAndFeelException ex) {
                }

                JFrame frame = new JFrame();
                frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                frame.setLayout(new BorderLayout());
                frame.add(new CropPane());
                frame.pack();
                frame.setLocationRelativeTo(null);
                frame.setVisible(true);
            }
        });
    }

    public class CropPane extends JPanel {

        private BufferedImage background;
        private Rectangle cropBounds;

        public CropPane() {
            try {
                background = ImageIO.read(new File("/Users/swhitehead/Dropbox/MT008.gif"));
            } catch (IOException exp) {
                exp.printStackTrace();
            }

            MouseHandler handler = new MouseHandler();

            addMouseListener(handler);
            addMouseMotionListener(handler);
        }

        @Override
        public Dimension getPreferredSize() {
            return new Dimension(background.getWidth(), background.getHeight());
        }

        protected Rectangle getCropBounds() {
            Rectangle actualBounds = null;
            if (cropBounds != null) {
                int x = cropBounds.x;
                int y = cropBounds.y;
                int width = cropBounds.width;
                int height = cropBounds.height;

                if (width < 0) {
                    x += width;
                    width -= (width * 2);
                }
                if (height < 0) {
                    y += height;
                    height -= (height * 2);
                }

                actualBounds = new Rectangle(x, y, width, height);
                System.out.println(actualBounds);
            }
            return actualBounds;
        }

        @Override
        protected void paintComponent(Graphics g) {

            super.paintComponent(g);

            Graphics2D g2d = (Graphics2D) g.create();
            if (background != null) {
                int x = (getWidth() - background.getWidth()) / 2;
                int y = (getHeight() - background.getHeight()) / 2;
                g2d.drawImage(background, x, y, this);
            }

            Rectangle drawCrop = getCropBounds();
            if (drawCrop != null) {
                Color color = UIManager.getColor("List.selectionBackground");
                g2d.setColor(color);
                Composite composite = g2d.getComposite();
                g2d.setComposite(AlphaComposite.getInstance(AlphaComposite.SRC_OVER, 0.5f));
                g2d.fill(drawCrop);
                g2d.setComposite(composite);
                g2d.draw(drawCrop);
            }
        }

        public class MouseHandler extends MouseAdapter {

            @Override
            public void mouseReleased(MouseEvent e) {
                cropBounds = null;
                repaint();
            }

            @Override
            public void mousePressed(MouseEvent e) {
                cropBounds = new Rectangle();
                cropBounds.setLocation(e.getPoint());
                repaint();
            }

            @Override
            public void mouseDragged(MouseEvent e) {
                if (cropBounds != null) {
                    Point p = e.getPoint();
                    int width = p.x - cropBounds.x;
                    int height = p.y - cropBounds.y;
                    cropBounds.setSize(width, height);
                    repaint();
                }
            }
        }
    }
} 
```

或者你可以有一个倒置的选择......

![在此处输入图像描述](../Images/af507ce730e506882d0c026f80828257.png)

只需用这个替换选择油漆代码（在`paintComponent`方法中）......

```
Rectangle drawCrop = getCropBounds();
if (drawCrop != null) {

    Area area = new Area(new Rectangle(0, 0, getWidth() - 1, getHeight() - 1));
    area.subtract(new Area(drawCrop));

    Color color = UIManager.getColor("List.selectionBackground");
    g2d.setColor(color);
    Composite composite = g2d.getComposite();
    g2d.setComposite(AlphaComposite.getInstance(AlphaComposite.SRC_OVER, 0.5f));
    g2d.fill(area);
    g2d.setComposite(composite);
    g2d.draw(area);
} 
```

这里的重要部分是不要使用该`cropBounds`字段，您必须调用`getCropBounds`它来纠正负矩形；）

代码示例清除了裁剪`mouseRelease`，但您可以保留矩形，直到用户执行其他操作，例如双击...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-16T15:26:18.633

`BufferedImage`您可以通过以下方式从现有图像中裁剪矩形图像：

```
BufferedImage newImage = image.getSubimage(x, y, width, height); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-21T05:40:37.600

你只需要 3 个支持语句来裁剪图像

```
/* Arpana */

import java.awt.Graphics;
import java.awt.Image;  
import java.awt.event.MouseEvent;
import java.awt.event.MouseListener;
import java.awt.image.CropImageFilter;
import java.awt.image.FilteredImageSource;
import java.awt.image.ImageFilter;
import java.awt.image.ImageProducer;
import java.awt.*;
import java.applet.*;

/*
<applet code="CropImg" width=1024 height=768>
</applet>
*/

public class CropImg extends Applet implements MouseListener
{
      private static final long serialVersionUID = 1L;
      Image img;
      Image crop;
      boolean cropped;
      public void init()
        {
            //setSize(880, 660);
            img = getImage(getCodeBase(), "Appu.jpg");
            addMouseListener(this);

        }

     public void mouseClicked(MouseEvent e) 
     {
         int x = getX();
        int y = getY();

        if (cropped)
        {
            cropper(x, y);
        }
        else
        {
            cropped = false;
        }
        repaint();

    }
    public void cropper(int x, int y)
     {

        if(x < 500)
        {
            x = 200;
        }
        if(x > 500)
        {
            x = 500;
        }
        if(y < 500)
        {
            y = 200;
        }
        if(y > 500)
        {
            y = 500;
        }
    //420,330
        int cropX, cropY;
        cropX = x; //-1024;
        cropY = y; //- 768;
        ImageFilter imgF = new CropImageFilter(500, 500, 120, 439);
        ImageProducer imgP = new FilteredImageSource(img.getSource(), imgF);
        crop = createImage(imgP);  
    }   
    public void mouseEntered(MouseEvent e) 
    {  

    }

    public void mouseExited(MouseEvent e) 
             {
             }

    public void mousePressed(MouseEvent e) 
    {

    }

    public void mouseReleased(MouseEvent e) 
    {        
    }
    public void paint(Graphics g)
    {
            //x = getX();
            //y = getY();

            if(cropped)
            {
                g.drawImage(crop,200,200, 100, 100, this);

            }
          else
            {
                g.drawImage(img,100,100, 880, 660, this);
            }

        }

    } 
```

# mysql - 使用两列选择随机条目

> ID：12917029
> 
> 赞同：3
> 
> 时间：2012-10-16T14:30:46.513
> 
> 标签：mysql, random

我创建了一个竞赛，推荐他人的人每次推荐都会增加获胜的几率。现在我必须弄清楚如何使用 mysql 或 php 来实际给他们更好的机会。选择随机行不会削减它。

在我的表中，我有两列，一列用于 ID，一列用于推荐 ID。该表通过将 ID 添加到推荐 ID 字段来跟踪谁推荐了谁，因此前几行数据如下所示：

```
name   id  referralid 
mark   15   20 
ted    20 
jim    22   20 
```

所以'ted'应该有3次获胜的机会，因为他推荐了另外两个人。如何在 mysql 或 php 中执行此操作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T14:38:11.690

```
SELECT people.name, people.id
FROM people
LEFT JOIN people referred_people ON referred_people.referralid = people.id
ORDER BY RAND()
LIMIT 1 
```

假设你的桌子被称为*people* this selects

```
mark
ted
ted
jim 
```

使用臭名昭著的 ORDER BY RAND() 构造随机排序（速度慢，但您没有要求最高性能），然后从该列表中选择一个结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T14:36:15.097

```
select a.name,b.Odds
from (select referralid,count(1) Odds from    yourtable
group by referralid) b inner join yourtable a
on a.id=b.referralid 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-16T14:36:28.057

尝试这个：：

为什么不获取一个随机数并获取该数字的行，然后该行中的referid 指向的 id 将获胜。

说有了这个给定的数据，说随机数如果生成 1 或 3。你会在这两行中都指出。

# c# - 当前上下文中不存在名称“changetype”

> ID：12917032
> 
> 赞同：0
> 
> 时间：2012-10-16T14:30:51.347
> 
> 标签：c#, asp.net, gridview

我是 ASP.net /c# 编码的新手。我的用户控件中有一个带有此列的 Gridview

```
<asp:TemplateField HeaderText="Parameter Order">
     <ItemTemplate>
        <asp:Label ID="orderlbl" runat="server"  Text='<%# changetype(Eval("PARAM_ORDER")) %>' ></asp:Label>

     </ItemTemplate>
</asp:TemplateField> 
```

param_order 是 int。我已将 cs 文件中的 Changetype 定义为

```
public string changetype(object order)
{
    string lcResult = "";
    int itemOrder = (int)order;
    lcResult = itemOrder.ToString().TrimEnd();
    return lcResult;
} 
```

但我收到上述错误消息。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T14:35:28.747

尝试这样做：

```
((Label)e.Item.FindControl("orderlbl")).Text= changetype(Eval("PARAM_ORDER")); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T14:39:15.810

将您的程序更改为受保护

```
protected string changetype(object order) 
{ 
    string lcResult = ""; 
    int itemOrder = (int)order; 
    lcResult = itemOrder.ToString().TrimEnd(); 
    return lcResult; 
} 
```

# php - AJAX、PHP 数据库查找

> ID：12917033
> 
> 赞同：0
> 
> 时间：2012-10-16T14:30:51.813
> 
> 标签：php, ajax, database

目前我有一个表单，当用户输入数据时，此代码会调用另一个页面来检查用户名是否正在使用中。这是调用数据库页面（test.php）的主页中的代码

```
<script type="text/javascript">
function showHint(str)
{
if (str.length==0)
  { 
  document.getElementById("txtHint").innerHTML="";
  return;
  }
if (window.XMLHttpRequest)
  {// code for IE7+, Firefox, Chrome, Opera, Safari
  xmlhttp=new XMLHttpRequest();
  }
else
  {// code for IE6, IE5
  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
  }
xmlhttp.onreadystatechange=function()
  {
    if (xmlhttp.readyState==4 && xmlhttp.status==200)
    {
        document.getElementById("txtHint").innerHTML=xmlhttp.responseText;
        if (xmlhttp.responseText.indexOf("green") != -1) {
            document.getElementById("submit").disabled = false;
        } else {
            document.getElementById("submit").disabled = true;
        }
    }
  }
xmlhttp.open("GET","test.php="+str,true);
xmlhttp.send();
}
</script> 
```

我想改变这一点，所以当它调用 test.php 时，它会根据用户输入的表单字段向 test.php 传递一个值。

这样我就可以使用 test.php 根据用户填写的表单字段来执行不同的数据库查找。

任何人都可以帮忙吗？谢谢 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T14:49:03.910

一个带有 Javascript jQuery ajax 函数的例子。当用户单击 id="myButton" 的组件时，可以调用此函数：

```
$(document).ready(function() {
    $('#myButton').click(function() {

        var myValue = $('#myInput').attr('value');

        var request = $.ajax({
            url: "test.php",
            type: "GET",
            data: {
                myInput : myValue
            },
            dataType: "json"
        });

        request.done(function(msg) {
            alert( "Request done: " + msg);
        });

        request.fail(function(jqXHR, textStatus) {
            alert( "Request failed: " + textStatus );
        });
    });
}); 
```

在这个示例中，您可以从**id = "myInput"**的 texfield 中获取值，并通过**GET**调用将其传递给**test.php**页面。

在 test.php 页面中，您可以简单地使用以下方法获取值：

```
$_GET['myInput']; 
```

只有一个提示：你的 test.php 必须返回一个[json](http://www.w3schools.com/json/default.asp)类型。

# javascript - D3.js 对力导向图使用什么算法？

> ID：12917037
> 
> 赞同：13
> 
> 时间：2012-10-16T14:30:56.863
> 
> 标签：javascript, algorithm, d3.js, graph-algorithm, force-layout

我很想知道 D3 使用什么算法来实现库中的力导向图功能。阅读[了 Kobourov](http://www.cs.brown.edu/~rt/gdhandbook/chapters/force-directed.pdf)对力导向图历史的总结后，我对图书馆中使用的确切算法或方法（算法/启发式的组合）有点困惑。

D3 [API 参考](https://github.com/mbostock/d3/wiki/Force-Layout)说 Barnes-Hut 算法用于计算作用在物体上的电荷，一个 O(N*log(N)) 操作。Kobourov 的文章提到 Quigley-Eades 算法和 Hu 的算法是利用 Barnes-Hut 的多级算法。其中一个是否在 D3 中以某种方式使用？

API wiki 进一步说 Verlet 集成用于粒子定位。[源代码](https://github.com/mbostock/d3/blob/master/src/layout/force.js)中提到了 Gauss-Seidel 算法，在[Hu 的算法](http://www.mathematica-journal.com/issue/v10i1/contents/graph_draw/graph_draw.pdf)和 Dwyer 的[图形布局论文](http://www.csse.monash.edu.au/~tdwyer/Dwyer2009FastConstraints.pdf)中都提到了该算法。我想我正在寻找答案的问题是 D3 使用的“综合”算法；Kobourov 的文章列出了几个和 D3 强制导向功能似乎并不直接适合其中任何一个。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-05-13T09:35:51.833

在最初的[d3 论文](http://vis.stanford.edu/papers/d3)中，Mike Bostock & al. 写道 Dwyer 的实现用于力图布局：

> 力布局结合了物理模拟和迭代约束松弛 [7] 以实现稳定的图形布局。
> 
> [7] T.德怀尔。可扩展、通用且简单的受限图形布局。在 EuroVis，2009 年。

有关更多信息，[Dwyer 的论文](http://www.csse.monash.edu.au/%7Etdwyer/Dwyer2009FastConstraints.pdf)详细描述了整个算法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-14T02:08:07.420

好吧，这不是您具体问题的答案，但在他[的强制导向布局演示页面上](http://bl.ocks.org/4062045)，他说，“布局算法灵感来自[Tim Dwyer](http://www.csse.monash.edu.au/~tdwyer/)和[Thomas Jakobsen](http://web.archive.org/web/20080410171619/http://www.teknikus.dk/tj/gdc2001.htm)。”

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-10-28T10:22:29.357

可以在 [https://github.com/mbostock/d3/wiki/Force-Layout找到 Force-Layout 算法的概述](https://github.com/mbostock/d3/wiki/Force-Layout)

# android - 如何在 Android 文本视图中显示带底点的字母？

> ID：12917043
> 
> 赞同：2
> 
> 时间：2012-10-16T14:31:10.343
> 
> 标签：android, unicode, fonts, textview

据我所知，Android 中的印度字体（如梵文）存在很大问题。所以我想到使用[IAST](http://en.wikipedia.org/wiki/International_Alphabet_of_Sanskrit_Transliteration)来避免使用梵文。但也有一些带底点的字母（如ṃ 或ḥ）。我猜它们是 unicode，因为每个文本编辑器都可以轻松地显示它们。但我的文本视图没有。我应该怎么办？

**更新：**解决方案是使用 DejaVu 字体或任何其他具有完整 UNICODE 支持的字体集。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T17:44:12.177

您需要使用自定义字体，因为普通的 Android 字体不支持梵文或下面带有点的 m。参见例如[Android 中的自定义字体](https://stackoverflow.com/questions/3203694/custom-fonts-in-android/3203724#3203724)。

请注意，没有字体支持所有 Unicode。您需要选择一个支持您需要的字符。

# javascript - dhtmlxGrid 智能渲染不发送参数

> ID：12917045
> 
> 赞同：0
> 
> 时间：2012-10-16T14:31:23.053
> 
> 标签：javascript, request, dhtmlx

我正在尝试使用 dhhtmlxGrid 并激活他的智能渲染。这是我的js代码

```
function grid()
{
    var mygrid = new dhtmlXGridObject('products_grid');
    mygrid.setImagePath("codebase/imgs/");
    mygrid.setHeader("Product Name,Internal Code,Price");
    mygrid.setInitWidths("*,150,150");
    mygrid.setColAlign("left,left,right");
    mygrid.setSkin("modern");
    mygrid.init();
    mygrid.enableSmartRendering(true);
    mygrid.load("PrendiTutto", "json");
} 
```

在我的 html 中，我有一个启动应用程序的标签，并且“PrendiTutto”是一个能够从我的数据库中读取的 servlet。我的问题是，当 mygrid.load("PrendiTutto", "json") 启动时，没有参数传递给我的 servlet，而我知道 smartRendering 使用“count”和“posStart”参数。谁能帮我？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T10:41:13.023

有一个该死的文件：dhtmlxgrid_json.js，在 dhtmlx 指南和示例中没有提到。我已经添加了它，现在一切都运行良好..

# jpa - Hyperjaxb/JPA：通过 id 而不是值引用实体

> ID：12917048
> 
> 赞同：1
> 
> 时间：2012-10-16T14:31:27.327
> 
> 标签：jpa, orm, openjpa, hyperjaxb

免责声明 #1：我对 XSD、数据库和 JPA 还很陌生——所以我的问题可能是荒谬的。

我有一个通过 XSD 指定的接口——我将接收 XML 文档并且需要将它们的内容保存到关系数据库中。我修改 XSD 的能力有限。接口本身由大量关系复杂的实体组成；有许多地方不希望在 XML 文档中要求完整的对象图。

本质上，我的 XSD 目前看起来像这样：

```
<xsd:schema 
     xmlns:xsd="http://www.w3.org/2001/XMLSchema"
     xmlns:jxb="http://java.sun.com/xml/ns/jaxb" 
     xmlns:hj="http://hyperjaxb3.jvnet.org/ejb/schemas/customizations"     
     xmlns:orm="http://java.sun.com/xml/ns/persistence/orm"                                                       
     xmlns:ns1="urn:foo"
     targetNamespace="urn:foo" elementFormDefault="qualified" jxb:version="2.0"
     jxb:extensionBindingPrefixes="hj orm">
     <xsd:complexType name="Foo">
        <xsd:sequence>
            <xsd:element name="fooId" type="xsd:string" nillable="false">
                <xsd:annotation>
                    <xsd:appinfo>
                        <hj:id />
                    </xsd:appinfo>
                </xsd:annotation>
            </xsd:element>
        </xsd:sequence>
     </xsd:complexType>
     <xsd:complexType name="Bar">
        <xsd:sequence>
            <xsd:element name="BarId" type="xsd:string" nillable="false">
                <xsd:annotation>
                    <xsd:appinfo>
                        <hj:id />
                    </xsd:appinfo>
                </xsd:annotation>
            </xsd:element>
            <xsd:element name="associatedFoo" type="xsd:string" nillable="false">
            </xsd:element>
        </xsd:sequence>
     </xsd:complexType>
     <xsd:complexType name="Baz">
        <xsd:sequence>
            <xsd:element name="BazId" type="xsd:string" nillable="false">
                <xsd:annotation>
                    <xsd:appinfo>
                        <hj:id />
                    </xsd:appinfo>
                </xsd:annotation>
            </xsd:element>
            <xsd:element name="associatedFoos" type="xsd:string" nillable="false" minOccurs="0" maxOccurs="unbounded">
            </xsd:element>
        </xsd:sequence>
     </xsd:complexType>
</xsd:schema> 
```

我通过 hyperjaxb3 (0.5.6) 运行该 XSD 并获得一组用于 Foo、Bar 和 Baz 的 Java 类。我想要的是生成的数据库模式要求 Bar.associatedFoo 和 Baz.associatedFoos 都是实际的 fooId。但是，我不能只更新架构，以便例如 bar.associatedFoo 是 ns1:Foo 类型。所以，问题是：我该怎么做？

这里的推理是，XSD 中的每一种类型实际上都是大的、复杂的、相互关联的对象图。我不希望 Baz 的 XML 文档必须包含其每个 Foo 的完整 XML 表示。

（显然，一种选择是在创建 JPA 模式之后手动添加 DB 约束——但如果可能的话，我宁愿将此信息嵌入到 XSD 中。）

在更简单的情况下（Bar.associatedFoo），我可以使用 orm:column 注释直接修改列定义：

```
<hj:basic>
    <orm:column column-definition="VARCHAR(255) REFERENCES myschema.Foo"/>
</hj:basic> 
```

但是（a）我不确定如何将此尝试扩展到 Baz.associatedFoos 案例，并且（b）如果可能的话，我更喜欢不那么脆弱的东西（列定义字符串需要在 foo id 长度更改时进行调整，架构名称更改，或 Foo 的表名称更改；这取决于 JPA 决定在 CREATE TABLE foo 之前创建 TABLE Bar；并且直到运行时才产生错误）。

如果重要的话——我使用 openJPA 2.1.1 作为我的 JPA 实现，使用 Postgres 9.1 作为我的数据库。在 XSD 中，如果需要，我可以更改 ID 定义（使其成为 complexType、xsd:string 的命名别名或可能的其他一些更改），并添加我喜欢的任何 xsd:annotations，但我不能做很多我的类型的其他结构变化。

提前致谢！

# java - 部署期间 JBoss 休眠异常

> ID：12917049
> 
> 赞同：0
> 
> 时间：2012-10-16T14:31:27.480
> 
> 标签：java, jboss, compilation

我有几个实体的应用程序。在 JBoss AS7 上部署期间，我出现下面列出的异常：

我正在使用想法 11.1.3；Ubuntu 12.04；maven 3.0.3，如果需要，我可以显示项目的 pom 文件。

```
17:24:00,770 ERROR [org.jboss.msc.service.fail] (MSC service thread 1-2) MSC00001: Failed to start service jboss.persistenceunit."kladr.ear/kladr-ejb-1.0-SNAPSHOT.jar#primary": org.jboss.msc.service.StartException in service jboss.persistenceunit."kladr.ear/kladr-ejb-1.0-SNAPSHOT.jar#primary": Failed to start service
    at org.jboss.msc.service.ServiceControllerImpl$StartTask.run(ServiceControllerImpl.java:1767) [jboss-msc-1.0.2.GA.jar:1.0.2.GA]
    at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886) [rt.jar:1.6.0_35]
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908) [rt.jar:1.6.0_35]
    at java.lang.Thread.run(Thread.java:662) [rt.jar:1.6.0_35]
Caused by: javax.persistence.PersistenceException: [PersistenceUnit: primary] Unable to build EntityManagerFactory
    at org.hibernate.ejb.Ejb3Configuration.buildEntityManagerFactory(Ejb3Configuration.java:914)
    at org.hibernate.ejb.Ejb3Configuration.buildEntityManagerFactory(Ejb3Configuration.java:889)
    at org.hibernate.ejb.HibernatePersistence.createContainerEntityManagerFactory(HibernatePersistence.java:73)
    at org.jboss.as.jpa.service.PersistenceUnitServiceImpl.createContainerEntityManagerFactory(PersistenceUnitServiceImpl.java:162)
    at org.jboss.as.jpa.service.PersistenceUnitServiceImpl.start(PersistenceUnitServiceImpl.java:85)
    at org.jboss.msc.service.ServiceControllerImpl$StartTask.startService(ServiceControllerImpl.java:1811) [jboss-msc-1.0.2.GA.jar:1.0.2.GA]
    at org.jboss.msc.service.ServiceControllerImpl$StartTask.run(ServiceControllerImpl.java:1746) [jboss-msc-1.0.2.GA.jar:1.0.2.GA]
    ... 3 more
Caused by: org.hibernate.MappingException: Duplicate property mapping of version found in com.kmware.ttk.kladr.model.KladrSettings
    at org.hibernate.mapping.PersistentClass.checkPropertyDuplication(PersistentClass.java:486)
    at org.hibernate.mapping.PersistentClass.validate(PersistentClass.java:476)
    at org.hibernate.mapping.RootClass.validate(RootClass.java:268)
    at org.hibernate.cfg.Configuration.validate(Configuration.java:1287)
    at org.hibernate.cfg.Configuration.buildSessionFactory(Configuration.java:1729)
    at org.hibernate.ejb.EntityManagerFactoryImpl.<init>(EntityManagerFactoryImpl.java:84)
    at org.hibernate.ejb.Ejb3Configuration.buildEntityManagerFactory(Ejb3Configuration.java:904)
    ... 9 more 
```

这是我的课程代码（没有导入）：

```
@Entity
@Table(name = "KLADR_SETTINGS",schema ="KLADR")
public class KladrSettings extends RQObject  implements Serializable{
    private static final long serialVersionUID = -8557672721736414960L;
    private String id;
    private String url;
    private String pathName;
    private String namePackage;
    private int sizeArchive;
    private Long version;

    @Id
    @Column(name = "KLADR_SETTINGS_ID")
    public String getId() {
        return id;
    }
    public void setId(String id) {
        this.id = id;
    }

    @Column(name = "KLADR_SETTINGS_URL")
    public String getUrl() {
        return url;
    }
    public void setUrl(String url) {
        this.url = url;
    }

    @Column(name = "KLADR_SETTINGS_PATHNAME")
    public String getPathName() {
        return pathName;
    }
    public void setPathName(String pathName) {
        this.pathName = pathName;
    }

    @Column(name = "KLADR_SETTINGS_NAMEPACKAGE")
    public String getNamePackage() {
        return namePackage;
    }
    public void setNamePackage(String namePackage) {
        this.namePackage = namePackage;
    }
    @Column(name = "KLADR_SETTINGS_SIZE_ARCHIVE")
    public int getSizeArchive() {
        return sizeArchive;
    }
    public void setSizeArchive(int sizeArchive) {
        this.sizeArchive = sizeArchive;
    }

    @Column(name = "KLADR_SETTINGS_VERSION")
    public Long getVersion() {
        return version;
    }
    public void setVersion(Long version) {
        this.version = version;
    }

    @Override public PortableEntity toPortableEntity(boolean loadCollections, boolean loadNested) {

        PKladrSettings pentity = new PKladrSettings(getId(), getName(), getVersion(),
                getDeleted());

        pentity.setId(getId());
        pentity.setNamePackage(getNamePackage());
        pentity.setPathName(getPathName());
        pentity.setSizeArchive(getSizeArchive());
        pentity.setUrl(getUrl());
        pentity.setVersion(getVersion());

        return pentity;

    }

    @Override public void fromPortable(PortableEntity pentity) {
        PKladrSettings input = null;
        if (pentity instanceof PKladrSettings){
            input = (PKladrSettings) pentity;
        }
        if(input!=null){
            this.setId(input.getId());
            this.setName(input.getDisplayName());
            this.setVersion(input.getVersion());
            this.setDeleted(input.isDeleted());

            this.setNamePackage(input.getNamePackage());
            this.setPathName(input.getPathName());
            this.setSizeArchive(input.getSizeArchive());
            this.setUrl(input.getUrl());

        }
    }

    @Override public void loadLazyCollections() {

    }
} 
```

这是什么意思`duplicate property mapping`？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-16T14:44:51.423

看起来该属性`private Long version;`是在超类和扩展类上定义的。从其中一个中删除它，它应该可以工作。

# c# - RemotePresenceView 只收到一个通知，然后什么都没有发生

> ID：12917052
> 
> 赞同：2
> 
> 时间：2012-10-16T14:31:34.170
> 
> 标签：c#, lync, ucma

PresenceView 是使用手动配置的应用程序端点创建的。我为它提供了三个目标，它们都报告“订阅”。但我只收到第一个通知。之后，什么也没有发生。轮询也是如此。NotificationRecieved 事件在第一次通知后未触发。Lync 事件日志显示没有错误，也没有引发任何期望。

我的设置是一个带有 DC、Lync Server 和 Developer 机器的虚拟环境，它也充当应用程序池。一切看起来都很好。

以下是我的一些代码示例。我的解决方案包含两个项目：一个小型控制台应用程序和一个带有 lync 代码的项目。它基于 UCMA 代码示例中的 SubscribePresenceView 示例解决方案，它可以很好地更新存在状态，尽管它使用的是用户端点。

```
 public void Run()
    {
        _helper = new Helper(new ConsoleLogger());
        _applicationEndpoint = _helper.CreateApplicationEndpoint();

        var viewSettings = new RemotePresenceViewSettings();
        viewSettings.SubscriptionMode = RemotePresenceViewSubscriptionMode.Default;
        _presenceView = new RemotePresenceView(_applicationEndpoint, viewSettings);

        List<RemotePresentitySubscriptionTarget> targets = new List<RemotePresentitySubscriptionTarget>();
        targets.Add(new RemotePresentitySubscriptionTarget("sip:mortenl@mupersan.local"));
        targets.Add(new RemotePresentitySubscriptionTarget("sip:finnl@mupersan.local"));
        targets.Add(new RemotePresentitySubscriptionTarget("sip:andersl@mupersan.local"));

        this.WireUpHandlersForView(_presenceView);

        _presenceView.StartSubscribingToPresentities(targets);
    } 
```

处理通知委托方法：

```
 private void RemotePresenceView_NotificationReceived(object sender, RemotePresentitiesNotificationEventArgs e)
    {
        // A RemotePresentityNotification will contain all the
        // categories for one user; Notifications can contain notifications
        // for multiple users.

        foreach (RemotePresentityNotification notification in e.Notifications)
        {
           Console.WriteLine("\nReceived a Notification for user "+ notification.PresentityUri + ".");

           // If a category on notification is null, the category
           // was not present in the notification. This means there were no
           // changes in that category.

           if (notification.AggregatedPresenceState != null)
           {
               Console.WriteLine("Aggregate State = " + notification.AggregatedPresenceState.Availability + ".");
           }

           if (notification.PersonalNote != null)
           {
               Console.WriteLine("PersonalNote: " + notification.PersonalNote.Message + ".");
           }

           if (notification.ContactCard != null)
           {
               // A ContactCard contains many properties; only display
               // some.
               ContactCard contactCard = notification.ContactCard;
               Console.WriteLine("ContactCard Company: " + contactCard.Company + ".");
               Console.WriteLine("ContactCard DisplayName: " + contactCard.DisplayName + ".");
               Console.WriteLine("ContactCard EmailAddress: " + contactCard.EmailAddress + ".");
           }           
        }
    } 
```

如果您需要更多信息，请告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T22:01:03.160

从来没有找到解决方案，所以我继续使用 UserEndPoint 代替，它工作得很好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-08-08T08:57:23.340

我现在意识到这已经很老了，但是我最近遇到了完全相同的问题，因此可能值得回答。

就我而言，原因是服务器无法建立与应用程序端点的连接。我看不出这里的代码有什么问题，所以很可能是两台机器之间的防火墙或路由问题。

在设置应用程序端点时，您定义了一个端口，并且该端口需要在托管应用程序端点的机器上可以访问（在这种情况下是您的开发人员机器）。

*   当您建立应用程序端点时，它会打开与服务器的连接（我认为通常是端口 5061）。
*   当您订阅 RemotePresenceView 时，它会将该订阅请求发送到该连接，并且服务器将响应同一连接上所有订阅 Presentities（一个愚蠢的词）的当前状态的通知，这就是您收到第一个通知的原因。
*   对于所有后续通知，服务器将尝试在您为端点定义的端口上连接回您的应用程序端点主机，这可能就是问题所在。

对于用户端点，您不需要打开端口，因此服务器只会通过客户端与服务器的连接发送通知，这就是它起作用的原因。

# xml - HL7 2.xml 传输、HL7 3 传输、标准 XML 传输 = SOAP？

> ID：12917063
> 
> 赞同：1
> 
> 时间：2012-10-16T14:31:47.843
> 
> 标签：xml, soap, hl7, transport

我正在开发一个支持 HL7 2.x 的小型服务器。

我已经完成了 MLLP 阅读器（它接受 HL7 2.x 默认值，现在是时候弄清楚如何接受 HL7 2.xml。

但是，我找不到任何有关为此使用什么传输的信息！

我知道它通常很少使用，但肯定有人至少实施过一次吗？你是如何传输 XML 的？

默认值包装在 MLLP 中（由一个起始字节和几个结束字节组成）...... SOAP 让我觉得 HL7 2.x 的 XML 版本的明显选择，但我想它也可以包装在 MLLP 中。但是，我更想知道标准是什么。

另外，当我谈到一般话题时：

HL7 3 消息是如何包装的？有没有一个常见的情况......一般来说，XML 消息在通过网络发送时，使用 xxxxxx （再次......，SOAP？）传输，感谢您的回复！

肖恩

ps 是的，我故意要求 HL7 2（不是 3）xml。此处描述的编码：www.hl7.org/documentcenter/public/wg/xml/drafts/v2xml1mlbb.pdf

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T15:47:57.473

不要混淆传递机制的消息格式。MLLP 对于 HL7 2.x 来说当然是非常常见的（我已经让客户说“我们通过 TCP/IP 发送消息”），但它只是一条消息，您可以选择任何方式发送它。我有两种情况，其中 v2.x 消息的交换部分基于文件系统（一种情况下是 FTP/S，另一种情况下是网络目录提取）。

同样对于 HL7 3，您可以以任何您想要的方式发送 XML。我同意考虑到消息的 XML 格式，SOAP 看起来很自然，但老实说，我还没有任何客户端使用 v3 格式。我也没有很多客户“了解”通过 SOAP 或一般的 Web 服务传递 HL7 消息的概念。

为了强调我的第一点，如果您查看像 Mirth Connect 这样的接口引擎，您会发现传递机制是作为独立于消息格式的决定而保存的。我可以通过文件、LLP、FTP、Web 服务等方式传递...消息可以是 v2、v3、EDI 等。

# iphone - iPhone自定义控件动画

> ID：12917073
> 
> 赞同：1
> 
> 时间：2012-10-16T14:32:16.143
> 
> 标签：iphone, objective-c, ios, animation, objective-c-blocks

我有一个自定义控件，我想像 ListViews 一样实现“轻弹”样式滚动。由于它是一个显示大量数据的持续更新控件，因此我计算需要渲染时渲染的内容。

我已经在控件上实现了捏拉缩放和平移。但是，现在我想允许用户使用轻弹手势执行平移。唯一的问题是我不确定如何最好地顺利完成这项工作。我需要一些方法来设置像 UIAnimation 块这样的东西，即使控件没有接收到连续更新（因此不会改变），我也可以从中步进动画（带减速）。

我希望我已经充分解释了这一点，如果不能随意提问！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T10:08:16.050

我最终通过在我的渲染循环中执行更新来处理这个问题。它工作得相当好。对于 iPhone 通常使用的加速可能不太合适，但它看起来很好，而且比没有它要好得多。

# macos - 将 NSOpenPanel 的默认目录更改为“Media”目录

> ID：12917076
> 
> 赞同：2
> 
> 时间：2012-10-16T14:32:23.097
> 
> 标签：macos, cocoa, directory, media, nsopenpanel

我正在为一些学生开发一个简单的应用程序。在应用程序中，学生必须选择他们在 iMovie 中制作的视频。我已经为此设置了一个 NSOpenPanel，但我希望它默认为电影目录，而不是`~/Movies`目录，我的目标是 Finder 中媒体标题下方的电影“目录”。这是一个非常方便的目录，因为学生将能够直接从 iMovie 导入视频，而不必导出和搜索它们。（相信我，他们一直把这件事搞砸了）。

为更加清楚起见，这是打开工作表中所见文件夹的屏幕截图： ![在此处输入图像描述](../Images/32ef4274c202bc59484be7e28f80abc0.png)

（我的电脑是荷兰语，因此命名为“Films”而不是“Movies”）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T14:45:03.207

您可以使用 NSFileManager 的[URLsForDirectory:inDomains:](http://developer.apple.com/library/mac/#documentation/cocoa/reference/foundation/Classes/NSFileManager_Class/Reference/Reference.html#//apple_ref/occ/instm/NSFileManager/URLsForDirectory%3ainDomains%3a)方法，传入适当的[NSSearchPathDirectory](http://developer.apple.com/library/mac/#documentation/cocoa/reference/foundation/Miscellaneous/Foundation_Constants/Reference/reference.html#//apple_ref/c/tdef/NSSearchPathDirectory)枚举值（在您的情况下为 NSMoviesDirectory）：

```
NSURL* movieDirectory = [[[NSFileManager defaultManager] URLsForDirectory:NSMoviesDirectory inDomains:NSUserDomainMask] objectAtIndex:0]; 
```

# testing - 在实时/正在运行的网站上进行集成测试

> ID：12917086
> 
> 赞同：1
> 
> 时间：2012-10-16T14:32:36.160
> 
> 标签：testing, integration

我记得读过一个框架，但完全忘记了它，在谷歌中找不到它。

该框架允许您编写旨在在实时网站/环境中运行的集成测试。它可以测试第 3 方连接/防火墙等。它有一个很好的 UI 可以查看/运行所有测试。

有谁知道我正在寻找的框架？这是什么类型的集成测试？

# ios - UIview Demo 只向一个方向旋转

> ID：12917089
> 
> 赞同：2
> 
> 时间：2012-10-16T14:32:39.490
> 
> 标签：ios, xcode, rotation, direction

我正在使用这个示例代码[RotationPie](https://github.com/wczekalski/CDPieMenu)。它是一个轮子，我只想在我的项目中向一个方向移动或旋转它。我想提出不同的选项，用户将不得不选择其中之一。我希望轮子只向一个方向旋转。我认为我必须在类 CDCircleGestureRecognizer 中更改此方法中的某些内容，但我不知道是什么。

```
- (void)touchesMoved:(NSSet *)touches withEvent:(UIEvent *)event
{
   if ([self state] == UIGestureRecognizerStatePossible) {
      [self setState:UIGestureRecognizerStateBegan];
   } else {
      [self setState:UIGestureRecognizerStateChanged];
   }

   // We can look at any touch object since we know we 
   // have only 1\. If there were more than 1 then 
   // touchesBegan:withEvent: would have failed the recognizer.
   UITouch *touch = [touches anyObject];

   // To rotate with one finger, we simulate a second finger.
   // The second figure is on the opposite side of the virtual
   // circle that represents the rotation gesture.

    CDCircle *view = (CDCircle *) [self view];
   CGPoint center = CGPointMake(CGRectGetMidX([view bounds]), CGRectGetMidY([view bounds]));
   CGPoint currentTouchPoint = [touch locationInView:view];
   CGPoint previousTouchPoint = [touch previousLocationInView:view];
    previousTouchDate = [NSDate date];
    CGFloat angleInRadians = atan2f(currentTouchPoint.y - center.y, currentTouchPoint.x - center.x) - atan2f(previousTouchPoint.y - center.y, previousTouchPoint.x - center.x);

    CGFloat one = atan2f(currentTouchPoint.y - center.y, currentTouchPoint.x - center.x); 

     CGFloat two =atan2f(previousTouchPoint.y - center.y, previousTouchPoint.x - center.x);    
    currentTransformAngle = atan2f(view.transform.b, view.transform.a);

   [self setRotation:angleInRadians]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T11:43:50.170

我认为您应该将当前的 angleInRadians 存储在一个变量中，并且仅当新角度大于（或小于）当前角度时才允许旋转。

# c++ - 从 ASCII 到 Unicode 字符代码的转换 (FreeType2)

> ID：12917098
> 
> 赞同：4
> 
> 时间：2012-10-16T14:32:51.643
> 
> 标签：c++, unicode, ascii, freetype

我在我的一个项目中使用 FreeType2。为了呈现一个字母，我需要提供一个 Unicode 两字节字符代码。程序读取的字符代码是 ASCII 单字节格式。128以下的字符码没有问题（字符码相同），但其他128不匹配。例如：

ASCII 中的 'a' 是 0x61，Unicode 中的 'a' 是 0x0061 - 没关系
ASCII 中的 'ą' 是 0xB9，Unicode 中的 'ą' 是 0x0105 - 完全不同

我试图在那里使用 WinAPI 函数，但我一定做错了什么。这是一个示例：

```
unsigned char szTest1[] = "ąółź"; //ASCII format
wchar_t* wszTest2;
int size = MultiByteToWideChar(CP_UTF8, 0, (char*)szTest1, 4, NULL, 0);
printf("size = %d\n", size);
wszTest2 = new wchar_t[size];
MultiByteToWideChar(CP_UTF8, 0, (char*)szTest1, 4, wszTest2, size);
printf("HEX: %x\n", wszTest2[0]);
delete[] wszTest2; 
```

我期望创建一个新的宽字符串，最后没有 NULL。但是，*大小*变量始终等于 0。知道我做错了什么吗？或者也许有更简单的方法来解决问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-16T14:40:25.503

`CodePage`参数`MultiByteToWideChar`错误。utf-8 与 ASCII 不同。您应该使用`CP_ACP`whichtell 是当前系统代码页（与 ASCII 不同 - 请参阅[Unicode、UTF、ASCII、ANSI 格式差异](https://stackoverflow.com/questions/700187/unicode-utf-ascii-ansi-format-differences)）

大小很可能为零，因为您的测试字符串不是有效的 Utf-8 字符串。

对于几乎所有 Win32 函数，您都可以在函数无法获取详细的错误代码后调用 GetLastError()，因此调用它也会为您提供更多详细信息。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-10-16T15:02:24.193

“纯”ASCII 字符集限制在 0-127（7 位）范围内。设置最高有效位的 8 位字符（即 128-255 范围内的字符）不是唯一定义的：它们的定义取决于**代码页**。因此，您的字符`ą`（*LATIN SMALL LETTER A WITH OGONEK*）由*特定*`0xB9`代码页中的值表示，该值应为[Windows-1250](http://en.wikipedia.org/wiki/Windows-1250)。在其他代码页中，该值与*不同*的字符相关联（例如，在[Windows 1252 代码页](http://en.wikipedia.org/wiki/Windows-1252)中，与字符相关联，即上标数字 1）。*`0xB9`*`0xB9``¹`**

 **要使用 Windows Win32 API 将字符从特定代码页转换为 Unicode UTF-16，您可以使用[`MultiByteToWideChar`](http://msdn.microsoft.com/en-us/library/windows/desktop/dd319072%28v=vs.85%29.aspx)，指定正确的代码页（这*与* `CP_UTF8`您问题中的代码不同；实际上，`CP_UTF8`标识 Unicode UTF-8） . 您可能想尝试将`1250`(ANSI Central European; Central European (Windows)) 指定为正确的[代码页标识符](http://msdn.microsoft.com/en-us/library/windows/desktop/dd317756%28v=vs.85%29.aspx)。

如果您可以在代码中访问**ATL**，则可以使用[ATL 字符串转换帮助器类](http://msdn.microsoft.com/en-us/library/87zae4a3%28v=vs.80%29.aspx)（如）的便利，它将) 调用和内存分配`CA2W`包装在 RAII 类中；`MultiByteToWideChar(`例如：

```
#include <atlconv.h> // ATL String Conversion Helpers
// 'test' is a Unicode UTF-16 string.
// Conversion is done from code-page 1250
// (ANSI Central European; Central European (Windows))
CA2W test("ąółź", 1250); 
```

现在你应该可以`test`在你的 Unicode API 中使用字符串了。

如果您无权访问 ATL 或想要基于**C++ STL 的**解决方案，您可能需要考虑以下代码：

```
///////////////////////////////////////////////////////////////////////////////
//
// Modern STL-based C++ wrapper to Win32's MultiByteToWideChar() C API.
//
// (based on http://code.msdn.microsoft.com/windowsdesktop/C-UTF-8-Conversion-Helpers-22c0a664)
//
///////////////////////////////////////////////////////////////////////////////

#include <exception>    // for std::exception
#include <iostream>     // for std::cout
#include <ostream>      // for std::endl
#include <stdexcept>    // for std::runtime_error
#include <string>       // for std::string and std::wstring
#include <Windows.h>    // Win32 Platform SDK

//-----------------------------------------------------------------------------
// Define an exception class for string conversion error.
//-----------------------------------------------------------------------------
class StringConversionException 
    : public std::runtime_error
{
public:
    // Creates exception with error message and error code.
    StringConversionException(const char* message, DWORD error)
        : std::runtime_error(message)
        , m_error(error)
    {}

    // Creates exception with error message and error code.
    StringConversionException(const std::string& message, DWORD error)
        : std::runtime_error(message)
        , m_error(error)
    {}

    // Windows error code.
    DWORD Error() const
    {
        return m_error;
    }

private:
    DWORD m_error;
};

//-----------------------------------------------------------------------------
// Converts an ANSI/MBCS string to Unicode UTF-16.
// Wraps MultiByteToWideChar() using modern C++ and STL.
// Throws a StringConversionException on error.
//-----------------------------------------------------------------------------
std::wstring ConvertToUTF16(const std::string & source, const UINT codePage)
{
    // Fail if an invalid input character is encountered
    static const DWORD conversionFlags = MB_ERR_INVALID_CHARS;

    // Require size for destination string
    const int utf16Length = ::MultiByteToWideChar(
        codePage,           // code page for the conversion
        conversionFlags,    // flags
        source.c_str(),     // source string
        source.length(),    // length (in chars) of source string
        NULL,               // unused - no conversion done in this step
        0                   // request size of destination buffer, in wchar_t's
        );
    if (utf16Length == 0) 
    {
        const DWORD error = ::GetLastError();
        throw StringConversionException(
            "MultiByteToWideChar() failed: Can't get length of destination UTF-16 string.",
            error);
    }

    // Allocate room for destination string
    std::wstring utf16Text;
    utf16Text.resize(utf16Length);

    // Convert to Unicode UTF-16
    if ( ! ::MultiByteToWideChar(
        codePage,           // code page for conversion
        0,                  // validation was done in previous call
        source.c_str(),     // source string
        source.length(),    // length (in chars) of source string
        &utf16Text[0],      // destination buffer
        utf16Text.length()  // size of destination buffer, in wchar_t's
        )) 
    {
        const DWORD error = ::GetLastError();
        throw StringConversionException(
            "MultiByteToWideChar() failed: Can't convert to UTF-16 string.",
            error);
    }

    return utf16Text;
}

//-----------------------------------------------------------------------------
// Test.
//-----------------------------------------------------------------------------
int main()
{
    // Error codes
    static const int exitOk = 0;
    static const int exitError = 1;

    try 
    {
        // Test input string:
        //
        // ą - LATIN SMALL LETTER A WITH OGONEK
        std::string inText("x - LATIN SMALL LETTER A WITH OGONEK");
        inText[0] = 0xB9;

        // ANSI Central European; Central European (Windows) code page
        static const UINT codePage = 1250;

        // Convert to Unicode UTF-16
        const std::wstring utf16Text = ConvertToUTF16(inText, codePage);

        // Verify conversion.
        //  ą - LATIN SMALL LETTER A WITH OGONEK
        //  --> Unicode UTF-16 0x0105
        // http://www.fileformat.info/info/unicode/char/105/index.htm
        if (utf16Text[0] != 0x0105) 
        {
            throw std::runtime_error("Wrong conversion.");
        }
        std::cout << "All right." << std::endl;
    }
    catch (const StringConversionException& e)
    {
        std::cerr << "*** ERROR:\n";
        std::cerr << e.what() << "\n";
        std::cerr << "Error code = " << e.Error();
        std::cerr << std::endl;
        return exitError;
    }
    catch (const std::exception& e)
    {
        std::cerr << "*** ERROR:\n";
        std::cerr << e.what();
        std::cerr << std::endl;
        return exitError;
    }
    return exitOk;
}

/////////////////////////////////////////////////////////////////////////////// 
```**

# php - 在 ubuntu 11.10 的终端和浏览器中显示不同的 php 版本

> ID：12917099
> 
> 赞同：4
> 
> 时间：2012-10-16T14:32:59.017
> 
> 标签：php, ubuntu-11.04

当我在终端显示中使用 php -v

带有 Suhosin-Patch (cli) 的 PHP 5.3.6-13ubuntu3.9（构建时间：2012 年 9 月 12 日 19:02:11） 版权所有 (c) 1997-2011 PHP Group Zend Engine v2.3.0，版权所有 (c) 1998-2011禅德科技

但是当我在文件中打印 phpinfo 并在浏览器中执行该脚本时

我得到了“PHP 版本 5.2.17”。

我的主要问题是肥皂没有显示在浏览器中，但肥皂显示在终端中。

如何在 ubuntu 11.10 中解决这个问题。

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-16T15:24:02.180

您的 Web 服务器（可能是 Apache）配置了与系统默认不同的 PHP 处理器。

系统处理器位置（在终端中）：

```
whereis php 
```

PHP 可以配置为 CGI 模块或 Apache 的模块。请参阅[PHP 安装和配置](http://php.net/manual/en/install.php)

您可以重新配置 Web 服务器或使用不同的远程通道来运行系统 PHP 处理器。这取决于您的需求。例如 SSH。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-10-16T14:39:27.317

他们使用不同的`php.ini`文件。

检查它们。

对于 CLI，使用`php -i | grep php.ini`

对于在浏览器中打印的 phpinfo，找到`Loaded Configuration File`.

# macos - 在 OS X 上为 Java 7u7（包含 JavaFX 2.2）编译 scalafx

> ID：12917101
> 
> 赞同：3
> 
> 时间：2012-10-16T14:33:01.233
> 
> 标签：macos, scala, javafx-2, scalafx

[scalafx](http://code.google.com/p/scalafx/)的编译说明说要做：

```
export JAVAFX_HOME=/Path/To/javafx-sdk2.1.0-beta
sbt clean compile package make-pom package-src 
```

然而，随着 JavaFX 的新打包成为 Java JDK 本身的一部分（即 OS X 的 7u7），似乎不再有这样的“javafx-sdkx.xx”文件夹。Oracle 文档说 JavaFX JDK 与主要的 Java JDK 一起放置（在相同的文件夹中）。

所以我这样做：

```
$ export JAVAFX_HOME=/库/Java/JavaVirtualMachines/jdk1.7.0_07.jdk
$ sbt 清洁
[警告] 不推荐使用 project/plugins/ (/Users/asko/Sources/scalafx/project/plugins) 进行插件配置。
[警告] 将 .sbt 插件定义直接放在 project/ 中，
[警告] project/project/ 中的 .scala 插件定义，
[警告] 并删除 project/plugins/ 目录。
[信息] 从 /Users/asko/Sources/scalafx/project/plugins/project 加载项目定义
[信息] 从 /Users/asko/Sources/scalafx/project/plugins 加载项目定义
[错误] java.lang.NullPointerException
[错误] 对完整日志使用“最后一个”。
项目加载失败：(r)etry、(q)uit、(l)ast 还是 (i)gnore？

```

我是做错了什么还是 scalafx 与最新的 Java 版本（7u7，JavaFX 2.2）不兼容。我能做些什么？

[http://code.google.com/p/scalafx/](http://code.google.com/p/scalafx/)

**附录**

..最后（按照下面 Igor 的解决方案）`sbt run`轻松启动彩色圆圈演示（好吧，如果有支持的 GPU 的话）。Oracle[声称](http://docs.oracle.com/javafx/2/system_requirements_2-2/jfxpub-system_requirements_2-2.htm)*“JavaFX 支持 Lion 或更高版本的任何 Mac OS X 系统上的图形硬件加速”*，但我倾向于认为我正在使用的 NVidia 驱动的 Mac Mini 可以进行软件渲染。

不，即使是其他快速使用 javafx 的 MacBook Air（核心 i7）在演示中也很迟钝。也许是演示。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-16T15:28:59.393

我所做的是：

```
hg clone https://code.google.com/p/scalafx/
cd scalafx
export JAVA_HOME=/Library/Java/JavaVirtualMachines/jdk1.7.0_07.jdk/Contents/Home
sbt clean compile package make-pom package-src 
```

有用。似乎最新的代码检查包含对与 SDK 捆绑的 JavaFX 的支持。检查 build.sbt 文件，第 106 行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T08:47:32.643

ScalaFX 中还有一个 Grade **build.gradle**，我把它作为替代构建系统放在那里

# java - 是否可以在应用程序中捆绑 kext？

> ID：12917102
> 
> 赞同：2
> 
> 时间：2012-10-16T14:33:03.240
> 
> 标签：java, macos, installation, kernel-extension

我有一个需要 kext 的 Mac OS X 应用程序（也是由我构建的）。我想将kext“捆绑”到应用程序中，这样当用户运行应用程序时，会自动加载kext（当然，可能会显示管理员密码提示）。有可能，还是我需要在安装时安装 kext？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T14:34:43.533

您可以从您的应用程序安装它。您需要使用服务管理框架以提升的权限（用 C 或 Obj-C 编写）运行任务。然后可以安装kext。

您的帮助工具应该是一个可执行文件，以提升的权限运行，以代表您的应用执行安装 kext 的操作。

脚步：

1.  将 Kext 和辅助工具作为资源包含在您的应用程序包中
2.  创建一个辅助工具来为您完成工作。您的帮助工具需要将您的 kext 复制到 /System/Extensions 目录。您需要以提升的权限复制它。让你的帮助工具调用 kextload 来安装它。
3.  您需要对帮助工具和应用程序进行代码签名，并将服务管理框架的相关条目放在帮助程序和主应用程序的 info.plist 中。

苹果开发人员的文档是绝对残暴的。祝你好运。您可能必须使用 Objective-C 或 C 而不是 Java 来完成这一切，因为您必须使用诸如 Security Framework 和 Service Manager 之类的 C 库以及代码签名。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-17T11:56:11.390

我已经成功捆绑了它！我运行了一个脚本，要求输入 root 密码，然后继续安装 kext。唯一的问题是必须事先知道捆绑的 kext 的位置（我必须对它们“cd”）；所以应用程序必须放在预定义的位置，否则它将无法工作。

# android - 在android编程中将文本添加到horizo ntalscrollview中的imageview

> ID：12917104
> 
> 赞同：0
> 
> 时间：2012-10-16T14:33:04.973
> 
> 标签：android

我想在水平滚动视图中的每个 ImageView 下方添加一个文本。

我尝试使用相对布局和线性布局。

有更好的方法吗？

## 我的活动 xml 看起来像

```
 <RelativeLayout android:layout_width="fill_parent" 
        android:layout_height="wrap_content"
        android:orientation="horizontal">
        <ImageView 
            android:id="@+id/image1"
            android:layout_width="150dp"
            android:layout_height="150dp"
            android:src="@drawable/image1"
            android:layout_centerHorizontal="true"
            android:layout_marginRight="5px"
            />

        <TextView
    android:id="@+id/text1"
    android:layout_width="50dp"
    android:layout_height="30dp"
    android:text="text1"
    android:textSize="20px"
    android:layout_marginLeft="15dp"
    android:layout_marginRight="15dp"
    android:layout_below="@+id/image1"
    />
        <ImageView 
            android:id="@+id/image2"
            android:layout_width="150dp"
            android:layout_height="150dp"
            android:src="@drawable/image2"
            android:layout_centerHorizontal="true"
            android:layout_marginRight="5px"
            android:layout_toRightOf="@+id/image1"/>
        <ImageView 
            android:id="@+id/image3"
            android:layout_width="150dp"
            android:layout_height="150dp"
            android:src="@drawable/image3"
            android:layout_centerHorizontal="true"
            android:layout_marginRight="5px"
            android:layout_toRightOf="@+id/image2"/>
        <ImageView 
            android:id="@+id/image4"
            android:layout_width="150dp"
            android:layout_height="150dp"
            android:src="@drawable/image4"
            android:layout_centerHorizontal="true"
            android:layout_marginRight="5px"
            android:layout_toRightOf="@+id/image3"/>

        <ImageView 
            android:id="@+id/image5"
            android:layout_width="150dp"
            android:layout_height="150dp"
            android:src="@drawable/image2"
            android:layout_centerHorizontal="true"
            android:layout_marginRight="5px"
            android:layout_toRightOf="@+id/image4"/>

        <ImageView 
            android:id="@+id/image6"
            android:layout_width="150dp"
            android:layout_height="150dp"
            android:src="@drawable/image3"
            android:layout_centerHorizontal="true"
            android:layout_marginRight="5px"
            android:layout_toRightOf="@+id/image5"/>
    </RelativeLayout>

 </HorizontalScrollView> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T14:41:53.700

我通过将具有垂直方向的线性布局作为子级添加到方向为水平的外部线性布局来解决了这个问题。将图像和文本视图添加到内部线性布局，以便它们都是垂直的

更新了活动 xml

* * *

```
<HorizontalScrollView
        android:layout_width="250dp"
        android:layout_height="wrap_content"
        android:layout_below="@+id/latestOffers"
        android:layout_centerHorizontal="true"
        android:layout_marginTop="10px"
        android:scrollbars="none">

        <LinearLayout
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:orientation="horizontal" >

            <LinearLayout
                android:layout_width="fill_parent"
                android:layout_height="wrap_content"
                android:orientation="vertical" >

                <ImageView
                    android:id="@+id/image1"
                    android:layout_width="150dp"
                    android:layout_height="80dp"
                    android:layout_centerHorizontal="true"
                    android:layout_marginRight="5px"
                    android:src="@drawable/image1" />

                <TextView
                    android:id="@+id/text1"
                    android:layout_width="80dp"
                    android:layout_height="20dp"
                    android:layout_centerHorizontal="true"
                    android:layout_marginLeft="15dp"
                    android:layout_marginRight="15dp"
                    android:paddingLeft="30dp"
                    android:text="text1"
                    android:textSize="20px" />
            </LinearLayout>

    </LinearLayout>
        </LinearLayout>
    </HorizontalScrollView> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T14:45:05.853

当您引用另一个 id 来设置对齐方式时，不要使用`@+id`. 只需使用`@id`. 使用加号表示您想创建一个具有该名称的*新*id。它可能会让人感到困惑，因为这会导致您的布局中出现重复的 ID。

```
<TextView
    ...
    android:layout_below="@id/image1"
/> 
```

我注意到您对以下 ImageViews 做了同样的事情，所以也要检查并修复它们。

# c# - 发布使用 MonoDevelop 制作的应用程序

> ID：12917108
> 
> 赞同：1
> 
> 时间：2012-10-16T14:33:11.440
> 
> 标签：c#, mono, release, publish

我刚刚在 MonoDevelop 中创建了一个小应用程序（在 Windows 机器上）。现在我想在不同的平台上测试它，但我不知道如何发布应用程序。

我想要一个适用于 windows、ubuntu 和 mac 的安装程序。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T14:48:11.270

查看[官方移植指南](http://www.mono-project.com/Guide%3a_Porting_Winforms_Applications)以获取有关 linux 的帮助。我认为它对于 Mac 来说是相似的，但我不能保证，因为 MonoMac 是 Mono 的一个独立变体。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-17T13:12:42.677

对于 Mac，有[MacPack](http://www.mono-project.com/Guide%3aRunning_Mono_Applications#macpack_.28Mac_OS_X_only.29)。

对于 Linux，安装程序或捆绑软件通常不是要走的路。您可能会创建一个分发*包*。您必须搜索特定于给定发行版的打包系统的东西，[这里](http://weblog.savanne.be/jo-shields.odp)是 Debian 的一些来源。尽管如此，您可以创建这样的可执行文件（当然，它将是特定于架构的），请在[此处](http://www.mono-project.com/Guide%3aRunning_Mono_Applications#Bundles)阅读。

对于 Windows，您可以使用例如[WiX](http://wixtoolset.org/)。

# sql - SQL（Interbase）：具有聚合函数的字符串的情况

> ID：12917109
> 
> 赞同：1
> 
> 时间：2012-10-16T14:33:16.927
> 
> 标签：sql, group-by, sum, case, interbase

我无法在 Interbase 中执行以下 SQL：我收到以下错误：

> 第 1 行出错尝试执行未准备好的动态 SQL 语句

SQL：

```
SELECT CASE
   WHEN kl='K' THEN (SUM(DB)-SUM(CR))
   WHEN kl='L' THEN (SUM(CR)-SUM(DB))
   END AS Saldo
FROM  Table1
GROUP BY KL 
```

对于以`Table1`这种方式定义的：

```
Column name   Data type
------------  ------------
KL            varchar(1)
DB            int
CR            int 
```

然而它在[SQL 小提琴中工作](http://www.sqlfiddle.com/#!2/3f44a/1)

以下也有效！

```
SELECT CASE 
   WHEN kl='K' THEN 1
   WHEN kl='L' THEN 2
   END as Saldo
FROM  Table1
Group By KL 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T07:41:35.930

Found It!

```
SELECT Sum(CASE
       WHEN kl='K' THEN db
       WHEN kl='L' THEN cr
       END )
      -Sum(CASE
       WHEN kl='K' THEN CR
       WHEN kl='L' THEN DB
       END )

 FROM  Table1
Group By KL 
```

# php - 简单的 XML PHP MySQL

> ID：12917121
> 
> 赞同：0
> 
> 时间：2012-10-16T14:33:50.373
> 
> 标签：php, mysql, xml, rss, simplexml

好的 在这里编辑仍然有问题，但与更新代码之前不同

```
<?php
    date_default_timezone_set('Europe/London');
    $date = date('Y-m-d H:i:s', time());
    $now = date('Y-m-d H:i:s');
    $dbhost     = "localhost";
    $dbuser     = "admin_cdm_clap";
    $dbpass     = "zdqUyFc5bAG1e6TWrIhijH3j7gB8xhmHI4q";
    $db         = "iTunesConnect";
    $driveID = 562220229;
    $connect = mysql_connect($dbhost,$dbuser,$dbpass) or die (mysql_error());
    mysql_select_db($db);
    $query = "SELECT `code` from `countries`";
    $result = mysql_query($query) or die (mysql_error());
    $num=mysql_num_rows($result);
    $i=0;
    while ($i < $num) {
        $country=mysql_result($result,$i,"code");
        $completeUrl = "https://itunes.apple.com/".strtolower($country)."/rss/toppaidapplications/limit=300/genre=6002/xml";
        //echo $completeUrl.'<br>';
        $xml = simplexml_load_file($completeUrl);
        $entries = $xml->entry;
        for ($a = 0; $a < 300; $a++) {  
            //$updated = $entries[$a]->updated;
            $id = $entries[$a]->id->attributes('im', true)->id;
            $bundle = $entries[$a]->id->attributes('im', true)->bundleId;
            $cc = $entries[$a]->id;
            $title = $entries[$a]->title;
            $category = $entries[$a]->category['term'];     
            $nUpdated = microtime(true); //strtotime(substr($updated,0,10).' '.substr($updated, 11, 8))
            $storeCode = substr($cc, 25, 2);
            $storeCat = 6002; 
            if($id == $driveID){
                $rankRec = "INSERT INTO rankings (id, rank, updated, store, category) VALUES (NULL, $a, $nUpdated, '$storeCode','$storeCat')";
                mysql_query($rankRec) or die(mysql_error());
            } else {
                error_reporting(E_ALL);
                ini_set('display_errors', '1');
            }   
        }       
        $i++;
    }   
?> 
```

我现在收到以下错误；

注意：试图在第 24 行的 /var/www/vhosts/createdm.com/httpdocs/iTunesConnect/iTunesRanking.php 中获取非对象的属性 致命错误：在 / 中的非对象上调用成员函数 attributes()第 24 行的 var/www/vhosts/createdm.com/httpdocs/iTunesConnect/iTunesRanking.php

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T15:48:47.627

错误在这里

```
 $id = $entries[$a]->id->attributes('im', true)->id; 
```

它说该`attributes`函数是在一个*非对象*上调用的，这告诉我们该`->id`不是一个对象；它可能未设置。

所以这反过来告诉我们 XML 有一个没有正确的条目`id`，或者`simplexml_load_file` *认为*有。

我会加强对对象的检查：

```
// This will save the current XML to a file, so that we may check
// the EXACT data we got, instead of requesting it again and, who
// knows?, get an intact copy, or a different version altogether
$dat = file_get_contents($completeUrl);
$fp  = fopen('temp.xml', 'w');
fwrite($fp, $dat);
fclose($fp);
$xml = simplexml_load_file('temp.xml');

// Then...
$entries = $xml->entry;
for ($a = 0; $a < 300; $a++) {
    if (!isset($entries[$a]))
        die("Entries $a-300 were not found");
    // if you discover that some small country has not 300 entries,
    // then: (a) reactivate the error reporting which should have warned you,
    // (b) replace the 300 with count($entries), or the for with a foreach loop.

    // Moved $cc= here, it's more efficient.
    $cc = $entries[$a]->id;
    if (!is_object($cc))
        die("Check entry $a's 'id' in temp.xml");
    $id  = $cc->attributes('im', true)->id;

    $bundle = $cc->attributes('im', true)->bundleId;
    // $cc = $entries[$a]->id;
    $title = $entries[$a]->title; 
```

# php - 在 MAMP 上使用 CodeIgniter

> ID：12917127
> 
> 赞同：0
> 
> 时间：2012-10-16T14:34:07.947
> 
> 标签：php, apache, codeigniter, mamp, lamp

我已经安装了 MAMP，当我转到我的 localhost + :8888/MAMP/ 时，我得到了欢迎页面，但后来我下载了 CI 并将其放在 MAMP 内的“htdocs”中，但我无法获得 CI 欢迎页面。

我对设置服务器不是很有经验，我该怎么办？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T14:36:58.497

一个快速的谷歌搜索返回了这个关于设置 MAMP、CodeIgniter 和你的第一个控制器和视图的视频教程：

[安装 MAMP 和 CodeIgniter，并设置您的第一个控制器和视图](http://www.screenr.com/zj8)

这应该可以帮助您入门

# html - XSLT XML 到 HTML 交叉表

> ID：12917129
> 
> 赞同：1
> 
> 时间：2012-10-16T14:34:14.960
> 
> 标签：html, xslt, crosstab

我正在尝试从 ToDoList ( [http://www.abstractspoon.com/tdl_resources.html](http://www.abstractspoon.com/tdl_resources.html) ) 中的 XML 文件创建一个交叉表。这是一个示例 XML 文件：

```
<?xml version="1.0" encoding="utf-16" ?>
<TODOLIST PROJECTNAME="Projects">
    <TASK TITLE="proj1" ID="1" NUMPERSON="1" PERSON="Chris" NUMTAGS="1" TAG="Caro" CALCTIMEESTIMATE="36"/>
    <TASK TITLE="proj2" ID="2" NUMPERSON="1" PERSON="Chris" NUMTAGS="1" TAG="Nat" CALCTIMEESTIMATE="8" />
    <TASK TITLE="proj4" ID="4" NUMPERSON="1" PERSON="Chris" NUMTAGS="1" TAG="Caro" CALCTIMEESTIMATE="36" />
    <TASK TITLE="proj5" ID="5" NUMPERSON="1" PERSON="Sahb" NUMTAGS="1" TAG="Nat" CALCTIMEESTIMATE="128" />
    <TASK TITLE="proj32" ID="32" NUMPERSON="2" PERSON="Seb" PERSON1="Chris" NUMTAGS="1" TAG="Nat" CALCTIMEESTIMATE="0.90" />
</TODOLIST> 
```

每个任务都是一个元素，所有信息都是属性。我想制作一个这样的表格，其中标签作为第一行，人员作为第一列。

```
<table>
    <tr>
        <td></td>
        <td>Caro</td>
        <td>Nat</td>
    </tr>
    <tr>
        <td>Chris</td>
        <td>72</td>
        <td>8</td>
    </tr>
    <tr>
        <td>Sahb</td>
        <td>128</td>
        <td>0</td>
    </tr>
    <tr>
        <td>Seb, Chris</td>
        <td>0</td>
        <td>9</td>
    </tr>
</table> 
```

如您所见，同一个人可以有很多项目，我想根据标签为每个人添加 CALCTIMEESTIMATE。我可以得到第一行

```
<xsl:key name="dtag" match="/TODOLIST/TASK/@TAG" use="." />
<xsl:for-each select="TASK/@TAG[generate-id() = generate-id(key('dtag', .)[1])]">
    <td>
      <xsl:value-of select="."/>
    </td>
</xsl:for-each> 
```

但是 sum 函数并没有给出预期的结果。我错过了什么？有没有一种简单的方法可以根据两个属性进行求和？ToDoList 使用 XSLT 1.0，这就是我不能使用 distinct-values 的原因。

这是完整的 XSLT，我尝试了很多不同的东西，在这里我试图让它只为 Chris 工作，但它不会加起来他的 2 个项目。

```
<xsl:template match="TODOLIST">
<xsl:text disable-output-escaping="yes">&lt;!DOCTYPE html&gt;</xsl:text>
<html>
<head>
<title>Projects..</title>
</head>
<body>
<table>
<caption>Projects..</caption>
<thead>
<tr>
<td></td>

<xsl:for-each select="TASK/@TAG[generate-id() = generate-id(key('dtag', .)[1])]">
    <th scope="col">
      <xsl:value-of select="."/>
    </th>
</xsl:for-each>

</tr>
</thead>
<tbody>
<xsl:apply-templates select="TASK/@PERSON[generate-id() = generate-id(key('dperson', .)[1])]" />
</tbody>
</table>
</body>
</html>
</xsl:template>

<xsl:template match="TASK/@PERSON">
    <tr>
        <th scope="row">
          <xsl:value-of select="."/>
        </th>
        <xsl:apply-templates select="/TODOLIST/TASK/@TAG[generate-id() = generate-id(key('dtag', .)[1])]" />
    </tr>
</xsl:template>

<xsl:template match="/TODOLIST/TASK/@TAG">
    <td>
        <xsl:value-of select="sum(../@CALCTIMEESTIMATE[../@PERSON = 'Chris'])" />
    </td>
</xsl:template> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T16:46:28.610

要使总和起作用，您需要知道当前人员和当前标签。

在您当前匹配 TASK/@PERSON 的模板中，您应该将属性的当前值传递给下一个模板

```
<xsl:apply-templates 
   select="/TODOLIST/TASK/@TAG[generate-id() = generate-id(key('dtag', .)[1])]">
     <xsl:with-param name="PERSON" select="." />
</xsl:apply-templates> 
```

然后，在与@TAG 匹配的模板中，您可以访问 SUM 中的“dperson”键，这样您就可以将该人以及当前标签的所有任务相加，如下所示：

```
<xsl:template match="/TODOLIST/TASK/@TAG">
  <xsl:param name="PERSON" />
  <td>
    <xsl:value-of 
      select="sum(key('dperson', $PERSON)[../@TAG = current()]/../@CALCTIMEESTIMATE)"/>
  </td>
</xsl:template> 
```

# dynamic - ExtJs 4：如何创建动态菜单？

> ID：12917135
> 
> 赞同：2
> 
> 时间：2012-10-16T14:34:30.217
> 
> 标签：dynamic, extjs, menu

我在需要动态创建的面板中设置了一个菜单系统。我创建了一个客户喜欢的模拟静态菜单，但菜单类别和项目需要通过 JSON 从商店加载。

这是我静态设置的前几个菜单项的内容：

```
Ext.define('SimpleSearch.view.FacetSDL' ,{
extend: 'Ext.panel.Panel',
alias : 'widget.facetsdl',  //alias is referenced in MasterList.js
requires: ['SimpleSearch.store.SDLResults', 'FacetData' ],
title: 'Facet Search',
html: null,
frame: true,
layouts: 'fit',

items: [
  {
    id: 'group-menu',
    title: 'Browse',
    xtype: 'menu',
    plain: true,
    floating: false, 
    layouts: 'fit',
    items: [
      {
        text: 'Security',
        listeners:
          {
            click: function() { 
                     var groupmenu = Ext.ComponentQuery.query('#group-menu')[0];
                     groupmenu.hide() 
                     var securitymenu = Ext.ComponentQuery.query('#security-menu')[0];
                     securitymenu.setPosition(0,-groupmenu.getHeight(),false);
                     securitymenu.show()
                   }
          },
        menu: {        // <-- submenu by nested config object
          items: [
            {
              text: 'Classification',
              listeners:
              {
                click: function() { 
                     var groupmenu = Ext.ComponentQuery.query('#group-menu')[0];
                     groupmenu.hide() 
                     var securitymenu = Ext.ComponentQuery.query('#security-menu')[0];
                     var classificationmenu = Ext.ComponentQuery.query('#classification-menu')[0];
                     classificationmenu.setPosition(0,-groupmenu.getHeight() - securitymenu.getHeight(),false);
                     classificationmenu.show()
                } 
```

我在想也许创建一个加载所有必要数据的类，然后为“items”字段迭代该类可能是要走的路，但我不确定这是否可行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-06T21:43:07.237

我让它像这样工作：

```
var scrollMenu = Ext.create('Ext.menu.Menu');

    for (var i = 0; i < store.getCount(); ++i){
        var rec = store.getAt(i);

        var item =  new Ext.menu.Item({
            text: rec.data.DISPLAY_FIELD,
            value:rec.data.VALUE_FIELD,
            icon: 'js/images/add.png',
            handler: function(item){
                myFunction(item.value);  //Handle the item click
            }
        });

        scrollMenu.add(item);
    } 
```

然后只需添加`scrollMenu`到您的表单或容器中。希望这可以帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T15:06:36.153

您应该考虑使用 Tree 和 TreeStore。然后使用`ui:'menu'`or `viewConfig { ui: 'menu' }`config 属性将其与常规树区分开来。然后按照您的客户想要的方式设计它。

通过这种方式，您可以免费使用所有机制来动态处理数据和所有子菜单，您只需要在 CSS 方面获得一些创意。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2019-09-15T19:28:58.977

这个菜单是用 ExtJs 动态创建的，数据是从 Json 加载的。

[![使用 ExtJs 从 Json 创建一个动态菜单](../Images/5bb5e6789cdaf17ec72e176fb55b2b93.png)](https://i.stack.imgur.com/xICbS.jpg)

请参阅我的演示代码。

**在线演示：** [https ://fiddle.sencha.com/#view/editor&fiddle/2vcq](https://fiddle.sencha.com/#view/editor&fiddle/2vcq)

Json 加载： [https ://api.myjson.com/bins/1d9tdd](https://api.myjson.com/bins/1d9tdd)

代码 ExtJs：

```
//Description:  ExtJs - Create a dynamical menu from JSON
//Autor:        Ronny Morán <ronney41@gmail.com>

Ext.application({
    name : 'Fiddle',
    launch : function() {

        var formPanelFMBtn = Ext.create('Ext.form.Panel', {
                bodyPadding: 2,
                waitMsgTarget: true,
                fieldDefaults: {
                    labelAlign: 'left',
                    labelWidth: 85,
                    msgTarget: 'side'
                },
                items: [
                    {
                         xtype: 'container',
                         layout: 'hbox',
                         items: [

                         ]
                      }
                ]
        });

        var win = Ext.create('Ext.window.Window', {
                title: 'EXTJS DYNAMICAL MENU FROM JSON',
                modal: true,
                width: 680,
                closable: true,
                layout: 'fit',
                items: [formPanelFMBtn]
            }).show();

    //Consuming JSON from URL using method GET
    Ext.Ajax.request({
        url: 'https://api.myjson.com/bins/1d9tdd',
        method: 'get',
        timeout: 400000,
        headers: { 'Content-Type': 'application/json' },
        //params : Ext.JSON.encode(dataJsonRequest),
        success: function(conn, response, options, eOpts) {
                var result = Ext.JSON.decode(conn.responseText);
                //passing JSON data in 'result'
                viewMenuDinamical(formPanelFMBtn,result);
            },
        failure: function(conn, response, options, eOpts) {
                //Ext.Msg.alert(titleAlerta,msgErrorGetFin);
        }
    });

    }
});

//Generate dynamical menu with data from JSON
//Params:   formPanelFMBtn  - > Panel
//          result          - > Json data
function viewMenuDinamical(formPanelFMBtn,result){

    var resultFinTarea          = result;
    var arrayCategoriaTareas    = resultFinTarea.categoriaTareas;
    var containerFinTarea       = Ext.create('Ext.form.FieldSet', {
                                        xtype: 'fieldset',
                                        title: 'Menu:',
                                        margins:'0 0 5 0',
                                        flex:1,
                                        layout: 'anchor',
                                        //autoHeight: true,
                                        autoScroll: true,
                                        height: 200,
                                        align: 'stretch',
                                        items: [

                                        ]
    });
    var arrayMenu1              = [];

    //LEVEL 1
    for(var i = 0; i < arrayCategoriaTareas.length; i++)
    {
        var categoriaPadre          = arrayCategoriaTareas[i];
        var nombrePadre             = categoriaPadre.nombreCategoria;
        var hijosPadre              = categoriaPadre.hijosCategoria;
        var arrayMenu2              = [];

            //LEVEL 2
            for(var j = 0; j<hijosPadre.length; j++)
            {
                var categoriaHijo           = hijosPadre[j];
                var nombreHijo              = categoriaHijo.nombreHijo;
                var listaTareas             = categoriaHijo.listaTareas;
                var arrayMenu3              = [];

                    //LEVEL 3
                    for(var k = 0; k < listaTareas.length; k++)
                    {
                        var tarea = listaTareas[k];
                        var nombreTarea = tarea.nombreTarea;
                        var objFinLTres =
                        {
                            text: nombreTarea,
                            handler: function () {
                                alert("CLICK XD");
                            }
                        };
                        arrayMenu3.push(objFinLTres);
                    }

                var menuLevel3          = Ext.create('Ext.menu.Menu', {
                    items: arrayMenu3
                });

                var objFinLDos;
                    if(arrayMenu3.length > 0)
                    {
                        objFinLDos = {
                            text: nombreHijo,
                            menu:menuLevel3
                        };
                    }
                    else
                    {
                        //without menu parameter If don't have children
                        objFinLDos = {
                            text: nombreHijo
                        };
                    }

                arrayMenu2.push(objFinLDos);
            }
            var menuLevel2          = Ext.create('Ext.menu.Menu', {
                items: arrayMenu2
            });

            var objFinLUno;
            if(arrayMenu2.length > 0)
            {
                objFinLUno = {
                    text: nombrePadre,
                    menu:menuLevel2
                };
            }
            else
            {
                //without menu parameter If don't have children
                objFinLUno = {
                    text: nombrePadre
                };
            }

            arrayMenu1.push(objFinLUno);
    }

    var mymenu      = new Ext.menu.Menu({
                        items: arrayMenu1
                    });

    containerFinTarea.add({
            xtype: 'splitbutton',
            text: 'Example xD',
            menu: mymenu
        });

    formPanelFMBtn.add(containerFinTarea);
} 
```

# security - PCI - 卡数据传输

> ID：12917137
> 
> 赞同：0
> 
> 时间：2012-10-16T14:34:35.060
> 
> 标签：security, https, pci-dss, pci-compliance

我了解 PCI 合规性不仅会影响卡详细信息的存储，还会影响传输。例如，如果我只是想收集一个卡号并通过 https 传输它，这是否需要采取 PCI 合规步骤？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T15:25:44.993

PCI 确实需要保护静态和传输中的卡数据，所以是的，这需要您采取措施来遵守。

[这在使用 PCI-DSS 标签的安全堆栈交换中进行了](https://security.stackexchange.com/questions/tagged/pci-dss)详细介绍。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-27T04:32:52.167

是的，如果您在某处传输卡数据（无论 - 在用户浏览器和您的服务器之间、在您的脚本之间、在脚本、数据库和返回之间、在您的服务器和 PayPal / Authorize.net / 之间） - 您**必须**确保所有这些渠道的安全.

比如说，使用 SSL 层。使用 HTTP* *S* * 执行所有操作，而不仅仅是简单的 HTTP，并确保您的服务器的 SSL 证书正确且是最新的。

# jqgrid - 内联编辑：如何访问已编辑的行或单元格数据？

> ID：12917141
> 
> 赞同：0
> 
> 时间：2012-10-16T14:34:49.200
> 
> 标签：jqgrid

```
onSelectRow: function (id) {
    var row = jQuery('#list').jqGrid('getRowData', lastSel)

    ...
    lastSel = id;
}, 
```

在 [Docu] 中指定：[http](http://www.trirand.com/jqgridwiki/doku.php?id=wiki:methods) ://www.trirand.com/jqgridwiki/doku.php?id=wiki: methods 它不会给出实际值。我可以用什么代替？不提交最终更改的数据。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T16:43:29.453

您发布的代码太少。所以不知道你是如何实现内联编辑的。无论如何，您都会将编辑单元格的值作为相应 HTML 控件的值。一种通常`<input>`用于`<select>`编辑。因此，要获取值，您需要找到相应的 HTML 元素并*直接*获取其值。例如，您可以使用

```
$("#" + rowid + ">td:nth-child(" + (i + 1) + ")>input").val() 
```

从第 i 列或 id 等于 的行的单元格输入中获取值`rowid`。

[旧答案](https://stackoverflow.com/a/5129908/315935)展示了其他一些方法来做同样的事情。无论如何，您必须直接获取相应单元格的*值*。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-17T07:59:37.807

```
function getTextFromCell(cellNode) {
    return cellNode.childNodes[0].nodeName === "INPUT" ?
        cellNode.childNodes[0].value :
        cellNode.textContent || cellNode.innerText;
}

;

function getActualRowData(rowid) {
    var row = [];
    $('#' + rowid).find('td').each(function () {
       row.push(getTextFromCell(this));
    });
    return row;
} 
```

# java - 运动事件初始化？

> ID：12917143
> 
> 赞同：0
> 
> 时间：2012-10-16T14:34:58.953
> 
> 标签：java, android, touch-event

我正在尝试从不同的类调用 onTouch 方法，但我不知道要为 MotionEvent 传递什么。使用 null 会使应用程序强制关闭。这是代码

```
public final class Touch {

private static final String TAG = Touch.class.getSimpleName();

public boolean onTouchEvent(MotionEvent event, Droid droid, Thread thread) {
if (event.getAction() == MotionEvent.ACTION_DOWN) 
{
    droid.handleActionDown((int)event.getX(), (int)event.getY());
    /*if (event.getY() > getHeight() - 50) 
    {
        thread.setRunning(false);
        ((Activity)getContext()).finish();
    } 
    else 
    {
        Log.d(TAG, "Coords: x=" + event.getX() + ",y=" + event.getY());
    }*/
} 
if (event.getAction() == MotionEvent.ACTION_MOVE) 
{
    // the gestures
    if (droid.isTouched()) 
    {
        // the droid was picked up and is being dragged
        droid.setX((int)event.getX());
        droid.setY((int)event.getY());
    }
} 
if (event.getAction() == MotionEvent.ACTION_UP) 
{
    // touch was released
    if (droid.isTouched()) 
    {
        droid.setTouched(false);
    }
}
return true;
}
} 
```

那就是类，我将如何在主线程中调用它？目前我正在尝试：

```
public void Touch()
{
    MotionEvent event = null;
    touch.onTouchEvent(event, droid, thread);
} 
```

因为 null 是我唯一能想到的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T14:47:46.410

Try:

```
MotionEvent event = MotionEvent.obtain(downTime, eventTime, action, x, y, metaState); 
```

# c++ - 当 C++ QT GUI 中的语言更改时，代码不会更新

> ID：12917149
> 
> 赞同：0
> 
> 时间：2012-10-16T14:35:21.457
> 
> 标签：c++, qt, user-interface, translation, updates

我有一个运行多语言的程序。平台。当用户选择一种语言时，它会更改程序的整个语言，主要是字符串，并将其保存以供用户下次使用应用程序时使用。问题是如果用户更新了语言并且没有关闭应用程序，那么绘图的语言不会更新。它的方式是我的selectLang。在我的 main 中，我指向 mainApp，然后指向具有 currentlang 的 lang 类。见 main.cpp 下面的代码

```
 void MainWindow:: SelectLang(int lang)
{
    m_mainApp->m_lang->currentLang=lang;
    ui->m_actionEnglish->setChecked(lang==0);
    ui->m_actionFrench->setChecked(lang==1);
    ui->m_actionItalian->setChecked(lang==3);
    ui->m_actionSpanish->setChecked(lang==2);
    ui->m_actionRussian->setChecked(lang==4);
    ui->m_actionGerman->setChecked(lang==5);
    ui->m_actionPortuguese->setChecked(lang==6);
    UpgradeLang();
} 
```

我的 cplot 文件

```
 setAxisTitle(yLeft,(m_main->m_lang->strTab[m_main->m_lang->currentLang][45]));//this is temp c but wont translate when language changes 
```

m_main 是 MainAPP

我也是入门级和新的 QT GUI，如果您需要额外的信息，我很乐意提供

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T15:21:42.907

哪个部分没有用新语言更新？我不能清楚地理解它。你在 UpgradeLang() 中做了什么？

但我认为这个材料对你很有用：

[http://qt-project.org/wiki/How_to_create_a_multi_language_application](http://qt-project.org/wiki/How_to_create_a_multi_language_application)

上面的文章有足够的信息。

当用户触发设置时，只需使用 QTranslator 和 QApplication 来卸载旧的翻译文件并加载新的翻译文件。

# c++ - 跟随错误的原因是什么？编译 Thrift C++ 代码时出现此错误

> ID：12917150
> 
> 赞同：-3
> 
> 时间：2012-10-16T14:35:24.063
> 
> 标签：c++, cassandra, thrift

```
  thriftfs-test$ g++ -lthrift -Wall thriftfs.cpp cassandra_constants.cpp Cassandra.cpp cassandra_types.cpp -o thriftfs
    在 thriftfs.cpp:7:0 包含的文件中：
    Cassandra.h:10:24：致命错误：TProcessor.h：没有这样的文件或目录
    编译终止。
    在 cassandra_constants.h:10:0 包含的文件中，
                     来自 cassandra_constants.cpp:7:
    cassandra_types.h:10:20：致命错误：Thrift.h：没有这样的文件或目录
    编译终止。
    在 Cassandra.cpp:7:0 包含的文件中：
    Cassandra.h:10:24：致命错误：TProcessor.h：没有这样的文件或目录
    编译终止。
    在 cassandra_types.cpp:7:0 包含的文件中：
    cassandra_types.h:10:20：致命错误：Thrift.h：没有这样的文件或目录
    编译终止。
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-16T14:38:21.410

您必须包含包含目录的路径，例如：

```
g++ -lthrift -I /path/to/thriftfs/include -Wall thriftfs.cpp cassandra_constants.cpp Cassandra.cpp cassandra_types.cpp -o thriftfs 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-10-16T14:38:29.863

您忘记在 g++ 命令行中添加一些必需的 include-folder/s。

# iphone - 我的应用程序登录问题

> ID：12917151
> 
> 赞同：0
> 
> 时间：2012-10-16T14:35:26.827
> 
> 标签：iphone, objective-c, ios

我已经为我的应用程序进行了登录，因此，为了完成它，我修改了委托的方法 didfinishlaunching。在这种方法中，我从 userdefaults 中获取会话并检查是否有效（调用我的服务器）。如果正确，我加载主视图控制器，如果不正确，则加载登录视图控制器。

问题是在方法 didfinishlaunching 中我没有加载任何视图控制器，因为我正在等待来自服务器的响应。我在连接的委托中加载视图控制器。这给我带来了两个问题：

*   一个错误告诉我必须加载一个主视图控制器
*   如果我这样做了，我放了一个viewcontroller，我等待viewcontroller显示的响应的时间，它非常难看。

我认为一个解决方案可能是做另一个视图控制器，只有一个加载栏，并在我等待响应时加载它......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T14:40:49.563

我认为您可以显示其中一个视图控制器，但添加一些带有活动指示器的覆盖视图，当您获得响应时，只需删除覆盖并根据响应重新加载您的视图控制器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-16T14:41:38.090

我在我制作的应用程序中做了你所说的事情：一开始我创建了一个“SplashScreenViewController”，它的 UIImageView 等于我用作应用程序启动画面的图像。在这里，我有一个加载轮，我加载了我需要的各种数据。当我收到我需要的所有数据时，我会加载我的根控制器。

您也可以这样做，但您可以加载与会话状态相关的控制器。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-16T14:43:05.360

当 nsmainthred 正在处理时，创建一个新的 nsthred 以创建视图加载并从您的视图控制器添加子视图。当您收到响应时，从超级视图中删除此视图，并根据您的响应，调用您的其他视图控制器

# r - 用 ddply 循环几列

> ID：12917158
> 
> 赞同：3
> 
> 时间：2012-10-16T14:35:45.107
> 
> 标签：r

我有一个 df ：

`head(df)`：

```
 Year              Asset1       Asset2        Asset3 Asset4    Asset5 
1 1857              1729900        32570       288482 1251642      0                     0     67374            89832
2 1858              1870213        35255       312262 1354817      0                     0     71948            95931
3 1859              1937622        36418       322562 1399505      0                     0     76773           102364
4 1860              1969257       207557        83393 1484403      0                     0     83102           110802
5 1861              2107481       222969        89585 1594627      0                     0     85843           114457
6 1862              2306227       235498        94619 1684234      0                     0     80613           211263 
```

我`ddply`用来构造一个新的 df，其中 Asset 2:5 除以 Asset1：

```
dft<-ddply(df,.(Year),transform, 

              Asset2=Asset2/Asset1,
              Asset3=Asset3/Asset1,
              Asset4=Asset4/Asset1,
              Asset5=Asset5/Asset1) 
```

但是，如果有很多专栏，那就很安静了……有什么建议吗？

最好的祝福！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-16T15:15:51.753

这`sweep`是为了：

读入数据的（修改）版本：

```
m <- read.table(text = " Year              Asset1       Asset2        Asset3 Asset4    Asset5 
+  1857              1729900        32570       288482 1251642      0                     
+  1858              1870213        35255       312262 1354817      0                     
+  1859              1937622        36418       322562 1399505      0                     
+  1860              1969257       207557        83393 1484403      0                     
+  1861              2107481       222969        89585 1594627      0            
+  1862              2306227       235498        94619 1684234      0   ",header = TRUE,sep = "")
> m
  Year  Asset1 Asset2 Asset3  Asset4 Asset5
1 1857 1729900  32570 288482 1251642      0
2 1858 1870213  35255 312262 1354817      0
3 1859 1937622  36418 322562 1399505      0
4 1860 1969257 207557  83393 1484403      0
5 1861 2107481 222969  89585 1594627      0
6 1862 2306227 235498  94619 1684234      0

> m[,3:6] <- sweep(m[,3:6],1,m[,2],"/")
> m
  Year  Asset1     Asset2     Asset3    Asset4 Asset5
1 1857 1729900 0.01882768 0.16676224 0.7235343      0
2 1858 1870213 0.01885079 0.16696601 0.7244186      0
3 1859 1937622 0.01879520 0.16647313 0.7222797      0
4 1860 1969257 0.10539864 0.04234744 0.7537884      0
5 1861 2107481 0.10579882 0.04250809 0.7566507      0
6 1862 2306227 0.10211397 0.04102762 0.7302984      0 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-16T15:36:54.193

好的，我有 2 个`lapply`解决方案。我对上面的解决方案进行了基准测试，并且循环实际上比矢量化解决方案更快。为什么？

编辑：见 nograpes 答案。

`lapply`解决方案：

```
m[, 3:6] <- do.call(cbind, lapply(m[, 3:6], function(x) x/m[, 2]))
m 
```

和 lapply2：

```
lapply(3:6, function(i) {
    m[, i] <<- m[, i]/m[, 2]
})

#   Year  Asset1     Asset2     Asset3    Asset4 Asset5
# 1 1857 1729900 0.01882768 0.16676224 0.7235343      0
# 2 1858 1870213 0.01885079 0.16696601 0.7244186      0
# 3 1859 1937622 0.01879520 0.16647313 0.7222797      0
# 4 1860 1969257 0.10539864 0.04234744 0.7537884      0
# 5 1861 2107481 0.10579882 0.04250809 0.7566507      0
# 6 1862 2306227 0.10211397 0.04102762 0.7302984      0 
```

在具有 1000 次复制的 i7 Windows 机器上进行微基准测试：

设置：

```
LAPPLY <- function() {
    m[, 3:6] <- do.call(cbind, lapply(m[, 3:6], function(x) x/m[, 2]))
    m
}

LOOP <- function() {
    for(i in 3:ncol(m)) {
      m[ ,i] <- m[ , i]/m[ ,2]
    }
    m
}

SWEEP <- function(){
    m[,3:6] <- sweep(m[,3:6],1,m[,2],"/")
    m
}

LAPPLY2 <- function() {
    lapply(3:6, function(i) {
        m[, i] <<- m[, i]/m[, 2]
    })
        m
}

VECTORIZED <- function(){
    m[,3:6]<-m[,3:6] / m[,2]
    m
}

VECTORIZED2 <- function(){
    m[,3:6]<-unlist(m[,3:6])/m[,2]
    m
}

microbenchmark( 
    SWEEP(),
    LAPPLY(),
    LOOP(), 
    VECTORIZED(),
    VECTORIZED2(),
    LAPPLY2(),
    times=1000L) 
```

结果：

```
Unit: microseconds
           expr      min       lq    median        uq       max
1      LAPPLY() 7483.059 7577.758 7649.3655 7839.9290 41808.754
2     LAPPLY2()  563.061  602.713  618.3405  661.9585  7535.308
3        LOOP()  540.669  581.254  594.7820  626.5050 35505.929
4       SWEEP() 2544.735 2602.581 2645.9650 2735.5320  8335.814
5  VECTORIZED() 2409.452 2454.235 2494.5870 2585.5535 37313.134
6 VECTORIZED2() 8952.055 9063.081 9153.8150 9352.3085 45742.247 
```

![在此处输入图像描述](../Images/47f0f8adb67e094ec0c04b117344db19.png)

`lapply`编辑：虽然我通过将索引传递给并全局分配这是一个循环正在做的事情来加快速度（`lapply`我相信是循环的包装器）：

注意：LAPPLY2 必须最后进行基准测试，因为它会对 m 进行全局更改（并且 m 必须在运行 LAPPLY2 后重置）。演示为什么全局分配可能是危险的。

我还重复了 OP 中的数据帧 100 次（nrow x 100），以更好地模拟解决方案。

**编辑 37 部分 B：** 这是我的结果，没有复制数据框以及我如何复制数据框：

```
# Unit: microseconds
#            expr     min       lq  median       uq       max
# 1      LAPPLY() 428.710 451.5680 468.362 485.6220  1497.452
# 2     LAPPLY2() 331.212 355.9365 368.532 386.7260  1361.235
# 3        LOOP() 326.547 355.0040 369.465 383.9260  1361.235
# 4       SWEEP() 828.497 868.1490 890.541 924.5950 31512.726
# 5  VECTORIZED() 764.587 809.8370 828.497 859.9855  3042.486
# 6 VECTORIZED2() 374.596 394.6560 408.884 424.0460  1399.954

dfdup <- function(dataframe, repeats=10){
    DF <- dataframe[rep(seq_len(nrow(dataframe)), repeats), ]
    rownames(DF) <-NULL
    DF
} 
```

m <- dfdup(m, 100)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-16T15:37:18.643

我认为这是一个不错的、可读的替代方案：

```
df[,3:6]<-df[,3:6] / df[,2] 
```

如果你想让它更具可读性，你可以这样做

```
df[,paste0('Asset',2:5)]<-df[,paste0('Asset',2:5)] / df[,'Asset1'] 
```

我发现上述函数很慢，因为它被传递到`Ops.data.frame`（我认为），而且很慢。为了避免这种情况：

```
df[,3:6]<-unlist(df[,3:6])/df[,2] 
```

`lapply`但它只能与其他循环和版本一样快。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-16T15:02:55.090

这并不是真正`ddply`的目的，在这种情况下您不需要它。 `ddply`适合根据其中一列中的值将数据框拆分为行。通常，您用于拆分数据框的列（在本例中为`Year`）将具有多个具有相同值的行。

在这里，您只是将一列除以另一列。您可以按如下方式执行此操作：

```
df$Asset2 <- df$Asset2/df$Asset1 #more human-readable 
```

或者

```
df[ ,3] <- df[ ,3]/df[ ,2] #numbered columns are useful in loops 
```

我怀疑有一种矢量化的方式来做你想做的事，但除非速度是一个主要问题，否则循环这个计算非常简单：

```
#[hide under desk to avoid vectorization police]
for(i in 3:ncol(df) {
  df[ ,i] <- df[ , i]/df[ ,2]
} 
```

IMO 您可能希望重命名列，或保留旧列并制作新列，以避免混淆列是否包含比率或原始值。如果要创建新列，只需使用`df[ ,ncol(df)+1] <- df[ , i]/df[ ,2]`

# php - 在我的 php 脚本中更改什么以使 cron 作业正常工作

> ID：12917161
> 
> 赞同：0
> 
> 时间：2012-10-16T14:35:48.977
> 
> 标签：php, cron

好的，我已经研究了几个小时的 cron 工作，检查了这里的每个帖子，查看了谷歌，但我只是不明白它是如何工作的。

我已经使用我的路径设置了一个 cron 作业，我`1 * * * * /home/myuser/domains/mysite/public_html/live.php`也尝试过`/home/myuser/public_html/live.php` 似乎没有任何工作。

我必须在 php 文件 ( `live.php`) 中添加一些内容吗？那是必须执行的代码。代码本身有效。

我知道你们都会认为我很懒，但我真的想不通。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T14:42:40.957

`*.php`是常规脚本文件，与任何其他脚本语言（如 perl）一样，它需要解释器才能运行。因此，如果您想从命令行运行脚本，您可以调用解释器并将脚本文件作为参数提供，例如：

```
$ /usr/bin/php myscript.php 
```

就是这样 - 它应该运行。

或者（如果使用 linux/bsd 工作）添加**为 PHP 脚本文件的第一行**：

```
#!/usr/bin/php -q 
```

它告诉 shell 在哪里寻找这个脚本文件的解释器。请确保您的 PHP 在`/usr/bin`文件夹中，因为这可能因发行版而异。您可以使用 进行检查`which`，如下所示：

```
$ which php
/usr/bin/php 
```

如果路径正确，您还需要在脚本文件上设置可执行位，以便您可以尝试“启动它”：

```
chmod a+x myscript.php 
```

这将使它的行为与任何其他应用程序一样，因此您可以通过这种方式启动它：

```
/full/path/to/myscript.php 
```

或从当前文件夹：

```
./myscript.php 
```

这就是这种方法。它应该运行。

所以你的 crontab 行看起来（取决于选择的方法）：

```
1 * * * * /full/path/to/myscript.php 
```

或者

```
1 * * * * /usr/bin/php -q /full/path/to/myscript.php 
```

你应该使用“0”而不是“1”，因为一小时的第一分钟为零，即：

```
0 * * * * /usr/bin/php -q /full/path/to/myscript.php 
```

**编辑**

请注意 cron**工作目录**是用户的主目录。所以你需要考虑到这一点，这通常意味着使用绝对路径。或者，您可以在通话前加上`cd <script working path> && /usr/bin/php -q /full/....`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-16T14:37:02.993

也许

```
1 * * * * php /home/myuser/domains/mysite/public_html/live.php 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-16T14:38:56.713

您需要在命令行上使用 chmod 使您的脚本可执行。此外，您需要这样的东西：

```
#!/usr/bin/php
<?php
// here comes your code
?> 
```

这是告诉命令行如何执行文件所必需的。注意：这仅在您的 php 二进制文件位于 /usr/bin/php 时才有效

# ios - Jquery移动页脚上方的白色间隙

> ID：12917164
> 
> 赞同：1
> 
> 时间：2012-10-16T14:36:00.863
> 
> 标签：ios, cordova, jquery-mobile

所以我正在使用 Jquery Mobile 和 Phonegap 构建一个 Web 应用程序。该应用程序运行良好，直到我删除了一些已过时的输入字段和下拉菜单。

现在的问题是，当我单击页面的最后一个输入字段并激活 ios 键盘时，页脚栏不再固定，页脚栏和 ios 键盘之间有一个白色间隙。当键盘再次隐藏时，我看到整页，但白色间隙在页脚上方。

这在 Android 平台上似乎不是问题，所以我想知道这是否是 CSS 问题。帮助肯定是受欢迎的。这是有问题的页面代码...

```
<div data-role="page"  data-theme="f" id="">
        <div data-role="header" class="ui-state-persist">
            <a href="#" data-icon="arrow-l" data-direction="reverse" data-iconpos="notext"></a>
            <h1>text</h1>
            <a href="#" data-icon="arrow-r" data-iconpos="no text"></a>
        </div>
            <div data-role="content">
                <label for="">Text</label>
                <input type="text" name="text" id="" value="" class="input-field required"/>
                <label for="">Text</label>
                <input type="text" name="" id="" value="" class="input-field required"/>
                <label for="">Text</label>
                <input type="text" name="" id="" value="" class="input-field required"/>
                <label for="">Text</label>
                <input type="" name="" id="" value="" class="input-field required"/>
            </div>
            <div data-role="footer" class="ui-state-persist"  style="min-height:42px;">
                <a href="#" data-icon="arrow-l" data-direction="reverse" data-iconpos="left" style="margin-left: 10px; margin-top: 5px">Done</a>
                <a href="#main_menu" data-icon="home" data-direction="reverse" data-iconpos="notext" style="float: right; margin-right: 10px; margin-top: 5px"></a>
            </div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T22:42:00.110

试试下面的代码（使用 jQuery Mobile 版本 1.2.0）：

```
<div data-role="page"  data-theme="f" id="quickquote_insured">

    <div data-role="header" class="ui-state-persist">
        <a href="#quickquote_menu" data-icon="arrow-l" data-direction="reverse" data-iconpos="notext"></a>
        <h1>Contact Details</h1>
        <a href="#quickquote_driver_profile" data-icon="arrow-r" data-iconpos="notext"></a>
    </div>

    <div data-role="content">
        <label for="quickquote-insured_initials">Initials:</label>
        <input type="text" name="quickquote-insured_initials" id="quickquote-insured_initials" value="" class="input-field required"/>
        <label for="quickquote-insured_surname">Surname:</label>
        <input type="text" name="quickquote-insured_surname" id="quickquote-insured_surname" value="" class="input-field required"/>
        <label for="quickquote-insured_phone_number">Mobile number:</label>
        <input type="text" name="quickquote-insured_phone_number" id="quickquote-insured_phone_number" value="" class="input-field required"/>
        <label for="quickquote-insured_email_address">e-Mail address:</label>
        <input type="email" name="quickquote-insured_email_address" id="quickquote-insured_email_address" value="" class="input-field required"/>

        <br>

    </div>

    <div data-role="footer" class="ui-state-persist"  style="min-height:42px;">
        <a href="#quickquote_menu" data-icon="arrow-l" data-direction="reverse" data-iconpos="left" style="margin-left: 10px; margin-top: 5px">Done</a>
        <a href="#main_menu" data-icon="home" data-direction="reverse" data-iconpos="notext" style="float: right; margin-right: 10px; margin-top: 5px"></a>
    </div>

</div> 
```

我知道它可能看起来很简单，但我只是`<br>`在您的电子邮件输入字段下方添加了一个。

我认为问题在于，由于您的页脚是“静态的”，您需要“填充”您的页面。

例如，如果您的页面上的字段很少，并且您没有“填充”您的页面，您将得到以下结果：

![1](../Images/db517a7ef58fe39576f75b14b397f6b2.png)

希望这可以帮助。

# java - java打印带有Arrays.toString（）错误的数组

> ID：12917166
> 
> 赞同：3
> 
> 时间：2012-10-16T14:36:09.183
> 
> 标签：java, arrays, tostring

所以我试图在我的程序中打印一个整数数组，并按照这些说明[打印Java数组的最简单方法是什么？](https://stackoverflow.com/questions/409784/simplest-way-to-print-an-array-in-java)

编写了以下代码：

```
 int[] totals = //method that returns int array
    System.out.println(Arrays.toString(totals)); 
```

但它不会编译说

> “类 Object 中的 toString 方法不能应用于给定类型。必需：未找到参数：int [] 原因：实际参数列表和形式参数列表的长度不同”

为什么这样做？我不将我的数组作为参数传递给 toString 吗？如果没有，我该如何使用 toString？

谢谢！

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-10-16T14:41:01.633

> 类 Object 中的 toString 方法不能应用于给定类型。必需：未找到参数：int[] 原因：实际参数列表和形式参数列表的长度不同

可能是您有一个名为 的变量`Arrays`，这就是为什么编译器抱怨您正在尝试调用`Object.toString()`不带任何参数的 。

尝试

```
 System.out.println(java.util.Arrays.toString(totals)); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-16T14:39:52.747

它说“Object 类中的 toString 方法不能应用于给定类型”的事实。让我觉得您可能没有正确导入`java.util.Arrays`该类，或者您有其他一些名为`Arrays`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-16T14:42:59.920

这对我有用：

```
int[] totals = {1,2};
System.out.println(Arrays.toString(totals)); 
```

印刷：

```
[1, 2] 
```

你确定你至少使用**JDK 5**吗？

实际上，`Arrays.toString(int[] a)`仅在 JDK 5 之后才存在。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-10-16T14:38:25.763

你为什么不试试::

```
int[] totals = //method that returns int array
    System.out.println(totals.toString()); 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-10-16T14:40:42.500

你的方法似乎没有初始化你的数组，试试这个：

```
int[] totals = new int[10]; //method that returns int array
System.out.println(Arrays.toString(totals)); 
```

# validation - grails整数字段默认验证

> ID：12917167
> 
> 赞同：2
> 
> 时间：2012-10-16T14:36:09.933
> 
> 标签：validation, grails, integer, constraints

我有一个 grails 域类，如下所示：

```
class Person {
  String name
  int age
} 
```

当我显示默认的“创建”视图（使用脚手架）时，年龄字段显示为必填字段（旁边有一个星号）。有没有办法让它显示为非必需并默认为空白？

我试过添加

```
constraints = {
    age blank:true, nullable:true
} 
```

这导致该字段被允许为空，但它仍然显示在它旁边的星号。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-16T14:40:06.307

An`int`是基本类型，不能为空。您必须将其更改为`Integer`，然后 null 值将意味着它是空白的。

# ruby-on-rails - 在没有实际控制器/动作的情况下使用 Devise 验证自定义 url (Rails)

> ID：12917171
> 
> 赞同：0
> 
> 时间：2012-10-16T14:36:22.973
> 
> 标签：ruby-on-rails, devise

我在我的应用程序中使用 Devise gem，它工作正常。

我使用omniauth 对Twitter 用户进行身份验证，当用户输入用户时，`http://www.mydomain.com/addtwitter`将被重定向到Twitter 身份验证页面。

在设计 gem 中，默认情况下，当用户加载页面时`/auth/twitter`，它会将用户带到授权页面。所以为了定制这个，我在我的`routes.rb`文件中添加了下面的代码。

`match "/addtwitter" => redirect("/auth/twitter")`

但我想`/addtwitter`只为登录用户提供该功能。

我如何在不实际在 Rails 中创建控制器/动作的情况下实现这一点？

这甚至可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T14:51:52.890

在设计中，您可以指定仅适用于登录用户的路由。

```
authenticated :user do
  match "/addtwitter" => redirect("/auth/twitter")
end 
```

# objective-c - 使用 [self performSelector:@selector] 调用 NSObject 超类方法？

> ID：12917175
> 
> 赞同：0
> 
> 时间：2012-10-16T14:36:33.867
> 
> 标签：objective-c, xcode, methods

我有一个 NSObject 的子类，我想在其中立即调用（一种 -(void)viewDidLoad）方法（在这种情况下加载 MkMapView）：这样做的更好方法是什么？我想我不能使用 viewDidLoad，所以我可以使用 performSelector 吗？

```
SubClass.h

@interface Mysubclass : NSObject <MKMapViewDelegate> {
} 
```

SubClass.m（第一种选择）

```
-(id)init{
 self = [super init];
 if ( self != nil ) {
 // THE CODE TO INITIALIZE MKMAPVIEW
}
return self
} 
```

或 SubClass.m（第二选择）

```
-(id)init{
 [self performSelector:@selector(myMethod)];
 return self;
}

-myMethod{
 // THE CODE TO INITIALIZE MKMAPVIEW
} 
```

什么是更好（或正确）的选择？可以避免-(id)init 吗？或者每次我添加一个子类时，要调用一个方法我必须将它写入-(id)init？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T14:51:30.847

没有理由`-performSelector:`在这种情况下使用。如果要添加一个`MKMapView`在创建对象时初始化的方法，请从`if (self)`块中调用该方法：

```
- (id)init
{
    self = [super init];
    if (self) {
        [self setupMapView];
    }
    return self;
}

- (void)setupMapView
{
    // THE CODE TO INITIALIZE MKMAPVIEW
} 
```

是否有第二种方法`-setupMapView`或简单地将用于设置的代码留在`MKMapView`方法`if (self)`块中`-init`或将代码分解为第二种方法`-setupMapView`称为 from ，这是个人喜好/风格的问题`-init`。

话虽如此，听起来您的设置可能会出现其他问题。您的 MKMapView 应该 [最有可能] 在一个`UIViewController`子类中（可能有一个关联的`XIB`），因此您将可以访问`-viewDidLoad`. 请注意，您的`UIViewController`子类将充当您的`MKMapView`.

### 更新 1

在您的`UIViewController`子类实例中（我假设您调用了它`ViewController`，您应该有`IBOutlet`一个`MKMapView`对象。`ViewController.h`通过（1）添加一个**实例变量来执行此操作**

```
@interface ViewController : UIViewController
{
    IBOutlet MKMapView *myMap;
}
@end 
```

或通过（2）添加一个**属性**

```
@interface ViewController : UIViewController
@property (nonatomic, strong, readwrite) IBOutlet MKMapView *myMap;
@end 
```

现在`ViewController.xib`在 Interface Builder 中打开。你应该有一个`MKMapView`内部视图。如果您还没有，请从对象库中添加一个。右键单击`File's Owner`。找到该项目所在的行`myMap`。从行右端的圆圈拖动到`MKMapView`可见视图中的 。

你的`ViewController`班级现在有了一个通向`MKMapView`. 加载后，您将能够向`MKMapView`视图控制器视图的子视图发送消息。

您应该为您的`SubClass`实例提供一个属性或实例变量，这样它就不会在`-viewDidLoad`返回后立即被破坏。通过将实例变量添加到`ViewController.h`

```
@interface ViewController : UIViewController
{
    IBOutlet MKMapView *myMap;
    SubClass *istance;
}
@end 
```

或通过添加属性

```
@interface ViewController : UIViewController
@property (nonatomic, strong, readwrite) IBOutlet MKMapView *myMap;
@property (nonatomic, strong, readwrite) SubClass *istance;
@end 
```

现在，在 中`ViewController.m`，您需要定义`-viewDidLoad`以便将`self.istance`其设置为 的委托`self.myMap`。在评论中，我建议创建自己的初始化程序`-initWithMapView:`。如果您打算对 .`SubClass`进行一些广泛的设置`MKMapView`，那是有道理的。如果您只想`SubClass`成为 的代表`MKMapView`，则不需要这样的方法。

让我们考虑这两种情况：

(1) 使用方法`-[SubClass initWithMapView:]`：

在`ViewController.m`你将拥有（在 之`@implementation`内`ViewController`）

```
- (void)viewDidLoad
{
    self.istance = [[SubClass alloc] initWithMapView:self.myMap];
} 
```

在`SubClass.h`你将拥有（在 之`@interface`内`SubClass`）

```
- (id)initWithMapView:(MKMapView *)mapView;
@property (nonatomic, weak, readwrite) MKMapView *mapView; 
```

在`SubClass.m`你将拥有（在 之`@implementation`内`SubClass`）

```
- (id)initWithMapView:(MKMapView *)mapView
{
    self = [super init];
    if (self) {
        self.mapView = mapView;
        self.mapView.delegate = self;
        //more setup of mapView.
    }
    return self;
} 
```

(2) 使用`-[SubClass init]`：

相反，`ViewController.m`您将拥有

```
- (void)viewDidLoad
{
    self.istance = [[SubClass alloc] init];
    self.myMap.delegate = self.istance;
} 
```

# plc - “MOVE”块的目的？

> ID：12917177
> 
> 赞同：4
> 
> 时间：2012-10-16T14:36:48.350
> 
> 标签：plc

当输出只是在功能块图中分配输入值时，使用 MOVE 块而不是直接连接有什么区别？

![移动示例](../Images/0a5985a362043f5b856780029e3ba032.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T23:24:39.723

“连线”告诉您，左边的梯形代码（AND、OR、...）计算的*布尔*值在右边使用。它不会导致任何“记忆”发生变化。（你只画电线会使图表变得混乱；你真的应该在电线的两端显示操作员。）

MOVE 操作符使任何类型的一个内存位置的内容有条件地复制到另一个。使用 MOVE 运算符，您可以将整数、浮点数或其他更复杂的值复制到新目标；我不记得您是否也可以进行值强制（例如，int to float），但我猜这因控制器而异。作为副作用，MOVE 运算符将左侧的输入布尔值复制到右侧的输出布尔值；梯形逻辑中的大多数“块”操作符都是这样做的。但是该输入布尔值控制块是否实际执行其操作。在您的示例中，您显示了 MOVE 块，但没有显示关键参数： from 和 to 位置；喂它的“线”控制着移动是否真的发生。所以一个更好的移动示例是：

```
---| X |------| MOVE(P,Q) |---( Y )--- 
```

这就是说，“如果 X 为真，则将 P 复制到 Q，并将真（来自 X）分配给 Y；如果 X 为假，则不移动任何内容，并将假（来自 X）分配给 Y。” （X 的布尔值通过 MOVE 块复制）。

由于 MOVE 适用于任何类型，因此您可以使用 MOVE 将内存位置中的布尔值复制到另一个位置；想象一下上面的 P 和 Q 是布尔变量。但是，布尔条件和操作同样有效：

```
---| X |----( Y )--- 
```

将 X 的布尔值复制到 Y 的布尔值。

要真正模拟布尔 MOVE 命令，例如“如果 X 为真，则有条件地将布尔 P 复制到 Q”需要一些复杂的布尔逻辑：

```
--+--| X |----| P |---+--( Y )----
  |                   |
  |--| *X |---| Y |---| 
```

其中 *X 表示“不是 X”。MOVE 更容易“编写”。

# cakephp - 多个应用程序可以共享同一个 ACL 表吗？

> ID：12917178
> 
> 赞同：2
> 
> 时间：2012-10-16T14:36:49.590
> 
> 标签：cakephp, acl, cakephp-2.2

目前，我必须与许多 CakePHP 应用程序共享我的数据库，并且这些表都带有前缀以分别标识每个应用程序。

那么，多个应用程序可以共享同一个 ACL 表吗？

或者，我可以更改表 ACL 的默认名称并添加每个应用程序的前缀，例如。app_aros、app_acos、app_aros_acos？

```
/* beforeFilter() @ AppController */
$this->Acl->Aro->useTable = 'app_aros';
$this->Acl->Aco->useTable = 'app_acos'; 
```

此代码有效，但我还没有找到更改模型权限表名的方法...

建议？我能做什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-17T07:40:12.963

您已在所有应用程序的 app/Config/core.php 中更改此行

```
Configure::write('Acl.database', 'default'); 
```

到：

```
Configure::write('Acl.database', 'your_acl_connection'); 
```

并在 app/Config/database.php 中添加连接

例子：

```
public $your_acl_connection = array(
        'datasource' => 'Database/Mysql',
        'persistent' => false,
        'host' => 'localhost',
        'login' => 'user',
        'password' => 'password',
        'database' => 'database_name',
        'prefix' => '',
        //'encoding' => 'utf8',
    ); 
```

简单地说，您将拥有一个用于管理您所有应用程序 ACL 的数据库。在此数据库中，您创建所有 ACL 表。

# linux - 在 Linux 上：我们看到以下内容：物理内存、真实内存、交换内存、虚拟内存 - 我们应该考虑哪个来确定大小？

> ID：12917179
> 
> 赞同：3
> 
> 时间：2012-10-16T14:36:55.747
> 
> 标签：linux, memory, virtual, ram

我们使用一个工具（Whats Up Gold）来监控 Linux Box 上的内存使用情况。我们看到与以下相关的内存使用情况（图表）：

物理、真实、交换、虚拟内存和所有内存（*这是所有这些的平均值*）。

```
'The ALL' Memory graphs show low memory usage of about: 10%. 
But Physical memory shows as 95% used.
Swap memory shows as 2% used. 
```

那么，我需要在这个 Linux Box 上增加内存吗？换句话说，我应该通过：

*   ALL 内存图（表示内存情况良好）或
*   物理内存图（表示内存情况很糟糕）。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-16T14:57:00.300

**真实的和物理的**

物理内存是当前使用的 DRAM 数量。实际内存显示您的应用程序使用系统 DRAM 内存的程度。它大致低于物理内存。Linux系统缓存了一些磁盘数据。这种缓存是物理内存和真实内存之间的区别。实际上，当您有空闲内存时，Linux 会使用它进行缓存。不用担心，因为您的应用程序需要内存，它们会取回缓存空间。

**交换和虚拟**

交换是实际 DRAM 的额外空间。这个空间是从磁盘空间借来的，一旦你的应用程序填满了整个 DRAM，Linux 会将一些未使用的内存转移到交换空间以让所有应用程序保持活动状态。交换和物理内存的总和是虚拟内存。

**你需要额外的内存吗？**

在回答您的问题时，您需要检查真实内存。如果您的真实内存已满，则需要获得一些 RAM。使用`free`命令检查实际可用内存量。例如在我的系统上`free`说：

```
$ free
                 total       used       free     shared    buffers     cached
    Mem:      16324640    9314120    7010520          0     433096    8066048
    -/+ buffers/cache:     814976   15509664
    Swap:      2047992          0    2047992 
```

您需要检查缓冲区/缓存部分。如上所示，我的系统上有真正的 15 GB 空闲 DRAM（第二行）。在你的系统上检查这个，看看你是否需要更多的内存。这些线分别代表物理内存、真实内存和交换内存。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-05-23T14:57:29.243

# 免费-m

至于关于linux内存不足的免费工具analisys，我有一些实验证明的观点（实践）

```
~# free -m
              total        used        free      shared  buff/cache   available
Mem:           2000         164         144        1605        1691         103 
```

你应该总结 'used'+'shared' 并与 'total' 比较

其他列没用只是混淆而已

我会说

```
[ total - (used + shared ) ] should be always at least > 200 MB 
```

如果您在 meminfo 中检查 MemAvailable，您也可以获得几乎相同的数字：

```
# cat /proc/meminfo
MemAvailable:     107304 kB 
```

MemAvailable - 是在主动交换发生之前 linux 认为现在真正空闲的内存量。所以现在你最多可以消耗 107304 kB。如果你消耗更多的大交换开始发生。

MemAvailable 也与实际实践有很好的相关性。

# dhtml - OpenLaszlo 标记/iframe 集成和 JavaScript 调用

> ID：12917190
> 
> 赞同：1
> 
> 时间：2012-10-16T14:37:21.863
> 
> 标签：dhtml, openlaszlo, lzx

我正在尝试调用我正在插入的 html 数据中存在的一个 javascript 函数，但我总是收到错误 getLoaded is not a method。我附上了代码片段。怎么了 ？

```
<canvas width="100%" height="100%" >
        <simplelayout axis="y" spacing="2"/>
            <button>Set HTML
                <handler name="onclick">
                    <![CDATA[
                    if (canvas.main) {
                        canvas.main.setAttribute('html', '<html><head><style type="text/css">body {background-color: #ffffff;}</style><script>function getLoaded(){ return document.images.length;}</script></head><body><img id="imageTag" ></img></body></html>');
                    }
                    ]]>
                </handler>
            </button> 

               <button>test
                <handler name="onclick">
                    <![CDATA[
                    if (canvas.main) {
                        var del = new LzDelegate(this,'handlerFunc');
                        canvas.main.callJavascript('getLoaded',del);
                    }
                    ]]>
                </handler>
            </button> 
            <method name="handlerFunc" args="retVal">
                console.log("handlerFunc", retVal);
            </method>

        <html name="main" x = "50" y="50" width="600" height="400" >
            <handler name="oninit">
                this.bringToFront();
            </handler>

        </html>

</canvas> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-17T16:07:49.973

这是一个适用于 SWF10 和 DHTML 运行时的解决方案。我已经用 IE 9、Firefox 和 Chrome 进行了测试。

您的代码有两个问题：

1) 您分配给 <html> 标记的@html 属性的 HTML 片段不应包含完整的 HTML 文档结构。这是 iframemanager.js 库（OpenLaszlo 的一部分）中的 JavaScript，用于将 HTML 片段分配给 iFrame：

```
,setHTML: function(id, html) { 
    // must be called after the iframe loads, or it will be overwritten
    if (html) {
        var win = lz.embed.iframemanager.getFrameWindow(id);
        if (win) {
            win.document.body.innerHTML = html;
        }
    }
} 
```

可以看到，html参数的值被赋值给了body元素的innerHTML。因此，仅包含您正在生成的 HTML 文档的正文就足够了。

2) 如果要将 JavaScript 部分添加到 iFrame，则不能将这些部分内联到要分配给文档的 HTML 代码中，而必须创建一个“脚本”元素，如下面的完整示例所示。如果你想同时支持 SWF 运行时，最有效的方法是创建一个小的外部 JavaScript 函数，它有一个帮助函数，如下所示。

我为此解决方案创建了两个文件。LZX 文件和一个名为`iFrameHelperFunction.js`.

这是您的 LZX 文件的修改版本：

```
 <canvas width="100%" height="100%" >

  <wrapperheaders>
    <script type="text/javascript" src="iFrameHelperFunction.js"></script>
  </wrapperheaders>

  <simplelayout axis="y" spacing="2"/>

  <button>Set HTML
     <handler name="onclick">
     <![CDATA[
        if (canvas.main) {
          // Create the HTML content; do not include <html><head><body> structure here,
          // since setting the 'html' attribute of an OpenLaszlo <html> tag will set
          // the innerHTML property of the iFrame's document.body.
          var innerHTML = '<style type="text/css">body {background-color: #ff0000;}</style>'
                   + '<img id="imageTag" src="https://www.google.com/images/srpr/logo3w.png"></img>',
              jsCode = "function getLoaded() { alert('inside getLoaded()'); return 'getLoaded was called'; }";
          canvas.main.setAttribute('html', innerHTML);
          lz.Browser.callJS('addJavaScriptToFrame("' + canvas.main.iframeid + '", ' + jsCode + ')');
        }
        ]]>
    </handler>
  </button>

  <button>test
    <handler name="onclick">
    <![CDATA[
      if (canvas.main) {
        var del = new LzDelegate(canvas, 'handlerFunc');
        canvas.main.callJavascript('getLoaded', del);
      }
    ]]>
    </handler>
  </button>

  <method name="handlerFunc" args="retVal">
    Debug.info("handlerFunc", retVal);
  </method>

  <html name="main" x = "50" y="50" width="600" height="200" >
    <handler name="oninit">
      this.bringToFront();
    </handler>
  </html>

</canvas> 
```

首先，我将自定义 JavaScript 文件添加到页面中：

```
 <wrapperheaders>
    <script type="text/javascript" src="iFrameHelperFunction.js"></script>
  </wrapperheaders> 
```

然后设置为 iFrame 截取的 HTML，类似于您的代码。但是任何添加到 iFrame HTML 页面的 JavaScript 都必须使用`addJavaScriptToFrame`定义在以下位置的帮助函数添加`iFrameHelperFunction.js`：

```
function addJavaScriptToFrame(frameId, jsCode) {
    var iframeWin = lz.embed.iframemanager.getFrameWindow(frameId);
        doc = iframeWin.document;

    // Scripts can not be inlined in HTML snippets, but must be created through JavaScript
    var scriptEl = doc.createElement('script');
    // The JavaScript function or code you want to add
    scriptEl.text = jsCode;

    // Append the script to the head of the iFrame document
    doc.firstChild.appendChild(scriptEl);
} 
```

将 JavaScript 添加到 LZX 文件中的 iFrame 的调用：

```
 lz.Browser.callJS('addJavaScriptToFrame("' + canvas.main.iframeid + '", ' + jsCode + ')'); 
```

单击“设置 HTML”按钮设置框架的内容，然后单击“测试”按钮调用 iFrame 内部的 getLoaded() 函数。

![通过 JavaScript 动态设置 iFrame 内容的示例 OpenLaszlo 应用程序](../Images/e624b9693ca93b235e030b59dce91cfd.png)

# javascript - 如何创建检测浏览器类型并相应重定向的 Google 协作平台脚本？

> ID：12917193
> 
> 赞同：1
> 
> 时间：2012-10-16T14:37:26.250
> 
> 标签：javascript, android, iphone, ios

我想创建一个 Google Sites 脚本，它可以检测我的访问者是使用 Android 还是 iOS，然后将他们相应地重定向到 AppStore 或 Google Play。这将允许我只为所有设备宣传一个二维码。有没有办法轻松设置它并将其托管在 Google 协作平台上？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T14:48:01.850

Well the script needs to inspect the HTTP_USER_AGENT header, and do something like this: [Common link to open iOS, Android and BlackBerry app](https://stackoverflow.com/questions/10520655/common-link-to-open-ios-android-and-blackberry-app)

Bear in mind that not everyone on an Android-based device has the Google Play store (e.g. Kindle Fire -> Amazon Appstore); unfortunately getting the user to an appropriate app store on Android is tricky because there are many options.

# linux-kernel - Linux设备驱动程序，程序从哪里开始？

> ID：12917198
> 
> 赞同：1
> 
> 时间：2012-10-16T14:37:52.837
> 
> 标签：linux-kernel, linux-device-driver

我已经开始学习 Linux 驱动程序，但我发现它有点困难。

我一直在研究 i2c 驱动程序，我对驱动程序的入口点感到很困惑。驱动程序是否从`MOUDULE_INIT()`宏开始？

而且我也想知道如何才能知道驱动程序运行的过程。我得到了这本书，Linux 设备驱动程序，但我仍然很困惑。你可以帮帮我吗？非常感谢。

我将以 i2c 驱动程序为例。里面有这么多功能，我只想知道如何才能在i2c驱动程序中获得功能的协调关系？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-16T20:44:12.953

设备驱动程序不是具有`main {}`起点和出口点的“程序”。它更像是一个 API 或一个库或一组例程。在这种情况下，它是一组由,声明的*入口点*，以及列出*操作*入口点的结构。`MODULE_INIT()``MODULE_EXIT()``EXPORT_SYMBOL()`

 *对于*块设备*`include/linux/blkdev.h`，驱动程序应该通过在 (from )中为这些操作声明其函数来提供它可以执行的操作列表：

```
struct block_device_operations {
        int (*open) ();
        int (*release) ();
        int (*ioctl) ();
        int (*compat_ioctl) ();
        int (*direct_access) ();
        unsigned int (*check_events) ();
        /* ->media_changed() is DEPRECATED, use ->check_events() instead */
        int (*media_changed) ();
        void (*unlock_native_capacity) ();
        int (*revalidate_disk) ();
        int (*getgeo)();
        /* this callback is with swap_lock and sometimes page table lock held */
        void (*swap_slot_free_notify) ();
        struct module *owner;
}; 
```

对于*char devices*`include/linux/fs.h` ，驱动程序应通过在 (from )中为这些操作声明其函数来提供它可以执行的操作列表：

```
struct file_operations {
        struct module *owner;
        loff_t (*llseek) ();
        ssize_t (*read) ();
        ssize_t (*write) ();
        ssize_t (*aio_read) ();
        ssize_t (*aio_write) ();
        int (*readdir) ();
        unsigned int (*poll) ();
        long (*unlocked_ioctl) ();
        long (*compat_ioctl) ();
        int (*mmap) ();
        int (*open) ();
        int (*flush) ();
        int (*release) ();
        int (*fsync) ();
        int (*aio_fsync) ();
        int (*fasync) ();
        int (*lock) ();
        ssize_t (*sendpage) ();
        unsigned long (*get_unmapped_area)();
        int (*check_flags)();
        int (*flock) ();
        ssize_t (*splice_write)();
        ssize_t (*splice_read)();
        int (*setlease)();
        long (*fallocate)();
}; 
```

对于*平台设备*`include/linux/platform_device.h`，驱动程序应通过在 (from ) 中为这些操作声明其功能来提供它可以执行的操作列表：

```
struct platform_driver {
        int (*probe)();
        int (*remove)();
        void (*shutdown)();
        int (*suspend)();
        int (*resume)();
        struct device_driver driver;
        const struct platform_device_id *id_table;
}; 
```

驱动程序，尤其是字符驱动程序，不必支持列出的每个操作。请注意，有一些宏可以通过命名结构条目来促进这些结构的编码。

> 驱动程序是否从 MOUDLUE_INIT() 宏开始？

中指定的驱动程序的*init()*例程`MODULE_INIT()`将在引导期间（静态链接时）或动态加载模块时调用。*当驱动程序在其init()期间**注册*自己时，驱动程序将其操作结构传递给设备的子系统。

 *这些设备驱动程序入口点，例如*open()*或*read()*，通常在用户应用程序调用 C 库调用（在用户空间中）和切换到内核空间之后执行。请注意，您正在查看的 i2c 驱动程序是*叶*设备使用的总线的[平台驱动程序](http://www.kernel.org/doc/Documentation/driver-model/platform.txt)，其公开的功能将由其他驱动程序调用。*`EXPORT_SYMBOL()`*

 *只有在中指定的驱动程序的*init()*例程`MODULE_INIT()`才​​能保证被调用。只有在动态卸载模块时/当模块被动态卸载时，才会执行中指定的驱动程序的*exit()*例程。`MODULE_EXIT()`驱动程序的操作例程将以未知的顺序被异步调用（就像它的中断服务例程一样）。希望用户程序在发出*read()*或*ioctl()*操作之前调用*open()*，并以合理的方式调用其他操作。一个编写良好且健壮的驱动程序应该适应任何操作顺序或顺序，并产生合理的结果以确保系统完整性。

 *** * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-16T14:58:37.067

停止将设备驱动程序视为程序可能会有所帮助。他们完全不同。一个程序有一个特定的起点，做一些事情，并且有一个或多个相当明确的（好吧，无论如何他们应该）退出点。驱动程序在第一次加载时有一些事情要做（例如`MODULE_INIT()`和其他事情），并且可能会或可能永远不会再做任何事情（您可以强制加载系统实际没有的硬件的驱动程序），并且可能有一些如果驱动程序被卸载，需要做的事情。除此之外，驱动程序通常会提供一些特定的入口点（系统调用、ioctl 等），用户级应用程序可以访问这些入口点以请求驱动程序执行某些操作。

可怕的类比，但想想一个有点像汽车的程序——你上车，启动它，开车到某个地方，然后下车。司机更像是一台自动售货机——你把它插上电源并确保它有货，但人们只是偶尔过来按下按钮让它做点什么。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-06-02T07:00:46.793

实际上，您首先要了解（I2C）平台（本机）驱动程序，您需要了解平台驱动程序的 MOUDULE_INIT() 与其他可加载模块的调用方式。

```
/*
* module_init() - driver initialization entry point
* @x: function to be run at kernel boot time or module insertion
* module_init() will either be called during do_initcalls() (if
* builtin) or at module insertion time (if a module).  There can only
* be one per module.*/ 
```

对于 i2c 驱动程序，您可以参考此链接[http://www.linuxjournal.com/article/7136](http://www.linuxjournal.com/article/7136)和 [http://www.embedded-bits.co.uk/2009/i2c-in-the-2632-linux-kernel /](http://www.embedded-bits.co.uk/2009/i2c-in-the-2632-linux-kernel/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-02-29T11:56:21.050

内核模块的开始是从初始化函数开始，主要是在函数名前面加上宏**__init**。

__init 宏向 linux 内核指示以下函数是一个初始化函数，一旦执行初始化函数的代码，用于该初始化函数的资源将是空闲的。

还有其他的marcos，用于检测初始化和释放函数，命名为module_init()和module_exit()[如上所述]。

如果设备驱动程序的目标是在运行时作为可加载和可删除的内核模块运行[即使用 insmod 或 rmmod 命令]，则使用这两个宏

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-08-10T06:49:04.427

简而言之：它从 .probe 开始，并在您执行 insmod 时一直到 init。这也将驱动程序注册到驱动程序子系统并启动 init。每次从用户应用程序调用驱动程序功能时，都会使用回调调用函数。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-10-16T15:22:17.427

《Linux 设备驱动程序》是一本好书，但是太旧了！

基本示例：

```
#include <linux/module.h>
#include <linux/version.h>
#include <linux/kernel.h>

MODULE_LICENSE("GPL");
MODULE_AUTHOR("Name and e-mail");
MODULE_DESCRIPTION("my_first_driver"); 

static int __init insert_mod(void)
{
    printk(KERN_INFO "Module constructor");
    return 0;
}

static void __exit remove_mod(void)
{
    printk(KERN_INFO "Module destructor");
}

module_init(insert_mod);
module_exit(remove_mod); 
```

最新的教程，写得真好，是《[Linux 设备驱动系列](https://www.opensourceforu.com/2010/11/understanding-linux-device-drivers/)》*****

# fonts - 在 xpages 中使用图标字体

> ID：12917201
> 
> 赞同：2
> 
> 时间：2012-10-16T14:37:57.343
> 
> 标签：fonts, twitter-bootstrap, icons, xpages, font-awesome

我想在我的 xpage 中使用图标（真棒）字体。我下载了它并将它们放入我的 webContent 文件夹（作为我所有的附加内容。例如引导程序）。我修改了 awesome.css 如下。

```
@font-face {
  font-family: "FontAwesome";
  src: url('/font/fontawesome-webfont.eot');
  src: url('/font/fontawesome-webfont.eot?#iefix') format('eot');
  src: url('/font/fontawesome-webfont.woff') format('woff');
  src: url('/font/fontawesome-webfont.ttf') format('truetype');
  src: url('/font/fontawesome-webfont.svg#FontAwesome') format('svg');
  font-weight: normal;
  font-style: normal;
} 
```

并将一个放入我的页面。

```
<i class="icon-refresh"></i> 
```

结果是。我在页面中看到了该图标字体的占位符，并在 firebug 中看到了两条错误消息。

"NetworkError: 404 Not Found - http://localhost/home.nsf/xsp/.ibmmodres/font/fontawesome-webfont.woff" "NetworkError: 404 Not Found - http://localhost/home.nsf/xsp/。 ibmmodres/font/fontawesome-webfont.ttf"

因此加载字体不起作用（文件位于该文件夹字体中，而我正在使用的其他 css 和 js 文件使用相同的方法加载）。我使用引导程序并停用了下载图标（但我对那里的字形有同样的问题）。

所以也许有人有一个想法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T01:02:06.310

删除第一个斜线，应该这样做。

计划 B：将字体移动到资源目录中（如果您使用 Java 透视图，则可以创建字体目录）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-15T01:26:39.960

我发现这是我的服务器（在本例中为 localhost）没有将 .woff 注册为应用程序/八位字节流的 mime 类型的问题。注册后，我不再遇到 404 not found 错误。

# joomla - 除了已经安装的扩展之外，我应该在 joomla 2.5 中安装哪些组件、模块和插件。

> ID：12917203
> 
> 赞同：-1
> 
> 时间：2012-10-16T14:38:06.657
> 
> 标签：joomla, joomla1.5, joomla2.5

我已经开始在 joomla 上工作，我想知道在使用 Joomla 平台时应该安装哪些扩展，除了包中默认安装的扩展。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T15:01:00.923

如果我正确理解您的问题，您根本不需要安装任何东西即可开始在 joomla 中工作。你可以开始写博客或组件开发或任何你应该做的任务。

这实际上取决于您网站的目的。如果您查看此***[链接](http://www.joomlaport.com/joomla-extension-reviews/10-free-joomla-extensions-i-cant-live-without.html)***，您可能会发现一些重要的扩展程序可能会对您有所帮助。

# assembly - Nasm 中需要的 while 循环示例

> ID：12917206
> 
> 赞同：4
> 
> 时间：2012-10-16T14:38:11.083
> 
> 标签：assembly, nasm

有人可以解释一下如何用 NASAM 汇编语言编写 While 循环，例如涉及哪些寄存器需要哪些 mov 操作以及如何保持计数器，我正在尝试掌握汇编，但一开始有点棘手。 .

多谢你们

顺便说一句：我正在尝试为我正在学习的课程学习这种语言

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-16T14:48:36.500

I guess you ask about x86 assembler? In assembler there is no while loop (maybe you can use special macros for that sometime, depends on the Assembler). You have to construct by your own. You can use assembler commands like

```
jne, jnz, je, jz, cmp, inc, dec 
```

or some more special outdated command

```
jcxz, loop 
```

for example:

```
mov ecx,255

L1:

dec ecx
jne L1
ret 
```

This example counts the value in the register ecx until 0 and then left the loop. Another example but which count above.

```
mov ecx,0

L2:

inc ecx
cmp ecx, 255
jne L2
ret 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T14:51:22.957

循环需要一个起点（为方便起见可能带有标签），中间的一些东西（循环体），以及跳回起点的指令。跳转可能是有条件的基于某些条件终止循环，或者循环体中可能有一些东西通过跳转到其他地方来显式地终止循环。对您使用的寄存器或内存位置或指令没有特别限制，但是，对于某些指令集（如 x86 和 x86-64），它们具有旨在使编写循环更容易的特定指令，并且可能具有一些硬编码依赖于某些寄存器。但是，同样，也不需要实际使用它们。

除此之外，您的问题很模糊，除了您正在为其编写的 CPU 制造商（英特尔、AMD ......）的程序员参考手册之外，没有什么要补充的了强烈推荐参考，通常免费下载。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-09-08T11:33:46.420

许多宏汇编器确实支持 WHILE 宏：

[http://www.oopweb.com/Assembly/Documents/ArtOfAssembly/Volume/Chapter_8/CH08-9.html#HEADING9-90](http://www.oopweb.com/Assembly/Documents/ArtOfAssembly/Volume/Chapter_8/CH08-9.html#HEADING9-90)

这是摩托罗拉在 70 年代编写的一些 6809 代码：

```
 WHILE  B,GT,(0,Y) 
    ORA  B,X 
    DECB 
  ENDWH 
```

（为了清楚起见，这里使用的唯一“实际”6809 操作码是 ORA 和 DECB。）

# java - java - 如何替换以特定字符开头和结尾的所有子字符串？

> ID：12917208
> 
> 赞同：2
> 
> 时间：2012-10-16T14:38:10.303
> 
> 标签：java, regex

我有一个字符串

> “棕狐@jumped@ 越过@fence@”

，我希望`'@'`用' `kicked`'替换两个之间的所有子字符串，即最终输出应该是：

> “棕狐一脚踹翻”

我写了以下内容，但无法弄清楚错误：

```
string.replaceAll("^@.*@$", "kicked"); 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-16T14:40:09.830

你不应该使用锚元素`^`和`$`. 它们表示整个输入的开头和结尾，而不是单词的开头和结尾。您还应该`.`用`[^@]`（意思是“除”之外的任何东西`@`）替换点，以使您的表达更有效率。

```
string.replaceAll("@[^@]*@", "kicked"); 
```

如果您想避免替换单词中的标记元素，例如，如果您想按原样保留`he@ll@o`，而不是制作它，您可以在表达式的两端`hekikkedo`放置单词边界标记：`\b`

```
string.replaceAll("\\b@[^@]*@\\b", "kicked"); 
```

# c# - 多个 IndexOf 如何比原始迭代更快？

> ID：12917214
> 
> 赞同：0
> 
> 时间：2012-10-16T14:38:28.483
> 
> 标签：c#, string, iteration, indexof

```
string s = "abcabcabcabcabc";

var foundIndexes = new List<int>(); 
```

问题来自[这里](https://stackoverflow.com/questions/12765819/more-efficient-way-to-get-all-indexes-of-a-character-in-a-string)的讨论。我只是想知道

这怎么可能：

```
for (int i = s.IndexOf('a'); i > -1; i = s.IndexOf('a', i + 1))  

      foundIndexes.Add(i); 
```

比这更好：

```
for (int i = 0; i < s.Length; i++)

      if (s[i] == 'a') foundIndexes.Add(i); 
```

**编辑：**性能增益来自哪里？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T15:09:41.313

我没有观察到 using`IndexOf`比直接循环更快。老实说，我不明白这是怎么回事，因为在这两种情况下都需要检查每个字符。我的初步结果是这样的：

```
Found by loop, 974 ms 
Found by IndexOf 1144 ms 
```

**编辑**：再运行几次后，我注意到您必须运行发布（即优化）才能看到我上面的结果。如果没有优化，for 循环确实比较慢。

基准代码：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text.RegularExpressions;
using System.Text;
using System.IO;
using System.Diagnostics;

namespace Test
{
    public class Program
    {
        public static void Main(string[] args)
        {
            const string target = "abbbdbsdbsbbdbsabdbsabaababababafhdfhffadfd";

            // Jit methods
            TimeMethod(FoundIndexesLoop, target, 1);
            TimeMethod(FoundIndexesIndexOf, target, 1);            

            Console.WriteLine("Found by loop, {0} ms", TimeMethod(FoundIndexesLoop, target, 2000000));
            Console.WriteLine("Found by IndexOf {0} ms", TimeMethod(FoundIndexesIndexOf, target, 2000000));           
        }

        private static long TimeMethod(Func<string, List<int>> method, string input, int reps)
        {
            var stopwatch = Stopwatch.StartNew();
            List<int> result = null;
            for(int i = 0; i < reps; i++)
            {
                result = method(input);
            }
            stopwatch.Stop();
            TextWriter.Null.Write(result);
            return stopwatch.ElapsedMilliseconds;
        }

        private static List<int> FoundIndexesIndexOf(string s)
        {
            List<int> indexes = new List<int>();

            for (int i = s.IndexOf('a'); i > -1; i = s.IndexOf('a', i + 1))
            {
                 // for loop end when i=-1 ('a' not found)
                indexes.Add(i);
            }

            return indexes;
        }

        private static List<int> FoundIndexesLoop(string s)
        {
            var indexes = new List<int>();
            for (int i = 0; i < s.Length; i++)
            {
                if (s[i] == 'a')
                indexes.Add(i);
            }

            return indexes;
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T16:07:22.773

`IndexOf(char value, int startIndex)`标记有以下属性：`[TargetedPatchingOptOut("Performance critical to inline across NGen image boundaries")]`。

此外，此方法的实现很可能在许多其他方面进行了优化，可能使用不安全的代码，或者使用更多“本机”技术，例如使用本机`FindNLSString`Win32 函数。

# asp.net - context.Response.Write(url) 返回内容而不是文本

> ID：12917216
> 
> 赞同：1
> 
> 时间：2012-10-16T14:38:29.620
> 
> 标签：asp.net, jquery

我有一些在 httphandler 中处理的 ajax 请求

```
jQuery.ajax({ type: "GET", url: url, dataType: "text", complete: function (resp, status) {
                if (status == "success" || status == "notmodified")
                    if (resp.responseText != "error")
                        window.location = resp.responseText;
            }
        }); 
```

有处理程序

```
 public class SocialNetworkUserLogin : IHttpHandler, IRequiresSessionState
    {
      public void ProcessRequest (HttpContext context) 
        {
            context.Response.Clear();
            context.Response.ClearHeaders();
            context.Response.ClearContent();
            context.Response.ContentType = "text/plain";
             //verified something and
           context.Session["UnregUser"] = null;
           context.Response.Write(Config.SiteDomain + "/Registration.aspx");
}
} 
```

当我检查 resp.responseText 的值时，它包含 Registration.aspx 内容而不是示例 localhost:2101/Registration.aspx 的 url 文本，请帮助理解我做错的地方

# .net - 无法确定实体是暂时的还是分离的

> ID：12917217
> 
> 赞同：4
> 
> 时间：2012-10-16T14:38:30.947
> 
> 标签：.net, nhibernate, transient

在尝试使用手动生成的 ID 持久化实体时，我在 NHibernate (v3.3) 中遇到了一个奇怪的错误：

> 无法确定具有分配标识符 {Id} 的 {Entity} 是暂时的还是分离的；查询数据库。在会话中使用显式 Save() 或 Update() 来防止这种情况。

但问题是，我*使用*的`Save`是`SaveOrUpdate`. 可能是什么问题呢？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-18T11:19:18.780

事实证明，我的问题实际上是在保存父实体时发生的，其中包含一对多关系中的子实体：

```
<class xmlns="urn:nhibernate-mapping-2.2" name="ParentTable" table="ParentTable">

    <id name="ManuallyAssignedId">
      <generator class="assigned" />
    </id>

    <!- child table also has a manually assigned id -->
    <bag cascade="all" inverse="true" name="ChildTable">
      <key>
        <column name="ParentTable_id"/>
      </key>
      <one-to-many class="ChildTable" />
    </bag>

</class> 
```

换句话说，`Save`对父实体的调用会导致`SaveOrUpdate`对子实体的调用，这是 NHibernate 所抱怨的。

当我意识到这一点时，我很快找到了这个 StackOverflow 线程：[How to save a child with assigned id in nhibernate](https://stackoverflow.com/q/1070311/1488067)，它有两个很好的建议：

1.  [创建并映射一个版本或时间戳列](https://stackoverflow.com/a/1070475/1488067)- 如果它为空，NHibernate 将知道它需要持久化实体，或者

2.  [将自定义拦截器附加到会话（或会话工厂）](https://stackoverflow.com/a/1075232/1488067)并使用自定义私有字段来跟踪实体是否需要持久化。

# c# - 如何比较两个不同的IP？

> ID：12917222
> 
> 赞同：-1
> 
> 时间：2012-10-16T14:38:48.857
> 
> 标签：c#, ip

> **可能重复：**
> [用 C# 比较两个 ip](https://stackoverflow.com/questions/2722598/compare-two-ip-with-c-sharp)

如何比较两个IP？通过比较，我的意思是判断 IP1 是否大于 IP2。那可能吗？如我所见，`IPAddress`没有该功能。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T15:42:52.420

编辑：请参阅[此处的答案](https://stackoverflow.com/questions/461742/how-to-convert-an-ipv4-address-into-a-integer-in-c)以获得更优雅的东西。不过，请注意有关字节序的警告。

~~Pranay Rana 的回答从根本上被打破：比较 '11.2.3.4' 和 '1.12.3.4' 将表明它们是相等的。他们显然不是。~~

IP 地址本质上是特定形式的 32 位整数。您可以使用此事实编写一个简单的函数，该函数接受字符串值并为您提供整数，这更容易比较：

```
static void Main(string[] args)
{
    string ip1 = "11.2.3.4";
    string ip2 = "1.12.3.4";
    uint ipInt1 = ipAddressToInt(ip1);
    uint ipInt2 = ipAddressToInt(ip2);
    Console.WriteLine(ipInt1 < ipInt2);
    Console.ReadLine();
}

private static uint ipAddressToInt(string ip)
{
    uint retVal;
    System.Net.IPAddress ipAddress = System.Net.IPAddress.Parse(ip);
    byte[] IPBytes = ipAddress.GetAddressBytes(); 

    retVal = (uint)IPBytes[3] << 24;
    retVal += (uint)IPBytes[2] << 16;
    retVal += (uint)IPBytes[1] << 8;
    retVal += (uint)IPBytes[0]; 
    return retVal;
} 
```

~~请注意 ipAddressToInt 函数中的[System.Net.IPAddress.Parse](http://msdn.microsoft.com/en-us/library/system.net.ipaddress.parse.aspx)。这会在使用输入字符串之前对其进行验证。~~

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-10-16T14:41:25.097

**编辑**（这可能适用于注释中指定的所有条件）

```
string ip1= "1.2.3.4";
string ip2 ="5.6.7.8";

string[] ip1S = ip1.Split(new char[] {'.'});
string[] ip2S = ip2.Split(new char[] {'.'});

for(int i=0;i<4;i++)
{
  if(Convert.ToInt32(ip1S[i]) > Convert.ToInt32(ip2S[i]))
  {
    Console.WriteLine("ip1 is higher");
    break;
  }
  else if(Convert.ToInt32(ip2S[i]) > Convert.ToInt32(ip1S[i])) 
   {
    Console.WriteLine("ip2 is higher");
    break;
  }  
} 
```

* * *

老的

你可以像这样做字符串comapre

```
string ip1= "1.2.3.4";
string ip2 ="5.6.7.8";

string ip1R = ip1.Replace(".","");
string ip2R = ip2.Replace(".","");

Console.WriteLine(String.Compare(ip1R ,ip2R )); 
```

输出

```
A negative integer    str1 is less than str2.
0                     str1 equals str2.
A positive integer    This instance is greater than value.
-or-
1 
```

有关 MSDN 上的更多更改字符串比较：http: [//msdn.microsoft.com/en-us/library/fbh501kz (v=vs.80).aspx](http://msdn.microsoft.com/en-us/library/fbh501kz(v=vs.80).aspx)

# c# - 使用“CameraCaptureDialog”捕获并保存多张图像

> ID：12917224
> 
> 赞同：0
> 
> 时间：2012-10-16T14:38:54.967
> 
> 标签：c#, windows-mobile, windows-mobile-5.0, compact-framework2.0

我有一个定义用户控件 MPhotoControl 的 Windows Mobile（紧凑框架 2）应用程序。MPhotoControl 显示默认图像，当用户单击此图像时，将`CameraCaptureDialog`打开一个以允许捕获照片。捕获后，照片将显示在用户控件中。这适用于捕获单张照片然后返回应用程序。

问题是，当特定表单上有很多这些控件时，用户界面会变得非常不友好，因为用户必须显示相机对话框、拍照、保存和关闭表单上每个照片控件的对话框。用户所要求的是一种打开机制，`CameraCaptureDialog`在对话框关闭的情况下拍摄多张照片，直到所有照片控件都有图像。

我正在尝试实现这一点，但我没有看到一种方法来`CameraCaptureDialog`一次捕获和保存多张照片。据我所知这是不可能的，因为当我的 HTC Touch Diamond 上显示对话框时，我只有“接受照片”（箭头图标）、“再次拍摄”（相机图标）或“取消并关闭对话框”（垃圾箱图标）。当我单击箭头接受它时，它总是关闭对话框。

那么有没有人知道使用 一次捕获和保存多个图像的方法`CameraCaptureDialog`？

然后我想尝试打开`CameraCaptureDialog`多次作为解决方法。因此，一旦保存了第一张图像，对话框就会立即再次打开以捕获第二张图像。这是我的代码，显示了我尝试解决方法：

```
public partial class MPhotoControl : UserControl
{
    public static IEnumerable<MPhotoControl> PhotoControls;

    ...

    private void CaptureMultiplePhotos()
    {
        foreach (MPhotoControl photo in PhotoControls)
        {               
            using (CameraCaptureDialog cameraDialog = new CameraCaptureDialog())
            {
                if (cameraDialog.ShowDialog() != DialogResult.OK)
                {
                    break;
                }
                photo.CapturePhoto(cameraDialog.FileName);
            }
        }
    }
} 
```

这样做的问题是`CameraCaptureDialog`仍然只打开一次，随后对该`ShowDialog`方法的调用只是返回`DialogResult.Cancel`。那么，有谁知道为什么这种解决方法不起作用，以及是否可以在保存先前捕获的图像后立即重新打开对话框？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T12:26:07.017

请看这里：[http ://www.hjgode.de/wp/2012/10/17/windows-mobile-cameracapturedialog-alternative/](http://www.hjgode.de/wp/2012/10/17/windows-mobile-cameracapturedialog-alternative/)

我无法在此处附加任何代码或二进制文件，因此我写了一篇新的博客文章。

该代码启动相机应用程序，等待其关闭并向您显示新照片列表。

代码还不完美，只是一个起点。

# ruby-on-rails - 如何编写 Capybara 断言来检查按钮的存在及其启用或禁用状态？

> ID：12917227
> 
> 赞同：43
> 
> 时间：2012-10-16T14:38:59.100
> 
> 标签：ruby-on-rails, capybara

我有一个应用程序可以启用/禁用按钮以响应 UI 中发生的事情。

我可以很容易地使用 capybara 来检测按钮是否存在

```
should have_button 'save' 
```

但我不知道如何验证保存按钮的状态。那是：

*如何编写 Capybara 断言来检查按钮的存在**及其**启用或禁用状态？*

我已经对禁用按钮进行了检查；对于启用，我想我可以验证是否有匹配的按钮并且没有匹配的禁用按钮。但是，至少可以说，这很笨拙。

这似乎是一个基本的 UI 检查，我确信我错过了一些东西，但我似乎无法弄清楚是什么。

* * *

根据gregates的回答跟进：

正如我在评论中提到的，Capybara 的行为取决于底层驱动程序。我们正在使用 webkit，它返回“true”/“false”字符串结果。显然，其他驱动程序返回真/假。Capybara 的人们意识到了这个问题（github.com/jnicklas/capybara/issues/705），但他们觉得（可能是正确的）这不是他们真正需要解决的问题。

我最终创建了一个自定义匹配器，而不是让我的测试依赖于我正在使用的驱动程序：

```
RSpec::Matchers.define :be_enabled do
  match do |actual|
    driver_result = actual[:disabled]
    # nil, false, or "false" will all satisfy this matcher
    (driver_result.nil? || driver_result == false || driver_result == "false").should be_true
  end
end

RSpec::Matchers.define :be_disabled do
  match do |actual|
    driver_result = actual[:disabled]
    (driver_result == "disabled" || driver_result == true || driver_result == "true").should be_true
  end
end 
```

然后你可以输入：

```
user_license_area.find_button('Save').should be_disabled 
```

* * *

## 回答 #1

> 赞同：78
> 
> 时间：2014-07-07T16:12:04.723

Capybara 对禁用元素的处理似乎已经改变，所以我想我会给出更新。

要测试页面是否有按钮并启用，请使用：

```
expect(page).to have_button('Save') 
```

要测试页面是否有按钮并被禁用，请使用：

```
expect(page).to have_button('Save', disabled: true) 
```

此格式适用于`has_field?`,`find_field`等。

[您可以在http://www.elabs.se/tag/capybara](http://www.elabs.se/tag/capybara)阅读有关此更新的更多信息

**更新**

旧链接已损坏。[这是讨论该功能的 GitHub 问题，](https://github.com/jnicklas/capybara/issues/982)这[是该方法的不幸文档](http://www.rubydoc.info/github/jnicklas/capybara/Capybara/RSpecMatchers#have_button-instance_method)。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-10-16T14:48:18.603

```
find_button('save')[:disabled].should eq "disabled" 
```

Note that one line will effectively test for both existence and disabled state.

Edit: for enabled, try

```
find_button('save')[:disabled].should_not be 
```

(Either of these tests may need to be tweaked depending on precisely how you disable/enable the button.)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2016-09-01T10:27:22.430

有 be_disabled 检查

```
it "allows finding elements and checking if they are disabled" do
  expect(string.find('//form/input[@name="bleh"]')).to be_disabled
  expect(string.find('//form/input[@name="meh"]')).not_to be_disabled
end 
```

[https://github.com/jnicklas/capybara/blob/2a51b817b355f6c1a5e95a471a87f1a492562e55/spec/basic_node_spec.rb#L108](https://github.com/jnicklas/capybara/blob/2a51b817b355f6c1a5e95a471a87f1a492562e55/spec/basic_node_spec.rb#L108)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-12-23T13:55:41.953

有很多方法可以做到这一点。我认为最好的方法是只使用 css 选择器

```
expect(page).to have_css("#save:enabled") 
```

此示例假定您已将 css id 设置为保存。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2021-07-02T08:52:04.237

用最小的：

```
assert find('input[name=username]').disabled? 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-10-03T19:44:27.020

从用户在 UI 中的操作（选择文档类型）触发按钮变为启用的类似情况......

使用控件上的 id，找到按钮（无论状态如何）并断言“禁用”状态变得非常干净。

```
 @javascript
  Scenario: Package generation not allowed unless a document type is selected
    Given I view the "Liberty and 4th Building Renovation" project
    When I view the Package Creator
    Then both document package generation buttons should be disabled

  @javascript
  Scenario: Package generation allowed when documents types are selected
    Given I view the "Liberty and 4th Building Renovation" project
    When I view the Package Creator
    And I select any document type
    Then both document package generation buttons should be enabled 
```

以及 Capybara 支持的黄瓜功能步骤：

```
Then(/^both document package generation buttons should be disabled$/) do
  expect(find_by_id('generate_pdf')).to be_disabled
  expect(find_by_id('generate_zip')).to be_disabled
end

Then(/^both document package generation buttons should be enabled/) do
  expect(find_by_id('generate_pdf')).not_to be_disabled
  expect(find_by_id('generate_zip')).not_to be_disabled
end 
```

# php - PHP DateTime - 受到 cookie 的错误影响？

> ID：12917238
> 
> 赞同：0
> 
> 时间：2012-10-16T14:39:32.543
> 
> 标签：php, datetime, cookies

我已经为 PHP 的 DateTime 编写了一个扩展。在我的一个网站上，我注意到日期的行为确实很奇怪。我一时兴起删除了该网站的 cookie，日期开始正常运行。

现在我的 cookie 不见了，我不知道如何重现这个问题。我担心给出一个具体的例子，因为我没有一个实际的例子，我不想创建一个红鲱鱼。我注意到它在我的日历应用程序中，我在 URL 中传递 20121116 指定 2012 年 11 月（'Ymd' 格式字符串），它被解释为一个遥远的未来日期，比如 2098 年。我不记得了如果它正确解释了月份部分。

是否存在已知问题/解决方法？我有客户报告了这个问题，我建议他们删除他们的 cookie，但我想在他们不需要做任何事情的情况下解决这个问题。我还没有遇到技术熟练的客户可以向我发送他们的 cookie 值。

*   我正在使用 PHP 版本 5.3.14
*   在我的 .htaccess 文件中，我像这样设置时区：`php_value date.timezone America/New_York`

* * *

**更新**

我的站点托管在 Rackspace 云站点上。我目前的工作理论是负载平衡服务器之一的日期设置不正确。“X-Mapping-[random string]” cookie 将浏览器与具有错误日期设置（区域设置？）的负载平衡服务器联系起来，因此清除 cookie 有可能获得不同的服务器。

* * *

**解决方案**

问题是负载平衡服务器的设置不正确。Rackspace 纠正了它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T14:59:53.323

DateTime在**任何情况下都****不受**Cookie 的影响（这会打开许多​​安全漏洞）。 也许您有一个自定义函数来分析一些 cookie 值并相应地设置当前时区。

# java - 从 java 项目运行 CRF++ 时出错

> ID：12917239
> 
> 赞同：0
> 
> 时间：2012-10-16T14:39:33.033
> 
> 标签：java, nlp

我想从 java 程序中调用 CRF++ 工具包。我输入以下内容：

```
Process process = runtime.exec("/home/toshiba/Bureau/CRF++-0.54/.libs/lt-crf_learn  /home/toshiba/Bureau/CRF++-0.54/example/atb/template /home/toshiba/Bureau/CRF++-0.54/example/atb/tr_java.data");
process.waitFor(); 
```

但是，我有以下错误：

```
CRF++: Yet Another CRF Tool Kit
Copyright (C) 2005-2009 Taku Kudo, All rights reserved.

Usage: /home/toshiba/Bureau/CRF++-0.54/.libs/lt-crf_learn [options] files
-f, --freq=INT              use features that occuer no less than INT(default 1)
-m, --maxiter=INT           set INT for max iterations in LBFGS routine(default 10k)
-c, --cost=FLOAT            set FLOAT for cost parameter(default 1.0)
-e, --eta=FLOAT             set FLOAT for termination criterion(default 0.0001)
-C, --convert               convert text model to binary model
-t, --textmodel             build also text model file for debugging
-a, --algorithm=(CRF|MIRA)  select training algorithm
-p, --thread=INT            number of threads(default 1)
-H, --shrinking-size=INT    set INT for number of iterations variable needs to  be     optimal before considered for shrinking. (default 20)
-v, --version               show the version and exit
-h, --help                  show this help and exit 
```

我想知道是否有人可以帮助我？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T15:20:54.283

我认为这不是 CRF++ 中的错误，因为您可以从命令行运行它。所以实际的问题是如何在使用 Runtime.exec() 启动进程时正确传递参数。我建议尝试以下方法：

```
String[] cmd = {"/home/toshiba/Bureau/CRF++-0.54/.libs/lt-crf_learn",
    "/home/toshiba/Bureau/CRF++-0.54/example/atb/template",
    "/home/toshiba/Bureau/CRF++-0.54/example/atb/tr_java.data"};
Process p = Runtime.getRuntime().exec(cmd); 
```

这可能会有所帮助，因为 Runtime.exec() 有时会以一种相当奇怪的方式将命令行拆分为参数。

这里提到了另一个潜在的问题：[Java Runtime.exec()](https://stackoverflow.com/questions/8595748/java-runtime-exec)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T17:57:09.810

有一个简单的解决方案。只需将您的命令写入一个临时文件并将该文件执行为`Runtime.getRuntime.exec("sh <temp-filename>")`. 稍后您可以删除此文件。如果此解决方案适合您，我将解释这背后的原因。

# c# - C# 获取 AJAX 调用

> ID：12917240
> 
> 赞同：0
> 
> 时间：2012-10-16T14:39:34.140
> 
> 标签：c#, javascript, ajax

我想每隔几秒钟向 C# 服务器发送一个 JavaScript AJAX 调用，我已经准备好所有客户端，我将如何在服务器端读取它并发送回复？我知道 AJAX 代表异步 JavaScript 和 XML，所以我可能根本没有办法搜索 google，但什么也没找到。

此外，您可以在每个 ajax 调用之间传递的消息的最大大小是多少？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T14:52:51.533

从 c# 获取输入的一种简单方法是创建一个空的 aspx 页面。在页面加载中检查任何参数，然后使用返回数据。

```
Response.Write("Data To Return");
Response.End(); 
```

我已使用此方法为 ajax 驱动的网格返回分页。

使用 Ajax 的页面：MyPage.aspx

我调用 MyPage_JSON.aspx 通过使用查询字符串变量将参数传递给页面来检索数据。MyPage_JSON.aspx?start=1&increment=20

如您所料，MyPage_JSON.aspx 返回 JSON，然后由 MyPage.aspx 中的 javascript 解析并显示给用户。

真的没有最大值，只受应用程序（客户端浏览器）的性能限制。如果您尝试返回太多数据，您的通话可能会挂起。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T15:10:49.817

您可以使用 TCPListener 类在 C# 中创建自己的网络服务器。有了它，您可以获得发送到控制台应用程序的所有数据（包括标头数据）并对其进行响应。

以下网站提供了完整示例的更多信息：

[使用 C# 创建自己的 Web 服务器](http://www.codeproject.com/Articles/1505/Create-your-own-Web-Server-using-C)

# javascript - li.selected 菜单有问题

> ID：12917242
> 
> 赞同：1
> 
> 时间：2012-10-16T14:39:36.250
> 
> 标签：javascript, jquery, html, css

我正在尝试`.selected`使用 jquery 向我的导航菜单添加一个状态。我可以看到它正在努力工作，但说到底，风格并没有“停留”。点击后它应该是白色的。

**HTML**：

```
<ul id="coolMenu">

  <li class="end"><a href="index.html"></a></li>
  <li class="mid"><a href="products.html">products</a>
    <ul class="mama">
        <li class="uno"><a href="http://www.preworkoutforwomen.com"
   onclick="_gaq.push(['_link', 'http://www.preworkoutforwomen.com']); return false;">Athena PreWorkout</a></li>
    </ul>
    </li>

  <li class="midx"><a href="unico_fitness_blog.html">u.blog</a> </li>
  <li class="midx"><a href="unico_athletes.html">athletes</a></li>
    <li class="midx"><a href="aboutus.html">about us</a></li>
  <li class="midx"><a href="contact.html">contact</a>  </li>
  <li class="shop"><a href="http://mgfyb.pkhqw.servertrust.com/">shop</a>  </li>
</ul> 
```

**CSS**：

```
#coolMenu {
    list-style: none; 
    float:left; 
    padding-left:7.5px; 
    padding-right:0px; 
    position:relative;
}

#coolMenu ul  {
    -webkit-box-shadow: 0px 3px 3px 0px #4a4a4a;
    border-bottom-left-radius:5px;
    -moz-border-bottom-left-radius:5px;
    -moz-box-shadow: 0px 3px 3px 0px #4a4a4a;
    box-shadow: 0px 3px 3px 0px #4a4a4a; 
}

#coolMenu .selected {
    background-position:bottom !important; 
    color:black !important;
}

#coolMenu li {   
    width:145px;
    height:48px;
    display:inline-block;
    float:left;
    background-image:url(../images/misc/images/retina-sprite_03.png);
   -webkit-background-size: 750px 150px;
   -o-background-size: 750px 150px;
   -moz-background-size: 750px 150px;
   background-size: 750px 150px;
    background-position: -301px -1px;
   -webkit-transition: all 200ms ease-in-out;
    -moz-transition: all 200ms ease-in-out;
    -o-transition: all 200ms ease-in-out;
    transition: all 200ms ease-in-out;
}

#coolMenu > li.end {
    border-bottom-left-radius:7px;
    -moz-border-bottom-left-radius:7px;
    border-top-left-radius:7px;
    -moz-border-top-left-radius:7px;
    background-position: -601px -1px;       
    text-align:center;
}

#coolMenu > li.shop {
    text-align:center;
    border-left-style:ridge;
    border-left-color:#333;
    border-left-width:thin;
    border-bottom-right-radius:7px;
    -moz-border-bottom-right-radius:7px;
    border-top-right-radius:7px;
    -moz-border-top-right-radius:7px;
}

#coolMenu > li.mid {
    text-align:center;
    border-left-style:ridge;
    border-left-color:#333;
    border-left-width:thin;
}

#coolMenu > li.midx {
    text-align:center;
    border-left-style:ridge;
    border-left-color:#333;
    border-left-width:thin;
}

#coolMenu li a {
    display: block;
    height: 2.4em;
    line-height: 2.1em;
    padding: 0px;
    text-decoration: none;
}

#coolMenu uno,dos,tres a {
    display: block;
    height: .5em;
    line-height: 1em;
    padding: 0px;
    text-decoration: none;
}

#coolMenu ul {
    position: absolute;
    display: none;
    z-index: 999;
    padding: 0px;
}

#coolMenu ul li {
}

#coolMenu ul li a { 
}

#coolMenu li:hover ul.noJS {
    display: block; 
} 
```

**Javascript**：

```
$(document).ready(function(){
        $("#coolMenu li").click(function() {
        //  First remove class "active" from currently active tab
        $("#coolMenu li").removeClass('selected, end, mid, midx, shop'); 

        //  Now add class "active" to the selected/clicked tab
        $(this).addClass("selected");

       });
          }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T14:47:01.823

When you click on links page is refreshed. Change them from :

```
<li class="end"><a href="index.html"></a></li> 
```

to

```
<li class="end"><a href="index.html" onclick="return false"></a></li> 
```

If you want to test without refresh page.

EDIT : you can also changeyour javascript file to :

```
$(document).ready(function(){
        $("#coolMenu li").click(function() {
             //  First remove class "active" from currently active tab
             $("#coolMenu li").removeClass('selected, end, mid, midx, shop'); 

             //  Now add class "active" to the selected/clicked tab
             $(this).addClass("selected");

             //CHANGED
             return false ;   
       });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T14:47:33.063

It is because after click event the clicked page opens and reloads entire page. it is completely another page after the click.

I am not sure what you actually try to do but if your pages are html, you should set the `selected` class in html file

for product.html

```
 <li class="selected"><a href="products.html">products</a> 
```

if you are load the content by JS such as displaying another div or load by AJAX. You should use `event.preventDefault();` after the addClass function.

EDIT: If you want to select class after load try something like this :

```
$(document).ready(function(){
    $("#coolMenu li a").each(function () {
           if (location.href.indexOf(this.href) > -1)
           {
                $(this).parent().attr("class", "selected");
                return false;
           }
     });
}); 
```

Hope it works I couldn t test it.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-16T15:01:38.013

这不是对您的问题的回答，因为我很确定其他评论者已经涵盖了这一点。我只想说，我整理了你的 CSS 代码，因为它有点乱。此外，您应该始终将未加前缀的 CSS3 属性放在带前缀的 CSS3 属性下（即`border-radius: 5px;`应该放在 下`-webkit-border-radius: 5px;`），这样当浏览器供应商放弃带前缀的版本时（大多数现代浏览器不再使用前缀来处理很多 CSS3 内容，`border-radius`包括在内。不过，您仍然应该为旧版本的浏览器添加前缀版本。），无前缀版本将覆盖过时的前缀版本。

其次，您似乎并没有大量使用速记 CSS，这可以大大提高 CSS 的效率。例如，`background: /* code */`可以涵盖`background-image`、`background-position`、`background-size`等`background-color`。阅读[此](http://reference.sitepoint.com/css/shorthandproperties)内容以获取有关速记 CSS 的更多信息。

# c# - NHibernate 加入 + 合并

> ID：12917245
> 
> 赞同：1
> 
> 时间：2012-10-16T14:39:45.247
> 
> 标签：c#, nhibernate, fluent-nhibernate, fluent-nhibernate-mapping

这是实际模式的简化示例，请多多包涵。我有一个`foo`带有一个`id`和一个`value`列的表。还有一个`bar`带有 FK 的`foo`表，该表有一个`extended_value`列。我想让 Foo 的类映射左加入 Bar 并尝试使用它的`extended_value`列（如果存在），否则回退到 Foo 的`value`.

这是我需要的SQL等价物：

```
select coalesce(b.extended_value, f.value) as value
  from foo f
  left join bar b on (b.id = f.id) 
```

我在 NHibernate 之上使用 Fluent。这是我一直在尝试使用的：

```
Join("bar", m =>
{
    m.Optional();
    m.KeyColumn("id");
    m.Map(foo => foo.Value).Formula("COALESCE(extended_value, value)");
}); 
```

但这失败了，因为生成的 SQL 期望两者都`extended_value`在`value`同一张表上。

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-16T18:50:58.483

我的建议是**不要**在映射中这样做。

映射`foo.value`和`bar.extended_value`独立，然后`coalesce`在您的查询中使用和/或创建使用`??`运算符的未映射属性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T08:52:17.790

我会使用 Diego Mijelshon 的建议，但以下也应该有效

```
// FooMap
Map(foo => foo.Value).Formula("COALESCE((select b.extended_value from bar b WHERE b.id = id), value)"); 
```

# c++ - Windows Media Foundation 录制音频

> ID：12917256
> 
> 赞同：6
> 
> 时间：2012-10-16T14:40:19.277
> 
> 标签：c++, winapi, mfc, ms-media-foundation

我正在使用 Windows Media Foundation api 来枚举我的麦克风和可用的摄像头，它们都可以工作。

这是我的枚举代码：

```
class deviceInput {
public:
    deviceInput( REFGUID source );
    ~deviceInput();

    int listDevices(bool refresh = false);
    IMFActivate *getDevice(unsigned int deviceId);
    const WCHAR *getDeviceName(unsigned int deviceId);

private:
    void Clear();
    HRESULT EnumerateDevices();

    UINT32      m_count;
    IMFActivate **m_devices;
    REFGUID     m_source;
};

deviceInput::deviceInput( REFGUID source )
    : m_devices( NULL )
    , m_count( 0 )
    , m_source( source )
{   }

deviceInput::~deviceInput()
{
    Clear();
}

int deviceInput::listDevices(bool refresh)
{
    if ( refresh || !m_devices ) {
        if ( FAILED(this->EnumerateDevices()) ) return -1;
    }
    return m_count;
}

IMFActivate *deviceInput::getDevice(unsigned int deviceId)
{
    if ( deviceId >= m_count ) return NULL;

    IMFActivate *device = m_devices[deviceId];
    device->AddRef();

    return device;
}

const WCHAR *deviceInput::getDeviceName(unsigned int deviceId)
{
    if ( deviceId >= m_count ) return NULL;

    HRESULT hr = S_OK;
    WCHAR *devName = NULL;
    UINT32 length;

    hr = m_devices[deviceId]->GetAllocatedString( MF_DEVSOURCE_ATTRIBUTE_FRIENDLY_NAME, &devName, &length );
    if ( FAILED(hr) ) return NULL;

    return devName;
}

void deviceInput::Clear()
{
    if ( m_devices ) {
        for (UINT32 i = 0; i < m_count; i++) SafeRelease( &m_devices[i] );
        CoTaskMemFree( m_devices );
    }
    m_devices = NULL;
    m_count = 0;
}

HRESULT deviceInput::EnumerateDevices()
{
    HRESULT hr = S_OK;
    IMFAttributes *pAttributes = NULL;

    Clear();

    hr = MFCreateAttributes(&pAttributes, 1);
    if ( SUCCEEDED(hr) ) hr = pAttributes->SetGUID( MF_DEVSOURCE_ATTRIBUTE_SOURCE_TYPE, m_source );
    if ( SUCCEEDED(hr) ) hr = MFEnumDeviceSources( pAttributes, &m_devices, &m_count );

    SafeRelease( &pAttributes );

    return hr;
} 
```

要获取音频或摄像头捕获设备，我可以指定`MF_DEVSOURCE_ATTRIBUTE_SOURCE_TYPE_AUDCAP_GUID`or`MF_DEVSOURCE_ATTRIBUTE_SOURCE_TYPE_VIDCAP_GUID`和，这没有问题，我可以获取设备的名称以及 IMFActivate。我有将网络摄像头录制到输出视频文件的代码，但是，我很难弄清楚如何将音频录制到文件中。我的印象是我需要使用 IMFSinkWriter，但我找不到任何使用音频捕获 IMFActivate 和 IMFSinkWriter 的示例。

我不是一个 Windows api 程序员，所以我确信有一个相当直截了当的答案，但 COM 的东西只是有点过头了。至于音频格式，我真的不在乎，只要它进入一个文件 - 可以是 wav、wma 或其他。即使我正在录制视频，我也需要将视频和音频文件分开，所以我无法弄清楚如何将音频添加到我的视频编码中。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2014-04-02T18:22:14.703

对于迟到的回复，我深表歉意，我希望您仍然可以发现这很有价值。我最近完成了一个与您类似的项目（将网络摄像头视频与选定的麦克风一起录制到带有音频的单个视频文件中）。关键是创建一个聚合媒体源。

```
// http://msdn.microsoft.com/en-us/library/windows/desktop/dd388085(v=vs.85).aspx
HRESULT CreateAggregateMediaSource(IMFMediaSource *videoSource,
                                   IMFMediaSource *audioSource,
                                   IMFMediaSource **aggregateSource)
{
    *aggregateSource = nullptr;
    IMFCollection *pCollection = nullptr;

    HRESULT hr = ::MFCreateCollection(&pCollection);

    if (S_OK == hr)
        hr = pCollection->AddElement(videoSource);

    if (S_OK == hr)
        hr = pCollection->AddElement(audioSource);

    if (S_OK == hr)
        hr = ::MFCreateAggregateSource(pCollection, aggregateSource);

    SafeRelease(&pCollection);
    return hr;
} 
```

配置接收器编写器时，您将添加 2 个流（一个用于音频，一个用于视频）。当然，您还将为输入流类型正确配置编写器。

```
HRESULT        hr                  = S_OK;
IMFMediaType  *videoInputType      = nullptr;
IMFMediaType  *videoOutputType     = nullptr;
DWORD          videoOutStreamIndex = 0u;
DWORD          audioOutStreamIndex = 0u;
IMFSinkWriter *writer              = nullptr;

// [other create and configure writer]

if (S_OK == hr))
    hr = writer->AddStream(videoOutputType, &videoOutStreamIndex);    

// [more configuration code]

if (S_OK == hr)
    hr = writer->AddStream(audioOutputType, &audioOutStreamIndex); 
```

然后在阅读示例时，您需要密切注意阅读器的流索引，并将它们适当地发送给编写器。您还需要密切注意编解码器期望的格式。例如，IEEE float vs PCM 等。祝你好运，我希望还为时不晚。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T14:58:59.893

您是否很难在将 DirectShow 音频[设备录制到文件](https://stackoverflow.com/questions/12865632/record-directshow-audio-device-to-file)中管理 DirectShow 音频捕获？

使用 Media Foundation 进行捕获几乎没有任何简单。更不用说一般来说 DirectShow 上有更多的资源......

MSDN 为您提供了一个将音频捕获到文件中的[WavSink 示例](http://msdn.microsoft.com/en-us/library/windows/desktop/bb970469%28v=vs.85%29.aspx)：

> 演示如何在 Microsoft Media Foundation 中实现自定义媒体接收器。该示例实现了将未压缩的 PCM 音频写入 .wav 文件的存档接收器。

我不确定他们为什么决定不将其作为标准组件。Media Foundation 在很多方面不如 DirectShow，他们至少可以把这个小东西当成优势。无论如何，你有样本，它看起来是一个好的开始。

# search - 使用 SOLR 改进搜索中的提前输入建议

> ID：12917258
> 
> 赞同：4
> 
> 时间：2012-10-16T14:40:24.920
> 
> 标签：search, solr, lucene, search-engine

有哪些可能的方法可以改进出现在自由格式搜索中的预先输入（自动完成）建议？

据我了解，为关键字出现的所有建议都存储在 SOLR 表中。

您如何确保它涵盖所有行业特定的相关提前输入建议？

您能否自动包含当前未提供搜索结果的最新用户生成查询以引导相关查询？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-22T13:35:36.703

在预处理中，输入搜索引擎的文档需要用任何合理的内容进行丰富，并为找到它们提供帮助。例如，包含字符串的文档`paris`可能会通过`french capital`, `capital of france`, `ile-de-france`, ... 来丰富，您将需要一个字典来执行此操作。您可以从 dbpedia.org 或（仅限英语）WordNet 获取数据。为了不过度概括，您需要在第一步中实现一些消歧（意思是发现），因为`paris`- 例如 - 可以根据上下文使用`alexandros`, `alaksandu of wilusa`,进行同样的扩展。`king of troy`

# svn - svn subversion 提交失败 无法删除 repoPath/db/transactions/nnn.n.txn/transactions

> ID：12917259
> 
> 赞同：2
> 
> 时间：2012-10-16T14:40:25.670
> 
> 标签：svn, commit, fsfs

当我尝试提交到存储库时，我收到一个奇怪的错误 Can't remove 'repoPath/db/transactions/96479-3.txn/transactions'。文件的添加和更新确实会发生提交，但客户端不会更新以知道提交成功。客户端上的进一步更新会导致其自己的文件发生冲突。

在 linux 上运行的版本 1.4.2 (r22196)。使用 apache 前端 v 2.2.3

存储库实际上是我们生产系统中所有文件的副本。使用 rcp -rp sourceHost:/path ./localRepoOnQaBox 复制文件

复制后，我在 repo 路径上使用了 chown -R svn:svn

```
fs_type is fsfs 
```

知道为什么会出现这种行为吗？

我应该补充一点，这个设置在我们的生产环境中工作，但是在将 repo 复制到我们的测试环境之后，错误就会出现。Prod 是硬硬件，QA 是 vm。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T15:05:33.843

因此，您进行了提交，并且该提交有效。但是，您收到该错误消息并且工作目录处于混乱状态？

提交后挂钩有可能失败。由于提交已经发生，因此更新了存储库。但是，由于提交的后处理从未完成，因此您的工作目录不会更新。

我怀疑有人在提交时将更改复制到服务器，并且他们将其作为提交后操作进行。这指出了为什么您不想为此特定目的使用提交后挂钩，但这是另一个咆哮。

看看是否有一个提交后的钩子失败了。我敢打赌，一旦您停用挂钩，一切都会正常工作。将 post-commit 钩子替换为每分钟运行的 crontab 或使用[Jenkins](http://jenkins-ci.org)之类的东西来完成所有提交后钩子的需求。

# sql-server-2008-r2 - SSRS 中的可选多值参数

> ID：12917261
> 
> 赞同：12
> 
> 时间：2012-10-16T14:40:27.157
> 
> 标签：sql-server-2008-r2, ssrs-2008, reporting-services

我的报告中有 3 个多值参数。其中 2 个是可选的。有什么方法可以在不从 2 个可选参数中选择任何参数的情况下获得报告中的结果。

我的存储过程将多值参数检查为 (States IN (SELECT * FROM Split(@State,',')))

我已经使用 WHERE CustomerId = @CustId OR @CustId IS NULL 为单值参数完成了此操作。

**解决方法：** 我选择了“允许空值”，它抛出此错误“多值参数不能包含空值”

谁能指出我正确的方向？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-17T10:11:48.317

看看这篇关于[传递多值参数](https://web.archive.org/web/20130216232055/http://www.bi-rootdata.com/2012/09/efficient-way-of-using-all-as-parameter.html)的文章。

基本上，上面的链接包含一种解决方法，可以满足您对可选多值参数的要求。实现这一点的步骤如下：

1.  在参数的数据集查询中将“ALL”替换为“”（空白）。
2.  将 -1 指定为多值参数的默认参数值。

# jquery - 无法从 jquery 中获取正确的选择值并将其传递给日期选择器

> ID：12917262
> 
> 赞同：0
> 
> 时间：2012-10-16T14:40:26.427
> 
> 标签：jquery, jquery-ui, datepicker

我正在尝试使用 jquery 获取选择值，但是在调试时。它只显示第一个值 == 1。

知道为什么吗？这是我的代码。

```
var clinic = $("#AppointmentClinicId").val();

 $("#datepicker").datepicker({
    dateFormat: "yy-mm-dd",
    minDate: 0,
    numberOfMonths: 3,
    showButtonPanel: true,
    beforeShowDay: function(date) {
        var day = date.getDay();

        console.log("clinic:" + clinic);

        if (clinic == 1) {
            return [day == 1, ""];
        }

        if (clinic == 2) {
            return [day == 2, ""];
        }

        if (clinic == 3) {
            return [day == 3, ""];
        }

        if (clinic == 4) {
            return [day == 4, ""];
        }

        if (clinic == 5) {
            return [day == 5, ""];
        }

        if (clinic == 6) {
            return [day == 6, ""];
        }

    }
 }).val() 
```

基本上，我只想根据诊所返回特定的开放日。问题是，我无法从#AppointmentClinicId 获取当前值。

帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T14:43:21.493

您没有阅读 AppointmentClinicId 的最新值。你应该每次都从 dom 中读取。`clinic = $("#AppointmentClinicId").val();`向内移动线`beforeShowDay`

```
....

beforeShowDay: function(date) {
        var day = date.getDay(),
         clinic = $("#AppointmentClinicId").val();
... 
```

# icloud - 如何从 Apple ID 获取 iCloud 电子邮件地址？

> ID：12917264
> 
> 赞同：2
> 
> 时间：2012-10-16T14:40:27.103
> 
> 标签：icloud

如果用户提供了 Apple ID 和密码，我如何检测用户的 icloud 电子邮件地址？

马诺伊

# html - 无法解释的额外空间，可能是在表中的表周围填充

> ID：12917267
> 
> 赞同：7
> 
> 时间：2012-10-16T14:40:33.037
> 
> 标签：html, html-table, padding, spacing

这是我正在为布局进行的实验。我在定位 div 来实现这个效果时遇到了很多问题，所以我转向了旧的备用表级联。我的问题是，最后一个上框在所有 3 个浏览器中都有额外的填充，无论我尝试什么，我似乎都无法将 CSS 或 HTML 去掉。红色框应与您看到的围绕它们的绿色位齐平，并且红色框之间的蓝色行右侧不应有 1px 可见的绿线。任何见解将不胜感激。

```
<!doctype html>
<html>
<head>
<style>
 table { border-collapse: collapse; border-spacing: 0; padding: 0; margin: 0;}

td table { border-collapse: collapse; border-spacing: 0; padding: 0; margin: 0;}

img { display: block; }
</style>
</head>
<body style="background-color: black;">
<table style="background-color: white; height: 525px; width: 3200; padding-top: 25px;  padding-bottom: 25px;">
<tr>
 <td colspan="1" style="width: 350px;">
   <table class="container" style="height: 475px; width: 350px; margin-left: 25px; margin-right: 25px;">
    <tr>
  <td style="background-color: green; height: 225px; width: 350px;" colspan="3">

  </td>
</tr>
<tr>
  <td style="background-color: blue; height: 25px; width: 350px;" colspan="3">

  </td>
</tr>
<tr>
  <td style="background-color: green; height: 200px; width: 175px;">

  </td>
  <td style="background-color: blue; height: 200px; width: 25px;">

  </td>
  <td style="background-color: green; height: 200px; width: 125px;">

  </td>
</tr>
</table>
</td>

<td colspan="1" style="width: 125px;">
<table class="container" style="height: 475px; width: 125px; margin-right: 25px;">
<tr>
  <td style="background-color: red; height: 475px; width: 125px;">

  </td>
</tr>
</table>
</td>

<td colspan="1">
<table class="container" style="height: 475px; width: 450px; margin-right: 25px;">
<tr>
  <td style="background-color: green; height: 25px; width: 225px;">

  </td>
  <td style="background-color: blue; height: 225px; width: 25px;" >

  </td>
  <td style="background-color: green; height: 225px; width: 225px;" >

  </td>
</tr>
<tr>
  <td style="background-color: blue; height: 25px; width: 450px;" colspan="3">

  </td>
</tr>
<tr>
  <td style="background-color: green; height: 200px; width: 450px;" colspan="3">

  </td>
</tr>
</table>
</td>

<td colspan="1">
<table class="container" style="height: 475px; width: 400px; margin-right: 25px;">
<tr style="height: 225px;">
  <td style="background-color: green; height: 225px; width: 275px;">

   <table style="width: 100%; height: 225px;">

    <tr>
         <td style="height: 100px; width: 225px; background-color: red;">

         </td>      
        </tr>

        <tr>
         <td style="background-color: blue; height: 25px; width: 225px;">

         </td>
        </tr>      

        <tr>
         <td style="height: 100px; width: 225px; background-color: red;">

         </td>      
        </tr>

       </table>       

  </td>
  <td style="background-color: blue; height: 225px; width: 25px;" >

  </td>
  <td style="background-color: green; height: 225px; width: 100px;" >

  </td>
</tr>
<tr>
  <td style="background-color: blue; height: 25px; width: 400px;" colspan="3">

  </td>
</tr>
<tr>
  <td style="background-color: green; height: 200px; width: 400px;" colspan="3">

  </td>
</tr>
</table>
</td>

</table>
</td>

</table>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-16T15:03:43.640

你是这个意思吗？

[http://jsfiddle.net/Nq8Us/1/](http://jsfiddle.net/Nq8Us/1/)

我已经编辑了您的代码，并通过删除内联样式删除了有问题的红色下方绿色的额外“填充”，然后在 css 中添加了一些指向`#problem_cell_table`.

我建议您删除所有内联样式并将它们转移到样式表。内联样式覆盖所有样式表代码。这很糟糕，也解释了为什么样式表更改没有任何效果。

至于为什么有填充，这是因为您的主表的高度包含所有行、单元格和内表，高于声明的行高加在一起。您所有行中的单元格会自动调整其大小以补偿不等于您声明的总和的像素`525px`。

在我所做的示例中，我通过将内表的 css 设置为“作弊”，`height: 100%`以便在发生计算错误时扩展以适应高度。

给我一点时间，我将`<div>`在我的答案中添加更多样式方法。

编辑：

好的，我尝试使用`<div>`和 CSS 进行布局。[http://jsfiddle.net/XbFcJ/](http://jsfiddle.net/XbFcJ/)

请记住首先使用 CSS 重置样式表！

CSS：

```
<style>
body{
    background: black;
}

.wrapper{
}

.container{
    width: 1500px;
}

.content-table {
    border: 25px solid #fff;
    overflow: hidden;
    background: #fff;
}

.content-column {
    margin-right: 25px;
    float: left;
    height: 475px;
}

.content-column.last {
    margin-right: 0;
}

.first, .third, .last {
    width: 425px;
    background-color: green;
    margin-right: 25px;
}

.top{
    height: 225px;
    border-bottom: 25px solid blue;
}

.left {
    height: 225px;
    width: 200px;
    border-right: 25px solid blue;
}

.content-column.second {
    width: 100px;
    background-color: red;
}

.last .left {
    background-color: red;
}

.last .left .top {
    height: 100px;
    border-bottom: 25px solid blue;
}​
</style> 
```

的HTML：

```
<body>
<div class="wrapper">
    <div class="container">
        <div class="content-table">
            <div class="content-column first">
                <div class="top">
                </div>
                <div class="bottom">
                    <div class="left">
                    </div>
                </div>
            </div>
            <div class="content-column second">
            </div>
            <div class="content-column third">
                <div class="top">
                    <div class="left">
                    </div>
                </div>
                <div class="bottom">
                </div>
            </div>
            <div class="content-column last">
                <div class="top">
                    <div class="left">
                        <div class="top">
                        </div>
                    </div>
                </div>
                <div class="bottom">
                </div>
            </div>
        </div>
    </div>
</div>
</body>​ 
```

# azure - 我是否需要在构建服务器上安装 AzureSdk 才能创建 azure 包？

> ID：12917269
> 
> 赞同：5
> 
> 时间：2012-10-16T14:40:36.777
> 
> 标签：azure, msbuild, continuous-integration, teamcity, packaging

我们使用 TeamCity 作为我们的 CI 服务器（但我想这适用于任何构建服务器）。

[我们尚未在构建服务器上安装 azure SDK，并且能够使用此处描述的解决方法](http://blog.codeassassin.com/2011/12/19/build-azure-projects-without-installing-the-azure-sdk-on-your-build-server/)构建使用 SDK 的项目。

我现在希望服务器生成要部署到 Azure 的包，但是当我运行 MSBuild 任务来创建包时（按照[此处](http://msdn.microsoft.com/en-us/library/windowsazure/hh301088.aspx)的指示），我收到一个奇怪的错误

`error MSB4057: The target "WatGetTargetFrameworkDirectories" does not exist in the project.`

这产生[了一些有用的谷歌](https://www.google.co.uk/search?q=%22WatGetTargetFrameworkDirectories)结果。

我需要安装 SDK 吗？还是这个错误与其他东西有关？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T20:34:43.837

`WatGetTargetFrameworkDirectories`是 AzureSDKs .targets 文件中的一个目标。看起来您的错误与 Azure SDK 有关。

除非它可能是与不太好的 msbuild Azure 目标相关的更微妙的错误。对于我们自己的天蓝色包装，我们确实需要调用 2 个目标“Clean;CorePublish”，而不仅仅是“Publish”。也许这也会对您有所帮助。

旁注：为什么不想在 TeamCity BuildAgent 上安装 AzureSDK？构建代理正是为此而生 - 拥有构建所需的框架。还可以并行安装 1.6 和 1.7 AzureSDK。

# python - 数据库错误：无法否定查找类型“in”

> ID：12917270
> 
> 赞同：2
> 
> 时间：2012-10-16T14:40:37.640
> 
> 标签：python, django, google-app-engine, django-queryset

我正在使用 Django 框架、appengine 数据库。

我的模型代码是：

```
class Group(models.Model):
    name = models.CharField(max_length=200)
    ispublic = models.BooleanField()
    logo = models.CharField(max_length=200)
    description = models.CharField(max_length=200)
    groupwebsite = models.CharField(max_length=200)
    owner = models.ForeignKey('profile')

class Group_members(models.Model):
    profile = models.CharField(max_length=200)
    group = models.ForeignKey('group') 
```

我正在查询`Group_members`删除组。我的查询如下：

```
groups = Group_members.objects.filter(Q(profile=profile.id),~Q(group__in=group_id) 
```

信息：

1.  `group_id = ['128','52']`
2.  `group`是组模型的外键

我的问题是当我运行这个查询时，它会抛出 Database error: `Lookup type 'in' can't be negated`。

我也使用`__in`它执行了查询工作正常，但不适用于外键。

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T05:17:46.597

我认为您试图在单个过滤器中过滤配置文件 ID 并删除 group_id 中的组

```
groups = Group_members.objects.filter(Q(profile=profile.id),~Q(group__in=group_id) 
```

试试这个：

1）首先过滤配置文件形式 group_member ：

```
groups = Group_members.objects.filter(profile=profile.id) 
```

2）通过以下方式从Queryset中删除组：

```
groupId = [x.group.id for x in groups if x.group.id not in group_id] 
```

希望这会给你完美的结果

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-16T22:18:23.707

2个建议。

1.  使用 ~Q(group__ pk__in=group_id)
2.  不要使用**过滤器**而不是在，而是使用**排除**和输入

# servicestack - 如何使用 IreturnVoid 使用 Servicestack.net 休息方法

> ID：12917273
> 
> 赞同：1
> 
> 时间：2012-10-16T14:40:41.330
> 
> 标签：servicestack

我正在实现 ServiceStack 的一些新 API 功能，特别是尝试使用`IReturnVoid`. 我在 Monotouch 中使用该服务，但所有客户都希望有一个响应类型。

这只是 Monotouch API 更新以支持该`IReturnVoid`类型的问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T19:51:14.993

使用**client.SendOneWay()**方法。

MonoTouch / MonoDroid 库稍微落后于完整版本，我们希望尽快纠正。

# django - Django ManyToMany 通过不同步或迁移

> ID：12917277
> 
> 赞同：1
> 
> 时间：2012-10-16T14:40:51.857
> 
> 标签：django, many-to-many, models, migrate, django-syncdb

我有这个模型（为简洁起见，此处截断）：

```
class Meal(models.Model):
    host = models.ForeignKey(User, related_name="cooking")
    cost = models.IntegerField(default=1)

    summary = models.CharField(max_length=1024, default="A good dinner")

    diners = models.ManyToManyField(User, through='Attendance',
    related_name="diners", blank=True) 
```

当我同步它时，diners Field 被完全忽略。它没有出现在数据库中，运行syncdb时也没有错误。就好像它不存在一样。用户和出勤表都很好。

我在尝试将这个字段添加到 South 时发现了这个问题，所以我也尝试了它作为替代方法。

有任何想法吗？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T16:27:27.047

在添加 diners 字段之前，您是否已经运行了 syncdb fyrir Meal？

因为 syncdb 不会更改现有表，您可以在此处阅读：

[Django 文档](https://docs.djangoproject.com/en/dev/ref/django-admin/#syncdb)

旁注 - 我个人没有使用过南，但我在开发时使用了[Django 进化](http://code.google.com/p/django-evolution/)。

编辑：

阅读您的评论后，我想我知道问题出在哪里。

当与 ManyToManyField 一起使用**时**，Django 不会向该表添加字段，所有必要的信息都在**出勤**表中。

# python - 如何在 Python 3.2 或更高版本中使用“十六进制”编码？

> ID：12917278
> 
> 赞同：32
> 
> 时间：2012-10-16T14:40:54.760
> 
> 标签：python, encoding, python-3.x, hex

在 Python 2 中，要获取字符串中十六进制数字的字符串表示形式，您可以这样做

```
>>> '\x12\x34\x56\x78'.encode('hex')
'12345678' 
```

在 Python 3 中，这不再起作用（在 Python 3.2 和 3.3 上测试）：

```
>>> '\x12\x34\x56\x78'.encode('hex')
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
LookupError: unknown encoding: hex 
```

这里至少有[一个关于 SO 的答案](https://stackoverflow.com/a/7795102/20670)提到`hex`编解码器已在 Python 3 中删除。但是，[根据文档](http://docs.python.org/py3k/library/codecs.html#standard-encodings)，它在 Python 3.2 中被重新引入，作为“字节到字节的映射”。

但是，我不知道如何让这些“字节到字节的映射”起作用：

```
>>> b'\x12'.encode('hex')
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
AttributeError: 'bytes' object has no attribute 'encode' 
```

而且文档也没有提到这一点（至少不是我看过的地方）。我一定错过了一些简单的东西，但我看不到它是什么。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-10-16T14:58:36.617

您需要通过[`codecs`](https://docs.python.org/3/library/codecs.html)模块和[`hex_codec`](https://docs.python.org/3/library/codecs.html#binary-transforms)编解码器（或其`hex`别名，如果可用^*）：

```
codecs.encode(b'\x12', 'hex_codec') 
```

[* 来自文档：*“3.4 版更改：恢复二进制转换的别名”*。]

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-10-16T16:19:05.960

另一种使用方式[`binascii.hexlify()`](http://docs.python.org/3/library/binascii.html#binascii.hexlify)：

```
>>> import binascii
>>> binascii.hexlify(b'\x12\x34\x56\x78')
b'12345678' 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2012-10-16T15:50:49.937

使用[`base64.b16encode()`](http://docs.python.org/3/library/base64.html#base64.b16encode)：

```
>>> import base64
>>> base64.b16encode(b'\x12\x34\x56\x78')
b'12345678' 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-11-18T07:03:28.703

[`binascii`](http://docs.python.org/3/library/binascii.html)顺便说一下，方法更简单：

```
>>> import binascii
>>> x=b'test'
>>> x=binascii.hexlify(x)
>>> x
b'74657374'
>>> y=str(x,'ascii')
>>> y
'74657374'
>>> x=binascii.unhexlify(x)
>>> x
b'test'
>>> y=str(x,'ascii')
>>> y
'test' 
```

# utf-8 - VBScript：以 UTF-8 打印所有字符

> ID：12917279
> 
> 赞同：2
> 
> 时间：2012-10-16T14:40:57.093
> 
> 标签：utf-8, vbscript

我正在编写一个简单的脚本来构建一个 HTML 页面，以检查 UTF-8 中的所有字符是否都正确呈现：

```
Dim oStream : Set oStream = CreateObject("ADODB.Stream")
oStream.Open
oStream.CharSet = "utf-8"

' Code writing out the top HTML snipped for brevity

Dim iChar
For iChar = 32 to 255
    oStream.WriteText iChar & " = " & Chr(iChar) & "<br/>" & VbCrLf
Next

' Code writing out the bottom HTML snipped for brevity

oStream.SaveToFile "page.html", 2
Set oStream = Nothing 
```

这很好用，直到我尝试打印超过 255 个字符，在这种情况下我得到错误：**Invalid procedure call or argument: 'Chr' (800A0005)**。

有人可以解释一下如何打印 UTF-8 字符集中的所有字符吗？

该测试旨在查看原始字符是如何呈现的 - 因此其中包含一个文件`&#256;`是不正确的，因为它需要使用宏 (Ā) 打印实际的拉丁大写字母 A。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-16T14:44:19.573

您想要`ChrW()`变体；

> [`ChrW`](http://msdn.microsoft.com/en-us/library/ws6aa3sf%28v=vs.84%29.aspx)为使用 Unicode 字符的 32 位平台提供。它的参数是一个 Unicode（宽）字符代码，从而避免了从 ANSI 到 Unicode 的转换。

# php - 第一次从 PHP 调用 http_request 很长时间

> ID：12917282
> 
> 赞同：0
> 
> 时间：2012-10-16T14:41:03.630
> 
> 标签：php, http, pool

我正在用 PHP 编写一个网站，它使用标准的“http_request”PHP 函数通过 HTTP 调用 REST 服务。

来自我的 PHP 脚本的第一个“http_request”调用需要大约 2 秒才能回复，而随后对“http_request”的调用需要不到 0.1 秒（如果我需要为一个客户端请求调用多个 REST 服务）。编码：

```
$http_method = HTTP_METH_GET;
$http_url = '127.0.0.1:8080/sites/scheme/srv/user/1';; 
$http_options = array('headers' => 
    array( 'Session-Id' => $h_session_id, 'Date-Auth' => $h_date, 'Auth-Proof' => $h_auth_proof )
);
$info = array();
$start = getNowDateWithMicrotime2();
$http_reply = http_request($http_method, $http_url, null, $http_options, $info);
$stop = getNowDateWithMicrotime2();
echo "Request/Reponse times: $start => $stop"; 
```

为什么 ？是否有任何 HTTP 连接池解决方案？（从我的 PHP 脚本调用的 REST 服务器始终位于相同的 IP 地址）。

# wix - WiX Burn - 确定已安装的项目

> ID：12917287
> 
> 赞同：8
> 
> 时间：2012-10-16T14:41:16.237
> 
> 标签：wix, installation, wix3.6, bootstrapper, burn

我有一个刻录安装，用户可以选择安装三个选项中的哪一个 - 每个选项都直接与链中的三个 MsiPackage 之一相关，例如：

```
<Chain>
  <MsiPackage SourceFile="..\ProductA\bin\Release\ProductA.msi"  InstallCondition="chkProductA" />
  <MsiPackage SourceFile="..\ProductB\bin\Release\ProductB.msi"  InstallCondition="chkProductA" />
  <MsiPackage SourceFile="..\ProductC\bin\Release\ProductC.msi"  InstallCondition="chkProductC" />
</Chain> 
```

一切都好。但是，当我下次运行 msi 时，我只想重新安装/更新最初选择的项目 - 即如果只选择了 productA，我不想安装产品 B 和 C。

如何确定最初选择的内容？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-19T13:38:56.143

好的，已排序，所以我最好发布我的解决方案。

最终归结为两部分...

a) 在安装时设置的每个产品 MSI 中设置一个注册表项。显然，如果最初没有安装该 MSI，则注册表项将不存在。IE

```
 <!-- registry entry to state that the item has been installed-->
  <Component Id="cmp_WriteToRegistry" Guid="[yourguid]">
    <RegistryKey Root="HKLM"
                 Key="Software\MyCompany]"
          Action="createAndRemoveOnUninstall">
      <RegistryValue Type="integer" Name="ProductA" Value="1" KeyPath="yes"/>
    </RegistryKey>
  </Component> 
```

b）在升级时检查该注册表项是否存在...

```
<!-- Determine what items are to be installed in the event of an install using the BA-->
<WixVariable Id="chkProductA" Value="![CDATA[chkProductA]]" />
<WixVariable Id="chkProductB" Value="![CDATA[chkProductB]]" />
<WixVariable Id="chkProductC" Value="![CDATA[chkProductC]]" />

<!-- Determine what items are installed in the event of an upgrade-->
<util:RegistrySearch Root="HKLM" Key="SOFTWARE\MyCompany" Value="ProductAInstalled" Variable="ProductAInstalled" Result="exists" />
<util:RegistrySearch Root="HKLM" Key="SOFTWARE\MyCompany" Value="ProductBInstalled" Variable="ProductBInstalled" Result="exists" />
<util:RegistrySearch Root="HKLM" Key="SOFTWARE\MyCompany" Value="ProductCInstalled" Variable="ProductCInstalled" Result="exists" />

<Chain>
  <MsiPackage SourceFile="..\SetupProductA\bin\Release\SetupProductA.msi"
              InstallCondition="chkProductA OR ProductAInstalled" />
  <MsiPackage SourceFile="..\SetupProductB\bin\Release\SetupProductB.msi"
              InstallCondition="(chkProductB) OR (ProductBInstalled)" />
  <MsiPackage SourceFile="..\SetupProductC\bin\Release\SetupProductC.msi"
              InstallCondition="(chkProductC) OR (ProductCInstalled)" />
</Chain>

</Bundle> 
```

因此，在 InstallCondition 中，当使用 UI 并选中相应的复选框时，chkProductA 的评估结果为 true，而当相应的产品已经安装时，ProductAInstalled 的评估结果为 true - 处理在我的情况下无需任何用户交互的情况下发生的更新。

当你知道怎么做时很容易。我当然不是一开始...

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-08-30T17:04:29.133

如果您正在执行自己的托管引导程序应用程序，则可以在 DetectPackageComplete 事件处理程序中执行此操作：

```
CustomBA_DetectPackageComplete(object sender, DetectPackageCompleteEventArgs e)
{
    if (e.PackageId == "SetupProductA" && e.State == PackageState.Present)
    {
        CustomBA.Engine.NumericVariables["chkProductA"] = 1;
    }
    etc...
} 
```

可以使用类似的方法来检测已安装的功能`DetectMsiFeature`。

话虽如此，如果您已经拥有自定义 BA，我只会使用此方法。构建自定义 BA 需要*大量*工作。

# c# - 来自 Request.Url.ToString() 的字符串在操作/比较第一个字符时神秘地更改为另一个字符串

> ID：12917289
> 
> 赞同：9
> 
> 时间：2012-10-16T14:41:21.927
> 
> 标签：c#, asp.net, string

我知道有更简单的方法可以做到这一点，相信我，我已经尝试过了。我当然愿意接受任何建议 =)。您无需阅读整个代码，只需阅读说明问题所在的部分即可。另外，我正在调试 perl 风格，所以你们可以看到。哦，我有没有提到在我的开发环境中一切都按预期工作？

这是代码：

```
string GetPortalAlias()
{
    String myURL2 = Request.Url.ToString();
    URLLabel.Text = "Original Request.Url.ToString() returned: \"" + myURL2 + "\"";
    string myURL = string.Copy(myURL2);
    URLLabel.Text = "Copying it to myURL, it's now: \"" + myURL + "\"";
    myURL = myURL.ToLower().Trim();
    URLLabel.Text += "<br>Trimming and ToLower myURL.<br>The new url is \"" + myURL + "\"" + "<br>";
    myURL = myURL.Replace(":80", "");
    URLLabel.Text += "Replacing the \":80\".<br> The new url is\"" + myURL + "\"<br>";

    //***HERE LIES THE PROBLEM***
    myURL = myURL.Replace("http://", "");
    URLLabel.Text += "Replacing the \"http://\".<br> The new url is\"" + myURL + "\"<br>";
    //***PROBLEM ENDS***

    myURL = myURL.Remove(myURL.IndexOf("/"));
    URLLabel.Text += "Removing everything after the \"/\"." + "<br> The new url is \"" + myURL + "\"<br>";
    URLLabel.Text += "<br>GetPortalAlias Returning \"" + myURL + "\"";
    return myURL;
} 
```

信不信由你，网页中产生的输出是这样的：

![输出](../Images/bfbc3eb4b9124f263990bd7cdf521794.png)

```
将其复制到 myURL，现在是：“http://sar.smg.com.ar/Default.aspx?TabID=912”
修剪和降低 myURL。
新网址是“http://sar.smg.com.ar/default.aspx?tabid=912”
替换“：80”。
新的网址是“http://sar.smg.com.ar/default.aspx?tabid=912”
替换“http://”。
新网址为“intranetqa/default.aspx?tabid=912”
删除“/”之后的所有内容。
新网址是“intranetqa”

GetPortalAlias 返回“intranetqa”
```

所以......由于某种原因，每当它到达替换部分时，它就会神秘地变异为以“intranetqa”而不是“sar.smg.com.ar”开头。“intranetqa”是我们的默认主机名。**以任何方式更改或删除 HTTP:// 的任何字符都会改变字符串。**

我这样做是`string.copy`因为我知道如果两个字符串相等，编译器会将它们存储在同一个地方，因此我想防止错误。拿走这些线并直接使用`Request.Url.ToString()`to`myURL`根本没有任何作用。他们只是一个测试，看看这是否有效。

这是我尝试过的事情的清单：

*   `string`/的所有组合`String`，没有一个有效。
*   我试过`Request.Host.Url`了，它只是给了我“intranetqa”。
*   我用过`Request.Url.AbsoluteUri`，这就是为什么我有 replace :80 行。
*   使用该`.tochararray`功能让我回到了 InTRANETQA 的东西
*   myURL = myURL.Substring(6) 还给了 Intranetqa 的东西。
*   string.Contains("sar.smg.com.ar") 返回错误。

**我相信诀窍就在这里**：

*   `Uri uriAddress1 = Request.Url;`并`"The parts are <br>" + "Part 1: " + uriAddress1.Segments[0] + "<br>Part 2: " + uriAddress1.Segments[1];`给出第 1 部分：“/”和第 2 部分：“Default.aspx”。尝试访问第 3 部分（索引 2）会出现异常。request.url 没有第一部分，但是当我调用 ToString() 方法时，它确实有一个“假”的第一部分

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-16T15:56:14.590

在您的浏览器和服务器之间是一个反向代理和一个输出重写器。这些可能是相同的组件，也可能是不同的组件。

您的服务器实际看到的 URL 始终是这种形式`http://intranetqa/default.aspx?tabid=912`（在反向代理/URL 重写器拦截了请求之后）。

*您的*服务器产生的输出实际上是这样的：

```
Copying it to myURL, it's now: "http://intranetqa/Default.aspx?TabID=912"
Trimming and ToLower myURL.
The new url is "http://intranetqa/default.aspx?tabid=912"
Replacing the ":80".
The new url is"http://intranetqa/default.aspx?tabid=912"
Replacing the "http://".
The new url is"intranetqa/default.aspx?tabid=912"
Removing everything after the "/".
The new url is "intranetqa"

GetPortalAlias Returning "intranetqa" 
```

输出重写器正在检查服务器的输出并替换`http://intranetqa`with `http://sar.smg.com.ar`。一旦你`http://`从这些字符串的前面剥离，它就不再匹配，因此不再发生替换。

如果您想知道原始请求 URL/主机是什么，*希望*反向代理可以或可以配置为使用原始 URL 向请求添加额外的标头。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-16T14:46:19.603

你可以试试这样的

```
Uri uriAddress1 = new Uri("http://www.contoso.com/title/index.htm");
Console.WriteLine("The parts are {0}, {1}, {2}", uriAddress1.Segments[0], uriAddress1.Segments[1], uriAddress1.Segments[2]); 
```

[Uri.Segments 属性](http://msdn.microsoft.com/en-us/library/system.uri.segments.aspx)

这是处理 URI 及其段的更好方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-16T14:52:44.933

您不想实现[这里所做](https://stackoverflow.com/questions/689678/request-url-host-and-applicationpath-in-one-call)的部分工作吗？

就像是

```
string host = Request.Url.IsDefaultPort ?
    Request.Url.Host :
    Request.Url.Authority; 
```

如果您想坚持使用旧方法，请像这样更改

```
string GetPortalAlias()
{
    var rawUrl = Request.Url.ToString();
    var lowerTrimmedUrl = rawUrl.ToLower().Trim();
    var withoutPortUrl = lowerTrimmedUrl.Replace(":80", "");
    var withoutProtocolUrl = withoutPortUrl.Replace("http://", "");
    var justHostUrl = withoutProtocolUrl.Remove(myURL.IndexOf("/"));

    var evolution = new StringBuilder();
    evolution.AppendFormat(
        "{0}<br>", 
        HttpUtility.HtmlEncode(rawUrl));
    evolution.AppendFormat(
        "{0}<br>",
        HttpUtility.HtmlEncode(lowerTrimmedUrl));
    evolution.AppendFormat(
        "{0}<br>",
        HttpUtility.HtmlEncode(withoutPortUrl));
    evolution.AppendFormat(
        "{0}<br>",
        HttpUtility.HtmlEncode(withoutProtocolUrl));
    evolution.AppendFormat(
        "{0}<br>",
        HttpUtility.HtmlEncode(justHostUrl));

    URLLabel.Text = evolution.ToString();
    return justHostUrl;
} 
```

所以你可以看到发生了什么。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-16T15:01:27.020

尝试使用此属性：

```
String myURL2 = Request.Url.AbsoluteUri; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-10-16T15:24:03.760

这是我用来拉取 SiteRootPath 的扩展方法。您应该能够根据需要轻松调整它。您将需要访问 HttpContext 以获得我目前在下面拥有的内容，但是，您听起来并不需要它。

```
using System;
using System.Web;

namespace FlixPicks.Web.Extensions
{
    public static class HttpContextExtensions
    {
        public static string SiteRootPath(this HttpContext context)
        {
            if (context == null || context.Request == null) { return null; }

            return context.Request.Url.SiteRootPath(context.Request.ApplicationPath);
        }

        public static string SiteRootPath(this HttpContextBase context)
        {
            return context.Request.Url.SiteRootPath(context.Request.ApplicationPath);
        }

        private static string SiteRootPath(this Uri url, string applicationPath)
        {
            if (url == null) { return null; }

            // Formatting the fully qualified website url/name.
            string appPath = string.Format(
                        "{0}://{1}{2}{3}",
                        url.Scheme,
                        url.Host,
                        url.Port == 80 ? string.Empty : ":" + url.Port,
                        applicationPath);

            // Remove ending slash(es) if one or more exists to consistently return
            // a path without an ending slash.  Could have just as well choosen to always include an ending slash.
            while (appPath.EndsWith("/") || appPath.EndsWith("\\"))
            {
                appPath = appPath.Substring(0, appPath.Length - 1);
            }

            return appPath;
        }
    }
} 
```

祝你好运，汤姆

# asp.net-mvc - 模型中的值为 null 或空

> ID：12917293
> 
> 赞同：0
> 
> 时间：2012-10-16T14:41:35.310
> 
> 标签：asp.net-mvc, razor

我有这个动作方法

```
[HttpPost]
public ActionResult CreateEsf(EsfLotDetailsModel model)
{
   ...
} 
```

我在这个模型中有两个属性。一个是数据库 POCO 对象，另一个是列表。在此方法的 GET 等效项中，这些值都已正确填充，但在发布时这些值设置为 null（POCO）和空（列表）。

为什么会这样？

我的观点在这里

```
@using UI.Helpers

@model UI.Areas.Admin.Models.EsfLotDetailsModel

@{
    ViewBag.Title = "Create Forward Lot";

}

<script src="@Url.Content("~/Scripts/jquery.validate.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Content/AdminDesignTheme/js/wl_Date.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Content/AdminDesignTheme/js/wl_Time.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jquery.mousewheel.min.js")" type="text/javascript"></script>

@{
        <script type="text/javascript">
            $(document).ready(function () {
                var options = {
                    dateFormat: "dd/mm/yy"
                };
                $('#Starts').wl_Date(options);
                $('#Ends').wl_Date(options);
                $('#startTime').wl_Time();
                $('#endTime').wl_Time();
            });
        </script>
}

<p>@Html.ActionLink("Back to Item List", "Index","Inventory")</p>

@Html.ValidationSummary(true, "Please correct the errors and try again.")
@using (Html.BeginForm(new {model = @Model})) {

    @Html.HiddenFor(model => model.Auction.InventoryReference)
    @Html.HiddenFor(model => model.Auction.Title)
    @Html.HiddenFor(model => model.Auction.Description)
    <fieldset>
        <legend></legend>
        <label>ESF Lot Information</label>            

        <section>
            @Html.LabelFor(model => model.Auction.Title)
            <div> @Html.DisplayFor(model => model.Auction.Title) 
            @Html.ValidationMessageFor(model => model.Auction.Title)    </div>   
        </section>

        <section>
             @Html.LabelFor(model => model.Auction.Description)
             <div> @Html.DisplayFor(model => model.Auction.Description) 
             @Html.ValidationMessageFor(model => model.Auction.Description)     </div>  
        </section>

        @if (HttpContextHelper.IsUserAdmin())
        {<section>
             <label for="IsFeatured">Is Featured <i>(displayed in homepage)</i></label>
             <div> @Html.CheckBoxFor(model => model.Auction.IsFeatured) 
             @Html.ValidationMessageFor(model => model.Auction.IsFeatured)     </div>  
        </section>
        }
        else
        {
            <section>
             <label for="IsFeatured">Is Featured <i>(displayed in homepage)</i></label>
             <div> @Html.CheckBoxFor(model => model.Auction.IsFeatured, new { disabled = "disabled" }) (Contact Admin to make this a featured lot) 
             @Html.ValidationMessageFor(model => model.Auction.IsFeatured)     </div>  
            </section>

        }

        @if (HttpContextHelper.IsUserAdmin())
        {<section>
             @Html.Label("VAT Applicable")
             <div> @Html.CheckBoxFor(model => model.Auction.VatApplicable) 
             @Html.ValidationMessageFor(model => model.Auction.VatApplicable)     </div>  
        </section>
        }
        else
        {
            <section>
             @Html.Label("VAT Applicable")
             <div> @Html.CheckBoxFor(model => model.Auction.VatApplicable, new { disabled = "disabled" }) (Contact Admin if it is not VATable) 
             @Html.ValidationMessageFor(model => model.Auction.VatApplicable)     </div>  
            </section>

        }

    </fieldset>

    <fieldset>
        <legend></legend>
        <label>Date and Time</label>

        <section>
             <label>Starts <em>(dd/mm/yy hh:mm)</em></label>
             <div> <input type="text" class="date" id="Starts" /> 
                <input type="text" class="time" data-connect="Starts" id="startTime" /> 

             @Html.ValidationMessageFor(model => model.Auction.Starts)       </div>
        </section>

        <section>
             <label>Ends <em>(dd/mm/yy hh:mm)</em></label>
             <div> <input type="text" class="date" id="Ends" /> 
                   <input type="text" class="time" data-connect="Ends" id="endTime" /> 

             @Html.ValidationMessageFor(model => model.Auction.Ends)   </div>    
        </section>
        <section>
             @Html.LabelFor(model => model.Auction.IsExtensible)
             <div> @Html.CheckBoxFor(model => model.Auction.IsExtensible) 
             @Html.ValidationMessageFor(model => model.Auction.IsExtensible)     </div>  
        </section>
    </fieldset>
    <fieldset>
        <legend></legend>
        <label>Bid Options</label>

        <section>
             @Html.LabelFor(model => model.Auction.StartingBid)
             <div> @Html.TextBoxFor(model => model.Auction.StartingBid) 
             @Html.ValidationMessageFor(model => model.Auction.StartingBid)     </div>  
        </section>

        <section>
             @Html.LabelFor(model => model.Auction.Reserve)
             <div> @Html.TextBoxFor(model => model.Auction.Reserve) 
             @Html.ValidationMessageFor(model => model.Auction.Reserve)   </div>    
        </section>

        <section>
             <label>Reserve Visible <em>(Displays as Reserve met or not met)</em></label>
             <div> @Html.CheckBoxFor(model => model.Auction.ReserveVisible) 
             @Html.ValidationMessageFor(model => model.Auction.ReserveVisible)  </div>     
        </section>

        <section>
             @Html.LabelFor(model => model.Auction.IsBidIncrementPercentual)
             <div> @Html.CheckBoxFor(model => model.Auction.IsBidIncrementPercentual) 
             @Html.ValidationMessageFor(model => model.Auction.IsBidIncrementPercentual)     </div>  
        </section>  

        <section>
             @Html.LabelFor(model => model.Auction.BidIncrement)
             <div> @Html.TextBoxFor(model => model.Auction.BidIncrement, new { @Value = 1m })
             @Html.ValidationMessageFor(model => model.Auction.BidIncrement)        </div>
        </section>              

        <section>
             @Html.LabelFor(model => model.AuctionEvents)
             <div> @Html.DropDownList("Auction", Model.AuctionEvents, "Select auction", new { required = "required" }) 
             @Html.ValidationMessageFor(model => model.AuctionEvents)       </div>
        </section>

        <section>
            <div><button>Create</button></div>
        </section>        

    </fieldset>
}

<div>
    @Html.ActionLink("Back to Item List", "Index","Inventory")
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T15:06:55.167

将 FormMethod = FormMethod.Post 添加到您的 Html.BeginForm()

```
@using (Html.BeginForm("Action", "Controller",FormMethod.Post))
{

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T15:27:52.550

你的提交按钮在哪里？

```
@using (Html.BeginForm("Action", "Controller",FormMethod.Post))
{
  ...
  <input type="submit" value="submit" />
} 
```

填写表格时，按提交按钮，然后在[HttpPost]方法中输入Model的值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-16T17:07:16.340

这些选项都不起作用。我将 POCO 对象中的所有值分别放在模型中，并删除了 POCO 对象。不知道为什么它不起作用。

# python - 如何在python中打破循环导入

> ID：12917294
> 
> 赞同：1
> 
> 时间：2012-10-16T14:41:35.373
> 
> 标签：python, celery, circular-dependency

我的 python 代码中有一个循环导入问题。一个模块的装饰器需要调用另一个模块的函数。这个函数使用的是从前一个模块导入的装饰器。错误信息显示 can't import name xxxx

我的代码结构：

```
__init__.py
worker1.py
worker2.py
... 
```

**并且在init** .py中有一个装饰器

```
def defer():
    def wrapper(func):
        def wrapper_f(*args, **kargs):
            some logic here...
            new_func = eval("%s.apply_async" % func.func_name) # I use celery to do async call here
            new_func(args = args, kwargs = kargs)
        wrapper_f.__name__ = func.func_name # This is to allow celery to load different task based on function name
        return wrapper_f
    return wrapper 
```

在worker1.py

```
@celery.task
@defer
def task1(*args, **kargs):
    some logic 
```

它将在 __init__.py 和 worker1.py 中循环导入，因为**eval("%s.apply_async" % func.func_name)**需要在 worker1 中加载函数，而 worker1 需要在 __init__ 中加载装饰器。我该如何解决这个循环导入问题？

顺便说一句，我无法将装饰器功能移动到 worker1.py 中，因为同一文件夹中的其他工作人员需要它。

# maven - 如何开始一个独立的石英工作

> ID：12917295
> 
> 赞同：0
> 
> 时间：2012-10-16T14:41:36.453
> 
> 标签：maven, cron, quartz-scheduler

```
public class CronTriggerExample
{
public static void main(String[] args) throws Exception
{
    try
    {
        JobDetail job = JobBuilder.newJob(HelloJob.class).withIdentity("dummyJobName", "group1").build();

        Trigger trigger =
                TriggerBuilder.newTrigger().withIdentity("dummyTriggerName", "group1")
                        .withSchedule(CronScheduleBuilder.cronSchedule("0/2 * * * * ?")).build();

        // schedule it
        Scheduler scheduler = new StdSchedulerFactory().getScheduler();
        scheduler.start();
        scheduler.scheduleJob(job, trigger);
        return;
    }
    catch (SchedulerException e)
    {
        e.printStackTrace();
    }
}
} 
```

我正在使用石英在我的服务器上设置一些 crons。但是我怎样才能在服务器上执行这个文件，以便可以安排 cron。我尝试使用插件“org.codehaus.mojo”来执行 java 文件。但是，当我将 mvn install 作为守护程序运行时，它总是会创建一个新触发器。怎么做才能重新初始化“mvn install”上的 cron。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T14:52:40.383

按照您编写 main 方法的方式，应用程序将在调度作业后立即退出。虽然石英任务被安排在不同的线程中，但当进程结束时，它会杀死所有活动线程。

只需`while (true) {}`在您之后添加一条语句`scheduler.scheduleJob`以保持应用程序运行。

现在，只需让 Maven 构建您的 jar 并执行`java -jar myjar.jar`

# java - 使用带有 AudioInputStream 的 URL

> ID：12917297
> 
> 赞同：2
> 
> 时间：2012-10-16T14:41:48.737
> 
> 标签：java, url, audio, wav, clip

```
 URL url = new URL("http://www.dasolorfire.freehostia.com/sound/test.wav");
            AudioInputStream sound = AudioSystem.getAudioInputStream(url); //Sound.java:50
            DataLine.Info info = new DataLine.Info(Clip.class, sound.getFormat());
            clip = (Clip) AudioSystem.getLine(info);
            clip.open(sound);
            clip.addLineListener(new LineListener()
            {
                public void update(LineEvent event)
                {
                    if (event.getType() == LineEvent.Type.STOP)
                    {
                        event.getLine().close();
                    }
                }
            });
            clip.start(); 
```

这是我从 url 加载音频的尝试。这不仅非常慢，而且当我尝试加载声音文件时，我得到了这个异常：

```
javax.sound.sampled.UnsupportedAudioFileException: could not get audio input stream from input URL
at javax.sound.sampled.AudioSystem.getAudioInputStream(Unknown Source)
at srcD.Sound.soundPlay(Sound.java:50) 
```

我的下一个尝试是用输入流替换 url。

```
 InputStream url = new URL("http://www.dasolorfire.freehostia.com/sound/test.wav").openStream();
            AudioInputStream sound = AudioSystem.getAudioInputStream(url); 
```

问题是我收到此错误：

```
java.io.IOException: mark/reset not supported
at java.io.InputStream.reset(Unknown Source)
at java.io.FilterInputStream.reset(Unknown Source)
at sun.net.www.protocol.http.HttpURLConnection$HttpInputStream.reset(Unknown Source)
at com.sun.media.sound.SoftMidiAudioFileReader.getAudioInputStream(Unknown Source)
at javax.sound.sampled.AudioSystem.getAudioInputStream(Unknown Source)
at srcD.Sound.soundPlay(Sound.java:50) 
```

（我正在尝试为 jnlp 加载声音）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-17T14:47:16.613

就第二个错误而言，您可以通过将输入流包装在 BufferedInputStream 中来使其工作，如下所示：

```
 InputStream is = new URL("http://www.dasolorfire.freehostia.com/sound/test.wav").openStream();
        BufferedInputStream bis = new BufferedInputStream( is );
        AudioInputStream sound = AudioSystem.getAudioInputStream(bis); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-16T16:31:14.997

第一个错误（could not get audio input stream from input URL）表示您所引用的音频数据的格式不受支持。我不知道您的示例代码是否使用了真实的 URL，但如果我尝试调用[http://www.dasolorfire.freehostia.com/sound/test.wav](http://www.dasolorfire.freehostia.com/sound/test.wav)，我将被重定向到[http://www.freehostia。 com/](http://www.freehostia.com/)并获取一个 HTML 页面，而不是预期的 WAV 文件。

第二个错误（不支持标记/重置）应该是不言自明的。[AudioSystem.getAudioInputStream(InputStream)](http://docs.oracle.com/javase/7/docs/api/javax/sound/sampled/AudioSystem.html#getAudioInputStream%28java.io.InputStream%29)的 API 文档解释了为什么提供的 InputStream 必须支持标记和重置功能（这些功能对于特定的 InputStream 实现是可选的）。

# javascript - 修改元素属性

> ID：12917298
> 
> 赞同：1
> 
> 时间：2012-10-16T14:41:59.180
> 
> 标签：javascript, lift

我想知道是否存在`select`使用 JsCmd in lift 修改元素属性（例如 a ）的方法。

这是我现在拥有的工作版本，运行 javascript 字符串。

```
Run("document.getElementById(\"select_id\").setAttribute(\"width\", \"30px\");") 
```

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T13:25:31.570

您可以使用 Lift 中包含的 JqJE 库，它提供了一个围绕 JQuery 的编程包装器。

以下代码段将创建一个链接，该链接将在单击时设置to的`width`属性。`#select_id``30px`

```
"#link *" #> a( () => JqId("select_id") ~> JqAttr("width","30px"), Text("clickme")) 
```

此代码片段提供了一个完整示例：[https ://gist.github.com/725432](https://gist.github.com/725432)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-17T13:22:06.607

您应该能够在代码段中使用 CSS 选择器，例如：

```
"#select_id [width]" #> scala.xml.Text("30px") 
```

这将修改`width`带有 id 的元素的属性`select_id`并将其设置为 30px。

# objective-c - 如何垂直增长场景以显示 HTML 内容？

> ID：12917300
> 
> 赞同：0
> 
> 时间：2012-10-16T14:42:01.087
> 
> 标签：objective-c, ios, cocoa-touch

我试图在 UIScrollView 中有一个场景，其中包含许多布局元素，包括一个具有任意数量的简单 HTML 内容的场景——通常约为 4-30 行。

如果我只是将内容扔到 UIWebView 中，那么它将在固定高度的框中滚动 webview 内容。那不是我想要的；由于整个页面滚动，我希望页面的长度增加以适应 HTML 内容（无论它有多高或多短），所以只有页面滚动，而 UIWebView 也不滚动。

我需要适用于 iOS5 和 iOS6 的解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T14:58:09.900

没有完全*干净*的方法可以做到这一点。问题是您是否真的*必须*使用 HTML。

如果这样做，您可以执行以下操作来计算您的高度`UIWebView`：

实现`UIWebViewDelegate`协议并在 Web 视图完成加载后执行一些 JavaScript 代码：

```
- (void)webViewDidFinishLoad:(UIWebView *)someWebView
{
    NSString *heightAsString = [someWebView stringByEvaluatingJavaScriptFromString:@"document.body.clientHeight;"];
    if(heightAsString) {
        NSInteger webViewHeight = heightAsString.integerValue;
    }
} 
```

之后，您可以调整`UIWebView`框架的大小并相应地布局其他子视图`UIScrollView`。

# mysql - 使用 php 显示 mysql 查询的结果

> ID：12917302
> 
> 赞同：0
> 
> 时间：2012-10-16T14:42:11.897
> 
> 标签：mysql

我有以下代码：

```
$query = "SELECT ads.*,
       trafficsource.name AS trafficsource,
       trafficsource.id AS trafficsourse_id,
       FROM ads
           JOIN trafficsource ON ads.trafficsourceId = trafficsource.id
        WHERE advertiserId = '$advertiser_id'";

        $mysqli = new mysqli();
        $mysqli->connect('localhost', 'root', '', 'adsbase');
        $result = $mysqli->query($query);
        while ($row = $result->fetch_assoc()) {
            echo "<h2>Traffic Sources: {$row['trafficsource']}</h2>";
        } 
```

此代码显示的结果如下：

```
Traffic Sources: Example1
Traffic Sources: Example2
Traffic Sources: Example2
Traffic Sources: Example1
Traffic Sources: Example2
Traffic Sources: Example1 
```

我想要并且无法弄清楚的是显示如下结果：

```
Traffic Sources: Example1, Example2 
```

所以没有重复，也都在一行中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T14:45:55.820

你几乎拥有它：

```
 $result = $mysqli->query($query);
    $trafficeSources = array();
    while ($row = $result->fetch_assoc()) {
        $trafficSources[] = $row['trafficsource'];
    }

    echo '<h2>Traffic Sources: ' . implode(', ', $trafficSources) . '</h2>'; 
```

## 编辑：使用 DISTINCT 查询

我假设您只需要流量来源名称，但如果需要，请随时添加更多列。请记住，尽管 DISTINCT 适用于返回的所有行的不同组合，因此如果其他选定的列不同，您最终可能会得到重复的流量来源。

```
$query = "SELECT DISTINCT trafficsource.name AS trafficsource
          FROM ads
          JOIN trafficsource ON ads.trafficsourceId = trafficsource.id
          WHERE advertiserId = '$advertiser_id'"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T14:46:51.167

在查询中的“trafficsource”中使用 Group by，然后在 while 循环中将 $row['trafficsource'] 的每个值连接到其他值并在 while 循环外回显。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-16T14:47:58.767

试试这个小解决方案：

```
 $trafic = array();
     while ($row = $result->fetch_assoc()) {
                if(!in_array($trafic)) $trafic[] = $row['trafficsource']
    }
    if(!empty($trafic)){
      echo  '<h2>Traffic Sources:' . imlode(',', $trafic) .'</h2>';
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-16T14:48:41.973

```
$trafficSources = array();
while ($row = $result->fetch_assoc()) {
    if(!in_array($row['trafficsource'], $trafficSources) {
        $trafficSources[] = $row['trafficsource'];
    }
}

echo "<h2>Traffic Sources: ".implode(', ', $trafficSources)."</h2>"; 
```

# java - 读取文本文件并删除特定字符

> ID：12917304
> 
> 赞同：0
> 
> 时间：2012-10-16T14:42:22.517
> 
> 标签：java

在有人输入一个文本文件后，我必须让它读取用户输入的文本文件。

使用 switch 语句，如何确保第一个单词和最后一个单词没有特定字符？

第一个单词不应有单引号、双引号、美元符号或句点。

最后一个单词不应有单引号、双引号、分号、冒号、句号、逗号、连字符、感叹号或问号将其删除。

我正在使用 hasNext，以便将每个单词打印在一行上。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T14:53:08.833

好吧，您可以使用`Character`类方法轻松地做到这一点`isLetterOrDigit(char ch)`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T14:54:05.247

读入第一个单词后，您可以调用此函数（将第一个单词作为参数传递），如果该单词包含任何非法字符，它将返回 true。然后，您可以轻松地创建另一个来测试您的最后一句话。

```
public boolean containsIllegalChar(String testWord){
boolean containsIllegalChar = false;

for(int count=0; count < testWord.length(); count++){
     char testChar = testWord.charAt(count);
     switch (testChar)
     {
     case ''': containsIllegalChar = true;
     break;
     case '"': containsIllegalChar = true;
     break;
     case '$': containsIllegalChar = true;
     break;
     case ' ': containsIllegalChar = true;
     break;
     default: break;
     }
}
return containsIllegalChar;
} 
```

要测试最后一个单词，您可以使用此结构

```
String lastWord = "";
while((holder = reader.read()) != -1){  
     lastWord = holder;
     //YOUR PROCESSING
}
boolean testLastWord = containsIllegalCharLastWord(lastWord);

if(testLastWord){
//Contains illegal char
}
else{
//Does not contain
} 
```

您还可以通过针对一个不错的正则表达式测试您的字符串来替换 containsIllegalChar 函数。例如

```
boolean validWord = ("piz'za".matches("[^'\"$ ]+")) ? true : false;
System.out.println(validWord); 
```

结果：

> 错误的

希望这可以帮助。菲尔

# c# - Backgroundworker ReportProgress 事件不会触发

> ID：12917306
> 
> 赞同：1
> 
> 时间：2012-10-16T14:42:26.463
> 
> 标签：c#, multithreading, timer, progress-bar, backgroundworker

我有一个后台工作人员负责我的应用程序中的计时器。这是代码：

```
 protected override void OnLoad(EventArgs e)
    {
        // Inizializzo il backgroundworker 
        bgwTimer.WorkerReportsProgress = true;
        bgwTimer.WorkerSupportsCancellation = true;
        bgwTimer.DoWork += (bgwTimer_DoWork);
        bgwTimer.RunWorkerCompleted +=(bgwTimer_RunWorkerCompleted);
        bgwTimer.ProgressChanged += (bgwTimer_ProgressChanged);
    }

    void bgwTimer_ProgressChanged(object sender, ProgressChangedEventArgs e)
    {
        throw new NotImplementedException();
    }

    void bgwTimer_RunWorkerCompleted(object sender, RunWorkerCompletedEventArgs e)
    {
        throw new NotImplementedException();
    } 
```

基本上，“ProgressChanged”事件永远不会被触发，所以我无法更新进度条的状态。事件 DoWork 链接到此方法：

```
 void bgwTimer_DoWork(object sender, DoWorkEventArgs e)
    {
        int i = 0;
        if (bgwTimer.CancellationPending)
        {
            e.Cancel = true;
        }
        else
        {
            while (bgwTimer.IsBusy)
            {                
                Thread.Sleep(1000);
                bgwTimer.ReportProgress(i);
                refreshTimer();
            }
        }
    } 
```

在我这边，代码看起来不错并且运行良好。如您所见，调用了 ReportProgress 方法，但未触发事件。有什么提示吗？

更新：哎呀！我发现只有在事件声明后立即运行 RunWorkerAsync 时才会触发事件“bgwTimer_ProgressChanged”。基本上：

bgwTimer.ProgressChanged += (bgwTimer_ProgressChanged); bgwTimer.RunWorkerAsync(); //这行得通！

由于我在用户按下按钮时运行工作程序，因此不会触发事件。

* * *

这是点击事件按钮的代码：

```
 private void btnNext_Click(object sender, EventArgs e)
    {            
        this.TopMost = true;
        btnNext.Enabled = false;
        progressBar1.Step = 0;

        if (_bgwTimer.IsBusy)
            _bgwTimer.CancelAsync();
        else
            _bgwTimer.RunWorkerAsync();
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-16T14:47:49.407

Put a breakpoint, or a `Debug.Print` or `System.Windows.Forms.Messagebox` just before `bgwTimer.ReportProgress(i)`, to verify that you're actually entering the `while` loop.

Note that the `BackgroundWorker` is not actually a timer; it's a wrapper for a thread that provides a threadsafe invoking layer for your user interface.

Your `if (bgwTimer.CancellationPending) { }` should be inside the `while` loop, not outside it. It will only get checked once in your current code.

Note that, if you're inside the `DoWork` event handler, then by definition you're running an asynchronous process, so `IsBusy` should always be true (according to the MSDN documentation), and therefore your `while` is an infinite loop. But check it with your debugger.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-16T14:53:02.423

它不会引发事件，因为 的值`i`始终为零，这很有帮助，但我在不久前构建后台工作人员时发现了同样的事情。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-16T14:56:00.347

你忘了启动工人。将此行添加到您的 OnLoad() 方法中：

```
 bgwTimer.RunWorkerAsync(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-16T14:48:33.067

In the DoWork-Method replace bgwTimer through ((BackgroundWorker)sender). Maybe this is the problem

# jsf - 是否可以动态生成 标签？

> ID：12917308
> 
> 赞同：0
> 
> 时间：2012-10-16T14:42:35.813
> 
> 标签：jsf, jakarta-ee, jsf-2, bean-validation

我正在动态生成一些 Primefaces 输入和输出组件，并且我需要能够在某些用例中禁用对这些组件的验证，同时仍然更新模型。（就像一个保存按钮）。看起来在 xhtml 中执行此操作的正确方法是使用`<f:validateBean disabled="#{myBean.someCondition}/>`

但是，我无法弄清楚如何动态创建这个组件。我搜索了 javax.faces 包，找不到任何 validateBean 组件。我想也许这将是我需要在 UIInput 组件上设置的属性，但该 API 中列出的方法似乎都不是我需要的。

这可能吗？

编辑：

作为参考，这是我正在创建的组件：

```
UIInput input = new InputText();
input.setId(field.getFieldKey());
input.setValueExpression("value", expressionFactory.createValueExpression(elContext, field.getFieldValue(), String.class));
input.addClientBehavior("blur", ajaxBehavior);    
input.addValidator(new BeanValidator()); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-16T15:32:53.043

您可能想探索这些路径：

*   在您的输入上将 immediate 设置为 true。

    ```
    input.setImmediate(true); 
    ```

*   使用空的 validate 方法扩展 BeanValidator 并将一个实例传递给您的输入。

    ```
    input.addValidator(new DummyBeanValidator()); 
    ```

希望这可以帮助。

# mysql - App Engine - 使用 MySQL 进行单元测试 - 连接过多

> ID：12917314
> 
> 赞同：2
> 
> 时间：2012-10-16T14:43:06.073
> 
> 标签：mysql, google-app-engine, junit

我的单元测试不时失败，而且由于测试部分越来越大，我收到以下错误：

```
com.mysql.jdbc.exceptions.jdbc4.MySQLNonTransientConnectionException: Data source rejected establishment of connection,  message from server: "Too many connections"
    at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
    at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:39)
    at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:27)
    at java.lang.reflect.Constructor.newInstance(Constructor.java:513)
    at com.mysql.jdbc.Util.handleNewInstance(Util.java:411)
    at com.mysql.jdbc.Util.getInstance(Util.java:386)
    at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:1014)
    at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:988)
    at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:974)
    at com.mysql.jdbc.MysqlIO.doHandshake(MysqlIO.java:1104)
    at com.mysql.jdbc.ConnectionImpl.coreConnect(ConnectionImpl.java:2412)
    at com.mysql.jdbc.ConnectionImpl.connectOneTryOnly(ConnectionImpl.java:2445)
    at com.mysql.jdbc.ConnectionImpl.createNewIO(ConnectionImpl.java:2230)
    at com.mysql.jdbc.ConnectionImpl.<init>(ConnectionImpl.java:813)
    at com.mysql.jdbc.JDBC4Connection.<init>(JDBC4Connection.java:47)
    at sun.reflect.GeneratedConstructorAccessor6.newInstance(Unknown Source)
    at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:27)
    at java.lang.reflect.Constructor.newInstance(Constructor.java:513)
    at com.mysql.jdbc.Util.handleNewInstance(Util.java:411)
    at com.mysql.jdbc.ConnectionImpl.getInstance(ConnectionImpl.java:399)
    at com.mysql.jdbc.NonRegisteringDriver.connect(NonRegisteringDriver.java:334)
    at java.sql.DriverManager.getConnection(DriverManager.java:582)
    at java.sql.DriverManager.getConnection(DriverManager.java:185)
    at vidaao.DataBase.getInstance(DataBase.java:30)
    at vidaao.DataBase.getLastInseredId(DataBase.java:57)
    at db.DbLocation.add(DbLocation.java:39)
    at testDb.DbSkillUnitTestCase.setUp(DbSkillUnitTestCase.java:47)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)
    at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
    at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42)
    at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:27)
    at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:30)
    at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:263)
    at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:68)
    at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)
    at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)
    at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)
    at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)
    at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)
    at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)
    at org.junit.runners.ParentRunner.run(ParentRunner.java:300)
    at org.eclipse.jdt.internal.junit4.runner.JUnit4TestReference.run(JUnit4TestReference.java:50)
    at org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:38)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:467)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:683)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:390)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:197)

com.mysql.jdbc.exceptions.jdbc4.MySQLNonTransientConnectionException: Data source rejected establishment of connection,  message from server: "Too many connections"
    at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
    at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:39)
    at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:27)
    at java.lang.reflect.Constructor.newInstance(Constructor.java:513)
    at com.mysql.jdbc.Util.handleNewInstance(Util.java:411)
    at com.mysql.jdbc.Util.getInstance(Util.java:386)
    at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:1014)
    at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:988)
    at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:974)
    at com.mysql.jdbc.MysqlIO.doHandshake(MysqlIO.java:1104)
    at com.mysql.jdbc.ConnectionImpl.coreConnect(ConnectionImpl.java:2412)
    at com.mysql.jdbc.ConnectionImpl.connectOneTryOnly(ConnectionImpl.java:2445)
    at com.mysql.jdbc.ConnectionImpl.createNewIO(ConnectionImpl.java:2230)
    at com.mysql.jdbc.ConnectionImpl.<init>(ConnectionImpl.java:813)
    at com.mysql.jdbc.JDBC4Connection.<init>(JDBC4Connection.java:47)
    at sun.reflect.GeneratedConstructorAccessor6.newInstance(Unknown Source)
    at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:27)
    at java.lang.reflect.Constructor.newInstance(Constructor.java:513)
    at com.mysql.jdbc.Util.handleNewInstance(Util.java:411)
    at com.mysql.jdbc.ConnectionImpl.getInstance(ConnectionImpl.java:399)
    at com.mysql.jdbc.NonRegisteringDriver.connect(NonRegisteringDriver.java:334)
    at java.sql.DriverManager.getConnection(DriverManager.java:582)
    at java.sql.DriverManager.getConnection(DriverManager.java:185)
    at vidaao.DataBase.getInstance(DataBase.java:30)
    at db.DbUser.delete(DbUser.java:51)
    at testDb.DbSkillUnitTestCase.tearDown(DbSkillUnitTestCase.java:77)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)
    at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
    at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42)
    at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:36)
    at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:263)
    at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:68)
    at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)
    at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)
    at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)
    at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)
    at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)
    at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)
    at org.junit.runners.ParentRunner.run(ParentRunner.java:300)
    at org.eclipse.jdt.internal.junit4.runner.JUnit4TestReference.run(JUnit4TestReference.java:50)
    at org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:38)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:467)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:683)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:390)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:197) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T20:54:12.770

解决方案是在查询后关闭所有打开的语句，

像这样的例子：

```
PreparedStatement stmt = DataBase.getInstance().prepareStatement(sql);

//code

//close statement
stmt.close(); 
```

# java - href 参数：在 jsp 中的第一个空白处截断的脚本结果

> ID：12917315
> 
> 赞同：0
> 
> 时间：2012-10-16T14:43:07.897
> 
> 标签：java, html, jsp, scriptlet

我在 jsp 中使用这个 scriplet 代码，它是一个巨大而古老的 webapp，所以我们没有足够的时间使用 taglib 等来制作它。

```
buffer.append("<TD> <b><A href= ...title="+MCode.getMessage(sMillesime, true) +">" 
```

问题是变量在第一个空格处被截断，为“test blabla”消息生成的 html 是：

```
<TD> <b> <a href = ... title="test" blabla> 
```

所以只有第一个词在气泡中。任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T14:58:17.003

试试这样

```
buffer.append("<TD> <b><A href= ...title=\""+MCode.getMessage(sMillesime, true) +"\">") 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-16T14:50:32.800

试一试：

```
title=\""+MCode.getMessage(sMillesime, true) +"\" >" 
```

# eclipse - Eclipse 不会在团队同步中忽略 CRLF

> ID：12917316
> 
> 赞同：1
> 
> 时间：2012-10-16T14:43:09.863
> 
> 标签：eclipse, synchronization, repository, cvs

首先，让我解释一下我在做什么。我有一个 CVS 存储库，其中存储了 5,000 个数据定义语言文件。这 5,000 个文件是从外部数据建模应用程序生成的，它们是文本并具有 Windows CRLF。在开发过程中，如果我需要进行更改，我会重新生成 5,000 个文件，然后在 eclipse 中覆盖我本地 CVS 工作区的内容。完全覆盖/替换是为了确保我不会错过任何文件更新。覆盖/替换文件后，我使用 eclipse 进行团队<与存储库同步。当我这样做时，比较会将每个文件标记为传出更改，因为它看起来没有在比较中忽略 CRLF。我选中了“忽略空白”，并且 Eclipse 文档指出它应该忽略 CRLF：

```
 Ignore whitespace option:
 Causes the comparison to ignore differences which are whitespace characters 
 (spaces, tabs, etc.). Also causes differences in line terminators ( LF 
 versus CRLF) to be ignored. 
```

当我在文本比较中打开文件时，它没有显示差异，但其中一个文件顶部有一个额外的 CRLF。这是一个错误还是我在 Eclipse 中缺少一个选项？看起来问题在于它不会忽略在自己的行上的 CRLF。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T15:40:49.857

Eclipse 比较对话框没有错误；您只是感到困惑，因为您看到了几个独立问题的输出。

1.  “忽略空格”选项只会减少比较对话框显示的更改量；它对CVS 看到的差异**没有任何影响。**所以只要文件有错误的行尾，CVS 就会报错。

    一些版本控制系统允许你指定转换器来解决这个问题，CVS 不允许。因此，您确实需要生成具有正确行尾的文件。

2.  “带有额外 CRLF 的单个文件”确实有一个额外的 CRLF。找出原因并解决它以使差异消失。

3.  生成文件时，永远不要使用`PrintStream`or `PrintWriter`。这很诱人，但是这两个有很多错误（比如`close()`doesn't `flush()`，违反了他们的 API 合同），而且他们使用平台相关的行尾，这几乎不是你想要的。是的，它可能会偶然起作用，但相信我，这不是你想要的。你也不希望你支付意外提交的支票，对吧？

    如果你不使用`PrintStream`nor ，那么出于同样的原因`PrintWriter`避免使用 System 属性。`line.separator`

    我建议编写一个辅助类，它有许多`PrintStream`/的方法，`PrintWriter`但没有任何错误。另外，它应该允许您将行分隔符设置为您需要的任何内容。

注意：如果您使用 a `Writer`，请确保您还指定了字符集/编码，否则“UTF-8 到字节”的转换将与行尾一样随机。

# java - 如何在不挂 UI 的情况下在 Android 上模拟客户端延迟？

> ID：12917323
> 
> 赞同：2
> 
> 时间：2012-10-16T14:43:46.520
> 
> 标签：java, android, unit-testing, testing

我有一个与后端 Web 服务对话的 Androd 应用程序。作为测试的一部分，我需要在按下提交按钮时模拟不同长度的客户端延迟。

现在，我在我的 OnClickListener 中使用 Thread.sleep() 作为我的提交按钮，但是像这样休眠 UI 线程会导致应用程序看起来完全“冻结”的意外后果 - 按钮一直突出显示直到线程醒来，我的 ProgressBar 同样完全冻结。这是我的代码：

```
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_checkout);

    pBar = (ProgressBar) findViewById(R.id.progressBar1);
    pBar.setVisibility(View.INVISIBLE);

    Button submitButton = (Button) findViewById(R.id.btnSubmit);
    submitButton.setOnClickListener(new OnClickListener() {

        @Override
        public void onClick(View v) {
            pBar.setVisibility(View.VISIBLE);
            try {
                Thread.sleep(3000); //eventually this delay will be random
                                    //right now it obviously hangs the UI
            } catch (InterruptedException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
            performMyAppSpecificWorkHere();
            pBar.setVisibility(View.INVISIBLE);
            CheckoutActivity.this.finish();
        }
    });  
} 
```

我正在寻找可以在不挂起整个 UI 的情况下模拟延迟的方法。欢迎任何想法。谢谢！

**编辑**

这里有一些澄清！我需要做的一部分是模拟延迟并允许用户界面干净地处理它（这是现在没有发生的事情）。

即...如果客户端或 Web 服务出现延迟，客户端应通过在等待时让微调器旋转来处理它。模拟后端延迟的能力已经完成，并且可以按照我想要的方式工作，但我想在客户端模拟延迟而不挂起 UI 线程。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-16T14:49:45.120

开始了：

```
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_checkout);

    pBar = (ProgressBar) findViewById(R.id.progressBar1);
    pBar.setVisibility(View.INVISIBLE);

    Button submitButton = (Button) findViewById(R.id.btnSubmit);
    submitButton.setOnClickListener(new OnClickListener() {

        @Override
        public void onClick(View v) {

            Thread t=new Thread(new Runnable(){
               @Override
               public void run(){
                 try {
                  Thread.sleep(3000);
                 } catch (InterruptedException e) {
                   e.printStackTrace();
                 }
                 performMyAppSpecificWorkHere();
                 runOnUiThread(new Runnable() {
                    @Override
                    public void run() {
                        pBar.setVisibility(View.INVISIBLE);
                        CheckoutActivity.this.finish();
                    }
                 }
               }
            });
            pBar.setVisibility(View.VISIBLE);
            t.start();
        }
    });  
} 
```

因此，您正在 onClick 事件中启动一个新线程。这个新线程应该在休眠 3 秒后完成应用程序的工作。之后，您想要更新一些 ui 对象，并且您不能从不是 UI 线程的线程中执行此操作。这就是为什么在执行工作之后会有一个 runOnUiThread(..) 的原因。希望能帮助到你！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-16T14:45:28.887

首先，不要阻塞主线程（ui-thread），否则gui会被冻结！相反，使用[`AsyncTask`](http://developer.android.com/reference/android/os/AsyncTask.html), 你放在[`Thread.sleep(3000)`](http://developer.android.com/reference/java/lang/Thread.html#sleep%28long%29)里面的地方[`doInBackground()`](http://developer.android.com/reference/android/os/AsyncTask.html#doInBackground%28Params...%29)，然后在里面做任何你想做的事情[`onPostExecute()`](http://developer.android.com/reference/android/os/AsyncTask.html#onPostExecute%28Result%29)（[`onPostExecute()`](http://developer.android.com/reference/android/os/AsyncTask.html#onPostExecute%28Result%29)在主线程中运行）。检查[我](https://stackoverflow.com/a/12886451/597657)对相关问题的最后回答。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-16T14:47:24.390

I think you should clarify here, you want to simulate server side delays and not the client side delay. You should put the sleep code in your server side code and not the client side code.

If it is not so, you can use asyncTask and execute the application code. You can put the sleep code inside it to simulate a client side delay.

# jquery - jquery UI 工具提示 - 未显示在元素顶部

> ID：12917325
> 
> 赞同：4
> 
> 时间：2012-10-16T14:44:05.353
> 
> 标签：jquery, jquery-ui, position, tooltip

[请在这个JS FIDDLE](http://jsfiddle.net/tKwKX/)检查我的代码

我希望我的工具提示显示在元素的顶部。我究竟做错了什么？

我也没有在 jquery UI 文档中找到关于位置属性的任何有用信息，用于工具提示我的和在意味着什么......我从他们的演示中复制了代码

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-16T14:54:34.297

您应该将位置“我的”设置为“底部-（底部的距离）检查此[JS FIDDLE](http://jsfiddle.net/tKwKX/10/)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-16T14:54:05.470

如果我理解正确，您希望工具提示文本完全覆盖它要提示的图像吗？

不幸的是，工具提示无法做到这一点。原因是，工具提示仅在鼠标“悬停”在启动工具提示的元素上时才有效。当您的工具提示覆盖该元素时，您的鼠标就会在工具提示上，而不是选定的元素上，这将触发工具提示的关闭事件。

如果最终结果比方法更重要，您可以将工具提示的 the`open`和events 都设置为而不是它们的默认值，然后相应地定位。`close``click`

**编辑**（解释`at`和`my`：

`my`并且`at`有点像一个动态的 x,y 坐标系来帮助你对齐你的元素，除了每个元素本身都是一个 x,y 。它们都允许您在 2 个相互关联的对象内设置参考点，在本例中是工具提示 ( `my`)，以及工具提示被实例化的对象 ( `at`)。

`my`在您的情况下是弹出的工具提示，并且`at`是在触发 mousein 事件时导致工具提示实例化的图像。这些选项中的每一个都采用扁平字符串或相对字符串位置来确定 2 个对象之间的关系（在 DOM 的位置）。因此，如果您希望工具提示的顶部中心与图像的绝对中心对齐，无论它们出现在 DOM 中的什么位置，您都可以设置以下内容：

```
position: {
            my: "center top",
            at: "center center"
        } 
```

您可以通过偏移任一/两者`my`以及`at`组合像素值或百分比值来获得进一步的控制。

```
position: {
            my: "center+10 top+50",
            at: "center+5 center+25"
        } 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-20T15:04:57.807

只是想给未来的搜索者一个简单的答案，他们无法理解这个词..定义是..我是我的选择器..就像“我的”形象..

```
$('img').tooltip(); 
```

同时 at 是工具提示应该出现在 'at' 的位置

例如：

```
$('img').tooltip({ position: { my: "right center", at: "left center" } }); 
```

在这里，我们选择了“我的”图像在右侧，垂直居中.. 工具提示显示在相对于图像的“左侧”并且垂直居中..

# jquery - jQuery，数组数组的“未定义”长度？

> ID：12917326
> 
> 赞同：1
> 
> 时间：2012-10-16T14:44:08.163
> 
> 标签：jquery, arrays, multidimensional-array

我有这个数组结构：

```
mdarray = {
  '0001':{address:'add1',title:'title1'},
  '0002':{address:'add2',title:'title2'},
  '0003':{address:'add3',title:'title3'}
}; 
```

如果数组中有一个或多个项目，我希望只使用它。通常使用我会使用的数组，`if (mdarray.length > 0) {}`但是当我使用上面的数组执行此操作时，`mdarray.length`返回“未定义”。

这是因为它是一个数组数组吗？如果数组根目录中的项目，是否有另一种方法可以非常简单地拉回数字？

还是因为键是字符串而不是整数？

我玩过不同的数组结构并阅读了多维数组，但我还没有找到答案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T14:45:54.537

那是一个对象，而不是一个数组。所以它没有长度！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-16T14:45:54.533

修改后的代码：您正在创建 Object 而不是 Array 您应该使用以下代码：[请参阅此 thrad](https://stackoverflow.com/questions/688097/objects-vs-arrays-in-javascript-for-key-value-pairs)

```
mdarray = [
  {address:'add1',title:'title1'},
  {address:'add2',title:'title2'},
  {address:'add3',title:'title3'}
]; 
```

mdarray.length // 3

# ruby - 没有 Rails 的 I18n？

> ID：12917329
> 
> 赞同：9
> 
> 时间：2012-10-16T14:44:17.853
> 
> 标签：ruby, internationalization, i18n-gem

只是在没有 Rails 环境的情况下无法使 I18n 工作：

* * *

```
irb> require 'i18n'
=> true
irb> I18n.load_path=Dir['/usr/lib/ruby/gems/1.9.1/gems/rails-i18n-0.6.6/rails/locale/en.yml']
=> ["/usr/lib/ruby/gems/1.9.1/gems/rails-i18n-0.6.6/rails/locale/en.yml"]
irb> I18n.load_path+=Dir['/usr/lib/ruby/gems/1.9.1/gems/rails-i18n-0.6.6/rails/locale/sk.yml']
=> ["/usr/lib/ruby/gems/1.9.1/gems/rails-i18n-0.6.6/rails/locale/en.yml", "/usr/lib/ruby/gems/1.9.1/gems/rails-i18n-0.6.6/rails/locale/sk.yml"]
irb> I18n.locale=:sk
=> :sk
irb> I18n.default_locale=:sk
=> :sk
irb> I18n.l Time.now
I18n::MissingTranslationData: translation missing:
sk.time.formats.default
  from /usr/lib/ruby/gems/1.9.1/gems/i18n-0.6.1/lib/i18n.rb:289:in
`handle_exception'
  from /usr/lib/ruby/gems/1.9.1/gems/i18n-0.6.1/lib/i18n.rb:159:in
`translate'
  from
/usr/lib/ruby/gems/1.9.1/gems/i18n-0.6.1/lib/i18n/backend/base.rb:55:in
`localize'
  from /usr/lib/ruby/gems/1.9.1/gems/i18n-0.6.1/lib/i18n.rb:236:in
`localize'
  from (irb):11
  from /usr/bin/irb:12:in `<main>'
irb> 
```

* * *

我究竟做错了什么 ？sk.yml 确实包含 sk.time.formats.default 元素！

此外，I18n 的默认 load_path(s) 是什么，所以我不会费心为每个翻译 YAML/Ruby 文件提供完整路径？

谢谢。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-01-02T21:15:55.993

您已经使用 设置了语言定义的搜索路径`I18n.load_path`。

看来，这在使用*rails*时就足够了。如果没有 rails，您还必须使用`I18n.backend.load_translations`.

总之，您需要两个步骤：

```
I18n.load_path = Dir['*.yml']
I18n.backend.load_translations 
```

字典是用语言键定义的，例如：

```
en:
  hello: "Hello world" 
```

如果你喜欢定义你的`en.yml`无语言键，你可以通过加载它们

```
I18n.backend.store_translations(:en , YAML.load(File.read('en.yml'))) 
```

（您也可以使用 here-document 或直接使用 ruby​​-hash）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-17T09:38:29.247

似乎您的 load_path 设置不正确。

尝试包含整个目录，如果成功，您应该通过调用`I18n.load_path`.

```
I18n.load_path = Dir['/usr/lib/ruby/gems/1.9.1/gems/rails-i18n-0.6.6/rails/locale/*yml'] 
```

直接设置文件路径可能会有点混乱，因为如果文件不存在，I18n 不会引发错误。

作为旁注，我建议不要包含来自 rails-i18n gem 的翻译，因为路径可能因一台机器与另一台机器不同，具有不同的 ruby​​ 版本等。项目本地的文件会更好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-06-12T20:03:06.400

您需要安装`rails-i18n`gem 来获取本地化数据。

使用此 gem 安装，可以使用以下命令在 sk 本地化中打印月份名称：

```
require 'rails-i18n'
I18n.load_path += $LOADED_FEATURES
                    .select  {|f| "rails-i18n.rb".in? f }
                    .collect {|f| f.sub('lib/rails-i18n.rb', 'rails/locale/sk.yml') }
I18n.locale = :sk
puts I18n.t('date.month_names').compact 
```

这产生：

```
 Január
 Február
 Marec
 Apríl
 Máj
 Jún
 Júl
 August
 September
 Október
 November
 December 
```

# delphi - 从字符串 const 数组中检索字符串

> ID：12917332
> 
> 赞同：0
> 
> 时间：2012-10-16T14:44:29.200
> 
> 标签：delphi, delphi-2010

如果我知道整数值的枚举，如何获得字符串表示？

```
type    
  MyEnum = (tmp_one, tmp_two, tmp_three);

const
  MyTypeNames: array[tmp_one..tmp_three] of string = ('One', 'Two', 'Three'); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-16T14:47:21.283

我假设你有一个序数值而不是这个枚举类型的变量。如果是这样，那么您只需要将序数转换为枚举类型。像这样：

```
function GetNameFromOrdinal(Ordinal: Integer): string;
begin
  Result := MyTypeNames[MyEnum(Ordinal)]; 
end; 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-10-16T14:47:35.077

我假设您想使用字符串数组中的名称。那么这很简单：

```
var
  myEnumVar: MyEnum;
begin
  myEnumVar := tmp_two; // For example
  ShowMessage(MyTypeNames[myEnumVar]); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-10-16T17:25:23.537

您不需要使用枚举类型的序数值。您可以将枚举类型的数组声明为其“下标”并直接使用枚举变量。

```
type    
  TMyEnum = (tmp_one, tmp_two, tmp_three);

const
  MyTypeNames: array[TMyEnum] of string = ('One', 'Two', 'Three');

function Enum2Text(aEnum: TMyEnum): string;
begin
  Result := MyTypeNames[aEnum]; 
end; 
```

使用枚举或强制转换为枚举的整数值调用它：

```
Enum2Text(tmp_one);     // -> 'One'
Enum2Text(TMyEnum(2));  // -> 'Three' 
```

# php - 显示 ACF 的中继器字段

> ID：12917333
> 
> 赞同：2
> 
> 时间：2012-10-16T14:44:32.047
> 
> 标签：php, javascript, jquery, html, plugins

我正在尝试在我的 wordpress 模板中显示由图像组成的转发器字段，但它不起作用。我尝试阅读插件的文档：http: [//www.advancedcustomfields.com/add-ons/repeater-field/](http://www.advancedcustomfields.com/add-ons/repeater-field/) 但仍然无法使其工作。

这是标记：

```
<div id="slideshow">
    <ul id="slides">
        <li><img src="<?php the_repeater_field('home_slider'); ?>" alt="" /></li>
    </ul>
</div> 
```

中继器字段的名称是“home_slider”，字段的名称是“home_image”。请问有人可以帮我吗？

这是加载页面后显示的内容：

```
<img src alt> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-16T14:48:55.323

转发器字段将所有内容存储在一个数组中，因此您需要检索它然后循环它，试试这个：

```
$slides = get_field('home_slider');  // Grabs the array

// Check if there is any data in the array before looping
if($slides) {
     echo '<ul id="slideshow">';
     foreach($slides as $s) {
         echo '<li>';
         echo '<img src="'.$s['home_image'].'" alt="" />';
         echo '</li>';
     }
     echo '</ul>';
} 
```

现在，根据您设置图像返回的内容（图像 url、附件 ID 或图像对象），您将需要使用不同的方法来获取图像的路径。

# javascript - 具有至少 3 个 alpha 的正则表达式，并允许使用数字和特殊字符

> ID：12917334
> 
> 赞同：1
> 
> 时间：2012-10-16T14:44:38.497
> 
> 标签：javascript, regex

我正在寻找的正则表达式是：

*   首先必须包含 3 个 alpha 字符
*   允许数值
*   允许破折号、点和下划线

例子 ：

测试1546 = 好的

vqa._96 = 好的

1test_ = KO

_test1546 = KO

非常感谢！;)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-16T14:47:17.347

试试这个正则表达式：

```
/^[a-zA-Z]{3}[\w.-]*$/ 
```

解释：

*   匹配字符串的`^`开头。
*   匹配字符串的`$`结尾。
*   `[a-zA-Z]{3}`均值匹配三个字母。
*   `\w`比赛`[A-Za-z0-9_]`。_

# spring - 在不创建应用程序上下文的情况下从上下文获取 Spring Bean 信息的最佳方法？

> ID：12917335
> 
> 赞同：1
> 
> 时间：2012-10-16T14:44:43.870
> 
> 标签：spring

我有一个 Spring (3.1.) 应用程序，它有一个大的 app-context.xml 文件。还有第二个非常小的独立应用程序，它只需要来自该 xml 文件中配置的一个 bean 的几个参数。

而不是那个小应用程序实例化整个应用程序上下文（它建立了很多连接等），我只想读入该文件中包含的几个配置参数。

我当然可以创建一个新的较小的 small-app-context.xml，它只有我需要的配置或将这些参数放在属性文件中，但是我需要在两个地方维护该信息，这是我试图避免的。我知道我可以读入并解析原始 XML 文件（不完全确定最有效的方法）。但是，我希望 Spring 提供了一个很好的方法来做到这一点，但我还没有找到它。

Spring是否提供了一种干净的方法来做到这一点？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T14:48:31.663

> I could of course create a new smaller small-app-context.xml that only has the configuration i need or put those parameters in a properties file

I would agree that configuration belongs in a properties file. Not the application context file. You should not be maintaining the configuration in two places. You should have the configuration once in your properties file and then make that available to any contexts which require it.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-16T14:49:34.293

在 Spring 中，您可以拥有多个配置文件。因此，对于您想要重用的部分，您将创建一个较小的、独立的配置文件。它可以保留在原始项目中，并且您的 app-context.xml 可以包含它。然后，您的新的小型项目可以包含小型配置 xml，您无需在两个位置维护信息。

# delphi - 连接超时 + SSL 连接 + TCPIP + Indy10.5.5

> ID：12917347
> 
> 赞同：0
> 
> 时间：2012-10-16T14:45:16.530
> 
> 标签：delphi, openssl, delphi-2010, indy

我开发了一个应用程序，用于使用 SSL 使用 TCP/IP 组件将文件客户端发送到服务器。

错误是**在服务器端**发送大文件时发生**连接超时**

 **服务器端 (SSL)

```
 idTCPServer1.IOHandler := IdServerIOHandlerSSLOpenSSL1;
   OnExecute
      Acontext.Connection.IOHandler.LargeStream := True;
      Acontext.Connection.IOHandler.ReadStream(filestream,Filesize);  // Error is occurred here.
   End; 
```

客户端 (SSL)

```
 idTCPClient1.IOHandler := IdSSLIOHandlerSocketOpenSSL1;
   idTCPClient1.IOHandler.LargeStream := True;
   idTCPClient1.IOHandler.WriteStream(fms,-1,True); 
```

客户端和服务器之间建立连接。一段时间后发送文件时，连接超时错误会显示在服务器和客户端应用程序中，并显示为 Not Responding 。

这里的另一种情况是，当我使用 IdIOHandlerStack1（在客户端）正常连接客户端和服务器时，服务器端没有分配任何处理程序。文件传输成功，没有任何问题。

我使用的是 Delphi2010 & Indy10.5.5，DLL 版本是 0.9.8.18

任何人指导我

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T19:20:34.817

没有`WriteStream()`方法，取而代之`TStream`的是方法的重载。`Write()`

您告诉`Write()`将流大小作为 64 位整数发送，但您没有告诉`ReadStream()`读取流大小，所以大概您已经预先使用 读取了完整的 64 位文件大小`ReadInt64()`，对吗？

此外，10.5.5 是 Indy 的过时版本。当前版本是 10.5.9。 [尝试升级](http://www.indyproject.org/Sockets/Docs/Indy10Installation.EN.aspx)以确保您拥有所有最新的错误修复等，然后如果您仍然遇到问题，请报告。**

# javascript - 使用 fs.readFileSync 和 eval 内容读取文件...哪个范围具有这些功能？如何访问？

> ID：12917348
> 
> 赞同：9
> 
> 时间：2012-10-16T14:45:15.840
> 
> 标签：javascript, node.js, eval, fs, google-closure-templates

我最近尝试将一个文件导入到我现有的 node.js 项目中。我知道这应该用一个模块编写，但我包括我的外部 javascript 文件，如下所示：

```
 eval(fs.readFileSync('public/templates/simple.js')+'') 
```

simple.js 的内容如下所示：

```
if (typeof examples == 'undefined') { var examples = {}; }
if (typeof examples.simple == 'undefined') { examples.simple = {}; }

examples.simple.helloWorld = function(opt_data, opt_sb) {
 var output = opt_sb || new soy.StringBuilder();
 output.append('Hello world!');
 return opt_sb ? '' : output.toString();
}; 
```

（是的，谷歌关闭模板）。

我现在可以使用以下方法调用模板文件：

```
examples.simple.helloWorld(); 
```

一切都按预期工作。但是，我无法弄清楚这些函数的范围是什么，以及我可以在哪里访问示例对象。

一切都在 node.js 0.8 服务器中运行，就像我说的那样工作......我只是不知道为什么？

感谢您的澄清。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-10-16T14:59:24.150

`eval()`将变量放入您调用它的地方的本地范围内。

就好像`eval()`被字符串参数中的代码替换了一样。

我建议将文件的内容更改为：

```
(function() {
    ...
    return examples;
})(); 
```

这样，你可以说：

```
var result = eval(file); 
```

一切都在哪里/结束在哪里，这将是显而易见的。

注：`eval()`是巨大的安全隐患；确保您只从受信任的来源阅读。

# javascript - 在 Ajax 调用被 prettyLoader 中断后重新绑定滚动操作

> ID：12917350
> 
> 赞同：0
> 
> 时间：2012-10-16T14:45:21.680
> 
> 标签：javascript, jquery

我已经编写了您的基本 jQuery 无限滚动功能。预期行为与无限滚动设计模式一致。

完成 ajax 服务器调用后，我将重新绑定滚动事件。

对于第一个 ajax 调用，一切都按预期工作，但是由于某种原因，滚动事件没有被反弹。添加控制台数据以调试函数显示代码通过 setScrollingAction() 结束执行，但滚动事件没有发生。

我错过了什么？

```
// Function to make the ajax call, append the results and rebind the scroll event
function loadContent(opts) {
  $(opts.scrollTarget).unbind('scroll');
  $(opts.loaderObject).show();
  $.get($(opts.gridObject).attr('data-link'), function(data) {
    var $data = $(data);
    $(opts.gridObject).append($data.find(opts.appendObject));
    $(opts.loaderObject).hide();
    $(opts.gridObject).attr('data-link', $data.find(opts.gridObject).attr('data-link'));
    setScrollingAction(opts);
  });
};

// Function to set the loading action to the scroll event
function setScrollingAction(opts) {
  $(opts.scrollTarget).bind("scroll", function(event) {
    if (inLoadingRange(opts)) { loadContent(opts); }
  });
};

// Function to determine height from bottom of page
function inLoadingRange(opts) {
  var target = opts.scrollTarget;
  return ($(target).scrollTop()+opts.heightOffset >= $(document).height() - $(target).height());
};

// Fire it up
$(document).ready(function(){
  opts = {
    'scrollTarget': $(window),
    'loaderObject': "#loading",
    'gridObject'  : '#tileGrid',
    'appendObject': '.newItem',
    'heightOffset': 10
  };

  setScrollingAction(opts);
});
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T16:50:03.290

原来这是与[prettyLoader](http://www.no-margin-for-errors.com/projects/prettyloader/)插件的冲突。

如果你浏览一下 prettyLoader.js，你会发现以下函数：

```
 $.prettyLoader.hide = function() {
  $(document).unbind('click', $.prettyLoader.positionLoader);
  $(document).unbind('mousemove', $.prettyLoader.positionLoader);
  $(window).unbind('scroll');
  $('.prettyLoader').fadeOut(settings.animation_speed, function() { $(this).remove(); });
}; 
```

所有滚动事件分配都在函数的第三行解除绑定。注释掉这一行解决了这个问题，并且对加载图像没有明显的影响。

```
 $.prettyLoader.hide = function() {
  $(document).unbind('click', $.prettyLoader.positionLoader);
  $(document).unbind('mousemove', $.prettyLoader.positionLoader);
  //$(window).unbind('scroll');
  $('.prettyLoader').fadeOut(settings.animation_speed, function() { $(this).remove(); });
}; 
```

# solr - 在 solr 中对多个值进行日期分面

> ID：12917352
> 
> 赞同：0
> 
> 时间：2012-10-16T14:45:39.320
> 
> 标签：solr

在 solr 中，我有两个字段，一个是日期时间 [Admission_Date]，另一个是字符串 [Name]。我想在一个 solr 查询中对多个值进行 datefaceting。

假设我有 3 条记录。名称=“测试”，“测试1”，“测试3”。

我想在一个 solr 查询中对所有三个值进行数据分面。

目前我正在使用以下链接： [http ://wiki.apache.org/solr/SimpleFacetParameters#Date_Faceting:_per_day_for_the_past_5_days](http://wiki.apache.org/solr/SimpleFacetParameters#Date_Faceting%3a_per_day_for_the_past_5_days)

在这种情况下，我可以在一个查询中为一个值提供日期分面。

但是是否可以在一个查询中提供多个值？

提前致谢，

萨加尔乔希

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T15:45:46.527

我认为您需要研究 Range Faceting。以下是一些指南：

*   [LucidWorks - 范围分面](http://lucidworks.lucidimagination.com/display/solr/Faceting#Faceting-RangeFaceting)
*   [Solr Wiki - 按范围划分的方面](http://wiki.apache.org/solr/SimpleFacetParameters#Facet_by_Range)

# php - 用于不同图像高度和新加载图像的 jquery 字幕插件

> ID：12917355
> 
> 赞同：1
> 
> 时间：2012-10-16T14:45:51.150
> 
> 标签：php, jquery, image, jquery-plugins, caption

我尝试使用 Mosaic (http://buildinternet.com/project/mosaic/) 作为 jQuery 字幕插件（我需要“向上滑动”效果），但这不适用于不同高度的图像，我不得不改变我的html结构。

我还尝试了 Capty (http://iwantaneff.in/repo/plugins/effects-ui/capty/index.html)，但是当我到达页面底部时，这个对我使用无限滚动加载的图像不起作用。因为它使用 .hover() 函数而不是 .on() 函数。

在哪里可以找到支持此功能的 jQuery 字幕插件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T14:51:46.147

我使用了 html5、css3、过渡组合
[http://jsfiddle.net/hashie5/5p7Jk/](http://jsfiddle.net/hashie5/5p7Jk/)

# uinavigationcontroller - 将导航控制器和根视图控制器与页面相结合

> ID：12917360
> 
> 赞同：0
> 
> 时间：2012-10-16T14:46:04.483
> 
> 标签：uinavigationcontroller, uipageviewcontroller

我有一个问题在iOS6上已经解决了，但是如果我使用iOS 5.1模拟器仍然会出现。

我有一个基于默认页面的应用程序。我添加了一个“主菜单”视图控制器，它具有三个按钮，通过 push segue 激活包含页面的根视图控制器，所有这些都在情节提要中定义。

然后我添加了一个导航控制器并将其作为初始视图控制器。

如果我通过一个按钮传递菜单并翻几页，我可以单击后退按钮并返回菜单。好的。

但我不想要导航栏，所以我隐藏它，并在包含页面视图控制器的根视图控制器上添加一个执行此操作的按钮：

```
[self.navigationController popToRootViewControllerAnimated:YES];
```

这个按钮在iOS6上完美运行，我可以翻几页，按下按钮，我又回到了菜单中。

然而，使用 iOS 5.1 模拟器（以及在我的 5.1 iPad 上），会发生翻页！这是一个翻页，直到我在最后一页，然后我回到菜单。

我现在搜索了两个多小时，但找不到解决方案，我希望有人能帮我解决这个问题吗？

注意：将动画设置为 NO 并不能解决问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T09:05:12.917

我确实找到了我的问题的答案，这是我的第一个 iOS 项目，它解释了为什么我自己没有尽快找到它。

在基于默认页面的应用程序中，viewDidLoad 方法中有两行：

```
// 将页面视图控制器的手势识别器添加到书本视图控制器的视图中，以便更轻松地启动手势
self.view.gestureRecognizers = self.pageViewController.gestureRecognizers;

```

首先，它不是真正添加而是分配发生在这里，其次，当我将第二行放在评论中时，一切都按预期工作。

所以我很高兴它解决了我的问题，但是它提出了一些问题：

1.  手势开始时很容易，那么为什么首先需要这条线，它应该解决什么问题？
2.  为什么它可以在 iOS6 中运行？它应该有同样的问题，不是吗？
3.  它是分配而不是添加是否正确？

仍然感谢这三个的任何答案。

亚历克斯

# vb.net - EF4 / LINQ：在一个查询中检索两个子节点

> ID：12917364
> 
> 赞同：1
> 
> 时间：2012-10-16T14:46:10.227
> 
> 标签：vb.net, linq, entity-framework-4

这是我的小问题：我有一个基于以下数据结构的 EF4 代码优先项目。

比如说，作为实体，我有一所房子，有多个房间，每个房间都有多个窗户。这是相当线性的。但窗户拥有一系列材料以及一系列颜色。我现在想加载房子，取决于房间，取决于窗户，取决于颜色**和**材料。

我使用以下代码加载所有房屋，取决于它们

*   房间 -> 窗户 -> 材料或
*   房间 -> 窗户 -> 颜色，使用以下代码：

```
`// house -> room -> window -> material
queryableHouses.Include(Of Room)(Function(u) CType(u.Rooms.Select(Function(v) v.Windows.Select(Function(w) w.Materials)), Room))
// house -> room -> window -> color
queryableHouses.Include(Of Room)(Function(u) CType(u.Rooms.Select(Function(v) v.Windows.Select(Function(w) w.Colors)), Room))`
```

`如何获得包含材料和颜色的单个结果集？`

 `非常感谢您！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T19:08:03.050

我正在考虑`join`帮助解决这个问题。就像 SQL 中的连接。您可以使用以下内容，女巫是您描述中的草稿...

```
 'select windows 
 dim query = (From w In (queryableHouses.Include(Of Room)(Function(u) CType(u.Rooms.Select(Function(v) v.Windows), Room)))

'add color from windows
Join  w.color in (queryableHouses.Include(Of Room)(Function(u) CType(u.Rooms.Select(Function(v) v.Windows), Room)) Select u.color) On w.color = u.color

'add material also from window
Join w.material in (queryableHouses.Include(Of Room)(Function(u) CType(u.Rooms.Select(Function(v) v.Windows), Room)) Select u.material)) On w.material = u.material

'then select the result 
Select w) 
```

请根据需要进行更正，这只是一个建议。我只是希望你能更多地了解这个的含义，而不是所写的。`

# python - python中的_mysql库无法识别参数load_infile

> ID：12917368
> 
> 赞同：0
> 
> 时间：2012-10-16T14:46:22.203
> 
> 标签：python, mysql-python

查看 _mysql 文档，我发现：

```
help(_mysql.connection)
class connection(__builtin__.object)
...
load_infile
  int, non-zero enables LOAD LOCAL INFILE, zero disables 
```

然后，我尝试创建一个连接，我有：

```
python> _mysql.connection(host = ..., db = ..., user = ..., passwd = ..., load_infile = 1)
TypeError                                 Traceback (most recent call last)
<ipython-input-23-e3878d45fb4e> in <module>()
----> 1 _mysql.connection(host = ..., db = ..., user = ..., passwd = ..., load_infile = 1)
TypeError: 'load_infile' is an invalid keyword argument for this function 
```

我错过了什么？

供参考：

```
In [25]: _mysql.version_info
Out[25]: (1, 2, 3, 'final', 0)

In [26]: _mysql.get_client_info()
Out[26]: '6.0.0' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T09:05:06.870

我假设您正在尝试这样做是因为错误：

> _mysql_exceptions.OperationalError: (1148, '此 MySQL 版本不允许使用的命令')

我也为此苦苦挣扎了几个小时，但最终找到了解决方案： `MySQLdb.connect(server, username, password, database, cursorclass = MySQLdb.cursors.DictCursor, local_infile = 1)`

我知道你的问题是关于 _mysql 而不是 MySQLdb，但根据 mata 的评论，你不应该使用 _mysql

# eclipse - Eclipse View 打开位置

> ID：12917369
> 
> 赞同：1
> 
> 时间：2012-10-16T14:46:28.147
> 
> 标签：eclipse, eclipse-plugin

我有一个可以多次打开的视图，其中包含不同的数据。我在编辑器区域下方的文件夹中为视图添加了一个占位符。视图的第一个实例在正确的位置打开，但如果我打开视图的第二个版本，它会在编辑器的右侧打开。有没有办法像第一个一样在编辑器下方的文件夹中打开所有这种类型的视图？我必须添加多个占位符吗？即使我关闭视图的第一个实例并打开它的另一个实例，新视图也会在编辑器的右侧打开。

视图的不同之处在于根据该 id 填充视图的辅助 id。

# java - 在内部类中定义按钮动作与在摆动的公共类中定义按钮动作

> ID：12917371
> 
> 赞同：3
> 
> 时间：2012-10-16T14:46:35.840
> 
> 标签：java, swing, jbutton, actionlistener

我有一个对话框，其中有四个按钮，分别是新建、保存、删除、取消。现在，这些中的每一个都需要执行它们的操作。所以我定义了一个单独的类来实现`ActionListener`. 我已经使用这个类来执行每个按钮操作。

```
public class MyClass implements ActionListener {
  public void actionPerformed(ActionEvent e) { 
   if(e.getActionCommand().toString() == "OK") {
        // Code
   } else if( .. ){

   }
  }
} 
```

我所做的是，我定义了一个用于执行相同功能的内部类。但我没有得到的是，最好的做法是编写一个单独的类还是最好使用内部类。有人建议我在公共课上写作，以便明天有人可以使用这门课来执行他们的行动。所以我有以下问题，

1.  如果任何对象都没有调用该功能（我不能说），那么我可以在内部类中编写它吗？或者

2.  总是编写执行该对话框操作的内部类是一种好习惯吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-16T14:53:53.950

当您谈论为 GUI 侦听器定义内部类时，我立即想到使用匿名类来完成这项工作：

```
newButton.addActionListener(
    new ActionListener()
    {
        public void actionPerformed(ActionEvent e)
        {
            // do the work for a button press
        }
    });      

// similarly for save, cancel, delete buttons:
saveButton.addActionListener(
    new ActionListener()
    {
        // ... 
```

你会经常看到这个，我经常在我自己的代码中使用它。

您使用哪个取决于您的代码结构，例如：

*   每个听众需要做多少工作
*   处理程序之间共享多少代码

如果每个处理程序都很短（例如，只有一个方法调用，所有实际工作都在另一个类方法中处理），我将使用这种方式使用匿名类。但它看起来确实很傻：不幸的是，java 要求我们定义一个对象来使用回调方法。

这也是个人喜好和编码风格的问题。

但是，我很少像您的示例那样为 GUI 处理程序创建一个新的顶级类：即使我分离出该类以便为每个按钮使用相同的类，我也会在类文件中定义该类控制按钮，可以作为非公共顶级类，也可以作为内部（非匿名）类。如果 GUI 回调的复杂性增长到需要一个单独的类，我会开始寻找重构的地方。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-10-16T14:54:11.970

这些问题没有一般的答案。如果代码`actionPerformed()`是一行，写一个完整的类文件通常是大材小用。

如果代码更复杂，它可能适合重用，但随着代码的增长，它也会变得更加具体（所以你不能再重用它）。

尝试遵循这种方法：

*   从相互独立的简单块构建您的应用程序。
*   通过编写连接块的代码来配置应用程序。

因此，在您的情况下，您可以使用辅助方法来完成工作。将它们包裹在[Swing`Action`](http://docs.oracle.com/javase/7/docs/api/javax/swing/Action.html)中[；](http://docs.oracle.com/javase/7/docs/api/javax/swing/Action.html)这使您可以在各种按钮和菜单中使用它们。

尝试将尽可能多的工作转移到助手中，以使操作变得非常简单。如果有疑问，问问自己：这段代码是工作的一部分吗？每个人都需要这样做吗？

如果是，那么代码应该进入工作/助手类。

如果是 UI 相关检查（可见/启用）、转换（字符串到数字）、验证等，它应该进入操作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-16T15:59:03.327

*   正确的方法应该是[Swing Action(@Robin 在评论中提到)](http://docs.oracle.com/javase/tutorial/uiswing/misc/action.html)，因为JButtons[组件](http://docs.oracle.com/javase/tutorial/uiswing/components/button.html)是最具可扩展性的选择，并实现了有趣的方法

*   most complex GUI is there way to add [EventHandler](http://docs.oracle.com/javase/7/docs/api/java/beans/EventHandler.html), [which fired event and could be compare in String value](https://stackoverflow.com/a/9007348/714968)

# java - Java中对象的优先级队列

> ID：12917372
> 
> 赞同：2
> 
> 时间：2012-10-16T14:46:39.420
> 
> 标签：java, priority-queue, comparator

您好，我在优先级队列和比较器中有点迷失了。我真的不明白如何在java中制作比较器所以我所拥有的是给我一个错误，我所读到的对我没有帮助 [http://www.tutorialspoint.com/java/java_using_comparator.htm](http://www.tutorialspoint.com/java/java_using_comparator.htm) 这个帖子游戏我一些想法，但我仍然坚持 [如何去做我如何使用 PriorityQueue？](https://stackoverflow.com/questions/683041/java-how-do-i-use-a-priorityqueue)

我所拥有的是一个创建具有优先级、到达时间和完成时间的对象的类。我还有许多优先级队列可以放入。当我开始时，我将它们放入到达队列中对它们进行排序，然后查看哪个最先进入并将其放入队列中。但是，当我尝试将第二个添加到到达队列时，它会失败并引发异常。我首先要做的是将所有进程添加到到达队列中，然后对它们进行排序，以便到达时间最短的进程将成为到达队列中的第一个进程并进入队列一。感谢您对此的任何帮助

```
 //the comparator
    Comparator<Integer> comparator = new Comparator();
    //priority queues
    //only needs 10 elements to  hold
    PriorityQueue one = new PriorityQueue(10, comparator);
    PriorityQueue two = new PriorityQueue(10, comparator);
    PriorityQueue three = new PriorityQueue(10, comparator);
    PriorityQueue four = new PriorityQueue(10, comparator);
    PriorityQueue arrival = new PriorityQueue(10, comparator);

    //put all processes in arrival queue
    arrival.add(p1);
    arrival.add(p2);
    arrival.add(p3);
    arrival.add(p4);
    arrival.add(p5);
    arrival.add(p6);
    arrival.add(p7);
    arrival.add(p8);
    arrival.add(p9);
    arrival.add(p10); 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-16T14:58:17.540

让我们看看你是如何定义的`Comparator`，因为目前我认为你所写的甚至不会编译。

`Comparator`是一个接口，意味着你需要定义一个实现它的*类。*也就是说，您需要定义一个类，该类具有接口描述的方法的具体实现。在这里，您只需要担心一种方法 - `compare`。（接口也定义了`equals`，但这是一个奇怪的选择，因为它等于 on `Object`，所以每个类都会默认实现它......）

该`compare`方法采用目标类型的两个对象，并决定其中一个“先于”另一个。它返回：

> 作为第一个参数的负整数、零或正整数小于、等于或大于第二个参数。

所以 - 你想比较你的`p1`,`p2`实例是什么类的对象（我称之为`MyClass`）。这意味着您必须定义一个类：

```
class MyComparator implements Comparator<MyClass> {

    public int compare(MyClass a, MyClass b) {
        // TODO
    }
} 
```

我们知道 compare 方法应该返回一个值，具体取决于哪个`MyClass`参数在另一个参数之前。您在您的问题中说过，第一个到达的那个是到达时间最短（即最早？）的那个。

这实际上很简单，因为这就是所谓的对象*自然排序*`java.util.Date`——所以你可以直接比较它们的到达时间，因为比较的结果和*整体*比较的结果是一样的。

因此，`compare`可以简单地实现（假设一个命名合理的访问器方法）：

```
public int compare(MyClass a, MyClass b) {
    return a.getStartTime().compareTo(b.getStartTime());
} 
```

你去吧！您刚刚定义了自己的比较器，它将`MyClass`按开始时间升序对对象进行排序。您可以在优先级队列中使用它，就像您已经拥有的一样：

```
Comparator<MyClass> comparator = new MyComparator();
PriorityQueue<MyClass> arrival = new PriorityQueue<MyClass>(10, comparator); 
```

# c# - 为 Lotus Notes 文件上传控件设置默认目录

> ID：12917374
> 
> 赞同：1
> 
> 时间：2012-10-16T14:46:47.637
> 
> 标签：c#, file-upload, lotus-notes

我有一个 lotus notes 网络表格，不懂电脑的客户将使用它来附加 Excel 文件并将它们提交给我们公司。我正在使用 Lotus Notes 文件上传控件来允许他们执行此操作，但是，我需要将此文件上传控件默认为某个目录位置。我已经创建了一个客户将使用的 C# 应用程序，它将所有这些 excel 文件放在某个目录位置，因此我需要关注这个文件上传控件。不幸的是，一些客户在计算机上遇到了足够的挑战，以至于不知道如何自己导航到这些文件。这可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T15:11:52.057

我假设用户将访问带有文件上传控件的网页，是吗？如果我有误解，请告诉我，我会删除这个答案。

简单的答案是不可能。问题是浏览器对访问该站点的客户端的文件结构一无所知，因此“默认路径”属性实际上没有意义。它可能仅适用于非常特定的环境（在您的情况下可能是正确的，但通常不适用于整个网络）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-17T12:19:59.663

我将调查使用 Notes API 让 C# 程序处理上传，而不涉及浏览器客户端使用文件上传控件。我不知道足够多的 Java 来确定，但也许这也可能是一种选择——基本上是编写你自己的自定义上传控件，它只询问用户的文件名。

您也可能严重低估了用户遵循指示的能力。如果您的页面确定了文件将在哪个目录中找到，我希望大多数用户能够按照说明从正确的目录上传。

因此，我确信在 Notes 中可以完成您想要完成的任务，而不是像在文件上传控件中添加默认目录那样简单。

# c# - Too many WCF channels

> ID：12917377
> 
> 赞同：3
> 
> 时间：2012-10-16T14:46:51.100
> 
> 标签：c#, wcf

In our system there are multiple "sites" communicating with one another via WCF. Each site exposes ~20 interfaces over NetTCP binding.

When a site consumes the interfaces of the peer site, it will open a separate TCP socket for each channel. This means that if I want to regularly use all the interfaces, ~20 TCP sockets will remain open for each peer site.

The number of peers each site has is currently relatively small (10-15), but this will have to grow to ~100 in the near future. My concern is that this will require each site to have ~2000 incoming sockets which seems excessive. I can't put my finger on a specific problem, but it just feels wrong. For example, this greatly exceeds WCF's default MaxConcurrentConnections (default value is 10).

Is this a good design for the system? Should I be looking at consolidating all those interfaces into a single interface (and thus a single channel)? Will I be able to send messages concurrently on a single channel (I think not)? Perhaps I should consider a message queue system?

Any comments or ideas would be welcome.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T14:49:06.920

您是否尝试过启用端口共享？即[http://msdn.microsoft.com/en-us/library/ms734772.aspx](http://msdn.microsoft.com/en-us/library/ms734772.aspx)

# extjs4 - How to run a Sencha Architect MVC application in Liferay

> ID：12917379
> 
> 赞同：0
> 
> 时间：2012-10-16T14:47:00.540
> 
> 标签：extjs4, extjs, liferay, sencha-architect

Does anyone have any information on how to properly run a Sencha Architect MVC app in LifeRay?

Designing, and running an app using architect(in a simple local apache server for mock up purposes) seems to work perfectly. My problem is trying to convert this over to use our LifeRay portal(ver 6)

I have tried to use Senchas build tools to create a jsb and build all into one JS script, but that seems to be missing required classes, and it says it is missing files, `"NetworkError: 404 Not Found - htp://localhost:8080/web/www/senchaTest/view/MainViewport.js?_dc=1350398599155".`

I have been searching for good info on how to run a Sencha MVC app in liferay, with the proper setups, but have not found *any* information out there.

Can anyone point me in the correct direction?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T05:25:21.810

所有遵循 JSR-286 标准的应用程序都可以与 Liferay 集成，您的应用程序是否遵循 JSR-286 标准？

# asp.net - 包括来自顶层目录的控制

> ID：12917382
> 
> 赞同：1
> 
> 时间：2012-10-16T14:47:05.737
> 
> 标签：asp.net

在我的 C:\ 目录中，我有两个文件夹 C:\Twin1 和 C:\Twin2

Twin1 包含一个文件夹 UserControl，并包含一个文件 myControl1.ascx。所以路径看起来像这样：

```
C:\Twin1\UserControl\myControl1.ascx 
```

Twin 2 包含类似的结构，但带有 myControl2.ascx。所以路径看起来像这样：

```
C:\Twin2\UserControl\myControl2.ascx 
```

我在 Twin1 中有一个 aspx 文件。

```
C:\Twin1\myPage.aspx 
```

在 myPage.aspx 中包含 myControl1.ascs，我相信我需要做的就是：

```
<%@ Register Src = "~/UserControl/myControl1.ascx" TagName = "myTag" TagPrefix = "tp1" %> 
```

但我不确定如何将 myControl2 包含到 myPage.aspx

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T14:56:54.727

恐怕你需要复制`C:\Twin2\UserControl\myControl2.ascx`到`C:\Twin1\UserControl\myControl2.ascx`

如果你想重用用户控件，你需要创建一个控件库。不幸的是，用户控件并不是很适合在不同的项目之间重用，尽管这是完全可能的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T14:57:10.767

你不能直接（我不认为）。

您需要构建`twin2`，并将`twin2.dll`的 bin 目录`twin1`与`mycontrol2.ascx`的`userControl`目录中的`twin1`

然后，您可以`mycontrol2.ascx`以通常的方式添加，项目将引用该`twin2.dll`控件的代码隐藏。

如果您随后需要对 进行代码更改`twin2`，则需要打开该项目，编辑并重建 dll。

如果它们将成为您的站点之间的通用组件，则可能值得单独设置一个“userControl”项目，然后根据需要复制`.dll`和`.ascx`文件。

编辑：为了使控件更容易像上面那样移动，您可以查看`serverControls`，其中输出全部手动编写在代码隐藏中，这样您只需将`.dll`文件包含在`bin`任何其他项目的目录中。

# haskell - Haskell - 显示实例多种数据类型

> ID：12917393
> 
> 赞同：3
> 
> 时间：2012-10-16T14:47:37.093
> 
> 标签：haskell, types, instance, show

我目前正在为学校作业制作国际象棋游戏，并且我的棋子已定义

```
 data Piece = Piece { piecetype :: PieceType, color :: PieceColor }
    data PieceType = Pawn | Knight | Bishop | Rook | Queen | King
    data PieceColor = Black | White deriving Eq 
```

现在我必须将一块打印为单个字符（king = k，queen = q，knight = n 等）对于黑色块，该值是其白色值的大写（king = K，queen = Q，knight = N等）所以我做了三个show实例

```
 instance Show PieceColor where
        show Black = "B"
        show White = "W"

    instance Show PieceType where
        show Pawn = "P"
        show Knight = "N"
        show Bishop = "B"
        show Rook = "R"
        show Queen = "Q"
        show King = "K" 
```

第三个是问题

```
 instance Show Piece where
        show (piecetype, color) = show piecetype 
                                  if show color == "W"
                                  then show piecetype
                                  else toUpper (show piecetype) 
```

我收到以下错误（我也尝试了很多比这更多的但根据这个链接我看起来很接近[的东西有点相似](https://stackoverflow.com/questions/5677749/haskell-instance-show)

```
Couldn't match expected type `Piece' with actual type `(t0, t1)' 
```

我感谢任何帮助亲切的问候，我

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-16T14:57:34.077

直接回答：

```
instance Show Piece where
    show (Piece piecetype Black) = map toLower $ show piecetype
    show (Piece piecetype White) = show piecetype 
```

说明：

*   `Piece`是具有构造函数的数据类型`Piece`（类型名称和构造函数都与您的情况相同），而不是元组。所以你应该在构造函数而不是元组上进行模式匹配。

*   `toUpper`并且`toLower`出现在`Data.Char`并且正在工作，`Char`而像是（是类型的同义词）之类`"B"`的东西。因此，要制作大写字母，您可以使用.`String``String``[Char]``String``map toUpper`

*   比较类似字符串`show color == "B"`的效率不是很高，而是可以在构造函数名称上使用模式匹配。

# php - Wordpress read RSS full article

> ID：12917394
> 
> 赞同：0
> 
> 时间：2012-10-16T14:47:39.353
> 
> 标签：php, wordpress, rss, feed

I'm using PHP simpleXML_load_file command to load a WordPress Feed , however I see only a summary of the article and not the whole of it.

example : [http://www.tenditrendy.com/wp-rss2.php](http://www.tenditrendy.com/wp-rss2.php)

I've learned that it might be related to "show full text" configuration or to some plugin that are installed at WordPress , is that so?

what shall I do in order to read the full article and not just a summary?

# model-view-controller - Use ResultSet object in JSP without JSTL

> ID：12917395
> 
> 赞同：1
> 
> 时间：2012-10-16T14:47:40.307
> 
> 标签：model-view-controller, jsp, servlets, resultset

I want to pass my query's result i.e ResultSet to JSP just for the display as i am using MVC framework.

My Servlet Code:

```
Connection c=Connectivity.dbConnect();
       PreparedStatement ps=c.prepareStatement("select role from login where userid=? and password=?");
       ps.setString(1,userid);
       ps.setString(2,pass);
       ResultSet rs=ps.executeQuery();

     if(rs.next())
     {

          if(rs.getString(1).equals("admin"))
                   {

           ps=c.prepareStatement("select * from user where userid=?");
           ps.setString(1,userid);
           rs=ps.executeQuery();   
           Result r=ResultSupport.toResult(rs);          
           request.setAttribute("res",r);       

           rs.close();
           c.close();
           return mapping.findForward("us");//to User.jsp

                   }
      } 
```

I've used ResultSupport.toResult() to forward it to JSP (forwarded by 'us' mapping) but that requires JSTL code in JSP :

User.jsp -

```
<c:forEach var="data" items="${requestScope.res.rows}">
      <h1>${data.userid}</h1>
               <h2>${data.name}</h2>
               <h2>${data.password}</h2>
               <h2>${data.emailid}</h2>
  </c:forEach> 
```

Moreover if i directly pass ResultSet like `request.setAttribute("ResultSet",rs);` i wouldn't be able to close the connection in JSP.

This Code works fine but i do NOT want to use JSTL/EL or Lists , i want to use scriplets in JSP that can handle Result or ResultSet attribute from Servlet.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T06:34:03.717

你可以像这样克服你的问题：

1) 在您的数据库操作类中，使用 POJO 从 ResultSet 添加结果。

```
Contacts myContact = new Contacts();
myContact.setOffice(rs.getString("office1"));
myContact.setMail(rs.getString("xx@xx.com")); 
```

2）然后使用列表来存储您的结果

```
List<Contacts> myList = new ArrayList<Contacts>();
myList.add(myContact); 
```

3）将列表传递给您的请求/会话对象并在那里关闭 ResultSet/Connection

```
request.setAttribute("LIST",myList);
rs.close(); 
conn.close() 
```

4) 在 JSP 中获取列表并随心所欲地对其进行迭代

```
ArrayList<Contacts> myList = (ArrayList<Contacts>) request.getAttribute("LIST");
for(Contacts obj: myList){
  out.print(obj.getMail());
  ....
  ....
} 
```

# mysql - Sorting mysql upcoming birthdays of users

> ID：12917397
> 
> 赞同：0
> 
> 时间：2012-10-16T14:47:46.403
> 
> 标签：mysql

> **Possible Duplicate:**
> [MySQL query to sort upcoming birthdays based on current date](https://stackoverflow.com/questions/7343807/mysql-query-to-sort-upcoming-birthdays-based-on-current-date)

I have a MYSQL code like:

```
$friends=mysql_query("SELECT id,friend_id,f_name,
DATE_FORMAT(f_birthday,'%d %b')
AS f_birthday from friends where id='$id' 
ORDER BY MONTH(f_birthday), DAYOFMONTH(f_birthday)"); 
```

with this code block i can sort the user's birtdays with months and days starting from January first. But i can not sort them according to the upcoming birthdays. Searched for hours and found many solutions on stackoverflow but could not succeed. I really need help. Thanks.

**EDIT**

EXAMPLE OF MYSQL TABLE:

> ```
>  id         friend_id        f_name      f_birthday
> 100001403795149 542542215       Mıchael        1984-10-01
> 100001403795149 557277949       MARY           1966-11-30
> 100001403795149 100002251590924 John           1985-07-05
> 100001403795149 100002534859304 Lucas          1977-09-15 
> ```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T14:50:17.607

```
SELECT id,friend_id,f_name,
DATE_FORMAT(f_birthday,'%d %b')
AS f_birthday from friends where id='$id' and f_birthday >=now()
ORDER BY MONTH(f_birthday), DAYOFMONTH(f_birthday) asc 
```

# search - C# How to find two different strings at one search in RichTextbox

> ID：12917401
> 
> 赞同：2
> 
> 时间：2012-10-16T14:47:53.423
> 
> 标签：search, richtextbox

I have a lot of Android log in RichTextbox loaded from file. Lets say i search for "Fatal" word by default search method and i got this:

```
10-11 19:37:44.647 19525 19789 E AndroidRuntime: FATAL EXCEPTION: IntentService[ContactSaveService] 
```

But, as I know there is possibility that there will be more than 1 exception in dumpstate. So i thought, it would be nice to compare file name with line of Fatal in this log.

File name: dumpstate_app_201210111708___error

Error log: 10-11 19:37:44.647

It doesnt match. So i would like to do something like this:

```
 if(rtb.Lines[i].contains(date_of_exception))
{

    rtb.Select(startPos, text.Length);
    rtb.ScrollToCaret();
    rtb.Focus();

} 
```

Of course it doesnt work. I have no idea how to solve it. I thought about getting number of line with found text and search if this line contains date_of_exception

What I am sure. Time of fatal exception must be the same with time in file name. And that's why i need to check if line in richtextbox contains "fatal" word and time of exception from file name.

I hope it is clear, if not, i will try to describe it better. Thanks in advance

# regex - nginx 重写规则以重写某个正则表达式的每个匹配项，除了

> ID：12917403
> 
> 赞同：0
> 
> 时间：2012-10-16T14:47:58.610
> 
> 标签：regex, url-rewriting, nginx, rewrite, uri

我正在 nginx 中编写重写规则。

**我想重写与 except 匹配`/A/B[anything]`的`/X/` *每个* `/A/B/C[/]`URI 。**

**我该怎么做呢？**

我试过的：

```
if ($request_uri ~ ^/A/B/C/?) {
    break;
}
rewrite ^/A/B   /X/   permanent; 
```

这会重写`/A/B`为`/X/`，但`/A/B[anything]`不会被重定向，也不会`/A/B/C/`停留在`/A/B/C/`.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T16:05:37.163

```
rewrite ^/A/B/?$   /X/   permanent; 
```

应该这样做

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T19:33:34.127

我弄清楚了这个问题。

我需要制作重写线

```
rewrite ^/A/B(.*)?   /X/   permanent; 
```

意思是“`(.*)?`并且可以选择匹配任何次数。”

# android - ActionBarSherlock with fullscreen

> ID：12917416
> 
> 赞同：3
> 
> 时间：2012-10-16T14:48:47.487
> 
> 标签：android, android-layout

Is there some way to hide status bar and keep action bar visible?

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-10-16T17:54:05.100

Yes, there is. You should set `FLAG_FULLSCREEN` in your `onCreate` method of Activity.

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    this.getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN,
            WindowManager.LayoutParams.FLAG_FULLSCREEN);
    setContentView(R.layout.activity_main);
} 
```

# java - Using Reflections for finding the (transitive) subtypes of a class when not all the types in the hierarchy are in the filtered classpath url

> ID：12917417
> 
> 赞同：2
> 
> 时间：2012-10-16T14:48:48.517
> 
> 标签：java, reflection, classpath, reflections

I am trying to use the [Reflections](https://code.google.com/p/reflections/) library to obtain all the subclasses of a particular class. I need to filter the search to only the subclasses in a particular classpath url. This is the code I am using:

```
ConfigurationBuilder config = new ConfigurationBuilder();
config.addUrls(<my_url>);
Reflections reflections = new Reflections(config);
Set<Class<? extends A>> set = reflections.getSubTypesOf(A.class) 
```

My problem is the following: Let's assume that class B extends A, and class C extends B. So we have:

```
A <|-- B <|-- C 
```

A and B are in a classpath URL different than the one of C. And the url given to reflections is the one of C. Then I would expect C to be in the returned set, and B should not be present since it is in another classpath url.

However, the returned set is empty. C is not in the set of classes returned by reflections, though it is a transitive descendant of A. If I move B to the same classpath URL of C, then both B and C are returned. Then I guess the problem is that Reflections by default does not answer (transitive) subclasses if any of the classes in the middle of the hierarchy are not in the filtered url.

My questions is: How can I instruct reflections to answer (transitive) subclasses of a particular class, even if certain classes in the middle of the hierarchy are not in the filtered url (but the subclass itself IS in the filtered url)?.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-10T07:54:59.233

关键是传递性无法发现是否没有扫描所有相关的 url。你应该知道你的类路径。

如果您不知道所有涉及的网址，您可以扫描所有网址，使用

```
ClasspathHelper.forClassLoader() 
```

# java - 如何从指纹读取器读取数据并在java中转换为图像文件

> ID：12917422
> 
> 赞同：4
> 
> 时间：2012-10-16T14:48:57.930
> 
> 标签：java, fingerprint

我必须从指纹读取器读取数据并转换为图像文件。我正在使用带有 Platinum SDK 的 Digital Persona 的设备 U 和 U 4500。我是新的生物识别领域。到目前为止，我只能检测到设备是否已连接到系统。请指导我该怎么做才能完成此任务

我已使用此代码（仅用于检查设备是否正常工作）

```
import com.digitalpersona.onetouch.DPFPGlobal;
import com.digitalpersona.onetouch.DPFPSample;
import com.digitalpersona.onetouch.capture.DPFPCapture; 
import com.digitalpersona.onetouch.capture.event.DPFPDataEvent;
import com.digitalpersona.onetouch.capture.event.DPFPDataListener;
import com.digitalpersona.onetouch.capture.event.DPFPErrorEvent;
import com.digitalpersona.onetouch.capture.event.DPFPErrorListener;
import com.digitalpersona.onetouch.capture.event.DPFPReaderStatusAdapter; 
import com.digitalpersona.onetouch.capture.event.DPFPReaderStatusEvent;
import com.digitalpersona.onetouch.capture.event.DPFPReaderStatusListener;
import com.digitalpersona.onetouch.capture.event.DPFPSensorEvent;
import com.digitalpersona.onetouch.capture.event.DPFPSensorListener;

public class Demo {
public static void main(String args[]){
//byte[] a=null;
DPFPCapture capture=DPFPGlobal.getCaptureFactory().createCapture();
capture.addReaderStatusListener(new DPFPReaderStatusListener() {

    @Override
    public void readerDisconnected(DPFPReaderStatusEvent arg0) {
         //TODO Auto-generated method stub
        System.out.println("I m Dis-connected");

    }

    @Override
    public void readerConnected(DPFPReaderStatusEvent arg0) {
        // TODO Auto-generated method stub
        System.out.println("I m connected");
    }
});
capture.addSensorListener(new DPFPSensorListener() {

    @Override
    public void imageAcquired(DPFPSensorEvent arg0) {
        // TODO Auto-generated method stub
        System.out.print("acquired");
    }

    @Override
    public void fingerTouched(DPFPSensorEvent arg0) {
        // TODO Auto-generated method stub
        System.out.print("s");
    }

    @Override
    public void fingerGone(DPFPSensorEvent arg0) {
        // TODO Auto-generated method stub
        System.out.print("gone");
    }
});
capture.startCapture();
capture.addDataListener(new DPFPDataListener() {

    @Override
    public void dataAcquired(DPFPDataEvent arg0) {
        // TODO Auto-generated method stub
        DPFPSample sample=DPFPGlobal.getSampleFactory().createSample();
        sample=arg0.getSample();    
        byte a[]=sample.serialize();
        for(byte i:a){
            System.out.print(i);
        }
    }
});
capture.addErrorListener(new DPFPErrorListener() {

    @Override
    public void exceptionCaught(DPFPErrorEvent arg0) {
        // TODO Auto-generated method stub
        System.out.println("error");
    }

    @Override
    public void errorOccured(DPFPErrorEvent arg0) {
        // TODO Auto-generated method stub
        System.out.println("error");

    }
});

}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T08:32:41.507

我目前也在研究数字角色指纹阅读器，我实际上遇到了同样的问题，但现在我已经克服了，我认为添加监听器的代码应该在 init() 方法中，并且在 init() 方法中启动 init 方法类的构造函数 main 方法应该只实例化类。

# javascript - 无法让 Tinymce 编辑 iframe 以使用 tabbifier

> ID：12917429
> 
> 赞同：1
> 
> 时间：2012-10-16T14:49:12.813
> 
> 标签：javascript, jquery, tabs, tinymce

我试图让 tinymce 编辑 iframe 与这个美妙的 tabbifier 一起工作：

[http://www.barelyfitz.com/projects/tabber](http://www.barelyfitz.com/projects/tabber)

我已经成功安装了它们，它们工作得很好。

在我的示例中，我测试了以下内容：

1.  加载一个 tinymce 组件并使用 HTML 选项将以下代码保存在 tinymce iframe 中：test
2.  用 F5 刷新后结果完美保存，并且此代码保存在数据库中：

> ```
> <p>test</p> 
> ```

tinymce 工作正常。

我所做的下一个测试是使用 tabber：

1.  编辑 tinymce 组件框并使用 HTML 选项保存以下代码：

> ```
> <div class='tabber' id='tabber1'>
>     <div class='tabbertab' title='FIRSTTAB' >
>         test firsttab
>     </div>
>     <div class='tabbertab' title='SECONDTAB' >
>         test secondtab
>     </div>
> </div> 
> ```

1.  代码完美地保存在数据库中，结果完美地加载到输出视图中，显示两个选项卡，每个选项卡都有其内容。

2.  问题是在尝试使用 tinymce 再次编辑内容时，未显示选项卡。内容完美加载到 tinymce iframe 中，没有标签。如下图所示：

    测试第一个标签

    测试第二个标签

它里面的 HTML 代码很好，它之前保存了正确的 tabbifier html 代码。

问题可能是 tinymce 的 iframe 无法加载或解释 tabber.js 的 javascript 并且它不显示选项卡。我已经测试了使用此代码在 tinymce iframe 中加载 tabber.js 的 javascript，并且似乎加载了它，但选项卡仍未显示：

```
<script type="text/javascript">
      tinyMCE.init({
        mode:                              "exact",
        elements:                          "%s",
        theme:                             "%s",
        %s
        %s
        theme_advanced_toolbar_location:   "top",
        theme_advanced_toolbar_align:      "left",
        theme_advanced_statusbar_location: "bottom",
        theme_advanced_resizing:           true
        %s
            setup : function(ed)
            {
                ed.onInit.add(function(ed, evt)
                {
                    alert("entered tiny");
                    // Load a script from a specific URL using the global script loader
                    //tinymce.ScriptLoader.load('/js/tabber/tabber.js');
                    // Load a script using a unique instance of the script loader
                    //var scriptLoader = new tinymce.dom.ScriptLoader();
                    //scriptLoader.load('C:\tabber.js');

                    // Load multiple scripts
                    var scriptLoader = new tinymce.dom.ScriptLoader();
                    scriptLoader.add('/js/tabber.js');
                    scriptLoader.loadQueue(function() { alert('All scripts are now loaded.'); });
                });
            }
      });
</script> 
```

我还检查了 /js/tabber.js 是正确的路径。并在萤火虫看到它正在加载它。显示了两条警报消息，因此它似乎正在加载它，但是仍然没有显示 tinymce 编辑 iframe 中的选项卡。

欢迎任何帮助，非常感谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-06-19T01:45:48.087

[tinymce ScriptLoader](http://www.tinymce.com/wiki.php/api4%3aclass.tinymce.dom.ScriptLoader)不会在iframe**中**加载脚本。它提供了一种在 tinymce 初始化后在**主窗口**中加载脚本的方法。由于没有记录，这非常令人困惑。

但是您绝对**可以**在 iframe 中加载脚本。这是魔术：

```
tinymce.init( { setup : function( ed ) {
    ed.on('init', function (args) {
        // get the iframe DOM
        var doc = args.target.contentDocument || args.target.contentWindow.document;

        // inject script into the DOM
        var s = doc.createElement('script');
        s.type = 'text/javascript';
        s.src = '/js/tabber.js';
        doc.getElementsByTagName('head')[0].appendChild(s);
    });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T15:02:28.213

一些浏览器在段落开始时存在空格和制表符问题。空间的一种解决方法是将它们在 onSave 编码为受保护的空间（如果它们位于开头）。选项卡的解决方案是使用具有类似行为的另一个字符并在保存时替换它们。从数据库重新加载到编辑器时，需要重新编码内容。

# entity-framework - 实体框架使用复合键 Azure SQL 设置标识值

> ID：12917431
> 
> 赞同：0
> 
> 时间：2012-10-16T14:49:25.827
> 
> 标签：entity-framework, entity-framework-migrations

我们最近将现有产品切换为使用实体框架代码优先迁移。过渡过程相当痛苦，但目前我们已经完成了几乎所有的过程。现在我们已经在我们的本地环境中工作了，我们已经将它推到了我们的部署环境中。不幸的是，我们的部署环境似乎不支持新的**EF**迁移。

我们的环境由两个服务器组成：一个 Web (.Net MVC3) 服务器和一个套接字服务器，它们都在 Windows Azure 中运行。问题似乎只发生在我们的套接字服务器中，实际上 Entity Framework 告诉我们数据库哈希不匹配（使用`context.Database.CompatibleWithModel()`）。

如果我们忽略 EF 告诉我们的 DB 模型与我们的代码模型不匹配的事实，那么我们遇到的唯一错误是插入带有**复合键**的实体对象。所有其他实体都可以正常创建。我们所有的实体类都派生自一个基类：

```
class BaseEntity {
    [HiddenInput(DisplayValue = false)]
    [Key, Column(Order = 0)]
    [DatabaseGenerated(DatabaseGeneratedOption.Identity)]
    public virtual long Id { get; set; }
} 
```

为了让 EF 支持复合键，我们必须添加“订单”部分。有问题的模型如下所示：

```
class SubEntity {
    [MaxLength(255)]
    [Required]
    [Key, Column(Order = 1)]
    public string Name { get; set; }
} 
```

当我们尝试将新`SubEntity`对象添加到上下文并保存更改时，我们会从 SQL 中得到一个错误，指出我们无法设置显式`Id`, 并使用`IDENTITY_INSERT ON`.

**该代码在我们的本地机器和我们的 Web 服务器上运行良好。DB 模型是兼容的，我们可以毫无问题地创建“子实体”对象。**

对我来说，在套接字服务器环境中，EF 似乎`[DatabaseGenerated]`在使用复合键时忽略了注释。这将解释错误，并解释为什么 DB 模型不兼容。这有意义吗？环境中是否存在会使 EF 表现不同的东西？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T20:03:56.477

在用我的头撞我的{桌子、墙壁、同事的拳头} 4 天后，我终于找到了解决问题的方法（尽管我不明白）。

同样，这只发生在我们在 Windows Azure 环境中运行服务器时（不会发生在我们的本地环境中），显然它只发生在我们的套接字服务器中运行时（ExitGames 的 Photon）。

由于某种原因，注释`[HiddenInput(DisplayValue = false)]`，它是一个 MVC 注释（因此不应该影响我们的 Photon 服务器）导致 EntityFramework 说该类`Id`不存在该属性`SubEntity`。

删除`HiddenInput`属性可以解决问题。所以，虽然它是“固定的”，但我仍然不明白为什么。

# javascript - 通过 javascript 更改边框宽度时 Chrome/Safari 的 CSS 布局问题

> ID：12917433
> 
> 赞同：1
> 
> 时间：2012-10-16T14:49:29.740
> 
> 标签：javascript, css, cross-browser

这是我在最近的项目中遇到的问题的一个示例：

[http://jsfiddle.net/ZCpAT/12/](http://jsfiddle.net/ZCpAT/12/)

请注意，在单击一个框并向其添加 .highlighted-node 类（修改边框宽度和边框颜色）后，框的内容如何在 chrome 和 safari 中向右移动一点，并且先前突出显示的框的内容发生了移动向左转。奇怪的是，当我尝试使用 Chrome 的开发工具触摸 2 个类中的任何一个样式时，所有 div 的内容都返回到它们的原始位置。

我是否在这里遗漏了一些东西以防止这种转变的行为发生？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-16T14:54:46.600

您可以更改填充以替换边框，而不是弄乱宽度和高度。

在 .node 中，边框为 1px，边距为 4px。在 .highlighted-node 中，边框是 5px，所以 padding 应该小 4px (=0px)。

[http://jsfiddle.net/ZCpAT/16/](http://jsfiddle.net/ZCpAT/16/)

或者，使用 15px/11px 的顶部填充：

[http://jsfiddle.net/ZCpAT/19/](http://jsfiddle.net/ZCpAT/19/)

解释为什么您的解决方案不起作用：

盒子的大小保持不变，因为您更改了宽度和高度，但盒子的内容完全不受盒子的宽度和高度的影响，因为它们是左（和顶部）对齐的。

内容的左侧位置 = 框边距 + 边框 + 内边距。所以在一种情况下是 10 + 1 + 5 = 16px，而在另一种情况下是 10 + 5 + 5 = 20px，向右（向下）移动 4px。

# java - 为 Junit 测试包装多行字符串

> ID：12917438
> 
> 赞同：5
> 
> 时间：2012-10-16T14:49:38.837
> 
> 标签：java, eclipse, junit

为了比较 JUnit 测试中的多行文本结果，我经常需要从文本表示转到使用多行文本初始化字符串的 Java 代码。

例如，如果测试应该检查包含以下内容的 xml 字符串：

```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<Customer>
    <id>100</id>
    <name>John Doe</name>
    <orders>
        <Order>
            <address>100 main street, smalltown, pa</address>
            <orderid>1100</orderid>
        </Order>
        <Order>
            <address>5 broadway, ny, ny</address>
            <orderid>1200</orderid>
        </Order>
    </orders>
</Customer> 
```

我想使用接受上述输入的工具/生成器并获得以下结果：

```
String expected ="";
    expected+="<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\n";
expected+="<Customer>\n";
expected+="    <id>100</id>\n";
expected+="    <name>John Doe</name>\n";
expected+="    <orders>\n";
expected+="        <Order>\n";
expected+="            <address>100 main street, smalltown, pa</address>\n";
expected+="            <orderid>1100</orderid>\n";
expected+="        </Order>\n";
expected+="        <Order>\n";
expected+="            <address>5 broadway, ny, ny</address>\n";
expected+="            <orderid>1200</orderid>\n";
expected+="        </Order>\n";
expected+="    </orders>\n";
expected+="</Customer>\n"; 
```

和/或

```
 // Create test file
    java.io.PrintWriter srcWriter = new java.io.PrintWriter(new java.io.FileOutputStream(testFile));
    srcWriter.println("<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\n");
    srcWriter.println("<Customer>\n");
    srcWriter.println("    <id>100</id>\n");
    srcWriter.println("    <name>John Doe</name>\n");
    srcWriter.println("    <orders>\n");
    srcWriter.println("        <Order>\n");
    srcWriter.println("            <address>100 main street, smalltown, pa</address>\n");
    srcWriter.println("            <orderid>1100</orderid>\n");
    srcWriter.println("        </Order>\n");
    srcWriter.println("        <Order>\n");
    srcWriter.println("            <address>5 broadway, ny, ny</address>\n");
    srcWriter.println("            <orderid>1200</orderid>\n");
    srcWriter.println("        </Order>\n");
    srcWriter.println("    </orders>\n");
    srcWriter.println("</Customer>\n");
    srcWriter.close();
    // PrintWriter never throws Exceptions, one must check the error state manually
    //
    if (srcWriter.checkError())
    {
        throw new IOException( "can not write " + testFile );
    } 
```

**什么是开发工具/eclipse实用程序或插件来实现这一点？**

*   从文件中获取多行输入文本（在 IDE 或命令行中）
*   转义引号和反斜杠
*   转换为初始化字符串文字和/或将在 Java 代码中创建文件而不需要额外的文件资源的 Java 代码
*   将结果输出到新文件和/或控制台或直接输出到编辑器以在编译时使用

输出文件（如果有）不应与编译结果一起提供。在文件模式下，输入文件的等效项应该从 java 代码中的字符串文字重新创建。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-16T15:16:13.877

假设您正在从另一个源复制多行文本，并且您正在使用 Eclipse，它可以自动将您的文本转换为多行字符串文字。

在我的版本中，在 Windows -> Preferences -> Java -> Editor -> Typing -> Escape text when paste into a String literal 下启用它

然后如果你输入

```
String expected = " 
```

并复制一些文字，例如

```
blah
blah
blah
blah
blah 
```

然后粘贴您的字符串，Eclipse 创建：

```
 String expected = "blah\n" + 
 "blah\n" + 
 "blah\n" + 
 "blah\n" + 
 "blah" 
```

我个人认为如果 Java 有一个与 Perl 的 HERE 文档等效的多行文档会很好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-16T15:22:02.653

为什么不将您的 XML 存储在单独的文件中并使用 Apache Commons 将其读入字符串？

```
String fileName = "path/to/your/file";
String fileText = FileUtils.readFileToString(new File(fileName)); 
```

有关 FileUtils，请参阅此内容 - [https://commons.apache.org/io/api-release/org/apache/commons/io/FileUtils.html](https://commons.apache.org/io/api-release/org/apache/commons/io/FileUtils.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-16T15:40:35.333

在我看来，这似乎是一个失败。基本上，您想针对带有操作系统特定换行符的漂亮打印的 XML 进行测试。

您不能简单地编写一些简单的访问者模式，跨越生成的和预期的 XML 来验证一切是否符合预期吗？通过这种方式，您还可以避免预期和生成的 XML 无效的问题。

此外，想象一下命名空间声明是否按顺序更改或属性按顺序更改：XML 在语义上是等价的，但在语法上是不同的。这个应该怎么处理？这是一次失败的测试吗？在我看来，这是通行证。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-17T07:31:24.657

对于非 Eclipse 用户，以下脚本解决方案可能会有所帮助：

```
#!/bin/bash
#
#   Copyright (C) 2012 BITPlan GmbH (http://www.bitplan.com)
# 
#   Author: Wolfgang Fahl
#
#
#   Licensed under the Apache License, Version 2.0 (the "License");
#   you may not use this file except in compliance with the License.
#   You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
#   Unless required by applicable law or agreed to in writing, software
#   distributed under the License is distributed on an "AS IS" BASIS,
#   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
#   See the License for the specific language governing permissions and
#   limitations under the License.

#
# wrap code for use in JUnit Test cases
#
wrapJUnit() {
  file=$1
  mode=$2
  echo "wrapping $file with mode $mode"
  cat $file | gawk -v mode="$mode" '

# check mode and add header if mode is file
BEGIN {
  if (mode=="file") {
        print " // Create test file"
        print " java.io.PrintWriter srcWriter = new java.io.PrintWriter(new java.io.FileOutputStream(testFile));"
    }   
}
# work on each line
{
    line=$0
    # replace a single \ with \\
    gsub("\\","\\\\",line)
    # replace a quote with \ quote
    gsub("\"","\\\"",line)
    # output the modified line
    if (mode=="file") {
        print " srcWriter.println(\"" line "\\n\");"
    } else {
        if (more++) {
            print " expected+=\"" line "\\n\";" 
        } else {
            print " expected =\"" line "\\n\";" 
        }   
    }   
}

END {
  if (mode=="file") {
        print " srcWriter.close();"
        print " // PrintWriter never throws Exceptions, one must check the error state manually"
        print " //"
        print " if (srcWriter.checkError())"
        print " {"
        print "     throw new IOException( \"can not write \" + testFile );"
        print " }   "
    }
}

' > $1.wrap
cat $1.wrap
}

#
#
# show usage
# 
usage() {
    echo "usage: wrapcode inputfile [simple]"
    echo "  will take the text and prepare it for JUnit usage as a string";
    exit 1
}

#
# check number of command line parameters
#
if [ $# -lt 1 ]
then
  usage
fi

file=$1

if [ $# -lt 2 ]
then
  wrapJUnit $file file
else
  wrapJUnit $file string
fi 
```

# ole - 如何在 C++Builder XE 中使用 Procedure.Exec

> ID：12917442
> 
> 赞同：0
> 
> 时间：2012-10-16T14:49:44.967
> 
> 标签：ole, procedure, c++builder-xe

我有一段代码如下所示，在 C++Builder-6 上运行良好。

现在我已将程序移至 C++Builder-XE 并调用“RiconfiguraNodo << nomeNodo ....”给我下面的模糊错误报告。

我尝试了几种方法来重写对 ole 过程“RiconfiguraNodo”的调用，但我没有找到可行的解决方案。

如何以适合 C++BuilderXE 的方式重写这段代码

**报错：**

```
 [BCC32 Error] UnitMain.cpp(262): E2015 Ambiguity between 'operator
 System::AutoCmd::<<(const System::Currency) at c:\program files
 (x86)\embarcadero\rad studio\8.0\include\windows\rtl\sysvari.h:3561'
 and 'operator System::AutoCmd::<<(const System::TDateTime) 
 at  c:\program files (x86)\embarcadero\rad
 studio\8.0\include\windows\rtl\sysvari.h:3562'   

 Full parser context
     UnitMain.cpp(245): parsing: void _fastcall TFormMain::RiconfiguraNodo(System::UnicodeString,System::UnicodeString,System::UnicodeString,System::UnicodeString) 
```

**示例代码：**

```
Procedure RiconfiguraNodo( L"RiconfiguraNodo" );

if (VarServerPmvManager.IsEmpty() || VarServerPmvManager.IsNull())
{
    VarServerPmvManager = VarServerPmvManager.CreateObject(ProgId_ServerPmvmanager);
}

try
{
    VarServerPmvManager.Exec( RiconfiguraNodo << nomeNodo << ipAddress << tipoPmv << cmdType );
}
catch (Exception & ex)
{
    Mylog(Fun + Sysutils::Format("ERROR=[%s] ", ARRAYOFCONST((ex.Message))));
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T15:10:52.930

我找到了解决方案。过程 exec 只需要 Variant 而不是纯字符串

```
 Variant vNomeNodo, vIpAddress, vTipoPmv, vCmdType;

            vNomeNodo   = nomeNodo;
            vIpAddress  = ipAddress;
            vTipoPmv    = tipoPmv;
            vCmdType    = cmdType;

VarServerPmvManager.Exec( RiconfiguraNodo << vNomeNodo << vIpAddress << vTipoPmv << vCmdType ); 
```

# coldfusion - Coldfusion：如何使用 cfthrow 转储参数范围？

> ID：12917444
> 
> 赞同：3
> 
> 时间：2012-10-16T14:49:47.793
> 
> 标签：coldfusion

提交表单后，我正在调用一个控制器方法，该方法在我的 cfc 中运行一个 orm EntitySave。我想在通过 ORM 保存数据之前转储参数，以直观地验证这些确实是我想要保存在数据库中的值。所以当我使用这个

```
<cfthrow message="value = #arguments#"> 
```

我得到这个：

```
Error: Complex object types cannot be converted to simple values. 
```

我了解您不允许对复杂对象执行此操作，因此在这些情况下我会使用`<cfdump>`但我找不到将`<cfthrow>`. 我确信有更好的方法来实现这一点。我也尝试过`<cfmail>`对自己做一个效果惊人的电子邮件，但电子邮件需要一两分钟。任何建议将不胜感激。我目前正在检查 ValidateThis。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-10-16T15:02:32.827

你可以序列化它：

```
<cfthrow message="value = #serializeJson(arguments)#"> 
```

但我认为你不希望那种东西出现在屏幕上。

如果我是你，我会记录它（所以同样的概念，就在 ,`<cflog>`之前`<cfthrow>`，并将参数放在日志条目中，并且`<cfthrow>`只是简单地解释错误（你还应该使用 TYPE 属性，用于后续处理您提出的异常。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-16T15:06:40.013

您可以尝试将其转储到文件中，看看是否满足您的需求，而不是扔掉它：

```
<cfdump var="#arguments#" output="C:\dump.html" format="html"> 
```

如果您需要中止（就像 throw 一样），您可以将 abort 添加到标签的末尾，`<cfdump... abort>`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-18T14:54:17.230

您可以执行以下操作以使用`<cfdump>`：

```
<cfsavecontent variable="arguments_dump">
    <cfdump var="#arguments#" />
</cfsavecontent>
<cfthrow message="#arguments_dump#" /> 
```

然而，需要更多的代码，并且不如上面亚当卡梅隆的回答那么优雅。

# c# - 使用生产者消费者实现批处理

> ID：12917450
> 
> 赞同：1
> 
> 时间：2012-10-16T14:49:56.500
> 
> 标签：c#, .net, task-parallel-library, producer-consumer

批

1.  从文件或 SQL 中读取文本
2.  将文本解析为单词
3.  将单词加载到 SQL 中

今天
.NET 4.0
Step 1 非常快。对于相同大小的文件，步骤 2 和 3 的长度大致相同（平均 0.1 秒）。
在第 3 步中，使用 BackGroundWorker 插入并等待最后一个完成。
其他一切都在主线程上。

在大负载上将执行数百万次。

需要步骤 3 是连续的，并且与 1 的顺序相同。
这是为了防止 SQL 表 PK 索引破裂。
并行尝试第 3 步并破坏索引将其杀死。
该数据由 PK 排序馈送。
其他索引在加载开始时被删除，然后在加载结束时重建。

当文本大小发生变化时，此过程无效。
文件之间的文本大小确实发生了巨大变化。
我想要的是让 1 和 2 排队，以便 3 尽可能保持忙碌。

需要步骤 3 将文件出列，以便它们在 1 中排队（即使它等待）。

需要内存管理的最大队列大小（如 4-10）。

希望第 2 步与最多 4 个并发并行。

迁移到 .NET 4.5。

**要求有关如何实施此操作的一般指导？**

我正在学习这是一种生产者消费者模式。
如果这不是生产者消费者模式，请告诉我，以便我更改标题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T18:00:41.540

我认为 TPL Dataflow 将是做到这一点的好方法：

对于第 2 步，您将使用`TransformBlock`设置`MaxDegreeOfParallelism`为 4 并`BoundedCapacity`设置为 4 的 a，以便其队列在工作时为空。它会按照它们进来的顺序生产物品，你不必为此做任何特别的事情。对于第 3 步，使用`ActionBlock`, 并`BoundedCapacity`设置为您的限制。然后将两者链接在一起并开始向 发送项目`TransformBlock`，理想情况下使用类似的东西`await stepTwoBlock.SendAsync(…)`，如果队列已满，则异步等待。

在代码中，它看起来像：

```
async Task ProcessData()
{
    var stepTwoBlock = new TransformBlock<OriginalText, ParsedText>(
        text => Parse(text),
        new ExecutionDataflowBlockOptions
        {
            MaxDegreeOfParallelism = 4,
            BoundedCapacity = 4
        });
    var stepThreeBlock = new ActionBlock<ParsedText>(
        text => LoadIntoDatabase(text),
        new ExecutionDataflowBlockOptions { BoundedCapacity = 10 });
    stepTwoBlock.LinkTo(
        stepThreeBlock, new DataflowLinkOptions { PropagateCompletion = true });

    // this is step one:
    foreach (var id in IdsToProcess)
    {
        OriginalText text = ReadText(id);
        await stepTwoBlock.SendAsync(text);
    }

    stepTwoBlock.Complete();
    await stepThreeBlock.Completion;
} 
```

# html - Joomla 和（非默认）职位

> ID：12917451
> 
> 赞同：0
> 
> 时间：2012-10-16T14:50:05.390
> 
> 标签：html, css, joomla, web

我正在尝试将我的简单网站转移到 joomla。我喜欢我在 html5/css3 中所做的设计和风格，但我认为内容管理是我可以利用的。我有我的设计，所以我决定试一试模板。

我了解您在 templateDetails.xml 上如何定义位置：

```
<positions>
    <position>breadcrumb</position>
    <position>right</position>
    <position>top</position>
    <position>footer</position>
</positions> 
```

但我不明白如何创建新职位。例如，如果我想在主要内容的右下角创建一个位置，或者更具体地说，这些信息应该放在哪里？我看到这是默认位置[http://docs.joomla.org/Module_Map](http://docs.joomla.org/Module_Map)。

我现在的想法是用我已经拥有的所有 div 标签做我的模板，但只是删除内容，然后在内容中创建一个我放置的 div 标签

```
<div id="content" class="float"> <jdoc:include type="component" /></div> 
```

但是我不认为我真的在利用 joomla。

或者有什么更好的方法可以将 html/css3 网站移动到 joomla 而无需使用模板（我没有 100% 喜欢）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T15:06:11.080

如果我理解您的问题`<jdoc:include type="modules" name="bottom_right" style="xhtml" />`，您可以将位置添加到模板的 index.php 中。然后你可以在后端分配一个模块。不要忘记添加`<position>bottom_right</position>`到模板的 XML 中。

如果您需要澄清任何事情，请在此处提出您的问题

# android - 线性布局内的嵌套布局（垂直） - 确保最后一个嵌套布局显示其内容

> ID：12917454
> 
> 赞同：0
> 
> 时间：2012-10-16T14:50:16.610
> 
> 标签：android, android-layout

我有一个线性布局（垂直方向），其中包含两个嵌套的线性布局。

*   第一个线性布局具有基于特定活动的上下文动态应用的背景图像。图像几乎占据了整个屏幕的大小
*   第二个线性布局包含两个复选框（水平方向），应该显示在活动的底部。

我的问题是，如何确保第二个线性布局显示在屏幕底部，并且只显示它需要的最少数量，让第一个线性布局尽可能多地显示其背景图像？目前它正在被第一个 LL 的 bg 图像推离屏幕。

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T15:17:11.537

您可以使用*RelativeLayout*作为外部布局，而不是*LinearLayout*

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/mainLayout"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent">

    <LinearLayout
         android:id="@+id/bottomLayout"
         android:layout_alignParentBottom="true"
         android:layout_centerHorizontal="true"
         android:layout_width="fill_parent"
         android:layout_height="wrap_content">
        ...
    </LinearLayout>

    <LinearLayout
         android:id="@+id/topLayout"
         android:layout_above="@id/bottomLayout"
         android:layout_centerHorizontal="true"
         android:layout_width="fill_parent"
         android:layout_height="fill_parent">
        ...
    </LinearLayout>

</RelativeLayout> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-16T14:55:13.687

使用权重你可以做你想做的事：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" >

    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:orientation="horizontal" 
        android:background="#FF0000"
        android:layout_weight="1"
        >

    </LinearLayout>

    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="wrap_content" 
        android:orientation="horizontal"
        android:background="#00FF00"
        android:layout_weight="1"
        >
        <CheckBox
            android:id="@+id/checkBox1"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="CheckBox" />
        <CheckBox
            android:id="@+id/checkBox2"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="CheckBox" />
    </LinearLayout>

</LinearLayout> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-16T15:00:02.640

```
<LinearLayout
    ... >
    <LinearLayout
        ...
        android:layout_height="0dp"
        android:layout_weight="1"
        >
        ...
    </LinearLayout>
    <LinearLayout
        ...
        android:layout_height="wrap_content"
        >
        ...
    </LinearLayout>
</LinearLayout> 
```

注意加权布局，高度设置为“0dp”。只有一个加权，加权的将拉伸以适应其余可用区域。

# json - 推荐工作时间 JSON 格式

> ID：12917456
> 
> 赞同：12
> 
> 时间：2012-10-16T14:50:21.987
> 
> 标签：json, format

我想知道以 JSON 格式表达代理机构工作时间的最佳方式是什么。假设该机构每周工作 5 天（不一定是星期一到星期五），每天工作两班（同样，不一定）：从上午 9 点到下午 1 点，从下午 2 点到下午 6 点。提前致谢！

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-10-16T15:12:22.837

```
{ "Hours" : 
    [ 
    { "Monday": 
        [
            { "Start": "0900", "Finish": "1300" },
            { "Start": "1400", "Finish": "1800" }
        ]
    },
    { "Tuesday":
        [
            { "Start": "0900", "Finish": "1300" },
            { "Start": "1400", "Finish": "1800" }
        ]
    },
    { "Wednesday":
        [
            { "Start": "0900", "Finish": "1300" },
            { "Start": "1400", "Finish": "1800" }
        ]
    },
    { "Thursday":
        [
            { "Start": "0900", "Finish": "1300" },
            { "Start": "1400", "Finish": "1800" }
        ]
    },
    { "Friday":
        [
            { "Start": "0900", "Finish": "1300" },
            { "Start": "1400", "Finish": "1800" }
        ]
    },
    { "Saturday":
        []
    },
    { "Sunday":
        []
    }
]
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2016-04-27T07:16:22.580

以下是 Facebook 如何节省地点时间

```
"hours": {
    "mon_1_open": "12:00",
    "mon_1_close": "20:30",
    "tue_1_open": "12:00",
    "tue_1_close": "20:30",
    "wed_1_open": "12:00",
    "wed_1_close": "20:30",
    "thu_1_open": "12:00",
    "thu_1_close": "20:30",
    "fri_1_open": "12:00",
    "fri_1_close": "20:30",
    "sat_1_open": "12:00",
    "sat_1_close": "20:30",
    "sun_1_open": "12:00",
    "sun_1_close": "20:30"
  }, 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-16T15:11:00.407

代表时间范围的哈希数组应该可以工作。每个都可以包括打开和关闭的日期和时间。我在这里只是用一个数字表示时间，从午夜开始的几个小时；根据您的需要，时间戳可能会更好。我选择写出日期名称，而不是使用数字，以避免混淆您是 0 索引还是 1 索引，以及您是从星期日还是星期一开始计数。

```
[{"open": {"day": "monday",
           "time": 9},
  "close": {"day": "monday",
            "time": 13}},
 {"open": {"day": "monday",
           "time": 14},
          {"day": "monday",
           "time": 18}},
 ...] 
```

您希望在时间范围的两端都包含这一天，这样您就可以拥有跨越午夜的时间（虽然您现在可能没有预料到，但您可能会遇到有人在午夜后开门的情况，或者可能会遇到您想要报告世界各地某人的当地时间开放时间的情况）。除此之外，这应该是不言自明的。

# 64-bit - FASM - IsWow64Process - 检查布尔结果

> ID：12917460
> 
> 赞同：1
> 
> 时间：2012-10-16T14:50:38.350
> 
> 标签：64-bit, boolean, 32bit-64bit, 32-bit, fasm

我正在尝试确定运行我的应用程序的 PC 是 x64 还是 x86。

这是我当前的代码：

```
format PE GUI 4.0
include "Win32A.Inc"

entry start

section ".idata" import data readable writable

        library kernel32,"KERNEL32.DLL",user32,"USER32.DLL"

        import  kernel32,\
                IsWow64Process,"IsWow64Process",\
                GetCurrentProcess,"GetCurrentProcess",\
                ExitProcess,"ExitProcess"

        import  user32,\
                MessageBox,"MessageBoxA"

section '.data' data readable writeable

hProcess        dd ?
hResult         dd ?

section '.code' code readable executable

start:

        invoke     GetCurrentProcess
        mov        [hProcess],eax
        invoke     IsWow64Process,hProcess,hResult
        cmp        [hResult],1
        je         Is64
        cmp        [hResult],0
        je         Is32
        invoke     ExitProcess,0

Is64:

            invoke       MessageBox,0,'64','AR',0
            invoke       ExitProcess,0
Is32:

            invoke       MessageBox,0,'32','AR',0
            invoke       ExitProcess,0 
```

它只是在执行时崩溃。

检查布尔值的正确方法是什么，我是否正确执行了该部分？

感谢您为解决此问题提供的任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T15:01:46.227

为了能够声明内联字符串，您需要包含扩展标头：

```
include "Win32AX.Inc" 
```

否则 '64' 等将被解释为常量。

您也没有将 hProcess 作为值传递：

```
invoke     IsWow64Process,[hProcess],hResult 
```

# javascript - 根据无线电输入验证输入

> ID：12917461
> 
> 赞同：0
> 
> 时间：2012-10-16T14:50:39.183
> 
> 标签：javascript, input, validation

有没有办法根据单选按钮选择来验证字段文本输入？我正在尝试根据身份是男性还是女性的无线电选择来验证用户对 Title 字段的输入。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T15:03:51.567

您可以使用`<input type="radio" onchange="myFunction()">`和设置 JS 中的函数来提交您的表单：

```
var myFunction = function(){
     document.forms["myform"].submit();
} 
```

JQuery 中有 onchange 函数：http: [//api.jquery.com/change/](http://api.jquery.com/change/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T14:57:16.640

创建两个具有相同名称属性的单选按钮。并读取所选单选按钮的值

```
var radio= document.getElementsByName('radioname');
var val;
for(var k =0; k< radio.length; k++){
 if(radio[k].checked){
     val = radio[k].val;
    break;
   }
}
var text = document.getElementById('textfield');
if(val == 'male'){
   validateMale(text);
}
else{
 validateFemale(text);
}
function validateMale(text){
 // validation code
}
function validateFemale(text){
// validation code
} 
```

# model-view-controller - 从 Sencha Touch 2 上的 Controller 引用在构造函数中创建的按钮？

> ID：12917465
> 
> 赞同：0
> 
> 时间：2012-10-16T14:50:55.623
> 
> 标签：model-view-controller, constructor, sencha-touch-2

我一直在研究如何在 Sencha Touch 上使用 MVC 引用按钮的方法，但是由于我在视图的构造函数上声明了所有控件，因此没有一篇文章对我有用。

这是我的代码示例：

```
Ext.define('TPTMOBILE.view.Login',{
    extend: 'Ext.Panel',
    ...
    config: {
        ...
    },

    constructor: function(){
        var submitButton = Ext.create('Ext.Button', {
            text: 'Login'
        });
    }

}); 
```

所以我想知道如何引用我的“submiButton”按钮的 onTap 方法。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T15:33:40.780

您的构造方法将不起作用，请尝试以下方法：

```
constructor: function(config){
    this.callParent(config);
    this.add(
        {
            xtype: "button",
            text: 'Login',
            action: 'doTap'
        }
    );
} 
```

您的`constructor`方法必须包含一个调用`callParent`，以便将配置对象传递给父构造函数，否则它将不起作用。

之后，您有几种方法可以`onTap`在按钮上实现您的方法，但是由于您想在 Sencha Touch 上使用 MVC，因此您可以为按钮设置操作

```
action: 'doTap' 
```

然后在您的控制器中，您可以在点击该按钮时执行以下操作来运行您的代码：

```
refs: {
    doTap: 'button[action=doTap]'
},

control: {
    doTap: {
        tap: 'doTap'
    },
},

doTap: function() {
    alert('doTap function activvated');
} 
```

希望能帮助到你 ：）

# jquery - 使用 jQuery 在输入中进行表单验证

> ID：12917466
> 
> 赞同：0
> 
> 时间：2012-10-16T14:50:56.140
> 
> 标签：jquery, forms

我正在尝试验证一个表单，但没有标签，所有消息都在同一个输入中。

我有可以按我想要的方式工作的 html，但是对于 jQuery，我遇到了 elseif 和 else 的问题。

我想说：
-如果输入名称仍然是名称，则缺少消息名称（这似乎可行）
-如果输入地址仍然是地址，则缺少消息地址（不起作用）
-如果输入地址和输入的名称不是地址或名称提交表单（它不起作用）

我在这里有一个例子：http: [//jsfiddle.net/4ervc/20/](http://jsfiddle.net/4ervc/20/)

HTML：

```
<form id="form" action="#">
    <input type="text" name="name" id="name" value="name" 
    onfocus="if (this.value=='name'||'name is missing') this.value = '';" 
    onblur="if (this.value=='') this.value = 'name';"  />
    <br />

    <input type="text" name="address" id="address" value="address" 
    onfocus="if (this.value=='address'||'address is missing') this.value = '';" 
    onblur="if (this.value=='') this.value = 'address';"  />
    <br />

    <input type="submit" name="submit" id="submit">
</form> 
```

查询：

```
$(function(){

    $("#form").submit(function (e) {

        if ($('#name').val("name")) {
            e.preventDefault();
            $('#name').val("name is missing");
        }else if ($('#address').val("address")) {
            e.preventDefault();
            $('#address').val("address is missing");
        }else{
             $("#form").submit;
        }

    });

}) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T14:55:02.113

您正在设置一个值“名称”

尝试使用这个：

> $('#name').val() == "name"

如果语句在你里面

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T14:59:20.097

您的原始代码存在一些问题：

1.  您的提交调用`$("#form").submit;`不正确，应该是`$("#form").submit();`
2.  因为您使用的是 if-elseif 逻辑，所以您的验证仅在名称字段正确时才验证地址字段。它应该每次都验证所有字段。
3.  您应该使用比较字段值`$('#name').val() === 'name'`，而不是`$('#name').val('name')`

下面通过使用一个简单的标志来解决这些问题，并分别检查每个字段。提交调用也已修复。

**试试这个：http: [//jsfiddle.net/4ervc/21/](http://jsfiddle.net/4ervc/21/)**

```
$(function() {

    $("#form").submit(function(e) {

        //assume valid form
        var valid = true;
        if ($('#name').val() === 'name') {
            e.preventDefault();
            $('#name').val('name is missing');
            valid = false;
        }

        if ($('#address').val() === 'address') {
            e.preventDefault();
            $('#address').val('address is missing');
            valid = false;
        }

        if (valid) {
            $('#form').submit();
        }

    });
}); 
```

此外 - 只是关于代码气味的说明 - 您应该尝试在脚本中始终使用单引号或双引号。您已经使用了两者都不理想（但会起作用）。

# javascript - 如何验证使用 JSON 读取的表单数据？

> ID：12917468
> 
> 赞同：1
> 
> 时间：2012-10-16T14:51:02.007
> 
> 标签：javascript, jquery, json, forms

我正在创建一个基于 JSON 数据的表单向导。我已经创建了一个基于 JSON 提要的表单，并且工作正常，接下来是如何将 jquery validation.js 合并到我的代码中。

我在这里使用 jquery.dfrom 生成基于 JSON 示例的表单 [https://github.com/daffl/jquery.dform](https://github.com/daffl/jquery.dform)

接下来，我想在提交之前验证为用户输入生成的表单。

我如何验证这个生成的 html 表单？谢谢

```
 <!DOCTYPE html>
    <html>
    <head>
        <meta http-equiv="content-type" content="text/html; charset=UTF-8">
        <title>JSOn based form wizard jQuery dForm</title>
    </head>
    <style type="text/css">
        input, label {
            display: block;
            margin-bottom: 5px;
        }
    </style>
    <body>

    <form id="demo-2-form"></form>

    <!-- Load jQuery and the minified plugin -->
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
  <script type="text/javascript" src="dist/jquery.validate.js"></script>
    <script type="text/javascript" src="dist/jquery.dform-1.0.1.js"></script>

    <script type="text/javascript" class="demo" id="demo-2">
    $('#demo-2-form').dform({
        "action":"index.html",
        "method":"post",
        "html":[
            {
                "type":"fieldset",
                "caption":"User information",
                "html":[
                    {
                        "name":"email",
                        "caption":"Email address",
                        "type":"text",
                        "placeholder":"E.g. user@example.com",
                        "validate":{
                            "email":true
                        }
                    },
                    {
                        "name":"password",
                        "caption":"Password",
                        "type":"password",
                        "id":"registration-password",
                        "validate":{
                            "required":true,
                            "minlength":5,
                            "messages":{
                                "required":"Please enter a password",
                                "minlength":"At least {0} characters long"
                            }
                        }
                    },
                    {
                        "name":"password-repeat",
                        "caption":"Repeat password",
                        "type":"password",
                        "validate":{
                            "equalTo":"#registration-password",
                            "messages":{
                                "equalTo":"Please repeat your password"
                            }
                        }
                    },
                    {
                        "type":"radiobuttons",
                        "caption":"Sex",
                        "name":"sex",
                        "class":"labellist",
                        "options":{
                            "f":"Female",
                            "m":"Male"
                        }
                    },
                    {
                        "type":"checkboxes",
                        "name":"test",
                        "caption":"Receive newsletter about",
                        "class":"labellist",
                        "options":{
                            "updates":"Product updates",
                            "errors":{
                                "value":"security",
                                "caption":"Security warnings",
                                "checked":"checked"
                            }
                        }
                    }
                ]
            },
            {
                "type":"fieldset",
                "caption":"Address information",
                "html":[
                    {
                        "name":"name",
                        "caption":"Your name",
                        "type":"text",
                        "placeholder":"E.g. John Doe"
                    },
                    {
                        "name":"address",
                        "caption":"Address",
                        "type":"text",
                        "validate":{ "required":true }
                    },
                    {
                        "name":"zip",
                        "caption":"ZIP code",
                        "type":"text",
                        "size":5,
                        "validate":{ "required":true }
                    },
                    {
                        "name":"city",
                        "caption":"City",
                        "type":"text",
                        "validate":{ "required":true }
                    },
                    {
                        "type":"select",
                        "name":"continent",
                        "caption":"Choose a continent",
                        "options":{
                            "america":"America",
                            "europe":{
                                "selected":"true",
                                "id":"europe-option",
                                "value":"europe",
                                "html":"Europe"
                            },
                            "asia":"Asia",
                            "africa":"Africa",
                            "australia":"Australia"
                        }
                    }
                ]
            },
            {
                "type":"submit",
                "value":"Signup"
            }
        ]
    });
    </script>
    </body>
    </html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T15:15:54.247

我假设您指的是[这个插件](https://github.com/jzaefferer/jquery-validation)进行验证，在这种情况下，您需要向表单添加类以告诉它您需要哪种类型的验证。从您的代码示例看来，这不是您所追求的确切库，但就实现而言它应该是相似的。将来，请务必指定这些内容 - 此类细节非常重要。

dform 插件没有*内置*回调，因此您无法确切知道表单何时出现在页面上。这意味着任何立即在表单上运行的验证插件都将难以实现，因为缺少回调。另一方面，如果您正在使用一个验证插件，该插件仅通过将提交处理程序附加到表单来工作，它应该通过调用它而不对代码进行额外更改来工作，正如 Kevin B 在第一条评论中建议的那样.

无论哪种方式，只要您在提交表单后以编程方式运行验证插件，就可以了。您应该能够为任何体面的插件执行此操作 - 我在上面链接到的 jquery 验证确实具有此功能（尽管它并不能很好地完成工作）。你会像这样运行它：

```
$('#demo-2-form').on('submit', function(e){
  e.preventDefault();
  if ($(this).validate().form()) {
    $(this).submit();
  } else {
    console.log("fill your form out right man!");
  }
}); 
```

这将根据您设置的参数验证表单，但是对于这个特定的插件并没有给您返回很多有用的信息来标记错误的位置。您可以使用其他方法来执行此操作（对于此插件，您必须遍历每个字段以检查是否有错误），但我认为这不值得在这里写出来。

真的，我还没有遇到一个好的 javascript 验证库（我的同事也没有）。在这里捕获提交并自己编写验证可能是值得的 - 这样会更清楚，您可以按照自己的方式自定义它。此外，这些验证中的每一个都可以写在一行左右的 javascript 中。这通常是我最终要做的事情，而且几乎不需要更多时间。您可以使用与上面相同的方法来捕获提交，只需将 jquery validate plugin 行替换为检查您的字段并验证它们的几行。

# sql - 将 SQL NULL 绑定到 ASP.NET 控件的正确方法？

> ID：12917469
> 
> 赞同：0
> 
> 时间：2012-10-16T14:51:04.513
> 
> 标签：sql, asp-classic, null, bind

我有一个绑定到 SQL 结果的 ASP.NET 控件：

```
<asp:GridView ID="EmployeeSearchResults" runat="server" AutoGenerateColumns="False" >
  <Columns>
    <asp:TemplateField HeaderText="Status" SortExpression="Status">
      <ItemTemplate>
        <asp:Label ID="Label1" runat="server" Text='<%# (EmployeeSearchStatus(Eval("SeparationDate"),Eval("PositionTitle"),Eval("EffectiveDate"))) %>'></asp:Label>
      </ItemTemplate>
    </asp:TemplateField>                                                
  </Columns>
</asp:GridView> 
```

我的 EmployeeSearchStatus 函数非常基础，测试传入的值是否为 NULL，并创建一个字符串来显示：

```
Public Function EmployeeSearchStatus(ByVal SeparationDate As Object, ByVal PositionTitle As Object, ByVal EffectiveDate As Object) As String
  Dim ReturnString As String = ""
    If IsDBNull(SeparationDate) Then
      ReturnString = "Currently Employed as "
    Else
      ReturnString = "Last Employed as "
    End If
    ReturnString += PositionTitle
    If IsDBNull(SeparationDate) Then
        ReturnString += " (effective " + EffectiveDate + ")."
    Else
        ReturnString += " (separated on " + SeparationDate + ")."
    End If
    Return ReturnString
End Function 
```

这是处理从 SQL 返回到 ASP.NET 控件的 NULL 值的正确方法吗？有没有更好的技术？

谢谢，

罗素

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T14:57:42.983

您的代码看起来不错，但如果您愿意，可以稍微简化一下：

```
Public Function EmployeeSearchStatus(ByVal SeparationDate As Object, ByVal PositionTitle As Object, ByVal EffectiveDate As Object) As String
    If IsDBNull(SeparationDate) Then
        Return "Currently Employed as " + PositionTitle + " (effective " + EffectiveDate + ")."
    Else
        Return "Last Employed as " + PositionTitle + " (separated on " + SeparationDate + ")."
    End If
End Function 
```

但是，该代码确实假设`PositionTitle`并且`EffectiveDate`永远不会是`null`. 如果这在数据库中没有强制执行，您可以在代码中添加一些检查来处理这些情况。

# android - android如何跨片段分离/附加保留视图状态

> ID：12917471
> 
> 赞同：2
> 
> 时间：2012-10-16T14:51:09.880
> 
> 标签：android, tabs, state, fragment

我有一个选项卡主机控件，它使用片段加载选项卡。

每次切换选项卡时，它都会分离旧片段并附加新片段。

我注意到在此过程中调用了 OnCreateView 方法，并且我的很多状态都丢失了，因为它每次都重新创建视图。但是，我注意到某些视图状态（例如编辑文本的值）在分离/附加时保持不变。

我想知道当视图被完全销毁并重新创建为新视图时，Android 如何自动恢复状态。当我只是切换选项卡时，Bundle savedInstanceState 的值始终为 null。Bundle savedInstanceState 仅在我执行旋转屏幕之类的操作时才会填充。

据我所知，这种状态恢复发生在片段 onStart 方法被调用之前。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-05T22:20:09.140

当附加和分离片段时，只有视图被销毁，片段实例保持不变。

片段管理器恢复具有 id 的视图的状态，且 savedInstanceState 为空。

在旋转的情况下，片段可能由您在其他地方重新创建（在活动的 onCreate() 中？）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T14:58:54.620

当一个片段即将从窗口中移除（或替换）时，它的[onSaveInstanceState(Bundle)](http://developer.android.com/reference/android/app/Fragment.html#onSaveInstanceState(android.os.Bundle))（或 onRestoreInstanceState(Bundle)）方法会被调用。这将通过片段层次结构传播，恢复其先前的状态。

# jquery - 在阿拉伯语文本中选择括号

> ID：12917472
> 
> 赞同：1
> 
> 时间：2012-10-16T14:51:14.440
> 
> 标签：jquery, arabic

我复制了一些阿拉伯语文本并将其粘贴到我的网站上。现在我想在这个阿拉伯语文本中选择括号：http: [//jsfiddle.net/t6Kdc/](http://jsfiddle.net/t6Kdc/)

```
<span>
    كهيعص ﴿١﴾
</span> 
```

```
jQuery(function () {    
    var oldHtml = jQuery('span').html();
    var newHtml = oldHtml.replace("(","<span style='color: red'>﴾&lt;/span>");
    jQuery('span').html(newHtml);
}); 
```

但由于某种原因，我无法选择它们。为什么 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T14:55:50.447

这些不是常规括号，它们是 Unicode 中阿拉伯文字的括号。它们表示为：

```
U+FD3E ﴾ arabic ornate left parenthesis
U+FD3F ﴿ arabic ornate right parenthesis 
```

[（您可以在 Wikipedia 上的 Unicode 中的阿拉伯语脚本中](http://en.wikipedia.org/wiki/Arabic_script_in_Unicode#Punctuation_and_ornaments)看到实际的 Unicode 字符呈现）

要在 jQuery 中替换它们，您可以执行以下操作：

`var newHtml = oldHtml.replace("\ufd3e","<span style='color: red'>(</span>");`（替换左括号）

`var newHtml = oldHtml.replace("\ufd3f","<span style='color: red'>)</span>");`（替换右括号）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-16T14:56:56.883

# java - BufferedWriter.write() 似乎不起作用

> ID：12917474
> 
> 赞同：3
> 
> 时间：2012-10-16T14:51:18.277
> 
> 标签：java, android, sockets, bufferedwriter

我有两个 Java 应用程序，其中一个 Android 客户端连接到计算机上的服务器并使用 BufferedWriter 通过 websockets 发送消息。

客户端：

```
 try {
        toast("Sending...");
        Socket sock = new Socket(ip, PORT);
        OutputStream os = sock.getOutputStream();
        BufferedWriter bw = new BufferedWriter(new OutputStreamWriter(os));
        bw.flush();
        bw.write("Hello Server!");
        toast("Connected!");
    } catch (UnknownHostException e) {
        toast(e.getMessage());
    } catch (IOException e) {
        toast(e.getMessage());
    } 
```

服务器：

```
public static void main(String[] args) {
    ServerSocket server;
    ConnectionThread ct;
    Socket s;
    ExecutorService es = Executors.newSingleThreadExecutor();
    try {
        System.out.println("Starting server...");
        server = new ServerSocket(1337);
        s = server.accept();
        ct = new ConnectionThread(s);
        es.execute(ct);
    } catch (IOException ex) {
        ex.printStackTrace();
    }       
} 
```

`ConnectionThread`班级：

```
public class ConnectionThread implements Runnable {
    private Socket sock;
    private InputStream is;
    private BufferedReader br;
    private boolean online;
    public ConnectionThread(Socket s) {
        System.out.println("Creating connection thread.");
        this.sock = s;
        online = true;
    }
    @Override
    public void run() {
        String input = "";
        try {
            System.out.println("Starting to read...");
            is = sock.getInputStream();
            br = new BufferedReader(new InputStreamReader(is));

            while (online) {
                input = br.readLine();
                if(input != null){
                    System.out.print("Received message: ");
                    System.out.println(input);
                }

            }

            br.close();
            is.close();
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
    }
} 
```

当我运行服务器，然后运行客户端时，客户端将显示“已连接！” toast，服务器的输出将是：

```
Starting server...
Creating connection thread.
Starting to read... 
```

因此，似乎实际上正在建立连接，但消息没有到达。有谁知道为什么会发生这种情况？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-16T14:54:09.240

您的服务器需要一个由换行符终止的完整行。尝试：

```
bw.write("Hello Server!");
bw.newLine(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T14:54:43.310

像这样做...

```
String s = new String();

while ((br.readLine())!=null) {

                s = s+br.readLine();

                    System.out.print("Received message: ");
                    System.out.println(input);
                }

            } 
```

**和**

```
 bw.println("Hello Server"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-16T14:56:55.620

我注意到您没有在客户端上发送结束行，因此 BufferedReader.readline() 将永远不会返回，因为它无法匹配 \n 字符。再试一次

```
 bw.write("Hello Server!\n"); 
```

在客户端。

# objective-c - 没有标题的 iPhone 导航控制器栏

> ID：12917477
> 
> 赞同：0
> 
> 时间：2012-10-16T14:51:26.620
> 
> 标签：objective-c, uiviewcontroller, uinavigationcontroller, uinavigationbar

我想知道如何隐藏 a 的标题`UINavigationBar`。

我有一个根视图控制器，我想在其中有一个导航栏但没有任何标题。

我使用过`[self setTitle:@""];`，但在这种情况下，在转到下一个视图控制器之后，我无法返回。

如果我没有在情节提要中设置并且没有通过代码设置任何内容，那么除了在下一个视图控制器上之外，一切都可以正常工作，我有一个非常丑陋的“返回”按钮，我想将标题设置为“主页”。

谢谢您的回答 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-18T17:47:10.360

您可以设置

```
self.navigationItem.backBarButtonItem 
```

属性到您选择的 UIBarButtonItem - UIKit 会自动为您带来好处。

# javascript - Javascript 确认对话框和鼠标中键/右键单击

> ID：12917479
> 
> 赞同：3
> 
> 时间：2012-10-16T14:51:33.830
> 
> 标签：javascript, asp.net, asp.net-mvc-3, razor, confirm

我正在开发一个 ASP.NET MVC 3 项目，我想在删除之前显示一条确认消息，我写了以下行：

```
@Html.ActionLink("Delete", "Delete", new { id = item.ID }, new { onclick = "return confirm('Are you sure?')" }) 
```

没关系，工作正常，但是当我单击鼠标中键或右键单击然后选择“在新选项卡中打开链接”时，将删除记录而不显示确认对话框，这很奇怪！

我已经尝试了上面的代码`onMouseDown`，对话框显示，但是当我点击 OK 按钮时没有任何动作发生！（记录不会被删除）

我的问题是如何在删除记录之前显示确认消息并且该链接只会响应鼠标左键单击？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T14:54:56.197

您应该检查 'onclick' 事件上的鼠标键，然后如果键离开则返回 false。请参阅有用的示例：[onClick() 和鼠标中键问题](https://stackoverflow.com/questions/3272715/problem-with-onclick-and-middle-button-on-mouse)

# entity-framework - 如何聚合存储库？

> ID：12917484
> 
> 赞同：3
> 
> 时间：2012-10-16T14:51:43.453
> 
> 标签：entity-framework, domain-driven-design, repository-pattern, aggregate, dbcontext

我正在为一家电信公司开发一个大型系统。我是 DDD 的新手，很难将不同的部分链接在一起。我们当前的系统是使用 NHibernate 构建的。它目前有超过 600 个表，所有数据访问都是使用 NHibernate 完成的，但对于新系统，我们将使用 EF。以下是几个功能区域和每个功能区域中的数据库表示例。

客户
-----> CustomerDemographics
-----> CustomerPayments
-----> CustomerTransactions

RoutingEngine
-----> InboundRoutes
-----> OutboundRoutes

ProvisioningEngine
-----> InboundSwithces
-----> OutboundSwitches
-----> RouterConfigs
-----> GatewayConfigs

BillingEngine
-----> InboundTraffic -----
> OutboundTraffic

由于系统必须是可单元测试的，我开始使用存储库模式抽象实际实体。一种方法是为每个数据库表创建一个存储库对象。当然，所有这些存储库类都可以从通用存储库接口派生。然而，这将在代码库维护方面增加相当多的开销。在 DDD 中，我读到了聚合的这个概念，但我不确定它应该如何专门应用于 EF 的上下文中。Aggregate 对象应该是这些存储库的容器，还是这些更多的是相关上下文的容器（意味着类似于 Bounded DbContexts 的内容）？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-16T17:22:49.867

> 一种方法是为每个数据库表创建一个存储库对象。

在 DDD 中，由于忽略了持久性的概念，数据库表通常不会与存储库进行一对一的映射。相反，存储库应该与聚合是一对一的。

> 当然，所有这些存储库类都可以从通用存储库接口派生。

存储库模式可能是一个滑坡。虽然它非常适合封装，但很容易被不必要的抽象带走。在[这里](http://lostechies.com/jimmybogard/2012/10/08/favor-query-objects-over-repositories/)查看另一种观点。

> Aggregate 对象应该是这些存储库的容器，还是这些更多的是相关上下文的容器（意味着类似于 Bounded DbContexts 的内容）？

在 DDD中，您所说的“功能区域”似乎被称为[有界上下文](http://devlicio.us/blogs/casey/archive/2009/02/11/ddd-bounded-contexts.aspx)(BC)。（不是 EF 中的 DbContext）。此外，聚合不是存储库的容器，它们包含一组来自您的域模型的相关实体。典型示例是销售订单模型，其中您有一个订单聚合，该订单聚合由订单聚合根和各种实体和值对象（例如订单行项目）组成。如上所述，聚合是存储库应提供访问的域对象。因此，您应该围绕聚合构建存储库，但当然首先您必须确定聚合和 BC。看看[Vaughn Vernon 的《有效聚合设计》](http://dddcommunity.org/library/vernon_2011)。

此外，在单个 BC 中拥有 600 张桌子似乎太多了，这可能表明您有多个 BC 在玩。BC 实现的是[功能凝聚力](http://en.wikipedia.org/wiki/Cohesion_%28computer_science%29)，这反过来又是最适合对存储库进行分组（“聚合”与 DDD 术语冲突）的方式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-17T04:49:30.507

DDD 中的聚合是一致性边界——事务一致性的孤岛。当您在域模型中有一组对象应该保持事务一致并且可以被视为一个有意义的概念整体时，那么您可能会有一个聚合。在聚合中，您可以具有最终的一致性。

如果您正在进行新的开发，我建议您首先在对象中对您的域进行建模，然后再确定数据库模式应该是什么。

我建议您将一个巨大的模型分解为许多更专业的领域模型，也许沿着功能领域的广泛线，仔细注意每个模型打算处理的关键业务场景（即您试图用每个模型解决哪些困难的业务问题）。每个模型都需要有一个良好的边界（即它应该在明确定义的有界上下文中），其中清楚什么属于一个模型，什么属于另一个模型。这通常是通过将模型边界与某种子系统边界（从架构上讲）对齐来实现的。

# php - 如何判断 curl_multi_exec 何时完成_发送_数据

> ID：12917491
> 
> 赞同：5
> 
> 时间：2012-10-16T14:52:10.770
> 
> 标签：php, curl, asynchronous, nonblocking

我需要从 PHP 脚本调用 web 服务。Web 服务很慢，我对它的响应不感兴趣，我只想向它发送数据。

我正在尝试使用 curl_multi_exec （以下示例如下：[http](http://www.jaisenmathai.com/articles/php-curl-asynchronous.html) ://www.jaisenmathai.com/articles/php-curl-asynchronous.html ），它的第二个参数（$still_running）让您知道它何时完成发送和接收。但是，同样，我只想知道我的脚本何时发送完毕。当然，如果我在完成发送数据之前退出脚本，Web 服务永远不会注册接收请求。

另一种看待它的方法是检测 PHP 何时空闲，等待来自服务器的响应。

我想要实现的是这样的对话：

*   PHP：您好，请保存此数据
*   WS：好的，哼哼，让我们考虑一下。
*   PHP：哇！（去做更重要的事情）
*   WS：好的，我完成了处理，这是您的回复…… PHP？你去哪儿？我觉得习惯了:(

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T15:04:35.547

你可以试试

```
$url = "http://localhost/server.php";
$nodes = array();
$nodes["A"] = array("data" => mt_rand());   <-------- Random Data 
$nodes["B"] = array("data" => mt_rand());
$nodes["C"] = array("data" => mt_rand());
$nodes["D"] = array("data" => mt_rand());

    echo "<pre>";
$mh = curl_multi_init();
$curl_array = array();
foreach ( $nodes as $i => $data ) {
    $curl_array[$i] = curl_init($url);
    curl_setopt($curl_array[$i], CURLOPT_RETURNTRANSFER, true);
    curl_setopt($curl_array[$i], CURLOPT_USERAGENT, 'Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.9.1.2) Gecko/20090729 Firefox/3.5.2 (.NET CLR 3.5.30729)');
    curl_setopt($curl_array[$i], CURLOPT_POST, true);
    curl_setopt($curl_array[$i], CURLOPT_POSTFIELDS, $data);
    curl_setopt($curl_array[$i], CURLOPT_CONNECTTIMEOUT, 5);
    curl_setopt($curl_array[$i], CURLOPT_TIMEOUT, 15);
    curl_multi_add_handle($mh, $curl_array[$i]);
    echo "Please save this data  No : $i ", $data['data'], PHP_EOL;
}

echo PHP_EOL ,PHP_EOL;

$running = NULL;
do {
    usleep(10000);
    curl_multi_exec($mh, $running);
} while ( $running > 0 );
$res = array();
foreach ( $nodes as $i => $url ) {
    $curlErrorCode = curl_errno($curl_array[$i]);
    if ($curlErrorCode === 0) {
        $info = curl_getinfo($curl_array[$i]);
        if ($info['http_code'] == 200) { <------- Connection OK
            echo "Cya! (off to do something more important  No : $i Done", PHP_EOL;
            echo curl_multi_getcontent($curl_array[$i]) , PHP_EOL ;
        }
    }
    curl_multi_remove_handle($mh, $curl_array[$i]);
    curl_close($curl_array[$i]);
}
curl_multi_close($mh); 
```

输出

```
Please save this data  No : A 1130087324
Please save this data  No : B 1780371600
Please save this data  No : C 764866719
Please save this data  No : D 2042666801

Cya! (off to do something more important  No : A Done
Ok, Im done processing, here is your response... 
    {"data":"1130087324"} PHP? Where did you go? 
    I feel used :(
113
Cya! (off to do something more important  No : B Done
Ok, Im done processing, here is your response... 
    {"data":"1780371600"} PHP? Where did you go? 
    I feel used :(
113
Cya! (off to do something more important  No : C Done
Ok, Im done processing, here is your response... 
    {"data":"764866719"} PHP? Where did you go? 
    I feel used :(
112
Cya! (off to do something more important  No : D Done
Ok, Im done processing, here is your response... 
    {"data":"2042666801"} PHP? Where did you go? 
    I feel used :(
113 
```

简单测试服务器 server.php

```
echo printf("Ok, Im done processing, here is your response... \n\t%s PHP? Where did you go? \n\tI feel used :(\n", json_encode($_REQUEST)); 
```

# sql - SQL SELECT DISTINCT 谜题

> ID：12917494
> 
> 赞同：0
> 
> 时间：2012-10-16T14:52:41.053
> 
> 标签：sql, sql-server

我正在尝试从两个表创建一个查询。

第一个表是“文档类型”，第二个表是“文档”文档类型，如果您喜欢一个类别，“文档”包含有关文档本身的详细信息。它们是相关的（即“文档”包含与“文档类型”的关键字段相关的字段）。

简化后，表格如下所示：-

```
Document Type
=============
TypeID
TypeName
TypeDescription

Document
========
DocumentID
DocumentType (fk of TypeID)
DocumentRequired 
```

我正在运行的查询需要一个 DISTINCT 文档类型列表 - 这是第一个也是最简单的位。

我想要做的是在查询中添加一列，然后在“文档”下查看，如果曾经有任何相关文档的“文档要求”等于 TRUE，则显示 TRUE/Yes 值。如果不是，则显示 FALSE/No。

我已经尝试创建一个连接，但显然如果有任何类别同时包含必需/非必需文档，我会得到重复。我想要的只是一个是/否标志。

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T14:58:31.987

```
SELECT dt.TypeID,dt.TypeName,dt.TypeDescription,
    CASE
        WHEN sum(CONVERT(int,ISNULL(d.DocumentRequired,0)))=0 THEN 'False/No'
        ELSE 'True/Yes'
    END [Any required documents]
FROM DocumentType dt
LEFT JOIN Document d on dt.DocumentType=dt.TypeID --terrible naming convention....
group by dt.TypeID,dt.TypeName,dt.TypeDescription 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T14:59:22.810

```
Select DISTINCT TypeID, 
                TypeName, 
                TypeDescription, 
                CASE WHEN 
                    (select count(*) 
                            from Document 
                            where document.DocumentType = DocumentType.TypeID 
                            and DocumentRequired = 'TRUE'
                    )>0 
                    THEN 'YES' 
                    ELSE 'NO' 
                END AS myYesNoField 
    FROM DocumentType 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-16T14:59:32.587

```
SELECT
    TypeID,
    TypeName,
    TypeDescription,
    CASE WHEN NumRequiredDocuments > 0 THEN 'Yes' ELSE 'No' END RequiredDocumentsExist
FROM
(
    SELECT
        DocumentType.TypeID,
        DocumentType.TypeName,
        DocumentType.TypeDescription,
        SUM (CASE WHEN Document.Required <> 0 THEN 1 ELSE 0 END) NumRequiredDocuments
    FROM
        DocumentType
        LEFT JOIN Document ON DocumentType.TypeID = Document.DocumentType
)
GROUP BY
    TypeID,
    TypeName,
    TypeDescription 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-16T15:13:32.477

给定表中的以下记录： **DocumentType**

```
TypeID  TypeName    TypeDescription
1   Type1   1st Type
2   Type2   2nd Type
3   Type 3  3rd Type 
```

和**文件**

```
DocumentId  DocumentType    DocumentRequired
1       1       0
2       1       1
3       2       0
4       3       1 
```

然后下面的选择会给你你想要的：

```
SELECT  TypeID, 
        TypeName, 
        TypeDescription, 
        CASE 
            WHEN EXISTS 
                (SELECT * 
                FROM Document 
                WHERE Document.DocumentType = TypeID 
                    AND DocumentRequired = 1) THEN 'True'
            ELSE 'False'
        END AS DocumentRequired
FROM DocumentType 
```

# asp.net-mvc-4 - 实体框架并使用 Fluent API 将两个实体映射到另一个实体

> ID：12917495
> 
> 赞同：1
> 
> 时间：2012-10-16T14:52:40.930
> 
> 标签：asp.net-mvc-4, entity-framework-5, fluent-interface

场景似乎微不足道，我真的很困惑我做错了什么。

所以，我有一个客户端类

```
 public class Client
{
    [Key]
    public int ClientID { get; set; }
    public string FirstName { get; set; }
    public string LastName { get; set; }

    public virtual Account Account { get; set; }

 } 
```

员工类

```
public class Employee
{
    [Key]
    public int EmployeeID { get; set; }
    public string FirstName { get; set; }
    public string LastName { get; set; }

    public virtual Account Account { get; set; }
} 
```

和一个 Account 类

```
public class Account
{
    [Key]
    public int AccountID { get; set; }
    public string Login { get; set; }
    public string Password { get; set; }

    public virtual Employee Employee { get; set; }
    public virtual Client Client { get; set; }
} 
```

客户和员工都可能有或没有帐户（在线访问是可选的）。由于数据库与 EF 命名约定不兼容，我必须提出 Fluent API 显式映射。

Client 和 Employee 表都有我试图用来建立关系的“AccountID”列。

```
 modelBuilder.Entity<Client>()
            .HasOptional(e => e.Account)
            .WithRequired(a => a.Client)
            .Map(m => m.MapKey("AccountID"));

        modelBuilder.Entity<Employee>()
            .HasOptional(e => e.Account)
            .WithRequired(a => a.Employee)
            .Map(m => m.MapKey("AccountID")); 
```

但我明白了

```
Schema specified is not valid. Errors: 
(15,6) : error 0019: Each property name in a type must be unique. Property name 'AccountID' was already defined.
(16,6) : error 0019: Each property name in a type must be unique. Property name 'AccountID' was already defined. 
```

那么，除了修改表/实体结构之外，有没有办法解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T16:22:53.980

事实证明，在这种情况下您不需要 Fluent API，您需要的是 DataAnnotate 具有 InverseProperty 属性的实体中的属性

```
[InverseProperty("AccountID")] 
```

[Ladislav Mrnka 在Entity Framework 4.1 InverseProperty Attribute](https://stackoverflow.com/questions/5716528/entity-framework-4-1-inverseproperty-attribute) question中有一个很好的答案

但是，如果有人知道如何使用流利的答案正确地做到这一点，我们将不胜感激

# asp.net-mvc-3 - 不了解编写自己的验证属性的机制

> ID：12917497
> 
> 赞同：0
> 
> 时间：2012-10-16T14:52:44.017
> 
> 标签：asp.net-mvc-3, validationattribute

我之前写过一个属性，但是我之前没有写过验证属性。我对这一切如何协同工作感到非常困惑。我已经阅读了大部分关于如何完成此任务的在线教程。但我还有几个问题需要思考。

请记住，我正在尝试编写一个 requiredIf 属性，该属性仅在设置了某个 Jquery 变量时才调用远程函数...顺便说一下，这是一个从视图状态中提取的变量...我想我可以做那部分我的视图模型。但我离题了

1) C# 代码有点混乱。我知道我的属性应该分别扩展 ValidationAttribute、IClientValidatable 类和接口。但是我对每个覆盖的方法应该做什么有点困惑？我正在尝试编写 requiredIf，覆盖这些方法如何帮助我实现这一目标？

2）如果变量不存在，我根本不希望远程函数尝试验证该字段。我不想在我的表单上弹出任何消息。很多教程似乎都围绕着这一点。

3）我很困惑我需要用 jquery 做什么才能将这个函数添加到视图中......我需要向 JQuery 添加什么才能让这个东西工作......这似乎有很多额外的编码当我可以简单地键入一个 jquery 函数，该函数使用相同或更少的编码完成相同的事情时......我知道它还添加了服务器端验证，这很好。但是还是...

这是我在这个等式的 jquery 方面所拥有的......

```
(function ($) {
    $validator.unobtrusive.adapters.addSingleVal("requiredifattribute", "Dependent");
    $validator.addMethod("requiredifattribute", function (value, element, params) {
        if (!this.optional(element)) {
            var otherProp = $('#' + params)
            return (otherProp.val() != value);
        }
        return true;
    })
}(jQuery)); 
```

这是我的属性（基本上是从所需的教程中复制出来的...

```
[AttributeUsage(AttributeTargets.Property)]
public class RequiredIfAttribute  : ValidationAttribute, IClientValidatable {
    private const string errorMessage = "The {0} is required.";
    //public string 
    private RequiredAttribute innerAttribute = new RequiredAttribute();
    public string DependentProperty { get; set; }
    public object TargetValue { get; set; }

    public RequiredIfAttribute(string dependentProperty, object targetValue){
        this.DependentProperty = dependentProperty;
        this.TargetValue = targetValue;
    }

    protected override ValidationResult IsValid(object value, ValidationContext validationContext) {
        var field = validationContext.ObjectInstance.GetType().GetProperty(DependentProperty);
        if (field != null) {
            var dependentValue = field.GetValue(validationContext.ObjectInstance, null);
            if ((dependentValue == null && TargetValue == null) || (dependentValue.Equals(TargetValue))) {
                if (!innerAttribute.IsValid(value))
                    return new ValidationResult(ErrorMessage);
            }
        }
        return ValidationResult.Success;
    }

    public IEnumerable<ModelClientValidationRule> GetClientValidationRules(ModelMetadata metadata, ControllerContext context) {
        ModelClientValidationRule modelClientValidationRule = new ModelClientValidationRule {
            ErrorMessage = FormatErrorMessage(metadata.DisplayName),
            ValidationType = "requiredifattribute"
        };
        modelClientValidationRule.ValidationParameters.Add("dependent", DependentProperty);
        yield return modelClientValidationRule;
    }
} 
```

**更新：我所拥有的根本不起作用**

这是我的模型中的属性如何使用上述属性进行注释的

```
 [RequiredIf("isFlagSet", true)]
    [Remote("ValidateHosFin", "EditEncounter", AdditionalFields = "hospitalFin, encflag", ErrorMessage = "Got Damn this is complex!")]
    [MinLength(6)]
    public string HostpitalFinNumber { get; set; } 
```

在我看来，我试图在此验证上键入的值是这样设置的......

```
 ViewData["ADDENCOREDITTEMP"] = encflag;
   if (encflag == "AddEnc"){
       isFlagSet = true;
   } 
```

我像这样将它嵌入到我的页面中......

```
@Html.Hidden("isFlagSet", isFlagSet, new { id = "isFlagSet"}) 
```

我无法让我的表单提交......那个说他刚刚尝试过并让它工作的人，你能发布代码吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T18:53:11.700

模型：

```
public class X
{
    [RequiredIf("y", "y", ErrorMessage = "y is not y")]
    public string x { get; set; }

    public string y { get; set; }
} 
```

看法：

```
@using(Html.BeginForm())
{
    @Html.ValidationSummary()

    @Html.TextBoxFor(m => m.x)
    @Html.TextBoxFor(m => m.y)

    <input type="submit"/>
} 
```

我假设您的验证在服务器端失败？`isFlagSet`您的视图模型中有属性吗？

# android - 开始新活动时，Eclipse/Android SDK 不允许我选择“构建 SDK”选项

> ID：12917505
> 
> 赞同：1
> 
> 时间：2012-10-16T14:53:11.570
> 
> 标签：android, eclipse, windows-7, sdk

我正在尝试使用 Eclipse（Indigo）的 android 插件，并且我已经让它工作了一次。不幸的是，我使用的机器上有一个“深度冻结”程序，所以我不得不多次安装 SDK 才能使用它。我已获得系统管理员的许可，可以永久安装 SDK，但我似乎无法正确安装它。我的问题如下：

我按照[http://developer.android.com/sdk/installing/index.html](http://developer.android.com/sdk/installing/index.html)上的安装说明进行操作，遇到一些问题让 Windows 识别出 JDK 已经安装（我已经完成），然后完成安装。我尝试创建一个新的 Android 项目，在项目创建的第 1 步中，标有“Build SDK”的下拉栏完全空白，“下一步”、“返回”和“完成”按钮都是黑色的且无法点击。

我不太确定从安装到安装（SDK）我做了什么不同。任何帮助或建议将不胜感激。

# php - 与 Doctrine2 和 Symfony2 的 OneToOne 关系

> ID：12917506
> 
> 赞同：-1
> 
> 时间：2012-10-16T14:53:17.523
> 
> 标签：php, symfony, doctrine-orm, entity

我正在尝试在我的用户和个人资料实体之间创建一个简单的 OneToOne 关系，这是我的控制器： http: [//pastie.org/5068108](http://pastie.org/5068108)，我的用户实体： http: [//pastie.org/5068124](http://pastie.org/5068124)和我的个人资料实体：[http://pastie.org/5068131](http://pastie.org/5068131) 但我总是得到这个奇怪的错误：

注意：数组到字符串的转换在 /opt/lampp/htdocs/Test/vendor/doctrine-dbal/lib/Doctrine/DBAL/Statement.php 第 98 行。

当我尝试坚持（）我的表单时会出现此错误。

有人可以帮助我吗，我正在努力解决这个对我来说毫无意义的错误。非常感谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T15:04:37.027

您的用户实体中的 $profile 属性应该是：

```
/**
* @ORM\OneToOne(targetEntity="\Test\ProfileBundle\Entity\Profile", mappedBy="user")
* @JoinColumn(name="profile_id", referencedColumnName="id")
*/
private $profile; 
```

您必须在 Profile 实体中添加以下内容：

```
/**
* @ORM\OneToOne(targetEntity="\Test\UserBundle\Entity\User", mappedBy="profile")
*/
private $user; 
```

之后，应用更改：

> 应用程序/控制台原则：生成：实体测试
> 
> 应用程序/控制台原则：架构：更新 --force

**已编辑：**正如@shima5 指出的那样，我忘记添加 JoinColumn 注释。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-16T15:17:11.117

在 User.php 中：

```
 /**
     * @OneToOne(targetEntity="Test\ProfileBundle\Entity\Profile")
     * @JoinColumn(name="profile_id", referencedColumnName="id")
     */
    private $profile; 
```

这是一个单向关联。

您不能单独使用 mappedBy="user"，因为它是双向的，您需要像这样在 Profile 中添加 inversedBy="profile" ：

```
 /**
     * @OneToOne(targetEntity="User", inversedBy="profile")
     * @JoinColumn(name="user_id", referencedColumnName="id")
     */
    private $user; 
```

和用户：

```
 /**
     * @OneToOne(targetEntity="Test\ProfileBundle\Entity\Profile", mappedBy="user")
     */
    private $profile; 
```

# c# - 在c#中使用android的.so文件

> ID：12917507
> 
> 赞同：1
> 
> 时间：2012-10-16T14:53:19.740
> 
> 标签：c#, android

我有一个 .so 文件，我在 java 代码中使用它，编译后在 Android 机器上使用，现在我被迫在 .NET c# 应用程序中使用 .so 文件中定义的一些功能。如何在 c# 程序中引用或使用 .so 文件？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-16T15:04:55.600

我不认为这是可能的。

.so 是一个共享对象，它是手机/模拟器的机器码（Android Native Interface）。我不太了解 C#，但我认为没有任何接口可以访问 .so 的成员。

除此之外，.so 是 linux 的共享对象格式，而 .NET 主要在 Windows 上运行。

此外，.so 很可能是为手机上的 ARM 处理器编译的，因此它需要一个模拟器才能在 Windows 上运行。

你看，这些技术之间存在着巨大的差距。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-17T02:41:17.577

如果您想在 PC 上使用它，不，您不能直接使用该文件。您需要获取源代码并重新编译为 DLL，您可以通过 Platform Invoke（IIRC 名称）从 .NET 使用该 DLL。您所拥有的很可能是 ARM 代码，而您的 PC 需要 x86。

Monodroid 可能适用于 Android 设备，因为它很可能只是编译为 Android 代码。我从来没有使用过它，所以不要引用我的话。

# drupal-7 - Drupal 7，Ubercart 3 自定义结帐窗格 $order 未设置变量

> ID：12917508
> 
> 赞同：1
> 
> 时间：2012-10-16T14:53:26.760
> 
> 标签：drupal-7, ubercart

```
//create anew schedule pane at checkout
function uc_pizza_uc_checkout_pane() {
  $panes[] = array(
    'id' => 'schedule',
    'callback' => 'uc_checkout_pane_schedule',
    'title' => t('Pickup/Delivery Date & Time'),
    'desc' => t("Show Pickup/Delivery Date & Time Pane"),
    'weight' => 1,
    'process' => TRUE,
    'collapsible' => FALSE,
  );
  return $panes;
}

function uc_checkout_pane_schedule($op, $order, $form = NULL, &$form_state = NULL) {
  require_once(drupal_get_path('module', 'uc_cart') . '/uc_cart_checkout_pane.inc');

  switch($op) {
    case 'view':  //create a date-popup field and a separate field for time.
        $format = 'Y-m-d';

        if(isset($_REQUEST['panes']['schedule']['date']['date'])) {
            $date = $_REQUEST['panes']['schedule']['date']['date'];
        } else {
            $date = date($format);
        }

        $descriptions = t("NOTE: You may schedule your pizza pickup or delivery below. The shop is only open from 5pm until 11pm, you may still place your order beyond store hours but it will be delivered the next working hour or your required schedule.");
        $contents ['sched_date'] = array(
           '#type' => 'date_popup', 
           '#title' => t('select a date'),
           '#default_value' => $date, 
           '#date_format' => $format,
           '#datepicker_options' => array('minDate' => 'today', 'maxDate' => variable_get("uc_pizza_max_days", '+6 days')),
           '#date_label_position' => 'within', 
           '#date_increment' => 15, 
           '#date_year_range' => '-0:+0', 
        );

        $base_hour= 5;  
        for($i=0; $i<25; $i++) {     
           $mins = str_pad((int) (($i % 4) * 15),2,"0",STR_PAD_LEFT);
           $hour = str_pad((int) $base_hour,2,"0",STR_PAD_LEFT);
           $options_time[$hour.$mins] =  t($hour . ":" . $mins . " PM"); 
           if($mins == 45) {
              $base_hour++;
           }
        }

       if(isset($_REQUEST['panes']['schedule']['time'])) {
          $default_option = $_REQUEST['panes']['schedule']['time'];
       } else {
          $default_option = 0000;
       }

       $contents['sched_time'] = array(
            '#type' => 'select',
            '#title' => 'Time',
            '#options' => $options_time,
            '#default_value' => $default_option,
        );
        return array('description' => $descriptions, 'contents' => $contents);
    break;

    case 'prepare':
    break;

    case 'review': //**/THIS IS WHERE THE PROBLEM IS** please check process
            dprint_r("order: ", $order); // only var with data
            dprint_r("form: ", $form);  //no data
            dprint_r("form_state: ", $form_state); //no data 
      //$sched_date = $arg1->schedule_date;
      //$sched_time = $arg1->schedule_time;
      //$review[] = '<div class="giftwrap">' . t('You want @type as gift wrap medium', array('@type' => $gift_wrap_type)) . '</div>';    
      //$review[] = array('title' => t('Schedule'), 'data' => check_plain("$sched_date @ $sched_time"));
      //return $review;
    break;

    case 'process': 
//here in process i put the var to $order->schedule_date but unable to see it in $order at view
      $order->schedule_date = $form_state['panes']['schedule']['sched_date']['#value']['date'];
      $order->schedule_time = $form_state['panes']['schedule']['sched_time']['#value'];
      return TRUE;
    break;

    case 'settings':
          $max_days = variable_get("uc_pizza_max_days", '+6 days');
          variable_set("uc_pizza_max_days", $max_days);
          $contents['max_days'] = array(
            '#type' => 'textfield',
            '#title' => t('Calendar Max Days Limit'),
            '#default_value' => $max_days,
            '#maxlength' => 60,
            '#size' => 32,
          );
        return $contents;
    break;

  }
} 
```

我正在尝试在 ubercart 的结帐过程中添加一个窗格，$op = view 和设置效果很好。

我有审阅问题我尝试在 $op=process 设置变量，但在 $op=review 中找不到它

**在此过程中尝试过**

```
 $order->schedule_date = $form_state['panes']['schedule']['sched_date']['#value']['date'];
  $order->schedule_time = $form_state['panes']['schedule']['sched_time']['#value']; 
```

但

回顾一下，似乎 $order->schedule_date 和 $order->schedule_time 不在 $order;

任何人都可以帮我解决我想念的问题吗……这是在 D7 中

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T00:25:17.423

使用 $order->data 而不是尝试将自定义设置直接应用于 $order。在“过程”下试试这个

```
case 'process':
  // display arrays for devel testing
  dpm($form);
  dpm($order);

  // use $order->data to store your submission data
  $order->data['schedule_time'] = $form['panes']['schedule']['sched_time']['#value'];
  break; 
```

然后使用'review'下的$order来获取你需要的数据。

# ios - 通知 IOS apns

> ID：12917511
> 
> 赞同：1
> 
> 时间：2012-10-16T14:53:48.320
> 
> 标签：ios, push-notification, apple-push-notifications

我已经完成了我的测试，并且所有通知都使用 php apns 很好地通过了。现在，一旦我切换到生产，我就会得到这个结果

```
Tue, 16 Oct 2012 16:40:48 +0200 ApnsPHP[5709]: INFO: Trying ssl://gateway.push.apple.com:2195... 
Tue, 16 Oct 2012 16:40:51 +0200 ApnsPHP[5709]: INFO: Connected to ssl://gateway.push.apple.com:2195\. 
Tue, 16 Oct 2012 16:40:51 +0200 ApnsPHP[5709]: INFO: Sending messages queue, run #1: 1 message(s) left in queue. 
Tue, 16 Oct 2012 16:40:51 +0200 ApnsPHP[5709]: STATUS: Sending message ID 1 [custom identifier: Message-Badge-3] (1/3): 119 bytes. 
Tue, 16 Oct 2012 16:40:51 +0200 ApnsPHP[5709]: INFO: Disconnected. 
```

这对我来说看起来不错，但是我的设备没有收到通知。

请帮忙

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-02T20:04:12.197

确保您的 DeviceToken 是**生产**设备。**用于开发**的DeviceToken 与用于同一设备的**生产**不同。

*来自苹果*：

*请注意，生产环境中的设备令牌和开发环境中的设备令牌不是同一个值。*

[资源](https://developer.apple.com/library/ios/documentation/NetworkingInternet/Conceptual/RemoteNotificationsPG/Chapters/CommunicatingWIthAPS.html)

# java - Delphi并发内存模型？

> ID：12917512
> 
> 赞同：9
> 
> 时间：2012-10-16T14:53:48.973
> 
> 标签：java, delphi, concurrency

Delphi中有类似[Java内存模型的东西吗？](http://en.wikipedia.org/wiki/Java_Memory_Model)为了防止误解：我的意思不是“巨大/大/小”，而是与其他线程更改的可见性有关的事情。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-10-16T22:06:35.317

我会说 Delphi 内存模型与 C++ 内存模型相匹配。也就是说，编译器不知道多进程或多线程，也不为这些场景提供任何特殊支持。请参阅[“什么是 C++ 并发内存模型？”](https://stackoverflow.com/questions/220752/what-is-the-c-memory-model-for-concurrency?rq=1)

Delphi 32 位编译器确实执行了诸如不变代码运动之类的优化，并且确实发出了旨在避免双流水线停滞的指令序列。但是，Delphi 编译器不包含指令调度器或窥孔优化器，因此指令重新排序的机会微乎其微。Delphi 优化在指令发出之前发生在 AST / IR 上。

可以注册局部变量，但是任何对需要内存地址的变量的源代码引用（例如将局部变量传递给 var 参数，或获取局部 var 的地址）都会强制编译器将注册值提交给在使用地址之前的内存位置，或者可能会强制编译器完全放弃注册变量。

Delphi 32 位编译器在优化方面相当保守。优化带来的最大性能提升来自注册变量和中间结果，以及各种循环归纳技巧。

对全局符号或驻留在全局内存中的符号（例如对象字段）的操作未注册。没有“volatile”修饰符。

编译器代码生成模式依赖于 x86 架构规则，即在对齐地址处对全局内存进行寄存器大小的写入是原子的。大数据、字节数据或未对齐地址的写入可能会跨越高速缓存行，并且需要在单个写入指令中进行两次单独的写入操作。Delphi 编译器（大部分）没有注意到这一点。

无论如何，如果您正在编写从不同线程访问共享内存的 Delphi 代码，那么您始终有责任决定哪些线程同步措施适合您的情况并实施它们。

# playframework - 页面重定向

> ID：12917515
> 
> 赞同：0
> 
> 时间：2012-10-16T14:53:56.493
> 
> 标签：playframework

根据控制器中的某些条件，我想将用户引导到我现在正在执行的错误页面。

当错误页面显示给用户时，我希望用户被重定向到特定的重试页面。

这是使用以下方法的正确方法吗：

```
<meta http-equiv="refresh" content="3; url=http://www.somewhere.com/" /> 
```

还是我应该使用 javascript 基于计时器进行重定向？

为了获得正确的 url，我可以将 url 放入 flash 范围并读取它们并放置在上面的字符串中

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T15:00:48.643

为什么您要从 HTML 级别进行重定向，而您可以在控制器中毫无问题地做到这一点？玩 2，Java：

```
public static Result something(){
    if (someCondition){
        return redirect(routes.Application.errorAction());
    }

    return ok("Render here not redirected view...");
} 
```

# java - 没有字段的抽象类上的 NotSerializableException

> ID：12917516
> 
> 赞同：3
> 
> 时间：2012-10-16T14:53:57.803
> 
> 标签：java, serialization

这是我的小班：

```
import java.io.Serializable;
public abstract class SerializableCallback extends Callback
implements Serializable {
    private static final long serialVersionUID = 4544768712188843966L;
    public abstract void handleMessage(Message msg);
} 
```

这是它更小的父级`Callback`：

```
public abstract class Callback {
    public abstract void handleMessage(Message msg);
} 
```

这是我的测试：

```
public void testSerialization() throws IOException, ClassNotFoundException {
    SerializableCallback c = new SerializableCallback() {
        private static final long serialVersionUID = -4852385037064234702L;
        @Override
        public void handleMessage(Message msg) {
            callbackMethod();
        }
    };

    FileOutputStream fos = new FileOutputStream(FILE);
    ObjectOutputStream out = new ObjectOutputStream(fos);
    out.writeObject(c); // fails
    out.close();

    FileInputStream fis = new FileInputStream(FILE);
    ObjectInputStream in = new ObjectInputStream(fis);
    Object object = in.readObject();
    @SuppressWarnings("unused")
    SerializableCallback d = (SerializableCallback) object;
}

private void callbackMethod() {} 
```

测试`NotSerializableException`在注释指示的行上给了我一个。这里有几件事肯定*不能*引起：

1.  缺少可序列化声明
2.  不可序列化的字段：根本没有字段
3.  最接近的不可序列化父类型的不可见非参数构造函数

那么导致异常的原因是什么*？*

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-16T14:58:12.443

您的类没有无参数构造函数。它有一个构造函数，它接受一个`this`外部类的参数。如果你做了 testSerialization()`static`它可能会解决问题。

但我怀疑你直接的真正问题是你的嵌套类引用了外部类，而外部类不是可序列化的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-16T15:46:01.790

只是为了进一步解决您对彼得答案的评论（评论太长），`SerializableCallback`您的测试方法**中的匿名类在技术上是一个内部类**。

*   当在非静态方法中声明时，匿名类本质上是非静态内部类。
*   当在静态方法中声明时，匿名类本质上是静态内部类。

这就是为什么切换到`static`工作。由于它使您创建的匿名类成为静态类，因此它不再包含对您的测试类的隐式引用，因此它是可序列化的。

请记住，在非静态级别声明的匿名类和内部类始终包含对封闭类的引用。如果没有，您将无法调用`callbackMethod()`匿名类，因为匿名类没有声明它。

当`ObjectOutputStream`试图序列化你的匿名`SerializableCallback`时，它试图序列化回调*和*测试类，因为它`SerializableCallback`持有对它的引用。这就像试图序列化这个类：

```
// Declared in its own file
public class MySerializableCallback extends SerializableCallback {
    private static final long serialVersionUID = -4852385037064234702L;

    // Equiv to Callback.this in an inner class
    private final CallbackTest test;

    public MySerializableCallback(CallbackTest test) {
        this.test = test;
    }

    @Override
    public void handleMessage(Message msg) {
        test.callbackMethod();
    }
} 
```

如果你试图序列化这个类，很明显它会失败，因为它`CallbackTest`可能是不可序列化的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-16T14:59:43.170

检查这些情况

在这些情况下，序列化失败：

*   删除实例变量。

*   更改实例变量的类型。

*   将实例变量从非瞬态更改为瞬态。

*   将实例变量从非静态更改为静态。

*   在层次结构中上下移动类。

# scheme - 使用给定运算符累积值区间

> ID：12917517
> 
> 赞同：1
> 
> 时间：2012-10-16T14:53:58.167
> 
> 标签：scheme

我正在尝试编写一个函数，它使用给定的运算符累积值区间并添加初始值。例子：

（累积间隔 + 0 2 4）：2 + 3 + 4 + 0 = 9

（累积间隔 * 1 2 5）：2 * 3 * 4 * 5 * 1 = 120

注意：只有 (+) 和 (*) 工作对我来说就足够了。

我的代码是：

```
(define accumulate-interval
  (lambda (op init lower upper) (if (= upper lower)
   (lambda (x) (op x init))
    (lambda (x)
      (op
      ((accumulate-interval op init lower (- upper 1)) x))))     )) 
```

它返回一个过程而不是一个值。如果您能提供帮助，我将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T15:35:34.540

您的代码中有几个概念性问题。我同意@itsbruce，向您指出正确的解决方案比修复问题中发现的每个错误更简单。

首先，请注意该过程可以根据现有的高阶函数来编写：`foldr`用于累积值和`build-list`创建值范围：

```
(define (accumulate-interval op init lower upper)
  (foldr op init
         (build-list (add1 (- upper lower))
                     (lambda (x) (+ lower x))))) 
```

或者，在 Racket 中，您可以使用它`for/list`来创建值范围：

```
(define (accumulate-interval op init lower upper)
  (foldr op init
         (for/list ([n (in-range lower (add1 upper))]) n))) 
```

如果需要从头开始编写解决方案（可能就是这种情况），最好将问题分成几部分。首先，生成数字范围：

```
(define (range lower upper)
  (if (> lower upper)
      '()
      (cons lower
            (range (add1 lower) upper)))) 
```

现在，累积值：

```
(define (accumulate op init lst)
  (if (null? lst)
      init
      (op (car lst)
          (accumulate op init (cdr lst))))) 
```

最后，将前面的两个辅助过程组合成一个问题的解决方案。请注意，在前两个解决方案中，我们做了完全相同的问题分解（第一个：生成范围；第二个：累积；第三个：组合），唯一的区别是这里我们手动编写了帮助程序，而不是使用已经存在的程序：

```
(define (accumulate-interval op init lower upper)
  (accumulate op init
              (range lower upper))) 
```

当然，您可以像在您的解决方案中一样将所有过程合并为一个 - 它更有效，因为它不会创建中间数字列表：

```
(define (accumulate-interval op init lower upper)
  (if (> lower upper)
      init
      (op lower
          (accumulate-interval op init (add1 lower) upper)))) 
```

...但是这样做只会为一个特定问题提供量身定制的解决方案，而不是一组在其他情况下有用的可组合程序。在函数式编程风格中，最好定义通用的、可重用的函数。

无论如何，这按预期工作：

```
(accumulate-interval + 0 2 4)
> 9

(accumulate-interval * 1 2 5)
> 120 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-16T15:19:53.580

它返回一个函数，因为这就是您要返回的。 **lambda**是一个创建匿名函数并返回对它的引用的函数。当您的代码执行

```
(define accumulate-interval (lambda (op init lower upper) ......)) 
```

它使用**lambda**创建一个匿名函数，返回对它的引用并将该引用分配为**accumulate-interval**的值。 **因此， accumulate-interval**与该函数相关联，并且只要在列表中的**函数**位置评估**累积间隔时，就会运行该函数。**

 **现在，您的**累积间隔**函数由一个**if**表达式组成

```
(if (= upper lower) (lambda (x) ...) (lambda (x) ...)) 
```

因此，如果**upper**和**lower**相等，则返回一个匿名函数的引用，否则返回不同的。这就是你告诉它要做的事情。

我不知道你在这里想要做什么，但我怀疑你只是想执行你错误地包装在一个函数中并返回的代码。所以我认为你的代码看起来更像

```
(if (= upper lower)
  (op upper init) (op lower (accumulate-interval op init (+ lower 1) upper))) 
```

哪个应该起作用，尽管我认为您需要重新考虑您的论点，因为该递归调用不在尾部位置。

考虑此事，

```
(if (= upper lower)
   (op upper init)
   (accumulate-interval (op upper init) lower (- upper 1))) 
```

可以工作*并且*是尾递归的。

注意：我通常不会为人们做功课，但我认为您可能对 Scheme 语法有不止一个误解，显示工作代码比单独和组合探索每个可能的误解更容易。**

# qt4 - 如何直接在设计器中设置布局？

> ID：12917518
> 
> 赞同：0
> 
> 时间：2012-10-16T14:53:58.490
> 
> 标签：qt4

我想直接为小部件设置布局，因为我没有在 UI 编辑器中找到方法，所以我经常求助于：

`ui->tab->setLayout (ui->verticalLayout)`

但这在我看来很愚蠢。

反正有没有额外的编码来做到这一点？

![在此处输入图像描述](../Images/b6a8d0378adc13f21e9c1747b0de0ac4.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T15:28:19.407

在编辑器中选择所需的小部件，然后在菜单中选择要使用的布局：

![布局选择](../Images/1a394a2e031bf818d135764ddab2273e.png)

无需在编辑器的小部件内添加布局。

# java - 使用 Spring @Transactionnal，Spring 如何知道要使用哪个数据源？

> ID：12917523
> 
> 赞同：4
> 
> 时间：2012-10-16T14:54:05.807
> 
> 标签：java, spring, hibernate, transactions, mybatis

将 @Transactionnal 与 Spring 一起使用时

*   它如何选择应该在其上打开事务的数据源？

*   有没有像代理、threadlocals 之类的魔术？

*   如果是这样，这些技巧是否适用于任何 JDBC 库（对于 Hibernate，它可以工作，但 MyBatis 呢？）

*   如果有 2 个数据源怎么办？

*   如果我在 @Transactionnal 服务中调用具有 2 个底层不同数据源的 DAO 怎么办？它是对两个数据源还是仅对其中一个数据源都是事务性的，还是会失败？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-16T15:15:37.077

要使用多个事务处理程序，只需指定一个限定符并引用它。对于具有两个不同数据源的两个不同 DAO，您将需要两个不同的事务管理器。当然，事务应该在您的服务类上进行，而不是直接在 DAO 上进行。它对于任何类型的事务管理器都是一样的，无论是休眠的还是普通的旧 jdbc。

```
<bean id="transactionManagerOne"
        class="org.springframework.orm.hibernate4.HibernateTransactionManager"
        p:sessionFactory-ref="sessionFactoryOne">
        <qualifier value="One" />
    </bean> 
```

和会话工厂

```
<bean id="sessionFactoryOne"
        class="org.springframework.orm.hibernate4.LocalSessionFactoryBean"
        p:dataSource-ref="dataSourceOne" 
```

并且只需使用 ID dataSourceOne 设置一个数据源，然后您可以在代码中使用限定符 name 引用 transactionmanager：

```
@Transactional(value = "One") 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-16T15:07:11.623

我可以提供一个部分答案，通常当您使用`PlatformTransactionManager`Spring 中的 a 时，它在创建时与单个数据源相关联。像这样的东西：

```
@Bean public PlatformTransactionManager txManager() { 
  return new HibernateTransactionManager(sessionFactory()); 
} 
```

配置`SessionFactory`有数据源。我怀疑如果你想拥有多个`PlatformTransactionManager`s 那么你不能像我上面所做的那样仅仅依靠自动装配它们作为 bean。您可能不得不改用`TransactionTemplate`该类并在稍低的级别上编写代码。

# javascript - 如何使用 Backbone.js/Javascript 前端实现 Oauth/OpenID/自定义身份验证？

> ID：12917530
> 
> 赞同：3
> 
> 时间：2012-10-16T14:54:30.367
> 
> 标签：javascript, rest, backbone.js, openid, oauth-2.0

我有一个站点，我们的后端和前端（100% 主干）是解耦的 RestFul（JSON + Ajax），我们现在正在考虑如何实现用户身份验证。

我们希望支持 facebook、Google 和其他（OAuth 和 OpenId）以及我们对没有或不想使用其他帐户的用户的自定义方法。

您如何进行自定义身份验证？最好的做法是什么？

您是否也使用 OAuth 或 OpenID 进行自定义登录？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T18:36:08.870

Oauth 过去在使用我自己的自定义身份验证时为我工作过。有一个非常好的库可以处理大部分工作。

[http://oauth.googlecode.com/svn/code/javascript/](http://oauth.googlecode.com/svn/code/javascript/)

如果您使用 node.js 作为 restFul 服务器，您可以使用 Passport Middleware [http://passportjs.org/](http://passportjs.org/)来处理大部分服务器端。

Passport 的文档还包括一些可以在任何堆栈上实现的很好的通用示例和策略。 [https://github.com/jaredhanson/passport#strategies-1](https://github.com/jaredhanson/passport#strategies-1)

# http - node.js - 可能的 http 服务器内存泄漏

> ID：12917533
> 
> 赞同：10
> 
> 时间：2012-10-16T14:54:44.560
> 
> 标签：http, node.js, memory, post, memory-leaks

Nodejs 版本：0.8.8

这是服务器：

```
var http = require('http');
var port = 1338;
var ip = "127.0.0.1";    

http.createServer(function (req, res) {
  res.writeHead(200, {'Content-Type': 'text/plain'});
  res.end('Hi there\n');
}).listen(port, ip); 
```

客户端（php 脚本）向上述服务器发送一个 post 请求。POST 是一个字符串 (json)，大小约为 4 兆字节。

如您所见，服务器对发布的数据不做任何事情。为了调试，我删除了所有代码并返回到什么都不做的 hello world 示例:)
当我查看节点进程的内存使用情况（在 Activity Monitor、mac 应用程序中完成）时 - 它报告说每个请求的节点服务器内存使用量都越来越大。
因此，在 20 个左右的请求之后，内存使用量翻了一番。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-10-16T14:59:41.803

这不是错误。这是正常的，预期的行为。

Node.js 基于 JavaScript，这是一种垃圾收集语言。简而言之，发生的情况是内存没有立即释放，而是需要一些时间才能释放内存（例如收集垃圾）。V8（哪个节点使用）实际上有[一个非常智能的垃圾收集器](https://developers.google.com/v8/design#garb_coll)，“确保快速的对象分配、短的垃圾收集暂停和没有内存碎片”。

为了向您演示这种行为，我在 Windows 上使用 node.js 0.8.8 运行了上述脚本，并用大量 HTTP POST 请求轰炸了服务器。

Process Explorer 显示以下内存使用图：

![在此处输入图像描述](../Images/4d9f302bf73c54bf82c70110f4174b1a.png)

如您所见，内存使用量上升，直到触发垃圾收集的某个限制。清理完毕后，重新使用并重新开始爬升，直到下一次触发。

# ios - 创建 AVAssetReaderTrackOutput 时选择的最佳像素格式是什么？

> ID：12917537
> 
> 赞同：1
> 
> 时间：2012-10-16T14:55:00.610
> 
> 标签：ios, opengl-es, opengl-es-2.0, avfoundation

我正在编写代码以将 MP4 文件中的帧转换为 OpenGLES 纹理，并使用 AVAssetReaderTrackOutput 类来访问像素缓冲区。输出的最佳像素缓冲区格式是什么？现在，我正在使用旧代码在 OpenGLES 着色器中将 YUV420P 转换为 RGB，因为我之前使用 libav 来提供它。现在我正在尝试使用 AVFoundation 并想知道我的 OpenGLES 着色器是否比将像素缓冲区格式设置为 RGBA 更快，或者我是否应该使用 YUV 格式并保留我的着色器。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T15:52:53.277

我想这取决于您的数据的目的地是什么。如果您所追求的只是传递数据，那么原生 YUV 应该比 BGRA 更快。如果您需要将数据读回 RGBA 或 BGRA，我会坚持使用 BGRA 并使用 OpenGL 纹理缓存而不是 glReadPixels()。

我建议阅读有关 YUV 方法的[这个 SO 问题的答案。](https://stackoverflow.com/questions/8451149/yuv-to-rgba-on-apple-a4-should-i-use-shaders-or-neon)引用：

*“无论如何，视频帧都需要进入 GPU：如果您的视频具有 4:2:0 的采样色度，使用 YCbCr 可以为您节省 25% 的总线带宽。”*

# mysql - 查找一位或多位用户之间的对话

> ID：12917540
> 
> 赞同：1
> 
> 时间：2012-10-16T14:55:10.867
> 
> 标签：mysql, sql

我在查找给定 user_id 之间的对话时遇到问题。

SQL表：

```
+-------------------+
| conversation_user |
+-------------------+
| conversation_id   |
| user_id           |
+-------------------+ 
```

我试过了

```
SELECT `conversation_id` FROM `conversation_user` WHERE `user_id` IN (X, Y) HAVING COUNT(*) = N 
```

但它不能正常工作。知道如何选择正确的 conversation_id 吗？对话可以在一个或多个用户之间进行。

编辑：

```
+-----------------+---------+
| conversation_id | user_id |
+-----------------+---------+
|               1 |       1 | 
|               1 |       2 | 
+-----------------+---------+
|               2 |       1 | 
|               2 |       3 | 
+-----------------+---------+
|               3 |       1 | 
+-----------------+---------+
|               4 |       1 | 
|               4 |       2 | 
|               4 |       3 | 
+-----------------+---------+ 
```

假设我想获取用户 1 和 2 之间的对话。结果必须是 1，而不是 1 和 4 或 4。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T14:57:21.033

我认为你缺少`GROUP BY`条款

 ~~~~```
SELECT `conversation_id` 
FROM `conversation_user` 
WHERE `user_id` IN (X, Y) 
GROUP BY conversation_id
HAVING COUNT(DISTINCT user_id) = N 
```~~  ~~或者

```
SELECT `conversation_id` 
FROM `conversation_user` a
WHERE `user_id` IN (X, Y) 
GROUP BY conversation_id
HAVING COUNT(DISTINCT user_id) = 
    (
        SELECT COUNT(DISTINCT userid)
        FROM `conversation_user` b
        WHERE b.`conversation_id` = a.`conversation_id`
        GROUP BY b.`conversation_id`
    ) 
```

# [SQLFiddle 演示](http://sqlfiddle.com/#!2/61828/1)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-16T15:48:50.190

**更新！**我解决了这个查询的问题。

```
SELECT cu.`conversation_id` 
FROM `conversation_user` cu 
INNER JOIN (
    SELECT `conversation_id`
    FROM `conversation_user` 
    WHERE `user_id` IN (X, Y) 
    GROUP BY `conversation_id` HAVING COUNT(*) = Z 
) cu2 ON cu.conversation_id=cu2.conversation_id
GROUP BY `conversation_id` 
HAVING COUNT(*) = Z; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-16T14:59:19.903

```
 SELECT `conversation_id`,count(*) Number_of_conversations FROM `conversation_user` 
    WHERE `user_id` IN (X, Y) and 
   `user_id` not in(select `user_id` from `conversation_user` where `user_id` not in(X, Y))
    GROUP BY `conversation_id`
    HAVING COUNT(*) = 2 
```~~~~

# objective-c - UIWebview 加载不同文件切换语言

> ID：12917543
> 
> 赞同：1
> 
> 时间：2012-10-16T14:55:19.490
> 
> 标签：objective-c, ios, localization, uiwebview

我有不同语言的不同嵌入式 HTML 文件。
我想根据当前语言在 webview 中加载正确的文件。
有没有办法像 NSLocalizableString 一样简单地做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T16:44:16.233

例如，如果您使用“本地化资源”

*   “en.lproj/index.html”中“index.html”的英文版，
*   “fr.lproj/index.html”中“index.html”的法语版本，

那么很多资源函数会自动选择正确的版本（基于用户的语言设置），例如：

```
NSURL *url = [[NSBundle mainBundle] URLForResource:@"index" withExtension:@"html"]; 
```

在 Xcode 中创建本地化资源“index.html”：

*   在项目的“信息”选项卡的“本地化”部分添加所需的语言（如果您还没有这样做的话）。
*   选择“index.html”，然后在文件检查器中单击“Make Localized”。
*   在文件检查器中选择所需的语言。

现在，每种语言都有一个文件，例如“index.html（英语）”和“index.html（法语）”，当您安装应用程序时，它们会复制到相应的文件夹中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T16:16:35.423

如果对于当前语言，您的意思是电话语言，您可以通过以下方式实现目标：

```
NSString *locale = [[NSLocale preferredLanguages] objectAtIndex:0]; 
```

该方法返回一个代表当前语言的两个字母字符串，IT（意大利语），EN（英语），DE（德语）等。因此，根据语言，您应该能够加载相应的 HTML 文件。

# javascript - Jquery Kwicks 通过 Onselect 表单展开面板

> ID：12917545
> 
> 赞同：0
> 
> 时间：2012-10-16T14:55:25.137
> 
> 标签：javascript, jquery, getelementbyid, kwicks

我有一个带有下拉选择的菜单！

```
<select name="category" id="category" required><option value="0">Choose</option><button type="button" onclick="javascript:formsubmit();">Keres</button> 
```

并继续价值。我有一个 kwicks 面板：

```
 <div class='kwicks kwicks-horizontal'>
<a href='#' id='kwick1' onclick="javascript:playerrl(1);"></a>
<a href='#' id='kwick2' onclick="javascript:playerrl(2);"></a>
<a href='#' id='kwick3' onclick="javascript:playerrl(3);"></a>
<a href='#' id='kwick4' onclick="javascript:playerrl(4);"></a>
<a href='#' id='kwick5' onclick="javascript:playerrl(5);"></a>
<a href='#' id='kwick6' onclick="javascript:playerrl(6);"></a>
<a href='#' id='kwick7' onclick="javascript:playerrl(7);"></a>
</div> 
```

我的选择菜单上有一个 javascript 事件：

```
 <script>
                      function formsubmit(){
                      var cat = document.getElementById("category").value;
                      var search = document.getElementById("search").value;
                      var iframe = document.getElementById("player");
                      $(container).kwicks('expand', cat);
                      iframe.src = "video/index.php?keres="+search+"&category="+cat;
                      }
                      </script> 
```

它检查选定的值，更改 iframe src，现在不起作用的是用选定的值扩展 kwicks 面板！萤火虫 说：

```
ReferenceError: container is not defined 
```

但它在 kwicks.js 中！为什么我会收到此错误？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T16:39:15.100

`container`未定义，因为您没有在任何地方声明它。从您的代码来看，您需要的是

`$('.kwicks').kwicks('expand', cat);`

...假设这`cat`将是一个有效的面板索引。

* * *

编辑：另外，您是否粘贴了所有`<select>`标记？您粘贴的内容不是有效的标记，因为`<select>`没有关闭。

# browser - webbrowser 控件不“呈现”html

> ID：12917547
> 
> 赞同：0
> 
> 时间：2012-10-16T14:55:30.160
> 
> 标签：browser

我在使用 webbrowser 控件正确显示 html 时遇到问题。我的目标是将自定义 html 添加到 webbrowser 控件，显示它，并将其屏幕截图保存为 png。目前我正在使用 Document.OpenNew 和 Document.Write(htmlText) 和 Application.DoEvents()。但是，由于我在后台线程中运行它，有时它会死锁。我知道罪魁祸首是 Application.DoEvents() 这给我带来了麻烦。

但是，如果我删除它并将 html 直接设置为 DocumentText 属性，我怎么知道它何时完全“渲染”或加载。我使用了 DocumentCompleted 事件，但这似乎不起作用，因为即使在事件触发后保存的图像仍然是空的。

我也有线程作为 STA。

这是现有的代码：

```
Thread th = new Thread(new ThreadStart(createImage));
th.SetApartmentState(ApartmentState.STA);
th.Start();
th.Join(TIMEOUT);

private void createImage() {
 var browser = new WebBrowser();
 var doc = browser.Document;
 doc.OpenNew(false);
 doc.Write("<html><body>....</body><html>)");
 //loop for few seconds
 for(int i=0; i<20; i++)
 {
   Application.DoEvents();
   Thread.Sleep(100);
 }
 //save to file as png.
} 
```

这是我正在尝试的代码：

```
private void createImage() {
 var browser = new WebBrowser();
 bool docComplete = false;
 browser.DocumentCompleted += new WebBrowserDocumentCompletedEventHandler(
                (Object sender, WebBrowserDocumentCompletedEventArgs args) =>
                { docComplete = true; }
                );
 browser.DocumentText = "<html>.....";
 while (!_docComplete)
 {                    
    Thread.Sleep(100);
  }
 // save image
 // :-( not working
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T15:13:42.417

您必须将线程创建为 STA，这只是在后台线程中运行 WebBrowser 的方式。

```
bw.SetApartmentState(ApartmentState.STA); 
```

[HtmlDocument.Write Method](http://msdn.microsoft.com/en-us/library/system.windows.forms.htmldocument.write.aspx)中没有关于等待的信息。如果还需要，那么您可以添加 DocumentCompleted 处理程序而不是 DoEvents

```
private void captureImageThread(string html) { 
   var thread = new Thread(() => { 
       var browser = new WebBrowser(); 
       browser.DocumentCompleted += browser_DocumentCompleted; 
       browser.DocumentText = html;
       Application.Run(); 
   }); 
   thread.SetApartmentState(ApartmentState.STA); 
   thread.Start(); 
} 

void browser_DocumentCompleted(object sender, WebBrowserDocumentCompletedEventArgs e) { 
   var br = sender as WebBrowser; 
   // save image here
   Application.ExitThread();   // Stops the thread 
} 
```

# jquery - if-else 语句在 jquery 中不起作用

> ID：12917552
> 
> 赞同：-1
> 
> 时间：2012-10-16T14:55:42.927
> 
> 标签：jquery

我有这个代码。但它不起作用。请帮忙！！！

```
if ($('#list1img').is(':visible')) {
  $('#list1img').attr('src','f-left.jpg');
} else {
  $('#list1img').attr('src','f-down.jpg');
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T15:13:01.550

我将假设您遇到与我一分钟前相同的问题。问题是，我在页面中有一个模式，并且有两个不同的 div 具有相同的 class `errorbox`。模态有一个 id，所以我继续这样做：

```
if ($('.errorbox', $('#modalId')).is(':visible'))
    $('ul', $('.errorbox')).html('');
else
    $('.errorbox').show(); 
```

希望有帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T15:01:12.327

**[从我的FIDDLE](http://jsfiddle.net/toroncino/cexkk/)**可以看出，它工作正常。

您确定您使用了正确的**CSS 显示**（块、无、内联块等）吗？

# compilation - 如何将服务器应用程序编译到某个目的地（只有 Makefile）

> ID：12917553
> 
> 赞同：0
> 
> 时间：2012-10-16T14:55:42.453
> 
> 标签：compilation, makefile

***无济于事，我尝试将代码编译到特定的位置。如何将服务器应用程序编译到某个目的地（只有 Makefile）？***

试过：

```
make DESTDIR=/opt/mydeamon 
```

但这失败了

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T15:35:51.223

Make 本身没有标准的安装方式。如果使用 Makefile 完成安装，则由 Makefile 作者编写有关 make 应该如何执行的规则。

但是它提供`make install`目标的常用方法，我认为指定安装路径的常用变量是`PREFIX`.

如果这是您在某处下载的源包，您可能应该阅读一些 README 或 INSTALL 文件，甚至检查 Makefile 文件以获取说明。

# sql - 在 SQL Server 中将逗号分隔的字符串转换为 bigint

> ID：12917555
> 
> 赞同：1
> 
> 时间：2012-10-16T14:55:57.960
> 
> 标签：sql, sql-server-2008, tsql

我有一个用逗号分隔的 varchar 字符串，我想在我的 SQL 脚本中使用它，但我需要与数据库中的 bigint 字段进行比较。需要知道转换它：

```
DECLARE @RegionID varchar(200) = null
SET @RegionID = '853,834,16,467,841,460,495,44,859,457,437,836,864,434,86,838,458,472,832,433,142,154,159,839,831,469,442,275,840,299,446,220,300,225,227,447,301,450,230,837,441,835,302,477,855,411,395,279,303'

SELECT a.ClassAdID,    -- 1
        a.AdURL,        -- 2
        a.AdTitle,      -- 3
        a.ClassAdCatID, -- 4
        b.ClassAdCat,   -- 5
        a.Img1,         -- 6
        a.AdText,       -- 7
        a.MemberID,     -- 9
        a.Viewed,       -- 10
        c.Domain,       -- 11
        a.CreateDate    -- 12
        FROM ClassAd a  
        INNER JOIN ClassAdCat b ON b.ClassAdCAtID = a.ClassAdCAtID
        INNER JOIN Region c ON c.RegionID = a.RegionID
        AND a.PostType = 'CPN'
        AND DATEDIFF(d, GETDATE(), ExpirationDate) >= 0
        AND a.RegionID IN (@RegionID)
        AND Viewable = 'Y' 
```

这失败并出现以下错误：

```
Error converting data type varchar to bigint. 
```

RegionID 在数据库中是一个 bigint 字段.. 需要将 varchar 转换为 bigint.. 有什么想法..？

提前谢谢了，

新杰克

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-16T15:01:35.637

创建这个函数：

```
CREATE function [dbo].[f_split]
(
@param nvarchar(max), 
@delimiter char(1)
)
returns @t table (val nvarchar(max), seq int)
as
begin
set @param += @delimiter

;with a as
(
select cast(1 as bigint) f, charindex(@delimiter, @param) t, 1 seq
union all
select t + 1, charindex(@delimiter, @param, t + 1), seq + 1
from a
where charindex(@delimiter, @param, t + 1) > 0
)
insert @t
select substring(@param, f, t - f), seq from a
option (maxrecursion 0)
return
end 
```

改变这部分：

```
AND a.RegionID IN (select val from dbo.f_split(@regionID, ',')) 
```

更改此项以获得更好的整体性能：

```
AND DATEDIFF(d, 0, GETDATE()) <= ExpirationDate 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-16T15:02:22.563

您的查询不知道这些是单独的值，您可以为此使用动态 sql：

```
DECLARE @RegionID varchar(200) = null
SET @RegionID = '853,834,16,467,841,460,495,44,859,457,437,836,864,434,86,838,458,472,832,433,142,154,159,839,831,469,442,275,840,299,446,220,300,225,227,447,301,450,230,837,441,835,302,477,855,411,395,279,303'

declare @sql nvarchar(Max)

set @sql = 'SELECT a.ClassAdID,    -- 1
        a.AdURL,        -- 2
        a.AdTitle,      -- 3
        a.ClassAdCatID, -- 4
        b.ClassAdCat,   -- 5
        a.Img1,         -- 6
        a.AdText,       -- 7
        a.MemberID,     -- 9
        a.Viewed,       -- 10
        c.Domain,       -- 11
        a.CreateDate    -- 12
        FROM ClassAd a  
        INNER JOIN ClassAdCat b ON b.ClassAdCAtID = a.ClassAdCAtID
        INNER JOIN Region c ON c.RegionID = a.RegionID
        AND a.PostType = ''CPN''
        AND DATEDIFF(d, GETDATE(), ExpirationDate) >= 0
        AND a.RegionID IN ('+@RegionID+')
        AND Viewable = ''Y'''

exec sp_executesql @sql 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-16T15:13:32.363

我有时会使用这个方法，发现它非常好。它将逗号分隔的字符串转换为 AUX 表（称为#ARRAY），然后根据 AUX 表查询主表：

```
declare @RegionID varchar(50)
SET @RegionID = '853,834,16,467,841,460,495,44,859,457,437,836,864,434,86,838,458,472,832,433,142,154,159,839,831,469,442,275,840,299,446,220,300,225,227,447,301,450,230,837,441,835,302,477,855,411,395,279,303'
declare @S varchar(20)
if LEN(@RegionID) > 0 SET @RegionID = @RegionID + ',' 
CREATE TABLE #ARRAY(region_ID VARCHAR(20))

WHILE LEN(@RegionID) > 0 BEGIN
   SELECT @S = LTRIM(SUBSTRING(@RegionID, 1, CHARINDEX(',', @RegionID) - 1))
   INSERT INTO #ARRAY (region_ID) VALUES (@S)
   SELECT @RegionID = SUBSTRING(@RegionID, CHARINDEX(',', @RegionID) + 1, LEN(@RegionID))
END

select * from your_table
where regionID IN (select region_ID from #ARRAY) 
```

它避免了您连接查询字符串然后使用 EXEC 执行它，我认为这不是一个很好的方法。

如果您需要两次运行代码，则需要删除临时表

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-16T15:19:59.510

我认为答案应该保持简单。
尝试像这样使用 CHARINDEX：

```
DECLARE @RegionID VARCHAR(200) = NULL 

SET @RegionID = 
'853,834,16,467,841,460,495,44,859,457,437,836,864,434,86,838,458,472,832,433,142,154,159,839,831,469,442,275,840,299,446,220,300,225,227,447,301,450,230,837,441,835,302,477,855,411,395,279,303'

SELECT 1 
WHERE  Charindex('834', @RegionID) > 0 

SELECT 1 
WHERE  Charindex('999', @RegionID) > 0 
```

当`CHARINDEX`在大字符串变量中找到值时，它将返回它的位置，否则返回0。
将其用作搜索工具。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-16T15:27:34.170

更改此查询的最简单方法是将`IN`函数替换为字符串函数。这是我认为最安全的方法`LIKE`（可在数据库之间移植）：

```
 AND ','+@RegionID+',' like '%,'+cast(a.RegionID as varchar(255))+',%' 
```

或者`CHARINDEX`：

```
 AND charindex(','+cast(a.RegionID as varchar(255))+',', ','+@RegionID+',') > 0 
```

但是，如果您明确地将列表放入代码中，为什么不使用临时表呢？

```
declare @RegionIds table (RegionId int);
insert into @RegionIds
    select 853 union all
    select 834 union all
    . . .
    select 303 
```

然后您可以在`IN`子句中使用该表：

```
 AND a.RegionId in (select RegionId from @RegionIds) 
```

或在一个`JOIN`子句中。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-06-17T18:15:29.350

我喜欢 Diego 的回答，但我认为我的修改要好一些，因为您是在声明一个表变量而不是创建一个实际的表。我知道“in”语句可能有点慢，所以我做了一个内部连接，因为无论如何我都需要 Company 表中的一些信息。

```
declare @companyIdList varchar(1000)
set @companyIdList = '1,2,3'

if LEN(@companyIdList) > 0 SET @companyIdList = @companyIdList + ',' 
declare @CompanyIds TABLE (CompanyId bigint)
declare @S varchar(20)
WHILE LEN(@companyIdList) > 0 BEGIN
   SELECT @S = LTRIM(SUBSTRING(@companyIdList, 1, CHARINDEX(',', @companyIdList) - 1))
   INSERT INTO @CompanyIds (CompanyId) VALUES (@S)
   SELECT @companyIdList = SUBSTRING(@companyIdList, CHARINDEX(',', @companyIdList) + 1, LEN(@companyIdList))
END

select d.Id, d.Name, c.Id, c.Name 
from [Division] d 
    inner join [Company] c on d.CompanyId = c.Id
    inner join @CompanyIds cids on c.Id = cids.CompanyId 
```

# branching-and-merging - TFS 分支和合并策略 - 多个应用程序、多个开发团队、每月发布（但也需要支持超出 rels 的更改）

> ID：12917558
> 
> 赞同：2
> 
> 时间：2012-10-16T14:56:08.117
> 
> 标签：branching-and-merging

我们正在寻找有关 TFS 和多个应用程序（一些是 COTS；一些是内部开发）的分支和合并的指导，并与多个开发团队合作。请注意，我们目前使用每月发布窗口，但将每季度发布一次。我们还需要能够支持 eFixe 和非发布开发工作（即：必须在窗口外实施的监管变更）。根据目前的研究，我们正在集中精力研究以下两个选项：

选项 1) 每个主要应用程序的发布分支，其中每个应用程序将具有 MAIN、RELEASE 和 PRODUCTION 分支（生产分支将支持 eFix 分支，该分支将支持 eFix 和非周期更改）。

选项 2) 整个组织的发布分支 - MAIN、RELEASE 和 PRODUCTION 分支将包含所有应用程序。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-30T10:22:13.473

这里有一些有用的分支建议：

[Visual Studio Team Foundation Server 分支和合并指南](http://vsarbranchingguide.codeplex.com/)

WRT到你的问题我的观点是

选项 1) 单独的应用程序发布分支

这是如果您的应用程序之间没有太多的依赖关系（如果有的话）。

优点：

*   构建会更快
*   为 Cherry 挑选部署组件提供更大的灵活性
*   更适合持续集成构建，因为您可以很少且经常构建和部署
*   根据您的质量质量门签署和锁定个别应用程序
*   更容易重新部署关键修复
*   合并更小，可能更频繁

缺点：

*   维护构建/部署脚本的可能管理开销
*   如果存在应用程序依赖关系可能会在挑选组件时引入风险
*   需要可靠的部署框架来维护程序集版本和标签。
*   部署时会涉及多个部署资产资源（而不是1个部署包）

选项 2) 所有应用程序发布分支

优点：

*   更容易随时识别所有应用的版本，
*   可以使用 Teardown 和完全部署进行部署，
*   更少的构建和部署脚本需要管理
*   减少部署资产资源来管理。
*   更容易跟踪/可视化发布级别的合并/变更集

缺点：

*   构建可能需要更长的时间
*   如果应用程序不适合用途或在代码冻结/注销后包含错误，则发布灵活性会降低
*   更难挑选部署组件
*   生产关键修复可能需要更长的时间才能重建和部署
*   回滚是全有还是全无，取决于部署框架
*   可能需要对次要修复部署进行完整的回归测试（取决于 QA 控制）

# objective-c - 通过 UIbutton objective-c 调用位于不同文件夹的 html 页面

> ID：12917561
> 
> 赞同：0
> 
> 时间：2012-10-16T14:56:15.107
> 
> 标签：objective-c, ios, xcode, ipad, uibutton

我有一个带有 4 个按钮的页面，它是`UIViewController`，在我的应用程序中，我有 4 个文件夹，在每个文件夹中我有一个 html 文件，我还有另一个`webViewController`我应该在其中加载这个 html 文件`webViewController`，我的意思是当单击第一个按钮时加载第一个 html ，如果单击第二个加载第二个 html 和....你能帮我实现这个吗：

这是我的方法：

```
-(void)loadWebView{

NSURL *url = [NSURL fileURLWithPath:[ [ NSBundle mainBundle ] pathForResource:  
@"TestName/TestName1/Test1Name1" ofType:@"html" ]];
NSURLRequest *request = [NSURLRequest requestWithURL:url];
[webView loadRequest:request];
} 
```

我怎样才能把这样的地址放到我的方法中

```
@"TestName/TestName1/Test1Name1" 

 I mean @"TestName%d/TestName%d/Test%dName" ofType:@"html" 
```

并将我的按钮设置为当单击第一个按钮进入第一个文件夹 1 并加载 html 时单击第二个按钮进入第二个文件夹 1 并加载 html 等等...

这是我的按钮

```
- (IBAction)ActionButton1:(id)sender {
NSLog(@"A1");
[self.webViewController loadWebView];
}

- (IBAction)ActionButton2:(id)sender {
NSLog(@"A1");
[self.webViewController loadWebView];
} 
```

. . . .

提前致谢！

编辑：

文件结构文件夹

```
TestName1

     TestName1

        TestName1.html 
```

第二

```
TestName2

     TestName2

        TestName2.html 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T15:10:09.883

只需向您的`loadWebView`方法添加一个参数（一个int）并相应地创建文件路径......

就像是

```
-(void)loadWebView:(int)htmlNum{

    NSString *htmlPath = [NSString stringWithFormat:@"TestName/TestName%d/Test%dName%d",htmlNum,htmlNum,htmlNum];
    NSURL *url = [NSURL fileURLWithPath:[[NSBundle mainBundle] pathForResource:htmlPath ofType:@"html"]];
    NSURLRequest *request = [NSURLRequest requestWithURL:url];
    [webView loadRequest:request];
} 
```

然后，您为您的按钮创建一个正确调用它的方法（例如，为您的按钮分配一个标签可以真正简化您的代码：所有按钮的一种方法......）

```
- (IBAction)ActionButton:(UIButton*)sender {
    [self.webViewController loadWebView:sender.tag];
} 
```

# asp.net - 子文件夹中忽略的 ASP.NET web.config 授权设置

> ID：12917564
> 
> 赞同：7
> 
> 时间：2012-10-16T14:56:30.673
> 
> 标签：asp.net, asp.net-mvc, asp.net-mvc-2, authorization

我正在使用 asp.net mvc 2 和 vs 2008。

我正在尝试使用表单授权制作网站。当我试图限制对某些页面的访问时，我正在使用 asp.net 管理工具。例如，我创建规则以拒绝匿名用户访问整个网站。正如预期的那样，管理工具在根 web.config 文件中添加了以下部分：

```
 <authorization>
   <deny users="?" />
  </authorization> 
```

当我在某个子文件夹中执行相同操作时，例如 %ApplicationRoot%/View/Protected，管理工具也如预期的那样在提到的子文件夹中添加 web.config 文件，代码如下：

```
 <configuration>
<system.web>      
    <authorization>
        <deny users="UserName" />
    </authorization>
</system.web> 
```

这些文件之间的主要区别在于 root web.config 授权部分有一些效果（一般来说，它按计划工作 - 拒绝来自整个网站的所有未经身份验证的用户）。但是子文件夹 web.config 授权部分根本没有效果。我发现然后添加到根配置文件，下面的代码

```
 <location path="Protected">
  <authorization>
    <deny users="UserName" />
   </authorization>
 </location> 
```

做得很好 - 它按计划拒绝 %UserName% 访问位于 %ApplicationRoot%/View/Protected 文件夹中的所有视图。
这种行为与 cassini 和 iis 相似，我都尝试过。

主要问题是我需要一种管理工具来完成这项工作，所以我寻求任何有关问题的帮助 - 为什么当 web.config 位于子文件夹中时授权部分不起作用？

PS 我试图在子文件夹的 web.config之间`<authorization>`和中放置不正确的代码：`</authorization>`

```
 <authorization>
    asdfg
   </authorization> 
```

没有效果。由于某些问题，可能整个部分都被忽略了？

PPS 同一文件中授权部分的代码不正确会导致错误

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-09T14:19:15.143

您的问题是您的应用程序不是经典的 ASP.NET Web 窗体应用程序。您正在尝试做的事情将在 Web 窗体中完美运行，但在 MVC 中却不行。

在 MVC 世界中，当浏览器请求页面 /People/SmartList 时，不一定会显示项目中的 /People/SmartList.cshtml。事实上，您的项目甚至根本没有 /People/ 文件夹。MVC 引擎将显示的视图（.cshtml 文件）由路由决定。当 MVC 路由引擎访问那些 .cshtml 文件时，它根本不会查看您的 web.config 文件。现在，您可以看到为什么您的 web.conig 文件被忽略了。

但是您仍然可以进行授权。而不是使用 web.config 文件，您应该使用该`[Authorize]`属性并将其应用于适当的控制器的操作方法，甚至应用于整个控制器类。

```
[Authorize(Users="UserName")]
public ActionResult ShowRestrictedData()
    ... 
```

# android - Galaxy Tab 10.1 串口适配器

> ID：12917565
> 
> 赞同：0
> 
> 时间：2012-10-16T14:56:31.017
> 
> 标签：android, serial-port, adapter, galaxy, galaxy-tab

市场上是否有用于 Galaxy Tablet 10.1 的预制串口适配器？还是您必须自己拼凑这样的东西？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T17:01:07.733

[我在亚马逊](https://rads.stackoverflow.com/amzn/click/com/B0072JG9S4)上找到了适用于 Galaxy 的 9 针 USB 适配器

使用它，我能够将标准 USB 转串口适配器连接到它，并使我的 Galaxy 与我的设备同步。

# wpf - 在静态方法中使用 WPF 检测设计模式

> ID：12917566
> 
> 赞同：6
> 
> 时间：2012-10-16T14:56:30.270
> 
> 标签：wpf, static, designmode

我正在使用 WPF。我有一个静态类，它执行一些在设计模式下不可用的设置。此构造函数在设计模式下由窗口调用，这会导致引发异常。

如何在静态方法中检测设计模式，以便调用适当的设计模式行为？

[推荐](https://stackoverflow.com/questions/425760/is-there-a-designmode-property-in-wpf)的方法不适用于静态方法。

* * *

编辑：

静态构造函数是从 xaml 调用的，所以我不能有条件地调用它（除非我将调用移至代码隐藏，我想避免这种情况）。

在窗口中：`<Window ... HelpProvider.Keyword="some_help_topic.html">`

在课堂里：

```
static HelpProvider()
{
    // Load the .chm file from an application setting (this fails at design time)

    // Add a WPF command binding
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-16T18:11:19.487

在 xaml 文件中保留附加属性的可能解决方法是：

1.  将初始化代码从静态构造函数移动到附加属性更改回调。坦率地说，在静态构造函数中做这种工作并不是一个好习惯。
2.  在您附加的属性更改回调中，您有一个对您的窗口的引用。因此，您可以致电`DesignerProperties.GetIsInDesignMode(yourwindow)`并决定是否需要加载文件或任何导致问题的原因。

# ruby-on-rails - Ruby on Rails，修剪文本

> ID：12917568
> 
> 赞同：0
> 
> 时间：2012-10-16T14:56:33.967
> 
> 标签：ruby-on-rails, ruby, string, web

为什么这段代码不起作用？

```
<%= truncate(post.text, :length => post.text.rindex(".", 500)) %> 
```

我需要在第 500 个符号之前修剪最后一个点上的文本。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-16T15:05:21.083

使用该`:separator`选项。它将在 500 个字符之前的点处截断

`truncate(post.text, :length => 500, :separator => '.')`

# cmd - cmd 'patch' 不是内部/外部命令、可运行程序或批处理文件

> ID：12917569
> 
> 赞同：7
> 
> 时间：2012-10-16T14:56:48.287
> 
> 标签：cmd

我正在尝试修补我的 wordpress 安装以防止用户枚举。我找到了一个补丁 -[这里](http://blog.hacktalk.net/block-wordpress-user-enumeration-secure-wordpress-against-hacking/)

它说要使用它我需要导航到站点根文件夹，添加补丁文件然后使用 cmd 运行它， `patch -p0 <wpuserEnum.patch`

当我按回车键时，我得到“补丁”未被识别为内部/外部命令、可运行程序或批处理文件“消息

不是最有用的错误报告。我整天都在谷歌上搜索这个问题，但没有找到任何关于“补丁”的解决方案

我检查了 PATH 并且那里有一个 C:\Windows\System32 路径

任何人都可以阐明正在发生的事情以及原因吗？

我正在运行 Windows Server 2008。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-16T15:09:31.730

[补丁](http://en.wikipedia.org/wiki/Patch_%28Unix%29)不是 Windows 的一部分，因此除非您自己安装，否则不会安装它。您可以将它作为 GnuWin32 项目的一部分 - [http://gnuwin32.sourceforge.net/packages/patch.htm](http://gnuwin32.sourceforge.net/packages/patch.htm)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-09-17T13:55:42.063

您需要编辑您的系统环境变量，然后将patch.exe的路径（在GnuWin32\bin中）添加到PATH环境变量中......重新启动cmd后，应该可以识别补丁......

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2020-12-09T18:16:43.383

我不认为 GnuWin32 适用于 Win10（至少他们在他们的网站上只提到了 Win7）。最安全的方法（对我有用）是适用于 Windows 的 Git：[https](https://git-scm.com/download/win) ://git-scm.com/download/win 它在 Git\usr\bin 文件夹中有 patch.exe。只需将其添加到您的路径即可！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-08-04T10:14:20.730

它帮助我运行下一个命令：

```
npm i patch-package 
```

（从这里：[https](https://www.npmjs.com/package/patch-package) ://www.npmjs.com/package/patch-package ）

# google-apps-script - 我怎么知道锚链接是否被点击？

> ID：12917570
> 
> 赞同：0
> 
> 时间：2012-10-16T14:56:51.360
> 
> 标签：google-apps-script

**我想知道是否单击了锚链接。**

我动态添加锚链接并使用它们的名称文件设置 id，但我不知道我的 Spreadshett 中“点击”的单元格的数量有多少。

```
For ex: the id of file "test.pdf" --> test; 
```

在电子表格中：

```
ex:

ColumA  <namefile>: test.pdf
ColumB  <linkfile>: https://docs.google.com/document/d/1PiMj.....jramcs
ColumC  <cliked>: 1 
```

我预计如果我点击了我的锚点，我的函数可以知道点击了哪个锚点，并且在适当行的列 C 中的数量为“1”。

```
var html = app.createAnchor(nf, hf).setId(nf); 
```

我正在尝试制作类似的东西：

```
var html = app.createAnchor(nf, hf).setId(nf).addClickHandler(app.createServerHandler("sumDoc").addCallbackElement(flexTableDoc)); 
```

***¿ 但是我怎么知道函数 sumDoc 中点击了哪个锚点？***

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T15:27:06.000

我认为您可以使用客户端处理程序和文本框来实现这一点（最后一个可以可见或不可见）。

```
 var clickedItem = app.createTextBox().setName('clickedItem') 
```

在每个锚点上添加这样的 clickHandler

```
 var handler = app.createClientHandler().forTargets(clickedItem).setText(Anchorname);
    anchor.addClickHandler(handler) 
```

在服务器处理程序中，您将获得 textBoxValue

```
var clickedItem = e.parameter.clickedItem; 
```

如果您想要更准确的代码，您应该提供用于创建带有锚的 UI 的代码

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-17T07:15:31.007

这也是可能和简单的，像你说的那样格式化你的锚。

```
var html = app.createAnchor(nf, hf).setId(nf).addClickHandler(app.createServerHandler("sumDoc").addCallbackElement(flexTableDoc)); 
```

现在你的返回函数：

```
function sumDoc(e){
  //this will return the value of the ID of the element thats clicked so in this case its test.pdf
  var linkId = e.parameter.source;     
} 
```

我希望这是有用的

# c# - Elasticsearch 是否应该安装在与站点相同的服务器上？

> ID：12917579
> 
> 赞同：1
> 
> 时间：2012-10-16T14:57:02.657
> 
> 标签：c#, asp.net-mvc, optimization, elasticsearch

我正在开发一个 ASP.NET MVC 4 商务网站，但由于我的背景是使用 HTML/CSS/Javascript 和使用 XNA 的 C# 的前端 Web 开发，所有这些服务器和数据库业务都在我头上。

目前该站点使用带有 NEST 的弹性搜索索引来执行产品搜索，因为产品数据库很大，我喜欢弹性搜索提供的智能查询。这一切都适用于我的本地测试环境。

我的问题是：将您的弹性搜索客户端和索引存储在与实际站点不同的主机上通常是一个好主意，还是可以将它放在同一台服务器上？
我知道这里存在空间问题，但我听说弹性搜索查询也会占用服务器资源，这些资源可以更好地用于处理其他任务，比如即将到来的大量付款？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T16:37:52.973

这实际上取决于您的负载、数据和当前服务器。您的网站上有多少用户？你的索引有多大？您当前的服务器有多强大？

将 elasticsearch 放在单独的机器上通常是最佳实践，甚至不止一台机器，以便充分利用其分布式特性。例如，对于两台机器，您可以在它们上分配分片并配置一个副本（默认值），以便每台机器都包含数据的完整副本。如果负载增加，您可以随时向集群添加新节点，只要您分配了足够的分片（通常的做法是稍微过度分配分片）。

另一方面，我还在 Java 应用程序中使用了它，您可以在我最近写的[这篇文章中看到。](http://blog.orange11.nl/2012/09/13/elasticsearch-beyond-big-data-running-elasticsearch-embedded/)

# c# - 如何将内部文本插入空的 xml 元素？

> ID：12917584
> 
> 赞同：7
> 
> 时间：2012-10-16T14:57:31.083
> 
> 标签：c#, asp.net, xml, xmldocument

我有一个要加载 xml 的 xmldocument。

xml 看起来像这样：

```
<Table1>
  <buyer_id>0</buyer_id>
  <buyername>CompanyA</buyername>
  <address1>123 Simpsons Dr.</address1>
  <address2/>
  <city>Springfield</city>
  <state>ST</state>
  <postalcode>12345</postalcode>
  <eaddress/>
  <phone/>
  <fax/>
</Table1> 
```

我正在循环查看每个 CompanyA 条目并相应地设置内部文本。我正在使用以下代码将内部文本插入到符合条件的元素中：

```
XmlDocument dom = new XmlDocument();
dom.LoadXml(xmlString);

XmlNodeList elemList = dom.GetElementByTagName("Table1");
for(int i = 0; i < elemList.Count; i++)
{
   if(dom.GetElementsByTagName("buyername").Item(i).InnerText.Contains("CompanyA")
   {
      dom.GetElementsByTagName("address1").Item(i).InnerText = "SomeInfo";
   }
} 
```

使用上面的代码，address1(123 Simpsons Dr.) 的值将被“SomeInfo”替换。我想将“SomeInfo”插入到 address2 元素中，但是当我尝试使用时：

```
dom.GetElementsByTagName("address2").Item(i).InnerText = "SomeInfo"; 
```

我得到一个错误。我可以将内部文本插入到任何已经有值的元素中，但是当元素为空时（例如`<address2/>`）我不能。想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-16T15:05:19.803

使用**LINQ2XML。**它完全替代了其他 XML api，比如肮脏的老白痴`XmlDocument`

```
XElement doc=XElement.Load("yourXml.xml");

foreach(var elm in doc.Descendants("Table1"))
{
if(elm.Element("buyername").Value=="CompanyA")
elm.Element("address2").Value="SomeInfo";
}
doc.Save("yourXml.xml"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T15:07:57.693

检查 address2 xml 标签是否为空。如果是，请转到其父级并删除标签，然后再次添加具有值的相同标签。如果否，则将内部文本分配给 address2。

如果您需要代码，请告诉我。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-16T15:41:48.877

在 LINQ to XML 中使用[SetElementValue方法：](http://msdn.microsoft.com/en-us/library/system.xml.linq.xelement.setelementvalue.aspx)

```
XDocument doc = XDocument.Load(FilePath); //replace with xml file path
IEnumerable<XElement> buyersList = doc.Descendants("Table1"); //get the table node.
var ele = (from buyer in buyersList
           where buyer.Element("buyername").Value == "CompanyA"
           select buyer).SingleOrDefault(); 
ele.SetElementValue("address1", "SomeInfo");
ele.SetElementValue("address2", "SomeInfo");
doc.Save(FilePath); 
```

**演示**：http: [//ideone.com/Cf7YI](http://ideone.com/Cf7YI)

# perl - perl 脚本中 bash 脚本的输出

> ID：12917585
> 
> 赞同：0
> 
> 时间：2012-10-16T14:57:33.060
> 
> 标签：perl, bash

我想在 perl 脚本中嵌入一个 bash 脚本。我想通过从 perl 脚本中获取一些变量来运行我的 bash 脚本。一旦获得变量，bash 脚本就会接管并尝试输出在其中创建的文件。

如何将 perl 脚本变量传递给我的 bash 脚本？

我不知道 perl，但根据我在 Google 中阅读的内容，我可以将我的 bash 脚本嵌入为

```
system("get_files.cmd -yr ${year}"); 
```

我的 bash 脚本在哪里`get_files.cmd`。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T15:04:32.607

Expect 模块本质上可以自动执行 shell 任务，例如运行脚本和传递 perl 变量。这样：

```
Use Expect;

  # create an Expect object by spawning another process
  my $exp = Expect->spawn($command, @params)
    or die "Cannot spawn $command: $!\n"; 
```

[http://search.cpan.org/~rgiersig/Expect-1.15/Expect.pod](http://search.cpan.org/~rgiersig/Expect-1.15/Expect.pod)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T15:07:02.970

我认为如果您将它们作为参数传递给您的 bash 脚本可能会更好。

perl 调用：

```
system("get_files.cmd ${var1} ${var2}"); 
```

bash 脚本

```
var1="$1"
var2="$2"
... 
```

其中`$1`,`$2`是命令行中传递的参数（按顺序）。请注意，您可以使用`$#`bash 变量来获取传递的参数数量。

希望这会有所帮助=)

# python - 从文本文件中读取多个数字

> ID：12917588
> 
> 赞同：10
> 
> 时间：2012-10-16T14:57:34.950
> 
> 标签：python, text, python-3.x, numbers

我是 python 编程的新手，需要帮助。

我有一个包含多个数字的文本文件，如下所示：

```
12 35 21
123 12 15
12 18 89 
```

我需要能够读取每行的各个数字才能在数学公式中使用它们。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-10-16T14:59:35.417

在 python 中，您从文件中读取一行作为字符串。然后，您可以使用该字符串来获取您需要的数据：

```
with open("datafile") as f:
    for line in f:  #Line is a string
        #split the string on whitespace, return a list of numbers 
        # (as strings)
        numbers_str = line.split()
        #convert numbers to floats
        numbers_float = [float(x) for x in numbers_str]  #map(float,numbers_str) works too 
```

我已经通过一系列步骤完成了这一切，但你经常会看到人们将它们结合起来：

```
with open('datafile') as f:
    for line in f:
        numbers_float = map(float, line.split())
        #work with numbers_float here 
```

* * *

最后，在数学公式中使用它们也很容易。首先，创建一个函数：

```
def function(x,y,z):
    return x+y+z 
```

现在遍历调用该函数的文件：

```
with open('datafile') as f:
    for line in f:
        numbers_float = map(float, line.split())
        print function(numbers_float[0],numbers_float[1],numbers_float[2])
        #shorthand:  print function(*numbers_float) 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-10-16T15:04:07.057

另一种方法是使用`numpy`名为 的函数`loadtxt`。

```
import numpy as np

data = np.loadtxt("datafile")
first_row = data[:,0]
second_row = data[:,1] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-16T15:04:17.027

如果您将文件命名为 numbers.txt，这应该可以工作

```
def get_numbers_from_file(file_name):
    file = open(file_name, "r")
    strnumbers = file.read().split()
    return map(int, strnumbers)

print get_numbers_from_file("numbers.txt") 
```

这必须返回 [12, 35, 21, 123, 12, 15, 12, 18, 89] 在您可以使用 list_variable[intergrer] 单独选择每个数字之后

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-16T15:05:58.537

以下代码应该可以工作

```
f = open('somefile.txt','r')
arrayList = []
for line in f.readlines():
    arrayList.extend(line.split())
f.close() 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-06-27T01:43:54.023

如果您想在命令行中使用文件名作为参数，则可以执行以下操作：

```
 from sys import argv

    input_file = argv[1]
    with open(input_file,"r") as input_data:
        A= [map(int,num.split()) for num in input_data.readlines()]

    print A #read out your imported data 
```

否则你可以这样做：

```
 from os.path import dirname

    with open(dirname(__file__) + '/filename.txt') as input_data:
        A= [map(int,num.split()) for num in input_data.readlines()]

    print A 
```

# c++ - 修改后的随机数生成器

> ID：12917593
> 
> 赞同：0
> 
> 时间：2012-10-16T14:58:03.690
> 
> 标签：c++, math, random, probability

> **可能重复：**
> [具有不同概率的随机数](https://stackoverflow.com/questions/12885356/random-numbers-with-different-probabilities)

我必须编写一个函数，该函数将接受一个参数并`p = either 0.25 or 0.5 or 0.75`返回`yes / no`. `Probablity(yes) = p`因为我有统一的随机数生成器，所以`rand()`我的想法是

```
//representing yes -> '1' and no -> '0'
char myRandom(double d){
    char array[4];
    if (p(yes) == 0.25) strcpy(arr,"1000");
    if (p(yes) == 0.50) strcpy(arr,"1100");
    if (p(yes) == 0.75) strcpy(arr,"1110");
    return arr[rand(0,4)];
} 
```

我知道如果有更多的可能性，它是没有效率的。但除此之外，我的想法有什么错误吗？如果有那么在哪里？

# google-apps-script - 在 Google Apps 脚本中的图表上过滤日期范围

> ID：12917594
> 
> 赞同：2
> 
> 时间：2012-10-16T14:58:06.803
> 
> 标签：google-apps-script, google-visualization

我有一个电子表格，其中包含近十年前的每月数据，并且正在为这个和其他类似的表格创建一个仪表板。

我正在尝试过滤数据表以获取显示过去 12 个月数据的图表。我尝试使用 getTime() 或 valueOf() 在日期上使用数字范围过滤器，但是当我使用 date.valueOf() 设置最小值时，两者都拒绝构建过滤器（我假设是因为大小）。我还使用 viewWindow 尝试了下面链接中的解决方案，但失败了。 [日期范围谷歌图表工具](https://stackoverflow.com/questions/9180519/date-range-google-chart-tools)

我知道这可以通过可视化 API 来完成，但不幸的是，我为此坚持使用 Google Apps 脚本。我正在尝试对所有内容都使用一个数据表，但如果这是不可能的，我可以创建一个只有 12 行的单独数据表。我真的希望让用户加载自定义的时间范围，但是 GAS 中没有 ChartRangeFilter。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T21:20:44.383

如您所见，NumberRangeFilter 不适用于日期，并且 Apps 脚本目前不支持任何其他范围过滤器。我采用的一种解决方法是将日期转换为数字，并使用 NumberRangeFilter 过滤它们。例如，“2012 年 10 月 19 日”可以转换为“20121019”。

为了避免由于 20121031 和 20121101 之间的整体导致图表出现奇怪的跳跃，您需要在数字日期上设置过滤器，但使用 DataViewDefinition 仅在图表中显示实际日期。

这是一段粗略的示例代码。第 0 列是实际日期，1 是数字日期，2 和 3 是我要绘制的值。

```
var dateFilter = Charts.newNumberRangeFilter()
    .setFilterColumnIndex(1)
    .build();
var view = Charts.newDataViewDefinition()
    .setColumns([0, 2, 3]);
var areaChart = Charts.newAreaChart()
    .setDataViewDefinition(view)
    .setStacked()
    .setDimensions(800, 400)
    .build(); 
```

# xpath - 基于多个规则的 xpath

> ID：12917599
> 
> 赞同：0
> 
> 时间：2012-10-16T14:58:25.490
> 
> 标签：xpath

我有以下规则来匹配可以正常工作的图像

```
//div[@class="wp-caption alignright" or @class="area"]//img 
```

问题是页面是动态创建的，现在它在我需要匹配的图像之前包含另一个图像，所以我有一个新的 xpath 规则来适应这个

```
(//div[@class="body"]//img)[2] 
```

有没有办法将这两条规则合二为一，因为我实际上需要两者？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T15:09:49.957

只需将然后与联合运算符结合使用：

```
//div[@class="wp-caption alignright" or @class="area"]//img | (//div[@class="body"]//img)[2] 
```

你可以在这里测试它：[http ://www.xpathtester.com/obj/cf36d1bd-01c6-41ea-8e9b-2099cc75cf80](http://www.xpathtester.com/obj/cf36d1bd-01c6-41ea-8e9b-2099cc75cf80)

# php - 如何使 SQL 的 PHP 输出对于我可以使用 jQuery 访问的每个元素都有唯一的名称？

> ID：12917600
> 
> 赞同：0
> 
> 时间：2012-10-16T14:58:27.657
> 
> 标签：php, jquery

我正在尝试制作简单的 cms；下面的代码是 index.php。

现在我找不到让 jquery 选择每个项目的方法，因为它们具有相同的名称。
例如我想做的是：选择 (on $(.subject)).hover 然后 (a $(.subjectpic)).show

如何让他们拥有自己的名字？

```
<?php
if(!$query){
    print "submit error";
}
else {
    while($list=mysql_fetch_array($query)){
        print"
        <div class=\"subjectwrap\">
                <div class=\"subject\">$list[subject]</div>
                <div class=\"subjectpic\">$list[subjectpic]</div>
        </div>
        ";
    }
}   
?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T15:09:04.547

有两种选择。您可以使用 jQuery 完成所有操作，选择同级主题图片：

```
$('.subject').hover( function() {
   $(this).closest('.subjectwrap').find('.subjectpic').show();
}); 
```

或者您可以使用 PHP 来完成，为每个数据主题分配一个数字索引：

```
<?php
if(!$query){
    print "submit error";
}
else {
    $i = 1;
    while($list=mysql_fetch_array($query)){
        print"
        <div class=\"subjectwrap\">
                <div class=\"subject\" data-subject=\"$i\">$list[subject]</div>
                <div class=\"subjectpic\" data-subject=\"$i\">$list[subjectpic]</div>
        </div>
        ";
        $i++;
    }
}   
?> 
```

通过在 PHP 中分配一个数字索引，您可以使用 jQuery 来定位它：

```
$('.subject').hover( function() {
    var thisSubject = $(this).attr('data-subject');
    $('.subjectpic[data-subject=' + thisSubject + ']').show();
}); 
```

# sql-server - T-SQL中条件语句*=的功能是什么

> ID：12917610
> 
> 赞同：1
> 
> 时间：2012-10-16T14:58:47.143
> 
> 标签：sql-server

我发现了一段使用 *= 作为条件语句的 SQL 代码。有人可以提供一些提示吗？

```
SELECT  *
FROM     TABLE1 A,TABLE2 B
WHERE    A.ID *= B.ID 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-16T14:59:59.783

这是一种过时的风格[LEFT JOIN](http://en.wikipedia.org/wiki/Join_%28SQL%29#Left_outer_join)。

你应该改用这个

```
 select * 
 from
     TABLE1 A
          left join TABLE2 B 
          on A.ID = B.ID 
```

在更新代码时，您可能还会发现[这很有用](http://www.sqlmag.com/article/sql-server/old-join-syntax-vs-new)

# python - 如何编写一个要求输入数字直到引入零的程序？

> ID：12917621
> 
> 赞同：-4
> 
> 时间：2012-10-16T14:59:24.870
> 
> 标签：python, list, element

我该如何编写一个程序来创建一个整数列表，要求用户输入一个新数字，直到引入零。

```
for example
    Enter elements for a list, one at a time. Enter 0 to stop.
    element =  9 
    element = 3 
    element = 1
    element = -7
    element = 2
    element = 0
    Finished getting user input.
    The list is:  [9, 3, 1, -7, 2] 
```

这就是我所拥有的。

```
listA = [9, 3, 1, -7, 2]
while True:
    input = int("some number: ")

    if input == 0
        break
    print("Finished getting user input")
    print("the list is: [9,3,1,-7,2]")
    else:
        listA.append(int(input)) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-16T15:01:49.463

```
mylist = []
while True:
    try:
        input = int(raw_input("add a number: "))
    except ValueError:
        print "please only input integers, input 0 to quit"
        continue
    if input == 0
        break
    else: 
        mylist.append(int(input)) 
```

在此循环运行后，您将获得一个列表`mylist`，其中包含用户在输入之前输入的所有整数`0`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T15:50:30.513

要查看您的代码：

```
File "temp.py", line 6
    if input == 0
            ^ 
```

SyntaxError：无效的语法

if 语句末尾需要一个冒号。修复它，然后重试您的程序。

试试这个：

```
if input == 0: 
```

另外，如果你的问题得到了很好的回答，你应该检查它，以便回答你最好的人获得积分

# c# - C# 附加字典

> ID：12917625
> 
> 赞同：2
> 
> 时间：2012-10-16T14:59:37.413
> 
> 标签：c#, dictionary, append, concat

我如何将字典附加到另一个字典中？

```
Dictionary<string, DateTime> odict = new Dictionary<string, DateTime>();
        //Liste tous les Clients EMAIL (3)
        foreach (var TheClientID in TheClient.GetClient_Id(3))
        {
            Dictionary<string, DateTime> Temp = oEmail.VoirEML(TheClientID.Key);
             //odict = odict.Concat(Temp).ToDictionary(pair => pair.Key, pair => pair.Value);
            odict = odict.SelectMany(toto => Temp)
                     .ToLookup(pair => pair.Key, pair => pair.Value)
                     .ToDictionary(group => group.Key, group => group.First());
        } 
```

我想在不加倍条目的情况下连接/附加字典。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-16T15:02:50.140

我曾经为此编写了一个扩展方法，因为我需要相同的方法。最后一个参数决定遇到重复键时要做什么。

`Skip`表示保留源条目。

`Overwrite`表示使用“其他”条目。

`Throw`会抛出异常。

```
public enum DuplicateKeyHandling
{
    Skip,
    Overwrite,
    Throw
}

/// <summary>
/// Combines two dictionaries into one dictionary. The contents of the resulting dictionary depends on the <paramref name="duplicateKeyHandling"/> parameter.
/// </summary>
/// <typeparam name="TKey">The type of the keys in the dictionaries</typeparam>
/// <typeparam name="TValue">The type of the values in the dictionaries</typeparam>
/// <param name="this"></param>
/// <param name="other">The dictionary to combine this one with</param>
/// <param name="duplicateKeyHandling">Specifies how to react if the <paramref name="other"/> dictionary contains keys that are already in this dictionary</param>
/// <returns>A new dictionary containing the combined key-value-pairs of both source dictionaries</returns>
public static Dictionary<TKey, TValue> Combine<TKey, TValue>(this Dictionary<TKey, TValue> @this, Dictionary<TKey, TValue> other, DuplicateKeyHandling duplicateKeyHandling = DuplicateKeyHandling.Skip)
{
    // EDIT: I added the "comparer" parameter so the resulting dictionary will
    // use the same comparer as the first source dictionary
    var result = new Dictionary<TKey, TValue>(@this, @this.Comparer);

    foreach (KeyValuePair<TKey, TValue> kvp in other)
    {
        if (result.ContainsKey(kvp.Key))
        {
            if (duplicateKeyHandling == DuplicateKeyHandling.Overwrite)
            {
                result[kvp.Key] = kvp.Value;
            }

            if (duplicateKeyHandling == DuplicateKeyHandling.Throw)
            {
                throw new Exception("Duplicate key while combining dictionaries!");
            }
        }
        else
        {
            result.Add(kvp.Key, kvp.Value);
        }
    }

    return result;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T19:10:45.607

我认为尝试使用 Linq 是一个错误。通过一个简单的循环，它很容易编写和阅读，并且扩展方法不会更有效率——可能效率更低。

```
 Dictionary<string, DateTime> odict = new Dictionary<string, DateTime>();
    //Liste tous les Clients EMAIL (3)
    foreach(var TheClientID in TheClient.GetClient_Id(3)) {
            Dictionary<string, DateTime> Temp = oEmail.VoirEML(TheClientID.Key);
            //odict = odict.Concat(Temp).ToDictionary(pair => pair.Key, pair => pair.Value);
            foreach(var kvp in Temp){
                    odict[kvp.Key] = kvp.Value;
        }
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-17T09:25:12.400

我试试这个：

```
odict = odict.Concat(Temp.Where(kvp => !odict.ContainsKey(kvp.Key))).ToDictionary(x => x.Key, x => x.Value); 
```

它工作正常

# hibernate - db2 hibernate hbm2ddl table not found 错误

> ID：12917629
> 
> 赞同：2
> 
> 时间：2012-10-16T14:59:46.077
> 
> 标签：hibernate, hsqldb, h2, hbm2ddl

我在尝试执行单元测试时遇到以下问题。我正在使用内存中的数据库（为此我使用了 h2 和 hsqldb，但它们都让我遇到了同样的错误）。

具有以下 hibernate.cfg.xml 文件：

```
<hibernate-configuration>
<session-factory>
 <property name="hibernate.bytecode.use_reflection_optimizer">false</property>
 <property name="hibernate.connection.driver_class">org.h2.Driver</property>
 <property name="hibernate.connection.url">jdbc:h2:mem:news;INIT=create schema IF NOT EXISTS news</property>
 <property name="hibernate.c3p0.min_size">5</property>
 <property name="hibernate.c3p0.max_size">20</property>
 <property name="hibernate.dialect">org.hibernate.dialect.H2Dialect</property>
 <property name="hibernate.connection.autocommit">false</property>
 <property name="current_session_context_class">thread</property>
 <property name="hibernate.hbm2ddl.auto">create-drop</property>
 <property name="show_sql">false</property>
 <mapping resource="com/mycom/common/List.hbm.xml"></mapping>
 <mapping resource="com/mycom/common/Info.hbm.xml"></mapping>
 <mapping resource="com/mycom/common/User.hbm.xml"></mapping>
 <mapping resource="com/mycom/common/Category.hbm.xml"></mapping>
 <mapping resource="com/mycom/common/Topic.hbm.xml"></mapping>
 <mapping resource="com/mycom/common/CategoryRelation.hbm.xml"></mapping>
 <mapping resource="com/mycom/common/TopicRelation.hbm.xml"></mapping>
</session-factory>
</hibernate-configuration> 
```

CategoryRelation.hbm.xml 和TopicRelation.hbm.xml 的目的只是中间表，其中包含Category/Topic 表（主数据表）和其他表之间的映射。

在 sessionFactory 创建期间通过 hbm2ddl 自动生成数据库时，会出现以下问题：

```
2012-10-16 16:36:35,448 DEBUG [main] com.mchange.v2.c3p0.impl.NewPooledConnection  - com.mchange.v2.c3p0.impl.NewPooledConnection@af4627 handling a throwable.
org.h2.jdbc.JdbcSQLException: Table "T_RELATIONTOCATEGORY" not found 
```

t_relationtoTopic 也是如此。

CategoryRelation.hbm.xml 文件的摘录

```
<hibernate-mapping>
 <class name="com.yell.news.model.CategoryRelation" table="t_relationToCategory">
...
</hibernate-mapping> 
```

任何其他对此有 fk 的提取物

```
<hibernate-mapping>
 <class name="com.mycom.myapp.model.List" table="t_List">
  ...
  <set name="categoryRelation" fetch="join" table="t_relationToCategory" lazy="false"  inverse="true" >
   <key>
    <column name="rec_ListId"></column>
   </key>
   <one-to-many class="com.yell.news.model.CategoryRelation"/>
  </set>
 </class>
</hibernate-mapping> 
```

知道可能是什么问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T08:26:04.587

我找到了解决方案。似乎是休眠版本的问题。我正在使用*4.1.1.Final*。

我的一位同事告诉我使用*3.6.0.Final*，所以我将它添加到 maven （需要库：*javassist - 版本 3.12.1.GA*），问题就解决了。

似乎是 Hibernate 中版本*4.1.1.Final*的问题。或者也许是我没有找到的配置。

# regex - EditPad 7：行尾的正则表达式？

> ID：12917635
> 
> 赞同：1
> 
> 时间：2012-10-16T15:00:17.273
> 
> 标签：regex, editpad

我正在使用 EditPad 7 编辑一些文本并在查找和替换中使用正则表达式。我试图在行尾只找到单词。

前任：

```
Wrapper:H
Wrapper:H Binder:G
Wrapper:Honduras 
```

我想在第一行而不是第二行或第三行找到大写字母 H。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T15:06:17.230

要么`H$`或`H\Z`应该工作。

有关更多信息，请参见[http://www.regular-expressions.info/reference.html](http://www.regular-expressions.info/reference.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-16T15:06:49.320

我不知道 EditPad 是否在多行模式下工作。如果它确实使用它来查找：

```
(Wrapper:)H$ 
```

这要替换：

```
\1whateveryouwanttohaveinstead 
```

此外，如果您想忽略`H`行尾之间的额外空格（即，如果空格不构成**行**尾），您可以使用以下命令：

```
(Wrapper:)H\s*$ 
```

# spring - Spring Enterprise Bundle Repository 上的 spring-webmvc 的名称是什么？

> ID：12917636
> 
> 赞同：2
> 
> 时间：2012-10-16T15:00:25.463
> 
> 标签：spring, maven

`spring-webmvc`在 Maven 和EBR 上是否`org.springframework.web.servlet`相同？`spring-webmvc`我似乎在 Spring 的 EBR 上找不到。

马文：

```
<dependency>
    <groupId>org.springframework</groupId>
    <artifactId>spring-webmvc</artifactId>
    <version>3.1.2.RELEASE</version>
 </dependency> 
```

弹簧 EBR：

```
<dependency>
    <groupId>org.springframework</groupId>
    <artifactId>org.springframework.web.servlet</artifactId>
    <version>3.1.2.RELEASE</version>
</dependency> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-24T15:03:26.903

根据官方[Spring 文档](http://static.springsource.org/spring/docs/3.2.x/spring-framework-reference/html/overview.html#dependency-management)，bundle 的符号名是从主包根目录派生的，例如`org.springframework.beans`或`org.springframework.web.servlet`。由于 Spring MVC 的核心类之一 ie`org.springframework.web.servlet.DispatcherServlet`位于`org.springframework.web.servlet`包中，因此 bundle 被命名为`org.springframework.web.servlet`。

# networking - 如何始终如一地将一小部分网站流量重定向到新的测试版网站？

> ID：12917639
> 
> 赞同：0
> 
> 时间：2012-10-16T15:00:40.000
> 
> 标签：networking

理想情况下，我想通过地理定位来做到这一点（美国的 IP 是唯一被重定向的 IP），但我了解到，如果没有昂贵的设置或一些相当庞大的工程，这将行不通。

其他人是否可以建议（除了通过特定的 URL 重新路由）我可以对用户子集进行分组/标识以始终重定向到新的 beta 网站的任何方式？最好的情况是这些人被永久重新路由，直到所有流量最终重新路由到新站点。最坏的情况是人们每次访问时都会在站点之间随机来回跳动（这将是一个非常坏的消息，因为这两个站点完全不同）。

非常感谢有关此主题的任何想法或资源链接！我是网络相关主题的菜鸟..

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T18:50:53.943

**在 cookie 中设置一次**目标站点，例如对于没有设置目标站点的每 10 个请求。

然后使用基于该 cookie 值的 URL 重写。

如果使用 Apache，您可能会在 .htaccess 文件中压缩所有这些内容，请参阅[http://www.askapache.com/htaccess/htaccess-fresh.html](http://www.askapache.com/htaccess/htaccess-fresh.html)

# c# - 在 C# 中的 .snippet 文件中编写一些逻辑

> ID：12917642
> 
> 赞同：0
> 
> 时间：2012-10-16T15:00:52.633
> 
> 标签：c#, .net, code-snippets

我只是好奇是否可以在 .snippet 文件中编写一些逻辑，或者是否有任何解决方法可以做类似的事情？

例如：读取一个 xml 文件并基于该文件生成代码段。

提前致谢， 卡松

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T15:13:36.767

为此，您可能需要迁移到 Visual Studio 加载项。（如果您使用的是 VS 2010 或更低版本，您可以使用宏，但 VS 2012 不支持宏，因此更喜欢插件）。

# jquery - 无法让 jQuery click 正确注册元素

> ID：12917651
> 
> 赞同：0
> 
> 时间：2012-10-16T15:01:29.993
> 
> 标签：jquery

[在这里](http://jsfiddle.net/5Hejm/8/)看到jsfiddle

我试图让“阅读更多”链接向下滑动并在点击时显示隐藏的内容，但我似乎无法正确注册点击功能。我做了什么明显错误的事情吗？

基本的html布局

```
<div id="wrapper">
    <div id="aHidden">some long text here</div> <!--defaulted hidden with css-->
    <div id="aBtn" class="bio-readMore">read more...</div>
</div> 
```

这是我试图用来执行此操作的 jQuery：

```
$(document).ready(function() {
    $("div").each(function(idx) {
        if ($(this).hasClass('bio-readMore')) {
            var thename = this.id.replace("Btn", "Hidden");
            var sel = "#" + thename;
            $(sel).click(function() {
                alert("running click for element with value " + this.id);
                if ($(this).is(":hidden")) {
                    $(this).slideDown("slow");
                } else {
                    $(this).slideUp();
                }
            });
        }
    });
});​ 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-16T15:07:28.537

使用现有标记，您可以轻松地将点击注册替换为以下内容：

```
$(".bio-readMore").on("click", function(){
    $(this).prev().slideToggle();
}); 
```

[**​jsfiddle 示例**](http://jsfiddle.net/5Hejm/13/)

如果你想修复你的代码，你有一些选择器颠倒了：

```
$(document).ready(function() {
    $("div").each(function(idx) {
        if ($(this).hasClass('bio-readMore')) {
            var thename = this.id.replace("Btn", "Hidden");
            var sel = "#" + thename;
            $(this).click(function() {  //<--- On the <a/> not the hidden element
                alert("running click for element with value " + this.id);
                if ($(sel).is(":hidden")) { // <----you want to check the hidden not the <a/>
                    $(sel).slideDown("slow");
                } else {
                    $(sel).slideUp();
                }
            });
        }
    });
});​ 
```

**[jsfiddle 示例](http://jsfiddle.net/5Hejm/21/)**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-16T15:02:43.380

我修好了它 ：

```
$("div").each(function(idx) {
    if ($(this).hasClass('bio-readMore')) {
        var thename = this.id.replace("Btn", "Hidden");
        var sel = "#" + thename;
        console.log(sel);
        $(this).click(function() {
            if ($(sel).is(":hidden")) {
                $(sel).slideDown("slow");
            } else {
                $(sel).slideUp();
            }
        });
    }
}); 
```

[示范](http://jsfiddle.net/jSGkn/)

您混淆了要单击的元素和要显示/隐藏的元素。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-16T15:08:16.113

您将单击事件绑定到隐藏元素。您需要将单击处理程序绑定到`..read more`div 和基于相应部分的可见性的 slideUp/Down。

**演示：http:** [//jsfiddle.net/5Hejm/15/](http://jsfiddle.net/5Hejm/15/)

```
 $('div.bio-readMore').click(function() {
        var thename = this.id.replace("Btn", "Hidden");
        var $sel = $("." + thename);
        var $this = $(this);

        if ($sel.is(":hidden")) {
            $sel.slideDown("slow");
            $this.text('...read less');
        } else {
            $sel.slideUp();
            $this.text('...read more');
        }

    }); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-16T15:13:31.260

我想这就是你要找的

```
$(document).ready(function() {
  $(".bio-readMore").click(function() {
            if ($(this).prev().is(":hidden")) {
                  $(this).prev().slideDown("slow");
                 $(this).text(" ...read less");
            } else {
                 $(this).prev().slideUp();
                  $(this).text(" ...read more");
            }
        });
});​ 
```

jsfiddle [http://jsfiddle.net/5Hejm/31/](http://jsfiddle.net/5Hejm/31/)

# objective-c - 应用程序启动时的 NSImage

> ID：12917654
> 
> 赞同：0
> 
> 时间：2012-10-16T15:01:43.467
> 
> 标签：objective-c, xcode, cocoa, nsimage, nsimageview

我有一个图像视图对象。当按下按钮时，我可以让它加载图像，但我想知道是否有办法让它在应用程序启动时加载。

我使用的代码是

```
NSURL *lURL = nil;
NSData *lData = nil;
NSImage *lImage = nil;
lData = [lURL resourceDataUsingCache:YES];
lImage = [[NSImage allocWithZone:[self zone]] initWithData:lData];
lURL = [[NSURL alloc] initWithString:@"urltoimage"];
[imageView setImage:lImage]; 
```

任何帮助表示赞赏

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T15:13:12.960

使用`-[UIViewController viewDidLoad]`在控制器首次加载到内存时只调用一次的方法。

# java - java给数组赋值

> ID：12917658
> 
> 赞同：0
> 
> 时间：2012-10-16T15:01:55.590
> 
> 标签：java, arrays

所以我在 java 中创建了一个程序，您可以在其中输入分数并将它们分类为十分位数（0-9、10-19、20-29、... 80-89、90-100），我已经掌握了关于程序应该如何工作，但我缺少一个关键要素。我创建了一个包含 10 个元素的数组（每个十分位范围一个）。一旦用户输入他们的分数，它就会除以 10，然后需要将分数放入数组中的适当位置，但这就是我迷路的地方。在那之后它必须做很多事情，我理解但是当有人输入 55 以将数组的 50-59 部分增加 1 时，我应该如何告诉代码等等？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T15:03:42.280

嗯，听起来你只是想要：

```
bucketedScores[score / 10]++; 
```

不是吗？或者可能更清楚：

```
bucketedScores[score / 10] = roughScores[score / 10] + 1; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-16T15:03:33.123

```
int index = value / 10;
myArray[index] += 1; 
```

仅供参考，鉴于您所说的，您将得到一个 IndexOutOfBoundsException 得分为 100。可能需要处理这个问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-16T15:04:18.930

由于该范围有 0 到 101 的 101 个值，因此您需要做的不仅仅是除以 10。

你的意思是喜欢吗？

```
int[] scores = new int[10];

int decile = ...
int score = ....

scores[Math.min(9, decile/10)] += score; 
```

这确保了 100 映射到 9。另一个解决方案是使用`(int)(decile/10.1)`将 0 到 10 映射到第一个十分位的方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-16T15:04:51.640

试试这个方法......

`bucketedScores[score / 10] = roughScores[score / 10] + 1;`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-16T15:04:57.620

听上去像

```
int[] myarray = new int[10];
 // Divide and increase the number returned (like 84/10 = 8 in integer division)
myarray[num/10]++ 
```

虽然 100 会扔掉它，但你需要一个特殊的情况。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-10-16T15:16:29.837

根据问题进入循环，例如我希望你将 100 个值划分为 10-10。使用 for 循环并通过将输入分配给每次输入迭代的临时变量来对其进行检查和分类。

```
for(int i=0; i<=100; i++)
{
    if(a[i] >= 0 && a[i] < 10)
                your desired o/p(execution)
     else if(a[i] > 10 && a[i] < 20)
                your desired o/p(execution)
} 
```

# javascript - 如何选择由 JSP 2.0 标记文件的特定实例生成的元素

> ID：12917660
> 
> 赞同：0
> 
> 时间：2012-10-16T15:01:56.030
> 
> 标签：javascript, jquery, jsp, jstl, jsp-tags

简短版：我如何（使用 JQuery 或其他选择器）选择由*该 JSP 2.0 标记文件实例*创建的 HTML 元素，每个页面可以多次使用该元素？

长版：

我有一个 JSP 2.0 标记文件，如下所示：

```
<%@ tag body-content="empty" import="org.myapp.model.Question" %> 
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>
<%@ taglib prefix="fn" uri="http://java.sun.com/jsp/jstl/functions"%>
<%@ attribute name="question" required="true" type="org.myapp.model.Question" %>

<div class='singleChoice'>
   <c:forEach items="${question.questionOptions}" var="option">
       <!-- display options... -->
   </c:forEach>
</div> 
```

此标签可以在给定页面上多次使用。如果 question.questionOptions 的大小小于 3，我想在此标签生成的 'singleChoice' div 中添加一个额外的 CSS 类（'compact'）。我想将逻辑添加到标记文件（JavaScript、附加的 JSTL、任何必要的）以检查 questionOptions 的长度，并在必要时将类添加到 div。

我知道我可以将脚本标签添加到标签文件中，如下所示：

```
<c:if test="${fn:length(question.questionOptions) < 3}"> 
    <script type="text/javascript">
    $(document).ready(function() {
        $('div .singleChoice').addClass('compact');
    });
    </script>
</c:if> 
```

但由于它在整个文档准备就绪时执行，并且标签可能在页面中出现多次，因此如果其中任何一个符合应用标准，它将将“紧凑”类应用于页面上的所有“singleChoice”div。当我不知道 ID（并且希望避免设置它）时，如何从标记文件中指定*此div？*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T15:34:05.623

`${question.questionOptions}`如果小于三个，你想添加一个“紧凑”类吗？如果是，我建议的解决方案是添加一个条件，将 div 设置为 class="singleChoice compact"。

```
<c:set var="divClass" value="singleChoice" />
<c:if test="${fn:length(question.questionOptions) < 3}">
   <c:set var="divClass">singleChoice compact</c:set>
</c:if>
<div class='${divClass}'>
    <c:forEach items="${question.questionOptions}" var="option">
        <!-- display options... -->
    </c:forEach>
</div> 
```

此解决方案未经测试，但如果我正确理解您的问题，逻辑就在那里。

# mysql - 错误：#1436 - MySQL 触发器导致线程堆栈溢出

> ID：12917662
> 
> 赞同：2
> 
> 时间：2012-10-16T15:02:01.930
> 
> 标签：mysql, sql, triggers

给定错误：#1436 - 线程堆栈溢出：131072 字节堆栈使用了 6024 字节，需要 128000 字节。使用 'mysqld -O thread_stack=#' 指定更大的堆栈。

```
DROP TRIGGER IF EXISTS `After_delete_area_package`;
DELIMITER //
CREATE TRIGGER `After_delete_area_package` AFTER DELETE ON `area_package`
FOR EACH ROW BEGIN    
DELETE FROM accounts_areas
WHERE (area_id = 1); 
END
//
DELIMITER ; 
```

我猜很简单。表 accounts_areas 中唯一的 area_id 是 1
在此之前我尝试过 old.package_area_id

我没有外键限制，我的开销在设置为 28B 的 phpMyAdmin 中变为红色。

RDMS：myISAM

SQLFIDDLE：[http ://sqlfiddle.com/#!2/79a41](http://sqlfiddle.com/#!2/79a41)

问题：为什么我的触发器不会从 account_areas where area_id = 1 中删除所有行

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T15:14:37.780

你可能会错过一个`END`吗？

```
DROP TRIGGER IF EXISTS After_delete_area_package;

DELIMITER $$
CREATE TRIGGER After_delete_area_package AFTER DELETE ON area_package
FOR EACH ROW
BEGIN
DELETE FROM accounts_areas
    WHERE area_id = 1;
END$$
DELIMITER; 
```

**编辑 1**

由于您正在恢复`thread_stack`错误，因此解决方案是增加堆栈大小。

# nservicebus - 工作节点处理来自两个分发器的消息

> ID：12917665
> 
> 赞同：1
> 
> 时间：2012-10-16T15:02:26.087
> 
> 标签：nservicebus, nservicebus-distributor

我在 nServicebus 组中有同样的问题。我没有得到支持此功能的确切答案。我喜欢把它贴在这里看看 SO 社区的想法。

[http://tech.groups.yahoo.com/group/nservicebus/message/16487](http://tech.groups.yahoo.com/group/nservicebus/message/16487)

我已经有处理来自分发服务器的消息的 Windows 处理器工作节点。现在我想扩展这个工作节点来处理来自另一个具有不同队列名称的分发器的消息。在查看单播总线配置时，发现只能设置一个分发器控制和数据地址。有没有办法在 NServiceBus 配置中设置多个分配器？如果您还解释了使用处理多个分销商的利弊，那将有所帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T22:13:49.370

听起来您可能正在使用 NServiceBus 2.x，因为在 NServiceBus 3.0 中，Distributor 的故事发生了很大变化。

在 NServiceBus 2.x 下，您通常会设置多个端点，它们都与同一个分发服务器通信。这些端点成为工作节点，分发器根据每个工作节点报告的空闲线程来分配它们之间的工作。

因此，如果您有由 X.Worker@Server1 和 X.Worker@Server2 处理的进入队列 X 的消息负载，那么您为什么希望 X.Worker 实例之一来处理即将到来的消息对我来说没有意义进入队列 Y？

相反，您应该（通常）为每个逻辑服务设置一个 Distributor。这类似于 HTTP 流量的网络负载均衡器。然后它后面的端点充当工作节点。您可以为另一个逻辑服务设置第二个分发器，它有自己的工作节点。

现在，说了这么多，在 NServiceBus 3.x 中，分发器与端点集成在一起。因此，您从一个配置为主节点的端点开始。基本上，它充当分销商和工人。然后要向外扩展，您只需以 Worker 角色站起更多节点，指向主节点以获取它们的工作。

在这种情况下，（通常）没有独立的分销商。这就是为什么我猜你指的是V2。

# database - 多对一 ApexSql 数据差异数据库传输

> ID：12917667
> 
> 赞同：0
> 
> 时间：2012-10-16T15:02:29.860
> 
> 标签：database, data-transfer

我已经搜索了答案，但没有找到与我目前正在进行的项目相关的任何内容。如果我错过了它，如果你能请链接 URL，将不胜感激。

目前，我们在现场有许多集合，它们运行各种应用程序将现场数据传输到主数据库。这些应用程序是出于不同的原因在不同的时间开发的，目前只发送特定的数据。我们现在需要发送所有数据。我希望利用 ApexSQL，我们已经拥有的产品，数据差异可能将每个内场服务器净新行条目传输到主数据库。

我希望从可能已经将其视为一种可能性或过去已经实施过的人那里获得一些信息。

这个项目额外有趣的方面是它必须符合 PCI 合规性，我可以事后弄清楚。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T11:03:42.430

要仅传输新条目，您必须同步存在于源（内场服务器）中并且在目标（主数据库）中“丢失”的记录。ApexSQL Data Diff 可以执行此操作，但您必须在特定表的缺失选项卡中选择所有记录，并在附加选项卡中取消选择所有记录。如果您在“附加”选项卡中保留选中的记录，则主数据库中存在但内场服务器中不存在的记录将被删除，因此您必须小心

![在此处输入图像描述](../Images/a62342ac95ffefc242b15e2ed914f5ba.png)

如果你有[ApexSQL Diff API](http://www.apexsql.com/sql_tools_diffapi.aspx)，你可以使用 SynchronizeMissingRows 并且数据库中所有丢失的行都将被同步

# c - C - 在 RAM 中运行程序

> ID：12917677
> 
> 赞同：5
> 
> 时间：2012-10-16T15:03:02.600
> 
> 标签：c, file, ram, hard-drive

我有一个程序，它使用一次性加密对两个文件进行异或。由于密钥文件具有如此敏感的性质，我不希望密钥文件的任何痕迹出现在计算机硬盘驱动器上，因为这可能会危及安全性。

问题是，如何在 RAM 中运行程序以避免在 HD 上留下任何痕迹？或者，从闪存驱动器运行程序是否包含密钥文件到闪存驱动器的痕迹？

以下是程序中如何处理密钥文件：

```
/* Check if keyfile can be opened. */
if((keyfile = fopen(argv[3], "rb"))== NULL)
{
printf("Can't open keyfile.\n");
printf("Please enter a valid filename.\n"); 
printf("USAGE: OTP <source file> <output file> <keyfile>\n");
perror("Error");
return(1);
}                               

/* Get size of keyfile */
fstat(fileno(keyfile), &keybuf);

/* Check if keyfile is the same size as, or bigger than the sourcefile */
if((keybuf.st_size) < (statbuf.st_size))
{
printf("Source file is larger than keyfile.\n");
printf("This significantly reduces cryptographic strength.\n");
printf("Do you wish to continue? (Y/N)\n");
fgets(buffer, 20, stdin);
sscanf(buffer, "%c", &ans);
if(ans == 'n' || ans == 'N')
{
return (1);
}
if(ans == 'y' || ans == 'Y')
{
    printf("Proceeding with Encryption/Decryption.\n");
    }

/* Encrypt/Decrypt and write to output file. */
while(count < (statbuf.st_size))
{
key=fgetc(keyfile);
data=fgetc(sourcefile);

output=(key^data);

fputc(output,destfile);
count++;
}

/* Close files. */
fclose(keyfile);
fclose(sourcefile);
fclose(destfile); 
```

我在谷歌搜索时遇到了一个`inram`函数，但这似乎不是我需要的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-16T15:14:55.097

我假设您正在从某些外部媒体读取密钥文件，并且您担心进程与包含 OTP 的 I/O 缓冲区一起被交换到磁盘。您可能同样关心正在写入的明文。如果您使用的是 posix 系统（如 linux），那么您应该查看`mlock`and`mlockall`函数。这些调用会将内存页面锁定到 RAM 中并禁止它们交换到磁盘。手册页专门列出了这些调用的安全用例。另一种选择可能是`mmap`文件。虽然它没有提供相同的保证，但由于映射页面将由外部媒体支持，我怀疑它们会出现在交换空间中。

# linux - 在脚本中用 ext4 分区填充磁盘

> ID：12917678
> 
> 赞同：15
> 
> 时间：2012-10-16T15:03:03.580
> 
> 标签：linux, partitioning

我尝试使用 parted 进行脚本分区，如下所示：

```
parted -a optimal /dev/sda mklabel gpt mkpart primary ext4 1 -1 
```

但它抱怨 -1 不是一个公认的选项。在 parted 提示符下仍然可以使用相同的子命令。所以我的问题是如何在脚本中使用相同的选项？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-10-17T15:56:26.073

终于找到了解决办法：

```
parted -s -a optimal /dev/sda mklabel gpt -- mkpart primary ext4 1 -1s 
```

`--`它在这里工作非常重要。

请注意使用“--”，以防止后面的“-1s”最后扇区指示符被解释为无效的命令行选项。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-06-26T10:07:40.413

您也可以使用 --script 选项。在这种情况下，您应该将脚本部分放在单引号中。

例子：

```
parted --script /dev/sda 'mkpart primary ext4 1 -1' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-16T15:07:59.040

我猜这是 parted 的参数解析器的错。

尝试`parted -a optimal /dev/sda mklabel gpt mkpart primary ext4 1 \-1`或`parted -a optimal /dev/sda mklabel gpt mkpart primary ext4 1 \\-1`

# ruby-on-rails - 如何给模块中的类方法起别名？

> ID：12917680
> 
> 赞同：6
> 
> 时间：2012-10-16T15:03:19.027
> 
> 标签：ruby-on-rails, ruby, metaprogramming, core, extending

我正在使用 Ruby v1.9.2 和 Ruby on Rails v3.2.2 gem。我有以下模块

```
module MyModule
  extend ActiveSupport::Concern

  included do
    def self.my_method(arg1, arg2)
      ...
    end
  end
end 
```

我想给*类方法* `my_method`起别名。所以，我陈述了以下（*不工作*）代码：

```
module MyModule
  extend ActiveSupport::Concern

  included do
    def self.my_method(arg1, arg2)
      ...
    end

    # Note: the following code doesn't work (it raises "NameError: undefined
    # local variable or method `new_name' for #<Class:0x00000101412b00>").
    def self.alias_class_method(new_name, old_name)
      class << self
        alias_method new_name, old_name
      end
    end

    alias_class_method :my_new_method, :my_method
  end
end 
```

换句话说，我想以`Module`某种方式扩展该类，以便在`alias_class_method`整个`MyModule`. 但是，我想让它*工作*并在我所有的 Ruby on Rails 应用程序*中可用*。

1.  我应该把与`Module`类的 Ruby 核心扩展相关的文件放在哪里？也许在 Ruby on Rails`lib`目录中？
2.  我应该如何正确“扩展”`Module`核心扩展文件中的类？
3.  这是正确的方法吗？也就是说，例如，我应该“扩展”另一个类 ( `Object`, `BasicObject`, `Kernel`, ...) 而不是`Module`? 或者，我应该完全避免实施上述核心扩展吗？

但是，*更重要*的是，是否有一个 Ruby 功能可以让我完成我想要完成的工作，这样我就不必扩展它的类？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-16T16:57:16.923

您可以使用`define_singleton_method`将旧方法包装在新名称下，如下所示：

```
module MyModule
  def alias_class_method(new_name, old_name)
    define_singleton_method(new_name) { old_name }
  end
end

class MyClass
  def my_method
    puts "my method"
  end
end

MyClass.extend(MyModule)
MyClass.alias_class_method(:my_new_method, :my_method)
MyClass.my_new_method     # => "my method" 
```

回答您的评论，您不必手动扩展每个类。在类`define_singleton_method`中实现`Object`。所以你可以简单地扩展`Object`类，所以每个类都应该有可用的方法......

```
Object.extend(MyModule) 
```

把它放在你的 Rails 应用程序的初始化程序中，你应该很高兴......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-09-06T21:21:56.173

我在这个网站上找到了答案：http: [//engineering.lonelyplanet.com/2012/12/09/monitoring-our-applications-ruby-methods/](http://engineering.lonelyplanet.com/2012/12/09/monitoring-our-applications-ruby-methods/)

解决方案是[`class_eval`](http://ruby-doc.org/core-2.0.0/Module.html#method-i-class_eval)与块一起使用。这允许使用封闭范围内的变量。

```
module Alias

  def trigger
    @trigger = true
  end

  def method_added(name)
    if @trigger
      @trigger = false
      with_x = "#{name}_with_x"
      without_x = "#{name}_without_x"
      define_method(with_x) do
        "#{send(without_x)} with x"
      end
      alias_method without_x, name
      alias_method name, with_x
    end
  end

  def singleton_method_added(name)
    if @trigger
      @trigger = false
      with_x = "#{name}_with_x"
      without_x = "#{name}_without_x"
      define_singleton_method(with_x) do
        "singleton #{send(without_x)} with x"
      end
      singleton_class.class_eval do
        alias_method without_x, name
        alias_method name, with_x
      end
    end
  end

end

class TestAlias

  extend Alias

  trigger
  def self.foo
    'foo'
  end

  trigger
  def bar
    'bar'
  end

end

TestAlias.foo # => 'singleton foo with x'
TestAlias.new.bar # => 'bar with x' 
```

如果您没有，[`singleton_class`](http://www.ruby-doc.org/core-1.9.2/Object.html#method-i-singleton_class)那么您可能应该升级您的 Ruby 版本。如果这是不可能的，你可以这样做：

```
class Object
  def singleton_class
    class << self
      self
    end
  end
end 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-03-10T07:42:00.353

接受的答案令人困惑并且不起作用。

```
class Module
  def alias_class_method(new_name, old_name)
    define_singleton_method(new_name, singleton_method(old_name))
  end
end

module MyModule
  def self.my_method
    'my method'
  end
end

MyModule.alias_class_method(:my_new_method, :my_method)
MyModule.my_new_method # => "my_method" 
```

# javascript - jQuery 选项卡和 AJAX：如何设置选项卡的样式？

> ID：12917685
> 
> 赞同：0
> 
> 时间：2012-10-16T15:03:39.003
> 
> 标签：javascript, jquery, html

所以我正在使用 jQuery UI 和标签小部件。当我在我正在制作的网站上的几个地方使用这些小部件时，我只从 jQuery UI 的默认样式中获取最低限度，并为我拥有的不同选项卡集制作不同的样式。

我通常有一个类似于这个的架构：

```
<div id="smth-tabs">
    <ul id="smth-tabs-menu">
        <li> ....
    </ul>
    <div class="smth-tabs"> //First tab
    </div>
    ....
</div> 
```

现在的问题是，当我使用 AJAX 加载选项卡时（而不是像我给出的示例那样将它们放在 div 中），包含选项卡的 div 会自动生成，因此只有小部件的类（“ui -tabs-panel”等）。

这是我用来创建这个基于 AJAX 的选项卡集的代码：

```
$(function() {
    $( "#smth-tabs" ).tabs({
        ajaxOptions: {
            error: function( xhr, status, index, anchor ) {
                $( anchor.hash ).html(
                    "Error" 
                );
            }
        }
    });
}); 
```

是否有选项可以传递给选项卡功能以在选项卡容器上设置自定义类？还是有其他方法可以做到这一点？或者我必须简单地解决在 AJAX 请求成功的情况下将类添加到加载的选项卡吗？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T15:08:38.393

您可以在 ajax return 中添加它： `$( "#smth-tabs-1" ).addClass('yourClass') ;`

事实上，你的*n 个*标签有 id`#smth-tabs-n`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-17T08:25:17.113

You can style `#smth-tabs .ui-tabs-pane` or even `#smth-tabs > ul` and `#smth-tabs > div`.

# python - 唯一化python列表中的所有对

> ID：12917686
> 
> 赞同：1
> 
> 时间：2012-10-16T15:03:39.943
> 
> 标签：python, list, unique

我已经通过帖子进行了搜索，但找不到针对我所面临的确切问题的解决方案。这很容易，但需要一些指导。

我有一个看起来像的python列表：

```
lst = ['bob/sally', 'bob/chris', 'bob/nate', 'sally/bob', ...] 
```

我想迭代并只打印唯一的对。所以在上面的例子中，它会发现 bob/sally 与 sally/bob 相同，所以它会删除一个。

任何帮助将不胜感激！我看过使用 set() 和其他 python 函数的帖子，但我认为这在这种情况下不起作用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-16T15:07:43.953

您可以使用一个集合，并通过对它们进行排序来规范化名称的顺序：

```
>>> data = ['bob/sally', 'bob/chris', 'bob/nate', 'sally/bob']
>>> set(tuple(sorted(item.split('/'))) for item in data)
set([('bob', 'chris'), ('bob', 'nate'), ('bob', 'sally')]) 
```

[或者正如Ignacio Vazquez-Abrams](https://stackoverflow.com/users/20862/ignacio-vazquez-abrams)和[mgilson](https://stackoverflow.com/users/748858/mgilson)所指出的那样，使用 a`frozenset`更加优雅，并且避开了排序和 tuple() 步骤：

```
set(frozenset(item.split('/')) for item in data) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-16T15:07:52.967

> 我看过使用 set() 和其他 python 函数的帖子，但我认为这在这种情况下不起作用。

对我来说工作得很好...

```
>>> set([frozenset((x, y)) for (x, y) in [('bob', 'sally'), ('bob', 'nate'), ('sally', 'bob')]])
set([frozenset(['bob', 'sally']), frozenset(['bob', 'nate'])]) 
```

# java - GXT - 窗口中的截断文本

> ID：12917689
> 
> 赞同：1
> 
> 时间：2012-10-16T15:03:41.490
> 
> 标签：java, gxt

我有一个窗口，其中包含两个 ContentPanel（水平），一个带有图像，另一个带有一些文本。问题是我的文本被截断了：它超出了窗口......

```
Window win = new Window();
win.setLayout( new FillLayout() );
win.setMinWidth( 250 );
win.setHeight( 120 );

ContentPanel content = new ContentPanel( new RowLayout( Orientation.HORIZONTAL ) );
ContentPanel iconePanel = new ContentPanel( new FillLayout() );
iconePanel.add(myImage);
content.add( iconePanel, new RowData( 48, 1 ) );

Text textPanel = new Text();
textPanel.setText( msg );
content.add( textPanel, new RowData( -1, 1 ) );
win.add( content );
win.show(); 
```

如何将文本保留在面板中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T15:24:42.487

有必要对GXT中的不同面板有一个很好的了解，还有一个技巧就是调整padding大小，最好用**firebug**，用firebug调整布局，对调整窗口有很大帮助。

# elasticsearch - 弹性搜索，唯一的查询结果

> ID：12917691
> 
> 赞同：0
> 
> 时间：2012-10-16T15:03:43.237
> 
> 标签：elasticsearch

想象一下以下数据：

```
data: [
  {  A: 1
     B: 1
     C: 1
  }
  {  A: 1
     B: 1
     C: 2
  }
  {  A: 3
     B: 1
     C: 23
  }
  ... 
] 
```

当我查询时，我想接收其值为 B 为 1 的每个数据，但我不希望它们共享相同的 A 值。换句话说，我希望我的查询结果包含唯一的 A 值。所以在这个例子中，我将有 C = 2, 23 或 C = 1, 23。这在弹性搜索中可以实现吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-18T08:39:35.543

经过长时间的研究，我了解到，目前还没有办法实现这一点。弹性搜索不支持这样的操作。

# jquery - IE 不兼容在保存数据时添加了不需要的文本

> ID：12917693
> 
> 赞同：0
> 
> 时间：2012-10-16T15:03:46.290
> 
> 标签：jquery, html, internet-explorer, qtip

我在 IE 不兼容模式下遇到问题。我有一个 editorContent 容器，开始如下。

```
 <div id="p1" class="paragraph">This is the first paragraph </div> 
```

但是，当我按下按钮时，会添加额外的东西。目前 Chrome、FF 和 IE 兼容模式有效。但是，当我使用非兼容模式时，它就不起作用了。在 Chrome 中使用后，它看起来像这样。

```
 <div id="p1" class="paragraph qTip triangle-isosceles-blue" style="color: black; font-size: 110%; padding: 0px 0px 0px 10px; " title="marked">
           This is the first paragraph
          </div> 
```

这可以正常工作并且符合预期，但是当我在 IE 不兼容视图中执行相同的功能时，我得到以下信息。

```
 <DIV aria-hidden=true style="PADDING-LEFT: 10px; BACKGROUND: none transparent scroll repeat 0% 0%; COLOR: black; FONT-SIZE: 110%" id=p1 class="paragraph qTip triangle-isosceles-blue" title="marked" sizcache="387" sizset="0">
  <P>This is the first paragraph</P></DIV> 
```

如您所见，这与上面的完全不同。下面是我按下按钮时调用的函数。在这种情况下，$set 是 div id p1。

```
 $('#add2').click(function() {
          classList = "marked";
          $set.addClass ( "qTip triangle-isosceles-blue ") ;
            $set.attr('title', "marked");

            $('.qTip').qtip({
                suppress: false,
                style: {
                    classes: 'ui-tooltip-green ui-tooltip-shadow'
                }
            });
        }); 
```

任何有关为什么会发生这种情况的帮助将不胜感激。谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T15:27:42.420

属性 sizcache 和 sizset 由[jQuery core](https://groups.google.com/forum/?fromgroups=#!topic/jquery-en/I4Kmahzp7fY)使用。

# sharepoint-2010 - CSS 自动从内容编辑器 Web 部件中消失

> ID：12917694
> 
> 赞同：0
> 
> 时间：2012-10-16T15:03:48.650
> 
> 标签：sharepoint-2010

我在我的 aspx 页面上的内容编辑器 web 部件中添加了一些 css，并且 css 应用得很好，但是一旦我停止编辑页面 css 就会消失。当我再次打开 Web 部件时，我可以看到空的

```
<style> </style> 
```

标签。任何想法 ？

此页面具有自定义 Web 部件，即使我向 Web 部件添加了一些内联 CSS，它也会在页面加载时应用，但在页面加载完成时消失。

我正在 Firefox 上尝试这个。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T18:30:40.677

内容编辑器 Web 部件不允许您直接在页面中嵌入样式和脚本元素。

相反，内容编辑器 Web 部件允许您链接到存储在共享点库中的 css 或 js 源。

或者，使用 SharePoint Designer（如果在您的公司中安装）来内联样式和脚本。

# monodevelop - Monodevelop 将 #if 和 #endif 之间的所有内容标记为 C# 文件中的注释

> ID：12917699
> 
> 赞同：3
> 
> 时间：2012-10-16T15:04:00.267
> 
> 标签：monodevelop, preprocessor-directive

我正在使用与 Unity 游戏引擎捆绑的 MonoDevelop 版本。我以前从未在 C# 中使用过#if/#endif，所以我从未注意到这一点。我在一个新的空文件上检查了这个。我该如何解决？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T18:02:18.370

我已经对此进行了一些尝试，我注意到“#if DEBUG”块的条件代码被注释掉了。当您已经到了构建发布代码的地步时，它可能会有所帮助。“调试”测试内容保留在您的代码中，但看起来像注释。这是我用来测试的东西，ymmv：

```
using System;
namespace testConditionalCompile
{
   class MainClass
   {
      public static void Main (string[] args)
      {

#if RELEASE         
          Console.WriteLine("Release code"); 
#endif          

#if DEBUG   
          Console.WriteLine("Debug code");          
#endif
        }
    }
} 
```

我意识到条件代码块不是编写它的最佳方式，但我认为它可能最能说明我的观点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-08-12T17:31:47.593

对于那些处理任何一个或两个`#if UNITY_IOS ... #elif UNITY_ANDROID`预处理器指令显示为已注释和/或有奇怪的代码格式化问题的人，**Monodevelop 仅根据您当前在构建设置中选择的任何平台格式化代码**。因此，您在下面看到的内容是有意的，因为 Monodevelop 对这段代码的处理基本上与注释代码相同。*逻辑*是因为它不会被执行，甚至不会包含在构建中，所以不应该在编辑器中检查它。因此格式化/注释掉的处理。我个人觉得这很烦人，因为无论我在构建设置中选择的当前平台如何，我都应该能够编写/查看格式化代码。

[![截屏](../Images/586c3992e4b38c93564e11964dc1216f.png)](https://i.stack.imgur.com/lgtnt.png)

# workflow - AppFabric 恢复命令失败

> ID：12917701
> 
> 赞同：0
> 
> 时间：2012-10-16T15:04:07.180
> 
> 标签：workflow, appfabric, workflowservice

在 AppFabric 中，我们看到一些暂停的工作流。当我们尝试手动恢复它们时，我们会收到错误：

> 在 net.pipe://[server]/[webSite]/[folder]/[workflowFile].xamlx/System.ServiceModel.Activities_IWorkflowInstanceManagement 上没有可以接受消息的端点侦听。这通常是由不正确的地址或 SOAP 操作引起的。有关更多详细信息，请参阅 InnerException（如果存在）。

此错误的原因可能是什么？这个端点应该在哪里定义？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T14:00:00.187

这可能是站点或应用程序（绑定）上未启用 net.pipe 的结果。如果您启用完整的 WCF 诊断跟踪，您将看到根本问题是什么。

它也可能是配置文件混乱的结果。我曾经不得不自己显式地将工作流控制端点添加到配置中。

# apache-flex - 将自动化库添加到 AIR 项目时找不到 Automation_agent 和 qtp_air 资源包

> ID：12917706
> 
> 赞同：3
> 
> 时间：2012-10-16T15:04:28.517
> 
> 标签：apache-flex, actionscript, air, automation, qtp

我正在尝试将自动化库添加到我在 Flash Builder 中的项目中，以便我们可以自动化我们的测试。

我已将此添加到其他编译器设置中：

```
-include-libraries+="${flexlib}/libs/automation/automation.swc","${flexlib}/libs/automation/automation_agent.swc","${flexlib}/libs/automatio n/automation_dmv.swc","${flexlib}/libs/automation/automation_spark.swc ","${flexlib}/libs/automation/automation_air.swc","${flexlib}/libs/aut omation/automation_airspark.swc","${flexlib}/libs/automation/qtp_air.swc" 
```

和`-locale nl_BE fr_BE`

编译后我得到2个错误：

```
Unable to resolve resource bundle "automation_agent"
Unable to resolve resource bundle "qtp_air" 
```

但是，在我的**nl_BE**和**fr_BE**文件夹`flex_sdk\frameworks\locale\`中，**automation_agent_rb.swc**和**qtp_air_rb.swc**存在。

如果我切换到**en_US**，它工作正常。

有人可以向我解释为什么 Flash Builder 找不到这些资源包吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-22T16:30:49.630

尝试将automation_agent_rb.swc 和qtp_air_rb.swc 显式添加到您的库路径中。

# sql-server-2008 - 在 sql 2008 R2 中，如何将一个表中的 2 列与另一个表中的 2 列连接起来？

> ID：12917711
> 
> 赞同：1
> 
> 时间：2012-10-16T15:04:36.247
> 
> 标签：sql-server-2008, inner-join, multiple-columns

我有 2 张桌子。在表 1 中，我有 2 列——cust_npa 和 cust_nxx。在表 2 中，我有 2 列——valid_npa 和 valid_nxx。table2.valid_npa 中的每个条目在 table2.valid_nxx 中都有对应的条目。

```
valid_npa   valid_nxx
201         551
201         552
201         553
202         851
202         852 
```

我希望从 table2 返回 table1 中具有 valid_nap 和 valid_nxx 组合的所有行。

例如，不会返回 table1 中 cust_npa 为 201 且 cust_nxx 为 852 的行（因为这不是来自 table2 的有效组合）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T15:06:36.650

```
select * from table_A as A
inner join table_B as B
on A.id = B.id and A.name = B.name 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T15:07:32.197

```
select valid_npa, valid_nxx from table2
intersect
select cust_npa, cust_nxx from table1 
```

# flash - 请求 HTTPS 时，Chrome 中不弹出登录窗口

> ID：12917712
> 
> 赞同：0
> 
> 时间：2012-10-16T15:04:42.260
> 
> 标签：flash, google-chrome, https

我有一个与需要登录的 HTTPS 服务通信的应用程序。

在除 Chrome (v 22.0.1229.94) 之外的所有浏览器上，一旦发出 HTTPS 请求，浏览器自己的登录窗口就会弹出并要求进行身份验证。正如您可能已经猜到的那样，在 Chrome 中它不会发生，并且所有 HTTPS 请求都返回 401。但是，如果您直接访问此类请求，则会弹出登录窗口，并且一旦登录，就会正确检索响应。

这是 Chrome 内部 Flash 插件的限制还是其他原因？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-22T13:31:07.180

显然，当请求应用程序在与所请求服务不同的域上运行时，登录弹出窗口被阻止。

当域匹配时，一切正常。对于其他情况 - 使用 Firefox。

# wpf - 简单的 MVVM 绑定问题

> ID：12917713
> 
> 赞同：1
> 
> 时间：2012-10-16T15:04:49.553
> 
> 标签：wpf, vb.net, data-binding, mvvm

我有一个文本框和一个按钮。按钮命令应该更改绑定到文本框的属性。

但是我在命令执行后看不到任何视觉变化。我认为与 wpf 绑定有关的简单问题

请帮我解决这个问题

**应用程序来源：**

```
<UserControl.DataContext>
    <local:SampleViewModel />
</UserControl.DataContext>
<Grid>
    <StackPanel>
        <TextBox Height="23" Width="120" Text="{Binding MyName}"  />
        <Button Content="Click" Command="{Binding ButtonCommand}" />
    </StackPanel>
</Grid> 
```

**视图模型：**

```
Private _myName As String
Public Property MyName As String
  Get
    Return _myName
  End Get
  Set(value As String)
    _myName = value
      OnPropertyChanged("MyName")
  End Set
End Property

Public _buttonCommand As DelegateCommand
Public ReadOnly Property ButtonCommand As DelegateCommand
Get
  Return If(_buttonCommand IsNot Nothing, _buttonCommand, 
  New DelegateCommand(AddressOf Execute, AddressOf CanExecute))
End Get
End Property

Private Sub Execute()
  MyName = "Executed"
End Sub

Private Function CanExecute() As Boolean
  Return True
End Function

Public Event PropertyChanged As PropertyChangedEventHandler
Private Sub OnPropertyChanged(propertyName As String)
  RaiseEvent PropertyChanged(Me, New PropertyChangedEventArgs(propertyName))
End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T15:32:52.183

这是一个适用于您的确切 XAML 的代码（我从[http://wpftutorial.net/DelegateCommand.html 获取](http://wpftutorial.net/DelegateCommand.html)了 DelegateCommand 实现）对不起，它是 C#，我真的不喜欢 VB：D

```
public class DelegateCommand : ICommand
{
    private readonly Predicate<object> _canExecute;
    private readonly Action<object> _execute;

    public event EventHandler CanExecuteChanged;

    public DelegateCommand(Action<object> execute)
        : this(execute, null)
    {
    }

    public DelegateCommand(Action<object> execute,
                   Predicate<object> canExecute)
    {
        _execute = execute;
        _canExecute = canExecute;
    }

    public virtual bool CanExecute(object parameter)
    {
        if (_canExecute == null)
        {
            return true;
        }

        return _canExecute(parameter);
    }

    public virtual void Execute(object parameter)
    {
        _execute(parameter);
    }

    public void RaiseCanExecuteChanged()
    {
        if (CanExecuteChanged != null)
        {
            CanExecuteChanged(this, EventArgs.Empty);
        }
    }
}

public class SampleViewModel : INotifyPropertyChanged
{
    // Create the OnPropertyChanged method to raise the event 
    protected void OnPropertyChanged(string name)
    {
        PropertyChangedEventHandler handler = PropertyChanged;
        if (handler != null)
        {
            handler(this, new PropertyChangedEventArgs(name));
        }
    }
    public event PropertyChangedEventHandler PropertyChanged;

    public DelegateCommand _buttonCommand;
    public DelegateCommand ButtonCommand
    {
        get
        {
            if (_buttonCommand == null)
            {
                _buttonCommand = new DelegateCommand(Execute);
            }
            return _buttonCommand;
        }
    }

    public void Execute(object o)
    {
        MyName = "executed";
    }

    public string MyName { get { return _myName; } set { _myName = value; OnPropertyChanged("MyName"); } }

    private string _myName;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-16T15:29:56.153

请执行下列操作：

1.MainWindow类实现INotifyPropertyChanged

2\. 在 Public Sub New() 中确保你写`Me.DataContext = Me`来设置 DataContext

**注意**：如果您使用 ViewModel 并在 XAML 中设置，请忽略第 2 步

3\. 像这样修改 ProperyChanged： `Public Event PropertyChanged As PropertyChangedEventHandler Implements INotifyPropertyChanged.PropertyChanged`

只有[正确](http://msdn.microsoft.com/en-us/library/ms229614.aspx)[实现`INotifyPropertyChanged`](http://msdn.microsoft.com/en-us/library/ms229614.aspx)后，Binding 才会在 PropertyChanged 事件之后正确刷新 MyName 属性

# regex - 如何在emacs中用A [替换空格

> ID：12917715
> 
> 赞同：0
> 
> 时间：2012-10-16T15:04:50.923
> 
> 标签：regex, emacs

我有一个这样的输入文件

```
 line 1
    line 2
    line 3 
```

我要替换的所有行之前有四个空格。

我希望最终结果是：

```
A[line 1
A[line 2
A[line 3 
```

（这很有趣，所以编辑器不想逐行显示）

我试过了`M-x replace-regex ^[]+ -> A\[`，但得到错误`invalid regex "Unmatched [ or [^"`

我试过了`M-x replace-regex ^[]+ -> A[`，但得到同样的错误。

更换`[`是个问题。如何解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-16T15:11:58.203

尝试

```
M-x query-replace-regex RET ^    RET A[ RET
                             ^^^
                          notice the 4 spaces here 
```

在您的示例中，您在字符类中缺少一个空格：`^[ ]+`

更漂亮的可能是：`^[[:space:]]+`对于每一种空白。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-16T18:34:32.807

```
M-x query-replace-regex RET ^ + RET A[ RET 
```

因为它是一种要替换的字符，所以不需要括号或类

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-16T17:31:09.347

[矩形](http://www.gnu.org/software/emacs/manual/html_node/emacs/Rectangles.html)为您提供了另一种处理这些问题的方法。[Cua-mode](http://trey-jackson.blogspot.ca/2008/10/emacs-tip-26-cua-mode-specifically.html)提供了一个更好的系统。要使用它，首先将以下内容添加到您的 .emacs 中：

```
(setq cua-enable-cua-keys nil)
(cua-mode) 
```

然后，`*`在下面的点：

```
* 第 1 行
    2号线
    3号线

```

点击`C-enter`，然后使用箭头键（或`C-n`和`C-f`）移动指向：

```
    1号线
    2号线
   *第 3 行

```

空白将全部突出显示。键入`A[`以插入字符。然后点击`C-w`删除空格。

# c# - 通用方法问题 - 引用类型 T

> ID：12917716
> 
> 赞同：3
> 
> 时间：2012-10-16T15:04:52.467
> 
> 标签：c#, .net, servicestack

我有一个方法，我希望传递一个`SqlExpression`连接字符串来加载给定类型的数据。问题是我似乎无法确定语法。我的想法是能够调用`static`如下方法：

```
OrmLiteConfig.DialectProvider = ServiceStack.OrmLite.MySqlDialect.Provider;
SqlExpressionVisitor<SampleItem> ev = OrmLiteConfig.DialectProvider.ExpressionVisitor<SampleItem>();
var result = SomeClass.Query<SampleItem>(ev, connectionString); 
```

使用声明`SomeClass`为的方法：

```
public static List<T> Query<T>(SqlExpressionVisitor<T> ev, string connectionString)
{
    IDbConnection conn = connectionString.OpenDbConnection();
    var result = conn.Select<T>(ev);
    return result;
} 
```

但是，我调用该`Select`方法的方式给了我语法错误：

> “错误 10 'T' 必须是具有公共无参数构造函数的非抽象类型，才能将其用作泛型类型或方法中的参数 'T'”

我是泛型新手（显然）。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-16T15:07:54.483

> “T”必须是具有公共无参数构造函数的非抽象类型

因此，您需要确保`T`具有无参数构造函数。这仅仅意味着应用以下通用约束：

```
public static List<T> Query<T>(SqlExpressionVisitor<T> ev, string connectionString)
  where T : new()
{ ... } 
```

您的类可能已经满足条件，您只需要确保其他人不能传入不可构造的类型。

错误的原因是`Select`您调用的方法添加了这些相同的约束。您基本上对您的方法保持相同的要求。

# c - 在 C 中调整数组的大小

> ID：12917727
> 
> 赞同：5
> 
> 时间：2012-10-16T15:05:37.927
> 
> 标签：c, arrays, resize

假设我分配了一个这样的数组：

```
char* array[]={"This"}; 
```

后来我想给数组[]分配一个新值，以便它存储“这个”和“那个”，有没有办法可以改变数组的大小，以便它可以容纳新的值？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-10-16T15:06:37.507

不，您不能更改数组的大小。`char*`您可以根据需要使用动态分配的列表`realloc()`：

```
#include <stdlib.h>
#include <string.h>
#include <stdio.h>

int main()
{
    char** array = malloc(1 * sizeof(*array));

    if (array)
    {
        array[0] = "This";

        printf("%s\n------\n", array[0]);

        char** tmp = realloc(array, 2 * sizeof(*array));
        if (tmp)
        {
            array = tmp;
            array[1] = "That";

            printf("%s\n", array[0]);
            printf("%s\n", array[1]);
        }

        free(array);
    }
    return 0;
} 
```

见在线演示：[https](https://ideone.com/ng00k) ://ideone.com/ng00k 。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-16T15:07:28.243

没有办法调整数组的大小。您可以简单地创建一个大小为 2 的新数组，然后将所有数据从前一个数组复制到新数组。 `realloc`用动态内存为你做这件事。更好的方法是使用数据结构，例如`LinkedLists`或`Vectors`您可以在网上找到更多信息。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-16T15:48:29.067

您不能调整数组对象的大小。

您必须动态分配内存`array`并使用`realloc`. 例子：

```
size_t current_size = 0;

char **array = malloc((current_size + 1) * sizeof *array);
if (array)
{
  array[current_size++] = "This";
}
...
/**
 * If realloc cannot extend the buffer, it will return NULL and leave
 * the original buffer intact; however, if we assign NULL back to array,
 * we lose our handle to the original buffer, causing a memory leak, so
 * we assign the result to a temporary variable.
 */
char **tmp = realloc(array, (current_size + 1) * sizeof *array)
if (tmp)
{
  array = tmp;
  array[current_size++] = "That";
}
else
{
  // realloc failed to extend the buffer; original buffer
  // is left intact.
} 
```

注意事项：

`realloc`是一个相对昂贵的调用，因此您（通常）不想像我在这里所做的那样一次扩展一个元素。一个更常见的策略是选择一个涵盖大多数情况的初始起始大小，如果需要扩展缓冲区，则将其大小加倍。

您可以将调整大小操作抽象为一个单独的函数，如下所示：

```
int addItem(char ***arr, char *newElement, size_t *count, size_t *bufSize)
{
  if (*count == *bufSize)
  {
     // we've run out of room; extend the buffer
     char **tmp = realloc(**arr, 2 * *bufSize * sizeof **arr);
     if (tmp)
     {
       *arr = tmp;
       *bufSize *= 2;
     }
     else
     {
       // could not extend the buffer; return failure code
       return 0;
     }
  }
  (*arr)[(*count)++] = newElement;
} 
```

并将其称为

```
#define N ... // initial array size

char **array = malloc(N * sizeof *array);
size_t bufSize = N;
size_t count = 0;
...
if (addItem(&array, "This", &count, &bufSize))
  printf("# elements = %zu, buffer size = %zu\n", count, bufSize);

if (addItem(&array, "That", &count, &bufSize))
  printf("# elements = %zu, buffer size = %zu\n", count, bufSize); 
```

这一切都是未经测试的，我无法想象；没有任何明示或暗示的保证。但这应该足以为您指明正确的方向。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-16T15:11:02.967

这是不可能的。不过，您可以分配一个 char* 数组：

```
char **array = calloc(2, sizeof(char *));
array[0] = "This";
array[1] = "That"; 
```

# iphone - 创建一个运行脚本来打包和压缩编译的库

> ID：12917729
> 
> 赞同：0
> 
> 时间：2012-10-16T15:05:45.917
> 
> 标签：iphone, objective-c, ios, xcode, bash

所以我想创建一个运行脚本（构建阶段），它将自动创建一个 .zip 文件夹，其中包含已编译的库（.a 文件）和分发所需的所有相关 .h 文件。

有没有人为此提供示例 bash 脚本？可以在不同项目中可靠地复制的东西？

非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T16:12:12.320

我没有包括分发构建检查。

```
echo "Tar $BUILT_PRODUCTS_DIR/ to ~/Desktop/myHeader.tar"
tar -cvf ~/Desktop/myHeader.tar -C $BUILT_PRODUCTS_DIR/ .
echo "DONE with script:" 
```

注意：它只包括公共头 + 静态库。如果您包含多个静态库，我还没有尝试过它是如何工作的。希望这可以给你一些线索，为我工作

# c++ - 在 Ubuntu 中使用 OpenSSL 链接问题

> ID：12917731
> 
> 赞同：4
> 
> 时间：2012-10-16T15:05:50.067
> 
> 标签：c++, ubuntu, openssl, linker-errors

我已经使用`sudo apt-get install openssl-dev`. 当我尝试使用`Netbeans`它编译它时，会出现以下错误。我该如何解决这个问题？

```
g++     -lssl -o dist/Debug/GNU-Linux-x86/cppapplication_2 build/Debug/GNU-Linux-x86/main.o -L/home/sercan/Desktop/openssl-0.9.8h-1-lib/lib
build/Debug/GNU-Linux-x86/main.o: In function `main':
/home/sercan/NetBeansProjects/CppApplication_2/main.cpp:46: undefined reference to `OPENSSL_add_all_algorithms_noconf'
/home/sercan/NetBeansProjects/CppApplication_2/main.cpp:48: undefined reference to `ERR_load_crypto_strings'
/home/sercan/NetBeansProjects/CppApplication_2/main.cpp:58: undefined reference to `d2i_PKCS12_fp'
/home/sercan/NetBeansProjects/CppApplication_2/main.cpp:66: undefined reference to `ERR_print_errors_fp'
/home/sercan/NetBeansProjects/CppApplication_2/main.cpp:72: undefined reference to `PKCS12_parse'
/home/sercan/NetBeansProjects/CppApplication_2/main.cpp:76: undefined reference to `ERR_print_errors_fp'
/home/sercan/NetBeansProjects/CppApplication_2/main.cpp:82: undefined reference to `PKCS12_free'
/home/sercan/NetBeansProjects/CppApplication_2/main.cpp:96: undefined reference to `PEM_write_PrivateKey'
/home/sercan/NetBeansProjects/CppApplication_2/main.cpp:104: undefined reference to `PEM_write_X509_AUX'
/home/sercan/NetBeansProjects/CppApplication_2/main.cpp:108: undefined reference to `sk_num'
/home/sercan/NetBeansProjects/CppApplication_2/main.cpp:114: undefined reference to `sk_value'
/home/sercan/NetBeansProjects/CppApplication_2/main.cpp:114: undefined reference to `PEM_write_X509_AUX'
/home/sercan/NetBeansProjects/CppApplication_2/main.cpp:112: undefined reference to `sk_num' 
```

**我的代码在这里：**

```
#include <stdio.h>
#include <stdlib.h>
#include <openssl/pem.h>
#include <openssl/err.h>
#include <openssl/pkcs12.h>

/* Simple PKCS#12 file reader */

int main(int argc, char **argv)
{

    FILE *fp;
    EVP_PKEY *pkey;
    X509 *cert;
    STACK_OF(X509) *ca = NULL;
    PKCS12 *p12;
    int i;

    if (argc != 4) {
        fprintf(stderr, "Usage: pkread p12file password opfile\n");
        exit(1);
    }

    OpenSSL_add_all_algorithms();
    ERR_load_crypto_strings();

    if (!(fp = fopen(argv[1], "rb"))) {
        fprintf(stderr, "Error opening file %s\n", argv[1]);
        exit(1);
    }

    p12 = d2i_PKCS12_fp(fp, NULL);

    fclose(fp);

    if (!p12) {
        fprintf(stderr, "Error reading PKCS#12 file\n");
        ERR_print_errors_fp(stderr);
        exit(1);
    }

    if (!PKCS12_parse(p12, argv[2], &pkey, &cert, &ca)) {
        fprintf(stderr, "Error parsing PKCS#12 file\n");
        ERR_print_errors_fp(stderr);
        exit(1);
    }

    PKCS12_free(p12);

    if (!(fp = fopen(argv[3], "w"))) {
        fprintf(stderr, "Error opening file %s\n", argv[1]);
        exit(1);
    }

    if (pkey) {
        fprintf(fp, "***Private Key***\n");
        PEM_write_PrivateKey(fp, pkey, NULL, NULL, 0, NULL, NULL);
    }

    if (cert) {
        fprintf(fp, "***User Certificate***\n");
        PEM_write_X509_AUX(fp, cert);
    }

    if (ca && sk_X509_num(ca)) {
        fprintf(fp, "***Other Certificates***\n");
        for (i = 0; i < sk_X509_num(ca); i++)
            PEM_write_X509_AUX(fp, sk_X509_value(ca, i));
    }

    fclose(fp);

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-16T15:15:46.360

您还需要链接到 libcrypto - 添加`-lcrypto`到链接行，您的代码应该正确链接。

```
natsu:~/openssl% gcc -o test test.c -L/usr/lib -lssl -lcrypto 
```

正确链接，同时：

```
natsu:~/openssl% gcc -o test test.c -L/usr/lib -lssl         
/tmp/ccvA7iNe.o: In function `main':
test.c:(.text+0x4c): undefined reference to `OPENSSL_add_all_algorithms_noconf'
test.c:(.text+0x51): undefined reference to `ERR_load_crypto_strings'
test.c:(.text+0xb9): undefined reference to `d2i_PKCS12_fp'
test.c:(.text+0x103): undefined reference to `ERR_print_errors_fp'
test.c:(.text+0x133): undefined reference to `PKCS12_parse'
test.c:(.text+0x16a): undefined reference to `ERR_print_errors_fp'
test.c:(.text+0x180): undefined reference to `PKCS12_free'
test.c:(.text+0x22c): undefined reference to `PEM_write_PrivateKey'
test.c:(.text+0x266): undefined reference to `PEM_write_X509_AUX'
test.c:(.text+0x27b): undefined reference to `sk_num'
test.c:(.text+0x2b7): undefined reference to `sk_value'
test.c:(.text+0x2c9): undefined reference to `PEM_write_X509_AUX'
test.c:(.text+0x2d9): undefined reference to `sk_num'
collect2: ld returned 1 exit status 
```

才不是。

# iphone - UIRefreshControl 有条件地为 ios 5 及更低版本声明

> ID：12917735
> 
> 赞同：1
> 
> 时间：2012-10-16T15:06:09.077
> 
> 标签：iphone, ios, ios4

我正在使用`UIRefreshControl`下拉刷新 iOS 6，它正在工作。我正在使用自定义委托在完成时进行更新，在我调用的那个方法中，

```
[self->refresh endRefreshing]; 
```

我已经宣布，

```
UIRefreshControl *refresh; 
```

在接口文件中，因为我无法调用

```
[self->refresh endRefreshing] 
```

通过自定义委托方法。

这一切都适用于 iOS 6，但在较低版本的 iOS 上，它会失败，因为 `UIRefreshControl' 仅适用于 iOS 6 及更高版本。

我如何有条件地声明它们以便它在 iOS6 及更低版本上都可以使用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T15:17:03.703

1.  将实例变量声明为`id`。
2.  将变量转换为`UIRefreshControl *`您使用它的任何时候。
3.  在您使用它的地方周围，使用它`if (NSClassFromString(@"UIRefreshControl") != Nil) { ... }`以确保`UIRefreshControl`可用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-16T15:26:41.530

或者使用`[[UIDevice currentDevice] systemVersion]`自定义拉来刷新，例如这个：[https ://github.com/leah/PullToRefresh](https://github.com/leah/PullToRefresh)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-29T03:44:23.460

[https://github.com/instructure/CKRefreshControl](https://github.com/instructure/CKRefreshControl)是 UIRefreshControl 的一个替代品，它在 iOS6+ 上使用 UIRefreshControl，在以前的版本上使用自定义的 pull-to-refresh 逻辑。我与它的开发没有任何关系，但它工作得很好！

# html - 创建输入链接按钮

> ID：12917740
> 
> 赞同：1
> 
> 时间：2012-10-16T15:06:34.877
> 
> 标签：html, input

你好所有一个快速的问题..

我正在构建一个静态 html 页面，并且想使用按钮将一个页面添加到另一个页面，现在使用链接是更简单的选择，但我希望没有任何 javascript 的按钮的效果..

所以我想使用一个输入按钮，但它可以链接到一个html页面，就像一个标签可以href一样。

我在按照这个例子的思路思考，但没有 js ..

```
<form>
  <input type="button" value="Read more" class="button" onclick="window.location.href='testimonials.html'">
</form> 
```

这不起作用，但我正在寻找这个功能？是否可以？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-16T15:09:26.487

只需将表单提交到 URL。

```
<form action="testimonials.html">
  <input type="submit" value="Read more">
</form> 
```

......但按钮应该做的事情。链接去地方。不要向人们发送混合消息，使用链接。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-16T15:10:17.370

你拼错了“onclick” :)

编辑：如果你想避免使用 javascript，你可以使用 CSS 创建一个类似按钮的链接：

```
<a href="testimonials.html" style="display: inline-block; border: 1px solid #AAA; background-color: #CCC; margin: 5px; width: 100px; cursor: pointer; text-align: center; color: #000; text-decoration: none;">Read More</a> 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-10-16T15:08:00.257

试试这个代码：

```
<form>
  <input type="button" value="Read more" class="button" onlick="window.location='testimonials.html'">
</form> 
```

# python - 需要一种算法来优化分层形式的 Python 字典分组

> ID：12917747
> 
> 赞同：0
> 
> 时间：2012-10-16T15:06:46.777
> 
> 标签：python, algorithm

以前我问过一个关于如何在层次结构列表中对字典进行分组的问题。[以分层形式对 Python 字典进行分组](https://stackoverflow.com/questions/9791778/grouping-python-dictionaries-in-hierachical-form)

这种方法效果很好，但我现在需要优化。字典有很大的内存开销，当我们处理大量记录时，这种分组变得非常慢。

我想知道是否有任何算法可以用来减少进行分组所需的时间。

PS：只要它给我相同的分层格式，我不介意更改数据结构。

谢谢。

# javascript - 从 contentEditable div 获取最后输入的单词

> ID：12917750
> 
> 赞同：0
> 
> 时间：2012-10-16T15:06:54.387
> 
> 标签：javascript, html, range, contenteditable

我有一个 div 标签，其中 contenteditable 设置为 true。我正在尝试找出 div 中最后输入的单词。

例如，如果我输入`This is a test`并点击一个空格，我希望能够得到这个词`test`

我希望能够使用这个逻辑，以便我可以测试输入的每个单词（按下空格后）。

如果有人可以帮助我，那就太好了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T15:16:27.433

一个简单的解决方案如下

```
var str = "This is a test "; // Content of the div
var lastWord = str.substr(str.trim().lastIndexOf(" ")+1); 
```

对于较旧的浏览器， trim 可能需要 shim。( `.replace(/\s$/,"")`)

要像您一样删除标点符号，`" Test!!! "`还可以进行如下替换：

```
lastWord.replace(/[\W]/g,""); 
```

根据您的需要，您可能希望对要省略的字符进行更具体的定义，而不是`\W`。

如果您还想在标点字符上触发事件处理程序，而不仅仅是在空格上，则不需要最后一个替换。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-16T15:29:28.290

您首先必须知道内容何时被编辑。使用jQuery，可以做到

```
​$("div").on("keyup", function(){ /* code */ }); 
```

然后，您必须获取整个文本并将其拆分为单词

```
var words = $(this).text().trim().split(' '); 
```

获取最后一个单词就像获取`words`数组的最后一个元素一样复杂。

## 这是整个代码

**HTML**

```
​&lt;div contenteditable="true">Add text here</div>​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​ 
```

**JavaScript（使用 jQuery）** ​</p>

```
$("div").on("keyup", function(){
    var words = $(this).text().trim().split(' '),
        lastWord = words[words.length - 1];
    console.log(lastWord);
});​​​​​​​ 
```

**[演示](http://jsfiddle.net/pioul/L8VMd/)**

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-01-13T01:16:39.403

## 这是终极方法：

```
// listen to changes (do it any way you want...)
document.querySelectorAll('div')[0].addEventListener('input', function(e) {
    console.log( getLastWord(this.textContent) );
}, false);

function getLastWord(str){
   // strip punctuations
   str = str.replace(/[\.,-\/#!$%\^&\*;:{}=\_`~()]/g,' ');
   // get the last word
   return str.trim().split(' ').reverse()[0];
} 
```

## [演示页面](http://jsfiddle.net/SH8xZ/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-16T15:45:47.613

您可以尝试从可编辑的 div 中获取最后一个单词。

**HTML**

```
<div id='edit' contenteditable='true' onkeypress="getLastWord(event,this)">
  </div> 
```

**JS**

```
 function getLastWord(event,element){
             var keyPressed = event.which;
             if(keyPressed == 32){ //Hits Space
                 var val = element.innerText.trim();
                 val = val.replace(/(\r\n|\n|\r)/gm," ");
                 var idx = val.lastIndexOf(' ');
                 var lastWord = val.substring(idx+1);
                 console.log("Last Word " + lastWord);
             }
        } 
```

试试这个链接[http://jsfiddle.net/vV2mN/18/](http://jsfiddle.net/vV2mN/18/)

# matlab - 如何在matlab中绘制这个吉布斯傅立叶图

> ID：12917752
> 
> 赞同：0
> 
> 时间：2012-10-16T15:06:54.367
> 
> 标签：matlab

请有人帮我，我需要用吉布斯振荡来绘制这个闭合的波齿，我有一天要做，但我从来没有用 Matlab 绘制。

这是我尝试为吉布斯振荡波编程的图表：http: [//imageshack.us/a/img585/9724/kakai12.jpg](http://imageshack.us/a/img585/9724/kakai12.jpg)

这就是我所做的，但如果它以这种方式工作，则不是真的。

```
clear all; 
syms x n; 
f=(-4)*(x-pi); 
T=2; w0=((2*pi)/T); 
fb=f*sin(n*w0*x); 
bn=(2/x)*int(fb,x,0,2*pi); 
x=0:1/(1000):15; 
bn_12=bn*sin(n*w0*x); 
c=1; j=100; 
fs=symsum(bn_12,n,c,j) 
```

有人可以帮我吗。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T15:21:23.253

现在无法测试这个，但这样的东西应该可以工作：

```
t = -4:0.01:4 %Create numerical vector of time
T = 2; %Period, adjust as suitable
V = 4; %Adjust to appropriate amplitude
w0 = 2*pi/T; %Angular frequency

line = (V/pi) * w0 * t - V; %Start with straight line with correct gradient and y intercept
%Then subtract 2*V for every 2*pi
step = floor((w0 * t) / (2*pi))*2*V; %So step should be a step function that steps up 2V every 2pi
sawtooth = line  - step;

plot(w0*t, sawtooth) 
```

# iphone - 从自定义 urlscheme 启动应用程序

> ID：12917757
> 
> 赞同：0
> 
> 时间：2012-10-16T15:07:03.623
> 
> 标签：iphone, ios, xcode, ipad

我正在开发一个 iPhone 应用程序，它可以通过电子邮件中的自定义 URL 方案的链接启动。

当应用程序从电子邮件启动时，我想用附加到启动 URL 的订单号填充一个文本框`(appname:\\?orderno=1234)`。我可以从 URL 启动应用程序。

我的问题是`orderno`从 URL 中提取变量并将值添加到文本框中。我已经通过偏好实现了它，但它仅在应用程序第二次启动时显示了价值。如何提取变量中的变量，`Appdelegate`然后允许它在视图控制器中使用。

请帮忙！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T15:28:01.257

您是否尝试过在您的 applicationDelegate 中实现 -handleOpenUrl:？

另请参阅此问题： [如何使用 UIApplication handleOpenURL 通知](https://stackoverflow.com/questions/9000179/how-to-use-uiapplication-handleopenurl-notifications)

# ssis - 为什么 SSIS TOKEN 函数无法计算相邻的列分隔符？

> ID：12917758
> 
> 赞同：4
> 
> 时间：2012-10-16T15:07:05.123
> 
> 标签：ssis, tokenize, sql-server-2012

我在名为 TOKEN() 的表达式编辑器中遇到了 SQL Server Integration Services 2012 的新字符串函数的问题。

这应该可以帮助您解析分隔记录。如果记录来自平面文件，您可以使用平面文件源执行此操作。在这种情况下，我正在处理以字符串形式存储在数据库 VARCHAR 字段中的旧分隔导入记录。现在需要将它们提取、处理并重新导出为分隔字符串。例如：

> 1^苹果^0001^01/01/2010^食蚁兽^A1
> 2^香蕉^0002^03/15/2010^熊^B2
> 3^蔓越莓^0003^4/15/2010^乌鸦^C3

如果这些字符串在名为 OldImportRecord 的列中，分隔符是插入符号（如图所示），并且我们希望将第五个字段放入派生列中，我们将使用如下表达式：

```
TOKEN(OldImportRecord,"^",5) 
```

这会返回 Aneater、Bear、Crow 等。其实我们可以为这条记录中的每个字段创建 Derived Columns（注意索引是从一开始的），根据需要更改它们，然后再构建另一个分隔记录用于导出.

这就是问题所在。如果我们的某些数据包含一些空字符串（或呈现为空字符串的 Null）怎么办？

> 4^^0004^6/15/2010^鸭^D4

TOKEN() 无法计算相邻的列分隔符，这会导致列数丢失。现在它只看到五列而不是六列。我们的 TOKEN(OldImportRecord,"^",5) 返回“D4”而不是预期的“Duck”。当我们提取第四列时，我们最终尝试将“Duck”放入 Date 列中，然后各种有趣的事情接踵而至。

这是部分解决方法：

```
TOKEN(REPLACE(OldImportRecord,"^^","^ ^"),"^",5) 
```

请注意，这会错过每隔一个分隔符对，因此对于像“5^^^^Emu^E5”这样的字符串，它会失败，它在 REPLACE() 之后看起来像“5^ ^^ ^Emu^E5”。列数仍然错误。

所以这是我的完整解决方法。这包括两个嵌套的 REPLACE statements()、一个用于删除多余空格的 RTRIM() 和一个 DT_STR 强制转换，因为我想将结果保留在 VARCHAR 中：

```
(DT_STR,255,1252)RTRIM(TOKEN(REPLACE(REPLACE(OldImportRecord,"^^","^ ^"),"^^","^ ^"),"^",5)) 
```

我发布此信息以供参考，因为其他人也可能遇到此问题。

有没有人有更好的解决方法，甚至是真正的解决方案？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T21:12:14.907

### *问题原因*：

**`TOKEN`**SSIS 中的方法使用**C++**`strtok`中函数的实现。我在阅读[**Microsoft® SQL Server® 2012 Integration Services**](http://shop.oreilly.com/product/0790145344328.do)一书时收集了这些信息。**它在第113**页的注释中提到（*我喜欢这本书！很多很好的信息。*）。**[](http://shop.oreilly.com/product/0790145344328.do)**

 *******我搜索了`strtok`函数的实现，找到了以下链接。

[INFO: strtok(): C Function -- Documentation Supplement](http://support.microsoft.com/kb/51327) - 此链接中的代码示例显示该函数确实忽略了连续的分隔符。

以下 SO 问题的答案指出该`strtok`函数旨在忽略连续分隔符。

[需要知道使用 strtok() 的两个标记分隔符之间何时没有数据出现](https://stackoverflow.com/questions/8705844/need-to-know-when-no-data-appears-between-two-token-separators-using-strtok)

[具有连续分隔符的 strtok_s 行为](https://stackoverflow.com/questions/8977836/strtok-s-behaviour-with-consecutive-delimiters)

我认为`TOKEN`and`TOKENCOUNT`函数正在按照设计工作，但 SSIS 是否应该这样做可能是 Microsoft SSIS 团队的一个问题。

### 原始帖子 - 以上部分是更新：

我根据您的数据输入在 SSIS 2012 中创建了一个简单的包。正如您在问题中所描述的那样，该`TOKEN`功能的行为不符合预期。我同意你的观点，该功能似乎不起作用。这篇文章**不是**对您原始问题的回答。

这是以相对简单的方式编写表达式的另一种方法。这仅在输入记录中的最后一段始终具有值（例如*A1*、*B2*、*C3*等）时才有效。

***表达式可以重写为***：

该语句将输入记录作为参数，分隔符插入符号 (^) 作为第二个参数。第三个参数计算被分隔符分割时记录中的段总数。如果您在最后一个段中有数据，则保证有两个段。然后，您可以减去 1 以获取倒数第二段。

```
(DT_STR,50,1252)TOKEN(OldImportRecord,"^",TOKENCOUNT(OldImportRecord,"^") - 1) 
```

我创建了一个带有数据流任务的简单包。OLE DB 源检索数据，派生的转换按照下面的屏幕截图解析和拆分数据。然后将输出插入到目标表中。您可以在最后一个屏幕截图中看到源表和目标表。目标表有两列。第一列存储倒数第二个段数据和基于分隔符的段计数（这又是不正确的）。您可以注意到最后一条记录没有获取正确的结果。如果最后一条记录没有 value `8`，那么上面的表达式将失败，因为表达式将计算为零索引。

希望这有助于简化您的表达方式。

如果您没有收到其他人的消息，我建议您在[**Microsoft Connect 网站**](http://connect.microsoft.com/)中记录此问题。

***创建表并填充脚本***：

```
CREATE TABLE [dbo].[SourceTable](
    [OldImportRecord] [varchar](50) NOT NULL
) ON [PRIMARY]
GO

CREATE TABLE [dbo].[DestinationTable](
    [NewImportRecord] [varchar](50) NOT NULL,
    [CaretCount] [int] NOT NULL
) ON [PRIMARY]
GO

INSERT INTO dbo.SourceTable (OldImportRecord) VALUES 
    ('1^Apple^0001^01/01/2010^Anteater^A1'),
    ('2^Banana^0002^03/15/2010^Bear^B2'),
    ('3^Cranberry^0003^4/15/2010^Crow^C3'),
    ('4^^0004^6/15/2010^Duck^D4'),
    ('5^^^^Emu^E5'),
    ('6^^^^Geese^F6'),
    ('^^^^Pheasant^G7'),
    ('8^^^^Sparrow^');
GO 
```

***数据流任务中的派生列转换***：

![派生列变换](../Images/bd77449ebe1e9846690c107d403b1eaf.png)

***源表和目标表中的数据***：

![源和目标表数据](../Images/f9eefe231d6981c3cb97fb7d62ff0538.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-23T20:47:57.170

TOKEN 不仅会跳过相邻的定界符，还会跳过前导和尾随定界符。因此，使用您的示例，如果您有一个如下所示的“好”字段：

1^苹果^0001^01/01/2010^食蚁兽^A1

后跟一个带有相邻和前导分隔符的分隔符，如下所示：

```
^^^0004^6/15/2010^Duck^ 
```

TOKENCOUNT 只会找到两个分隔符，您最终会得到 0004 分配给 Token1，6/15/2010 分配给 Token2，Duck 分配给 Token3。

我使用了另一种替换。我没有在相邻的分隔符之间放置空格，这对引导或训练没有帮助，而是使用替换来用我在文本中绝对找不到的字符包围分隔符。以下表达式对我很有效。它是罗嗦的，但它就是这样。

```
(DT_STR,255,1252)REPLACE(TOKEN(REPLACE(OldImportRecord,"^","~^~"),"^",1),"~","") 
```

当然，您可以将数字 1 替换为您想要的任何 Token，并根据您的需要调整演员阵容。希望有帮助。*******

# powershell - Powershell停止服务错误：找不到具有服务名称的任何服务

> ID：12917761
> 
> 赞同：2
> 
> 时间：2012-10-16T15:07:12.623
> 
> 标签：powershell

我正在编写将供应商软件部署到大型环境的脚本。第一步是停止相关服务。该脚本在我们的测试环境中执行良好，但我不是生产环境中的管理员，所以我确信这是权限问题。我无法获得 prod 环境的管理员权限，因此我需要尝试找出我可能需要设置的任何内容，以授予远程停止服务的权限。我发出以下命令来停止服务：

```
Stop-Service -InputObject $(Get-Service -Computer $destination.Server -Name ("moca."+$destEnv)) 
```

当我运行脚本时，我得到：

```
Cannot find any service with service name 'moca.WMSPRD'.
+ CategoryInfo          : ObjectNotFound: (moca.WMSPRD:String) [Get-Service], ServiceCommandException
+ FullyQualifiedErrorId : NoServiceFoundForGivenName,Microsoft.PowerShell.Commands.GetServiceCommand

Cannot validate argument on parameter 'InputObject'. The argument is null or empty. Supply an argument that is not null or empty and then try the command again.
+ CategoryInfo          : InvalidData: (:) [Stop-Service], ParameterBindingValidationException
+ FullyQualifiedErrorId : ParameterArgumentValidationError,Microsoft.PowerShell.Commands.StopServiceCommand 
```

该服务肯定存在，如果我 rdp 进入目标框并在本地发出 stop-service 命令，它将执行。所以有些东西阻止我远程停止服务。有任何想法吗？

编辑：一位同事建议使用 WMI，因此尝试将 Stop-Service 行替换为：

```
(Get-WmiObject -computer $destination.Server Win32_Service -Filter ("Name='moca."+$destEnv+"'")).InvokeMethod("StopService",$null) 
```

我得到：

```
Access is denied. (Exception from HRESULT: 0x80070005 (E_ACCESSDENIED))
+ CategoryInfo          : NotSpecified: (:) [Get-WmiObject], UnauthorizedAccessException
+ FullyQualifiedErrorId : System.UnauthorizedAccessException,Microsoft.PowerShell.Commands.GetWmiObjectCommand 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T11:59:42.000

如果您知道确切的服务名称，您可以试试这个

```
(Get-WmiObject -computerName $_.name Win32_Service -Filter "Name='moca'").StopService() 
```

这里我假设服务名称是 moca

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-09-15T14:50:44.423

DCOM 是否在远程计算机上工作？我知道如何使用使用 wsman 的远程 powershell 来做到这一点：

```
 invoke-command comp001 { stop-service adobearmservice } 
```

# asp.net - 如何在 VS 附带的水平菜单中添加一个指向子菜单的箭头？

> ID：12917762
> 
> 赞同：1
> 
> 时间：2012-10-16T15:07:18.740
> 
> 标签：asp.net, visual-studio-2010, visual-studio, menu

我只使用 Visual Studio (.net 4/VB) 附带的标准模板。我有一个像这样开始的水平菜单：

```
<asp:Menu ID="NavigationMenu" runat="server" CssClass="menu" EnableViewState="False" 
IncludeStyleBlock="False" Orientation="Horizontal"  
meta:resourcekey="NavigationMenuResource1"> 
```

该网站有多种语言（因此元：resourcekey）。我想要完成的是当用户将鼠标悬停在其中一个选项上，并且出现下拉选项时，我想要一个指向右侧的箭头，让他们知道还有更多选项（子菜单的子菜单）如果他们将鼠标悬停在该特定选项上。

这是我的菜单选项之一的示例：

```
<asp:MenuItem NavigateUrl="~/services/" Text="USS Services" 
meta:resourcekey="MenuItemResource4">
    <asp:MenuItem NavigateUrl="#" Text="Machine Vision Hardware" 
    meta:resourcekey="MenuItemResource20">
        <asp:MenuItem NavigateUrl="~/services/fixturing" Text="Fixturing" 
        meta:resourcekey="MenuItemResource21"/>
        <asp:MenuItem NavigateUrl="~/services/specialmachines" Text="Special Machine 
        Build" meta:resourcekey="MenuItemResource22"/>
        <asp:MenuItem NavigateUrl="~/services/controlpanels" Text="Control Panels 
        &amp; Workstations" meta:resourcekey="MenuItemResource23"/>
</asp:MenuItem> 
```

如果您将鼠标悬停在“USS 服务”上，您将看到“机器视觉硬件”，一个子菜单。如果您将鼠标悬停在“机器视觉硬件”上，您将看到夹具、特殊机器制造以及控制面板和工作站（子菜单的子菜单）。我想做的是在“机器视觉硬件”上有一个箭头，让用户知道如果他们将鼠标悬停在“机器视觉硬件”上，我们制造了 3 种不同的硬件。如果我只是在物理上输入 >，它看起来很草率。

这是我的菜单当前外观的示例：![这是我的菜单目前的样子](../Images/3e428d88712b99445dd0c4d47d4533aa.png)

因为我的电脑在店里，所以我现在没有 VS，但我可以对其进行硬编码。我确实有一个白色箭头的小 .jpg。有谁知道如何做到这一点？任何指导将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-01-04T10:34:18.443

设计师

```
<asp:Menu ID="Menu1" runat="server" CssClass="menu" EnableViewState="true" IncludeStyleBlock="false" Orientation="Horizontal" RenderingMode="Default">
<DataBindings>
    <asp:MenuItemBinding TextField="MenuText"  ImageUrlField="ImgUrl" NavigateUrlField="destUrl" ToolTipField="tooltip" />
</DataBindings> 
```

CSS

```
div.menu img
{
   float:right;
   width:15px;
   height:16px;
}
```

菜单项

```
<xsl:attribute name="ImgUrl">
        <xsl:value-of select="UrlImg"/>
      </xsl:attribute>
```

# c - OpenMP 并行前缀和加速

> ID：12917766
> 
> 赞同：1
> 
> 时间：2012-10-16T15:07:34.860
> 
> 标签：c, openmp

考虑下面的代码，取自[此处](http://openmp.org/forum/viewtopic.php?f=3&t=1231)。对于此代码，我得到以下执行时间：

```
time ./fibomp 40
Number of threads (OpenMP v200805): 2
finonacci(40) = 102334155

real    0m3.193s
user    0m3.180s
sys     0m0.000s

$ export OMP_NUM_THREADS=1
$ time ./fibomp 40
Number of threads (OpenMP v200805): 1
finonacci(40) = 102334155

real    0m3.224s
user    0m3.216s
sys     0m0.000s 
```

如您所见，没有太多的加速，绝对不是 Ruud 在 2011 年 11 月 1 日星期二上午 1:41 的电子邮件中提到的 2 倍加速。我在双核机器上运行它（可能是这样吗？）。我究竟做错了什么？（顺便说一句，奖励积分，`ptime`命令是什么？一些 SPARC Unix 命令？）

```
long comp_fib_numbers(int n)
{
  long fnm1, fnm2, fn;
  if ( n == 0 || n == 1 ) return(n);

  // In case the sequence gets too short, execute the serial version
  if ( n < 20 )
  {
     return(comp_fib_numbers(n-1)+comp_fib_numbers(n-2));
  }
  else
  {
     #pragma omp task shared(fnm1)
       fnm1 = comp_fib_numbers(n-1);
     #pragma omp task shared(fnm2)
       fnm2 = comp_fib_numbers(n-2);
     #pragma omp taskwait
       fn = fnm1 + fnm2;
       return(fn);
   }

} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-16T16:27:14.343

首先，为了确定，既然您声明`htop`显示正在使用单个内核，请确保您在编译器中启用了 OpenMP 支持。这样做的选项`-fopenmp`适用于 GCC、`-xopenmp`Sun/Oracle 编译器和`-openmp`Intel 编译器。

其次，`n = 20`对于并行实现来说，可能的界限太低了。一个无耻的插件 - 请参阅我的一位同事几个月前举办的 OpenMP 研讨会上的[课程材料。](https://sharepoint.campus.rwth-aachen.de/units/rz/HPC/public/Shared%20Documents/OMP1-Introduction_to_OpenMP.pdf)从幻灯片 20 开始，这里讨论了几个带有任务的并行版本。

第三，`ptime`是一个 Solaris 命令，并非特定于 SPARC，因为它在 x86 版本中也可用。许多与进程相关的 Solaris 命令的`p`名称中都有前缀。请注意，在您的情况下`time`，更有可能是 Bash 提供的内置实现，而不是独立的二进制文件。

第四，这可能是您问题的真正答案-您`parallel`的代码中缺少一个区域，因此任务指令根本不起作用:)您应该将代码重写如下：

```
long comp_fib_numbers(int n)
{
   long fnm1, fnm2, fn;
   if ( n == 0 || n == 1 ) return(n);

   // In case the sequence gets too short, execute the serial version
   if ( n < 20 )
   {
      return(comp_fib_numbers(n-1)+comp_fib_numbers(n-2));
   }
   else
   {
      #pragma omp parallel  // <--- You are missing this one parallel region
      {
         #pragma omp single
         {
            #pragma omp task shared(fnm1)
            fnm1 = comp_fib_numbers(n-1);
            #pragma omp task shared(fnm2)
            fnm2 = comp_fib_numbers(n-2);
         }
         #pragma omp taskwait
      }

      fn = fnm1 + fnm2;
      return(fn);
   }

} 
```

`if`您可以通过使用子句切换并行区域使代码更加简洁：

```
long comp_fib_numbers(int n)
{
   long fnm1, fnm2, fn;
   if ( n == 0 || n == 1 ) return(n);

   #pragma omp parallel if(n >= 20)
   {
      #pragma omp single
      {
         #pragma omp task shared(fnm1)
         fnm1 = comp_fib_numbers(n-1);
         #pragma omp task shared(fnm2)
         fnm2 = comp_fib_numbers(n-2);
      }
      #pragma omp taskwait
   }

   fn = fnm1 + fnm2;
   return(fn);
} 
```

如果`n`恰好小于 20，则并行区域将执行单线程。由于并行区域通常在单独的函数中提取，因此仍然会有额外的函数调用，除非编译器选择生成重复代码。这就是为什么建议将串行实现提取到它自己的函数中：

```
long comp_fib_numbers_serial(int n)
{
   if ( n == 0 || n == 1 ) return(n);

   return (comp_fib_numbers_serial(n-1) + comp_fib_numbers_serial(n-2));
}

long comp_fib_numbers(int n)
{
   long fnm1, fnm2, fn;
   if ( n < 20 ) return comp_fib_numbers_serial(n);

   #pragma omp parallel
   {
      #pragma omp single
      {
         #pragma omp task shared(fnm1)
         fnm1 = comp_fib_numbers(n-1);
         #pragma omp task shared(fnm2)
         fnm2 = comp_fib_numbers(n-2);
      }
      #pragma omp taskwait
   }

   fn = fnm1 + fnm2;
   return(fn);
} 
```

*编辑：*现在我已经查看了您链接到的代码，我可以看到调用`comp_fib_numbers`被嵌入到一个`parallel`区域中。`parallel`因此，如果您的代码中已经有一个缺失区域，请忽略我对缺失区域的评论。为了完整起见，我将把它留在这里。尝试调整并行版本和串行版本之间发生切换的值。在现代处理器上，它可能会很高，而且您看到的示例已经很老了。`OMP_DYNAMIC`还要通过将环境变量设置为`false`（或`FALSE`）或调用`omp_set_dynamic(0);`并行区域之前的某个位置来确保不使用动态团队。

您还没有说明您的编译器是什么，但请注意，自 4.4 版起，GCC 支持 OpenMP 3.0，自 11.0 版起由英特尔编译器支持，自 I_dont_know 版起由 Sun/Oracle 编译器支持，并且 Visual C/C++ 编译器根本不支持 OpenMP 3.0 .

在四插槽 Intel Xeon X7350 系统（带 FSB 的旧前 Nehalem 系统）上观察到的加速

```
$ time OMP_NUM_THREADS=1 ./fib.x 40
finonacci(40) = 102334155
OMP_NUM_THREADS=1 ./fib.x 40  1.86s user 0.00s system 99% cpu 1.866 total
$ time OMP_NUM_THREADS=2 ./fib.x 40
finonacci(40) = 102334155
OMP_NUM_THREADS=2 ./fib.x 40  1.96s user 0.00s system 169% cpu 1.161 total 
```

截止设置为`25`（似乎是 X7350 的最佳值）：

```
$ time OMP_NUM_THREADS=2 ./fib.x 40
finonacci(40) = 102334155
OMP_NUM_THREADS=2 ./fib.x 40  1.95s user 0.00s system 169% cpu 1.153 total 
```

将截止设置为`25`和串行实现的单独函数：

```
$ time OMP_NUM_THREADS=2 ./fib.x 40
finonacci(40) = 102334155
OMP_NUM_THREADS=2 ./fib.x 40  1.52s user 0.00s system 171% cpu 0.889 total 
```

看看用户时间如何减少了大约 400 毫秒。这是因为消除了开销。

这些是使用您链接到的站点中的代码测量的。使用的编译器是 64 位 Scientific Linux 6.2 系统上的 GCC 4.4.6。

# process - 在 C# 中安排一个进程以 24*7 运行

> ID：12917770
> 
> 赞同：0
> 
> 时间：2012-10-16T15:07:44.963
> 
> 标签：process, c#-3.0, scheduler

我有一个需要 24*7 运行的关键业务应用程序。现在它使用 Windows 任务计划程序进行计划。当前实现的问题是，每当应用程序停止时，它必须等待 1 分钟才能再次运行。（因为一分钟是在 Windows 任务计划程序中重复任务的最短时间）所以我正在构建自己的任务计划程序，它将启动进程（应用程序）在终止进程后 5 秒内。我的任务计划程序应该如何知道进程是否已终止。我是否需要每秒轮询该进程以检查其是否正在运行？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-16T15:10:43.887

您应该将应用程序编写为[Windows 服务](http://en.wikipedia.org/wiki/Windows_service)，而不是标准应用程序。

除了其他优点之外，Windows 服务让您能够定义发生故障时会发生什么（例如重新启动应用程序）。

它们也[很容易](http://msdn.microsoft.com/en-us/library/zt39148a.aspx)在 C# 中创建。

# knockout.js - 使用 knockoutjs + 映射插件更新数据（+解决方案）

> ID：12917771
> 
> 赞同：1
> 
> 时间：2012-10-16T15:07:44.673
> 
> 标签：knockout.js, knockout-mapping-plugin

我正在尝试使用映射插件在 knockoutjs 视图模型中插入和更新数据。
初始数据如下所示（数字映射在“id”字段中，文本映射在“name”字段中）：

*   1 个
    *   2 二
        *   3 三
        *   4 四
    *   5 五
        *   6 六
        *   7 七
*   8 八
    *   9 九
        *   10 十
        *   11 十一
    *   12 十二
        *   13 十三
        *   14 十四
*   15 十五

我得到的是

*   1个MOD
    *   2 二
        *   3 三
        *   4 四
*   16 十六

我想得到的是：

*   1个MOD
    *   2 二
        *   3 三
        *   4 四
*   8 八
    *   9 九
        *   10 十
        *   11 十一
    *   12 十二
        *   13 十三
        *   14 十四
*   15 十五
*   16 十六

换句话说：

*   将字段“name”中的元素 1 从“one”更新为“oneMOD”（因为字段 id 被映射为键）
*   5 及其子删除（或未触及）
*   8和15不变
*   增加了 16 个。

看起来 ko.mapping.fromJS 替换了新数据而不是更新它们。
我肯定错过了一些东西。

你可以在这里找到代码：http: [//jsbin.com/uwihoz/2/edit](http://jsbin.com/uwihoz/2/edit)

蒂亚
·詹尼

**编辑**：

好的，我误解了使用 ko.mapping.fromJS 进行“更新”的目的。
如果要更新模型，则必须发送包含更新的完整原始数据集。
如果你想要部分更新，你必须实现它。
我要测试[KnockoutJS-Mapping-updateData](http://github.com/janhartigan/KnockoutJS-Mapping-updateData)。

这篇[文章](https://stackoverflow.com/questions/5086003/knockoutjs-using-updatefromjs-replacing-values-when-it-should-be-adding)（knockoutjs-using-updatefromjs-replacing-values-when-it-should-be-adding）证实了我的怀疑。

我希望这会有所帮助。

再见，
詹尼

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T10:51:34.850

在您最初的问题中， ko.mapping 通过创建一个新的视图模型来工作。因此，当您第二次进行映射时，您将替换以前的视图模型。更新基本上做同样的事情。

您要求映射做的是了解您的数据并自动更新现有记录并添加新记录。它不是那么聪明。您将不得不编写代码来读取更新结果并在原始视图模型中更新/添加正确的记录。

# java - Ivy, Maven - 映射传递依赖

> ID：12917778
> 
> 赞同：1
> 
> 时间：2012-10-16T15:08:00.533
> 
> 标签：java, maven, ivy

假设我们有一堆人工制品，所有这些人工制品都有一个子/传递依赖于

```
artefact{group=zambia, id=zebra} 
```

由于我无法理解的原因，一些聪明的家伙将以前称为 artefact{group=zambia, id=zebra} 的内容更新为

```
artefact{group=africa, id=hello-zebra} 
```

留下一大堆人工制品失去了对 {zambia:zebra} 的子引用

还可以说，由于我无法解释的原因，我无法将那些父人工制品 pom 或 ivy.xml 更新为依赖于 {africa:hello-zebra}。

**问题**：

我的 pom 和/或 ivy.xml 中有没有办法将 {zambia:zebra} 上的任何传递依赖重定向到 {africa:hello-zebra}？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T16:43:18.480

我不了解 Ivy，但对于 Maven，请查看这篇文章：

[http://maven.apache.org/guides/mini/guide-relocation.html](http://maven.apache.org/guides/mini/guide-relocation.html)

看起来将*pom.xml*上传到您的存储库以获取带有`relocation`元素的旧工件可能会奏效：

```
<project>
  <modelVersion>4.0.0</modelVersion>
  <groupId>zambia</groupId>
  <artifactId>zebra</artifactId>
  <version>????</version>
  <distributionManagement>
    <relocation>
      <groupId>africa</groupId>
    </relocation>
  </distributionManagement>
</project> 
```

# php - PHP中的SQL查询错误

> ID：12917779
> 
> 赞同：1
> 
> 时间：2012-10-16T15:08:02.250
> 
> 标签：php, sql, xampp

这是自助餐厅的代码，这是登录名。

```
<?php

$userna = 'root';
$paso = '';
$mach = 'localhost';
$db ='cafeteria';

session_start();

// GET PAGES RECORD FROM LOG TABLE: *********| Only the first time though:
if (isset($_SESSION['log']) != 'logging')
{
    //  Here, just creating a string:
    $pages_record = "";
    $insert_query = '';
    //      Get saved pages from the database:
    $connection = mysqli_connect($mach,$userna,$paso,$db) or die ("Error in log-page script: AB-1 - query: $insert_query." . mysqli_error($connection));
    mysqli_select_db($connection,'cafeteria');

    //      Query string to pull all pages from table record:
    $get_pages_query = "select * from log-page";

    //      Query the database, and save result:
    $query_pages_result = mysqli_query($connection, $get_pages_query);

    //      Check number of results returned:
    $num_of_results = '';
    $num_of_results = mysql_num_rows($query_pages_result);
    if ($num_of_results > 0)
    {
        // Loop through the result array: Each time, one row, and then the next one ...
        for ($row = 0; $row < $num_of_results; $row++ )
        {
            // Getting one row:
            $get_row = mysqli_fetch_array($query_pages_result);
            // Extracting just the page name from the row:
            $one_page = substr($get_row["page"],strripos($get_row["page"],"/") + 1);
            // Adding this page name to the string created previously:
            if ($row == 0)
            {
                $pages_record .= $one_page;
            }
            else 
            {
                $pages_record .= ",".$one_page;
            }           
        }

        // Once all pages have been read and saved to the string
        // now we save it to the session:
        $_SESSION['logpages'] = $pages_record;
        $_SESSION['log'] = 'logging'; // This just tells us, we are logging pages to the database.
    }
    else 
    {
        // There are no pages in the table:
        $_SESSION['logpages'] = "";
        $_SESSION['log'] = 'logging'; // This just tells us, we are logging pages to the database.
    }
}

// Check if page is already in session list.
$pages_array = array();
if (strlen(isset($_SESSION['logpages'])) > 0 )
{
    // string variable that holds all pages separated by commas:
    $pages_string =  $_SESSION['logpages'];

    // creating an Array to hold all pages already logged in server:
    if (strstr($pages_string, ","))
    {
        $pages_array = explode(",", $pages_string);
    }
    else // just means there's only one page in the record
    {
        // so, we push it inside the array.
        array_push($pages_array, $pages_string);
    }

    // current page: [ We are extracting only the page, not the entire url, Exmp: login.php ]
    $current_page = substr($_SERVER['PHP_SELF'],strripos($_SERVER['PHP_SELF'],"/") + 1);

    // Check if current_page is in the array already:
    if (!in_array($current_page, $pages_array))
    {
        // IF is NOT in the array, then add it:
        array_push($pages_array, $current_page);

        // Add it to the Session variable too:
        $pages_string = implode(",", $pages_array);

        // Re-save it to SESSION:
        $_SESSION['logpages'] = $pages_string;

        // Now, add it to the database table "log-page""
        $connection = mysqli_connect($mach,$userna,$paso,$db) or die ("Unable to connect!");
        mysqli_select_db($connection,'cafeteria');

        // Query to insert page description into the table:
        // [ date - time - page - user ]
        $insert_query = "INSERT INTO log-page 
            (`date`, `time`, `page`, `user`) VALUES 
            ('".date("Y-m-d")."', '".date("H:i:s")."', '".$_SERVER['PHP_SELF']."', '".(isset($_SESSION['SESSION_UNAME']))."')"; 
            mysqli_select_db($connection,'cafeteria');

        // INSERTING INTO DATABASE TABLE:
        mysqli_query($connection, $insert_query) or die ("Error in log-page script: AB-2 - query: $insert_query." . mysqli_error($connection));
        // Done!
    }
    else 
    {
        // IF it IS in the list, just SKIP.
    }
}
else 
{
    // means, that there are absolutely no pages saved in the database, basically this is the first log:
    $_SESSION['logpages'] = substr($_SERVER['PHP_SELF'],strripos($_SERVER['PHP_SELF'],"/") + 1);    

    // Now, add it to the database table "log-page""
    $connection = mysqli_connect($mach,$userna,$paso,$db) or die ("Unable to connect!");
    mysqli_select_db($connection,'cafeteria');

    // Query to insert page description into the table:
    // [ date - time - page - user ]
    $insert_query = "INSERT INTO log-page 
        (date, time, page, user) VALUES 
        ('".date("Y-m-d")."', '".date("H:i:s")."', '".$_SERVER['PHP_SELF']."', '".(isset($_SESSION['SESSION_UNAME']))."')"; 
    mysqli_select_db($connection,'cafeteria');
    // INSERTING INTO DATABASE TABLE:
    mysqli_query($connection,$insert_query) or die ("Error in log-page script: AB-2 - query: $insert_query." . mysqli_error($connection));
    // Done!    
}

?> 
```

但现在我收到了这个错误：

> 日志页面脚本错误：AB-2 - 查询：INSERT INTO 日志页面 ( `date`, `time`, `page`, `user`) VALUES ('2012-10-16', '16:58:44', '/caf/pages/index.php ', '')。您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在 '-page ( `date`, `time`, `page`, `user`) VALUES ('2012-10-16', '16:58:44' at line 1'附近使用正确的语法

我使用 Xampp 1.8.1 PHP：5.4.7。它不允许我以管理员身份或收银员身份登录

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-16T15:11:12.417

像这样用反引号将表名括起来（省略查询的其余部分）：

```
$insert_query = "INSERT INTO `log-page` (`date`, `time`, `page`, `user`) ... "; 
```

否则 MySQL 将尝试将 解释`-`为减号，在这种情况下失败。

**编辑**

在显示的最后一个插入中，列名也应包含在反引号中：

```
$insert_query = "INSERT INTO `log-page` (`date`, `time`, `page`, `user`) VALUES ..."; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T15:10:58.653

尝试转义字段名称

```
(`date`, `time`, `page`, `user`) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-16T15:11:44.213

自从我查看 mySql 文档以来已经有一段时间了，但它似乎在抱怨表名“log-page”。尝试引用该表名。

# c++ - 数学和 C++：如何编写一个每 16 次添加一个数字的函数？

> ID：12917781
> 
> 赞同：-5
> 
> 时间：2012-10-16T15:08:04.080
> 
> 标签：c++, math

我遇到了一个问题，如果我能主宰数学，就可以轻松解决。所以如果有人能指出我正确的方向，我会很高兴地感谢这个贡献。

在食谱中，我想每 16 杯添加一个 X 数，例如柠檬的数量。所以当我有 5 杯时，我只会用 1 个柠檬。当我有 17 杯时，我会用 2 个柠檬。当我有 32 杯时，我会添加第三个柠檬，就像每 16 的倍数一样。

解决这个问题的最简单方法是什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-16T15:09:34.807

你不需要为此支配数学：

```
int lemons = cups / 16 + 1; //the +1 there because apparently you want to start
                            //with one cup 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T15:12:13.467

柠檬和杯子之间有直接的关系，所以你可以说：

```
lemons = ( cups / 16 ) + 1; 
```

或者如果你愿意，你也可以说：

```
lemons = ( cups >> 4 ) + 1; 
```

这可能会稍微快一些，并且仅适用于（a）16 显然是 2 的幂和（b）如果柠檬和杯子是整数。听起来，您不太可能需要这种优化，而前者就足够了，而且可能更清晰。

# cakephp - CakePHP 2.x 自定义路由分页

> ID：12917784
> 
> 赞同：1
> 
> 时间：2012-10-16T15:08:37.947
> 
> 标签：cakephp, routing, pagination, routes

我有以下自定义路线（效果很好）：

```
Router::connect('/:city', array('controller' => 'dealers', 'action' => 'index'), array('city' => '[a-z]+')); 
```

通过这条路线，我试图获得第 2、3、... 页的分页：

```
Router::connect('/:city/:id', array('controller' => 'dealers', 'action' => 'index'),
    array(
        'pass' => array('city', 'id'),
        'city' => '[a-z]+',
        'id' => '[0-9]+'
        )
); 
```

现在的**第一个问题**是，如果我输入*domain.com/washington/2*它不会将 id 传递给 Pagination，我仍然会得到第 1 页。

第二**个问题**是我没有得到 Pagination Helper 来写上面的链接。如果我在我看来尝试这个：

```
$this->Paginator->options(array
    ('url'=> array(
        $city[0]['City']['url'],
        $this->params['id']
        )
    )
); 
```

它仍然给我：

*http://domain.com/dealers/index/washington/page:2*

如果这是没有道理的，我提前道歉，但我对此并不陌生，无法通过此处的可用问题/答案或文档来弄清楚。

**更新 1：**

*我现在为domain.com/washington/page/2*尝试了以下操作，但它只是路由到分页第 1 页：

```
Router::connect('/:city/:slug/:id', 
    array('controller' => 'dealers', 'action' => 'index'),
    array(
        'pass' => array('city', 'slug', 'id'),
        'city' => '[a-z]+',
        'slug' => '[a-z]+',
        'id' => '[0-9]+'
        )
); 
```

在我这样做的行动中：

```
public function index($slug = null, $id = null) {some code} 
```

在我添加的视图中：

```
$this->Paginator->options(array('url' => $this->passedArgs)); 
```

仍然没有运气，如果有人可以提供帮助，我会非常高兴！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-17T09:31:40.197

我终于通过将它添加到 AppController (beforeFilter)使 url *domain.com/washington/page/2工作：*

```
if (isset($this->request->params['page'])) {
 $this->request->params['named']['page'] = $this->request->params['page'];
} 
```

并通过添加这条路线：

```
Router::connect('/:city/page/:page', 
    array('controller' => 'dealers', 'action' => 'index'),
    array(
        'pass' => array('city', 'page'),
        'city' => '[a-z]+',
        'page' => '[0-9]+'
        )
); 
```

但是，我真的不明白这里发生了什么，以及这是否是一种好方法。如果有人可以简要解释一下，我很想知道。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T15:37:32.543

请参阅我上面的评论:)

此外，您可能想要使用它：

```
$this->Paginator->options(array('url' => $this->passedArgs)); 
```

这实际上会将参数从 URL 传递给分页器助手。

# sml - 如何在整数列表中找到最小值？

> ID：12917788
> 
> 赞同：0
> 
> 时间：2012-10-16T15:09:12.520
> 
> 标签：sml

```
fun min [] = [] | min (h::t) = if h < (min t) then h else (min t) 
```

为什么上面给出了错误？请帮忙！谢谢！

错误信息：

```
stdIn:1.37 Error: overloaded variable not defined at type
    symbol: <
    type: 'Z list 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T16:11:26.470

在空列表的情况下，您返回一个空列表，其类型与元素的类型不兼容，例如`h`or `min t`。

一些更正：

1.  空列表是您没有最小值的例外情况。你应该提出一个例外，例如`Empty`。
2.  您忘记了仅包含一个元素的列表的基本情况。

所以函数的骨架是：

```
fun min [] = raise Empty
  | min [x] = ...
  | min (x::xs) = ... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-15T14:37:09.830

在这种情况下，最好利用选项类型。您将避免必须处理异常，但无论您从何处调用此函数，都将被迫正确处理 NONE 情况。

```
fun smallest [] = NONE
  | smallest (x::xs) = case smallest xs of
                       NONE => SOME x
                     | SOME y => if x < y
                                 then SOME x
                                 else SOME y 
```

# c# - 创建目录结构的 XML DOM

> ID：12917789
> 
> 赞同：0
> 
> 时间：2012-10-16T15:09:15.037
> 
> 标签：c#, xml, xmldocument, directoryentry, xmldom

如果有一个基于目录返回树节点的方法

```
 private static TreeNode GetDirectoryNodes(string path)
        {
            var dir = new DirectoryInfo(path);
            var node = new TreeNode(dir.Name);
            foreach (var directory in dir.GetDirectories())
            {
                node.Nodes.Add(GetDirectoryNodes(path + "\\" + directory.ToString()));
            }
            return node;
        } 
```

但是我需要创建一个目录结构的 XML DOM，但是我是 XML DOM 的新手，不知道如何做到这一点。我看到的问题是：如何将 \ 放入 XML；以及如何获取子目录这是我到目前为止所拥有的

```
private static XmlDocument GetDirTreeData(string path)
        {
            var dir = new DirectoryInfo(path);
            XmlDocument XMLDOM = new XmlDocument();
            XmlElement xl = XMLDOM.CreateElement(path);
            foreach (var directory in dir.GetDirectories())
            {
                xl.InnerXml = directory.ToString();
            }
            return XMLDOM;
        } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-16T15:19:36.357

看看 LINQ to XML。使用 LINQ 更容易完成您的任务。这是一个有效的代码，但不能处理拒绝访问和类似问题

```
static void Main(string[] args)
    {
        XDocument xdoc = new XDocument(
            new XElement("Root",
                DirToXml(new DirectoryInfo("C:\\MyFolder"))));
    }

    private static XElement DirToXml(DirectoryInfo dir)
    {
        return new XElement("Directory",
                    new XAttribute("Name", dir.Name),
                    dir.GetDirectories().Select(d => DirToXml(d)));
    } 
```

xdoc 变量是您的 xml 文档。DirToXml 是查找所有子目录并为每个子目录创建元素的递归方法。

结果如下所示：

```
<Root>
  <Directory Name=".history">
    <Directory Name="0" /> 
    <Directory Name="1" /> 
    <Directory Name="10" /> 
    <Directory Name="11" /> 
    <Directory Name="12" /> 
    <Directory Name="13" /> 
    <Directory Name="14" /> 
    <Directory Name="15" /> 
    <Directory Name="16" /> 
  </Directory>
</Root> 
```

# android - 选择通知音

> ID：12917790
> 
> 赞同：1
> 
> 时间：2012-10-16T15:09:15.713
> 
> 标签：android, notifications, ringtone, android-audiomanager

我怎么用这个

```
Ringtone tone = RingtoneManager.getRingtone(this, Uri.parse(uri)); 
```

从通知声音中选择？这很好用，但我可以从手机铃声设置通知声音。

更新：

```
private void update_notifytone (String uri, boolean save) {
        mNotifyTone = uri;
        if (uri == null) return;

        Ringtone tone = RingtoneManager.getRingtone(this, Uri.parse(uri));

        if (tone != null) 
            mPrefNotifyTone.setSummary(tone.getTitle(this));
        if (save) 
            update_column(ProfileModel.ProfileColumns.NOTIFYTONE, mNotifyTone);
    } 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T15:23:30.980

利用

```
 RingtoneManager mRing= new RingtoneManager(RingtoneActivity.this); 
 int mNumberOfRingtones = mRing.getCursor().getCount();

 Uri mRingToneUri = mRing.getRingtoneUri((int) (Math.random() * mNumberOfRingtones)); 
```

RingtoneManager 提供的光标，用于访问设备上可用的铃声，在示例中选择随机铃声。

# python - 如何使用 BeautifulSoup 在一张表中找到所有行

> ID：12917792
> 
> 赞同：1
> 
> 时间：2012-10-16T15:09:25.383
> 
> 标签：python, web-scraping, beautifulsoup

我想我正在尝试用 BeautifulSoup (BS4) 编写我的第一个解析器并遇到一个概念问题。我在 Python 方面做得不多——我在 PHP 方面做得更好。

我可以让 BeautifulSoup 找到我想要的表格，但是当我尝试进入表格并找到所有行时，我得到了一些变化：

```
AttributeError: 'ResultSet' object has no attribute 'attr' 
```

我尝试浏览示例代码[如何使用 urllib2 从 Python 中打开的 url 中提取特定数据？](https://stackoverflow.com/questions/989872/how-do-i-draw-out-specific-data-from-an-opened-url-in-python-using-urllib2/989920#989920)并得到或多或少相同的错误（注意：如果你想尝试它，你需要一个[有效的 URL](http://services.runescape.com/m=hiscore/compare.ws?user1=Jake)。）

我正在阅读的一些内容表明问题在于 ResultSet 是一个列表。我怎么会知道？如果我这样做`print type(table)`只是告诉我`<class 'bs4.element.ResultSet'>`

我可以在表格中找到文本：

```
for row in table:
    text = ''.join(row.findAll(text=True))
    print text 
```

但如果我尝试使用以下命令搜索 HTML：

```
for row in table:
    text = ''.join(row.find_all('tr'))
    print text 
```

它抱怨`expected string, Tag found`那么我如何将这个字符串（这是一个充满 HTML 的字符串）重新整理成一个我可以解析的 beautifulsoup 对象？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-16T18:36:27.787

BeautifulSoup 数据类型至少可以说很奇怪。很多时候，他们没有提供足够的信息来轻松拼凑拼图。我知道你的痛苦！无论如何...关于我的答案...

如果不查看更多代码或不知道您尝试抓取的实际站点，很难提供一个完全准确的示例，但我会尽力而为。

问题是你的`''.join()`. `.findAll('tr')`返回 BeautifulSoup 数据类型“标签”的元素列表。它是 BS 如何知道找到`tr`s 的。因此，您将错误的数据类型传递给您的`''.join()`.

您应该再编写一个迭代代码。（我假设有带有s 的`td`标签`tr`）

```
text_list = []
for row in table:
    table_row = row('tr')
    for table_data in table_row:
        td = table_data('td')
        for td_contents in td:
            content = td_contents.contents[0]
            text_list.append(content)
text = ' '.join(str(x) for x in text_list) 
```

这会将整个表格内容返回到单个字符串中。`text`您可以通过简单地更改 和 的位置`text_list`来优化 的值`text =`。

这可能看起来比所需的代码更多，这可能是真的，但我发现当我以这种方式进行时，我的刮擦会更加彻底和准确。

# asp.net-web-api - 如何在 ASP.NET Web API 中设置默认序列化程序？

> ID：12917795
> 
> 赞同：14
> 
> 时间：2012-10-16T15:09:28.600
> 
> 标签：asp.net-web-api

我目前正在观看有关 ASP.NET Web API 的视频课程。当一个控制器被调用时，数据**默认**以 JSON 格式返回。我只是想知道，因为当我从视频中复制这个示例项目时，我得到了 XML。

挫折很大，请帮我解决这个问题。

我对 ASP.NET Web API 很陌生，所以请多多包涵。

**更新**

控制器不包含特殊代码。这是简单的代码，它是从**API 控制器生成的，带有空的读/写操作**模板。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-16T15:24:52.123

ASP.NET WebAPI 带有内置的[内容协商](http://blogs.msdn.com/b/kiranchalla/archive/2012/02/25/content-negotiation-in-asp-net-mvc4-web-api-beta-part-1.aspx)，因此返回值的格式由请求本身决定 - 更具体地说是由`Accept`/`Content-Type`标头（取决于存在的标头，`Accept`标头似乎比`Content-type`.

我假设您正在浏览器中查看结果，默认情况下它可能要求`application/xml`. 您将需要在浏览器上使用一些设置/开发工具并强制它发送`Content-Type: application/json`以获得正确的响应（假设您返回[HttpResponseMessage](http://msdn.microsoft.com/en-us/library/system.net.http.httpresponsemessage.aspx)）。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-10-16T15:19:30.780

在 Global.asax 中：添加以下行：

```
GlobalConfiguration.Configuration.Formatters.XmlFormatter.SupportedMediaTypes.Clear(); 
```

它看起来像这样。

```
protected void Application_Start()
{
    AreaRegistration.RegisterAllAreas();

    RegisterGlobalFilters(GlobalFilters.Filters);
    RegisterRoutes(RouteTable.Routes);

    BundleTable.Bundles.RegisterTemplateBundles();
    GlobalConfiguration.Configuration.Formatters.XmlFormatter.SupportedMediaTypes.Clear();
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-11-27T23:26:19.597

James 很接近，但内容协商实际上使用的是 [Accept] 标头，而不是 [Content-Type]

与 MVC 中的几乎所有其他内容一样，您可以覆盖内容协商组件以确保返回所需的内容

W3c 明确指出——

14.1 接受

Accept request-header 字段可用于指定响应可接受的某些媒体类型。

-和-

14.17 内容类型

Content-Type entity-header 字段指示发送给接收者的实体主体的媒体类型，或者在 HEAD 方法的情况下，如果请求是 GET，则将发送的媒体类型。

此[页眉](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html)对于理解请求/响应协商非常有用。

# delphi - 在 Delphi 中实现 SQL“Where”构造的最佳方法？

> ID：12917799
> 
> 赞同：0
> 
> 时间：2012-10-16T15:09:37.320
> 
> 标签：delphi, delphi-xe2, firebird, firebird2.5

我有带有字段的 Firebird DB 表（FK - ForeignKey 字段）：

```
ID integer,
FACILITY_ID integer, --FK
SERVICE_ID integer, --FK
PROVIDER_ID integer, --FK
SELLER_ID integer, --FK
TARIFF_GROUP_ID integer, --FK
DATE_START date,
N_NORMATIVE_VALUE numeric(15,2),
N_METER_VALUE numeric(15,2),
T_NORMATIVE_VALUE numeric(15,2),
T_METER_VALUE numeric(15,2),
IS_ACTIVE smallint 
```

我想将此表加载到内存中并在我的 Delphi 程序中使用它（只读）。而且我必须按所有 FK 搜索记录（....其中 FACILITY_ID = :FACILITY_ID 和 SERVICE_ID = :SERVICE_ID 等..）

什么是该任务的最佳容器：动态数组或列表或其他东西？以及如何实现这个搜索？哈希可能吗？

它不是很大的表（1000 条记录），但将在 FOR 构造中使用超过 100000 次迭代。

我正在使用带有 IBX & UIB & FB25 的 Delphi XE2

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-16T15:25:36.307

您是否建议将整个表加载到内存中，然后直接在 Delphi 中复制数据库已经提供的过滤功能？这似乎是不必要的努力——为什么不对数据库运行 SELECT 语句来获取您需要的记录呢？

无论如何，保存从数据库中检索到的数据的最佳结构是某个 TDataSet 后代类。实际上，有几组组件可以为 Firebird 执行此操作，这取决于您可以使用的 Delphi 的 SKU。以下是可用的 Firebird 组件列表：[http](http://www.firebirdfaq.org/faq8/) ://www.firebirdfaq.org/faq8/ 。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-16T18:31:08.373

我推荐我过去成功使用过的 TxQuery 组件。它是一个开源的内存 SQL 引擎。

[GoogleCode 上的 TxQuery](http://code.google.com/p/txquery/)

# javascript - 带有 xlt 格式错误的 Javascript

> ID：12917802
> 
> 赞同：2
> 
> 时间：2012-10-16T15:09:50.367
> 
> 标签：javascript, xslt, formatting, padding, transformation

我正在使用 javascript 在我的 xslt 文件中填充数字。但是在调试时我收到一条错误消息。

> 不支持具有 Clr 类型“ConcatString”的扩展函数参数或返回值。

我怎样才能解决这个问题？

xslt

```
<xsl:template name="padNumber">
    <xsl:param name="value"></xsl:param>
    <xsl:param name="length"></xsl:param>
    <xsl:value-of select="user:PadDigits($value,$length)"/>
  </xsl:template> 
```

javascript

```
function PadDigits(n, totalDigits)
{
    n = n.toString();
    var pd = '';
    if (totalDigits &gt; n.length)
    {
        var i;
        for (i=0; i&lt;(totalDigits-n.length); i++)
        {
            pd += '0';
        }
    }
    pd = pd + n.toString();
    return pd;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-16T15:23:45.320

更改您的 PadDigits 以返回字符串：

```
return "" + pd; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-16T15:26:33.120

您根本不需要扩展功能。

**使用这个纯 XSLT 实现**：

```
 <xsl:template name="padNumber">
    <xsl:param name="pValue"/>
    <xsl:param name="pLength"/>

    <xsl:value-of select=
    "concat(substring(substring($vZeroes,1,$pLength),
                      string-length($pValue) +1),
            $pValue)
    "/>
  </xsl:template> 
```

**这是一个完整的例子**：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output method="text"/>

 <xsl:variable name="vZeroes" select=
  "'000000000000000000000000000000000000000'"/>

 <xsl:template match="/">
  <xsl:call-template name="padNumber">
    <xsl:with-param name="pValue" select="12345"/>
    <xsl:with-param name="pLength" select="8"/>
  </xsl:call-template>
 </xsl:template>

 <xsl:template name="padNumber">
    <xsl:param name="pValue"/>
    <xsl:param name="pLength"/>

    <xsl:value-of select=
    "concat(substring(substring($vZeroes,1,$pLength),
                      string-length($pValue) +1),
            $pValue)
    "/>
  </xsl:template>
</xsl:stylesheet> 
```

**当将此转换应用于任何 XML 文档（本演示中未使用）时，将产生所需的正确结果**：

```
00012345 
```

**您可以进一步参数化要使用的所需填充字符：**

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output method="text"/>

 <xsl:variable name="vZeroes" select=
  "'000000000000000000000000000000000000000'"/>

 <xsl:template match="/">
  <xsl:call-template name="padNumber">
    <xsl:with-param name="pValue" select="12345"/>
    <xsl:with-param name="pLength" select="8"/>
    <xsl:with-param name="pPadChar" select="'*'"/>
  </xsl:call-template>
 </xsl:template>

 <xsl:template name="padNumber">
    <xsl:param name="pValue"/>
    <xsl:param name="pLength"/>
    <xsl:param name="pPadChar" select="'0'"/>

    <xsl:variable name="vZeroes" select="translate($vZeroes, '0', $pPadChar)"/>

    <xsl:value-of select=
    "concat(substring(substring($vZeroes,1,$pLength),
                      string-length($pValue) +1),
            $pValue)
    "/>
  </xsl:template>
</xsl:stylesheet> 
```

**执行此转换时，现在的结果是：**

```
***12345 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-16T15:27:00.147

@RoManiac 谢谢帮助。我发现我更喜欢这个模板，以防万一有人来看看。

```
<xsl:template name="format-batchnum">
    <xsl:param name="batchnum"/>
    <xsl:param name="numbatchdigit" select="12"/>

    <xsl:choose>
      <xsl:when test="string-length($batchnum)>=$numbatchdigit">
        <xsl:value-of select="$batchnum"/>
      </xsl:when>
      <xsl:otherwise>
        <xsl:text>0</xsl:text>
        <xsl:call-template name="format-batchnum">
          <xsl:with-param name="batchnum" select="$batchnum"/>
          <xsl:with-param name="numbatchdigit" select="$numbatchdigit -1"/>
        </xsl:call-template>
      </xsl:otherwise>
    </xsl:choose>
  </xsl:template> 
```

# objective-c - Youtube 视频不会加载到 webView

> ID：12917804
> 
> 赞同：0
> 
> 时间：2012-10-16T15:09:54.680
> 
> 标签：objective-c, ios, uiwebview, youtube

我正在尝试将我的视频加载到 webview 中。当我使用此链接时。它行不通。

[http://www.youtube.com/v/066PWBKrh6k&autoplay=1](http://www.youtube.com/v/066PWBKrh6k&autoplay=1)

但是当我尝试这个链接时。这是同一个视频，但链接有点不同。它行不通。知道问题可能是什么吗？

[http://www.youtube.com/watch?v=066PWBKrh6k&autoplay=1](http://www.youtube.com/watch?v=066PWBKrh6k&autoplay=1)

亲切的问候。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T15:16:16.150

您正在链接到 Flash 文件。IOS不会播放flash。/v/id 路径链接到 swf 以进行澄清，而 watch 链接是 IOS 可能有一个处理程序来接受标准 youtube 链接但在 youtube 应用程序中播放它们。你真正想要的是一个 mp4 文件/h264 的直接 url，ios 会很高兴地在它的媒体控件中播放。Youtube 不会给你这个，因为视频没有品牌，品牌是他们的 flash / html5 播放器的覆盖。你最好的选择是使用实际的 youtube javascript api 来嵌入一个 html5 播放器，或者至少是与 IOS 兼容的东西。或者只是链接到 IOS 已注册处理程序的地址。

# iphone - 表单提交并不总是传递按钮值

> ID：12917805
> 
> 赞同：2
> 
> 时间：2012-10-16T15:09:54.720
> 
> 标签：iphone, asp.net-mvc

我正在研究**ASP.NET MVC4 Mobile Application**。

问题是在基于移动的网络浏览器和基于 Windows 或 Mac 的网络浏览器上测试应用程序时，后台代码的行为不同。以下是详细信息：

我有 4 个按钮：

```
<input type="submit" name="actionButton" value="START" id="a1" />
<input type="submit" name="actionButton" value="BACK" id="a2" />
<input type="submit" name="actionButton" value="NEXT" id="a3" />
<input type="submit" name="actionButton" value="FINISH" id="a4" /> 
```

在我的控制器中，我有这个：

```
[HttpPost]
public ActionResult Index(SurveyModel model, string actionButton) 
```

当我在基于**windows**或**mac**的**浏览器**上测试它时，它工作正常。提交 FORM 时，START、BACK、NEXT、FINISH 值将传递给 actionButton 参数，我可以毫无问题地处理它们。

当我在**iPhone**上对此进行测试并通过单击上面的按钮之一提交表单时，有时 actionButton 参数为空。有人有同样的经历吗？

# outlook - Microsoft.Office.Interop.Outlook.MailItem.To 为空

> ID：12917806
> 
> 赞同：0
> 
> 时间：2012-10-16T15:09:56.867
> 
> 标签：outlook, outlook-addin

我在 Outlook 插件应用程序中遇到了一个奇怪的问题。它在 Outlook 2010 上运行。我在电子邮件的“收件人...”框中输入了一个电子邮件地址，例如：abc@foo.com。我有以下代码来获取收件人：

```
var dynamicMailItem = (dynamic) mailItem;
var recipients = (string)dynamicMailItem.To; 
```

但是，收件人返回一个空字符串！但是当我在即时窗口中评估 dynamicMailItem.To 时，突然间，该值被返回。我怎样才能强制一致的行为？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T15:46:28.113

你不正确地强制转换`dynamicMailItem.To`，这就是为什么变量`recipients`事后什么都不包含的原因。

您发布的代码无效 - 有一个额外的右括号。它不能是来自加载项的精确复制粘贴，否则您会看到编译错误。你能准确地发布你拥有的分配价值的代码`var recipients`吗？

# request - 使用 googleapis 到 freebase 的简单请求

> ID：12917807
> 
> 赞同：1
> 
> 时间：2012-10-16T15:10:02.387
> 
> 标签：request, freebase

我想查询freebase，以获取有关名人的一些基本信息。例如，我想知道麦当娜的出生地和性别。

我通过以下方式获得了麦当娜的朋友：

[https://www.googleapis.com/freebase/v1/mqlread](https://www.googleapis.com/freebase/v1/mqlread) ?&query={"id":"/en/madonna","name":null,"type":"/base/popstra/celebrity"," /base/popstra/celebrity/friendship":[{"participant":[]}]}

但是，我对这个请求的理解非常糟糕。我怎样才能改变它以获得我上面谈到的信息？

我在想：

[https://www.googleapis.com/freebase/v1/mqlread](https://www.googleapis.com/freebase/v1/mqlread) ?&query={"id":"/en/madonna","name":null,"type":"/base/popstra/celebrity"," /base/popstra/celebrity/gender":[{"gender":}], "/base/popstra/celebrity/place_of_birth":[{"出生地":}]}

但它不起作用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-16T16:16:37.857

以下是为 Freebase 主题构建 MQL 查询的方法：

1.  查找符合您查询的示例主题（例如，[麦当娜](http://www.freebase.com/view/en/madonna)）
2.  转到[查询编辑器](http://dev.freebase.com/query)并为该主题的 ID 构建一个简单的查询：

    [{ "id": "/en/madonna", "name": null }]​</p>

3.  转到示例主题页面，单击“编辑此主题”并找到您要查询的事实（例如出生日期）

4.  您可以看到出生日期是人员 (/people/person) 类型的一部分。
5.  单击 Person 右侧的小扳手图标以转到该类型的[架构页面](http://www.freebase.com/schema/people/person)。
6.  从那里，您可以看到存储出生日期的属性称为 /people/person/date_of_birth。
7.  将您想要的属性添加到查询中，如下所示：

    [{ "id" "/en/madonna", "name": null, "/people/person/date_of_birth": null, "/people/person/gender": null }]​</p>

8.  查询还可以指定一个默认类型（例如 /people/person），这使得属性路径更短：

    [{ "id" "/en/madonna", "name": null, "type": "/people/person", "date_of_birth": null, "gender": null }]​</p>

9.  但是每个级别的查询只能有一个默认类型，所以如果你想混合其他类型的属性，你需要使用完整的属性 ID：

    [{“id”：“/en/madonna”，“name”：null，“type”：“/people/person”，“date_of_birth”：null，“gender”：null，“/base/popstra/celebrity/友谊”：[{“参与者”：[]}]}]​</p>

10.  当您的查询在查询编辑器中工作时，只需单击右上角的“链接”菜单即可获取 MQLRead 链接，该链接将对该 API 进行查询。

# cakephp - 二级扩展？

> ID：12917808
> 
> 赞同：1
> 
> 时间：2012-10-16T15:10:09.190
> 
> 标签：cakephp, cakephp-2.0

首先，对不起，如果这听起来太简单了。顺便说一句，我是 cakePHP 的新手。

我的目标是扩展通过它链接的`team_id`in控制器`season``standings`表

我目前的示范规则是：

1.  每个赛季都有很多排名
2.  每个排名代表一个团队。
3.  基本上是赛季和球队=排名之间的多对多关系。

这是我的季节控制器：

```
class SeasonsController extends AppController
{
    public $helpers = array('Html', 'Form');

    public function view($id)
    {
        $this->Season->id = $id;
        $this->set('season', $this->Season->read());
    }
} 
```

当我浏览单个季节 thru`/cakephp/seasons/view/1`时，`$season`数组显示：

```
Array
(
    [Season] => Array
        (
            [id] => 1
            [name] => English Premier League 2013/2014
            [start] => 1350379014
            [end] => 0
        )

    [Standing] => Array
        (
            [0] => Array
                (
                    [id] => 1
                    [team_id] => 1
                    [win] => 1
                    [lose] => 0
                    [draw] => 1
                    [GF] => 5
                    [GA] => 4
                    [season_id] => 1
                    [rank] => 1
                )

            [1] => Array
                (
                    [id] => 2
                    [team_id] => 2
                    [win] => 0
                    [lose] => 1
                    [draw] => 1
                    [GF] => 4
                    [GA] => 5
                    [season_id] => 1
                    [rank] => 2
                )

        )

) 
```

结果只显示`team_id`，但我怎样才能得到进一步的扩展`team_id`呢？

我已经在我的团队模型中添加了以下内容，但仍然没有自动链接。以下是我的所有模型：

```
class Team extends AppModel
{
    public $name = 'Team';
    public $hasMany = array(
        'Standing' => array(
            'className' => 'Standing'
        ));
}

class Season extends AppModel
{
    public $name = 'Season';
    public $hasMany = array(
        'Standing' => array(
            'className' => 'Standing'
        ));
}

class Standing extends AppModel
{
    public $name = 'Standing';
    public $belongsTo = array(
        'Team' => array(
            'className' => 'Team',
            'foreignKey' => 'team_id',
            ),

        'Season' => array(
            'className' => 'Season',
            'foreignKey' => 'season_id',
            ),

        );
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T15:38:49.283

**TLDR：**

使用 CakePHP 的[[Containable]](http://book.cakephp.org/2.0/en/core-libraries/behaviors/containable.html#containable)行为。

* * *

**解释和代码示例：**

“可包含”让您“包含”您想要的任何相关数据。与“递归”不同，后者盲目地提取整个数据级别（并且通常会导致内存错误），“可包含”允许您精确指定要检索的数据，甚至可以根据需要精确到字段。

基本上，您将模型设置为`public $actsAs = array('Containable');` （我建议在您的 AppModel 中这样做，以便所有模型都可以使用 Containable）。然后，您传递要检索的关联模型的“包含”数组/嵌套数组（参见下面的示例）。

在阅读了它并按照说明进行操作后，您的代码应该类似于以下内容：

```
public function view($id = null)
{
    if(empty($id)) $this->redirect('/');

    $season = $this->Season->find('first', array(
        'conditions' => array(
            'Season.id' => $id
        ),
        'contain' => array(
            'Standing' => array(
                'Team'
            )
        )
    );
    $this->set(compact('season'));
} 
```

一旦您对 CakePHP 更加熟悉，您应该真正将这样的函数移动到模型中，而不是将它们放在控制器中（搜索“CakePHP Fat Models Skinny Controllers”），但现在，让它工作。:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T15:28:39.330

利用 ：

```
$this->Season->id = $id;
$this->Season->recursive = 2;
$this->set('season', $this->Season->read()); 
```

# android - Android 可跨行高

> ID：12917813
> 
> 赞同：13
> 
> 时间：2012-10-16T15:10:20.303
> 
> 标签：android, textview, spannablestring

最近几天一直在尝试解决这个问题，但没有成功......

我现在正在学习android，目前正在创建一个带有历史的计算器作为我的学习项目。我有一个负责显示所有历史记录的 TextView……我使用的是一种看起来像计算器字体的数字字体，但这仅适用于数字、小数和逗号。我希望所有运算符都以不同的字体突出显示（目前为 Arial Narrow）。我已经能够使用可扩展的字符串很好地工作，在该字符串中我指定了字体颜色以及使用 CustomTypeFaceSpan 类应用我的自定义字体的字体。

问题......当我混合字体时，行高似乎存在问题，所以我发现[这篇文章](https://stackoverflow.com/questions/11111129/android-textview-individual-line-spacing-for-each-line "邮政11111129")演示了使用另一个自定义定义的类将行高应用于每行添加的可跨文本：

```
public class CustomLineHeightSpan implements LineHeightSpan{
    private final int height;

    public CustomLineHeightSpan(int height){
        this.height = height;
    }

    @Override
    public void chooseHeight(CharSequence text, int start, int end, int spanstartv, int v, FontMetricsInt fm) {
        fm.bottom += height;
        fm.descent += height;
    }

} 
```

这似乎不起作用，我不知道为什么。如果我不应用不同的字体，那么它会按预期显示，第一行上方没有空格，行间距约为 5px。当我应用备用字体时，第一行文本上方有大约 10 到 15 像素的空间，行距大约是 10 到 15 像素。

字体大小没有区别，只有字体。我错过了什么。我实现了 CustomLineHeightSpan，它实现了 LineHeightSpan 并覆盖了 chooseHeight 方法。我这样称呼它：

WordtoSpan.setSpan(new CustomLineHeightSpan(10), operatorPositions.get(ii), operatorPositions.get(ii) + 1, Spannable.SPAN_EXCLUSIVE_EXCLUSIVE);

我对 CustomLineHeightSpan 的调用似乎并不重要。没有什么变化...

任何人都知道我错过了什么......我确定这是一个“我不敢相信我错过了”的答案，但目前似乎无法弄清楚。

感谢您的帮助:-)

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-10-17T01:08:16.610

我终于找到了一个更深入的使用 LineHeightSpan 的例子......实际上 LineHeightSpan.WithDensity 更准确......以下是帮助我解决问题的摘录：

```
private static class Height implements LineHeightSpan.WithDensity {
    private int mSize;
    private static float sProportion = 0;

    public Height(int size) {
        mSize = size;
    }

    public void chooseHeight(CharSequence text, int start, int end,
                             int spanstartv, int v,
                             Paint.FontMetricsInt fm) {
        // Should not get called, at least not by StaticLayout.
        chooseHeight(text, start, end, spanstartv, v, fm, null);
    }

    public void chooseHeight(CharSequence text, int start, int end,
                             int spanstartv, int v,
                             Paint.FontMetricsInt fm, TextPaint paint) {
        int size = mSize;
        if (paint != null) {
            size *= paint.density;
        }

        if (fm.bottom - fm.top < size) {
            fm.top = fm.bottom - size;
            fm.ascent = fm.ascent - size;
        } else {
            if (sProportion == 0) {
                /*
                 * Calculate what fraction of the nominal ascent
                 * the height of a capital letter actually is,
                 * so that we won't reduce the ascent to less than
                 * that unless we absolutely have to.
                 */

                Paint p = new Paint();
                p.setTextSize(100);
                Rect r = new Rect();
                p.getTextBounds("ABCDEFG", 0, 7, r);

                sProportion = (r.top) / p.ascent();
            }

            int need = (int) Math.ceil(-fm.top * sProportion);

            if (size - fm.descent >= need) {
                /*
                 * It is safe to shrink the ascent this much.
                 */

                fm.top = fm.bottom - size;
                fm.ascent = fm.descent - size;
            } else if (size >= need) {
                /*
                 * We can't show all the descent, but we can at least
                 * show all the ascent.
                 */

                fm.top = fm.ascent = -need;
                fm.bottom = fm.descent = fm.top + size;
            } else {
                /*
                 * Show as much of the ascent as we can, and no descent.
                 */

                fm.top = fm.ascent = -size;
                fm.bottom = fm.descent = 0;
            }
        }
    }
} 
```

这取自[这个例子](http://alvinalexander.com/java/jwarehouse/android/core/java/android/content/res/StringBlock.java.shtml)。

它的作用如下：

> 将文本行强制为指定的高度，如果可能，缩小/拉伸上升，或者如果进一步缩小上升，则下降将使文本不可读。

我希望这可以帮助下一个人:-)

# web-applications - 开发跨平台应用程序

> ID：12917815
> 
> 赞同：1
> 
> 时间：2012-10-16T15:10:25.500
> 
> 标签：web-applications, mobile, cross-platform, desktop-application

我希望让这个问题尽可能广泛，我在 Linux 环境中找到了一份工作。截至目前，我是一名仅使用 VB.net 的程序员，现在，我希望/需要同时关注 Linux、Windows、Android 和 Web 应用程序等多个平台。我愿意为此学习新的语言，我考虑的选项是 JAVA 和 Python，据我所知，Python 易于使用且在性能和部署方面很困难，而 Java 在性能等所有常见方面都很好、部署、库等

您能否建议在桌面应用程序和 Web 应用程序生产的跨平台方面有什么好处。我对任何新软件持开放态度，因为 vb.net 在某种程度上仅限于 Windows（Linux 部分通过第三方软件得到支持）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T03:05:10.890

来自 VB.NET，您应该查看[Real Studio](http://www.realsoftware.com)。从语言和 IDE 的角度来看，它类似于 VB.NET，并且在 Linux（以及 Windows 和 OS X）上本地运行。它为 Linux、Windows、OS X 和 Web 创建跨平台应用程序。它不能直接创建 Android 应用程序，但它的 Web 应用程序在移动设备上运行良好。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-10-16T15:12:30.557

我肯定会推荐 python :) python 运行在 linux、windows、mac osx、iphone、android、ps2、ps3、psp、ipod nano&touch 等等......标准库非常棒

你可以用它做任何事情（游戏、用户界面、网络开发......）这是一个用 python 制作的程序列表：

[http://en.wikipedia.org/wiki/List_of_Python_software](http://en.wikipedia.org/wiki/List_of_Python_software)

nasa、google、wikipedia 使用 python

Python 可以用 py2exe 编译

更多信息谷歌它

如果你进入，我希望你会喜欢 python

# html - 使用css在iE中从右到左渐变 - 可能吗？

> ID：12917818
> 
> 赞同：5
> 
> 时间：2012-10-16T15:10:33.043
> 
> 标签：html, css, internet-explorer

是否可以在 IE 5-9 中创建从右到左的渐变？在 IE 10 中是可能的，但在早期版本中是否不使用图像？

早期版本中从左到右的渐变：

```
/* For Internet Explorer 5.5 - 7 */
filter: progid:DXImageTransform.Microsoft.gradient(startColorStr=#D5D4D4, endColorStr=#FFFFFFFF, GradientType=1);

/* For Internet Explorer 8 */
-ms-filter: "progid:DXImageTransform.Microsoft.gradient(startColorstr=#D5D4D4, endColorstr=#FFFFFFFF, GradientType=1)"; 
```

在 IE 10 中有更改渐变方向的选项：

```
/* For Internet Explorer 10 */
-ms-linear-gradient(left, #D5D4D4, #fff 45%); 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-16T15:11:24.650

当然。做就是了：

```
/* For Internet Explorer 5.5 - 7 */
filter: progid:DXImageTransform.Microsoft.gradient(startColorStr=#FFFFFFFF, endColorStr=#D5D4D4, GradientType=1);

/* For Internet Explorer 8 */
-ms-filter: "progid:DXImageTransform.Microsoft.gradient(startColorstr=#FFFFFFFF, endColorstr=#D5D4D4, GradientType=1)"; 
```

* * *

严肃的回答：[渐变`filter`](http://msdn.microsoft.com/en-us/library/ms532997%28v=vs.85%29.aspx)支持两种[渐变类型](http://msdn.microsoft.com/en-us/library/ms532887%28v=vs.85%29.aspx)：0（垂直）和 1（水平）。

如果要从 right->lef 切换到 left->right ，则需要切换`start`and `end`color hex。

# javascript - 从 UpdatePanel 内的用户控件注入 javascript

> ID：12917821
> 
> 赞同：1
> 
> 时间：2012-10-16T15:10:43.840
> 
> 标签：javascript, asp.net, vb.net, user-controls, updatepanel

当页面最初呈现时，该`initializeControl`函数被调用并且一切正常。

当页面执行完整的回发（通过提交按钮）时，该`initializeControl`函数也被调用并且一切正常。

但是，当有 的部分回发时`UpdatePanel`，永远不会调用该`initializeControl`函数并且控件停止工作。

HTML：

```
<asp:ScriptManager ID="myScriptManager" runat="server" />
<asp:UpdatePanel ID="myUpdatePanel" runat="server">
    <ContentTemplate>
        <uc:MyControl ID="myControl" runat="server" />
    </ContentTemplate>
</asp:UpdatePanel> 
```

用户控制：

```
Protected Overrides Sub Render(ByVal writer As HtmlTextWriter)
    Dim initializeScript = String.Format("initializeControl('{0}');", ClientID)

    Page.ClientScript.RegisterStartupScript(GetType(Page),
        New Guid().ToString(), initializeScript, True)

    MyBase.Render(writer)
End Sub 
```

出于测试目的，假设`initializeControl`函数只是一个`debugger;`（函数的内容工作正常 - 它只是在需要时不被调用）。

请记住，用户控件无法（据我所知）知道它是否在内部`UpdatePanel`，并且它也无法访问`ScriptManager`服务器代码中父页面上的元素。

提前致谢。

PS 我知道`UpdatePanel`s 很糟糕，应该不惜一切代价避免，但我正在处理数百个已经在使用它们并且无法更改的消费页面。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T15:22:04.657

这很可能是因为页面更新是通过更新面板进行的。在这些情况下，启动脚本可能会出现无法触发的问题，并且需要包含在：

```
Sys.Application.add_load(function(){ myFunctionCall(); }); 
```

这是 Microsoft AJAX 库确保启动脚本在 MS AJAX 往返期间发生的方式。

这是一种确保添加到页面的所有客户端脚本都能正常工作的简单方法，无论它们是否包含在 ajax 更新面板中。我们在所有项目中都使用它，它完美无缺：

[ASP.Net - AJAX UpdatePanel 中的 Javascript](https://stackoverflow.com/questions/1952817/asp-net-javascript-inside-ajax-updatepanel/1953122#1953122)

# sql - 选择日期在 [this] 和 [that] 之间的行

> ID：12917829
> 
> 赞同：0
> 
> 时间：2012-10-16T15:11:02.157
> 
> 标签：sql, sql-server, where

我有一个包含“inspect_date”列的表。此列包含格式为 DD/MM/YYYY HH:MM:SS 的日期。我正在尝试查找 2012 年 4 月到 2012 年 9 月之间的记录。我可以在 WHERE 子句中添加什么才能做到这一点？

我正在使用 Microsoft SQL Server 2008。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-16T15:13:43.793

```
select * from table
where inspect_date>= '04/01/2012 00:00:00.000'
and inspect_date< '10/01/2012 00:00:00.000' 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-16T15:13:19.090

```
WHERE inspect_date BETWEEN '2012-04-01' and '2012-09-30' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-16T15:18:54.173

```
SELECT * FROM ....WHERE 
inspect_date >= CAST('20120401' AS datetime) and
inspect_date <  CAST('20121001' AS datetime)

for year selection you can use

WHERE DATEPART(YEAR,inspect_date)=2012 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-16T15:22:19.413

如果您需要它灵活，请尝试像这样分开日期：

```
WHERE MONTH(inspect_date) > 3 AND YEAR(inspect_date)= 2011
OR MONTH(inspect_date) <= 5 AND YEAR(inspect_date)= 2012 
```

# swing - 如何在 Netbeans GUI builder 中拆分视图设计和源代码

> ID：12917832
> 
> 赞同：1
> 
> 时间：2012-10-16T15:11:03.423
> 
> 标签：swing, netbeans, gui-builder

简而言之，是否可以使用 Netbeans GUI builder 同时查看源代码和设计器？

即使没有真正直接的方法，我也想知道是否有人对解决方法有任何想法，例如在多个选项卡中打开表单。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T21:22:44.067

打开表单以使其显示。右键单击它的名称选项卡并选择克隆。

![在此处输入图像描述](../Images/bd239c23cbf5bfd8178a6fb12e6577e8.png)

您现在应该有两个具有相同名称的选项卡，代表相同的类。

在其中一个选项卡上，单击“来源”。

现在，您可以将第二个/克隆的视图“重新停靠”到任何您想要的位置。

![在此处输入图像描述](../Images/dd3628f0d2354f4223377ab80a5c0526.png)

# android - android - 将 html 链接分享到 facebook、twitter 或电子邮件

> ID：12917838
> 
> 赞同：2
> 
> 时间：2012-10-16T15:11:14.047
> 
> 标签：android, share

我正在尝试分享一个指向 facebook、twitter 或电子邮件的 html 链接。这是我到目前为止所拥有的，但有两件事出了问题。

```
Intent shareIntent = new Intent(Intent.ACTION_SEND);

shareIntent.setType("text/html");
shareIntent.putExtra(Intent.EXTRA_TEXT, "<!DOCTYPE html><html><body>" + htmlUrl + "</body></html>");

startActivity(Intent.createChooser(shareIntent, "Share!")); 
```

在哪里`htmlUrl = "<a href=\"http://{url}/?q=" + queryString.substring(0, queryString.length() - 1) + "\" >Text to url! </a>"`

首先，这仅在列表中显示电子邮件应用程序。

其次，它在电子邮件中显示为全文而不是 HTML 项。

谢谢，德曼

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T15:18:57.747

您的 MIME 类型错误。改用这个：

```
shareIntent.setType("text/plain"); 
```

如果您只想共享链接而不是完整的 HTML，只需使用 url 作为`Intent.EXTRA_TEXT`值：

```
shareIntent.putExtra( Intent.EXTRA_TEXT, url ); 
```

请注意，只有少数应用程序（如 GMail、蓝牙和 Dropbox）支持共享 HTML。使用纯文本让更多应用捕捉您的`Intent`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-08-20T04:43:01.237

分享到Facebook（使用此方法只能分享链接）

```
Intent facebookIntent = new Intent(Intent.ACTION_SEND);
facebookIntent.setType("text/plain");
facebookIntent.setPackage("com.facebook.katana");
facebookIntent.putExtra(Intent.EXTRA_TEXT, shareUrl);
startActivity(facebookIntent); 
```

分享到电子邮件（使用此方法可以将电子邮件内容更改为 html 格式，但不能使用默认电子邮件客户端，它适用于 gmail 客户端。）

```
 Intent intent = new Intent(Intent.ACTION_SEND);
    intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
    intent.putExtra(Intent.EXTRA_SUBJECT, shareTitle);
    intent.putExtra(Intent.EXTRA_TEXT, Html.fromHtml(content of your email));
    intent.setType("message/rfc822");
    startActivity(Intent.createChooser(intent, "Share to Email...")); 
```

分享到推特

```
 Intent intent = new Intent(Intent.ACTION_SEND);
    intent.putExtra(Intent.EXTRA_TEXT, your content);
    intent.setType("application/twitter");
    startActivity(intent); 
```

希望这可以帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-30T06:24:01.607

您只会错过代码的一个小改动 - 用于`Html.fromHtml`将字符串编码为 HTML。

此链接提供了更详细的示例：http: [//blog.iangclifton.com/2010/05/17/sending-html-email-with-android-intent/](http://blog.iangclifton.com/2010/05/17/sending-html-email-with-android-intent/)

这将不允许您在 Facebook 上共享，因为 Facebook 应用程序不支持`ACTION_SEND`，`text/html`但这将允许您使用 Gmail 应用程序共享 HTML 内容

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-16T15:19:02.810

这个

```
shareIntent.setType("text/html"); 
```

应该为html部分做。为什么只有电子邮件显示不知道，您是否安装了其他应用程序（如 facebook、twitter 等）来处理共享意图？

# ios - Appledoc 自动复制 html 到项目目录

> ID：12917841
> 
> 赞同：0
> 
> 时间：2012-10-16T15:11:21.463
> 
> 标签：ios, appledoc

所以我有一个构建脚本，它在 xcode 中构建我的库后运行，它生成 appledoc 文档并将其安装到 XCode 中。

令人讨厌的是，这会将所有 HTML 等放入我的用户主文件夹的（隐藏）库文件夹中的一个不起眼的文件夹中。

真正棒的是能够从这些文档集中复制 HTML 并将它们放入项目目录中的文件夹中。然后可以在需要发布时将其复制到库的压缩存档中。

如果是手动执行的情况（查看appledoc的帮助页面，它似乎不能开箱即用）那么我可以这样做，但是有没有办法从appledoc获取最终目录路径？我能看到的唯一方法是拆开输出文件并在其中找到路径。

谢谢你的帮助！:)

汤姆

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T02:42:01.570

您可以使用 Appledoc[项目设置](http://gentlebytes.com/appledoc-docs-settings/#project-settings "项目设置")文件来自定义文档的输出路径（以及其他内容）。

具体来说，您可以将此密钥添加到您的 AppledocSettings.plist 文件中：

```
<key>--output</key>
<array>
    <string>Documentation/</string>
</array> 
```

你可以用一堆命令行开关来完成同样的事情，但打字`appledoc ~/path/project.plist`要干净得多。

编辑：似乎 Gentlebytes 的 Appledoc 文档由于站点重组而消失了（具有讽刺意味的是），因此该链接当前是 404。这至少是 AppledocSettings.plist 格式的一个[简单示例](https://github.com/tomaz/appledoc/blob/master/AppledocSettings.plist)，您可以添加`--output`关键。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-14T14:33:09.040

就像@Bourbon Jockey 提到的那样，您可以使用 plist 文件。然而，它对我的​​工作方式略有不同：

1.  将 AppledocSettings.plist 放在项目的根目录中（注意“S”大写）。
2.  “--output”不一定需要在数组中。以下是对我有用的示例：

```
 <?xml version="1.0" encoding="UTF-8"?>
    <!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
    <plist version="1.0">
    <dict>
          <key>--project-name</key>  
          <string>The New Achiever</string>

          <key>--project-company</key>  
          <string>NHOC</string> 

          <key>--company-id</key>  
          <string>com.nhoc</string>

          <key>--ignore</key>
          <array>
              <string>*.m</string>
          </array>

          <key>--output</key>
          <string>/Users/Fernando/Documents/Projetos/Software/Achiever/Help</string>

          <key>--keep-intermediate-files</key>  
          <true/>
    </dict>
    </plist> 
```

运行：

```
appledoc . 
```

这些链接对我帮助很大：

[Gentle Bytes 设置和参数](http://gentlebytes.com/appledoc-docs-settings/)
[惊人的类似 Apple 的文档](http://www.cocoanetics.com/2011/11/amazing-apple-like-documentation/)

# android - 在 onPause 和键盘显示后以编程方式布局消失

> ID：12917842
> 
> 赞同：0
> 
> 时间：2012-10-16T15:11:21.233
> 
> 标签：android, android-layout

我正在使用`android.support.v4.view.ViewPager`和开发一个 Android 3.1 平板电脑应用程序`android.support.v4.app.FragmentActivity`。

以下片段已以**编程**方式生成：

![在此处输入图像描述](../Images/41f24b9e118e35090ad9730efb04f3f0.png)

以编程方式生成了八个 EditText 行。

如果我点击 EditText，我会看到：

![在此处输入图像描述](../Images/bf93275a4830ec362611736d51e5dc62.png)

当点击此屏幕上的桌面主页按钮时，我回到应用程序，我看到：

![在此处输入图像描述](../Images/61deb29f20ee65927b80f9d6a7b078a0.png)

但是，如果视图被破坏然后重新创建（并且我以编程方式重新创建所有 8 行）一切正常。

发生了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T16:12:46.583

您是否尝试过将此添加到您的清单文件中

```
android:configChanges="screenSize|orientation|keyboardHidden" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-20T13:52:23.757

我已经解决了将 ScrollView 设置为父布局的问题。

# php - TYPO3 pi_getLL 的 Extbase 代码？

> ID：12917847
> 
> 赞同：5
> 
> 时间：2012-10-16T15:11:30.463
> 
> 标签：php, typo3, extbase

在基于 pi 的扩展中，我有：`$this->pi_getLL('languagekey')`获取翻译后的变量。

什么是 Extbase 代码？

我知道如何在流体模板中执行此操作，但我需要在存储库中使用它。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-16T15:23:04.937

检查[这个线索](http://docs.typo3.org/typo3cms/ExtbaseFluidBook/9-CrosscuttingConcerns/1-localizing-and-internationalizing-an-extension.html)，它表明这应该工作：

```
Tx_Extbase_Utility_Localization::translate($key, $extensionName, $arguments=NULL) 
```

这也应该可以解决问题：

```
$GLOBALS['LANG']->sL('LLL:EXT:tt_news/locallang.xml:cms_layout.not_configured'); 
```

顺便说一句，有时最简单的解决方案是检查您知道的 ViewHelper 是如何工作的。如我所见`Translate`，VH 使用相同的方法，请使用以下方法检查`render(...)`：

> /typo3/sysext/fluid/Classes/ViewHelpers/TranslateViewHelper.php

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-11-20T12:26:39.243

在 TYPO3 6.2x 或更高版本中，您可以像这样在控制器中获取标签：

> \TYPO3\CMS\Extbase\Utility\LocalizationUtility::translate('your_label_key','your_extensionName');

# backbone.js - 未捕获的错误：必须为 CollectionView 指定“url”属性或函数

> ID：12917849
> 
> 赞同：8
> 
> 时间：2012-10-16T15:11:36.023
> 
> 标签：backbone.js

我知道这个错误已经出现了几次，但我仍然不确定如何使这个工作正常..

我的魔法从这里开始：

```
 var list_edit_member_view = new app.views.ListMemberEdit({
      el: $("#enterprise_member_list_edit_container"),
      list_ids: list_ids
    });
    list_edit_member_view.render(); 
```

这会加载这个视图（**ListMemberEdit.js**），它在 render() 中有这个：

```
this.list_edit_member_view = new app.views.CollectionView({
  el: $("#enterprise_member_list_edit_container"),
  collection: app.peers,
  list_item: app.views.ListMemberEditSelection, 
  list_item_options: {list_ids: this.options.list_ids} 
}); 
```

它加载了一个将其呈现`list_item_options`为模型视图的 CollectionView 视图。它在这个文件（`ListMemberEditSelection.js`）中，当我执行时`this.destroy`，它将返回：

```
Uncaught Error: A "url" property or function must be specified 
```

所以这让我觉得模型或模型 URL 没有被定义。我只是不确定把它放在哪里，因为它与我做大致相同事情的其他部分非常相似。

有什么想法吗？我为含糊而道歉。如果你还有什么想看的，请告诉我！

我很好奇是否有可能查看此 URL 属性将在对象模型或集合本身中写入的*位置。*

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-10-16T15:32:45.180

这是因为`destroy()`函数也会调用`Backbone.sync`来更新服务器，而不仅仅是前端的模型。[http://backbonejs.org/#Model-destroy](http://backbonejs.org/#Model-destroy)

因此，如果您使用 REST 同步数据，则需要在模型中设置 url 属性，以便 Backbone 知道将请求发送到何处：

```
Backbone.Model.extend({
    url: "http://myapi.com/"
}) 
```

为了提供更大的灵活性，您还可以设置一个 urlRoot：[http ://backbonejs.org/#Model-urlRoot](http://backbonejs.org/#Model-urlRoot)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-11-11T11:04:54.197

我有一个类似的问题，我`"id":""`从我的模型默认值中删除了，问题就解决了。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-16T15:31:14.383

我确实收到了类似的错误试试这个：我只是在假设你的模型可能是什么样子

```
window.MyModel = Backbone.Model.extend({
  url: function(){
    return this.instanceUrl;
  },
  initialize: function(props){
    this.instanceUrl = props.url;
  } 
} 
```

请查看我发布的这个问题以获取更多详细信息：[https ://stackoverflow.com/a/11700275/405117](https://stackoverflow.com/a/11700275/405117)

我提供此参考，因为这里的答案帮助我更好地理解

希望这可以帮助！

# active-directory - 顶级活动目录路径？

> ID：12917851
> 
> 赞同：0
> 
> 时间：2012-10-16T15:11:37.063
> 
> 标签：active-directory

我需要以编程方式遍历活动目录树 (C#) 中特定 OU 中的所有项目。为此，我有一个配置来指定要迭代的 OU。这工作正常。

但是，我的客户现在想要遍历 AD 树中的所有项目。我如何指定一个包含 AD 树中所有 OU 的路径，以便我的应用程序将遍历所有这些？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T16:20:50.930

您只能指定域组件。例如：`LDAP://DC=Fabrikam,DC=COM`

阅读更多：[杰出的名字](http://msdn.microsoft.com/en-us/library/windows/desktop/aa366101%28v=vs.85%29.aspx)

# api - 有没有办法隐藏/显示使用 adobe flash builder 创建的 pdf 组合中的文档以及由文档元数据过滤的组合 api？

> ID：12917853
> 
> 赞同：0
> 
> 时间：2012-10-16T15:11:40.983
> 
> 标签：api, adobe, flash-builder, portfolio

我目前正在研究一个 PDF 作品集，它基本上可以让用户选择他们的语言。根据他们的选择，我想要过滤显示哪些文档（通过显示在其元数据中具有指定关键字的文档）。

目前，我不确定两件事，需要帮助：

1.  是否可以使用组合 API 访问文档元数据（尤其是 pdf 关键字字段）。

2.  是否可以对用户隐藏 PDF 组合中的文档。

如果有人对这方面有任何想法，请与我讨论。我将不胜感激。

奥吉尔。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T15:17:20.213

这两个问题的答案可以在我的相关帖子中找到：

[如何打开 PDF 包中的附件？](https://stackoverflow.com/questions/13015162/how-can-i-open-an-attachment-from-a-pdf-portfolio)

[使用 Flex 4 API，我如何从 adobe PDF 组合中的 PDF 访问数据？](https://stackoverflow.com/questions/12930448/using-the-flex-4-api-how-can-i-access-data-from-a-pdf-in-an-adobe-pdf-portfolio)

# mongodb - MongoDB $in, $all 带正则表达式

> ID：12917854
> 
> 赞同：1
> 
> 时间：2012-10-16T15:11:43.757
> 
> 标签：mongodb, doctrine-odm

我正在使用 mongodb 和教义/mongodb-odm-bundle 我正在尝试构建这样的查询

```
$matches = array("/^abc/", "/^dbc/);

$this->createQueryBuilder()
    ->field('field_name')->in($matches)
    ->getQuery(); 
```

是带有正则表达式的使用`$all`和条件运算符。`$in`有可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T15:23:27.703

你可以，但是虽然我不是 PHP 专家，但它看起来像是`$matches`一个字符串数组，而不是正则表达式。你需要做这样的事情，而不是：

```
$matches = array(new MongoRegex("/^abc/"), new MongoRegex("/^dbc/")); 
```

在外壳中你会做：

```
db.collection.find({field_name: {$in: [/^abc/, /^dbc/]}}) 
```

# azure - 并行上传 Blob 时“指定的阻止列表无效”

> ID：12917857
> 
> 赞同：8
> 
> 时间：2012-10-16T15:11:47.203
> 
> 标签：azure, blobstorage

我有一个（相当大的）Azure 应用程序，它将（相当大的）文件并行上传到 Azure blob 存储。

在百分之几的上传中，我得到了一个例外：

`The specified block list is invalid.`

`System.Net.WebException: The remote server returned an error: (400) Bad Request.`

这是当我们运行一段看起来相当无害的代码来将 blob 并行上传到 Azure 存储时：

```
 public static void UploadBlobBlocksInParallel(this CloudBlockBlob blob, FileInfo file) 
    {
        blob.DeleteIfExists();
        blob.Properties.ContentType = file.GetContentType();
        blob.Metadata["Extension"] = file.Extension;

        byte[] data = File.ReadAllBytes(file.FullName);

        int numberOfBlocks = (data.Length / BlockLength) + 1;
        string[] blockIds = new string[numberOfBlocks];

        Parallel.For(
            0, 
            numberOfBlocks, 
            x =>
        {
            string blockId = Convert.ToBase64String(Guid.NewGuid().ToByteArray());
            int currentLength = Math.Min(BlockLength, data.Length - (x * BlockLength));

            using (var memStream = new MemoryStream(data, x * BlockLength, currentLength))
            {
                var blockData = memStream.ToArray();
                var md5Check = System.Security.Cryptography.MD5.Create();
                var md5Hash = md5Check.ComputeHash(blockData, 0, blockData.Length);

                blob.PutBlock(blockId, memStream, Convert.ToBase64String(md5Hash));
            }

            blockIds[x] = blockId;
        });

        byte[] fileHash  = _md5Check.ComputeHash(data, 0, data.Length);
        blob.Metadata["Checksum"] = BitConverter.ToString(fileHash).Replace("-", string.Empty);
        blob.Properties.ContentMD5 = Convert.ToBase64String(fileHash);

        data = null;
        blob.PutBlockList(blockIds);
        blob.SetMetadata();
        blob.SetProperties();
    } 
```

都非常神秘；我认为我们用来计算阻止列表的算法应该产生长度相同的字符串......

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2018-10-29T21:59:26.480

我们遇到了类似的问题，但是我们没有指定任何块 ID，甚至没有在任何地方使用块 ID。在我们的例子中，我们使用的是：

```
using (CloudBlobStream stream = blob.OpenWrite(condition))
{
   //// [write data to stream]

   stream.Flush();
   stream.Commit();
} 
```

这将导致`The specified block list is invalid.`并行负载下的错误。[`UploadFromStream(…)`](https://docs.microsoft.com/en-us/dotnet/api/microsoft.windowsazure.storage.blob.cloudblockblob.uploadfromstream?view=azure-dotnet)在将数据缓冲到内存中时切换此代码以使用该方法解决了该问题：

```
using (MemoryStream stream = new MemoryStream())
{
   //// [write data to stream]

   stream.Seek(0, SeekOrigin.Begin);
   blob.UploadFromStream(stream, condition);
} 
```

显然，如果太多数据缓冲到内存中，这可能会对内存产生负面影响，但这是一种简化。需要注意的一点是，`UploadFromStream(...)`它`Commit()`在某些情况下使用，但会检查其他条件以确定最佳使用方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2020-01-29T20:15:19.577

*注意：此解决方案基于 Azure JDK 代码，但我认为我们可以放心地假设纯 REST 版本将具有相同的效果（实际上与任何其他语言一样）。*

由于我花了整个工作日来解决这个问题，即使这实际上是一个极端案例，我也会在这里留下一个便条，也许它会对某人有所帮助。

我做的一切都是正确的。我有正确顺序的块 ID，我有相同长度的块 ID，我有一个干净的容器，没有以前的一些块的剩余物（这三个原因是我能够通过谷歌找到的唯一原因）。

有一个问题：我一直在为提交构建我的阻止列表

```
CloudBlockBlob.commitBlockList(Iterable<BlockEntry> blockList) 
```

使用此构造函数：

```
BlockEntry(String id, BlockSearchMode searchMode) 
```

通过

```
BlockSearchMode.COMMITTED 
```

在第二个论点。这**被**证明是根本原因。一旦我将其更改为

```
BlockSearchMode.UNCOMMITTED 
```

并最终落到单参数构造函数上

```
BlockEntry(String id) 
```

默认情况下使用 UNCOMMITED，提交阻止列表有效并且 blob 成功持久化。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-04-29T11:48:11.540

当多个线程将流打开到具有相同文件名的 blob 并尝试同时写入此 blob 时，也会发生此异常。

# sql-server-2008 - 在发布者和订阅者上复制数据库时执行命令？

> ID：12917858
> 
> 赞同：0
> 
> 时间：2012-10-16T15:11:49.620
> 
> 标签：sql-server-2008, sql-server-2012

我有两个 MSSQL 2012 数据库。我配置了快照复制，其中第一台服务器是发布者和分发者，另一台是订阅者。

我希望能够在复制作业发生之前在发布者上执行一个命令，然后在复制完成后在订阅者上执行另一个命令。

我相信这应该是一个拉快照复制，以便代理位于订阅服务器上。

这甚至可能吗？

编辑。由于快照复制的性质，我转而使用事务复制，因此我无法在复制启动和停止时执行脚本。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T09:08:33.950

当我切换到事务复制时，我从来没有找到在数据复制时成功执行命令的方法。处理此事务类型的作业将开始然后继续运行，而不像作业开始的快照复制 - 复制数据 - 停止。

相反，我使用任务调度程序设置了我需要执行的作业。我的服务通过数据库在网络服务器之间传输文件。并且只会在尚未存在的情况下传输文件。

使用任务调度器工作得非常好，它比让一些东西执行一个 sql 脚本，然后执行一个 powershell 远程命令来连接到服务器并执行服务要简单和稳定得多。

我只是想如果其他人偶然发现类似的问题，我会添加这个:)

# tridion - 我可以使用 Tridion XM/New UI/2012 UI 拥有灵活/包罗万象的区域吗

> ID：12917860
> 
> 赞同：7
> 
> 时间：2012-10-16T15:11:52.477
> 
> 标签：tridion, tridion-2011

我正在为一个旨在使用 Tridion 2012 UI/XM 管理页面的网站进行功能设计。页面上有 2 个区域，左侧是主要内容区域，右侧是侧边栏。理想情况下，用户应该能够将内容拖放到这些区域中。在一个理想的世界中，我想定义沿线的区域

*   侧栏：CT 中包含文本“Right”的任何 CP。
*   主要：所有其他CP

查看[文档](http://sdllivecontent.sdl.com/LiveContent/web/pub.xql?action=home&pub=UIU4SDLT2011SP1&lang=en-US#addHistory=true&filename=DefiningRegionsOnAWebPage.xml&docid=task_4E5EFDF4775E4A3B8703E912D7C0ED60&inner_id=&tid=&query=&scope=&resource=&eventType=lcContent.loadDoctask_4E5EFDF4775E4A3B8703E912D7C0ED60) ，您似乎需要明确使用 CT/Schema ID 对来定义区域。有没有可能以任何其他方式做到这一点？

至少我希望能够定义侧栏允许一组固定的 CT/Schema ID 对，但将主要区域作为一个包罗万象的存储桶。这可能吗？

侧边栏也有可能被分成 2 个区域，在广告上方和下方。两个地区都应该允许相同类型的 CP - 据我了解这是不可能的 - 这是正确的吗？有什么解决方法的想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-16T17:14:30.007

要配置采用所有内容类型的区域，您需要获取 Publication AppData 并遍历内容类型并构建您的 json 标记以启用此功能。您可以编写包含在每个页面模板上并执行此逻辑的 C# TBB，您可以定义一些CT 级别的元数据，确定它将进入哪个区域并构建区域 JSON 标记。

下面是让所有组件类型添加到一个区域的代码段。您可以通过检查模板名称来更改逻辑以使其正确。

```
 // get the publication from the engine -- using TemplateBase Util..

    Publication thisPub = GetPublication();

    XmlElement seAppdata = thisPub.LoadApplicationData("SiteEdit").GetAs<XmlElement>();

    XmlNamespaceManager seNsMgr = new XmlNamespaceManager(new NameTable());
    seNsMgr.AddNamespace("se", "http://www.sdltridion.com/2011/SiteEdit");
    seNsMgr.AddNamespace("xlink", "http://www.w3.org/1999/xlink");

    XmlNodeList contentTypes = (XmlNodeList)seAppdata.SelectNodes("//se:ContentTypes/se:ContentType", seNsMgr); 

    List<String> contentTypeJson = new List<String>();
    foreach (XmlNode contentType in contentTypes)
    {
        string templateId = contentType.SelectSingleNode("se:ComponentTemplate/@xlink:href", seNsMgr).Value;
        string componentId = contentType.SelectSingleNode("se:Component/@xlink:href", seNsMgr).Value;

        Component thisSchema = (Component)engine.GetObject(componentId);
        string schemaId = thisSchema.Schema.Id;

        // Add json formated string for Content Types
        contentTypeJson.Add(string.Format("{{schema: \"{0}\", template: \"{1}\"}}", schemaId, templateId));
    }

    // Final Markup - JSON
     String allRegionSeText = string.Format("<!-- Start Region: {{title: \"All Region\",  allowedComponentTypes: [{0}],  minOccurs: 1,  maxOccurs: 5 }} -->", string.Join(",", contentTypeJson.ToArray()));

     // Push to the package to use in DWT..
     package.PushItem("ALL_REGION", package.CreateStringItem(ContentType.Text, allRegionSeText)); 
```

希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-16T16:10:57.223

您是否尝试过在不指定 CT/Schema 对的情况下创建区域？我记得在早期的实现中看到您可以在任何地方删除内容类型，因为没有正确配置区域（或者可能根本没有）。

# c# - 异步 webresponse 任务的状态码

> ID：12917863
> 
> 赞同：0
> 
> 时间：2012-10-16T15:12:02.150
> 
> 标签：c#, .net-4.0, exception-handling, task-parallel-library

我想尽快访问大量（100k+）的 JSON 文件，将它们序列化，并存储请求的 HTTP 响应状态代码（无论是成功还是失败）。（我正在使用`System.Runtime.Serialization.Json`和`DataContract`）。我打算对状态代码和序列化对象做进一步的工作，但作为一个测试平台，我有这段代码：

```
List<int> ids = new List<int>();
for (int i = MIN; i < MAX; i++)
    ids.Add(i);
var tasks = ids.Select(id =>
{
var request = WebRequest.Create(GetURL(id));
return Task
    .Factory
    .FromAsync<WebResponse>(request.BeginGetResponse, request.EndGetResponse, id)
    .ContinueWith(t =>
    {
    HttpStatusCode code = HttpStatusCode.OK;
    Item item = null;
    try
    {
        using (var stream = t.Result.GetResponseStream())
        {
        DataContractJsonSerializer jsonSerializer = new DataContractJsonSerializer(typeof(Item));
        item = ((Item)jsonSerializer.ReadObject(stream));
        }
    }
    catch (AggregateException ex)
    {
        if (ex.InnerException is WebException)
        code = ((HttpWebResponse)((WebException)ex.InnerException).Response).StatusCode;
    }

    });
}).ToArray();
Task.WaitAll(tasks); 
```

使用这种方法，我能够比我以前使用的同步方法更快地处理文件。

虽然，我知道当状态码是或时`GetResponseStream()`会抛出。因此，要捕获这些状态代码，我需要捕获此异常。但是，在此 TPL 的上下文中，它嵌套在 an on an中。这使得这条线真的很混乱：`WebException``4xx``5xx``InnerException``AggregateException`

```
 code = ((HttpWebResponse)((WebException)ex.InnerException).Response).StatusCode; 
```

虽然，这行得通......我想知道在这种情况下是否有更好/更清晰的方法来捕获这样的异常？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T15:40:43.680

看看 MSDN 文章：[异常处理（任务并行库）](http://msdn.microsoft.com/en-us/library/dd997415.aspx)

例如，您可能希望按如下方式重写代码：

```
try
{
    using (var stream = t.Result.GetResponseStream())
    {
        DataContractJsonSerializer jsonSerializer = new
            DataContractJsonSerializer(typeof(Item));

        item = ((Item)jsonSerializer.ReadObject(stream));
    }
}
catch (AggregateException ex)
{
    foreach (var e in ex.InnerExceptions)
    {
        bool isHandled = false;
        if (e is WebException)
        {
            WebException webException = (WebException)e;
            HttpWebResponse response = webException.Response as HttpWebResponse;
            if (response != null)
            {
                code = response.StatusCode;
                isHandled = true;
            }
        }

        if (!isHandled)
            throw;
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-16T15:51:53.587

试穿这个尺寸。GetBaseException 返回导致问题的异常。

```
try
{
}
catch (System.AggregateException aex)
{

    var baseEx = aex.GetBaseException() as WebException;
    if (baseEx != null)
    {
        var httpWebResp = baseEx.Response as HttpWebResponse;
        if (httpWebResp != null)
        {
            var code = httpWebResp.StatusCode;
            // Handle it...
        }                    
    }

    throw;
} 
```

# jquery-ui - 淘汰js registerEvent 处理程序

> ID：12917867
> 
> 赞同：1
> 
> 时间：2012-10-16T15:12:29.527
> 
> 标签：jquery-ui, knockout.js

我在玩淘汰赛 js 时玩得很开心，并且刚刚开始掌握添加自定义 bindingHandlers 的方法。

我在使用第 3 方 jqWidget 仪表的更新功能时遇到了一些困难——我只能在第一次更新变量时让它动画化。在之后的每次更新中，它只是直接设置值。

我不完全理解 ko.utils.registerEventHandler() 以及它的作用，尽管我已经在许多其他示例中看到了它。这是导致动画中断的原因吗？我如何知道要从 3rd 方小部件注册哪些事件？

出于某种原因，如果我添加一个也绑定到 observable 的 jquery ui 滑块，这可以正常工作。

您可以在此处进行测试：设置该值几次以查看它第一次而不是之后的动画。

[http://jsfiddle.net/LkqTU/4531/](http://jsfiddle.net/LkqTU/4531/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T15:36:44.743

当您更新输入字段时，您的 observable 最终将成为一个字符串。看起来仪表不喜欢用字符串值更新，至少在第一次之后。

因此，如果您确保使用数字（`parseInt`、`parseFloat`或仅`+`视情况而定）对其进行更新，那么它似乎可以正常更新。

就像是：

```
update: function(element, valueAccessor) {
    var gaugeval = parseInt(ko.utils.unwrapObservable(valueAccessor()), 10);   
    $(element).jqxGauge('value', gaugeval || 0);
} 
```

[http://jsfiddle.net/rniemeyer/LkqTU/4532/](http://jsfiddle.net/rniemeyer/LkqTU/4532/)

您通常只会在这样的场景中注册事件处理程序，以响应您想要更新视图模型数据的用户所做的更改。例如，如果用户可以通过单击仪表来更改值，那么您将希望处理该事件并相应地更新您的视图模型值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-03-27T17:19:09.057

我在回答

> 我不完全理解 ko.utils.registerEventHandler() 及其作用

你问题的一部分。

`registerEventHandler`将以跨浏览器兼容的方式注册您的事件处理函数。如果您使用 jQuery，Knockout 将使用 jQuery 的`bind`函数来注册事件处理程序。否则，将使用具有跨浏览器的一致行为的浏览器 Web API。

[您可以在源代码](https://github.com/knockout/knockout/blob/master/src/utils.js)上查看它。

# java - Spring OpenSessionInViewFilter 是否持续更改？

> ID：12917873
> 
> 赞同：0
> 
> 时间：2012-10-16T15:12:46.973
> 
> 标签：java, spring, hibernate

我意识到这是一个非常愚蠢的问题，我已经用谷歌搜索了。

提交表单时，Spring OpenSessionInViewFilter 是否将 Weblayer 中所做的更改保留到 DB？

即会话保持打开的时间是否足够长，以使 Hibernate 知道填充 UI 的域对象现在“脏”并且应该更新？

我认为它（OpenSessionInViewFilter）仅用于保持休眠会话打开足够长的时间以允许 Web/UI 层访问延迟加载的集合等，然后关闭。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T16:29:24.193

> 即会话保持打开的时间是否足够长，以使 Hibernate 知道填充 UI 的域对象现在“脏”并且应该更新？

理论上，是的。但是：Web 层中的数据库对象永远不应该改变！如果他们这样做了，那么您的图层就会混淆。

# testing - 跨平台 Phonegap 应用程序的自动化 UI 测试？

> ID：12917881
> 
> 赞同：1
> 
> 时间：2012-10-16T15:13:16.767
> 
> 标签：testing, cordova, tdd, automated-tests, bdd

我有一个在 Android、iOS 和黑莓上运行的 Phonegap 应用程序。我想编写可以针对每个平台的应用程序运行的自动化 UI 测试。例如，我想在 Java 中只执行一次测试，例如“假设我在搜索结果屏幕上，当我按下后退按钮时，我应该会看到搜索屏幕”，并将这些测试应用于每个平台. 我可以为此使用哪些工具？

我看到我可以使用 Selenium 在移动平台上测试网站（并以相同的语言实现所有这些测试一次），但我不知道如何让 Selenium 与包含我的应用程序的 Web 视图进行交互。有小费吗？

# java - 只有公共静态成员的公共类

> ID：12917883
> 
> 赞同：0
> 
> 时间：2012-10-16T15:13:24.953
> 
> 标签：java, android

我有一个只包含公共静态成员的公共类。

我知道这不是最好的做法，但我只是想知道为什么在我的 Android 上，如果我暂停应用程序，打开其他一些应用程序并返回到我的应用程序，所有变量似乎都是（null）。

问题：

1.  是因为 Android 进行了某种内存释放吗？
2.  那么有什么更好的方法来保留这些变量呢？
3.  扩展 Application 的类是一个不错的选择吗？

这是我的代码：

```
public class Session {

public static String ID = null;
public static String UNIQID = null;
public static String TOKEN = null;
public static String SESSIONID = null;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T15:17:22.910

由于您的应用程序进程可能随时被破坏，这些静态实例可能确实会被垃圾收集。

如果您将这些静态变量放在自定义 Application 对象中，则同样适用，除​​非您在每次应用程序获得（重新）创建时在应用程序的 onCreate 函数中初始化它们。

您应该使用 SharedPreferences 或 SQLite 数据库来跟踪持久数据。

如果这些变量太复杂而无法像这样存储，那么您可能需要考虑使用单例（不再像以前那样推荐子类化 Application）。

```
public class MySingleton {

  public static MySingleton getInstance(Context context) {
    if (instance==null) {
      // Make sure you don't leak an activity by always using the application
      // context for singletons
      instance = new MySingleton(context.getApplicationContext());
    }
    return instance;
  }

  private static MySingleton instance = null;

  private MySingleton(Context context) {
    // init your stuff here...
  }

  private String id = null;
  private String uniqueId= null;
  private String token = null;
  private String sessionId = null;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T15:16:00.273

1.  是的，android 可能会在需要时收集内存

2.  可能类似于 SharedPreferences

# objective-c - NSSortDescriptor：同时对多个键进行自定义比较

> ID：12917886
> 
> 赞同：5
> 
> 时间：2012-10-16T15:13:30.393
> 
> 标签：objective-c, ios, sorting, comparison, nssortdescriptor

我有一个自定义对象，其中包含基于时间段的信息，例如属性 endCalYear、endMonth 和 periodLength，它们指示每个时期的结束及其长度。

我想创建一个`NSSortDescriptor`基于或其他排序方法，它结合了这三个属性并允许同时在所有三个键上对该对象进行排序。

例子：

```
EndCalYear  endMonth  periodLength (months) sortOrder
2012        6         6                     1
2012        6         3                     2
2012        3         3                     3
2011        12        12                    4 
```

排序算法将完全基于我自己的算法自行决定。

我怎么能编写这样的算法？

基于块的`sortDescriptorWithKey:ascending:comparator:`方法在我看来不起作用，因为它只允许我指定一个排序键。但是，我需要同时对所有三个键进行排序。

关于如何解决这个问题的任何想法或想法？

谢谢！

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-10-16T15:20:29.143

您可以改为使用块进行排序：

```
NSArray *sortedArray;
sortedArray = [myArray sortedArrayUsingComparator:^NSComparisonResult(id a, id b) {
    MyObject *first = (MyObject*)a;
    MyObject *second = (MyObject*)b;

    if (first.endCalYear < second.endCalYear) {
        return NSOrderedAscending;
    }
    else if (first.endCalYear > second.endCalYear) {
        return NSOrderedDescending;
    }
    // endCalYear is the same

    if (first.endMonth < second.endMonth) {
        return NSOrderedAscending;
    }
    else if (first.endMonth > second.endMonth) {
        return NSOrderedDescending;
    }    
    // endMonth is the same

    if (first.periodLength < second.periodLength) {
        return NSOrderedAscending;
    }
    else if (first.periodLength > second.periodLength) {
        return NSOrderedDescending;
    }
    // periodLength is the same

    return NSOrderedSame;
}] 
```

这是按升序排序`endCalYear`，然后`endMonth`升序，最后`periodLength`升序。您可以修改它以更改顺序或切换 if 语句中的符号以使其降序。

对于 NSFetchedResultsController 您可能想尝试其他方法：

看起来您可以[将描述符列表传递给它](http://developer.apple.com/library/ios/#documentation/CoreData/Reference/NSFetchedResultsController_Class/Reference/Reference.html)，每个要排序的列都有一个：

```
NSFetchRequest *fetchRequest = [[NSFetchRequest alloc] init];
NSSortDescriptor *descriptor1 = [[NSSortDescriptor alloc] initWithKey:@"endCalYear" ascending:YES];
NSSortDescriptor *descriptor2 = [[NSSortDescriptor alloc] initWithKey:@"endMonth" ascending:YES];
NSSortDescriptor *descriptor3 = [[NSSortDescriptor alloc] initWithKey:@"periodLength" ascending:YES];
NSArray *sortDescriptors = @[descriptor1, descriptor2, descriptor3];
[fetchRequest setSortDescriptors:sortDescriptors]; 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-10-16T16:09:17.157

用于排序的 API 通常能够使用 的数组`NSSortDescriptors`，而不仅仅是一个，那么为什么不使用它们呢？

例如，`NSArray`有一个名为`sortedArrayUsingDescriptors:`（注意复数形式）的方法，它接受一个对象数组`NSSortDescriptor`。

所以你可以简单地写这个：

```
NSSortDescriptor *endCalYearSD = [NSSortDescriptor sortDescriptorWithKey:@"endCalYear" ascending:YES];
NSSortDescriptor *endMonthSD = [NSSortDescriptor sortDescriptorWithKey:@"endMonth" ascending:YES];
NSSortDescriptor *periodLenSD = [NSSortDescriptor sortDescriptorWithKey:@"periodLength" ascending:YES];

NSArray *sortedArray = [originalArray sortedArrayUsingDescriptors:@[endCalYearSD, endMonthSD, periodLenSD]]; 
```

这样，您`originalArray`将首先按 endCalYear 排序，具有相同 endCalYear 的每个条目将按 endMonth 排序，然后每个具有相同 endCalYear 和 endMonth 的条目将按 periodLendth 排序。

对于大多数提议排序的 API（包括 CoreData 等），您有使用 sortDescriptor 数组的 API，因此原则始终相同。

* * *

如果您真的只需要坚持一个`NSSortDescriptor`（并且您的排序算法不够灵活，无法使用基于块的比较器或数组`NSSortDescriptors`），您可以简单地为您的自定义对象提供一个属性，该属性计算一些您可以使用的值基于您的排序算法。

例如，将此类方法添加到您的自定义类中：

```
-(NSUInteger)sortingIndex {
    return endCalYear*10000 + endCalMonth*100 + periodLength;
} 
```

然后按此键/属性排序。这不是很干净的阅读和一个非常漂亮的设计模式，但更好的方法是改变你的排序算法 API 以允许一次对多个键进行排序，所以......</p>

* * *

### ***[编辑]**（回答您关于基于块的 API 的 [编辑]）*

我不明白为什么基于块的 API`sortDescriptorWithKey:ascending:comparator:`不适合你。你可以在那里指定你需要的任何自定义`NSComparator`块，所以这个块可以告诉，给定两个对象，哪个在另一个之前。您确定哪个在哪个之前取决于您的方式，您只能比较`endCalYear`, 或`endCalYear`和`endMonth`等，因此这里对使用多个键进行排序没有限制。

# c++ - 在OpenGL中绕轴旋转

> ID：12917895
> 
> 赞同：0
> 
> 时间：2012-10-16T15:13:46.780
> 
> 标签：c++, opengl, rotation, glut

所以我有以下向量：

```
up[]= {0,0,1}
focus[] = {-.5,0,-.25}
and v[] = {0,.5,0} (the cross product of focus X up) 
```

基本上，我正在尝试做的是围绕焦点向上旋转 v 角度 a，然后向上旋转并围绕 v 聚焦角度 a，用于我正在研究的飞行模拟器。我们知道 up 和 focus 都与 v 正交，但彼此不正交。关于如何解决这个问题的任何想法？

# asp.net - 创建“实时”ASP.NET MVC 应用程序

> ID：12917896
> 
> 赞同：0
> 
> 时间：2012-10-16T15:13:49.447
> 
> 标签：asp.net, mysql, ajax, asp.net-mvc, razor

无论是从高层次的角度，还是从低层次和非常具体的角度来看，不断轮询数据库以获取更新的最佳方式是什么？

我想创建一个“实时”应用程序，它使用 ajax 显示最新数据。我有部分视图，其中 Ajax.ActionLink 包含正确的数据，但只有该生成链接的 OnClick。

使用触发器和某种应用程序代码是最好的方法吗？例如，所有表上的触发器，它将某些字段设置为“自上次读取以来已进行更改”？

还是使用函数定期轮询数据库以检查更改是否更好（我认为这可能会对数据库的所有持续喋喋不休造成负担）？

还是这两种方法的组合最好？还是我完全遗漏了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T15:16:00.553

[SignalR](http://signalr.net/)旨在解决这个问题。

# c# - 文本和复选框之间的空间

> ID：12917897
> 
> 赞同：13
> 
> 时间：2012-10-16T15:13:49.753
> 
> 标签：c#, asp.net, .net, c#-4.0, checkbox

我想在复选框和文本之间留出空格。

```
<asp:CheckBox ID="chkPublic" runat="server" Text="Public" Font-Bold="true" /> 
```

如何在复选框和文本之间获得空间。谢谢。

**编辑**：我需要一些 css 格式。谢谢。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-10-16T15:22:32.940

```
<asp:CheckBox ID="chkPublic" runat="server" Text="Public" Font-Bold="true" CssClass="mycheckbox" /> 
```

在样式表.css

```
.mycheckbox input[type="checkbox"] 
{ 
    margin-right: 5px; 
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2019-07-19T11:49:39.367

迟到的回复，但希望对寻求解决方案的其他人有所帮助。您可以通过在文本属性值中嵌入不间断空格来“快速而简单地”添加空格。优点是您可以为其他地方应用的样式例外的控件执行此操作，而无需为一个控件创建新样式表。例如：

```
<asp:CheckBox runat="server" ID="myCheckBox" Text="&nbsp;&nbsp;Check this to subscribe" /> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-01-21T20:01:59.000

我为标签创建了一个样式：

```
label {
    font-size: 1em;
    color: black;
    text-transform: uppercase;
    margin-left: 5px;
} 
```

但是它会影响标题标签，所以我也创建了一个样式：

```
.lheader {
    font-size: 1.5em;
    color: #1ca795;
    text-transform: uppercase;
} 
```

它在所有设备上都能完美运行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-16T15:16:09.910

你可以这样写：

```
<asp:CheckBox ID="chkPublic" runat="server" Text="" Font-Bold="true" />&nbsp;MyText 
```

或者也许就是这样：

```
<asp:CheckBox ID="chkPublic" runat="server" Text="&nbsp;Public" Font-Bold="true" /> 
```

`&nbsp;`是 html 中的一个空格

# javascript - 使用 Javascript 生成随机 Webkit 动画

> ID：12917899
> 
> 赞同：0
> 
> 时间：2012-10-16T15:14:07.573
> 
> 标签：javascript, animation, webkit

我想知道是否可以使用 javascript 生成 webkit 动画。基本上我需要的是，如果我单击元素 A，元素 B 每次都应该使用随机参数进行动画处理（这就是为什么我不能使用预先固定的 CSS）。我正在测试我是否真的可以通过 javascript 生成所有这些，并且我已经走了很远。我的代码还没有做任何随机的事情，但是一旦我让它与 javasript 一起正常工作，就很容易让它随机化。所以现在我只想在每次单击元素 A 时为元素 B 设置动画。我的代码如下所示：

```
$("#elementA").live('touchstart mousedown',function() {

$("head style").remove();
var cssAnimation  = document.createElement('style');
cssAnimation.type = 'text/css';
var rules = document.createTextNode('@-webkit-keyframes random_spin {'+
'from   { -webkit-transform: rotate(0deg);      }'+
'to     { -webkit-transform: rotate(1440deg);   }'+
'}');

cssAnimation.appendChild(rules);
document.getElementsByTagName("head")[0].appendChild(cssAnimation);

$("#elementB").removeClass("random_spin");
$("#elementB").css({'-webkit-animation-name': ''});

$("#elementB").css({'-webkit-animation-name': 'random_spin'});
$("#elementB").addClass("random_spin");
}); 
```

在那里，我刚刚将动画添加到标题中，并将其应用于 elementB。

我的“random_spin”类是我已经预定义的 CSS：

```
.random_spin {
    -webkit-animation-duration:         5s;  
    -webkit-animation-timing-function:  ease;
} 
```

我这样做的目的是，每次单击 elementA 时，我都应该能够使 elementB 旋转。不幸的是，它只执行一次，无论我点击多少次或重置动画名称多少次，它仍然只执行一次。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T18:44:39.180

要重新启动 CSS3 动画，您不能只删除和添加一个类而不在命令之间放置一点延迟。这允许浏览器有时间在添加新类之前实际删除该类。你可以用一个简单的 setTimeout 来做到这一点

```
setTimeout(function(){
    $("#elementB").addClass("random_spin");
}, 100); 
```

更多信息和示例可以在下面找到。

[http://css-tricks.com/restart-css-animation/](http://css-tricks.com/restart-css-animation/)

# ios - 在模拟器中运行我的应用程序时发现泄漏（？）

> ID：12917905
> 
> 赞同：-1
> 
> 时间：2012-10-16T15:14:24.837
> 
> 标签：ios, xcode4, cocos2d-iphone

嗯......现在是一个完全不同的泄漏！我注意到，当我在 iPhone 模拟器中运行当前正在开发的应用程序时，Finder 进程会爬到 1+Gb 的内存并从我的盒子里吃掉 1 个核心。我在我的应用程序中查看了高低，并没有发现任何可疑之处，无论是使用仪器还是使用自制的监控设施。此应用程序完成的唯一磁盘 IO 是以 5 秒左右的间隔保存一个（小）.plist。

有人注意到/修复了吗？如果是，想听听您的解决方案。

MBP 最近，16 Gb 内存，OSX 10.7.5 Xcode 4.5 Simulator 版本 6，运行 iOS 6.0

这是一个游戏应用，以 cocos2d 为中心。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T22:56:01.277

也许你应该尝试分析它（command+I）并检查是否有泄漏。有时，我们调用系统函数并且它们会泄漏。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T15:35:04.957

行为在 EAP 2.0 版本中消失了。到目前为止，Finder 内存为 67 Mb，<2% cpu，稳定。

# macos - 签署我的 Mac pkg 有效但安装失败？

> ID：12917906
> 
> 赞同：3
> 
> 时间：2012-10-16T15:14:26.773
> 
> 标签：macos, installation, certificate, signing

**我正在使用这个命令行签署我的 mac 包：**

```
Volumes/Auxiliary\ Tools/PackageMaker.app/Contents/MacOS/PackageMaker \
--sign /Users/company/src/clients/linux-client/mac/company_client_installer.pkg \
--certificate "Developer ID Application: company" 
```

**签名有效，但安装失败并出现错误。这是 install.log 中的相关部分：**

```
Oct 16 16:59:33 mac installd[57355]: PackageKit: Install Failed: Error Domain=PKInstallErrorDomain Code=102 "The package “company_client_installer.pkg” is untrusted." UserInfo=0x106a2be30 {NSLocalizedDescription=The package “company_client_installer.pkg” is untrusted., NSURL=file://localhost/Users/company/src/clients/linux-client/mac/company_client_installer.pkg#companyClient.pkg, PKInstallPackageIdentifier=com.company.company_client_installer.pkg, NSUnderlyingError=0x7ffd2a52c900 "The operation couldn’t be completed. CSSMERR_TP_NOT_TRUSTED"} {
1674             NSLocalizedDescription = "The package \U201ccompany_client_installer.pkg\U201d is untrusted.";
1675             NSURL = "file://localhost/Users/company/src/clients/linux-client/mac/company_client_installer.pkg#companyClient.pkg";
1676             NSUnderlyingError = "Error Domain=NSOSStatusErrorDomain Code=-2147409622 \"The operation couldn\U2019t be completed. CSSMERR_TP_NOT_TRUSTED\" UserInfo=0x7ff     d2a5573b0 {SecTrustResult=5, PKTrustLevel=PKTrustLevelNotTrusted, NSLocalizedFailureReason=CSSMERR_TP_NOT_TRUSTED}";
1677             PKInstallPackageIdentifier = "com.company.company_client_installer.pkg"; 
```

**如果我使用 pkgutil 检查签名，它会返回：**

```
pkgutil --check-signature company_client_installer.pkg
Package "company_client_installer.pkg":
  Status: signed by a certificate trusted by Mac OS X
  Certificate Chain:
    1\. Developer ID Application: company
    2\. Developer ID Certification Authority
    3\. Apple Root CA 
```

我尝试在“钥匙串访问”中评估我的证书，它报告“**没有找到根证书**”，但用绿色复选标记表示证书为“**有效”。**

我现在完全糊涂了。我在这里做错了什么？任何想法？

沃尔克

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-07-13T11:42:05.133

我不确定您的错误，但是，我知道您需要使用 Developer ID 安装程序证书来签署您的包。

这是我使用的命令：

productsign --sign "开发者 ID 安装程序：ACME, Inc (ABCDEFGHIJK)" source.pkg destination.pkg

您还可以使用以下命令验证您的包：

spctl -a -vvvv --type install MyInstaller.pkg

# php - 如何在设定时间后显示联系表单模式弹出窗口？

> ID：12917908
> 
> 赞同：-1
> 
> 时间：2012-10-16T15:14:30.853
> 
> 标签：php, javascript, popup, modal-dialog

如果用户在我的 php 网站上闲置至少 30 秒，我需要能够向他们寻求帮助。我制作了弹出窗口并设置了样式。它位于当前使用按钮显示弹出窗口的页面上（用于测试目的）。但现在我需要删除按钮并放置某种 javascript 或 php 以在用户不活动 30 秒后打开模式。

这是一些具有显示模式弹出窗口的按钮的页面（我假设这是我告诉网站等待不活动的地方）：

```
<body onload="javascript:fg_hideform('fg_formContainer','fg_backgroundpopup');">
<p>
This is an example page showing how to add the popup contact form to your website.
Click on the button below to open the popup.
</p>
<p>
<a href='javascript:fg_popup_form("fg_formContainer", "fg_form_InnerContainer","fg_backgroundpopup");'>
<img border='0' src='contact-us-button.png' width='213' height='39' /></a>
</p> 
```

该页面还包括显示和提交弹出联系表所需的 2 个文件。如果有必要，我将显示这些代码。太感谢了！

注意：我找到了这个插件：[http](http://www.erichynds.com/jquery/a-new-and-improved-jquery-idle-timeout-plugin/) ://www.erichynds.com/jquery/a-new-and-improved-jquery-idle-timeout-plugin/但我不知道如何使用它来保持模态一旦鼠标移动就被禁用。我需要一个用户能够填写联系表格以便提交。

我还尝试使用 stackoverflow 上另一篇文章中的一些 javascript 代码，但我对 javascript 真的很不好，不知道在这里做什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T15:21:04.673

做

```
<script type="text/javascript">
   setTimeout(function() {
     fg_popup_form("fg_formContainer", "fg_form_InnerContainer","fg_backgroundpopup");
   }, 30000);
}
</script> 
```

解决这个问题？

# ckeditor - ckeditor 使对话框元素只读或禁用

> ID：12917918
> 
> 赞同：4
> 
> 时间：2012-10-16T15:15:06.843
> 
> 标签：ckeditor

我需要能够将“链接对话框”窗口中的 URL 输入字段设置为只读或禁用它。当用户从服务器选择文件时，该字段将被填充。

另一位用户将此链接发布为解决方案，[http://docs.cksource.com/ckeditor_api/symbols/CKEDITOR.ui.dialog.uiElement.html#disable](http://docs.cksource.com/ckeditor_api/symbols/CKEDITOR.ui.dialog.uiElement.html#disable) 但没有示例，我无法弄清楚如何实现它.

![链接上传对话框窗口](../Images/10935d1b4c6c1dc89eca848a42e00db7.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T19:52:10.690

在对话框的 onLoad 处理程序中，您可以通过以下方式禁用它：

```
this.getContentElement("info", "url").disable(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-08-02T06:59:14.793

这就是我最终要做的。我把它写在我的 js 文件而不是插件文件中，但我认为这不会有什么不同。我正在使用内联 ckeditor 版本 4.0.2

```
CKEDITOR.on('dialogDefinition', function(event) {
    var dialogName = event.data.name;
    var dialogDefinition = event.data.definition;
    //some code here

    if(dialogName == 'flash'){ // flash dialog box name
        //some code here

        dialogDefinition.onShow = function () {
            this.getContentElement("info","width").disable(); // info is the name of the tab and width is the id of the element inside the tab
            this.getContentElement("info","height").disable();
        }
    }
}); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-07-10T12:10:25.343

您可以仅通过一行禁用 url 字段

```
CKEDITOR.dialog.getCurrent().getContentElement('info','txtUrl').disable() 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-16T15:53:46.257

我得到了它。我添加了 this.getInputElement().setAttribute('readOnly', true); 到 ckeditor\plugins\links\dialogs\link.js 中的 onload 函数。在我将它添加到 ckeditor\_source\plugins\links\dialogs\link.js 之前。我仍然想要一个如何使用 CKEDITOR.ui.dialog.uiElement 禁用功能的示例，如果有人有的话。

# c# - 如何将依赖项注入 ELMAH 自定义错误日志？

> ID：12917919
> 
> 赞同：5
> 
> 时间：2012-10-16T15:15:11.553
> 
> 标签：c#, ninject, elmah

我有一个使用 EF Code-First 上下文来存储错误的 ELMAH 自定义错误日志：-

```
class EntityFrameworkElmahErrorLog
{
    public EntityFrameworkElmahErrorLog(IDictionary config) : this() { }

    public override ErrorLogEntry GetError(string id)
    {
        using (var context = new MyContext())
        {
            var intId = Int64.Parse(id, CultureInfo.InvariantCulture);
            var item = context.ErrorLog.Single(x => x.Id == intId);
            return new ErrorLogEntry(this, id, ErrorXml.DecodeString(item.Details));
        }
    }

    // etc.

} 
```

ErrorLog 连接在 web.config 中：-

```
<errorLog type="MyProject.EntityFrameworkErrorLog, MyProject" /> 
```

我已经在项目的其他地方使用了 Ninject。我想注入`MyContext`以便`ErrorLog`不实例化它自己的依赖项，但我没有运气在文档中找到一个钩子。ELMAH 似乎在`ErrorLog`内部实例化，所以我似乎唯一的选择是`ServiceLocator`在我的 custom 内部使用`ErrorLog`，如果可能的话我想避免。

ELMAH 中是否有更好的钩子可供我用来注入？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-10-19T11:18:59.877

ELMAH 中的服务位置/依赖注入扩展点是`ServiceCenter.Current`您可以为委托提供以下签名的属性：

```
public delegate IServiceProvider ServiceProviderQueryHandler(object context); 
```

ELMAH 将使用`System.IServiceProvider`返回的`ServiceCenter.Current`解决`ErrorLog`实例。

所以你需要做 3 件事来使用 Ninject（或任何 DI 容器）设置它

1.  `System.IServiceProvider`使用 Ninject创建您自己的实现，`IKernel`接口已经从 from 派生`System.IServiceProvider`，所以它完成了。
2.  您需要`EntityFrameworkElmahErrorLog`在您的容器中注册您作为`ErrorLog`实现，因为 ELMAH 将尝试解析`ErrorLog`.
3.  将您的代表提供给`ServiceCenter.Current`

因此，您的方法中需要类似以下内容`RegisterServices`：

```
private static void RegisterServices(IKernel kernel)
{
    kernel.Bind<ErrorLog>().To<EntityFrameworkElmahErrorLog>();
    ServiceCenter.Current = (httpContext) => kernel;
} 
```

注意：在`ServiceProviderQueryHandler`委托中，您可以获得当前`HttpContext`的，并且您可以微调您的权宜之计是如何解决的。

您还应该注意，使用这种方法，您将**无法`ErrorLog`在配置文件中进行配置。**

ELMAH 将始终使用您容器中已解析的实例，因为内置`ServiceContainer`会读取您使用自定义逻辑覆盖的配置文件。

# java - 枚举参数的编译时验证

> ID：12917922
> 
> 赞同：10
> 
> 时间：2012-10-16T15:15:26.780
> 
> 标签：java, validation, enums, compile-time

有一个带有三个枚举类型参数的构造函数：

```
public SomeClass(EnumType1 enum1,EnumType2 enum2, EnumType3 enum3)
{...} 
```

enum 类型的三个参数不允许与所有可能的值组合：

例子：

> EnumType1.VALUE_ONE、EnumType2.VALUE_SIX、EnumType3.VALUE_TWENTY 是有效组合。

但以下组合无效：

> EnumType1.VALUE_TWO、EnumType2.VALUE_SIX、EnumType3.VALUE_FIFTEEN

每个 EnumTypes 都知道它可以与哪些值组合：

EnumType1 和另外两个实现 isAllowedWith() 方法来检查如下：

```
public enum EnumType1 {

VALUE_ONE,VALUE_TWO,...;

    public boolean isAllowedWith(final EnumType2 type) {
    switch (this) {
        case VALUE_ONE:
            return type.equals(Type.VALUE_THREE);
        case VALUE_TWO:
            return true;
        case VALUE_THREE:
            return type.equals(Type.VALUE_EIGHT);
        ...
    }
} 
```

我需要在编译时运行该检查，因为在我的项目中，组合在运行时始终正确是极其重要的。

我想知道是否有可能使用用户定义的注释运行该检查？

每个想法都值得赞赏:)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-16T15:38:57.420

上面的帖子没有带来编译时检查的解决方案，这是我的：

为什么不使用**嵌套** `Enum`的概念。

您将`EnumType1`包含它自己的值 + 一个嵌套的`EnumType2`和这个嵌套的`EnumType3`。

你可以用你有用的组合来组织整体。您最终可能会得到 3 个类（EnumType1、2 和 3），并且每个相关值中的每一个都包含具有允许的关联值的其他值。

你的电话看起来像这样（假设你想`EnumType1.VALUE_ONE`与 关联`EnumType2.VALUE_FIFTEEN`）：

```
EnumType1.VALUE_ONE.VALUE_FIFTEEN  //second value corresponding to EnumType2 
```

因此，您还可以：（ `EnumType3.VALUE_SIX.VALUE_ONE`其中 SIX 由 type3 知道，ONE 由 type1 知道）。

您的电话将更改为：

```
public SomeClass(EnumType1 enumType) 
```

=> 示例：

```
SomeClass(EnumType1.VALUE_ONE.VALUE_SIX.VALUE_TWENTY) //being a valid combination as said 
```

为了更好地澄清它，请查看这篇文章：[在 Java 中使用嵌套枚举类型](https://stackoverflow.com/questions/7296785/using-nested-enum-types-in-java)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-16T15:21:05.390

所以最简单的方法是 1) 定义文档来解释有效的组合和
2) 在构造函数中添加检查

如果构造函数抛出异常，那是调用者的责任。基本上你会做这样的事情：

```
public MyClass(enum foo, enum bar, enum baz)  
{  
    if(!validateCombination(foo,bar,baz))
    {  
        throw new IllegalStateException("Contract violated");
    }  
} 

private boolean validateCombination(enum foo, enum bar, enum baz)  
{  
    //validation logic
} 
```

现在这部分是绝对关键的。将类标记为final，部分构造的对象可能会被恢复并滥用以破坏您的应用程序。对于标记为 final 的类，恶意程序无法扩展部分构造的对象并造成严重破坏。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-16T15:58:30.623

另一种想法是编写一些**自动化测试**来捕捉这一点，并将它们作为打包/部署应用程序之前的强制性步骤连接到您的构建过程中。

如果您考虑一下您要在这里捕获的内容，那是*合法*但*错误*的代码。虽然您可以在编译阶段发现这一点，但这正是测试的目的。

这将符合您不能使用非法组合构建任何代码的要求，因为构建仍然会失败。可以说，其他开发人员比编写自己的注释处理器更容易理解......

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-16T18:04:23.773

我知道的唯一方法是使用注释。

这就是我的意思。现在您的构造函数接受 3 个参数：

`public SomeClass(EnumType1 enum1,EnumType2 enum2, EnumType3 enum3){}`

所以你这样称呼它：

`SomeClass obj = new SomeClass(EnumTupe1.VALUE1, EnumTupe2.VALUE2, EnumTupe1.VALUE3)`

将构造函数更改为私有。创建接受 1 个您想要的任何类型的参数的公共构造函数。它可能只是一个假参数。

`public SomeClass(Placeholder p)`

现在，您必须要求在每个参数都使用特殊注释进行注释时调用此构造函数。让我们称之为`TypeAnnotation`：

```
SomeClass obj = new SomeClass(TypeAnnotation(
    type1=EnumType1.VALUE1, 
    type2=EnumTupe2.VALUE2,
    type3=EnumTupe1.VALUE3)
    p3); 
```

该调用更冗长，但这是我们必须为编译时验证支付的费用。

现在，如何定义注解？

@Documented @Retention({RetentionPolicy.RUNTIME, RetentionPolicy.SOURCE}) @Target(PARAMETER) @interface TypeAnnotation { EnumType1 type1(); EnumType2 type3(); 枚举类型3 type3(); }

请注意，target 是 PARAMETER，保留值是 RUNTIME 和 SOURCE。

*RUNTIME 允许在运行时读取此注解，而 SOURCE 允许创建可以在运行时验证参数的注解处理器。*

现在公共构造函数将调用 3 参数私有构造函数：

public SomeClass(Placeholder p) { this(readAnnotation(EnumType1.class), readAnnotation(EnumType2.class), readAnnotation(EnumType3.class), ) }

我没有`readAnnotation()`在这里实现：它应该是获取堆栈跟踪、返回 3 个元素（到公共 costructor 的调用者）并解析 annotation 的静态方法`TypeAnnotation`。

现在是最有趣的部分。您必须实现注释处理器。看看[这里](http://docs.oracle.com/javase/1.5.0/docs/guide/apt/GettingStarted.html)的说明和[这里](http://code.google.com/p/spi/)的注释处理器的例子。

您必须将此注释处理器的使用添加到您的构建脚本和（可选）到您的 IDE。在这种情况下，当您的兼容性规则被违反时，您将得到真正的编译错误。

我相信这个解决方案看起来太复杂了，但如果你真的需要这个，你可以这样做。可能需要一天左右的时间。祝你好运。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-16T15:23:14.353

好吧，我不知道编译时检查，但我认为这是不可能的，因为编译器如何知道哪个值将传递给构造函数（如果您的枚举变量的值是在运行时计算的（例如，通过If 子句) ? 这只能在运行时通过使用为枚举类型实现的验证器方法来验证。

例子 ：

如果在你的代码中你有这样的东西：

```
EnumType1 enumVal;

if (<some condition>) {
  enumVal = EnumType2.VALUE_SIX;
} else {
  enumVal = EnumType2.VALUE_ONE;
} 
```

编译器无法知道哪些值将分配给 enumVal，因此在评估 if 块之前它无法验证传递给构造函数的内容（只能在运行时完成）

# matlab - 单元格数组中所有元素的长度向量？

> ID：12917923
> 
> 赞同：2
> 
> 时间：2012-10-16T15:15:28.603
> 
> 标签：matlab, octave, vectorization

我有一个包含矩阵的单元格数组。我想获得单元格数组中每个元素长度的一维行向量。例子：

```
a = {[1, 2], [1, 8], [5, 2, 4]};
% b = ...?
b == [ 2, 2, 3 ] 
```

这可能不使用 for 循环吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-16T15:17:54.953

[`cellfun`](http://www.mathworks.com/help/matlab/ref/cellfun.html)是你的朋友。

```
b = cellfun( @numel, a ); 
```

# jquery - 将 DOM 元素转换为图像：单词转换为破折号（jQuery、HTML5、SVG）

> ID：12917925
> 
> 赞同：2
> 
> 时间：2012-10-16T15:15:31.733
> 
> 标签：jquery, image, html, canvas, svg

我有一个关于将 HTML 转换为图像的过程的问题。

[我一直在使用类似于此处](https://developer.mozilla.org/en-US/docs/HTML/Canvas/Drawing_DOM_objects_into_a_canvas)找到的代码片段的代码。

一切似乎都很好，除了我得到的图像将**一些**单词变成了破折号。因此，页面上可能会显示“提交”的内容现在会在图像中显示“-”。同样，可能会说“有建议吗？” 页面上的图像现在会显示“---”。否则，所有比例、格式和颜色都是正确的。我只是对某些文本有问题。我在 textarea 标签内的文本没有问题。

```
function createImage() {

    var canvas = $('<canvas/>');
    var ctx = canvas[0].getContext("2d");
    var data = "<svg xmlns='http://www.w3.org/2000/svg' width='1000' height='1000'>" +
                 "<foreignObject width='100%' height='100%'>" +
                   "<div xmlns='http://www.w3.org/1999/xhtml'>" +
                     $("body").html() +
                   "</div>" +
                 "</foreignObject>" +
               "</svg>";
    var DOMURL = self.URL || self.webkitURL || self;
    var img = new Image();
    var svg = new Blob([data], { type: "image/svg+xml;charset=utf-8" });
    var url = DOMURL.createObjectURL(svg);
    img.onload = function () {
        ctx.drawImage(img, 0, 0);
        DOMURL.revokeObjectURL(url);
    };
    img.src = url;
    return img;
} 
```

有没有人有任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-18T16:49:55.687

我不得不将字体大小从百分比更改为像素。字体大小：100%；我必须将其设置为字体大小：34px。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-16T15:19:26.413

可能在渲染的图形中，文本标签太小而无法容纳单词。这可能取决于画布如何解释缩放和字体大小？但这只是一个猜测。

# math - 计算单词之间的相关系数？

> ID：12917928
> 
> 赞同：4
> 
> 时间：2012-10-16T15:15:35.790
> 
> 标签：math, statistics, correlation, text-analysis

对于文本分析程序，我想分析文本中某些单词的共现。例如，我希望看到“Barack”和“Obama”这两个词比其他词更频繁地一起出现（即具有正相关性）。

这似乎并不难。但是，老实说，我只知道如何计算两个数字之间的相关性，而不知道如何计算文本中两个单词之间的相关性。

1.  我怎样才能最好地解决这个问题？
2.  如何计算单词之间的相关性？

*我想到了使用条件概率，因为例如巴拉克奥巴马比奥巴马巴拉克更有可能；然而，我试图解决的问题更为根本，并且不依赖于单词的顺序*

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-17T10:52:29.003

[Ngram Statistics Package (NSP)](http://ngram.sourceforge.net/)正是专门用于这项任务的。他们在[网上有一篇论文](http://www.d.umn.edu/~tpederse/Pubs/cicling2003-2.pdf)，描述了他们使用的关联度量。我自己没有使用过这个包，所以我不能评论它的可靠性/要求。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-16T15:24:17.883

解决您的问题的一种简单方法是将数据整形为 2x2 矩阵

```
 obama | not obama
barack      A       B
not barack  C       D 
```

并对矩阵中所有出现的二元词进行评分。这样你就可以使用简单的卡方。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-17T01:25:26.403

我不知道这通常是如何做到的，但我可以想出一种粗略的方法来定义捕获单词邻接的相关概念。

假设文本的长度为 N，假设它是一个数组

```
text[0], text[1], ..., text[N-1] 
```

假设文本中出现以下单词

```
word[0], word[1], ..., word[k] 
```

对于每个单词 word[i]，定义一个长度为 N-1 的向量

```
X[i] = array(); // of  length N-1 
```

如下：如果单词是第 i 个单词或第 (i+1) 个单词，则向量的第 i 个条目为 1，否则为零。

```
// compute the vector X[i]
for (j = 0:N-2){
  if (text[j] == word[i] OR text[j+1] == word[i])
    X[i][j] = 1;
  else
    X[i][j] = 0;
} 
```

然后你可以计算 word[a] 和 word[b] 之间的相关系数作为 X[a] 和 X[b] 之间的点积（注意点积是这些单词相邻的次数）除以长度（长度是单词出现次数的平方根，可能是两倍）。将此量称为 COR(X[a],X[b])。显然 COR(X[a],X[a]) = 1，如果 word[a], word[b] 通常相邻，则 COR(X[a],X[b]) 更大。

这可以从“相邻”推广到其他近的概念——例如，我们可以选择使用 3 个单词（或 4、5 等）块来代替。还可以添加权重，如果需要，还可以做更多的事情。如果其中任何一种有用的话，人们必须进行试验才能看到有用的东西。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-17T20:13:35.817

这个问题听起来像是一个二元组，一个更大的文本正文中的两个“标记”序列。请参阅[此 Wikipedia entry](http://en.wikipedia.org/wiki/Bigram)，其中包含指向更一般的 n-gram 问题的附加链接。

如果您想进行全面分析，您很可能会采用任何给定的单词对并进行频率分析。例如，“巴拉克奥巴马是民主党总统候选人”这句话有 8 个单词，所以有 8 个选择 2 = 28 个可能的配对。

然后你可以问一些统计问题，比如“‘奥巴马’跟在‘巴拉克’后面有多少对，其他词（不是‘奥巴马’）跟在‘巴拉克’后面有多少对？在这种情况下，有 7 对其中包括“巴拉克”，但只有其中一个与“奥巴马”配对。

对每个可能的词对都做同样的事情（例如，“有多少对‘候选人’跟在‘the’后面？”），你就有了比较的基础。

# windows-8 - 本机电子邮件客户端可以用作共享目标吗？

> ID：12917934
> 
> 赞同：0
> 
> 时间：2012-10-16T15:15:51.530
> 
> 标签：windows-8, microsoft-metro, share, email

Windows 8 的内置电子邮件客户端是否用作共享目标，如果是，它是否会发送以这种方式发送的电子邮件（以编程方式与其共享）而无需用户直接干预？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T15:23:19.407

是的，它是一个共享目标，不，您不能在没有用户干预的情况下使用它来发送邮件——这不是共享目标的设计工作方式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-16T15:25:51.840

让我们看看我是否可以解密你的问题。

**是**的：预装在 Windows 8 上的电子邮件客户端（“本机”客户端）是共享目标，是的。它是开箱即用的 PlainText 和 HtmlText 共享目标。您需要做的就是从您的应用程序中分享出去，Mail 就会成为列表中的潜在目标。

结果，整个邮件操作由邮件应用程序处理。你不能自动化它。你也不能打断它。一旦你分享出去，目标应用程序就会随心所欲地处理有效载荷。

如果您想自动化电子邮件发送操作，您需要一项服务来帮助您完成此操作。如果您想在客户端处理它，请阅读： http: [//mikaelkoskinen.net/post/windows8-metro-app-winrt-send-email-emailcomposetask.aspx](http://mikaelkoskinen.net/post/windows8-metro-app-winrt-send-email-emailcomposetask.aspx)

**注意**：您应该注意，操作系统代理了共享操作中的所有交互。这意味着您无法从您的应用程序访问共享目标，并且共享目标无法返回您的应用程序。您最好知道用户选择了哪个目标应用程序。

*   参考[http://msdn.microsoft.com/en-US/library/windows/apps/windows.applicationmodel.datatransfer.datatransfermanager.targetapplicationchosen](http://msdn.microsoft.com/en-US/library/windows/apps/windows.applicationmodel.datatransfer.datatransfermanager.targetapplicationchosen)

# linux - GDB 如何知道函数的长度？

> ID：12917935
> 
> 赞同：1
> 
> 时间：2012-10-16T15:15:51.787
> 
> 标签：linux, gdb, elf

GDB 采用什么方法来确定函数的长度？我注意到，在我从 main() GDB 中删除两个字节后，我认为该函数仍然是原始长度，所以我假设它正在使用一些调试信息？

特别是 main() 的结尾原本是：

```
0x00000000004005a1 <+133>:   mov    edi,0x4006ac
0x00000000004005a6 <+138>:   call   0x4003a0 <puts@plt>
0x00000000004005ab <+143>:   mov    eax,0x0
0x00000000004005b0 <+148>:   leave  
0x00000000004005b1 <+149>:   ret 
```

然后在我删除了两个字节之后（在程序列表的前面）：

```
0x000000000040059f <+131>:   mov    edi,0x4006ac
0x00000000004005a4 <+136>:   call   0x40039e
0x00000000004005a9 <+141>:   mov    eax,0x0
0x00000000004005ae <+146>:   leave  
0x00000000004005af <+147>:   ret    
0x00000000004005b0 <+148>:   nop
0x00000000004005b1 <+149>:   nop 
```

即 GDB 认为总长度仍然相同。我想知道 GDB 是如何做到这一点的。

该文件为以下类型： a.out：ELF 64 位 LSB 可执行文件，x86-64，版本 1 (SYSV)，动态链接（使用共享库），未剥离 仅使用“gcc”创建，不给定参数。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-16T15:20:49.783

> GDB 采用什么方法来确定函数的长度？

它在`ELF`符号表（`.st_size`成员）中查找。你可以看到它`readelf -s a.out | grep main`

# jenkins - 将数据输入到詹金斯触发的构建中

> ID：12917937
> 
> 赞同：0
> 
> 时间：2012-10-16T15:15:54.433
> 
> 标签：jenkins, hudson, build-automation

我有一个 Jenkins 构建，它可以通过调度、用户请求或作为其他构建的构建步骤来触发。如果这个构建被作为另一个构建的一部分调用，它需要保存一些信息以供更大的构建使用。我想通过写入文件来传递这些信息。唯一的问题是让构建同意写入的位置。

一种方法是将其写入众所周知的位置，但这不允许并行运行多个构建，因为一个会破坏另一个。

另一种方法是向构建添加构建参数，其他构建将使用要写入的文件位置填充该构建参数。对我来说，这似乎有点像 hack，因为这意味着无论何时运行构建，都需要传入一个参数，即使它只是从默认值开始。

我考虑的最后一种方法是让父构建在构建中设置一个环境变量，让子构建检查变量的存在和内容并采取适当的行动。不幸的是，我找不到在 Jenkins 中进行设置的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-20T13:56:05.430

在我看来，后期构建中的存档工件和[复制工件插件](https://wiki.jenkins-ci.org/display/JENKINS/Copy+Artifact+Plugin "复制工件插件")的组合可以完成这项工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T15:43:43.633

听起来您需要[Parameterized Trigger Plugin](https://wiki.jenkins-ci.org/display/JENKINS/Parameterized+Trigger+Plugin)。

# java - 为什么 Casbah / Java MongoDB 驱动程序会出现 java.lang.IllegalArgumentException？

> ID：12917943
> 
> 赞同：41
> 
> 时间：2012-10-16T15:16:10.803
> 
> 标签：java, mongodb, mongodb-java, casbah

我看到一个奇怪的问题使用`casbah / java driver.`

当驱动程序尝试从 mongo 创建响应时，我不断遇到以下异常：

```
 Oct 16, 2012 10:45:07 AM com.mongodb.DBTCPConnector$MyPort error
  SEVERE: MyPort.error called
  java.lang.IllegalArgumentException: response too long: 1634610484
    at com.mongodb.Response.(Response.java:40)
    at com.mongodb.DBPort.go(DBPort.java:110)
    at com.mongodb.DBPort.go(DBPort.java:75)
    at com.mongodb.DBPort.call(DBPort.java:65)
    at com.mongodb.DBTCPConnector.call(DBTCPConnector.java:201)
    at com.mongodb.DBApiLayer$MyCollection.__find(DBApiLayer.java:295)
    at com.mongodb.DBCursor._check(DBCursor.java:354)
    at com.mongodb.DBCursor._hasNext(DBCursor.java:484)
    at com.mongodb.DBCursor.hasNext(DBCursor.java:509)
    at com.mongodb.casbah.MongoCursorBase$class.hasNext(MongoCursor.scala:73)
    at com.mongodb.casbah.MongoCursor.hasNext(MongoCursor.scala:497)
    at scala.collection.Iterator$class.foreach(Iterator.scala:660)
    at com.mongodb.casbah.MongoCursor.foreach(MongoCursor.scala:497)
        ... 
```

这似乎是随机发生的，即使在 mongo 不应该从查询中返回任何结果的情况下也是如此。报告的大小不一致，通常比它应该或可能的大得多。

我猜这可能是响应的某种形式的腐败。我很难使用 Wireshark 解决这个问题的正面或反面，但我始终发现，导致引发此错误的查询的请求/响应链具有来自 MongoDB 的“TCP Window Full”响应：

![在此处输入图像描述](../Images/5c6a3d7255dd4242b31e41edacd5cedd.png)

我正在使用的版本：

```
 Casbah: 2.1.5.0
 Mongo Java Driver: 2.5.3
 MongoDB: 2.2 
```

如果有人可以就我可能做错的事情或有关如何进一步调试此问题的任何指示提供任何建议，我将不胜感激

**更新：**查看发行说明后，`Casbah 2.1.5.0,`使用的 java 驱动程序的版本似乎是 2.5.3，而不是 2.7.3

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-05T08:48:03.513

您使用的 Java 驱动程序版本与 MongoDB 2.2 不兼容。如果不是 2.10 或更高版本，您应该至少使用 2.9.3。无法保证驱动程序升级会解决您的问题，但这应该是第一步。

[https://support.mongolab.com/entries/22631012-which-drivers-support-mongodb-2-2](https://support.mongolab.com/entries/22631012-which-drivers-support-mongodb-2-2)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-01T07:28:37.707

你的 JSON 对象有多大？查看mongodb版本是否支持那个大对象。

# c# - 大文件：在外部 HD 上时无法读取

> ID：12917944
> 
> 赞同：3
> 
> 时间：2012-10-16T15:16:10.360
> 
> 标签：c#, io, filestream, hard-drive

我有这个简单的代码：

```
using(FileStream fs = new FileStream(@"E:\test.bin", FileMode.Open, FileAccess.Read, FileShare.Read)
{
    byte[] bytes = new byte[100];
    int n = fileStream.Read(bytes, 0, bytes.Length);
} 
```

这通常按预期工作，返回文件开头的字节数组。

令人难以置信的是，当我尝试读取位于通过 USB 连接的外部 HD 上的一个相当大的文件 (~7GB) 时，返回数组中的字节全为零 *，* n 为 100。

如果我尝试使用相同类型但更小的文件，一切正常。如果我在另一个外部 HD 上尝试相同的大文件，那么一切都很好。更令人难以置信的是，**如果我尝试相同的大文件并使用相同的外部 HD，这会给我带来问题，但通过 eSATA 连接一切正常**！

两个 HD 都是 NTFS，并且在有问题的 HD 上描述的行为不是 100% 稳定的：有时 7GB 左右的文件不会被读取，有时它们会；永远不会读取大约 10GB 的文件。

关于什么可能导致这种情况以及如何解决它的任何想法？

* * *

编辑：我已经尝试读取 1GB 的数据，但没有任何变化。但这里还有其他提示：如果文件太大，读取 1GB 字节的时间太短而无法真正读取；此外，如果我等待 HD 进入待机模式并且如果我尝试从小文件中读取 1GB，则 HD 退出待机，读取需要时间并成功，而如果我尝试使用大文件，则 HD 不会退出睡眠模式，读取需要几毫秒，并且再次全为零。

如果我用一些值初始化字节数组，这些值会在“假”读取后被擦除，并且我再次全为 0。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T16:44:19.327

鉴于相同的代码在某些驱动器上运行良好，并且您无法控制驱动器如何通过 USB 或其他方式工作，我想这只是一个硬件问题。尝试在另一台计算机上使用相同的驱动器运行程序。

# wordpress - Wordpress：从自定义添加的链接中删除类

> ID：12917950
> 
> 赞同：0
> 
> 时间：2012-10-16T15:16:25.173
> 
> 标签：wordpress

我想知道是否有任何方法可以仅从自定义链接中删除类？至少，我想从我的自定义链接“current-menu-ancestor current-menu-parent”中删除这些类，而不是从动态链接中删除。

我正在使用这段代码：

```
add_filter('nav_menu_css_class', 'my_css_attributes_filter', 100, 1);
add_filter('nav_menu_item_id', 'my_css_attributes_filter', 100, 1);
add_filter('page_css_class', 'my_css_attributes_filter', 100, 1);
function my_css_attributes_filter($var) {
    return is_array($var) ? array_intersect($var, array('current-menu-ancestor current-menu-parent')) : '';
} 
```

它正在从所有静态和动态链接中删除 css 类。我只想从自定义链接中删除 css 类。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T15:45:13.587

您可以检查链接是否包含`menu-item-object-custom`该类，并使用结果有选择地过滤 CSS 类：

```
add_filter('nav_menu_css_class', 'my_css_attributes_filter', 100, 1);
add_filter('nav_menu_item_id', 'my_css_attributes_filter', 100, 1);
add_filter('page_css_class', 'my_css_attributes_filter', 100, 1);
function my_css_attributes_filter($classes) {
    // if this is not a custom link and not the home page, return the $classes intact, otherwise filter $classes 
    return is_array($classes) ? 
        (in_array("menu-item-object-custom", $classes) || is_front_page())? 
            array_diff($classes, array('current-menu-ancestor current-menu-parent'))
            : $classes // not a custom link
        : ''; // not an array
} 
```

# linux - 监控系统调用的内核模块？

> ID：12917960
> 
> 赞同：10
> 
> 时间：2012-10-16T15:17:04.017
> 
> 标签：linux, module, kernel

我想从头开始创建一个内核模块，该模块锁定到用户会话并监视属于该用户的进程所做的每个系统调用。

我知道每个人都在想什么——“使用 strace”——但我想对我收集的数据进行一些我自己的日志记录和分析，而 strace 有一些问题——应用程序可以使用“mmap”写入文件没有文件内容作为“打开”系统调用的参数出现，或者没有任何写入权限的应用程序可能会创建核心转储来复制敏感数据。

我希望能够处理这些特殊情况并做一些我自己的日志记录。不过我想知道 - 我怎样才能通过我的模块路由所有系统调用？有没有办法在不触及内核代码的情况下做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-16T15:24:38.567

我对你的问题没有确切的答案，但我几天前写了一篇论文，它可能对你有用：

[http://www.cse.iitk.ac.in/users/moona/students/Y2157230.pdf/](http://www.cse.iitk.ac.in/users/moona/students/Y2157230.pdf/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-16T15:49:51.887

过去，我通过使用内核模块修补系统调用表来做过类似的事情。每个修补后的函数都执行如下操作：

```
patchFunction(/*params*/)
{
   // pre checks
   ret = origFunction(/*params*/);
   // post checks
   return ret;
} 
```

请注意，当您开始处理内核数据结构时，您的模块将变得依赖于版本。内核模块可能必须针对您正在安装的特定内核版本进行编译。

另请注意，这是许多 rootkit 采用的一种技术，因此如果您安装了安全软件，它可能会试图阻止您执行此类操作。

# android - 带有自定义适配器的微调器不会在选择时消失

> ID：12917963
> 
> 赞同：3
> 
> 时间：2012-10-16T15:17:09.540
> 
> 标签：android, android-widget, android-spinner

我正在使用一个`Spinner`名为的自定义适配器类`AlgorithmAdapter`，原则上一切正常，这意味着微调器弹出窗口出现并且所有包含的视图都正确膨胀。但是，我无法找到的是在做出选择时我如何“告诉”微调器。我当然知道`setSelection()`，但这不会处理弹出窗口并将焦点返回到 Activity。

所以这里有一些相关的代码：

在我的活动中，我像这样创建我的适配器：

```
SpinnerAdapter spinnerAdapter = new AlgorithmAdapter(
    this,
    algorithmSpinner,
    R.layout.algo_spinner_item_detail,
    res.getStringArray(R.array.anaglyph_algorithm_titles),
    res.getStringArray(R.array.anaglyph_algorithm_descriptions),
    res.obtainTypedArray(R.array.anaglyph_algorithm_icons),
    algorithmSpinner.getSelectedItemPosition()
);

algorithmSpinner.setAdapter(spinnerAdapter); 
```

的构造函数`AgorithmAdapter`具有以下签名：

```
public AlgorithmAdapter(Context context, Spinner spinner, int viewResourceId, String[] titles,
        String[] descriptions, TypedArray icons, int selectedPosition) { 
```

的`getDropDownView()`方法`AlgorithmAdapter`：

```
@Override
public View getDropDownView(final int position, View convertView, ViewGroup parent) {
    if(convertView == null) {
        LayoutInflater inflater = LayoutInflater.from(context);
        convertView = inflater.inflate(viewResourceId, parent, false);
    }

    final ImageView icon = (ImageView) convertView.findViewById(R.id.algoItemIcon);
    final TextView title = (TextView) convertView.findViewById(R.id.algoItemTitle);
    final TextView description = (TextView) convertView.findViewById(R.id.algoItemDescription);
    final RadioButton radio = (RadioButton) convertView.findViewById(R.id.algoItemRadio);

    icon.setImageDrawable(icons.getDrawable(position));
    title.setText(titles[position]);
    description.setText(descriptions[position]);
    radioGroup.add(radio);

    /* it's essential to uncheck in case the positions do not match, because
     * the system reuses views that could still have a checked radio button */
    radio.setChecked(position == selectedPosition);

    convertView.setOnClickListener(new OnClickListener() {

        @Override
        public void onClick(View view) {
            // uncheck every other radio button
            for(RadioButton each : radioGroup)
                each.setChecked(false);

            // inform adapter and user that this button is selected now
            radio.setChecked(true);
            selectedPosition = position;

            spinner.setSelection(position);
        }

    });

    return convertView;
} 
```

where`radioGroup`是所有下拉视图中所有 RadioButtons 的列表，以便管理当前选中的单选按钮以及必须取消选中的单选按钮。

`setSelection()`除了弹出窗口没有关闭（虽然它本身正在工作）之外，这一切都很好。

我还尝试将一个附加`OnItemClickListener`到 Spinner 并管理其中的选择内容，但这会引发一个异常说`setOnItemClickListener cannot be used with a spinner`，这真的很烦人，因为感觉好像框架挡住了我的路，而不是在这一点上帮助我。但无论如何，这就是我必须将 Spinner 传递给适配器的原因，我很高兴我有不同的解决方案……</p>

所以我唯一缺少的是我如何“关闭”或“处置” Spinners 下拉菜单。有人可以帮我吗？这甚至是接近它的方式吗？这不会那么困难，因为为 Spinners 编写自定义适配器是一项非常基本的任务。

编辑：不知道这是否有帮助，但也许有人在我的下拉视图项的布局文件中发现错误。`algo_spinner_item_detail.xml`：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:padding="10dp"
    android:background="@android:drawable/list_selector_background" >

    <ImageView
        android:id="@+id/algoItemIcon"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentTop="true"
        android:layout_alignParentLeft="true"
        android:contentDescription="@string/algoIconDescription"
        android:layout_marginRight="8dp" />

    <RadioButton
        android:id="@+id/algoItemRadio"
        android:layout_width="wrap_content"
        android:layout_height="match_parent"
        android:layout_alignParentRight="true"
        android:layout_marginLeft="10dp"
        android:layout_centerVertical="false" />

    <TextView
        android:id="@+id/algoItemTitle"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_toRightOf="@id/algoItemIcon"
        android:layout_alignTop="@id/algoItemIcon"
        android:textStyle="bold"
        android:layout_marginBottom="1dp" />

    <TextView
        android:id="@+id/algoItemDescription"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_below="@id/algoItemTitle"
        android:layout_alignLeft="@id/algoItemTitle"
        android:layout_toLeftOf="@id/algoItemRadio" />

</RelativeLayout> 
```

选择一个项目后，你到底是如何关闭/处理 f***ing Spinner 下拉菜单的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T13:54:46.953

这就是我的诀窍（警告：不要向你的孩子展示这段代码，你肯定会为此下地狱）：

在我的`onClick`方法中，我`convertView`放了这行代码：

```
((View) parent.getParent().getParent().getParent().getParent()).setVisibility(View.GONE); 
```

这不仅摆脱了`convertView`包含 s 的 LinearLayout ，而且还使`com.android.internal.policy.impl.PhoneWindow$DecorView`不可见的东西在显示对话框/下拉菜单时使 Activity 屏幕变暗。

我仍在寻求更好的解决方案。

# regex - 从 HTML 中删除 alt 属性

> ID：12917967
> 
> 赞同：0
> 
> 时间：2012-10-16T15:17:15.890
> 
> 标签：regex, replace

我有一个巨大的 HTML 文件，我正在尝试对其进行格式化，以便能够将内容导入到不同的应用程序中。剩下的一件事是我需要从 HTML 中完全删除所有 alt 属性。它们都有不同的值，大约有 5000 个，因此显然不能直接查找和替换。也许有一种方法可以在 Visual Web 开发人员中查找和替换正则表达式？

我可用的工具/技能是：HTML、Javascript、ASP（经典）、一点点 .NET、Visual Web Developer Express 2010，但我能找到的唯一类似的东西是基于 PHP 的，它们没有完全解释足以让我建立一个解决方案并将 HTML 提供给它。

我发现了这样的东西：[Regular expression to replace several html attributes](https://stackoverflow.com/questions/4612779/regular-expression-to-replace-several-html-attributes)，它给出了做类似事情的正则表达式函数的建议，但我什至不确定如何在一个直接的 HTML 文件上运行正则表达式函数（我的浏览器正在苦苦挣扎与 HTML 文件的大小一样，所以我不认为 javascript 会削减它）。

任何人都可以提出最好的方法来实现这一点吗？

谢谢各位...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T15:25:06.730

由于您使用 Visual Studio，因此您可以尝试使用 Regex 搜索和替换选项，尽管 Visual Studio 中的正则表达式的实现与其他正则表达式引擎有很大不同。

这是一篇关于它的简短文章：http: [//www.codinghorror.com/blog/2006/07/the-visual-studio-ide-and-regular-expressions.html](http://www.codinghorror.com/blog/2006/07/the-visual-studio-ide-and-regular-expressions.html)

正如文章中所说，内置的正则表达式引擎并不理想。他们提到了一个实现标准正则表达式的插件：http: [//www.codeproject.com/Articles/9125/Standard-Regular-Expression-Searcher-Addin-For-VS](http://www.codeproject.com/Articles/9125/Standard-Regular-Expression-Searcher-Addin-For-VS)

# jquery - jQuery 插件 Fullcalendar 当前时间显示

> ID：12917971
> 
> 赞同：0
> 
> 时间：2012-10-16T15:17:29.557
> 
> 标签：jquery, asp.net, fullcalendar

我已阅读并在此线程中添加了一个问题[http://code.google.com/p/fullcalendar/issues/detail?id=143](http://code.google.com/p/fullcalendar/issues/detail?id=143)但它有点旧，所以我在这里问。

我已按照线程的反馈，但我无法让我的脚本显示 Fullcalendar 的当前时间，所有其他事情都工作正常，它的显示事件等等，但我无法让它显示当前周/日视图中的时间，这里有人知道这方面的知识吗！？

我的代码是：

```
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
<title></title>
<link href="http://ajax.aspnetcdn.com/ajax/jquery.ui/1.8.9/themes/redmond/jquery-ui.css" rel="stylesheet" type="text/css" />
<link href="css/fullcalendar.css" rel="stylesheet" />
<link href="css/FCstyle.css" rel="stylesheet" />
<script src="js/jquery-1.8.2.min.js"></script>
<script src="js/jquery-ui-1.9.0.js"></script>
<script src="js/fullcalendar.min.js"></script>
<script type="text/javascript">
    $(document).ready(function () {
        var date = new Date();
        var d = date.getDate();
        var m = date.getMonth();
        var y = date.getFullYear();

        $('#calendar').fullCalendar({
            theme: true,
            header: { left: "today prev,next", center: "title", right: "month,agendaWeek,agendaDay" }, weekends: true, allDayDefault: true, ignoreTimezone: true, lazyFetching: true,
            startParam: "start", endParam: "end", titleFormat: { month: "MMMM yyyy", week: "MMM d[ yyyy]{ '&#8212;'[ MMM] d yyyy}", day: "dddd, MMM d, yyyy" },
            columnFormat: { month: "ddd", week: "ddd dd-MM", day: "dddd dd-MM" },
            // To change display time HH:mm
            // timeFormat: { '': 'HH:mm' }, isRTL: false,
            // To change first display date as monday
            firstDay: 1,
            monthNames: ["Januar", "Februar", "Marts", "April", "Maj", "Juni", "Juli", "August", "September", "Oktober", "November", "December"],
            monthNamesShort: ["Jan", "Feb", "Mar", "Apr", "Maj", "Jun", "Jul", "Aug", "Sep", "Okt", "Nov", "Dec"],
            dayNames: ["Søndag", "Mandag", "Tirsdag", "Onsdag", "Torsdag", "Fredag", "Lørdag"],
            dayNamesShort: ["Søn", "Man", "Tir", "Ons", "Tor", "Fre", "Lør"], buttonText: {
                prev: "&nbsp;&#9668;&nbsp;", next: "&nbsp;&#9658;&nbsp;",
                prevYear: "&nbsp;&lt;&lt;&nbsp;", nextYear: "&nbsp;&gt;&gt;&nbsp;",
                today: "i dag", month: "måned", week: "uge", day: "dag"
            },
            allDayDefualt: false,
            allDaySlot: true, allDayText: "hele dagen", firstHour: 7, slotMinutes: 30, defaultEventMinutes: 120,
            axisFormat: 'H:mm',
            timeFormat: 'HH:mm{-HH:mm}',
            //timeFormat: { agenda: 'H:mm{ - HH:mm}' }, dragOpacity: { agenda: 0.5 }, minTime: 0,
            maxTime: 24,
            editable: true,
            disableDragging: true,
            disableResizing: true,
            droppable: true,
            drop: function (date, allDay, jsEvent, ui) {
                console.log(jsEvent);
                console.log(ui);
            },

            // Is used for current time START
            viewDisplay: function(view) {
                window.clearInterval(timelineInterval);
                timelineInterval = window.setInterval(setTimeline, 10000);
                try {
                    setTimeline();
                } catch(err) { }
            },
            // Is used for current time END

            // add event name to title attribute on mouseover
            eventMouseover: function (event, jsEvent, view) {
                if (view.name == "month") {
                    $(jsEvent.target).attr('title', event.title);
                }
                //alert(event.id);
            },

            events: {
                url: 'fullcalendarjson.ashx',
                type: 'POST',
                error: function () {
                    alert('there was an error while fetching events!');
                }
            },

            selectable: true,
            selectHelper: true,
            select: function (start, end, allDay) {
                alert("Cell selected from " + $.fullCalendar.formatDate(start, 'dd-MM-yyyy') + " to " + $.fullCalendar.formatDate(end, 'dd-MM-yyyy'));
            },
            eventClick: function (calEvent, jsEvent, view) {
                if (!$(jsEvent.target).hasClass("icon")) {
                    alert("UserID:" + calEvent.id);
                }
            }

        });

        // Is used for Current Time START
        function setTimeline() {
            var curTime = new Date();
            if (curTime.getHours() == 0 && curTime.getMinutes() <= 5) // Because I am calling this function every 5 minutes
            {// the day has changed
                var todayElem = $(".fc-today");
                todayElem.removeClass("fc-today");
                todayElem.removeClass("fc-state-highlight");

                todayElem.next().addClass("fc-today");
                todayElem.next().addClass("fc-state-highlight");
            }

            var parentDiv = $(".fc-agenda-slots:visible").parent();
            var timeline = parentDiv.children(".timeline");
            if (timeline.length == 0) { //if timeline isn't there, add it
                timeline = $("<hr>").addClass("timeline");
                parentDiv.prepend(timeline);
            }

            var curCalView = calendar.fullCalendar("getView");
            if (curCalView.visStart < curTime && curCalView.visEnd > curTime) {
                timeline.show();
            } else {
                timeline.hide();
            }

            var curSeconds = (curTime.getHours() * 60 * 60) + (curTime.getMinutes() * 60) + curTime.getSeconds();
            var percentOfDay = curSeconds / 86400; //24 * 60 * 60 = 86400, # of seconds in a day
            var topLoc = Math.floor(parentDiv.height() * percentOfDay);

            timeline.css("top", topLoc + "px");

            if (curCalView.name == "agendaWeek") { //week view, don't want the timeline to go the whole way across
                var dayCol = $(".fc-today:visible");
                if (dayCol.position() != null) {
                    var left = dayCol.position().left + 1;
                    var width = dayCol.width();
                    timeline.css({
                        left: left + "px",
                        width: width + "px"
                    });
                }
            }
        }
        // Is used for Current Time END

    });
</script>
<style type="text/css">
    /* Is used for Current Time CSS*/
    .timeline {
            position: absolute;
            left: 59px;
            border: none;
            border-top: 1px solid red;
            width: 100%;
            margin: 0;
            padding: 0;
            z-index: 999;
    }
</style>
</head>
<body>
<form id="form1" runat="server">
    <div id="calendar"></div>
</form>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T07:39:46.807

两件事情

像这样调用你的日历......

```
var calendar = $("#calendar").fullCalendar({}); 
```

和另一个...

在 viewDisplay 开始时像这样启动变量timelineInterval

```
var timelineInterval = 0; 
```

那应该可以解决您的问题。

# c++ - 关于静态模板库的链接/编译时间

> ID：12917972
> 
> 赞同：5
> 
> 时间：2012-10-16T15:17:46.163
> 
> 标签：c++, templates, header, compilation-time, explicit-instantiation

对于基于模板的类（STL 和 boost），不使用源文件并将实现也放入头文件似乎是一种常见的约定。我认为与头文件和源文件中声明和实现之间的经典分离相比，这将大大增加编译包含头文件的源文件所需的时间。[这样做的原因可能是因为您必须在源文件中告诉编译器要使用哪些模板，这可能会导致 .a 文件膨胀。](https://stackoverflow.com/a/8752879/1392142)

假设随着库的增长，链接器也需要更多时间，那么就编译包含库头的源文件所需的时间而言，哪种方法会更快？

1.不使用.cpp文件，把整个类，包括实现，放到头文件中

```
//foo.hpp
template <class T>
class Foo
{
public:
    Foo(){};
    T bar()
    {
        T* t = NULL;
        //do stuff
        return *t;
    }
}; 
```

或者

2\. 为库本身的源文件里面的各种类型显式编译模板

```
//foo.h
template <class T>
class Foo
{
public:
    Foo(){};
    T bar();
};

//foo.cpp
template <class T>
T Foo<T>::bar()
{
    T* t = NULL;
    //do stuff
    return *t;
}

template class Foo<int>;
template class Foo<float>;
template class Foo<double>;
template class Foo<long long>; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-16T15:34:50.577

通常，编译器为特定编译单元生成一次代码，然后链接器确保其他编译单元可以访问变量和函数。

当涉及到模板时，情况不再如此。在模板的具体实例被实例化之前，编译器无法为模板生成代码。因此，我们在每个编译单元中实例化模板，而无需复制和粘贴的唯一方法是将所有模板代码放在头文件中。

链接器还必须具有模板意识并协调同一对象的多个实例。

C++11 在这种情况下确实有点帮助，人们可以声明：

```
template class MyTemplate<MyType>; 
```

在单个 C++ 文件中，然后使用：

```
extern template class MyTemplate<MyType>; 
```

后者不会在当前编译单元中实例化模板，但会让链接器链接到已经定义的模板。

看到[这里](http://gcc.gnu.org/onlinedocs/gcc/Template-Instantiation.html)更多细节

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-16T15:48:47.587

模板的关键问题是编译器不知道模板将用于哪些模板参数。编译器知道模板与特定参数集一起使用的唯一时间是当它看到使用的模板并且编译器将在此时实例化模板。因此，代码通常被放入头文件中，因此编译器可以在使用时代表用户实例化模板。

或者，模板的作者可以告诉编译器模板与特定的模板参数列表一起使用，然后显式地实例化它们。在这种情况下，模板定义可以进入源文件（或者，更有可能是用户通常不包含的特殊标题）。这种方法的问题是模板代码的作者不一定知道需要哪些实例化。

在 C++ 2011 中还有一个中间立场：可以通过将特化声明为`extern`. 这样，编译器知道它不需要使用某些参数来实例化模板，但如果使用了其他参数，它就知道它需要创建它们。例如，标准 C++ 库具有`std::basic_string`并且它可以预测`char`和`wchar_t`可能使用的实例化，并且可以将它们放入库中，将实例化声明为`extern`. 然而，让代码随时可用使得它可以`std::basic_string<user_type>`与用户定义的类型一起使用。

展望未来，我们希望得到一个模块系统，但现在没有人真正知道这样的系统应该如何真正工作。对该主题感兴趣的编译器实现者有一个小组来考虑模块，并且像这样的系统可能有助于模板的编译时间。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-16T15:58:28.370

已经有两个很好的答案了，我就简单写一下。**没有具体**
类型 就无法编译模板代码，这就是为什么您不能进行经典的“编译和链接”。 模板函数或类是不完整的，因为并非所有类型都被解析，直到它在代码中的特定用法（某种类型替换模板）。 出于这个原因，模板放在头文件中，不能独立于特定用途进行编译。

# varnish - 缓存对象时清漆慢（内存）

> ID：12917974
> 
> 赞同：20
> 
> 时间：2012-10-16T15:17:52.373
> 
> 标签：varnish

我的一位客户遇到了清漆速度问题。

long debug, short :
当 varnish 从他的缓存（内存）中获取对象时，真的很慢（> 5 秒），
当 varnish 需要从 apache 后端获取对象时，没有速度问题（< 1 秒）。

缓慢请求的示例（来自 varnishlog）：

```
193 ReqStart     c <client ip> 59490 1329239608  
193 RxRequest    c GET  
193 RxURL        c /<my_url>/toto.png  
193 RxProtocol   c HTTP/1.1  
193 RxHeader     c Accept: */*  
193 RxHeader     c Referer: <my_referer>  
193 RxHeader     c Accept-Language: fr  
193 RxHeader     c User-Agent: <client_useragent>  
193 RxHeader     c Accept-Encoding: gzip, deflate  
193 RxHeader     c Host: <my_vhost>  
193 RxHeader     c Connection: Keep-Alive  
193 VCL_call     c recv lookup  
193 VCL_call     c hash  
193 Hash         c /<my_url>/toto.png  
193 Hash         c <my_vhost>  
193 VCL_return   c hash  
193 Hit          c 1329136358  
193 VCL_call     c hit deliver  
193 VCL_call     c deliver deliver  
193 TxProtocol   c HTTP/1.1  
193 TxStatus     c 200  
193 TxResponse   c OK  
193 TxHeader     c Server: Apache  
193 TxHeader     c Last-Modified: Mon, 18 Jun 2012 08:57:46 GMT  
193 TxHeader     c ETag: "c330-4c2bb5c0ef680"  
193 TxHeader     c Cache-Control: max-age=1200  
193 TxHeader     c Content-Type: image/png  
193 TxHeader     c Content-Length: 49968  
193 TxHeader     c Accept-Ranges: bytes  
193 TxHeader     c Date: Tue, 16 Oct 2012 06:54:03 GMT  
193 TxHeader     c X-Varnish: 1329239608 1329136358  
193 TxHeader     c Age: 391  
193 TxHeader     c Via: 1.1 varnish  
193 TxHeader     c Connection: keep-alive  
193 TxHeader     c X-Cache: HIT  
193 TxHeader     c X-Cache-Hits: 210  
193 Length       c 49968  
193 ReqEnd       c 1329239608 1350370443.778280735 1350370480.921206713 0.372072458 0.000045538 37.142880440 
```

如果我是真的，问题出在最后一行 (ReqEnd)，
37.142880440 这是发送文件的时间（以秒为单位）。
我在本地也有同样的问题（所以这不是带宽问题）。

问题只发生在早上最大访客人数（~ 400req/s）的时候。

清漆选项：

```
DAEMON_OPTS="-a :80 \  
             -T localhost:6082 \  
             -f /etc/varnish/default.vcl \  
             -S /etc/varnish/secret \  
             -p thread_pool_min=100 \  
             -p thread_pool_max=1000 \  
             -p session_linger=100 \  
             -s malloc,8G" 
```

清漆似乎有足够的内存并且很好：

```
SMA.s0.c_req             4303728        38.35 Allocator requests
SMA.s0.c_fail                  0         0.00 Allocator failures
SMA.s0.c_bytes      169709790476   1512443.66 Bytes allocated
SMA.s0.c_freed      168334747402   1500189.36 Bytes freed
SMA.s0.g_alloc            172011          .   Allocations outstanding
SMA.s0.g_bytes        1375043074          .   Bytes outstanding
SMA.s0.g_space        7214891518          .   Bytes available

n_wrk                      200          .   N worker threads
n_wrk_create               200         0.00 N worker threads created
n_wrk_failed                 0         0.00 N worker threads not created
n_wrk_max                    0         0.00 N worker threads limited
n_wrk_lqueue                 0         0.00 work request queue length
n_wrk_queued                26         0.00 N queued work requests
n_wrk_drop                   0         0.00 N dropped work requests

n_lru_nuked                  0          .   N LRU nuked objects
n_lru_moved            8495031          .   N LRU moved objects 
```

清漆是最新的（3.0.3-1~lenny）。

如果您有想法或曲目...

清漆配置：

```
backend default {
    .host = "127.0.0.1";
    .port = "8000";
    .connect_timeout = 10s;
    .first_byte_timeout = 10s;
    .between_bytes_timeout = 5s;
}

sub vcl_recv {
  set req.grace = 1h;

  if (req.http.Accept-Encoding) {
    if (req.http.Accept-Encoding ~ "gzip") {
      set req.http.Accept-Encoding = "gzip";
    }
    else if (req.http.Accept-Encoding ~ "deflate") {
      set req.http.Accept-Encoding = "deflate";
    }
    else {
      unset req.http.Accept-Encoding;
    }
  }

  if (req.url ~ "(?i)\.(png|gif|jpeg|jpg|ico|swf|css|js|eot|ttf|woff|svg|htm|xml)(\?[a-z0-9]+)?$") {
    unset req.http.Cookie;
  }

  if (req.url ~ "^/content/.+\.xml$") {
    unset req.http.Cookie;
  }

  if (req.url ~ "^/min/") {
    unset req.http.Cookie;
  }

  if (req.restarts == 0) {
    if (req.http.x-forwarded-for) {
        set req.http.X-Forwarded-For =
        req.http.X-Forwarded-For + ", " + client.ip;
    } else {
        set req.http.X-Forwarded-For = client.ip;
    }
  }
  if (req.request != "GET" &&
    req.request != "HEAD" &&
    req.request != "PUT" &&
    req.request != "POST" &&
    req.request != "TRACE" &&
    req.request != "OPTIONS" &&
    req.request != "DELETE") {
      return (pipe);
  }
  if (req.request != "GET" && req.request != "HEAD") {
      return (pass);
  }
  if (req.http.Authorization || req.http.Cookie) {
      return (pass);
  }
  return (lookup);
}

sub vcl_fetch {
    if (req.url ~ "(?i)\.(png|gif|jpeg|jpg|ico|swf|css|js|eot|ttf|woff|svg|htm|xml)(\?[a-z0-9]+)?$") {
        unset beresp.http.set-cookie;
    }

    if (req.url ~ "^/(content|common)/.+\.xml$") {
      unset req.http.Cookie;
    }

    if (req.url ~ "^/min/") {
      unset req.http.Cookie;
    }

    set beresp.grace = 1h;

    if (beresp.ttl <= 0s ||
        beresp.http.Set-Cookie ||
        beresp.http.Vary == "*") {
        set beresp.ttl = 120s;
        return (hit_for_pass);
    }
    return (deliver);
}

sub vcl_deliver {
    if (obj.hits > 0) {
        set resp.http.X-Cache = "HIT";
        set resp.http.X-Cache-Hits = obj.hits;
    } else {
        set resp.http.X-Cache = "MISS";
    }

    return (deliver);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-02-02T03:49:07.397

你有过

```
-p thread_pool_max=1000 
```

这实际上是最低推荐的，因为你有

```
n_wrk_queued 26 
```

这表明是时候增加线程了，我相信如果您将其更改`2000`为例如并密切`n_wrk_queued`注意以确保您不需要更多线程，事情就会顺利进行。

# python - Twisted 中的非阻塞服务器

> ID：12917980
> 
> 赞同：7
> 
> 时间：2012-10-16T15:18:22.403
> 
> 标签：python, twisted

我正在构建一个需要在主线程以外的线程上运行 TCP 服务器的应用程序。尝试运行以下代码时：

```
reactor.listenTCP(ServerConfiguration.tcpport, TcpCommandFactory())
reactor.run() 
```

我收到以下错误

> exceptions.ValueError：信号仅在主线程中有效

我可以在主线程以外的线程上运行扭曲服务器吗？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-10-16T23:00:58.990

Twisted 可以在任何线程中运行——但一次只能运行一个线程。如果要在非主线程中运行，只需执行`reactor.run(installSignalHandlers=False)`. 但是，您不能在非主线程上使用反应器来生成子进程，因为它们的终止永远不会被检测到。（这是 UNIX 的限制，实际上，不是 Twisted。）

# c# - 编写 WebDAV 服务器

> ID：12917982
> 
> 赞同：0
> 
> 时间：2012-10-16T15:18:31.220
> 
> 标签：c#, asp.net, webdav

我打算用 ASP.NET 编写一个在 IIS 中托管的 webDAV 服务器。我想我必须写一个新的，因为我必须将它与我们的自定义安全模块集成。实际上，我认为我必须检查有关 webDAV 文件请求的一些安全（成员资格和角色）问题，并根据该安全问题响应请求。

如何编写 WebDAV 服务器？或者有适合我的图书馆吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T16:22:33.760

[关于现有库 - SourceForge 上有一个免费的 webdav 项目，然后在http://webdavsystem.com](http://webdavsystem.com)上有付费组件，我们在[SecureBlackbox](http://www.eldos.com/sbb/net-webdav.php)组件套件中提供 WebDAV 服务器。它们都可以与 IIS 集成。提供的微调级别（例如身份验证控制和文件系统访问）当然是不同的。我们的 SecureBlackbox 偏向于灵活性和功能丰富性。

# php - 在 php 文件中查找和回显锚标记

> ID：12917985
> 
> 赞同：0
> 
> 时间：2012-10-16T15:18:33.453
> 
> 标签：php, tags, find, anchor, echo

我已经为此搜索了很多，但还没有找到任何有用的东西......

我想在另一个 php 文件中找到所有锚标记并回显它们的名称（带有它们在文档中位置的 href）。

例如，我在一个文件中有这个：

```
<a name="test"></a> 
```

并想在我的主 php 文件中使用一些代码找到所有这些并将它们全部打印出来......

这是我尝试过的：

```
$dom = new DOMDocument;
    $dom->loadHTML($content);
    foreach( $dom->getElementsByTagName('a') as $node ) {
        echo $node->getAttribute( 'name' );
    } 
```

我知道这不是非常具体，但是，谢谢。

**编辑：**在当前页面上查找和回显锚点的方法怎么样？

在此处查找实际站点：[http ://robertwbooth.co.uk](http://robertwbooth.co.uk)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T15:54:55.947

你可以试试

```
$html = file_get_html("http://xxxxxx/support/content-entry/create-anchor-tags/");
$anchor = array();

foreach ( $html->find("a") as $link ) {
    if ($link->href === false) {
        $key = $link->id ? $link->id : ($link->name ? $link->name : false);
        if (! $key)
            continue;
        if (isset($anchor[$link->id])) {
            $anchor[$link->id] = array_merge($anchor[$link->id], array("name" => $link->name,"id" => $link->id));
        } else {
            $anchor[$link->id] = array("name" => $link->name,"id" => $link->id);
        }
    } else {
        if (strpos($link->href, "#") === 0) {

            if (isset($anchor[substr($link->href, 1)])) {
                $anchor[substr($link->href, 1)] = array_merge($anchor[substr($link->href, 1)], array("text" => $link->plaintext));
            } else {
                $anchor[substr($link->href, 1)] = array("text" => $link->plaintext);
            }
        }
    }
}

var_dump($anchor); 
```

输出

```
array
  'id507d815fd9383' => 
    array
      'name' => string 'id507d815fd9383' (length=15)
      'id' => string 'id507d815fd9383' (length=15)
      'text' => string 'Visit the Useful Tips Section' (length=29)
  'id507d815fd93a3' => 
    array
      'name' => string 'id507d815fd93a3' (length=15)
      'id' => string 'id507d815fd93a3' (length=15)
      'text' => string 'Visit the Useful Tips Section' (length=29)
  'id507d815fd93bc' => 
    array
      'name' => string 'id507d815fd93bc' (length=15)
      'id' => string 'id507d815fd93bc' (length=15)
      'text' => string 'Visit the Useful Tips Section' (length=29)
  'id507d815fd93d3' => 
    array
      'name' => string 'id507d815fd93d3' (length=15)
      'id' => string 'id507d815fd93d3' (length=15)
      'text' => string 'Visit the Useful Tips Section' (length=29)
  'id507d815fd93eb' => 
    array
      'name' => string 'id507d815fd93eb' (length=15)
      'id' => string 'id507d815fd93eb' (length=15)
      'text' => string 'Visit the Useful Tips Section' (length=29)
  'id507d815fd9404' => 
    array

.......... so many more 
```

# php - 手动确定 PHP 在呈现页面之前所做的最后一件事？

> ID：12917986
> 
> 赞同：0
> 
> 时间：2012-10-16T15:18:39.677
> 
> 标签：php

在所有页面都已加载并且页面将呈现给浏览器之后，我试图找出取消设置 php 会话变量的最佳方法。我有一个包含 & 需要渲染多个页面的页面。我想知道是否有一个内置的 php 函数会告诉 php 在页面完成之前做一些事情。或者最好的方法/做法是什么？

编辑##这是我添加的...

```
function unsetHIST_ID(){unset($_SESSION['Hist_CID']);}
register_shutdown_function('unsetHIST_ID'); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T15:23:06.273

有 .ini 指令[auto_append_file](http://php.net/manual/en/ini.core.php#ini.auto-append-file)，如果指定，最后由 PHP 解析。它基本上被视为您自己将`require('somefile.php')`作为最后一个命令放入文件中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-16T15:23:08.617

我不确定你为什么想要这个，但如果你想在脚本之后执行一个函数`execution finishes`或者`exit()`被调用，那么你应该看看[register_shutdown_function](http://php.net/manual/en/function.register-shutdown-function.php)

例子

```
function shutdown() {
    echo "Am dead anyway";
}

register_shutdown_function('shutdown');

echo "<pre>";
echo "Hello am Alive",PHP_EOL; 
```

输出

```
Hello am Alive
Am dead anyway <---------------This would always run last 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-16T15:24:23.367

你需要类似的东西

```
register_shutdown_function ('my_atexit_function'); 
```

或者你可以这样做

```
ob_start('content_handler'); 
```

第一个函数将在退出之前立即调用，这不是您所要求的；和输出之前的第二个，但这允许你对已经静态的输出做一些事情。

不过我会去的`register_shutdown_function`。

# iphone - 安装旧版 iOS 进行设备测试

> ID：12917990
> 
> 赞同：3
> 
> 时间：2012-10-16T15:18:50.673
> 
> 标签：iphone, ios, ipad

过去，测试比当前发布的 iOS 更早的 iOS 版本更简单。我现在似乎找不到办法做到这一点，因为 Apple 在尝试恢复设备时会打电话回家。如果设备符合更新的 iOS 条件，iTunes 和 XCode 4.5 会强制您升级 iOS。

就我而言，我有一部 iPhone 4，我想用 iOS 5.1.1 进行测试。我有这个设备上实际使用的 .ipsw 文件。当我尝试从该 .ipsw 强制恢复时，iTunes 会生成“不合格”错误。XCode 4.5 也可以。我的理解是 Apple 不再签署 5.1.1 并且我的设备符合 iOS 6 的条件，这是错误的原因。

过去，我有足够的设备放在架子上并用于测试。我现在没有那种奢侈了。

两个问题： 1\. 有什么方法可以在符合新 iOS 条件的设备上安装旧 iOS？2\. 你如何在旧的 iOS 版本上进行测试？

我欢迎建议

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-16T15:22:49.457

不可以，除非您越狱并且您的 SHSH blob 存储在 Cydia 或 TinyUmbrella 中，否则您无法安装较旧的 iOS。

大多数人使用模拟器或旧设备。

[https://developer.apple.com/downloads/index.action](https://developer.apple.com/downloads/index.action)

可用于查找旧的 xcode 和 ios SDK。

# php - 使用 Zend 框架记住最后点击的位置

> ID：12917999
> 
> 赞同：0
> 
> 时间：2012-10-16T15:19:17.163
> 
> 标签：php, html, zend-framework

我想向使用 Zend 框架构建的现有网站添加一个功能。该网站的问题之一是它经常在网页的不同位置刷新页面。我想做的是使用内置的 Zend 框架功能在网页刷新后保持相同的位置。

一个例子是：用户点击页面底部，相同的页面被重新加载，但它没有在页面顶部重新加载，它停留在用户上次点击的位置。

有这样的事吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T15:40:14.637

您必须结合使用 Javascript（在前端）和 Zend Framework（在后端）来实现这一点。

这是假设您正在使用用户 cookie/会话。

1.  创建一个事件处理程序，以在页面上的任何位置使用 Javascript 检测鼠标点击。在事件处理程序中，使用`event`对象获取鼠标位置的 x 和 y 坐标。（[鼠标点击事件坐标](http://www.javascripter.net/faq/mouseclickeventcoordinates.htm)）
2.  在 Zend 框架中设置一个端点，它将接受用户的鼠标坐标。例如：`http://localhost/user/updateCoordinates?x=12&y=100`
3.  在鼠标单击时，让您的事件处理程序执行 AJAX 查询，将坐标发送到您在 #2 中设置的端点。
4.  在 Zend Framework 中，将这些坐标存储在用户会话/cookie 中（以便您以后可以跟踪它）
5.  在页面加载时，从会话中获取值并输出 Javascript 代码以自动滚动到该坐标。此外，从 cookie 中删除 x 和 y 坐标，因为它已经被使用过。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T15:38:32.880

您可以使用一些 javascript 在刷新之前记录窗口的滚动位置，并将其保存到 cookie 中。

然后，当下一页加载时，检查 cookie，滚动到它的位置，然后删除它。如果网页具有动态大小的元素（例如：展开的手风琴菜单），这将无法正常工作。

不过就个人而言，我会尽量避免这种情况。我时不时地访问一些喜欢用我的滚动条做事的网站，并试图帮助我。他们经常弄错了，网页变得无法使用。也许您可以动态更新页面（ajax？）而不是进行真正的重新加载。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-06T12:27:03.560

您可以使用 ZF 的现有组件并将它们组合到一些新插件中：

1）在我的例子中，新的 ZF 插件保存在 ZF 结构中：/library/My/Controller/Plugin/ActionHistory.php

```
final class My_Controller_Plugin_ActionHistory extends Zend_Controller_Plugin_Abstract
{

/** @var bool flag indicating whether current action has been already logged */
private $dispatched = false;

/**
 * @param Zend_Controller_Request_Abstract $request
 * @return void
 */
public function pushStack(Zend_Controller_Request_Abstract $request) {
    $storage = $this->getStorage();
    $storage->stack[] = $request;
    // limit the depth of the stack
    if (count($storage->stack) > $this->getMaxDepth()) {
        array_shift($storage->stack);
    }
    // mark current action as dispatched (influences getBacklink())
    $this->dispatched = true;
}

public function popStack() {
    $storage = $this->getStorage();
    return array_pop($storage->stack);
}

/**
 * Returns request to previous action (not current).
 *
 * @return Zend_Controller_Request_Abstract|null
 */
public function getBacklink() {
    $storage = $this->getStorage();
    $depth = count($storage->stack);
    // points to top of the stack
    $backlinkIndex = $depth - 1;
    if ($this->dispatched) {
        // current action has been already logged, "backlink" is second from the top
        --$backlinkIndex;
    }

    return ($backlinkIndex >= 0 ? $storage->stack[$backlinkIndex] : null);
}

/**
 * Returns stack with performed actions
 * @return array
 */
public function getStack() {
    return $this->getStorage()->stack;
}

/**
 * @return Zend_Session_Namespace
 */
private function getStorage() {
    static $storage = null;
    if ($storage === null) {
        $storage = new Zend_Session_Namespace(get_class($this), true);
        if (!is_array($storage->stack)) {
            // initialize stack if needed
            $storage->stack = array();
        }
    }
    return $storage;
}

/**
 * Returns maximal depth of the action history
 * @return int
 */
private function getMaxDepth() {
    return 3;
}
} 
```

2）将此代码放在某个地方以将历史推送到堆栈中。您只能使用历史记录，例如与登录到应用程序的合作，或者您可以保存所有历史记录。这取决于你：

```
// this code is example of usage in another ZF controller plugin class
$actionHistory = Zend_Controller_Action_HelperBroker::getStaticHelper("ActionHistory");
if ($actionHistory) {
    // $this => instance of Zend_Controller_Plugin_Abstract
    $actionHistory->pushStack($this->getRequest());
} 
```

3）然后你可以在一些你想要处理动作历史的控制器中使用这个插件：

```
// check if there is an backlink stored in actionStack, if yes than use it
if (($actionHistory = $this->getHelper('actionHistory'))) {
$request = $actionHistory->getBacklink();
if ($request) {
    $actionHistory->popStack();
    // use any of your redirect classes or simle redirector helper
    // right path to previous site is accesible by $request->getUserParams()
    $this->redirect($request->getUserParams());
}
} 
```

就是这样:) 希望你可以修改你想要的，但是这个解决方案的理论和好处是很清楚的......