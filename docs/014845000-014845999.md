# StackOverflow 问答 14845000-14845999

# javascript - JQuery 方法在 Chrome 中工作，但不适用于 Android 版 Chrome

> ID：14845000
> 
> 赞同：2
> 
> 时间：2013-02-13T01:30:15.717
> 
> 标签：javascript, android, jquery, google-chrome, webkit

此代码在 Chrome 桌面上运行良好：

```
$(window).scroll(function(evt) {
   if($(window).scrollTop() + $(window).height() > ($(document).height() - 100)) 
   {
       document.getElementById('mainForm:hiddenRegButton').click();
   }

}); 
```

但是，它永远不会在 Chrome for Android 或 Webkit (iOS) 中触发。任何想法为什么？

谢谢，格雷姆。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-29T15:47:39.297

这可能是由于[Chrome for Android 上的多线程合成器](http://www.chromium.org/developers/design-documents/impl-side-painting)造成的。为了保持滚动流畅，工作被卸载到 GPU 并且 GPU 只会定期将其更新的滚动位置发送回主线程，通常滚动事件根本不会触发。

这在 iOS 上也是类似的。

# ruby-on-rails - 在失败的 rspec 测试中追溯外键错误

> ID：14845001
> 
> 赞同：0
> 
> 时间：2013-02-13T01:30:19.007
> 
> 标签：ruby-on-rails, ruby-on-rails-3.2

哇！在对表名和列名进行了一些迁移之后，我的 rspec 测试之一失败了，我无法将其追溯到导致它的原因。所以这是我的 rspc 测试，由于其中的这一行而失败：

```
it { should belong_to(:key_performance_indicators) } 
```

通过生成此错误：

> 1) KeyPerformanceInterval 失败/错误：它 { should bebelong_to(:key_performance_indicators) } 预期 KeyPerformanceInterval 有一个名为 key_performance_indicators 的 belongs_to 关联（KeyPerformanceInterval 没有 key_performance_indicators_id 外键。）

那么我该如何追溯呢？这是我在测试中谈论的课程：

```
class KeyPerformanceInterval < ActiveRecord::Base

  include ActiveModel::ForbiddenAttributesProtection

  belongs_to :key_performance_indicators

end 
```

如果我们需要更多源代码来查看，请告诉我，我会用它更新问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T01:45:26.303

好的修复，在应该匹配器中，我应该从表名中删除字符“s”，所以它应该是：

```
it { should belong_to(:key_performance_indicator) } 
```

# html - div 标签不包含元素？

> ID：14845005
> 
> 赞同：2
> 
> 时间：2013-02-13T01:30:34.500
> 
> 标签：html, css

也许有人可以帮助我，因为我什至不能直视了。我已经尝试了我能在这里找到的所有东西，在其他论坛上也无济于事。我已经设置了一些 div 来放置在我正在构建的站点的主容器中。div 中的内容一直在 div 之外，我不知道为什么。我已经发布了页面，头部附有 css，在这里：http: [//210usa.com/menu_test.html](http://210usa.com/menu_test.html) 我放置了不同的背景颜色，丑陋的，仅用于说明目的。任何帮助将不胜感激。

谢谢你：-）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T01:33:30.420

这是因为您使用了 float:left，您必须进行一些明确的修复，例如将容器的溢出设置为隐藏

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-13T01:33:32.567

将溢出属性添加到所有这些 div 如下，应该会有所帮助：

```
.menuApps, .menuGrinders, .menuPizza, .menuDinner {
    overflow: auto;
} 
```

# iphone - 使用 iPhone 客户端和 node.js 服务器进行 Facebook 或 Twitter 身份验证

> ID：14845006
> 
> 赞同：1
> 
> 时间：2013-02-13T01:30:40.970
> 
> 标签：iphone, node.js, authentication

对于这样一个普遍的问题，我深表歉意，但这是我第一次为 iPhone 应用程序构建服务器后端。

一个简单的用例是：当用户第一次启动 iPhone 应用程序时，他们会看到一个登录屏幕，他们可以通过 Facebook、Twitter 登录或手动创建一个帐户。一旦他们这样做，他们就可以正常使用该应用程序。下次他们启动应用程序时，应用程序不需要显示登录屏幕。

在后端，我需要使用 Node.js 和 MongoDB 创建服务器。我注意到有认证模块，例如everyauth 和passport.js。但我的困惑是如何处理这些身份验证和会话。

例如，对于 Facebook，我知道有一个 Facebook iOS SDK 可用于验证 iPhone 客户端。但是，应该在哪里进行身份验证：在 iPhone 上还是在服务器上？这种常见的情况通常如何处理？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T13:26:51.517

实际上，它基于您的特定案例的用例，我建议在服务器上处理它，因为在 passport.js 的帮助下，您可以更轻松地在服务器上处理身份验证和会话管理

由于您有多种方式来验证用户 facebook、twitter 和 basic，因此在客户端应用程序上实现单独的库，而不是在支持所有这三种身份验证策略的服务器“passport.js”上使用单个库。

我不确定您在服务器上使用的是什么框架，但我想建议将“Express”用作框架，因为 passport.js 可以轻松地与 express 集成，这使得会话管理变得更加容易。

# objective-c - tableView:accessoryTypeForRowWithIndexPath ：应用程序崩溃

> ID：14845007
> 
> 赞同：1
> 
> 时间：2013-02-13T01:30:42.447
> 
> 标签：objective-c, viewcontroller

我知道这是一个老问题，我已经阅读了其他帖子..但我没有找到解决我的问题的方法！

我有一个应用程序（仅适用于 iPad 版本），当我尝试通过电子邮件分享文章时，应用程序崩溃。 **这是日志文本：**

2013-02-13 02:10:31.281 FlipBlogForWordpress[2281:907] 警告：由于 tableView:accessoryTypeForRowWithIndexPath: in 的委托实现，使用旧版单元格布局。请删除此方法的实现并设置单元格属性附件类型和/或编辑附件类型以移动到新的单元格布局行为。在以后的版本中将不再调用此方法。2013-02-13 02:10:32.400 FlipBlogForWordpress[2281:907] *** 由于未捕获的异常“NSInvalidArgumentException”而终止应用程序，原因：“应用程序试图在目标上呈现一个 nil 模态视图控制器。” ***First throw call stack: (0x319742a3 0x3980d97f 0x33868159 0x3398a3ef 0xeed09 0x3383e28d 0x338c0f81 0x32282277 0x319495df 0x31949291 0x31947f01 0x318baebd 0x318bad49 0x3546d2eb 0x337d0301 0x9c759 0x9c6e0) libc++abi.dylib: terminate called throwing an exception (lldb)

这是我找到的代码`sharePopViewController.m` ：

```
 - (UITableViewCellAccessoryType)tableView:(UITableView *)tv accessoryTypeForRowWithIndexPath:(NSIndexPath *)indexPath {

return UITableViewCellAccessoryDisclosureIndicator;

} 
```

现在……有什么办法？？我什么都试过了...

非常感谢大家！！:)

（对不起我的英语不好！：P）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T01:43:59.620

你有两个问题。

1)`tableView:accessoryTypeForRowWithIndexPath:`在 iOS 3.0 中已弃用 —— 四年前。摆脱这种方法。相反，您需要`accessoryType`在方法中设置单元格的属性`cellForRowAtIndexPath:`。

2) 真正的问题是尝试显示模态视图控制器导致的崩溃。这次崩溃与第一个问题无关。

在调试器中运行您的应用程序并查看它在哪里崩溃。问题似乎来自于调用类似的东西：

```
[self presentViewController:someController animated:YES completion:nil]; 
```

并且`someController`是`nil`。

# java - 从 JSNI 方法返回的不是 Java 对象

> ID：14845012
> 
> 赞同：0
> 
> 时间：2013-02-13T01:30:58.130
> 
> 标签：java, gwt, errai

通过运行[erai-mvp-demo](https://github.com/csadilek/errai-mvp-demo)示例应用程序时

```
mvn gwt:run 
```

我收到此错误：

> java.lang.IllegalArgumentException：从 JSNI 方法 '@com.google.gwt.core.client.impl.Impl::apply(Ljava/lang/Object;Ljava/lang/Object;Ljava/ 返回 Java 对象以外的东西lang/Object;)'：布尔类型的 JS 值，在 com.google.gwt.dev.shell.JsValueGlue.get(JsValueGlue.java:178) 中的预期 java.lang.Object 在 com.google.gwt.dev.shell .ModuleSpace.invokeNativeObject(ModuleSpace.java:271) 在 com.google.gwt.dev.shell.JavaScriptHost.invokeNativeObject(JavaScriptHost.java:91) 在 com.google.gwt.core.client.impl.Impl.apply(Impl .java) 在 com.google.gwt.core.client.impl.Impl.entry0(Impl.java:213) 在 sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) 在 sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java :57) 在 sun.reflect.DelegatingMethodAccessorImpl。在 com.google.gwt.dev.shell.MethodAdaptor.invoke(MethodAdaptor.java:103) 在 com.google 的 java.lang.reflect.Method.invoke(Method.java:601) 调用(DelegatingMethodAccessorImpl.java:43) .gwt.dev.shell.MethodDispatch.invoke(MethodDispatch.java:71) 在 com.google.gwt.dev.shell.OophmSessionHandler.invoke(OophmSessionHandler.java:172) 在 com.google.gwt.dev.shell.BrowserChannelServer .reactToMessagesWhileWaitingForReturn(BrowserChannelServer.java:337) at com.google.gwt.dev.shell.BrowserChannelServer.invokeJavascript(BrowserChannelServer.java:218) at com.google.gwt.dev.shell.ModuleSpaceOOPHM.doInvoke(ModuleSpaceOOPHM.java:136 ) 在 com.google.gwt.dev.shell.ModuleSpace.invokeNativeBoolean(ModuleSpace.java:184) 在 com.google.gwt 的 com.google.gwt.dev.shell.ModuleSpace.invokeNative(ModuleSpace.java:561)。dev.shell.JavaScriptHost.invokeNativeBoolean(JavaScriptHost.java:35) 在 org.jboss.errai.common.client.util.LogUtil.isNativeJavaScriptLoggerSupported(LogUtil.java) 在 org.jboss.errai.common.client.util.LogUtil。 org.jboss.errai.ioc.client.Container.boostrapContainer(Container.java:45) 的日志(LogUtil.java:29) org.jboss.errai.ioc.client.Container.onModuleLoad(Container.java:34)在 sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) 在 sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57) 在 sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) 在 java.lang.reflect.Method .invoke(Method.java:601) 在 com.google.gwt.dev.shell.ModuleSpace.onLoad(ModuleSpace.java:396) 在 com.google.gwt.dev.shell.OophmSessionHandler。loadModule(OophmSessionHandler.java:200) 在 com.google.gwt.dev.shell.BrowserChannelServer.processConnection(BrowserChannelServer.java:525) 在 com.google.gwt.dev.shell.BrowserChannelServer.run(BrowserChannelServer.java:363)在 java.lang.Thread.run(Thread.java:722)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T02:37:34.950

我假设您正在使用 Chrome。这似乎是它的一个常见问题。我有同样的问题并切换到Firefox。从那以后我没有看到错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T05:34:25.003

如果您使用的是 Chrome，是的。此问题与`CHROME`发生有关。

根据*@Thomos Broyer*相对于谷歌群组的同一问题：

[https://groups.google.com/forum/?fromgroups=#!topic/google-web-toolkit/b0KbD8BNsqw](https://groups.google.com/forum/?fromgroups=#!topic/google-web-toolkit/b0KbD8BNsqw)

**快速修复**：从 Chrome 切换到 Firefox 开发模式

您可以在 Stackoverflow 上找到相同的问题。也请参阅该问题的[答案](https://stackoverflow.com/questions/8913608/something-other-than-an-int-was-returned-from-jsni-method)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-02-26T10:52:15.267

如果您收到 IllegalArgumentException，只需对客户端模型或 bean 进行一些更改。

当您返回具有他的数据类型的值时，只需提及包路径。

```
public native final Boolean apply() /*-{
 return this.apply ? @java.lang.Double::Boolean(D)(this.apply) : null;
 }-*/; 
```

# python - 如何拆分字符串中的大写字母？

> ID：14845013
> 
> 赞同：2
> 
> 时间：2013-02-13T01:31:06.410
> 
> 标签：python

```
s = "HiMyNameIsBob"

letters = ("A","B", "C", "D"...)

for char in s:
    if s.find(letters) is True: 
```

我希望结果是

```
"Hi My Name Is Bob" 
```

我想避免使用正则表达式方法

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-13T01:33:56.077

我可能会在这里依赖字符串的字典顺序：

```
''.join( ' '+x if 'A' <= x <= 'Z' else x for x in s ) 
```

演示：

```
>>> s = "HiMyNameIsBob"
>>> ''.join( ' '+x if 'A' <= x <= 'Z' else x for x in s )
' Hi My Name Is Bob' 
```

如果你不想要前导空格，你总是可以`.strip()`得到结果。

检查字符是否为大写的更好方法是使用`isupper()`函数（感谢 Esthete 和 wim 指出这一点）：

```
>>> ''.join( ' '+x if x.isupper() else x for x in s )
' Hi My Name Is Bob' 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-13T01:37:39.503

你想要[str.isupper()](http://docs.python.org/2/library/stdtypes.html#string-methods)。

```
>>> s = "HiMyNameIsBob"
>>> t = ''.join(c for c in s if c.isupper())
>>> print t
HMNIB 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-13T01:37:53.067

```
import sys

s = "HiMyNameIsBob"

letters = ("A","B", "C", "D"...)

for char in s:
    if s.find(letters):
        sys.stdout.write(' ')
    sys.stdout.write(char) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-14T10:03:21.123

```
>>> re.sub('([A-Z])',' \g<1>', "HiMyNameIsBob").strip()
'Hi My Name Is Bob' 
```

# c - 这个文件操作线程安全吗？

> ID：14845014
> 
> 赞同：1
> 
> 时间：2013-02-13T01:31:10.680
> 
> 标签：c, linux, multithreading

我想知道我的 PRINT 宏的线程安全性，并编写了一个程序来查看我这种情况下的文件操作是否是线程安全的，所以我在 fn0 中添加了 sleep 并发现是线程安全的。

```
$cat t
fn1
fn0 
```

打印两者并且不覆盖。

测试是否足够好或是否存在其他情况 PS：我不共享文件指针我对排序感到满意（无序/非排序很好）我只对损坏/覆盖感兴趣 - 似乎文件指针移动得很好。

------------宏-------------

```
#define PRINT(args ...) if (logflag) { \
FILE *flog = fopen(LOGFILE, "a"); \
fprintf( flog, args); \
fclose(flog); \
}  fprintf(stderr, args); fflush(stderr); 
```

--------------------测试程序----------------------------

```
#include <stdio.h>
#include <pthread.h>

#define LOGFILE "t"
char c='1';
void *fn0(void* v)
{

    FILE *flog = fopen(LOGFILE, "a");
    //sleep(2);
    fprintf( flog,"%s\n", "fn0");
    fclose(flog);

    printf ("Enter value ");
    c=getchar();
}

void* fn1(void*v)
{
    FILE *flog = fopen(LOGFILE, "a");
    fprintf( flog,"%s\n", "fn1");
    fclose(flog);
}
int main()
{
    pthread_t t0;
    pthread_t t1;

    pthread_create(&t0, NULL, fn0, (void *) NULL);
    pthread_create(&t1, NULL, fn1, (void *) NULL);
    pthread_join(t1, NULL);
    pthread_join(t0, NULL);

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T01:33:40.010

您的代码不是线程安全的。如果其中一个线程尝试打开文件，而另一个线程将其打开，则第二次尝试打开可能会因共享冲突而失败。即使操作系统允许您同时打开文件两次，您现在也有两个独立的非同步缓冲区和两个不同的文件指针。绝对不能保证您的写入是一致的。

您应该使用互斥锁序列化对共享资源的访问。

或者，使用生产者/消费者方法并将所有写入日志的内容放在单个线程上，即消费者。然后让多个生产者线程将日志记录任务推送到消费者线程。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-08-26T20:12:07.243

该代码非常接近线程安全。它肯定是线程安全的，因为它不会：

*   破坏进程内存
*   由于同时访问内存中的数据结构而导致段错误。
*   导致读取部分写入的数据（例如在一个线程中填充缓冲区并同时在另一个线程中读取）

但是，正如 David Heffeman 所提到的，在写入文件的级别上它不是线程安全的。虽然很接近。使用系统调用写入而不是缓冲 IO，例如使用 open + write 而不是 fopen + fwrite，可用于获得原子写入和线程安全。

有关确保写入是原子的更多详细信息，请参阅此答案： [文件附加在 UNIX 中是原子的吗？](https://stackoverflow.com/questions/1154446/is-file-append-atomic-in-unix)

另一件事；使用 global`char c`是有风险的，尽管在所示上下文中它的使用是线程安全的。如果`c`在函数内部声明`fn0`，它将消除潜在的问题（只要它保持一个自动变量并且未声明`static`）。

关于像这样的测试用例——根据我的经验，压力测试可以给出可靠的结果，但压力测试需要付出一些努力——压力测试通常会带来各种细微差别，这些细微差别很好解决，但可以压倒性的和令人沮丧的。为了进行压力测试，只需设置一个程序，该程序在可配置数量的迭代中衍生出可配置数量的线程。对于这样的测试，我建议从 20 个线程和 1000 次迭代开始。

话虽如此，我同意线程安全和竞争条件永远不能通过单独的测试来 100% 证明不存在。

# objective-c - Cocoa Layer-Backed Views：我什么时候不能在窗口内容视图上启用 layer-backing？

> ID：14845015
> 
> 赞同：6
> 
> 时间：2013-02-13T01:31:12.867
> 
> 标签：objective-c, macos, cocoa, core-animation, calayer

此行出现在 Apple 的核心动画文档中（链接：http: [//developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/CoreAnimation_guide/SettingUpLayerObjects/SettingUpLayerObjects.html#//apple_ref/doc/uid/TP40004514- CH13-SW5](http://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/CoreAnimation_guide/SettingUpLayerObjects/SettingUpLayerObjects.html#//apple_ref/doc/uid/TP40004514-CH13-SW5) )

```
It is recommended that you enable layer support in the content view 
of your window whenever possible. 
```

我的问题是：**我什么时候不能安全地做到这一点？**

### 解释：

我的 UI 中有一些按钮，我想使用 Core Animation 进行动画处理（旋转）。为此，它们需要有层支持。现在，我*只有*按钮层支持，而我的其余视图则没有。这工作正常。但是，Apple 并没有详细说明上面的句子，所以我担心动画可能会在未来的版本中中断，因为父视图没有层支持。

我不想分层我的整个视图层次结构有两个原因：

1.  它使我的内存占用增加了大约 230%。
2.  它会导致很多小故障（特别是因为我做了很多自定义绘图）。

那么，在这里和那里只为几个按钮启用图层支持而不为整个视图层次结构启用它是安全的，还是我在与灾难调情？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T02:21:56.980

是的，没关系。我看过 Apple 以前的文档，这些文档告诉您在启用视图层支持时要谨慎，因为您列出的确切原因。

整个报价是：

> 在您的 nib 文件中，使用 View Effects 检查器为您的视图启用图层支持。**检查器显示所选视图及其子视图的复选框**。建议您尽可能在窗口的内容视图中启用图层支持。

这是否意味着对于任何给定的视图，当您打开视图效果检查器时，您会获得当前视图及其所有子视图的复选框？如果是这样，也许文档只是意味着您应该转到窗口的内容视图并检查每个需要它的视图的图层支持复选框，而不是在子视图的设置中。

这些天我主要使用 iOS，通常只是创建一个插座并调用 setWantsLayer：如果我想为 Mac OS 视图设置动画。

# c++ - 访问位集中的多个位

> ID：14845021
> 
> 赞同：1
> 
> 时间：2013-02-13T01:31:47.120
> 
> 标签：c++

我正在编写一个缓存模拟器，其中使用了 32 位地址。我使用 bitset<32> 来存储地址。当我尝试访问地址的多个位进行解码时，会遇到一个问题。例如：

```
int index = address[index_MSB, index_LSB].to_ulong(); 
```

我尝试访问地址中的一些位并转换为 int。它会导致错误。有没有办法做到这一点？谢谢！

例子：

地址 = 0x12345678；

index_MSB = 5;

index_LSB = 2;

我需要从地址 [2] 到地址 [5] 的 4 位，这里是 1110，然后转换为 int 值：14。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T01:43:53.983

访问数字中的位的常用方法是在数字和掩码之间进行 AND 操作。例如

```
number = 0xFFAA0055; // an example
bit17 = 1 << 17;     // counting bit0 as the least significant bit

bit17set = number & bit17; 
```

`true`如果第 17 位是，则bit17set 将是`1`，因为只有这样，逻辑才会`AND`产生非零结果。

如果您对多个位感兴趣，您可以在 AND 之前简单地将它们的掩码相加：

```
bit6 = 1 << 6;

bit6or17 = bit6 + bit17;
bit6or17set = number & bit6or17; 
```

当您想要从 MSB 到 LSB 的地址位时，最简单的操作是：

```
temp = number >> LSB; // this shifts LSB numbers to the right
answer = temp & ((1<<(MSB-LSB+1) - 1); // a mask of MSB-LSB bits 
```

您当然可以将这两者结合起来：

```
int index = ((address >> index_LSB) & (1<<(index_MSB - index_LSB+1)-1)).to_ulong(); 
```

注意：以上所有内容都假设“正常”数字，并且“按常规”存储位。如果您`address`以上述方法无法访问的方式包含位，则可以执行以下操作：

```
int ii, index=0;
for(ii=index_MSB; ii>= index_LSB; ii--) {
    index = (index << 1) + address[ii];
} 
```

# android - Android：如何调用相机

> ID：14845022
> 
> 赞同：-8
> 
> 时间：2013-02-13T01:31:48.563
> 
> 标签：android, android-camera, android-capture

现在我被要求创建一个简单的应用程序，人们可以在其中拍照。并且该照片将保存到特定文件夹中，并且主图库无法访问该文件夹。只有该应用程序可以访问该文件夹并查看图片。

我的问题是，如何在应用程序中添加或调用相机？拍照、拍摄照片、将其保存在文件夹中以及如何停止保存照片（如取消保存）的步骤是什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T01:34:23.303

Android Camera API 上有很多文档。您可以使用 Google 找到它们。这是一个关于相机 API 的非常有用的文章的链接。

[http://www.vogella.com/articles/AndroidCamera/article.html](http://www.vogella.com/articles/AndroidCamera/article.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T01:35:39.650

我建议你按照android提供的例子

[http://developer.android.com/guide/topics/media/camera.html](http://developer.android.com/guide/topics/media/camera.html)

最简单的指令。

# javascript - cake 如何防止 ctp 元素在页面加载时显示

> ID：14845028
> 
> 赞同：0
> 
> 时间：2013-02-13T01:32:44.860
> 
> 标签：javascript, jquery, css, cakephp

我在我的 default.ctp 布局中使用了几个元素，即：

```
echo $this->element('messagesDialog');
echo $this->element('manualpDialog'); 
```

它们属于我的布局，随时可用。在我的 .js 上，我将这些元素隐藏在准备好的文档中：

```
$('#dialog-messages').hide(); 
```

问题是这些元素（只是一个带有表格的 div 等）在页面加载时部分可见，这看起来很丑陋且有问题。请注意，由于我的元素在布局中，它们会短暂地显示在用户看到的任何主页上。

为了防止这些 div 半显示，我想在需要时以某种方式“创建”它们，然后将它们处理掉。（我使用jQuery）。

下面的解决方案（来自[How can I make the browser waiting to display the page until it's fully loaded?](https://stackoverflow.com/questions/1435015/how-can-i-make-the-browser-wait-to-display-the-page-until-its-fully-loaded)）对我来说很难使用，因为我的 default.ctp 非常拥挤，元素和脚本代码以及蛋糕的东西都放在一个单格

```
<body>
<div id="msg" style="font-size:largest;">
<!-- you can set whatever style you want on this -->
Loading, please wait...
</div>
<div id="body" style="display:none;">
<!-- everything else -->
</div>
<script type="text/javascript">
$(document).ready(function() {
    $('#body').show();
    $('#msg').hide();
});
</script>
</body> 
```

我认为解决方案是让我的元素，例如

```
echo $this->element('messagesDialog'); 
```

仅在适当的时候（当用户想要查看他的消息时）加载到我的布局中，并且 - 如果可能的话 - 被删除以防止在页面被实例化后半显示为页面加载。

关于如何做到这一点的任何想法？

非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T01:55:54.053

如果不需要元素，则不应加载它们。相反，在您的布局文件中创建一个 IF 条件，该条件根据控制器名称和操作名称加载元素。如果您使用会话跟踪用户，您还可以基于会话变量的 IF。

或者，您可以简单地将元素放入 div 中，例如：

```
<div class="hiddenClass" style="display: none;">
<?php echo $this->element('messagesDialog'); ?>
</div> 
```

然后在您的 javascript 部分中使用以下内容： $('.hiddenClass').show();

# php - 划分多维数组

> ID：14845032
> 
> 赞同：0
> 
> 时间：2013-02-13T01:33:28.023
> 
> 标签：php, arrays

我有一个初始数组：

```
array
( [no] => array 
          (
             [<30] => 3
             [>30] => 5
             [>50] => 2
          )
  [yes] => array
          (
             [<30] => 4
             [>30] => 2
             [>50] => 7
          ) 
  [maybe] => array
          (
             [<30] => 7
             [>30] => 9
             [>50] => 10
          ) 
) 
```

上述数组是否可以通过yes、no 和maybe 拆分成多个数组变量。如 ：

```
$yes = array(3,5,2);
$no = array(4,2,7);
$maybe = array(7,9,10); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T01:35:08.853

```
$yes   = $array['yes'];
$no    = $array['no'];
$maybe = $array['maybe']; 
```

这里的所有都是它的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T01:41:58.833

你可以试试这个。

```
$result = array();

foreach($data as $response)
    $result[] = array_values($response);

list($no, $yes, $maybe) = $result; 
```

`$data`您的问题中显示的数组在哪里。

然后，您可以从 、 和 中访问 3 个值`$no`，`$yes`并`$maybe`假设 的顺序与该顺序`$data`相对应。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-13T01:46:35.443

假设内部数组以相同的顺序填充相同的键，看起来你想看看 array_values：[http://php.net/manual/en/function.array-values.php](http://php.net/manual/en/function.array-values.php)

从那开始，它应该很简单：

```
$yes   = array_values( $initial_array['yes'] );
$no    = array_values( $initial_array['no'] );
$maybe = array_values( $initial_array['maybe'] ); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-13T05:23:08.577

All the other solution given for this question depends on the name of the key, if the key changes from `yes` to `YES`, none of the solution works, Here is the dynamic solution for it, simple too.

```
$array   = array("yes"=>array(1,2,3,4),"no"=>array(3,45,6,),"maybe"=>array(7,8,9));

foreach($array as $key=>$val){
   $key      = strtolower($key);
   $$key     = $val;
}

print_r($yes);
echo "<br>";
print_r($no);
echo "<br>";
print_r($maybe); 
```

# java - 如何让 JAXB schemagen 允许一个 @XmlRootElement 类的多个元素名称

> ID：14845035
> 
> 赞同：1
> 
> 时间：2013-02-13T01:33:34.083
> 
> 标签：java, jaxb, jaxb2

[这与JAXB 生成的 No @XmlRootElement](https://stackoverflow.com/questions/819720/no-xmlrootelement-generated-by-jaxb)等问题的方向相反。基本上我想运行 schemagen 并拥有两个相同类型的全局元素。

```
<xs:element name="root1" type="tns:sameType"/>
<xs:element name="root2" type="tns:sameType"/> 
```

我了解如何使用 JAXBElement 编组事物，但我不知道如何正确生成模式。在我看来，它看起来类似于以下片段（@XmlRootElements 是虚构的）。

```
@XmlRootElements(value = {
    @XmlRootElement(name="root1", namespace="urn:example"),
    @XmlRootElement(name="root2", namespace="urn:example")
}) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T01:38:05.407

您可以在使用`@XmlElementDecl`注释的类上使用注释`@XmlRegistry`。

**对象工厂**

当`@XmlElementDecl`一个类型有多个与之对应的全局元素时使用注解。注释放置在`create`用 注释的类的方法上`@XmlRegistry`。当从 XML 模式生成模型时，总是调用这个类`ObjectFactory`。

```
package forum14845035;

import javax.xml.bind.JAXBElement;
import javax.xml.bind.annotation.*;
import javax.xml.namespace.QName;

@XmlRegistry
public class ObjectFactory {

    @XmlElementDecl(name="root1")
    public JAXBElement<SameType> createRoot1(SameType sameType) {
        return new JAXBElement<SameType>(new QName("urn:example", "root1"), SameType.class, sameType);
    }

    @XmlElementDecl(name="root2")
    public JAXBElement<SameType> createRoot2(SameType sameType) {
        return new JAXBElement<SameType>(new QName("urn:example", "root2"), SameType.class, sameType);
    }

} 
```

**同类型**

在这个用例中，域类不需要注释。

```
package forum14845035;

public class SameType {

} 
```

**包信息**

我们将利用包级别的`@XmlSchema`注释来为我们的模型指定命名空间限定。

```
@XmlSchema(namespace="urn:example", elementFormDefault=XmlNsForm.QUALIFIED)
package forum14845035;

import javax.xml.bind.annotation.*; 
```

**演示**

```
package forum14845035;

import java.io.IOException;
import javax.xml.bind.JAXBContext;
import javax.xml.bind.SchemaOutputResolver;
import javax.xml.transform.Result;
import javax.xml.transform.stream.StreamResult;

public class Demo {

    public static void main(String[] args) throws Exception {
        JAXBContext jc = JAXBContext.newInstance(SameType.class, ObjectFactory.class);
        jc.generateSchema(new SchemaOutputResolver() {

            @Override
            public Result createOutput(String namespaceUri,
                    String suggestedFileName) throws IOException {
                StreamResult result = new StreamResult(System.out);
                result.setSystemId(suggestedFileName);
                return result;
            }

        });
    }

} 
```

**输出**

```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<xs:schema elementFormDefault="qualified" version="1.0" targetNamespace="urn:example" xmlns:tns="urn:example" xmlns:xs="http://www.w3.org/2001/XMLSchema">

  <xs:element name="root1" type="tns:sameType"/>

  <xs:element name="root2" type="tns:sameType"/>

  <xs:complexType name="sameType">
    <xs:sequence/>
  </xs:complexType>

</xs:schema> 
```

**了解更多信息**

*   [http://blog.bdoughan.com/2012/07/jaxb-and-root-elements.html](http://blog.bdoughan.com/2012/07/jaxb-and-root-elements.html)

# php - 我可以使用 php sdk 将照片上传到用户组吗？

> ID：14845040
> 
> 赞同：2
> 
> 时间：2013-02-13T01:33:52.717
> 
> 标签：php, facebook, facebook-graph-api, sdk, photo

我的问题：可以上传照片并将其发布到用户组吗？我的 APP 将上传一张照片，但我希望用户可以选择使用 PHP SDK 将其上传到他的群组或页面或粉丝专页中。

# javascript - setInterval 立即触发而不是等待事件。

> ID：14845041
> 
> 赞同：1
> 
> 时间：2013-02-13T01:33:54.783
> 
> 标签：javascript, jquery, css

一旦 konami 触发，它不会发生 setInterval ，而是在页面加载后立即启动。

Konami 是一个 jquery 插件，可让您将 konami 代码用作事件。

我知道它可以正常工作，一个简单的 alert() 可以正常工作。

```
 <script type="text/javascript">

        $(document).ready(function(){
            $(window).konami(setInterval(function(){

            var one = Math.random()/1.2;
            var two = Math.random()/1.5;
            var three = Math.random()/2;

            $("#fire1").animate({
                opacity: one
                }, { duration: 100, queue: false });
            $("#fire2").animate({
                opacity: two
            }, { duration: 100, queue: false });
            $("#fire3").animate({
                opacity: three
            }, { duration: 100});

            }, 100));
        });
    </script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T01:33:54.783

正要发帖的时候想通了。

它与此非常相似：[.on 事件在加载而不是点击时触发](https://stackoverflow.com/questions/12430375/on-event-firing-on-load-instead-of-click)

一旦我将它包装在 function(){ } 中，它就会等待 konami 代码。

# java - 将文件写入默认临时目录时权限被拒绝

> ID：14845045
> 
> 赞同：6
> 
> 时间：2013-02-13T01:34:12.743
> 
> 标签：java, linux, tempdir

我的程序做了一些相当密集的操作，所以我使用一个临时文件来加快速度。我使用以下 Java 代码：

```
File scratchFile = new File(System.getProperty("java.io.tmpdir") + "WCCTempFile.tmp");
if (!scratchFile.exists())
    scratchFile.createNewFile(); 
```

此代码在 Mac OS X 和 Windows 上运行良好。它在 Java 临时目录中创建一个临时文件，该目录由操作系统确定。

但是，当我在 Linux（特别是 Linux Mint）上尝试这个程序时，我在“scratchFile.createNewFile()”行上收到以下错误

```
java.io.IOException: Permission Denied 
```

我真的对这个错误感到困惑，因为我认为该`System.getProperty("java.io.tempdir")`方法收集的临时目录将是用户可以写入的目录（并且它位于其他操作系统上）。这不是在 Linux 上的情况吗？有没有办法授予对临时目录的访问权限？我应该使用其他目录吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-13T01:39:49.967

在 Linux`java.io.tmpdir`上通常设置为`/tmp`（注意缺少的尾随 /）。与其乱用额外的嵌入斜线，不如使用[两参数 File 构造函数更简洁](http://docs.oracle.com/javase/6/docs/api/java/io/File.html#File%28java.lang.String,%20java.lang.String%29)

```
File scratchFile = new File(System.getProperty("java.io.tmpdir"),"WCCTempFile.tmp"); 
```

这样您就不必担心是否有斜杠。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-13T01:35:34.727

如果您有权限，您可以使用`chmod`.

# ember.js - 客户端 Javascript 应用程序 - 没有哈希标记的 url 路由

> ID：14845048
> 
> 赞同：23
> 
> 时间：2013-02-13T01:34:22.043
> 
> 标签：ember.js, url-routing, client-side, javascript-framework

我正在使用最新版本的 Ember.js 开发一个新的仅限客户端的应用程序。有一个 PHP 页面可以构建脚本、css、模板文件等，并将其全部交付到 index.php 中。我正在使用 htaccess 指令，以便将所有请求都重写到 /index.php。就我而言，PHP 只是为了方便地打包 Javascript。

目前，浏览器中的路由看起来像这样并且工作得很好。

```
/#/about 
/#/favorites
/#/etc
/#/posts/5/edit 
```

但是，我希望它们看起来像这样 - 这不能正常工作。

```
/about
/favorites
/etc
/posts/5/edit 
```

第二个选项仍然提供完全相同的客户端代码 - 但它总是命中索引路由处理程序。我以前见过客户端应用程序实现这一点 - 我错过了什么？我需要在 PHP 端有匹配的路由处理程序吗？

编辑：我正在寻找如何解决这个问题的具体答案。网络上充斥着“哦——你就这么做”的信息，让其他人摸不着头脑。

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2013-05-14T23:07:22.633

在 Ember.js（版本 1.0.0rc3）中，这可以通过使用[Ember.js 位置 API](http://emberjs.com/guides/routing/specifying-the-location-api/)来完成：

```
App.Router.reopen({
  location: 'history'
}); 
```

然后设置 Web 服务器将流量重定向到 Ember 应用程序。

这里举一个具体的例子，一个基本的 Apache`.htaccess`文件将流量重定向到位于 index.html 中的 Ember 应用程序：

```
RewriteEngine on
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ /index.html#$1 [L] 
```

正如[Alex White](https://stackoverflow.com/a/21704913/657661)所指出的，Apache 2.2.16 及更高版本支持更简单的配置来将流量重定向到单个目标：

```
FallbackResource /index.html 
```

[FallbackResource](https://httpd.apache.org/docs/trunk/mod/mod_dir.html#FallbackResource)是`mod_dir`模块的一部分，需要设置`AllowOverride Indexes`。

确保彻底测试应用程序路由。一个常见的错误是`Uncaught SyntaxError: Unexpected token <`，这是由使用 CSS 和 JS 文件的相对链接引起的。在它们前面加上一个`/`标记，使它们成为绝对的。

**[Internet Explorer <10 不支持](http://caniuse.com/#search=pushstate)此功能。**

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2014-02-11T14:41:49.087

比 RewriteRule 更好，您可以将其用于 Apache 2.2.16+：

```
FallbackResource /index.html 
```

在您的 Apache 配置中，以便 RewriteRule 不需要为每个请求运行。这将确保您的 ember 应用程序中的每个路由都落入 index.html 文件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-13T01:48:25.903

**@Pascal：**他不是在谈论实际的页面刷新，而是使用 Ember 的`history`（`location: 'history'`）。

要回答您的问题，您需要配置您的*.htaccess*以像往常一样向 JavaScript 提供内容。一旦你的 URL 被配置为加载你的应用程序，Ember 就会像往常一样从 URL 中为你处理一切。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-13T01:38:02.517

是的，您需要在服务器端有匹配的路由。不使用哈希标签也会强制重新加载页面，减慢速度，并可能导致更多的刷新而不是必要的。

另外，您将需要通过服务器传递状态，或使用浏览器本地存储的某些变体。

# c - 绘制到 gtk 窗口

> ID：14845050
> 
> 赞同：1
> 
> 时间：2013-02-13T01:34:31.353
> 
> 标签：c, gtk, cairo

我在 gtk 窗口中嵌入了一个 gtk 绘图区域。我有一个响应“draw”信号的回调函数，它最初将一些东西绘制到绘图区域。现在我有另一个函数可以响应几个按钮发出的“点击”信号。每次单击按钮时，我都想在绘图区域另外绘制一些东西。如何实现？我尝试以绘图区域为目标制作一个新的 cairo 表面，但 cairo 笔画没有显示任何内容。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T01:39:44.627

自从我用 Gtk+ 做任何事情以来已经有一段时间了，但我相信你想要做的是在处理程序`gtk_widget_queue_draw_area()`内部调用`"click"`，然后进行绘图以响应`draw`最终将引发的 " " 信号。

# c++ - C++ 中与 Matlab 中的 wpd 和 newpnn 函数类似的函数？

> ID：14845051
> 
> 赞同：0
> 
> 时间：2013-02-13T01:34:41.073
> 
> 标签：c++, matlab

我正在研究 Matlab 编程和 C++，我想知道 C++ 中是否有与[NEWPNN](http://www.mathworks.com/help/nnet/ref/newpnn.html)和[WPD](http://www.mathworks.com/help/wavelet/ref/wpdec.html)（这些函数在 Matlab 中）类似的函数（代码）。如果你不知道，让我解释一下这些功能。NEWPNN 是要找出初始输入数据中的哪一个最可能类似于输入初始数据后将输入的额外数据。
WPD就是弄清楚输入数据有什么样的特征，然后结果告诉我们共同的特征。数据可以是所有这些：图形、函数或代码。我不确定这个意思是否清楚地传达给你。所以，这里是检查 newpnn 是什么以及 wpd 是什么的网站。

[http://www.mathworks.com/help/nnet/examples/pnn-classification.html](http://www.mathworks.com/help/nnet/examples/pnn-classification.html)
[http://www.mathworks.com/help/wavelet/examples/wavelet-packets-decomposing-the-details.html](http://www.mathworks.com/help/wavelet/examples/wavelet-packets-decomposing-the-details.html)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T01:43:16.610

您需要的一切都可以在以下两个 SO 问题中找到：

神经网络：[https ://stackoverflow.com/questions/1484225/modern-c-style-neural-network-libraries](https://stackoverflow.com/questions/1484225/modern-c-style-neural-network-libraries)

小波：[寻找用于信号处理的良好 C/C++ 小波库](https://stackoverflow.com/questions/9606458/looking-for-a-good-c-c-wavelet-library-for-signal-processing)

所以不，C++ 中没有内置命令来做这些事情，你需要使用库，就像你在 MATLAB 中需要一个额外的包一样。

C++ 库的学习曲线可能比 MATLAB 包更陡峭，因此只有在遇到无法解决的 MATLAB 生态系统的一些限制时才应该真正切换。

# php - 将文件名数据库与文件同步

> ID：14845052
> 
> 赞同：1
> 
> 时间：2013-02-13T01:34:45.927
> 
> 标签：php, mysql

我有一个 MySQL 数据库，其中包含许多文件的文件名和文件夹位置。我想知道如果我重命名文件（仅通过 Windows 资源管理器），有没有办法自动将该更改同步到数据库？如果我添加新文件或将文件移动到另一个文件夹，则相同。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T01:38:37.513

在这种情况下，“自动”是一个强词。

您可以有一个运行脚本来扫描文件系统并调整数据库内容的 cron 作业。

# c++ - 加载队列而不是列表

> ID：14845053
> 
> 赞同：0
> 
> 时间：2013-02-13T01:35:01.160
> 
> 标签：c++, list, queue

我有一个可以由`std::queue`或来完成的实现`std::list`。我使用哪个有区别吗？`std::queue`似乎功能较少，所以它比`std::list`?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T01:45:07.630

> 我使用哪一个有区别吗？

是的 - 在几个方面。主要考虑因素是可读性：通过使用`std::deque`您向代码的读者传达您仅在容器的末端而不是中间插入和删除的意图。当你阅读别人的代码时，这是一件非常好的事情。

第二个考虑是容器本身的实现：与单独分配和存储元素的列表不同，将`std::deque`其元素存储在块中以节省空间。这可以减少容器的占用空间，和/或使其稍微快一些。另一方面，在遍历整个队列时存在潜在的低效率。

但是，在您的初始设计过程中，效率考虑不应成为一个因素，因为这是一个优化问题。

我认为最好的方法是争取最好的可读性：使用容器以最简洁的方式向代码的读者传达你的意图。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T01:38:37.120

> 似乎功能更少，所以更轻......？

更多的功能不会使物体变得更重。我会使用在您的场景中最有意义的集合。如果您始终以先进先出的方式访问它，那么`std::queue`将是合适的。如果您需要双链表功能，请使用`std::list`.

# c++ - 跟踪多张面孔

> ID：14845062
> 
> 赞同：0
> 
> 时间：2013-02-13T01:36:22.473
> 
> 标签：c++, opencv, image-processing, video-processing

我正在使用 opencv 进行视频 suvilleince 项目。我需要检测人脸，识别他们并只跟踪识别出的人脸，直到他们走出框架。我在 Opencv 中使用 Haar Cascades 来检测人脸，当它稍微倾斜时它们似乎没有检测到人脸（我使用了所有这些人仍然没有运气！）。所以我提出了一个不同的想法，首先检测面部，然后跟踪它们（使用斑点检测），以便检测/跟踪阶段的边界矩形输出可以用作识别阶段的输入。但是我现在面临的问题是我需要经常调用detect_face程序来捕获任何进入框架的新面孔，当这种情况发生时，老面孔可能已经倾斜，因此我的跟踪程序失去了锁定. 我真的陷入了困境。有人有更好的想法吗？...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T02:00:41.997

> 年长的人可能会倾斜他们的脸，因此我的跟踪程序会失去锁定。

倾斜图像。

尝试一种快速旋转算法 - 一种不会为敏感的美学色彩混合而烦恼的算法。

对于视频的每一帧，生成 2 或 4 个稍微旋转的新图像，并对这些图像运行 haarcascades 并合并结果。

> 另外，如何使帧中的特定区域模糊

将该区域中的每个像素替换为“附近像素”的平均值的颜色，以获得该短语的某些定义。

首先在单独的图像上执行此操作，这样一个像素的模糊不会影响下一个像素的平均值。

# php - 为什么 PHP 不能创建文件，即使有 777 权限？

> ID：14845063
> 
> 赞同：1
> 
> 时间：2013-02-13T01:36:25.327
> 
> 标签：php, xampp, file-permissions, archlinux

我的笔记本电脑上有一个运行 XAMPP 的虚拟 Arch Linux 测试服务器，即使权限设置为 777，我也无法使用 php 创建新文件。代码如下：

```
$CompleteFilepath = $AFilepath . '/filepath/filename.php';
$FileHandle = fopen($CompleteFilepath, 'c')
    or
die ("cannot be opened for writing"); // Debug 
```

之后显然还有更多代码，但这无关紧要，因为它总是死在这里。我无法通过修改所有者和组设置来使其工作，所以我最终求助于将所有内容（主根文件夹除外）递归设置为 777，它仍然无法工作。但是该文件夹不是直接在根目录中创建的，所以没关系，对吧？

编辑：我仍然不确定我做错了什么，但是今天我将所有者设置为服务器并且它起作用了。我以为我已经尝试过了，但也许没有。至少我可以继续开发，即使我最终需要更安全地配置我的生产服务器。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2015-11-20T12:58:32.643

我在全新安装 CentOS 7 时遇到了类似的问题。事实证明，它默认安装了 SELinux，这会阻止所有 PHP 写入，即使目录权限正确也是如此。

测试是否安装了 SELinux：`sestatus`

将 SELinux 置于许可模式：`setenforce 0`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T01:59:21.090

什么 php 版本正在运行，afaik 选项“c”仅适用于 php 5.2.6 及更高版本。

或简称：确实

```
$FileHandle = fopen($CompleteFilepath, 'w'); 
```

工作？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-11T04:50:13.367

好吧，我将所有者设置为服务器，现在它可以工作了。我以为我已经尝试过了，但显然没有。仍然不确定我到底做错了什么，但至少现在它可以工作了，所以我可以继续开发。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-24T07:11:54.560

PHP 有一个名为[open_basedir](http://www.php.net/manual/en/ini.core.php#ini.open-basedir)的指令，它允许限制对文件系统的访问到指定的目录树。

例如，如果您有`php.ini`：

```
open_basedir = /srv/http/:/home/:/tmp/ 
```

您将访问该文件`/filepath/filename.php`，然后您必须设置：

```
open_basedir = /srv/http/:/home/:/tmp/:/filepath/ 
```

否则 PHP 将无法访问该文件。

这样一来，这台机器上运行的**所有**PHP 代码都可以访问`/filepath/` 目录树，因此对于生产环境来说是**不安全的。**更好的方法是设置*基于*`open_basedir`. `httpd.conf`我让你检查你的 HTTP 服务器文档和[open_basedir](http://www.php.net/manual/en/ini.core.php#ini.open-basedir)文档。

# php - 回显属于mysql中用户配置文件的所有收藏夹并通过url识别用户配置文件？

> ID：14845065
> 
> 赞同：0
> 
> 时间：2013-02-13T01:36:56.340
> 
> 标签：php, mysql

嗨，有人可以帮帮我。我在他们的个人资料上呼应了用户的最爱，为了节省空间，我将查询限制在个人资料页面上的三个用户最爱/结果。

然后，我放置一个用户可以单击的超链接，以将属于该配置文件 ID 的所有用户收藏夹显示到另一个页面上。他们单击的链接回显了用户的 profile_id，然后第二个查询“get_user_favourites_more”应该回显属于他们刚刚超链接的个人资料的所有收藏夹（通过链接回显的 profile_id。）

我没有从 mysql 函数得到任何结果。profile_id 正在成功回显，因为我将 profile_id 编号放在页面标题中。它只是没有呼应属于该用户的收藏夹。

我需要以某种方式设置第二个 mysql 查询来识别属于 user_id 的收藏夹并从 url 获取 user_id？（我认为？）

有人可以告诉我如何让它做我想做的事，谢谢。

mysql查询1：

```
function get_favourites() {
            global $connection;
            global $profile_id;
            $query = "SELECT e.fav_id
                        FROM ptb_user_favourites e
                        WHERE e.user_id =\"$profile_id\"
                        AND e.approved = '1'
                        LIMIT 3";
                        $favourites_set = mysql_query($query, $connection);
            confirm_query($favourites_set);
            return $favourites_set;

        } 
```

列出前三个结果/用户最喜欢的用户配置文件：

```
<div class="prof-favourites-box2"><div class="show_more_favourites"><a href="show_all_favourites.php?to=<?php echo "$profile_id"; ?>">show all favourites ></a></div></div>
<?php
        $favourites_set = get_favourites();
        $duo_count = mysql_num_rows($favourites_set);
while ($fav = mysql_fetch_array($favourites_set)) {

    echo "<a href=\"profile.php?id={$fav['fav_id']}\"><img width=\"60px\" height=\"60px\" class=\"escort_duo_pic\" src=\"data/photos/{$fav['fav_id']}/_default.jpg\" /></a>"; 
```

显示所有收藏功能/第二个查询：

```
function get_favourites_more() {
            global $connection;
            global $profile_id;
            $query = "SELECT e.fav_id
                        FROM ptb_user_favourites e
                        WHERE e.user_id =\"$profile_id\"
                        AND e.approved = '1'";
                        $get_favourites_more = mysql_query($query, $connection);
            confirm_query($get_favourites_more);
            return $get_favourites_more;

        } 
```

我显示所有收藏页面/用户从用户个人资料链接到的页面：

```
<?php
session_start();

if (isset ($_GET['to'])) {
$user_to_id = $_GET['to'];

}

if (!isset($_GET['to']))
    exit('No user specified.');

$user_id = $_GET['to']; ?>

<?php
        $favourites_more_set = get_favourites_more();
        while ($fav = mysql_fetch_array($favourites_more_set)) {
            $date = age_from_dob($fav['dob']);

            echo"
            <div class=\"boxgrid caption\">
            <a href=\"profile.php?id={$fav['id']}\"><img width=140px height= 180px src=\"data/photos/{$fav['id']}/_default.jpg\"/></a>
            <div class=\"cover boxcaption\">
            <h58> {$fav['display_name']}, ".$date."</h58>
            </div>
            </div>";
        }
    ?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T04:17:52.187

我通常会在用户登录时使用 id 设置会话。使用它来执行所有与用户相关的搜索，例如 where session = Session_id。

但在您的情况下，您的 URL 中的个人资料 ID 似乎设置为 fav_id。虽然我个人觉得这很不正统，但我建议你做一个 $profile_id = $_GET['to']; 并且 URL 设置为 profile.php?user_id=$profile_id

让我知道它是否有效。抱歉，我还不能写评论。是否还有任何错误显示？

# ios - IOS 子视图自动调整轮帧值

> ID：14845068
> 
> 赞同：1
> 
> 时间：2013-02-13T01:37:12.607
> 
> 标签：ios, ipad

我有一个 UIImageView ，其中包含一组已动态添加到其中的子视图。每个子视图都有非常精确的帧值。即 x=114.252 y=123.642 宽度=169.323 高度=35.3234。我需要这些值是如此精确。问题是如果我将 UIImageView 设置为自动调整子视图并在每个子视图上设置调整大小掩码，然后更改 UIImageView 的框架，每个子视图的框架都包含一个四舍五入的结果。即高度变为35。

有没有办法阻止这些值被四舍五入？

谢谢

乔恩

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T01:46:25.977

您可以继承 UIImageView 并实现`layoutSubviews`在子视图上手动执行布局，而不是使用自动调整大小。当 UIImageView 的 frame 改变时，这个方法会被自动调用。

但是请记住，自动调整大小的行为是有原因的。帧不完整的视图可能无法正确显示（因为由于硬件的物理限制，显示是按像素量化的，并且一个点只有一个像素 - 或者，在双分辨率屏幕上，两个像素到一个点）。所以自动调整大小机制可能需要`NSRectIntegral()`你——最终你可能想自己调用它。

# c# - 在 Response.Redirect 上传递 JSON

> ID：14845069
> 
> 赞同：0
> 
> 时间：2013-02-13T01:37:24.260
> 
> 标签：c#, asp.net, asp.net-mvc

假设你有一个对象

```
public class SomeViewModel
    {
        public SomeViewModel()
        {
            this.SomeData = new List<SomeData>();
        }

        public string Name { get; set; }
        public string Surname{ get; set; }
        public List<SomeData> SomeData { get; set; }
    }

    public class SomeData
    {
        public string Name { get; set; }
        public string Value { get; set; }
    } 
```

现在我想将模型作为查询字符串从 ASP.NET 应用程序传递给 ASP.NET MVC 应用程序

```
string json = JsonConvert.SerializeObject(someModelVM);
//how to convert it to querystring ?
Response.Redirect("http://somedomain.com/SomeAction?redirect=" + querystring, true); 
```

所以重定向后它会正确绑定

```
public ActionResult SomeAction(SomeViewModel someViewModel)
{
//do something here
} 
```

**更新**

我选择了简单的解决方案而不是复杂的解决方案。

```
 string json = JsonConvert.SerializeObject(someModelVM);
 Response.Redirect("http://somedomain.com/SomeAction?redirect=" + json, true);

public ActionResult SomeAction(string json)
    {
        //try to deserialize json
        //security check the json
        //do stuff
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T03:55:48.073

您可以看到[此](http://ole.michelsen.dk/blog/serialize-object-into-a-query-string-with-reflection/)示例将 Class 转换为“查询字符串”

例如，对于您拥有的课程，必须是这样的：

```
Name = My name
Surname = My Surname
SomeData = [
   {
      Name = My SD0Name,
      Value = My SD0Value
   },
   {
      Name = My SD1Name,
      Value = My SD1Value
   }
]

Name=My%20name&Surname=My%20Surname&SomeData[0].Name=My%20SD0Name&SomeData[0].Value=My%20SD0Value&SomeData[1].Name=My%20SD1Name&SomeData[1].Value=My%21SD0Value 
```

那么您必须将您的网址与新文本连接起来：

```
var someViewModel = new ToQueryString { Name = "My name", ... };
var querystring = someViewModel.ToQueryString();
Response.Redirect("http://somedomain.com/SomeAction?redirect=" + querystring, true); 
```

您不需要`HttpUtility.UrlEncode`，因为扩展程序已经在处理这样做。

**编辑**@Matthew 评论。如果您有一个很大的查询字符串，您可以使用像这个列表这样的工具来压缩查询字符串，然后连接一个值：

[c-compress-and-decompress-strings](http://dotnet-snippets.com/dns/c-compress-and-decompress-strings-SID612.aspx)
[压缩-解压缩-字符串-with-c-sharp](https://stackoverflow.com/a/7343623/138071)

在这种情况下，您可以使用 Json 格式，已经将文本的 zip 发送到变量中。但是您需要更改然后接收此参数的操作：

```
Response.Redirect("http://somedomain.com/SomeAction?redirectZip=" + jsonStringZip, true); 
```

* * *

[此](http://ole.michelsen.dk/blog/serialize-object-into-a-query-string-with-reflection/)博客中的代码：

```
public static class UrlHelpers
{
    public static string ToQueryString(this object request, string separator = ",")
    {
        if (request == null)
            throw new ArgumentNullException("request");

        // Get all properties on the object
        var properties = request.GetType().GetProperties()
            .Where(x => x.CanRead)
            .Where(x => x.GetValue(request, null) != null)
            .ToDictionary(x => x.Name, x => x.GetValue(request, null));

        // Get names for all IEnumerable properties (excl. string)
        var propertyNames = properties
            .Where(x => !(x.Value is string) && x.Value is IEnumerable)
            .Select(x => x.Key)
            .ToList();

        // Concat all IEnumerable properties into a comma separated string
        foreach (var key in propertyNames)
        {
            var valueType = properties[key].GetType();
            var valueElemType = valueType.IsGenericType
                                    ? valueType.GetGenericArguments()[0]
                                    : valueType.GetElementType();
            if (valueElemType.IsPrimitive || valueElemType == typeof (string))
            {
                var enumerable = properties[key] as IEnumerable;
                properties[key] = string.Join(separator, enumerable.Cast<object>());
            }
        }

        // Concat all key/value pairs into a string separated by ampersand
        return string.Join("&", properties
            .Select(x => string.Concat(
                Uri.EscapeDataString(x.Key), "=",
                Uri.EscapeDataString(x.Value.ToString()))));
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T01:39:22.097

尝试这个：

```
string json = JsonConvert.SerializeObject(someModelVM);
Response.Redirect("http://somedomain.com/SomeAction?redirect=" + HttpUtility.UrlEncode(json), true); 
```

这使用该[`UrlEncode`方法](http://msdn.microsoft.com/en-us/library/system.web.httputility.urlencode.aspx)将您的 JSON 编码为 URL 的一部分作为查询字符串

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-13T04:37:11.887

我认为您需要`HttpUtility.ParseQueryString`为此目的使用。

检查来自[msdn的文档和来自](http://msdn.microsoft.com/en-us/library/ms150046.aspx)[Stackoverflow](https://stackoverflow.com/a/12781892/1551730)的这个线程

希望能帮助到你。

# sql - SQL Server 中的 Oracle 等效递归 OUTER APPLY

> ID：14845082
> 
> 赞同：2
> 
> 时间：2013-02-13T01:38:48.073
> 
> 标签：sql, sql-server, oracle

我有一些 SQL Server 代码要迁移到 Oracle 11g。有很多`OUTER APPLY`这样的递归语句：

```
select  a.colA
       ,bb.retB
       ,cc.retC
from tableA a

outer apply
(
select funcB(b.colB) as retB
from tableB b
where b.colA = a.colA
) bb

outer apply
(
select funcC(bb.retB, c.colC) as retC
from tableC c
where c.colB = bb.retB
) cc 
```

……

关键是OUTER APPLY block bb 依赖于a 的结果，`OUTER APPLY`block cc 依赖于`OUTER APPLY`block bb 的结果，以此类推。如何在 Oracle 数据库中重写这些结构并使它们像在 SQL Server 中一样可读？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-05-18T18:27:20.917

虽然答案在技术上是正确的，但在以下基础上是不准确的。外连接将尝试获取完全请求的数据集，然后根据连接进行过滤，而外应用将过滤器应用于正在获取的记录集，从而导致更快的查询。这对于简单的查询可能并不明显，但对于非常复杂的联接，外部应用比外部联接更有效。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-09-15T19:11:26.467

您可以使用 LEFT OUTER JOIN 而不是 OUTER APPLY，这两个功能是相同的。

```
select  a.colA
       ,bb.retB
       ,cc.retC
from tableA a

LEFT OUTER JOIN 
(
select funcB(b.colB) as retB
from tableB
) b on b.colA = a.colA
LEFT OUTER JOIN 
(
select funcC(bb.retB, c.colC) as retC
from tableC 
where 
) c on c.colB = bb.retB; 
```

# python - 参加 Python 课程并学习二分搜索，对为什么我的语义不正确感到困惑

> ID：14845083
> 
> 赞同：1
> 
> 时间：2013-02-13T01:39:04.643
> 
> 标签：python

我们的任务是编写一个代码，它会从 0 到 100 猜测一个秘密数字。这是我的一段代码：

```
low = 0
mid = 50
high = 100
secretnum = "Is your secret number " + str(mid) + "?"
print"Please think of a number between 0 and 100!"
print secretnum
herp = raw_input("Enter 'h' to indicate the guess is too high. Enter 'l' to indicate the guess is too low. Enter 'c' to indicate I guessed correctly. ")
while herp != 'c':
    if herp == 'h':
        high = mid
        mid = int((mid + low)/2)
    elif herp == 'l':
        low = mid
        mid = int((mid + high)/2)
    else:
        print"Sorry, I did not understand your input."
    print secretnum
    herp = raw_input("Enter 'h' to indicate the guess is too high. Enter 'l' to indicate the guess is too low. Enter 'c' to indicate I guessed correctly. ")
if herp == 'c':
    print "Game over. Your secret number was: " + str(mid) 
```

这是输出：

```
Is your secret number 50?
Enter 'h' to indicate the guess is too high. Enter 'l' to indicate the guess is too low. Enter 'c' to indicate I guessed correctly. h
Is your secret number 50?
Enter 'h' to indicate the guess is too high. Enter 'l' to indicate the guess is too low. Enter 'c' to indicate I guessed correctly. l
Is your secret number 50?
Enter 'h' to indicate the guess is too high. Enter 'l' to indicate the guess is too low. Enter 'c' to indicate I guessed correctly. c
Game over. Your secret number was: 37 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T01:42:16.577

对于错误将其更改为：

```
print "Game over. Your secret number was:",mid 
```

对于一遍又一遍地输出 50，`print secretnum`在 while 中更改为：

```
print "Is your secret number " + str(mid) + "?" 
```

当您`secretnum="Is your secret number " + str(mid) + "?"`在开头设置时，它会创建一个字符串，一个与 mid 完全分开的字符串。因此，如果您更改 mid，则不会在字符串中看到更改。

Python 字符串是**不可变**的，这意味着一旦创建，它们就完成了。您无法更改字符串的内容，除非完全重新制作它。什么`str(mid)`是创建一个字符串表示`mid`。在这种情况下，字符串`"50"`被创建并放入字符串中，永远不会被修改。`str(mid)`因此，当您显示一个字符串时，您需要通过再次调用来确保它显示的是最新值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-13T02:01:47.783

正如 Raufio 所指出的，Python 字符串是不可变的。要解决一遍又一遍重复 50 的问题，您需要在打印出问题时再次调用 str(mid)。例如：

```
low = 0
mid = 50
high = 100
secretnum = "Is your secret number: " 
print"Please think of a number between 0 and 100!"
print secretnum + str(mid) + "?"
herp = raw_input("Enter 'h' to indicate the guess is too high. Enter 'l' to indicate the guess is too low. Enter 'c' to indicate I guessed correctly. ")
while herp != 'c':
    if herp == 'h':
        high = mid
        mid = int((mid + low)/2)
    elif herp == 'l':
        low = mid
        mid = int((mid + high)/2)
    else:
        print"Sorry, I did not understand your input."
    print secretnum + str(mid) + "?"
    herp = raw_input("Enter 'h' to indicate the guess is too high. Enter 'l' to indicate the guess is too low. Enter 'c' to indicate I guessed correctly. ")
if herp == 'c':
    print "Game over. Your secret number was:", mid 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-13T01:47:58.567

在最后一行中，您只需输入：

`print "Game over. Your secret number was: " + str(mid)`

这是因为 python 想要确保你真的知道你在做什么——将两个字符串加在一起，而不是一个 int 和一个字符串——这是被禁止的。str() 函数只是将您给它的任何内容更改为字符串。关于您的语义问题，我认为此版本的代码具有预期的行为：

```
low = 0  
mid = 50  
high = 100  
print "Please think of a number between 0 and 100!"  
herp = 50  
while herp != 'c':  
    print "Is your secret number " + str(mid) + "?"
    herp = raw_input("Enter 'h' to indicate the guess is too high. Enter 'l' to indicate the guess is to low. Enter 'c' to indicate the guess is correct")   
    if herp == 'h':  
        high = mid  
        mid = int((mid + low)/2)  
    elif herp == 'l':  
        low = mid  
        mid = int((mid + high)/2)  
    else:  
        print"Sorry, I did not understand your input."  
if herp == 'c':  
    print "Game over. Your secret number was: " + str(mid) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-13T01:42:30.330

更改第 20 行

`print "Game over. Your secret number was: " + mid`

到

`print "Game over. Your secret number was: ", mid`

或者

`print "Game over. Your secret number was: " + str(mid)`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-13T01:43:16.223

在最后一行，您输入了`print "Game over. Your secret number was: " + mid`. 但是，`mid`是一个数字，将其添加到字符串中没有任何意义。您需要先将其转换为字符串。

有几种方法可以做到这一点。您可以将其更改为：

*   `print "Game over. Your secret number was: " + str(mid)`
    ...`mid`变成一个字符串
*   `print "Game over. Your secret number was: ", mid`
    ...这样 Python 会将字符串 和`mid`视为两个变量，并自动在它们之间添加一个空格

.

```
low = 0
mid = 50
high = 100
secretnum = "Is your secret number " + str(mid) + "?"
print"Please think of a number between 0 and 100!"
print secretnum
herp = raw_input("Enter 'h' to indicate the guess is too high. Enter 'l' to indicate the guess is too low. Enter 'c' to indicate I guessed correctly. ")
while herp != 'c':
    if herp == 'h':
        high = mid
        mid = int((mid + low)/2)
    elif herp == 'l':
        low = mid
        mid = int((mid + high)/2)
    else:
        print"Sorry, I did not understand your input."
    print secretnum
    herp = raw_input("Enter 'h' to indicate the guess is too high. Enter 'l' to indicate the guess is too low. Enter 'c' to indicate I guessed correctly. ")
if herp == 'c':
    print "Game over. Your secret number was: " + str(mid) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-16T02:47:32.400

当我构建我的代码时，我一开始遇到了同样的问题。查看您的代码后，我注意到一些错误，我将在此处突出显示它们：

1.  您没有使用 raw_input 向用户询问号码
2.  你不应该在你的时候使用'c'参数
3.  您的 while 应该出现在 raw_input 问题之后

    num = raw_input("请想一个 0 到 100 之间的数字！")

    ```
    while mid != num:
        print ( "Is your secret number " + str(mid) + "?")
        herp = raw_input("Enter 'h' to indicate the guess is too high. Enter 'l' to indicate the guess is too low. Enter 'c' to indicate I guessed correctly. ") 
    ```

在这里看到这个，你使用 while 所以它运行直到 mid 与用户选择的数字不同，打印它们非常重要，否则在你选择后你将无法看到程序的新猜测第一次猜测太低或太高。

1.  无需一遍又一遍地重复“mid = int(low + high)/2”，只需在 else 之后使用它，每次 while 循环运行时，它都会改变 mid 的值。
2.  您需要以字母“c”开始 if/elif/else 代码
3.  您可以删除“print secretnum”行和之后的行

    如果 herp == 'c'：

    ```
     break
        elif herp == 'l':
            low = mid

        elif herp == 'h':
            high = mid

        else:
            print"Sorry, I did not understand your input."
        mid = int(low + high)/2
    print "Game over. Your secret number was: " + str(mid) 
    ```

    请注意，我使用“break”来离开 while 循环，因此消息 Game over。你的密码是：" + str(mid) 被打印出来。

最终结果应如下所示：

```
low = 0
high = 100
mid = (high + low)/2

num = raw_input("Please think of a number between 0 and 100!")

while mid != num:
    print ( "Is your secret number " + str(mid) + "?")
    herp = raw_input("Enter 'h' to indicate the guess is too high. Enter 'l' to indicate the guess is too low. Enter 'c' to indicate I guessed correctly. ")

    if herp == 'c':
        break
    elif herp == 'l':
        low = mid
        #mid = int(mid + high)/2
    elif herp == 'h':
        high = mid
        #mid = int(mid + low)/2
    else:
        print"Sorry, I did not understand your input."
    mid = int(low + high)/2
print "Game over. Your secret number was: " + str(mid) 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-09-16T09:53:28.043

试试下面的代码...

```
max_num=100
min_num=0
guess = int(abs(max_num/2))
print("Please think of a number between 0 and 100!")
for i in range(min_num,max_num):
  text = "Is your secret number "+str(guess)+"?\nEnter 'h' to indicate the guess is too high. Enter 'l' to indicate the guess is too low. Enter 'c' to indicate I guessed correctly. "
  xx = raw_input(text)
  if(xx == 'h'):
    max_num = guess
    guess = int((guess + min_num)/2)
  elif(xx == 'l'):
    min_num = guess
    guess = int((guess + max_num)/2)
  elif(xx == 'c'):
    print("Game over. Your secret number was:"+str(guess))
  else:  
    print("Sorry, I did not understand your input.")
    xx = str(input(text)) 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-02-12T09:05:09.957

您不必包含`int((mid + low)/2)`在每个`if-elif`块下。这是同一练习的批准代码：

```
print("Please think of a number between 0 and 100!")
low = 0
high = 100
guess = (low + high) // 2

while True:
    print("Is your secret number " + str(guess) + "?")
    suggest = input("Enter 'h' to indicate the guess is too high. Enter 'l' to indicate the guess is too low. Enter 'c' to indicate I guessed correctly. ")
    if suggest == 'l':
        low = guess
    elif suggest == 'h':
        high = guess
    elif suggest == 'c':
        print("Game over. Your secret number was: " + str(guess))
        break
    else:
        print("Sorry, I did not understand your input.")
    guess = (low + high) // 2 
```

# arrays - 如何将 1d 索引转换为 3d 索引？

> ID：14845084
> 
> 赞同：0
> 
> 时间：2013-02-13T01:39:09.490
> 
> 标签：arrays, multidimensional-array, 3d, indexing

我看了这个问题：[Convert a 1d array index to a 3d array index?](https://stackoverflow.com/questions/11316490/convert-a-1d-array-index-to-a-3d-array-index) 但是无论我首先如何计算索引，当我测试它时，我的结果都会有所不同。

我正在使用以下内容将尺寸（宽度、高度、深度）的 3d (x,y,z) 转换为 1d：

```
i=x+WIDTH(y+HEIGHT*z) 
```

然后从索引 i 转换回 (x,y,z)：

```
z=i/(HEIGHT*WIDTH)
y=(i/WIDTH)%HEIGHT
x=i%(WIDTH) 
```

当我在两种方法之间进行测试时，我得到了错误的结果。我的方法明显有问题吗？正确的解释是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T01:47:42.960

这是一个适用于这些值的 javascript 版本：

```
WIDTH = 10;
HEIGHT = 20;

x = 2;
y = 4;
z = 5;

=> i = 1042 
```

代码：

```
i = x + WIDTH * (y + HEIGHT * z);

z = Math.round(i / (WIDTH * HEIGHT));
y = Math.round((i - z * WIDTH * HEIGHT) / WIDTH);
x = i - WIDTH * (y + HEIGHT * z); 
```

# jquery - mediaelement.js 更改皮肤

> ID：14845085
> 
> 赞同：9
> 
> 时间：2013-02-13T01:39:12.037
> 
> 标签：jquery, css, html5-audio, mediaelement.js

尽管它没有太多关于该主题的文档，但我知道在 mediaelement.js 中，您可以更改音频播放器的皮肤或修改 CSS 以创建自己的皮肤。我遇到了一个问题，我什至无法获得默认的 mediaelement.js 皮肤来替换浏览器播放器，因此我无法根据我的样式需求修改默认 CSS。当我尝试使用 mediaelement.js 在他们的网站上使用的 player.changeSkin() 方法时，它会停止程序。至少据我所知，我包含了皮肤 CSS 以及其他所需的 mediaelement.js 文件，并且它们的播放器工作正常，直到我尝试更改皮肤。我正在使用此代码流式传输音频，您可以在[http://escapetodenton.com/radio/compact-player.html](http://escapetodenton.com/radio/compact-player.html)。出于某种原因，播放器本身现在在我的 Firefox 版本中根本没有渲染，所以如果你有 chrome，或者你会更好地了解我想要做什么。

头文件中的导入文件：

```
<script src="build/jquery.js"></script>
<script src="build/mediaelement-and-player.min.js"></script>
<link rel="stylesheet" href="build/mediaelementplayer.css" />
<link rel="stylesheet" href="build/mejs-skins.css" />
<script language="javascript" type="text/javascript"src="http://premiumca5.listen2myradio.com/system/streaminfo.js"></script>
<link rel="stylesheet" href="compact-player.css" /> 
```

播放器实例化和启动：

```
var player = new MediaElement('player', {
pluginPath: '/build/',
features: ['playpause','progress','current','duration','volume'],
audioWidth: 400,
enableAutosize: false,
iPadUseNativeControls: true,
iPhoneUseNativeControls: true,
AndroidUseNativeControls: true,
success: function(player, node) {
player.changeSkin('mejs-ted');
player.play();
}
}); 
```

由于我找不到有关 changeSkin() 方法的任何文档，我只是以与 mediaelement.js 在其主页代码中使用它的方式相同的方式使用它。任何帮助或想法将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-09-30T17:56:59.630

您需要做的是添加`class="mejs-ted"`视频元素。changeSkin() 函数用于动态交换皮肤。即：您想提供用户可以在其之间切换的多个皮肤。

所以你的视频标签应该添加你的类，看起来像这样：

```
<!-- replace mejs-ted with mejs-yourclass -->
<video class="mejs-ted" ...>
    <source type="video/mp4" src="....">
    <source type="video/ogg" src="....">
    <!-- etc.. -->
</video> 
```

Mediaelement 会自动检查视频元素上的类属性，并将该类添加到父容器中，以便可以通过前缀 .mejs-yourclass 覆盖所有 DOM 元素

如果您只想更改默认皮肤设置，则该类可以正常工作。mejs-skins.css 为您需要覆盖的所有样式提供示例 CSS，以便对其进行不同的皮肤处理。唯一缺少的是 bigplay 按钮的样式：

```
/* overlay bigplay */
.mejs-yourclass .mejs-overlay-button {
    position: absolute;
    top: 50%;
    left: 50%;
    width: 100px;
    height: 100px;
    margin: -50px 0 0 -50px;
    background: url(bigplay.png) no-repeat;
}

.mejs-yourclass .mejs-overlay:hover .mejs-overlay-button {
    background-position: 0 -100px;
} 
```

您会从 git 中找到工作示例：[https ://github.com/johndyer/mediaelement/blob/master/demo/mediaelementplayer-skins.html](https://github.com/johndyer/mediaelement/blob/master/demo/mediaelementplayer-skins.html)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-27T08:33:54.547

也许这篇关于 InsertHTML 的文章[http://www.inserthtml.com/2013/03/custom-html5-video-player/](http://www.inserthtml.com/2013/03/custom-html5-video-player/)应该可以帮助您解决问题。

它使用 mediaelement.js 来设计带有 HTML5 和 JavaScript 的自定义 CSS3 视频播放器。

# php - Pinger 的 OAuth 问题

> ID：14845089
> 
> 赞同：1
> 
> 时间：2013-02-13T01:39:26.303
> 
> 标签：php, curl, oauth

所以这就是我目前所拥有的，我正在尝试使用 PHP/cURL 制作一个脚本，该脚本将登录到 Pinger TextFree Web 服务。

我不知道我错过了什么，我没有看到 OAuth 的 HTTP 事务。我已经阅读了一些关于它的内容，但我仍然迷路了。

有什么建议么？

```
function sendRequest($url, $postorget, $fields = array(), $proxy)
{

$cookie_file = "cookies.txt";

//Initiate connection
$ch = curl_init();

curl_setopt($ch, CURLOPT_HTTPHEADER, $header); // set url
//curl_setopt($ch, CURLOPT_HEADER, false);
curl_setopt($ch, CURLOPT_URL, $url); // set url
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1); // return the transfer
curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false); // allow https
curl_setopt($ch, CURLOPT_USERAGENT, 'Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; .NET CLR 1.1.4322)'); // random agent
curl_setopt($ch, CURLOPT_FOLLOWLOCATION, 1); // automatically follow Location: headers (ie redirects)
curl_setopt($ch, CURLOPT_AUTOREFERER, 1); // auto set the referer in the event of a redirect
curl_setopt($ch, CURLOPT_MAXREDIRS, 5); // ibm likes to redirect a lot, make sure we dont get stuck in a loop
curl_setopt($ch, CURLOPT_COOKIEJAR, $cookie_file); // file to save cookies in
curl_setopt($ch, CURLOPT_COOKIEFILE, $cookie_file); // file to read cookies from
curl_setopt($ch, CURLOPT_CONNECTTIMEOUT, 40); //timeout time for curl

//Check to see if a proxy is being used
if(isset($proxy)){
    //Tell cURL you're using a proxy
    curl_setopt($ch, CURLOPT_PROXYTYPE, CURLPROXY_SOCKS5);
    //Set the proxy
    curl_setopt($ch, CURLOPT_PROXY, $proxy); 
}

//Check if request is POST or GET
if ($postorget == "post" OR $postorget == "POST")
{
    curl_setopt($ch, CURLOPT_POST, true); // use POST
    if (is_array($fields)){
        curl_setopt($ch, CURLOPT_POSTFIELDS, http_build_query($fields)); // key => name gets turned into &key=name
    } else {
        curl_setopt($ch, CURLOPT_POSTFIELDS, $fields); // &key=name passed in
    }
} else { 
    curl_setopt($ch, CURLOPT_POST, false); // use GET
}

$content = curl_exec($ch); // return html content
$info = curl_getinfo($ch); // return transfer info
$error = curl_error($ch);  // return any errors

curl_close($ch);

$request = array('content' => $content,
         'error' => $error,
     'info' => $info);

return $request;            
}
    //Login details
$username = "usernaem";
$password = "password";

//GET the initial login page
$initFields = "";
$initOutput = sendRequest("http://www.pinger.com/tfw/?t=1360619019053", "GET", $initFields);

echo "<textarea cols='100' rows='400'>";
print_r($initOutput);
echo "</textarea>";

//Login to pinger
$loginFields = "{\"username\":\"".$username."\",\"password\":\"".$password."\",\"clientId\":\"textfree-in-flash-web-free-1360619009-8CA1C5C1-38ED-2E31-3248-CB367450A20F\"}";
$loginOutput = sendRequest("https://api.pinger.com/1.0/web/login", "POST", $loginFields);

echo "<textarea cols='100' rows='400'>";
print_r($loginOutput);
echo "</textarea>"; 
```

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2013-02-14T04:10:34.957

我们注意到在 PHP/cURL 脚本中提到了用户名的这一部分。

请检查这部分代码：

```
 //Login details 
```

$用户名 = "用户名"; $password = "密码";

您会注意到指定**用户名**的部分拼写错误

> 用户名

请尝试更正此错误，这应该可以解决您的问题。

# assembly - 汇编新手，是否有“通用汇编代码”之类的东西？

> ID：14845096
> 
> 赞同：0
> 
> 时间：2013-02-13T01:39:54.033
> 
> 标签：assembly, masm, masm32

我是汇编新手（更习惯于使用 C#），但我决定看看我是否可以学习它并更多地了解我的计算机在引擎盖下的作用。

我的问题是，在 Windows 上编程时，我必须使用 win32 库吗？例如，如果我想在控制台窗口中输出“A”，是否有“通用”方法可以做到这一点，还是必须调用 win32？还是我完全不知道它是如何工作的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T01:45:15.037

除非您需要 Win32 所具备的功能，否则您不必使用 Win32。例如，我认为没有比 Win32 更原始的级别来执行诸如输出到控制台之类的操作。

# excel - Excel：基于从多个下拉菜单中选择的输出

> ID：14845099
> 
> 赞同：0
> 
> 时间：2013-02-13T01:40:22.380
> 
> 标签：excel

我想根据几个下拉菜单的选择在 Excel 中输出多个选项之一。

例如，根据一个人的年龄、性别和体型从多个选项中选择特定的衬衫设计，这三个变量可以从三个下拉菜单中选择，假设我有一个矩阵来找出适当的选项如下：

![选项矩阵](../Images/ac0afe99123ce10ead33661063d23040.png)

Excel 中是否有我可以用来实现此目的的函数？还是我必须使用 Visual Basic？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T09:19:19.740

这里不需要 VBA，你只需要一些辅助逻辑和 INDEX/MATCH 公式：

1.  选项必须是唯一的，并且每行每个选项组只有一个元素。在您的示例中，这意味着您需要拆分选项 5、6 和 9，因为它们每个都有多个年龄组 - 请参见黄线：
    ![在此处输入图像描述](../Images/960200d590e44e3f09c77e795975c2eb.png)

2.  您需要以某种方式对您的选项进行编码，例如 0-4=4、5-9=9、10-14=14、Male = M 等。然后您可以将每个选项翻译成一个唯一的 3 字母文本，例如选项 1 将是`4ML`。在以下示例中，使用以下公式在单元格 J3 中构造 ID：

    ```
    =INDEX($B$1:$D$1,MATCH("x",B3:D3))&INDEX($E$1:$F$1,MATCH("x",E3:F3))&INDEX($G$1:$ I$1,MATCH("x",G3:I3))
    ```

    ![在此处输入图像描述](../Images/3536e403f81f44e3c811c166dabb2d8f.png)
3.  您还需要将下拉菜单中的选择转换为代码。黄色单元格的公式为：

    ```
    =INDEX($B$1:$D$1,MATCH(M1,$B$2:$D$2,0))
    &INDEX($E$1:$F$1,MATCH(M2,$E$2:$F$2,0))
    &INDEX($G$1:$I$1,MATCH(M3,$G$2:$I$2,0))

    ```

    ![在此处输入图像描述](../Images/0ad0391490f0149b15a2af85f792c987.png)
4.  现在您只需使用以下公式将代码转换为选项：

```
=IFERROR(INDEX($A$3:$A$16,MATCH(M4,$J$3:$J$16,0)),"此选择没有选项！")

```

请注意，如果所选选项不可用，这将显示一个小文本。

为了更好地理解，您可以在[此处找到示例文件](https://mega.co.nz/#!Wcw2nIwS!Ft6NC0btf_-u9Wk1jsKq22A7tls-FQs-xOuM0olNiso)。

# javascript - HTML5/Javascript - 我的用户触发的画布动画断断续续

> ID：14845102
> 
> 赞同：2
> 
> 时间：2013-02-13T01:40:26.400
> 
> 标签：javascript, html5-canvas

我有一个简单的概念。当玩家按下 W、A、S 或 D 时，画布上的图像会相应移动。但是，这会导致动画非常不稳定，我不确定为什么（尽管我认为这与我的事件侦听器有关）。下面是我的代码。

```
var playerXPos = 10;
var playerYPos = 10;
var playerImg = new Image();
playerImg.src = "knight.png";

function mainGameLoop(){
    window.requestAnimationFrame(mainGameLoop);
    c = document.getElementById("gameCanvas").getContext("2d");

    c.clearRect(0,0,1000,500);

    c.drawImage(playerImg,playerXPos,playerYPos);
}
window.requestAnimationFrame(mainGameLoop);

    window.addEventListener("keydown", onKeyDown, false);
    window.addEventListener("keyup", onKeyUp, false);
    window.addEventListener("keypress", onKeyPress, false);

    function onKeyDown(e){
        var keyCode = e.keyCode;
        switch(keyCode){
            case 87: //w
                onKeyW();
            break;
            case 65: //a
                onKeyA();
            break;
            case 83: //s
                onKeyS();
            break;
            case 68: //d
                onKeyD();
            break;
        }

function onKeyW(){
    playerYPos -= 5;
}
function onKeyA(){
    playerXPos -= 5;
}
function onKeyS(){
    playerYPos += 5;
}
function onKeyD(){
    playerXPos += 5;
} 
```

为什么要这样做？任何帮助表示赞赏！

**编辑：**作为旁注，我在使用布尔值之前已经这样做了（当按下 w 键时，`keyW`变量变为真，并且在 mainGameLoop 中有`if(keyW == true){playerYPos -= 5;}`）

**[提琴手](http://jsfiddle.net/7dNtu/3/)**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T02:32:53.253

给你：[jsFiddle](http://jsfiddle.net/phoenecke/7dNtu/4/)

您不想更改每个关键事件的位置。此外，您需要考虑帧之间的时间。每帧添加任何静态量总是会很跳跃，因为一帧可能距离上一帧有 30 毫秒，也可能是 60 毫秒，这取决于许多因素。

```
var playerXPos = 10;
var playerYPos = 10;
var playerSpeed = 0.3; // this is in pixels per ms

var aPressed = false;
var wPressed = false;
var sPressed = false;
var dPressed = false;
var lastTime = null;
function mainGameLoop(timestamp) {
    var delta = timestamp - (lastTime || timestamp);

    if(aPressed){
        playerXPos -= playerSpeed * delta;
    }
    if(dPressed){
        playerXPos += playerSpeed * delta;
    }
    if(wPressed){
        playerYPos -= playerSpeed * delta;
    }
    if(sPressed){
        playerYPos += playerSpeed * delta;
    }

    window.requestAnimationFrame(mainGameLoop);
    c = document.getElementById("gameCanvas").getContext("2d");

    c.clearRect(0, 0, 1000, 500);
    player();
    lastTime = timestamp;
}
window.requestAnimationFrame(mainGameLoop);

function player() {
    var playerImg = new Image();
    //playerImg.src = "knight.png";
    c.fillRect(playerXPos, playerYPos,100,100);
}

function onKeyW(pressed) {
    wPressed = pressed;
}

function onKeyA(pressed) {
    aPressed = pressed;
}

function onKeyS(pressed) {
    sPressed = pressed;
}

function onKeyD(pressed) {
    dPressed = pressed;
}

window.addEventListener("keydown", onKeyDown, false);

function onKeyDown(e) {
    var keyCode = e.keyCode;
    switch (keyCode) {
        case 87:
            //w
            onKeyW(true);
            console.log("bro");
            break;
        case 65:
            //a
            onKeyA(true);
            break;
        case 83:
            //s
            onKeyS(true);
            break;
        case 68:
            //d
            onKeyD(true);
            break;
    }
}

window.addEventListener("keyup", onKeyUp, false);

function onKeyUp(e) {
    var keyCode = e.keyCode;
    switch (keyCode) {
        case 87:
            //w
            onKeyW(false);
            console.log("bro");
            break;
        case 65:
            //a
            onKeyA(false);
            break;
        case 83:
            //s
            onKeyS(false);
            break;
        case 68:
            //d
            onKeyD(false);
            break;
    }
} 
```

# jquery - 通过点击或 URL 链接将不同的内容加载到单个 div 中

> ID：14845104
> 
> 赞同：1
> 
> 时间：2013-02-13T01:40:36.047
> 
> 标签：jquery, html, hyperlink, modal-dialog

我有一个 html 页面（例如 index.html），它有 10 个链接 10 个位置，每次用户单击任何链接时，不同类型的内容都必须动态加载到单个 div 中。该 div 必须放置在 jquery modal.the div 实际上仅在该 html 页面内（index.html），但 div 内容根据用户单击 URL 以模态加载。我怎样才能实现这一点？我是 jquery 和 javascript 的新手。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T01:57:39.827

Try something like this:

**HTML**

```
<div id="dialog-modal" title="Basic modal dialog">
  <p>Adding the modal overlay screen makes the dialog look more prominent because
  it dims out the page content.</p>
</div>

<div id="somedivwithcontent1" style="display:none">
   Text to put into the modal dialog.
</div> 
```

**JS**

```
 var link = 1; //get from clicked link
  $( "#dialog-modal p" ).html( $('#somedivwithcontent'+link).html() );
  $( "#dialog-modal" ).dialog({
    height: 140,
    modal: true
  }); 
```

This code will get the content of the `#somedivwithcontent` divs and place it into the paragraph of the modal dialog. Should achieve what you wanted.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T01:53:45.603

我能想到的最简单的方法是使用[jQuery .load()](http://api.jquery.com/load/)函数。它使用起来非常简单，它在选择器上运行，并将使用 HTML 页面的子集加载所选元素。因此，如果您的 div 名为“fred”，并且您希望将另一个页面上名为“bob”的 div 中的文本放入名为 fred 的 div 中，则可以使用如下内容：

$('#fred').load(' [http://alice.com/carol.html](http://alice.com/carol.html) #bob');

它在链接页面上有很好的记录。

# java - JLabel 调整 JPanel 的大小

> ID：14845106
> 
> 赞同：0
> 
> 时间：2013-02-13T01:40:57.150
> 
> 标签：java, swing, jpanel, jlabel

我想制作一个带有文本栏、进度条之类的状态栏。然而，事情正在扼杀。

起初我只有文本栏，状态栏如下例所示（我不需要父容器）：

```
import java.awt.BorderLayout;
import java.awt.Dimension;

import javax.swing.BorderFactory;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JPanel;
import javax.swing.SwingUtilities;

public class Main
{   
    public static void main(String[] args)
    {           
        //Display actual GUI
        SwingUtilities.invokeLater(new Runnable()
        {
            @Override
            public void run()
            {
                new Gui();
            }
        });
    }
}

class Gui
{   
    public Gui()
    {   
        JFrame masterWindow = new JFrame();

        masterWindow.setSize(1100, 800);
        masterWindow.setMinimumSize(new Dimension(400, 400));
        masterWindow.setLocationRelativeTo(null);
        masterWindow.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

        JPanel rootPanel = new JPanel();
        rootPanel.setLayout(new BorderLayout());

        StatusBar statusBar = new StatusBar();
        rootPanel.add(statusBar, BorderLayout.SOUTH);

        masterWindow.setContentPane(rootPanel);
        masterWindow.setVisible(true);
    }
}

class StatusBar extends JLabel
{
    private static final long serialVersionUID = 1L;

    StatusBar()
    {   
        super("welcomeText");
        add(textBar);

        setOpaque(true);
        setBorder(BorderFactory.createLoweredSoftBevelBorder());
    }
} 
```

这可以正常工作。但是，请记住状态栏的高度。现在，如果将 StatusBar 类更改为下面的类，高度将几乎翻倍。为什么会这样？

这种设置并不需要更多的垂直空间：

```
public class StatusBar extends JPanel
{
    private static final long serialVersionUID = 1L;

    StatusBar()
    {
        super();

        JLabel textBar = new JLabel(Main.language.getString("welcomeText"));
        add(textBar);

        setOpaque(true);
        setBorder(BorderFactory.createLoweredSoftBevelBorder());
    }
} 
```

为什么会发生这种情况，我该如何阻止它？

编辑： BorderLayout 确实有效，但我想使用 MigLayout。

我想通了，但现在又出现了另一个问题。额外的进度条不会停靠在东边，分隔符甚至不可见。

这是代码：

```
public class StatusBar extends JPanel
{
    private static final long serialVersionUID = 1L;
    JLabel textBar;
    JProgressBar progressBar;

    StatusBar()
    {
        setLayout(new MigLayout("insets 0, gap 0!")); //Mig has some gaps inbetween components, this will remove the gaps

        textBar = new JLabel(Main.language.getString("welcomeText"));

        progressBar = new JProgressBar(0, 100);

        JSeparator separator = new JSeparator(SwingConstants.VERTICAL);

        add(textBar);
        add(separator);
        add(progressBar, "east");

        setOpaque(true);
        setBorder(BorderFactory.createLoweredSoftBevelBorder());
    }
} 
```

我可以提出一个新问题，但我认为这不值得......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T01:54:30.650

将布局设置`JPanel`为`BorderLayout`

```
 class StatusBar extends JPanel
    {
        private static final long serialVersionUID = 1L;

        StatusBar()
        {
            super();
            this.setLayout(new BorderLayout());  //set layout
            JLabel textBar = new JLabel(Main.language.getString("welcomeText"));
            add(textBar);

            setOpaque(true);
            setBorder(BorderFactory.createLoweredBevelBorder());
        }
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T02:04:56.083

这是因为，调用 super() 将执行超类的无参数构造函数，在你的例子中是 JPanel。根据 javadoc

> `JPanel()`- 创建一个具有双缓冲区和流布局的新 JPanel。

因此，当您调用 时`super()`，会创建一个带有的 JPanel `FlowLayout`。

尝试将布局更改为`BorderLayout`

# unit-testing - 如何减少 specs2 中的故障显示

> ID：14845109
> 
> 赞同：2
> 
> 时间：2013-02-13T01:41:26.977
> 
> 标签：unit-testing, scala, testing, specs2

我正在尝试使用 specs2 比较两个非常大的数组。不幸的是，当数组不相等时，它会在实际和预期下显示每个数组的内容。无论如何，我可以减少为实际和预期显示的数据量，或者仅针对此特定测试将其完全删除。

我试过使用 setMessage 但这不会影响实际和预期的部分。

```
bytes1 must be_== (bytes2).setMessage("A does not mach B") 
```

我实际上想要做的是比较两个输入流。我也很想知道是否有人对如何做到这一点而不是将它们转换为数组有更好的想法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T05:12:00.890

您可以通过实现自己的[`Diffs`](http://etorreborre.github.com/specs2/guide/org.specs2.guide.Runners.html#Diffs)trait 来控制如何处理差异：

```
import org.specs2._
import main._

class MyDiffs extends Diffs {
  /** @return true if the differences must be shown */
  def show: Boolean = true
  /** @return true if the differences must be shown for 2 different strings */
  def show(expected: String, actual: String): Boolean = 
    expected.size + actual.size < 100
  /** @return the diffs */
  def showDiffs(expected: String, actual: String): (String, String) = 
    (expected.take(10).mkString, actual.take(10).mkString)
  /** @return true if the full strings must also be shown */
  def showFull: Boolean = false
  /** this method is not used and will be removed from the trait in a next release */
  def separators: String = ""  
}

class s extends Specification { def is = 
  args.report(diffs = new MyDiffs)^
  "test" ! {
    "abcdefghijklmnopqrstu" must_== "abcdefghijklmnopqrstuvwxyz"
  }
}

x test
'abcdefghijklmnopqrstu' is not equal to 'abcdefghijklmnopqrstuvwxyz' (<console>:47)
 Expected: qrstuvwxyz
 Actual:   lmnopqrstu 
```

# html - 主体元素右侧的间隙，宽度为 100%

> ID：14845110
> 
> 赞同：2
> 
> 时间：2013-02-13T01:41:28.247
> 
> 标签：html, css, overflow, responsive-design

[我在http://michaelscottweb.com](http://michaelscottweb.com)有一个站点，当浏览器高于约 450 像素时，该站点具有 100% 宽度的容器和元素。当您将浏览器缩小到 980px 以下并向右滚动时，主体上会出现大约 20px 的间隙。当您查看高于该分辨率的网站时，不会发生这种情况。有谁知道什么时候会导致这种情况发生变化？

![在此处输入图像描述](../Images/db5afefa13db73572ad1ca649f2e6020.png)

css。

```
body {
    line-height: 1;
    overflow-x:hidden;
    max-width:100%;
    -moz-font-smoothing: antialiased;
    -webkit-font-smoothing: antialiased;
    background: #fff;
    color: #555;
    font-family: 'EBGaramondRegular';
    font-size: 15px;
    font-smoothing: antialiased;
    line-height: 1.5em;
    text-rendering: optimizeLegibility;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T01:44:31.877

看来你修好了。我要说你可能需要一个css重置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T02:03:54.677

看起来它是由 google plus 按钮引起的，如果您选择全部（command + a），您会看到 google plus 按钮上的轮廓突出在标题的右侧。

# java - 以正确的方式将私有变量传递给 main()？

> ID：14845113
> 
> 赞同：-3
> 
> 时间：2013-02-13T01:41:45.777
> 
> 标签：java

这是我的代码：

```
public class Test  {
    private static int NN;

    public Test (int N) {
       NN = N;
    }  

   public static void main(String[] args)  {
       Test t = new Test (N);
       int l = NN;
       for (i = 0; i < l; i++) {
           // do my loop
       }
   }
} 
```

我想要做的是从构造函数中获取“N”并将其传递给我可以在 main() 中使用的变量但是：

a）如果我这样做，我会收到一个 findbugs 警告：

```
M D ST_WRITE_TO_STATIC_FROM_INSTANCE_METHOD ST: Write to static field... 
```

b）如果我*不*使“NN”静态，它就不会编译。

c）如果我为我的私有变量（NN）编写一个 getter/setter，我会破坏 api。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T01:48:12.777

main() 是程序的入口点。JVM调用时还没有Test类型的对象，所以构造函数还没有被调用，这就是为什么main()是静态的，为什么它要访问的任何字段也必须是静态的。

您要解决的问题是什么？N是什么，它从哪里来？

如果它来自命令行，那么您会在 args 数组中找到它作为字符串。然后，您需要将其转换为整数（如果您不关心错误处理，则 Integer.valueOf() 是合适的），然后使用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T01:52:40.793

萤火虫警告`Write to static field...`，因为您在构造函数中分配`static`变量`NN`，修复它使用：

```
public Test (int N) {
   Test.NN = N;
} 
```

如果你不想`setter/getter`为你的`NN`变量写；考虑使用`reflection`在运行时访问它

# javascript - Shopify，TypeError：$(...).jcarousel 不是函数

> ID：14845115
> 
> 赞同：1
> 
> 时间：2013-02-13T01:42:00.703
> 
> 标签：javascript, jquery, css, shopify, jcarousel

因此，我已经看到了具有相同标题的其他问题，并且我认为我遇到的问题与他们遇到的相同（特别是因为我没有使用 Drupal，并且文件似乎确实在页眉中加载，如下所示）。我知道它找不到该功能，但我不知道为什么。这是 theme.liquid 头中的代码，用于设置 javascript 和样式：

```
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <link rel="canonical" href="{{ canonical_url }}" />

  {% assign maxmeta = 155 %}
  {% if template contains 'product' %}
  <meta name="description" content="{{ product.description | strip_html | strip_newlines | truncate: maxmeta | escape }}" />
  {% elsif template contains 'page' %}
  <meta name="description" content="{{ page.content | strip_html | strip_newlines | truncate: maxmeta | escape }}" />
  {% elsif template == 'index' and shop.description != '' %}
  <meta name="description" content="{{ shop.description }}" />
  {% endif %}

  {{ 'skinCustom.css' | asset_url | stylesheet_tag }}
  {{ 'jquery-1.4.2.min.js' | asset_url | script_tag }}
  {{ 'jquery.jcarousel.min.js' | asset_url | script_tag }}

  {% if template == 'index' %}
   <title>{{ shop.name }}</title>
  {% elsif template == '404' %}
    <title>Page Not Found | {{ shop.name }}</title>
  {% else %}
   <title>{{ page_title }} | {{ shop.name }}</title>
  {% endif %}

  {% include 'fb-open-graph' %}

  {% case settings.header_font %}
  {% when "Rancho, cursive" %}
    <link href='http://fonts.googleapis.com/css?family=Rancho' rel='stylesheet' type='text/css'>
  {% when "'Amatic SC', cursive" %}
    <link href='http://fonts.googleapis.com/css?family=Amatic+SC:700' rel='stylesheet' type='text/css'>
  {% when "'Sancreek', cursive" %}
    <link href='http://fonts.googleapis.com/css?family=Sancreek' rel='stylesheet' type='text/css'>
  {% when "'Ubuntu Condensed', sans-serif" %}
    <link href='http://fonts.googleapis.com/css?family=Ubuntu+Condensed' rel='stylesheet' type='text/css'>
  {% endcase %}

  {{ 'style.css' | asset_url | stylesheet_tag }}{% if template contains 'product' and settings.main_image_display == 'Lightbox' %}
  {{ 'jquery.fancybox-1.3.4.css' | asset_url | stylesheet_tag }}{% endif %}
  {{ 'modernizr.js' | asset_url | script_tag }}
  {{ 'option_selection.js' | shopify_asset_url | script_tag }}

  {% if template contains 'customers' %}
    {{ "shopify_common.js" | shopify_asset_url | script_tag }}
    {{ "customer_area.js"  | shopify_asset_url | script_tag }}
  {% endif %}

    <script type="text/javascript">

    $(document).ready(function() {
        $('#mycarousel').jcarousel({ vertical: true, scroll: 1, start: 3 });
    });

    </script>

  {{ '//ajax.googleapis.com/ajax/libs/jquery/1.7/jquery.min.js' | script_tag }}

  {{ content_for_header }} 
```

当页面呈现时，我得到以下信息（我编辑了与这个问题无关的额外内容）。我把箭头指向了 jcarousel 所依赖的 js 和样式页面的引用。在我尝试将它移到 Shopify 项目之前，我在一个单独的文件中工作了一个示例。

```
<head>
  <meta charset="UTF-8">

  --> <link href="http://cdn.shopify.com/s/files/1/0212/5406/t/1/assets/skinCustom.css?241" rel="stylesheet" type="text/css"  media="all"  />
  --> <script src="http://cdn.shopify.com/s/files/1/0212/5406/t/1/assets/jquery-1.4.2.min.js?241" type="text/javascript"></script>
  --> <script src="http://cdn.shopify.com/s/files/1/0212/5406/t/1/assets/jquery.jcarousel.min.js?241" type="text/javascript"></script>

  <link href="http://cdn.shopify.com/s/files/1/0212/5406/t/1/assets/style.css?241" rel="stylesheet" type="text/css"  media="all"  />
  <script src="http://cdn.shopify.com/s/files/1/0212/5406/t/1/assets/modernizr.js?241" type="text/javascript"></script>
  <script src="http://cdn.shopify.com/s/shopify/option_selection.js?aaf2a68ed9671e345bbc7eef1e63563c51bde6eb" type="text/javascript"></script>

    <script type="text/javascript">

    $(document).ready(function() {
   ERROR HERE -->    $('#mycarousel').jcarousel({ vertical: true, scroll: 1, start: 3 });
    });

    </script>

  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.7/jquery.min.js" type="text/javascript"></script>

<link rel="stylesheet" href="/global/theme-controls.css" type="text/css" />

</head> 
```

我能想象的唯一可能发生的事情是其他脚本文件之一搞砸了。但是除了取出其他脚本文件之外，我不确定如何调试它。如果有人遇到类似的问题或对此有一些见解，我将不胜感激。除了不正确的实现（比如不考虑那个脚本），其他问题似乎都没有得到答案。我可能在做一些愚蠢的事情，但我已经研究过很多次，但我看不出它是什么。

谢谢，

艾伦

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T03:30:00.040

我正在将我的评论从上面写成回复表格。

这有两个问题。首先，您要加载 jQuery 两次。不要那样做。其次，jQuery 的使用`$`可能会与其他 javascript 库发生冲突，因此您应该使用`jQuery`或使用 jQuery 的[noconflict 模式。](http://api.jquery.com/jQuery.noConflict/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T02:05:55.297

正如@gaoshan88 评论的那样，我两次加载jquery。因为当我最初只添加 jcarousel.js 脚本时，它说没有 jquery 文件。所以我自己又加了一遍，不知道shopify还通过google.apis添加了最新版本。不太清楚为什么它首先用 jquery 给了我这个错误，但是当我取出 google.apis 脚本引用时它起作用了。感谢您的快速回复，我很感激。

# xcode - 是否可以明确定义在 Xcode 中针对其发出弃用警告的 SDK？

> ID：14845121
> 
> 赞同：0
> 
> 时间：2013-02-13T01:42:40.177
> 
> 标签：xcode, warnings

我有一大堆源代码，用于具有许多不同应用程序目标的项目中。有些目标的部署目标是 iOS 5.0，有些目标的部署目标是 iOS 6.0。在构建 6.0 目标时，我收到大量从 6.0 起已弃用的方法的弃用警告。这些方法中的大多数都有在 iOS 6.0 中引入的替换，因此我不能将替换用于针对 5.0 的代码。虽然我可以使用这两个构建设置关闭所有弃用警告：

GCC_WARN_ABOUT_DEPRECATED_FUNCTIONS = NO CLANG_WARN_DEPRECATED_OBJC_IMPLEMENTATIONS = NO

我宁愿不完全关闭它们。相反，我希望能够明确告诉编译器检查从 iOS 5.0 开始不推荐使用的任何内容。这可能吗？有没有人有一个很好的解决这个问题的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T23:33:59.083

您可以使用`#pragma clang diagnostic`. 例如：

```
#pragma clang diagnostic push
#pragma clang diagnostic ignored "-Wdeprecated-declarations"

// Stuff that uses deprecated methods

#pragma clang diagnostic pop 
```

# meteor - 如何抽象处理集合的代码

> ID：14845128
> 
> 赞同：2
> 
> 时间：2013-02-13T01:43:33.467
> 
> 标签：meteor

我有几个不同的视图（客户端代码），我需要插入/更新我的集合。我不想让重复的代码处理插入/更新，而是将其提取到一个单独的文件中，该文件的功能可全局访问。

我已经看到了几个使用构造 Meteor.methods 完成此操作的示例。不是所有 Meteor.methods 都在服务器上执行吗？这对延迟补偿有何影响？有一个更好的方法吗？或者这是目前可以接受的方式来实现这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T02:53:49.233

我会将它们放在一个方法中，但将该方法公开给客户端。换句话说，不要把它放在`server`目录中，也不要用`if (Meteor.isServer)`. `collections`我更喜欢在客户端和服务器都加载的目录中定义我的所有集合及其方法。如果客户端有一个方法的定义，这称为存根。有了这些信息，我鼓励您重新阅读[文档](http://docs.meteor.com/#meteor_methods)的方法部分。简短的版本是由于延迟补偿，代码将在客户端和服务器上并行运行。您可以通过在定义中添加一个 simple 来验证这一点`console.log`（它会在调用时打印到浏览器控制台和命令控制台）。要更花哨地使用存根，您可以看到[这个](http://www.eventedmind.com/posts/meteor-methods)视频。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-13T13:29:32.460

在我这边，我使用以下结构：

```
/common/collections/[each collection gets a file where it is defined]
/common/models/[each collection gets a model file where the model is defined] 
```

这样我就可以在客户端和服务器上尽可能多地重用代码

我使用 CoffeeScript 来创建类，但你可以用纯 Javascript 做同样的事情。

我的模型构造函数接受属性散列（meteor object），然后它可以封装我的方法。

*OffTopic #1：作为奖励，我的模型扩展了一个我命名为“MeteorModel”的超级对象，我在其中放置了模型之间的共享代码。*

*OffTopic #2：我还将允许和拒绝逻辑放在这些模型中，以便我可以从客户端或服务器端执行任意验证。非常有用，因为我还没有找到更好的方法来模拟对象修改而无需在普通 Meteor 中实际修改它。*

I prefer not to work directly with Meteor.Collections and write my code on the side as it is still unclear how Meteor will evolve and I want room to changed my approach when it does.

# mysql - 在mysql中选择一个字符串作为日期

> ID：14845129
> 
> 赞同：0
> 
> 时间：2013-02-13T01:43:35.993
> 
> 标签：mysql, database, date

我有一个 mysql 表，它以字符串格式存储日期，我想选择日期作为日期时间。我用 STR_TO_DATE() 和 DATE_FORMAT 都试过了，但没有用。

我的日期保存为 02/10/2013 00:00 我想要的是选择这个字符串作为日期，以便我可以使用比较。

这是我尝试过的：

```
SELECT meta_value  FROM `wp_postmeta` WHERE STR_TO_DATE(meta_value,'%d/%M/%Y %H:%i' ) > NOW() AND meta_key='project_end' 
```

由于某种原因 STR_TO_DATE(meta_value,'%d/%M/%Y %H:%i' ) 返回 NULL。如果有人能找出问题所在，那就太好了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T01:48:45.317

`%M`（大写字母 m）是月份名称（即 May/October/等）。尝试`%m`改用，例如：

```
SELECT meta_value  
FROM `wp_postmeta` 
WHERE STR_TO_DATE(meta_value,'%d/%m/%Y %H:%i' ) > NOW() 
AND meta_key='project_end' 
```

# ruby-on-rails - Ruby Rake 中的变量和符号之间有什么联系？

> ID：14845131
> 
> 赞同：0
> 
> 时间：2013-02-13T01:43:58.030
> 
> 标签：ruby-on-rails, ruby, rake, symbols

我是 Ruby 编程的新手，但我想我或多或少明白了符号的意义（一个不可变的值，占用更少的空间，有点像枚举等）这就是困扰我的问题——来自 Rake 测试Hartl Ruby on Rails 教程：

```
describe "something" do
  let(:user) { FactoryGirl.create(:user) } 
  before { sign_in user }
...
end 
```

这对我来说是有意义的`FactoryGirl.create(:user)`——这里我们将一种标志 ( `:user`) 传递给 FactoryGirl，以告诉它要制作什么样的对象（或者更准确地说，要设置什么变量，因为它只创建 User 对象）。但是 in `let(user)`,`user`是一个变量，而不是一个符号（或者至少应该是）。我只能假设该`let`方法正在秘密地将符号换成`:user`同名变量——但为什么呢？不是`let(user)`更直观的语法吗？我在这里想念什么？

此外，在 Ruby 中还有其他地方出现这种模式吗？到目前为止，我只在 rake 测试中看到过它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T03:34:20.893

就像 Dave 已经提到的，提供的代码不是 rake 任务，而是 RSpec 规范。

但让我在这里关注真正的问题。

如果您从未接触过具有类似功能的任何其他语言，则符号一开始有点难以掌握。一些语言称它为 Atom。

[http://en.wikipedia.org/wiki/Symbol_（编程）](http://en.wikipedia.org/wiki/Symbol_(programming))

符号的想法是提供一种人类可读但计算成本低的原始类型。

在 Ruby 中，当编译器/解释器看到一个符号时，它会创建一个 Symbol 类型的对象并将其存储在内存中。在 ruby​​ 中，符号是单例，因此任何其他使用相同符号的方法都会返回完全相同的对象，这使得它在空间方面非常便宜，而且比较起来也非常便宜，因为您可以只比较内存地址而不是内容。

例如，如果您比较两个符号，如下所示：

```
:foo == :foo 
```

您几乎是在比较同一个对象，这意味着只需要比较内存地址。

现在，当您比较两个字符串时：

```
"foo" == "foo" 
```

它创建两个具有相同内容的 String 实例，并且需要比较字符串的每个字节以确保它们相等。

这个属性使得 Symbols 非常适合散列中的标识符或键。

现在，到 RSpec。

让我们看下面的例子：

```
describe Authenticator do
  let(:user) { Factory.create(:user) )

  it "authenticate" do
    auth_user = subject.authenticate(user.login, user.password)
    auth_user.should == user
  end
end 
```

Factory.create 将符号作为要使用的工厂的标识符。您需要自己定义工厂，所以实际上它只是一个名称。您可以使用字符串，但使用符号更便宜也是最佳实践，但老实说，除非您调用 Factory.create 数百万次，否则不会有太大区别。

let 不是定义一个变量，它实际上是定义一个做一些事情的方法：

1.  第一次在规范（it 块）内调用该方法时，它将执行该块，缓存结果并返回它
2.  同一规范内的任何其他调用（它块）只会返回缓存的结果
3.  规范完成后，它会删除缓存的结果，以便在下一次调用时重新评估，在下一个规范

这允许仅在需要时延迟创建对象，并允许将任何状态更改限制为当前规范。

因此，底线是：RSpec 使用该符号作为方法名称的标识符，该方法名称将被生成以抽象出某些事物，让您的生活更轻松。RSpec 只不过是一种使用元编程来构建测试套件的 BDD 领域特定语言。

使用以下测试用例可以实现相同的行为：

```
class AuthenticatorTest < Test::Unit::TestCase
  def user
    return @user if @user
    @user = Factory.create(:user)
  end

  def subject
    return @subject if @subject
    @subject = Authenticator.new
  end

  def teardown
    @subject = nil
    @user = nil
  end

  def test_authenticate
    auth_user = subject.authenticate(user.login, user.password)
    assert_equal auth_user, user
  end
end 
```

请注意，您可能不应该编写这样的测试用例，但它（大致）说明了 RSpec 的作用。

我希望这有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T01:59:50.270

一些小的更正/澄清：

1.  这是一个“rspec”测试，而不是 rake 测试。Rake 是一种自动化工具（类似于“make”），但 rspec 是一种测试工具。
2.  FactoryGirl 可以创建许多不同种类的对象。如果你定义了多个工厂，传递给#create 的符号会告诉它使用哪个工厂。它没有告诉它在你的程序中设置什么变量。
3.  let() 调用定义了一个由提供的符号名称给出的辅助方法，例如：user。该方法返回由传递给它的块确定的值，例如 FactoryGirl 将创建的用户对象。

我已经忽略了 let() 的一些细节。真正的文档在这里：

[https://www.relishapp.com/rspec/rspec-core/v/2-6/docs/helper-methods/let-and-let](https://www.relishapp.com/rspec/rspec-core/v/2-6/docs/helper-methods/let-and-let)

~~以我个人的经验，这种特殊模式是 nc，但单元测试往往与常规代码不同，因为它们的想法是练习代码，而不是解决实际问题。要做到这一点，您往往希望一次改变一件事，这样事情就会变得重复——但是 ruby​​ 提供了许多工具来减少打字并保持可读性。~~

编辑：有关使用此模式的示例，请参阅注释。它就在我的鼻子底下...... :)

# php - 将 url 从 SQL 转换为可点击的链接

> ID：14845134
> 
> 赞同：0
> 
> 时间：2013-02-13T01:44:05.150
> 
> 标签：php, sql, hyperlink, clickable

我正在尝试使它插入到我的 sql 数据库的“标记”列中的任何文本 url 都将变成 php 表中的可点击链接。现在，我不得不手动将链接 html 放入数据库中，我不想这样做。

这是我得到的代码：

```
<?php 
  mysql_connect(localhost, user, pw) or die(mysql_error());
  mysql_select_db(database) or die(mysql_error());
?>

<table id=table class=display>
<thead><tr><th>Owner</th><th>Soquili's Name</th><th>Sex</th><th>Generation</th><th>Parents</th><th>Kind</th><th>Theme</th><th>Colorist</th><th>Tag</th><th>Alt 1</th><th>Alt 2</th><th>Alt 3</th></tr></thead>
<tbody>
<?php

  // Result Limit
  $sql = "SELECT * FROM soquili limit 25";
  $result = mysql_query($sql)or die(mysql_error());

  while($row = mysql_fetch_array($result)){
  //Reference

  $name     = $row['owner'];
  $soq    = $row['soq'];
  $sex    = $row['sex'];
  $gen     = $row['gen'];
  $parents = $row['parents'];
  $kind    = $row['kind'];
  $theme    = $row['theme'];
  $colorist    = $row['colorist'];
  $tag    = $row['tag'];
  $alt1    = $row['alt1'];
  $alt2    = $row['alt2'];
  $alt3    = $row['alt3'];

// looped row
echo 
"<tr><td>".$name."</td>
<td>".$soq."</td><td>".$sex."</td>
<td>".$gen."</td>
<td>".$parents."</td>
<td>".$kind."</td>
<td>".$theme."</td>
<td>".$colorist."</td> 
<td><a href=\".$tag.\">Tag</a></td>
<td>".$alt1."</td> 
<td>".$alt2."</td>
<td>".$alt3."</td> 
</tr>";

}
?>
</tbody></table> 
```

我不明白为什么它不起作用。

这是我的网站： [http ://rpwith.us/Test2/](http://rpwith.us/Test2/)

我有一个测试条目（搜索 Weeese），其文本 URL 根本无法点击。有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T14:01:14.730

`a`带有标签的行上的引号是错误的。

正确的：

```
<td><a href=\"".$tag."\">Tag</a></td> 
```

解释：

`\"`用于插入文字引号，但您希望有另一个引号来结束字符串文字，以便将解析`. $tag .`为 PHP 代码。

你这样做的方式，“.$tag”。part 是字符串文字的一部分；但是，当您使用双引号时，`$tag`PHP 会自动替换 ，**但点仍然存在**. 结果：您的输出中有一对额外的点。

# datatables - 让 jscrollpane 在包含数据表的 div 上工作

> ID：14845141
> 
> 赞同：0
> 
> 时间：2013-02-13T01:45:14.357
> 
> 标签：datatables, jquery-jscrollpane

逻辑和设置：

'wrapper' div 是设置的高度和宽度。

[jscrollpane](http://jscrollpane.kelvinluck.com/)设置为应用于“包装器”div。

[' wrapper](http://datatables.net/) ' div 包含数据表实例上方的文本（它本身在另一个 div 中）。

期望的结果：jscrollpane 应用于“包装器”div。

当前结果：jscrollpane 没有出现，并且“包装器”div 不是可滚动区域。

我没有指向测试站点的链接，在 jsfiddle 中设置它会很麻烦（但我现在就开始并尽快发布链接）。

**更新：**嗯，我似乎让它在 jsfiddle [(http://jsfiddle.net/rwone/AGf9M/)](http://jsfiddle.net/rwone/AGf9M/)上工作，但不是测试站点:(

也许是因为在测试站点上我使用的是数据库中的数据，并且数据表的高度直到数据加载后才存在？因此滚动窗格没有被触发？我不知道 ：（

```
$(document).ready(function() {
$('#example').dataTable();
$('#wrapper').jScrollPane();
} ); 
```

jscrollpane 可以在包含嵌套 div 和 table 的 div 上工作吗？或者它可能只是 jscrollpane 和数据表脚本之间的冲突（firebug 显示没有错误）？

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T03:19:31.087

解决方案似乎是设置桌子的高度：

```
"sScrollY": "300",
"bScrollCollapse": false 
```

这以某种方式为 jscrollpane 提供了足够的信息来触发以创建滚动区域以适应高度。

# c# - 运行命令提示符命令以在 Visual Studio 中启动解决方案

> ID：14845147
> 
> 赞同：-1
> 
> 时间：2013-02-13T01:45:40.860
> 
> 标签：c#, visual-studio-2010, visual-studio

如果运行我的应用程序的命令提示符命令是“myApp.exe mycmd:something”，我应该在哪里添加“mycmd:something”以在 Visual Studio 2010 中以相同的方式运行我的解决方案？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T01:48:41.310

右键单击解决方案（在解决方案资源管理器视图中）-> 属性-> 调试-> 命令行参数。

# python - 字典中的复合键

> ID：14845148
> 
> 赞同：4
> 
> 时间：2013-02-13T01:45:57.060
> 
> 标签：python, dictionary, python-2.7, composite-key

我正在维护一个字典，用于跟踪对象对之间的相似性。
例如，这本字典可能如下所示：

```
similarities = {
 p1: {p2: v12, p3:v13, p4:v14},
 p2: {p1: v21, p3:v23, p4:v24},
 p3: {p1: v31, p2:v32, p4:v34},
 p4: {p1: v41, p2:v42, p4:v43}
} 
```

请注意，相似度测量是对称的。因此，与ie`similarities[p1][p2]`相同。`similarities[p2][p1]``v12 == v21`

有时，我需要`p2`消除`similarities[p1]`; 在这样做的过程中，我还需要从所有内部字典中删除`p1`和。 这是乏味和低效的。`p2``similarities`

所以不是维护一个对称字典，有没有办法用一个复合键来维护一个字典，以便我可以查找`similarities[p1,p2]`？

我真的不能使用，`tuple`因为`(p1, p2) != (p2, p1)`我不能先验地知道如何订购元组。

A`frozenset`是我能想到的唯一其他容器，但这不会削减它，因为其中可能还有其他键`similarities`包含其中一个`p1`或`p2`作为一个组件。那么我可以使用什么容器来解决这个问题呢？

技术信息：

*   蟒蛇2.7
*   这个“复合键”中总会有两个元素

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T01:51:53.967

`frozenset`假设对象是可散列的，我可能只使用 a 。

或者，如果它们有任何定义明确且一致的顺序，您可以将它们保存在按所述顺序排序的元组中。如果你愿意，你可以编写一个小子`dict`类来透明地为你做这件事。

或者，您可以执行以下操作：

```
class SymmetricDict(dict):
    def __getitem__(self, key):
        if key in self:
            return dict.__getitem__(self, key)
        a, b = key
        return dict.__getitem__(self, (b, a)) 
```

同样对于`__setitem__`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T02:21:06.087

我认为使用`frozenset`是唯一合乎逻辑的解决方案。您可以使用带有集合交集测试的推导找到仅匹配其中一个值的键：

```
def remove_ab(ab, similarities):
    return {k:v for k, v in similarities.items() if not ab & k}

similarities = {frozenset({1, 2}): "v12",
                frozenset({1, 3}): "v13",
                frozenset({2, 3}): "v23",
                frozenset({3, 4}): "v34"}

similarities = remove_ab(frozenset({1, 2}), similarities
print(similarities) # output is {frozenset({3, 4}): 'v34'} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-13T01:53:32.667

如果 p_ 对象属于支持排序的类型，您是否可以使用两个元素始终处于 lo --> hi 顺序的元组？

# c++ - 为向量保留更大容量后发生 Segfault

> ID：14845149
> 
> 赞同：0
> 
> 时间：2013-02-13T01:46:23.300
> 
> 标签：c++, vector, segmentation-fault, stdvector

我正在尝试从字典文件中读取单词，并且在从文件中读取的第 4 行收到段错误。从我读过的关于 C++ 中的向量的内容来看，要使用插入命令，我需要指定一个迭代器以用作占位符。为此，我在向量的开头实例化了一个迭代器。

```
 vector<string>::iterator it = dictionaryFile.begin(); 
```

在我的 for 循环中，我使用增量运算符递增迭代器指向的位置

```
it++; 
```

我基于[www.cplusplus.com](http://www.cplusplus.com)上的示例。迭代器适用于前 3 行，然后发生段错误。我已经仔细检查了我的文件，以确保 getline 没有读取错误字符。我相信这个错误与我为确保向量没有溢出而进行的保留调用有关。

由于我在声明时没有使用关键字 new，所以向量的容量是否限制为 5？我找不到任何使用新关键字的例子！

我已经包含了导致此错误的代码段。请注意我已经重新设计了几次以试图解决这个段错误，这不是我最初的实现。我将不胜感激 C++ 大师可能拥有的任何见解。感谢您的时间。

```
vector<string> dictionaryFile (5, "");                                                                     //Declaration of vector that will hold the words in the dictionary

ifstream input;                                                                                                  //Declaration of input file stream
input.open(inst.c_str());

/********************** Test to see if file was opened ********************************/                
if(!input){
    cerr << "The file " << inst <<" does not exists in this directory" << '\n';
}
/********************** File is successfully opened**********************************/

string temporaryProcessingString = "";                                                                //This string will temporarily hold values read in from the file
vector<string>::iterator it = dictionaryFile.begin();                                                 //Creates iterator to step through the vector and fix this wild shit

for(int i = 0; getline(input, temporaryProcessingString); i++){                                 //See I can follow directions given in class no eof used.
    cout << "Does this print before SegFault 1 " << endl;
    if(dictionaryFile.size() >= (dictionaryFile.capacity() - dictionaryFile.size()) ){       //If current size is greater the 50% capacity reserve size*2 more memory
        int oldSize;
        oldSize = dictionaryFile.size();
        cout << "Does this print before SegFault 2 " << endl;
        dictionaryFile.reserve(oldSize + oldSize);                                                  //Reservation new capacity for vector containing dictionary
    }

/** this is a test bracket that solely keeps track of the vectors size and capacity in the terminal COMMENT OUT BEFORE SUBMITTING*/
cout << "________________________________________________" << '\n';
cout << "Loop Run: " << i << endl;
cout << "Size: " << dictionaryFile.size() << ", Capacity: " << dictionaryFile.capacity() << endl;
cout << "________________________________________________" << '\n';
dictionaryFile.insert(it, temporaryProcessingString); /*******************************THIS LINE CAUSES THE SEGFAULT! UNFORTUNATELY IT IS ALSO THE LINE THAT MOVES THE DATA INTO THE VECTOR************************/
it++;
cout << "Dictionary Entry: " << dictionaryFile[i] << endl;

}
cout << "Dictionary Entry Primary Test: " << dictionaryFile[0] << endl; 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-13T01:54:54.590

When your vector's size approaches its current capacity (or, in your case, when you call `vector::reserve`, see the section on iterator validity [here](http://www.cplusplus.com/reference/vector/vector/reserve/)), an internal algorithm will re-allocate it and potentially move it somewhere else, making all iterators to elements in the vector invalid.

As your program only seems to insert at the end anyways, use `vector::push_back` instead of `vector::insert` to prevent this. You can then also skip the `reserve`ing - the internal algorithms are quite good (you don't have to be afraid of the vector doing reallocation for every single new element - the algorithms are smarter than that).

# windows-phone-7 - 从网站获取数据

> ID：14845151
> 
> 赞同：0
> 
> 时间：2013-02-13T01:46:31.373
> 
> 标签：windows-phone-7, html-agility-pack, webrequest

几天以来，我正在尝试为我的 WP7 手机编写一个 C# 程序，以从网站获取某种数据文件。

有一个主要链接（[http://www.convert-control.de/plant/53752/yield/2012](http://www.convert-control.de/plant/53752/yield/2012)）生成我的太阳能电池板在特定时间生产的产量图表视图。此处高于 2012 年。将请求更改为 ... yield/2012/4/5 将为您提供 4 月 5 日的收益率。

所以发生的事情是，在这个请求之后，服务器会生成一个名为 chartdata 的文件。

调用主链接后，我可以在浏览器中启动第二个请求，即[http://www.convert-control.de//chartdata/53752](http://www.convert-control.de//chartdata/53752)并获得相关数据。这些数据用于填充图表。此图表是一个 swf 对象。

所以，我现在的问题是，如何在 c# 中为 WP7 程序编写我的请求，从而为我提供进一步使用的数据？

谢谢你的帮助，乔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T03:00:58.537

乔！

获取数据很简单。您的数据大小低于 8kb，对于这种小容量，最好的方法是 IMO 使用[WebClient.DownloadStringAsync](http://msdn.microsoft.com/en-us/library/ms144202%28v=vs.95%29.aspx)方法（或 DownloadStringTaskAsync，您将决定使用我推荐的 Async CTP，顺便说一句）。

在字符串中得到响应后，我建议使用 Json.NET 将其解析为强类型对象。这是 json2csharp.com 从您的数据中自动生成的代码，只有一些修复（未经测试）：

```
public class Title
{
    public string text { get; set; }
}

public class Key
{
    public string text { get; set; }
    public string colour { get; set; }
    [JsonProperty("font-size")]
    public int font_size { get; set; }
}

public class Val
{
    public string colour, tip;
    public int val;
}

public class Element
{
    public string type { get; set; }
    public int alpha { get; set; }
    public List<List<Val>> values { get; set; }
    public List<Key> keys { get; set; }
}

public class Tooltip
{
    public bool shadow { get; set; }
    public int stroke { get; set; }
    public string colour { get; set; }
    public string background { get; set; }
    public string title { get; set; }
    public string body { get; set; }
}

public class Labels
{
    public List<string> labels { get; set; }
    public int steps { get; set; }
}

public class XAxis
{
    public string colour { get; set; }
    public Labels labels { get; set; }
    [JsonProperty("grid-colour")]
    public string grid_colour { get; set; }
}

public class YAxis
{
    public int min { get; set; }
    public int max { get; set; }
    public int steps { get; set; }
    [JsonProperty("grid-colour")]
    public string grid_colour { get; set; }
    public string colour { get; set; }
}

public class XLegend
{
    public string text { get; set; }
    public string style { get; set; }
}

public class YLegend
{
    public string text { get; set; }
    public string style { get; set; }
}

public class RootObject
{
    public Title title { get; set; }
    public List<Element> elements { get; set; }
    public string bg_colour { get; set; }
    public Tooltip tooltip { get; set; }
    public int num_decimals { get; set; }
    public bool is_fixed_num_decimals_forced { get; set; }
    public bool is_decimal_separator_comma { get; set; }
    public XAxis x_axis { get; set; }
    public YAxis y_axis { get; set; }
    public XLegend x_legend { get; set; }
    public YLegend y_legend { get; set; }
} 
```

然后，您`JsonConvert.DeserializeObject<RootObject>( response )`使用从 Web 服务器获得的响应字符串进行调用，并获取一个包含所有响应数据的强类型 C# 对象。随心所欲地处理或可视化它。

AFAIK 目前无法在 Windows Phone 上重用您的 SWF 控件。您必须创建自己的 UI 来可视化您的数据。如果您需要这部分的帮助，您可能应该在此处搜索和/或发布另一个问题。

# vbscript - iexplorer 关闭时注销

> ID：14845153
> 
> 赞同：0
> 
> 时间：2013-02-13T01:46:44.050
> 
> 标签：vbscript

嗨，我是 vbscript 的新手，找不到任何有关如何检测创建的​​对象何时关闭的信息。

我有以下代码：

```
Set objExplorer = CreateObject("InternetExplorer.Application")
Set WshShell = Wscript.CreateObject("WScript.Shell")
objExplorer.Navigate "//IDM/jsps/login/Login.jsf"
objExplorer.Visible = true
objExplorer.ToolBar = false
objExplorer.MenuBar = false
objExplorer.StatusBar = false
objExplorer.AddressBar = false
objExplorer.Width = 1000
objExplorer.Height = 600
objExplorer.Resizable = false 
```

我试图在 ie 关闭时让 Windows 注销，我有以下代码可以注销哪些工作，我如何在 ieclose 上调用它？

```
WshShell.Run "C:\windows\system32\shutdown.exe /l", 
```

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T06:23:02.573

一种快速而肮脏的方法是检查对象 HWND 属性并处理错误。

```
On Error Resume Next
Do Until Err
    h = objExplorer.HWND
    WScript.Sleep 50
Loop

WshShell.Run "C:\windows\system32\shutdown.exe /l" 
```

[编辑] 或者这可能更接近您的需求：

```
With CreateObject("WScript.Shell")
    .Run "mshta.exe //IDM/jsps/login/Login.jsf", 1, True
    .Run "C:\windows\system32\shutdown.exe /l"
End With 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T07:30:48.147

使用`WScript.Shell.Run`等待而不是`InternetExplorer.Application`循环：

```
Const SW_SHOWNORMAL =  1
CreateObject("WScript.Shell").Run "iexplore.exe http://www.google.com", SW_SHOWNORMAL, True
WScript.Echo "Run done." 
```

# mysql - MySQL UPDATE 使用 IF 选择要 +1 的列

> ID：14845154
> 
> 赞同：0
> 
> 时间：2013-02-13T01:47:24.407
> 
> 标签：mysql, if-statement, sql-update

我有一个投票表，如果 POST 值为 1，则更新 tableA column_a +1 否则更新 tableA column_b +1

这是我的查询，不知道如何在这里使用 IF 语句。

```
UPDATE 
    votes, 
    topics 
SET votes.yesno = 1,
    IF(votes.yesno = 1, topics.num_yes = topics.num_yes+1, topics.num_no = topics.num_no+1)
WHERE votes.user_id=? AND votes.topic_id=?
AND topics.id = votes.topic_id 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T02:07:15.093

我想这可能是你正在寻找的。您不能使用 IF 来指定列，但可以使用它来指定值：

```
UPDATE votes v
   INNER JOIN topics t ON v.topic_id = t.topic_id
SET v.yesno = 1,
   t.num_yes = IF(v.yesno = 1, t.num_yes + 1, t.num_yes),
   t.num_no = IF(v.yesno = 1, t.num_no, t.num_no + 1)
WHERE v.user_id = ? 
   AND v.topic_id = ? 
```

这是一些示例[SQL Fiddle](http://sqlfiddle.com/#!2/9488b/1)。

祝你好运。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T02:10:13.497

我有一个两部分的答案：

首先，你不能做你想做的事，就是根据一行的值来选择更新哪一列。该`UPDATE`语句具有非常具体的语法。

其次，无论如何你都可以得到你想要的结果：

```
UPDATE
    votes,
    topics
SET votes.yesno = 1,
    topics.num_yes = topics.num_yes + (0 XOR votes.yesno),
    topics.num_no  = topics.num_no  + (1 XOR votes.yesno)
WHERE topics.id = votes.topic_id 
```

您也可以`IF`在该`SET`部分中使用，但我认为我的表达强调您只更新其中一列。

# io - Erlang打印进程ID？

> ID：14845156
> 
> 赞同：2
> 
> 时间：2013-02-13T01:47:26.960
> 
> 标签：io, erlang, pid

这是一个非常简单的问题，与打印连接的进程 ID 有关。例如打印出 Listen in this one？我假设Listen是一个Pid btw ...

```
{ok, Listen} = gen_tcp:listen(); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-13T01:56:13.723

您可以`io:format`使用`~p`格式说明符打印它，它可以打印任何 Erlang 术语：

```
> io:format("~p~n", [Listen]).
#Port<0.605> 
```

（`Listen`实际上不是一个 pid，而是一个端口标识符。）

# cloud - 虚拟化与私有云计算的区别

> ID：14845157
> 
> 赞同：3
> 
> 时间：2013-02-13T01:47:40.480
> 
> 标签：cloud, virtualization, openstack

我对虚拟化和私有云计算感到困惑。他们的服务是什么？他们的目的？它们可以结合起来吗，比如说我们在私有云上构建虚拟化服务器？

据我了解，云计算包含了 IaaS（基础设施即服务）的理念。换句话说，我可以从最少数量的裸机服务器开始，并根据需要对其进行扩展，然后将这些服务器通过划分计算和数据存储合并到一台大机器中。

话虽如此，我们可以在私有云上构建虚拟化吗？例如，我可能会购买大约 10 台服务器（尤其是像 opencompute 项目中的服务器），使用 openstack 将它们作为私有云粘合在一起，并且可能使用 Xen 或 Kvm 来创建虚拟化服务器。那可能吗？那是理想的吗？

请指点我正确的绝地学校。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-08T04:03:05.000

云专门指网络图表中云图标的古老用法，以表示外部或未定义的资源。该术语的起源是指将您的网络基础设施的组件放置在您自己的环境之外......因此进入您的网络图上的云之一。今天，这个术语已经发展到包含许多不同的想法，并且在很大程度上被相互竞争的定义所污染。

IaaS / PaaS / SaaS / LBaaS / 等等

这些都是服务。非常符合访问基础架构组件的想法......作为存在于网络架构图上的云中的服务。

但是，这些“aaS”解决方案中的每一个在实现目标的方式上都有不同的方法。其中一些将不符合“云”的经典术语。例如，某些“aaS”组件可能不在您的网络架构之外。这就是“私有云”之类的东西可能发挥作用的地方。

私有云是一个可怕的术语。这是一个矛盾的说法。因为它不在您的环境之外，所以它不是您图表上的云。但是，由于人们将云一词的含义污染到几乎不连贯，我们至少目前仍坚持使用这个词。所以当我说“私有云”时，请耐心等待。在任何经典意义上，它都不是真正的云。这就是我们在英语中所说的“误称”。

现在重要的是不要将云“aaS”解决方案本身与亚马逊或 rackspace 等主要云提供商在开发“aaS”解决方案时遵循的弹性设计原则相混淆。

弹性设计原则将强调水平可扩展的无共享基础设施。描述这种意识形态的最简单方法是牛与小狗的例子。过去，我们查看服务器资源就像查看小狗一样。我们为它们命名。我们对他们很好。我们教他们技巧。而且，如果他们生病了，我们会帮助他们恢复健康。我们竭尽全力让这些服务器保持愉快并运行良好。我们垂直种植它们。我们优化了它们。更多 ram、cpu、开发资源……等等。在弹性模型中，我们将资源视为牛。他们有序列号。我们在教他们任何东西上投入最少的精力。它们尽可能同质。发生的任何优化都发生在配置管理中，并且作为独立的解决方案在所有这些优化之间共享。如果一个人生病了，我们会朝它的头部开枪，然后用牛群中的另一个代替它。这种设计范式的好处是，如果您开始用霰弹枪射击您的服务器机架，很可能整个环境都会进行补偿。当然，这种弹性水平在理论上比在实践中更容易描述。

现在，就虚拟化而言，它与“云”有关。确实没有实际的必要关系。云不需要与虚拟化有任何关系。您可以在您所依赖的环境之外拥有一个不使用虚拟化的面向服务的资源。但是，大多数现有的“aaS”解决方案都受到虚拟化技术的支持。它们完全不必是，但由于它们将涉及虚拟化的普遍可能性，这两个术语在许多方面已经在外行的头脑中结合在一起。

重新开放堆栈和私有云。

OpenStack 是否适合您是一个非常个人的决定。这取决于很多事情。自己运行基础设施可能非常昂贵。更重要的是，它可能很难做好。对于小型企业或组织，如果从事规模经济交易的人可以满足您的需求，那么部署您自己的 IaaS 基础设施可能真的没有意义。这就是像亚马逊这样的公司填补空白的地方。

对于在自己的环境中运行 IaaS 解决方案的一些组织来说，即使可能或积极地由亚马逊或机架空间产品提供服务，也是有意义的。有些人足够大，运行足够多的其他基础设施来托管他们自己的弹性应用程序在经济上是可以接受的。除了严格的底线之外，还有其他原因。许多大型组织面临 HIPAA、FISMA 或 Sarbanes Oxley 等政策限制。有时满足这些政策要求以及他们自己的任何内部政策要求需要支付一些额外费用。

除了亚马逊或 Rackspace 的一般产品之外，还有其他原因。想象一下，如果您愿意提供类似 jenkins 的自动构建和测试环境，并且您希望提供异构虚拟机管理程序或物理节点来自动启动并测试编译软件。OpenStack 可能可以处理这个问题。如果它不能具体处理您的想法，它就是开源的。你可以让它处理你需要的东西。

使用或不使用 OpenStack 有一百万个理由。归根结底，对于任何个人或公司来说，这都是一个非常个人的决定。并且需要大量研究。但在某些情况下，两者都是伟大的决定。

当我们在 NASA 创建 nova（OpenStack ec2 风格的计算组件）时，我们表面上专注于以弹性方式提供 HPC 资源或业务线资源。亚马逊最终创建了自己的 HPC 产品。即使是现在，它也在努力克服 FISMA 政策合规性的障碍。但总会有一些时候，您的专业化需求会降低通用市场产品的优势。然而，除了与亚马逊竞争的技术原因之外，还有另一个重要原因。这是为了在这个新兴技术领域培养开放标准。

技术的发展很像一棵树的有机生长。它从一个芽开始，可能会变成一片叶子。任何新技术的出现都是一件小事，需要大量资源才能成长。并非所有这些技术都能幸存下来。但有些人会。而那些确实需要金钱和努力的人，以贪婪的速度这样做。然而，随着这些技术的发展，其中一些成为分支。有些甚至变成了树干。为了拥有一百万种其他技术从更多分支发展而来的主干，由负责任的社区控制的开放标准是必要的。政府和 IBM 等许多组织都认识到这一点，这也是 OpenStack 发展如此迅速的主要原因之一。这也是 BSD 和 Linux 这样做的原因。弹性设计方法改变技术格局的潜力是非凡的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T19:56:28.083

正如 Jeff 提到的，私有云计算可能意味着任意数量的非常任意的事情，这取决于谁试图向您推销某些东西。也就是说，如果我们将其视为“防火墙后具有高度规范化 API 的 IaaS”，那么很容易指出与虚拟化的差异。

最重要的部分是关于如何使用两者中可用资源的思维定势。在虚拟化中，大部分重点是将硬件资源分成小部分，然后将它们分配出去，让它们无限期地运行。

与云计算的最大区别在于，所有资源更普遍地被认为是短暂的——启动它，使用它，完成后删除它。它通常也非常有能力支持长时间运行的资源，但要点是硬件资源正在以比虚拟化容易允许的速度更高的变化率重新利用。

另一个有点相关的区别是，虚拟化通常仍将实例、卷和网络视为要虚拟化的独立元素。云计算将它们都视为相当统一的资源，与云计算相关的工具（例如[https://github.com/cloudenvy/cloudenvy](https://github.com/cloudenvy/cloudenvy)、[https://github.com/opscode/knife-openstack](https://github.com/opscode/knife-openstack)）使用它来制作更有效、更轻松地启动和减少资源。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-15T13:26:38.963

虚拟化只是构建成功的私有云环境的一部分。要拥有真正的私有云，您不仅必须实现虚拟化，还必须整合监控、管理和自动化。

这是我管理的一个博客，如果您有其他类似的问题，应该会对您有所帮助：www.journeytothecloud.com

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-14T09:46:53.193

第一：云计算不仅仅是IaaS，还有PaaS或者SaaS……

但主要是，您必须了解，虚拟化只是构建云的一种方式。如果您询问 IaaS 和虚拟化之间的区别，我的回答是： - IaaS 定义“VM 模板”，您正在运行各种数量的一个模板 - IaaS 能够自动重新分区 VM - IaaS 管理网络 - IaaS 管理 vm 模板分发 - IaaS 能够添加或删除一些裸机服务器......所以 IaaS 是您无需处理虚拟化级别的级别：这是他的工作，您可以通过 API 管理您想要的 VM 模板和数量。

但是如果你是一个开发者，我建议你看看PaaS，它更容易处理。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-13T16:19:55.030

首先，云计算是一个非常笼统的概念。它不仅限于 IaaS。PaaS（平台即服务）和SaaS（软件即服务）也是云计算技术。当您谈论云计算时，您最好指定要引用的技术。其次，IaaS 建立在虚拟化技术之上。没有虚拟化，没有 IaaS。PaaS 和 SaaS 服务可以直接构建在裸机上。所以虚拟化并不总是与私有云计算有关系。

`From what I understand, cloud computing embraces the idea of IaaS (infrastructure as a service). In other words, I could start with minimal number of bare metal servers and expand it as requirement needs, and those servers are consolidated into one big machine through divided computing and data storing.`

你的理解不正确。您可以将裸机服务器虚拟化为多个虚拟服务器。但是您不能将许多裸机服务器虚拟化为一台大型机器。虚拟化目前无法实现这一点。OpenStack、Eucalyptus 等 IaaS 软件仅用于管理您的裸机服务器。他们可以将您的裸机服务器粘合为一个`resource pool`但不是大型虚拟机。

# php - 唯一号码列表

> ID：14845159
> 
> 赞同：0
> 
> 时间：2013-02-13T01:47:50.320
> 
> 标签：php

我有一个 HTML 表单，用户使用复选框从中选择数字。这些数字被放入一个 PHP 数组中，如下所示：

```
<input type="checkbox" name="formnumber[]" value="1" /> 
```

从 1 到 24 有 24 个数字可供选择。我想使用数组中的数字输出 10 个唯一行的列表，每行 5 个唯一数字。

例如：我从表格中选择 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16。输出将如下所示：

```
2 16 4 1 15
10 13 2 4 5
12 1 3 16 11

etc etc (10 lines) 
```

* * *

我让它像这样工作，但我仍然时不时地得到一个副本。我可以在表单中输入 5 到 24 个数字，并在输出中获得大部分唯一的 4 个数字的随机行。

```
$i=1;

while ($i<=$xresults) {

$numbers = $_POST['formnumber'];

shuffle($numbers);

$counter = 0; 

    foreach ($numbers as $number1) {

        echo "<span>$number1</span> ";

    if(++$counter >= 4) { break; }

}

$i++;

echo '<p>';

 }

} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-13T01:51:18.590

所以基本上你希望它选择 5 个选定框的不同组合。

好吧，我会做这样的事情：

```
$flip = array_flip($_POST['formnumber']);
for($i=0; $i<10; $i++) {
    $combo = array_rand($flip,5);
    echo implode(" ",$combo)."\n";
} 
```

# c# - 调整选项卡控件标题的大小

> ID：14845172
> 
> 赞同：0
> 
> 时间：2013-02-13T01:48:57.407
> 
> 标签：c#, winforms, tabcontrol

我是绘制选项卡控件的所有者。为了我的目的，我需要使用比默认 windows 字体大得多的字体，如果 Tab Control SizeMode 是 TabSizeMode.Normal，它应该自动重新调整大小以适应其内容的大小。这很好用，除非我更改控件的实际字体。

我试过了：

1.  更改 TabControl 字体
2.  更改 TabPage 字体
3.  使用 TextRenderer.MeasureString 并更改 TabPage Width 属性

但是，似乎没有什么可以改变选项卡项标题的大小。

Segoe UI (8) [http://puu.sh/21GZo/1e986a45a6](http://puu.sh/21GZo/1e986a45a6)

当我使字体变大时（我用graphics.DrawString自定义绘制字体）

Segoe UI (15) [http://puu.sh/21H1m/a45ae2e1f3](http://puu.sh/21H1m/a45ae2e1f3)

标题大小不适应文本的新宽度。

# mysql - 一天结束后比较之间的 MySQL 时间

> ID：14845173
> 
> 赞同：0
> 
> 时间：2013-02-13T01:49:04.303
> 
> 标签：mysql, sql, perl

我有一个在某些情况下对我不起作用的查询，我认为这是因为在某些情况下时间会超过一天的结束时间，因此结束时间小于开始时间。这是查询。

```
SELECT reminder_cfg.id, default_time, day_prior, timezone 
FROM reminder_cfg, uc_users 
WHERE reminder_cfg.id = 5 
AND reminder_cfg.id = uc_users.id 
AND default_time BETWEEN TIME(NOW() + INTERVAL 5 HOUR) AND TIME(NOW() + INTERVAL 10 HOUR) 
```

这真的让我很恼火，但现在已经有几天了。

这是 Perl 脚本的一部分，我确信有更好的方法，但我很难过。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T02:01:48.060

使用[DATE_ADD](http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_date-add)添加两个日期。

```
SELECT reminder_cfg.id, default_time, day_prior, timezone 
FROM reminder_cfg, uc_users 
WHERE reminder_cfg.id = 5 
AND reminder_cfg.id = uc_users.id 
AND default_time BETWEEN TIME(DATE_ADD(NOW(), INTERVAL 5 HOUR)) AND TIME(DATE_ADD(NOW() + INTERVAL 10 HOUR)) 
```

# django - 在 Django Tables 2 视图中使用 Haystack 搜索

> ID：14845175
> 
> 赞同：0
> 
> 时间：2013-02-13T01:49:20.003
> 
> 标签：django, search, django-haystack

我正在尝试将 Haystack/Whoosh 搜索与 Django Tables 2 一起使用。搜索结果应呈现为表格。这是我当前呈现表格的视图：

```
def people(request):
    table = PersonTable(Person.objects.filter(pk=1))
    RequestConfig(request).configure(table)
    return render(request, 'people.html', {'table': table}) 
```

Haystack 应该像这样将搜索结果的主键传递给上面的视图函数，`Person.objects.filter(pk=va1,pk=var2)`这样这个视图函数就可以显示结果。

* * *

我能够编写一个工作视图：

```
def report(request, template='report.html', load_all=True, form_class=ModelSearchForm, searchqueryset=None, context_class=RequestContext, extra_context=None, results_per_page=None):
    table = ''
    query = ''
    results = EmptySearchQuerySet()

    if request.GET.get('q'):
        form = form_class(request.GET, searchqueryset=searchqueryset, load_all=load_all)

        if form.is_valid():
            query = form.cleaned_data['q']
            results = form.search()
            pklist = [ r.pk for r in results ]
            table = PersonTable(Person.objects.filter(pk__in=pklist))
            RequestConfig(request).configure(table)
    else:
        form = form_class(searchqueryset=searchqueryset, load_all=load_all)

    context = {
        'form': form,
        'table': table,
    }

    return render_to_response(template, context, context_instance=context_class(request)) 
```

它以某种方式工作。但是，由于我只是一个 Django 初学者，我觉得还有改进的余地。我在这里发布它以获得一些有用的建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T21:37:01.363

假设不能`PersonTable`使用 a 创建实例`SearchQuerySet`，您可以尝试`Person`从搜索中传递对象列表。

```
def search(request):
    # Let's say there's some logic here for querying your search engine
    # using Haystack, and `results` is a SearchQuerySet of Person results
    table = PersonTable([result.object for result in results])
    RequestConfig(request).configure(table)
    return render(request, 'people.html', {'table': table}) 
```

否则，您需要将结果的主键传递给视图函数的问题陈述有点不清楚。

# ruby-on-rails - HTTPS 在 Chrome 上显示，但在 Safari 上不显示

> ID：14845177
> 
> 赞同：4
> 
> 时间：2013-02-13T01:49:52.010
> 
> 标签：ruby-on-rails, ubuntu, ssl, nginx

HTTPS 显示在 Chrome 而不是 Safari 上，除非我单击另一个页面，然后单击返回。然后显示https，我可以单击它并查看证书。我安装了 Webserver 认证和中间文件。有没有人遇到过这个问题，如果有，您是如何解决的？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-15T13:42:32.217

可能您有一些通过普通 http 加载的外部资源（img、脚本等）。要检查尝试使用 Chrome 或 Firefox。

Chrome 在导航栏上显示一个有效的绿色锁，但如果从不安全的来源加载了一些资源，您可以在右侧看到一个盾牌图标。（Firefox 显示灰色世界而不是锁。Safari 会默默地删除 https+lock 图标）![Firefox 和 Chrome 导航栏通过 http 提供一些资源](../Images/85fb8bd424c4809bb901ae3c845eb3ab.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-03-10T17:30:39.257

我遇到了同样的问题，并通过在 safari 菜单中切换用户代理来解决它：开发-用户代理。你可以选择任何其他的UA，对我来说，网站突然显示https。在我将 UA 更改为通用版本后，它工作正常。

# sql - 保存另一个文件时出现 INSERT INTO 语法错误

> ID：14845178
> 
> 赞同：1
> 
> 时间：2013-02-13T01:49:59.773
> 
> 标签：sql, vb.net

我正在为 vb 中的工资系统使用 OLE db 连接。在第一次保存交易时，它会成功保存在数据库中，但是当我回来选择另一个帐户来计算其工资并尝试保存时，它会返回一个错误，指出“插入时存在语法错误”。

这是我的代码：

```
 com5 = "INSERT INTO PayrollReport Values('" & empno.Text & "','" & ename.Text & "','" & startdate.Text & "','" & _
        cutdate.Text & "'," & bpay.Text & "," & computation.Text & "," & grosse.Text & "," & _
        lwop.Text & "," & tardiness.Text & "," & tax.Text & "," & sssp.Text & "," & _
        philp.Text & "," & hdmfp.Text & "," & sssl.Text & "," & hdmfl.Text & "," & _
        advance.Text & "," & taxdue.Text & "," & nete.Text & "," & deduction.Text & "," & _
        netpay.Text & "," & Employee.Esss.Text & "," & Employee.Ephil.Text & "," & Employee.Ehdmf.Text & ")"

    MsgBox(" The " & ename.Text & "'s Record has been save!")

    connect5() 
```

希望你能帮我解决这个问题...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T02:08:32.607

如果您将代码转换为使用我在下面提到的内容，您的错误将变得明显。

您确实需要使用如下代码将数据插入数据库。

**参数化 SQL** - 您需要使用 SQL 参数，尽管您没有使用存储过程。*这不是您的错误的原因*。您的原始代码将值直接从用户转储到 SQL 语句中。除非您使用 SQL 参数，否则恶意用户会窃取您的数据。

```
 Dim CMD As New SqlCommand("Select * from MyTable where BookID = @BookID")
    CMD.Parameters.Add("@BookID", SqlDbType.Int).Value = CInt(TXT_BookdID.Text) 
```

请注意，您不仅可以建立占位符以将数据安全地输入数据库，还可以建立数据类型。这可以帮助捕获数据转换错误。例如，如果用户在需要整数的字段中键入 4E，我发布的代码会给您一个非常明确的错误，提示您无法转换为 int。

[参考](https://stackoverflow.com/a/6360181/127880)

[此链接](https://stackoverflow.com/a/6003451/127880)将为您提供有关在 VB.NET 中连接到数据库的正确方法的更多详细信息。

# javascript - 使用 jquery 根据按钮值调用不同的 URL

> ID：14845181
> 
> 赞同：0
> 
> 时间：2013-02-13T01:50:10.593
> 
> 标签：javascript, jquery, coldfusion

我有一个调用 CFM 页面的按钮，它需要根据用户是激活还是停用数据库中的记录来传递一个值。我正在努力解决如何将活动/非活动值传递给 jQuery。下面是我正在使用的代码，它只能单向工作，即从活动到非活动。

```
<script>
$(document).ready(function() {

    $("#IsActive_1").click(function() {

    //cache the status div
        var status = $("#status");

        //let the user know the record is being updated
        status.html("<i>updating status...</i>");

    $("#IsActive_1").html('activate');

        //the status variable needs to be dynamic
        $.get("updateStatus.cfm?status=inactive", {}, function(res,code) {
        //show the result in plain HTML
        status.html(res);
    });

    });

});
</script>

<button id="IsActive_1"><cfif IsActive>deactivate<cfelse>activate</cfif></button><div id="status"></div> 
```

最后，我想根据适当的条件更改按钮上显示的文本以激活/停用（单击停用后激活，反之亦然）。

TIA

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T02:40:54.693

您可以向按钮添加一个属性，并基于它发送变量。

```
<button id="IsActive_1" checked="checked">Deactivate</button>

    $("#IsActive_1").click(function() {
          var x = $(this);
          var isActive = x.attr('checked') != undefined;
          if (isActive)
            x.removeAttr('checked');
          else
            x.attr('checked', 'checked');
        //cache the status div
            var status = $("#status");

            //let the user know the record is being updated
            status.html("<i>updating status...</i>");

             x.html(isActive ? 'Activate' : 'Deactivate');

            //the status variable needs to be dynamic
            $.get("updateStatus.cfm", { status : isActive ? 'inactive' : 'active' }, function(res,code) {
            //show the result in plain HTML
            status.html(res);
        });

        }); 
```

# 3d - 将模型空间向量转换为剪辑空间

> ID：14845184
> 
> 赞同：0
> 
> 时间：2013-02-13T01:50:28.987
> 
> 标签：3d, stage3d

我正在实现一个简单的顶点着色器来展示位图。定义了 4 个顶点，每个顶点着色器使用各自的 UV，连同位图宽度/高度除以视口宽度/高度，来修改剪辑空间位置。非常典型的东西，这里有一些存根代码：

```
 // Project positions to clip space.
    float4 clipPosition = vertexPosition * objectToClipSpaceTransform;

    // Get constants.
    float2 viewPort = float2(props[0], props[1]);
    float2 spriteSize = float2(props[2], props[3]);

    // Calculate window offset.
    float2 windowOffset;
    windowOffset.x = (vertexUV.x - 0.5) * spriteSize.x;
    //neg because V increases down, but Y in clip-space increases up
    windowOffset.y = -(vertexUV.y - 0.5) * spriteSize.y;  
    windowOffset /= viewPort;

    clipPosition.xy += windowOffset * clipPosition.w * 2.0;

    // Output shifted vertex.
    vertexClipPosition = clipPosition; 
```

我想要做的是在世界空间中定义的向量的方向上偏移位图，该向量的大小是固定数量的像素。这里棘手的部分是如何将世界空间向量转换为剪辑空间。我曾尝试在没有翻译组件的情况下使用 objectToClipSpaceTransform，但结果不正确。那么，我该怎么做呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T19:38:35.417

要将世界空间向量转换为剪辑空间，请乘以 worldViewProjection 变换，然后将最终向量除以其 w 分量。

确保原始向量的第四个分量为 0 很重要，因为 0 用于方向向量，而 1 用于位置向量。

所以如果你的向量是 v = (x,y,z,0)

然后（假设行主矩阵）得到的向量是

```
vclip = v * worldViewProjection. 
```

最后一步称为均匀划分，如果投影是透视的，这很重要。您需要将新向量除以其第 4 个分量，即：

```
vclip = vclip / vclip.w; 
```

# haskell - Haskell 中的错误函数

> ID：14845185
> 
> 赞同：0
> 
> 时间：2013-02-13T01:50:33.320
> 
> 标签：haskell, error-handling

我有一个在haskell中成功编译的函数。

它看起来像这样：

```
suffix :: Int -> String
suffix i 
   | i==0                 = "th"
   | i==1                 = "st"
   | i==2                 = "nd"
   | i==3                 = "rd"
   | i>=4 || i<=9         = "th"
   | i<0                  = error "Must be positive integer"     ----------NOT WORKING?
   | otherwise            = suffix(i `rem` 10) 
```

`i<0`我至少可以通过警卫的错误行来判断它是行不通的。当我进入 GHCI 并在数字上添加“-”时：`suffix -5`如果我完全关闭此案例，我会收到相同的错误消息。

我希望它清楚地显示我的错误消息。希望有人能发现我的问题。谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-13T01:56:46.877

基本的 Haskell 语法怪异。这是该语言中唯一类似的情况。

`suffix -5`是。`suffix - 5`_ `(-) suffix 5`该`-`字符被视为中缀二元运算符，就像 haskell 中所有以标点符号命名的函数一样。也就是说，除非 . 之前的表达式中没有字符`-`。做你想做的最简单的方法是使用`suffix (-5)`. 通过将其括在括号中，您在语法上使其成为一个独立的表达式，这意味着表达式中没有字符在前面`-`。

但是，这会产生其自身的怪异之处，因为您不能创建一个运算符部分来从输入中减去一个值。 与该语言中的任何其他二元运算符不同，`(-5)`不是表示 的部分。`\x -> x - 5`一元否定和二进制减法使用相同的符号是一种不幸的情况，因为这意味着在 Haskell 的语法中必须存在这样的极端情况。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-13T01:56:36.700

当您将`suffix -5`其解释为“从后缀中减去 5”时，即认为您正在尝试将二元运算符`-`应用于参数`suffix`和`5`. 当然那是行不通的，因为你不能从函数中减去一个数字。

如果你写`suffix (-5)`，它会工作得很好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-14T05:40:37.637

Haskell 守卫从上到下匹配。`i < 0`条件永远不会匹配，因为只要`i`小于零，它就会首先匹配它上面的条件`i >= 4 || i <= 9`。

# java - 如何从2个点找到一个角度？

> ID：14845186
> 
> 赞同：2
> 
> 时间：2013-02-13T01:50:35.647
> 
> 标签：java, math

我的 Java 程序中有这个方法：

```
public static float findAngle(float x1, float y1, float x2, float y2) {
    float deltaX = Math.abs(x1 - x2);
    float deltaY = Math.abs(y1 - y2);
    return (float)(Math.atan2(deltaY, deltaX) * 180 / Math.PI);
} 
```

我是通过谷歌搜索这个问题得到的。但是，当付诸实践时，它会分裂，所以我只能得到 1-180，而在 180 之后又回到 1。我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-13T01:57:10.383

不要打电话`Math.abs`。负数和正数会给出不同的结果，因此您要保留 和 的`deltaX`符号`deltaY`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T02:05:19.760

```
public static float findAngle(float x1, float y1, float x2, float y2) {
    float deltaX = x1 - x2;
    float deltaY = y1 - y2;
    return (float)(Math.atan2(deltaY, deltaX) * 180 / Math.PI);
} 
```

# web - 如何在 3d 派对虚拟主机服务器上部署 clojure noir 网站？

> ID：14845191
> 
> 赞同：2
> 
> 时间：2013-02-13T01:51:41.730
> 
> 标签：web, clojure, hosting, noir

我已经使用 clojure (noir) 建立了自己的网站，但我不知道如何将网站部署到网络托管服务器。我知道如何在虚拟端口（localhost8080）上运行它。是否有某种方法可以将所有 clojure 代码编译成 javascript 和 html，以便第三方 Web 服务器能够理解并阅读它？还是有其他方法可以解决所有这些问题？谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T02:45:01.760

就像许多常见的 Clojure Web 框架一样，noir 构建在 ring 框架之上。Ring 生成包含在 .war 文件中的 Java servlet。托管服务提供商知道如何托管战争文件。通常，您使用 leiningen 生成一个战争文件，并通过某种方式的 Web 界面将其提供给您的托管公司（或者在 Heroku 的情况下通过 git 推送它）

将`lein-ring`插件添加到 project.clj 的插件部分

[https://github.com/weavejester/lein-ring](https://github.com/weavejester/lein-ring)

# python - 在 SQLAlchemy 中动态构造过滤器

> ID：14845196
> 
> 赞同：39
> 
> 时间：2013-02-13T01:52:19.193
> 
> 标签：python, sqlalchemy

我正在寻找一种使用 SQLAlchemy 动态构建过滤器的方法。即给定列、运算符名称和比较值，构造相应的过滤器。

我将尝试使用一个示例来说明（这将用于构建 API）。假设我们有以下模型：

```
class Cat(Model):

  id = Column(Integer, primary_key=True)
  name = Column(String)
  age = Column(Integer) 
```

我想将查询映射到过滤器。例如，

*   `/cats?filter=age;eq;3`应该生成`Cat.query.filter(Cat.age == 3)`

*   `/cats?filter=age;in;5,6,7&filter=id;ge;10`应该生成`Cat.query.filter(Cat.age.in_([5, 6, 7])).filter(Cat.id >= 10)`

我环顾四周，看看它是如何完成的，但找不到不涉及手动将每个操作员名称映射到比较器或类似内容的方法。例如，[Flask-Restless](https://flask-restless.readthedocs.org/en/latest/)保留所有支持的操作的字典并存储相应的 lambda 函数（[代码here](https://github.com/jfinkels/flask-restless/blob/master/flask_restless/search.py)）。

我在 SQLAlchemy 文档中进行了搜索，发现了两个潜在的线索，但似乎都不令人满意：

*   using `Column.like`, `Column.in_`...：这些运算符可直接在列上使用，这将使使用变得简单，`getattr`但仍然缺少一些（`==`、、`>`等）。

*   using `Column.op`: eg`Cat.name.op('=')('Hobbes')`但这似乎不适用于所有运算符（`in`即）。

有没有一种干净的方法可以在没有功能的情况下做到这一点`lambda`？

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2013-02-14T13:51:08.830

如果这对某人有用，这就是我最终要做的事情：

```
from flask import request

class Parser(object):

  sep = ';'

  # ...

  def filter_query(self, query):
    model_class = self._get_model_class(query) # returns the query's Model
    raw_filters = request.args.getlist('filter')
    for raw in raw_filters:
      try:
        key, op, value = raw.split(self.sep, 3)
      except ValueError:
        raise APIError(400, 'Invalid filter: %s' % raw)
      column = getattr(model_class, key, None)
      if not column:
        raise APIError(400, 'Invalid filter column: %s' % key)
      if op == 'in':
        filt = column.in_(value.split(','))
      else:
        try:
          attr = filter(
            lambda e: hasattr(column, e % op),
            ['%s', '%s_', '__%s__']
          )[0] % op
        except IndexError:
          raise APIError(400, 'Invalid filter operator: %s' % op)
        if value == 'null':
          value = None
        filt = getattr(column, attr)(value)
      query = query.filter(filt)
    return query 
```

这涵盖了所有 SQLAlchemy 列比较器：

*   `eq`为了`==`
*   `lt`为了`<`
*   `ge`为了`>=`
*   `in`为了`in_`
*   `like`为了`like`
*   等等

可在[此处](http://docs.sqlalchemy.org/en/rel_0_8/orm/internals.html#sqlalchemy.orm.properties.ColumnProperty.Comparator)找到包含相应名称的详尽列表。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2013-02-15T03:23:28.433

构建多个表达式过滤器时的一个有用技巧：

```
filter_group = list(Column.in_('a','b'),Column.like('%a'))
query = query.filter(and_(*filter_group)) 
```

使用这种方法将允许您将表达式与和/或逻辑结合起来。此外，这将使您避免像答案中那样的递归调用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-03-17T18:57:35.973

您可以使用**[sqlalchemy-elasticquery](https://github.com/loverajoel/sqlalchemy-elasticquery)**使用 SQLAlchemy 构建动态过滤器。

```
?filters={ "age" : 3 } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-03-18T15:31:26.463

改进[https://stackoverflow.com/a/14876320/12562701](https://stackoverflow.com/a/14876320/12562701)，可以获得更复杂的过滤器

字典映射操作

```
dict_filtros_op = {
    '==':'eq',
    '!=':'ne',
    '>':'gt',
    '<':'lt',
    '>=':'ge',
    '<=':'le',
    'like':'like',
    'ilike':'ilike',
    'in':'in'
} 
```

类道：

```
class BaseDao():
    @classmethod
    @init_db_connection
    def create_query_select(cls, model, filters=None, columns=None):
        return cls.db_session.query(*cls.create_query_columns(model=model, columns=columns))\
            .filter(*cls.create_query_filter(model=model, filters=filters))

    @classmethod
    def create_query_filter(cls, model, filters):
        '''
        return sqlalchemy filter list
        Args:
            model:sqlalchemy  model (classe das tabelas)
            filters: filter dict
                     ex:
                        filters = {
                            'or_1':{
                                'and_1':[('id', '>', 5),('id', '!=', 3)],
                                'and_2':[('fase', '==', 'arquivado')]
                            },
                            'and':[('test', '==', 'test')]
                        }
        Returns:
            filt: sqlalchemy filter list
         '''
        if not filters:
            return []

        filt = []
        for condition in filters:
            if type(filters[condition]) == dict:
                if 'and' in condition:
                    filt.append(and_(*cls.create_query_filter(model, filters[condition])))
                elif 'or' in condition:
                    filt.append(or_(*cls.create_query_filter(model, filters[condition])))
                else:
                    raise Exception('Invalid filter condition: %s' % condition)
                continue
            filt_aux = []
            for t_filter in filters[condition]:
                try:
                    column_name, op, value = t_filter
                except ValueError:
                    raise Exception('Invalid filter: %s' % t_filter)
                if not op in dict_filtros_op:
                    raise Exception('Invalid filter operation: %s' % op)
                column = getattr(model, column_name, None)
                if not column:
                    raise Exception('Invalid filter column: %s' % column_name)
                if dict_filtros_op[op] == 'in':
                    filt.append(column.in_(value))
                else:
                    try:
                        attr = list(filter(lambda e: hasattr(column, e % dict_filtros_op[op]), ['%s', '%s_', '__%s__']))[0] % dict_filtros_op[op]
                    except IndexError:
                        raise Exception('Invalid filter operator: %s' % dict_filtros_op[op])
                    if value == 'null':
                        value = None
                    filt_aux.append(getattr(column, attr)(value))
            if 'and' in condition:
                filt.append(and_(*filt_aux))
            elif 'or' in condition:
                filt.append(or_(*filt_aux))
            else:
                raise Exception('Invalid filter condition: %s' % condition)
        return filt

    @classmethod
    def create_query_columns(cls, model, columns):
        '''
        Return a list of attributes (columns) from the class model
        Args:
            model: sqlalchemy model
            columns: string list
                     ex: ['id', 'cnj']
        Returns:
            cols: list of attributes from the class model
         '''
        if not columns:
            return [model]

        cols = []
        for column in columns:
            attr = getattr(model, column, None)
            if not attr:
                raise Exception('Invalid column name %s' % column)
            cols.append(attr)
        return cols 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2019-07-22T23:04:58.960

```
class Place(db.Model):
    id = db.Column(db.Integer, primary_key=True)
    search_id = db.Column(db.Integer, db.ForeignKey('search.id'), nullable=False)

    @classmethod
    def dinamic_filter(model_class, filter_condition):
        '''
        Return filtered queryset based on condition.
        :param query: takes query
        :param filter_condition: Its a list, ie: [(key,operator,value)]
        operator list:
            eq for ==
            lt for <
            ge for >=
            in for in_
            like for like
            value could be list or a string
        :return: queryset
        '''
        __query = db.session.query(model_class)
        for raw in filter_condition:
            try:
                key, op, value = raw
            except ValueError:
                raise Exception('Invalid filter: %s' % raw)
            column = getattr(model_class, key, None)
            if not column:
                raise Exception('Invalid filter column: %s' % key)
            if op == 'in':
                if isinstance(value, list):
                    filt = column.in_(value)
                else:
                    filt = column.in_(value.split(','))
            else:
                try:
                    attr = list(filter(lambda e: hasattr(column, e % op), ['%s', '%s_', '__%s__']))[0] % op
                except IndexError:
                    raise Exception('Invalid filter operator: %s' % op)
                if value == 'null':
                    value = None
                filt = getattr(column, attr)(value)
            __query = __query.filter(filt)
        return __query 
```

执行如下：

```
places = Place.dinamic_filter([('search_id', 'eq', 1)]).all() 
```

# c++ - 我们从哪里获得 javacv 的本地库 .so 文件？

> ID：14845199
> 
> 赞同：4
> 
> 时间：2013-02-13T01:52:40.267
> 
> 标签：c++, opencv, javacv, javacpp

所以我在运行一些 javaCV 代码时遇到了问题，虽然我已经在网上看到了很多修复它，但没有一个有效。

确切的错误是 java.lang.UnsatisfiedLinkError: /tmp/javacpp/libjniopencv_core.so cannot open shared object file: no such file or directory

我查看了 /usr/local/lib （它应该在哪里查看），我在该目录中有一堆共享对象，例如 libopencv_core.so.2.4。不过，他们都没有名字中有 jni。这让我觉得我错过了一步。opencv jni so 文件应该来自哪里？

如果这很重要，我会在 Raspberry Pi (ARM) 上运行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T03:44:06.550

我要在这里回答，因为我昨晚通过电子邮件回答了，这种方法今天在实验室解决了这个问题。（我指导机器人团队试图让 javacv 工作。）

我们放弃了与它的斗争，并使用了[Jeremy 的可下载文件](http://jeremy-nicola.info/download/)。由于版本彼此一致，因此效果更好。我们仍然没有 jni .so 文件，但旧版本的 javacv 似乎没有使用它。

我还注意到[Android 指令](http://opencv.willowgarage.com/wiki/Android2.2)提供了编译 jni 的步骤，但 Linux 指令没有。如果我们要回去重新编译自己，这将是接下来要尝试的事情。由于编译需要四个小时，因此使用 Jeremy 为 Raspberry Pi 预编译的文件是一个更好的选择。

# javascript - jquery .each 在继续循环之前等待函数完成

> ID：14845200
> 
> 赞同：8
> 
> 时间：2013-02-13T01:52:58.673
> 
> 标签：javascript, jquery

我实际上是在尝试遍历 LI 标记的集合并插入一些文本来模拟某人编写待办事项列表的外观。它可以工作，但它同时写入每个列表项而不是等待。有没有简单的方法来实现这一目标？我在这里有一个 JS 小提琴设置：http: [//jsfiddle.net/fZpzT/](http://jsfiddle.net/fZpzT/)但代码看起来像这样。谢谢。

```
function addListItems() {
var str = {
    listitem1:'personal background check',
    listitem2:'look into my sketchy neighbor',
    listitem3:'look up my driving record',
    listitem4:'pick up milk',
    listitem5:'wash the car'
}

$('.list-container li').each(function(){
    var z = $(this).attr('id');
    var str2 = str[z];
    var delay = 0;
    for (var i = 0; i <= str2.length; i++) {
        (function(str2){
            delay += 100 + Math.floor(Math.random()*11)*6;
            setTimeout(function(){
                appendStr(str2);       
            },delay);
        })(str2[i])
    }
    function appendStr(str2) {
      $('#'+ z).append(str2);
    }
});
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-13T02:03:09.947

使延迟累积：[jsFiddle 上的演示](http://jsfiddle.net/FloydPink/eLPhg/4/)

```
var str = {
    listitem1: 'write the first item',
    listitem2: 'write the second item',
    listitem3: 'write the third item',
    listitem4: 'write the fourth item',
    listitem5: 'write the fifth item'
}, cumulativeDelay = 0;

$('.list-container li').each(function () {
    var z = $(this).attr('id');
    var str2 = str[z];
    var delay = cumulativeDelay;
    for (var i = 0; i <= str2.length; i++) {
        (function (str2) {
            delay += 100 + Math.floor(Math.random() * 11) * 6;
            setTimeout(function () {
                appendStr(str2);
            }, delay);
        })(str2[i])
    }
    cumulativeDelay = delay;
    function appendStr(str2) {
        $('#' + z).append(str2);
    }
    $(this).css('color', 'red');
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-13T03:10:52.760

我会扭转工作原理：

1.  你从你想写的字符串开始，
2.  对于每个字符串：

    1.  找到对应的列表项（按id）
    2.  用打字机风格写出整个字符串
    3.  完成后调用下一次迭代。

        ```
        var strings = [
          'personal background check',
          'look into my sketchy neighbor',
          'look up my driving record',
          'pick up milk',
          'wash the car'
        ];

        function iterate(strings, idx)
        {
          if (idx >= strings.length) { return; }

          var id = 'listitem' + (idx + 1),
          el = document.getElementById(id);

          typewriter(el, strings[idx], 0, function() {
            iterate(strings, idx + 1);
          });
        }

        function typewriter(el, str, idx, cb)
        {
          if (idx >= str.length) {
            return cb();
          }

          setTimeout(function() {
            el.innerText = str.substr(0, idx + 1);
            typewriter(el, str, idx + 1, cb);
          }, 100 + Math.floor(Math.random() * 11) * 6);
        } 
        ```

[**演示**](http://jsbin.com/egayah/1/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-13T02:54:45.137

怎么简化？使用两个变量在单个循环中迭代稍微修改的数据结构的全部内容。像这样。[http://jsfiddle.net/cXykd/](http://jsfiddle.net/cXykd/)

```
var strings = 
[
    { "id":"listitem1", "text": "write the first item" },
    { "id":"listitem2", "text": "write the second item" },
    { "id":"listitem3", "text": "write the third item" },
    { "id":"listitem4", "text": "write the fourth item" },
    { "id":"listitem5", "text": "write the fifth item" },
 ]

var stringsIndex = 0;
var textIndex = 0;

AddString();

function AddString(){
    if (stringsIndex < strings.length){
        if (textIndex >= strings[stringsIndex].text.length)
        {
            stringsIndex++;
            if (stringsIndex == strings.length)
            {
                return;
            }
            textIndex = 0;
        }

        $("#" + strings[stringsIndex].id).append(strings[stringsIndex].text[textIndex]);
        textIndex++;

        var delay = 10 + Math.floor(Math.random()*11)*6;
        setTimeout(AddString, delay);
    }
} 
```

# css - 单击列表中的第一项设置列表中所有其他项的样式

> ID：14845201
> 
> 赞同：0
> 
> 时间：2013-02-13T01:53:02.907
> 
> 标签：css

我正在寻找一种 CSS 解决方案，以在单击列表中的第一项时切换一组样式。即单击列表中的第一个项目，该列表中的所有其他项目都会显示：无；但是当一个人再次点击第一个项目时，所有这些项目都会重新出现，因为它们被赋予了 display:inline; 的样式。

有没有办法在没有javascript的列表中切换项目？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T02:01:33.107

用 CSS 吗？不，这不可能。但是这里完美地解决了你的 jquery 问题，我希望这会有所帮助：

```
<style>
    .first
    {
        display:inline;
    }
    .other
    {
        display:none;
    }
</style>

<div class="list first"></div>
<div class="list other"></div>
<div class="list other"></div>
<div class="list other"></div>
<div class="list other"></div>

<script>
    $(".fist").click(function(){
        $(".other").fadeToggle();
    });
</script> 
```

也适用于

```
<ul><li> 
```

和其他东西。

# c# - 尝试从二进制文件中读取字符串

> ID：14845202
> 
> 赞同：2
> 
> 时间：2013-02-13T01:53:16.380
> 
> 标签：c#, string, binaryfiles, msdn

这是一个简单的程序，我只是尝试将几个变量写入二进制文件，然后将其读回。

我试图弄清楚如何从二进制文件中读取字符串。它写对了。但是每次我尝试读取它（在这个例子中它是 4 个字节）时，结果都很奇怪，这会把所有东西都扔掉。b = "jump"，但无论我如何尝试阅读和转换，最终结果都会变得很奇怪。然后在它之后读取的变量 b 也变得很奇怪。

**从二进制文件中读取字符串的正确方法是什么？**无论如何，我所有的字符串都是固定长度的，15 个字符。有没有办法在不转换为 char 数组的情况下做到这一点？

我还尝试了 .ReadCharArrays() 方法，然后是 toString()，但我仍然没有读取正确的变量。

```
string path = ".//..//..//..//";

FileStream mfs = new FileStream(path + "test.bin", FileMode.OpenOrCreate, FileAccess.ReadWrite);
BinaryReader br = new BinaryReader(mfs);
BinaryWriter bw = new BinaryWriter(mfs);

short a = 2;
short b = 3;
string c = "JUMP";
bw.Write(a);
bw.Write(c);
bw.Write(b);

Console.WriteLine("Done writing to binary file");
br.BaseStream.Seek(0, SeekOrigin.Begin); //Apprantly you have to seek to beginning

a = br.ReadInt16();
c = br.ReadBytes(4).toString();
b = br.ReadInt16();

Console.WriteLine(""+a);
Console.WriteLine(""+c);
Console.WriteLine("");
Console.WriteLine("" +b); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T02:00:52.580

是什么让你觉得“JUMP”占用了 4 个字节？

> BinaryWriter.Write（字符串）：
> 
> 以 BinaryWriter 的当前编码将长度前缀字符串写入此流，

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-13T02:01:48.647

您应该使用 BinaryReader.ReadString() 来读回字符串 - ReadBytes 读取字节数组，默认情况下字符串是 .NET 中的 unicode。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-13T02:04:08.517

`BinaryReader.ReadString()`. I just tested your code and it appears to work fine:

```
a = br.ReadInt16();
string d = br.ReadString(); // store in another variable just to be sure..
b = br.ReadInt16();

Console.WriteLine("" + a);
Console.WriteLine("" + d); // JUMP
Console.WriteLine("");
Console.WriteLine("" + b); 
```

# python - 使用 Alembic 更改枚举字段

> ID：14845203
> 
> 赞同：67
> 
> 时间：2013-02-13T01:53:19.837
> 
> 标签：python, postgresql, sqlalchemy, alembic

当使用早于 9.1 的 PostgreSQL 版本（为枚举添加 ALTER TYPE）时，如何在 alembic 迁移中将元素添加到 Enum 字段？[这个](https://stackoverflow.com/questions/1771543/postgresql-updating-an-enum-type)SO question 解释了直接过程，但我不太确定如何最好地使用 alembic 翻译它。

这就是我所拥有的：

```
new_type = sa.Enum('nonexistent_executable', 'output_limit_exceeded',
                   'signal', 'success', 'timed_out', name='status')
old_type = sa.Enum('nonexistent_executable', 'signal', 'success', 'timed_out',
                   name='status')
tcr = sa.sql.table('testcaseresult',
                   sa.Column('status', new_type, nullable=False))

def upgrade():
    op.alter_column('testcaseresult', u'status', type_=new_type,
                    existing_type=old_type)

def downgrade():
    op.execute(tcr.update().where(tcr.c.status==u'output_limit_exceeded')
               .values(status='timed_out'))
    op.alter_column('testcaseresult', u'status', type_=old_type,
                    existing_type=new_type) 
```

不幸的是，上述内容仅`ALTER TABLE testcaseresult ALTER COLUMN status TYPE status`在升级时产生，基本上什么都不做。

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2013-02-13T03:04:03.253

我决定尝试尽可能直接地遵循[postgres 方法](https://stackoverflow.com/questions/1771543/postgresql-updating-an-enum-type)，并提出了以下迁移。

```
from alembic import op
import sqlalchemy as sa

old_options = ('nonexistent_executable', 'signal', 'success', 'timed_out')
new_options = sorted(old_options + ('output_limit_exceeded',))

old_type = sa.Enum(*old_options, name='status')
new_type = sa.Enum(*new_options, name='status')
tmp_type = sa.Enum(*new_options, name='_status')

tcr = sa.sql.table('testcaseresult',
                   sa.Column('status', new_type, nullable=False))

def upgrade():
    # Create a tempoary "_status" type, convert and drop the "old" type
    tmp_type.create(op.get_bind(), checkfirst=False)
    op.execute('ALTER TABLE testcaseresult ALTER COLUMN status TYPE _status'
               ' USING status::text::_status')
    old_type.drop(op.get_bind(), checkfirst=False)
    # Create and convert to the "new" status type
    new_type.create(op.get_bind(), checkfirst=False)
    op.execute('ALTER TABLE testcaseresult ALTER COLUMN status TYPE status'
               ' USING status::text::status')
    tmp_type.drop(op.get_bind(), checkfirst=False)

def downgrade():
    # Convert 'output_limit_exceeded' status into 'timed_out'
    op.execute(tcr.update().where(tcr.c.status==u'output_limit_exceeded')
               .values(status='timed_out'))
    # Create a tempoary "_status" type, convert and drop the "new" type
    tmp_type.create(op.get_bind(), checkfirst=False)
    op.execute('ALTER TABLE testcaseresult ALTER COLUMN status TYPE _status'
               ' USING status::text::_status')
    new_type.drop(op.get_bind(), checkfirst=False)
    # Create and convert to the "old" status type
    old_type.create(op.get_bind(), checkfirst=False)
    op.execute('ALTER TABLE testcaseresult ALTER COLUMN status TYPE status'
               ' USING status::text::status')
    tmp_type.drop(op.get_bind(), checkfirst=False) 
```

看来，alembic`USING`在其`alter_table`方法中没有直接支持该声明。

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2015-11-09T20:39:27.777

我使用了一种比我基于此的公认答案更简单的方法，步骤更少。在此示例中，我将假装有问题的枚举称为“status_enum”，因为在接受的答案中，列和枚举都使用“状态”使我感到困惑。

```
from alembic import op 
import sqlalchemy as sa

name = 'status_enum'
tmp_name = 'tmp_' + name

old_options = ('nonexistent_executable', 'signal', 'success', 'timed_out')
new_options = sorted(old_options + ('output_limit_exceeded',))

new_type = sa.Enum(*new_options, name=name)
old_type = sa.Enum(*old_options, name=name)

tcr = sa.sql.table('testcaseresult',
                   sa.Column('status', new_type, nullable=False))

def upgrade():
    op.execute('ALTER TYPE ' + name + ' RENAME TO ' + tmp_name)

    new_type.create(op.get_bind())
    op.execute('ALTER TABLE testcaseresult ALTER COLUMN status ' +
               'TYPE ' + name + ' USING status::text::' + name)
    op.execute('DROP TYPE ' + tmp_name)

def downgrade():
    # Convert 'output_limit_exceeded' status into 'timed_out'                                                                                                                      
    op.execute(tcr.update().where(tcr.c.status=='output_limit_exceeded')
               .values(status='timed_out'))

    op.execute('ALTER TYPE ' + name + ' RENAME TO ' + tmp_name)

    old_type.create(op.get_bind())
    op.execute('ALTER TABLE testcaseresult ALTER COLUMN status ' +
               'TYPE ' + name + ' USING status::text::' + name)
    op.execute('DROP TYPE ' + tmp_name) 
```

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2018-07-20T09:19:47.507

这运行没有问题：

```
from alembic import op

def upgrade():
    op.execute("COMMIT")
    op.execute("ALTER TYPE enum_type ADD VALUE 'new_value'")

def downgrade():
    ... 
```

[参考](https://bitbucket.org/zzzeek/alembic/issues/123/a-way-to-run-non-transactional-ddl)

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2015-06-18T08:38:53.543

从 Postgres 9.1 开始，可以使用[`ALTER TYPE`](http://www.postgresql.org/docs/9.1/static/sql-altertype.html)语句向枚举添加新值。[由于不能在事务中完成](http://www.postgresql.org/docs/9.1/static/sql-altertype.html#AEN63173)，因此这很复杂。然而，这可以通过提交 alembic 的事务来解决，[请参见此处](https://bitbucket.org/zzzeek/alembic/issue/123/a-way-to-run-non-transactional-ddl)。

实际上，我在使用旧的、更详细的解决方案时遇到了问题，因为 Postgres 无法自动转换列的默认值。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2017-08-10T13:37:22.647

我在尝试将列类型迁移到另一个时遇到了同样的问题。我使用以下要求：

```
Alembic==0.9.4
SQLAlchemy==1.1.12 
```

您可以将参数提供`postgresql_using`为`alembic.op.alter_column`.

```
from alembic import op
import sqlalchemy as types

op.alter_column(
    table_name='my_table',
    column_name='my_column',
    type_=types.NewType,
    # allows to use postgresql USING
    postgresql_using="my_column::PostgesEquivalentOfNewType",
) 
```

我希望它可以帮助。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2013-05-29T18:33:26.877

在直接 SQL 中，这适用于 Postgres，如果您的枚举中的事物的顺序不需要与上面完全相同：

```
ALTER TYPE status ADD value 'output_limit_exceeded' after 'timed_out'; 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2021-03-11T13:38:37.900

首先将列类型更改为 VARCHAR()。

然后删除您的类型并使用新字段创建新类型。

最后将您的列类型更改为新创建的类型。

```
def upgrade():
    op.execute(
        '''
        ALTER TABLE your_table ALTER COLUMN your_enum_column TYPE VARCHAR(255);

        DROP TYPE IF EXISTS your_enum_type;

        CREATE TYPE your_enum_type AS ENUM 
            ('value1', 'value2', 'value3', 'value4');

        ALTER TABLE your_table ALTER COLUMN your_enum_column TYPE your_enum_type 
            USING (your_enum_column::your_enum_type);
        '''
    )

def downgrade():
    op.execute(
        '''
        ALTER TABLE your_table ALTER COLUMN your_enum_column TYPE VARCHAR(255);

        DROP TYPE IF EXISTS your_enum_type;

        CREATE TYPE your_enum_type AS ENUM 
            ('value1', 'value2', 'value3');

        ALTER TABLE your_table ALTER COLUMN your_enum_column TYPE your_enum_type 
            USING (your_enum_column::your_enum_type);
        '''
    ) 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2018-08-20T01:39:30.767

我需要在迁移类型时移动数据，包括删除一些旧类型，所以我想我会根据（真棒）接受的答案（[https://stackoverflow.com/a/14845740 ）写一个更通用的方法/629272](https://stackoverflow.com/a/14845740/629272)）。希望这可以帮助同一条船上的其他人！

```
# This migration will move data from one column to two others based on the type
# for a given row, and modify the type of each row.
from alembic import op
import sqlalchemy as sa
from sqlalchemy.dialects import postgresql

revision = '000000000001'
down_revision = '000000000000'
branch_labels = None
depends_on = None

# This set of options makes up the old type.
example_types_old = (
    'EXAMPLE_A',
    'EXAMPLE_B',
    'EXAMPLE_C',
)
example_type_enum_old = postgresql.ENUM(*example_types_old, name='exampletype')

# This set of options makes up the new type.
example_types_new = (
    'EXAMPLE_C',
    'EXAMPLE_D',
    'EXAMPLE_E',
)
example_type_enum_new = postgresql.ENUM(*example_types_new, name='exampletype')

# This set of options includes everything from the old and new types.
example_types_tmp = set(example_types_old + example_types_new)
example_type_enum_tmp = postgresql.ENUM(*example_types_tmp, name='_exampletype')

# This is a table view from which we can select and update as necessary. This
# only needs to include the relevant columns which are in either the old or new
# version of the table.
examples_view = sa.Table(
    # Use the name of the actual table so it is modified in the upgrade and
    # downgrade.
    'examples',
    sa.MetaData(),
    sa.Column('id', sa.Integer, primary_key=True),
    # Use the _tmp type so all types are usable.
    sa.Column('example_type', example_type_enum_tmp),
    # This is a column from which the data will be migrated, after which the
    # column will be removed.
    sa.Column('example_old_column', sa.Integer),
    # This is a column to which data from the old column will be added if the
    # type is EXAMPLE_A.
    sa.Column('example_new_column_a', sa.Integer),
    # This is a column to which data from the old column will be added if the
    # type is EXAMPLE_B.
    sa.Column('example_new_column_b', sa.Integer),
)

def upgrade():
    connection = op.get_bind()

    # Add the new column to which data will be migrated.
    example_new_column_a = sa.Column(
        'example_new_column_a',
        sa.Integer,
        nullable=True
    )
    op.add_column('examples', example_new_column_a)

    # Add the new column to which data will be migrated.
    example_new_column_b = sa.Column(
        'example_new_column_b',
        sa.Integer,
        nullable=True
    )
    op.add_column('examples', example_new_column_b)

    # Create the temporary enum and change the example_type column to use the
    # temporary enum.
    # The USING statement automatically maps the old enum to the temporary one.
    example_type_enum_tmp.create(connection, checkfirst=False)
    # Change to the temporary type and map from the old type to the temporary
    # one.
    op.execute('''
        ALTER TABLE examples
            ALTER COLUMN example_type
                TYPE _exampletype
                USING example_type::text::_exampletype
    ''')

    # Move data from example_old_column to example_new_column_a and change its
    # type to EXAMPLE_D if the type is EXAMPLE_A.
    connection.execute(
        examples_view.update().where(
            examples_view.c.example_type == 'EXAMPLE_A'
        ).values(
            example_type='EXAMPLE_D',
            example_new_column_a=examples_view.c.example_old_column,
        )
    )

    # Move data from example_old_column to example_new_column_b and change its
    # type to EXAMPLE_E if the type is EXAMPLE_B.
    connection.execute(
        examples_view.update().where(
            examples_view.c.example_type == 'EXAMPLE_B'
        ).values(
            example_type='EXAMPLE_E',
            example_new_column_b=examples_view.c.example_old_column,
        )
    )

    # Move any remaining data from example_old_column to example_new_column_a
    # and keep its type as EXAMPLE_C.
    connection.execute(
        examples_view.update().where(
            examples_view.c.example_type == 'EXAMPLE_C'
        ).values(
            example_type='EXAMPLE_C',
            example_new_column_a=examples_view.c.example_old_column,
        )
    )

    # Delete the old enum now that the data with the old types have been moved.
    example_type_enum_old.drop(connection, checkfirst=False)

    # Create the new enum and change the example_type column to use the new
    # enum.
    # The USING statement automatically maps the temporary enum to the new one.
    example_type_enum_new.create(connection, checkfirst=False)
    op.execute('''
        ALTER TABLE examples
            ALTER COLUMN example_type
                TYPE exampletype
                USING example_type::text::exampletype
    ''')

    # Delete the temporary enum.
    example_type_enum_tmp.drop(connection, checkfirst=False)

    # Remove the old column.
    op.drop_column('examples', 'example_old_column')

# The downgrade just performs the opposite of all the upgrade operations but in
# reverse.
def downgrade():
    connection = op.get_bind()

    example_old_column = sa.Column(
        'example_old_column',
        sa.Integer,
        nullable=True
    )
    op.add_column('examples', example_old_column)

    example_type_enum_tmp.create(connection, checkfirst=False)
    op.execute('''
        ALTER TABLE examples
            ALTER COLUMN example_type
                TYPE _exampletype
                USING example_type::text::_exampletype
    ''')

    connection.execute(
        examples_view.update().where(
            examples_view.c.example_type == 'EXAMPLE_C'
        ).values(
            example_type='EXAMPLE_C',
            example_old_column=examples_view.c.example_new_column_b,
        )
    )

    connection.execute(
        examples_view.update().where(
            examples_view.c.example_type == 'EXAMPLE_E'
        ).values(
            example_type='EXAMPLE_B',
            example_old_column=examples_view.c.example_new_column_b,
        )
    )

    connection.execute(
        examples_view.update().where(
            examples_view.c.example_type == 'EXAMPLE_D'
        ).values(
            example_type='EXAMPLE_A',
            example_old_column=examples_view.c.example_new_column_a,
        )
    )

    example_type_enum_old.create(connection, checkfirst=False)
    op.execute('''
        ALTER TABLE examples
            ALTER COLUMN example_type
                TYPE exampletype
                USING example_type::text::exampletype
    ''')

    example_type_enum_tmp.drop(connection, checkfirst=False)

    op.drop_column('examples', 'example_new_column_b')
    op.drop_column('examples', 'example_new_column_a') 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2020-01-13T09:49:31.367

找到另一个方便的方法

```
op.execute('ALTER TYPE enum_type ADD VALUE new_value')
op.execute('ALTER TYPE enum_type ADD VALUE new_value BEFORE old_value')
op.execute('ALTER TYPE enum_type ADD VALUE new_value AFTER old_value') 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2020-12-24T15:47:26.937

**此方法可用于更新枚举**

```
def upgrade():
    op.execute("ALTER TYPE categorytype RENAME VALUE 'EXAMPLE_A' TO 'EXAMPLE_B'")

def downgrade():
    op.execute("ALTER TYPE categorytype RENAME VALUE 'EXAMPLE_B' TO 'EXAMPLE_A'") 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2021-07-04T19:17:32.470

这种方法类似于[公认的解决方案](https://stackoverflow.com/a/14845740/8445442)，但有细微差别：

1.  它使用`op.batch_alter_table`而不是`op.execute('ALTER TABLE')`，因此此解决方案适用于 PostgreSQL 和 SQLite：SQLite 不支持`ALTER TABLE`，但 alembic 提供了对它的支持`op.batch_alter_table`
2.  它不使用原始 SQL

```
from alembic import op
import sqlalchemy as sa

# Describing of enum
enum_name = "status"
temp_enum_name = f"temp_{enum_name}"
old_values = ("nonexistent_executable", "signal", "success", "timed_out")
new_values = ("output_limit_exceeded", *old_values)
downgrade_to = ("output_limit_exceeded", "timed_out") # on downgrade convert [0] to [1]
old_type = sa.Enum(*old_values, name=enum_name)
new_type = sa.Enum(*new_values, name=enum_name)
temp_type = sa.Enum(*new_values, name=temp_enum_name)

# Describing of table
table_name = "testcaseresult"
column_name = "status"
temp_table = sa.sql.table(
    table_name,
    sa.Column(
        column_name,
        new_type,
        nullable=False
    )
)

def upgrade():
    # temp type to use instead of old one
    temp_type.create(op.get_bind(), checkfirst=False)

    # changing of column type from old enum to new one.
    # SQLite will create temp table for this
    with op.batch_alter_table(table_name) as batch_op:
        batch_op.alter_column(
            column_name,
            existing_type=old_type,
            type_=temp_type,
            existing_nullable=False,
            postgresql_using=f"{column_name}::text::{temp_enum_name}"
        )

    # remove old enum, create new enum
    old_type.drop(op.get_bind(), checkfirst=False)
    new_type.create(op.get_bind(), checkfirst=False)

    # changing of column type from temp enum to new one.
    # SQLite will create temp table for this
    with op.batch_alter_table(table_name) as batch_op:
        batch_op.alter_column(
            column_name,
            existing_type=temp_type,
            type_=new_type,
            existing_nullable=False,
            postgresql_using=f"{column_name}::text::{enum_name}"
        )

    # remove temp enum
    temp_type.drop(op.get_bind(), checkfirst=False)

def downgrade():
    # old enum don't have new value anymore.
    # before downgrading from new enum to old one,
    # we should replace new value from new enum with
    # somewhat of old values from old enum
    op.execute(
        temp_table
        .update()
        .where(
            temp_table.c.status == downgrade_to[0]
        )
        .values(
            status=downgrade_to[1]
        )
    )

    temp_type.create(op.get_bind(), checkfirst=False)

    with op.batch_alter_table(table_name) as batch_op:
        batch_op.alter_column(
            column_name,
            existing_type=new_type,
            type_=temp_type,
            existing_nullable=False,
            postgresql_using=f"{column_name}::text::{temp_enum_name}"
        )

    new_type.drop(op.get_bind(), checkfirst=False)
    old_type.create(op.get_bind(), checkfirst=False)

    with op.batch_alter_table(table_name) as batch_op:
        batch_op.alter_column(
            column_name,
            existing_type=temp_type,
            type_=old_type,
            existing_nullable=False,
            postgresql_using=f"{column_name}::text::{enum_name}"
        )

    temp_type.drop(op.get_bind(), checkfirst=False) 
```

从公认的解决方案：

> 似乎 alembic 在其 alter_table 方法中没有直接支持 USING 语句。

目前，alembic`USING`在其`alter_table`方法中支持声明。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2019-09-12T16:49:25.337

由于我遇到了转换错误和默认值问题，因此我根据接受的答案写了一个更通用的答案：

```
def replace_enum_values(
        name: str,
        old: [str],
        new: [str],
        modify: [(str, str, str)]
):
    """
    Replaces an enum's list of values.

    Args:
        name: Name of the enum
        new: New list of values
        old: Old list of values
        modify: List of tuples of table name
        and column to modify (which actively use the enum).
        Assumes each column has a default val.
    """
    connection = op.get_bind()

    tmp_name = "{}_tmp".format(name)

    # Rename old type
    op.execute(
        "ALTER TYPE {} RENAME TO {};"
        .format(name, tmp_name)
    )

    # Create new type
    lsl = sa.Enum(*new, name=name)
    lsl.create(connection)

    # Replace all usages
    for (table, column) in modify:
        # Get default to re-set later
        default_typed = connection.execute(
            "SELECT column_default "
            "FROM information_schema.columns "
            "WHERE table_name='{table}' "
            "AND column_name='{column}';"
            .format(table=table, column=column)
        ).first()[0]  # type: str

        # Is bracketed already
        default = default_typed[:default_typed.index("::")]

        # Set all now invalid values to default
        connection.execute(
            "UPDATE {table} "
            "SET {column}={default} "
            "WHERE {column} NOT IN {allowed};"
            .format(
                table=table,
                column=column,
                # Invalid: What isn't contained in both new and old
                # Can't just remove what's not in new because we get
                # a type error
                allowed=tuple(set(old).intersection(set(new))),
                default=default
            )
        )

        op.execute(
            "ALTER TABLE {table} "
            # Default needs to be dropped first
            "ALTER COLUMN {column} DROP DEFAULT,"
            # Replace the tpye
            "ALTER COLUMN {column} TYPE {enum_name} USING {column}::text::{enum_name},"
            # Reset default
            "ALTER COLUMN {column} SET DEFAULT {default};"
            .format(
                table=table,
                column=column,
                enum_name=name,
                default=default
            )
        )

    # Remove old type
    op.execute("DROP TYPE {};".format(tmp_name)) 
```

这可以从升级/降级中调用，如下所示：

```
replace_enum_values(
    name='enum_name',
    new=["A", "B"],
    old=["A", "C"],
    modify=[('some_table', 'some_column')]
) 
```

所有无效值都将设置为 server_default。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2021-04-02T05:03:44.813

## 观察

为了减轻迁移时的痛苦，**即使使用 PostgreSQL，我也总是使用非本地枚举**。

非原生枚举只是带有约束的字符串，如果你编辑一个枚举，只有三种情况：

1.  重命名枚举值
2.  删除枚举值
3.  添加枚举值。

对于迁移，2 和 3 是一对。这是可以理解的：如果你升级是为了添加，那么你必须在降级时删除，反之亦然。因此，让我们将它们分为两种类型。

## 执行

如果要重命名，通常我会将其分为三个步骤：

1.  放弃旧的约束
2.  将行的旧值更新为新值
3.  创建新约束

在 alembic 中，这是通过以下方式完成的：

```
def update_enum(
    table, column, enum_class_name, target_values, olds_to_remove, news_to_add
):
    op.drop_constraint(f"ck_{table}_{enum_class_name}", table)

    for sql in update_enum_sqls(table, column, olds_to_remove, news_to_add):
        op.execute(sql)

    op.create_check_constraint(
        enum_class_name, table, sa.sql.column(column).in_(target_values)
    ) 
```

让我们先忘记`update_enum_sqls`它，将其用作 SQL 生成器。

如果它正在删除，那么仍然有三个步骤：

1.  放弃旧的约束
2.  删除具有旧值的行
3.  创建新约束

所以基本上只有`update_enum_sqls`可能的行为不同。

如果是添加，只需两步：

1.  放弃旧的约束
2.  创建新约束

不过，我们可以忽略`update_enum_sqls`.

那么如何实现呢？没那么难...

```
def update_enum_sql(table, column, old_value, new_value):
    if new_value is not None:
        return f"UPDATE {table} SET {column} = '{new_value}' where {column} = '{old_value}'"
    else:
        return f"DELETE FROM {table} where {column} = '{old_value}'"

def update_enum_sqls(table, column, olds_to_remove, news_to_add):
    if len(olds_to_remove) != len(news_to_add):
        raise NotImplementedError
    return [
        update_enum_sql(table, column, old, new)
        for old, new in zip(olds_to_remove, news_to_add)
    ] 
```

## 例子

既然我们准备了配料，让我们申请：

```
def upgrade():
    # rename enum
    update_enum(
        "my_table",
        "my_enum",
        "myenumclassname",
        ["NEW", "ENUM", "VALUES"],
        ["OLD"],
        ["NEW"],
    )

    # add enum
    update_enum(
        "my_table",
        "my_enum",
        "myenumclassname",
        ["NEW", "ENUM", "VALUES"],
        [],
        [],
    )

def downgrade():
    # remove enum
    update_enum(
        "my_table",
        "my_enum",
        "myenumclassname",
        ["ENUM", "VALUES"],
        ["NEW"],
        [None],  # this will delete rows with "NEW", USE WITH CARE!!!
    )

    # edit enum
    update_enum(
        "my_table",
        "my_enum",
        "myenumclassname",
        ["OLD", "ENUM", "VALUES"],
        ["NEW"],
        ["OLD"],
    ) 
```

上面的代码也可以在[gist](https://gist.github.com/kigawas/b19952e7c40b46566753684800a9ddea)上找到。

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2020-12-09T18:32:47.207

该解决方案易于理解，并且对于升级和降级都非常有效。我已经以更详细的方式写了这个答案。

假设我们的`enum_type`外观是这样的：

```
enum_type = ('some_value_1', 'some_value_2') 
```

我想`enum_type`通过添加一个新的枚举来改变，使它变成这样：

```
enum_type = ('some_value_1', 'some_value_2', 'new_value') 
```

这可以通过以下方式完成：

```
from alembic import op

def upgrade():
    op.execute("COMMIT")
    op.execute("ALTER TYPE enum_type ADD VALUE 'new_value'")

def downgrade():
    # Drop 'new_value' from enum_type
    op.execute("ALTER TYPE enum_type RENAME TO enum_type_tmp")

    op.execute("CREATE TYPE enum_type AS ENUM('some_value_1', 'some_value_1')")

    op.execute("DROP TYPE enum_type_tmp") 
```

**注意：在降级过程中，如果您`enum_type`在表格中使用，那么您可以修改降级方法，如下所述：**

```
def downgrade():
    # Drop 'new_value' from enum_type
    op.execute("UPDATE table_name"
               " SET column_name_using_enum_type_value = NULL"
               " WHERE column_name_using_enum_type_value = 'new_value'")    

    op.execute("ALTER TYPE enum_type RENAME TO enum_type_tmp")

    op.execute("CREATE TYPE enum_type AS ENUM('some_value_1', 'some_value_1')")

    op.execute("ALTER TABLE table_name"
               " ALTER COLUMN column_name_using_enum_type_value TYPE enum_type"
               " USING column_name_using_enum_type_value::text::enum_type")

    op.execute("DROP TYPE enum_type_tmp") 
```

# sql - 在 Stata 中创建和使用临时/易失数据库表

> ID：14845209
> 
> 赞同：4
> 
> 时间：2013-02-13T01:54:27.943
> 
> 标签：sql, odbc, stata, teradata

## 附录：从 Stata 14 开始，易失性表可以在没有任何黑客攻击的情况下工作。

有没有办法调整 Stata 以使用临时易失性表？在用户注销会话后，这些表和数据将被删除。

这是我在 Stata 和 Teradata 中使用的简单**玩具**SQL 查询的示例：

```
odbc load,  exec("
    BEGIN TRANSACTION;
    CREATE VOLATILE MULTISET TABLE vol_tab AS (
        SELECT TOP 10 user_id
        FROM dw_users
    ) WITH DATA
    PRIMARY INDEX(user_id)
    ON COMMIT PRESERVE ROWS;

    SELECT * FROM vol_tab;
    END TRANSACTION;
") dsn("mozart"); 
```

这是我收到的错误消息：

```
The ODBC driver reported the following diagnostics
[Teradata][ODBC Teradata Driver][Teradata Database] Only an ET or null statement is legal after a DDL Statement.
SQLSTATE=25000
r(682); 
```

Stata错误代码意味着：

> 错误 。. . . . . . . . . . . . . . . . . . . . . . . 返回码 682 无法连接到 odbc dsn；这通常是由于不正确的权限（例如错误的用户名或密码）而发生的。使用 set debug on 显示 ODBC 驱动程序生成的实际错误消息。

据我所知，权限很好，因为如果我只执行“SELECT TOP 10 ...”查询，我就可以提取数据。我设置了调试，但它没有产生任何额外的信息。

会话模式是 Teradata。ODBC 管理器设置为 unixODBC。我在 Ubuntu 服务器上使用 Stata 13.1。

我相信潜在的问题可能是[为每个 SQL 语句建立了单独的连接](http://www.stata.com/manuals13/dodbc.pdf#page=4&search=%22only%20one%20connection%22)，因此在发出 select 时易失性表消失了。我正在等待技术支持来验证这一点。

我尝试`odbc sqlfile`很好地使用该命令，但除非我在它的末尾创建一个永久表，否则这种方法不起作用。没有加载选项`odbc sqlfile`。

[易失性表在SAS](http://support.sas.com/documentation/cdl/en/acreldb/63647/HTML/default/viewer.htm#a002677096.htm)和 R中似乎工作得很好。例如，这完美地工作：

```
library("RODBC")
db <- odbcConnect("mozart")
sqlQuery(db,"CREATE VOLATILE MULTISET TABLE vol_tab AS (
         SELECT TOP 10 user_id
         FROM dw_users
     ) WITH DATA
     PRIMARY INDEX(user_id)
     ON COMMIT PRESERVE ROWS;
")
data<- sqlQuery(db,"select * from vol_tab;",rows_at_time=1) 
```

也许这是因为与 DB 的连接在`close(db)`.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T20:10:06.833

我不熟悉 Stata，但我猜您的 ODBC 正在以“ANSI”模式连接。尝试在`create volatile table`和`select`语句之间添加：

```
commit work; 
```

如果这不起作用，您可能需要以某种方式进行两次单独的调用。

**更新：** 多想一下，也许你可以试试这个：

```
odbc load, exec("select distinct user_id from dw_users where cast(date_confirm as
date) > '2011-09-15'") clear dsn("mozart") lowercase; 
```

换句话说，只需一步执行查询；不要尝试创建易失性表。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-20T15:19:15.727

如果您在连接模式为 TERADATA 时尝试以下操作（这通常不是默认的），该怎么办：

```
odbc load, exec("BT; create volatile table new_usr as
(select top 10 user_id from dw_users) with data primary index(user_id) on commit
preserve rows; 
ET;

select * from new_usr;") clear dsn("mozart") lowercase; 
```

`BT;`and语句将`ET;`包含在显式事务中的 SQL 包装起来。此 SQL 已在 SQL 助手中测试，因为我无权访问您正在使用的工具。通常，`BT`用于`ET`强制执行必须成功完成或所有内容都回滚的逻辑事务（或工作单元）。这可以让您解决您在工具中遇到的问题。

**编辑**

如果无法将 Volatile Table 创建包装在 BT 和 ET 中，您是否有能力创建一个存储过程或宏来嵌入完成任务所需的所有逻辑，然后从 Stata 调用存储过程或宏？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-03-11T01:23:24.017

放

英国电信；--UR 逻辑-- ET；

如果中间有任何事情失败。它会回滚

从[这里得到](http://forums.teradata.com/forum/database/3932-only-an-et-or-null-statement-is-legal-after-a-ddl-statement)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-12-03T03:10:27.907

这个答案不再正确。只要将`multistatement`选项添加到`odbc`命令中，Stata 现在就允许多个 SQL 语句。

* * *

Stata 的`odbc`命令不允许将多个 SQL 语句组合成一个`odbc`命令并改变 TD 的模式。它还为`odbc`发出的每个命令创建一个单独的连接，因此当您想要使用它来做某事时，易失性表就会消失。这使得无法直接使用易失性表。

但是，有一种方法可以通过 Stata 使用 R 来生成 Stata 数据文件。您需要`rsource`从 SSC 和`foreign`R中的包进行安装。可以在 sysprofile.ado 或您自己的 profile.ado 中定义`RODBC`2 个全局变量 Rterm_path 和 Rterm_options 。`rsource`据我所知，R 不允许导出时间戳，所以我必须手动对日期和时间戳进行一些转换。[这些转换与Stata 手册](http://www.stata.com/manuals13/ddatetime.pdf#page=10)和[Stata 博客](http://blog.stata.com/2011/01/05/using-dates-and-times-from-other-software/)中的建议有些不一致。

```
rsource, terminator(END_OF_R)
  library("RODBC")
  library("foreign")
  db <- odbcConnect("mydsn")
  sqlQuery(db,"CREATE VOLATILE MULTISET TABLE vol_tab AS (SELECT ...) WITH DATA PRIMARY INDEX(...) ON COMMIT PRESERVE ROWS;")
  data<- sqlQuery(db,"SELECT * FROM vol_tab;",rows_at_time=1)
  write.dta(data,"mydata.dta",convert.dates = FALSE)
  close(db)
END_OF_R

use "mydata.dta", replace
/* convert dates and timestamps to Stata format */
gen stata_date = rdate + td(01jan1970)
format stata_date %td
gen double stata_timestamp = (rtimestamp + 315594000)*1000
format stata_timestamp %tc 
```

# objective-c - .m 文件到字符串

> ID：14845212
> 
> 赞同：0
> 
> 时间：2013-02-13T01:54:43.407
> 
> 标签：objective-c, xcode, string, macos, nsfilemanager

我正在尝试将`.m`文件转换为字符串。我将在文件夹中搜索文件，然后想将其每个内容用作字符串。这是我正在使用的代码：

```
- (IBAction)searchAction:(id)sender {

    NSFileManager *fm = [NSFileManager defaultManager];
    NSArray *dirContents = [fm contentsOfDirectoryAtPath:folderLabel.stringValue error:nil];
    NSPredicate *fltr = [NSPredicate predicateWithFormat:@"self ENDSWITH '.m'"];
    NSArray *onlyMs = [dirContents filteredArrayUsingPredicate:fltr];

    for (int i=0; i<[onlyMs count]; i++) {

        NSString* text = [[NSString alloc] initWithContentsOfFile:[onlyMs objectAtIndex:i]
                                            encoding:NSUTF8StringEncoding
                                            error:nil];
        NSLog(@"string: %@", text);

    }        
}

2013-02-13 02:38:05.700 LocalizedStringSearch[19001:303] string: (null) 
```

除了这里，所有返回的日志都是空的，即使它会正确找到所有 .m 文件。

有人知道我在做什么错吗？

非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T02:05:35.577

1.  我认为`contentsOfDirectoryAtPath:`只给你一个文件名数组，而不是完整的路径名，所以你需要在打开文件之前添加路径。编辑：我想我可能会混淆`enumeratorAtPath:`......如果是这样，请继续使用您拥有的文件名，而不是将它们附加到原始文件夹名称。

2.  这是一个示例（未经测试）：

    ```
    NSString *fullPath = [folderLabel.stringValue stringByAppendingPathComponent:[onlyMs objectAtIndex:i];
    NSError *error = nil;
    NSString *text = [[NSString alloc] initWithContentsofFile:fullPath
                                                     encoding:NSUTF8StringEncoding
                                                        error:&error];

    if (text == nil)
        NSLog(@"%@", error);
    else
        NSLog(@"%@", text); 
    ```

3.  仅当文件实际使用 UTF-8 编码时，上述方法才有效。如果您不确定编码，可以让框架尝试通过以下方式为您解决：

    ```
    NSString *fullPath = [folderLabel.stringValue stringByAppendingPathComponent:[onlyMs objectAtIndex:i];
    NSError *error = nil;
    NSStringEncoding enc;
    NSString *text = [[NSString alloc] initWithContentsofFile:fullPath
                                                 usedEncoding:&enc
                                                        error:&error];

    if (text == nil)
        NSLog(@"%@", error);
    else
        NSLog(@"%@", text); 
    ```

# css - 背景图像和滚动条

> ID：14845213
> 
> 赞同：0
> 
> 时间：2013-02-13T01:54:43.903
> 
> 标签：css, scrollbar, background-image

有一个带有背景的页面。之前以 img:src 的形式给出。但我无法在上面插入文字。因此，我将该代码更改为背景图像。到目前为止一切正常。

然后我要插入的文字很长，超过了背景的高度。我必须添加一个卷轴。我插入了 max-height 但在这里感到困惑。

这里的页面是：[http ://www.heptasarim.com/test/cezayir2/menuler2.html](http://www.heptasarim.com/test/cezayir2/menuler2.html)

背景地址：/cezayir/images/menuorta.png

HTML：

```
 <div id="menuorta2">
        <p style="background-image:url(images/menuorta.png); background-repeat:no-repeat; width:812px; height:404px;" id="myazi">
        <span class="mbaslik">Kokteyl Prolonge Menü</span><br />
        <strong>menü:</strong><br />
        <strong>soğuk gezenler:</strong><br />
        biberli zeytin ve marine somon<br />
        tartolet içinde nar ekşili patlıcan salata<br />
        hindi füme badem turşu ve hardal<br />
        marine zeytin ve peynir şiş<br />
        <strong>sıcak gezenler:</strong><br />
        şişte ızgara limon ve kalamar<br />
        susamlı et<br />
        sigara böreği<br />
        <strong>sıcak büfe:</strong><br />
        dana külbastı<br />
        kuru erikli tavuk<br />
        patlıcan beğendi<br />
        pilav ve salata<br />
        <strong>tatlılar:</strong><br />
        bal kabaklı cheese cake<br />
        portakallı irmik helvası<br />
        </p>

</div> 
```

CSS：

```
 #menuorta {
top:165px;
left:50px;
position:absolute;
z-index:0;
}
#menuorta2 {
top:127px;
left:20px;
position:absolute;
z-index:1;
}
#myazi {
color:#401c17;
font-weight:100;
font-family:Bookman Old Style;
font-size:13px;
padding:40px 65px;
max-height:200px;
overflow:hidden;
}
.mbaslik {
font-weight:bold;
font-size:16px;
} 
```

**固定的 ：**

```
background: url(../image/menuorta.png) no-repeat; 
```

**..**和**/**

非常非常非常感谢大家。特别是@ferne97

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T02:11:42.327

将其设置为您想要的宽度和高度并添加一个`overflow-y: scoll;`。

```
#myazi {
    width: 600px;
    height: 200px;
    overflow-y: scroll;
} 
```

如果你想让背景大于滚动区域，可以像这样在里面放置另一个 div。

```
<div id="myazi">
    <div class="inner-scroll">
        <!-- content here -->
    </div>
</div> 
```

然后在css中添加这个..

```
#myazi {
    background: url(path/image.png) no-repeat;
    width: 800px; /* width of actual image */
    height: 600px; /* height of actual image */
}

.inner-scroll {
    width: 600px; /* width of content area */
    height: 200px; /* height of content area */
    overflow-y: scroll;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T02:12:47.760

请删除以下 -

```
max-height :200px ; 
```

这是将背景图像设置为 200px 高度。

为了改进您的 para 的表示方式，您可以利用 css3 coloumn 属性以更好的方式对其进行格式化。滚动对我来说是一种不健康的方式来表示主页内容。

在这里您可以看到并学习实施 - [http://www.quirksmode.org/css/multicolumn.html](http://www.quirksmode.org/css/multicolumn.html)

# android - 创建 Android 本机扩展并获得：权限拒绝：在第二个活动上启动 Intent..

> ID：14845214
> 
> 赞同：1
> 
> 时间：2013-02-13T01:54:51.340
> 
> 标签：android, android-intent, android-activity, permissions, air-native-extension

我从 AIR Native Extension 成功调用了我的第一个 Activity，但是，当我尝试调用第二个时，我收到 Permission Denial 错误（请参阅 logcat 屏幕截图）。我已经尝试了我在这个网站上找到的所有建议，所以发布问题。

```
02-12 15:43:22.430: I/ActivityManager(271): START {act=android.intent.action.RUN cmp=com.cno.android.map/.AddMarkerActivity (has extras) u=0} from pid 14173
02-12 15:43:22.440: W/ActivityManager(271): Permission Denial: starting Intent { act=android.intent.action.RUN cmp=com.cno.android.map/.AddMarkerActivity (has extras) } from ProcessRecord{4147a718 14173:air.TestAndroidExtension.debug/u0a75} (pid=14173, uid=10075) not exported from uid 10072 
```

这是我的清单：

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
package="com.cno.android.map"
android:versionCode="1"
android:versionName="1.0" >

<uses-permission android:name="android.permission.INTERNET" />
<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" />
<uses-permission android:name="com.google.android.providers.gsf.permission.READ_GSERVICES" />
<uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION" />
<uses-permission android:name="android.permission.ACCESS_FINE_LOCATION" />

<!-- Maps API needs OpenGL ES 2.0\. -->
<uses-feature
    android:glEsVersion="0x00020000"
    android:required="true" />
<!-- End of copy. -->

<uses-sdk
    android:minSdkVersion="8"
    android:targetSdkVersion="17" />

<application
    android:allowBackup="true"
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name"
    android:theme="@android:style/Theme.Black.NoTitleBar" >
    <meta-data
        android:name="com.google.android.maps.v2.API_KEY"
        android:value="xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx" />

    <activity
        android:name="com.cno.android.map.InitMapActivity"
        android:label="@string/title_activity_init_map" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
    <activity
        android:name="com.cno.android.map.AddMarkerActivity"
        android:exported="true" >
        <intent-filter>
            <action android:name="android.intent.action.RUN"/>
        </intent-filter>
    </activity>
</application> 
```

**注意事项：我首先尝试了没有定义任何意图过滤器的 AddMarkerActivity。没有任何运气，我开始尝试 RUN 动作。除了在 onCreate 方法中显示“HELLO”的一条 logcat 消息外，我已经在 AddMarkerActivity 中注释掉了所有内容。如您所见，我的 Activity 在清单中没有重复，并且导出设置为 true。**

**最后，这是我调用 Activity 的方式：**

```
public class AddAnnotationFunction implements FREFunction {

public static final String TAG = "AddAnnotationFunction";
public final static String EXTRA_MARKER = "com.cno.nativemap.functions.marker";

@Override
public FREObject call(FREContext context, FREObject[] args) {

    Intent intent = new Intent();
    intent.setClassName("com.cno.android.map", "com.cno.android.map.AddMarkerActivity");
    Log.d(TAG, "Starting Map Activity- add marker");
    intent.setAction("android.intent.action.RUN");
    intent.putExtra(EXTRA_MARKER, new GeoMarker(args));

    context.getActivity().startActivity(intent);
    return null;
} 
```

}

# javascript - Javascript: on click change button text color

> ID：14845217
> 
> 赞同：1
> 
> 时间：2013-02-13T01:55:02.367
> 
> 标签：javascript, html, css

Hey I have the below javascript code with accompanying HTML. I am trying to get each button when clicked to change the text color to blue and then when the next button is clicked it changes text of the previously clicked button back to green. basically only the most recently clicked button has blue text. I have tried this code but with this it changes all button text to blue on the first button click. Any help is appreciated. Javascript, HTML, and CSS below.

```
function swapIphoneImage( tmpIPhoneImage ) {
    var el = document.getElementById('my-link');
    var el1 = document.getElementById('my-link1');
    var el2 = document.getElementById('my-link2');
    var el3 = document.getElementById('my-link3');
    var el4 = document.getElementById('my-link4');

    var iphoneImage = document.getElementById('iphoneImage');
    iphoneImage.src = tmpIPhoneImage;
    el.className = 'clicked-class';
    el1.className = 'clicked-class1';
    el2.className = 'clicked-class2';
    el3.className = 'clicked-class3';
    el4.className = 'clicked-class4';

} 
```

html

```
<ul class="features">
    <li><a id="my-link"  href="javascript:swapIphoneImage('wscalendarws.png');" title="">HaPPPs Calendar</a></li>
    <li><a id="my-link1"  href="javascript:swapIphoneImage('wsweekendws.png');" title="">Weekend Events</a></li>
    <li><a id="my-link2"  href="javascript:swapIphoneImage('wsfollowingws.png');" title="">Places & People</a></li>
    <li><a id="my-link3"  href="javascript:swapIphoneImage('wstemplateviewws.png');" title="">Customize Events</a></li>
    <li><a id="my-link4"  href="javascript:swapIphoneImage('wscheckinws.png');" title="">Interaction</a></li>
</ul> 
```

> css

```
a#my-link.clicked-class {
    color: #71a1ff !important;
}
a#my-link1.clicked-class1 {
    color: #71a1ff !important;
}
a#my-link2.clicked-class2 {
    color: #71a1ff !important;
}
a#my-link3.clicked-class3 {
    color: #71a1ff !important;
}
a#my-link4.clicked-class4 {
    color: #71a1ff !important;
} 
```

> Where am I failing?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T02:07:16.580

尝试使用 JavaScript 更改类，然后您只需要一个类来确定单击了哪一个。

这是一个例子：

JS：

```
 $("UL.features LI A").click(function(){
      $("UL.features LI A").removeClass('clicked');
      $(this).addClass('clicked');
   }); 
```

CSS：

```
A.clicked {
    color:#71a1ff !important;
} 
```

这是在jsfiddle：http: [//jsfiddle.net/57PBm/](http://jsfiddle.net/57PBm/)

**编辑：**此解决方案使用 JQuery，如果您还没有，我肯定会建议使用

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T02:11:12.553

将 JS 代码重写为：

```
function swapIphoneImage( elThis, tmpIPhoneImage ) {
    var el = document.getElementByClassName('clicked-class');

    var iphoneImage = document.getElementById('iphoneImage');
    iphoneImage.src = tmpIPhoneImage;

    el.className = '';
    elThis.className = 'clicked-class';
} 
```

和每个按钮：

```
<li><a id="my-link" href="javascript:swapIphoneImage(this, 'wscalendarws.png');" title="">HaPPPs Calendar</a></li> 
```

您不需要为同一事物设置 5 个 CSS 类。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-13T02:01:59.450

您正在将每个元素更改为单击的类。只需将一个数字传递给函数，该函数确定将哪个按钮着色为蓝色，然后通过 JS 将其中一个着色为蓝色，将其他所有着色为绿色。

# javascript - Javascript Testing Corners of an Array (Grid)

> ID：14845219
> 
> 赞同：1
> 
> 时间：2013-02-13T01:55:41.200
> 
> 标签：javascript, jquery, arrays, multidimensional-array

I'm doing this project trying to reproduce Schelling's Segregation model. I have a function(below) that is testing to see if the four immediate adjacent cells of the array are either the same or different or empty compared to the current cell being tested.

There are four possible spots to be tested for every cell in the array. But on corners and side spots, obviously you cant test spaces that are out of bounds. So in the function, if it finds one of the out of bounds spaces it decrements the number total around the cell. However, it keeps crashing telling me that I have an Uncaught Reference Error: Cannot read property '0' of undefined. I can't tell why its crashing.

The final lines of this code take the number of goods(similar cells) and the total number of cells around it (empty cells do not count) and gets a percentage similar.

Any help would be appreciated into telling me why it might be crashing and giving me an error? Thanks!

```
model.Test = function( i, j )
{
var numberToTest= 4;
var goods= 0;

if ((i - 1) >= 0) 
{
    if (model.BoardArray[i-1][j] != "E")
    {
        if (model.BoardArray[i][j] == model.BoardArray[i-1][j])
        {
            goods++;
        }
    }
    else
    {
        numberToTest--;
    }
}
else
{
    numberToTest--;
}

if((i + 1) < $("#BoardSizeValue").val()) 
{
    if (model.BoardArray[i+1][j] != "E")
    {   
        if (model.BoardArray[i][j] == model.BoardArray[i+1][j])
        {
            goods++;
        }
    }
    else
    {
        numberToTest--;
    }
}
else
{
    numberToTest--;
}

if ((j - 1) >= 0) 
{
    if (model.BoardArray[i][j-1] != "E")
    {
        if (model.BoardArray[i][j] == model.BoardArray[i][j-1])
        {
        goods++;
        }
    }
    else
    {
        numberToTest--;
    }
}
else
{
    numberToTest--;
}

if ((j + 1) < $("#BoardSizeValue").val()) 
{
    if (model.BoardArray[i][j+1] != "E")
    {   
        if (model.BoardArray[i][j] == model.BoardArray[i][j+1])
        {
            goods++;
        }
    }
    else
    {
        numberToTest--;
    }
}
else
{
    numberToTest--;
}

var similar = $("#SimilarSlider").val()/100;
if (numberToTest == 0)
{
    return false;
}
else
{
    var needed = goods/numberToTest;

    if (needed >= similar)
    {
        return false;
    }
    else
    {
        return true;
    }
}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T04:52:56.463

通过查看您的代码，您只会得到一个`Reference Error: Cannot read property '0' of undefined.`if`i`超出了数组的范围。

我认为问题可能出在这部分代码中：

```
if ((i - 1) >= 0) {
    if (model.BoardArray[i-1][j] != "E") {
        if (model.BoardArray[i][j] == model.BoardArray[i-1][j]) { 
```

如果`i = $("#BoardSizeValue").val()`和`$("#BoardSizeValue").val()`是数组大小的从一开始的索引，那么`[i-1]`可以，但不是`[i]`. 因此，请尝试将您的代码调整为：

```
if ((i - 1) >= 0 && i < $("#BoardSizeValue").val()) {
    if (model.BoardArray[i-1][j] != "E") {
        if (model.BoardArray[i][j] == model.BoardArray[i-1][j]) { 
```

这也适用于`j`比较。

# php - Search A Single String In MySQL

> ID：14845222
> 
> 赞同：1
> 
> 时间：2013-02-13T01:56:04.330
> 
> 标签：php, jquery, mysql, json, search

I am making a private message system and i created a php search page, I am using JQuery to pass a variable from a text field on keyUp to a PHP file called USearch.php or Username Search. Here is my code:

```
<?php
$Connect = new mysqli("localhost", "root", "", "Data");
$Val = $_POST['Val'];

if($Val)
{
$Search = 'SELECT * FROM Users WHERE ';
$Term = explode(" ", $Val);

foreach($Term as $Key)
{
    $I = 0;
    $I++;
    if($I == 1)
    {
        $Search .= 'Username LIKE "'.$Key.'" LIMIT 0, 10 ';
    }
    else
    {
        $Search .= 'OR Username LIKE "'.$Key.'" LIMIT 0, 10 ';
    }
}

if($Result = $Connect->query($Search))
{
    while($Row = $Result->fetch_assoc())
    {
        $User = $Row['Username'];

        $USearch['S'] = $User;
    }
}
}
echo json_encode($USearch);
?> 
```

As you can see, my code has no errors, my problem is that i am searching Users in a DB which means i am searching 1 word or string, by using this PHP code, i would have to type in the exact username for the function to return a value. My real intention was to search the string and return all similar usernames according to my input string.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T02:22:27.390

就像乔恩说的那样——你想`%`在你想让你的 SQL 有通配符的地方使用。

如果您想要名称类似于 matt 的所有值，您会这样做

```
WHERE name LIKE '%matt%' 
```

# java - Why would someone structure a while loop like this?

> ID：14845223
> 
> 赞同：3
> 
> 时间：2013-02-13T01:56:10.600
> 
> 标签：java

I'm reading a book on Java, and we're on reading from a channel into a ByteBuffer. I found the way the author was structuring the while loop odd:

```
    try (FileChannel inCh = (FileChannel) Files.newByteChannel(file)) {
            ByteBuffer lengthBuf = ByteBuffer.allocate(8);
            int strLength = 0;

            ByteBuffer[] buffers = { null, ByteBuffer.allocate(8) };

            while(true) {
                if(inCh.read(lengthBuf) == -1)
                    break;
                lengthBuf.flip();

                strLength = (int)lengthBuf.getDouble();

                buffers[0] = ByteBuffer.allocate(2*strLength);

                if(inCh.read(buffers) == -1) {
                    System.err.println("EOF found reading ht eprime string.");
                    break;
                }

                System.out.printf("String length: %3s String: %-12s Binary Value: %3d%n", strLength,
                                    ((ByteBuffer) (buffers[0].flip())).asCharBuffer().toString(),
                                    ((ByteBuffer)buffers[1].flip()).getLong());

                lengthBuf.clear();
                buffers[1].clear();
            }
            System.out.println("\nEOF reached.");
        } catch (IOException e) {

```

I tried it like this:

```
while(inCh.read(lengthBuf) != -1) { 
```

and it works the same. Would there be a practical or code clarity reason the author would write it like he did?

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-13T02:00:50.027

很明显，您的循环版本在语义上是相同的。然而，这不是唯一需要考虑的事情。

请注意，在`while`循环的更下方，有第二个条件跳出循环。我怀疑这是促使作者使用`while (true)`.

通过编写它来`while (true)`提醒读者注意在`while`. 读者将不得不在循环内部寻找中断，并希望能找到它们。

以您的方式编写，不经意的读者可能会扫描代码的顶部并假设`while`条件是循环终止的唯一方法。

要考虑的另一点是对称性或平衡性。正如原作者所写，循环终止都是相同的形式。即从循环内中断。你的版本感觉不对称。测试中的一个`while`终止点，以及循环内部的另一个不同性质的终止点。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-13T02:02:34.600

作者有两个退出点，其中一个在退出循环之前打印出错误。在这种情况下，只是使代码更加冗长。当然，它可以用多种不同的方式编写。

# javascript - Z index a draggable div with JavaScript Only

> ID：14845229
> 
> 赞同：1
> 
> 时间：2013-02-13T01:56:59.057
> 
> 标签：javascript

So I have created an draggable div, that I want to be on top the other divs when dragging around it on the content.

I have tried style.zindex=1 but it don't seem to solve the problem, If I do it with Jquery there is no problem, but I want to solve it by JavaScript.

Any tips ?

This is what i have come up with.

```
 function changeClass() {
            var diceClass = document.getElementsByClassName("window");
            for(var i = 0; i<diceClass.length; i++){
                var z = 10;
                diceClass[i].style.zIndex=z++;
            console.log(diceClass)
            } 
        } 
        changeClass() 
```

And my Css

```
.window
{

    width               : 342px;
    height              : 182px;
    top                 : 0px;
    left                : 0px;
    position            : absolute;
    background          : url(window.png) no-repeat;

    -webkit-user-select: none;
   -moz-user-select: none;
   -ms-user-select: none;
   -khtml-user-select: none;
   user-select: none;
   cursor: default;

    } 
```

I created an jsFiddle. The code is on row 31 - 42

[http://jsfiddle.net/dymond/tQdFZ/1/](http://jsfiddle.net/dymond/tQdFZ/1/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T02:53:45.040

[这是一个固定的jsfiddle。](http://jsfiddle.net/tQdFZ/5/)

您正在使用“点击”事件调整 z 索引。Click 事件在接收到 mousedown 和 mouseup 事件之前不会触发。这意味着在您停止拖动之前实际上并未应用 z 索引。

由于您已经使用 startDrag 处理了 mousedown 事件，因此您可以使用闭包变量来跟踪当前最高的 z 索引，并随时增加它。

```
var draggable = document.getElementsByClassName('draggable'),
    draggableCount = draggable.length,
    i, currZ = 1;

function startDrag(evt) {

    var diffX = evt.clientX - this.offsetLeft,
        diffY = evt.clientY - this.offsetTop,
        that = this;

    this.style.zIndex = currZ++;

    ...
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T02:08:27.063

我认为您的意思是`z`在 for 循环之外声明。

```
var z = 10;

for(var i = 0; i< diceClass.length; i++) { ... } 
```

否则即使有运营商`z`也将永远是十。`++`

# .net - How to write a test for a solution of producer-consumer problem_?

> ID：14845235
> 
> 赞同：1
> 
> 时间：2013-02-13T01:57:55.967
> 
> 标签：.net, multithreading, algorithm, unit-testing, producer-consumer

As an excercise I want to implement a solution to the producer-consumer problem. Let's say I'll have an array int[] buffer and two methods Produce() and Consume() that will simulate the producer and customer, respectively, and one "Execute" method to call both method asynchronously.

It's probably to test whether the implementation will not result in a deadlock, just make Produce and Consume repeat for a large number of time (like 1 million), make Execute wait for these two methods to finish, and then (in my unit test) just make sure the call returns after certain time (maybe 1 minute). But how to test whether there is no race condition or data corruption in the implementation?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T08:02:48.093

死锁不是您应该检查的唯一内容。死锁总是很快被检测到 - 你的应用程序停止。丢失或重复的消息更加危险和阴险——一条被复制的消息可能导致应用程序崩溃的时间比发生重复的时间要晚得多，而且很可能是在与发生重复的地方不同的模块/线程/块中。这样的错误绝对是一场噩梦。

在测试队列类时，我创建了一个带有内部随机数组 [256] 成员和校验和的“消息”类。我最初创建了 10000 条这些消息，“totalChecksum”它们各自的校验和，并将指向它们的指针推送到“池”队列中。多个生产者（我通常使用 32 个）从池队列中弹出 *Message 实例并将它们推送到另一个“通信”队列。多个消费者，（我通常使用 16 个）从通信队列中弹出 *Message 实例并将它们推回池队列。

在房间预热 5 分钟后，一个简单的 GUI 表单计时器通过设置一个告诉生产者等待 manualResetEvent 的 volatile 布尔值来停止生产者。Sleep(500) 之后，所有 10000 条消息都应该返回池队列中，并且 GUI 检查池队列计数是否为 10000，循环弹出 10000 条消息，totalChecksumming 它们，推回并最终与初始 totalChecksum 进行比较。如果通过，布尔值被重置，MRE 发出信号让生产者再次运行。

我一夜之间反复运行这个测试。如果有任何故障，则队列不适合目的。

# php - fwrite or error_log not working with background task with CLI &

> ID：14845236
> 
> 赞同：0
> 
> 时间：2013-02-13T01:58:00.607
> 
> 标签：php, error-handling, background-process, fwrite

I have a basic php script that will write/log to a text document

```
<?php
$filename = 'php_log.log';
$somecontent = 'writing with fwrite!'.PHP_EOL;
if (is_writable($filename)) {
    if (!$handle = fopen($filename, 'a')) {
         echo "Cannot open file ($filename)";
         exit;
    }

    if (fwrite($handle, $somecontent) === FALSE) {
        echo "Cannot write to file ($filename)";
        exit;
    }
    echo "Success, wrote ($somecontent) to file ($filename)";
    fclose($handle);
} else {
    echo "The file $filename is not writable";
}
error_log('logging with error_log!'.PHP_EOL,3,'php_log.log');
?> 
```

From CLI, if i do `php test.php` and check php_log.log, I see both writes. But when I try `php test.php &`, there is nothing written to php_log.log

Is there some php setting I am unaware of? Thanks!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T02:26:55.007

可能没有锁定。
为什么要手动写入文件，然后使用`error_log`？

*   考虑`file_put_contents()`改为`FILE_APPEND|FILE_LOCK`。这仅附加到文件的末尾并负责锁定。

*   启用`error_reporting`并重定向`stderr`到单独的文件以了解更多信息。

    `php test.php 2> php_errors.txt &`

# java - How to convert timestamp into days ago

> ID：14845238
> 
> 赞同：1
> 
> 时间：2013-02-13T01:58:22.403
> 
> 标签：java, mysql, timestamp

I have my MySQL database inserting timestamp when I upload a record, so what's entered is something like 2013-02-02 16:59:29\. Is there a Java way to convert that into something like 10 Days Ago?

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-13T02:15:26.983

假设您已将数据库中的日期时间值读入 java：

```
Date date; // read from database
int days = TimeUnit.MILLISECONDS.toDays(
     System.currentTimeMillis() - date.getTime()); 
```

然后你可以随意格式化它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-13T03:45:31.740

借助结果集从 mysql 获取时间并将时间数据传递给以下方法

```
 public static void main(String[] args) {                

     long timStampFromMysql = rs.getTimestamp("time");// Fetch time from mysql
                Calendar cal =  Calendar.getInstance();
                cal.setTimeInMillis(convertTime(timStampFromMysql , 15));
                System.out.println(cal);

            }

            public static long convertTime(long timeInMillies, int days)
            {

                 Calendar calendar = Calendar.getInstance();
                    calendar.setTimeInMillis(timeInMillies);
                    calendar.add(Calendar.DAY_OF_YEAR, days);

                    return calendar.getTimeInMillis();

            } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-30T07:33:00.260

[Joda Time](http://www.joda.org/joda-time/)`Days.daysBetween`库中的将为您计算。

```
DateTime start = new DateTime(time_ms);
DateTime end   = new DateTime(now);
Days days = Days.daysBetween(start, end);
int d = days.getDays(); 
```

# rest - Jersey REST - multiple file upload and JAXB object

> ID：14845239
> 
> 赞同：4
> 
> 时间：2013-02-13T01:58:24.967
> 
> 标签：rest, jersey

I am using Jersey for REST.
For `POST`, can we upload 2 files and send JAXB annotated object as well?

```
@POST
@Path("create")
@Consumes({MediaType.MULTIPART_FORM_DATA, MediaType.APPLICATION_XML, MediaType.APPLICATION_JSON})
@Override
public Response addData(FormDataMultiPart multiform, System type) 
```

Any suggestions please?

# javascript - 避免弹出窗口标题上的 url

> ID：14845241
> 
> 赞同：1
> 
> 时间：2013-02-13T01:58:58.113
> 
> 标签：javascript

我有一个弹出窗口，我正在使用下面的脚本打开它。我想避免出现在弹出窗口标题上的弹出窗口的 url。

```
window.open(url, '_blank', 'WIDTH=300,HEIGHT=250'); 
```

有什么办法可以避免这种情况？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T02:02:39.443

`<title>`使用元素给文档一个标题。这是好的和有意义的，也是最好的方式。

但是，如果文档没有标题并且位于同一域中，则可以访问其`document`：

```
var newWindow = window.open(url, '_blank', 'WIDTH=300,HEIGHT=250');
newWindow.document.title = 'Hello, world!'; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T02:04:30.477

There's more here: [http://www.w3schools.com/jsref/met_win_open.asp](http://www.w3schools.com/jsref/met_win_open.asp)

If you're looking to hide the location bar, add "location=0" to your 3rd argument. If you want to affect the window title, make sure to include a in the page that's loading in the popup.

# javascript - KnockoutJS if 语句的有效性

> ID：14845242
> 
> 赞同：0
> 
> 时间：2013-02-13T01:59:10.340
> 
> 标签：javascript, knockout.js

我有以下 javascript：

```
function RandomViewModel() {
    var self = this;
    self.RnadomSquaresK = ko.observableArray([
        randomSquare(),
        randomSquare(),
    ]);
}

var randomSquare = function() { return ko.observable({
    innate: ko.observableArray([
        { star: "test1", Class: "starList", Style: {} },
        { star: "test2", Class: "starList", Style: {display:'inline'} },
        { star: "test3", Class: "starList", Style: {} },
        { star: "test4", Class: "starList", Style: {} }
    ])
})};

ko.applyBindings(new RandomViewModel()); 
```

它基本上是创建一个由两个 observableArrays 组成的 observableArray，每个 observableArrays 有 4 个元素。

我有以下html：

```
<script id="starTemplate" type="text/html">
    <!-- ko if: ($index >= 0) -->
    <div data-bind="text: $index, attr: { class: Class }, style: Style"></div>
    <!-- /ko -->
</script>

<div class="starList" data-bind="template: { name: 'starTemplate', foreach: RnadomSquaresK()[0]().innate }"></div> 
```

我期望根据它们绑定的 observableArray 打印每个索引来创建 div。（在这种情况下：4 个 div，因为所有索引都应该等于或大于 0）

我实际得到的是：空白。

这是 JSFiddle 链接：http: [//jsfiddle.net/qrwBE/](http://jsfiddle.net/qrwBE/)

如果我将 if 语句更改为 ex: `if: $index != 0`，我将打印绑定到数组的所有 4 个元素，但我不太明白为什么在这种情况下第一个元素（索引 0）与其他 3 个元素一起打印。

我是否`if`错误地使用了该语句？

非常欢迎对正在发生的事情进行解释，以及有关 javascript 等的任何其他评论。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T05:49:59.707

所以这里有很多项目需要检查：

**为什么你的 foreach 循环不显示带有索引值的 div？**

答案是因为你`$index()`是一个 observable，它们是函数。所以你必须像我上面演示的那样使用它。起作用的原因`if: $index != 0`是因为在 javascript 中，评估为 0 的事物为 false，任何非零评估为 true（如果您熟悉这些语言，就像在 c/c++ 中一样。

所以这意味着当你写`if: $index != 0`你真正说的地方时，这个函数`$index not null or undefined?`是真的，所以它会继续从你的模板输出 div。

***重构推荐：***

如果您的 observableArray 为空，foreach 绑定将自动处理不呈现 div 标签。这意味着您可以完全删除 if 检查......这也可以解决您的问题。

```
<script id="starTemplate"a type="text/html">
    <div data-bind="text: $index, attr: { class: Class }, style: Style"></div>
</script> 
```

**模型变化：**

让我们检查一下这个函数：

```
var randomSquare = function() { return ko.observable({
    innate: ko.observableArray([
        { star: "test1", Class: "starList", Style: {} },
        { star: "test2", Class: "starList", Style: {display:'inline'} },
        { star: "test3", Class: "starList", Style: {} },
        { star: "test4", Class: "starList", Style: {} }
    ])
})}; 
```

在这里，您将返回一个 observable，其中包含一个名为 innate 的属性，它是一个 observable 数组。为什么不直接删除它包含在可观察对象中，因为它只会使访问数组的语法更加时髦`RnadomSquaresK()[0]().innate`

取而代之的是，以下内容如何：

```
var randomSquare = function() { return {
       innate: ko.observableArray([
        { star: "test1", Class: "starList", Style: {} },
        { star: "test2", Class: "starList", Style: {display:'inline'} },
        { star: "test3", Class: "starList", Style: {} },
        { star: "test4", Class: "starList", Style: {} }
    ]});
})}; 
```

这将简单地访问它到以下内容：`RnadomSquaresK()[0].innate`

**何时使某些东西可观察**

请记住，您只需要使某些东西成为可观察的……如果您打算在可观察的状态发生变化时提醒 UI 或 js 中的订阅者功能。否则，只需将其设为复制值（普通的旧 js 变量）。

**将函数声明与函数表达式混合的危险（提升问题）：** 这纯粹是一个 js 注释。

这是一个函数声明`function RandomViewModel() { }`

这是一个函数表达式`var randomSquare = function() { };`

这些在口译员的处理方式上略有不同。第一个（声明）将被提升到其父范围的顶部。因此，在随后的代码调用`RandomViewModel()`中将完美地工作，因为它是在其他一切之前定义的，这要归功于解释器。

但是，第二个（表达式）只会将变量名提升到顶部，但它的赋值将保持在原来的位置，这意味着您的代码将等同于：

```
function RandomViewModel() { }
var randomSquare;

randomSquare = function() { }; 
```

这在您的情况下可以正常工作。但是，随着您的模型变得越来越复杂并且彼此之间的耦合越来越紧密，您最终可能会遇到以下问题：

```
function RandomViewModel() { 
    var x = randomSquare(); //<-- would throw an undefined exception here
    alert(x);
}
var model = new RandomViewModel();

var randomSquare = function() { return 5; }; 
```

发生这种情况是因为解释器将您提升`var randomSquare`到范围的顶部，但直到尝试使用它之后才为其分配功能`RandomViewModel`

安全的赌注，保持一致，不要将这些与编写函数的方法混合和匹配。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T02:19:08.973

在绑定中做javascript表达式时，需要获取属性的值：

[http://jsfiddle.net/wiredprairie/EWrsF/](http://jsfiddle.net/wiredprairie/EWrsF/)

```
if: $index() > 0 
```

正在使用：

```
<script id="starTemplate" type="text/html">
    <!-- ko if: $index() >  0 -->
    <div data-bind="text: star, attr: { class: Class }, style: Style"></div>
    <!-- /ko -->
</script> 
```

诚然，我不理解您的其余代码（因为您使用的变量名称和模式很难理解）。

# java - 为什么我应该使用封装与抽象？

> ID：14845244
> 
> 赞同：2
> 
> 时间：2013-02-13T01:59:17.057
> 
> 标签：java, python, oop

我一直遵循使用访问修饰符和封装的流行约定，以确保一个类在实现错误时不会中断。但是，我注意到 OOP 确实不需要封装，使用访问修饰符实际上带来的麻烦多于好处。此外，通过不使用访问修饰符，您更像是一个 OO 程序员。我的推理如下。

1.  Python 支持 OOP，但它不使用访问修饰符或封装。表明在 OOP 语言中访问修饰符不是强制性的。

2.  尽管编译器更先进，但使用访问器方法与变量访问之间仍然存在纳秒级差异。在这样的受限系统中，`Android`会极大地影响游戏的 FPS。（尽管在大多数情况下对方法使用 final 修饰符会显着减少纳秒差异）

3.  通过不使用私有或包修饰符，原始编码器的编码变得更简单、更快。该类的未来用户仍然可以使用公共接口，而不会破坏或使用类实现。此外，如果他希望修改或升级类，他仍然可以这样做并访问私有修饰符。打个比方，当您决定改装汽车时，您知道可能会破坏某些东西，但如果您愿意承担风险并知道自己在做什么，那么您就可以打开一个清晰的锁标志上写着（打开风险自负）比必须更换牢不可破的锁，锁定您要修改的部分要好。

我现在做的是混合用于公共接口的公共修饰符和用于实现细节的受保护修饰符，以便用户可以通过子类化来冒险。有什么理由我应该重新考虑这样做而不是传统的封装？

# slider - 可以改变 Slider JavaFx 的节奏吗？

> ID：14845253
> 
> 赞同：1
> 
> 时间：2013-02-13T02:00:42.633
> 
> 标签：slider, javafx-2

也许，我只是瞎了，但我有一个滑块，我需要知道是否有任何方法可以改变节奏。

示例：滑块从 7.5 到 13.0 Pace 0.5

当我在标签中设置值时，我想要这样的东西：7.5；8.0；8.5

对于滑块的每一个动作，我现在都会得到这样的结果：7.5；7.51

什么都试过了。任何想法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-13T02:31:56.280

设置滑块的刻度单位并将其值捕捉到刻度。

对于您在问题中提供的示例值：

```
import javafx.scene.control.Slider;
...
Slider slider = new Slider(7.5, 13, 7.5);
slider.setMajorTickUnit(0.5);
slider.setMinorTickCount(0);
slider.setSnapToTicks(true); 
```

从[Slider setSnapToTicks](http://docs.oracle.com/javafx/2/api/javafx/scene/control/Slider.html#setSnapToTicks%28boolean%29) javadoc：

> 指示 Slider 的值是否应始终与刻度线对齐。即使未显示刻度线，这也是值得尊重的。

# c# - 套接字只读在第一次工作

> ID：14845254
> 
> 赞同：-1
> 
> 时间：2013-02-13T02:00:44.037
> 
> 标签：c#, sockets

大家，我正在尝试编写一个循环来从后台线程中连接的套接字中读取。但它只接收第一条消息。我已经搜索了一段时间以找到原因。但还是想不通。我知道有些人遇到了同样的问题。然而，他们的原因似乎不同。我希望有人能帮助我。

```
private void setPort_Click(object sender, EventArgs e)
{
    SetupTcpListener = new Task(() =>
    {
        try
        {
            Int32 Port;
            Int32.TryParse(portNum.Text, out Port);
            IPAddress localAddr = IPAddress.Parse("127.0.0.1");
            server = new TcpListener(localAddr, Port);

            server.Start(10);
            Tclient = server.AcceptTcpClient();
            Console.WriteLine("Connected");
        }
        catch (SocketException exc)
        {
            Console.WriteLine("SocketException: {0}", exc);
        }
        NetworkStream tstream = Tclient.GetStream();

        int t = 0;
        while (true)//the first loop: WriteLine a signal when read sth
        //read first message:"Get 0"
        //read second message:"Get 1"
        //and so on
        {
            t++;

            int i = 0;

            while (i <= 0)//the second loop is trying to read until get sth.
            //when it get sth, the first while loop continue,and print a "Get t"
            //t means how many times it has read a messsage.
            {
                i = tstream.Read(ReadBuffer,0,40);
            }
            Console.WriteLine("Get "+ t.ToString());
        }
    });
    SetupTcpListener.Start();
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T02:19:26.153

从这一行可以看出您只读取一个字节的原因：

```
int i = 0;

while (i <= 0)
{
    i = tstream.Read(ReadBuffer,0,40);
} 
```

NetworkStream.Read 返回从套接字读取的字节数。因此，只要您收到超过 1 个字节，您就会退出循环。

话虽如此，我可以看到您的代码存在多个问题，例如您如何编写循环以从套接字读取字节（为什么要在此处嵌套循环？），如何打印接收到的字节的结果（您正在连续打印 t，这意味着您将得到“0”），尤其是在操作完成后您**如何不关闭套接字。**

此外，如果您使用的是 Winforms（因为这是点击事件的一部分），则使用 backgroundworker 可能更适合您的情况。

我建议您阅读几个有关如何正确完成套接字编程的示例，例如来自[此站点](http://www.java2s.com/Tutorial/CSharp/0580__Network/0320__NetworkStream.htm)的示例。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-13T02:19:38.710

这很奇怪：

```
 while (true)
        {
            t++;

            int i = 0;

            while (i <= 0)
            {
                i = tstream.Read(ReadBuffer,0,40); //now i>0 so quit the loop
            }
            Console.WriteLine("Get "+ t.ToString());
            //but go around again anyway???
        } 
```

你的意思：

```
 while (true)
        {
            var amtRead = tstream.Read(ReadBuffer,0,40);

            //or even safer
            //var amtRead = tstream.Read(ReadBuffer, 0, ReadBuffer.Length);

            if(amtRead == 0)
            {
                //other end is out of data. transfer is finished
                break;
            }
        } 
```

?

或者也许是你只接受一次连接。

或者可能是因为您永久覆盖数组的位置 0-39`ReadBuffer`而不对数据做任何事情。

这完全取决于您所说的“消息”是什么意思。

# c++ - 线程之间通过共享向量进行通信

> ID：14845259
> 
> 赞同：0
> 
> 时间：2013-02-13T02:01:21.197
> 
> 标签：c++, multithreading, boost, vector

我正在设计一个 tcp 服务器，它从请求中获取信息并将所有内容放入队列中以进行处理。我正在使用 asio Web 服务器来处理所有 Web 交互。我正在寻找一种有效的方法来将所有内容都排成流程。我现在正在使用增强信号和全局向量来执行此操作，类似于此。

```
void request_handler::handle_request(request &req, reply &rep)
{
   std::string parsedInfo = parse_request(req); 
   shared_queue.push_back(parsedInfo);
   new_entry();
} 
```

new_entry 是一个升压信号

```
 boost::signal<void ()> new_entry; 
```

现在我有一个信号处理程序类来捕获信号。

```
void sig_handler::process_next()
{
    boost::try_mutex::scoped_try_lock lock(guard);
    if(!lock)
       return;
    while(!shared_queue.empty())
    {
        ... //Do Stuff
        std::string cur_entry = shared_queue.at(0);
        shared_queue.erase(shared_queue.begin());
        ... //Do more stuff
    } 
} 
```

我的目标是在有信息时清除向量队列，并且每次在向量上推送一些东西。我想尽可能避免轮询。我相信这部分也按照我的预期工作。但是，我偶尔会遇到崩溃，我相信基于我的回溯，将信息推送到共享队列上。仅当我尝试每秒执行 1000 次事务时才会发生这种情况，这使得在多线程环境中调试变得困难。我的回溯在这里：

```
Error: signal 11:
./UpdateServer/build/UpdateServer(_Z7handleri+0x18)[0x469f68]
/lib/x86_64-linux-gnu/libc.so.6(+0x364a0)[0x7fbbdd67a4a0]
/usr/lib/x86_64-linux-gnu/libstdc++.so.6(_ZNSsC1ERKSs+0xb)[0x7fbbddfb4f2b]
./UpdateServer/build/UpdateServer[0x4749d0]
./UpdateServer/build/UpdateServer(_ZNSt6vectorISsSaISsEE13_M_insert_auxEN9__gnu_cxx17__normal_iteratorIPSsS1_EERKSs+0x111)[0x476521]
./UpdateServer/build/UpdateServer(_ZN15request_handler14handle_requestERK7requestR5reply+0x3d3)[0x475873]
./UpdateServer/build/UpdateServer(_ZN10connection11handle_readERKN5boost6system10error_codeEm+0x234)[0x46c774]
./UpdateServer/build/UpdateServer(_ZN5boost4asio6detail14strand_service8dispatchINS1_7binder2INS_3_bi6bind_tIvNS_4_mfi3mf2Iv10connectionRKNS_6system10error_codeEmEENS5_5list3INS5_5valueINS_10shared_ptrIS9_EEEEPFNS_3argILi1EEEvEPFNSK_ILi2EEEvEEEEESB_mEEEEvRPNS2_11strand_implET_+0xcd)[0x47216d]
./UpdateServer/build/UpdateServer(_ZN5boost4asio6detail15wrapped_handlerINS0_10io_service6strandENS_3_bi6bind_tIvNS_4_mfi3mf2Iv10connectionRKNS_6system10error_codeEmEENS5_5list3INS5_5valueINS_10shared_ptrIS9_EEEEPFNS_3argILi1EEEvEPFNSK_ILi2EEEvEEEEEEclISB_mEEvRKT_RKT0_+0xd9)[0x472439]
./UpdateServer/build/UpdateServer(_ZN5boost4asio6detail18completion_handlerINS1_17rewrapped_handlerINS1_7binder2INS1_15wrapped_handlerINS0_10io_service6strandENS_3_bi6bind_tIvNS_4_mfi3mf2Iv10connectionRKNS_6system10error_codeEmEENS8_5list3INS8_5valueINS_10shared_ptrISC_EEEEPFNS_3argILi1EEEvEPFNSN_ILi2EEEvEEEEEEESE_mEESV_EEE11do_completeEPNS1_15task_io_serviceEPNS1_25task_io_service_operationESG_m+0x1e5)[0x4726f5]
./UpdateServer/build/UpdateServer(_ZN5boost4asio6detail14strand_service8dispatchINS1_17rewrapped_handlerINS1_7binder2INS1_15wrapped_handlerINS0_10io_service6strandENS_3_bi6bind_tIvNS_4_mfi3mf2Iv10connectionRKNS_6system10error_codeEmEENS9_5list3INS9_5valueINS_10shared_ptrISD_EEEEPFNS_3argILi1EEEvEPFNSO_ILi2EEEvEEEEEEESF_mEESW_EEEEvRPNS2_11strand_implET_+0x2ad)[0x472aed]
./UpdateServer/build/UpdateServer(_ZN5boost4asio6detail19asio_handler_invokeINS1_7binder2INS1_15wrapped_handlerINS0_10io_service6strandENS_3_bi6bind_tIvNS_4_mfi3mf2Iv10connectionRKNS_6system10error_codeEmEENS7_5list3INS7_5valueINS_10shared_ptrISB_EEEEPFNS_3argILi1EEEvEPFNSM_ILi2EEEvEEEEEEESD_mEES6_SU_EEvRT_PNS4_IT0_T1_EE+0x15f)[0x472d3f]
./UpdateServer/build/UpdateServer(_ZN5boost4asio6detail23reactive_socket_recv_opINS0_17mutable_buffers_1ENS1_15wrapped_handlerINS0_10io_service6strandENS_3_bi6bind_tIvNS_4_mfi3mf2Iv10connectionRKNS_6system10error_codeEmEENS7_5list3INS7_5valueINS_10shared_ptrISB_EEEEPFNS_3argILi1EEEvEPFNSM_ILi2EEEvEEEEEEEE11do_completeEPNS1_15task_io_serviceEPNS1_25task_io_service_operationESF_m+0xce)[0x472ede]
./UpdateServer/build/UpdateServer(_ZN5boost4asio6detail15task_io_service3runERNS_6system10error_codeE+0x79a)[0x47ceea]
./UpdateServer/build/UpdateServer(_ZN5boost4asio10io_service3runEv+0x25)[0x47d1d5]
/usr/lib/libboost_thread.so.1.48.0(+0xdda9)[0x7fbbdecd4da9]
/lib/x86_64-linux-gnu/libpthread.so.0(+0x7e9a)[0x7fbbdd42ee9a]
/lib/x86_64-linux-gnu/libc.so.6(clone+0x6d)[0x7fbbdd737cbd] 
```

线`./UpdateServer/build/UpdateServer(_ZNSt6vectorISsSaISsEE13_M_insert_auxEN9__gnu_cxx17__normal_iteratorIPSsS1_EERKSs+0x111)[0x476521]`

似乎与 std::vector 插入迭代器相混淆，这就是为什么我相信我的程序在共享向量插入上崩溃（我不相信我的程序中有任何其他字符串向量），但是我相当肯定我正在使用我的向量以安全的方式插入和读取。

所以我想我的问题是当我将信息推送到共享向量上时，是否存在我必须担心会导致崩溃的竞争条件问题？我采取的方法是可行的方法，还是我应该以某种方式重新考虑我的设计？如果您需要更多信息，请告诉我，我很乐意提供任何我能提供的信息。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T02:27:30.217

`std`数据结构不是线程安全的（[在大多数情况下](https://stackoverflow.com/a/7456012/507606)），因此如果同时被多个线程访问，则需要额外的同步。在您的情况下，一个线程可能正在调用`push_back`，而另一个线程正在调用`erase`. 这将产生*未定义的行为*。为了解决这个问题，两者都`push_back`需要`erase`被同一个锁保护。我建议您在 c++ 标准库中搜索线程安全并阅读更多相关信息。

* * *

此外，在`vector`此处使用 a 可能不是最佳选择。您应该改为查看[std::queue](http://www.cplusplus.com/reference/queue/queue/)。当您`erase`的第一个元素`vector`必须稍后将向量中的所有字符串复制下来时，这可能非常昂贵。 `queue`不会遇到这个问题。

# javascript - 如果不是 IE 显示警报 - HTML/JS

> ID：14845268
> 
> 赞同：1
> 
> 时间：2013-02-13T02:02:14.197
> 
> 标签：javascript, html

如果用户没有使用任何版本的 Internet Explorer 来提醒他们并建议他们使用它，我该如何做到这一点？

我试过了：

```
 <html>
   <head>
   <script language="Javascript">
   <![if !IE]>
   alert ("Please use IE")
   <![endif]>
    </script>
    </head> 
```

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T02:06:05.350

如果你使用 jQuery，你可以这样做：

```
if (!$.browser.msie) {
    alert( "Please Use IE" );
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-13T02:07:25.350

您可以使用：

```
if (navigator.appName != "Microsoft Internet Explorer")
{
    alert("Please use IE");
} 
```

或者：

```
if (navigator.userAgent.indexOf("MSIE") == -1)
{
    alert("Please use IE");
} 
```

仅供参考，您也可以使用下面的示例，但**条件注释** [**已从 Internet Explorer 10**](http://msdn.microsoft.com/en-us/library/ie/hh801214%28v=vs.85%29.aspx)中删除。

否则你可以使用：

```
<!--[if !IE]><!-->
<script type="text/javascript">
   alert("Please use IE");
</script>
<!--<![endif]--> 
```

或这个：

```
<!--[if IE]><script type="text/javascript">window['isIE'] = true;</script><![endif]-->
<script type="text/javascript">
   if (!window.isIE) alert("Please use IE");
</script> 
```

但是还是；在 IE10 中获得此功能；有一种解决方法，即通过此元标记选择 IE 9 行为：

```
<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE9"> 
```

# javascript - contenteditable 与表单提交

> ID：14845269
> 
> 赞同：1
> 
> 时间：2013-02-13T02:02:23.133
> 
> 标签：javascript, python, html, flask

我有`form`一个表，其中一个`td`元素是`contenteditable`. 当我单击提交按钮时，我需要在表单上提交已编辑的元素。我基本上使用 HTML + Python Flask 框架。这是我的 Javascript 代码。

```
function submitchanges(){
      alert(id)
      document.getElementsByClassName('editableText').value = document.getElementsByClassName('editableText').innerHTML
      var list = document.getElementsByClassName('editableText').value
      document.myform.action="/Reschedule/"+id
      document.myform.submit();
      } 
```

所以我有我改变的元素。如何使用表单提交将此元素传递给脚本？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T08:03:56.393

您不能`contenteditable`在表单帖子中提交字段，除非它们是表单输入。您必须使用 Ajax/XMLHttpRequests 来执行此操作。

有点相关的链接： [使用 HTML5，如何在表单提交中使用 contenteditable 字段？](https://stackoverflow.com/questions/6247702/using-html5-how-do-i-use-contenteditable-fields-in-a-form-submission)

# physics - 圆形轨道的初始速度矢量

> ID：14845273
> 
> 赞同：0
> 
> 时间：2013-02-13T02:02:45.957
> 
> 标签：physics

我正在尝试创建一个太阳系模拟，但在试图找出我放置在模拟中的随机物体的初始速度向量时遇到了问题。

假设： - 我使用的是高斯重力常数，所以我的所有单位都是 AU/太阳质量/天 - 使用 x、y、z 作为坐标 - 一颗星，固定在 0,0,0。为它确定准随机质量 - 我将一颗行星放置在随机 x、y、z 坐标上，并确定其自身的准随机质量。

在我开始 nbody 循环（使用 RK4）之前，我希望行星的初始速度使其具有围绕恒星的圆形轨道。一旦模拟开始，其他放置的行星当然会拉上它，但我想让它有机会拥有一个稳定的轨道......

所以，最后，我需要有一个行星的初始速度矢量 (x,y,z)，这意味着它在 1 个时间步长后将围绕恒星形成一个圆形轨道。

帮助？几个星期以来我一直在反对这个问题，但我认为我还没有任何合理的解决方案......

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-13T10:18:49.420

如果你假设恒星的`M`质量比所有行星的总质量大得多，那就很简单了`sum(m[i])`。这简化了问题，因为它允许您将星星固定到坐标系的中心。此外，更容易假设所有行星的运动是共面的，这进一步将问题的维数降低到 2D。

1.  `r[i]`首先确定给定半径矢量（轨道半径）大小的圆形轨道速度的大小。由于上述假设，它仅取决于恒星的质量：`v[i] = sqrt(mu / r[i])`，其中`mu`是恒星的标准引力参数，`mu = G * M`。

2.  `phi[i]`通过从 中均匀采样来选择一个随机轨道相位参数`[0, 2*pi)`。那么行星在笛卡尔坐标中的初始位置为：
    `x[i] = r[i] * cos(phi[i])`
    `y[i] = r[i] * sin(phi[i])`

3.  对于圆形轨道，速度矢量总是垂直于径向矢量，即它的方向是`phi[i] +/- pi/2`（`+pi/2`逆时针（CCW）旋转和`-pi/2`顺时针旋转）。让我们以CCW旋转为例。行星速度的笛卡尔坐标为：
    `vx[i] = v[i] * cos(phi[i] + pi/2) = -v[i] * sin(phi[i])`
    `vy[i] = v[i] * sin(phi[i] + pi/2) = v[i] * cos(phi[i])`

`z[i] = 0`这很容易通过添加和扩展到共面 3D 运动`vz[i] = 0`，但这没有任何意义，因为在 Z 方向上没有力，因此`z[i]`并且`vz[i]`永远保持等于`0`（即您将解决完整 3D 空间的 2D 子空间问题）。

通过完整的 3D 模拟，每个行星在随机倾斜的初始轨道上移动，可以这样工作：

1.  此步骤等于 2D 案例中的步骤 1。

2.  您需要在单位球体表面上选取一个初始位置。有关如何以统一随机方式执行此操作的示例，请参见[此处。](http://mathworld.wolfram.com/SpherePointPicking.html)然后将单位球体坐标按 的大小缩放`r[i]`。

3.  在 3D 情况下，行星速度所在的不是两个可能的垂直向量，而是一个完整的切平面。切平面的法向量与半径向量和 共线`dot(r[i], v[i]) = 0 = x[i]*vx[i] + y[i]*vy[i] + z[i]*vz[i]`。`r[i]`例如，可以选择任何垂直于 的向量`e1[i] = (-y[i], x[i], 0)`。这会在两极产生一个空向量，因此可以选择`e1[i] = (0, -z[i], y[i])`。`r[i]`然后通过取和的叉积可以找到另一个垂直向量`e1[i]`：
    `e2[i] = r[i] x e1[i] = (r[2]*e1[3]-r[3]*e1[2], r[3]*e1[1]-r[1]*e1[3], r[1]*e1[2]-r[2]*e1[1])`。现在`e1[i]`和`e2[i]`可以通过将它们除以它们的规范来归一化：
    `n1[i] = e1[i] / ||e1[i]||`
    `n2[i] = e2[i] / ||e2[i]||`
    where `||a|| = sqrt(dot(a, a)) = sqrt(a.x^2 + a.y^2 + a.z^2)`。`omega`既然你在切平面上有一个正交向量基础，你可以选择一个随机角度`[0, 2*pi)`并将速度向量计算为`v[i] = cos(omega) * n1[i] + sin(omega) * n2[i]`，或作为笛卡尔分量：
    `vx[i] = cos(omega) * n1[i].x + sin(omega) * n2[i].x`
    `vy[i] = cos(omega) * n1[i].y + sin(omega) * n2[i].y`
    `vz[i] = cos(omega) * n1[i].z + sin(omega) * n2[i].z`.

请注意，通过构造，步骤 3 中的基础取决于半径矢量，但这并不重要，因为`omega`添加了随机方向 ( )。

至于单位的选择，在模拟科学中，我们总是倾向于将事物保持在自然单位中，即所有计算量都是无量纲的并且保持在`[0, 1]`或至少在 1-2 个数量级之内的单位，因此有限浮动的全分辨率可以使用点表示。如果您将恒星质量以太阳质量为单位，距离以 AU 为单位，时间以年为单位，那么对于在`1`AU 处的类地行星围绕类太阳恒星，轨道速度的大小为`2*pi`(AU/yr)，半径矢量的大小为`1`(AU)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T02:16:01.677

只要让向心加速度等于重力加速度。

m [1] v ² / r = G m [1] m [2] / r ²

v = sqrt( G m [2] / r )

当然，恒星质量 m [2]必须比行星质量 m [1]大得多，否则你就没有真正的一体问题。

设置物理问题时，单位是一件很痛苦的事情。我花了几天时间解决以秒为单位的错误与时间步长单位。你对 AU/Solar Masses/Day 的选择是完全疯狂的。先解决这个问题。

并且，请记住，计算机本身的精度有限。nbody 模拟会累积积分误差，因此经过一百万步或十亿步后，无论步长如何，您肯定不会有一个圆圈。我对那个数学知之甚少，但我认为稳定的 n 体系统通过吸收微小变化的共振来保持自身稳定，无论是由附近的恒星还是由 FPU 引入。因此，对于稳定的 5 体问题，该设置可能工作得很好，但对于 1 体问题仍然会失败。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-13T05:29:37.447

As Ed suggested, I would use the mks units, rather than some other set of units.

For the initial velocity, I would agree with part of what Ed said, but I would use the vector form of the centripetal acceleration:

m[1]v²/r r(hat) = G m[1] m[2] / r2 r(hat)

Set z to 0, and convert from polar coordinates to cartesian coordinates (x,y). Then, you can assign either y or x an initial velocity, and compute what the other variable is to satisfy the circular orbit criteria. This should give you an initial (Vx,Vy) that you can start your nbody problem from. There should also be quite a bit of literature out there on numerical recipes for nbody central force problems.

# javascript - Converting C Program Code to Javascript, producing different Result?

> ID：14845281
> 
> 赞同：-2
> 
> 时间：2013-02-13T02:04:12.573
> 
> 标签：javascript, c

I'm converting a pretty simple program I made in C code into Javascript. The code are identical, however I changed the code into Javascript syntax. For some reason my simple calculation in javascript language is giving me a different result than the one in C. Take a look below. I did some test to see if some of the variables values were the same. Everything, S, S1, S2, V1, V2, T4, LCP are the same. BUT T2 has a different value.

```
S = lesserofcalc(S1,S2);
alert("S1--->" + S1);
alert("S2--->" + S2);
alert("S--->" + S);
//printf("S1:%.2lf | S2:%.2lf | S:%.2lf | T4:%.2lf | V1:%.2lf | K2P:%.2lf \n",S1,S2,S,T4,V1, K2P);
if (LCPK<=LCPRATE*YY){
    LCP = LCPK;
} else {
    LCP = LCPRATE*YY;
}

V2 = OHP();
V2 = roundFIX(V2);
alert("V1--->" + V1);
alert("V2--->" + V2);
alert("T4--->" + T4);
alert("LCP--->" + LCP);

T2 = T4+V1+V2-S-LCP; *GIVING DIFFERENT VALUE FROM C ????*
alert("T2--->" + T2);
T2 = roundFIX(T2); 
```

C Program:

```
S = lesserofcalc(S1,S2);
printf("S1-----> %.2lf \n", S1);
printf("S2-----> %.2lf \n", S2);
printf("S-----> %.2lf \n", S);

//printf("S1:%.2lf | S2:%.2lf | S:%.2lf | T4:%.2lf | V1:%.2lf | K2P:%.2lf \n",S1,S2,S,T4,V1, K2P);
if (LCPK<=LCPRATE*YY){
    LCP = LCPK;
} else {
    LCP = LCPRATE*YY;
}

V2 = OHP();
V2 = roundFIX(V2);
printf("v1-----> %.2lf \n", V1);
printf("V2-----> %.2lf \n", V2);
printf("T4-----> %.2lf \n", T4);
printf("LCP-----> %.2lf \n", LCP);
T2 = T4+V1+V2-S-LCP;
printf("T2-----> %.2lf \n", T2);

T2 = roundFIX(T2); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T02:38:10.557

解决。问题..抱歉是一个毫无意义的问题.. C和javascript中的代码完全相同，我猜它们运行指令/函数的方式不同......或者不是......

# reportbuilder3.0 - 仪表板样式报告报告生成器 3 分组的单独图表

> ID：14845286
> 
> 赞同：0
> 
> 时间：2013-02-13T02:05:16.177
> 
> 标签：reportbuilder3.0

需要帮忙。

我有一个仪表板样式的报告，上面有八个不同的图表。我的目标是让该报告为每个实例单独运行。

只是为了更好地理解一个简单的例子。

A Supermarket 提供以下商品：蔬菜、水果、饮料等。 <-- 第一个参数。取决于您有选择范围的第一个参数。fe vegetabels --> 香蕉、苹果、橙子等 <-- 第二个参数

我想通过数据驱动订阅运行报告。意味着我想为文章（我在订阅中定义）创建单独的报告，其中包括由实例（苹果、香蕉等）分隔的图表。我想获得单独的图表。我不希望这些数据出现在一张图表中。

我试图将表格强制转换为矩阵，但这不起作用。

帮助将不胜感激。

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T06:54:37.903

我认为您需要的是使用子报告。使用这些，您可以创建单独的报告并使用子报告功能将它们联系在一起。这些对我来说效果很好。

示例见[http://technet.microsoft.com/en-us/library/dd220581.aspx](http://technet.microsoft.com/en-us/library/dd220581.aspx)

# ubuntu - 编译 Xvfb 的静态链接二进制文件

> ID：14845291
> 
> 赞同：2
> 
> 时间：2013-02-13T02:06:01.247
> 
> 标签：ubuntu, compilation, xvfb

我在这里用头撞墙。我正在尝试编译 Xvfb 虚拟帧缓冲区的静态链接二进制文件。

[http://manpages.ubuntu.com/manpages/natty/man1/Xvfb.1.html](http://manpages.ubuntu.com/manpages/natty/man1/Xvfb.1.html)

现在我正在像这样从源代码编译：

```
$ sudo apt-get build-dep xvfb
$ apt-get source Xvfb
$ cd xorg-source
$ ./configure --enable-shared=no
$ make 
```

这仍然会导致编译的二进制文件，但它仍然是动态链接的（我正在使用此命令进行检查）

```
find -iname Xvfb -type f -exec file {} \; 
```

这可能是因为我需要静态链接所有依赖项，但我无法继续。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T02:17:39.880

查看发送到终端的最后一个链接命令并自己（手动）重新运行它，将“shared”替换为“static”（[可以使用静态链接使用库构建共享库吗？](https://stackoverflow.com/questions/1344830/possible-to-build-a-shared-library-with-static-link-used-library)）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-18T17:54:21.027

这在 Ubuntu 12.10/amd64 上对我有用：

```
# be sure to build static versions of all included libraries
$ ./configure --enable-static

$ make

$ cd hw/vfb
$ make clean

# this provides static versions of some functions which are dynamic only in eglibc
$ sudo apt-get install libtirpc-dev

# LDFLAGS=-all-static asks libtool to do static linking
# LD_EXPORT_SYMBOLS_FLAGS= causes --export-dynamic to be omitted
# LIBS='...' fills in missing dependencies for static libraries
$ make LDFLAGS=-all-static LD_EXPORT_SYMBOLS_FLAG= LIBS='-lfreetype -lgpg-error -lfontenc -ltirpc -lz -lbz2 -lm -lrt -lpthread' 
```

这有点像黑客，原因有两个：

1.  它对库依赖项进行硬编码（在其他版本的 X 中可能会更改）

2.  它引入了对 libtirpc 的奇怪依赖。没有它，我得到了 xdrmem_create(3) 的未解析符号以及动态链接时 libnsl 提供的其他一些东西：

    ```
    /tmp/xorg-server-1.13.0/os/rpcauth.c:79: undefined reference to `xdrmem_create' 
    ```

# objective-c - set a delegate for dismissModalViewControllerAnimated

> ID：14845293
> 
> 赞同：1
> 
> 时间：2013-02-13T02:06:16.933
> 
> 标签：objective-c, xcode, delegates, uiimagepickercontroller

I have a UIImagePickerController in my app which uses a didFinishPickingMediaWithInfo delegate to monitor whether the user has picked an image.

```
-(void)imagePickerController:(UIImagePickerController *)picker
didFinishPickingMediaWithInfo:(NSDictionary *)info
{
    NSString *mediaType = [info objectForKey:UIImagePickerControllerMediaType];

    if ([mediaType isEqualToString:(NSString *)kUTTypeImage]) {
        UIImage *image = [info
                          objectForKey:UIImagePickerControllerOriginalImage];
    }
    [picker dismissModalViewControllerAnimated:YES];
} 
```

When [picker dismissModalViewControllerAnimated:YES] is called, it will dismiss the current UIImagePickerController view and go back to the view before the UIImagePicker is displayed. I want to set a delegate to send back the selected image to the previous view when the dismissModalVewControllerAnimated is called. How do I do that? Many thanks!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T03:04:02.153

创建选取器时应设置委托。您要返回创建选择器的控制器吗？如果是这样，它应该在那时将自己设置为委托。您应该使用dismissViewControllerAnimated:completion: 而不是贬值的dismissModalViewController。

# ruby-on-rails - Rails 的二对多关系

> ID：14845295
> 
> 赞同：1
> 
> 时间：2013-02-13T02:06:39.313
> 
> 标签：ruby-on-rails, migration, models

我有一个问题，我以某种不令人满意的方式解决了。

我有一个游戏模型，并且在游戏中总是涉及两个团队，它们是团队模型的一部分。我通过 ID team1_id 和 team2_id 引用这些团队。从我的观点来看，每当我想提取整个团队记录时，我都必须每次都进行查找。

我想知道是否有任何方法可以引用这两个团队而无需经历多对多关系，还是唯一的方法？这几乎是一个 2-Many 关系，我知道这不存在，但我想知道解决这类问题的最佳方法。

谢谢，

这是我的迁移快照：

```
create_table :games do |t|
  t.datetime "time"
  t.integer "team1_id"
  t.integer "team2_id"

create_table :teams do |t|
  t.references :city
  t.references :user
  t.string "name", :default => "", :null => false 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T02:14:47.893

您设置它的方式是正确的方式。在游戏模型上制作两个团队引用，team1 和 team2

```
class Game 
  belongs_to :team1, class_name: 'Team'
  belongs_to :team2, class_name: 'Team'
end 
```

然后，您可以在游戏实例上调用 team1 和 team2，它会为您拉出团队。

```
game = Game.first
game.team1
game.team2 
```

或者您可以从 Game 模型中删除 team1 和 team2 id，并创建一个包含游戏和团队的连接表，您只需调用“game.teams”

# python - 如何将 Python/NumPy 用于相当大的项目？

> ID：14845297
> 
> 赞同：3
> 
> 时间：2013-02-13T02:07:00.777
> 
> 标签：python, matlab, numpy

到目前为止，我一直在编写*单脚本*Python 程序，主要用于文本处理和数据分析。

现在我想把我的一个旧的 Matlab 模拟项目带到 Python/NumPy。在那个项目中，我有一个主程序（在一个`.m`文件中），其中有几十个函数（每个函数都在一个单独的`.m`文件中）。所有函数都使用了全局变量，因此我不必将它们作为每个函数的参数输入。但是如果不运行主程序，我就无法运行/测试单个函数，因为全局变量将是未定义的，或者它会调用另一个文件中的另一个函数。再加上文件组织是一团糟。添加新功能，更改现有功能，尤其是主程序是很痛苦的。

这次我想把事情*做好*。我希望程序有一个适当的*架构*，如果它是正确的词。首先，我需要知道如何组织所有这些功能。我不认为每个小功能都有自己的文件是一个好主意。我想也许我可以将这些功能分成几组，每组可以是一个文件？它是`.py`文件还是其他类型的文件？其次，我希望它易于扩展，我可以轻松添加新功能。

我相信必须有一些标准的方法来做到这一点，但我不知道。

还有一个问题：当我运行一个 Matlab 程序时，它完成后，我仍然拥有*工作区*中的所有变量，所以我仍然可以检查数字，制作绘图等。但是当我通过 IPython shell 运行我的 python 脚本时，它之后清除所有内容。有没有和*工作区*类似的东西？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-13T02:15:16.803

任何时候你有一堆函数共享相同的全局状态：

```
foo = 1
def do_something1():
    print foo

def do_something2():
    global foo
    foo += 1 
```

你最好定义一个类：

```
class NoGlobal(object):
     """docstring -- Pick a better name for your class please :)"""

     def __init__(self):
          self.foo = 1

     def do_something1(self):
          print self.foo

     def do_something2(self):
          self.foo += 1 
```

现在您没有共享全局状态，您可以随心所欲地运行您的“模拟”，而无需处理您的全局变量——只需实例化一个新的类实例，您就可以开始新的模拟了。

至于离开它以便您可以在脚本终止后玩弄一些东西，这就是该`-i`选项的用途：

```
python -i yourscript.py 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-13T06:51:47.077

至于交互式 Python shell：如果您想在 Python 中交互式工作， [IPython](http://ipython.org)非常有用。

以 pylab 模式启动：`ipython --pylab`为您提供具有类似 Matlab 功能的交互式 python shell（包[numpy](http://www.numpy.org)和[matplotlib](http://matplotlib.org)中的名称已导入范围。）您还可以保存会话或加载存储的会话和任意 python 程序。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-13T23:31:44.827

我想我找到了我正在寻找的部分内容，这是在这个[问题](https://stackoverflow.com/questions/5155135/how-to-organize-a-python-project)中提出的。可以将事物组织在模块（`.py`文件）和包（带有`__init__.py`文件的文件夹）中。这样，我可以将一堆函数组合成一个*模块*，并将项目的所有模块放在一个*包*中。

我仍然需要了解`class`全局变量。

# java - 以编程方式添加 TextView

> ID：14845298
> 
> 赞同：0
> 
> 时间：2013-02-13T02:07:04.193
> 
> 标签：java, android, textview, parse-platform

我是编程新手，我不确定我是否正确理解如何以 `TextView`编程方式添加。我发现很多人这样做，但他们`this`在上下文中使用。通常我理解，但就我而言，它不会起作用。

我正在`Objects`通过 parse.com 检索 's，并尝试将`String`'s设置为`.findInBackground()`. 这是我的代码：

```
private void Retrieve2() {

        final ParseObject Fighters = new ParseObject("FightersDB");
        ParseQuery query = new ParseQuery("FightersDB");
        query.whereEqualTo("Name", "The First Guy");
        query.findInBackground(new FindCallback(){
            @Override
            public void done(List<ParseObject> objects, ParseException e) {

                  if (e == null) {                   
                        Log.d("Status", "Retrieved suuccessfully"); 
                        String name, record, age;
                     name = Fighters.getString("Name");
                     age = Fighters.getString("Age");
                     record = Fighters.getString("Record");
                     set(name, record, age);     

                    } else {
                        Log.d("Status", "Error: " + e.getMessage());
                    }

            }

            private void set(String name, String record, String age) {

                RelativeLayout rl = (RelativeLayout) findViewById(R.id.rl);

                TextView tv = new TextView(this); //<---- RIGHT HERE IS MY PROBLEM
                RelativeLayout.LayoutParams params = new RelativeLayout.LayoutParams((int)LayoutParams.WRAP_CONTENT, (int)LayoutParams.WRAP_CONTENT);
                params.leftMargin=0;
                params.topMargin=80;
                tv.setPadding(10, 0, 0, 0);
                tv.setText("" + name + "" + record + "" + age);
                tv.setTextSize((float) 20);
                tv.setLayoutParams(params);
                rl.addView(tv);

            }           
        }); 
```

在我在代码中指出的地方，我收到一个错误，指出`The constructor TextView(new FindCallback(){}) is undefined`我不知道如何在`TextView`不使用`this`上下文的情况下添加 a。也许我在如何添加这个方面都错了。

所以我的问题是我应该投入什么`context`来完成这项工作？我是编程新手，所以请详细解释一下。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T02:13:38.953

```
this 
```

指类的当前对象。通常你会看到很多人在 Activity 类中以编程方式创建 View 时使用它：

```
TextView tv = new TextView(this); 
```

this 指的是 Activity.this ，大多数 View 都需要 Context。并且 Activity 是从 Context 扩展而来的，所以你可以将 Activity 作为 Context 传入。

**你的解决方案：**
目前你没有显示这是什么类，如果这是一个Activity类，就用这个，如果这是一个Activity类的innerClass，使用ActivityClass.this，如果这不是一个Activity类，你有在方法（或构造函数/字段）的参数中获取上下文；

**更新**既然你说它是 Activity 类的内部类，你可以使用 ActivityClass.this 作为 Context 传递：

```
TextView(ActivityClass.this); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-13T02:10:08.873

尝试使用`ActivityClass.this`，例如

```
TextView tv = new TextView(ActivityClass.this); 
```

# xcode - XCODE让我知道如何对数字大小进行排序

> ID：14845301
> 
> 赞同：-1
> 
> 时间：2013-02-13T02:07:20.350
> 
> 标签：xcode, sorting

以下是我的代码：

```
NSArray *myarr = [[NSArray alloc]initWithObjects:@"2",@"13",@"1",@"21",@"300",@"4", nil];
NSSortDescriptor *desc = [[NSSortDescriptor alloc]initWithKey:@"self" ascending:YES];
NSArray *rrrr = [myarr sortedArrayUsingDescriptors:[NSArray arrayWithObject:desc]];
NSLog(@"%@",rrrr); 
```

以下是我的结果：

```
1,
13,
2,
21,
300,
4 
```

虽然以下是我的预期结果：

```
1,
2,
4,
13,
21,
300 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T02:15:45.353

您的对象是字符串，而不是数字。尝试这个：

```
NSArray *myarr = [[NSArray alloc]initWithObjects:@2,@13,@1,@21,@300,@4, nil];
NSSortDescriptor *desc = [[NSSortDescriptor alloc]initWithKey:@"self" ascending:YES];
NSArray *rrrr = [myarr sortedArrayUsingDescriptors:[NSArray arrayWithObject:desc]];
NSLog(@"%@",rrrr); 
```

你得到的是字母排序而不是数字排序。看看您是否使用该代码得到不同的结果。

# javascript - PushState() PopState() 集成

> ID：14845303
> 
> 赞同：0
> 
> 时间：2013-02-13T02:07:28.420
> 
> 标签：javascript, html, browser, browser-history

我有一个使用 .js 提供类似内容的网站：

```
var FluidNav = {
init: function() {
    $("a[href*=#]").click(function(e) {
        e.preventDefault();
        if($(this).attr("href").split("#")[1]) {
            FluidNav.goTo($(this).attr("href").split("#")[1]);
        }
    });
    this.goTo("home");
},
goTo: function(page) {
    var next_page = $("#"+page);
    var nav_item = $('nav ul li a[href=#'+page+']');
    $("nav ul li").removeClass("current");
    nav_item.parent().addClass("current");
    FluidNav.resizePage((next_page.height() + 40), true, function() {
         $(".page").removeClass("current"); next_page.addClass("current"); 
    });
    $(".page").fadeOut(500);
    next_page.fadeIn(500);

    FluidNav.centerArrow(nav_item);

},
centerArrow: function(nav_item, animate) {
    var left_margin = (nav_item.parent().position().left + nav_item.parent().width()) + 24 - (nav_item.parent().width() / 2);
    if(animate != false) {
        $("nav .arrow").animate({
            left: left_margin - 8
        }, 500, function() { $(this).show(); });
    } else {
        $("nav .arrow").css({ left: left_margin - 8 });
    }
},
resizePage: function(size, animate, callback) {
    if(size) { var new_size = size; } else { var new_size = $(".page.current").height() + 40; }
    if(!callback) { callback = function(){}; }
    if(animate) {
        $("#pages").animate({ height: new_size }, 400, function() { callback.call(); }); 
    } else {
        $("#pages").css({ height: new_size }); 
    }
}}; 
```

到目前为止一切顺利，但客户端希望集成浏览器后退按钮功能。我做了功课，在 SO 和其他来源的帮助下发现 pushState 和 popState 是实现这一目标的最佳方式。

如果您花一点时间阅读上面的代码，您会发现以下内容：

1.  如果您在浏览器中键入 website.com/#team，您将获得首页，而不是 #team 页面。如果要导航到#team，则必须从那里单击。
2.  如果您导航到#team，然后想要返回首页，然后按后退按钮，您将被重定向到访问网站之前的位置。可以这么说被踢出去了。

这样做是为了获得更流畅的浏览体验。

但是，我现在需要实现以下目标，并且对于必须对上面的 .js 文件进行哪些更改感到有些迷茫：

1.  实现有效的后退按钮功能（操作浏览器的历史存储）
2.  当我在 URL 栏中键入 website.com/#team 时，转到该页面而不是首页。

这是一个使用此功能构建的示例网站，因此您可以了解它的功能。[http://themes.two2twelve.com/site/fluidapp/light/](http://themes.two2twelve.com/site/fluidapp/light/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T02:23:14.523

您可以尝试集成一个库来处理无法使用 pushState 的浏览器（回退到您所描述的哈希 url。过去我对[History.js](https://github.com/balupton/History.js/)有过一些运气。（明白了吗？？）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-08-22T09:37:50.097

**注意：**此答案由提问者提供，作为对问题的编辑，而不是作为答案。我已将其移至此处以符合站点标准。

* * *

我做了以下事情：

1.  按照此处的说明将 History.js 下载并解压缩到我的服务器：[https ://github.com/browserstate/history.js/](https://github.com/browserstate/history.js/)

2.  按照此处安装：[https ://github.com/browserstate/ajaxify](https://github.com/browserstate/ajaxify)

3.  从这里安装了 StateRouter[看不懂 History.js，需要简化吗？](https://stackoverflow.com/questions/7369043/cant-understand-history-js-need-it-simplified)在这里[https://github.com/aknuds1/staterouter.js/tree/master/lib](https://github.com/aknuds1/staterouter.js/tree/master/lib)

到目前为止已经取得的成就：

现在 URLs 实际上会随着后退按钮而改变，这意味着：

我转到**主页 -> 用户 -> 员工**，然后使用后退按钮，URL 栏中的 URL 将更改如下：**www.123.com/#staff -> www.123.com/#users -> www.123 .com/#home**。然而，只有 UR1 改变，内容没有改变。有什么我想念的想法吗？

# scheme - 如何使用方案删除列表中的第三个元素

> ID：14845304
> 
> 赞同：2
> 
> 时间：2013-02-13T02:07:53.190
> 
> 标签：scheme, racket

这就是我要的：

```
(delete-third1 '(3 7 5))    ==>  (3 7)
(delete-third1 '(a b c d))  ==>  (a b d) 
```

所以我做了类似的事情：

```
(define (delete-third1 LS ) (list(cdr LS))) 
```

返回

```
(delete-third1 '(3 7 5))
((7 5)) 
```

什么时候应该`(3 7)`。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T02:32:12.973

想想在`cdr`做什么。`cdr`说“给定一个列表，砍掉第一个值并返回列表的其余部分”。所以它只删除第一个值，然后返回该列表的其余部分（这正是您所看到的）。由于它返回一个列表，因此您也不需要`list (cdr LS)`那里。

你想要的是这样的：

```
(define (delete-n l n)
  (if (= n 0) 
      (cdr l)
      (append (list (car l)) (delete-n (cdr l) (- n 1)))))

(define (delete-third l)
  (delete-n l 2)) 
```

那么这是如何工作的呢？`delete-n`将通过保持我们正在处理的元素的运行计数来删除`n`列表的第 th 元素。如果我们没有达到`n`第 th 个元素，则将该元素添加到列表中。如果是，则跳过该元素并将其余元素添加到我们的列表中。

然后我们简单地定义`delete-third`它`delete-n`删除第 3 个元素的位置（当我们从 0 开始计数时，它是第 2 个元素）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-25T04:33:00.077

这有效：

```
(define (delete-third! l)
  (unless (or (null? l)
              (null? (cdr l))
              (null? (cddr l)))
    (set-cdr! (cdr l) (cdddr l)))
  l) 
```

如果您想要一个不修改列表的版本：

```
(define (delete-third l)
  (if (not (or (null? l)
               (null? (cdr l))
               (null? (cddr l))))
      (cons (car l) (cons (cadr l) (cdddr l)))
      l)) 
```

如果您想对任何第 n 个元素执行此操作：

```
(define (list-take list k)
  (assert (not (negative? k)))
  (let taking ((l list) (n k) (r '()))
    (if (or (zero? n) (null? l))
        (reverse r)
        (taking (cdr l) (- n 1) (cons (car l) r)))))

(define (delete-nth l n)
  (assert (positive? n))
  (append (list-take l (- n 1))
          (if (> n (length l))
              '()
              (list-tail l n))))

(define (nth-deleter n)
  (lambda (l) (delete-nth l n)))

(define delete-3rd (nth-deleter 3)) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-13T02:26:51.680

最简单的方法是：将第一个元素、第二个元素和列表的其余部分从第四个位置开始。因为这看起来像作业，所以我只会给你大致的想法，所以你可以填空：

```
(define (delete-third1 lst)
  (cons <???>          ; first element of the list
        (cons <???>    ; second element of the list
              <???>))) ; rest of the list starting from the fourth element 
```

以上假设列表*至少包含*三个元素。如果情况并非总是如此，请首先验证列表的大小并针对该情况返回适当的值。

更多提示：在 Racket 中有一个用于访问列表第一个元素的直接过程。另一个用于访问第二个元素。最后，您始终可以使用`cdr`s 序列来到达 ... 列表的其余部分（但即使这样也可以写得更紧凑）

从实际的角度来看，如果这不是功课，您可以根据其他现有程序轻松实现此功能，甚至使其足够通用以删除任何给定位置的元素。例如，要删除第三个元素（再次假设列表中有足够的元素）：

```
(append (take lst 2) (drop lst 3)) 
```

或者作为从给定的基于 0 的索引中删除元素的一般过程：

```
(define (remove-ref lst idx)
  (append (take lst idx) (drop lst (add1 idx)))) 
```

以下是我们删除第三个元素的方法：

```
(remove-ref '(3 7 5) 2)
=> '(3 7) 
```

# delphi - 如何计算两个日期之间的工作日数？

> ID：14845308
> 
> 赞同：12
> 
> 时间：2013-02-13T02:08:37.657
> 
> 标签：delphi, delphi-xe2

我需要计算两个给定日期之间的工作日数（工作日）。工作日是一周中的所有日子，周六和周日除外。我不考虑把假期计入这个数量。

如何计算两个日期之间的工作日数？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-02-13T16:43:42.223

```
function BusinessDaysSinceFixedDate ( const nDate : tDateTime ) : integer;
const
  Map : array [ -6 .. 6 ] of integer
      = (  0, 0, 1, 2, 3, 4, 5, 5, 5, 6, 7, 8, 9 ); 
var
  X : integer;
begin
  X := trunc ( nDate );
  Result := 5 * ( X div 7 ) + Map [ X mod 7 ];
end;

function BusinessDaysBetweenDates ( const nStartDate : tDateTime;
                                    const nEndDate   : tDateTime ) : integer;
begin
  Result :=   BusinessDaysSinceFixedDate ( nEndDate )
            - BusinessDaysSinceFixedDate ( nStartDate );
end; 
```

例程 BusinessDaysSinceFixedDate 计算自固定日期以来的工作日数。不相关的具体日期是 1899 年 12 月 25 日星期一。它只是计算已经过去的周数 (X div 7) 并将其乘以 5。然后它根据日期添加一个偏移量以进行更正星期。请注意， (X mod 7) 将为负日期返回负值，即 1899 年 12 月 30 日之前的日期。

例程 BusinessDaysBetweenDates 只需调用 BusinessDaysSinceFixedDate 来获取开始日期和结束日期，然后从另一个中减去一个。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-02-13T14:50:40.197

无需循环所有天并且输入参数不取决于顺序。

```
Uses DateUtils,Math;

function WorkingDaysBetween( const firstDate,secondDate : TDateTime) : Integer;
var
  startDate,stopDate : TDateTime;
  startDow,stopDow : Integer;
begin
  if (firstDate < secondDate) then
  begin
    startDate := firstDate;
    stopDate := secondDate;
  end
  else
  begin
    startDate := secondDate;
    stopDate := firstDate;
  end; 
  startDow := DayOfTheWeek(startDate);
  stopDow := DayOfTheWeek(stopDate);
  if (stopDow >= startDow) then
    stopDow := Min(stopDow,6)
  else
    Inc(stopDow,5); 

  Result := 
    5*WeeksBetween(stopDate,startDate) + 
    (stopDow - Min(startDow,6));
end; 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2013-02-13T02:15:11.897

您需要使用[`DayOfTheWeek`](http://docwiki.embarcadero.com/Libraries/XE3/en/System.DateUtils.DayOfTheWeek)（从`DateUtils`单位）和一个计数器，从开始日期迭代到结束日期。（您可能还需要一张假期表，以将其排除在您的计数之外。）

```
function BusinessDaysBetween(const StartDate, EndDate: TDateTime): Integer;
var
  CurrDate : TDateTime;
begin
  CurrDate := StartDate;
  Result := 0;
  while (CurrDate <= EndDate) do
  begin
    // DayOfTheWeek returns 1-5 for Mon-Fri, so 6 and 7 are weekends
    if DayOfTheWeek(CurrDate) < 6 then
      Inc(Result);
    CurrDate := CurrDate + 1;
  end;
end; 
```

您可以通过不担心参数的顺序来稍微增强这一点（换句话说，无论 start 是在 end 之前还是 end 在 start 之前，该函数仍然可以工作）：

```
function BusinessDaysBetween(const FirstDate, SecondDate: TDateTime): Integer;
var
  CurrDate : TDateTime;
  StartDate, EndDate: TDateTime;
begin
  if SecondDate > FirstDate then
  begin
    StartDate := FirstDate;
    EndDate := SecondDate;
  end
  else
  begin
    StartDate := SecondDate;
    EndDate := FirstDate;
  end;

  CurrDate := StartDate;
  Result := 0;

  while (CurrDate <= EndDate) do
  begin
    if DayOfTheWeek(CurrDate) < 6 then
      Inc(Result);
    CurrDate := CurrDate + 1;
  end;
end; 
```

# php - PHP字符串到hashmap

> ID：14845311
> 
> 赞同：0
> 
> 时间：2013-02-13T02:08:46.967
> 
> 标签：php, string, algorithm, hash, modulus

给定一个由 6 个唯一字符串组成的数组（我事先不知道并且总是以随机顺序给出）我如何映射这些字符串以便可以为每个字符串分配一个 1-6（或 0-5）的数字. 并在下一个脚本运行时分配相同的编号？

我还应该补充一点，并不是所有的字符串都会在每个脚本运行时传递

例如

```
// Script Run 1: 
string1 => 2
string2 => 6
string3 => 5
string6 => 1

// Script Run 2: 
string3 => 5
string4 => 4
string2 => 6
string5 => 3

// Note how strings 2 and 3 have the same mapping 
```

我假设一些类似于散列和 mod(6) 的东西，但不确定如何实现。有什么建议么？

**注意：这是在脚本中，会话不可用**

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T04:05:12.463

## 分配数字的模数用法示例

由于要求每个字符串限制在 0 到 5 或 1 到 6 之间的数字，并且数据集不断变化/不完整，因此不可能达到预期的最终结果。假设我们取 6 个字符串，我们将对它们进行 crc，然后进行模数 6 并显示结果。输入：

```
Array
(
    [0] => string1
    [1] => string2
    [2] => string3
    [3] => string4
    [4] => string5
    [5] => string6
) 
```

（`crc32`使用`sprintf('%u', crc32('string'))`：

```
Array
(
    [0] => 742935113
    [1] => 3040943091
    [2] => 3259378533
    [3] => 1545780934
    [4] => 723881552
    [5] => 2989285354
) 
```

结果`crc32 % 6`：

```
Array
(
    [0] => 5
    [1] => 1
    [2] => 1
    [3] => 4
    [4] => 2
    [5] => 1
) 
```

如您所见，“string2”、“string3”和“string6”都与[桶](http://en.wikipedia.org/wiki/Hash_table#bucket)发生冲突，导致它们被分配一个“1”，通过碰撞检测，一个简单的`+1`直到找到一个空桶将用于这个例子。所以我们最终得到了我们的`bucket`数组：

```
Array
(
    [0] => string6
    [1] => string2
    [2] => string3
    [3] => string5
    [4] => string4
    [5] => string1
) 
```

下一次，假设我们摆脱`[1] => string2`了原始输入，那么我们的 6 个结果数组将如下所示：

```
Array
(
    [0] => 
    [1] => string3
    [2] => string5
    [3] => string6
    [4] => string4
    [5] => string1
) 
```

这显示了当数据集不完整且包含少量键时会发生什么，分配的数字对于某些人来说是截然不同的。

问题是`load`. 这个负载是 100%，因为有 6 个可能的文本，并且只有 6 个`buckets`。创建哈希表时，您希望负载接近 0，对于 6 个条目的 50% 负载，您需要 12 个可用存储桶。

**记住**

在 PHP 中使用 a`modulus`时，您还必须记住最大整数大小，[因为用于模运算的任何值都将转换为整数](http://php.net/manual/en/language.operators.arithmetic.php)：

> 模数的操作数在处理之前被转换为整数（通过去除小数部分）。

根据您的系统，这将是 32 位或 64 位。一个无符号的 crc32 将超过 32 位系统上的最大上限并返回 int 上限，这意味着一半的数字将在同一个桶中结束（统计上），这正是我们之前一半的值在桶 '1 中结束时发生的情况'。

## 我们能做些什么？

好吧，问题是我们可以选择的数字范围。根据分配不同字符串数字的所需应用程序，我们可以使用实`crc32`数，因为对于小数据集，结果中的冲突数量将是最小的 - 但是，如果我们需要输入文本的连续数字集（或在如所描述的一个小范围），没有解决方案可以允许部分数据集，同时在每次运行中保持分配的数字不变。由于每次运行脚本时输入字符串的顺序都是随机的，因此绝对没有办法每次都保持结果整数相同，因为如果在每次运行之间的不同时间处理冲突，它们的顺序可能会颠倒。

如果目的是标记文件或访问某些内容的方式，请使用更大的散列，不要`mod`让它适合它的大小。

# php - 反向 mime_content_type

> ID：14845314
> 
> 赞同：2
> 
> 时间：2013-02-13T02:08:47.370
> 
> 标签：php, string

PHP 有一个内置的 mime_content_type，它为文件和扩展名输入（例如：image.jpg）返回一个 MIME 类型（例如：image/jpeg）。我一直在寻找从 MIME 类型到扩展的函数，但我认为它不存在。

可以？如果没有，是否有一种简单的方法可以从“image/jpeg”到“.jpg”或“image/png”到“.png”，或者类似的东西？

谢谢！

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-02-13T16:06:16.497

像这样的东西？：

```
<?php

function MIME($mime)
{
  $list = explode("/",$mime);

  return ".".$list[1];
}

$my_mime = "image/jpeg";

$type = MIME($my_mime);

echo $type;

?> 
```

如果你愿意，你可以改进我的代码.....我希望它有帮助 ;) .....saludos

# filesystems - ext3 是否以有序模式记录间接/双间接块？

> ID：14845317
> 
> 赞同：0
> 
> 时间：2013-02-13T02:09:37.520
> 
> 标签：filesystems, ext3, journal

在 ext3 文件系统中，如果是日志模式，间接块、双重间接块和三重间接块是否会被视为元数据块并被记录？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T11:07:33.367

[使用来自Linux`fs/ext3/inode.c`](http://git.kernel.org/?p=linux/kernel/git/torvalds/linux-2.6.git;a=blob;f=fs/ext3/inode.c#l1555)的源 Luke （链接的行号正确，但 URL 是 Linus 的头树，因此最终可能会改变）：

```
/*
 * Note that we always start a transaction even if we're not journalling
 * data.  This is to preserve ordering: any hole instantiation within
 * __block_write_full_page -> ext3_get_block() should be journalled
 * along with the data so we don't crash and then get metadata which
 * refers to old data.
[ ... ]
static int ext3_ordered_writepage(struct page *page,
                                struct writeback_control *wbc)
{
        struct inode *inode = page->mapping->host;
        struct buffer_head *page_bufs;
        handle_t *handle = NULL;
        int ret = 0;
        int err;
[ ... ]
        handle = ext3_journal_start(inode, ext3_writepage_trans_blocks(inode));
[ ... ]
        ret = block_write_full_page(page, ext3_get_block, wbc);
[ ... ]

        /*
         * And attach them to the current transaction.  But only if
         * block_write_full_page() succeeded.  Otherwise they are unmapped,
         * and generally junk.
         */
        if (ret == 0) {
                err = walk_page_buffers(handle, page_bufs, 0, PAGE_CACHE_SIZE,
                                        NULL, journal_dirty_data_fn);
                if (!ret)
                        ret = err;
        }
        walk_page_buffers(handle, page_bufs, 0,
                        PAGE_CACHE_SIZE, NULL, bput_one);
        err = ext3_journal_stop(handle);
        if (!ret)
                ret = err;
[ ... ]
        return ret;
}
[ ... ]
/*
 * ext3_truncate()
 *
 * We block out ext3_get_block() block instantiations across the entire
 * transaction, and VFS/VM ensures that ext3_truncate() cannot run
 * simultaneously on behalf of the same inode.
 *
 * As we work through the truncate and commit bits of it to the journal there
 * is one core, guiding principle: the file's tree must always be consistent on
 * disk.  We must be able to restart the truncate after a crash.
 *
[ ... ]
 */
void ext3_truncate(struct inode *inode)
{
        handle_t *handle;
[ ... ]
        handle = start_transaction(inode);
[ ... ]
        /*
         * OK.  This truncate is going to happen.  We add the inode to the
         * orphan list, so that if this truncate spans multiple transactions,
         * and we crash, we will resume the truncate when the filesystem
         * recovers.  It also marks the inode dirty, to catch the new size.
         *
         * Implication: the file must always be in a sane, consistent
         * truncatable state while each transaction commits.
         */
        if (ext3_orphan_add(handle, inode))
                goto out_stop;
[ ... ]
        if (n == 1) {           /* direct blocks */
                ext3_free_data(handle, inode, NULL, i_data+offsets[0],
                               i_data + EXT3_NDIR_BLOCKS);
                goto do_indirects;
        }
[ ... ]
do_indirects:
        /* Kill the remaining (whole) subtrees */
        switch (offsets[0]) {
        default:
                nr = i_data[EXT3_IND_BLOCK];
                if (nr) {
                        ext3_free_branches(handle, inode, NULL, &nr, &nr+1, 1);
                        i_data[EXT3_IND_BLOCK] = 0;
                }
        case EXT3_IND_BLOCK:
                nr = i_data[EXT3_DIND_BLOCK];
                if (nr) {
                        ext3_free_branches(handle, inode, NULL, &nr, &nr+1, 2);
                        i_data[EXT3_DIND_BLOCK] = 0;
                }
        case EXT3_DIND_BLOCK:
                nr = i_data[EXT3_TIND_BLOCK];
                if (nr) {
                        ext3_free_branches(handle, inode, NULL, &nr, &nr+1, 3);
                        i_data[EXT3_TIND_BLOCK] = 0;
                }
        case EXT3_TIND_BLOCK:
                ;
        }
[ ... ]
        ext3_journal_stop(handle);
[ ... ]
} 
```

这清楚地表明文件扩展名/截断（即任何级别的直接/间接块的分配和/​​或释放）总是被处理的。即使在之前没有创建事务的情况下被调用，它本身也将打开一个事务的代码`ext3_get_blocks()`- 用于直接 I/O 写入。

简而言之 - 是的，只要 ext3 有日志，那么任何级别的直接/间接块的修改都会被处理。

# sql-server - 如何从模式创建表

> ID：14845318
> 
> 赞同：0
> 
> 时间：2013-02-13T02:09:47.583
> 
> 标签：sql-server, sql-server-2008, tsql

我的数据库中有一个名为 tbRep 的表

我在 SQL Server 数据库 X、Y、Z 上有 3 个模式

现在 X & Y 有名为 X.tbRep & Y.tbRep 的表

但是，当我尝试使用来自例如 X.tbRep 的 CREATE To 脚本并尝试为新架构 Z 创建一个时，它会抛出一个错误，

> 消息 2714，级别 16，状态 6，第 2 行 数据库中已经有一个名为“tbRep”的对象。

我在这里做错了什么？

我确定有 Z.tbRep 不存在

> 创建到脚本

```
USE [Info]
GO

SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

SET ANSI_PADDING ON
GO

CREATE TABLE [Z].[tbRep](
[ReplicaGroup] [varchar](50) NOT NULL,
[RunFrequencyUnit] [char](1) NOT NULL,
[Enabled] [bit] NOT NULL,
[LastRun] [datetime] NOT NULL,
[RunFrequency] [int] NOT NULL,
[ReplicationWindowType] [char](1) NOT NULL,
[ReplicationWindowSize] [tinyint] NOT NULL,
 CONSTRAINT [PK_tbReplicaGroups] PRIMARY KEY CLUSTERED 
(
[ReplicaGroup] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF,         ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_PADDING OFF
GO

ALTER TABLE [Z].[tbReplicaGroups] ADD  CONSTRAINT    [DF_tbReplicaGroups_ReplicationWindowType]  DEFAULT ('D') FOR [ReplicationWindowType]
GO

ALTER TABLE [Z].[tbReplicaGroups] ADD  CONSTRAINT  [DF_tbReplicaGroups_ReplicationWindowSize]  DEFAULT ((1)) FOR [ReplicationWindowSize]
GO 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T07:40:22.037

--检查表是否不存在，如果不存在，则添加创建脚本
（从 sys.tables 中选择名称，其中 name = 'tpRep'）
BEGIN
--表创建代码在此处
END

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T14:45:42.717

您可以在 CREATE TABLE 语句之前执行此操作并让我们知道您是否得到任何东西？

```
select * 
from sys.all_objects 
where sys.all_objects.name = 'tbRep' and 
sys.all_objects.type = 'U' and
sys.all_objects.schema_id = (select schema_id from sys.schemas where sys.schemas.name = 'Z') 
```

# macos - 使用 awk 修复未封闭字段中带有逗号的 CSV 文件

> ID：14845319
> 
> 赞同：0
> 
> 时间：2013-02-13T02:09:50.090
> 
> 标签：macos, csv, awk

我有一个 CSV 文件，如下所示：

```
 height,  comment, name
  152,  he was late, for example, on Tuesday, Fred
  162, , Sam 
```

我无法解析此文件，因为它在注释字段中包含可变数量的未括起来的逗号（但没有其他字段）。我想使用`awk`（这对我来说很新）修复文件，以便第二个字段中的逗号变为分号：

```
 height,  comment, name
  152,  he was late; for example; on Tuesday, Fred
  162, , Sam 
```

（将整个字段括在引号中不会解决我的问题，因为我的 CSV 解析器不理解引号。）

到目前为止，我正在考虑使用 NF 来计算未括起来的逗号的数量，然后使用 gsub 用令人不快的正则表达式替换它们，但我觉得我应该能够利用 awk 编写一个更具可读性的程序，我不确定 NF 的行为这边走。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T03:41:26.593

本质上只是一个蛮力解决方案，但相当容易理解。调用

```
$ awk -F "," -f test.awk test.dat 
```

awk 文件。

```
$ cat test.awk
{
    printf "%s, ", $1

    if (NF > 3) {
        for (i = 2; i < NF; i++) {
            printf "%s;", $i
        }
        printf ", "
    }
    else {
        printf "%s, ", $2
    }

    printf "%s\n", $NF
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-13T03:42:00.550

```
$ cat file
  height,  comment, name
  152,  he was late, for example, on Tuesday, Fred
  162, , Sam

$ awk -v OFS=, '{
   height = comment = name = $0
   sub(/,.*$/,"",height)
   sub(/^.*,/,"",name)
   gsub(/^[^,]+,|,[^,]+$/,"",comment)
   gsub(/,/,";",comment)

   print height, comment, name
}' file
  height,  comment, name
  152,  he was late; for example; on Tuesday, Fred
  162, , Sam 
```

# html - a:active 只能短暂工作（在鼠标单击期间）

> ID：14845320
> 
> 赞同：2
> 
> 时间：2013-02-13T02:10:01.900
> 
> 标签：html, css, html-lists, bold

出于某种原因，我这样做了，所以我的活动文本 (a) 是粗体的，但它只有在用鼠标单击它时才处于活动状态，当它从单击中释放时，它会关闭并且文本返回到它的正常状态。

为什么是这样？

如果您访问 MSN，请查看其搜索栏上方的文本。当您单击它时，它会变粗并变成橙色。无需离开页面。这就是我想要做的。

HTML：

```
<div id="searchtopics">
<ul>

    <li><a href="#">Web</a> </li>
    <li><a href="#">MSN</a> </li>
    <li><a href="#">Images</a> </li>
    <li><a href="#">Video</a> </li>
    <li><a href="#">News</a> </li>
    <li><a href="#">Maps</a> </li>
    <li><a href="#">Shopping</a> </li>

</ul>
</div> 
```

CSS：

```
#searchtopics {
    position:absolute;
    margin-left:208px;
    margin-top:38px;
    }

#searchtopics a {
    text-decoration:none;
    float:left;
    padding: 2px 6px 4px 6px;
    color:rgb(100,100,100);
    }

#searchtopics a:hover{
    text-decoration:underline;

    }

#searchtopics a:active{
    color:rgb(100,100,100);
    font-weight:bold;

    }

#searchtopics ul   {
    display:inline;
    list-style:none;
}

#searchtopics ul li {
    display:inline;
    color:rgb(100,100,100);
    font-family:"arial", times, sans-serif;
    font-size:12px;
    } 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-13T02:11:05.170

那是因为该链接只有在您用鼠标单击它时才处于活动状态。如果您希望效果持续到鼠标悬停的整个长度，请使用`:hover`. 如果您希望它在页面被访问后持续使用，请使用`:visited`.

**编辑**

如果您希望链接在加载新页面时保持活动状态，您需要为该链接提供一个应用该样式的类：

```
<li><a href="#" class="active">Images</a> </li>

#searchtopics a:active, a.active { 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T02:15:23.797

如果要显示包含实际显示内容的链接，除了 little javascript 没有其他解决方案。编写一些函数来显示内容，这将禁用所有其他粗体，为当前链接启用粗体并显示内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-13T02:34:01.240

链接有四种主要状态： a:hover a:active a:visited

a - 只是当它坐在那里并且从未被点击或正在被点击时。

a:hover - 这有点像 javascript 中的 mouseover 事件（如果你熟悉的话）。当指针“悬停”在链接上时，可以更改样式。

a:active - 这种样式只显示有东西点击链接的瞬间。由于这个原因，这个伪类可能是公众使用最少的。

a:visited - 此样式在用户单击链接后显示。

因此，如果您尝试更改引人注目的链接样式，我建议您使用不同的伪类而不是 a:active。

希望这可以帮助！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-12-14T19:51:01.180

我知道这是个老话题，但它的简单解决方案是替换 a.active 而不是 a:active ，它对我有用，所以它也应该对你有用

# json - 如何在没有 \n 的情况下以可读格式在 PERL 中获取 JSON 输出？

> ID：14845326
> 
> 赞同：-1
> 
> 时间：2013-02-13T02:10:47.053
> 
> 标签：json, perl, newline, activeperl

我需要从 PERL 脚本中获取可读的 JSON 对象，但它不是可读格式。

这是生成 JSON 的代码。

```
 while (my ($orderID, $possessorName, $itemDescription, $customerPickUpTime, $customerDropOffTime, $paymentAmount, $originAddress1, $originAddress2, $originNeighborhood, $originZipCode, $destinationAddress1, $destinationAddress2, $destinationNeighborhood, $destinationZipCode) = $sth->fetchrow_array) 
        {
            %data = (orderID => $orderID, possessorName => $possessorName, itemDescription => $itemDescription, customerPickUpTime => $customerPickUpTime, customerDropOffTime => $customerDropOffTime, paymentAmount => $paymentAmount, originAddress1 => $originAddress1, originAddress2 => $originAddress2, originNeighborhood => $originNeighborhood, originZipCode => $originZipCode, destinationAddress1 => $destinationAddress1, destinationAddress2 => $destinationAddress2, destinationNeighborhood => $destinationNeighborhood, destinationZipCode => $destinationZipCode);

            $json_obj = JSON->new->allow_nonref;

            my $json_text = $json_obj->pretty->encode(\%data);

            $query_results{"job$index"} = {"data" => $json_text};

            $index++;

        }

        return $json_obj->pretty->encode(\%query_results, {ascii => 1, pretty => 1}); 
```

一切正常，除非我查看文件（这里是打印行）：

```
 open (resultsFile, ">", "json_file.txt") || die "This doesn't work.";

 print resultsFile "Results: \n\n $results"; 
```

结果如下：

```
 {
    "job3" : {
  "data" : "{\n   \"originAddress1\" : \"101 East 105th Street\",\n   \"destinationZipCode\" : \"10128\",\n   \"destinationNeighborhood\" : \"Upper East Side\",\n   \"customerDropOffTime\" : \"2013-01-22 23:41:37\",\n   \"originAddress2\" : \"\",\n   \"paymentAmount\" : \"19.00\",\n   \"customerPickUpTime\" : \"2013-01-22 22:56:37\",\n   \"itemDescription\" : \"body\",\n   \"destinationAddress1\" : \"180 East 93rd Street\",\n   \"destinationAddress2\" : \"\",\n   \"possessorName\" : \"Lisa Howard\",\n   \"originZipCode\" : \"10029\",\n   \"originNeighborhood\" : \"East Harlem\",\n   \"orderID\" : \"723\"\n}\n"
}, 
```

JSON 对象的格式正确，但这`\n`就是问题所在。它没有使用实际的换行符输出。这就是问题所在。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T02:21:31.830

这是因为，`$json_text`是字符串而不是哈希。如果要将整个事物编码为 JSON，则必须创建适当的数据结构

```
$query_results{"job$index"} = {"data" => \%data}; 
```

并将其作为一个整体交给`encode`.

# kendo-ui - 为我的 json 数据配置 kendo ui 树视图

> ID：14845328
> 
> 赞同：1
> 
> 时间：2013-02-13T02:10:55.243
> 
> 标签：kendo-ui, kendo-treeview

我有以下数据：

```
[
{"id":1,"parendId":0,"name":"Foods","hasItems":"true},  
{"id":2,"parentId":1,"name":"Fruits","hasItems":"true"},  
{"id":3,"parentId":1,"name":"Vegetables","hasItems":"true"},  
{"id":4,"parentId":2,"name":"apple","hasItems":"false"},  
{"id":5,"parentId":2,"name":"orange","hasItems":"true"},  
{"id":6,"parentId":3,"name":"tomato","hasItems":"true"},  
{"id":7,"parentId":3,"name":"carrot","hasItems":"true"},  
{"id":8,"parentId":3,"name":"cabbage","hasItems":"true"},  
{"id":9,"parentId":3,"name":"potato","hasItems":"true"},  
{"id":10,"parentId":3,"name":"lettuce","hasItems":"false"}
] 
```

有人可以告诉我如何为上述数据配置 kendo ui 树视图吗？另外，是否可以在 kendo ui 下拉列表中有这个树视图？

**更新：**

这是我目前所拥有的......

```
categories = new kendo.data.HierarchicalDataSource({
    transport: {
        read: {
            url: UrlThatFetchesData
        }
    },
    schema: {
        model: {
            id: 'id',
            parentId: 'parentId',
            name: 'name'
        }
    }
});

$('#tvCategories').kendoTreeView({
    dataSource: categories,
    dataTextField: 'name',
    dataValueField: 'id'
}); 
```

所有项目都显示为主要类别，一个在另一个正下方。如何让树视图使用 parentId？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T05:33:03.080

您是否尝试将其他数据嵌入到树视图项中？如果是这样，您的 KendoTreeview 应该如下所示：

```
@(  Html.Kendo().TreeView()
                            .Name("Treeview")
                            .DataTextField("name") //display text
                            .DataSource(dataSource => dataSource
                                .Read(read => read
                                .Action("ActionThatFetchesData", "ControllerName")
                                )
                            )
                            .TemplateId("treeview-template") //name of the template
                            ) 
```

然后使用将显示 json 的 Kendo 模板

```
<script id="treeview-template" type="text/kendo-ui-template">
     <span>#:  item.id#</span>
     <span>#:  item.parentId#</span>
     <span>#:  item.name#</span>
     <span>#:  item.hasItems#</span>
</script> 
```

# twitter-bootstrap-rails - twitter bootstrap 流体布局

> ID：14845334
> 
> 赞同：0
> 
> 时间：2013-02-13T02:11:18.347
> 
> 标签：twitter-bootstrap-rails

我想实现流畅的布局。显示在这里[http://twitter.github.com/bootstrap/scaffolding.html#global](http://twitter.github.com/bootstrap/scaffolding.html#global)

我做了什么：添加 gem 'twitter-bootstrap-rails + bundle install

布局/应用程序布局

```
 <head>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="css/bootstrap.min.css" rel="stylesheet" media="screen">

  </head>

<body>
<script src="http://code.jquery.com/jquery.js"></script>
<script src="js/bootstrap.min.js"></script>
<div class="container-fluid">
    <div class="row-fluid">
    <div class="span2">
     SIDEBAR
    </div>
    <div class="span10">
      <%= yield %>
    </div>
  </div>
</div>
</body> 
```

没有任何改变。我忘记了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T02:16:50.987

bootstrap-responsive.css 文件只是 bootstrap 的一部分。您需要的主要 css 文件称为 bootstrap.css

尝试在标题中添加这行代码，看看是否有任何变化：

```
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.0/css/bootstrap-combined.min.css" rel="stylesheet">
<link href="assets/css/bootstrap-responsive.css" rel="stylesheet">
</head> 
```

实际上，它确实有效，请查看 jsFiddle：

[http://jsfiddle.net/persianturtle/sEywB/](http://jsfiddle.net/persianturtle/sEywB/)

# jquery - 动态添加字段

> ID：14845335
> 
> 赞同：0
> 
> 时间：2013-02-13T02:11:24.557
> 
> 标签：jquery

我的情况是这样..单击链接（添加类别）创建一对选择（类别和子类别）填充ajax调用。问题是我必须这样做 n 次点击链接添加类别。我试过这个，但它只适用于第一个：

```
$('.cat').change(function(){
             var Id =  $(this).val();          
             var url = Routing.generate('route_to_retrieve_subcategory');

            $.post(url, 
            { 'idCat': Id  
            }, function(results){
                var sub = $('.cat').parent().find('select[name*="[subCategory][]"]');
                sub.empty();
                $.each(results , function(key, value) { 
                    sub
                    .append($("<option></option>")
                    .attr("value",value.id)
                    .text(value.subCategory));
                });
            });
}); 
```

每个选择类别都有“猫”类。我怎样才能使这个动态？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T02:19:52.217

您可以使用 jQuery 中的 on() 函数：

```
$(document).on('change', '.cat', function() {
     //your logic goes here...
}); 
```

这基本上将在整个文档中的事件“更改”上绑定与选择器“.cat”匹配的任何对象

# scroll - 如何在 watir 中滚动 Web 应用程序

> ID：14845338
> 
> 赞同：5
> 
> 时间：2013-02-13T02:11:34.630
> 
> 标签：scroll, watir

如何在 Watir 中滚动 Web 应用程序？

我努力了`@browser.send_keys :space`

这只会使整个页面下降。但是我在应用程序中有一个滚动条，我需要在我的自动化测试中向下和向上滚动垂直滚动条，请帮助我！

谢谢！

```
<div dojoattachpoint="containerNode" class="containerNode tabContentPane typeNavigationSingleChild" style="overflow: auto; left: 5px; top: 10px; width: 1549px; height: 535px;">
  <div pageid="lifecycle_theme_home_page_dashboard_pageId" id="lifecycle_theme_home_page_dashboard_pageId" style="height: 535px; padding: 0px; width: 1549px;" widgetid="lifecycle_theme_home_page_dashboard_pageId" title="" role="group" class="dijitContentPane wcs-nullLayout"> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-14T14:02:32.650

**解决方案 1) 滚动到最后一个元素**

我认为维奈的方法应该奏效。但是，在当前表单中，它假定该元素已经存在于页面上。我猜你想要的元素只有在你滚动得足够远时才可见。所以你可以做的是滚动到 div 中的最后一个元素。

**Watir-Webdriver**

在 Watir-Webdriver 中：

```
div_with_scroll = browser.div(:class => 'containerNode tabContentPane typeNavigationSingleChild')
div_with_scroll.elements.last.wd.location_once_scrolled_into_view 
```

**Watir-经典**

在 Watir-Classic 中，它是不同的，因为它不使用 selenium-webdriver：

```
div_with_scroll = browser.div(:class => 'containerNode tabContentPane typeNavigationSingleChild')
div_with_scroll.elements.last.document.scrollIntoView 
```

**解决方案 2) 使用 ScrollTop 属性**

作为替代方案，如果上述方法不起作用，您可以设置`scrollTop`属性以移动 div 元素的滚动条。这适用于我正在处理的应用程序，该应用程序的内容只有在您滚动到底部时才会加载。

**Watir-Webdriver**

要将滚动条跳到底部，理论上应该触发以下内容的加载，请将`scrollTop`属性设置为`scrollHeight`：

```
div_with_scroll = browser.div(:class => 'containerNode tabContentPane typeNavigationSingleChild')
scroll_bottom_script = 'arguments[0].scrollTop = arguments[0].scrollHeight'
div_with_scroll.browser.execute_script(scroll_bottom_script, div_with_scroll) 
```

要跳回顶部，请将 设置`scrollTop`为零。

```
div_with_scroll = browser.div(:class => 'containerNode tabContentPane typeNavigationSingleChild')
scroll_top_script = 'arguments[0].scrollTop = 0'
div_with_scroll.browser.execute_script(scroll_top_script, div_with_scroll) 
```

您还可以根据需要去的地方使用介于两者之间的任何值。

**Watir-经典**

在 Watir-Classic 中，您可以`scrollHeight`更直接地设置：

```
div_with_scroll = browser.div(:class => 'containerNode tabContentPane typeNavigationSingleChild')

#Go to bottom
div_with_scroll.document.scrollTop = div_with_scroll.document.scrollHeight

#Go to top
div_with_scroll.document.scrollTop = 0 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-13T12:56:19.330

如果元素位于页面底部，它将加载更多内容：

```
browser.element.wd.location_once_scrolled_into_view 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-09-19T08:21:24.037

使用正确的 javascript 执行程序来实现此结果 - 下面我编写了一些代码来向您展示“在我看来”最好和最可靠的方法来实现这一目标：

页面底部：

```
((IJavaScriptExecutor)webapplication).ExecuteScript("window.scrollTo(0, document.body.scrollHeight - 5)"); 
```

页面顶部：

```
((IJavaScriptExecutor)webapplication).ExecuteScript("window.scrollTo(0, document.body.scrollHeight 0)"); 
```

您还可以设置不同的值以滚动到不同的高度 - 例如，我已将滚动到底部代码设置为距页面底部 5px。祝你好运，希望这对你有点用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-15T14:50:33.277

使用 Javascript（例如页面底部）：

```
browser.execute_script("window.scrollTo(0, document.body.scrollHeight);\n") 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-14T20:33:41.790

使用 Watir-Classic，Justin Ko 提供的第二种方法非常适合遍历可滚动部分以查找特定内容。这是一个例子：

```
div_with_scroll = browser.div(:class => 'containerNode tabContentPane typeNavigationSingleChild')
scroll_value = 50 # change this number to match how much you want to scroll each iteration
max_loop = div_with_scroll.document.scrollHeight / scroll_value
if div_with_scroll.document.scrollHeight % scroll_value > 0 # accounts for any remainder height
    max_loop = max_loop + 1
end
for i in 0..max_loop do
    div_with_scroll.document.scrollTop = i * scroll_value # moves the scrollbar
    if div_with_scroll.text.include? 'Search Text'
        puts 'Search Text found in iteration: ' + i.to_s()
        break # exits the loop when found
    end
end 
```

可能有一种更有效的方法来做我在这里做的事情，但你明白了。

# string - 检索接近 Levenshtein 距离的字符串的数据结构

> ID：14845341
> 
> 赞同：9
> 
> 时间：2013-02-13T02:11:52.620
> 
> 标签：string, algorithm, data-structures, levenshtein-distance

例如，从一组英语单词开始，是否有一种结构/算法允许使用单词“right”作为查询快速检索“light”和“tight”等字符串？即，我想检索到查询字符串的 Levenshtein 距离较小的字符串。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-13T09:11:25.667

[BK-tree](http://blog.notdot.net/2007/4/Damn-Cool-Algorithms-Part-1-BK-Trees)数据结构在这里可能是合适的。它旨在有效地支持以下形式的查询“与查询词的编辑距离为 k 或更短的所有词是什么？” 它的性能保证相当不错，而且实施起来并不难。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T02:34:22.497

由于计算 Levenshtein 距离是`O(nm)`针对长度为 n 和 m 的字符串，因此计算所有 Levenshtein 距离`L(querystring, otherstring)`的简单方法非常昂贵。

但是，如果您将 Levenshtein 算法可视化，它基本上会用编辑距离填充一个 n*m 表。但是对于以相同的几个字母（前缀）开头的单词，Levenshtein 表的前几行将是相同的。（当然，修复查询字符串。）

这建议使用[trie（也称为前缀树）](http://en.wikipedia.org/wiki/Trie)：读取查询字符串，然后构建 Levenshtein 行的 trie。之后，您可以轻松地遍历它以找到靠近查询字符串的字符串。

（这*确实*意味着您必须为新的查询字符串构建一个新的 trie。我认为*所有对*距离都没有类似的有趣结构。）

我想我最近看到了一篇关于这个的文章，里面有一个很好的 python 实现。如果我能找到它会添加一个链接。*编辑：* [在这里，在史蒂夫·汉诺夫的博客上。](http://stevehanov.ca/blog/index.php?id=114)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-13T02:17:53.887

我认为最快的方法是预先构建相似性的缓存，您可以在 O(1) 时间内索引和访问。诀窍是找到常见的拼写错误以添加到您的缓存中，这可能会变得非常大。

我想谷歌会使用他们广泛的统计查询搜索数据做类似的事情。

# excel-2007 - Excel - 如何通过键入唯一发票# 列出 Col A 来查找所有相关行

> ID：14845343
> 
> 赞同：2
> 
> 时间：2013-02-13T02:12:28.020
> 
> 标签：excel-2007

我有一个包含 10 列的工作表，数据范围从 A1:J55 开始。Col A 有发票编号，其余列有其他人口统计数据。目标是在单元格上键入发票编号并显示与列 A 中的发票编号匹配的所有行。

除了自动过滤功能，我唯一想到的就是VBA。请建议获取数据的最佳方法是什么。提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T04:05:56.527

好吧，我为这个感到骄傲。再次避免 VBA，这个使用易失性公式 OFFSET 继续将其 VLOOKUP 搜索向下移动到表中，直到找到所有匹配项。只要确保您粘贴了足够多的公式行，如果有很多匹配项，它们就有足够的空间出现。如果您在比赛区域周围设置边框，那么您是否曾经用完空间并需要再次复制公式，这将是很清楚的。

同样，在主要部分，它只是一个公式（使用索引）：

```
=IFERROR(INDEX($A$1:$J$200,$M3,MATCH(N$2,$A$1:$J$1,0)),"") 
```

这变得如此简单，因为查找的艰苦工作是由一个初始列完成的，该列查找与发票编号匹配的下一行。它有以下公式：

```
=IFERROR(MATCH($L$2,OFFSET($A$1:$A$200,M2,0),0)+M2," ") 
```

这是与这些公式一起使用的工作示例：

![在此处输入图像描述](../Images/f0d25c86b7ccf5e8be122dc577493c87.png)

如果您需要进一步描述它的工作原理，请告诉我，但它主要使用与上述相同的规则，因此它在复制和移动时非常健壮。

我已经上传了 Excel 文件，因此您可以使用它，但是重现此功能所需的一切都应该在此解决方案中。

[Google Docs](https://docs.google.com/file/d/0BzfY1xYjsjYbYm1RNHNKVHNNbFE/edit?usp=sharing) - 点击链接并点击`Ctrl+S`下载并在 Excel 中打开。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T03:17:16.323

这个问题的一个流行的解决方案是一个简单的 VLookup。在表 A1:J55 上查找用户键入的发票，然后返回相邻列的数据。

这是它的工作示例：

![在此处输入图像描述](../Images/a292b0ae29a7a51f1317bccb62e4b9e4.png)

突出显示的单元格中的公式是：

```
=VLOOKUP($L3,$A:$J,MATCH(N$2,$1:$1,0),FALSE) 
```

这个公式的好处是你只需要输入一次，然后你可以复制它，它会自动选择表格的正确列（这是匹配部分）。剩下的很简单：

*   第一部分说查找值`$L3`（输入的发票编号），
*   第二部分说在范围内查找`$A:$J`（这是您的桌子所在的位置）。我已经展示了如何选择整个列`$A:$J`，以便您可以添加和删除数据，而无需担心调整查找范围。（Excel 负责优化公式，以便不检查未使用的单元格）
*   第三部分选择找到匹配行后将从中提取结果数据的列。
*   该`FALSE`部分表示发票编号必须*完全*匹配（不允许近似匹配）
*   这些`$`符号确保固定范围（如源表的位置 ( `$A:$J`) 和查找值 ($L3)）不会在您将公式复制到多个列时自动更改。

如果你想在你的桌子和你进行查找的区域周围移动，这个公式很容易适应。这是一个例子：

![在此处输入图像描述](../Images/3e347cde3604376d975e72afad5b0633.png)

**奖金**

如果您想添加一些小细节，您可以在 Invoice # 字段中添加一个下拉列表，以便用户获得自动完成功能以及浏览现有值的选项，如下所示：

![在此处输入图像描述](../Images/a9a18aaafe1e7f6eccbb60839f586cf4.png)

# postgresql - psql：致命：角色“postgres”不存在（使用 -h localhost 选项）

> ID：14845348
> 
> 赞同：5
> 
> 时间：2013-02-13T02:13:22.460
> 
> 标签：postgresql, database-connection

我在本地机器上安装了 Postgres。

当我执行

```
psql -U postgres -d buzzsumo 
```

它正确地向用户 postgres 询问我的密码。

但是，当我跑步时

```
psql -U postgres -d buzzsumo -h localhost 
```

它给了我这个错误信息：

> psql：致命：角色“postgres”不存在

为什么会出现这种情况，在第一个示例中我连接到本地服务器时，相当于传入 localhost？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T02:42:32.777

你没有说，但我猜你在 MacOS 或 Linux 上运行 postgres。

第一种形式（没有 -h）通过“unix 套接字”连接。第二种形式，使用“-h localhost”通过 TCP/IP 连接到 localhost（IP 地址 127.0.0.1）。

Postgres 以不同的方式处理这两种类型的连接——或者至少，它可以这样做。如果您检查“pgsql/data/pg_hba.conf”文件以查看为这两种类型的连接配置了哪些身份验证机制。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-13T02:41:40.807

您的第一个示例通过 Unix 套接字连接，第二个示例通过 TCP/IP 本地循环 (localhost) 连接。

对于第一个示例，您需要 in 中的连接类型`local`，[`pg_hba.conf`](http://www.postgresql.org/docs/current/interactive/auth-pg-hba-conf.html)因为以开头的第二行`host`是相关的。您可能已经为这些连接类定义了不同的[身份验证方法。](http://www.postgresql.org/docs/current/interactive/auth-methods.html)

# gwt - GWT @UiFactory 和参数化返回类型

> ID：14845349
> 
> 赞同：1
> 
> 时间：2013-02-13T02:13:24.690
> 
> 标签：gwt, generics

我有以下情况。我的 UI 表单上有两个组合，一个显示蔬菜列表，另一个显示水果列表。

在我的支持视图类中，我想声明这样的方法：

```
@UiFactory
SimpleComboBox<Vegetable> createVegetablesCombo() {
    return vegetables;
}

@UiFactory
SimpleComboBox<Fruit> createFruitsCombo() {
    return fruits;
} 
```

但似乎 GWT 无法识别参数化的返回类型......每次我得到一个错误：

```
ERROR: Duplicate factory in class VegetablesAndFruitsView  for type SimpleComboBox. 
```

有可能处理这种情况吗？一个 UI 表单上有多个组合框的好例子吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T02:32:19.470

从运行时的 Java（不是 GWT，不是 UiBinder，而是 Java 语言本身）的角度来看，`SimpleComboBox<Vegetable>`和`SimpleComboBox<Fruit>`. 也就是说，这个错误来自 UiBinder 的代码生成，它正在寻找所有`@UiConstructor`方法，并使用它们来构建东西。

那么 UiBinder 必须使用什么？在 UiBinder XML 中，没有泛型。UiBinder 能够做到这一点的唯一方法是，如果你碰巧`@UiField`在你的类中包含了一个具有适当泛型的条目。这将需要`@UiField`任何时候可能存在这样的歧义的注释，这是 GWT 目前不做的事情。

你想在这方面达到什么目的？您正在返回一个字段（`vegetables`或`fruits`） - 为什么该字段不被标记为`@UiField(provided=true)`？然后，您可以从 UiBinder 中使用您为分配这些字段所做的任何接线，而根本不需要这些`@UiConstructor`方法。

```
@UiField(provided=true)
SimpleComboBox<Fruit> fruits;

//...

public MyWidget() {
  fruits = new SimpleComboBox<Fruit>(...);

  binder.createAndBind(this);
} 
```

...

```
<form:SimpleComboBox ui:field="fruits" /> 
```

* * *

如果这只是过度简化，并且您实际上计划在这些方法中创建新对象，那么请考虑传入一个参数，例如`String type`，并根据值返回一个不同`SimpleComboBox<?>`的值。从您的 UiBinder xml 中，您可以像这样创建正确的东西：

```
<field:SimpleComboBox type="fruit" /> 
```

# python - 多个 x 轴，彼此非线性

> ID：14845350
> 
> 赞同：5
> 
> 时间：2013-02-13T02:13:27.497
> 
> 标签：python, matplotlib

我正在尝试使用 matplotlib 绘制一个具有两个相互非线性的 x 轴的图形。我想得到的情节是这样的：

![阴谋](../Images/425ab87e093e7a5e0caf9cecab95fc7d.png)

基本上，年龄取决于红移。它是非线性的，需要计算。我想将年龄和红移都作为 x 轴。我怎样才能做到？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-13T03:28:31.747

该功能`twiny()`可能是您正在寻找的。

```
import matplotlib.pyplot as plt
plt.loglog(range(100))
ax1 = plt.gca()
ax2 = ax1.twiny()
ax2.set_xticks([100,80,50])
ax2.set_xticklabels(['0','1','2'])
ax1.set_xlabel('redshift')
ax2.set_xlabel('age')
plt.show() 
```

[![twiny() 函数的示例图](../Images/00c8a75561707a6db04af2a7e9199b7f.png)](https://i.stack.imgur.com/fLW60.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-24T11:50:46.473

我这样做是这样的：

```
from mpl_toolkits.axes_grid.parasite_axes import SubplotHost 
fig = plt.figure(1, figsize=(figwidth,figheight))
ax = SubplotHost(fig, 1,1,1) 
fig.add_subplot(ax)

#plotting as usual

ax2 = ax.twin() # ax2 is responsible for "top" axis and "right" axis
ax2.axis["right"].toggle(ticklabels=False)
ax2.xaxis.set_major_formatter(FuncFormatter(fmt_zToEta)) #set eta coord format

#with a function for the Z to eta transform for plot labels
def fmt_zToEta(x, pos=None):
    #...
    return transformed_label 
```

我还记得从那个红移示例开始；-)

我认为这`SubPlotHost`件事是必要的，但我不是 100% 确定，因为我从我现有的（子）情节中撕掉了它，而没有检查它是否运行良好。

编辑：另见[https://stackoverflow.com/a/10517481/599884](https://stackoverflow.com/a/10517481/599884)

# python - 从带有多个参数的python脚本运行windows可执行文件

> ID：14845352
> 
> 赞同：0
> 
> 时间：2013-02-13T02:13:41.783
> 
> 标签：python, windows, python-3.x

我正在开发一个程序，该程序将找到一些文件并将文件信息提供给 NSIS 脚本。NSIS脚本接受命令行如下

```
makensis.exe /DON="This is one" /DOD="c:\path1\path2 to dir\path 3" scriptfile.nsi 
```

每次执行程序时，开关的值都会改变。我尝试使用 subprocess.call 和 subprocess.Popen 来执行此操作。我遇到的问题与引用有关。

首先，子进程调用似乎将整个参数语句放在双引号之间，使 NSIS 将它们视为一个参数。其次，我很难在命令行上正确引用各个开关。这是我的程序目前的样子的片段。

```
subprocess.Popen([setup.profile['NSISExe'], ' /DON="' + setup.profile['DESC'] + '" /DOD="' + setup.profile['InstallDir'] + \
   '" /DMT="' + app.machine_type.get() + '" /DSD="' + os.path.join(WinShellVar.LOCAL_APPDATA, 'MLC CAD', appname) + \
   '" /DXV=X6 ' + setup.profile['NSISScript']]) 
```

这是 NSIS 的输出

```
 Can't open script " /DON="Mastercam X6 Standard" /DOD="C:\Users\John\Desktop" /D
MT="mill" /DSD="C:\Users\John\AppData\Local\MLC CAD\mcdeftool" /DXV=X6 bin\packa
ge.002.nsi" 
```

正如你所看到的，我正在使用混合数据包，获取一些用于 dicts 和一些来自课堂调用的位*（如果我的术语有些不正确，请放心，我已经学习 python 大约 4 天了，请纠正我很好）。* 如果像这样使用这些数据是“unpythonic”，请告诉我。

期待您的意见

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T02:19:50.910

*免责声明——我不使用 Windows*

* * *

我想你可能想要这样的东西：

```
subprocess.Popen([setup.profile['NSISExe'], '/DON=' + setup.profile['DESC'],
                  '/DOD=' + setup.profile['InstallDir'],
                  '/DMT=' + app.machine_type.get(),
                  '/DSD=' + os.path.join(WinShellVar.LOCAL_APPDATA, 'MLC CAD', appname), 
                  '/DXV=X6',
                  setup.profile['NSISScript']]) 
```

当 shell 读取命令行时，它会拆分为非引号、非转义的空格。当您将列表传递给 时`Popen`，它期望列表元素是外壳拆分参数后的样子。另一种选择是传递一个字符串（而不是一个列表）*，就像*你将它放入 windows shell 并传递`shell=True`给`Popen`. 但这种方法不是首选，因为它更容易受到壳注入不安全的影响。

# java - 如何使用preparedstatement获取最后插入行的id？

> ID：14845354
> 
> 赞同：2
> 
> 时间：2013-02-13T02:14:07.780
> 
> 标签：java, mysql, database, postgresql, jdbc

我正在使用以下代码向数据库插入新行，我需要获取最后插入行的 id，但是当我运行代码时，它显示以下消息：

```
SEVERE: java.sql.SQLException: Generated keys not requested. You need to specify   
Statement.RETURN_GENERATED_KEYS to Statement.executeUpdate() or 
Connection.prepareStatement(). 
```

当我使用以下代码时，尽管我选择了 executeUpdate(String sql)，但它也会给出错误

```
 ps.executeUpdate(ps.RETURN_GENERATED_KEYS);
  error >> no suitable method found for executeUpdate(int) 
```

表格如下：

```
 credential 
          int         ID   primary key, auto increment
          varchar(10) name 
```

我的代码

```
String Insert_Credential = "Insert into credential values("
                    + "?,?)";
            ps = con.prepareStatement(Insert_Credential);
            ps.setInt(1, 0);
            ps.setString(2, "username");
            ps.executeUpdate();
            ResultSet generatedKeys = ps.getGeneratedKeys();
        if (generatedKeys.next()) {
             System.out.println("id is"+generatedKeys.getLong(1));
             return generatedKeys.getInt(1);
        } else {
            throw new SQLException("Creating user failed, no generated key obtained.");
        } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-13T02:21:35.883

```
ps.executeUpdate(ps.RETURN_GENERATED_KEYS) 
```

你发明了那个。它不存在。

```
ps = con.prepareStatement(Insert_Credential); 
```

这也没有告诉`PreparedStatement`返回生成的密钥。你需要这个：

```
ps = con.prepareStatement(Insert_Credential, Statement.RETURN_GENERATED_KEYS); 
```

# c - C char 数组和指针 - 合并排序的合并

> ID：14845355
> 
> 赞同：-1
> 
> 时间：2013-02-13T02:14:21.613
> 
> 标签：c, pointers, merge, segmentation-fault, pipe

我试图通过从管道中读取字符然后将它们放入结果字符串来实现合并。我不断收到分段错误，并且无法调试问题的根源。当我删除对该函数的调用时，问题就消失了，所以我觉得这里有些不正确：

MAX_LENGTH 设置为 1024，我只对大约 30 个字符进行排序，所以我相信我应该有多余的空间。

```
int merge(char *result, int *leftpipefd, int *rightpipefd) {
char left[MAX_LENGTH/2];
char right[MAX_LENGTH/2];
int leftpos = 0;
int rightpos = 0;
int resultpos = 0;

read(leftpipefd[READ_END], left, MAX_LENGTH/2);
read(rightpipefd[READ_END], right, MAX_LENGTH/2);

int leftlen = strlen(left);
int rightlen = strlen(right);

while (leftpos < leftlen || rightpos < rightlen) {
    if (leftpos < leftlen && rightpos < rightlen) {
        if (left[leftpos] <= right[rightpos]) {
            result[resultpos] = left[leftpos];
            resultpos++;
            leftpos++;
        } else {
            result[resultpos] = right[rightpos];
            resultpos++;
            rightpos++;
        }
    } else if (leftpos <  leftlen) {
        result[resultpos] = right[rightpos];
        resultpos++;
        rightpos++;
    } else if (rightpos <  rightlen) {
        result[resultpos] = left[leftpos];
        resultpos++;
        leftpos++;
    }
}

return EXIT_SUCCESS;
} 
```

谁能看到我做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T02:22:28.770

如果您将 N 个字符读入长度为 N 的缓冲区，您如何期望该`strlen`函数正常工作……它至少需要一个缓冲区，`N+1`因为必须有空间容纳终止`\0`字符。当那不存在时，谁知道接下来会发生什么……

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T02:22:53.250

几件事...

来自[http://linux.die.net/man/2/read](http://linux.die.net/man/2/read) ...

> read() 尝试将文件描述符 fd 中的 count 个字节读入缓冲区，从 buf 开始。如果 count 为零，则 read() 返回零并且没有其他结果。如果 count 大于 SSIZE_MAX，则未指定结果。

MAX_LEN 是什么？是否大于 SSIZE_MAX？如果是这样，您有未定义的行为。

如果 read()s 没有输入，您将不会读取任何内容......并且您尚未初始化的缓冲区将不会更改。您应该初始化缓冲区。

从同一页...

> 出错时，返回 -1，并适当设置 errno。

如果读取失败，您的缓冲区仍未定义/未初始化，但您不会检测/处理这种情况。您需要在 read() 之后立即使用一些错误处理代码。

此外，在同一个手册页上，没有迹象表明您的 read() 缓冲区是空终止的。正如 Floris 指出的那样，这意味着您的 strlen()s 可能会在分配的缓冲区结束后继续读取。

> 而 (leftpos < leftlen || rightpos < rightlen) {

此行可能有误。如果 leftpos >= leftlen 但 rightpos < rightpos 你将进入 while 块的主体。您可能会以这种方式开始访问无效内存。你真的需要`&&`吗？

# python - 为python安装adwords api

> ID：14845356
> 
> 赞同：1
> 
> 时间：2013-02-13T02:14:24.940
> 
> 标签：python, google-api-python-client

我正在尝试在命令提示符中的 python 中安装一个库（Google adwords api）。但是当我问：

```
setup.py install 
```

提示在记事本中打开文件 steup.py 并且不安装该文件。我究竟做错了什么？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T03:11:31.197

我通过将 Python 的**安装路径**添加到环境变量中来解决它。

# haskell - Haskell - 基本尾递归

> ID：14845357
> 
> 赞同：0
> 
> 时间：2013-02-13T02:14:26.560
> 
> 标签：haskell, recursion, tail-recursion

我有一个有参数的函数

```
whatIndex ::  (Eq a) => a -> [a] -> Integer 
```

我返回内部 [a] 的索引，从 0 开始，如果未找到则返回 -1。这是我写的

```
module WhatIndex where

whatIndex ::  (Eq a) => a -> [a] -> Integer

whatIndex p [] = -1

whatIndex p (a:as) 
    | p==a = index
    | otherwise = whatIndex p as
    where index = 1+whatIndex p as 
```

显然，我在这里没有正确增加索引。知道为什么这不起作用吗？另外，我无法更改参数。

=========================

这是一些基本的输入/输出

```
whatIndex 3 [] = -1
whatIndex 2 [1,2,3,2,1]=1
whatIndex 1 [1,2,3,2,1]=0
whatIndex 'b' ['a' .. 'z']=1 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-13T02:25:34.400

`1+whatIndex p as`将遍历所有剩余的列表并计算它们，它不会给你索引。只需使用这样的迭代递归辅助函数......

您可以使用本地函数或提升版本，这就是我在这里所拥有的。

```
whatIndex' ::  (Eq a) => Integer -> a -> [a] -> Integer

whatIndex' _ _ [] = -1

whatIndex' i p (x:xs) 
    | p == x = i
    | otherwise = whatIndex' (i+1) p xs

whatIndex p xs = whatIndex' 0 p xs

main = print $ whatIndex 'a' "bbbbaccc" 
```

这是一个非尾递归版本：

```
whatIndex p (x:xs)
    | p == x = 0
    | otherwise = 1 + whatIndex p xs 
```

尾递归是指一类递归函数，其中递归函数中的“最后”或“最终”函数调用是针对函数本身的。所以这意味着该函数没有`+`在“尾部位置”（发生函数调用的最后一个位置）调用其他函数（如 ）。您可以清楚地看到，在第一个版本中调用的最终函数`whatIndex`是`whatIndex`，而在第二个版本中调用的最终函数（将调用`whatIndex`作为参数）是`+`。

[http://en.wikipedia.org/wiki/Tail_call](http://en.wikipedia.org/wiki/Tail_call)

编辑：这是一个更符合您的规范的版本，尽管它有点复杂且效率低下。

```
whatIndex p xs 
    | not (any (==p) xs) = -1
    | otherwise = whatIndex' p xs where
        whatIndex' p (x:xs)
            | p == x = 0
            | otherwise = 1 + whatIndex' p xs 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-13T02:25:17.823

如果您想要尾递归，请尝试使用累加器参数：

```
whatIndex :: (Eq a) => a -> [a] -> Integer
whatIndex =
  let whatIndex' count p [] = -1
      whatIndex' count p (a:as)
        | p==a = count
        | otherwise = whatIndex' (count + 1) p as
  in whatIndex' 0 
```

# c# - 对多个实体类型使用 LINQ to Entities 扩展方法

> ID：14845363
> 
> 赞同：1
> 
> 时间：2013-02-13T02:15:20.363
> 
> 标签：c#, .net, linq, entity-framework, extension-methods

我有以下扩展方法：

```
public static IQueryable<Employee> WhereStatus(this IQueryable<Employee> queryable, string status)
{
    var result = queryable
        .Where(e => e.EmployeeStatus.Where(s => s.StatusEndDate == null).Select(s => s.Status)
        .FirstOrDefault() == status);

    return result;
}

public static IQueryable<Employee> WhereCostCenter(this IQueryable<Employee> queryable, int costCenterID)
{
    var result = queryable
        .Where(e => e.CostCenterID ==  costCenterID);
    return result;
} 
```

我几乎在每一个 LINQ 查询中都需要这些扩展方法，以根据几个参数（例如：状态、成本中心、性别......等）过滤对某些员工的查询。现在我像这样使用它：

```
using (DB db = new DB())
{
      var emps = from em in db.Employees
                 .WhereStatus("Active")
                 .WhereCostCenter(112)
                 select em.EmpID;

      var courses = from cr in db.Courses
                    where c.Contains(cr.EmpID)
                    select cr;

      // now I have the filtered list of the courses I want
      .....
} 
```

**问题：**这是最佳实践吗？或者有没有办法让扩展方法适用于我拥有的所有实体类型，因为所有实体都有一个 EmpID？就像是：

```
var courses = from em in db.Courses
              .WhereStatus("Active")    // use the extension methods directly here as well
              .WhereCostCenter(112)
              select cr; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T02:26:13.543

问题是并非所有实体都具有使用所有扩展方法所需的属性。您可以做的是创建属性的子集，并将它们放入接口中。

例子：

```
public interface IHaveCostCenterID
{
    public int CostCenterID {get; set;}
}

public partial class Employee : IHaveCostCenterID
{
}

public partial class Department : IHaveCostCenterID
{
}

public static IQueryable<IHaveCostCenterID> WhereCostCenter(this IQueryable<IHaveCostCenterID> queryable, int costCenterID)
{
    var result = queryable
        .Where(e => e.CostCenterID ==  costCenterID);
    return result;
} 
```

* * *

其他方式：

```
public static class Extension
{
    public static IQueryable<TEntity> WhereCostCenter<TEntity>(
        this IQueryable<TEntity> queryable, int costCenterID)
        where TEntity : IHaveCostCenterID
    {
        var result =
            queryable.Where(e => e.CostCenterID == costCenterID);
        return result;
    }
}

public interface IHaveCostCenterID
{
    int CostCenterID { get; set; }
}

public partial class Employee : IHaveCostCenterID
{
    public int CostCenterID { get; set; }
}

public partial class Department : IHaveCostCenterID
{
    public int CostCenterID { get; set; }
} 
```

* * *

这可以是使用通用方法提取公共代码的解决方案，而不仅仅是针对 LINQ。只要您有两段（或更多）相同的代码，但它们碰巧使用不同的类，您就可以这样做。将公共部分提取到接口中，并让泛型方法使用接口约束。

# mvvm - 为什么在 ViewModelLocator 中将 MEF 用于设计时/运行时？

> ID：14845367
> 
> 赞同：3
> 
> 时间：2013-02-13T02:15:49.980
> 
> 标签：mvvm, runtime, inversion-of-control, mef, design-time

我读过很多文章，其中在 ViewModelLocator 中使用 MEF 来分离设计时数据和运行时数据（具体来说，导入 designtiem ViewModels 和运行时 ViewModels）。（我说的是MVVM-light框架中的VMLocator）

MEF 是一项出色的技术，但它不是为未知依赖而设计的吗？显然，设计时/运行时 ViewModel 是已知的依赖关系，应该由纯 IOC 容器处理。

有人可以解释一下吗？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T16:40:59.470

是的，MEF 主要是为未知的依赖关系设计的，但它肯定也可以用于已知的依赖关系。几个月前，我自己在 MEF 之上构建了一个有效的服务定位器。

我看到了在这里使用 MEF 有意义的几个原因：

*   从 .NET 4.0 开始，它是框架的一个组成部分。不需要有另一个第三方依赖。

*   它涵盖了依赖发现和 IoC。不管 API 是否看起来是为发现量身定做的，您仍然可以获得这两个功能。根据我的经验，依赖发现是对 IoC 容器的一个很好的补充。

*   它具有很好的可扩展性选项，通常仅用于这些目的，例如[为视图模型定位器构建您自己的零件目录，以便能够提供设计时模型](http://janhannemann.wordpress.com/2010/12/13/simple-viewmodellocator-with-mef/)。

我认为人们选择 MEF 的原因是它在一个包中提供了这些 MVVM 模式和场景所需的一切，并且随时可用。并不是说它一定是该领域中最好的。

这几乎不是您正在寻找的答案，但我以类似的方式使用了 MEF，所以我添加了一个意见:)

# wcf - 如何在具有 WCF 服务参考的客户端中使用 IssuedToken

> ID：14845371
> 
> 赞同：4
> 
> 时间：2013-02-13T02:16:43.373
> 
> 标签：wcf, webservice-client, service-reference, federation, thinktecture-ident-model

我有一个 WinForms 应用程序，其中包含从使用 WS2007FederationHttpBinding 的 WCF 服务生成的服务参考。我不明白为什么以下不起作用。

我的 WinForms 应用程序正在调用使用 Thinktecture.IdentityServer 的 WCF 服务，该服务设置为处理 BearerKey 类型令牌。

从我的客户那里，我只需获取一个有效的访问令牌，然后进行以下调用：

```
 private static void CallServiceReference(SecurityToken token)
    {
        ServiceReference1.ClaimsServiceContractClient svcRef = new ServiceReference1.ClaimsServiceContractClient();

        svcRef.ChannelFactory.Credentials.SupportInteractive = false;
        svcRef.ChannelFactory.CreateChannelWithIssuedToken(token);
        var claims = svcRef.GetClaims(); 
    } 
```

以下是服务参考的 winforms 客户端 app.config：

```
<system.serviceModel>
      <bindings>
              <ws2007FederationHttpBinding>
                      <binding name="WS2007FederationHttpBinding_ClaimsServiceContract">
                              <security mode="TransportWithMessageCredential">
                                      <message establishSecurityContext="false" issuedKeyType="BearerKey">
                                              <issuer address="https://identity.MyCo.com/issue/wsfed" binding="ws2007HttpBinding"
                                                      bindingConfiguration="https://identity.MyCo.com/issue/wstrust/mixed/username" />
                                              <issuerMetadata address="https://identity.MyCo.com/issue/wstrust/mex" />
                                              <tokenRequestParameters>
                                                      <trust:SecondaryParameters xmlns:trust="http://docs.oasis-open.org/ws-sx/ws-trust/200512">
                                                              <trust:KeyType xmlns:trust="http://docs.oasis-open.org/ws-sx/ws-trust/200512">http://docs.oasis-open.org/ws-sx/ws-trust/200512/Bearer</trust:KeyType>
                                                              <trust:CanonicalizationAlgorithm xmlns:trust="http://docs.oasis-open.org/ws-sx/ws-trust/200512">http://www.w3.org/2001/10/xml-exc-c14n#</trust:CanonicalizationAlgorithm>
                                                              <trust:EncryptionAlgorithm xmlns:trust="http://docs.oasis-open.org/ws-sx/ws-trust/200512">http://www.w3.org/2001/04/xmlenc#aes256-cbc</trust:EncryptionAlgorithm>
                                                      </trust:SecondaryParameters>
                                              </tokenRequestParameters>
                                      </message>
                              </security>
                      </binding>
              </ws2007FederationHttpBinding>
              <ws2007HttpBinding>
                      <binding name="https://identity.MyCo.com/issue/wstrust/mixed/username">
                              <security mode="TransportWithMessageCredential">
                                      <transport clientCredentialType="None" />
                                      <message clientCredentialType="IssuedToken" establishSecurityContext="false" />
                              </security>
                      </binding>
              </ws2007HttpBinding>
      </bindings>
      <client>
              <endpoint address="https://roadie/WebTest/service.svc" binding="ws2007FederationHttpBinding"
                      bindingConfiguration="WS2007FederationHttpBinding_ClaimsServiceContract"
                      contract="ServiceReference1.ClaimsServiceContract" name="WS2007FederationHttpBinding_ClaimsServiceContract" />
      </client>
  </system.serviceModel> 
```

当我尝试执行服务调用 (svcRef.GetClaims()) 时，我收到此错误：

> [“未指定安全令牌颁发者的地址。必须在目标' https://identity.MyCo.com/issue/wsfed](https://identity.MyCo.com/issue/wsfed) '的绑定中指定明确的颁发者地址，或者必须在凭据中配置本地颁发者地址。”

这个错误很蹩脚，而且令人困惑，似乎在配置中指定了一个发行者！

最后，我知道 WCF 服务和身份服务是有效的，因为这一切都可以使用自定义 ChannelFactory 正常工作，也使用完全相同的方法来应用令牌：

`var channel = factory.CreateChannelWithIssuedToken(token);`

但我的要求是使用生成的ServiceReference。:(

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-03-26T09:17:11.923

您应该像这样使用创建的频道：

```
private static void CallServiceReference(SecurityToken token)
{
    ServiceReference1.ClaimsServiceContractClient svcRef = 
        new ServiceReference1.ClaimsServiceContractClient();

    svcRef.ChannelFactory.Credentials.SupportInteractive = false;
    var svcChannel = svcRef.ChannelFactory.CreateChannelWithIssuedToken(token);
    var claims = svcChannel.GetClaims();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T21:43:19.683

我认为您可以使用从服务参考生成的代理的唯一方法是，如果您将客户端配置为自动请求令牌并在进行服务调用之前在您创建的代理实例上设置适当的 ClientCredentials 属性。

我们正在使用一个已发布的令牌，我们在我从事的项目中缓存在客户端上，但随后我们必须使用通道工厂 CreateChannelWithIssuedToken，就像您描述的那样。

顺便说一句，这是在 .NET 4.0 中使用 WIF 时。如果在 .NET 4.5 上运行，也许还有其他选择。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-08-05T03:27:06.117

有时您没有引用的客户端存根 DLL，那么您可以使用反射来动态加载和调用它。这是使用已颁发令牌创建客户端的反射版本：

```
//Our goal is to get a client obj from reflection
//var obj = client.ChannelFactory.CreateChannelWithIssuedToken(token);

double value1 = 2;
double value2 = 3;
//this line needs to be changed to be created from reflection if needed
CalculatorClient cc = new CalculatorClient("WS2007FederationHttpBinding_ICalculator"); var pi = cc.GetType().GetProperty("ChannelFactory"); //proprety 
var factoryObj = pi.GetValue(cc);
var mi = factoryObj.GetType().GetMethod("CreateChannelWithIssuedToken", new Type[] { typeof(SecurityToken)}); //method info
var clientObj = mi.Invoke(factoryObj, new object[] { token });
mi = clientObj.GetType().GetMethod("Add"); //another method info
var result = mi.Invoke(clientObj, new Object[] { 2, 3 });
Console.WriteLine("Add({0},{1}) = {2}", value1, value2, Convert.ToDouble(result)); 
```

# javascript - 如何创建降价编辑器

> ID：14845377
> 
> 赞同：5
> 
> 时间：2013-02-13T02:17:37.127
> 
> 标签：javascript, jquery, html, markdown

我正在为 Web 应用程序创建我的降价编辑器。一个更好的类比可能是 Stack Overflow/ [RedNotebook](http://rednotebook.sourceforge.net/)，当我们在文本框中输入内容时，立即格式化的输出显示在它旁边。

这种模型是否有任何示例实现？或者我应该从头开始编码，从创建文本框等开始？

有任何开源 API 吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-15T02:13:10.787

[Pagedown](http://pagedown.googlecode.com/hg/demo/browser/demo.html)是一个更好的答案。

这就是 Stack Exchange 的编辑器[运行](https://meta.stackexchange.com/questions/10369/which-tools-and-technologies-are-used-to-build-the-stack-exchange-network)的东西。

![在此处输入图像描述](../Images/f2c17d408dcd32f5eb427074c0eaadd9.png)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-14T00:34:11.690

我有一个完美的解决方案给你，我刚刚写了这个。

下载[PHP Markdown Extra](http://michelf.ca/projects/php-markdown/)，并放入与此脚本相同的目录：

```
<?php

include_once("markdown.php");

if(isset($_GET['mode']) && $_GET['mode'] == 'ajax')
    die(Markdown($_POST['markdown']));

?><html>
    <head>
        <style>
             span     { text-align: left; width: 49% }
             textarea { height: 100%; width: 100% }
            #left     { float: left; }
            #right    { float: right; }
        </style>
        <script type='text/javascript'>
            function ajax()
            {
                if(window.XMLHttpRequest)
                    var request = new XMLHttpRequest();
                else if(window.ActiveXObject)
                    var request = ActiveXObject("Microsoft.XMLHTTP");

                request.open("POST", "?mode=ajax", true);
                request.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
                request.send('markdown=' + document.getElementById('markdown').value);

                request.onreadystatechange = function()
                {
                    if(request.readyState == 4 && request.status == 200)
                        document.getElementById('right').innerHTML = request.responseText;
                }
            }

            window.onload = function(){ ajax(); }
        </script>
    </head>
    <body>
        <div>
            <span id='left'>
                <textarea id='markdown' onkeyup='ajax();'></textarea>
            </span>
            <span id='right'>
                Loading...
            </span>
        </div>
    </body>
</html> 
```

![db-ajax](../Images/5cc6bdad1787738071436d878dbf36a3.png)

当然这只是一个简单的概念。它需要一些改进，但我认为这是您正在寻找的基础。

# hibernate - 正常的 Spring + Hibernate Transaction 行为？

> ID：14845381
> 
> 赞同：0
> 
> 时间：2013-02-13T02:17:46.887
> 
> 标签：hibernate, transactions, aop, spring-transactions

我已经将我的 Spring + Hibernate 项目配置为使用 Spring AOP 进行事务处理。

当我检查 DAO 方法时，`TransactionSynchronizationManager.isActualTransactionActive()`它说是真的。

我从我的服务类中调用了两个 DAO 方法，在第二个 DAO 方法中，我`'devide by zero'`故意抛出一个错误并查看这两个方法是否回滚。

目前第一个似乎插入一条新记录就好了。第一种方法不应该
回滚吗？

**更新** 您可以参考我之前的问题，但我认为这可能太长了。
[Spring 3.x 和 Hibernate 4 中的事务管理](https://stackoverflow.com/questions/14828579/transaction-management-in-spring-3-x-and-hibernate-4)

总结这个问题（尽我所能），
我有一个服务类方法，它从 DAO 类中调用两个方法。
该服务类是从 spring mvc 控制器及其委托者调用的。

我的 aop:config 如下

```
<aop:config proxy-target-class="true">
  <aop:pointcut id="transactionalServiceOperation" expression="execution(* kr.co.sgis.services.web.cooingbee.Crudable.*(..))"/>
  <aop:advisor advice-ref="txAdvice" pointcut-ref="transactionalServiceOperation"/>
</aop:config> 
```

我的界面 Crudable 看起来像这样

```
public interface Crudable {

    public int delete(CooingbeeFetchable bean);
    public int save(CooingbeeFetchable bean);
    public int update(CooingbeeFetchable bean);
    public Set<CooingbeeFetchable> list(CooingbeeFetchable bean);
    public CooingbeeFetchable get(int id);
    public int count(CooingbeeFetchable bean);
    public int save2(CooingbeeFetchable bean);
} 
```

*DAO 和 Service 类都*实现了 Cruadable 接口。现在我想也许这就是它没有按我预期工作的原因？
希望我给了你足够的信息而不会太长:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T05:01:16.077

如果这两种方法都是事务性的，那么第二个方法的失败自然不会影响第一个方法。如果您认为这两种方法都是单个（正确）事务的一部分，那么您对此或它似乎部分提交的事实是错误的。您需要提供更多信息才能很好地回答为什么其中一个或另一个是正确的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T06:57:16.577

我终于想通了。
读这个。
[http://static.springsource.org/spring/docs/3.0.x/spring-framework-reference/html/transaction.html#transaction-declarative-rolling-back](http://static.springsource.org/spring/docs/3.0.x/spring-framework-reference/html/transaction.html#transaction-declarative-rolling-back)

该文档说您需要为 Spring 抛出异常以知道 DAO 方法有问题，以便它可以回滚。以前我的 DAO 方法没有抛出任何异常，而是通过在 try-catch 块中包围方法体来自行处理异常。

此外，您需要像这样配置您的 aop:config 标签。

```
<aop:config proxy-target-class="true">
  <aop:pointcut id="transactionalServiceOperation" expression="execution(* kr.co.sgis.services.web.cooingbee.Crudable.*(..))"/>
  <aop:advisor advice-ref="txAdvice" pointcut-ref="transactionalServiceOperation"/>
</aop:config> 
```

我希望这有帮助 ！: )
欢呼

# java - java : 为多个操作同步 ArrayList

> ID：14845392
> 
> 赞同：0
> 
> 时间：2013-02-13T02:19:19.163
> 
> 标签：java, arraylist, synchronization

我已经读过对 Collection 实例的访问不应该在一个类中同步。原因似乎是另一个对象可能会操纵列表，而不与第一个对象同步。但是，我要同步的 List 是一个私有字段，由所有者对象创建，并且没有访问器方法。

我正在使用两个内部类，一个生产者和一个消费者，每个都实现类 Runnable 并在单独的线程中运行。每当他们访问属于父类的列表时，他们都会在父类上同步。

此外，我的实现仅使用父类的单个实例，以及每个内部类。

那么，简单地使用同步块来控制访问是否可以接受？或者这仍然是一个禁忌？

我不认为我可以使用同步列表。原因是消费者线程批量消费：它首先使用 Collections.Sort 和一个比较器进行排序，然后使用 subList 方法获取列表中前 20 个（默认情况下）对象的列表（它实际上创建了一个新列表，通过将 subList 调用传递给 ArrayList 构造函数），然后将 subList 返回的列表传递给原始列表的 removeAll：

```
Collections.sort(pool, examComparator);

List<Candidate> squad = new ArrayList<Candidate>(pool.subList(0, squadSize));
pool.removeAll(squad);

return squad; 
```

由于这是一个多步骤操作，并且需要是原子的，我看不出 synchronisedList 将如何促进它，它（据我了解）只是为单个方法调用提供同步，例如 add() 和 get( ）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T02:29:43.700

该[`java.util.concurrent`软件包](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/package-summary.html)包含您避免编写自己的代码和重新发明轮子所需的一切。

将 a[`CopyOnWriteArrayList`](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/CopyOnWriteArrayList.html)用于您的列表实施，它的工作就完成了。

编写线程安全的实现绝对不是微不足道的，并且这些类已被编写为安全且尽可能高效。

### 编辑：

如果您有生产者消费者模型，请使用 BlockingQueue。

# python - 将文件压缩到python中的指定路径

> ID：14845394
> 
> 赞同：3
> 
> 时间：2013-02-13T02:19:30.037
> 
> 标签：python, python-2.7

几周以来我一直在学习python。在其中一个问题中，我必须将列表中包含的文件压缩到指定路径。我在**Windows**中使用 python 。

python zipall.py C:\temp C:\example

应该从 C:\example 中提取特定类型的文件，我在某些列表（比如 listX）中成功完成了该操作。现在的工作是制作 zip 文件 C:\temp，其中包含listX 中**所有文件的压缩形式。**如何在 Python 中执行此操作？

我必须在指定路径（此处为 C:\temp）中制作包含列表（此处为 listX）中包含的所有文件的 zip 文件。

我尝试了 zipfile.ZipFile() 如下：

```
zip_name = zipfile.ZipFile(tozip, 'w')
l=len(listX)
ctr=0
for thelist in listX:
    zip_name = zipfile.ZipFile(tozip+str(ctr), 'w')
    if ctr<=l:
        ctr+=1
    zip_name.write(thelist,'zip') 
```

它当然会创建 'l' zip 文件，但我必须在 tozip 给出的路径中创建 'l' zip 文件（上面的'C:\temp'）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T00:11:25.190

`zipfile.ZipFile`在您希望将 ZIP 文件写入的位置为您创建输出 ZIP 存档。但是你需要给它一个文件名，而不是目录名。根据您的描述，听起来像是`tozip`设置为`C:\temp`. 在这种情况下，您应该使用`os.path.join`来构造文件名，如下所示：

```
import os.path
tozip = os.path.join(r'C:\temp', 'out.zip') 
```

这应该会让你在你想要的目录中创建一个存档。请注意，您可以改为使用方便的“tempfile”库来避免将 Windows 路径硬编码到脚本中：

```
import os.path
from tempfile import gettempdir
tozip = os.path.join(gettempdir(), 'out.zip') 
```

现在，当您遍历列表时，我认为您希望一次将每个文件添加到您正在创建的单个存档中，对吗？您的代码正在循环`listX`，但是对于其中的每个文件，`listX`它都会创建一个*新*的ZIP 存档，并将该文件添加到新存档中。此外，当它通过列表时，因为每次您将新的 ZIP 存档分配给 时`zip_name`，您已经完全忘记了您*真正*想要输出的存档。所以我认为您想要这个：

```
theZip = zipfile.ZipFile(tozip, 'w')
for elem in listX:
    theZip.write(elem) 
```

# javascript - 链接变量

> ID：14845397
> 
> 赞同：1
> 
> 时间：2013-02-13T02:19:43.140
> 
> 标签：javascript, node.js

这是我的代码的简单摘要：

```
var list = {
    "group":{
        "subgroup1":[{"name1":"Jimmy","name2":"Bob"}],
        "subgroup2":[{"name1":"Sarah","name2":"Nick"},{"name1":"Kevin","name2":"George"}]
    }
}
function group(group,name){
    var linktothegroup;

    //Note: In my actual code it will attempt to join a group before creating one this just creates a new one

    //group: Specifies which subgroup to join (my actual code will check if it's valid this is just a simpler version
    //name: the users name

    list["group"][group].push({"name1":name,"name2":""});
    linktothegroup = someway to link that group I just added; //I figured I could find the array slot and specify but that will change if a group is deleted

    this.leavegroup = function(){
        //leaves the group
        //uses the linktothegroup var to be removed from the group
    }
    this.changename = function(name){
        linktothegroup.name1 = name;
        return true;
    }
}
var cubscouts = new group("subgroup1","Billy");
cubscouts.changename("Fred"); 
```

我只想能够编辑“subgroupX”字段中的值（基本上用于changename函数），但是总是有组离开和加入，所以我不能在变量中指定数组槽。

所以基本上有没有办法编辑一个变量并改变另一个变量？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T19:19:19.953

像这样的东西怎么样？：

```
var groups = {

  joinGroup: function(groupName, memberName) {
    if(!this[groupName]) {  // create the group if it doesn't exist
      this[groupName] = []  // each group is just an array of names
    }
    var group = this[groupName]
    group.push(memberName)

    // returns an object allowing for the member's name to be changed later
    return {
      // this function becomes a closure, so the group and memberName variables
      // retain their values from the enclosing scope
      changeName: function(newMemberName) {
        group.splice(group.indexOf(memberName), 1, newMemberName)
      }
    }
  }
} 
```

这允许这种用法：

```
myCubscoutMembership = groups.joinGroup('cubscouts', 'Billy')
myCubscoutMembership.changeName('Bob') 
```

难题的关键部分（如果我正确理解了您的问题）是该`changeName`函数作为围绕and变量的[闭包](https://developer.mozilla.org/en-US/docs/JavaScript/Guide/Closures)返回-因此即使稍后调用，也会记住正确的组和旧名称。`group``memberName``changeName`

为了保持答案的重点，我省略了该`leaveGroup()`方法，但可以将其作为另一个函数添加到返回的对象中。我也没有解决如果删除整个组会发生什么，但这取决于对您的应用程序有意义的内容。

原始样本的一些简化：

1.  `list`我展平了似乎只包含一个的顶级var `group`。
2.  我将每个组简化为名称数组而不是哈希，即 `['billy', 'bob']`代替`{ name1: 'billy', name2: 'bob' }`.

希望有些帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T03:44:31.833

您可以将对象存储在函数中引用的变量中。

```
function group(group,name){
    //other work here
    var linktothegroup = {"name1":name,"name2":""};
    list["group"][group].push(linktothegroup);

    this.leavegroup = function(){
        var groups = list["group"][group];
        for(var i = 0; i < groups.length; i++) {
            if(groups[i] === linktothegroup) {
                groups.splice(i, 1);
                break;
            }
        }
    }
    this.changename = function(name){
        linktothegroup.name1 = name;
        return true;
    }
} 
```

# java - 无法访问服务器 404 错误

> ID：14845402
> 
> 赞同：0
> 
> 时间：2013-02-13T02:20:05.153
> 
> 标签：java, android

我的应用程序连接到服务器来做几件事。一切正常，不知何故，可能我删除了一些东西（服务器或客户端），当我尝试登录时，我在 LogCat 中收到以下消息（通过这种方式我连接到服务器）：

```
02-13 03:49:10.341: E/JSON(381): 404 Not Found

The requested URL /android_login_api/ was not found on this server.

Additionally, a 404 Not Foundnerror was encountered while trying to use an ErrorDocument to handle the request. 
```

尽管出现此消息，但到目前为止，我还没有更改用于连接到服务器的 URL，更尴尬的是，我可以使用相同的配置通过 FTP 访问连接到服务器。有任何想法吗？？

# python - 从多个序列比对中输出相同的列

> ID：14845408
> 
> 赞同：2
> 
> 时间：2013-02-13T02:21:06.277
> 
> 标签：python, biopython, sequence-alignment

你好。我正在编写一个函数来查找相同的对齐列，然后将这些列存储在字典中，这样键应该是列（作为字符串），值是包含列索引的列表。我遇到了一些困难。我当前的代码只能进行一种对齐：

```
from Bio.Align import MultipleSeqAlignment
from Bio.Alphabet import IUPAC, Gapped, generic_dna
from Bio.Seq import Seq
from Bio.SeqRecord import SeqRecord
align1 = MultipleSeqAlignment([
          SeqRecord(Seq("ACTGCTAGCTAG", generic_dna), id="Alpha"),
          SeqRecord(Seq("ACT-CTAGCTAG", generic_dna), id="Beta"),
          SeqRecord(Seq("ACTGCTAGDTAG", generic_dna), id="Gamma"),
      ])
print align1.format("phylip") 
```

我不知道如何从这里开始。

输出应该是一个字典，其中包含相同的对齐列作为键和相同列的索引作为值。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T09:37:36.700

您可以使用 访问列`align1[:,index]`。

要创建字典，请使用此循环：

```
dict = {}
for i in range(0,align1.get_alignment_length()):
   if align1[:,i] in dict:
      dict[align1[:,i]].append(i)
   else:
      dict[align1[:,i]] = [i] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-01-29T11:30:53.160

由于我的分数太低，因此无法支持上面 user1 的响应，但这是访问 MSA 列的正确方法。

使用 AlignIO 读取对齐方式：

> align1 = AlignIO.read(open("alignment.aln"), "clustal")

然后按照 user1 的帖子中的描述创建字典。

然后，您可以访问 MSA 的列：

> 对齐1[0:1,0:10]

第一个索引 (0:1) 将为您提供对齐的第一行，第二个索引 (0:10) 将为您提供对齐的前 10 个位置。

# java - 使用本机库时 Java 应用程序消失

> ID：14845410
> 
> 赞同：0
> 
> 时间：2013-02-13T02:21:14.263
> 
> 标签：java, native, virtual-machine

我正在运行一个 Java 应用程序，它通过本机库连接到 Player/Stage（机器人模拟程序）。如果我在同一台 Ubuntu PC 上运行 Java 应用程序和 Player/Stage，一切正常。但是，如果我在 Ubuntu VM 上运行 Java 应用程序和 Player/Stage，则会出现错误。Java 应用程序正在关闭且没有任何错误消息。GUI 消失，播放器/舞台仍在运行。当 Java 应用程序尝试连接到 Player/Stage 时，就会出现问题。当我在几台 Ubuntu PC 上运行 Java 应用程序和 Player/Stage 时，也会发生同样的错误。

之后 Ubuntu 想要发送一个错误报告，上面写着：

> 崩溃的程序似乎使用了第三方或本地库：
> 
> /usr/local/lib/liblibrary.so.0.0.0 /home/user/workspace/liblibrary.so
> 
> 强烈建议先检查问题是否仍然存在。

这个错误根本没有帮助，因为我需要本机库来连接这两个程序。

无论如何都有可能阅读错误消息吗？java sun和openjdk之间有什么区别吗？

**编辑：**解决方案有点具体。这里的问题是堆栈大小。因为图书馆需要一个比普通图书馆更大的图书馆。所以，我需要添加命令`-Xss16m`以获得更高的堆栈大小。我可以在 Eclipse 中的 Window->Preferences->Java->Installed JREs 中设置此命令，然后采用实际的 JRE->edit->then Default VM 参数。这现在适用于我的 Ubuntu 发行版，但不适用于 Windows 7 x32。还有其他方法可以为 Windows 设置堆栈大小吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T04:32:41.223

本机库正在崩溃（很可能是段错误）。联系该库的创建者并了解发生了什么。

要检查的一件显而易见的事情是库的位数 - 它是 32 位还是 64 位，您的操作系统是什么？除此之外，您还受图书馆创建者的摆布。

# jquery - 当我从 localstorage 收到回调时，我的 Ajax 不会重定向

> ID：14845411
> 
> 赞同：0
> 
> 时间：2013-02-13T02:21:17.130
> 
> 标签：jquery, ajax, cordova

我正在尝试从 ajax 登录系统（在科尔多瓦中）保存我的返回数据并在单独的页面中访问数据。它不起作用。重定向没有发生，返回数据不起作用！请请请帮忙！

索引.html

```
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="format-detection" content="telephone=no">
    <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, height=device-height, target-densitydpi=device-dpi">
    <title>Hello World</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js" type="text/javascript"></script>
    <script type="text/javascript">
        $(document).ready(function () {
            $("form").submit(function () {

                var uname = document.getElementById("username").value;
                var pword = document.getElementById("password").value;
                var postData = {
                    username: uname,
                    password: pword
                };

                $.ajax({
                    url: "http://www.yellowcabsavannah.com/test.php",
                    type: "POST",
                    data: postData,
                    async: false,
                    dataType: 'json',
                    cache: false,
                    success: function (data) {

                        var ReturnMessage = data.message;

                        localStorage.setItem('message', ReturnMessage);

                        window.location = "map.html";
                    }
                });
                return false;
            });
        });
    </script>
</head>

<body>
    <form action="">
        <input type='text' id="username" name="username" placeholder="Username">
        <br>
        <input type='password' id="password" name="password" placeholder="password">
        <br>
        <input type="submit" id="submit" value="Login">
    </form>
</body> 
```

测试.php

```
<?php
header('Content-Type: application/json');
$mysql_host = "";
$mysql_database = "";
$mysql_user = "";
$mysql_password = "";
$conn=mysql_connect($mysql_host,$mysql_user,$mysql_password);
mysql_select_db($mysql_database);

$username = mysql_real_escape_string($_POST['username']);
$password =  mysql_real_escape_string(MD5($_POST['password']));

$sql="SELECT * FROM accounts WHERE uname = '$username' AND pword = '$password'";

$r = mysql_query($sql);

while($row = mysql_fetch_array($result))
{
    $name = $row["name"];
}

if(mysql_num_rows($r) != 1){
    echo json_encode(array("message" => "Nope! Wrong Login!"));
}
if(mysql_num_rows($r) == 1)
{
    echo json_encode(array("message" => $name));
}
?> 
```

地图.html

```
<!DOCTYPE html>
<!--
 Licensed to the Apache Software Foundation (ASF) under one
 or more contributor license agreements.  See the NOTICE file
 distributed with this work for additional information
 regarding copyright ownership.  The ASF licenses this file
 to you under the Apache License, Version 2.0 (the
 "License"); you may not use this file except in compliance
 with the License.  You may obtain a copy of the License at

 http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing,
 software distributed under the License is distributed on an
 "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
 KIND, either express or implied.  See the License for the
 specific language governing permissions and limitations
 under the License.
 -->
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <meta name="format-detection" content="telephone=no" />
        <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, height=device-height, target-densitydpi=device-dpi" />
        <link rel="stylesheet" type="text/css" href="css/index.css" />
        <title>Hello World</title>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js" type="text/javascript"></script>        <script type="text/javascript" src="cordova-2.3.0.js"></script>
        <script type="text/javascript">
            app.initialize();
            document.addEventListener()
            {
                ‘deviceready’, onDeviceReady, false);
            }
            function onDeviceReady()
            {
                $(document).ready(function () {
                    var RetMessage = localStorage.getItem('message');
                    alert(RetMessage);
                });
            }
            </script>

    </head>
    <body>
        <p>Your on map.html</p>
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T13:26:53.447

尝试

```
window.localStorage.setItem('message', ReturnMessage); 
```

代替

```
localStorage.setItem('message', ReturnMessage); 
```

和

```
$.mobile.changePage("map.html"); 
```

代替

```
window.location = "map.html"; 
```

# ant - 使用令牌->文件时如何强制Ant忽略空行

> ID：14845412
> 
> 赞同：0
> 
> 时间：2013-02-13T02:21:19.787
> 
> 标签：ant

**使用令牌-> 文件读取文件时，如何强制 Ant 忽略空行？**

*更准确地说：*

****${dir.config}****中**的 scripts.cfg 可能包含来自**./config/**文件夹的同名文件中的行。我正在使用这个脚本来确定一个文件的行/字符串是否存在于另一个文件中。**

 **但是：如果一个文件的内容不存在于另一个文件中，则不应有任何差异。尽管如此，尽管**${ant.refid:to_be_removed.list}**返回了许多差异，这可能是由于其中一个文件（input.list 之一）包含空行 -无论出于何种原因，它确实将这些文件标记为*差异。*

我尝试过使用 loadfile 和 tokenfilter，但没有成功。现在它实际上设法删除了正确的行（参见我在最后注释掉的代码），但它也删除了所有空白行，使文件更难阅读。此外，我*希望能够*通过使用**条件**和**resourcecount** -result 来确定是否必须合并文件（= 行数）。可悲的是，这个 resourcecount-Id 不是 0，尽管除了空白行之外没有区别。

任何帮助是极大的赞赏！感谢您的时间！

```
<target name="removeScriptList" description="removes script entries">
    <tokens id="input.list">
        <file file="${dir.config}/scripts.cfg"/>
    </tokens>
    <tokens id="invalid.list">
        <file file="./config/scripts.cfg"/>
    </tokens>
    <resourcecount property="to_be_removed.list.lines" count="0">
        <intersect id="to_be_removed.list">
            <resources refid="input.list"/>
            <resources refid="invalid.list"/>
        </intersect>
    </resourcecount>
    <difference id="clean.list">
        <resources refid="input.list"/>
        <resources refid="to_be_removed.list"/>
    </difference>
    <pathconvert property="clean.prop" refid="clean.list"
                 pathsep="${line.separator}"/>

    <echo>${to_be_removed.list.lines}</echo>
    <echo>${ant.refid:input.list}</echo>

    <!--<echo level="info" message="Creating backup scripts.cfg"/>
    <copy file="${dir.config}/scripts.cfg" tofile="${dir.config}/scripts.cfg.bak" />
    <echo file="${dir.config}/scripts.cfg">${clean.prop}</echo>-->
</target> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T08:53:40.073

尝试：

```
<loadfile property="mail.recipients" srcFile="recipientlist.txt">
      <filterchain>
        <striplinebreaks/>
      </filterchain>
</loadfile> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T03:41:48.063

您可以尝试更改加载文件的方式（数据错误的文件）。见下文。结果`<resources>`将只有修剪过的线条。

```
<loadfile srcfile="scripts_bad.cfg" property="invalid.list">
        <filterchain>
            <trim>
            </trim>
        </filterchain>
    </loadfile> 
```**

# java - 无法在卡片匹配程序java中翻转卡片

> ID：14845413
> 
> 赞同：1
> 
> 时间：2013-02-13T02:21:24.573
> 
> 标签：java

我正在用java编写一个卡片匹配程序，但我碰到了一堵墙。我的目标是让所有卡片面朝下显示在屏幕上，当用户点击一张卡片时，它应该面朝上翻转并等待另一张卡片被点击并面朝上。在两张牌被翻转后，它应该检查它们是否相等并将它们从屏幕上清除，如果不是，它们应该翻转回面朝下。我的问题是，当我翻转第二张卡片时，它会立即检查它们是否相等，所以它甚至看起来不像翻转了，让用户没有时间看它。我已经排除了检查它们是否相等的代码，因为我已经有了正确的

```
 int count = 0;
public void mouseClicked(MouseEvent me)
{
    //check if click occurred on one of the cards, if so flip card
    for(int x=0; x<20; x++)                    //check the 20 cards
    {
        if(cardList.get(x).contains(me.getX(), me.getY()))
        {
            count++;              //count is increased with each click
            cardList.get(x).flip();                       //flip the card
            repaint();                      
            flipCard(x, cardList.get(x).number, count); 
        }
    }
}

public void flipCard(int card, int value, int counter)
{
    int cardNum = card;
    int cardVal = value;
    count = counter;

    if (count == 2)          //if count is two it should check if they are equal
    {
        for(int x=0; x<20; x++)  //if wrong flip them all back
        {
            cardList.get(x).flipAll();
        }
    }
    count = 0;
} 
```

任何帮助将不胜感激，谢谢:)

# magento - 引导时，customer_logged_in 句柄未添加到布局中

> ID：14845417
> 
> 赞同：0
> 
> 时间：2013-02-13T02:21:46.230
> 
> 标签：magento, magento-1.7

```
// Include Magento application
require_once ( "../app/Mage.php" );
umask(0);

// Initialize Magento
Mage::app("default");

// Load the session
// This has to be done before getLayout() below or the blocks won't see the session
$session Mage::getSingleton("core/session", array("name" => 'frontend'));

// Get the primary layout
global $mageLayout;
$mageLayout = Mage::app()->getLayout();

// Set the layout XML to look for default and wordpress
$mageLayout->getUpdate()
    ->addHandle('default')
    ->addHandle('customer_logged_in')
    ->load(); 
```

（我意识到你不应该一直设置 customer_logged_in 句柄。通过 $session->isLoggedIn() 我可以动态地做到这一点。我有一个更大的问题。）

我已经成功地能够使用此代码设置其他句柄。（例如，我有一个名为“wordpress”的句柄，用于更改加载到 WordPress 中的块。）但是，手动设置 customer_logged_in 不起作用。

为什么要手动设置？因为客户模块的 controller_action_layout_load_before 观察者永远不会触发。我已经想出了如何让这个观察者使用[stackoverflow上其他地方建议的代码](https://stackoverflow.com/questions/14201677/how-can-i-trigger-controllerless-core-magento-modules-that-watch-controller-act)进行调度，但是观察者代码失败了，因为$observer->getEvent()->getLayout()返回null。

所以我的问题是，虽然我可以直接在我的块的 phtml 文件中访问会话，并使用 PHP 执行逻辑，但我不能利用布局 XML 文件中存在的任何登录/注销逻辑，因为它们依赖在正在设置的 customer_logged_in 句柄上。

我不知道为什么我创建的wordpress句柄可以正确设置，但是customer_logged_in句柄被忽略了。（与 customer_logged_out 一样。）

任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T03:03:13.880

它正在被添加，但句柄中的内容完全有可能没有被呈现。

# xcode - 在 Xcode 中，我想在每次点击 UIButton 时更新它的标题。让它显示 1 第一次命中， 2 第二次。你懂了

> ID：14845424
> 
> 赞同：0
> 
> 时间：2013-02-13T02:22:42.890
> 
> 标签：xcode

我想在每次使用变量命中 UIButton 时更新它的 TITLE。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T02:25:55.153

看起来这可能涵盖了您在[iPhone Tap Counter之后的情况](https://stackoverflow.com/questions/3895774/iphone-tap-counter)

anotherLabel 将是您的 UIButton 的名称

```
static int count;
count++;
NSString *countString = [NSString stringWithFormat:@"%d", count];
[anotherLabel setText: countString]; 
```

# g++ - 自动依赖项不适用于 Eclipse CDT C++ 项目

> ID：14845428
> 
> 赞同：2
> 
> 时间：2013-02-13T02:23:16.310
> 
> 标签：g++, eclipse-cdt

Eclipse CDT 8.1.0 中生成的自动依赖规则似乎不正确。为了说明问题，我创建了一个空的 Executable 项目并添加了两个文件。

**测试.cpp**：

```
 #include "SomeOtherHeader.h"
    int main(void){return 0;} 
```

和 **SomeOtherHeader.h**（它是空的）

编译这个项目会导致 Eclipse 在项目目录中生成“Debug”文件夹，其中包含 subdir.mk makefile。

**Debug/subdir.mk**的内容：

```
################################################################################
# Automatically-generated file. Do not edit!
################################################################################

# Add inputs and outputs from these tool invocations to the build variables 
CPP_SRCS += \
../test.cpp 

OBJS += \
./test.o 

CPP_DEPS += \
./test.d 

# Each subdirectory must supply rules for building sources it contributes
%.o: ../%.cpp
    @echo 'Building file: $<'
    @echo 'Invoking: GCC C++ Compiler'
    g++ -O0 -g3 -Wall -c -fmessage-length=0 -MMD -MP -MF"$(@:%.o=%.d)" -MT"$(@:%.o=%.d)" -o "$@" "$<"
    @echo 'Finished building: $<'
    @echo ' ' 
```

它与`-MT"$(@:%.o=%.d)"`我有关，因为 MT 选项在文件 Debug/test.d 中创建了一个无意义的依赖项

```
test.d: ../test.cpp ../SomeOtherHeader.h

../SomeOtherHeader.h: 
```

在 Debug/subdir.mk 中更改`-MT"$(@:%.o=%.d)"`为更合理的 Debug/test.d：`-MT"$@"`

```
test.o: ../test.cpp ../SomeOtherHeader.h

../SomeOtherHeader.h: 
```

看起来“-MT”字符串在 managedbuilder.core java 代码中是硬编码的：

```
$ unzip -p /usr/lib64/eclipse/dropins/cdt/eclipse/plugins/org.eclipse.cdt.managedbuilder.core_8.1.0.201206111645.jar | strings | grep '\-MT'
-MT"
-MT"$(@:%.o=%.d)"
-MT"
-MT"$@"
-MT"$(@:%.d=%.o)" 
```

看起来获胜的选项`-MT"$@"`在那里，但我如何指示 managedbuilder 使用它？有`-MT"$(@:%.o=%.d)"`什么实际用途吗？

这是我第一次在这个网站上发帖，所以请放轻松:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T13:12:15.107

添加`-MT"$@"`到`Project Properties->C/C++ Buid->Settings->GCC Compiler->Miscellaneous->Other flags`. Eclipse 将简单地将这个标志添加到 makefile 内的编译行。文件内的输出`test.d`应类似于：

```
test.o test.d: ../test.cpp ../SomeOtherHeader.h

../SomeOtherHeader.h: 
```

# xcode - 如何从 Webservices 获取 UIPickerView 中的数据

> ID：14845431
> 
> 赞同：1
> 
> 时间：2013-02-13T02:23:56.793
> 
> 标签：xcode, uipickerview

我是 Iphone 新手，我正在开发一个必须使用 UIPickerView 的应用程序。我能够静态填充 UIPickerView，但现在我必须从 WEBSERVICES 获取数据并将它们填充到 Picker View 中。

你能告诉我一步一步的指导吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T04:36:47.517

为此，您可以使用`UIPickerView`委托方法和一个`MutableArray`.
用于`MutableArray`存储您的网络服务响应，然后在您的`UIPickerView`委托方法中使用它：

```
// number of component to display in the pickerview
    - (NSInteger)numberOfComponentsInPickerView:(UIPickerView *)thePickerView 
    {
        return 1;
    }

// numbers of row is the total numbers of object store in your array

    - (NSInteger)pickerView:(UIPickerView *)thePickerView numberOfRowsInComponent:(NSInteger)component 
    {

        return [YourArray count];
    }

//display your title

    - (NSString *)pickerView:(UIPickerView *)thePickerView titleForRow:(NSInteger)row forComponent:(NSInteger)component 
    {
        NSString *obj = [YourArray objectAtIndex:row];
        return obj; 

    }

// on click whatever you want to do.
    - (void)pickerView:(UIPickerView *)thePickerView didSelectRow:(NSInteger)row inComponent:(NSInteger)component 
    {

       // onClick i am displaying the picker value in my textview you can do as per your requirement.
                mytextview.text=[YourArray  objectAtIndex:row];

    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-07-09T13:09:15.230

**斯威夫特 4**

```
// MARK: - Picker View Delegate & Data Source

func numberOfComponents(in pickerView: UIPickerView) -> Int {

    return 1
}

func pickerView(_ pickerView: UIPickerView, numberOfRowsInComponent component: Int) -> Int {

    return yourArray.count
}

func pickerView(_ pickerView: UIPickerView, titleForRow row: Int, forComponent component: Int) -> String? {

    return yourArray[row]
}

func pickerView(_ pickerView: UIPickerView, didSelectRow row: Int, inComponent component: Int) {

    textView.text = yourArray[row]
} 
```

# html - div 对着一个居中的 div

> ID：14845432
> 
> 赞同：0
> 
> 时间：2013-02-13T02:24:13.467
> 
> 标签：html, css, position, css-float, alignment

使用 html/CSS 我试图将一个带有两个图像的小 div 放在一个大的居中（l/r 边距设置为自动）垂直弹性的右下方，但 400px 宽的 div 里面装满了很多东西。我似乎无法得到我需要的东西。

这就是我想要得到的，如果窗口太宽，绿色框会紧挨着红色框，空白区域位于两个框的右侧。如果窗口不够宽，用户必须向右滚动才能看到绿色框。

[所需的布局](http://i46.tinypic.com/1z1dxrc.png)

我觉得我只是错过了一些超级简单的解决方案。浮动不起作用，因为这会将绿色框一直对齐到右侧，并将空白区域放在绿色和红色之间。我尝试了各种“位置”css安排，但在想要红框外的绿框时遇到了麻烦。

编辑（要求提供更多详细信息）：

我尝试使红色框（#main）位置相对，而绿色（#sub）位置绝对。我玩弄了各种 left:px, right:px 坐标，但发现当我把它放在红色框外时，它变得不可见。我尝试了各种位置标签与对齐标签的组合。我尝试了内联块（我什至不确定这里是否相关！）。

然后我正在阅读有关制作虚拟包装父 div 的内容，所以我尝试这样做并制作了一个#wrapper，我尝试尝试使用相对/绝对位置，但它最终弄乱了红色块上方的布局（实际上只是一个横幅和一个 h1)。

很抱歉，我没有要发布的实际代码，但每次我尝试某些东西但它不起作用时，我只是删除了标签，所以我不会把自己与周围所有这些额外的 CSS 混淆。这几天我一直在研究这个小东西。现在我的代码已经从以前的尝试中留下了一点点：

```
#main   {width:400px;
 margin-left: auto;
 margin-right: auto;
 padding-bottom:0px;
 overflow:hidden;}

#sub    {right:-10px;
 bottom:100px;
 float:right;} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T02:36:38.107

**HTML**

```
<div id="bigbox">
  <!-- content goes here -->
  <div id="littlebox">SomeImages</div>
</div> 
```

**CSS**

```
#bigbox {
  width: 900px;
  margin: 0 auto;
  position: relative;
}

#littlebox {
  width: 150px;
  position: absolute;
  bottom: 5px;
  right: -160px; // width + a 10px margin if desired
} 
```

[http://jsfiddle.net/eLT9U/1/](http://jsfiddle.net/eLT9U/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T02:40:51.727

[http://jsfiddle.net/ferne97/MDWWu/](http://jsfiddle.net/ferne97/MDWWu/)

html

```
<div class="wrap">
    <div class="container"></div>
    <div class="box"></div>
</div> 
```

css

```
.wrap {
    position: relative;
}

.container {
    width: 200px;
    min-height: 420px;
    margin: 0 auto;
}

.box {
    width: 100px;
    height: 100px;
    position: absolute;
    left: 50%;
    bottom: 0;
    margin-left: 120px; /* half .container width + extra margin */
} 
```

对于左边距，将您的内容区域分成两半，然后在其上添加任何额外的边距，因此在该示例中它将是 200 / 2 = 100 + 20px 边距 = 120px

# java - 回文程序 - 字符串索引超出范围异常

> ID：14845433
> 
> 赞同：0
> 
> 时间：2013-02-13T02:24:16.687
> 
> 标签：java, string, exception, palindrome

我已经为我的 CS 类编写了代码来识别用户输入的字符串是否是回文。我已经让代码工作了。但是，每当我执行代码时，我都会收到以下消息：

```
"Exception in thread "main" java.lang.StringIndexOutOfBoundsException: String index out of range: -1
    at java.lang.String.charAt(String.java:658)
    at palindrome.Palindrome.main(Palindrome.java:14)" 
```

我认为我的有问题`length`，`i`但我不确定是什么。我的代码如下。我用于`aabbaa`用户输入的字符串。

```
package palindrome;

import java.util.Scanner;

public class Palindrome {

    public static void main(String[] args) {
        System.out.println ("Enter A String:");
        Scanner input = new Scanner (System.in);
        String s = input.nextLine();
        int length = s.length();
        int i = 0;
        while (length>= 0) {
            if (s.charAt(i) == s.charAt(length-1)) { 
                i++;
                length--;
                if (length == i) {
                    System.out.println ("Your string is a palindrome");
                    length = 0;
                }
            }
            else {
                System.out.println ("Your string is not a palindrome");
                length = 0;
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T02:28:07.933

当长度等于 0 时，while 循环中的第一个 if 语句会尝试获取 s.charAt(0-1)、iescharAt(-1)，这就是发生错误的地方。

也许尝试以下（未测试）：

```
public static void main(String[] args) {
System.out.println ("Enter A String:");
Scanner input = new Scanner (System.in);
String s = input.nextLine();
int length = s.length();
int i = 0;
while (length > 0) {
    if (s.charAt(i) == s.charAt(length-1)) { 
        i++;
        length--;
        if (length < 1) {
            System.out.println ("Your string is a palindrome");
            break;
        }
    }
    else {
        System.out.println ("Your string is not a palindrome");
        break;
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T02:29:45.673

您编写`while(length >= 0) {}`并在您编写的`main`方法中`length = 0;`尝试循环。

那应该是`while(length > 0){}`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-13T03:21:39.103

只需创建一个如下所示的方法并将您的字符串作为参数传递来测试字符串是否为回文。如果字符串是回文，方法将返回 true

想法是将您的字符串反转并与原始字符串进行比较，如果两者相同，则它是回文。

```
public static boolean isPalindrome(String str) {
    return str.equals(new StringBuffer().append(str).reverse().toString());
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-04-29T10:54:45.270

当您在那个时候迭代while循环时，长度值变为负数，并且数组索引从这`0`就是为什么您将异常作为`StringIndexOutOfBoundsException`.

你应该试试这个，它会很好用。

```
import java.util.Scanner;

public class Palindrome
{
    public static void main(String[] args)
    {
        System.out.println("Enter A String:");
        Scanner input = new Scanner(System.in);
        String s = input.nextLine();
        int length = s.length();
        int i = 0;
        while (length >= 0)
        {
            if (s.charAt(i) == s.charAt(length - 1))
            {
                i++;
                length--;
                if (length-1 == i)
                {
                    System.out.println("Your string is a palindrome");
                    length = 0;
                    break;
                }
            }
            else
            {
                System.out.println("Your string is not a palindrome");
                length = 0;
                break;
            }
        }
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-04-29T11:24:41.973

你应该做这样的事情：

```
package palindrome;

import java.util.Scanner;

public class Palindrome {

    public static void main(String[] args) {
        System.out.println ("Enter A String:");
        Scanner input = new Scanner (System.in);
        String s = input.nextLine();
        if ( s.equals(new StringBuffer(s).reverse().toString()) ){
            System.out.println ("Your string is a palindrome");
        else
            System.out.println ("Your string is not a palindrome");
    }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-13T02:27:31.603

您的问题是，在每一步中，您都会迈出两步，但只会将长度减少 1

所以一个踪迹：用户输入`foooof`.

```
length = 6
i = 0
f == f
i = 1
length = 5
o == o
i = 2
length = 4
o == o
i = 3
length = 3 (You've now passed yourself)
o == o
i = 4
length = 2
length-i = -2 =>     index out of range 
```

# html - Flash 音频后备循环短音

> ID：14845437
> 
> 赞同：1
> 
> 时间：2013-02-13T02:24:48.747
> 
> 标签：html, flash, html5-audio

我们的残疾儿童识字网站为所有年龄段的读者提供入门书籍。我们包括使用服务器上生成的 mp3s 文件大声朗读书籍的能力。我们在支持它的浏览器上使用 HTML5 音频，在不支持的浏览器上回退到 Flash。我们超过 4% 的用户禁用了 JavaScript，因此我们不能依赖可用的 html5 填充程序。

该实现工作正常，只是非常短的 mp3 文件一遍又一遍地播放，而不是像预期的那样只播放一次。你可以在这里听到一个烦人的例子：http: [//tarheelreader.org/2012/01/19/the-m-book/](http://tarheelreader.org/2012/01/19/the-m-book/?voice=child) ?voice=child 。要听到循环播放，您需要使用 Firefox 或 IE 使其回退到 Flash。

我正在使用 player_mp3_mini.swf 作为后备。使用这样的代码：

```
<object class="flashplayer" type="application/x-shockwave-flash" data="/theme
    /player_mp3_mini.swf" width="1" height="1">
  <param name="movie" value="/theme/player_mp3_mini.swf" />
  <param name="bgcolor" value="#ff0000" />
  <param name="FlashVars" value="mp3={{{eurl}}}&amp;autoplay=1" />
</object> 
```

第一页的 mp3 文件是 2756 字节，不循环的第二页是 2653，所以不是每个短文件都重复。我已经尝试过该`byteslimit`变量，但没有效果。

我正在寻找解决方案、解决方法、替代方案、任何解决此问题的方法，而不需要为每个用户提供 JavaScript。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T03:05:02.800

我用迷你播放器尝试了你的 1-c.mp3 MP3 文件（即使是支持“loop=0”参数来控制循环的普通播放器版本），Flash 播放器按照你的描述不断循环。

我可以在本地 HTML 页面上重现它，所以我重新编码了 mp3（我使用了 Audacity，保持 32kb 但比特率不变）。该文件从 2.8kb 更改为 5.6kb，但随后在迷你播放器中播放时没有循环播放。所以我认为你需要重新编码循环播放的 MP3，可能会花费更多 kb。或者最终找到另一个可以更好地处理小型 MP3 的 MP3 Flash 播放器。

# c# - 删除字符串变量中没有的字符作为 Regex.Replace 中的模式

> ID：14845438
> 
> 赞同：1
> 
> 时间：2013-02-13T02:24:55.070
> 
> 标签：c#, regex

我有以下字符串变量，我想将其用作 Regex.Replace 中有效字符模式的一部分：

```
string unreservedChars = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789-_.~";
string input = "gzaHQ6PKUgQjXP+/dajkl=="; 
```

是否有一个简单的（希望是一个衬里）来替换中`input`不存在的字符`unreservedChars`？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-13T02:28:29.470

您可以尝试速记字符范围：

```
// returns "gzaHQPKUgQjXPdajkl"
Regex.Replace("gzaHQ6PKUgQjXP+/dajkl==", @"[^a-zA-Z0-9-_.~]", ""); 
```

# version - Nuget 如何知道使用最新的包？

> ID：14845443
> 
> 赞同：0
> 
> 时间：2013-02-13T02:25:55.477
> 
> 标签：version, nuget

当使用 nuget 安装带有 -excludeversion 标志的包时，它如何知道最新的包是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T02:31:26.310

该`-excludeversion`标志所做的只是告诉 nuget 将包放入一个文件夹中，而不附加版本。包名称和版本仍然`packages.config`按惯例存储。

# ruby-on-rails - 由于 New Relic RPM gem，Heroku 推送失败

> ID：14845445
> 
> 赞同：21
> 
> 时间：2013-02-13T02:25:56.113
> 
> 标签：ruby-on-rails, heroku, newrelic

[根据 Heroku 的文档](https://devcenter.heroku.com/articles/newrelic#addon_installation)，我已经`gem 'newrelic_rpm'`在我的 Gemfile 中。当我尝试运行时，我收到以下信息：`git push heroku master`

```
-----> Ruby/Rails app detected
-----> Installing dependencies using Bundler version 1.3.0.pre.5
       Running: bundle install --without development:test --path vendor/bundle --binstubs vendor/bundle/bin --deployment
       Fetching gem metadata from https://rubygems.org/........
       Fetching gem metadata from https://rubygems.org/..
       Could not find newrelic_rpm-3.5.6.46 in any of the sources
 !
 !     Failed to install gems via Bundler.
 !
 !     Heroku push rejected, failed to compile Ruby/rails app

To git@heroku.com:reponame.git
 ! [remote rejected] master -> master (pre-receive hook declined) 
```

有想法该怎么解决这个吗？我已经`bundle update`按照这个 SO 答案尝试过：[https](https://stackoverflow.com/a/4576816/337903) : //stackoverflow.com/a/4576816/337903 无济于事。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2013-02-13T05:12:01.497

**编辑：gem 的 3.5.8.72 已发布@thanks Chris**

Bundler Dependency API 似乎有问题。

newrelic_rpm-3.5.6.46 于 2013 年 1 月 22 日被撤消。但 API 仍在请求。

将 gemfile 锁定到当前版本将同时解决问题。

```
 gem "newrelic_rpm", "~> 3.5.5.38" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-24T00:17:24.253

正如 chrislopresto 提到的，您可能需要做一个

```
bundle update newrelic_rpm 
```

自从有人建议以来，我将其发布为答案，嘿，版本发生了变化。

# c++ - 如何在 c++ 和 linux 中将 std::ostream 重定向到文件或 /dev/null

> ID：14845446
> 
> 赞同：1
> 
> 时间：2013-02-13T02:25:57.767
> 
> 标签：c++, c, linux

我有一个 c++ 应用程序，其中包含大量`std::cout`. 它在 linux 2.6.x 上运行。我需要测试应用程序的性能，所以我正在考虑重定向`std::cout`到`/dev/null`. 在 C 中，我可以简单地使用`dup2`. c++ 中是否有等效的重定向`std::ostream`到文件或`/dev/null`？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-13T03:19:01.740

这个`dup2`技巧在 C++ 中仍然有效，因为就像`<stdio.h>`,`<iostream>`只是 UNIX 系统调用之上的一个缓冲层。

您也可以在 C++ 级别通过从以下位置断开缓冲区来执行此操作`std::cout`：

```
std::cout.rdbuf( NULL ); 
```

`std::cout`除了切断与任何实际输出设备之间的关系外，这将设置`std::ios::badbit`标志，以防止发生任何输出转换（例如数字到文本）。性能应该比文件系统级别的破解要好得多。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-13T02:30:12.863

你可以在 C++ 中做同样的事情。C 和 C++ 都依赖底层操作系统进行 IO，重定向 fd 1 会`std::cout`像影响`stdout`.

（当然，为了测试，您可以`> /dev/null`在命令行上运行命令...）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-13T03:05:47.913

另一种方法是将[您的文件符号链接到 /dev/null](http://linuxzoo.net/page/wildcards_links_soft.html)。

```
% ln -s /dev/null core
% ls -l core
lrwx-xr-x  1 john users 9 Nov 18 12:26 core -> /dev/null 
```

但是，要真正测试您的程序速度，我建议您注释掉对文件的写入并计算执行时间差，因为写入 /dev/null 的开销可能与写入普通文件的开销不同。

# c++ - __forceinline 的执行速度是否比 __inline 快？

> ID：14845447
> 
> 赞同：1
> 
> 时间：2013-02-13T02:26:06.457
> 
> 标签：c++, performance, visual-c++

有些函数太短了，那么用它来`__forceinline`代替它是一个好地方`__inline`吗？

```
__inline void foo(){ //Optimized call
//some commands
}

__forceinline void fast_foo(){ //More "inline" - Does it perform faster than inline?
//some commands
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T02:33:17.483

> __forceinline 的执行速度是否比 __inline 快？

有时会，有时不会。这完全取决于函数内部的内容、调用模式以及许多其他因素。

一般来说，从静态分析中准确预测性能几乎是不可能的。如果您想准确地回答问题，请为这两种选择计时。

# javascript - Ajax 调用 spring 控制器总是失败

> ID：14845450
> 
> 赞同：0
> 
> 时间：2013-02-13T02:26:14.913
> 
> 标签：javascript, ajax

我有一个对 spring 控制器的 ajax 调用，然后将返回的数据写入 DOM。浏览器中的直接访问控制器工作正常并显示一个字符串。在调试器中运行 ajax，显示 ajax 调用被触发并且控制器被调用，然后 ajax 调用总是失败。有什么建议吗？这是我的代码。

servlet-context.xml：

```
<context:component-scan base-package="com.test.web.controller" /> 
```

控制器方法：

```
@RequestMapping(value = "/myAjaxHandler")
public void myAjaxHandler(HttpServletRequest request, HttpServletResponse response){
    response.setContentType("text/html");
    response.getWriter().println("Hello");
} 
```

阿贾克斯代码：

```
$.ajax({
    type: 'POST',
    url: '/dispatcher/myAjaxHandler',
    data: $("form").serialize(),
    dataType: "text",
    success: function(data) {
        alert("success");
    },
    error: function(){
        alert("fail");
    }
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T02:28:26.000

你打过电话`myAjaxCall`吗？你只需定义这个函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T03:00:49.140

尝试使用`myAjaxCall()`insted of`var myAjaxCall = function() = ...`

# cocoa - 从 Cocoa 应用程序调用终端命令

> ID：14845451
> 
> 赞同：1
> 
> 时间：2013-02-13T02:26:26.230
> 
> 标签：cocoa, terminal, ffprobe

1.  我在 XCode 中创建了一个 Cocoa Mac OSX 应用程序
2.  在视图中添加了一个按钮
3.  在运行应用程序时，如果我单击按钮
4.  应调用终端命令，例如“ffprobe abcd.avi”，并将结果传递回可可应用程序

那可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T02:33:03.870

使用 NSTask。您可以在这里找到一些使用它的简单示例：http: //borkware.com/quickies/one?topic= [nstask](http://borkware.com/quickies/one?topic=nstask)

# c# - 基于属性和值的xpath

> ID：14845453
> 
> 赞同：1
> 
> 时间：2013-02-13T02:26:29.060
> 
> 标签：c#, .net, xpath

我需要处理相同的xml，下面是它的一部分：

```
<response>
<dat id="1">
    <b>
        <i>1</i>
    </b>
    <ds>
        <d>
            <t>2012-12-21</t> 
```

我需要使用什么 xpath 来选择元素“d”，该元素具有属性 id="1" 的父父元素“dat”和值为 2012-12-21 的子元素“t”？

它在 C# 中，应用程序从 Internet 获取此 xml 并将其加载到 XmlDocument 中。目前我正在做多个步骤：找到注释“dat”，然后在“dat”下找到“t”，然后转到父节点“d”。我希望有 xpath 来替换上述多个步骤。

我试过这个 xpath: `//dat[@id="1"]/ds/d[t="2012-12-21"]`，但返回空节点

谢谢。

编辑：Dimitre Novatchev 的解决方案见下文。

顺便说一句：`//dat[@id="1"]/ds/d[t="2012-12-21"]`工作得很好，不知道我做测试时发生了什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T04:54:12.273

**使用**：

```
//dat[@id = 1]/*/d[t[. = '2012-12-21']] 
```

这将选择所有`d`具有`t`子元素的元素，其字符串值为 string `'2012-12-21'`，

并且其祖父母是`dat`具有`id`数值属性的a `1`。

**如果您只想选择所有此类元素中的一个（比如第一个），请使用**：

```
(//dat[@id = 1]/*/d[t[. = '2012-12-21']])[1] 
```

**基于 XSLT 的验证**：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

 <xsl:template match="/">
  <xsl:copy-of select="//dat[@id = 1]/*/d[t[. = '2012-12-21']]"/>
 </xsl:template>
</xsl:stylesheet> 
```

**当此转换应用于（已完成）提供的 XML 文档时：**

```
<response>
    <dat id="1">
        <b>
            <i>1</i>
        </b>
        <ds>
            <d>
                <t>2012-12-21</t>
            </d>
        </ds>
    </dat>
</response> 
```

**对上面的 XPath 表达式求值，并将该求值的结果（选定的节点）复制到输出**：

```
<d>
   <t>2012-12-21</t>
</d> 
```

# java - 确定是使用内部还是外部android应用

> ID：14845455
> 
> 赞同：0
> 
> 时间：2013-02-13T02:26:38.757
> 
> 标签：java, android

我一直在阅读我的文件存储位置，但我仍然不确定我应该采取什么路线。我正在编写一个存储图像和 pdf 的应用程序（总共 300MB 左右）。我希望将应用程序安装在内部存储上，然后允许用户将 pdf 和一些图像存储在其中选择的存储上。即使我的清单中有这个，是否可以允许用户只选择他们用于这些文件的存储：

```
android:installLocation="internalOnly" 
```

本质上，我想让用户在应用程序启动时选择它。

如果是，我是否只需要在应用程序中有一个标志，如果用户选择外部并且外部存储可用，有足够的空间，然后将文件保存到它。每次用户打开应用程序时，我都会检查以确保文件可用。如果用户选择内部，它将使用 openFileOutput。这一切似乎都对，这可能吗？

或者我应该只考虑让它完全在内部，因为没有这些 PDF 和图像，应用程序将无法使用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T02:50:06.473

听起来您可以将 installLocation 设置如下以完全完成您想要的：

```
android:installLocation="preferExternal" 
```

从[文档中：](http://developer.android.com/guide/topics/data/install-location.html)

> 如果您声明“preferExternal”，您要求将您的应用程序安装在外部存储上，但系统不保证您的应用程序将安装在外部存储上。如果外部存储已满，系统会将其安装到内部存储上。用户还可以在两个位置之间移动您的应用程序。

如果您将其设置为 internalOnly，则用户无法将应用程序从内部存储移动到外部存储，因此上述解决方案可能是您的最佳选择。

# php - 在 php 中使用 taskkill

> ID：14845460
> 
> 赞同：2
> 
> 时间：2013-02-13T02:27:13.000
> 
> 标签：php, windows-server-2008, taskkill

我在 Web 面板上工作以启动和结束 Windows Server 上的程序。

该服务器是带有 Windows Web Server 2008 R2 和 Plesk Panel 的专用服务器。

我的PHP代码：

```
taskkill /F /IM Gotcha_Antihack.exe 2>errors.txt
pclose(popen($cmd, "r")); 
```

errors.txt 中的文本：

> FEHLER: Zugriff verweigert。（错误：访问被拒绝）

我不能执行 taskkill（授予 Internet 用户的权限）还是 taskkill 不能结束进程（同一用户启动进程）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-24T14:17:03.920

问题与 Windows 用户帐户控制有关。我必须授予 ISS 用户执行该命令的权限。

# django - 使用 Django 设置 Yeoman

> ID：14845461
> 
> 赞同：14
> 
> 时间：2013-02-13T02:27:27.453
> 
> 标签：django, gruntjs, yeoman

有没有人能让[Yeoman](http://yeoman.io)和 Django 一起工作？我尝试设置它，即使我将 grunt 文件更改为正确的路径，它仍然使用默认路径。

我只搜索过，但没有人使用这种文件结构。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2013-02-14T04:17:51.890

所以这是我上面的一个非常愚蠢的评论。:-)

这是一个正确的回应！Yeoman 只是一个脚手架工具，让我们快速生成 css、js 和 html 文件。我以完全解耦的方式使用它，与 django 完全分离。

这是前端站点的树结构。

```
/Users/calvin/work/yeoman-test/
|~app/
| |~scripts/
| | |~controllers/
| | | `-main.js
| | |~vendor/
| | | |-angular.js
| | | |-angular.min.js
| | | |-es5-shim.min.js
| | | `-json3.min.js
| | `-app.js
| |~styles/
| | |-bootstrap.css
| | `-main.css
| |+views/
| |-.buildignore
| |-.htaccess
| |-404.html
| |-favicon.ico
| |-index.html
| `-robots.txt
|~test/
| |+spec/
| `+vendor/
|-.gitattributes
|-.npmignore
|-Gruntfile.js
|-package.json
`-testacular.conf.js 
```

这是 django 应用程序作为纯 json Web 服务的树结构。使用 django-tastypie。

```
/Users/calvin/work/yeomandjango/
|~deploy/
| |-crontab
| |-gunicorn.conf.py
| |-live_settings.py*
| |-nginx.conf
| `-supervisor.conf
|~requirements/
| `-project.txt
|+static/
|-.gitignore
|-.hgignore
|-__init__.py
|-__init__.pyc
|-dev.db
|-fabfile.py
|-local_settings.py
|-local_settings.pyc
|-manage.py*
|-settings.py
|-settings.pyc
|-urls.py
`-urls.pyc 
```

通过从域和 URL（例如[http://service.mysite.com/api/v1/](http://service.mysite.com/api/v1/) ）运行 django Web 服务，并让我们的前端 yeoman 生成“静态”站点[http://mysite.com](http://mysite.com)根据需要调用这些 API url。

yeoman 生成的 AngularJS 应用程序只需 POSTS/GETS/PUTS/DELETES 由我们的 django-tastypie API 提供的 api 资源/url。

这是您可以考虑的松散耦合配置。

但是，请注意此设置正在执行“跨域 API 请求”。这意味着在我们的“服务器端”django 应用程序中，我们需要处理 CORS。

这是一个示例中间件片段，需要在 django 服务器端实现才能正常工作。

```
import re

from django.utils.text import compress_string
from django.utils.cache import patch_vary_headers

from django import http

try:
    import settings 
    XS_SHARING_ALLOWED_ORIGINS = settings.XS_SHARING_ALLOWED_ORIGINS
    XS_SHARING_ALLOWED_METHODS = settings.XS_SHARING_ALLOWED_METHODS
except:
    XS_SHARING_ALLOWED_ORIGINS = '*'
    XS_SHARING_ALLOWED_METHODS = ['POST','GET','OPTIONS', 'PUT', 'DELETE']

class XsSharing(object):
    """
        This middleware allows cross-domain XHR using the html5 postMessage API.

        Access-Control-Allow-Origin: http://foo.example
        Access-Control-Allow-Methods: POST, GET, OPTIONS, PUT, DELETE
    """
    def process_request(self, request):

        if 'HTTP_ACCESS_CONTROL_REQUEST_METHOD' in request.META:
            response = http.HttpResponse()
            response['Access-Control-Allow-Origin']  = XS_SHARING_ALLOWED_ORIGINS 
            response['Access-Control-Allow-Methods'] = ",".join( XS_SHARING_ALLOWED_METHODS ) 

            return response

        return None

    def process_response(self, request, response):
        # Avoid unnecessary work
        if response.has_header('Access-Control-Allow-Origin'):
            return response

        response['Access-Control-Allow-Origin']  = XS_SHARING_ALLOWED_ORIGINS 
        response['Access-Control-Allow-Methods'] = ",".join( XS_SHARING_ALLOWED_METHODS )

        return response 
```

# windows-8 - Live Connect API Windows 8 应用程序文件源 URL 更改

> ID：14845468
> 
> 赞同：0
> 
> 时间：2013-02-13T02:28:12.270
> 
> 标签：windows-8, liveconnect

我有一个应用程序通过托管在用户 SkyDrive 上的 JSON 文件同步数据。在用户漫游设置中创建文件后，我将 URL 存储到文件中，但它似乎在某些时候发生了变化，我可以弄清楚发生了什么。源 URL 会随机变化吗？当文件被覆盖时？

# javascript - 如何使用正则表达式将 Javascript 多行注释替换为中间的文本

> ID：14845469
> 
> 赞同：0
> 
> 时间：2013-02-13T02:28:13.147
> 
> 标签：javascript, regex

我正在尝试用中间的 javascript 文本替换两个多行注释（在单行上）。我正在使用一个构建工具，它读取整个文件，并且需要在构建过程中替换一个特定的字符串（由注释组成）。

例子：

```
var data = /*testThisDelete:start*/new Date();/*testThisDelete:end*/ 
```

一旦更换，应该这样使用

```
var data = 4.6.88 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T02:34:51.100

您是否在寻找：

```
^.+?(\/\*testThisDelete:start\*\/.+?\/\*testThisDelete:end\*\/)$ 
```

有了这个，你应该能够用你想要的替换第一个匹配的子字符串。

![在此处输入图像描述](../Images/40edee6ef4790e15312de34baac65a0d.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-13T02:37:04.550

尝试这样的事情开始：

```
"your file as a string".replace(new RegExp('/\*testThisDelete\:start.*testThisDelete\:end\*/','m'), '"replacement text"'); 
```

有关许多有用的附加信息，请参阅此帖子：[JavaScript 替换/正则表达式](https://stackoverflow.com/questions/1162529/javascript-replace-regex)

# symfony - 即使在非限制区域，BorisMorel / LdapBundle 也在调用 connect

> ID：14845470
> 
> 赞同：0
> 
> 时间：2013-02-13T02:28:24.310
> 
> 标签：symfony

我已经将 BorisMorel / LdapBundle 2.0 版集成到 Symfony 2.0.16 版中，`^/admin`并且可以正常工作，但是有一个问题 - LDAP 包也参与其中，`^/api`这不是我想要的。API 不应使用 LDAP。我认为添加`IS_AUTHENTICATED_ANONYMOUSLY`for `^/api`as`access_control`选项应该会有所帮助，但它没有 - 它正在尝试连接。

**安全性.yml：**

```
security:
  firewalls:
    restricted_area:
      pattern:          ^/admin
      anonymous:        ~
      provider:         ldap
      imag_ldap:        ~
      form_login:
        login_path:  /login
        check_path:  /login_check
      logout:
        path:           /logout
        target:         /login

  providers:
    ldap:
      id: imag_ldap.security.user.provider

  encoders:
    IMAG\LdapBundle\User\LdapUser: plaintext

  access_control:
    - { path: ^/api$,  roles: IS_AUTHENTICATED_ANONYMOUSLY }
    - { path: ^/login, roles: IS_AUTHENTICATED_ANONYMOUSLY }
    # - { path: ^/,      roles: IS_AUTHENTICATED_FULLY }

  factories:
    - "%kernel.root_dir%/../src/IMAG/LdapBundle/Resources/config/security_factories.xml"

imag_ldap:
  client:
    host: foo.bar.com
    port: 389
    referrals_enabled: 0
    version: 3

  user:
    base_dn: ou=user,dc=bar,dc=com
    name_attribute: uid

  role:
    base_dn: ou=user,dc=bar,dc=com
    name_attribute: cn
    user_attribute: member 
```

**问题：**我怎样才能“关闭”LDAP `^/api`？

# xml - eBay API GetOrders 调用 Half.com 订单返回无结果

> ID：14845474
> 
> 赞同：2
> 
> 时间：2013-02-13T02:28:35.597
> 
> 标签：xml, ebay-api

我肯定有满足这些限制的订单。凭证已被证明有效。为什么这个电话没有返回任何东西？请注意，当我删除

```
<ListingType>Half</ListingType> 
```

然后电话毫无问题地返回我的 eBay 订单。请注意，eBay API 规范确实确认此调用适用于 Half.com 订单。

```
HEADERS:
Content-Type: text/xml
X-EBAY-API-APP-NAME: *****
X-EBAY-API-CALL-NAME: GetOrders
X-EBAY-API-CERT-NAME: *****
X-EBAY-API-COMPATIBILITY-LEVEL: 805
X-EBAY-API-DEV-NAME: *****
X-EBAY-API-SITEID: 0

REQUEST:
<?xml version='1.0' encoding='utf-8'?>
<GetOrdersRequest xmlns="urn:ebay:apis:eBLBaseComponents"> 
    <RequesterCredentials>   
        <eBayAuthToken>*****</eBayAuthToken> 
    </RequesterCredentials> 
    <Pagination>   
        <PageNumber>1</PageNumber>   
        <EntriesPerPage>100</EntriesPerPage> 
    </Pagination> 
    <DetailLevel>ReturnAll</DetailLevel> 
    <ListingType>Half</ListingType> 
    <NumberOfDays>30</NumberOfDays> 
    <WarningLevel>High</WarningLevel>
</GetOrdersRequest>

RESPONSE:
<?xml version="1.0" encoding="UTF-8"?>
<GetOrdersResponse xmlns="urn:ebay:apis:eBLBaseComponents">
    <Timestamp>2013-02-13T01:58:24.294Z</Timestamp>
    <Ack>Success</Ack>
    <Version>807</Version>
    <Build>E807_CORE_BUNDLED_15702123_R1</Build>
    <PaginationResult>
        <TotalNumberOfPages>0</TotalNumberOfPages>
        <TotalNumberOfEntries>0</TotalNumberOfEntries>
    </PaginationResult>
    <HasMoreOrders>false</HasMoreOrders>
    <OrderArray/>
    <OrdersPerPage>100</OrdersPerPage>
    <PageNumber>1</PageNumber>
    <ReturnedOrderCountActual>0</ReturnedOrderCountActual>
</GetOrdersResponse> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-09-26T01:16:21.963

这是一篇旧帖子，但我遇到了类似的问题，如果您还在请求中指定了订单状态，则 GetOrders API 仅适用于 half.com。同样只有两个订单状态值对 half.com 有效。在每个请求中只指定其中一个。基本上，您必须通过“活动”请求获取所有订单，然后进行第二次传递并更新已在另一个请求中发货的订单。

```
<OrderStatus>Active</OrderStatus>

<OrderStatus>Shipped</OrderStatus> 
```

# python - 将工作日添加到日期字段

> ID：14845477
> 
> 赞同：0
> 
> 时间：2013-02-13T02:28:50.917
> 
> 标签：python, mysql, django, date, models

我正在尝试将多个工作日添加到 Django 中的日期字段。这适用于产品订购，我们对不同产品有不同的交货时间，我们希望为每种产品生成一个目标日期。

例如，产品 X 可能需要 10 个工作日才能交付，如果此产品是在 2013 年 1 月 3 日星期五订购的，则目标日期最终应该是 2013 年 3 月 15 日星期五（它不包括订购日期作为一天） .

我环顾四周，似乎有一些 python 库可以做这种事情，但这一切似乎都过于复杂。我认为会有一个相当简单的方法来做到这一点。

** 编辑 **

我现在正在使用 BusinessHours PyPi 包，但似乎遇到了一些问题。

他们给你一个如何调用包的例子。

```
eg: Class:  BusinessHours(datetime1,datetime2,worktiming=[9 ,18],weekends=[6,7],holidayfile=None)

Class Parameters:
datetime1   - The datetime object with the starting date.
datetime2   - The datetime object with the ending date.
worktiming  - The working office hours . A list containing two values start time and end time
weekends    - The days in a week which have to be considered as weekends sent as a list, 1 for monday ...  7 for sunday.
holidayfile - A file consisting of the predetermined office holidays.Each date starts in a new line and currently must only be in the format dd-mm-yyyy

from BusinessHours import BusinessHours
from datetime import datetime
testing = BusinessHours(datetime(2007,10,15),datetime.now())
print testing.getdays() 
```

使用此信息，我制作了以下测试脚本

```
from BusinessHours import BusinessHours
from datetime import datetime
holidaytextfile = 'holidays.txt' 

testing = BusinessHours(datetime(2013,02,01),datetime(2013,02,28),worktiming=[9 ,18],weekends=[6,7],holidayfile=holidaytextfile)
print testing.getdays() 
```

我的假期文件包含以下内容（只是 2 月的一个随机工作日）

```
07-02-2013 
```

当我运行脚本时，出现以下错误。

```
Traceback (most recent call last):
File "business_days", line 9, in ?
print testing.getdays()
File "/usr/lib/python2.4/site-packages/BusinessHours.py", line 63, in getdays
holidate = date(int(year) , int(month) , int(day))
NameError: global name 'date' is not defined 
```

这是包中的代码部分。

```
 60             for definedholiday in definedholidays:
 61                 flag=0;
 62                 day , month , year = definedholiday.split('-')
 63                 holidate = date(int(year) , int(month) , int(day))
 64                 for weekend in self.weekends:
 65                      #check if mentioned holiday lies in defined weekend , shouldnt deduct twice
 66                     if(holidate.isoweekday==weekend):
 67                         flag=1;
 68                         break; 
```

感谢任何人给我的任何帮助，我的 Python 版本是 2.4.3

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T02:53:55.577

你检查过这个问题吗？我相信它可能会用几行代码回答你的问题。

[python-count-days-忽略周末](https://stackoverflow.com/a/3615984/1822062)

# ruby-on-rails - 无法加载此类文件 -- openssl (LoadError)

> ID：14845481
> 
> 赞同：49
> 
> 时间：2013-02-13T02:29:54.153
> 
> 标签：ruby-on-rails, rvm

在 rvm 的 OS X 中，如何检查 openssl 是否配置正确？我得到了`cannot load such file -- openssl (LoadError)` 并且我已经尝试了[Rails 3 中的所有内容 - 没有要加载的此类文件 - openssl](https://stackoverflow.com/questions/3464098/rails-3-no-such-file-to-load-openssl)没有成功。

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2013-02-13T04:17:39.093

检查安装了哪些红宝石：

```
rvm list 
```

然后确保使用已安装的红宝石之一：

```
rvm use 1.9.3-p327 
```

并测试是否`openssl`可用：

```
ruby -ropenssl -e "puts :OK" 
```

`OK`如果启用它会打印`openssl`，否则你会得到异常

## 如果出现异常 =>

### 更新：

新版本的 rvm 改进了自动化支持：

```
rvm get stable
rvm autolibs enable
rvm reinstall all --force 
```

### 老的：

跑：

```
rvm requirements run force
rvm pkg remove 
```

其次是：

```
rvm reinstall all --force 
```

此指令不是 OSX 特定的，它适用于所有平台，尽管在 OSX 上它最适合 HomeBrew，当它未安装时，只会显示所需软件的列表，您需要手动安装它。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2020-09-16T06:58:29.790

多年后，由于 brew 升级，解决方案发生了变化，现在可以使用：

```
# pull full brew git repo
git -C "/usr/local/Homebrew/Library/Taps/homebrew/homebrew-core" fetch --unshallow

# generate new brew tap repo
brew tap-new $USER/old-openssl

# extract openssl 1.0.2t forumlar to $USER/old-openssl
brew extract --version=1.0.2t openssl $USER/old-openssl

# install old openssl from $USER/old-openssl repo
brew install openssl@1.0.2t

# reinstall ruby
rvm reinstall 2.3.4 --with-openssl-dir=`brew --prefix openssl@1.0.2t` 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2020-07-12T18:52:06.613

尝试这个。

```
rvm install ruby-2.0.0-preview1  --with-openssl-dir=$HOME/.rvm/usr --verify-downloads 1 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-02-18T10:11:44.353

我卸载了我的 macbook 上的所有东西（rvm、rails、ruby 等）。

安装自制软件

安装的 rvm

冉`rvm requirements run force`

冉`rvm install rails`

`rails new sample_app`

`cd sample_app`

*注意：* `source 'https://rubygems.org'`存在于 Gemfile 中，需要 openssl！

`bundle install` **它奏效了**！

**无需指定：** `--with-openssl-dir=$HOME/.rvm/usr`

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2013-09-06T03:18:08.457

要解决此问题，**请安装 openssl（最好使用 brew）**。

将 Xcode 更新到最新版本并使用它**启用命令行安装**。

重新安装 rvm 使用 `rvm reinstall all`

请注意，这`rvm reinstall all --force` 将删除您以前使用 rvm 完成的所有二进制文件/pkg 安装。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2022-01-17T22:55:58.023

我得到了同样的错误，并且通过打开新的终端会话来修复错误。

我正在使用`frum`ruby​​ 版本管理器。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-06-23T22:58:37.423

假设 ruby​​ 已经安装，请执行以下操作：

```
rvm cleanup all

rvm reinstall all --force 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2019-03-27T07:26:51.130

`gem install openssl`
为我工作，但没有任何声明取决于openssl，它很奇怪

* * *

## 回答 #9

> 赞同：-4
> 
> 时间：2021-02-04T10:52:43.697

以下命令解决了我的问题注释 2.3.4 是我正在使用的 ruby​​ 版本，根据您的要求进行更改

```
rvm reinstall 2.3.4 --with-openssl-dir=$rvm_path/usr 
```

使用 command 确保 $rvm_path 已正确设置`echo $rvm_path`。如果此路径为空，请检查您的主文件夹是否有`.rvm`文件夹。

在这种情况下使用

```
rvm reinstall 2.3.4 --with-openssl-dir=~/.rvm/usr 
```

# c# - 不同编程语言中的 Windows 小工具样式行为

> ID：14845485
> 
> 赞同：1
> 
> 时间：2013-02-13T02:30:19.963
> 
> 标签：c#, java, visual-studio, desktop, windows-desktop-gadgets

我真的不知道从哪里开始解决这个问题，所以如果这是一个广泛的问题，我提前道歉。

我想用一种编程语言（可能是 C#、Java、Visual Basic）开发一个应用程序，并让它像 Windows 小工具一样运行；我希望它的行为就像嵌入在 Windows 桌面中一样。小工具似乎在 Windows 8 中被逐步淘汰，所以我不知道这种方法是否最好。我想开发一个“新闻提要”风格的应用程序，并希望它的行为就像它实际上是桌面的一部分一样。

是否可以通过使用我选择的编程语言并模拟小工具行为来实现这一点？或者我是否仅限于使用 Gadget API 创建小工具？

或者我只是想太多;P提前谢谢你！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T02:40:47.653

当然，你可以在 C#.NET 中轻松做到这一点。即创建一个没有最小化/关闭按钮的无边框表单，当其他应用程序位于顶部时，它将保留在后台。

# android - 使用 UserSettingsFragment 登录后要做什么

> ID：14845486
> 
> 赞同：0
> 
> 时间：2013-02-13T02:30:39.840
> 
> 标签：android, facebook, facebook-login

因此，我能够使用 UserSettingsFragment 成功登录和注销，但在登录后我似乎无法获得任何其他功能。我想在成功登录后用我自己的片段替换 UserSettingsFragment 和我当前的代码不工作是这样的：

```
@Override
protected void onActivityResult(int requestCode, int resultCode, Intent data) {
    userSettingsFragment.onActivityResult(requestCode, resultCode, data);
    super.onActivityResult(requestCode, resultCode, data);
    uiHelper.onActivityResult(requestCode, resultCode, data);        
    FacebookHelperFragment fbhf = new FacebookHelperFragment();
    FragmentManager fm = getSupportFragmentManager();
    fm.beginTransaction().replace(R.id.fb_helper_frag, fbhf)
            .addToBackStack(null).commit();
} 
```

当我运行它时，fbhf 似乎在屏幕上瞬间闪烁，但随后它立即返回显示来自 UserSettingsFragment 的默认登录屏幕，该屏幕显示登录用户的名称和带有注销按钮的图片。另外，我真的不想使用任何已弃用的代码。是否有人真正使用 UserSettingsFragment，除了仅注销或作为 SessionLoginSample 的一部分之外，我没有看到太多使用它。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T10:47:17.757

答案在我睡梦中浮现。

```
 @Override
protected void onActivityResult(int requestCode, int resultCode, Intent data) {
    userSettingsFragment.onActivityResult(requestCode, resultCode, data);
    super.onActivityResult(requestCode, resultCode, data);
    uiHelper.onActivityResult(requestCode, resultCode, data);
    if (resultCode == -1) {
        FacebookHelperFragment fbhf = new FacebookHelperFragment();
        FragmentManager fm = getSupportFragmentManager();
        fm.beginTransaction().hide(userSettingsFragment)
                .add(R.id.fb_helper_frag, fbhf).addToBackStack(null)
                .commit();
    }
} 
```

只需要在动态添加我的 FacebookHelperFragment 之前隐藏静态 userSettingsFragment。

# php - jBBCode - BBcode 到 html

> ID：14845487
> 
> 赞同：3
> 
> 时间：2013-02-13T02:30:43.820
> 
> 标签：php, bbcode

### 我正在尝试做的事情

我正在尝试使用[jBBCode](http://jbbcode.com/)将 bbcode 解析到 html 和从 html 解析。

### 问题

当试图获取 html 并将其转回 bbcode 时，它​​只显示 html。这是我用来尝试将 html 切换回 bbcode 的代码。

```
$parser = new JBBCode\Parser();
$parser->loadDefaultCodes();

$parser->parse($MYHTMLSTRING);

echo $parser->getAsBBCode(); 
```

有谁知道我在这里做错了什么？我敢肯定这是我没有弄清楚的非常简单的事情。任何帮助表示赞赏！:D

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T02:40:45.330

**`$parser->parse()`将 BBCode 作为输入，而不是 HTML。**

在研究了文档之后，我的理解是这是一个单向解析器：

BBCode -> HTML

我相信设计是让您将 BBCode 存储在您的数据库中，然后当需要向访问者呈现 HTML 时，您会在那时解析 BBCode。

这样，您始终将原始的、可编辑的 BBCode 存储在数据库中。

这是一种非常常见的设计模式。例如，对于使用 Markdown 语言（而不是 BBCode）的应用程序，它们通常将原始 Markdown 存储在数据库中，并且仅在页面加载时将其呈现为 HTML。

**总之：**

1.  在您的数据库中存储原始 BBCode/文本
2.  当您将页面呈现给访问者时，您会在那时进行转换（转换为 HTML）。

    *   $parser->parse($MyBBCode); 回声 $parser->getAsHTML();
3.  如果用户编辑 BBCode，将其直接保存回 DB 作为 BB Code

[文档参考](http://jbbcode.com/docs#DocumentElement)

# python - 模拟浏览器下载文件？

> ID：14845491
> 
> 赞同：16
> 
> 时间：2013-02-13T02:31:06.657
> 
> 标签：python, shell, mechanize, wget

网络上有一个 FLV 文件，可以直接在 Chrome 中下载。该文件是一个电视节目，由CCTV（中央电视台）出版。CCTV 是一家由中国纳税人资助的非营利性国有广播公司，它允许我们在不侵犯版权的情况下下载他们的内容。

使用`wget`，我可以从其他地址下载文件，但不能从 Chrome 中的地址下载。

这是我试图做的：

```
url='http://114.80.235.200/f4v/94/163005294.h264_1.f4v?10000&key=7b9b1155dc632cbab92027511adcb300401443020d&amp;playtype=1&amp;tk=163659644989925531390490125&amp;brt=2&amp;bc=0&amp;nt=0&amp;du=1496650&amp;ispid=23&amp;rc=200&amp;inf=1&amp;si=11000&amp;npc=1606&amp;pp=0&amp;ul=2&amp;mt=-1&amp;sid=10000&amp;au=0&amp;pc=0&amp;cip=222.73.44.31&amp;hf=0&amp;id=tudou&amp;itemid=135558267&amp;fi=163005294&amp;sz=59138302'  

wget -c  $url --user-agent="" -O  xfgs.f4v 
```

这也不起作用：

```
wget -c  $url   -O  xfgs.f4v 
```

输出是：

```
Connecting to 118.26.57.12:80... connected.  
HTTP request sent, awaiting response... 403 Forbidden  
2013-02-13 09:50:42 ERROR 403: Forbidden. 
```

我究竟做错了什么？

我最终想用 Python 库下载它`mechanize`。这是我为此使用的代码：

```
import mechanize  
br = mechanize.Browser()  
br = mechanize.Browser()  
br.set_handle_robots(False)  
br.set_handle_equiv(False)   
br.addheaders = [('User-agent', 'Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.9.0.1) Gecko/2008071615 Fedora/3.0.1-1.fc9 Firefox/3.0.1')]  
url='http://114.80.235.200/f4v/94/163005294.h264_1.f4v?10000&key=7b9b1155dc632cbab92027511adcb300401443020d&amp;playtype=1&amp;tk=163659644989925531390490125&amp;brt=2&amp;bc=0&amp;nt=0&amp;du=1496650&amp;ispid=23&amp;rc=200&amp;inf=1&amp;si=11000&amp;npc=1606&amp;pp=0&amp;ul=2&amp;mt=-1&amp;sid=10000&amp;au=0&amp;pc=0&amp;cip=222.73.44.31&amp;hf=0&amp;id=tudou&amp;itemid=135558267&amp;fi=163005294&amp;sz=59138302' 
r = br.open(url).read()  
tofile=open("/tmp/xfgs.f4v","w")  
tofile.write(r)  
tofile.close() 
```

这是结果：

```
Traceback (most recent call last):  
  File "<stdin>", line 1, in <module>  
  File "/usr/lib/python2.7/dist-packages/mechanize/_mechanize.py", line 203, in open  
   return self._mech_open(url, data, timeout=timeout)  
  File "/usr/lib/python2.7/dist-packages/mechanize/_mechanize.py", line 255, in _mech_open  
raise response  
mechanize._response.httperror_seek_wrapper: HTTP Error 403: Forbidden 
```

谁能解释一下如何让`mechanize`代码工作？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-02-22T15:25:22.950

首先，如果您尝试进行任何类型的抓取（是的，即使您不一定解析 HTML，这也算作抓取），您需要执行一定数量的初步调查。

如果您还没有[Firefox](http://www.mozilla.org/en-US/firefox/new/)和[Firebug](http://getfirebug.com/)，请获取它们。然后，如果您还没有[Chrome](https://www.google.com/intl/en/chrome/browser/)，请获取它。

启动 Firefox/Firebug 和 Chrome，清除所有 cookie/etc。然后打开 Firebug，在 Chrome 中打开 View->Developer->Developer Tools。

然后加载您要抓取的视频的主页。注意页面加载时设置的任何 cookie/headers/POST 变量/查询字符串变量。您可能希望将此信息保存在某处。

然后尝试下载视频，再次注意加载视频时设置的所有 cookie/headers/post 变量/查询字符串变量。最初加载页面时很可能设置了 cookie 或 POST 变量，这是实际提取视频文件所必需的。

当您编写 Python 时，您将需要尽可能地模拟这种交互。使用[python-requests](http://docs.python-requests.org/en/latest/)。这可能是可用的最简单的 URL 库，除非你以某种方式碰壁（这是它做不到的），否则我永远不会使用其他任何东西。在我开始使用[python-requests](http://docs.python-requests.org/en/latest/)的那一刻，我所有的 URL 获取代码都缩小了 5 倍。

现在，当你第一次尝试时，事情可能不会奏效。Soooo，您将需要使用 python 加载主页。打印出所有 cookie/headers/POST 变量/查询字符串变量，并将它们与 Chrome/Firebug 所拥有的进行比较。然后尝试加载您的视频，再次比较所有这些值（这意味着您发送给服务器的内容，以及服务器发回给您的内容）。你需要弄清楚它们之间有什么不同（别担心，我们都在幼儿园学过这个......“其中一个与另一个不同”）并剖析这种差异是如何破坏东西的。

如果在所有这些结束时，您仍然无法弄清楚，那么您可能需要查看包含电影链接的页面的 HTML。在页面中查找任何 javascript。然后使用 Firebug/Chrome 开发工具检查 javascript 并查看它是否正在对您的用户会话进行某种管理。如果它以某种方式生成与视频访问相关的令牌（cookie 或 POST/GET 变量），您将需要在 python 中模拟其令牌化方法。

希望所有这些都会有所帮助，并且看起来不会太吓人。关键是你需要成为一名科学家。弄清楚你知道什么，你不知道什么，你想要什么，然后开始试验和记录你的结果。最终会出现一个模式。

**编辑：**澄清步骤

1.  调查如何维护状态
2.  使用 python 拉初始页面，从中获取您需要的任何状态信息
3.  执行该状态信息可能需要的任何标记化
4.  使用步骤 2 和 3 中的令牌拉取视频
5.  如果出现问题，输出您的请求/响应标头、cookie、查询变量、发布变量，并将它们与 Chrome/Firebug 进行比较
6.  返回步骤 1。直到找到解决方案

**编辑：** 您也可能会在这些请求之一（html页面或文件下载）处获得重定向。如果发生这种情况，您很可能会错过 Firebug/Chrome 中的请求/响应。解决方案是使用像[LiveHTTPHeaders](http://livehttpheaders.mozdev.org/)这样的嗅探器，或者像其他响应者[WireShark](http://www.wireshark.org/)或[Fiddler](http://www.fiddler2.com/fiddler2/)所建议的那样。请注意，如果您使用的是 Linux 或 OSX 机器，Fiddler 对您没有好处。它仅适用于 Windows，并且绝对专注于 .NET 开发......（呃）。Wireshark 非常有用，但对于大多数问题来说都是多余的，并且根据您运行的机器，您可能无法使其正常工作。所以我会首先建议 LiveHTTPHeaders。

我喜欢这种问题

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-13T03:02:11.847

mechanize 似乎可以进行有状态浏览，这意味着它将在浏览器请求之间保留上下文和 cookie。我建议先加载视频所在的完整页面，然后再尝试明确下载视频。这样，网络服务器会认为这是一个完整的（合法的）浏览会话正在进行

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-02-22T07:05:25.443

假设您没有手动输入 URL，请使用 mechanize 首先转到您从中获取该 URL 的页面。然后模拟您下载实际文件的操作（可能单击链接或按钮）。

这可能不起作用，因为 Mechanize 保持 cookie 和重定向的状态，但不处理对 html 页面的任何 JavaScript 实时更改。要检查 JavaScript 是否对操作至关重要，请在 Chrome（或任何其他浏览器）中切换 JavaScript，并确保您可以下载文件。如果需要 JavaScript，我会尝试以编程方式驱动浏览器来获取文件。

我通常尝试这种刮擦的方法是

1.  尝试 wget 或 pythons urllib2
2.  尝试机械化
3.  驱动浏览器

除非有一些验证码，否则最后一个通常有效，但其他验证码更容易（更快）。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2013-02-16T04:19:25.130

1.  您可以在浏览器中使用[`selenium`](http://selenium-python.readthedocs.org/en/latest/)或[`watir`](http://watir.com/)执行您需要的所有操作。
2.  由于您不想看到浏览器，[因此可以运行 selenium headless](http://blog.moove-it.com/running-selenium-on-a-headless-server-and-running-tests-with-phpunit/)。

另请参阅[此答案](https://stackoverflow.com/questions/802225/how-do-i-use-mechanize-to-process-javascript)。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2013-02-19T06:29:35.017

为了澄清问题的“为什么”部分，您可以通过调试代理路由浏览器和代码请求。如果您使用的是 Windows，我建议您使用 fiddler2。其他平台也存在其他调试代理。但 fiddler2 绝对是我的最爱。

[http://www.fiddler2.com/fiddler2/](http://www.fiddler2.com/fiddler2/)

[https://www.owasp.org/index.php/Category:OWASP_WebScarab_Project](https://www.owasp.org/index.php/Category:OWASP_WebScarab_Project)

[http://www.charlesproxy.com/](http://www.charlesproxy.com/)

或者更底层的 [http://netcat.sourceforge.net/](http://netcat.sourceforge.net/)

[http://www.wireshark.org/](http://www.wireshark.org/)

一旦你知道了这些差异，想出一个解决方案通常会简单得多。我怀疑有关有状态浏览/ cookie 的其他答案是正确的。使用上述工具，您可以分析这些 cookie 并推出合适的解决方案，而无需浏览器自动化。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2013-02-21T11:38:55.307

我认为许多站点使用仅存在于您的会话中的临时链接。url 中的代码可能类似于您的会话 ID。这意味着特定链接将永远无法再次工作。

您必须使用一些容纳此会话的库（如其他答案中提到的）重新打开包含链接的页面。然后尝试找到该链接并仅在此会话中使用它。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2013-02-20T10:39:21.810

[有一个名为ghost](http://jeanphix.me/Ghost.py)的开源 Python 库，它封装了一个无头 WebKit 浏览器，因此您可以通过一个简单的 API 控制一切：

```
from ghost import Ghost
ghost = Ghost()

page, resources = ghost.open('http://my.web.page') 
```

它支持 cookie、JavaScript 和其他一切。您可以将 JavaScript 注入页面，虽然它是无头的，因此它不会以图形方式呈现任何内容，但您仍然拥有 DOM。这是一个完整的浏览器。

它不会很好地扩展，但它很有趣，并且当您需要接近完整浏览器的东西时可能会很有用。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2013-06-30T12:03:07.423

虽然当前接受的答案（由 G. Shearer 提供）是一般抓取的最佳建议，但我找到了一种跳过几个步骤的方法 - 使用[名为 cliget 的 firefox 扩展](https://addons.mozilla.org/en-us/firefox/addon/cliget/)，它将请求上下文与所有 http 标头和cookie 并生成复制到剪贴板的`curl`（或）命令。`wget`

**编辑**：firebug 的网络面板和 chrome 调试器也提供此功能 - 右键单击​​请求，“复制为 curl”

大多数情况下，您会收到一个非常冗长的命令，其中包含一些显然不需要的标头，但是您可以一个一个地删除这些命令，直到服务器拒绝请求，而不是相反（老实说，我觉得令人沮丧 - 我经常得到一直在思考请求中缺少什么标头）。

（此外，您可能希望从命令行中删除该`-O`选项`curl`以在标准输出中查看结果，而不是将其下载到文件中，并添加`-v`以查看完整的标题列表）

即使您不想使用 curl/wget，将一个 curl/wget 命令行转换为 python 代码也只是知道如何将标头添加到 urllib 请求（或任何 http 请求库）

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-02-22T10:34:53.917

您是否尝试过请求模块？它比 urllib2 和 pycurl 等使用起来简单得多，但它很强大。它具有以下特点：链接在[这里](http://docs.python-requests.org/en/latest/)

*   国际域名和 URL*   保持活动和连接池*   具有 Cookie 持久性的会话*   浏览器式 SSL 验证*   基本/摘要认证*   优雅的键/值 Cookie*   自动减压*   Unicode 响应体*   多部分文件上传*   连接超时*   .netrc 支持*   Python 2.6—3.3*   线程安全。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-02-17T18:23:03.490

```
from urllib import urlopen
print urlopen(url) #python built-in high level interface to get ANY online resources, auto responds to HTTP error codes. 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-02-22T20:54:31.523

您可以使用[Internet 下载管理器](http://www.internetdownloadmanager.com/) ，它能够从任何网站捕获和下载任何流媒体

# hibernate - Tomcat 上的 Spring Security/JSF/Hibernate 意外会话劫持？

> ID：14845493
> 
> 赞同：6
> 
> 时间：2013-02-13T02:31:14.250
> 
> 标签：hibernate, tomcat, spring-security, omnifaces, session-hijacking

前几天我发生了一件非常奇怪和尴尬的事情，我无法用语言来描述发生的事情。

我的应用程序在 Tomcat 7 上运行与 JSF 2.1、Hibernate 4、Spring Security 集成的 Spring 3。我通过电话与 C 级别的重要人物通话，我们同时在同一页面上同时在测试环境中。当他的页面出现我的个人帐户详细信息时，他几乎在同一时刻导航到我正在导航的页面。我不相信他，所以我走到他的办公室，果然，他不知何故以我的帐户登录，而他没有密码。

该应用程序将保护患者的健康信息，因此我被要求向 C 级人员提供一份完整的报告，说明所发生的事情，但我不知道这是怎么可能的。我搜索了代码库，一无所获。我试图在多个场合重现确切的场景，但始终无法重现。我什至没有一个我满意的有根据的猜测。

我认为可能对存储在 Tomcat 应用程序上下文实现中的会话进行了一些不安全的线程操作，但如果它不可重现，我无法证明这一点。我还认为，由于 Spring Security 在其他请求和转发之前作为过滤器运行，因此可能其他 servlet 过滤器之一受到干扰。另外两个是我最近添加的 Primefaces 文件上传过滤器和 Omnifaces SEO 过滤器。

Omnifaces 过滤器确实干扰了 Primefaces 文件上传过滤器，我不得不修改它的配置，这样它们两个才能很好地相互配合，所以我仍然觉得这也可能是一种可能性。

Spring Security 是否有任何已知的错误导致类似的问题？Tomcat 是否存在关于从 ApplicationContext 意外提供错误会话状态的已知问题？有没有其他人遇到过类似的问题或对此有一些独特的见解？

**编辑：**发布后不久，我发现了这个，仅在几天前发布：

[会话混合 - apache httpd 与 mod_jk、tomcat、spring security - 提供其他用户的数据](https://stackoverflow.com/questions/14731806/session-mix-up-apache-httpd-with-mod-jk-tomcat-spring-security-serving-dat)

它几乎与我在 Tomcat 前面安装 Apache httpd+mod_jk 插件的设置完全相同，所以我肯定不是疯了 :)

**更新：**

我能够在没有 mod_jk 或 Apache 的情况下在我的开发环境中重现该问题，因此我可以可靠地将其排除为罪魁祸首。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-13T18:58:03.493

我想到了 ：）

这是一种开发人员的错误，但它也是 Spring 的一个荒谬的默认行为。我有一个名为 SessionBean 的 JSF 托管 Bean，我声明为`@SessionScope`. 当您集成 JSF 和 Spring 时，JSF 依赖注入与 Spring 依赖注入发生冲突，因此 Spring 重写了处理该问题的 JSF 模块，以仅包装 Spring DI。因此，当我将 JSF ManagedBean 声明为 Session Scoped 时，我还必须给它一个`@Controller`注解，以便它也被识别为 Spring Bean。

事实证明，Spring 并不理解 JSF`@RequestScoped`和`@SessionScoped`注释。Spring 有自己的注解，简称为`@Scope(value = "request|session|singleton?|etc...")`。

因为 Spring 无法识别我设置的 JSF 范围，所以它将新创建的 bean 视为 bean 的默认值，即 SINGLETON。

因此，每次有人登录时，它都会覆盖我用来缓存从身份验证主体获取的登录用户的属性。然后每个做任何事情的人都以不同的用户身份登录。

顺便说一句，Nice of Spring*警告*您错误配置了该死的 bean。

感谢大家的帮助，我希望这对未来的访客有所帮助！

# php - 根据 URL 的结尾使用 simple_html_dom 获取特定的 URL

> ID：14845504
> 
> 赞同：1
> 
> 时间：2013-02-13T02:32:27.323
> 
> 标签：php, html, simple-html-dom

我需要根据 URL 的结尾使用 simple_html_dom 获取 URL。URL 没有使其唯一的特定类。它唯一的独特之处在于它以一组特定的数字结尾。我只是想不出正确的语法来获取特定的 URL 然后打印它。

有什么帮助吗？

例子：

```
<table class="findList">
<tr class="findResult odd"> <td class="primary_photo"> <a href="/title/tt0080487/?ref_=fn_al_tt_1" ><img src="http://ia.media-imdb.com/images/M/MV5BNzk2OTE2NjYxNF5BMl5BanBnXkFtZTYwMjYwNDQ5._V1_SY44_CR0,0,32,44_.jpg" height="44" width="32" /></a> </td> 
```

那是表格开头的代码。第一个 href 是我想要获取的。该表继续提供更多链接等，但这与我想要的无关。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T09:00:23.943

对于第一个带有以 1 结尾的 href 的 a：

```
$dom->find('a[href$="1"]', 0); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T22:29:13.437

您可以简单地使用 DOMdocument

```
<?php 
$html = '
<table class="findList">
<tr class="findResult odd"> 
    <td class="primary_photo"> 
        <a href="/title/tt0080487/?ref_=fn_al_tt_1" ><img src="http://ia.media-imdb.com/images/M/MV5BNzk2OTE2NjYxNF5BMl5BanBnXkFtZTYwMjYwNDQ5._V1_SY44_CR0,0,32,44_.jpg" height="44" width="32" /></a> 
    </td>
';

$dom = new DOMDocument();
@$dom->loadHTML($html);
foreach($dom->getElementsByTagName('td') as $td) {
    if($td->getAttribute('class') == 'primary_photo'){
        $a = $td->getElementsByTagName('a')->item(0)->getAttribute('href');
    }
}
echo $a; // title/tt0080487/?ref_=fn_al_tt_1

//Or if your looking to get the img tag
$dom = new DOMDocument();
@$dom->loadHTML($html);
foreach($dom->getElementsByTagName('td') as $td) {
    if($td->getAttribute('class') == 'primary_photo'){
        $a = $td->getElementsByTagName('img')->item(0)->getAttribute('src');
    }
}

echo $a; // http://ia.media-imdb.com/images/M/MV5BNzk2OTE2NjYxNF5BMl5BanBnXkFtZTYwMjYwNDQ5._V1_SY44_CR0,0,32,44_.jpg
?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-14T17:14:28.153

假设您将 html 放在名为“tables.html”的文件中，这将起作用。它读取文件，找到所有“a”链接，将它们放入数组中，第一个 ($anchors[0]) 就是您想要的。然后你用 $anchors[0]->href 从中获取 href。

```
$html = new simple_html_dom(); 

$html->load_file('tables.html');

$anchors = $html->find("a");

echo $anchors[0]->href; 
```

# xcode - Xcode 为多种表单重用区域/视图的最佳方式

> ID：14845510
> 
> 赞同：1
> 
> 时间：2013-02-13T02:33:17.707
> 
> 标签：xcode

我是 Xcode 的新手，正在启动一个通用应用程序。在 iPad 版本中，我想将主要部分重新用于不同的搜索表单。

我希望用户在左侧菜单上的每个按钮的右侧部分（见图）中看到完全不同的表单。

我正在以编程方式工作。

![在此处输入图像描述](../Images/426ab134b1240532a60e3e3f4ad11030.png)

在这种情况下更改内容的最佳方法是什么？（牢记性能和编码复杂性）

编辑：这是一个标准的选项卡式应用程序，而不是拆分视图。我是否可以为每个表单创建一个新的视图控制器和 .xib，然后通过将它们嵌入到此屏幕上的 UIView 或 UIWindow 中来更改显示哪个？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-17T09:46:56.850

您在编辑中找到了正确的答案。据我了解，侧面的按钮类似于另一个标签栏控制器，但嵌套在您的主标签栏控制器中？

您不妨遵循相同的模式，因为它是一种熟悉的模式。你的搜索视图控制器应该作为一个[容器视图控制器](http://developer.apple.com/library/ios/featuredarticles/ViewControllerPGforiPhoneOS/CreatingCustomContainerViewControllers/CreatingCustomContainerViewControllers.html)，它有一个代表每个表单选项的视图控制器数组。

在选项之间切换时，从视图层次结构（使用`addSubview`）*和*视图控制器层次结构（使用链接中“添加和删除子项”中的代码）添加/删除适当的视图控制器视图。视图控制器层次结构对于确保在您的子控制器上调用 viewDidAppear 等非常重要。

作为说明，我创建了一个简单的演示项目，其中主视图控制器有一组按钮，每个按钮都链接到相同的操作，以及包含的视图控制器数组。包含的视图控制器将保存`container`在本例中调用的子视图中。这将是上面屏幕截图中右侧区域的大小。

`viewDidLoad`子控制器在容器视图控制器中设置如下：

```
@property (strong, nonatomic) IBOutletCollection(UIButton) NSArray *buttons;
@property (weak, nonatomic) IBOutlet UIView *container;

@property (nonatomic,strong) NSArray *viewControllers;
@property (nonatomic, strong) UIViewController *currentChild;

@end

@implementation JRTViewController

- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view, typically from a nib.

    for (UIButton *button in self.buttons)
        [button addTarget:self action:@selector(buttonTapped:) forControlEvents:UIControlEventTouchUpInside];

    NSMutableArray *children = [NSMutableArray new];

    for (int i = 0; i < 4; i++)
    {
        ContainedViewController *child = [ContainedViewController new];
        child.name = [NSString stringWithFormat:@"Form %d",i + 1];
        [children addObject:child];
    }

    self.viewControllers = [children copy];
    [self buttonTapped:self.buttons[0]];
} 
```

在这里，我使用了同一个视图控制器类的四个实例——它只有一个标签，它指示您正在选择哪种形式。真的，每个人都有不同的课程。我还通过发送第一个按钮的操作方法“选择”了初始视图控制器。动作方法这样做：

```
- (IBAction)buttonTapped:(UIButton *)sender
{
    NSUInteger index = [self.buttons indexOfObject:sender];
    if (index != NSNotFound)
        self.currentChild = self.viewControllers[index];
} 
```

它从视图控制器数组中选择适当的 VC。setter 方法执行此操作：

```
-(void)setCurrentChild:(UIViewController *)currentChild
{
    if (currentChild == _currentChild) return;

    // Remove the old child
    [_currentChild willMoveToParentViewController:nil];
    [_currentChild.view removeFromSuperview];
    [_currentChild removeFromParentViewController];
    [_currentChild didMoveToParentViewController:nil];

    // Add the new one
    [currentChild willMoveToParentViewController:self];
    [self.container addSubview:currentChild.view];
    NSDictionary *views = @{@"view":currentChild.view};
    [self.container addConstraints:[NSLayoutConstraint constraintsWithVisualFormat:@"|[view]|" options:0 metrics:nil views:views]];
    [self.container addConstraints:[NSLayoutConstraint constraintsWithVisualFormat:@"V:|[view]|" options:0 metrics:nil views:views]];
    [self addChildViewController:currentChild];
    [currentChild didMoveToParentViewController:self];
    _currentChild = currentChild;
} 
```

它设置视图控制器层次结构，添加视图并使用约束使其填充容器。

在此示例中，我在演示子视图控制器的添加和切换时硬编码了四个按钮和四个子视图控制器。实际上，您会使其更像一个标签栏控制器，您可以在其中分配一组视图控制器，并且容器将创建自己的按钮数组。

# ruby-on-rails - Rails 应用程序启动时出现 Libxml-ruby 错误——未初始化常量 LibXML::XML::Error::I18N

> ID：14845512
> 
> 赞同：2
> 
> 时间：2013-02-13T02:33:32.380
> 
> 标签：ruby-on-rails, libxml-ruby

我刚刚更新到 Rails 3.2.12，Bundler 也将 libxml-ruby 从 2.4.0 更新到了 2.5.0。当我重新启动生产服务器（nginx）或尝试打开控制台时，我得到：

```
/home/cceom/webapps/rails2/gems/gems/libxml-ruby-2.5.0/lib/libxml/error.rb:10:in `const_get': uninitialized constant LibXML::XML::Error::I18N (NameError)
    from /home/cceom/webapps/rails2/gems/gems/libxml-ruby-2.5.0/lib/libxml/error.rb:10:in `block (2 levels) in <class:Error>'
    from /home/cceom/webapps/rails2/gems/gems/libxml-ruby-2.5.0/lib/libxml/error.rb:8:in `each'
    from /home/cceom/webapps/rails2/gems/gems/libxml-ruby-2.5.0/lib/libxml/error.rb:8:in `block in <class:Error>'
    from /home/cceom/webapps/rails2/gems/gems/libxml-ruby-2.5.0/lib/libxml/error.rb:7:in `tap'
    from /home/cceom/webapps/rails2/gems/gems/libxml-ruby-2.5.0/lib/libxml/error.rb:7:in `<class:Error>'
    from /home/cceom/webapps/rails2/gems/gems/libxml-ruby-2.5.0/lib/libxml/error.rb:5:in `<module:XML>'
    from /home/cceom/webapps/rails2/gems/gems/libxml-ruby-2.5.0/lib/libxml/error.rb:4:in `<module:LibXML>'
    from /home/cceom/webapps/rails2/gems/gems/libxml-ruby-2.5.0/lib/libxml/error.rb:3:in `<top (required)>'
    from /home/cceom/webapps/rails2/gems/gems/libxml-ruby-2.5.0/lib/libxml.rb:11:in `<top (required)>'
    from /home/cceom/webapps/rails2/gems/gems/libxml-ruby-2.5.0/lib/xml.rb:13:in `<top (required)>' 
```

我的开发盒上没有同样的问题。

我所能想到的是，2.5.0 gem 仍然引用旧的 2.4.0 编译库，并且其中没有定义特定的常量。但不知道这将如何发生，也不知道如何纠正它。也不管这是否正确。

任何想法都会受到欢迎。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T15:33:39.923

我有同样的问题，它在生产上失败，但在本地工作。我尝试将 gem libxml-ruby 的版本冻结到 2.4.0，它就像一个魅力。

希望能帮助到你！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-17T05:52:20.277

该问题发生在旧版本的 libxml 上。我刚刚发布了 libxml-ruby 的更新版本 2.6.0，应该可以解决这个问题。

# ruby-on-rails - Heroku Rake 任务不理解 Rand 方法

> ID：14845515
> 
> 赞同：1
> 
> 时间：2013-02-13T02:33:48.520
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, heroku, rake

我创建了一个 rake 任务，在其中我有一条线

```
number = rand(1..10) 
```

当我在我的开发机器上运行它时，一切都很好，但是，当我在 Heroku 上运行它时，我返回了一个错误

```
rake aborted!
can't convert Range into Integer
/app/lib/tasks/sample_data.rake:57:in `rand' 
```

我应该注意到，在 rake 任务的早期，我`rand(111)`没有失败地运行。`rand`我必须假设问题是由于我设置了可供选择的起点和终点造成的。

所以最大的问题是，为什么 Heroku 将`rand`其视为一个范围而不是一个整数，我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-13T02:43:10.063

`rand()`在 Ruby 1.9.3 中添加了范围支持。您可能在 Heroku 上运行 1.9.2（默认）。`ruby "1.9.3"`您可以通过添加到您的 Gemfile在 Heroku 上运行 1.9.3 。

*   [http://www.ruby-doc.org/core-1.9.2/Kernel.html#method-i-rand](http://www.ruby-doc.org/core-1.9.2/Kernel.html#method-i-rand)
*   [http://www.ruby-doc.org/core-1.9.3/Kernel.html#method-i-rand](http://www.ruby-doc.org/core-1.9.3/Kernel.html#method-i-rand)

# javascript - 追踪从哪里发出警报？

> ID：14845517
> 
> 赞同：15
> 
> 时间：2013-02-13T02:33:56.743
> 
> 标签：javascript, debugging, trace

我正在通过去缩小的 CKFinder 源来寻找 an`alert`被解雇的地方。我强制文件在上传时重命名，现在每次上传文件时它都会提醒我，但实际上并不重要。

我已经完成并评论了每一个`alert`，但它仍然在这样做。还刷新了缓存，并通过 Chrome Inspector 确认。有没有办法找出这个特定警报来自哪个文件/行？

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2013-02-13T02:37:22.257

尝试重新定义警报，然后放置一个断点。或调用 console.trace

```
alert = function(mesg) {console.trace(mesg)} 
```

# android - 在 Android 中选择具有特殊要求的 RawContacts

> ID：14845523
> 
> 赞同：1
> 
> 时间：2013-02-13T02:35:01.567
> 
> 标签：android, android-contacts, android-contentresolver

**每当我想向现有的 Android 联系人添加新数据时，我都会使用以下函数来检索`RawContacts`给定联系人 ID 的所有 ID：**

```
protected ArrayList<Long> getRawContactID(String contact_id) {
    ArrayList<Long> rawContactIDs = new ArrayList<Long>();
    String[] projection = new String[] { ContactsContract.RawContacts._ID };
    String where = ContactsContract.RawContacts.CONTACT_ID + " = ?";
    String[] selection = new String[] { contact_id };
    Cursor c = getContentResolver().query(ContactsContract.RawContacts.CONTENT_URI, projection, where, selection, null);
    try {
        while (c.moveToNext()) {
            rawContactIDs.add(c.getLong(0));
        }
    }
    finally {
        c.close();
    }
    return rawContactIDs;
} 
```

之后，我只需使用以下方法插入数据`ContentResolver`：

`getContentResolver().insert(ContactsContract.Data.CONTENT_URI, values);`

这是针对`RawContacts`之前找到的所有 ID 完成的。当然，效果是重复添加所有数据。因此我现在只想返回一个结果，但这必须满足特殊要求。

**我想调整上面的函数，使其结果满足以下要求：**

1.  `ContactsContract.RawContactsColumn.DELETED`必须为 0
2.  该`RawContacts`条目不得像 Facebook 那样是安全的
3.  `ContactsContract.SyncColumns.ACCOUNT_TYPE`最好是“com.google”。所以如果有一个条目满足这个要求，它应该被退回。如果没有，则返回任何剩余条目。

我怎样才能做到这一点（最有效）？我不想让查询变得复杂。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-17T20:29:16.630

根据我接触 r/w 的经验，并考虑到您的需求，我已经对此进行了一些思考。我希望这可以帮助您解决问题，或指出您正在寻找的方向。请注意，我没有可用于任何同步适配器（例如 facebook）的设备，所以不幸的是我无法确认我的答案的可行性（主要是只读位，可能会更改为简单的 != '' ）。

功能相同`getRawContactID`，稍作调整

```
protected ArrayList<Long> getRawContactID(String contact_id) {
    HashMap<String,Long> rawContactIDs = new HashMap<String,Long>();
    String[] projection = new String[] { ContactsContract.RawContacts._ID, ContactsContract.RawContacts.ACCOUNT_TYPE };
    String where = ContactsContract.RawContacts.CONTACT_ID + " = ? AND " + ContactsContract.RawContacts.DELETED + " != 1 AND " + ContactsContract.RawContacts.RAW_CONTACT_IS_READ_ONLY + " != 1" ;
    String[] selection = new String[] { contact_id };
    Cursor c = getContentResolver().query(ContactsContract.RawContacts.CONTENT_URI, projection, where, selection, null);
    try {
        while (c.moveToNext()) {
            rawContactIDs.put(c.getString(1),c.getLong(0));
        }
    }
    finally {
        c.close();
    }
    return getBestRawID(rawContactIDs);
} 
```

还有另一个`getBestRawID`功能可以找到最适合的帐户 -

```
protected ArrayList<Long> getBestRawID(Map<String,Long> rawContactIDs)
{
    ArrayList<Long> out = new ArrayList<Long>();
    for (String key : rawContactIDs.KeySet())
    {
       if (key.equals("com.google"))
       {
          out.clear(); // might be better to seperate handling of this to another function to prevent WW3.
          out.add(rawContactIDs.get(key));
          return out;
       } else {
          out.add(rawContactIDs.get(key));
       }
    }
    return out;
} 
```

另请注意 - 我编写了大部分代码而没有运行/测试它。提前道歉。

# java - Java 与 PHP 上的 AES256

> ID：14845525
> 
> 赞同：5
> 
> 时间：2013-02-13T02:35:39.800
> 
> 标签：java, php, encryption, aes

到目前为止一直在逃避我的快速（漫长的夜晚）。我正在比较 PHP 与 Java 中的 AES256 并注意到差异。为简单起见，请忽略 ascii 键和 null IV，它们将在生产中被替换。但是我需要先克服这个问题，并且不知道我在哪里犯错：

PHP：

```
echo base64_encode(
    mcrypt_encrypt(
        MCRYPT_RIJNDAEL_128,
        "1234567890ABCDEF1234567890ABCDEF",
        "This is a test",
        MCRYPT_MODE_CBC,
        "\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0"
    )
); 
```

爪哇

```
byte[] key = "1234567890ABCDEF1234567890ABCDEF".getBytes("UTF-8");
byte[] iv  = { 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 };
AlgorithmParameterSpec ivSpec = new IvParameterSpec(iv);
SecretKeySpec newKey = new SecretKeySpec(key, "AES");
Cipher cipher = Cipher.getInstance("AES");
cipher.init(Cipher.ENCRYPT_MODE, newKey, ivSpec);
byte[] results = cipher.doFinal("This is a test".getBytes("UTF-8"));

return Base64.encodeToString(results,Base64.DEFAULT); 
```

PHP 输出： `0KwK+eubMErzDaPU1+mwTQ==`

Java 输出：`DEKGJDo3JPtk48tPgCVN3Q==`

不完全是我所期待的 o_O ！

我也尝试过`MCRYPT_MODE_CBC`, `MCRYPT_MODE_CFB`, `MCRYPT_MODE_ECB`,`MCRYPT_MODE_NOFB`等。它们都没有生成 Java 字符串。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T03:09:39.593

PHP 填充输入字节`\0`以使其成为块大小的倍数。Java 中的等价物是这样的（假设您要加密的字符串在 中`data`）：

```
Cipher cipher = Cipher.getInstance("AES/CBC/NoPadding");
int blockSize = cipher.getBlockSize();

byte[] inputBytes = data.getBytes();
int byteLength = inputBytes.length;
if (byteLength % blockSize != 0) {
    byteLength = byteLength + (blockSize - (byteLength % blockSize));
}

byte[] paddedBytes = new byte[byteLength];

System.arraycopy(inputBytes, 0, paddedBytes, 0, inputBytes.length);

cipher.init(Cipher.ENCRYPT_MODE, newKey, ivSpec);
byte[] results = cipher.doFinal(paddedBytes); 
```

作为对此的警告 - 不需要从零开始的填充。无法确定`\0`字符串末尾的字符与实际填充之间的差异。最好改用 PKCS5Padding，但在 PHP 中会得到不同的结果。问问自己是否需要像这样的跨平台加密。

# c# - 如果一个类的只读字段不是不可变的，那么它是不可变的吗？

> ID：14845530
> 
> 赞同：1
> 
> 时间：2013-02-13T02:36:02.037
> 
> 标签：c#, immutability

如果我有一个只有只读字段的 C# 类，但字段的类型不是不可变的，那么该类是否被认为是不可变的？

这个类是不可变的吗？

```
public class Foo
{
    private readonly int[] _blah;

    public Foo(int[] blah)
    {
        _blah = blah;
    }

    public int[] Blah { get { return _blah; } }
} 
```

_blah 不是不可变的，因为我可以更改数组的成员，尽管数组成员变量永远不会改变。

那么，如果一个类的字段都是只读的，那么它是不可变的，还是只有当它的字段不仅是只读的，而且本身也是不可变的时，一个类才是不可变的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T02:45:12.673

这实际上取决于您问谁或您的意思。有人可能会说类本身是不可变的，因为它的直接成员是不可变的。有人可能会说，类及其所有成员（以及它们的属性等）——基本上，整个对象图——必须是不可变的，才能被认为是不可变的。

*   标记为只读的私有字段数组是不可变的，但这并不意味着您不能用不同的值替换索引。解决此问题的一种方法是返回数组的副本或数组的枚举
*   数组的对象可能是不可变的，也可能不是。无论您是使它们不可变还是返回它们的克隆或其他任何东西，这都取决于您。

在您的情况下，对象是整​​数（不可变），但您的数组本身不是（再次，取决于您定义为不可变的内容）。如果您只想保证私有字段不能更改并且不关心索引，那么您就可以了。但是，如果您希望索引被锁定，那么您需要以另一种方式公开您的数组。

* * *

此外，一个不错的收藏是`ReadOnlyCollection<T>`. 它是一个包含对原始集合的引用（它包装它）的集合，因此不能更改索引。

* * *

另外，以防万一……对于“不可变”的实际含义，您已经有了不同的答案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T02:48:18.000

这个类的实例不是不可变的，因为你可以改变它们的内容。例如`foo.Blah[0] = 42;`。但是，如果您将`Blah`属性更改为`IEnumerable<int>`or [`IReadOnlyList<int>`](http://msdn.microsoft.com/en-us/library/hh192385.aspx)，则实例将被视为不可变的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-13T02:42:23.353

这个类不是不可变的，因为它可以被继承并添加其他东西。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-13T02:50:22.503

如果它遵循三个原则，我认为它是不可变的：

*   将字段设为私有只读。
*   提供公共财产获取访问者。
*   如果不再需要继承该类，请将其密封。

这些不是严格定义不可变的硬性规则。它们只是指导方针。

# ios - 低效的 CoreData IN 查询

> ID：14845532
> 
> 赞同：1
> 
> 时间：2013-02-13T02:36:19.957
> 
> 标签：ios, sql, sqlite, core-data, nspredicate

我有一个非常简单的 CoreData 设置，如下所示：

```
Track {
    NSSet *artists;
    NSSet *genres;
}

Artist {
    NSSet *tracks;
}

Genre {
    NSSet *tracks;
} 
```

所以这里的想法是，a`Track`可以有多个`Genre`s 和`Artist`s。在这两种情况下都存在反比关系`Track`。

我正在尝试获取`Artist`至少有`Track`一个给定的 s 列表`Genre`。我正在使用以下谓词：`[NSPredicate predicateWithFormat:@"ANY tracks in %@", genre.tracks]`.

大多数时候这很快，但有时我有一个`Genre`10k+ `Tracks`。这会生成一个包含 10k+ 个变量的 SQL 查询……这需要很长时间才能运行。

我已经尝试了各种方法来避免这种情况，包括：

```
[NSPredicate predicateWithFormat:@"ANY %@ in tracks", genre.tracks]
[NSPredicate predicateWithFormat:@"SELF IN SUBQUERY(tracks, $t, %@ IN $t.genres)", genre]
[NSPredicate predicateWithFormat:@"(SUBQUERY(tracks, $t, %@ IN $t.genres).@count > 0)", genre]; 
```

可能还有一些我已经忘记了。这些中的每一个都可以编译，但不返回任何`Artist`对象。

我可以做些什么来提高我开始使用的 IN 查询的效率（哪个有效）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T05:17:17.727

您可以使用

```
[NSPredicate predicateWithFormat:@"(SUBQUERY(tracks, $t, ANY t.genres = %@).@count > 0)", genre] 
```

这给出了与原始谓词相同的结果，但避免使用许多参数构建查询。

# linux - Crontab 没有运行我的 shell 脚本，但它手动运行（有错误）

> ID：14845534
> 
> 赞同：1
> 
> 时间：2013-02-13T02:36:31.507
> 
> 标签：linux, mongodb, crontab

我正在努力将 MongoDB 每日备份存储在 Amazon S3 上。这是我第一次使用 crontab 和 shell 脚本，但遇到了麻烦。我发现了一个似乎可以工作的脚本，但只有当我手动运行它时。这就是我所拥有的。

在 crontab 中（以 root 身份登录）。

```
* 2 * * * /mongo_backups/daily_script/mongobackup.sh 
```

在我的脚本（mongobackup.sh）中。

```
#!/bin/sh

MONGODUMP_PATH="/usr/bin/mongodump"
MONGO_HOST="Aspire"
TIMESTAMP=`date +%F`
S3_BUCKET_PATH="Aspire_Backups"

# Create backup
$MONGODUMP_PATH --host $HOST

# Add timestamp to backup
mv dump mongodb-$HOSTNAME-$TIMESTAMP
tar cf mongodb-$HOSTNAME-$TIMESTAMP.tar mongodb-$HOSTNAME-$TIMESTAMP

# Upload to S3
s3cmd put mongodb-$HOSTNAME-$TIMESTAMP.tar s3://$S3_BUCKET_PATH/aspire-mongodb-  $HOSTNAME-$TIMESTAMP.tar 
```

如果我使用 sh -x ./mongobackup.sh 手动运行脚本，这就是我得到的：

```
root@ip-10-4-149-188:/mongo_backups/daily_script# sh -x ./mongobackup.sh
+ MONGODUMP_PATH=/usr/bin/mongodump
+ MONGO_HOST=Aspire
+ date +%F
+ TIMESTAMP=2013-02-13
+ S3_BUCKET_PATH=Aspire_Backups
+ /usr/bin/mongodump --host
ERROR: required parameter is missing in 'host'

+ mv dump mongodb--2013-02-13
mv: cannot stat `dump': No such file or directory
+ tar cf mongodb--2013-02-13.tar mongodb--2013-02-13
tar: mongodb--2013-02-13: Cannot stat: No such file or directory
tar: Exiting with failure status due to previous errors
+ s3cmd put mongodb--2013-02-13.tar s3://Aspire_Backups/aspire-mongodb--2013-02-                                                                                                                        13.tar
mongodb--2013-02-13.tar -> s3://Aspire_Backups/aspire-mongodb--2013-02-13.tar  [                                                                                                                       1 of 1]
10240 of 10240   100% in    0s    42.59 kB/s  done 
```

就像我说的，我是 crontab 和 shell 脚本的新手。我了解这里发生的大部分事情，但我仍在努力掌握总体思路。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T09:10:52.560

在脚本中你有：

```
$MONGODUMP_PATH --host $HOST

# Add timestamp to backup
mv dump mongodb-$HOSTNAME-$TIMESTAMP
tar cf mongodb-$HOSTNAME-$TIMESTAMP.tar mongodb-$HOSTNAME-$TIMESTAMP 
```

这意味着您正在使用 variables `$HOST`，`$HOSTNAME`并且`$TIMESTAMP`之前没有声明过。

尝试像这样声明它们

```
HOST=$(hostname)
HOSTNAME=$(hostname)
TIMESTAMP=$(date "+%Y%m%d") # it will output 20130213 
```

# ruby-on-rails - 如何更新 Ruby 中的引用列

> ID：14845537
> 
> 赞同：0
> 
> 时间：2013-02-13T02:36:49.917
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, postgresql, migration

我有一个我想在我的表中引用的迁移。我使用这个创建参考：

```
create_table :user_events do |t|
  t.references :user, :null => false
end 
```

在我的迁移中，我希望能够允许引用为 NULL。

```
def self.up
  change_column :user_events, :user, :integer, :null => true
end 
```

但是我不断得到`PGError: ERROR: column "user" of relation "user_events" does not exist`。我迁移错了吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T02:38:20.967

这应该有效：

```
def self.up
  change_column :user_events, :user_id, :integer, :null => true
end 
```

请注意，您尝试更改的列称为`user_id`，而不是`user`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T02:39:07.890

这是因为您的迁移创建了一个名为 user_id 的列，引用了 User 模型。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-13T04:29:14.703

尝试

```
def self.up
  change_column :user_events do |c|
    c.references :user, :integer, :null => true  
  end 
end 
```

# asp.net - 默认 Razor cshtml 命名空间在哪里定义？

> ID：14845541
> 
> 赞同：5
> 
> 时间：2013-02-13T02:37:17.110
> 
> 标签：asp.net, asp.net-mvc, razor, web-config

默认情况下，Razor 生成的代码中会出现以下内容：

```
using System;
using System.Collections.Generic;
using System.IO;
using System.Linq;
using System.Net;
using System.Web;
using System.Web.Helpers;
using System.Web.Security;
using System.Web.UI;
using System.Web.WebPages; 
```

这些从何而来？我查看了 machine.config 和根级别的 web.config，但它不在那里。

我已经验证我可以使用以下方法*添加*到该列表中：

```
<system.web.webPages.razor>
    <host factoryType="System.Web.Mvc.MvcWebRazorHostFactory, System.Web.Mvc, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
    <pages pageBaseType="System.Web.Mvc.WebViewPage">
      <namespaces>
        <add namespace="System.Web.Mvc" />
        .... etc 
```

而且我猜我可能可以删除 using `<clear/>`...但我很想知道它们从哪里开始。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T03:09:54.997

这些默认命名空间似乎在[WebPageRazorHost.cs](https://github.com/ASP-NET-MVC/aspnetwebstack/blob/master/src/System.Web.WebPages.Razor/WebPageRazorHost.cs)和[MvcWebPageRazorHost.cs](https://github.com/ASP-NET-MVC/aspnetwebstack/blob/master/src/System.Web.Mvc/Razor/MvcWebPageRazorHost.cs)（链接到 Github）中硬编码。

前者在构造函数中添加了所有的命名空间（包括`System.Web.WebPages.Html`），而后者则使用名为`GetRidOfNamespace`(!)的方法将其删除

我试着打电话`<clear/>`，但很遗憾/令人惊讶的是它没有任何效果。

`NamespaceImports`是公共成员，`RazorEngineHost`因此希望可以在代码中对其进行调整。

# haskell - 我如何将其变成尾递归？哈斯克尔

> ID：14845546
> 
> 赞同：0
> 
> 时间：2013-02-13T02:37:56.527
> 
> 标签：haskell, tail-recursion

我正在尝试获取列表中元素的索引。

但是我遇到的问题是当元素不在列表中时。

我在想也许尾递归是有序的，但我不确定如何去做。

```
whatIndex sought [] = -1
whatIndex sought (a:xs) = 
    if sought == a
        then 0
        else 1 + whatIndex sought xs 
```

编辑：

当它不在列表中时，它应该返回 -1

例子：

```
whatIndex 3 [1,2,3] == 2
whatIndex 3 [0,1,2] == -1 
```

编辑：能够让它工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T14:57:31.963

你当然有`Data.List.findIndex`。如果你想自己写，有很多方法，例如：

```
import Control.Monad

whatIndex x = msum . zipWith f [0..] where
  f i y = if x == y then Just i else Nothing 
```

...返回一个`Maybe Int`. 如果您坚持使用 -1 hack，请在 . 前面添加`fromMaybe (-1) $`（来自） 。`Data.Maybe``msum`

# java - 这在java中是什么意思 ?

> ID：14845552
> 
> 赞同：0
> 
> 时间：2013-02-13T02:38:14.787
> 
> 标签：java

我是Java的新手，我已经在互联网上搜索过了。但我不能正确这是我关于下一个代码的问题：

```
protected <TTask, TList> void get(
        final List<TList> list,
        final Class<? extends AbstractAsyncTask<TTask>> asyncTaskClass,
        final Class<TList> myTypeClass,
        final Object... constructorParams) 
```

1.  是什么`<TTask, TList>`意思？
2.  是什么`Class<? extends AbstractAsyncTask<TTask>>`意思？

感谢您的任何网站或阻碍或示例。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T03:20:42.080

您可以在[泛型教程](http://docs.oracle.com/javase/tutorial/java/generics/)中找到有关您的问题的所有信息。但是给你至少“一些东西”

```
protected <TTask, TList> void get(
            final List<TList> list,
            final Class<? extends AbstractAsyncTask<TTask>> asyncTaskClass,
            final Class<TList> myTypeClass,
            final Object... constructorParams) 
```

是一个[通用方法](http://docs.oracle.com/javase/tutorial/extra/generics/methods.html)

1)`TTask`并且`TList`被称为[类型变量](http://docs.oracle.com/javase/tutorial/java/generics/types.html)。它们就像保存您传递的任何类型 ( `String`, `Integer`, ) 的变量。`AnyUserDefinedClass`如果你通过

`List<String> list`

作为`get`方法的第一个参数，`TList`方法内部所有出现的 都将替换为`String`

2）`Class<? extends AbstractAsyncTask<TTask>>`特别是这部分`<? extends AbstractAsyncTask<TTask>>` 意味着可以将任何子类`AbstractAsyncTask<TTask>`（或任何扩展`AbstractAsyncTask<TTask>`）放置在这里，这里`TTask`又是一个包含您传递的任何类型的变量。

进一步阅读：[Java中的协变和逆变](https://stackoverflow.com/a/2501513/1767366)

# sql-server - 选择语句中的单个字段返回两列

> ID：14845555
> 
> 赞同：0
> 
> 时间：2013-02-13T02:38:23.193
> 
> 标签：sql-server, multiple-columns

所以我正在运行这样的查询：

> 从表名中选择 col1

它给我返回了两列：

> 服务器名称 | col1

我以前没有遇到过这个。我敢肯定它非常简单，但在网上搜索却非常困难。有什么办法可以让 col1 回来吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-13T02:40:46.473

在 SSMS 中，您可以选择一次对多个服务器/数据库运行查询。当您这样做时，每个结果都会添加一个带有服务器名称的附加列。这很可能是这里发生的事情。关闭查询窗口，打开一个新窗口并确保您直接连接到有问题的服务器。那应该删除该列。

更多信息：http: [//msdn.microsoft.com/en-us/library/bb964743.aspx](http://msdn.microsoft.com/en-us/library/bb964743.aspx)

# php - 表单 POST 操作不起作用

> ID：14845557
> 
> 赞同：0
> 
> 时间：2013-02-13T02:38:40.357
> 
> 标签：php, jquery, post, methods

为什么这行不通？

```
<form action="" method="POST">
<input type="text" class="searchBar" name="domain" /><input type="button" value="SEARCH" class="searchButton" id="srch" />
</form>

<? print $_POST['domain']; ?> 
```

我也尝试将其放入 var 中。我刚刚得到一个错误。

谢谢

编辑：已提出更改按钮以提交的建议，但我的 jQuery 错误已解决。

 `````
<script type="text/javascript">
$('#srch').click(function(){ 
      $('#notActive').attr('id','Active'); 
});

$(document).ready(function(){

  // Hide div 2 by default
  $('#Active').hide();

  $('#srch').click(function(){ 
      $('#notActive').hide();
      $('#Active').fadeIn();
  });
});
</script> 
````  `我已经设法通过使用`javascript: void(0);`我的表单的操作将按钮更改为提交。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T02:43:42.863

如果不包含**type="submit"**输入，则表单无法提交。

`<input type="button" />`不能提交表格。您应该添加`<input type="submit" />`到表单中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T02:43:04.187

在提交表单*之前*，您无法访问发布的变量。

```
if (isset($_POST['domain'])) {
    // a form is submitted that contains the 'domain' parameter
    print $_POST['domain'];
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-13T02:44:12.833

尝试设置一个动作：

`<form action="index.php" method="POST">`.

另外，将您的第二行更改为：

`<? if (isset($_POST['domain'])) echo ($_POST['domain']); ?>```

# path - ubuntu 10.04 sudo 和路径

> ID：14845559
> 
> 赞同：1
> 
> 时间：2013-02-13T02:38:50.690
> 
> 标签：path, ubuntu-10.04, sudo

Ubuntu 10.04.4 LTS

我已经在包括 stackoverflow 在内的各种网站上看到了有关 sudo 和 PATH 的帖子。我认为这是不同的，所以我很确定它不是重复的（但我不确定）。

1）一、ruby的非sudo路径：

```
$ which ruby
/usr/local/ruby/bin/ruby 
```

2）然后是ruby的sudo路径：

```
$ sudo which ruby
/usr/bin/ruby 
```

好的，到目前为止一切顺利。当我使用 sudo 时路径发生了变化。

3）但这是我没有得到的部分：

```
$ sudo echo $PATH
/home/cm6/bin:/usr/local/ruby/bin:/usr/local/ruby/bin:/usr/local/sbin:<snipped> 
```

即，当我使用 sudo 时，ruby 的路径在 $PATH 变量集中。

4）又有点陌生：

```
$ echo $PATH
/home/cm6/bin:/usr/local/ruby/bin:/usr/local/ruby/bin:/usr/local/sbin:<snipped> 
```

这次没有sudo，但是$PATH变量内容和sudo一样。

鉴于 $PATH 变量在有或没有 sudo 的情况下是相同的，为什么“which ruby​​”给了我不同的答案？就好像 $PATH 变量在 sudo 下没有保存真正的 PATH。

所以，最后，我的问题是：如何获得 sudo 使用的真实/准确/正确的 PATH？

谢谢，

约翰

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T02:43:35.517

`sudo echo $PATH`在调用 sudo 之前评估 $PATH。

确定：

```
sudo -s
echo $PATH 
```

您需要将 PATH 变量添加到 /etc/sudoers 中的 env_keep

# iphone - 在 iPhone 上流式传输音频时是否可以减少背景噪音？

> ID：14845564
> 
> 赞同：2
> 
> 时间：2013-02-13T02:40:03.113
> 
> 标签：iphone, ios, audio, skype, webrtc

我们使用了一些`WebRTC libraries`并在`iPhone`. 测试应用程序允许使用此应用程序在两部手机之间进行语音通话，类似于 Skype。

该应用程序接收到大量背景噪音，远远超过 Skype 或 Line 等其他电话应用程序。

有什么方法可以降低背景噪音？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T03:26:33.043

Skype 有自己的编解码器，内置声学回声消除和噪声抑制。iOS 中也有内置的降噪机制，但如果您希望完全消除噪音，则无法使用自己的编解码器来执行此类操作。从这个角度来看，WebRTC 还不存在。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-31T06:22:16.133

如果您使用 WebRTC lib 并启用 NS 选项，我不知道为什么您仍然会收到背景噪音。

对我来说，我构建了 WebRTC 噪声抑制的独立模块，它工作得很好。在使用最激进的 NS 实例模式时，Android 和 iOS 上的背景噪音都很少。

# dropbox - 如何有效地恢复 Dropbox 中误删的大量文件？

> ID：14845565
> 
> 赞同：0
> 
> 时间：2013-02-13T02:40:10.543
> 
> 标签：dropbox

我刚刚误删**了Dropbox里的很多**文件和文件夹，而且已经同步了。

我知道如何在网上一一恢复，但似乎太麻烦了。所以我想知道如何有效地恢复它们。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T05:14:07.210

如果需要，您可以通过 API 执行此操作。查看 delta 端点。有一篇关于此的不错的博客文章

[https://www.dropbox.com/developers/blog/23](https://www.dropbox.com/developers/blog/23)

干杯!

# c++ - 创建指向另一个类的指针数组的语法是什么？

> ID：14845566
> 
> 赞同：0
> 
> 时间：2013-02-13T02:40:13.777
> 
> 标签：c++, arrays, pointers

如果我有一个带有私有变量的类，该变量应该包含指向另一个类的指针数组，那么以下语法是否正确？

```
class MyClass
{
    private:
        int arraySize;
        SomeOtherClass* classPtr[];
} 
```

后来，当我想在 MyClass 中接受 ifstream、从文件读取并填充数组的函数中为这个数组动态分配内存时，我会这样做吗？

```
void createArray(std::ifstream& fin)
{
    //the first int is the array size
    fin >> arraySize;
    string tempString; //the file is formatted string int string int etc.
    int tempInt;

    classPtr[arraySize];

    for(int i = 0; i < arraySize; i++)
    {
        fin >> tempString;
        fin >> tempInt;
        //assume the constructor is defined
        classPtr[i] = new SomeOtherClass(tempString, tempInt);
    } 
```

提前感谢您的时间。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T02:46:43.480

这是不正确的。您还不能在 C++ 中使用可变长度数组

那应该是

`SomeOtherClass** classPtr;`

而在`createArray()`

```
...
classPtr = new SomeOtherClass*[arraySize];
... 
```

是的，忘记我所说的一切并使用`std::vector`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T02:49:08.303

数组在编译时必须具有静态大小，但在您的情况下，您不知道大小，直到您在运行时从流中读取它。对于动态大小的数组，您应该使用 a`vector`代替：

```
std::vector<SomeOtherClass*> classPtr; 
```

然后在下面的代码中：

```
classPtr.reserve(arraySize);
.....
classPtr.push_back(new SomeOtherClass(...)); 
```

话虽如此，*不建议在向量中使用原始指针，*并且应该小心。阅读[此答案](https://stackoverflow.com/a/1361227/507606)以了解有关它的更多信息以及它是否适合您。更有可能的是，您只需要一个`vector`对象：

```
std::vector<SomeOtherClass> vec;
.....
vec.push_back(SomeOtherClass(...)); 
```

使用`vector`对象时，您应该确保考虑对象的移动/复制语义，并确保它适合您的用例。

# c# - 如何使用 HttpContext.Current.User.Identity 为我的 SmtpClient.Credentials 提供身份验证？

> ID：14845567
> 
> 赞同：0
> 
> 时间：2013-02-13T02:40:14.457
> 
> 标签：c#, asp.net, credentials, httpcontext, smtpclient

我有一个奇怪的情况。

在我的网站中，我模拟了一个实验室帐户来访问数据库，但对于前端，我允许 Windows 身份验证。所以这意味着 HttpContext.Current.User.Identity.Name.Split('\') [1](http://forums.asp.net/t/1790651.aspx/1)给了我查看该站点的用户的名称，这样我就可以打印一条欢迎消息，但是像 Environment.Username 这样的东西会给我'labaccount' .

为了清楚起见，在服务器的 IIS 管理器 --> 基本设置 --> 连接为... = labaccount 用户名/密码，并在网站的 web.config 中：

```
<configuration>
  <connectionStrings>
    <add name="DatabaseConnectionString" connectionString="blahblahblah" providerName="System.Data.SqlClient" />
  </connectionStrings>
  <system.web>
    <compilation debug="false" targetFramework="4.0" />
    <customErrors mode="Off" />
     <identity impersonate="true" />
</system.web>
  <system.webServer>
    <validation validateIntegratedModeConfiguration="false" />
  </system.webServer>

</configuration> 
```

现在在网站上，我需要一种向一组人发送电子邮件的方法，除了发件人需要是查看网站的用户而不是实验室帐户。当我将“mailFrom”中的发件人设置为实验室帐户时，一切都按预期工作，但是当我将其更改为 HttpContext.Current.User 时，我收到一条错误消息，提示“邮箱不可用。服务器响应为：5.7.1 客户端无权作为此发件人发送。这是我发送电子邮件的代码部分：

```
MailMessage mail = new MailMessage(mailFrom, mailTo, subject, null);
mail.IsBodyHtml = true;
mail.Body += mailBody;
SmtpClient smtpClient = new SmtpClient("smtphost");
smtpClient.Credentials = CredentialCache.DefaultNetworkCredentials;
smtpClient.Send(mail); 
```

这不起作用，所以我尝试[根据我在这里看到的内容](http://forums.asp.net/t/1790651.aspx/1)做这样的事情：

```
MailMessage mail = new MailMessage(mailFrom, mailTo, subject, null);
mail.IsBodyHtml = true;
mail.Body += mailBody;
SmtpClient smtpClient = new SmtpClient("smtphost");
smtpClient.UseDefaultCredentials = false;
WindowsImpersonationContext impersonationContext;
impersonationContext = ((WindowsIdentity)HttpContext.Current.User.Identity).Impersonate();
smtpClient.Send(mail);
impersonationContext.Undo(); 
```

这也不起作用。我在这里不知所措。甚至可以使用这种方法吗？我还能尝试什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T15:58:04.553

显然，这是做不到的。我通过在 Outlook 中启动一个撰写窗口并在 HTML 中预加载电子邮件正文来解决这个问题。

[http://msdn.microsoft.com/en-us/library/office/aa171418(v=office.11​​).aspx](http://msdn.microsoft.com/en-us/library/office/aa171418(v=office.11).aspx)

# php - ob_start 缓存 CSS

> ID：14845577
> 
> 赞同：2
> 
> 时间：2013-02-13T02:40:56.070
> 
> 标签：php, css, caching, ob-start

我正在使用这个 php 代码将 css 文件缓存到一个中间自己的 CMS 中。

```
<?php
ob_start("ob_gzhandler");
ob_start("compress");
header("Content-type: text/css; charset: UTF-8");
header("Cache-Control: must-revalidate");
$off = 3600;
$exp = "Expires: " . gmdate("D, d M Y H:i:s", time() + $off) . " GMT";
header($exp);

function compress($buffer) {
    $buffer = preg_replace('!/\*[^*]*\*+([^/][^*]*\*+)*/!', '', $buffer); // remove comments
    $buffer = str_replace(array("\r\n", "\r", "\n", "\t", '  ', '    ', '    '), '', $buffer); // remove tabs, spaces, newlines, etc.
    return $buffer;
}

require_once('style1.css');
require_once('style2.css');

?> 
```

此代码的最大限制是我无法将参数传递给我的“压缩”函数。例如，如果我将 css 文件放入其他目录，则不会替换图像的相对路径。

当我调用我的压缩函数并使用例如这样的东西时，你知道添加参数的方法吗？

```
$buffer = str_replace('url("', 'url("'.$directory, $buffer); 
```

任何建议都非常感谢！

* * *

**编辑 -> 最终解决方案**

在@Jack 提出建议后，我来到了这个来源。

用法：在html页面的页眉中添加这一行： `<link href="cacheCSS.php" rel="stylesheet" type="text/css" />`

```
ob_start("ob_gzhandler");

class CWD {  
    private $path;

    public function __construct($path=NULL){
        if(!isset($path)) $path = '';
        $this->setPath($path);
    }

    public function setPath($path){
        $this->path = $path;
    }

    public function getPath() {
        return $this->path;
    }
}

$directory = new CWD();
$compress = function($buffer) use ($directory) {
    $buffer = str_replace('url("', 'url("'.$directory->getPath(), $buffer);
    $buffer = str_replace('url(\'', 'url(\''.$directory->getPath(), $buffer);
    $buffer = preg_replace('#^\s*//.+$#m', "", $buffer);
    $buffer = preg_replace('!/\*[^*]*\*+([^/][^*]*\*+)*/!', '', $buffer);
    $buffer = str_replace(array("\r\n", "\r", "\n", "\t", '  ', '    ', '    '), '', $buffer);
    return $buffer;
};

ob_start($compress);

header("Content-type: text/css; charset: UTF-8");
header("Cache-Control: must-revalidate");
$off = 0; # Set to a reaonable value later, say 3600 (1 hr);
$exp = "Expires: " . gmdate("D, d M Y H:i:s", time() + $off) . " GMT";
header($exp);

/* List of CSS files*/
$directory->setPath('path1/');
include('path1/style1.css');

ob_flush();
$directory->setPath('path2/');
include('path2/style2.css');

ob_flush();
$directory->setPath('path3/');
include('path3/style3.css'); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T02:53:20.590

从 PHP 5.3 开始，您可以使用闭包来完成此操作：

```
$directory = 'whatever';

$compress = function($buffer) use ($directory) {
    $buffer = preg_replace('!/\*[^*]*\*+([^/][^*]*\*+)*/!', '', $buffer); // remove comments
    $buffer = str_replace(array("\r\n", "\r", "\n", "\t", '  ', '    ', '    '), '', $buffer); // remove tabs, spaces, newlines, etc.

    $buffer = str_replace('url("', 'url("'.$directory, $buffer);

    return $buffer;
}

ob_start($compress); 
```

**更新**

如果您的目录可以更改，您可能希望使用一个对象：

```
class CWD
{
    private $path;

    public function __construct($path)
    {
        $this->setPath($path);
    }

    public function setPath($path)
    {
        $this->path = $path;
    }

    public function getPath()
    {
        return $this->path;
    }
}

$directory = new CWD('/path/to/directory');

$compress = function($buffer) use ($directory) {
    // ...
    $buffer = str_replace('url("', 'url("'.$directory->getPath(), $buffer);
}; 
```

然后在您的代码中的某个地方，您将拥有：

```
$directory->setPath();
echo "whatever css"; 
```

# html - 表格边框不直

> ID：14845584
> 
> 赞同：0
> 
> 时间：2013-02-13T02:41:34.130
> 
> 标签：html, css, border, css-tables

我正在使用表格创建一个 html 迷宫，由于某种原因，边框没有正确显示。边框不是漂亮的直线，而是显示为对角线斑点。有没有办法解决这个问题？这是我的例子：[http](http://thomaswd.com/maze) ://thomaswd.com/maze 。

输出：

![在此处输入图像描述](../Images/6b1c04ca80089179c30798d49b78f0ac.png)

我的 CSS：

```
section .l {
    border-left:20px solid #ff9c00;
}

section .r {
    border-right:20px solid #ff9c00;
}

section .t {
    border-top:20px solid #ff9c00;
}

section .b {
    border-bottom:20px solid #ff9c00;
}

section table {
    margin-right:auto;
    margin-left:auto;
    border:20px solid #FF9C00;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T02:45:19.350

`border: 20px solid transparent;`从您的选择器中删除`section table tr td`（未在您的代码示例中显示），它看起来不错。

![在此处输入图像描述](../Images/25f4da9ef601d31049cfd3710dcb5dc0.png)

# mongodb - 递归查询？

> ID：14845585
> 
> 赞同：2
> 
> 时间：2013-02-13T02:41:35.877
> 
> 标签：mongodb, recursion, hierarchy

我是 mongodb 的新手。

假设我的数据库中有一个“文件系统”层次结构：

```
db.directories.save({ _id: "root", directories: ["src", "lib"], files: ["config.cfg"] })
db.directories.save({ _id: "src", directories: [], files: ["file1.js", "file2.js"] })
db.directories.save({ _id: "lib", directories: [], files: [] })

db.files.save({ _id: "config.cfg", size: 2310 })
db.files.save({ _id: "file1.js", size: 5039 })
db.files.save({ _id: "file2.js", size: 1299 }) 
```

如何获得文件夹的总大小？

即“根”目录的总大小=文件的总大小+子目录的总大小

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-14T04:18:39.297

关于哪种模式最适合您描述的访问模式类型的问题在某些示例中回答了有关如何在 MongoDB/文档数据库中表示层次结构的问题。

适用于许多不同查询的常见答案是您在每个文件中存储其名称、大小、直接父级和所有祖先的数组的位置。

这将使您的示例数据：

```
db.files.save({ _id: "root"})
db.files.save({ _id: "src", parent: "root", ancestors: ["root"] } )
db.files.save({ _id: "lib", parent: "root", ancestors: ["root"]} )
db.files.save({ _id: "config.cfg", parent: "root", ancestors: ["root"], size: 2310 })
db.files.save({ _id: "file1.js", parent: "src", ancestors: ["root","src"], size: 5039 })
db.files.save({ _id: "file2.js", parent: "src", ancestors: ["root","src"], size: 1299 }) 
```

现在，如果您想查询“此目录中的文件”或“此目录下的所有文件（包括递归）”之类的内容，您可以查询：

```
db.files.find( { parent: "root" } )    // all files in /src directory
db.files.find( {ancestors: "root"} )   // all files under /root directory tree 
```

由于您需要使用聚合框架来获取 sum 之类的内容，因此对文件夹大小的查询将是：

```
db.files.aggregate([
       {$match:{ancestors:"src"}}, 
       {$group:{
           _id:   "src",
           total_size:  {$sum:"$size"}
          }
       }
]); 
```

要查看根文件夹中所有文件夹的大小，它将是：

```
db.files.aggregate([
       {$match:{ancestors:"root"}}, 
       {$group:{
           _id:   "root",
           total_size:  {$sum:"$size"}
          }
       }
]); 
```

# ios - 核心数据 - 保存上下文后撤消更改

> ID：14845586
> 
> 赞同：7
> 
> 时间：2013-02-13T02:41:36.787
> 
> 标签：ios, core-data, nsundomanager

我最近注意到 Core Data 中关于撤消机制的一个奇怪的事情，从那以后它一直困扰着我。

`NSManagedObjectContext`方法文档中的引用`-undo`：

> 向接收者的撤消管理器发送撤消消息，要求它撤消应用于对象图中对象的最新未提交更改。

要反转*最新的未提交更改*，听起来很简单，对吧？

然而，实际情况并非如此！即使我保存了对托管对象进行更改的上下文，以下`-undo`调用仍将成功撤消更改。这不违反文档中所述的内容吗？

也许我做错了什么？如果需要，我可以发布我的小测​​试代码。我真的很困惑。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-13T03:28:36.150

你*应该*感到困惑。Core Data 文档一团糟。他们以不恰当的方式使用了很多诸如“未承诺”之类的词。当他们说“未提交”时，它们似乎意味着属性`isFaulted`等于 NO 的对象。

核心数据编程指南更详细：

> ## 更改和撤消管理
> 
> 上下文保持对具有挂起更改（插入、删除或更新）的托管对象的强引用，直到向上下文发送 save:、reset、rollback 或 dealloc 消息，或适当数量的撤消来撤消更改。
> 
> 与上下文关联的撤消管理器保持对任何更改的托管对象的强引用。默认情况下，在 OS X 中，上下文的撤消管理器保持无限的撤消/重做堆栈。**为了限制应用程序的内存占用，您应该确保`removeAllActions`在适当的时候清理（使用）上下文的撤消堆栈**。除非您保留对上下文的撤消管理器的强引用，否则它将与上下文一起释放。

文档中的措辞/词汇不清晰或不一致。我相信预期的用途是您应该在适合您的应用程序时调用`removeAllActions`上下文的属性，以避免无限的内存增长。`undoManager`

# sbt - Play 2.1 ConfigFactory.parseFile 替换失败

> ID：14845587
> 
> 赞同：3
> 
> 时间：2013-02-13T02:41:37.543
> 
> 标签：sbt, playframework-2.1, typesafe-stack

在 application.conf 中（在 Play 2.0.4，sbt 0.11.3 中）我可以使用以下替换：

```
app {
  major = 0
  minor = 1
  revision = 62
  date = 0127
  version = ${app.major}.${app.minor}.${app.revision}.${app.date}
} 
```

升级到 Play 2.1.0 和 sbt 0.12.2 并将此[建议](https://stackoverflow.com/questions/14430088/play-framework-2-1-use-play-api-configuration-in-build-scala)用于 Build.scala 后，

```
val conf = ConfigFactory.parseFile(new File("conf/application.conf")) 
```

当我这样做时出现错误`play clean`：

```
Caused by: com.typesafe.config.ConfigException$NotResolved: need to call resolve() on root config; tried to get value type on an unresolved substitution: ConfigSubstitution(${app.major}"."${app.minor}"."${app.revision}"."${app.date})
    at com.typesafe.config.impl.ConfigSubstitution.valueType(ConfigSubstitution.java:54)
    at com.typesafe.config.impl.DefaultTransformer.transform(DefaultTransformer.java:15)
    at com.typesafe.config.impl.SimpleConfig.findKey(SimpleConfig.java:118)
    at com.typesafe.config.impl.SimpleConfig.find(SimpleConfig.java:135)
    at com.typesafe.config.impl.SimpleConfig.find(SimpleConfig.java:140)
    at com.typesafe.config.impl.SimpleConfig.find(SimpleConfig.java:108)
    at com.typesafe.config.impl.SimpleConfig.find(SimpleConfig.java:146)
    at com.typesafe.config.impl.SimpleConfig.getString(SimpleConfig.java:188)
    at ApplicationBuild$.<init>(Build.scala:12)
    at ApplicationBuild$.<clinit>(Build.scala) 
```

根据 Play Configuration[文档](http://www.playframework.com/documentation/2.1.0/Configuration)，应该支持这种替换：

> 然而，实现必须小心，以允许对象引用自身内部的路径。例如，这必须有效：
> 
> bar : { foo : 42, baz : ${bar.foo} } 在这里，如果一个实现解决了 bar 中的所有替换作为解决替换 ${bar.foo} 的一部分，那么就会有一个循环。实现必须只解析 bar 中的 foo 字段，而不是递归整个 bar 对象。

任何想法如何解决这一问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-15T22:25:34.617

你的语法是正确的。似乎您实际上*需要*按照错误消息所述调用 resolve() 来解决替换问题。我猜在 2.0.x 中，play 框架做到了这一点，并提供了一个已经以这种方式解决的配置。现在直接使用 config API 需要手动解析。

[`resolve()`](http://typesafehub.github.com/config/latest/api/)在此行中添加调用：

```
val conf = ConfigFactory.parseFile(new File("conf/application.conf")).resolve() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T08:47:32.717

AFAIK，我对文档的理解是您应该使用以下内容：

```
app {
  major = 0
  minor = 1
  revision = 62
  date = 0127
  version = ${major}.${minor}.${revision}.${date}
} 
```

我没有测试它...

也许它因为错误而在 2.0.4 下工作？

# java - 如何将类中的数据传递给另一个成员？

> ID：14845591
> 
> 赞同：0
> 
> 时间：2013-02-13T02:41:57.620
> 
> 标签：java, android, paypal, this

我有这段代码，我正在尝试传递`this.thecost`给该`public void click()`方法，但它看起来不起作用，因为我在单击 paypal 按钮时收到“Paymnet Failed”。

我做错了什么？

顺便说一句，你怎么称呼`private {}`, `private void {}`- 所有那些看起来像 function() 的东西？

```
private void initUI(int theprice) {

        launchPayPalButton = mPayPal.getCheckoutButton(this, 
                PayPal.BUTTON_278x43, CheckoutButton.TEXT_PAY);

        LinearLayout.LayoutParams params = new
                LinearLayout.LayoutParams(LayoutParams.WRAP_CONTENT, 
                        LayoutParams.WRAP_CONTENT);

        params.bottomMargin = theprice;
        this.thecost = theprice;

        launchPayPalButton.setLayoutParams(params);
        launchPayPalButton.setOnClickListener(this);

        ((LinearLayout)findViewById(R.id.main_layout2)).addView(launchPayPalButton);
    }

    public void onClick(View v) {
        payWithPaypal(this.thecost);
    }

private void payWithPaypal(Integer gg) {
        PayPalPayment newPayment = new PayPalPayment();
        BigDecimal bigDecimal=new BigDecimal(gg);
        newPayment.setSubtotal(bigDecimal);
        newPayment.setCurrencyType(Currency.getInstance(Locale.US));
        newPayment.setRecipient("email@hotmail.com");
        newPayment.setMerchantName("My Merchant");
        Intent paypalIntent = PayPal.getInstance().checkout(newPayment, this);
        this.startActivityForResult(paypalIntent, 1);
    }

    @Override
    protected void onActivityResult(int requestCode, int resultCode, Intent data) {
        super.onActivityResult(requestCode, resultCode, data);

        switch(resultCode) {
        case Activity.RESULT_OK:
            String payKey = data.getStringExtra(PayPalActivity.EXTRA_PAY_KEY);
            data.getStringExtra(PayPalActivity.EXTRA_PAY_KEY);
            Toast.makeText(this,"Paymnet Successful",Toast.LENGTH_LONG).show();
            break;
        case Activity.RESULT_CANCELED:
            Toast.makeText(this,"Paymnet Cancel",Toast.LENGTH_LONG).show();
            break;
        case PayPalActivity.RESULT_FAILURE:
            Toast.makeText(this,"Paymnet Failed",Toast.LENGTH_LONG).show();
            String errorID = 
            data.getStringExtra(PayPalActivity.EXTRA_ERROR_ID);
            String errorMessage = 
                    data.getStringExtra(PayPalActivity.EXTRA_ERROR_MESSAGE);
            break;

        } 
```

编辑：我在 oncreate 方法调用 initUI()

再次编辑：我将全局变量更改为“double”，因为价格通常有小数位。现在我试着为这个值敬酒，我更清楚地看到了错误。Toast 显示一条消息，表明传递的值为“0.0”。因此，出现“付款失败”和无效付款的错误。

```
int eprice;
    double thecost;    
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.detail);

    //Data mSource = new Data;
    Intent myLocalIntent = getIntent();
    Bundle myBundle = myLocalIntent.getExtras();

    eprice = myBundle.getInt("eprice");
    String epricetxt = myBundle.getString("eprice");

    Adapter mAdapter = new Adapter(this, mSource);
    //details = (Data) mAdapter.getItem(pos);

    TextView theprice = (TextView) findViewById(R.id.priceTxt);
    theprice.setText("Price: $" + epricetxt);

    this.setCost(eprice);
    this.thecost = eprice;

    //Paypal
    mPayPal=PayPal.initWithAppID(this,Constants.PAYPAL_APP_ID,PayPal.ENV_SANDBOX);

    initUI(eprice);

}

private void initUI(int theprice) {

        launchPayPalButton = mPayPal.getCheckoutButton(this, 
                PayPal.BUTTON_278x43, CheckoutButton.TEXT_PAY);

        LinearLayout.LayoutParams params = new
                LinearLayout.LayoutParams(LayoutParams.WRAP_CONTENT, 
                        LayoutParams.WRAP_CONTENT);

        params.bottomMargin = theprice;
        this.thecost = theprice;
        launchPayPalButton.setLayoutParams(params);
        launchPayPalButton.setOnClickListener(this);

        ((LinearLayout)findViewById(R.id.main_layout2)).addView(launchPayPalButton);
    }

    public void onClick(View v) {
        //
        payWithPaypal(getCost());
    }

    public void setCost(int cost) {
        this.thecost = cost;
    }

    public double getCost() {
        return this.thecost;
    }

    private void payWithPaypal(Double gg) {
        PayPalPayment newPayment = new PayPalPayment();
        Toast.makeText(getApplicationContext(),gg.toString(), Toast.LENGTH_LONG).show();
        BigDecimal bigDecimal=new BigDecimal(gg);
        newPayment.setSubtotal(bigDecimal);
        newPayment.setCurrencyType(Currency.getInstance(Locale.US));
        newPayment.setRecipient("email@hotmail.com");
        newPayment.setMerchantName("My Merchant");
        Intent paypalIntent = PayPal.getInstance().checkout(newPayment, this);
        this.startActivityForResult(paypalIntent, 1);
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T02:52:00.170

我们没有足够的信息来告诉您这里出了什么问题。出于某种原因，PayPal API 返回了失败状态代码。也许你没有互联网连接？

检查您在此行中检索到的错误消息字符串的值：

```
String errorMessage = data.getStringExtra(PayPalActivity.EXTRA_ERROR_MESSAGE); 
```

您可以使用调试器对其进行检查，也可以使用 Logger 类中的 Log.e 函数将其记录到 Logcat 以便您阅读。

至于你的第二个问题：

> 顺便说一句，你怎么称呼 private {}、private void {} - 所有那些看起来像 function() 的东西？

在 Java 中，那些“看起来像函数的东西”被称为方法。

编辑：好的，既然您已经向我们展示了您的 onCreate 方法，我可以看到您在哪里获得最终传递给 onInit 的值：

```
eprice = myBundle.getInt("eprice"); 
```

这样做意味着您将先前保存在捆绑包中的值`onSaveInstanceState(Bundle)`

是你做的吗？第一次启动 Activity 时，它是如何获取值的？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T01:05:24.303

使用我最新的代码，我不知道为什么我的 eprice 不起作用。但我有替代解决方案。我需要做的就是改变

initUI(eprice);

initUI(Double.valueOf(epricetxt));

# java - 归档 java 项目的 Eclipse 错误“编辑器不包含主类型”

> ID：14845593
> 
> 赞同：1
> 
> 时间：2013-02-13T02:42:05.800
> 
> 标签：java, eclipse

我收到错误消息：*编辑器不包含主类型*，或者，当我将存档的 Java 项目导入 Eclipse 并尝试运行它时，*选择不包含主类型。*我在几个不同的操作系统上遇到了这个错误。

**存档协议**

*   出口项目
*   常规->存档文件
*   全部被选中：项目文件夹、.classpath 和 .project
    *   [x] 以 zip 格式保存
    *   [x] 为文件创建目录结构
    *   [x] 压缩文件内容

**一个可以解释它的解决方法......** *但是如何？！*

我注意到，当我将存档项目导入现有项目（空白 Java 项目）时，文件夹层次结构类似于：

*   项目
    *   源代码
    *   垃圾桶
    *   进口项目
        *   垃圾桶
        *   源代码
            *   实际代码.java

现在，当我尝试运行时`actual_code.java`，出现上述错误。我发现了以下解决方法：如果我将`actual_code.java`它拖放到**Project->src** *然后*运行它，它就可以工作。

这是一个很好的解决方法。但是，我希望能够在不移动任何东西的情况下运行导入的项目。**关于如何做到这一点的任何建议？**看起来它*应该是*一个微不足道的修复——它只是看起来项目没有导入到它应该导入的地方。

**是的...**

我已经尝试了我遇到的每一种方法来解决这个问题。这包括来自这个站点和其他站点的很多内容：语法、库、源路径、重启 eclipse、重新归档、不同的操作系统、不同的机器......等等。

这些文件在我存档之前`.java`就在文件夹中，而且我的构建路径*似乎是*正确的。`src`

 ** * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T03:07:56.367

您可以将存档作为项目而不是文件导入新创建的空白项目。使用 Import > Existing Projects into Workspace。然后，使用选择存档文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T02:51:15.690

您可能希望将 import_project 的 src 文件夹放在类路径中。

右键单击您的项目 -> 属性 -> Java 构建路径 -> 源 -> 添加文件夹

![在此处输入图像描述](../Images/e2591b909b02343df4c919568f6eb58a.png)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-08-28T23:16:19.107

I also faced the same error ajnd after reading above article i just drag/drop my class-file to src and new class-file generated in src is working fine .

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2014-02-28T22:33:56.030

在我新建/Java 项目然后拉 src、docs、lib、examples、... 文件夹之后，我遇到了同样的问题。我无法将它作为 Eclipse 项目导入，因为代码不是 Eclipse 项目。main 就在示例代码中，但 IDE 会找到它。

我的解决方案是从 IDE 中删除项目，然后使用 Eclipse IDE 重新创建它。重新创建时，IDE 为我缓存了所有子文件夹。此外，请确保使用项目的“配置构建路径...”将代码作为源代码添加到 Java 构建路径中。

重新启动 IDE，关闭然后重新打开文件对我没有帮助。*

# haskell - Haskell，我不断收到“输入`='的解析错误”

> ID：14845597
> 
> 赞同：0
> 
> 时间：2013-02-13T02:42:58.247
> 
> 标签：haskell

我正在处理任务。我不知道为什么会收到此错误。

我通过注释指出了错误来自的行。

如果你可以（你不必），我认为我的`func`和`call`功能不起作用。

```
import Data.Maybe 

data Operator = Add | Sub | Mul | Div | And | Or | Not | Eq | Less | Great
  deriving (Eq, Show)
data Expression = Lit Value
         | Prim Operator [Expression]
         | Variable String
         | If Expression Expression Expression
         | Let [(String, Expression)] Expression
     | Func [String] Expression
     | Call Expression [Expression]
  deriving (Show, Eq)

data Value = Num Int
           | Bool Bool
       | Closure [String] Expression Environment
  deriving (Eq, Show)

type Environment = [(String, Value)]
--20
prim :: Operator -> [Value] -> Value
prim Add [Num a, Num b] = Num (a+b)
prim Mul [Num a, Num b] = Num (a*b)
prim Sub [Num a, Num b] = Num (a-b)
prim Div [Num a, Num b] = Num (a `div` b)
prim And [Bool a, Bool b] = Bool (a && b)
prim Or [Bool a, Bool b] = Bool (a || b)
prim Not [Bool a] = Bool (not a)
prim Eq [a, b] = Bool (a == b)
prim Less [Num a, Num b] = Bool (a < b)
prim Great [Num a, Num b] = Bool (a > b)
--32
evaluate :: Environment -> Expression -> Value
evaluate e (Lit v)  = v
evaluate e (Prim op as) = prim op (map (evaluate e) as)
evaluate e (Variable x) = fromJust (lookup x e)
evaluate e (If a b c)   = evaluate e (if fromBool (evaluate e a) then b else c)
evaluate e (Let bs b)   = evaluate ([(x, evaluate e d) | (x,d) <- bs ] ++ e) b

eval e (Func str ex) = (Closure str ex e) --40
evaluate e (Call ex exl) = let (Closure a b c) = (evaluate e ex) 
            in (Closure a b (c ++ (helper a (map (evaluate e) exl)))) 

helper :: [String] -> [Expression] -> [(String, Expression)]
helper (a:ar) (b:br) = (a, b) : helper ar br 

fromBool (Bool b) = b
--48
main = do
  let m = "m"
      k = Variable "k"  -- parse error on input `='
      y = Variable "y"
      lit m = Lit (Num m)
      a0 = Func [“k”] (Prim Mul [k, lit 2))
      in return $ Let [(“y”, a0)] (Prim Add [Call y [lit 3], Call y [lit 10]]) 
-- This is basically Let y = func(k) k*2 in y(3) + y(10) which returns 26. 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-13T02:55:09.210

*   第 40 行`eval`应该是，`evaluate`否则您将`evaluate`使用一些单独的、不相关的函数来分解函数的定义`eval`。

*   第 54、55 行。您正在使用一些 unicode 定向引号，但应该使用 ASCii `"`。

*   第 54 行，在需要方括号 ']' 时使用 ')'。

*   `helper`类型不正确，其类型会破坏抽象。为了使其正确，您应该更改`Expression`为`Value`，但为了保持您的抽象，您应该将结果设置为`Environment`.

编辑：

正如我所说，我将助手的类型签名更改为：

```
helper :: [String] -> [Value] -> [(String, Value)] 
```

编辑2：

评论您编辑的代码。您在第 55 行意外删除了左括号：

```
Let ["y", a0)]  -- should be Let [("y", a0)] 
```

在那之前的那一行，你试图修复一个有语法错误的列表`[ ... )`，但是你改变了错误的括号，导致`( ...)`而不是正确的`[...]`：

具体来说：

```
[k, lit 2] 
```

# javascript - 在 ie 8 中使用 jquery 转义 html 的简单方法

> ID：14845609
> 
> 赞同：0
> 
> 时间：2013-02-13T02:44:20.353
> 
> 标签：javascript, jquery, internet-explorer-8, innerhtml

我想将文本转换`"x < y"`为正确转义的`"x &lt; y"`. 我一直在使用浏览器的内置转义功能来做到这一点：

```
 div = $('<div></div>');
 div.text(my_text);
 escaped_text = div.html(); 
```

这很好用......直到我在 IE 8 中进行测试，当你调用 .html() 时它会吃掉换行符。是否有类似的简洁、强大的方法可以在 IE 8 中使用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T22:07:18.213

[下划线](http://underscorejs.org/)具有转义/取消转义方法。这是一个非常有用的库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T03:54:36.303

您可以像这样交换 innerHTML 属性的 html() 方法：

```
div = $('<div></div>');
div.text(my_text);
escaped_text = div[0].innerHTML; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-21T16:11:59.707

你可以试试这个：

**jQuery代码：**

```
(function ($) {
    $.fn.escapeHtml = function () {
        var e = document.createElement("DIV"),
            s = '';
        e.innerHTML = $(this).val();
        s = e.textContent || e.innerText || "";
        e.remove();
        return s.replace(/<\/?([a-z][a-z0-9]*)\b[^>]*>?/gi, '');
    }
})(jQuery); 
```

**如何使用：**

```
// if you want to real input value then, go with jQuery '.val()' option
var htmlString = $('#yourelement').val();

// remove html character, go with jQuery '.escapeHtml()' option
var safeHtmlString = $('#yourelement').escapeHtml(); 
```

或者您可以用作 jQuery 插件：

[jQuery.escapeHtml()](https://github.com/neerajsinghsonu/jQuery.escapeHtml)

# guava - guava 项目的测试套件生成器

> ID：14845610
> 
> 赞同：1
> 
> 时间：2013-02-13T02:44:23.720
> 
> 标签：guava

在 google-collections gtug 视频中提到了测试套件生成器并计划将其开源。

目前在 guava git 项目中有两个 maven 模块

1.  番石榴测试库
2.  番石榴测试

这两个模块是测试套件生成器的下一个版本吗？

粗略一看，这些模块中的代码似乎非常特定于 guava 项目。

有没有一种简单的方法来利用测试套件生成器中使用的库/代码/策略？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T14:06:59.530

是的，用于测试集合实现的自动测试套件生成器是 guava-testlib 中的大部分内容。[这篇文章](http://www.gamlor.info/wordpress/2012/09/google-guava-collection-test-suite/)解释了如何使用它。

# jquery - 当一个链接使用 jquery 做动画时，防止按钮再次被点击，直到完成

> ID：14845611
> 
> 赞同：0
> 
> 时间：2013-02-13T02:44:23.477
> 
> 标签：jquery, events, javascript-events

所以我在页面侧面有一个按钮，使用户能够转到下一张幻灯片（页面）

因为页面大小可以是不同的宽度，这是在开始时计算的

所以链接的作用是运行动画。如果我双击按钮虽然它动画很远

这是我的代码

```
jQuery(".nextSlide").click(function() {

slide("forward", pageSize);
    //for now assume pageSize is 950

}); 
```

* * *

```
function slide(data, pageSize) {
 var newLeft = calcLeft(data, pageSize);
 jQuery('#pageHolder').animate({
    left: newLeft
 }, 400, function() {
    calcNav(pageSize);
    calcPage(pageSize);
 });

} 
```

* * *

```
function calcLeft(action, pageSize){
    // there will only ever be 4 slides. 0 is pos1)
var currentPos = currentPosition();
if (action == "back") {
    if (currentPos == "0") {
        left = -pageSize * 3;
    } else {    
        left = currentPos + pageSize ;  
    }

} else if (action == "forward") {

    if (currentPos == -pageSize * 3) {

        left = 0;
    } else {
        left = currentPos - pageSize ;  
    }
return left;    
} 
```

* * *

```
function currentPosition() {
    var currentPosition = parseInt(jQuery("#pageHolder").css("left"), 10);
    return currentPosition;
} 
```

所以如果用户点击按钮

```
<a href="#" class="nextSlide">next</a> 
```

两次这会弄乱动画。

有什么方法可以确保

a) 当按钮被按下时，在动画完成之前不能再次按下

或者

b) 滑到下一张幻灯片，然后再次运行动画。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T02:51:31.807

将您的点击事件绑定到一个函数，以便您可以自己控制点击处理。该函数应执行以下操作：

```
function clickHandler(event) {

    // If event isn't already marked as handled, handle it
    if(event.handled !== true) {

        // Kill event handler, preventing any more clicks
        $(".nextslide").die("click");

        // Do your stuff here
        slide("forward", pageSize);

        // Mark event as handled
        event.handled = true;
    }
    // Else
    return false;
}

// Bind click to handler for the first time
$('.nextslide').live("click", clickHandler); 
```

如果它已经被点击，这将杀死元素上的事件。

然后在动画结束时，重新绑定事件：

```
// Rebind refresh click handler
$('.nextSlide').live("click", clickHandler); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T01:05:12.660

Working example

```
jQuery(document).ready(function () {
 jQuery(".touchslider-prev").on("click", clickHandlerPrev);
}); 
```

* * *

```
function clickHandlerPrev(event) {

// If event isn't already marked as handled, handle it
if(event.handled !== true) {

    // Kill event handler, preventing any more clicks
    jQuery(".touchslider-prev").off("click");

    // Do your stuff here

    slide("back");

    // Mark event as handled
    event.handled = true;
} 

return false;
} 
```

* * *

```
function slide(data) {

var newLeft = calcLeft(data, 950);

  jQuery('#pageHolder').animate({
    left: newLeft
  }, 400, function() {
    calcNav(950);
    calcPage(950);
    jQuery(".touchslider-prev").on("click", clickHandlerPrev);

  });

} 
```

* * *

# javascript - Javascript 中的一个简单的 this 上下文更改示例

> ID：14845618
> 
> 赞同：1
> 
> 时间：2013-02-13T02:45:33.920
> 
> 标签：javascript

我是 JS 新手，已经阅读了很多关于内容更改的怪癖行为`this`，所以我做了一个最简单的例子：

**HTML**

```
<button>button1</button> 
```

**JavaScript**

```
var button1, getText

button1 = document.getElementsByTagName('button')[0]

getText = function(){alert(this.textContent)}

button1.addEventListener('click', getText) 
```

[http://jsfiddle.net/e95ME/](http://jsfiddle.net/e95ME/)

但我看不到`this`更改的上下文，因为代码有效。任何人都可以更改此代码或给出另一个简单的示例来显示内容更改的怪癖行为`this`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T02:48:56.137

```
var button1, getText

button1 = document.getElementsByTagName('button')[0]

getText = function(){alert(this.textContent)} // called in context of `button1`

button1.addEventListener('click', getText)

getText(); // called in context of `window` 
```

当窗口加载时，它会说`undefined`，因为没有属性`window.textContent`。当您单击按钮时，它应该说`button1`因为它是在按钮的上下文中调用的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T02:53:21.040

你是这个意思吗？

```
var button1, getText

button1 = document.getElementsByTagName('button')[0]

getText = function() {
    this.textContent = "changed content";
}

button1.addEventListener('click', getText) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-13T02:48:59.597

单击按钮时，事件侦听器将设置`this`为 DOM 元素本身。

就好像你的函数是这样调用的：

```
getText.call(<button-element>, <event>) 
```

# iphone - 如何保存 NSMutableArray 的顺序

> ID：14845619
> 
> 赞同：0
> 
> 时间：2013-02-13T02:45:35.300
> 
> 标签：iphone, xcode

我有一个`NSMutableArray`，我改变了它的内容的顺序。如何在不使用关系的情况下将其顺序保存在核心数据中，还是应该使用`NSUserDefaults`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T03:09:04.337

为什么不在您想要保留其顺序时使用第二个数组作为第一个数组的副本？它不必是可变数组 - 使用`[myArray immutableCopy]`

如果出于内存原因不想复制数组中的所有项目，也许将位置存储为 NSInteger？让第一个数组包含项目，第二个数组包含第一个数组的索引。

# xcode - 在不使用 XCode 的情况下将 PhoneGap 添加到 Xcode 项目中

> ID：14845623
> 
> 赞同：0
> 
> 时间：2013-02-13T02:46:53.710
> 
> 标签：xcode, cordova, github, phonegap-plugins, phonegap-build

我只运行 Windows 7 桌面。我的下一个项目是关于由我的程序员同事创建的社交网络应用程序。[在这里](https://github.com/kerwintang/BoyKuripot)查看他在 Github 存储库中的 XCode 项目。

他要求我将这个 iOS 兼容应用程序转换为兼容 Android 的应用程序，以便他创建的应用程序现在可以在 Android 上运行。

我发现了[PhoneGap Build](https://build.phonegap.com/)，这是一个在线应用程序转换器，需要复制 GitHub 存储库的 URL，为了使转换成功，我必须实现某种 PhoneGap 引擎（Cordova.jar、HTML5 [index.html] 和一个简单的 Javascript）。

最好在 Xcode 中执行此操作，但 Xcode 需要 Mac OS X。如果可能的话，是否有另一种方法可以在没有 Xcode 的情况下添加 PhoneGap 引擎？

这就是为什么我必须在不使用 XCode 的情况下更新和添加 PhoneGap 的原因，因为我在 Windows 7 上运行，然后再次尝试使用 PhoneGap Build 对其进行转换。这是图片：

![在此处输入图像描述](../Images/9d68a11607bc7243a8f09b1051fccda8.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-18T12:47:25.447

PhoneGap 允许开发人员使用 HTML5 构建本机应用程序 - 本质上，Web 应用程序被打包到本机应用程序容器中，该容器仅呈现 Web 视图，然后将 Web 应用程序中的 index.html 加载到该 Web 视图中并将控制权传递给 Web 应用程序。

没有将原生 iOS 应用程序转换为 Android 应用程序。

您不需要 Xcode 来使用 PhoneGap Build 打包 PhoneGap 应用程序 - 您所需要的只是应用程序的 Web 内容。当您启动构建过程时，构建服务会将您的 Web 应用程序打包到适用于 Android、BlackBerry、iOS、webOS、Windows Phone 的本机应用程序中。

您可以在我的书 PhoneGap Essentials - www.phonegapessentials.com 中了解很多关于 PhoneGap 的信息。

# hibernate-mapping - 同一张表的休眠 OneToMany 映射

> ID：14845624
> 
> 赞同：0
> 
> 时间：2013-02-13T02:47:32.103
> 
> 标签：hibernate-mapping

我有一张学生桌，一个学生可以有很多朋友。朋友也是学生。所以我又添加了一张表 Friends，其中包含三列 id、studentid、friendid，其中 studentid 和friendid 是学生表中 id 的外键。现在如何在 Hibernate 中进行 OneToMany 映射？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T11:06:45.103

您需要在这里使用的不是 OneToMany，而是 ManyToMany！一个学生可以有很多朋友，他可以是很多学生的朋友。

```
public class Student {

   private List<Student> friends;

} 
```

和 HBM 映射：

```
<set name="friends" table="FRIENDSHIP">
   <key column="studentId"/>
   <many-to-many column="friendId" class="Student"/>
</set> 
```

# c# - sql to linq 语句，带左连接、分组和 case 语句

> ID：14845628
> 
> 赞同：0
> 
> 时间：2013-02-13T02:47:56.627
> 
> 标签：c#, sql, asp.net-mvc-3, linq-to-sql

我只是 MVC3 的新手，有一个小问题。我想将此 SQL 语句转换为 Linq。谁能帮我解决这个问题，这是我的sql语句：

```
SELECT a.payment_ref_no, 
       c.institution_name, 
       a.check_date, 
       batchstatus = CASE 
                       WHEN d.mccount = Count(b.check_detail_no) THEN 
                       'Completed' 
                       WHEN d.mccount IS NULL THEN 'Approved' 
                       WHEN d.mccount < Count(b.check_detail_no) THEN 
                       'Partially Processed' 
                     END, 
       noofpayments=Count(b.check_detail_no), 
       totalamount=Sum(b.check_amount), 
       d.mccount 
FROM   check_request a 
       JOIN check_details b 
         ON a.request_ref_no = b.request_ref_no 
       JOIN institution c 
         ON a.company_code = c.company_code 
       LEFT JOIN vw_batchstatus d 
              ON a.request_ref_no = d.request_ref_no 
WHERE  a.payment_ref_no IS NOT NULL 
GROUP  BY a.payment_ref_no, 
          a.check_date, 
          c.institution_name, 
          d.mccount 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T06:53:15.280

大部分是凭记忆完成的，可能存在一些问题，但对您来说应该是朝着正确方向迈出的一步。

```
var test =  from a in check_request
        join b in check_details on a.request_ref_no equals b.request_ref_no
        join c in institution on a.company_code equals c.company_code
        join d in vw_batchstatus on a.request_ref_no equals d.request_ref_no into dvwinner
        from d in dvwinner.DefaultIfEmpty()
        where a.payment_ref.HasValue
        group a by new (a.payment_ref_no, a.check_date, c.institution_name, d.mccount) into gr1
        select new {
            ref_no = a.payment_ref_no,
            inst_name = c.institution_name,
            check_date = a.check_date,
            batstat = !d.mccount.HasValue ? 'Approved' : d.mccount == b.check_detail_no.Count() ? 'Completed' : 'Partially Processed',
            noofpayments = b.check_detail_no.Count(),
            ttlamount = gr1.Sum(p=>p.check_amount),
            mccount = d.mccount
        }; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T03:08:00.127

感谢Kyle的帮助。我终于解决了自己的问题，这是我的sql语句的linq

```
var test =  from a in CHECK_REQUESTs
    join b in CHECK_DETAILS on a.REQUEST_REF_NO equals b.REQUEST_REF_NO
    join c in INSTITUTIONs on a.COMPANY_CODE equals c.COMPANY_CODE
    join d in Vw_BatchStatus on a.REQUEST_REF_NO equals d.REQUEST_REF_NO into t from rt in     t.DefaultIfEmpty()
        where a.PAYMENT_REF_NO != string.Empty 
        let institutionName = (string)c.Institution_Name
        let mcCount = (int)rt.Mccount
        group b by new 
        {
        a.PAYMENT_REF_NO, 
        a.Check_Date, 
        institutionName, 
       mcCount
        } into gr1
        select new 
        {
        gr1.Key.PAYMENT_REF_NO, 
        gr1.Key.institutionName, 
        gr1.Key.Check_Date,
        batchstatus = (gr1.Key.mcCount == gr1.Count()) ? "Completed" : 
        (gr1.Key.mcCount < gr1.Count()) ? "Partially Processed": 
        (gr1.Key.mcCount == null ) ? "Approved" : " ",
        noofpayments = gr1.Count(),
        totalamount = gr1.Sum(c => c.Check_Amount)
        }; 
```

# git - 更改 octopress git commit 文件夹

> ID：14845629
> 
> 赞同：1
> 
> 时间：2013-02-13T02:47:58.700
> 
> 标签：git, github, octopress

我正在使用 octopress 在**username.github.com/title**创建我的博客，其中 title 是博客的标题。

在中`_config.yml`，我已经配置了`permalink: /:title/`

**它现在在username.github.com/title**上创建博客，但是当我提交它时，它会在目录的根目录上创建一个带有标题的文件夹，而不是在博客文件夹内。

您如何更改它以使其在博客文件夹中提交，以便我的所有博客都分组在一个文件夹中，同时我的博客仍然位于**username.github.com/title**？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-18T11:27:34.530

也许你可以尝试如下`_config.yml`

```
root: /
permalink: /blog/:year/:month/:day/:title/ 
```

# c# - 选择设计模式以在 C# 客户端应用程序中使用 SOAP Web 服务

> ID：14845633
> 
> 赞同：1
> 
> 时间：2013-02-13T02:48:52.637
> 
> 标签：c#, web-services, design-patterns

我有一个 C# 客户端应用程序，我需要使用两个托管在外部 webMethods 环境中的 SOAP Web 服务，它们公开相同的功能（相同的名称、相同的参数和数据类型），即

Web 服务 1 - ManualLoadProduction

功能 1 - LoadMontlyData（字符串月份）

功能 2 - LoadYearlyData（字符串年份）

Web 服务 2 - ManualLoadConsumption

功能 1 - LoadMontlyData（字符串月份）

功能 2 - LoadYearlyData（字符串年份）

我在我的 C# 解决方案中为这两个 Web 服务添加了 Web 参考。我可以简单地单独调用这些函数，但是，我需要构建一个分层的解决方案。我应该如何设计/实施解决方案

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-13T12:42:43.120

您有一个可以在整个应用程序中使用的界面。这允许消费代码依赖于合约而不是特定的实现。

```
public interface IServiceWrapper{

    Data  LoadMontlyData(string Month);
    Data LoadYearlyData(string Year);
} 
```

这是 ManualLoadProduction 包装器的一种实现。包装服务方法允许您围绕服务调用包装其他功能，例如额外的验证或对象映射。

```
public class ManualLoadProductionWrapper: IServiceWrapper{

      public Data LoadMontlyData(string Month){
         //implementation calls service method
      }

       public Data LoadYearlyData(string Year){
         //implementation calls service method
      }
}

public class ManualLoadConsumption: IServiceWrapper{

      public Data LoadMontlyData(string Month){
        //implementation calls service method
      }

      public Data LoadYearlyData(string Year){
       //implementation calls service method
      }
} 
```

# c# - 表格可以在winforms应用程序中包含另一个表格吗？

> ID：14845638
> 
> 赞同：0
> 
> 时间：2013-02-13T02:49:04.263
> 
> 标签：c#, winforms, forms

我想让一个表格包含另一个表格；为了使用父控件在同一个父窗体中浏览不同的子窗体。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T02:55:46.613

您可以使用 TabControl 将不同的控件组合在一起，但是如果您真的需要一个子表单，您可以使用 MDI 表单。

这是一个选项卡控件：

![在此处输入图像描述](../Images/5aa22b3cd955b78c48258c0e9291ea87.png)

它基本上对每个单独的选项卡都有一个组框，因此您可以随意添加和删除。

来自 tabcontrol 的文档：

> TabControl 包含选项卡页，这些选项卡页由您通过 TabPages 属性添加的 TabPage 对象表示。此集合中选项卡页的顺序反映了选项卡在控件中出现的顺序。用户可以通过单击控件中的选项卡之一来更改当前的 TabPage。

和 MDI：

> 多文档界面 (MDI) 应用程序允许您同时显示多个文档，每个文档都显示在自己的窗口中。MDI 应用程序通常有一个带有子菜单的窗口菜单项，用于在窗口或文档之间切换。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T10:48:07.000

解决方法是设置父表单属性

`IsMdiContainer = true ;`

并设置子表单

```
childForm.MdiParent = parentForm; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-13T02:53:35.953

我相信您正在 C# 中寻找 TabControl。这允许浏览同一父表单中的不同选项卡。您可以参考[C# 中的 TabControl](http://www.dotnetperls.com/tabcontrol)了解更多信息。

希望这可以帮助。

# vb.net - VB.Net 中的类设计

> ID：14845646
> 
> 赞同：0
> 
> 时间：2013-02-13T02:50:23.643
> 
> 标签：vb.net

-Edit- 这是针对我正在设计的财务 API 的。我正在创建一些空类，以了解总体结构。我主要关心的是设计一个愉快的用户体验，而不需要手册来解释如何使用它。-结束编辑-

我一直在挠头，试图想出设计特定课程的最佳方法。我将创建一个*通用示例*来说明。

```
Namespace SomeNamespace 
    Public Class Results
        Public a1 as Integer
        Public a2 as Integer
        ...
        Public b1 as Integer
        ...
        Public z1 as Integer
    End Class
End Namespace 
```

上面的例子是通用的，但重点是类中有很多值。变量名称中的字母代表一组相似的结果。“a”结果是相似的，“b”是相似的，等等。我曾想过在 Results 类中为每种类型的结果值（因为它们是一种结果，但彼此分离的概念）创建一个类，例如...

```
Public Class Results
    Class a 
        Public a1 as Integer
    End Class
    Class b ... End Class
End Class 
```

问题在于，当一个人使用该类时，它并不明确

```
Dim ResultObject as new SomeNamespace.Results.a() 
```

必须首先实例化结果对象，因为任何子类 a、b 等都将依赖于结果对象。但是用户会看到对象 a、b 等，并且可能不知道他们必须首先创建父对象。

我考虑过将类分开，每个构造函数都会创建一个 Result 对象，但这在逻辑上似乎倒退了。有什么建议吗？对不起，如果它令人困惑。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T02:54:46.690

为什么不使用单个二维整数数组，其中第一个索引是结果类（即字母 'a' 或 'b' 等），第二个索引是结果编号（即 a1 或 z2 等）？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T20:42:54.000

为什么不创建一个抽象类 Result 并创建一个继承结构 ResultTypeA、ResultTypeB 等？由于没有关于问题的详细信息，很难给出有意义的答案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-13T21:18:05.363

两个快速建议。

1）在课堂上，不要公开你的领域。只公开方法和属性。如果您使用自动实现的属性，只需在声明中添加 Property 关键字即可。否则，将您的字段声明为私有，并将其公开的属性声明为公共：

```
Public Class Foo
   Private _V1 As Integer  ' Backing field
   Public Property V2 As Integer ' Auto Property
   Public Property V1 As Integer ' With backing field
       Get
           Return _V1
       End Get
       Set (Value as Integer)
           _V1 = value
       End Set
   End Property
End Class 
```

2）不要嵌套你的类声明。代替

```
Public Class Results
    Class a 
        Public a1 as Integer
    End Class
    Class b ... End Class
End Class 
```

请执行下列操作：

```
Public Class Results
  Public Property A1 As A
  Public Property B1 As B
End Class
Public Class A
  Public Property A1 As Integer
End Class
Public Class B
  Public Property B1 As Integer
End Class 
```

对于命名约定，您应该将属性命名为名词，将方法命名为动词。关于您的订购问题，我建议从类别（名词）开始，然后以越来越具体的术语在其后添加形容词：

```
 Property NameFirst As String
  Property NameLast As String
  Property ContactEmail As String
  Property ContactPhoneHome As String
  Property ContactPhoneWork As String 
```

# bash - 使用 BASH 命令将字符串 7.3M 转换为字节

> ID：14845647
> 
> 赞同：1
> 
> 时间：2013-02-13T02:50:37.767
> 
> 标签：bash

我正在尝试根据可以采用诸如 7.4M 之类的值的参数查找文件，但似乎我无法使用：

```
FileSize=7.4M
find . -size $FileSize 
```

这样做会导致“非法尾随字符”

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T03:16:33.067

问题不是“M”（你可能已经知道了），而是 7.4。数值必须是一个整数，后跟一个可选的缩放值。以下应该有效：

```
FileSize=7400k
find . -size $FileSize 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-13T03:02:34.223

也许您可以使用[**按位运算**](http://unix.com/shell-programming-scripting/116305-shell-script-convert-file_size-bytes-megabytes.html)

```
FileSize=7
find . -size $(( FileSize << 20 )) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-13T13:01:15.873

我编写了这个函数，将您的输入标准化为整数：

```
normalize() { echo "$1" | awk -FM '/M/ { printf "%dk", $1*1024 }; !/M/ { print $1 }'; } 
```

定义此函数后，您可以像这样使用它：

```
$ echo $(normalize 7.4M)
7577k
$ echo $(normalize 15k)
15k 
```

所以你可以这样写你的代码：

```
find . -size $(normalize $FileSize) 
```

但无论如何我都会建议反对。在 bash 中做这样的语法糖是很棘手的，并且是小错误的秘诀。例如， normalize() 的用户可能期望“15.5k”可以工作，但事实并非如此。此外，用户可能期望 7.4M 没有被这个函数四舍五入，但它是（事实上，文件不可能*正好是*7.4mb，因为 7.4mb = 7759462.4 字节）。

最好遵循 find 的语法，就像 chepner 建议的那样。

此外，在大多数情况下，您可能应该使用类似

```
find . -size +7M -and -size -8M 
```

查找间隔内的文件（在本例中，在 7mb 和 8mb 之间）。如果开头没有 + 或 -，它将仅查找具有此确切大小的文件。但正如我所说，没有一个文件正好是 7.4mb。您可能从报告近似值的程序中获得此大小。

# java - 时间范围为 15 分钟的日期

> ID：14845655
> 
> 赞同：-3
> 
> 时间：2013-02-13T02:52:11.167
> 
> 标签：java, jpa

我想检查当前日期时间是否正好是 15 分钟

示例：10:15,10:30,10:45,11:00,11:15,11:30,11:45 ....

我怎样才能做到这一点

```
Calendar calendar = Calendar.getInstance();

int hours = calendar.get(Calendar.HOUR_OF_DAY);

int minutes = calendar.get(Calendar.MINUTE);

int seconds = calendar.get(Calendar.SECOND);

int s=minutes %15;

if((minutes == 0 ) && s==0 )
{
    System.out.print("Time ");   

} 
```

我可以这样用吗..

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-13T02:56:58.027

试试这个 ：

```
Calendar cal = Calendar.getInstance();
int minute = cal.get(Calendar.MINUTE);
if(minute % 15 == 0) 
{
    System.out.println("the current date time is exactly 15 minute");
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-13T02:57:21.173

看看[石英](http://quartz-scheduler.org/documentation/quartz-2.x/tutorials/tutorial-lesson-06)：

```
CronTrigger cronTrigger = TriggerBuilder.newTrigger()
                       .withSchedule(CronScheduleBuilder.cronSchedule("* 0/15 * * * ?"))
                       .build(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-13T02:58:21.567

`Calendar.get(Calendar.MINUTE)`应该可以帮助你。

```
public void minuteOfHour(){

    Calendar rightNow = Calendar.getInstance();
    System.out.println(rightNow.get(Calendar.MINUTE));
} 
```

或者更好的是，考虑 Joda Time 的 DateTime API。它提供了一个方便的 minuteOfHour 方法。

[http://joda-time.sourceforge.net/apidocs/org/joda/time/DateTime.html#minuteOfHour()](http://joda-time.sourceforge.net/apidocs/org/joda/time/DateTime.html#minuteOfHour())

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-13T03:00:21.810

```
public boolean isFifteenMin(DateTime datetime)
    return (Integer.parseInt(new SimpleDateFormat("m").format(datetime))%15==0) ? true :     false;
} 
```

# android - 使用 Xperia SO-03C 运行 Android 进行调试

> ID：14845656
> 
> 赞同：0
> 
> 时间：2013-02-13T02:52:26.867
> 
> 标签：android, eclipse, debugging, usb, sony

我想使用运行 Android 2.3.4 的索尼爱立信 Xperia SO-03C 手机来调试我的应用程序。我已通过 USB 端口将它连接到我的 Macbook Air，但似乎 Eclipse 无法识别它（尽管我可以为设备充电）。

我已经在手机上启用了“USB调试”。我也尝试过“adb devices”，但它没有显示我的手机。我也尝试过停止和启动服务器但无济于事（adb kill-server/adb start-server）。我不知道下一步该尝试什么。

非常感谢任何帮助或建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T08:41:30.810

这个问题确实是我使用的电缆。它不支持数据传输。这个[问题](https://stackoverflow.com/questions/4996406/%E2%80%A6)让我明白了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T03:26:31.937

您是否安装了手机的**设备驱动程序**？

# python - 如果不包含逗号，则正则表达式输出前导和尾随引号

> ID：14845658
> 
> 赞同：0
> 
> 时间：2013-02-13T02:52:40.853
> 
> 标签：python, regex, perl, excel, csv

我完全不知道如何做到这一点。

**我的问题：**我想接受这个：

```
"A, two words with comma","B","C word without comma","D"
"E, two words with comma","F","G more stuff","H no commas here!"
... (continue) 
```

对此：

```
"A, two words with comma",B,C word without comma,D
"E, two words with comma",F,G more stuff,H no commas here!
... (continue) 
```

我使用的软件在文本文件中创建了 1,900 条记录，我认为它应该是 CSV，但编写该软件的人不知道 CSV 文件是如何工作的，因为如果单元格包含逗号，它只需要引号（对吗？）。至少我知道在 Excel 中它将所有内容都放在第一个单元格中......

我希望这可以使用某种命令行工具（如 perl 或 python）来解决（我在 Mac 上）。我不想用 Java 或任何东西来处理这个问题。

任何帮助是极大的赞赏！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T03:04:39.830

这里在黑暗中拍摄，但我认为 Excel 将所有内容都放在第一列，因为它不知道它被给予逗号分隔的数据。

Excel 具有“文本到列”功能，您可以在其中通过分隔符拆分列（确保选择逗号）。

这里有更多信息：

[http://support.microsoft.com/kb/214261](http://support.microsoft.com/kb/214261)

*编辑*

您也可以尝试将文件从 *.txt 重命名为 *.csv。这将改变 Excel 读取文件的方式，因此它可以更好地理解如何解析它在其中找到的任何内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T03:04:46.470

如果只是 bashing 是一种选择，您可以在终端中尝试这个单行：

```
cat file.csv | sed 's/"\([^,]*\)"/\1/g' >> new-file.csv 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-13T03:04:58.777

这在技术上应该没问题。它是用 " 分隔的文本，并通过使逻辑复杂化并引用所有内容。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-13T03:10:54.250

清理它的一种方法是将数据输入`csv`并转储回去。

```
import csv
from cStringIO import StringIO

bad_data = """\
"A, two words with comma","B","C word without comma","D"
"E, two words with comma","F","G more stuff","H no commas here!"
"""

buffer = StringIO()
writer = csv.writer(buffer)
writer.writerows(csv.reader(bad_data.split('\n')))

buffer.seek(0)
print buffer.read() 
```

Python[`csv.writer`](http://docs.python.org/2/library/csv.html#writer-objects)将默认使用“excel”方言，因此在不需要时不会写逗号。

# web - 我可以通过任何连接访问我的网站。但如果我使用 3G 或 4G 无线连接，我就不能。有什么线索吗？

> ID：14845661
> 
> 赞同：0
> 
> 时间：2013-02-13T02:53:16.130
> 
> 标签：web, dns, wireless

问这么莫名其妙的事情感觉很奇怪，但是，只要我在 WiFi/以太网连接上，我就可以使用任何设备上的任何浏览器访问我的网站 [www.esmandau.com][1]。

当我选择通过智能手机的 3G 或 4G 连接或桌面上的任何无线 3g/4g 卡访问它时，网站将无法加载。

我在波多黎各、美国和阿根廷进行了测试。

没遇到过这样的问题，没听说过。。。

这是我的服务器的 IP：208.109.104.179

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T03:00:55.740

我可以通过 4G（Verizon LTE，在 iPhone 5 上）和 WiFi 从美国正常访问它。我怀疑您的运营商正在进行一些审查 - 我注意到首页上有关于越狱手机的链接......

您所有的无线网卡都通过同一个运营商吗？

# php - 来自数组的数据库中的字符串

> ID：14845663
> 
> 赞同：0
> 
> 时间：2013-02-13T02:53:19.327
> 
> 标签：php, sql, arrays, push, slice

嗨，我正在寻求帮助，我所做的是发送我想要为我的博客文章选择的图片的值，并将它们全部推送到数组中，当我提交表单时，图片“数组”保存到数据库像这样

桌子

```
article_id  file_name          title  body         date            author
1           img1.jpg           lorem  lorem ipsum  11/11/2103      mitchell
2           img2.jpg,img3.jpg  lorem  lorem ipsum  11/11/2013      mitchell 
```

但是我需要帮助的是，当我回显 article_id = 2 时，我需要将它们存储在这样的数组中

```
$list = array(1 => 'img2.jpg', 2 => 'img3.jpg'); 
```

提前感谢您的任何帮助/建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T04:45:10.243

试试这哥们.....

```
 $result = 'img2.jpg,img3.jpg';

  $res = explode(',',$result);

  print_r($result); 
```

对于示例示例，请查看此[链接](http://eval.in/9643)，并通过此链接进行[爆炸](http://php.net/manual/en/function.explode.php)参考。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T05:07:35.007

从数据库中选择 article_id = 2 的所有数据

```
$images    = $result['file_name'];

$img_array = explode(",",$images);

print_r($img_array); 
```

# ruby-on-rails - RoR - 专门使用另一个系统 API 的项目？

> ID：14845673
> 
> 赞同：0
> 
> 时间：2013-02-13T02:53:58.353
> 
> 标签：ruby-on-rails, wrapper, rails-activerecord

Ruby 和 Rails 的绝对初学者。我的第一个成熟项目将通过 REST api 与现有系统交互。

所以它不使用正常的 ActiveRecord 模型，我希望有一些项目示例可以用 API 调用替换模型的正常使用。整个 CRUD 集将要求应用程序进行相应的 API 调用。我想以正确的方式做到这一点，只是还不知道那是什么样子。

谢谢！:)

对 Google 员工有用的链接：

[http://yetimedia.tumblr.com/post/35233051627/activeresource-is-dead-long-live-activeresource](http://yetimedia.tumblr.com/post/35233051627/activeresource-is-dead-long-live-activeresource) [https://github.com/rails/activeresource](https://github.com/rails/activeresource)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T03:08:15.690

我不知道有任何开源项目可以做到这一点，但我建议您研究一下[Active Resource](https://github.com/rails/rails/blob/3-2-stable/activeresource/README.rdoc)。它是 Rails 3.2 的一部分，但已移至Rails 4 的[单独存储库](https://github.com/rails/activeresource)。其想法是，它允许您用 RESTful API 替换数据库持久性，这听起来正是您想要做的。[这里](http://rubydoc.info/gems/activeresource/3.2.12/frames)有一些文档可以为您提供足够的信息来开始工作。上面还有一个[相当古老的 Railscast](http://railscasts.com/episodes/94-activeresource-basics)，但我确信这些概念并没有真正改变太多。

这是文档中的一个示例，显示了如何设置“模型”：

```
class Person < ActiveResource::Base
  self.site = "http://api.people.com:3000"
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T03:10:32.780

我建议利用`ActiveModel`这样你的模型不是“AR”支持的，即没有通过 AR 的持久性。您将在您的控制器中相应地处理 CRUD，并制作您自己的“业务逻辑”，您可以将其放入您的`ActiveModel`.

# grails - 在 Grails 上使用反射时，我们可以获得闭包信息吗？

> ID：14845675
> 
> 赞同：0
> 
> 时间：2013-02-13T02:54:06.943
> 
> 标签：grails, reflection, groovy

因此，我们的任务是为我们正在构建的 REST API 生成文档。我们正在使用 Grails，它的所有定义都很好，`UrlMappings`但这并没有按照我们想要的方式生成文档。

我们考虑使用反射将映射提取为可以通过代码操作的某种格式。

还有可能将其解析`UrlMappings`为文本文件并生成一些我们可以操作的数据格式。

对于反射位，我们可以从 Groovy 中的闭包中提取信息——例如属性、方法等吗？

任何其他想法将不胜感激。

# html - 我将如何复制这种输入文本效果，它们几乎是 CSS/HTML 中的合并框？

> ID：14845680
> 
> 赞同：0
> 
> 时间：2013-02-13T02:54:49.957
> 
> 标签：html, css

在 dribbble 上看到这张图。我将如何在 CSS 中创建这种效果？我指的是几乎合并的两个输入字段，并且它们之间有一个非全角分隔符。

![在此处输入图像描述](../Images/22299f0a8397478292e66a0dcbc55823.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T03:05:02.153

像这样的东西：

```
#inputwrap {
    border: 1px solid #aaa;
    background: #fff;
    width: 180px;
    padding: 10px;
    margin: 20px;
}
#inputwrap input {
    border: none;
    width: 160px;
    padding: 5px 10px;
    outline: none;
}
#inputwrap input:first-child {
    border-bottom: 1px solid #aaa;
} 
```

[http://jsfiddle.net/2tHfG/](http://jsfiddle.net/2tHfG/)

# emacs - emacs 宏没有定义命令

> ID：14845681
> 
> 赞同：0
> 
> 时间：2013-02-13T02:55:03.327
> 
> 标签：emacs, macros, elisp, alias

我编写了一个创建别名并根据名称生成全局键绑定的宏。我希望如果我将以下代码添加到我的 emacs 配置中，例如：

```
(defkey-alias cool-function make-directory) 
```

我将使用命令 my-cool-function 创建一个目录和一个键绑定 Cc cf 到它。但是经过评估，我有键绑定但没有命令 my-cool-function。

如果我执行 Ch k Cc cf 我会看到：

```
C-c c f runs the command my-cool-function, which is an alias for `make-directory'. 
```

我也无法*从头开始*评估（my-cool-function） 。

但是，如果我尝试 (macroexpand '(defkey-alias cool-function make-directory)) 然后评估扩展的 s-expr 它可以工作。

调用宏和调用宏扩展然后求值有什么区别？为什么别名不可调用？谢谢你。

Emacs 版本是 GNU Emacs 24.2.1，Windows 7

编码：

```
;;; defining keys
(defun name-to-key(funname)
  " works like:
    'my-cool-function -> \"\C-cmcl\"  "
  (apply 'concat 
         "\C-c"
         (mapcar (lambda(str)(substring str 0 1))
                 (split-string (symbol-name funname)
                               "-"))))

(defmacro defkey-alias(alias function)
  "works like defalias but you should not quote symbols and sets global key mapping
Usage: (defkey-alias mkdir make-directory)"
  (let ((myalias (make-symbol (concat "my-" (symbol-name alias)))))
    `(progn
       (defalias ',myalias ',function)
       (global-set-key ,(name-to-key alias) ',myalias)))) 
```

更新：使用 (defun ...(interactive)(call-interactively 'function)) 也不起作用

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T04:12:42.873

原因很简单：`(make-symbol (concat "my-" (symbol-name alias)))`返回一个非实习符号。即它返回一个名称为的符号，`my-cool-function`但它与您编写时得到的符号不同`(my-cool-function)`。因此，`make-symbol`您不想使用`intern`.

# c++ - 修改系统时钟时 boost::deadline_timer 可能会失败

> ID：14845682
> 
> 赞同：9
> 
> 时间：2013-02-13T02:55:04.653
> 
> 标签：c++, boost, timer, boost-asio, clock

可以在以下位置阅读：

[https://svn.boost.org/trac/boost/ticket/3504](https://svn.boost.org/trac/boost/ticket/3504)

[如果系统时间被修改（例如](http://www.boost.org/doc/libs/1_40_0/doc/html/boost_asio/tutorial/tuttimer3/src.html)，使用date命令，如果您的操作系统是Linux）。

现在有没有一种简单而合适的方式来执行这个操作，使用 Boost？我不想使用 deadline_timer::expires_from_now() 因为我可以验证它不如“手动”更新到期时间准确。

作为一种临时解决方案，我决定在设置新的 expires_at 值之前，计算 now() 和 expires_at() 之间的时间段。如果它是周期性延迟的两倍以上，那么我会异常使用 expires_from_now() 与新的绝对时间重新同步。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-13T07:10:18.577

在 Boost 1.49+ 中，[Boost.Asio](http://www.boost.org/doc/libs/1_53_0/doc/html/boost_asio/history.html)提供[`steady_timer`](http://www.boost.org/doc/libs/1_53_0/doc/html/boost_asio/reference/steady_timer.html). 此计时器使用[`chrono::steady_clock`](http://www.boost.org/doc/libs/1_53_0/doc/html/chrono/users_guide.html#chrono.users_guide.tutorial.clocks)不受系统时钟更改影响的单调时钟。

如果您不能使用 Boost 1.49+，那么检查计时器或时钟的变化是一个合理的替代解决方案。虽然它是一个实现细节，但 Boost.Asio 可能会限制在其反应器中等待事件所花费的时间，以便它可以定期检测系统时间的变化。例如，使用的反应器实现`epoll`将等待最多 5 分钟。因此，在不对反应器强制中断的情况下（例如在计时器上设置新的过期时间），Boost.Asio 最多可能需要 5 分钟才能检测到系统时间的更改。

# ruby-on-rails - 即使表中的用户名也没有用户名字段

> ID：14845688
> 
> 赞同：1
> 
> 时间：2013-02-13T02:55:57.927
> 
> 标签：ruby-on-rails, validation, email, email-validation

我正在关注 Railscast 第 235 集，其中 Ryan Bates 将omniauth 与 Devise 集成。单击 Twitter 登录后，他的应用程序会将他带回到应用程序中的一个表单，他必须在电子邮件字段中输入电子邮件地址才能完成注册。（由于他编写会话代码的方式，他的用户名已经填写在表格中）。表格如下图所示。请注意他如何使用 f.email_field 来输入他的用户名，即使他在表中有一个用户名字段。他的应用程序在视频中成功运行。

![在此处输入图像描述](../Images/9b4115a6732b32cb4d348f0dcf169848.png)

我已经下载了他的源代码，但是当我尝试运行它时，我无法完成注册，除非我在电子邮件字段中输入电子邮件以及在用户名字段中输入电子邮件。因此，我更改了代码以将 a`f.username_field`放入注册表中

```
<div class="field"><%= f.label :username %><br />
  <%= f.username_field :username %></div> 
```

但我收到了这个错误

```
undefined method `username_field' for #<ActionView::Helpers::FormBuilder:0x007fc058a242c8> 
```

:username 列在 User.rb 模型的可访问属性中，这是用户表，带有一个用户名字段，所以我不知道为什么我会得到“未定义的方法”用户名字段。该应用程序只允许我输入用户名标签所在的电子邮件地址

```
 create_table "users", :force => true do |t|
    t.string   "email",                  :default => "", :null => false
    t.string   "encrypted_password",     :default => "", :null => false
    t.string   "reset_password_token"
    t.datetime "reset_password_sent_at"
    t.datetime "remember_created_at"
    t.integer  "sign_in_count",          :default => 0
    t.datetime "current_sign_in_at"
    t.datetime "last_sign_in_at"
    t.string   "current_sign_in_ip"
    t.string   "last_sign_in_ip"
    t.datetime "created_at",                             :null => false
    t.datetime "updated_at",                             :null => false
    t.string   "username"
    t.string   "provider"
    t.string   "uid"
  end 
```

你能想出为什么会发生这种情况的原因吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-13T02:58:28.703

email_field 可能正在使用定义格式的助手。
将“email_field”视为 text_field 或 date_field 中的“email_field”，但 email_field 表示具有用于电子邮件地址的格式规则的字段。

因此，除非您定义自己的助手，否则您不能以相同的方式选择模型属性和“_field”之一。

因此，不要更改`email_field`为`username_field`，而是将其更改为`text_field`

# applescript - 如何使用 Applescript 在 Finder 中更新/显示

> ID：14845689
> 
> 赞同：0
> 
> 时间：2013-02-13T02:56:20.580
> 
> 标签：applescript, finder

这是我想做的事情：

```
IF file is already present in a finder window
    tell finder to update...
ELSE
    tell finder to reveal... 
```

有没有办法确定有问题的文件是否已经显示在当前的 Finder 窗口中？我不想最终创建一个副本。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T05:27:57.183

该`reveal`命令应该已经以这种方式工作。`activate`如果另一个应用程序位于最前面，则聚焦 Finder：

```
tell application "Finder"
    reveal POSIX file "/usr/share/doc/bash/bash.html"
    activate
end tell 
```

# java - Mockito：InvalidUseOfMatchersException

> ID：14845690
> 
> 赞同：166
> 
> 时间：2013-02-13T02:56:22.347
> 
> 标签：java, unit-testing, mockito

我有一个执行 DNS 检查的命令行工具。如果 DNS 检查成功，该命令将继续执行其他任务。我正在尝试使用 Mockito 为此编写单元测试。这是我的代码：

```
public class Command() {
    // ....
    void runCommand() {
        // ..
        dnsCheck(hostname, new InetAddressFactory());
        // ..
        // do other stuff after dnsCheck
    }

    void dnsCheck(String hostname, InetAddressFactory factory) {
        // calls to verify hostname
    }
} 
```

我正在使用 InetAddressFactory 来模拟`InetAddress`该类的静态实现。这是工厂的代码：

```
public class InetAddressFactory {
    public InetAddress getByName(String host) throws UnknownHostException {
        return InetAddress.getByName(host);
    }
} 
```

这是我的单元测试用例：

```
@RunWith(MockitoJUnitRunner.class)
public class CmdTest {

    // many functional tests for dnsCheck

    // here's the piece of code that is failing
    // in this test I want to test the rest of the code (i.e. after dnsCheck)
    @Test
    void testPostDnsCheck() {
        final Cmd cmd = spy(new Cmd());

        // this line does not work, and it throws the exception below:
        // tried using (InetAddressFactory) anyObject()
        doNothing().when(cmd).dnsCheck(HOST, any(InetAddressFactory.class));
        cmd.runCommand();
    }
} 
```

运行`testPostDnsCheck()`测试异常：

```
org.mockito.exceptions.misusing.InvalidUseOfMatchersException: 
Invalid use of argument matchers!
2 matchers expected, 1 recorded.
This exception may occur if matchers are combined with raw values:
    //incorrect:
    someMethod(anyObject(), "raw String");
When using matchers, all arguments have to be provided by matchers.
For example:
    //correct:
    someMethod(anyObject(), eq("String by matcher")); 
```

关于如何解决这个问题的任何意见？

* * *

## 回答 #1

> 赞同：336
> 
> 时间：2013-02-13T03:03:31.933

错误消息概述了解决方案。线

```
doNothing().when(cmd).dnsCheck(HOST, any(InetAddressFactory.class)) 
```

当需要使用所有原始值或所有匹配器时，使用一个原始值和一个匹配器。正确的版本可能是

```
doNothing().when(cmd).dnsCheck(eq(HOST), any(InetAddressFactory.class)) 
```

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2015-06-01T12:55:17.980

很长一段时间以来我都遇到了同样的问题，我经常需要混合匹配器和值，而我从来没有用 Mockito 做到这一点......直到最近！我将解决方案放在这里，希望即使这篇文章已经很老了，它也会对某人有所帮助。

在 Mockito 中显然不可能同时使用 Matchers 和值，但是如果有一个 Matcher 接受比较变量怎么办？这将解决问题......事实上有：[eq](http://site.mockito.org/mockito/docs/current/org/mockito/ArgumentMatchers.html#eq(boolean))

```
when(recommendedAccessor.searchRecommendedHolidaysProduct(eq(metas), any(List.class), any(HotelsBoardBasisType.class), any(Config.class)))
            .thenReturn(recommendedResults); 
```

在此示例中，“metas”是现有的值列表

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2017-01-26T13:40:18.847

它可能对将来的某个人有所帮助：Mockito 不支持模拟“最终”方法（现在）。它给了我同样的`InvalidUseOfMatchersException`。

对我来说，解决方案是将不需要“最终”的方法部分放在单独的、可访问的和可覆盖的方法中。

查看适用于您的用例的[Mockito API](https://static.javadoc.io/org.mockito/mockito-core/2.6.8/org/mockito/Mockito.html)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-08-01T05:36:23.863

就我而言，引发异常是因为我试图模拟一个`package-access`方法。当我将方法访问级别从`package`更改`protected`为异常时，异常消失了。例如在Java类下面，

```
public class Foo {
    String getName(String id) {
        return mMap.get(id);
    }
} 
```

该方法`String getName(String id)`必须是**至少** `protected`级别，以便模拟机制（子类）可以工作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-01-25T11:22:15.173

可能对某人有帮助。模拟方法必须是模拟**类**，用`mock(MyService.class)`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-06-22T09:07:14.097

尽管使用了所有匹配器，但我遇到了同样的问题：

```
"org.mockito.exceptions.misusing.InvalidUseOfMatchersException: 
Invalid use of argument matchers!
1 matchers expected, 3 recorded:" 
```

我花了一点时间才发现我试图模拟的方法是一个类的静态方法（比如 Xyz.class），它只包含静态方法，我忘了写下一行：

```
PowerMockito.mockStatic(Xyz.class); 
```

可能它会帮助其他人，因为它也可能是问题的原因。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2020-10-15T15:55:43.870

Do not use Mockito.anyXXXX(). Directly pass the value to the method parameter of same type. Example:

```
A expected = new A(10);

String firstId = "10w";
String secondId = "20s";
String product = "Test";
String type = "type2";
Mockito.when(service.getTestData(firstId, secondId, product,type)).thenReturn(expected);

public class A{
   int a ;
   public A(int a) {
      this.a = a;
   }
} 
```

# iphone - UIToolbar 异常胖 UISegmentedControl

> ID：14845693
> 
> 赞同：0
> 
> 时间：2013-02-13T02:57:06.333
> 
> 标签：iphone, ios, objective-c, uitoolbar, uisegmentedcontrol

我从来没有在没有 Interface Builder 的情况下将分段控件添加到底部工具栏。我将相同的分段控件添加到导航控件工具栏而没有此问题。我究竟做错了什么？谢谢你。

![我得到的截图](../Images/48af69c41de6051e119f475ef9285cb3.png)

```
//enable UIToolbar
self.navigationController.toolbarHidden = NO;

//UISegmentedControl
NSArray *segmentedControlItems = [[NSArray alloc] initWithObjects:@"Day One",@"Day Two",nil];
self.segmentedCon = [[UISegmentedControl alloc] initWithItems:segmentedControlItems];
[segmentedControlItems release];
[self.segmentedCon addTarget:self action:@selector(daySegConIndexChange) forControlEvents:UIControlEventValueChanged];
[self.segmentedCon setSelectedSegmentIndex:0];
[self.segmentedCon setSegmentedControlStyle:UISegmentedControlStyleBar];
[self.segmentedCon setWidth:85.0 forSegmentAtIndex:0];
[self.segmentedCon setWidth:85.0 forSegmentAtIndex:1];
[self.segmentedCon setFrame:[self.navigationController.toolbar bounds]];

//bar button items
UIBarButtonItem *flexibaleSpaceBarButton = [[UIBarButtonItem alloc] initWithBarButtonSystemItem:UIBarButtonSystemItemFlexibleSpace target:nil action:nil];
UIBarButtonItem *segBarBtn = [[UIBarButtonItem alloc] initWithCustomView:self.segmentedCon];

//nsarray of tool bar items
NSArray *toolbarItems = [NSArray arrayWithObjects:flexibaleSpaceBarButton,segBarBtn,flexibaleSpaceBarButton,nil];
[self setToolbarItems:toolbarItems animated:YES];
[segBarBtn release]; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T19:22:43.860

试试这个。。

```
//UISegmentedControl
NSArray *segmentedControlItems = [[NSArray alloc] initWithObjects:@"Day One",@"Day Two",nil];
self.segmentedCon = [[UISegmentedControl alloc] initWithItems:segmentedControlItems];
[segmentedControlItems release];
[self.segmentedCon addTarget:self action:@selector(daySegConIndexChange) forControlEvents:UIControlEventValueChanged];
[self.segmentedCon setSelectedSegmentIndex:0];
[self.segmentedCon setSegmentedControlStyle:UISegmentedControlStyleBar];

//bar button items
UIBarButtonItem *flexibaleSpaceBarButton = [[UIBarButtonItem alloc] initWithBarButtonSystemItem:UIBarButtonSystemItemFlexibleSpace target:nil action:nil];
UIBarButtonItem *segBarBtn = [[UIBarButtonItem alloc] initWithCustomView:self.segmentedCon]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T03:02:26.913

尝试设置分段控件的框架...

```
CGRect r = self.segmentedCon.frame;

self.segmentedCon.frame = CGRectMake(r.origin.x, r.origin.y, r.size.width, 30); 
```

# dojo - 如何使用 Dojo 在 Div 中动态添加 Dojo 按钮？

> ID：14845702
> 
> 赞同：1
> 
> 时间：2013-02-13T02:59:37.847
> 
> 标签：dojo

我有以下静态 div：

```
 <body>
      <div id="parent">

    </div>
    </body>

<script>
  dom.byId('parent').innerHTML +="<input type='submit' data-dojo-type='dijit/form/Button' onClick='test(this)' id='edit"+1+"' label='Edit' />";
  dom.byId('parent').innerHTML +="<input type='submit' data-dojo-type='dijit/form/Button' onClick='test(this)' id='edit"+2+"' label='Edit' />";

</script> 
```

创建了两个按钮，但它们看起来像普通的 HTML 而不是 DOJO。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-13T09:15:40.767

最短的答案是[`dojo/parser::parse(domNode)`](http://livedocs.dojotoolkit.org/dojo/parser)：

```
var parent1 = dom.byId("parent1");
parent1.innerHTML += '<input type="submit" data-dojo-type="dijit/form/Button" onClick="test(this)" id="edit1" label="Edit 1">';
parent1.innerHTML += '<input type="submit" data-dojo-type="dijit/form/Button" onClick="test(this)" id="edit2" label="Edit 2">'; 
parser.parse(parent1); 
```

尽管我不能推荐。不要使用`innerHTML`，它属于IE6的世界。改为以编程方式创建 dijit：

```
var parent2 = dom.byId("parent2");

var button3 = new Button({ label: "Button 3" });
button3.startup();
button3.placeAt(parent2);
button3.on("click", test);

var button4 = new Button({ label:"Button 4"});
button4.startup();
button4.placeAt(parent2);
button4.on("click", function(event) {
    test(this); // `this` points to the button
}); 
```

看看它在行动：http: [//jsfiddle.net/phusick/9JCAj/](http://jsfiddle.net/phusick/9JCAj/)

# admob - AdMob 收入 - 如何计算

> ID：14845703
> 
> 赞同：40
> 
> 时间：2013-02-13T02:59:52.657
> 
> 标签：admob

AdMob 收入是如何计算的？它仅取决于点击次数吗？还是取决于显示的广告？还是两者兼而有之？

一天，我有 11 次点击，为我赚取了 0.12 美元，第二天我有 14 次点击，为我赚取了 0.51 美元，然后有一天，我为 11 次点击赚取了 0.07 美元。

这是我从 AdMob 获得的收入的屏幕截图...

![在此处输入图像描述](../Images/266704852aa2efc1d9d7eb31d17ceb17.png)

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-02-13T03:11:28.650

这也取决于它给人的印象，如果广告显示多次并且您获得 11 次点击，那么如果广告显示的时间较短并且您获得 11 次点击，那么您获得的钱就会更少。它也有更复杂的过程希望你理解试试这个[链接](https://stackoverflow.com/questions/11570139/admob-revenue-and-alternatives-impression-vs-clicks)它可能有你正在搜索的东西。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2013-02-13T03:14:08.713

简而言之，谷歌有一个广告拍卖系统。您愿意为他们支付的费用越多，他们就会越多地出现在优质房地产中。这对您来说意味着每次点击的成本取决于广告，而广告每天都会发生巨大变化。

# c - 即使缓冲区中有数据，select() 也会超时

> ID：14845705
> 
> 赞同：0
> 
> 时间：2013-02-13T03:00:06.987
> 
> 标签：c, select-function

这个程序（我相信）是 select() 的直接应用程序（在 Debian for ARM 上）。XBEEDEVICE 指向一个串行端口。串行端口存在并且 ic 连接到设备。

问题是，即使接收到数据，select() 也会返回 0。我暂时注释掉了最后一个“else”，程序打印 TIMEOUT，然后是远程设备返回的字符串。

```
int main( int argc, char **argv ) {
  int fd, c, res, n;
  struct termios oldtio, newtio;
  char buf[255] = {0};

  fd_set input;
  struct timeval timeout;

  // define timeout
  timeout.tv_sec = 5;
  timeout.tv_usec = 0;

  fd = open( XBEEDEVICE, O_RDWR | O_NOCTTY );
  if( fd < 0 ){
    perror( XBEEDEVICE );
    return( -1 );
  }

  tcgetattr( fd, &oldtio ); /* save current port settings */
  bzero( &newtio, sizeof( newtio ));
  newtio.c_cflag = CRTSCTS | CS8 | CLOCAL | CREAD;
  newtio.c_iflag = IGNPAR;
  newtio.c_oflag = 0;

  /* set input mode (non-canonical, no echo,...) */
  newtio.c_lflag = 0;

  newtio.c_cc[VTIME]    = 0;   /* inter-character timer unused */
  newtio.c_cc[VMIN]     = 2;   /* blocking read until 2 chars received */

  tcflush( fd, TCIFLUSH );
  tcsetattr( fd, TCSANOW, &newtio );

  // Sending +++ within 1 second sets the XBee into command mode
  printf( " Sending +++\n" );
  write( fd, "+++", 3 );

  n = select( fd, &input, NULL, NULL, &timeout );

  if( n < 0 )
    printf( "select() failed\n" );
  else if( n == 0 )
    printf( "TIMEOUT\n" );
  //else{
    res = read( fd, buf, 250 );
    buf[res] = 0;
    printf( "Received: %s\n", buf );
  //}
  tcsetattr( fd, TCSANOW, &oldtio );

  return( 0 );
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T04:00:44.143

您应该初始化`input`以包含`fd`. 这是通过`FD_ZERO`和`FD_SET`宏完成的：

```
FD_ZERO(&input);
FD_SET(fd, &input); 
```

这必须在每次`select`调用之前完成。

的第一个参数`select`应该是`fd+1`。它是要检查的范围内的文件描述符的数量。由于该范围内的最大（也是唯一的）描述符数是`fd`，而最小值始终是 0，因此所讨论的数是`fd+1`。

# c++ - C++ lambda 函数的默认调用约定是什么？

> ID：14845706
> 
> 赞同：16
> 
> 时间：2013-02-13T03:00:09.290
> 
> 标签：c++, function, c++11, lambda, calling-convention

以下代码使用 VC++ 2012 编译：

```
void f1(void (__stdcall *)())
{}

void f2(void (__cdecl *)())
{}

void __cdecl h1()
{}

void __stdcall h2()
{}

int main()
{
    f1(h1); // error C2664
    f2(h2); // error C2664

    f1([](){}); // OK
    f2([](){}); // OK

    auto fn = [](){};

    f1(fn); // OK
    f2(fn); // OK
} 
```

我认为错误是正常的，但 OK 是异常的。

所以，我的问题是：

1.  C++ lambda 函数的调用约定是什么？

2.  如何指定 C++ lambda 函数的调用约定？

3.  如果未定义调用约定，如何在调用 lambda 函数后正确回收堆栈空间？

4.  编译器会自动生成多个版本的 lambda 函数吗？即如下伪代码：

    [] __stdcall (){};

    [] __cdecl (){}; 等等

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-02-13T03:41:54.027

*在 VC++ 2012 上，当*您将“无状态 lambda 转换为函数指针”时，编译器会选择自动调用无状态 lambda（没有捕获变量）的转换。

[MSDN C++11 特点](http://msdn.microsoft.com/en-us/library/hh567368%28v=vs.110%29.aspx)：

> **拉姆达斯**
> 
> [...] 此外，在 Visual Studio 2012 的 Visual C++ 中，无状态 lambda 可转换为函数指针。[...]（Visual Studio 2012 中的 Visual C++ 甚至比这更好，因为我们已将无状态 lambda 转换为具有任意调用约定的函数指针。当您使用期望`__stdcall`函数指针之类的 API 时，这一点很重要.)

* * *

**编辑：**

**注意：**调用转换超出了 C++ 标准，它依赖于其他规范，例如平台 ABI（应用程序二进制接口）。

以下答案基于带有[/FAs 编译器选项](http://msdn.microsoft.com/en-us/library/367y26c6%28v=vs.110%29.aspx)的输出汇编代码。所以这只是一个猜测，请向微软询问更多细节;P

> Q1。C++ lambda 函数的调用约定是什么？
> 
> Q3。如果未定义调用约定，如何在调用 lambda 函数后正确回收堆栈空间？

首先，C++ *lambda(-expression)*不是函数（也不是函数指针），您可以`operator()`像调用普通函数一样调用 lambda 对象。并且输出汇编代码说 VC++ 2012 生成带有`__thiscall`调用转换的 lambda-body。

> Q2。如何指定 C++ lambda 函数的调用约定？

AFAIK，没有办法。（可能只有`__thiscall`）

> Q4。编译器会自动生成多个版本的 lambda 函数吗？即作为以下伪代码：[...]

可能不会。VC++ 2012 lambda-type 仅提供一个 lambda-body 实现 ( `void operator()()`)，但为每次调用转换提供多个“用户定义的函数指针转换”（操作符返回函数指针，带`void (__fastcall*)(void)`,`void (__stdcall*)(void)`和`void (__cdecl*)(void)`类型）。

这是一个例子；

```
// input source code
auto lm = [](){ /*lambda-body*/ };

// reversed C++ code from VC++2012 output assembly code
class lambda_UNIQUE_HASH {
  void __thiscall operator()() {
    /* lambda-body */
  }
  // user-defined conversions
  typedef void (__fastcall * fp_fastcall_t)();
  typedef void (__stdcall * fp_stdcall_t)();
  typedef void (__cdecl * fp_cdecl_t)();
  operator fp_fastcall_t() { ... }
  operator fp_stdcall_t() { ... }
  operator fp_cdecl_t() { ... }
};
lambda_UNIQUE_HASH lm; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-13T03:43:36.580

无状态的 lambda 函数仍然是一个类，但是一个可以隐式转换为函数指针的类。

C++ 标准不涵盖调用约定，但是当 lambda 转换为函数指针时，无状态 lambda 无法在转发到无状态 lambda 的任何调用约定中创建包装器几乎没有理由。

例如，我们可以这样做：

```
#include <iostream>

void __cdecl h1() {}
void __stdcall h2(){}

// I'm lazy: 
typedef decltype(&h1) cdecl_nullary_ptr;
typedef decltype(&h2) stdcall_nullary_ptr;

template<typename StatelessNullaryFunctor>
struct make_cdecl {
  static void __cdecl do_it() {
    StatelessNullaryFunctor()();
  }
};
template<typename StatelessNullaryFunctor>
struct make_stdcall {
  static void __stdcall do_it() {
    StatelessNullaryFunctor()();
  }
};

struct test {
  void operator()() const { hidden_implementation(); }

  operator cdecl_nullary_ptr() const {
    return &make_cdecl<test>::do_it;
  }
  operator stdcall_nullary_ptr() const {
    return &make_stdcall<test>::do_it;
  }
}; 
```

我们的`test`无状态空值类可以隐式转换为 a`cdecl`和`stdcall`函数指针。

重要的部分是调用约定是函数指针类型的一部分，因此`operator function_type`知道正在请求什么调用约定。并且通过完美的转发，以上甚至可以是高效的。

# android - Android - 按钮监听器知道点击了哪个按钮

> ID：14845709
> 
> 赞同：0
> 
> 时间：2013-02-13T03:00:55.367
> 
> 标签：android

我正在为多个按钮分配一个按钮侦听器，如下所示：

```
 for(Button b : buttons)
    {
        b.setOnClickListener(clicklisten);
    } 
```

按钮监听器定义如下：

```
private OnClickListener clicklisten = new OnClickListener()
{
    public void onClick(View v)
    {
        Context context = getApplicationContext();
        text = Toast.makeText(context, " Button Clicked", Toast.LENGTH_SHORT);
        text.show();
    }
}; 
```

事实上，它只显示一个带有“Button Clicked”的 Toast。我希望它检测单击了哪个按钮，可能是通过该按钮的名称或 ID（如 XML 中定义的那样），并根据该按钮显示某些内容。是否可以通过这种方式通过代码检索该信息？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T03:03:26.933

[通过View#getId()](http://developer.android.com/reference/android/view/View.html#getId%28%29)获取资源 id 。

```
View.OnClickListener myOnlyhandler = new View.OnClickListener() {
  public void onClick(View v) {
      if( button1.getId() == ((Button)v).getId() ){
          // it was the button1
      }
      else if( button2.getId() == ((Button)v).getId() ){
          // it was the button2
      }
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T03:39:38.643

或者你可以这样写......在onClick方法中传递的视图v是......被点击的按钮......所以你可以检查那个视图是否等于你的任何按钮......

```
View.OnClickListener myOnlyhandler = new View.OnClickListener() {
  public void onClick(View v) {
      if( button1.equals(v)){
          // it was the button1
      }
      else if( button2.equals(v)){
          // it was the button2
      }
  }
} 
```

# javascript - HTML中的Javascript变量访问

> ID：14845710
> 
> 赞同：29
> 
> 时间：2013-02-13T03:00:55.010
> 
> 标签：javascript

假设我在 HTML 页面中有以下 JavaScript

```
<html>
<script>
    var simpleText = "hello_world";
    var finalSplitText = simpleText.split("_");
    var splitText = finalSplitText[0];
</script>

<body>
    <a href = test.html>I need the value of "splitText" variable here</a>
</body>
</html> 
```

如何在脚本标签之外获取变量“splitText”的值。

谢谢！

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-02-13T03:04:27.990

```
<html>
<script>
var simpleText = "hello_world";
var finalSplitText = simpleText.split("_");
var splitText = finalSplitText[0];

window.onload = function() {
       //when the document is finished loading, replace everything
       //between the <a ...> </a> tags with the value of splitText
   document.getElementById("myLink").innerHTML=splitText;
} 

</script>

<body>
<a id="myLink" href = test.html></a>
</body>
</html> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-13T03:06:59.547

试试这个 ：

```
<script src="http://code.jquery.com/jquery-latest.min.js"></script>
<script type="text/javascript">
  $(document).ready(function () {
            var simpleText = "hello_world";
            var finalSplitText = simpleText.split("_");
            var splitText = finalSplitText[0];
            $("#target").text(splitText);
        });
</script>

<body>
<a id="target" href = test.html></a>
</body>
</html> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-13T03:09:36.857

```
<html>
<head>
<script>
    function putText() {
        var simpleText = "hello_world";
        var finalSplitText = simpleText.split("_");
        var splitText = finalSplitText[0];
        document.getElementById("destination").innerHTML = "I need the value of " + splitText + " variable here";
    }
</script>
</head>
<body onLoad = putText()>
    <a id="destination" href = test.html>I need the value of "splitText" variable here</a>
</body>
</html> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-13T03:07:49.853

给你：[http ://codepen.io/anon/pen/cKflA](http://codepen.io/anon/pen/cKflA)

虽然，我必须说你要求做的不是一个好方法。一个好方法是：[http ://codepen.io/anon/pen/jlkvJ](http://codepen.io/anon/pen/jlkvJ)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-13T03:05:16.953

在原始 javascript 中，您需要在锚标记上放置一个 id 并执行以下操作：

```
<html>
<script>
var simpleText = "hello_world";
var finalSplitText = simpleText.split("_");
var splitText = finalSplitText[0];

function insertText(){
    document.getElementById('someId').InnerHTML = splitText;}
</script>

<body onload="insertText()">
<a href = test.html id="someId">I need the value of "splitText" variable here</a>
</body>
</html> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-05-27T15:07:11.033

The info inside the `<script>` tag is then processed inside it to access other parts. If you want to change the text inside another paragraph, then first give the paragraph an id, then set a variable to it using `getElementById([id])` to access it ([id] means the id you gave the paragraph). Next, use the `innerHTML` built-in variable with whatever your variable was called and a '**.**' (dot) to show that it is based on the paragraph. You can set it to whatever you want, but be aware that to set a paragraph to a tag (<...>), then you have to still put it in speech marks.

## Example:

```
<!DOCTYPE html>
<html>
    <body>
        <!--\|/id here-->
        <p id="myText"></p>
        <p id="myTextTag"></p>
        <script>
            <!--Here we retrieve the text and show what we want to write...
            var text = document.getElementById("myText");
            var tag = document.getElementById("myTextTag");
            var toWrite = "Hello"
            var toWriteTag = "<a href='https://stackoverflow.com'>Stack Overflow</a>"
            <!--...and here we are actually affecting the text.-->
            text.innerHTML = toWrite
            tag.innerHTML = toWriteTag
        </script>
    <body>
<html>
```

# html - 为什么某些 CSS 规则仅适用于 Chrome？

> ID：14845712
> 
> 赞同：0
> 
> 时间：2013-02-13T03:01:13.990
> 
> 标签：html, css, fonts

请在 Chrome 中访问[此页面](http://cosmodent.lemonadestudio.pl/)并查看**Aktualności**和文本部分：

> Tupacsum Ipsum 她几乎献出了自己的生命......

然后在 Firefox 和 Opera 上查看相同的 URL。接下来尝试向我解释为什么这条规则：`font: 12px normal 'Lato', 'Times New Roman';`在（FF、Opera）和 Chrome 上都不起作用。

我在某个地方犯了错误吗？还是我使用了只能在 Chrome 上使用的东西？

* * *

## 铬合金：

![铬合金](../Images/9cde5b910409938920d7ca4fa55e02b2.png)

## 火狐：

![在此处输入图像描述](../Images/207be7d6697f1c44643c3658917d780b.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T03:19:47.123

你为什么不把它`body #main.home > .bottom .right .top article`从`.desc p`

```
.desc p {
    font-size: 12px;
    font-family: 'Lato', 'Times New Roman';
    line-height: normal;
} 
```

在使用 LESS 时嵌套规则时要小心，你不应该真正嵌套超过 3 层。想想你将如何首先编写实际的选择器，然后只嵌套需要的内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T03:47:49.787

浏览器只是被通用字体属性的值弄糊涂了。您需要指定更多值，以便它了解在哪里应用什么。

这工作正常：

```
body #main.home > .bottom .right .top article {
    font: normal 12px/normal 'Lato', 'Times New Roman';
} 
```

@ferne97 的解决方案虽然可能是不使用特定于选择器的更好做法，但仅在明确设置字体系列而不是使用相同的通用字体属性时才有效。如果您使用带有原始字体属性值的简化选择器，问题仍然存在。

# java - 如何配置 RunJettyRun Eclipse 插件以使用 logback？

> ID：14845714
> 
> 赞同：1
> 
> 时间：2013-02-13T03:01:27.687
> 
> 标签：java, slf4j, logback, runjettyrun

在 Eclipse Juno 中安装 RunJettyRun 插件并成功运行我的应用程序后，我不知道如何将记录器更改为 Logback。

网上有一些说明，但它们要么不完整，要么非常混乱。

`logback`通过在 pom.xml 文件中包含`logback-classic`作为依赖项，我已成功配置 jetty-start 以使用。

# sql - 显示一张表的结果

> ID：14845715
> 
> 赞同：3
> 
> 时间：2013-02-13T03:01:34.450
> 
> 标签：sql

美好的一天，我有这 3 张桌子……即；

客户表

```
cust_id cust_name sales_employee
1       abc       1
2       cde       1
3       efg       2 
```

事务表

```
order_num   cust_id   sales_employee
1001        1         1 
1002        2         2 
```

sales_employee 表

```
sales_employee     employee name
1                  john doe
2                  jane doe 
```

如何在客户表和交易表上显示员工姓名？请注意 sales_employee 可以如何在每笔交易中发生变化，不一定每个客户都必须相同。

请帮忙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T03:06:25.510

**选择具有销售人员姓名的客户**

```
select 
  C.*, E.employee_name
from
  Customers as C
  inner join Sales_Employees as E on E.sales_employee = C.sales_employee 
```

**选择具有客户姓名和销售人员姓名**的交易（在交易的时间点）

```
select 
  T.*, 
  E.employee_name as Trans_employee, 
  C.cust_name,
  EC.employee_name as Cust_employee
from
  Transactions as T
  inner join Sales_Employees as E on E.sales_employee = T.sales_employee
  inner join Customers as C on C.cust_id= T.cust_id
  inner join Sales_Employees as EC on EC.sales_employee = C.sales_employee 
```

此代码旨在指导您，您需要对其进行调整以匹配您的表和字段名称。

# php - 如何使用 fopen 和 fwrite 在文本文件中读取、替换和添加内容？

> ID：14845716
> 
> 赞同：1
> 
> 时间：2013-02-13T03:01:40.233
> 
> 标签：php, phpmyadmin, fopen, fwrite

起初，我有一个程序可以读取文本文件并在其中添加内容。现在，我要做的是从数据库表中选择所有数据并打开、复制和替换并在文本文件中添加一些内容。这就像我选择所有（ctrl + a）文本文件的内容然后粘贴它但添加了一些东西。

```
$fileArray = file($filename);
//acl 10-0146-506_lp arp 00:15:af:a5:68:b1
$findthis = "#endofpart1\r\n";
$myKey = array_search($findthis,$fileArray);
array_splice($fileArray,$myKey,0,"acl ".$sn."_".$dd." arp ".$ma."\r\n");
//http_access allow 09-0651-410_cp
$findthis2 = "#endofpart2\r\n";
$myKey2 = array_search($findthis2,$fileArray);
array_splice($fileArray,$myKey2,0,"http_access allow ".$sn."_".$dd."\r\n");

$fp = fopen($filename,'w');

foreach($fileArray as $value) {
    fwrite($fp,$value);
}

fclose($fp); 
```

这段代码是我做的第一个程序。

# asp.net-mvc - Kendo UI Grid 一次只扩展一行

> ID：14845718
> 
> 赞同：6
> 
> 时间：2013-02-13T03:01:53.740
> 
> 标签：asp.net-mvc, kendo-ui, kendo-grid

我有一个剑道网格，我希望一次只能扩展一行以进行详细编辑。最简单的方法是什么？

```
@(Html.Kendo().Grid<MyModel>()
   .Name("MyGrid")
   .ClientDetailTemplateId("MyTemplate")
   .Columns(columns =>
   {
       columns.Bound(b => b.Code);
       columns.Bound(b => b.Name);
       columns.Bound(b => b.Description);
       ...
       columns.Command(cmd => { cmd.Edit(); cmd.Destroy(); });
   })
   .ToolBar(toolbar => toolbar.Create())
   .Editable(editable => editable.Mode(GridEditMode.InLine))
   .DataSource(dataSource => dataSource
      .Ajax()
      .Model(model => model.Id(a => a.Id))
      .Create(create => create.Action("Create", "SysMaint", new { id = Model.ProjectId }))
      .Read(read => read.Action("Read", "SysMaint", new { projectId = Model.ProjectId }))
      .Update(update => update.Action("Update", "SysMaint"))
      .Destroy(destroy => destroy.Action("Destroy", "SysMaint"))
   )
)

<script id="MyTemplate" type="text/kendo-tmpl">
    @(Html.Kendo().TabStrip()
       .Name("TabStrip_#=Id#")
       .SelectedIndex(0)
       .Items(items =>
           {
               items.Add().Text("A").LoadContentFrom("MyPartialA", "SysMaint", new { id = "#=Id#" });
               items.Add().Text("B").LoadContentFrom("MyPartialB", "SysMaint", new { id = "#=Id#" });
           })
       .ToClientTemplate()
    )
</script> 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-13T03:01:53.740

结束这真的很简单。只需添加这几行。

```
 ...
      .Update(update => update.Action("Update", "SysMaint"))
      .Destroy(destroy => destroy.Action("Destroy", "SysMaint"))
   )
   .Events(events => events.DetailExpand("detailExpand"))
)

<script type="text/javascript">
    var expandedRow;
    function detailExpand(e) {
        // Only one open at a time
        if (expandedRow != null && expandedRow[0] != e.masterRow[0]) {
            var grid = $('#MyGrid').data('kendoGrid');
            grid.collapseRow(expandedRow);
        }
        expandedRow = e.masterRow;
    }
</script> 
```

我希望这对某人有所帮助。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-09-12T19:31:07.027

这有效，只是它不会删除旧的详细信息行。添加标记为 NEW 的位以删除每个先前打开的详细信息行。

```
if (expandedRow != null && expandedRow != e.masterRow[0]) {
    var grid = $('#RequestsGrid').data('kendoGrid');
    grid.collapseRow(expandedRow);
    expandedRow[0].nextElementSibling.remove(); //NEW
}
expandedRow = e.masterRow; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-06-05T17:43:24.260

基于 Trey 的回答，这个版本一般适用于任何网格（使用@vikasde 的建议），并且当您有嵌套网格时也可以工作，因此在调用 detailExpand 时子网格不会将其父网格行折叠为副作用。

```
<script type="text/javascript">
    function detailExpand(ev) {
        var expandedRow = $(ev.sender.wrapper).data('expandedRow');
        // Only one open at a time
        if (expandedRow && expandedRow[0] != ev.masterRow[0]) {
            var grid = $(ev.sender.wrapper).data('kendoGrid');
            grid.collapseRow(expandedRow);
        }
        $(ev.sender.wrapper).data('expandedRow', ev.masterRow);
    }
</script> 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-10-16T14:41:52.037

除了此处已有的答案，我发现通过结合斧头和 Danny Blue 的答案并使用该`DetailCollapse`事件可以很好地工作，并且如果手动折叠一行，则会删除底层的详细内容。

MVC 网格配置：

```
.Events(ev =>
    {
      ev.DetailExpand("detailExpand");
      ev.DetailCollapse("detailCollapse");
    }) 
```

页面脚本：

```
function detailExpand(ev) { // Credit hatchet
    var expandedRow = $(ev.sender.wrapper).data('expandedRow');
    // Only one open at a time
    if (expandedRow && expandedRow[0] !== ev.masterRow[0]) {
        var $grid = $(ev.sender.wrapper).data('kendoGrid');
        $grid.collapseRow(expandedRow);
    }
    $(ev.sender.wrapper).data('expandedRow', ev.masterRow);
}
function detailCollapse(ev) {
    var expandedRow = $(ev.sender.wrapper).data('expandedRow');
    expandedRow.next().remove(); // Credit Danny Blue
} 
```

# git - 如果我使用的是 git 存储库，如何重写 mod 使其不在 url 中显示子文件夹？

> ID：14845719
> 
> 赞同：2
> 
> 时间：2013-02-13T03:01:56.507
> 
> 标签：git, .htaccess, codeigniter, mod-rewrite

我正在使用 codeigniter 框架。linux服务器。

假设我有一个[http://www.domain.com](http://www.domain.com)

我有一个名为 domain_test 的 bitbucket 存储库，当我 git clone 目录时，它会创建一个文件夹 public_html/domain_test

为了让我做到这一点，当用户输入 domain.com 并立即转到 domain_test 文件夹时，我在 .htaccess 文件中进行了关注

```
RewriteEngine On
RewriteRule ^$ /domain_test/ [R=301,L]
</IfModule> 
```

唯一的问题是当有人访问[http://www.domain.com](http://www.domain.com)或 domain.com 时，它会显示[http://www.domain.com/domain_test](http://www.domain.com/domain_test)

有没有办法让看起来像[http://www.domain.com](http://www.domain.com)而不会在 url 中看到 domain_test ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T08:57:15.717

改为使用此规则：

```
RewriteRule (?!^domain_test(/.*|)$)^(.*)$ /domain_test/$1 [NC,L] 
```

# yui - 使用带有 YUI 的 jsPlumb 使 Div 可拖动但包含

> ID：14845722
> 
> 赞同：2
> 
> 时间：2013-02-13T03:02:12.477
> 
> 标签：yui, draggable, jsplumb

我正在尝试将 jsPlumb 与 YUI 框架一起使用，以使一些 div 可拖动和连接。但是，我发现当我尝试使 div 可拖动但包含在其父级中时，使用：

```
jsPlumb.draggable("window2", {
    containment:"parent"
}); 
```

div 仍然可以拖动到其父级的范围之外。如果我将父级的 css 设置为“溢出：隐藏”，当它被拖出父级的边界时，我将看不到 div，但我仍然会看到 div 的连接器，这看起来很尴尬。要在小提琴中看到这一切：http: [//jsfiddle.net/xXYwX/3/](http://jsfiddle.net/xXYwX/3/) 有谁知道是否有办法使用 jsPlumb 的可拖动功能与 YUI 并仍然限制可拖动 div 的移动？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-05-28T05:39:17.577

首先使用 jsPlumb 使 div 可拖动：

```
jsPlumb.draggable("window2"); 
```

然后添加必要的 jsPlumb 端点：

```
jsPlumb.addEndpoint("window2", { ----}); 
```

然后添加 HTML 可拖动，如

```
$('#window2').draggable({
    containment: 'parent'
}); 
```

它为我工作..

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T17:27:42.230

不，jsPlumb 的 yui 版本似乎不可能。'dd-constrain' 模块丢失，我找不到插入此模块的方法，因为您无法访问 Y.DD.Drag 对象。

您可以向创建者发送功能请求或在 github 上进行拉取请求。这是一个带有约束拖动的普通 yui 示例：http: [//yuilibrary.com/yui/docs/dd/constrained-drag.html](http://yuilibrary.com/yui/docs/dd/constrained-drag.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-06-17T17:34:54.223

让你的容器溢出：在 CSS 中可见

# php - php脚本调用父javascript函数

> ID：14845723
> 
> 赞同：0
> 
> 时间：2013-02-13T03:02:23.137
> 
> 标签：php, javascript

我有这个文件夹结构：

```
index.php

js/scripts.js 
```

在`index.php`我定义了一个名为`execute()`.

现在`index.php`我有一个表单，提交时将调用`email.php`并在执行结束时执行以下`email.php`操作：

```
echo '<script type="text/javascript">parent.execute();</script>'; 
```

这一切都很好。

现在，当我`execute()`进入`scripts.js`并将这行代码放入`index.php`：

```
<script type="text/javascript" src="js/script.js"></script> 
```

然后`email.php`不知何故无法找到`execute()`功能。我知道这一点，因为如果我修改执行函数，只会运行原始版本（index.php 中的那个）。

我知道这很奇怪，但是我对此很陌生，而且我不知道无论如何我可以调试它。我有什么明显的遗漏吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T03:41:21.253

`<script>`首先，确保您的标签中没有错字。您将外部脚本文件称为 script.js 和 scripts.js。一个小小的's'可以让一切变得不同。

假设您已正确包含脚本，很可能您已将其放入`execute`另一个函数中，从而将其排除在全局范围之外。如果 script.js 看起来像这样，情况就是这样：

```
(function () {
    ...
    function execute () {
        ...
    }
})(); 
```

如果是这种情况，请`execute`移出它的包含功能。您还可以`execute`通过显式使其成为以下属性来放入全局范围`window`：

```
window.execute = function execute () {
    ...
}; 
```

如果您这样做，则可以留`execute`在另一个函数中。

# r - 为什么我会得到不同的 lmList 与 lmList[[x]] 的汇总结果

> ID：14845727
> 
> 赞同：2
> 
> 时间：2013-02-13T03:02:37.867
> 
> 标签：r, regression

我使用`lmList`from `nlme`package 来运行基于不同组的各种回归 by 函数。鉴于我看到的解释，我对总结结果有点困惑`summary.lmList`

```
The `summary.lm` method is applied to each lm component of object to produce
summary information on the individual fits, which is organized into a list of
summary statistics. 

The returned object is suitable for printing with the print.summary.lmList
method. 
```

我的意思是下面

```
set.seed(123)
t <- data.frame(
        name=sample(c("a","b","c"),size=500,replace=T),
        x=1:500,
        y=1:500+rnorm(100)
      )
ta <- t[t$name=="a",]
lma <- lm(y~x,ta)
lmL <- lmList(y~x | name,t)
r1 <- summary(lmL)  
r2 <- summary(lmL[["a"]])  
r3 <- summary(lma) 
```

有人可以向我解释为什么 r1 中显示的“a”值与 r2 和 r3 中的值不匹配，而 r2 中的值与 r3 中的值匹配吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-13T03:14:06.230

**nlme**中的版本`lmList`及其摘要方法有一个参数：**`pool`**

 **> 一个可选的逻辑值，指示是否应在计算标准差或汇总标准误差时使用残差标准误差的汇总估计。

我猜如果你`FALSE`在打电话时将其设置为，`summary`你会得到相同的值。**

# codeigniter - 沙盒 Paypal 扣款问题

> ID：14845730
> 
> 赞同：-2
> 
> 时间：2013-02-13T03:02:56.830
> 
> 标签：codeigniter, paypal

### 我的代码：

```
function paiement_echec()
    {
    echo "payment cancelled by the user";
    }

function paiement_succes()
{
  // Obtain the token from PayPal.
  if(!array_key_exists('token', $_REQUEST)) 
         exit('Token is not received.');
  // Set request-specific fields.
  $token = urlencode(htmlspecialchars($_REQUEST['token']));
  // Add request-specific fields to the request string.
  $nvpStr = "&TOKEN=$token";
  // Execute the API operation; see the PPHttpPost function above.
  $httpParsedResponseAr = $this->PPHttpPost('GetExpressCheckoutDetails', $nvpStr);
  if("SUCCESS" == strtoupper($httpParsedResponseAr["ACK"]) || "SUCCESSWITHWARNING" == strtoupper($httpParsedResponseAr["ACK"])) 
      {
          //print_r($httpParsedResponseAr);
          $payerID = urlencode($httpParsedResponseAr["PAYERID"]);
          //$token = urlencode("token");
          $paymentType = urlencode('Sale');         // or 'Sale' or 'Order'
          $paymentAmount = urlencode("4.39");
          $currencyID = urlencode("USD");                       // or other currency code ('GBP', 'EUR', 'JPY', 'CAD', 'AUD')

// Add request-specific fields to the request string.
          $nvpStr = "&TOKEN=$token&PAYERID=$payerID&PAYMENTACTION=$paymentType&AMT=$paymentAmount&CURRENCYCODE=$currencyID";
          $httpParsedResponseAr = $this->PPHttpPost('DoExpressCheckoutPayment', $nvpStr);
           if("SUCCESS" == strtoupper($httpParsedResponseAr["ACK"]) || "SUCCESSWITHWARNING" == strtoupper($httpParsedResponseAr["ACK"])) 
           {
             $this->load->model('payment_model');
             $this->payment_model->paypal_payment();
             $msg = "<label>Thank you !! your payment is successfully done</label>
              <a href='".base_url()."envoie_de_photos/envoyer_vos_photos"."'>Go To Photo Uploading</a>";
             echo $msg;
           }
          else  
            {
                 exit('GetExpressCheckoutDetails failed: ' . print_r($httpParsedResponseAr, true));
             //echo "Payment failed for unknown reason";
            }
      } 
  else  
      {
        //exit('GetExpressCheckoutDetails failed: ' . print_r($httpParsedResponseAr, true));
        echo "Payment failed for unknown reason";
      }
}

function pay_by_paypal()
{

        $environment = 'sandbox';
        $_SESSION['item_name']=$this->input->post('item_name');
        $_SESSION['amount']=$this->input->post('amount');
        $_SESSION['currency_code']=$this->input->post('currency_code');
        $_SESSION['no_of_photo']=$this->input->post('no_of_photo');

        $qty=urlencode("1");
        $product_name=urldecode($_SESSION['item_name']);
        $price=urlencode($_SESSION['amount']);
        //$currencyID = urlencode($_SESSION['currency_code']);
        $currencyID = urlencode("USD");

// or other currency code ('GBP', 'EUR', 'JPY', 'CAD', 'AUD')
     $paymentType = urlencode('Order'); 
     $nvpStr=""; 
     $returnURL = (base_url()."paiement/paiement_succes");
     $cancelURL = (base_url()."paiement/paiement_echec");  
     $i=0;
     $total_amount=0;

     $str = "&METHOD=SetExpressCheckout
&RETURNURL=$returnURL
&CANCELURL=$cancelURL
&L_PAYMENTREQUEST_0_NAME0=$product_name
&L_PAYMENTREQUEST_0_NUMBER0=$qty
&L_PAYMENTREQUEST_0_AMT0=$price
&L_PAYMENTREQUEST_0_DESC0=$product_name
&PAYMENTREQUEST_0_AMT=$price
&PAYMENTREQUEST_0_PAYMENTACTION=$paymentType
&PAYMENTREQUEST_0_CURRENCYCODE=$currencyID"; 
     $nvpStr=$nvpStr.$str;
$httpParsedResponseAr = $this->PPHttpPost('SetExpressCheckout', $nvpStr);

if("SUCCESS" == strtoupper($httpParsedResponseAr["ACK"]) || "SUCCESSWITHWARNING" == strtoupper($httpParsedResponseAr["ACK"]))
    {
    // Redirect to paypal.com.
    $token = urldecode($httpParsedResponseAr["TOKEN"]);
    $payPalURL = "https://www.$environment.paypal.com/webscr&cmd=_express-checkout&token=$token";
    if("sandbox" === $environment) 
            {
        $payPalURL = "https://www.$environment.paypal.com/webscr&cmd=_express-checkout&token=$token";
    }
    header("Location: $payPalURL");
    exit;
} 
else  
    {
    exit('SetExpressCheckout failed: ' . print_r($httpParsedResponseAr, true));
}

}

/** SetExpressCheckout NVP example; last modified 08MAY23.
 *
 *  Initiate an Express Checkout transaction. 
*/

/**
 * Send HTTP POST Request
 *
 * @param   string  The API method name
 * @param   string  The POST Message fields in &name=value pair format
 * @return  array   Parsed HTTP Response body
 */
private function PPHttpPost($methodName_, $nvpStr_) {
    //global $environment;
        $environment = 'sandbox';   // or 'beta-sandbox' or 'live'
    // Set up your API credentials, PayPal end point, and API version.
    $API_UserName = urlencode('saswat_1360720799_biz_api1.gmail.com');
    $API_Password = urlencode('1360720821');
    $API_Signature = urlencode('ApDCeFez-N1Gd1-O3ubTGdpyiow4AlNlRemm8XJFcbsA.WbSMtlMSqHf');
    $API_Endpoint = "https://api-3t.paypal.com/nvp";
    if("sandbox" === $environment) {
        $API_Endpoint = "https://api-3t.$environment.paypal.com/nvp";
    }
    $version = urlencode('65.0');

    // Set the curl parameters.
    $ch = curl_init();
    curl_setopt($ch, CURLOPT_URL, $API_Endpoint);
    curl_setopt($ch, CURLOPT_VERBOSE, 1);

    // Turn off the server and peer verification (TrustManager Concept).
    curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, FALSE);
    curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, FALSE);

    curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
    curl_setopt($ch, CURLOPT_POST, 1);

    // Set the API operation, version, and API signature in the request.
    $nvpreq = "METHOD=$methodName_&VERSION=$version&PWD=$API_Password&USER=$API_UserName&SIGNATURE=$API_Signature$nvpStr_";

    // Set the request as a POST FIELD for curl.
    curl_setopt($ch, CURLOPT_POSTFIELDS, $nvpreq);

    // Get response from the server.
    $httpResponse = curl_exec($ch);

    if(!$httpResponse) {
        exit("$methodName_ failed: ".curl_error($ch).'('.curl_errno($ch).')');
    }

    // Extract the response details.
    $httpResponseAr = explode("&", $httpResponse);

    $httpParsedResponseAr = array();
    foreach ($httpResponseAr as $i => $value) {
        $tmpAr = explode("=", $value);
        if(sizeof($tmpAr) > 1) {
            $httpParsedResponseAr[$tmpAr[0]] = $tmpAr[1];
        }
    }

    if((0 == sizeof($httpParsedResponseAr)) || !array_key_exists('ACK', $httpParsedResponseAr)) {
        exit("Invalid HTTP Response for POST request($nvpreq) to $API_Endpoint.");
    }

    return $httpParsedResponseAr;
} 
```

我在 Paypal 沙盒中有三个帐户：两个企业帐户和一个个人帐户。我所有的 Paypal 账户都将美元作为默认货币。

在上面的代码中，我使用欧元作为货币。

当我进行交易时，如果我从我的个人（买家）账户以欧元付款，那么我的买家账户将被扣除（从我的买家账户中扣除等量的美元）。这完全没问题，没有问题。

问题是没有任何金额被添加到我的企业或（卖家）账户中。

我在 Stack Overflow 上找到了一篇文章，内容如下：

> 如果交易的货币代码和卖家账户不匹配，那么钱不会被添加到卖家账户

我把欧元换成了美元，（因为我的沙盒卖家测试账户是美元），发现在把它换成美元之后，我的钱就会被添加到我的卖家账户中。

这只是沙盒的问题，还是也适用于实时贝宝？

我有一个网站，买家可以用 GBP、EUR、MYN、SGD、AUD 支付。

如果交易需要以特定的货币进行，即根据卖家账户设置的货币，则无需使用不同的货币。

由于在 SetExpressCheckOut 中传递的 currencyCode 应该与 DoExpressCheckout 匹配，并且由于我遇到的问题，currencyCode 需要与沙盒卖家帐户的相同，所以即使买家选择 GBP，我也必须将其发送到 SetExpressCheckout 作为卖家账户的货币代码。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T11:50:57.167

您应该通过相关企业帐户的控制面板添加您希望接收付款的货币。

转到`Profile`-> `My Settings`-> 财务信息选项卡和`Currency Balances`。从那里选择一种货币并将其添加到列表中。然后，您收到的付款将保存在相应的货币余额中，直到您将它们转换为您想要的任何东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T15:39:22.293

默认情况下，以您不持有的货币进行的交易将被保留，直到您决定如何处理它们。如果您登录有问题的卖家账户，您应该会在您的历史记录下看到该交易。您应该能够从那里接受或拒绝它。

有两种方法可以解决这个问题：

*   正如 Alderis 所说，将欧元作为货币余额添加到您的卖家账户中。
*   让所有以您不持有的货币进行的交易自动被接受并转换为美元。为此，请登录卖家账户，点击**Profile**，然后点击**Payment Receiving Preferences**（在**Selling preferences**列中），然后将**Block payments sent to me in a currency I didn't hold**设置为**No, accept them and convert them转换为美元**，然后单击**保存**。

# javascript - 导航到在 Sharepoint 2010 中另存为 html 的 Powerpoint 中的特定幻灯片

> ID：14845737
> 
> 赞同：1
> 
> 时间：2013-02-13T03:03:50.280
> 
> 标签：javascript, sharepoint-2010

我有一个保存为 html 的 Powerpoint 文件，它被插入到 Sharepoint 2010 中的页面查看器 WebPart 中。它运行良好，但我不知道如何显示特定的幻灯片。

PowerPoint 的 URL 是：http: [//xxx.yyy.com.au/Documents/PPName_files/frame.htm](http://xxx.yyy.com.au/Documents/PPName_files/frame.htm)

我可以看到您可以使用 javascript 从框架内导航到特定幻灯片： javascript:GoToSld('slide0123.htm');

有没有办法在 URL 中组合这些以在特定幻灯片编号处打开演示文稿？

抱歉，我对 javascript 不太了解。

谢谢，珍妮

# c - 为 SDL 1.2 制作当前 OpenGL 上下文

> ID：14845738
> 
> 赞同：0
> 
> 时间：2013-02-13T03:03:58.707
> 
> 标签：c, opengl, sdl

在 SDL 2 上，有功能`SDL_GL_MakeCurrent`，SDL 1.2 有类似的东西吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T15:38:38.437

不在公共 API 中，不。

不过，[私有视频后端接口](http://hg.libsdl.org/SDL/file/dbaee3350e32/src/video/SDL_sysvideo.h#l182)有一个函数指针。

# apache - Apache 反向代理 - 停止尾随斜杠重定向

> ID：14845742
> 
> 赞同：2
> 
> 时间：2013-02-13T03:04:08.090
> 
> 标签：apache, mod-rewrite, webserver, apache2, mod-proxy

我正在将在 Sun One (iPlanet) 6.1 上运行静态 HTML 的站点迁移到 Apache 上的 Drupal 站点。

需要保持旧服务器运行并提供旧内容，直到可以将其移入 Drupal。我认为最简单的方法是在 Apache 中有一些反向代理条目指向这个旧内容。

这是我在服务器上下文级别的 httpd.conf 中的内容。

```
RewriteEngine On
RewriteLogLevel 9
RewriteLog "/var/log/httpd/rewrite_log"
RewriteRule offices/ist/?(.*)$ http://oldserver/offices/ist/$1 [P]
<Location /offices/ist/>
ProxyPassReverse /
</Location> 
```

当我提出这样的请求时，一切正常。

```
http://newserver/offices/ist/somedir/ 
```

如果我发出相同的请求（没有尾部斜杠），它 302 会使用旧服务器的名称进行重定向。

```
http://newserver/offices/ist/somedir    =>  Redirect to http://oldserver/offices/ist/somedir/ 
```

Apache 不应该在它被发送回客户端之前捕获这个重定向吗？

我可以让 Apache 在将这些请求发送到旧服务器之前重写它们吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T03:57:25.053

问题是 Sun One 的重定向标头造成的。
将 Apache 代理到另一个 Apache 服务器，问题就消失了。Apache 能够在后端 Apache 服务器发送到客户端之前捕获重定向。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T08:29:42.480

我不确定，但可能是`(.*)`太贪心了。

我查看了[Apache mod_rewrite](http://httpd.apache.org/docs/2.2/mod/mod_rewrite.html)，但没有找到`?`.

我建议在没有`/?`或类似于[Apache mod_proxy](http://httpd.apache.org/docs/2.2/mod/mod_proxy.html)示例的情况下尝试它。

```
ProxyPass /foo http://foo.example.com/bar
ProxyPassReverse /foo http://foo.example.com/bar 
```

# spring - Spring Security：应用程序启动时的会话处理

> ID：14845743
> 
> 赞同：1
> 
> 时间：2013-02-13T03:04:15.350
> 
> 标签：spring, security

我正在使用以下内容来处理我的 Web 应用程序中的会话：

```
<security:session-management invalid-session-url="/session-expired" session-authentication-strategy-ref="sas"/>

<bean id="sas"
    class="org.springframework.security.web.authentication.session.ConcurrentSessionControlStrategy">
    <constructor-arg name="sessionRegistry"
        ref="sessionRegistry" />  
    <property name="maximumSessions" value="1" />
</bean> 
```

每当我启动我的应用程序（通常在 Tomcat 7 上）并尝试访问我的登录页面时，它都会转到 /session-expired url。为什么会这样？一旦应用程序停止，所有会话不应该失效吗？还是这更多的是浏览器会话问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T04:40:11.280

您仍然可以在浏览器上保留上一个会话的 JSESSIONID cookie，一旦您关闭 tomcat，该 cookie 将不再有效，因此您会被重定向到无效的会话页面。尝试在服务器启动后第一次访问应用程序之前先删除 cookie，并检查行为是否符合您的预期

# postgresql - 有趣的数据库错误

> ID：14845745
> 
> 赞同：0
> 
> 时间：2013-02-13T03:04:25.567
> 
> 标签：postgresql, django-models

请任何人告诉我为什么在下面保存此模型时收到此消息我环顾四周发现有类似问题但有很多解决方案的人。

```
Exception Type:     DatabaseError
Exception Value: value too long for type character varying(10)
Exception Location: /usr/local/lib/python2.7/dist-packages/django/db/backends/postgresql_psycopg2/base.py in execute, line 52

class Stylesheet(models.Model): 
    text_color = models.CharField(max_length = 50,default = '#000')
    a_visited = models.CharField(max_length = 50,default = '#000')
    background = models.CharField(max_length = 50,default = '#000')
    content_background_color = models.CharField(max_length = 50,default= '#000')
    nav_color = models.CharField(max_length = 50,default = '#000')
    nav_background = models.CharField(max_length = 50,default = '#000')
    nav_gradient_start = models.CharField(max_length = 50,default = '#000')
    nav_gradient_end = models.CharField(max_length = 50,default = '#000')
    nav_a_color = models.CharField(max_length = 50,default = '#000')
    nav_a_hover_color = models.CharField(max_length = 50,default = '#000')
    nav_a_hover_background = models.CharField(max_length = 50,default = '#000')
    nav_a_hover_gradient_start = models.CharField(max_length = 50,default = '#000')
    nav_a_hover_gradient_end = models.CharField(max_length = 50,default = '#000')
    slug = models.SlugField(max_length = 255,blank=True,null = True,editable=False)

    class Meta:
            db_table = 'stylesheet'
            verbose_name = 'Style sheet'
            verbose_name_plural = 'Style sheets'

    def __unicode__(self):
            return self.slug

    def save(self):                   
            super(Stylesheet, self).save() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T03:19:10.820

您的应用程序中的哪一行是第 52 行？

问题似乎是您在数据库字段上设置了 10 个字符限制，并且您试图将其传递给大于 10 的值

有关更多信息，请参阅此 SO 问题[奇怪的 PostgreSQL“对于类型字符变化（500）的值太长”](https://stackoverflow.com/questions/13485030/strange-postgresql-value-too-long-for-type-character-varying500)

# css - 使用或在媒体查询中？

> ID：14845755
> 
> 赞同：1
> 
> 时间：2013-02-13T03:05:14.297
> 
> 标签：css

```
<link rel="stylesheet" type="text/css" href="css/mobile.css" media="screen and (max-height: 500px)" />
<link rel="stylesheet" type="text/css" href="css/mobile.css" media="screen and (orientation:portrait)" /> 
```

我有上述媒体查询来定位纵向和窗口高度 < 500 的用户，有没有办法在媒体查询中使用 OR 将它们合并到一个链接标签中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T03:12:35.440

使用 , 作为 OR 运算符。

参考：[CSS 媒体查询](https://developer.mozilla.org/en-US/docs/CSS/Media_queries)

因此，您的代码将是：

```
<link rel="stylesheet" type="text/css" href="css/mobile.css" media="screen and (max-height: 500px), screen and (orientation:portrait)" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T03:13:34.070

[这是MDN 文章中有关媒体查询](https://developer.mozilla.org/en-US/docs/CSS/Media_queries#comma-separated_lists)的相关部分。

只需用逗号将它们组合起来：

```
media="screen and (max-height: 500px), screen and (orientation: portrait)" 
```

# java - 如何等到 SwingWorker 完成？

> ID：14845759
> 
> 赞同：9
> 
> 时间：2013-02-13T03:06:10.913
> 
> 标签：java, swing, swingworker

我有一个在后台计算的摇摆工作者，同时更新 JFrame 中的进度条。

如何让我的主线程等待 doInBackground () 完成？

我知道我可以把事情放在 done() 方法中，但我想知道是否有办法让程序真正等待（那个线程，是正确的）。

类似于模态 JDialog 所做的事情。

所以...

```
SwingWorker a = new SwingWorker();
a.execute

doOtherStuff(); 
```

doOtherStuff 仅在 doInBackground 完成后运行，但不将所述方法放入 SwingWorker 的 done() 方法中。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-02-13T03:18:19.843

简短的回答是，是的。

`SwingWorker#get`将阻塞直到`doInBackground`方法返回。

长答案是，可能不是您想要做的。

如果您`SwingWorker`从 EDT 启动并调用`SwingWorker#get`，您将阻止 EDT，阻止它处理任何更新，这会导致您回到使用`SwingWorker`.

在这种情况下，您有两个选择。您可以提供一个回调接口，一旦完成`SwingWorker`就可以调用它。或者您可以将 a 附加到并监视该值，等到它等于`done``SwingWorker``PropertyChangeListener``SwingWorker``state``StateValue.Done`

# php - 试图阻止浏览器触发 cronjob

> ID：14845762
> 
> 赞同：0
> 
> 时间：2013-02-13T03:06:26.850
> 
> 标签：php, permissions, cron

所以我有一个 cron 工作可以做很多事情（现在与我们无关）。

我已将文件权限设置为 744，希望它会阻止浏览器执行脚本。

理想情况下，我希望将其设置为只有服务器用户//cronjob 可以运行脚本，而不是通过浏览器运行脚本的人，这可能会导致很多问题。

这是我设置 cron 作业的方式：

/usr/local/bin/php /home/xxxx/public_html/cron/scriptName.php > cronlogs@xxxx.com `

谁能指出我关于这个问题的正确方向？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-13T03:07:33.940

把它放在你的`public_html`目录之外。如果没有提供，没有人可以用浏览器触发它。

# assembly - 功能的管理员权限，它是如何工作的？

> ID：14845764
> 
> 赞同：0
> 
> 时间：2013-02-13T03:07:01.163
> 
> 标签：assembly, admin, uac

我很感兴趣 PC 如何识别 X 功能需要管理员权限。

让我想想，让我们检查两件事：
第一个是 C# 代码，第二个是 ASM 代码。

如果 C# 需要管理员权限，那么 ASM 也需要它们吗？

有时很难为有限的帐户编写简单的程序

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T03:33:04.323

操作系统决定。

由于 ASM 和 C# 代码做同样的事情，它们都必须使用相同的操作系统。这就像你只有一把门的钥匙，人们必须让你用它才能进去。不管他们是通过电子邮件还是电话询问，他们仍然要向你要钥匙你必须决定他们是否得到它。

如果您在为受限帐户编写简单程序时遇到问题，那是因为您正在尝试做受限帐户不允许的事情。:-)

# c - 将 void 指针传递给函数指针

> ID：14845766
> 
> 赞同：0
> 
> 时间：2013-02-13T03:07:07.660
> 
> 标签：c, function-pointers, void-pointers

简而言之，我试图使用 void 指针作为函数指针的参数，但得到编译器错误“无效使用 void 表达式”。

我有一个双向链表（DLL），其节点结构如下：

```
typedef struct DL_LIST
{
    uint16 tag;                 /* Object ID tag */
    struct DL_LIST *previous;
    struct DL_LIST *next;
    void *object;               /* A pointer to this node's object */
    uint32 size;                /* The size of this node's object, in bytes */
} DL_LIST; 
```

我还有以下用于删除单个此类节点的功能：

```
void dl_delete(DL_LIST *node, void (*dl_destructor)(void*)) {
    if (node != NULL) {
        dl_extract(node);       /* Removes the node from the list */

        if (node->object != NULL) {
            (*dl_destructor)(node->object);

            free(node->object);
        }

        free(node);
    }
} 
```

其中节点提取函数为：

```
DL_LIST *dl_extract(DL_LIST *node) {
    if (node != NULL) {
        if (node->previous != NULL) {
            node->previous->next = node->next;
        }

        if (node->next != NULL) {
            node->next->previous = node->previous;
        }

        node->previous = NULL;
        node->next = NULL;
    }

    return node;
} 
```

这里的想法是能够为`object`可能存储在节点中的每种类型传递一个单独的析构函数。此析构函数将指向对象的指针作为参数，用于释放`object`.

当我尝试`dl_delete()`从旨在删除整个 DLL 的函数中调用时，会发生上述错误：

```
void dl_destroy(DL_LIST **list, void (*dl_destructor)(void*)) {
    DL_LIST *marker;
    DL_LIST *previous_node;

    if (*list != NULL) {
        previous_node = (*list)->previous;

        while (previous_node != NULL) {
            marker = previous_node->previous;
            dl_delete(previous_node, (*dl_destructor)(previous_node->object));
            previous_node = marker;
        }

        /* Code removed for brevity */
    }
} 
```

我已阅读[此](https://stackoverflow.com/questions/840501/how-do-function-pointers-in-c-work)函数指针介绍，但仍无法确定如何解决该问题。对我做错了什么的解释将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T03:10:35.967

这条线

```
dl_delete(previous_node, (*dl_destructor)(previous_node->object)); 
```

需要是`dl_delete(previous_node, dl_destructor);`

也在 dl_delete 这一行`(*dl_destructor)(node->object);`

应该`dl_destructor(node->object);`

另外，为了安全起见，我喜欢在尝试使用它们进行调用之前检查我的函数指针是否不为空

所以在 dl_delete 中是这样的：-

```
if(dl_destructor!=NULL) dl_destructor(node->object); 
```

# python - 在 Python 中重新格式化秒表 .csv

> ID：14845772
> 
> 赞同：0
> 
> 时间：2013-02-13T03:07:53.613
> 
> 标签：python, csv, formatting, multiple-columns, calculated-columns

我知道必须有几种方法可以做到这一点，但我很想听听你的意见，哪种方法是最好的方法。

我有一个 .csv，从手机的秒表应用程序输出，如下所示：

```
No.,Split time,,
1,+03:16.110,,
2,+12:23.120,,
3,+15:36.187,,
4,+16:56.487,,
5,+19:30.488,,
6,+20:01.621,,
 [...]
37,+53:01.921,,
38,+53:39.738,,
39,+53:40.241,,
40,+01:06.849,,
41,+01:16.442,, 
```

我需要将秒表时间码更改为小时：分钟：秒：帧格式，删除列标题，添加额外信息并考虑小时翻转（从第 40 行开始）。

因此，输出将如下所示：

```
cut_v01 00:03:16:00 V4  black                  
cut_v01 00:12:23:00 V4  black                  
cut_v01 00:15:36:00 V4  black                  
cut_v01 00:16:56:00 V4  black                  
cut_v01 00:19:30:00 V4  black                  
cut_v01 00:20:01:00 V4  black                  
 [...]         
cut_v01 00:53:01:00 V4  black                  
cut_v01 00:53:39:00 V4  black                  
cut_v01 00:53:40:00 V4  black                  
cut_v01 01:01:06:00 V4  black                  
cut_v01 01:01:16:00 V4  black 
```

最有效的方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T02:27:38.347

弄清楚了 -

```
import string, sys, os

def convert_stopwatch(in_filename): 
   new_filename=in_filename.replace("Stopwatch", "Timecode")

   SW_lines=open(in_filename,'Ur').readlines() 
   timecode=open(new_filename, 'w') 

   previous_minutes = 0  
   hours = 0

   for SW_line in SW_lines:
            plus_pos = SW_line.find("+")      
            if plus_pos > -1: 
                dot_pos = SW_line.find(".")
                SW_time = SW_line[plus_pos + 1:dot_pos] 

                minutes = int(SW_time.split(":")[0]) 
                if minutes < previous_minutes: 
                    hours = hours + 1
                previous_minutes = minutes

                timecode.write("cut_v01 %02d:%s:00 V4 black\n" % (hours,SW_time) ) 

   print "Timecode file(s) successfully created:\n %s\n\n" % (new_filename) 

for root, dirs, files in os.walk(os.getcwd()): 
SW_file=""
for filename in files:
   if (filename.startswith("Stopwatch")): 
      if (filename.endswith(".csv")): 
         convert_stopwatch(os.path.join(root, filename)) 
```

# java - 如何从 Phonegap 插件更改本机元素？

> ID：14845775
> 
> 赞同：2
> 
> 时间：2013-02-13T03:08:00.360
> 
> 标签：java, android, cordova, phonegap-plugins

我想更改从 cordova 插件传递的本机 TextView 值。此应用程序将在一个活动布局中显示 2 个元素 - 本机元素 (TextView) 和 cordova webview。是否可以在 main 和 phonegap 之间交换上下文以更新当前 UI...有任何想法吗？...

示例概念 -

```
public class MainActivity extends Activity implements CordovaInterface{
 .....
 .....
 public void changeText(String txt){
    textView = (TextView) findViewById(R.id.textView);
    textView.setText(txt);

 }

} 
```

科尔多瓦插件：

公共类 MyPlugin 扩展 CordovaPlugin {

```
 public boolean execute(String action, JSONArray args, final CallbackContext callbackContext){
          if (action.equals("changeText")) {
                      ..............
                 }
  }
} 
```

布局 ：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    tools:context=".MainActivity" >

   <org.apache.cordova.CordovaWebView
       android:id="@+id/tutorialView"
       android:layout_width="match_parent"
       android:layout_height="196dp" />

   <TextView
        android:id="@+id/textView"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="@string/hello_world" />

</RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-06T03:49:38.477

最后它起作用了...... 2个元素很重要：

*   **科尔多瓦上下文**- 在插件类中调用 textview 使用：

`TextView textView = cordova.getActivity().findViewById(R.id.textView);`

*   **线程**- 调用使用 runOnUiThread 执行的科尔多瓦插件中的更改

例如：-

```
cordova.getActivity().runOnUiThread(new Runnable(){
 public void run() {

                textView.setText("Cordova Hello World"); 

                callbackContext.success(); 

                // Thread-safe. 

        } }); 
```

# java - 以 JAR 形式编译的 Java 编译器？

> ID：14845778
> 
> 赞同：0
> 
> 时间：2013-02-13T03:08:36.577
> 
> 标签：java, compiler-construction, jar

我有一个应用程序需要将 .java 文件编译成应用程序中的 .class***文件***。理想情况下，我想要一个 JAR，我可以通过提供两个参数来使用它的 api 进行编译：要编译的文件的名称和存储 .class 文件的目录。我的应用程序将使用 Java 编译器，该编译器将与软件一起打包和发布。

我实际上有一个小型 Java 编译器，就像我以 JAR 形式描述的那样，但它只有 java 7.0 的一个子集。

java编译器是否可以像这样以Jar形式提供？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T03:14:02.010

编译器在 tools.jar 中。

参考[http://docs.oracle.com/javase/6/docs/api/javax/tools/package-summary.html](http://docs.oracle.com/javase/6/docs/api/javax/tools/package-summary.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T03:26:03.613

[Java Compiler API (JSR 199)](http://jcp.org/en/jsr/detail?id=199)就是为此目的而创建的，您可以像这样创建一个编译器实例：

`JavaCompiler compiler = ToolProvider.getSystemJavaCompiler();`

[这是关于动态生成 Java 类](http://www.accordess.com/wpblog/an-overview-of-java-compilation-api-jsr-199/)的一个很好的教育教程

[这](https://stackoverflow.com/questions/7665809/programmatically-compile-java-with-javacompiler)是一个与示例代码相关的问题

# ruby-on-rails - NoMethodError 的完整跟踪

> ID：14845786
> 
> 赞同：1
> 
> 时间：2013-02-13T03:09:53.523
> 
> 标签：ruby-on-rails, ruby-on-rails-3, stack-trace

这基本上是我之前问题的第 2 部分，根据要求，由于代码的长度，我创建了一个新问题。希望我们能解决这个问题，在您的帮助下，我相信我们现在可以使用新信息找到解决方案。

编辑：感谢您的输入。这是pt的链接。1 与实际代码：[登录功能不起作用](https://stackoverflow.com/questions/14822987/sign-in-function-not-working)。

附言。请不要忘记投票这个问题。

这是user.rb：

```
# == Schema Information
#
# Table name: users
#
#  id                 :integer          not null, primary key
#  name               :string(255)
#  email              :string(255)
#  created_at         :datetime         not null
#  updated_at         :datetime         not null
#  encrypted_password :string(255)
#  salt               :string(255)
#

class User < ActiveRecord::Base
  attr_accessor   :password
  attr_accessible :email, :name, :password, :password_confirmation

  email_regex = /\A[\w+\-.]+@[a-z\d\-.]+\.[a-z]+\z/i

  validates :name, :presence => true,
                   :length => { :maximum => 50 }
  validates :email, :presence => true,
                    :format => { :with => email_regex },
                    :uniqueness => { :case_sensitive => false }
  validates :password, :presence => true,
                       :confirmation => true,
                       :length => { :within => 6..40 }

  before_save :encrypt_password

  def has_password?(submitted_password)
    encrypted_password == encrypted(submitted_password)
  end

  class << self 
    def User.authenticate(email, submitted_password)
      user = find_by_email(email)
      (user && user.has_password?(submitted_password)) ? user : nil
    end

    def authenticate_with_salt(id, cookie_salt)
      user = find_by_id(id)
      (user && user.salt == cookie_salt) ? user : nil
    end
  end

  private

  def encrypt_password
    self.salt = make_salt if new_record?
    self.encrypted_password = encrypt(password)
  end

  def encrypt(string)
    secure_hash("#{salt}--#{string}")
  end

  def make_salt
    secure_hash("#{Time.now.utc}--#{password}")
  end

  def secure_hash(string)
    Digest::SHA2.hexdigest(string)
  end               

end 
```

和初始完整跟踪：

```
undefined method `encrypted' for #<User:0x007fdcde331a90>

Rails.root: /Users/anthonypanepinto/Sites/rails_projects/sample_app1
Application Trace | Framework Trace | Full Trace

activemodel (3.2.11) lib/active_model/attribute_methods.rb:407:in `method_missing'
activerecord (3.2.11) lib/active_record/attribute_methods.rb:149:in `method_missing'
app/models/user.rb:32:in `has_password?'
app/models/user.rb:38:in `authenticate'
app/controllers/sessions_controller.rb:7:in `create'
actionpack (3.2.11) lib/action_controller/metal/implicit_render.rb:4:in `send_action'
actionpack (3.2.11) lib/abstract_controller/base.rb:167:in `process_action'
actionpack (3.2.11) lib/action_controller/metal/rendering.rb:10:in `process_action'
actionpack (3.2.11) lib/abstract_controller/callbacks.rb:18:in `block in process_action'
activesupport (3.2.11) lib/active_support/callbacks.rb:414:in `_run__1623305808682769517__process_action__2997016911314885603__callbacks'
activesupport (3.2.11) lib/active_support/callbacks.rb:405:in `__run_callback'
activesupport (3.2.11) lib/active_support/callbacks.rb:385:in `_run_process_action_callbacks'
activesupport (3.2.11) lib/active_support/callbacks.rb:81:in `run_callbacks'
actionpack (3.2.11) lib/abstract_controller/callbacks.rb:17:in `process_action'
actionpack (3.2.11) lib/action_controller/metal/rescue.rb:29:in `process_action'
actionpack (3.2.11) lib/action_controller/metal/instrumentation.rb:30:in `block in process_action'
activesupport (3.2.11) lib/active_support/notifications.rb:123:in `block in instrument'
activesupport (3.2.11) lib/active_support/notifications/instrumenter.rb:20:in `instrument'
activesupport (3.2.11) lib/active_support/notifications.rb:123:in `instrument'
actionpack (3.2.11) lib/action_controller/metal/instrumentation.rb:29:in `process_action'
actionpack (3.2.11) lib/action_controller/metal/params_wrapper.rb:207:in `process_action'
activerecord (3.2.11) lib/active_record/railties/controller_runtime.rb:18:in `process_action'
actionpack (3.2.11) lib/abstract_controller/base.rb:121:in `process'
actionpack (3.2.11) lib/abstract_controller/rendering.rb:45:in `process'
actionpack (3.2.11) lib/action_controller/metal.rb:203:in `dispatch'
actionpack (3.2.11) lib/action_controller/metal/rack_delegation.rb:14:in `dispatch'
actionpack (3.2.11) lib/action_controller/metal.rb:246:in `block in action'
actionpack (3.2.11) lib/action_dispatch/routing/route_set.rb:73:in `call'
actionpack (3.2.11) lib/action_dispatch/routing/route_set.rb:73:in `dispatch'
actionpack (3.2.11) lib/action_dispatch/routing/route_set.rb:36:in `call'
journey (1.0.4) lib/journey/router.rb:68:in `block in call'
journey (1.0.4) lib/journey/router.rb:56:in `each'
journey (1.0.4) lib/journey/router.rb:56:in `call'
actionpack (3.2.11) lib/action_dispatch/routing/route_set.rb:601:in `call'
actionpack (3.2.11) lib/action_dispatch/middleware/best_standards_support.rb:17:in `call'
rack (1.4.4) lib/rack/etag.rb:23:in `call'
rack (1.4.4) lib/rack/conditionalget.rb:35:in `call'
actionpack (3.2.11) lib/action_dispatch/middleware/head.rb:14:in `call'
actionpack (3.2.11) lib/action_dispatch/middleware/params_parser.rb:21:in `call'
actionpack (3.2.11) lib/action_dispatch/middleware/flash.rb:242:in `call'
rack (1.4.4) lib/rack/session/abstract/id.rb:210:in `context'
rack (1.4.4) lib/rack/session/abstract/id.rb:205:in `call'
actionpack (3.2.11) lib/action_dispatch/middleware/cookies.rb:341:in `call'
activerecord (3.2.11) lib/active_record/query_cache.rb:64:in `call'
activerecord (3.2.11) lib/active_record/connection_adapters/abstract/connection_pool.rb:479:in `call'
actionpack (3.2.11) lib/action_dispatch/middleware/callbacks.rb:28:in `block in call'
activesupport (3.2.11) lib/active_support/callbacks.rb:405:in `_run__3609576242730521204__call__105225653498443597__callbacks'
activesupport (3.2.11) lib/active_support/callbacks.rb:405:in `__run_callback'
activesupport (3.2.11) lib/active_support/callbacks.rb:385:in `_run_call_callbacks'
activesupport (3.2.11) lib/active_support/callbacks.rb:81:in `run_callbacks'
actionpack (3.2.11) lib/action_dispatch/middleware/callbacks.rb:27:in `call'
actionpack (3.2.11) lib/action_dispatch/middleware/reloader.rb:65:in `call'
actionpack (3.2.11) lib/action_dispatch/middleware/remote_ip.rb:31:in `call'
actionpack (3.2.11) lib/action_dispatch/middleware/debug_exceptions.rb:16:in `call'
actionpack (3.2.11) lib/action_dispatch/middleware/show_exceptions.rb:56:in `call'
railties (3.2.11) lib/rails/rack/logger.rb:32:in `call_app'
railties (3.2.11) lib/rails/rack/logger.rb:16:in `block in call'
activesupport (3.2.11) lib/active_support/tagged_logging.rb:22:in `tagged'
railties (3.2.11) lib/rails/rack/logger.rb:16:in `call'
actionpack (3.2.11) lib/action_dispatch/middleware/request_id.rb:22:in `call'
rack (1.4.4) lib/rack/methodoverride.rb:21:in `call'
rack (1.4.4) lib/rack/runtime.rb:17:in `call'
activesupport (3.2.11) lib/active_support/cache/strategy/local_cache.rb:72:in `call'
rack (1.4.4) lib/rack/lock.rb:15:in `call'
actionpack (3.2.11) lib/action_dispatch/middleware/static.rb:62:in `call'
railties (3.2.11) lib/rails/engine.rb:479:in `call'
railties (3.2.11) lib/rails/application.rb:223:in `call'
rack (1.4.4) lib/rack/content_length.rb:14:in `call'
railties (3.2.11) lib/rails/rack/log_tailer.rb:17:in `call'
rack (1.4.4) lib/rack/handler/webrick.rb:59:in `service'
/usr/local/rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/webrick/httpserver.rb:138:in `service'
/usr/local/rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/webrick/httpserver.rb:94:in `run'
/usr/local/rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/webrick/server.rb:191:in `block in start_thread'

Request

Parameters:

{"utf8"=>"✓",
 "authenticity_token"=>"/SEaqnrMf5X0pd4FVWbu8uWVAjTNw4LPKiXg+8Hl0PQ=",
 "session"=>{"email"=>"#",
 "password"=>"[FILTERED]"},
 "commit"=>"Sign in"} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-13T03:47:21.263

我猜是

```
def has_password?(submitted_password)
  encrypted_password == encrypted(submitted_password)
end 
```

应该

```
def has_password?(submitted_password)
  encrypted_password == encrypt(submitted_password)
end 
```

* * *

更一般地“如何读取堆栈跟踪来解决问题”：

1）查看堆栈跟踪的顶行（文本的大墙）

```
activemodel (3.2.11) lib/active_model/attribute_methods.rb:407:in `method_missing' 
```

那是*你*代码中的一行吗？在这种情况下，否：它来自 activemodel。

2) 继续寻找，直到您找到适用于*您*的代码的第一行代码。在这种情况下，它：

```
app/models/user.rb:32:in `has_password?' 
```

这是*您的*代码中导致问题的行。

3）去看看导致问题的代码行。堆栈跟踪告诉我们这是文件的第 32 行`app/models/user.rb`

在这种情况下，它是这三行的中间行：

```
def has_password?(submitted_password)
  encrypted_password == encrypted(submitted_password)
end 
```

**4）通过阅读错误消息**找出问题所在；）

错误消息告诉您“加密”作为一种方法不存在是吗？

因此，查看您的用户模型，看看您是否有一个名为 encrypted 的方法......

在这种情况下你没有，但你确实有一个电话“加密” - 很有可能你只是不小心输入了“加密”而不是“加密”......解决这个问题，你的问题就解决了。

这四个步骤可用于解决大多数此类错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T04:20:15.347

似乎您的 ruby​​ 无法识别您`encrypted`的 User 对象的方法。您应该能够通过包括

```
require 'digest/sha1' 
```

对于您的用户模型

例如：

```
require 'digest/sha1'
class User < ActiveRecord::Base
  #code
end 
```

[阅读此问题](https://stackoverflow.com/questions/4128939/simple-encryption-in-ruby-without-external-gems)以了解有关没有 gem 的加密的更多信息

# python - 如何在 Tkinter/Python2.7.3 中使用 Windows Explorer 或 Finder 文件对话框？

> ID：14845789
> 
> 赞同：1
> 
> 时间：2013-02-13T03:10:28.197
> 
> 标签：python, windows, tkinter, finder, windows-explorer

除其他外，我目前正在尝试创建一个基本的文本编辑器，它可以打开文本文件，编辑它们，然后保存它们。我已经将[这个](http://code.activestate.com/recipes/438123-file-tkinter-dialogs/)Tkinter 对话框用于 GUI“文件管理器”，但我想知道是否有人知道如何访问 Windows 上默认设置的那个？

谢谢！

技术方面：

操作系统：Windows 7

语言：Python 2.7.3

**编辑 1**

通过默认文件对话框，我的意思是 Windows 资源管理器对话框：

[![文件选择器](../Images/4d872b26f795d9c31139deeb4e67f62b.png)](https://i.stack.imgur.com/GDCEO.png)

我也用mac。假设我的应用程序是跨平台的，我有什么方法可以让程序检查操作系统是什么，然后打开`Finder`或者`Windows Explorer.`

我需要程序能够在*不同*的命令中保存和打开项目。我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T06:30:21.333

不清楚你在问什么，因为 tkinter 附带的那个*是*Windows 中的默认设置。这是另一个[链接](http://tkinter.unpythonic.net/wiki/tkFileDialog)，以防万一你在某个地方搞混了。请记住，您可以对其进行设置，使其仅查找某种类型的文件，从特定位置开始，返回文件名或目录，甚至打开文件（我认为）

如果你的意思是`Windows Explorer`你可以打开它并用 关闭它`pywin32`，但仅此而已。取自这个[答案](https://stackoverflow.com/a/281911/541208)

```
import subprocess
subprocess.Popen(r'explorer /select,"C:\path\of\folder\file"') 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-05-12T12:54:45.187

尝试导入 tkFileDialog：

```
import tkFileDialog as tkfd
def save():
    savenm = tkfd.asksaveasfile()
    f = open(savenm.name,"w")
    # then put what to do with the opened file
def open():
    opennm = tkfd.askopenfile()
    f = open(savenm.name,"r")
    # then put what to do with the opened file 
```

然后制作一个使用以下功能的按钮：

```
import Tkinter as tk
root=tk.Tk()
SAVELOADFRAME = tk.Frame(root)
SAVELOADFRAME.pack()
savebtn = Button(SAVELOADFRAME,text="Save",command=save)
savebtn.pack(side=LEFT)
root.mainloop()
loadbtn = Button(SAVELOADFRAME,text="Open",command=open)
loadbtn.pack(side=RIGHT) 
```

也许如果您有一个记事本框，您可能希望将文件中的文本插入到 tk.Text 小部件中。上面的代码仅适用于基于文本的文件（例如 *.js、*.txt、*.py），不适用于 *.exe、*.dll 等。

希望能解决你的问题:^)

# oracle - Oracle 11g PL/SQL 游标，相交查询

> ID：14845796
> 
> 赞同：0
> 
> 时间：2013-02-13T03:10:58.367
> 
> 标签：oracle, plsql, cursor

我有以下查询

```
select distinct name from table1
intersect
select distinct name from table2; 
```

我将结果集加载到 PL/SQL 过程中的游标中，如下所示：

```
cursor c1 is (select distinct name from table1
intersect
select distinct name from table2); 
```

由于某种原因，结果集中的最后一个值在游标中重复。单独运行查询时不会发生这种情况。任何想法为什么会发生这种情况？

循环代码：

```
var table.col%type;

BEGIN
OPEN c1;
LOOP    
BEGIN
  exit when c1%NOTFOUND; 
  FETCH c1 into var;       
  INSERT INTO table values (col1, var);
  commit;   
EXCEPTION
 WHEN DUP_VAL_ON_INDEX THEN         
 CONTINUE;  
 END;
END LOOP;    
END; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T09:57:49.033

`EXIT WHEN ..`子句应该在之后`FETCH`。

假设您的游标有 10 条记录要返回。在第一次 fetch 被触发之前，`%NOTFOUND`评估为`NULL`，并且处理移动到下一个语句，这就是`FETCH`你的情况。现在，如果我们快进到第 10 次迭代，FETCH 将获得第 10 条记录，并将其插入到您的目标表中。循环将继续前进，并且由于您`EXIT WHEN %NOTFOUND`在 fetch 之前，它仍然具有上次迭代的值，并且它让控件继续前进，并且在那里，fetch 将无法获取任何记录，但代码无论如何都会插入它在第 10 次迭代中检索到的最后一行。现在在下一个循环中，`c1%NOTFOUND`将被评估为`TRUE`并且循环将终止

```
var table.col%type;

BEGIN
OPEN c1;
LOOP    
BEGIN

FETCH c1 into var;    
exit when c1%NOTFOUND;    
INSERT INTO table values (col1, var);
commit;   
EXCEPTION
WHEN DUP_VAL_ON_INDEX THEN         
CONTINUE;  
END;
END LOOP;    
END; 
```

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-02-13T11:49:45.623

这是您使用显式游标看到的典型问题。

您的首选应该是一条 SQL 语句，仅此而已。

如果必须使用游标，则应尽可能使用隐式游标。

# php - HTML 文档的字符编码未声明为 codeigniter

> ID：14845797
> 
> 赞同：4
> 
> 时间：2013-02-13T03:11:05.027
> 
> 标签：php, html, codeigniter, character-encoding

我的 CodeIgniter 应用程序开始出现异常错误：

```
The character encoding of the HTML document was not declared. The document will render with garbled text in some browser configurations if the document contains characters from outside the US-ASCII range. The character encoding of the page must be declared in the document or in the transfer protocol. 
```

在第一次访问时，页面看起来很好，只是一条消息**“guimbu”**。如果刷新页面，则会出现错误，直到您清除浏览器的历史记录。这仅在第二次页面查看后发生。看看： http: [//guimbu.com/soon](http://guimbu.com/soon)

*   我刚刚用 Sublime 打开了所有文件并保存为 UTF-8；两次。
*   我刚刚尝试了所有字符集元标记；
*   这发生在所有页面上，包括这个简单的页面；

我的 autoload.php 有这个：

```
$autoload['packages'] = array();
$autoload['libraries'] = array('session', 'database', 'firephp', 'auth');
$autoload['helper'] = array('url', 'log_helper', 'api_helper', 'string_helper');
$autoload['config'] = array('ci_opauth', 'rest', 'ci_auth');
$autoload['language'] = array();
$autoload['model'] = array(); 
```

我该如何调试这个问题？

**更新：**

@sudhir，感谢您的回答，但我尝试了很多次。实际上源代码只是：

```
<!DOCTYPE html>
<head>
    <title>guimbu</title>
    <meta content="text/html;charset=utf-8" http-equiv="Content-Type">
    <meta content="utf-8" http-equiv="encoding">
</head>
<body>
    guimbu =)
</body>
</html> 
```

并且在第二次页面查看后错误仍然存​​在=/也许会话有问题？

**更新的可能性：**

当我从**autoload中删除****session**和**auth**库时，问题不会发生。怎么回事？**auth**是我为用户身份验证制作的库。

 ***** * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T04:02:35.357

当您刷新该页面时，您会得到一个空白页面，如果您*查看*该页面的源代码，您会看到它是空白的，有一个数字计数。我的猜测是当页面刷新时你正在做一些事情，向浏览器发送一个空白。我只能建议不要关闭你的文件，`?>`让 php 处理你的脚本将如何退出/死亡。您的代码中有一些空格导致了这种情况。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T03:38:36.720

尝试在视图的头部添加这些：

```
<meta content="text/html;charset=utf-8" http-equiv="Content-Type">
<meta content="utf-8" http-equiv="encoding"> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-13T11:06:55.253

**找到解决方案**

在 Session 类构造函数的第一行中，它加载了 String 帮助器。昨天我创建了一个名为**string_helper.php**的助手，这个冲突就是崩溃的应用程序。

我重命名了我的 string_helper.php 文件，现在一切正常。

谢谢大家！****

# php - 如何使用 PHP Curl 确保下载不会中断

> ID：14845799
> 
> 赞同：0
> 
> 时间：2013-02-13T03:11:24.363
> 
> 标签：php

我使用 PHP 的 Curl 函数从后端下载 pdf 列表。但有时某些 pdf 文件已损坏。

我认为，发生这种情况是因为下载中断，它会在完成上一次下载之前开始下载下一个 pdf。

知道如何防止这种情况吗？我正在使用下面的代码：

```
function downloadAndSave($urlS,$pathS)
{
    $fp = fopen($pathS, 'w');    
    $ch = curl_init();

    curl_setopt($ch,CURLOPT_PROXY,"http://test:1234");
    curl_setopt($ch,CURLOPT_PROXYPORT,1234);
    curl_setopt ($ch, CURLOPT_CONNECTTIMEOUT, 0);
    curl_setopt($ch,CURLOPT_URL,$urlS);
    curl_setopt($ch, CURLOPT_FILE, $fp);
    $data = curl_exec($ch);

    fclose($fp);    
} 
```

我试过使用 CURLOPT_CONNECTTIMEOUT 但没有区别。还有什么方法可以防止这种情况吗？

# actionscript-3 - AS3平滑旋转方向

> ID：14845800
> 
> 赞同：0
> 
> 时间：2013-02-13T03:11:24.927
> 
> 标签：actionscript-3

我对径向计算不是很好，我无法想象，因此我不能确定。我需要一些关于 Math.atan2() 的解释，拜托。

通常的任务 - 使对象在鼠标之后旋转。我得到了差异，得到了角度，我在文本区域看到了角度，并且对象直接跟随鼠标。我现在需要的是一切顺利。我需要角度为 0-360 但在 180 对象旋转后变为 -180 并向后计数，鼠标旋转在 270 后变为 -90 并且也计数回 0。

更深入一点，我想要一个平滑的旋转，这意味着一个设定的速度，比如每帧 2 次，以最短的方式满足鼠标角度。需要设置条件，我不能这样做，因为我什至不了解这些值的逻辑。它们几乎是随机的！我不需要完成或复制它，我需要理解才能继续前进，所以如果你能解释它是如何工作的以及我做错了什么......

代码很简单：angle = Math.atan2(deltaY,deltaX)/(Math.PI/180) + 90; //+90 导致它看不到鼠标// Object01.rotation = angle;

所以问题是我什至不明白它是如何工作的......如果2个值不同，则对象不能指向鼠标，但它确实如此。数字是谎言，如果我需要基于这些数字的东西，那将是错误的。非常错误......需要组织。这意味着我希望一切都准备好进行进一步的编码，这些编码将基于旋转而不是因为不合适而上下跳跃。

添加：解释它是如何发生的，我上面描述的。为什么价值观如此混乱？正如我所说，关于如何安排它以进行进一步编码的建议。如果我想让旋转成为射击方向和瞄准速度等重要事件的一个元素，那么仅动画是行不通的。或开锁锁的旋转速度变化。或者任何更复杂的东西，如果我不制作直接和清晰的值就不会起作用：从 A 到 Z，从 1 到 10，2 到 3 之间没有 8s，B 之前没有 R，当对象面对它时没有鼠标角度 270 - 90时，他们都从0开始，一起达到180。哦，正如我所说，面向鼠标的工作，但是当我尝试以最短的方式以一定的速度追逐鼠标时，它会在所有 4 个季度中将对象转向错误的方向。我假设它' s 还有关于这个反正切的事情，它在不同的季度有 delta 值变为负数的问题。当我更改它时，其他一些值会出错......所以我需要确切地知道我在做什么才能知道出了什么问题以及如何解决它。所以是的。需要解释。请。

Add2: 角度Z = Math.atan2(oppSide,adjSide)/(Math.PI/180); 所以我将轮换分为 4 个季度，每个季度我都将 atan 视为 opp。侧向 adj. 边，然后分别添加 90、180 和 270。我的鼠标旋转 360 度，但是通过简单 object.rotation = angleZ; 跟随的对象 仍然到 180，然后从左侧的 -180 到 0。为什么它忽略了简单的命令？旋转适合，但我需要它是平等的，没有惊喜！为什么会这样？我直接设置为等于另一个数字作为动作的基础的数字如何将自身更改为相同旋转但完全不同的数字？它甚至不知道它的度数！就像“object.rotation，请等于我选择的数字！”一样简单！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T03:32:01.173

作为一个想法，由于您似乎知道需要旋转的角度及其方向，因此朝着该角度进行动画处理以获得平滑旋转会更容易吗？基本上将其视为任何其他可动画属性，只需添加每帧刻度的旋转速度（看起来像 2 度），直到达到所需的旋转。

1.  找到旋转所需的角度量
2.  弄清楚是顺时针还是逆时针方向并设置旋转量。这可以通过检查角度是否大于 180 / 正或负来计算
3.  每帧刻度添加旋转量*方向，直到所需的旋转小于或等于每帧的旋转量
4.  将旋转设置为所需的旋转

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T13:43:38.470

这只是不同的坐标系。就像 x 在舞台左侧从 0 开始，向右 +x 和 -x 向左一样，对象旋转从 0˚ 开始向上，顺时针旋转 +180˚，逆时针旋转 -180˚。

Math.atan2 恰好从 0 指向左 (-x) 开始，顺时针 +270˚ 和逆时针 -90˚，这很烦人，但这只是意味着您必须通过添加 90˚ 在坐标系之间进行转换。

当然，您可以一遍又一遍地旋转某些东西，因此数字会跳跃，以便它们始终保持在同一范围内，因为 361˚ 与 1˚ 相同，-270˚ 与 90˚ 相同。您可以告诉对象在 -180˚ 到 180˚ 范围之外旋转，它会将旋转标准化到这些值内。

正如 mitim 所描述的，要平滑地为旋转设置动画，您需要使用`Event.ENTER_FRAME`、 a或[TweenLite 之](http://www.greensock.com/tweenlite/)`Timer`类的补间库。大多数补间库可以为您计算出最短的旋转方向，否则您可以简单地计算两者并查看哪个更小。

# oracle - 只能绑定 LONG 值以插入 LONG 列 oracle

> ID：14845807
> 
> 赞同：0
> 
> 时间：2013-02-13T03:12:40.030
> 
> 标签：oracle

我可能遗漏了一些非常明显的东西，但我不知道它是什么。

我收到一个错误“只能绑定 LONG 值以插入 LONG 列”。

下面是我正在运行的代码。我的表字段的数据类型是 VarChar2，而不是 LONG。我用来转换 blob 的变量也被声明为 VarChar2，那么这里的 LONG 是什么？

我想也许我插入的值太长了——但我正在发布我试图插入的 dbms 输出，它位于名为 FIELD 的行上。

非常感谢您

这是 DBMS 输出

字段长度 5

场 1004t

这是代码

```
 DROP TABLE ANALYST.NR_DTS_BLOBFIELDS_VARCHAR;

CREATE TABLE ANALYST.NR_DTS_BLOBFIELDS_VARCHAR(formid NUMBER
                            ,regionId VARCHAR(4000))
RESULT_CACHE (MODE DEFAULT)
STORAGE(BUFFER_POOL DEFAULT
     FLASH_CACHE DEFAULT
     CELL_FLASH_CACHE DEFAULT)
LOGGING
NOCOMPRESS
NOCACHE
NOPARALLEL
NOMONITORING;

DECLARE
     CURSOR c_dts IS
       SELECT Form_ID
         FROM NR_DTS_FORMTABLE
        WHERE   1 = 1
           --AND ROWNUM BETWEEN 501 AND 4500
           AND form_ID > 204815
           --AND ROWNUM < 5000
           AND ROWNUM < 3
           --AND form_id IN (SELECT form_id FROM NR_DTS_BLOB)
           AND Form_Type_ID = 102;
     DTS c_dts%ROWTYPE;
BEGIN
     OPEN c_dts;
     LOOP
       FETCH c_dts INTO DTS;
       EXIT WHEN c_dts%NOTFOUND;
       DECLARE
         v_hold_blob BLOB;
         v_len NUMBER;
         v_raw_chunk RAW(10000);
         v_chr_string VARCHAR2(32767);
         -- v_chr_string CLOB;
         v_position NUMBER;
         c_chunk_len NUMBER := 1;
         Form_ID NUMBER;
       BEGIN
         SELECT form_content
           INTO v_hold_blob
           FROM NR_DTS_FORMTABLE
          WHERE Form_ID = DTS.Form_ID;
         v_len := DBMS_LOB.getlength(v_hold_blob);
         v_position := 1;
         WHILE (v_position <= LEAST(v_len, 32767)) LOOP
              v_raw_chunk := DBMS_LOB.SUBSTR(v_hold_blob, c_chunk_len, v_position);
              v_chr_string := v_chr_string || CHR(hex_to_decimal(RAWTOHEX(v_raw_chunk)));
              v_position := v_position + c_chunk_len;
         END LOOP;

             DBMS_OUTPUT.put_line(   'LengthOfField '
                     || INSTR((SUBSTR(v_chr_string, INSTR(v_chr_string, 'regionIdt') + LENGTH('regionIdt') + 2))
                          ,CHR(116)));
         DBMS_OUTPUT.put_line(   'Field '
                     || SUBSTR(v_chr_string
                           ,INSTR(v_chr_string, 'regionIdt') + LENGTH('regionIdt') + 2
                           ,INSTR((SUBSTR(v_chr_string
                                   ,INSTR(v_chr_string, 'regionIdt') + LENGTH('regionIdt') + 2))
                              ,CHR(116) || CHR(0))));
       --insert into table
               INSERT INTO NR_DTS_BLOBFIELDS_VARCHAR(formid
                                                    ,regionId)
                    SELECT DTS.Form_ID
                          , SUBSTR(v_chr_string
                                             ,INSTR(v_chr_string, 'regionIdt') + LENGTH('regionIdt') + 2
                                             ,INSTR((SUBSTR(v_chr_string
                                                           ,INSTR(v_chr_string, 'regionIdt') + LENGTH('regionIdt') + 2))
                                                   ,CHR(116) || CHR(0)))
                                regionId
                      FROM DUAL;

           END;

       --  DBMS_OUTPUT.put_line(DTS.Form_ID);
       END LOOP;
       CLOSE c_dts;
     END; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T04:48:05.797

对不起，这是一个愚蠢的问题。我所要做的就是创建另一个变量并将其声明为 VarChar(under4000)。然后将其设置为我要插入的字段的值。

我发布了答案以防万一有人需要，但可以一起删除问题。我不确定在这样的情况下该怎么做（当我发布然后稍后弄清楚时）。

谢谢你 ：）

# css - 下拉菜单中的第三层子列表不会在悬停时显示

> ID：14845813
> 
> 赞同：-1
> 
> 时间：2013-02-13T03:13:47.563
> 
> 标签：css, drop-down-menu, hover

这是我正在开发的网站：http: [//argumentinamerica.com/](http://argumentinamerica.com/)

菜单是这样的：

```
<div id="menu">
<ul id="menu">
    <li><a href="#"><span></span>Home</a></li>
    <li class='has-sub'><a href="#"><span></span>Units</a>
        <ul>
            <li class='has-sub'><a href="#">Unit 1</a></li>
                <ul>
                    <li><a href="#">Read About It</a></li>
                    <li><a href="#">Write About It</a></li>
                    <li><a href="#">Hear About It</a></li>
                    <li><a href="#">Speak About It</a></li>
                    <li><a href="#">Read About It</a></li>
                    <li><a href="#">Write About It</a></li>
                </ul>
            <li class='has-sub'><a href="#">Unit 2</a></li>
            <li class='has-sub'><a href="#">Unit 3</a></li>
            <li class='has-sub'><a href="#">Unit 4</a></li>
            <li class='has-sub'><a href="#">Unit 5</a></li>
        </ul>
    <li><a href="#"><span></span>Teacher Center</a></li>
    <li><a href="#"><span></span>About</a></li>
    <li><a href="#"><span></span>Give 1</a></li>
</ul>
</div> 
```

CSS是这样的：

```
#menu {
margin: 0; padding: 2px 0px 2px 0px;
list-style-type: none;
height: 2.4em;
}
#menu ul, #menu li, #menu span, #menu a {
    margin: 0;
    padding: 0;
    position: relative;
}
#menu li {
float: left;
width: 20%;
}
#menu a {
display: block;
margin: 1px;
height: 2.4em;
font-size: 10px;
line-height: 2.4em;
text-decoration: none;
text-transform: uppercase;
text-align: center;
background: #ffcc66;
color: #996600;
}
#menu span {
position: absolute; top: 8px; left: 8px;
width: 8px; height: 8px;
background: #ff9933;
}
#menu a:hover {
background: #cc3300;
color: #ffcc66;
}

#menu ul{
list-style-type: none;
}
#menu .has-sub {
    z-index: 1;
}
#menu .has-sub:hover > ul {
    display: list-item;
}
#menu .has-sub ul {
    display: none;
    position: absolute;
    left:0;
}
#menu .has-sub ul li {
    *margin-bottom: -1px;
    position: relative;
    width: 100%;
    height: 2.6em;
    line-height: 2.4em;
}
#menu .has-sub ul li a {
    background: #ff9944;
    font-size: 11px;
    color: ffcc66;
}
#menu .has-sub ul li:hover a {
    background: #ff6633;
    color: 993300;
}
#menu .has-sub {
    z-index: 1;
}
#menu .has-sub:hover > ul {
    display: list-item;
}
#menu .has-sub .has-sub ul {
    display: none;
    position: absolute;
    left:0;
}
#menu .has-sub .has-sub ul {
    display: none;
    position: absolute;
    left:0;
}
#menu .has-sub .has-sub ul li {
    *margin-bottom: -1px;
    position: relative;
    width: 100%;
    height: 2.6em;
    line-height: 2.4em;
}
#menu .has-sub .has-sub ul li a {
    background: #ff9944;
    font-size: 11px;
    color: ffcc66;
}
#menu .has-sub .has-sub:hover > ul {
    display: block;
}
#menu .has-sub .has-sub ul li:hover a {
    background: #ff6633;
    color: 993300;
} 
```

第三层在 Units: Unit 1 下。

我查看了[Displaying third tier submenus proper with css only menu](https://stackoverflow.com/questions/14331212/displaying-third-tier-submenus-properly-with-css-only-menu) and [https://stackoverflow.com/questions/13775342/adding-third-tier-to-drop-down-menu](https://stackoverflow.com/questions/13775342/adding-third-tier-to-drop-down-menu)和[DropDown Menu won't to display on hover](https://stackoverflow.com/questions/12800919/dropdown-menu-wont-to-display-on-hover) and a许多其他问题试图找出问题所在，但我仍然无法显示第三层。我真的很感激有人看一看并告诉我我错过了什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T03:51:09.127

首先，导致第三层出现的 CSS 不正确： `#menu .has-sub .has-sub:hover > ul { display: block; }` 在此代码中，“>”针对的`ul`是元素的直接子`.has-sub:hover`元素 - 在您的 HTML 中，第三层 ul 不是元素的子`li.has-sub`元素。您可以将 > 更改为 +，这意味着它的目标是紧跟在此代码中会导致第三层出现的`ul`元素之后的元素。`li.has-sub`下一个问题是第三层项目直接出现在第二层下方，因此需要将它们移动到某个地方 - 请参见示例代码。

[http://codepen.io/nztim/pen/GpbqK](http://codepen.io/nztim/pen/GpbqK)

现在，当您将鼠标悬停在第三层时，您需要让菜单保持可见，但我会把它留给您，祝您一切顺利:)

# jquery - 在 HTML 中，如何在滚动时修复一个固定表格列与另一表格列重叠？

> ID：14845816
> 
> 赞同：1
> 
> 时间：2013-02-13T03:13:55.407
> 
> 标签：jquery, html, css

使用 jQuery 添加时，我在 HTML 表格列的布局方面遇到问题。我的表格中有两列，左侧是菜单，右侧是更改其内容的 iframe。

我想要做的是修复菜单列的位置，即使使用 jQuery 垂直滚动内容列也是如此。我已经使用这个 jQuery 代码成功地做到了这一点，

```
jQuery(function($) {

    var nav    = $('#main_menu'),
        offset = nav.offset();

    $(window).scroll(function () {
      if($(window).scrollTop() > offset.top - 50) {
        nav.addClass('fixed');
      } else {
        nav.removeClass('fixed');
      }
    });

}); 
```

但是内容列与菜单列重叠。因此，内容列完全位于菜单列之下。我希望内容列也固定在菜单列旁边，但仍可滚动。

但是，这只发生在浏览器屏幕小于页面时。下面是 jsFiddle 代码。我正在查看此 Mozilla Firefox，但该页面也应与 IE 7 及更高版本兼容。

[http://jsfiddle.net/Aym72/7/](http://jsfiddle.net/Aym72/7/)

向下滚动结果，然后水平滚动到右侧。希望您能够帮助我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T03:51:30.257

这是非常糟糕的设计。

[http://jsfiddle.net/SFZwx/][1]

[1]： http: [//jsfiddle.net/SFZwx/](http://jsfiddle.net/SFZwx/)这确实有效。

应该`position: absolute;`代替`position: fixed;`.

并为每个卷轴更新图层的左侧和顶部属性。

# azure-mobile-services - WP8 中的 Windows Mobile 服务查询

> ID：14845819
> 
> 赞同：0
> 
> 时间：2013-02-13T03:14:04.373
> 
> 标签：azure-mobile-services

[http://www.windowsazure.com/en-us/develop/mobile/tutorials/get-started-with-data-dotnet/#update-app](http://www.windowsazure.com/en-us/develop/mobile/tutorials/get-started-with-data-dotnet/#update-app)

我是WP8的初学者，我按照上面的教程创建了一个可以插入/更新/删除/查询云端表格的移动服务。

我的问题是，在查询函数（RefreshToDoItem）中：

```
private void RefreshTodoItems()
{                       
    // This query filters out completed TodoItems. 
    items = todoTable
       .Where(todoItem => todoItem.Complete == false)
       .ToCollectionView();

ListItems.ItemsSource = items;            

} 
```

“items”是一个 MobileServiceCollectionView 对象，可用作数据源以在容器中显示。

但是我怎样才能检索这些结果之一 - 我的意思是我可以用于其他目的的特定“字段/列”的数据？

非常感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T05:55:11.340

您可以使用查询对象的其他方法，例如`ToListAsync`or `ToEnumerableAsync`，并从那里获取数据：

```
// This query filters out completed TodoItems. 
items = await todoTable
   .Where(todoItem => todoItem.Complete == false)
   .ToListAsync();
var firstItem = items.First();
var text = firstItem.Text; 
```

# drupal-7 - Nivo 滑块不工作

> ID：14845825
> 
> 赞同：1
> 
> 时间：2013-02-13T03:14:43.483
> 
> 标签：drupal-7

我浏览了许多关于如何安装 nivo 滑块的教程，但没有一个对我有用。图像显示在另一个之下。我不知道我哪里出错了。我想知道是否有人遇到过类似的问题。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T20:47:51.117

清除缓存，并将 jquery 更新为 1.8 工作。谢谢。

# javascript - 如何在 JavaScript 中“等待”而不阻塞（忙等待）？

> ID：14845826
> 
> 赞同：6
> 
> 时间：2013-02-13T03:14:54.463
> 
> 标签：javascript, thread-sleep

嗨，我是 Javascript 新手。我编写了一个脚本，它可以在页面上自动键入一个短语，暂停一会儿，清除 div，自动键入下一个短语等等。它应该不断循环。

我在使用我找到的 JavaScript wait() 解决方案时发现了一个问题。当每个短语都处于暂停期时，页面上的所有其他 JavaScript 都将被禁用。我研究并发现这是由于 JavaScript 中的阻塞问题，因为不存在多线程？鉴于我的情况，我无法找到一种解决方案，让该短语在被清除之前保留，同时也不会导致阻塞。

下面是我的代码。有什么建议吗？

```
var index = 0;
var phrases = new Array();

//add a new variable to the array to add new phrases
phrases[0] = "Type the first phrase.";
phrases[1] = "Type the second...";
phrases[2] = "Type the third...";

var split_chars = phrases[index].split("");

function type_phrases()
{  
    if(split_chars.length > 0) {
        document.getElementById('matrix_typer').innerHTML += split_chars.shift();
        }
        else {
        clearTimeout(loopTimer); 
        wait(10000);//add a delay before the next phrase is typed
        document.getElementById('matrix_typer').innerHTML = "&nbsp;";   
        index += 1;

        if(index >= phrases.length)
        { 
         index = 0;
        }   
        split_chars = phrases[index].split("");     
        }
    loopTimer = setTimeout('type_phrases()',400);

}

function wait(ms) {
    var start = +(new Date());
    while (new Date() - start < ms);
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-13T03:17:45.140

使用 setTimeout

```
setTimeout(function() {
  // do something 1000ms later here.

}, 1000); 
```

参考[JavaScript.setTimeout](https://stackoverflow.com/questions/10312963/javascript-settimeout)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-13T03:37:54.437

use two functions and add another timeout instead of your delay function

```
var phrases = new Array();

//add a new variable to the array to add new phrases
phrases[0] = "Type the first phrase.";
phrases[1] = "Type the second...";
phrases[2] = "Type the third...";

var index = 0;
var split_chars = phrases[index].split("");

function type_phrase()
{
    document.getElementById('matrix_typer').innerHTML = "&nbsp;"; 
    split_chars = phrases[index].split("");

    return type_char();
}

function type_char()
{
    if(split_chars.length > 0)
    {
        document.getElementById('matrix_typer').innerHTML += split_chars.shift();
    }
    else
    {
        clearTimeout(charloopTimer); 
        phraseloopTimer = setTimeout('type_phrases()',1000); //set a timeout instead of a delay
        index += 1;
        if(index >= matrix_phrases.length)
            index = 0;
    }
    charloopTimer = setTimeout('type_char()',400);
} 
```

# c# - Application.ThreadException 不起作用

> ID：14845830
> 
> 赞同：0
> 
> 时间：2013-02-13T03:15:15.837
> 
> 标签：c#, .net

```
 static class Program
   {
       [STAThread]
       static void Main()
       {
           /* From my understanding this should install the exception handler */
           Application.ThreadException += GetEventHandler();
           /* Since posting this question I have found that I need to add the 
              following line, but even with the following line in place the
              exceptions thrown are not caught.... */
           Application.SetUnhandledExceptionMode(UnhandledExceptionMode.CatchException);
           /* Some auto generated code here */
           Application.Run(new MyForm());
       }

       private static ThreadExceptionEventHandler GetEventHandler()
       {
           return new ThreadExceptionEventHandler(OnThreadException);
       }

       private static void OnThreadException(object sender, ThreadExceptionEventArgs e)
       {

           MessageBox.Show("Big error...");

       }
   } 
```

根据： http: [//msdn.microsoft.com/en-us/library/system.windows.forms.application.threadexception%28v=vs.71%29.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.application.threadexception%28v=vs.71%29.aspx) 这应该有效。但是，当在类内部引发异常时，`MyForm`它不会显示“大错误...”消息框，而是告诉我没有异常处理程序。任何建议，将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T03:26:25.893

你需要`UnhandleExceptionMode`设置`CatchException`它

```
 /* From my understanding this should install the exception handler */
       Application.ThreadException += GetEventHandler();
       Application.SetUnhandledExceptionMode(UnhandledExceptionMode.CatchException);
       /* Some auto generated code here */
       Application.Run(new MyForm()); 
```

* * *

`Application.ThreadException`只能捕获 UI 线程中引发的异常。在由于 Windows 通知而运行的代码中。或者在技术术语中，由消息循环触发的事件。大多数 Winforms 事件都属于这一类。

它不会*捕获*在任何非 UI 线程上引发的异常，例如以 开头的工作线程`Thread.Start()`或`ThreadPool.QueueUserWorkItem`委托的`BeginInvoke()`方法。其中任何未处理的异常都将终止应用程序。

# java - 当实现具有独特方法时，向下转换的替代方法

> ID：14845833
> 
> 赞同：-2
> 
> 时间：2013-02-13T03:15:32.267
> 
> 标签：java, casting, dynamic-cast, downcast

我有以下问题。我必须在 makeLeftTurnMethod 内部进行投射......这对我来说看起来很丑陋......有没有办法让我不必这样做？

```
public interface Car(){
   public void turnRight();
   public void turnLeft();
   public void go();
}
public class LuxuryCare implements Car(){
   public void systemCheckRightSideClear();
   public void systemCheckLeftSideClear();
}
public class UsedCar implements Car(){
   public void personCheckRightSideClear();
   public void personCheckLeftSideClear();
}

public interface Run{
  public void makeLeftTurn();
}
public class RunLuxuryCar implements Run{
  public void makeLeftTurn(Car car){
     car = (LuxuryCar)car;
     car.systemCheckLeftSideClear();
     car.turnLeft();
  }
}

public class RunUsedCar implements Run{
   public void makeLeftTurn(Car car){
       car = (UsedCar)car;
       car.personCheckLeftSideClear();
       car.turnLeft();
   }
}

public void tester(){
    //Could return either used or luxuy car 
    Run run = RunFactory.getInstance(UsedCar);
    Car car = CarFacory.getInstance(usedCar);
    run.makeLeftTurn(car);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T07:52:02.597

这是我对您的意图的最佳猜测，修复了语法错误并使用泛型来消除强制转换：

```
public static interface Car{
    public void turnRight();
    public void turnLeft();
    public void go();
 }

 public abstract class LuxuryCar implements Car{
    public void systemCheckRightSideClear(){}
    public void systemCheckLeftSideClear(){}
 }

 public abstract class UsedCar implements Car{
    public void personCheckRightSideClear(){};
    public void personCheckLeftSideClear(){};
 }

 public interface Run<T extends Car> {
   public void makeLeftTurn(T car);
 }

 public class RunLuxuryCar implements Run<LuxuryCar>{
   @Override
   public void makeLeftTurn(LuxuryCar car){
      car.systemCheckLeftSideClear();
      car.turnLeft();
   }
 }

 public class RunUsedCar implements Run<UsedCar>{
    @Override
    public void makeLeftTurn(UsedCar car){
        car.personCheckLeftSideClear();
        car.turnLeft();
    }
 } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T03:23:19.473

简单的答案是你的接口应该总是表达所有可以执行的操作。如果某些实现实现某些方法没有意义，那么您的抽象是错误的。在这种情况下，您的问题表明您的`Car`接口需要`isLuxuryCar()`和`isUsedCar()`方法，以便您可以分辨出区别，以及需要为每个方法调用的适当方法。

更进一步，这不是继承的真正用途。您所展示的内容是我希望在教科书或 Java 入门书中找到的内容，这是对继承用途的错误看法。继承和多态都是关于代码重用的，我发现发现继承关系的*频率*比他们*计划*的要多得多。当您发现您在相关对象中编写类似代码时，您会发现它们，此时您从它们中提取一个公共超类以将代码合并到一个位置。

# asp.net - Membership.ValidateUser 在 1 个项目中工作在另一个项目中失败

> ID：14845846
> 
> 赞同：0
> 
> 时间：2013-02-13T03:18:06.920
> 
> 标签：asp.net, asp.net-membership

我有一个简单的 CLI 应用程序来创建/更新/删除 SqlMembershipProvider 的用户。**它可以工作，我可以从 CLI 应用程序**中很好地验证。

但是，一旦我尝试从相关的 asp.net 应用程序执行此操作，它就会失败。我已经复制/粘贴了相关的 web.conf/app.config 部分，所以我不知道它为什么会失败。

```
<machineKey validationKey="C94FA3782AAF21E932CAA92DC2A0641951E3A76E50DD25B19C627BA01E259C6CBC7839A7803A59EF3BF855152369A6AB10CC259513BE7ACA4E842B962FD1D8A4"
                decryptionKey="2EA6D270AD94361ECFDCED5070D76FD67D9A147FEEBC8388FE9B73B450A04560"
                validation="SHA1"
                decryption="AES" />

    <membership defaultProvider="MembershipProvider">
      <providers>
        <add name="MembershipProvider" type="System.Web.Security.SqlMembershipProvider" 
             connectionStringName="ApplicationServices" 
             enablePasswordRetrieval="false" 
             enablePasswordReset="true" 
             requiresQuestionAndAnswer="false" 
             requiresUniqueEmail="false" 
             maxInvalidPasswordAttempts="5" 
             minRequiredPasswordLength="1" 
             minRequiredNonalphanumericCharacters="0" 
             passwordAttemptWindow="10" 
             passwordStrengthRegularExpression=""/>
      </providers>
    </membership> 
```

这在 web.config 和 app.config 中都有，有人可以解释为什么这将在 CLI 项目而不是 asp.net 项目中验证吗？

需要明确的是，这里是不是验证的代码

```
Membership.ValidateUser("fake", "fake") // actual test un/pwd combo 
```

我已经验证 un/pwd 实际上是正确的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T06:25:30.970

在不了解您的应用程序的任何其他信息的情况下，似乎最有可能的问题是配置文件中的 members/providers/add 节点中的 applicationName 属性。请参阅[http://msdn.microsoft.com/en-us/library/system.web.security.membership.applicationname.aspx](http://msdn.microsoft.com/en-us/library/system.web.security.membership.applicationname.aspx)

这些应用程序可能默认使用单独的应用程序名称/标识符。因此，当您尝试通过 Web 应用程序登录时，提供商只会看到授予 CLI 应用程序的访问权限。CLI 应用程序可能无法访问 Web 根目录或虚拟路径信息（没有 http 上下文）来创建默认名称，因此它可能默认为不同于您的 Web 应用程序应用程序名称的名称。

Look at this link for a good explanation: [http://weblogs.asp.net/scottgu/archive/2006/04/22/Always-set-the-_2200_applicationName_2200_-property-when-configuring-ASP.NET-2.0-Membership-and-other-Providers.aspx](http://weblogs.asp.net/scottgu/archive/2006/04/22/Always-set-the-_2200_applicationName_2200_-property-when-configuring-ASP.NET-2.0-Membership-and-other-Providers.aspx)

You can handle this in two ways:

*   Try setting the applicationName to the same string in both configurations.

OR

*   Ensure that there are two entries for the user "fake" in the aspnet_Membership table. One for the CLI app and one for the Web app. You should find the applicationID for each application listed in the aspnet_Application table.

Here is another reference where someone used the SqlMembershipProvider outside of an asp.net app: [http://mdrasel.wordpress.com/2011/02/01/asp-net-membership-provider-outside-of-web-application/](http://mdrasel.wordpress.com/2011/02/01/asp-net-membership-provider-outside-of-web-application/). Note the use of the applicationName attribute.

# c - 骰子游戏程序

> ID：14845851
> 
> 赞同：0
> 
> 时间：2013-02-13T03:18:23.433
> 
> 标签：c

我正在编写一个骰子程序，其中有 7 轮在每一轮中，用户可以根据需要滚动任意次数，总和相加，然后计算机滚动相同数量的骰子并将总和相加。该回合的获胜者由最高的骰子决定，谁赢得最多的回合就赢得了比赛。这是我到目前为止所拥有的，但我无法获得询问用户是否要再次滚动以正常工作的循环，因此将不胜感激任何帮助。

```
#include <stdio.h>
#include <stdlib.h>
#include <time.h>
/* Easy dice game
|
 |  The game consists of 7 rounds.
 |  In each round, the computer throws a die, 
 |  then the human throws a die.
 |  The winner of the round is the player who has the highest throw.
 |  In case of a tie, neither player wins.
 |  The winner of the game is the player who has won the most rounds.
 |
 */

char input[132];   /* user input buffer */

int throwDie()
{
static int initialized = 0;
int num;

if ( !initialized )
{
printf("Initializing Die!\n\n");
srand( time(NULL) );
initialized = 1;
}
num = rand()%6 + 1 ;
return num;
}

// Human turn

int humanTurn()
{
int toss;
toss = throwDie();
printf("Human throws a %d\n", toss );
return toss;

}

// Computer turn

int computerTurn()
{
int toss;
toss = throwDie();
printf("Computer throws a %d\n", toss );
return toss;
}

int main(int argc, char *argv[])
{
int round, humanWins=0, computerWins=0 ;
int humanToss, computerToss;
int i = 0;
const int numberOfRounds = 7;
char ta=0;
/* Play 7 Rounds */
for ( round = 1; round<=numberOfRounds; round++ )
{
 printf("\nRound %d\n\n", round );
printf("Player's Turn: (hit enter)");
gets( input ); /* pause for dramatic effect */
humanToss = humanTurn();
 printf("Do you wish to throw again? [Y or N]");
 scanf("%s", ta);

while (ta = 'Y')
{

     if(ta = 'Y')
     {
     humanToss = humanTurn();
     printf("Do you wish to throw again? [Y or N]");
     scanf("%s", ta);
     }
     else
     {
       i++;
     }
}

printf("Computer's Turn: (hit enter)");

   gets( input ); /* pause for dramatic effect */
   computerToss = computerTurn();

  /* Determine Winner of the Round */
  if ( humanToss > computerToss )
  {
  humanWins++;
  printf("\tHuman wins the round.    human: %3d. computer: %3d\n",
    humanWins, computerWins );
  }
  else if ( computerToss > humanToss )
  {
  computerWins++;
  printf("\tComputer wins the round. human:%3d. computer: %3d\n",
    humanWins, computerWins );
  }
  else if ( computerToss == humanToss)
  {  
  printf("\tTie.                     human:%3d. computer: %3d\n",
    humanWins, computerWins );
  }
  }

   /* Determine Winner to the Game */
  if ( humanWins > computerWins )
  printf("\n\nWINNER!! The human wins the game!\n");
  else if ( computerWins < humanWins )
  printf("\n\nThe computer wins the game!\n");
  else
  printf("\n\nTie Game!\n");

  printf("\n");
  system("pause");
  return 0;
  } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-13T03:20:27.377

```
while (ta = 'Y') 
```

应该`while (ta == 'Y')`

所以你的 if 语句应该是 == 不是 =

# javascript - HTML5拖放不起作用

> ID：14845852
> 
> 赞同：1
> 
> 时间：2013-02-13T03:18:43.370
> 
> 标签：javascript, html, drag-and-drop

我正在使用 HTML5 拖放脚本，但它不起作用。当我在 safari 中使用错误控制台时，它说：

```
NOT_FOUND_ERR: DOM Exception 8: An attempt was made to reference a
Node in a context where it does not exist. 
```

我不知道那是什么意思。这是我的例子：[http](http://thomaswd.com/maze) ://thomaswd.com/maze 。尝试将鼠标拖动到指示的方块。它应该让阿尔杰农留在那个盒子里。谢谢！

另外，是否可以阻止用户将鼠标拖过墙壁？谢谢！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T03:23:04.223

**墙壁碰撞**
[http://www.html5rocks.com/en/tutorials/canvas/notearsgame/](http://www.html5rocks.com/en/tutorials/canvas/notearsgame/)

就鼠标和错误而言，我也看不到。但是上面列出的错误是 obvs。您的源/脚本有问题。我看了一下，但是那里什么都没有，您在发布示例之前是否删除了 JS？\

编辑

ev.target.appendChild(document.getElementById(data)); 这条线。“错误：尝试在不存在的上下文中引用节点。在 HTMLDivElement.ondrop (thomaswd.com/Maze/:50:225) 的 drop (thomaswd.com/Maze/:18:15) "

doms (getelementbyid) 正在寻找 ID“鼠标”但找不到它。设置图像 ID = "鼠标"

我使用了 chromes 开发工具并在本地编辑了这一行，它工作正常。并且鼠标没有问题地掉落。

```
<img src="rat.png" id="mouse" width="60px" ondragstart="drag(event)" style="cursor:move;" draggable="true"> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T05:56:01.640

发生这种情况是因为您没有设置鼠标的 id。将此添加到您的鼠标图像

```
id="mouse" 
```

其次，对于每个 TD，您需要通过设置这些属性使其可放置。

```
ondrop="drop(event)" ondragover="allowDrop(event)" 
```

# iphone - 如何使操作表按钮转到另一个页面？

> ID：14845854
> 
> 赞同：-1
> 
> 时间：2013-02-13T03:18:47.313
> 
> 标签：iphone, objective-c, storyboard, uiactionsheet

```
-(void)actionSheet:(UIActionSheet *)actionSheet clickedButtonAtIndex:(NSInteger)buttonIndex {
    if (buttonIndex == 0) {
        self.label.text = @"Destructive Button Clicked";
    } else if (buttonIndex == 1) {
        self.label.text = @"Other Button 1 Clicked";
    } else if (buttonIndex == 2) {
        self.label.text = @"Other Button 2 Clicked";
    } else if (buttonIndex == 3) {
        self.label.text = @"Cancel Button Clicked";
    }

    /**
     * OR use the following switch statement
     * Suggested by Colin =)
     */

    /*
    switch (buttonIndex) {
        case 0:
            self.label.text = @"Destructive Button Clicked";
            break;
        case 1:
            self.label.text = @"Other Button 1 Clicked";            
            break;
        case 2:
            //???????????
            self.label.text = @"Other Button 2 Clicked";   <<<<<< WHAT DO I PUT HERE???***
            //???????????
            break;
        case 3:
            self.label.text = @"Cancel Button Clicked";
            break;
     }
     */
} 
```

我在上面写着什么的地方放了什么`self.label`？我需要让其中一个按钮转到另一个页面。换句话说，如果我说“是”、“我想继续”并单击“继续”，它将带我进入另一个故事板。

***编辑：***看看上面写着“我在这里放什么”的部分，那是我想知道要输入什么代码的地方，这样我就可以做我想做的了？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T04:21:13.770

您只需要实例化视图控制器并使用导航控制器转到该视图控制器

```
-(void)actionSheet:(UIActionSheet *)actionSheet clickedButtonAtIndex:(NSInteger)buttonIndex
{
    if(buttonIndex == 0)
    {
        NewViewController *newview =  [self.storyboard instantiateViewControllerWithIdentifier:@"NewView"];
        [self.navigationController pushViewController:newview animated:YES];
    }
    else if(buttonIndex==1)
    {
         NewViewController1 *newview1 =  [self.storyboard instantiateViewControllerWithIdentifier:@"NewView1"];
        [self.navigationController pushViewController:newview1 animated:YES];
    }
} 
```

# silverlight - Silverlight 中的 ViewModel 拦截

> ID：14845856
> 
> 赞同：1
> 
> 时间：2013-02-13T03:18:59.557
> 
> 标签：silverlight, mvvm, unity-container, aop

我在一个应用程序中有很多 ViewModel，其中大多数在视图的 XAML 中被声明和引用为静态资源。现在我需要实现一些 ViewModel 调用的综合日志记录，并希望使用某种形式的拦截，例如使用 Unity；但似乎我需要替换，即在 Unity 中包装或继承（“实例”或“类型”），并且基本上在代码中命令式/动态地创建代理，这似乎排除了在 XAML 中声明 ViewModel 类。那么有没有使用拦截和保持声明性 ViewModel 的解决方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T07:48:22.383

如果您在 XAML 中声明您的视图模型，Unity 将无法控制对象实例化。这意味着容器没有机会用代理/拦截器包装你的虚拟机。

[Caliburn Micro](http://caliburnmicro.codeplex.com/)提供了自动连接视图和虚拟机的 View/ViewModelLocator 的概念。您可以将它与 Unity 结合使用来创建您的虚拟机。这应该使您能够拦截和跟踪调用。

# java - grails控制器的Java时间转换

> ID：14845864
> 
> 赞同：0
> 
> 时间：2013-02-13T03:19:24.873
> 
> 标签：java, date, grails, controller, type-conversion

我正在尝试显示 MSSQL 中的日期时间列。但是，当我显示数据库中的日期时，它显示为这样。

![在此处输入图像描述](../Images/ce9dfc2ded8066898c948d22206dce32.png)

时间后面有一个 .0。无论如何要删除.0？顺便说一句，我正在使用grails。这是我的代码，希望你们能在这里帮忙。:)

```
 def result = sql.rows("select * from user")
        def example = sql.rows(query)
        [result:result] 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T06:28:26.290

在您的 gsp 中显示您的日期时，您可以将其格式化为：

```
<g:formatDate format="yyyy-MM-dd HH:mm:ss" date="${result?.date}"/> 
```

[您可以在此处](http://grails.org/doc/2.2.x/ref/Tags/formatDate.html)找到 formatDate 文档

# jsf - 不使用 JSF/XPages 中的覆盖 ID 生成：？

> ID：14845870
> 
> 赞同：2
> 
> 时间：2013-02-13T03:20:32.480
> 
> 标签：jsf, xpages

当像这样在 XPages 中定义一个元素时：

```
 <xp:div id="chartSurface"></xp:div> 
```

生成的 HTML 如下所示：

```
 <div id="view:_id1:_id4:chartSurface"></div> 
```

这是“必要的”，因为 ID 必须是唯一的，并且 JSF/XPages 元素可以重复多次。虽然我可以使用 获取客户端 ID `#{id:chartsurface}`，但这使得寻址元素变得不必要地困难，因为“：”与 CSS 伪选择器冲突并且[d3js](https://github.com/mbostock/d3/)等库失败（尚未使用 jQuery 对其进行测试，dojo.byId 似乎可以工作）。有没有办法告诉 JSF/XPages 使用不同的分隔符（例如 NONE 或 %），所以结果如下所示：

```
 <div id="view_id1_id4chartSurface"></div>
    <div id="view%_id1%_id4%chartSurface"></div> 
```

额外的问题：哪些分隔符可以保存使用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T12:27:34.403

据我所知，没有办法通过使用配置来更改分隔符，因为它被硬编码到 xpages 源中（更具体地讲到 UIComponentBase 中）。

理论上您可以尝试使用 Renderer 替换 clientId。有一个公共方法 convertClientId(FacesContext context, String clientId) 可以被覆盖，例如可以用其他字符序列替换所有 ':'。

不幸的是，我不确定在此更改后 findComponent 功能是否会正常工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T13:51:35.463

正如@W_K 指出的那样，没有简单的方法。总之，有4种策略来处理这种情况：

1.  耸耸肩并移动一个
2.  覆盖渲染器
3.  修复客户端的clientid
4.  修复您的查询

1和2在旁观者的眼中。对于#3，我目前使用 2 个函数，一个 SSJS，一个 CSJS：

```
 function getSimpleClientID(oldID) {
   /* Server side function */
        // Removes the : from a clientID, so it can be used easily in CSS3 selectors
        return oldID.replace(/:/g,"");
   }

   function fixClientIds() {
   /* Client side function */
   // Update all ID function with simplified IDs    
      dojo.query("*[id]:not([type='hidden'])").forEach(function(node, index, arr){
         if (node.className != "xspForm") {
             node.id = getSimpleClientID(node.id);
         }
      });   
    } 
```

在我的 SSJS 中，`getClientId("myControl")`我没有`getSimpleClientID(getClientId("myControl"))`打电话，而是在`XSP.addOnLoad()`.

感谢 Luiggi 指出的链接，第四个选项是调整您可能使用`escapeClientID(getClientId("myControl"))`此函数传递的查询：

```
 function escapeClientID(oldID) {
   /* Server side function */
        // Removes the : from a clientID, so it can be used easily in CSS3 selectors
        return oldID.replace(/:/g,"\\:");
   } 
```

（我没有正确测试过那个）

# php - 将选定的下拉值从一个选择框复制到另一个

> ID：14845872
> 
> 赞同：3
> 
> 时间：2013-02-13T03:20:51.003
> 
> 标签：php, jquery, forms

简化后，我有一个表单，可以根据 mysql 查询生成选择框。

```
$i = 0;
while($res= mysql_fetch_assoc($sql2))
echo "  <div class='span1'>";
echo "      <input name='orderNo[$i]' type='text' id='orderNo[$i]' value='$orderNo' class='input-small' onclick='populateorderNo()' />";
echo "  </div>";

echo "  <div class='span1'>";
echo "      <select name='methodOfPay[$i]' id='methodOfPay[$i]' class='input-small' >";
echo "      <option value=''>&nbsp;</option>";
echo "      <option value='On Bill'>On Bill</option>";
echo "      <option value='Customer C.C'>Customer C.C</option>";
echo "      <option value='Company G.C'>Company G.C</option>";
echo "      </select>";
echo "  </div>";
++$i;
} 
```

我要做的是将methodOFPay [0] 上的选定选项复制到后续的methodOfPay [] 中。我能够使用 orderNo 的 onclick 函数来做到这一点，但我不知道如何将相同的理论应用于选择框。这是我的简单文本框副本的 js 代码。目前，它总是将第一行复制到后续行。

```
var orderno = 0;
function populateorderNo(){
var copyorderNo = document.getElementById('orderNo[0]');
document.getElementById('orderNo[' + orderno + ']').value = copyorderNo.value;
orderno += 1; 
```

}

任何帮助，将不胜感激。非常感谢，作为一个新手，我从这个网站和我收到的所有答案中学到了很多东西。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T03:39:01.183

如果您使用的是直接 JavaScript，则可以使用[`onchange`](https://developer.mozilla.org/en-US/docs/DOM/element.onchange). 在 jQuery 中，您可以使用[`.change()`](http://api.jquery.com/change/).

**直接的 JavaScript 方法**

PHP

```
echo "      <select name='methodOfPay[$i]' id='methodOfPay[$i]' class='input-small' onchange='myOnChangeFunction()' >";
 ...
echo "      </select>"; 
```

JS

```
function myOnChangeFunction() {
    // Get value and set other selects
} 
```

**jQuery 方法 ( [jsfiddle](http://jsfiddle.net/cbL6n/1/) )**

JS

```
$('select[id^="methodOfPay"]').change(function() {
    var value = $(this).val();
    $('select[id^="methodOfPay"]').not($(this)).val(value);
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T04:02:49.393

为了便于演示，我稍微更改了您的代码，但理论仍然相同。

主要需要注意的是在javascript中使用**count($orderNo)**

如 Ruben Infante 的示例所示，这将更适用于 jQuery 和正则表达式

```
<?php

for ($i = 0; $i < 10; ++$i) {
    $orderNo[$i] = $i;
}

?>

<html>
    <head>
        <title>Hello</title>
        <script type="text/javascript">
            function populateorderNo() {
                var copyorderNo = document.getElementById('orderNo[0]');
                for (var i = 0; i < <?php echo count($orderNo); ?>; i++) {
                    document.getElementById("orderNo["+i+"]").value = copyorderNo.value;
                }
            }

            function changeSelectBox() {
                var selectBox = document.getElementById('methodOfPay[0]');
                for (var i = 0; i < <?php echo count($orderNo); ?>; i++) {
                    document.getElementById('methodOfPay['+i+']').value = selectBox.value;
                }
            }
        </script>
    </head>
    <body>
        Hello
        <?php foreach ($orderNo as $r): ?>
            <div class='span1'>
            <input name='orderNo[<?php echo $r;?>]' type='text' id='orderNo[<?php echo $r;?>]' value='<?php echo $r;?>' class='input-small' onchange='populateorderNo();' />
            </div>

            <div class='span1'>
            <select name='methodOfPay[<?php echo $r; ?>]' id='methodOfPay[<?php echo $r;?>]' class='input-small' onchange='changeSelectBox();' >
            <option value=''>&nbsp;</option>
            <option value='On Bill'>On Bill</option>
            <option value='Customer C.C'>Customer C.C</option>
            <option value='Company G.C'>Company G.C</option>
            </select>
            </div>
        <?php endforeach; ?>
    </body>
</html> 
```

# parallel-processing - 有人可以帮我理解矢量化吗？

> ID：14845876
> 
> 赞同：0
> 
> 时间：2013-02-13T03:21:29.523
> 
> 标签：parallel-processing, vectorization

我真的很想把头放在矢量化上，但我似乎无法理解它。我不知道我是否不了解如何进行矢量化，或者我是否不了解正在使用的数组表示法。我正在与学校合作的一个循环示例如下：

```
for (M=0; M< number_of_iterations/2; M++){
   for (i=2; i<n-1; i++)  
      for (j=1; j<n-1; j++)  
          y[i][j]= (x[i-1][j]+x[i][j-1]+x[i+1][j]+x[i][j+1]+x[i-2][j])/5.; 
```

我不确定我是否完全理解依赖关系的全部内容 - 有没有办法按原样使用数组表示法对其进行矢量化，或者我是否需要以某种方式对其进行调整以解决整个依赖关系？

提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T03:24:47.887

假设`x`和`y`是完全不重叠的不同数组，则不存在依赖关系。`x`永远不会改变，所有计算的结果都只依赖于`x`. 没有计算取决于先前计算的结果。

该循环中使用的计算和分配可以以任何顺序和任何并发发生。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T03:27:30.060

首先，我建议您使用刹车 {} 来组织您的代码行并更好地理解它。其次，看看这个页面：[http](http://www.javatutorialhub.com/java-arrays.html) ://www.javatutorialhub.com/java-arrays.html Thirg，总是从简单的例子开始，以免混淆。

# parsing - 使用最新技术从站点抓取数据的提示

> ID：14845881
> 
> 赞同：0
> 
> 时间：2013-02-13T03:21:51.977
> 
> 标签：parsing, web-scraping

我正在尝试从使用 ajax 和会话以及 POST 变量进行数据导航和显示的 asp、jsp 站点中抓取数据。我已经阅读了各种文章和 SO 进行数据抓取，但没有太大帮助我解析了一些带有修改标头的网站，但大多数网站都显示了我的自定义标头的标头重定向。什么是从启用了 javascript 的站点解析数据的正确方法，并且在 asp 中的站点具有 viewstate 变量。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-18T03:17:57.633

如果你想学习网络爬虫，我建议你读那本书

![在此处输入图像描述](../Images/e561e093698c874b433581c2fa05b1db.png)

[Webbots、Spiders 和 Screen Scraper：使用 PHP/CURL 开发 Internet 代理的指南](https://rads.stackoverflow.com/amzn/click/com/1593273975)

这确实是唯一一本专门为 php 开发人员编写的网络爬虫的书，但我认为这本书所教的基础知识将帮助任何开发人员了解网络机器人的工作原理

我还通过电子邮件向作者发送了一些问题，他在几分钟内回复了我真的我强烈建议任何想了解网络抓取的人阅读这本书

# css - 带有多个拇指的 CSS 图像翻转 onclick

> ID：14845882
> 
> 赞同：0
> 
> 时间：2013-02-13T03:22:08.447
> 
> 标签：css, image, thumbnails, rollover

我正在尝试在电子商务网站上实现一种非常常见的效果，在该网站上，您拥有产品的一张主要图片，旁边还有一堆拇指。当您悬停或单击一个时，它会更改主图片中的图像。但是，我找不到关于 SO 或其他地方的教程、问题来说明如何做到这一点。

我有以下代码来显示一个拇指和一张图片。但是，我不知道如何将其扩展到多个拇指。

HTML：

```
<tr>
    <td colspan=2>
        <p align="center">  <a class="rollover" href="detail.php">
            <img src="http://womeninbiznetwork.com/wp-content/uploads/2011/07/logo-google.thumbnail.gif" name="pic" border="0"/>
            <span><img src="http://www.google.com/intl/en_ALL/images/logos/images_logo_lg.gif"/></span>
</a> 
        </p>
    </td>
</tr>
<tr>
    <td>Here is text</td>
</tr> 
```

CSS：

```
a.rollover {
    display: block;
    position: relative;
}
a.rollover span {
    position: absolute;
    left: -10000px;
}
a.rollover:hover span {
    position: absolute;
    left: 200px;
} 
```

感谢您的任何建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T03:32:13.730

您需要使用 javascript 或 jQuery 来执行此操作。它在下面提到的教程中使用 coda slider jQuery 插件很容易解释。

[http://css-tricks.com/creating-a-slick-auto-playing-featured-content-slider/](http://css-tricks.com/creating-a-slick-auto-playing-featured-content-slider/)

和这里的演示，

[http://css-tricks.com/creating-a-slick-auto-playing-featured-content-slider/](http://css-tricks.com/creating-a-slick-auto-playing-featured-content-slider/)

这是另一个很好的教程， [http://webdeveloperplus.com/jquery/featured-content-slider-using-jquery-ui/](http://webdeveloperplus.com/jquery/featured-content-slider-using-jquery-ui/)

这背后的基本逻辑是使用javascript捕获对较小缩略图图像的点击并更改较大图像的img标签的src属性，尽管可以通过多种方式完成！:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T03:34:02.237

我建议你使用 jQuery addClass 函数。您基本上需要做的是将翻转 CSS 类应用于悬停元素，然后在鼠标离开所述元素时将其删除，如下所示：

```
$(img).hover(function(){
$(this).addClass(rollover);
}, function(){
$(this).removeClass(rollover);
}); 
```

# java - Java 中的屏幕大小

> ID：14845886
> 
> 赞同：0
> 
> 时间：2013-02-13T03:22:45.983
> 
> 标签：java, swing, awt, screen-size, game-development

您好，我正在用 Java 制作游戏，我使用 DefaultToolkit 获得了 screenSize，但问题是如果它是 FULLSCREEN 则检测屏幕的大小。如何获得游戏屏幕（不是全屏）占用的区域的屏幕大小。更准确地说，我的精灵正在移动到底部屏幕的边缘之外，因为系统工具栏为其添加了额外的“填充”。如何获得游戏屏幕占用的区域大小？非常感谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T03:29:56.877

我认为 Screen Bounds 是您正在寻找的：

```
import java.awt.*;
import javax.swing.*;

public class FrameInfo
{
    public static void main(String[] args)
    {
        GraphicsEnvironment env = GraphicsEnvironment.getLocalGraphicsEnvironment();
        Rectangle bounds = env.getMaximumWindowBounds();
        System.out.println("Screen Bounds: " + bounds );

        GraphicsDevice screen = env.getDefaultScreenDevice();
        GraphicsConfiguration config = screen.getDefaultConfiguration();
        System.out.println("Screen Size  : " + config.getBounds());
        System.out.println(Toolkit.getDefaultToolkit().getScreenSize());

        JFrame frame = new JFrame("Frame Info");
        frame.setSize(200, 200);
        frame.setVisible( true );

        System.out.println("Frame Size   : " + frame.getSize() );
        System.out.println("Frame Insets : " + frame.getInsets() );
        System.out.println("Content Size : " + frame.getContentPane().getSize() );
     }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T03:28:19.547

您可以使用 Insets 获取任务栏的大小和其他内容。这是一个获取不包括任务栏/其他的屏幕大小的示例。

```
// Screen size
Dimension screen = Toolkit.getDefaultToolkit().getScreenSize();

// Screen insets
Insets insets = Toolkit.getDefaultToolkit().getScreenInsets(getGraphicsConfiguration());

// Get the real width/height
int width = screen.getWidth() - insets.left - insets.right;
int height = screen.getHeight() - insets.top - insets.bottom; 
```

# perl - 即使脚本退出也永久保存 Perl 哈希

> ID：14845889
> 
> 赞同：1
> 
> 时间：2013-02-13T03:22:53.407
> 
> 标签：perl, file, hash

我想创建一个哈希表，即使脚本退出，它也可以永久保存密钥和值。那可能吗 ？

例如：

我第一次运行这个脚本，它接受 $key 和 $value 变量并将其存储到哈希表中。

```
$key = 'perl';
$value = '123';
$hash{$key} = $value; 
```

第二次运行相同的脚本，但我更改了值

```
$key = 'ruby';
$value = '456';
$hash{$key} = $value; 
```

如果我打印出哈希表，我将得到值为 123 的 perl 和值为 456 的 ruby​​。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T03:32:51.920

我没有很多使用它的经验，但你可以使用[`Storable`](https://metacpan.org/module/Storable)：

```
use strict;
use warnings;
use Storable;
store \%hash, 'file'; 
```

或者，您可以使用数据库或键值存储（MySQL、PostgreSQL、MongoDB、Couchbase、Riak 等）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-13T07:32:47.720

虽然我同意 Storable 有效，但您也可以使用 Data::Dumper ，它可以提供人类可读/可修改的输出。您还可以将数据读回到 Perl 数据结构中。

输出

```
print $FH Data::Dumper->new([$hash_data], ['output123'])->Purity(1)->Dump; 
```

输入

```
my $data_structure = do { local $/; <$FH> };
eval $data_structure; 
```

一个 $data_structure 是 eval'd 你将有一个 hashref @ $output123。$output 由最初进行转储时设置的参数命名。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-13T03:30:50.807

将其写入文件。

（到达 30char min post len 的额外字符）

# android - 如何实现像这样的图像布局的Android UI？关于 android:clipChildren

> ID：14845891
> 
> 赞同：5
> 
> 时间：2013-02-13T03:22:59.577
> 
> 标签：android, android-layout, android-ui, android-xml

我想要实现的是这样的布局： ![在此处输入图像描述](../Images/c7f3b13e1f1e173619fe57f2557e5196.png)

我曾尝试使用此代码来实现该图像，但不幸的是，我失败了。这是我的代码片段：

```
 <RelativeLayout
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_marginBottom="10dp"
        android:clipChildren="false"
        >

        <RelativeLayout
            android:id="@+id/text_area_third"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:background="@drawable/round_corner_background"
            android:focusable="false"
            android:paddingBottom="5dp"
            android:paddingLeft="5dp"
            android:paddingRight="5dp"
            android:paddingTop="5dp" >

            <TextView
                android:id="@+id/text_download_purch_third"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_alignParentLeft="true"
                android:layout_alignRight="@+id/acron_icon"
                android:layout_marginLeft="5dp"
                android:layout_marginRight="30dp"
                android:layout_marginTop="10dp"
                android:gravity="left"
                android:maxLines="2"
                android:text="1asdasdasdasdadsasdasdadasdasdasdasdasdasdasdasd"
                android:textColor="@color/black"
                android:textSize="10sp"
                android:textStyle="normal" />

            <ImageView
                android:id="@+id/acron_icon"
                android:layout_width="20dp"
                android:layout_height="20dp"
                android:layout_alignParentRight="true"
                android:layout_centerVertical="true"
                android:layout_margin="5dp"
                android:layout_marginTop="10dp"
                android:background="@drawable/acron"
                android:scaleType="fitCenter" />
        </RelativeLayout>

         <LinearLayout
             android:layout_alignTop="@+id/text_area_third"
             android:layout_alignLeft="@+id/text_area_third"
             android:layout_width="wrap_content"
             android:layout_height="wrap_content"
             android:background="@color/orange"
             android:layout_marginLeft="-10dp"
             android:layout_marginTop="-10dp"
             android:padding="3dp" >

             <TextView
                 android:layout_width="wrap_content"
                 android:layout_height="wrap_content"
                 android:text="GET"
                 android:textColor="@color/white"
                 android:textSize="13sp"
                 android:textStyle="bold" />
         </LinearLayout>

    </RelativeLayout> 
```

![在此处输入图像描述](../Images/4889313bc68da63a12b19f73ede23e34.png)

您可以看到，“GET”标签（带有橙色背景）被剪裁通过父绑定。我已经设置了`android:clipChildren="false"`，但它仍然被剪裁了。有人可以帮助我吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-10-08T20:08:48.573

一个单一的 RelativeLayout 是要走的路。记住让事情尽可能简单。在 RelativeLayout 中，最后声明的元素呈现在其他元素之上。下面的 XML 应该（有点）满足您的需求，只需根据需要调整图像、边距和大小。

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="180dp"
    android:layout_height="60dp"
    android:background="#DDD" >

    <TextView
        android:id="@+id/text_download_purch_third"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:layout_marginBottom="3dp"
        android:layout_marginLeft="12dp"
        android:layout_marginRight="8dp"
        android:layout_marginTop="10dp"
        android:background="@drawable/round_corner_background"
        android:maxLines="2"
        android:paddingLeft="4dp"
        android:paddingRight="25dp"
        android:paddingTop="16dp"
        android:text="1asdasdasdasdadsasdasdadasdasdasdasdasdasdasdasd"
        android:textColor="@color/black"
        android:textSize="10sp"
        android:textStyle="normal" />

    <ImageView
        android:id="@+id/acron_icon"
        android:layout_width="20dp"
        android:layout_height="20dp"
        android:layout_alignParentRight="true"
        android:layout_centerVertical="true"
        android:layout_margin="5dp"
        android:layout_marginTop="10dp"
        android:background="@drawable/acron"
        android:scaleType="fitCenter" />

    <TextView
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_marginLeft="8dp"
        android:layout_marginTop="4dp"
        android:background="#FFA0A0"
        android:padding="2dp"
        android:text="GET!"
        android:textColor="@color/white"
        android:textSize="13sp"
        android:textStyle="bold" />

</RelativeLayout> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T03:32:11.923

您是否考虑过使用 FrameLayout？这使得图像的覆盖更容易......（使一个布局/视图出现在另一个之上）......这是一个很好的教程......

[http://mobile.tutsplus.com/tutorials/android/android-sdk_frame-layout/](http://mobile.tutsplus.com/tutorials/android/android-sdk_frame-layout/)

# javascript - 在 Internet Explorer 中输入文件长度

> ID：14845895
> 
> 赞同：2
> 
> 时间：2013-02-13T03:23:30.460
> 
> 标签：javascript, jquery, html, internet-explorer

我想获取为输入文件选择的文件数。在 HTML 中，我有：

```
<input id="photoFile" type="file" name="pictures" multiple="multiple"/> 
```

我使用 JQuery，我有：

```
$('#photoFile').get(0).files.length; 
```

但我发现这不是 Internet Explorer 的解决方案。它适用于 Chrome、Firefox、Safari 和 Opera。如何使其在 IE 8+ 中也能正常工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T05:29:47.827

even IE9 does not support HTML5 File API and therefore it returns undefined value for files property.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-03T08:46:11.823

由于[IE9 不支持](http://caniuse.com/#search=file)File API ，你可以在 Github 上试试这个[Polyfill 。](https://github.com/moxiecode/moxie)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-13T03:37:01.483

它是[File API](http://caniuse.com/fileapi)，IE 8 和 IE 9 不支持。

# python - Pygame无法打开声音文件

> ID：14845896
> 
> 赞同：10
> 
> 时间：2013-02-13T03:23:33.407
> 
> 标签：python, audio, pygame

```
import pygame, time
from pygame.locals import *

soundObj = pygame.mixer.Sound('beeps.wav')
soundObj.play()

time.sleep(1) # wait and let the sound play for 1 second
soundObj.stop() 
```

它抛出这个错误：

```
Traceback (most recent call last):
  File "C:/Users/Jauhar/Desktop/Python/sounds.py", line 4, in <module>
    soundObj = pygame.mixer.Sound('beeps.wav')
pygame.error: Unable to open file 'beeps.wav' 
```

beeps.wav 文件保存在与代码所在的 python 文件相同的目录中。

我不明白为什么它不起作用！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2017-02-01T21:22:41.120

Pygame（至少 2.9 版）不支持 32 位浮点 WAV。将其重新编码为带符号的 16 位 WAV（例如使用 Audacity）。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-02-13T08:12:05.873

除非您初始化您使用的模块或全部 pygame，否则您不能使用 pygames 的库。

```
 pygame.mixer.pre_init(44100, 16, 2, 4096) #frequency, size, channels, buffersize
    pygame.init() #turn all of pygame on. 
```

在你在 pygame 中做任何事情之前先做这些。我推荐它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-13T03:36:57.613

尝试记录此信息，您可能会发现问题。

```
import os
os.getcwd() # Log this line.
soundObj = pygame.mixer.Sound('beeps.wav') 
```

这应该告诉您在尝试访问您的声音文件时您的应用程序正在查找的目录。您可能会发现它位于游戏目录的底部。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-01-08T15:22:15.207

这对我有用：

```
pygame.mixer.init() 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-03-31T13:09:43.353

刚遇到同样的问题，从 wav 文件中删除 ID 标签有效。所以可能值得检查文件是否有一个！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-02-23T18:24:43.220

在 pygame.init() 之后有声音文件。我遇到了这个问题，但是在放置声音文件之后它对我来说效果很好。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-01-10T23:27:38.833

遇到类似问题，我发现 .wav 文件的大小与问题有关。使 .wav 文件更小使其能够在不对问题进行重大修改的情况下工作

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-12-17T11:44:46.327

如果我在播放声音之前创建一个显示表面，同样的程序也适用于我。

```
 #! Python 3
'''
Making games with python chapter 2 program 5
'''
import pygame, sys, time
from pygame.locals import*

pygame.init()
DISPLAYSURF = pygame.display.set_mode((400, 300))
pygame.display.set_caption("Sound!!")

soundObj = pygame.mixer.Sound('badswap.wav')
soundObj.play()
time.sleep(1) #wait and let the sound play for X second
soundObj.stop()

while True:
        for event in pygame.event.get():
            if event.type == QUIT:
                pygame.quit()
                sys.exit()
        pygame.display.update() 
```

# haskell - 在haskell中理解类型的问题

> ID：14845898
> 
> 赞同：0
> 
> 时间：2013-02-13T03:23:53.130
> 
> 标签：haskell, types

嘿伙计们，所以我想获取一个单词列表并返回一个与其类似的列表，但每次出现连续单词时都会进行以下替换。

一个例子是`you`把它变成`u`

我得到以下内容：

```
hep :: [Word] -> [Word]
type Word = String 
```

现在给我的问题是我正在尝试使用大小写表达式，这样我就不必重复代码但我收到以下错误

```
Couldn't match expected type `Char' with actual type `[Char]'
In the pattern: "You"
In a case alternative: "You" -> "u" : hep xs
In the expression: case a of { "You" -> "u" : hep xs } 
```

从以下代码

```
hep [] = []
hep [a:xs] = case a of 
    "You" -> "u":hep xs 
```

有人告诉我问题是什么吗？

编辑：

我添加了以下代码

```
hep [] = [[]]
hep (a:xs) = case a of 
    "you" -> "u":hep xs
    "are" -> "r":hep xs
    "your" -> "ur":hep xs
    "boyfriend" -> "bf":hep xs
    "girlfriend" -> "gf":hep xs
    "great" -> "gr8":hep xs
    a -> a:hep xs 
```

现在我如何能够添加一个案例，以便如果列表中包含 2 或 3 个特定单词的顺序，我可以将其转换为首字母缩略词？

前任

```
["By","The","way"] = ["btw"] 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T03:29:35.910

您正在尝试匹配字符串列表的列表，但类型为`hep`is `[Word] -> [Word]`，这与此相矛盾。错误消息指的是这个事实。

但我猜你真正想要的是这个？

```
hep [] = []
hep (a:xs) = case a of 
    "You" -> "u":hep xs
    a -> a:hep xs 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T04:24:55.813

像这样的东西？

```
"By" -> let (y:ys) = xs
        in if y=="The" && head ys=="Way"
              then "btw": hep (drop 2 xs)
              else a:hep xs 
```

虽然我不想连续写 50 次。这个怎么样？

```
import Data.List
import Data.Maybe

hep [] = []
hep (a:xs) = case a of 
              "you" -> "u":hep xs
              "are" -> "r":hep xs
              "your" -> "ur":hep xs
              "boyfriend" -> "bf":hep xs
              "girlfriend" -> "gf":hep xs
              "great" -> "gr8":hep xs
              "by" -> matchPhrase 3
              "see" -> matchPhrase 2
              a -> a:hep xs
            where matchPhrase num = 
                    let found = lookup (concat $ take num (a:xs)) phrase_list
                    in case found of
                        Just _ -> fromJust found : hep (drop num (a:xs)) 
                        Nothing -> a:hep xs

phrase_list = [("bytheway", "btw"), ("seeyou","cu")] 
```

# javascript - Ajax .BeginForm 在 IE9 中返回空白视图

> ID：14845900
> 
> 赞同：1
> 
> 时间：2013-02-13T03:24:26.297
> 
> 标签：javascript, asp.net-mvc, razor, internet-explorer-9, ajax.beginform

MVC4 C#

我在整个应用程序中都使用 Ajax.BeginForm，它运行良好。当我创建并测试 ChkNum 视图时，它工作得很好。突然它停止工作了，我不知道为什么。它在其他视图中仍然有效，但在 ChkNum 视图中，当 post 操作中的 ModelState.IsValid 测试失败并返回视图时，返回的页面是空白的（我得到页眉和页脚但没有正文）。适当的脚本随站点一起加载并在所有其他视图中工作。

ChkNum 视图：

```
@model ModelVM
@{ ViewBag.Title = "Title"; } 
<script type="text/javascript">
    var onSuccess = function (result) {
        if (result.url) {
            window.location.href = result.url;
        }
    }
</script>

<div id="CkNmFrm">
    @Html.ValidationSummary(true)    <h2>Page Title</h2>
    <span class="h5-sty">Field1: @Model.Field1  Field2: @Model.Field2</span><br />
    @using (Ajax.BeginForm("ChkNum", new AjaxOptions() {OnSuccess = "onSuccess", UpdateTargetId = "CkNmFrm", HttpMethod = "Post"}))
    {
        @Html.AntiForgeryToken()
        <br />
        <span class="h4-sty">Field3: </span>
        <span class="ebwid">@Html.EditorFor(m => m.Field3) </span>
        @Html.ValidationMessageFor(m => m.Field3)<br /><br />
        <span><input type="submit" value="Submit" /></span>
        <br /><br />
    }
</div> 
```

ChkNum 动作：

```
public ActionResult ChkNum(int id)
{
    // code to build vM
    return View(vM);
}

[HttpPost, ValidateAntiForgeryToken]
public ActionResult ChkNum(ModelVM vM)
{
    if (ModelState.IsValid)
    {
        //code 
    }

    ModelState.AddModelError(string.Empty, "Fix Error");
    return PartialView("ChkNum", vM);
} 
```

我已经检查了几次代码并将其与工作操作和视图进行了比较，并没有发现任何问题。我在返回的 PartialView 处设置了一个断点，它正确地通过了 CkNmFrm。

我想不出我在应用程序中更改的任何其他可能导致此问题的内容。

在我的智慧结束这一点。非常感谢任何帮助。

**更新：** 我使用的是 IE 9。我刚刚在 Chrome 中尝试过，问题就消失了。所以现在的问题是为什么它在除 ChkNum 之外的多个视图中都有效，而且问题是 IE 特有的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T16:21:22.410

我终于找到了问题所在。在视图的最后，我有一大块注释掉的代码 (@* *@)。正中间那是一个

```
 </div> 
```

未注释掉的结束标记。当我删除它时，问题就解决了。叹息，浪费了几个小时。我开始删除整个令人尴尬的帖子，但决定保留它，希望其他人可以从我的愚蠢中吸取教训。

# trigger.io - trigger.io：如何过渡到新屏幕？

> ID：14845903
> 
> 赞同：0
> 
> 时间：2013-02-13T03:24:39.867
> 
> 标签：trigger.io

是否有需要使用的特定 API？我可以有指向活动屏幕的锚链接吗？例如在 android 中，当您单击按钮时，我们会启动一个新的活动屏幕。我将如何在 trigger.io 中实现这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T15:25:40.677

不，没有特定的 API。您只需导航到新页面或 Url 片段。这是使用 Trigger.io、backbone.js 和 jQuery mobile 的一种方式（单个 html 页面） -

[https://github.com/draghor/jquery-mobile-backbone-template](https://github.com/dragthor/jquery-mobile-backbone-template)

# c++ - C++ strings, the string cant contain the plus sign

> ID：14845907
> 
> 赞同：0
> 
> 时间：2013-02-13T03:25:42.797
> 
> 标签：c++, string

I am trying to make a more advanced calculator where you enter a piece of algebra. I have this problem, the string that contains what you inputted doesn't test positive for '+' even when it does.

This is the code that tests the string

```
for(int i = 0; i < line.length(); i++)
{
    if(pos == 0 && line[i] >= '0' && line[i] <= '9' || line[i] == '.')
    {           
        p1[p1p] = line[i]; // setting the number to the current character
        p1p++; // position of the first number  
    }
    if(line[i] == '+')
    {
    pos++; 
    operation = 1;
    cout << "add" << endl;
    }
} 
```

It will never out put + unless there is no space between the last character of the number and the + symbol

e.g. '100+10' would test positive for '+' but '100 + 10' wouldn't.

Thanks -Hugh

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T03:29:43.997

If my guess is correct you input the data with `std::cin`. which is why it does not read characters after the first white space.

use `getline()` function instead.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T05:24:00.730

You could use the `operator>>` which naturally reads (optionally) space separated values.

```
int val;
while(std::cin >> val)
{
    // We have a value (an integer)

    char c;
    if (std::cin >> c)
    {
        // we have read the next non space character
        switch(c)
        {
            case '+': std::cout << "Adding: " << val << "\n";break;
        }
    }
} 
```

# json - Node.js 示例将 Xml 转换为 JSON 以用于大型 Xml 文件

> ID：14845922
> 
> 赞同：5
> 
> 时间：2013-02-13T03:28:12.667
> 
> 标签：json, node.js, xml-parsing

我对 Node.js 比较陌生。我正在尝试将 83 个大小约为 400MB 的 XML 文件转换为 JSON。

每个文件都包含这样的数据（除了每个元素都有大量的附加语句）：

```
<case-file>
  <serial-number>75563140</serial-number>
  <registration-number>0000000</registration-number>
  <transaction-date>20130101</transaction-date>
  <case-file-header>
     <filing-date>19981002</filing-date>
     <status-code>686</status-code>
     <status-date>20130101</status-date>
  </case-file-header>
  <case-file-statements>
     <case-file-statement>
        <type-code>D10000</type-code>
        <text>"MUSIC"</text>
     </case-file-statement>
     <case-file-statement>
        <type-code>GS0351</type-code>
        <text>compact discs</text>
     </case-file-statement>
  </case-file-statements>
  <case-file-event-statements>
     <case-file-event-statement>
        <code>PUBO</code>
        <type>A</type>
        <description-text>PUBLISHED FOR OPPOSITION</description-text>
        <date>20130101</date>
        <number>28</number>
     </case-file-event-statement>
     <case-file-event-statement>
        <code>NPUB</code>
        <type>O</type>
        <description-text>NOTICE OF PUBLICATION</description-text>
        <date>20121212</date>
        <number>27</number>
     </case-file-event-statement>
   </case-file-event-statements> 
```

我尝试了很多不同的 Node 模块，包括 sax、node-xml、node-expat 和 xml2json。显然，我需要从文件中流式传输数据并通过 XML 解析器进行管道传输，然后将其转换为 JSON。

我还尝试阅读一些博客等，试图解释如何解析 Xml，尽管表面上。

在 Node 世界中，我首先尝试了 sax，但我不知道如何以可以将其转换为 JSON 的格式提取数据。xml2json 不适用于流。node-xml 看起来令人鼓舞，但我无法弄清楚它如何以任何有意义的方式解析块。node-expat 指向 libexpat 文档，这似乎需要博士学位。Node elementree 做同样的事情，指向 Python 实现，但没有解释实现了什么或如何使用它。

有人可以指出我可以用来入门的例子吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2018-09-28T21:38:25.177

尽管这个问题已经很老了，但我正在分享我的问题和解决方案，这可能对所有试图转换`XML`为`JSON`.

这里的实际问题不是转换，而是处理巨大的 XML 文件，而不必一次将它们保存在内存中。

使用几乎所有广泛使用的软件包，我遇到了以下问题 -

*   许多包支持`XML`转换`JSON`涵盖所有场景，但它们不适用于大文件。

*   很少有包（如[xml-flow](https://www.npmjs.com/package/xml-flow)、[xml-stream](https://www.npmjs.com/package/xml-stream)）支持大型 XML 文件转换，但转换过程错过了一些极端情况，即转换失败或提供不可预测的 JSON 结构（[在此 SO 问题中解释](https://stackoverflow.com/questions/52129764/xml-flow-npm-package-unexpected-xml-parsing-behaviour)）。

**理想的解决方案是结合这两种方法的优点，这正是我所做的，并提出了[xtreamer node package](https://www.npmjs.com/package/xtreamer)。**

简而言之，`xtreamer`像`xml-flow`/一样接受重复节点，`xml-stream`但发出重复的 xml 节点而不是转换后的 JSON。这提供了以下优点 -

*   我们可以`xtreamer`在任何可读流扩展时使用它进行管道传输`transform stream`。
*   发出的 XML 节点可以传输到任何 XML 到 JSON 解析器以获取所需的 JSON。
*   我们可以更进一步，将 JSON 解析器与`xtreamer`& 连接起来，它将调用 JSON 解析器并相应地发出 JSON。
*   `xtreamer`作为其`stream`唯一的依赖项和作为转换流扩展，它可以灵活地与其他流进行管道传输。

> 如果 XML 结构不固定怎么办？

我设法想出了另一个`sax`基于节点包[xtagger](https://www.npmjs.com/package/xtagger)，它读取 XML 文件并提供以下格式的文件结构 -

```
structure: { [name: string]: { [hierarchy: number]: number } }; 
```

这个包允许找出重复的节点名称，然后可以将其传递给`xtreamer`解析。

我希望这有帮助。:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-11-18T10:51:29.867

我怀疑这在 2-3 年后仍然有意义，但如果其他人偶然发现这一点，我会说`xml-stream`NPM 对我来说看起来相当简单。

如果您是想要避免的 Windows 用户，`GYP`但是我尝试添加一个非常简单的解决方案，`sax`用于从 XML 文件中逐个提取子项，它被调用`no-gyp-xml-stream`并且它可能没有很多功能，但它确实很容易使用：[https ://www.npmjs.com/package/no-gyp-xml-stream](https://www.npmjs.com/package/no-gyp-xml-stream)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-08T11:29:45.923

考虑到您的最后一个答案，我想现在您已经有了一个工作流程。

无论如何，如果您已经使用 SAX 成功解析了传入数据，则该解决方案可能只是将数据放入您设计的对象中并用于 `yourStream.write(JSON.stringify(yourObject))` 将其流出。

# jquery - 通过属性jquery获取元素

> ID：14845924
> 
> 赞同：3
> 
> 时间：2013-02-13T03:28:28.680
> 
> 标签：jquery, attributes, attr

有没有办法通过属性获取页面中的元素

所以可以说我有这个 HTML

```
<ul id="tabMenu">
  <li class="active"><a href="#home-loans">Home Loan</a></li>
  <li><a href="#savings">Savings</a></li>
  <li><a href="#car-loan">Car Loan</a></li>
  <li><a href="#credit-card">Credit Card</a></li>
</ul>

<div data-alias="#credit-card" class="tabContent">Content 1...</div>
<div data-alias="#savings" class="tabContent">Content 2...</div>
<div data-alias="#car-loan" class="tabContent">Content 3...</div>
<div data-alias="#credit-card" class="tabContent">Content 4...</div> 
```

和这个 jQuery

```
jQuery("#tabMenu li").each(function() {

tabid = jQuery(this).find("a").attr("href");

    if (jQuery(".tabContent").attr("data-alias") == tabid) {

       $tabHTML = //get div element that is for this tab
    }

}); 
```

从代码中的注释可以看出，我不确定如何获取元素。例如，对于带有#car-loan 的href 的li，获取带有#car-loan 的数据别名的div

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T03:30:17.167

使用常规[属性选择器](http://api.jquery.com/attribute-equals-selector/)：

```
$tabHTML = jQuery(".tabContent[data-alias='" + tabid + "']"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T03:31:46.717

你的意思是：

```
$tabHTML = $("div[data-alias='"+tabid +"']"); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-13T03:32:49.653

你会想用

```
$tabHTML = $( "div[ data-alias='" + tabid + "']" ); 
```

# c++ - 冒泡排序时程序崩溃？

> ID：14845928
> 
> 赞同：0
> 
> 时间：2013-02-13T03:28:50.653
> 
> 标签：c++, string, bubble-sort

```
 int sortAtt2,compare=0,counter=0;
            string tempTitle;
            for(int t=0; t<MAX_BOOKS; t++)
            {
                for(int i=0; i<MAX_BOOKS; i++)
                {
                    compare=(books[i+1].bookTitle).compare(books[i].bookTitle);
                    if(compare>0)
                    {
                        tempTitle=books[i].bookTitle;
                        books[i].bookTitle=books[i+1].bookTitle;
                        books[i+1].bookTitle=tempTitle;

                    }
                }
            } 
```

这是我的代码，每当我执行这个函数时，程序就会崩溃。知道为什么吗？我在这里比较两个字符串以对它们进行冒泡排序。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T03:30:04.240

越界访问。您正在`books[i+1]`一个循环中访问，其中`i`计数为`MAX_BOOKS - 1`，即，您正在访问- 一个超过包含元素`books[MAX_BOOKS]`的数组的末尾。`MAX_BOOKS`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T03:32:40.503

如果您有 MAX_BOOKS 8 个。

```
Book books[MAX_BOOKS]; 
```

你像这样循环。

```
for(int i=0; i<MAX_BOOKS; i++)
{
  books[i+1];
} 
```

什么时候发生`i == 7`？

# perl - 需要用空格替换固定宽度文件中的重音/变音符号/非 ASCII 字符

> ID：14845932
> 
> 赞同：0
> 
> 时间：2013-02-13T03:29:40.387
> 
> 标签：perl, shell, unix, sed, awk

**需要使用 shell scripting/awk/perl 用空格替换固定宽度文件中的重音/变音符号/非 ASCII 字符**

我们有一个固定宽度的文件，它在一个固定宽度的文件中有重音/变音符号/非 ASCII 字符。该文件是通过从数据库中提取数据并将其假脱机到文件而生成的。这里的主要问题是当我们查询数据库时，这些重音/变音符号/非 ASCII 字符在数据库客户端控制台上可见。但是当我们将这些数据提取到一个文件并在腻子框中打开文件时，我们无法看到这些字符。

例如，我们在数据库控制台中看到的是 JEANNOýýýýýýL，但在腻子框中我们看到的是 JEANNOL

为了解决这个问题，我尝试了以下方法。

使用 od -An -tu1 命令查找文件中每个字符的 ASCII 值。对于所有这些重音/变音符号/非 ASCII 字符，我将 ASCII 值设为 null，我将其替换为空格的 ASCII 字符。然后我为这些 ASCII 值打印字符。这里的问题是输入记录中的一些真实空格被删除并弄乱了这个固定宽度文件的列结构。

即使在我用空格替换重音字符的 ASCII 值后，我也想为固定宽度文件中的每条记录保持相同的行长。

我可以得到帮助来解决这个问题吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T08:48:29.740

我认为您的数据库包含您的 ETL 流程未处理的 utf8 编码字符。

处理此问题的最佳方法是更改​​您的 ETL 流程并删除这些字符。

另一种方法是使用这些正则表达式。对于第二个，您需要使用最近的 Perl（我使用的是 5.10.1）。

```
cat file | perl -lne 's!\x{00}! !g;print' > good_file. <-- this will replace every null to space

cat file | perl -lne 's![^[:ascii:]]! !g;print' > good_file. <-- this will replace every non ascii char to space 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T14:10:30.010

使用 sed 的一种方法

```
sed -i 's:[^[:print:]]:g' infile 
```

# objective-c - 向 UIView 添加渐变会导致错误

> ID：14845934
> 
> 赞同：0
> 
> 时间：2013-02-13T03:29:53.567
> 
> 标签：objective-c, rubymotion

我正在使用 RubyMotion。我在终端中看到的错误消息是：

> 耙中止！命令失败，状态为 (1)：[DYLD_FRAMEWORK_PATH="/Applications/Xcode.a...] /Library/RubyMotion/lib/motion/project.rb:101:in `block in <top (required)>' /usr/local/rvm/gems/ruby-1.9.3-p194/bin/ruby_noexec_wrapper:14:in` eval' /usr/local/rvm/gems/ruby -1.9.3-p194/bin/ruby_noexec_wrapper:14:in `' 任务：TOP => 默认 => 模拟器

所以错误发生在由 RubyMotion 本身创建的文件中，而不是我的文件之一。显然我仍然有错。我找到了似乎触发错误的行。这是创建 UIView 和渐变的 UIViewController 子类的相关代码：

```
def loadView

    button1 = UIView.alloc.initWithFrame(CGRect.make(x:0, y:55, width:100, height:40))
    gradientLayer = CAGradientLayer.layer
    gradientLayer.colors = NSArray.arrayWithObjects(UIColor.redColor.CGColor, UIColor.greenColor.CGColor, UIColor.blackColor.CGColor, nil) 
```

虽然稍后会出现更多代码，但我发现它`gradientLayer.colors`是导致错误的行。如果我在 中注释掉该行及其之后的所有内容`loadView`，则不会发生错误。知道问题是什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T17:42:07.113

我之前在使用 NSArray 创建数组时遇到了麻烦。试试这个：

```
def loadView
  button1 = UIView.alloc.initWithFrame(CGRect.make(x:0, y:55, width:100, height:40))
  gradientLayer = CAGradientLayer.layer
  gradientLayer.colors = [ UIColor.redColor.CGColor, UIColor.greenColor.CGColor, UIColor.blackColor.CGColor ]
  # ...
end 
```

# java - Java：如何为双精度值设置精度？

> ID：14845937
> 
> 赞同：118
> 
> 时间：2013-02-13T03:30:01.987
> 
> 标签：java

我最近在处理数字，我遇到了一种情况，我想将双精度值设置为 6 位或 4 位，具体取决于存储在数据库中的值。

例如，如果在数据库中将精度设置为 4 位，则输出必须如下所示，

`10.0000`.

我尝试`DecimalFormat`使用 string `##.####`，但每次都使用符号很烦人。

有没有更好的方法，说如下：

```
Double value = 10.0;
value.setPrecision(4); 
```

* * *

## 回答 #1

> 赞同：320
> 
> 时间：2014-02-06T07:17:32.923

您可以为此尝试[BigDecimal](https://docs.oracle.com/javase/7/docs/api/java/math/BigDecimal.html)

```
Double toBeTruncated = new Double("3.5789055");

Double truncatedDouble = BigDecimal.valueOf(toBeTruncated)
    .setScale(3, RoundingMode.HALF_UP)
    .doubleValue(); 
```

* * *

## 回答 #2

> 赞同：77
> 
> 时间：2013-02-13T03:32:24.357

您不能将双精度（或双精度）设置为指定的小数位数，因为浮点值没有小数位数。它们有二进制数字。

您必须通过`BigDecimal`或转换为十进制基数`DecimalFormat`，具体取决于您以后要对该值执行的操作。

另请参阅我对[这个问题](https://stackoverflow.com/questions/153724/how-to-round-a-number-to-n-decimal-places-in-java/12684082#12684082)的回答，以反驳不可避免的 *100/100 答案。

* * *

## 回答 #3

> 赞同：67
> 
> 时间：2013-10-23T21:20:14.257

这是一个简单的方法：

```
String formato = String.format("%.2f"); 
```

它将精度设置为 2 位。

如果您只想打印，请以这种方式使用它：

```
System.out.printf("%.2f",123.234); 
```

* * *

## 回答 #4

> 赞同：26
> 
> 时间：2016-08-24T10:51:11.360

为双精度值设置精度`DecimalFormat`是一种很好的技术。例如，要使用此类导入`java.text.DecimalFormat`并创建它的对象

```
double no=12.786;
DecimalFormat dec = new DecimalFormat("#0.00");
System.out.println(dec.format(no)); 
```

所以它会在小数点后打印两位数，它会打印 12.79

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2017-04-03T19:46:02.833

这对我有用：

```
public static void main(String[] s) {
        Double d = Math.PI;
        d = Double.parseDouble(String.format("%.3f", d));  // can be required precision
        System.out.println(d);
    } 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2015-03-20T21:35:15.567

这是实现结果的一种有效方法，但需要注意两点。

1.  将精度限制为“最大”N 位（不固定为 N 位）。
2.  向下舍入数字（不四舍五入到最接近的值）。

在此处查看示例测试用例。

```
123.12345678 ==> 123.123
1.230000 ==> 1.23
1.1 ==> 1.1
1 ==> 1.0
0.000 ==> 0.0
0.00 ==> 0.0
0.4 ==> 0.4
0 ==> 0.0
1.4999 ==> 1.499
1.4995 ==> 1.499
1.4994 ==> 1.499 
```

这是代码。我上面提到的两个警告可以很容易地解决，但是，速度对我来说比准确性更重要，所以我把它留在这里。`System.out.printf("%.2f",123.234);`与数学运算相比，字符串操作的计算成本很高。在我的测试中，与字符串操作相比，以下代码（没有 sysout）花费了 1/30 的时间。

```
public double limitPrecision(String dblAsString, int maxDigitsAfterDecimal) {
    int multiplier = (int) Math.pow(10, maxDigitsAfterDecimal);
    double truncated = (double) ((long) ((Double.parseDouble(dblAsString)) * multiplier)) / multiplier;
    System.out.println(dblAsString + " ==> " + truncated);
    return truncated;
} 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2013-02-13T03:37:22.510

和的精度由它们的大小和`double`IEEE[浮点类型](http://en.wikipedia.org/wiki/IEEE_floating_point)的实现方式固定。`float`

另一方面，输出中的小数位数是格式问题。你是正确的，一遍又一遍地输入相同的常量是一个坏主意。您应该改为声明一个字符串常量，并使用它的符号表示。

```
private static final String DBL_FMT = "##.####"; 
```

使用符号表示可以让您更改使用常量的所有位置的精度，而无需搜索代码。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2014-12-16T23:17:27.703

```
BigDecimal value = new BigDecimal(10.0000);
value.setScale(4); 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2013-02-13T03:40:34.350

为了扩展@EJP，处理双打时的“精度”概念非常令人担忧。正如[https://stackoverflow.com/a/3730040/390153](https://stackoverflow.com/a/3730040/390153)中所讨论的，无论精度如何，您甚至都不能将 0.1 表示为双精度数，出于同样的原因，您不能以有限的精度表示以 10 为底的 1/3。

您需要考虑您要解决的问题，并考虑：

a）我应该首先使用双打吗？如果精度是一个相关概念，那么使用双精度可能是一个错误。

b）如果双打是合适的，我所说的精度是什么意思？如果你只是在谈论显示，将逻辑包装在一个显示函数中，你只需要在一个地方处理它；IE。应用 DRY 原则。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-06-23T14:23:46.090

```
public static String setPrecision(String number, int decimal) {
    double nbr = Double.valueOf(number);
    int integer_Part = (int) nbr;
    double float_Part = nbr - integer_Part;
    int floating_point = (int) (Math.pow(10, decimal) * float_Part);
    String final_nbr = String.valueOf(integer_Part) + "." + String.valueOf(floating_point);
    return final_nbr;
} 
```

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2013-10-06T14:59:06.223

也许这种方法可以帮助您精确计算双精度值。

```
double truncate(double number)
    {
        int integerPart = (int) number;
        double fractionalPart = number - integerPart;
        fractionalPart *= 100;  //It is for upto two decimal values after point.
                                //You can increase the zeros to fulfill your needs.
        int fractPart = (int) fractionalPart;
        fractionalPart = (double) (integerPart) + (double) (fractPart)/100;
        return fractionalPart;
    } 
```

此方法将允许设置精度级别。

```
double truncate(double number, int precision)
{
    double prec = Math.pow(10, precision);
    int integerPart = (int) number;
    double fractionalPart = number - integerPart;
    fractionalPart *= prec;
    int fractPart = (int) fractionalPart;
    fractionalPart = (double) (integerPart) + (double) (fractPart)/prec;
    return fractionalPart;
} 
```

# python - Shopify Python API：如何将产品添加到集合中？

> ID：14845942
> 
> 赞同：1
> 
> 时间：2013-02-13T03:30:57.420
> 
> 标签：python, django, api, shopify

我在 django 应用程序中使用 Shopify Python API 与我的 Shopify 商店进行交互。

我有一个收藏 - 称为 - 畅销书。

我希望为此集合创建批量更新 - 即向此集合添加/删除产品。但是，他们的 python API 文档似乎并没有说明如何做到这一点。如何按名称获取集合？如何向其中添加产品？

感谢您的帮助。

* * *

这是我发现的

> > > x=shopify.CustomCollection.find(handle="best-sellers")
> > > 
> > > y=shopify.Collect() #创建一个新的收藏
> > > 
> > > p = shopify.Product.find(118751076) # 获取产品

所以问题是如何将上面的产品“p”添加到自定义集合“x”中？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T04:04:11.640

创建集合以将产品添加到自定义集合。

[Shopify API – 收集文档](http://api.shopify.com/collect.html#create)

这可以使用 Shopify Python API 完成，如下所示

```
collect = shopify.Collect({ 'product_id': product_id, 'collection_id': collection_id })
collect.save() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-07-08T11:53:07.390

该文档再次没有希望，但要记住的一件事是，实际上应该已经创建了一个现有集合

使用此代码找到它

`collection_id = shopify.CustomCollection.find(handle=<your_handle>)[0].id`

然后将collection_id，product_id添加到Collect对象并保存，记住首先保存您的产品（或有一个您可以找到的现有产品）然后只保存您的集合，否则集合将不知道它发布的产品到（通过api），像这样

`new_product = shopify.Product()`

`new_product.save()`

`add_collection = shopify.Collect('product_id': new_product.id, 'collection_id': collection_id})`

`add_collection.save()`

同样重要的是要注意 Product 和 Collect 之间存在 1 对 1 的关系

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-13T03:37:37.760

获取属于某个集合的所有产品

```
>>> shopify.Product.find(collection_id=841564295)
[product(632910392)] 
```

创建具有多个产品变体的新产品

```
>>> new_product = shopify.Product()
>>> print new_product.id  # Only exists in memory for now
None
>>> new_product.product_type = "Snowboard"
>>> new_product.body_html = "<strong>Good snowboard!</strong>"
>>> new_product.title = "Burton Custom Freestlye 151"
>>> variant1 = shopify.Variant()
>>> variant2 = shopify.Variant(dict(price="20.00", option1="Second")) # attributes can     be set at creation
>>> new_product.variants = [variant1, variant2]
>>> new_product.vendor = "Burton"
>>> new_product.save()  # Sends request to Shopify
True
>>> new_product.id
1048875193 
```

通过 - [http://wiki.shopify.com/Using_the_shopify_python_api#Receive_a_list_of_all_Products](http://wiki.shopify.com/Using_the_shopify_python_api#Receive_a_list_of_all_Products)

# browser - 可以在浏览器中显示的 Unicode 错误符号

> ID：14845947
> 
> 赞同：4
> 
> 时间：2013-02-13T03:31:46.300
> 
> 标签：browser, unicode, character-encoding, github, ascii

我正在尝试`bug`在我的 GitHub 项目的**问题**跟踪器中替换我的标签，作为实际错误的象征。我发现[了这个看起来很讨厌的生物](http://www.fileformat.info/info/unicode/char/1f41b/index.htm)和[这个瓢虫](http://www.fileformat.info/info/unicode/char/1f41e/index.htm)，但它们似乎太“超出范围”而无法在浏览器中显示。有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-13T08:06:10.207

提到的字符不是“超出范围”；即使它们是平面 1 字符，并且您在键盘上键入它们可能有困难，但它们在浏览器中工作得很好（当这样输入或作为字符引用时），*只要*它们可以在所使用的字体中找到。在网页中使用各种特殊字符的可能性实际上是字体问题。

就至少通常安装的字体所支持的字符而言，没有任何东西与错误很相似。因此，如果您想使用字符而不是图像（可能没有意义的目标），可下载字体（网络字体，带有`@font-face`）是唯一可行的选择。

这意味着您应该查看一些可用*不同字体*的象形图的字形，而不仅仅是 Unicode 标准中的代表性字形。我对（软件）错误的想法或多或少与 Segoe UI Symbol 字体中的 ANT (U+1F41C) 匹配。不幸的是，似乎有一种包含 ANT、Symbola 的免费字体，它并不是那么“错误”，但可能还算不错。所以*如果*我坚持使用错误*字符*我会怎么做

```
<style>
@font-face { font-family: Symbola;
  /* here the usual stuff for Symbola, the usual bulletproof syntax */
}
.bug { font-family: Segoe UI Symbol, Symbola; }
</style>
<span style=bug>&#x1f41c;</span> 
```

但我担心将 Symbola（一种相当大的字体）作为可下载的字体只是为了一个不是*文本*字符的字符会有点过分。并且 ANT “” 在常见的文本大小中可能看起来不太可读。

# ember.js - 独立 cli node.js 应用程序中的 ember 数据

> ID：14845955
> 
> 赞同：3
> 
> 时间：2013-02-13T03:32:26.520
> 
> 标签：ember.js, ember-data

这可能是一个愚蠢的问题，但是对于我正在编写的命令行 node.js 应用程序，是否可以/建议在没有 ember 的情况下使用 ember 数据？我的前端项目中已经有一组 Ember Data 模型，我很想重用它们。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T20:04:57.777

*Ember-data*使用*Ember*本身的特性，或者更准确地说，它是基于 ember 的，并且将来会被合并到其中，因此您必须包含 ember 库及其依赖项（handlebars）以用于 ember-数据工作，但之后你只能使用你需要的部分，比如模型。

# opencv - OpenCV - gpu::convolve 的问题

> ID：14845963
> 
> 赞同：1
> 
> 时间：2013-02-13T03:33:13.327
> 
> 标签：opencv, gpu

我正在使用 OpenCV 的 gpu 库（版本 2.4.3）进行一些具有不同内核大小的 2D 卷积。

如果我使用 gpu::filter2D 函数，卷积工作正常。但是，如果我将内核大小从 7x7 增加到 17x17，那么 gpu::filter2D 就会出错。我猜 gpu::convolve 支持具有更大内核大小的卷积，但我遇到了一些麻烦。

根据文档，对于 gpu::convolve，我使用内核的 GpuMat 版本，而对于 gpu:filter2D，我使用内核的 Mat 版本。我将图像和内核设置为 CV_32FC1 数据类型。

下面是我的代码片段：

```
struct GPU_Buffer {
    GpuMat InputImage_GPU;
    GpuMat BasisPatch_GPU;
    GpuMat OutputImage_GPU;
} gpuBuffer;

Mat ConvOutputImage = Mat::zeros(InputImage.rows, InputImage.cols, CV_32FC1);

gpuBuffer.InputImage_GPU.upload(InputImage);
gpuBuffer.BasisPatch_GPU.upload(basisPatch);

Point anchor(-1,-1);  // Anchor is at Filter center

int borderMode = BORDER_CONSTANT;

// Works for 7x7
gpu::filter2D(gpuBuffer.InputImage_GPU, gpuBuffer.OutputImage_GPU, -1, basisPatch, anchor, borderMode);

// Doesn't work for any size at all
//gpu::convolve(gpuBuffer.InputImage_GPU, gpuBuffer.BasisPatch_GPU, gpuBuffer.OutputImage_GPU, true);   // true => performs correlation

gpuBuffer.OutputImage_GPU.download(ConvOutputImage); 
```

有人可以指出异常的可能原因吗？

谢谢，

席德

# php - 如何自动搜索其他网站的数据？

> ID：14845964
> 
> 赞同：0
> 
> 时间：2013-02-13T03:33:17.380
> 
> 标签：php, web

我有一个为旅行社建立电子商务网站的计划。我需要直接在他们的服务器中自动搜索“机票”。无需任何操作员即可在电脑前待机。例如：2013 年 2 月 15 日，从 jambi(djb) 到 jakarta(cgk) 的机票。对于那个请求，我需要一个脚本来自动搜索“lion air”服务器、“sriwijaya air”服务器、“Garuda Indonesia”服务器。并获得可以在我的网站内显示的结果

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T03:39:59.763

其中一种方法是使用 RSS Feed。首先，请确保那些第三方网站提供此服务，并指向您想要的信息。Drupal 等一些 CMS 还提供 RSS Feed 服务，以便您可以将其他人的更新数据检索到您的站点中。[在http://www.mnot.net/rss/tutorial/](http://www.mnot.net/rss/tutorial/)了解更多信息

# jsp - 当用户点击链接时，如何从jsp获取url值到servlet？

> ID：14845966
> 
> 赞同：0
> 
> 时间：2013-02-13T03:33:45.310
> 
> 标签：jsp, servlets

我的jsp中有以下代码

```
<table>
    <c:forEach var="link" items="${weblinks}">
        <c:if test="${link.featured}">
            <tr>
                <td>
                    <span>${link.title} (Hits : ${link.numOfHits})
                        </span>

                    <span>
                        <a href="<c:url value='${link.url}'/>">${link.url}  </a></span><br></td>
            </tr>
        </c:if>
    </c:forEach>
</table> 
```

现在我希望当任何用户单击链接时链接打开并且链接的 url 也转到 servlet。我已经实现了第一个功能，但是我将如何在 servlet 中获取 url，以便我可以在数据库中更新点击次数，网站链接已收到？

请帮我。我有谷歌它，但没有得到答案。如果使用了javascript，那么请解释一下java脚本代码吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T05:47:49.450

更新

```
<a href="<c:url value='${link.url}'>
<c:param name="hits" value="${link.numOfHits}"/></c:url>">${link.url}  </a> 
```

这将添加一个查询字符串，其参数为点击数，其值为点击数

在 servlet 上，`request.getParameter("hits")`您将获得 servlet 上的命中数

参考[http://www.roseindia.net/jsp/simple-jsp-example/JSTLConstructingURLs.shtml](http://www.roseindia.net/jsp/simple-jsp-example/JSTLConstructingURLs.shtml)

希望这可以帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T06:28:15.790

我不知道您的链接是如何创建的，但看起来您将向您的 servlet 发出 GET 请求。知道这一点后，每个 servlet 都应该管理页面的计数器命中，并且由于每个用户都应该知道这个值，因此最好将它保存在应用程序范围内，而不是请求或会话中。更多内容和[servlet 是如何工作](https://stackoverflow.com/q/3106452/1065197)[的？](http://www.coderanch.com/t/177671/java-Web-Component-SCWCD/certification/Page-Scope-request-Scope-session)[实例化、会话、共享变量和多线程](https://stackoverflow.com/q/3106452/1065197)。

我将发布一个处理单个链接计数器的 jsp 和 servlet 示例。您也应该能够使用它来处理您的链接。

index.jsp （其他元素喜欢`<head>`并且`<html>`对于示例毫无价值）

```
<body>
    Hit the button to add a value to the application counter
    <br />
    <form action="HitCounterServlet" method="GET">
        <input type="submit" value="Add counter hit" />
    </form>
    <br />
    Total hits: ${applicationScope['counter']}
</body> 
```

HitCounterServlet

```
@WebServlet(name = "HitCounterServlet", urlPatterns = {"/HitCounterServlet"})
public class HitCounterServlet extends HttpServlet {

    private static final Object counterLock = new Object();

    @Override
    protected void doGet(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException {
        ServletContext context = request.getServletContext();
        updateHitCounter(context);
        String originalURL = "index.jsp";
        //in case you want to use forwarding
        //request.getRequestDispatcher(originalURL).forward(request, response);
        //in case you want to use redirect
        response.sendRedirect(response.encodeRedirectURL(request.getContextPath() + "/" + originalURL));
    }

    private void updateHitCounter(ServletContext context) {
        //since more than a request can try to update the counter
        //you should protect the update using a synchronized block code
        synchronized(counterLock) {
            Integer counter = (Integer)context.getAttribute("counter");
            if (counter == null) {
                counter = 0;
            }
            counter++;
            context.setAttribute("counter", counter);
        }
    }
} 
```

在不同的浏览器中尝试此操作，您将看到计数器如何在它们之间保持相同的状态。

* * *

为了将计数器命中保存在数据库中，您只需更改`updateHitCounter`函数中的代码以获取将连接到数据库的代码并对数据库字段执行更新语句。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-13T03:41:40.840

您可以使用 cookie 来记录页面点击次数。

代码：

```
<%@ page import="java.io.*,java.util.*" %>
<%
   // Get session creation time.
   Date createTime = new Date(session.getCreationTime());
   // Get last access time of this web page.
   Date lastAccessTime = new Date(session.getLastAccessedTime());

   String title = "Welcome Back to my website";
   Integer visitCount = new Integer(0);
   String visitCountKey = new String("visitCount");
   String userIDKey = new String("userID");
   String userID = new String("ABCD");

   // Check if this is new comer on your web page.
   if (session.isNew()){
      title = "Welcome Guest";
      session.setAttribute(userIDKey, userID);
      session.setAttribute(visitCountKey,  visitCount);
   } 
   visitCount = (Integer)session.getAttribute(visitCountKey;
   visitCount = visitCount + 1;
   userID = (String)session.getAttribute(userIDKey);
   session.setAttribute(visitCountKey,  visitCount);
%>
<html>
<head>
<title>Session Tracking</title>
</head>
<body>
<center>
<h1>Session Tracking</h1>
</center>
<table border="1" align="center"> 
<tr bgcolor="#949494">
   <th>Session info</th>
   <th>Value</th>
</tr> 
<tr>
   <td>id</td>
   <td><% out.print( session.getId()); %></td>
</tr> 
<tr>
   <td>Creation Time</td>
   <td><% out.print(createTime); %></td>
</tr> 
<tr>
   <td>Time of Last Access</td>
   <td><% out.print(lastAccessTime); %></td>
</tr> 
<tr>
   <td>User ID</td>
   <td><% out.print(userID); %></td>
</tr> 
<tr>
   <td>Number of visits</td>
   <td><% out.print(visitCount); %></td>
</tr> 
</table> 
</body>
</html> 
```

或者您可以使用应用程序隐式对象和相关方法 getAttribute() 和 setAttribute() 实现命中计数器。

```
<%
    Integer hitsCount = 
      (Integer)application.getAttribute("hitCounter");
    if( hitsCount ==null || hitsCount == 0 ){
       /* First visit */
       out.println("Welcome to my website!");
       hitsCount = 1;
    }else{
       /* return visit */
       out.println("Welcome back to my website!");
       hitsCount += 1;
    }
    application.setAttribute("hitCounter", hitsCount);
%>
<center>
<p>Total number of visits: <%= hitsCount%></p> 
```

希望这可以帮助..

# php - 当值在数组中时，PHP 数组搜索返回 false

> ID：14845969
> 
> 赞同：0
> 
> 时间：2013-02-13T03:34:27.257
> 
> 标签：php, http, web-scraping

我正在编写一个 URL 抓取工具（只是名称和描述），并且正在尝试处理 301 重定向。

现在，我检查标题，如果不是 200，我尝试在标题中找到要重定向到的位置。我的问题出现了，因为 array_search 没有返回 Location 值所在的键，尽管我在那里看到了它。

这是代码片段：

```
if(strpos($url_headers[0], "200") !== false){
        echo "in here";
        return $url;
    }else{
        print_r($url_headers);
        //look for location
        $location_key = array_search("Location: ", $url_headers);
        echo "Location Key: " . $location_key;
        $redirect_string = $url_headers[$location_key];
        $clean_url = str_replace("Location: ", "", $redirect_string);
        return $clean_url;
    } 
```

这个的输出是：

```
Array ( [0] => HTTP/1.0 301 Moved Permanently [1] => Location: http://www.google.com/ [2] => Content-Type: text/html; charset=UTF-8 [3] => Date: Wed, 13 Feb 2013 03:30:00 GMT [4] => Expires: Fri, 15 Mar 2013 03:30:00 GMT [5] => Cache-Control: public, max-age=2592000 [6] => Server: gws [7] => Content-Length: 219 [8] => X-XSS-Protection: 1; mode=block [9] => X-Frame-Options: SAMEORIGIN [10] => HTTP/1.0 200 OK [11] => Date: Wed, 13 Feb 2013 03:30:00 GMT [12] => Expires: -1 [13] => Cache-Control: private, max-age=0 [14] => Content-Type: text/html; charset=ISO-8859-1 [15] => Set-Cookie: PREF=ID=fe86e29432d4e240:FF=0:TM=1360726200:LM=1360726200:S=Wg8VEU7kc7UtcKc-; expires=Fri, 13-Feb-2015 03:30:00 GMT; path=/; domain=.google.com [16] => Set-Cookie: NID=67=KH8Zu8EpKjrhje8nD0lk_868mqvQr9pGwsAsaUuPDD_PRUgohJHoOkdlyYEHWmohUtndyENDJ0oZq8pC1aqOg20anXpUn5btQX5GYM6kYlgMhYxIPajtGp9KymmMDO1Y; expires=Thu, 15-Aug-2013 03:30:00 GMT; path=/; domain=.google.com; HttpOnly [17] => P3P: CP="This is not a P3P policy! See http://www.google.com/support/accounts/bin/answer.py?hl=en&answer=151657 for more info." [18] => Server: gws [19] => X-XSS-Protection: 1; mode=block [20] => X-Frame-Options: SAMEORIGIN ) Location Key: {"error":"invalid_url","error_code":null} 
```

我究竟做错了什么？在抓取用户提供的链接时，是否有更优雅的方式来处理重定向？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T05:43:39.470

```
 $ch = curl_init();
        curl_setopt($ch, CURLOPT_URL, $url);
        curl_setopt($ch, CURLOPT_HEADER, true);
        curl_setopt($ch, CURLOPT_FOLLOWLOCATION, false);
        curl_setopt($ch, CURLOPT_RETURNTRANSFER, TRUE);
        $a = curl_exec($ch);
        if(preg_match('#Location: (.*)#', $a, $r)){
         $l = trim($r[1]);
         return $l;
        }else{
            return $url;
        } 
```

这在大多数情况下都有效，但仍然无法重定向到 https（出于某种原因，他们需要双重重定向？）

（通过[http://zzz.rezo.net/HowTo-Expand-Short-URLs.html](http://zzz.rezo.net/HowTo-Expand-Short-URLs.html)）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T04:06:09.437

```
$url_headers[0] = 'HTTP/1.0 200';
if(strpos($url_headers[0], "200") > 0){
  echo "here";
} else {
  //look for location
   $location_key = getLocation($url_headers);
   echo "Location Key: " . $location_key;
}

function getLocation($data) {
    $url = false;
    foreach($data as $key => $value) {
        if (preg_match("/Location:/", $value)) {
             echo "A match was found.";
            //$url = $matches[1];
            $url = $data[$key];
            break;
        }
    }
    return $url;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-13T04:09:35.907

[如果strpos](http://php.net/manual/en/function.strpos.php)找不到匹配项，则返回 false，因此您需要这样做

```
if( ! strpos($url_headers[0], "200")) 
```

# java - 断言失败时触发函数

> ID：14845971
> 
> 赞同：0
> 
> 时间：2013-02-13T03:34:43.610
> 
> 标签：java, junit, junit4, assert, infinitest

我正在使用 Java 中可用的 CodeModel 进行复杂的代码生成。我设法以这样一种方式设置我的单元测试，以便测试生成小但功能完整的 Java 代码，这些代码在内存中编译，并且生成的类是从内存中加载的。如果我不输出生成的代码，通常一切都相当快。

由于生成器代码不知道生成的类，我使用反射来触发生成类的方法，效果很好。这些方法也可能会失败，因为我使用反射通过检查对象的状态来确保方法完成了预期的工作。

我的问题是我不想在每次运行测试时都记录生成的代码。但是如果测试失败，我想查看生成的代码。有很多测试，因为我使用了 infintest，我的 eclipse 变得更慢，因为infinitest 不断积累各种测试的输出。

我可以设置 junit 以便在测试失败时调用我的函数吗？例如

```
boolean compileSuccessful = compile();
Assert.assertTrue("Ooops, you generated bad code", compileSuccessful); 
```

如果上述断言失败，我想输出生成的代码，看看出了什么问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T06:35:11.133

您可以使用[TestRule](http://junit-team.github.com/junit/javadoc/latest/org/junit/rules/TestRule.html)，它将生成的代码添加到失败测试的输出中。我建议扩展[TestWatcher。](http://junit-team.github.com/junit/javadoc/latest/org/junit/rules/TestWatcher.html)

```
public class GeneratedCodeLogger extends TestWatcher {
  private Logger log;

  public GeneratedCodeLogger(Logger log) {
    this.log = log;
  }

  @Override
  protected void failed(Description d) {
    System.out.println(log.toString());
  }
} 
```

您的测试必须使用此规则并将生成的代码记录到记录器中。

# javascript - 如何使用 Backbone Collection 来获取这个 JSON 结果？

> ID：14845972
> 
> 赞同：0
> 
> 时间：2013-02-13T03:34:54.613
> 
> 标签：javascript, json, backbone.js

我有以下 JSON 回复

```
{
   "results":[
      {
         "Product":{
            "id":"1",
            "short_name":"Infra - 2200 CAS Sma SIMO onl [DAS.1.1]",
            "serial_number":"DAS.1.1",
            "created_by":"Wesley Jace Tan",
            "modified_by":"Wesley Jace Tan",
            "created":"2013-02-11 07:58:20",
            "modified":"2013-02-11 07:58:20",
            "full_name_type":"2200",
            "full_name_cas_stk":"CAS",
            "full_name_size":"Small",
            "full_name_simo_mimo":"SIMO only",
            "full_name_product_code":"(2961-737)",
            "uom":"lot",
            "material":"Infra"
         },
         "Price":[
            {
               "id":"1",
               "product_id":"1",
               "source_file":"LTE Test File.xls",
               "for_financial_year":"FY12_13",
               "created_by":"Wesley Jace Tan",
               "modified_by":"Wesley Jace Tan",
               "created":"2013-02-11 07:58:20",
               "modified":"2013-02-11 07:58:20",
               "gross_unit":"50.00",
               "gross_total_value":"0.00",
               "gross_total_formula":"=K12*J12",
               "incentive_value":"5",
               "incentive_formula":"5",
               "net_price_unit":"0.00",
               "net_price_total_value":"0.00",
               "net_price_total_formula":"=N12*J12"
            }
         ]
      },
      {
         "Product":{
            "id":"2",
            "short_name":"Infra - 2200 CAS Sma SIMO to  [DAS.1.2]",
            "serial_number":"DAS.1.2",
            "created_by":"Wesley Jace Tan",
            "modified_by":"Wesley Jace Tan",
            "created":"2013-02-11 07:58:20",
            "modified":"2013-02-11 07:58:20",
            "full_name_type":"2200",
            "full_name_cas_stk":"CAS",
            "full_name_size":"Small",
            "full_name_simo_mimo":"SIMO to MIMO Retrofit",
            "full_name_product_code":"(2961-737)",
            "uom":"lot",
            "material":"Infra"
         },
         "Price":[
            {
               "id":"2",
               "product_id":"2",
               "source_file":"LTE Test File.xls",
               "for_financial_year":"FY12_13",
               "created_by":"Wesley Jace Tan",
               "modified_by":"Wesley Jace Tan",
               "created":"2013-02-11 07:58:20",
               "modified":"2013-02-11 07:58:20",
               "gross_unit":"11.00",
               "gross_total_value":"0.00",
               "gross_total_formula":"=K13*J13",
               "incentive_value":"24",
               "incentive_formula":"24",
               "net_price_unit":"0.00",
               "net_price_total_value":"0.00",
               "net_price_total_formula":"=N13*J13"
            }
         ]
      },
      {
         "Product":{
            "id":"3",
            "short_name":"Infra - 2200 CAS Sma Full MIM [DAS.1.3]",
            "serial_number":"DAS.1.3",
            "created_by":"Wesley Jace Tan",
            "modified_by":"Wesley Jace Tan",
            "created":"2013-02-11 07:58:20",
            "modified":"2013-02-11 07:58:20",
            "full_name_type":"2200",
            "full_name_cas_stk":"CAS",
            "full_name_size":"Small",
            "full_name_simo_mimo":"Full MIMO",
            "full_name_product_code":"(2961-737)",
            "uom":"lot",
            "material":"Infra"
         },
         "Price":[
            {
               "id":"3",
               "product_id":"3",
               "source_file":"LTE Test File.xls",
               "for_financial_year":"FY12_13",
               "created_by":"Wesley Jace Tan",
               "modified_by":"Wesley Jace Tan",
               "created":"2013-02-11 07:58:20",
               "modified":"2013-02-11 07:58:20",
               "gross_unit":"12.00",
               "gross_total_value":"0.00",
               "gross_total_formula":"=K14*J14",
               "incentive_value":"5",
               "incentive_formula":"5",
               "net_price_unit":"0.00",
               "net_price_total_value":"0.00",
               "net_price_total_formula":"=N14*J14"
            }
         ]
      }
   ]
} 
```

检索上述数据的 url 是 /products/index.json

检索产品数据第 2 页的 url 是 /products/index.json/page:2

我已将以下内容写为集合

```
<script type="text/javascript">
    (function ($) {
        window.AppView = Backbone.View.extend({
            el: $("body")
        });
        var appview = new AppView;

        var Products = Backbone.Collection.extend({
            model: Product, 
            url: '/products/index.json'
        });

        Products.fetch();
    })(jQuery);
</script> 
```

我想我`Products`写错了集合。

请指教。

**更新**

这是我的新代码[http://jsfiddle.net/Cw6PT/](http://jsfiddle.net/Cw6PT/)

这是我现在收到的错误消息： Uncaught TypeError: Object function (){return c.apply(this,arguments)} has no method 'fetch'

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T03:46:25.040

你`Products`是一个`Collection`类，而不是一个`Collection`对象。将您的代码更改为

```
new Products().fetch() 
```

或者

```
var Products = new (Backbone.Collection.extend(...)) 
```

应该管用。此外，如果您想自定义如何解析 JSON 回复，您可以覆盖[collection.parse](http://backbonejs.org/#Collection-parse)。

# javascript - 如何从objective-c方法调用我的phonegap ios应用程序中的javascript函数？

> ID：14845975
> 
> 赞同：3
> 
> 时间：2013-02-13T03:35:15.650
> 
> 标签：javascript, ios, objective-c, cordova

我试过这个，但它没有用。这是我的phonegap index.html：

```
<!DOCTYPE html>
<html>
<head>
<script>
function myFunction()
{
alert("Hello World!");
}
</script>
</head>
<body>
</body>
</html> 
```

这是我想触发它​​的 MainViewController.m 方法：

```
- (void)bannerView:(ADBannerView *)banner didFailToReceiveAdWithError:(NSError *)error {
adView.hidden = YES;

// jscript call
[webView stringByEvaluatingJavaScriptFromString:@"myFunction()"];
} 
```

我想要做的甚至可能吗？我根本不知道objective-c，所以我真的迷路了。请帮忙！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-13T07:08:05.637

是的，你绝对可以做到！

“ `stringByEvaluatingJavaScriptFromString`” 可以解决问题。

这是您需要在需要触发的地方应用的语法：

```
[self.webView stringByEvaluatingJavaScriptFromString:@"YOUR JAVASCRIPT FUNCTION()"]; 
```

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-02-13T03:42:27.710

根据我的理解，使用phonegap 的整个想法是让你不需要学习objective-c。您可以使用 HTML5、CSS 和 Javascript 库（如 JQuery）来使应用程序执行您想要的操作。

您可以使用 phonegap.js API 和插件来访问本机功能。

# python - 使用 functools.partial 进行跟踪

> ID：14845976
> 
> 赞同：2
> 
> 时间：2013-02-13T03:35:26.273
> 
> 标签：python, python-2.7, trace, functools

我正在开发一个使用该[`trace`](http://docs.python.org/2/library/trace.html)模块来跟踪代码执行的项目。
当我调用`trace.Trace(args).run(stuff)`时，`stuff`必须是代码对象或字符串。

现在，我正在构建我将通过调用来调用的函数`functools.partial`。这部分完全按照我的需要工作。

但是，当我到达跟踪部分时，我无法使用`functools.partial`对象执行跟踪。我不能使用`myFuncToolsPartialObject.func.func_name(args)`，因为我不能保证该函数将被导入本地范围。我可以通过调用 import 来解决这个问题，但目前我不想这样做（我们称之为个人偏好）。

有没有办法可以将`functools.partial`对象转换为代码对象以便正确调用跟踪？

我知道我可以要求`myFuncToolsPartialObject.func.func_code`，但我不知道如何在所需的参数上调用它

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T04:16:37.940

事实证明，它`trace`仅支持这个用例。`trace.Trace().runfunc(funcObject, *args)`正是这样做的。

从[文档](http://docs.python.org/2/library/trace.html#trace.Trace.runfunc)：

```
runfunc(func, *args, **kwds)
Call func with the given arguments under control of the Trace object with the current tracing parameters. 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T03:50:49.940

这行得通吗？

```
trace.Trace().run((lambda :partial_stuff(args)).func_code) 
```

# html - 如何在重建音频文件时对音频文件进行编码和分段，而不会在片段之间产生间隙（或音频爆音）？

> ID：14845977
> 
> 赞同：9
> 
> 时间：2013-02-13T03:35:44.963
> 
> 标签：html, node.js, ffmpeg, audio-streaming, web-audio-api

我正在开发一个需要流式传输和同步多个音频文件的 Web 应用程序。为此，由于定时音频的重要性，我在 HTML5 音频标签上使用[Web 音频 API 。](https://dvcs.w3.org/hg/audio/raw-file/tip/webaudio/specification.html)

目前，我正在使用 FFMPEG 的分割功能将音频文件编码和分割成更小的块。我对它们进行分段的原因是我可以从文件中间开始流式传输，而不是从头开始（否则我会使用 UNIX 拆分来拆分文件，[如此处所示](http://72lions.com/2013/01/play-a-chunked-mp3-with-the-web-audio-api)。问题是当我将音频片段重新组合在一起，我得到片段之间的音频弹出。

如果我在 .wav 文件中使用 PCM 编码 (pcm_s24le) 对片段进行编码，则播放是无缝的，这让我相信编码器正在填充文件的开头或结尾。由于我将处理许多不同的音频文件，因此使用 .wav 将需要太多带宽。

我正在寻找以下解决方案之一：

*   如何无缝分割编码的音频文件，
*   如何强制编码器不使用 ffmpeg（或其他实用程序）填充音频帧，或者
*   在不使用音频标签的情况下，有什么更好的方式来流式传输音频（从任意轨道时间开始）？

### 系统信息

*   自定义 node.js 服务器
*   上传音频文件后，node.js 将数据通过管道传输到 ffmpeg 的编码器中
*   需要使用 HTML5 Web Audio API 支持的编码
*   服务器通过 WebSockets 套接字一次发送 1 个音频块

提前致谢。我试图尽可能清楚，但如果您需要澄清，我非常愿意提供。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-16T07:29:33.747

由于 PCM 是未压缩格式，因此可以无缝播放。没有什么可以造成故障。如果您使用像 flac 这样的无损编解码器，也会发生同样的事情。另一方面，如果您使用任何有损编解码器，如 mp3、wma 等......没有任何干预就无法避免故障。例如，WMA 解码器总是会为您提供比您最初在编码时提供的更多的 PCM。额外的字节会产生一个小故障，它也会搞砸持续时间。此外，这种级联播放（剪辑列表）的持续时间将更长。您可以尝试使用一些 DSP 过滤来平滑故障。您甚至可以尝试一些简单的操作，例如交叉淡入淡出等。也许它会产生一些有用的结果。

如果某些无损编解码器由于带宽而无法接受，另一种方法是使用 mp3 等有损编解码器创建压缩文件，然后从计算的位置开始流式传输。当然，您不能像在 PCM 中那样对样本进行准确的搜索，并且在解码时会得到少量无用的 PCM，因为您将在中间开始解码压缩数据，而解码器不需要“先前的数据”。我建议在对此类文件进行编码时保持比特率不变，因为在开始流式传输之前，您将能够更准确地计算压缩文件中的搜索位置。

关于此处的故障，如果您开始对此类 mp3 文件进行编码，并且您在不停止编码器的情况下创建这些文件，那么在切换文件时将不会出现故障，因为您只是将压缩数据划分为更多文件。当然，您可能必须自己实现这一点。

# scala - 在 Scala 中重构为高阶函数？

> ID：14845980
> 
> 赞同：3
> 
> 时间：2013-02-13T03:35:58.813
> 
> 标签：scala

学习 Scala 并尝试重构以下两个函数以删除重复的逻辑。我应该创建一个高阶函数还是其他东西以避免重复代码？有更多类似的方法和这样的重复代码，只是在调用不同的域方法上有所不同。

对重构有点困惑。使用 Scala 2.10 版

```
def authenticate = Action(parse.json) { request =>
  val json = request.body
  val input = Json.fromJson[User](json)
  input.asOpt match {
    case Some(m: User) => Ok(Domain.authenticate(m)).as("application/json")
    case None => Ok("bad input")
  }
}

def addUser = Action(parse.json) { request =>
  val json = request.body
  val input = Json.fromJson[User](json)
  input.asOpt match {
    case Some(m: User) => Ok(Domain.addUser(m)).as("application/json")
    case None => Ok("bad input")
  }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T06:26:21.223

我想你可以做类似（**未经测试**）的事情：

```
private def common[A](f:User=>A)(request:RequestHeader) = {
  val json = request.body
  val input = Json.fromJson[User](json)

  input.asOpt match {
    case Some(m: User) => Ok(f(m)).as("application/json")
    case None => Ok("bad input")
  }
}

def addUser = Action(parse.json) { common(Domain.adduser)(_) }

def authenticate = Action(parse.json) { common(Domain.authenticate)(_) } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T03:42:31.300

我也是 Scala 的新手，但我认为我们可以做这样的事情。如果我错了，请纠正我。

你可以做这样的事情

```
def foo(f:Int=>Int,x:Int):Int = {f(x)}
   foo(x=>x+x,3) 
```

因此，类似地，您可以将要调用的函数传递给通用函数。

# mysql - DateTime 按日期和小时分组

> ID：14845981
> 
> 赞同：74
> 
> 时间：2013-02-13T03:36:17.550
> 
> 标签：mysql, sql

我有一个名为**activity_dt**的日期时间，数据如下所示：

```
2/5/2013 9:24:00 AM
2/7/2013 7:17:00 AM 
```

我如何按日期和时间分组？

* * *

## 回答 #1

> 赞同：130
> 
> 时间：2013-02-13T03:49:05.463

SQL 服务器：

```
SELECT [activity_dt], count(*)
FROM table1
GROUP BY DATEPART(day, [activity_dt]), DATEPART(hour, [activity_dt]); 
```

甲骨文：

```
SELECT [activity_dt], count(*)
FROM table1
GROUP BY TO_CHAR(activity_dt, 'DD'), TO_CHAR(activity_dt, 'hh'); 
```

MySQL：

```
SELECT [activity_dt], count(*)
FROM table1
GROUP BY hour( activity_dt ) , day( activity_dt ) 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2016-01-08T09:54:59.687

使用 MySQL 我通常这样做：

```
SELECT count( id ), ...
FROM quote_data
GROUP BY date_format( your_date_column, '%Y%m%d%H' )
order by your_date_column desc; 
```

或者在同样的想法中，如果您需要输出日期/小时：

```
SELECT count( id ) , date_format( your_date_column, '%Y-%m-%d %H' ) as my_date
FROM  your_table 
GROUP BY my_date
order by your_date_column desc; 
```

如果您在日期列上指定索引，MySQL 应该能够使用它来加快速度。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-13T03:45:52.683

```
SELECT [activity_dt], COUNT(*) as [Count]
  FROM 
 (SELECT dateadd(hh, datediff(hh, '20010101', [activity_dt]), '20010101') as [activity_dt]
    FROM table) abc
 GROUP BY [activity_dt] 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-08-13T09:14:53.977

在我的情况下......使用MySQL：

`SELECT ... GROUP BY TIMESTAMPADD(HOUR, HOUR(columName), DATE(columName))`

# mysql - SQL - 仅用于当前表的总和字段，来自连接 5 个表

> ID：14845983
> 
> 赞同：0
> 
> 时间：2013-02-13T03:36:36.040
> 
> 标签：mysql, sql

************** 已解决，但欢迎提供更好的答案！:) **************

我想从表 sc000 中获取 (sa003*sa004) 的总和，在此之前我必须检查其他表上是否存在项目。图片（某些表格具有相同的列格式）：

![在此处输入图像描述](../Images/797c497c682754ccc6bb288de51ba247.png)

我使用'IN'：

```
... WHERE s.sa002 IN (select b.b005 from b000 b where year(b.b001) = 2013 and month(b.b001) = 1) 
```

但这需要一个漫长的过程，所以我正在尝试使用“LEFT JOIN”：

```
 SELECT s.sa002, Sum(s.SA003) AS qty, Sum(s.SA003*s.SA004) AS jumlah
 FROM sc000 s LEFT JOIN
 (select bs.b005 from b000 bs where year(bs.b001) = 2013 and month(bs.b001) = 1) b
   on s.sa002 = b.b005 LEFT JOIN
 (SELECT ps.p005 from p000 ps where year(ps.p001) = 2013 and month(ps.p001) = 1 ) p
   on s.sa002 = p.p005 LEFT JOIN
 (SELECT js.b005 from j000 js where year(js.b001) = 2013 and month(js.b001) = 1 ) j
   on s.sa002 = j.b005 LEFT JOIN
 (SELECT rs.b005 from Rev00 rs where year(rs.b001) = 2013 and month(rs.b001) = 1) rv
   on s.sa002 = rv.b005 LEFt JOIN
 (SELECT es.b005 FROM R000 es where year(es.b001) = 2013 and month(es.b001) = 1) re
   on s.sa002 = re.b005
 where year(s.sa005) = 2013 and month(s.sa005) = 1
 and (b.b005 is not null or p.p005 is not null or rv.b005 is not null or j.b005 is not null or re.b005 is not null)
 GROUP BY s.sa002 
```

结果相乘。有什么帮助吗？:(

更新：我想要这样的结果（代码，来自 sc002 的数量，数量 * 价格）：

![在此处输入图像描述](../Images/2a3ca3573e9dc27132dacf43b012acdf.png)

^ 不检查其他表格。

然后，使用左连接，结果如下：

![在此处输入图像描述](../Images/19ade7d9a6a0c8d9da67506439d095cc.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T04:55:44.873

您的一个（或一些）联接没有以一对一的关系链接。最简单的检查方法是删除 group by 和 sum() 语句，并从 b、p、j、rv 和 re 表中包含一些列，如下所示：

```
SELECT s.sa002, s.SA003 AS qty, s.SA003*s.SA004 AS  jumlah, g.gName as gNames, 
 p.p005, j.b005, rv.b005, re.b005
 FROM sc000 s LEFT JOIN
 (select bs.b005 from b000 bs where year(bs.b001) = 2013 and month(bs.b001) = 1) b
   on s.sa002 = b.b005 LEFT JOIN
 (SELECT ps.p005 from p000 ps where year(ps.p001) = 2013 and month(ps.p001) = 1 ) p
   on s.sa002 = p.p005 LEFT JOIN
 (SELECT js.b005 from j000 js where year(js.b001) = 2013 and month(js.b001) = 1 ) j
   on s.sa002 = j.b005 LEFT JOIN
 (SELECT rs.b005 from Rev00 rs where year(rs.b001) = 2013 and month(rs.b001) = 1) rv
   on s.sa002 = rv.b005 LEFt JOIN
 (SELECT es.b005 FROM R000 es where year(es.b001) = 2013 and month(es.b001) = 1) re
   on s.sa002 = re.b005
 where year(s.sa005) = 2013 and month(s.sa005) = 1
 and (b.b005 is not null or p.p005 is not null or rv.b005 is not null or j.b005 is not null or re.b005 is not null)
ORDER BY s.sa002 
```

或者，甚至更好，

```
 SELECT s.sa002, count(*)
 FROM sc000 s LEFT JOIN
 (select bs.b005 from b000 bs where year(bs.b001) = 2013 and month(bs.b001) = 1) b
   on s.sa002 = b.b005 LEFT JOIN
 (SELECT ps.p005 from p000 ps where year(ps.p001) = 2013 and month(ps.p001) = 1 ) p
   on s.sa002 = p.p005 LEFT JOIN
 (SELECT js.b005 from j000 js where year(js.b001) = 2013 and month(js.b001) = 1 ) j
   on s.sa002 = j.b005 LEFT JOIN
 (SELECT rs.b005 from Rev00 rs where year(rs.b001) = 2013 and month(rs.b001) = 1) rv
   on s.sa002 = rv.b005 LEFt JOIN
 (SELECT es.b005 FROM R000 es where year(es.b001) = 2013 and month(es.b001) = 1) re
   on s.sa002 = re.b005
 where year(s.sa005) = 2013 and month(s.sa005) = 1
 and (b.b005 is not null or p.p005 is not null or rv.b005 is not null or j.b005 is not null or re.b005 is not null)
 GROUP BY s.sa002  
 HAVING count(*) > 1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T09:59:35.607

感谢所有看到或试图帮助解决这个问题的人。:D

我已经找到了查询！

我正在使用 UNION 加入 5 个表，并得到了我想要的答案。

# c - 从文件中读取 CVPoint

> ID：14845987
> 
> 赞同：-1
> 
> 时间：2013-02-13T03:37:09.773
> 
> 标签：c, opencv

我有兴趣从文件中读取 CvPoint* 类型的点，但我尝试了标准符号 (x,y)。当我尝试验证输出时，它给出了不正确的值。在文件中读取 CvPoint 的格式是什么。

点.txt

```
(1,1) 
```

主文件

```
points  = (CvPoint*)malloc(length*sizeof(CvPoint*));
points1 = (CvPoint*)malloc(length*sizeof(CvPoint*));
points2 = (CvPoint*)malloc(length*sizeof(CvPoint*));
fp = fopen(points.txt, "r");
fscanf(fp, "%d", &(length));
printf("%d  \n", length);
i = 1;
while(i <= length)
{
  fscanf(fp, "%d", &(points[i].x));
  fscanf(fp, "%d", &(points[i].y));
  printf("%d  %d \n",points[i].x, points[i].y);
  i++;
} 
```

它打印：

```
1

12  0 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T21:40:05.360

这是对文本文件使用相同格式的另一种方法：

```
#include <iostream>
#include <fstream>
#include <opencv2/core/core.hpp>

using namespace std;
using namespace cv;

int main(int argc, char* argv[]) {
    ifstream file("points.txt");
    string line;
    size_t start, end;
    Point2f point;
    while (getline(file, line)) {
         start = line.find_first_of("(");
     end = line.find_first_of(",");
     point.x = atoi(line.substr(start + 1, end).c_str());
     start = end;
     end = line.find_first_of(")");
     point.y = atoi(line.substr(start + 1, end - 1).c_str());
     cout << "x, y: " << point.x << ", " << point.y << endl;
    }
    return 0;
} 
```

# javascript - 点击事件中的“preventDefault”有什么用？

> ID：14845988
> 
> 赞同：-3
> 
> 时间：2013-02-13T03:37:12.917
> 
> 标签：javascript, preventdefault

您能否帮助我理解以下代码的作用：

```
var FluidNav = {
    init: function() {
        $("a[href*=#]").click(function(e) {
        e.preventDefault();
            if($(this).attr("href").split("#")[1]) {
                FluidNav.goTo($(this).attr("href").split("#")[1]);
            }
        });
        this.goTo("home");
    }, 
```

我很困惑为什么他们会在那里包含一个 preventDefault 。有任何想法吗？

编辑：

其余代码：

```
goTo: function(page) {
        var next_page = $("#"+page);
        var nav_item = $('nav ul li a[href=#'+page+']');
        $("nav ul li").removeClass("current");
        nav_item.parent().addClass("current");
        FluidNav.resizePage((next_page.height() + 40), true, function() {
             $(".page").removeClass("current"); next_page.addClass("current"); 
        });
        $(".page").fadeOut(500);
        next_page.fadeIn(500);

        FluidNav.centerArrow(nav_item);

    }, 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T03:38:11.623

```
$("a                 // select <a> elements 
[href*=#]")          // which have an href attribute that contains #
.click(function(e) { // and bind a click event handler 
```

当[`preventDefault()`](http://api.jquery.com/event.preventDefault/)单击链接时，它会阻止浏览器导航到新页面或跳转到同一页面中的不同位置。

> **说明：** *如果调用该方法，则不会触发事件的默认动作。*

# ios - 将其他视图拖到视图上时，是否有另一种方法来检测视图？

> ID：14845991
> 
> 赞同：3
> 
> 时间：2013-02-13T03:37:30.453
> 
> 标签：ios, uiview, uigesturerecognizer

我使用平移手势在拖动线中拖动多个视图，类似于：[iOS - 拖放碰撞检测如何检测您选择的项目何时拖动到另一个子视图上？](https://stackoverflow.com/questions/3947219/ios-drag-and-drop-collision-detection-how-to-detect-when-your-selected-item-dr)

我的代码：

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    for (UIView *aView in self.view.subviews) {
        [self addGestureRecognizersToPiece:aView];
    }
}

- (void)addGestureRecognizersToPiece:(UIView *)piece
{
    UIPanGestureRecognizer *panGesture = [[UIPanGestureRecognizer alloc] initWithTarget:self action:@selector(panPiece:)];
    [piece addGestureRecognizer:panGesture];
}

- (void)panPiece:(UIPanGestureRecognizer *)gestureRecognizer
{
    CGPoint dragingPoint = [gestureRecognizer locationInView:self.view];

    for (UIView *aView in self.view.subviews) {
        if (CGRectContainsPoint([aView frame], dragingPoint)) {
                aView.center = dragingPoint;
        }
    }

} 
```

我有这么多子视图，所以我不想循环 self.view 中的所有子视图，我只想检测拖动线中的匹配视图。怎么做？

如果我使用 [gestureRecognizer 视图]，我只会得到第一个视图。

提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-15T09:14:45.330

如果你只是想要更简单的代码，你可以使用 UIView 的`hitTest:withEvent:`方法在触摸位置找到视图：

```
- (void)panPiece:(UIPanGestureRecognizer *)gestureRecognizer
{
    CGPoint draggingPoint = [gestureRecognizer locationInView:self.view];
    UIView *hitView = [self.view hitTest:draggingPoint withEvent:nil];
    if (hitView.superview == self.view)
        hitView.center = draggingPoint;
} 
```

这假设子视图本身没有（交互式）子视图。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T07:34:47.917

你所拥有的是最好的（即最简单的）方法。除非您注意到性能问题，否则不要担心。

您可以进行一些改进：

1.  如果您只对某些视图感兴趣（您在拖动线上提到了那些，我不确定那是什么），那么在开始之前将这些视图添加到数组中，然后循环遍历该数组。
2.  找到目标后（使用 ）跳出循环`break;`。
3.  存储最后一次点击视图并首先检查 - 在很多情况下，它不会与上次调用该方法时发生变化。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-07-14T13:29:39.653

您可以通过使用来实现这一点 `CGRectIntersectsRect(<#CGRect rect1#>, <#CGRect rect2#>)`