# StackOverflow 问答 14342000-14342999

# ios - 是否可以在 iOS 设备上获取设备 iTunes 商店

> ID：14342019
> 
> 赞同：0
> 
> 时间：2013-01-15T16:17:38.827
> 
> 标签：ios, app-store, itunes

> **可能重复：**
> [如何链接到应用商店中的应用](https://stackoverflow.com/questions/433907/how-to-link-to-apps-on-the-app-store)

我对我的 iPhone 应用程序有特殊需求。我的应用程序上有一些内容链接到 iTunes 中的其他内容。当然，每个商店的 iTunes 元素的链接是不同的（包含 /us/ 或 /fr/ 或 /gb/ 等）。因此，为了向用户显示正确的链接（将他带到他的商店的链接，而不是错误：“不是好商店”），我需要该信息。我不想使用 CoreLocation。

事实上，我需要它，因为我正在从我的 API 中检索链接，并将国家代码发送到 API 以返回该国家/地区的正确链接。

谢谢，

**编辑**：就像我在下面的评论中所说，NSLocale 并不适合我。这是我正在使用的，但语言环境并不能准确地告诉用户用户在哪个商店。例如，我的电话设置为英语（美国），而我的商店是法语的。所以，我想要FR，而不是US。

**编辑 2**：我说的是电视节目，而不是应用程序（有一个可以在任何应用程序商店中打开的唯一链接）。这是一个例子，星际之门亚特兰蒂斯的飞行员：

FR 链接 => [https://itunes.apple.com/fr/tv-season/une-nouvelle-ere-1ere-partie/id370061110?i=370381192&uo=4](https://itunes.apple.com/fr/tv-season/une-nouvelle-ere-1ere-partie/id370061110?i=370381192&uo=4)

美国链接 => [https://itunes.apple.com/us/tv-season/rising-pts.-1-2/id260813591?i=261784660&uo=4](https://itunes.apple.com/us/tv-season/rising-pts.-1-2/id260813591?i=261784660&uo=4)

**编辑 3**：显然，新的 iOS 可以处理在本地商店中打开链接，即使该链接是针对另一个商店的。

但我仍然有一个问题，因为有些商品只能在一家商店买到。因此，如果没有精确的商店，我可能会向用户显示在他的本地商店中不可用的链接。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T16:28:08.493

尝试完全省略国家：p 认真

例如你有这个网址

> [https://itunes.apple.com/fr/tv-season/une-nouvelle-ere-1ere-partie/id370061110?i=370381192&uo=4](https://itunes.apple.com/fr/tv-season/une-nouvelle-ere-1ere-partie/id370061110?i=370381192&uo=4)

将其更改为简单

> [https://itunes.apple.com/tv-season/une-nouvelle-ere-1ere-partie/id370061110?i=370381192&uo=4](https://itunes.apple.com/tv-season/une-nouvelle-ere-1ere-partie/id370061110?i=370381192&uo=4)

只有当内容在用户主商店中不可用时，才会向您显示错误通知。

# node.js - 如何使用 Node.js 创建 RAM 磁盘？

> ID：14342024
> 
> 赞同：6
> 
> 时间：2013-01-15T16:18:00.180
> 
> 标签：node.js, ramdisk

无论底层操作系统是什么（应该支持 OS X、Linux 和 Windows），我都想使用 Node.js 以编程方式创建一个 RAM 磁盘。

实现这一目标的最佳方法是什么？

当然，我可以将命令作为子进程运行，但我需要为每个操作系统单独编写此代码。出于显而易见的原因，我想避免这种情况。

有没有更好的方法（即使是一个模块也可以）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-15T21:59:26.633

在像这样的低级和不常见的操作中，没有标准化的方法来生成 RAM 磁盘，它依赖于平台，因此在 NodeJS 中没有此功能并且不太可能，您必须编写扩展。在 Windows 中，它会调用 ramdisk.exe（不太熟悉），而在 Linux 上，它位于 下`/dev/shm`，您可以稍后通过挂载选项调整其大小。因此，最好的方法是为 Windows 版本找到最佳的外部程序，在 Linux 中只需`/dev/shm`像普通文件夹一样挂载和使用。

[有关 /dev/shm 的更多信息](http://www.cyberciti.biz/tips/what-is-devshm-and-its-practical-usage.html)

# mysql - 如何计算选择特定位置的人数？

> ID：14342026
> 
> 赞同：0
> 
> 时间：2013-01-15T16:18:02.977
> 
> 标签：mysql, sql

我在选择 sql 语句中需要帮助。

在我的 mysql 数据库中：

位置表

```
serialID(AI)|locations | telephone | address
---------------------------------------------
1           | A       
2           | B
3           | C
4           | D

users table
userID | location chosen
-------------------------
1      | A
2      | B
3      | B 
```

我想统计选择特定位置并显示在表格中的人数。因此，如果该特定位置有更多用户选择作为他们最喜欢的位置，它将向上移动到第一行。我可以知道我该怎么做吗？

当它填充到动态表中时是这样的 - >

```
location | address | telephone | user's favourable
B        |  -      | -         |  2
A        |  -      | -         |  1
C        |  -      | -         |  0
D        |   -     | -         |  0 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T16:20:57.817

你可以做这样的查询：

```
SELECT l.locations, l.telephone, l.address, COUNT (u.userID) as `location_count`
FROM location AS l
LEFT OUTER JOIN users AS u on l.locations = u.location_chosen
GROUP BY l.locations
ORDER BY `location_count` DESC 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T16:20:37.577

```
SELECT  loc.*, countResult.usersFavourable
FROM    location loc
        LEFT JOIN
        (
            SELECT  locationChoosen, COUNT(*) `usersFavourable`
            FROM    users
            GROUP BY    locationChoosen
        ) countResult ON loc.locations = countResult.locationChoosen
ORDER BY countResult.usersFavourable DESC, loc.locations 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T16:20:43.793

尝试这样的事情：

```
SELECT  l.location, l.address, l.telephone, COUNT(u.userID) AS [users favourable]
FROM    location l
        LEFT JOIN
            users u
            ON l.location = u.locationchosen
GROUP BY l.location, l.address, l.telephone 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-15T16:35:07.757

用这个：

```
select count(userId) count,locations,address,telephone 
from Table1 Left join Table2 
on Table1.locations = Table2.location

group by locations order by count desc ; 
```

看这里..[链接](http://sqlfiddle.com/#!2/7ea50/15/0)

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2013-01-15T16:20:12.600

```
 SELECT LocationChosen, Count(*) FROM usersTable GROUP BY LocationChosen 
```

# javascript - 在淘汰赛中删除子数组项

> ID：14342029
> 
> 赞同：1
> 
> 时间：2013-01-15T16:18:06.313
> 
> 标签：javascript, knockout.js

从一个可观察数组中删除一个项目的最佳方法是什么，该数组是另一个可观察数组本身的一个项目？让我举一个例子（简化）。

假设我有一个可观察的数组“聊天”：

```
self.chats = ko.observableArray(); 
```

这是我的聊天对象：

```
function chat(id, name, members) {
    this.id = id;
    this.name = name;
    this.members = ko.observableArray(members);
} 
```

这是成员对象：

```
function member(id, username) {
    this.id = id;
    this.username = username;
} 
```

我想从聊天数组中删除一个成员，但我只知道一个成员的 id，我对它所属的聊天一无所知。有没有比遍历所有`chat`项目（使用`ko.utils.arrayForEach`）和所有`member`项目并检查 id 更好的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T16:38:17.920

诚然，我对 knockout.js 不太熟悉，但是您是否可以向名为“聊天”的成员类添加一个新属性？

本质上，每次成员以某种方式与聊天相关联时，您都会使用聊天 ID 更新该属性，以便在执行需要来自聊天和成员对象的属性的操作时更轻松地链接两者。

如果您愿意，可以通过在构造函数中将其声明为变量，随意将聊天变成私有“属性”；这样，您只能通过您编写的任何 getter/setter 方法引用“聊天”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T16:55:13.793

您可以使用映射将成员 ID 映射到他们所在的任何聊天。即：

```
var memberMap = {};
...
//on add
if(!(memberId in memberMap){
    memberMap[memberId] = [chatRef]
}
else{
    memberMap[memberId].push(chatRef);
} 
```

然后，您将缓存对聊天对象的引用，以便您可以直接搜索这些成员列表。

### 更新

由于显然存在 1-1 成员聊天关系，因此成员映射代码可以看起来像这样

```
var memberMap = {};
...
//on add
    memberMap[memberId] = chatRef; 
```

# c# - RichtextBox 禁用自动格式化 Rtf

> ID：14342035
> 
> 赞同：1
> 
> 时间：2013-01-15T16:18:25.053
> 
> 标签：c#, formatting, rtf, richtext

当我更改 RichtextBox 中的 Rtf 属性时，它会再次自动格式化。我想避免这种情况，因为它会从颜色、字体和其他表格中删除项目。

```
"\b\b" -> "\b"
"\cf1 hello \cf3 world" -> color #2 in the color-table is getting deleted
//so that cf3 doesn't make any sense anymore 
```

我可以禁用此“自动格式化”吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T13:50:07.457

RTF 控件旨在通过`SelectionStart`和`SelectionLength`属性进行操作，然后是 rtf 属性，例如`SelectionColor = yada-yada-yada`. 要操作 RTF 数据，需要解析 RTF 字符串属性，而要正确识别 rtf 控制字符和 rtf 文本，以及保持字体和颜色索引同步，这充满了困难。

您的问题的答案是否定的，您不能从控件禁用自动生成 rtf 代码。

# jquery - 目的 ＃ 尝试清除地图时没有方法（Google Maps API V3）

> ID：14342037
> 
> 赞同：3
> 
> 时间：2013-01-15T16:18:31.553
> 
> 标签：jquery, google-maps, typeerror

我正在开发一个使用 Google Maps API V3 和 JQuery 的项目。基本上，程序根据用户选择的时间从数据库中调用项目，然后将这些项目作为标记显示在地图上。

到目前为止，它工作正常。我想在用户更改时间时清除标记，以免不相关的标记留在地图上。

但是，当我将该`clearLocations()`函数附加到任何 JQuery 时间选择元素时，它会引发错误：

> 对象# 没有方法'setMap'`。

这是调用时引发错误的 Google Maps 的 JavaScript：

```
function clearLocations() {
if (markers) {
    for (i in markers) {
    markers[i].setMap(null);
    }
    markers.length = 0;
    }
} 
```

这是移动滑块时调用它的 JQuery 函数：

```
function slideTime(event, ui){
            var val0 = $("#time-slider").slider("values", 0),
                val1 = $("#time-slider").slider("values", 1),
                chosenDate = Math.round(Date.parse($('#datepicker').datetimepicker('getDate')) / 1000),
                minrange = chosenDate + (val0 * 60),
                maxrange = chosenDate + (val1 * 60),
                timedifference = (maxrange - minrange)/60,
                fulldate = new Date(minrange * 1000),
                enddate = new Date(maxrange * 1000),
                fdate = fulldate.getDate(),
                fmonth = fulldate.getMonth()+1,
                fyear = fulldate.getFullYear(),
                edate = enddate.getDate(),
                emonth = enddate.getMonth()+1,
                eyear = enddate.getFullYear(),
                fhours = fulldate.getHours(),
                fminutes = fulldate.getMinutes(),
                ehours = enddate.getHours(),
                eminutes = enddate.getMinutes();
                if (fmonth < 10) {
                fmonth = "0" + fmonth; }
                if (fdate < 10) {
                fdate = "0" + fdate; }
                if (fhours < 10) {
                fhours = "0" + fhours; }
                if (fminutes < 10) {
                fminutes = "0" + fminutes; }
                if (emonth < 10) {
                emonth = "0" + emonth; }
                if (edate < 10) {
                edate = "0" + edate; }
                if (ehours < 10) {
                ehours = "0" + ehours; }
                if (eminutes < 10) {
                eminutes = "0" + eminutes; }

            $("#final-from-value").text(fdate + '/' + fmonth + '/' + fyear + ' ' + fhours + ':' + fminutes);
            $("#final-to-value").text(edate + '/' + emonth + '/' + eyear + ' ' + ehours + ':' + eminutes);
            $("#hidden-start").val(minrange);
            $("#hidden-finish").val(maxrange);

            clearLocations();
            searchMap();
        } 
```

我还有一个 datetimepicker，它也可以在更改时调用该函数：

```
<input id="datepicker" name="date" type="text" onchange="slideTime(); searchMap(); clearLocations()" /> 
```

我已经尝试了我能想到的一切，但老实说，我不知道在做什么。谢谢你的帮助。如果你还有什么需要看的，请告诉我。

**更新** 如果我不调用 searchMap() 函数，则没有错误，但是如果在清除它不喜欢的位置后调用 searchMap()。

这是 searchMap() 的代码

```
function searchMap() {
    //clearLocations();
    var getstart = $("#hidden-start").val();
    var getfinish = $("#hidden-finish").val();
  // Change this depending on the name of your PHP file
  downloadUrl("php/xml.php?start=" + getstart + "&finish=" + getfinish, function(data) {
    var xml = data.responseXML;
    markers = xml.documentElement.getElementsByTagName("marker");
    for (var i = 0; i < markers.length; i++) {
      var name = markers[i].getAttribute("title");
      var address = markers[i].getAttribute("url");
      var priority = parseInt(markers[i].getAttribute("priority"));
      var point = new google.maps.LatLng(
          parseFloat(markers[i].getAttribute("lat")),
          parseFloat(markers[i].getAttribute("lng")));
      var html = "<b>" + name + "</b> <br/>" + address;
      //var icon = customIcons[type] || {};
      var marker = new google.maps.Marker({
        map: map,
        position: point,
        zIndex: priority,
        icon: iconType[priority],
      });
      bindInfoWindow(marker, map, infoWindow, html);
    }
  });
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T16:22:35.343

看起来像是`markers`一个数组。所以用它来迭代标记

```
function clearLocations() {
    if (markers && markers.length) {
        for (var i = 0; i < markers.length; i++) {
             markers[i].setMap(null);
        }

        markers = [];
    }
} 
```

`for (var i in ...)`仅适用于**对象**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T16:21:43.673

我不知道你的`markers`变量中有什么，但试试这个：

```
for (i in markers) {
    if(!markers.hasOwnProperty(i)){continue;}
    markers[i].setMap(null);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-16T22:01:31.233

您的`markers`数组不包含`google.maps.Marker`它包含 XML 元素对象的类型的对象，因为这个`markers = xml.documentElement.getElementsByTagName("marker");`

# c# - 将 Entity Framework Linq 与存储过程混合

> ID：14342040
> 
> 赞同：3
> 
> 时间：2013-01-15T16:18:36.177
> 
> 标签：c#, linq, entity-framework, stored-procedures

是否可以在单个查询中混合使用 Linq to SQL 和存储过程的调用？

```
var query = from asset in this.Context.Assets
            let status =  this.Context.GetAssetAttributeLastStatusHistory(asset.idAsset)
            select new { asset, status }; 
```

像这样，`GetAssetAttributeLastStatusHistory`映射到存储过程的函数导入在哪里。

我想在 SQL 中而不是在内存中。在内存中，我可以为每个资产创建一个。

我需要执行分页和过滤，如果查询在 SQL Server 中执行，它的性能会更好。

编辑：此代码生成异常。 `Yes I did. I get an exception. LINQ to Entities does not recognize the method 'System.Data.Objects.ObjectResult.. GetAssetAttributeLastStatusHistory(System.Nullable1[System.Guid])' method, and this method cannot be translated into a store expression.`

据我所知，这是因为框架无法将该表达式转换为 SQL 表达式。

编辑2：

看来这是不可能的。在 RAW SQL 和 LINQ 中都不可能。感谢您的输入。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T16:45:12.210

试试看，让我知道我的答案是否正确。

```
var query = from asset in this.Context.Assets
            join status 
            this.Context.GetAssetAttributeLastStatusHistory(asset.idAsset) 
            on asset.Id equals status.Id into g
            from g.DefaultIfEmpty()
            select new { asset, status }; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T15:55:00.480

正如拉尔夫·希灵顿所说。不能将 EntityFramework Linq 与对 sprocs 的调用混合使用。

# java - 如何检测PDF是否在Java中压缩了外部参照表？

> ID：14342041
> 
> 赞同：1
> 
> 时间：2013-01-15T16:18:38.293
> 
> 标签：java, pdf, itext

[iText](http://itextpdf.com/)库中是否有可用的 API来检测 PDF 文件是否具有压缩的外部参照表？

[这个库的PDFReader](http://api.itextpdf.com/itext/com/itextpdf/text/pdf/PdfReader.html)类有一些关于外部参照的有用 API，但没有一个符合我的目的。

要求是：

1.  检查 PDF 是否有外部参照压缩表。
2.  如果 1 为真 -> 则“解压缩”外部参照表。
3.  发送字节流以进行进一步处理。
4.  处理完成后，将外部参照表“压缩”回其原始形式

在这方面的任何指针将不胜感激。

**PS：**实施不限于iText。可以使用任何其他可以实现它的 Java 库。许可（如果需要）也不是问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T07:56:32.040

事实证明，这已经在 iText 中得到支持。您需要创建一个`PdfReader`实例，然后使用`isNewXrefType()`.

要解压缩 PDF 文档的外部参照表，您可以使用以下方法：

```
public void uncompressXRef(String src, String dest)
    throws IOException, DocumentException {
    PdfReader reader = new PdfReader(src);
    PdfStamper stamper = new PdfStamper(reader, new FileOutputStream(dest));
    stamper.close();
    reader.close();
} 
```

要重新压缩外部参照表，请使用以下方法：

```
public void recompressXRef(String src, String dest)
    throws IOException, DocumentException {
    PdfReader reader = new PdfReader(src);
    PdfStamper stamper = new PdfStamper(reader, new FileOutputStream(dest));
    stamper.getWriter().setFullCompression();
    stamper.close();
    reader.close();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T17:48:57.207

您最好的选择可能是查看您还想对 PDF 做什么，然后使用该库。

# java - 比较不同文件夹中的文件

> ID：14342042
> 
> 赞同：0
> 
> 时间：2013-01-15T16:18:43.643
> 
> 标签：java, eclipse, diff, cvs

我正在使用 cvs（不是选择），我通过在 v2 分支中创建新的包层次结构来重构项目。现在我需要将分支 v1 中发生的更改合并到分支 v2 中。但是因为文件的路径发生了变化，我无法进行正常的比较。有没有办法在eclipse（或任何其他工具）中做到这一点？我一般都知道，仅使用文件名无法确定文件是否具有相同的来源；这对我来说不是问题，因为在我的情况下所有文件名都是唯一的。我知道我可以去手动选择这两个文件并做一个差异，但我有太多的类来使这可行。我正在寻找文件的自动配对，就像文件更改时工具自动检测差异一样

有没有人有任何其他建议可以在糟糕的 VCS 中进行这样的合并？

**更新：** 对我所做更改的一些解释可能会更清楚

```
v1
Folder1
   file1
   file2
   file3
   file4
   file5 
```

* * *

```
v2
FolderA
   file1
   FolderA1
      file2
      FolderA11
          file3
   FolderA2
      file4
FolderB
   file5 
```

因此，可以看出，动作中没有模式。它只是平面层次结构之前的全新层次结构。这意味着我不能做一个文件夹差异。我想要的是例如将 v1:folder1/file4 与 v2:FolderA/FolderA2/file4 配对的东西，这样我就可以看到内容的变化，而不用关心文件被移动的事实。换句话说，一个只使用文件名来匹配文件的无路径差异

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T16:28:59.937

我会下载两个分支并使用[http://winmerge.org/](http://winmerge.org/)之类的比较工具来比较本地目录。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T19:33:28.873

试试这个 shell 脚本片段：

```
ls -R /path/to/source1 | grep '.java\|.js\|.css' | grep -v ':$' >allfiles.txt
ls -R /path/to/source2 | grep '.java\|.js\|.css' | grep -v ':$' >>allfiles.txt
cat allfiles.txt | sort | uniq -d > same_files.txt
cat allfiles.txt | sort | uniq -u > different_files.txt

# This will compare the same files one-by-one
for i in `cat same_files.txt`; do 
    FILE1=`find /path/to/source1 -name $i`; 
    FILE2=`find /path/to/source2 -name $i`;
    diff -q $FILE1 $FILE2 
done 
```

诀窍在于`uniq`命令及其特殊开关。`-d`只留下重复的，`-u`整理出重复的。

要在 Windows 上运行，请使用`Cygwin`：[http ://www.cygwin.com/](http://www.cygwin.com/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-16T13:07:09.433

你可以试试我写的一个库。它可以比较2个文件夹的内容，给出真/假或它们之间的详细区别。（子文件夹也与其内容进行比较）

这是链接： [https ://badandmadstudio.wordpress.com/projects/dircompare-java/](https://badandmadstudio.wordpress.com/projects/dircompare-java/)

# python - Django中的NoReversematch错误

> ID：14342045
> 
> 赞同：0
> 
> 时间：2013-01-15T16:18:48.683
> 
> 标签：python, django

我想通过 id 获取一个对象，所以当用户点击标题时，它会将用户重定向到包含 id 对象的页面，我希望我的 url 链接是这样的：

```
 http://127.0.0.1:8000/cripme/12/53-places-to-go 
```

我尝试了以下代码，但出现此错误：

```
 NoReverseMatch at /view_list/
  Reverse for 'cripdetail' with arguments '(1L, u'53 places to go')' and keyword arguments '{}' not found. 
```

用户重定向视图：

```
def cripdetail(request,fimcrip_id, fimcrip_title):
    post=Fimcrip.objects.get(id=fimcrip_id) 
    return render_to_response('postme.html',{'post':post, 'Fimcrip':Fimcrip},context_instance=RequestContext(request)) 
```

网址：

```
url(r'^cripme/(?P<fimcrip_id>\d+)/(?P<fimcrip_title>[-\d\w]+)/$', 'meebapp.views.cripdetail', name='cripdetail'), 
```

模板：

```
<a href= "{% url cripdetail Flup.id Flup.title %}" >{{Flup.title}}</a> 
```

我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T16:26:02.893

你传递的是头衔，而不是蛞蝓。标题包含您的 URL 模式不接受的空格。你应该通过`flup.slug`。

# java - BEA-101362 - [context] 无法反序列化具有名称的作用域范围属性：“名称”

> ID：14342047
> 
> 赞同：2
> 
> 时间：2013-01-15T16:18:50.357
> 
> 标签：java, deserialization, weblogic-10.x

我在 WebLogic Server 版本：10.3.5.0 上的属性反序列化有问题。它引发错误 BEA-101362，我发现它被注释为：http: [//iderror.com/errors/oracle/weblogic-103/wl103-http/bea-101362-context-could-not-deserialize-the-scope -scoped-attribute-with-name-name/](http://iderror.com/errors/oracle/weblogic-103/wl103-http/bea-101362-context-could-not-deserialize-the-scope-scoped-attribute-with-name-name/)其中指定：

类加载器已更改。发生这种情况时，旧的属性将使用新的类加载器反序列化。类加载器可以由于类的动态重新加载（由 weblogic.xml 参数“reload-check-secs”控制）或跨 webapp 调度（包含/转发）而改变。

第一种情况“动态重新加载”不是我的问题，这个错误每次都会发生，包括在 servlet 重新启动后立即发生。奇怪的是，相同的代码在 WepSphere 应用服务器甚至旧服务器版本“WebLogic Server 版本：10.3.2.0”上运行没有问题。

有没有人对这个反序列化问题有类似的经验？

# eclipse - 从eclipse启动时Tomcat无法访问

> ID：14342050
> 
> 赞同：0
> 
> 时间：2013-01-15T16:18:59.473
> 
> 标签：eclipse, tomcat

我刚刚在 Windows 7 上安装了 eclipse 和 tomcat。我使用了最新版本。

对于 Eclipse，[http://www.eclipse.org/downloads/download.php? file=/technology/epp/downloads/release/juno/SR1/eclipse-jee-juno-SR1-win32-x86_64.zip](http://www.eclipse.org/downloads/download.php?file=/technology/epp/downloads/release/juno/SR1/eclipse-jee-juno-SR1-win32-x86_64.zip)

对于 tomcat， http: [//ftp.unicamp.br/pub/apache/tomcat/tomcat-7/v7.0.34/bin/apache-tomcat-7.0.34-windows-x64.zip](http://ftp.unicamp.br/pub/apache/tomcat/tomcat-7/v7.0.34/bin/apache-tomcat-7.0.34-windows-x64.zip)（不是服务版本）。

当我运行tomcat的startup.bat时，它可以正常启动，我可以从浏览器的8080端口访问它。

但是我在eclipse中添加了它，当我从eclipse启动它时，它报告“已启动，已同步”，并且没有显示错误消息，但显示错误页面“HTTP Status 404 - /”。

如果我在 Eclipse 中关闭它并运行它的 startup.bat，我可以再次从浏览器访问它。

Eclipse 根本没有要设置的配置，我只是指向 tomcat 的安装路径。

我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T16:27:17.077

如果在以下位置出现错误或异常，请尝试检查服务器日志：

```
.metadata\.plugins\org.eclipse.wst.server.core\tmp0\ 
```

在您的 Eclipse 工作空间元数据目录中。无论如何，应该在eclipse IDE中向控制台报告一些失败原因（异常）或服务器报告正确启动，例如：

```
5.1.2013 17:24:25 org.apache.coyote.http11.Http11Protocol start
INFO: Starting Coyote HTTP/1.1 on http-8080
15.1.2013 17:24:25 org.apache.jk.common.ChannelSocket init
INFO: JK: ajp13 listening on /0.0.0.0:8009
15.1.2013 17:24:25 org.apache.jk.server.JkMain start
INFO: Jk running ID=0 time=0/22  config=null
15.1.2013 17:24:25 org.apache.catalina.startup.Catalina start
INFO: Server startup in 9121 ms 
```

在这种情况下，请检查您的 servlet 映射并检查您的 url 根上下文是否正确。

# drools - Drools 规则可以有多重继承吗

> ID：14342054
> 
> 赞同：6
> 
> 时间：2013-01-15T16:19:10.143
> 
> 标签：drools, multiple-inheritance, rules

我是 drools 的新手，并且熟悉使用 extends 关键字来继承规则。问题有没有办法继承多个规则？这类似于在 java 类上使用多个接口。这是我希望它如何工作的示例，但我在规则 3 上遇到错误：

```
rule "rule 1"
when //person name == "John"
then //print "John"
end

rule "rule 2"
when //person last name == "Smith"
then //print "Smith"
end

rule "rule 3" extends "rule 1", "rule 2"
when //person age > 20
then //print John Smith is older than 20
end 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-11-16T21:02:20.253

它还没有得到很好的记录，但是单继承确实存在于drools中。它允许您创建扩展另一个规则的规则。当且仅当超级规则和子规则的条件都为真时，子规则才会触发。（见底部我的笔记）。

在下面的示例中，“Flags”是一个带有 2 个布尔值的简单 Java 类：isSuperTrue 和 isSubTrue。神奇的短语**将“super”扩展**为“sub”规则定义的一部分。规则的名称（sub 和 super）是说明性的，可以更改为任何合法的规则名称。

```
rule "super" 
    @description("Fires when isSuperTrue is true regardless of the state of isSubTrue")
    when
        $flag : Flags(isSuperTrue == true)
    then
        System.out.println("super rule should fire anytime super is true and ignore sub");
end

rule "sub" extends "super"
    @description("Fires only when both isSubTrue and isSuperTrue are true")
    when
        Flags(isSubTrue == true)        
    then
        System.out.println("sub rule should fire when both isSubTrue and isSuperTrue are true");
end 
```

注 1：5.5.0.Final 中存在一个[问题](https://issues.jboss.org/browse/DROOLS-330)，要求在规则定义文件中将超级规则放在子规则之前。我已确认该错误已针对 5.6.0.CR1 进行了修复。

注意 2：此功能间接记录在5.5.0.Final的[发行说明中，在第 4.1.1.3 节中。](http://docs.jboss.org/drools/release/5.5.0.Final/droolsjbpm-introduction-docs/html_single/index.html#releaseNotes_5.5.0)核心主题是“条件命名后果”，但它利用了规则继承。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-03-30T16:44:47.503

我知道这个线程很旧，但可以执行以下操作：

```
rule "first name is John rule"
    when
        $p : Person(  name == 'John' )
    then
end

rule "last name is Smith rule" extends "first name rule"
    when
        eval( $p.getLastName() == "Smith" )
    then
end

rule "age older than 20 rule" extends "last name rule"
    when
        eval ( $p.getAge() > 20 )
    then
        System.out.println($p.getFirstName() + " " + $p.getLastName() +
                " is older than 20");
end

rule "age younger than 20 rule" extends "last name rule"
    when
        eval ( $p.getAge() < 20 )
    then
        System.out.println($p.getFirstName() + " " + $p.getLastName() +
                " is younger than 20");
end 
```

如您所见，您可以从继承其声明变量的超级规则创建链式规则。

# templates - 在 Sphinx 的目录中列出函数

> ID：14342056
> 
> 赞同：4
> 
> 时间：2013-01-15T16:19:19.683
> 
> 标签：templates, python-sphinx, tableofcontents

如何列出函数、类等...以显示在 Sphinx 的目录中？

或者，更一般地说，如何将页面中的任意条目（不是字幕）添加到目录中？

顺便说一句：我没有记录 Python 代码，所以我不能使用 autodoc 工具。

**编辑**

我尝试了指令`.. contents:: name`，但这似乎是为了放置一个 ToC，而不是定义一个条目。

**编辑：部分解决方案**

`basic/localtoc.html`我将模板复制到我的`_templates`目录中。

`{{ pagename }}`给出当前文件的路径并让我包含一个文件，这样我就可以将它们组合起来，并在运行`{% include filename %}`时为每个文件生成我自己的目录。`conf.py`我会试试这个，但有更自动的解决方案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-12-01T09:03:00.777

我倾向于在 API 文档中将成员分为公共和私有部分，因此我希望它们出现在 TOC 层次结构中。我改编了@viblo 和@ramcdougal 的解决方案来实现这一点。

这是我的`_static/apitoc.js`：

```
// Inject API members into the TOC in the sidebar.
// This should be loaded in the localtoc.html template.

$(function (){
    $('div.section').each(function(index) {
        var $section = $(this),
            $tocitem = $('.sphinxlocaltoc li:has(> a.reference.internal[href="#' + 
                         $section.attr('id') +
                         '"])');
            $members = $('<ul>').appendTo($tocitem);
        $('> dl > dt', $section).each(function(index) {
            var $member = $(this),
                $tocMember = $('<li class="api-member">');
            $tocMember.text($('.property', $member).text() + ' ');
            $tocMember.append('<a href="#' + $member.attr('id') + '">' + 
                              $('.descname', $member).text() + 
                              '</a>');
            $members.append($tocMember);
        });
    });
}); 
```

这是`_templates/localtoc.html`：

```
<h3><a href="{{ pathto(master_doc) }}">{{ _('Table Of Contents') }}</a></h3>
{%- if display_toc %}
  {{ toc }}
  <div class="custom-index container">
    <script type="text/javascript" src={{ pathto(master_doc)[:-10] + '_static/apitoc.js' }}></script>
  </div>
{%- endif %} 
```

结果如下所示：

* * *

### 页面内容

mypackage.mymodule

*   公共 API
    *   类[MyPublicClass](https://stackoverflow.com/questions/14342056/list-functions-in-table-of-contents-in-sphinx)
    *   类[AnotherPublicClass](https://stackoverflow.com/questions/14342056/list-functions-in-table-of-contents-in-sphinx)
    *   [my_public_function](https://stackoverflow.com/questions/14342056/list-functions-in-table-of-contents-in-sphinx)
*   私有 API
    *   类[MyPrivateClass](https://stackoverflow.com/questions/14342056/list-functions-in-table-of-contents-in-sphinx)
    *   [my_private_function](https://stackoverflow.com/questions/14342056/list-functions-in-table-of-contents-in-sphinx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-19T06:09:48.880

与其创建大量单独的模板，不如创建一个模板，该模板使用 javascript 在加载时填充目录中的额外条目。

我可以将[Toc/list 中的 viblo 脚本与 sphinx 文档](https://stackoverflow.com/questions/12150491/toc-list-with-all-classes-generated-by-automodule-in-sphinx-docs)中的 automodule 生成的所有类一起使用，这些类动态生成`Classes`、`Functions`和`Variables`.

我的`_templates/localtoc.html`然后变成：

```
<h3><a href="{{ pathto(master_doc) }}">{{ _('Table Of Contents') }}</a></h3>
{%- if display_toc %}

  {{ toc }}
{%- endif %}
<div class="custom-index container">
<script type="text/javascript" src={{ pathto(master_doc)[:-10] + '_static/pymunk.js' }}></script>

</div> 
```

# r - 渐变阴影置信区间

> ID：14342060
> 
> 赞同：19
> 
> 时间：2013-01-15T16:19:37.233
> 
> 标签：r, graph, ggplot2

我想即兴创作与密度成正比的回归图阴影。例如，置信区间窄则阴影浓，而置信区间宽则填充颜色浅。结果图可能如下所示：

![在此处输入图像描述](../Images/fd66f4e48c9d8b5dddbbefa09b72c94a.png)

这是一个工作示例：

```
set.seed(1234)
md <- c(seq(0.01, 1, 0.01), rev(seq(0.01, 1, 0.01)))
cv <-  c(rev(seq(0.01, 1, 0.01)), seq(0.01, 1, 0.01))
rv <- rnorm (length(md), 0.1, 0.05)

 df <- data.frame(x =1:length(md),  F = md*2.5 + rv, L =md*2.5 -rv-cv, U =md*2.5+ rv+ cv)
 plot(df$x, df$F, ylim = c(0,4), type = "l")

 polygon(c(df$x,rev(df$x)),c(df$L,rev(df$U)),col = "cadetblue", border = FALSE)
 lines(df$x, df$F, lwd = 2)
 #add red lines on borders of polygon
 lines(df$x, df$U, col="red",lty=2)
 lines(df$x, df$L, col="red",lty=2) 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-15T17:08:43.287

包中的`densregion()`命令`denstrip`似乎可以满足您的要求。对其帮助页面中的示例进行了一些修改：

```
require(denstrip)
x <- 1:10
nx <- length(x)
est <- seq(0, 1, length=nx)^3
se <- seq(.7,1.3,length.out=nx)/qnorm(0.975)
y <- seq(-3, 3, length=100)
z <- matrix(nrow=nx, ncol=length(y))
for(i in 1:nx) z[i,] <- dnorm(y, est[i], se[i])
plot(x, type="n", ylim=c(-3, 3),xlab="")
densregion(x, y, z)
lines(x,est,col="white") 
```

![在此处输入图像描述](../Images/c3a1fee49addd55ad87e06dabf781dc3.png)

# vb.net - 如何在不包含 vb.net 中的系统/隐藏文件的情况下获取目录的内容？

> ID：14342062
> 
> 赞同：0
> 
> 时间：2013-01-15T16:19:46.773
> 
> 标签：vb.net, file

我想将目录的内容作为数组获取，不包括系统/隐藏文件和文件夹。 `FileSystem.GetDirectories(path)`并`FileSystem.GetFiles(path)` 返回路径中包含的所有文件。那么如何从中排除系统/隐藏文件呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-07-11T14:08:36.917

我知道这是一个老问题，但这里有解决方案！

```
FileSystem.GetFiles(path).Where(Function(file) ((file.Attributes And FileAttributes.Hidden) <> FileAttributes.Hidden) AndAlso (file.Attributes And FileAttributes.System) <> FileAttributes.System) 
```

我刚刚根据您要求的两个标志检查了所有文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T17:08:04.597

试试这个，你将不得不修改 linq 查询或直接使用目录信息对象

```
Dim root As String = "X:\" 

        'Take a snapshot of the folder contents 
        Dim dir As New System.IO.DirectoryInfo(root)

        Dim fileList = dir.GetFiles("*.*", System.IO.SearchOption.AllDirectories)

        ' This query will produce the full path for all .txt files 
        ' under the specified folder including subfolders. 
        ' It orders the list according to the file name. 
        Dim fileQuery = From file In fileList _
                        Where file.Extension = ".txt" and file.Length >1645 _
                        Order By file.Length _
                        Select file 
```

# c++ - odeint 中的重复 delta 函数

> ID：14342063
> 
> 赞同：1
> 
> 时间：2013-01-15T16:19:49.323
> 
> 标签：c++, odeint

我有以下 odeint 程序：

```
#include <boost/array.hpp>
#include <boost/numeric/odeint.hpp>
using namespace std;

typedef boost::array< double , 1 > state_type;

void eqsystem(const state_type &x, state_type &dxdt, double t) {
    dxdt[0] = 3;
}

void write_system( const state_type &x , const double t ) {
    cout << t << '\t' << x[0] << endl;
}

int main(){
    double t0=0, t1=100;
    double tstep0=0.01;
    state_type x = {{ 0 }};
    cout<<"t\tValue"<<endl;
    boost::numeric::odeint::integrate( eqsystem , x , t0 , t1 , tstep0 , write_system );
} 
```

每次`t`都是 10 的倍数，我想设置`x[0]=0.1`.

也就是说，我想要一个重复的 delta 函数。

或者，如果我可以让 delta 函数出现在有限数量的时间点，我将能够近似递归。

不幸的是，我无法在 odeint 中找到 delta 函数的文档。有谁知道如何实现这一目标？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T17:07:14.497

这在 odeint 中是不可能的，至少在一般情况下是不可能的。您有两种选择：

首先用非常尖锐的高斯函数来近似 delta 峰值。

第二，整合到峰值的时间点。应用增量峰值，即在现有解决方案中添加一个步骤，然后从该点开始积分到下一个峰值，依此类推。

There are als "exotic" methods for ODEs with discontinuities, but they usually treat the case when you ODE itself has discontinuities and not your external driving.

# c# - 通过id获取html内部文本

> ID：14342066
> 
> 赞同：1
> 
> 时间：2013-01-15T16:19:51.773
> 
> 标签：c#, windows-phone-8

我想从下班获得内部文本甚至更好的内部HTML `li`。

在普通桌面版本中它可以工作。

![http://i.imgur.com/Q6Te5.png](../Images/25f44e2ba2b8e7c69f6733039ab71373.png)

但是相同的代码在 WP8 上不起作用，因为 wp8 没有所有功能。我在整个互联网上搜索，我发现只是桌面代码或不起作用的代码。

```
HtmlElement e1 = webBrowser1.Document.GetElementById(textBox2.Text);
string content = e1.InnerText;
textBox1.Text = content; 
```

有一个 HTML 表单，我想得到相同的结果，就像我用 c# 的“桌面”版本得到的一样

```
<li id="ContentHolderMain_ContentHolderMainContent_ContentHolderMainContent_lstvAlphabet_listRestaurants_0_lstvRestaurant_0_liItem_0" class="restaurantItem" sssp:rs="2;7;8;10;" sssp:rl="Ljubljana" sssp:rn=""Celica hostel"">

    <div class="name">
        <h1>
        <h2>(Metelkova 8, Ljubljana)</h2>
        <span class="blocked"></span>
        <span class="blocked"> </span>
    </div>
    <div class="breaker"></div>
    <div class="prices">
        <p>
            <span>Vrednost doplacila:</span>
            <strong>3,15 EUR</strong>
        </p>
        <p>
            <span>Vrednost obroka:</span>
            <strong>5,78 EUR</strong>
        </p>
    </div>
    <div class="features">
        <img id="ContentHolderMain_ContentHolderMainContent_ContentHolderMainContent_lstvAlphabet_listRestaurants_0_lstvRestaurant_0_lstvFeatures_0_imgFeature_0" title="Celiakiji prijazni obroki" alt="Celiakiji prijazni obroki" src="/App_Themes/SOS/images/icncoeliac.png">
        <img id="ContentHolderMain_ContentHolderMainContent_ContentHolderMainContent_lstvAlphabet_listRestaurants_0_lstvRestaurant_0_lstvFeatures_0_imgFeature_1" title="Solatni bar" alt="Solatni bar" src="/App_Themes/SOS/images/icnsaladbar.png">
        <img id="ContentHolderMain_ContentHolderMainContent_ContentHolderMainContent_lstvAlphabet_listRestaurants_0_lstvRestaurant_0_lstvFeatures_0_imgFeature_2" title="Stalen arhitektonsko prilagojen dostop za invalide in dostop do mize v notranjosti lokala ter do toalete prilagojene za invalide" alt="Stalen arhitektonsko prilagojen dostop za invalide in dostop do mize v notranjosti lokala ter do toalete prilagojene za invalide" src="/App_Themes/SOS/images/icnwheelchairwc.png">
        <img id="ContentHolderMain_ContentHolderMainContent_ContentHolderMainContent_lstvAlphabet_listRestaurants_0_lstvRestaurant_0_lstvFeatures_0_imgFeature_3" title="Kosila" alt="Kosila" src="/App_Themes/SOS/images/icnlunch.png">
    </div>
    <div class="breaker"></div>
</li> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T21:59:34.960

您将无法使用 WebBrowser 控件执行此操作，但如果您只需要检索 HTML 元素上的内容，则可以使用普通 WebRequest 检索 HTML，然后使用[Html Agility Pack](http://htmlagilitypack.codeplex.com/)解析 HTML。

# android - 如何挂载加密的APK扩展文件？

> ID：14342068
> 
> 赞同：5
> 
> 时间：2013-01-15T16:19:57.420
> 
> 标签：android, apk-expansion-files

我尝试以这种方式挂载扩展文件：

```
 final StorageManager storageManager = (StorageManager) getSystemService(STORAGE_SERVICE);
    String obbPath = Environment.getExternalStorageDirectory() + "/Android/obb";
    final String obbFilePath = obbPath + "/com.example/main.1.com.example.obb";
    storageManager.mountObb(obbFilePath, "SecretKey", new OnObbStateChangeListener() {
        @Override
        public void onObbStateChange(String path, int state) {
            super.onObbStateChange(path, state);
            if (state == OnObbStateChangeListener.MOUNTED) {
                onObbMounted();
            } else {
                Log.d("##", "Path: " + path + "; state: " + state);
            }
        }
    }); 
```

但在运行时我得到状态 21: ERROR_COULD_NOT_MOUNT:

```
Path: /storage/sdcard0/Android/obb/com.example/main.1.com.example.obb; state: 21 
```

我已经添加了这个：

```
 File f = new File(obbFilePath);
    if (!f.exists()) {
        Log.e("OBB", "FILE NOT FOUND!!!");
    } 
```

logcat 说该文件存在。我不知道，为什么我可以得到这个状态 21？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-19T15:49:12.780

我遇到了同样的问题，我发现很多时候`Error 21`是由 Linux 文件权限对 obb 造成的，问题是 Android 无法访问它，所以`StorageManager`启动`Error 21`. 创建 .obb 文件时，更改文件的权限和用户组，如下所示：

```
$chmod 664 <obb-filename>.obb    
$chown user:group <obb-filename>.obb 
```

然后再试一次，为我工作。

# c# - 将 int 保存到可为空的 int 列中

> ID：14342070
> 
> 赞同：0
> 
> 时间：2013-01-15T16:20:02.430
> 
> 标签：c#, asp.net

我试图仅在有值时将整数保存到可为空的 int 列中

```
if (user.AssociationID != 0)
{
   int? AssociationID = user.AssociationID;
   currentUser.AssociationID == AssociationID;
} 
```

我已经尝试将 currentUser 封装成一个 int`(int?)currentUser.AssociationID`

我知道这必须非常简单。我已经用谷歌搜索了问题的标题，但没有找到我需要的结果。客气点，我是菜鸟。

**我得到的错误：** 只有赋值、调用、递增、递减和新对象表达式可以用作语句

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-15T16:22:05.910

```
currentUser.AssociationID == AssociationID; 
```

应该

```
currentUser.AssociationID = AssociationID; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T16:38:54.363

怎么样

```
if (user.AssociationID != null)
{
   int? AssociationID = user.AssociationID;
   currentUser.AssociationID = AssociationID;
} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-01-15T16:22:29.043

使用 .HasValue 和价值。

```
if (user.AssociationID.HasValue)
{
   currentUser.AssociationID = user.AssociationID.Value;
} 
```

# php - PHP onchange（）javascript不起作用

> ID：14342072
> 
> 赞同：0
> 
> 时间：2013-01-15T16:20:06.750
> 
> 标签：php, javascript

我有一个 PHP 表单，在其中我使用 java 脚本从日历中获取出生日期值，然后我编写了一个 onchange java 脚本来从文本框的值计算年龄并将其显示在另一个文本框中.. 但是 onchange 函数不起作用...

这是文本框代码，用于从我从某个站点下载的外部 JavaScript 从日历中获取出生日期..这很好..它在文本框中显示从日历中选择的日期..

```
<input id="birthdate" name="birthdate" type="text" size="12" maxlength="10" readonly="readonly" onChange="UpdateAge();"  />
                                                <script language="JavaScript">
    new tcal ({
        // form name
        'formname': 'reg',
        // input name
        'controlname': 'birthdate'
    }); 
```

这是计算年龄的功能..

```
 <script type="text/javascript">
    function UpdateAge(){
  var bdate = document.getElementById('birthdate').value;
  var cdate = date('d-m-Y');
  var info = (strtotime($cdate)-strtotime($bdate))/(24*60*60*365); 
  alert("hi");
  document.getElementById('age').value = info;
}
</script> 
```

但是第二个文本框没有任何变化..这是第二个文本框的代码..

```
<input name="age" type="text" id="age" size="5" maxlength="2"  /> 
```

请帮我解决..提前谢谢..

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T16:24:16.623

```
(strtotime($cdate)-strtotime($bdate)) 
```

**这不是 Javascript 代码**。您必须找到一个可以执行与 PHP 相同处理的库`strtotime`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-15T16:24:09.463

函数`UpdateAge()`有 PHP 代码

```
(strtotime($cdate)-strtotime($bdate))/(24*60*60*365); 
```

这是无效的 JS，所以我不会在客户端上工作。PHP在服务器上运行，JS在客户端上运行。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-15T16:51:33.007

strtotime 之前说过 strtotime 不是 javascript 函数。这是一个PHP函数。看看 Date 对象及其解析方法：[http ://www.w3schools.com/jsref/jsref_parse.asp](http://www.w3schools.com/jsref/jsref_parse.asp)

# python - OpenGL在列表中给出三角形颜色

> ID：14342074
> 
> 赞同：0
> 
> 时间：2013-01-15T16:20:15.877
> 
> 标签：python, opengl, pyopengl

我在 python/PyOpenGL 中工作，但是这些调用基本上直接映射到 OpenGL 本身，所以我正在寻求任何知道的人的帮助。

我有一个大型 3D 系统，我自己将其分解为多个方面。我对代码的第一次尝试看起来像这样：

```
from OpenGL.GL import *

def render(facets):
  for facet in facets:
    glColor( facet['color'] )
    glBegin(GL_TRIANGLES)
    for v in facet['vertices']:
      glVertex(v)
    glEnd() 
```

即我一次一个地遍历python对象，并分别绘制它们。渲染的颜色被设置*为每个 facet*，即每个三角形，作为三角形的表面颜色。

在调试了以这种方式生成构面的代码后，我想使用原生 OpenGL 列表更快地呈现它们，如下所示（基于 pyglet 的源代码片段）：

```
def build_compiled_gllist(vertices, facets):
  """this time, the vertices must be specified globally, and referenced by
  indices in order to use the list paradigm. vertices is a list of 3-vectors, and
  facets are dicts containing 'normal' (a 3-vector) 'vertices' (indices to the 
  other argument) and 'color' (the color the triangle should be)."""

  # first flatten out the arrays:
  vertices = [x for point in vertices for x in point]
  normals = [x for facet in facets for x in facet['normal']]
  indices = [i for facet in facets for i in facet['vertices']]
  colors = [x for facet in facets for x in facet['color']]

  # then convert to OpenGL / ctypes arrays:
  vertices = (GLfloat * len(vertices))(*vertices)
  normals = (GLfloat * len(normals))(*normals)
  indices = (GLuint * len(indices))(*indices)
  colors = (GLfloat * len(colors))(*colors)

  # finally, build the list:
  list = glGenLists(1)
  glNewList(list, GL_COMPILE)

  glPushClientAttrib(GL_CLIENT_VERTEX_ARRAY_BIT)
  glEnableClientState(GL_VERTEX_ARRAY)
  glEnableClientState(GL_NORMAL_ARRAY)
  glEnableClientState(GL_COLOR_ARRAY)
  glVertexPointer(3, GL_FLOAT, 0, vertices)
  glNormalPointer(GL_FLOAT, 0, normals)
  glColorPointer(3, GL_FLOAT, 0, colors)
  glDrawElements(GL_TRIANGLES, len(indices), GL_UNSIGNED_INT, indices)
  glPopClientAttrib()

  glEndList()

  return list

def run_gl_render(render_list):
  """trivial render function"""
  glCallList(render_list) 
```

但是，我的颜色完全错误。刻面被分组到对象中，并且在一个对象内，所有的刻面颜色应该是相同的；相反，它们似乎是完全随机的。

查看其他示例，似乎这个颜色数组是*per-vertex*而不是*per-facet*。这有什么意义？顶点是根据定义不能渲染的点——刻面是渲染的和有颜色的！我系统中的每个顶点都在两个方面集合/对象之间共享，因此它的名称应该有两种颜色。

有人请澄清这些数据应该如何构造；我显然误解了我正在使用的模型。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T17:16:03.883

是的，颜色是按顶点指定的。根据阴影模型，只能使用其中一种颜色，但每个顶点仍会获得一种颜色。如果您替换，您的代码应该可以工作

```
colors = [x for facet in facets for x in facet['color']] 
```

和

```
colors = [x for facet in facets for x in facet['color']*3] 
```

复制每个顶点的颜色。如果您的普通数据是按人脸计算的，那么您必须对普通数据执行相同的操作。另请注意，颜色和法线值必须与顶点参数匹配，而不是索引。

顺便说一句，您仍然可以使用原始代码创建显示列表。也就是说，这样做是完全有效的

```
def compile_object(facets):
  displist = glGenLists(1)
  glNewList(displist, GL_COMPILE)
  # You can call glColor inside of glBegin/glEnd, so I moved them
  # outside the loop, which might improve performance somewhat
  glBegin(GL_TRIANGLES)
  for facet in facets:
    glColor( facet['color'] )
    for v in facet['vertices']:
      glVertex(v)
  glEnd()
  glEndList()
  return displist 
```

试试这些教程

*   [显示列表](http://www.songho.ca/opengl/gl_displaylist.html)
*   [顶点数组](http://www.songho.ca/opengl/gl_vertexarray.html)

# spring - Vaadin 不同步时不调用 getSystemMessages

> ID：14342080
> 
> 赞同：0
> 
> 时间：2013-01-15T16:20:31.163
> 
> 标签：spring, error-handling, synchronization, vaadin

我想自定义不同步消息，如下所示：[https ://vaadin.com/book/vaadin7/-/page/application.errors.html](https://vaadin.com/book/vaadin7/-/page/application.errors.html)

我有：

```
public class SpringApplicationServlet extends AbstractApplicationServlet {
...
@Override
protected SystemMessages getSystemMessages() {
  logger.debug("getSystemMessages()");
  CustomizedSystemMessages m = new CustomizedSystemMessages();
  m.setOutOfSyncCaption("My custom caption");
  return m;
}
... 
```

我清楚地看到 getSystemMessages() 没有被调用，但是在使用多个窗口时会显示带有标题“不同步”的红色通知。Vaadin的书说

> 您可以通过在 UI 类中实现 getSystemMessages() 方法来覆盖默认系统消息。

我怎么知道要覆盖哪个类`getSystemMessages()`？`SpringApplicationServlet`似乎是最合适的

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T16:35:03.350

根据[https://vaadin.com/api/com/vaadin/Application.html#getSystemMessages](https://vaadin.com/api/com/vaadin/Application.html#getSystemMessages) 该方法应该在扩展的类中实现`Application`

所以现在它起作用了：

```
public class MainApplication extends Application {
...
  @Override
  public static SystemMessages getSystemMessages() {
  ... 
```

尽管 Java 不允许覆盖静态方法，但 Vaadin 会产生异常并调用此方法（如果存在）。

# android - 如何设置作为 Horizo ntalScrollView 的子项的 LinearLayout（带有 7 个 TextView 元素）的宽度，以便一次只能看到 4 个？

> ID：14342084
> 
> 赞同：0
> 
> 时间：2013-01-15T16:20:40.033
> 
> 标签：android, android-layout, horizontalscrollview

我在 Horizo​​ntalScrollView 中有一个 LinearLayout（带有 7 个 TextView 元素）。Horizo​​ntalScrollView 设置为 fillViewport。我希望一次只有 4 个 TextView 元素可见。用户可以滚动查看其余部分。

**案例 1：** 我可以使用 layout_weight 获得所需的布局，但是我无法滚动，如附件代码所示。我假设滚动不起作用，因为权重是在 GUI 渲染之后计算的，因此 Horizo​​ntalScrollLayout 的宽度不会改变。是对的吗？

**案例2：** 如果我固​​定宽度，例如“60dp”，那么它会根据需要显示并且我也可以滚动。但是，这不适用于其他屏幕尺寸。

如何以适用于不同屏幕尺寸的方式实现此效果。

这是**案例 1**的代码。

布局：

```
 <LinearLayout
        android:layout_width="wrap_content"
        android:layout_height="match_parent"
        android:orientation="horizontal" 
        android:weightSum="7">

        <TextView
            style="@style/ViewStyle"
            android:text="1" />

        <TextView
            style="@style/ViewStyle"
            android:text="2" />

        <TextView
            style="@style/ViewStyle"
            android:text="3" />

        <TextView
            style="@style/ViewStyle"
            android:text="4" />

        <TextView
            style="@style/ViewStyle"
            android:text="5" />

        <TextView
            style="@style/ViewStyle"
            android:text="6" />

        <TextView
            style="@style/ViewStyle"
            android:text="7" />
    </LinearLayout> 
```

风格：

```
<style name="ViewStyle">
    <item name="android:layout_weight">1</item>
    <item name="android:layout_width">0dp</item>
    <item name="android:layout_height">60dp</item>
    <item name="android:layout_centerVertical">true</item>
    <item name="android:layout_centerHorizontal">true</item>
    <item name="android:gravity">center</item>
    <item name="android:textSize">10sp</item>
    <item name="android:textColor">@color/white</item>
</style> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T08:44:22.740

使用`layout_weight`in a`LinearLayout`包裹在 a`HorizontalScrollView`中并不适合您想要的。我建议你这样做：

1.  从 中删除`layout_weight`属性`style`，还将 修改`layout_width`为一个值（或者您可以使用`wrap_content`）
2.  在方法中发布`Runnable`您的一个观点`onCreate`以更新类似这样的文本`TextViews`：

    ```
    // wrapperLinearLayout being your LinearLayout wrapping the 7 TextViews
    wrapperLinearLayout.post(new Runnable() {

        @Override
        public void run() {
            // find out the width of the HorizontalScrollView
            HorizontalScrollView hsv = (HorizontalScrollView) wrapperLinearLayout
                    .getParent();
            // the value below will be the new width of all the TextViews so
            // you can see only for initially
            int targetWidth = (hsv.getWidth() / 4) * 7;
            // modify the width of all 7 TextViews
            for (int i = 0; i < wrapperLinearLayout.getChildCount(); i++) {
                LinearLayout.LayoutParams lpc = (android.widget.LinearLayout.LayoutParams) wrapperLinearLayout
                        .getChildAt(i).getLayoutParams();
                lpc.width = targetWidth / 7;
            }
        }
    }); 
    ```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T16:24:17.900

您必须在运行时获取屏幕宽度，然后为您的文本视图设置宽度。我想这是你让它工作的唯一方法。

# ember.js - 如何在emberjs中使用多个子路由器？

> ID：14342087
> 
> 赞同：1
> 
> 时间：2013-01-15T16:20:49.063
> 
> 标签：ember.js

我想知道如何使用 emberjs 实现以下用例：

想象一个匹配这些路线的应用程序：

```
/blog/archives
/blog/article/1 
```

在这两种路线中，用户都可以单击一个按钮，该按钮在右下角停靠的一个小模式框中显示博客上最后发布的评论（这只是一个示例！）。

我想根据 URL 中的哈希来保持这个模态框的状态：

```
/blog/archives?state=/comments/1
/blog/article/1?state=/comments/1 
```

也许我需要使用多个路由器，每个路由器都处理 URL 的特定部分。

Ember.js 中的这个用例有什么可用的吗？你会怎么做这样的事情？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T17:37:02.643

我不认为 Ember`Router`是为同时使用多次而设计的。使用一台路由器应该可以满足您的所有需求，但是...

目前，`Router`不允许查询字符串参数，但我建议你看看这个问题：

*   [路由器：URL 参数](https://github.com/emberjs/ember.js/issues/1487)
*   [向路由器添加查询字符串支持](https://github.com/emberjs/ember.js/issues/1773)（它可能会取代上面的问题）

# linux - 如何将出现的短语输出到给定目录的文件中？

> ID：14342089
> 
> 赞同：-1
> 
> 时间：2013-01-15T16:20:56.670
> 
> 标签：linux, bash, unix, grep

我在使用 grep 输出与模式匹配的短语列表时遇到了一些麻烦。例如，我有一个具有这种格式的文件列表（以行分隔）：

```
date:12/13/2012 name:foo time:10000
date:12/13/2012 name:bar time:20000
date:12/13/2012 name:hello time:30000
date:1/13/2012 name:foo time:40000 
```

理想情况下，我想要的只是一个与“name：foo”匹配的文件，其输出如下：

```
date:12/13/2012 name:foo time:10000
date:1/13/2012 name:foo time:40000 
```

有没有一种简单的方法可以做到这一点？我正在玩 grep 但我没有成功获得所需的输出。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T16:27:50.273

```
grep -hr 'name:foo' * > output.txt 
```

这会递归搜索当前文件夹和所有子文件夹中的每个文件以查找短语“name:foo”，如果在特定行上找到它，则将该行打印到 output.txt

这是你想要的吗？

如果找到匹配行的文件很重要，只需删除 -h 参数，它也会打印该文件。

# three.js - 解析波前 obj 文件由 three.js 中的多边形组成

> ID：14342093
> 
> 赞同：1
> 
> 时间：2013-01-15T16:21:09.750
> 
> 标签：three.js, wavefront

在我的 3D 对象中；我有几个盒子，比如；

![在此处输入图像描述](../Images/b1e2581ee95b4053b47195a512ad07ac.png) 但是，如果我尝试使用 three.js 加载和显示[obj](http://www.ugurbaltaci.com/obj/Deneme.obj)和[mtl](http://www.ugurbaltaci.com/obj/Deneme.mtl)文件，则 5 面或多面对象未正确加载（如下所示）。然后; 我发现 three.js 仅支持 3 面或 4 面的面。

有没有办法在目标文件中划分这些面并加载它们？

![在此处输入图像描述](../Images/f13963886b3a56241e7ea36292810c26.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T03:07:16.343

您需要在导出模型之前对其进行三角测量。大多数 3D 编辑器都有这个选项。一些编辑器在 OBJ 导出器选项中将其作为选项。如果这不是一个选项，您可以复制/备份模型，对其进行三角测量，导出然后删除/隐藏。

# java - Oracle ADF 输入表单，以空开头

> ID：14342097
> 
> 赞同：1
> 
> 时间：2013-01-15T16:21:29.243
> 
> 标签：java, oracle-adf, jdeveloper

我是 ADF 和 Jdeveloper 的新手，所以这可能是一个微不足道的问题，即使我搜索并找不到合适的解决方案。

我想创建一个以空开头的输入表单，然后单击按钮，用户可以在数据库中添加一行。

我知道如何将表单作为编辑表单开始，但我希望表单以空开始。

我没有使用任务流，只是一个简单的 JSF 页面来创建记录。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T19:21:14.593

如果您只是希望页面出现而不实际获取数据，您可以像这样延迟数据获取的执行： [https](https://blogs.oracle.com/shay/entry/delay_method_execution_when_us) ://blogs.oracle.com/shay/entry/delay_method_execution_when_us 如果您希望它提出一个空行已经到位，您可以在导航到控制器层中的页面之前添加一个 createInsert 方法调用。

# asp.net - 在 Visual WebPart 中使用外部项目 asp.NET 用户控件 (ascx)

> ID：14342098
> 
> 赞同：0
> 
> 时间：2013-01-15T16:21:39.167
> 
> 标签：asp.net, sharepoint, sharepoint-2010, mvp, ascx

我是 sharepoint2010 的新手，我习惯于 ASP Web 开发。我正在做的是从外部项目中引用 .ascx，如 Scott Guthrie 文章中所述： [http ://webproject.scottgu.com/CSharp/UserControls/UserControls.aspx](http://webproject.scottgu.com/CSharp/UserControls/UserControls.aspx)

以及 SharePoint 中的 MVP 文章： [http ://www.henrycordes.nl/post/2009/04/29/Model-View-Presenter-design-pattern-in-Sharepoint.aspx](http://www.henrycordes.nl/post/2009/04/29/Model-View-Presenter-design-pattern-in-Sharepoint.aspx)

我有一个测试 Web 应用程序，它具有对 webControls (Ascx) 库项目的项目引用，并且有一个预构建行将 ascx 复制到 Web 应用程序项目中的文件夹中。然后我照常从aspx页面引用ascx控件！

但是在 SharePoint 中，我尝试了同样的技巧并得到了这个错误：

" 解析器错误说明：解析服务此请求所需的资源时发生错误。请查看以下特定解析错误详细信息并适当修改您的源文件。

解析器错误消息：此页面上不允许引用的文件“/UserControls/Calculator.ascx”。”

事实上， ascx 的路径根本没有被解析，因为如果我切换到一个不存在的目录，我会得到同样的错误。或者，如果我将 ascx 复制到“14”目录。

我需要采取哪些步骤才能在 SP2010 中部署此 ascx？

这是我用来在 sp visual webpart 代码 aspx 页面中引用 ascx 的行：

```
<%@ Register tagPrefix="sjb" tagName="calc" src="~/UserControls/Calculator.ascx" %>
<sjb:calc ID="calc" runat="server" /> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T19:30:19.677

您需要将控件部署到 _layouts/controltemplates 目录。这将使他们安全地部署到农场。

您最好的做法是在您的项目中添加一个可视化 webpart 作为示例，并用您的示例替换 ascx 文件。

然后像这样在您的母版页/页面中

```
<%@ Register TagPrefix="mfKA" TagName="KeepAliveControl" Src="~/_controltemplates/LoginKeepAlive/KeepAlive/KeepAliveUserControl.ascx"%> 
```

# visual-studio-2010 - 使用命名空间 Ctrl + 的快捷方式。不工作

> ID：14342102
> 
> 赞同：0
> 
> 时间：2013-01-15T16:21:52.303
> 
> 标签：visual-studio-2010

我正在使用 VS 2010 Professional，我记得，如果您在按下 (Ctrl + .) 将鼠标悬停在波浪线上时尝试使用快捷方式添加命名空间，它会显示命名空间或“解决”，但我没有得到我的VS中的那个选项。

我尝试用谷歌搜索这种奇怪的行为，但没有得到任何解决方案。你能告诉我如何解决这个问题吗？

问候，罗恩。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T08:49:28.553

您描述的是Tool ReSharper的功能，而不是内置的VS。

# button - Spotify 播放按钮不会刷新所有歌曲

> ID：14342104
> 
> 赞同：1
> 
> 时间：2013-01-15T16:21:53.783
> 
> 标签：button, spotify, playback

我正在使用 Spotify 播放按钮作为节日的宣传工具。我从去年开始，想用新的艺术家刷新整个列表，这样所有的订阅者都可以保留。所以基本上我删除了去年的所有艺术家，并为当前版本添加了新艺术家。然而，由于某种原因，一些艺术家仍然在 Spotify 播放按钮中可见，而在应用程序本身中，只有新艺术家是可见的。

有谁知道如何处理这个问题？如果我可以使用相同的列表，我会非常高兴，因为所有订阅者都保留了下来。

提前致谢。例如 spotify:user:1117955849:playlist:1BUQAapmht5TvnyjzfQvYt

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T14:32:46.713

您没有看到正确歌曲的原因是 Spotify 后端系统中的错误。在某些情况下，播放列表缓存在编辑后无法正确将列表标记为脏，但仍会返回旧数据。不幸的是，目前没有办法为您处理这个问题，除非您想使用相同的播放列表，除非您等待。通常一天，有时两天。

有两种解决方法可以立即获得具有正确轨道的小部件。

1.  创建一个新的播放列表
2.  使用 trackset，此处描述：[https ://developer.spotify.com/technologies/spotify-play-button/documentation/](https://developer.spotify.com/technologies/spotify-play-button/documentation/)

我希望我们可以解决它，这样你就不会从一开始就看到这个问题。

我在 Spotify 工作，我很惭愧我们还没有解决这个问题

# java - ClassNotFoundException 用于瘦战

> ID：14342107
> 
> 赞同：0
> 
> 时间：2013-01-15T16:22:13.283
> 
> 标签：java, glassfish, ejb, war, ear

我面临着类加载问题，在我的瘦`war`包装中加载类`ear`。那里还打包了其他 ejb 模块。有些可以通过弹簧加载，而有些则不能。

想象以下场景：

```
someApp.ear
|- someEJBs1.jar
|- someEJBs2.jar
...
|- someEJBsX.jar
|- someWar.war 
```

如果我尝试从 someWar.war 通过 spring 访问一些类：

*   someEJBs1.jar 它工作
*   但对于 someEJBs2.jar 中的那些我得到`java.lang.ClassNotFoundException`.

不知道问题出在哪里。我的`MANIFEST.MF`根本不包含任何类路径信息。

我已经在考虑是否有任何方法可以在运行时（可能在调试期间）查看加载的类，或者可能是为特定的 war 文件提供的类路径？

我在 glassfish 3.1.1 中运行（这是一项要求，不可能对此进行更改）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T16:30:10.147

在您的代码中尝试以下调试功能：

```
 //Prints the Root directory
    public static void printPWD() {
        File dir1 = new File(".");
        try {
            System.out.println("Current dir : " + dir1.getCanonicalPath());
            dir1 = null;
        } catch (Exception e2) {
            e2.printStackTrace();
        }
    }

     // Prints all files on the ClassPath to the system.out

    public static void printClasspathFiles() {
        ClassLoader sysClassLoader = ClassLoader.getSystemClassLoader();

        // Get the URLs
        URL[] urls = ((URLClassLoader) sysClassLoader).getURLs();

        for (int i = 0; i < urls.length; i++) {
            System.out.println(urls[i].getFile());
        }
    }

//prints the classpath to system.out
print printClasspath(){
       System.out.println(System.getProperty("java.class.path"));
} 
```

要获取所有加载的类，getAllLoadedClasses 方法会很有用。[看这里](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/instrument/Instrumentation.html#getAllLoadedClasses%28%29 "看这里")

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T08:17:55.883

OK，终于找到了根本原因，我忽略了spring xml configs中包定义错误的问题。:)

我想我应该正确阅读错误消息。并仔细检查我认为是正确的。（嗯，这对我来说并不是什么新鲜事）

现在它对我有用。

# awk - 使用 awk 在数字和数字之间转换月份

> ID：14342108
> 
> 赞同：3
> 
> 时间：2013-01-15T16:22:14.727
> 
> 标签：awk, associative-array, type-conversion

在过去的考试论文中，我有一个问题：

> 月份可以用不同的方式表示，例如数字（1、2、...、12）或三个字母的月份名称（Jan、Feb、...、Dec）。建议如何使用 awk 中的关联数组将三个字母的月份名称转换为月份编号，反之亦然，将月份编号转换为三个字母的月份名称。

所以我想我会使用格式中的关联数组，比如月份的输入是 1 美元：

```
number_to_month["Jan"] = 1;
print number_to_month[$1] 
```

但对我来说，这似乎并没有很好地利用关联数组的力量，而且我必须每个月在数组中手动​​初始化。

我还有哪些其他选择？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-15T16:31:29.520

内置`split`函数在这里是你的朋友，循环可以将 name-from-number 版本复制到 number-from-name 中：

```
BEGIN {
    split("Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec",month)
    for (i in month) {
        month_nums[month[i]]=i
    }
}
END {
    for (i in month) {
        print i "\t" month[i]
    }
    for (m in month_nums) {
        print m "\t" month_nums[m]
    }
} 
```

该`BEGIN`块显示了如何做到这一点。然后`END`阻止只是让您验证它。

我得到的输出（使用 gawk 4.0.1）是：

```
4       Apr
5       May
6       Jun
7       Jul
8       Aug
9       Sep
10      Oct
11      Nov
12      Dec
1       Jan
2       Feb
3       Mar
Feb     2
Sep     9
Jan     1
May     5
Apr     4
Oct     10
Dec     12
Nov     11
Jul     7
Mar     3
Aug     8
Jun     6 
```

请注意由于无法强制数组循环上的访问顺序而引起的通常的尴尬（嘿！*AWKwardness ）。*`for`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-15T16:42:03.627

如果您不想手动初始化数组，一种选择是：

```
echo | awk '{x=mktime("2013 01 01 0 0 0"); for(i=0;i<12;i++){s=strftime("%b",x+((31*i)*86400)); m[s]=i+1;n[i+1]=s;}}' 
```

这将创建 2 个数组 m 和 n，其中 m 是数组，其中索引是月份名称，值是月份编号，n 数组反之亦然。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-15T19:33:00.923

```
$ cat tst.awk
BEGIN {
   mths="JanFebMarAprMayJunJulAugSepOctNovDec"

   name="Mar"; print name " -> " (match(mths,name)+2)/3
   name="Sep"; print name " -> " (match(mths,name)+2)/3

   nbr=3;      print nbr  " -> " substr(mths,(nbr*3)-2,3)
   nbr=9;      print nbr  " -> " substr(mths,(nbr*3)-2,3)
}

$ awk -f tst.awk
Mar -> 3
Sep -> 9
3 -> Mar
9 -> Sep 
```

这是@dmckee 的脚本修改后产生有序输出：

```
$ cat tst2.awk
BEGIN {
    n = split("Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec",month)
    for (i in month) {
        month_nums[month[i]]=i
    }

    for (i=1; i<=n; i++) {
        print i "\t" month[i]
    }
    for (i=1; i<=n; i++) {
        m = month[i]
        print m "\t" month_nums[m]
    }
}
$ awk -f tst2.awk
1       Jan
2       Feb
3       Mar
4       Apr
5       May
6       Jun
7       Jul
8       Aug
9       Sep
10      Oct
11      Nov
12      Dec
Jan     1
Feb     2
Mar     3
Apr     4
May     5
Jun     6
Jul     7
Aug     8
Sep     9
Oct     10
Nov     11
Dec     12 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-15T16:31:22.313

当他们提到 awk 时，我认为这些月份的详细信息和整数映射保存在数据文件中，例如

```
1 JAN JANUARY jan
2 FEB FEBRUARY feb
... 
```

等等

你可以使用 awk

```
awk '/JAN/ {print $1}' temp.txt 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-15T20:57:48.543

这是另一个使用几个辅助函数的方法：

```
awk '
    BEGIN { 
        j = 0
        for (i=1; i<=34; i+=3) {
            months[substr("JanFebMarAprMayJunJulAugSepOctNovDec",i,3)] = ++j
        }
    }
    function month2num(month) {
        return (month in months ? months[month] : -1)
    }
    function num2month(n) {
        for (month in months) {
            if (months[month] == n)
                return month
        }
        return ""
    }
    BEGIN {
        print "Jan: " month2num("Jan")
        print "Dec: " month2num("Dec")
        print "Foo: " month2num("Foo")
        print "3: " num2month(3)
        print "12: " num2month(12)
        print "14: " num2month(14)
    }
' 
```

# sharepoint - 在 SharePoint 2010 的 WebApplication-Feature 中查找 JobDefinition 时出现问题

> ID：14342113
> 
> 赞同：2
> 
> 时间：2013-01-15T16:22:20.577
> 
> 标签：sharepoint, sharepoint-2010, jobs, schedule

我在 WebApplication-Scope 下获得了一个 SharePoint-Feature，它应该创建一个 Timer-Job。

在功能激活（在创建该作业之前）和功能取消激活时，如果该作业已经存在，我想删除它。这是功能激活代码：

```
public class myJob : SPJobDefinition
  public myJob() : base("JobName", SPAdministrationWebApplication.Local, null, SPJobLockType.Job) {}
}

public class JobFeature : SPFeatureReceiver
{
  public override void FeatureActivated(SPFeatureReceiverProperties properties)
  {
    SPWebApplication application = properties.Feature.Parent as SPWebApplication;
    // 1\. Delete old Job if exists
    foreach (SPJobDefinition job in application.JobDefinitions)
    {
      if (string.Equals(job.Name, "JobName"))
      {
        job.Delete();   // NEVER GETS HERE
      }
    }
    // 2\. Install job
    myJob deploymentJob = new myJob();
    SPMinuteSchedule schedule = new SPMinuteSchedule { BeginSecond = 0, EndSecond = 59, Interval = 5 };
    deploymentJob.Schedule = schedule;
    deploymentJob.Update(); // CRASHES
  }
} 
```

问题是：永远不会到达应该删除作业的代码。这份工作似乎不在 application.JobDefinitions 中。（上面代码中的“// 永远不会到达这里”）

但是当我尝试创建部署作业时，我得到了一个作业已经存在的异常（上面代码中的“// CRASHES”）：

```
{"An object of the type myJob named \"JobName\" already exists under the parent Microsoft.SharePoint.Administration.SPAdministrationWebApplication named \"\".  Rename your object or delete the existing object."} 
```

错误在哪里？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T08:30:54.277

当使用另一个构造函数时，它可以工作......

```
public myJob(SPWebApplication application)
            : base("JobName", application, null, SPJobLockType.Job)
        {

        } 
```

# vbscript - VBscript将文件从一个目录移动到另一个目录

> ID：14342121
> 
> 赞同：4
> 
> 时间：2013-01-15T16:22:41.683
> 
> 标签：vbscript

我是 VBscript 的新手，希望在将特定数量的文件从一个目录移动到另一个目录时得到一些帮助。

现在，我目前有一组 3 个具有不同扩展名的文件（用于测试目的），如果源目录中恰好有 3 个文件（不多也不少），我想移动所有文件。到目前为止，我的代码是：

```
Set fso=CreateObject("Scripting.FileSystemObject")

Set fldr=fso.getFolder("C:\folderA")
for each file in fldr.files
    If fldr.files < 3 then
            msgbox("Need more files")
    Else
            fso.MoveFile "C:\folderA\*", "C:\folderB"
    End If 
```

任何帮助将不胜感激。谢谢大家！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T16:38:21.823

1.  用于`fso.getFolder("C:\folderA").Files.Count`获取`C:\folderA`.
2.  **在文件之前**执行此操作 - 而不是在循环中执行此操作（以移动它们）
3.  如果文件夹恰好包含 3 个文件，请考虑移动（并重新创建）该文件夹

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-08-17T21:28:29.643

```
Set FSO=CreateObject("Scripting.FileSystemObject")
Set fldr= FSO.GetFolder("C:\FolderA")
Set Collec_Files= fldr.Files
For Each File in Collec_Files
    If Collec_Files.count < 3 then
      msgbox("Need more files")
    Else
      FSO.MoveFile "C:\FolderA\*", "C:\FolderB"
    End If
Next 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-05-28T12:43:51.450

我做了以下代码，它工作得很好。它正在移动其他 3 个不同的文件夹，查看文件的名称和类型。

```
Dim fs
Set fs = CreateObject("Scripting.FileSystemObject")
Set f = fs.GetFolder(rootDir)
For each file in f.files
    filename = folderName & file.name

    extFile = right(file.Name, 4) 'gets the file extension .xls

    strExport = left(file.Name,6)  

    strExportAPI = left(file.Name, 3)

    Do

        If (extFile <> ".vbs") Then 

            strsub = "KeyWord"
            index = InStr(file.name, strsub)

        End If  

        If (strExportAPI = "Value") Then 
            fs.CopyFile file, dirKeyWord&file.name
            fs.MoveFile file, dirKeyWord&file.name
            Exit Do             
        End if

        If (index > 0) Then
            fs.CopyFile file, dirKeyWord&file.name
            fs.MoveFile file, dirKeyWord&file.name
            Exit Do
        End If

        Do while (strExport = "export")
            fs.MoveFile file, dirKey3&file.name
            Exit Do 
        Loop            
    Loop While False
Next 
```

泰

# c# - 获取当前写入自定义剃须刀基础页面的模型属性

> ID：14342132
> 
> 赞同：0
> 
> 时间：2013-01-15T16:23:25.393
> 
> 标签：c#, razor

我有一个自定义 Razor 基本页面。继承自

```
WebViewPage<TModel> 
```

我已经覆盖了这个方法：

```
 public override Write(object value) 
```

但是在这种方法中，我想知道当前写出了哪个属性。

现在我动态地在我的模型中搜索具有这个特定值的属性，但这似乎不是最优的。我看过所有的“基地。？？？” 属性，但找不到任何可能让我访问当前写出的属性的东西。

有什么想法吗？

# c# - 如何使用 PInvoke 将 unicode 字符串从 C++ 获取到 C#

> ID：14342140
> 
> 赞同：1
> 
> 时间：2013-01-15T16:23:48.310
> 
> 标签：c#, string, pinvoke, unicode-string

我有以下 C++ 方法的签名。最后一个参数应将设备名称作为 2 字节的 unicode 字符串返回。

```
int GetDeviceIdentifier(DWORD deviceIndex, WCHAR** ppDeviceName); 
```

我使用以下签名包装到 C# 中。它有效，但我得到的字符串很奇怪。难道我做错了什么？

```
[DllImportAttribute("StclDevices.dll", EntryPoint = "GetDeviceIdentifier", CallingConvention = CallingConvention.Cdecl, CharSet = CharSet.Unicode)]
public static extern int GetDeviceIdentifier(uint deviceIndex, StringBuilder ppDeviceName); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T16:29:13.710

传递`StringBuilder`参数将匹配类型为 的 C++ 参数`WCHAR*`。在这种情况下，内存将由 C# 代码通过设置字符串构建器对象的容量来分配。

对于您的函数，看起来内存是由 C++ 代码分配的。因此双指针。所以你需要这个：

```
[DllImportAttribute("StclDevices.dll", 
    CallingConvention=CallingConvention.Cdecl)]
public static extern int GetDeviceIdentifier(
    uint deviceIndex, 
    out IntPtr ppDeviceName
); 
```

你这样称呼它：

```
IntPtr ppDeviceName;
int retval = GetDeviceIdentifier(deviceIndex, out ppDeviceName);
string DeviceName = Marshal.PtrToStringUni(ppDeviceName); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T16:32:18.170

```
[DllImportAttribute("StclDevices.dll", CharSet = CharSet.Unicode, ExactSpelling = true)]
internal static extern Int32 GetDeviceIdentifier([In] UInt32 deviceIndex, [MarshalAs(UnmanagedType.LPTStr), Out] out String ppDeviceName);

String ppDeviceName;
NativeMethods.GetDeviceIdentifier(i, out ppDeviceName); 
```

如果您想坚持使用 StringBuilder，请改用：

```
[DllImportAttribute("StclDevices.dll", CharSet = CharSet.Unicode, ExactSpelling = true)]
internal static extern Int32 GetDeviceIdentifier([In] UInt32 deviceIndex, [In, Out] StringBuilder ppDeviceName);

StringBuilder ppDeviceName = new StringBuilder(255);
NativeMethods.GetDeviceIdentifier(i, ppDeviceName); 
```

# ruby - 字符串上的 Splat（星号）运算符

> ID：14342141
> 
> 赞同：3
> 
> 时间：2013-01-15T16:23:48.480
> 
> 标签：ruby, monkeypatching

要编写 splat 运算符的自定义结果，必须实现`to_a`方法。字符串类的示例：

```
class String
  def to_a
    self.split //
  end
end

irb> res = *'text'
=> ["t", "e", "x", "t"] 
```

但是没有上面的monkeypatch，String类对方法一无所知`to_a`：

```
irb> String.respond_to? :to_a
=> false 
```

所以问题是，在标准的“未修补”字符串对象上应用 splat 运算符时会调用什么方法？

```
irb> res = *'text'
=> ['text'] 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-15T16:38:37.180

首先：调用`String.respond_to?(:to_a)`不会告诉你字符串*实例**是否*响应，它会告诉你*类*是否响应。如果您想知道一个字符串是否响应，您必须询问该字符串：*`to_a``String` *`to_a``to_a`**

 **```
'text'.respond_to?(:to_a) # => false 
```

或者您可以询问`String`该类是否具有公共实例方法`to_a`：

```
String.public_instance_methods.include?(:to_a) # => false 
```

现在，s 不响应的*原因*是因为不清楚你想要什么：你想要一个字符数组吗？字形的？线的？代码点？字节数？`String``to_a`

```
a = *'text'.chars      # => ['a', 'b', 'c']
a = *'text'.codepoints # => [116, 101, 120, 116]
a = *'text'.bytes      # => [116, 101, 120, 116]
a = *'text'.lines      # => ['text'] 
```

至于为什么 splat 运算符的行为方式如您所见，这似乎是语言规范中的一个极端情况。我什至不能 100% 确定这是预期的行为。多重赋值规范运行了将近 4 页，有关详细信息，请参阅 Ruby 语言规范的第 11.4.2.4 节。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-15T16:41:56.587

[Splat，根据定义，如果对象没有响应，则返回数组中的值`to_a`：](https://github.com/rubyspec/rubyspec/blob/master/language/splat_spec.rb#L51)

```
it "assigns the splatted object contained into an array when the splatted object doesn't respond to to_a" do
  a = *1; a.should == [1]
end 
```

警告：有点非官方，但相对可用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-15T16:27:17.360

我不确定这是否足以满足您的需求，但您可以这样做：

```
1.9.3-p0 :008 > res = *'text'.chars
 => ["t", "e", "x", "t"] 
```**

# json - JSON 输入字符串

> ID：14342144
> 
> 赞同：-1
> 
> 时间：2013-01-15T16:24:01.017
> 
> 标签：json, unicode

我看到 JSON 只接受如下所示的字符串：Kiv\u00e1l\u00f3 magyar szerepl\u00e9s a nemzetk\u00f6zi p\u00e1rlatversenyen。

使用 \ 转义的 á,é,ő 等 Unicode 字符和 ofc "/" 也使用 \ 进行转义。

我的问题是，如何将内容文本转换为这种 ecpaed 格式，以便我的应用程序可以使用它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T04:23:27.030

JSON 不仅接受 unicode 转义序列，如果您使用`á`etc 时遇到异常，那是因为您没有将其编码为 UTF-8。JSON 被指定为仅适用于 UTF-8、UTF-16 和 UTF-32 编码。

您对 JSON 的理解似乎来自 PHP `json_encode`，默认情况下使用 unicode 转义序列（为了符合 javascript 字符串语法和 ASCII 安全）并出于反 XSS 的原因转义普通斜杠（`"</script>" becomes <\/script>"`），但这都不是必需的。

如果您需要有关代码的帮助，您应该只发布您的代码和详细信息，而不是做出错误的假设。

# css - CSS3 变换、倾斜和旋转

> ID：14342145
> 
> 赞同：4
> 
> 时间：2013-01-15T16:24:02.177
> 
> 标签：css

我正在查看 CSS3 Transform 并希望有一个倾斜和旋转的盒子。

我试过使用：

```
transform:rotate(80deg);
-moz-transform:rotate(80deg); /* Firefox */
-webkit-transform:rotate(80deg); /* Safari and Chrome */
-o-transform:rotate(80deg); /* Opera */
-webkit-transform: skew(50deg);
-moz-transform:skew(50deg);
-o-transform:skew(50deg);
transform:skew(50deg); 
```

这似乎只会扭曲 div。

你可以在同一个 div 上使用 skew 和 rotate 吗？

谢谢

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-01-15T16:31:42.437

不要多次声明转换（后面的规则总是胜出），您应该用空格分隔转换，如下所示：

```
transform: rotate(80deg) skew(20deg); 
```

不要忘记此规则之前的所有供应商前缀。

[你可以在W3C 的工作草案](http://www.w3.org/TR/css3-2d-transforms/#effects)上看到语法

# mysql - 在一个命令中从 mysqldump 导入 MySQL？

> ID：14342147
> 
> 赞同：0
> 
> 时间：2013-01-15T16:24:06.387
> 
> 标签：mysql, mysqldump

我需要每天将一张表从 olddb 移动到新 db。我想知道是否可以只在一个命令中运行这两个命令？不创建 .sql 文件

```
mysqldump -u user olddb table_name > moving.sql
mysql -u user newdb < moving.sql 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T16:27:03.140

```
mysql -u user -p -e 'insert into newdb.table_name select * from olddb.table_name' 
```

**UPD**

使用条件：

```
mysql -u user -p -e 'insert into newdb.table_name select * from olddb.table_name where olddb.table_name.mydate > ...' 
```

# python - Python 线程服务器只服务一次

> ID：14342148
> 
> 赞同：0
> 
> 时间：2013-01-15T16:24:08.513
> 
> 标签：python, sockets, webserver

试图创建一个线程化的 http 服务器。当我通过网络浏览器连接到该服务器时，虽然我只能在服务器停止之前拉起一件事。发生这种情况有什么特别的原因吗？

```
import socket
from threading import Thread
class http():
    def __call__():
        return 0
    def site(self):
        try:
            s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
            s.bind(("localhost", 5124))
            s.listen(2)
        except socket.error, (value,message):
            if s:
                s.close()
                return 2
        c, addr = s.accept()
        s = c.recv(1024)
        print s
        c.send("test")
        c.close()
        return s

serve = http()

def happy():
    while True:
        serve.site()

if __name__ == '__main__':
    Thread(target = happy()).start() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T16:27:20.573

尝试 target=happy，不带括号。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T17:01:36.800

The problem comes when the connection is closed and you try to reconnect before the socket leave the `TIME_WAIT` state. Try using the `socket.SO_REUSEADDR` socket option or use a random port every time.

```
import socket

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.bind(("localhost", 1234))
s.listen(2)
print 'listening on port %s' % s.getsockname()[1]
while True:
    c, addr = s.accept()
    buf = c.recv(1024)
    c.send(buf)
    c.close() 
```

# c# - 如何对列表进行排序 基于2个条件？

> ID：14342150
> 
> 赞同：0
> 
> 时间：2013-01-15T16:24:12.050
> 
> 标签：c#, list, sorting

我有一个清单：

```
List<User> users = getUsers(); 
```

User 对象有 2 个我想排序的属性：

```
IsActive
Name 
```

排序首先按 IsActive 排序，然后按名称排序。

因此，活动用户将位于列表顶部，按名称排序。然后将列出所有非活动用户（按字母顺序排序）。

这是可能的还是我必须分解列表然后合并它们？

*此列表中的项目少于 100 个，因此性能并不是真正的问题。*

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-15T16:25:16.700

只需使用`OrderBy`和`ThenBy`。感谢 Tim Schmelter 的发言。如果您使用`OrderBy`，您将获得`IsActive == false`列表顶部的用户。

```
var users = getUsers().
    OrderByDescending(u => u.IsActive).
    ThenBy(u => u.Name).
    ToList(); 
```

请记住添加到您的`using`指令中：

```
using System.Linq; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-15T16:25:20.240

```
var result = users.OrderByDescending(z => z.IsActive).ThenBy(z => z.Name); 
```

# python - 如何设置特定数据库以在 Django 的一个 ModelForm 中使用？

> ID：14342151
> 
> 赞同：0
> 
> 时间：2013-01-15T16:24:12.497
> 
> 标签：python, django, django-forms

我真的需要设置一个数据库来模拟表单使用来验证和保存所有数据。我怎样才能传递这种类型的参数？像 .using(dbname) 一样？

不使用 db route，因为我需要所有 auth 数据库并选择进入特定数据库，所有其他都设置在我的 UserProfile 数据库名称中，并且我尝试使用路由器但不起作用。

我有这样的看法：

```
def editaCliente(request, pessoa_id=None):
    if request.user.is_authenticated():
        profile = request.user.get_profile()
        if pessoa_id:
            cliente = Cliente.objects.using(profile.dbname).get(idpessoa=pessoa_id)
        else:
            cliente = None

        if request.method == 'POST':
            formPessoa = ClienteForm(request.POST, instance=cliente, vUserProfile=profile)
            if formPessoa.is_valid():
                cliente = formPessoa.save(commit=False)
                cliente.idrepresentante = profile.id_comerx3c # passando o id do representante
                cliente.internet = 'S'
                cliente = formPessoa.save()

                if cliente:
                    return redirect('listaCliente')
        else:
            formPessoa = ClienteForm(instance=cliente, vUserProfile=profile)

    return render_to_response(
        'cliente_novo.html',
        locals(),
        context_instance=RequestContext(request),
    ) 
```

但是当调用 formPessoa.is_valid() 时显示这些错误：

```
('Error while preparing SQL statement:\n- SQLCODE: -204\n- Dynamic SQL Error\n- SQL error code = -204\n- Table unknown\n- PESSOA\n- At line 1, column 41', u'-204 -- SELECT FIRST 1 (1) AS "A" FROM "PESSOA" WHERE "PESSOA"."IDPESSOA" = -1') 
```

那是因为表单没有得到正确的数据库，它需要一个默认数据库，我只用于身份验证配置文件。

这是我的模型代码：

```
class ClienteForm(ModelForm):
    class Meta:
        model = Cliente

    def __init__(self, *args, **kwargs):
        vUserProfile = kwargs.pop('vUserProfile', None)
        super(ClienteForm, self).__init__(*args, **kwargs)
        self.fields["idcidade"].queryset = Cidade.objects.using(vUserProfile.dbname).all()

        self.fields["idpessoa"].widget.attrs['class'] = "input-mini" 
```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T17:01:38.047

When you call `save()` on your form, pass in the name of the database like so:

```
cliente = formPessoa.save(using=profile.dbname) 
```

# c++ - 使用存储在向量中的函数指针

> ID：14342157
> 
> 赞同：1
> 
> 时间：2013-01-15T16:24:27.060
> 
> 标签：c++, pointers, casting

我有一个包含函数指针的向量：

```
vector<double (*)(vector<double>)> dY = {d2x,d2y,dx,dy} 
```

在另一个函数中，我有一个循环遍历这个向量。

```
for( vector<double>::const_iterator it = dY.begin(); it != dY.end(); ++it){
    vector<double> Y = {0,10,0,10};
    ...
} 
```

现在我想计算 d2x(Y)、d2y(Y)、dx(Y) 和 dy(Y)，但我没有正确地转换迭代器，以便我可以提供参数。

我怎样才能做到这一点？

非常感谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-15T16:30:05.427

你真的迭代了正确的向量吗？循环中的类型`it`不适合`dY`向量。

```
for( vector<double (*)(vector<double>)>::const_iterator it = dY.begin(); it != dY.end(); ++it)
//          ^^^^^^^^^^^^^^^^^^^^^^^^^ -- You need the correct type here 
```

一旦你有一个正确的迭代器，这应该可以工作：

```
double result = (*it)(Y); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-15T16:34:07.353

不需要强制转换，只需取消引用迭代器即可获取函数指针：

```
double d = (*it)(Y); 
```

但是，您声明了错误的迭代器类型；它应该是

```
vector<double (*)(vector<double>)>::const_iterator 
```

由于您使用的是 C++11，因此您可以根据需要将其缩短为`auto`。

# c++ - make_shared<>() 中的 WKWYL 优化是否会为某些多线程应用程序引入惩罚？

> ID：14342159
> 
> 赞同：19
> 
> 时间：2013-01-15T16:24:36.820
> 
> 标签：c++, caching, optimization, c++11, shared-ptr

几天前，我碰巧看了Stephan T. Lavavej 的[这个非常有趣的演讲](http://channel9.msdn.com/Events/GoingNative/GoingNative-2012/STL11-Magic-Secrets)，其中提到了“*我们知道你住在哪*里”的优化（抱歉在问题标题中使用了首字母缩写词，所以警告我这个问题可能已经关闭，否则)，以及Herb Sutter 关于机器架构的[这个漂亮的作品。](http://www.youtube.com/watch?v=L7zSU9HI-6I&feature=gv)

简而言之，“*我们知道你住在哪*里”优化包括将引用计数器放置在与正在创建的对象相同的内存块上`make_shared`，从而导致一个内存分配而不是两个内存分配，并且`shared_ptr`更加紧凑。

然而，在总结了我从上面两个演示文稿中学到的东西之后，我开始怀疑 WKWYL 优化是否不会**降低性能**，以防被*运行在不同内核上*`shared_ptr`的多个线程访问。

 *如果引用计数器*接近*内存中的实际对象，实际上，它们应该更有可能被提取到与对象本身**相同的缓存行中。**反过来，如果我得到正确的教训，这将使线程更有可能在竞争相同的缓存行时变慢，即使它们不需要。

假设**一个**线程需要多次**更新引用计数器**`shared_ptr`（例如，在复制周围时），而**其他线程只需要访问指向的对象**：这不会通过让所有线程竞争来减慢**所有**线程的执行速度吗？对于同一个缓存行？

**如果 refcount 存在于内存中的其他位置，我会说争用不太可能发生**。

这是否是反对在类似情况下使用的一个很好的论据`make_shared()`（当然，只要它实现了 WKWYL 优化）？还是我的推理存在谬误？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-15T18:23:10.010

*如果*那是您的使用模式，那么肯定`make_shared`会导致“错误共享”，这是我知道的使用相同缓存行的不同线程的名称，即使它们没有访问相同的字节。

对于附近部分被不同线程（其中一个是写入）使用的任何对象也是如此。在这种情况下，“对象”是由`make_shared`. 您也可以询问，在不同线程或多或少同时使用近端数据的情况下，*任何从数据局部性中受益的尝试是否会适得其反。*是的，它可以。

可以得出结论，如果每个对象的每个可写部分都分配在遥远的位置，则不太可能发生争用。因此，错误共享的解决方法通常是将内容分散开（在这种情况下，您可以停止使用`make_shared`，或者您可以将填充放入对象中以将其部分分隔到不同的缓存行中）。

与此相反，当在*同一个*线程中使用不同的部分时，如果您将它们分散到内存中，那么这是有代价的，因为还有更多的东西要提取到缓存中。由于分散事物有其自身的成本，因此对于您最初认为的如此多的应用程序而言，这实际上可能无济于事。但毫无疑问，可以编写有帮助的代码。

有时，`make_shared`它的好处与缓存行和位置无关，只是它进行了一次动态分配而不是两次。它的价值取决于您分配和释放的对象数量：它可能可以忽略不计；这可能是您的应用程序适合 RAM 与疯狂交换之间的区别；在某些情况下，您的应用可能需要进行所有需要的分配。

`make_shared`仅供参考，还有另一种情况可能不使用`shared_ptr`. 原因是在弱指针消失之前控制块不会被释放，因此如果你使用`make_shared`了对象占用的整个内存，直到弱指针消失才会释放。当然，一旦共享指针被销毁，对象就会被销毁，所以重要的是类的大小，而不是关联的资源。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-15T16:58:03.373

Note that allocating the ref count isn't directly about the WKWYL optimization -- that's the primary intended effect of `std::make_shared` itself. You have full control: use `make_shared<T>()` to save an allocation and put the reference count with the object, or use `shared_ptr<T>( new T() )` to keep it separate.

Yes, if you place the object and the reference count in the same cacheline, it might lead to performance degradations due to false sharing, if the reference count is updated frequently while the object is accessed only reading.

However the way I see it there are two factors why this isn't factored into the decision for doing this optimization:

1.  In general you don't want the reference count to change frequently, since that by itself is a performance problem (atomic operations, several threads accessing it, ...) which you want to avoid (and probably can for most cases)
2.  Doing this optimization doesn't necessarily incur the potential extra performance problems you described. For that to happen the reference count and (parts of) the object need to be in the same cacheline. It could therefore easily be avoided by adding appropriate padding between the reference count (+other data) and the object. In that case the optimization would still only do one allocation instead of two and therefore still be beneficial. However for the more likely case which doesn't trigger this behaviour, it would be slower then the non padded version, since in the non padded version you benefit from the better locality (the object and reference count being in the same cacheline). For this reason I think that this variant is a possible optimization for highly threaded code, but not necessarily one to be made in the standard version.
3.  If you know how `shared_ptr` is implemented on your platform you could emulate the padding, either by inserting padding into the object, or (possibly, depending on the order in memory), by giving it a deleter, which includes enough padding.

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-01-15T20:52:59.893

> 假设**其中一个**线程需要多次**更新引用计数器**`shared_ptr`（例如，在复制周围时），而**其他线程只需要访问指向的对象**：这不会通过让所有线程竞争来减慢**所有**线程的执行速度吗？对于同一个缓存行？

是的，但这是一个现实的场景吗？

在我的代码中，复制该对象的线程之所以`shared_ptr`这样做是因为它们希望共享对象的所有权以便可以使用它。如果进行所有这些引用计数更新的线程不关心该对象，他们为什么还要费心分享它的所有权呢？

`const shared_ptr&`您可以通过传递引用并仅在您真正想要拥有和访问对象时制作（或销毁）副本来缓解问题，例如，在跨线程或模块边界传输它时，或者在获得对象的所有权以使用它时。

通常，侵入性引用计数优于外部引用计数（请参阅[智能指针计时](http://www.boost.org/libs/smart_ptr/smarttests.htm)）*，因为*它们位于单个缓存行上，因此您不需要为对象及其引用计数使用两个宝贵的缓存行。请记住，如果您已用完一个额外的缓存行，那么其他所有缓存行就会少一个缓存行，并且某些内容将被驱逐，并且在下一次需要时您将获得缓存未命中。*

# amazon-web-services - Amazon EMR 上的 s3fs：它会扩展到大约 1 亿个小文件吗？

> ID：14342160
> 
> 赞同：5
> 
> 时间：2013-01-15T16:24:38.310
> 
> 标签：amazon-web-services, amazon-s3, hdfs, amazon-emr, s3fs

请参考以下已经问过的问题： [Write 100m files to s3](https://stackoverflow.com/questions/14081123/write-100-million-files-to-s3) and [Too many open files in EMR](https://stackoverflow.com/questions/12953251/too-many-open-files-in-emr)

这里处理的数据大小至少在 4-5TB 左右。准确地说 - 300GB 使用 gzip 压缩。

随着这一步随着时间的推移聚合数据，输入的大小将逐渐增长。

例如，截至 2012 年 12 月的日志将包含：

```
UDID-1, DateTime, Lat, Lng, Location
UDID-2, DateTime, Lat, Lng, Location
UDID-3, DateTime, Lat, Lng, Location
UDID-1, DateTime, Lat, Lng, Location 
```

为此，我们必须以 UDID（唯一设备标识符）作为文件名生成单独的文件，并在文件中按排序顺序生成属于该 UDID 的记录。

前任：

```
UDID-1.dat => File Contents
DateTime1, Lat1, Lng1, Location1
DateTime2, Lat2, Lng2, Location2
DateTime3, Lat3, Lng3, Location3 
```

现在，当我们有 2013 年 1 月的日志时，此步骤将读取旧数据、此步骤已为较早月份生成的文件以及较新的日志以聚合 UDID 的数据。

前任：

```
If the logs for month of Jan has a record as: UDID-1, DateTime4, Lat4, Lng4, Location4, the file UDID-1.dat would need to be updated with this data. Each UDID's file should be chronologically sorted. 
```

对于这一步，我们考虑将数据写入 EBS 卷并保持原样以供以后使用。但是 EBS 卷有 1TB 的限制。正如在引用的问题中已经提到的，直接在 s3 上生成文件或在 HDFS 上生成然后移动到 s3 对这个用例来说不是一个可行的选择，因为大约有 1 亿个小文件需要移动。即使使用 s3distcp，移动如此大量的文件也太慢了。

因此，接下来我们将尝试 s3fs——由 Amazon S3 支持的基于 FUSE 的文件系统。有谁知道 s3fs 的可扩展性如何？能处理1亿个小文件吗？将分布在 1 亿个文件中的 3-5TB 数据从 s3 移动到本地文件系统以供 MR 作业使用需要多长时间？以及将数据移回 s3 需要多长时间？它是否会遇到与使用 s3distcp 时遇到的问题相同的问题？

提前致谢 ！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-12-12T17:55:58.170

我建议不要使用 s3fs 复制大量小文件。

我曾尝试过几次从 HDFS 移动大量小文件，而 s3fs 守护进程不断崩溃。我同时使用`cp`和`rsync`。如果您正在进行增量更新，这会变得更加严重。一种替代方法是使用该`use_cache`选项并查看其行为方式。

我们已经求助于使用 s3cmd 并使用 Unix`find`命令遍历每个文件。像这样的东西：

```
find <hdfs fuse mounted dir> -type f -exec s3cmd put {} s3://bucketname \; 
```

您也可以尝试`s3cmd sync`使用以下方法：

```
s3cmd sync /<local-dir>/ s3://bucketname 
```

# html - 使用 CKEditor 编辑整个站点

> ID：14342164
> 
> 赞同：0
> 
> 时间：2013-01-15T16:24:54.033
> 
> 标签：html, css, ckeditor

我正在尝试使用 CKEditor 编辑整个 Html 电子邮件（html、正文、标签等）（因此所有 Html 代码都在文本区域内）。

当我通过 ajax 加载 Html 并将其放在 textarea 中时，外部页面会获取加载页面的一些属性（例如，我可以看到背景颜色的变化）。

有没有办法避免这种情况？

我正在使用 CakePHP，我的部分中有这个：

```
 if($this->request->params['controller'] == 'designs')
    {
        echo $this->Html->script('ckeditor/ckeditor.js');
        echo '<script>var enableCkeditor = true;</script>';
    } else
    {
        echo '<script>var enableCkeditor = false;</script>';
    } 
```

后来我做了以下事情：

```
<script>
$(document).ready(function()
{

    if(enableCkeditor)
    {
       CKEDITOR.replace('htmleditor');
    }
});
</script> 
```

后来这个（作为表格的一部分）

```
<textarea name="html" id="htmleditor" class="ckeditor"><?php echo $thisHtml; ?></textarea> 
```

我想要实现的是创建一个 HTML 电子邮件编辑器，因此我加载的 Html 具有内联的所有样式。你们知道一个好的开源电子邮件 Html 编辑器吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T21:10:19.803

您需要通过以下方式转义 textarea 中的 HTML [`htmlentities`](http://php.net/manual/en/function.htmlentities.php)：

```
<textarea name="html" id="htmleditor" class="ckeditor"><?php echo htmlentities($thisHtml); ?></textarea> 
```

`<textarea>`和之间的任何未编码的 html`</textarea>`都被评估为常规 HTML，这意味着您正在生成一个非常无效的 HTML 文档，并且任何脚本/样式表链接标签都将被评估并应用于您的 DOM。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T15:18:39.293

查看托管页面的 html 以及加载的内容会有所帮助，但是我怀疑您正在加载具有重复托管页面的 id 的元素或加载适用于托管页面样式的内联 css。确保在两个主体之间使用不同的 id 和类名。

# listview - 按下回车时的JavaFx ListView EventHandler？

> ID：14342170
> 
> 赞同：0
> 
> 时间：2013-01-15T16:25:12.283
> 
> 标签：listview, event-handling, javafx

有没有办法在按下回车键时将事件处理程序添加到 ListView，比如`setOnAction`TextField？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T16:50:39.723

您需要添加一个 setOnKeyPressed() 并过滤“return”键

# html - video.js 视频卡在 IE9 和 IE10 中，Mac Safari 上的长度加倍

> ID：14342173
> 
> 赞同：0
> 
> 时间：2013-01-15T16:25:24.173
> 
> 标签：html, internet-explorer, safari, video.js

我的视频似乎可以在大多数平台上运行，包括 IE6-7-8，但它们在 IE9 和 IE10 的加载屏幕上卡住了。这发生在本地和网络上。

一个较小的问题：在 Mac 上的最新 Safari 版本上，它们播放两次，仅在视频的第一个实例期间播放音频（持续时间加倍）。

无论如何，这里有一个视频，例如：[http ://www.csdalbenga.it/videos/sonnyinterview.html](http://www.csdalbenga.it/videos/sonnyinterview.html)

我已经检查了这个问题：[VideoJS player gots cuck with IE9](https://stackoverflow.com/questions/8883154/videojs-player-gets-stuck-with-ie9)

但视频实际上是以正确的 h264 格式编码的，QTIndexSwapper2 告诉我视频很好。

这似乎是 video.js 特有的问题，因为如果我使用默认的 HTML5 视频播放器，视频显示得很好。

你有什么建议吗？

编辑：我似乎已经通过添加视频的完整路径而不是相对路径来解决这个问题。所以我想知道的是，为什么只有 IE9 和 IE10 才需要完整路径，并且只有当我使用 video.js 而不是标准视频播放器时才需要完整路径？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-10T02:29:31.183

您可能想要检查您的 MIME 类型。我遇到了同样的问题，并注意到我忘记为 mp4、ogg 和 webm 设置 MIME 类型。

# facebook - 使用 facebook 图表搜索帖子 api 返回的时间

> ID：14342174
> 
> 赞同：2
> 
> 时间：2013-01-15T16:25:34.187
> 
> 标签：facebook, facebook-graph-api

我正在使用 facebook graph api 搜索与特定查询匹配的帖子。但我找不到任何有关以 json 格式返回的时间戳的时区的文档。

我的查询是[这样](https://graph.facebook.com/search?q=nexus&type=post)，响应 JSON 数组，其中每个元素都有一个时间戳，如下所示：2013-01-15T14:27:49+0000

如何使用这个 timeStamp（没有时区信息）在外部网站上显示 fb 内容：

```
 <snip>post content </snip> poster-profile image</snip>
   < snip> post created 5 minutes ago </snip> 
```

编辑：我正在使用 grails 框架进行后端实现。因此使用 php 代码获取时间戳信息不会很容易

编辑 2：我正在使用搜索 api 搜索所有可公开访问的帖子，所以我没有起诉任何访问令牌。

编辑 3：关闭此问题可能与此问题[重复](https://stackoverflow.com/questions/3349293/relative-time-function-in-js-for-format-yyyy-mm-ddthhmmss0000)。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-15T17:09:01.180

查看 Facebook Docs 中的[Dates](https://developers.facebook.com/docs/reference/api/dates/)，然后查看[ISO 8601 Time Zone](http://www.cl.cam.ac.uk/~mgk25/iso-time.html#zone)。

在您的示例`2013-01-15T14:27:49+0000`中，字符串表示 14:27:49 UTC（因为它后面跟着`+0000`）。

编辑
让我扩展我的答案。一旦您知道 UTC 时间，就很容易获得要在页面上显示的时差。您可以检查 UTC 时间戳在您的时区对应的时间，然后将其与当前时间进行比较，或者检查当前的 UTC 并计算它与时间戳之间的差异。

如果你不知道怎么做，可以看看[Pretty Time Grails 插件](http://grails.org/plugin/pretty-time)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T16:43:24.993

如果你使用 PHP，你可以使用这个——

```
// DISPLAYS COMMENT POST TIME AS "1 year, 1 week ago" or "5 minutes, 7 seconds ago", etc...
function time_ago($date,$granularity=2) {
    $date = strtotime($date);
    $difference = time() - $date;
    $periods = array('decade' => 315360000,
        'year' => 31536000,
        'month' => 2628000,
        'week' => 604800, 
        'day' => 86400,
        'hour' => 3600,
        'minute' => 60,
        'second' => 1);

    foreach ($periods as $key => $value) {
        if ($difference >= $value) {
            $time = floor($difference/$value);
            $difference %= $value;
            $retval .= ($retval ? ' ' : '').$time.' ';
            $retval .= (($time > 1) ? $key.'s' : $key);
            $granularity--;
        }
        if ($granularity == '0') { break; }
    }
    return ' post created '.$retval.' ago';      
} 
```

[参考](http://www.mdj.us/web-development/php-programming/another-variation-on-the-time-ago-php-function-use-mysqls-datetime-field-type/)。

# php - Codeigniter URI 段在值中嵌入了“/”

> ID：14342177
> 
> 赞同：1
> 
> 时间：2013-01-15T16:25:36.537
> 
> 标签：php, codeigniter

使用在值中嵌入“/”的 URI 段的最佳方法是什么？例如，我正在传递一个看起来像“abc1/1”的端口号。

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T18:13:33.530

**好问题顺便说一句，**

有很多方法可以解决您的问题。但我更喜欢使用：

```
$this->uri->uri_to_assoc(); 
```

我为您的案例假设了以下网址：

```
http://localhost/nearest/nearest/index.php/welcome/testUri/x/1/abc1/1/gg 
```

所以你可以在你的控制器中做到这一点：

```
$array= $this->uri->uri_to_assoc(3); // getting from third segment and after
var_dump($array); 
```

这将输出：

```
array (size=3)
  'x' => string '1' (length=1)
  'abc1' => string '1' (length=1) //here's your argument combined as key => value
  'gg' => boolean false 
```

所以你可以简单地得到你的段，然后使用这个**“键，值”**数组。

# plsql - 执行 oracle 包函数

> ID：14342178
> 
> 赞同：3
> 
> 时间：2013-01-15T16:25:39.977
> 
> 标签：plsql, oracle11g, plsqldeveloper

嗨，我必须使用数据库中已经存在的 oracle 函数。如果我如下调用函数，它工作正常

```
select PKG_Util.employeedetails('12345') from dual; 
```

但是如果我尝试传入多个标识符，则此语句不会执行

```
select PKG_Util.employeedetails(select id from dbo.emp_details) from dual; 
```

我知道 dual 只会输出一行。

但是有没有其他方法可以在emp id 上传递多行来执行函数包并获取输出。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-15T16:29:18.547

```
select PKG_Util.employeedetails(id) from dbo.emp_details; 
```

# php - 使用 pregmatch 过滤电子邮件提供商

> ID：14342184
> 
> 赞同：0
> 
> 时间：2013-01-15T16:26:12.317
> 
> 标签：php, regex

我正在尝试阻止除某些主题之外的所有电子邮件提供商，

**PHP代码**：

```
$hostings = "/@yahoo|@gmail|@msn/";
if(!preg_match($hostings, $email))
$stop .= "Invalid Email Provider"; 
```

问题是，我不能使用大写字母！例如我不能使用这封电子邮件：

```
Gmail.com 
```

我该如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T16:36:32.160

您需要`/i`修饰符使您的正则表达式不区分大小写。

（您也可以`strtolower($email)`与您的正则表达式进行比较。）

最后，我建议你`@`吊起`/@(yahoo|gmail|msn)/`.

编辑：结合起来，你的正则表达式看起来像这样：`/@(yahoo|gmail|msn)/i`.

# php - print_r($_POST) 无法正常工作

> ID：14342185
> 
> 赞同：1
> 
> 时间：2013-01-15T16:26:12.830
> 
> 标签：php, logging

我正在尝试创建一个包含一些信息的日志文件，我的代码是，

```
 $info = date("Y-m-d  H:i:s")."    ".$_SERVER['REMOTE_ADDR']."               ".$_SERVER['REQUEST_METHOD']."         ".$_SERVER['REQUEST_URI']."          ".$_SERVER['HTTP_REFERER']."\n".$_POST."\n";

$req_dump = print_r($info, TRUE);
$fp = fopen('request.log', 'a');
fwrite($fp, $req_dump);
fclose($fp); 
```

代码记录这样的信息，

> 2013-01-15 17:10:15 192.168.0.50 POST /index.php [http://www.domain.com/article/12](http://www.domain.com/article/12) 数组

$_POST 值是数组，没有值被转储。如何更正此问题并记录 $_POST 值？

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T16:28:17.870

使用`var_export()`：

```
 $postString = var_export( $_POST, true);  
  $info = date("Y-m-d  H:i:s")."" .$_SERVER['REMOTE_ADDR']." ".
                                   $_SERVER['REQUEST_METHOD']." ".
                                   $_SERVER['REQUEST_URI']."".
                                    $_SERVER['HTTP_REFERER']."\n".  
                                    $postString."\n"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T16:31:03.983

尝试这个：

```
$info = date("Y-m-d  H:i:s")."    ".
        $_SERVER['REMOTE_ADDR']."               ".
        $_SERVER['REQUEST_METHOD']."         ".
        $_SERVER['REQUEST_URI']."          ".
        $_SERVER['HTTP_REFERER']."\n".
        print_r($_POST, TRUE)."\n";

//$req_dump = print_r($info, TRUE);
$fp = fopen('request.log', 'a');
fwrite($fp, $info);
fclose($fp); 
```

你需要做`print_r`on `$_POST`，而不是 on `$info`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-15T16:32:42.643

你只是附加`$_POST`到你的字符串。这会将其转换为 word `"Array"`，因为这就是 Array -> String 转换的工作方式。

您想要数组，`print_r`而`$_POST`不是连接的字符串。

```
$info = date("Y-m-d  H:i:s")."    ".
    $_SERVER['REMOTE_ADDR']."               ".
    $_SERVER['REQUEST_METHOD']."         ".
    $_SERVER['REQUEST_URI']."          ".
    $_SERVER['HTTP_REFERER']."\n".
    print_r($_POST, true)."\n";

$fp = fopen('request.log', 'a');
fwrite($fp, $info);
fclose($fp); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-15T16:30:57.970

您将 $_POST 中的数组放在字符串变量中，这就是您获取数组的原因。尝试这样的事情。

```
$info = date("Y-m-d  H:i:s")."    ".$_SERVER['REMOTE_ADDR']."    ".$_SERVER['REQUEST_METHOD']."         ".$_SERVER['REQUEST_URI']."          ".$_SERVER['HTTP_REFERER']."\n";
$info .= var_export($_POST) . "\n"; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-15T16:31:17.123

你试过用

```
var_dump($_POST); 
```

?

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2013-01-15T16:29:06.230

试试[file_put_contents](http://php.net/manual/fr/function.file-put-contents.php)函数。`fwrite`只需要一个字符串作为参数，并且您正在传递一个数组

# arrays - VBA 多维数组

> ID：14342186
> 
> 赞同：0
> 
> 时间：2013-01-15T16:26:20.030
> 
> 标签：arrays, vba, excel, multidimensional-array, arraylist

有没有办法在 VBA 中执行以下操作？

初始化一个多维数组并用一系列数字填充它，

```
 1  2  3  4  5 
 6  7  8  9 10
11 12 13 14 15
16 17 18 19 20 
```

然后删除一些特定的列，例如。第 1、2、4 列。因此最终结果只是第 3 列和第 5 列。

最后，如何将最终输出转换为正常的一维数组。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T16:48:20.637

假设您在 Excel 工作表中有这些列。如果您在这些列中只有这些数据，您可以简单地删除您需要的列：D 然后您将得到 2 个您想要的列。在不知道你最终真正需要什么的情况下，这是最好的盲目猜测。

例如，您的列从 B 到 F：

```
Columns("B:B").Delete Shift:=xlToLeft
Columns("C:C").Delete Shift:=xlToLeft
Columns("D:D").Delete Shift:=xlToLeft 
```

您可以使用相同的逻辑来处理数组。

*   将数组转置到工作表中。
*   删除列。
*   然后将剩下的两列转置为数组。

但是如果不将最后两列放入工作表中，您将如何处理呢？非常好奇。所以请确认你需要什么，所以这里的任何人都可以帮助你。

根据 OP 的评论进行编辑：

您可以查看以不同方式对数组进行操作的帖子和文章：

*   [Excel 根据另一张工作表中列表的内容清除单元格](https://stackoverflow.com/questions/14302891/excel-clear-cells-based-on-contents-of-a-list-in-another-sheet/14325173#14325173)
*   [VBA 数组](https://www.google.com.sg/search?q=vba+arrays&ie=utf-8&oe=utf-8&aq=t&rls=org.mozilla:en-GB:official&client=firefox-a&channel=fflb)

然后为了在 VBA 中为示例填充 2D 数组，请查看以下内容：

```
Dim i As Integer, j As Integer
Dim array2D As Variant, newArray2D as Variant
'-- 0 indexed based array with 2 rows 3 columns
ReDim array2D(0 To 1, 0 To 2)

For i = LBound(array2D, 1) To UBound(array2D, 1)
    For j = LBound(array2D, 1) To UBound(array2D, 1)
        array2D(i, j) = i + j
    Next j
Next i

'--to delete the fastest is to use the above logic (worksheet)
'-- here you don't need to declare/redimentioned the array
'-- as transpose will do it with a 1 indexed based array

newArray2D = WorksheetFunction.Transpose(Sheets(2).Range("B2:D").Value) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T17:08:12.727

要从数组中删除行或列，您必须将希望保留的数据传输到临时数组，或覆盖数组中的值。

要转换尺寸，需要一个循环。

可以在[这里找到很多函数和数组示例](http://www.cpearson.com/excel/vbaarrays.htm)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-07T17:14:49.740

下面是一些示例代码，通过循环/直接复制完全完成问题中的任务，即没有任何教育意义，但也试图演示 VBA Excel 的“切片”功能如何与 Application.WorksheetFunction.Index 实际上并没有帮助完成这项任务，即使它可能在其他方面有用：

```
Public Sub Answer()

    Dim i As Integer, j As Integer

    ' arrA contains the initial 4x5 multidimensional array
    Dim arrA(1 To 4, 1 To 5) As Integer
    For i = 1 To 4
        For j = 1 To 5
            arrA(i, j) = (i - 1) * 5 + j
        Next j
    Next i

    ' arrBv1 and v2 contain the 2x5 subset, just columns 3 and 5
    ' arrBv1 is obtained by direct copy
    Dim arrBv1(1 To 4, 1 To 2) As Variant
    For i = 1 To 4
        arrBv1(i, 1) = arrA(i, 3)
        arrBv1(i, 2) = arrA(i, 5)
    Next i

    ' arrBv2 is obtained by using Excel's "slicing" capability
    Dim arrBv2(1 To 4, 1 To 2) As Integer

    Dim slices(1 To 2) As Variant
    slices(1) = Application.WorksheetFunction.Index(arrA, 0, 3)
    slices(2) = Application.WorksheetFunction.Index(arrA, 0, 5)

    ' but because the slices are actually each 4x1 multidimensional
    ' array, a second loop is required to obtain a data structure
    ' actually equivalent to arrBv1, making this "shortcut" no
    ' shorter for producing a 4x2 array
    For i = 1 To 4
        arrBv2(i, 1) = slices(1)(i, 1)
        arrBv2(i, 2) = slices(2)(i, 1)
    Next i

    ' although arrBv1 and v2 are equivalent, as MsgBox does not appear
    For i = 1 To 4
        For j = 1 To 2
            If arrBv1(i, j) <> arrBv2(i, j) Then
                MsgBox ("equivalence failure with 4x2 arrays")
            End If
        Next j
    Next i

    ' arrCv1 is the 1x8 array obtained by direct copy from the 4x2 array
    Dim arrCv1(1 To 8) As Integer

    For i = 1 To 4
        arrCv1(i) = arrBv1(i, 1)
        arrCv1(i + 4) = arrBv1(i, 2)
    Next i

    ' arrCv2 is the one-dimensional array obtained from the slices, which
    ' does not lead to an additional step, but is not shorter
    ' than just using arrBv1 as immediately above or

    Dim arrCv2(1 To 8) As Integer

    For i = 1 To 4
        arrCv2(i) = slices(1)(i, 1)
        arrCv2(i + 4) = slices(2)(i, 1)
    Next i

    ' arrCv3 is the 1x8 array obtained from the original 4x5 array,
    ' shorter still

    Dim arrCv3(1 To 8) As Integer

    For i = 1 To 4
        arrCv3(i) = arrA(i, 3)
        arrCv3(i + 4) = arrA(i, 5)
    Next i

    ' and arrCv1, v2 and v3 are again all equivalent
    For i = 1 To 8
        If arrCv1(i) <> arrCv2(i) Or arrCv1(i) <> arrCv3(i) Then
            MsgBox ("equivalence failure with one-dimensional array")
        End If
    Next i

    ' so, in sum, nothing.

End Sub 
```

# sql-server-2008 - ozeki ng 网关中自动回复数据库用户的不完整响应

> ID：14342191
> 
> 赞同：0
> 
> 时间：2013-01-15T16:26:34.263
> 
> 标签：sql-server-2008, sms, sms-gateway

我在 ozeki ng 网关中使用自动回复数据库用户，它能够通过将传入消息中的关键字与自动回复数据库用户的脚本文件匹配并执行与关键字相关的相应查询来自动回复。但我不是获得对传入消息的完整回复。

我正在使用以下查询

k^数据

select '$sender',status,copies,course_name from search where book_name='data mining'

这里，data 是与传入消息文本匹配的关键字。当我发送带有文本“数据”的消息时。上面的查询正在执行并使用第一个属性的值给出自动回复，即状态但不是副本，课程名称....但我希望它应该回复的值所有三个属性....任何建议??..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-19T18:28:10.833

尝试 select '$sender',status + ' '+ copies+ ' '+course_name from search where book_name='data mining'

# c++ - 可以从 c++ 中删除在 python 中分配的对象吗？

> ID：14342192
> 
> 赞同：10
> 
> 时间：2013-01-15T16:26:44.937
> 
> 标签：c++, python, api

在我的程序中，我在 C++ 中管理对 python 对象的引用。即我所有的类都是从引用类派生的，它包含指向相应python对象的指针。

```
class Referenced
{
public:
    unsigned use_count() const
    { 
        return selfptr->ob_refcnt;
    }

    void add_ref() const
    {
        Py_INCREF(selfptr);
    }

    void remove_ref() const
    {
        Py_DECREF(selfptr);
    }

    PyObject* selfptr;
}; 
```

我使用 intrusive_ptr 来保存从 Referenced 派生的对象。这使我可以轻松地在 C++ 中保留对所需 python 对象的引用，并在必要时访问它们。但是当要从 C++ 中删除 python 对象时，即当我调用 Py_DECREF(selfptr) 时，我的程序崩溃（仅在 windows howewer 中），selfptr->ob_refcnt == 1。**这种方法可以吗？**

* * *

**Upd：**我终于在我的程序中发现了问题。它与对象移除没有直接关系。为了检查最初的问题，我实现了简单的扩展模块，记住对 python 对象的引用并按需释放它。就这个：

```
#include <Python.h>

static PyObject* myObj;

static PyObject* acquirePythonObject(PyObject* self, PyObject* obj)
{
    printf("trying to acquire python object %p, refcount = %d\n", obj, obj->ob_refcnt);
    myObj = obj;
    Py_INCREF(myObj);
    printf("reference acquired\n");
    return Py_True;
}

static PyObject* freePythonObject(PyObject*, PyObject*)
{
    printf("trying to free python object %p, refcount = %d\n", myObj, myObj->ob_refcnt);
    Py_DECREF(myObj);
    printf("reference removed\n");
    return Py_True;
}

static PyMethodDef moduleMethods[] =
{
    {"acquirePythonObject", acquirePythonObject, METH_O, "hold reference to python object."},
    {"freePythonObject", freePythonObject, METH_NOARGS, "free reference to python object."},
    {NULL, NULL, 0, NULL}
};

PyMODINIT_FUNC initmodule(void)
{
    Py_InitModule("module", moduleMethods);
} 
```

和python脚本：

```
import module

class Foo:
    def __init__(self):
        print "Foo is created"

    def __deinit__(self):
        print "Foo is destroyed"

def acquireFoo():
    foo = Foo()
    module.acquirePythonObject(foo)

def freeFoo():
    module.freePythonObject()

if __name__ == "__main__":
    acquireFoo()
    freeFoo() 
```

示例在 windows 和 linux 中无缝运行。下面是输出。

```
Foo is created
trying to acquire python object 0x7fa19fbefd40, refcount = 2
reference acquired
trying to free python object 0x7fa19fbefd40, refcount = 1
Foo is destoryed
reference removed 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T16:10:32.620

> 这种方法可以吗？

基本上，但是...

*   我看不到任何保证`add_ref`/`remove_ref`被正确调用的次数（使用 RAII 会自动执行此操作 - 也许这就是您的 intrusive_ptr 所做的？）
*   如果您*确实*尝试了`remove_ref`太多次，我不确定 Python 能保证什么。如果您`selfptr = NULL`在知道 refcount 从 1 -> 0 时进行设置，则可以捕捉到这个
    *   通过严重崩溃，或通过明确检查，或通过使用`Py_XDECREF`
    *   更好的是，只需`Py_CLEAR`使用

最后......你有任何故障转储或诊断信息吗？

# asp.net-mvc - ASP.NET 浏览器缓存过期

> ID：14342195
> 
> 赞同：0
> 
> 时间：2013-01-15T16:27:00.993
> 
> 标签：asp.net-mvc, caching, browser-cache, cache-control

我想为我的网站关闭浏览器缓存并设置一个过去的到期日期。

我遵循了[这篇文章](https://stackoverflow.com/questions/9406003/how-do-i-turn-off-caching-for-my-entire-asp-net-mvc-3-website)中的答案，这给我留下了几乎完美的结果，但是即使在过去设置了一个日期之后，我总是会因为缓存过期而返回 -1。

如果我删除：

```
filterContext.HttpContext.Response.Cache.SetCacheability(HttpCacheability.NoCache); 
```

前一个日期设置在我的标题中（尽管仍然启用缓存）。

由于 IE 的问题（仍然可以缓存页面），我被引导相信“-1”需要一个“实际到期日期”。

如果设置了 HttpCacheability.NoCache ，.net 是否会用 -1 覆盖 SetExpires？

# struts2 - 具有多个动作类的 Struts2 Tiles 插件

> ID：14342199
> 
> 赞同：0
> 
> 时间：2013-01-15T16:27:05.450
> 
> 标签：struts2, tiles2, struts2-tiles-plugin

在网上找到了一些很好的例子，它们将 Struts 2 与 Tiles 2 集成在一起。我注意到它们都使用来自单个动作类的通配符方法映射动作。有这样做的理由吗？当我将操作单独映射到多个类时，我的应用程序不起作用。在下面的代码中，`lookUpAll`我添加了操作。其余代码来自我试图遵循的示例。

**Struts.xml：**

```
<struts>
<package name="default" extends="struts-default">
    <result-types>
        <result-type name="tiles" class="org.apache.struts2.views.tiles.TilesResult" />
    </result-types>

    <action name="*Link" method="{1}" class="action.LinkAction">
        <result name="welcome" type="tiles">welcome</result>
        <result name="friends" type="tiles">view</result>
        <result name="office" type="tiles">office</result>
    </action>

    <action name="lookUpAll" class="action.LookupAll">
        <result name="success" type="tiles">view</result>
        <result name="error" type="tiles">lookFail</result>
    </action>
</package>
</struts> 
```

瓷砖.xml

```
<?xml version="1.0" encoding="UTF-8" ?>

<!DOCTYPE tiles-definitions PUBLIC
       "-//Apache Software Foundation//DTD Tiles Configuration 2.0//EN"
       "http://tiles.apache.org/dtds/tiles-config_2_0.dtd">

<tiles-definitions>

  <definition name="baseLayout" template="/baseLayout.jsp">
      <put-attribute name="title"  value="Template"/>
      <put-attribute name="header" value="/header.jsp"/>
      <put-attribute name="menu"   value="/menu.jsp"/>
      <put-attribute name="body"   value="/body.jsp"/>
      <put-attribute name="footer"   value="/footer.jsp"/>
  </definition>

  <definition name="welcome" extends="baseLayout">
      <put-attribute name="title"  value="Welcome"/>
      <put-attribute name="body"   value="/welcome.jsp"/>      
  </definition>

  <definition name="view" extends="baseLayout">
      <put-attribute name="title"  value="View"/>
      <put-attribute name="body"   value="/DispSchedule.jsp"/>      
  </definition>

  <definition name="lookFail" extends="baseLayout">
      <put-attribute name="title"  value="LookFail"/>
      <put-attribute name="body"   value="/lookUpFail.jsp"/>      
  </definition>

  <definition name="friends" extends="baseLayout">
      <put-attribute name="title"  value="Friends"/>
      <put-attribute name="body"   value="/friends.jsp"/>      
  </definition>

  <definition name="office" extends="baseLayout">
      <put-attribute name="title"  value="Office"/>
      <put-attribute name="body"   value="/office.jsp"/>      
  </definition>

</tiles-definitions> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T20:03:20.520

使用通配符不是必需的，但当应用程序使用单个（或多个）操作、多个方法来处理紧密耦合的功能时会很方便。

特别是对于小型应用程序和演示，这是一种最小化 XML 配置的方法。

如今，删除大部分 XML 配置并使用注释单独配置操作/方法可能更为典型。

* * *

*编辑以反映全新的问题。*

我不能复制这个问题。在 menu.jsp 和 header.jsp 中使用单行的最小 S2 应用程序以及精简的 baseLayout.jsp 会导致以下结果：

![在此处输入图像描述](../Images/57717e9de2fdbe1b0933f58ff551b05e.png)

# message-queue - 是否有任何 MQ 服务器支持失败/重试？

> ID：14342200
> 
> 赞同：1
> 
> 时间：2013-01-15T16:27:13.483
> 
> 标签：message-queue, amqp, mq

我们需要为我团队的一个应用程序提供排队解决方案。理想情况下，我们希望消息消费者拉出一条消息，对其进行处理，但如果由于某种原因处理失败，则将其放回队列中（以便可以在几分钟后重试）。是否有任何支持此工作流程的 MQ 服务器？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T16:44:19.657

任何符合 JMS 的消息传递提供程序都应该这样做。有些还在本机 API 中提供此功能。例如，[WebSphere MQ](http://ibm.co/WMQEval)通过 JTA 和本机 API 同时具有本地工作单元和全局 (XA) 工作单元。有些技术对您隐藏了这一点。例如，根据您的设置，JMS 类可以通过提交消息来“自动确认”消息。

如果您想试用 WebSphere MQ，该服务器可通过[试用下载](http://ibm.co/WMQEval)获得，并且在试用后是付费许可证。但是，[客户端是免费](http://ibm.co/SupptPacMQC75)的，服务器可以同时处理数千个客户端和每秒数百到数万条消息，具体取决于服务器类。该文档可免费获得，无需[在此处](http://pic.dhe.ibm.com/infocenter/wmqv7/v7r5/index.jsp)注册。

# c# - Windows Mobile 6.5 应用程序未显示在任务管理器中

> ID：14342209
> 
> 赞同：1
> 
> 时间：2013-01-15T16:27:28.173
> 
> 标签：c#, windows-mobile

我最近创建了我的第一个 windows mobile 6.5 应用程序，我的客户告诉我该应用程序没有出现在任务管理器中。这个问题的可能原因是什么？

*   我查了谷歌，没有
*   我在 MSDN 论坛上发帖，没有答案
*   我检查了主窗体的所有属性，我打开了控制框、最小化框、最大化框，窗体永远不会关闭......

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T16:36:28.010

你[读过这个](http://www.pcreview.co.uk/forums/application-not-visible-task-manager-t3962865.html)，它有帮助吗？本质上：表单是否`Caption`分配了文本？如果没有，它不会显示在任务管理器中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-12-18T10:11:23.843

只是为了澄清，它实际上确实“显示”在任务管理器中，如果它没有窗口标题，它是一个空白条目，但它就在那里。您可以单击它并结束进程等。

# graphics - 在Stata中，如何组合不同宽度的箱形图？

> ID：14342210
> 
> 赞同：2
> 
> 时间：2013-01-15T16:27:33.980
> 
> 标签：graphics, stata

我正在尝试将多个不同大小类别的箱形图组合起来。这是一个说明问题的示例：

```
sysuse auto

graph box mpg, by(rep78, rows(1)) name(g1, replace )
graph box mpg, by(foreign, rows(1)) name(g2, replace )

graph combine g1 g2 , ycom r(2) 
```

这给了我以下结果。

![在此处输入图像描述](../Images/e7c91f867035a44cf3c3dc4986af68f1.png)

所有的工作都按照手册进行，但我有两个关于这个输出的问题。首先 - 美学。就个人而言，我认为跨行具有相同宽度的绘图会更好看。

其次，更重要的是 - 在更复杂的图表上，类别、轴等的字体大小也按比例调整大小。因此，即使我指定，假设 - 所有图表上的轴标签的中等大小 - 其中一些会稍大或稍小。

我想知道是否可以选择以编程方式强制第二行箱形图的宽度与第一行的大小相同。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T16:59:40.857

Is this you want? It is based on a trick, but the trick is quite general.

```
sysuse auto, clear
expand 2
gen what = cond(_n <= 74, rep78, 6 + foreign)
label def what 6 Domestic 7 Foreign
label val what what
graph box mpg, by(what, note("Repair record and Foreign") row(2) holes(8 9 10)) 
```

The logic is that

1.  The two categorical variables are combined lengthwise. That ensures that each box plot will be the same size.

2.  By specifying holes, we persuade `graph box` to put graphs on two rows.

I guess that your label size problem will disappear once 1 is solved.

For even more flexibility, you may need to abandon `graph box` and use `twoway` instead. A detailed discussion was given by me in the *Stata Journal* in 2009: you can go straight to [http://www.stata-journal.com/sjpdf.html?articlenum=gr0039](http://www.stata-journal.com/sjpdf.html?articlenum=gr0039)

# php - 无法通过PHP连接到mysql数据库

> ID：14342211
> 
> 赞同：0
> 
> 时间：2013-01-15T16:27:35.703
> 
> 标签：php, mysql

最后，我完全按照这个页面（[将android应用程序连接到mysql数据库](https://stackoverflow.com/questions/5530672/connecting-android-apps-to-mysql-database)）来创建一个应用程序。改成10.0.2.2后，asker终于可以连接mysql了，但是我不能。我的代码有什么问题？我可以在浏览器--firefox 上使用 localhost 获取数据。

我从differnet教程中得到的一些解决问题但对我不起作用的问题：

1.  我还应该将 PHP 脚本中的主机更改为`10.0.2.2`吗？
2.  需要我添加用户权限 `<uses-permission android:name="android.permission.INTERNET"></uses-permission>`
3.  我已经用同样的模拟器了`API=17`

这是我的 PHP 代码

```
mysql_connect("10.0.2.2","root","password");
mysql_select_db("mydbname");
$q=mysql_query("SELECT * FROM people
WHERE
birthyear>'".$_REQUEST['year']."'");
while($e=mysql_fetch_assoc($q))
 $output[]=$e;
print(json_encode($output));
mysql_close(); 
```

我的 sql 查询

```
CREATE TABLE `people` (
 `id` INT NOT NULL AUTO_INCREMENT PRIMARY KEY ,
 `name` VARCHAR( 100 ) NOT NULL ,
 `sex` BOOL NOT NULL DEFAULT '1',
`birthyear` INT NOT NULL 
  ) 
```

安卓中的代码

```
package com.example.peoplework;

import java.io.BufferedReader;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.util.ArrayList;

import org.apache.http.HttpEntity;
import org.apache.http.HttpResponse;
import org.apache.http.NameValuePair;
import org.apache.http.client.HttpClient;
import org.apache.http.client.entity.UrlEncodedFormEntity;
import org.apache.http.client.methods.HttpPost;
import org.apache.http.impl.client.DefaultHttpClient;
import org.apache.http.message.BasicNameValuePair;
import org.json.JSONArray;
import org.json.JSONException;
import org.json.JSONObject;

import android.os.Bundle;
import android.app.Activity;
import android.util.Log;
import android.view.Menu;
import android.widget.TextView;
import android.widget.Toast;

public class Main extends Activity {

InputStream is;
private TextView tv;
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
    String result = "";
    //the year data to send
    ArrayList<NameValuePair> nameValuePairs = new ArrayList<NameValuePair>();
    nameValuePairs.add(new BasicNameValuePair("year","1990"));

    //http post
    try{
            HttpClient httpclient = new DefaultHttpClient();
            HttpPost httppost = new HttpPost("http://10.0.2.2/index.php");
            httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs));
            HttpResponse response = httpclient.execute(httppost); 
            HttpEntity entity = response.getEntity();
            is = entity.getContent();
            Log.e("log_tag", "connection success ");
            Toast.makeText(getApplicationContext(), "pass", Toast.LENGTH_SHORT).show();
    }catch(Exception e){
            Log.e("log_tag", "Error in http connection "+e.toString());
            Toast.makeText(getApplicationContext(), "fail1", Toast.LENGTH_SHORT).show();

    }
    //convert response to string
    try{
            BufferedReader reader = new BufferedReader(new InputStreamReader(is,"iso-8859-1"),8);
            StringBuilder sb = new StringBuilder();
            String line = null;
            while ((line = reader.readLine()) != null) {
                    sb.append(line + "\n");
                    Toast.makeText(getApplicationContext(), "pass", Toast.LENGTH_SHORT).show();
            }
            is.close();

            result=sb.toString();
    }catch(Exception e){
           Log.e("log_tag", "Error converting result "+e.toString());
        Toast.makeText(getApplicationContext(), "fail2", Toast.LENGTH_SHORT).show();

    }

    //parse json data
    try{
            JSONArray jArray = new JSONArray(result);
            for(int i=0;i<jArray.length();i++){
                   JSONObject json_data = jArray.getJSONObject(i);
                    Log.i("log_tag","id: "+json_data.getInt("id")+
                            ", name: "+json_data.getString("name")+
                            ", sex: "+json_data.getInt("sex")+
                            ", birthyear: "+json_data.getInt("birthyear")
                    );
                    Toast.makeText(getApplicationContext(), "pass", Toast.LENGTH_SHORT).show();
           }
            tv = (TextView)findViewById(R.id.get_record);
            tv.setText(jArray.toString());

    }catch(JSONException e){
            Log.e("log_tag", "Error parsing data "+e.toString());
            Toast.makeText(getApplicationContext(), "fail3", Toast.LENGTH_SHORT).show();
    }
}

} 
```

显现

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
package="com.example.peoplework"
android:versionCode="1"
android:versionName="1.0" >

<uses-sdk
    android:minSdkVersion="17"
    android:targetSdkVersion="17" />

<application
    android:allowBackup="true"
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name"
    android:theme="@style/AppTheme" >
    <activity
        android:name="com.example.peoplework.Main"
        android:label="@string/app_name" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
</application> 
```

并且日志错误以粗体显示。

```
01-15 15:29:34.805: D/AndroidRuntime(1741): >>>>>> AndroidRuntime START   com.android.internal.os.RuntimeInit <<<<<<
01-15 15:29:34.805: D/AndroidRuntime(1741): CheckJNI is ON
01-15 15:29:34.825: D/dalvikvm(1741): Trying to load lib libjavacore.so 0x0
01-15 15:29:34.835: D/dalvikvm(1741): Added shared lib libjavacore.so 0x0
01-15 15:29:34.845: D/dalvikvm(1741): Trying to load lib libnativehelper.so 0x0
01-15 15:29:34.845: D/dalvikvm(1741): Added shared lib libnativehelper.so 0x0
01-15 15:29:35.305: D/AndroidRuntime(1741): Calling main entry com.android.commands.pm.Pm
01-15 15:29:35.315: D/AndroidRuntime(1741): Shutting down VM
01-15 15:29:35.326: D/dalvikvm(1741): GC_CONCURRENT freed 100K, 19% free 470K/576K, paused 1ms+1ms, total 8ms
01-15 15:29:35.326: D/dalvikvm(1741): Debugger has detached; object registry had 1 entries
01-15 15:29:35.795: D/AndroidRuntime(1754): >>>>>> AndroidRuntime START com.android.internal.os.RuntimeInit <<<<<<
01-15 15:29:35.795: D/AndroidRuntime(1754): CheckJNI is ON
01-15 15:29:35.815: D/dalvikvm(1754): Trying to load lib libjavacore.so 0x0
01-15 15:29:35.825: D/dalvikvm(1754): Added shared lib libjavacore.so 0x0
01-15 15:29:35.835: D/dalvikvm(1754): Trying to load lib libnativehelper.so 0x0
01-15 15:29:35.835: D/dalvikvm(1754): Added shared lib libnativehelper.so 0x0
01-15 15:29:36.305: D/AndroidRuntime(1754): Calling main entry com.android.commands.am.Am
01-15 15:29:36.305: D/dalvikvm(1754): Note: class Landroid/app/ActivityManagerNative; has 156 unimplemented (abstract) methods
01-15 15:29:36.325: I/ActivityManager(263): Force stopping package com.example.peoplework appid=10047 user=-1
01-15 15:29:36.325: I/ActivityManager(263): Killing proc  1726:com.example.peoplework/u0a10047: force stop com.example.peoplework
01-15 15:29:36.325: W/ActivityManager(263): Force removing ActivityRecord{2c4b7b80 u0 com.example.peoplework/.Main}: app died, no saved state
01-15 15:29:36.375: I/WindowState(263): WIN DEATH: Window{2c6ce6e8 u0 com.example.peoplework/com.example.peoplework.Main}
01-15 15:29:36.415: I/ActivityManager(263): START u0 {act=android.intent.action.MAIN cat=[android.intent.category.LAUNCHER] flg=0x10000000 cmp=com.example.peoplework/.Main} from pid 1754
01-15 15:29:36.435: D/AndroidRuntime(1754): Shutting down VM
01-15 15:29:36.446: D/dalvikvm(1754): GC_CONCURRENT freed 101K, 18% free 504K/608K, paused 0ms+1ms, total 8ms
01-15 15:29:36.446: D/jdwp(1754): Got wake-up signal, bailing out of select
01-15 15:29:36.446: D/dalvikvm(1754): Debugger has detached; object registry had 1 entries
01-15 15:29:36.515: E/SurfaceFlinger(37): ro.sf.lcd_density must be defined as a build property
01-15 15:29:36.526: I/Choreographer(394): Skipped 33 frames!  The application may be doing too much work on its main thread.
**01-15 15:29:36.675: E/SurfaceFlinger(37): ro.sf.lcd_density must be defined as a build property**
01-15 15:29:36.696: D/dalvikvm(1765): Not late-enabling CheckJNI (already on)
01-15 15:29:36.715: I/ActivityManager(263): Start proc com.example.peoplework for activity com.example.peoplework/.Main: pid=1765 uid=10047 gids={50047, 3003, 1028}
01-15 15:29:36.725: W/InputMethodManagerService(263): Got RemoteException sending setActive(false) notification to pid 1726 uid 10047
**01-15 15:29:36.985: E/Trace(1765): error opening trace file: No such file or directory (2)**
01-15 15:29:37.005: W/ActivityThread(1765): Application com.example.peoplework is waiting for the debugger on port 8100...
01-15 15:29:37.036: I/System.out(1765): Sending WAIT chunk
01-15 15:29:37.045: I/dalvikvm(1765): Debugger is active
01-15 15:29:37.234: I/System.out(1765): Debugger has connected
01-15 15:29:37.234: I/System.out(1765): waiting for debugger to settle...
01-15 15:29:37.374: I/Choreographer(263): Skipped 34 frames!  The application may be doing too much work on its main thread.
01-15 15:29:37.435: I/System.out(1765): waiting for debugger to settle...
01-15 15:29:37.594: I/Choreographer(263): Skipped 55 frames!  The application may be doing too much work on its main thread.
01-15 15:29:37.604: E/SurfaceFlinger(37): ro.sf.lcd_density must be defined as a build property
01-15 15:29:37.644: I/System.out(1765): waiting for debugger to settle...
01-15 15:29:37.845: I/System.out(1765): waiting for debugger to settle...
01-15 15:29:38.045: I/System.out(1765): waiting for debugger to settle...
01-15 15:29:38.270: I/System.out(1765): waiting for debugger to settle...
01-15 15:29:38.490: I/System.out(1765): waiting for debugger to settle...
01-15 15:29:38.720: I/System.out(1765): debugger has settled (1359)
01-15 15:29:39.845: D/dalvikvm(1765): threadid=1: still suspended after undo (sc=1 dc=1)
01-15 15:29:46.436: W/ActivityManager(263): Launch timeout has expired, giving up wake lock!
01-15 15:29:46.948: W/ActivityManager(263): Activity idle timeout for ActivityRecord{2c9fdd70 u0 com.example.peoplework/.Main}
01-15 15:30:51.805: I/InputDispatcher(263): Application is not responding: AppWindowToken{2c96db20 token=Token{2c9f1af8 ActivityRecord{2c9fdd70 u0 com.example.peoplework/.Main}}}.  It has been 5031.2ms since event, 5030.0ms since wait started.  Reason: Waiting because there is no touchable window that can handle the event but there is focused application that may eventually add a new window when it finishes starting up.
01-15 15:30:51.805: I/WindowManager(263): Input event dispatching timed out sending to application AppWindowToken{2c96db20 token=Token{2c9f1af8 ActivityRecord{2c9fdd70 u0 com.example.peoplework/.Main}}}
01-15 15:30:56.903: I/InputDispatcher(263): Dropped event because it is stale.
01-15 15:30:56.905: I/InputDispatcher(263): Dropped event because it is stale.
01-15 15:30:56.905: I/InputDispatcher(263): Dropped event because it is stale.
01-15 15:31:30.845: D/AndroidRuntime(1780): >>>>>> AndroidRuntime START com.android.internal.os.RuntimeInit <<<<<<
01-15 15:31:30.845: D/AndroidRuntime(1780): CheckJNI is ON
01-15 15:31:30.865: D/dalvikvm(1780): Trying to load lib libjavacore.so 0x0
01-15 15:31:30.875: D/dalvikvm(1780): Added shared lib libjavacore.so 0x0
01-15 15:31:30.885: D/dalvikvm(1780): Trying to load lib libnativehelper.so 0x0
01-15 15:31:30.885: D/dalvikvm(1780): Added shared lib libnativehelper.so 0x0
01-15 15:31:31.345: D/AndroidRuntime(1780): Calling main entry com.android.commands.pm.Pm
01-15 15:31:31.365: D/AndroidRuntime(1780): Shutting down VM
01-15 15:31:31.365: D/dalvikvm(1780): GC_CONCURRENT freed 100K, 18% free 470K/572K, paused 1ms+1ms, total 5ms
01-15 15:31:31.365: D/dalvikvm(1780): Debugger has detached; object registry had 1 entries
01-15 15:31:31.834: D/AndroidRuntime(1792): >>>>>> AndroidRuntime START com.android.internal.os.RuntimeInit <<<<<<
01-15 15:31:31.834: D/AndroidRuntime(1792): CheckJNI is ON
01-15 15:31:31.864: D/dalvikvm(1792): Trying to load lib libjavacore.so 0x0
01-15 15:31:31.864: D/dalvikvm(1792): Added shared lib libjavacore.so 0x0
01-15 15:31:31.884: D/dalvikvm(1792): Trying to load lib libnativehelper.so 0x0
01-15 15:31:31.884: D/dalvikvm(1792): Added shared lib libnativehelper.so 0x0
01-15 15:31:32.325: D/AndroidRuntime(1792): Calling main entry com.android.commands.am.Am
01-15 15:31:32.325: D/dalvikvm(1792): Note: class Landroid/app/ActivityManagerNative; has 156 unimplemented (abstract) methods
01-15 15:31:32.345: I/ActivityManager(263): START u0 {act=android.intent.action.MAIN cat=[android.intent.category.LAUNCHER] flg=0x10000000 cmp=com.example.peoplework/.Main} from pid 1792
01-15 15:31:32.345: D/AndroidRuntime(1792): Shutting down VM
01-15 15:31:32.355: D/dalvikvm(1792): GC_CONCURRENT freed 101K, 17% free 501K/604K, paused 0ms+0ms, total 6ms
01-15 15:31:32.355: D/dalvikvm(1792): Debugger has detached; object registry had 1 entries
01-15 15:31:37.545: D/dalvikvm(1765): Debugger has detached; object registry had 362 entries
01-15 15:31:37.545: I/dalvikvm(1765): ignoring registerObject request in thread=1
01-15 15:31:37.545: I/dalvikvm(1765): ignoring registerObject request in thread=1
**01-15 15:31:37.585: E/log_tag(1765): Error in http connection android.os.NetworkOnMainThreadException
01-15 15:31:37.596: E/log_tag(1765): Error converting result  java.lang.NullPointerException: lock == null
01-15 15:31:37.605: E/log_tag(1765): Error parsing data org.json.JSONException: End of input at character 0 of 
01-15 15:31:37.775: E/SurfaceFlinger(37): ro.sf.lcd_density must be defined as a build property
01-15 15:31:37.875: E/SurfaceFlinger(37): ro.sf.lcd_density must be defined as a build property**
01-15 15:31:37.895: I/Choreographer(1765): Skipped 31 frames!  The application may be doing too much work on its main thread.
01-15 15:31:37.935: D/gralloc_goldfish(1765): Emulator without GPU emulation detected.
01-15 15:31:37.995: I/ActivityManager(263): Displayed com.example.peoplework/.Main: +2m1s309ms
01-15 15:31:39.685: E/SurfaceFlinger(37): ro.sf.lcd_density must be defined as a build property
01-15 15:31:41.855: E/SurfaceFlinger(37): ro.sf.lcd_density must be defined as a build property
01-15 15:31:42.555: I/Choreographer(263): Skipped 38 frames!  The application may be doing too much work on its main thread.
: E/(): Device disconnected 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T18:10:51.773

试试这个而不是你的 PHP 代码：

```
 $link = mysqli_connect("10.0.2.2","root","password","mydbname");
  $q=mysqli_query("SELECT * FROM people WHERE birthyear>'".$_REQUEST['year']."'");
  while($e=mysqli_fetch_array($q, MYSQL_BOTH))
  $output[]=$e;
  print(json_encode($output));
  mysqli_close($link); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T07:54:17.377

我按照本教程进行操作，问题就解决了。虽然解释是中文的，但希望它可以帮助其他人解决类似的问题。谢谢大家帮助我！！！！

[使用 PHP 连接到 mysql](http://seanstar5317.pixnet.net/blog/post/28092031-%5Bandroid%5D%E5%BE%9Emysql-%E6%8A%93%E8%B3%87%E6%96%99%EF%BC%8C%E5%8B%95%E6%85%8B%E6%96%B0%E5%A2%9Etextview%E8%87%B3tablela)

# android - 无法在清单中注册我的 BroadcastReceiver

> ID：14342213
> 
> 赞同：0
> 
> 时间：2013-01-15T16:27:40.603
> 
> 标签：android, broadcastreceiver, android-manifest

我在 android 清单文件中注册我的广播接收器时遇到问题

我创建了一个 BroadcastReceiver，它检查用户是否单击通知将他带到地图活动。问题是当我点击我的通知消失时，我认为这是由于我的广播接收器没有成功注册。我正在使用 Eclipse IDE。

以下是我的 android 清单 Xml

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
package="com.example.fyp_api_8_team"
android:versionCode="1"
android:versionName="1.0.0" android:installLocation="auto">

<uses-permission android:name="android.permission.INTERNET" />
<uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION" />
<uses-permission android:name="android.permission.ACCESS_FINE_LOCATION" />
<uses-permission android:name="android.permission.VIBRATE" />

<uses-sdk android:minSdkVersion="9" />

<application
    android:name="com.example.fyp_api_8_team.MyGobalClass"
    android:icon="@drawable/shazam"
    android:label="@string/app_name"
    android:theme="@style/AppTheme" >
    <uses-library android:name="com.google.android.maps" />

    <activity
        android:name="com.example.fyp_api_8_team.SplashScreen"
        android:label="@string/app_name"
        android:theme="@android:style/Theme.NoTitleBar" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
    <activity
        android:name="com.example.fyp_api_8_team.Login_Form"
        android:label="@string/app_name" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN.Register_form" />

            <category android:name="android.intent.category.DEFAULT" />
        </intent-filter>
    </activity>
    <activity
        android:name="com.example.fyp_api_8_team.Register_form"
        android:label="@string/app_name" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN.Register_form" />

            <category android:name="android.intent.category.DEFAULT" />
        </intent-filter>
    </activity>
    <activity
        android:name="com.example.fyp_api_8_team.Forget_form"
        android:label="@string/app_name" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN.Forget_form" />

            <category android:name="android.intent.category.DEFAULT" />
        </intent-filter>
    </activity>
    <activity
        android:name="com.example.fyp_api_8_team.Create_Meeting_Form"
        android:label="@string/app_name" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN.Create_Meeting_form" />

            <category android:name="android.intent.category.DEFAULT" />
        </intent-filter>
    </activity>
    <activity
        android:name="com.example.fyp_api_8_team.Create_Team_Form"
        android:label="@string/app_name" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN.Create_Team_Form" />

            <category android:name="android.intent.category.DEFAULT" />
        </intent-filter>
    </activity>
    <activity
        android:name="com.example.fyp_api_8_team.Map_Location"
        android:label="@string/app_name"
        android:theme="@android:style/Theme.NoTitleBar" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN.Map_Location" />

            <category android:name="android.intent.category.DEFAULT" />
        </intent-filter>
    </activity>
    <activity
        android:name="com.example.fyp_api_8_team.Main"
        android:label="@string/app_name" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN.Main" />

            <category android:name="android.intent.category.DEFAULT" />
        </intent-filter>
    </activity>
    <activity
        android:name="com.example.fyp_api_8_team.Register_Form"
        android:label="@string/app_name" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN.Register_Form" />

            <category android:name="android.intent.category.DEFAULT" />
        </intent-filter>
    </activity>
    <activity android:name="com.example.fyp_api_8_team.MainPreferenceActivity" >
    </activity>
    <activity
        android:name="com.example.fyp_api_8_team.Team_Members"
        android:label="@string/app_name" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN.Create_Team_Form..Team_Members" />

            <category android:name="android.intent.category.DEFAULT" />
        </intent-filter>
    </activity>
    <activity
        android:name="com.example.fyp_api_8_team.Show_Map"
        android:label="@string/title_activity_show__map" >
    </activity>

    <service android:name="com.example.fyp_api_8_team.Services.ScheduleService" />
    <service android:name="com.example.fyp_api_8_team.Services.NotifyService" />
    <receiver android:name="com.example.fyp_api_8_team.MyBroadcastReceiver" android:enabled="true"></receiver>
</application> 
```

这是 MyBroadcastReceiver 类

```
package com.example.fyp_api_8_team;
 import com.example.fyp_api_8_team.R;
 import com.example.fyp_api_8_team_AlertMap.Show_Map;
 import android.app.Notification;
 import android.app.NotificationManager;
 import android.app.PendingIntent;
 import android.content.BroadcastReceiver;
 import android.content.Context;
 import android.content.Intent;     
 import android.os.Vibrator;
 import android.util.Log;

    public class MyBroadcastReceiver extends BroadcastReceiver {
private NotificationManager mNotificationManager;
public static int SIMPLE_NOTFICATION_ID;
public static String title, Message;
public static int Meetingid, pos;

@Override
public void onReceive(Context context, Intent intent) {

    mNotificationManager = (NotificationManager) context
            .getSystemService(Context.NOTIFICATION_SERVICE);
    Notification notifyDetails = new Notification(
            R.drawable.stat_notify_more, "You Alarm is here",
            System.currentTimeMillis());

    // take you to the Map class by notification click
    Intent notificationIntent = new Intent(context, Show_Map.class);

    PendingIntent myIntent = PendingIntent.getActivity(context, 0,
            notificationIntent, 0);

    // Sets the Map class for the particular notification of event
    Show_Map.position = pos;
    notifyDetails.setLatestEventInfo(context, title,
            "Click on me to view you Meeting Location", myIntent);

    notifyDetails.flags |= Notification.FLAG_AUTO_CANCEL;
    notifyDetails.flags |= Notification.DEFAULT_SOUND;
    mNotificationManager.notify(SIMPLE_NOTFICATION_ID, notifyDetails);

    Log.i(getClass().getSimpleName(), "Sucessfully Notification Clicked");

    // Vibrate the mobile phone
    Vibrator vibrator = (Vibrator) context
            .getSystemService(Context.VIBRATOR_SERVICE);
    vibrator.vibrate(2000);
} 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T16:32:41.520

您需要像这样声明它：

```
<receiver android:name="com.example.fyp_api_8_team.MyBroadcastReceiver">
            <intent-filter>
                <action android:name="**your_action_name**" />
            </intent-filter>
        </receiver> 
```

# php-gtk - 在运行 OS X 10.7.5 的 Mac 上安装 PHP GTK 时遇到问题

> ID：14342215
> 
> 赞同：0
> 
> 时间：2013-01-15T16:27:48.250
> 
> 标签：php-gtk

我和一位同事正在尝试在运行 OS X 10.7.5 的 Mac 上安装 PHP GTK。当我们尝试安装 PHP GTK 运行所必需的 phpize 时，我们收到以下错误消息：

> `lib-mug182:php-gtk vika$ sudo ./buildconf --with-phpize=/usr/bin/phpize Password: Configuring for: PHP Api Version: 20090626 Zend Module Api No: 20090626 Zend Extension Api No: 220090626 rebuilding aclocal.m4 rebuilding configure make[1]: autoconf: No such file or directory make[1]: *** [configure] Error 1 make: *** [all] Error 2`

看起来它找不到autoconf。我对 Mac 不熟悉，所以我现在不确定如何进行。

我们尝试按照 PHP GTK 网站上的说明进行操作，以在 Mac 上安装 php gtk（可在[http://gtk.php.net/manual/en/tutorials.installation.macosx.php](http://gtk.php.net/manual/en/tutorials.installation.macosx.php)
和 [http://gtk 获得。 php.net/manual/en/tutorials.installation.macosx-stepbystep.php](http://gtk.php.net/manual/en/tutorials.installation.macosx-stepbystep.php) ），并在我们陷入困境的方向上达到了这一点：

```
 >Step 7 - Getting PHP-GTK2 
```

>

> 您可能不想使用当前的 CVS，而是使用 >PHP-GTK2 下载页面中的最新官方版本。
> 
> 为了安全起见，让 X11 保持打开状态。phpize 和 php-config 应该都在 /opt/local /bin/ 中。在运行它之前检查一下。在终端中，键入：
> 
> `sudo cvs -d :pserver:cvsread@cvs.php.net:/repository co php-gtk cd php-gtk sudo ./buildconf --with-phpize=/opt/local/bin/phpize sudo ./configure --with-php-config=/opt/local/bin/php-config sudo make sudo make install`

感谢您提出的任何建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T03:08:37.417

试试这个安装程序。它是葡萄牙语，但很容易翻译：

[http://www.php-gtk.com.br/mac](http://www.php-gtk.com.br/mac)

# firefox - IndexedDB 是否复制本地文件以存储离线应用程序？

> ID：14342218
> 
> 赞同：0
> 
> 时间：2013-01-15T16:27:55.487
> 
> 标签：firefox, indexeddb

[Firefox 只允许通过扩展](https://stackoverflow.com/questions/12145622/firefox-extensions-and-full-file-paths-from-html-form)访问完整的文件路径

也有人说，如果您将文件存储在 IndexedDB 中，它们存储在外部，在 DB 之外（请参阅[this](https://hacks.mozilla.org/2012/07/why-no-filesystem-api-in-firefox/)）

~~如果我将一堆文件插入 IndexedDB，将其关闭，然后返回 tmw 并打开数据库，它怎么知道我昨天插入的文件在哪里？~~

IndexedDB 是否可以访问完整的文件路径？如果是这样，我可以通过 InexedDb 访问完整的文件路径吗？

~~或者 IndexedDB 是否制作重复副本？~~

（这是离线使用）

**编辑**
我可以在 IndexedDB 中存储一堆具有自己单独键的文件，并对其进行迭代以重新填充应用程序。

IndexedDB 足够聪明，不会存储文件的相同副本。它是如何做到的？

最重要的是，如果应用程序是供离线使用的图像查看器，那么将这些图像导入 IndexedDB 进行管理将复制文件（？）现在我有两组假期照片。这个对吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T19:49:03.177

我的猜测是这些文件将存储在 indexeddb 数据库所在的同一位置。有关在哪里找到它的更多信息，请查看[我](http://www.kristofdegrave.be/2011/11/indexed-db-deleting-your-database.html)前段时间写的关于 indexeddb 位置的帖子

# webview - 从 webviews Javascript 调用 C++ 方法

> ID：14342220
> 
> 赞同：3
> 
> 时间：2013-01-15T16:28:13.043
> 
> 标签：webview, qml, qtwebkit, qt5

在 qt4 qml 中，qtwebkit 1.0 组件 webview 有一个属性`javaScriptWindowObjects`。我用它来将 javaScriptWindowObjects 添加到我的网页 javascript 的上下文中以调用 c++ 函数。像这样

```
WebView{
    url: "http://test.com"
    anchors.fill: parent
    scale: 1.0

    javaScriptWindowObjects: QtObject {
        WebView.windowObjectName: "native"

        function foo(x, y) {
             console.log("This is a call from javascript");
             myCppHandler.fooNative(b,c);
         }
    }
} 
```

所以我可以像这样从网页javascript调用它

```
<script type="text/javascript">
    native.foo(1,2)
</script> 
```

但是在 qt5 qml qtwebkit 3.0 中没有类似的东西`javaScriptWindowObjects`

我怎样才能在 qt5 qml 中实现这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-16T18:24:30.013

只是为了完成这项工作的记录：

```
import QtQuick 2.0
import QtWebKit 3.0
import QtWebKit.experimental 1.0

Rectangle {

   width: 1024
   height: 768

   WebView{
       url: "http://localhost"
       anchors.fill: parent

       experimental.preferences.navigatorQtObjectEnabled: true
       experimental.onMessageReceived: {

           console.debug("get msg from javascript")
           experimental.postMessage("HELLO")
       }
   } // webview
} // rectanlge

<html>
<body>
<h1>It just works!</h1>

<p>Play with me...</p>

<button onclick="nativecall();">test</button>
<div id="out"></div>

<script type="text/javascript">
    function nativecall(){
        console.log("will try native call");
        var elem = document.getElementById("out").innerHTML="clicked";
        navigator.qt.postMessage('this is a js call');
    }

    function jsCall(message){
        var elem = document.getElementById("out").innerHTML="and the other way around " + message;
    }

    navigator.qt.onmessage = function(ev) {
        jsCall(ev.data);
    }
</script>

</body>
</html> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-05-10T06:07:08.383

Qt 5.8.0 QML & JavaScript 绑定

QML 代码

```
import QtQuick 2.0
import QtWebEngine 1.4
import QtWebChannel  1.0

Item{
    id:root
    height: 500
    width:  500

// Create WebChannel
WebChannel{
    id:webChannel
}

//Now, let’s create an object that we want to publish to the HTML/JavaScript clients:
QtObject {
    id: myObject
    objectName: "myObject"

    // the identifier under which this object
    // will be known on the JavaScript side
    //WebChannel.id: "webChannel"

    property var send: function (arg) {
                sendTextMessage(arg);
            }

    // signals, methods and properties are
    // accessible to JavaScript code
    signal someSignal(string message);

    function someMethod(message) {
        console.log(message);
        someSignal(message);
        return dataManager.getGeoLat();
    }

    property string hello: "world";
}

Rectangle{
    anchors.fill: parent
    color: "black"

WebEngineView{
    id : webEnginView
    anchors.fill: parent
    url : dataManager.htmlURL();
    webChannel: webChannel
}
}

Component.onCompleted: {
    webChannel.registerObject("foo", myObject);
}
} 
```

HTML 代码

```
<script type="text/javascript" src="qrc:/Map/qwebchannel.js"></script>
<script type="text/javascript">
new QWebChannel(qt.webChannelTransport, function(channel) {
    // all published objects are available in channel.objects under
    // the identifier set in their attached WebChannel.id property
    var foo = channel.objects.foo;

    // access a property
    alert(foo.hello);

    // connect to a signal
    foo.someSignal.connect(function(message) {
        alert("Got signal: " + message);
    });

    // invoke a method, and receive the return value asynchronously
       foo.someMethod("bar", function(ret) {
       alert("Got return value: " + ret);
    });
});
</script> 
```

# python - python 2.4 按特定列对文本文件进行排序

> ID：14342222
> 
> 赞同：2
> 
> 时间：2013-01-15T16:28:15.977
> 
> 标签：python, csv

对 python 完全陌生，我在使用 2.4 版时遇到问题

我有一个包含 3 列的文本文件，它们是制表符分隔的，不是单个制表符，而是 9 个制表符。1000 行文件例如：

```
$1$sda4356:[sgb1_diska5.ldlbat44.libabl]talild_0329_base.rpt                                talild_0329_base.rpt                                                                      00000000000000005062 
```

我需要做的是按第 3 列（ 00000000000000005062 ）对所有内容进行排序。

使用 csv 阅读器是处理此问题的最佳方式吗？我如何让它来处理我的文本文件使用 9 个选项卡来分隔每一列的事实。我发现的大多数其他东西与 python 2.4 不兼容。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-15T16:34:25.980

由于您使用的是 9 个选项卡，`str.split`因此它似乎应该能够正确处理这个问题，（但我看不出有什么理由`csv`会窒息它......）：

```
fobj = open('data.csv')
data = [ x.split() for x in fobj ]
fobj.close()  #don't forget to close :) 
```

或者可能：

```
delim = '\t'*9
data = [ x.split(delim) for x in fobj ] 
```

然后你可以排序。在较新版本的 python 中，你会这样做：

```
from operator import itemgetter
data.sort(key=itemgetter(2)) 
```

先试试这个！（根据评论和[文档](http://docs.python.org/2/library/stdtypes.html#mutable-sequence-types)，`key`python2.4 支持，但 python2.3 不支持）。 [`operator.itemgetter`](http://docs.python.org/2/library/operator.html#operator.itemgetter)也是“python2.4 中的新内容”，`itemgetter(2)`相当于`lambda x:x[2]`或更详细：

```
def get2(x):
    return x[2] 
```

* * *

但我认为您可能需要依赖`cmp`与真正旧的 python 版本的兼容性（注意，python3 不再支持`cmp`）：

```
def compare(x1,x2):
    if x1[2] > x2[2]:
       return 1
    elif x1[2] < x2[2]:
       return -1
    else:
       return 0 
```

然后你会排序：

```
data.sort(cmp=compare) 
```

# php - 在每次执行脚本时存储变量值 - PHP

> ID：14342227
> 
> 赞同：0
> 
> 时间：2013-01-15T16:28:41.410
> 
> 标签：php, xml

我有这个代码：

```
$filename = 'files.xml';
$dom = new DomDocument();

$dom->load($filename);

$oldCount = '';

$newCount = $dom->getElementsByTagName('file')->length;

if($newCount == $oldCount){
echo "There are no new elements in the XML.\n";
}

else {
 echo "New Count is: ".$newCount."\n";
 echo "Old Count is: ".$oldCount."\n";

for ($oldCount =0; $oldCount < $newCount; $oldCount++){
    $file = file_get_contents('files.xml');
    $xml = simplexml_load_string($file); 

    $result = $xml->xpath('file');
    echo "File ".($oldCount+1).": ".$result[$oldCount]."\n\n";
    //echo "Old: ".$oldCount."\n";
    //echo "New: ".$newCount."\n";
   }
   $oldCount = $newCount;
   //echo "Old Count at the end: ".$oldCount."\n";
}
echo "Old Count at the end: ".$oldCount."\n"; 
```

我想要做的是确保的值`$oldCount`存储在末尾，这样，如果 files.xml 在 中具有相同数量的元素，它将显示 - “XML 中没有新元素”当程序运行时跑第二次。

出于测试目的，我的 xml 中有 2 个元素，这意味着我的 xml 看起来像：

```
<?xml version="1.0"?>
<files>
  <file>.DS_Store</file>
  <file>ID2PDF_log_2.xml</file>
</files> 
```

所以，如果我只用这两个元素运行我的 test.php，它应该第一次显示信息。但是，我第二次运行它时，它应该会显示该消息。很明显我`variable scope`在 PHP 方面很弱。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T16:51:53.013

命令行不支持没有变通方法的会话，因为会话通常依赖于 cookie（命令行中不存在）或传递 url 查询参数。

相反，只需将您的号码转储到文件中，例如

```
file_put_contents('count.txt', $count); 
```

然后稍后再读，例如

```
$count = file_get_contents('count.txt'); 
```

# scala - 如何在视图中创建只读字段

> ID：14342234
> 
> 赞同：6
> 
> 时间：2013-01-15T16:29:08.140
> 
> 标签：scala, playframework-2.0

我有一个包含 2 个字段的表单 -`empno`和`name`. 两者都用默认值填充。在视图中显示时，我想要`empno`的是只读且`name`可编辑的。

在视图创建中，我使用`@leaveform.value.get.empno`的是仅显示就绪并且工作正常。该问题仅在插入错误时发生`([NoSuchElementException: None.get])`。

问题：

1.  问题是返回错误没有值属性。我还能用什么来获得价值？
2.  我可以跳过`@inputText`只读字段吗？

请参阅下面我的代码：

```
// ***** CONTROLLER *****//

val leaveform = Form[LeaveModel](
      mapping(
          "empno" -> nonEmptyText,
          "name" -> nonEmptyText
      )((no, empno) => LeaveModel(empno, name))
      ((leave: LeaveModel) => Some(leave.empno, leave.name))
)

def create = withAuth { username => implicit request =>

  // Define default values
  val empno = "STUDENT"
  val name = ""

  // Set default values
  val filledForm = leaveform.fill(LeaveModel(empno,name))
  Ok(html.leave.form(filledForm))
}

def insert = Action (
    implicit request => {
        leaveform.bindFromRequest.fold(
            error => {
                BadRequest(html.leave.form(error)) // Question 1\. Here is the error.
            },
            leave => {
               LeaveModel.insert(leave)
               Redirect(routes.indexController.index())
            }
        )  
      }
  )

// ***** VIEW START***** //
@(leaveform: Form[LeaveModel])
@leaveform.value.get.empno
@helper.form(
    action = (routes.LeaveController.update(oid)),
        'id -> "leaveform") {
            @inputText(leaveform("empno")) // Question 2\. 
            @inputText(leaveform("name"))
        } 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-01-15T19:53:15.343

使用表单助手不是强制性的。如果您使用它们，您可以`readonly`使用 CSS 传递属性或样式字段以使其看起来只读。

*   CSS 禁用 Twitter 引导程序：

    ```
    @inputText(
        editForm("createdOn"), 
        'id -> "createdOn", 
        'class -> "input-xlarge disabled", 
        '_label -> Messages("createdOn"), 
        '_help -> ""
    ) 
    ```

*   传递可选属性：`readonly`

    ```
    @inputText(
        editForm("createdOn"), 
        'id -> "createdOn", 
        'class -> "input-xlarge", 
        '_label -> Messages("createdOn"), 
        'readonly -> "readonly", 
        '_help -> " This is read only"
    ) 
    ```

*   您也可以不重新发送该字段，但显示其值：

    ```
    <span class="date">Created on: @editForm("createdOn").value</span> 
    ```

*   2018-01-24 更新

Play field 现在返回 a `Optional`，[请参阅 docs](https://playframework.com/documentation/2.6.x/api/java/index.html)。这意味着您可以从以下字段中获取值：

*   `@form("fieldName").getValue.get`（可以扔一个`NPE`）
*   `@form("fieldName").getValue.getOrElse("defaultValue")`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T09:27:18.877

在向用户返回表单时尝试使用 Flash 上下文：

```
def create = withAuth { username => implicit request =>
        // leaveForm initialization as before

        // use form data from flash if present
        val form = if (flash.get("error").isDefined)
            leaveForm.bind(flash.data)
        else
            leaveForm
        Ok(stakeholders.register(form))
}

def insert = Action { implicit request =>
        leaveForm.bindFromRequest.fold(
                hasErrors = { form =>
                    Redirect(routes.Leaves.create).  // put correct route here
                        flashing(Flash(form.data) +
                            ("error" -> Messages("validation.errors"))) // customize error message
                },
                leave => {
                    LeaveModel.insert(leave)
                    Redirect(routes.indexController.index())
            }
        )
    } 
```

HTH，埃里希

# c# - 从带有 Razor @Html.RouteLink 的路由生成的 MVC 4 URL

> ID：14342240
> 
> 赞同：1
> 
> 时间：2013-01-15T16:29:25.340
> 
> 标签：c#, c#-4.0

`Html.RouteLink`我在使用路由方法生成 URL 时遇到问题。

我的路线：

```
routes.MapRoute(
            name: "DefaultPage",
            url: "",
            defaults: new { controller = "Home", action = "Index" }
        );

        routes.MapRoute(
            name: "MessagesIndex",
            url: "{controller}/{page}",
            defaults: new { controller = "Messages", action = "Index", page = UrlParameter.Optional }
        ); 
```

我的控制器（MessagesController）索引方法头：

```
public ActionResult Index(int page = 0) 
```

和链接生成：

```
@Html.RouteLink("Messages", "MessagesIndex") 
```

我已经尝试过 ActionLink 和 Action...

编辑：爱。Glimpse 帮助和 MSDN。**它也是非常重要的路线顺序。**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T16:41:07.910

你能解释一下你遇到了什么问题吗？也许这会起作用：

```
@Url.Action("Index", "Messages") 
```

# c++ - 为属性表创建调试器友好的枚举

> ID：14342241
> 
> 赞同：0
> 
> 时间：2013-01-15T16:29:33.363
> 
> 标签：c++, enums

我有一种情况，我有一个类层次结构：`Widget`并且`Doobry`是继承自的对象类型`Base`（实际上有超过 2 种类型）。对象的每个实例都有一个属性列表。有一些属性是所有对象共有的，还有一些属性是特定于每个项目类型的。一个简单的实现可能如下所示：

```
enum PropertyType {
  COMMON_SIZE=0,              // first section: properties common to all
  COMMON_POSITION,
  ...
  WIDGET_PROPERTY_START=100,   // ensure enough space for expansion
  WIDGET_DONGLE_SIZE,
  WIDGET_TEXT,
  ...
  DOOBRY_PROPERTY_START=200
  DOOBRY_COLOUR
  ....
};

class Base {
public:
    Base();

    std::vector<std::pair<PropertyType, string>>  properties;
}; 
```

这实现了一个目标，在调试器中我可以看到映射到有意义名称的属性列表。但是它也有一些缺点：

*   所有项目的属性都在一个标题中定义（不利于封装）
*   如果我们向其中一个类添加更多属性，我们必须为每个类的起始位置选择一些任意数字，以便为将来的扩展留出足够的空间。

我的问题是是否有另一种方法可以实现这一目标。一种想法是我可以使用存储更大、查找速度更慢的字符串常量，但其优点是更容易使名称唯一，并且每种项目类型都可以定义自己的属性。

编辑：要求属性将被序列化，因此必须随着时间的推移保持稳定（即枚举不会改变）。可能有多达 1M 的对象，但绝大多数将有空的属性表（因为它们使用默认值）。查找性能比插入更重要，并且进行字符串散列的性能影响可能可以忽略不计（我们无法衡量它是否还没有写出来！）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T17:03:37.120

```
struct UniqueTag {
  friend TagManager;
  char const* tag;
  UniqueTag( UniqueTag const& other):tag(other.tag) {}
  UniqueTag():tag(nullptr) {}; // being able to create the null tag is useful
  bool operator<( UniqueTag const& other )const{ return tag < other.tag; }
  bool operator==( UniqueTag const& other )const{ return tag == other.tag; }
  // do other operators
private:
  UniqueTag( char const* t ):tag(t) {}
};

#include <map> // or unordered_map for performance
class TagManager {
  std::map<std::string, UniqueTag> cache;
  std::vector< std::unique_ptr< char[] > > data;
public:
  TagManager() {};
  UniqueTag GetTag( std::string s ) {
    auto range = cache.equal_range(s);
    if (range.first != range.second) {
      return range.first->second;
    }
    std::unique_ptr< char[] > str( new char[ s.size()+1 ] );
    std::copy( s.begin(), s.end(), &str[0] );
    str[s.length()] = '\0';
    UniqueTag retval( str.get() );
    data.push_back( std::move(str) );
    if(s.length()==0) {
      retval = UniqueTag(); // empty string is null tag, so we don't have both!
    }
    cache.insert( range.first, make_pair( std::move(s), retval ) );
    return retval;
  }
}; 
```

单个`TagManager`维护一堆指向字符串的唯一指针。我们可以进行快速比较，因为我们在指针值上进行比较。从字符串转换为唯一标签之一很慢，并且隐含了单个标签管理器的反模式，但是......

替代版本包括在其`UniqueTag`旁边放置一个哈希，并在哈希上查找内容（通过某种断言在调试中没有两个字符串哈希到相同的值 - 生日悖论使这种情况发生的可能性远大于天真预计）。这摆脱了单个管理器类（至少在发布中 - 在调试中，您将有一种检测冲突的方法。如果您的哈希是确定性的，则调试中没有冲突可能意味着发布中没有冲突）。

带有适当的可视化工具和一些运算符重载的 A`boost::variant<enum1, enum2, enum3>`会让您拥有多个独立`enum`的 s。`enum`或者es 上的自制联合，主节点`enum`表明哪个是有效的，在它上面有一个可视化器，可以让你在整个地方分散管理。在这两种情况下，您先导出 的“类型”的索引`enum`，然后导出`enum`值 - 因此`enum`s 的顺序必须是稳定的，并且每个值中的值`enum`必须是稳定的，但不需要魔法整数。要检查相等性，需要一个两个整数链式比较而不是一个（如果这样更快，您可以将其破解为单个 64 位比较）。

# python-3.x - 在 Python 3 中连接序列的首选方法是什么？

> ID：14342242
> 
> 赞同：12
> 
> 时间：2013-01-15T16:29:39.897
> 
> 标签：python-3.x, python-3.3

在 Python 3 中连接序列的首选方法是什么？

现在，我正在做：

```
import functools
import operator

def concatenate(sequences):
    return functools.reduce(operator.add, sequences)

print(concatenate([['spam', 'eggs'], ['ham']]))
# ['spam', 'eggs', 'ham'] 
```

需要导入两个单独的模块来执行此操作似乎很笨重。

一种替代方法可能是：

```
def concatenate(sequences):
    concatenated_sequence = []
    for sequence in sequences:
        concatenated_sequence += sequence
    return concatenated_sequence 
```

但是，这是不正确的，因为您不知道序列是列表。

你可以这样做：

```
import copy

def concatenate(sequences):
    head, *tail = sequences
    concatenated_sequence = copy.copy(head)
    for sequence in sequences:
        concatenated_sequence += sequence
    return concatenated_sequence 
```

但这似乎很容易出错——直接调用复制？（我知道`head.copy()`适用于列表和元组，但`copy`不是序列 ABC 的一部分，所以你不能依赖它......如果你得到字符串怎么办？）。您必须复制以防止突变，以防您收到`MutableSequence`. 此外，此解决方案会强制您首先解压缩整个序列集。再试一次：

```
import copy 

def concatenate(sequences):
    iterable = iter(sequences)
    head = next(iterable)
    concatenated_sequence = copy.copy(head)
    for sequence in iterable:
        concatenated_sequence += sequence
    return concatenated_sequence 
```

但是来吧……这是蟒蛇！那么......这样做的首选方法是什么？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-15T16:35:45.103

我会[`itertools.chain.from_iterable()`](http://docs.python.org/3/library/itertools.html#itertools.chain.from_iterable)改用：

```
import itertools

def chained(sequences):
    return itertools.chain.from_iterable(sequences): 
```

或者，由于您使用[python-3.3](/questions/tagged/python-3.3 "显示标记为“python-3.3”的问题")标记了它，您可以使用新[`yield from`](http://docs.python.org/3/whatsnew/3.3.html#pep-380)语法（看 ma，没有导入！）：

```
def chained(sequences):
    for seq in sequences:
        yield from seq 
```

两者都返回迭代器（`list()`如果您*必须*实现完整列表，请使用它们）。大多数情况下，您不需要从连接的序列中构造一个全新的序列，实际上，您只想循环它们以处理和/或搜索某些东西。

请注意，对于字符串，您应该使用[`str.join()`](http://docs.python.org/3/library/stdtypes.html#str.join)我的回答或您的问题中描述的任何技术来代替：

```
concatenated = ''.join(sequence_of_strings) 
```

结合起来，为了*快速*正确地处理序列，我会使用：

```
def chained(sequences):
    for seq in sequences:
        yield from seq

def concatenate(sequences):
    sequences = iter(sequences)
    first = next(sequences)
    if hasattr(first, 'join'):
        return first + ''.join(sequences)
    return first + type(first)(chained(sequences)) 
```

这适用于元组、列表和字符串：

```
>>> concatenate(['abcd', 'efgh', 'ijkl'])
'abcdefghijkl'
>>> concatenate([[1, 2, 3], [4, 5, 6], [7, 8, 9]])
[1, 2, 3, 4, 5, 6, 7, 8, 9]
>>> concatenate([(1, 2, 3), (4, 5, 6), (7, 8, 9)])
(1, 2, 3, 4, 5, 6, 7, 8, 9) 
```

并使用更快`''.join()`的字符串序列。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-07-20T00:57:48.403

出什么问题了：

```
from itertools import chain
def chain_sequences(*sequences):
  return chain(*sequences) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-15T16:34:40.013

使用[**`itertools.chain.from_iterable`**](http://docs.python.org/3/library/itertools.html#itertools.chain.from_iterable).

```
import itertools

def concatenate(sequences):
    return list(itertools.chain.from_iterable(sequences)) 
```

仅当您需要一个实际的新列表时才需要调用 to `list`，因此如果您只迭代此新序列一次，请跳过它。

# java - jboss上的工作超时

> ID：14342243
> 
> 赞同：2
> 
> 时间：2013-01-15T16:29:46.590
> 
> 标签：java, jboss

我正在使用 java 1.6 运行 jboss AS 4.2，我的问题如下：我们的应用程序分布为包含一些 servlet 的 ear 和 war。这些 servlet 调用所需的 EJB，这些 EJB 进行一些处理，然后返回结果。

我正在寻找一种方法来确定超时，以防处理花费太多时间，它只会返回并结束处理（处理涉及多个 EJB）。

我可以使用 ThreadLocal 并添加一些代码，这些代码将在每个方法的开头检查它是否超过了时间 - 但是是否有一些其他机制我可以使用而不将此类代码添加到我的应用程序？

任何想法/参考都会很好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T16:37:46.040

可能有不同的方法，但根据您的要求，我首先想到的是拦截器。

这样您就可以拦截所有有问题的（可能是长时间的通话）并在超出时间的情况下抛出异常。

是的，threadlocal 可以完成保持开始时间的工作（如果您不使用异步无状态会话 bean 调用）。

要了解拦截器的功能，请参阅： http: [//www.adam-bien.com/roller/abien/entry/interceptors_ejb_3_for_absolute](http://www.adam-bien.com/roller/abien/entry/interceptors_ejb_3_for_absolute)

此解决方案的主要优点是您可以将超时功能（在拦截器中）与业务逻辑（在 EJB 中）明确分离。

# matlab - Matlab - 如果有错误，如何阻止留下编辑文本？

> ID：14342246
> 
> 赞同：1
> 
> 时间：2013-01-15T16:29:50.100
> 
> 标签：matlab, callback, focus, verify

我正在尝试制作一个 GUI，您必须在其中完成许多编辑文本项，并且在每个编辑文本的回调中，我必须检查引入的值/值是否良好。如果一个值不正确，错误消息将通知用户什么是错误的。此外，如果编辑文本中的值不好，用户不应该能够移动到另一个编辑文本。我尝试了许多解决方案，但没有一个完全符合我的要求。在下一个代码中，问题是允许用户转到另一个 uicontrol，如果我不引入任何值，它不会考虑字符串为空。如果可以的话请帮忙。肿瘤坏死因子

```
function edit_keyboard_Callback(hObject, eventdata, handles)
% hObject    handle to edit_keyboard (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)

% Hints: get(hObject,'String') returns contents of edit_keyboard as text
%        str2double(get(hObject,'String')) returns contents of edit_keyboard as a       double
 global matrix
 global input_method
if input_method == 1
 matrixString = get(hObject,'String');
  [lines colums] = size(matrixString);
 k=1;
if isempty(get(hObject,'String'))
   msg =  msgbox(['Complete A'],'Empty !','warn')
    return;
else
for i=1:lines

    temp = explodeString(matrixString(i,:),' ')
    cl = length(temp)
    for j=1:cl
        [num flag] = str2num(char(temp(j)));
        if flag~=1
            msg =  msgbox(['Error in line ' num2str(j) ', colum ' num2str(i) ' , input a number! '],'Not a number!','warn')
            return;
        else
            matrix(i,j) = num;
        end
    end
end
end
end 
```

# excel - 使用 SpecialCells 进行多列同行复制/粘贴

> ID：14342259
> 
> 赞同：0
> 
> 时间：2013-01-15T16:30:29.997
> 
> 标签：excel, vba

有没有办法在使用 .SpecialCells(xlCellTypeConstants, 1) 获取列“B”中的所有数字时，也复制同一行中的单元格？

例子：

假设脚本找到带有数字的单元格 B2、B4、B5。我如何也复制 D2、D4 和 D5？我可以这样做并且仍然使用特殊细胞吗？最终，我想将这些值复制/粘贴到另一张纸上的 A 和 B 列中。

谢谢！

```
Dim strOutputFile As Variant
Dim wbkOut As Workbook
Dim tenln As Range
Dim tenlnPaste As Range
Dim wbkVer As Workbook

If strOutputFile(u) Like "*Lines.csv" Then
    With wbkOut.Worksheets(1)
        Set tenln = wbkOut.Worksheets(1).Cells(Rows.Count, 2).End(xlUp)
        Set tenlnPaste = wbkVer.Worksheets("TLines").Range("A" & .Rows.Count).End(xlUp).Offset(1).Resize(tenln.Rows.Count, 1)
        wbkOut.Worksheets(1).Range("B:B").SpecialCells(xlCellTypeConstants, 1).Copy
             With wbkVer.Worksheets("TenLines")
             tenlnPaste.PasteSpecial xlPasteValues
             End With
    End With
End If 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T16:49:32.740

是的。这实际上很容易。像下面这样：

```
Dim rngConst as Range
On Error Resume Next
Set rngConst = wbkOut.Worksheets(1).Range("B:B").SpecialCells(xlCellTypeConstants, 1)
If Not rngConst is Nothing Then 

    rngConst.Copy 
   'do your pasting

    Set rngConts = rngConst.Offset(,2) 'for moving from B to D
    rngConst.Copy
    'do your pasting

End If
On Error Go To 0 
```

您也可以这样做，将其全部放入 1 个复制区域：

```
Dim rngConst as Range

On Error Resume Next

If Not rngConst is Nothing

    Set rngConst = wbkOut.Worksheets(1).Range("B:B").SpecialCells(xlCellTypeConstants, 1)
    Set rngConst = Range(rngConst, rngConst.Offset(,2))
    rngConst.Copy
    'do your pasting

End If

On Error Go To 0 
```

但这会将数据复制到新工作表上的两个连续列中。例如，它不会从 B 复制到 B 和从 D 复制到 D。

# delphi - 如何检查接口对象是否实现了另一个接口？

> ID：14342263
> 
> 赞同：9
> 
> 时间：2013-01-15T16:30:34.910
> 
> 标签：delphi, oop, interface

我有这些接口声明：

```
IListener = interface
  procedure HandleEvent(AEvent: TMyEvent);
end;

IExtendedListener = interface(IListener)
  ['{85A3456A-D5E5-4F37-ABDD-A75A7B3B494C}']  // required by GetInterface
  procedure HandleExtendedEvent(AExtendedEvent: TMyExtendedEvent);
end; 
```

给定某个实现的接口引用，`IListener`我如何检查它是否也实现了`IExtendedListener`？我正在使用代码下面的代码，因为执行类似`if Listener is IExtendedListener then ...`.

```
TSomeClass.Notify(AEvent: TMyExtendedEvent);
var
  Listener: IListener;
  ExtListener: IExtendedListener;
  Obj: TObject;
begin
  for Listener in FListeners do
  begin
    // works but smells funny
    Obj := Listener as TObject;
    Obj.GetInterface(IExtendedListener, ExtListener);
    if Assigned(ExtListener) then
      ExtNotifyee.HandleExtendedEvent(AEvent);
  end;
end; 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-01-15T16:42:30.530

您应该使用`Sysutils.Supports`检查特殊接口

```
uses
  SysUtils;

TSomeClass.Notify(AEvent: TMyExtendedEvent);
var
  Listener    : IListener;
  ExtListener : IExtendedListener;
begin
  for Listener in FListeners do
    if Supports( Listener, IExtendedListener, ExtListener ) then
      ExtListener.HandleExtendedEvent( AEvent );
end; 
```

# objective-c - 使用 LLVM 4 的 Objective-C 自动拆箱

> ID：14342264
> 
> 赞同：6
> 
> 时间：2013-01-15T16:30:37.523
> 
> 标签：objective-c, autoboxing, llvm-clang

我一直在关注 Objective-C 中的自动装箱（例如，[这里](http://club15cc.com/code/objective-c/objective-c-object-literals-quick-reference)）。是否有新的拆箱语法？

例如，我想这样做但更短：

```
NSArray *oneNumber = @[@1];
int one = ((NSNumber *)oneNumber[0]).intValue; 
```

第二行的语法是可怕的。有什么新的语言功能可以解决这个问题吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-15T16:58:54.293

```
[oneNumber[0] intValue] 
```

Sometimes the old ways are best.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T17:04:28.457

另一种方法是留在对象世界中。例如：

```
NSNumber *one = @1;
NSArray *oneNumber = @[one];
one = oneNumber[0];
NSLog(@"one %@", one); 
```

# c# - 内置 CastOrDefault？

> ID：14342265
> 
> 赞同：3
> 
> 时间：2013-01-15T16:30:39.123
> 
> 标签：c#

我觉得有一些内置的东西。如果对象为空，我想要默认值（或者特别是 0，我只使用十进制/整数）。有没有内置的方法来编写这个函数？

```
static int GetDecimalFromObject(object o){
    return o==null?0:(decimal)o;
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-15T16:33:01.737

[`Convert.ToDecimal`](http://msdn.microsoft.com/en-us/library/e6440ed8.aspx)如果传递 null ，[`Convert.ToInt32`](http://msdn.microsoft.com/en-us/library/23511zys.aspx)将返回零。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-15T16:34:29.473

尝试使用*[`Convert.ToDecimal()`](http://msdn.microsoft.com/en-us/library/e6440ed8.aspx)*

> 与 value 等效的十进制数，如果 value 为空，则为 0（零）。

试试这样；

```
static decimal GetDecimalFromObject(object o)
{
     return o == null ? Convert.ToDecimal(0) : Convert.ToDecimal(o);
} 
```

或更高效；

```
static decimal  GetDecimalFromObject(object o)
{
    return Convert.ToDecimal(o);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T16:33:58.223

首先，`decimal`和`int`数据类型不能为空，所以默认为0。

如果您有一个可为空的小数（十进制？），请使用该`HasValue`方法检查它是否为空，然后指定您的默认值 0。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-15T16:36:35.087

只是为了提供不同的解决方案：

```
static int GetDecimalFromObject(object o)
{
    return o as int? ?? 0;
} 
```

通用版本：

```
static T GetValueFromObject<T>(object o) where T : struct 
{
    return o as T? ?? default(T);
} 
```

请注意，我使用了`as`运算符。`o`如果您希望在不属于正确类型的情况下抛出异常，请使用强制转换运算符。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-15T16:36:38.207

这 ？？运算符可能会有所帮助，但您必须提供默认值：

```
 // y = x, unless x is null, in which case y = -1\. 
    int y = x ?? -1; 
```

# python - 使用标准输入时将 args 发送到子进程

> ID：14342266
> 
> 赞同：0
> 
> 时间：2013-01-15T16:30:43.763
> 
> 标签：python, subprocess, pipe, stdin, io-redirection

我正在尝试截取屏幕截图，然后在该屏幕截图上运行命令而不保存到磁盘。

我要运行的实际命令是`visgrep image.png pattern.pat`

`visgrep`必须有两个参数：图像文件和 .pat 文件。

这是我到目前为止所拥有的。

```
p = subprocess.Popen(['import', '-crop', '305x42+1328+281', '-window', 'root', '-depth', '8', 'png:' ], stdout=subprocess.PIPE,)
cmd = ['visgrep']
subprocess.call(cmd, stdin=p.stdout) 
```

显然这失败了，因为 visgrep 必须有两个参数。

`visgrep image.png pattern.pat`那么，除了用 ImageMagick 的输出替换 'image.png' 之外，我还能做些`import`什么呢？

我需要使用 xargs 吗？有没有更好的方法来完成我正在尝试的事情？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T17:02:40.913

从[ImageMagick 文档](http://www.imagemagick.org/script/command-line-processing.php)：

> **STDIN、STDOUT 和文件描述符**
> 
> Unix 和 Windows 允许将一个命令的输出通过管道传输到另一个命令的输入。ImageMagick 允许使用伪文件名 - 分别从标准流 STDIN（标准输入）和 STDOUT（标准输出）读取和写入图像数据。在此示例中，我们将 convert 的输出通过管道传输到显示程序：
> 
> `$ convert logo: gif:- | display gif:-`
> 
> 第二种显式格式“gif:”在前面的示例中是可选的。GIF 图像格式在图像中具有唯一的签名，因此 ImageMagick 的显示命令可以轻松地将格式识别为 GIF。转换程序也以这种方式接受 STDIN 作为输入：
> 
> $`convert rose: gif:- | convert - -resize "200%" bigrose.jpg`

您可以对命令使用相同的文件名约定`import`。

所以，试试：

```
p = subprocess.Popen(['import', '-crop', '305x42+1328+281', 
                      '-window', 'root', '-depth', '8', 'png:-' ], 
                      stdout=subprocess.PIPE,) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T16:37:50.160

根据[这个答案](https://stackoverflow.com/questions/4590088/use-python-to-call-imagemagicks-import)，将参数更改`png:`为`png:-`将导致导入命令输出到标准输出而不是文件。我不熟悉 visgrep，所以我不知道如何告诉它从标准输入读取源图像。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T16:41:23.080

在 linux 中，您可以将`/dev/stdin`其用作文件名，但并非始终有效。如果它不适用于`visgrep`，您必须使用临时文件（这并不可惜）。

PS。不`png:` 应该`png:-`吗？

# jquery - 如何遍历由 jQuery 序列化的数据，然后填充 div？

> ID：14342268
> 
> 赞同：3
> 
> 时间：2013-01-15T16:30:46.830
> 
> 标签：jquery, serialization, deserialization, each

我有以下来自另一个页面的序列化数据字符串（一些内容来自复选框，这就是重复“品牌”的原因）：

`brand=Ford&brand=Dodge&brand=Mazda&year=2013&type=compact`

我想用“结果”的 id 填充 div 标签：

```
<div id="results">    
    <div id="brand"></div>    
    <div id="year"></div>    
    <div id="type"></div>    
</div> 
```

我目前正在使用此代码循环数据：

```
$.each(SelectionData.split('&'), function (index, elem) {    
    var vals = elem.split('=');    
    $('#' + vals[0]).text(decodeURIComponent(vals[1].replace(/\+/g, ' ')));    
}); 
```

在我们向表单添加复选框之前，它一直运行良好。现在，当名称与此处显示的名称相同时，我只能显示字符串中的最后一个值：

**这就是我们现在所拥有的**

```
<div id="results">
    <div id="brand">Mazda</div>    
    <div id="year">2013</div>    
    <div id="type">compact</div>    
</div> 
```

**这就是我们正在寻找的：**

```
<div id="results">
    <div id="brand">Ford,Dodge,Mazda</div>    
    <div id="year">2013</div>    
    <div id="type">compact</div>    
</div> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-15T17:06:36.257

我不明白为什么你希望结果在一个名为的 div 中被格式化，`results`但是你的代码试图改变一个元素的文本，其 id 等于 uri 参数名称的名称。

无论如何，我想我已经弄清楚了你想要做什么。 [工作演示](http://jsbin.com/ixogax/2/edit)

的HTML：

```
<div id="brand"></div>
<div id="year"></div>
<div id="type"></div> 
```

编码：

```
var SelectionData = 'brand=Ford&brand=Dodge&brand=Mazda&year=2013&type=compact';

$.each(SelectionData.split('&'), function (index, elem) {
    var vals = elem.split('=');
    var $div = $("#"+vals[0]);
    var separator = '';
    if ($div.html().length > 0) {
        separator = ', ';
    }
    $div.html($div.html() + separator + decodeURIComponent(vals[1].replace(/\+/g, '  ')));
}); 
```

# java - OpenGL 2.0 ES 矩阵堆栈如何工作？

> ID：14342270
> 
> 赞同：3
> 
> 时间：2013-01-15T16:30:48.780
> 
> 标签：java, android, opengl-es

我在使用 OpenGL 时遇到了一些性能问题。我本质上想创建一个正方形网格。我首先尝试在每个正方形转换到我想要的正方形的位置实现它，然后将模型和视图矩阵相乘，将其传递给着色器程序并绘制正方形。我会为每个正方形做这个。创建大约 50 个方块后，帧速率将开始下降到低于我想要的水平。

然后我尝试了一种 VBO 方法，我基本上会在每次正方形改变位置时生成一个顶点缓冲区。使用这种方法可以显着提高帧速率，但是当某些东西发生变化时我有太多的延迟，因为它必须重新生成所有顶点位置。

我认为我需要的是一个矩阵堆栈......我之前使用过 opengl 1.1，并且会使用 push/pop。我真的不明白它在做什么以及如何重现它的概念。有谁知道我可以使用矩阵堆栈的一个很好的例子吗？或者可能只是一个很好的解释？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T16:38:03.323

您可以查看本教程，基本上是在做您想要实现的相同操作，但使用立方体而不是正方形。它也使用 VBO：

[http://www.learnopengles.com/android-lesson-seven-an-introduction-to-vertex-buffer-objects-vbos/](http://www.learnopengles.com/android-lesson-seven-an-introduction-to-vertex-buffer-objects-vbos/)

关于矩阵，在 OpenGL ES 2.0 中，您不再有任何与矩阵相关的函数，但您可以使用 glmath 库，它具有相同的功能（以及更多功能）：

[http://glm.g-truc.net/](http://glm.g-truc.net/)

它是一个头文件库，因此您只需将其复制到某个地方并将其包含在您需要的地方。

我不确定我是否完全理解您的目标，但我想您可以复制图形卡中一个正方形的数据（使用 VBO），然后重复更新每个正方形的模型矩阵。

如果您的方格之间有某种层次结构（例如，如果其中一个移动，其左侧的一个必须相应移动），则矩阵堆栈的概念是有意义的。

你可以把它想象成一个由正方形组成的骨架。如果肩膀移动，手臂中的所有部分也会移动（手、手指等）。您可以通过使用矩阵堆栈来模拟它。你可以用你的所有方块创建某种树，这样每个方块都有一个“后代”列表，它将应用与父级相同的转换。然后您可以像这样递归地渲染所有正方形：

1.  将变换应用于根平方
2.  将转换推送到队列中
3.  为每个孩子调用相同的渲染函数
4.  每个孩子读取队列顶部的矩阵，将其乘以自己的变换，将新矩阵推入队列并调用孩子
5.  之后，每个孩子都会弹出他们之前推送的矩阵

使用 glmath 非常简单，您只需要创建一个矩阵队列（在本例中为 std:vector）：

```
std::vector<glm::mat4> matrixStack; 
```

然后对每个孩子：

```
glm::mat4 modelMatrix = matrixStack.back();
glm::mat4 nodeTransform = /*apply your transform here*/
glm::mat4 new = modelMatrix * nodeTransform;
matrixStack.push_back(new);
/*Pass in the new matrix to the shader and call to glDrawArrays or whatever to render your square*/

for (every child) {
    render();
}
matrixStack.pop_back(); 
```

对于绘图部分，我想您可以将顶点数组与方形顶点绑定，然后在调用 glDrawArrays 之前为每个孩子更新着色器中的模型矩阵。

# linux - 带排除的 vi 文本搜索 (linux)

> ID：14342271
> 
> 赞同：0
> 
> 时间：2013-01-15T16:30:50.017
> 
> 标签：linux, search, text, vi

我有一个包含错误的巨大日志文件（2530 万行），如果不按住向上按钮，我不会搜索它。你怎么能用vi搜索这个？我在目录级别看到过类似的情况，但不是特定文件。目前我搜索了一个日期，例如 /Tue 15 Jan 并向下导航，但我不确定问题何时开始（仅在注意到时），所以我需要进行一般搜索。

我在文件中的一般想法是/ORA-/!ORA-00020，这意味着我想找到那些包含“ORA-”但忽略那些“ORA-00020”的字符串。知道如何查看特定文件吗？

感谢您提供任何信息

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T16:47:31.137

我不知道 vi 的确切方法，但我们有一些方法可以得到结果：

1.  我们可以使用 cat/grep 命令并将答案写入另一个文件（因此我们的文件要小得多），然后您可以在其中搜索，如果可以的话。

2.  您可以使用 vim 代替 vi 并使用 TagList Vim 插件。

附加信息：

[http://www.thegeekstuff.com/2009/04/ctags-taglist-vi-vim-editor-as-sourcece-code-browser/](http://www.thegeekstuff.com/2009/04/ctags-taglist-vi-vim-editor-as-sourece-code-browser/)

[http://vim-taglist.sourceforge.net/faq.html](http://vim-taglist.sourceforge.net/faq.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T16:34:27.773

你做

```
 grep -v "ORA\-00020" error.log > error2.log 
```

然后你搜索error2.log

# java - 使用 JPA 创建与实体超类的关联

> ID：14342273
> 
> 赞同：1
> 
> 时间：2013-01-15T16:30:54.233
> 
> 标签：java, jakarta-ee, jpa

我有一个简单的实体类层次结构，如下所示：

```
允许的（超类）
\
 PermissableResource（子类）

```

它们被保存在这样的表中：

```
允许的
-------------
身份PK
资源外键资源（resourceId）

```

我有另一个实体`Resource`，我想与之建立关联。它保存在这样的表中：

```
资源
-------------
资源 ID PK

```

在我的`PermissableResource`课堂上，我像这样创建关联：

```
@JoinColumn(name="resource", referencedColumnName="resourceId")
@ManyToOne
Resource resource; 
```

问题来自 Resource 类。我想引用超类`Permissable`而不是子类`PermissableResource`。我尝试像这样创建关联：

```
@OneToOne(mappedBy="resource", cascade= CascadeType.ALL, targetEntity=PermissableResource.class)
private Permissable permissiable; 
```

但这会导致部署时出现以下错误：

```
Exception Description: The attribute [permissiable] in entity class [class com.dv.oa.model.entity.resource.Resource] has a mappedBy value of [resource] which does not exist in its owning entity class [class com.dv.oa.model.entity.permission.permissable.Permissable]. If the owning entity class is a @MappedSuperclass, this is invalid, and your attribute should reference the correct subclass.. Please see server.log for more details. 
```

它在寻找`Permissable`协会而不是在`PermissableResource`

我认为，因为我使用`targetEntity`属性`@OneToOne`并指向它`PermissableResource.class`会起作用。如何在我的实体中保留超类引用，但将其映射到子类？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T17:45:48.190

我认为问题在于`PermissableResource`您定义了一个`@ManyToOne`关系，而在`Resource`类中您定义了一个`@OneToOne`. 尝试将后者替换为`@OneToMany`.

# shell - 语法外壳脚本？“意外出现的单词”getopts

> ID：14342275
> 
> 赞同：1
> 
> 时间：2013-01-15T16:30:54.940
> 
> 标签：shell, getopts, ubuntu-8.04

大家晚上好，我们期待在 Ubuntu 8.04 上执行 shell 脚本，但它返回一个特殊错误：

```
line 14: Word unexpected (expecting "in") 
```

所以这里是脚本的预览：

```
#!/bin/sh
#Declaration of shell parameters
A3REP=""
A3FILE=""
A3HELP=""
A3PORT="80"
A3PORTTC="80"
A3IP400=""
A3USER=""
A3PWD=""
A3TASK=""
while getopts d:f:h:p:i:u:w:t:n: option
do 
  case $option in
    d)
    A3REP="$OPTARG"
    ;;
    f)  
    A3FILE="$OPTARG"
        ;;
    p)  
    A3PORT="$OPTARG"
        ;;
    t)  
    A3PORTTC="$OPTARG"
        ;;
    i)  
    A3IP400="$OPTARG"
        ;;
    u)  
    A3USER="$OPTARG"
        ;;
    w)  
    A3PWD="$OPTARG"
        ;;
    n)  
    A3TASK="$OPTARG"
        ;;
    h)
    A3HELP="aide"
    ;;
  esac
done 
```

**问题已解决：** 脚本在 dos 中：

在 d2u.sh 中插入以下行：

```
#!/bin/bash
cat $1|tr -d '\015' 
```

现在执行：

```
chmod +x d2u.sh 
```

现在脚本已准备好运行。

试试这个脚本，输入以下命令：

```
sh d2u.sh filename.sh > filename2.sh 
```

并且脚本不再在dos中。

谢谢大家！:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T03:19:12.847

可能是行尾有问题，试试

```
d2u FILE 
```

[**参考**](http://forum.gephi.org/viewtopic.php?t=1871)

# ruby-on-rails - 插件视图助手在新视图、编辑视图和显示视图上失败

> ID：14342278
> 
> 赞同：0
> 
> 时间：2013-01-15T16:31:02.733
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我正在开发一个 Rails 插件，它需要通过帮助程序输出一个复选框。`startup_exchange_optin('user')`将助手放置在脚手架的 Users#index 视图中时，会出现该复选框。将其放置在我得到的新视图、编辑视图和显示视图中`NoMethodError`：

```
undefined method `startup_exchange_optin' for #<User:0x0000010162c620> 
```

文件调用者`init.rb`：

```
# lib/startup_exchange.rb
require 'startup_exchange/startup_exchange_helper'

module StartupExchange
end

ActiveSupport.on_load(:action_view) do
 include StartupExchange::StartupExchangeHelper
end 
```

帮手：

```
# lib/startup_exchange/startup_exchange_helper.rb
module StartupExchange
  module StartupExchangeHelper
    def startup_exchange_optin(object_name, method = 'startup_exchange_optin', options = {}, checked_value = '1', unchecked_value = '0') 
      check_box(object_name, 'startup_exchange_optin', options, checked_value, unchecked_value)
    end
  end
end 
```

该插件不会成为一个 gem，这就是为什么需要`init.rb`. 起初我试图使用`Railtie`，但我无法让它初始化。[ActiveSupport.on_load](https://stackoverflow.com/a/6636141) 似乎至少适用于索引视图。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T18:02:02.170

```
check_box(object_name, 'startup_exchange_optin'...

#=> undefined method `startup_exchange_optin' for #<User:0x0000010162c620> 
```

您的用户对象不响应 `startup_exchange_optin' 方法。

# jfreechart - JFreeChart：将列标签上移

> ID：14342280
> 
> 赞同：3
> 
> 时间：2013-01-15T16:31:07.430
> 
> 标签：jfreechart

![在此处输入图像描述](../Images/2f0d7030f6e6f235325af664a6af5536.png)

正如我在图片中显示的那样，我想将列标签（值 434、2562、....）向上移动一点。有什么办法可以配置吗？我最初的问题是，由于列之间的差异，最后两列上的标签不再可见（它们实际上是 15 和 24 或类似的 stg）。我不知道如何改变它。谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-16T12:07:30.937

You can use [`BarRenderer3D.setSeriesPositiveItemLabelPosition`](http://www.jfree.org/jfreechart/api/javadoc/org/jfree/chart/renderer/AbstractRenderer.html#setSeriesPositiveItemLabelPosition%28int,%20org.jfree.chart.labels.ItemLabelPosition%29).

For example :

```
 DefaultCategoryDataset dataset = new DefaultCategoryDataset();
  dataset.addValue(51.0, "Series 1", "key1");
  dataset.addValue(44.3, "Series 1", "key2");

  // create the chart...
  JFreeChart chart = ChartFactory.createBarChart3D("Demo","Category","Value",dataset,PlotOrientation.VERTICAL,false,true,false);

  CategoryPlot plot = chart.getCategoryPlot();

  CategoryAxis domainAxis = plot.getDomainAxis();
  domainAxis.setVisible(false);

  NumberAxis rangeAxis = (NumberAxis) plot.getRangeAxis();
  rangeAxis.setUpperMargin(0.15);

  BarRenderer3D renderer = (BarRenderer3D) plot.getRenderer();
  CategoryItemLabelGenerator generator = new StandardCategoryItemLabelGenerator();
  renderer.setSeriesItemLabelGenerator(0, generator);
  renderer.setSeriesItemLabelsVisible(0, true);
  renderer.setSeriesPositiveItemLabelPosition(0, new ItemLabelPosition(ItemLabelAnchor.OUTSIDE12,TextAnchor.BASELINE_CENTER));
  renderer.setItemLabelAnchorOffset(10); 
```

The result is :

![Bar chart 3D with labels above the bars](../Images/b57e91681d792fb56b0b69ab95176e9a.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-23T06:09:53.763

```
CategoryPlot plot = (CategoryPlot) chart.getPlot();

BarRenderer renderer = (BarRenderer) plot.getRenderer();

renderer.setBasePositiveItemLabelPosition(new ItemLabelPosition(ItemLabelAnchor.OUTSIDE12, TextAnchor.TOP_CENTER,TextAnchor.HALF_ASCENT_CENTER,0D)); 
```

# c - dll的dumpbin输出中的“虚拟地址”

> ID：14342284
> 
> 赞同：2
> 
> 时间：2013-01-15T16:31:18.433
> 
> 标签：c, assembly, operating-system, computer-architecture

1）在dll的dumpbin输出中，我在代码部分看到下面的属性“虚拟地址”

第 1 节标题

.text 名称

```
100C virtual size
1000 virtual address (1C001000 to 1C00200B)
1200 size of raw data
 400 file pointer to raw data (00000400 to 000015FF)
   0 file pointer to relocation table
   0 file pointer to line numbers
   0 number of relocations
   0 number of line numbers 
```

60000020 个标志

```
 Code

     Execute Read 
```

![scn2](../Images/bde39d3c5fac24694420fa899500e01c.png)

![scn1](../Images/d60184cb9145e5228592171ba3dc651b.png)

2）截图Scn2.png（附件）是scn1.png（附件）的左侧部分。

我的问题是，上面的属性虚拟地址范围（1C001000 到 1C00200B）只是根据屏幕截图（附加）在红色圆圈中的偏移量（有效地址）吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T16:38:30.957

通常，从技术上讲（就 Portable Executable 规范而言），Virtual Address 属性是 MEMORY 中将要加载 Image 的部分与 ImageBase 的偏移量（这也是取决于 ASLR 的点）。

一些工具，如 dumpin，会自动计算结果并显示添加到 Image Base 中的虚拟地址。在这种情况下，是的，您是对的，“范围不过是偏移量（有效地址）”！

# javascript - D3.js 面积图未正确呈现

> ID：14342289
> 
> 赞同：1
> 
> 时间：2013-01-15T16:31:29.910
> 
> 标签：javascript, html, svg, charts, d3.js

好的，这是一个说明我的问题的图像： ![错误的图表](../Images/4d0a02c61da2019c45d893ab5ba6816e.png)

如您所见，图形区域的底线呈现为从第一个元素的 Y 位置到最后一个元素的 Y 位置的直线。（应该是在底部）

我读到 Y0 和 Y1 是解决该问题时要设置的东西，但我一定做错了。

你能检查我的代码吗？

下面是创建图的类函数：

```
function StarvingGraph(container, data, settings){

var thisClass = this;
this.data = data;
this.settings = settings==undefined ? [15,''] : settings;
this.container = container;
this.n = data.length;
this.duration = 500;
this.now = new Date(Date.now() - this.duration);

// this hack renders the data wrong
// this.data.unshift(0);
// this.data.push(0);

this.margin = {top: 0, right: 0, bottom: 0, left: 0};
this.width  = $(container).width() - this.margin.right;
this.height = $(container).height() - this.margin.top - this.margin.bottom;

this.graph = {
    min:0,
    max:parseInt(this.settings[0]*1.40), // the max of the graph will always be 25% more than the threshold
    threshold:parseInt(this.settings[0]),
    unit:this.settings[1]
}

// set X and Y scalers
this.x = d3.time.scale()
    .domain([this.now - (this.n - 2) * this.duration, this.now - this.duration])
    .range([0, this.width]);

this.y = d3.scale.linear()
       .range([this.height, 0]);

// update the domains
this.x.domain([this.now - (this.n - 2) * this.duration, this.now - this.duration]);
this.y.domain([this.graph.min, this.graph.max]);

// Define the line that goes over the graph
this.line = d3.svg.line()//.interpolate("basis")
    .x(function(d, i) { return thisClass.x(thisClass.now - (thisClass.n - 1 - i) * thisClass.duration); })
    .y(function(d, i) { return thisClass.y(d); });

// Define the area under the line
this.area = d3.svg.area()
    .x(function(d,i) { return thisClass.x(thisClass.now - (thisClass.n - 1 - i) * thisClass.duration); })
    .y0(thisClass.height) // bottom ??
    .y1(function(d) { return thisClass.y(d); }); // top

// create the SVG inside the container
this.svg = d3.select(container).append("svg")
    .attr("width", this.width + this.margin.left + this.margin.right)
    .attr("height", this.height + this.margin.top + this.margin.bottom)
    .style("margin-left", -this.margin.left + "px")
  .append("g")
    .attr("transform", "translate(" + this.margin.left + "," + this.margin.top + ")");

// Create the path
this.path = this.svg.append("g")
    .attr("class", "axis")
      .append("path")
            .datum(this.data)
            .attr('d',this.area)
            .attr("class", "area line graphLine");

// draw the line to the path
this.svg.select(".graphLine")
    .attr("d", this.line)
    .attr("transform", null);

// From here on are just decorative elements
// line the lines with the percentages

// add the top line
this.svg.append('line')
    .attr("x1",0)
    .attr("y1",this.y(this.graph.max)+1)
    .attr("x2",this.width)
    .attr("y2",this.y(this.graph.max)+1)
    .attr("class", "line");

// add the threshold line (dashed)
this.svg.append('line')
    .attr("x1",38)
    .attr("y1",this.y(this.graph.threshold))
    .attr("x2",this.width)
    .attr("y2",this.y(this.graph.threshold))
    .attr("class", "line dashed red");

// add the top text
this.svg.append("svg:text")
    .attr("dy", 12)
    .attr("dx", 0)
    .attr('height', 100)
    .attr('class','graphText')
    .text(this.graph.max+this.graph.unit);

// add the threshold text
this.svg.append("svg:text")
    .attr("dy", this.y(this.graph.threshold)+4)
    .attr("dx", 0)
    .attr('height', 100)
    .attr('class','graphText red')
    .text(this.graph.threshold+this.graph.unit);
} 
```

这是有关如何运行它的示例：

```
var x = new StarvingGraph('#testdiv',[10,50,0,90,10,50,0,90,10,50,0,90,10,50,0,90,10,50,0,90,10,50,0,90,10,50,0,90],["100","%"]); 
```

...其中#testdiv 只是任何容器。如果你愿意，你甚至可以使用 body（只要它不是 0 宽度或高度）。

这是一个小提琴：http: [//jsfiddle.net/brLP2/1/](http://jsfiddle.net/brLP2/1/)

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-11-23T16:05:38.623

您的问题在于包含该行。删除它，它会很好地呈现。

你只需要这个

```
this.path = this.svg.append("g")
    .attr("class", "axis")
    .append("path")
    .datum(this.data)
    .attr('d',this.area)
    .attr("class", "area line graphLine"); 
```

[http://jsfiddle.net/eamonnmag/brLP2/16/](http://jsfiddle.net/eamonnmag/brLP2/16/)

# javascript - 从 HTML 读取文件

> ID：14342290
> 
> 赞同：0
> 
> 时间：2013-01-15T16:31:31.693
> 
> 标签：javascript, html, ajax, google-chrome

我正在尝试将文本文件从我的计算机读取到网站。我让它在 IE 中工作，但我似乎无法让它在 Chrome 中工作。我根本不擅长html，所以任何帮助都会很棒！

```
<html>
<body>

    <div id = "content">
    </div>

    <script lang = "javascript">

    if (window.XMLHttpRequest)
    {
        xhttp=new XMLHttpRequest();
    }
    else // Internet Explorer 5/6
    { 
        xhttp=new ActiveXObject("Microsoft.XMLHTTP");
    }
    xhttp.open("GET","./Test.txt",false);
    xhttp.send("");
    xmlDoc=xhttp.responseText;

    document.getElementById('content').innerHTML = xmlDoc;
    </script>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T16:36:02.327

使用此处的 Javascript 文件 API[示例执行此操作](http://www.html5rocks.com/en/tutorials/file/dndfiles/)

# html - Bootstrap 奇数跨度 - 底部有 7 个缩略图

> ID：14342291
> 
> 赞同：0
> 
> 时间：2013-01-15T16:31:35.230
> 
> 标签：html, css, twitter-bootstrap

也许我想太多了。我如何使用 Bootstrap 的网格获得奇数个缩略图。我在底部有 7 个缩略图。我当然想使用网格将它们隔开。也许这是不可能的，应该只使用常规的 CSS？

这是我尝试过的：

```
 <div class="row-fluid">
                <div class="span12">
                 <ul class="thumbnails">
                    <li class="span1">
                        <div class="thumbnail">
                            <img src="img/diningroom/1.jpg" alt="">
                        </div>
                    </li>
                    <li class="span2">
                        <div class="thumbnail">
                            <img src="img/diningroom/2.jpg" alt="">
                        </div>
                    </li>
                    <li class="span2">
                        <div class="thumbnail">
                            <img src="img/diningroom/3.jpg" alt="">
                        </div>
                    </li>
                    <li class="span2">
                        <div class="thumbnail">
                            <img src="img/diningroom/4.jpg" alt="">
                        </div>
                    </li>
                    <li class="span2">
                        <div class="thumbnail">
                            <img src="img/diningroom/5.jpg" alt="">
                        </div>
                    </li>
                    <li class="span2">
                        <div class="thumbnail">
                            <img src="img/diningroom/6.jpg" alt="">
                        </div>
                    </li>
                     <li class="span1">
                        <div class="thumbnail">
                            <img src="img/diningroom/6.jpg" alt="">
                        </div>
                    </li>

                </ul>
              </div>
              </div> 
```

![在此处输入图像描述](../Images/a62396fd1611dbff9eea16e64303d58f.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T16:42:08.683

[您可以在此处](http://twitter.github.com/bootstrap/customize.html#variables)自定义引导列（请参阅@gridColumns）。

# ios - 创建自定义 UITableView 索引 iOS

> ID：14342300
> 
> 赞同：0
> 
> 时间：2013-01-15T16:31:57.387
> 
> 标签：ios, uitableview, uibutton, uicontrolevents

我们的设计师提出了一个不错的设计，其中 UITableView 右侧的索引要高于 UITableView 本身。它还有一些用于搜索的自定义图像和比默认实现更好的字体/颜色。但是，由于 UITableView 不支持自定义其索引（据我所知），我一直在尝试手动进行。用户界面如下所示：

![在此处输入图像描述](../Images/7e45067727e11094c62420c57f0a5332.png)

这应该是一个简单的任务，但我有一个地狱般的时间让它工作。我在表格的右侧设置了一个 UIView，UIButtons 从上到下排列以表示我的索引。目标是当用户拖入/拖出 UIButtons 时，我会将 UITableView 跳到右侧部分。

我四处搜索，似乎要做的事情是听 UIControlEventTouchDragOutside 和 UIControlEventTouchDragEnter 事件，以了解我何时进入/退出其中一个 UIButton。

为此，我将整个按钮列表设置为一个 IBOutletCollection，我在 ViewDidLoad 中对其进行初始化，如下所示：

```
@property (retain, nonatomic) IBOutletCollection(UIButton) NSArray* indexButtons;

@implementation ViewBeerListViewController
...
@synthesize indexButtons = _indexButtons;

- (void)viewDidLoad
{
    [super viewDidLoad];

    ...

    // Go through the index buttons and set the change function
    for (int i = 0; i < [self.indexButtons count]; ++i)
    {
        UIButton* button = [self.indexButtons objectAtIndex:i];
        [button addTarget:self action:@selector(touchDragOutside:) forControlEvents:UIControlEventTouchDragOutside];
        [button addTarget:self action:@selector(touchDragEnter:) forControlEvents:UIControlEventTouchDragEnter];
    }
}

The functions touchDragOutside and touchDragEnter look like this:

- (IBAction)touchDragOutside:(UIButton*)sender
{
    NSLog(@"Button %@ touch dragged outside", [sender titleLabel].text);
}

- (IBAction)touchDragEnter:(UIButton*)sender
{
    NSLog(@"Button %@ touch dragged enter", [sender titleLabel].text);
} 
```

这一切都构建并运行。但是，似乎我只获得了我开始触摸的按钮的事件。EG如果我触摸字母“G”，然后开始上下拖动，我只会看到触摸从“G”拖出“G”并拖入“G”的日志。当我浏览它们时，我没有收到任何其他 UIButtons 的事件。

任何解决此问题的帮助将不胜感激。很长一段时间以来，我一直被困在一个看似非常微不足道的问题上。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T18:18:10.293

不要使用 UIButtons 制作它们，而是尝试创建一个自定义 UIView，其中包含每个字母的 UILabel。然后在自定义 UIView 类中，覆盖以下内容：

```
– touchesBegan:withEvent:
– touchesMoved:withEvent:
– touchesEnded:withEvent: 
```

并使用这些来确定正在触摸哪些标签。例如，在 touchesMoved 中，您可以：

```
UITouch * touch = [touches anyObject];
CGPoint point = [touch locationInView:self];
for(UIView * indexView in self.indexViews) {
    if(CGRectContainsPoint(indexView.frame,point)) {
        //indexView was touched. do something here
        break;
    }
} 
```

请注意，您也可以将 UIImageView 用于顶部而不是 UILabels，这仍然有效。

# mysql - mysql平均计数

> ID：14342302
> 
> 赞同：-4
> 
> 时间：2013-01-15T16:32:01.707
> 
> 标签：mysql, select, count, average

我有表名为评论：

```
ID | COMMENT | DATE     |
---|---------|----------|
1  | TEXT... | 01/01/12 |
2  | TEXT... | 01/01/12 |
3  | TEXT... | 15/01/12 |
4  | TEXT... | 01/01/13 | 
```

表中有 2012 年的评论，2013 年的评论很少。如何仅选择 2012 年的记录，然后获得 2012 年的平均评论数？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T16:42:25.857

*确实*不应该将时间值存储在字符串类型的列中。我建议您首先将 DATE 列转换为 MySQL 的[`DATE`](http://dev.mysql.com/doc/en/datetime.html)类型：

```
ALTER TABLE comments ADD COLUMN new_date DATE AFTER `DATE`;
UPDATE comments SET new_date = STR_TO_DATE(`DATE`, '%d/%m/%y');
ALTER TABLE comments DROP COLUMN `DATE`; 
```

（显然您需要更新您的应用程序代码才能使用这个新列）。

然后：

1.  > 如何仅选择 2012 年的记录

    您可以简单地在过滤器中使用不等式运算符：

    ```
    SELECT *
    FROM  comments
    WHERE new_date BETWEEN '2012-01-01' AND '2013-01-01' 
    ```

2.  > 然后得到 2012 年的平均评论数？

    不完全确定“平均评论数”是什么意思，但如果您想要每天的平均评论数：

    ```
    SELECT COUNT(*) / DATEDIFF('2013-01-01', '2012-01-01')
    FROM   comments
    WHERE  new_date BETWEEN '2012-01-01' AND '2013-01-01' 
    ```

# oracle - 使用sql oracle添加外键

> ID：14342307
> 
> 赞同：1
> 
> 时间：2013-01-15T16:32:30.267
> 
> 标签：oracle, oracle11g

我正在尝试将客户表中的密钥添加到 oracle 中的预订表中。但是，当我尝试运行指出“Customer_ID 是无效标识符”的 SQL 命令时，我不断收到错误消息。

我要做的是首先使用alter 语句来更改保留表。然后我添加一个外键，称为'Customer_ID' 然后我输入一个引用语句，告诉它我正在从客户表中获取 CUSTOMER_ID 属性。但是对于 sql 这根本没有意义。

对我来说，从逻辑上讲，这是有道理的，我认为语句的语法或结构没有任何问题。在这件事上帮助我的任何敏锐的眼睛/头脑将不胜感激。

使用的语句是：

```
ALTER TABLE reservation
ADD FOREIGN KEY (Customer_ID)
REFERENCES Customer(Customer_ID); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T17:14:26.887

您的语法没有问题；我能够创建具有适当名称的简单单列表，然后完全执行您发布的语句。因此，我怀疑一个或另一个表中不存在 CUSTOMER_ID 列。描述这两个表并仔细检查列名。请记住，Oracle 中的列名通常不区分大小写，但如果用双引号括起来，它们可以区分大小写；这可能是不明显的列名不匹配的原因。

# twitter - 1.1 twitter 中的related_results/show 等效项

> ID：14342310
> 
> 赞同：0
> 
> 时间：2013-01-15T16:32:40.953
> 
> 标签：twitter

我正在使用related_results 在网站应用程序中显示对话线程。

我想将api版本迁移到1.1，但是这个功能没有实现。

有人知道它是怎么做到的吗？

谢谢小伙伴们！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-22T10:34:42.473

Twitter 的官方回答是，API 1.1 没有这样的功能:( [https://dev.twitter.com/discussions/11292](https://dev.twitter.com/discussions/11292)

# java - 更改 EmptyBorder 空间颜色

> ID：14342314
> 
> 赞同：0
> 
> 时间：2013-01-15T16:32:52.483
> 
> 标签：java, swing, colors, border

有谁知道是否可以更改该`BorderFactory.createEmptyBorder()`方法提供的空白空间的颜色。默认情况下，它总是将其设置为白色 - 我想将其设置为我的 JFrame 背景的任何颜色（即灰色）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T16:35:56.917

你想要一个有颜色的空边框吗？空边框的要点是它不占用空间。没有空间的东西不可能有颜色。你想要一个线条边框吗？

参见[BorderFactory#createLineBorder(Color color)](http://docs.oracle.com/javase/7/docs/api/javax/swing/BorderFactory.html#createLineBorder%28java.awt.Color%29)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-16T01:48:26.777

将空边框和颜色（或“非”用于纯色）应用于添加到内容窗格的面板。

![蓝色的空边框](../Images/a660142481063f11ff2d2a046eea1854.png) ![纯色空边框](../Images/5e73a88fb7d3ca24cce5d7451e06d990.png)

```
import java.awt.*;
import javax.swing.*;
import javax.swing.border.EmptyBorder;

public class PlainColoredEmptyBorder {

    public static void main(String[] args) {
        Runnable r = new Runnable() {

            @Override
            public void run() {
                // the GUI as seen by the user (without frame)
                JPanel gui = new JPanel(new BorderLayout());
                gui.setBorder(new EmptyBorder(20, 30, 20, 30));

                JTree tree = new JTree();
                tree.setVisibleRowCount(4);
                gui.add(new JScrollPane(tree));
                gui.setBackground(Color.BLUE);

                JFrame f = new JFrame("Demo");
                f.add(gui);
                // Ensures JVM closes after frame(s) closed and
                // all non-daemon threads are finished
                f.setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE);
                // See http://stackoverflow.com/a/7143398/418556 for demo.
                f.setLocationByPlatform(true);

                // ensures the frame is the minimum size it needs to be
                // in order display the components within it
                f.pack();
                // should be done last, to avoid flickering, moving,
                // resizing artifacts.
                f.setVisible(true);
            }
        };
        // Swing GUIs should be created and updated on the EDT
        // http://docs.oracle.com/javase/tutorial/uiswing/concurrency/initial.html
        SwingUtilities.invokeLater(r);
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-15T19:40:19.523

> 为什么当我有一个空边框时光标会出现，而当我使用任何其他边框类型时却没有？

因为空边框是唯一`Border`不绘制的。任何其他类型的边框都将绘制在文本窗格光标上。

将您的文本窗格放在`JPanel`具有背景颜色的 a 中也不起作用，因为您的文本窗格将在 parent 之后绘制`JPanel`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-16T10:47:26.530

设置文本字段的背景颜色并将其设置为不透明可以解决此问题

# django - 如何在没有 SID 的情况下解决 ORA-12505

> ID：14342317
> 
> 赞同：2
> 
> 时间：2013-01-15T16:33:14.760
> 
> 标签：django, oracle

我正在开发一个 django 项目，当尝试连接到 Oracle 数据库时，我收到以下消息：

```
DataBaseError: ORA-12505: TNS:listener 目前不知道在
连接描述符
```

网上所有的答案都说“你需要确保你有正确的 SID”，所以我问了我工作中管理所有数据库的人，他说“我们没有这些人的 SID。我们使用服务名称反而。”

我可以通过命令行访问数据库，但试图让 django 做到这一点让我发疯。任何帮助将不胜感激。谢谢

编辑：这是我的 settings.py 文件。这不是太有趣......这是一个新鲜的项目。

```
DEBUG = True
TEMPLATE_DEBUG = DEBUG

ADMINS = ( ,
)

MANAGERS = ADMINS

DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.oracle',
        'NAME': '',
        'USER': 'a_user',                     
        'PASSWORD': 'a_password',                 
        'HOST': 'a_host',
        'PORT': '1521',
    }
}

TIME_ZONE = 'Europe/London'

LANGUAGE_CODE = 'en-us'

SITE_ID = 1

USE_I18N = True

USE_L10N = True

USE_TZ = True

MEDIA_ROOT = ''

MEDIA_URL = ''

STATIC_ROOT = ''

STATIC_URL = '/static/'

STATICFILES_DIRS = (

)

STATICFILES_FINDERS = (
    'django.contrib.staticfiles.finders.FileSystemFinder',
    'django.contrib.staticfiles.finders.AppDirectoriesFinder',
#    'django.contrib.staticfiles.finders.DefaultStorageFinder',
)

TEMPLATE_LOADERS = (
    'django.template.loaders.filesystem.Loader',
    'django.template.loaders.app_directories.Loader',
#     'django.template.loaders.eggs.Loader',
)

MIDDLEWARE_CLASSES = (
    'django.middleware.common.CommonMiddleware',
    'django.contrib.sessions.middleware.SessionMiddleware',
    'django.middleware.csrf.CsrfViewMiddleware',
    'django.contrib.auth.middleware.AuthenticationMiddleware',
    'django.contrib.messages.middleware.MessageMiddleware',
    # Uncomment the next line for simple clickjacking protection:
    # 'django.middleware.clickjacking.XFrameOptionsMiddleware',
)

ROOT_URLCONF = 'sandbox.urls'

WSGI_APPLICATION = 'sandbox.wsgi.application'

TEMPLATE_DIRS = (

)

INSTALLED_APPS = (
    'django.contrib.auth',
    'django.contrib.contenttypes',
    'django.contrib.sessions',
    'django.contrib.sites',
    'django.contrib.messages',
    'django.contrib.staticfiles',
    # Uncomment the next line to enable the admin:
    # 'django.contrib.admin',
    # Uncomment the next line to enable admin documentation:
    # 'django.contrib.admindocs',
)

LOGGING = {
    'version': 1,
    'disable_existing_loggers': False,
    'filters': {
        'require_debug_false': {
            '()': 'django.utils.log.RequireDebugFalse'
        }
    },
    'handlers': {
        'mail_admins': {
            'level': 'ERROR',
            'filters': ['require_debug_false'],
            'class': 'django.utils.log.AdminEmailHandler'
        }
    },
    'loggers': {
        'django.request': {
            'handlers': ['mail_admins'],
            'level': 'ERROR',
            'propagate': True,
        },
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-15T17:29:45.687

如果您具有 DBA 访问权限，则可以通过以下方式获取 SID：

从 V$THREAD 中选择实例；

通常，它与您的 TNSNAMES.ORA 文件中使用的名称相同（在以下情况下为 MYDB）。

```
 MYDB =
   (DESCRIPTION =
     (ADDRESS_LIST =
       (ADDRESS = (PROTOCOL = TCP)(HOST = dbserver.mynetwork)(PORT = 1521))
     )
     (CONNECT_DATA =
       (SERVICE_NAME = MYDB.mynetwork)
     )
   ) 
```

所以设置将是：

```
 DATABASES = {
     'default': {
         'ENGINE': 'django.db.backends.oracle',
         'NAME': 'MYDB',
         'USER': 'a_user',                     
         'PASSWORD': 'a_password',                 
         'HOST': 'dbserver.mynetwork',
         'PORT': '1521',
     }
 } 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-05-24T05:23:40.137

对于其他可能面临类似问题的人来说，这是另一种对我有用的方法....如果您只有服务名称而不是 SID，则使用以下步骤设置您的 Django 设置： 1\. 使用获取实例名称跟随 SQL

```
select sys_context('userenv','instance_name') from dual; --=><Myinstance> 
```

1.  在 settings.py 中替换它

    DATABASES = { 'default': { 'ENGINE': 'django.db.backends.oracle', 'NAME': '< **Myinstance** >', 'USER': 'a_user',
    'PASSWORD': 'a_password',
    'HOST ': 'dbserver.mynetwork', 'PORT': '1521', } }

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-04-07T17:16:07.220

如果您不是 DBA 或由于某种原因无权访问 SID，但您可以访问 tsnames.ora 文件，那么您可以使用该值在设置的数据库中设置“NAME”键在等号运算符的左侧。例如，如果您在 tsnames.ora 文件中有此条目：

```
DATABASE1 = 
    (DESCRIPTION = ...
    ) 
```

... settings.py 中的 DATABASES 变量将设置为 'DATABASE1' 作为 'NAME' 键的值（主机和端口将为空，因为它们由 tsnames.ora 文件中的 DATABASE1 条目引用） .

当然，这假设您已建立环境变量（特别是 ORACLE_HOME），以便系统在引用此变量时可以访问这些变量。

# javascript - 如何从后面的代码动态设置 devexpress 控件的宽度

> ID：14342319
> 
> 赞同：0
> 
> 时间：2013-01-15T16:33:44.760
> 
> 标签：javascript, asp.net, devexpress

我有四个使用 HTML table/tr/td 显示的 devexpress 下拉框控件。根据谁登录，必须显示所有四个或仅三个控件。无论显示四个还是三个控件，我都希望控件占据页面的整个宽度。请让我知道如何做到这一点。我相信一种方法是创建一个隐藏的 aspx 控件来从后面的代码中设置登录值。然后读取这个值来设置td的class属性或者devexpress控件来设置宽度。想知道有没有更简单的方法。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T20:23:34.637

标记：

```
 <table style="width: 100%;">
        <tr>
            <td id="td1" runat="server">
                <dx:ASPxDropDownEdit runat="server" Width="100%">
                </dx:ASPxDropDownEdit>
            </td>
            <td id="td2" runat="server">
                <dx:ASPxDropDownEdit runat="server" Width="100%">
                </dx:ASPxDropDownEdit>
            </td>
            <td id="td3" runat="server">
                <dx:ASPxDropDownEdit runat="server" Width="100%">
                </dx:ASPxDropDownEdit>
            </td>
            <td id="td4" runat="server">
                <dx:ASPxDropDownEdit runat="server" Width="100%">
                </dx:ASPxDropDownEdit>
            </td>
        </tr>
    </table> 
```

代码隐藏：

```
if(true) //your condition
   td1.Visible = false; 
```

# jquery-ui - jQuery Datepicker 问题，一位数月份没有前导零

> ID：14342321
> 
> 赞同：3
> 
> 时间：2013-01-15T16:33:48.463
> 
> 标签：jquery-ui, datepicker, date-format

我的日期格式是一位数的月份（没有前导零），后跟两位数的日期和两位数的年份。

2013 年 1 月 1 日 = 10113

我正在尝试将具有正确格式的日期选择器附加到它，但它的格式不正确。

[http://jsfiddle.net/S3KyX/1/](http://jsfiddle.net/S3KyX/1/)

```
<input type="text" id="date" value="10113">
$("#date").datepicker({ dateFormat: 'mddy'}); 
```

当日期选择器弹出时，它的日期是 2003 年 10 月 11 日。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T17:08:14.117

不幸的是，您的格式不起作用。如果您查看 的实现`datepicker` `formatDate`，您会发现`m`它会尝试匹配 1 位或 2 位数字，因为它无法提前判断您的意思是 1 月而不是 10 月，

这个方法是这样调用的，getNumber('m')：

```
var getNumber = function(match) {
    var isDoubled = lookAhead(match);
    var size = (match == '@' ? 14 : (match == '!' ? 20 :
            (match == 'y' && isDoubled ? 4 : (match == 'o' ? 3 : 2))));
    var digits = new RegExp('^\\d{1,' + size + '}');
    var num = value.substring(iValue).match(digits);
    if (!num)
        throw 'Missing number at position ' + iValue;
    iValue += num[0].length;
    return parseInt(num[0], 10);
}; 
```

如您所见，“m”的大小为 2，因此它将匹配 2 位数字！**如有疑问，请在代码中放置断点并查看会发生什么**（这就是我刚刚所做的，使用 chrome 开发人员工具）

# jquery - jquery 选项卡 - 直接链接到选项卡

> ID：14342327
> 
> 赞同：0
> 
> 时间：2013-01-15T16:34:08.540
> 
> 标签：jquery, tabs, jquery-tabs

我利用 jquery 向我的网站添加了一些选项卡功能。

我有三个选项卡，当用户单击一个 jquery 时，会从单击的选项卡中获取 href 并显示相应的 div（默认情况下是隐藏的），同时隐藏其他的。

我之所以采用这种方法，是因为据我了解，页面上的所有 div 都可以保持内容的 SEO 效果，而选项卡设置可以让浏览更愉快。

首先这是正确的吗？

其次 - 无论如何，这个设置是否可以直接链接到选项卡？

例如，我有一个“详细信息”（默认）选项卡和一个“评论”选项卡。有什么方法可以访问 domain.com/link.html#review_1 并让页面默认显示评论选项卡，而不是在 ID 为 review_1 的部门显示？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T16:51:33.067

是的，jQuery UI 选项卡是可散列的（可添加书签的），例如 ->

[http://muledesign.com/demo/tabs/default-tabs.html#presentation](http://muledesign.com/demo/tabs/default-tabs.html#presentation)

请参阅此答案-> [JQuery Tabs and Hyperlinking（请帮我修复我的代码）](https://stackoverflow.com/questions/14229132/jquery-tabs-and-hyperlinking-help-me-fix-my-code-please/14236403#14236403)

# android - 在 Android 上的 PhoneGap 应用程序中录制视频时限制视频尺寸/大小

> ID：14342328
> 
> 赞同：0
> 
> 时间：2013-01-15T16:34:08.937
> 
> 标签：android, cordova, file-upload, video-capture

我正在开发一个基于 Phonegap 的网络应用程序，具有记录和上传图像和视频的功能。由于视频在标准分辨率下往往非常大，因此此功能仅在我能够设法缩小文件大小（在录制时或之后）时才有用。

在 iOS 6 上，我通过使用新引入的`<input type="file">`. 因此，录制的视频会自动压缩，因此 30 秒。视频文件大小约为 3 MB，这还不错。

在 Android 中，这还没有完成（好吧，目前我什至无法获得在 Android 2.3 上工作的类型文件的输入）。由于 Android 不支持 Phonegap API 中的大小限制，并且我没有找到能够执行此操作的插件，因此我不知道如何解决此任务。

关于如何做到这一点有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T20:25:49.607

```
<input type="file"/> 
```

Android WebView 不支持。我们将在 2.4.0 中检查对该功能的一些初步支持。它不会像 iOS 那样进行压缩。

我相信您需要编写一个插件来压缩您的视频。

# css - 将其转换为 css 样式表

> ID：14342329
> 
> 赞同：0
> 
> 时间：2013-01-15T16:34:13.937
> 
> 标签：css, stylesheet

我对 css 样式表语法有点迷茫。我的困境是我有四个`<div>`标签的风格大致相同，除了颜色不同或一个可能`float: left`但另一个标签可能没有。

所以我想我可以添加`id`所有这些，以便我可以将这些样式语句移动到样式表中。

我将如何处理样式表中的每个单独的 id？我在想类似的`div#id`东西。让我们假设 basic`div`已经不可用，但我想要一些至少包含的抽象样式表标签，`display:block`然后`font-size:11px`是更具体的样式表标签，以`<div>`通过其 id 或类或名称来处理每个标签。

```
<div style="display:block; color:steelblue; float:left; font-size:11px;">Open Requests&nbsp;</div>
<div id="openNumber" style="display:block; color:steelblue; font-size:11px; clear:right;">13</div>

<div style="display:block; color:green; float:left; font-size:11px;">Completed Requests&nbsp;</div>
<div id="completeNumber" style="display:block; color:green; float:left; font-size:11px;">13</div> 
```

我对不同选择器类型的语法有所了解

感谢您的任何见解

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T16:41:37.780

您可以尝试以下方法：

CSS：

```
.floatLeft { float: left; }
.clearRight { clear: right; }
.open { color: steelblue; font-size: 11px; }
.complete { color: green; font-size: 11px; } 
```

html:

```
<div id="openRequests" class="open floatLeft">Open Requests&nbsp;</div>
<div id="openNumber" class="open clearRight">13</div>

<div id="completeRequests" class="complete floatLeft">Completed Requests&nbsp;</div>
<div id="completeNumber" class="complete floatLeft">13</div> 
```

A`<div>`已经是一个块级元素，所以你不需要`display: block`在它上面指定。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T16:46:20.673

我会使用多个类将 silimar 样式组合在一起。尝试提取语义：

像这样的东西：

**CSS：**

```
.block11 { display:block;  font-size:11px; }
.left { float:left; }
.clear-right { clear:right; }
.steelblue { color: steelblue; }
.green { color: green; } 
```

**HTML：**

```
<div class="block11 steelblue left">Open Requests&nbsp;</div>
<div class="block11 steelblue clear-right" id="openNumber">13</div>

<div class="block11 green left">Completed Requests&nbsp;</div>
<div class="block11 green left" id="completeNumber">13</div> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T16:37:34.070

您可以创建一个类`.numbers`（或最能描述您的 div 分组的任何内容）来保存共享样式，并将该类添加到有问题的 div 中。然后，用它们的 id 定位单个 div 来调整颜色。

这样的事情可能会有所帮助：

**CSS**

```
.numbers {
 /* shared styles */ 
}

#one {
 /* unique styles */ 
}

#two {

 /* unique styles */ 
}

#three {

 /* unique styles */ 
} 
```

以语义和有意义的方式组织样式可能具有挑战性，但是节省维护代码的时间非常值得。有关如何执行此操作的更好总结，您可以阅读[这篇](http://coding.smashingmagazine.com/2011/12/12/an-introduction-to-object-oriented-css-oocss/)文章。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-15T16:40:07.370

您可以使用一个类来表示相似之处，并使用一个`id`来表示不同之处。

```
<div class="common" id="some-id"><!-- ... --></div> 
```

***CSS：***

```
.common {
    display: block;
    float: left;
    font-size: 11px;
}

#completeNumber {
    color: green    
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-15T16:40:47.833

由于 id 必须是唯一的，您可以向它们添加一个 ID，然后使用：

```
#openRegistration{display:block; color:steelblue; float:left; font-size:11px;}
#openNumber{display:block; color:steelblue; font-size:11px; clear:right;}
#completedRequests{display:block; color:green; float:left; font-size:11px;}
#completeNumber{display:block; color:green; float:left; font-size:11px;} 
```

现在，鉴于上述情况，我们可以将其简化为：

```
#openRegistration,#openNumber,#completedRequests,#completeNumber{display:block;font-size:11px;}
#openRegistration{ color:steelblue; float:left; }
#openNumber{color:steelblue;  clear:right;}
#completedRequests{ color:green; float:left;}
#completeNumber{ color:green; float:left; } 
```

或者如果你愿意，给他们一个课程并使用它：

```
.myClass{display:block;font-size:11px;}
#openRegistration{ color:steelblue; float:left; }
#openNumber{color:steelblue;  clear:right;}
#completedRequests{ color:green; float:left;}
#completeNumber{ color:green; float:left; } 
```

编辑：或者如果你愿意，给他们一个以上的课程并使用它：

```
.myClass{display:block;font-size:11px;}
.complete{ color:green;}
.open{ color:steelblue;}
#openRegistration{  float:left;}
#openNumber{clear:right;}
#completedRequests{ float:left;}
#completeNumber{ float:left; }

<div class="myClass complete" ... 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-15T16:43:26.947

您可以定义一些 CSS 类并根据需要将它们分配给您的元素。只是一个例子：

***CSS：***

```
.myDiv {
  display: block;
  font-size: 11px;
}

.left { float: left; }
.clear-both { clear: both; }
.steelblue { color: steelblue; }
.green { color: green; } 
```

***HTML：***

```
<div class="myDiv left steelblue">Open Requests&nbsp;</div>
<div class="clear-both"></div>
<div id="openNumber" class="myDiv steelblue">13</div>

<div class="myDiv green left">Completed Requests&nbsp;</div>
<div id="completeNumber" class="myDiv green left">13</div> 
```

通过这种方式，您可以分离您的类并仅在您真正需要时使用它们。

# javascript - 如何获取谷歌地图图像获取日期？

> ID：14342332
> 
> 赞同：1
> 
> 时间：2013-01-15T16:34:21.047
> 
> 标签：javascript, google-maps

我们正在使用 javascript 嵌入谷歌地图，并希望获得图像采集日期。如果我的术语不正确，我想获取捕获卫星或 arial 图像的日期。这可能吗？如果可以，怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T19:23:51.140

不，不是来自他们的公共 JavaScript API。没有关于可用的图块集中使用的特定图块的信息。

# android - 一个活动的多个实例

> ID：14342333
> 
> 赞同：2
> 
> 时间：2013-01-15T16:34:22.577
> 
> 标签：android, android-activity

每当有来电时，我都试图在来电屏幕上显示用户信息。所以我有一个广播接收器监听来电，它启动意图服务，随后启动一个活动（*使用主题对话框*）。

现在，只要有来电，我的活动对话框就会弹出并按预期显示。

**问题**：当活动对话框已经在屏幕上并且发生来电时，没有新的活动对话框包含新信息。我想只要有实例，Android 就不会创建新实例。所以看起来我的问题是“*创建一个活动的多个实例*”。

请注意，我正在使用**FLAG_NEW_TASK**从意图服务开始活动。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T17:08:03.397

谷歌文档说：

[FLAG_ACTIVITY_NEW_TASK](http://developer.android.com/reference/android/content/Intent.html#FLAG_ACTIVITY_NEW_TASK)

> “使用此标志时，如果您现在正在启动的 Activity 的任务已经在运行，则不会启动新的 Activity；相反，当前任务将简单地以上次的状态被带到屏幕的前面在。”

所以，如果你想开始**一个新的活动**，那么就不要只使用这个标志，你应该将它与[FLAG_ACTIVITY_CLEAR_TASK](http://developer.android.com/reference/android/content/Intent.html#FLAG_ACTIVITY_CLEAR_TASK)一起使用以获得所需的结果。

例如：

```
// Sets the Activity to start in a new, empty task
notifyIntent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK | 
        Intent.FLAG_ACTIVITY_CLEAR_TASK); 
```

如果上述解决方案不是您需要的，请查看 [android:launchMode](http://developer.android.com/guide/topics/manifest/activity-element.html#lmode)`activity`属性，在文件标记中使用所需选项（即根据您的需要）声明此属性`manifest`。

希望这能解决问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-02T12:13:33.167

根据文档使用标志 FLAG_ACTIVITY_MULTIPLE_TASK ：

```
Used in conjunction with FLAG_ACTIVITY_NEW_TASK to disable the behavior of bringing an existing task to the foreground. When set, a new task is always started to host the Activity for the Intent, regardless of whether there is already an existing task running the same thing. 
```

将此标志与 FLAG_ACTIVITY_NEW_TASK 一起使用将导致每个活动实例被创建为单独的任务，因此您可以弹出不同的对话框。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-12-01T13:45:28.963

只需将以下标志添加到您的`Intent`.

```
intent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK
            | Intent.FLAG_ACTIVITY_EXCLUDE_FROM_RECENTS
            | Intent.FLAG_ACTIVITY_MULTIPLE_TASK); 
```

# android - Android单元测试不起作用

> ID：14342340
> 
> 赞同：0
> 
> 时间：2013-01-15T16:34:49.333
> 
> 标签：android, unit-testing

嘿，

我是 Android 测试的新手。我尝试编写使用editText 将两个数字相乘的测试。它似乎没有运行并且在模拟器上没有显示任何内容。我的测试代码如下

```
import android.test.ActivityInstrumentationTestCase2;

import com.example.calculator.MainActivity;
import com.jayway.android.robotium.solo.Solo;

public class MathValidation extends ActivityInstrumentationTestCase2<MainActivity> {

    private Solo solo;
    public MathValidation() {
        super(MainActivity.class);
    }

    protected void setUp() throws Exception {
        solo=new Solo(getInstrumentation(),getActivity());
    }

    protected void tearDown() throws Exception {
        solo.finishOpenedActivities();
    }
    public void Test() throws Exception{
        solo.assertCurrentActivity("wrong activity", MainActivity.class);
        solo.enterText(0, String.valueOf("10"));
            solo.enterText(1,String.valueOf("30"));
        solo.clickOnButton("Multiply");
        assertTrue(solo.searchText("300"));

    } 
```

这是我的日志猫

```
01-15 16:23:27.832: E/Trace(1190): error opening trace file: No such file or directory (2)
01-15 16:23:27.832: W/Trace(1190): Unexpected value from nativeGetEnabledTags: 0
01-15 16:23:27.832: W/Trace(1190): Unexpected value from nativeGetEnabledTags: 0
01-15 16:23:27.832: W/Trace(1190): Unexpected value from nativeGetEnabledTags: 0
01-15 16:23:28.322: D/dalvikvm(1190): GC_CONCURRENT freed 331K, 15% free 2565K/3012K, paused 72ms+101ms, total 265ms
01-15 16:23:28.322: D/dalvikvm(1190): WAIT_FOR_CONCURRENT_GC blocked 12ms
01-15 16:23:28.713: D/dalvikvm(1190): GC_CONCURRENT freed 484K, 20% free 2540K/3144K, paused 73ms+85ms, total 215ms
01-15 16:23:28.862: W/Trace(1190): Unexpected value from nativeGetEnabledTags: 0
01-15 16:23:28.862: W/dalvikvm(1190): method Landroid/test/InstrumentationTestRunner$StringResultPrinter;.print incorrectly overrides package-private method with same name in Ljunit/textui/ResultPrinter;
01-15 16:23:31.202: E/Trace(1216): error opening trace file: No such file or directory (2)
01-15 16:23:31.212: W/Trace(1216): Unexpected value from nativeGetEnabledTags: 0
01-15 16:23:31.212: W/Trace(1216): Unexpected value from nativeGetEnabledTags: 0
01-15 16:23:31.212: W/Trace(1216): Unexpected value from nativeGetEnabledTags: 0
01-15 16:23:31.772: D/dalvikvm(1216): GC_CONCURRENT freed 334K, 16% free 2558K/3012K, paused 72ms+85ms, total 246ms
01-15 16:23:32.182: D/dalvikvm(1216): GC_CONCURRENT freed 491K, 18% free 2571K/3124K, paused 72ms+73ms, total 220ms
01-15 16:23:32.332: W/Trace(1216): Unexpected value from nativeGetEnabledTags: 0
01-15 16:23:32.332: W/dalvikvm(1216): method Landroid/test/InstrumentationTestRunner$StringResultPrinter;.print incorrectly overrides package-private method with same name in Ljunit/textui/ResultPrinter; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T20:36:36.407

所有这些显示的是代码，而不是您实际运行测试的方式。您是从 Eclipse 还是从命令行运行它？无论如何，这将有助于查看您正在遵循的确切步骤。

另外，Solo 是一项活动吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-06T04:41:44.710

在大多数测试框架中，测试方法的名称必须以`test`. 方法名称区分大小写，因此问题是您的方法被调用`Test()`而不是`test()`. 这就是它没有运行的原因。

Java 中的标准编码约定使用以小写字母开头的方法名称。此外，您通常希望为您的测试提供更具描述性的名称，例如`testMultiply()`.

# c++ - 读取 CAN 输入时更新 GUI 元素的效率/速度

> ID：14342341
> 
> 赞同：0
> 
> 时间：2013-01-15T16:34:55.010
> 
> 标签：c++, visual-c++, user-interface, buffer, can-bus

在这个项目之前，我没有使用控制器区域网络 (CAN) 或 ValueCAN3 的经验，我使用 Intrepid 的一个示例来阅读消息。但是，我在显示我正在读取的模拟和数字信号的 GUI 的更新效率和频率方面存在问题。

我的 GUI 由 16 个用于模拟通道的数字上/下框和 36 个按钮组成，这些按钮会根据数字信号是打开 (1) 还是关闭 (0) 而变为绿色。在阅读我的 CAN 消息时，我会更新 GUI 控件以显示适当的反馈。然而，当我按下插入的 CAN 操纵杆上的按钮时，数字通道几乎会立即响应，而模拟信号不会随着我用来改变信号的弦壶而快速更新。有时模拟信号需要 1 - 2 秒才能响应。

目前我设置了 GUI 控件，然后我从 GUI 控件中读取值并通过套接字连接通过 UDP 将值发送到另一个应用程序。我可能应该将其更改为从我直接接收的信号中发送数据，而不是从我正在设置的 GUI 控件中读取数据，但我认为这不是问题所在。

我正在使用 System::Timers::Timer 对象来更新、读取消息和发送数据包。我需要 50hz - 100hz 的速率，最好接近 100hz。使用另一端的套接字，我可以看到我的数据包被发送得足够频繁，但是模拟通道的数据变化并不平滑或频繁。如果有人对我可能做错了什么有任何想法，或者如何以更有效的方式处理数据，请说明。

这是 Intrepid 读取 CAN 消息的代码段：

```
// Read the messages every timer event (1000 ms)
        if (m_bPortOpen) // only if the port is open
        {
            // call icsneoGetMessages to read out the messages
            lResult = icsneoGetMessages(hObject,stMessages,&lNumberOfMessages,&lNumberOfErrors);
            if (lResult != 0)
            {
                // a successful read
                mNumberOfErrorsRead = lNumberOfErrors;
                mNumberOfMessagesRead = lNumberOfMessages;  // store the number of messages in the current buffer
            }
        } 
```

我的表单使用以下方法从我的 CanReader 对象请求一条消息：

```
msg = can->GetLatestMsg(); 
```

并且该方法获取收到的最后一条消息。

```
public: icsSpyMessage* GetLatestMsg()
{
return &stMessages[mNumberOfMessagesRead - 1];
}; 
```

我认为这个 GetLatestMsg() 似乎是实现检索最新消息的不好方法，但我不完全确定这对我的程序有多大影响，或者我还能如何做到这一点，因为 CanReader 与 Form 是分开的所以我必须传递一系列我认为否则的消息。我确实怀疑这可能会跳过消息，因为它只读取最后一个抓取的消息，而不是导致它的消息，如果读取这些消息，应该会使 GUI 输出在过渡时显得更平滑。

另一件要注意的是，我正在从 6 个不同的 PGN 中读取数据，模拟信号对应于 4 个 PGN，2 个对应于数字信号。

### 更新

在玩过我的应用程序并在不同的模拟通道上使用弦乐壶之后，我注意到一些通道比其他通道更新得更多。通过检查正在访问的 PGN，我发现我访问的 PGN 比其他 PGN 更频繁。

CAN 设备不是以相对相同的速率为不同的 PGN 广播数据吗？如果是，那么我的 GetLatestMsg() 方法一定不能有效地读取不同的 PGN。它每 5 毫秒读取一个新的 msg。

此外，有谁知道我是否应该制作单独的阅读计时器来分别检测不同的 PGN？

如果有其他代码我可以提供清晰的说明，请告诉我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T15:42:41.027

经过大量的测试和调试，我找到了一个稳定的解决方案。我发布这个答案是希望其他人可以从这个解释中受益。

在 CANbus 上读取消息时，消息在总线上广播，您必须根据参数组名称 (PGN) 选择所需的消息。每个 PGN 都应该针对不同的数据块进行定义。

例如，引擎 rpm 将对应于特定的 PGN，当您检查缓冲区中的消息时，您将寻找 PGN 对应于引擎 rpm 的消息。

就我而言，我正在从我正在使用的 valueCAN3 设备中读取/想要 6 个不同的 PGN。这些消息中的每一个都包含对应于模拟和数字信号的不同数据。效率错误与我如何从缓冲区中检索最新消息有关。

当您只是在每个数据包中传输所有相同的数据时，从缓冲区中获取最新或最近的消息是有意义的。但是，在我的情况下，因为我需要 6 个不同的 PGN，这意味着当我从缓冲区中抓取最后一条消息时，它只对应于 6 个 PGN 中的 1 个，并且由于我的 CANbus 上的消息以恒定速率发送并且以同样的顺序，我一直在阅读大约一半的数据包，而错过了另一半。通过抓取 2 个最近的数据包，我发现我所有的频道现在都在以我的应用程序所需的速度进行更新。我所有的信号都在没有明显延迟的情况下发生变化，并且很容易满足我需要的 50hz - 100hz 范围。

但是，我认为最佳解决方案是在我从缓冲区中提取时读取每个 PGN 的最新消息，而不是仅读取最新的两条消息，这可能对应于我的 6 个 PGN 中的任何一个，因为我阅读的频率高于我收到的数据包。

# perl - 绑定 Perl 哈希键

> ID：14342342
> 
> 赞同：0
> 
> 时间：2013-01-15T16:34:58.630
> 
> 标签：perl, hash

是否可以强制不同的 perl 哈希键映射到相同的值？例如：

```
my %h = (
   aaa => 'val_1',
   bbb => 'val_2',
);
print "==============\n";
&dump();

$h{bbb} = \$h{aaa};    
&dump();

$h{aaa} = 'new';    
&dump();

sub dump{
    foreach my $k ( sort keys %h ){
    print "$k => $h{$k}\n";
    }
    print "==============\n";
} 
```

这将打印：

```
==============
aaa => val_1
bbb => val_2
==============
aaa => val_1
bbb => SCALAR(0x801d48)
==============
aaa => new
bbb => SCALAR(0x801d48) 
```

但我想要的是：

```
==============
aaa => val_1
bbb => val_2
==============
aaa => val_1
bbb => val_1
==============
aaa => new
bbb => new 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T17:13:36.077

您可以存储对值的引用而不是值（如您所示）。这是做到这一点的“干净”方式。

正如 clintp 建议的那样，不太干净的方法是使用绑定哈希。

不太干净的方法是别名：

```
use Data::Alias;
...
alias $h{bbb} = $h{aaa}; 
```

请注意，这涉及到 perl 的内部结构，如果 Data::Alias 变得无人维护并且新的 perl 版本破坏了它，这会带来一定程度的风险。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-30T06:53:19.637

```
#!\usr\bin\perl 
use strict;
use warnings;

my %h = (
   aaa => 'val_1',
   bbb => 'val_2',
);
print "==============\n";
&dump();

$h{bbb} = $h{aaa};    
&dump();

$h{aaa} = 'new';    
$h{bbb} = $h{aaa};
&dump();

sub dump{
    foreach my $k ( sort keys %h ){
    print "$k => $h{$k}\n";
    }
    print "==============\n";
} 
```

输出是：

```
==============
aaa => val_1
bbb => val_2
==============
aaa => val_1
bbb => val_1
==============
aaa => new
bbb => new 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-31T05:24:56.373

或者你可以这样做，这将给出你想要的输出：

```
#!\usr\bin\perl 
use strict;
use warnings;
my %h = (aaa => 'val_1', bbb => 'val_2');
print "==============\n";
&dump();
my $ha = \$h{aaa}; 
$h{bbb} = $$ha;
&dump();
$$ha = 'new'; 
$h{bbb} = $$ha;   
&dump();
sub dump
{
 foreach my $k (sort keys %h)
 {
  print "$k => $h{$k}\n";
 }
 print "==============\n";
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-15T16:39:03.060

您可以使用`tie`创建一个哈希实现，该实现将在您检索值时执行自动取消引用。

# nginx - 在从主机文件结构挂载 /var/www/ 的虚拟机上，来自 nginx 的文件未找到错误

> ID：14342345
> 
> 赞同：0
> 
> 时间：2013-01-15T16:35:04.233
> 
> 标签：nginx, subdomain, virtualbox, fastcgi, mount

我正在尝试设置一个相当复杂的开发环境作为虚拟 Ubuntu 12.04 服务器。

为了我可以编辑文件并在刷新页面时立即看到更改，正如您在正常本地开发情况下所期望的那样，我在 ~/www/site1 中拥有主机操作系统（mint 14）上的 php 源代码我已将其作为持久共享文件夹添加到 virtualbox，然后安装在虚拟机上

```
mount -t vboxsf site1 /var/www 
```

如果我 ls /var/www -la 我看到所有的 php 文件，但是当我尝试从浏览器访问虚拟机时，我在页面上得到 File not found 错误，并且子域的 error.log 报告**在 stderr 中发送的 FastCGI ：“从上游读取响应标头时，主脚本未知”**。例外是子域 phpmyadmin.virtualmachine，它可以完美加载，所以我知道 nginx 正在为请求的子域提供正确的文件结构。

作为测试，我创建了一个指向 /var/test 的子域 info.virtualmachine 并且 index.php 是最简单的 phpinfo() 并且它有效，所以我只能假设 nginx 没有读取挂载的 vboxsf 文件结构 /var/www正确，因为来宾操作系统上的所有“本地”文件都是可见的。

Nginx 已配置为与所有其他服务一样以 root 身份运行。这是 nginx 的已知错误还是我需要配置以允许 nginx 查看已安装的 vboxsf 共享？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T10:19:35.033

我找到了答案，结果证明是由于文件权限和我不熟悉 php-fpm 的工作原理。

对于初学者，我在虚拟服务器中启用了 root 用户并使用 supervisord 来控制守护进程，我将它们全部设置为以 root 身份运行。php-fpm 的父进程以 root 身份运行，但所有子进程都以 www-data 身份运行。以 root 身份安装共享导致文件夹对 php-fpm 的子进程不可用，这导致 nginx 抛出未找到文件的错误，并且由于 vboxsf 的工作方式，我无法 chown 或 chmod 共享。

我通过使用以下命令将共享添加到 /etc/fstab 来解决这个问题：

```
sharename     /var/www     vboxsf    rw,uid=33,gid=33     0      0 
```

这允许将共享安装在 www-data 用户下，授予对 www-data 的读取权限。

# php - 使用 codeIgniter 组织 Web 应用程序

> ID：14342346
> 
> 赞同：1
> 
> 时间：2013-01-15T16:35:04.387
> 
> 标签：php, html, codeigniter, web-applications, web

我对 CodeIgniter 的视图组织有疑问。

**项目：**创建一个允许管理图书馆（书柜）的简单 Web 应用程序。

我创建了 3 个模型：**Member**、**Categories**、**Books**以及它们各自的控制器。

我用它的控制器实现了成员模型。

在 member_controller 中，我们有：

```
public function login(){

$this->load->helper('form');
$this->load->helper('email');
$this->load->library('form_validation');

$mail = $this->input->post('mail');
$pass = $this->input->post('pass');

$data['mail'] = $mail;
$data['pass'] = $pass;

$this->form_validation->set_rules('mail', 'mail', 'required');
$this->form_validation->set_rules('pass', 'pass', 'required');

if ($this->form_validation->run() === TRUE)
{

$result=$this->membre_model->login($mail,$pass);

if($result==TRUE){

$this->load->view('templates/header.php');
$this->load->view('membre/logged',$data);
$this->load->view('templates/footer.php');

} 
```

一旦用户登录，我想显示他之前创建的所有现有类别（所以从数据库中获取它们）。

*   我怎样才能做到这一点？
*   我必须在成员控制器的登录功能中调用类别控制器的功能吗？
*   我必须从登录功能加载类别视图吗？
*   我是否必须仅从一个控制器（成员控制器）构建站点？
*   如何使用不同控制器的不同视图构建 webapp？

最后，我不明白的是不同的控制器如何在它们之间进行通信。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T16:57:08.853

您可以使用 URI 从另一个控制器调用一个控制器，例如，您的路由文件中可能有这样的条目：

```
$route['books/get_books_by_user/(:any)'] = "books/get_books_by_user/$1"; 
```

然后你可以调用你的登录控制器：

```
redirect('books/get_books_by_user/'.$user_id) 
```

然后，您将在您的书籍控制器中的 get_books_by_user 方法中处理此问题。例如使用：

```
$user_id = $this->uri->segment(3);
$collection = $this->books_model->get_books_by_user($user_id); 
```

您遇到的问题是，如果您不希望用户以外的任何人看到他们自己的图书列表，您必须检查用户是否从您的图书控制器登录。这就是为什么大多数用户身份验证脚本都显示为一个可以从任何控制器访问的库。如果您的身份验证不是这样布置的，您可以将用户详细信息存储为会话数据并从那里进行检查，这意味着您不必通过 uri 传递用户名。在此处查看会话文档以获取详细信息：[http ://ellislab.com/codeigniter/user-guide/libraries/sessions.html](http://ellislab.com/codeigniter/user-guide/libraries/sessions.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T17:04:08.370

**我怎样才能做到这一点？**

在加载将根据用户的登录状态重定向用户的每个页面时，您必须添加一个异常。换句话说，如果用户已登录，则将他带到应用程序。如果用户不存在，将他重定向到注册页面。

这可以通过验证用户是否基于存储的会话值登录来完成。如果此会话已存储，则您可以让用户查看该页面。这是一个很棒的教程，解释了 Codeigniter 的简单登录系统。

[http://www.codefactorycr.com/login-with-codeigniter-php.html](http://www.codefactorycr.com/login-with-codeigniter-php.html)

在我看来，我通常使用身份验证库来简化我的应用程序的登录系统。我会使用[Ion Auth](http://benedmunds.com/ion_auth/)，它有一个很好的文档来解释你可以使用的所有功能。

**我必须在成员控制器的登录功能中调用类别控制器的功能吗？**

您可以像往常一样简单地使用类别控制器。您将根据存储在浏览器中的会话信息更改页面信息或将用户重定向出去。

**我必须从登录功能加载类别视图吗？**

您将从类别控制器加载类别视图。登录控制器会在用户登录后将用户重定向到类别控制器。

**我是否必须仅从一个控制器（成员控制器）构建站点？**

不，您可以拥有任意数量的控制器。

**如何使用不同控制器的不同视图构建 webapp？**

控制器将代表您网站的一部分。该控制器将为不同的事物加载多个视图。这是一个[很棒的小教程](http://net.tutsplus.com/tutorials/other/mvc-for-noobs/?search_index=10)，解释了 MVC 工作流。这将帮助您了解该过程。

# javascript - 如何简化 jquery 选择器？

> ID：14342352
> 
> 赞同：1
> 
> 时间：2013-01-15T16:35:12.607
> 
> 标签：javascript, jquery, selector

我有这个 jQuery 选择器：

```
'div.i_like.user0:not(.dsbl),div.i_like.zero:not(.dsbl)' 
```

在

```
Picks.MainNode.on('mouseenter', 'div.i_like.user0:not(.dsbl),div.i_like.zero:not(.dsbl)', function(e) ... 
```

有没有办法分组`.user0`和`.zero`更简单的选择器？

# c# - StructureMap: HttpContextScoped() 对象，并处理它们，

> ID：14342353
> 
> 赞同：2
> 
> 时间：2013-01-15T16:35:14.800
> 
> 标签：c#, dependency-injection, inversion-of-control, structuremap

如果我`HttpContextScoped()`在会话期间处理一个对象并尝试再次获取一个实例会发生什么？它会重新创建它吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T09:28:21.580

> 它会重新创建它吗？

当然不是。StructureMap 应该如何知道您已处置它？它不能神奇地将事件挂在该对象上或将其包装在某种动态代理中。这太神奇了（不要忘记开销）。只是不要将服务暴露给实现`IDisposable`. `IDisposable`是[一个泄漏的抽象](https://stackoverflow.com/a/2635733/264697)。

# php - 在php中将tiff转换为jpg？

> ID：14342355
> 
> 赞同：15
> 
> 时间：2013-01-15T16:35:28.060
> 
> 标签：php, image, gd

我有一个保存 TIFF 图像的服务器。大多数客户端可以读取和显示 TIFF 图像，所以没有问题。但是，有些客户端无法处理这种格式，但可以处理 JPG。我想使用 PHP 的 GD 库为没有 TIFF 读取能力的客户端进行服务器端转换。但我注意到 GD 也无法读取 TIFF 文件。

Imagick 不能在 Windows 中工作，我的想法是创建一个 imageFetcher.php，它作为参数获取客户端想要的实际图像。它会检查客户端的类型，并在需要时转换图像并输出 JPG，否则它只会输出 TIFF。

有没有人知道我怎么能做这样的事情？

提前致谢。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-01-15T16:39:00.753

在[http://www.php.net/gd](http://www.php.net/gd)的论坛中，写了以下评论：

IE 不显示 TIFF 文件，标准 PHP 发行版不支持与 TIFF 之间的转换。

ImageMagick ( [http://www.imagemagick.org/script/index.php](http://www.imagemagick.org/script/index.php) ) 是一款免费软件，可以读取、转换和写入多种格式的图像。对于 Windows 用户，它包含一个 PHP 扩展 php_magickwand_st.dll（是的，它在 PHP 5.0.4 下运行）。

从 TIFF 转换为 JPEG 时，您还必须将 CMYK 颜色空间转换为 RGB 颜色空间，因为 IE 也无法显示 CMYK JPG。请注意： -TIFF 文件可能有 RGB 或 CMYK 颜色空间 -JPEG 文件可能有 RGB 或 CMYK 颜色空间

以下是使用 ImageMagick 扩展的示例函数： - 将 TIFF 转换为 JPEG 文件格式 - 将 CMIK 转换为 RGB 颜色空间 - 将图像分辨率设置为 300 DPI（不以像素为单位更改图像大小）

```
<?php

function cmyk2rgb($file) {
    $mgck_wnd = NewMagickWand();
    MagickReadImage($mgck_wnd, $file);

    $img_colspc = MagickGetImageColorspace($mgck_wnd);
    if ($img_colspc == MW_CMYKColorspace) {
        echo "$file was in CMYK format<br />";
        MagickSetImageColorspace($mgck_wnd, MW_RGBColorspace);
    }
    MagickWriteImage($mgck_wnd, str_replace('.', '-rgb.', $file));
}

function tiff2jpg($file) {
    $mgck_wnd = NewMagickWand();
    MagickReadImage($mgck_wnd, $file);

    $img_colspc = MagickGetImageColorspace($mgck_wnd);
    if ($img_colspc == MW_CMYKColorspace) {
        echo "$file was in CMYK format<br />";
        MagickSetImageColorspace($mgck_wnd, MW_RGBColorspace);
    }
    MagickSetImageFormat($mgck_wnd, 'JPG' );
    MagickWriteImage($mgck_wnd, str_replace('.tif', '.jpg', $file));
}

function to300dpi($file) {
    $mgck_wnd = NewMagickWand();
    MagickReadImage($mgck_wnd, $file);
    $img_units = MagickGetImageUnits($mgck_wnd);
    switch ($img_units) {
        case MW_UndefinedResolution: $units= 'undefined'; break;
        case MW_PixelsPerInchResolution: $units= 'PPI'; break;
        case MW_PixelsPerCentimeterResolution: $units= 'PPcm'; break;
    }
    list($x_res, $y_res) = MagickGetImageResolution($mgck_wnd);
    echo "$file<br /> x_res=$x_res $units - y_res=$y_res $units<br />";
    if($x_res == 300 && $y_res == 300 && $img_units == MW_PixelsPerInchResolution) {return; }
    MagickSetImageResolution($mgck_wnd, 300 , 300);
    MagickSetImageUnits($mgck_wnd, MW_PixelsPerInchResolution);
    MagickWriteImage($mgck_wnd, str_replace('.', '-300.', $file));
}

$file='photos/test-cmyk.tif';
//this is a TIFF file in CMYK format with a 96 DPI resolution

cmyk2rgb($file);
$file = str_replace('.', '-rgb.', $file);

to300dpi($file);
$file = str_replace('.', '-300.', $file);

tiff2jpg($file);
$file = str_replace('.tif', '.jpg', $file);

to300dpi($file);
/* no file name changes as ImageMagick reports 300 DPIs
$file = str_replace('.', '-300.', $file);
*/

list($width, $height, $type, $attr) = getimagesize($file);
$width = $width/3;
$height = $height/3;
echo "<img src=\"http://localhost/$file\" width=\"$width\" height=\"$height\" alt=\"getimagesize() example\" />";
echo "<br />$file => width=$width - height=$height - type=$type - attr=$attr<br /><br />";

$file='photos/test-rgb.tif';
//this is a TIFF file in RGB format with a 96 DPI resolution

cmyk2rgb($file);
$file = str_replace('.', '-rgb.', $file);

to300dpi($file);
$file = str_replace('.', '-300.', $file);

tiff2jpg($file);
$file = str_replace('.tif', '.jpg', $file);

to300dpi($file);
/* no file name changes as ImageMagick reports 300 DPIs
$file = str_replace('.', '-300.', $file);
*/

list($width, $height, $type, $attr) = getimagesize($file);
$width = $width/3;
$height = $height/3;
echo "<img src=\"http://localhost/$file\" width=\"$width\" height=\"$height\" alt=\"getimagesize() example\" />";
echo "<br />$file => width=$width - height=$height - type=$type - attr=$attr<br /><br />";

?> 
```

注意 - 尽管 ImageMagick 正确地将 JPEG 文件分辨率设置为 300 DPI，但某些程序可能不会注意到它。

**别的**

使用“imagick”PECL 扩展

[http://pecl.php.net/package/imagick](http://pecl.php.net/package/imagick)

[http://php.net/manual/en/book.imagick.php](http://php.net/manual/en/book.imagick.php)

根据来源和目的地（文件？网址？http响应？），您将执行以下操作：

```
 $image = new Imagick('something.tiff');
    $image->setImageFormat('png');
    echo $image; 
```

或者

```
$image->writeImage('something.png'); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-09-02T11:02:03.510

我使用“convert”和 ImageMagick 解决了这个问题，而不必将其安装为 DLL。这实际上是有史以来最好的决定，因为它也解决了 PDF 的问题。所以我只是使用：

```
$command = "convert ".$filename."[0] ".$destination;
exec($command); 
```

[0] 用于 PDF，因此它将始终占据第一页，但它也适用于 TIFF。

您现在需要的只是在您的 Windows 机器上进行“转换”，上面的 PHP 将适用于两者。所以只需安装[这个](https://www.imagemagick.org/script/download.php#windows)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-06-21T05:13:29.167

Tif 可以有多个页面，因此需要更全面的方法。这是一个例子：

```
 //given uploaded file $filename    
    $ext = strtolower(substr($filename, strrpos($filename, '.') + 1));

    if ($ext == 'tif' || $ext == 'tiff') {
        $images = new Imagick($upload_path . $filename);

        //if you want to delete the original tif
        unlink($upload_path . $filename);

        $name = strtolower(substr($filename, 0, strrpos($filename, '.')));
        $filename = $name . '.png';
        foreach ($images as $i => $image) {
            $image->setImageFormat("png");
            $image->writeImage($upload_path . $i . $filename);
        }
    } 
```

# ember.js - Ember-data：嵌套模型属性访问错误

> ID：14342362
> 
> 赞同：2
> 
> 时间：2013-01-15T16:35:56.297
> 
> 标签：ember.js, handlebars.js, ember-data

我在访问车把模板中的嵌套模型属性时遇到了一个奇怪的问题。
我的 JSON 提要如下所示：

```
{
"hic": {
    "id": "1",
    "tree": {
        "id": "1",
        "folder": [
            {name: "test1"},
            {name: "test2"}
        ]
    ...
    }
}
} 
```

当我尝试通过以下把手模板显示我的文件夹对象时：

```
<ul>
    {{#with tree}}
        {{#each folder}}
            <li>{{name}}</li>
        {{/each}}
    {{/with}}
</ul> 
```

它出错：未捕获的 类型错误**：无法调用未定义的方法“hasOwnProperty”。**

此*解决方法*带来了预期的结果。

```
<ul>
    {{#with tree.data.hasMany}}
        {{#each folder}}
            <li>{{name}}</li>
        {{/each}}
    {{/with}}
</ul> 
```

这是 ember-data 的问题还是我做错了什么？

注意：我无法在 jsfiddle 中重现该问题。当我通过*createRecord()创建**Hic 模型*时，一切都按预期工作。

 *json-feed 可以在[这里](http://dl.dropbox.com/u/42353723/hic.json)找到。那是我的[app.js](http://dl.dropbox.com/u/42353723/app.js)。我还可以提供一个完整的 node.js 项目。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-18T14:16:03.633

根本原因似乎是嵌入的*belongsTo*关系。这个拉取请求修复了这个问题：正确[提取嵌入的`belongsTo`记录](https://github.com/emberjs/data/pull/637 "emberjs/data@Github：拉取请求 637")。非常感谢[Sandstrom](https://github.com/sandstrom)！*

# c# - 从另一个带有非空标签的 XML 文件创建 XML 文件

> ID：14342371
> 
> 赞同：-1
> 
> 时间：2013-01-15T16:36:27.927
> 
> 标签：c#, xml, linq, linq-to-xml

我有一个 XML 文件，如下所示。我想使用这个 XML 文件创建另一个 XML 文件，但新的 XML 文件只能包含那些具有值的标签。例如 - 在下面的 XML 文件中，我有一个没有城市和州的员工 Sam，所以我的新 XML 文件不能包含这些空标签。我是 LINQ to XML 的新手，但我的朋友说我可以使用 LINQ to XML 来实现它。任何帮助将不胜感激。

谢谢。

```
 <?xml version="1.0" encoding="utf-8" ?>
        <Employees>
         <Employee>
<EmpId>1</EmpId>
<Name>Sam</Name>   
<Sex>Male</Sex>
<Phone Type="Home">423-555-0124</Phone>
<Phone Type="Work">424-555-0545</Phone>
          <Address>
  <Street>7A Cox Street</Street>
  <City></City>
  <State></State>
  <Zip>95220</Zip>
  <Country>USA</Country>
</Address>
      </Employee>
             <Employee>
<EmpId>2</EmpId>
<Name>Lucy</Name>
<Sex>Female</Sex>
<Phone Type="Home">143-555-0763</Phone>
<Phone Type="Work">434-555-0567</Phone>
<Address>
  <Street>Jess Bay</Street>
  <City>Alta</City>
  <State>CA</State>
  <Zip>95701</Zip>
  <Country>USA</Country>
</Address>
  </Employee>
       <Employee>
<EmpId>3</EmpId>
<Name>Kate</Name>
<Sex>Female</Sex>
<Phone Type="Home">166-555-0231</Phone>
<Phone Type="Work">233-555-0442</Phone>
<Address>
  <Street>23 Boxen Street</Street>
  <City>Milford</City>
  <State>CA</State>
  <Zip>96121</Zip>
  <Country>USA</Country>
</Address>
     </Employee>
           <Employee>
<EmpId>4</EmpId>
<Name>Chris</Name>
<Sex>Male</Sex>
<Phone Type="Home">564-555-0122</Phone>
<Phone Type="Work">442-555-0154</Phone>
<Address>
  <Street>124 Kutbay</Street>
  <City>Montara</City>
  <State>CA</State>
  <Zip>94037</Zip>
  <Country>USA</Country>
</Address> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T16:46:56.237

```
XDocument xdoc = XDocument.Load(path_to_xml);
xdoc.Descendants("Employee")
    .Where(e => e.Descendants().Any(d => String.IsNullOrEmpty(d.Value)))
    .Remove();
xdoc.Save(path_to_xml); 
```

# spotify - 如何使用 spotify api 查找热门曲目和新版本

> ID：14342372
> 
> 赞同：-2
> 
> 时间：2013-01-15T16:36:28.737
> 
> 标签：spotify, libspotify

如何从 web api 或获取热门曲目和新发行专辑信息`libspotify`？我试过`SPToplist`了，`libspotify`但它对我不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T14:56:26.627

## 热门曲目

查看 libspotify 提供的 spshell 示例。toplist.c 文件具有特定于 toplist 的部分，而 spshell.c、spshell_win32.c 和 spshell_posix.c 具有基本的事件循环代码，您完全需要使用 libspotify。您至少需要：

1.  创建会话。（为此您需要一个应用程序密钥。）
2.  登录。
3.  在主线程上运行事件循环以根据需要调用 sp_session_process_events。
4.  处理 notify_main_thread 回调并使用它来唤醒您的事件循环，以便它调用 sp_session_process_events。
5.  调用 sp_toplist_browse_create 以请求顶部列表，并在顶部列表准备好时向其传递回调以调用。
6.  在您的回调中，您可以访问结果。

## 新版本

我认为为此你想搜索“tag:new”。查看 spshell 示例中的 search.c。搜索的工作方式类似于浏览热门列表。

# jquery - jquery在悬停时改变类

> ID：14342378
> 
> 赞同：0
> 
> 时间：2013-01-15T16:36:40.407
> 
> 标签：jquery

我是 jQuery 的新手，但我一生都无法弄清楚我做错了什么。当我将鼠标悬停在“更改它”文本上时，我希望表格行的颜色发生变化。请帮忙！（是的，该文档指的是保存的 jQuery 库）

```
<html>
<head>
    <title>testestsets</title>
    <script type="text/javascript" src="jquery.js"></script>
    <script type="text/javascript">
        $('#changer').hover(function) {
            $('#row1').css({
                'background-color':'#000',
                'color':'#FFF'
            });
        };
    </script>
</head>

<body>
    <table border="1">
        <tr id="row1">
            <td>ONE</td><td>TWO</td><td>THREE</td><td>FOUR</td>
        </tr>
    </table>
    <br/><br/>
    <p id="changer">Change it</p>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-15T16:38:49.770

将您的 jQuery 代码包装在一个文档就绪调用中，如下所示：

```
$(document).ready(function () {
  $('#changer').hover(function() {
    $('#row1').css({
      'background-color': '#000',
        'color': '#FFF'
    });
  });
}); 
```

此外，您在带括号的函数调用中有错字。

**[jsFiddle 示例](http://jsfiddle.net/j08691/bYPks/)**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T16:39:08.397

您将`.hover`回调绑定到`#changer`之前`#changer`存在于 DOM 中。将 JavaScript 移至下方`<p id="changer">`或将其包装起来`$(document).ready(function () {})`

您还可以使用 CSS 伪类`:hover`来执行您想要执行的操作，它还将处理自动删除在悬停时添加的类。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-15T16:40:08.020

```
$(document).ready(function () {    
    $('#changer').hover(
        function() {
            $('#row1').css({
                'background-color':'#000',
                'color':'#FFF'
            });
        }, 
        function() {
            // what that do when they go out
        }
    );
}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-15T16:40:38.283

您的 jQuery 中有一个错误。你有一个`)`在错误的地方，缺少`()`后功能和`)`关闭悬停功能。

此外，您还需要将其包装在 a`$(function(){ });`中，以便在将事件分配给 DOM 元素之前加载并准备好 DOM。

将其更改为：

```
$(function(){
    $('#changer').hover(function(){
        $('#row1').css({
            'background-color':'#000',
            'color':'#FFF'
        });
    });
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-15T16:40:09.750

你非常亲近。您缺少 document.ready 和括号。

```
$(document).ready(function(){
    $("#changer").hover(function(){
        $("tr").css({
            'background-color': '#000',
            'color': '#fff'
        });
    });
}); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-15T16:41:28.190

您可以使用简单的 css 来完成任务

```
#changer:hover { background-color: #000;color:fff; } 
```

或者，如果您想使用 jquery：

```
 $(document).ready(function () {    
    $('#changer').hover(
        function() {
            $('#row1').css({
                'background-color':'#000',
                'color':'#FFF'
            });
        }, 
        function() {
           $('#row1').css({
                'background-color':'#FFF',
                'color':'#000'
            });
        }
    );
}); 
```

# wordpress - 建立数据库连接 Wordpress 时出错

> ID：14342381
> 
> 赞同：0
> 
> 时间：2013-01-15T16:36:50.457
> 
> 标签：wordpress, ftp, filezilla

我知道有很多类似的帖子，但我似乎找不到答案。我正在将我的 WordPress 文件上传到 FileZilla 中新创建的目录中。一切都很成功。我从 localhost 导出了我的数据库并将其导入到 cPanel。当我打开 ByetHost 提供的网站 URL 时，是一条祝贺信息。所以我在 URL 中添加了 /wordpress 并将我重定向到主页。当我试图单击另一个页面时，出现错误：“建立数据库连接时出错”。当我查看地址栏时，链接仍在 localhost 中，例如 localhost/wordpress/hobby。我已经用 ByetHost 给我的东西更改了我的 wp-config.php 凭据。即使登录时，数据库错误仍然存​​在。我试着做 wp-admin/install.php，它告诉我我已经安装了它，但是当我尝试登录时出现数据库错误。请帮助初学者，谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T16:51:41.700

听起来您在本地沙盒开发和生产服务器部署中遇到了一个共同的痛点。

简而言之，您的数据库在整个各种记录中都有“localhost”引用。一旦它部署在您的生产服务器上，并且您尝试在*"yourdomain.com"*上进行任何连接，系统就会在 URL 和数据库中的记录之间发生冲突。

Codex 有一篇[很好的文章](http://codex.wordpress.org/Moving_WordPress#When_Your_Domain_Name_or_URLs_Change)，介绍了如何在域名更改时迁移安装。（这本质上就是你正在做的事情）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T16:51:47.240

我认为您需要更改数据库中的 url，url 存储在 wp_options 表 'siteurl' 和 'home' [siteurl](http://codex.wordpress.org/Changing_The_Site_URL)

如果您在项目中有核心 url，那么在 wp_options 表中更改 url 后，您可以使用[update url 插件](http://wordpress.org/extend/plugins/velvet-blues-update-urls/)来更新 url。

希望对你有帮助

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T17:27:38.917

在导出数据库之前，您需要确保在设置页面中更改站点 url 和 wordpress url。这应该可以防止任何问题。

登录后尝试更新您的永久链接。此外，如果您添加了自定义菜单或链接，请务必同时更新它们。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-05T04:36:01.980

在我安装了几个插件后，我得到了这个错误。尝试卸载几个插件。您可以使用“Plugin Performance Profiler”来检查庞大的 MySQL quire 生成插件。

# indexing - Cassandra：哪个是手动索引的最佳选择

> ID：14342382
> 
> 赞同：0
> 
> 时间：2013-01-15T16:36:57.380
> 
> 标签：indexing, cassandra, manual

首先，对不起我的英语。这不是我的母语。我正在将 SQL 数据库移至 Cassandra，但我有一个无法解决的问题。假设我有一个存储歌曲的 SQL 表。每首歌曲都有一个 ID 作为主键，它允许访问其所有相关数据，这些数据存储在由键给出的行的字段中。我还有一些索引可以使用一些不同的标准进行搜索，例如作者、性别、标题......

当我考虑将其移至 Cassandra 模式时，我围绕着这样一个想法，即我可以创建一个等效的列族，其中歌曲 ID 是行键，歌曲属性是列。然后，我可以创建 5 或 6 个手动索引来按作者、标题、性别等进行搜索。作者，标题...将是列键（添加一些额外的数据以保持它们的唯一性，使用复合列名），值将是用于在静态列族中搜索的歌曲 ID，其中每一行由歌曲ID。

但我在这里出现了我的怀疑。哪个更好：每个索引 CF 只存储 ID 还是存储所有属性？第一个选项允许我减少必要的内存量，但我需要（至少）2 次读取来获取每首歌曲的属性。使用第二个选项，我需要更多内存，因为每个索引重复一次相同的信息，但是通过一次读取，我可以获得我需要的所有属性。如果这将是一个更快的模式，我想我可以假设需要额外的内存，但是，它真的会更快吗？拥有更大的数据库不会使其工作速度变慢吗？或者由于 Cassandra 存储行的方式和 2 次读取，较慢的操作是搜索索引 CF 给出的每一行？

另一个细节：我计算出使用第二个选项（将所有属性存储在作为“索引”的 CF 中）我需要比使用第一个选项多 80% 的内存（CF 确实可以作为索引来查找正确的数据）歌曲的“主要”CF）。

任何帮助将不胜感激。

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T19:30:29.793

当然，不同的数据模型有各种各样的权衡，但听起来你主要关心的是数据集的大小和访问速度。Cassandra 可以以线性可扩展的方式处理大量数据，只要您可以为其提供必要的资源来完成这项工作。另一方面，当您进行按键获取时，进行两次查找非常便宜。我的直觉是只存储 ID，如果没有其他原因，它可以更容易地更新您的属性。然后，如果您发现查询不够快，则可以进行优化。不过，来自 RDBMS，我猜它会很快。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T00:12:32.680

您还需要查看宽行模式。像 PlayOrm 这样的一些库会为您执行该模式，因此您可以执行诸如 Scalable SQL（即带有分区）之类的操作。您可以拥有任意数量的分区。我相信未来也会有越来越多的 NoSql 对象映射库存在……PlayOrm 的 wiki 上也有一个模式页面，其中包含 noSql 模式和 PlayOrm 模式……你可能想查看 nosql 的.

# android - Android SOAP 响应中断

> ID：14342383
> 
> 赞同：1
> 
> 时间：2013-01-15T16:37:01.927
> 
> 标签：android, web-services, soap, ksoap2

我最近开始在 Android 上使用 kSOAP2 时遇到一些问题，特别是在收到响应时。这是问题，使用多个 AVD 和物理设备进行了测试：

我开始向本地计算机上运行的 Web 服务发送请求，并且在收到响应时通常会收到以下异常。

```
01-15 17:15:43.819: E/SOAP(2904): java.lang.IllegalStateException: getInputStream() is not available. Is this a reentrant call? 
```

最困扰我的是，起初它总是会发生，但现在它只有在我通过我的物理设备发送请求时才会发生（现在 AVD 得到了正确的响应）。

另外，一开始我决定检查流量，检查我是否收到了格式正确的响应，但我看到 SOAP 响应在某个点（在节点内）被简单地切断了。

我在库中找到了引入此异常的提交，并且您可以看到它在响应为空时启动（或者有错误，我猜）： http: [//gitorious.org/ginger/libcore/commit/ c6dae581716b9362a5c7f166c80a7f2b46ed1124/diffs?diffmode=sidebyside&fragment=1](http://gitorious.org/ginger/libcore/commit/c6dae581716b9362a5c7f166c80a7f2b46ed1124/diffs?diffmode=sidebyside&fragment=1)

有任何想法吗？:)

**编辑：**我附上了拨打电话的代码：

```
ListRQ rq = new ListRQ(c, l, s, "");

    PropertyInfo pi = new PropertyInfo();
    pi.setName("request");
    pi.setValue(rq);
    pi.setType(rq.getClass());
    request.addProperty(pi);

    SoapSerializationEnvelope envelope = new SoapSerializationEnvelope(SoapEnvelope.VER11);
    envelope.dotNet = false;
    envelope.setOutputSoapObject(request);

    envelope.addMapping(Params.NAMESPACE, "ListRQ", ListRQ.class);
    MarshalDouble md = new MarshalDouble();
    md.register(envelope);

    HttpTransportSE htse = new HttpTransportSE(Params.URL);
    htse.debug = true;

    try {
        htse.call(Params.GetList.SOAP_ACTION, envelope);
        SoapObject response = (SoapObject) envelope.getResponse();
        Log.d("SOAP", response.toString());

    }
    catch(Exception e) {
        Log.e("SOAP", e.toString());
    } 
```

# java - 安全 URI 构建

> ID：14342385
> 
> 赞同：0
> 
> 时间：2013-01-15T16:37:16.963
> 
> 标签：java, http

我正在用 Java 编写一个类，它`http://hostA/webProjectB/ServletC`使用一些参数访问 url。由于它是一个 get http 调用，我可以将参数附加到 URL ..

```
http://hostA/webProjectB/ServletC?parameter1=California&parameter2=yes 
```

这将返回 xml 格式的响应`<root><parameter3>123</parameter3></root>`

基本上，我有兴趣在我的 http 响应中提取 parameter3 的值，我知道该怎么做。

我的问题是 WebUrl 到我存储在外部配置中的 servlet，我作为字符串检索，我可以简单地将 get 调用参数 1 和 2 附加到我检索的这个字符串中吗？如果我将获取 URL 构建为字符串，这会产生任何可能的问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T17:12:16.633

您需要确保您正在编码正确定义的参数，即使用`URLEncoder.encode(string,charset)`.

使用 URI 模板库之一可能会更好地为您服务，即[Handy URI Templates](https://github.com/damnhandy/Handy-URI-Templates)或[JAX-RS UriBuilder](http://jersey.java.net/nonav/apidocs/1.5/jersey/javax/ws/rs/core/UriBuilder.html)

否则，只要您正确转义字符（即 `URLEncoder.encode(string,charset)`对于参数名称和值），您应该没问题

# r - 用 R 绘制单边极限

> ID：14342386
> 
> 赞同：0
> 
> 时间：2013-01-15T16:07:32.120
> 
> 标签：r, function

是否可以用 R 绘制以下函数？

$$\lim\limits _{x\to3^{+}}\, f(x)=2$$

$$\lim\limits _{x\to3^{-}}\, f(x)=1$$

基本上，我想看一个有 2 条曲线的图。如果可能的话，如何在曲线的末端制作一些圆圈（黑色或白色）......？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-15T16:35:44.540

定义一个分段连续函数：

```
ff <- function (xx) ifelse(xx<3,xx,xx+1) 
```

绘制它的第一部分，保留足够的空间来绘制其余部分：

```
curve(expr=ff,from=0,to=2.999,xlim=c(0,6),ylim=c(0,7),xlab="",ylab="") 
```

添加第二部分：

```
curve(expr=ff,from=3,to=6,add=TRUE) 
```

添加一个小圆圈：

```
points(3,ff(3),pch=21,bg="black") 
```

结果： ![在此处输入图像描述](../Images/a87194c3a683bc3819234670ae671673.png)

# c# - 为什么自动生成的 WP8 初始化代码会失败？

> ID：14342390
> 
> 赞同：0
> 
> 时间：2013-01-15T16:37:30.300
> 
> 标签：c#, initialization, windows-phone-8, windows-phone-8-emulator

此代码中的“RootFrame =”行，所有这些都是自动生成的：

```
private void InitializePhoneApplication()
{
    if (phoneApplicationInitialized)
        return;

    // Create the frame but don't set it as RootVisual yet; this allows the splash
    // screen to remain active until the application is ready to render.
    RootFrame = new PhoneApplicationFrame();
    RootFrame.Navigated += CompleteInitializePhoneApplication;

    // Handle navigation failures
    RootFrame.NavigationFailed += RootFrame_NavigationFailed;

    // Handle reset requests for clearing the backstack
    RootFrame.Navigated += CheckForResetNavigation;

    // Ensure we don't initialize again
    phoneApplicationInitialized = true;
} 
```

...失败：

> *System.TypeInitializationException 未被用户代码处理 HResult=-2146233036 消息=“TaSLS_PhoneApp.App”的类型初始化程序引发了异常。Source=TaSLS_PhoneApp
> TypeName=TaSLS_PhoneApp.App StackTrace：在 TaSLS_PhoneApp.App.set_RootFrame（PhoneApplicationFrame 值）在 TaSLS_PhoneApp.App.InitializePhoneApplication() 在 TaSLS_PhoneApp.App..ctor() InnerException: System.NotImplementedException HResult=-2147467263 消息=方法或操作未执行。Source=Windows StackTrace：在 Windows.Storage.ApplicationData.get_RoamingSettings() 在 TaSLS_PhoneApp.App..cctor() InnerException：*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T16:45:24.017

根本原因不是生成的代码，而是它正在调用的代码......

> TaSLS_PhoneApp.App.InitializePhoneApplication() at TaSLS_PhoneApp.App..ctor() InnerException: System.NotImplementedException HResult=-2147467263 Message=方法或操作未实现。Source=Windows StackTrace：在 Windows.Storage.ApplicationData.get_RoamingSettings() 在 TaSLS_PhoneApp.App..cctor() InnerException：*

看起来您的应用程序`InitializePhoneApplication`正在调用 Windows phone 8 上未实现的 WinRT 函数。请参阅 MSDN 文档：http: [//msdn.microsoft.com/en-gb/library/windows/apps/windows.storage。 applicationdata.roamingsettings](http://msdn.microsoft.com/en-gb/library/windows/apps/windows.storage.applicationdata.roamingsettings)。

# java - 如何动态更改jtable单元格背景

> ID：14342396
> 
> 赞同：1
> 
> 时间：2013-01-15T16:37:47.193
> 
> 标签：java, swing, jtable, renderer

我`JTable table1`有 5 行 5 列，当我调用类似的函数时，我想更改第 3 列/第 2 行单元格的背景颜色

> 改变BgColor（行，列）；

这可能吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-15T17:16:46.093

覆盖[prepareRenderer](http://docs.oracle.com/javase/7/docs/api/javax/swing/JTable.html#prepareRenderer%28javax.swing.table.TableCellRenderer,%20int,%20int%29)方法来做到这一点。

**例子：**

```
public Component prepareRenderer (TableCellRenderer renderer, int rowIndex, int columnIndex){  
    Component componenet = super.prepareRenderer(renderer, rowIndex, columnIndex);  

    if(rowIndex % 2 == 0) {  
       componenet.setBackground(Color.RED);  
    } else {
       componenet.setBackground(Color.GREEN);
    }
    return componenet;
} 
```

在这里，我将偶数位置的所有行着色为`RED`，奇数位置的所有行着色为`GREEN`。

就你的问题考虑。使用相同的方法，只需使用约束说明，

```
if(rowIndex == 2 && columnIndex == 3) {
   componenet.setBackground(Color.RED);
} 
```

除了上述单元格之外，所有单元格都将获得默认颜色。

# javascript - Javascript 启用已禁用的文本框

> ID：14342407
> 
> 赞同：1
> 
> 时间：2013-01-15T16:38:24.433
> 
> 标签：javascript, jquery, html, textbox

我正在尝试创建一个表单，其中一个文本字段加载被禁用，如果用户想要输入这个字段，他们必须单击一个复选框。我现在有这个。

但是，启用文本框下方的加载并勾选复选框将禁用它。如何对此进行修改，以便将其反转。即文本框首先被禁用，然后单击复选框启用它？

Javascript代码

```
$(document).ready(function () {
            $('#testcheckbox').change(function() {
                $('#testtextfield').attr('disabled', this.checked);
            });
        }); 
```

HTML 代码

```
<input type="checkbox" id="testcheckbox" />
<input type="text" id="testtextfield" /> 
```

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-15T16:39:24.493

尝试使用此设置：

```
<input type="checkbox" id="testcheckbox" />
<input type="text" id="testtextfield" disabled="disabled" />

$(document).ready(function () {
    $('#testcheckbox').change(function() {
        $('#testtextfield').prop('disabled', !this.checked);
    });
}); 
```

[http://jsfiddle.net/93HJ3/](http://jsfiddle.net/93HJ3/)

在这种情况下，文本框是`disabled`默认的。然后，当单击复选框时，文本框会根据其反转`checked`属性被禁用，以实现您想要的相反行为。

如果您查看[http://api.jquery.com/prop/](http://api.jquery.com/prop/)，您会发现它是更适合更改元素属性（如“禁用”、“只读”、“已检查”等）的 jQuery 方法。并且关于差异的一个很好的讨论：[.prop() 与 .attr()](https://stackoverflow.com/questions/5874652/prop-vs-attr)。但是，如果您需要更改属性或属性，这完全取决于您，因为它们具有不同的含义。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-03-03T16:18:15.443

如果您不想使用 jQuery，则纯 JavaScript 等效。

```
<input type="text" id="inputbox" diasbled="disabled" />

var inputbox = document.getElementById('inputbox');

document.addEventListener('DOMContentLoaded',function(){
    inputbox.removeAttribute('disabled');
}); 
```

# quartz-scheduler - Quartz Jobs 依赖

> ID：14342408
> 
> 赞同：5
> 
> 时间：2013-01-15T16:38:24.387
> 
> 标签：quartz-scheduler

我正在使用 Quartz 进行一个项目，并且一直存在与作业的依赖关系的问题。

我们有一个设置，其中 A 和 B 不相互依赖，尽管 C 是：

A 和 B 可以同时运行，但 C 只能在 A 和 B 都完成时运行。

有没有办法在 Quartz 中设置这种场景，这样 C 只会在 A 和 B 完成时触发？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-12-14T22:11:29.180

我认为这是当前的方法： [http ://www.quartz-scheduler.org/documentation/faq#FAQ-chain](http://www.quartz-scheduler.org/documentation/faq#FAQ-chain)

根据此常见问题解答，您可以创建一个等待 A 和 B 完成的作业侦听器，然后在完成后安排作业 C。

PS：以下是链接更改时的文本：

> ## 如何链接作业执行？或者，如何创建工作流？
> 
> 目前没有“直接”或“免费”的方式来使用 Quartz 链接触发器。但是，您可以通过多种方式轻松完成它。以下是几种方法的概述：
> 
> 一种方法是使用一个监听器（即 TriggerListener、JobListener 或 SchedulerListener），它可以注意到作业/触发器的完成，然后立即安排新的触发器触发。这种方法可能会涉及一些问题，因为您必须通知侦听器执行哪个作业 - 您可能需要担心此信息的持久性。请参阅 Quartz 附带的侦听器 org.quartz.listeners.JobChainingJobListener - 因为它已经具有一些此功能。
> 
> 另一种方法是构建一个 Job，在其 JobDataMap 中包含要触发的下一个作业的名称，并在作业完成时（其 execute() 方法的最后一步）让作业调度下一个作业。有几个人正在这样做，并且运气不错。大多数人已经创建了一个基本（抽象）类，它是一个 Job，它知道如何使用预定义的键（常量）从 JobDataMap 中获取作业名称和组，并包含用于安排已识别作业的代码。这个抽象 Job 的 execute() 实现委托给一个抽象模板方法，例如“doWork()”（扩展 Job 类的实际工作所在），然后它包含用于调度后续作业的代码。然后他们简单地扩展这个类，包括工作应该做的工作。使用“持久”工作，
> 
> 将来，Quartz 将提供一种更简洁的方法来执行此操作，但在此之前，您必须使用上述方法之一，或者考虑另一种更适合您的方法。

# javascript - 使用单个平面图像的假视差效果

> ID：14342413
> 
> 赞同：3
> 
> 时间：2013-01-15T16:38:39.667
> 
> 标签：javascript, image-processing, canvas, parallax

我试图在 JavaScript 中使用 . 很难描述我的意思，但我会尝试：

当我将鼠标悬停在页面上时，我希望页面上的内容可以移动。后面的东西应该比前面的东西移动得少——通常的[视差效果](https://github.com/404)——*除非*我想使用**平面图像**来这样做。现在，通常您必须在图像编辑器中剪掉一些东西并替换现在缺少的部分背景等等。但我想我曾经以某种“假”的方式看到过这个：通过稍微拉伸和压缩背景。

不幸的是，我再也找不到这种效果的例子了，但我很确定它与**置换贴图**有关。

有这种东西的图书馆吗？或者至少有人知道我可以翻译成 JavaScript 的另一种语言的例子吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T02:26:16.320

不太确定你在问什么。但我已经使用精灵来快速制作视差场景。它确实涉及多个图像层，但它们很容易制作。 [http://www.spritely.net/](http://www.spritely.net/)

还有一些其他的视差解决方案，比如这个。这种方法涉及重复相同的图像以创建深度。 [http://www.stevefenton.co.uk/cmsfiles/assets/File/imageparallax.html](http://www.stevefenton.co.uk/cmsfiles/assets/File/imageparallax.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-22T17:13:42.043

乍一看，[Phrogz](https://stackoverflow.com/users/405017/phrogz) [链接](http://www.soundstep.com/blog/2012/04/25/javascript-displacement-mapping/)似乎不相关（我之前自己研究时也点击了相同的链接），但当我更深入地研究它时，它*正是*我想要的。

不幸的是，它*真的很*慢，所以它不适合我想要的那种动画，尤其是屏幕填充图像。通过做一些微优化，我得到了一些更快的速度，但最终这种事情对于今天的 JavaScript 来说似乎太激烈了。

无论如何，这就是我最终的结果。也许它可以帮助某人，或者也许有人想出如何加速它以便以 30 或 60 fps 使用它（工人？）。*代码一点也不漂亮，因为我只是弄乱了一点。以它为起点。*

HTML：

```
&lt;!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <title></title>
        <script src="displacement.js"></script>
    </head>
    <body>
        <script>
            (function() {
                'use strict';
                var source, map, target;
                var sourceCtx, mapCtx, targetCtx;
                var loaded = false;
                var x = 0, y = 0;
                var filter;

                function render() {
                    filter = new filters.DisplacementMap(
                            source,
                            map,
                            target,
                            new filters.Point(0, 0),
                            x,
                            y,
                            filters.ColorChannel.RED,
                            filters.ColorChannel.RED);
                    filter.draw();
                }

                (function init() {
                    var img = new Image();

                    function prepareCanvases() {
                        // Create canvases and add them to the document
                        source = document.createElement('canvas');
                        map = document.createElement('canvas');
                        target = document.createElement('canvas');
                        [target, source, map].forEach(function(canvas) {
                            canvas.setAttribute('width', img.width);
                            canvas.setAttribute('height', img.height);
                            document.body.appendChild(canvas);
                        });

                        // Get contexts
                        sourceCtx = source.getContext('2d');
                        mapCtx = map.getContext('2d');
                        targetCtx = target.getContext('2d');
                    }

                    // Load source image
                    (function loadImage() {
                        img.onload = function() {
                            prepareCanvases();
                            sourceCtx.drawImage(img, 0, 0);
                            img.onload = function() {
                                mapCtx.drawImage(img, 0, 0);
                                addEventListeners();
                                loaded = true;
                            };
                            // Put your displacement map here
                            img.src = 'jn-map-small.jpg';
                        };
                        // Put your image here
                        img.src = 'jn-edit-small.jpg';
                    }());

                    // Event listener
                    function addEventListeners() {
                        target.onmousemove = function(e) {
                            x = ((-e.offsetX / source.width) * 10) + 5;
                            y = ((-e.offsetY / source.height) * 10) + 5;
                            render();
                        };
                    }
                }());
            }());
        </script>
    </body>
</html> 
```

位移.js：

```
/**
 * Based on Romuald Quantin's code
 * @see http://www.soundstep.com/blog/2012/04/25/javascript-displacement-mapping/
 */
var filters = {} || filters;
(function() {

    filters.ColorChannel = {
        RED: 0,
        GREEN: 1,
        BLUE: 2,
        ALPHA: 3
    };

    filters.Point = function(x, y) {
        this.x = x || 0;
        this.y = y || 0;
    };

    filters.DisplacementMap = function(source, map, target, point, scaleX, scaleY, channelX, channelY) {
        this.source = source;
        this.map = map;
        this.target = target;
        this.sourceCtx = this.source.getContext("2d");
        this.mapCtx = this.map.getContext("2d");
        this.targetCtx = this.target.getContext("2d");
        this.point = point || new filters.Point();
        this.scaleX = scaleX || 0;
        this.scaleY = scaleY || 0;
        this.channelX = channelX || filters.ColorChannel.RED;
        this.channelY = channelY || filters.ColorChannel.RED;
        if (this.channelX !== 0 && this.channelX !== 1 && this.channelX !== 2 && this.channelX !== 3)
            this.channelX = filters.ColorChannel.RED;
        if (this.channelY !== 0 && this.channelY !== 1 && this.channelY !== 2 && this.channelY !== 3)
            this.channelY = filters.ColorChannel.RED;
    };

    var p = filters.DisplacementMap.prototype;

    p.draw = function() {
        var sourceData = this.sourceCtx.getImageData(0, 0, this.source.width, this.source.height);
        var mapData = this.mapCtx.getImageData(0, 0, this.map.width, this.map.height);
        var targetDataX = this.sourceCtx.getImageData(0, 0, this.source.width, this.source.height);
        var targetDataY = this.sourceCtx.getImageData(0, 0, this.source.width, this.source.height);
        var pixelsLength = mapData.data.length / 4;
        var colorValue,
                alphaValue,
                ratio,
                ratioWithAlpha,
                pixelShift,
                sourcePosition,
                targetPosition,
                x,
                y;
        var i = 0;
        var map = this.map;
        var point = this.point;
        var channelX = this.channelX;
        var channelY = this.channelY;
        var scaleX = this.scaleX;
        var scaleY = this.scaleY;
        var source = this.source;
        var target = this.target;
        while (i < pixelsLength) {
            x = ((i % map.width) + point.x) | 0;
            y = (((i / map.width) | 0) + point.y) | 0;
//            alphaValue = mapData.data[i * 4 + filters.ColorChannel.ALPHA];
//            ratioWithAlpha = ratio * (alphaValue / 0xFF);
            targetDataX.data = this.setPixels(targetDataX.data, (target.width * y) + x + ((((mapData.data[i * 4 + channelX]) / 0xFF * 2) - 1) * scaleX | 0), sourceData.data, (source.width * y) + x);
            i++;
        }
        i = 0;
        while (i < pixelsLength) {
            x = ((i % map.width) + point.x) | 0;
            y = (((i / map.width) | 0) + point.y) | 0;
//            alphaValue = mapData.data[i * 4 + filters.ColorChannel.ALPHA];
//            ratioWithAlpha = ratio * (alphaValue / 0xFF);
            targetDataY.data = this.setPixels(targetDataY.data, (target.width * (y + ((((mapData.data[i * 4 + channelY]) / 0xFF * 2) - 1) * scaleY | 0))) + x, targetDataX.data, (source.width * y) + x);
            i++;
        }
        this.targetCtx.putImageData(targetDataY, 0, 0);
    };

    p.setPixels = function(target, pos, source, i) {
        i = i * 4;
        pos = pos * 4;
        target[i] = source[pos];
        target[i + 1] = source[pos + 1];
        target[i + 2] = source[pos + 2];
        target[i + 3] = source[pos + 3];
        return target;
    };

})(); 
```

# c - 双指针作为函数参数

> ID：14342414
> 
> 赞同：0
> 
> 时间：2013-01-15T16:38:41.237
> 
> 标签：c, pointers

我遇到了很多链表函数和 C 函数，它们打算将双指针代替单指针传递给函数。例如，下面这个函数用于在链表中进行排序插入：

```
 void sortedinsert(struct node **headref,struct node *newnode)
    {
           while(*headref!=NULL&&(*headref)->data<newnode->data)
                   headref=&((*headref)->next);
           newnode->next=headref;
           *headref=newnode;
    } 
```

请向我解释一下使用双指针作为函数参数代替单指针，以及如何简化上述链表的编写函数？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T16:39:54.597

这个“双指针”是指向指针的指针。`sortedinsert`它允许函数在更新列表的头项时更新调用者的指针副本。

该行将`*headref=newnode;`调用者的指针更新为指向`newnode`。（顺便说一句，我认为代码有问题。看起来`headref`总是设置为`newnode`，无论插入的列表位置如何`newnode`。）

请注意，在这种情况下，您可以通过更改函数以返回指向列表头部的指针来避免使用指向指针的指针。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T16:47:02.773

请注意，如果您使用的是 C++，则可以通过`headref`引用传递，因此相同的代码会更简单。它的作用完全相同，但更简单：

```
 void sortedinsert(struct node* &headref,struct node *newnode)
    {
           while(headref!=NULL && headref->data < newnode->data)
                   headref = headref->next;
           newnode->next = headref;
           headref = newnode;
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T16:42:04.037

该`sortedinsert`函数接受一个指向链表头指针的指针和一个指向新节点的指针。

链表头只是一个指针，但在这个函数中是一个“指向指针的指针”，因为该函数正在改变链表头的位置。

新节点被添加到列表中的排序位置，并且头部似乎总是被修改为指向最新的节点。

# ios - UIControl 子类延迟响应

> ID：14342420
> 
> 赞同：1
> 
> 时间：2013-01-15T16:38:56.737
> 
> 标签：ios, ipad, uitouch, uicontrol

我有一个名为 CheckboxView 的 UIControl 自定义子类，当用户点击矩形时，它只是在矩形内绘制一个复选标记。这是作为一个单元格添加到 tableView 中的，它位于主容器 AttributeFormView 中。

正如预期的那样，当用户点击矩形时，会触发 -endTrackingWithTouch 并正确绘制复选标记。

但是，如果我向 AttributeFormView 添加一个包含带有 checkboxView 单元格的 tableView 的子视图，则对 checkBoxView 中的 UITouch 有明显的延迟响应。tableView 中的所有其他单元格都做出了适当的响应，但为了让复选标记出现，用户必须点击并按住矩形约 3 秒。

我放：

```
CGPoint testpoint = [touch locationInView:self]; 
```

内部 -endTrackingWithTouch 以确保正确的视图被触摸，确实如此，但是这 3 秒的延迟是一个问题。

关于为什么会有如此显着的延迟有什么想法吗？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-09T16:30:10.193

我刚刚遇到了同样的问题。在我的情况下，这是因为我在主视图控制器视图上有一个手势识别器。一旦我将手势识别器移到它自己的视图中，问题就解决了！

希望有帮助

# xcode - iOS 6.0 iAd 弃用问题

> ID：14342424
> 
> 赞同：0
> 
> 时间：2013-01-15T16:39:02.647
> 
> 标签：xcode, ios6, iad, deprecated

任何人都知道用什么来替换 ios 6 的 requiredContentSizeIdentifiers、ADBannerContentSizeIdentifierPortrait 和 currentContentSizeIdentifier？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T09:06:42.530

您需要使用以下代码行

```
 TabAdvert.AutoresizingMask = UIViewAutoresizing.All; 
```

（标签广告是你 BannerAdView 的名字）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T06:04:18.663

@ Dave123 从 iOS 6.0 开始，横幅将根据其宽度自动调整大小。然而，为了支持 iOS 5.0，我们继续适当地设置 currentContentSizeIdentifier。作为

CGRect contentFrame = self.view.bounds;
if (contentFrame.size.width < contentFrame.size.height) {
_bannerView.currentContentSizeIdentifier = ADBannerContentSizeIdentifierPortrait;
} else {
_bannerView.currentContentSizeIdentifier = ADBannerContentSizeIdentifierLandscape;
}

只需在使用 ios 5.0 时编写代码，在 ios 6.0 中它会自行完成所有其他工作。

# perl - 如何使用 require 从 Exporter Perl 模块导入符号？

> ID：14342426
> 
> 赞同：2
> 
> 时间：2013-01-15T16:39:10.533
> 
> 标签：perl, import, module, perl-module, exporter

我喜欢`import`使用而`Exporter`不是. Perl 不知道他刚刚导入的变量。`require``use`

Perl 模块示例：

```
package TheModule;
use strictures;
use base 'Exporter';
use Const::Fast qw( const );
const our $TEST_VAR_1 => 'Test variable 1';
our @EXPORT_OK = qw( $TEST_VAR_1 );
our %EXPORT_TAGS = ( TEST_VAR => [qw( $TEST_VAR_1 )] ); 
```

Perl 脚本示例

```
#!/usr/bin/perl
use strictures;
require TheModule;
TheModule->import( ':TEST_VAR' );
printf "Test variable 1 contains: %s\n", $TEST_VAR_1; 
```

以下示例有效，但我必须使用`require`而不是`use`.

```
#!/usr/bin/perl
use strictures;
use TheModule ( ':TEST_VAR' );
printf "Test variable 1 contains: %s\n", $TEST_VAR_1; 
```

`$TEST_VAR_1`环境内如何导入`require`？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-15T16:59:43.817

`our @EXPORT_TAGS`应该是`our %EXPORT_TAGS`。:)

* * *

好吧，还有其他问题。在编译时，当

```
printf "Test variable 1 contains: %s\n", $TEST_VAR_1; 
```

正在被转换为操作，`$TEST_VAR_1`在该范围内还不存在，因为

```
TheModule->import( ':TEST_VAR' ); 
```

仅在运行时执行。所以，除非你`BEGIN{}`在你的 require 和 import 周围加上一个，否则这是行不通的。

# php - preg_match() 和 preg_replace() 慢吗？

> ID：14342427
> 
> 赞同：17
> 
> 时间：2013-01-15T16:39:13.293
> 
> 标签：php, regex, optimization, preg-replace, preg-match

我用 PHP 编码已经有一段时间了，我一直在读到你应该只在必须使用`preg_match`的`preg_replace`时候使用，因为它会降低性能。为什么是这样？`preg_matches`在一个文件中使用 20 而不是使用另一个 PHP 函数真的很糟糕吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-01-15T17:10:17.560

*正如 Mike Brant 在他的回答中所说：如果*需要，使用任何`preg_*`功能都没有错。 您想知道在一个文件中包含 20 个调用是否是个好主意，好吧，老实说：我会说这太多了。我经常说*“如果您对问题的解决方案在任何给定时间都依赖于 3 个以上的正则表达式，那么您就是问题的一部分”*。不过，我偶尔也会违背自己的咒语。 *`preg_match`*

 **如果您*使用*20`preg_match`次调用，则只需仔细查看实际的正则表达式，您就可以将这个数字减半。正则表达式，尤其是 Perl 正则表达式，非常强大，非常值得花时间去了解它们。它们趋于变慢的原因仅仅是*因为必须解析正则表达式，并将其“翻译”成相当数量的低级分支和循环。*`a`比如说，如果你想用大写字符替换所有小写字母，你可以使用正则表达式，当然，但在 PHP 中，这看起来像这样：

```
preg_replace('/a/','A',$string); 
```

查看表达式，第一个参数：它是作为参数传递的字符串。该字符串将被解析（解析时，检查分隔符，创建匹配字符串然后迭代字符串，将每个字符与模式进行比较（在这种情况下`a`），*如果*子字符串匹配，则将其替换。
看起来像有点麻烦，特别是考虑到最后一步（比较子字符串和替换匹配）是我们真正想要的。

```
$string = str_replace('a','A',$string); 
```

这样做，无需在解析和验证正则表达式时执行额外的检查。
不要忘记它`preg_match`也构造了一个匹配数组，构造一个数组也不是免费的。

简而言之：正则表达式的速度较慢，因为表达式被解析、验证并最终转换为一组简单的低级指令。

请注意，在某些情况下，人们使用`explode`and`implode`进行字符串操作。这也创建了一个 - 再次 - 不是免费的数组。考虑到您此后不久就会内爆相同的数组。也许另一种选择更可取（在某些情况下`preg_replace` *可以*更快）。
基本上：正则表达式需要额外的处理，简单的字符串函数不需要。但是当有疑问时，只有一种方法可以绝对确定：设置一个测试脚本......

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-01-15T16:56:44.257

除非遇到问题，否则不要担心优化。

不要在没有使用 XDebug (http://xdebug.org) 之类的工具进行测量的情况下寻找优化区域。

如果您的代码使用 preg_match() 运行需要 100 毫秒，而通过其他方法需要 110 毫秒，那么您真的关心差异吗？

先写正确和清晰，然后考虑速度。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-01-15T16:43:47.333

这实际上取决于您的用例。使用正则表达式本身并没有什么“坏处”。有时它是您对特定问题的唯一可用解决方案。但是，有时简单的字符串操作函数也可以正常工作。这些往往比`preg*`函数更快，因此，如果您遇到脚本运行非常频繁和/或要执行大量字符串操作的情况，则可以开始感受到使用正则表达式的影响。

与任何情况一样，您应该在您的应用程序和环境中进行测试并确定最适合您的方法。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2015-07-10T20:32:18.320

检查它需要多少时间（显示时间**STARTED**和**ENDED**）：

```
var_dump( microtime(true) );

//...............  your function executions here.............

var_dump( microtime(true) ); 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-01-15T16:44:55.067

取决于你在做什么。对于复杂的正则表达式，只需使用 preg_ 函数，如果您需要简单的替换或类似函数，请使用其他更具体的函数，如 str_replace()、strpos()、strstr()...

网络上到处都是讨论，比如[http://www.simplemachines.org/community/index.php?topic=175031.0](http://www.simplemachines.org/community/index.php?topic=175031.0)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2020-08-27T10:02:09.383

对于短字符串（例如小于几千字节），性能差异可以忽略不计。对于长字符串，例如超过 30-50 kB（通常是所见即所得的内容），性能差异变得更加显着，特别是对于贪婪的变体 - 例如`preg_match_all`。因此，对于长字符串，使用简单的字符串迭代/查找通常会更快，例如通过`str_pos()`提取或替换部分字符串，`substr()`然后只应用 preg_* 函数 - 对于提取的短字符串。**

# java - 是否有任何 MQ 服务器可以嵌入在 Java 进程中运行？

> ID：14342430
> 
> 赞同：24
> 
> 时间：2013-01-15T16:39:18.717
> 
> 标签：java, jms, message-queue, amqp, mq

我正在研究我团队的一个应用程序的排队解决方案。理想情况下，我们希望既可以配置为轻量级的进程内代理（用于线程之间的低吞吐量消息传递）也可以配置为外部代理。有没有可以做到这一点的 MQ 服务器？大多数似乎需要设置为外部实体。ZeroMQ 似乎最接近进程内解决方案，但它似乎更像是“类固醇上的 UDP 套接字”，我们需要可靠的交付。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-16T17:14:05.483

就像我们说的那样，它比嵌入式进程`ActiveMQ`要重一些，但它确实可以很好地工作。`ZeroMQ`这里有一个简单的例子`Spring`和`ActiveMQ`。

将用于测试队列的消息侦听器：

```
public class TestMessageListener implements MessageListener {

    private static final Logger logger = LoggerFactory.getLogger(TestMessageListener.class);

    @Override
    public void onMessage(Message message) {

        /* Receive the text message */
        if (message instanceof TextMessage) {

            try {
                String text = ((TextMessage) message).getText();
                System.out.println("Message reception from the JMS queue : " + text);

            } catch (JMSException e) {
                logger.error("Error : " + e.getMessage());
            }

        } else {
            /* Handle non text message */
        }
    }
} 
```

`ActiveMQ`上下文配置：

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.springframework.org/schema/beans
                        http://www.springframework.org/schema/beans/spring-beans.xsd">

    <bean id="jmsQueueConnectionFactory" class="org.apache.activemq.spring.ActiveMQConnectionFactory">
        <property name="brokerURL">
            <value>tcp://localhost:61617</value>
        </property>
    </bean>

    <bean id="pooledJmsQueueConnectionFactory" class="org.apache.activemq.pool.PooledConnectionFactory" destroy-method="stop">
        <constructor-arg ref="jmsQueueConnectionFactory" />
    </bean>

    <bean id="queueDestination" class="org.apache.activemq.command.ActiveMQQueue">
        <constructor-arg value="messageQueue" />
    </bean>

    <bean id="jmsQueueTemplate" class="org.springframework.jms.core.JmsTemplate">
       <constructor-arg ref="pooledJmsQueueConnectionFactory" />
       <property name="pubSubDomain" value="false"/>
    </bean>

    <bean id="testMessageListener" class="com.example.jms.TestMessageListener" />

    <bean id="messageQueuelistenerContainer" class="org.springframework.jms.listener.DefaultMessageListenerContainer">
        <property name="connectionFactory" ref="pooledJmsQueueConnectionFactory" />
        <property name="destination" ref="QueueDestination" />
        <property name="messageListener" ref="testMessageListener" />
        <property name="concurrentConsumers" value="5" />
        <property name="acceptMessagesWhileStopping" value="false" />
        <property name="recoveryInterval" value="10000" />
        <property name="cacheLevelName" value="CACHE_CONSUMER" /> 
    </bean>

</beans> 
```

测试`JUnit`：

```
@ContextConfiguration(locations = {"classpath:/activeMQ-context.xml"})
public class SpringActiveMQTest extends AbstractJUnit4SpringContextTests {

    @Autowired
    private JmsTemplate template;

    @Autowired
    private ActiveMQDestination destination;

    @Test
    public void testJMSFactory() {
        /* sending a message */
        template.convertAndSend(destination, "Hi");

        /* receiving a message */
        Object msg = template.receive(destination);
        if (msg instanceof TextMessage) {
            try {
                System.out.println(((TextMessage) msg).getText());
            } catch (JMSException e) {
                System.out.println("Error : " + e.getMessage());
            }
        }
    }
} 
```

要添加到的依赖项`pom.xml`：

```
<!-- Spring -->
<dependency>
    <groupId>org.springframework</groupId>
    <artifactId>spring-jms</artifactId>
    <version>${org.springframework-version}</version>
</dependency>

<!-- ActiveMQ -->
<dependency>
    <groupId>org.apache.activemq</groupId>
    <artifactId>activemq-all</artifactId>
    <version>5.6.0</version>
    <scope>compile</scope>
</dependency>

<dependency>
    <groupId>org.apache.activemq</groupId>
    <artifactId>activemq-pool</artifactId>
    <version>5.6.0</version>
</dependency>

<dependency>
    <groupId>org.apache.activemq</groupId>
    <artifactId>activemq-core</artifactId>
    <version>5.6.0</version>
</dependency> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T17:02:19.793

WebSphere MQ 客户端具有执行[多播 pub/sub](http://pic.dhe.ibm.com/infocenter/wmqv7/v7r5/topic/com.ibm.mq.doc/ps30001_.htm)的能力。这提供了绕过队列管理器的客户端到客户端功能，尽管需要队列管理器来建立连接。

# jquery - 当有人在 jQuery 中调用 text() 或 html() 时是否可以获取事件？

> ID：14342433
> 
> 赞同：2
> 
> 时间：2013-01-15T16:39:30.033
> 
> 标签：jquery, events

我需要知道 DOM 节点的内容何时发生变化。幸运的是，我可以确定所有这些更改都将通过调用`.text(val)`or来实现`.html(val)`。

调用这两个函数时，是否可以让 jQuery 发送事件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T16:48:11.357

如果你真的需要做到这一点，你可以考虑给jQuery打[猴子补丁。](http://paulirish.com/2010/duck-punching-with-jquery/)基本要点已**编辑 - 取自参考链接**：

```
(function($){
   // store original reference to the method
   var _old = $.fn.text;

   $.fn.text = function(text){
      // modifications go here       
      return _old.apply(this,arguments);
   };
})(jQuery); 
```

它非常笨拙，所以我只会在它是获得所需内容的唯一方法时才考虑它，并且您必须非常小心 jQuery API 更改。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-15T16:49:00.590

您可以扩展 jQuery 函数`text()`和`html()`. 我在某个地方找到了这个（对不起，我没有来源，如果你知道谁应该为此归功于它，请有人编辑），它对我来说就像一个魅力

```
(function ($) {
    var originalHtmlFunction = $.fn.html;
    $.fn.html = function (value) {
        if (typeof value != 'undefined') {
                var jqObj = originalHtmlFunction.call(this, value);
                // Do your magic here
                return jqObj;
        }
        else {
            return originalHtmlFunction.call(this, value);
        }
    };

    var originalTextFunction = $.fn.text;
    $.fn.text = function (value) {
        if (typeof value != 'undefined') {
                var jqObj = originalTextFunction.call(this, value);
                // Do your magic here
                return jqObj;
        }
        else {
            return originalTextFunction.call(this,value);
        }
    };

})(jQuery); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-15T16:49:23.743

**[jsFiddle 演示](http://jsfiddle.net/TXMZT/6/)**

您可以像这样重载`.text()`（或任何 jQuery 方法），并将已更改的任何内容保存在我们可以创建的日志记录**类中。**这是下面的基本课程。

```
var textLogger = new (function textChangeLog () {  
  this.logArray = [];

  this.add = function (item) {
    this.logArray.push(item);
  };

  this.displayLog = function (index) {
    if (typeof index === 'number') { console.log( this.logArray[index] ); }
    else { console.log( this.logArray ); }
  };
})(); 
```

现在我们覆盖当前`.text()`并添加我们的一些添加。**日志记录类**和回调函数（如果您想要更多功能）

```
$.fn.oldText = $.fn.text; 
// ** NOTE: At any point you can just use $('body').oldText('change it');
// to by pass any of the below changes / overrides to .text()

$.fn.text = function (str, funcEvent) {
  try {
    // Let's log anything that's being changed in our textLogger class Array
    textLogger.add($(this));

    // call the original .text()
    $(this).oldText(str); 

    // the optional event you passed in
    var callbackFunc = typeof funcEvent !== 'undefined' ? funcEvent : function () { };
    callbackFunc(); 
  }
  catch(e) { console.log(e); }
}; 
```

现在我们做一些示例用法，然后我们执行**textLogger.displayLog()**以在控制台中查看我们的结果。你会在一个数组中看到整个 jQuery 选择器/上下文/ID。

```
$('div').text('here');
$('#anotherExample').text('we changed this too!');

textLogger.displayLog();

$('#cbTest').text('blah', function () { console.log('callback!'); }); 
```

**编辑**更新了 jsFiddle 以显示如何在文本更改时触发/响应自定义事件。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-01-15T16:49:55.583

是的，这是可能的，但取决于您如何使用所述方法，它可能效率不高。

```
$.each(["text","html"], function(i,method) {
    var oldMethod = $.fn[method];
    $.fn[method] = function(){
        this.trigger(method+"change");
        oldMethod.apply(this,arguments);
    };
});

// sample usage:
$("#someelement").on("textchange",function(){
    alert("Text Change!");
}).text("Foobar"); 
```

[http://jsfiddle.net/CZCKq/](http://jsfiddle.net/CZCKq/)

# android - 创建透明的传递活动

> ID：14342436
> 
> 赞同：-1
> 
> 时间：2013-01-15T16:39:38.123
> 
> 标签：android, layout-inflater

我找到[了这个](https://stackoverflow.com/questions/10095344/how-to-create-always-top-fullscreen-overlay-activity-in-android)。所以，远没有运气。我使用了他的代码，但我无法克服这个错误。我不熟悉充气机。那么有人可以解释这段代码吗？

```
final WindowManager.LayoutParams params = new WindowManager.LayoutParams(
            WindowManager.LayoutParams.FLAG_FULLSCREEN,
            WindowManager.LayoutParams.FLAG_FULLSCREEN,
            WindowManager.LayoutParams.TYPE_SYSTEM_ALERT,
            WindowManager.LayoutParams.FLAG_LAYOUT_IN_SCREEN,
            PixelFormat.TRANSLUCENT);

    WindowManager wm = (WindowManager) getApplicationContext()
            .getSystemService(Context.WINDOW_SERVICE);
    LayoutInflater inflater = (LayoutInflater) getSystemService(Context.LAYOUT_INFLATER_SERVICE);
    ViewGroup mTopView = (ViewGroup) getApplicationContext()
            .getLayoutInflater().inflate(R.layout.activity_invisible, null);
    getWindow().setAttributes(params);
    wm.addView(mTopView, params); 
```

这部分代码：

```
ViewGroup mTopView = (ViewGroup) getApplicationContext()
            .getLayoutInflater().inflate(R.layout.activity_invisible, null); 
```

给我这个错误`The method getLayoutInflater() is undefined for the type Context`

有人可以解释我做错了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T16:43:00.560

[getLayoutInflater()](http://developer.android.com/reference/android/app/Activity.html#getLayoutInflater%28%29)是[Activity](http://developer.android.com/reference/android/app/Activity.html)中的方法，而不是[Context](http://developer.android.com/reference/android/content/Context.html)。

您必须使用 Activity 的实例来调用它，否则它将无法工作。

但是，您可能可以`inflater`在出现错误的行之前使用您创建的 LayoutInflater。就像是：

```
ViewGroup mTopView = (ViewGroup) inflater.inflate(R.layout.activity_invisible, null); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T16:47:05.237

如果您尝试在内部执行此代码`onCreate()`，而不是

```
ViewGroup mTopView = (ViewGroup) getApplicationContext().getLayoutInflater().inflate(R.layout.activity_invisible, null); 
```

尝试

```
ViewGroup mTopView = (ViewGroup) getLayoutInflater().inflate(R.layout.activity_invisible, null); 
```

您的活动具有该`getLayoutInflater()`方法，因此无需显式获取上下文。

# matlab - 按某个字符串值过滤元胞数组

> ID：14342438
> 
> 赞同：2
> 
> 时间：2013-01-15T16:39:40.380
> 
> 标签：matlab

我有一个单元格数组，如下所示：

```
A = 

    '5523'    '2012-10-26'    '23'    'T'    '17.7'
    '5513'    '2012-10-26'    '23'    'T'    '22.1'
    '5506'    '2012-10-26'    '23'    'C'    '16.2' 
```

现在我想过滤所有具有`T`. 所以我想得到这个数组：

```
A = 

    '5523'    '2012-10-26'    '23'    'T'    '17.7'
    '5513'    '2012-10-26'    '23'    'T'    '22.1' 
```

我可以解析所有数组，但是还有其他方法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-15T16:45:20.880

这是一个单行代码：

```
A = A(strcmp(A(:,4), 'T'), :); 
```

内部，`strcmp(A(:,4), 'T')`，将所有行的第 4 列与 进行比较`'T'`。`A`然后，该布尔向量可以使用逻辑索引从中提取匹配的行。

# macos - GPU 负载下 CGEventPost 的性能较弱

> ID：14342444
> 
> 赞同：52
> 
> 时间：2013-01-15T16:40:02.130
> 
> 标签：macos, core-graphics, mouseevent, quartz-graphics

我们偶然发现了 Quartz Events 的性能问题，更具体地说是 CGEventPost：在 GPU 负载过重时，CGEventPost 可能会阻塞。我们创建[了一个小型基准测试应用程序来演示该问题](http://smoothmouse.com/storage/EventPerformance.zip)。这个应用程序只是一个创建、发布和发布事件的循环。

您可以在下面看到运行应用程序的结果。第一次运行是在空闲系统上。第二次运行是使用 FurMark（GPU 压力测试），表盘尽可能地向上转动。

*   Inner 是内部循环需要多长时间，基本上只是使用 Quartz Events 创建、发布和发布事件。
*   外部是我们的程序等待被唤醒的时间（睡眠）。应该接近我们睡觉的时间，但如果系统处于压力之下，它可能会延迟。
*   Post 是事件发布所需的时间。

```
18:58:01.683 EventPerformance[4946:707] Measurements: (outer should be close to 10)
18:58:01.684 EventPerformance[4946:707] inner (ms): 0.04, outer (ms): 11.02, CGEventPost (ms): 0.03
18:58:01.684 EventPerformance[4946:707] inner (ms): 0.04, outer (ms): 11.02, CGEventPost (ms): 0.03
18:58:01.685 EventPerformance[4946:707] inner (ms): 0.07, outer (ms): 10.26, CGEventPost (ms): 0.03
18:58:01.685 EventPerformance[4946:707] inner (ms): 0.06, outer (ms): 10.85, CGEventPost (ms): 0.05
18:58:01.686 EventPerformance[4946:707] inner (ms): 0.07, outer (ms): 10.41, CGEventPost (ms): 0.04
18:58:01.686 EventPerformance[4946:707] inner (ms): 0.04, outer (ms): 10.39, CGEventPost (ms): 0.03
18:58:01.686 EventPerformance[4946:707] inner (ms): 0.05, outer (ms): 11.02, CGEventPost (ms): 0.03
18:58:01.687 EventPerformance[4946:707] inner (ms): 0.03, outer (ms): 10.67, CGEventPost (ms): 0.03
18:58:01.687 EventPerformance[4946:707] inner (ms): 0.08, outer (ms): 10.09, CGEventPost (ms): 0.05
18:58:01.688 EventPerformance[4946:707] Averages: (outer should be close to 10)
18:58:01.688 EventPerformance[4946:707] avg inner (ms): 0.05, avg outer (ms): 10.64, avg post (ms): 0.03 
```

在这里，我们可以看到发布事件平均需要大约 0.03 毫秒。此外，线程似乎在 0.5 毫秒左右被唤醒为时已晚。CGEventPost 中没有峰值。

```
19:02:02.150 EventPerformance[5241:707] Measurements: (outer should be close to 10)
19:02:02.151 EventPerformance[5241:707] inner (ms): 0.03, outer (ms): 10.23, CGEventPost (ms): 0.02
19:02:02.151 EventPerformance[5241:707] inner (ms): 0.02, outer (ms): 10.54, CGEventPost (ms): 0.02
19:02:02.151 EventPerformance[5241:707] inner (ms): 0.02, outer (ms): 11.01, CGEventPost (ms): 0.01
19:02:02.152 EventPerformance[5241:707] inner (ms): 0.02, outer (ms): 10.74, CGEventPost (ms): 0.01
19:02:02.152 EventPerformance[5241:707] inner (ms): 0.02, outer (ms): 10.20, CGEventPost (ms): 0.01
19:02:02.152 EventPerformance[5241:707] inner (ms): 10.35, outer (ms): 11.01, CGEventPost (ms): 10.35
19:02:02.152 EventPerformance[5241:707] inner (ms): 0.03, outer (ms): 10.02, CGEventPost (ms): 0.02
19:02:02.153 EventPerformance[5241:707] inner (ms): 58.90, outer (ms): 10.11, CGEventPost (ms): 58.90
19:02:02.153 EventPerformance[5241:707] inner (ms): 0.03, outer (ms): 10.12, CGEventPost (ms): 0.02
19:02:02.153 EventPerformance[5241:707] Averages: (outer should be close to 10)
19:02:02.371 EventPerformance[5241:707] avg inner (ms): 7.71, avg outer (ms): 10.44, avg post (ms): 7.71 
```

当系统处于繁重的 GPU 负载下时，发布事件可能需要（峰值）毫秒而不是微秒。在极端 GPU 压力下 (< 1 FPS)，此值可能需要几秒钟。CGEventPost*有时* 似乎在等待 GPU 完成一些工作后再返回。我们的线程仍然正常调度，没有明显的延迟/尖峰（外部）。

任何想法表示赞赏。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-19T23:16:34.437

我猜你正在填满队列（底层马赫端口）......

您可以使用 Instruments 中的“调度”或“系统调用”工具来确认这一点。（创建一个新的空白文档，添加仪器，然后`File > Record Options...`确保选中“延迟模式”。）这将显示应用程序中的所有线程活动（线程何时阻塞、何时休眠、何时激活以及原因）。

我会首先尝试提高`man 3 PTHREAD_SCHEDPARAM`线程调用的线程优先级（参见）`CGEventPost`。如果您的线程在较低优先级的线程上被阻塞，内核应该暂时提升阻塞线程的优先级以避免优先级倒置并帮助您的任务更早完成。

总的来说，我认为你将不得不实现一个**2-thread 解决方案**，如下所示：

为要发布的事件创建队列。从您的主线程（或事件发布线程）将事件发布到此队列，然后向第二个线程（您创建的事件使用者线程）发出信号以遍历队列并使用`CGEventPost`.

当`CGEventPost`阻塞时，您的第二个事件发布线程将阻塞，但这不会阻塞任何其他线程。当`CGEventPost`最终解除阻塞时，它将消耗您的事件消费者线程发布的任何未完成的事件，并且事件消费者线程可以恢复发布事件。

另一种可能性：你能合并事件吗？您可以将某些类型的事件（鼠标移动？）合并成更少的事件。您有时可能仍会遇到队列限制`CGEventPost`，我认为 2 线程方法可能是您最好的选择。

# ruby-on-rails-3 - 在 Rails 中生成嵌套对象列表

> ID：14342445
> 
> 赞同：-1
> 
> 时间：2013-01-15T16:40:06.950
> 
> 标签：ruby-on-rails-3, activerecord, nested-lists

嗨，我一直在尝试弄清楚如何在 Rails 中创建列表时遇到问题。我的问题是我有一个 Team 对象，然后我有一个包含主队和客队的夹具对象，我希望能够自动生成夹具，例如我有 20 支球队，所以每支球队有 38 场比赛，他们需要在每支球队主场比赛并且，我怎样才能创建一个夹具列表来满足这些要求，或者在 Rails 中是否有可能。通过让每支球队在主场让每个人都在主场比赛，这也将创造出所有的客场比赛。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T17:21:42.263

Ruby Array 有一个方法`combination`可以完成这项工作。[http://www.ruby-doc.org/core-1.9.3/Array.html#method-i-combination](http://www.ruby-doc.org/core-1.9.3/Array.html#method-i-combination)

就像是

```
teams = Team.all.to_a # or any selection of teams
teams.combination(2) do |first_team, second_team|
  Fixture.create!(hometeam: first_team, awayteam: second_team)
  Fixture.create!(hometeam: second_team, awayteam: first_team)
end 
```

将为 20 支球队创造所有 380 场比赛。

# objective-c - DataModel.m 看不到名称的属性声明：为什么？

> ID：14342451
> 
> 赞同：0
> 
> 时间：2013-01-15T16:40:41.093
> 
> 标签：objective-c, xcode4.5

我从我的 Xcode 4.5.2 编译器收到一条消息：

```
Property 'name' not found for object of type 'Checklist' 
```

在 DataModel.m 的这行代码上：

```
Checklist.name = @"List"; 
```

问题是已经在 Checklist.h 中进行了属性声明，而 Checklist.h 已导入 DataModel.m。那么为什么会发生这个错误呢？

清单.m

```
#import <Foundation/Foundation.h>

@interface ChecklistItem : NSObject <NSCoding>

@property (nonatomic, copy) NSString *text;
@property (nonatomic, assign) BOOL checked;

- (void) toggleChecked;

@end 
```

这是 DataModel.m 文件：

```
#import "DataModel.h"
#import "Checklist.h"

@implementation DataModel

- (NSString *)documentsDirectory
{
    NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
    NSString *documentsDirectory = [paths objectAtIndex:0];
    return documentsDirectory;
}

- (NSString *)dataFilePath
{
    return [[self documentsDirectory] stringByAppendingPathComponent:@"Checklists.plist"];
}

- (void)saveChecklists
{
    NSMutableData *data = [[NSMutableData alloc] init];
    NSKeyedArchiver *archiver = [[NSKeyedArchiver alloc] initForWritingWithMutableData:data];
    [archiver encodeObject:self.lists forKey:@"Checklists"];
    [archiver finishEncoding];
    [data writeToFile:[self dataFilePath] atomically:YES];
}

- (void)loadChecklists
{
    NSString *path = [self dataFilePath];
    if ([[NSFileManager defaultManager] fileExistsAtPath:path])
    {
        NSData *data = [[NSData alloc] initWithContentsOfFile:path];
        NSKeyedUnarchiver *unarchiver = [[NSKeyedUnarchiver alloc] initForReadingWithData:data];
        self.lists = [unarchiver decodeObjectForKey:@"Checklists"];
        [unarchiver finishDecoding];
    }
    else
    {
        self.lists = [[NSMutableArray alloc] initWithCapacity:20];
    }
}

- (void)registerDefaults
{
    NSDictionary *dictionary = [NSDictionary dictionaryWithObjectsAndKeys:
                                [NSNumber numberWithInt:-1], @"ChecklistIndex",
                                [NSNumber numberWithBool:YES], @"FirstTime",
                                nil];

    [[NSUserDefaults standardUserDefaults]registerDefaults:dictionary];
}

- (void)handleFirstTime
{
    BOOL firstTime = [[NSUserDefaults standardUserDefaults] boolForKey:@"FirstTime"];
    if(firstTime) {
        Checklist *checklist = [[Checklist alloc] init];
        Checklist.name = @"List"; // error message appears here
        [self.lists addObject:checklist];
        [self setIndexOfSelectedChecklist:0];
        [[NSUserDefaults standardUserDefaults] setBool:NO forKey:@"FirstTime"];

    }
}

- (id)init
{
    if((self = [super init])) {
        [self loadChecklists];
        [self registerDefaults];
        [self handleFirstTime];
    }
    return self;
}

- (int)indexOfSelectedChecklist
{
    return [[NSUserDefaults standardUserDefaults]integerForKey:@"ChecklistIndex"];
}

- (void)setIndexOfSelectedChecklist
{
    [[NSUserDefaults standardUserDefaults]setInteger:index forKey:@"ChecklistIndex"]; 
}

@end 
```

Checklist.h（已更正）

```
#import <Foundation/Foundation.h>

@interface Checklist : NSObject<NSCoding>

@property (nonatomic, copy) NSString *name;
@property (nonatomic, strong) NSMutableArray *items;

@end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T20:15:46.893

```
Checklist *checklist = [[Checklist alloc] init]; 
```

在这里，您创建了一个类的对象`Checklist`并将其分配给变量`checklist`。

```
Checklist.name = @"List"; // error message appears here 
```

在这里，您使用`Checklist`（类）而不是`checklist`（实例）。

该行应为

```
checklist.name = @"List"; // error message goes away! 
```

# javascript - javascript验证多个收音机选择

> ID：14342452
> 
> 赞同：0
> 
> 时间：2013-01-15T16:40:44.470
> 
> 标签：javascript, html

我意识到这不是一个新话题，而且以前有人问过。我已经阅读了各种答案，虽然我在 Javascript 方面越来越好，但对大多数回复感到困惑。

我要求我的用户给出评分，他们对类别和公司进行评分。我希望 Javascript 验证两组单选按钮是否都标记了答案，如果可能的话，根据未标记的选项发出单独的警报。

我的代码（省略了它们所在的表）

```
<form action="blah.php" method="post" onsubmit="return validaterating()"
name="ratings">

<input type="radio" name="categoryrate" value="5">
<input type="radio" name="categoryrate" value="4">
<input type="radio" name="categoryrate" value="3">
<input type="radio" name="categoryrate" value="2">
<input type="radio" name="categoryrate" value="1">

<input type="radio" name="companyrate" value="5">
<input type="radio" name="companyrate" value="4">
<input type="radio" name="companyrate" value="3">
<input type="radio" name="companyrate" value="2">
<input type="radio" name="companyrate" value="1">

</form> 
```

Javascript：

```
function validaterating() {

var rate1 = document.forms.ratings.categoryrate;
var rate2 = document.forms.ratings.companyrate;

function validaterating() {
for (var i=0; i < rate1.length; i++) {
if (rate1[i].checked)
return true;
}
alert("Please rate the category.");
return false;
} 
```

现在，我知道这可以验证我拥有的第一个评级，并且是我认为对我最有意义的验证设置。但是，我无法验证第二个问题（rate2）。我尝试了另一个 for 循环，使用 && 运算符，当我尝试让第二个进行验证时它停止工作。使用我正在编写的代码，这怎么可能？

谢谢你的时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T17:07:25.383

## [http://jsfiddle.net/R5M5Y/](http://jsfiddle.net/R5M5Y/)

HTML

```
<form onsubmit="return test();" action="blah.php" method="post" name="ratings">
category:
<input type="radio" name="categoryrate" value="5">
<input type="radio" name="categoryrate" value="4">
<input type="radio" name="categoryrate" value="3">
<input type="radio" name="categoryrate" value="2">
<input type="radio" name="categoryrate" value="1">
company:
<input type="radio" name="companyrate" value="5">
<input type="radio" name="companyrate" value="4">
<input type="radio" name="companyrate" value="3">
<input type="radio" name="companyrate" value="2">
<input type="radio" name="companyrate" value="1">
    <input type='submit' />
</form> 
```

JavaScript

```
function test(){
  var category = document.getElementsByName("categoryrate");
  var check1 = 0;
  for(i=0;i<category.length;i++){
    if(category[i].checked){
      check1++;
      break;
    }
  }
  var company = document.getElementsByName("companyrate");
  var check2 = 0;
  for(i=0;i<company.length;i++){
    if(company[i].checked){
      check2++;
      break;
    }
  }
  if(check1 && check2){
  }else{
    alert("you must select ratings for both company and category");
    return false;
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T16:49:04.453

这就是用于验证两组单选按钮的所有 JavaScript 吗？首先，您有两个函数，都具有相同的名称（验证）。其次，您忘记在末尾添加右括号以关闭包装函数。

您应该做的是设置两个变量，它们都用作布尔标志。然后循环遍历每组单选按钮以确定是否已选择按钮。如果是，则将相应的标志设置为 true，否则设置为 false。然后在最后，测试两个标志是否都设置为真。如果没有，请发出警报。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T16:59:15.863

> 功能验证（）{
> 
> var rate1 = document.forms.ratings.categoryrate; var rate2 = document.forms.ratings.companyrate；
> 
> 函数 validaterating() { for (var i=0; i < rate1.length; i++) { if (rate1[i].checked) return true; } alert("请给分类评分。"); 返回假；}

此代码有许多语法错误。我不确定为什么有两个验证评级功能。我现在假设您将它们复制错误并且您的代码确实有效。

这里的问题是你在 rate1 中找到一个后返回 true。如果您之后有任何代码验证 rate2 ，它将不会被命中，因为该函数已经返回。

一种解决方案可能是创建两个布尔变量 categoryChecked、companyChecked，并将它们初始化为 false。然后，循环遍历每个 i 的 document.forms.rating.categoryrate[i].checked，如果其中任何一个为真，则设置 categoryChecked = true。对 companyChecked 执行相同的操作。

然后，完成

```
return categoryChecked && companyChecked 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-15T17:11:16.217

你可以这样做：

```
function validaterating() {
 return validateGroup(document.getElementsByName("categoryrate")) && validateGroup(document.getElementsByName("companyrate"))
}

function validateGroup(elements) {
 for (var i = 0; i < elements.length; i++) {
  if (elements[i].checked) return true;
 }
return false;
} 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2017-10-23T16:20:09.597

```
function validateForm() {

var radios = document.getElementsByTagName('input');
var value;
var sum_radio=0;
var formValid=0;

for (var c = 0; c < radios.length; c++){

 if (radios[c].type =='radio'){
 sum_radio = sum_radio + 1;
 }
}

alert('count radio'+sum_radio);

for (var i = 0; i < radios.length; i++) {

    if (radios[i].type == 'radio' && radios[i].checked) {
        // get value, set checked flag or do whatever you need to
        value = radios[i].value; 
       // alert('value'+value);

      alert('good'+formValid);
      formValid = formValid + 1;

    }

}

if (formValid==sum_radio){
alert('yes');
return true;
}else{
alert('no');
return false
}

}
```

```
<form name="form1" action="#" onsubmit="return validateForm()" method="post"> 
    First time visitor?:<br/>
            <label for="s1">Yes</label>
            <input type="radio" id="radio0" name="yesno" value="1"/>
            <br/>
            <label for="s2">No</label>
            <input type="radio" id="radio1" name="yesno1" value="2"/>
            <br/>
            <label for="s2">No</label>
            <input type="radio" id="radio2" name="yesno2" value="2"/>

<br/>
            <label for="s2">No</label>
            <input type="radio" id="radio3" name="yesno3" value="2"/>
            <br/>       

 <label for="s2">No</label>
            <input type="radio" id="radio4" name="yesno4" value="2"/>
            <br/>     
<label for="s2">No</label>
            <input type="radio" id="radio5" name="yesno5" value="2"/>
            <br/>     

    <input type="submit" value="Submit"><br/>
    </form>
```

# workflow-foundation-4 - 为内容关联定义 XPath 查询

> ID：14342457
> 
> 赞同：3
> 
> 时间：2013-01-15T16:41:15.250
> 
> 标签：workflow-foundation-4

似乎网络上还有其他帖子提出了同样的问题，但要么他们没有完全解决这个问题，要么我遗漏了一些东西（很可能是后者）。

在为 XAMLX 服务的内容关联定义 XPath 查询时，我对命名空间前缀的来源感到困惑。例如，在查询“sm:body()/xg0:Id”中，“sm”和“xg0”是从哪里来的。我假设这些是在某处指定的，但我不确定在哪里。如果我理解正确，则与消息合同一起使用时生成查询不起作用。在某种程度上，我同意这一点。如果我将“xg0”的前缀更改为“tempuri”，我可以让它在基本情况下工作，但不是在所有情况下。是否有文档准确解释此查询的工作原理？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T20:00:49.210

命名空间前缀存储在 XAMLX 文件中。不幸的是，没有显示值的 UI，您必须开始挖掘 XAMLX 源。请参阅下面的 XPathMessageQuery.Namespaces 部分，其中`xgSc`定义为`http://tempuri.org/`

```
<Receive x:Name="__ReferenceID0" CanCreateInstance="True" DisplayName="ReceiveRequest" sap:VirtualizedContainerService.HintSize="255,86" OperationName="GetData" ServiceContractName="p:IService">
  <Receive.CorrelationInitializers>
    <RequestReplyCorrelationInitializer CorrelationHandle="[handle]" />
    <QueryCorrelationInitializer>
      <XPathMessageQuery x:Key="key1">
        <XPathMessageQuery.Namespaces>
          <ssx:XPathMessageContextMarkup>
            <x:String x:Key="xgSc">http://tempuri.org/</x:String>
          </ssx:XPathMessageContextMarkup>
        </XPathMessageQuery.Namespaces>sm:body()/xgSc:GetData/xgSc:orderId</XPathMessageQuery>
    </QueryCorrelationInitializer>
  </Receive.CorrelationInitializers>
  <ReceiveParametersContent>
    <p1:OutArgument x:TypeArguments="x:String" x:Key="orderId" />
  </ReceiveParametersContent>
</Receive> 
```

# debugging - 为什么 Coldfusion 偶尔会抛出错误？

> ID：14342458
> 
> 赞同：-6
> 
> 时间：2013-01-15T16:41:20.293
> 
> 标签：debugging, coldfusion, coldfusion-10

例如，我有一个页面。我可以加载此页面 100 次而不会出错。但是，有时有人会收到错误消息，因为我在 onError 方法中收到了从 ColdFusion 发送的电子邮件。我得到的不多，但我得到的比我想象的要多。“调试”是不可能的，因为它不会一直发生。一天一次，可能在给定的页面上。

有没有人见过类似的东西。

一个例子：

```
if((StructKeyExists(ARGUMENTS.itm, 'video_code') && len(trim(ARGUMENTS.itm.video_code)) || !StructKeyExists(ARGUMENTS.itm, 'video_code')) == 0) return '<a #class# #target# #linkid# #pageid# href="#url#">#title##fileext#</a>';
    else return '<a class="youtube_video" #target# #linkid# href="http://www.youtube.com/v/#itm.video_code#?version=3&autoplay=1&rel=0&modestbranding=1">#title#</a>'; 
```

在此页面请求中，项目结构中有 video_code。但是当处理第二行时 video_code 是未定义的。我可以再运行页面 100 次，但这不会发生。

```
objectType  class coldfusion.runtime.Struct
element VIDEO_CODE
Resolvedname    ITM
Detail  
ErrNumber   0
Message Element VIDEO_CODE is undefined in ITM.
Type    Expression
Trace:  Template    Line
D:\www\websites\assets\cfcs\menu.cfc    240
D:\www\websites\assets\cfcs\menu.cfc    209
D:\www\websites\assets\cfcs\menu.cfc    15
D:\www\websites\assets\templates\distance_general\campus_index_page.cfm 120
D:\www\websites\domain.com\index.cfm    1 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-15T17:44:10.970

这是您的代码中的错误。

这是当有人提出像您这样的问题时的标准自动响应，因为*几乎总是*如此。

当然，您有可能发现了 ColdFusion 中的缺陷，但在已建立的产品中发现错误的几率 *明显*低于在特定代码/配置中发现错误的几率。

鉴于作为示例提供的复杂代码，它可能是您代码中的错误的可能性非常高。

> 编程语言有时会错误解析或类似的东西。

简单地说，没有。不存在会使解析器行为不同的解析级构造，并且解析完成一次​​，然后使用相同的编译代码（直到清除或重新启动服务器）。

> 为什么这不会失败 100 次并失败一次？

再次查看该示例，这很可能是一个范围问题——您正在检查 StructKeyExists，`ARGUMENTS.itm`但随后只是`itm`在代码中使用。**ColdFusion 存在与非作用域变量有关的线程问题，这些问题在负载过重时会显现出来。**

使用[varscoper](http://varscoper.riaforge.org)检查未作用域的变量。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-15T18:10:28.973

这是您代码中的实际错误。`if`条件是：

```
(StructKeyExists(ARGUMENTS.itm, 'video_code') && len(trim(ARGUMENTS.itm.video_code)) || !StructKeyExists(ARGUMENTS.itm, 'video_code')) == 0 
```

这意味着`else`条件是：

```
(StructKeyExists(ARGUMENTS.itm, 'video_code') && len(trim(ARGUMENTS.itm.video_code)) || !StructKeyExists(ARGUMENTS.itm, 'video_code')) 
```

因此该`else`子句将在`ARGUMENTS.itm.video_code`存在且不为空**或**不存在时执行。在后一种情况下，`itm.video_code`第二行的引用将失败。

我无法解释为什么错误会间歇性发生。我认为您需要查看不同的调用者，以了解为什么有时该论点不存在。

# c++ - C++ 变量参数

> ID：14342462
> 
> 赞同：3
> 
> 时间：2013-01-15T16:41:33.723
> 
> 标签：c++, function, templates, variadic

我有一个带有状态机的类，并且希望有一个单一的入口点来将事件传递给状态机。该事件伴随着特定于事件的数据，然后我想将其分派给处理程序。所以它看起来像这样......

```
class X
{
  public:
    ...
    template<typename... A> void fsm(eEvent eventId, const A&... eventData);

  private:
    ...
    void eventA(int a, double b);
    void eventB(std::string a);
    void eventC(unsigned long a); 
```

};

...使用看起来像这样的调用...

```
X x;

x.fsm(eEventA, -1, 2.0);
x.fsm(eEventB, "xyz");
x.fsm(eEventC, 42); 
```

我无法弄清楚如何让模板函数调用正确的处理程序。如果我只是打开 eventId 并传递变量参数，它将无法编译，因为所有参数组合都不存在处理程序（例如，没有 eventA() 处理程序接受 eventB() 参数，我不会无论如何都想要）。

我的猜测是有一些优雅的方法可以做到这一点，但它让我望而却步。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-15T16:52:32.147

# 选项 1\. 抛弃可变参数

如果您没有 C++11 模板参数包，自然的选择是为每个事件声明一个类型，从基本事件类型继承，然后将其打包`eventData`。这就是我推荐的。您可以使用动态类型来验证是否发送了正确的内容，如果这会减慢速度，请禁用生产模式下的检查。

# 选项 2\. PTMF

使用指向成员函数的指针向调度程序标识事件。这消除了枚举的需要，并将调度的类型直接编码到模板化调度程序中。

但是，这确实要求分派的函数是`public`.

```
template<typename... P, typename... A> void fsm(void (X::*event)( P ... ),
    const A&... eventData) {
    this->*event( eventData ... );
}

x.fsm( &X::eventB, 5, 1.3 ); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T04:59:14.083

如果 eEvent 是类似整数的并且在编译时总是已知的，那么您可以对其进行模板化。然后你的调用看起来像

```
x.fsm<eEventA>(1, 2.4); 
```

由于对专门功能模板的限制，它可能会变得更复杂一些。此外，您可能需要一个泛型，这意味着错误的参数包将是运行时错误（但很明显）。

我不确定这实际上有什么优势

```
x.onEventA(1, 2.4); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T17:06:36.880

没有办法*通过保持相同的设计*来做你想做的事（即基于运行时计算的整数值调度的事件）。的值`eventId`仅在运行时知道并确定要调用的函数的签名，但参数的*类型*必须在编译时知道。**直接或间接地**，您的函数必须如下所示：

```
if (eventId == eEventA) { eventA(eventData...); }
else if (eventId == eEventB) { eventB(eventData...); }
... 
```

但这**永远不会 compile**，因为编译器会解析*每个*分支，`if`并且肯定会找到一些`eventX`与其签名不兼容的调用。

我建议你一**开始不要使用这种设计**，而是采用类似于 Boost.Signal 的方法来处理事件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-15T19:19:24.190

我不确定我是否完全理解您要做什么，但是像这种模板专业化这样的东西会起作用吗？

```
#include <iostream>

// ----------------------------------
class EventA
{
public:
    int a;
    double b;
};

class EventB
{
public:
    std::string strEvent;
};

class EventC
{
public:
    unsigned long a;
};

// -------------------------
class X
{
public:
    template<typename EVENT_TYPE> void fsm (const EVENT_TYPE &eventData);

public:
    void eventA (int a, double b) {}
    void eventB (std::string a) {}
    void eventC (unsigned long a) {}
};

// -------------------------
template<typename TYPE>
struct invoker {};

template<>
struct invoker<EventA>
{
    static void call (X *x, EventA e)
    {
        x->eventA (e.a, e.b);
    }
};

template<>
struct invoker<EventB>
{
    static void call (X *x, EventB e)
    {
        x->eventB (e.strEvent);
    }
};

template<>
struct invoker<EventC>
{
    static void call (X *x, EventC e)
    {
        x->eventC (e.a);
    }
};

// ---------------------------------------
template<typename EVENT_TYPE> 
void X::fsm (const EVENT_TYPE &eventData)
{
    invoker<EVENT_TYPE>::call (this, eventData);
}

int main (int argc, char *argv[])
{
    X x;

    EventA eEventA;
    eEventA.a = -1;
    eEventA.b = 2.0;

    EventB eEventB;
    eEventB.strEvent = "xyz";

    EventC eEventC;
    eEventC.a = 42;

    x.fsm (eEventA);
    x.fsm (eEventB);
    x.fsm (eEventC);

    return 0;
} 
```

# wpf - 在 WPF 中拖动时更改光标

> ID：14342463
> 
> 赞同：6
> 
> 时间：2013-01-15T16:41:34.367
> 
> 标签：wpf, drag-and-drop

我正在使用这个很棒的拖放框架：[http](http://code.google.com/p/gong-wpf-dragdrop/) ://code.google.com/p/gong-wpf-dragdrop/ 我有两个列表框 - A 和 B。当我从 B 拖动到 A 时，我想要鼠标光标在列表框 A 区域内时立即更改。

我几乎明白了。通过使用 IDropTarget 接口如下：

```
void IDropTarget.DragOver(DragOver drag)
{
 drag.Effects = DragDropEffects.Copy | DragDropEffects.Move;

 // some logic to determine if hovering over listbox A
 // ...

 if (hoveringOverListA)
 {
  ListBoxA.Cursor =  ((FrameworkElement) Application.Current.Resources["ListboxACursor"]).Cursor;
 }
} 
```

唯一的问题是，当我拖动光标时，显示的是不允许的操作（带有线条的黑色圆圈）。只要我松开鼠标，我就会看到我的 ListboxACursor 出现。所以它就像是一个延迟的反应，就像它在等待我 Drop 而不是在我 DragOver'ing 时执行它。

如果有人能看到代码有什么问题，我将不胜感激。我有一种感觉，这可能与 DragDropEffects 有关，但这主要是一种预感。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2014-03-26T13:33:13.203

回答这个问题是因为它是 Google 搜索结果中的佼佼者。

```
protected override void OnGiveFeedback(System.Windows.GiveFeedbackEventArgs e)
{
    Mouse.SetCursor(Cursors.Hand);
    e.Handled = true;
} 
```

此方法应在拖动源上定义。将事件标记为已处理并且不要调用至关重要`base.OnGiveFeedback`，因为这样做会导致默认拖动光标覆盖您的更改。

请注意我如何使用`Mouse.SetCursor`而不是更明显的`FrameworkElement.Cursor`. 后者是拖动源元素的持久属性，您不太可能真正想要更改

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T17:12:58.013

这是因为 Windows 尝试使用自己的光标来确保默认外观。您可以通过显式禁用默认光标来避免这种情况。[请参阅本教程](http://www.switchonthecode.com/tutorials/winforms-using-custom-cursors-with-drag-drop)中的 GiveFeedback 事件

```
 private void DragSource_GiveFeedback(object sender, GiveFeedbackEventArgs e)
 {
   e.UseDefaultCursors = e.Effect != DragDropEffects.Copy;
 } 
```

# objective-c - Objective-C - 避免编译错误？

> ID：14342469
> 
> 赞同：0
> 
> 时间：2013-01-15T16:41:48.560
> 
> 标签：objective-c, compiler-errors, compiler-warnings

有没有办法抑制编译错误？在这种情况下我不能使用协议，因为我尝试使用的类在外部库中。我无法控制代码

```
if (myClass && [[myClass class] respondsToSelector:@selector(getSomething)])
{
   // Compile error on the line below
   MyResult *result = [myClass getSomething];

   // Also tried
   MyResult *result = [(id)myClass getSomething];

} 
```

**编辑：** 错误：选择器没有已知的类方法

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T17:28:43.140

当您在无类型的 Objective-C 对象上使用方法时，编译器会尝试根据其选择器猜测您尝试调用的方法，因为它需要根据返回值生成不同的代码。生成代码的方式也不同，具体取决于您是否使用 ARC，编译器需要相应更改。

如果没有 ARC，编译器将假定返回类型`id`  适用于它不知道的任何选择器，并将生成警告。使用 ARC，它变成了一个硬错误，因为编译器不想冒险进行内存管理。

这就是为什么您至少需要告诉编译器该方法的一个现有声明。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T17:35:04.780

This article describes how to use a #pragma declaration to avoid compiler warnings for cases where you are certain the warning is a false positive (or one that you believe is safe to ignore): [NSHipster - #pragma](http://nshipster.com/pragma/)

# string - 构建树的并行算法？

> ID：14342476
> 
> 赞同：9
> 
> 时间：2013-01-15T16:42:06.983
> 
> 标签：string, algorithm, data-structures, parallel-processing, trie

因为 trie 数据结构具有如此巨大的分支因子，并且每个子树完全独立于其他子树，所以似乎应该有一种方法可以通过并行添加所有单词来极大地加快给定字典的 trie 构建速度。

我对如何做到这一点的最初想法如下：将互斥锁与 trie 中的每个指针（包括指向根的指针）相关联，然后让每个线程遵循将单词插入到 trie 中的正常算法。但是，在跟踪任何指针之前，线程必须首先获取该指针上的锁，这样如果它需要向 trie 添加一个新的子节点，它就可以在不引入任何数据竞争的情况下这样做。

这种方法的问题是它使用了*大量*的锁——一个用于 trie 中的每个指针的锁——并且进行*了大量*的获取和释放——一个用于每个输入字符串中的每个字符。

有没有办法在不使用几乎一样多的锁的情况下并行构建一个 trie？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-15T17:09:06.770

一个明显的无锁算法是：

1.  按长度为*k*的前缀对输入字符串进行桶排序（通常*k* =1，但对于小字母，增加*k*）。
2.  对于每个字母，构造一个包含以该字母开头的所有字符串的*k后缀的 trie。*
3.  合并上一步的尝试（当*k* =1 时，只需添加一个根节点）。

假设前缀分布均匀，这可以为您提供高达字母表大小的*k*次幂的线性加速。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-15T17:08:17.197

我突然想到，这可以通过对指针使用原子测试和设置操作而不是锁来实现无锁。具体来说，如果一个线程想要跟随一个指针，它会执行以下操作：

1.  原子读取指针值。
2.  如果指针非空，则跟随它。你完成了。
3.  否则，分配一个新节点。
4.  原子地测试指针是否为空，如果为空，则将其设置为新节点。
5.  （备注：这里的指针肯定是非空的。要么我们只是设置了它，要么它是由另一个线程设置的）。
6.  跟随指针。

根据硬件，这可能会快得多，因为它避免了一直锁定和解锁的工作，并确保没有线程无限期地等待。

一个缺点是涉及的分配数量增加了，因为多个线程可能都尝试分配一个节点以在特定位置放入 trie，但只有一个可以将它放在那里。幸运的是，可以通过以下优化来缓解这种情况：如果一个线程不必要地分配了一个节点，而不是立即释放它，它只是将节点存储在临时空间中。如果稍后它需要分配一个新节点，它可以使用缓存的节点。如果没有，它可以在最后释放它。

希望这可以帮助！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-15T16:55:29.403

**好吧，在为一组节点**（而不是一个）设置锁定的细粒度与粗粒度之间存在明显的权衡。

一个简单的方法是通过散列 - 拥有`m`不同的锁，并且对于您要访问的每个节点获取编号为 的锁`hash(node) % m`。
请注意，这种方法基本上是建议方法（使用完美散列和`n == m`）和串行方法（使用`m == 1`）的概括。

可以利用的另一件事是**[乐观设计](http://en.wikipedia.org/wiki/Optimistic_concurrency_control)**- 如果该方法实际上会提高性能，当然取决于字典的分布和特里树的大小，如果冲突往往非常罕见（这可能是很长单词的字典的情况）。
这个想法是在没有任何同步的情况下将单词添加到树中，如果遇到冲突 - 回滚到最后一个已知的稳定状态（这当然需要对数据进行快照，如果我们这样做可能是不可行的谈论无法存储的数据流）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-15T17:31:55.950

根据您的字典的外观，如果您可以让每个线程构建独立的子树，您可能根本不需要锁。如果这不是在线算法，请按前缀对单词进行预排序（如果您有 < 26 个线程，则为第一个字母，如果您有更多或您知道数据不平衡，则为第一个和第二个，例如，90% 的词从 A) 开始。基本上，这将是一个 O(n) 操作，您执行一次计算以计算有多少以给定字母开头的单词，然后执行一次排序（按照您选择的前缀进行基数排序）。然后，划分线程之间的前缀，让每个线程构建这些独立的子树。最后，让一个线程将这些子树中的每一个添加到根。我将在下面介绍一个示例。

您的词典：
Bark
Apple
Cookie
和
Baby
Corn
Blue
Cake
Bacon

排序后：
苹果
和
树皮
婴儿
蓝
培根
玉米
饼干
蛋糕

然后我们在线程之间划分前缀。对于此示例，我们有 3 个线程，它们获取前缀 [A][B][C]，并构建以下树：

```
一个--| 乙--------| C --------|    
PN |-- A ---| 洛---| 一种
PDRBCUORK
乐视网
埃尼
                                   乙

```

然后你有一个线程在根处将这些组合起来，例如：

```
|----------- 根目录------|
一个--| 乙--------| C --------|    
PN |-- A ---| 洛---| 一种
PDRBCUORK
乐视网
埃尼
                                   乙

```

我希望这是有道理的。

这种方法的优点：线程基本上独立工作，您不必处理获取和释放锁的开销。

这种方法的缺点：如果您对字典一无所知，可能会出现严重的工作负载不平衡，并且在最坏的情况下（例如，所有单词都以“A”开头）它会恢复为基本上是单线程构建一颗树。有几种方法可以使这更好，例如，您可以在排序时添加一些检查，这样如果在处理单个字母前缀时工作量严重不平衡，则可以使用前 2 个字母，但实际上您可以t保证它将是平衡的。

如果假设您有 20 个线程并按第一个字母排序，那么您有时也可能有空闲线程，那么您将有大约 6 个线程必须执行两个子树，而其中 14 个线程在一半时间内处于空闲状态。您也许可以进一步细分子树来处理这个问题，但这是在预处理步骤上花费的额外时间。

Anyway, no guarantees that this is faster than your method, but its something to consider.

# wso2 - 指定的远程服务器未在 WSO2 Developer Studio 2.1.0 中运行

> ID：14342477
> 
> 赞同：2
> 
> 时间：2013-01-15T16:42:07.363
> 
> 标签：wso2, wso2developerstudio

当我尝试在 WSO2 Developer Studio 2.1.0 中提交对注册表资源所做的更改时，我看到此错误：指定的远程服务器未运行。

消息代码：ERROR_IN_RESTORING，参数：{路径：/_system/config/gestion_tesis/servicioProfesor/secuencias/centralAssets，注册表网址：https://iesb.uci.cu/t/ptesisesb.cdae.uci.cu/registry，用户名： admin@ptesisesb.cdae.uci.cu}

在日志文件中，我看到了这个：

```
!ENTRY org.wso2.developerstudio.eclipse.greg.base 4 0 2013-01-15 11:01:14.095
!MESSAGE Transport error: 405 Error: Method Not Allowed
!STACK 0
org.apache.axis2.AxisFault: Transport error: 405 Error: Method Not Allowed
    at org.apache.axis2.transport.http.HTTPSender.handleResponse(HTTPSender.java:308)
    at org.apache.axis2.transport.http.HTTPSender.sendViaPost(HTTPSender.java:194)
    at org.apache.axis2.transport.http.HTTPSender.send(HTTPSender.java:75)
    at org.apache.axis2.transport.http.CommonsHTTPTransportSender.writeMessageWithCommons(CommonsHTTPTransportSender.java:450)
    at org.apache.axis2.transport.http.CommonsHTTPTransportSender.invoke(CommonsHTTPTransportSender.java:277)
    at org.apache.axis2.engine.AxisEngine.send(AxisEngine.java:443)
    at org.apache.axis2.description.OutInAxisOperationClient.send(OutInAxisOperation.java:406)
    at org.apache.axis2.description.OutInAxisOperationClient.executeImpl(OutInAxisOperation.java:229)
    at org.apache.axis2.client.OperationClient.execute(OperationClient.java:165)
    at org.wso2.carbon.core.services.authentication.AuthenticationAdminStub.login(AuthenticationAdminStub.java:311)
    at org.wso2.developerstudio.eclipse.greg.resource.authorization.ResourceAdmin.isUserAuthenticate(ResourceAdmin.java:153)
    at org.wso2.developerstudio.eclipse.greg.base.ui.dialog.CredentialsDialog.okPressed(CredentialsDialog.java:234)
    at org.eclipse.jface.dialogs.Dialog.buttonPressed(Dialog.java:472)
    at org.wso2.developerstudio.eclipse.greg.base.ui.dialog.CredentialsDialog.buttonPressed(CredentialsDialog.java:223)
    at org.eclipse.jface.dialogs.Dialog$2.widgetSelected(Dialog.java:624)
    at org.eclipse.swt.widgets.TypedListener.handleEvent(TypedListener.java:234)
    at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:84)
    at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1053)
    at org.eclipse.swt.widgets.Display.runDeferredEvents(Display.java:4066)
    at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3657)
    at org.eclipse.jface.window.Window.runEventLoop(Window.java:825)
    at org.eclipse.jface.window.Window.open(Window.java:801)
    at org.wso2.developerstudio.eclipse.greg.base.ui.util.SWTControlUtils.requestCredentials(SWTControlUtils.java:82)
    at org.wso2.developerstudio.eclipse.greg.manager.local.checkout.actions.CommitAction.executeFile(CommitAction.java:91)
    at org.wso2.developerstudio.eclipse.greg.manager.local.checkout.actions.BaseRegistryAction.run(BaseRegistryAction.java:49)
    at org.eclipse.ui.internal.PluginAction.runWithEvent(PluginAction.java:251)
    at org.eclipse.jface.action.ActionContributionItem.handleWidgetSelection(ActionContributionItem.java:584)
    at org.eclipse.jface.action.ActionContributionItem.access$2(ActionContributionItem.java:501)
    at org.eclipse.jface.action.ActionContributionItem$5.handleEvent(ActionContributionItem.java:411)
    at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:84)
    at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1053)
    at org.eclipse.swt.widgets.Display.runDeferredEvents(Display.java:4066)
    at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3657)
    at org.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:2629)
    at org.eclipse.ui.internal.Workbench.runUI(Workbench.java:2593)
    at org.eclipse.ui.internal.Workbench.access$4(Workbench.java:2427)
    at org.eclipse.ui.internal.Workbench$7.run(Workbench.java:670)
    at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332)
    at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:663)
    at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:149)
    at org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:115)
    at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:196)
    at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:110)
    at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:79)
    at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:369)
    at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:179)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
    at java.lang.reflect.Method.invoke(Unknown Source)
    at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:619)
    at org.eclipse.equinox.launcher.Main.basicRun(Main.java:574)
    at org.eclipse.equinox.launcher.Main.run(Main.java:1407) 
```

任何想法？

# ios - UIApplication sharedApplication 在返回应用程序并重新启动时继续执行

> ID：14342480
> 
> 赞同：4
> 
> 时间：2013-01-15T16:42:11.270
> 
> 标签：ios, uiapplicationdelegate

下面的代码工作正常，但是当我回到我的应用程序时，它会继续执行下面的代码，但我不知道为什么以及如何停止它。我认为它只发生在 ios5.0 中：app flow - rootviewcontroller -> mainviewcontroller -> webview

在 mainviewcontroller 的 webview 的 shouldstartloadrequest 方法中**调用**了以下代码

```
@property (readwrite, retain) UIWebView *_loginWebView;
...
..
- (void)viewDidLoad
{
    [super viewDidLoad];
    NSURLRequest *requestObj = [NSURLRequest requestWithURL:url];
    [_loginWebView loadRequest:requestObj];
} 
```

//当webview收到打开url的请求时调用following

```
 - (BOOL)webView:(UIWebView *)webView shouldStartLoadWithRequest:(NSURLRequest *)request navigationType:(UIWebViewNavigationType)navigationType{
            //return no is a special case there is more code in the method which I am not showing here
           if ([[UIApplication sharedApplication] canOpenURL:myURL]) 
           {
                  [[UIApplication sharedApplication] openURL:myURL];
           }
           else
           {
                  [[UIApplication sharedApplication] openURL:[NSURL URLWithString:newPath]];
           }
           return NO;
     }
     //above is a special case

} 
```

头部标签内容 -

```
<head>
<meta name="viewport" content="width=device-width,initial-scale=1" />
  <!-- iOS Stuff -->
  <link rel="apple-touch-icon" href="images/...."/>
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <link rel="shortcut icon" href="favicon.ico" />
  <script async="async" src="https://......."></script>
  <script type="text/javascript">
..........
  </script>
</head> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T00:44:33.587

myURL 是否在标题中设置了元刷新？如果网页正在重新加载，则会调用此方法。如果有重定向，它也会被调用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-16T03:54:44.440

这是 IOS 5.0 的一个错误，如果您在应用程序返回前台时返回 web 视图，它会刷新它......就像 safari 一样......

但苹果在 IOS 6.0 中修复了这个错误

所以对此无能为力。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-18T03:30:18.990

如果我很好地理解了您的问题，那么问题是

1.  启动您的应用程序，转到 mainViewController，在视图加载后，它将让 iOS 在另一个应用程序中打开一个 url。
2.  打开另一个应用程序，当您返回您的应用程序时，Web 视图会自动重新加载 url。

所以，问题是为什么 webview 会自动重新加载 url。

从上面的代码来看，它喜欢不需要使用 web 视图，因为委托总是返回 No，并做一些其他的事情。

我不知道为什么现在会发生这种情况，如果可以的话，只需删除困扰此的 web 视图。

这个答案将被删除。

# c# - 在制作 LINQ SQL OO 时避免传递上下文？

> ID：14342481
> 
> 赞同：0
> 
> 时间：2013-01-15T16:42:12.867
> 
> 标签：c#, .net, linq

现在我正在制作使用 LINQ 的便利类。

前任：

```
 public static bool Remove(Customer c,KezberPMDBDataContext context)
    {
        if (c != null && context != null)
        {
            KezberPMDBDataContext db = context;
            db.Customers.DeleteOnSubmit(c);
            db.SubmitChanges();
            return true;
        }

        return false;
    } 
```

我还有其他类似的功能：

```
public static Customer Get(string description,
            KezberPMDBDataContext context = null)
        {
            KezberPMDBDataContext db = GetContext(context);
            return (from p in db.Customers
                    where p.CustomerDescription == description
                    select p).FirstOrDefault();
        } 
```

问题是要执行诸如删除客户之类的任务，我需要上下文。

有没有办法做到这一点而不总是需要传递上下文？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T16:45:19.297

是的，为这些操作中的每一个创建一个新的上下文。

创建数据上下文并不昂贵。依赖连接池，因此每个新上下文都没有创建新连接的开销。除非您有令人信服的理由来支持您提交的操作，否则最好不要传递上下文。

# c# - 查找 2 个日期之间的所有季度

> ID：14342482
> 
> 赞同：2
> 
> 时间：2013-01-15T16:42:14.773
> 
> 标签：c#, .net

我试图找到两个给定日期之间的所有季度。

例如，如果当前日期是今天（2013 年 1 月 15 日）并且过去的日期是 2012 年 1 月 1 日，我应该得到以下结果： 2012 年 12 月 2012 年 9 月 2012 年 6 月 2012 年 3 月

我可以从当前日期开始继续扣除 3 个月，但这并不准确，因为下面的测试表明：

```
 [TestMethod]
        public void FindAllQuaters_FromAGivenDate_TillAPastDate()
        {
            var dateFinder = new FindQuarter();
            //Between Feb 2013 & Jan 2012
            var dates = dateFinder.GetAllQuarters(new DateTime(2013, 02, 01), new DateTime(2012, 01, 01)).ToList();

            Assert.IsTrue(dates.Count == 4);
            Assert.IsTrue(dates.First().Month == 12);
            Assert.IsTrue(dates.First().Year == 2012);

            Assert.IsTrue(dates.Skip(1).First().Month == 9);
            Assert.IsTrue(dates.Skip(1).First().Year == 2012);

            Assert.IsTrue(dates.Skip(2).First().Month == 6);
            Assert.IsTrue(dates.Skip(2).First().Year == 2012);

            Assert.IsTrue(dates.Skip(3).First().Month == 3);
            Assert.IsTrue(dates.Skip(3).First().Year == 2012);
        }
    }

    public class FindQuarter
    {
        public IEnumerable<DateTime> GetAllQuarters(DateTime current, DateTime past)
        {
            while (current > past)
            {
                current = current.AddMonths(-3);
                yield return current;
            }
        }
    } 
```

我怎样才能做到这一点？季度定义为 3 月、6 月、9 月和 12 月。我还需要那个月的最后一个日期（我希望很快）。

编辑：这不起作用，因为它会从给定日期减去 3 个月，例如，如果当前日期是 2013 年 2 月并且我减少了 3 个月，我得到的是 2012 年 11 月而不是 2012 年 12 月。

*   一月，二月，三月的任何日期都属于第一季度，即三月

*   四月，五月，六月的任何日期都属于第二季度，即六月

*   七月、八月、九月的任何日期都属于第三季度，即九月

*   10 月、11 月、12 月的任何日期都属于第四季度，即 12 月

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T17:14:30.593

这似乎有效。

```
 public IEnumerable<DateTime> GetAllQuarters(DateTime current, DateTime past)
        {
            var curQ = (int)Math.Ceiling(current.Month / 3.0M);
            var lastQEndDate = new DateTime(current.Year, curQ * 3, 1).AddMonths(-2).AddDays(-1);

            do
            {
                yield return lastQEndDate;
                lastQEndDate = lastQEndDate.AddMonths(-3);
            } while (lastQEndDate > past);
        } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T16:53:57.493

我认为您可以使用`%`运算符。例如：

```
if (dt1.Month % 3 == 0)
{
    // it is a quarter end, else it's not. 
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-15T16:47:48.797

你可以使用我[前段时间](https://stackoverflow.com/a/6592906/284240)写的下面的类：

```
DateTime dt1 = new DateTime(2012, 1, 1);
DateTime dt2 = new DateTime(2013, 1, 15);
long countQuarters = Quarter.GetQuarters(dt1, dt2); // outputs 4 
```

四分之一：

```
public class Quarter
{
    public static long GetQuarters(DateTime dt1, DateTime dt2)
    {
        double d1Quarter = GetQuarter(dt1.Month);
        double d2Quarter = GetQuarter(dt2.Month);
        double d1 = d2Quarter - d1Quarter;
        double d2 = (4 * (dt2.Year - dt1.Year));
        return Round(d1 + d2);
    }

    private static int GetQuarter(int nMonth)
    {
        if (nMonth <= 3)
            return 1;
        if (nMonth <= 6)
            return 2;
        if (nMonth <= 9)
            return 3;
        return 4;
    }

    private static long Round(double dVal)
    {
        if (dVal >= 0)
            return (long)Math.Floor(dVal);
        return (long)Math.Ceiling(dVal);
    }
} 
```

[**演示**](http://ideone.com/gKJguP)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-09-06T17:37:23.713

我知道这是一个旧线程，但这里有一个 Lambda 表达式来获取这些信息：

```
 private static List<Tuple<DateTime, DateTime>> GetQuarterDates(DateTime startDate, DateTime endDate)
    {
        List<Tuple<DateTime, DateTime>> quarterDates = new List<Tuple<DateTime, DateTime>>();

        quarterDates = Enumerable.Range(0, (endDate - startDate).Days)
            .Where(x => startDate.AddMonths(x).Date == new DateTime(startDate.AddMonths(x).Year, (((startDate.AddMonths(x).Month - 1) / 3 + 1) - 1) * 3 + 1, 1))
            .Select(x => new Tuple<DateTime, DateTime>(startDate.AddMonths(x), startDate.AddMonths(x + 3).AddDays(-1)))
            .Where(x => x.Item2 <= endDate).ToList();

        return quarterDates;
    } 
```

# javascript - Javascript 将我的 php var 0000001000 变为 512

> ID：14342485
> 
> 赞同：1
> 
> 时间：2013-01-15T16:42:29.060
> 
> 标签：javascript, string, int

```
<a href='javascript:void(0)' onclick='show($ID);'>ID</a> 
```

我的 $ID 是 0000001000。

我的 show() 函数得到的是 512 而不是 0000001000

我尝试使用 String() 和 .toString() 将 $ID 转换为字符串，但我仍然执行 alert() 它返回 512。

我读了一些关于八进制模式的东西。我该如何预防或纠正这种情况？

我希望我的函数读取 0000001000

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T16:43:51.403

您应该将其作为字符串传递：

```
echo "<a href='javascript:void(0)' onclick='show(\"" . $ID . "\");'>ID</a>"; 
```

否则，它会自动从八进制转换为十进制表示法`oct(1000) === dec(512)`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T16:46:03.233

以 0 开头的数字在 Javascript 中被视为八进制（不是二进制！）。八进制的 1000 == 十进制的 512。您应该将值作为字符串处理以避免此类问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-15T16:44:47.567

当您将它传递给您的 show 函数时，它似乎`0000001000`被解释为八进制（归功于@Oscar Lopaz）（512）。尝试将其作为字符串传递：

```
<a href="javascript:void(0)" onclick="show('" + $ID + "');">ID</a> 
```

# android - setTheme 的哪个上下文？

> ID：14342488
> 
> 赞同：0
> 
> 时间：2013-01-15T16:42:38.910
> 
> 标签：android, actionbarsherlock

我在我的应用程序上使用带有标签的 actionbarsherlock。在选项卡上必须将文本颜色更改为黑色或白色。根据我的应用程序的方向。在风景上我必须换成白色。因为我的操作栏是黑色的。当我更改为纵向时，我必须设置为黑色，因为我的标签背景是白色的。但是您可以以编程方式使用来更改颜色。所以我用这个技巧来改变主题。

当我的清单上的方向更改时，我禁用了重新加载选项

```
android:configChanges="keyboardHidden|orientation|screenSize"> 
```

这工作上帝。现在我在我的片段上实现它：

```
@Override
public void onConfigurationChanged(Configuration newConfig)
{
    super.onConfigurationChanged(newConfig);

    if(newConfig.orientation == Configuration.ORIENTATION_PORTRAIT)
    {
        getSherlockActivity().setTheme(android.R.style.Theme_Holo_Light);
        Log.e("Portai", "port");
    }
    else
    {
        getSherlockActivity().setTheme(android.R.style.Theme_Holo);
        Log.e("land", "alnd");
    }
} 
```

我可以在 logcat 上看到日志。但是主题是确定的。标签字体颜色始终为黑色！谁能帮我设置主题，这样我就可以以编程方式更改选项卡上的文本颜色

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T15:49:54.880

另一种方法是不覆盖配置更改（针对活动）并检查片段创建的方向，如下所示：

```
 public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    Log.d(this.getClass().getSimpleName(), "onCreate()");

    if (getResources().getConfiguration().orientation == Configuration.ORIENTATION_LANDSCAPE) {
      getActivity().setTheme(android.R.style.Theme_Holo_Light);
    } else {
      getActivity().setTheme(android.R.style.Theme_Holo);
    }
  } 
```

# sql - 错误：函数 regexp_like（字符变化，未知）不存在

> ID：14342489
> 
> 赞同：10
> 
> 时间：2013-01-15T16:42:39.007
> 
> 标签：sql, postgresql

我有这个`SQL`查询，我正在使用`Postgresql`.

```
select * from cdr_data 
  where REGEXP_LIKE(identifiant,'^73')
    and REGEXP_REPLACE(callednumber,'^256','') ~ '^73' 
```

它给了我以下错误：

```
[Err] ERROR:  function regexp_like(character varying, unknown) does not exist
LINE 2: and  regexp_like(identifiant,'^73') 
```

我试过用`REGEXP_LIKE`with代替`LIKE`，`REGEXP_MATCHES`但它们不起作用。

可能是什么问题呢？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-01-16T08:34:29.730

PostgreSQL 的等价物`regexp_like(identifiant,'^73')`是`identifiant ~ '^73'`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2018-07-14T09:08:42.113

您是否尝试过使用`SIMILAR TO`运算符？

PostgreSQL 文档中的一些片段：

```
a. `select 'abc' SIMILAR TO '(a|d)%';`
b. `select 'def' SIMILAR TO '(a|b|c)%';` 
```

语句 a 返回`t`(true)，因为 'abc' 以 'a' 或 'd' 开头。语句 b 返回`f`(false)，因为“def”不以“a”或“b”或“c”开头。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2022-02-10T08:13:02.483

实际上，您可以使用以下功能之一

```
value_or_colum_name ~ '<regex-expression>'
value_or_colum_name SIMILAR TO '<regex-expression>'
TEXTREGEXEQ(value_or_colum_name,'<regex-expression>') 
```

所有这 3 种可能性是完全等价的。

`REGEXP_LIKE`SqlPostGreSQL 上不存在该函数。但是`REGEXP_MATCHES`并且`REGEXP_REPLACE`存在。

这是一个命令`~`，`REGEXP_REPLACE`我用它来检查我的正则表达式是否在启动 SQL 之前正常工作`UPDATE`。

```
SELECT communication
      ,REGEXP_REPLACE
         (communication
         ,'(\d{3})(\d{4})(\d{5})'
         ,'***\1/\2/\3***'
         ) as ref 
  FROM mouvements 
  WHERE communication ~ '^\d{12}$' 
```

这给出了以下结果

```
comm            ref
------------------------------------
303000167868    ***303/0001/67868***
121231357408    ***121/2313/57408***
321000204456    ***321/0002/04456*** 
```

最后的 UPDATE 命令是

```
UPDATE mouvements
  SET communication = NULL
     ,Ref_Structured = REGEXP_REPLACE(communication,'(\d{3})(\d{4})(\d{5})','***\1/\2/\3***')
  WHERE communication ~ '^\d{12}$' 
```

另一个拆分列的 SQL`UPDATE`命令是 2

```
UPDATE mouvements
  SET nom = REGEXP_REPLACE(nom,'^(.*)(REFERENCE DONNEUR D''ORDRE : )(.*)','\1')
     ,RefDonneur = REGEXP_REPLACE(nom,'^.*(REFERENCE DONNEUR D''ORDRE : )(.*)','\2')
  where nom ~ 'REFERENCE DONNEUR D''ORDRE :' 
```

# java - 递归的性能

> ID：14342490
> 
> 赞同：0
> 
> 时间：2013-01-15T16:42:48.897
> 
> 标签：java, unit-testing, recursion

好的，我有这个代码：

```
public void TraverseTree(TreeNode node) {

            TraverseTree(node.getLeftChild());
            System.out.println(node.getKey());
            TraverseTree(node.getRightChild());         
    } 
```

这实际上遍历树的节点并打印它们。我正要写一个测试用例时突然想到如何对没有返回类型的函数进行单元测试？

在更改代码使其值得“单元测试”之后，它看起来像这样：

```
public ArrayList<Object> TraverseTree(TreeNode node, ArrayList<Object> array) {

                if(array == null)
                      array = new ArrayList<Object>();
                traverseTree(node.getLeftChild(), array);
                array.add(node.getKey())
                traverseTree(node.getRightChild(), array); 

return array;       
        } 
```

现在我在想，这是正确的方法吗？对于每次递归调用，都有一个 ArrayList 对象被推上堆栈这一事实又如何呢？这是一个好方法吗？如果树包含数千个键怎么办？

我真的很想知道有没有更好的方法来做到这一点？是否可以对我的第一个代码示例（不返回任何内容的代码示例）进行单元测试？我的测试用例只是 1）它是否以正确的顺序返回？如果树为空会发生什么？ETC

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T16:48:32.510

它只是一个被压入堆栈的引用（基本上是一个指针）。

另一种策略是将抽象 Stream 对象传递到您的方法中，然后将其打印到该方法中，而不是将其硬编码为`System.out`. 然后为了测试，你可以传入一个[*模拟对象*](http://en.wikipedia.org/wiki/Mock_object)来捕获输出。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T16:54:40.553

您可以传递要使用的 PrintStream 而不是打印到控制台。这可以是`System.out`包装了 ByteArrayOutputStream 的 PrintStream，您可以将其转换为 String 以在方法运行后进行检查。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T16:50:51.110

我想问题是，你的应用程序的主要目的是什么，你想测试什么？
实际上，您的代码除了打印出所有节点之外什么都不做，但我想这只是为了使示例更简单。

我不会测试遍历本身。这是一个给定的系统功能，你可以确定它工作正常。而是测试您的遍历结果。

# c++ - MSBuild C++ - 命令行 - 可以通过定义吗？

> ID：14342492
> 
> 赞同：8
> 
> 时间：2013-01-15T16:42:49.317
> 
> 标签：c++, visual-c++, msbuild, macros, c-preprocessor

有没有办法转换这样的东西：

```
#define ERROR_LOG_LEVEL 5 
```

进入 msbuild 通过命令行将传递给其项目的东西？

```
msbuild.exe {???}ERROR_LOG_LEVEL=5 target 
```

我已经阅读了对类似问题的回复，看起来答案是**否定**的，只是想仔细检查一下，以防某些天才找到了解决方法。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-15T16:54:26.923

可以通过[将`/D`选项](http://msdn.microsoft.com/en-us/library/hhzbb5c8.aspx)传递给编译器来定义宏。您可以使用of`/D`从 MSBuild 中指定选项：`AdditionalOptions``ClCompile`

```
<ItemDefinitionGroup>
    <ClCompile>
        <AdditionalOptions>/DERROR_LOG_LEVEL=5 %(AdditionalOptions)</AdditionalOptions>
    </ClCompile>
</ItemDefinitionGroup> 
```

如果您希望能够通过调用 msbuild.exe 来传递宏的值，您也可以轻松地做到这一点：

```
<ItemDefinitionGroup Condition="'$(ErrorLogLevel)' != ''">
    <ClCompile>
        <AdditionalOptions>/DERROR_LOG_LEVEL=$(ErrorLogLevel) %(AdditionalOptions)</AdditionalOptions>
    </ClCompile>
</ItemDefinitionGroup> 
```

使用 msbuild.exe 调用为：

```
msbuild /p:ErrorLogLevel=5 MyProject.vcxproj 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-04-07T12:45:50.597

我在[这里](https://stackoverflow.com/questions/15141429/how-to-set-preprocessordefinitions-as-a-task-propery-for-the-msbuild-task/)发布了一个答案，但我复制它以获得另一个答案。您需要在 PropertySheet 中定义用户定义的宏。然后创建一个引用用户定义宏的预处理器。您现在可以在代码中使用新的预处理器值。最后，对于构建，您可以使用`/p`标志更改用户定义的宏的值。在这里，我定义了一个用户定义的值`mymacro`和一个预处理器值，比如`VAL`. 现在您可以简单地使用`/p:mymacro="\"some thing new\""`.

```
#include <iostream>

int main() {
    std::cout << VAL << std::endl;

    getchar();
} 
```

`yourproject.vcxproj`：

```
<ClCompile>
  ...
  <PreprocessorDefinitions>VAL=$(mymacro);%(PreprocessorDefinitions)</PreprocessorDefinitions>
</ClCompile> 
```

`msbuild yourproject.vcxproj /p:mymacro="\"some thing new\""`

# javascript - 在不使用 HTTPS 的情况下嵌入 Google 地图

> ID：14342494
> 
> 赞同：1
> 
> 时间：2013-01-15T16:42:51.387
> 
> 标签：javascript, google-maps, iframe

我只是想用动态变化的地址（取自数据库）嵌入谷歌地图，但我想保留在 http.map 中。每次我尝试嵌入地图时，它都会加载，但会向控制台发送几个错误（同一错误的 60 多次迭代）：

```
Unsafe JavaScript attempt to access frame with URL http://mydomain.com from frame with URL https://maps.google.com/maps?f=q&source=s_q&hl=en&geocode=&q=address&z=14&output=embed. 
The frame requesting access has a protocol of 'https', the frame being accessed has a protocol of 'http'. Protocols must match. 
```

我该如何解决？我的 iframe 代码：

```
document.getElementById("deMap").src = 'http://maps.google.com/maps?f=q&source=s_q&hl=en&geocode=&q='+arr[5]+'&hnear='+arr[5]+'&z=14&output=embed'; 
```

相关HTML：

```
 <div id="deRight">
        <iframe id="deMap" width="405px" height="150px" style="background-color:rgba(0,0,0,.5)"></iframe><br>Contact Info:<br>
        <div id="deContact"></div><br>
        Additional Info.:<br>
        <div id="deInfo"></div>
        <div class="footer" style="width:410px">
            <hr style="width:100%; height:1px; background-color: #CCC; border:0px; margin: 0px; margin-bottom:5px"/>
            <button class="formBtn" onclick="editEvt()">Edit Event</button>
        </div>
    </div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T17:35:07.373

I believe you need to change your `iframe` to a `div`. Then include the following script in your header:

```
<script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?sensor=false"></script> 
```

Depending on what you want to do with the addresses in your database and how they are formatted, there are several directions you can go from here. One example is if you had text addresses and wanted to center the map on them. You could do that as follows:

1.  Load the Google Maps API and create your Geocoder object.
2.  Create your map object and use it to fill your `div`. As in your code, height and width must be set explicitly: `<div id="deMap" style="width: 405px; height: 150px;"></div>`.
3.  Query the Geocoder object to get address coordinates.
4.  Center the map, etc.

See below:

```
// Step 1
var G = google.maps;
var geocoder = new G.Geocoder();

// Step 2
var deMap = document.getElementById('deMap');
var center = new G.LatLng(0, 0);
var mapOptions = {
    zoom: 14,
    center: center,
    mapTypeId: G.MapTypeId.ROADMAP
};
map = new G.Map(deMap, mapOptions);

// Step 3
function changeAddress(address) {
    geocoder.geocode({'address': address}, parseResult);
}

// Step 4
function parseResult(res, status) {
    if (status == G.GeocoderStatus.OK && res.length) {
        var latlng = res[0].geometry.location;
        map.set_center(latlng);
    }
    else {
        alert("Geocode was not successful for the following reason: " + status);
    }
} 
```

For more information, consult Google Maps JavaScript API, which is thoroughly documented [here](https://developers.google.com/maps/documentation/javascript/reference).

You can also see how I implemented it to accomplish a seemingly similar task [here](http://www.adrianlarson.com/earthquakes).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T16:06:01.883

我不知道为什么，但是将“source=embed”更改为“output=embed”似乎可以解决我的问题。我仍然得到相同的 JavaScript 错误，但地图加载并完美运行。

# java - Swing中设置JComboBox的背景

> ID：14342495
> 
> 赞同：7
> 
> 时间：2013-01-15T16:42:54.950
> 
> 标签：java, swing, background, jcombobox

我想要一个没有箭头按钮（完成）的 JComboBox，它在启用时具有绿色背景，在禁用时具有灰色背景（未完成）。我还为下拉列表使用了自定义渲染器（完成）

我检查了 BasicComboBoxUI 的源代码并尝试覆盖一些方法，但没有任何反应。下拉菜单始终具有灰色/蓝色背景。

这是我最后一次尝试的SSCCE。我尝试了我能想到的一切。请给我一个提示，我迷路了。

```
 import java.awt.Color;
import java.awt.Component;
import java.awt.Graphics;
import java.awt.Rectangle;

import javax.swing.BorderFactory;
import javax.swing.DefaultComboBoxModel;
import javax.swing.DefaultListCellRenderer;
import javax.swing.JButton;
import javax.swing.JComboBox;
import javax.swing.JComponent;
import javax.swing.JFrame;
import javax.swing.JList;
import javax.swing.JPanel;
import javax.swing.JScrollPane;
import javax.swing.SwingUtilities;
import javax.swing.plaf.basic.BasicComboBoxUI;

public class DropDownBackground
{
    public static void main(final String[] args)
    {
        SwingUtilities.invokeLater(new Runnable()
        {

            public void run()
            {
                final JComboBox dropdown = new JComboBox(new DefaultComboBoxModel(new String[] { "one", "two", "three" }));
                dropdown.setRenderer(new ComboBoxListCellRenderer());
                dropdown.setUI(new BasicComboBoxUI()
                {
                    @Override
                    public void paint(final Graphics g, final JComponent c)
                    {

                        final Rectangle r = this.rectangleForCurrentValue();
                        this.paintCurrentValueBackground(g, r, true);
                        this.paintCurrentValue(g, r, true);

                    }

                    @Override
                    public void paintCurrentValueBackground(final Graphics g, final Rectangle bounds, final boolean hasFocus)
                    {
                        final Color t = g.getColor();
                        if (this.comboBox.isEnabled())
                            g.setColor(Color.GREEN);
                        else
                            g.setColor(Color.GRAY);
                        g.fillRect(bounds.x, bounds.y, bounds.width, bounds.height);
                        g.setColor(t);
                    }

                    @Override
                    protected JButton createArrowButton()
                    {
                        return new JButton()
                        {
                            @Override
                            public int getWidth()
                            {
                                return 0;
                            }
                        };
                    }
                });
                dropdown.setBackground(Color.GREEN);
                final JPanel p = new JPanel();
                p.add(dropdown);

                final JFrame f = new JFrame();
                f.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                f.getContentPane().add(new JScrollPane(p));
                f.setSize(800, 200);
                f.setLocation(0, 0);

                f.setVisible(true);

            }
        });

    }

    public static class ComboBoxListCellRenderer extends DefaultListCellRenderer
    {
        /**
         * 
         */
        private static final long serialVersionUID = 1L;

        @Override
        public Component getListCellRendererComponent(final JList list, final Object value, final int index, final boolean isSelected, final boolean cellHasFocus)
        {
            this.setToolTipText((String) value);
            if (isSelected)
            {
                this.setBackground(Color.RED);
                this.setForeground(Color.WHITE);
            }
            else
            {
                this.setBackground(Color.WHITE);
                this.setForeground(Color.BLACK);
            }

            this.setText((String) value);
            this.setBorder(BorderFactory.createEmptyBorder(10, 10, 10, 10));

            return this;
        }
    }

} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-16T09:50:15.060

由于我想广泛应用这种颜色，这是最好的方法：

```
UIManager.put("ComboBox.background", new ColorUIResource(UIManager.getColor("TextField.background")));
UIManager.put("ComboBox.foreground", new ColorUIResource(UIManager.getColor("TextField.foreground")));
UIManager.put("ComboBox.selectionBackground", new ColorUIResource(Color.GREEN));
UIManager.put("ComboBox.selectionForeground", new ColorUIResource(Color.WHITE)); 
```

如果您想自定义更多（禁用颜色等），此 UIManager 属性列表可能很有用：[http ://www.rgagnon.com/javadetails/JavaUIDefaults.txt](http://www.rgagnon.com/javadetails/JavaUIDefaults.txt)

# variable-assignment - SugarCrm 将数据从控制器传递到视图

> ID：14342497
> 
> 赞同：2
> 
> 时间：2013-01-15T16:43:05.987
> 
> 标签：variable-assignment, sugarcrm

早上好，我想知道是否有一种神奇的方法可以将在 controllerModule 中创建的变量传递给 ViewModule。例子：

```
$this->assign['result'] => $resultValue; 
```

并在视图 display()

```
echo $this->request['result']; 
```

也许有更好的方法在 Controller 和 View 之间交换数据？谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-15T19:57:33.523

`view_object_map`var 是为您制作的。

在您的控制器中，您可以执行以下操作：

```
$this->view_object_map['myDataKey'] = 'MyData'; 
```

您可以像这样轻松检索数据：

```
$this->ss->assign('myData', $this->view_object_map['myDataKey']); 
```

或者

```
echo $this->view_object_map['myDataKey']; 
```

# php - PHP谷歌地图搜索错误？

> ID：14342500
> 
> 赞同：1
> 
> 时间：2013-01-15T16:43:18.467
> 
> 标签：php, xml, google-maps

我一直在尝试遵循这个旧的 Google 教程（可能是问题所在）

[https://developers.google.com/maps/articles/phpsqlsearch_v3](https://developers.google.com/maps/articles/phpsqlsearch_v3)

但由于某种原因，我看不到 xml 文件？我知道它正在连接到数据库并选择正确的表，但我的 xml 文件只是显示为空？

我的数据库中有数据，其中包含谷歌提供的示例数据。

[http://isca01.bigwavemedia.info/~watfordy/googlemaps/phpsqlsearch_genxml.php?lat=37&lng=-122&radius=25](http://isca01.bigwavemedia.info/~watfordy/googlemaps/phpsqlsearch_genxml.php?lat=37&lng=-122&radius=25)

任何想法为什么会发生这种情况？

谢谢布伦特

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T17:18:54.083

那里有数据，只是不在 25 的半径范围内：

[http://isca01.bigwavemedia.info/~watfordy/googlemaps/phpsqlsearch_genxml.php?lat=37&lng=-122&radius=25000](http://isca01.bigwavemedia.info/~watfordy/googlemaps/phpsqlsearch_genxml.php?lat=37&lng=-122&radius=25000)

它甚至可以显示在[Google Maps API v3 地图上](http://www.geocodezip.com/v3_GenericMapBrowser.asp?filename=http://www.geocodezip.com/xmlProxy060215.asp?http%3A%2F%2Fisca01.bigwavemedia.info%2F~watfordy%2Fgooglemaps%2Fphpsqlsearch_genxml.php%3Flat%3D37%26lng%3D-122%26radius%3D25000)

# c# - 按年份排序并添加列值的查询

> ID：14342501
> 
> 赞同：1
> 
> 时间：2013-01-15T16:43:19.373
> 
> 标签：c#

我正在做一个 C# 项目，我有以下场景：

第一个是月份，第二个是年份，旁边有一个按钮。我还有一个表，其中包含名为 date（数据类型 small datetime）和 price（varchar）的两列。

我已经生成了这个，但它出现“无效的列名'yourMonthSelected'和“无效的列名'yourYearSelected'”错误。我的方法是正确的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T16:46:25.847

我认为您查询文本是错误的。您尝试在查询中添加`yourMonthSelected`and`yourYearSelected`作为参数，但您没有在查询中使用`@yourMonthSelected`and指定它们`@yourYearSelected`。

试试这个查询；

```
string intero = "select sum(no_of_mobiles) from table2 where datepart(mm,given_schedule)= @yourMonthSelected and datepart(yy,given_schedule)= @yourYearSelected"; 
```

查看[*`AddWithValue`*](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlparametercollection.addwithvalue.aspx)方法并检查如何使用它。你可以写；

```
SqlDataReader rdr = cmd.ExecuteReader(); 
```

代替

```
SqlDataReader rdr;
rdr = cmd.ExecuteReader(); 
```

它们完全相同，但第一个看起来更好。同样在您的 while 子句中，您应该使用`rdr[0]`而不是`rdr`, 因为`rdr`是`array`. 像这样;

```
while (rdr.Read())
{
     label2.Text = rdr[0].ToString();
} 
```

# directx - Direct3D 11 可以进行仅离屏渲染（无交换链）吗？

> ID：14342505
> 
> 赞同：4
> 
> 时间：2013-01-15T16:43:34.183
> 
> 标签：directx, render-to-texture, direct3d11

是否可以仅使用 Direct3D 11 渲染到纹理，即不创建交换链且不创建任何窗口？我已经尝试过了，我所有的 API 调用都成功了。唯一的问题是我从临时纹理下载的图片是黑色的。

我终于设法使用 PIX 捕获了完整的流（Parallel Nsight 似乎根本不起作用）。PIX 显示我的渲染目标也是黑色的，尽管我将其清除为蓝色。

我打算做什么有可能吗？如果是这样，一个人会怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T21:58:51.460

实际上，如果您正确初始化设备，整个事情就会按预期工作。

# javascript - 主干视图：无法将视图附加到先前渲染的视图

> ID：14342506
> 
> 赞同：0
> 
> 时间：2013-01-15T16:43:42.617
> 
> 标签：javascript, jquery, backbone.js, underscore.js

这是我的主干代码

应用程序.js

```
window.App = {
Models: {},
Views: {}
};

window.Template = {}; 
```

应用程序/路由器.js

```
App.Router = Backbone.Router.extend({

  initialize: function () {
    Backbone.history.start({pushState: true});
    App.layout = new App.Views.Layout();
    App.layout.render();
    $('#app').append(App.layout.el);
  },

  routes: {
    '': 'index'
  },

  index: function () {
     console.log('index routed.');
     App.home = new App.Views.Home();
     App.home.render();
     $('#content').html(App.home.el);
  }
}); 
```

应用程序/模板.js

```
Template.layout = _.template(
  "<header id=top-bar>"+
  "<nav id=user-panel>"+
  "<ul>"+
  "<li><a class=login href=#>Login</a></li>"+
  "<li><a class=register href=#>Registrati gratis</a></li>"+
  "</ul>"+
  "</nav>"+
  "</header>"+
  "<div id=wrapper>"+
  "<section id=mid-bar>"+
  "<a id=logo href=#><img src=public/img/logo.png></a>"+
  "</section>"+
  "<section id=content>"+
  "</section>"+
  "</div>"
);

Template.home = _.template("Benvenuto in Virtualmix"); 
```

应用程序/视图/layout.js

```
App.Views.Layout = Backbone.View.extend({
  id: 'container',

  template: Template.layout,

  render: function () {
    this.$el.html(this.template);
  }
}); 
```

应用程序/视图/home.js

```
App.Views.Home = Backbone.View.extend({

  tagName: 'p',

  template: Template.home,

  render: function () {
    this.$el.html(this.template);
  }
}); 
```

最后是我的 main.js

```
$(document).ready(function () {
  App.router = new App.Router;
}); 
```

好吧，布局视图（从路由器初始化函数初始化......）被正确渲染，但是从索引函数初始化和渲染的主视图似乎在我之前生成的布局上没有输出任何内容（我想在#content 由布局生成的元素...）。

我认为这是一个 JQuery 问题，但我不知道如何以及为什么......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T16:58:18.397

The problem is that you're calling `Backbone.history.start()` too soon. When you start the history, the route is triggered immediately, at which point your `LayoutView` is not yet rendered, and there is no `#content` element on the page.

The Backbone [docs](http://backbonejs.org/#Router) say:

> During page load, **after your application has finished creating all of its routers**, be sure to call Backbone.history.start() ... [emphasis mine]

I like to still have my main ("app") router be in charge of starting the history, so I usually create a `start` method on the router:

```
AppRouter = Backbone.Router.extend({
  start: function() {
    Backbone.history.start();
  },
  //...
}); 
```

And call it like so:

```
var appRouter = new AppRouter();
var otherRouter = new OtherRouter(); // if you have any
appRouter.start(); 
```

# java - BufferedImage 与 JTextArea 和 JTextField 兼容

> ID：14342507
> 
> 赞同：1
> 
> 时间：2013-01-15T16:43:45.473
> 
> 标签：java, jtextfield, bufferedimage, jtextarea

我一直在研究这个主题，但没有发现任何可以告诉我可以将 BufferedImagen 添加到 JTextArea 或 JTextField 的内容。我正在制作一个聊天应用程序并尝试为聊天添加笑脸。我想要做的是将图像放在字符串旁边，就像它是文本一样。我在想是否可以将缓冲图像以 char 格式放置，这会有所帮助。请帮我！谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T16:55:22.410

我也想试试`JEditorPane`。有关动机，请参阅： http: [//www.apl.jhu.edu/~hall/java/Swing-Tutorial/Swing-Tutorial-JEditorPane.html](http://www.apl.jhu.edu/~hall/java/Swing-Tutorial/Swing-Tutorial-JEditorPane.html)。

我注意到大多数聊天应用程序都在一个窗口中向您显示您和其他人写的内容（可能`JEditorPane`所有表情符号都显示为图片），并且您可以在下面进行编辑`JTextArea`，仅显示文本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T16:57:32.843

问题是 JTextArea 和 JTextField，实际上只是为了显示文本，为了实现将文本与图像混合的东西，您需要扩展 JTextArea 并修改 paintComponentMethod 以进行自定义渲染。

# ios - 在 Snow Leopard 上运行 XCode 4.5 和 iOS 6.xx

> ID：14342510
> 
> 赞同：1
> 
> 时间：2013-01-15T16:43:53.980
> 
> 标签：ios, objective-c, xcode

我使用 iMac Early 2006（Intel Core Duo 32bit）在 XCode 4.2 和 iOS 5 上运行。我正在等待 iMac Late 2012 27 英寸的到来，同时我想为我的应用程序做好准备。同时，我想在 Snow Leopard 上使用 XCode 4.5 迁移到 iOS 6.xx SDK。我一直在阅读关于雪豹这个组合的一些帖子。我的问题是：

1.  在 Snow Leopard 上使用 XCode 4.5 和 iOS 6.xx 的修复真的对人们有用吗？

2.  我读到您不能在 32 位 iMac 上使用 iOS 6 模拟器。这是真的？。如果是，我唯一的选择是在设备上测试应用程序吗？

3.  XCode 4.2 和 XCode 4.5 可以共存还是从 4.​​2 升级到 4.5？

请指教。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T17:21:15.777

关于 Xcode 的两个版本共存，这里有一个线程解决了这个问题（注意它是一个较旧的线程，因此 App Store Xcode 与下载的 Xcode 可能存在一些差异）：[我可以安装多个 xcode 版本吗？](https://stackoverflow.com/questions/669367/can-i-have-multiple-xcode-versions-installed)

根据我在 Snow Leopard 上的经验/研究，我没有发现任何关于运行 Xcode 4.5 或 iOS6 的积极结果。我坚持使用 4.2 并暂时在单独的 Lion 机器上运行 4.5，直到我能够升级。我在连接到 Xcode 4.2 时使用我的 iOS6 设备进行测试也没有成功（一条消息是“没有兼容操作系统的设备”），所以我也必须将设备连接到单独的 Lion 机器。

如果你的新 iMac 已经在路上了，我想你会省去很多麻烦，只是坚持下去，而不是试图陪审团安装 Snow Leopard 机器。一旦我更新到 Mountain Lion，我的项目从 4.2 到 4.5 的转换非常快速和容易。

# ios - uiscrollview 不会取消 uisegmentedcontrol 的内容触摸

> ID：14342511
> 
> 赞同：1
> 
> 时间：2013-01-15T16:43:56.733
> 
> 标签：ios, uiscrollview, uisegmentedcontrol, touches

我已经继承了 UIScrollView 并通过以下方式覆盖了 touchesShouldCancelInContentView: 方法：

```
-(BOOL)touchesShouldCancelInContentView:(UIView *)view

{
    if ([view isKindOfClass:[UIButton class]] || [view isKindOfClass:[UISegmentedControl class]]) {
        return YES;
    }

    if ([view isKindOfClass:[UIControl class]]) {
        return NO;
    }

    return YES;
} 
```

它适用于 UIButton，但不适用于 UISegmentedControl。任何帮助，将不胜感激

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T17:53:00.367

终于想通了。必须继承 UISegmentedControl 和 UIScrollView。

1.) 为 UISegmentedControl 添加了一个新属性：

```
@property (nonatomic, assign) BOOL touchProcessed; 
```

2.) 重载了 UISegmentedControl 的以下方法：

```
-(void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event
{
    if (touchProcessed) {
        [super touchesBegan:touches withEvent:event];
    }
    else {
        [self.nextResponder touchesBegan:touches withEvent:event];
    }
    self.touchProcessed = NO;
}

-(void)touchesMoved:(NSSet *)touches withEvent:(UIEvent *)event
{
    [self.nextResponder touchesMoved:touches withEvent:event];
}

-(void)touchesEnded:(NSSet *)touches withEvent:(UIEvent *)event
{
    [self.nextResponder touchesEnded:touches withEvent:event];
} 
```

3.) 重载了 UIScrollview 的以下方法：

```
-(BOOL)touchesShouldCancelInContentView:(UIView *)view
{ 
    if ([view isKindOfClass:[self class]])
    {
        return YES; //if there are two nested custom scrollviews  
    }

    if ([view isKindOfClass:[UIButton class]] || [view isKindOfClass:[CustomSegmentedControl class]] || [[view superview] isKindOfClass:[CustomSegmentedControl class]]) {
        return YES;
    }

    if ([view isKindOfClass:[UIControl class]]) {
        return NO;
    }

    return YES;
}

-(void)touchesEnded:(NSSet *)touches withEvent:(UIEvent *)event
{
    if (!self.dragging) {
        for (UIView *sv in self.subviews) {
            if ([sv isKindOfClass:[CustomSegmentedControl class]])
            {   //if there is more than one add a tag or tomething
                [(CustomSegmentedControl *)sv setTouchProcessed:YES];
                [sv touchesBegan:touches withEvent:event];
                return;
             }
        }
    }
} 
```

完美运行！

# php - 如何停止显示敏感错误？

> ID：14342514
> 
> 赞同：0
> 
> 时间：2013-01-15T16:44:06.977
> 
> 标签：php, error-handling

我知道完全禁用显示错误（例如通过设置`error_reporting(0)`）是一个坏主意，但是有没有办法至少阻止系统路径在实时网站上显示？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T16:46:43.430

在您的生产环境中启用 error_reporting 绝对没有任何问题，只需确保它仅在您的日志中显示`display_errors`为关闭即可。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T16:47:08.763

您可以保留错误报告并使用`ini_set('display_errors',0);`，以便它们不会显示但仍会记录在错误日志中。

# actionscript-3 - 在 AS3 中控制锚点/曲线

> ID：14342515
> 
> 赞同：0
> 
> 时间：2013-01-15T16:44:09.417
> 
> 标签：actionscript-3

我一直在寻找一种方法来控制路径中的曲线和/或锚点，例如使用 curveTo 绘制。

基本上，当我画这样的东西时：

```
thingy.graphics.curveTo(220,100,150,140);
thingy.graphics.curveTo(60,200,50,300);
thingy.graphics.curveTo(40,495,250,500);
thingy.graphics.curveTo(460,495,450,300); 
```

当我在函数中执行某些操作（例如拖动锚点）时，我想动态更改这些曲线。换句话说，我只是想更新某个曲线的坐标，比如：

覆盖

```
thingy.graphics.curveTo(220,100,150,140); 
```

至

`thingy.graphics.curveTo(120,100,250,670);`

或者

`thingy.graphics.curveTo(220,100,mouseX,mouseY);`

例如。

在谷歌搜索我的问题的答案时，我只能找到具有非常复杂公式的长文章，大多数时候甚至没有任何 AS3 代码。由于我对数学不是很好，我更喜欢一个简单的答案，它只是显示一种方法来做到这一点。

或者，我不介意控制在 Flash IDE 中绘制的曲线，如果这样更容易的话。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T17:13:12.693

这是我将如何处理它。

```
private var curveVals:Array = [];

private var thingy:Sprite;

public function constructor() {
   thingy = new Sprite();

   var obj:Object = {cx:220,cy:100,ax:150,ay:140}
   curveVals.push(obj);
   thingy.graphics.curveTo(220,100,150,140);

   obj = {cx:60,cy:200,ax:50,ay:300}
   curVals.push(obj);
   thingy.graphics.curveTo(60,200,50,300);
}

private function storeVals(cx,cy,ax,ay,index):void {
    var obj:Object = {cx:cx,cy:cy,ax:ax,ay:ay};
    curveVal[index] = obj;
    redraw();
}

private function redraw():void {
    thingy.graphics.clear();
    // loop through values and redraw
} 
```

# java - quoting strings in Java

> ID：14342517
> 
> 赞同：-2
> 
> 时间：2013-01-15T16:44:23.023
> 
> 标签：java, string

Does anyone know of a library function to escape and surround a string value of an object with quotes unless it is null?

For example, the function should process:

*   `"hello"` as `"\"hello\""`
*   `null` as `"null"`
*   `Long.valueOf(2L)` as `"\"2\""`
*   `""` as `"\"\""`
*   `"I\'m \"quoted\""` as `"\"I\\\'m \\\"quoted\\\""`

Clearly this is trivial to implement in Java, but I'm looking for a function in an existing library (e.g. JDK, Commons Lang, Spring ...) I'd be surprised if this hasn't been done before.

For reference, this is for converting objects to JavaScript strings.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T17:47:56.867

Forget the Quoting, really. If you want to write Java to JS, use Jackson:

```
import java.util.Date;

import org.codehaus.jackson.map.ObjectMapper;

public class Teste {

    /**
     * @param args
     */
    public static void main(String[] args) throws Exception {
        printAsJs(null);
        printAsJs(5L);
        printAsJs("Hello!");
        printAsJs(new Date());
    }

    private static final ObjectMapper OBJECT_MAPPER = new ObjectMapper();

    public static void printAsJs(Object o) throws Exception {
        System.out.println(OBJECT_MAPPER.writeValueAsString(o));
    }

} 
```

If you need extra handlers to format as JS, extend ObjectMapper with your desired needs

Thank you come again

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T16:46:02.590

You can write your own using StringUtils.

```
import static org.apache.commongs.lang.StringUtils.*;
import org.apache.commons.lang.StringEscapeUtils.*;

public void quote(String x) {
  return escapeJavaScript(defaultString(x, "null").replaceFirst("^(.*)$", "\"$1\"")));
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T17:09:47.997

Your requirements are

*   Surround output with quotes
*   Escape quotes
*   Handle `null` different (no surrounding quotes)

I don't know any library method fulfilling your requirements.

Anyway, it can be implemented with a one line method:

```
public static String quoteAndEscape(Object o) {
    return o == null ? "null" : "\"" + StringEscapeUtils.escapeJava(String.valueOf(o)) + "\"";
} 
```

# java - 网络通讯发送键盘快捷键

> ID：14342519
> 
> 赞同：0
> 
> 时间：2013-01-15T16:44:39.387
> 
> 标签：java, network-programming

我可以向计算机发送键盘快捷键`ALT`+`P`以唤醒因暂停而停止的应用程序吗？我可以通过使用 echo 服务发送一个字符串来打破这个暂停吗？

谢谢

Windows 操作系统上的编程语言 java

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T10:53:27.163

为什么不创建一个从网络接收一些命令并唤醒应用程序的 actionListener？

通过网络进行的任何通信基本上都是数据包，数据包只能包含数据。因此，接收端本身必须有代码，根据从网络收到的一些消息来打破暂停。

因此，您不能直接通过网络传递键盘中断。实现这一目标的壁橱（正如评论中已经提到的）是 VNC、Teamviewer 等。

# joomla - 在 joomla 中创建选择

> ID：14342524
> 
> 赞同：1
> 
> 时间：2013-01-15T16:45:00.777
> 
> 标签：joomla, joomla2.5

我对 joomla 2.5 有点困惑

我有一个带有名称、描述和类别的组件（产品）。我想做一个选择来找到选择类别的产品......

在前端的视图中我展示了所有的产品，我在这里放了一个选择

```
<?php echo JHTML::_('select.genericlist', $options,'myfilter', 'class="inputbox"','value','text'); ?>
<?php if($this->items) : ?>
    <div class="items">
        <ul class="items_list">
            <?php foreach ($this->items as $item) :?>                
        <li><?php echo $item->nombre; ?></li>
                <li><?php echo $item->descripcion; ?></li>
                <li><?php echo $item->nivel; ?></li>
            <?php endforeach; ?> 
```

但是如果我选择一项选择，我不知道如何调用控制器和模型

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T08:31:14.003

您需要：

*   `<select>`用`<form>`标签包裹你
*   将代码的第一行替换为：

> < ?php echo JHTML::_('select.genericlist', $options, 'myfilter', 'class="inputbox" onchange="this.form.submit()"' ,'value', 'text'); ?>

*   编写您的控制器和模型。可以在以下位置找到一个很好的教程：

[http://docs.joomla.org/Developing_a_Model-View-Controller_Component/2.5/Introduction](http://docs.joomla.org/Developing_a_Model-View-Controller_Component/2.5/Introduction)

*   设置适当的参数以将 joomla 指向正确的控制器。例如：

> ```
> <input type="hidden" name="option" value="com_helloworld" />
> <input type="hidden" name="task" value="updhelloworld.submit" /> 
> ```

# hibernate - 为什么 JPA 中 @SequenceGenerator 注释的默认 allocationSize 属性为 50？

> ID：14342527
> 
> 赞同：4
> 
> 时间：2013-01-15T16:45:10.843
> 
> 标签：hibernate, jpa, sequence

当我意识到 @SequenceGenerator 的 thge allocationSize 属性的默认值为 50 时，我正在查看休眠源。

根据消息来源...

```
/**
 * (Optional) The amount to increment by when allocating
 * sequence numbers from the sequence.
 */
int allocationSize() default 50; 
```

知道为什么这是 50 而不是 1 吗？这是否意味着默认情况下您的主键将变为 1、50、100、150 等？在我看来，增加 1 更常见并且更有意义？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T16:51:43.567

今天下午我随机发现了[这个讨论](https://community.jboss.org/thread/107819?tstart=0&_sscc=t)，在那里你可以找到[Emmanuel Bernard](https://community.jboss.org/people/epbernard)的一篇文章，指出这是一个效率问题，尽管不是人们期望的行为。

# mysql - mysql 查询是否有可能返回真/假而不是值？

> ID：14342535
> 
> 赞同：15
> 
> 时间：2013-01-15T16:45:27.190
> 
> 标签：mysql, boolean

我有一张桌子：

```
custID    orderID    orderComponent
=====================================
1          123        pizza
1          123        wings
1          234        breadsticks
1          239        salad
2          456        pizza
2          890        salad 
```

我有一份价值清单——比萨饼、鸡翅、面包棒和沙拉。如果客户至少有一条记录包含这些记录，我需要一种方法来获取真/假值。这可能与 mysql 查询，还是我只需要`select distinct(orderComponent)`为每个用户做一个并使用 php 来检查结果？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-01-15T17:00:22.297

如果您只是想查看客户是否订购了所有商品，那么您可以使用：

```
select t1.custid,
  case when t2.total is not null 
    then 'true'
    else 'false'
  end OrderedAll
from yourtable t1
left join
(
  select custid, count(distinct orderComponent) Total
  from yourtable
  where orderComponent in ('pizza', 'wings', 'breadsticks', 'salad')
  group by custid
  having count(distinct orderComponent) = 4
) t2
  on t1.custid = t2.custid 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!2/0782fd/8)

如果您想扩展它，查看是否`custid`已在一个订单中订购了所有商品，那么您可以使用：

```
select t1.custid,
  t1.orderid,
  case when t2.total is not null 
    then 'true'
    else 'false'
  end OrderedAll
from yourtable t1
left join
(
  select custid, orderid, count(distinct orderComponent) Total
  from yourtable
  where orderComponent in ('pizza', 'wings', 'breadsticks', 'salad')
  group by custid, orderID
  having count(distinct orderComponent) = 4
) t2
  on t1.custid = t2.custid
  and t1.orderId = t2.orderid 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!2/bbcf5/5)

如果您只需要 custid 和真/假值，则可以添加`distinct`到查询中。

```
select distinct t1.custid,
  case when t2.total is not null 
    then 'true'
    else 'false'
  end OrderedAll
from yourtable t1
left join
(
  select custid, count(distinct orderComponent) Total
  from yourtable
  where orderComponent in ('pizza', 'wings', 'breadsticks', 'salad')
  group by custid
  having count(distinct orderComponent) = 4
) t2
  on t1.custid = t2.custid 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!2/0782fd/9)

或者通过 custid 和 orderid：

```
select distinct 
  t1.custid,
  t1.orderid,
  case when t2.total is not null 
    then 'true'
    else 'false'
  end OrderedAll
from yourtable t1
left join
(
  select custid, orderid, count(distinct orderComponent) Total
  from yourtable
  where orderComponent in ('pizza', 'wings', 'breadsticks', 'salad')
  group by custid, orderID
  having count(distinct orderComponent) = 4
) t2
  on t1.custid = t2.custid
  and t1.orderId = t2.orderid 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!2/bbcf5/6)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-15T16:51:12.810

```
select case when 
count(distinct orderComponent) = 4 
then 'true' 
else 'false' 
end as bool
from tbl
where custID=1 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-15T17:13:19.663

这是一种方法。此方法不需要内联视图（派生表），如果您想包含多个条件的标志，则可能会很有效：

## 编辑：

这将返回`custID`所有四个项目都有一行：

```
SELECT t.custID
     , MAX(IF(t.orderComponent='breadsticks',1,0))
       + MAX(IF(t.orderComponent='pizza',1,0))
       + MAX(IF(t.orderComponent='salad',1,0))
       + MAX(IF(t.orderComponent='wings',1,0)) AS has_all_four
  FROM mytable t
 GROUP BY t.custID
HAVING has_all_four = 4 
```

* * *

## 原始答案：

（这会检查包含所有四个项目的客户“订单”，而不仅仅是“客户 ID”。）

```
SELECT t.custID
     , t.orderID
     , MAX(IF(t.orderComponent='breadsticks',1,0))
       + MAX(IF(t.orderComponent='pizza',1,0))
       + MAX(IF(t.orderComponent='salad',1,0))
       + MAX(IF(t.orderComponent='wings',1,0)) AS has_all_four
  -- , MAX(IF(t.orderComponent='breadsticks',1,0)) AS has_breadsticks
  -- , MAX(IF(t.orderComponent='pizza',1,0)) AS has_pizza
  -- , MAX(IF(t.orderComponent='salad',1,0)) AS has_salad
  -- , MAX(IF(t.orderComponent='wings',1,0)) AS has_wings
  FROM mytable t
 GROUP BY t.custID, t.orderID
HAVING has_all_four = 4 
```

这将获得包含所有四个项目的“订单”。如果您只想返回 custID 的值，则将上面的查询用作内联视图（将其包装在另一个查询中）

```
SELECT s.custID
  FROM (
         SELECT t.custID
              , t.orderID
              , MAX(IF(t.orderComponent='breadsticks',1,0))
                + MAX(IF(t.orderComponent='pizza',1,0))
                + MAX(IF(t.orderComponent='salad',1,0))
                + MAX(IF(t.orderComponent='wings',1,0)) AS has_all_four
             FROM mytable t
            GROUP BY t.custID, t.orderID
           HAVING has_all_four = 4
       ) s
 GROUP BY s.custID 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-15T16:52:34.930

@EmmyS：你可以双向进行。如果您想使用 MySql 进行检查，请使用：

```
SELECT @rowcount:=COUNT(*) FROM orderComponent Where (Your Conditions);
IF (@rowcount > 0) THEN
    'True'
ELSE
    'False'
END IF 
```

# vb.net - 一行中的异步调用方法

> ID：14342536
> 
> 赞同：0
> 
> 时间：2013-01-15T16:45:27.890
> 
> 标签：vb.net, asynchronous, lambda

我只是想在 VB 的一行中异步执行一个原本阻塞的方法。

```
Dim action As New Action(Sub() MessageBox.Show("Hello"))
action.BeginInvoke(Nothing, Nothing) 
```

在 C# 中：

```
(new Action(() => MessageBox.Show("Hello"))).BeginInvoke(null, null); 
```

翻译成VB

```
(New Action(Sub() MessageBox.Show("Hello"))).BeginInvoke(nothing, nothing) 
```

不编译。以括号开头的行时出现语法错误。

有什么解决办法吗？如果是，是什么？如果没有，为什么不呢？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T16:50:53.583

我刚刚尝试过，没有遇到任何问题：

```
Dim a = (New Action(Sub() MessageBox.Show("Hello"))).BeginInvoke(Nothing, Nothing) 
```

# c++ - 从 C++03 迁移到 C++11

> ID：14342549
> 
> 赞同：7
> 
> 时间：2013-01-15T16:46:31.750
> 
> 标签：c++, gcc, c++11

> **可能重复：**
> [C++11 中引入了哪些重大更改？](https://stackoverflow.com/questions/6399615/what-breaking-changes-are-introduced-in-c11)

我已经阅读了很多关于 C++11 或 C++0x 的内容，目前，我有 2 个平均规模的项目正在开发中。

其中一个使用 Qt 框架，另一个使用 Poco。在他们两个中，我们都使用默认模式（C++03）的 GCC。

我认为 Qt 和 Poco 都使用 C++03 规范编写，但我想知道是否可以`--std=c++0x`在我们的项目中启用并使用没有任何特殊不兼容性的新功能？

是否有人在 C++11 项目中使用大型 C++03 库（特别是 Qt 和 Poco）并面临一些问题，如果是，哪些问题？

***注意：这不是重复的问题。我特地讲两个著名的框架Qt和Poco。有人可能会说“根据我的经验，不要将 Qt 的 X 类与 C++11 的这个 Y 新特性一起使用......”***

# ruby-on-rails - git push heroku master 权限被拒绝

> ID：14342553
> 
> 赞同：54
> 
> 时间：2013-01-15T16:46:50.813
> 
> 标签：ruby-on-rails, git, heroku

我正在关注 ruby​​.railstutorial。我运行命令“git push heroku master”，它吐出这个错误。

```
Permission denied (publickey).
fatal: Could not read from remote repository.
Please make sure you have the correct access rights
and the repository exists. 
```

我在我的 Rails 应用程序“/Users/lexi87/rails_projects/first_app”中。有什么解决办法吗？

* * *

## 回答 #1

> 赞同：71
> 
> 时间：2013-01-15T18:06:44.233

避免此类错误的最佳方法是使用一对公钥/私钥，而不是 Heroku 的额外密钥。这样您（或您的系统）就不会选择错误的密钥来登录 heroku。

如果您收到此错误，则说明您做错了什么。检查这个网站：[https ://devcenter.heroku.com/articles/keys](https://devcenter.heroku.com/articles/keys)

如果您遇到此错误，最好的方法是删除不必要的密钥并仅使用一个。

如果您的系统上需要多个密钥对，您可以为 heroku 设置一个密钥。这是通过以下命令完成的：

```
heroku keys:add 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2014-03-24T11:47:59.137

对安装了 Github Windows 客户端的 Windows 7 用户的一些帮助：

即使 heroku toolbelt 报告它找到了我的 git_hub 公钥并上传了它，“git push heroku master”还是失败了。采取以下步骤后，它工作正常。

1.  如果不存在，请在您的用户文件夹下创建 .ssh 文件夹。如果是这样，请删除其中的所有文件（这假设您可以使用 ssh 密钥从头开始）。

2.  在 Windows 资源管理器中，右键单击 .ssh 文件夹，然后从上下文菜单中选择 Git bash。它与 Github Windows 客户端软件一起安装。

3.  在 bash 窗口中输入 `ssh-keygen -t rsa -C "yourname@email.com`“ 提示时输入密码（不要丢失）。

4.  关闭 bash shell 窗口。

5.  从项目根目录中的 cmd 提示符中，输入`heroku keys:add`. 这将找到您刚刚从 /.ssh 文件创建的密钥并将其上传到 Heroku。

现在您可以输入`git push heroku master`将您的应用程序推送到 Heroku。注意：完成后，您需要将新生成的 ssh 公钥添加到您的 Github 帐户。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-11-02T21:23:45.467

我遇到了同样的问题。在我的 .ssh 文件夹中，我有一个名为“已知主机”的文件。我一直在尝试删除并创建新的 ssh 密钥，但它不起作用。最后，我删除了 .ssh 中的所有内容，包括“已知主机”，然后使用以下命令创建了一个新的 rsa 密钥：

```
ssh-keygen -t rsa 
```

然后我使用以下方法将这个新密钥添加到heroku：

```
heroku keys:add 
```

然后创建一个新的heroku repo并将我的应用程序推送到它：

```
heroku create
git push heroku master 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2014-05-08T02:23:42.113

```
ssh-keygen -t rsa 
```

以上是可选的，因为您还可以链接到现有密钥。Heroku 将提示在下一步中选择密钥。

```
heroku keys:add 
```

添加新创建的密钥或现有密钥。如果您仍然遇到问题，您很可能需要通过执行以下操作将密钥添加到计算机的 ssh 密钥列表中：

```
ssh-add ~/.ssh/name_of_your_rsa 
```

并确认您的 ssh 已添加

```
ssh-add -l 
```

这应该可以让您访问推送到 Heroku 的远程仓库。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-09-01T20:19:37.343

在 OSX 上，我遇到了同样的问题，我得到了

```
no such identity: /Users/me/.ssh/yourPrivateKey: No such file or directory
Permission denied (publickey).
fatal: Could not read from remote repository.

Please make sure you have the correct access rights
and the repository exists. 
```

我尝试使用 ssh-keygen -t rsa 创建一个新密钥，然后使用 heroku keys:add 添加它，但它没有帮助。

然后我在~/.ssh/中找到了一个名为*config*的文件，里面有：

```
ServerAliveInterval 300
ServerAliveCountMax 3

host heroku.com
    user git
    hostname heroku.com
    identityfile ~/.ssh/yourPrivateKey 
```

因此，我将*yourPrivateKey*更改为我的私钥文件名（默认为*id_rsa*）aa 并且它起作用了:)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-03-23T15:57:59.627

我用

```
ssh-keygen -t rsa 
```

并使用了与 id_rsa 不同的文件名（在我的例子中是 heroku）。我添加了heroku的密钥

```
heroku keys:add 
```

在尝试将我的主分支推送到 heroku 时，我总是收到以下错误：

> **$ git push heroku master** 无法确定
> 主机“heroku.com (50.19.85.132)”的真实性。
> RSA 密钥指纹为
> 8b:48:5e:67:0e:c9:16:47:32:99:87:0c:1f:c8:60:bb。您确定要
> 继续连接（是/否）？是 警告：将
> 'heroku.com,50.19.85.132' (RSA) 永久添加到已知主机列表中。权限
> 被拒绝（公钥）。致命：无法从远程存储库中读取。
> 
> 请确保您具有正确的访问权限并且存储库存在。

正如我注意到的，git 只使用了来自另一个 ssh-access 的我的 id_rsa 密钥（你可以通过你的 git gui：Help -> SSH keys 来检查）。

我将 .ssh 目录*C:\Users\%username%.ssh*重命名为*.ssh.bak*并将我的*heroku*私钥和公钥（从*.ssh.bak*目录）复制到新创建的*.ssh*目录并将其命名为 id_rsa （和 id_rsa.pub)。

现在推送按预期工作：

```
git push heroku master 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-10-13T09:31:27.040

如果您在 Windows 上工作，请务必使用**git-bash**而不是 Powershell/命令提示符。

如果您只想重置 ssh 密钥：

1.  删除用户的 .ssh 目录
2.  打开 git bash
3.  ssh-keygen -t rsa
4.  heroku 键：添加

然后你就可以 git push 了。

# c++ - 通过设置为字符串文字初始化的 C++ 大小的 char 数组导致数组边界溢出

> ID：14342556
> 
> 赞同：0
> 
> 时间：2013-01-15T16:46:59.050
> 
> 标签：c++

我读到，当初始化一个数组时，可以使用字符串文字。但是如果初始化器的列表大于数组的大小，则会捕获错误。

```
#include "stdafx.h"
#include <iostream>
using namespace std;

int _tmain(int argc, _TCHAR* argv[])
{
    char cAr2[3] = "ABC";
    for (int i = 0; i < 3; i++)
        cout<<cAr2[i]<<endl;
    system("pause");

    return 0;
} 
```

好吧，这个例子在我的书中给出。它真的像这样结束：错误C2117：'cAr2'：数组边界溢出。

你能告诉我这里是什么吗：我可以看到一个包含 3 个元素的数组和 3 个元素被放入其中。一切似乎都很好。为什么会出错？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T16:50:00.753

好吧，简单的答案是这样的：如果您要使用初始化程序，请省去一些麻烦并忽略大小。

更长的答案是字符串是以空值结尾的，这意味着在字符串的末尾有一个您看不到的附加字符。因此，您将需要一个大小为 n+1 的数组，其中 n 是您看到的字符数。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-15T16:50:26.120

字符串文字`"ABC"`为您提供“4 的数组`const char`”。有 4 个字符，因为字符串以空字符结尾。也就是说，您的初始化将等同于：

```
char cAr2[] = {'A', 'B', 'C', '\0'}; 
```

空字符隐式附加到字符串的末尾，以便循环遍历数组内容的算法知道何时停止，而无需明确给出字符串长度。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-15T16:49:05.130

对于“ABC”字符串，大小 3 不够大：

```
 char cAr2[3] = "ABC"; 
```

您需要至少 4 个字符来存储带有空终止符的字符串

即使您的编译器自动更正（我不确定），缩小数组大小也不是一个好主意。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2013-01-15T16:53:11.417

如果您想使用字符串文字进行初始化，我认为您需要执行以下操作：

```
char *cAr2 = "ABC"; 
```

但是，如果您想保持相同的类型，请执行以下操作：

```
char cAr2[3] = { 'A', 'B', 'C' }; 
```

# c# - 在 .NET 中处理大型 csv 的最有效方法

> ID：14342560
> 
> 赞同：10
> 
> 时间：2013-01-15T16:47:10.387
> 
> 标签：c#, .net, vb.net, search, csv

原谅我的菜鸟，但我只需要一些指导，我找不到另一个可以回答这个问题的问题。我有一个相当大的 csv 文件（约 300k 行），我需要确定给定输入，csv 中的任何行是否以该输入开头。我已按字母顺序对 csv 进行了排序，但我不知道：

1）如何处理csv中的行-我应该将其作为列表/集合读取，还是使用OLEDB、嵌入式数据库或其他东西？

2）如何有效地从一个字母列表中找到一些东西（利用它被排序的事实来加快速度，而不是搜索整个列表）

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-15T17:13:48.357

你没有给出足够的细节来给你一个具体的答案，但是......

* * *

如果 CSV 文件经常更改，则使用 OLEDB 并根据您的输入更改 SQL 查询。

```
string sql = @"SELECT * FROM [" + fileName + "] WHERE Column1 LIKE 'blah%'";
using(OleDbConnection connection = new OleDbConnection(
          @"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=" + fileDirectoryPath + 
          ";Extended Properties=\"Text;HDR=" + hasHeaderRow + "\"")) 
```

* * *

如果 CSV 文件不经常更改并且您对其运行大量“查询”，则将其加载到内存中并每次快速搜索它。

如果您希望搜索与列完全匹配，请使用字典，其中键是您要匹配的列，值是行数据。

```
Dictionary<long, string> Rows = new Dictionar<long, string>();
...
if(Rows.ContainsKey(search)) ... 
```

如果您希望您的搜索是像 StartsWith 这样的部分匹配，那么有一个包含您的可搜索数据的数组（即：第一列）和另一个包含您的行数据的列表或数组。然后使用 C# 内置的二进制搜索[http://msdn.microsoft.com/en-us/library/2cy9f6wb.aspx](http://msdn.microsoft.com/en-us/library/2cy9f6wb.aspx)

```
string[] SortedSearchables = new string[];
List<string> SortedRows = new List<string>();
...
string result = null;
int foundIdx = Array.BinarySearch<string>(SortedSearchables, searchTerm);
if(foundIdx < 0) {
    foundIdx = ~foundIdx;
    if(foundIdx < SortedRows.Count && SortedSearchables[foundIdx].StartsWith(searchTerm)) {
        result = SortedRows[foundIdx];
    }
} else {
    result = SortedRows[foundIdx];
} 
```

**注意**代码是在浏览器窗口中编写的，并且可能包含语法错误，因为它没有经过测试。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-15T16:56:16.457

如果您可以将数据缓存在内存中，并且只需要在一个主键列上搜索列表，我建议将数据作为`Dictionary`对象存储在内存中。该类`Dictionary`将数据作为键/值对存储在哈希表中。您可以将主键列用作字典中的键，然后将其余列用作字典中的值。在哈希表中通过键查找项目通常非常快。

例如，您可以将数据加载到字典中，如下所示：

```
Dictionary<string, string[]> data = new Dictionary<string, string[]>();
using (TextFieldParser parser = new TextFieldParser("C:\test.csv"))
{
    parser.TextFieldType = FieldType.Delimited;
    parser.SetDelimiters(",");
    while (!parser.EndOfData)
    {
        try
        {
            string[] fields = parser.ReadFields();
            data[fields[0]] = fields;
        }
        catch (MalformedLineException ex)
        {
            // ...
        }
    }
} 
```

然后您可以获取任何项目的数据，如下所示：

```
string fields[] = data["key I'm looking for"]; 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-01-15T19:49:37.283

如果您在每个程序运行时只执行一次，这似乎相当快。（根据下面的评论更新为使用 StreamReader 而不是 FileStream）

```
 static string FindRecordBinary(string search, string fileName)
    {
        using (StreamReader fs = new StreamReader(fileName))
        {
            long min = 0; // TODO: What about header row?
            long max = fs.BaseStream.Length;
            while (min <= max)
            {
                long mid = (min + max) / 2;
                fs.BaseStream.Position = mid;

                fs.DiscardBufferedData();
                if (mid != 0) fs.ReadLine();
                string line = fs.ReadLine();
                if (line == null) { min = mid+1; continue; }

                int compareResult;
                if (line.Length > search.Length)
                    compareResult = String.Compare(
                        line, 0, search, 0, search.Length, false );
                else
                    compareResult = String.Compare(line, search);

                if (0 == compareResult) return line;
                else if (compareResult > 0) max = mid-1;
                else min = mid+1;
            }
        }
        return null;
    } 
```

对于 50 兆的 600,000 条记录测试文件，这将在 0.007 秒内运行。相比之下，文件扫描平均超过半秒，具体取决于记录所在的位置。（相差100倍）

显然，如果你不止一次这样做，缓存会加快速度。进行部分缓存的一种简单方法是保持 StreamReader 处于打开状态并重新使用它，每次只需重置最小值和最大值。这将节省您在内存中存储 50 兆的时间。

**编辑：**添加了 knaki02 的建议修复。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-01-15T16:53:18.327

鉴于 CSV 已排序 - 如果您可以将整个内容加载到内存中（如果您需要做的唯一处理是每行上的 .StartsWith() ） - 您可以使用[二进制搜索](http://en.wikipedia.org/wiki/Binary_search_algorithm)来进行异常快速的搜索。

也许是这样的（未经测试！）：

```
var csv = File.ReadAllLines(@"c:\file.csv").ToList();
var exists = csv.BinarySearch("StringToFind", new StartsWithComparer()); 
```

...

```
public class StartsWithComparer: IComparer<string>
{
    public int Compare(string x, string y)
    {
        if(x.StartsWith(y))
            return 0;
        else
            return x.CompareTo(y);
    }
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-06-25T19:34:38.087

为了工作，我很快写了这个，可以改进......

定义列号：

```
private enum CsvCols
{
    PupilReference = 0,
    PupilName = 1,
    PupilSurname = 2,
    PupilHouse = 3,
    PupilYear = 4,
} 
```

定义模型

```
public class ImportModel
{
    public string PupilReference { get; set; }
    public string PupilName { get; set; }
    public string PupilSurname { get; set; }
    public string PupilHouse { get; set; }
    public string PupilYear { get; set; }
} 
```

导入并填充模型列表：

```
 var rows = File.ReadLines(csvfilePath).Select(p => p.Split(',')).Skip(1).ToArray();

    var pupils = rows.Select(x => new ImportModel
    {
        PupilReference = x[(int) CsvCols.PupilReference],
        PupilName = x[(int) CsvCols.PupilName],
        PupilSurname = x[(int) CsvCols.PupilSurname],
        PupilHouse = x[(int) CsvCols.PupilHouse],
        PupilYear = x[(int) CsvCols.PupilYear],

    }).ToList(); 
```

返回一个强类型对象列表

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-01-15T16:56:42.320

**如果您的文件在内存中**（例如因为您进行了排序）并且您将其保存为字符串（行）数组，那么您可以使用简单的**二分搜索**方法。[您可以从CodeReview](https://codereview.stackexchange.com/questions/6338/generic-binary-search)上有关此问题的代码开始，只需更改比较器以使用`string`而不是`int`仅检查每行的开头。

如果您每次都必须重新读取文件，因为它可能会被更改或被另一个程序保存/排序，那么最简单的算法是最好的算法：

```
using (var stream = File.OpenText(path))
{
    // Replace this with you comparison, CSV splitting
    if (stream.ReadLine().StartsWith("..."))
    {
        // The file contains the line with required input
    }
} 
```

当然，您可能每次都**读取内存中的整个文件**（使用 LINQ 或`List<T>.BinarySearch()`），但这**远非最佳**（即使您可能只需要检查几行，您也会读取所有内容）并且文件本身甚至可能太大.

如果您**确实**需要更多的东西，并且由于排序而没有将文件保存在内存中（但您应该根据您的要求**分析**您的实际性能），您必须实现更好的搜索算法，例如[Boyer-Moore 算法](http://www.blackbeltcoder.com/Articles/algorithms/fast-text-search-with-boyer-moore)。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-01-15T17:23:17.863

OP声明真的只需要基于线搜索。

然后问题是是否将这些行保留在内存中。

如果线路为 1 k，则内存为 300 mb。
如果一行是 1 兆，那么 300 GB 的内存。

Stream.Readline 将具有低内存配置
由于它已排序，一旦它大于，您就可以停止查找。

如果你把它放在内存中，那么一个简单的

```
List<String> 
```

使用 LINQ 即可。
LINQ 不够聪明，无法利用这种排序，但针对 300K 仍然会非常快。

BinarySearch 将利用排序。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-01-15T16:55:12.387

试用免费的[CSV 阅读器](http://www.codeproject.com/Articles/9258/A-Fast-CSV-Reader)。无需一遍又一遍地发明轮子；）

1）如果您不需要存储结果，只需遍历 CSV - 处理每一行并忘记它。如果您需要一次又一次地处理所有行，请将它们存储在列表或字典中（当然要使用好键）

2）尝试像这样的通用扩展方法

```
var list = new List<string>() { "a", "b", "c" };
string oneA = list.FirstOrDefault(entry => !string.IsNullOrEmpty(entry) && entry.ToLowerInvariant().StartsWidth("a"));
IEnumerable<string> allAs = list.Where(entry => !string.IsNullOrEmpty(entry) && entry.ToLowerInvariant().StartsWidth("a")); 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-01-15T17:04:46.533

这是我的 VB.net 代码。它适用于 Quote Qualified CSV，因此对于常规 CSV，更改`Let n = P.Split(New Char() {""","""})`为`Let n = P.Split(New Char() {","})`

```
Dim path as String = "C:\linqpad\Patient.txt"
Dim pat = System.IO.File.ReadAllLines(path)
Dim Patz = From P in pat _
    Let n = P.Split(New Char() {""","""}) _
    Order by n(5) _
    Select New With {
        .Doc =n(1), _
        .Loc = n(3), _
        .Chart = n(5), _
        .PatientID= n(31), _
        .Title = n(13), _
        .FirstName = n(9), _
        .MiddleName = n(11), _
        .LastName = n(7), 
        .StatusID = n(41) _
        }
Patz.dump 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-01-16T17:32:46.347

通常我会建议找到一个专用的 CSV 解析器（如[this](http://www.codeproject.com/Articles/9258/A-Fast-CSV-Reader)或[this](https://stackoverflow.com/a/1544743/3043)）。但是，我在您的问题中注意到了这一行：

> 我需要确定给定输入，csv 中的任何行是否以该输入开头。

这告诉我，在确定之前花费在解析 CSV 数据上的计算机时间是浪费时间。您只需要代码来简单地匹配文本，您可以通过字符串比较轻松地做到这一点。

此外，您提到数据已排序。*这应该可以让您大大*加快速度……但是您需要注意，要利用这一点，您需要编写自己的代码来对低级文件流进行搜索调用。这将是*迄今为止**您*表现最好的结果，但它也需要最初始的工作和维护。

 *我推荐一种基于工程的方法，您可以在其中设定性能目标，构建相对简单的东西，然后根据该目标衡量结果。特别是，从我上面发布的第二个链接开始。那里的 CSV 阅读器一次只能将一条记录加载到内存中，因此它应该表现得相当好，而且很容易上手。构建使用该阅读器的东西，并测量结果。*如果他们达到了你的目标，那就停在那里。*

如果它们不符合您的目标，请调整链接中的代码，以便在阅读每一行时首先进行字符串比较（在解析 csv 数据之前），然后只做为那些行解析 csv 的工作匹配。这应该会表现得更好，但只有在第一个选项不符合您的目标时才能完成工作。准备好后，再次测量性能。

最后，如果您仍然没有达到性能目标，我们将进入编写低级代码的领域，以便使用 seek 调用对您的文件流进行二进制搜索。就性能而言，这可能是您能做的最好的事情，但编写代码会非常混乱且容易出错，因此如果您绝对没有达到前面步骤中的目标，您只想去这里.

请记住，性能是一个特性，就像任何其他特性一样，您需要评估相对于实际设计目标如何构建该特性。“尽可能快”不是一个合理的设计目标。“在 0.25 秒内响应用户搜索”之类的东西是真正的设计目标，如果更简单但速度较慢的代码仍然满足该目标，则需要停止。*

# regex - 匹配和替换两个单词之间的单词

> ID：14342568
> 
> 赞同：1
> 
> 时间：2013-01-15T16:48:05.563
> 
> 标签：regex, asp-classic, vbscript

例如，我有这个字符串：

```
one two three four START four five four five six END seven 
```

我想在其中搜索单词“四”以替换为 REPLACED，这将给出

```
one two three four START REPLACED five REPLACED five six END seven 
```

我知道这`START(.*)END`将给出和分隔符之间的单词。我试过`START(?<four>)END`了，但它什么也没给。

我在 Vbscript 工作。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-15T16:55:29.353

`(?<name>`用于命名组。

您需要的是前瞻和后瞻断言来匹配`START.*`和`.*END`前置条件和后置条件，而不是实际匹配它们。

```
Dim input = "one two three four START four five four five six END seven"
Dim output = Regex.Replace(input, "(?<=START.*)four(?=.*END)", "test") 
```

产量：`one two three four START test five test five six END seven`

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-15T16:52:28.033

为什么要使用正则表达式？

```
Dim oldStr = "one two three four START four five four five six END seven"

Dim newStr = oldStr.Replace("four", "REPLACED") 
```

# android - 如何在android中为AutoCompleteTextView设置CustomObject的ArrayList？

> ID：14342570
> 
> 赞同：0
> 
> 时间：2013-01-15T16:48:12.963
> 
> 标签：android, search, filter, arraylist, autocompletetextview

我正在尝试为我的 android 应用程序实现搜索功能。所以，我正在使用`AutoCompleteTextView`. 但是，我正在使用自定义对象的 ArrayList。

这是我的课。

```
public class Vehicle
{
 private String model,manufacturer;
} 
```

现在，我有这些 Vehicle 对象的 ArrayList。

我的问题是，如何使用这些对象数组列表设置为适配器`AutoCompleteTextView`来搜索`model`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T17:05:47.707

> 如何使用这些对象数组列表设置为 AutoCompleteTextView 的适配器以搜索模型？

你没有说你在`Vehicle`课堂上展示了什么。最简单的设置方法`AutoCompletTextView`是使用简单的`ArrayAdapter`（它只会显示`Vehicle`模型中的一个值）并`Vehicle`像这样修改类：

```
public class Vehicle {
 private String model, manufacturer;

 @Override
 public String toString() {
    return model;
 }
} 
```

然后只需将自定义`Vehicle`对象列表提供给`ArrayAdapter`并将适配器设置在`AutoCompleTextView`.

对于比这更复杂的任何事情，您需要提供更多详细信息。

# .htaccess - .htaccess 到带有掩码的目录

> ID：14342572
> 
> 赞同：1
> 
> 时间：2013-01-15T16:48:19.400
> 
> 标签：.htaccess, redirect, drupal-7

我正在尝试创建一个从根目录到名为 /newdrupal7site 的目录的 .htaccess 重定向

这是我所拥有的：

```
RewriteEngine On
RewriteCond %{HTTP_HOST} ^(www.)?mywebsite.com$
RewriteRule ^(/)?$ newdrupal7site [L] 
```

这可行，但 /newdrupal7site 出现在 URL 中，我似乎无法删除它。我也不希望它在您访问网站页面时显示。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T16:54:48.370

试一试：

```
RewriteEngine On

# push requests for site to new dir
ProxyRequests Off
ProxyPass / http://yoursite/newdrupal7site/
ProxyPassReverse / http://yoursite/newdrupal7site/
<Proxy />
  Order deny,allow
  Allow from all
</Proxy>

# redirect base requests
RewriteRule ^/newdrupal7site/(.*)$ /$1 [R=301,NC,L] 
```

# json - 将 json 数据从 mysql 返回到 angular 文件 - 从文本文件工作，但不是从 php

> ID：14342581
> 
> 赞同：2
> 
> 时间：2013-01-15T16:48:41.897
> 
> 标签：json, angularjs

对角度来说非常新 - 目前只是在探索。非常感谢您提供一两个关于我将在哪里拧紧的指针 - TIA

我想做的是从 mysql 选择查询中获取数据并将其返回到 html 页面，使用 json 然后有角度来显示它。已成功使用 JSON_encode 返回数据 - 通过 jsonlint 运行它并且它已经恢复正常。为了测试，然后我使用了这个字符串并创建了一个文本文件，并通过 angular 文件运行它——它工作正常。

如果我直接从 php 文件调用数据，它会失败，但如果我从静态文本文件调用数据（看起来与 php 数据的输出相同），它就可以工作。

我正在发送带有回声的数据 - 这是正确的吗？

```
$json=json_encode($main_arr); 
echo $json; 
```

json输出：

```
[{"custcode":"CMZIG001","cli":"0020\/1"},{"custcode":"CMZIG002","cli":"0020\/2"},{"custcode":"CMZIG003","cli":"0020\/3"},{"custcode":"999","cli":"002871365801"},{"custcode":"CMSLE001","cli":"0030"},{"custcode":"CMNIC001","cli":"0034"},{"custcode":"CMLIF001","cli":"0047"},{"custcode":"CMTON01101","cli":"0087\/1"},{"custcode":"CMTON01102","cli":"0087\/2"},{"custcode":"CMTRE001","cli":"0090"}] 
```

文本文件内容：

```
[{"custcode":"CMZIG001","cli":"0020\/1"},{"custcode":"CMZIG002","cli":"0020\/2"},{"custcode":"CMZIG003","cli":"0020\/3"},{"custcode":"999","cli":"002871365801"},{"custcode":"CMSLE001","cli":"0030"},{"custcode":"CMNIC001","cli":"0034"},{"custcode":"CMLIF001","cli":"0047"},{"custcode":"CMTON01101","cli":"0087\/1"},{"custcode":"CMTON01102","cli":"0087\/2"},{"custcode":"CMTRE001","cli":"0090"}] 
```

回应评论：

好的 - 我希望我的代码不会让你感到厌烦。一个html文件如下（我会尝试正确格式化）

```
<!doctype html>
<html ng-app="App">
<head>
    <meta charset="utf-8">
    <title>CLIs http</title>
    <link rel="stylesheet" href="style.css">
    <script>document.write("<base href=\"" + document.location + "\" />");</script>
     <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.0.2/angular.js">      
</script>
    <script src="app.js"></script>

</head>

<body ng-controller="TodoCtrl">
    <ul>
        <li ng-repeat="cli in cli">
            {{cli.custcode}} - <em>{{cli.cli}}</em>                
        </li>
    </ul>

</body>
</html> 
```

app.js - 当前设置为在我的服务器上调用一个 php 文件

```
var App = angular.module('App', []); 

App.controller('TodoCtrl', function($scope, $http) {

 $http.get('http://localhost/t5/clis.json')
 //$http.get('njs.json') 

.then(function(res){

$scope.cli = res.data;

});

}); 
```

clis.json（我服务器上的 php 文件）

```
$con = mysql_connect("localhost","root","password");
if (!$con)
  {
die('Could not connect: ' . mysql_error());
}
$db='mutuxf';
mysql_select_db($db, $con);

$result = mysql_query("SELECT custcode, cli  FROM clis limit 10");

 while($row = mysql_fetch_assoc($result))
{   
foreach($row as $key => $value)
{    $arr[$key] = $value; }

$main_arr[] = $arr;
}
 $json=json_encode($main_arr); 
 echo $json;

?> 
```

当我使用 php 文件来提高数据时，我只得到一个没有文本的项目符号列表，但是当我使用文本文件 (njs.json) 时，页面可以正常工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T18:43:44.917

首先，我建议从 .then() 切换到 .success() 和 .error()，这样您就知道一切是否顺利。

除此之外，由于问题信息缺乏且非常笼统，我敢打赌服务器上的 json 获取和构建部分是问题所在。 [也许这个链接会有所帮助](http://www.cleverweb.nl/javascript/a-simple-search-with-angularjs-and-php/)

他们获取它的方式：

```
$data = file_get_contents("php://input");
$objData = json_decode($data); 
```

注意评论，这可能是关键：

```
// The request is a JSON request.
// We must read the input.
// $_POST or $_GET will not work! 
```

一般来说-如果您可以选择在后端添加或切换框架，我会推荐 symfony/django 用于 php 或切换到带有 RABL/GON 的 RoR 以生成 json。它更容易和直观。希望它有所帮助，自从我使用香草 php 以来已经有一段时间了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-28T07:28:53.633

这是因为你不能在 .json 文件中运行 php，clis.json 需要是 clis.php 或者你可以让 php 脚本写入一个单独的 json 文件，该文件将保存数据

# php - 随机 product_list 中的自定义图像属性

> ID：14342592
> 
> 赞同：0
> 
> 时间：2013-01-15T16:49:29.733
> 
> 标签：php, magento, magento-1.7

我正在使用 Magento 1.7.0.2，并且正在尝试在随机 product_list 中显示来自我的产品的自定义图像。

首先，我将属性添加到我的所有集合中并设置了一个占位符图像。在数据库中，我搜索了 *used_in_product_listing* 并将其设置为 1。

这是我的**Product_List_Random**类：

```
class Mage_Catalog_Block_Product_List_Random extends Mage_Catalog_Block_Product_List
{
    protected function _getProductCollection()
    {
        if (is_null($this->_productCollection)) { 
            $categoryID = $this->getCategoryId();            
            if($categoryID)            {              
                $category = new Mage_Catalog_Model_Category();
                $category->load($categoryID);
                $collection = $category->getProductCollection();
            } else { 
                $collection = Mage::getResourceModel('catalog/product_collection'); 
            }
            Mage::getModel('catalog/layer')->prepareProductCollection($collection);
            $collection->addAttributeToSelect('*');
            $collection->getSelect()->order('rand()');
            $collection->addStoreFilter();
            $numProducts = $this->getNumProducts() ? $this->getNumProducts() : 0;
            $collection->setPage(1, $numProducts)->load();

            $this->_productCollection = $collection;
        }
        return $this->_productCollection;
    }
} 
```

在这里，我尝试添加`$collection->addAttributeToSelect('*');`以获取前端图像的 url。

这是我迄今为止在**前端**尝试过的：

```
$_productCollection=$this->getLoadedProductCollection();
foreach ($_productCollection as $_product):

    echo $this->helper('catalog/image')->init($_product, 'specialprice_image')->resize(158, 270);

    echo $_product->getResource()->getAttribute('specialprice_image')->getFrontend()->getValue($_product);

    echo $_product->getAttributeText('specialprice_image');

    $product = Mage::getModel('catalog/product')->load($_product->getId()); ?>
    echo $product->getAttributeText('specialprice_image');
endforeach; 
```

助手给了我占位符 url。其他方法没有给我任何东西。

我希望有人可以帮助我解决这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T09:34:18.760

现在它在编辑 Mage_Catalog_Block_Product_List_Random 类后工作

我刚刚删除了两行代码：

```
$collection->addAttributeToSelect('*');
$collection->addStoreFilter(); 
```

完整代码：

```
class Mage_Catalog_Block_Product_List_Random extends Mage_Catalog_Block_Product_List
{
    protected function _getProductCollection()
    {
        if (is_null($this->_productCollection)) { 
            $categoryID = $this->getCategoryId();            
            if($categoryID)            {              
                $category = new Mage_Catalog_Model_Category();
                $category->load($categoryID);
                $collection = $category->getProductCollection();
            } else { 
                $collection = Mage::getResourceModel('catalog/product_collection'); 
            }
            Mage::getModel('catalog/layer')->prepareProductCollection($collection);
            $collection->getSelect()->order('rand()');
            $numProducts = $this->getNumProducts() ? $this->getNumProducts() : 0;
            $collection->setPage(1, $numProducts)->load();

            $this->_productCollection = $collection;
        }
        return $this->_productCollection;
    }
} 
```

在前端我使用这个代码：

```
<a href="<?php echo $_product->getProductUrl() ?>" title="<?php echo $this->htmlEscape($_product->getName()) ?>">
    <img src="<?php echo $this->helper('catalog/image')->init($_product, 'specialprice_image')->resize(158, 270); ?>" width="158" height="270" alt="<?php echo $this->htmlEscape($_product->getName()) ?>" />
</a> 
```

# django - 动态字段和 get_object_or_none

> ID：14342593
> 
> 赞同：0
> 
> 时间：2013-01-15T16:49:31.493
> 
> 标签：django, django-models

我正在使用这个片段[https://gist.github.com/735861](https://gist.github.com/735861)来加密我的模型的 pk。

如果我使用获取单个对象的正常方式，`MyModel.object.get(encrypted_pk=url_pk)`它可以完美地工作。但是，如果我从[这里](https://github.com/ekarulf/django-annoying/blob/master/annoying/functions.py#L5)`get_object_or_none`使用该函数，则会引发以下错误`FieldError. Cannot resolve keyword 'encrypted_pk' into field.`

我怀疑问题出在经理的实施方式上。有什么办法解决吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T11:40:06.690

我认为可以这样解决：

```
class EncryptedPKQuerySet(models.query.QuerySet):
    def filter(self, *args, **kwargs):
        encrypted_pk = kwargs.pop('encrypted_pk', None)
        if encrypted_pk:
            # If found, decrypt encrypted_pk argument and set pk argument to the appropriate value
            kwargs['pk'] = struct.unpack('<Q', self.model.encryption_obj.decrypt(
                struct.pack('<Q', base36decode(encrypted_pk))
            ))[0]
        print kwargs
        return super(EncryptedPKQuerySet, self).filter(*args, **kwargs)

class EncryptedPKModelManager(models.Manager):
    def get_query_set(self):
        return EncryptedPKQuerySet(self.model, using=self._db) 
```

因为在`get_object_or_None`QuerySet 中被构建为`model.manager.all().get(...)`并`all()`返回 QuerySet 实例。

# django - 带有 Celery 的 Django1.4：A. Sqlite3 数据库作为代理可能吗？B. Celery 版本需要安装吗？

> ID：14342601
> 
> 赞同：1
> 
> 时间：2013-01-15T16:50:02.603
> 
> 标签：django, celery, django-celery, django-1.4

在遵循django 项目的[官方 celery 指南](http://docs.celeryproject.org/en/latest/django/first-steps-with-django.html)时，我遇到了各种错误。在详细了解我遇到的错误之前，我想明确以下问题：

1.  您只需要安装`django-celery`还是也需要安装`celery`？这个[官方指南](http://docs.celeryproject.org/en/latest/django/first-steps-with-django.html)没有提到你应该。我已经阅读了安装这两者的指南，而其他的根本没有提到安装普通版`celery`。
2.  我`sqlite3`在我的开发环境中使用我的数据库，你可以使用带有 celery 的 sqlite3 数据库作为代理吗？[该线程](http://www.thebirdietoldme.com/userActions/thread/Question.aspx?id=6959702)中的最后一个人似乎暗示这是不可能的。

我正在使用`django1.4`和`django-celery 3.0.11`

顺便说一句，我遇到的一系列错误中的最新一个是`DatabaseError: no such table: djkombu_queue`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T00:24:39.973

1.  运行`pip install django-celery`也将安装`celery`。

2.  我卸载`south`并删除了表`south_migrationhistory`。然后重新运行`syncdb`，一切都按照文档中的方式进行。我不知道为什么这会导致错误。所以第二个问题的答案是肯定的，`Sqlite3`能不能做芹菜的经纪人。

# php - 从不同的表中提取列并彼此相邻显示

> ID：14342602
> 
> 赞同：1
> 
> 时间：2013-01-15T16:50:03.223
> 
> 标签：php, sql-server

我想从两个相邻的不同表中提取列。

我有如下的php代码：

```
<table>
 <tr>
<th>Date</th>
<th>Performance A </th>
<th>Performance B </th>
</tr>
$sql = "select date, Aperformance from table1 group by date";
$sql1 = "select date, Bperformance from table2 group by date";
$result = mssql_query($sql);
while ($column = mssql_fetch_array($result))

{
echo "<tr><td>".$column[0]."</td>";
echo "<td>".$column[1]."</td></tr>";
} 
```

这会产生如下输出：

```
 Date     | Performance A | Performance B
 01/05/12 | 40%           | 
 02/05/12 | 30%           |
 03/05/12 | 25%           | 
```

现在我想从查询 $sql1 中填写第三列。我不想要 $sql1 中的日期列，第二列 Bperformance 需要放在这里。我怎么能这样做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T17:03:05.383

您可以简单地使用联接，如果其中一个表中没有日期匹配，则使用完全外部联接可以检索行

```
SELECT A.Date , A.APerformance AS [Performance A] , B.BPerformance AS [Performance B]
FROM (
    SELECT Date
        ,APerformance
    FROM Table1
    GROUP BY Date
    ) A
FULL OUTER JOIN (
    SELECT Date
        ,BPerformance
    FROM Table2
    GROUP BY Date
    ) B ON A.Date= B.Date 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T17:01:19.233

假设两个查询返回相同数量的行，您可以简单地执行以下操作：

```
$result1 = mssql_query($sql);
$result2 = mssql_query($sql2);
while($column1 = mssql_fetch_array($result1)) {
    $column2 = mssql_fetch_array($result2);
    echo "<tr><td>$column1[0]</td><td>$column2[0]</td></tr>";
} 
```

如果查询返回不同大小的结果集，那么您将需要做一些额外的工作。

# selenium - 硒。网络驱动程序。IE浏览器。无法评估 //body XPath

> ID：14342603
> 
> 赞同：1
> 
> 时间：2013-01-15T16:50:07.093
> 
> 标签：selenium, selenium-webdriver

我希望有人能指出我正确的方向。我们使用 Selenium Webdriver 2.28 和 Internet Explorer 版本 8。

我们的测试通过下面的方法，定位器参数是 {By.XPath: //body}

```
private IWebElement WaitAndGetElement(By locator)
{
    var wait = new WebDriverWait(_driver, TimeSpan.FromSeconds(Constants.DefaultWaitTimeSecs));
    var elementToWaitFor = wait.Until(driver => driver.FindElement(locator));

    return elementToWaitFor;
} 
```

当代码命中该方法时。下面的异常被抛出。这个问题在 IE 中是完全可以重现的。我们不会在 Chrome 或 FireFox 中遇到此错误。

如果有人能指出我们正确的方向，我们将不胜感激。

非常感谢。克里斯蒂安·克拉克

OpenQA.Selenium.InvalidSelectorException：无法评估 xpath 表达式“//body”或不会生成 WebElement（警告：服务器未提供任何堆栈跟踪信息）

命令持续时间或超时：156 毫秒有关此错误的文档，请访问：[http ://seleniumhq.org/exceptions/invalid_selector_exception.html](http://seleniumhq.org/exceptions/invalid_selector_exception.html)

构建信息：版本：'2.28.0'，修订：'18309'，时间：'2012-12-11 20:21:18' 系统信息：os.name：'Windows 2003'，os.arch：'x86' , os.version: '5.2', java.version: '1.6.0_31' 会话 ID: c72ebe1d-e7f0-4fdb-aab8-9f86b374a89a

驱动程序信息：org.openqa.selenium.ie.InternetExplorerDriver Capabilities [{platform=WINDOWS, javascriptEnabled=true, cssSelectorsEnabled=true, handlesAlerts=true, browserName=internet explorer, nativeEvents=true,takesScreenshot=true, version=8}]

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T19:40:19.073

不是我最喜欢的方法，但尝试将您的`XPath`表达式更改为“.//body”，它很可能适用于这个*'fix'*。

虽然我不建议在 IE 上使用这些定位器，因为即使在 WebDriver 上它们也被证明速度较慢，如果可能的话，使用 CSS 定位器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T20:44:36.197

你是如何获得 XPATH 的？是 Firefox XPATH Checker 插件吗？如果是这样，我建议只将 XPATH 与 Firebug 一起使用。那个似乎与 IE 一起工作的最好的 IMO。在 Firebug 中，一旦您选择了元素，您可以右键单击该元素并选择 Copy XPATH。

# android - android logcat 垃圾邮件错误消息

> ID：14342606
> 
> 赞同：0
> 
> 时间：2013-01-15T16:50:15.447
> 
> 标签：android, logging, usb, logcat, spam

当我连接我的 android 设备时，logcat 会显示很多错误消息并且不会停止发送垃圾邮件。这是正常的吗？有谁知道我能做些什么呢？

日志截图：

![Logcat 示例 #1](../Images/4f4dd25e93d2257942c20ea1ba078316.png)

![Logcat 示例 #2](../Images/0d9f8e16a39149c132cc7b56d7e1e560.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T16:53:10.227

您发布的图像显示与您的应用完全无关的错误消息，除非您正在使用 BOOT_COMPLETE 广播和警报。

您可以使用消息中的标记或使用进程 ID 过滤来简单地过滤掉不是来自您的应用程序的消息。

# iphone - iPhone css悬停，迫使我添加一个触摸事件

> ID：14342607
> 
> 赞同：0
> 
> 时间：2013-01-15T16:50:16.080
> 
> 标签：iphone, css, events, hover, touch

为什么我需要为我的元素添加一个触摸事件以启用悬停样式？这是正常的吗？确实感觉有点不靠谱

这是我必须添加的内容以使 :hover 工作，如果我不没有 :hover 样式设置
*为咖啡脚本抱歉*

```
@button.$el.on('touchstart', ()->
    console.log("touch started")
) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T17:12:21.573

好的，所以我查看*了冷冻豌豆的 Roddy*链接的内容，发现您可以将 'ontouchstart=""' 添加到元素以启用悬停样式。

但我意识到，将它添加到超级父级就足够了，它会冒泡到所有子元素，整洁-O！

# jquery - jquery $.ajax post 在 Firefox 中无法正常工作，但在 Chrome 中正常

> ID：14342608
> 
> 赞同：1
> 
> 时间：2013-01-15T16:50:22.323
> 
> 标签：jquery, ajax, firefox

首先，我有一个 ajax 繁重的页面（通过长时间运行的帖子进行实时聊天和实时数据流）。我正在使用[这个 HTML5 EventSource polyfill](https://github.com/Yaffle/EventSource/blob/master/eventsource.js)资源，它会为我的服务器创建长时间运行的帖子。此外，该页面还集成了[LiveChat](http://www.livechatinc.com/)。

当页面加载时，它会创建 2-3 个事件源连接到我的实时数据服务器。这些是长期运行的帖子，永远不会完成。另外，对于 LiveChat，它最初会做一堆 ajax get，然后定期做 get 来轮询数据。

所以现在用户点击页面上的一个链接，触发一些 javascript，并最终对我的服务器进行 jquery $.post 调用。但是，Firefox 似乎没有进行 ajax 调用。我看到它在 Firebug 中排队，但它永远不会执行它，我的服务器也永远不会看到它。

行为也是随机的。它有时会执行 ajax 发布，但大多数时候不会。它只是排队等候，从不执行。我长期运行的 ajax 帖子会影响这个 ajax 帖子吗？

在 Chrome 中运行良好，所以也许它与 Firefox 和许多长期运行的帖子有关？这是任何人以前经历过的事情吗？Firefox 是否有某种最大连接限制？

**更多更新**

如果我按 ESC，它会取消对服务器的所有现有 ajax 调用，当我单击链接时，它会成功发送 ajax 请求。

# javascript - iOS 从 UIWebView 检索 javascript 变量

> ID：14342609
> 
> 赞同：0
> 
> 时间：2013-01-15T16:50:24.540
> 
> 标签：javascript, ios, objective-c, variables

我有一个带有 < `div`> 的 html 文件，并且我正在加载到 UIWebView 中，我需要知道 div 中有多少行文本，所以我可以使用 javascript 检查：

```
<script>
function countLines() {
    var divHeight = document.getElementById('myDiv').offsetHeight;
    var lineHeight = parseInt(document.getElementById('myDiv').style.lineHeight);
    var lines = divHeight / lineHeight;
    alert("Lines: " + lines);
}
</script> 
```

它确实提醒变量“行”

在 Objective-C 中，如何从我的 UIWebView 中检索此变量，然后在我的代码中使用它？

谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-15T16:58:20.437

UIWebView 方法`stringByEvaluatingJavaScriptFromString:`是 JavaScript 环境的唯一接口。它计算并返回您传递给它的 JavaScript 表达式值的字符串表示形式。因此，例如：

```
// simplified expression, no function needed
NSString *expr = @"document.getElementById('myDiv').offsetHeight / document.getElementById('myDiv').style.lineHeight";
// now pass it to the web view and parse the result
int lines = [[self.webView stringByEvaluatingJavaScriptFromString:expr] intValue]; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-15T16:57:39.087

这很简单：

```
NSString *jsString = @"function countLines() {var divHeight = document.getElementById('myDiv').offsetHeight;var lineHeight = parseInt(document.getElementById('myDiv').style.lineHeight);var lines = divHeight / lineHeight;return lines;};countLines();";

NSString *responseString = [MywebView stringByEvaluatingJavaScriptFromString:jsString]; 
```

而且您应该在 responseString 变量中有值，您可以将其从 NSString 转换为数字:-)

# php - PHP图形编码错误

> ID：14342612
> 
> 赞同：0
> 
> 时间：2013-01-15T16:50:33.987
> 
> 标签：php, netbeans, png, xampp, gd

我在使用 GD - PHP 生成矩形时遇到问题。我在 Netbeans IDE 上运行 XAMPP 和编程。我是 PHP 新手，但对 Perl 很熟悉。

```
<?php
header ("Content-type: image/png");

  $newImg = ImageCreate(250,250);

  $red = ImageColorAllocate($newImg,255,0,0);

  ImageFill($newImg,0,0,$red);

  ImagePNG($newImg);

  ImageDestroy($newImg);
?> 
```

这是输出。

```
<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <title></title>
    </head>
    <body>
‰PNG

IHDRúú²"È~PLTEˆÁÿ·¿~`IDAThíÁ‚ ÿ¯nH@¿ :F¨z’IEND®B`‚    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T16:55:49.353

您需要将 html 填充到一个单独的文件中，并使用`<img>`标签来加载您的 php 脚本，例如

```
<html>

<body>

<img src="yourimagescript.php" />

</body>

</html> 
```

或者，您可以使用 data uris 将图像直接嵌入到 html 中，但这会带来另一组问题，例如

```
<img src="data:image/jpeg;base64,<?php echo base64_encode(imagepng($newImg, '-')) ?>/> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T16:57:04.130

如果您想使用二进制作为图像源，您需要按如下方式使用它：

```
<img src="data:image/png;base64,data..."/> 
```

或者如果您想在示例中使用它，您需要将图像 src 属性指向示例中的 php 脚本

```
<img src="path/to/script.php"/> 
```

和 path/to/script.php"/ 仅显示数据和正确的标题

> ‰PNG
> 
> IHDRúú²"È~PLTE^Áÿ·¿~ `IDAThíÁ‚ ÿ¯nH@¿ :F¨z’IEND®B`‚</p>

# jquery - 这个jQuery效果叫什么

> ID：14342614
> 
> 赞同：1
> 
> 时间：2013-01-15T16:50:49.440
> 
> 标签：jquery

谁能告诉我这个 jQuery 效果是什么。

如果您移动滚动条，则 div**会移动**。

我可以用这个网站演示它。[http://www.theblackeyeproject.co.uk/](http://www.theblackeyeproject.co.uk/)

请你帮忙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T16:54:21.053

使用 jQuery 背景位置：http: [//keith-wood.name/backgroundPos.html](http://keith-wood.name/backgroundPos.html)

结合其他脚本...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T16:56:03.487

它的垂直视差效果

[这是一个例子](http://www.ianlunn.co.uk/blog/code-tutorials/recreate-nikebetterworld-parallax/)/tut：http://www.ianlunn.co.uk/blog/code-tutorials/recreate-nikebetterworld-parallax/

和演示的东西：http: [//ianlunn.co.uk/plugins/jquery-parallax/](http://ianlunn.co.uk/plugins/jquery-parallax/)

# actionscript-3 - URLRequest 在文件为新文件时自行加载，然后触发 NotificationType.CRITICAL

> ID：14342618
> 
> 赞同：0
> 
> 时间：2013-01-15T16:50:54.450
> 
> 标签：actionscript-3, air, flash-cs5

使用 AS3 和 Flash CS5

我有一个带有 URLLoader 的留言板 Adob​​e Air 桌面应用程序，每 2 分钟为“.txt”文件创建一个 URLRequest。或者不管我设定的时间有多长。应用程序将 txt 文件加载到动态文本字段中。

```
var loader:URLLoader = new URLLoader(new URLRequest("https://my_text_file.txt"));
loader.addEventListener(Event.COMPLETE, completeHandler);

function completeHandler(event:Event):void {
    var loadedText:URLLoader = URLLoader(event.target);
    myText_txt.htmlText = loadedText.data;
} 
```

是否可以让 URLRequest 仅在新文件时才加载文件？不是每次？

然后当“新”文件被加载时

```
mainWindow.notifyUser(NotificationType.CRITICAL) 
```

所以用户知道有一条新消息？

提前致谢！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T16:58:30.300

```
var loader:URLLoader = new URLLoader(new URLRequest("https://my_text_file.txt"));
loader.addEventListener(Event.COMPLETE, completeHandler);

function completeHandler(event:Event):void {
    var loadedText:URLLoader = URLLoader(event.target);
    if(myText_txt.htmlText!=loadedText.data){
        myText_txt.htmlText = loadedText.data;
            mainWindow.notifyUser(NotificationType.CRITICAL) 
    }else {
        //do nothing
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T17:00:02.787

由于应用程序仍在运行，您只需将旧文本文件与新文本文件进行比较，看看是否有任何更改。

# excel - Excel有计算加拿大联邦假期的功能吗？

> ID：14342619
> 
> 赞同：0
> 
> 时间：2013-01-15T16:50:55.823
> 
> 标签：excel, date, vba

我试图弄清楚如何计算过去/未来的加拿大联邦假日日期以使用`NETWORKDAYS`单元格中的函数。因为假期的日期每年都在变化，有没有可以用来计算的函数或 VBA 代码？

例如，我有一个 10 年的项目，我想计算开始日期和结束日期之间的差异，不包括周末和节假日。

就像，公民假期是在八月的第一个星期一。2011年是1号，2012年是6号。

复活节星期一是 2011 年的 25 日，但 2012 年是 9 日。

因为`NETWORKDAYS`需要确切的假期日期才能工作，所以我需要计算未来的假期日期（未来 10-15 年）

我希望这是有道理的...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T17:23:08.267

您可以使用公式方法轻松制作列表，例如劳动节列表年份仅在 A2 向下和第 2 行的另一列中使用此公式

=日期（A2,9,8）-工作日（日期（A2,9,6））

这将给出相关年份 9 月第一个星期一的日期 - 向下复制公式

编辑：我认为，这是根据您的规则从 2000 年到 2099 年计算的所有假期的[工作簿。](https://www.dropbox.com/s/3g4h9hzpkn687fs/Canada%20holidays.xls)如果您想要 2000 年之前的日期，则只需更改 A 列中的年份，日期将自动更改

我会在范围中添加几个空白列，例如使 C2:M101 = 假期，然后您可以在任何 NETWORKDAYS/WORKDAY 函数中使用该命名范围 - 额外的列将允许您输入任何“临时”假期

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-01-11T04:18:12.973

我知道我有点晚了，但由于某种原因，您的文件的链接没有打开。我很想看看你如何计算加拿大的假期。我找到了以下解决方案：劳动节、复活节、耶稣受难日和维多利亚日，但仍在寻找其他的解决方案。

劳动节=DATE(A2,9,8)-WEEKDAY(DATE(A2,9,6)) 复活节=FLOOR("5/"&DAY(MINUTE(A2/38)/2+56)&"/"&A2, 7)-34 耶稣受难日 =FLOOR(DATE(A2,5,DAY(MINUTE(A2/38)/2+56)),7)-36 维多利亚日 =DATE(A2,5,25)-WEEKDAY(DATE( A2,5,25),3)-(7*(WEEKDAY(DATE(A2,5,25),3)=0)) *** 4 位数年份必须在 A2 ***

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-10-23T05:11:37.490

工作日为周一至周五，节假日除外。

周末期间的一些假期应移至下周一（例如加拿大国庆日、节礼日、新年）或上周五（例如圣诞节）

以下是加拿大安大略省假期的公式，如果财政年度是 FYear

圣日公式

新年 =WORKDAY(DATE(FYear,1,0),1)

家庭日 =DATE(FYear,2,22)-WEEKDAY(DATE(FYear,2,6))

耶稣受难日 =FLOOR(DATE(FYear,5,DAY(MINUTE(FYear/38)/2+56)),7)-36

维多利亚日 =DATE(FYear,5,25)-WEEKDAY(DATE(FYear,5,23))

加拿大日 =DATE(FYear,7,1)+(WEEKDAY(DATE(FYear,7,2))<3)*(3-WEEKDAY(DATE(FYear,7,2)))

CivicDay =DATE(FYear,8,8)-WEEKDAY(DATE(FYear,8,6))

劳动节 =DATE(FYear,9,8)-WEEKDAY(DATE(FYear,9,6))

感恩节 =DATE(FYear,10,15)-WEEKDAY(DATE(FYear,10,6))

圣诞节 =DATE(FYear,12,25)-(WEEKDAY(DATE(FYear,12,26))<3)*WEEKDAY(DATE(FYear,12,26))

节礼日 =DATE(FYear,12,26)+(WEEKDAY(DATE(FYear,12,27))<3)*(3-WEEKDAY(DATE(FYear,12,27)))

下一个新年 =WORKDAY(DATE(FYear+1,1,0),1)

# .net - 在 MSBuild 中生成版本号

> ID：14342620
> 
> 赞同：6
> 
> 时间：2013-01-15T16:50:57.273
> 
> 标签：.net, msbuild, wix, versioning

我们有一个带有 WiX 安装程序和 MSBuild 构建脚本的 C# 解决方案。我们正在从 SVN 迁移到 Git。

作为我们版本号的第四部分，我们想要随着每次构建而提升的东西。到目前为止，我们一直使用 SVN 版本号。MSBuild 脚本定义了一个 ProductVersion 属性，其中包含 SVN 修订号作为构建版本的四个数字的最后一个。但是，我们不能再使用它了，因为我们将不再使用 SVN。

我一直在尝试寻找 SVN 修订号的替代品，但我不知道该使用什么。

*   Jenkins 提供了一个我可以使用的内部版本号，但我不想将我们的版本控制系统绑定到 Jenkins。

*   Jenkins 也提供了时间戳，但不符合微软的版本号限制：它是字母数字的，有点长，而版本中的第 4 个数字应该是 0 到 65535 之间的整数。

*   我们可以将 AssemblyVersion 设置为 1.0.* 并让 .NET 填充其余部分。这适用于我们的程序集，但我找不到将其注入 WiX 的方法。一旦构建完成，我们就可以从其中一个程序集中获取它，但是我们的 MSBuild 脚本使用该`<MSBuild>`任务来立即构建整个解决方案，因此我们被困在需要运行的 Catch-22 中，`<MSBuild>`以便它可以编译一个程序集我们可以使用来获取生成的版本号，但是为了运行`<MSBuild>`，我们首先需要有一个编译好的程序集，以便我们可以从中获取生成的版本号。

*   我可以在 MSBuild 文件中添加一个单独的目标来编译某些东西（任何东西）并从中获取版本号，然后对`<MSBuild>`任务进行实际调用。但这只是感觉不对。

同样，我真的不在乎这个数字是多少，只要它随着每次构建而增加。基于时间戳的东西会很好。有任何想法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-16T00:45:15.427

MSbuild [Community Tasks](https://github.com/loresoft/msbuildtasks)包含一个名为[Version](https://github.com/loresoft/msbuildtasks/blob/master/Source/MSBuild.Community.Tasks/Version.cs)的任务，它提供了一些算法来生成版本号。它非常易于使用和定制。

恕我直言，最好使用一个与您的整个 SDLC 相关联的数字，这样您就可以将部署的产品跟踪到构建结果，并将这些跟踪到 VCS，等等。我会推荐使用 jenkins 内部版本号，就像 Christopher Painter 所做的那样。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T18:16:44.317

您可以使用`!(bind.FileVersion.FileId)`其中`FileId`一个 wxs 文件中定义的 File 元素的 ID 从程序集中获取版本号。

然后让 .NET 生成程序集编号，WiX 将使用它作为 ProductVersion。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-15T23:14:50.113

你为什么不把它和詹金斯联系起来？似乎您希望 Jenkins 管理传递到构建中的属性，包括版本号。这就是我使用 BuildForge、TFS 等人所做的。

# c# - 获取使用依赖注入的类的实例

> ID：14342623
> 
> 赞同：3
> 
> 时间：2013-01-15T16:51:08.037
> 
> 标签：c#, .net, dependency-injection, factory-pattern

我一直在阅读有关*依赖注入*的内容，并且正在了解基础知识。互联网上的大多数示例都解释到这里：

```
public class MyClass
{
    private IDependency _dependency;

    public MyClass(IDependency dependency)
    {
        _dependency = dependency;
    }
} 
```

这样，我们通过*构造函数注入**依赖*。但我不认为继续写是个好主意：

 *```
var myClassInstance = new MyClass(someArgument); 
```

整个代码。我应该使用工厂模式来获取实例吗？

```
public static class MyClassFactory
{
    private static IDependency dependency = DependencyFactory.GetInstance();

    public static MyClass GetInstance()
    {
        return new MyClass(dependency);
    }
} 
```

这是要走的路吗？

我知道使用 DI 容器可以解决问题，但我想了解如何在使用 DI 容器之前将依赖注入合并到我的代码中。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-15T16:54:30.977

依赖注入只是一种模式——你在代码的第一部分实现它（构造函数注入）

现在您可以手动配置依赖项（就像您在第一个示例中所做的那样）或使用可以帮助您的框架（在幕后它会或多或少地做同样的事情）。

模式的价值不是为了避免写下面

`var myClassInstance = new MyClass(dependencyObject);`

而是将原本会耦合的软件层解耦

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-15T16:55:29.533

是的，工厂将是要走的路。事实上，DI 容器实际上只是一个美化的工厂，可以通过 xml（例如在 spring 的情况下）或代码（例如结构图）进行配置*

# winforms - 列表的多线程场景

> ID：14342635
> 
> 赞同：0
> 
> 时间：2013-01-15T16:51:42.163
> 
> 标签：winforms, multithreading, list

我已经阅读了这种模式，但发现它不起作用。我得到一个罕见的例外，即 foreach 中的项目已更改。

lock (mylist) { foreach(var a in myList) {}

myList = new List<>() （或 myList.Clear() ） }

我也试过这个

foreach(var a in myList.ToList() ) { }

这也产生了异常。这个线程中描述了一些其他模式，但我想确认/理解为什么上述模式不起作用我已经阅读了一些关于如何正确锁定列表的信息。该异常并不经常发生——只是非常罕见，而且当时还存在内存泄漏。

1\. 我是否需要在修改 myList 的任何地方都使用锁，或者锁会阻止任何人编辑 mylist？这可能是混乱的根源。

2.

锁定 mylist 和强制转换以及使用 syncroot 有区别吗？

看这里

[在多线程场景中正确锁定 List<T>？](https://stackoverflow.com/questions/1362995/properly-locking-a-listt-in-multithreaded-scenarios)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T18:22:25.443

通常，如果您有一个共享资源，那么您需要锁定一个互斥锁，以在您使用该资源时保护该资源。不管是读还是写都无所谓。如果互斥锁未锁定在您使用共享资源的至少一个地方，那么您就有问题了。例如，如果您只在修改共享资源时锁定它，那么可能某个线程正在读取它，而另一个线程正在修改它——这种情况称为竞争条件。

在您的特定情况下，是的，您需要在修改它的任何地方锁定 mylist。不仅在你修改它的地方，而且在你阅读它的任何地方。

# c# - 如何从一组整数中找到最小的不同组？

> ID：14342639
> 
> 赞同：3
> 
> 时间：2013-01-15T16:51:51.257
> 
> 标签：c#, linq

假设我有一个课程如下......

```
public class IntGroup {
  public string GroupName {get; set;}
  public List<int> Integers {get; set;}
} 
```

...我有几个实例，每个实例都包含一个整数集合。我想找到包含不同整数的最小组。

例如，如果我有以下组......

第 1 组包含 1、2、3
第 2 组包含 4、5、6
第 3 组包含 4、5、9

...然后由于组 1 包含三个不属于任何其他组的整数，它本身就是一组最小的组（在这种情况下，一组一组）。第 2 组和第 3 组一起是另一个最小的集合，因为您需要两个组在一起（因为它们都包含 4 和 5），但它们不需要第 1 组。

我想编写一些 C# 代码来帮助我找到这些最小的组。这是我觉得可以在 Linq 中非常优雅地解决的问题，但我不知道如何解决。

有谁能帮忙吗？顺便说一句，这不是一个家庭作业问题，我是一名 51 岁的程序员，希望解决与构建函数调用树有关的更大问题的一部分，并希望找到树的不同部分。

谢谢你提供的所有帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T17:18:29.327

首先定义这个类：

```
class ValueIEnumerableComparer<T> : IEqualityComparer<IEnumerable<T>>
{
    public bool Equals(IEnumerable<T> x, IEnumerable<T> y)
    {
        return x.SequenceEqual(y);
    }

    public int GetHashCode(IEnumerable<T> obj)
    {
        return obj.Sum(i => i.GetHashCode());
    }
} 
```

然后，您可以使用此链：

```
int[][] groups =
{
    new[] {1, 2, 3}, 
    new[] {4, 5, 6},
    new[] {4, 5, 9}
};
var result = groups.
    GroupBy(array => groups.
        Where(other => array != other).
        SelectMany(other => array.Intersect(other)), 
            new ValueIEnumerableComparer<int>()).
    Select(g => g.ToArray()).
    ToArray(); 
```

它的作用是按数组的交点对数组进行分组，然后只从组中选择数组。定义一个类实现`IEqualityComparer<IEnumerable<T>>`是必要的。如果不定义一个比较器来比较它们的元素，我找不到更好的方法来提取两个序列上的键。它的`GetHashCode()`方法不是很花哨，但适用于这个例子。

它也可以很容易地适应你的情况，但我认为带一个通用的对阅读问题的人更有帮助。

# c++ - Unix：通过名称和进程ID以编程方式检查进程是否存在

> ID：14342641
> 
> 赞同：0
> 
> 时间：2013-01-15T16:51:53.917
> 
> 标签：c++, unix, process, kill

我想定义一个名为：

```
bool checkIfProcessExists(pid_t processId, const std::string &processName)
{
   return 0 == kill(processId, 0);
} 
```

上面代码的缺陷在于它可能会提供误报。（即 processId 实际上确实存在，但它与我感兴趣的进程不同，即“processName”）

我如何更改代码以检查 processId（第一个参数）和 processName（第二个参数）？

我宁愿避免使用“grep”（或相关）的解决方案

# sql - 如何格式化 SSMS 查询结果以便于复制和粘贴？

> ID：14342642
> 
> 赞同：0
> 
> 时间：2013-01-15T16:51:55.867
> 
> 标签：sql, sql-server-2008

我正在使用 SET NOCOUNT ON 并且未选中“在结果集中包含列标题”，但我仍然得到破折号分隔符：

```
1222

------

12234

------

000033

------- 
```

我想要的只是一个没有换行符的垂直数字列表。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T17:47:13.637

大概这是3个陈述？

如果它们是兼容类型并且列匹配，您可以将它们与`union`：

`select 123 union all select 456 union all select 999`

或者将数据插入`#temp`表中，然后从最后选择。

# .net - 将 MultiBinding 与 TemplateBindings 一起使用

> ID：14342644
> 
> 赞同：10
> 
> 时间：2013-01-15T16:52:09.703
> 
> 标签：.net, wpf, xaml, templatebinding

我正在 WPF 中制作自定义控件。我仍在学习 TemplateBinding 的来龙去脉（在自定义控件中经常使用）。

有人认为我注意到的是，我似乎无法在 MulitBinding 中使用 TemplateBinding。

当我尝试这个时：

```
<ComboBox.ItemsSource>
    <MultiBinding Converter="{StaticResource MyMultiConverter}">
        <Binding ElementName="PART_AComboBox" Path="SelectedItem"/>
        <TemplateBinding Property="MyListOne"/>
        <TemplateBinding Property="MyListTwo"/>
    </MultiBinding>
</ComboBox.ItemsSource> 
```

我收到此错误：

> 值“System.Windows.TemplateBindingExpression”不是“System.Windows.Data.BindingBase”类型，不能在此通用集合中使用。
> 参数名称：值

**我错过了什么吗？有没有办法使这项工作？**

这是我要解决的方法，但它有点像黑客：

```
<ListBox x:Name="ListOne" 
         ItemsSource="{TemplateBinding MyListOne}" 
         Visibility="Collapsed" />
<ListBox x:Name="ListTwo" 
         ItemsSource="{TemplateBinding MyListTwo}"
         Visibility="Collapsed" />

<ComboBox.ItemsSource>
    <MultiBinding Converter="{StaticResource DictionaryFilteredToKeysConverter}">
        <Binding ElementName="PART_TextTemplateAreasHost" Path="SelectedItem"/>
        <Binding ElementName="ListOne" Path="ItemsSource"/>
        <Binding ElementName="ListTwo" Path="ItemsSource"/>
    </MultiBinding>
</ComboBox.ItemsSource> 
```

我将 ListBoxes 绑定到依赖属性，然后在我的 mulitbinding 中将元素绑定到列表框的 ItemsSource。

正如我上面所说，这感觉像是一种 hack，**我想知道是否有正确的方法来使用 TemplateBinding 作为组件之一进行 MultiBinding。**

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2013-01-15T17:08:52.833

你可以使用：

```
<Binding Path="MyListOne" RelativeSource="{RelativeSource TemplatedParent}"/> 
```

`TemplateBinding`真的只是上面的一个简写的优化版本。它的使用位置和使用方式非常严格（直接在模板内部，没有分层路径等）。

XAML 编译器在对这类问题提供体面的反馈方面仍然很垃圾（至少在 4.0 中，没有专门为此测试 4.5）。我刚刚有了这个 XAML：

```
<ControlTemplate TargetType="...">
    <Path ...>
        <Path.RenderTransform>
            <RotateTransform Angle="{TemplateBinding Tag}"/>
        </Path.RenderTransform>
    </Path>
</ControlTemplate> 
```

它编译并执行得很好，但没有将值绑定`Tag`到旋转角度。我窥探并看到该属性已绑定，但为零。直觉上（经过多年处理这种烦恼）我将其更改为：

```
<ControlTemplate TargetType="...">
    <Path ...>
        <Path.RenderTransform>
            <RotateTransform Angle="{Binding Tag, RelativeSource={RelativeSource TemplatedParent}}"/>
        </Path.RenderTransform>
    </Path>
</ControlTemplate> 
```

它工作得很好。

# php - 如何在 Smarty 中 foreach 使用递归函数创建的数组变量

> ID：14342645
> 
> 赞同：3
> 
> 时间：2013-01-15T16:52:13.917
> 
> 标签：php, recursion, foreach, smarty

我有一个在 php 中创建的带有递归函数的数组，我不知道有多少维，如何在 Smarty 中使用？

我尝试使用此代码：

```
{foreach $myArr as $items}
    <li>
          {$items.title}
          {if $item.submenu}
                 <ul>
                 {foreach $items.submenu as $items2}
                     <li>{$items2.title}</li>
                 {/foreach}
                 </ul>
          {/if}
    </li>
{/foreach} 
```

但是此代码仅适用于 2 个级别，可能是我的数组有 3 个或 4 个或...级别。

**更新：**

我找到了解决方案，在我的解决方案中我使用了 Smarty 功能：

```
 {function name=menu level=0}
            <ul>
                {foreach $data as $items}
                    <li>
                        <a href="{$items.url}">
                            {$items.title}
                        </a>
                        {if is_array($items.submenu)}
                            {menu data=$items.submenu level=$level+1}
                        {/if}
                    </li>
                {/foreach}
            </ul>
        {/function}

{menu data=$menuItems} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T07:33:12.770

我会采用不同的方法。我的建议：不要用菜单创建数组。创建两个或一个类。

第一类是一个菜单类，它以键/值的方式保存项目。第二类将是一个菜单项。

这样你就可以通过模型中的函数调用和视图中的打印来完成所有必要的迭代/逻辑。

就像是：

```
class Menu {

    protected $_items = array();
    protected $_parent_child = array();

    public function add_menu_item($name, $id, $parent_id) {
        if (array_key_exists($id, $this->_items))
            return;

        $this->_items[$i] = array('name' => $name, 'id' => $id, 'parent' => $parent_id) // model with data
        $this->_parent_child[$parent_id] = $this->_items[$id];
    }

    public function get_nodes_by_parent($id=null /*for root*/) {
        if (array_key_exists($id, $this->_parent_child))
            return $this->_parent_child[$id];

        return array(); // or null or something     
    }

} 
```

菜单模板：

```
{foreach($menuClass->get_nodes_by_parent() as $item ) {
    <ul>
        <li>{$item['name']}</li>
        {include 'sub_cats' id=$item['id'], menuclass=$menuclass}
    </ul>
{endforeach} 
```

子类模板：

```
{foreach($menuClass->get_nodes_by_parent($id) as $item ) {
    <ul>
        <li>{$item['name']}</li>
        {include 'sub_cats' id=$item['id']}
    </ul>
{endforeach} 
```

这还没有完全完成，也没有经过测试。但这将是我的方法。

# c# - 如何在 msbuild 命令行参数中设置 publishName/AssemblyName？

> ID：14342648
> 
> 赞同：5
> 
> 时间：2013-01-15T16:52:23.380
> 
> 标签：c#, msbuild

您要发布的应用程序有两个名称，productName 和 publishName（publishName/AssemblyName 我认为它们是相同的）。您可以在 .csproj 文件中指定这两者。

我想在不使用 MSBuild 的命令行参数更改 .csproj 文件的情况下设置这两者。到目前为止，我已经使用了 msdn 的[这个](http://msdn.microsoft.com/en-us/library/ms165431.aspx)页面，并弄清楚了如何更改产品名称。

```
MSBuild.exe /t:Build /p:ProductName=$productName. 
```

如何以类似的方式更改 publishName？

当我说 publishName 时，我指的是使用 .application 扩展名创建的文件。任何人都知道我需要什么属性 - /p:*？

我还查看了[Stack Overflow 页面](https://stackoverflow.com/questions/10613725/set-application-name-in-msbuild-parameters)并尝试了那里的所有建议，但没有奏效。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2018-02-06T09:59:48.737

为了解决这个问题，我在 .csproj 文件中添加了自己的变量来控制 .exe 的名称（不影响子项目构建的名称）：

```
<!-- Make the assembly name configurable -->
<AssemblyName Condition=" '$(MSBuildAssemblyName)' == '' ">MyDefaultAssemblyName</AssemblyName>
<AssemblyName Condition=" '$(MSBuildAssemblyName)' != '' ">$(MSBuildAssemblyName)</AssemblyName> 
```

如果未在命令行中指定 MSBuildAssemblyName，则使用默认名称 (MyDefaultAssemblyName)。

在命令行上，像这样调用它： msbuild ... /p:MSBuildAssemblyName=MyOverriddenName ...

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-12-03T06:38:32.433

不要包括引号！

```
MSBuild.exe /t:Build /p:ProductName=$productName;AssemblyName=yourNameHere 
```

此外，如果您在同一解决方案中有另一个项目，这将不起作用 - 两者都将获得相同的程序集名称！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T17:24:15.237

尝试以下操作：

```
MSBuild.exe /t:Build /p:ProductName=$productName;AssemblyName="yourNameHere" 
```

这取自[MSBuild 命令行参考](http://msdn.microsoft.com/en-us/library/vstudio/ms164311.aspx)。

# winforms - 从类或接口更新表单

> ID：14342653
> 
> 赞同：1
> 
> 时间：2013-01-15T16:52:39.117
> 
> 标签：winforms, class, interface, controls

我有一个 winform，在上面有几个选项卡上的许多控件。我正在编写逻辑，它将根据用户所做的组合框选择启用/禁用其中一些控件。我猜在 frmMain.vb 中编写逻辑不是最佳实践，所以我想知道是否应该通过以下方式访问表单的控件：

1.  一个接口
2.  通过 frmMain.vb 中由另一个类访问的友元声明的属性，或
3.  其他

欢迎任何帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T17:20:10.083

一般来说，将前端代码绑定到业务逻辑层是一个好主意，这样它就是控制控件启用/禁用的逻辑。如果可能，根据将要禁用的控件对控件进行分组，然后创建一个一次性禁用所有控件的例程，并为其命名，例如`disableAddContactInfoArea()`or `SetAddContactInfoArea(boolean isEnabled)`。在我看来，例行程序将坐在`frmMain.vb`. 需要避免的一件事是将每个单独的控件暴露给另一个类（除非在某种情况下，这就是特定业务流程所需要的全部内容 - 但即使如此，您也应该将其放入例程中并为其命名以方便将来的编辑并且不太复杂）。您的主要目标是管理复杂性（查看 Steve McConnell 的书[Code complete](http://www.stevemcconnell.com/cc.htm)，可能是第 7 章）。

理想的做法是在`public Sub`s 上放几个 s `frmMain.vb`，只在那里做需要做的事情，然后让业务逻辑层在`frmMain`您正在使用的实例上调用这些例程。

# javascript - 使用 underscore.js 根据在数组中看到项目的次数来增加值

> ID：14342657
> 
> 赞同：1
> 
> 时间：2013-01-15T16:52:50.600
> 
> 标签：javascript, underscore.js

我正在尝试更好地学习 JS。

我有以下代码，我试图将其放入 underscore.js 但失败了。

我希望你能指出我哪里出错了。

我正在尝试采用我知道有效的循环，然后使用下划线功能对其进行改进。上面的测试显示了循环，第二个测试是我尝试对 underscore.js 做同样的事情。我失败得很惨！

谢谢

```
 products = [
       { name: "Sonoma", ingredients: ["artichoke", "sundried tomatoes", "mushrooms"], containsNuts: false },
       { name: "Pizza Primavera", ingredients: ["roma", "sundried tomatoes", "goats cheese", "rosemary"], containsNuts: false },
       { name: "South Of The Border", ingredients: ["black beans", "jalapenos", "mushrooms"], containsNuts: false },
       { name: "Blue Moon", ingredients: ["blue cheese", "garlic", "walnuts"], containsNuts: true },
       { name: "Taste Of Athens", ingredients: ["spinach", "kalamata olives", "sesame seeds"], containsNuts: true }
    ];

it("should count the ingredient occurrence (imperative)", function () {
    var ingredientCount = { "{ingredient name}": 0 };

    for (i = 0; i < products.length; i+=1) {
        for (j = 0; j < products[i].ingredients.length; j+=1) {
            ingredientCount[products[i].ingredients[j]] = (ingredientCount[products[i].ingredients[j]] || 0) + 1;
        }
    }

    expect(ingredientCount['mushrooms']).toBe(2);
  });

  it("should count the ingredient occurrence (functional)", function () {
    var ingredientCount = { "{ingredient name}": 0 };

    var ffd = _(products).chain()
              .map(function(x){return x.ingredients;})
              .flatten()
              .reduce(function(memo,x){
                if (x===memo) 
                  {
                    return ingredientCount[memo] = ingredientCount[memo]+1;
                  }
                  else
                  {
                    return ingredientCount[memo] = 0;
                  }

                  })
              .value();

        /* chain() together map(), flatten() and reduce() */

    expect(ingredientCount['mushrooms']).toBe(2);
  }); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T17:06:58.970

你的 reduce 不是很实用。看看它的[文档](http://underscorejs.org/#reduce)！“备忘录”，也称为“累加器”，是上一次迭代返回的值——应该是你的`ingredientCount`地图。

```
var ingredientCount = _.chain(products)
  .pluck("ingredients") // don't use map for that
  .flatten()
  .reduce(function (memo, item) {
       memo[item] = (memo[item] || 0)+1;
       /* alternative:
       if (item in memo)
           memo[item]++;
       else
           memo[item] = 1;
       */
       return memo; // to be used in the next iteration!
  }, {/*"{ingredient name}": 0*/})
  .value(); 
```

请注意`memo === ingredientCount`！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-10T05:13:06.227

我会使用更简单的代码来理解代码，尽管它不起作用：

```
it("should count the ingredient occurrence (functional)", function () {

  var ingredientCount = { "{ingredient name}": 0 };

  var dummy = _(products).chain()
     .pluck("ingredients")
     .flatten()
     .each(function(x) { ingredientCount[x] = (ingredientCount[x] || 0) + 1; })
     .value();

  expect(ingredientCount['mushrooms']).toBe(2);
}); 
```

# javascript - 附加 YouTube 嵌入式视频标题

> ID：14342658
> 
> 赞同：0
> 
> 时间：2013-01-15T16:52:53.600
> 
> 标签：javascript, jquery, regex, youtube

我正在尝试遍历页面中的每个 YouTube 视频（使用`iframe`embed 方法）并使用 jQuery 附加到每个视频的标题。我的 HTML 看起来像这样：

```
<div class="video-wrapper">
  <div class="video-container">
    <iframe src="http://www.youtube.com/embed/qzNSsDD_LzE" frameborder="0" allowfullscreen></iframe>
  </div>
</div>
<div class="video-wrapper">
  <div class="video-container">
    <iframe src="http://www.youtube.com/embed/9bZkp7q19f0" frameborder="0" allowfullscreen></iframe>
  </div>
</div> 
```

jQuery 看起来像这样：

```
var video = $('.video-container');
video.each(function() {
  var youTuberegex = /(?:https?:\/\/)?(?:www\.)?(?:youtu\.be\/|youtube\.com(?:\/embed\/|\/v\/|\/watch\?v=))([\w-]{10,12})/g,
      videoID = youTuberegex.exec($(this).find('iframe').attr('src'))[1];

  $.getJSON('http://gdata.youtube.com/feeds/api/videos/'+videoID+'?v=2&alt=jsonc', function(data){
    var videoTitle = data.data.title;
    video.after('<figcaption>'+videoTitle+'</figcaption>');
  });         
}); 
```

所以，我（试图）拍摄每个视频并使用正则表达式来提取 ID。然后我使用视频提要检索标题，并将其附加到`video-container`.

这是在[jsFiddle](http://jsfiddle.net/cherryflavourpez/AwqWF/)中。如您所见，问题在于每次都附加每个视频的标题。我哪里出错了，这是实现我所追求的有效方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T16:59:52.713

The *video* variable refers to the entire set of objects that match the selector ".video-container" so when you are doing

```
video.after('<figcaption>'+videoTitle+'</figcaption>'); 
```

It is doing that on each one.

What you need to do is something like:

```
video.each(function() {
  var videoBox = $(this)
  var youTuberegex = /(?:https?:\/\/)?(?:www\.)?(?:youtu\.be\/|youtube\.com(?:\/embed\/|\/v\/|\/watch\?v=))([\w-]{10,12})/g,
      videoID = youTuberegex.exec($(this).find('iframe').attr('src'))[1];

  $.getJSON('http://gdata.youtube.com/feeds/api/videos/'+videoID+'?v=2&alt=jsonc', function(data){
    var videoTitle = data.data.title;
    videoBox.after('<figcaption>'+videoTitle+'</figcaption>');
  });         
}); 
```

The videoBox variable points to the specifc div for that video.

# java - 为什么我的 Java 代码会导致 netbeans 冻结

> ID：14342660
> 
> 赞同：0
> 
> 时间：2013-01-15T16:53:05.847
> 
> 标签：java, jsp, netbeans

我一直在做一项工作，当我尝试运行它时，我的 IDE 冻结了，我不得不使用任务管理器将其关闭。

知道为什么吗？我知道这与我使用的迭代器和 while 循环有关。

有人能看出来吗？下面是部分 servlet 代码：

```
try {
        List<FileItem> fields = upload.parseRequest(request);

        Iterator<FileItem> it = fields.iterator();

        //starting conversion from file to sample

        //creating a container to hold the samples
        ArrayList<sample> samplelist = new ArrayList();

        while (it.hasNext()) {

            sample c = new sample();
            FileItem fileItem = it.next();

            c.setFileName(fileItem.getName());
            c.setPayload(fileItem.getString());
            samplelist.add(c);
        }

        //looping through uploaded samples to split code into lines
        for (int i = 0; i < samplelist.size(); i++) {
            sample current = new sample();
            current = samplelist.get(i);

            //splitting whole code block into lines based on ;
            String[] temp;
            temp = current.getPayload().split(";");

            //going through split lines and adding them to the sample's rawcode
            //arraylist after checking for for loops
            for (int j = 0; j < temp.length; j++) {

                // current.Raw_Code.add(temp[j]);
                String current_line = temp[j];

                current.Raw_Code.add(current_line);

            }

        }

//testing
        System.out.print("starting testing");
        for (int i = 0; i < samplelist.size(); i++) {
            sample current = new sample();
            current = samplelist.get(i);
            System.out.print("File name <br/>");
            current.getFileName();
            System.out.print("lines detected <br/>");

            Iterator itr = current.Raw_Code.iterator();

           //this while loop started to cause the problem

             while(itr.hasNext()){
             System.out.print("x");   
             }
        }

    } catch (FileUploadException e) {
        e.printStackTrace();
    }

    out.close();
    return; 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-15T16:55:31.920

就在这儿：

```
while(itr.hasNext()){
    System.out.print("x");   
} 
```

你没有调用`itr.next()`所以迭代器没有迭代。:)`itr.next()`在`while`循环中添加将解决问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T16:57:37.320

你的 while 是一个无限循环 - 迭代器总是 hasNext 因为它从不迭代......所以它一直在继续。

另一方面，每当 IDE 崩溃时，您应该考虑“无限循环，因为它是该编程问题的常见副作用。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-01-15T16:56:10.240

在那个地方缺少 itr.next()

# r - 在数据框中查找条形码并计算发生这种情况的次数，循环非常慢？

> ID：14342661
> 
> 赞同：3
> 
> 时间：2013-01-15T16:53:07.730
> 
> 标签：r, dataframe

我有一个非常慢且无法正常工作的 for 循环，它在 1 data.frame 中查找条形码，然后在另一个 data.frame 中搜索该条形码。第二个 data.frame 的 bar_code 可以多次出现。每次找到条形码时，计数器都应该计算条形码存在的次数，并将条形码的数量写入第一个数据帧。

我的尝试：

```
for(i in 1:length(tcgadataUniek$Tumor_Sample_Barcode)){
  for(j in 1:length(hprdDataSorted$Samples.Int1)){
  count<-0
  if(i==j){
    count<-count+1
  } else {
    count<-count+0
  }
  hprdDataSorted$Samples.Int2<-count[j]
  }
} 
```

第一个 Data.Frame 如下所示（csv）：

```
HUGO.Int1,HUGO.Int2,barcode.Int1
A1CF,APOBEC1,TCGA-B6-A0RS-01A-11D-A099-09
A1CF,TNPO2,TCGA-B6-A0RS-01A-11D-A099-09
A1CF,SYNCRIP,TCGA-B6-A0RS-01A-11D-A099-09
A1CF,KHSRP,TCGA-B6-A0RS-01A-11D-A099-09
A2M,SHBG,TCGA-D8-A1JK-01A-11D-A13L-09
A2M,C11orf58,TCGA-D8-A1JK-01A-11D-A13L-09
A2M,ATF7IP,TCGA-D8-A1JK-01A-11D-A13L-09
AAMP,TH1L,TCGA-A8-A08S-01A-11W-A050-09
AARS,EEF1B2,TCGA-AO-A0JC-01A-11W-A071-09 
```

第二个 Data.frame 包含重复的条形码（csv）

```
Sample_Barcode
TCGA-A8-A08G-01A-11W-A019-09
TCGA-AO-A03O-01A-11W-A019-09
TCGA-AO-A03O-01A-11W-A019-09
TCGA-B6-A0RS-01A-11D-A099-09
TCGA-BH-A0HP-01A-12D-A099-09
TCGA-BH-A0HP-01A-12D-A099-09
TCGA-BH-A18H-01A-11D-A12B-09
TCGA-BH-A18H-01A-11D-A12B-09
TCGA-BH-A18J-01A-11D-A12B-09
TCGA-D8-A1JK-01A-11D-A13L-09
TCGA-E2-A1BC-01A-11D-A14G-09
TCGA-E2-A1BC-01A-11D-A14G-09
TCGA-E9-A1NH-01A-11D-A14G-09
TCGA-E9-A22B-01A-11D-A159-09 
```

如果barcode.Int1（数据帧1）中的条形码在Sample_barcode中是3倍，则脚本应在脚本正在寻找的barcode.Int1旁边添加3。例如：

```
HUGO.Int1,HUGO.Int2,barcode.Int1, number_of_times
A1CF,APOBEC1,TCGA-B6-A0RS-01A-11D-A099-09,5 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-15T16:59:17.113

Paul's comment is very appropriate, it will speed up the merge step significantly. I would use `table` to get the counts of the unique barcodes in your second data.frame and `merge` it onto your first, see below:

```
dat <- structure(list(HUGO.Int1 = c("A1CF", "A1CF", "A1CF", "A1CF", 
"A2M", "A2M", "A2M", "AAMP", "AARS"), HUGO.Int2 = c("APOBEC1", 
"TNPO2", "SYNCRIP", "KHSRP", "SHBG", "C11orf58", "ATF7IP", "TH1L", 
"EEF1B2"), barcode.Int1 = c("TCGA-B6-A0RS-01A-11D-A099-09", "TCGA-B6-A0RS-01A-11D-A099-09", 
"TCGA-B6-A0RS-01A-11D-A099-09", "TCGA-B6-A0RS-01A-11D-A099-09", 
"TCGA-D8-A1JK-01A-11D-A13L-09", "TCGA-D8-A1JK-01A-11D-A13L-09", 
"TCGA-D8-A1JK-01A-11D-A13L-09", "TCGA-A8-A08S-01A-11W-A050-09", 
"TCGA-AO-A0JC-01A-11W-A071-09")), .Names = c("HUGO.Int1", "HUGO.Int2", 
"barcode.Int1"), class = "data.frame", row.names = c(NA, -9L))

dat2 <- structure(list(Sample_Barcode = c("TCGA-A8-A08G-01A-11W-A019-09", 
"TCGA-AO-A03O-01A-11W-A019-09", "TCGA-AO-A03O-01A-11W-A019-09", 
"TCGA-B6-A0RS-01A-11D-A099-09", "TCGA-BH-A0HP-01A-12D-A099-09", 
"TCGA-BH-A0HP-01A-12D-A099-09", "TCGA-BH-A18H-01A-11D-A12B-09", 
"TCGA-BH-A18H-01A-11D-A12B-09", "TCGA-BH-A18J-01A-11D-A12B-09", 
"TCGA-D8-A1JK-01A-11D-A13L-09", "TCGA-E2-A1BC-01A-11D-A14G-09", 
"TCGA-E2-A1BC-01A-11D-A14G-09", "TCGA-E9-A1NH-01A-11D-A14G-09", 
"TCGA-E9-A22B-01A-11D-A159-09")), .Names = "Sample_Barcode", class = "data.frame", row.names = c(NA, 
-14L))

foo <- as.data.frame(table(dat2))
merge(dat, foo, by.x='barcode.Int1', by.y='dat2', all.x=TRUE)

#                   barcode.Int1 HUGO.Int1 HUGO.Int2 Freq
# 1 TCGA-A8-A08S-01A-11W-A050-09      AAMP      TH1L   NA
# 2 TCGA-AO-A0JC-01A-11W-A071-09      AARS    EEF1B2   NA
# 3 TCGA-B6-A0RS-01A-11D-A099-09      A1CF     TNPO2    1
# 4 TCGA-B6-A0RS-01A-11D-A099-09      A1CF   SYNCRIP    1
# 5 TCGA-B6-A0RS-01A-11D-A099-09      A1CF   APOBEC1    1
# 6 TCGA-B6-A0RS-01A-11D-A099-09      A1CF     KHSRP    1
# 7 TCGA-D8-A1JK-01A-11D-A13L-09       A2M  C11orf58    1
# 8 TCGA-D8-A1JK-01A-11D-A13L-09       A2M    ATF7IP    1
# 9 TCGA-D8-A1JK-01A-11D-A13L-09       A2M      SHBG    1 
```

* * *

The data.table version:

```
library(data.table)

foo <- data.table(as.data.frame(table(dat2)))
setnames(foo, c('barcode.Int1', 'Freq'))
setkey(foo, barcode.Int1)

dat <- data.table(dat, key='barcode.Int1')

foo[dat]

#                    barcode.Int1 Freq HUGO.Int1 HUGO.Int2
# 1:                           NA   NA      AAMP      TH1L
# 2:                           NA   NA      AARS    EEF1B2
# 3: TCGA-B6-A0RS-01A-11D-A099-09    1      A1CF   APOBEC1
# 4: TCGA-B6-A0RS-01A-11D-A099-09    1      A1CF     TNPO2
# 5: TCGA-B6-A0RS-01A-11D-A099-09    1      A1CF   SYNCRIP
# 6: TCGA-B6-A0RS-01A-11D-A099-09    1      A1CF     KHSRP
# 7: TCGA-D8-A1JK-01A-11D-A13L-09    1       A2M      SHBG
# 8: TCGA-D8-A1JK-01A-11D-A13L-09    1       A2M  C11orf58
# 9: TCGA-D8-A1JK-01A-11D-A13L-09    1       A2M    ATF7IP 
```

* * *

in "Pure" data.table:

```
dat <- data.table(dat, key='barcode.Int1')
dat2 <- data.table(dat2)
setnames(dat2, 'barcode.Int1')
setkey(dat2, barcode.Int1)

counts <- dat2[, list(count= .N), by=barcode.Int1]

counts[dat] 
```

# php - Symfony2.1/FOSUserBundle - 将登录表单路由改为首页路由（路径：/）

> ID：14342665
> 
> 赞同：1
> 
> 时间：2013-01-15T16:53:22.633
> 
> 标签：php, security, symfony, fosuserbundle

我有一个使用 FOSUserBundle 的 symfony 2.1 项目。捆绑包已正确安装。所有功能都使用默认的 /login 表单正常工作。

但是现在我想将登录表单路由更改为与主页相同（路径：/）。

我试过了：

更改**security.yml - login_path**：

```
firewalls:
    main:
        pattern: ^/
        form_login:
            provider: fos_userbundle
            csrf_provider: form.csrf_provider
            login_path: /
        logout:       true
        anonymous:    true 
```

和**access_control**：

```
access_control:
    - { path: ^/login$, role: IS_AUTHENTICATED_ANONYMOUSLY }
    - { path: ^/register, role: IS_AUTHENTICATED_ANONYMOUSLY }
    - { path: ^/resetting, role: IS_AUTHENTICATED_ANONYMOUSLY }
    - { path: ^/admin/, role: ROLE_ADMIN }        
    - { path: ^/*, role: ROLE_USER }
    - { path: ^/, role: IS_AUTHENTICATED_ANONYMOUSLY } 
```

当我尝试访问主页时，它会进入无限重定向（我假设）

> 页面未正确重定向 Firefox 检测到服务器正在以永远不会完成的方式重定向对该地址的请求。

在 FOSUserBundle 文档中也找不到任何解决此问题的方法。

简而言之：我希望 first_page 充当登录页面。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T17:02:56.030

你有一个重定向循环。

```
access_control:
- { path: ^/login$, role: IS_AUTHENTICATED_ANONYMOUSLY }    #1
- { path: ^/register, role: IS_AUTHENTICATED_ANONYMOUSLY }  #2
- { path: ^/resetting, role: IS_AUTHENTICATED_ANONYMOUSLY } #3
- { path: ^/admin/, role: ROLE_ADMIN }                      #4
- { path: ^/*, role: ROLE_USER }                            #5
- { path: ^/, role: IS_AUTHENTICATED_ANONYMOUSLY }          #6 
```

发生这种情况是因为首先，您在 #5 中告诉访问控制需要**ROLE_USER ，** *然后*再告诉它它还需要**IS_AUTHENTICATED_ANONYMOUSLY**（第 5 条和第 6 条规则都匹配）

访问控制是顺序敏感的，规则按照它们定义的顺序应用，试试：

```
access_control:
- { path: ^/$, role: IS_AUTHENTICATED_ANONYMOUSLY } # NOTE THE $
- { path: ^/login$, role: IS_AUTHENTICATED_ANONYMOUSLY }
- { path: ^/register, role: IS_AUTHENTICATED_ANONYMOUSLY }
- { path: ^/resetting, role: IS_AUTHENTICATED_ANONYMOUSLY }
- { path: ^/admin/, role: ROLE_ADMIN }        
- { path: ^/*, role: ROLE_USER } 
```

我改变了规则

```
- { path: ^/, role: IS_AUTHENTICATED_ANONYMOUSLY } 
```

到开始，所以它之前匹配

```
- { path: ^/*, role: ROLE_USER } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-02T11:05:34.357

我认为你应该改变你的 security.yml `login_path: /`：`login_path: /login`

还有你的 access_control ：

```
{ path: ^/login$, role: IS_AUTHENTICATED_ANONYMOUSLY }    #1
{ path: ^/register, role: IS_AUTHENTICATED_ANONYMOUSLY }  #2
{ path: ^/resetting, role: IS_AUTHENTICATED_ANONYMOUSLY } #3
{ path: ^/admin/, role: ROLE_ADMIN }                      #4 
```

希望这有帮助！

# java - 使用 Smack API 的语音聊天应用程序

> ID：14342666
> 
> 赞同：1
> 
> 时间：2013-01-15T16:53:24.317
> 
> 标签：java, smack

我目前正在使用 Smack API 在 java 中开发一个 IM 应用程序。由于有大量关于 Smack API 的在线资源，我在编写即时消息、群聊和文件共享等简单功能时没有遇到任何问题。我通过 OpenFire 服务器运行它并连接到 Spark 客户端以进行测试。到目前为止都在本地完成。我的问题与Jingle有关，或者只是以某种方式建立语音聊天。是否有任何资源可以帮助我开始使用 Jingle 语音聊天应用程序，或者在替代 API 中实现此功能是否更容易？我不是世界上最好的程序员，我需要一个快速的开始来弄清楚 jingle API。

# configuration - JBoss 7.1.1.Final - Log4j - EAR 文件应用程序 - 日志记录不起作用

> ID：14342668
> 
> 赞同：1
> 
> 时间：2013-01-15T16:53:31.800
> 
> 标签：configuration, log4j, jboss7.x, ear

朋友们，

我发现了一些关于 log4j 配置的细节。

我们确实很少有应用程序已经在 J​​Boss 3.x 上运行，我正在将它们迁移到 JBoss 7.1.1.Final。

很少有WAR 文件、JAR 文件和EAR 文件。我找到了一些在 JBoss 中配置 Log4j 的文档。

它适用于 WAR 文件。尽管如此，我还是无法让它在 EAR 文件上运行。

```
MyApp.ear
    |
    |- META-INF
        |
        |- application.xml
        |- jboss-deployment-structure.xml
    |
    |- lib
        |
        |- *.jar
    |
    |- MyApp1.war
        |- lib
            |
            |- *.jar
        |- WEB-INF
            |
            |- server-config.wsdd
            |- web.xml
            |- classes
    |
    |- MyApp2.war
        |- WEB-INF
            |
            |- ApplicationResources.properties
            |- web.xml
            |- classes
    |
    |- MyApp.jar
        |
        |- META-INF
            |- jboss-service.xml
            |- jboss.xml
        |- com 
```

我不能使用 JBoss 日志，因为它是一个大型应用程序，并且所有类都使用 Log4j。现在，log4j.properties 的最佳位置是什么？

我可以让所有 EAR 类记录到 1 个配置....

```
log4j.appender.file=org.apache.log4j.DailyRollingFileAppender
log4j.appender.file.DatePattern='.'yyyy-MM-dd
log4j.appender.file.File=./../standalone/log/quote.log
log4j.appender.file.MaxFileSize=2000KB
log4j.appender.file.MaxBackupIndex=60
log4j.appender.file.layout=org.apache.log4j.PatternLayout
log4j.appender.file.layout.ConversionPattern=%d{dd.MM.yyyy HH:mm:ss.SSS} [%-5p] - %C{1} - %m%n
log4j.appender.file.Append=false

log4j.rootCategory=DEBUG, file 
```

请给我提意见....

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T16:55:11.113

从您的 log4j.properties 的外观来看，似乎没有真正需要它。你可以配置日志子系统来做你已经在做的事情，并继续使用 log4j 作为你的日志外观。

等价于 a`DailyRotatingFileAppender`将是`periodic-rotating-file-handler`. `periodic-rotating-file-handler`不做的一件事是允许保留文件的大小和数量。不过，添加一个新的处理程序会相当容易。

```
<periodic-rotating-file-handler name="quote" autoflush="true">
    <formatter>
        <pattern-formatter pattern="%d{HH:mm:ss,SSS} %-5p [%c] (%t) %s%E%n"/>
    </formatter>
    <file relative-to="jboss.server.log.dir" path="quote.log"/>
    <suffix value=".yyyy-MM-dd"/>
    <append value="false"/>
</periodic-rotating-file-handler> 
```

# c++ - 无法从共享对象映射段

> ID：14342678
> 
> 赞同：3
> 
> 时间：2013-01-15T16:54:01.637
> 
> 标签：c++, linux, dlopen

我在加载 so 文件时遇到问题。问题是该文件在那里并且具有第二个共享文件。第一个 *.so 加载成功，但第二个给我这个错误：

```
Error Loading prog2.so: prog2.so: failed to map segment from shared object: Cannot allocate memory 
```

更改顺序时，加载 prog2.so 但 prog1.so 面临相同的错误。

请告知应该是什么问题，这之前没有成功。我正在使用这段代码来加载它

```
handle = dlopen( filename, RTLD_LAZY );  

if( !handle )
{
    const char * err = dlerror();
if (err)
    throw err;
} 
```

程序失败，因为句柄正在返回 !handle diff 到 1。

# android - 包括 cordova.js 退出我的应用程序

> ID：14342679
> 
> 赞同：0
> 
> 时间：2013-01-15T16:54:02.833
> 
> 标签：android, cordova, jquery-mobile, webview

当我在 phonegap 应用程序中包含 cordova-2.2..0.js 时，它会在加载 index .html 后退出。尽管进程继续运行。只是gui消失了......不知道如何解决这个问题。在模拟器中工作正常，但在实际设备上崩溃。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T17:59:01.103

1.  首先检查您的**cordova.js**是否在**jquery.js**和**jquery_mobile.js之前加载**

2.  如果最后一点没有帮助剥离您的代码并制作一个基本页面

3.  如果您仍然有问题，那么您的 Cordova 项目有错误。可能是一个加载错误的插件，或者您没有正确设置您的项目（常见问题）。

4.  如果第 2 点解决了您的问题，请检查您的 js 代码，主要是使用 cordova/phonegap 框架的部分。

5.  你用过这条线吗：

    ```
    navigator.app.exitApp(); 
    ```

    如果答案是肯定的，请评论并重试

# symfony1 - symfony 多对多

> ID：14342681
> 
> 赞同：0
> 
> 时间：2013-01-15T16:54:16.920
> 
> 标签：symfony1, symfony-1.4, doctrine-1.2

我正在考虑创建以下场景。

1.  我有很多模板
2.  我有很多用户 (sfGuardUser)
3.  我想要它，所以当我编辑模板时，我可以将许多用户分配给一个特定的用户。

我认为我的架构中需要 3 个表是否正确？

```
Template
User
TemplateUser 
```

并定义其中的关系？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T17:04:54.543

是的，你是对的。示例：[#1](http://symfony.com/legacy/doc/jobeet/1_4/en/03?orm=Doctrine#chapter_03_the_schema) [#2](http://docs.doctrine-project.org/projects/doctrine1/en/latest/en/manual/defining-models.html#many-to-many)

# spring - Hibernate：具有并行插入的 ConstraintViolationException

> ID：14342682
> 
> 赞同：1
> 
> 时间：2013-01-15T16:54:18.000
> 
> 标签：spring, hibernate, transactions, parallel-processing

我有一个简单的休眠实体：

```
@Entity
@Table(name = "keyword",
        uniqueConstraints = @UniqueConstraint(columnNames = { "keyword" }))
public class KeywordEntity implements Serializable {

    private Long id;
    private String keyword;

    public KeywordEntity() {
    }

    @Id
    @GeneratedValue
    @Column(unique = true, updatable=false, nullable = false)
    public Long getId() {
        return this.id;
    }

    public void setId(Long id) {
        this.id = id;
    }

    @Column(name="keyword")
    public String getKeyword() {
        return this.keyword;
    }

    public void setKeyword(String keyword) {
        this.keyword = keyword;
    }
} 
```

DAO 为它：

```
@Component
@Scope("prototype")
public class KeywordDao {

    protected SessionFactory sessionFactory;

    @Autowired
    public void setSessionFactory(SessionFactory sessionFactory) {
        this.sessionFactory = sessionFactory;
    }

    public KeywordEntity findByKeyword(String keyword) throws NotFoundException {
        Criteria criteria = sessionFactory.getCurrentSession()
                .createCriteria(KeywordEntity.class)
                .add(Restrictions.eq("keyword", keyword));
        KeywordEntity entity = (KeywordEntity) criteria.uniqueResult();
        if (entity == null) {
            throw new NotFoundException("Not found");
        }
        return entity;
    }

    public KeywordEntity createKeyword(String keyword) {
        KeywordEntity entity = new KeywordEntity(keyword);
        save(entity);
        return entity;
    }
} 
```

和一项服务，它将所有内容置于`@Transactional`：

```
@Repository
@Scope("prototype")
public class KeywordService {

    @Autowired
    private KeywordDao dao;

    @Transactional(readOnly = true)
    public KeywordEntity getKeyword(String keyword) throws NotFoundException {
        return dao.findByKeyword(keyword);
    }

    @Transactional(readOnly = false)
    public KeywordEntity createKeyword(String keyword) {
        return dao.createKeyword(keyword);
    }

    @Transactional(readOnly = false)
    public KeywordEntity getOrCreateKeyword(String keyword) {
        try {
            return getKeyword(keyword);
        } catch (NotFoundException e) {
            return createKeyword(keyword);
        }
    }
} 
```

在单线程环境中，这段代码运行得很好。问题，当我在多线程环境中使用它时。当有许多并行线程使用相同的关键字时，其中一些线程同时使用相同的关键字调用，`getOrCreateKeyword`并且会发生以下情况：

2个线程同时使用相同的关键字调用关键字服务，都首先尝试获取现有关键字，都没有找到，都尝试创建新的。第一个成功，第二个 - 导致`ConstraintViolationException`被抛出。

所以我确实尝试改进`getOrCreateKeyword`了一点方法：

```
@Transactional(readOnly = false)
public KeywordEntity getOrCreateKeyword(String keyword) {
    try {
        return getKeyword(keyword);
    } catch (NotFoundException e) {
        try {
            return createKeyword(keyword);
        } catch (ConstraintViolationException ce) {
            return getKeyword(keyword);
        }
    }
} 
```

所以理论上它应该可以解决问题，但在实践中，一旦被抛出，就会在另一个 Hibernate 异常中`ConstraintViolationException`调用结果：`getKeyword(keyword)`

```
AssertionFailure - an assertion failure occured (this may indicate a bug in Hibernate, 
but is more likely due to unsafe use of the session)org.hibernate.AssertionFailure: 
null id in KeywordEntity entry (don't flush the Session after an exception occurs) 
```

如何解决这个问题呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T17:11:17.997

您可以使用某种悲观锁定机制来使用数据库/休眠，或者如果您在单台机器上运行，您可以使服务方法 getOrCreateKeyword() 同步。

这里有一些参考。

休眠文档[http://docs.jboss.org/hibernate/core/3.3/reference/en/html/transactions.html#transactions-locking](http://docs.jboss.org/hibernate/core/3.3/reference/en/html/transactions.html#transactions-locking)

本文展示了如何从查询结果中锁定特定实体和所有实体，这可能会对您有所帮助。 [http://www.objectdb.com/java/jpa/persistence/lock#Locking_during_Retrieval_](http://www.objectdb.com/java/jpa/persistence/lock#Locking_during_Retrieval_)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-29T09:21:22.917

解决方案是一旦发生就丢弃当前会话`ConstraintViolationException`并在新会话中再次检索关键字。[Hibernate Documentation](http://docs.jboss.org/hibernate/core/3.5/javadocs/org/hibernate/Session.html)也指出了这一点：

> 如果 Session 抛出异常，则必须回滚事务并丢弃会话。异常发生后，Session的内部状态可能与数据库不一致。

# passenger - 碾过乘客时系统命令不起作用

> ID：14342691
> 
> 赞同：3
> 
> 时间：2013-01-15T16:54:46.327
> 
> 标签：passenger

我有一个 sinatra 应用程序，其页面显示有关该应用程序的一些信息。其中一些是通过在页面加载时运行命令生成的。在 unicorn 中运行时，在我的 MacBook 上一切正常，在 unicorn 中运行时，在生产服务器上一切正常，但切换到 Apache/Passenger，突然命令开始返回 nil。

例如，要获取我使用的提交者列表：

```
comitters = `cd /path/to/app && git shortlog -s -n` 
```

在 apache/passenger 设置中运行之前，这非常有效。

乘客中是否有一些选项可以禁用系统命令？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T23:18:22.567

问题在于您的 $PATH 环境变量，系统使用它来查找命令。你从外壳运行独角兽，不是吗？所以 Unicorn 从你的 shell 继承 $PATH 。但是从 Phusion Passenger 启动的应用程序进程是从 Apache/Nginx 启动的，而这些进程通常是从一些系统 init 服务启动的，这些服务的环境变量与您的 shell 完全不同。阅读[http://blog.phusion.nl/2008/12/16/passing-environment-variables-to-ruby-from-phusion-passenger/](http://blog.phusion.nl/2008/12/16/passing-environment-variables-to-ruby-from-phusion-passenger/)以获得解决方案。

# visual-studio-2010 - 团队基础 2010 只读工作项用户帐户不匹配

> ID：14342695
> 
> 赞同：1
> 
> 时间：2013-01-15T16:54:53.907
> 
> 标签：visual-studio-2010

我正准备第三次将我的 TFS 2010 数据库移动到其最终的永久服务器，但是，我遇到了一个非常烦人的用户问题。当我恢复新系统作为测试时，我将我的 Visual Studio IDE 连接到新服务器（与旧服务器同名）并测试并让该系统正常工作。现在，当我转到旧服务器时，我可以连接并查看所有内容 - 但我不再有权创建工作项或编辑项。

我可以使用 Visual Studio 2012 以及 Microsoft Test Center 2010 来编辑项目。我以前在家中使用本地系统 tfs 遇到过这种情况，并通过更改我在计算机上登录的用户名然后为该新用户名添加权限来解决它。

由于这些用户 id 是工作站帐户，而不是域帐户，因此每个系统都有自己的用户 guid，即使它们可能具有相同的帐户名。我注意到在 VS 2010 中，历史中的工作项显示由未知用户修改 - 但是它具有 VS2012 中的用户名。似乎连接到这两个系统可能会以某种方式使我的域用户帐户和工作组用户帐户之间的用户匹配中断。

我即将滚动到新服务器，并且担心我的用户群将无法修改 VS2010 中的项目。我不能使用以前的解决方法，因为我不能让每个人都创建一个新的用户名。

任何帮助将不胜感激 - 因为我确信我不是唯一一个以前遇到过这个问题的工作组而不是域 tfs 系统的人。

# generics - 如何比较泛型类型的值？

> ID：14342698
> 
> 赞同：3
> 
> 时间：2013-01-15T16:55:07.777
> 
> 标签：generics, sml

考虑这样的代码：

```
fun equals(a : 'a,b : 'a) =
  a = b; 
```

我的代码更大，但这就是问题所在。SML 报告“错误：运算符和操作数不一致”。

我是 SML 的初学者，我不知道它为什么会抱怨。这是否类似于 C# 问题，您不能真正比较任何类型的两个值，但您必须对类型使用默认相等比较器？我应该添加一些约束`'a`（我希望我将它正确地写为泛型类型）？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-15T17:42:19.973

而不是`'a`，使用`''a`.

前面有两个引号而不是一个的类型是相等类型，这意味着`=`运算符对其进行操作。不过，这也意味着您不能在非相等类型的事物上调用您的函数。

此外，您实际上不必编写类型。如果你只是这样做：

```
fun equals (a,b) = a = b; 
```

SML 将推断类型。

# node.js - 生产代码中的猫鼬索引

> ID：14342708
> 
> 赞同：139
> 
> 时间：2013-01-15T16:55:24.503
> 
> 标签：node.js, mongodb, mongoose

根据和/的Mongoose[文档](http://mongoosejs.com/docs/guide.html)：`MongooseJS``MongoDB``Node.js`

> 当您的应用程序启动时，Mongoose 会自动调用`ensureIndex`您架构中定义的每个索引。虽然很适合开发，但建议在生产中禁用此行为，因为创建索引会导致显着的性能影响。`autoIndex`通过将架构的选项设置为 false 来禁用该行为。

这似乎指示在部署之前从 mongoose 中删除自动索引，以优化 Mongoose 从指示 Mongo 在应用程序启动时遍历所有索引，这似乎是有道理的。

在生产代码中处理索引的正确方法是什么？也许外部脚本应该生成索引？或者，`ensureIndex`如果单个应用程序是集合的唯一读取器/写入器，则可能是不必要的，因为每次发生数据库写入时它都会继续索引？

**编辑：**作为补充，MongoDB 为如何进行索引提供了很好的*文档*[，](http://docs.mongodb.org/manual/core/indexes/#index-creation-options)但没有提供明确索引指令的*原因*或*时间。*在我看来，索引应该由编写器应用程序自动在具有现有索引的集合上保持最新，这实际上更像是一次性的事情（在应用新索引时完成），在这种情况下，猫鼬应该是no-op 下服务器正常重启。***`ensureIndex``autoIndex`***

 **** * *

## 回答 #1

> 赞同：151
> 
> 时间：2013-01-15T21:05:15.023

我一直不明白为什么 Mongoose 文档如此广泛地建议`autoIndex`在生产中禁用。添加索引后，后续`ensureIndex`调用将简单地看到索引已经存在，然后返回。所以它只会在你第一次创建索引时对性能产生影响，那时集合通常是空的，所以无论如何创建索引都会很快。

我的建议是保持`autoIndex`启用状态，除非您遇到给您带来麻烦的特定情况；例如，如果您想向拥有数百万个文档的现有集合添加新索引，并且您希望更好地控制它的创建时间。

* * *

## 回答 #2

> 赞同：43
> 
> 时间：2015-06-03T09:51:29.047

虽然我同意接受的答案，但值得注意的是，根据[MongoDB 手册](http://docs.mongodb.org/v2.6/core/index-creation/#performance)，这不是在生产服务器上添加索引的推荐方法：

> 如果您的应用程序包含 ensureIndex() 操作，并且不存在其他操作问题的索引，则构建索引可能会对数据库的性能产生严重影响。
> 
> 为避免性能问题，请确保您的应用程序在启动时使用 getIndexes() 方法或驱动程序的等效方法检查索引，并在不存在正确索引时终止。在指定的维护窗口期间，始终使用单独的应用程序代码在生产实例中构建索引。

当然，这实际上取决于您的应用程序的结构和部署方式。例如，如果您正在部署到 Heroku，并且您没有使用 Heroku 的[预启动功能](https://devcenter.heroku.com/articles/preboot)，那么您的应用程序很可能在启动期间根本没有服务请求，因此此时创建索引可能是安全的。

除此之外，从接受的答案：

> 所以它只会在你第一次创建索引时对性能产生影响，那时集合通常是空的，所以无论如何创建索引都会很快。

如果您第一次就成功地确定了您的数据模型和查询，这很好，而且通常是这样。但是，如果您要向应用程序添加新功能，并在没有索引的属性上使用新的数据库查询，您通常会发现自己将索引添加到包含许多现有文档的集合中。

这是您需要小心添加索引并仔细考虑这样做的性能影响的时候。例如，您可以[在后台创建索引](http://docs.mongodb.org/v2.6/core/index-creation/#background-construction)：

```
db.ensureIndex({ name: 1 }, { background: true }); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-05-07T09:04:22.957

使用此块代码来处理生产模式：

```
const autoIndex = process.env.NODE_ENV !== 'production';
mongoose.connect('mongodb://localhost/collection', { autoIndex }); 
```***

# java - Android，setVisibility/动画问题

> ID：14342714
> 
> 赞同：5
> 
> 时间：2013-01-15T16:55:29.790
> 
> 标签：java, android, animation

我有一个`linearLayout`按钮，当我按下按钮时它消失了，当我再次按下按钮时它又回来了。但是它做得太快了，看起来不太好。我通过以下方式做到这一点：

```
disappearView.setVisibility(View.GONE); 
```

我想添加一些动画......如果我只是将可见性设置为不可见，布局所在的空间仍然存在。所以我尝试了这个：

```
if (disappearView.getVisibility() == View.VISIBLE){
            Animation out = AnimationUtils.makeOutAnimation(this, true);
            disappearView.startAnimation(out);
            disappearView.setVisibility(View.INVISIBLE);
            disappearView.setVisibility(View.GONE);

        }
        else {
            Animation in = AnimationUtils.loadAnimation(this, android.R.anim.fade_in);
            disappearView.startAnimation(in);
            disappearView.setVisibility(View.VISIBLE);      
        } 
```

这会使动画过快并消失。你根本看不到它。我需要在设置`gone`后使用线程启动`invisible`......还是延迟？或者有没有更好的方法来做这一切？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-01-15T17:14:20.480

我不确定您到底要完成什么...您是否希望 LinearLayout 在一段时间内淡出而不是立即消失？然后一旦它淡出通过 View.GONE 从父级中删除？

如果是这样，您可以使用 AlphaAnimation 进行淡出，然后附加一个像 EvZ 发布的监听器：

```
AlphaAnimation fadeOutAnimation = new AlphaAnimation(1, 0); // start alpha, end alpha
fadeOutAnimation.setDuration(1000); // time for animation in milliseconds
fadeOutAnimation.setFillAfter(true); // make the transformation persist
fadeOutAnimation.setAnimationListener(new AnimationListener() {         
    @Override
    public void onAnimationEnd(Animation animation) {
        linearLayout.setVisibility(View.GONE);
    }

    @Override
    public void onAnimationRepeat(Animation animation) { }

    @Override
    public void onAnimationStart(Animation animation) { }
});

linearLayout.setAnimation(fadeOutAnimation); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-15T17:00:30.467

您可以尝试使用`onAnimationEnd`：[Animation.AnimationListener](http://developer.android.com/reference/android/view/animation/Animation.AnimationListener.html#onAnimationEnd%28android.view.animation.Animation%29)

# c# - 在 Designer 中无法修改 WinForm 上的控件

> ID：14342720
> 
> 赞同：6
> 
> 时间：2013-01-15T16:55:39.760
> 
> 标签：c#, winforms, visual-studio, infragistics

我继承了一个项目，该项目以我无法撤消的方式进行了修改。窗体上的每个控件都不能在设计器中修改，除非通过“属性”窗口，并且每个控件在下面的区域（见图）中都有一个图标，该区域通常为不可见的项目（例如数据源）保留。如何撤消此操作并将设计器返回到可用版本，而无需将其全部清除并重新开始？

![控制图标](../Images/d0a945fe755727ee13493558ca960800.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-21T11:15:12.760

您必须加载包含无法在设计器中修改的控件的 dll。

步骤是：

*   在 Visual Studio 设计器的工具箱中单击鼠标右键（例如在 General 上）。

*   选择选择项目...

*   一段时间后，vs加载项目按浏览并选择感兴趣的dll，而不是组件应该出现在网格中。对包含您感兴趣的控件的所有 dll 执行此操作。

    -确保您已检查组件（如果您加载了很多组件，请使用过滤器文本框）。

*   按确定。

    现在您应该可以在设计器中移动控件了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T18:45:13.410

可以锁定控件吗？我遇到过遗留代码，其中程序员锁定了每个控件，这意味着您无法在设计器中移动或调整它们的大小。如果是这样，请将它们全部选中并将`Locked`属性更改为 false（如果它们被锁定，则当您选择它们​​时，您还应该在设计器中看到一个挂锁。

如果没有，那么也许您可以创建一个新的对话框/表单并将控件复制到其中，看看是否可以解决问题。另一个技巧可能是添加用户控件的第二个实例，以查看新添加的控件是否按预期工作。如果是这样，请检查代码并将所有事件/逻辑指向新控件（乏味是的，但可能会起作用）。

此外，您永远不能在设计器中为您实例化用户控件的表单/控件编辑用户控件的各个子控件。您必须转到用户控件的设计器来编辑用户控件的各个（子）控件。

![在此处输入图像描述](../Images/b6be440006401516820fc39e83b37797.png)

![在此处输入图像描述](../Images/8374677bb4137e427c0131b4df5fa40d.png)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-16T10:07:09.003

如果 Infragistics 控件显示在组件托盘中，则可能存在版本差异。您可以尝试打开 licenses.licx 文件并从中删除内容。您的机器上是否安装了 Infragistics 控件？将 Infragistics 程序集的“特定版本”属性设置为“false”后有什么不同吗？

这是否仅在您现有的项目中发生，或者相同的行为在新项目中也可以重现？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-05-15T10:10:39.277

当用户控件或表单被错误地标记为“组件”时，我也看到了这种行为。

对 .csproj 文件进行一些手动破解可能就是答案。在文本编辑器中打开项目文件，并找到对您的控件的引用。如果您发现一个子类型定义为：

```
<Compile Include="MyControl.cs">
  <SubType>Component</SubType>
</Compile> 
```

表单设计者会这样解释它。您可以将“SubType”更改为“UserControl”来修复它。

# c# - 从 Windows 服务 C# 启动的新进程的安全上下文

> ID：14342723
> 
> 赞同：0
> 
> 时间：2013-01-15T16:55:45.087
> 
> 标签：c#, windows, multithreading, service, process

我有一个在登录名“UserA”下运行的 Windows 服务。Windows 服务的工作是在计时器经过的事件上启动一个新进程。

```
private void timer_Elapsed(object sender, ElapsedEventArgs e)
{
    Task.Factory.StartNew(() => StartNewProcess());
}

private void Initialize()
{
    newProcess = new Process();
    newProcess.StartInfo.FileName = "Test.exe";
    newProcess.StartInfo.Arguments = "sessionId...";
    newProcess.StartInfo.CreateNoWindow = false;
    newProcess.StartInfo.ErrorDialog = false;
    newProcess.StartInfo.RedirectStandardError = true;
    newProcess.StartInfo.RedirectStandardInput = true;
    newProcess.StartInfo.UseShellExecute = false;
    newProcess.StartInfo.WindowStyle = ProcessWindowStyle.Hidden;            
}

private void StartNewProcess()
{
    newProcess.Start();
} 
```

在任务管理器上，我看到 Windows 服务和新进程都有一个“用户名”作为“UserA”。

但问题是 Windows 服务能够访问“C:\QueryResult”，但新进程无法访问“C:\QueryResult”

我`File.Copy("C:\QueryResult", "D:\blahblah")`在这两个过程中都使用

新流程中的安全上下文是否发生了变化？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T17:15:33.323

尝试像这样自动提升应用程序权限：

```
using Microsoft.Win32;
using System;
using System.Diagnostics;
using System.IO;
using System.Runtime.InteropServices;
using System.Security.Principal;
using System.Windows.Forms;

public static class Program
{
    [STAThread]
    public static void Main()
    {
        if (!IsAdmin() && IsWindowsVistaOrHigher())
            RestartElevated();
        else
            DoStuff();
    }

    private static Boolean IsAdmin()
    {
        WindowsIdentity identity = WindowsIdentity.GetCurrent();

        if (identity != null)
            return (new WindowsPrincipal(identity)).IsInRole(WindowsBuiltInRole.Administrator);

        return false;
    }

    private static Boolean IsWindowsVistaOrHigher()
    {
        OperatingSystem os = Environment.OSVersion;
        return ((os.Platform == PlatformID.Win32NT) && (os.Version.Major >= 6));
    }

    private static void RestartElevated()
    {
        String[] argumentsArray = Environment.GetCommandLineArgs();
        String argumentsLine = String.Empty;

        for (Int32 i = 1; i < argumentsArray.Length; ++i)
            argumentsLine += "\"" + argumentsArray[i] + "\" ";

        ProcessStartInfo info = new ProcessStartInfo();

        info.Arguments = argumentsLine.TrimEnd();
        info.CreateNoWindow = false;
        info.ErrorDialog = false;
        info.FileName = Application.ExecutablePath;
        info.RedirectStandardError = true;
        info.RedirectStandardInput = true;
        info.UseShellExecute = false;
        info.Verb = "runas";
        info.WindowStyle = ProcessWindowStyle.Hidden; 
        info.WorkingDirectory = Environment.CurrentDirectory;

        try
        {
            Process.Start(info);
        }
        catch { return; }

        Application.Exit();
    }
} 
```

# wpf - 带有附加事件的 Caliburn，目标失败

> ID：14342727
> 
> 赞同：0
> 
> 时间：2013-01-15T16:55:53.957
> 
> 标签：wpf, mvvm, caliburn

好的，所以我正在尝试将附加事件添加到控件。现在 Caliburn 并不天真地支持这一点，但我[使用了另一篇文章中的代码，该文章](https://stackoverflow.com/questions/8402339/using-attached-events-with-caliburn-micro-message-attach)似乎提供了一种解决方法。我基本上需要一种方法来添加这种代码`this.AddHandler(RadDragAndDropManager.DragInfoEvent, new EventHandler<DragDropEventArgs>(OnDragInfo), true);`，但 caliburn 不支持附加事件。这是我的代码：

```
<telerik:RadTreeView Height="250" Name="Root" Width="300" ItemTemplate="{StaticResource BusinessEntityTemplate}" IsDragDropEnabled="true"  cal:Action.TargetWithoutContext="{Binding Source={x:Static RelativeSource.Self}}">
    <i:Interaction.Triggers>
    <Helpers:RoutedEventTrigger RoutedEvent="{x:Static dragDrop:RadDragAndDropManager.DropQueryEvent}" IncludeHandledEvents="True">
        <cal:ActionMessage MethodName="OnDropQuery">
        <!--<cal:Parameter Value="$eventargs" />-->
        </cal:ActionMessage>
    </Helpers:RoutedEventTrigger>
    </i:Interaction.Triggers>
    </telerik:RadTreeViewItem>-->
</telerik:RadTreeView> 
```

RoutedEventTrigger 定义如下：

```
public class RoutedEventTrigger : EventTriggerBase<DependencyObject>
{
    RoutedEvent _routedEvent;
    public RoutedEvent RoutedEvent
    {
        get { return _routedEvent; }
        set { _routedEvent = value; }
    }
    bool _includeHandledEvents = false;

    public bool IncludeHandledEvents
    {
        get { return _includeHandledEvents; }
        set { _includeHandledEvents = value; }
    }

    public RoutedEventTrigger() { }
    protected override void OnAttached()
    {
        Behavior behavior = base.AssociatedObject as Behavior;
        FrameworkElement associatedElement = base.AssociatedObject as FrameworkElement;
        if (behavior != null)
        {
            associatedElement = ((IAttachedObject)behavior).AssociatedObject as FrameworkElement;
        }
        if (associatedElement == null)
        {
            throw new ArgumentException("Routed Event trigger can only be associated to framework elements");
        }
        if (RoutedEvent != null)
        //{ associatedElement.AddHandler(RoutedEvent, new RoutedEventHandler(this.OnRoutedEvent)); }
        { associatedElement.AddHandler(RoutedEvent, new RoutedEventHandler(this.OnRoutedEvent), this.IncludeHandledEvents); }

    }
    void OnRoutedEvent(object sender, RoutedEventArgs args)
    {
        base.OnEvent(args);
    }

    protected override string GetEventName() { return RoutedEvent.Name; }
} 
```

在我的 ViewModel 中，我只是有一个像这样的处理程序：

```
public void OnDropQuery(object sender, DragDropQueryEventArgs e) {} 
```

当我运行这个时，我得到的错误是`base.OnEvent(args);`关于`No target found for method OnDropQuery.`我正在努力弄清楚为什么这不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T18:35:26.083

发现问题，错误信息不是很明显。viewmodel 上的事件处理程序必须与 xaml 中目标方法的定义相匹配。在这种情况下，通过如下修改 xaml 解决了该问题：

```
 <cal:ActionMessage MethodName="OnDropQuery">
                    <cal:Parameter Value="$source" />
                    <cal:Parameter Value="$eventargs" />
                </cal:ActionMessage> 
```

我也不得不删除`cal:Action.TargetWithoutContext="{Binding Source={x:Static RelativeSource.Self}}"`

# objective-c - 更改 NSImage 原点

> ID：14342733
> 
> 赞同：0
> 
> 时间：2013-01-15T16:56:03.460
> 
> 标签：objective-c, macos, nsimage

是否可以更改 NSImage 的来源？如果是这样，我将如何去做。我在常规笛卡尔坐标系中有一些坐标为负值，我试图在 NSImage 中的相应点绘制它们，但由于原点位于（0,0），所以有些缺失。

编辑：假设我有一个绘图方面需要在点（-10，-10）处对图像进行，目前这没有出现。有没有办法解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T17:58:39.987

如果它就像在 iOS 中一样（您可能需要调整一些代码）并且如果我的记忆力仍然很好，那么您必须这样做，因为`origin`是*readOnly*：
`CGRect myFrame = yourImage.frame;`
`myFrame.origin.x=newX;`
`myFrame.origin.y=newY;`
`yourImage.frame = myFrame;`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T23:47:52.683

我认为您将 NSImage 与它的容器混淆了。NSImage 没有边界或框架，因此没有来源。它确实有一个*大小* ，可以表示其 birtmap 表示的像素尺寸（如果有的话），或者可以表示它的边界框（如果它是矢量图像）。在 (-10,-10) 的像素位置绘制图像实际上没有任何意义。

NSImage 显示在容器中（通常是 NSImageView），容器的 bounds.origin 将指示图像相对于 imageView 的位置，但您不能修改超出位图平面边缘的像素。

在任何情况下，您都可能希望使用子类 NSView，您可以在其中覆盖自定义绘图的 drawRect 方法。NSView*确实*有一个 bounds.origin 但这与您的绘图坐标无关，而是与绘制的内容作为一个整体与视图边界框的位置有关。您将绘制到的坐标系将参考您的*图形上下文*，该上下文将（通常）将原点 (0,0) 固定到左下角 (OSX) 或左上角 (iOS)。如果您尝试在笛卡尔平面上表示负点，则需要应用平移变换将您的点映射到该正坐标空间中。

我试图用几句话来解释，Apple 在他们的[Quartz 2D Programming Guide](https://developer.apple.com/library/mac/#documentation/GraphicsImaging/Conceptual/drawingwithquartz2d/dq_overview/dq_overview.html#//apple_ref/doc/uid/TP30001066-CH202-CJBBAEEC)中详细解释了一些东西。

# c - 是否真的 printf 将前两个赋值作为输入

> ID：14342737
> 
> 赞同：0
> 
> 时间：2013-01-15T16:56:11.817
> 
> 标签：c

我在某处读到 printf 采用程序前两个赋值的值。可以给出任意数量的 printf。它们都只取前两个值。如果程序中给出了更多的赋值，那么 printf 将采用垃圾值。

我不这么认为，但它是在许多网站上给出的，所以只需要确认它

例如，如果您进行简单的 Google 搜索，`"printf takes first two assignment as input"`就会发现有一些网站有示例面试问题/答案，例如：

> 预测以下输出或错误：

```
main()
{
    int i=400,j=300;
    printf("%d..%d");
} 
```

> 答案：400..300
> 
> 解释： printf 取程序前两个赋值的值。可以给出任意数量的 printf。
> 
> 它们都只取前两个值。如果程序中给出了更多的赋值，那么 printf 将采用垃圾值。

这是正确的真实行为吗？还是依赖于实现？

你可以找到这样的问答场所，例如：
[这个拼图网站](http://www.c-puzzles.thiyagaraaj.com/puzzles-a.html)
和[这个面试问题文档](http://www.google.com/url?sa=t&rct=j&q=&esrc=s&frm=1&source=web&cd=2&cad=rja&ved=0CDoQFjAB&url=http%3A%2F%2Fwww.utdallas.edu%2F~veerasam%2Fc_c%2B%2B%2Fweb-download%2FC%2520Interview%2520Questions.docx&ei=S4v1UNHPLsW30AG1sIGICQ&usg=AFQjCNFtT_n5za1F6TX4ggEHK9wzpe56ig&sig2=4_lHjKaaOZZQ_mcgfjoKuQ)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-15T18:36:04.783

不，这绝对不是真的。

有关上下文，请阅读 C11 7.21.6.3/2：

> 该`printf`函数等效于在 printf`fprintf`的参数`stdout`之前插入参数。

因此，根据标准，C11 7.21.6.1/2：

> 该`fprintf`函数将输出写入 stream 指向的流，在 format 指向的字符串的控制下，该字符串指定后续参数如何转换为输出。**如果格式的参数不足，则行为未定义。**[...]

（强调我的）

可能发生的情况是堆栈中的值可能会在`printf()`调用时被拉出。再说一次，由于行为是未定义的，任何事情都可能发生，从打印垃圾值或程序崩溃，到在邻居的并行打印机上打印出蛋糕图片（真的，[任何事情](https://stackoverflow.com/a/908924/492901)）。

除非您的*特定*实现（*特定*的CPU 架构，具有*特定*的编译器和可能的*特定*操作系统）*将特定情况记录*为您可以做的事情，**否则不要这样做**。

您的拼图网站的“拼图”主要是未定义行为和关于实现定义行为的错误假设的组合。有些例子是正确的，但考虑到它大多是坏的，我只是假装我从未见过它。随机的互联网站点往往是学习编程的不好资源，尤其是 C。如果你想学习 C，你应该得到一本关于 C 编程的合适的书（[可以在此处找到](https://stackoverflow.com/tags/c/info)列表）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-15T18:36:21.987

> 这是正确的真实行为吗？还是依赖于实现？

那是未定义的行为。根本无法保证会发生什么。

省略号`...`机制的可能实现`C`可能会导致您在问题中显示的特定评估，尽管它也取决于编译器和优化器。

# sql - Oracle 10g，查看发送到数据库的确切查询

> ID：14342739
> 
> 赞同：0
> 
> 时间：2013-01-15T16:56:12.830
> 
> 标签：sql, oracle10g, trace, enterprise

我有一个来自第三方的应用程序写入 Oracle 数据库。应用程序的一个组件在给定特定参数的情况下不返回数据，而应用程序的另一个组件确实返回具有相同参数的数据。没有人拥有此应用程序的源代码，但可以看出数据库中包含适当的信息。

行为不端的组件`ORA-01403`从 oracle 数据库服务器返回，这意味着没有找到数据，但可能与语法错误有关，正如我安装的数据包嗅探器所看到的那样。

我想查看应用程序的不同组件实际生成的查询的差异。

还想在命令行或其他数据库查看器中运行这些查询以查看返回的内容。

如何使用实际显示正在执行的查询的跟踪来监视数据库？我还想通过 IP 地址或来源隔离这些。

使用 Oracle 10g 企业版

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2016-06-16T09:51:10.557

我发现这适用于 AWS Oracle RDS 实例。我从连接到数据库的 linux 实例运行 tcpdump ...

```
tcpdump tcp port 1521 -s 0 -l -w -  | strings | perl -e '
while(<>) { chomp; next if /^[^ ]+[ ]*$/;
  if(/^(SELECT|UPDATE|DELETE|INSERT|SET|COMMIT|ROLLBACK|CREATE|DROP|ALTER)/i) {
    if (defined $q) { print "$q\n"; }
    $q=$_;
  } else {
    $_ =~ s/^[ \t]+//; $q.=" $_";
  }
}' 
```

希望对其他人有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T17:09:31.347

IIRC，TOAD 会做你想做的事。

此外，还有免费试用版 - [http://www.quest.com/toad-for-oracle/software-downloads.aspx](http://www.quest.com/toad-for-oracle/software-downloads.aspx)

还有其他有趣的下载（搜索 oracle free toad），但我不能确定它们的合法性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-16T01:23:06.727

如果您的客户端直接连接到数据库而没有任何中间层，那么您有两个非常简单的选择。

首先，使用`v$session`视图找出所需会话的 ID，然后通过其哈希值在`v$sql`/中找到您的查询（您可以检查[文档](http://docs.oracle.com/cd/B19306_01/server.102/b14237/toc.htm)中每个的描述），或者启用会话级 sql 跟踪[(1)](http://docs.oracle.com/cd/B19306_01/appdev.102/b14258/d_monitor.htm#i1003679) [(2)](http://www.orafaq.com/wiki/SQL_Trace)和在纯文本跟踪文件中获取您的查询。`v$sql_text`

如果你有一个中间层，那么事情会变得稍微复杂一些，但只是在弄清楚你需要跟踪的会话方面。不过，您始终可以启用系统范围的跟踪。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-06-24T15:23:40.813

聚会有点晚了，但我遇到了这个问题，不想在数据库服务器上安装一些东西以供一次性使用，我最终使用了wireshark；查询以明文形式发送并且完全可读。

# vba - 复制多个工作表并使用 VBA 将其粘贴到一个工作表中时出现粘贴错误，

> ID：14342742
> 
> 赞同：1
> 
> 时间：2013-01-15T16:56:17.970
> 
> 标签：vba, copy, paste

我想复制各种工作表中的所有行和列，然后粘贴到一个工作表中，一个工作表位于另一个工作表的下方。

但我收到错误。我尝试使用网站提供的各种示例。但没有一个对我有用。请帮我解决。我在数组中传递工作表。所以我会按顺序得到工作表。

我提供了出现错误的代码。我在粘贴部分遇到错误。据说它应该是 A1 或 R1C1 。但我需要将所有工作表粘贴在一张纸的下方。

```
For m = 1 To fnum

lastrow = tempws.Range("A" & ws.Rows.Count).End(xlUp).Row

ws(m).Cells.Copy tempws.Cells((lastrow + 1), 1)

Next m

tempws.Save 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T17:08:20.360

这是因为您试图将工作表的整个单元格范围复制到**主**工作表上小于整个工作表的部分中。它不会起作用，因为没有足够的细胞剩余。您需要缩小复印表的尺寸以仅捕获带有数据的单元格。

像这样的东西应该是一个很好的框架来帮助你入门。您可能需要调整一些东西以适应您的数据。此外，这假定复印表中的所有数据都从单元格 A1 开始。再次，根据需要进行调整。

```
For me = 1 to fnum

    lastrow = tempws.Range("A" & tempws.Rows.Count).End(xlUp).Row 'i changed this to tempws, as you just had ws

    With ws(m)

        lastcopyrow = .Range("A" & .Rows.Count).End(xlup).Row
        lastcopycol = .Range("A" & .Columns.Count).End(xlToLeft).Column    

        .Range("A1",.cells(lastcopyrow, lastcopycol)).Copy tempws.Cells((lastrow + 1), 1)

    End With

Next m 
```

此外，如果由于 A1 或 R1C1 表示法而出现参考错误，您可能只想粘贴为值，而不是直接复制/粘贴。

# wpf - 带有绑定的 WPF DataGridTextColumn ElementStyle 和 EditElementStyle 模板

> ID：14342743
> 
> 赞同：1
> 
> 时间：2013-01-15T16:56:18.603
> 
> 标签：wpf, data-binding, .net-4.0, datatemplate, datagridtextcolumn

我有一个 WPF DataGrid，它有 10 个 DataGridTextColumns 显示需要相同格式的数字数据。我希望 EditingElementStyle 数字格式（原始十进制或浮点数）与 ElementStyle 格式（格式化百分比或货币）不同。如果重要的话，我的网格的 DataContext 是一个 CollectionViewSource。

如果可能，我想提出一个可重用的样式或模板资源来定义我的列。我的 10 个 DataGridTextColumns 的 XAML 几乎相同。我不太清楚如何在我的模板中使用 TemplateBinding、Element 绑定或 RelativeSource 绑定，以确保在解析模板后每列都获得正确的绑定。

我的最终目标是能够如下定义我的 DataGridTextColumns：

```
<DataGridTextColumn x:Name="dingCutoffPctColumn" 
                    Binding="{Binding CutoffPct}" Header="Cutoff %" Width="60"
                    ElementStyle="{StaticResource NumberElementStyle}"
                    EditingElementStyle="{StaticResource EditErrorStyle}" /> 
```

这是我当前正在使用的工作 XAML 的表示：

```
<DataGrid x:Name="myDataGrid" AutoGenerateColumns="False" 
          Margin="10,67,13,0" Height="200" EnableRowVirtualization="True"
          ItemsSource="{Binding}" VerticalAlignment="Top">
    <DataGrid.Resources>
        <Style x:Key="EditErrorStyle" TargetType="{x:Type TextBox}">
            <Setter Property="Padding" Value="-2"/>
            <Style.Triggers>
                <Trigger Property="Validation.HasError" Value="True">
                    <Setter Property="Background" Value="Red"/>
                    <Setter Property="ToolTip" 
                            Value="{Binding RelativeSource={RelativeSource Self},
                                    Path=(Validation.Errors)[0].ErrorContent}"/>
                </Trigger>
            </Style.Triggers>
        </Style>
        <Style x:Key="NumberElementStyle" TargetType="{x:Type TextBlock}">
            <Setter Property="TextAlignment" Value="Right"/>
        </Style>
    </DataGrid.Resources>

    <DataGrid.Columns>
        <DataGridTextColumn x:Name="id" Binding="{Binding ID}" 
                            Visibility="Collapsed" />
        <DataGridTextColumn x:Name="name" Header="Name"
                            Binding="{Binding Name, 
                                      TargetNullValue=&lt;enter new name&gt;}" />

        <DataGridTextColumn x:Name="cutoffPct" {Binding CutoffPct}" 
                            Header="Cutoff %" Width="60">
            <DataGridTextColumn.ElementStyle>
                <Style TargetType="{x:Type TextBlock}" 
                       BasedOn="{StaticResource NumberElementStyle}">
                    <Setter Property="Text" 
                            Value="{Binding CutoffPct, StringFormat=P}"/>
                </Style>
            </DataGridTextColumn.ElementStyle>
            <DataGridTextColumn.EditingElementStyle>
                <Style TargetType="{x:Type TextBox}" 
                       BasedOn="{StaticResource EditErrorStyle}">
                    <Setter Property="Text" 
                            Value="{Binding CutoffPct, 
                                ValidatesOnExceptions=True, StringFormat=\{0\}}"/>
                </Style>
            </DataGridTextColumn.EditingElementStyle>
        </DataGridTextColumn>
      </DataGrid.Columns>
</DataGrid> 
```

谢谢你的帮助

# jquery - jquery 选择器 - chrome 和 ie 中的问题

> ID：14342750
> 
> 赞同：0
> 
> 时间：2013-01-15T16:56:32.757
> 
> 标签：jquery

我正在尝试在单击 .icon-menu 时执行一个功能，但在 chrome 和 IE 中遇到了该功能未激活的问题。在 Firefox 中运行良好。我尝试了很多变化，但没有运气。

```
 <a href="#" class="icon"><span class="icon-menu"></span></a> 

$(document).ready(function() {

    $('a .icon-menu').click(function(){
       alert('yeah');
}); 
```

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T16:58:14.493

You forgot to finish your syntax

```
$('a .icon-menu').click(function(){
   alert('yeah');
}); //   <-- notice the parenthesis and semi colon 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T16:57:53.217

try this :

```
$(document).ready(function () {
    $('a .icon-menu').on('click',function(){
        alert(' yeah ');
    });
}); 
```

# scala - 使用Scala中的主要参数将对象场景传递给JavaFX窗口

> ID：14342755
> 
> 赞同：0
> 
> 时间：2013-01-15T16:56:46.847
> 
> 标签：scala, constructor, initialization, javafx

我想使用此代码从我的程序中显示通用 Javafx 场景

```
class JFXWindowDisplay(myScene:Scene) extends Application {

    def start( stage: Stage) {

      stage.setTitle("My JavaFX Application")
      stage.setScene(myScene)
      stage.show()
    }
  }

//OBJECT NEEDED TO RUN JAVAFX : http://stackoverflow.com/questions/12124657/getting-started-on-scala-javafx-desktop-application-development
  object JFXWindowDisplay extends App {

    override def main(args: Array[String]) {
      Application.launch(classOf[JFXWindowDisplay], args: _*)
    }
  } 
```

如何将 Scene 参数传递给 compagnon 对象？

例如，我想创建一个程序，从 scala 脚本执行中打开一个新的 javafx 窗口：

```
class myProgram() extends App  {

  val root = new StackPane
  root.getChildren.add(new Label("Hello world!"))

  val myScene = new Scene(root, 300, 300))
  // then run ControlTest object with this scene
  ControlTest(myScene)
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T22:15:23.363

您可以准备两个或更多`traits`每个与他的特定场景，然后将您需要的一个混合到应用程序类中

```
trait SceneProvider {
  def scene: Scene
}

trait Scene1 extends SceneProvider {
  val root = new StackPane
  root.getChildren.add(new Label("Hello world!"))
  def scene = new Scene(root, 300, 300)
}

trait Scene2 extends SceneProvider {
  val root = new StackPane
  root.getChildren.add(new Label("Hello world 2!"))
  def scene = new Scene(root, 300, 300)
}

trait JFXWindowDisplay {
  self: SceneProvider =>

  def start(stage: Stage) {
    stage.setTitle("My JavaFX Application")
    stage.setScene(scene)
    stage.show()
  }
}

class JFXWindowDisplay1 extends Application with JFXWindowDisplay with Scene1
class JFXWindowDisplay2 extends Application with JFXWindowDisplay with Scene2

object JFXMain extends App {
  override def main(args: Array[String]) {
    //here you chose an application class
    Application.launch(classOf[JFXWindowDisplay1], args: _*)
  }
} 
```

**编辑**：现在这工作，根据您的意见。

# xsl-fo - 强制 Apache FOP 覆盖图像分辨率？

> ID：14342766
> 
> 赞同：1
> 
> 时间：2013-01-15T16:57:29.973
> 
> 标签：xsl-fo, apache-fop

有没有办法将 Apache 配置为忽略存储在图像文件中的 DPI 元数据并改用特定值？或者可能是可以在`<fo:external-graphic>`元素上使用的属性？

图像使用以下方式呈现：

```
<fo:external-graphic src="{concat('url(', string(@href), ')')}"
                     xsl:use-attribute-sets="image">
  <xsl:call-template name="imageSizeAttributes"/>
  <xsl:call-template name="idAttribute"/>
  <xsl:call-template name="roleAttribute"/>
</fo:external-graphic> 
```

我发现源图像的最佳 DPI 值为 110。如果我以 110 DPI 保存图像，那么它们会完美呈现。如果可能的话，我想简单地覆盖它，以便不使用存储在图像文件中的 DPI 值。

我尝试将以下内容添加到“.xconf”文件中，但这似乎根本没有任何区别：

```
<source-resolution>110</source-resolution> 
```

我还尝试设置极值（0、72、200、300、600）以查看它们是否有任何影响，但它们没有。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T04:18:48.040

看来我需要将以下两行添加到我的“.xconf”文件中：

```
<source-resolution>110</source-resolution>
<target-resolution>110</target-resolution> 
```

此外，似乎这些配置仅适用于不包含 DPI 元数据的图像文件。

这对我来说太棒了，因为 Adob​​e Photoshop 在使用其“保存为 Web 和设备”功能时不会保存图像 DPI。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-27T11:51:00.750

在我的例子中，在*source-resolution*和*target-resolution*产生任何影响之前，需要将*content-width*和*content-height设置为与**width*和*height*相同的值。

# linux - PID、PPID 和 TGID 的含义

> ID：14342773
> 
> 赞同：24
> 
> 时间：2013-01-15T16:57:45.400
> 
> 标签：linux, process, linux-kernel, pid, threadgroup

Linux 内核首字母缩略词 PID、PPID、TGID 代表什么？

[我在strace-pids](https://github.com/serejkus/strace-pids#readme)偶然发现了它们。

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2013-01-15T17:03:59.030

*   PID：进程 ID
*   PPID：父进程 ID（启动此 PID 的进程 ID）
*   TGID：线程组 ID

有关更多详细信息，请参阅[此问题](https://stackoverflow.com/questions/9305992/linux-threads-and-process)

# javascript - Windows 8 Metro 界面 - 是 IE10 吗？

> ID：14342774
> 
> 赞同：2
> 
> 时间：2013-01-15T16:57:48.757
> 
> 标签：javascript, windows-8, microsoft-metro, winjs, internet-explorer-10

我最近开始使用 Windows 8，并且（作为一名 Web 开发人员）我正在使用 JavaScript 来构建我的 Metro 风格应用程序。

我已经学会了如何使用 VS Express 2012 中的调试工具......但我突然想到，包装 WebView（或任何它的名称）可能只是一个精简的 IE10。

我从来没有听过关于 HTML/JS 引擎在这个环境中的解释。有谁知道引擎盖下发生了什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-15T17:00:56.910

这是对的。使用 XAML 构建的 Windows 8 WinRT 应用程序的呈现由 XAML 处理，正在使用的应用程序`JS/HTML/CSS`使用 IE10 的 HTML 呈现引擎和 IE10 的`JavaScript`引擎进行呈现。

[这就是IE10是目前唯一实现CSS3网格布局](http://www.w3.org/TR/css3-grid-layout/)的浏览器的主要原因。

有关使用 JavaScript/HTML/CSS 编写的 Windows 应用商店应用程序的调试信息：

VS 提供了一个运行时 DOM 检查器，还有 Expression Blend，您还可以在其中运行应用程序，还有本机 VS 调试器。但是没有像 IE10 开发者工具这样的工具。Intellitrace 应该为您提供调试所需的足够网络信息。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-15T17:14:15.587

如果您在运行 Windows 8 HTML/JS 应用程序时查看任务管理器的详细信息选项卡，您将看到一个名为 WWAHost.exe 的进程。该过程托管 Trident (HTML/CSS) 和 Chakra (JavaScript) 引擎并运行应用程序。您机器上的 IE10 浏览器使用相同的引擎。但是，应用程序的行为方式与网站之间存在一些差异，您可以[在此处](http://msdn.microsoft.com/en-us/library/windows/apps/hh465380.aspx)查看这些差异。

# .net - Inherited Attributes and EF Code First Dynamic Proxy

> ID：14342777
> 
> 赞同：0
> 
> 时间：2013-01-15T16:57:58.797
> 
> 标签：.net, xml-serialization, xmlserializer

My question is related to [this](http://entityframework.codeplex.com/workitem/184) issue. I have a POCO class with virtual navigation property from the child to the parent. The parent has a collection of children.

```
public class Parent
{
    public virtual List<Child> Children { get; set; }
}

public class Child
{
    public string ParentID { get; set; }

    [XmlIgnore]
    [ForeignKey("ParentID")]
    public virtual Parent Parent { get; set; }
} 
```

Now... you guessed it - I try to serialize the parent that comes from EF(i.e. the proxy) with the XmlSerializer. It first complains about all unkown types(the dynamically generated classes) which I handle somehow. But then it exepts with a 'circular reference' exception.

The reason after some investigation turns out to be that the XmlIgnore attribute is not discoverable via reflection on the proxy object's Parent property.

```
 Type.GetType("System.Data.Entity.DynamicProxies.Child_2C9351FD5E156D94E5BF2C68DABFC2A956181C99A0C2E4E6B592E6373D8645ED, EntityFrameworkDynamicProxies-Test, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null")
.GetProperty("Parent").GetCustomAttributes(typeof(XmlIgnoreAttribute), true) <-- returns 'None' 
```

The proxy object's type base type is my Child class. The `XmlIgnoreAttribute` doesn't set the Inherited flag, and the default is true, so this should work. What is happening?

Is the proxy object lying about it's base type?

How can I workaround this issue without writing 'manual' xml serialization(I need to use the XmlSerializer).

**UPDATE**: It turns out that the XMLSerializer doesn't respect the 'inheritness' of the attributes which seems wrong. Is that a bug or is it by design?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T06:49:43.320

根据[此](http://msdn.microsoft.com/en-us/library/dwc6ew1d.aspx)msdn 文章（备注部分）：

'此方法忽略属性和事件的继承参数。要在继承链中搜索属性和事件的属性，请使用 Attribute.GetCustomAttributes 方法的适当重载。

所以这不必对代理做任何事情。看看这个例子：

```
public class Test
{
    [XmlIgnore]
    public virtual int Property { get; set; }
}

public class Derived : Test
{
    public override int Property { get; set; }
}

class Program
{
    static void Main(string[] args)
    {
        Console.WriteLine(
            typeof(Derived)
           .GetProperty("Property")
           .GetCustomAttributes(typeof(XmlIgnoreAttribute), true)
           .Count());

        Console.WriteLine(
           Attribute.GetCustomAttributes(
               typeof(Derived)
              .GetProperty("Property"), true)
              .Count());
    }
} 
```

结果：

```
0
1
Press any key to continue . . . 
```

# mysql - MySQL 中的简单 STR_TO_DATE 问题

> ID：14342779
> 
> 赞同：2
> 
> 时间：2013-01-15T16:58:08.053
> 
> 标签：mysql, sql, date, select

我正在进入像“2012 年 12 月”这样的日期，并想把它变成像“2012-12-01”这样的日期。我正在使用 STR_TO_DATE('Dec 2012','%b %Y') 它最终看起来像 2012-12-00。有什么想法可以将其设置为每月的第一天吗？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T16:59:34.133

```
DATE_FORMAT(STR_TO_DATE('Dec 2012','%b %Y'), '%Y-%m-01') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T17:30:02.920

试试这个：

```
SELECT STR_TO_DATE(CONCAT('01 ', 'Dec 2012') ,'%d %b %Y'); 
```

**或者**

```
SELECT DATE_ADD(STR_TO_DATE('Dec 2012','%b %Y'), INTERVAL 1 DAY); 
```

# encoding - 星号 AGI 编码

> ID：14342780
> 
> 赞同：0
> 
> 时间：2013-01-15T16:58:14.143
> 
> 标签：encoding, asterisk, agi

我正在使用一个公开可用的 AGI 脚本，它包装了 Google 的语音识别 API，用于将语音转换为 Asterisk 中的文本。基本上，该脚本将一个音频文件传递给 Google，并返回从音频中识别的文本。

这很好用，除了一个交易中断问题。每当识别的文本包含扩展字符，例如“á”、“ã”、“é”等，拨号计划就会得到一个扭曲的字符串。例如，Google 返回文本“não”，但 ASTERISK 得到“nÃ£o”。

显然，这与编码有关……但是由于对 AGI 和 PEARL 的了解有限，我无法确定问题出在哪里。据我所知，可能是

GOOGLE -> PEARL 或 PEARL -> ASTERISK

我希望有人可以帮助我...</p>

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T18:08:19.413

知道了！

使用一个名为“decode”的函数来解码来自 Google API 的响应。

# hive - 在 hive 中做交叉表（版本 0.9）

> ID：14342786
> 
> 赞同：1
> 
> 时间：2013-01-15T16:58:23.690
> 
> 标签：hive

我有一张这样的桌子：

```
sport    personId
1        1
1        2
1        3
2        1
2        4
2        6
3        1
3        3
3        6 
```

我想得到一张包含运动交集计数的表格 - 相当于伪代码：

```
for sport1 in sports:
   for sport2 in sports:
       X[sport1,sport2] = count(intersect(sport1,sport2)) 
```

如果我只有几项运动，我知道我会这样做：

```
select count(*) from (select * from table where sport = sport1) t1 join (select count(*) from table where sport = sport2) t2 on t1.personId = t2.personId; 
```

但我想为我所有的运动生成一张表格。

请注意，我使用的是 Hive 0.9，它不支持交叉连接。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-24T22:37:13.397

您想要一个表格，针对每项运动列出同时参加这两项运动的人数？

如果是这样，您可以在流式处理 hadoop 和 python 中执行此操作：

*   按人员 ID 排序
*   将 sport、personId 传递给 Python
*   缓存 personId，并将所有运动添加到列表中
*   获得不同的 personId 后，执行以下操作：

.

```
for i, sport1 in enumerate(sports):
    for sport2 in sports[i:]:
        print '\t'.join([sport1, sport2, '1']) 
```

然后`select sport1, sport2, count(*) as c group by sport1, sport2`从流式作业的中间表输出。

# html - Vertically align smaller bullets with larger text

> ID：14342788
> 
> 赞同：21
> 
> 时间：2013-01-15T16:58:28.070
> 
> 标签：html, css, list, vertical-alignment

I have a list with bullets. I made the bullets smaller by putting the `li` text inside a `span` and making the font-size of the `li` smaller than that of the span. The problem is that now the bullets are not vertically aligned in relation to the text. How do I fix that?

jsFiddle: [http://jsfiddle.net/tXzcA/](http://jsfiddle.net/tXzcA/)

```
li {
  font-size: 15px;
}

li span {
  font-size: 25px;
}
```

```
<ul>
  <li><span>text1</span></li>
  <li><span>text2</span></li>
  <li><span>text3</span></li>
  <li><span>text4</span></li>
</ul>
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-15T17:16:11.137

您可以只制作自己的要点并使其成为您想要的任何大小。

```
li{
  font-size: 15px;
  list-style-type:none;

}
li span{
  font-size: 25px;
}

ul li:before {
   content: "•";
   font-size: 80%;
   padding-right: 10px;
} 
```

只需将 更改`font-size`为您想要的大小即可。

[jsFiddle](http://jsfiddle.net/tXzcA/21/)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-01-15T17:14:22.577

尝试这个：

```
li span{
  font-size: 25px;
  vertical-align:middle;
  padding-bottom:5px;
} 
```

在这里看到它：http: [//jsfiddle.net/tXzcA/19/](http://jsfiddle.net/tXzcA/19/)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-11-27T02:02:51.453

这是我使用的，它以项目符号和内容为中心

jsfiddle：http: [//jsfiddle.net/VR2hP/14/](http://jsfiddle.net/VR2hP/14/)

CSS：

```
ul {
  padding-left: 5em;
  list-style: none;
}

li.twitter::before,
li.fb::before {    
  font-family: 'FontAwesome';
  margin: 0 .2em 0 -1.5em;
  font-size: 3em;
  vertical-align: middle;
}

li.twitter::before {
  content: '\f081';
}

li.fb::before {
    content: '\f082';
}

li {
  list-style-type: none;
}

li span {
  display: inline-block;
  vertical-align: middle;
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2018-08-21T21:52:45.300

使用无序列表并将列表项显示为表格。

看看这个例子：[https ://jsfiddle.net/luenib/jw1ua38v/](https://jsfiddle.net/luenib/jw1ua38v/)

图标、数字或您想要放置的任何内容都将位于跨度内。跨度的内容水平和垂直居中，如果您不想在顶部显示图标，这非常有用。段落内的文本将在其左侧保留一个空格，因此如果文本超过一行，它就不会位于图标下方。

CSS：

```
ul {
  padding-left: 0;
}

li {
  display: table;
}

li span {
  width: 40px;
  display: table-cell;
  text-align: center;
  vertical-align: middle;
} 
```

HTML：

```
<ul>
  <li><span>1</span>
    <p>Some text here. Some text here. Some text here. Some text here. Some text here. Some text here.</p>
  </li>
  <li><span>2</span>
    <p>Some text here. Some text here. Some text here.</p>
  </li>
</ul> 
```

# javascript - 简单 Javascript 的浏览器输出不正确 - 尝试测试 alert() 函数

> ID：14342797
> 
> 赞同：0
> 
> 时间：2013-01-15T16:58:56.843
> 
> 标签：javascript, html, function, browser, alert

我刚开始学习我的 JavaScript 教程，它说要测试这个简单的脚本。但是，我得到了错误的输出。

有谁知道问题是什么？我应该得到一个警告对话框。我在 Chrome 和 Safari 网络浏览器上尝试了以下代码：

```
<!DOCTYPE HTML>
<HTML>
    <HEAD>
        <TITLE>Template</TITLE>
    </HEAD>

    <BODY>

    <SCRIPT LANGUAGE = "Javascript">

        alert("Hello World");

    </SCRIPT>

    </BODY>
</HTML> 
```

我得到的浏览器输出是：

> {\rtf1\ansi\ansicpg1252\deff0\deflang1033{\fonttbl{\f0\fswiss\fcharset0 Arial;}} {*\generator Msftedit 5.41.15.1515;}\viewkind4\uc1\pard\f0\fs20 \par \par \标签 \par \tab\tab \par \tab \par \tab\par \tab \par \tab\tab\par \tab \par \par \tab \par \par }

请问有人知道是什么问题吗？谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T17:04:07.147

听起来您正在使用邪恶的 Windows 产品来编写代码。尝试改用记事本。长话短说：您正在捕捉编辑器插入的隐藏字符。

# google-app-engine - Forming a GQL query with != not equals

> ID：14342798
> 
> 赞同：2
> 
> 时间：2013-01-15T16:59:02.193
> 
> 标签：google-app-engine, filter, google-cloud-datastore, gql, gqlquery

I am trying to form a GQL query that:

```
SELECT * FROM IvlsRun where origInstrument = 'Catalyst_Dx' and practiceId != '100004' 
```

Finds all IvlsRun(s) where the origInstrument = 'Catalyst_Dx'... but I don't want any of them with practiceId = 10004.

Everytime I add the practiceId != 100004 or practiceId != '100004' I get an error.

I am new to GQL. I am doing this through the datastore viewer.

The error is pretty basic, telling me I don't know how to use GQL:

Learn more about GQL syntax. no matching index found.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T19:43:10.733

当您在一个属性上使用一个或多个不等式过滤器并在其他属性上使用一个或多个等式过滤器时，您必须定义自定义索引。请参阅[索引配置](https://developers.google.com/appengine/docs/python/datastore/indexes#Index_Configuration)。

# python - I need to run a TCL script in python, my TCL script also has a user-defined(internal) package

> ID：14342801
> 
> 赞同：1
> 
> 时间：2013-01-15T16:59:15.523
> 
> 标签：python, tcl

I need to run a TCL script in python, my TCL script also has a user-defined(internal) package I tried these scripts:

**1.**

```
import Tkinter
import socket

def TCLRun():
 s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
 s.connect(('127.0.0.1', 5006))
 root = Tkinter.Tk()
## root.tk.eval('package require XXX')
 tcl_script ="""
package require XXX
set YYY [COMMAND FROM PACKAGE]
puts $YYY 
} """
 # call the Tkinter tcl interpreter
 root.tk.call('eval', tcl_script)
 root.mainloop() 
```

with this error:

```
import TCLCall
>>> TCLCall.TCLRun()

    Traceback (most recent call last):
      File "<pyshell#2>", line 1, in <module>
        TCLCall.TCLRun()
      File "C:\Users\XXX\Desktop\PKT\TCLCall.py", line 24, in TCLRun
        root.tk.call('eval', tcl_script)
    TclError: can not find channel named "stdout" 
```

and,

**2.**

```
import Tkinter
root=Tkinter.Tk()
root.tk.eval('package require XXX')
root.tk.eval('set YYY COMMAND') 
```

returns error about sdtout!

other one:

**3.**

```
 import subprocess
    p = subprocess.Popen(
        "tclsh tcltest.tcl",
        shell=True,
        stdin=subprocess.PIPE,
        stdout=subprocess.PIPE,
        stderr=subprocess.PIPE)
    stdout, stderr = p.communicate()
    print stdout
    print stderr 
```

returns the following error:

```
can't find package __teapot__

    while executing

"package require __teapot__" 
```

none of them working, please help me with this issue!

I can use some commands that operating something on our product with following code:

```
import socket
import time

def Sckt():
 s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
 s.connect(('127.0.0.1', 5006))

 s.send('0 COMMAND \r\n') 
```

that would give you some ideas!

thank,

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T09:30:38.040

对于不属于您的供应商安装的自定义包，您需要指示 Tcl 从何处搜索它。为此，将包含包的目录的*父*目录附加到 Tcl 的全局`auto_path`变量中。例如，如果 XXX 包在目录中，`/home/amir/.tclpackages/XXX1.0`那么您将让您的脚本执行以下操作：

```
lappend auto_path /home/amir/.tclpackages 
```

这可以在`package require XXX`. （好吧，你可以把它放在之后，但然后`package require`会失败......）

# jquery - jQuery - 洗牌两个绝对定位的元素

> ID：14342811
> 
> 赞同：-1
> 
> 时间：2013-01-15T16:59:49.557
> 
> 标签：jquery

我有一个叫三的容器。它内部有两个 div，分别为“一”和“二”。我只想改变他们的绝对位置。是否可以？[如果是这样， jQuery](http://en.wikipedia.org/wiki/JQuery)是否有任何内置函数？

这是我的尝试，但它不能正常工作：

### HTML：

```
<div id='three'>
    <div id="one">1</div>
    <div id="two">2</div>
</div> 
```

### 代码：

```
var clone1 = $('#one').clone();
var colone2 = $('#two').clone();

var clone1X = $('#two').position().left
var clone1Y = $('#two').position().top;

var clone2X = $('#one').position().left;
var clone2Y = $('#one').position().top;

$('div > div').remove();

$('div').append($(colone2).css({left:clone1X,top:clone1Y})).append($(clone1).css({left:clone2X,top:clone2Y})); 
```

但没有像我预期的那样工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T17:02:19.600

它不应该那么难...这是怎么回事，

```
<div id='three'>
    <div id="one">1</div>
    <div id="two">2</div>
</div>

$(function () {
    var onePos = $('#one').position();
    var twoPos = $('#two').position();

    $('#one').css({left: twoPos.left, top: twoPos.top});
    $('#two').css({left: onePos.left, top: onePos.top});
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T17:11:26.637

jQuery 中没有内置函数。但我们总是可以创建自己的：

```
(function( $ ){
    $.fn.swap = function(other,speed) {
        //Get the position
        var position1 = this.offset();
        var position2 = other.offset();

        //Position this where it is
        this.css({
            top: position1.top + 'px',
            left: position1.left + 'px',
            position: 'absolute'
        });

        //Position the other element where it is
        other.css({
            top: position2.top + 'px',
            left: position2.left + 'px',
            position: 'absolute'
        });

        this.animate({
            'top': position2.top + 'px',
            'left': position2.left + 'px'
        }, speed, function() {
            // Animation complete.
        });

        other.animate({
            'top': position1.top + 'px',
            'left': position1.left + 'px'
        }, speed, function() {
            // Animation complete.
        });
    };
})( jQuery ); 
```

使用此功能：

```
$('#trigger').click(function(e) {
    $('#element1').swap($('#element2'),300);
}); 
```

# php - PHP Sort by using drop-down box

> ID：14342818
> 
> 赞同：-1
> 
> 时间：2013-01-15T17:00:13.610
> 
> 标签：php

I am basically creating a website and it is a site that sells mobile phones. I need to find a way using PHP to create a drop-down box that can sort the phones by model, brand, screen size etc. (Fields already in my SQL database). What is the simplest way of going about this? I am quite new to PHP and not too sure how to go about it.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T17:09:24.743

您在 MySQL 查询中处理排序：

```
SELECT * FROM <<table>> ORDER BY 'Brand' DESC 
```

然后在您的页面中调用结果；您无法通过 javascript（用户端）对查询重新排序，因为该查询称为服务器端。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T17:13:56.450

您可以使用`$_GET`变量来实现这一点。像这样的东西

```
<?php
  // Let's say that my products category is a $_GET variable
  $category_id = isset($_GET['category_id']) && is_numeric($_GET['category_id']) ? $_GET['category_id'] : 1; // where 1 is a default category to show!
?>

<select onchange="if(this.value != '') document.location = '/my-phones-category.php?category_id=<?php echo $category_id; ?>&order_by=' + this.value">
  <option value="">Choose an option</option>
  <option value="model"<?php if(isset($_GET['order_by']) && $_GET['order_by'] == 'model') echo ' selected="selected"'; ?>>Model</option>
  <option value="brand"<?php if(isset($_GET['order_by']) && $_GET['order_by'] == 'brand') echo ' selected="selected"'; ?>>Brand</option>
</select> 
```

然后我们必须看看如何进行查询以添加正确的订单

```
<?php
  switch($_GET['order_by']) {
    case 'model':
      $order_by = " ORDER BY products.product_model";
      break;
    case 'brand':
      $order_by = " ORDER BY products.product_brand";
      break;
    default:
      $order_by = " ORDER BY products.product_price";
  }

  // Now we have the order and we can make the query

  $sql = $mysqli->query("SELECT product_name, product_price 
                         FROM products
                         WHERE category_id='" . $category_id . "'
                         $order_by");
?> 
```

祝你好运！

# android - LIBGDX 3d .obj loader

> ID：14342819
> 
> 赞同：2
> 
> 时间：2013-01-15T17:00:14.350
> 
> 标签：android, eclipse, libgdx

I'm starting and a newbie to use `libgdx` and try to load a `3d` model.

I just want to ask if `libgdx` have function or library that can load my `3d` model or should I create a `.obj` loader for me to load it.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T03:37:03.960

您可以更具体地了解您想要加载的文件格式，以及您所做的研究（如果有的话）。也就是说，我认为这就是你要找的东西：http: [//libgdx.l33tlabs.org/docs/api/com/badlogic/gdx/graphics/g3d/loaders/obj/ObjLoader.html](http://libgdx.l33tlabs.org/docs/api/com/badlogic/gdx/graphics/g3d/loaders/obj/ObjLoader.html)

举个例子，看看这个 SO 问题：[libgdx obj loader problen](https://stackoverflow.com/questions/12944383/libgdx-obj-loader-problen)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-19T21:23:05.070

我建议您查看本教程： [使用 LibGDX 加载模型](http://blog.xoppa.com/loading-models-using-libgdx/) 新的 3D API 包含一个内置的 obj-loader。Xoppa 最近开始编写教程。它们非常直截了当，并且还包含许多有用的信息。

# java - JAXB/xjc: Generate classes from child elements and load them based on class types

> ID：14342822
> 
> 赞同：0
> 
> 时间：2013-01-15T17:00:24.053
> 
> 标签：java, jaxb, jaxb2

I have a configuration file in XML, which looks something like:

```
<configuration>
     <database>
          <host></host>
          <port></port>
     </database>
     <queue>
           <host></host>
           <port></port>
           <type></type>
      </queue>
</configuration> 
```

I would like to use JAXB/xjc to generate Java classes for this configuration, however I would like to generate these classes and unmarshal these one level into the tree. Rather than receiving a Configuration.java, I would like a Database.java and Queue.java (in order that these can be separately injected into a Guice managed application). I don't (currently) see any way of doing this, however may be searching for the wrong things.

* * *

After some experimentation, I have found a solution to generate these classes and be able to populate and return these based on class:

First, I added a bindings.xjb file which will generate the contained classes (Database and Queue in this example)

```
<jaxb:bindings
    xmlns:xsd="http://www.w3.org/2001/XMLSchema"
    xmlns:jaxb="http://java.sun.com/xml/ns/jaxb"
    version="2.1">
    <jaxb:globalBindings localScoping="toplevel"/>
</jaxb:bindings> 
```

However, JAXB can't unmarshall using the Database or Queue class, only the Configuration class (this is where I may have missed something). I can do

```
JAXBContext context = JAXBContext.newInstance(Configuration.class);
Unmarshaller um = context.createUnmarshaller();
Configuration conf = (Configuration) um.unmarhal(xmlFile); 
```

but not

```
JAXBContext context = JAXBContext.newInstance(Database.class);
Unmarshaller um = context.createUnmarshaller();
Database db = (Database) um.unmarhal(xmlFile); 
```

However, because I can get the database object by calling getDatabase() on an instance of the Configuration object, this can also be made generic using reflection (making this code cache results in the appropriate places is another exercise):

```
 T item = null;
    try {
        JAXBContext context = JAXBContext.newInstance(Configuration.class);
        Unmarshaller um = context.createUnmarshaller();
        Configuration conf = (Configuration) um.unmarshal(xmlFile);
        Method[] allMethods = Configuration.class.getDeclaredMethods();
        for (Method method : allMethods)
        {
            if (method.getReturnType().equals(clazz))
            {
                item = (T) method.invoke(conf);
                break;
            }
        }
    } catch (JAXBException | IllegalAccessException | IllegalArgumentException | InvocationTargetException e) {
        throw new ConfigException("Failure detected while loading configuration", e);
    }
    return item; 
```

I'm not sure this is the best solution (I only started working with JAXB yesterday), but seems to fulfill my goal.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T17:45:47.490

该特定 XML 将对应于具有类型和`Configuration`属性的类。这不是你要找的吗？`Database``Queue`

```
@XmlRootElement
@XmlAccessorType(XmlAccessType.FIELD)
public class Configuration {

    private Database database;
    private Queue queue;

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-03-02T15:50:41.480

Step1：创建3个类configuration.java、database.java、queue.java

配置.java

```
@XmlAccessorType(XmlAccessType.FIELD)
@XmlRootElement(name = "configuration")
public class configuration{

  @XmlElement
  private database db;
  @XmlElement
  private queue q;
  ...
}

@XmlAccessorType(XmlAccessType.FIELD)
public class database{
  @XmlElement
  private String host;
  @XmlElement
  private String port;
....
}

-------------------------

    InputStream xmlStream = new FileInputStream(config.xml);
    JAXBContext jaxbContext = JAXBContext.newInstance(configuration.class, database.class,queue.class);
    Unmarshaller jaxbUnmarshaller = jaxbContext.createUnmarshaller();
                    configuration config= (configuration) jaxbUnmarshaller.unmarshal(xmlStream);

    config.getDatabase().getHost(); //returns the host
    config.getDatabase().getPort(); //returns the port

------------------------------------ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-17T10:48:24.520

我正在用我在问题中讨论的问题的解决方案来回答这个问题。这符合我的要求：

* * *

经过一些实验，我找到了生成这些类并能够根据类填充和返回这些类的解决方案：

首先，我添加了一个 bindings.xjb 文件，它将生成包含的类（本例中的数据库和队列）

```
<jaxb:bindings
    xmlns:xsd="http://www.w3.org/2001/XMLSchema"
    xmlns:jaxb="http://java.sun.com/xml/ns/jaxb"
    version="2.1">
    <jaxb:globalBindings localScoping="toplevel"/>
</jaxb:bindings> 
```

但是，JAXB 不能使用 Database 或 Queue 类解组，只能使用 Configuration 类（这是我可能遗漏的地方）。我可以

```
JAXBContext context = JAXBContext.newInstance(Configuration.class);
Unmarshaller um = context.createUnmarshaller();
Configuration conf = (Configuration) um.unmarhal(xmlFile); 
```

但不是

```
JAXBContext context = JAXBContext.newInstance(Database.class);
Unmarshaller um = context.createUnmarshaller();
Database db = (Database) um.unmarhal(xmlFile); 
```

但是，因为我可以通过在 Configuration 对象的实例上调用 getDatabase() 来获取数据库对象，所以也可以使用反射将其设为通用（将代码缓存在适当的位置是另一个练习）：

```
 T item = null;
    try {
        JAXBContext context = JAXBContext.newInstance(Configuration.class);
        Unmarshaller um = context.createUnmarshaller();
        Configuration conf = (Configuration) um.unmarshal(xmlFile);
        Method[] allMethods = Configuration.class.getDeclaredMethods();
        for (Method method : allMethods)
        {
            if (method.getReturnType().equals(clazz))
            {
                item = (T) method.invoke(conf);
                break;
            }
        }
    } catch (JAXBException | IllegalAccessException | IllegalArgumentException | InvocationTargetException e) {
        throw new ConfigException("Failure detected while loading configuration", e);
    }
    return item; 
```

这允许我通过传递 Database.class 来获得一个未编组的数据库，而无需对任何配置参数的方法进行硬编码。然后可以在需要的地方注入这些，而无需注入整个未编组的 XML 文件。

# c# - Linq如何组合两个List的列

> ID：14342824
> 
> 赞同：-3
> 
> 时间：2013-01-15T17:00:26.600
> 
> 标签：c#, linq, list

请在以下方面帮助我...我有两个列表对象，如下所示：

```
list1:
ID  col1
--------
1   A
1   B
1   C

list2:
ID  col2
--------
1   D
1   E 
1   F

Now I want:
ID  col1  col2
---------------
1    A     D
1    B     E
1    C     F 
```

所以基本上column1然后是list1中的column 2，然后是list 2中的column 3。column1是常见的。请注意，行数可能并不总是相同的。在这种情况下，它将为空。

我真的很需要 Linq 中的这个解决方案。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T17:09:05.507

```
List<Class> list1 = new List<Class>();
List<Class> list2 = new List<Class>();

// Add classes to lists...

list1.AddRange(list2);

// Order merged list...

list1.OrderByDescending(o => o.col1).ThenBy(o => o.col2); 
```

试图理解...

```
Dictionary<Int32, Class[]> dictionary = new Dictionary<Int32, Class[]>();

list2.Reverse();

for (Int32 i = 0; i < list1.Count; ++i)
    dictionary[i] = new Class[2] { list1[i], list2[i] }; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-01-07T08:40:59.673

我真的不明白为什么很难弄清楚这个问题，他只想将两个数组合二为一（我仍然不知道为什么在网络上你只能找到 Concat、AddRange 或 Union。错误的答案这个问题）：

我用 Zip 解决它：

```
 var result = list1.Zip(list2,(first,second)=>new  {entrada=first,salida=second}); 
```

现在你可以做这样的事情：

```
 var union=result.Select(x=> new {x.entrada, x.salida, horas = int.Parse((DateTime.Parse(x.salida).Subtract(DateTime.Parse(x.entrada))).Hours.ToString()) }); 
```

# java - 如何在java中编写查询以使用MySql插入带有外键的数据

> ID：14342826
> 
> 赞同：0
> 
> 时间：2013-01-15T17:00:28.957
> 
> 标签：java, mysql, insert, foreign-keys

```
Table 1 :questions(qid,category,question);  PRIMARY KEY:qid,category  
Table 2 :choices(ch_id,qid1,category1,choice);  PRIMARY KEY: ch_id 
```

这里qid、ch_id使用AUTO_INCREAMENT。

查询：

```
mysql>INSERT INTO choices(qid1,category1,choie)  
->SELECT qid,category,'Some Choice'  
->FROM questions 
WHERE qid1=qid AND category1=category; 
```

在这种情况下，我将如何使用相同的查询为 java 编写此代码。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-17T22:40:28.247

首先，您需要一个 java.sql.Connection 的实例。根据上下文，有多种获取方法，但如果您使用某种 Java EE 容器，例如 Tomcat，您将需要使用 javax.sql.DataSource（另一种方法，没有 Java EE服务器，将使用 java.sql.DriverManager，但效率较低）。获取 DataSource 的方法也有多种，但最常见的如下所示：

```
String jndiName = "java:comp/env/jdbc/myDB";
Context ctx = new InitialContext();
DataSource ds = (DataSource)ctx.lookup(jndiName); 
```

这将使用您在 Tomcat 配置中设置的数据库连接。

之后，您需要一个连接：

```
Connection con = ds.getConnection(); 
```

然后是 java.sql.Statement，用于执行 SQL 语句的类：

```
Statement stmt = con.createStatement(); 
```

现在，您可以执行 SQL 代码：

```
stmt.execute("INSERT INTO choices(qid1,category1,choie) SELECT qid,category,'Some Choice' FROM questions WHERE qid1=qid AND category1=category;"); 
```

我们完了吗？不，我们不是。我们需要通过添加一些特定的代码和异常处理来管理我们的事务，并且我们需要释放我们正在使用的各种数据库资源以便以后能够重用它们。我们在 finally 块中这样做，所以我们确定它会被执行。最后，整个事情看起来像这样（未经测试的代码！）：

```
try {
    String jndiName = "java:comp/env/jdbc/myDB";
    Context ctx = new InitialContext();
    DataSource ds = (DataSource)ctx.lookup(jndiName);
    Connection con = ds.getConnection();
    con.setAutoCommit(false); // Transaction are managed manually
    Statement stmt = con.createStatement();
    stmt.execute("INSERT INTO choices(qid1,category1,choie) SELECT qid,category,'Some Choice' FROM questions WHERE qid1=qid AND category1=category;");
    con.commit(); // Transaction OK
} catch (SQLException sqle) {
    con.rollback(); // Transaction not OK
} finally {  //Resource management
    if (stmt!=null) {
        stmt.close();
    }
    if (con != null) {
        con.close();
    }
} 
```

您应该查看 Javadoc。一个好的起点：

[http://docs.oracle.com/javase/6/docs/api/javax/sql/DataSource.html](http://docs.oracle.com/javase/6/docs/api/javax/sql/DataSource.html)

# postgresql - PostgreSQL 中的平均聚合时态数据库 10 分钟间隔

> ID：14342830
> 
> 赞同：2
> 
> 时间：2013-01-15T17:00:50.077
> 
> 标签：postgresql, average, truncate

我有一个时间序列数据，我想通过平均函数对其进行聚合。聚合应以 10 分钟间隔执行：(HH-1):50、HH:00、HH:10、HH:20、HH:30、HH:40 或以 10 分钟间隔执行：(HH-1) ：51，HH：01，HH：11，HH：21，HH：31，HH：41。注意：5 点钟的小时平均值是 (4):51、5:01、5:11、5:21、5:31、5:41 值的平均值。

问题是数据集包含时间上具有奇数和偶数频率的变量。因此，我不能仅通过应用奇数或偶数瞬时时间来为其分配聚合。我想知道如何处理这个问题。

我正在使用的代码：

```
select dt, average_temp from (  select  date_trunc('hour', dt + interval '10 minutes') dt, avg(ambtemp) over(  partition by date_trunc('hour', dt + interval '10 minutes')  ) average_temp  from n25_30 where extract(minute from dt) in (51, 01, 11, 21, 31, 41) and dt::timestamptz > '2007-09-29 23:59:00' AND dt < '2007-09-30 22:45:00') s  group by 1, 2 order by dt

select dt, average_temp from (  select  date_trunc('hour', dt + interval '10 minutes') dt, avg(ambtemp) over(  partition by date_trunc('hour', dt + interval '10 minutes')  ) average_temp  from n28_30 where extract(minute from dt) in (50, 00, 10, 20, 30, 40) and dt::timestamptz > '2007-09-29 23:59:00' AND dt < '2007-09-30 22:45:00') s  group by 1, 2 order by dt 
```

样本数据：

```
330    1.78 2007-09-30 10:39:52
331    2.06 2007-09-30 10:41:52
332    1.90 2007-09-30 10:43:52
333    2.28 2007-09-30 10:45:52
334    1.89 2007-09-30 10:47:52
335    2.04 2007-09-30 10:49:52
336    2.31 2007-09-30 10:51:52
337    2.50 2007-09-30 10:53:52
338    2.29 2007-09-30 10:55:52
339    2.47 2007-09-30 10:57:52
340    2.48 2007-09-30 10:59:52
341    1.74 2007-09-30 11:01:52
342    1.70 2007-09-30 11:03:52
343    2.30 2007-09-30 11:05:52
344    3.01 2007-09-30 11:07:52
345    2.78 2007-09-30 11:09:52
346    2.90 2007-09-30 11:11:52
347    2.50 2007-09-30 11:13:52
348    2.58 2007-09-30 11:15:52
349    3.72 2007-09-30 11:17:52
350    3.29 2007-09-30 11:19:52
351    2.32 2007-09-30 11:21:52
352    2.86 2007-09-30 11:23:52
353    3.11 2007-09-30 11:25:52
354    3.04 2007-09-30 11:27:51
355    2.39 2007-09-30 11:29:51
356    2.68 2007-09-30 11:31:51
357    2.32 2007-09-30 11:33:52
358    2.33 2007-09-30 11:35:52
359    2.50 2007-09-30 11:37:51
360    2.55 2007-09-30 11:39:51
361    3.16 2007-09-30 11:41:51
362    3.24 2007-09-30 11:43:51
363    3.90 2007-09-30 11:45:51
364    5.13 2007-09-30 11:47:51
365    3.94 2007-09-30 11:49:51
366    3.18 2007-09-30 11:51:51
367    4.54 2007-09-30 11:53:51
368    5.78 2007-09-30 11:55:51
369    4.72 2007-09-30 11:57:51
370    3.66 2007-09-30 11:59:51
371    3.22 2007-09-30 12:01:51
372    3.38 2007-09-30 12:03:51
373    3.96 2007-09-30 12:05:51
374    4.82 2007-09-30 12:07:51
375    4.09 2007-09-30 12:09:51
376    5.56 2007-09-30 12:11:51
377    6.60 2007-09-30 12:13:52
378    5.36 2007-09-30 12:15:52
379    6.04 2007-09-30 12:17:51
380    5.56 2007-09-30 12:19:51
381    4.60 2007-09-30 12:21:52
382    4.08 2007-09-30 12:23:51
383    4.44 2007-09-30 12:25:51
384    5.23 2007-09-30 12:27:52
385    3.16 2007-09-30 12:29:52
386    3.10 2007-09-30 12:31:52
387    3.50 2007-09-30 12:33:52
388    3.38 2007-09-30 12:35:52
389    3.65 2007-09-30 12:37:52
390    3.68 2007-09-30 12:39:52
391    4.40 2007-09-30 12:41:52
392    4.80 2007-09-30 12:43:52
393    5.44 2007-09-30 12:45:52
394    4.52 2007-09-30 12:47:52
395    3.64 2007-09-30 12:49:52
396    3.42 2007-09-30 12:51:52
397    3.74 2007-09-30 12:53:52
398    4.78 2007-09-30 12:55:52
399    4.03 2007-09-30 12:57:52
400    3.78 2007-09-30 12:59:52
401    4.52 2007-09-30 13:01:52
402    4.02 2007-09-30 13:03:52
403    4.07 2007-09-30 13:05:52
404    3.78 2007-09-30 13:07:52
405    4.04 2007-09-30 13:09:52
406    4.00 2007-09-30 13:11:52
407    4.29 2007-09-30 13:13:52
408    4.57 2007-09-30 13:15:52
409    4.83 2007-09-30 13:17:52
410    5.24 2007-09-30 13:19:52
411    6.96 2007-09-30 13:21:52
412    6.83 2007-09-30 13:23:52
413    8.58 2007-09-30 13:26:09
414    6.34 2007-09-30 13:28:09
415    8.34 2007-09-30 13:30:09
416    7.14 2007-09-30 13:32:09
417    5.26 2007-09-30 13:34:09
418    5.04 2007-09-30 13:36:09
419    5.96 2007-09-30 13:38:09
420    5.71 2007-09-30 13:40:09
421    7.16 2007-09-30 13:42:09
422    6.50 2007-09-30 13:44:09
423    5.54 2007-09-30 13:46:09
424    4.76 2007-09-30 13:48:09
425    4.87 2007-09-30 13:50:09
426    4.73 2007-09-30 13:52:09
427    4.74 2007-09-30 13:54:09
428    4.14 2007-09-30 13:56:09
429    4.74 2007-09-30 13:58:09
430    5.52 2007-09-30 14:00:09
431    4.86 2007-09-30 14:02:09
432    5.20 2007-09-30 14:04:09
433    6.98 2007-09-30 14:06:09
434    5.43 2007-09-30 14:08:09
435    4.90 2007-09-30 14:10:09
436    5.06 2007-09-30 14:12:09
437    6.74 2007-09-30 14:14:09
438    5.56 2007-09-30 14:16:09
439    5.22 2007-09-30 14:18:09
440    5.44 2007-09-30 14:20:09
441    4.84 2007-09-30 14:22:09
442    4.84 2007-09-30 14:24:09
443    4.50 2007-09-30 14:26:09
444    5.98 2007-09-30 14:28:09
445    4.90 2007-09-30 14:30:09
446    5.22 2007-09-30 14:32:09
447    6.41 2007-09-30 14:34:09
448    5.20 2007-09-30 14:36:09
449    4.74 2007-09-30 14:38:09
450    5.54 2007-09-30 14:40:09
451    5.04 2007-09-30 14:42:09
452    4.78 2007-09-30 14:44:09
453    4.87 2007-09-30 14:46:09
454    5.95 2007-09-30 14:48:09
455    5.10 2007-09-30 14:50:09
456    5.18 2007-09-30 14:52:09
457    4.94 2007-09-30 14:54:09
458    4.94 2007-09-30 14:56:09
459    5.01 2007-09-30 14:58:09
460    5.12 2007-09-30 15:00:09
461    4.92 2007-09-30 15:02:09
462    5.34 2007-09-30 15:04:09
463    5.14 2007-09-30 15:06:09
464    5.07 2007-09-30 15:08:09
465    5.35 2007-09-30 15:10:09
466    5.24 2007-09-30 15:12:09
467    5.50 2007-09-30 15:14:09
468    6.51 2007-09-30 15:16:09
469    7.31 2007-09-30 15:18:09
470    6.99 2007-09-30 15:20:09
471    6.91 2007-09-30 15:22:09
472    5.69 2007-09-30 15:24:09
473    5.75 2007-09-30 15:26:09
474    6.08 2007-09-30 15:28:09
475    6.94 2007-09-30 15:30:09
476    5.60 2007-09-30 15:32:09
477    5.08 2007-09-30 15:34:09
478    4.66 2007-09-30 15:36:09
479    5.52 2007-09-30 15:38:09
480    4.48 2007-09-30 15:40:09 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T18:05:17.370

该任务可以简化为：

1) 每 10 分钟选择第一个（最早的）值，但大于之后`'1 minute'`（排除类似 的值`13:30:09`）。

2）在上一步的集合中得到每小时的平均值，偏移量为`'10 minutes'`。

这个查询：

```
SELECT ambtemp,
       dt,
       row_number() OVER (PARTITION BY date_trunc('hour',dt), 
                                       date_part('minute',dt)::int / 10
                          ORDER BY dt) as rank
FROM your_table
WHERE date_part('minute',dt)::int % 10 > 0 
```

将为您提供最早的值，但大于`'1 minute'`每 10 分钟（`hh:m1`或`hh:m2`每 10 分钟）。

然后，使用第一个查询作为子查询：

```
SELECT date_trunc('hour',dt + interval '10 minutes') as hour,
       avg(ambtemp)
FROM (first query here) sub
WHERE rank = 1
GROUP BY 1; 
```

更新：这是一个完整的查询：

```
SELECT date_trunc('hour',dt + interval '10 minutes') as hour,
       avg(ambtemp)
FROM (SELECT ambtemp,
             dt,
             row_number() OVER (PARTITION BY date_trunc('hour',dt), 
                                             date_part('minute',dt)::int / 10
                                ORDER BY dt) as rank
      FROM table1

      -- delete this WHERE to get (HH-1):50, HH:00, HH:10, HH:20, HH:30, HH:40
      -- with this WHERE it gets  (HH-1):51, HH:01, HH:11, HH:21, HH:31, HH:41
      WHERE date_part('minute',dt)::int % 10 > 0          
     ) sub
WHERE rank = 1
GROUP BY 1
ORDER BY 1; 
```

这是带有示例数据的[SQLFiddle 。](http://sqlfiddle.com/#!12/b60ca/12)

上面的查询是针对`(HH-1):51, HH:01, HH:11, HH:21, HH:31, HH:41`. 如果您需要查询，`(HH-1):50, HH:00, HH:10, HH:20, HH:30, HH:40`只需删除标记的行。

我已经测试了查询，它返回了正确的结果（对于`(HH-1):50, HH:00, ...` 查询变体，它们等于您的示例结果）。

# javascript - JavaScript：摆脱三个 JSHint 错误

> ID：14342831
> 
> 赞同：0
> 
> 时间：2013-01-15T17:00:50.963
> 
> 标签：javascript, api, node.js, jshint

请在下面找到我的 Node.JS 服务器代码片段：

```
// Define the user API
var API = {
    list: 'private',
    login: 'public',
    logout: 'private',
    add: 'admin',
    remove: 'admin',
    edit: 'admin'
};

// Attach API handlers
for(var label in API) {
    var denied = 'Permission denied';

    var wrapper = (function (label) {
        return function (req, res) {
            var permission = API[label];

            if(!req.session) {
                if(permission !== 'public') {
                    res.send(denied);
                    return;
                }
            } else if((permission === 'admin') && (req.session.rights !== 'Administrator')) {
                res.send(denied);
                return;
            }

            eval(label + '(req, res)');
        };
    }(label));

    server.post('/user/' + label, wrapper);
} 
```

基本上，我为 中的每个属性都有一个 API 处理程序`API`，并以编程方式附加处理程序，并根据需要处理权限。然而 JSHint 真的不喜欢这样。我得到三个错误：

```
Line 29: eval(label + '(req, res)');
eval is evil.

Line 31: }(label));
Don't make functions within a loop.

Line 12: for(var label in API) {
The body of a for in should be wrapped in an if statement to filter unwanted properties from the prototype. 
```

如何改进这段代码以使 JSHint 满意？您是否会建议对代码进行其他更改？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T17:02:18.203

我建议通过使 jslint 不那么严格的选项并设置这些选项（前提是您了解原因）。Jslint 非常严格，这就是为什么它可以选择使其不那么严格的原因。重要的是你知道他们为什么被标记，为什么你可以允许这些事情。

例如允许 eval 使用：

```
/*jslint evil: true */ 
```

一些用途：

```
/*jslint plusplus: true */ 
```

因为他们发现 ++ 和 -- 不会导致他们在错误创建或可读性方面出现问题。

jslint 用于引起对潜在陷阱的注意。如果你了解它们，你可以绕过它们。

# arrays - 用于存储不同大小数据集的数据库表设计

> ID：14342832
> 
> 赞同：3
> 
> 时间：2013-01-15T17:00:55.167
> 
> 标签：arrays, ms-access, database-design, dynamic-arrays, variable-length

我正在设计一个 Microsoft Access 数据库来存储实验室设备的结果。它们以数百个频率与响应曲线列表的形式出现，我以前相当容易地存储这些曲线，但在 Excel 中效率低下。

困难在于频率可以在 1 - 50E9 Hz 之间变化，数据点之间的步长可以在 1 - 1E9, Hz 之间变化，并且点的数量可以在 ~ 100 - 40,000 之间变化。这给桌子设计带来了挑战，因为我尝试的一切似乎都非常低效。

我考虑过使用外部文本文件的链接来存储解决表设计的数据点，但似乎违反了良好的数据库设计。我考虑过使用数组表（即开始频率、停止频率、频率步长和响应数组），但数组大小可能会有很大差异，这似乎同样低效。

是否有存储此类数据的推荐做法？存储仪器数据时这似乎是一项常见任务，但我似乎无法在网络搜索中找到任何内容。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T19:04:52.977

对我来说，这看起来像是经典的 1:N 关系。“1”是测量会话，“N”是在该会话中进行的所有测量（即数据点）。这是由两个表和它们之间的一个外键建模的，类似于：

![在此处输入图像描述](../Images/08a1a100fd20569c3551b95212aac6cc.png)

调整字段以满足您的需求，但这种通用设计应该能够处理大量数据和每个会话的不同数量的测量。

话虽如此，MS Access 历来对可存储在单个数据库中的数据大小有很大限制。如果您达到这些限制，请考虑使用“真正的”DBMS。

# apache - http/https 重写不起作用，将 index.php 添加到路径

> ID：14342834
> 
> 赞同：0
> 
> 时间：2013-01-15T17:00:59.463
> 
> 标签：apache, .htaccess, mod-rewrite

我正在尝试向网站添加一些安全页面。站点中的链接都使用当前协议（即独立于协议，路径以 开头`//`）。

我需要路径`/info/season-tickets/*`并`/ticketcontroller/*`使用 https，所有其他人都使用 http。

我已经尝试构建规则来执行以下操作（暂时忽略票务控制器部分）：

```
If Port==80 and Path==/info/season-tickets/, rewrite with https
If Port==443 and Path!=/info/season-tickets/, rewrite with http 
```

但是，当我访问`/info/season-tickets/`而不是重定向到 https 版本时，我得到`example.com/index.php/info/season-tickets`

.htaccess 在下面 - 我的尝试在下面`# Force https on certain pages`和`# Force http everywhere else`，其他位来自 Kohana 框架

```
# Turn on URL rewriting
RewriteEngine On

# Installation directory
RewriteBase /

# Force https on certain pages
RewriteCond %{SERVER_PORT} 80
RewriteCond %{REQUEST_URI} ^/info/season-tickets/?
RewriteRule ^(.*)$ https://www.example.com/$1 [R,L]

# Force http everywhere else
RewriteCond %{SERVER_PORT} 443
RewriteCond %{REQUEST_URI} !^/info/season-tickets/?
RewriteRule ^(.*)$ http://www.example.com/$1 [R,L]

# Protect hidden files from being viewed
<Files .*>
    Order Deny,Allow
    Deny From All
</Files>

# Protect application and system files from being viewed
RewriteRule ^(?:application|modules|system)\b index.php/$0 [L]

# Allow any files or directories that exist to be displayed directly
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d

# Rewrite all other URLs to index.php/URL
RewriteRule .* index.php/$0 [PT] 
```

我尝试重新排序规则以查看是否修复了它，但它没有。

任何想法为什么这不起作用（`http://htaccess.madewithlove.be/`表明它应该起作用）......

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T13:26:47.507

我已经解决了这个问题，不是用 htaccess，而是在 index.php 文件中（所有请求都通过这个）。

默认情况下，我假设 port `80`。然后，如果`$_SERVER['REQUEST_URI']`在一组安全路径中，我将变量切换为`443`.

然后，如果`$required_port != $_SERVER['SERVER_PORT']`，我重定向和`exit()`。

# url - REST URL 命名约定 /items/{id} 与 /items?id={id}

> ID：14342835
> 
> 赞同：9
> 
> 时间：2013-01-15T17:01:01.040
> 
> 标签：url, rest, naming-conventions

我知道在 MVC 模式和 REST 服务中，使用 URI 是很常见的，`/items/{id}`但是在 URI 中使用查询参数有什么不好的呢？

`GET /items/{id}`对比`GET /items?id={id}`

此外，假设一个实体具有指向某个相关（例如父）实体的“referenceId”字段，我需要创建 REST 服务来获取父实体的所有项目，哪种方式更好：

```
GET(POST) /items/parent/{parentId} 
```

或者

```
GET(POST) /items?parent={parentId} 
```

将感谢有助于解决我为 REST 服务构建 URL 的主观问题的见解。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-15T17:52:01.397

我会使用以下方案。

```
/items/id 
```

这唯一地解决了具有 id 的项目资源`id`。我们没有使用参数作为参数来唯一地寻址该资源（与其他选项一样）。正如 miguelcobain 建议的那样。

```
/parent/id/items 
```

这`id`是一个 id，用于唯一寻址父资源以及我们从那些我们收集/检索它引用的项目的资源。从您在问题中所说的来看，似乎 parent 引用了多个项目，例如容器或集合。

我为此使用的约定是从左到右缩小范围。因此，万一项目可能是`active`或`inactive`。因此，项目有一个属性或属性是`active`or `inactive`。缩小范围，我得到以下方案：

```
/items/active
/parent/id/active 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-15T18:10:48.173

对于你的第一个问题：

`/items/{id}`应该检索具有指定 id 或`404`不存在的单个资源。

`/items/?id={id}`应该检索一个数组（即使数组中只有一个），因为您正在查询集合。

对于你的第二个问题：

我同意@miguelcobain 的评估——如果该项目是一个特定的资源/实体，只需使用正确的资源路径来检索它。

为了使消费者更容易做到这一点，请创建一个[链接标头](https://www.rfc-editor.org/rfc/rfc5988)，`rel="parent"`并/或在子资源中包含 uri。有关链接头的示例，请参阅 GitHub 的[分页 api](http://developer.github.com/v3/#pagination)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-15T17:38:46.507

当然，REST 原则并不关心 URL 的美学细节。它只是要求每个资源都应该是唯一可寻址的。

此外，使用查询参数来唯一地处理“某种”的东西违反了“参数”的语义，不是吗？参数应该是可选的、附加的和参数化的。例如，对一组项目进行详细搜索。

在某些情况下，您所写的内容可能有意义。这取决于。

在您的示例中，**该项目真的是资源**吗？如果没有，你可以这样做`GET(POST) /parents/{parentId}`。

如果`parent`是，比如说，一个布尔值，并且您想搜索其父项等于 true 的项目，那么使用参数是有意义的。但是由于您明确表示您想要一个具有特定 ID 的父级，我假设父级本身就是一个资源，我会使用您的选项 1 唯一地处理该资源。

我希望我说清楚了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-10-01T06:52:52.450

在我看来，没有规则可循。

`items/{id}`- 此约定适用于通过给定 id 获取项目。如果用户不提供 id 则返回 404 状态码。

`items/id={id}&name={name}`- 这种类型的约定适用于按给定条件搜索多个项目。如果没有找到任何项目，则**不是**404 情况，您只需说“我已成功找到任何符合您的搜索条件的内容”

# facebook - cURL 在 Facebook API SDK 处引发异常

> ID：14342837
> 
> 赞同：1
> 
> 时间：2013-01-15T17:01:16.253
> 
> 标签：facebook, apache, curl, wamp

我正在尝试从我的 Facebook 应用程序中以用户身份发布图像。目前，此功能仍在开发中，当我尝试使用`WAMP server`on测试它时`localhost`，类中的一个`cURL`函数`Facebook API SDK`会引发异常错误：

> {"error_code":60,"error":{"message":"SSL 证书问题，验证 CA 证书是否正常。详细信息：\nerror:14090086:SSL 例程：SSL3_GET_SERVER_CERTIFICATE:certificate verify failed","type": "CurlException"}}null0.90752005577087 145684992172054|e259ec293812a5276a61d3181c395077

我已经检查过，并且`php.ini`在`Apache`和`PHP`目录中都有正确的设置。

我试图在`Easy PHP`with`PHP 5.4`和 on `WAMP`with上运行这个`PHP 5.3`。（启用 cURL 扩展）。

我已经`open SSL`安装在两个本地服务器上。

我知道您可以通过更改配置来解决这个问题`CURL_opt`，但是修改 Facebook 基类并危及我的应用程序的安全性（中间人攻击）对我来说确实是最后的手段。

提前感谢您的帮助！

我的代码：

```
test.php:
<?php
session_start();

require 'FB_auth.php';
require 'includes.php';
require 'functions_fb.php';

    $start = (float) array_sum(explode(' ',microtime())); 

    //echo json_encode(photoToFacebook(299, 402, 134));
    // echo json_encode(photoToFacebook(724, 402, 165));

    // postToFacebook($db, 402, 134);

    $end = (float) array_sum(explode(' ',microtime())); 
    $duration = ($end-$start);

    echo $duration;
    echo "<br/>" . $facebook->getAccessToken();

?>

functions_fb.php

<?php

function photoToFacebook($hr_id, $user_id, $job_id){

        global $db, $FEED_PATH, $JOB_IMAGES_FOLDER , $facebook;
        $path = $_SERVER['DOCUMENT_ROOT'] . "/";
        $JOB_IMAGES_FOLDER = "images/job_images/";

        $company = $db->getCompany($hr_id);

        // perapre the job photo.
        $photo = $db->getJobPhoto($job_id);
        if (empty($photo)){
            $photo = $db->getLogo($hr_id);
        }
        else{
            $photo = $JOB_IMAGES_FOLDER . $photo;
        }

        try{
            // At the time of writing it is necessary to enable upload support in the Facebook SDK, you do this with the line:
            $facebook->setFileUploadSupport(true);

            // Get album id if exists.
            $album_uid = $db->getAlbumId($user_id);
            $fb_user_id = $db->getFBUserId($user_id);
            if (empty($album_uid)){

                // Create an album
                $album_details = array(
                        'message'=> 'Check out my company\'s job opportunities',
                        'name'=> "Job opportunities at {$company}"
                );

                $create_album = $facebook->api("/{$fb_user_id}/albums", 'post', $album_details);
                echo json_encode($create_album);

                $album_uid = $create_album["id"];
                $db->saveAlbumId($user_id, $create_album["id"]);
            }
            $job_title = $db->getJobTitle($job_id);

            $link = Bitly::make_bitly_url($FEED_PATH . "show_job.php?jid={$job_id}&th_uid={$user_id}&tp=1&pc=1", BITLY_APP_USERNAME,BITLY_APP_KEY,'json');
            $photo_details = array(
                'message'=> $job_title . "!\n" . $company . " is looking for you.\nOpen the link for details and apply.\n" . $link
            );

            $path .= $photo;
            $photo_details['image'] = '@' . $path; //realpath($file);

            // echo $album_uid;

            $upload_photo = $facebook->api("{$fb_user_id}/photos", 'post', $photo_details);

            // $db->updateAutoPostActivity($user_id, $job_id,1, json_encode($upload_photo));
            // $db->updateAutoPostJob($job_id, $user_id);

            return $upload_photo;
        }
        catch (FacebookApiException $e) {
            echo "error:" . json_encode($e->getResult());
            // $db->updateAutoPostActivity($user_id, $job_id,1, json_encode($e->getResult()));
            // AtavMail::SendRichedMail(null , "", "Error on auto process - posting photo to FB", "Where - Job Id: {$job_id} , User Id: {$user_id}", json_encode($e->getResult()));
        }

    }
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T08:48:47.607

我通过将以下行添加到 base_facebook.php 文件中解决了这个问题：

```
 public static $CURL_OPTS = array(
     //
     //
     //
    CURLOPT_SSL_VERIFYPEER => false,
  ); 
```

请注意，这只是一个开发环境解决方案，在您的实际应用程序中使用它可能会导致安全风险。

[请花时间查看此链接上的完整解决方案： http](http://unitstep.net/blog/2009/05/05/using-curl-in-php-to-access-https-ssltls-protected-sites/) ://unitstep.net/blog/2009/05/05/using-curl-in-php-to-access-https-ssltls-protected-sites/

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-04T04:04:25.593

将 SSL 验证设置为 false 会破坏 SSL 的目的。一个合适的解决方案是为 CURL 设置 CA 证书。

解决方案 1（更改 PHP.ini）：

1.  [从http://curl.haxx.se/docs/caextract.html](http://curl.haxx.se/docs/caextract.html)下载 CA 包 (cacert.pem)
2.  将它放在您的本地系统上（例如：C:\xampp\cacert.pem）
3.  打开你的 php.ini
4.  将 curl.ca_info 选项设置为指向 cacert.pem 的位置

    ```
    Example: curl.ca_info="C:\xampp\cacert.pem" 
    ```

5.  重启阿帕奇

解决方案 2（在每次 CURL 调用之前设置选项）

1.  [从http://curl.haxx.se/docs/caextract.html](http://curl.haxx.se/docs/caextract.html)下载 CA 包 (cacert.pem)
2.  将它放在您的本地系统上（例如：C:\xampp\cacert.pem）
3.  编写以下代码：

    ```
    curl_setopt ($ch, CURLOPT_SSL_VERIFYPEER, TRUE); 
    curl_setopt ($ch, CURLOPT_CAINFO, "pathto\cacert.pem"); 
    ```

来源：[http ://tumblr.wehavefaces.net/post/52114563111/environment-windows-xampp-curl-library](http://tumblr.wehavefaces.net/post/52114563111/environment-windows-xampp-curl-library)

# java - GWTTestCase 在生产模式和使用多个浏览器时失败

> ID：14342838
> 
> 赞同：0
> 
> 时间：2013-01-15T17:01:18.607
> 
> 标签：java, gwt, junit, gxt, gwttestcase

我正在开发一个使用 GWT 和 GXT 并进行大量单元测试的 Web 应用程序。在生产模式之外运行测试可以正常工作。一旦我尝试在生产模式下执行 GWT 测试用例（或为超过 1 个浏览器编译），我就会收到以下错误：

```
com.google.gwt.junit.client.TimeoutException  
message="The browser did not contact the server within 60000ms. - 1 client(s) haven't responded back to JUnitShell since the start of the test. Actual time elapsed: 60.008 seconds. 
Try increasing this timeout using the '-testBeginTimeout minutes' option The default value of minutes is 1, i.e., the server waits 1 minute or 60 seconds. ">
com.google.gwt.junit.client.TimeoutException: The browser did not contact the server within 60000ms. - 1 client(s) haven't responded back to JUnitShell since the start of the test. 
Actual time elapsed: 60.008 seconds. Try increasing this timeout using the '-testBeginTimeout minutes' option The default value of minutes is 1, i.e., the server waits 1 minute or 60 seconds.   
at com.google.gwt.junit.JUnitShell.notDone(JUnitShell.java:1041)   
at com.google.gwt.junit.JUnitShell.runTestImpl(JUnitShell.java:1376)   
at com.google.gwt.junit.JUnitShell.runTestImpl(JUnitShell.java:1304)  
at com.google.gwt.junit.JUnitShell.runTest(JUnitShell.java:652)  
at com.google.gwt.junit.client.GWTTestCase.runTest(GWTTestCase.java:441) 
at com.google.gwt.junit.client.GWTTestCase.run(GWTTestCase.java:296) 
```

同样，如果没有生产模式设置（并且只为一个浏览器编译），GWT 测试工作正常，当使用附加参数执行测试时（或为多个浏览器编译时），问题就会出现：

```
<sysproperty key="gwt.args" value="-prod -standardsMode -logLevel WARN" />  
<sysproperty key="java.awt.headless" value="true" /> 
```

我尝试在开始测试之前增加超时（-testBeginTimeout），结果相似（唯一的区别是失败前的延迟更长）。在执行具有相同结果的测试时，我还尝试增加超时之前的等待时间。

如上所述，在为多个浏览器编译后尝试运行 GWTTestCase 测试时也会出现此问题。我在解释这两个问题时有点不知所措，随后的谷歌搜索未能找到任何有用的信息。

这似乎是一个配置问题，无论是使用 GWT 还是我的 ANT 设置，但我似乎无法进一步缩小范围。有没有其他人遇到过这个问题并对我有一些急需的建议？

单浏览器编译：chrome
多浏览器编译：chrome,gecko1_8,ie8

库：
GWT 版本：2.5.0rc1
GXT 版本：3.0.0b
Junit 版本：4.11（也试过 4.10）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T15:01:12.777

事实证明，在 gwt.xml 文件中指定“gxt.user.agent”属性是一个问题。通过指定 GWT 的“user.agent”属性，我现在能够针对多个浏览器进行编译并执行我的测试，而不会导致 GWTTestCase 测试无法从浏览器获取连接。

# javascript - 出现“未捕获的错误：无法解析绑定”错误但代码有效

> ID：14342845
> 
> 赞同：0
> 
> 时间：2013-01-15T17:01:38.017
> 
> 标签：javascript, knockout.js

我正在尝试编写一个称为分隔符的自定义绑定。

它只是将传递的 observableArray 对象拼接成更小的数组，并用模板包装其元素。它正在工作，但我收到一个错误：

**未捕获的错误：无法解析绑定。消息：ReferenceError：未定义列表；绑定值：foreach：列表**

这里有什么问题 ？我看不到:)

**HTML**

```
<form data-bind="divider : { size : 4, list: controls , templateName : 'unit' }" class="form-horizontal"></form>

<script id="unit" type="text/x-jquery-tmpl">
    <div class="control-group">
      <div class="box" data-bind="template: { name : 'controlTemplate', foreach : $data }"></div> 
    </div>
</script>

<script id="controlTemplate" type="text/x-jquery-tmpl">
  <label data-bind="text:label" class="control-label" />
  <div class="controls">
    : <input data-bind="value:value" type="text" class="input-small"></input>
  </div>
</script>

<script id="dividerTemplate" type="text/x-jquery-tmpl">
    <div class="dividerContainer"  data-bind="foreach : list ">
      <div class="divider" data-bind="template : { name : $parent.name }"></div>               
    </div>
</script> 
```

**JAVASCRIPT**

```
function l(log) {
 console.log(log); 
}

function Control(label,value) { 
  var self = this;  
  this.label = ko.observable(label);
  this.value = ko.observable(value);
}

function ViewModel() {

  var self = this;  

  this.controls = ko.observableArray();  

  for(var i=1;i<=10;i++) {
    this.controls.push(new Control('TEST'+i,'VALUE'+i));
  }  
}  

ko.bindingHandlers.divider = {

    init: function (element, valueAccessor, allBindingsAccessor, data, context) {

      var defaultOptions = { size : 5 };
      var options = $.extend(true, defaultOptions, valueAccessor()); 

      var seperatedList = ko.observable([]);

      if( options.list().length > 0 && options.templateName !== null) {

        var length = options.list().length;
        var size = options.size;
        var templateName = options.templateName;

        for(var i=0; i< (length/size); i++)          
                seperatedList().push(options.list.slice(i*size, (i+1)*size) );

        l(ko.toJSON(seperatedList));

        ko.applyBindingsToNode(  $(element).get(0),
                                 {template: { name: 'dividerTemplate' , data : { list: seperatedList , name : templateName}} }
                              );
        }

    }
};

$(document).ready(function(){

  var viewModel = new ViewModel();  
  ko.applyBindings(viewModel);

}); 
```

[JSFIDDLE](http://jsfiddle.net/gurkavcu/P38rd/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T17:44:33.433

您将希望您的自定义绑定的 init 函数返回：

```
 return { controlsDescendantBindings: true }; 
```

这可确保主绑定循环不会尝试将绑定应用到由于您从绑定中手动调用模板绑定而呈现的新元素。

一些额外的信息：[这里](http://knockoutjs.com/documentation/custom-bindings-controlling-descendant-bindings.html)和[这里](http://www.knockmeout.net/2012/05/quick-tip-skip-binding.html)

# javascript - 如何在 Meteor 中访问 process.env？

> ID：14342848
> 
> 赞同：7
> 
> 时间：2013-01-15T17:01:51.710
> 
> 标签：javascript, node.js, meteor

我努力了：

```
alert(process.env.MONGO_URL); 
```

我的 Meteor 项目无处不在，并且总是得到：

```
Uncaught ReferenceError: process is not defined 
```

我不确定我做错了什么。我需要包括一些东西吗？Meteor 是用 javascript 编写的，并且所有相同的 API 都可用，那么为什么不定义进程呢？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-15T17:12:49.387

你可以试试

```
if (Meteor.isServer) {
  console.log(process.env);
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-07-24T21:16:35.290

您必须从服务器端获取环境。试试下面的。

```
//In the client side
if (Meteor.isClient) {

   Meteor.call('getMongoUrlEnv', function(err, results) {
     alert("Mongo_URL=",results);
   });

}

if (Meteor.isServer) {

   Meteor.methods({
      getMongoUrlEnv: function(){
           var mongoURL = process.env.MONGO_URL;
           return mongoURL;
      }
   });
} 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2017-08-08T05:38:34.153

您可以使用此功能请求服务器端环境。

```
//In the client side
if (Meteor.isClient) {

   Meteor.call('getEnv', "VARIABLE_NAME", function(err, results) {
     alert(results);
   });

}

if (Meteor.isServer) {

   Meteor.methods({
      getEnv: function(node){

           return process.env[node];;
      }
   });
} 
```

# sql - sql 如果语法不正确

> ID：14342849
> 
> 赞同：0
> 
> 时间：2013-01-15T17:02:10.627
> 
> 标签：sql, if-statement, syntax

下面的 sql 语句（没有 if）返回 1 行，1 列 = 8。但是如果我在 SELECT 和 <. 我想要做的是，如果返回的测试为 true 的行数少于 50。如果返回 50 行，则返回 false。

谢谢您的帮助

```
IF SELECT COUNT([VDeck_ID]) FROM [SecondLifeDatabases].[dbo].[YuGiOh-Cards]
    WHERE [User_ID] = 
            (SELECT [ID] FROM [SecondLifeDatabases].[dbo].[YuGiOh-Users] 
            WHERE [UUID] = 'D38C3475-C995-4EB2-85D0-F2A3ED1D23A0') 
                and [VDeck_ID] = 
                    (SELECT [ID] FROM [SecondLifeDatabases].[dbo].[YuGiOh-VDecks]
                        WHERE [DeckName] = 'NewDeckName')
    < 50
BEGIN
    UPDATE [SecondLifeDatabases].[dbo].[YuGiOh-Cards] 
    SET [VDeck_ID] = 
        (SELECT [ID] FROM [SecondLifeDatabases].[dbo].[YuGiOh-VDecks] 
        WHERE [User_ID] = 
            (SELECT [ID] FROM [SecondLifeDatabases].[dbo].[YuGiOh-Users] 
            WHERE [UUID] = 'D38C3475-C995-4EB2-85D0-F2A3ED1D23A0') 
                and [DeckName] = 'NewDeckName') 
                WHERE [ID] = '11'
END 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T17:06:19.193

`select`在子句中的语句周围加上括号`if`：

```
IF (SELECT COUNT([VDeck_ID]) FROM [SecondLifeDatabases].[dbo].[YuGiOh-Cards]
    WHERE [User_ID] = 
            (SELECT [ID] FROM [SecondLifeDatabases].[dbo].[YuGiOh-Users] 
            WHERE [UUID] = 'D38C3475-C995-4EB2-85D0-F2A3ED1D23A0') 
                and [VDeck_ID] = 
                    (SELECT [ID] FROM [SecondLifeDatabases].[dbo].[YuGiOh-VDecks]
                        WHERE [DeckName] = 'NewDeckName')
   )
    < 50
BEGIN
    UPDATE [SecondLifeDatabases].[dbo].[YuGiOh-Cards] 
    SET [VDeck_ID] = 
        (SELECT [ID] FROM [SecondLifeDatabases].[dbo].[YuGiOh-VDecks] 
        WHERE [User_ID] = 
            (SELECT [ID] FROM [SecondLifeDatabases].[dbo].[YuGiOh-Users] 
            WHERE [UUID] = 'D38C3475-C995-4EB2-85D0-F2A3ED1D23A0') 
                and [DeckName] = 'NewDeckName') 
                WHERE [ID] = '11'
END 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T17:06:17.833

你需要括号...

```
IF (SELECT COUNT(..) FROM ...) > 50 
```

# java - 建议非常快（微秒）的 java 日志记录？

> ID：14342854
> 
> 赞同：3
> 
> 时间：2013-01-15T17:02:32.577
> 
> 标签：java, multithreading, logging, real-time

我想在我的声音处理多线程应用程序中跟踪事件。它只有在某些情况下才会出现一些错误。

如果我尝试使用传统的日志记录（slf4j 和 log4j 到控制台被 Eclipse 拦截），那么错误就会消失，因为日志记录命令会引入毫秒级延迟并且一切都会有所不同。

如何使记录速度更快（数百或数千次）或以其他方式记录？

**更新**

现在使用带有文件附加器的 logback 就足够了。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-15T17:04:15.030

答案很简单：永远不要在 Eclipse 控制台上打印**任何内容。**仅写入文件并在完成后查看文件。Log4j 本身的性能非常好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-15T17:12:54.787

您可能会发现将文本写入文件已经足够快了，所以我将从它开始。

如果你需要亚微秒级的文本或二进制日志，你可以使用我写的[Java Chronicle 。](https://github.com/peter-lawrey/Java-Chronicle)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-12-30T21:09:22.383

如果要达到纳秒级，则必须采用异步方式，这意味着磁盘 I/O 由单独的线程执行。无锁队列（即[Disruptor](http://lmax-exchange.github.io/disruptor/)、[CoralQueue](http://www.coralblocks.com/index.php/category/coralqueue/)等）非常有效地提供线程之间的流水线，而不会为 GC 产生任何垃圾。

对于非常快（~ 100 nanos / msg）的记录器，您可以检查[CoralLog](http://www.coralblocks.com/index.php/category/corallog/)。

对于非常快（~ 70 nanos /msg）的读/写存储，您可以检查[CoralStore](http://www.coralblocks.com/index.php/category/coralstore/)。

**免责声明：**我是 CoralQueue、CoralLog 和 CoralStore 的开发者之一。

# php - 查找匹配值的数组键

> ID：14342856
> 
> 赞同：0
> 
> 时间：2013-01-15T17:02:52.303
> 
> 标签：php, arrays, variables, matching

我尝试获取匹配值的数组键。它看起来像这样：

```
$someId = 2

$array[0][id]   = "1";
$array[0][firstname]  = "dude1";

$array[1][id]   = "2";
$array[1][firstname]  = "dude2";

$array[2][id]   = "3";
$array[2][firstname]  = "dude3"; 
```

如何通过将 var "$someId = 2" 与数组中的唯一 ID ($array[1][id]) 匹配来获取数组键，例如 "1" ($array[1])？

基本上： $someId === $array[x][id] > 返回匹配的数组 $array[x] 。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T17:07:35.777

一个简单的`foreach`就可以了：

```
$someId = 2;

foreach($array as $person)
{
    if($person['id'] == $someId)
    {
        // found a match, do something with $person
        // ...
        break; // remove the break if you want to continue searching after a match
    }
} 
```

如果您想要密钥，请更改为

```
foreach($array as $key => $person) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T17:14:31.240

array_filter() 保留关联性

```
$result = array_filter(
    $array,
    function ($item) use ($personId) {
        return ($item['id'] == $personId);
    }
);

var_dump(array_keys($result)); 
```

# jquery - 如果表单正确，则提交按钮上的 jquery 操作

> ID：14342859
> 
> 赞同：1
> 
> 时间：2013-01-15T17:03:04.620
> 
> 标签：jquery

我在 iframe 中有一个表单，并且正在尝试使用 jquery click 功能关闭 iframe，但只有在正确提交表单的情况下 - 表单是 wordpress 插件（User Meta Pro）的一部分并且具有验证 - 不发送表单如果用户详细信息不正确。由于某种原因，我无法覆盖表单目标（到父级），所以必须尝试这种方式。我尝试的代码（准备好文档）是：

```
$(".um_login_button").click(function(){
parent.$.fancybox.close();
}); 
```

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T17:06:59.423

您的代码没有问题，也许试试这个？

```
window.top.$.fancybox.close(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T15:26:06.640

通过在与父级相同的页面上使用 div 来解决。

# c# - UpdatePanel 中的 GridView 在无效提交后不再执行行命令

> ID：14342862
> 
> 赞同：0
> 
> 时间：2013-01-15T17:03:17.407
> 
> 标签：c#, asp.net, gridview, asp.net-ajax, updatepanel

代码摘录：

```
<asp:UpdatePanel runat="server" ChildrenAsTriggers="true">
<ContentTemplate>

    <asp:ValidationSummary runat="server" DisplayMode="List" />

    <asp:GridView ID="MyGridView" runat="server" AllowPaging="true" AllowSorting="true"
            DataKeyNames="itemId"
            OnRowDataBound="MyGridView_RowDataBound"
            onPageIndexChanging="MyGridView_PageIndexChanging"
            onSorting="MyGridView_Sorting"
            OnRowEditing="MyGridView_RowEditing"
            OnRowCancelingEdit="MyGridView_RowCancelingEdit"
            OnRowUpdating="MyGridView_RowUpdating"
            OnRowDeleting="MyGridView_RowDeleting"
            OnRowCommand="MyGridView_RowCommand"
            AutoGenerateColumns="false"
            onSelectedIndexChanged="MyGridView_SelectedIndexChanged"
            CssClass="adminTable">

            <Columns>
               <asp:TemplateField HeaderText="Name" SortExpression="name">
                    <EditItemTemplate>
                        <asp:TextBox ID="editName" runat="server" Text='<%# Bind("name") %>' />
                        <asp:RequiredFieldValidator runat="server" ControlToValidate="editName"
                            ErrorMessage="Please enter a Name" Display="None" />
                    </EditItemTemplate>
                    <ItemTemplate>
                        <asp:Label ID="name" runat="server" Text='<%# Bind("name") %>' />
                    </ItemTemplate>
                    <FooterTemplate>
                        <asp:TextBox ID="newName" runat="server" />
                        <asp:RequiredFieldValidator runat="server" ControlToValidate="newName"
                            ErrorMessage="Please enter a Name" Display="None" />
                    </FooterTemplate>
                </asp:TemplateField>

                <%-- Some additional Similar Templates here --%>

                <asp:TemplateField>
                    <EditItemTemplate>
                        <asp:LinkButton ID="linkUpdate" runat="server" CausesValidation="true"
                            CommandName="Update" Text="Save" />
                        <asp:LinkButton ID="linkCancel" runat="server" CausesValidation="false"
                            CommandName="Cancel" Text="Cancel" />
                    </EditItemTemplate>
                    <ItemTemplate>
                        <asp:LinkButton ID="linkEdit" runat="server" CausesValidation="false"
                            CommandName="Edit" Text="Edit" />
                        <asp:LinkButton ID="linkDelete" runat="server" CausesValidation="false"
                            CommandName="Delete" Text="Delete"
                            OnClientClick="return confirmDelete();" />
                    </ItemTemplate>
                    <FooterTemplate>
                        <asp:LinkButton ID="linkUpdate" runat="server" CausesValidation="true"
                            CommandName="Insert" Text="Save" />
                        <asp:LinkButton ID="linkCancel" runat="server" CausesValidation="false"
                            CommandName="Cancel" Text="Cancel" />
                    </FooterTemplate>
                </asp:TemplateField>
            </Columns>
            <pagersettings mode="Numeric" position="Top" pagebuttoncount="10" />
            <pagerstyle height="30px" verticalalign="Top" horizontalalign="Right" />
    </asp:GridView>

    <asp:LinkButton ID="LinkAdd" runat="server" OnClick="LinkAdd_OnClick" Text="Add"
        CausesValidation="false" />

</ContentTemplate>
 </asp:UpdatePanel> 
```

设想：

单击任意行中的编辑按钮。代码隐藏 OnRowEditing 集`MyGridView.EditIndex = e.NewEditIndex;`和其他几个小任务。将名称字段编辑为空白。单击以保存在该行中。相应的消息与验证摘要一起显示在顶部。现在单击该行中的取消。没发生什么事。单击任意位置的任何其他按钮（排序、分页、在不同行中编辑等）。没发生什么事。

只要所有字段保持有效，一切都会有效。此外，在无效提交后，可以输入编辑字段，但这不会改变结果。

各种事件处理程序（即 OnRowCancelingEdit、OnRowCommand、OnRowDeleting 等）中的断点表明没有调用进入代码隐藏。

当 GridView 不在 UpdatePanel 中时，一切都按预期工作。但是，希望在 UpdatePanel 中有这些，这样页面就不会“闪烁”或每个页面、排序或编辑。

尝试的事情：

*   将 UpdatePanel 的 UpdateMode 更改为 Always 和 Conditional。
*   删除 ChildrenAsTriggers

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-30T20:19:39.093

我从 SO 以外的人那里得到了这个答案，我觉得这是我自己的答案很尴尬。但如果它对其他人有帮助，我觉得我应该在这里展示它。

我必须将所有验证器和摘要放入`ValidationGroup`s 并将所有链接和按钮设置为`CausesValidation="false"`. 然后，在 Code-Behind 中，在相应方法的顶部，如果失败`Page.Validate("groupName")`，则立即调用。`return;`这会强制进行重新设置的回发`UpdatePanel`。

# ios - 使用自定义路线制作 iOS 动画

> ID：14342864
> 
> 赞同：0
> 
> 时间：2013-01-15T17:03:23.687
> 
> 标签：ios, objective-c, animation, transformation

我有一种方法可以以非常特定的路线转换我的视图的一些子视图。所以这个方法有一个 CGFloat 参数，它在 0.0f 和 1.0f 之间变化。

我想知道哪个是动画这个转换的最佳方式（比如它将从 transform:0.0f 开始并在 transform:1.0f 结束）。显然 UIView 的 animateWithDuration 不起作用，因为我希望我的子视图完全按照我的意愿移动。

我应该编写自己的基于自定义间隔的动画函数来做到这一点吗？（我不想说实话）。或者有没有简单的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T17:43:12.877

用这个`[UIView animateWithDuration:`

```
[UIView animateWithDuration:<> delay:<> options:<> animations:^{
                         <animation code 1>
} completion:^(BOOL finished){
                         <code for after animatop>
                     }]; 
```

像这样

```
[UIView animateWithDuration:<> delay:<> options:<> animations:^{
                         <animation code 1>
} completion:^(BOOL finished){
[UIView animateWithDuration:<> delay:<> options:<> animations:^{
                         <animation code 1>
} completion:^(BOOL finished){
                         <code for after animatop>
                     }];
                     }]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T14:42:19.383

如果有人有兴趣，我使用了这个名为[CPAccelerationTimer](https://github.com/yangmeyer/CPAccelerationTimer)的类，它成功了。它基本上是一个具有自定义加速的 NSTimer

# javascript - 意外的标识符：Javascript

> ID：14342865
> 
> 赞同：0
> 
> 时间：2013-01-15T17:03:32.030
> 
> 标签：javascript, identifier

我无法弄清楚如何让这段代码正常工作。我收到了该行的意外标识符：

```
complete:function() { 
```

从此代码块：

```
$(document).ready(function(){

var doorOpen = false;

$("a[href=#andrew]").click(function() {

    if (doorOpen) { // set animation duration for door close, based on actually needed to animate the door closed or not
        var duration = 1500;
    } else {
        var duration = 0;
    }

    $("#rightdoor,#leftdoor").animate(
        {"marginLeft":"0px"},
        {duration:duration},
            complete:function() {
                $('.pic2 .pic3 .pic4 .pic5').css('zIndex', 1);  //puts wrong pics in back
                $('.pic1').css('zIndex', 2);  //brings right pic into view
                $('#rightdoor').animate({  //opens doors again
                 marginLeft: "150px",
                }, 1500);
                $('#leftdoor').animate({
                 marginLeft: "-150px",
                }, 1500);
            }
    );

    doorOpen = true;

    return false;
}); 
```

});

我是 Javascript 新手，所以我可能在这里遗漏了一些明显的东西..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T17:05:24.697

看线：

```
$("#rightdoor,#leftdoor").animate({"marginLeft":"0px"}{duration:duration,complete:function() { 
```

您在动画的前两个参数之间缺少逗号。

它应该是：

```
$("#rightdoor,#leftdoor").animate({"marginLeft":"0px"},{duration:duration},complete:function() { 
```

最好更正对象的最后一个键值对之后的多余逗号。它将使您免于 IE 中的错误。

您应该将动画调用更改为：

```
$("#rightdoor,#leftdoor").animate(
    {"marginLeft":"0px"},
    {duration:duration,
        complete:function() {
            $('.pic2 .pic3 .pic4 .pic5').css('zIndex', 1);  //puts wrong pics in back
            $('.pic1').css('zIndex', 2);  //brings right pic into view
            $('#rightdoor').animate({  //opens doors again
             marginLeft: "150px",
            }, 1500);
            $('#leftdoor').animate({
             marginLeft: "-150px",
            }, 1500);
        }
    }
); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T17:54:08.437

跟随线仍然是错误的

```
$("#rightdoor,#leftdoor").animate({"marginLeft":"0px"}      duration:duration,complete:function() { 
```

您不能将参数命名为“duration”和“complete”，正确的行是

```
$("#rightdoor,#leftdoor").animate({"marginLeft":"0px"}, duration, function() { 
```

还要注意变量“duration”，你确实把它放在了一个 if 块中，变量在“animation”行是未定义的，你可以改变“duration”的声明，像这样：

```
$("a[href=#andrew]").click(function() {

    var duration = 0;
    if (doorOpen) { // set animation duration for door close, based on actually needed to animate the door closed or not
        duration = 1500;
    } 
```

# asp.net - Intellisense 声明强类型 DataSet 查询的参数是 Decimal，而它应该是 String

> ID：14342866
> 
> 赞同：0
> 
> 时间：2013-01-15T17:03:32.530
> 
> 标签：asp.net, vb.net, parameters, intellisense, strongly-typed-dataset

我们对在 Visual Studio 数据集设计器中创建的强类型数据集进行了以下查询：

```
SELECT ID, PaymentAmount, PaymentDate, WhatWasPaymentFor
  FROM Payments
 WHERE ParentID = @ParentID
   AND (@PaymentDate is null OR PaymentDate = @PaymentDate)
   AND (@PaymentAmount is null OR PaymentAmount = @PaymentAmount)
   AND ((@SearchValue is null OR 
       (WhatWasPaymentFor LIKE '%' + @SearchValue  + '%' OR @SearchValue='ALL'))
       ) 
```

在 VB.Net 代码隐藏文件中，我们调用查询来填充 DataSet，如下所示：

```
Dim tblObject = theTableAdapter.GetDataByAllInOne(dcmParentsId, Nothing, Nothing, TextBoxSearch.Text) 
```

当我认为它是字符串时，Intellisense 将第 4 个参数显示为十进制。当鼠标悬停在@SearchValue 的参数上时，我发现了这一点。

执行此编码时，将显示此错误：

```
Conversion from string "Books" to type 'Decimal' is not valid. 
```

此查询中唯一的十进制列是 PaymentAmount，它恰好是第三个参数而不是第四个参数。

我不确定为什么智能感知指出第四个参数 @SearchValue 是十进制。您能告诉我如何将其更改为字符串吗？

确实发生的一件有趣的事情是，如果在 SQL Server Magagement Studio 中运行，查询将正常工作：

```
DECLARE @SearchValue VARCHAR = 'Books'
DECLARE @ParentID    INT = 3
DECLARE @PaymentDate DATETIME = NULL
DECLARE @PaymentAmount MONEY = NULL

SELECT ID, PaymentAmount, PaymentDate, WhatWasPaymentFor
  FROM Payments
 WHERE ParentID = @ParentID
   AND (@PaymentDate is null OR PaymentDate = @PaymentDate)
   AND (@PaymentAmount is null OR PaymentAmount = @PaymentAmount)
   AND ((@SearchValue is null OR 
    (WhatWasPaymentFor LIKE '%' + @SearchValue  + '%' OR @SearchValue='ALL'))
       ) 
```

也许在我不知道的 DataSet 设计器中需要设置一些东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T21:09:04.693

在设计器中，查询将按照期望的顺序显示期望的参数，即您应该看到类似 GetDataByAllInOne(@ParentID,@PaymentDate,@PaymentAmount,@SearchValue) 的内容。你能先检查一下吗？

# javascript - 在循环中分配 onclick 函数在 JavaScript 中不起作用

> ID：14342871
> 
> 赞同：0
> 
> 时间：2013-01-15T17:03:39.590
> 
> 标签：javascript, function, for-loop, onclick

> **可能重复：**
> [Javascript 循环中的事件处理程序 - 需要闭包吗？](https://stackoverflow.com/questions/341723/event-handlers-inside-a-javascript-loop-need-a-closure)

我在表格单元格中有**href 。**
我正在使用**“for”循环**遍历这些单元格以更改 onclick 函数。
但这不起作用。
这里有 2 个例子：

这**有效**：

```
for (var i = 0; i < tbl.rows.length - 1; i++) { // for each row
    var len = document.getElementById("my_table").rows[i].cells.length-1;
    document.getElementById("my_table").rows[i].cells[len].innerHTML = "X1";
  } 
```

这**不起作用**：

```
for (var i = 0; i < tbl.rows.length; i++) { // for each row
    var len = document.getElementById("my_table").rows[i].cells.length-1;
    document.getElementById("my_table").rows[i].cells[len].onclick = function() {
        deleteRows(i);
    };
  } 
```

有什么问题？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-15T17:10:41.990

```
for (var i = 0; i < tbl.rows.length; i++) { // for each row
    var len = document.getElementById("my_table").rows[i].cells.length-1;
    document.getElementById("my_table").rows[i].cells[len].onclick = (function(index) { return function() {
        deleteRows(index);
    };})(i);
  } 
```

上面的代码应该可以工作。在您的情况下，它不起作用，因为您在 Basic 中`i`定义了一个闭包`for (var i = 0`，`i`您将其传递给定义的`deleteRows`点，此时将等于我的代码为每个循环循环创建新的闭包。欲了解更多信息谷歌 javascript 关闭。`i``for``tbl.rows.length`

# javascript - 使用 RegEx 查找 URL，但未找到其后的值

> ID：14342875
> 
> 赞同：1
> 
> 时间：2013-01-15T17:03:48.790
> 
> 标签：javascript, regex, actionscript

我看到了一些关于此的帖子，但它们是针对 PHP 的（我需要 JavaScript（实际上是 ActionScript（...因为 ActionScript 扩展了 JavaScript）））所以我的问题是如何只捕获逗号、句点、问号或感叹号.

这是我目前所拥有的

```
instructionText.replace(/(https?:\/\/\w.*[\w])/gi, "<a href='$1' target='_blank'>$1</a>"); 
```

但是当我使用文本“访问[http://www.google.com](http://www.google.com) .Hello world”时，它捕获了 hello world 部分。

上面捕获组的结果是“http://google.com.Hello world”。显然，我不想要 URL 之后的任何内容。它们应该是简单的 URL。

主要是，我只想为这些“.,!?”中的任何一个添加一个检查。或空格字符并结束捕获组。它不一定是完美的。

顺便说一句，不确定您是否需要先测试 RegEx，但如果没有，您可以使用[RegExr](http://gskinner.com/RegExr/)。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T19:31:14.093

假设 url 中没有空格，后面有空格或字符串结尾：

```
instructionText.replace( /(https?:\/\/\S+?)(?=[.,!?]?(\s|$))/g, "<a href='$1' target='_blank'>$1</a>" ); 
```

它尽可能少地捕获 'http[s]://' 和非空格字符，直到向前看，可以选择其中一个`.,!?`，然后是空格或字符串结尾。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T19:53:23.473

```
https?\:\/\/((www\\.)?\w*?(\\.\w{2,7})+)(?=\\.|\\,|\\?|\\!|\s) 
```

我想`(?=\\.|\\,|\\?|\\!|\s)`这是你要找的部分？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T17:10:31.623

问题是您正在捕获`.*`后跟 a `\w`，这意味着任何数量的任何内容后跟一个单词...

```
/(https?:\/\/\w.*[\w])/ 
```

你需要让你的通配符捕获不贪婪......

```
/(https?:\/\/\w.*?[\w])/ 
```

所以它会在捕获之前捕获尽可能少的字符`\w`

* * *

**编辑**：更多信息

此外，您的正则表达式非常简单，不幸的是，捕获 url 非常复杂，因为有效和无效的变化太多。您需要为自己设置一条清晰的界限，在其中定义您认为与您的上下文中的 url 匹配的内容。

例如，如果您想确保有效的顶级域，则必须包含类似这样的内容...

```
/https?:\/\/\w.*?\.(com|org|co\.uk| ... etc ... )/ 
```

一旦注册了新的顶级域，它就会过时。

如果你想匹配以协议开头的任何内容，直到下一个空格，这样的事情应该做......

```
/[a-zA-Z]+:\/\/\S+/ 
```

祝你好运！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-15T17:10:47.653

在您的正则表达式中，您正在寻找尽可能多的字符（.* 是贪婪的），其中最后一个字符是 \w 字符。试试这个（快速编辑你的正则表达式）。它应该适用于存在或不存在的`www.`域，以及具有两个或三个字母 tld 的域。

```
https?\:\/\/(www\.)?\w*?\.\w{2,3}(?=[\W]) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2022-02-02T00:37:35.430

感谢@MikeM的回答，我能够使用他的并生成处理来替换链接和电子邮件地址（仅在不存在链接的情况下），省略标点符号，如果其他人需要，请在此处参考：

```
/**
 * Replace URLs and Emails with HTML links
 *
 * This function will replace all URLs and Email Addresses wrapped in HTML links, ONLY if one does not already exist,
 * excluding punctuation (email or url followed by period, comma, etc).
 *
 * @param $content
 *
 * @return string
 * @since 1.0.0
 *
 */
function replace_links( $content ) {

    $content = preg_replace( '"<a[^>]+>.+?</a>(*SKIP)(*FAIL)|(https?:\/\/\S+?)(?=[.,!?]?(\s|$))"', '<a href="$0">$0</a>', $content );
    $content = preg_replace( '"<a[^>]+>.+?</a>(*SKIP)(*FAIL)|(\S+@\S+\.\S+?)(?=[.,!?]?(\s|$))"', '<a href="mailto:$0">$0</a>', $content );

    return $content;
} 
```

查看最新的要点： [https ://gist.github.com/tripflex/0cc930c2afe5f4c73f2aed61cedf95d0](https://gist.github.com/tripflex/0cc930c2afe5f4c73f2aed61cedf95d0)

# javascript - Vim jshint 错误“',' 之前断行错误”

> ID：14342877
> 
> 赞同：3
> 
> 时间：2013-01-15T17:03:50.497
> 
> 标签：javascript, vim, jshint

我使用 jshint.vim 并在下面的代码中出现错误“'，'之前的换行错误”

```
var a = 5
  , b = 10; 
```

我怎样才能解决这个问题？我找到了这个[问题](https://stackoverflow.com/questions/8549394/how-do-i-configure-jshint-to-not-give-me-the-error-bad-line-breaking-before)，但我不确定如何使用它来解决 Vim 中的问题。`laxbreak`有没有我可以设置的配置文件（.vimrc 除外）`laxcomma`？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-15T17:10:44.867

是的。我经常使用前导逗号样式，并在里面设置以下首选项`~/.jshintrc`：

```
{  
//...other prefs
laxcomma  : true,
laxbreak  : true,
//... other prefs
} 
```

如果您还没有 .jshintrc，那么用大括号括起来的这两个设置（*如*JSON）可能会起到作用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-15T17:07:41.417

我不确定 vim 实现的全局配置，你必须查阅该实现的文档，但你可以把

```
/*jshint laxcomma:true */ 
```

在你的源文件的顶部设置这个在每个文件的基础上

### 更新

看起来对于 vim 实现，您可以使用全局变量设置配置文件：

[https://github.com/walm/jshint.vim/pull/3](https://github.com/walm/jshint.vim/pull/3)

然后，您可以创建一个 json 文件并`laxcomma:true`在其中设置。

# mysql - 在 Heroku 中加载 MySQL 转储

> ID：14342879
> 
> 赞同：2
> 
> 时间：2013-01-15T17:04:00.050
> 
> 标签：mysql, heroku

我以前的 MySQL 服务器有一个 sql 转储，如何在 Heroku 中加载这个文件？我是否必须更改为 Postgres？然后将转储文件上传到 S3，如此[处](http://dipinkrishna.com/blog/2012/09/heroku-importrestore-data-database-postgres-dump-file/)所述。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T19:32:08.477

Heroku 有一个[关于如何将 MySQL 数据库迁移到 PostgreSQL 的很好的指南](https://devcenter.heroku.com/articles/heroku-mysql#migrate-to-heroku-postgres)。或者，您可以提供与 MySQL 兼容[的附加组件](https://addons.heroku.com/)之一并使用它。

# mongodb - 我应该为我的 MongoDB 选择什么分片键？

> ID：14342883
> 
> 赞同：0
> 
> 时间：2013-01-15T17:04:05.090
> 
> 标签：mongodb

我目前正在运行一个 MongoDB 服务器（在生产中）。其中最大的集合称为用户。这个集合有一个多键（数组）索引。针对 User 集合的主要查询是针对多键索引字段中的值的 $or 查询。此集合中的另一个字段是一个 PageViews 数组。

随着服务器变得越来越忙，我想对它进行分片以确保我继续获得我目前正在从中获得的性能。当然，问题在于选择分片键。阅读此内容后，由于我的多键索引和缺少可能包含在主要查询中的其他字段，我似乎被查询隔离搞砸了。

各种文章指出，在随机值上创建分片键并不是一个好主意。这是因为您失去了查询隔离。但是，鉴于无论如何我都无法实现良好的查询隔离，我应该只对随机值进行分片吗？

有没有其他人遇到过这种情况？想想有什么好的选择吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T17:32:01.123

我有一个我认为可行的计划，所以我想我会与社区分享。

在我的场景中，多键索引字段包含许多通过前缀消除歧义的项目。前缀表示存储在多键中的值的类型。

然后我的解决方案是找出最常查询的项目类型。在我的场景中，我知道这是什么，我会说它是 90% 以上的时间查询的项目类型。然后，我将在文档中创建另一个字段，用于存储已保存到多键中的此类项目的最后一个值。然后我将使用这个新字段作为分片键。最后，我将应用层更改为首先查询新字段。如果该查询失败，我将对多键字段进行查询。我 90% 以上的查询应该是查询隔离的。其余的必须在所有分片上运行。似乎是一个很好的妥协。

# php - PHP/mySQL游戏积分系统

> ID：14342887
> 
> 赞同：0
> 
> 时间：2013-01-15T17:04:13.233
> 
> 标签：php, mysql

我正在使用 PHP 和 mySQL 开发 Web 应用程序/游戏。我需要在一定的时间间隔内给用户/玩家一定的*分数。*最好的方法是什么？（我的想法是登录时我验证 hist last_login 并添加他在那段时间内获得的*积分数）还有什么其他方法？*（也许是定时触发器......）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T17:11:50.803

我会编写一个 php 脚本，将点添加到数据库中的相应列，并以固定的时间间隔使用 cron 作业调用该脚本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T17:12:07.573

基本上，如果我们谈论的是 PHP/Python/Ruby/等脚本语言，那么您关于它应该如何工作的观点是正确的。但是当你应该有`user points`. `points data`要处理这个问题，您可以在加载时创建一些触发器（我不是指 SQL 触发器 - 它应该根据您的架构设计来完成） 。

# c# - 为什么.net framework 4.5 安装不更新注册表类似于以前的版本？

> ID：14342894
> 
> 赞同：1
> 
> 时间：2013-01-15T17:04:36.517
> 
> 标签：c#, .net, .net-4.5

我试图用框架 4.5 运行 NUnit（我的机器上安装了 VS2010 和 VS2012）。

所以我通过编辑 nunit 的 .exe.config 文件尝试[了旧方法](https://stackoverflow.com/q/930438/1695)

我将框架版本记为 4.5.50709。但是，这在运行时失败了；说指定版本不可用，提示下载安装。

快速互联网检查状态注册表是查看 HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\NET Framework Setup\NDP 的地方

没有 4.5 fwk 文件夹。奇怪 - 所以我修复了框架 4.5 的安装。还是一样。最后我深入研究了我找到的 4.0 密钥

```
InstallPath = %WINDOWS%\Microsoft.Net\Framework64\v4.0.30319
TargetVersion = 4.0.0
Version = 4.5.50709 
```

嗯，看起来 4.5 已经覆盖了 4.0。所以我修改了 .exe.config

```
<supportedRuntime version="v4.0.30319" /> 
```

这行得通。Nunit 现在报告它正在 v4.5 上运行

*   为什么4.5会这样安装？
*   似乎是“重定向”-这是因为 4.5 是就地更新吗？如果是，为什么不指定 4.5.50709 不起作用？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-15T17:12:46.363

就像 .NET 3.0 和 3.5 一样，.NET 4.5 是一个*就地*更新。换句话说，它取代了原来的 4.0 安装。CLR 版本号仍然是 4.0，所有基础程序集也是如此。

所以你必须在 app.exe.config 文件中选择 4.0。您可以通过使用该属性使其更具体并在不存在 4.5 时拒绝运行测试`sku`，但这没什么意义，无论如何测试都应该失败。

# forms - VBA 和 Access 2007 数据验证，登录麻烦

> ID：14342895
> 
> 赞同：0
> 
> 时间：2013-01-15T17:04:39.037
> 
> 标签：forms, vba, login, ms-access-2007

请耐心等待，我是 VBA 的菜鸟，我无意编写代码，但我最终还是这样做了，因为我无法看到没有它我将如何实现我想要的东西。我一直在互联网上搜索 3 天，每天 10 小时，但运气不佳。我有一个要保护的 Access 数据库。让我解释一下我首先要实现的目标：

1）我有一个表单中的组合框，可以在表格中查找值，即项目的项目代码。这基本上是一个库存的事情。我有一个查询，其中有一个计算字段，该字段返回每个项目的剩余库存。我有另一个查询，它将项目代码作为参数并返回该特定项目代码的剩余库存。

我想要做的是检查剩余库存是否为 0，如果是，则在从组合框列表中选择此项目代码时，让 msgbox 显示一条消息，指出该项目没有库存，因此无法发出，并重置组合框（即好像没有进行选择）

这是我的代码；组合框的 afterUpdate 事件：

```
Private Sub Item_Code_AfterUpdate()

Dim dbMyDatabase As DAO.Database

Dim rsMyRecords As DAO.Recordset

Dim strQuery As String

strQuery = "SELECT [Store_Items].[Item Code], Store_Items.[Opening Stock], IIf((Nz([Opening Stock],0)+Nz([Quantity Purchased],0)-Nz([Quantity Issued],0)<0),0,(Nz([Opening Stock],0)+Nz([Quantity Purchased],0)-Nz([Quantity Issued],0))) AS [Remaining Stock] FROM (Purchases RIGHT JOIN Store_Items ON Purchases.[Item Code] = Store_Items.[Item Code]) LEFT JOIN Issuances ON Store_Items.[Item Code] = Issuances.[Item Code] WHERE (((Store_Items.[Item Code])=[Forms]![Issuances]![Item Code]));"

Set dbMyDatabase = CurrentDb

Set rsMyRecords = dbMyDatabase.OpenRecordset(strQuery)

Dim Msg, Style, Title, Response

Msg = "This Item is out of Stock! You Cannot Issue this item!"
Style = vbOK
Title = "Warning!"

If rsMyRecords![Item Code] <= 0 Then
Response = MsgBox(Msg, Style, Title)
If Response = vbOK Then Me![Item Code].Requery

End Sub 
```

2) 我制作了 2 个版本的导航面板。其中一位可以访问所有表格，而另一位则具有有限的访问权限。这由登录类型决定。现在，唯一有效的是第一个，我不明白为什么 ElseIfs 不起作用。当我尝试使用其他类型登录时，单击登录按钮，没有任何反应。

我还想隐藏导航窗格并访问允许数据库设计编辑以及根据登录类型在设计视图中查看表和表单的默认菜单，但我不知道如何实现这一点。

```
Private Sub LoginBUtton_Click()

'Check to see if data is entered into the UserName combo box

    If IsNull(Me.CBOLogin) Or Me.CBOLogin = "" Then
      MsgBox "You must select a user type.", vbOKOnly, "No User name"
        Me.CBOLogin.SetFocus
        Exit Sub
    End If

    'Check to see if data is entered into the password box

    If IsNull(Me.TextPass) Or Me.TextPass = "" Then
      MsgBox "No Password Entered, Enter a password.", vbOKOnly, "No Password"
        Me.TextPass.SetFocus
        Exit Sub
    End If

    'Check value of password in Users to see if this
    'matches value chosen in combo box

    If Me.TextPass.Value = DLookup("Password", "Users", _
            "[UserID]=" & Me.CBOLogin.Value) Then

    ElseIf (Me.CBOLogin.Value = "Developer") Then
    DoCmd.Close acForm, "LoginForm", acSaveNo
    DoCmd.OpenForm "FullAccessNav"

    ElseIf (Me.CBOLogin.Value = "Office") Then
    DoCmd.Close acForm, "LoginForm", acSaveNo
    DoCmd.OpenForm "LimitedAccessNav"

    ElseIf (Me.CBOLogin.Value = "Store") Then
    DoCmd.Close acForm, "loginForm", acSaveNo
    DoCmd.OpenForm "LimitedAccessNav"

    Else
            MsgBox "Password Invalid. Please Try Again", vbOKOnly, _
            "Invalid Entry!"
            Me.TextPass.SetFocus

    End If

    'If User Enters incorrect password 3 times database will shutdown

    intLogonAttempts = intLogonAttempts + 1

    If intLogonAttempts > 3 Then
      MsgBox "You do not have access to this database.Please contact admin.", _
               vbCritical, "Restricted Access!"
        Application.Quit
    End If

End Sub 
```

请帮忙？:S

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T15:11:18.040

好吧，我设法解决了登录问题，但我仍然坚持数据验证位。当我单击组合框中列表中的项目代码时，出现运行时错误 3421。

当我从组合框中选择一个项目代码时，这就是我想要发生的事情。我想从该项目代码的查询中获取计算字段，（这个计算字段具有计算的项目剩余库存）如果它是0，那么我想显示一个消息并阻止用户输入这个记录，所以我想重置组合框可以吗？

如果库存在某个水平，我只想显示一个msgbox，仅此而已，通常让用户输入记录，否则，用户只是正常输入记录。

我在这一行收到运行时错误 3421“数据类型转换错误”：

Set rs = db.OpenRecordset("SELECT [Remaining Stock] FROM [InventoryStatusSpecificItem] WHERE [Item Code] = [Forms]![Issuances]![ItemCBO]", Dynaset)

```
Private Sub ItemCBO_AfterUpdate()

    Dim db As DAO.Database
    Dim rs As DAO.Recordset

    Set db = CurrentDb()

    Set rs = db.OpenRecordset("SELECT [Remaining Stock] FROM [InventoryStatusSpecificItem] WHERE [Item Code] = [Forms]![Issuances]![ItemCBO]", Dynaset)

    If rs.Fields([Remaining Stock]) = "0" Then
    MsgBox "This item is out of stock! Cannot Issue!", vbExclamation + vbOKOnly, "Attention!", vbExclamation
    Me!ItemCBO = Null

    ElseIf rs.Fields("Stock Status") = "Order Now!" Then
    MsgBox "This item has reached its minimum quantity level. Only " + StrRemainingStock + " remains. Quantity Measured as " + StrMeasuredIn, vbExclamation + vbOKOnly, "Attention!"

    Else
    Me!ItemCBO.Requery

    End If

    'close recordset
    rs.Close
    Set db = Nothing 
```

# editor - SublimeText2：如何使用快捷方式连接行

> ID：14342896
> 
> 赞同：1
> 
> 时间：2013-01-15T17:04:44.247
> 
> 标签：editor, sublimetext2

在 SublimeText2 的 Vim 和 Vintage 模式下，我可以使用 Shift+J 将选定的行连接在一起。在没有使用快捷方式的 Vintage 的情况下，这在香草 SublimeText2 中如何工作？

我查看了键绑定，可以看到有一个`join_lines`命令映射：

```
 { "keys": ["ctrl+j"], "command": "join_lines" }, 
```

但是，按下组合键不会执行任何操作，并且菜单项不会显示快捷方式。映射此快捷方式的正确方法是什么，我可能错过了另一个快捷方式吗？

**编辑**

为了澄清我想要做的事情，我试图得到这样的东西：

```
if (condition) {
    return;
} 
```

像这样加入：

```
if (condition) { return; } 
```

（周围有或没有空格`return;`。）

**编辑2**

不确定这是否重要，但这是 Linux 上的 SublimeText2。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T17:06:44.493

当您在线时，在标准模式下，按 ctrl-j (cmd-j os OSX) 将下面的行加入当前行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T17:14:06.787

我将在这里回答我自己的问题，但这只是一种解决方法。不确定这是否是正确的方法。

我已将问题中的绑定复制到用户绑定文件中，并且可以正常工作。

# ruby-on-rails-3 - Ruby on Rails3 ':' vs '=>'

> ID：14342905
> 
> 赞同：1
> 
> 时间：2013-01-15T17:05:19.323
> 
> 标签：ruby-on-rails-3, aptana

在 Ruby On Rails 3 中，正确使用

```
validates :name,  presence: true, length: { maximum: 50 } 
```

反而

```
validates :name,  presence: true, :length => { maximum: 50 } 
```

?

在第一种情况下，即使代码有效，Aptana3 仍然说是错误，我必须更改为第二种方法，它退出表示存在错误。

为什么？

Rails 3.2.10 ruby​​ 1.9.3p362（2012-12-25 修订版 38607）[x86_64-darwin12.2.1]

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T17:08:32.740

您的 IDE 认为正确的可能与实际正确的不同。

例如，IntelliJ 需要设置 Ruby 语言级别才能获得新的哈希语法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T17:10:36.000

我认为它与 Rails 无关，与您的 ruby​​ 版本有关。

您可能需要配置 Aptana 以使用 ruby​​ 1.9。但奇怪的是，您还在第二个版本（`presence: true`）中使用了新语法，所以问题可能出在其他地方......

但关键是，您应该使用第一个版本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T19:31:51.190

一件事：它与 Aptana 无关。但它不应该给出警告/错误。Yoy 可能安装了多个版本的 ruby​​。确保 Aptana 使用 ruby​​ >= 1.9。

列出系统上安装的所有 ruby​​ 版本：

```
ruby -v 

rvm list (if used rvm to install rubies) 
```

在 ruby​​ 1.9 之前，哈希的声明如下：

```
:key => "value" 
```

从 1.9 开始，为了减少打字负荷，这个速记已经可用：

```
key: "value" 
```

但是，在使用 rails 时，我发现了一些违规行为，例如：

```
validates :some_attr, presence: true, :if => { block }  # this works 
```

但这不会：

```
validates :some_attr, presence: true, if: { block }  # this DOES NOT works 
```

lambda、Proc 等也是如此。基本上我们需要指定一个块。

# vba - 将文件夹及其子文件夹移动/复制到 Livelink

> ID：14342908
> 
> 赞同：0
> 
> 时间：2013-01-15T17:05:30.533
> 
> 标签：vba, ms-access, livelink

我已经在使用以下代码将文件复制到 Livelink：

```
Public Function saveFileLL(target As Long, pathSource As String, fileName As String) As Boolean
    Dim dav As New ADODB.Record
    Dim files As New ADODB.Recordset
    Dim objStream As New ADODB.Stream
    Dim url As String

    If Not Val(Nz(target, 0)) > 0 Or Not pathSource Like "*.*" Or Not fileName Like "*.*" Then
        saveFileLL = False
        Exit Function
    End If

    url = URL_LIVELINK_DAV & target

    dav.Open url, , adModeReadWrite
    Set files = dav.GetChildren

    If Not (files.BOF And files.EOF) Then files.MoveFirst

    Do Until files.EOF
        If fileName Like Replace(files("RESOURCE_DISPLAYNAME"), "_", "?") Then Exit Do
        files.MoveNext
    Loop

    If files.EOF Then
        files.addnew "RESOURCE_PARSENAME", fileName
        files.Update
    End If

    files.Close
    dav.Close

    objStream.Open "URL=" & url & "/" & fileName, adModeWrite
    objStream.Type = adTypeBinary
    objStream.LoadFromFile pathSource
    objStream.Flush
    objStream.Close

    Set dav = Nothing
    Set files = Nothing
    Set objStream = Nothing

    saveFileLL = True
End Function 
```

现在，正如标题所说，我想做同样的事情，但使用一个文件夹。我想我的问题与 Livelink 并没有真正的关系，而是更多地与处理文件夹的方式有关。是否可以在不遍历所有子文件夹/文件的情况下移动所有孩子的文件夹？我如何调整我的`saveFileLL()`功能来做到这一点？

**编辑：**

这是另一部分代码，它允许我直接在 objId 设计的 Livelink 文件夹中创建一个文件夹。

```
Public Function CreateFolderToLLFolder(ObjId As String, folderName As String, Optional getId As Boolean = False) As String
    Dim davfile As New ADODB.Record
    Dim davFiles As New ADODB.Recordset
    Dim davDir As New ADODB.Record

    Dim newDirFields(1) As Variant
    Dim newDirValues(1) As Variant

    newDirFields(0) = "RESOURCE_PARSENAME"
    newDirValues(0) = folderName
    newDirFields(1) = "RESOURCE_ISCOLLECTION"
    newDirValues(1) = True

    Set davDir = connection(ObjId, "")
    Set davFiles = davDir.GetChildren()
    If (davFiles.Supports(adAddNew)) Then
        davFiles.addnew newDirFields, newDirValues
    End If

    davfile.Open davFiles, , adModeReadWrite
    CreateFolderToLLFolder = davfile.fields("urn:x-opentext-com:ll:properties:nodeid").value
End Function

Public Function connection(ObjId As String, Optional filename As String = "") As ADODB.Record
    Dim davDir As New ADODB.Record
    davDir.Open filename, "URL=http://livelink-server/livelinkdav/nodes/" & ObjId & "/", adModeReadWrite, adFailIfNotExists, DelayFetchStream, "", ""
    Set connection = davDir
End Function 
```

不要问我为什么这样有效，我发现了它并且确实有效。对于那些想知道的人来说，objId 是 Livelink 为他的所有文件/文件夹提供的唯一 ID。

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T18:39:02.977

您可以通过压缩将一整套文件夹及其组成文件/子文件夹保存为一个块，然后上传 zip 文件。像这样[http://www.rondebruin.nl/windowsxpzip.htm](http://www.rondebruin.nl/windowsxpzip.htm)

如果您想在 LiveLink 中反映结构，那么您必须探索文件夹树来复制内容 - 但是有大量的 vba 代码可以循环遍历文件和文件夹树，如果您必须，它都可以调用您的 saveFileLL 函数走那条路。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T15:33:37.323

执行我想要的最简单的方法最终是使用集成到 Livelink 中的 Web 服务。因为网络上关于整个 Livelink API 的信息真的不多（考虑到我们现在可以在 Google 上找到的所有信息，这令人惊讶），我愿意在这里发布我的解决方案。这实际上很容易。

我所要做的就是在 Firefox 中安装一些附加组件（我使用 Fox，但其他人也会这样做），以便在 Livelink 中执行某些工作时查看 HTTP 标头/数据包。大多数时候，操作是通过 POST 方法完成的。我意识到使用 Fox 插件发送了 3 个 POST，第 2 个首先返回 401 错误，而第 3 个返回正确的 200 响应并完成操作。

然后，我可以推断 Livelink 是一个基于 NTLM 身份验证的 SOAP 服务。看起来它是在 ASP.net 中开发的。

要在 VBA 中使用 Web 服务，再简单不过了。您将需要用于 MSXML2 对象的 Microsoft XML v6.0 livrary，然后就可以了：

```
Dim sMsg As String
Dim sURL As String, postData As String
Dim ObjHTTP As Object

Set ObjHTTP = New MSXML2.XMLHTTP
sURL = "http://server.com/livelink/livelink.exe"
postData = "your-post-data"

ObjHTTP.Open "Post", sURL, False
ObjHTTP.setRequestHeader "Content-Type", "application/x-www-form-urlencoded"
ObjHTTP.send (postData)

Set ObjHTTP = Nothing 
```

就这么简单，只需使用某种浏览器的插件找到正确的 POST 数据即可。大多数后期数据未编码且易于处理。

# algorithm - 总数

> ID：14342910
> 
> 赞同：-2
> 
> 时间：2013-01-15T17:05:33.327
> 
> 标签：algorithm

我正在尝试解决这个问题，但无法想出任何东西......

如果该数字具有以下属性，我们将其命名为“聚合数字”：就像斐波那契数字 1,1,2,3,5,8,13 ......

数字中的数字可以分为几个部分，后面的部分是前面部分的总和。

```
like 112358, because 1+1=2, 1+2=3, 2+3=5, 3+5=8
122436, because 12+24=36
1299111210, because 12+99=111, 99+111=210
112112224, because 112+112=224 
```

对不起，我们需要编写函数来测试一个数字是否被聚合或不完整的问题？任何想法请帮忙

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T17:35:10.117

如果您遇到困难，请尝试将问题分解为更简单的可解决块。例如让你开始：

```
/**
 * Returns true if the provided number is an aggregated number
 *
 * @param potentialAggregatedNumber The number to check.
 */
boolean isAggregated (potentialAggregatedNumber){
    for(numDigits=1; numDigits <= (potentialAggregatedNumber.length/2); numDigits++){
        if(isAggregatedForFirstNumberLength(potentialAggregatedNumber, numDigits) {
            return true;
        }
    }
    return false;
}

/**
  * Returns true if aggregated number when the first number has numDigits digits.
  *
  * @param potentialAggregatedNumber The number to check.
  * @param numDigits The number of digits the first sub-number should have.
  */
boolean isAggregatedForFirstNumberLength(potentialAggregatedNumber, numDigits){
    //your code 
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T17:17:59.637

当您拥有前两个数字的位数时，您就拥有了检查汇总数字所需的一切。您只需为前两个数字生成所有有效的数字组合。数字之和不应大于所有数字的一半，因为否则第三个数字，即前两个数字之和，将不适合总数的其余部分。生成所有数字组合的最佳方法是这个嵌套循环：

```
for (int both_digits = 2; both_digits * 2 <= total_digits; both_digits++)
{
  for (int first_digit = 1; first_digit < both_digits; first_digit++)
  {
    int second_digit = both_digits - first_digit;

    if (CheckAggregateNumber(aggregate_number, first_digit, second_digit))
      return true;
  }
} 
```

实现`CheckAggregateNumber`函数最简单的方法是通过字符串比较。首先将聚合数字转换为字符串。然后在循环中使用第一个和第二个数字生成应该是聚合数的子字符串的字符串，并将这些子字符串与聚合数的适当部分进行比较。如果一切都检查到结束返回 true，否则返回 false。这是一些伪代码：

```
aggregate_string = aggregate_number as string;
first_number = aggregate_string.Substring(0, first_digit) as int;
second_number = aggregate_string.Substring(first_digit, second_digit) as int;
index_on_aggregate = first_digit + second_digit;

begin loop
  new_number = first_number + second_number;
  new_string = new_number as string;

  if (new_string == aggregate_string.Substring(index_on_aggregate, new_string.Length)
    return false;

  first_number = second_number;
  second_number = new_number;
  index_on_aggregate = index_on_aggregate + new_string.Length;

  if (index_on_aggregate == aggregate_string.Length)
    return true;
end loop 
```

# javascript - 在 IE9 中使用 history.pushstate

> ID：14342912
> 
> 赞同：1
> 
> 时间：2013-01-15T17:05:42.450
> 
> 标签：javascript, jquery, html, internet-explorer-9, pushstate

由于 window.history.pushState 不适用于 IE9 等 HTML 4 浏览器，因此我寻找了 history.js，这是一个模拟 pushState 行为的 jQuery 库。

问题是，当使用 pushState 时，url 的结尾是重复的

例如，

```
History.pushState(null,null,window.location.pathname + '?page=1'); 
```

返回，

[http://www.development.com/test.html#test.html?page=1](http://www.development.com/test.html#test.html?page=1)

我该如何避免这个问题？非常感谢你。

**更新（2012 年 1 月 22 日），悬赏问题：**

```
 if (pageNo == 1){
                    //window.history.pushState({"html":currURL,"pageTitle":''},"", window.location.pathname + '?page=1'); For chrome and FX only
                    //History.replaceState(null,null,'')
                    //History.pushState(null,null,'?issue=' + currPageIssueNo + '&page=1');
                }   
                else if (pageNo != 1 || pageNo == 1 && linkPageNo > 1  ) {
                    History.pushState(null,null,'?issue=' + currPageIssueNo + '&page=' + pageNo);
                    //window.history.pushState({"html":currURL,"pageTitle":''},"", newURL);   For chrome and FX only
                } 
```

我还是遇到这个问题，如果是第一页

```
http://localhost/development/flipV5.html?issue=20121220&page=1 
```

当我转到 IE9 的第二页时，它有 url：

```
http://localhost/development/flipV5.html?issue=20121220&page=1#flipV5.html?issue=20121220&page=2 
```

我想实现的是

```
http://localhost/development/flipV5.html?issue=20121220&page=2 
```

如果 HTML 4 浏览器不可能，请至少实现

```
http://localhost/development/flipV5.html/#?issue=20121220&page=2 
```

感谢您的帮助

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T17:10:00.717

您的代码完全符合您的预期。

```
window.location.pathname + '?page=1' 
```

打印出位置路径名 ( `test.html`)，并附加`?page=1`

删除`window.location.pathname`它应该可以工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-28T07:21:46.690

您需要为 IE 设置客户端重定向。假设用户登陆此页面：

```
http://localhost/development/flipV5.html?issue=20121220&page=1 
```

他们需要被送到

```
http://localhost/development/flipV5.html#?issue=20121220&page=1 
```

原因是 IE <= 9 不允许您在散列之前修改任何内容，而不会将用户发送到新页面。这是一项旧的安全功能，可防止`facebook.com`在您真正使用`spambook.com`. 最近，人们意识到这太过分了。

重定向如下所示：

```
<!--[if LTE IE 9]>
<script type="text/javascript">
if (location.search) 
    location.href = location.pathname + "#" + location.search;
</script>
<![endif]--> 
```

您现在可以推送状态，它们不会同时出现在搜索和哈希中（分别在`?`and之后`#`）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-15T17:09:24.647

只需从中删除 window.location.pathname`History.pushState`

```
History.pushState(null,null,'?page=1'); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-24T08:06:25.713

也许尝试：

```
History.replaceState(null,null,'?issue=' + currPageIssueNo + '&page=' + pageNo); 
```

# networking - tcp 客户端与不同网络中的服务器通信（NAT 问题）

> ID：14342915
> 
> 赞同：2
> 
> 时间：2013-01-15T17:05:50.503
> 
> 标签：networking, tcpclient, router, nat, tcpserver

我有一个 TCP 客户端程序，它需要与设备中嵌入的服务器进行通信。可能有 1000 台设备需要通过单个客户端程序进行控制。由于这些设备（即tcp服务器）的数量很大，所以它们必须在不同的路由器后面

所以场景就像

客户端-----“路由器1”----服务器1，服务器2，服务器3...server_255

```
 ----- "router2" ---server1, server 2...server_255 
```

![在此处输入图像描述](../Images/41a63db2e97bfbfb7e02ce5f8a0d2412.png)

由于客户端和服务器程序位于不同的网络中，那么在客户端和服务器之间建立通信最简单的方法是什么？

虽然看起来很简单的客户端-服务器编程，但问题在于 NAT ，这里的网络转换。服务器位于不同的专用网络后面，所以我期待在这里解决 NAT 问题。（例如端口转发，但不确定）

注意：我的客户端和设备仍在我的网络中，因此安全性不是主要问题。

提前谢谢了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T17:57:55.817

最直接的设计是有一个专用的守护进程，通常称为*控制器*，监听一个众所周知的端口，所有设备都充当客户端，连接到它。控制器将观察设备上下移动，跟踪它们的位置和状态。

您现在称为“客户端”的东西将成为用户界面的一部分。它将查询控制器并显示结果，并向控制器发出命令，然后控制器将它们中继到设备。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-15T17:12:04.360

让您的所有“服务器”（即设备）保持与您的“客户端”（即中央服务器）的连接。正如您所描述的那样，采用另一种方式将无法与路由器一起使用。

如果不需要全时连接，那么您可能需要建立连接计划或使用广播/多播消息告诉客户端进行连接。请注意，广播/多播将需要更改路由器配置以确保消息发出。

我在这里假设路由器是指其中包含 NAT 的东西。NAT 是这里的问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-24T01:01:27.493

您的插图显示了每个基于 NAT 的路由器后面的多个端点。如果您使用端口转发方法，则需要为各种路由器中的每个端点注册不同的端口号。跟踪和配置会很痛苦，但会允许您的中央管理服务器即时访问您的每个端点。

如果您控制端点上的软件，您可以让它们轮询中央服务器以获取指令。路由器中不需要配置，因为请求来自私有端。假设来自服务器的典型消息类似于“OK”，那么流量将是微不足道的。不利的一面是中央服务器的指令传递不会是即时的。客户端直到下一个轮询间隔才知道消息可用。

介于这两个极端之间但要付出额外成本的是分布式管理方法。如果您在每个 NAT 路由器后面已经有一个服务器，您可以让它将指令中继到每个端点。您的中央管理服务器可以控制少数本地管理服务器，每个管理服务器位于每个 NAT 防火墙后面，并且这些服务器中的每一个都可以直接访问其同一 LAN 中的端点。

# html - 如何使 kinetic.js 图像尊重 html 5 画布剪辑限制

> ID：14342916
> 
> 赞同：1
> 
> 时间：2013-01-15T17:06:01.367
> 
> 标签：html, draggable, kineticjs

所以，我试图让下面的图像尊重我设置的 HTML5 画布剪辑边界，但它只尊重 DIV 边界，另一方面，圆圈尊重完整边界

那么如何将 html5 剪辑与 kinetic.js 创建的图像一起使用

演示链接：[http ://shedlimited.debrucellc.com/test3/canvaskinclip.html](http://shedlimited.debrucellc.com/test3/canvaskinclip.html)

--> 主要问题：蓝色球尊重 HTML5 剪辑边框，但可拖动的 Darthvader 图像没有（我想让可拖动的 darthvader 尊重它）

```
<script src="http://www.html5canvastutorials.com/libraries/kinetic-v3.8.3.js">
</script>
 <body>
<div id="container"></div>
<script>
    window.onload = function(){
        var stage = new Kinetic.Stage("container", 425, 405);
        var layer = new Kinetic.Layer();
           var background_layer = new Kinetic.Layer();
        var draggingShape = undefined;
        var imageObj = new Image();
        imageObj.src = 'http://www.html5canvastutorials.com/demos/assets/darth-vader.jpg';

        var darthVaderImg = new Kinetic.Image({
      image: imageObj,

      width: 200,
      height: 137,
      draggable: true

    });
        // circle
        var circle = new Kinetic.Shape({

            drawFunc: function(){
                var context = this.getContext();

                // draw clipping rectangle
               context.beginPath();
  context.moveTo(5, 5);
  context.lineTo(34, 202);

  context.lineTo(2, 405);
  context.lineTo(212, 385);
  context.lineTo(425, 405);
  context.lineTo(400, 202);
  context.lineTo(415, 10);
  context.lineTo(212, 25);
                context.clip();

                // draw circle

                imageObj.src = 'http://www.html5canvastutorials.com/demos/assets/darth-vader.jpg';
                 context.drawImage(imageObj,0,0);
                context.beginPath();
                context.arc(this._x, this._y, 50, 0, 2 * Math.PI, false);
                context.fillStyle = "blue";
                context.fill();
                context.closePath();
            },
            // custom properties
            _x: 300,
            _y: 50
        });

        circle.on("mousedown", function(){
            draggingShape = this;
            var mousePos = stage.getMousePosition();
            draggingRectOffsetX = mousePos.x - circle._x;
            draggingRectOffsetY = mousePos.y - circle._y;
        });
        circle.on("mouseover", function(){
            document.body.style.cursor = "pointer";
        });
        circle.on("mouseout", function(){
            document.body.style.cursor = "default";
        });

        layer.add(circle);

        stage.on("mouseout", function(){
            draggingShape = undefined;
        }, false);

        stage.on("mousemove", function(){
            var mousePos = stage.getMousePosition();
            if (draggingShape) {
                draggingShape._x = mousePos.x - draggingRectOffsetX;
                draggingShape._y = mousePos.y - draggingRectOffsetY;

                layer.draw();
            }
        }, false);

        stage.on("mouseup", function(){
            draggingShape = undefined;
        });

           var Bg = new Image();
    Bg.onload = function() {
            var Bg_image = new Kinetic.Image({
            image: Bg
        });
        background_layer.add(Bg_image);
        stage.add(background_layer);
    layer.add(darthVaderImg);

        stage.add(layer);
    };
    Bg.src = "centerpillow1.png";
    }

</script> 
```

# reflection - RegisterAssemblyModule 创建注册 - 仍然出现 ComponentNotRegisteredException

> ID：14342917
> 
> 赞同：1
> 
> 时间：2013-01-15T17:06:01.847
> 
> 标签：reflection, dependency-injection, inversion-of-control, autofac

我有以下非常简单的带有界面的 ViewModel：

```
public interface ITestViewModel
{
    string Tester { get; }
}

public class TestViewModel : ITestViewModel
{
    public string Tester
    {
        get { return "testing DI"; }
    }
} 
```

然后我创建了这个 Autofac 模块：

```
public class TestModule : Module
{
    protected override void Load(ContainerBuilder builder)
    {
        builder.Register(c => new TestViewModel()).As<ITestViewModel>();
    }
} 
```

ViewModel 和此模块位于一个名为 TestPlugin 的单独 DLL 中。

在我的主应用程序中，我尝试动态加载 TestPlugin 程序集，以便可以将其模块注册到容器中，如下面的代码所示：

```
var builder = new ContainerBuilder();
var plugins = Directory.EnumerateFiles(@"C:\plugins", "TestPlugin.dll", SearchOption.AllDirectories).ToList();
foreach (var plugin in plugins)
{
    var assembly = Assembly.LoadFrom(plugin);
    builder.RegisterAssemblyModules(assembly);
}
var container = builder.Build();
var testResolve = container.Resolve<ITestViewModel>(); 
```

出于某种原因，虽然我可以清楚地看到服务 ITestViewModel（TestViewModel 的 DelegateActivator）的组件注册，但在 Resolve 调用中仍然收到以下异常：

```
Autofac.Core.Registration.ComponentNotRegisteredException was unhandled by user code
HResult=-2146233088
Message=The requested service 'TestPlugin.ITestViewModel' has not been registered. To avoid this exception, either register a component to provide the service, check for service registration using IsRegistered(), or use the ResolveOptional() method to resolve an optional dependency.
Source=Autofac
StackTrace:
   at Autofac.ResolutionExtensions.ResolveService(IComponentContext context, Service service, IEnumerable`1 parameters)
   at Autofac.ResolutionExtensions.Resolve(IComponentContext context, Type serviceType, IEnumerable`1 parameters)
   at Autofac.ResolutionExtensions.Resolve[TService](IComponentContext context, IEnumerable`1 parameters)
   at Autofac.ResolutionExtensions.Resolve[TService](IComponentContext context)
   at Test.App.<>c__DisplayClass5.<OnStartup>b__0()
   at System.Threading.Tasks.Task.InnerInvoke()
   at System.Threading.Tasks.Task.Execute()
InnerException: 
```

对于为什么会发生这种情况，我们将不胜感激。我的猜测是它与 Assembly.LoadFrom 调用有关，好像我尝试将视图模型/模块拉入主应用程序然后注册似乎正常工作。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T20:24:22.297

您必须将程序集加载到当前 App 域中。看看[AppDomain.Load](http://msdn.microsoft.com/en-us/library/36az8x58.aspx)。

# html - 谷歌地图中的kmz具有动态纬度吗？

> ID：14342928
> 
> 赞同：2
> 
> 时间：2013-01-15T17:06:38.550
> 
> 标签：html, google-maps, kml, kmz

我在我的谷歌帐户下使用谷歌地图来加载一个很好且工作的 kmz 文件，但我想通过操作标题 url 来加载一个新的 pin 标记。到目前为止，我已经尝试 q=lat,long 加载标记，但它不维护 kmz 多边形和信息。它只是加载一个绿色箭头（我的坐标），但在纯灰色谷歌地图上这样做。

有谁知道如何加载标记但仍将 kmz 数据保留在页面上？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T17:53:32.170

如果不使用 API / JavaScript，我不相信这是可能的。通读可用的查询字符串参数，没有一个允许您指定一个独立于 q= 查询字符串变量的 kml/kmz 输入文件。看起来静态地图（[谷歌地图中多个标记的 URL](https://stackoverflow.com/questions/1771879/url-for-multiple-markers-in-google-maps)）功能可能包括多个标记的功能，但如果这可以满足您的目的。您需要将 KML 作为查询字符串的一部分传递，例如：

`?q=http://code.google.com/apis/kml/documentation/KML_Samples.kml&markers=-134,68,0`

祝你好运！

# ruby-on-rails - 如何在 ruby on rails 中拆分数组并存储到数据库中？

> ID：14342934
> 
> 赞同：0
> 
> 时间：2013-01-15T17:06:51.437
> 
> 标签：ruby-on-rails, ruby

如何拆分此数组并存储到数据库中？

我的模型中有三个字段，称为`Question_id, Answer_id and Phase_id`.

我的结果如下：

```
question_hash_string = "{\"5\":[\"5\",\"0\",\"\"],\"25\":[\"25\",\"1\",\"3\"]}"} 
```

看起来像`{5:[5,0,1], 25:[25,1,3] ... }`。

我想拆分数组并将结果按顺序存储到三个字段中`Question`，`Answer`并且`Phase`每个集合。

在我的`Batch`表中，我有三列`question_id`：`answer_id`和`phase_id`。

,的第一个值是 to `array[5,0,1]`, to和to 。在第二行to 、to和to 。`5``question_id``0``answer_id``1``phase_id``25``question_id``1``answer_id``3``phase_id`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T17:28:16.840

你可以这样做：

```
hash_values = JSON.parse(question_hash_string)
hash_values.each do |k,v|
  b = Batch.new
  b.question_id, b.answer_id, b.phase_id = v.collect(&:to_i)
  b.save!
end 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-15T17:11:46.403

您应该能够使用 JSON 解析它：

```
json_loaded = JSON.load(question_hash_string) 
```

从那里您可以以任何您可能希望的格式发出，但需要将您的值转换为整数：

```
remapped = Hash[
  json_loaded.collect do |k, a|
    [ k.to_i, a.collect(&:to_i) ]
  end
]
# => {5=>[5, 0, 0], 25=>[25, 1, 3]}

JSON.dump(remapped)
# => {"5":[5,0,0],"25":[25,1,3]} 
```

由于 JSON 需要字符串键，因此这非常接近您想要的。为了让它完全一样，你必须编写一个自定义发射器。

# matlab - 两个向量之间的相关性？

> ID：14342938
> 
> 赞同：22
> 
> 时间：2013-01-15T17:07:02.873
> 
> 标签：matlab, statistics

我有两个向量：

```
A_1 = 

      10
      200
      7
      150

A_2 = 
      0.001
      0.450
      0.0007
      0.200 
```

我想知道这两个向量之间是否存在相关性。

我可以从每个值中减去向量的平均值，然后：

```
 A_1' * A_2 
```

有没有更好的方法？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2013-01-15T17:41:26.137

鉴于：

```
A_1 = [10 200 7 150]';
A_2 = [0.001 0.450 0.007 0.200]'; 
```

（正如其他人已经指出的那样）有一些工具可以简单地计算相关性，最明显的是`corr`：

```
corr(A_1, A_2);  %Returns 0.956766573975184  (Requires stats toolbox) 
```

您还可以使用基本 Matlab 的`corrcoef`函数，如下所示：

```
M = corrcoef([A_1 A_2]):  %Returns [1 0.956766573975185; 0.956766573975185 1];
M(2,1);  %Returns 0.956766573975184 
```

这与功能密切相关`cov`：

```
cov([condition(A_1) condition(A_2)]); 
```

* * *

正如您几乎在原始问题中遇到的那样，您可以根据需要自行缩放和调整向量，这样可以更好地理解正在发生的事情。首先创建一个减去平均值并除以标准差的条件函数：

```
condition = @(x) (x-mean(x))./std(x);  %Function to subtract mean AND normalize standard deviation 
```

那么相关性似乎是 (A_1 * A_2)/(A_1^2)，如下所示：

```
(condition(A_1)' * condition(A_2)) / sum(condition(A_1).^2);  %Returns 0.956766573975185 
```

通过对称，这也应该有效

```
(condition(A_1)' * condition(A_2)) / sum(condition(A_2).^2); %Returns 0.956766573975185 
```

它确实如此。

我相信，但现在没有精力确认，在处理多维输入时，可以使用相同的数学计算相关和互相关项，只要在处理维度和方向时要小心输入数组。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-01-15T17:13:44.887

试试看`xcorr`，它是 MATLAB 中用于互相关的内置函数：

```
c = xcorr(A_1, A_2); 
```

但是，请注意，它需要安装[信号处理工具箱](http://www.mathworks.com/products/signal/)。如果没有，您可以查看[`corrcoef`](http://www.mathworks.com/help/matlab/ref/corrcoef.html)命令。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-01-15T17:20:08.043

对于相关性，您可以只使用 corr 函数（统计工具箱）

```
corr(A_1(:), A_2(:)) 
```

请注意，您也可以只使用

```
corr(A_1, A_2) 
```

但是线性索引保证您的向量不需要转置。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2013-01-15T17:44:22.563

要在两个向量之间执行线性回归`x`并执行`y`以下步骤：

```
[p,err] = polyfit(x,y,1);   % First order polynomial
y_fit = polyval(p,x,err);   % Values on a line
y_dif = y - y_fit;          % y value difference (residuals)
SSdif = sum(y_dif.^2);      % Sum square of difference
SStot = (length(y)-1)*var(y);   % Sum square of y taken from variance
rsq = 1-SSdif/SStot;        % Correlation 'r' value. If 1.0 the correlelation is perfect 
```

因为`x=[10;200;7;150]`和`y=[0.001;0.45;0.0007;0.2]`我得到`rsq = 0.9181`。

参考网址： http: [//www.mathworks.com/help/matlab/data_analysis/linear-regression.html](http://www.mathworks.com/help/matlab/data_analysis/linear-regression.html)

# excel - VBA excel，当有重复时连接单元格

> ID：14342939
> 
> 赞同：0
> 
> 时间：2013-01-15T17:07:07.720
> 
> 标签：excel, vba

我这里有一个像这样的矩阵

```
 id  value  
     1   A 
     2   B
     3   C
     1   D 
     3   E
     1   F 
```

我需要做的是总结我的价值，有一些类似的东西

```
 id  value  
     1   A, D, F 
     2   B
     3   C, E 
```

删除重复的它会很好，但不是强制性的。我在第三列中尝试了这个公式，但是......

```
 =IF(COUNTIF(A:A,A1)>1,CONCATENATE(B1,",",VLOOKUP(A1,A1:B999,2)),B1) 
```

VLOOKUP 只给我一个值，这意味着我不能处理超过 1 个重复项。

我确实尝试过使用 VBA，但这对我来说是第一次，而且它变得越来越复杂，而且我找不到关于 excel VBA 的像样的文档。每一个建议都值得赞赏。谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T17:23:42.197

带有以下 VBA 函数的[此链接可能会对您有所帮助：](http://www.sulprobil.com/html/lookup-variants.html#Vlookupall)

```
Function vlookupall(sSearch As String, rRange As Range, _
    Optional lLookupCol As Long = 2, Optional sDel As String = ",") As String
'Vlookupall searches in first column of rRange for sSearch and returns
'corresponding values of column lLookupCol if sSearch was found. All these
'lookup values are being concatenated, delimited by sDel and returned in
'one string. If lLookupCol is negative then rRange must not have more than
'one column.
'Reverse("moc.LiborPlus.www") PB 16-Sep-2010 V0.20
Dim i As Long, sTemp As String
If lLookupCol > rRange.Columns.Count Or sSearch = "" Or _
    (lLookupCol < 0 And rRange.Columns.Count > 1) Then
    vlookupall = CVErr(xlErrValue)
    Exit Function
End If
vlookupall = ""
For i = 1 To rRange.Rows.Count
    If rRange(i, 1).Text = sSearch Then
        If lLookupCol >= 0 Then
            vlookupall = vlookupall & sTemp & rRange(i,lLookupCol).Text
        Else
            vlookupall = vlookupall & sTemp & rRange(i).Offset(0,lLookupCol).Text
        End If
        sTemp = sDel
    End If
Next i
End Function 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T17:29:06.673

~~数据透视表怎么样：D，然后将数据复制到您想要的任何位置：D~~

如果您想尝试一下，这是另一种方法:) 特别是如果您不想对每一行使用函数但单击按钮以输出您想要的数据（对于大型数据集）。

示例代码：（您可以根据自己的设置工作表、范围）

```
Option Explicit

Sub groupConcat()
Dim dc As Object
Dim inputArray As Variant
Dim i As Integer

    Set dc = CreateObject("Scripting.Dictionary")
    inputArray = WorksheetFunction.Transpose(Sheets(4).Range("Q3:R8").Value)

       '-- assuming you only have two columns - otherwise you need two loops
       For i = LBound(inputArray, 2) To UBound(inputArray, 2)
            If Not dc.Exists(inputArray(1, i)) Then
                dc.Add inputArray(1, i), inputArray(2, i)
            Else
                dc.Item(inputArray(1, i)) = dc.Item(inputArray(1, i)) _ 
                & "," & inputArray(2, i)
            End If
       Next i

    '--output into sheet
    Sheets(4).Range("S3").Resize(UBound(dc.keys) + 1) = _ 
              Application.Transpose(dc.keys)
    Sheets(4).Range("T3").Resize(UBound(dc.items) + 1) = _ 
              Application.Transpose(dc.items)

    Set dc = Nothing
End Sub 
```

输出：

![在此处输入图像描述](../Images/b29e2c5c640d565bc3c6855b78e842a0.png)

# google-analytics - Google Analytics 如何跟踪对非 html 页面的访问？

> ID：14342943
> 
> 赞同：0
> 
> 时间：2013-01-15T17:07:16.097
> 
> 标签：google-analytics

例如，在 Google Analytics 中，我看到它跟踪对我网站上 .swf 和 .jpg 文件的访问。但我认为 GA 仅适用于其中嵌入了 javascript 代码的页面——这对于 Flash 或图像文件是不可能的。有什么想法吗？真是好奇。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T18:03:06.227

有人刚刚向我指出，在 GA 上显示的图像和 swf 文件链接到我网站上的 html 页面。因此，GA 似乎足够聪明，可以使用链接文件的 html 页面中的 GA 代码来初始化跟踪。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T11:32:39.563

GA 无法在没有跟踪代码的情况下跟踪文件（如果这样做也不会是“智能”，因为这会使页面印象等指标变得无用 - 毕竟单个页面包含大量文件，如图像、swfs、css 等） .

当您在报告中找到 jpg-extensions 等时，通常会出现 404 错误页面，该页面带有所请求（但缺少）文件的扩展名。

# .net - LINQ 查询帮助：使用实体框架在多对多中搜索数据

> ID：14342952
> 
> 赞同：2
> 
> 时间：2013-01-15T17:07:51.610
> 
> 标签：.net, asp.net-mvc-3, linq, entity-framework, lambda

我已经四处寻找并看到了一堆类似的问题，但我仍然无法弄清楚这一点。我有两个类资产和标签。以下是它们的定义：

```
public class Asset
{
    [Key]
    public int AssetID { get; set; }

    public decimal? Height { get; set; }
    public decimal? Width { get; set; }
    public decimal? Depth { get; set; }
    public decimal? Radius { get; set; }
    public string Name { get; set; }

    [Display(Name = "Manufacturer")]
    public int ManufacturerID { get; set; }

    [Display(Name = "Type")]
    public int PackageTypeID { get; set; }

    public virtual Manufacturer Manufacturer { get; set; }
    public virtual PackageType PackageType { get; set; }
    public virtual ICollection<Tag> Tags { get; set; }

}

public class Tag
{
    public int TagID { get; set; }
    public string Key { get; set; }
    public string Value { get; set; }
    public virtual ICollection<Asset> Assets { get; set; }

} 
```

我的资产索引页面上有一个搜索框，我希望能够搜索 Asset.Name、Manufacturer.Name、Asset.Tag.Key 和 Asset.Tag.Value。这是我到目前为止所得到的。

```
var assets = from a in db.Assets                        
                     select a;
if (!String.IsNullOrEmpty(searchString))
        {
assets = assets.Where(a => a.Name.ToUpper().Contains(searchString.ToUpper())
          || a.Manufacturer.Name.ToUpper().Contains(searchString.ToUpper()));
} 
```

现在，我不知道如何访问/搜索 Tag.Key 或 Tag.Value。我已经尝试过使用 LINQ 查询进行各种连接，但我还不够聪明。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T17:25:45.750

您可以使用 Any 来检查标签并按 searchString 过滤

```
var result = db.Assets.Where(a => a.Name.ToUpper().Contains(searchString.ToUpper()) ||
                                  a.Manufacturer.Name.ToUpper().Contains(searchString.ToUpper()) ||                       
                                  a.Tags.Any(t => t.Key.ToUpper().Contains(searchString.ToUpper()) || t.Value.ToUpper().Contains(searchString.ToUpper())); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T17:21:33.833

首先，如果要进行“不区分大小写”的搜索，请更改数据库表列的[排序规则。](http://msdn.microsoft.com/en-us/library/ms180175.aspx)

然后，您的 LINQ 代码：

```
var assets = db.Assets.Where(a => a.Name.Contains(searchString)
      || a.Manufacturer.Name.Contains(searchString)
      || a.Tags.Any(t => t.Key == searchString || t.Value == searchString)); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T17:20:01.600

尝试使用`.Any()`扩展方法来查找资产是否包含带有已定义搜索词的标签

```
var result = db.Assets.Where(a => a.Name.ToUpper().Contains(searchString.ToUpper())
                               || a.Manufacturer.Name.ToUpper().Contains(searchString.ToUpper()
                               || a.Tags.Any(t => t.Key == searchString)
                               || a.Tags.Any(t => t.Value == searchString) 
```

# cakephp - 为什么 CakePHP 仍然使用制表符进行缩进？

> ID：14342953
> 
> 赞同：5
> 
> 时间：2013-01-15T17:07:51.923
> 
> 标签：cakephp

[http://book.cakephp.org/2.0/en/contributing/cakephp-coding-conventions.html](http://book.cakephp.org/2.0/en/contributing/cakephp-coding-conventions.html)

我认为这是旧的，但`v3`分支仍然使用选项卡。有谁知道为什么新版本不支持 PSR-2 之类的东西？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-15T20:08:30.793

## PSR-2 不是标准

[PSR-2](https://github.com/php-fig/fig-standards/blob/master/accepted/PSR-2-coding-style-guide.md)是一种风格*指南*，它不是标准——即使是，它也是自愿的。

## 为什么不关注 PSR-2

抛开任何 tab-v-spaces 之争，为 CakePHP 更改空白项目范围具有以下优点：

*   匹配 PSR-2

它带来了以下缺点：

*   零性能或功能优势
*   合并分支不便
*   合并冲突和一般痛苦构建版本

最后两点很重要——CakePHP 已经经历了各种与格式化相关的自动更改，每次它都会导致在构建发布或尝试将修复从一个版本反向移植到另一个版本时花费/丢失处理合并冲突的时间。

这些是遵循 PSR-2 的特定规则不太可能很快发生的一些原因。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T20:06:35.180

也许杰夫阿特伍德的这篇文章会有所帮助： http: [//www.codinghorror.com/blog/2009/04/death-to-the-space-infidels.html](http://www.codinghorror.com/blog/2009/04/death-to-the-space-infidels.html)

# c# - ADO.NET：为所有 VarChar 参数的 SqlParameter.Size 指定 -1 是否安全？

> ID：14342954
> 
> 赞同：20
> 
> 时间：2013-01-15T17:07:53.010
> 
> 标签：c#, sql-server, ado.net

我们有一个现有的 C# 代码主体，它在许多地方调用参数化的即席 SQL Server 查询。我们从不指定 SqlParameter.Size，据记载，在这种情况下，SqlParameter 类从参数值推断大小。我们最近才意识到这会产生 SQL Server 计划缓存污染问题，其中为每个不同的参数大小组合缓存一个单独的计划。

幸运的是，每当我们创建一个 SqlParameter 时，我们都是通过一个实用程序方法来完成的，因此我们有机会在该方法中添加几行代码并解决这个问题。我们正在考虑添加以下内容：

```
if((sqlDbType == SqlDbType.VarChar) || (sqlDbType == SqlDbType.NVarChar))
    m_sqlParam.Size = -1; 
```

换句话说，每次我们传递一个 varchar 参数时，都将其作为 varchar(max) 传递。基于一些快速测试，这工作正常，我们可以看到（通过 SQL Profiler 和 sys.dm_exec_cached_plans）现在每个临时查询的缓存中都有一个计划，以及字符串参数的类型现在是 varchar(max)。

这似乎是一个如此简单的解决方案，一定有一些隐藏的、破坏性能的缺点。有人知道吗？

（请注意，我们只需要支持 SQL Server 2008 及更高版本。）

## 更新（1 月 16 日）

**是的，有一个隐藏的、破坏性能的缺点！**

非常感谢 Martin Smith，他的回答（见下文）为我指出了分析这个问题的正确方法。我使用我们应用程序的用户表进行了测试，该表有一个定义为 nvarchar(100) 的电子邮件列，并且在电子邮件列上有一个非聚集索引 (IX_Users_Email)。我将 Martin 的示例查询修改如下：

```
declare @a nvarchar(max) = cast('a' as nvarchar(max))
--declare @a nvarchar(100) = cast('a' as nvarchar(100))
--declare @a nvarchar(4000) = cast('a' as nvarchar(4000))

select Email from Users where Email = @a 
```

根据我取消注释的“声明”语句，我得到一个非常不同的查询计划。nvarchar(100) 和 nvarchar(4000) 版本都给了我在 IX_Users_Email 上的索引**搜索**——事实上，我指定的任何长度都给了我相同的计划。另一方面，nvarchar(max) 版本让我对 IX_Users_Email进行索引**扫描，然后使用 Filter 运算符应用谓词。**

这对我来说已经足够了——如果有任何可能进行扫描而不是寻找，那么这种“治疗”比疾病更糟糕。

**新提案**

我注意到，每次 SQL Server 使用 varchar 参数对查询进行参数化时，缓存计划只是使用 varchar(8000)（或 nvarchar(4000)）作为参数。我想如果它对 SQL Server 来说足够好，那对我来说就足够了！将我原来的问题（上面）中的 C# 代码替换为：

```
if(sqlDbType == SqlDbType.VarChar)
    m_sqlParam.Size = 8000;
else if(sqlDbType == SqlDbType.NVarChar)
    m_sqlParam.Size = 4000; 
```

这似乎解决了计划缓存污染问题，而对查询计划的影响与使用 -1 的大小相同。但是，我还没有对此进行大量测试，我很想听听任何人对这种修改后的方法的意见。

## 更新（9 月 24 日）

我们不得不修改之前的版本（上面的新提案）来处理参数值大于最大值的情况。此时，您别无选择，只能将其设为 varchar(max)：

```
if((sqlDbType == SqlDbType.VarChar) || (sqlDbType == SqlDbType.NVarChar))
{
    m_sqlParam.Size = (sqlDbType == SqlDbType.VarChar) ? 8000 : 4000;

    if((value != null) && !(value is DBNull) && (value.ToString().Length > m_sqlParam.Size))
        m_sqlParam.Size = -1;
} 
```

我们已经使用这个版本大约六个月了，没有任何问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-15T19:19:13.187

这并不理想，因为最好指定一个与所涉及的列的数据类型相匹配的参数。

您需要检查您的查询计划，看看它们是否仍然合理。

尝试以下测试

```
CREATE TABLE #T
(
X VARCHAR(10) PRIMARY KEY
)

DECLARE @A VARCHAR(MAX) = CAST('A' AS VARCHAR(MAX))

SELECT *
FROM #T 
WHERE X = @A 
```

给出一个类似的计划

![计划](../Images/55be03cd6c9a70345351cf6bac1354c3.png)

SQL Server 向调用内部函数的计划添加了一个计算标量，`GetRangeWithMismatchedTypes`并且仍然设法执行索引查找（[有关隐式转换的更多详细信息，请参见此处](http://web.archive.org/web/20170303101108/http://sqlblog.com/blogs/paul_white/archive/2012/01/18/dynamic-seeks-and-hidden-implicit-conversions.aspx)）。

文章[为什么分区消除不起作用？](http://web.archive.org/web/20180422160838/http://sqlblog.com:80/blogs/paul_white/archive/2012/09/12/why-doesn-t-partition-elimination-work.aspx). 该文章中描述的行为也适用于`varchar(max)`针对按列分区的表的参数`varchar(n)`。

# asp.net-mvc - 查询中的多个联接

> ID：14342955
> 
> 赞同：1
> 
> 时间：2013-01-15T17:07:54.213
> 
> 标签：asp.net-mvc, entity-framework

我之前在向查询中添加连接时得到了一些帮助。我现在意识到我实际上需要在同一个查询中添加多个连接，但是我尝试了很多方法（基于原始连接）但不断出错。

我有一个名为 SchemeName 的模型 -

```
namespace TRS.Models
{
    public class SchemeName
    {
        [Key]
        public int SchemeNameID { get; set; }
        [Display(Name = "Scheme Name")]
        public string Name { get; set; }

        public virtual ICollection<Benefit> Benefits { get; set; }
    }
} 
```

以及多种员工福利模型，例如以下两个，每个模型都有 SchemeID -

```
namespace TRS.Models
{
    public class Pension
    {
        [Key]
        public string UserName { get; set; }
        public bool PensionRequired { get; set; }
        public int PensionSchemeNameID { get; set; }
        public int PensionProviderID { get; set; }
        public int PensionBenefitLevelID { get; set; }
        public decimal PensionEmployerCost { get; set; }
        public decimal PensionEmployeeCost { get; set; }

        public virtual PensionBenefitLevel PensionBenefitLevel { get; set; }

        [Required]
        public virtual User User { get; set; }
    }
}

namespace TRS.Models
{
    public class LifeAssurance
    {
        [Key]
        public string UserName { get; set; }
        public bool LifeAssuranceRequired { get; set; }
        public int LifeAssuranceSchemeNameID { get; set; }
        public int LifeAssuranceProviderID { get; set; }
        public string LifeAssuranceBenefitLevel { get; set; }
        public decimal LifeAssuranceEmployerCost { get; set; }
        public decimal LifeAssuranceEmployeeCost { get; set; }

        [Required]
        public virtual User User { get; set; }
    }
} 
```

在我的控制器中，我有以下内容 -

```
var trs = db.Users
                .Join(db.SchemeNames,
                user => user.Pension.PensionSchemeNameID, 
                schemeName => schemeName.SchemeNameID,
                (user, schemeName) => new { User = user, SchemeName = schemeName })
                .Where(a => UserIDs.Contains(a.User.UserName))
                .Select(a => new TRSViewModel
            { 
                UserName = a.User.UserName,
                FirstName = a.User.UserDetails.FirstName,
                LastName = a.User.UserDetails.LastName,
                Salary = a.User.UserDetails.Salary,
                PensionSchemeName = a.SchemeName.Name, 
```

这对于显示 PensionSchemeName 非常有用，但我还需要显示 LifeAssuranceSchemeName（和其他），但正如我所提到的，不断出现错误。我想我只需要添加一个带有 LifeAssuranceSchemeName 详细信息的附加连接，所以我尝试添加 -

```
 var trs = db.Users
                .Join(db.SchemeNames,
                user => user.Pension.PensionSchemeNameID, 
                schemeName => schemeName.SchemeNameID,
                (user, schemeName) => new { User = user, SchemeName = schemeName })
                .Join(db.SchemeNames,
                la => la.Pension.PensionSchemeNameID,
                schemeName => schemeName.SchemeNameID,
                (user, schemeName) => new { User = user, SchemeName = schemeName })
                .Where(a => UserIDs.Contains(a.User.UserName))
                .Select(a => new TRSViewModel 
```

但这给了我一个错误-

错误 10“AnonymousType#1”不包含“Pension”的定义，并且找不到接受“AnonymousType#1”类型的第一个参数的扩展方法“Pension”（您是否缺少 using 指令或程序集引用？）

知道如何添加这些额外的联接吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T20:20:49.623

我认为这些连接没有被正确链接。

在第二个连接中，第二个参数引用外部集合。这将是第一个 join 的投影匿名类型`new { User = user, SchemeName = schemeName })`。

假设在 User 类上有一个属性 LifeAssurance，那么我猜你想要基于来自用户对象的该属性进行第二次连接，如下所示：

```
var trs = db.Users
            .Join(db.SchemeNames,
                 user => user.Pension.PensionSchemeNameID, 
                 schemeName => schemeName.SchemeNameID,
                 (user, schemeName) => new { User = user, 
                                             SchemeName = schemeName })
            .Join(db.SchemeNames,
                 x => x.User.LifeAssurance.LifeAssuranceSchemeNameID,
                 schemeName => schemeName.SchemeNameID,
                 (x, schemeName) => new { User = x.User, 
                                          PensionSchemeName = x.SchemeName, 
                                          LifeAssuranceSchemeName = schemeName })
            .Where(a => UserIDs.Contains(a.User.UserName))
            .Select(a => new TRSViewModel{
                          UserName = a.User.UserName,
                          FirstName = a.User.UserDetails.FirstName,
                          LastName = a.User.UserDetails.LastName,
                          Salary = a.User.UserDetails.Salary,
                          PensionSchemeName = a.PensionSchemeName.Name,
                          LifeAssuranceSchemeName = a.LifeAssuranceSchemeName.Name
            }); 
```

这可以写在查询语法上（可能更容易阅读）：

```
var trs = from user in db.Users
          join pensionSchema in db.SchemeNames 
               on user.Pension.PensionSchemeNameID equals pensionSchema.SchemeNameID
          join lifeAssuranceSchema in db.SchemeNames 
               on user.LifeAssurance.LifeAssuranceSchemeNameID equals lifeAssuranceSchema.SchemeNameID
          where UserIds.Contains(user.UserName)
          select new TRSViewModel{
                      UserName = user.UserName,
                      FirstName = user.UserDetails.FirstName,
                      LastName = user.UserDetails.LastName,
                      Salary = user.UserDetails.Salary,
                      PensionSchemeName = pensionSchema.Name,
                      LifeAssuranceSchemeName = lifeAssuranceSchema.Name } 
```

最后，考虑到这些是内部连接，因此不会返回任何没有养老金或人寿保障模式的用户。如果你想要左连接，你可以做类似[这里](https://stackoverflow.com/questions/267488/linq-to-sql-multiple-left-outer-joins)描述的方法（虽然我猜你不需要这个，否则`user.Pension.PensionSchemeNameID`如果有没有养老金的用户，像这样的表达式会抛出 NullReferenceException）

```
var query =
      from user in db.Users
      from pensionScheme in db.SchemeNames
              .Where(s => s.SchemeNameID == user.Pension.PensionSchemeNameID)
              .DefaultIfEmpty()
      from lifeAssuranceScheme in db.SchemeNames
              .Where(s => s.SchemeNameID == user.LifeAssurance.LifeAssuranceSchemeNameID)
              .DefaultIfEmpty()
      select new { User = user, 
                   Pension = pensionScheme, 
                   LifeAssurance = lifeAssuranceScheme} 
```

我已经使用内存集合中的以下代码快速测试了这些查询，但它们应该通过实体框架正确转换为 SQL：

```
public class SchemeName
{
    public int SchemeNameID { get; set; }
    public string Name { get; set; }
}

public class Pension
{
    public int PensionSchemeNameID { get; set; }
}

public class LifeAssurance
{
    public int LifeAssuranceSchemeNameID { get; set; }
}

public class User
{
    public string Name { get; set; }
    public Pension Pension { get; set; }
    public LifeAssurance LifeAssurance { get; set; }
}

public static class db
{
    public static IEnumerable<User> Users = new List<User>() { 
            new User { Name = "User 1", 
                        Pension = new Pension { PensionSchemeNameID = 1 }, 
                        LifeAssurance = new LifeAssurance { LifeAssuranceSchemeNameID = 2 } },
            new User { Name = "User 2", 
                        Pension = new Pension { PensionSchemeNameID = 1 }, 
                        LifeAssurance = new LifeAssurance { LifeAssuranceSchemeNameID = 2 } },
            new User { Name = "User 3", 
                        Pension = new Pension { PensionSchemeNameID = 1 },
                        LifeAssurance = new LifeAssurance { LifeAssuranceSchemeNameID = -999 }},
            new User { Name = "User 4", 
                        Pension = new Pension { PensionSchemeNameID = -999 }, 
                        LifeAssurance = new LifeAssurance { LifeAssuranceSchemeNameID = 2 } }
    };
    public static IEnumerable<SchemeName> SchemeNames = new List<SchemeName>() { 
                new SchemeName{ SchemeNameID = 1, Name = "Scheme 1"  },
                new SchemeName{ SchemeNameID = 2, Name = "Scheme 2"  }
    };
}

    private void Run()
    {
        var innerJoinQuery1 = db.Users
                    .Join(db.SchemeNames,
                            user => user.Pension.PensionSchemeNameID,
                            schemeName => schemeName.SchemeNameID,
                            (user, schemeName) => new
                            {
                                User = user,
                                SchemeName = schemeName
                            })
                    .Join(db.SchemeNames,
                            x => x.User.LifeAssurance.LifeAssuranceSchemeNameID,
                            schemeName => schemeName.SchemeNameID,
                            (x, schemeName) => new
                            {
                                User = x.User,
                                PensionSchemeName = x.SchemeName,
                                LifeAssuranceSchemeName = schemeName
                            })
                    .Where(a => a.User.Name.StartsWith("User "))
                    .Select(a => new 
                    {
                        UserName = a.User.Name,
                        PensionSchemeName = a.PensionSchemeName.Name,
                        LifeAssuranceSchemeName = a.LifeAssuranceSchemeName.Name
                    });

        var innerJoinQuery2 = from user in db.Users
                     join pensionSchema in db.SchemeNames
                        on user.Pension.PensionSchemeNameID equals pensionSchema.SchemeNameID
                     join lifeAssuranceSchema in db.SchemeNames
                        on user.LifeAssurance.LifeAssuranceSchemeNameID equals lifeAssuranceSchema.SchemeNameID
                     where user.Name.StartsWith("User ")
                     select new
                               {
                                   UserName = user.Name,
                                   PensionSchemeName = pensionSchema.Name,
                                   LifeAssuranceSchemeName = lifeAssuranceSchema.Name
                               };

        var lefJoinQuery =
                      from user in db.Users
                      from pensionScheme in db.SchemeNames
                              .Where(s => s.SchemeNameID == user.Pension.PensionSchemeNameID)
                              .DefaultIfEmpty()
                      from lifeAssuranceScheme in db.SchemeNames
                              .Where(s => s.SchemeNameID == user.LifeAssurance.LifeAssuranceSchemeNameID)
                              .DefaultIfEmpty()
                      select new
                      {
                          UserName = user.Name,
                          PensionSchemeName = pensionScheme != null ? pensionScheme.Name : "No Pension",
                          LifeAssuranceSchemeName = lifeAssuranceScheme != null ? lifeAssuranceScheme.Name : "No Life Assurance"
                      }; 

        foreach (var result in innerJoinQuery1)
            Print(result.UserName, result.PensionSchemeName, result.LifeAssuranceSchemeName);

        Console.WriteLine();

        foreach (var result in innerJoinQuery2)
            Print(result.UserName, result.PensionSchemeName, result.LifeAssuranceSchemeName);

        Console.WriteLine();

        foreach (var result in lefJoinQuery)
            Print(result.UserName, result.PensionSchemeName, result.LifeAssuranceSchemeName);

        Console.WriteLine();

        Console.ReadKey();
    }

    private void Print(string user, string pension, string lifeAssurance)
    {
        Console.WriteLine(String.Format("User: '{0}', Pension: '{1}', Life Assurance: '{2}'", user, pension, lifeAssurance));
    }
} 
```

这会产生预期的输出：

> 对于第一个内连接查询
> 
> > 用户：“用户 1”，养老金：“方案 1”，人寿保险：“方案 2”
> > 
> > 用户：“用户 2”，养老金：“方案 1”，人寿保险：“方案 2”
> 
> 对于第二个内连接查询
> 
> > 用户：“用户 1”，养老金：“方案 1”，人寿保险：“方案 2”
> > 
> > 用户：“用户 2”，养老金：“方案 1”，人寿保险：“方案 2”
> 
> 对于左连接查询
> 
> > 用户：“用户 1”，养老金：“方案 1”，人寿保险：“方案 2”
> > 
> > 用户：“用户 2”，养老金：“方案 1”，人寿保险：“方案 2”
> > 
> > 用户：“用户 3”，养老金：“方案 1”，人寿保险：“无人寿保险”
> > 
> > 用户：“用户 4”，养老金：“无养老金”，人寿保险：“方案 2”

# nomachine-nx - NX 服务器的连接超时不再

> ID：14342959
> 
> 赞同：2
> 
> 时间：2013-01-15T17:08:06.160
> 
> 标签：nomachine-nx

嗨，我成功地使用 Windows 机器（版本）中的 NX 客户端连接到 Ubuntu 机器上的 NX 服务器，但突然间，我收到超时连接错误，来自 Windows 无机器客户端的以下日志信息

```
NX> 203 NXSSH running with pid: 5284
NX> 285 Enabling check on switch command
NX> 285 Enabling skip of SSH config files
NX> 285 Setting the preferred NX options
NX> 200 Connected to address: 10.10.13.125 on port: 22
NX> 202 Authenticating user: nx
NX> 208 Using auth method: publickey
HELLO NXSERVER - Version 3.5.0-11 - LFE
NX> 105 Hello NXCLIENT - Version 3.5.0
NX> 134 Accepted protocol: 3.5.0
NX> 105 Set shell_mode: shell
NX> 105 Set auth_mode: password
NX> 105 Login 
NX> 101 User: wshowair
NX> 102 Password: ***
NX> 103 Welcome to: enb-test user: wshowair
NX> 105 Listsession --user="wshowair" --status="suspended\054running" --geometry="1366x768x32+render" --type="unix-gnome" 
NX> 127 Available sessions: 

Display Type             Session ID                       Options  Depth Screen         Status      Session Name
------- ---------------- -------------------------------- -------- ----- -------------- ----------- ------------------------------

NX> 148 Server capacity: not reached for user: wshowair
NX> 105 Start session with: --link="adsl" --backingstore="1" --encryption="1" --cache="16M" --images="64M" --shmem="1" --shpix="1" --strict="0" --composite="1" --media="NX> 280 Exiting on signal: 15 
```

同时，我在 Ubuntu 上收到以下日志消息，我从 /var/log/messages 获得以下输出：

```
wshowair@enb-test:~$ tail -n30 /var/log/messages
Jan 15 11:05:51 enb-test NXSERVER-3.5.0-11[11475]: Session '3CFE5967E8DC57A0EA75FE19ACC9ACE6' started by user 'wshowair'. 'NXShell::handler_session_start'
Jan 15 11:05:51 enb-test NXNODE-3.5.0-9[11620]: Using port '1001' on node 'enb-test' for session 'unix-gnome'. Logger::log nxnode 6243
Jan 15 11:05:51 enb-test NXNODE-3.5.0-9[11620]: Using host from available host list: '10.10.13.125'. Logger::log nxnode 6244
Jan 15 11:06:49 enb-test NXSERVER-3.5.0-11[11475]: Received 'PIPE' signal: this signal is ignored by NX Server 'main::Static'
Jan 15 11:06:49 enb-test NXSERVER-3.5.0-11[11475]: Cannot read from stdin: NX client disconnected before the 'bye' message: exiting cleanly 'NXShell::handleExitRequests'
Jan 15 11:06:49 enb-test NXSERVER-3.5.0-11[11475]: User 'wshowair' from '192.168.101.225' logged out. 'NXLogin::reset'
Jan 15 11:06:49 enb-test NXSERVER-3.5.0-11[11475]: Received 'PIPE' signal: this signal is ignored by NX Server 'main::Static'
Jan 15 11:06:51 enb-test NXNODE-3.5.0-9[11620]: ERROR: run command: process: 11644 finished with: 1 Logger::log nxnode 3907
Jan 15 11:06:51 enb-test NXNODE-3.5.0-9[11653]: ERROR: Error when monitoring session: Unexpected termination of nxagent 'NXSessionMonitor::__setSessionStatus'
Jan 15 11:06:52 enb-test NXNODE-3.5.0-9[11653]: Directory '/home/wshowair/.nx/C-enb-test-1001-3CFE5967E8DC57A0EA75FE19ACC9ACE6' renamed into '/home/wshowair/.nx/F-C-enb-test-1001-3CFE5967E8DC57A0EA75FE19ACC9ACE6' for further investigation Logger::log nxnode 6432
Jan 15 11:06:53 enb-test NXNODE-3.5.0-9[11620]: Session 'unix-gnome' on port '1001' failed. Logger::log nxnode 6513
Jan 15 11:06:59 enb-test NXSERVER-3.5.0-11[11646]: ERROR: NXNodeExec: Cannot kill nxssh process: No such process 'NXNodeExec::exec'
Jan 15 11:06:59 enb-test NXSERVER-3.5.0-11[11646]: User 'wshowair' from '192.168.101.225' logged out. 'NXLogin::reset'
Jan 15 11:31:00 enb-test NXSERVER-3.5.0-11[12270]: User 'wshowair' logged in from '192.168.101.225'. 'NXLogin::set'
Jan 15 11:31:01 enb-test NXSERVER-3.5.0-11[12270]: Selected node host:localhost with port:22 'main::selectNode'
Jan 15 11:31:01 enb-test NXSERVER-3.5.0-11[12270]: Current selected node: localhost is in status: running  'main::selectNode'
Jan 15 11:31:01 enb-test NXSERVER-3.5.0-11[12270]: Selected session type: unix-gnome allowed in the profile of user: wshowair 'NXShell::Static'
Jan 15 11:31:03 enb-test NXSERVER-3.5.0-11[12270]: Session 'D038E20195545ACA3EBB4F14FDF14371' started by user 'wshowair'. 'NXShell::handler_session_start'
Jan 15 11:31:04 enb-test NXNODE-3.5.0-9[12415]: Using port '1002' on node 'enb-test' for session 'unix-gnome'. Logger::log nxnode 6243
Jan 15 11:31:04 enb-test NXNODE-3.5.0-9[12415]: Using host from available host list: '10.10.13.125'. Logger::log nxnode 6244
Jan 15 11:32:02 enb-test NXSERVER-3.5.0-11[12270]: Received 'PIPE' signal: this signal is ignored by NX Server 'main::Static'
Jan 15 11:32:02 enb-test NXSERVER-3.5.0-11[12270]: Cannot read from stdin: NX client disconnected before the 'bye' message: exiting cleanly 'NXShell::handleExitRequests'
Jan 15 11:32:02 enb-test NXSERVER-3.5.0-11[12270]: User 'wshowair' from '192.168.101.225' logged out. 'NXLogin::reset'
Jan 15 11:32:02 enb-test NXSERVER-3.5.0-11[12270]: Received 'PIPE' signal: this signal is ignored by NX Server 'main::Static'
Jan 15 11:32:03 enb-test NXNODE-3.5.0-9[12415]: ERROR: run command: process: 12439 finished with: 1 Logger::log nxnode 3907
Jan 15 11:32:04 enb-test NXNODE-3.5.0-9[12448]: ERROR: Error when monitoring session: Unexpected termination of nxagent 'NXSessionMonitor::__setSessionStatus'
Jan 15 11:32:04 enb-test NXNODE-3.5.0-9[12448]: Directory '/home/wshowair/.nx/C-enb-test-1002-D038E20195545ACA3EBB4F14FDF14371' renamed into '/home/wshowair/.nx/F-C-enb-test-1002-D038E20195545ACA3EBB4F14FDF14371' for further investigation Logger::log nxnode 6432
Jan 15 11:32:05 enb-test NXNODE-3.5.0-9[12415]: Session 'unix-gnome' on port '1002' failed. Logger::log nxnode 6513
Jan 15 11:32:11 enb-test NXSERVER-3.5.0-11[12441]: ERROR: NXNodeExec: Cannot kill nxssh process: No such process 'NXNodeExec::exec'
Jan 15 11:32:11 enb-test NXSERVER-3.5.0-11[12441]: User 'wshowair' from '192.168.101.225' logged out. 'NXLogin::reset' 
```

我试图在服务器 Ubuntu 机器和 nomachine windows 客户端上重新安装 nxserver 和 nxnode，但仍然有相同的连接超时错误，任何想法

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-05T00:33:51.540

这种类型的故障可能是由可能难以诊断的几种类型的问题引起的。NX 服务器通常工作正常，但服务器上的某些软件更新或配置更改会创建与 NX 不兼容的配置。

对于您在上面看到的症状，第一个检查是查看您的远程 Xsession 是否设置为 run `xscreensaver`。进入服务器并运行`killall xscreensaver`并尝试再次与 NX 连接。如果可行，请重新配置您的 Xsession，禁用屏幕保护程序功能。

您可以尝试的其他事情：

*   删除`${HOME}/.nx`包含缓存会话信息的目录
*   创建一个新用户并尝试以该用户身份连接。如果这有效，它确认您有一些 NX 无法容忍的本地 Xsession 设置。您可以尝试解决这些问题，或者如果您想采取严厉措施，您可以备份您的主目录并创建一个新目录，这将删除您的所有`.*`设置文件并恢复正常工作的 NX。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-04-25T21:25:58.393

您必须验证您尝试在 NX 中启动的用户是否已添加到 nxserver

nxserver --adduser 用户

如果未在 nxserver 中添加，则不会启动会话。

问候

# sql-server - springsource STS中insert语句的SQL语法错误

> ID：14342960
> 
> 赞同：0
> 
> 时间：2013-01-15T17:08:09.557
> 
> 标签：sql-server, sts-springsourcetoolsuite, springsource

我是springsource的新手，这是我的第一个项目。我正在读取 s 平面文件并将其保存到 MS SQL Server 2008 表中，但下面的命令不正确。它适用于我一直用作模型的类似项目（我复制了组件并修改了命令以读取我自己的输入文件格式和我自己的 SQL 服务器表）。

我为我的项目创建的表和我的模型中的表之间的区别在于我的表包含一个主键和一个辅助键，因为在源模型中，输出表只有一个主键。下面是“坏”插入语句，任何帮助将不胜感激。

```
String sql = "insert into dbo.IN136_DMV_USED_CAR_SALES (EXT_INF_LOAD_ID, IN136_ID, " + 
                        "DEALER_NUM, " +
                        "VSL_PURCHASE_DATE," +
                        "OWNERSHIP_ISSUED_DATE, " +
                        "LAST_TRANSFER_DATE, " +
                        "ODOMETER_CURRENT_DATE, " +
                        "WORK_DATE, " +
                        "PURCHASE_PRICE, " +
                        "VIN_HIN, " +
                        "CURRENT_LICENSE, " +
                        "REG_OWNER_NAME, " +
                        "REG_OWNER_ADDRESS2, " +
                        "REG_OWNER_ADDRESS3, " +
                        "REG_OWNER_CITY_OR_STATE) values (?, NEWID(), ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)"; 
```

这是我可以从控制台看到的唯一内容：

> 计数器=1 IN136DataRecod=boe.eai.provider.dmv.IN136DataRecord@d5c0f9and sql 即将失败 INFO：org.springframework.beans.factory.xml.XmlBeanDefinitionReader - 从类路径资源加载 XML bean 定义 [org/springframework/jdbc /support/sql-error-codes.xml] logger.debug DMVErr, e=org.springframework.jdbc.BadSqlGrammarException: PreparedStatementCallback; bad SQL grammar [insert into dbo.IN136_DMV_USED_CAR_SALES (EXT_INF_LOAD_ID, IN136_ID, DEALER_NUM, VSL_PURCHASE_DATE,OWNERSHIP_ISSUED_DATE, LAST_TRANSFER_DATE, ODOMETER_CURRENT_DATE, WORK_DATE, PURCHASE_PRICE, VIN_HIN, CURRENT_LICENSE, REG_OWNER_NAME, REG_OWNER_ADDRESS2, REG_OWNER_ADDRESS3, REG_OWNER_CITY_OR_STATE) values (?, NEWID(), ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]; 嵌套异常是 java.sql.SQLException: Invalid parameter index 15。

在此先感谢您的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-22T15:34:27.453

我认为问题出在你的写作方式上。

插入***dbo*** .IN136_DMV_USED_CAR_SALES

尝试删除架构名称。

# javascript - 如何计算 Bing 地图中的大量图钉？

> ID：14342966
> 
> 赞同：0
> 
> 时间：2013-01-15T17:08:30.760
> 
> 标签：javascript, bing-maps

我正在为我所在国家/地区的网络问题设计地图，每个城市有 1000 点或更多点。当我看到没有缩放的城市时，我想显示那个地方的点的完整计数（例如 50），如果你使用缩放开始显示带有新数字的新图钉，例如某个地方的 10 和其他15在另一个地方。

我该怎么做？如果有可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T21:37:11.450

听起来你想在 Pushpins 上做 Clustering：[Pushpin Clustering on V7 交互式 SDK](http://www.bingmapsportal.com/isdk/ajaxv7#LoadingDynamicModule1)

# python - python/Flask：带有动态第一个组件的路由

> ID：14342969
> 
> 赞同：0
> 
> 时间：2013-01-15T17:08:36.600
> 
> 标签：python, routes, flask

我正在写一个 Flask 网站，我希望有这样的路线：

```
@app.route('/')
@app.route('/<page_id>')
@app.route('/<page_id>/<subpage_id>')
def page(page_id=None, subpage_id=None):
    ... 
```

虽然看起来这在理论上应该可行，但看起来这实际上破坏了位于根 static/ 目录中的静态资源。我认为这样做的原因是我的动态路由实际上匹配'static/style.css'，因此覆盖了静态文件的正常处理程序。

有没有办法解决？如果我检测到 page_id=='static'，是否有可以将请求转发到的“静态”处理程序？

编辑：这是一个工作示例

```
@app.route('/<page_id>/<subpage_id>/<subsubpage_id>')
def xxx(page_id=None, subpage_id=None, subsubpage_id=None):
    return 'hello' 
```

如果你`http://127.0.0.1:5000/static/css/style.css`现在打开你应该得到一个“你好”而不是文件。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-16T01:06:23.297

关于你的问题的根源：

> 是的。我的数据库中有 Page 对象，当调用该方法时，我会根据 page_id/subpage_id/subsubpage_id 加载和显示这些对象。有一个更好的方法吗？我正在考虑在应用程序初始化时为每个页面添加单独的路由，但我找不到与 url_for 结合使用的好方法。

您可以使用 . 直接注册路由处理程序[`app.add_url_rule`](http://flask.pocoo.org/docs/api/#flask.Flask.add_url_rule)。默认情况下它将使用函数的名称`url_for`，是的，但是您可以通过传递`endpoint`参数来覆盖它。

所以也许你会有这样的事情：

```
from functools import partial

def actual_handler(page):
    return u'hello'

for page in session.query(Page):
    route = u'/{0}/{1}/{2}'.format(page.id1, page.id2, page.id3)
    app.add_url_rule(
        route,
        page.name,  # this is the name used for url_for
        partial(actual_handler, page=page),
    ) 
```

获取会话可能会或可能不会很棘手，并且可能会或可能不会涉及手动调用之类的工作`session.remove()`；我之前没有尝试在 Flask 处理程序之外使用 SQLAlchemy。假设您首先使用的是 SQLA。

另请参阅[有关路线处理的文档](http://flask.pocoo.org/docs/api/#url-route-registrations)。

至于路由优先于静态文件的原始问题，我真的不知道；根据我对 Flask 和 Werkzeug 文档的阅读，这不应该发生。如果您仍希望通过手动提供静态文件来解决此问题，也许[`send_from_directory`](http://flask.pocoo.org/docs/api/#flask.send_from_directory)会有所帮助。无论如何，您的 Web 服务器可能会直接在生产中提供静态文件，因此可能不值得上面的元编程垃圾。

PS：事后诸葛亮；[如果您的整个站点都位于数据库中，那么Pyramid 的遍历](http://docs.pylonsproject.org/projects/pyramid/en/latest/narr/traversal.html)可能更合适。它动态地一次检查一个路径组件，而不是拥有一个固定的静态路由列表。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T23:58:04.107

这是一个可怕的黑客，但你可能只做类似的事情：

```
@app.route('/<page_id>/<subpage_id>/<subsubpage_id>')
def xxx(page_id=None, subpage_id=None, subsubpage_id=None):
    if page_id == 'static':  # or whatever the path is to your assets
       # make a response where you've filled the request yourself
    return 'hello' 
```

# android - 如何将多个 greenDAO Tx 操作合并到一个事务中？

> ID：14342972
> 
> 赞同：6
> 
> 时间：2013-01-15T17:08:46.617
> 
> 标签：android, greendao

我的应用程序使用远程 REST API 并使用 greenDao 填充本地数据库。我有一个 AsyncTask 类的服务：

```
@Override
protected Void doInBackground(Void... params) {
    insert100RowsIntheFirstTable();
    insert100RowsIntheSecondTable();
} 
```

在每个插入方法中，我都有 insertOrReplaceInTx，我主要使用它来提高性能。

如果任何方法无法检索数据，我需要放弃结果。它应该通过相同的交易来完成。

`mDaoSession.callInTx(callable)`我想知道在方法内部包含我的插入方法调用是否正确`insertOrReplaceInTx`。我对吗？

此外，如果引发异常，我如何放弃交易 - 它是通过 greenDao 自动完成的吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-16T22:04:21.377

是的，如果您的代码可以抛出异常，请使用 callInTx（如果不是，您也可以考虑 runInTx。Android 的 SQLite API 负责处理那些“嵌套”事务。

毕竟，如果您查看源代码， callInTx 只是一些方便之处：

```
public <V> V callInTx(Callable<V> callable) throws Exception {
    db.beginTransaction();
    try {
        V result = callable.call();
        db.setTransactionSuccessful();
        return result;
    } finally {
        db.endTransaction();
    }
} 
```

# performance - 加载 Meteor 页面时的 sockjs JSONP 请求是什么，如何优化下载速度？

> ID：14342973
> 
> 赞同：3
> 
> 时间：2013-01-15T17:08:50.013
> 
> 标签：performance, optimization, meteor, sockjs

附图来自[http://www.webpagetest.org/](http://www.webpagetest.org/)。我正在开发一个真实的网站，下载大约需要 10 秒。然后我创建了一个非常基本的站点来查看发生了什么，并进行了速度测试。下载这些文件需要超过 2 秒，我不确定它们是什么，或者如何更改我的应用程序以减少页面加载时间。

13 号的（相关？）信息是：

```
URL: https://ddp--6189--50f5840c089282031a00a004.meteor.com/sockjs/632/7ke6oz_0/jsonp?c=_jp.a2ujpxq
Host: ddp--6189--50f5840c089282031a00a004.meteor.com
IP: 107.21.116.12
Location: Ashburn, VA
Error/Status Code: 200
Start Offset: 4.652 s
Time to First Byte: 25065 ms
Content Download: 256 ms
Bytes In (downloaded): 0.5 KB
Bytes Out (uploaded): 0.5 KB

GET /sockjs/632/7ke6oz_0/jsonp?c=_jp.a2ujpxq HTTP/1.1
Accept: */*
Accept-Language: en-US
Host: ddp--6189--50f5840c089282031a00a004.meteor.com
Connection: Keep-Alive 
```

任何提示或指示都会很棒，谢谢。

![JSONP 下载量的瀑布](../Images/adf785ec556408b20cf8332b13355bab.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T18:04:42.553

这实际上是 SockJS 在浏览器和 Web 服务器之间保持通信通道打开，它不会像这样下载 - 请注意在第一个套接字事件（第 13 行）之后您在*BandwidthIn图中看到的带宽减少。*

这是通过 SockJS 获得的更多信息 - [https://github.com/sockjs/sockjs-client](https://github.com/sockjs/sockjs-client)：

> SockJS 是一个提供类 WebSocket 对象的浏览器 JavaScript 库。SockJS 为您提供了一个连贯的、跨浏览器的 Javascript API，它在浏览器和 Web 服务器之间创建了一个低延迟、全双工、跨域的通信通道。

# database - LINQ to SQL 如何在 .ashx 文件中使用它来生成 json？

> ID：14342980
> 
> 赞同：1
> 
> 时间：2013-01-15T17:09:03.087
> 
> 标签：database, json, linq, linq-to-sql, ashx

我有一些问题要弄清楚如何在 .ashx 文件中使用 LINQ to SQL 来生成 json？我可以使用此代码生成 json，但我需要选择 TaskName 和 createdOn 列。有人可以帮我如何选择 TaskName 和 createdOn 列来生成 json 吗？

```
 //DataClasses1DataContext db = new DataClasses1DataContext();
        //var tasksCreatedOm = from c in db.Tasks
        //                     select c.createdOn;

        //the bloack will get all data in table 
        context.Response.ContentType = "text/json";
        context.Response.Write(new SchedulerAjaxData(new  DataClasses1DataContext().Tasks)); 
```

我的任务课 ![在此处输入图像描述](../Images/8c909c3ab4f95495a0e66de2d14dd1c4.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T17:51:16.800

尝试以下方法（未经测试）：

```
using(DataClasses1DataContext db = new DataClasses1DataContext())
{
    var tasksCreatedOn = from c in db.Tasks
                        select new { c.taskName, c.createdOn };

    // This block will get all data in table 
    var serializer = new JavaScriptSerializer();
    context.Response.ContentType = "text/json";
    context.Response.Write(serializer.Serialize(tasksCreatedOn));
} 
```

`taskName`首先，我将您的任务投影到一个包含and的匿名类型中`createdOn`。然后我用 将`JavaScriptSerializer`它们序列化为 JSON。我还添加了一个`using`块，以便`DataContext`正确处理。

# c# - 检测 Prism 上的面板负载

> ID：14342982
> 
> 赞同：1
> 
> 时间：2013-01-15T17:09:04.883
> 
> 标签：c#, .net, wpf, prism

我似乎无法找到一种方法来检测面板何时完成加载。我正在向已经存在的 WPF/Prism 项目添加几个功能。当页面完成渲染时，我需要被回调。我试过这个：

在页面加载时我需要回调的 XAML 顶部的 UserControl 中：

```
<UserControl x:....

xmlns:i="clr-namespace:System.Windows.Interactivity;assembly=System.Windows.Interactivity"
...>

<i:Interaction.Triggers>
        <i:EventTrigger EventName="Loaded">
            <i:InvokeCommandAction Command="{Binding DoSomething}" />
        </i:EventTrigger>
    </i:Interaction.Triggers> 
```

然后在文件后面的代码中：

```
public void DoSomething(object sender, EventArgs e)
{
     System.Diagnostics.Debug.WriteLine("received callback");
} 
```

它目前不起作用，我不确定这是否是正确的路径，因为我是 WPF、prism 和 .NET 的新手。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T14:00:34.757

好吧，我看到您已经知道答案了...无论如何...您做错了什么，您一直在将事件绑定到 XAML 中的命令，而您没有命令:) 基本上，您将标准的“代码隐藏方法”搞砸了让我们说“MVVM 方法”/绑定。

因此，当您触摸代码隐藏并在`DoSomethingEventHandler`那里创建您的代码时，您可以简单地

```
 <UserControl .. Loaded="UserControl_Loaded"> 
    .. 
    </UserControl> 
```

使用您的 CodeBehind：

```
 private void UserControl_Loaded(object sender, System.Windows.RoutedEventArgs e)
    {
        // Do Something
    } 
```

没关系...但它不是 MVVM :]

好吧，对于你的新方法（没有代码隐藏/让我们说 MVVM）......

如果您使用 Prism v4.1，您可以[在此处查看](http://compositewpf.codeplex.com/workitem/5495)大多数人在 Prism 中错过的此功能 :) 但提到了解决方案 :)

好吧，你知道你需要`ICommand`你绑定到......它不一定是`DelegateCommand`你可以使用你想要的......（我更喜欢并使用`RelayCommand`）

好吧，但是我们从上述链接中学到了什么？

1.  有时...不是这次...`ICommand`可以更改控件启用状态，并且当您不使用时它不会更新，`Prism's Interactivity`而您只需使用`Blend SDK's Interactivity`...您这次不需要它...我承认...但也许有一天:)
2.  而且你不需要处理程序中的那些愚蠢的参数，因为你无论如何都没有得到它们：D（当你需要那些 Args 时，你可以使用 MVVM Light 例如。）

所以你能做的最好的就是：

```
<UserControl
    xmlns:i="http://schemas.microsoft.com/expression/2010/interactivity"
    xmlns:prism="clr-namespace:Microsoft.Practices.Prism.Interactivity;assembly=Microsoft.Practices.Prism.Interactivity"
...    
>
...
<i:Interaction.Triggers>
    <i:EventTrigger EventName="Loaded">
        <prism:InvokeCommandAction Command="{Binding MyCommand}" />
    </i:EventTrigger>
</i:Interaction.Triggers> 
```

和你的 ViewModel 例如：

```
 public ICommand MyCommand
    {
        get
        {
            return new RelayCommand(this.MyCommandExecute);
        }
    }

    private void MyCommandExecute()
    {
        // DO Something...
    } 
```

抱歉，我没有回答已经回答的问题，但我想我可能会添加一些有趣的信息:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T17:21:40.133

哦，我想我刚刚想通了。找到这篇文章：[绑定 Loaded 事件？](https://stackoverflow.com/questions/7887867/binding-the-loaded-event)

我需要创建一个新的 DelegateCommand

```
public DelegateCommand DoSomething {get; set; } 
```

然后将其绑定到回调：

```
DoSomething = new DelegateCommand(DoSomethingCommandHandler); 
```

然后在我的

```
private void DoSomethingCommandHandler
{
    // callback received
} 
```

似乎工作。让我知道是否有更好的东西。就像我说的，我完全是菜鸟。

# .net - Try/Catch 没有抑制 ODBC 驱动程序错误消息

> ID：14342984
> 
> 赞同：1
> 
> 时间：2013-01-15T17:09:06.083
> 
> 标签：.net, vb.net, teradata

我正在尝试在进入下一个表单之前处理登录错误，并且在大多数情况下，一切正常。我遇到了一个问题 - 当网络连接未建立时，ODBC 驱动程序会提供自己丑陋的错误消息。

这是我的代码：

```
Try
     ODBCconnection.Open()
     ODBCconnection.Close()
     Me.Hide()
     otherForm.ShowDialog()
Catch ex As Exception
     If ex.Message.IndexOf("ugly network problem message") > -1 Then
         MsgBox("fancy network problem message")
     ElseIf ex.Message.IndexOf("other error message") > -1 Then
         MsgBox("fancy other error message")
     End If
End Try 
```

所以，如果“other error message”被捕获，它会显示“fancy other error message”，但如果“ugly network problem message”被捕获，它会同时显示丑陋和花哨的错误消息。

我认为驱动程序本身正在生成一条消息，关于如何抑制它的任何想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T18:02:59.983

在处理异常之前，您需要处理该特定的 ODBC`System.Exception`异常。

要回答您有关具体细节的问题...

```
Try
     ODBCconnection.Open()
     ODBCconnection.Close()
     Me.Hide()
     otherForm.ShowDialog()
Catch oex as System.Data.Odbc.OdbcException
     'Do something with the OdbcException
Catch ex As Exception
     If ex.Message.IndexOf("ugly network problem message") > -1 Then
         MsgBox("fancy network problem message")
     ElseIf ex.Message.IndexOf("other error message") > -1 Then
         MsgBox("fancy other error message")
     End If
End Try 
```

规则是您的异常处理必须从更多特定流向不太特定或从派生的异常类到它们的基类一直流回`System.Exception`. 换句话说，如果您有任何特定的异常要处理，则必须在处理异常之前处理这些`System.Exception`异常......

在您在块中放置断点时弹出的 Visual Studio 异常帮助程序中，`Catch ex As Exception`您可以准确地看到正在抛出的异常是什么，这是您必须在`Catch ex As Exception`块之前捕获的异常......

![异常助手](../Images/650ba804025fb585a54a4b016f8b1a17.png)

正如您从屏幕截图中看到的，VS 异常助手显示异常的确切名称，如果您单击“查看详细信息”，您会看到一个包含更多详细信息的窗口，包括发生的异常的完整命名空间......你有没有看到这个异常帮助程序还是您正在使用其他 IDE？

# php - Plupload 在 2MB 图片上失败

> ID：14342985
> 
> 赞同：0
> 
> 时间：2013-01-15T17:09:05.957
> 
> 标签：php, plupload

我有一个[PLupload](http://www.plupload.com)在我的服务器上工作。我将`fastcgi`值更改为`MaxRequestLen`在使用更大的文件时不会出现致命错误。最大上传大小为 10MB，块大小为 10MB，内存限制设置为 40M，时间限制设置为 0。

*   当我上传 2MB 图片时，它会显示带有标题的错误消息`HTTP Error.`。

*   我的这个 Ajax 请求的错误日志是空的。

但是，较小的图片已成功上传。

我需要在哪里寻找问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T18:07:59.617

错误日志说什么。

通常您在 php 设置中设置最大上传大小。

# javascript - 独立于侧边栏滚动主页内容

> ID：14342987
> 
> 赞同：4
> 
> 时间：2013-01-15T17:09:13.827
> 
> 标签：javascript, jquery, html, css, webforms

我们网站的母版页在左侧有一个带有一些菜单选项的窄栏，页面内容占据了右侧的其余空间。

我正在尝试确定允许页面内容独立于左列滚动的最佳方式。

我知道我可以为主要内容创建一个可滚动的 div，但我必须保持高度与浏览器窗口高度完全相同，以防止浏览器的主滚动条出现。如果我用 JavaScript 调整它的大小，我相信在调整窗口大小时会有延迟，这看起来有点俗气。

谁能有更好的方法来构建页面以在主页滚动时保持左列静止？（注意：如果左栏太高，可能还需要滚动。）

[页面布局 http://www.softcircuits.com/Client/Layout.png](http://www.softcircuits.com/Client/Layout.png)

上图显示了所需的布局。我希望主要内容独立于侧边栏或标题滚动。但是，如果我只是让它成为一个可滚动的`<div>`，我可以让两个滚动条彼此相邻（一个用于可滚动`<div>`，另一个用于主浏览器窗口）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-15T17:23:22.207

您可以定位左列`fixed`，使其固定在窗口上，而页面的其余部分滚动。例如，

```
.left-column {
  position: fixed;
} 
```

演示：http: [//jsfiddle.net/Yv3qX/](http://jsfiddle.net/Yv3qX/)

通过从底部定位它也可以让它自己独立滚动：

```
.left-column {
  position: fixed;
  top: 0;
  bottom: 0;
  overflow: scroll;
} 
```

演示：http: [//jsfiddle.net/Yv3qX/1/](http://jsfiddle.net/Yv3qX/1/)

# java - 为什么我们允许在 java 中将 char 分配给 int？

> ID：14342988
> 
> 赞同：6
> 
> 时间：2013-01-15T17:09:21.137
> 
> 标签：java

> **可能重复：**
> [Java 中的 char 和 int](https://stackoverflow.com/questions/8549692/char-and-int-in-java)

AsicII 表：[http ://www.asciitable.com](http://www.asciitable.com)

下面的代码打印出对应字符的十进制值，例如“123”-> 49 50 51

```
 public void foo(String str)
        {
            for(int x = 0; x < str.length(); x++)
            {
                int temp = str.charAt(x);
                System.out.println(temp);
            }
        } 
```

但是我注意到 java 是一种强类型语言，这意味着每件事都必须在编译时进行转换，但是代码为什么知道如何以及何时将 char 转换为 AsicII 表中正确的 Dec 值？我是否搞砸了任何 java/编程基础？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-15T17:12:11.580

A`char`只是一个无符号的 16 位数字，因此由于它基本上是`int`类型的子集，JVM 可以毫无歧义地转换它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-15T17:11:41.287

Java 是基于 C 编写的，这就是 C 的一个特性：字符也代表一个数字

但是，作为标量类型，有一个问题： - 打印 char 将产生 ascii char - 打印 int 将产生数字

还有一些关于upcast和downcast的细节（int转换成char，需要明确地完成，因为涉及到一些截断）

例子：

```
long a = 1L; // a real long
long n = 5; // int, cast to long
int x = n;  // (will raise an error)
int z = (int) n; // works fine 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-15T17:14:28.817

char有双重人格。

它是一个 16 位无符号整数数值类型，这使得对 int 的赋值成为一种非常自然的操作，包括扩展原始转换，这是编译器在需要时插入的转换之一，无需显式强制转换。

这也是 I/O 和字符串操作的字符表示方式。

# jira - 在 Jira-On-Demand 中自动解决工单

> ID：14342989
> 
> 赞同：0
> 
> 时间：2013-01-15T17:09:22.223
> 
> 标签：jira

在 Jira 的 SAAS 版本中，有没有办法在给定时间段后自动关闭工单？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T10:52:02.760

我必须做[类似](https://stackoverflow.com/questions/11490566/jira-issue-reminder#answer-11536935)的事情，而不是关闭问题，而是创建一个 12/24/36/48 小时提醒问题。我通过创建一个名为“Open since”的自定义字段来做到这一点 - 一个“日期时间”字段来保存问题已打开的时间。

使用[Jira Scripting Suite](https://marketplace.atlassian.com/plugins/com.quisapps.jira.jss)，我创建了一个后期函数，并将其放置在每个进入“打开”状态的转换中，以保持问题打开时间，使用以下代码：

```
from com.atlassian.jira import ComponentManager
from datetime import datetime
opend_since_field = "customfield_10001"
# get opened since custom field:
cfm = ComponentManager.getInstance().getCustomFieldManager()
# get current time
currentTime = datetime.today()
# save current time
issue.setCustomFieldValue(cfm.getCustomFieldObject(opend_since_field),currentTime) 
```

我创建了一个新过滤器来获取超过 24 小时开放的问题列表：

```
project = XXX AND status= Open ORDER BY updated ASC, key DESC 
```

最后——我使用了[Jira 远程 API](https://developer.atlassian.com/display/JIRADEV/JIRA+Remote+API+Reference) —— [XML-RPC 方法](https://developer.atlassian.com/display/JIRADEV/JIRA+XML-RPC+Overview)来编写一个安排为每 5 分钟运行一次的 Python 脚本。脚本读取过滤器发出的所有邮件，拉出所有处于“打开”状态超过 24 小时/36 小时/48 小时的邮件，发送提醒电子邮件，并将它们标记为已通知，因此每种类型只会发送一个提醒.

您可以转到[原始问题](https://stackoverflow.com/questions/11490566/jira-issue-reminder#answer-11536935)以查看完整的脚本，但如果您正在处理较新的 Jira 实例，您可能希望使用此处的 REST API 编写它。请注意，我的脚本只是发送通知电子邮件，但可以轻松更改为关闭问题，您甚至可以使用它将关闭的问题邮寄给自己。

如果您在编码方面需要帮助，请随时询问:)

# java - Java Applet 在运行 JRE 1.7 的客户端上有奇怪的怪癖

> ID：14342990
> 
> 赞同：0
> 
> 时间：2013-01-15T17:09:22.150
> 
> 标签：java, applet, java-7

我有一个由在 Java 1.5 上运行的 Weblogic 10 提供服务的小程序。我曾尝试使用 Java 1.6 和 Java 1.7 构建有问题的小程序，但两者都有相同的怪癖。

问题是，当客户端使用 JRE 1.7 运行小程序时，会以某种方式从完全不同的面板调用函数。我知道，这绝对没有意义，但事实就是如此。这是发生的事情：

用户加载应用程序并选择要使用的数据对象。此数据对象有两个面板，一个快速视图和一个详细视图。在详细视图中，用户可以更改对象资产值，但不能在快速视图中更改。如果他们尝试更改资产价值，则会出现“您确定吗？”的警报。因此，在快速查看时，他们将随机收到这些警报，以确保他们确实想要更改对象资产值，即使他们甚至不在屏幕上可能发生的事情。更糟糕的是，详细视图上的其他值会随机更改为零或空值，并且由于它们不需要确认，它会立即访问数据库。

请注意，我们公司有很多不同的 java 应用程序，只有一个有这个问题。我们要求我们的用户不要安装 java 1.7，但每隔一段时间就会有人这样做，这个应用程序就会中断。然后我们必须去删除 1.7，然后安装 1.6，一切都很好。

我试过调试这个，但在任何地方都找不到任何东西。另外，我不是该应用程序的作者，我只是负责寻找解决方案。任何帮助将不胜感激，甚至是关于在哪里查看或如何正确调试的一些想法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T17:23:58.483

> 请注意，我最近在小程序上做的不多。

小程序具有以下范围的方法：

```
{ init { start; stop } destroy } 
```

开始/停止范围涉及呈现的 HTML 页面。

我的猜测是，`init`发生了太多事情，或者`static`使用了字段。

你可以扩展旧的小程序，使用`init`一个空的`init`，并在`start`调用`super.init()`. 同样对于`stop`/ `destroy`。

`javap`例如可以看到静态字段。那么你确实需要重写，但是静态字段对于小程序来说是绝对不行的。

`appletviewer`可以从 JDK 的 bin 目录中测试小程序。