# StackOverflow 问答 15137000-15137999

# python - 显示奇怪的复杂相位

> ID：15137003
> 
> 赞同：0
> 
> 时间：2013-02-28T13:40:06.970
> 
> 标签：python, numpy, matplotlib

使用以下代码：

```
from numpy import *
from matplotlib.pyplot import *

Radius=10
N=1024
dx=2*Radius/N
dy=dx
x=r_[-Radius:Radius:dx]
y=r_[-Radius:Radius:dy]
X, Y = meshgrid(x,y)
R = sqrt(X**2+Y**2)
PHI = arctan2(Y,X)

ringthing = R < Radius
ring = zeros((2,N,N),dtype=complex)
ring[0] = ringthing
ring[1] = ringthing*exp(1j*PHI)

f=fig()
p1=f.add_subplot(121)
p1.imshow(angle(ring[0]))
p2=f.add_subplot(122)
p2.imshow(angle(ring[1]))

f.show() 
```

第二张图片的左下角没有明显的原因被染成红色（相位等于 pi）。为什么是这样？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T13:48:28.453

问题是圆外的值为零，并且零的复角没有很好地定义（它是一个奇点）。浮点运算的结果是，在某些部分它们评估为`0`，而在其他部分`-0`通过运行可以看到

```
from __future__ import division

from numpy import *

Radius=10
N=1024
dx=2*Radius/N
dy=dx
x=r_[-Radius:Radius:dx]
y=r_[-Radius:Radius:dy]
X, Y = meshgrid(x,y)
R = sqrt(X**2+Y**2)
PHI = arctan2(Y,X)

ringthing = R < Radius
ring = zeros((2,N,N),dtype=complex)
ring[0] = ringthing
ring[1] = ringthing*exp(1j*PHI)

print ring[1][-1, 0], angle(ring[1][-1, 0])
print ring[1][0, -1], angle(ring[1][0, -1]) 
```

与输出

```
(-0+0j) 3.14159265359
0j 0.0 
```

解决此问题的一种解决方案是将圆外的所有值显式设置为零。

# string - Lua 字符串模式 - 更短的代码

> ID：15137004
> 
> 赞同：3
> 
> 时间：2013-02-28T13:40:09.050
> 
> 标签：string, lua, pattern-matching

是否可以采取这个：

```
a=[[do end workspace.Part["Child 1"].Object.child2["thing"]remove() do end]]
a=a:gsub("%.%a+","{F}%0{F}")  
a=a:gsub('(%[%s*([\'"]?).*%2%s*%]):remove%(%)','{F}%1{F}:remove()')
a=a:gsub('{F}%s*{F}','')
a=a:gsub('{F}.-{F}','filterremove(%0)')

Output: do end filterremove(Workspace.Part["Child 1"].Object.child2["thing"]) do end 
```

并且只使用一个 gsub 来获得相同的结果，而不是两个？无论 xy、x[y]、[x][y] 等的组合如何。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T16:15:01.057

`a:gsub("(%S*%b[]):remove%(%)", "filterremove(%1)")`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T16:29:22.293

您至少可以链接和换行它：

```
a = [[do end workspace.Part["Child 1"]:remove() do end]]
a = a:gsub("%.%a+","{F}%0{F}")  
     :gsub('(%[%s*([\'"]?).*%2%s*%]):remove%(%)','{F}%1{F}:remove()')
     :gsub('{F}%s*{F}','')
     :gsub('{F}.-{F}','filterremove(%0)') 
```

但实际上，这永远不会奏效。关于什么：

```
workspace.remove(x)
workspace["remove"](x)
getfenv()["work" .. "space"]["re".."move"](x) 
```

# java - 创建一个“.bat”文件，运行它并从 Java 中删除它

> ID：15137006
> 
> 赞同：2
> 
> 时间：2013-02-28T13:40:14.863
> 
> 标签：java, multithreading, runtime.exec

我正在`.bat`动态地制作`Java`.

创建文件并执行后，我想删除它。

为了确保`delete()`在运行`.bat`文件后执行，我在不同的线程中删除了文件。

这是完成这项任务的好方法吗？您将如何以更好的方式实施它？

```
final File file = new File("run.bat");
file.createNewFile();
PrintWriter writer = new PrintWriter(file, "UTF-8");
writer.println(COMMAND1);
writer.println(COMMAND2);

.... ANOTHER COMMANDS

writer.close();
Runtime.getRuntime().exec("cmd /c start a.bat");

new Thread(new Runnable() {
    public void run() {
        file.delete();
    }
}).run(); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-28T13:45:18.143

我不会在不同的线程中删除文件，如果在您尝试删除文件时文件执行仍在运行怎么办？

我会考虑从文件中询问[退出代码](http://ss64.com/nt/exit.html)，或者使用 process.waitFor() 导致当前线程等待（如有必要），直到此 Process 对象表示的进程终止。

```
Process p = Runtime.getRuntime().exec("cmd /c start a.bat");
p.waitFor();
file.delete(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-28T13:45:38.027

试试这个，这会导致代码在删除文件之前等到批处理文件执行完成。

```
Process batchFileExecutionProcess = Runtime.getRuntime().exec("cmd /c start a.bat");
batchFileExecutionProcess.waitFor();
file.delete(); 
```

理想情况下，您还将在此解决方案中构建错误处理，例如从 waitFor() 方法中寻找 0 返回。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-28T13:46:33.870

不，这不是好方法。实际上，我没有看到额外线程的任何优势。它很可能会在文件仍在使用时尝试删除该文件，`cmd`并且删除将失败。相反，您应该使用`Process`object （的结果`exec()`）并等到它完成并删除文件然后：

```
Process p = Runtime.getRuntime().exec("cmd /c start a.bat");
p.waitFor();
file.delete() 
```

# c++ - printf %g 和 %f 之间的零填充差异

> ID：15137008
> 
> 赞同：3
> 
> 时间：2013-02-28T13:40:17.373
> 
> 标签：c++, printf

我想了解为什么零填充对于 printf 中的 %g 和 %f 格式的工作方式不同。这是一个示例程序：

```
#include <stdio.h>
int main()
{
  double d = 0.10000000000001;
  printf("%04.2f\n", d);
  printf("%04.2g\n", d);
  return 0;
} 
```

它输出

```
0.10
00.1 
```

这在 Windows 上的 VC++ 和 Linux 上的 gcc 中都可以重现。

为什么它会这样工作？这是正确的行为吗？

更新：我找到了答案，但我想我会留下这个问题......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-28T14:13:11.203

这是对的。根据`g`C99 7.19.6.1/8 中的样式规范：

> 除非使用 # 标志，否则从结果的小数部分**中删除任何尾随零，**如果没有剩余小数部分，则删除小数点字符

而样式`f`没有指定删除尾随零。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T14:13:51.620

使用 %g 时，printf 选择在最小位置提供最佳精度的格式。您可以猜测它是如何评估精度的，知道对于 d = 0.10500000，它会打印“00.1”，而对于 d = 0.10500001，它会打印“0.11”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-28T13:44:12.803

您可以通过 std::cout 对象上的同名成员函数来控制宽度和精度。

[来自http://en.cppreference.com/w/cpp/io/basic_ostream](http://en.cppreference.com/w/cpp/io/basic_ostream)的文档 精度管理浮点运算的小数精度（std::ios_base 的公共成员函数） width 管理字段宽度（std:: 的公共成员函数ios_base)

# mysql - 如何优化我的查询以更快地运行？

> ID：15137009
> 
> 赞同：0
> 
> 时间：2013-02-28T13:40:18.270
> 
> 标签：mysql, sql

用户表有

```
id, email, password, gender, dob 
```

等等。性别默认为空。我有另一张桌子`user_gender`，里面有`first_name`和`gender`。我的 sql 查询是`User`从`User_Gender`基于`first_name`. 用户表很大，大约有 300,000 多行。我正在运行下面提到的查询，但它花费了太多时间。如何优化此查询？-

```
select 
   count(*) 
from user u 
left outer join user_gender ug on ug.name = 
  case when locate(' ', u.name) > 0 then
     substring(u.name, 1,locate(' ', u.name))
  else
     u.name 
  end 
where 
  ug.gender != 'mf' and u.gender is null 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-28T13:48:52.053

**首先**，我建议彻底重组。300000 行开始达到“中等数据集”大小......

*   [正确规范化](http://en.wikipedia.org/wiki/Database_normalization)表格
    *   不要使用存储多个单独值的列 - 特别是 name 列是一个很好的例子。让它成为两列：first_name 和 last_name。
    *   DavidB 提到了性别分离。这完全是胡说八道。至少，每个人都有一个性别……不知道，它总是`NULL`……
*   使用（最好是数字！！）ID，而不是使用数据字段（特别是那些像名字的）
    *   这样，如果名称更改（可能发生 IRL），您只需更新一行...
    *   两个人甚至可能有完全一样的名字……

**其次**，在重组之后，您必须应用索引，并[检查查询的执行计划](http://dev.mysql.com/doc/refman/5.5/en/execution-plan-information.html)，以确保对其进行适当的优化。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-28T13:54:21.180

首先设计这两个表将帮助您更好地解决性能问题。性能问题出现在您的 join 子句上：

> 当 locate(' ', u.name)>0 then substring(u.name, 1,locate(' ', u.name)) else u.name end

为您的 User 表使用主键 (user_id) 并将其放在您的 user_gender 表上并相应地加入。

或者

由于您可能正在使用遗留数据库设计并且无法添加或使用 user_id 字段，您可以使用临时 first_name 字段并使用您的 join 子句填充它

```
update users u set u.first_name = case when locate(' ', u.name)>0 
then substring(u.name, 1,locate(' ',> u.name)) else u.name end 
```

在此之后，您可以将查询重写为

```
select count(*) from user u left outer join user_gender ug 
on ug.name=u.first_name 
where ug.gender != 'mf' and u.gender is null 
```

这将帮助您的查询运行得更快，但我会提出第一个解决方案，无论如何添加/使用主键。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-28T14:16:38.787

我注意到的第一件事是查询没有正确编写。或者，至少，它没有按照您的意愿行事。`!=`in子句是“`where`撤消”左外连接。我想你想在`on`条款中这样做。

有一个索引`user_gender(firstname, gender)`，我认为这个版本应该运行得很快：

```
select count(*) 
from (select u.*,
             (case when locate(' ', u.name) > 0 then substring(u.name, 1,locate(' ', u.name))
                   else u.name
              end) as FirstName
      from user u
     ) u
where not exists (select 1 from user_gender ug where ug.name = u.FirstName and ug.gender <> 'mf') 
```

它应该可以用户表，计算名字，并检查索引以查看是否有性别。

# php - 如何从 Magento 中的任何现有日期中删除年份

> ID：15137011
> 
> 赞同：0
> 
> 时间：2013-02-28T13:40:20.447
> 
> 标签：php, magento, cakephp, magento-1.7, cakephp-2.1

PHP 核心日期 0000-06-22 不能在 Magento 和 CakePHP 中添加为日期

它接受日期大于 1971

所以我想将年份替换为“1971”

如何 ？有什么解决办法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T14:33:12.007

```
str_replace('0000', '1971', '0000-06-22'); 
```

# c# - HTMLAgility：用一个新元素替换两个节点

> ID：15137016
> 
> 赞同：0
> 
> 时间：2013-02-28T13:40:47.413
> 
> 标签：c#, asp.net, html-agility-pack

我正在循环一个节点集合。我必须用新元素替换当前节点和当前节点的兄弟节点。

我为此编写了以下代码：

```
private void modifyNodes(IEnumerable<HtmlNode> selectedNodes)
{
            foreach (var node in selectedNodes)
            {           

                node.NextSibling.SetAttributeValue("style", "font-weight:bold;padding:2px 2px;");             
                node.SetAttributeValue("style", "float:right;");                

                var parentNode = node.ParentNode;

                var doc = new HtmlDocument();
                var newElement = doc.CreateElement("table");
                newElement.SetAttributeValue("style", "background-color:#e4ecf8;width:100%");
                var sectionRow = doc.CreateElement("tr");
                var headerColumn = doc.CreateElement("td");
                headerColumn.AppendChild(node.NextSibling);
                var weightColumn = doc.CreateElement("td");
                weightColumn.AppendChild(node);
                sectionRow.AppendChild(headerColumn);
                sectionRow.AppendChild(weightColumn);
                newElement.AppendChild(sectionRow);

                element.ParentNode.RemoveChild(node);
                parentNode.ReplaceChild(newElement, node.NextSibling);

            }
} 
```

这是添加新元素并删除传递的节点。但它无法删除节点的下一个兄弟节点。我在这里做错了什么。

请帮忙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T12:04:28.953

正如您所说，添加了新元素，您被*明确*替换`node.NextSibling`为。`newElement`问题可能出在下一个兄弟的类型上。最有可能的是，这是一个文本节点（通常是那些`\r\n`划分 HTML 节点的节点）。

所以看起来，你的新节点只是替换了文本节点，结果有点出乎意料。因此，如果这确实是一个问题，您可以采取如下解决方法：

```
// next sibling
var next = node.NextSibling;
// get the first non-text node
while (next != null && next is HtmlTextNode)
    next = next.NextSibling;

var newNode = doc.CreateElement(...);
// replace the current node with the new one
current.ParentNode.ReplaceChild(newNode, current);
// remove the next node if it was found
if (next != null)
    next.Remove(); 
```

# opengl - 在 OpenGL 中使用栅栏同步对象

> ID：15137020
> 
> 赞同：8
> 
> 时间：2013-02-28T13:40:57.917
> 
> 标签：opengl, synchronization, opengl-3

我正在尝试寻找可以在 OpenGL 中使用同步对象的场景。我的理解是，一旦将同步对象放入 GL 命令流（使用 glFenceSync() ），将在执行并实现所有 GL 命令后发出信号。如果同步对象是同步原语，为什么我们不能手动向它们发出信号？这个功能究竟在哪里可以帮助 GL 程序员？

以下情况是否正确？

```
Thread 1 :

Load model
Draw()
glFenceSync()

Thread 2 :

glWaitSync();
ReadPixels
Use data for subsequent operation. 
```

这是否意味着除非在线程 1 中调用 glFenceSync()，否则我无法启动线程 2？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-28T14:26:08.560

栅栏不是为了同步线程，而是为了知道异步操作何时完成。例如，如果您对`glReadPixels`像素缓冲区对象 (PBO) 执行操作，您可能想知道读取已完成，甚至在您尝试从 PBO 读取或映射到客户端地址空间之前。

如果您`glReadPixels`以 PBO 为目标进行操作，则调用将立即返回，但数据传输确实可能需要一些时间。这就是栅栏派上用场的地方。

# php - 选择高于 NOW() 的值

> ID：15137024
> 
> 赞同：0
> 
> 时间：2013-02-28T13:41:02.603
> 
> 标签：php, mysql

我有一个约会表，我想向用户显示他所做的所有约会都高于当前日期，以便他可以取消它们......我有这个查询......

```
$result = mysql_query("SELECT id,date,start,end FROM jos_jxtc_appbook_appointments WHERE userident='$idusera' AND CONCAT(date,' ',start)>NOW()");
while($row = mysql_fetch_assoc($result))
{

echo '<div class="record" id="record-',$row['id'],'">
    <a href="?delete=',$row['id'],'" class="delete">Delete</a>
    <strong>',$row['date'], $row['start'], $row['end'],'</strong>
  </div>';

} 
```

并且这仍然显示日期低于当前日期......可能是时区错误或类似的东西？

这是我的桌子...

```
 date     duration    start     end
2013-02-28  01:00:00  12:00:00  13:00:00
2013-02-28  01:00:00  03:00:00  04:00:00
2013-02-27  01:00:00  21:00:00  22:00:00
2013-02-27  01:00:00  20:00:00  21:00:00
2013-02-28  01:00:00  20:00:00  21:00:00
2013-02-28  01:00:00  01:00:00  02:00:00
2013-02-28  01:00:00  09:00:00  10:00:00
2013-02-28  01:00:00  02:00:00  03:00:00
2013-03-01  01:00:00  00:00:00  01:00:00
2013-02-28  01:00:00  21:00:00  22:00:00
2013-02-28  01:00:00  22:00:00  23:00:00
2013-03-01  01:00:00  02:00:00  03:00:00 
```

我从我的回声中得到这个......

```
Delete 2013-02-28  12:00:00  13:00:00
Delete 2013-02-28  20:00:00  21:00:00
Delete 2013-03-01  00:00:00  01:00:00
Delete 2013-02-28  21:00:00  22:00:00
Delete 2013-02-28  22:00:00  23:00:00
Delete 2013-03-01  02:00:00  03:00:00 
```

因此，如果当前时间是现在的 2013-02-28 15:25:00，则不应显示低于 2013-02-28 12:00:00 13:00:00 的日期。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T14:35:16.280

您需要 STR_TO_DATE() 函数将字符串转换为有效的日期值。

```
$result = mysql_query("SELECT id,date,start,end FROM jos_jxtc_appbook_appointments WHERE userident='$idusera' AND STR_TO_DATE(CONCAT(date,' ',start))>NOW()"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T14:28:10.823

我假设`date`是一个`Date`类型，两者`start`都是`end`类型`Char`列。您应该为您的和列使用一个`DateTime`类型，这样您就不需要做任何连接。现在你可以做。`start``end``start > NOW()`

# asp.net - 访问嵌套中继器的数据源

> ID：15137029
> 
> 赞同：1
> 
> 时间：2013-02-28T13:41:24.977
> 
> 标签：asp.net, vb.net, repeater

我有一个中继器：

`<asp:Repeater ID="rptSessions" runat="server">`

在这里面我有另一个中继器：

```
<asp:Repeater ID="rptPeople" runat="server" OnItemDataBound="rptPeople_ItemDataBound"> 
```

在我的父转发器上的 ItemDataBound 上，我正在为子转发器设置数据源。

```
 Dim dtPeople As New DataTable
  dtPeople.Columns.Add("FirstName")
  dtPeople.Columns.Add("LastName")
  dtPeople.Columns.Add("Company")
  If e.Item.DataItem("Lunch") = True Then dtPeople.Columns.Add("Dietary") <-- ***
  rptPeople.DataSource = dtPeople
  rptPeople.DataBind() 
```

现在考虑我的孩子中继器的 html

```
<asp:Repeater ID="rptPeople" runat="server" OnItemDataBound="rptPeople_ItemDataBound">
  <HeaderTemplate>
    <table>
      <tr>
        <th>First Name</th>
        <th>Last Name</th>
        <th>Company</th>
        <asp:Literal ID="litDietaryRequirements" runat="server"><th>Dietary Requirements</th></asp:Literal>
      </tr>
  </HeaderTemplate>
  ..... 
```

在我的子中继器的 ItemDataBound 上，我想根据列是否`Dietary`存在于它的数据源中来隐藏 litDietaryRequirements。我尝试了以下方法：

```
If e.Item.ItemType = ListItemType.Header Then
  DirectCast(e.Item.FindControl("litDietaryRequirements"), Literal).Visible = DirectCast(e.Item.DataItem, DataRowView).Row.Table.Columns.Contains("Lunch")
End If 
```

e.Item.DataItem 似乎什么都没有

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T17:26:20.080

最后我这样做了：

```
If e.Item.ItemType = ListItemType.Header Then
   Dim LunchRequired As Boolean = DirectCast(DirectCast(e.Item.NamingContainer.NamingContainer, RepeaterItem).DataItem, DataRowView).Row.Item("Lunch")
   DirectCast(e.Item.FindControl("litDietaryRequirements"), Literal).Visible = LunchRequired
End If 
```

# c++ - Typedef 和函数声明不能 一起工作

> ID：15137030
> 
> 赞同：0
> 
> 时间：2013-02-28T13:41:28.600
> 
> 标签：c++, typedef

我正在调整一些GDAL代码，并且正在使用这样的typedef

```
typedef CPLErr (*MYWriter)( double dfLevel, int nPoints, double *padfX, double *padfY, void * ); 
```

在这样的课程中使用

```
class GDALGenerator
{
...blah...
public:
    MYWriter pfnWriter;
    GDALGenerator( int nWidth, int nHeight, MYWriter pfnWriter, void *pWriterCBData );
...blah...
}; 
```

但是在同一个文件中，当我像这样创建函数时，在 GDALGenerator 类下面

```
CPLErr MYWriter( double dfLevel, int nPoints, double *padfX, double *padfY, void *pInfo )
{} 
```

我收到这个错误

> 错误 2 错误 C2365：'MYWriter'：重新定义；以前的定义是 'typedef' f:\projects\map\somecpp\somecpp.cpp 1330 MyProjectName

我很困惑，因为一个标准的 GDAL 函数就是这样使用的，而且它工作正常（在这种情况下，该类位于一个单独的 DLL 中）。我只是用不同的名称复制了该函数，但它不起作用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-28T13:46:10.477

您不能将类型名称用作函数名称，只能用作变量的类型。

我希望这说明清楚：

```
CPLErr f( double dfLevel, int nPoints, double *padfX, double *padfY, void *pInfo )
{}
MYWriter foo = f; 
```

``

# android - 旋转设备时 MediaPlayer 服务出错

> ID：15137031
> 
> 赞同：0
> 
> 时间：2013-02-28T13:41:38.033
> 
> 标签：android, android-videoview, android-video-player

任何建议制作一个在旋转设备时保留缓冲区状态的 VideoPlayer（用于 HLS 流）？我总是在后台提供服务并在旋转设备时处理表面连接，但不起作用。我丢失了视频（音频仍在工作）并收到错误： E/MediaPlayer(28347): error (1, -2147483648) videoView 位于带有 setRetainInstance(true) 的片段中；启用

任何想法？这个想法可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T13:51:05.433

应用程序在旋转检查方法（如 onStop onResume）上新创建，在旋转的情况下会被调用。

注意不要两次启动该服务

[旋转Android上的活动重启](https://stackoverflow.com/questions/456211/activity-restart-on-rotation-android)

# php - 从数据库中获取 ID 计数并生成新闻动态链接

> ID：15137035
> 
> 赞同：1
> 
> 时间：2013-02-28T13:41:47.113
> 
> 标签：php, mysql, sql, dynamic

昨天我问了这个问题：[https:](https://stackoverflow.com/questions/15117767/add-dynamic-content-to-otherwise-static-php-page) //stackoverflow.com/questions/15117767/add-dynamic-content-to-otherwise-static-php-page 对于这个不太准确的问题，我很抱歉。我现在自己完成了很多，但我还有一些问题。

我设法将我的新闻放入包含以下列的数据库表中：“id”、“news_headline”、“news_date”、“news_teaser”、“news_content”、“news_external_link”

在我的 news/index.php 我现在有以下代码：

```
<?php
     $con=mysqli_connect("localhost", "XXX", "oizQvdjh", "usr_web3_1");
     // Check connection
     if (mysqli_connect_errno())
     {
           echo "Failed to connect to MySQL: " . mysqli_connect_error();
     }
     $result = mysqli_query($con,"SELECT * FROM tbl_news ORDER BY id DESC");

     while($row = mysqli_fetch_array($result))
     {
       echo "<li class='clearfix'>";
       echo "<a class='news_pic'><img src='/assets/images/news/news_".$row['id']
                  ."_thumb.jpg'></a>";
       echo "<h2 class='info_headline'>" . $row['news_headline'] . "</h2>";
       echo "<p class='date'>" . $row['news_date'] 
                  . " &ndash; <a href='#disqus_thread'></a></p>";
       echo "<p class='news_text'>" . $row['news_teaser'] 
                  . "<br><a class='more-link' href='WHERE_TO'>Read more</a></p>";
       echo "</li>";
     }

     mysqli_close($con);
?> 
```

那里的一切看起来都很棒，它从数据库中获取了我所有的新闻（到目前为止有五个），并获取了我自己上传到服务器上的图像，并根据 id 命名。

单个新闻端具有相同的代码，只是它具有“WHERE”语句并获取内容文本而不是预告片：

```
$result = mysqli_query($con,"SELECT * FROM tbl_news WHERE id='1' ORDER BY id DESC");

while($row = mysqli_fetch_array($result))
{
   echo "<h2>" . $row['news_headline'] . "</h2>";
   echo "<p class='date'>" . $row['news_date'] 
         . " &ndash; <a href='#disqus_thread'></a></p>";
   echo "<a class='news_pic'><img src='/assets/images/news/news_".$row['id']."
         .jpg'></a>";
   echo "<p class='news_text'>" . $row['news_content'] . "</p>";
}

mysqli_close($con);

?> 
```

现在我的问题。我如何必须保存单个新闻的文件才能动态更新它。在我的索引中，href 显示“WHERE TO”，我想要一个类似的链接`<a href="<?php echo $row['news_date'] + slug`（我会在我的表中添加一个列 slug）。

然后应该生成新闻单 php，并且还应该在 URL 中显示日期和 slug。就像 XXX/news/2013-02-18_this-is-a-news-site.php 一样，我知道为此我还必须在 WHERE 命令中添加一个变量：而不是`WHERE id=1`--> id="GET AUTOMATICALLY"。我也不知道在这里放什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T13:49:39.050

顺便说一句，你的问题不是很清楚：

您需要启用 mod_rewrite 并选择适当的重写规则。

像这样创建一个 .htaccess 文件：

```
RewriteEngine On
RewriteBase / 
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)\?*$ index.php?path=$1 [L,QSA] 
```

像这样的网址

```
http://your.site.com/news/2012/10/22 
```

将转换为

```
http://your.site.com/index.php?path=/news/2012/10/22 
```

从查询字符串中获取“路径”并创建您的查询。确保正确清理输入。

2012/10/22 几乎是 mysql 的有效日期：只需将 '/' 替换为 '-' 即可。

```
$dt=str_replace('/','-',substr($path,6)); 
```

确保它是一个有效的日期：

```
$dt=date('Y-m-d',strtotime($dt)); 
```

现在您的查询可能是

```
$query="SELECT * FROM tbl_news WHERE news_date='$dt'"; 
```

此查询将为您提供特定日期的所有新闻。

# algorithm - 为 O(1) 中的基本操作设计一个范围为 1 到 1000（不重复）的整数的数据结构

> ID：15137043
> 
> 赞同：-2
> 
> 时间：2013-02-28T13:42:09.330
> 
> 标签：algorithm, data-structures

**为以下操作设计一个范围为 1 到 1000（不重复）的整数的数据结构。** 1）插入

2）删除

3)搜索

**4)int Anyvalid() -> 这应该返回当时存在的任何有效/当前数字。** 例如，如果存在 1、5、7，则返回 3 个数字中的任何一个。

所有操作都应该是 0(1)/常数时间。

我想到了位向量，但在 AnyvalidElement() 的情况下它给出 0(n) .. 其余的它在 0(1) 中工作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-28T14:13:21.323

Use a doubly linked list and an array of pointers to the list nodes.

*   Insert n: Add n to the front of the list, array[n] = pointer to newly added node.
*   Delete n: Use array to jump to the correct node in the list and remove it. Set array[n] = NULL;
*   Search n: check if array[n] != NULL
*   AnyValid: return front of the list

# report - pentaho 中的报告、临时报告和仪表板

> ID：15137044
> 
> 赞同：0
> 
> 时间：2013-02-28T13:42:09.550
> 
> 标签：report, scheduled-tasks, pentaho, dashboard, saiku

我目前正在开展一个实施 BI 解决方案的项目。我选择了 Pentaho

有很多工具可以创建：

报告（**报告设计者**）

临时报告（**WAHQR**或 PIR）

仪表板（仪表板设计器或**CDE**）

分析（分析器或**saiku**）

（我将使用大的）

问题是，最终用户（非技术人员）使用哪种工具，技术人员/开发人员使用哪种工具？

这些工具中的哪一个创建了可以使用调度程序重复执行的报告/仪表板/仅按需执行一次？

谢谢你的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T06:13:57.743

开发商： 全部

用户：赛库

Pentaho Report Dssigner 生成的报告可以由调度程序执行。这也可以由调度程序使用厨房使用 Pentaho 报告输出步骤执行。

# php - 第 1 步中的 Html/PHP 文件上传器，但在最后一步中上传

> ID：15137052
> 
> 赞同：0
> 
> 时间：2013-02-28T13:42:38.013
> 
> 标签：php, html, file-upload

所以基本上我有一个带有 X 步的多步表单。在第一步中，我向用户提供了一个文件上传表单。这就像一个普通的 HTML 文件上传器：

*   用户选择文件
*   文件框，显示路径名

如果用户单击“下一步”，则不应上传文件。如果用户到达表单的最后一步，他/她在步骤 1 中选择的文件现在应该上传。

我不知道这是否真的可能。还有几个问题

*   input type="file" 的值给出了类似 C:\fakepath\filename.ext
*   将上述内容保存在会话中以供以后上传是没有意义的。

如何让上传器在最后一步工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T13:53:48.153

是的，这实际上是可能的，而且在页面之间保存数据是有意义的，否则，你怎么能记住他在文件输入中设置的内容？

如果它是一个简单的 HTML 页面，我假设您使用的是 PHP。在临时变量或会话中注册文件，如果您不使用会话，请将其放入 HTML 代码中的隐藏输入中。

在最后一步，设置您的文件并上传。

祝你好运。

# windows-store-apps - 为什么 Canvas::GetLeft 总是返回 0？

> ID：15137053
> 
> 赞同：0
> 
> 时间：2013-02-28T13:42:40.993
> 
> 标签：windows-store-apps, winrt-xaml, c++-cx

```
<Canvas Background="Black">
        <Rectangle Fill="Salmon" Name="selBox" Width="100" Height="100" Margin="657,175" />
        <Button x:Name="btnAnimate" Content="Animate" HorizontalAlignment="Left" Margin="721,422,0,0" VerticalAlignment="Top" Click="btnAnimate_Click" />
</Canvas> 
```

是我的 XAML。我在 MainPage.xaml.cpp 文件中写过

```
void App1::MainPage::btnAnimate_Click(Platform::Object^ sender, Windows::UI::Xaml::RoutedEventArgs^ e)
{
    auto x = Canvas::GetLeft(selBox);   
} 
```

当我调试应用程序时，我总是得到`0.00`x。为什么这样？还是有一些关于父母的翻译？我也尝试命名 Canvas`myCanvas`并做了`myCanvas->GetLeft(selBox);`，但我仍然得到相同的结果。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T13:54:43.600

你有你写的：你没有设置`Canvas.Left`你`Rectangle`的，默认为0。边距影响最终布局，但不影响 Canvas.Left 或 Right 或任何其他两个。

# twitter-bootstrap - bootstrap 固定导航栏在放大时覆盖整个屏幕

> ID：15137054
> 
> 赞同：0
> 
> 时间：2013-02-28T13:42:44.793
> 
> 标签：twitter-bootstrap, fixed, navbar

有点傻但有点担心的问题。我将导航栏固定在顶部，里面有一些元素。问题是，如果我以高百分比放大，导航栏中的元素会重新组合，以便导航栏覆盖整个屏幕。如果顶部栏不会保持固定而使整个页面无用，那将是可以的。达到某个缩放级别后，有没有办法“解开”它？（是的，我是 CSS 菜鸟）。这是导航栏的标记：

```
<div class="navbar navbar-inverse navbar-fixed-top">
    <div class="navbar-inner">
        <div class="container-fluid">
            <a class="brand" href="{% url home %}">Pavel Nováček</a>
            <ul class="nav">
                {% load tag_library %}
                {% set_current_urlname %}
                <li><a href="{% url home %}" class=""><img src="/static/web/img/cz.png"></a></li>
                <li><a href="{% url home %}" class="" style="padding-left: 0px"><img src="/static/web/img/gb.png"></a></li>

                <li class="{% if current_urlname == 'home' %}active{% endif %}">
                <a href="{% url home %}"><strong>Home</strong></a>
                </li>
                <li class="{% if current_urlname == 'about-me' %}active{% endif %}">
                <a href="{% url about-me %}"><strong>About me</strong></a>
                </li>
                <li class="{% if current_urlname == 'books' %}active{% endif %}">
                <a href="{% url books %}"><strong>Books</strong></a>
                </li>
                <li class="{% if current_urlname == 'presentations' %}active{% endif %}">
                <a href="{% url presentations %}"><strong>Presentations</strong></a>
                </li>
                <li class="{% if current_urlname == 'links' %}active{% endif %}">
                <a href="{% url links %}"><strong>Links</strong></a>
                </li>
                <li class="{% if current_urlname == 'contact' %}active{% endif %}">
                <a href="{% url contact %}"><strong>Contact</strong></a>
                </li>
            </ul>

        </div>
    </div>
</div> 
```

编辑：它似乎是容器流体的“一个特征”。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T13:56:31.763

在文档的头部将元视口设置为对移动设备友好。

```
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"> 
```

然后使用媒体查询，例如

> @media all and (max-width: 699px) {
> 
> > .navbar {
> > 
> > > 显示：无；
> > 
> > }
> 
> }

我会处理一些问题，但您可能最好解开导航并用移动友好的导航替换。

# sed - 将某些匹配项转换为大写的 Sed 表达式

> ID：15137059
> 
> 赞同：4
> 
> 时间：2013-02-28T13:42:52.280
> 
> 标签：sed

此 sed 表达式将输入字符串转换为两行输出字符串。两条输出线中的每一条都由来自输入的子字符串组成。第一行需要转换为大写：

```
s:random_stuff\(choice1\|choice2\){\([^}]*\)}:\U\1\n\2: 
```

目的是转换

```
random_stuff_choice1{This is a sentence that MAY contain AnyThing}
random_stuff_choice2{This is another similar sentence} 
```

进入

```
CHOICE1
This is a sentence that MAY contain AnyThing
CHOICE2
This is another similar sentence 
```

我遇到的问题是 \U 适用于它后面的所有内容，因此第二行也是大写的。是否可以使 \U 仅适用于第一场比赛？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-28T13:44:10.843

用于`\E`取消`\U`：

```
s:random_stuff_\(choice1\|choice2\){\([^}]*\)}:\U\1\E\n\2: 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-28T13:54:19.063

与`sed`：

```
$ sed 's/.*\(choice[0-9]\+\){\([^}]*\)}/\U\1\n\E\2/' file
CHOICE1
This is a sentence that MAY contain AnyThing
CHOICE2
This is another similar sentence 
```

与`awk`：

```
$ awk -F'{|}' 'gsub(/.*_/,""){print toupper($1)"\n"$2}' file
CHOICE1
This is a sentence that MAY contain AnyThing
CHOICE2
This is another similar sentence 
```

# scala - 从案例类播放表格

> ID：15137062
> 
> 赞同：0
> 
> 时间：2013-02-28T13:43:02.207
> 
> 标签：scala, playframework-2.0

我是 playframework 的新手。我有我的用户模型以及静态方法的随附对象......

```
case class User(id: Int, username: String, password: String, fullname: String, /
     lastLogin : Date, updatedOn: Date, updatedBy: Int, createdOn: Date, createdBy: Int) 
```

我想为这个类创建一个省略一些细节的表单。目前我有一个 UserForm 案例类

```
case class UserForm(fullName:String, username: String, password:String, confirm:String) 
```

允许我使用：

```
val userForm = Form(
    mapping(
        "fullName" -> of[String],
        "username" -> of[String],
        "password" -> of[String],
        "confirm" -> of[String]
    )(UserForm.apply)(UserForm.unapply)
) 
```

这感觉有点`Hacker-ish`。有没有一种惯用的和更简洁的方法来做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-28T18:42:30.833

怎么样

```
val userForm = Form(
  mapping(
      "fullName" -> text,
      "username" -> text,
      "password" -> text,
      "confirm" -> text
  )(UserForm.apply)(UserForm.unapply)
) 
```

还有更多内置的检查和验证。此处列出了基础知识：[http ://www.playframework.com/documentation/2.1.0/ScalaForms](http://www.playframework.com/documentation/2.1.0/ScalaForms)

如果您在对象中不需要它们，则可以使用元组

```
val userForm = Form(
  tuple(
      "fullName" -> text,
      "username" -> text,
      "password" -> text,
      "confirm" -> text
  )
) 
```

在您的情况下，您的元组具有以下类型：`(String, String, String, String)`您可以像这样使用它：`val (fullName, username, password, confirm) = refToTuple`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-10-11T19:37:55.557

迟到了，但我刚刚发布了一个实用程序来帮助解决这个问题！使用您的类，您的代码将如下所示：

```
case class User(id: Int, username: String, password: String, fullname: String, lastLogin : Date, updatedOn: Date, updatedBy: Int, createdOn: Date, createdBy: Int)
object User { implicit val mapping = CaseClassMapping.mapping[User] }

val userForm = Form(implicitly[Mapping[User]]) 
```

您可以在 github 上找到将其包含在项目中的源代码和说明：[https ://github.com/Iterable/iterable-play-utils](https://github.com/Iterable/iterable-play-utils)

# maven - 无法通过命令行从 TestNG 运行 Maven 项目......！

> ID：15137064
> 
> 赞同：0
> 
> 时间：2013-02-28T13:43:14.813
> 
> 标签：maven, testng

我已经用maven和testNG配置了我的eclipse，PF我的pom.xml如下：

```
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
    <modelVersion>4.0.0</modelVersion>
    <parent>
        <artifactId>iONAutomation</artifactId>
        <groupId>com.iON.tcs</groupId>
        <version>0.0.1-SNAPSHOT</version>
    </parent>
    <groupId>com.iON.tcs</groupId>
    <artifactId>common</artifactId>
    <version>0.0.1-SNAPSHOT</version>
    <name>common</name>
    <description>maintains all common code</description>
    <profiles>
        <profile>
            <id>selenium-tests</id>
            <build>
                <plugins>
                    <plugin>
                        <groupId>org.apache.maven.plugins</groupId>
                        <artifactId>maven-surefire-plugin</artifactId>
                        <version>2.12.4</version>
                        <configuration>
                            <suiteXmlFiles>
                                <suiteXmlFile>src/test/resources/testng.xml</suiteXmlFile>
                            </suiteXmlFiles>
                        </configuration>
                    </plugin>
                </plugins>
            </build>
        </profile>
    </profiles>
    <dependencies>
        <dependency>
            <groupId>org.testng</groupId>
            <artifactId>testng</artifactId>
            <version>6.3.1</version>
            <scope>test</scope>
        </dependency>
    </dependencies>

</project> 
```

我从 cmd 提示符运行此目录：D:\EclipseWorkspace\iON27Feb2013\iONAutomation\common> 我尝试使用 mvn test 和 mvn -Dtest=NewTest 测试命令，但没有成功。

我的 cmd 控制台显示：

```
D:\EclipseWorkspace\iON27Feb2013\iONAutomation\common>mvn test
[INFO] Scanning for projects...
[INFO]
[INFO] ------------------------------------------------------------------------
[INFO] Building common 0.0.1-SNAPSHOT
[INFO] ------------------------------------------------------------------------
[INFO]
[INFO] --- maven-resources-plugin:2.5:resources (default-resources) @ common ---

[debug] execute contextualize
[WARNING] Using platform encoding (Cp1252 actually) to copy filtered resources,
i.e. build is platform dependent!
[INFO] Copying 0 resource
[INFO]
[INFO] --- maven-compiler-plugin:2.3.2:compile (default-compile) @ common ---
[INFO] Nothing to compile - all classes are up to date
[INFO]
[INFO] --- maven-resources-plugin:2.5:testResources (default-testResources) @ co
mmon ---
[debug] execute contextualize
[WARNING] Using platform encoding (Cp1252 actually) to copy filtered resources,
i.e. build is platform dependent!
[INFO] Copying 0 resource
[INFO]
[INFO] --- maven-compiler-plugin:2.3.2:testCompile (default-testCompile) @ commo
n ---
[INFO] Nothing to compile - all classes are up to date
[INFO]
[INFO] --- maven-surefire-plugin:2.10:test (default-test) @ common ---
[INFO] Surefire report directory: D:\EclipseWorkspace\iON27Feb2013\iONAutomation
\common\target\surefire-reports

-------------------------------------------------------
 T E S T S
-------------------------------------------------------

Results :

Tests run: 0, Failures: 0, Errors: 0, Skipped: 0

[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time: 0.932s
[INFO] Finished at: Thu Feb 28 19:11:43 IST 2013
[INFO] Final Memory: 4M/15M
[INFO] ------------------------------------------------------------------------ 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T17:38:59.847

如果您定义了配置文件，那么 afaik，您需要调用该配置文件 ...mvn test -Pselenium-tests。因此，如果您没有特别的理由使用配置文件，那么您可能会不使用它们，在这种情况下 mvn test 应该可以正常工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-09-23T08:33:20.790

你试过把

```
<sourceDirectory>/home/{userName}/{projectLocation}/src/main/java/packageTest</sourceDirectory> 
```

在你的建筑里面？我有同样的问题，这条线解决了它。

你也可以尝试在你的 pom 文件中添加一个目标

```
<execution>
         <id>default-test</id>
         <phase>test</phase>``
            <goals>
              <goal>test</goal>
            </goals>
         <configuration>
         <skip>false</skip>
      </configuration>
 </execution> 
```

希望它会帮助你！

# sql - SQL 交叉应用

> ID：15137068
> 
> 赞同：1
> 
> 时间：2013-02-28T13:43:29.680
> 
> 标签：sql, tsql, cross-apply

我有一个包含审计信息的 SQL 表：

```
GroupId AuditDate   ID  FirstName   LastName
1      01/06/2011   123 Michael    Jackson
1      01/09/2010   123 M          J
1      01/06/2009   123 Mike       J 
```

并尝试显示审计记录之间的差异：

```
GroupId AuditDate   ID  Attribute   From    To
1      01/06/2011   123 FirstName   M       Michael
1      01/06/2011   123 LastName    J       Jackson
1      01/09/2010   123 FirstName   Mike    M
1      01/06/2009   123 FirstName   NULL    Mike
1      01/06/2009   123 LastName    NULL    J 
```

我正在使用以下 SQL 查询：

```
WITH result AS (
SELECT          [Current].Id, 
                [Current].GroupId, 
                [Current].AuditDate, 
                [Current].FirstName, 
                [Current].LastName
                Previous.FirstName AS PFirstName,
                Previous.LastName AS PLastName,
FROM 
    (SELECT 
        *, ROW_NUMBER() OVER(PARTITION BY GroupId ORDER BY AuditDate ASC) AS RowNumber 
    FROM 
        AuditTable  
    WHERE 
        Id = @ID
    ) AS [Current]
LEFT JOIN
    (SELECT 
        *, ROW_NUMBER() OVER(PARTITION BY GroupId ORDER BY AuditDate ASC) AS RowNumber 
    FROM 
        AuditTable
    WHERE 
        Id = @ID
    ) AS [Previous]
ON
    [Current].RowNumber = [Previous].RowNumber + 1
)

SELECT r.Id,r.GroupId, r.AuditDate 
  x.Attribute,
  x.[From],
  x.[To]
FROM result r
CROSS APPLY 
(
    VALUES
        ('FirstName', t.FirstName, t.PFirstName),
        ('LastName', t.LastName, t.PLastName),
) x (Attribute, [To], [From])
where 
    ISNULL(x.[From],'') <> ISNULL(x.[To],'') 
ORDER BY r.AuditDate asc; 
```

是否可以合并两个选择查询以提高性能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T14:01:07.457

您可以使用以下方法完全消除这两个子查询`lag()`：

```
WITH result AS (
SELECT Id, 
       GroupId, 
       AuditDate, 
       FirstName, 
       LastName,
       lag(FirstName) over (PARTITION BY GroupId ORDER BY AuditDate ASC) 
          AS PFirstName,
       lag(LastName) over (PARTITION BY GroupId ORDER BY AuditDate ASC)
          AS PLastName
    FROM AuditTable  
    WHERE Id = @ID
)
... 
```

[这是相关文档](http://msdn.microsoft.com/en-us/library/hh231256.aspx)。

**更新：**但是，不幸的是，这仅在 SQL Server 2012 中可用。如果您有较早的版本，您将需要某种自我加入。

如果你不能使用`lag()`，你至少应该能够将你的代码从 3 个查询减少到 2 个：在你的第一个`select`语句中包含行号，并留下一个子查询，而不是有两个子查询。我不确定这种方式或 Chris Moutray 的方式是否会更快。

```
WITH result AS (
SELECT ROW_NUMBER() OVER(PARTITION BY GroupId ORDER BY AuditDate ASC) AS RowNumber         
       [Current].Id, 
       [Current].GroupId, 
       [Current].AuditDate, 
       [Current].FirstName, 
       [Current].LastName
       [Previous].FirstName AS PFirstName,
       [Previous].LastName AS PLastName,
FROM AuditTable as [Current]
LEFT JOIN
    (SELECT 
        *, ROW_NUMBER() OVER(PARTITION BY GroupId ORDER BY AuditDate ASC) AS RowNumber 
    FROM 
        AuditTable
    WHERE 
        Id = @ID
    ) AS [Previous]
ON
    [Current].RowNumber = [Previous].RowNumber + 1
) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T14:12:43.473

试试这个查询

```
WITH result AS (
SELECT Id, 
       GroupId, 
       AuditDate, 
       FirstName, 
       LastName,          
       ROW_NUMBER() OVER(PARTITION BY GroupId ORDER BY AuditDate ASC) AS RowNumber 
FROM AuditTable  
WHERE Id = @ID
 )
SELECT r.Id,r.GroupId, r.AuditDate,
       x.Attribute,
       x.[From],
       x.[To]
FROM result r LEFT JOIN result r2 ON r.RowNumber = r2.RowNumber + 1
CROSS APPLY (
             VALUES ('FirstName', r.FirstName, r2.FirstName),
                    ('LastName', r.LastName, r2.LastName)
             ) x (Attribute, [To], [From])
WHERE ISNULL(x.[From],'') <> ISNULL(x.[To],'') 
ORDER BY r.AuditDate ASC; 
```

[**SQLFiddle**](http://sqlfiddle.com/#!3/472cf/2)上的演示[](http://sqlfiddle.com/#!3/472cf/2)

 *** * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-28T14:17:43.400

您可以在 SQL Server 2012 中使用 LAG。我在这里使用 UNION ALL 将列取消透视为行。

根据您的过滤方式和组级别，添加/修改 PARTITION BY

```
DECLARE @foo TABLE (GroupId tinyint, AuditDate date, ID tinyint, FirstName varchar(100),  LastName varchar(100));
INSERT @foo VALUES (1, '20110601', 123, 'Michael', 'Jackson'), (1, '20100901', 123, 'M', 'J'), (1, '20090601', 123, 'Mike', 'J');

SELECT
    X.GroupId, X.AuditDate, X.ID, X.[From], X.[To]
FROM
    (
    SELECT
        F.GroupId, F.AuditDate, F.ID, 'FirstName' AS Attribute, LAG(F.FirstName) OVER (/*PARTITION BY GroupId, ID*/ ORDER BY AuditDate) AS [From], F.FirstName AS [To]
    FROM
        @foo F
    UNION ALL
    SELECT
        F.GroupId, F.AuditDate, F.ID, 'LastName' AS Attribute, LAG(F.LastName) OVER (/*PARTITION BY GroupId, ID*/ ORDER BY AuditDate) AS [From], F.LastName AS [To]
    FROM
        @foo F
    ) X
WHERE
    ISNULL(X.[From], '') <> ISNULL(X.[To],  '')
ORDER BY
    X.AuditDate DESC, X.Attribute 
```**

# javascript - 使用 getUserMedia 和 RTCPeerConnection Chrome 25 停止/关闭网络摄像头

> ID：15137069
> 
> 赞同：-1
> 
> 时间：2013-02-28T13:43:36.100
> 
> 标签：javascript, html, html5-video, webrtc

我在 Chrome 25 上成功使用 getUserMedia 和 RTCPeerConnection 将音频从网页连接到另一方，但我无法让 API 停止 Chrome 选项卡中正在使用媒体的红色闪烁指示图标在该页面上. 我的问题本质上[是由 navigator.getUserMedia 打开的停止/关闭网络摄像头](https://stackoverflow.com/questions/11642926/stop-close-webcam-which-is-opened-by-navigator-getusermedia)的副本，只是那里的分辨率不起作用。如果我的页面仅使用 getUserMedia 而没有远程媒体（无对等），则停止相机会关闭闪烁的选项卡指示器。添加远程流似乎是一个/问题。这是我目前的“关闭”代码：

```
if (localStream) {
    if (peerConnection && peerConnection.removeStream) {
        peerConnection.removeStream(localStream);
    }
    if (localStream.stop) {
        localStream.stop();
    }
    localStream.onended = null;
    localStream = null;
}
if (localElement) {
    localElement.onerror = null;
    localElement.pause();
    localElement.src = undefined;
    localElement = null;
}
if (remoteStream) {
    if (peerConnection && peerConnection.removeStream) {
        peerConnection.removeStream(remoteStream);
    }
    if(remoteStream.stop) {
        remoteStream.stop();
    }
    remoteStream.onended = null;
    remoteStream = null;
}
if (remoteElement) {
    remoteElement.onerror = null;
    remoteElement.pause();
    remoteElement.src = undefined;
    remoteElement = null;
}
if (peerConnection) {
    peerConnection.close();
    peerConnection = null;
} 
```

我试过打电话和不`removeStream()`打电话，我试过打电话和不`stop()`打电话，我试过`element.src=""`and `element.src=null`，我的想法已经不多了。有人知道这是错误还是用户/我在使用 API 时的错误？

**编辑：**我将我的默认设备（使用 Windows）设置为在使用时有灯的相机，并且在停止时，相机灯熄灭，所以这可能是 Chrome 错误。我还发现，如果我`chrome://settings/content`将麦克风设备更改为“默认”以外的任何设备，Chrome 音频将完全失败。最后，我意识到使用`element.src=undefined`导致 Chrome 尝试加载资源并抛出 404，所以这显然是不正确的......所以回到`element.src=''`那个。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T14:12:37.500

最终成为我的错（是的，令人震惊）。原来我没有`localStream`在`onUserMediaSuccess`回调中正确保存`getUserMedia`... 一旦设置好，Chrome 就会关闭闪烁的录制图标。这并没有解释其他异常情况，但它结束了问题的要点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T00:07:44.653

在浏览了 WebRTC 规范后，我昨天*才开始工作。*我不知道这是否是“正确”的做法，但我发现在删除流后用新的提议重新协商 PeerConnection 就可以了。

```
var pc = peerConnections[socketId];
pc.removeStream(stream);
pc.createOffer( function(session_description) {
  pc.setLocalDescription(session_description);
  _socket.send(JSON.stringify({
    "eventName": "send_offer",
    "data":{
      "socketId": socketId,
      "sdp": session_description
      }
    }));
},
function(error) {},
defaultConstraints); 
```

# php - FPDF 错误将输出发送到浏览器

> ID：15137072
> 
> 赞同：0
> 
> 时间：2013-02-28T13:43:40.257
> 
> 标签：php, fpdf

我收到此错误消息：

> FPDF 错误：一些数据已经输出，无法发送 PDF 文件

当我启动以下代码时；你知道为什么吗？你能帮助我吗？

```
$i = 0;
while ($i <= $y)
{
  $namefilepdf=$x_labelname.$i.'.pdf';
  $pdf=new FPDF();
  $pdf->AddPage($x_lay,$x_dimpag);
  $pdf->SetFont('Arial');           

  if (isset($x_toprint1))
    if ($x_toprint1=='on')
        if (isset($x_progressive1))
        {
          if ($x_progressive1=='on')
          {
            $pdf->SetFontSize($x_font1);
            $pdf->Text($x_coordx1,$x_coordy1,$x_val1+$i);
          }
        }
        else
        {
            $pdf->SetFontSize($x_font1);
            $pdf->Text($x_coordx1,$x_coordy1,$x_valore1);
        }
  $pdf->Output($namefilepdf,'D');
  $i++;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T13:49:29.023

要使 FPDF 工作，不能有*任何*其他输出。诸如`echo`PHP 文件中其他地方的语句、标签之前或之后的任何内容（包括空格）`<?php ?>`等内容都会导致该错误消息。

我怀疑在您的 PHP 文件中的其他地方，可能有一些非 FPDF 输出导致您看到该错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T13:46:13.843

这是因为在输出您的 pdf 对象之前，您的代码中的某处您已经完成了一些`echo`或`var_dump`任何其他输出方法。使用输出数据时，`header`您不能在`header`语句之前将任何其他内容发送到标准输出

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-04T04:34:21.313

在此处使用输出缓冲：-

在发送到输出之前，使用`ob_clean();`.

```
 ob_clean();//add this line 
 $pdf->Output($namefilepdf,'D'); 
```

请参考此[链接](http://php.net/manual/en/function.ob-clean.php)以了解`ob_clean();`

# sql - 将变量从sh传递到sql

> ID：15137074
> 
> 赞同：-1
> 
> 时间：2013-02-28T13:43:56.003
> 
> 标签：sql, bash, shell

```
declare -a array[2]
for  (( i=0; i<3; i++ ))
do
read array[$i]
done

for  (( n=0; n<3; n++ ))
do
echo  -e "From Table[$n]: ${array[$n]}\n " ;
done

sqlplus owner/pass@db << ENDOFSQL
    @file.sql
exit;
ENDOFSQL; 
```

我需要在 file.sql 脚本中使用 bash 数组 [] 变量。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T14:06:02.573

如果`file.sql`要从输入创建，则不需要数组。你可以在同一个for循环中读写

```
for (( i = 0; i < 3; i++ )); do
    read a
    echo "From Table[$i]: $a"
done >file.sql 
```

这将创建`file.sql`，然后您可以将其传递给 sqlplus

```
sqlplus owner/pass@db @file.sql 
```

您还应该能够完全跳过输入文件并将 for 循环的输出直接通过管道传输到 sqlplus

```
for (( i = 0; i < 3; i++ )); do
    read a
    echo "From Table[$i]: $a"
done | sqlplus owner/pass@db 
```

# java - 如何检查正确答案

> ID：15137078
> 
> 赞同：0
> 
> 时间：2013-02-28T13:44:04.777
> 
> 标签：java, android, android-sqlite

将数据库导入资产后，我成功地从中读取，并为我的活动中的四个按钮分配随机答案：

```
try{    
        mDbHelper.open();  //open db

        Cursor c = mDbHelper.getTestData();

        question.setText(c.getString(1));

        List<String> labels = new ArrayList<String>();

        labels.add(c.getString(2));
        labels.add(c.getString(3));
        labels.add(c.getString(4));
        labels.add(c.getString(5));

        Collections.shuffle(labels);

        bOdgovor1.setText(labels.get(0));
        bOdgovor2.setText(labels.get(1));
        bOdgovor3.setText(labels.get(2));
        bOdgovor4.setText(labels.get(3));
        }
        finally{    // close db
            mDbHelper.close();
        } 
```

我的正确答案总是 c.getString(2) （我的 sqlite db 中有一个列设置为 ANSWER 并且它的 ID=2）。之后，我将每个按钮的 onClickListener 设置为用另一个问题重新激活活动：

```
bOdgovor1.setOnClickListener(new OnClickListener() {

            public void onClick(View v) {
                finish();
                startActivity(getIntent());

            }
        }); 
```

如何检查什么是正确答案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T13:47:36.173

投你`View`的`Button`

```
Button btn = (Button) v; 
```

然后比较标签

```
if (btn.getText().equals(c.getString(2)) {
  ...
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T13:51:06.317

更新了我的答案，请检查：

```
 private class Answer {
        public Answer(String opt, boolean correct) {
            option = opt;
            isCorrect = correct;
        }

        String option;
        boolean isCorrect;
    }

List<Answer> labels = new ArrayList<Answer>();

    labels.add(new Answer(c.getString(2), true));
    labels.add(new Answer(c.getString(3), false));
    labels.add(new Answer(c.getString(4), false));
    labels.add(new Answer(c.getString(5), false));

    Collections.shuffle(labels);

    bOdgovor1.setText(labels.get(0).option);
    bOdgovor1.setTag(labels.get(0));
    bOdgovor1.setOnClickListener(clickListener);

    bOdgovor2.setText(labels.get(1).option);
    bOdgovor2.setTag(labels.get(1));
    bOdgovor2.setOnClickListener(clickListener);

    bOdgovor3.setText(labels.get(2).option);
    bOdgovor3.setTag(labels.get(2));
    bOdgovor3.setOnClickListener(clickListener);

    bOdgovor4.setText(labels.get(3).option);
    bOdgovor4.setTag(labels.get(3));
    bOdgovor4.setOnClickListener(clickListener); 
```

所有按钮的 OnClickListener：

```
final OnClickListener clickListener = new OnClickListener() {

    public void onClick(View v) {
        Answer ans = (Answer) v.getTag();
        if (ans.isCorrect) {
            finish();
            startActivity(getIntent());
        }
    }
}; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-28T13:47:05.760

按钮 b = (按钮)v; if (b.getText().toString().equals(c.getString(2))){

```
 // answer is correct
} 
```

不是很优雅，但应该这样做。

# php - 给定用户名时，根据分数从无序的 MySql 数据库中获取排名

> ID：15137093
> 
> 赞同：4
> 
> 时间：2013-02-28T13:44:37.743
> 
> 标签：php, mysql, sql, rank

好的，所以我有一张桌子，上面有以下内容

```
KEY   username   password   score 
```

上面的列没有任何特定的顺序。

我想向我的数据库发送一个用户名，并让它根据其分数向我发送该用户名的排名。例如，如果我有 10 个人在里面，而里面的第 3 个人得分最高。当我通过第三个人用户名时，我希望它发回 1。

这可能吗？

我一直在尝试这样的事情

```
$result = mysql_query("SELECT * FROM tablename where username='$username' ORDER BY score DESC"); 
```

但它似乎没有给我行号

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-28T13:48:58.627

这将处理具有相同分数的等级。

```
SELECT  d.*, c.ranks
FROM
        (
          SELECT    Score, @rank:=@rank+1 Ranks
          FROM
                  (
                      SELECT  DISTINCT Score 
                      FROM    tableName a
                      ORDER   BY score DESC
                  ) t, (SELECT @rank:= 0) r
        ) c 
        INNER JOIN tableName d
            ON c.score = d.score
// WHERE   d.username = 'Helen' 
```

*   [SQLFiddle 演示（*重复排名*）](http://www.sqlfiddle.com/#!2/72eb3/6)
*   [SQLFiddle Demo（*带过滤*）](http://www.sqlfiddle.com/#!2/72eb3/3)

例如

```
KEY     username    password    score   Ranks
1       Anna        123         5       3
2       Bobby       345         6       2
3       Helen       678         6       2
4       Jon         567         2       4
5       Arthur      ddd         8       1 
```

为了获得更好的性能，添加一个`INDEX`on 列`Score`，

```
ALTER TABLE tableName ADD INDEX (Score) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-28T13:47:22.870

```
SELECT 
    (SELECT COUNT(*)+1 FROM tablename WHERE score > t.score) as rank,
    * 
FROM
     tablename t
where 
     username='$username' 
```

您的`ORDER BY`查询中的 没有用，因为您只返回一行。

# php - 如果 PHP 中没有调用函数，代码是否仍然在函数中运行？

> ID：15137095
> 
> 赞同：1
> 
> 时间：2013-02-28T13:44:50.990
> 
> 标签：php

我想知道，我在 PHP 中有一些函数不是每次都调用，但每次加载时仍包含在我的文件中。即使您当时没有调用该函数，它是否仍然运行代码？我问的原因是，我的函数中的代码在 CPU 方面运行起来很昂贵，而且我不会每次都调用它们，并且想确保如果没有调用它们，它们不会在函数中运行代码。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-28T13:52:37.057

简而言之，未显式调用的函数不会运行。但是，这里简要介绍一下我们使用我发现的函数的内容和原因。

> 函数是我们将程序的一部分锁定到其中的“黑匣子”。函数背后的想法是它划分程序的一部分，特别是函数中的代码具有一些有用的属性：
> 
> 1.  它执行一些定义明确的任务，这将对程序的其他部分有用。
>     
>     
> 2.  它也可能对其他程序有用；也就是说，我们也许可以重用它（并且不必重写它）。
>     
>     
> 3.  程序的其余部分不必知道函数是如何实现的细节。这可以使程序的其余部分更容易思考。
>     
>     
> 4.  该函数很好地完成了它的任务。它可能被编写为比调用它的第一个程序所要求的多一点，并期望调用程序（或其他一些程序）以后可能需要额外的功能或改进的性能。（重要的是完成的函数做好它的工作，否则可能不愿意调用它，因此它可能无法实现可重用的目标。）
>     
>     
> 5.  通过将执行有用任务的代码放入一个函数中，并在程序中必须执行该任务的其他部分简单地调用该函数，程序的其余部分变得更加清晰：而不是有一些大的、复杂的、困难的——为了理解在执行任务的任何地方重复的一段代码，我们有一个简单的函数调用，函数的名称提醒我们正在执行哪个任务。
>     
>     
> 6.  由于程序的其余部分不必知道函数是如何实现的细节，程序的其余部分并不关心以后是否以某种不同的方式重新实现该函数（只要它继续执行它的当然，同样的任务！）。这意味着可以重写程序的一部分，以提高性能或添加新功能（或简单地修复错误），而无需重写程序的其余部分。
>     
>     
> 
> 函数可能是我们对抗软件复杂性的最重要武器。您需要了解何时适合将处理分解为函数（以及何时不适合），以及如何设置函数接口以最好地实现上述质量：可重用性、信息隐藏、清晰性和可维护性。

[http://www.eskimo.com/~scs/cclass/notes/sx5.html](http://www.eskimo.com/~scs/cclass/notes/sx5.html)

# dojo - 如何将按钮添加到 dojo 标题窗格

> ID：15137107
> 
> 赞同：3
> 
> 时间：2013-02-28T13:45:25.893
> 
> 标签：dojo, titlebar

有什么方法可以将**按钮**添加到**TitlePane**标题（标题栏右侧），以便我可以进行一些操作（下载、删除...）

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2017-03-01T17:49:48.967

dijit TitlePane 标头包含以下内容

```
<div class="dijitTitlePaneTitleFocus" data-dojo-attach-point="focusNode" aria-pressed="true" role="button" aria-controls="dijit_TitlePane_0_pane" tabindex="0">
<span data-dojo-attach-point="arrowNode" class="dijitInline dijitArrowNode" role="presentation"></span><span data-dojo-attach-point="arrowNodeInner" class="dijitArrowNodeInner">-</span><span data-dojo-attach-point="titleNode" class="dijitTitlePaneTextNode" style="user-select: none;">Rule</span>
<span class="dijit dijitReset dijitInline dijitButton" role="presentation" widgetid="dijit_form_Button_1">
<span class="dijitReset dijitInline dijitButtonNode" data-dojo-attach-event="ondijitclick:__onClick" role="presentation">
<span class="dijitReset dijitStretch dijitButtonContents" data-dojo-attach-point="titleNode,focusNode" role="button" aria-labelledby="dijit_form_Button_1_label" tabindex="0" id="dijit_form_Button_1" style="user-select: none;">
<span class="dijitReset dijitInline dijitIcon dijitNoIcon" data-dojo-attach-point="iconNode"></span><span class="dijitReset dijitToggleButtonIconChar"></span>
<span class="dijitReset dijitInline dijitButtonText" id="dijit_form_Button_1_label" data-dojo-attach-point="containerNode">x</span></span></span></span>
</div> 
```

如您所见，我们可以参考几个附加点。

要添加任何项目，即使是 dijit 或自定义小部件，请执行以下操作以将项目放置在**focusNode**附加点的最后一个之后（注意：您必须正确设置它的样式才能使项目出现在您想要的位置）

```
 var myTitlePane = new TitlePane({ title: "TitlePane" });            

        var deleteButton = new Button({
            label: 'x',
            onClick: function () {
                //do something here like delete the titlepane
                //alert();
            }
        });
        deleteButton.placeAt(rulesTitlePane.focusNode); 
```

这将产生看起来像这样的东西，

[![在此处输入图像描述](../Images/a499cf28edc562f595298afa257d6a5e.png)](https://i.stack.imgur.com/0CvTT.png)

或者您可以替换所有内容并在 focusNode 中创建您想要的任何内容。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-08-27T16:39:09.017

有。我能够在添加的 dijit 的创建中使用 .placeAt() 方法来做到这一点，如下所示：

在 index.htm 中

```
<div id="divMap"></div> 
```

在回调中的 main.js

```
ready (function() {
    var ttpMyTitlePane = new TitlePane({
        title: 'My Title'
    });
    divMenu.appendChild(ttpMyTitlePane.domNode);

    var btnMyButton = new Button({
        label: 'ButtonText',
        onClick: function() {
            // do stuff
        } 
    }).placeAt(ttpMyTitlePane.domNode);
} 
```

# ruby - 使用 Ruby 进行离线地理计算，它们可以完成吗？

> ID：15137115
> 
> 赞同：2
> 
> 时间：2013-02-28T13:45:56.163
> 
> 标签：ruby, database, geolocation

我是 GeoCoding/GeoData/etc 的新手，并且有一个关于在不连接到在线地理服务的情况下进行计算的问题。

如果已经知道 的经度和纬度`x`，以及 的经纬度`y`，是否可以在不访问在线服务（即 Google、Geocoder.ca 等）的情况下确定两点之间的距离？

目前，数据位于 MySQL 数据库中。

注意：我在这里找到了几个半相关的答案，但它们链接到 C 库，而我使用的是 Ruby。

**更新：**万一您已经在使用 RubyGeocoder 进行在线服务查询，您可能有兴趣知道它具有内置的 Haversine 功能，[文档在此处](http://rdoc.info/github/alexreisner/geocoder/master/Geocoder/Calculations#distance_between-instance_method)。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T13:59:56.733

点之间的距离可以使用**Haversine 公式计算**。（维基百科：[http](http://en.wikipedia.org/wiki/Haversine_formula) ://en.wikipedia.org/wiki/Haversine_formula ）

这是一个示例实现： [http ://www.esawdust.com/blog/gps/files/HaversineFormulaInRuby.html](http://www.esawdust.com/blog/gps/files/HaversineFormulaInRuby.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-05-21T04:28:12.200

由于我们的地球是椭球体而不是球体，如果您正在寻找更准确的解决方案，请查看[Lambert 公式](https://www.jstor.org/stable/24531873)。

我已经为此做了一个实现。

[https://github.com/tonytonyjan/geodesics](https://github.com/tonytonyjan/geodesics)

它通过了 WGS84 椭球的 500,000 个测地线测试集，准确率超过**99%**。

# xml - 如何在 XSLT 中正确使用输出作为 XML？

> ID：15137117
> 
> 赞同：1
> 
> 时间：2013-02-28T13:46:05.207
> 
> 标签：xml, xslt

我正在将我的 XSLT 输出为 HTML，但我已经读到，出于验证原因，输出为 XML 更好。因此，当我将输出从 HTML 更改为 XML 时，它会破坏页面，这是否意味着我现在需要从 XSLT 文件中删除所有 HTML 元素？我还通过外部 CSS 文件进行样式设置，当输出为 XML 时，样式是否需要在 XSLT 文件中？

这是我的页面代码：

```
<?xml version="1.0"?>

<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

<xsl:output 
method="xml" 
doctype-system="http://www.openmobilealliance.org/tech/DTD/xhtml-mobile12.dtd"  
doctype-public="-//WAPFORUM//DTD XHTML Mobile 1.2//EN" />

<xsl:template match="/">

        <xsl:element name="head">
            <xsl:element name="title">Selected Flight Route</xsl:element>
            <link rel="stylesheet" type="text/css" href="mystyles.css" title="Style"/>
        </xsl:element>

        <xsl:element name="body"> 

            <xsl:element name="div"><!-- This holds the navigation bar-->
                <xsl:attribute name="id">
                    <xsl:text>navdiv</xsl:text>
                </xsl:attribute>

                <xsl:element name="div"><!-- This holds the image links-->
                    <xsl:attribute name="id">
                        <xsl:text>navlinks</xsl:text>
                    </xsl:attribute>

                    <xsl:element name="a">
                        <xsl:attribute name="id">
                            <xsl:text>navlinksone</xsl:text>
                        </xsl:attribute>
                        <xsl:attribute name="href">flights.php</xsl:attribute>
                    </xsl:element>

                    <xsl:element name="a">
                        <xsl:attribute name="id">
                            <xsl:text>navlinkstwo</xsl:text>
                        </xsl:attribute>
                        <xsl:attribute name="href">planes.php</xsl:attribute>
                    </xsl:element>

                    <xsl:element name="a">
                        <xsl:attribute name="id">
                            <xsl:text>navlinksthree</xsl:text>
                        </xsl:attribute>
                        <xsl:attribute name="href">weatherfeed.php</xsl:attribute>
                    </xsl:element>

                </xsl:element>
            </xsl:element><!-- End the navigation bar-->

<xsl:element name="div"><xsl:attribute name="id">
                            <xsl:text>maindiv</xsl:text>
                        </xsl:attribute>

<h1 id="heading">Flights and planes</h1>

<xsl:element name="div"><xsl:attribute name="id">
                            <xsl:text>divone</xsl:text>
                        </xsl:attribute><img width="30" height="30" src="globe.png"/><p class="centerp">Selecting the Globe will display all flight routes.</p></xsl:element>

<xsl:element name="div"><xsl:attribute name="id">
                            <xsl:text>divtwo</xsl:text>
                        </xsl:attribute><img width="75" height="30" src="planepic.png"/><p class="centerp">Selecting the Plane will display all Aircraft info.</p></xsl:element>

<xsl:element name="div"><xsl:attribute name="id">
                            <xsl:text>divthree</xsl:text>
                        </xsl:attribute><img width="32" height="30" src="weather.png"/><p class="centerp">The Weather icon displays the weather in all citys.</p></xsl:element>
</xsl:element>

        </xsl:element>
        <!-- End the Body element -->

</xsl:template>
<!-- End the Main Template element -->

</xsl:stylesheet> 
```

[这](http://mayar.abertay.ac.uk/~0902221/plcwork/)是输出为 XML 的页面的链接，[这](http://mayar.abertay.ac.uk/~0902221/plcwork/testing.php)是输出为 HTML 的同一页面，谁能告诉我为什么在输出为 XML 时这会弄乱我的页面？在研究问题是什么时，我注意到输出为 XML 的示例文件似乎没有任何 HTML 元素。

这是我用来转换 XML 的原始文件：

```
<?php
$xml = new DOMDocument();   
$xml->load('flights.xml');

$xsl = new DOMDocument;
$xsl->load('index.xsl');

$proc = new XSLTProcessor();
$proc->importStyleSheet($xsl);

echo $proc->transformToXML($xml);
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T14:38:49.560

**简答**

您不能将 XML 输出到浏览器并期望他呈现 HTML，它们是不同的语言。

**长答案**

如果您输出 XML 而不是 HTML，浏览器将不会按您的预期呈现页面，因为创建的是 XML 节点而不是 HTML 节点。这两者之间的区别在于 HTML 节点比 XML 节点具有更多的属性。例如，其中一些属性允许我们设置 HTML 元素的样式。

XML 节点的属性允许我们操作和导航 DOM，而 HTML 属性是所有 XML 属性的超集（我认为）。

对于每种节点可用的属性列表（从 Firefox 的角度来看，它非常符合标准）：[https ://developer.mozilla.org/en-US/docs/DOM/element](https://developer.mozilla.org/en-US/docs/DOM/element)

**XHTML**

因为您指的是验证，所以 HTML 4.01 的替代方案是 XHTML 1.0，它是与 HTML 或 XML 不同的语言，并且在验证方面更严格（例如，它不允许不匹配的标签）。

要指示浏览器您使用的是 XHTML 1.0 而不是 HTML 4.01，您必须在文档顶部包含这些 DOCTYPE 元素之一。

```
 <!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Frameset//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-frameset.dtd"> 
```

**CSS 差异**

在如何处理 XHTML 文档的 CSS 方面也存在一些（微小的）差异。我给你留下一篇文章，列出这些差异：

[http://reference.sitepoint.com/css/htmlxhtml](http://reference.sitepoint.com/css/htmlxhtml)

# computer-vision - 如何在 kinect 中检测手势的开始和结束？

> ID：15137123
> 
> 赞同：1
> 
> 时间：2013-02-28T13:46:16.000
> 
> 标签：computer-vision, kinect, gesture, gesture-recognition, openni

我正在研究手势的一次性学习。大多数手势涉及移动左右手，并且使用 Kinect SDK 的骨骼跟踪库可以轻松检测到手关节。我面临的问题是如何猜测手势的开始和结束的时间，以便我可以将手关节轨迹的坐标提供给最终对手势进行分类的算法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-28T17:30:12.343

您无法在学习引擎中检测到未知手势的开始。必须有一些离散的动作告诉系统一个手势即将开始让它学习。如果没有这个离散的动作，系统就无法知道手势的开始是什么动作，之间的动作，朝向开始的动作，以及引擎不应该关心的任意动作。

根据您的情况，有一些离散的操作可能会起作用：

1.  键盘或鼠标动作
2.  表示新手势的已知手势是开始/结束
3.  使用语音识别来通知引擎您正在启动/结束
4.  一些带有短倒计时计时器的动作，用户可以到达手势的“位置 1”并在提示时开始。
5.  所有手势都有一个单一的起源 - 在那里握住你的手一小段时间以表示学习行动的开始。

如果没有某种形式的离散动作，系统就无法知道你想要什么。它总是会猜测，你总是会遇到系统猜测错误的情况。

要在已知手势上执行，您的方法取决于您存储数据的方式和手势的复杂性。以下是两个手势库，您可以查看它们以了解它们的工作原理：

*   [http://kinecttoolbox.codeplex.com/](http://kinecttoolbox.codeplex.com/)
*   [https://github.com/EvilClosetMonkey/Fizbin.Kinect.Gestures](https://github.com/EvilClosetMonkey/Fizbin.Kinect.Gestures)

根据每种情况下手势数据的存储方式，它们还可以帮助您了解如何开始/结束手势。

# javascript - Select2 动态元素不响应事件

> ID：15137124
> 
> 赞同：2
> 
> 时间：2013-02-28T13:46:21.057
> 
> 标签：javascript, jquery, jquery-select2

我正在使用[Select2](http://ivaynberg.github.com/select2/)，效果很好。但是，我正在使用下面的代码来创建新的动态 select2 下拉菜单，但是在单击它们时它们没有反应/打开。

```
var relationshipcounter = 0;

$('#AddMoreRelationships').click(function () {
    var $relationship = $('.relationship'); // div containing select2 dropdown
    var $clone = $relationship.eq(0).clone();
    $clone[0].id = 'id_' + ++relationshipcounter;
    $relationship.eq(-1).after($clone);

    $relationship.find('select').trigger('change'); // not working
}); 
```

**截屏：**

![在此处输入图像描述](../Images/2d16211fee23c897291027328cba1d26.png)

**JSFIDDLE：**

[http://jsfiddle.net/pHSdP/133/](http://jsfiddle.net/pHSdP/133/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T14:03:56.963

我遇到了这个确切的问题，当然，我尝试的第一件事是包含数据的深层副本：

```
el.clone(true,true); 
```

这没有用。相反，我发现的最好方法是：

```
el=other_el.clone()_etc; // cloning the old row
el.find('.select2-container').remove();
el.find('select').select2({width: 268}); 
```

`el`在这两个片段中都是`div`包含 the`select`和所以 Select2 元素的行。

基本上我在第二个片段中所做的是删除“旧”select2，它将始终具有类，`.select2-container`然后`select`在我的新行中的所有找到的元素上重新创建它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-28T13:48:20.470

您还需要使用参数调用`clone`以`true`复制事件和数据。否则只有元素被克隆，而不是绑定到它的事件。

```
$relationship.eq(0).clone(true); 
```

文档：[http ://api.jquery.com/clone/](http://api.jquery.com/clone/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-01T10:49:37.640

好的，问题解决了，小提琴：

[http://jsfiddle.net/WrSxV/1/](http://jsfiddle.net/WrSxV/1/)

```
// add another select2
var counter = 0;
$('#addmore').click(function(){
    var $relationship = $('.relationship');
    var $clone = $("#RelationshipType").clone();
    $clone[0].id = 'id_' + ++counter;
    $clone.show();
    $relationship.eq(-1).after($clone);
    $clone.select2({ "width" : "200px" });// convert normal select to select2

    //$('body').select2().on('change', 'select', function(){
      //  alert(this.id);
    //}).trigger('change');

    return false;
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-28T13:48:47.927

用于`.on`将动态插入的元素绑定到事件，例如

```
$('body').on('click','#AddMoreRelationships',function () {
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-28T13:51:19.930

克隆对象后，您必须为 em 重新分配事件：

```
var $clone = $relationship.eq(0).clone();
$clone.on("click", function_name); 
```

# installation - 如何在 Visual C++ 上安装 Boost 线程？

> ID：15137134
> 
> 赞同：2
> 
> 时间：2013-02-28T13:46:55.283
> 
> 标签：installation, boost-thread, visual-c++-2010

我是多线程的新手，所以我想开始学习 Boost 线程。然而，在我开始之前，我想知道如何让所有文件都与 Visual C++ 2010 一起工作。作为初学者，不仅要处理与代码相关的问题，还要处理错误的安装，这可能会非常令人沮丧。试图在网上找到它，但找不到任何好的资源。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T15:32:43.757

这周我也是第一次这样做。我想静态链接它，显然安装程序只是复制 dll（我必须确认这一点）。当然有更好的方法来做到这一点，但对我有用的是下载整个集合并运行生成 lib 文件的 bat 文件。

之后，只需在项目中设置额外的 include 和 lib 目录即可。

# asp.net-mvc - 为什么当我调用 Json(null) 时 ASP.NET MVC 不发送响应

> ID：15137143
> 
> 赞同：0
> 
> 时间：2013-02-28T13:47:13.670
> 
> 标签：asp.net-mvc, json, model-view-controller, json.net

当我在 ASP.NET MVC Action 中调用 Json(null) 时，是否有充分的理由不发送响应？

因为它在 jQuery Ajax 调用而不是完成时触发了失败事件。

这样做的代码是：

```
public override void ExecuteResult(ControllerContext context)
{
    ...
        if (Data != null)
        {
            JavaScriptSerializer serializer = new JavaScriptSerializer();
            if (MaxJsonLength.HasValue)
            {
                serializer.MaxJsonLength = MaxJsonLength.Value;
            }
            if (RecursionLimit.HasValue)
            {
                serializer.RecursionLimit = RecursionLimit.Value;
            }
            response.Write(serializer.Serialize(Data));
        }
} 
```

这似乎是一个愚蠢的问题，但我之所以这么问，是因为我覆盖了 Json 方法，删除了 if。所以我的 $.ajax 调用将起作用，调用 done 事件而不是失败。但是，如果 ASP.NET MVC 团队说“如果”他们可能有充分的理由，那可能会影响我的应用程序

```
 //jQuery 1.9.1
        $.ajax({
            cache: false,
            url: urlGeraSigla,
            data: { titulo: $(this).val() },
            dataType: "json",
            type: 'POST'
        }).done(function (resultadoJson) {
            $('#@(Html.IdFor(model => model.Sigla))').val(resultadoJson);
        }).fail(function(resultadoJson) {
            debugger;//ASP.NET MVC Json(null) hit here
        }); 
```

# html - Firefox 与 webkit-browser 不同的元素宽度

> ID：15137153
> 
> 赞同：4
> 
> 时间：2013-02-28T13:47:47.310
> 
> 标签：html, google-chrome, firefox, css

我认为您更容易检查元素而不是我编写代码，所以这里是 link = [music band site](http://test.tobiasekman.com/solitude)。现在的问题：

在 chrome 中一切正常，但如果你在 Firefox 中使窗口更小（宽度），你会看到社交图标不会粘在黄色社交栏中的一行（就像它们在 chrome 中所做的那样）。这是为什么？

页脚中的社交图标在 Firefox 中也出现了新的一行，但在 chrome 中没有。为什么？

谢谢你！（是的，我知道图片太大了，以后会修复更多的东西。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T13:58:00.437

您可以将`#socialbanner a`选择器上的填充移动到`#socialbanner img`选择器上：

从：

```
#socialbanner a {
    padding: 0 1.275%;
} 
```

至：

```
#socialbanner img {
    padding: 0 1.275%;
    vertical-align: middle;
} 
```

# hadoop - Hadoop减少任务卡在0%

> ID：15137159
> 
> 赞同：0
> 
> 时间：2013-02-28T13:48:09.423
> 
> 标签：hadoop, mapreduce

我正在按照一些指南来设置伪分布式模式，我运行 start-all.sh 并且守护进程都很好（其中 6 个），然后我启动了我的 WordCount 示例，该示例在独立模式下运行良好，但卡在 map 100%，减少 0%。

查看 jobtracker，reduce 任务处于 status `reduce > copy`。唯一的错误日志位于`secondarynamenode.log`：

```
2013-02-27 23:29:59,555 ERROR org.apache.hadoop.security.UserGroupInformation: PriviledgedActionException as:my_user_name cause:java.net.ConnectException: Connection refused 
2013-02-27 23:29:59,555 ERROR org.apache.hadoop.hdfs.server.namenode.SecondaryNameNode: Exception in doCheckpoint:  
2013-02-27 23:29:59,555 ERROR org.apache.hadoop.hdfs.server.namenode.SecondaryNameNode: java.net.ConnectException: Connection refused 
```

我可以在没有密码的情况下 ssh localhost。Hadoop 版本是 1.1.1。我从命令行启动一个 jar 文件。

真的不知道是什么问题，有帮助吗？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T15:20:03.027

您运行字数统计的数据量是多少？如果您在不使用组合器的情况下以独立模式在大型数据集上运行，那么它将造成一些麻烦。尝试

```
job.setMapperClass(<Mapper_Class>);
job.setCombinerClass(<Reducer_Class>);
job.setReducerClass(<Reducer_Class>); 
```

在包含程序中驱动程序的 main 方法中。这可能会帮助你。

# dynamics-crm-2011 - 如何加快删除特定 CRM 2011 实体

> ID：15137165
> 
> 赞同：2
> 
> 时间：2013-02-28T13:48:19.680
> 
> 标签：dynamics-crm-2011

在我的单元测试中，我为测试创建了大量数据，然后在测试后删除。在查看删除某些实体的时间时，我感到非常惊讶。

在一项测试中，我创建了两种不同的实体类型。第一种类型大约需要 200 毫秒才能删除。第二种类型大约需要 11000 毫秒才能删除。我猜这是由于与实体的某种级联关系依赖关系，但是当我打开跟踪时，我看到一个看起来像是在寻找依赖对象的 select 语句，这花了大约 1100 毫秒，然后删除了大约 9000 毫秒。

有人对如何提高删除性能有任何建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-31T19:51:42.630

如果存在父母关系或设置了级联删除的关系，它也会查找要删除的子记录。这可能是您看到的选择语句。如果您打开关系，您可以查看它们是否存在列为 Cascade All 以供删除的任何关系。

![限制删除](../Images/97dec33cf686e732ac479a683c0c1f5a.png)

# ssas - SSAS 多维数据集的最大容量是多少

> ID：15137168
> 
> 赞同：1
> 
> 时间：2013-02-28T13:48:22.263
> 
> 标签：ssas, business-intelligence, cube

抱歉，如果我在错误的地方发布了这个。我很欣赏这是一个很难回答的问题，因为有太多的变量，但任何建议或指针都会非常感激。

我们有一个非常大、笨重、设计糟糕的立方体。这是一种可怕的“一个立方体来统治他们”类型，如下所示。请注意，名称可能会出卖我工作的地方等的维度已被混淆。

作为一般经验法则，我想要了解的是一个多维数据集可以容纳多少数据。我（和几位专家，我并不声称自己是其中之一！）已向管理层表示，如果他们继续在当前级别向多维数据集添加数据（和属性），它将失败。我们想要的是一种方法来确定这是否会是今年、明年、本月等……是的，我知道这不会有一个确切的公式答案。任何指南都会非常有帮助，因为我在网上找不到任何指南；只有构建的最佳实践，我已经知道这不符合那个！我正在尝试获得预算批准以重新设计它，因此问题...

23 个维度，无 KPI，4 个计算指标和 46 个其他指标

```
[Dim 1] - 11 attributes
    no hierarchies
    4 address lines, email address, full name, postcode, text provider type
[Area Detail] - 21 attributes
    no hierarchies
    2 address lines, postcode, various name and code fields (string)
[Area Main 1 Month Prior] - 5 attributes
    2 hierarchies
[Area Main 4 Months Prior] - 5 attributes
    2 hierarchies
[Area Main Dimension] - 5 attributes
    2 hierarchies
[Type Dim 1] - 1 attributes
    no hierarchies
[Date Dimension] - 36 attributes
    4 hierarchies
[Event Dimension] - 29 attributes
    no hierarchies
    includes 5 dates which are not linked to date dimension but actually entered
[Event Rank Dimension] - 18 attributes
    no hierarchies
[Event Track Dimension] - 21 attributes
    no hierarchies
    14 date fields
    7 comment fields (freetext)
[History Date Dimension] - 4 attributes
    no hierarchies
    all date data
[Dim 2] - 5 attributes
    no hierarchies
    all freetext fields apart from code
[Official Date Dimension] - 9 attributes
    no hierarchies
    Date field and data about the date
[Previous Dim 2 Dimension] - 4 attributes
    no hierarchies
[xxx Current Record Dimension] - 1 attribute
    no hierarchies
[xxx Dimension] - 102 attributes
    no hierarchies
    4 address fields, postcode, 2 email fields, website
[xxx Dimension 1 Month Prior] - as above
[xxx Dimension 4 Months Prior] - as above
[Dim 3] - 12 attributes
    no hierarchies
[Question Dimension] - 11 attributes
    1 hierarchy
    4 large text fields
[yyy Combination Dimension] - 1 attribute
    no hierarchies
[yyy Current Record Dimension] - 1 attribute
    no hierarchies
[yyy Status Dimension] - 3 attributes
    no hierarchies
[Response Dimension] - 4 attributes
    no hierarchies
    2 large text fields
[zzz Area Dimension] - 4 attributes
    no hierarchies
    2 text fields
[zzz Type Dimension] - 1 attribute
    no hierarchies 
```

我希望这是有道理的，但很乐意提供/澄清细节。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-01T02:39:12.700

根据我的经验，您发布的指标主要与可用性相关 - 添加更多维度和度量不会导致您的多维数据集“失败”。我有更多尺寸和尺寸的成功稳定立方体，例如双倍或更多。

“一个多维数据集来统治它们”是 SQL 2005 中引入的一项架构改进。它优化了构建时间、存储和查询性能。使用 SQL 企业版，您可以将其部分呈现为“透视图”，但我不是粉丝。我更喜欢遵循精心规划的 Dimension 和 Measure 命名，因为大多数客户端工具会按字母顺序对这些对象进行排序。

可能导致您的多维数据集挣扎并可能最终“失败”的是较大维度和度量值组中的数据量。1m 行以下的尺寸通常没有戏剧性。100m 行以下的度量值组通常也适用于一些基本的聚合。比这更大，您可能需要在设计中投入更多的工作。我的目标是使用简单的最终用户工具（例如 Excel 2010+）将 95% 的查询的响应时间缩短到 5 秒以下。

# ruby-on-rails - 无法批量分配受保护的属性错误

> ID：15137173
> 
> 赞同：1
> 
> 时间：2013-02-28T13:48:39.190
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, ruby-on-rails-3.2

我正在尝试创建一个`teacher`表，其中有一个名为“teacher_type_id”的列，即它是一个外键，连接到`teacherType`具有三行的表，即 1 => Tutor、2 => Module Leader 和 3 => Lecturer .

我的`schema.rb`文件中包含以下信息：

```
create_table "teacher_types", :force => true do |t|
 t.string   "title"
 t.datetime "created_at", :null => false
 t.datetime "updated_at", :null => false
end

create_table "teachers", :force => true do |t|
 t.integer  "teacherType_id"
 t.string   "firstName"
 t.string   "lastName"
 t.datetime "created_at",     :null => false
 t.datetime "updated_at",     :null => false
end

add_index "teachers", ["teacherType_id"], :name => "index_teachers_on_teacherType_id" 
```

该`teacher_typ.rb`文件如下所示：

```
class TeacherType < ActiveRecord::Base
 has_many :teachers
 attr_accessible :title, :teacher_type_id   (Also tried :teacherType_id)
end 
```

我的`teacher.rb`文件如下所示：

```
class Teacher < ActiveRecord::Base
  has_one :teacherType
  attr_accessible :firstName, :lastName
end 
```

但是，现在当我去我的`localhost:3000/teacher/new`并尝试使用“1”或“Tutor”作为教师类型创建一个新教师时，但是当我提交表单时，我总是得到相同的错误，即：

**`ActiveModel::MassAssignmentSecurity::Error in TeachersController#create`**

```
Can't mass-assign protected attributes: teacherType_id
Rails.root: /Users/omar/rails_projects/attendance

Application Trace | Framework Trace | Full Trace
app/controllers/teachers_controller.rb:43:in `new'
app/controllers/teachers_controller.rb:43:in `create' 
```

**`Request`**

```
Parameters:

{"utf8"=>"✓",
 "authenticity_token"=>"NEJf3bISJsidStVyfdRns0oZ7JzSZ8RqqZSAWgL9hz8=",
 "teacher"=>{"teacherType_id"=>"Tutor",
 "firstName"=>"Jack",
 "lastName"=>"Sparrow"},
 "commit"=>"Create Teacher"}` 
```

任何想法为什么会这样？我看了一下，`attr_accessible`但仍然无济于事

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-28T13:54:33.540

`teacherType_id`在 TeachersController#new 视图中被分配了一个字符串，但它被声明为一个整数。检查你的观点。另外，我会避免使用混合大小写的名称，例如`teacherType_id`...

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-28T13:54:22.720

在老师：

```
attr_accessible :firstName, :lastName, :teacherType_id 
```

# favicon - 如何在子域 xml 文件中显示网站图标

> ID：15137175
> 
> 赞同：0
> 
> 时间：2013-02-28T13:48:42.843
> 
> 标签：favicon

我有一个子域`feeds.domain.com`，这个子域的根目录在主域（`/public_html/feeds/`）中，我

我已将 favicon 放在 root( `/public_html/`) 和子域 root( `/public_html/feeds/`) 目录中。

现在浏览器中不显示子域中的 xml 文件的 favicon，但其他目录中的 xml 文件显示 favicon。

为什么浏览器没有从子域中为 xml 选择 favicon。

网站图标未显示的示例网址是`feeds.domain.com/all/index.xml`

显示 favicon 的示例 url `www.domain.com/feeds/all/index.xml`，（这是从域直接访问时显示 favicon 的子域目录）

如果我输入 url`feeds.domain.com/favicon.ico`浏览器会显示 favicon。

请查看并建议任何可能的方法来做到这一点。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T14:04:36.027

我解决了，我删除了所有浏览器历史记录并清除了浏览器缓存，现在它显示了图标，我希望这也能帮助其他人解决同样的问题。

谢谢。

# java - 如何继续将证书和密钥文件导入到密钥库

> ID：15137182
> 
> 赞同：0
> 
> 时间：2013-02-28T13:48:59.043
> 
> 标签：java, web-services, keystore

我有一个文件名 abc.cert 和 abc.key 现在我需要将其添加到 java 密钥库中，我已经浏览了该站点中已经提供的一些链接，并且还搜索了一些解决方案。

问题是我无法将文件更改为 .der b4 并将它们添加到 jks。

我 hv 使用 Windows 的开源 openssl 64 位将文件从 .pem 转换为 .der 它打开了一个配置文件和 0bite .der 文件。

有人可以告诉我我在哪里失踪。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T14:41:51.617

我认为您不需要`.der`在添加它们之前将它们转换为。

只需按原样添加它们。你得到一个错误或什么？

# java - Tabhost, android.view.WindowManager$BadTokenException: 无法添加窗口

> ID：15137184
> 
> 赞同：0
> 
> 时间：2013-02-28T13:49:05.027
> 
> 标签：java, android

你好在我的应用程序中我正在使用 TabHost

[http://ericharlow.blogspot.in/2010/09/experience-multiple-android-activities.html](http://ericharlow.blogspot.in/2010/09/experience-multiple-android-activities.html)

现在，我在 webview 中打开 twitter 选项卡、facebook 选项卡页，它已成功加载，但在登录时，如果我在传递**用户名和密码**后按下登录按钮，应用程序崩溃并会发生以下错误。

```
 02-28 18:58:17.519: E/AndroidRuntime(10604): android.view.WindowManager$BadTokenException: Unable to add window -- token android.app.LocalActivityManager$LocalActivityRecord@4051ec60 is not valid; is your activity running?
   02-28 18:58:17.519: E/AndroidRuntime(10604):     at android.view.ViewRoot.setView(ViewRoot.java:528)
   02-28 18:58:17.519: E/AndroidRuntime(10604):     at android.view.WindowManagerImpl.addView(WindowManagerImpl.java:177)
   02-28 18:58:17.519: E/AndroidRuntime(10604):     at android.view.WindowManagerImpl.addView(WindowManagerImpl.java:91)
   02-28 18:58:17.519: E/AndroidRuntime(10604):     at android.view.Window$LocalWindowManager.addView(Window.java:465)
   02-28 18:58:17.519: E/AndroidRuntime(10604):     at android.app.Dialog.show(Dialog.java:241)
   02-28 18:58:17.519: E/AndroidRuntime(10604):     at android.app.AlertDialog$Builder.show(AlertDialog.java:813)
   02-28 18:58:17.519: E/AndroidRuntime(10604):     at android.webkit.WebView.onSavePassword(WebView.java:1123)
   02-28 18:58:17.519: E/AndroidRuntime(10604):     at android.webkit.CallbackProxy.handleMessage(CallbackProxy.java:424)
   02-28 18:58:17.519: E/AndroidRuntime(10604):     at android.os.Handler.dispatchMessage(Handler.java:99)
   02-28 18:58:17.519: E/AndroidRuntime(10604):     at android.os.Looper.loop(Looper.java:130)
   02-28 18:58:17.519: E/AndroidRuntime(10604):     at android.app.ActivityThread.main(ActivityThread.java:3835)
   02-28 18:58:17.519: E/AndroidRuntime(10604):     at java.lang.reflect.Method.invokeNative(Native Method) 
```

我加载 facebook 页面或 twitter 页面的类是

```
 public class FacebookActivity extends Activity implements OnClickListener {

private WebView mWebView;
ProgressDialog PD;
String sabNZBurl;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.facebook);

    sabNZBurl = getResources().getString(R.string.fburl);

    mWebView = (WebView) findViewById(R.id.webView1);
    // Added by Pankit -------- start
    if (!TabSample.checkForInternet.isNetworkAvailable(this, this)) {
        Toast.makeText(TabSample.tabContext,
                "No Net Connection... Exiting...", 2000).show();
        exitOnNoNetConnection();

    } else {

        // Added by Pankit -------- End
        PD = new ProgressDialog(TabSample.tabContext);
        PD.setMessage("Please Wait......");
        PD.show();
        mWebView.getSettings().setJavaScriptEnabled(true);
        mWebView.getSettings().setDomStorageEnabled(true);
        mWebView.setWebViewClient(new MyWebViewClient());
        mWebView.loadUrl(sabNZBurl);
     }
}

   final class MyWebViewClient extends WebViewClient {
    @Override
    public boolean shouldOverrideUrlLoading(WebView view, String url) {
        view.loadUrl(url);
        return true;
    }

    @Override
    public void onLoadResource(WebView view, String url) {
        super.onLoadResource(view, url);

    }

    @Override
    public void onPageFinished(WebView view, String url) {
        super.onPageFinished(view, url);
        PD.dismiss();
    }
} 
```

# android - 将 .png 图像上传到 PHP 服务器

> ID：15137188
> 
> 赞同：0
> 
> 时间：2013-02-28T13:49:17.320
> 
> 标签：android

我正在尝试将图像上传到 PHP 服务器。我已经尝试了超过 48 小时，但没有成功。现在我正在尝试以下操作，但是当我按下发送按钮时，应用程序崩溃了。

```
send.setOnClickListener(new OnClickListener() {

    @Override
    public void onClick(View v) {
        try {
            bm = BitmapFactory.decodeFile("/sdcard/DCIM/android_1.png");
            ByteArrayOutputStream bos = new ByteArrayOutputStream();
            bm.compress(CompressFormat.JPEG, 75, bos);
            byte[] data = bos.toByteArray();
            HttpClient httpClient = new DefaultHttpClient();
            HttpPost postRequest = new HttpPost("XXXXXXXXXXXXXXXXXXXXX/uploads/fileup.php");
            ByteArrayBody bab = new ByteArrayBody(data, "android_1.jpg");
            ;
            // File file= new File("/mnt/sdcard/forest.png");
            // FileBody bin = new FileBody(file);
            MultipartEntity reqEntity = new MultipartEntity(HttpMultipartMode.BROWSER_COMPATIBLE);
            reqEntity.addPart("uploadedfile", bab);
            reqEntity.addPart("photoCaption", new StringBody("sfsdfsdf"));
            postRequest.setEntity(reqEntity);
            HttpResponse response = httpClient.execute(postRequest);
            BufferedReader reader = new BufferedReader(new InputStreamReader(response.getEntity().getContent(), "UTF-8"));
            String sResponse;
            StringBuilder s = new StringBuilder();
            Toast.makeText(getApplicationContext(), "your file is saved .",Toast.LENGTH_LONG).show();

            while ((sResponse = reader.readLine()) != null) {
                s = s.append(sResponse);
            }
            System.out.println("Response: " + s);
        } catch (Exception e) {
            // handle exception here
            Log.e(e.getClass().getName(), e.getMessage());
        }
    }
}); 
```

这是日志猫：

```
 03-01 12:46:37.638: D/dalvikvm(379): GC_EXTERNAL_ALLOC freed 57K, 49% free 2750K/5379K, external 1625K/2137K, paused 91ms
03-01 12:46:37.797: D/dalvikvm(379): GC_EXTERNAL_ALLOC freed 1K, 49% free 2749K/5379K, external 3125K/3903K, paused 71ms
03-01 12:46:38.557: D/dalvikvm(379): GC_EXTERNAL_ALLOC freed 4K, 49% free 2781K/5379K, external 4813K/4813K, paused 86ms
03-01 12:52:02.326: W/KeyCharacterMap(379): No keyboard for id 0
03-01 12:52:02.326: W/KeyCharacterMap(379): Using default keymap: /system/usr/keychars/qwerty.kcm.bin
03-01 12:52:14.986: D/dalvikvm(379): GC_EXTERNAL_ALLOC freed 192K, 47% free 3050K/5703K, external 5112K/6294K, paused 68ms
03-01 12:52:15.146: D/dalvikvm(379): GC_EXTERNAL_ALLOC freed 7K, 47% free 3043K/5703K, external 6612K/8257K, paused 73ms
03-01 12:52:18.866: D/AndroidRuntime(379): Shutting down VM
03-01 12:52:18.866: W/dalvikvm(379): threadid=1: thread exiting with uncaught exception (group=0x40015560)
03-01 12:52:18.886: E/AndroidRuntime(379): FATAL EXCEPTION: main
03-01 12:52:18.886: E/AndroidRuntime(379): java.lang.NullPointerException: println needs a message
03-01 12:52:18.886: E/AndroidRuntime(379):  at android.util.Log.println_native(Native Method)
03-01 12:52:18.886: E/AndroidRuntime(379):  at android.util.Log.e(Log.java:230)
03-01 12:52:18.886: E/AndroidRuntime(379):  at tracking.android.TrackingActivity$1.onClick(TrackingActivity.java:84)
03-01 12:52:18.886: E/AndroidRuntime(379):  at android.view.View.performClick(View.java:2485)
03-01 12:52:18.886: E/AndroidRuntime(379):  at android.view.View$PerformClick.run(View.java:9080)
03-01 12:52:18.886: E/AndroidRuntime(379):  at android.os.Handler.handleCallback(Handler.java:587)
03-01 12:52:18.886: E/AndroidRuntime(379):  at android.os.Handler.dispatchMessage(Handler.java:92)
03-01 12:52:18.886: E/AndroidRuntime(379):  at android.os.Looper.loop(Looper.java:130)
03-01 12:52:18.886: E/AndroidRuntime(379):  at android.app.ActivityThread.main(ActivityThread.java:3683)
03-01 12:52:18.886: E/AndroidRuntime(379):  at java.lang.reflect.Method.invokeNative(Native Method)
03-01 12:52:18.886: E/AndroidRuntime(379):  at java.lang.reflect.Method.invoke(Method.java:507)
03-01 12:52:18.886: E/AndroidRuntime(379):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
03-01 12:52:18.886: E/AndroidRuntime(379):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
03-01 12:52:18.886: E/AndroidRuntime(379):  at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T14:11:21.460

嘿，我可以看到您正在使用 multiPart 实体来上传图像，所以当您这样做而不是

```
 MultipartEntity reqEntity = new MultipartEntity(
            HttpMultipartMode.BROWSER_COMPATIBLE);
    reqEntity.addPart("uploadedfile", bab);
    reqEntity.addPart("photoCaption", new StringBody("sfsdfsdf"));
    postRequest.setEntity(reqEntity); 
```

此代码尝试以下代码

```
 MultipartEntity reqEntity = new MultipartEntity(
            HttpMultipartMode.BROWSER_COMPATIBLE);
    FileBody mImage=new FileBody(new File(path));  // The path here is the path of the 
                                                    //  image  either coming from the 
                                                     //camera or gallery 
    reqEntity.addPart("uploadedfile", mImage);
    reqEntity.addPart("photoCaption", new StringBody("sfsdfsdf"));
    postRequest.setEntity(reqEntity); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T11:44:31.230

谢谢大家的回应......我找到了这个链接 [http://www.coderzheaven.com/2012/04/26/upload-image-android-device-server-method-4/](http://www.coderzheaven.com/2012/04/26/upload-image-android-device-server-method-4/) 我改变了我的android代码和php同样，也许它可以帮助某人。

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:orientation="vertical"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    >
    <Button 
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:text="Upload File"
        android:id="@+id/but"
    />

    <TextView 
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:text="@string/hello"
        android:id="@+id/tv"
        android:textColor="#00FF00"
        android:textStyle="bold"
    />
 </LinearLayout> 
```

这是安卓部分

```
TextView tv;
Button b;
int serverResponseCode = 0;
ProgressDialog dialog = null;
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    b = (Button)findViewById(R.id.but);
    tv = (TextView)findViewById(R.id.tv);
    tv.setText("Uploading file path :- '/sdcard/android_1.png'");

    b.setOnClickListener(new OnClickListener() {            
        @Override
        public void onClick(View v) {
            dialog = ProgressDialog.show(UploadImageDemo.this, "", "Uploading file...", true);
             new Thread(new Runnable() {
                    public void run() {
                         runOnUiThread(new Runnable() {
                                public void run() {
                                    tv.setText("uploading started.....");
                                }
                            });                      
                     int response= uploadFile("/sdcard/android_1.png");
                     System.out.println("RES : " + response);                         
                    }
                  }).start();        
            }
    });
}

public int uploadFile(String sourceFileUri) {
      String upLoadServerUri = "http://10.0.2.2/upload_test/upload_media_test.php";
      String fileName = sourceFileUri;

      HttpURLConnection conn = null;
      DataOutputStream dos = null;  
      String lineEnd = "\r\n";
      String twoHyphens = "--";
      String boundary = "*****";
      int bytesRead, bytesAvailable, bufferSize;
      byte[] buffer;
      int maxBufferSize = 1 * 1024 * 1024; 
      File sourceFile = new File(sourceFileUri); 
      if (!sourceFile.isFile()) {
       Log.e("uploadFile", "Source File Does not exist");
       return 0;
      }
          try { // open a URL connection to the Servlet
           FileInputStream fileInputStream = new FileInputStream(sourceFile);
           URL url = new URL(upLoadServerUri);
           conn = (HttpURLConnection) url.openConnection(); // Open a HTTP  connection to  the URL
           conn.setDoInput(true); // Allow Inputs
           conn.setDoOutput(true); // Allow Outputs
           conn.setUseCaches(false); // Don't use a Cached Copy
           conn.setRequestMethod("POST");
           conn.setRequestProperty("Connection", "Keep-Alive");
           conn.setRequestProperty("ENCTYPE", "multipart/form-data");
           conn.setRequestProperty("Content-Type", "multipart/form-data;boundary=" + boundary);
           conn.setRequestProperty("uploaded_file", fileName); 
           dos = new DataOutputStream(conn.getOutputStream());

           dos.writeBytes(twoHyphens + boundary + lineEnd); 
           dos.writeBytes("Content-Disposition: form-data; name=\"uploaded_file\";filename=\""+ fileName + "\"" + lineEnd);
           dos.writeBytes(lineEnd);

           bytesAvailable = fileInputStream.available(); // create a buffer of  maximum size

           bufferSize = Math.min(bytesAvailable, maxBufferSize);
           buffer = new byte[bufferSize];

           // read file and write it into form...
           bytesRead = fileInputStream.read(buffer, 0, bufferSize);  

           while (bytesRead > 0) {
             dos.write(buffer, 0, bufferSize);
             bytesAvailable = fileInputStream.available();
             bufferSize = Math.min(bytesAvailable, maxBufferSize);
             bytesRead = fileInputStream.read(buffer, 0, bufferSize);               
            }

           // send multipart form data necesssary after file data...
           dos.writeBytes(lineEnd);
           dos.writeBytes(twoHyphens + boundary + twoHyphens + lineEnd);

           // Responses from the server (code and message)
           serverResponseCode = conn.getResponseCode();
           String serverResponseMessage = conn.getResponseMessage();

           Log.i("uploadFile", "HTTP Response is : " + serverResponseMessage + ": " + serverResponseCode);
           if(serverResponseCode == 200){
               runOnUiThread(new Runnable() {
                    public void run() {
                        tv.setText("File Upload Completed.");
                        Toast.makeText(UploadImageDemo.this, "File Upload Complete.", Toast.LENGTH_SHORT).show();
                    }
                });                
           }    

           //close the streams //
           fileInputStream.close();
           dos.flush();
           dos.close();

      } catch (MalformedURLException ex) {  
          dialog.dismiss();  
          ex.printStackTrace();
          Toast.makeText(UploadImageDemo.this, "MalformedURLException", Toast.LENGTH_SHORT).show();
          Log.e("Upload file to server", "error: " + ex.getMessage(), ex);  
      } catch (Exception e) {
          dialog.dismiss();  
          e.printStackTrace();
          Toast.makeText(UploadImageDemo.this, "Exception : " + e.getMessage(), Toast.LENGTH_SHORT).show();
          Log.e("Upload file to server Exception", "Exception : " + e.getMessage(), e);  
      }
      dialog.dismiss();       
      return serverResponseCode;  
     } 
} 
```

# android - 替代 onSelectedDayChange calendarview android

> ID：15137193
> 
> 赞同：1
> 
> 时间：2013-02-28T13:49:34.847
> 
> 标签：android, calendarview

onSelectedDayChange 的问题是，当我打开日历视图并单击重点日时，什么也没有发生。例如，我想查看今天的详细信息。现在我打开日历视图，今天是重点。所以我必须点击另一天，然后点击今天查看详细信息。有什么技巧可以解决这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-02T11:13:23.653

CalendarView 派生自 View 可以生成 onClick() 事件。您可以尝试从视图中捕获 onClick() 事件。只是一个想法

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-07-21T09:14:11.877

我做了以下课程来解决这个问题。

```
public class CustomCalendarView extends CalendarView {

    private final String LOG_HEADER = "CAL:VW";
    private Date previousSelectedDate = new Date();
    private OnDateChangeListener listener;
    private CheckSameSelectedDateAsyncTask task = new CheckSameSelectedDateAsyncTask();

    public CustomCalendarView(Context context) {
        super(context);
    }

    public CustomCalendarView(Context context, AttributeSet attribute) {
        super(context, attribute);
    }

    public CustomCalendarView(Context context, AttributeSet attribute, int defStyle) {
        super(context, attribute, defStyle);
    }

    @Override
    public boolean onInterceptTouchEvent(MotionEvent ev) {
        if ((task.getStatus() == AsyncTask.Status.PENDING) || (task.getStatus() == AsyncTask.Status.FINISHED)) {
            task = new CheckSameSelectedDateAsyncTask();
            task.execute();
        }
        return false;
    }

    private void checkSameSelectedDate() {
        Date selectedDate = new Date(super.getDate());
        if (selectedDate.getDay() == previousSelectedDate.getDay() &&
                selectedDate.getMonth() == previousSelectedDate.getMonth() &&
                selectedDate.getYear() == previousSelectedDate.getYear()) {
            if (listener != null) {
                this.listener.onSameSelectedDayChange(this, selectedDate.getYear(), selectedDate.getMonth(), selectedDate.getDay());
            }
        }
        this.previousSelectedDate = selectedDate;
    }

    public void setSameSelectedDayChangeListener(OnDateChangeListener listener) {
        this.listener = listener;
    }

    public interface OnDateChangeListener extends CalendarView.OnDateChangeListener {
        void onSameSelectedDayChange(CalendarView view, int year, int month, int day);
    }

    private class CheckSameSelectedDateAsyncTask extends AsyncTask<Void, Void, Void> {
        @Override
        protected Void doInBackground(Void... params) {
            try {
                //Note: Breaking point between 75 - 100
                Thread.sleep(300);
            } catch (InterruptedException ex) {
                Thread.currentThread().interrupt();
            }
            return null;
        }

        @Override
        protected void onPostExecute(Void result) {
            checkSameSelectedDate();
        }
    }
} 
```

# php - 在页面加载时选择语言弹出窗口

> ID：15137198
> 
> 赞同：2
> 
> 时间：2013-02-28T13:49:57.737
> 
> 标签：php, javascript, html, popup, multilingual

我正在构建一个多语言站点，我想在初始页面加载时插入一个函数，该函数会找到浏览器的默认语言设置，然后提示用户选择他们想要的语言。（英语/ESP）

当然，提示中的语言将与浏览器的语言相同。我已经在所有页面页面上进行了这些语言之间的导航，但我想在用户进入时拦截并避免使用启动页面。

有人可以告诉我这是如何完成的吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-28T14:18:22.517

首先你需要一个自定义事件监听器

```
function addEvent(to, type, fn) {
    // Firefox, Safari, Chrome, Opera
    if(document.addEventListener) {
        to.addEventListener(type, fn, false)
    }
    // Microsoft ActiveX Scripts
    else if(document.attachEvent) {  
        to.attachEvent('on'+type, fn)
    }
    // Last hope
    else {  
        to['on'+type] = fn
    }
} 
```

加载时在窗口上添加事件侦听器并运行函数`onDomLoaded()`

```
addEvent(window, 'load', onDomLoaded) 
```

创建函数 onDomLoaded

```
function onDomLoaded() {
    alert('Im finished loading the entire window, your language is: ' + navigator.language)

} 
```

这是[jsFiddle 上的示例](http://jsfiddle.net/Zexzp/1/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T14:05:51.690

就像 Deadlock 所说的，您可以使用 JavaScript 模态弹出窗口。有人举了一个例子[Here](https://stackoverflow.com/a/289028/1218040)。

您可以创建此弹出窗口，其中包含用于选择语言的按钮。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-28T14:17:23.673

回答如何使用[JavaScript](https://stackoverflow.com/questions/8199760/how-to-get-the-browser-language-using-java-script)获取浏览器语言。当您在问题标签中指定 PHP 时，请使用[PHP](https://stackoverflow.com/questions/3770513/detect-browser-language-in-php)回答。

# c# - 我错在哪里？动态创建标签 c#

> ID：15137199
> 
> 赞同：6
> 
> 时间：2013-02-28T13:50:01.247
> 
> 标签：c#, .net, oracle, runtime

我创建`labels`和`textboxes`动态 . 一切都很好，但第二个`label` 根本不想出现。我哪里错了？这是我在 C# 中的代码：

```
private void checkedListBox1_SelectedIndexChanged(object sender, EventArgs e)
{
    OracleDataReader reader;
    int x = 434;
    int y = 84;
    int i = 0;
    try
    {
        conn.Open();

        foreach (var itemChecked in checkedListBox1.CheckedItems)
        {
            Label NewLabel = new Label();
            NewLabel.Location = new Point(x + 100, y);
            NewLabel.Name = "Label" + i.ToString();
            Controls.Add(NewLabel);
            TextBox tb = new TextBox();
            tb.Location = new Point(x, y);
            tb.Name = "txtBox" + i.ToString();
            Controls.Add(tb);
            y += 30;
            OracleCommand cmd = new OracleCommand("SELECT distinct data_type from all_arguments where owner='HR' and argument_name='" + itemChecked.ToString() + "'", conn);

            reader = cmd.ExecuteReader();

            while (reader.Read())
            {
                label[0].Text = reader["data_type"].ToString();
            }

            i++;
        }
    }
    finally
    {
        if (conn != null)
            conn.Close();
    }
}

private void Procedure()
{
    string proc = "";
    try
    {
        conn.Open();

        if (this.listView1.SelectedItems.Count > 0)
            proc = listView1.SelectedItems[0].Text;

        OracleCommand cmd = new OracleCommand("" + proc + "", conn);
        cmd.CommandType = CommandType.StoredProcedure;
        cmd.CommandTimeout = 600;

        int i = 0;
        foreach (var itemChecked1 in checkedListBox1.Items)
        {
            Control[] txt = Controls.Find("txtBox" + i.ToString(), false);
            Control[] label = Controls.Find("Label" + i.ToString(), false);
            cmd.Parameters.Add(new OracleParameter("select distinct data_type from all_arguments where owner='HR' and argument_name=toupper("+itemChecked1.ToString()+")",conn));
            cmd.Parameters[":"+itemChecked1.ToString()+""].Value=label[0].Text;
            cmd.Parameters.Add(new OracleParameter(":" + itemChecked1.ToString() + "", OracleDbType.Varchar2));
            cmd.Parameters[":" + itemChecked1.ToString() + ""].Value = txt[0].Text;

            i++; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T14:15:54.300

我认为第二个标签已经出现。但它的文本是一个空字符串！所以你永远不会看到它。检查 DB 阅读器返回的“data_type”。

# javascript - Meteor 模板事件处理程序中“this”的上下文（使用 Handlebars 进行模板）

> ID：15137206
> 
> 赞同：42
> 
> 时间：2013-02-28T13:50:32.850
> 
> 标签：javascript, meteor, handlebars.js

关于 Meteor 中模板的事件处理程序上下文的快速问题（使用 Handlebars）。

*   在关于模板实例的文档部分 ( [http://docs.meteor.com/#template_inst](http://docs.meteor.com/#template_inst) ) 中提到“*模板实例对象在创建、渲染和销毁的模板回调中作为 this 的值找到，并且**作为事件处理程序的参数***“
*   在模板部分 ( [http://docs.meteor.com/#templates](http://docs.meteor.com/#templates) ) 它说“*最后，您可以在模板函数上使用事件声明来设置事件处理程序表。该格式记录在事件映射中。事件处理程序**的 this 参数**将是触发事件的元素的**数据上下文***。 ”

好吧，这只是部分正确。让我们使用文档中的一个示例：

```
<template name="scores">
  {{#each player}}
    {{> playerScore}}
  {{/each}}
</template>

<template name="playerScore">
  <div>{{name}}: {{score}}
    <span class="givePoints">Give points</span>
  </div>
</template
Template.playerScore.events({
  'click .givePoints': function () {
    Users.update({_id: this._id}, {$inc: {score: 2}});
  }); 
```

这里“click .givePoints”事件处理程序的“this”上下文确实是 playerScore 的模板实例。让我们修改html：

```
<template name="scores">
  <span class="click-me">Y U NO click me?<span>
  {{#each player}}
    {{> playerScore}}
  {{/each}}
</template>

<template name="playerScore">
  <div>{{name}}: {{score}}
    <span class="givePoints">Give points</span>
  </div>
</template> 
```

...并在分数模板上为 .click-me 添加事件处理程序：

```
Template.scores.events({
  'click .click-me': function () {
    console.log(this);
  }
}); 
```

现在，如果您单击跨度，您会记录什么？窗口对象！我期望得到什么？模板对象！或者可能是数据上下文，但两者都不是。然而，在回调内部（例如 Template.scores.rendered = function(){ ... }），“this”的上下文始终是模板实例。

我想我真正的问题是：这与

*   Handlebars、Meteor 或介于两者之间的某个错误？
*   模板上的文档稍微不完整？
*   我完全误解了文档或不了解 Meteor 或 Handlebars 的基本知识？

谢谢！

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2013-03-01T02:50:09.377

该视频解释了这些概念：

[http://www.eventedmind.com/posts/meteor-spark-data-annotation-and-data-contexts](http://www.eventedmind.com/posts/meteor-spark-data-annotation-and-data-contexts)。

直接回答你的问题：

事件处理程序中的 thisArg*应*指向数据上下文。但有时数据上下文是`undefined`. 当您`Function.prototype.call(thisArg, ...)`在 JavaScript 中使用时，如果 thisArg 未定义（例如 dataContext 未定义），浏览器将设置`this`为等于 window。因此，文档本身并没有*错*，但事件处理代码并没有防止数据上下文未定义的可能性。我猜这将在短期内修复。

那么，是什么产生了模板的数据上下文？通常，您的根模板甚至没有数据上下文。换句话说，模板函数在没有对象的情况下被调用。但是，如果您使用`{{#with`块助手或`{{#each`迭代器，将为列表中的每个项目创建数据上下文，或者在*使用*助手的情况下为对象创建数据上下文。

例子：

```
var context = {};

<template name="withHelper">
  {{#with context}}
    // data context is the context object
  {{/with}}
</template>

var list = [ {name: "one"}, {name: "two"} ];

<template name="list">
  {{#each list}}
    {{ > listItem }} // data context set to the list item object
  {{/each}}
</template> 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-02-28T16:23:57.417

函数中的第一个参数是事件。因此，您可以使用事件的目标来获取您的元素。

```
Template.scores.events({
  'click .click-me': function (event, template) {
    console.log(event.target);
    $(event.target).text("O but I did!");
  }
}); 
```

# android - 我可以在平均 iPhone/Android 中加载多少张精灵表？

> ID：15137212
> 
> 赞同：0
> 
> 时间：2013-02-28T13:50:58.827
> 
> 标签：android, iphone

我打算使用[gideros 引擎](http://www.giderosmobile.com/)制作一个游戏，看起来我需要大约 20 个精灵表（2048 х 2048）每个。

你认为，普通的 iPhone/Android 能够处理它吗？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-28T14:01:48.400

部分答案：

快速数学：（请注意，Android 中高质量的位图每个像素需要 4 个字节）

> > 2048 * 2048 * 20 * 4 = 335,54,320 字节 = 327mb！

所以，答案是：这真的取决于这个引擎如何使用这些精灵：

*   如果它是 dalvik 堆上的平面位图，它当然不能接受。
*   如果它是分配本机设备内存的 C++ 本机代码，它可能会工作，但仅适用于高端设备
*   如果它使用它自己的压缩东西并在本机内存分配中处理所有这些，它也可能工作。

# c# - Grid内的WPF ListView，滚动错误-ItemsControl与其项目源不一致

> ID：15137213
> 
> 赞同：1
> 
> 时间：2013-02-28T13:51:01.733
> 
> 标签：c#, wpf, listview

我有一个包含几百个项目的 ListView，如果我通过滚动条拇指上的鼠标快速向下滚动项目，我会收到此错误：

**ItemsControl 与其项目源不一致**

这是我的列表视图

```
<ListView x:Name="lv_emails"
        Grid.Row="0"
        Background="{x:Null}"
        BorderBrush="{x:Null}"
        BorderThickness="0"
        ScrollViewer.HorizontalScrollBarVisibility="Auto"
        ScrollViewer.VerticalScrollBarVisibility="Auto"
        SelectionChanged="lv_emails_SelectionChanged"
        SelectionMode="Single"> 
```

内容在 Window_Loaded 中加载，没有线程进行：

```
private void Window_Loaded(object sender, RoutedEventArgs e)
{
    emails = new List<eml>();
    lv_emails.ItemsSource = emails;

    // get the emails of the selected folder and show them in the ListView
    eml em;
    foreach (string fi in Directory.GetFiles(path))
    {
        string[] split = fi.Split('}');//[0]path, [1]uid, [2]email, [3]date, [4]subject
        string disp = split[2] + " " + split[3] + " " + split[4]; 
        em = new eml { filePath = fi, id = split[1], emailAddress = split[2], date = split[3], subject = split[4] };
        emails.Add(em);
    }
} 
```

我怎样才能停止这个错误，为什么会发生？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-28T23:05:27.047

You are setting the ListView's ItemSource to an empty List.

Move the line `lv_emails.ItemsSource = emails;` to after your loop.

Alternatively you could bind to the proper collection type as I mentioned in my comment.

# arm - 如何在 ARM 架构上从 RAM 运行代码

> ID：15137214
> 
> 赞同：9
> 
> 时间：2013-02-28T13:51:02.737
> 
> 标签：arm

我正在编写一个 ARM Cortex-R4，我有一些二进制文件，我想从 TCRAM 执行它们，只是为了看看性能的提高是否足够好。

我知道我必须编写一个函数来将二进制文件复制到 RAM（这可以通过链接描述文件完成，并且知道二进制文件的大小）。但是他们会怎么跑呢？

想象一下：第一个二进制文件有 func1()、func2()、func3() 和 func4()。我将整个模块复制到 TCRAM，我将如何在那里调用函数？我必须使用指向该特定函数的函数指针吗？如果 func4() 调用 func2() 和 func3() 会怎样？如果我没记错的话，他们会指向闪存中的一段代码。这是否意味着我必须重新编写那些函数？完全使用函数指针？有人告诉我，仅链接描述文件就足以完成所有这些工作，我无需担心任何事情，但我仍然不明白它是如何工作的。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2014-08-28T19:59:31.953

在 GCC 上：只需将函数放在 .data 部分：

```
__attribute__( ( section(".data") ) ) 
```

它将被启动代码与您初始化的其余变量一起复制（无需弄乱链接器脚本）。如果函数在放入 RAM 后与其余代码“相距甚远”，您可能还需要一个“long_call”选项。

```
__attribute__( ( long_call, section(".data") ) ) 
```

例子：

```
__attribute__( ( long_call, section(".data") ) ) void ram_foobar (void) { ... } 
```

您可能会收到可以安全忽略的编译器警告：

```
Warning: ignoring changed section attributes for .data 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-28T17:51:13.143

你有两个选择。

1.  按照你的建议复制它们，用`pc relative`.
2.  使用具有不同加载/运行地址的链接器文件。

**只有当例程不使用任何绝对地址**时，一个简单的副本才会起作用。如果他们确实使用**绝对地址**可能没问题，因为我猜你会在标准 RAM 中留下一个副本。但是，这可能无法获得`TCM`.

使用链接描述文件，您可以指定不同的`LOAD`位置`RUN`。

```
sections {
 .text { *(.text); } >FLASH
 .tcm {
       *(.tcm);
  } >TCM_MEM AT>FLASH
  .data { *(.data); } > RAM
  .bss : NOLOAD { *(.bss); } > RAM
} 
```

特别注意`AT>FLASH`。

另请参阅：[gnu 链接器映射文件...以及有关](https://stackoverflow.com/questions/14453996/gnu-linker-map-file-giving-unexpected-load-addresses)*stackoverflow*的更多内容。[Gnu Ld 手册](http://sourceware.org/binutils/docs/ld/Output-Section-LMA.html)包含有关部分的信息`LMA`（**加载**地址）。您`LMA`将是*flash*，但`VMA`（**RUN**地址）将是**TCM**。上面的手动链接还显示了如何复制。、和使用 ld [MEMORY](http://sourceware.org/binutils/docs/ld/MEMORY.html)`RAM`信息定义，具体取决于您的板的地址。所有这些都将记录在一个文件中。请务必生成一个文件并检查地址以仔细检查您的脚本。`FLASH``TCM_MEM``MAP``MAP``ld`

第二种情况还需要一份副本（在启动时或至少在第一次`TCM`使用功能之前）。但是，编译器可以使用**绝对地址**，它们将在`TCM`内存中。main 中的任何函数`DRAM`也可以直接调用该`TCM`函数。对于第一种情况，您必须使用函数指针来调用`TCM`代码。如果您希望将**全局**变量放置在此内存中，您可以使用属性将它们放在不同的部分中，并使用*gnu ld*适当地放置它们。我认为有`ITCM`和`DTCM`？所以也许这不适用于你，或者你需要两个部分。

链接描述文件更通用，如果您将复杂的功能放在`TCM`. 仅使用`-fpic`, etc 和复制可能会使事情快速运行，尤其是在您只有一个`pure`功能的情况下。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2018-08-20T06:09:56.807

现在（当时也是？）你可以只使用宏`__RAM_FUNC`，`__RAMFUNC_EXT(bank, name)`或者`__RAMFUNC(bank)`

# typescript - TypeScript 中的重复声明

> ID：15137219
> 
> 赞同：2
> 
> 时间：2013-02-28T13:51:15.657
> 
> 标签：typescript

考虑这段代码：

```
var a = [];

for (var i in a)
  /* nothing */;

var i : number;

i = 9; 
```

如果我编译它，编译器会抱怨最后一行，说“无法将'数字'转换为'字符串'”。

大概是作为字符串创建的 for..in 循环`i`，但我希望编译器会抱怨`var i : number`而不是等到`i = 9`它抱怨之前。

如果我更改`var i : number`为`var i : number = 8`，编译器在达到`i = 9`.

这是一个错误，还是我错过了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-28T14:10:29.460

如果您最初声明了变量，它会警告您预测的位置。例如，如果您将此行放在代码的顶部：

```
var i: string; 
```

它会警告您该行有重复的标识符：

```
var i: number; 
```

当您在 for 语句中声明时，它不会检测到重复的标识符`i`，也许它应该检测到 - 所以您最终会遇到不同的错误，即当您分配错误类型的值时。

如果您想要重复标识符警告，这是这里的第一个也是最重要的错误，最好的办法是在[http://typescript.codeplex.com/上记录错误](http://typescript.codeplex.com/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T14:11:45.510

这不是错误，要了解发生了什么，您必须了解 JavaScript 的行为方式，尤其是在有关提升的区域周围。本质上，您上面的代码与以下代码相同：

```
var a = [],
    i;

for (i in a)
  /* nothing */;

i = 9; 
```

由于`i`在您的 for 语句中第一次遇到，它的类型正在变成一个字符串。`for (key: string in someVar) { }`.

这是一篇描述 JavaScript 中的提升和作用域的文章：http: [//www.adequatelygood.com/2010/2/JavaScript-Scoping-and-Hoisting](http://www.adequatelygood.com/2010/2/JavaScript-Scoping-and-Hoisting)

# binaryfiles - 如何查看 .DAT 文件？

> ID：15137223
> 
> 赞同：-3
> 
> 时间：2013-02-28T13:51:26.017
> 
> 标签：binaryfiles

当 .DAT 文件由您不知道的任意程序创建时，打开/读取该文件有哪些策略？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T13:56:45.367

对二进制文件使用十六进制查看器。从 sourceforge 获取一个免费的。

由于字符集编码，文本编辑器不是一个好主意。

# php - 使用 PHP 和 jQuery 预取内部页面

> ID：15137224
> 
> 赞同：0
> 
> 时间：2013-02-28T13:51:29.087
> 
> 标签：php, jquery, ajax, modx-revolution, prefetch

我正在尝试为我正在构建的 ModX Revo 网站构建自己的预取器。

我现在`Syntax Error`上`<script type="text/javascript">`线了

我怎样才能让它正常工作？

我将它包含在我的页面/模板中`<script type="text/javascript" src="/prefetcher.php"></script>`

这是代码：

```
<?php

header('Content-Type: text/javascript');

require_once($_SERVER['DOCUMENT_ROOT'] . '/assets/php/m.inc.php');

//if(!@$_SESSION['AlreadyPrefetched']){
    $sql = "Select `pagetitle`, `longTitle`, `uri` From `modx_site_content` 
            Where `type` = 'document' And `published` = 1 AND 
            (`uri` <> 'portfolio/item' And `uri` <> 'error-page-401' And `uri` <> 'sitemap.xml' And `uri` <> 'error-page-404' And 
            `uri` <> 'error-page-other' And `uri` <> 'index')";
    $qry = $modx->query($sql);
    $rows = $qry->fetchAll(PDO::FETCH_ASSOC);
    $rCt = count($rows);
    if($rCt > 0){
        $_SESSION['AlreadyPrefetched'] = true;
        echo '<script type="text/javascript">
                $(window).on("load", function(){
                    alert("Prefetch Active");';
                for($i = 0; $i < $rCt; ++$i){
                    echo '      $.ajax({ url:"/'. $rows[$i]['uri'] .'", cache:true, dataType:"text", success:function(){}, error:function(){} });';
                }
        echo '  });
            </script>';
    }   

    unset($rows);
//}
?> 
```

观察 FireBug，对 prefetch.php 的请求以正确的内容类型返回...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T13:53:11.727

您正在输出`<script type="text/javascript">`两次。在您的 HTML 中，您有`<script type="text/javascript" src="/prefetcher.php"></script>`并且从 prefetcher.php 内部，您再次回显`<script type="text/javascript">`. 您需要从 PHP 文件中取出脚本标签。

# kendo-ui - Kendo UI Grid 未从数据源加载数据

> ID：15137227
> 
> 赞同：2
> 
> 时间：2013-02-28T13:51:35.390
> 
> 标签：kendo-ui, observable, kendo-grid

我是剑道 UI 框架的新手。我正在使用 kendoGrid 处理可观察的数据源。问题是表已创建但数据为空。这是链接[http://jsfiddle.net/praveeny1986/Pf3TQ/5/](http://jsfiddle.net/praveeny1986/Pf3TQ/5/)

和代码：

```
var gridDataModel = kendo.data.Model.define({
fields: {
    "Product": {
        type: "string"
    },
    "Domain": {
        type: "string"
    },
    "PercentPlan": {
        type: "string"
    },
    "CWV": {
        type: "string"
    },
    "Target": {
        type: "string"
    },
    "Accuracy": {
        type: "string"
    }
}
});

var dataSource = new kendo.data.DataSource({data: tabledata1});

var gridModel = kendo.observable({
    gridData: dataSource
});
kendo.bind($("#chart"),gridModel);
$("#chart").kendoGrid({
    scrollable:false,
dataSource:gridModel.get('gridData'),
    height:600,
    autoBind:true,
    columns:[
        {
            field: "Product",
            title: "Product"
        },
        {
            field: "Domain",
            title: "Sales Domain"
        },
        {
            field: "PercentPlan",
            title: "% to Plan"
        },
        {
            field: "CWV",
            title: "CWV"
        },
        {
            field: "Target",
            title: "Target"
        },
        {
            field: "Accuracy",
            title: "Accuracy"
        }]
});
var tabledata1 = [
{
    Product:"mobile",
    Domain:"SMARTPHONES-EAST",
    PercentPlan:"95",
    CWV:"160",
    Target:"200",
    Accuracy:"9"
},
{
    Product:"mobile",
    Domain:2,
    PercentPlan:"80",
    CWV:"160",
    Target:"200",
    Accuracy:"8.5"
},
{
    Product:"mobile",
    Domain:3,
    PercentPlan:"75",
    CWV:"150",
    Target:"200",
    Accuracy:"8"
},
{
    Product:"mobile",
    Domain:4,
    PercentPlan:"60",
    CWV:"120",
    Target:"200",
    Accuracy:"6"
},
{
    Product:"mobile",
    Domain:5,
    PercentPlan:"50",
    CWV:"150",
    Target:"300",
    Accuracy:"5"
}
]; 
```

请建议我做错了什么？

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-28T14:08:26.260

在您创建和绑定数据源时，您的表数据是未定义的。

```
var dataSource = new kendo.data.DataSource({data: tabledata1});
var tabledata1 = [ ... ]; 
```

将 tabledata1 的声明移到创建数据源之前。看到这个更新的小提琴。

[http://jsfiddle.net/nukefusion/Pf3TQ/7/](http://jsfiddle.net/nukefusion/Pf3TQ/7/)

# outlook-addin - 如何在约会和会议窗口中找到共享日历的所有者？

> ID：15137233
> 
> 赞同：0
> 
> 时间：2013-02-28T13:51:50.823
> 
> 标签：outlook-addin, outlook-2007, outlook-2010

约会项目或会议项目中没有字段可以确定我正在访问的当前日历是共享日历还是我自己的日历文件夹？

我怎么得到这个？Outlook对象模型中有没有办法得到这个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T15:32:08.977

您可以访问`meetingItem.Parent.StoreId`（我相信不是 AppointmentItem）。然后你得到的是一个 HexId 字符串，如果转换为纯文本字符串，则在后面包含 MS Exchange 帐户名称`/cn=`（我认为在字符串的末尾）。

有了这个名字，你可以做一个`CreateRecipient(thatName)`和`Outlook.Recipient.Resolve()`它。之后，您可以使用 recipient.Name 访问帐户的名称

抱歉，我试图在这个答案中粘贴代码，但它没有按预期工作并且花费了太长时间。请询问您是否需要更多路线。

# android - 操作栏中的选项卡项宽度 (Android)

> ID：15137235
> 
> 赞同：4
> 
> 时间：2013-02-28T13:51:55.937
> 
> 标签：android, android-actionbar

我在 Activity 中使用 12 个选项卡，在操作栏中*（目标是 API 17，在 Galaxy Nexus 4.2.2 上测试）*。

正如预期的那样，我在我的操作栏下得到了一个水平滚动的选项卡列表。在下面的屏幕截图中，您可以看到最后一个选项卡（右侧的 B）明显小于其他选项卡*（不要考虑“E”选项卡，它可以滚动，因为上面还有 4 个选项卡左边）*。

你可以从蓝色的光芒中看到，没有什么可以滚动的了。我正在使用默认的 Theme.Holo.Light.DarkActionbar，还没有任何自定义视图。

为什么最后一个标签比另一个小？以及如何确保它与其他宽度相同？

![一个标签比其他标签小](../Images/114cbf2fc9dc4e90d48325ca9d1eddc1.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-15T18:32:14.947

事实上，我遇到了同样的问题，我发现的唯一解决方法是禁用选项卡之间的分隔符。看起来本机操作栏中存在一个错误，在测量标签栏容器时不考虑分隔线的大小。

```
<style name="actionBarTabBarStyle" parent="@style/Widget.Sherlock.Light.ActionBar.TabBar">
        <item name="android:showDividers">none</item>
</style> 
```

（这里我使用的是 actionbarsherlock，但这不是问题的根源，您可以从 parent="@android:style/Widget.Holo.ActionBar.TabBar" 扩展您的样式）

并将其应用到您的主题中：

```
<item name="android:actionBarTabBarStyle">@style/actionBarTabBarStyle</item> 
```

如果您绝对需要 actionBar 分隔符，一种简单的解决方案可能是将其直接添加到选项卡背景（左侧或右侧）

# hadoop - 在 ubuntu 12.04lts 上安装 hadoop 时出现 start-all.sh 错误

> ID：15137238
> 
> 赞同：0
> 
> 时间：2013-02-28T13:52:03.227
> 
> 标签：hadoop, failed-installation

我一直在参考[这个链接](http://www.michael-noll.com/tutorials/running-hadoop-on-ubuntu-linux-single-node-cluster/)进行**hadoop-1.1.1 安装**。

我的所有文件和权限都已根据此链接设置。但我收到了这个错误。请帮忙。

> hduser@ubuntu:/usr/local/hadoop$ bin/start-all.sh mkdir: 无法创建目录`/usr/local/hadoop/libexec/../logs': Permission denied chown: cannot access`/usr/local/hadoop/libexec/../logs': 没有这样的文件或目录启动namenode，登录到/usr /local/hadoop/libexec/../logs/hadoop-hduser-namenode-ubuntu.out /usr/local/hadoop/bin/hadoop-daemon.sh：第 136 行：/usr/local/hadoop/libexec/.. /logs/hadoop-hduser-namenode-ubuntu.out：没有这样的文件或目录头：无法打开 `/usr/local/hadoop/libexec/../logs/hadoop-hduser-namenode-ubuntu.out' for reading: No such file or directory localhost: mkdir: cannot create directory`/usr/local/hadoop/libexec/../logs'：权限被拒绝 localhost：chown：无法访问`/usr/local/hadoop/libexec/../logs': No such file or directory localhost: starting datanode, logging to /usr/local/hadoop/libexec/../logs/hadoop-hduser-datanode-ubuntu.out localhost: /usr/local/hadoop/bin/hadoop-daemon.sh: line 136: /usr/local/hadoop/libexec/../logs/hadoop-hduser-datanode-ubuntu.out: No such file or directory localhost: head: cannot open` /usr/local/ hadoop/libexec/../logs/hadoop-hduser-datanode-ubuntu.out' 用于阅读：没有这样的文件或目录 localhost：mkdir：无法创建目录`/usr/local/hadoop/libexec/../logs': Permission denied localhost: chown: cannot access`/usr/local/hadoop/libexec/../logs'：没有这样的文件或目录localhost：启动secondarynamenode，登录到/usr/local/hadoop/libexec/../logs/hadoop-hduser-secondarynamenode-ubuntu.out本地主机：/usr/local/hadoop/bin/hadoop-daemon.sh：第 136 行：/usr/local/hadoop/libexec/../logs/hadoop-hduser-secondarynamenode-ubuntu.out：没有这样的文件或目录本地主机：头：无法打开 `/usr/local/hadoop/libexec/../logs/hadoop-hduser-secondarynamenode-ubuntu.out' for reading: No such file or directory mkdir: cannot create directory` /usr/local/hadoop/libexec/../logs'：权限被拒绝chown：无法访问`/usr/local/hadoop/libexec/../logs': No such file or directory starting jobtracker, logging to /usr/local/hadoop/libexec/../logs/hadoop-hduser-jobtracker-ubuntu.out /usr/local/hadoop/bin/hadoop-daemon.sh: line 136: /usr/local/hadoop/libexec/../logs/hadoop-hduser-jobtracker-ubuntu.out: No such file or directory head: cannot open` /usr/local/hadoop/libexec/../logs/hadoop-hduser-jobtracker-ubuntu.out'阅读：没有这样的文件或目录 localhost：mkdir：无法创建目录`/usr/local/hadoop/libexec/../logs': Permission denied localhost: chown: cannot access`/usr/local/hadoop/libexec/../logs'：没有这样的文件或目录本地主机：启动tasktracker，登录到/usr/local/hadoop/libexec/../logs/hadoop-hduser-tasktracker-ubuntu.out本地主机：/usr/local/hadoop/bin/hadoop-daemon.sh：第 136 行：/usr/local/hadoop/libexec/../logs/hadoop-hduser-tasktracker-ubuntu.out：没有这样的文件或目录本地主机：头：无法打开`/usr/local/hadoop/libexec/../logs/hadoop-hduser-tasktracker-ubuntu.out'进行阅读：没有这样的文件或目录

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-11-30T23:30:15.213

由于错误表明您遇到了权限问题。你需要给 hduser 适当的权限。尝试：

```
sudo chown -R hduser /usr/local/hadoop/ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-02-08T12:51:16.103

以下是 2 条非常有用的建议：

1.  最好检查一下 .bashrc 文件中是否设置了 HADOOP_HOME 和 JAVA_HOME。有时，不设置这些环境变量也可能在启动 hadoop 集群时导致错误。

2.  通过查看 /usr/local/hadoop/logs 目录中生成的日志文件来调试错误也很有用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-12T20:09:20.767

运行此命令更改hadoop目录的权限

> sudo chmod 750 /app/hadoop

# web-services - 授权和构建 RESTful 后端的正确方法是什么

> ID：15137244
> 
> 赞同：7
> 
> 时间：2013-02-28T13:52:35.667
> 
> 标签：web-services, api, rest, authorization, restful-authentication

很多关于 RESTful Web 服务的例子都没有考虑到当今许多应用程序都是多用户的问题。

想象一个**公开 RESTful API 的多用户后端**。后端数据架构使用共享数据库和共享模式。每个表都将包含对 a 的引用`tenant_id`：

```
+-------------+----+-----------------+
|  tenant_name| id |   shared_secret |
+-------------+----+-----------------+
|         bob |  1 |   2737sm45sx543 |
+-------------+----+-----------------+
|       alice |  2 |   2190sl39sa8da |
+-------------+----+-----------------+

+-------------+----+-------+-----------+
|    pet_name | id |  type | tenant_id |
+-------------+----+-------+-----------+
|       fuffy |  1 |   dog |         1 |
+-------------+----+-------+-----------+
|       kerry |  2 |   cat |         2 |
+-------------+----+-------+-----------+ 
```

**问题 1**：**三个或更多客户端应用程序（即 Android、iOS 和 Web App）与 RESTful 后端交互，**您将如何针对后端执行身份验证？

```
RESTful backend, API, HTTP-Verbs, shared database and schema 
|
|
+---- Web Application (Client 1)
|     |
|     + Alice
|     |
|     + Bob
|
+---- Android Application (Client 2)
|     |
|     + Alice
|     |
|     + Bob
|
+---- iOS Application (Client 3)
|     |
|     + Alice
|     |
|     + Bob
| 
```

每个客户都应该允许 Alice 和 Bob 管理她/他的宠物。每个客户端都是一个 GUI，它将使用（在内部，发出 HTTP 请求）后端。问题：每个客户端如何才能对后端进行身份验证？

假设 HMAC（它完全是 RESTful，没有会话）：此方法涉及使用共享密钥对有效负载进行签名（从不通过网络发送）。每个客户是否应该拥有自己的`tenant`表格副本（包含该`shared_secret`字段）？

```
Android App -> Client Sign -> Signed Request -> Backend -> Result
    Web App -> Client Sign -> Signed Request -> Backend -> Result 
```

**问题 2**：资源 URI 应该是什么样的？

以下是获取 Bob 宠物的两种可能性：

可能性 #1：`Authorization`标题为您提供租户的（唯一）名称：

```
GET /pets HTTP/1.1
Host: www.example.org
Authorization: bob:c29kYW9kYSBhb2lzYWRoIGYgZDUzNDUz 
```

可能性 #2。作为`tenant_id`查询参数发送：

```
GET /pets/tenant_id=1 HTTP/1.1
Host: www.example.org
Authorization: bob:c29kYW9kYSBhb2lzYWRoIGYgZDUzNDUz 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-08T03:01:06.993

**第1部分**

*（大声思考：您是否已经决定使用 HTTP 和 HMAC？如果是，您为什么要问我们？）*

我建议使用带有基本身份验证的 HTTPS。简单的。毕竟对于[Stripe](https://stripe.com/docs/api)来说已经足够好了。

参考：

*   [保护 API：SSL 和 HTTP 基本身份验证与签名](https://stackoverflow.com/questions/5511589/securing-an-api-ssl-http-basic-authentication-vs-signature)
*   有关 HMAC 与替代方案的良好比较，请参阅[什么是 HMAC 身份验证以及它为什么有用？](http://wolfe.id.au/2012/10/20/what-is-hmac-and-why-is-it-useful/)
*   [AviD 就“如果通过 HTTPS 完成 BASIC-Auth 安全吗？”](https://security.stackexchange.com/a/990)指出了一个警告。“SSL 只保护网络服务器 - 任何内部路由、服务器日志记录等都将看到明文密码。”

**更新**：以下是有关如何处理身份验证的一些其他详细信息：

1.  每个客户端应用程序都将使用 API 密钥联系服务。使用 HTTPS 和基本身份验证，客户端将提供其 API 密钥作为基本身份验证用户名。它不需要提供密码，因为它使用的是 HTTPS。您需要为每个应用程序（Web 应用程序、Android、iOS）分配一个 API 密钥，我看到两种方法：

    A. 一种选择是为每个用户提供一个跨客户端共享的 API 密钥。

    B. 另一种选择是为每个客户提供一个独特的应用程序。）

2.  但是，您首先如何获得客户的钥匙呢？构建“密钥请求”API 端点。我建议给每个客户端一个“starter”键，它只用于联系这个端点。（启动密钥不授予其他访问权限。）当用户第一次使用客户端时，他/她必须进行身份验证。客户端将此传递给“密钥请求”端点，以便它可以生成与用户关联的密钥。从那时起，每个客户端都有一个客户端绑定的 API 密钥。

**第2部分**

考虑给每个租户一个子域。如果您使用 Rails（或任何现代 Web 堆栈），您可以使用子域来查找租户 ID。然后你的 API 可以这样使用：

```
GET http://tenant1.app.co/pets
GET http://tenant2.app.co/pets
GET http://tenant3.app.co/pets 
```

参考资料（特定于 Rails，但应该对 Web 堆栈有所帮助）：

*   [在 Rails 中编写多租户应用程序](http://aac2009.confreaks.com/06-feb-2009-14-30-writing-multi-tenant-applications-in-rails-guy-naor.html)
*   [向 Rails 应用程序添加多租户：acts_as_tenant](http://www.rollcallapp.com/blog/2011/10/03/adding-multi-tenancy-to-your-rails-app-acts-as-tenant)
*   [Rails 中的多租户](http://www.slideshare.net/tardate/multitenancy-with-rails)

注意：正如您的示例所示，为简单起见，我不会为不同的租户重复使用相同的宠物 ID。例如，以下是一个简单的方法：

```
GET http://tenant1.app.co/pets/200
GET http://tenant2.app.co/pets/201
GET http://tenant3.app.co/pets/202 
```

我描述的方法比`tenant_id`作为查询参数传递要干净得多。此外，使用`tenant_id`作为参数感觉不对。正如我在 Ruby 和 Richardson 的“RESTful Web Services”中所读到的，我喜欢将参数用于更多“算法”的东西。

参考：

*   [多租户数据库架构——第 5 部分](http://iablog.sybase.com/kleisath/index.php/2009/11/multi-tenant-database-architecture-part-5/)
*   “如果查询字符串参数是作为算法的资源的输入，则它们是合适的，否则，这些值应移动到 URI 中”- [Wikipedia 上的面向资源的体系结构](http://en.wikipedia.org/wiki/Resource-oriented_architecture)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-04T17:03:33.170

您所说的“多租户”是指应用程序/Web 服务用户吗？多租户通常意味着更复杂的东西[msdn.microsoft.com/en-us/library/aa479086.aspx](http://msdn.microsoft.com/en-us/library/aa479086.aspx)。

您需要使用您的 Web 服务对每个用户进行身份验证。这可以通过 SSL 上的基本 http 身份验证来完成。

从 Web 服务的角度来看，您将对所有三个客户端执行相同的身份验证。该服务不关心客户的类型 - 这就是重点。您可能需要为您的客户端提供不同的表示形式，例如 XHTML 或 JSON。我喜欢保持简单，总是选择 JSON。

对于资源，管理它们的最简单方法是将用户资源作为顶层，然后为每个用户将所有资源链接在一起，例如

```
GET users/fred/pets - returns all pets for user fred
GET users/fred/pets/sparky - returns details on freds pet sparky 
```

这样做的好处是您可以添加代码来授权每个请求，例如您可能有两个用户，fred 和 jack。两个用户都将通过身份验证，但您应该只允许 fred 请求他的资源，而让 jack 请求他的资源。您只需在您的 api 中添加授权检查，例如从 URI 获取用户名，获取经过身份验证的用户的用户名，检查它们是否相同。如果不返回类似 http 403 禁止的内容，如果它们相同，则允许请求。

我认为如果您仍然不清楚，您需要阅读 REST 的详细信息。到目前为止，关于这个主题的最好的书是这本[RESTful Web Services](http://shop.oreilly.com/product/9780596529260.do)。它从第一原则涵盖了 REST。它也有一个非常好的部分关于设计资源，以及如何管理用户和多个客户端。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-04T19:04:09.467

我不确定是否理解这个问题，因为在这种情况下，多租户似乎有点矫枉过正。但是我可以尝试回答第二个问题。

REST 是一种“基于资源”的架构，您必须意识到这一点`/pets`并且`/pets/?tenant=1`不引用相同的资源：

*   `/pets`指当前用户的宠物，
*   `/pets/?tenant=1`指鲍勃的宠物。

虽然两种解决方案都没有错，但通常最好获得第二种解决方案。URI 确实是为共享而设计的，与每个用户不同的抽象“我的宠物”相比，您有更多理由分享“鲍勃的宠物”（即使它需要身份验证和授权来表示）。

请参阅[URL 中是否应该存在资源 ID？](https://stackoverflow.com/questions/14135974/should-resource-ids-be-present-in-urls/14136287)进行类似的讨论...

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-08T02:42:01.853

如果 HTTP 是所有 3 种客户端类型都使用的协议，**那么您应该只需要实现一种身份验证方案**。您可以选择毒药 - [Basic](http://en.wikipedia.org/wiki/Basic_access_authentication)、[Digest](http://en.wikipedia.org/wiki/Digest_access_authentication)、[Oauth2](http://oauth.net/2/)或[Cookie](https://stackoverflow.com/questions/319530/restful-authentication)是一些常用的方法。由于它通过 HTTP，我认为没有理由复制此逻辑。根据您的平台，可能有几个框架会为您抽象这个。

**要区分客户端类型，可以使用 HTTP 标头**。`user-agent`可能已经使这成为可能。另一种选择是使用您定义的自定义标题。任何 HTTP 客户端都可以设置标头，任何服务器都可以处理自定义标头。一个体面的 Web 框架将使您可以相对轻松地使用这些框架。作为后端服务，我怀疑您会希望统一处理所有客户端请求 - 或尽可能多地处理。当然，**维护一个后端优于三个**。

至于你的 API 应该是什么样子 - 这完全取决于你。为了保持 RESTful，[如何获得一杯咖啡](http://www.infoq.com/articles/webber-rest-workflow)非常值得阅读 - 插入[Roy Fielding 论文的](http://www.ics.uci.edu/~fielding/pubs/dissertation/fielding_dissertation.pdf)必填链接。很有可能，您真正需要的是编写“资源丰富”链接的指南。

`/pets?userId=bob`在您列出的选项中，如果用户可能需要访问系统中的所有宠物，则更喜欢第二个选项。`/pets`如果用户只需要访问他们的宠物，则更喜欢第一个。

# android - getSystemService() 是如何工作的？

> ID：15137247
> 
> 赞同：27
> 
> 时间：2013-02-28T13:52:39.793
> 
> 标签：android, locationmanager

乍一看，在下面的代码中，`mLocationManager`对象在完成后应该超出范围`onCreate(...)`，并且预期的行为是`onLocationChanged`在对象被垃圾收集之前永远不会被调用或调用几次。然而，返回的对象`getSystemService`似乎是单例，它超出了范围`MainActivity`（因为它是一个系统服务:)）

在使用 Eclipse 内存分析器进行堆转储并通过它之后，似乎 ContextImpl 保留了对 LocationManager 实例的引用。在内存转储中有两个对 LocationManager 对象的引用，而在代码中显然只有一个，这意味着在其他地方创建了另一个引用。

我的问题是：

在调用以下实现时，是否有人对到底发生了什么有完整的描述：

```
public abstract Object getSystemService(String name); 
```

对象是否返回了一个懒惰地创建的单例，引用创建/保留的确切位置在哪里？

```
package com.neusoft.bump.client.storage;

import android.location.Location;
import android.location.LocationListener;
import android.location.LocationManager;
import android.os.Bundle;
import android.app.Activity;
import android.content.Context;
import android.util.Log;
import android.view.Menu;

public class MainActivity extends Activity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        Log.v("TAG", "STARTED");
        LocationManager mLocationManager = (LocationManager) this
                .getSystemService(Context.LOCATION_SERVICE);

        LocationListener locationListener = new LocationListener() {

            public void onLocationChanged(Location location) {
                Log.v("TAG", "onLocationChanged");
                Log.v("TAG", "Latitude: " + location.getLatitude()
                        + "Longitude: " + location.getLongitude());
            }

            public void onStatusChanged(String provider, int status,
                    Bundle extras) {}

            public void onProviderEnabled(String provider) {}

            public void onProviderDisabled(String provider) {}

        };

        // Register the listener with the Location Manager to receive location
        // updates
        mLocationManager.requestLocationUpdates(LocationManager.GPS_PROVIDER,
                600, 0, locationListener);
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        // Inflate the menu; this adds items to the action bar if it is present
        getMenuInflater().inflate(R.menu.activity_main, menu);
        return true;
    }
} 
```

**更新1**

被`LocationManager`创建为单例

```
private LocationManager getLocationManager() {
    synchronized (sSync) {
        if (sLocationManager == null) {
            IBinder b = ServiceManager.getService(LOCATION_SERVICE);
            ILocationManager service = ILocationManager.Stub.asInterface(b);
            sLocationManager = new LocationManager(service);
        }
    }
    return sLocationManager;
} 
```

`ServiceManager.getService(LOCATION_SERVICE);`但即使在阅读`ServiceManager`代码后，我也无法理解调用时会发生什么。

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2013-11-12T09:37:08.550

看看我的讨论是否有意义...

[android服务内部剖析](https://docs.google.com/document/d/10EYlyuxDw1KPy7LJlGtgMz69gwMO-pjDHS2GRtppvZg/edit?usp=sharing)

正如一位读者所建议的那样，我试图在这里复制部分文章。

你有没有想过一个应用程序如何获得系统服务的句柄，如 POWER MANAGER 或 ACTIVITY MANAGER 或 LOCATION MANAGER 以及其他几个类似的服务。要知道我深入研究了 Android 的源代码并发现了这是如何在内部完成的。那么让我从应用程序端的java代码开始。

在应用程序端，我们必须调用该函数`getService`并传递系统服务的 ID（比如 POWER_SERVICE）来获取服务的句柄。

这是`getService`/frameworks/base/core/java/android/os/ServiceManager.java 中定义的代码

```
 /**
44     * Returns a reference to a service with the given name.
45     *
46     * @param name the name of the service to get
47     * @return a reference to the service, or <code>null</code> if the service doesn't exist
48     */
49    public static IBinder getService(String name) {
50        try {
51            IBinder service = sCache.get(name);
52            if (service != null) {
53                return service;
54            } else {
55                return getIServiceManager().getService(name);
56            }
57        } catch (RemoteException e) {
58            Log.e(TAG, "error in getService", e);
59        }
60        return null;
61    } 
```

假设我们在缓存中没有服务。因此我们需要专注于第 55 行 `return getIServiceManager().getService(name);`

这个调用实际上获得了服务管理器的句柄，并要求它返回我们作为参数传递的名称的服务的引用。

现在让我们看看该`getIServiceManager()`函数如何将句柄返回给 ServiceManager。

这是 /frameworks/base/core/java/android/os/ServiceManager.java 中的 getIserviceManager() 的代码

```
private static IServiceManager getIServiceManager() {
34        if (sServiceManager != null) {
35            return sServiceManager;
36        }
37
38        // Find the service manager
39        sServiceManager = ServiceManagerNative.asInterface(BinderInternal.getContextObject());
40        return sServiceManager;
41    } 
```

ServicemanagerNative.asInterface() 如下所示：

```
/**
28     * Cast a Binder object into a service manager interface, generating
29     * a proxy if needed.
30     */
31    static public IServiceManager asInterface(IBinder obj)
32    {
33        if (obj == null) {
34            return null;
35        }
36        IServiceManager in =
37            (IServiceManager)obj.queryLocalInterface(descriptor);
38        if (in != null) {
39            return in;
40        }
41
42        return new ServiceManagerProxy(obj);
43    } 
```

所以基本上我们得到了本地服务管理器的句柄。

这个asInterface函数其实是埋在两个宏里面，`DECLARE_META_INTERFACE(ServiceManager)`分别`IMPLEMENT_META_INTERFACE(ServiceManager, "android.os.IServiceManager");` 定义在IserviceManager.h和IServiceManager.cpp中。

让我们深入研究 /frameworks/base/include/binder/IInterface.h 中定义的两个宏

`DECLARE_META_INTERFACE(ServiceManager)`宏定义为

```
// ----------------------------------------------------------------------
73
74#define DECLARE_META_INTERFACE(INTERFACE)                               \
75    static const android::String16 descriptor;                          \
76    static android::sp<I##INTERFACE> asInterface(                       \
77            const android::sp<android::IBinder>& obj);                  \
78    virtual const android::String16& getInterfaceDescriptor() const;    \
79    I##INTERFACE();                                                     \
80    virtual ~I##INTERFACE();                                            \ 
```

并且`IMPLEMENT_META_INTERFACE(ServiceManager, "android.os.IServiceManager");`定义如下：

```
#define IMPLEMENT_META_INTERFACE(INTERFACE, NAME)                       \
84    const android::String16 I##INTERFACE::descriptor(NAME);             \
85    const android::String16&                                            \
86            I##INTERFACE::getInterfaceDescriptor() const {              \
87        return I##INTERFACE::descriptor;                                \
88    }                                                                   \
89    android::sp<I##INTERFACE> I##INTERFACE::asInterface(                \
90            const android::sp<android::IBinder>& obj)                   \
91    {                                                                   \
92        android::sp<I##INTERFACE> intr;                                 \
93        if (obj != NULL) {                                              \
94            intr = static_cast<I##INTERFACE*>(                          \
95                obj->queryLocalInterface(                               \
96                        I##INTERFACE::descriptor).get());               \
97            if (intr == NULL) {                                         \
98                intr = new Bp##INTERFACE(obj);                          \
99            }                                                           \
100        }                                                               \
101        return intr;                                                    \
102    }                                                                   \
103    I##INTERFACE::I##INTERFACE() { }                                    \
104    I##INTERFACE::~I##INTERFACE() { } 
```

因此，如果我们用适当的替换参数替换扩展 IServiceManager.h 和 IServiceManager.cpp 文件中的这两个宏，它们如下所示：

```
class IServiceManager : public IInterface
{
public:
   static const android::String16 descriptor;  
    static android::sp<IServiceManager> asInterface( const android::sp<android::IBinder>& obj);  
    virtual const android::String16& getInterfaceDescriptor() const; 
    IServicemanager();  
    virtual ~IServiceManager();  
…......
….....
…...
….. 
```

在 IServiceManager.cpp

```
const android::String16 IServiceManager::descriptor("android.os.IServiceManager”);             
const android::String16&  
       IServiceManager::getInterfaceDescriptor() const {  
    return  IServiceManager::descriptor;
}    
android::sp<IServiceManager> IServiceManager::asInterface(   
        const android::sp<android::IBinder>& obj)  
{   
    android::sp< IServiceManager> intr;    
    if (obj != NULL) {     
        intr = static_cast<IServiceManager*>(   
            obj->queryLocalInterface(  
                    IServiceManager::descriptor).get());    
        if (intr == NULL) {   
            intr = new BpServiceManager(obj);  
        }  
    }     
    return intr;    
}     
IServiceManager::IServiceManager() { }    
IServiceManager::~IIServiceManager { } 
```

因此，如果您看到第 12 行显示服务管理器是否已启动并正在运行（这应该是因为服务管理器在 Android 启动期间在 init 进程中启动）它会通过 queryLocalinterface 函数返回对它的引用，并且它会全部上升java接口的方式。

```
public IBinder getService(String name) throws RemoteException {
116        Parcel data = Parcel.obtain();
117        Parcel reply = Parcel.obtain();
118        data.writeInterfaceToken(IServiceManager.descriptor);
119        data.writeString(name);
120        mRemote.transact(GET_SERVICE_TRANSACTION, data, reply, 0);
121        IBinder binder = reply.readStrongBinder();
122        reply.recycle();
123        data.recycle();
124        return binder;
125    } 
```

来自 ServiceManagerNative.java。在这个函数中，我们传递我们正在寻找的服务。

远程存根上 GET_SERVICE_TRANSACTION 的 onTransact 函数如下所示：

```
public boolean onTransact(int code, Parcel data, Parcel reply, int flags)
51    {
52        try {
53            switch (code) {
54            case IServiceManager.GET_SERVICE_TRANSACTION: {
55                data.enforceInterface(IServiceManager.descriptor);
56                String name = data.readString();
57                IBinder service = getService(name);
58                reply.writeStrongBinder(service);
59                return true;
60            }
61
62            case IServiceManager.CHECK_SERVICE_TRANSACTION: {
63                data.enforceInterface(IServiceManager.descriptor);
64                String name = data.readString();
65                IBinder service = checkService(name);
66                reply.writeStrongBinder(service);
67                return true;
68            }
69
//Rest has been discarded for brevity…………………..

………………….
………………….
………………… 
```

它通过函数 getService 返回对所需服务的引用。/frameworks/base/libs/binder/IServiceManager.cpp 中的 getService 函数如下所示：

```
 virtual sp<IBinder> getService(const String16& name) const
134    {
135        unsigned n;
136        for (n = 0; n < 5; n++){
137            sp<IBinder> svc = checkService(name);
138            if (svc != NULL) return svc;
139            LOGI("Waiting for service %s...\n", String8(name).string());
140            sleep(1);
141        }
142        return NULL;
143    } 
```

所以它实际上检查服务是否可用，然后返回对它的引用。在这里我想补充一点，当我们返回对 IBinder 对象的引用时，与其他数据类型不同，它不会被复制到客户端的地址空间中，但它实际上是通过 IBinder 对象共享给客户端的相同引用Binder 驱动程序中称为对象映射的特殊技术。

为了在讨论中添加更多细节，让我再深入一点。

checkService 函数如下所示：

```
virtual sp<IBinder> checkService( const String16& name) const

    {
        Parcel data, reply;

        data.writeInterfaceToken(IServiceManager::getInterfaceDescriptor());

        data.writeString16(name);

        remote()->transact(CHECK_SERVICE_TRANSACTION, data, &reply);

        return reply.readStrongBinder();

    } 
```

所以它实际上调用了一个远程服务并将 CHECK_SERVICE_TRANSACTION 代码（它的枚举值为 2）传递给它。

这个远程服务实际上是在 frameworks/base/cmds/servicemanager/service_manager.c 中实现的，它的 onTransact 如下所示。

```
switch(txn->code) {
   case SVC_MGR_GET_SERVICE:
           case SVC_MGR_CHECK_SERVICE:
        s = bio_get_string16(msg, &len);
        ptr = do_find_service(bs, s, len);
        if (!ptr)
            break;
        bio_put_ref(reply, ptr);
        return 0; 
```

因此，我们最终调用名为 do_find_service 的函数，该函数获取对服务的引用并将其返回。

来自同一文件的 do_find_service 如下所示：

```
void *do_find_service(struct binder_state *bs, uint16_t *s, unsigned len)

{

    struct svcinfo *si;

    si = find_svc(s, len);

//    ALOGI("check_service('%s') ptr = %p\n", str8(s), si ? si->ptr : 0);

    if (si && si->ptr) {

        return si->ptr;

    } else {

        return 0;

    } 
```

find_svc 如下所示：

```
struct svcinfo *find_svc(uint16_t *s16, unsigned len)

{

    struct svcinfo *si;

    for (si = svclist; si; si = si->next) {

        if ((len == si->len) &&

            !memcmp(s16, si->name, len * sizeof(uint16_t))) {

            return si;

        }

    }

    return 0;

} 
```

很明显，它遍历 svclist 并返回我们正在寻找的服务。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-28T18:58:12.260

> 但我无法理解调用 ServiceManager.getService(LOCATION_SERVICE); 时会发生什么 即使在阅读了 ServiceManager 代码之后。

好的，下面是[ServiceManager.java](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/4.1.2_r1/android/os/ServiceManager.java)中 getService() 的源代码：

```
public static IBinder getService(String name) {
    try {
        IBinder service = sCache.get(name);
        if (service != null) {
            return service;
        } else {
            return getIServiceManager().getService(name);
        }
    } catch (RemoteException e) {
        Log.e(TAG, "error in getService", e);
    }
    return null;
} 
```

如我们所见，如果请求的服务尚未缓存，则调用`getIServiceManager().getService(name)`. getIServiceManager() 是同一个类中的一个方法（我们将在下一步中使用 getService(name)）：

```
private static IServiceManager getIServiceManager() {
    if (sServiceManager != null) {
        return sServiceManager;
    }

    // Find the service manager
    sServiceManager = ServiceManagerNative.asInterface(BinderInternal.getContextObject());
    return sServiceManager;
} 
```

所以这基本上将我们发送到[ServiceManagerNative.java](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/4.1.2_r1/android/os/ServiceManagerNative.java)，我们需要在其中查找 getService(name)：

```
public IBinder getService(String name) throws RemoteException {
    Parcel data = Parcel.obtain();
    Parcel reply = Parcel.obtain();
    data.writeInterfaceToken(IServiceManager.descriptor);
    data.writeString(name);
    mRemote.transact(GET_SERVICE_TRANSACTION, data, reply, 0);
    IBinder binder = reply.readStrongBinder();
    reply.recycle();
    data.recycle();
    return binder;
} 
```

它启动事务以检索名称为“LOCATION_SERVICE”的服务。

由于处理低级事物（如系统服务）的类和接口的复杂结构，从这里开始变得越来越难。但基本上都是在 Context.java、ContextImpl.java、ServiceManager.java 和 ServiceManagerNative.java 中完成的。另请注意，其中一些可能会保留本地缓存或映射与服务实例的引用（即，您可以`sCache.get(name)`在上面的 ServiceManager.java 列表中看到一个），这可能是额外引用的来源。

我认为您不会在 StackOverflow 上得到更详细的答案，因为它变得非常低级。您可能想在有谷歌员工的 Android 操作系统邮件列表上询问某个地方。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-09-01T10:00:40.083

位置管理器，因为大多数系统服务/管理器是在启动过程的早期创建的。

app_process 是启动 DalvikVM 的原生组件，另外，它告诉 ZigoteInit（执行实际工作的类）启动 SystemServer。在这里创建 LocationManager 的第一个实例，并将引用保存在其中的 ServerThread 上。

```
/frameworks/base/services/java/com/android/server/SystemServer.java

DevicePolicyManagerService devicePolicy = null;
StatusBarManagerService statusBar = null;
InputMethodManagerService imm = null;
AppWidgetService appWidget = null;
NotificationManagerService notification = null;
WallpaperManagerService wallpaper = null;
-> LocationManagerService location = null;
CountryDetectorService countryDetector = null;
TextServicesManagerService tsms = null;
LockSettingsService lockSettings = null;
DreamManagerService dreamy = null;

try {
    Slog.i(TAG, "Location Manager");
    location = new LocationManagerService(context);
    ServiceManager.addService(Context.LOCATION_SERVICE, location);
} catch (Throwable e) {
    reportWtf("starting Location Manager", e);
} 
```

其余的你已经知道了，我想。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-03-08T11:13:40.620

方法 getSystemService

```
public abstract Object getSystemService(String name); 
```

在[https://android.googlesource.com/platform/frameworks/base/+/android-5.0.2_r1/core/java/android/app/ContextImpl.java中实现](https://android.googlesource.com/platform/frameworks/base/+/android-5.0.2_r1/core/java/android/app/ContextImpl.java)

```
@Override
    public Object getSystemService(String name) {
        ServiceFetcher fetcher = SYSTEM_SERVICE_MAP.get(name);
        return fetcher == null ? null : fetcher.getService(this);
    } 
```

SYSTEM_SERVICE_MAP 是：

```
private static final HashMap<String, ServiceFetcher> SYSTEM_SERVICE_MAP =
            new HashMap<String, ServiceFetcher>(); 
```

并且所有服务都注册在静态块中

```
static { 
```

像这样调用 registerService ：

```
 registerService(LOCATION_SERVICE, new ServiceFetcher() {
                public Object createService(ContextImpl ctx) {
                    IBinder b = ServiceManager.getService(LOCATION_SERVICE);
                    return new LocationManager(ctx, ILocationManager.Stub.asInterface(b));
                }}); 
```

或者

```
registerService(INPUT_SERVICE, new StaticServiceFetcher() {
                public Object createStaticService() {
                    return InputManager.getInstance();
                }}); 
```

ServiceFetcher 和 StaticServiceFetcher 实现了延迟加载模式。

# java - 从 url 中删除 key=value

> ID：15137249
> 
> 赞同：0
> 
> 时间：2013-02-28T13:52:41.957
> 
> 标签：java, url

我需要一个可以轻松编辑 URL 的 java 库。URL 以字符串形式给出，并且必须以字符串形式返回。

我需要诸如删除`key=value`对和保持 url 干净以及正确放置 ?s 和 &s 之类的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T14:28:53.517

使用[正则表达式和模式匹配](http://docs.oracle.com/javase/tutorial/essential/regex/pattern.html)：

例如：

```
String original = "http://www.someHost.com/somePage?key1=value1&key2=value2";
Pattern keyValPattern = Pattern.compile("\\p{Alpha}\\w+=[^&]+");
Matcher m = keyValPattern.matcher(original);  
m.find(); // find an occurence of key=value pair
String keyVal = m.group(); // get the value of the found pair
// keyVal will be 'key1=value1'
int start = m.start(); // the start index of 'key1=value1' in the original string
int end = m.end(); //the end index of 'key1=value1' in the original string
m.find();
String keyVal2 = m.group();// keyVal2 will be 'key2=value2'
// ... etc 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T13:56:21.350

使用 Java`URL`类解析原始字符串并更改参数，然后`toString()`再次为您的结果。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-28T14:03:15.973

这是一个可以提供帮助的简单[实用程序类。](http://ostermiller.org/utils/src/CGIParser.java.html)我不会为此使用整个库，更好的是查看您需要什么并使用您需要的方法创建自己的实用程序类。

# javascript - JavaScript 属性描述符是否支持自定义属性？

> ID：15137252
> 
> 赞同：12
> 
> 时间：2013-02-28T13:52:50.417
> 
> 标签：javascript

我想使用具有自定义属性的属性描述符定义一个 JavaScript 属性，换句话说，除了标准之外的属性`value`，`writable`等等......

在下面的示例中，我定义了一个带有自定义属性的属性描述符的属性`customAttr`。调用`Object.defineProperty`工作正常，但后来当我尝试遍历属性描述符的属性时，我的自定义属性没有列出。

我正在尝试做的事情可能吗？

```
const o = {}

Object.defineProperty(o, 'newDataProperty', {
  value: 101,
  writable: true,
  enumerable: true,
  configurable: true,
  customAttr: 1,
})

const desc = Object.getOwnPropertyDescriptor(o, 'newDataProperty')

// List the descriptor attributes.
for (const prop in desc) {
  console.log(`${prop}: ${desc[prop]}`)
}

// PROBLEM: `customAttr` is not listed
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-28T13:55:31.747

不，这是不可能的。这是做什么[`Object.defineProperty`](http://es5.github.com/#x15.2.3.6)的：

> ...
> 
>  3\. 设*desc*`ToPropertyDescriptor`为以*Attributes*作为参数调用的结果。
> 
> 4.使用参数*name*、*desc*和 true调用*O* 的 [[DefineOwnProperty]] 内部方法。
> 
>  **5\. 返回*O*。**

 **简而言之，[`ToPropertyDescriptor`](http://es5.github.com/#x8.10.5)简单地忽略任何不是“可枚举”、“可写”、“可配置”、“值”、“获取”或“设置”的东西：

> 1.  ...
>     
>     
> 2.  让*desc*是创建一个最初没有字段的新属性描述符的结果。
>     
>     
> 3.  如果使用参数 " " 调用*Obj*的 [[HasProperty]] 内部方法的结果`enumerable`为真，则
>     *   ...
> 
> （对其他有效的描述符属性重复第 3 步）
> 
>  10\. 返回*描述*。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2017-06-12T02:19:29.577

在这里复活一个旧帖子，但我发现这个想法很有趣。您可以提取函数是 javascript 中的对象这一事实，并将`get`函数用作属性持有者：

```
function setPropertyAttribute(obj, propertyName, attributeName, attributeValue) {
  var descriptor = getCustomPropertyDescriptor(obj, propertyName);

  descriptor.get.$custom[attributeName] = attributeValue;
}

function getPropertyAttributes(obj, propertyName) {
  var descriptor = getCustomPropertyDescriptor(obj, propertyName);

  return descriptor.get.$custom;
}

function getPropertyAttribute(obj, propertyName, attributeName) {
  return getPropertyAttributes(obj, propertyName)[attributeName];
}

function getCustomPropertyDescriptor(obj, prop) {
  var actualDescriptor = Object.getOwnPropertyDescriptor(obj, prop);
  if (actualDescriptor && actualDescriptor.get && actualDescriptor.get.$custom) {
    return actualDescriptor;
  }

  var value = obj[prop];
  var descriptor = {
    get: function() {
      return value;
    },
    set: function(newValue) {
      value = newValue;
    }
  }
  descriptor.get.$custom = {};

  Object.defineProperty(obj, prop, descriptor);
  return Object.getOwnPropertyDescriptor(obj, prop);
} 
```

然后 ：

```
var obj = {
  text: 'value',
  number: 256
}

setPropertyAttribute(obj, 'text', 'myAttribute', 'myAttributeValue');

var attrValue = getPropertyAttribute(obj, 'text', 'myAttribute'); //'myAttributeValue' 
```

[在这里](https://jsfiddle.net/pger957q/1/)摆弄。**

# selenium - Selenium::WebDriver::Error::MoveTargetOutOfBoundsError

> ID：15137254
> 
> 赞同：1
> 
> 时间：2013-02-28T13:52:59.357
> 
> 标签：selenium, cucumber, selenium-webdriver

尝试与某些项目交互时出现以下错误：

`Element cannot be scrolled into view:javascript:void(0); (Selenium::WebDriver::Error::MoveTargetOutOfBoundsError`)

即使元素在浏览器中并且是可见的，在 AJAX 调用之后与模态（Bootstrap）交互时也会出现这种情况。

我发现的一种解决方法是我再次手动转到该页面（这并没有弄乱测试场景）。

有没有更好的方法来解决此类错误？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T13:36:22.647

测试 ajax 很棘手。那是因为它是异步的；）
所以您必须等待某些对象出现在您的页面上。
然后根据你的框架，一些过渡或动画已经完成，你也必须等待它们。

您究竟要等待什么，取决于您的应用程序和您使用的 JS 框架。它可以是一个 css 类、一个 id 或其他东西。
例如，使用 jQuery mobile，您必须等待 css 类`ui-mobile-viewport-transitioning`被删除，然后您的转换完成，您可以继续测试。

这是等待的Java代码示例：

```
webdriverWaiter.waitUntil(ExpectedConditions.invisibilityOfElementLocated(By.cssClass("ui-mobile-viewport-transitioning"))); 
```

希望有帮助

# kohana-3 - Kohana ORM 和 SQL 注入

> ID：15137258
> 
> 赞同：1
> 
> 时间：2013-02-28T13:53:13.583
> 
> 标签：kohana-3

使用本机 ORM 在 Kohana(3.3) 中防止 SQL 注入的最佳方法是什么？或者默认情况下它是“安全的”..

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-28T15:10:54.823

默认情况下它是安全的，因为它使用[Kohana 的 Database Query Builder](http://kohanaframework.org/3.3/guide/database/query/builder)为您完成所有必要的转义。**Kohana 的 ORM 是安全的。**

# jquery - 使用 JQuery 仅显示跨多列的前 5 个 div，并显示更多按钮

> ID：15137268
> 
> 赞同：5
> 
> 时间：2013-02-28T13:53:55.043
> 
> 标签：jquery

如何使用 JQuery 仅在每列上显示前 5 次以及“更多”和“更少”链接以显示更多结果。

我所追求的类似于[隐藏所有 li 元素并显示前 2 个元素并通过按钮切换它们](https://stackoverflow.com/questions/5050996/hide-all-li-elements-and-show-the-first-2-and-toggle-them-by-button)- 但我需要更多和更少的链接来显示/隐藏每个医生的所有时间段（即：更多/更少的链接应一键显示/隐藏每位医生的 7 列）。

——这就是现在的时代——

![](../Images/bfe26908db611999e72569b9e0e87af5.png)

——这就是我要寻找的结果——

![](../Images/c3145dfd4d7790e2637a0aa3dbc25f39.png)

--我的HTML代码--

```
<div class="appointmentDetails">
  <div class="staffInfo">
    <div>Dr John Doe</div>
  </div>
  <div class="appointmentInfo">
    <ul>
      <li>
        <div></div>
      </li>
      <li class="timeSlots bg">
        <div><a href="#">08:00</a></div>
        <div><a href="#">09:00</a></div>
        <div><a href="#">10:00</a></div>
        <div><a href="#">11:00</a></div>
        <div><a href="#">12:00</a></div>
        <div><a href="#">13:00</a></div>
        <div><a href="#">14:00</a></div>
        <div><a href="#">15:00</a></div>
        <div><a href="#">16:00</a></div>
        <div><a href="#">17:00</a></div>
        <div><a href="#">18:00</a></div>
      </li>
      <li class="timeSlots">
        <div><a href="#">08:00</a></div>
        <div><a href="#">09:00</a></div>
        <div><a href="#">10:00</a></div>
        <div><a href="#">11:00</a></div>
        <div><a href="#">12:00</a></div>
        <div><a href="#">13:00</a></div>
        <div><a href="#">14:00</a></div>
        <div><a href="#">15:00</a></div>
        <div><a href="#">16:00</a></div>
        <div><a href="#">17:00</a></div>
        <div><a href="#">18:00</a></div>
      </li>
      <li class="timeSlots bg">
        <div><a href="#">08:00</a></div>
        <div><a href="#">09:00</a></div>
        <div><a href="#">10:00</a></div>
        <div><a href="#">11:00</a></div>
        <div><a href="#">12:00</a></div>
        <div><a href="#">13:00</a></div>
        <div><a href="#">14:00</a></div>
        <div><a href="#">15:00</a></div>
        <div><a href="#">16:00</a></div>
        <div><a href="#">17:00</a></div>
        <div><a href="#">18:00</a></div>
      </li>
      <li class="timeSlots">
        <div><a href="#">08:00</a></div>
      </li>
      <li class="timeSlots bg">
        <div><a href="#">09:00</a></div>
      </li>
      <li class="timeSlots">
        <div><a href="#">09:00</a></div>
      </li>
      <li class="timeSlots bg">
        <div><a href="#">08:00</a></div>
      </li>
      <li>
        <div></div>
      </li>
    </ul>
  </div>
</div>
<div class="appointmentDetails">
  <div class="staffInfo">
    <div>Dr Tom Smith</div>
  </div>
  <div class="appointmentInfo">
    <ul>
      <li>
        <div></div>
      </li>
      <li class="timeSlots bg">
        <div><a href="#">08:00</a></div>
        <div><a href="#">09:00</a></div>
        <div><a href="#">10:00</a></div>
        <div><a href="#">11:00</a></div>
        <div><a href="#">12:00</a></div>
        <div><a href="#">13:00</a></div>
        <div><a href="#">14:00</a></div>
        <div><a href="#">15:00</a></div>
        <div><a href="#">16:00</a></div>
        <div><a href="#">17:00</a></div>
        <div><a href="#">18:00</a></div>
      </li>
      <li class="timeSlots">
        <div><a href="#">08:00</a></div>
        <div><a href="#">09:00</a></div>
        <div><a href="#">10:00</a></div>
        <div><a href="#">11:00</a></div>
        <div><a href="#">12:00</a></div>
      </li>
      <li class="timeSlots bg">
        <div><a href="#">10:00</a></div>
      </li>
      <li class="timeSlots">
        <div><a href="#">10:00</a></div>
      </li>
      <li class="timeSlots bg">
        <div><a href="#">10:00</a></div>
      </li>
      <li class="timeSlots">
        <div><a href="#">10:00</a></div>
      </li>
      <li class="timeSlots bg">
        <div><a href="#">10:00</a></div>
      </li>
      <li>
        <div></div>
      </li>
    </ul>
  </div>
</div> 
```

--这是我的 HTML/JAVASCRIPT/CSS 的现场演示--

[http://jsfiddle.net/rR26n/](http://jsfiddle.net/rR26n/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T14:30:04.343

给你：http: [//jsfiddle.net/eqmgy/](http://jsfiddle.net/eqmgy/)

您需要添加

```
 <div class="less"><a href="#">Less</a>
            </div>
            <div class="more"><a href="#">More</a>
            </div> 
```

在每个结束时`<li class="timeSlots"></li>`

和js：

```
var showMore = function () {
    $(this).find('div').css('display', 'block');

    $(this).find('.more').css('display', 'none');
    $(this).find('.less').css('display', 'block');
    $(this).find('.less').click($.proxy(showLess, $(this)));

};

var showLess = function () {
    $(this).find('div').each(function(index, div) {
        if(index > 5) {
            $(div).css('display', 'none');
        }
    });

    $(this).find('.less').css('display', 'none');
    $(this).find('.more').css('display', 'block');

    $(this).find('.more').click($.proxy(showMore, $(this)));

};

$('.timeSlots').each(function (index, timeslot) {
    $.proxy(showLess, timeslot)();
}); 
```

编辑 ：

让我们自动添加更多/更少，所以当 number < 5 时它不会启动：

```
$('.timeSlots').each(function (index, timeslot) {
            if(timeslot.find('div').length > 5) {
                 timeslot.append('<div class="more"><a href="#">More</a></div>');
                 timeslot.append('<div class="less"><a href="#">Less</a></div>');
                 $.proxy(showLess, timeslot)();
            }
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T15:07:08.870

在我们找到“解决方案”之前：您的标记不是很语义化。您正在显示时间列表，因此时间应该在列表中，而不是 DIV。这些列表可以向左浮动或内联阻塞，您可以摆脱标记中的许多杂物。

假设你现在有你的时间在这样的列表中：

```
<ul class="timeList">
   <li class="timeSlot">8:00</li>
   <li class="timeSlot">9:00</li>
   ...
   <li class="timeSlot">18:00</li>
</ul> 
```

你想做几件事：

1.  如果列表有超过 5 个插槽，则隐藏 #5 之后的所有内容，并添加更多链接。
2.  单击 MORE 链接时，显示 #5 之后的所有内容，然后更改为 LESS 链接
3.  单击 LESS 链接时，隐藏 #5 之后的所有内容并更改回 MORE 链接

如果您还没有使用 jQuery，我建议您使用它，因为它使事情变得容易得多，所以我关于如何做这些事情的建议使用它。

对于数字 1，您可以隐藏某个索引之后的元素，如下所示：

```
 jQuery(".someClass").children(":gt(4)").hide(); 
```

这将隐藏第 5 个和更多元素。**但是**：这也会隐藏*所有*其他列表的 LI，因为上面的代码将每个列表的所有子项放在一个大集合中，然后在第 5 个元素之后将它们全部隐藏。所以你想要做的是遍历每个列表并只隐藏它的孩子。

我在这里创建了一个示例，将它们变为红色而不是隐藏它们，以便您可以直观地看到发生了什么：

```
jQuery(function () {
    jQuery(".timeList").each(function () {
        jQuery(this).children(":gt(4)").css('color','red');
    });
}); 
```

你可以在这里看到它的作用：http: [//jsfiddle.net/7PeVj/](http://jsfiddle.net/7PeVj/)

对于#2，您需要检查每个列表是否超过 5 个，并添加一个 MORE 链接。由于我们已经在遍历每个列表，我们可以在那里实现该代码。您可以使用children结果的长度来查看是否有超过5个，然后使用jQuery的`append()`函数添加一个按钮。

这是一个例子。请注意，我们现在只要求孩子`timeSlots`

```
 jQuery(".timeList").each(function () {
        // reference to the list
        var theList = jQuery(this);
        // reference to it's LIs that have .timeSlot
        var kids = theList.children(".timeSlot");
        // manipulate after element 5
        kids.filter(":gt(4)").css('color','red');
        //add a MORE link if we have more than 5
        if (kids.length > 5) {
            theList.append('<li class="slotMoreLess">MORE</li>');
        }
    }); 
```

工作示例：http: [//jsfiddle.net/7PeVj/2/](http://jsfiddle.net/7PeVj/2/)

最后，您需要“连接” MORE / LESS 以适当地隐藏和显示项目。您需要使用 jQuery`on()`为这些按钮附加处理程序，因为它们在页面加载时不存在。

同样，工作示例位于：http: [//jsfiddle.net/7PeVj/4/](http://jsfiddle.net/7PeVj/4/)

隐藏和显示您可以使用您在上面的代码中看到的内容。您可以检查并设置`text()`MORE 列表项的 以在 LESS 和 MORE 之间来回切换并根据需要隐藏显示。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-28T14:12:13.667

一种可能的解决方案：

```
$timeSlots = $('.timeSlots');
$timeSlots.each(function() {
    var $times = $(this).children();
    if ($times.length > 5) {
        $timeSlots.children(':nth-of-type(n+6)').hide();
        $(this).append('<span class="more-times">+More</span>');
    }
});

$timeSlots.on('click', '.more-times', function() {
    $(this).prevAll().show().end().remove();
}); 
```

只需在`DOMready`.

[http://jsfiddle.net/dfsq/rR26n/6/](http://jsfiddle.net/dfsq/rR26n/6/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-28T14:17:57.920

尝试这个：

[http://jsfiddle.net/rR26n/8](http://jsfiddle.net/rR26n/8)

```
// hide all times and then show the first 5
var hideTimes = function() {
    $('.timeSlots').each(function () {
        $(this).children('div').hide().filter(':lt(5)').show();
    });
}

// show all times
var showTimes = function() {
    $('.timeSlots > div').show();
}

$('.show').click(function () {
    showTimes();
});

$('.hide').click(function () {
    hideTimes();
});

hideTimes(); 
```

这是一个一键式示例：http: [//jsfiddle.net/rR26n/9/](http://jsfiddle.net/rR26n/9/)

这两个示例都需要进行一些改进，以防止按钮作用于 .appointmentDetails 的所有实例。您可以使用 ID 或通过类索引来做到这一点。

# jquery - 使用 jQuery Mobile 进行 AJAX 调用 - 为什么方法会被调用两次？

> ID：15137269
> 
> 赞同：1
> 
> 时间：2013-02-28T13:53:59.550
> 
> 标签：jquery, jquery-mobile

我在这个上扯掉我的头发。我是 jQuery Mobile 的新手，我有一个功能可以在浏览器滚动到页面底部时加载新内容。

我还有一个`<select>`你可以选择类别的地方。它在起始页上运行良好（即没有选择类别时）。但是一旦我选择了一个类别，然后滚动到底部，该功能`bindScroll()`就会触发两次。

我已经为此工作了将近两天，试图找到一些解决方案，但什么也没有。我还没有真正弄清楚不同的 jQuery Mobile 事件，所以那里可能存在一些问题。

如果可以，请查看我的代码并提供帮助。该站点是在 .NET MVC 中构建的，但问题在于 jQuery。

```
@using Namespace.Helpers
@{
    ViewBag.Title = "Home Page";
}
<!-- Get a drop down of the different categories -->
@Html.Raw(Html.GetCategories(true, "CategoryId", 0, true))

<!-- list view to append the fetched ads to -->
<ul data-role="listview" data-inset="true" id="ad-list">

</ul>

<script>
    // keeps track of how many rows to skip in the db. this is passed along to the server side
    var currentPos = 0;

    // save the categoryId
    var categoryId = $('#CategoryId').val();

    $('#page-start').live('pagecreate', function () {

        // load the ads for the first call
        loadAds();

        //handle the category drop down
        $('#CategoryId').change(function () {
            // clear the list of ads
            $('#ad-list').empty();

            // reset so we start fetching from the first row in the db, used on server side
            currentPos = 0;

            // update the category value to pass along to the server
            categoryId = $('#CategoryId').val();

            // just to know that it has a value
            console.log(categoryId);

            // re-load the new ads
            loadAds();

        });

    });

    // method that loads ads via AJAX
    function loadAds() {
        console.log('loadAds()');
        $.ajax({
            // method on the server that returns a partial view
            url: '/Home/LoadMoreAds',
            type: 'GET',
            data: {
                // pass along some data
                currentPosition: currentPos,
                categoryId: categoryId
            },
            success: function (result) {
                // add the result to the ad-list
                $('#ad-list').append(result);
                $('#ad-list').listview('refresh');

                // once again, bind the scroll event
                $(window).scroll(bindScroll);

            },
            error: function (data, textStatus, jqXHR) {
                alert(textStatus);
            }

        });

    }

    // method that checks if the scroll is near the bottom of the page
    function bindScroll() {
        if($(document).height() > $(window).height())
        {
            if ($(window).scrollTop() + $(window).height() > $(document).height() - 100) {
                $(window).unbind('scroll');

                // just to know that the method has run
                console.log('bindScroll()');

                // update counter to skip the already loaded rows
                currentPos++;

                // load new ads
                loadAds();

            }
        }
    }

</script> 
```

**编辑后的答案：---------------------------------------------------------**

我接受了 Mike C 的建议，不绑定并重新绑定滚动事件。页面初始化时只有一个绑定。然后我使用了这段代码：

```
// method that checks if the scroll is near the bottom of the page
    var scrollHappening = false;
    function bindScroll() {
        if (scrollHappening) {
            return false;
        } else {
            if ($(document).height() > $(window).height()) {
                if ($(window).scrollTop() + $(window).height() > $(document).height() - 100) {

                    // just to know that the method has run
                    console.log('bindScroll()');

                    // update counter to skip the already loaded rows
                    currentPos++;

                    // load new ads
                    loadAds();

                    scrollHappening = true;

                }
            }
        }
    } 
```

并设置`scrollHappening = false`在`success:`ajax 调用中。似乎工作得很好！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T14:01:48.670

选择类别后，您在此位置重新绑定 bindScroll，因此它被调用了两次！？即，当您选择一个类别时，您会调用 LoadAds()，其中包含以下内容：

```
success: function (result) {
                    // add the result to the ad-list
                    $('#ad-list').append(result);
                    $('#ad-list').listview('refresh');

                    // once again, bind the scroll event
                    $(window).scroll(bindScroll);

                }, 
```

每次调用 LoadAdds() 时，此函数都会为调用 bindscroll 添加一个额外事件。

1.  LoadAdds() 你现在在滚动上有 1 个事件绑定所以滚动 --> bindscroll == 1 个事件绑定
2.  LoadAdds() 你现在绑定了 2 个事件，所以滚动 --> bindscroll == 2 个事件绑定

当您实际滚动时，如果您有 2 个绑定到 bindscroll 的事件，我猜它会在取消绑定发生之前调用这两个事件。

我认为您在这里真正的解决方案是不要一直绑定和解除绑定。绑定一次，不要用绑定/取消绑定玩这个游戏。更改您的代码以使用单个绑定。在底部，如果您已经在底部，则有一个变量来标记，如果是，则退出该函数。或类似的东西。这个绑定/解除绑定业务让您自己头疼。

# java - 序列化/反序列化 MQMessage

> ID：15137270
> 
> 赞同：1
> 
> 时间：2013-02-28T13:54:05.827
> 
> 标签：java, serialization, messaging, ibm-mq, trace

我想序列化一个 MQMessage 并将其保存到磁盘/数据库。我的目标是能够在以后反序列化它，并且所有标题、命名属性和内容都完好无损。

要清楚，我需要这样的东西：

```
byte[] serialize(MQMessage m);
MQMessage deserialize(byte[] b); 
```

这样在执行以下操作时：

```
MQMessage M = deserialize(serialize(m)); 
```

我得到的`M`是`m`.

如果需要，这需要能够重新提交消息以进行处理（在大型 MQ 网络中，应用程序迟早会吃掉/丢失一些消息）。因此，我需要能够反序列化我想要重新提交的每个 MQMessage 的 1:1 副本（即不仅包括其内容，还包括其标头、属性、编码、格式等...）。

不幸的是，MQMessage 似乎没有实现任何类型的序列化机制。你会怎么做呢？手工制作序列化/反序列化代码是唯一的方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T00:33:26.610

为什么要重新发明轮子。已经有很多免费和商业工具可用于进行消息重放。

以下是免费 MQ 工具列表：http: [//www.capitalware.biz/mq_tools.html](http://www.capitalware.biz/mq_tools.html)

以下是商业 MQ 工具列表：http: [//www.capitalware.biz/mq_tools_comm.html](http://www.capitalware.biz/mq_tools_comm.html)

# gradle - gradle 中的 UP-TO-DATE 表示什么？

> ID：15137271
> 
> 赞同：21
> 
> 时间：2013-02-28T13:54:11.617
> 
> 标签：gradle

我最近开始在一个项目中使用 gradle 并且我正在运行标准

```
gradle clean init build 
```

我注意到在许多正在运行的任务中，我在控制台中收到了这条 UP-TO-DATE 消息，在当前正在运行的任务旁边。例如：-

```
:foo:bar:test UP-TO-DATE 
```

我很好奇这条消息是什么意思。找不到相同的任何文档。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-02-28T23:11:50.547

Gradle 所做的一切都是一项任务。大多数任务都声明了输入和输出。Gradle 将通过检查输入和输出来确定任务是否是最新的。

例如，您的`compile`任务输入是源代码。如果自上次编译后源代码没有更改，那么它将检查输出以确保您没有破坏编译器生成的类文件。如果输入和输出未更改，则认为任务“最新”并且不执行该任务。这可以节省大量时间，尤其是在大型构建中。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-03-01T11:51:35.243

顺便说一句：如果你*真的*想绕过这个构建优化，你可以使用`--rerun-tasks`命令行选项来强制执行每个任务。请参阅[gradle 命令行选项的文档](http://www.gradle.org/docs/current/userguide/userguide_single.html#gradle_command_line)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-02-28T13:58:56.270

Gradle 是一个增量构建系统。这意味着它会在实际执行之前检查任务是否必须真正执行，以便更快。

因此，例如，如果您已经在之前的构建中编译了源文件，并且没有修改任何源文件（也没有修改 compile 任务的任何其他输入），那么 Gradle 不会重新编译所有源文件，因为它知道它将导致与构建文件夹中已经存在的输出完全相同的输出。并且因此安全地跳过了编译，从而加快了构建速度。

[文档](http://www.gradle.org/docs/current/userguide/userguide_single.html#N10E78)中的更多信息

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2016-09-25T01:32:23.080

我遇到了类似的问题，尝试了所有选项，但以下选项对我有用：

```
 gradle  -Dorg.gradle.daemon=false <your tasks> 
```

# android - Android：以编程方式更改布局的根视图的高度

> ID：15137275
> 
> 赞同：3
> 
> 时间：2013-02-28T13:54:14.663
> 
> 标签：android, android-layout, android-linearlayout

我是安卓新手。谁能告诉我如何`RootView`在 Android 中以编程方式更改布局的高度？我尝试过的代码如下

```
LayoutInflater inflater = (LayoutInflater)context.getSystemService(Context.LAYOUT_INFLATER_SERVICE);

            View view = inflater.inflate(R.layout.sample, null);
            view.getRootView().getLayoutParams().height = value; 
```

执行此操作后，我`NullPointerException`在上面的行中得到了一个。谁能帮我？提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-28T13:58:56.697

inflate 调用返回的视图是根视图，因此应该可以：

```
View view = inflater.inflate(R.layout.sample, null);
view.setLayoutParams(new ListView.LayoutParams(LayoutParams.MATCH_PARENT,<height>)); 
```

如果您要提供一个 ViewGroup 来膨胀成这样：

```
View view = inflater.inflate(R.layout.sample, containerForTheInflatedView); 
```

然后`view`将是 ViewGroup，而不是您想要的根视图。

# android - 点击 Android 通知不显示活动选择器

> ID：15137284
> 
> 赞同：0
> 
> 时间：2013-02-28T13:54:35.037
> 
> 标签：android, notifications

**说明：** 我使用了守护线程。在我的应用程序中，当用户发送任何文件（.jpg、.txt、.pdf 等）时，它将为每个文件生成单独的通知。假设有 3 个通知。当用户点击任何通知时，它将`android.content.Intent.ACTION_VIEW`根据文件调用并建议 openwith 选项。

**问题：** 当用户选择通知时，它将在相应的应用程序中打开（例如，如果用户选择 sample.txt，那么它将在 colornote 中打开），然后当用户点击另一个通知时，它将什么也不做，然后会发生同样的事情。

我还通过了用于通知的唯一 ID ..！

```
 long timestamp=System.currentTimeMillis();

 int i=(int) timestamp;

 mNotificationManager.notify(i, mBuilder.build()); 
```

请帮我找出错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T14:03:07.697

您需要添加`PendingIntent`到您的通知生成器：

```
TaskStackBuilder stackBuilder = TaskStackBuilder.create(this);
// Adds the back stack for the Intent (but not the Intent itself)
stackBuilder.addParentStack(MyActivity.class);
// Adds the Intent that starts the Activity to the top of the stack
stackBuilder.addNextIntent(resultIntent);
PendingIntent resultPendingIntent =
        stackBuilder.getPendingIntent(
            0,
            PendingIntent.FLAG_UPDATE_CURRENT
        );
mBuilder.setContentIntent(resultPendingIntent); 
```

阅读这篇文章：[创建一个简单的通知](http://developer.android.com/guide/topics/ui/notifiers/notifications.html#SimpleNotification)

# javascript - 谷歌可视化水平轴标签

> ID：15137287
> 
> 赞同：1
> 
> 时间：2013-02-28T13:54:42.867
> 
> 标签：javascript, google-visualization

我正在尝试创建一个折线图，显示一整年页面上的点击次数。但是我只希望水平轴在每个月的第一天显示一个标签。我目前有这样的东西，但它只显示第一个月。

```
view.setColumns([{
  type: 'string',
  label: 'Month',
  calc: function(dt, row) {
    var date = dt.getValue(row, 0).split('/');
    date = new Date(date[2], date[1] - 1, date[0]);
    var current_month = date.getMonth();
    if (current_month > month || (current_month == 0 && month != 0)) {
      month = current_month;
      return months[month];
    } else {
      return null;
    }
  }
}, 1]); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T01:26:48.380

如果您的类别值属于该`Date()`类型，Google 通常会默认将它们按月显示。请参见以下示例：

```
function drawVisualization() {
  // Create and populate the data table.
  var data = new google.visualization.DataTable();
  data.addColumn('date', 'Date');
  data.addColumn('number', 'Cats');
  data.addColumn('number', 'Dogs');
  data.addColumn('number', 'Rabbits');
  data.addRows([
    [new Date(1990, 0, 5), 1, 1, 0.5],
    [new Date(1990, 1, 10), 2, 0.5, 1],
    [new Date(1990, 2, 15), 4, 1, 0.5],
    [new Date(1990, 3, 20), 8, 0.5, 1],
    [new Date(1990, 4, 25), 7, 1, 0.5],
    [new Date(1990, 5, 30), 7, 0.5, 1],
    [new Date(1990, 6, 5), 8, 1, 0.5],
    [new Date(1990, 7, 10), 4, 0.5, 1],
  ]);

  // Create and draw the visualization.
  new google.visualization.LineChart(document.getElementById('visualization')).
    draw(data, null);
} 
```

如果您的第一列未存储为日期，而它们只是值，那么我建议将它们转换为日期，以便让 Google 为您完成艰苦的工作。

# mysql - Mysql 错误代码 1452 有两个具有不同数据库引擎的表

> ID：15137289
> 
> 赞同：0
> 
> 时间：2013-02-28T13:54:45.823
> 
> 标签：mysql, foreign-keys, innodb

我有两个表“mm_ads”和“mm_users”。'mm_ads' 使用 Myisam 数据库引擎，而 'mm_users' 使用 InnoDb。根据我的阅读，在这种情况下不可能创建外键引用，因为后一个引擎是事务性的，而第一个不是。但是当我运行时：

```
ALTER TABLE mm_ads ADD CONSTRAINT FK_76EC3E1DF132696E3358 FOREIGN KEY (userid) REFERENCES mm_users (id) 
```

没有显示错误，它只报告受影响的行数，仅此而已。比我看到的 fk 不仅仅是在表中的列上创建一个索引。当我研究这个问题时，我发现表的引擎是不同的，所以我将 mm_ads 的引擎更改为 Innodb。但是当我运行命令时，我得到了这个错误。

```
Error Code: 1452\. Cannot add or update a child row: a foreign key constraint fails (`admin_pw`.<result 2 when explaining filename '#sql-61b_3019e'>, CONSTRAINT `FK_76EC3E1DF132696E3358` FOREIGN KEY (`userid`) REFERENCES `mm_users` (`id`)) 
```

userid 和 id 的类型是相同的，我在表中有值。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T14:24:30.793

我会做以下事情：

**1.删​​除外键**

```
ALTER TABLE mm_ads DROP FOREIGN KEY `FK_76EC3E1DF132696E3358`; 
```

**2\. 识别子表中的孤立行**

```
SELECT * FROM mm_ads when userid not in (select id from mm_users); 
```

**3\. 处理子表中的孤立行**

从中删除行`mm_ads`？将行插入`mm_users`? 在这里由你决定。`mm_ads`无论哪种方式，您都必须根据`mm_ads.userid`>`mm_users.id`关系最终没有孤立的行。

**4.更换引擎**

```
ALTER TABLE mm_ads ENGINE = InnoDB; 
```

**5.恢复外键**

```
ALTER TABLE mm_ads ADD CONSTRAINT FK_76EC3E1DF132696E3358 FOREIGN KEY (userid) REFERENCES mm_users (id); 
```

# python - 大对象和`multiprocessing`管道和`send()`

> ID：15137292
> 
> 赞同：5
> 
> 时间：2013-02-28T13:55:06.763
> 
> 标签：python, multiprocessing, pipe

我最近发现，如果我们使用创建一对父子连接对象`multiprocessing.Pipe`，并且如果`obj`我们试图通过管道发送的对象太大，我的程序会挂起而不会抛出异常或做任何事情. 请参阅下面的代码。（下面的代码使用`numpy`包来生成大量的浮点数。）

```
import multiprocessing as mp
import numpy as np

def big_array(conn, size=1200):
    a = np.random.rand(size)
    print "Child process trying to send array of %d floats." %size
    conn.send(a)
    return a

if __name__ == "__main__":
    print "Main process started."
    parent_conn, child_conn = mp.Pipe()
    proc = mp.Process(target=big_array, args=[child_conn, 1200])
    proc.start()
    print "Child process started."
    proc.join()
    print "Child process joined."
    a = parent_conn.recv()
    print "Received the following object."
    print "Type: %s. Size: %d." %(type(a), len(a)) 
```

输出如下。

```
Main process started.
Child process started.
Child process trying to send array of 1200 floats. 
```

它无限期地挂在这里。但是，如果我们尝试发送一个包含 1000 个浮点数的数组而不是 1200，那么程序将成功执行，并按预期输出以下输出。

```
Main process started.
Child process started.
Child process trying to send array of 1000 floats.
Child process joined.
Received the following object.
Type: <type 'numpy.ndarray'>. Size: 1000.
Press any key to continue . . . 
```

这对我来说似乎是一个错误。该文档说明了以下内容。

> send(obj) 将对象发送到连接的另一端，应使用 recv() 读取该对象。
> 
> 对象必须是可腌制的。非常大的泡菜（大约 32 MB+，尽管取决于操作系统）可能会引发 ValueError 异常。

但是在我的运行中，甚至没有`ValueError`抛出异常，程序只是挂在那里。而且，1200长的`numpy`数组有9600字节大，肯定不超过32MB！这看起来像一个错误。有谁知道如何解决这个问题？

顺便说一句，我使用的是 64 位的 Windows 7。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-03-30T08:17:08.477

尝试移动`join()`到下方`recv()`：

```
import multiprocessing as mp

def big_array(conn, size=1200):
    a = "a" * size
    print "Child process trying to send array of %d floats." %size
    conn.send(a)
    return a

if __name__ == "__main__":
    print "Main process started."
    parent_conn, child_conn = mp.Pipe()
    proc = mp.Process(target=big_array, args=[child_conn, 120000])
    proc.start()
    print "Child process started."
    print "Child process joined."
    a = parent_conn.recv()
    proc.join()
    print "Received the following object."
    print "Type: %s. Size: %d." %(type(a), len(a)) 
```

但是我真的不明白为什么您的示例即使对于小尺寸也有效。我在想写入管道然后在不先从管道读取数据的情况下使进程加入会阻止连接。您应该首先从管道接收，然后加入。但显然它不会阻止小尺寸......？

编辑：来自文档（[http://docs.python.org/3/library/multiprocessing.html#multiprocessing-programming](http://docs.python.org/3/library/multiprocessing.html#multiprocessing-programming)）：

“一个会死锁的例子如下：”

```
from multiprocessing import Process, Queue

def f(q):
q.put('X' * 1000000)

if __name__ == '__main__':
    queue = Queue()
    p = Process(target=f, args=(queue,))
    p.start()
    p.join()                    # this deadlocks
    obj = queue.get() 
```

# jquery - JQuery同位素排序不准确地排序div

> ID：15137293
> 
> 赞同：0
> 
> 时间：2013-02-28T13:55:11.747
> 
> 标签：jquery, jquery-isotope

我的网址是 leftsideart (dot) co (dot) nz

我正在使用以下同位素设置：

```
jQuery('#post-area').isotope({
    animationOptions: {
        duration: 750,
        easing: 'linear',
        queue: false
    },
    getSortData : {
        number : function( $elem ) {
        return parseInt( $elem.find('.order').text(), 10 );
        }
    },
    sortBy : 'number',
    sortAscending : true,
    animationEngine : 'jquery'
});

var jQuerycontainer = jQuery('#post-area');
jQuerycontainer.imagesLoaded( function() {
    jQuerycontainer.isotope();
}); 
```

但我的 div 没有正确排序。同位素肯定会影响顺序，因为我尝试在我的 wordpress 循环中回显随机数，而不是增加数字和相应的 div 洗牌。

另外，可以肯定的是，当我将更改“sortAscending”更改为 false 时，div 的一般顺序是相反的。

Isotope 是否仅提供一般排序而不是精确排序？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-09-14T08:43:13.263

对于类似的问题，这对我有用

```
layoutMode: 'cellsByColumn',
cellsByColumn: {
  columnWidth: 240,
  rowHeight: 360
} 
```

文档在这里[http://isotope.metafizzy.co/v1/demos/layout-modes.html](http://isotope.metafizzy.co/v1/demos/layout-modes.html)

# google-visualization - 在多系列谷歌柱形图上显示值标签

> ID：15137295
> 
> 赞同：1
> 
> 时间：2013-02-28T13:55:35.753
> 
> 标签：google-visualization

有谁知道是否有一种方法可以在每列上显示**多系列**谷歌柱形图的值？

Muhammad Tayyab Shei 成功制作了它，但对于**单一系列**：请参阅[在 google 交互式条形图中将标签放在内部栏顶部](https://stackoverflow.com/questions/10871729/put-labels-on-top-of-inside-bar-in-google-interactive-bar-chart)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T01:37:40.800

由于柱形图尚不支持注释角色，因此无法使用多柱形图完成（单系列版本通过使用允许对折线图部分进行注释的组合图工作）。

实现这一点的最简单方法是创建一个 javascript 函数来全时显示工具提示，或者绘制自定义工具提示并打开它们（例如，使用[支持 HTML 的 Tooltips](https://developers.google.com/chart/interactive/docs/customizing_tooltip_content#enabling_html_tooltip)）。

# c# - 添加通知图标后应用程序不会在启动时启动

> ID：15137300
> 
> 赞同：2
> 
> 时间：2013-02-28T13:56:08.810
> 
> 标签：c#, startup, notifyicon

我的应用程序运行正常，之前它会在启动时执行。我添加了一个通知图标，在我的代码中，这个图标在某些地方发生了变化。我在我的应用程序的根文件夹中添加了所有必需的图标，除了我的应用程序的启动启动之外，这些图标一切正常。我可以在注册表的“运行”部分看到我的应用程序的地址（我的意思是一切都与我的应用程序在启动时正确启动时相同）。但我的应用程序将不再在启动时运行。对我的事情有什么建议吗？PS：我想我应该稍微解释一下我的工作，我写了一个有完全相同问题的应用程序

```
 public Icon[] icons = new Icon[2] { new Icon("icon1.ico"), new Icon("icon2.ico") };
    public int counter = 0;

    private void button1_Click(object sender, EventArgs e)
    {
        notifyIcon1.Visible = true;
        timer1.Start();

    }

    private void timer1_Tick(object sender, EventArgs e)
    {
        counter %= 2;
        notifyIcon1.Icon = icons[counter];
        counter++; 
```

如您所见，该应用程序在每次滴答时都会更改通知图标的图标。使用此代码，该应用程序将不会在启动时运行。但是如果我删除该应用程序的图标更改功能，它实际上会在启动时运行

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T15:00:41.117

这需要心理调试，我猜您正在使用它们的*相对*路径名加载这些图标。像新图标（“foo.ico”）这样的东西。

只有将程序的默认工作目录设置在您希望的位置时，这才能正常工作。通常是，当您从 Visual Studio 启动程序或从桌面快捷方式启动程序时。但*不是*当您将其添加到运行注册表项时。Environment.CurrentDirectory 将设置在别处，通常是 Windows 目录。

您必须*始终*使用文件的完整路径名。获得该路径的一种简单方法是：

```
 var home = System.IO.Path.GetDirectoryName(System.Reflection.Assembly.GetEntryAssembly().Location);
    var path = System.IO.Path.Combine(home, "foo.ico");
    var icon = new Icon(path); 
```

但是肯定有比将图标存储为文件更好的方法，您可以将它们嵌入到您的程序中。项目 + 属性，资源选项卡。单击添加资源按钮上的箭头，添加现有文件并导航到您的 .ico 文件。现在该图标已嵌入您的程序中，您将永远不会忘记它，并且当您将程序部署到另一台机器上时也不会忘记复制它。代码也更简单：

```
 var icon = Properties.Resources.foo; 
```

# asp.net - 配置文件提供程序和属性已设置，但我无法访问配置文件属性

> ID：15137301
> 
> 赞同：0
> 
> 时间：2013-02-28T13:56:11.423
> 
> 标签：asp.net, .net, asp.net-mvc

我正在使用 MVC4，我想在配置文件中存储几个值。

为什么

```
TempData["badgerName"] = Profile.BadgerName; 
```

说 ProfileBase 不包含 BadgerName 的定义？

我已经设置了如下配置文件。

```
<profile defaultProvider="DefaultProfileProvider">
  <providers>
    <add 
      name="DefaultProfileProvider" 
      type="System.Web.Providers.DefaultProfileProvider, System.Web.Providers, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" 
      connectionStringName="FALContext" 
      applicationName="/" />
  </providers>
  <properties>
    <add name="BadgerName" type="String"/>
  </properties>
</profile> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T20:38:40.020

在 ASP MVC 中，您没有使用 web.config 文件中定义的属性为您的站点生成配置文件对象。`Profile`可以从控制器方法访问的属性属于类型`ProfileBase`（[请参阅 msdn](http://msdn.microsoft.com/en-us/library/system.web.mvc.controller.profile%28v=vs.108%29.aspx)），并且不包含自定义配置文件属性的强类型属性。您可能还知道，在请求开始时为登录用户加载此配置文件，并且在请求结束时保存任何更改。

您可以通过[不同的方式](http://www.codeguru.com/csharp/.net/net_asp/article.php/c19797/Dealing-with-Profile-Access-in-ASPNET-MVC-Applications.htm)`ProfileBase`来上课。最常用的是：

*   直接使用 ProfileBase 类
*   创建派生的自定义配置文件类。

直接使用时`ProfileBase`，您需要使用控制器方法中的实例或获取给定用户名的实例。然后您应该使用索引器来访问配置文件属性。假设您的控制器方法收到一个 UserModel 类型的对象，其中包含您的用户数据，例如电子邮件和 BadgerName，那么您可以编写如下代码：

```
//Getting the instance from the controller property:
ProfileBase profile = this.Profile; //or even: this.HttpContext.Profile
//You can also get the profile for a given existing user.
ProfileBase profile = ProfileBase.Create(userModel.Name);

//Then update properties using indexer 
profile["Email"] = userModel.Email;
profile["BadgerName"] = userModel.BadgerName; 
//Manually save changes
//(Can be skipped for the profile automatically loaded in the Controller)
profile.Save(); 
```

但是，如果您从 中创建派生类`ProfileBase`，您最终将以与最初预期相同的方式使用您的类。您将基本上创建一个具有强类型属性的包装类，该类使用索引器在内部访问 ProfileBase（方法摘要在[这里](https://stackoverflow.com/questions/8305233/asp-net-mvc-3-user-profiles-not-being-generated)）：

```
public class MyCustomProfile : ProfileBase
{                       
    public string Email
    {     
        get { return base["Email"] as string; }     
        set { base["Email"] = value; }
    }

    public string BadgerName
    {     
        get { return base["BadgerName"] as string; }     
        set { base["BadgerName"] = value; }
    }

    //If needed, you can provide methods to recover profiles 
    //for the logged in user or any user given its user name
    public static MyCustomProfile GetCurrent()
    {
        return Create(Membership.GetUser().UserName) as MyCustomProfile;
    }

    public static MyCustomProfile GetProfile(string userName)     
    {
        return Create(userName) as MyCustomProfile;     
    }
} 
```

如果您使用此选项，您还需要确保`<profile>`web.config 的元素具有`inherits`设置为您的自定义模型类的属性：

```
<profile enabled="true" defaultProvider="DefaultProfileProvider" inherits="yourNamespace.MyCustomProfile"> 
```

有了这个代码和配置，您可以通过自己恢复用户配置文件或将控制器配置文件属性转换为您的自定义类来开始使用您的自定义配置文件类：

```
//Cast the Profile property of the controller to your custom class
MyCustomProfile profile = this.Profile as MyCustomProfile // or even: HttpContext.Profile as MyCustomProfile
//You could also manually load the profile for given an user name 
profile = MyCustomProfile.GetProfile(userModel.Name); 
//Or even manually load the profile for the logged in user
profile = MyCustomProfile.GetCurrent();

//Now get/set the profile properties using the strongly typed properties of your class
profile.Email= userModel.Email;
profile.BadgerName= userModel.BadgerName;
//Manually save changes
//(Can be skipped for the profile automatically loaded in the Controller)
profile.Save(); 
```

希望这可以帮助！

# json - 以排序方式获取 facebook graph api 调用的输出？

> ID：15137302
> 
> 赞同：0
> 
> 时间：2013-02-28T13:56:11.637
> 
> 标签：json, facebook, facebook-graph-api

有没有一种方法可以根据某些特定字段的值对从 facebook graph api 调用收到的 json 进行排序？

# c++ - 如何强制操作系统（Windows）为每个调试会话为我的程序分配相同的地址？

> ID：15137306
> 
> 赞同：3
> 
> 时间：2013-02-28T13:56:21.593
> 
> 标签：c++, debugging, windows-7, memory-corruption, aslr

经过长时间的调试，我发现我的应用程序可能将错误的值写入地址 0x5b81730。我想知道我的代码的哪一部分是这样做的。

前段时间，当我使用 Windows XP 时，这将非常容易。我会在调试器（MS Visual Studio 2005）中重新启动我的应用程序，在该地址设置一个数据断点，然后调试器会指向我有问题的代码。

现在，在我切换到 Windows 7 之后，这似乎是不可能的（或者至少非常困难）。当我运行我的应用程序时，我发现每次堆中同一对象的地址都略有不同（例如，一次运行为 0x53b71b4，而另一次运行为 0x55471b4）。

我听说 Windows 7 有[ASLR](http://en.wikipedia.org/wiki/Address_space_layout_randomization)，这可能是我看到这些地址变化的原因。

那么我该怎么做才能继续使用我的调试技术呢？

我应该关闭 ASLR 吗？（我相信这是可能的，但不知道怎么做）

还是我的问题是由其他原因而不是 ASLR 引起的？

还是我应该忘记使用数据断点的便利，而使用其他一些技术？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-28T14:01:45.380

如果您使用的是 UB 之类的东西，则绝对不能保证地址是什么。你不能指望它每次都一样。

但是，您可以尝试在链接器设置中禁用 ASLR - 其中一个属性是“随机基地址”。

命令行语法是`/DYNAMICBASE:NO`. 它在 Visual Studio 2005 中不存在，但在 VS 2012 及更高版本中确实存在。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T14:05:56.257

我会尝试使用[Application Verifier](http://www.microsoft.com/en-us/download/details.aspx?id=20028)。这是调试内存泄漏问题的好方法。当存在内存损坏问题时，它将中断代码的执行。

# java - AtomicInteger.incrementAndGet() 与 AtomicInteger.getAndIncrement()

> ID：15137308
> 
> 赞同：50
> 
> 时间：2013-02-28T13:56:22.120
> 
> 标签：java, atomic, java.util.concurrent

当返回值不感兴趣时​​，当返回值被忽略时，[`AtomicInteger.getAndIncrement()`](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/concurrent/atomic/AtomicInteger.html#getAndIncrement%28%29)和方法之间是否有任何（甚至在实践中不相关）区别？[`AtomicInteger.incrementAndGet()`](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/concurrent/atomic/AtomicInteger.html#incrementAndGet%28%29)

我正在考虑哪些差异会更惯用，以及哪些会减少 CPU 缓存同步的负载，或者其他任何真正有助于决定哪个比扔硬币更合理使用的东西。

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2013-03-01T09:29:22.307

由于没有给出实际问题的答案，因此这是我基于其他答案（感谢，赞成）和 Java 约定的个人意见：

```
incrementAndGet() 
```

更好，因为方法名称应该以描述动作的动词开头，而这里的预期动作只是递增。

以动词开头是常见的 Java 约定，官方文档也有描述：

[“方法应该是动词，混合大小写，首字母小写，每个内部单词的首字母大写。”](http://www.oracle.com/technetwork/java/javase/documentation/codeconventions-135099.html#367)

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2013-02-28T13:58:11.443

代码本质上是相同的，所以没关系：

```
public final int getAndIncrement() {
    for (;;) {
        int current = get();
        int next = current + 1;
        if (compareAndSet(current, next))
            return current;
    }
}

public final int incrementAndGet() {
    for (;;) {
        int current = get();
        int next = current + 1;
        if (compareAndSet(current, next))
            return next;
    }
} 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2013-02-28T13:58:20.950

不，没有区别（如果您不关心返回值）。

这些方法的代码（在 OpenJDK 中）的不同之处*仅*在于一种用途`return next`和另一种用途`return current`。

两者都`compareAndSet`在引擎盖下使用完全相同的算法。两者都需要*知道*旧值和新值。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2017-08-30T19:17:25.773

只是想添加到现有的答案：可能会有非常小的不明显的差异。

如果您查看[此实现](http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/8-b132/java/util/concurrent/atomic/AtomicInteger.java#AtomicInteger.getAndIncrement%28%29)：

```
public final int getAndIncrement() {
    return unsafe.getAndAddInt(this, valueOffset, 1);
}

public final int incrementAndGet() {
    return unsafe.getAndAddInt(this, valueOffset, 1) + 1;
} 
```

注意 - 两个函数调用完全相同的函数`getAndAddInt`，除了`+1`部分，这意味着在这个实现`getAndIncrement`中更快。

但是，这是[较旧的实现](http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/6-b14/java/util/concurrent/atomic/AtomicInteger.java#AtomicInteger.getAndIncrement%28%29)：

```
public final int getAndIncrement() {
    for (;;) {
        int current = get();
        int next = current + 1;
        if (compareAndSet(current, next))
            return current;
    }
}

public final int incrementAndGet() {
    for (;;) {
        int current = get();
        int next = current + 1;
        if (compareAndSet(current, next))
            return next;
    }
} 
```

唯一的区别是返回变量，所以两个函数的执行完全相同。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2017-06-02T10:31:58.207

这里我举个例子。希望它能消除你的疑惑。

假设我有一个变量 i 作为

AtomicInteger i = new AtomicInteger();

## 在这种情况下：

i.getAndIncrement() <==> i++;

和

i.incrementAndGet() <==> ++i;

**请查看以下程序**

```
public class Test1
{   
    public static void main(String[] args) 
    {               
        AtomicInteger i = new AtomicInteger();
        System.out.println(i.incrementAndGet());  
        System.out.println(i);  

    }

} 
```

## **输出

1 1 =======================================**

```
public class Test2
{   
    public static void main(String[] args) 
    {               
        AtomicInteger i = new AtomicInteger();
        System.out.println(i.getAndIncrement());  
        System.out.println(i); 

    }

} 
```

## **输出

0 1 -------------**

注释： 1) 在Test1 类中，incrementAndGet() 将首先递增i 值，然后打印。

2) 在Test2 类中，getAndIncrement() 将首先打印i 值，然后递增。

*就这样。*

# php - 在 Zend/Doctrine PHP 应用程序中重命名 MySQL 表失败？

> ID：15137316
> 
> 赞同：0
> 
> 时间：2013-02-28T13:56:36.653
> 
> 标签：php, mysql, zend-framework, doctrine

我有一个管理界面和游戏都使用的 PHP 后端应用程序。我知道我的 PHP 方式，但我不熟悉 Zend 和 Doctrine。

MySQL 中只有两个表（用于学校和学生），我想更改它们的名称前缀，因为它们指的是游戏的早期版本。

简而言之：我重命名了表，修改了所有 PHP 引用以使用新名称。Zend 和 Doctrine 文件夹中不再有旧名称的踪迹。但是现在 Web 应用程序失败了，因为它仍在寻找旧名称。

错误如下： **SQLSTATE[42S02]: Base table or view not found: 1146 Table 'db1.neverland_schools' 不存在**

所以发生的事情是我将表名从 neverland_schools 更改为 Adventure_schools。它仍在寻找旧的表名。

我怀疑这是*缓存*。但我没有对服务器的命令行访问权限，也没有通过命令行与 Doctrine 交谈的经验。

如果缓存是问题，是否有办法从 PHP 重置缓存？如果还有其他问题，我很想知道。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T18:07:42.680

您可以删除缓存数据：

1.  你可以 emoty 服务器的临时文件夹

2.  [删除学说缓存](http://docs.doctrine-project.org/projects/doctrine-orm/en/latest/reference/caching.html#deleting)

    $deleted = $cacheDriver->deleteAll();

也许您也应该清空代理文件夹。

您可以根据驱动程序验证您是否更改了元数据中的表名。如果您使用的是 yaml 或 xml，则 plin 文本搜索可能不会考虑文件格式。

**注释**

```
// entities/Product.php
/**
 * @Entity **@Table(name="products")**
 **/ 
```

**xml**

```
<entity name="Product" table="products"> 
```

**yaml**

```
# config/yaml/Product.dcm.yml
Product:
  type: entity
  table: products 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T14:51:05.763

如果您定义了基类您必须更改学校和学生`base`班级的名称。基类的路径在您的配置或引导文件中。

如果没有，您是否尝试过明确设置表名，如下面方法的第一行？

```
class Adventure_Schools extends Doctrine_Record { 
    public function setTableDefinition () { 
        $this->setTableName('adventure_schools');
... 
```

# c# - 添加默认节点以过滤控件 Devexpress

> ID：15137317
> 
> 赞同：1
> 
> 时间：2013-02-28T13:56:37.407
> 
> 标签：c#, devexpress

当打开一些默认参数的过滤器控件出现给用户时，我需要知道如何向过滤器控件添加模式我尝试如下

```
 [C#]Open in popup window
private void Padroes(ControleCaixaFiltro _controleCaixaFiltro, PropertyInfo prop)
{
           CustomClauseNode clausula = new CustomClauseNode(_controleCaixaFiltro.Model);                
           FilterControlHelpers.ForceAdditionalParamsCount(clausula.AdditionalOperands, 1);
           clausula.Operation = ClauseType.Equals;     
           clausula.FirstOperand = new OperandProperty(prop.Name);
           clausula.ChangeElement(ElementType.Operation);
           _controleCaixaFiltro.NoPrincipal.SubNodes.Add(clausula);
} 
```

问题是节点以这种方式出现，但您无法通过单击“x”侧来删除它们

devexpress的版本是2012

此代码不起作用

```
protected override ClauseNode CreateDefaultClauseNode(FilterColumn column)
    {
        ClauseNode defaultNode = base.CreateDefaultClauseNode(column);
        if (defaultNode.AdditionalOperands.Count > 0)
        {
            OperandValue rightOperand = defaultNode.AdditionalOperands[0] as OperandValue;
            if (rightOperand != null)
            {
                rightOperand.Value = DateTime.Now;
            }
        }

        return defaultNode;
    } 
```

# python - fabric：连接到远程服务器，然后在 sudo su - user2 之后执行命令

> ID：15137318
> 
> 赞同：0
> 
> 时间：2013-02-28T13:56:39.153
> 
> 标签：python, ssh, fabric

我需要编写一个 python 脚本，它必须能够连接到远程服务器（到 user1），执行一些命令（这​​很容易），然后它必须通过 sudo su - user2 切换到 user2，并执行一些命令（问题在这儿）。如何在不询问我密码的情况下切换到 user2（我可以将密码放在脚本中的某个位置），并以 user2 身份执行命令。

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T14:25:09.687

尝试`-S`（大写“S”）。引用 sudo 手册页：

```
 -S          The -S (stdin) option causes sudo to read the password from
               the standard input instead of the terminal device. 
```

# r - 数据帧到矩阵的转换：错误

> ID：15137319
> 
> 赞同：1
> 
> 时间：2013-02-28T13:56:42.647
> 
> 标签：r, matrix, dataframe

我想使用`rowttests`package:genefilter 中的函数。`rowtests`函数参数是：

```
>rowttests(x, fac)

x: Numeric matrix. The matrix must not contain ‘NA’ values.  For
      ‘rowttests’ and ‘colttests’, ‘x’ can also be an
      ‘ExpressionSet’.
fac: Factor which codes the grouping to be tested. 
```

所以，我的输入是下面的数据框，我执行了以下步骤但得到了错误..

```
> dataframe
V1 V2 V3 V4
1  1  5  6  7
2  2  6  7  8
3  3  7  8  9
4  4  8  9 10
5  5  9 10 11
6  6 10 11 12
7  7 11 12 13

>mat <-as.matrix(dataframe)
> mat
 V1 V2 V3 V4
[1,]  1  5  6  7
[2,]  2  6  7  8
[3,]  3  7  8  9
[4,]  4  8  9 10
[5,]  5  9 10 11
[6,]  6 10 11 12
[7,]  7 11 12 13

>fac <- factor(c(1,1,2,2)) 
```

错误是：

```
rowttests(mat, fac)
Error in rowcoltt(x, fac, tstatOnly, 1L) :
Invalid argument 'x': must be a real matrix.

> mode(mat)
[1] "numeric"

> class(mat)
[1] "matrix" 
```

我也试过：

```
>mat1 <-matrix((stack(dataframe))[[1]],nrow=7, ncol=4)
>mat1
  [,1] [,2] [,3] [,4]
[1,]    1    5    6    7
[2,]    2    6    7    8
[3,]    3    7    8    9
[4,]    4    8    9   10
[5,]    5    9   10   11
[6,]    6   10   11   12
[7,]    7   11   12   13 
```

同样的错误

```
rowttests(mat1, fac)
Error in rowcoltt(x, fac, tstatOnly, 1L)
Invalid argument 'x': must be a real matrix. 
```

谁能告诉我如何将数据框转换为矩阵，以便可以在 rowttests 函数中使用它？

# javascript - 没有控制器的 angularJS 中的 $http

> ID：15137321
> 
> 赞同：0
> 
> 时间：2013-02-28T13:56:43.697
> 
> 标签：javascript, ajax, angularjs

伙计们是否可以在不使用控制器的情况下获得 angularJS 的 $http ajax 功能？

目前我有工厂，我想在那里进行数据库操作：

```
var Services = angular.module('App.Services', []);

Services.factory('Data', function () {

    var data;

    return {
        get:function (id) {
            return merchants[id];
        },
        getAll:function () {
            $http({method: 'GET', url: '/api/merchants'}).
                success(function(data, status, headers, config) {
                    console.log(arguments);
                }).
                error(function(data, status, headers, config) {
                    console.log(arguments);
                });
            return data.slice(0);
        },
        add:function (_data) {
            _data.id = data.length;
            data.push(_data);
        },
        save:function (_data) {
            merchants[_data.id] = _data;
        },
        remove:function (_data) {
            delete merchants[_data.id];
        }
    }

}); 
```

我现在如何使用 $http ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T13:59:19.367

您可以在任何服务中使用任何服务。像这样注入它：

```
Services.factory('Data', function ($http) {

   // use $http
}); 
```

# sql - 节点属性和所有子节点中的 JCR SQL2 全文搜索

> ID：15137322
> 
> 赞同：2
> 
> 时间：2013-02-28T13:56:44.170
> 
> 标签：sql, jcr

我正在尝试在 JCR SQL2 中进行全文搜索。查询应返回至少具有一个包含搜索字符串的属性的所有节点，或者它们具有包含相同字符串的属性的子节点。这是我到目前为止所拥有的：

```
select * from [nt:base] as t where ocm_classname = 'info.magnolia.cv.CurriculumVitae' and contains(t.*, 'java') 
```

这解决了第一部分，选择具有指定`ocm_classname`和至少一个包含单词“java”的属性的所有节点。但是我不知道如何搜索不具有包含单词“java”的属性但具有包含该单词的属性的子节点的节点。例如，应该找到这个节点：

```
<sv:node sv:name="cv1362044004066">
    <sv:property sv:name="jcr:primaryType" sv:type="Name">
        <sv:value>nt:unstructured</sv:value>
    </sv:property>
    <sv:property sv:name="address" sv:type="String">
        <sv:value>Chicago, IL</sv:value>
    </sv:property>
    <sv:property sv:name="currentDepartment" sv:type="String">
        <sv:value>dotNet</sv:value>
    </sv:property>
    <sv:property sv:name="currentRole" sv:type="String">
        <sv:value>Project Manager</sv:value>
    </sv:property>
    <sv:property sv:name="dateOfBirth" sv:type="Date">
        <sv:value>1981-01-14T00:05:00.000-05:00</sv:value>
    </sv:property>
    <sv:property sv:name="id" sv:type="String">
        <sv:value>1362044004066</sv:value>
    </sv:property>
    <sv:property sv:name="name" sv:type="String">
        <sv:value>John Carpenter</sv:value>
    </sv:property>
    <sv:property sv:name="ocm_classname" sv:type="String">
        <sv:value>info.magnolia.cv.CurriculumVitae</sv:value>
    </sv:property>
    <sv:node sv:name="skills">
        <sv:property sv:name="jcr:primaryType" sv:type="Name">
            <sv:value>nt:unstructured</sv:value>
        </sv:property>
        <sv:node sv:name="collection-element">
            <sv:property sv:name="jcr:primaryType" sv:type="Name">
                <sv:value>nt:unstructured</sv:value>
            </sv:property>
            <sv:property sv:name="level" sv:type="String">
                <sv:value>Advanced</sv:value>
            </sv:property>
            <sv:property sv:name="name" sv:type="String">
                <sv:value>Management</sv:value>
            </sv:property>
            <sv:property sv:name="ocm_classname" sv:type="String">
                <sv:value>info.magnolia.cv.CVSkills</sv:value>
            </sv:property>
        </sv:node>
        <sv:node sv:name="collection-element">
            <sv:property sv:name="jcr:primaryType" sv:type="Name">
                <sv:value>nt:unstructured</sv:value>
            </sv:property>
            <sv:property sv:name="level" sv:type="String">
                <sv:value>Advanced</sv:value>
            </sv:property>
            <sv:property sv:name="name" sv:type="String">
                <sv:value>Scrum</sv:value>
            </sv:property>
            <sv:property sv:name="ocm_classname" sv:type="String">
                <sv:value>info.magnolia.cv.CVSkills</sv:value>
            </sv:property>
        </sv:node>
        <sv:node sv:name="collection-element">
            <sv:property sv:name="jcr:primaryType" sv:type="Name">
                <sv:value>nt:unstructured</sv:value>
            </sv:property>
            <sv:property sv:name="level" sv:type="String">
                <sv:value>Advanced</sv:value>
            </sv:property>
            <sv:property sv:name="name" sv:type="String">
                <sv:value>Java</sv:value>
            </sv:property>
            <sv:property sv:name="ocm_classname" sv:type="String">
                <sv:value>info.magnolia.cv.CVSkills</sv:value>
            </sv:property>
        </sv:node>
        <sv:node sv:name="collection-element">
            <sv:property sv:name="jcr:primaryType" sv:type="Name">
                <sv:value>nt:unstructured</sv:value>
            </sv:property>
            <sv:property sv:name="level" sv:type="String">
                <sv:value>Intermediate</sv:value>
            </sv:property>
            <sv:property sv:name="name" sv:type="String">
                <sv:value>Spring</sv:value>
            </sv:property>
            <sv:property sv:name="ocm_classname" sv:type="String">
                <sv:value>info.magnolia.cv.CVSkills</sv:value>
            </sv:property>
        </sv:node>
    </sv:node>
</sv:code> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-28T15:08:37.043

您需要使用 JOIN 子句，但在 WHERE 子句中使用 OR：

```
SELECT parent.* 
FROM [nt:base] AS parent 
INNER JOIN [nt:base] AS child ON ISCHILDNODE(child,parent)
WHERE parent.ocm_classname = 'info.magnolia.cv.CurriculumVitae' 
  AND ( CONTAINS(parent.*, 'java') OR CONTAINS(child.*,'java') ) 
```

这将创建两个选择器`parent`和`child`，并使用`ISCHILDNODE`连接条件来确保`child`选择器中的节点是选择器中节点的子节点`parent`。然后，它使用 OR 标准将包含“java”的父节点或包含“java”的子节点包含在结果中。

# iphone - 如何在 ios6 iphone App 中使用 Facebook 或 twitter 创建登录

> ID：15137324
> 
> 赞同：0
> 
> 时间：2013-02-28T13:56:56.033
> 
> 标签：iphone, ios, facebook, twitter

我是 iOS 开发的新手。在我的应用程序中，主页用于登录应用程序。我需要提供使用 Facebook 和 twitter 登录的便利。我正在使用 iOS 6.1，并且我有社交框架。

请告诉我一个简单的方法来实现这一点，我试图阅读 facebook 开发者教程，但我无法从那里赶上。

如果您有任何示例项目或任何好的教程链接，请与我分享。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T14:32:46.570

Facebook sdk github repo 在[这里](https://github.com/facebook/facebook-ios-sdk)。

您可以在其中找到许多示例项目。Facebook[身份验证](https://developers.facebook.com/docs/tutorials/ios-sdk-tutorial/authenticate/)指南也非常清楚地解释了登录部分。

# javascript - 使用 Wheel JavaScript 创建具有水平滚动的扩展 DIV/Canvas

> ID：15137325
> 
> 赞同：0
> 
> 时间：2013-02-28T13:56:55.983
> 
> 标签：javascript, html, scroll, mouse, mousewheel

好的 - 这就是我想要做的。我在网上寻找可以购买的很酷的时间线——允许放大缩小、在上面发布事件等等。但是，我发现的所有示例要么太昂贵，要么完全没用。

所以，我决定创建自己的，但有两个元素我遇到了麻烦。

1）将滚轮滚动转换为左右滚动（所以不是上下滚动）。我似乎找不到一种简单快捷的方法来做到这一点。

但是，更重要的是..

2) 我需要在滚动时自动扩展显示时间线的区域。因此，如果我向下滚动，它将在右侧添加一个“等效”区域，然后在左侧添加一个“等效”区域。所以我想制作一个iFrame（已经使用这些），当你滚动它时，它只会在左侧或右侧添加更多“时间线”，从数据库/事件列表中加载它需要加载的内容，等等， ad infinitum，从而创建了一个不断扩展的时间大小的块列表。

如果我能做到以上两件事，那么我就做好了——剩下的（加载/定位）我可以弄清楚——只是这两件事正在逃避我的想象力和找到答案的能力。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T16:26:23.483

基本上你需要一个水平无限滚动脚本。

拿我写的这个插件：

```
 $.fn.hScroll = function( options )
 {
  function scroll( obj, e )
  {
    var evt = e.originalEvent;
    var direction = evt.detail ? evt.detail * (-120) : evt.wheelDelta;

    if( direction > 0)
    {
        direction =  $(obj).scrollLeft() - 120;
    }
    else
    {
        direction = $(obj).scrollLeft() + 120;
    }

    $(obj).scrollLeft( direction );

    e.preventDefault();
  }

  $(this).width( $(this).find('div').width() );

  $(this).bind('DOMMouseScroll mousewheel', function( e )
  {
      scroll( this, e );
  });
} 
```

初始化它：

```
 $('body').hScroll(); 
```

使您的网站成为可水平滚动的网站。

您的内容 div 必须比您的 body 宽（例如 3000 像素）。

至于无限滚动效果，你几乎必须自己做，因为我不知道你会输入什么样的数据。但我会解释的。

内容 div 中的子元素必须向左浮动。（每个新附加的 div 都不会换行）。

设置一个间隔来检查用户的 scrollLeft 位置是否接近内容的末尾（就像 pinterest 和类似网站一样）。

```
 function loadNewData(){ /* Your search for data and update here. */ }
    setInterval('loadNewData', 500); 
```

使用 AJAX 根据您最后的数据搜索新数据。当您获得新数据时，将其附加到您的内容 div 中（在一个向左浮动的 div 中，如我之前所写），并将其标记为您的最后一项。

也许你可以使用你的 ID 来标记它的 div 上的最后一项。

```
 <div data-id="467" class="item"> // your data here  </div> 
```

你可以用

```
 $('.item:last').attr('data-id'); 
```

用 jQuery。

# asp.net - 从 ASP.NET 搜索 Active Directory

> ID：15137328
> 
> 赞同：0
> 
> 时间：2013-02-28T13:57:10.443
> 
> 标签：asp.net, .net, exception, search, iis

我有一个 asp.net 网站，它使用以下代码在 Active Directory 中搜索用户详细信息：

```
public static SearchResult GetUserProfileFromAD(string username)
{
    DirectorySearcher searcher = new DirectorySearcher("(&(objectCategory=person)(sAMAccountName=" + username + "))");
    return searcher.FindOne();
} 
```

该网站在 Windows Server 2003 和 IIS5 上运行良好。最近我将网站移动到带有 IIS7.5 的新 Windows Server 2008 我将应用程序添加到 iis 并连接网站，我收到此错误：

> 搜索过滤器`(&(objectCategory=person)(sAMAccountName=))`无效。说明：执行当前 Web 请求期间发生未处理的异常。请查看堆栈跟踪以获取有关错误及其源自代码的位置的更多信息。
> 
> 异常详细信息：System.ArgumentException：(&(objectCategory=person)(sAMAccountName=)) 搜索过滤器无效。

当我通过 Visual Studio 运行我的网站时，它可以工作。问题仅来自IIS。

有人能帮我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T14:00:25.130

错误显然是因为“用户名”是一个空字符串。这很可能是因为您的用户正在匿名登录您的网站。请确保在 IIS 中禁用匿名访问。

但是，如果您可以显示调用`GetUserProfileFromAD`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T14:00:15.787

您的“用户名”变量为空，导致您的过滤器以等号终止（实际上是无效的） 如果不了解您的设置，很难说。但这听起来很明显，您没有为新服务器上的网站正确设置身份验证-导致您必须填写用户名的任何例程都无法取回任何东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-28T14:01:15.823

在我看来，变量用户名没有被填充，如果你说你将它移动到 IIS 尝试再次检查安全选项，可能还没有配置 Windows 身份验证。

# php - AJAX 从 php 加载函数

> ID：15137331
> 
> 赞同：1
> 
> 时间：2013-02-28T13:57:25.883
> 
> 标签：php, jquery, ajax

;-) 我撞到了一堵砖墙。今天，我有生以来第一次见到了阿贾克斯。我明白，我的问题看起来很愚蠢。但我需要你的帮助。

我有一个 php 文件（例如 index.php），它有一个包含（*function.php*）。在文件*function.php*我有一个函数（例如`function Jokes(){....}`）。

我想使用 AJAX 在我的页面中加载此功能。但我不知道该怎么做...... :-(

我找到了一些简单的解决方案（我使用 Jquery 加载功能），但这不是我想要的，因为我必须使用单独的文件。

```
$('#jokes').load('jokes.php'); 
```

但我需要类似的东西：

```
$('#jokes').load('function.php','jokes()'); 
```

有什么帮助或想法吗？将不胜感激。

PS：对不起我的英语不好......））

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T14:04:26.453

您可以做的是制作一个 AJAX 文件，例如 ajaxfunctions.php，您可以在其中划分功能。

```
$('#jokes').load("ajax.php", { 'function': 'jokes' } ); 
```

在您的 PHP 文件 ajax.php 中，您可以这样做：

```
<?php
include 'function.php';
if (isset ($_POST['function']) && $_POST['function'] == 'jokes')
{
    echo jokes ();
}
?> 
```

这对你有帮助吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T14:02:04.593

浏览器（以及 Ajax）只能向服务器发出 HTTP 请求。

它不能执行特定的功能。

您必须编写能够识别特定 URL 的服务器端代码（例如，写入仅调用该函数的脚本，或根据查询字符串决定运行哪个函数的脚本）并执行特定函数以响应请求给它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-28T14:02:23.323

不，这是不可能的。您必须向 url 发出请求。您不能只从 php 文件中调用特定函数。

为您需要的功能构建一个 url 包装器。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-28T14:02:54.533

不要那样做。Ajax 用于发送或检索数据，但您要做的是加载 PHP 文件中定义的 Javascript 函数（不是吗？）。相反，只需在 JS 文件中定义您的 Javascript 函数并通过脚本加载它（或者，如果应该动态加载，您可以使用 AMD 加载器，如 require.js）

如果你想在 JS 中加载一个 PHP 函数，那是不可能的。不过，您可以调用该函数并获取其结果。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-28T14:03:50.217

它不像这样工作。

```
$('#jokes').load('jokes.php'); 
```

向jokes.php 发出http 请求。如果要执行特定功能，可以使用参数，如下所示：

```
$('#jokes').load('jokes.php?func=jokes'); 
```

从您的 php 脚本中，获取 'func' 并执行正确的功能。

```
...
function jokes() {
   return 'some output';
}

...
$func='';
if (!empty($_REQUEST['func'])) {
  $func=$_REQUEST['func'];
}

if ($func=='jokes') {
  echo jokes();  
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-28T14:05:53.657

为此，您不需要 AJAX。您想将 Jokes() 函数放在一个 JavaScript 文件中，可能称为 Jokes.js，将其包含在 index.php 中，然后在 index.php 中的 JavaScript 块中正常调用它。

# javascript - 为什么当我点击 li 时会触发 ul？

> ID：15137332
> 
> 赞同：3
> 
> 时间：2013-02-28T13:57:26.240
> 
> 标签：javascript, jquery, onclick, live

我有这个html：

```
 <ul class='loc-list'>  
     <li id="where_7" class="cont-list">North America
         <ul>
            <li id="contry_114" class="contry-list">canada</li>
            <li id="contry_115" class="contry-list">mexico</li>
            <li id="contry_117" class="contry-list">united states</li>
         </ul>
     </li>
 </ul> 
```

现在我已经编写了两个 jquery 函数 onclick 列表为：

**第一：^_**

```
$(".cont-list").on("click", function(event){
     alert("clicked on continent's list"); // working fine
 }; 
```

**第二：^_**

```
$(".contry-list").on("click", function(event){
     alert("clicked on country's list");  // not working!
 }; 
```

在这里，当我单击**cont-list**时，它会被调用，但是在**第二个^(函数)**中它**没有**被调用，而是**第一个^(函数)**被调用！

是因为它是一个内部列表吗？如果是这样，那么如何处理它以便仅在单击该列表时才调用它？

[**演示在这里**](http://jsfiddle.net/Sandip007/nuCPv)

提前致谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-28T14:00:49.530

那是因为事件冒泡了，你可以使用对象`stopPropagation`的方法`event`：

```
$(".contry-list").on("click", function(event){
     event.stopPropagation();
     alert("clicked on country's list");  
}); 
```

如果要`li`动态生成元素，则应委托事件：

```
$(document).on('click', '.coutry-list', function(){
   console.log('li element is clicked');
}) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T14:00:35.390

```
$(".contry-list").on("click", function(event){
     event.stopPropagation();
     alert("clicked on country's list");
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-28T14:01:51.863

需要使用[event.stopPropagation()](http://api.jquery.com/event.stopPropagation/)

```
$(".contry-list").on("click", function(e){
     e.stopPropagation();
     alert("clicked on country's list");
}); 
```

[**在这里演示**](http://jsfiddle.net/pT4ca/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-28T14:07:19.740

jQuery 中的修复是：

```
$(".contry-list").on("click", function(event){
     alert("clicked on country's list");  // not working!
    return false; 
}); 
```

但正如 epascarello 指出的那样，您应该了解 DOM 事件冒泡（和捕获）以理解它。

# r - 在R中将数据框或矩阵除以向量

> ID：15137334
> 
> 赞同：2
> 
> 时间：2013-02-28T13:57:46.747
> 
> 标签：r, scale, normalization, division

这似乎不应该太难，但我很难做到这一点。例如，我有以下数据框：

```
set.seed(99)
data <- data.frame(Names=rep(c('A','B'),5),
                   First = rnorm(10),
                   Second = rnorm(10),
                   Third = rnorm(10)) 
```

我想要的是将整个数据框除以 A 的平均值。我可以通过以下方式计算：

> a.mean <- sapply(data[data$Names == 'A', 2:4], mean)

但是当我尝试将整个数据框除以这样的向量时，我没有得到正确的值：

```
normalized.data <- data[2:4]/a.mean
normalized.data$Names <- data$Names
sapply(data[normalized.data$Names == 'A', 2:4], mean)

First     Second      Third 
0.2578018 -0.5864073  0.1156760 
```

我想要的是 A 的标准化平均值现在等于 1。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-28T14:16:24.513

```
set.seed(99)
data <- data.frame(Names=rep(c('A','B'),5),
                   First = rnorm(10),
                   Second = rnorm(10),
                   Third = rnorm(10))

a.mean <- sapply(data[data$Names == 'A', 2:4], mean)
data[,2:4] <- sweep(data[,2:4],MARGIN=2,a.mean,"/")

(norm.mean <- sapply(data[data$Names == 'A', 2:4], mean))
## First Second  Third 
##     1      1      1 
```

根据您的应用程序，将`Names`列改为行名可能更容易：

```
data <- data.frame(First = rnorm(10),
                   Second = rnorm(10),
                   Third = rnorm(10),
                   row.names=rep(c('A','B'),5)) 
```

我也喜欢`subset(data,Names=='A')`可读性（尽管不推荐用于编程：请参阅[https://github.com/hadley/devtools/wiki/Evaluation](https://github.com/hadley/devtools/wiki/Evaluation)）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-28T14:17:20.380

```
set.seed(99)
data <- data.frame(Names=rep(c('A','B'),5),
                   First = rnorm(10),
                   Second = rnorm(10),
                   Third = rnorm(10))

a.mean <- colMeans(data[data$Names == 'A', 2:4])

normalized.data <- as.data.frame(t(t(data[,2:4])/a.mean))

normalized.data$Names <- data$Names
colMeans(normalized.data[normalized.data$Names == 'A', 1:3])

#First Second  Third 
#1      1      1 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-28T14:20:58.783

哦，没关系：你并没有像你认为的那样分裂。将矩阵除以值向量不会将每一列除以给定值。

```
Rgames> foo
     [,1] [,2] [,3]
[1,]    5    3    7
[2,]    5    3    7
[3,]    5    3    7
[4,]    5    3    7
[5,]    5    3    7
Rgames> foo/c(1,2,3)
         [,1] [,2]     [,3]
[1,] 5.000000  1.0 3.500000
[2,] 2.500000  3.0 2.333333
[3,] 1.666667  1.5 7.000000
[4,] 5.000000  1.0 3.500000
[5,] 2.500000  3.0 2.333333 
```

# iphone - UISlider 轨迹图像在滑动时消失

> ID：15137335
> 
> 赞同：0
> 
> 时间：2013-02-28T13:57:49.830
> 
> 标签：iphone, ios, uikit, uislider

我有这段代码可以创建自定义 UISlider。当我快速滑动到末尾时，left_image.png 不显示，但如果我不滑动，它可以正常工作。

```
[sliderFPS setMinimumTrackImage:[UIImage imageNamed:@"left_slider.png"]
                       forState:UIControlStateNormal];
[sliderFPS setMaximumTrackImage:[UIImage imageNamed:@"right_slider.png"]
                       forState:UIControlStateNormal];

[sliderFPS setThumbImage:[UIImage imageNamed:@"thumb_slider.png"]      
                forState:UIControlStateNormal]; 
```

我花了两个多小时，但找不到任何解决方案。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-28T14:08:34.807

添加这个：

```
#define SYSTEM_VERSION_GREATER_THAN_OR_EQUAL_TO(v)  ([[[UIDevice currentDevice] systemVersion] compare:v options:NSNumericSearch] != NSOrderedAscending)

if (SYSTEM_VERSION_GREATER_THAN_OR_EQUAL_TO(@"6.0"))
{
    [[UISlider appearance] setMinimumTrackImage:[[UIImage imageNamed:@"ios6_slider_minimum_value"] resizableImageWithCapInsets:UIEdgeInsetsMake(0, 10, 0, 0)] forState:UIControlStateNormal];
    [[UISlider appearance] setMaximumTrackImage:[[UIImage imageNamed:@"ios6_slider_maximum_value"] resizableImageWithCapInsets:UIEdgeInsetsMake(0, 0, 0, 10)] forState:UIControlStateNormal];
}
else
{
    [[UISlider appearance] setMinimumTrackImage:[[UIImage imageNamed:@"slider_minimum_value"] resizableImageWithCapInsets:UIEdgeInsetsMake(0, 10, 0, 0)] forState:UIControlStateNormal];
    [[UISlider appearance] setMaximumTrackImage:[[UIImage imageNamed:@"slider_maximum_value"] resizableImageWithCapInsets:UIEdgeInsetsMake(0, 10, 0, 0)] forState:UIControlStateNormal];
}

[[UISlider appearance] setThumbImage:[UIImage imageNamed:@"slider_button"] forState:UIControlStateNormal];
[[UISlider appearance] setThumbImage:[UIImage imageNamed:@"slider_button"] forState:UIControlStateHighlighted]; 
```

# rspec - 使用 RSpec Request Spec 和 Capybara 设计身份验证在测试环境中不起作用

> ID：15137336
> 
> 赞同：1
> 
> 时间：2013-02-28T13:57:53.770
> 
> 标签：rspec, devise, ruby-on-rails-3.2, capybara, fabrication-gem

我一直试图让我的请求规范工作。我尝试了许多通过 Google 和 SO 找到的不同方法。以下是我在请求规范中单独尝试过的以下助手：

```
#spec/support/devise_request_spec_support.rb
module DeviseRequestSpecSupport

  def login(user)
    post user_session_path, login: user.email, password: 'foobar'
  end
end

#spec/support/utilities.rb
include ApplicationHelper

def valid_login(user)
  fill_in "user[email]", with: user.email
  fill_in "user[password]", with: 'foobar'
  click_button "Sign in"
end

def login(user)
  visit root_path
  valid_login(user)
end 
```

我在`#login`下面的请求规范中分别尝试了上述两种方法：

```
require 'spec_helper'

describe "Company Admin Dashboard", js: true do
    let(:user) { Fabricate(:company_admin) }

    before do
        login(user)
        poll = Fabricate(:poll)
        poll.send_to_all_users
    end

  describe "interacting with the poll box" do
    it "displays sent poll in poll box" do
      visit root_path
    end
  end
end 
```

测试将通过，但 root_path 不显示登录用户的登录页面。它显示了公共登录页面。我尝试使用 binding.pry 进行调试并尝试在测试环境中手动登录，但我不断收到“无效的电子邮件或密码”错误。我检查了很多次，但我一直在使用 Fabricated company_admin 的正确电子邮件和密码。

我也尝试过这里提出的解决方案：[https ://github.com/plataformatec/devise/wiki/How-To:-Test-with-Capybara](https://github.com/plataformatec/devise/wiki/How-To:-Test-with-Capybara)

任何帮助将不胜感激。不确定问题出在哪里。是 Fabrication gem、Devise、RSpec 还是 Capybara？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T05:13:20.207

您可以尝试使用“让！” 而不是“让”来创建用户。怀疑您尝试登录时尚未创建用户，因为您使用的是“let”的惰性版本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T14:44:20.427

我曾经有过同样的错误。我的错误突然出现，这是一个很大的惊喜。您应该注意到我有相同的宝石要测试：Devise、RSpec、Capybara 和 FactoryGirl（而不是 Fabrication）。

但是我们的问题之间存在差异：我的错误突然出现，所以我只是创建了一个单独的分支，我将 master 恢复到以前的提交，我发现我以某种方式更改了 spec_helper.rb（我实现了禁用垃圾收集器）。我恢复了提交，然后我的测试通过了。

我想你可以尝试接下来的事情：

1) 通过运行确保您用于测试的所有 gem 都是最新的`bundle outdated`

2）尝试更改`visit root_path`为`visit '/'`

3）启动`rails c test`，创建一个测试用户并确保保存的密码与测试的密码匹配。[在这里查看如何做到这一点](https://stackoverflow.com/questions/4320921/how-verify-user-password-in-devise)

4) 如果没有任何帮助，请尝试使用 FactoryGirl 而不是 Fabrication

# facebook - Facebook Graph API 获取 USER 令牌而不是 APP 令牌（phonegap）

> ID：15137339
> 
> 赞同：0
> 
> 时间：2013-02-28T13:57:56.860
> 
> 标签：facebook, api, cordova

我正在尝试通过 Graph API 在 Adob​​e PhoneGap 中实现 facebook 连接，但显然我正在取回“App”令牌而不是“User”令牌。这导致我的应用程序不允许任何其他用户连接到它，这当然不是重点。

我注意到这一点，因为无论我使用什么用户登录，返回的 access_token 总是相同的。

我正在使用以下 URL 进行身份验证：

```
 var authorize_url = "https://graph.facebook.com/oauth/authorize?";
    authorize_url += "client_id=" + fb_clientid;
    authorize_url += "&redirect_uri=" + fb_redirect_uri;
    authorize_url += "&display=" + fb_display;
    authorize_url += "&scope=publish_stream" 
```

并获取授权令牌：

```
https://graph.facebook.com/oauth/access_token?client_id='+fb_clientid+'&client_secret='+fb_secret+'&code='+fbCode+'&redirect_uri=http://www.facebook.com/connect/login_success.html' 
```

我认为问题出在第二个 url 上（传递的秘密表明它是一个应用程序令牌）但是我如何获得用户令牌？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T14:57:10.630

使用 Facebook [Connect 插件](https://github.com/davejohnson/phonegap-plugin-facebook-connect/)，而不是手动制作登录过程。由于它与 Facebook 本地应用程序或 iOS 6 Facebook 功能集成，因此它提供了更好的可用性。

# java - 如何为“窗口->打开视图”菜单的 viewShortCut 贡献部分

> ID：15137340
> 
> 赞同：1
> 
> 时间：2013-02-28T13:57:57.287
> 
> 标签：java, eclipse, eclipse-plugin, eclipse-rcp, eclipse-juno

我正在 Eclipse juno 中创建一个 RCP。在那我使用片段创建了一个部分。我正在重用 JavaScript 透视图。

所以我想在 viewShortCut 菜单中添加我的部分，在 window->Open View 中。

在 eclipse 3.x 的情况下，我们必须使用`org.eclipse.ui.perspectiveExtensions`扩展点并提供视图 ID 以在 viewShortCut 菜单中做出贡献。

**问题：**

那么如何将 eclipse 4 Part 贡献给 viewShortCut。

我通过片段创建的所有部分都没有显示在视图中（`Window->Open View->Others..`）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T23:33:20.340

据我所知，目前没有办法在不使用旧扩展和兼容层的情况下将 MPart 贡献给 ShowViewDialog。[如果您查看Bug 323504](https://bugs.eclipse.org/bugs/show_bug.cgi?id=323504)，这并不奇怪。您会遇到类似的问题，例如使用透视切换器。这方面的工作还没有完成，大多数 Eclipse 项目都严重依赖于兼容层。

当然，如果你这样做，你会想要创建一个真正的 MPart，它使用依赖注入等新特性。这也将使以后的迁移更加容易。通过使用[诸如 DIView 之类的包装器，](http://tomsondev.bestsolution.at/2011/06/10/how-to-apply-the-e4-programming-model-to-3-x/)您可以实现这一点。

**更新：** Eclipse 4.4 (Luna) 的第一个里程碑具有一个“e4view”扩展点，用于将 MParts 集成到 Eclipse 3.x 中。[本文](http://industrial-tsi-wim.blogspot.de/2013/08/a-giant-leap-for-eclipse-rcp.html)详细解释了如何执行此操作。

# javascript - 从表格单元格中获取值

> ID：15137346
> 
> 赞同：0
> 
> 时间：2013-02-28T13:58:04.523
> 
> 标签：javascript, jquery, drupal

我有这部分代码：

```
$.ig.loader(function () {
$("#grid2").igGrid({

autoGenerateColumns: false,
renderCheckboxes: true, 

columns:[                
            { headerText: "#", key: "#", dataType: "number", width: "40%"},
            { headerText: "filename", key: "fieldname", dataType: "image", width: "40%"},
            { headerText: "X", key: "x", dataType: "number", width: "40%"},
            { headerText: "Y", key: "y", dataType: "number", width: "40%"},
            { headerText: "Z", key: "z", dataType: "number", width: "40%"},

        ],

//dataSource: data,

height: "400px",
width: "100%",
features:[
            {
                name: "Filtering",
                allowFiltering: true,
                type: "local"
            },
            {
                name: "Selection",
                mode: "row"
            },
            {
                name: "Updating",
                enableAddRow: false,
                editMode: "row",
                // event raised after end row editing but before dataSource was updated
                editCellEnding: function (evt, ui) {
                    // get cell’s checkbox value when it is changed
                    if (ui.update) {
                        if (ui.columnKey === "nid") {
                            logEvent("editCellEnded event fired. Column Key = " +
                        ui.columnKey + "; Row Index = " +
                        ui.rowID + "; Cell Value = " +
                        ui.value + "; Update = " +
                        ui.update);
                        }
                    }
                },
                enableDeleteRow: false,
                columnSettings: [
                {
                columnKey: "#", 
                },
                {
                columnKey: "fieldname",
                },

                {
                    columnKey: "x",

                }, 
                {
                    columnKey: "y"
                }, 
                {
                    columnKey: "z"
                }]
            }

        ]
});

$.ajax({
    type: "POST",
    url: "http://cmsdemo.trueoffice.com/feature-json2",
    data: "{}",
    contentType: "application/json; charset=utf-8",
    dataType: "json",
    success: function(data){
        $("#grid2").igGrid({
        dataSource: data 
        });
     }
     });
    $("#grid2").live("iggridupdatingdatadirty", function (event, ui) {
            $("#grid2").igGrid("commit");
            return false;
        });
    // show the raised event
        function logEvent(message) {
            var evntWrap = $("#eventList");
            $(evntWrap).append("<div>" + message + "<div>");
            $(evntWrap).prop("scrollTop", $(evntWrap).prop("scrollHeight"));
        }
      });

//Functions         
function Filter() {
      var columnSettings = $("#grid1").igGridFiltering("option", "columnSettings");

        var expr = $("#filterExpr").val(),
            condition = $("#cond_list").val(),
            filterColumn = $("#filterColumn").val();
        $("#grid1").igGridFiltering("filter", ([{fieldName: filterColumn, expr: expr, cond: condition}]));
    }

    function SetConditions() {
        var filterColumn = $("#filterColumn").val();
        $("#cond_list option:selected").removeAttr("selected");
        if (filterColumn === "title" || filterColumn === "nid") {
         $("#cond_list .stringCondition").attr("disabled", "disabled");
         $("#cond_list .numberCondition").removeAttr("disabled").eq(0).attr("selected", "selected");
        }
        else {
            $("#cond_list .stringCondition").removeAttr("disabled").eq(0).attr("selected", "selected");
            $("#cond_list .numberCondition").attr("disabled", "disabled");
        }
    }
    function buttonClickHandler(buttonId) {
    alert("Button with id " + buttonId + " was clicked");
} 
```

和这部分代码

```
<script>
    var layer1 = document.getElementById('layer1');
    ctx1 = layer1.getContext('2d'); 
    var item1 = new Image();
    item1.src = "<?php echo $base_url;?>/themes/bartik/images/sheep.png";
    item1.addEventListener("load", function() {
    ctx1.clearRect(0,0,1024,768)
    ctx1.drawImage(item1,x,y)}, false); //how to get values from a table row?   
</script> 
```

我的问题是：如何从表的第一行获取值并将其发送到 ctx1.drawImage(item1,x,y)。

如果有必要，我可以复制/粘贴其余的代码。

# javascript - 在 ExtJS 按钮中使用 setHandler 时，处理函数被立即执行

> ID：15137347
> 
> 赞同：1
> 
> 时间：2013-02-28T13:58:05.353
> 
> 标签：javascript, button, extjs

我在面板中添加了一个按钮。单击按钮时，将显示一个弹出窗口。我尝试使用 setHandler 更新弹出窗口的内容。但是每当调用 setHandler 时，处理函数就会立即执行。这是示例代码：

```
 me.panels[i].getDockedItems()[0].setHandler(Popup({html: tiphtml}), this);
    ...
    Popup = function(cfg) {
      cfg = Ext.apply({
        height: 100, 
        width: 200,
        layout: 'fit'
      }, cfg);

      Ext.create('Ext.window.Window', {
          title: cfg.title,
          height: cfg.height,
          width: cfg.width,
          layout: cfg.layout,
          html: cfg.html 
      }).show();
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T14:14:48.223

您需要将函数嵌套在匿名函数中。您实际上是在代码中调用该函数，而不是传递它。这将起作用：

```
 me.panels[i].getDockedItems()[0].setHandler(function(){Popup({html: tiphtml})}, this);
    ...
    Popup = function(cfg) {
      cfg = Ext.apply({
        height: 100, 
        width: 200,
        layout: 'fit'
      }, cfg);

      Ext.create('Ext.window.Window', {
          title: cfg.title,
          height: cfg.height,
          width: cfg.width,
          layout: cfg.layout,
          html: cfg.html 
      }).show();
    } 
```

# google-apps-script - 如何在电子邮件中嵌入预先填写的表格？

> ID：15137348
> 
> 赞同：0
> 
> 时间：2013-02-28T13:58:08.103
> 
> 标签：google-apps-script

我有一个要嵌入到电子邮件中的预填充表单的链接。

如何编写脚本以在脚本中包含预填充的表单？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T15:09:51.977

您能否仅在电子邮件中提供指向预填充表单的链接？[该线程](http://productforums.google.com/forum/m/#!topic/docs/xPQxt6Pl4Cg)建议您避免将表单嵌入电子邮件中，因为并非所有客户都支持它。此外，我不确定您将如何在电子邮件中预先填充表单，因为在您嵌入电子邮件时没有任何配置选项。

# google-maps - 邮政编码搜索最近的位置

> ID：15137352
> 
> 赞同：3
> 
> 时间：2013-02-28T13:58:26.430
> 
> 标签：google-maps, postal-code

有人可以告诉我如何将英国位置列表添加到谷歌地图，然后使用邮政编码搜索最近的位置。

我有一个google api，有人可以帮忙吗？

非常感谢

更新：非常感谢您的回复。

我有一个包含地址的 CSV 文件，是否可以即时获取每个地址的地理编码并填充我的谷歌地图？

我目前查询我的数据库以获取存储的地理编码。

这是我的示例：

[http://www.mharrisweb.co.uk/maps/map.html](http://www.mharrisweb.co.uk/maps/map.html)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T02:54:39.680

```
/*jslint browser: true */
/*global google */
function toRad(value) {
    "use strict";
    /** Converts numeric degrees to radians */
    return value * (Math.PI / 180);
}

function getDistanceFromLatLonInKm(lat1, lon1, lat2, lon2, unit) {
    "use strict";
    var a, c, d, R, dLat, dLon;
    R = (unit === 'mi') ? 3958.75587 : (unit === 'ft') ? 20902230.9711286 : 6371; // Mean radius of the earth in km
    dLat = toRad(lat2 - lat1); // toRad below
    dLon = toRad(lon2 - lon1);
    a = Math.sin(dLat / 2) * Math.sin(dLat / 2) + Math.cos(toRad(lat1)) * Math.cos(toRad(lat2)) * Math.sin(dLon / 2) * Math.sin(dLon / 2);
    c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
    d = R * c; // Distance in km
    return d;
}

function calcDistance(checkCoords, lat, lng) {
    "use strict";
    var closestLatLng, distance = 7000, i, latlng;
    for (i = 0; i < checkCoords.length; i = i + 1) {
        latlng = checkCoords[i].split(",");
        if (getDistanceFromLatLonInKm(latlng[0], latlng[1], lat, lng) < distance) {
            distance = getDistanceFromLatLonInKm(latlng[0], latlng[1], lat, lng);
            closestLatLng = [latlng[0], latlng[1]];
        }
    }
    return closestLatLng;
}

function addMarker(lat, lng, title, map) {
    "use strict";
    var marker = new google.maps.Marker({
        position: new google.maps.LatLng(lat, lng),
        title: title
    });
    marker.setMap(map);
    return (lat + ',' + lng);
}

function show_map(lat, lng) {
    "use strict";
    var checkCoords = [], closestLatLng, latlng, map, myOptions;
    latlng = new google.maps.LatLng(lat, lng);
    myOptions = {
        zoom: 10,
        center: latlng,
        mapTypeId: google.maps.MapTypeId.ROADMAP
    };
    map = new google.maps.Map(document.getElementById("map_container"), myOptions);
    checkCoords[0] = addMarker(51.477118, -0.000732, 'Royal Observatory, Greenwich, London', map);
    checkCoords[1] = addMarker(38.92126, -77.066442, 'US Naval Observatory, Washington, DC', map);
    checkCoords[2] = addMarker(48.853499, 2.348090, 'Notre Dame Cathedral, Paris', map);
    closestLatLng = calcDistance(checkCoords, lat, lng);
    map.panTo(new google.maps.LatLng(closestLatLng[0], closestLatLng[1]));
}

function getLatLng(postcode) {
    "use strict";
    var geocoder = new google.maps.Geocoder();
    geocoder.geocode({
        'address': postcode
    }, function (results, status) {
        if (status === google.maps.GeocoderStatus.OK) {
            show_map(results[0].geometry.location.lat(), results[0].geometry.location.lng());
        }
    });
}

function get_location() {
    "use strict";
    document.getElementById('map').innerHTML = '<form id="postcodeEntry" method="post" action="#" onsubmit="getLatLng(this.postcode.value);return false;">'
        + '<fieldset>'
        + '<label for="postcode">Enter your postcode for directions</label>'
        + '<input type="text" name="postcode" id="postcode" />' + '<input type="submit" />'
        + '</fieldset>'
        + '</form>'
        + '<div id="map_container" style="width:300px;height:300px">Map will appear after postcode entry</div>';
}

get_location(); 
```

*编辑通过jslint

这是你所追求的基本形式。[您可以在这个（更新的） jsfiddle](http://jsfiddle.net/7pdtf/1/)上看到它的实际效果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T14:40:38.997

我想您想在说“添加位置列表”时添加标记，为此，您可以执行循环并为每个位置添加标记。

你可以这样做：

```
function addMarker (locations){
   for(var i =0; i< locations.length; i ++)
   {
       // Create a new location
       var loc = new google.maps.LatLng(locations[i].latitude, locations[i].longitude);

       // Create the marker options
       var markerOptions = {
           map: yourMap,
           position: loc
       };
       // Add the marker on map
       var marker = new google.maps.Marker(markerOptions);
   }
} 
```

你的地图上有你所有的位置。

你说你想做一个邮政编码搜索来找到最近的。

所以我发现这个[链接](http://www.tomanthony.co.uk/blog/geocoding-uk-postcodes-with-google-map-api/)可能会让你感兴趣。

希望它有所帮助。

# java - 从java中的jtable单元格获取最新值

> ID：15137355
> 
> 赞同：2
> 
> 时间：2013-02-28T13:58:31.407
> 
> 标签：java, swing, jtable

有人可以举一个下面的问题示例：我有一个如下所示的jtable

```
plus  |  minus  |   total
  10  |    0    |     10
   0  |    2    |      8
   0  |    3    |      5 
```

如何获得最新总计（5）的值，以便我可以在公式总计=总计+加减号中再次使用它？由于加号和减号将不断添加，因此总计的值将不断更新。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T14:02:57.450

从表模型中获取值。getModel().getValueAt(..)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T14:03:48.737

调用[getValueAt(int row, int column)](http://docs.oracle.com/javase/6/docs/api/javax/swing/JTable.html#getValueAt%28int,%20int%29)。可能为空单元格返回 null。不要在模型上调用它，因为如果启用并应用排序，表格行号可能与模型行号不匹配。此外，如果表列已重新排列，则表列号可能与模型列号不匹配。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-28T14:16:08.163

> 有人可以举一个下面的问题示例：

```
import java.awt.*;
import java.awt.event.ActionEvent;
import java.util.Random;
import java.util.concurrent.*;
import javax.swing.*;
import javax.swing.event.*;
import javax.swing.table.DefaultTableModel;

public class ChangeNotifiersOnEvent extends JFrame implements Runnable {

    private static final long serialVersionUID = 1L;
    private boolean runProcess = true;
    private Random random = new Random();
    private javax.swing.Timer timerRun;
    private Executor executor = Executors.newCachedThreadPool();
    private String[] columnNames = {"Source", "Hit", "Last", "Ur_Diff"};
    private JTable table;
    private Object[][] data = {{"Swing Timer", 2.99, 5, 1.01},
        {"Swing Worker", 7.10, 5, 1.010}, {"TableModelListener", 25.05, 5, 1.01}};
    private DefaultTableModel model = new DefaultTableModel(data, columnNames);

    public ChangeNotifiersOnEvent() {
        table = new JTable(model) {

            private static final long serialVersionUID = 1L;

            @Override
            public Class getColumnClass(int column) {
                return getValueAt(0, column).getClass();
            }
        };
        model.addTableModelListener(new TableModelListener() {

            @Override
            public void tableChanged(TableModelEvent tme) {
                if (tme.getType() == TableModelEvent.UPDATE) {
                    if (tme.getColumn() == 1 && tme.getLastRow() == 2) {
                        double dbl = ((Double) table.getModel().getValueAt(2, 1))
                                - ((Integer) table.getModel().getValueAt(2, 2));
                        table.getModel().setValueAt(dbl, 2, 3);
                    } else if (tme.getColumn() == 1 && tme.getLastRow() == 0) {
                        prepareUpdateTableCell();
                    } else if (tme.getColumn() == 1 && tme.getLastRow() == 1) {
                        executor.execute(new MyTask(MyTask.UPDATE_TABLE_COLUMN));
                    }
                }
            }
        });
        table.setRowHeight(30);
        table.setFont(new Font("Serif", Font.BOLD, 20));
        table.getColumnModel().getColumn(0).setPreferredWidth(180);
        table.setPreferredScrollableViewportSize(table.getPreferredSize());
        JScrollPane scrollPane = new JScrollPane(table);
        add(scrollPane, BorderLayout.CENTER);
        new Thread(this).start();
    }

    private void prepareUpdateTableCell() {
        timerRun = new javax.swing.Timer(10, UpdateTableCell());
        timerRun.setRepeats(false);
        timerRun.start();
    }

    private Action UpdateTableCell() {
        return new AbstractAction("Update Table Cell") {

            private static final long serialVersionUID = 1L;

            @Override
            public void actionPerformed(ActionEvent e) {
                double dbl = ((Double) table.getModel().getValueAt(0, 1))
                        - ((Integer) table.getModel().getValueAt(0, 2));
                table.getModel().setValueAt(dbl, 0, 3);
            }
        };
    }

    @Override
    public void run() {
        while (runProcess) {
            try {
                Thread.sleep(250);
            } catch (Exception e) {
                e.printStackTrace();
            }
            changeTableValues();
        }
    }

    private void changeTableValues() {
        Runnable doRun = new Runnable() {

            @Override
            public void run() {
                table.getModel().setValueAt(random.nextInt(128) + random.nextDouble(), 0, 1);
                table.getModel().setValueAt(random.nextInt(256) + random.nextDouble(), 1, 1);
                table.getModel().setValueAt(random.nextInt(512) + random.nextDouble(), 2, 1);

                table.getModel().setValueAt(random.nextInt(128), 0, 2);
                table.getModel().setValueAt(random.nextInt(128), 1, 2);
                table.getModel().setValueAt(random.nextInt(128), 2, 2);
            }
        };
        SwingUtilities.invokeLater(doRun);
    }

    private class MyTask extends SwingWorker<Void, Integer> {

        private static final String UPDATE_TABLE_COLUMN = "update";
        private String namePr;
        private double dbl;

        MyTask(String str) {
            this.namePr = str;
        }

        @Override
        protected Void doInBackground() throws Exception {
            dbl = ((Double) table.getModel().getValueAt(1, 1))
                    - ((Integer) table.getModel().getValueAt(1, 2));
            return null;
        }

        @Override
        protected void done() {
            SwingUtilities.invokeLater(new Runnable() {

                @Override
                public void run() {
                    table.getModel().setValueAt(dbl, 1, 3);
                }
            });
        }
    }

    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {

            @Override
            public void run() {
                ChangeNotifiersOnEvent frame = new ChangeNotifiersOnEvent();
                frame.setDefaultCloseOperation(EXIT_ON_CLOSE);
                frame.setLocation(150, 150);
                frame.pack();
                frame.setVisible(true);
            }
        });
    }
} 
```

.

注意

*   需要将[getColumnClass 的正确值设置为 Integer、Long 或 Double](http://docs.oracle.com/javase/tutorial/uiswing/components/table.html#editrender)

*   正确的方法是仅使用[AbstractTableModel](http://docs.oracle.com/javase/tutorial/uiswing/components/table.html#data)（最简单的方法是覆盖此事件`DefaultTableModel`），在那里覆盖`getValueAt()`，

*   里面`getValueAt()`只计算所需列的正确公式

*   我会被禁用`JTable.getTableHeader().setReorderingAllowed(false);`，否则必须[setModelIndex](http://docs.oracle.com/javase/7/docs/api/javax/swing/table/TableColumn.html#setModelIndex%28int%29)或在计算之前

# django - 视图中的 for 循环

> ID：15137356
> 
> 赞同：1
> 
> 时间：2013-02-28T13:58:33.297
> 
> 标签：django

在视图中我想获取汽车对象，然后更改`first_year`var。

```
def cars(request, mark_id, year=year):
        #BMW, etc.
    mark = get_object_or_404(Mark, pk=mark_id, active=1)
        #M, X-series, etc.
    for group in mark.groups.iterator():
        group.first_year.year = int(year)-int(group.first_year.year)
    return render(request, 'cars.html', {  'mark':mark, }) 
```

所以，在我使用的模板中：

```
{% for i in mark.groups.all %}

{{i.first_year}}

{% endfor %} 
```

它返回来自 db 的值，而不是我的`group.first_year.year`. 正如你所理解的，有 3 个模型 - mark、groups 和 first_year。如果您需要，我可以在这里发布它们，但我认为，我的观点有问题。

谢谢。

**编辑。楷模。**

```
class First_Year(models.Model):
    year = models.IntegerField()
    def __unicode__(self):
        return str(self.year)

class Groups(models.Model):
        many_other_fields
    mark = models.ForeignKey(Mark, related_name='groups')
    last_update = models.DateTimeField()
    first_year = models.ForeignKey(First_Year, related_name='first_year')
    def __unicode__(self):
        return self.name
    def altered_date(self, year):
        altered_year = int(year)-int(self.first_year.year)
        return altered_year 
```

没有模型 Mark，因为它有很多没有年份等的领域。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T16:20:03.483

在您的视图中进行更改的`for`循环不会将更改保存在任何地方，因此在将值传递给模板时您将看不到更改。

这里的一个解决方案是向您的模型添加一个新的模型方法并在那里进行日期比较。

在您的`First_Year`模型中添加如下`altered_date`函数：

```
class First_Year(models.Model):
    year = models.IntegerField()
    def __unicode__(self):
        return str(self.year)
    def altered_date(self, this_year):
        altered_year = int(this_year)-int(self.year)
        return altered_year 
```

`First_Year`这通过调用该函数为每个模型获取更改的年份。不幸的是，这个函数需要一个额外的参数——`year`所以它不能直接从模板中调用。您可以创建一个自定义模板过滤器来解决这个问题：

```
@register.filter
def get_altered_year(obj, gar):
    return obj.altered_date(gar) 
```

现在你只需要通过像这样修改你的回报来确保你将年份传递给你的视图：

```
def cars(request, mark_id, year=year):
    ...
    return render(request, 'cars.html', {'mark':mark, 'year':year, }) 
```

然后在您的模板中，您可以执行以下操作：

```
{% for i in mark.groups_set.all %}
    {{i.first_year|get_altered_year:year }}
{% endfor %} 
```

您可以在[此处](https://docs.djangoproject.com/en/1.5/topics/db/models/#model-methods)查看模型方法文档。以及自定义模板过滤器的文档[here](https://docs.djangoproject.com/en/dev/howto/custom-template-tags/#writing-custom-template-filters)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T14:05:19.447

你的意思是：

```
{% for i in mark.groups_set.all %}
   {{i.first_year}}
{% endfor %} 
```

仅当组具有来自标记的外键时才允许

# extjs - 无法在 sencha touch 中构建原生包

> ID：15137357
> 
> 赞同：2
> 
> 时间：2013-02-28T13:58:37.070
> 
> 标签：extjs, sencha-touch, sencha-architect

我已经下载了最新`sencha gpl 2.1.1`的和`sdk cmd 3.0.2`，所以在这里我可以像在 sencha 网站上一样生成示例应用程序。但我无法构建本机包。它在这样的命令提示符中抛出错误`com.sencha.exceptions.BasicException:`

> 执行此行时发生以下错误：
> 
> D:\Sench_Touch\sencha-touch-2.1.1-gpl\DemoApp.sencha\app\build-impl.xml:109：执行此行时出现以下错误：jar:file:/C:/Users/User% 202/bin/Sencha/Cmd/3.0.2.288/sencha.jar!/com/sencha/ant/antlib.xml:364：shellscript 返回：1

任何机构都可以告诉为什么它会给出错误如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T14:09:48.690

您需要确保在编译之前`compass`已[安装。](http://compass-style.org/install/)
您可以通过添加`skip.sass=1`到`sencha.cfg`文件来跳过它。

# performance - Scala 用于理解性能

> ID：15137360
> 
> 赞同：6
> 
> 时间：2013-02-28T13:58:50.573
> 
> 标签：performance, algorithm, scala

为什么是

```
for (
  a <- 1 to 1000;
  b <- 1 to 1000 - a;
  c <- 1 to 1000 - a - b;
  if (a * a + b * b == c * c && a + b + c == 1000)
) println((a, b, c, a * b * c)) 
```

266 毫秒

那么慢：

```
for (a <- 1 to 1000)
  for (b <- 1 to 1000 - a)
    for (c <- 1 to 1000 - a - b)
      if (a * a + b * b == c * c)
        if (a + b + c == 1000)
          println((a, b, c, a * b * c)) 
```

62 毫秒

如果我理解正确，这应该是一样的吗？

* * *

处理答案后的解决方案：

```
for (
  a <- 1 to 1000;
  b <- 1 to (1000 - a)
) {
  val c = (1000 - a - b)
  if (a * a + b * b == c * c)
    println((a, b, c, a * b * c))
} 
```

9 毫秒

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-02-28T14:04:47.917

你的理解是错误的。

当条件在循环体中时会发生这种情况：

```
// this
for(x <- coll) if(condition) doSomething
// will translate to
coll.foreach{ x => if(condition) doSomething } 
```

与条件在生成器本身时相反：

```
// this
for(x <- coll if(condition)) dosomething
// will translate to
coll.withFilter(x => condition).foreach{ x => dosomething } 
```

您可以查看[Scala 语言规范 6.16](http://www.scala-lang.org/docu/files/ScalaReference.pdf)了解更多详细信息。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-02-28T14:06:15.370

您可能需要查看[此演示文稿（幻灯片 13-15）](https://docs.google.com/presentation/d/13SAn0Ru9g77T1EInCZ-7HVbEcqIMVQstVgjZFiBB4bA/present#slide=id.i92)以了解有关如何在内部翻译 for 循环的详细信息。

您的示例的主要区别是：

*   for 循环体中的条件（2\. 示例）
*   *生成器*内的条件（1\. 示例）

后者，也称为*环路过滤*，在设计上具有性能缺陷。为了极大地简化正在发生的事情：在内部`withFilter`（这是翻译的第一步），`Function2[Object, Boolean]`创建了一个匿名的新类型函数（用于评估条件）。传递给其`apply`函数的参数必须被装箱，因为它是基于`Object`. 这种装箱/拆箱比直接在 for 循环体中评估条件要慢得多`if`，它允许直接访问变量。

# iphone - 如何从异步请求中获取剩余上传时间？

> ID：15137361
> 
> 赞同：1
> 
> 时间：2013-02-28T13:58:52.157
> 
> 标签：iphone, ios, progress-bar, image-uploading

我正在尝试将图像从 iPhone 上传到服务器。我能够这样做但我需要显示一个指标。我的代码是

```
NSData *imageData = UIImageJPEGRepresentation(newImage, 90);

// setting up the URL to post to
NSString *urlString = [NSString stringWithFormat:@"URL",[[formater stringFromDate:now] stringByAddingPercentEscapesUsingEncoding:NSUTF8StringEncoding]];
// setting up the request object now
NSMutableURLRequest *request = [[NSMutableURLRequest alloc] init] ;
[request setURL:[NSURL URLWithString:urlString]];
[request setHTTPMethod:@"POST"];
  NSString *boundary = [NSString stringWithFormat:@"---------------------------14737809831466499882746641449"];
NSString *contentType = [NSString stringWithFormat:@"multipart/form-data; boundary=%@",boundary];
[request addValue:contentType forHTTPHeaderField: @"Content-Type"];
 NSMutableData *body = [NSMutableData data];
[body appendData:[[NSString stringWithFormat:@"\r\n--%@\r\n",boundary] dataUsingEncoding:NSUTF8StringEncoding]];
[body appendData:[[NSString stringWithFormat:@"Content-Disposition: form-data; name=\"image\"; filename=\"ipodfile.jpg\"\r\n"] dataUsingEncoding:NSUTF8StringEncoding]];
[body appendData:[[NSString stringWithFormat:@"Content-Type: application/octet-stream\r\n\r\n"] dataUsingEncoding:NSUTF8StringEncoding]];
[body appendData:[NSData dataWithData:imageData]];
[body appendData:[[NSString stringWithFormat:@"\r\n--%@--\r\n",boundary] dataUsingEncoding:NSUTF8StringEncoding]];
// setting the body of the post to the reqeust
[request setHTTPBody:body]; 
```

这是触发请求的代码。

```
[NSURLConnection sendAsynchronousRequest:request queue:[NSOperationQueue mainQueue]
                           completionHandler:^(NSURLResponse *response, NSData *data, NSError *error) {
                               NSLog(@"Finished with status code: %i", [(NSHTTPURLResponse *)response statusCode]);
 }]; 
```

那么如何计算剩余时间以便显示指标？谢谢你的时间。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-28T14:10:12.860

您可以使用这种连接委托的方法：

```
- (void)       connection:(NSURLConnection *)connection
          didSendBodyData:(NSInteger)bytesWritten
        totalBytesWritten:(NSInteger)totalBytesWritten
totalBytesExpectedToWrite:(NSInteger)totalBytesExpectedToWrite; 
```

*（我应该如何包装这么长的参数名称？）*
它不在文档中`NSURLConnectionDataDelegate`，但是如果您检查 public header `NSURLConnection.h`，它就在那里。所以不用担心使用它。

从文档*URL Loading System Programming Guide* > *Using NSURLConnection*：

> **估计上传进度**
> 
> `connection:didSendBodyData:totalBytesWritten:totalBytesExpectedToWrite:`您可以使用委托方法估计 HTTP POST 上传的进度。请注意，这不是对上传进度的精确测量，因为连接可能会失败或连接可能会遇到身份验证挑战。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T14:03:21.127

我相信您想显示进度条之类的东西。我建议使用 MKNetworkKit，它为您提供了许多网络管理工具，例如异步连接的进度。检查此[链接](https://github.com/MugunthKumar/MKNetworkKit)。

# php - 解析 JSON 对象时出错

> ID：15137362
> 
> 赞同：1
> 
> 时间：2013-02-28T13:58:55.340
> 
> 标签：php, android, json

我有一个用于 android 的登录应用程序，它使用 JSON 将数据从数据库解析到应用程序。接受 http 请求的 php api 由标签识别，即“登录”或“注册”，如下所示：

```
if (isset($_POST['tag']) && $_POST['tag'] != '') {
    "Do stuf
    } else {
       echo "access denied"; 
```

该应用程序一直运行良好，但现在我只收到“访问被拒绝”的响应。

```
public JSONObject loginUser(String email, String password){
    // Building Parameters
    List<NameValuePair> params = new ArrayList<NameValuePair>();
    params.add(new BasicNameValuePair("tag", "login"));
    params.add(new BasicNameValuePair("email", email));
    params.add(new BasicNameValuePair("password", password));
    JSONObject json = jsonParser.getJSONFromUrl(loginURL, params);
    // return json
    // Log.e("JSON", json.toString());
    return json;
} 
```

这是发送请求的 JSONobject，我怀疑它没有正确发送标签。有没有人知道发生了什么？

更新：添加 JSONparser.class

```
public class JSONParser {

static InputStream is = null;
static JSONObject jObj = null;
static String json = "";

// constructor
public JSONParser() {

}

public JSONObject getJSONFromUrl(String url, List<NameValuePair> params) {

    // Making HTTP request
    try {
        // defaultHttpClient
        DefaultHttpClient httpClient = new DefaultHttpClient();
        HttpPost httpPost = new HttpPost(url);
        httpPost.setEntity(new UrlEncodedFormEntity(params));

        HttpResponse httpResponse = httpClient.execute(httpPost);
        HttpEntity httpEntity = httpResponse.getEntity();
        is = httpEntity.getContent();

    } catch (UnsupportedEncodingException e) {
        e.printStackTrace();
    } catch (ClientProtocolException e) {
        e.printStackTrace();
    } catch (IOException e) {
        e.printStackTrace();
    }

    try {
        BufferedReader reader = new BufferedReader(new InputStreamReader(
                is, "UTF-8"), 8);
        StringBuilder sb = new StringBuilder();
        String line = null;
        while ((line = reader.readLine()) != null) {
            sb.append(line + "n");
        }
        is.close();
        json = sb.toString();
        Log.e("JSON", json);
    } catch (Exception e) {
        Log.e("Buffer Error", "Error converting result " + e.toString());
    }

    // try parse the string to a JSON object
    try {
        jObj = new JSONObject(json);
    } catch (JSONException e) {
        Log.e("JSON Parser", "Error parsing data " + e.toString());
    }

    // return JSON String
    return jObj;

} 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T14:35:49.160

实际上，看起来您似乎在使用错误的 JSON 查询，除非您没有向我们展示更多代码。你错过了 jsonParser 类的创建

> `public class JSONParser {`
> 
> ```
> static InputStream is = null;
> static JSONObject jObj = null;
> static String json = "";
> 
> // constructor
> public JSONParser() {
> 
> }
> 
> public JSONObject getJSONFromUrl(String url) {
> 
>     // Making HTTP request
>     try {
>         // defaultHttpClient
>         DefaultHttpClient httpClient = new DefaultHttpClient();
>         HttpPost httpPost = new HttpPost(url);
> 
>         HttpResponse httpResponse = httpClient.execute(httpPost);
>         HttpEntity httpEntity = httpResponse.getEntity();
>         is = httpEntity.getContent();          
> 
>     } catch (UnsupportedEncodingException e) {
>         e.printStackTrace();
>     } catch (ClientProtocolException e) {
>         e.printStackTrace();
>     } catch (IOException e) {
>         e.printStackTrace();
>     }
> 
>     try {
>         BufferedReader reader = new BufferedReader(new InputStreamReader(
>                 is, "iso-8859-1"), 8);
>         StringBuilder sb = new StringBuilder();
>         String line = null;
>         while ((line = reader.readLine()) != null) {
>             sb.append(line + "\n");
>         }
>         is.close();
>         json = sb.toString();
>     } catch (Exception e) {
>         Log.e("Buffer Error", "Error converting result " + e.toString());
>     }
> 
>     // try parse the string to a JSON object
>     try {
>         jObj = new JSONObject(json);
>     } catch (JSONException e) {
>         Log.e("JSON Parser", "Error parsing data " + e.toString());
>     }
> 
>     // return JSON String
>     return jObj;
> 
> } } 
> ```

有关更多信息，请参阅此站点[http://www.androidhive.info/2012/01/android-json-parsing-tutorial/](http://www.androidhive.info/2012/01/android-json-parsing-tutorial/)

# ms-access - XPages JDBC 连接到 MS ACCESS DB，在 ViewPanel 中显示数据时出现问题

> ID：15137370
> 
> 赞同：0
> 
> 时间：2013-02-28T13:59:19.033
> 
> 标签：ms-access, jdbc, xpages

我正在尝试将 XPagesJDBC.nsf 连接到一个简单的 MS Access 数据库，它成功连接并且我能够执行 @JdbcInsert、更新、删除。还能够执行 SQL 查询操作。

但是我在尝试使用 JDBC Query 数据源类型在 ViewPanel 控件中显示数据时遇到了问题。

它给出以下错误

```
Error while reading the relational data
Invalid Fetch Size 
```

还有一个很长的 StackTrace，我正在复制下面的堆栈跟踪的一部分；

我认为这个错误是特定于 MS Access 的，因为我可以在其他 RDBMS 中找到一些成功的实现，它也可以在我的末尾使用“durby”正常工作。

```
 com.ibm.xsp.util.FacesUtil.renderComponent(FacesUtil.java:840)
com.ibm.xsp.util.FacesUtil.renderComponent(FacesUtil.java:851)
com.ibm.xsp.util.FacesUtil.renderComponent(FacesUtil.java:851)
com.ibm.xsp.util.FacesUtil.renderComponent(FacesUtil.java:851)
com.ibm.xsp.util.FacesUtil.renderComponent(FacesUtil.java:851)
com.ibm.xsp.component.UIViewRootEx._renderView(UIViewRootEx.java:1317)
com.ibm.xsp.component.UIViewRootEx.renderView(UIViewRootEx.java:1255)
com.ibm.xsp.application.ViewHandlerExImpl.doRender(ViewHandlerExImpl.java:641)
com.ibm.xsp.application.ViewHandlerExImpl._renderView(ViewHandlerExImpl.java:320)
com.ibm.xsp.application.ViewHandlerExImpl.renderView(ViewHandlerExImpl.java:335)
com.sun.faces.lifecycle.RenderResponsePhase.execute(RenderResponsePhase.java:103)
com.sun.faces.lifecycle.LifecycleImpl.phase(LifecycleImpl.java:210)
com.sun.faces.lifecycle.LifecycleImpl.render(LifecycleImpl.java:120)
com.ibm.xsp.controller.FacesControllerImpl.render(FacesControllerImpl.java:264)
com.ibm.xsp.webapp.FacesServlet.serviceView(FacesServlet.java:248)
com.ibm.xsp.webapp.FacesServletEx.serviceView(FacesServletEx.java:200)
com.ibm.xsp.webapp.FacesServlet.service(FacesServlet.java:160)
com.ibm.xsp.webapp.FacesServletEx.service(FacesServletEx.java:137)
com.ibm.xsp.webapp.DesignerFacesServlet.service(DesignerFacesServlet.java:103)
    com.ibm.designer.runtime.domino.adapter.ComponentModule.invokeServlet(ComponentModule.java:576)
    com.ibm.domino.xsp.module.nsf.NSFComponentModule.invokeServlet(NSFComponentModule.java:1267)
    com.ibm.designer.runtime.domino.adapter.ComponentModule$AdapterInvoker.invokeServlet(ComponentModule.java:847)
    com.ibm.designer.runtime.domino.adapter.ComponentModule$ServletInvoker.doService(ComponentModule.java:796)
    com.ibm.designer.runtime.domino.adapter.ComponentModule.doService(ComponentModule.java:565)
    com.ibm.domino.xsp.module.nsf.NSFComponentModule.doService(NSFComponentModule.java:1251)
    com.ibm.domino.xsp.module.nsf.NSFService.doServiceInternal(NSFService.java:598)
    com.ibm.domino.xsp.module.nsf.NSFService.doService(NSFService.java:421)
    com.ibm.designer.runtime.domino.adapter.LCDEnvironment.doService(LCDEnvironment.java:341)
    com.ibm.designer.runtime.domino.adapter.LCDEnvironment.service(LCDEnvironment.java:297)
    com.ibm.domino.xsp.bridge.http.engine.XspCmdManager.service(XspCmdManager.java:272)
java.sql.SQLException: Invalid Fetch Size
    sun.jdbc.odbc.JdbcOdbcStatement.setFetchSize(JdbcOdbcStatement.java:838)
    sun.jdbc.odbc.JdbcOdbcResultSet.setFetchSize(JdbcOdbcResultSet.java:2987)
    com.ibm.xsp.extlib.jdbc.model.JdbcDataBlockAccessor.loadBlock(JdbcDataBlockAccessor.java:389)
    com.ibm.xsp.extlib.model.DataBlockAccessor.findBlockByIndex(DataBlockAccessor.java:344)
    com.ibm.xsp.extlib.model.DataBlockAccessor.prefetchData(DataBlockAccessor.java:292)
    com.ibm.xsp.extlib.model.DataAccessorModel.getRowCount(DataAccessorModel.java:93)
    com.ibm.xsp.component.UIPager$PagerState.<init>(UIPager.java:76)
    com.ibm.xsp.component.UIPager$PagerState.<init>(UIPager.java:71)
    com.ibm.xsp.component.UIPager.createPagerState(UIPager.java:540)
    com.ibm.xsp.renderkit.html_extended.XPagerRenderer.encodeChildren(XPagerRenderer.java:67)
    com.ibm.xsp.renderkit.ReadOnlyAdapterRenderer.encodeChildren(ReadOnlyAdapterRenderer.java:162)
    javax.faces.component.UIComponentBase.encodeChildren(UIComponentBase.java:979)
    com.ibm.xsp.util.FacesUtil.renderComponent(FacesUtil.java:842)
    com.ibm.xsp.renderkit.html_extended.ViewPanelRenderer.processPagerCell(ViewPanelRenderer.java:656)
    com.ibm.xsp.renderkit.html_extended.ViewPanelRenderer.encodeBegin(ViewPanelRenderer.java:354)
    com.ibm.xsp.renderkit.ReadOnlyAdapterRenderer.encodeBegin(ReadOnlyAdapterRenderer.java:146)
    javax.faces.component.UIComponentBase.encodeBegin(UIComponentBase.java:956)
    javax.faces.component.UIData.encodeBegin(UIData.java:788)
    com.ibm.xsp.component.UIDataEx.encodeBegin(UIDataEx.java:413)
    com.ibm.xsp.component.UIViewPanel.encodeBegin(UIViewPanel.java:288)
    com.ibm.xsp.util.FacesUtil.renderComponent(FacesUtil.java:840)
    com.ibm.xsp.util.FacesUtil.renderComponent(FacesUtil.java:851)
    com.ibm.xsp.util.FacesUtil.renderComponent(FacesUtil.java:851) 
```

myconnection.jdbc 文件；ext_db 是一个 DSN

```
<jdbc>
    <driver>sun.jdbc.odbc.JdbcOdbcDriver</driver>
    <url>jdbc:odbc:ext_db</url>
    <user>xxx</user>
    <password>xxx</password>
</jdbc> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T17:03:49.963

开玩笑的回答：获取数据库 :-) 这个问题似乎是[众所周知](https://stackoverflow.com/questions/13398713/solr-dih-invalid-fetch-size)的，并且在[很大程度上也](https://www.google.com/search?q=MS+Access+Java+Invalid+Fetch+Size)[困扰着其他人](https://issues.jboss.org/browse/TEIID-1292?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel&_sscc=t)。批量大小参数（第一个链接）可能有效。您也可以重新审视您的要求。DECS 能解决问题吗？

# php - 我想在php中直接发送我们的电子邮件ID

> ID：15137374
> 
> 赞同：0
> 
> 时间：2013-02-28T13:59:24.990
> 
> 标签：php, email

我有一个小问题。我想直接在我们的电子邮件 ID 中发送数据，但我收到以下警告：

> mail() [function.mail]：无法在“localhost”端口 25 连接到邮件服务器，请验证 php.ini 中的“SMTP”和“smtp_port”设置或在 C:\wamp\www\my php 中使用 ini_set() \email.php 在第 14 行

```
 $to = "ahsddif@kfdf.com"; 
 $subject = "Contact Us"; 
 $email = $_REQUEST['textlname'] ; 
 $message = $_REQUEST['message'] ; 
 $headers = "From: $email"; 
 $sent = mail($to, $subject, $message, $headers) ; 
 if($sent) 
   {print "Your mail was sent successfully"; }
  else 
   {print "We encountered an error sending your mail"; } 
```

有人可以指出我正确的方向吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T14:05:40.063

您将无法单独使用 WAMP 发送电子邮件，您需要设置一个邮件服务器。根据您对它的经验，它可能会变得棘手。

我只是将我的 GoDaddy 凭据与 WAMP 一起使用来发送电子邮件，如果您没有托管解决方案，我发现下面的链接似乎有效，但我还没有尝试过。

[配置 WAMP 服务器以发送电子邮件](https://stackoverflow.com/questions/5773288/configure-wamp-server-to-send-email)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T14:08:46.277

首先：不要使用php邮件功能。使用特定的邮件程序类，如 PHPmailer。

[http://code.google.com/a/apache-extras.org/p/phpmailer/](http://code.google.com/a/apache-extras.org/p/phpmailer/)

您的问题：您没有在 localhost 上配置 SMTP 服务器。查看 PHPmailer 示例并使用外部 SMTP，就像使用邮件客户端一样。

# magento - 尝试重新索引 catalog_product_flat 时出现未知错误

> ID：15137382
> 
> 赞同：1
> 
> 时间：2013-02-28T13:59:49.420
> 
> 标签：magento

我正在尝试重新索引 catalog_product_flat 并且出现此错误：

```
Product Flat Data index process unknown error:
exception 'PDOException' with message 'SQLSTATE[42000]: Syntax error or access violation: 1118 Row size too large. The maximum row size for the used table type, not counting BLOBs, is 65535\. You have to change some columns to TEXT or BLOBs' in /path/to/magento/lib/Zend/Db/Statement/Pdo.php:228
Stack trace:
#0 /path/to/magento/lib/Zend/Db/Statement/Pdo.php(228): PDOStatement->execute(Array)
#1 /path/to/magento/lib/Varien/Db/Statement/Pdo/Mysql.php(110): Zend_Db_Statement_Pdo->_execute(Array)
#2 /path/to/magento/lib/Zend/Db/Statement.php(320): Varien_Db_Statement_Pdo_Mysql->_execute(Array)
#3 /path/to/magento/lib/Zend/Db/Adapter/Abstract.php(479): Zend_Db_Statement->execute(Array)
#4 /path/to/magento/lib/Zend/Db/Adapter/Pdo/Abstract.php(238): Zend_Db_Adapter_Abstract->query('ALTER TABLE `ma...', Array)
#5 /path/to/magento/lib/Varien/Db/Adapter/Pdo/Mysql.php(419): Zend_Db_Adapter_Pdo_Abstract->query('ALTER TABLE `ma...', Array)
#6 /path/to/magento/lib/Varien/Db/Adapter/Pdo/Mysql.php(340): Varien_Db_Adapter_Pdo_Mysql->query('ALTER TABLE `ma...')
#7 /path/to/magento/lib/Varien/Db/Adapter/Pdo/Mysql.php(839): Varien_Db_Adapter_Pdo_Mysql->raw_query('ALTER TABLE `ma...')
#8 /path/to/magento/app/code/core/Mage/Catalog/Model/Resource/Product/Flat/Indexer.php(799): Varien_Db_Adapter_Pdo_Mysql->addColumn('mage_catalog_pr...', 'email_template', Array)
#9 /path/to/magento/app/code/core/Mage/Catalog/Model/Resource/Product/Flat/Indexer.php(1390): Mage_Catalog_Model_Resource_Product_Flat_Indexer->prepareFlatTable(1)
#10 /path/to/magento/app/code/core/Mage/Catalog/Model/Product/Flat/Indexer.php(296): Mage_Catalog_Model_Resource_Product_Flat_Indexer->reindexAll()
#11 /path/to/magento/app/code/core/Mage/Catalog/Model/Product/Indexer/Flat.php(336): Mage_Catalog_Model_Product_Flat_Indexer->reindexAll()
#12 /path/to/magento/app/code/core/Mage/Index/Model/Process.php(209): Mage_Catalog_Model_Product_Indexer_Flat->reindexAll()
#13 /path/to/magento/app/code/core/Mage/Index/Model/Process.php(255): Mage_Index_Model_Process->reindexAll()
#14 /path/to/magento/shell/indexer.php(158): Mage_Index_Model_Process->reindexEverything()
#15 /path/to/magento/shell/indexer.php(198): Mage_Shell_Compiler->run()
#16 {main} 
```

重新索引是在 magento 企业 1.12 上基于从 magento 1.3.4 社区获取的数据完成的。从管理员或外壳索引器进行重新索引时会发生这种情况。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-28T14:28:17.993

好的，我找到了解决方案，我必须在方法 _getFlatColumnsOldDefinition 中更改 /path/to/magento/app/code/core/Mage/Eav/Model/Entity/Attribute/Abstract.php 此代码：

```
case 'varchar':
    $columns[$this->getAttributeCode()] = array(
        'type' => 'varchar(255)' 
```

对此：

```
case 'varchar':
    $columns[$this->getAttributeCode()] = array(
        'type' => 'text' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-08-06T17:34:40.203

[该答案](https://stackoverflow.com/a/7232265/1429647)解决了属性计数的潜在问题，而无需借助架构或代码修改。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-04T08:16:39.107

magento 以编程方式重新索引

识别码

1 个目录产品属性

2 目录产品价格

3 目录_url

4 catalog_product_flat

5 目录_类别_平面

6 目录_类别_产品

7 目录search_stock

8 目录inventory_stock

9 tag_summary

完全重新索引

对于 ($i = 1; $i <= 9; $i++) {

$process = Mage::getModel('index/process')->load($i);

$process->reindexAll();

} 个人重新索引

$process = Mage::getModel('index/process')->load(4);

$process->reindexAll();

# c# - 根据条件停止安装

> ID：15137384
> 
> 赞同：3
> 
> 时间：2013-02-28T13:59:55.037
> 
> 标签：c#, .net-4.0, setup-project

我正在尝试检查计算机是否安装了 VC++ 可再发行组件，我发现检查它的最佳方法是运行以下代码：

```
bool CheckForVCRedist()
{
    bool install = false;

    if (!install) install = 5 == MsiQueryProductState("{196BB40D-1578-3D01-B289-BEFC77A11A1E}");
    if (!install) install = 5 == MsiQueryProductState("{DA5E371C-6333-3D8A-93A4-6FD5B20BCC6E}");
    if (!install) install = 5 == MsiQueryProductState("{C1A35166-4301-38E9-BA67-02823AD72A1B}");
    if (!install) install = 5 == MsiQueryProductState("{F0C3E5D1-1ADE-321E-8167-68EF0DE699A5}");
    if (!install) install = 5 == MsiQueryProductState("{1D8E6291-B0D5-35EC-8441-6616F567A0F7}");
    if (!install) install = 5 == MsiQueryProductState("{88C73C1C-2DE5-3B01-AFB8-B46EF4AB41CD}");

    return install;
}

[DllImport("msi.dll")]
private static extern int MsiQueryProductState(string product); 
```

如果以下任何一项为真，那么我的程序将正确运行。我正在尝试安排它，以便安装程序根据 VC++ Redistributable 的存在停止。在程序安装程序cs文件中有以下代码：

```
protected override void OnBeforeInstall(IDictionary savedState)
{
    if (CheckForVCRedist())
    {
        base.OnBeforeInstall(savedState);
    }
    else
    {
        throw new Exception("You are missing the VC ++ 2010 Redistributable. Please follow the link to get it:\nhttp://www.microsoft.com/en-us/download/details.aspx?id=5555");
    }
} 
```

这似乎不起作用。有什么建议吗？

编辑：我没有设置自定义操作来运行它，因为我认为覆盖该方法是正确的方法......我现在觉得这是错误的。

编辑[2013-02-28 10:36]：安装程序中没有抛出错误，有没有更好的方法来停止安装程序的安装？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-11-05T00:38:20.453

您应该创建一个[`CustomAction`](https://msdn.microsoft.com/en-us/library/vstudio/d9k65z2d(v=vs.100).aspx)然后覆盖`Install`。然后你可以通过抛出来取消设置[`InstallException`](https://msdn.microsoft.com/en-us/library/system.configuration.install.installexception(v=vs.110).aspx)

```
public override void Install(System.Collections.IDictionary stateSaver)
{
    if (CheckForExceptionalCondition())
        throw new InstallException("Some message for user.");

    base.Install(savedState);
} 
```

然后它会在安装过程中显示一个友好的消息框并取消设置。

[![在此处输入图像描述](../Images/c2f8054495156e6d997e3bc91c6c839d.png)](https://i.stack.imgur.com/viJSX.png)

# azure - Azure 云服务本地存储访问速度是否比 Blob 存储快

> ID：15137387
> 
> 赞同：1
> 
> 时间：2013-02-28T14:00:04.393
> 
> 标签：azure, azure-storage, azure-blob-storage

我正在为天蓝色云服务构建应用程序。

该应用程序可能会多次加载一些配置文件和其他支持文件...例如 DLL、XAMLX 文件和其他 XML...

因此，为了提高性能，我想知道将 blob 复制到云服务本地存储然后使用它是否比直接从 blob 存储加载它更具性能（并且可能更便宜）？

PS：我确实知道本地存储不是持久的，如果实例崩溃我会丢失它，这就是为什么所有东西都首先保存在 blob 上......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-28T14:25:19.593

本地存储是硬盘驱动器，速度更快。

如果这些文件是动态的，意味着它们是在应用部署后创建的，那么您需要使用 blob 存储。但是如果应用程序在服务器上需要它们，我会在本地保存它们以提高性能

如果它们不是动态的，则将它们添加到您网站的相关位置 app_data 或其他文件夹中。

如果文件已提供给客户端并且不需要安全性，则直接从 blob 存储提供它们。

**编辑本地驱动器速度的详细信息**

我在生产环境中使用了一个小实例来进行这些测试。小型实例没有获得最高的 I/O，他们说它是中等的。我还在西欧实例上执行了这些测试。您可能会从美国较新的数据中心之一获得更快的性能。

本地存储

![存储驱动器](../Images/322456c4ea470c82466566288739e2de.png)

操作系统驱动器

![Windows 驱动器](../Images/1029233c3cd6cfcc428af96109c8578b.png)

应用驱动

![应用驱动](../Images/6eebb3497aa28c0004cc5cbf5fffd960.png)

# java - 如何在 Java 中为 Blitline 发送 Json POST 请求？

> ID：15137389
> 
> 赞同：1
> 
> 时间：2013-02-28T14:00:14.013
> 
> 标签：java, json, post

大家好，我正在尝试用 Java 发送 Json POST 请求，以使用图像处理服务 Blitline 执行任务。但是我不断收到错误消息：

IOException：服务器返回 HTTP 响应代码：500 对于 URL：[http ://api.blitline.com/job](http://api.blitline.com/job)

在以下链接中有一个示例代码，但在我的情况下不起作用。

[http://blog.blitline.com/post/21295009377/post-to-blitline-api-with-java](http://blog.blitline.com/post/21295009377/post-to-blitline-api-with-java)

任何使用 blitline 的人都可以给我一个提示吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-03-30T20:02:46.570

响应 json 内容可能包含一个线索，例如：

```
 String responseData = connection.getResponseMessage(); 
```

# java - 不支持公钥算法

> ID：15137395
> 
> 赞同：2
> 
> 时间：2013-02-28T14:00:33.937
> 
> 标签：java, x509certificate

我想用以下功能检查文件的签名

```
public boolean checkSignature(X509Certificate certificate, String filePath,
        byte[] bytearray) throws IOException, NoSuchAlgorithmException,
        NoSuchProviderException, InvalidKeyException, SignatureException {

    File file = new File(filePath);
    byte[] message = new byte[(int) file.length()];
    FileInputStream fis = new FileInputStream(file);
    fis.read(message);
    fis.close();

    PublicKey pubKeyRSA = certificate.getPublicKey();

    Signature sig = Signature.getInstance("SHA1withRSA");

    sig.initVerify(pubKeyRSA);
    sig.update(message);
    boolean isValid = sig.verify(bytearray);
    System.out.println("The signature verifies: " + isValid);

    return isValid;
} 
```

但是为了线`PublicKey pubKeyRSA = certificate.getPublicKey();`

我得到了例外：

```
java.lang.IllegalStateException: Public Key algorithm not supported by any installed provider!
    at codec.x509.X509Certificate.getPublicKey(X509Certificate.java:486)
    at workpackage.XMLSigner.checkSignature(XMLSigner.java:67)
    at workpackage.WorkProgram.VerifyXmlSignature(WorkProgram.java:117)
    at workpackage.WorkProgram.main(WorkProgram.java:64) 
```

谁能帮我解决这个问题？

# php - 禁用缩放在 Safari ipad/iphone 上无法正常工作

> ID：15137397
> 
> 赞同：1
> 
> 时间：2013-02-28T14:00:37.113
> 
> 标签：php, jquery-mobile, meta-tags

我正在使用 jquery mobile 开发应用程序。我使用以下方法禁用了整个应用程序的缩放：

```
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" /> 
```

一切正常，直到我点击应用程序中的文本输入进行输入，然后 iPad/iPhone 键盘出现，在此之后，在完成输入后键盘隐藏后，捏缩放重新启用，即使元数据仍然存在指定的。

我究竟做错了什么？我已经搜索了很多好答案，但没有找到任何具体的答案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T14:59:43.120

删除：宽度=设备宽度

利用：

```
<meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, user-scalable=0" /> 
```

文档类型是 ? ：

```
<!DOCTYPE html> 
```

# c# - 在 Windows 窗体中检索数据库和图像

> ID：15137399
> 
> 赞同：2
> 
> 时间：2013-02-28T14:00:40.887
> 
> 标签：c#, ms-access-2007, oledb

我是 c# 和数据库的新手，我有一个奇怪的问题......

我想在我的 c# 程序中添加一个数据库并从中显示一个图像。我将图像存储在我的数据库中。我不知道如何使用 oledb 等，所以有人向我展示了一个表适配器。这是有道理的，但我不知道如何开始。请帮忙。

我通常不会在网上问，但我用谷歌搜索，我得到的所有答案都是 oledb 的东西。如果有人可以指导我学习教程，因为做某事并且不了解您实际在做什么是毫无意义的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T14:13:29.237

您需要学习 ADO.NET。网上有很多教程。

这是从 Access 数据库中检索数据的一个示例：-

[http://csharp.net-informations.com/data-providers/csharp-oledbdataadapter.htm](http://csharp.net-informations.com/data-providers/csharp-oledbdataadapter.htm)

# php - 贝宝响应“失败”

> ID：15137401
> 
> 赞同：4
> 
> 时间：2013-02-28T14:00:50.293
> 
> 标签：php, paypal, payment-gateway

我正在将贝宝整合到我的购物车这是我的价值转移表格

```
 <h3>By Paypal</h3><hr/>
       <label>Click Here</label>
       <br/>
     <?php
      include 'controller/connection.php';
      $paypal_url = 'https://www.sandbox.paypal.com/cgi-bin/webscr';
      $paypal_id = 'my-sellerID_biz@yahoo.com';                                                                                                                                $cancel_url = 'http://my-website/index.php?action=cancel';
      $return_url = 'http://my-website/store.php';
      $i = 0;
      $products = array();
      $qry = mysql_query("select * from temp_cart where tokenId='$token'");
      while ($row = mysql_fetch_array($qry)) {
      $pid = $row[0];
      $pname = $row[1];
      $qty = $row[3];
      $price = $row[4];
      $amount = $row[5];
      $products[] = array('pid' => $pid, 'pname' => $pname, 'qty' => $qty, 'price' => $price, 'amount' => $amount);
       }
    ?>
     <form action="<?php echo $paypal_url;?>" method="post">
     <input type="hidden" name="cmd" value="_cart">
     <input type="hidden" name="upload" value="1">
     <input type="hidden" name="add" value="1">
     <input type="hidden" name="business" value="<?php echo $paypal_id;?>">
             <?php
             foreach ($products as $product) {
             $i++;
              //echo $product['amount'];
              ?>
             <input type="hidden" name="item_name_<?php echo $i;?>" value="<?php echo $product['pname']?>">
             <input type='hidden' name='item_number_<?php echo $i;?>' value='<?php echo $product['pid'] ?>' />

             <input type="hidden" name="amount_<?php echo $i;?>" value="<?php echo $product['amount']?>">
            <?php
              }
             ?>

        <input type='image' src='https://www.sandbox.paypal.com/en_US/i/btn/btn_buynow_SM.gif' name='submit' style='display:{$display_button}' />
   </form> 
```

这工作正常。但付款后，当我从贝宝重定向时，我得到了失败响应。但在我的发送箱帐户中，它显示我完成。并显示我购物车。我从贝宝获取响应的代码是：-

```
<?php
session_start();

//include('connection.php');
/*
 update: 06/27/2011
  - updated to use cURL for better security, assumes PHP version 5.3
*/

// read the post from PayPal system and add 'cmd'
$req = 'cmd=_notify-synch';

$tx_token = $_GET['tx'];

$pp_hostname = "www.sandbox.paypal.com"; 

// read the post from PayPal system and add 'cmd'
$req = 'cmd=_notify-synch';

$tx_token = $_GET['tx'];
$auth_token = "MY API TOKEN";
$req .= "&tx=$tx_token&at=$auth_token";

$ch = curl_init();
curl_setopt($ch, CURLOPT_URL, "https://$pp_hostname/cgi-bin/webscr");
curl_setopt($ch, CURLOPT_POST, 1);
curl_setopt($ch, CURLOPT_RETURNTRANSFER,1);
curl_setopt($ch, CURLOPT_POSTFIELDS, $req);
curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, 1);
//set cacert.pem verisign certificate path in curl using 'CURLOPT_CAINFO' field here,
//if your server does not bundled with default verisign certificates.
curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, 2);
curl_setopt($ch, CURLOPT_HTTPHEADER, array("Host: $pp_hostname"));
$res = curl_exec($ch);
curl_close($ch);

if(!$res){
    //HTTP ERROR
}else{
     // parse the data
    $lines = explode("\n", $res);
    $keyarray = array();
    echo $lines[0];

    echo "<br>";
    if (strcmp ($lines[0], "SUCCESS") == 0) {
       echo $lines[0];
        for ($i=1; $i<count($lines);$i++){
        list($key,$val) = explode("=", $lines[$i]);
        $keyarray[urldecode($key)] = urldecode($val);
    }
    //echo "skjdhckh";
    // check the payment_status is Completed
    // check that txn_id has not been previously processed
    // check that receiver_email is your Primary PayPal email
    // check that payment_amount/payment_currency are correct

    $user_email = 'myID@gmail.com';

     $site_name = 'Company name';
     $eol = "\r\n";
     $headers  = 'MIME-Version: 1.0' . $eol;
     $headers .= 'Content-type: text/html; charset=iso-8859-1' . $eol;
     $headers .= 'From:' . $site_name . ' <mailID@gmail.com>'. $eol;
     $headers .= 'Reply-To:' . $site_name . ' <mailID@gmail.com>' . $eol;
     $headers .= 'Return-Path:' . $site_name . ' <mailID@gmail.com>' . $eol;

     $eol = "\r\n<br />";
     $thanks_text = $eol.$eol.'Thanks!'. $eol;
    if(isset($_SESSION['user']) && ($_SESSION['token']))
        {
                include('connection.php');

                $user=$_SESSION['user'];
                $_SESSION['user']=$user;
                $token=$_SESSION['token'];
                $_SESSION['token']=$token;
                //$sub=$_SESSION['coursename'];
                date_default_timezone_set('Australia/Melbourne'); 
                $date = date('y-m-d h:i:s a', time());
                $qry="update allorder set status='completed',date='$date'  where token='$token' and name1='$user'";
                $run_qry=mysql_query($qry);

                    if($run_qry)
                    {

    /*$select_id="select email from register where username='$username'";
    $run_qry2=mysql_query($select_id);
     if($row=mysql_fetch_row($run_qry2))
    {   */
      $email=$row[0];   
      $email_tpl = 'Hello Buyer,' . $eol;
      $email_tpl .= "We have received your payment of $amount $cc." . $eol;
      $email_tpl .= "Thanks for the purchase." . $eol;
      $email_tpl .= $eol . $thanks_text;

    mail ($email, 'Payment Received', $email_tpl, $headers);
    echo $email;
    $_SESSION['username']=$user;
                ?>
                 <script language="javascript" type="text/javascript">
            // Print a message
            alert('Thank you for your purchase! your Payment was successfull. Now You can print and download your certificate');
                // Redirect to some page of the site.
            window.location = 'index.php';
                </script>
                <?php
    //}

                }

                    else
                    {
                    echo mysql_error();
                    }

    }

    }
    else if (strcmp ($lines[0], "FAIL") == 0) {
       echo 'Transaction Failed';
    }
}

?> 
```

一切正常，但我收到失败响应。如果我忘记了什么，请帮助我。

提前致谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-28T14:32:46.197

如果您正在使用沙箱进行测试，请确保您使用的是来自您的测试沙箱卖家账户的 PDT 令牌。

失败、4002 或 4003 响应的原因

*   确保您发回“tx”、“cmd”和 Auth 值 为了让 PayPal 返回 SUCCESS 和交易详细信息，您的 PDT 脚本需要发布从返回字符串中提取的“tx”变量，即来自您帐户的 Auth 令牌使用 cmd "_notify-synch" 到 PayPal。

*   无效的身份验证令牌 检查令牌以确保它是准确的并且被正确地传回。确保您的令牌是一个连续的字符串，并且在您的脚本中没有换行符。对于某些语言，这可能会有所不同。

*   确保您没有发回错误的 URL。如果您在沙盒中进行测试，您需要确保您的脚本回传到 www.sandbox.paypal.com。如果您在实时站点上，则该脚本应发回 www.paypal.com。如果您在沙盒中进行测试并且您的脚本回传到实时站点，您将收到 FAIL（反之亦然）

*   验证相同的“tx”超过 5 次 检查用户行为。获得 FAIL 的另一种方法是，如果您引用相同的“tx”超过 5 次。示例：如果用户在看到详细信息后刷新 PDT 页面 5 次，他们将在最后一次刷新时看到 FAIL。这不是错误。这样做是出于安全目的，因此不能无限期地访问 PDT 创建的 URL 以检索特定于事务的数据。

*   “tx”值无效或缺失 “tx”值是用于收集付款信息的交易 ID。如果这无效或不存在，您将收到 FAIL 响应，因为无法检索支付数据。

未收到 PDT

*   与付款相关联的电子邮件地址 要使 PDT 工作，您必须在按钮代码中确认用作业务价值的电子邮件地址。如果未确认此电子邮件地址，PDT 将不起作用，因为您将看不到附加到返回 URL 的 PDT 查询字符串。

*   确保您使用的是格式正确的返回 URL。当您启用 PDT 时，您用作默认自动返回 URL 的 URL 必须是有效的主机名或 IP 地址，而不是内部 Intranet URL，否则用户将不会自动返回到该 URL。确保您使用有效的 URL 作为您希望用户返回的 URL，否则您将看不到预期的结果。

*   订阅式付款按钮 PDT 不适用于订阅，如果您有免费试用的订阅，您将在返回页面/PDT 流程上看不到任何数据。这是因为 PDT 传输支付数据，如果在注册时，如果没有支付，那么就没有支付数据要传输。

*   用户行为 PDT 是客户通过选择退货按钮或在客户登录其 PayPal 帐户进行支付时不选择任何内容通过退货方法激活的。这意味着买家可以更改退货流程或退出浏览器，并且不会传输任何数据。

# wordpress - 选择框菜单不加载页面

> ID：15137403
> 
> 赞同：1
> 
> 时间：2013-02-28T14:00:57.653
> 
> 标签：wordpress, select, drop-down-menu, responsive-design, buddypress

我是我的 Wordpress（使用 Buddypress）应用程序，我使用响应式主题。但是，如果屏幕宽度 <= 768px，我已将菜单更改为选择框下拉菜单。

您可以在下面看到我这样做的想法，这是通过使用两个 wp_nav_menu 来完成的，其中一个（在步行者的帮助下）将菜单创建为选择下拉菜单（当然在 responsive.css 的帮助下）。

但是，我在这里遇到问题需要帮助：

选择框菜单看起来是正确的，但如果我更改菜单中的选项，实际上什么也没有发生（即页面没有改变）。怎么来的？

**header.php：**

```
<div id="navigation" role="navigation">
    <?php

    <?php
        wp_nav_menu( array(
            'container' => false,
            'menu_id' => 'nav',
            'theme_location' => 'primary',
            'fallback_cb' => 'bp_dtheme_main_nav' )
        );

        wp_nav_menu(array(
            'container' => false,
            'menu_id' => 'nav',
            'theme_location' => 'primary', // your theme location here
            'walker'         => new Walker_Nav_Menu_Dropdown(),
            'items_wrap'     => '<select>%3$s</select>',
            'fallback_cb'    => 'bp_dtheme_main_nav'
        ));

        class Walker_Nav_Menu_Dropdown extends Walker_Nav_Menu{
            function start_lvl(&$output, $depth){
               $indent = str_repeat("\t", $depth);
            }

            function end_lvl(&$output, $depth){
              $indent = str_repeat("\t", $depth);
            }

            function start_el(&$output, $item, $depth, $args){
              $item->title = str_repeat("&nbsp;", $depth * 4).$item->title;

              parent::start_el(&$output, $item, $depth, $args);

              $output = str_replace('<li', '<option', $output);
            }

            function end_el(&$output, $item, $depth){
              $output .= "</option>\n";
            }
        } ?>
</div> 
```

编辑：我已经意识到呈现的选择选项不包含任何值，所以我无法获取重定向的选项值。代码显然有问题，但是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-03T11:18:58.937

如果我正确地阅读了您的问题，那么缺少的部分是JavaScript，它`window.location`在选择“选择菜单中的一个选项”时会更改。

将以下内容添加到您的 onload JS；

```
 $("#responsive-nav select").change(function() {
    window.location = $(this).find("option:selected").val();
 }); 
```

**编辑**

好的，我实际上只是将它实现到我自己正在做的主题中。我看到你在这个问题中使用了 One Trick Pony 的答案 -

[https://wordpress.stackexchange.com/questions/27497/how-to-use-wp-nav-menu-to-create-a-select-menu-dropdown](https://wordpress.stackexchange.com/questions/27497/how-to-use-wp-nav-menu-to-create-a-select-menu-dropdown)

我不确定他们是如何让它工作的，因为没有 url 值可用作导航（正如您所指出的那样），所以我修改了`start_el`如下方法；

```
function start_el(&$output, $item, $depth, $args){
  // add spacing to the title based on the depth
  $item->title = str_repeat("&nbsp;", $depth * 4).$item->title;

  parent::start_el(&$output, $item, $depth, $args);

  $href = ! empty( $item->url ) ? ' value="'   . esc_attr( $item->url ) .'"' : '';

  // no point redefining this method too, we just replace the li tag...
  $output = str_replace('<li', '<option '.$href, $output);

} 
```

我保持 Javascript 与上述相同，并将 wp_nav_menus 调用以带有 id 的形式包装在 header.php 中`responsive-nav`；

```
 <!-- RESPONSIVE NAVIGATION FLIP -->
    <form id="responsive-nav" action="" method="post">
    <select>
    <option value="">Navigation</option>
        <?php 

        $menu = wp_nav_menu(array(
          'theme_location' => 'primary', 
          'walker'         => new Walker_Nav_Menu_Dropdown()
        ));

        ?>
    </select>
    </form>
    <!-- /END RESPONSIVE NAV --> 
```

# twitter-bootstrap - 我可以根据 Bootstrap LESS 变量动态编译新的 CSS 吗？

> ID：15137408
> 
> 赞同：1
> 
> 时间：2013-02-28T14:01:14.327
> 
> 标签：twitter-bootstrap, ruby-on-rails-3.1, ruby-on-rails-3.2, twitter-bootstrap-rails

我有一个 Rails 3.2 应用程序，其中每个用户都有自己的子域。他能够改变一些事物的外观和感觉。在 Bootstrap 之前我这样做的方式是：

```
1) Keep a template of a customizable CSS file.

2) Solicit input for certain CSS settings via a form.

3) On form submission, write a new CSS file based on the template, but with the new settings.

4) Associate the new CSS file with that partiular subdomain, and serve it up when the subdomain is accessed via the main layout template. 
```

这样做有点难看，但效果很好。此后，我通过 twitter-bootstrap-rails gem 迁移了应用程序以使用 Twitter Bootstrap。这使我能够清理大量代码。我现在要做的是清理这个 CSS 自定义功能。

我想仅基于更改 Twitter Bootstrap LESS 变量来进行新的 CSS 更改。我的子域的新 LESS 文件将像这样生成：

```
@bodyBackground: #ffffff;

@navbarLinkColor: #ffffff;

@navbarText: #ffffff;

@headingsColor: #666666;

@linkColor: #000000;

@navbarBackgroundHighlight: #000000;

@baseFontFamily: Verdana, Tahoma, Geneva, sans-serif; 
```

请注意，仅`variables`在此文件中。所有设置都在 Bootstrap 代码中。因此，保存后，我需要动态重新编译所有 Boostrap CSS。几个问题：

1）这甚至可能吗？如果这些变量已经在 Twitter Bootstrap 中设置为默认值，我该如何覆盖它们？

2）我是不是走错了路？我认为它会更干净，但我开始怀疑。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T14:44:03.197

我需要做的就是将它添加到 LESS 文件的顶部：

```
@import "bootstrap_and_overrides.css.less"; 
```

这照顾了一切。干净多了！！！

# c-preprocessor - __real__ 在 C 预处理器中是什么意思？

> ID：15137410
> 
> 赞同：2
> 
> 时间：2013-02-28T14:01:17.923
> 
> 标签：c-preprocessor

我无法找到`__real__`GNU C Preprocessor 中的定义。谁能指出我在哪里可以找到它？我的意思是在哪个头文件中？它有什么意义？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T14:04:32.693

与预处理器无关 -`__real__`并且`__imag__`是用于复数支持的 C99 语言扩展 - 请参阅： http: [//gcc.gnu.org/onlinedocs/gcc/Complex.html](http://gcc.gnu.org/onlinedocs/gcc/Complex.html)

请注意，这些是在 gcc 和 gcc 兼容的编译器（例如 Intel 的 ICC）中发现的非标准扩展。

# visual-studio - SharePoint 2013 自定义登录页面？

> ID：15137412
> 
> 赞同：3
> 
> 时间：2013-02-28T14:01:44.183
> 
> 标签：visual-studio, sharepoint, visual-studio-2012, claims-based-identity, sts-securitytokenservice

我正在使用基于声明的身份验证，并且我想使用自定义登录页面而不是`_login/default.aspx`页面。我使用 Visual Studio 2012 创建了一个应用程序页面，并在`_layouts`文件夹中部署了一个登录页面。
我的理解是我不能将该页面作为自定义登录页面，因为当我尝试这样做时它会给我访问错误。请指导我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T16:04:08.930

您可以尝试遵循此[链接](http://blogs.msdn.com/b/kaevans/archive/2010/07/09/creating-a-custom-login-page-for-sharepoint-2010.aspx)中的建议。它还显示了如何为基于声明的身份验证执行此操作的指南。请注意，为 SharePoint 2013 创建自定义登录页面仍使用与 SharePoint 2010 相同的概念。

# php - 在我手动将其保存在管理面板中之前，以编程方式创建的可配置项目不会显示选项

> ID：15137413
> 
> 赞同：3
> 
> 时间：2013-02-28T14:01:44.673
> 
> 标签：php, magento, magento-1.7

我正在用代码创建一个可配置的产品（正在做一个导入模块），一切看起来都很好。添加了属性，简单的库存项目被添加到可配置产品中没有问题但是，当我在字体端查看项目时，它显示为简单产品（没有选项）但是当我保存打开并将产品保存在然后管理面板正确显示前端的选项。

我在重新保存项目之前和之后使用以下代码来检查是否有任何属性不匹配（假设我错过了一些东西）

```
foreach ($product->getTypeInstance(true)->getEditableAttributes($product) as $code=>$attribute)    
{
    $val = Mage::getResourceModel('catalog/product')->getAttributeRawValue($product->getId(), $code, $storeId);
    Mage::log($code . '=>' . $val);
} 
```

新导入的产品（不显示选项）和手动保存的产品（显示）之间的所有值都匹配。

这是我用来创建产品的代码（我省略了将属性/简单项目添加到可配置产品的位，但如果需要，请告诉我）：

```
$productData = array(
    'name'              => $name,
    'websites'          => array(1, 2), 
    'short_description' => $shortDescription,
    'description'       => $longDesc,
    'status'            => 1,
    'weight'            => $weight,
    'tax_class_id'      => 2, //0:None;2:Taxable Goods;4:Shipping
    'categories'        => $categoryIds,
    'price'             => $sellPrice,
);

if ($parentStockItem == null) // != null is child item, == false is simple item,  == null is config item
{
    $productData['has_options'] = 1;
    $productData['required_options'] = 1;
    $productData['msrp_enabled'] = 2; //added to test as this was missing in my comparison check
    $productData['msrp_display_actual_price_type'] = 4;  //added to test as this was missing in my comparison check
}

return $mc->create($type, $setId, $stockCode, $productData); 
```

我需要做些什么来设置一个项目以在前端显示选项吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-28T18:09:50.327

好的，我通过比较保存项目之前和之后的数据库快照之间的数据，设法找到了问题。

发生这种情况的原因`stock_status`是`cataloginventory_stock_status`. 此值默认为`0`，但当您保存产品时，它会将其设置为`1`。您还需要确保您正在设置其他库存选项，因此将以下内容添加到我的例程中可以解决问题：

```
$stockItem = Mage::getModel('cataloginventory/stock_item');
$stockItem->assignProduct($product);
$stockItem->setData('stock_id', 1);
$stockItem->setData('qty', 0);
$stockItem->setData('use_config_min_qty', 1);
$stockItem->setData('use_config_backorders', 1);
$stockItem->setData('min_sale_qty', 1);
$stockItem->setData('use_config_min_sale_qty', 1);
$stockItem->setData('use_config_max_sale_qty', 1);
$stockItem->setData('is_in_stock', 1);
$stockItem->setData('use_config_notify_stock_qty', 1);
$stockItem->setData('manage_stock', 1);
$stockItem->save();

//This section is what was required.
$stockStatus = Mage::getModel('cataloginventory/stock_status');
$stockStatus->assignProduct($product);
$stockStatus->saveProductStatus($product->getId(), 1); 
```

现在，该项目会在导入后立即正确显示选项。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-28T14:18:46.780

I ran into this same problem. Its a tough nut to crack. My solution may not be elegant, but it has worked for a year now without problems. Its a little ugly, but it works.

Yes, you need to do many specific things. Instead of explaining each thing, I'll just post the source code I wrote that accepts a master product and its associated products. It boils down to the fact that you have to create a simple product first, use it as a 'template' for your configurable product.

You have to create the master and associated products first, then use the code below to create the configurable product. If you don't want the master product to exist after creating the configurable, simply add code to delete it then change the sku on the new configurable product's entity_id to the sku of the master product.

**Make sure you change YOUR_MAGENTO_DBNAME to your database's name**

```
public function createConfigurableProduct($master_sku, $sku_list) {
    // Recreate the array from the serialized string

    try {
        $sku = array();
        $sku = explode(",", $sku_list);

        if (empty($sku)) {
            die ("You have to pass a valid SKU list");
        }

        // Set an object up for the master sku passed by soap
        $masterProduct = Mage::getModel('catalog/product')->loadByAttribute('sku', $master_sku);
        $attrib = $this->getAttribFromProdId($masterProduct->entity_id);

        if ($attrib->attribute_set_id == "") {
            die ("Could not get master product attribute set id from master product");
        }

        $categories = $masterProduct->getResource()->getCategoryIds($masterProduct); 

        if (empty($categories)) {
            die ("could not get the categories that the master product is in. This code requires it is in at least one category");
        }

        // Create the configurable product based on the master product sku passed through SOAP
        $newProductObj = Mage::getResourceModel('catalog/product_collection')->getData();

        $attributes = $masterProduct->getAttributes();

        // Set attributes
        $product = Mage::getModel('catalog/product');

        // Create master copy
        foreach ($attributes as $attr) {
            $attrCode = $attr['attribute_code'];
            // Don't duplicate these values
            if (
                $attrCode != "type_id" 
                && $attrCode != "sku" 
                && $attrCode != "entity_id"
                && $attrCode != "visibility"
                && $attrCode != "url_key"
                && $attrCode != "url_path")
            {
                $product[$attrCode] = $masterProduct[$attrCode];
            }
        }

        // Add all of the stuff 
        $product->setTypeId('configurable');

        // It will create a configurable product with the master product's sku and append -C to the end. cannot duplicate skus
        $product->setSku(str_replace("-C", "", $masterProduct->sku));
        $product->setPrice($masterProduct->price);
        $product->setVisibilty(4); //catalog and search
        $product->setWebsiteIds(array(1));
        $product->setAttributeSetId($attrib->attribute_set_id); 
        $product->setCategoryIds($categories);
        $product->setName($masterProduct->name);
        $product->setDescription($masterProduct->description);
        $product->setShortDescription($masterProduct->short_description);
        $product->setStatus(1); 
        $product->setTaxClassId('2');
        $product->setFeaturedProduct('0');
        $product->setIsImported(0);
        $product->setWeight($masterProduct->weight);                
        $product->setCreatedAt(strtotime('now'));
        $product->product_type=$masterProduct->product_type;
        $product->vendor_code=$masterProduct->vendor_code;

        /* This is the configurable product attribute array
        We do a foreach loop and gather data from each sku's attrib array
        and create a new array for the new product based on what is to be 
        */

        // First, get the information about the master product from the database
        $db = Mage::getSingleton('core/resource')->getConnection('core_read');
        $sql="select * from 
                `nki_magentoV1.11.1.0`.catalog_eav_attribute AS A 
                INNER JOIN `YOUR_MAGENTO_DBNAME`.eav_attribute AS B ON A.attribute_id = B.attribute_id AND B.is_user_defined = 1 
                INNER JOIN `YOUR_MAGENTO_DBNAME`.eav_entity_attribute as EEA ON B.attribute_id = EEA.attribute_id
                WHERE EEA.attribute_set_id = " . $attrib->attribute_set_id . " AND A.is_configurable = 1 AND attribute_code != 'cost' AND B.source_model IS NOT null";
            //echo $sql;

        // Result Set

        $masterResult = $db->fetchAll($sql);
        $data = array();
        $retSku = array();

        foreach ($masterResult as $master) {
            $dataInner = array();

            // This section handles configurable product parameters based on the simple product's attributes
            $values = array();
            foreach ($sku as $prodsku) {

                $innerVals = array();
                // This gets the attribute of the current product
                try {
                    $productBySku = Mage::getModel('catalog/product')->loadByAttribute('sku',$prodsku);
                } catch (Exception $e)
                {
                    // Product cannot be loaded, so continue to next iteration of the loop
                    continue;
                }

                $attribVal = $productBySku[$master['attribute_code']];

                // Load up the attribute set and compare
                $attribute = $productBySku->getResource()->getAttribute($master['attribute_code']);

                $attributeInfo = Mage::getResourceModel('eav/entity_attribute_collection')
                    ->setCodeFilter($master['attribute_code'])
                    ->getFirstItem();

                // There is a possible chance that there is a null error occur here, however it is VERY
                // unlikely that attributeInfo will not be having a valid attribute loaded
                $attributeOptions = $attributeInfo->getSource()->getAllOptions(false);

                foreach ($attributeOptions as $option) {
                    if ($attribVal == $option['value']) {
                        $innerVals['value_index']=$option['value'];
                        $innerVals['label']=$option['label'];
                        $retSku[] = $prodsku;
                    } 
                }

                $innerVals['attribute_id']=$master['attribute_id'];

                if ($masterProduct['price'] != $productBySku['price']) {

                    $calcPrice = $masterProduct['price'] - $productBySku['price'];
                    $innerVals['pricing_value']=$calcPrice * -1;
                }
                else 
                {
                    $innerVals['pricing_value']= 0;
                }

                //$innerVals['pricing_value'] = '100';
                $innerVals['is_percent'] = '0';

                // Only add to the array if there was a value
                // return only the sku's added to the configurable product

                if ($innerVals['value_index'] <> NULL) {
                    $values[] = $innerVals;
                }

            }

            // Set the sata array for the configurable item
            $dataInner['id'] = NULL;
            $dataInner['label'] = $master['attribute_code'];
            $dataInner['position'] = NULL;
            $dataInner['attribute_id'] = $master['attribute_id'];
            $dataInner['frontend_label'] = $master['frontend_label'];
            $dataInner['html_id'] = 'config_super_product__attribute_0';
            $dataInner['values'] = $values;

            $data[] = $dataInner;   
        }

        $product->setConfigurableAttributesData($data);
        $product->setCanSaveConfigurableAttributes(1);

        // Set the stock data so it will appear on the site
        $stockData = $product->getStockData();
        $stockData['is_in_stock'] = 1;
        $stockData['use_config_manage_stockSpecified'] = true;
        $stockData['use_config_manage_stock'] = 0;
        $stockData['manage_stock'] = 1;
        $product->setStockData($stockData);

        // Finally save the product
        try{
            $product->save();
            $productId = $product->getId();

            //echo $product->getId() . ", $price, $itemNum added\n";
        }
        catch (Exception $e){ 
            // Saving the product failed
            $result = array (
                array(
                    'master_sku' => $master_sku,
                    'sku_list' => $sku_list,
                    'retval' => $e
                    )
            );

            error_log($e);
            return $result;
        } 

        // Add the associated products
        if ($productId > 0) {

            foreach($sku as $productSku) { 
                $productIdBySku = Mage::getModel('catalog/product')->loadByAttribute('sku',$productSku)->getId();

                // Add handler to not die on adding products that don't exist
                if ($producIdBySku > 0)
                {
                    $res = $this->addToConfigurable($productId, $productIdBySku);

                    /*                                              
                    if ($res == -5) 
                    {
                        $result = array (
                            array(
                                'master_sku' => $master_sku,
                                'sku_list' => $sku_list,
                                'retval' => ERR_ADD_ASSOCIATED_PROD_FAIL
                                )
                        );
                        return $result;
                    }
                    */

                }
            }

            $product->save();

            $stockItem = Mage::getModel('cataloginventory/stock_item');
            $stockItem->assignProduct($product);
            $stockItem->setData('is_in_stock', 1);
            $stockItem->setData('stock_id', 1);
            $stockItem->setData('store_id', 1);
            $stockItem->setData('manage_stock', 0);
            $stockItem->setData('use_config_manage_stock', 0);
            $stockItem->setData('min_sale_qty', 0);
            $stockItem->setData('use_config_min_sale_qty', 0);
            $stockItem->setData('max_sale_qty', 1000);
            $stockItem->setData('use_config_max_sale_qty', 0);

            $stockItem->save();

            //echo $productArray['product_id'];
        } else {
            // Something baaaaad happened
        }

    } catch (Exception $e) {
        // FATAL ERROR
        // Return php's fatal error that cannot be handled above (which should not happen, but might)
        die ( $e->getMessage() );
    }   

    echo "Configurable Product Created Successfully";
} 
```

# jquery - jQuery mobile mobileinit 未触发

> ID：15137416
> 
> 赞同：4
> 
> 时间：2013-02-28T14:01:46.307
> 
> 标签：jquery, cordova, jquery-mobile, mobile-application

我想在加载 jQuery mobile 之前通过 AJAX 动态加载页面内容，所以我正在尝试使用该`mobileinit`事件。但它不起作用。这是我的代码请帮忙

```
 <!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
    <html>
    <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="stylesheet" href="http://jquerymobile.com/demos/1.3.0-beta.1/css/themes/default/jquery.mobile-1.3.0-beta.1.css" />
    <script src="js/jquery-1.8.2.min.js"></script>
    <script>
        $(document).bind("mobileinit", function()  {        
            $("#notification").text("Please enter your domain name.");
        });
    </script>
    <script src="js/jquery.mobile-1.3.0.min.js"></script>
    <title>Insert title here</title>
    </head>
    <body>
       <h3 id="notification" style="font-family: fantasy; color: red; text-align: center;"></h3>
    </body>
    </html> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-28T15:20:10.607

这行不通。

触发 mobileinit 事件时，DOM 内容仍为空。Pageinit 是您甚至可以考虑这样做的第一个事件。但更好的是 pagebeforeshow 事件。

```
$(document).on('pagebeforeshow', '#index', function(){    

}); 
```

这是我添加动态生成内容的旧示例：http: [//jsfiddle.net/Gajotres/GnB3t/](http://jsfiddle.net/Gajotres/GnB3t/)

这是另一个示例，只需单击下一步按钮即可查看动态生成的页面：http: [//jsfiddle.net/Gajotres/8jcGb/](http://jsfiddle.net/Gajotres/8jcGb/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T14:42:29.537

尝试这个

```
<script src="js/jquery.mobile-1.3.0.min.js"></script>
<script>
function init(){
    $(document).bind("mobileinit", function()  {        
        $("#notification").text("Please enter your domain name.");
    });
}
</script>
<body onLoad="init()">
</body> 
```

# c# - 如何在 asp:gridview 中动态创建列

> ID：15137420
> 
> 赞同：2
> 
> 时间：2013-02-28T14:01:52.197
> 
> 标签：c#, asp.net, gridview

我想在 Gridview 中创建一个列，其值充当超链接。超链接 url 由数据集提供的部分组成

```
Foreach(dRow in Tables[0].Row)
{
url = "<a href=ClientView.aspx?\"" + dRow["client_id"].ToString() +"</a>";
} 
```

如何在显示此链接的 gridview 中生成列？

其他列在标记中定义。

```
<asp:GridView ID="GridView1" runat="server" Width="100%" AutoGenerateColumns="False">

<Columns>
     <asp:BoundField DataField="Sno" HeaderText="SNo" />
     <asp:BoundField DataField="ClientName" HeaderText="Name" />
</Columns>
</asp:GridView> 
```

我想在 gridview 的**SNo**和**ClientName**列之间添加列 ClientId ，其文本是从数据集行`drow["clientid"]`字段获得的，并包含在锚标记之间以表现得像 url。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-28T14:11:35.840

在您的标题中使用 a `TemplateField`，您不需要动态创建它：

```
<asp:GridView runat="server" ID="gridView1" AutoGenerateColumns="false">
    <Columns>
        <asp:TemplateField>
            <HeaderTemplate>
                <asp:hyperlink runat="server" id="hlClientView"
                  NavigateUrl='<%# String.Format("ClientView.aspx?client_id={0}", Eval("client_id")) %>'
                  Text='<%# Eval("client_id") %>'>
                </asp:hyperlink>
            </HeaderTemplate>
        </asp:TemplateField>
    </Columns>
</asp:GridView> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T16:08:20.197

> 添加到您现有的代码中，添加一个模板字段。

```
<asp:GridView ID="GridView1" runat="server" Width="100%" AutoGenerateColumns="False">
    <Columns>
        <asp:BoundField DataField="Sno" HeaderText="SNo" />
        <asp:BoundField DataField="ClientName" HeaderText="Name" />
        <asp:TemplateField>
        <ItemTemplate>
            <asp:LinkButton runat="server" id="gvlbtnClientVIew"
              PostBackUrl='<%# "ClientView.aspx?client_id=" + Eval("client_id") %>'
              Text='<%# Bind("client_id") %>'>
            </asp:LinkButton>
        </ItemTemplate>
    </asp:TemplateField>
    </Columns>
</asp:GridView> 
```

# java - 如何找到单词的第一个索引？

> ID：15137421
> 
> 赞同：0
> 
> 时间：2013-02-28T14:01:54.470
> 
> 标签：java, string, substring

我使用以下代码

```
 String fulltext = "I would like to create some text and i dont know what creater34r3, ";
    String subtext = "create";

    int ind = -1;
            do {
                ind = fulltext.indexOf(subtext, ind + subtext.length());

            } while (ind != -1); 
```

结果，我找到了单词的第一个索引：

`create creater34r3`

但我只需要找到单词的第一个索引**`create`**

怎么做？帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T14:02:18.327

如果我理解您在字符串中查找整个单词的要求，如果它们存在，那么这个怎么样：

```
 String fulltext = "I would like to create some text and i dont know what creater34r3, ";
    String subtext = "create";
    Pattern pattern = Pattern.compile("\\b(" + subtext + ")\\b");
    Matcher matcher = pattern.matcher(fulltext);
    while (matcher.find()) {
        System.out.println(matcher.group());
    } 
```

输出将是`create`

但在我看来，您需要实际的索引 - 如果是这样，您可以将其添加到 while 块中：

```
 int start = matcher.start();
      int end = matcher.end(); 
```

# ajax - 使用 AJAX 连接到非本地 ActiveMQ

> ID：15137422
> 
> 赞同：0
> 
> 时间：2013-02-28T14:01:55.703
> 
> 标签：ajax, activemq

我是activeMQ的新手。我有一些 javascript 连接到 amq 以获取/放置消息：

```
function init()
{
//AMQ message handler
amq.init({ 
    uri: amqURI, 
    logging: true,
    timeout: amqTimeout,
    clientId:amqClientID
});
amq.addListener(amqName, amqTopic, amqHandler);
}

function amqHandler(message)
{
alert("message");
}

function amqSend(content)
{
    amq.sendMessage(amqTopic, content);
} 
```

如果网页与队列在同一台机器上提供服务（即在 uri 中使用 localhost:port/amq 或 machinename:port/amq），则此方法工作正常 - 但是连接到另一台机器上的队列只会让我超时。

我已经设置 jetty.xml 包括：

```
<bean id="Connector" class="org.eclipse.jetty.server.nio.SelectChannelConnector">
                <property name="host" value="0.0.0.0"/>
        <property name="port" value="8161" />
</bean> 
```

和 web.xml：

```
<servlet-mapping>
    <servlet-name>AjaxServlet</servlet-name>
    <url-pattern>/amq/*</url-pattern>
</servlet-mapping> 
```

我什至尝试添加到 activemq.xml：

```
<transportConnector name="websocket" uri="ws://0.0.0.0:61614"/>
<transportConnector name="nio" uri="nio://0.0.0.0:61616"/> 
```

但是仍然没有运气连接到远程activeMQ。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T13:58:33.580

这听起来很像跨域请求的正常 Ajax 限制。限制在浏览器中，并防止将任何 XmlHttpRequest 发送到站点加载之外的其他域。

有一些方法可以绕过这个限制，例如使用[JSONP](http://en.wikipedia.org/wiki/JSONP)模式。但是，它不会解决您遇到的问题（因为它支持 HTTP get，但不支持 HTTP POST，并且 addListener 和 sendMessage 都这样做）。

您可能想考虑在服务器端建立一个代理或可以正确管道数据的东西。但这并不是那么微不足道。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-10T15:39:38.647

可能是您在浏览器（或以某种方式限制 JS 的浏览器）外部的 Javascript 调用 Ajax。经过多次实验，我们发现问题出在servlet坚持认证，但由于没有浏览器弹出窗口，所以失败了。

我在 jetty-demo.xml 中禁用了身份验证，瞧——它成功了！

[请参阅此页面](http://activemq.apache.org/web-console.html)上标题为：保护 Web 控制台的部分以了解如何执行此操作。

# javascript - 对 VB.net 代码背后的 Javascript 回调

> ID：15137424
> 
> 赞同：1
> 
> 时间：2013-02-28T14:02:01.420
> 
> 标签：javascript, asp.net, vb.net, callback

以前，我问了一个问题，它的设置如下所示：

```
function checkValidate_onBlur(me) {
        var args = me.value;
        performCallback(args, "");
        return false;
    }
    function callbackComplete(result) {
        document.getElementById('<% =txtMyTextBox.ClientId %>').value = result; 
    }

   <asp:TextBox ID="txtMyTextBox" runat="server" onblur="checkValidate_onBlur(this)"  ></asp:TextBox> 
```

callbackComplete 应该控制，实际上是 callbackComplete(result, control)

在代码隐藏中使用 ICallbackEventHandler 来处理回调。

```
 Public Function GetCallbackResult() As String Implements System.Web.UI.ICallbackEventHandler.GetCallbackResult
            Return result
        End Function

        Public Sub RaiseCallbackEvent(ByVal eventArgument As String) Implements System.Web.UI.ICallbackEventHandler.RaiseCallbackEvent
            txtMyTextBox_onCallback(eventArgument)
        End Sub 
```

问题是我想设置多个字段，每个字段在触发回调时都有自己的关联函数。CodeProject 上有一个 C# 示例可以处理此问题，但是 A）它是 C#，由于它们的 Raise 事件，我不相信它可以干净地转换为 VB，并且 B）它分布在多个文件中。我正在寻找一种将回调与控件相关联的简单方法，以便每个控件都有自己可以执行的逻辑。

我想像这里找到的版本那样做：http: [//www.codeproject.com/Articles/32312/Handle-multiple-client-callbacks-in-ASP-NET](http://www.codeproject.com/Articles/32312/Handle-multiple-client-callbacks-in-ASP-NET)

关于从哪里开始的任何建议？我也是 VB.net 和 JavaScript 的新手，所以请记住这一点。

# android - 如何从活动（viewpager）更新片段内容？

> ID：15137425
> 
> 赞同：18
> 
> 时间：2013-02-28T14:02:01.070
> 
> 标签：android, android-fragments, android-viewpager

我有一个带有两个片段的简单 viewPager。每个片段都包含一个 TextView。我希望能够更新活动中显示的当前 textView 的文本。

**活动 ：**

```
public class MainActivity extends FragmentActivity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main_activity);

        ArrayList<Fragment> fragments = new ArrayList<Fragment>();
        fragments.add(Fragment.instantiate(this, Live.class.getName()));
        fragments.add(Fragment.instantiate(this, Hit.class.getName()));

        this.pagerAdapter = new MyPagerAdapter(getSupportFragmentManager(),fragments);

        ViewPager pager = (ViewPager) findViewById(R.id.viewpager);
        pager.setAdapter(pagerAdapter);
    }
} 
```

**适配器 ：**

```
public class MyPagerAdapter extends FragmentPagerAdapter {

    private final ArrayList<Fragment> fragments;

    public MyPagerAdapter(FragmentManager fm, ArrayList<Fragment> fragments)
    {
        super(fm);
        this.fragments = fragments;
    }

    @Override
    public Fragment getItem(int position) {
        return this.fragments.get(position);
    }

    @Override
    public int getCount() {
        return this.fragments.size();
    }
} 
```

**片段：**

```
public class Live extends Fragment {
    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container,
            Bundle savedInstanceState) {
        return inflater.inflate(R.layout.live, container,false);
    }
} 
```

**XML 片段：**

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
              android:layout_width="fill_parent"
              android:layout_height="fill_parent">
    <TextView android:layout_height="fill_parent"
              android:layout_width="fill_parent"
              android:text="First Fragment"
              android:id="@+id/status"/>
</LinearLayout> 
```

每个片段都有一个 ID 为“status”的 TextView。更新作品中的文本视图`onCreateView`。但是我怎样才能从活动中的任何地方更新 textView 呢？

我试过这个没有成功：

**片段：**

```
public class Live extends Fragment {    
    public TextView tv;

    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container,
            Bundle savedInstanceState) {
        View view = inflater.inflate(R.layout.live, container,false);
        tv = (TextView) view.findViewById(R.id.status);

        return view;
    }
} 
```

**活动 ：**

```
@Override
    protected void onResume() {
        super.onResume();
        Live frag = (Live) pagerAdapter.getItem(0);
        frag.tv.setText("Test 2");
    } 
```

但它给了我一个 nullPointerException on `tv`，可能是因为片段尚未膨胀。

我已经阅读了以下问题但没有成功：

*   [在 ViewPager 中从 Activity 更新片段](https://stackoverflow.com/questions/12341591/updating-fragments-from-activity-in-a-viewpager)
*   [从另一个 Fragment 更新 ViewPager 中的 TextView](https://stackoverflow.com/questions/9151811/update-a-textview-in-a-viewpager-from-another-fragment)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-28T14:14:58.983

在您的`MyPagerAdapter`班级中，Android`getItem(...)`仅在要创建新片段时才调用。所以在那里使用引用是有问题的，而不是你应该实例化片段。

检查此答案[support-fragmentpageradapter-holds-reference-to-old-fragments](https://stackoverflow.com/a/9745935/1108036)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-07-08T12:09:10.357

我这样解决了这个问题，像这样创建适配器

```
package com.yubraj.sample.adapter;

import android.os.Bundle;
import android.support.v4.app.Fragment;
import android.support.v4.app.FragmentManager;
import android.support.v4.app.FragmentStatePagerAdapter;

import com.yubaraj.sample.activities.RashiFragment;
import java.util.List;

public class PageSliderAdapter extends FragmentStatePagerAdapter {
    static String[] titleList = new String[] { "today",
            "this month", "this year" };
    List<String> rashi;
    // private static String TAG = "pagerscreenslider";

    public PageSliderAdapter(FragmentManager fm, List<String> rashiList) {
        super(fm);
        this.rashi = rashiList;
    }
    public void updateData(List<String> rashisList){
        rashi.clear();
        this.rashi = rashisList;
        notifyDataSetChanged();
    }
    @Override
    public int getItemPosition(Object object) {
        // TODO Auto-generated method stub
        return POSITION_NONE;
    }

    @Override
    public Fragment getItem(int position) {
        Fragment fragment = new RashiFragment();
        Bundle bundle = new Bundle();
        bundle.putString("RASHI", rashi.get(position));
        bundle.putInt("RASHI_TYPE", position);
        fragment.setArguments(bundle);
        return fragment;
    }

    @Override
    public int getCount() {
        return titleList.length;
    }

    @Override
    public String getPageTitle(int position) {
        return titleList[position];
    }

} 
```

然后从你的活动

```
List<String> rashiCollection = getJSONFromDb(Dates);
adapter.updateData(rashiCollection); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-03-03T01:25:05.083

```
@Override
    public int getItemPosition(Object object) {
    XXXFragment fragment = (XXXFragment) object;
        if(…condition){
    fragment.refresh(…);
    }
        return super.getItemPosition(object);
    } 
```

覆盖上述内容。当您调用 notifyDataSetChanged() 时，会触发上述方法。尽可能刷新。

# java - @PostPersist 没有被调用...... @PrePersist 是......为什么？

> ID：15137427
> 
> 赞同：7
> 
> 时间：2013-02-28T14:02:09.870
> 
> 标签：java, hibernate, jpa

我有一个 JPA @Entity 类，它使用 @PrePersist 已经有一段时间了。今天我想在需要该实体 ID 的地方添加一些功能。此 ID 在持久化期间由数据库中的 HIBERNATE_SEQUENCE 生成。它通常设置**在**em.persist(entity) 之后。

由于某些未知原因，触发了**@PrePersist**方法......而**@PostPersist**根本不会触发：

```
@Entity
public class MyEntity {

    @PrePersist
    protected void onCreate() {
        System.out.println("ExtendedEntity.onCreate()");
    }

    @PostPersist
    protected void afterCreate() {
        System.out.println("ExtendedEntity.afterCreate()");
    }
} 
```

我正在使用带有 Java v7+、Hibernate v3.3.1.GA 和 Seam v2.2.2.Final 的 JBoss v4.2 环境...

*@PostPersist 是否有任何隐藏的要求？*

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-28T14:18:54.990

对于其他所有人... Hibernate 事件侦听器似乎会干扰 JPA 持久性事件...从我的**persistence.xml**中删除以下行后，@PostPersist 回调被触发。

```
<property name="hibernate.ejb.event.pre-insert"  value="my.hibernate.events.listeners.Listener" />
<property name="hibernate.ejb.event.pre-update"  value="my.hibernate.events.listeners.Listener" />
<property name="hibernate.ejb.event.pre-delete"  value="my.hibernate.events.listeners.Listener" />
<property name="hibernate.ejb.event.post-insert" value="my.hibernate.events.listeners.Listener" />
<property name="hibernate.ejb.event.post-update" value="my.hibernate.events.listeners.Listener" />
<property name="hibernate.ejb.event.post-delete" value="my.hibernate.events.listeners.Listener" /> 
```

我们甚至不再使用这些……它们只是从未被完全禁用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T14:15:08.633

我相信它在提交或刷新期间被调用。您是否明确调用其中任何一个？我想知道的是，从实体管理器实际持久化到数据库时可能会有一些延迟。例如，在响应被写入（在 Web 应用程序中）之前，可能不会提交事务。

此外，尝试使用记录器，从 Web 应用程序调用标准时可能会发生奇怪的事情。

# eclipse - IDE Eclipse 性能问题（错误或功能）？

> ID：15137431
> 
> 赞同：1
> 
> 时间：2013-02-28T14:02:23.443
> 
> 标签：eclipse

我正在尝试调整我的 Eclipse IDE 的速度，我什至对 eclipse.ini 进行了以下更改

```
-Xms1000m
-Xmx1500m
-XX:MaxPermSize=256m 
```

但是，有一件事我无法真正得到。当我打开 2 个不同的 HTML 文件（来自另一个项目的 index.html 和 index.html）50-80 LOC 时，Eclipse 需要 5-6 秒才能在它们之间切换。另一方面，当我处理 500+ LOC Java 类时，Eclipse 会在 1-1.5 秒内切换它们。Eclipse.exe、eclipse 文件夹和我的工作区都包含在防病毒软件的异常中。

请解释一下这里发生了什么，有什么解决办法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T16:46:07.917

最初的 Eclipse Juno 版本包含一些可能导致编辑器切换非常缓慢的错误；我认为这些错误大部分已在 SR 版本中得到修复。请参阅[https://bugs.eclipse.org/bugs/show_bug.cgi?id=385272](https://bugs.eclipse.org/bugs/show_bug.cgi?id=385272)和[https://bugs.eclipse.org/bugs/show_bug.cgi?id=391868](https://bugs.eclipse.org/bugs/show_bug.cgi?id=391868)

请注意，4.2.2 (Juno SR2) 将很快推出（本周末或下周初）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T14:05:37.010

第一次打开 HTML/XHTML 文件可能需要一段时间，因为 Eclipse 会在那时加载大部分解析器/验证数据和工具。解析和验证 HTML/CSS/Scripts 比解析 Java 文件需要更多时间。

# mobile - JSONStore Worklight - 大小限制

> ID：15137432
> 
> 赞同：4
> 
> 时间：2013-02-28T14:02:26.923
> 
> 标签：mobile, ibm-mobilefirst, jsonstore

JSONStore 为我们提供了一种很好的方式来与服务器同步数据并跟踪用户在离线时所做的更改。JSONStore 上可以保存多少信息有限制吗？我发现 Webkit 数据库有 5 MB 的限制，而 SQLLite 数据库没有限制。还想知道 JSONStore 在哪里使用 WebKit 数据库或 SQLLite 来存储其底层信息

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-28T15:04:03.877

JSONStore 最终将信息存储在文件系统上。唯一的限制是设备上剩余的空间或设备操作系统施加的任何文件大小限制。我们已经轻松创建了磁盘上数百 MB 的 JSONStore 实例。

# sql - 将列动态添加到 sql server 的临时表中

> ID：15137436
> 
> 赞同：1
> 
> 时间：2013-02-28T14:02:36.123
> 
> 标签：sql, sql-server-2008

我从一个 xml 文件将数据添加到一个临时表中..代码如下..

```
SELECT * INTO #TempBusinessUnitFacility FROM OPENXML(@iBusinessUnitFacilityLinkTree, 'BusinessUnits/BusinessUnit', 1)  
    WITH (BU_Facility_LinkClientCode INT 'BU_Facility_LinkClientCode',BU_Code INT 'BU_Code',Facility_Code INT 'Facility_Code') 
```

假设我有近 10 行，我想做 while 循环并逐行将临时表中的值插入到其他表中。问题是我没有标识列或行号。如果我可以添加行号为一个标识列，然后我可以轻松地进行操作。如何在此临时表中添加一列作为标识。

我可以创建一个临时表添加列并从 xml 向其中插入值。但这不是我的方案。我的上述方案是否有任何选项。任何人都可以解决它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T14:05:47.727

好吧，你可以这样做：

```
selet row_number() over (order by (select NULL)) as id,
      *
INTO #TempBusinessUnitFacility FROM OPENXML(@iBusinessUnitFacilityLinkTree, 'BusinessUnits/BusinessUnit', 1)  
WITH (BU_Facility_LinkClientCode INT 'BU_Facility_LinkClientCode',BU_Code INT 'BU_Code',Facility_Code INT 'Facility_Code') 
```

这用于`row_number()`分配 id。

# tomcat - tomcat kerberos认证+ldap授权

> ID：15137437
> 
> 赞同：2
> 
> 时间：2013-02-28T14:02:38.527
> 
> 标签：tomcat, ldap, kerberos

我们使用 LDAP 在 tomcat 服务器上对用户进行身份验证**和**授权，但现在需要从 LDAP 中删除密码并切换到 kerberos 身份验证。

现在我们想**使用 kerberos**对用户进行**身份验证**（工作已经很好），并且在成功时，从**LDAP** DB中**检索**登录用户的分配**角色。**

 ******我天真的希望是使用例如简单的自制领域和/或 WSDL 安全约束/角色机制来 a) 使用 JAAS 领域进行身份验证并成功 b) 传递到 JNDI 领域以从 LDAP 检索角色经过身份验证的用户的数据库。

我可以为一些需要的步骤找到很多片段（检索角色、简单的自制领域……），但不容易遵循示例，我仍然不确定这种方法是否合适（尤其是因为我很漂亮本主题的新手！）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2018-07-06T11:43:03.157

只是为了总结这个线程。找到了一个名为**ldaptive**的不错的解决方案（请参阅[http://www.ldaptive.org/](http://www.ldaptive.org/)）。在这里我可以准确地指定 kerberos 登录模块 (com.sun.security.auth.module.Krb5LoginModule) 和 LDAP 进行授权 (org.ldaptive.jaas.LdapRoleAuthorizationModule)。我们现在使用这个模块已经运行了很长时间，它简直完美无缺！******

# android - Android：如何确保在调用另一个方法之前终止 AsyncTask？

> ID：15137440
> 
> 赞同：3
> 
> 时间：2013-02-28T14:02:57.403
> 
> 标签：android, android-asynctask

情况很简单。我使用 AsyncTask 从 HttpClient 检索字符串。

现在我需要 AsyncTask 检索到的字符串来调用该字符串上的另一个方法，

因此我需要确保 AsyncTask 在调用其他方法之前已经终止。

我该怎么做呢？

感谢您的任何建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T14:09:03.123

使用简单的锁或互斥锁。基本上，在你的 : 添加一个变量和一个吸气剂`AsyncTask`：

```
public boolean locked;

public boolean isLocked(){
    return locked;
} 
```

在你`AsyncTask`的`onPreExecute`方法中，添加：

```
locked = true; 
```

并在`onPostExecute`方法中添加：

```
locked = false; 
```

然后可以将任何外部方法放入循环中，例如：

```
MyTask foo = new MyTask();
foo.execute();
while (foo.isLocked())
{
    //wait, or sleep, or whatever
}
//here is where you execute code. 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T14:47:14.567

我怀疑您实际上并不关心它是否已“终止”。我怀疑你只是关心它的 doInBackground 方法是否已经完成。最简单的答案是，如果 onPostExecute 或 onCancelled 已被调用，则 doInBackground 已完成。如果您需要更精细的东西，则必须执行 Phil 描述的操作：

```
private volatile boolean done;

//...

public boolean isDone() { return done; }

protected Result doInBackground(Params... params) {
    // ...
    done = true;
    return result;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-28T14:06:45.057

只需检查是否已调用[onPostExecute()](http://developer.android.com/reference/android/os/AsyncTask.html#onPostExecute%28Result%29)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-28T14:22:54.713

你想做什么...请记住，如果主线程被阻塞 5 秒，用户会收到一个提示，询问用户是否要等待更长时间或退出应用程序。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-28T14:12:15.520

如果您绝对需要该值，您甚至可能想尝试启动一个新线程（而不是 AsyncTask 执行）并使用 .join 方法等待它退出。

它通常不受欢迎（您不应该以这种方式访问​​ http 资源；您可能会遇到应用程序无响应的风险），但它与其他建议的解决方案没有显着不同。

# android - 将套接字连接到设备上的本地地址

> ID：15137447
> 
> 赞同：5
> 
> 时间：2013-02-28T14:03:13.583
> 
> 标签：android, sockets, localhost

我现在在这个问题上闲逛了一段时间。我通过接收端的套接字将数据从设备发送到设备我必须将此数据从套接字发送到设备本身。`localhost/127.0.0.1/10.0.0.2`或 WiFi 地址不起作用。

如何将数据从套接字发送到`localhost:port`设备？

```
try
{
    Socket socket = new Socket(InetAddress.getLocalHost(), 1500);
    InputStream is = s.getInputStream();
    OutputStream os = socket.getOutputStream();
    int bufferSize = 1024;
    byte[] buffer = new byte[bufferSize];
    int len = 0;
    while ((len = is.read(buffer)) > 0)
    {
        if(is.available() > 1024){
            os.write(buffer);
        Log.i(TAG, "localSocket writing: " + buffer.length);
        }

        try
        {
            Thread.sleep(100);
        }
        catch (InterruptedException e)
        {
            Log.e(TAG, "LocalSocketThread" + e.toString());
        }
    }
} 
```

和我的清单权限：

```
<uses-permission android:name="android.permission.INTERNET" /> 
<uses-permission android:name="android.permission.CAMERA" /> 
<uses-permission android:name="android.permission.STORAGE" /> 
<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" /> 
<uses-permission android:name="android.permission.ACCESS_WIFI_STATE"/> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-06-20T13:08:36.307

尝试将 null 发送到地址字段：

```
Socket socket = new Socket(null, 1500); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-05-14T09:44:06.233

看到你的代码，因为它是写的，没有意义，你从套接字读取并立即测试可用（）。您只是从中读取，所以很可能它会返回 0。

```
while ((len = is.read(buffer)) > 0)
{
   // this is what makes no sense
   if (is.available() > 1024) os.write(buffer);
   // what you probably want to do is
   //  Even this test is not necessary because you already test in the while loop
   if (len > 0) 
   {
      os.write(buffer, 0, len);
      Log.i(TAG, "localSocket writing: " + len);
   } 
```

# c# - C# 控制台应用程序 - 如何使用 GDI+ 在 BMP/JPG 文件中绘图？

> ID：15137449
> 
> 赞同：3
> 
> 时间：2013-02-28T14:03:17.060
> 
> 标签：c#, jpeg, console-application, gdi+, bmp

我想使用 C# 控制台应用程序和 GDI+ 在 BMP 或 JPG 文件中绘制矩形、箭头、文本、线条等形状。这是我在网上找到的：

c# 将 System.Drawing.Graphics 保存到文件[c# 将 System.Drawing.Graphics 保存到文件](https://stackoverflow.com/questions/11621726/c-sharp-save-system-drawing-graphics-to-file) GDI+ 初学者教程[http://www.c-sharpcorner.com/UploadFile/mahesh/gdi_plus12092005070041AM/gdi_plus.aspx](http://www.c-sharpcorner.com/UploadFile/mahesh/gdi_plus12092005070041AM/gdi_plus.aspx) Professional C# - Graphics with GDI+ codeproject .com/Articles/1355/Professional-C-Graphics-with-GDI

但这仍然对我没有帮助。其中一些链接仅针对 Windows 窗体应用程序解释这一点，而其他链接仅供参考（MSDN 链接），仅解释 GDI+ 中的类、方法等。那么如何使用 C# 控制台应用程序绘制图片文件呢？谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-28T14:13:58.297

It is pretty straight-forward to create bitmaps in a console mode app. Just one minor stumbling block, the project template doesn't preselect the .NET assembly you need. Project + Add Reference, select System.Drawing

A very simple example program:

```
using System;
using System.Drawing;   // NOTE: add reference!!

class Program {
    static void Main(string[] args) {
        using (var bmp = new Bitmap(100, 100))
        using (var gr = Graphics.FromImage(bmp)) {
            gr.FillRectangle(Brushes.Orange, new Rectangle(0, 0, bmp.Width, bmp.Height));
            var path = System.IO.Path.Combine(
                Environment.GetFolderPath(Environment.SpecialFolder.Desktop),
                "Example.png");
            bmp.Save(path);
        }
    }
} 
```

After you run this you'll have a new bitmap on your desktop. It is orange. Get creative with the Graphics methods to make it look the way you want.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-28T14:09:22.807

*   添加对*程序集的引用：System.Drawing（在 System.Drawing.dll 中）*。
*   添加使用：*命名空间：System.Drawing*。
*   创建一个空的[Bitmap](http://msdn.microsoft.com/en-us/library/system.drawing.bitmap.aspx)，例如`var bitmap = new Bitmap(width, height);`
*   为该[Bitmap](http://msdn.microsoft.com/en-us/library/system.drawing.bitmap.aspx)创建[Graphics](http://msdn.microsoft.com/en-us/library/system.drawing.graphics.aspx)对象：`var graphics = Graphics.FromImage(bitmap);`
*   使用图形对象方法在位图上绘制，例如`graphics.DrawRectangle(Pens.Black, 0, 0, 10, 10)`；
*   将图像另存为文件：`bitmap.Save("MyShapes.png");`

# javascript - 控制父容器中的子容器滚动条

> ID：15137452
> 
> 赞同：1
> 
> 时间：2013-02-28T14:03:29.310
> 
> 标签：javascript, jquery, css

**设想：**

我有一个包含表头的父 div 和一个包含表数据的子 div。

**目标：**

我希望能够水平滚动，从左到右滚动所有内容，如果表格数据垂直溢出，我希望能够垂直滚动并查看标题。

**问题：**

如果表格数据垂直溢出并且宽度超过父容器，除非我滚动，否则我看不到垂直滚动条，因此标题。

我在这里设置了一个示例：http: [//jsfiddle.net/uRHkU/2/](http://jsfiddle.net/uRHkU/2/) - 我想要实现的目标是什么？

```
<div class="parentDiv">
    <p>very very very long header</p>
    <div class="childDiv">
        <p>content that stretches the full width</p>
        <p>content that stretches the full width</p>
        <p>content that stretches the full width</p>
        <p>content that stretches the full width</p>
        <p>content that stretches the full width</p>
        <p>content that stretches the full width</p>
        <p>content that stretches the full width</p>
        <p>content that stretches the full width</p>
        <p>content that stretches the full width</p>
        <p>content that stretches the full width</p>
    </div>
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T14:31:33.293

您至少有 2 种方法来获得水平滚动请记住，您的段落元素正在溢出！

**替代 1** 使用

```
.parentDiv
{
    width: 500px;
    height: 300px;
    overflow:auto;

}
.parentDiv p {
    display:inline;
} 
```

您将获得所有集合的滚动条

**备选方案 2**

```
.parentDiv
{
    width: 500px;
    height: 300px;

}
.parentDiv p {

    overflow:auto;
} 
```

在这里你会得到一个段落的滚动条

*编辑评论：您可以省略段落的内联规则。就像在这个小提琴中一样。我希望它是你要找的。* Fiddle here [Child scrollbar Alternative 1](http://jsfiddle.net/Fico/fAnE8/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T14:06:33.967

尝试`overflow: auto`“parentDiv”并删除所有溢出-xy-Stuff。

# python - distutils 创建一个 .egg-info 目录

> ID：15137453
> 
> 赞同：2
> 
> 时间：2013-02-28T14:03:29.527
> 
> 标签：python

出于某种原因，使用

```
python setup.py sdist 
```

每当我运行它时就开始创建一个名为 .egg-info 的文件夹。

这在以前没有发生过。这个文件是什么？我怎样才能禁用它？

# objective-c - 禁用 ccTouche

> ID：15137456
> 
> 赞同：1
> 
> 时间：2013-02-28T14:03:37.613
> 
> 标签：objective-c, cocos2d-iphone

我在我的图层中设置触摸启用：

```
[[[CCDirector sharedDirector]touchDispatcher] addTargetedDelegate:self priority:0 swallowsTouches:YES]; 
```

稍后如果我想禁用触摸： `self.isTouchEnabled=NO;`它不起作用。如果我试图禁用它：

```
[[[CCDirector sharedDirector]touchDispatcher] addTargetedDelegate:self priority:0 swallowsTouches:NO]; 
```

没关系，但是如果我用**相同的语法**再次启用它，我会崩溃，代表已经添加了......

如何动态禁用和启用触摸？

谢谢 。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T14:37:39.940

如果真的是 CCLayer 对象，使用 isTouchEnabled 即可。CCLayer 对象将相应地添加/删除自己作为目标触摸委托。所以整个问题是'你所说的'不工作'是什么意思。例如，如果您的图层（禁用触摸）包含菜单，菜单仍将处于活动状态，并且它们具有非常高的触摸优先级，即响应触摸的不是图层，而是其嵌入的菜单。

直接来自 CCLayer 的代码（2.0 版）：

```
-(void) setIsTouchEnabled:(BOOL)enabled
{
    if( isTouchEnabled_ != enabled ) {
        isTouchEnabled_ = enabled;
        if( isRunning_ ) {
            if( enabled )
                [self registerWithTouchDispatcher];
            else {
                CCDirector *director = [CCDirector sharedDirector];
                [[director touchDispatcher] removeDelegate:self];
            }
        }
    }
}

-(void) registerWithTouchDispatcher
{
    CCDirector *director = [CCDirector sharedDirector];
    [[director touchDispatcher] addStandardDelegate:self priority:0];
} 
```

如您所见，基本的 CCLayer 代码已经实现了您尝试手动执行的操作。只需使用该属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T15:11:57.203

cc 触摸调度程序和 self.istouchenabled 是检测触摸的两种不同方法。我现在不在电脑前，我不记得确切的代码。我即将登上国际航班，因此如果您愿意等待一天左右，我将使用正确的方法更新此内容以删除 cctouch 调度程序。如果您不想等待，我建议您查看 cocos2d 文档。我敢肯定它会告诉你

# r - 有效地生成离散随机数

> ID：15137459
> 
> 赞同：3
> 
> 时间：2013-02-28T14:03:52.077
> 
> 标签：r, random, memory-efficient

我想在已知 CDF 的情况下快速生成离散随机数。本质上，该算法是：

1.  构造 CDF 向量（从 0 开始到 1 结束的递增向量）`cdf`
2.  生成一个 uniform(0, 1) 随机数`u`
    *   如果`u < cdf[1]`选1
    *   否则如果`u < cdf[2]`选择2
    *   否则，如果`u < cdf[3]`选择 3 *...

**例子**

首先生成一个cdf：

```
cdf = cumsum(runif(10000, 0, 0.1))
cdf = cdf/max(cdf) 
```

接下来生成`N`统一的随机数：

```
N = 1000
u = runif(N) 
```

现在对值进行采样：

```
##With some experimenting this seemed to be very quick
##However, with N = 100000 we run out of memory
##N = 10^6 would be a reasonable maximum to cope with
colSums(sapply(u, ">", cdf)) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-28T14:19:52.927

如果您知道概率质量函数（如果您知道累积分布函数，您会这样做），您可以使用 R 的内置`sample`函数，您可以在其中使用参数定义离散事件的概率`prob`。

```
cdf = cumsum(runif(10000, 0, 0.1))
cdf = cdf/max(cdf)

system.time(sample(size=1e6,x=1:10000,prob=c(cdf[1],diff(cdf)),replace=TRUE))
   user  system elapsed 
   0.01    0.00    0.02 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-28T14:42:11.630

如何使用`cut`：

```
N <- 1e6
u <- runif(N)
system.time(as.numeric(cut(u,cdf)))
   user  system elapsed 
   1.03    0.03    1.07 

head(table(as.numeric(cut(u,cdf))))

  1   2   3   4   5   6 
 51  95 165 172 148  75 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-01T01:34:25.740

如果您有有限数量的可能值，那么您可以使用@Hemmo 提到的`findInterval`or`cut`或更好的值。`sample`

但是，如果您想从理论上达到无穷大的分布（如几何、负二项式、泊松等）生成数据，那么这里有一个可行的算法（这也适用于有限数量的值，如果通缉）：

从您的统一值向量开始，循环遍历从统一向量中减去它们的分布值，随机值是值变为负数的迭代。这是一个更容易看到的例子。这会从平均值为 5 的 Poisson 生成值（将`dpois`调用替换为您的计算值），并将其与使用逆 CDF 进行比较（在这种情况下它存在的情况下更有效）。

```
i <- 0
tmp <- tmp2 <- runif(10000)
randvals <- rep(0, length(tmp) )

while( any(tmp > 0) ) {
    tmp <- tmp - dpois(i, 5)
    randvals <- randvals + (tmp > 0)
    i <- i + 1
}

randvals2 <- qpois( tmp2, 5 )

all.equal(randvals, randvals2) 
```

# sql-server - Java.lang.ClassCastException：java.util.Date 不能转换为 java.sql.Timestamp

> ID：15137460
> 
> 赞同：4
> 
> 时间：2013-02-28T14:03:58.930
> 
> 标签：sql-server, jasper-reports, jasperserver

我有一个`jrxml`文件。当我在 中运行该文件时`IReport Designer 4.8.0`，会生成报告而不会失败。但是当我在中部署相同的文件时`JasperServer 5.0.0`，它会引发异常。

```
The server has encountered an error. Please excuse the inconvenience.
Error Message

java.lang.ClassCastException: java.util.Date cannot be cast to java.sql.Timestamp
Error Trace

java.lang.ClassCastException: java.util.Date cannot be cast to java.sql.Timestamp at     net.sf.jasperreports.engine.query.JRJdbcQueryExecuter.setTimestamp(JRJdbcQueryExecuter.java:605) at
net.sf.jasperreports.engine.query.JRJdbcQueryExecuter.setStatementParameter(JRJdbcQueryExecuter.java:569) at
net.sf.jasperreports.engine.query.JRJdbcQueryExecuter.setStatementParameter(JRJdbcQueryExecuter.java:399) at
net.sf.jasperreports.engine.query.JRJdbcQueryExecuter$1.visit(JRJdbcQueryExecuter.java:332) at     net.sf.jasperreports.engine.query.JRAbstractQueryExecuter$QueryParameter.accept(JRAbstractQueryExecuter.java:157) at     net.sf.jasperreports.engine.query.JRAbstractQueryExecuter.visitQueryParameters(JRAbstractQueryExecuter.java:646) at     net.sf.jasperreports.engine.query.JRJdbcQueryExecuter.createStatement(JRJdbcQueryExecuter.java:317) at     net.sf.jasperreports.engine.query.JRJdbcQueryExecuter.createDatasource(JRJdbcQueryExecuter.java:196) at     com.jaspersoft.jasperserver.api.engine.jasperreports.util.JRTimezoneJdbcQueryExecuter.createDatasource(JRTimezoneJdbcQueryExecuter.java:168) at     net.sf.jasperreports.engine.fill.JRFillDataset.createQueryDatasource(JRFillDataset.java:1086) at
net.sf.jasperreports.engine.fill.JRFillDataset.initDatasource(JRFillDataset.java:667) at net.sf.jasperreports.engine.fill.JRBaseFiller.setParameters(JRBaseFiller.java:1258) at     net.sf.jasperreports.engine.fill.JRBaseFiller.fill(JRBaseFiller.java:877) at
net.sf.jasperreports.engine.fill.BaseFillHandle$ReportFiller.run(BaseFillHandle.java:120) at     com.jaspersoft.jasperserver.api.engine.jasperreports.service.impl.EngineServiceImpl$SynchronousExecutor.execute(EngineServiceImpl.java:859) at     net.sf.jasperreports.engine.fill.BaseFillHandle.startFill(BaseFillHandle.java:165) at     com.jaspersoft.jasperserver.api.engine.jasperreports.service.impl.EngineServiceImpl$AsynchronousReportFiller.fillReport(EngineServiceImpl.java:821) at     com.jaspersoft.jasperserver.api.engine.jasperreports.service.impl.EngineServiceImpl.fillReport(EngineServiceImpl.java:1622) at     com.jaspersoft.jasperserver.api.engine.jasperreports.service.impl.EngineServiceImpl$ReportFill.runReport(EngineServiceImpl.java:1005) at      com.jaspersoft.jasperserver.api.engine.jasperreports.service.impl.EngineServiceImpl$ReportRunnable.run(EngineServiceImpl.java:881) at     java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886) at     java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908) at     java.lang.Thread.run(Thread.java:619) 
```

，`parameter`我正在传递，并且`querystring`在`jrxml`文件中是

```
<parameter name="EndDate" isForPrompting="true" class="java.sql.Timestamp">
    <defaultValueExpression ><![CDATA[new Date(System.currentTimeMillis())]]></defaultValueExpression>
</parameter>
<queryString><![CDATA[declare @startdate as datetime;
declare @enddate as datetime;
declare @sitegroup as nvarchar(50);
set @startdate = $P{EndDate}-1;
set @enddate = $P{EndDate};
set @sitegroup = 'BBXNCR';
set NOCOUNT ON; -- Added by JC230090: Fixes bug when running query with Jasper

IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo]. [#temp_invlines]') AND type in (N'U'))
DROP TABLE [dbo].[#temp_invlines]
create table #temp_invlines (site_iid uniqueidentifier, invoice_line_type_iid int,   sub_total float, tax_total float,line_total float, product_type_iid int);
insert into #temp_invlines (site_iid,invoice_line_type_iid, sub_total, tax_total,   line_total, product_type_iid)
select h.site_iid, invoice_line_type_iid, l.sub_total, l.tax_total, l.line_total, l.product_type_iid
from invoice_lines l
    inner join invoices h on l.invoice_iid = h.invoice_iid
where h.invoice_dt >= @startdate and h.invoice_dt < @enddate

IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[#temp_payment_invoices]') AND type in (N'U'))
DROP TABLE [dbo].[#temp_payment_invoices]
create table #temp_payment_invoices (site_iid uniqueidentifier, inv_amount float);
insert into #temp_payment_invoices (site_iid, inv_amount)
select i.site_iid, i.total
from invoice_payments p
    inner join Invoice_Payment_Invoice_Xref pXref on p.invoice_payment_iid = pXref.invoice_payment_iid
    inner join invoices i on pXref.invoice_iid = i.invoice_iid
where p.payment_dt >= @startdate and p.payment_dt < @enddate

 IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[#temp_promocodes]') AND type in (N'U'))
 DROP TABLE [dbo].[#temp_promocodes]
 create table #temp_promocodes (site_iid uniqueidentifier, invoice_promo_line_type_iid int, promo_amount float);
 insert into #temp_promocodes (site_iid, invoice_promo_line_type_iid, promo_amount)
select h.site_iid, pl.invoice_promo_line_type_iid, pl.amount
from invoice_promo_lines pl
inner join invoices h on pl.invoice_iid = h.invoice_iid
where h.invoice_dt >= @startdate and h.invoice_dt < @enddate

select 
rtrim(s.site_id) as [Site ID]
, rtrim(ss.Description) as [Status]
, @startdate as [Date]
, datename(dw,@startdate) as [DoW]
, rtrim(s.name) as [Store Code]
, rtrim(isnull(sg.Description,'')) as [Site Group]
, rtrim(s.address1) + ', ' + rtrim(s.city) + ', ' + rtrim(s.state) + ' ' + rtrim(s.Zip)    as [Address]
, rtrim(pg.description) as [RentPriceGroup]

, (select count(*) from invoices h where h.invoice_dt >= @startdate and h.invoice_dt < @enddate and h.site_iid = s.site_iid) as [Trans]
, (select isnull(sum(sub_total),0) from #temp_invlines l where l.site_iid = s.site_iid and l.invoice_line_type_iid = 1) as [Rent Rev]
, (select isnull(sum(sub_total),0) from #temp_invlines l where l.site_iid = s.site_iid and l.invoice_line_type_iid = 2) as [Ext Day Rev]
, (select isnull(sum(sub_total),0) from #temp_invlines l where l.site_iid = s.site_iid and l.invoice_line_type_iid = 0 and l.product_type_iid = 2) as [Used Sell Rev]
, (select isnull(sum(sub_total),0) from #temp_invlines l where l.site_iid = s.site_iid and l.invoice_line_type_iid = 0 and l.product_type_iid <> 2) as [New Sell Rev]
, (select isnull(sum(sub_total),0) from #temp_invlines l where l.site_iid = s.site_iid) as [Rev Total]
, (select isnull(sum(tax_total),0) from #temp_invlines l where l.site_iid = s.site_iid) as [Tax Total]
, (select isnull(sum(line_total),0) from #temp_invlines l where l.site_iid = s.site_iid) as [Grand Total]
, (select isnull(sum(sub_total),0) from #temp_invlines l where l.site_iid = s.site_iid)    /
(select case when count(*) = 0 then 1 else count(*) end from invoices h where h.invoice_dt >= @startdate and h.invoice_dt < @enddate and h.site_iid = s.site_iid)
as [Rev/Trans]
, (select isnull(count(sub_total),0) from #temp_invlines l where l.site_iid = s.site_iid and l.invoice_line_type_iid = 1) as [Rent Cnt]
, (select isnull(count(sub_total),0) from #temp_invlines l where l.site_iid = s.site_iid and l.invoice_line_type_iid = 2) as [Ext Day Cnt]
, (select isnull(count(sub_total),0) from #temp_invlines l where l.site_iid = s.site_iid and l.invoice_line_type_iid = 0 and l.product_type_iid = 2) as [Used Sell Cnt]
, (select isnull(count(sub_total),0) from #temp_invlines l where l.site_iid = s.site_iid and l.invoice_line_type_iid = 0 and l.product_type_iid <> 2) as [New Sell Cnt]
, (select isnull(count(promo_amount),0) from #temp_promocodes p where p.site_iid = s.site_iid and p.invoice_promo_line_type_iid = 0) as [CustSrv Promo Cnt]
, (select isnull(sum(promo_amount),0) from #temp_promocodes p where p.site_iid = s.site_iid and p.invoice_promo_line_type_iid = 0) as [CustSrv Promo Amt]
, (select isnull(count(promo_amount),0) from #temp_promocodes p where p.site_iid = s.site_iid and p.invoice_promo_line_type_iid = 1) as [Marketing Promo Cnt]
, (select isnull(sum(promo_amount),0) from #temp_promocodes p where p.site_iid = s.site_iid and p.invoice_promo_line_type_iid = 1) as [Marketing Promo Amt]

, (SELECT  
    isnull(count(*),0)
FROM Invoice_Lines ilrtn 
    INNER JOIN Invoices ihrtn on ilrtn.invoice_iid = ihrtn.invoice_iid 
    inner join customer_ids c on ihrtn.customer_id_iid = c.customer_id_iid
    INNER JOIN Invoices ihrent on ihrtn.customer_id_iid = ihrent.customer_id_iid  
    INNER JOIN Invoice_lines ilrent on ihrent.invoice_iid = ilrent.invoice_iid 
WHERE ihrtn.invoice_dt >= @startdate
    and ihrtn.invoice_dt < @enddate
    and ilrtn.invoice_line_type_iid in (0,2)
    AND ihrent.invoice_dt <= ihrtn.invoice_dt 
    AND ilrent.invoice_line_type_iid in (1) 
    AND ilrent.piece_id = ilrtn.piece_id 
    and ihrtn.site_iid = s.site_iid 
) as [Invoices]

, (SELECT  
    isnull(sum(ilrent.line_total + ilrtn.line_total),0)
FROM Invoice_Lines ilrtn 
    INNER JOIN Invoices ihrtn on ilrtn.invoice_iid = ihrtn.invoice_iid 
    inner join customer_ids c on ihrtn.customer_id_iid = c.customer_id_iid
    INNER JOIN Invoices ihrent on ihrtn.customer_id_iid = ihrent.customer_id_iid  
    INNER JOIN Invoice_lines ilrent on ihrent.invoice_iid = ilrent.invoice_iid 
WHERE ihrtn.invoice_dt >= @startdate
    and ihrtn.invoice_dt < @enddate
    and ilrtn.invoice_line_type_iid in (0,2)
    AND ihrent.invoice_dt <= ihrtn.invoice_dt 
    AND ilrent.invoice_line_type_iid in (1) 
    AND ilrent.piece_id = ilrtn.piece_id 
    and ihrtn.site_iid = s.site_iid 
) as [Collectable]

, ( select isnull(sum(p.amount),0)
from invoice_payments p
where p.payment_dt >= @startdate and p.payment_dt < @enddate
and p.invoice_payment_iid in (
    select distinct p.invoice_payment_iid
    from invoice_payments p
    inner join Invoice_Payment_Invoice_Xref pXref on p.invoice_payment_iid = pXref.invoice_payment_iid
    inner join invoices i on pXref.invoice_iid = i.invoice_iid
    where p.payment_dt >= @startdate and p.payment_dt < @enddate
    and i.site_iid = s.site_iid
    group by p.invoice_payment_iid, pXref.invoice_iid)
) as [Payments Collected]
from sites s
inner join Site_Statuses_Enum ss on s.site_status_iid = ss.site_status_iid
inner join Site_Rent_Price_Groups as pg on s.site_rent_price_group_iid =     pg.site_rent_price_group_iid
left outer join Site_SiteGroup_XRef sgx on s.site_iid = sgx.site_iid
left outer join Site_Groups sg on sgx.site_group_iid = sg.site_group_iid
where sg.Description in (@sitegroup) or sg.Description is null
order by s.site_id

drop table #temp_promocodes
drop table #temp_payment_invoices
drop table #temp_invlines;]]></queryString> 
```

请帮我...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-01T10:51:41.130

将参数默认值表达式更改为以下

`new java.sql.Timestamp(System.currentTimeMillis())`

# linux - sudo bang bang 到底是什么？

> ID：15137461
> 
> 赞同：85
> 
> 时间：2013-02-28T14:04:04.213
> 
> 标签：linux, bash, terminal, sh

sudo bang bang ( ) 的目的是什么，什么`sudo !!`时候需要使用它？

[![给我做个三明治，sudo bang bang](../Images/65e2586406761b4afbb9b4cfcf857468.png)](http://justinsomnia.org/2006/09/sudo-bang-bang/)

* * *

## 回答 #1

> 赞同：123
> 
> 时间：2013-02-28T14:04:04.213

bang bang( ) 命令是**重复您在终端中输入的上一个命令**`!!`的快捷方式。当您忘记需要管理员权限来执行某个操作时，此命令非常有用，并且只需键入即可让您以超级用户权限重复它

 **```
sudo !! 
```

而不是键入向上箭头，滚动到行首，添加`sudo` 并按 Enter（想象滚动浏览那些*loooong* `apt-get`命令）。获得了这么多秒！*耶！*

[![须藤棒棒糖](../Images/0b5700cd8017393578680c56f00611bd.png)](http://blog.alestanis.com/2013/02/27/the-bang-bang-command/)

还有许多其他的 bang 命令，例如`!x`,和. 这篇[博文](http://web.archive.org/web/20130731111822/https://craig-russell.co.uk/2011/09/28/bang-bang-command-recall-in-linux.html)列出了它们并解释了它们的用途。`!?x``!!:p``!!*`**

# jboss - 类似于 Quartz Jboss 注解

> ID：15137463
> 
> 赞同：1
> 
> 时间：2013-02-28T14:04:12.573
> 
> 标签：jboss, jboss7.x, quartz-scheduler

有人告诉我，JBoss Application Server 中有一些注解可以做与 Quartz 类似的工作。这些注释是什么？他们比石英好吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T23:32:40.793

这篇博文列出了 JBoss 中可用的选项：http: [//anilsaldhana.blogspot.com/2011/05/scheduler-jobs-in-jboss-as.html](http://anilsaldhana.blogspot.com/2011/05/scheduler-jobs-in-jboss-as.html)

总结一下：

1.  石英调度器：

    *   [http://docs.jboss.org/ejb3/docs/tutorial/1.0.7/html/Quartz_scheduler_integration.html](http://docs.jboss.org/ejb3/docs/tutorial/1.0.7/html/Quartz_scheduler_integration.html)
    *   [http://community.jboss.org/wiki/HowtoconfigureaQuartzservice](http://community.jboss.org/wiki/HowtoconfigureaQuartzservice)
2.  java.util.Timer：

    *   您将需要在应用程序中创建自己的计时器任务实例。
3.  JBoss 调度程序：

    *   [http://docs.jboss.org/jbossas/docs/Server_Configuration_Guide/4/html/Additional_Services-Scheduling_Tasks.html](http://docs.jboss.org/jbossas/docs/Server_Configuration_Guide/4/html/Additional_Services-Scheduling_Tasks.html)
    *   [http://docs.jboss.org/jbossas/docs/Server_Configuration_Guide/4/html/index.html](http://docs.jboss.org/jbossas/docs/Server_Configuration_Guide/4/html/index.html)的第 10.7 和 10.8 节

# c# - 在运行时更改 appconfig

> ID：15137464
> 
> 赞同：3
> 
> 时间：2013-02-28T14:04:15.657
> 
> 标签：c#, winforms

我正在尝试使用以下代码在运行时更新 appconfig 文件。我没有收到错误，但它没有更新我的配置文件。

```
System.Configuration.Configuration config =
    ConfigurationManager.OpenExeConfiguration(ConfigurationUserLevel.None);
string oldValue = config.AppSettings.Settings["Username"].Value;
config.AppSettings.Settings["Username"].Value = "NewValue";
config.Save(ConfigurationSaveMode.Modified);
ConfigurationManager.RefreshSection("appSettings"); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-05-24T15:19:37.320

添加`config.AppSettings.SectionInformation.ForceSave = true;`意志就可以了。`YourProject.vshost.exe.config`正如贾斯汀所说，您应该在调试时查看。修改保存在那里。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-01T23:30:52.520

只要您对 app.config 文件具有写入权限，以下内容就应该可以工作。

```
// To Save
System.Configuration.Configuration config = ConfigurationManager.OpenExeConfiguration(ConfigurationUserLevel.None);
config.AppSettings.Settings["Username"].Value = "NewValue";
config.AppSettings.SectionInformation.ForceSave = true;
config.Save(ConfigurationSaveMode.Modified);

// To Refresh
ConfigurationManager.RefreshSection("appSettings");
System.Configuration.Configuration config = ConfigurationManager.OpenExeConfiguration(ConfigurationUserLevel.None); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-05-24T17:12:07.897

您无法更新配置。您必须将其删除，然后再次添加。这对我有用，包括在通过 Visual Studio 进行调试时：

```
config.AppSettings.Settings.Remove("Username");
config.AppSettings.Settings.Add("Username", "NewValue");
config.Save(ConfigurationSaveMode.Modified); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-28T15:02:06.540

当我需要更新我的配置时，我总是必须使用：

```
config.AppSettings.SectionInformation.ForceSave = true;
//Save config
//Refresh Config section 
```

否则它不会为我更新配置文件。

另外，您是否在 Visual Studio 中运行它？如果您从 Visual Studio 进行调试，它会在 bin 文件夹中创建副本，因此在您的实际项目中，除非您查看 bin\debug 文件夹中的配置文件，否则您不会看到对配置的任何更改。

# css - LESS CSS：重用生成的 .@{name} 类作为 mixin

> ID：15137465
> 
> 赞同：7
> 
> 时间：2013-02-28T14:04:18.650
> 
> 标签：css, less, mixins

我正在使用 LESS CSS 1.3.3。对不起，如果这个问题已经被问过，我在网上没有找到任何相关的东西。

我有几个看起来像这样的类生成器（示例非常简化，足以触发错误）：

```
#genMarginTop (@name, @size) {
    .@{name} { margin-top: @size; }
} 
```

然后我用它们来生成一些实际的类：

```
#genMarginTop(mtStandard, 40px);
#genMarginTop(mtHalf, 20px); 
```

到目前为止，一切都很好，LESS 正确地生成了这些类，我可以在 HTML 中使用它们。但是，当我想在其他地方重用这样一个生成的类作为 mixin 时，我得到一个错误：

```
.someClass {
    .mtStandard; // won't work, see error below
    // more stuff
} 
```

我得到的错误是：

```
NameError: .mtStandard is undefined in /.../example.less:161:4
160 .someClass {
161     .mtStandard;
162     // more stuff 
```

当然，我会在生成类*之后*尝试使用 mixin 。*看起来*LESS在生成它们之后不会在内部注册这些生成的类，但我很可能是错的。

**有没有办法在其他类中重用这些生成的类作为 mixins？**作为 LESS 的新手，他们的文档对生成的类相当稀疏，我完全不知所措（特别是因为这是 mixins 似乎接受的唯一语法）。

谢谢你读我。

* * *

**注意：**我使用此类生成器的原因是因为它们比上面的示例复杂得多（认为嵌套类都依赖于一组公共参数），并且我将生成的类嵌入到各种`@media`查询中以支持任何设备类型以“禅”的方式。最后我得到类似的东西：

```
@media (max-width: 1024px) {
    #genSomething(something, somethingParam1, ...);
    #genSomething(somethingElse, somethingElseParam1, ...);
    #genStuff(stuff, stuffParam1, ...);
}
@media (max-width: 240px) {
    #genSomething(something, somethingParam2, ...);
    #genSomething(somethingElse, somethingElseParam2, ...);
    #genStuff(stuff, stuffParam2, ...);
}
// etc 
```

* * *

# 解决方案/测试用例

这是@MartinTurjak 解决方案的测试用例，我可以确认它按预期工作，嵌套类和所有内容：

```
.explicit {
  margin-top: 1;
  input { margin-top: 1; }
}
.reuseExplicit {
  .explicit;
  margin-bottom: 1;
}
#generator (@arg) {
  margin-top: @arg;
  input {
    margin-top: @arg;
  }
}
.generated { #generator(1); }
.reuseGenerated {
  .generated;
  margin-bottom: 1;
} 
```

哪个正确生成：（注意显式/生成如何产生完全相同的结果）

```
.explicit {
  margin-top: 1;
}
.explicit input {
  margin-top: 1;
}
.reuseExplicit {
  margin-top: 1;
  margin-bottom: 1;
}
.reuseExplicit input {
  margin-top: 1;
}
.generated {
  margin-top: 1;
}
.generated input {
  margin-top: 1;
}
.reuseGenerated {
  margin-top: 1;
  margin-bottom: 1;
}
.reuseGenerated input {
  margin-top: 1;
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-28T18:07:30.407

很遗憾。选择器插值只是字符串插值，然后字符串被打印到 css 中，因此在 less 运行中不会生成类对象。

因此，您可以设计一个生成器/mixin，其中包括您的操作：

```
#genMarginTop (@size) {
  margin-top: @size;
} 
```

但是然后通过调用 mixins / generators 来构建类：

```
.mtStandard {#genMarginTop(40px);}
.mtHalf {#genMarginTop(20px);} 
```

这样它们就是你可以用于 mixin 的类对象 =)

```
.someClass {
  background-color: #FFF;
  .mtStandard;
  //more of this stuff
} 
```

在这个简单的例子中，这看起来有点傻，但可能是这样的：

```
 #bggenerator (@color) {
    background-color: @color;
 }
 #bggenerator (@color, dark) {
    @blend : @color + #842210;
    background-color: darken(@blend, 30%);
 }
 #bggenerator (@color, @url, @rest) {
    background: "@{color} url('@{url}') @{rest}";
 }

 .mtStandard {
    #genMarginTop(40px);
 }

.someClass {
  .mtStandard;
  #bggenerator(#FFF, "bgimage.png", left top no-repeat);
  //more of this stuff
} 
```

或者用争论做更令人兴奋的事情

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-11-06T20:23:38.580

## UPDATE LESS 1.7+（按要求工作）

`.@{name}`语法现在将按照原始问题的要求工作。

## 实际使用动态类名的 LESS 1.4+ 解决方法

我在处理另一个问题时想出了一个解决方法，所以我将它作为第二个答案发布，因为它的方向与我之前的答案完全不同。

**这个解决方案需要几个步骤（所以不像 LESS 中的最终修复那样方便），但会提供*能够使用动态生成的类名的实际功能*。**

**第一：定义你的动态类**

这和你计划的一样。

```
#genMarginTop (@name, @size) {
    .@{name} { margin-top: @size; }
}

#genMarginTop(mtStandard, 40px);
#genMarginTop(mtHalf, 20px); 
```

**第二：将该文件编译成*CSS***

所以可以说你编译`dynamicClasses.less`成`dynamicClasses.css`. 这会导致动态类名“解析”为实际类。

**第三：将该 CSS 作为 LESS 导入到使用动态类名的^(第二)个LESS 文件中**

使用[类型转换](http://lesscss.org/#-importing)for `@import`，我们这样做：

```
@import (less) dynamicClasses.css; 
```

`dynamicClasses.css`这会将文件中那些已解析的类名*导入为 LESS*，这使得所有类名现在都可以作为 mixins 使用。所以你可以做你想做的事：

```
.someClass {
    .mtStandard; // will work
    // more stuff
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-28T17:00:46.053

我同意。看起来 LESS 没有为 mixin 目的注册这些类。

## 不完整的解决方案

这个更少的代码：

```
#genMarginTop (@name, @size) {
  @genMarginTopNameCheck: @name; 
  .get(@name) when (@name = @genMarginTopNameCheck) { margin-top: @size; }
  .@{name} { .get(@name); }
}
#genMarginBot (@name, @size) {
    @genMarginBotNameCheck: @name; 
    .get(@name) when (@name = @genMarginBotNameCheck)  { margin-bottom: @size; }
    .@{name} { .get(@name); }
}

#genMarginTop(mtStandard, 40px);
#genMarginBot(mbStandard, 20px);
#genMarginTop(mtSpecial, 80px);

.myClass {
  .get(mtStandard);
  .get(mbStandard); 
}

.myClass2 {
  .get(mtSpecial);
  .get(mbStandard); 
} 
```

生成这个 CSS

```
.mtStandard {
  margin-top: 40px;
}
.mbStandard {
  margin-bottom: 20px;
}
.mtSpecial {
  margin-top: 80px;
}
.myClass {
  /* NOTE the mtStandard definition is missing here !!! */
  margin-bottom: 20px;
}
.myClass2 {
  margin-top: 80px;
  margin-bottom: 20px;
} 
```

## 最终解决问题的解释和讨论

每个 mixin 都基于 定义一个受保护的`.get()`mixin`@name`以获取样式，并交叉检查`NameCheck`该 mixin 的唯一变量名。您所有的实际代码都在 中定义`.get()`，并且该 mixin 用于实际生成`.@{name}`类代码。

每次生成实际的类名都可以正常工作。但是，目前的 getter 函数仅适用于使用 mixin***定义的最后一个类名。***因此，正如您在上面看到的，我的*get 调用*`mtStandard`不起作用，因为我*的设置*显然已经用定义`mtSpecial`覆盖了`#genMarginTop` `.get()`mixin 。`mtSpecial`

现在我假设您将要`#getMarginTop`多次调用和您的其他此类混入，因此显然***这仍然是一个不完整的解决方案***。我已经弄清楚了如何让顶级 mixin 生成的类用作另一个类的“mixin” `.get()`，但我还没有弄清楚如何`.get()`在顶级 mixin被再次调用。

# c++ - C++ 命名空间解析

> ID：15137471
> 
> 赞同：4
> 
> 时间：2013-02-28T14:04:40.863
> 
> 标签：c++, namespaces, unnamed-namespace

当我尝试构建此代码时：

```
// foo.h
namespace foo {
    namespace bar {
        void put();
    }
} 
```

```
#include "foo.h"
namespace foo {
    namespace {
        template<typename T>
        void put() { }
    }    
    void bar::put() {
        put<int>();
    };
} 
```

[我得到错误](http://ideone.com/m8DJax)：

```
foo.cpp: In function ‘void foo::bar::put()’:
foo.cpp: error: expected primary-expression before ‘int’
foo.cpp: error: expected ‘;’ before ‘int’ 
```

显然，`put<int>`是`put`用来指代的`bar::put`。我怎样才能让它引用`put<T>`匿名命名空间中的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-28T14:07:05.307

您可以完全限定函数模板的名称：

```
namespace foo {
    namespace bar {
        void put();
    }
}

namespace foo {
    namespace {
        template<typename T>
        void put() { }
    }
    void bar::put() {
        ::foo::put<int>();
    }
} 
```

另请注意，您不需要在函数定义后使用分号。

# asp.net - 在asp.net mvc的recaptcha中输入错误单词多少次

> ID：15137472
> 
> 赞同：0
> 
> 时间：2013-02-28T14:04:45.970
> 
> 标签：asp.net, asp.net-mvc, captcha

我在我的 ASP.NET MVC 项目中使用 google ReCAPTCHA，现在我想计算一个人输入错误单词的次数或他尝试了多少次

请帮我

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T14:56:35.013

一个简单的实现是将值存储在 cookie 中。

（cshtml/剃须刀）

```
<h2>@ViewBag.Captcha</h2>
@using (Html.BeginForm("Captcha", "Home", FormMethod.Post))
{    
    @Microsoft.Web.Helpers.ReCaptcha.GetHtml(publicKey: "...")    
    <input type="submit" value="validate"/>
} 
```

（控制器）

```
public ActionResult Index()
{
    ViewBag.Captcha = 0;
    return View();
}

public ActionResult Captcha()
    {
        var valid = Microsoft.Web.Helpers.ReCaptcha.Validate(privateKey: "...");
        if (valid)
        {
            return RedirectToAction("Success");
        }
        else
        {
            int failValue = 0;
            var failCookie = Request.Cookies["failCount"];

            if (failCookie == null)
            {
                failValue = 1;
                failCookie = new HttpCookie("failCount");
                failCookie.Value = failValue.ToString();
                Response.Cookies.Add(failCookie);
            }
            else
            {
                failValue = int.Parse(failCookie.Value);
                failValue = failValue + 1;
                failCookie.Value = failValue.ToString();
            }

            ViewBag.Captcha = "Failed " + failValue + " times";
            return View("Index");
        }           
    } 
```

# .net - 实体框架：使用过滤的子记录获取父记录

> ID：15137474
> 
> 赞同：3
> 
> 时间：2013-02-28T14:04:57.383
> 
> 标签：.net, entity-framework

我对 EF 了解不多，但必须做一些错误修复。错误之一发生如下：

*   使用获取父记录（EF LINQ 查询）`ObjectContext`
*   更改一些属性
*   保存更改

问题是`Get parent record`，更具体地说**，只有父母的活动孩子**。

这是当前的*黑客*：

```
var data =
    (from q in Context.Questions.Include("Status").Include("Category")
     where q.Id == id
     select q).SingleOrDefault();

var atts = Context.Answers.Where(a => a.qId == id && a.active); // 1
data.Answers.Clear(); // 2
foreach (var att in atts)
{
    data.Answers.Add(att); // 3
} 
```

发生什么了：

1.  从数据库中获取活动子记录
2.  由于延迟加载，所有附件都是从数据库中获取的。然后立即清除该集合。（EF 跟踪将这些记录标记为“删除”？）
3.  循环遍历所有活动记录并将它们再次添加到集合中（EF 跟踪将这些记录标记为“插入”？）

更新时出现以下异常：`The operation failed: The relationship could not be changed because one or more of the foreign-key properties is non-nullable. When a change is made to a relationship, the related foreign-key property is set to a null value. If the foreign-key does not support null values, a new relationship must be defined, the foreign-key property must be assigned another non-null value, or the unrelated object must be deleted.`

我认为这是一个非常普遍的错误，因为 EF 对清除集合然后再次添加一些相同的记录感到困惑。

**我的问题**：我如何只获取活动的子记录并将它们置于“未更改”状态，以便 EF 在任何时候都无法决定删除并重新插入我的记录。显然我也不想在更新时丢失非活动记录。

**不是答案**（或者是吗？）：经常在 SO 和 Google 上找到，但无法让它工作：

```
Context.ContextOptions.LazyLoadingEnabled = false;

var data =
    (from q in Context.Questions.Include("Status").Include("Category")
     where q.qId == id
     select new
     {
         Question = q,
         Answers = q.Answer.Where(a => a.active)
     }).ToArray().Select(q => q.Question).FirstOrDefault();

return data; // Does not contain the answers... :( 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-28T14:18:48.990

您可以显式加载属性而不是加载它，然后清除它。这将防止在对象图中加载不需要的对象，因此在断开非活动实体时不会出现错误。

```
var data =
    (from q in Context.Questions.Include("Status").Include("Category")
     where q.Id == id
     select q).SingleOrDefault();

Context.Entry(data).Collection(b => b.Answers).Query()
    .Where(a => a.active)
    .Load(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T14:13:48.380

调用`data.Answers.Clear()`是不够的，因为它只会删除您的问题和答案之间的关联。如果您还想删除这些答案，您也需要从上下文中删除它们。

```
foreach(var answer in data.Answers) {
  Context.DeleteObject(answer);
}

data.Answers.Clear(); 
```

# asp.net-mvc - 在从 MVC ASP.NET 中的数据库带来的表单上显示文件 (PDF/TXT)

> ID：15137475
> 
> 赞同：0
> 
> 时间：2013-02-28T14:04:59.210
> 
> 标签：asp.net-mvc, filecontentresult

我想使用 MVC 在我的表单上显示文件。

我从数据库中带来一个**Byte[]**数组数据，并使用**FileContentResult**将其转换为一个文件。我现在想在我的页面上显示这个文件以供查看。怎么可能达到。在我的**视图** 中编写相同的代码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T14:14:07.257

Assuming you're using Razor, rendering a text file can be done as simple as:

```
<div>
    @(new System.IO.StreamReader("myFile.txt")).ReadToEnd()
</div> 
```

For PDF files, you'll have to find a third-party component to convert to HTML.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-02T21:50:43.993

您可能不想使用 FileContentResult，它通常用于提供原始文件。

理论上，虽然使用任何其他 url 没有什么不同

```
<img src="@Html.ActionLink("View","Image",{id = Model.key})" /> 
```

或者您可以在 pdf 参考中提供该链接，或作为样式表等。

# wordpress - WordPress 自定义分类法分页帮助（首页）

> ID：15137478
> 
> 赞同：0
> 
> 时间：2013-02-28T14:05:03.720
> 
> 标签：wordpress, pagination, custom-post-type, custom-taxonomy

大家下午好

我有一个名为“画廊”的自定义分类法，并创建了一个新的页面模板来拉入“画廊”分类法中的所有帖子并对其进行分页。

这很好用（作为一个页面），但是我想将此页面设置为 WordPress 静态“首页”。

当我将此页面模板设置为“首页”时，分页不再起作用。我今天尝试了很多解决方案，非常感谢对此提供一些帮助！

非常感谢任何帮助/提示！

谢谢。

我的代码：

```
<?php

if ( get_query_var('paged') ) {
    $paged = get_query_var('paged');
} else if ( get_query_var('page') ) {
    $paged = get_query_var('page');
} else {
    $paged = 1;
}

$args = array(
'post_type' => 'gallery',
'paged' => $paged,
'orderby' => 'menu_order',
'order' => 'DESC'
);
query_posts( $args );

if ( have_posts()) : while( have_posts() ) : the_post(); ?>

    <!-- List Posts -->

<?php endwhile; ?>

<nav>
    <?php previous_posts_link( __( 'Previous', 'framework' ) ); ?>
    <?php next_posts_link( __( 'Next', 'framework' ) ); ?>
</nav>

<?php else : ?>

    <!-- No Posts -->

<?php endif; ?>

<?php wp_reset_postdata(); ?> 
```

***编辑：***

如果我添加全局 $paged; 在 if 语句之前它确实工作得很好。谁能教育我我所缺少的东西？

还有调用 global $paged; 的性能影响（如果有的话）是什么？在主页上？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T13:00:48.383

添加全局 $paged; 在任何代码运行之前。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-04-28T09:54:13.810

global $paged 在整个 WordPress 中都有效，要访问它，我们需要像您的情况一样将其放在使用之前。是的，使用这个变量完全没有问题，而且您完全安全。实际上， $paged 变量正在获取每个页面的帖子，一旦您使用此变量，它就会适当地显示数据。在 WordPress 中还可以使用其他全局变量，对于整个列表，您可以访问这个官方 codex 页面[https://codex.wordpress.org/Global_Variables](https://codex.wordpress.org/Global_Variables)

我希望在阅读此评论并浏览此 URL 后，您的所有问题都将得到解决，并且您将来也可以通过最佳方法利用所有这些信息......

# gwt - 保持 GWT 小部件大小与屏幕大小成比例

> ID：15137486
> 
> 赞同：1
> 
> 时间：2013-02-28T14:05:19.033
> 
> 标签：gwt

我的大多数视图将有 5 - 10 个小部件，我正在尝试弄清楚如何使按钮、下拉菜单看起来最好。
我尝试将它们的尺寸设置为当前屏幕尺寸的百分比，但这对于非常大或非常小的屏幕来说不是一个理想的解决方案。移动用户将是主要的最终用户。实现这一点的最佳方法是什么所以移动用户实际上将能够在小屏幕上看到一个大小合适的按钮，而如果 PC 用户是全屏的，则最终不会看到一些巨大的按钮。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T14:56:55.820

您也可以使用[ViewPort Meta 标签](https://developer.mozilla.org/en-US/docs/Mobile/Viewport_meta_tag#language)来维护`widths and heights`您在设备上的 Web 应用程序的正确性。无需`mobile`更改所有`layouts`.

```
The viewport meta tag to control layout on mobile browsers. 
```

另请参阅下面的问题，我已经回答了设置视口。

[使用视口元标记实现最小宽度](https://stackoverflow.com/questions/15040408/achieving-min-width-with-viewport-meta-tag/15045700#15045700)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T09:39:16.517

在现代浏览器中，除了另一个响应中提到的适用于整个文档的视口之外，您还可以使用 css 缩放转换。

请参阅这个纯 html/css[示例](http://jsfiddle.net/dodotis/nK5WN/3/)

我在 GWT 中所做的是，我是否有不同的 .ui.xml 或 css 包用于具有不同比例值的桌面和移动排列，或者我通过代码更改它（根据窗口大小、浏览器类型等计算比例因子）。

在第二种情况下，您可以使用 gwt 元素方法：

```
 panel.getElement().getStyle().setProperty("WebkitTransform", "scale(0.65, 0.65)");
 panel.getElement().getStyle().setProperty("MozTransform", "scale(0.65, 0.65)"); 
```

或者我宁愿使用[gwtquery](http://code.google.com/p/gwtquery/)语法：

```
$(panel).css($$("-webkit-transform: scale(0.65, 0.65); -moz-transform: scale(0.65, 0.65);")); 
```

# ruby-on-rails - Rake 任务未将 CSV 添加到数据库

> ID：15137490
> 
> 赞同：0
> 
> 时间：2013-02-28T14:05:25.117
> 
> 标签：ruby-on-rails, ruby-on-rails-3, csv, rake-task

我正在尝试将 CSV 行添加到表中的记录中，除了实际上没有显示任何内容之外，一切似乎都运行良好。

这是我的耙子任务：

```
namespace :csv do

  desc "Import CSV Data"
  task :c_up => :environment do

    require 'csv'

    csv_file_path = 'db/main.csv'

    CSV.foreach(csv_file_path, :headers => true) do |row|
      row = Entry.create!({
        :one => row[0],
        :two => row[1],
        :three => row[2],
        :four => row[3],
        :five =>row[4],
        :six => row[5],
        :seven => row[6],
        :eight => row[7],
        :nine => row[8],
        :ten => row[9]
      })
      row.save
      puts "Entry added!"

    end
  end
end 
```

我的 CSV 中的标题被命名为与属性匹配。

当我运行任务时，我没有收到任何错误，并且所有“已添加条目！” 出现在控制台中。我在没有 and 的情况下尝试过`row =`，`row.save`因为我已经看到很多没有这些的例子，但它没有帮助。

耙子完成后，根本没有任何记录。有什么明显的我做错了吗？似乎这是在遵循我见过的大多数示例。

**编辑** 感谢您的所有回答和评论！显然，这一直到语法都有缺陷，我将尝试您的建议，然后我会更新它。再次感谢！

**编辑2** 原来是你们都指出的语法问题，所以+1感谢大家！我评论它仍然不起作用的原因是一个不相关的问题，如果没有@jvnill 的评论，我不会想出来。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T14:10:17.643

`Entry.create!`不需要分配给 row 也不需要`row.save`. 也知道 '{}' 只是这样做：

```
Entry.create!(
        :one => row[0],
        :two => row[1],
        :three => row[2],
        :four => row[3],
        :five =>row[4],
        :six => row[5],
        :seven => row[6],
        :eight => row[7],
        :nine => row[8],
        :ten => row[9]
      ) 
```

create 方法将填充该行并保存它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T14:15:38.833

尝试：

```
row = Entry.new(
        :one => row[0],
        :two => row[1],
        :three => row[2],
        :four => row[3],
        :five =>row[4],
        :six => row[5],
        :seven => row[6],
        :eight => row[7],
        :nine => row[8],
        :ten => row[9]
      )
      row.save! 
```

没有**{ }**和**保存！**

您甚至可以尝试这样做，以使其更简单：

```
Entry.create!(row.to_hash) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-28T14:52:42.270

命名空间 :csv 做

desc "导入 CSV 数据" 任务 :c_up => :environment do

```
require 'csv'

csv_file_path = 'db/main.csv'

CSV.foreach(csv_file_path, :headers => true) do |row|
  Entry.create!({
    :one => row[0],
    :two => row[1],
    :three => row[2],
    :four => row[3],
    :five =>row[4],
    :six => row[5],
    :seven => row[6],
    :eight => row[7],
    :nine => row[8],
    :ten => row[9]
  })
end 
```

结束结束

# php - 将接收到的数据拆分到单独的字段中

> ID：15137505
> 
> 赞同：0
> 
> 时间：2013-02-28T14:06:09.100
> 
> 标签：php, mysql, curl

问题：提供的数据不适合我直接处理。

描述：我正在使用 curl 从另一个网站获取我需要的数据。但是，此网站上提供的数据的格式设置为我需要对其进行拆分才能使用它。

例子：

我正在刮一个 div（足球比赛），但比赛是在一个领域提供的，我需要将 2 支球队分成 2 个领域。

刮擦后MysqlDB字段保持： `team 1 - team 2`

我需要将该数据库信息分成 2 列

preg_match 是可以做到的，但是对手很多，这样就麻烦了。

现在，我添加（手动这很痛苦）一个 team_id 列并将 myteam 添加到涉及我的团队到 db 表的游戏中并做了 where team_id = myteam 这样我至少可以对竞争表进行排序并得到我的团队游戏。

这是我正在谈论使用 curl 获取的数据：

`$value['Wedstrijd'] = htmlentities($value['Wedstrijd'], ENT_QUOTES);`

所以现在我正在抓取该字段并将其放入数据库中。我想知道，如何将 $value['Wedstrijd'] 的内容分成 2 个写入......

这甚至可能吗？

我无法在这里发布整个代码，格式被搞砸了。

使用 substr 和 strrpos 我能够让第一支球队离开现场，我认为将它设置为 -1 会给我带来相反的效果，它实际上是这样做的，但它不会回到 - 符号，它只是然后给我1个字母/符号。

`substr($wedstrijd,0,strrpos($wedstrijd,'-'));`这将返回第一支球队，但我不确定如何使用它来获得 - 符号后的球队。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T14:08:45.727

使用 strpos + substr 或 preg_match

# android - Android - 将带有 URL 的图片保存在外部存储上

> ID：15137507
> 
> 赞同：1
> 
> 时间：2013-02-28T14:06:10.843
> 
> 标签：android, url, storage, external, image

我已经搜索并尝试了我在 Google 和 StackOverflow 上找到的关于这个主题的所有内容，但我没有找到让它起作用的方法。我有这段代码，但它给了我一个致命的例外。我认为，因为我是 Android 新手，所以我做错了一些事情。请帮帮我^^

```
 public void svgPhoto() throws IOException {
    String dir = Environment.getExternalStorageDirectory().toString();
    OutputStream fos = null;
    File file = new File(dir,"downloadImage.JPEG");
    Bitmap bm =BitmapFactory.decodeFile("http://perlbal.hi-pi.com/blog-images/3278/gd/1242316719/Chat-chat.jpg");
    fos = new FileOutputStream(file);
    BufferedOutputStream bos = new BufferedOutputStream(fos);
    bm.compress(Bitmap.CompressFormat.JPEG, 50, bos);
    bos.flush();
    bos.close(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T14:32:57.463

公共类下载扩展 AsyncTask {

```
 @Override
        protected Void doInBackground(Void... params) 
                    {
            try {
        URL url = new URL(imageURL);
        file2 = new File(fileName);

        long startTime = System.currentTimeMillis();

        /* Open a connection to that URL. */
        URLConnection ucon = url.openConnection();

        /*
         * Define InputStreams to read from the URLConnection.
         */
        InputStream is = ucon.getInputStream();
        BufferedInputStream bis = new BufferedInputStream(is);

        /*
         * Read bytes to the Buffer until there is nothing more to read(-1).
         */
        ByteArrayBuffer baf = new ByteArrayBuffer(50);
        int current = 0;
        while ((current = bis.read()) != -1) {
            baf.append((byte) current);
        }

        /* Convert the Bytes read to a String. */
        FileOutputStream fos = new FileOutputStream(file2);
        fos.write(baf.toByteArray());
        fos.close();
        Log.d("ImageManager",
                "download ready in"
                        + ((System.currentTimeMillis() - startTime) / 1000)
                        + " sec");

    } catch (IOException e) {

    }
            return null;
        }

        @Override
        protected void onPostExecute(Void result) {
            super.onPostExecute(result);
            try {
                try {

        File fileWithinMyDir = getApplicationContext().getFilesDir();
        String PATH = fileWithinMyDir.getAbsolutePath();

        Drawable d = Drawable.createFromPath(PATH.toString());
        Bitmap bmp = ((BitmapDrawable) d).getBitmap();

    } catch (Exception e) {
        e.printStackTrace();
    }

                if (dialog != null) {
                    if (dialog.isShowing()) {
                        dialog.dismiss();
                    }
                }
            } catch (IOException e) {
                e.printStackTrace();
            }
        }

    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T16:07:52.953

尝试下一个代码：

```
String dir = Environment.getExternalStorageDirectory().toString();

File outputfile = new File(dir+"/downloadImage.JPEG");
OutputStream fOut = null;
try {
fOut = new FileOutputStream(outputfile);
Bitmap bm =BitmapFactory.decodeFile("http://perlbal.hi-pi.com/blog-images/3278/gd/1242316719/Chat-chat.jpg");
bm.compress(CompressFormat.JPEG, 50, fOut); 
} catch (IOException e) {
Logger.error(e.getMessage(), e);
}finally{
try {
if(fOut != null){
fOut.flush();
fOut.close();
}
} catch (IOException e) {
Logger.error(e.getMessage(), e);
}
} 
```

# c# - OAuth 2.0 与 REST WCF 服务应用程序集成

> ID：15137510
> 
> 赞同：14
> 
> 时间：2013-02-28T14:06:18.243
> 
> 标签：c#, oauth-2.0, wcf-security

我需要使用 C# 中的 VS 2012 WCF 服务应用程序模板将身份验证层 OAuth2.0 与 REST 服务集成的帮助。在允许客户端（消费者）访问其任何资源之前，此 WCF 需要为服务的授权和身份验证颁发令牌。三足身份验证是我所关注的。很像 Twitter、LinkedIn、Google OAuth 的实现。

已在 Internet 上广泛搜索与 OAuth 集成的 REST WCF API，但没有找到任何合适的线索来帮助我。我看过一个旧的例子[http://weblogs.asp.net/cibrax/archive/2008/11/14/using-the-wcf-oauth-channel-with-an-ado-net-service.aspx](http://weblogs.asp.net/cibrax/archive/2008/11/14/using-the-wcf-oauth-channel-with-an-ado-net-service.aspx)

我已使用此示例与现有的 Rest WCF 集成。当我运行该服务时，我收到“500 内部服务器错误”，其他时候操作只是超时。

这是导致问题的实现。

我必须添加如下拦截器并在 .svc Factory="DemoRESTOAuthService.AppServiceHostFactory" 中引用：

```
class AppServiceHostFactory : System.ServiceModel.Activation.ServiceHostFactory
{
     //<summary>
     //Factory method called by WCF to create a <see cref="ServiceHost"/>.
     //</summary>
     //<param name="serviceType">The type of the service to be created.</param>
     //<param name="baseAddresses">Collection of base addresses where the <see cref="ServiceHost"/> can listen.</param>
     //<returns>An instance of <see cref="ServiceHost"/>.</returns>
    protected override ServiceHost CreateServiceHost(Type serviceType, Uri[] baseAddresses)
    {
        try
        {
            Microsoft.ServiceModel.Web.WebServiceHost2 result = new Microsoft.ServiceModel.Web.WebServiceHost2(serviceType, true, baseAddresses);

            result.Interceptors.Add(new OAuthChannel.OAuthInterceptor(DemoRESTOAuthService.OAuth.OAuthServicesLocator.Provider, DemoRESTOAuthService.OAuth.OAuthServicesLocator.AccessTokenRepository));

            return result;
        }
        catch(Exception e)
        {
           throw e;
        }
    }
} 
```

当我使用日志文件进行调试时，我只能知道在 OAuthChannel 程序集的 OAuthInterceptor.cs 中引发了异常。我使用过跟踪日志和提琴手，但除了 500 内部服务器错误之外，我在理解错误方面没有得到太多帮助。

```
public override void ProcessRequest(ref RequestContext requestContext)
    {
        if (requestContext == null || requestContext.RequestMessage == null)
        {
            return;
        }

        Message request = requestContext.RequestMessage;

        HttpRequestMessageProperty requestProperty = (HttpRequestMessageProperty)request.Properties[HttpRequestMessageProperty.Name];

        OAuthContext context = new OAuthContextBuilder().FromUri(requestProperty.Method, request.Headers.To);

        try
        {
            _provider.AccessProtectedResourceRequest(context);

            OAuthChannel.Models.AccessToken accessToken = _repository.GetToken(context.Token);

            TokenPrincipal principal = new TokenPrincipal(
                new GenericIdentity(accessToken.UserName, "OAuth"),
                accessToken.Roles,
                accessToken);

            InitializeSecurityContext(request, principal);
        }
        catch (OAuthException authEx)
        {
            XElement response = XElement.Load(new StringReader("<?xml version=\"1.0\" encoding=\"utf-8\"?><html xmlns=\"http://www.w3.org/1999/xhtml\" version=\"-//W3C//DTD XHTML 2.0//EN\" xml:lang=\"en\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://www.w3.org/1999/xhtml http://www.w3.org/MarkUp/SCHEMA/xhtml2.xsd\"><HEAD><TITLE>Request Error</TITLE></HEAD><BODY><DIV id=\"content\"><P class=\"heading1\"><B>" + HttpUtility.HtmlEncode(authEx.Report.ToString()) + "</B></P></DIV></BODY></html>"));
            Message reply = Message.CreateMessage(MessageVersion.None, null, response);
            HttpResponseMessageProperty responseProperty = new HttpResponseMessageProperty() { StatusCode = HttpStatusCode.Forbidden, StatusDescription = authEx.Report.ToString() };
            responseProperty.Headers[HttpResponseHeader.ContentType] = "text/html";
            reply.Properties[HttpResponseMessageProperty.Name] = responseProperty;
            requestContext.Reply(reply);

            requestContext = null;
        }
    } 
```

那里的任何人都可以帮助我了解正在发生的事情吗？

或者，您能否为我提供有关三足 OAuth Provider 实施的任何其他合适的示例、指针、提示或文档。在过去的一周里，我真的被这个问题困住了。任何帮助表示赞赏。

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-11-10T08:34:20.227

为什么不使用已经构建了 OAuth2 身份验证提供程序的 ServiceStack 等框架： [https ://github.com/ServiceStack/ServiceStack/wiki/Authentication-and-authorization](https://github.com/ServiceStack/ServiceStack/wiki/Authentication-and-authorization)

或者，如果您不想使用整个堆栈，请查看他们的代码以了解它与您自己的代码有何不同。

# .net - UX：使用数据网格处理大型数据集

> ID：15137511
> 
> 赞同：2
> 
> 时间：2013-02-28T14:06:22.647
> 
> 标签：.net, datagrid, paging, user-experience

我在这里发现了类似的问题，但我想扩展一下。

我很难掌握正确的 UX 概念（Windows Forms，.NET）来处理大型数据集（10,000 多条记录，通常可以安全地假设多达 100,000 条记录）。我想让（内部注册系统的）用户能够尽可能无缝地浏览数据集。

我的数据集位于远程服务器上，并且可以由具有每条记录锁定的多个用户同时访问。我正在使用 RPC，因此无法进行直接数据绑定，我必须自己在代码中加载数据。

我已经尝试过这些方法（目前都是使用 GridEX 数据网格实现的）：

1.  一次加载所有记录（当前为 7,6k 条记录，最多需要 15 秒才能加载），在加载过程中向用户显示加载对话框。问题是，数据需要大约 20M 的内存，而且随着数据集的增长，我担心以后会出现内存消耗问题。
2.  使用特殊数据源手动处理 GridEX（或任何其他网格）上的分页，该数据源仅从服务器加载部分数据。这使我可以管理消耗的内存量，但给用户带来了多重限制，而且由于默认情况下网格不处理分页，因此搜索存在一些问题等。

我的问题是，应该如何正确完成？假设该客户端希望能够浏览数据集，因此搜索和过滤对话框并不是一个选择。

我知道，这不是一个适当的问答问题，我希望有很多主观意见，所以很难标记答案。

感谢您的见解。

# android - 如果/否则在按钮按下时没有捕捉到内部方法

> ID：15137513
> 
> 赞同：0
> 
> 时间：2013-02-28T14:06:26.710
> 
> 标签：android, if-statement

所以我有一个方法可以在按下按钮时运行，一切都很完美，除了我有一点内部 if/else if/else 循环。我确定这是我想念的愚蠢的东西，但我似乎看不到它。

在下面的代码中，我找到了小时类型，但即使我直接将其设置为 false，if/else 也不会触发。它能够很好地获得小时 int，但它不会像预期的那样从中减去 12。

我知道我没有在这里指定日期类型，因为我之前已经这样做了。这不是这里的问题。就像我说的那样，我确定我错过了一些愚蠢的东西，因为我已经盯着它太久了。这是方法：

```
public String enterMood(View v) {
    try {
        int month = dPick.getMonth();
        int day = dPick.getDayOfMonth();
        int year = dPick.getYear();
        int minute = tPick.getCurrentMinute();
        String moodAntePost = "AM";
        hourType = tPick.is24HourView();
        moodHour = tPick.getCurrentHour();
        if (hourType = false) { // Not hitting this point for some reason I
                                // can't fathom.
            if (moodHour > 12) {
                moodHour = (moodHour - 12);
                moodAntePost = "PM";
            }
        } else if (hourType = false) {
            if (moodHour <= 0) {
                moodHour = 12;
            }
        } else {
        }
        String noteText = noteField.getText().toString();
        Mood = "Happiness," + happyValue + ",Energy," + energyValue
                + ",Anxiety," + anxietyValue + ",Pain," + painValue
                + ",Date," + month + "/" + day + "/" + year + ",Time,"
                + moodHour + ":" + minute + "," + moodAntePost + ",Note,"
                + noteText;
        System.out.println(Mood); //Just to print to the LogCat
    } catch (Exception buttonListenerException) {
        Log.e(TAG, "Exception received", buttonListenerException);
    }
    return Mood;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-28T14:08:18.147

澄清：`=`用于分配目的，例如`int x = 10;`，`==`用于比较，例如`boolean isX10 = x==10;`

你的`if`说法是错误的这样做：

```
 if (hourType == false) { // Not hitting this point for some reason I
                            // can't fathom. 
```

**或者**

```
 if (!hourType) { // Not hitting this point for some reason I
                            // can't fathom. 
```

代替

```
 if (hourType = false) { // Not hitting this point for some reason I
                            // can't fathom. 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-28T14:08:08.393

也许`hourType = false`应该`hourType == false`或者甚至更好`!hourType`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-28T14:11:52.303

if 和 else 如果两者都以错误的语法检查相同的条件，它应该类似于

```
 if (hourType == false) { // Not hitting this point for some reason I
                                    // can't fathom.
                if (moodHour > 12) {
                    moodHour = (moodHour - 12);
                    moodAntePost = "PM";
                }
            } else if (hourType == true) {
                if (moodHour <= 0) {
                    moodHour = 12;
                } 
```

或者

```
 if (!hourType) { // Not hitting this point for some reason I
                                        // can't fathom.
                    if (moodHour > 12) {
                        moodHour = (moodHour - 12);
                        moodAntePost = "PM";
                    }
                } else if (hourType) {
                    if (moodHour <= 0) {
                        moodHour = 12;
                    } 
```

# templates - 模板继承冲突（同一页面多个doLayout）

> ID：15137518
> 
> 赞同：0
> 
> 时间：2013-02-28T14:06:49.130
> 
> 标签：templates, inheritance, playframework, playframework-1.x

我对游戏框架（1.2.4）有一个小问题。我想让一个标签继承另一个标签，并将这个标签包含在扩展另一个网页的 html 页面中。最好的解释方法是使用模式：

![通缉建筑](../Images/47bb630099775456ff933fb71f815ddd.png)

但是，它没有按我想要的方式工作。事实上，test.tag 文件中的extends 似乎覆盖了Screen.html 中的extends。然后，所有 Screen.html 的内容都包含在 block.tag 中，`#{doLayout /}`而不是包含在 main.html 中

有什么办法可以做我想做的事吗？谢谢。

* * *

这是来源：

*main.html*

```
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="fr" lang="fr">
    <body>
    #{doLayout /}
    </body>
</html> 
```

*屏幕.html*

```
#{extends 'main.html' /}
<div id="Screen.html">
    #{test  /}
</div> 
```

*测试标签*

```
#{extends 'tags/block.tag' /}
test.tag 
```

*块标签*

```
<div id="test">
    #{doLayout /}
</div> 
```

*页面调用时生成的html*

```
<div id="test">
    <div id="Screen.html">
        test.tag
    </div>
</div> 
```

如您所见，main.html 不包含在内，而 Screen 包含在块中。有任何想法吗 ？

* * *

有关信息，想要的输出：

```
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="fr" lang="fr">
    <body>
        <div id="Screen.html">
            <div id="test">
                test.tag
            </div>
        </div>
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T07:35:32.830

您可以尝试在模板中使用#{extends /}，但不要在标签中使用它们。

为了在另一个之上构建标签有更大的灵活性，你可以这样做：

测试标签：

```
#{block }
test.tag
#{/block} 
```

和block.tag：

```
<div id="test">
#{doBody /}
</div> 
```

有了这个，你将身体的一部分从 test.tag 传递到 block.tag 并使用 #{doBody /} 将它插入到 block.tag 的某处

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T19:18:49.057

我认为这可能是由于 Groovy 引擎`#{extends}`在运行时进行评估，而`screen.html`调用`test.tag`又是 extends `block.tag`，这发生在屏幕的延伸到`main.html`运行时，groovy 决定最终的延伸获胜。

可能您想尝试在解析时评估语义的[rythm 插件。](http://www.playframework.com/modules/rythm)`extends`这说明节奏在你的情况下没有问题。

# python - 如何将python变量传递给html变量？

> ID：15137520
> 
> 赞同：4
> 
> 时间：2013-02-28T14:06:58.760
> 
> 标签：python, html, variables, webserver, readfile

我需要从python中的文本文件中读取一个url链接作为变量，并在html中使用它。文本文件“file.txt”只包含一行“ [http://188.xxx.xxx.xx:8878](http://188.xxx.xxx.xx:8878) ”，这一行应该保存在变量“link”中，那么我应该使用这个变量的包含在html，以便当我单击按钮图像“go_online.png”时应该打开链接。我试图改变我的代码如下，但它不起作用！请问有什么帮助吗？

```
#!/usr/bin/python
import cherrypy
import os.path
from auth import AuthController, require, member_of, name_is
class Server(object):
    _cp_config = {
        'tools.sessions.on': True,
        'tools.auth.on': True
    }   
    auth = AuthController()      
    @cherrypy.expose
    @require()
    def index(self):
        f = open ("file.txt","r")
        link = f.read()
        print link
        f.close()
        html = """
        <html>
        <script language="javascript" type="text/javascript">
           var var_link = '{{ link }}';
        </script> 
          <body>
            <p>{htmlText} 
            <p>          
            <a href={{ var_link }} ><img src="images/go_online.png"></a>
          </body>
        </html> 
           """

        myText = ''           
        myText = "Hellow World"          
        return html.format(htmlText=myText)
    index.exposed = True

#configuration
conf = {
    'global' : { 
        'server.socket_host': '0.0.0.0', #0.0.0.0 or specific IP
        'server.socket_port': 8085 #server port
    },

    '/images': { #images served as static files
        'tools.staticdir.on': True,
        'tools.staticdir.dir': os.path.abspath('/home/ubuntu/webserver/images')
    }
    }
cherrypy.quickstart(Server(), config=conf) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-28T14:32:09.347

首先，不确定javascript部分是否有意义，只需将其排除在外。此外，您打开一个**p**标签但没有关闭它。不确定你的模板引擎是什么，但你可以在纯 python 中传递变量。另外，请确保在您的链接周围加上引号。所以你的代码应该是这样的：

```
class Server(object):
    _cp_config = {
        'tools.sessions.on': True,
        'tools.auth.on': True
    }   
    auth = AuthController()      
    @cherrypy.expose
    @require()
    def index(self):
        f = open ("file.txt","r")
        link = f.read()
        f.close()
        myText = "Hello World" 
        html = """
        <html>
            <body>
                <p>%s</p>          
                <a href="%s" ><img src="images/go_online.png"></a>
            </body>
        </html>
        """ %(myText, link)        
        return html
    index.exposed = True 
```

（顺便说一句， %s 东西是字符串占位符，它将在多行字符串的末尾填充 %(firstString, secondString) 中的变量。

# android - 在自动创建的文件中受到保护，什么是私有的

> ID：15137521
> 
> 赞同：0
> 
> 时间：2013-02-28T14:06:58.977
> 
> 标签：android, eclipse

当我创建一个新的 Android 应用程序项目时，我会看到自动生成`MainActivity.java`文件。

为什么“ `OnCreate`”受到保护

我记得这是私人的。我不明白。为什么做这个？

例如这个：

```
public class MainActivity extends Activity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        // Inflate the menu; this adds items to the action bar if it is present.
        getMenuInflater().inflate(R.menu.main, menu);
        return true;
    }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T14:11:44.480

它从来没有`private`，如果它是私人的，那么你怎么能做到`Override`呢？您可能已经看到它，`public`因为子类不能降低方法的可见性。阅读此问题以进行澄清。[为什么不能降低 Java 子类中方法的可见性？](https://stackoverflow.com/questions/1600667/why-cant-you-reduce-the-visibility-of-a-method-in-a-java-subclass)

# c# - 使用 SignalR 时跟踪用户操作

> ID：15137523
> 
> 赞同：3
> 
> 时间：2013-02-28T14:07:03.093
> 
> 标签：c#, javascript, signalr

我正在使用 SignalR 库创建一个聊天室，但现在我想跟踪用户操作，例如，如果客户端 1 正在与客户端 2 交谈，我想显示 (...) 以告诉客户端 2 客户端 1 正在编写一个消息是他们无论如何要这样做吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-28T17:57:48.260

您可以处理 KeyPress 事件，并且每隔一段时间（比如每 10 个字符左右），您可以调用服务器端消息来通知“UserTyping”操作。

**客户端**

```
<textbox id="message"></textbox>
<span id="userTyping"></span>

var keyPressCount = 0;

$("#message").on("keypress", function () {
    // Throttle the server call with some logic
    // Don't want to call the server on every keypress
    if (keyPressCount++ % 10 == 0) {
        chatHub.server.userTyping("myChatGroup");
    }
});

chatHub.client.OtherUserIsTyping = function (userName) {
    $("#userTyping").html(userName + " is typing...");
}; 
```

**服务器端**

```
public void UserTyping(groupName)
{
    var userName = "Get current user's name";

    Clients.OthersInGroup(groupName).OtherUserIsTyping(userName);
} 
```

# sorting - 无法按另一个值对 Crystal Reports 中的组进行排序

> ID：15137526
> 
> 赞同：1
> 
> 时间：2013-02-28T14:07:11.830
> 
> 标签：sorting, crystal-reports, grouping

我正在处理 Crystal Reports 报告（CR 版本 11.5），我在对我的一个组进行排序时遇到了很大的麻烦。

我需要按该零件订单上质量备注的百分比对该组（零件编号）进行排序。质量注释最多的部分应在报告中位于顶部。

问题是我似乎只能按汇总字段对 Part Group 进行排序。而且我似乎无法将这个百分比的质量评论放在摘要字段中。

我认为这是因为这个百分比是通过计算评论数除以该部分的交付总量来计算的。我认为问题在于计数，因为公式数据库中现成的值可供汇总。但是百分比不...

有没有解决的办法？因为如果我不能在评论最多的零件上对它进行排序，这个报告就不是很有用%......

谢谢！

# java - Java：使用 Silvertunnel Netlib 的 Tor HTTP 请求

> ID：15137527
> 
> 赞同：1
> 
> 时间：2013-02-28T14:07:15.837
> 
> 标签：java, tor, silvertunnel

[我正在尝试使用 Silvertunnel Netlib ( https://silvertunnel.org/doc/netlib.html](https://silvertunnel.org/doc/netlib.html) )从 Tor 网络上的 Java 应用程序中发出匿名 HTTP 请求。我正在使用示例代码，该代码在通过 TCPIP 发出请求时有效，但在使用 TOR 设置时，它以以下异常结束（尝试连接大约 10 分钟后）：

```
java.io.IOException: Tor.connect: unable to connect to null:80 after 11 full retries with 5 sub retries
    at org.silvertunnel.netlib.layer.tor.clientimpl.Tor.connect(Tor.java:281)
    at org.silvertunnel.netlib.layer.tor.TorNetLayer.createNetSocket(TorNetLayer.java:113)
    at org.silvertunnel.netlib.util.HttpUtil.get(HttpUtil.java:121)
    at FlightBot.main(FlightBot.java:48) 
```

这是我正在使用的代码：

```
NetLayer lowerNetLayer = NetFactory.getInstance().getNetLayerById(NetLayerIDs.TOR);

// wait until TOR is ready (optional) - this is only relevant for anonymous communication:
lowerNetLayer.waitUntilReady();

// prepare parameters (http default port: 80)
TcpipNetAddress httpServerNetAddress = new TcpipNetAddress("httptest.silvertunnel.org", 80);
String pathOnHttpServer = "/httptest/bigtest.jsp?id=example";
long timeoutInMs = 5000;

// do the HTTP request and wait for the response
byte[] responseBody = HttpUtil.getInstance().get(lowerNetLayer, httpServerNetAddress, pathOnHttpServer, timeoutInMs);

// print out the response
System.out.println(new String(responseBody)); 
```

是我做错了什么还是 Tor 网络目前不可用？

需要明确的是，它在使用时有效：

```
NetLayer lowerNetLayer = NetFactory.getInstance().getNetLayerById(NetLayerIDs.TCPIP) 
```

在第一行。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-11-19T13:28:27.507

问题在于底层的 Tor 实现。Tor 网络不断发展，并非所有更改都已在 Silvertunnel Netlib 中实现。由于个人原因，silvertunnel项目已经停止。我创建了一个新版本：[SilverTunnel-NG](https://sourceforge.net/projects/silvertunnel-ng/)，它是原始项目的一个分支。

现在与 Tor 网络的连接再次正常工作。

希望这对你来说还不算晚:)

# ant - 如果找不到类路径上的文件夹，如何使 ant 不失败

> ID：15137529
> 
> 赞同：1
> 
> 时间：2013-02-28T14:07:17.677
> 
> 标签：ant

我正在尝试修改我的 ant 脚本，以便无论是否存在本地 lib 文件夹，它都能正确构建。我想在多场战争中使用相同的脚本，其中一些会有 WEB-INF/lib，而另一些则没有。如果该文件夹存在，请将其包含在类路径中，如果不存在，则不要包含它。我试过推杆，但我不知道它应该放在哪里。我认为这应该比我想象的要简单得多，但我的 Googl Fu 让我失望了。

```
<property name="local.libs" value="WebContent/WEB-INF/lib" /> 
<path id="local.libs.path">
<fileset dir="${local.libs}" includes="*.jar" />
</path>
<target name="compile">
    <mkdir dir="${build.classes.dir}"/>
    <javac srcdir="${src.java.dir}" destdir="${build.classes.dir}" debug="true" includeantruntime="false">
        <compilerarg value="-Xlint:-path" />
        <classpath refid="local.libs.path" />
                    <classpath refid="server.libs.path" /> <!-- not referenced in snippet -->
    </javac>
</target> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T12:51:11.230

我最终通过将 local.libs 的值设置为 WebContent/WEB-INF 来解决这个问题：

```
<property name="local.libs" value="WebContent/WEB-INF" /> 
```

然后是文件集

```
<fileset dir="${local.libs}" includes="*lib/*.jar" /> 
```

然后它将构建 lib 文件夹是否存在。

# javascript - .each 低谷 html 里面的变量

> ID：15137531
> 
> 赞同：1
> 
> 时间：2013-02-28T14:07:20.690
> 
> 标签：javascript, jquery, html

他我只是问当我的 html 在 java-script 变量中而不是在 DOM 本身中时如何使用 .each 。

如果我有这样的html：

```
<html>
    <h1>deze</h1>
    <h1>this</h1>
    <h1>dies</h1>
</html> 
```

我可以：

```
$('h1').each(function(){
    var test = $(this).html();
    alert(test);                
}); 
```

它只会发出 3 次警报，告诉 deze，这个，死了。现在我想做同样的事情，但是在变量中使用 html。不知道这是我的伪代码：

```
var html = '
           <h1>deze</h1>
           <h1>this</h1>
           <h1>dies</h1>
           ';

$(html).each('h1', function(){
    var test = $(this).html();
    alert(test);                
}); 
```

不知道该怎么做，我不知道。请赐教！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T14:10:17.750

试试这个，首先将你的 sting 解析成一些 DOM 节点： [http ://api.jquery.com/jQuery.parseHTML/](http://api.jquery.com/jQuery.parseHTML/)

```
var html = '<div>\
           <h1>deze</h1>\
           <h1>this</h1>\
           <h1>dies</h1>\
           </div>';
var test = $.parseHTML(html);

$('h1',test).each(function(){
    var test = $(this).html();
    alert(test);                
}); 
```

这里的例子：http: [//jsfiddle.net/cnWqQ/3/](http://jsfiddle.net/cnWqQ/3/)

另外，在您的问题中，我注意到您的 html 变量不会像在多行中键入的方式那样解析为变量。

使用此方法时要注意的一件事是，如果您要搜索的元素位于顶层，它将不起作用。为避免这种情况，只需将字符串包装在 div 中。有关这方面的更多信息，请参见此处： http: [//fredwu.me/post/554746690/jquery-tip-traverse-parse-html-string](http://fredwu.me/post/554746690/jquery-tip-traverse-parse-html-string)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T14:12:00.660

```
var html = '\
           <h1>deze</h1>\
           <h1>this</h1>\
           <h1>dies</h1>\
           ';

$("<div/>").html(html).find("h1").each(function(){
    var test = $(this).html();
    alert(test);                
});

$(html).filter("h1").each(function(){
    var test = $(this).html();
    alert(test);                
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-28T14:15:41.437

`**[LIVE DEMO](http://jsbin.com/eqifed/3/edit)**`

```
var html = '<h1>deze</h1>'+
           '<h1>this</h1>'+
           '<h1>dies</h1>';

$(html).filter(function(){
    var test = $(this).html();
    alert(test);                          // deze // this // dies
}); 
```

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2013-02-28T14:09:24.343

尝试类似：

```
$(html).filter('h1').each(function(){
    var test = $(this).html();
    alert(test);                
}); 
```

小提琴：http: [//jsfiddle.net/m7f3F/](http://jsfiddle.net/m7f3F/)

# ruby-on-rails - OmniAuth 创建中的 DangerousAttributeError 由 ActiveRecord 定义

> ID：15137532
> 
> 赞同：1
> 
> 时间：2013-02-28T14:07:22.750
> 
> 标签：ruby-on-rails, database, ruby-on-rails-3, omniauth, railscasts

请参阅此页面，因为我有同样的问题：[OmniAuth Railscast 教程中的 DangerousAttributeError：create is defined by ActiveRecord](https://stackoverflow.com/questions/10221273/dangerousattributeerror-in-omniauth-railscast-tutorial-create-is-defined-by-act)

然而，对于 Rails 来说相当新，我不太确定如何从数据库中删除他们所说的字段。换句话说，该帖子中的任何地方都没有描述逐步简洁的方法。

下面的帖子实际上是一个适当的解决方案，但不清楚他在写时指的是什么：“rails g migration remove_silly_authentication_fields_which_should_not_be_there”不确定“silly_authentication_fields_which_should_not_be_there”到底是什么。

这是我所指的帖子：

> 因此，为了完成问题，您需要使用以下命令创建迁移：
> 
> rails g 迁移 remove_silly_authentication_fields_which_should_not_be_there
> 
> 看起来像这样：
> 
> 类 DropSillyControllerAttributes < ActiveRecord::Migration def change remove_column :authentications, :index remove_column :authentications, :create remove_column :authentications, :destroy end end
> 
> 并使用通常的方式运行它：
> 
> 耙分贝：迁移
> 
> 或者，您应该能够运行：
> 
> 耙分贝：回滚
> 
> 要回滚刚刚对数据库所做的更改，并且：
> 
> rails d 脚手架认证
> 
> 要删除所有文件，然后运行：
> 
> rails g 脚手架身份验证 user_id:integer provider:string uid:string
> 
> 并手动做其他事情
> 
> 顺便说一句，我自己也做了同样的事情。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T20:17:54.637

它告诉您创建迁移以删除有问题的字段，然后运行迁移

为了更清楚：

运行这个命令：

```
rails g migration drop_silly_controller_attributes 
```

该命令将在 /db/migratie/ 中创建一个带有时间戳和该名称的文件，例如：

```
2013121212312312_drop_silly_controller_attributes.rb 
```

打开该文件并将其修改为如下所示：

```
class DropSillyControllerAttributes < ActiveRecord::Migration
  def change
    remove_column :authentications, :index
    remove_column :authentications, :create
    remove_column :authentications, :destroy
  end
end 
```

然后你可以运行迁移：

```
rake db:migrate 
```

这很令人困惑，因为如果您使用“remove_silly_authentication_fields_which_should_not_be_there”生成迁移，则该类应该是 RemoveSillyAuthenticationFieldsWhichShouldNotBeThere，但随后会显示“DropSillyControllerAttributes”，因此您应该使用 drop_silly_controller_attributes 生成迁移以使其一致

# asp.net - ASP .NET 3.5 Web 表单的捆绑和缩小解决方案

> ID：15137538
> 
> 赞同：0
> 
> 时间：2013-02-28T14:07:37.150
> 
> 标签：asp.net, webforms

是否有可与 .NET Framework 3.5 和 ASP .NET Web Forms 3.5 一起使用的开箱即用捆绑（缩小也很好，但不是必需的）解决方案？或者也许是一个强大的项目呢？我在 System.Web.Optimization 中看到了一些解决方案，但它不适用于 3.5。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-09T13:09:46.617

是的，有一个名为“Andrew Davey”的名为**Cassette的图书馆**

[http://getcassette.net/](http://getcassette.net/)

旧版本的盒式磁带适用于 asp.net 3.5 网络表单

查看 v1 文档 - [http://getcassette.net/documentation/v1/](http://getcassette.net/documentation/v1/)

# mysql - mysql max（日期）不起作用

> ID：15137539
> 
> 赞同：1
> 
> 时间：2013-02-28T14:07:40.733
> 
> 标签：mysql, sql

所以我有这个查询，它应该返回一些信息，如价格、开盘价、收盘价等。对于最新的条目。

```
SELECT * FROM History WHERE symbol = $symbol Having max(`date`); 
```

但无论出于何种原因，它都没有返回正确的信息。出于某种原因，它认为最大日期是 2013 年 2 月 14 日，但如果我查看所有数据，最新的数据实际上是 2013 年 2 月 27 日。在这种特殊情况下

```
$symbol = "AGNC" 
```

max 函数在日期不起作用吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-28T14:10:33.927

我想你想要这样的东西。我不喜欢使用这个 using`ORDER BY`子句，因为有一些可能性（*尽管很少*）记录可能具有相同的最新`date`条目。

```
SELECT  *
FROM    History
WHERE   symbol = $symbol AND
        date = (SELECT MAX(date) FROM History) 
```

*   [SQLFiddle 演示](http://www.sqlfiddle.com/#!2/d65b8/1)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-28T14:29:15.123

我的建议是根本不使用`MAX`；如果您只想获取表中的最新条目，您可以尝试：

`SELECT * FROM History WHERE symbol = $symbol ORDER BY date DESC LIMIT 1;`

只要您的`date`字段实际上被声明为与日期相关的 MySQL 字段类型，例如`date`,`datetime`等，这就会完美地工作。

正如 JW 在他的回答中指出的那样，您可能希望在`ORDER BY`语句中添加更多字段以消除具有完全相同日期的记录的歧义。

`char`此外，如果这是一个字符串字段（ ,`varchar`等），您可能希望将 $symbol 放在引号中：

`SELECT * FROM History WHERE symbol = '$symbol' ORDER BY date DESC LIMIT 1;`

干杯!

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-28T15:58:21.240

以下应该做你想要的：

```
SELECT *
FROM History h
WHERE symbol = $symbol and
      `date` = (select max(`date`) from History where symbol = $symbol) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-28T16:37:01.653

您可以使用别名表名：

```
SELECT  *
FROM    History
WHERE   symbol = $symbol AND
date = (SELECT MAX(date) FROM History); 
```

# uml - 用例图 登录用例

> ID：15137547
> 
> 赞同：0
> 
> 时间：2013-02-28T14:08:20.240
> 
> 标签：uml, use-case

假设我有以下**演员**：

*   用户

假设我有以下**用例**：

*   登记
*   登录
*   完成人口统计调查
*   选择模块

我对如何正确建模 Log On 用例感到困惑。目前，我有一个图表，其中包含用户和登录之间的关系。

是否应该在每个用例（注册除外）中包含登录用例（包括关系），因为用户需要登录才能完成这些功能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T14:25:50.673

如果要求用户**作为**另一个用例的一部分登录（例如，如果用户尚未登录，则*完整的人口统计调查首先提示用户登录），那么是的（因为**登录*的常见行为就像执行子程序调用）。

另一方面，如果只**要求**用户登录（例如，如果他们没有登录，则操作被拒绝），那么它更像是一个先决条件而不是包含关系。

# java - 获取java中值最高的字符串（字符串具有相同的'base'名称但后缀不同）

> ID：15137549
> 
> 赞同：2
> 
> 时间：2013-02-28T14:08:22.093
> 
> 标签：java, string, comparison

我有一个包含一些字符串的列表：

```
GS_456.java
GS_456_V1.java
GS_456_V2.java
GS_460.java
GS_460_V1.java 
```

它还在继续。我想要一个包含最高值字符串的列表：

```
GS_456_V2.java
GS_460_V1.java
.
.
. 
```

我只是想使用大量的 for 语句......但是没有更实用的方法吗？我想避免使用太多的 for 语句......因为我在执行一些查询时经常使用它们......

编辑：带有 V1、V2、.... 的字符串是最近创建的类的名称。例如，当有人创建新版本的 GS_456 时，他们会这样做并将其版本添加到名称的末尾。

因此，GS_456_V2 是 GS_456 java 类的最新版本。它还在继续。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T14:17:02.587

我想你不想要简单的字典顺序（解决方案很明显）。

首先，删除“.java”部分并将字符串拆分为字符“_”。

```
int dotIndex = string.indexOf(".");
String []parts = split.substring(0, dotIndex).split("_"); 
```

您对部分[1] 和部分[2] 感兴趣。第一个很简单，只是一个数字。

```
int fileNumber = Integer.parseInt(parts[1]); 
```

第二个总是采用“VX”的形式，其中 X 是一个数字。但是这部分可能不存在（如果它是文件的基本版本）。在这种情况下，我们可以说版本为 0。

```
int versionNumber = parts.length < 2 ? 0 : Integer.parseInt(parts[2].substring(1)); 
```

现在您可以根据这两个数字进行比较。

为简单起见，基于此构建一个 FileIdentifier 类：

```
class FileIdentifier {
     int fileNumber;
     int versionNumber;
} 
```

然后是一个从文件名创建 FileIdentifier 的函数，其逻辑基于我之前解释的内容。

```
FileIdentifier getFileIdentifierFromFileName(String filename){ /* .... */ } 
```

然后在 String 上创建一个比较器，在其中获取两个字符串的 FileIdentifier 并在 FileIdentifier 成员上进行比较。

然后，要获得具有“最高值”的字符串，只需将所有字符串放在一个列表中，然后使用`Collections.sort`，提供比较器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T15:42:05.797

您需要分两步处理文件名。

第 1 步：将列表拆分为子列表，每个文件名有一个子列表（忽略后缀）。这是一个将列表拆分为 Map 的示例：

```
 private static Map> nameMap = new HashMap>();

    private static void splitEmUp(final List names)
    {
        for (String current : names)
        {
            List listaly;
            String[] splitaly = current.split("_|\\.");

            listaly = nameMap.get(splitaly[1]);
            if (listaly == null)
            {
                listaly = new LinkedList();
                nameMap.put(splitaly[1], listaly);
            }

            listaly.add(current);
        } 
```

第 2 步：找到每个名称的最高前缀。这是一个例子：

```
 private static List findEmAll()
    {
        List returnValue = new LinkedList();

        Set keySet = nameMap.keySet();
        for (String key : keySet)
        {
            List listaly = nameMap.get(key);
            String highValue = null;

            if (listaly.size() == 1)
            {
                highValue = listaly.get(0);
            }
            else
            {
                int highVersion = 0;

                for (String name : listaly)
                {
                    String[] versions = name.split("_V|\\.");

                    if (versions.length == 3)
                    {
                        int versionNumber = Integer.parseInt(versions[1]);
                        if (versionNumber > highVersion)
                        {
                            highValue = name;
                            highVersion = versionNumber;
                        }
                    }
                }
            }

            returnValue.add(highValue);
        }

        return returnValue;
    } 
```

# postgresql - 引用序列列（postgresql）

> ID：15137550
> 
> 赞同：3
> 
> 时间：2013-02-28T14:08:23.720
> 
> 标签：postgresql, reference, sequences

在创建引用序列的外键时遇到问题，请参见下面的代码示例。
但是在创建表时，我收到以下错误。
“详细信息：关键列“产品”和“id”的类型不兼容：整数和 ownseq”
我已经为产品列尝试了不同的数据类型（如 smallint、bigint），但它们都不被接受。

```
CREATE SEQUENCE ownseq INCREMENET BY 1 MINVALUE 100 MAXVALUE 99999;  
CREATE TABLE products (  
id ownseq PRIMARY KEY,  
...);

CREATE TABLE basket (
basket_id SERIAL PRIMARY KEY,
product INTEGER FOREIGN KEY REFERENCES products(id)); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-28T14:17:29.703

```
CREATE SEQUENCE ownseq INCREMENT BY 1 MINVALUE 100 MAXVALUE 99999;  
CREATE TABLE products (  
    id integer PRIMARY KEY default nextval('ownseq'),
    ...
);
alter sequence ownseq owned by products.id; 
```

关键的变化是`id`被定义为一个`integer`，而不是一个`ownseq`。如果您使用`SERIAL`伪类型创建序列，就会发生这种情况。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-28T14:24:34.593

尝试

```
 CREATE TABLE products (  
    id INTEGER DEFAULT nextval(('ownseq'::text)::regclass) NOT NULL PRIMARY KEY,  
    ...); 
```

或者不创建序列 ownseq 并让 postgres 为您完成：

```
 CREATE TABLE products (
    id SERIAL NOT NULL PRIMARY KEY
    ...); 
```

在上述情况下，postgres 的 create 序列的名称应该是`products_id_seq`.

希望这可以帮助。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-28T15:31:26.950

PostgreSQL 功能强大，您刚刚被一项高级功能所吸引。

您的 DDL 非常有效，但根本不是您认为的那样。

序列可以被认为是一个额外事务的简单表，用于为某些列生成下一个值。

**你打算做什么**

根据另一个答案，您打算这样定义 id 字段：

```
id integer PRIMARY KEY default nextval('ownseq'), 
```

**你做了什么**

您所做的实际上是为您的表定义一个嵌套数据结构。假设我创建了一个测试序列：

```
CREATE SEQUENCE testseq; 
```

然后假设我`\d testseq`在 Pg 9.1 上，我得到：

```
 Sequence "public.testseq"
    Column     |  Type   |        Value        
---------------+---------+---------------------
 sequence_name | name    | testseq
 last_value    | bigint  | 1
 start_value   | bigint  | 1
 increment_by  | bigint  | 1
 max_value     | bigint  | 9223372036854775807
 min_value     | bigint  | 1
 cache_value   | bigint  | 1
 log_cnt       | bigint  | 0
 is_cycled     | boolean | f
 is_called     | boolean | f 
```

这是序列使用的类型的定义。

现在假设我：

```
 create table seqtest (test testseq, id serial); 
```

我可以插入其中：

```
 INSERT INTO seqtest (id, test) values (default, '("testseq",3,4,1,133445,1,1,0,f,f)'); 
```

然后我可以从中选择：

```
select * from seqtest;
               test               | id 
----------------------------------+----
 (testseq,3,4,1,133445,1,1,0,f,f) |  2 
```

此外，我可以扩展测试：

```
SELECT (test).* from seqtest;

select (test).* from seqtest;
 sequence_name | last_value | start_value | increment_by | max_value | min_value
 | cache_value | log_cnt | is_cycled | is_called 
---------------+------------+-------------+--------------+-----------+----------
-+-------------+---------+-----------+-----------
               |            |             |              |           |          
 |             |         |           | 
 testseq       |          3 |           4 |            1 |    133445 |         1
 |           1 |       0 | f         | f
(2 rows) 
```

这种事情在 PostgreSQL 中实际上非常强大，但充满了意想不到的角落（例如，not null 和检查约束在嵌套数据类型中无法按预期工作）。我一般不推荐嵌套数据类型，但值得知道 PostgreSQL 可以做到这一点，并且很乐意接受 SQL 命令来做到这一点而不会发出警告。

# python - 以 Pythonic 方式将项目添加到列表中

> ID：15137554
> 
> 赞同：2
> 
> 时间：2013-02-28T14:08:29.523
> 
> 标签：python, list

我想知道是否有一种**更 Pythonic**的方式可以将元素添加到列表中，具体取决于（默认）索引。如果索引超出范围会发生什么。（我来自Java）

```
self.releases = []

def add_release(self, release, index=-1):

    list_length = len(self.releases)

    if index < 0:
        # add element at the end of the list
        self.releases.append(release)
    elif index < list_length:
        # add element at the given index
        self.releases.insert(index, release)
    else:
        # index is out of bound ~ what will happen when an element will be added at this index?
        pass 
```

提前致谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-28T14:13:01.907

将索引保留在`-1`，并改为捕获异常：

```
def add_release(self, release, index=-1):
    self.releases.insert(index, release) 
```

当您使用`.insert()`负索引时，该项目是相对于列表的长度插入的。越界索引被带回边界；插入超出长度与追加相同，在 0 索引之前插入插入 0 处。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-28T14:16:47.357

`List.append()`只接受一个参数 - 一个**附加**到列表的值。如果要在任意位置插入，则需要`List.insert()`，它将超出范围的位置参数视为对 的调用`append`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-28T14:13:10.587

试试看一下插入方法

```
a=[]
a.insert(index, value) 
```

如果**你确定你没有越界**，你也可以

```
a[index] = value 
```

请注意，如果有任何索引，它将覆盖给定索引处的值

# sql-server - 如何处理将 UTF-8 编码、代码页 = 65001 的文件导入 SQL 服务器

> ID：15137558
> 
> 赞同：6
> 
> 时间：2013-02-28T14:08:45.153
> 
> 标签：sql-server, powershell-2.0

在挪威，我们有 3 个非常烦人的角色 æøå，它们会制造各种问题。自 sql server 2008 以来，Microsoft 决定不支持代码页 65001。我找到了一个可管理的解决方案，可以解决使用 OPENROWSET(BULK) 将 UTF-8 文件导入 sql server 并保留 æøå 令牌的问题。

我创建了一个 powershell 脚本，它使用 StreamReader 和 StreamWriter 将文件从 UTF-8 转换为默认编码 ANSI。

```
$filename = "C:\Test\UTF8_file.txt"
$outfile = "C:\Test\ANSI_file.txt"
$reader = new-object System.IO.StreamReader($filename, [System.Text.Encoding]::GetEncoding(65001))
$stream = new-object System.IO.StreamWriter($outfile, $false, [System.Text.Encoding]::Default) 
```

我在同一过程中剥离了第一行的文件，即标题行。

```
$i=1
while(($line = $reader.ReadLine()) -ne $null) {
    if($i -gt 1) {
        $stream.WriteLine($line)
    }
    $i++
}
$reader.Close()
$stream.Close() 
```

然后我可以使用 OPENROWSET 将 ANSI 文件导入 sql server 并在此过程中操作数据。使用代码页 1252，它等于 danish_norwegian 排序规则。

```
 insert into SomeDatabase.dbo.SomeTable
SELECT [companynumber]
, case [role] when 'Styreformann' then 'Styreleder' when 'Styrets leder' then 'Styreleder' else rolle end as 'role'
, case [representant] when 'Y' then '1' else '0' end as 'representant'
, left((RIGHT('0000'+ CONVERT(VARCHAR,postnr),5)),4) end as 'postnr' 
, income*1000 as income
, null as person2id 
FROM OPENROWSET( BULK 'C:\Test\ANSI_file.txt', 
FORMATFILE = 'C:\Test\FormatBulkInsert_file.xml'
, CODEPAGE =1252
, ROWS_PER_BATCH = 50000    
) as v 
```

这种方法确保挪威代币正确显示。格式文件如下所示：

```
<?xml version="1.0"?>
<BCPFORMAT xmlns="http://schemas.microsoft.com/sqlserver/2004/bulkload/format" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <RECORD>
    <FIELD ID="1" xsi:type="CharTerm" TERMINATOR=';"' />
    <FIELD ID="2" xsi:type="CharTerm" TERMINATOR='";"' />
    <FIELD ID="3" xsi:type="CharTerm" TERMINATOR='";"' />
    <FIELD ID="4" xsi:type="CharTerm" TERMINATOR='";' />
    <FIELD ID="5" xsi:type="CharTerm" TERMINATOR=';' />
    <FIELD ID="6" xsi:type="CharTerm" TERMINATOR='\n' />
  </RECORD>
  <ROW>
    <COLUMN SOURCE="1" NAME="companynumber" xsi:type="SQLINT"/>
    <COLUMN SOURCE="2" NAME="role" xsi:type="SQLNVARCHAR"/>
    <COLUMN SOURCE="3" NAME="representant" xsi:type="SQLBIT"/>
    <COLUMN SOURCE="4" NAME="postnr" xsi:type="SQLNVARCHAR"/>
    <COLUMN SOURCE="5" NAME="income" xsi:type="SQLDECIMAL"/>
    <COLUMN SOURCE="6" NAME="person2id" xsi:type="SQLINT"/>
  </ROW>
</BCPFORMAT> 
```

希望这对其他人有帮助，因为在找到解决此问题的方法之前，我花了很多时间进行谷歌搜索。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T15:09:42.400

改为转换为 UTF16。那是 SQL Server 的本机 NCHAR 格式，并且允许 Unicode 值的完整表示。

要完成这项工作，您必须在格式文件中指定 SQLNCHAR 或 SQLNVARCHAR，并注意以下警告：

> 对于要使用 Unicode 字符数据文件的格式文件，所有输入字段都必须是 Unicode 文本字符串（即，固定大小或以字符结尾的 Unicode 字符串）。

*   [http://msdn.microsoft.com/en-us/library/ms178129.aspx](http://msdn.microsoft.com/en-us/library/ms178129.aspx)

另一种方法是将其加载为二进制数据并使用该`CONVERT`函数将其从转换`VARBINARY`为`NVARCHAR`（UTF-16），然后转换为所需的代码页为`VARCHAR`.

# javascript - 从掩码值创建正则表达式模式以验证邮政编码

> ID：15137563
> 
> 赞同：0
> 
> 时间：2013-02-28T14:08:58.837
> 
> 标签：javascript, jquery, regex

JS代码：

我正在使用以下代码对三个国家/地区 USA/BR/CA 进行邮政编码验证。

```
/*To Get ZipCodeRegex as per country */
function getZipRegEx(inputcountry) {
var returntext;
if (inputcountry == "USA") {
    returntext = /^\d{5}$/
}
else if (inputcountry == "CA") {
    returntext = /^[ABCEGHJKLMNPRSTVXYabceghjklmnprstvxy]{1}\d{1}[A-Za-z]{1} *\d{1}[A-Za-z]{1}\d{1}$/
}
else if (inputcountry == "BR") {
    returntext = /^([0-9]){5}([-])([0-9]){3}$/
}
return returntext; 
```

};

现在，客户已经更新了他们的代码并使用 MASK 插件作为输入文本框。掩码模式正在使用 data-mask 属性进行渲染。下面是为邮政编码输入控件渲染的 HTML。

```
<input type="text" name="zip" id="zip" value="" class="required" data-mask="99999" /> 
```

问题区域：现在有了最新的代码库，它们覆盖了 10 多个国家，每个国家/州都有不同的邮政编码模式。

那么，是否可以根据输入字段附带的掩码值生成正则表达式模式？这样，我不需要进行特定国家/地区的检查。

请提出一些实现方法来涵盖这种情况。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T14:24:42.127

MASK 插件已经在对输入的邮政编码执行客户端验证。这就是它的用途。使用 Javascript 使用您自己的客户端验证来复制它是没有意义的。

无论如何，客户端验证只是为用户提供便利（快速报告错误，以便用户在提交表单之前更正错误）；它从不保证有效输入，因为它很容易被规避。

如果要确保良好的输入，则必须在服务器端进行验证。

# regex - 如果长度超过 x，则返回一些中间部分？

> ID：15137564
> 
> 赞同：1
> 
> 时间：2013-02-28T14:08:58.393
> 
> 标签：regex

我目前正在使用这样的正则表达式`(.{12}$)|(^.{1,12}$)`- 类似于“*如果值是 1 到 12 长，则返回它们，否则返回最后的 12。* ”

我希望添加另一个子句，如果长度大于 16，我需要返回它的一个子集（具体来说，从第 5 个字符开始，返回 12）。

如何在同一个 RegEx 中执行此操作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T14:21:39.487

它似乎与

```
(?<=^.{4}).{12}|^.{1,12}$ 
```

这包含两个部分。第一个处理长度至少为 16 个字符的字符串。为此，它从第五个字符开始匹配（这就是它的`(?<=^.{4})`用途——确保前面正好有四个字符）。之后，必须至少有 12 个匹配的字符。

第二部分仅针对具有 1-12 个字符的字符串，匹配完整的字符串。

快速 PowerShell 测试：

```
PS> '12345','1234567890','abcdefghijklmnopqrst'|%{if($_-match'(?<=^.{4}).{12}|^.{1,12}$'){$Matches}}

Name                           Value
----                           -----
0                              12345
0                              1234567890
0                              efghijklmnop 
```

# mysql - PHPMyAdmin 上的 SQL 查询插入数据不起作用

> ID：15137569
> 
> 赞同：1
> 
> 时间：2013-02-28T14:09:04.793
> 
> 标签：mysql, phpmyadmin

以下是我的 SQL 查询：

*尝试 1*

```
INSERT INTO `product`(`productid`, `title`, `category`, `description`) 
VALUES (NULL,`iMac`,`Desktop`,`With its enhanced, big and beautiful display, the new Apple iMac M-D093-B/A 21.5 Desktop Computer renders your movies, photos, web pages and other graphics in truly jaw-dropping detail.`) 
```

*尝试 2*

```
INSERT INTO `product`(`productid`, `title`, `category`, `description`) 
VALUES(` `,`iMac`,`Desktop`,`With its enhanced, big and beautiful display, the new Apple iMac M-D093-B/A 21.5 Desktop Computer renders your movies, photos, web pages and other graphics in truly jaw-dropping detail.`) 
```

我不断收到以下错误：`MySQL returned an empty result set (i.e. zero rows). ( Query took 0.0003 sec )`

我不明白我在做什么错。这是我的列名列表

```
1  productid int(11)    
2  title varchar(100)
3  category varchar(100)
4  description varchar(2000) 
```

表名：产品

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-28T14:12:09.797

对于值，使用`'`字符，而不是这个字符：```（对不起，我必须找出如何在 Markdown 中将单个反引号放入内联代码块中......）

```
INSERT INTO `product`(`productid`, `title`, `category`, `description`) 
VALUES (NULL,'iMac','Desktop','With its enhanced, big and beautiful display, the new Apple iMac M-D093-B/A 21.5 Desktop Computer renders your movies, photos, web pages and other graphics in truly jaw-dropping detail.') 
```

这应该工作......[这是它的SQLfiddle](http://sqlfiddle.com/#!2/93df3/1)。

**编辑** 这是根据 zour 表定义的解决方案：

```
INSERT INTO `product`(`title`, `category`, `description`) 
VALUES ('iMac','Desktop','With its enhanced, big and beautiful display, the new Apple iMac M-D093-B/A 21.5 Desktop Computer renders your movies, photos, web pages and other graphics in truly jaw-dropping detail.') 
```

您有两件事忘记提及： *`productid`是`PRIMARY KEY`（因此，自动`NOT NULL`）列 - 在该列中带有 a 的任何插入`NULL`都将失败 *`productid`是一`AUTO_INCREMENT`列 - 您甚至不必将它包含在`INSERT`语句中，它每次插入一行时都会填充一个唯一值

[用于此的 SQL 小提琴](http://sqlfiddle.com/#!2/08fc1/1)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T14:12:23.793

您必须使用`'`每个`varchar`数据类型，因此在您的情况下：

```
INSERT INTO product(productid, title, category, description) VALUES 
(
    NULL,
    'iMac',
    'Desktop', 
    'With its enhanced, big and beautiful display, the new Apple iMac M-D093-B/A 21.5 Desktop Computer renders your movies, photos, web pages and other graphics in truly jaw-dropping detail.'
); 
```

# c# - 在服务器上分组的 EF 问题

> ID：15137571
> 
> 赞同：0
> 
> 时间：2013-02-28T14:09:08.807
> 
> 标签：c#, linq, entity-framework-5

我在使用实体框架进行分组时遇到了这个问题。

.Net：4.5，EF：5.0，数据库：Oracle

我的问题是当我在服务器上分组并取回数据时，分组数据（实体列表）一遍又一遍地返回所有分组数据的第一条记录 - 但组 KEY 是正确的。

如果我没有按预期按记录返回进行分组，但我有一些分组要求，我的解决方法是……是的，这不会让我感觉很好，代码应该可以工作……但事实并非如此。

xD = string rest 是整数/字符串混合。

这是不起作用的代码：

```
db.ENTITY_NAME
.Where(x =>
       wantedGs.Contains(x.G) &&
       wantedAs.Contains(x.A)
    )
.GroupBy(x => x.D)
.ToList()
.Select(x => x.FirstOrDefault())
.Select(x => new MyEntity
    {
        A = x.A,
        B = x.B,
        C = x.C,
        E = x.E,
        D = x.D,
        F = x.F,
        G = x.G
    })
.ToList(); 
```

这是我设法做我想做的解决方法：

```
db.ENTITY_NAME
.Where(x =>
       wantedGs.Contains(x.G) &&
       wantedAs.Contains(x.A)
    )
.Select(x => new
{
    x.A,
    x.B,
    x.C,
    x.D,
    x.E,
    x.F,
    x.G
})
.ToList()
.GroupBy(x => x.D)
.Select(x => x.FirstOrDefault())
.Select(x => new MyEntity
    {
        A = x.A,
        B = x.B,
        C = x.C,
        E = x.E,
        D = x.D,
        F = x.F,
        G = x.G
    })
.ToList(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-12T15:43:28.663

我发现 LINQPad 在诊断这类问题时很有用。查询 Oracle 表并从*Results*选项卡切换到*SQL*选项卡，请注意第一个示例如何生成一个初始 SQL `select`，然后是多个后续`select`语句，这些语句对于实现所需的正确分组没有用处。对我来说似乎是一个错误。

此问题似乎是特定于 Oracle 的（可能是特定的客户端版本）。Microsoft SQL Express 数据库上的类似`GroupBy`结果给出了正确的结果，尽管也有多个 SQL `select`。

`GroupBy`似乎我们在数据库连接上使用时需要小心；早期评估（例如转换为列表）可以更快更准确，以便我们从那时起使用 LINQ 来获取数据。

**更新复制案例：**

首先是 Oracle (9i) 表的创建和行插入：

```
create table payees (
   name varchar2(10),
   amount number(5));
insert into payees values ('JACK', 150);
insert into payees values ('BARRY', 100);
insert into payees values ('EMMA', 20);
insert into payees values ('FLAVIA', 15);
insert into payees values ('SYLVIA', 300);
commit; 
```

好的和坏的 LINQ 语句（使用 Oracle 9i 客户端）：

```
var good = Payees.ToList().GroupBy(p => p.Amount / 100);
var bad = Payees.GroupBy(p => p.Amount / 100); 
```

我期望使用智能 LINQ to Oracle 驱动程序的查询示例：

```
select trunc(amount/100) pay_category, name, amount
from payees
order by pay_category;

PAY_CATEGORY NAME           AMOUNT
------------ ---------- ----------
           0 EMMA               20
           0 FLAVIA             15
           1 JACK              150
           1 BARRY             100
           3 SYLVIA            300 
```

LINQPad 在 SQL 选项卡中报告的实际奇怪查询，导致根本没有有用的分组：

```
SELECT t0.AMOUNT
FROM GENSYS.PAYEES t0
GROUP BY t0.AMOUNT

SELECT t0.AMOUNT, t0.NAME
FROM GENSYS.PAYEES t0
WHERE ((t0.AMOUNT IS NULL AND :n0 IS NULL) OR (t0.AMOUNT = :n0))
-- n0 = [15]

SELECT t0.AMOUNT, t0.NAME
FROM GENSYS.PAYEES t0
WHERE ((t0.AMOUNT IS NULL AND :n0 IS NULL) OR (t0.AMOUNT = :n0))
-- n0 = [20]

SELECT t0.AMOUNT, t0.NAME
FROM GENSYS.PAYEES t0
WHERE ((t0.AMOUNT IS NULL AND :n0 IS NULL) OR (t0.AMOUNT = :n0))
-- n0 = [100]

SELECT t0.AMOUNT, t0.NAME
FROM GENSYS.PAYEES t0
WHERE ((t0.AMOUNT IS NULL AND :n0 IS NULL) OR (t0.AMOUNT = :n0))
-- n0 = [150]

SELECT t0.AMOUNT, t0.NAME
FROM GENSYS.PAYEES t0
WHERE ((t0.AMOUNT IS NULL AND :n0 IS NULL) OR (t0.AMOUNT = :n0))
-- n0 = [300] 
```

不过，我可能对 LINQ to SQL 期望过高。（我的 LINQPad 报告 LINQPad 驱动程序是 IQ V2.0.7.0，如果有帮助的话）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T14:26:01.917

如果这不起作用，请发布一些显示问题的示例数据

```
db.ENTITY_NAME
.Where(x =>
       wantedGs.Contains(x.G) &&
       wantedAs.Contains(x.A)
    )
.GroupBy(x => x.D)
.Select(x => x.FirstOrDefault())
.AsEnumerable()
.Select(x => new MyEntity
    {
        A = x.A,
        B = x.B,
        C = x.C,
        E = x.E,
        D = x.D,
        F = x.F,
        G = x.G
    })
.ToList(); 
```

# javascript - Do I always have to apply the "this" ( or "that" ) scope to all object properties in JavaScript?

> ID：15137572
> 
> 赞同：3
> 
> 时间：2013-02-28T14:09:13.330
> 
> 标签：javascript, oop, scope

I'm trying to write an application in JavaScript, which I've been using for bits of scripting in web pages for years, and I find my understanding of scope and object orientation is coming up somewhat short. My background is mostly in object oriented languages like C# and Ruby so JavaScript's weird pseudo object-oriented functional approach is confusing me no end.

What I'm having trouble with is `this` and why I seem to always need it in every reference to anything in my class. It just seems to result in an inordinate amount of typing in order to write much that is useful in JS and I can't help but feel I must be doing it wrong somehow:

```
function MyClass()
{ 
  var a=1;
  this.b = 2;

  this.internalMethod= function()
  {
   console.log("a is: "+a); // returns "a is: 1"
   // console.log("b is: "+b); - this fails because b is undefined
   console.log("this.a is: "+this.a); // returns "this.a is: undefined" but doesn't crash.
   console.log("this.b is: "+this.b); // returns "this.b is: 2"
 }

}

MyClass.prototype.externalMethod = function()
{
//     console.log("a is: "+a); - fails
//     console.log("b is: "+b); - fails
       console.log("this.a is: "+this.a);  // "this.a is: undefined"
       console.log("this.b is: "+this.b);  // "this.b is: 2"
}

var m = new MyClass();
m.internalMethod();
m.externalMethod(); 
```

What I am understanding from this is that if I am adding a new public method through the `class.prototype` approach, I only have access to properties that are defined with `this`.

If I create an internal method in the class definition function I have access to any `var` values in the class itself and I can access `this.property` as long as I include the `this`.

Is this correct? Do I always have to include an explicit object reference to access properties in any functions that use the `prototype` method? If so, should I be declaring all my functions within the parent class function rather than using the `class.prototype` pattern for adding them?

In essence I am looking for a standard approach to managing variable scope when writing object oriented Javascript. Most of the articles I can find on this topic are either basic introductions to object orientation or seem to gloss over this area. A lot of my classes are fairly data intensive and having to make calls in the form `this.myMethod( this.firstArray, this.secondArray, this.thirdArray, this.fourthArray )` seems like a long cut and impedes the readability of code.

(I am aware of the `var that=this` trick for avoiding caller scope problems but I didn't want to mess up my examples with it as as far as I know it's not really pertinent to my question.)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T14:20:29.933

> What I am understanding from this is that if I am adding a new public method through the `class.prototype` approach, I only have access to properties that are defined with `this`.
> 
> If I create an internal method in the class definition function I have access to any `var` values in the class itself and I can access `this.property` as long as I include the `this`.

There are no such things as "internal" and "external" properties, only "own" and "inherited" properties. In your example, `internalMethod` is directly assigned to the new object, while `externalMethod` is inherited from the prototype. They are not different or special in any way. Any two functions that are defined in different scopes are always different.

`internalMethod` has access to the local variables in the constructor because it is a closure.

> Do I always have to include an explicit object reference to access `properties` in any functions that use the prototype method?

It's important to understand that there is no implicit connection between functions and the objects "they are assigned" to. Functions are independent entities.

The connection is only determined at runtime, by setting `this` accordingly. So yes, you will need `this`, for **every** function, not only those assigned to the prototype. [Learn more about `this`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/this).

> If so, should I be declaring all my functions within the parent class function rather than using the `class.prototype` pattern for adding them?

This is extensively discussed here:

*   [Declaring javascript object method in constructor function vs. in prototype](https://stackoverflow.com/q/9772307/218196)
*   [Use of 'prototype' vs. 'this' in JavaScript?](https://stackoverflow.com/q/310870/218196)

> In essence I am looking for a standard approach to managing variable scope when writing object oriented Javascript.

My *subjective* advice:

Keep it simple. Don't try to simulate private variables/methods through local variables and closures. Initialize and assign *instance-specific* data in the constructor, and assign anything that should be shared between instances (such as methods) to the prototype. Use a naming convention, such as `this.privateProperty_` to indicate properties that should be accessed by external code.

> A lot of my classes are fairly data intensive and having to make calls in the form `this.myMethod( this.firstArray, this.secondArray, this.thirdArray, this.fourthArray )` seems like a long cut and impedes the readability of code.

In this example, `this` inside `myMethod` will refer to the object itself, so you can access `this.firstArray`, `this.secondArray`, etc, just in like that *inside* the function. You don t have to pass them.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-28T14:23:34.400

```
function MyClass()
{ 
  var a=1;
  this.b = 2;

  this.internalMethod= function()
  {
   console.log("a is: "+a); // returns "a is: 1"
   // console.log("b is: "+b); - this fails because b is undefined
   console.log("this.a is: "+this.a); // returns "this.a is: undefined" but doesn't crash.
   console.log("this.b is: "+this.b); // returns "this.b is: 2"
 }

} 
```

In that code, the first console.log will return the right value, because you declared the variable `a` and then declared the function, which grabs it's environment and saves it all into something called closure (this explanation might be a bit off), so what happens here, is that when you call `internalMethod`, that function in it's environment also has the definition of `a`. Which might be confusing, because when you do your second `console.log` your see "undefined", which is because the `a` variable is not an attribute of `this`, but rather just a global variable to the scope of your `internalMethod`.

```
MyClass.prototype.externalMethod = function()
{
//     console.log("a is: "+a); - fails
//     console.log("b is: "+b); - fails
       console.log("this.a is: "+this.a);  // "this.a is: undefined"
       console.log("this.b is: "+this.b);  // "this.b is: 2"
} 
```

In that code, `a` is not defined, becuase it didn't exist when you declared your method, but `this.b` does, because is part of the attributes of MyClass, which is what you're working on.

So, to summarize, you'll want to use the `this` keyword when adding or using internal attributes to your "class" (which you should not call class, since that doesn't exists here). It might be a pain, but it's the only way to reference internal attributes of your objects from within it's methods.

Additionally, you might find these two articles interesting to read, since they explain a bit about OOP techniques for JS and some common mistakes:

*   [http://www.commented-out.com/2012/06/12/javascript-oop-for-the-uninitiaded/](http://www.commented-out.com/2012/06/12/javascript-oop-for-the-uninitiaded/)
*   [http://www.commented-out.com/2012/05/28/javascript-youre-doing-it-wrong/](http://www.commented-out.com/2012/05/28/javascript-youre-doing-it-wrong/)

Let me know if you have more questions.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-28T14:23:49.683

JavaScript doesn't look up variables in an object, because it's not a classical inheritance language. It's more based on Scheme, with its lexical scope.

Your examples show 2 things:

*   `this` refers to the object being instantiated
*   `a` is just a variable

In the `internalMethod`, you're still in the constructor function. So you have access to the variables defined in the constructor (function scope and lexical scope). However, once you get out of the constructor, `a` is not reachable anymore.

`this.b` means that on the instantiated object, you attach the property `b`. It's basically the equivalent of this:

```
function Foo() {}
var foo = {
    b: ''
};
foo.constructor.prototype = Foo.prototype; 
```

Basically. Instantiating with `new` does a little bit more.

So if you want to access the instantiated object, you *have to* use `this`. If you just want to use the power of lexical scope, you can also play with simple variables and closures.

For example, this constructor will instantiate a new object every time it's called, and there is no `this`:

```
function Foo() {
    var a = 1;
    var b = 2;
    return {
        internalMethod: function() {
            return a;
        },

        incB: function() {
            return ++b;
        }
    };
}

var foo = Foo();
foo.internalMethod(); // 1
foo.incB(); // 3
foo.incB(); // 4

var bar = new Foo();
bar.incB(); // 3 
```

This pattern is called the "module pattern".

If you find limiting the use of an object, you can return an object by using a immediately-executed function (and thus having another scope to play with):

```
function Foo() {
    var a = 1;
    var b = 2;
    return function() {
        var c = 3;
        return {
            a: a,
            c: c
        };
    }();
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-28T15:39:33.413

> I seem to always need it in every reference to anything in my class. It just seems to result in an inordinate amount of typing in order to write much that is useful in JS

You're not doing it wrong. In my comment I referenced [**this answer**](https://stackoverflow.com/a/13214563/1615483) where I try to explain every stage of writing a constructor, after reading it you'll understand why it's not wrong to use `this`, however, *JavaScript* does provide another statement, [`with`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Statements/with) that you could use to reduce how much you need to type after a property is initialised.

```
function MyConstructor() {
    this.a = 1; // initialise properties with `this`
    this.b = 2;
    this.c = 3;
    this.d = 4;
}
MyConstructor.prototype = {};
MyConstructor.prototype.foobar = function() {
    var c = 5, e = null;
    with (this) { // `with` now means you can do `a` instead of `this.a`
        var d = 6;
        console.log(a, b, c, d, e);
        a = 0 - a; // in `this`, property gets set to property
        b = -2; // in `this`
        c = -c; // in `this`, var'd outside `with`, property gets set to property
        d = -d; // in `this`, var'd inside `with`, property gets set to var
        e = 100; // not in `this`, var'd, var gets set (not var'd => global set)
    }
};
x = new MyConstructor(); // new instance
console.log(x.a, x.b, x.c, x.d, x.e);
//  1  2  3  4 undefined -- undefined as no property `e`
x.foobar();
//  1  2  3  6      null -- 6 from var, null from `var e = null`
console.log(x.a, x.b, x.c, x.d, x.e);
// -1 -2 -3 -6 undefined -- undefined as still no property `e` 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-28T14:22:04.557

I suggest reading about the Javascript module pattern to learn about public / local attributes and scope.

`var` declares a variable that will be accessible in the current function and the inner ones. Any method / attribute attached to an object is said "public" as it can be accessed from anywhere. Local variables, 'trapped' in closures, are used to emulate private members.

Attaching public methods to the prototype is the best memory-efficient approach to reuse those methods on different instances. You could use closures as well in those prototype methods.

One thing to note: as closures emulate 'private' variables but not 'protected' ones, it makes inheritance quite tricky when you need it.

# javascript - 无法在谷歌地图中保存多边形

> ID：15137577
> 
> 赞同：1
> 
> 时间：2013-02-28T14:09:36.807
> 
> 标签：javascript, google-maps, jquery, google-maps-api-3

我有一个谷歌地图多边形对象：

```
var poly = new google.maps.Polygon({
  paths: [
    new google.maps.LatLng(25.774252, -80.190262),
    new google.maps.LatLng(18.466465, -66.118292),
    new google.maps.LatLng(32.321384, -64.75737)
  ]
}); 
```

我正在尝试通过 jquery 的 AJAX 将其发送到 MySQL db：

```
$.post("savePolygon.php", {polygon: poly}); 
```

我在控制台中收到此错误：

```
TypeError: Cannot call method 'lat' of undefined 
```

我看过其他一些关于保存多边形的帖子，他们都说要从多边形中提取 latLng 并将它们保存在数据库中。当我这样做时：

```
var latLngs = poly.getPath().getArray();
$.post("savePolygon.php", {polygon: latLngs}); 
```

我犯了同样的错误。数组的原型中似乎有一个名为“lat”的函数。我想知道如何准确地提取这些值并通过 AJAX 发送它们，以及为什么会出现此错误？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-28T19:54:23.257

使用[`google.maps.geometry.encoding.encodePath(`)](https://developers.google.com/maps/documentation/javascript/reference?hl=en#encoding)对路径进行编码。此方法返回一个字符串，非常适合存储到数据库中。为了重用，使用解码字符串 `google.maps.geometry.encoding.decodePath()`

请注意：geometry-library 默认不加载，您必须通过附加`&libraries=geometry`到 maps-API-script 的 src 来加载它。

解释为什么不能直接存储路径（例如 JSON）：
当存储包含 LatLng 的路径（数组）时，您将丢失 LatLng 的原型，这是必不可少的，因为它定义了检索方法属性（`lat()`和`lng()`）

# c# - 阅读被鼠标拖动的项目

> ID：15137579
> 
> 赞同：3
> 
> 时间：2013-02-28T14:09:39.313
> 
> 标签：c#, c++, winapi, drag-and-drop

我想知道他们是否有任何方法可以查看鼠标当前正在拖动什么。我的意思不是winforms，因为我可以处理事件并以这种方式获取它，但是有没有人能够调用一些win api来读取对象或有关它的信息？

我正在尝试“监视”（可能不是最好的单词选择）光标并查看被拖动的内容，然后可能读取该对象。

C# / C++ 想法都欢迎！

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T15:31:26.593

通过设计实现此目的的一种方法是通过挂钩将代码注入所有应用程序。

*   使用 Hooks (Windows)： http: [//msdn.microsoft.com/en-us/library/windows/desktop/ms644960 (v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/ms644960(v=vs.85).aspx)

这将允许您检测何时发生拖动，并且您可以使用应用程序本身可以使用的标准 Windows API 来找出正在拖动的内容。

*   SetWindowsHookEx： http: [//msdn.microsoft.com/en-us/library/windows/desktop/ms644990 (v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/ms644990(v=vs.85).aspx)

第二种方法是使用 Windows UI 自动化。这不会为您提供应用程序所看到的确切内容，或者让您访问被拖放的确切数据，但它可能会为您提供足够的信息来满足您的任何目的。

*   拖放的 UI 自动化支持：http: [//msdn.microsoft.com/en-us/library/windows/desktop/hh707386 (v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/hh707386(v=vs.85).aspx)

尝试使用 UISpy 或 Inspect.exe 查看 UI 自动化事件。

*   [https://stackoverflow.com/questions/1848721/where-do-i-get-ui-spy](https://stackoverflow.com/questions/1848721/where-do-i-get-ui-spy)

# c++ - 是否在类似于列表和 unordered_maps 的 boost 或 stl 线程安全容器中？

> ID：15137581
> 
> 赞同：2
> 
> 时间：2013-02-28T14:09:50.483
> 
> 标签：c++, boost, stl

我在程序中使用 stl 和 boost 容器。我添加了线程，所以我想知道是在类似于列表和 unordered_maps 的 boost 或 stl 线程安全容器中吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-28T14:12:55.397

在最新的 boost 版本中添加了[无锁](http://www.boost.org/doc/libs/1_53_0/doc/html/lockfree.html)容器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-10-20T08:49:34.787

截至今天，Boost 的 Lockfree 框架不提供线程安全的无序映射或线程安全（和无锁）向量，类似于您可以在 Threadings Building Block API 中找到的向量。

# wpf - Snoop 看不到我的应用程序的子窗口

> ID：15137582
> 
> 赞同：16
> 
> 时间：2013-02-28T14:09:57.700
> 
> 标签：wpf, windows, snoop

当我运行 Snoop 2.8 时，它会看到我的程序的主窗口并将其列在`ComboBox`. 但是，我的程序会创建一个子窗口，通过调用`ChildWindow.Show()`. 无论我做什么，我都无法窥探那个子窗口。如果我刷新窗口列表，它不会出现。如果我将双筒望远镜旁边的小十字线图标拖到子窗口上方，就会出现主窗口。

如何窥探我的应用程序的子窗口？

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2013-02-28T14:36:11.963

当我使用 Snoop 时，我总是先启动 snoop，然后使用“shift+control”快捷键专注于我想要的东西。即使我对子窗口执行此操作，这似乎也有效。所以试试这个：

1.  启动应用程序，打开子窗口
2.  运行 Snoop
3.  窥探应用程序中的任何窗口
4.  专注于您的子窗口（单击窗口的标题栏）
5.  将鼠标移到要检查的内容上，同时按住 Shift 和 Control 键
6.  您的应用程序中会出现一个红色轮廓，您应该会看到 Snoop 在树中显示/选择有问题的元素。如果您查看左侧的可视化树，您现在将看到子窗口是树的父窗口。

该解决方案最后在 Snoop 2.8 中进行了测试。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-28T15:55:39.420

您是否曾经寻找过 WPF Inspector？我总是使用它而不是 snoop 并且从未对子窗口有任何问题......

[http://wpfinspector.codeplex.com/](http://wpfinspector.codeplex.com/)

# grails - Grails：UrlMapping 测试失败：“不匹配任何映射”

> ID：15137583
> 
> 赞同：1
> 
> 时间：2013-02-28T14:10:02.730
> 
> 标签：grails

我正在研究 Grails 框架并开发应用程序。

目前我有一个包含多个插件的主应用程序。

所以层次结构是这样的：

*   我的主应用程序
    *   我的第一个插件
    *   我的第二插件
    *   ...

我想为我的插件编写 UrlMappings 测试。我写了文档，我可能遗漏了一些东西，但我无法通过那些 f* *****测试。我总是抓住错误

> java.lang.IllegalArgumentException: url '/bar' 不匹配任何映射

这是我的 FooUrlMappings 类

```
class FooUrlMappings {
    static mappings = {

        "/bar/"(controller: 'foo', action: 'show')
    }
} 
```

请注意，我的 FooUrlMappings 类位于 /conf 目录中的默认包中。

现在我的控制器 FooController 的代码：

```
package be.arexo.ehr.employee.rest 
```

导入 be.arexo.ehr.employee.Employee 导入 grails.converters.JSON

```
class FooController {

    // GET /bar/
    def show() {
        def result = Bar.list()

        render result as JSON
    }
} 
```

所以现在，我的测试课：

```
import com.example.FooController
import grails.test.mixin.Mock
import grails.test.mixin.TestFor
import grails.test.mixin.web.UrlMappingsUnitTestMixin

@TestFor(FooUrlMappings)
@Mock(FooController)
class FooUrlMappingsTests {

    void testBarShow(){
        assertForwardUrlMapping("/bar/", controller : "foo", action : "show")
    }
} 
```

我的测试也在 test/integration 目录的默认包中。

所以我认为我做了文档中所说的。如果我尝试运行此测试，我将得到：

> java.lang.IllegalArgumentException: url '/bar' 不匹配任何映射

我的错误在哪里？有人能帮助我吗 ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-02T22:24:21.133

您应该将 URL 映射测试作为单元测试运行，而不是作为集成测试。这将解决您的问题。

> @TestFor(FooUrlMappings)

请注意，TestFor 注解只能在单元测试中使用。

> 我的测试也在 test/integration 目录的默认包中。

将您的测试移动到 test/unit/ 目录。

# jquery - 从另一个页面获取 H1

> ID：15137588
> 
> 赞同：0
> 
> 时间：2013-02-28T14:10:12.810
> 
> 标签：jquery

我想即时制作一个内容页面，

我可以在说页面 001.html 和 002.html 上定位一个 h1 标签并使用 jquery 在 content.html 上显示它吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-28T14:11:48.787

是的。

```
$('#result').load('001.html h1'); 
```

其中`h1`是一个选择器，它将选择您的标题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-28T14:14:46.647

内容.html

```
<div id="target"></div>

<script src=//jquery.min.js"></script>
<script type="text/javascript">
  $.get('001.html', function(html){
    $('#target').text($('h1',html).text());
  });
</script> 
```

where是内容页面中`#target`具有 id 的元素，并且是一个选择器，用于定位您在 001.html 页面上的目标。`target``h1``<h1>`

# eclipse - jsch 认为它缺课了

> ID：15137590
> 
> 赞同：0
> 
> 时间：2013-02-28T14:10:17.767
> 
> 标签：eclipse, ubuntu, ant, jsch

尝试在 Ubuntu 下的 Eclipse 中将 jsch 与 Ant 一起使用时，出现“无法加载依赖类 com/jcraft/jsch/Logger”。

jar 和 Eclipse 项目资源管理器都声称该类存在于 jar 文件中。

我在这个问题上的谷歌搜索说损坏的 jar 文件是可能的原因，但这似乎不是这里的问题。

如果使用 jsch 出现其他错误，是否会显示此错误消息？

# linux - Linux解压保存案例？

> ID：15137593
> 
> 赞同：0
> 
> 时间：2013-02-28T14:10:22.797
> 
> 标签：linux, web, zip, gzip, tar

在网站上工作。许多第三方 javascript 库在其文件和文件夹中使用大小写混合。

我正在使用 Windows 系统。

当准备好从我的本地 Windows XAMPP 环境上传到我的 linux 主机时，我使用 7zip 创建我的站点的 zip 文件。我使用 7zip 的 -xr！跳过某些目录的功能，例如我的 .git 存储库。

我将生成的 .zip 文件通过 FTP 传输到我的服务器，并使用服务器的“解压缩”功能将其分解。我所有的文件都在那里，但*它们都变成了小写！*

这会杀死网站，因为不再找到混合大小写的第三方库。

我试过 unzip -C 但这似乎没有做任何事情。

我还在上传之前查看存档，在 Windows 上，所有文件名大小写都被保留。

尝试使用 GNU32 的 windows tar 但 --exclude 功能不允许我跳过 .git 目录。

我需要以下形式的帮助：

*   如何在 linux 中使用 unzip 以保留大小写（谷歌搜索直到无毛，但没有找到爱......）
*   如何在 Windows 上使用 tar 以排除特定目录
*   如何使用其他东西来实现我的目标。老实说，我不在乎它是什么......我现在正在下载 CYGWIN 看看它是否会有所帮助。我最终可能会在虚拟机中安装 Linux，只是为了从实际运行 linux 的虚拟机中尝试 tar-gz，但每次我想打包一个非常简单的存档时，我真的宁愿避免这种麻烦。

Zip 适用于包装，但拆包不符合犹太教规。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T14:15:08.367

Use tar's `--exclude-vcs` option:

```
--exclude-vcs
    exclude version control system directories 
```

Example:

```
tar --exclude-vcs czf foo.tar.gz foo 
```

or for a *.tar.bz2 archive

```
tar --exclude-vcs cjf foo.tar.bz2 foo 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-03T12:28:36.090

试试`unzip -U file.zip`；如果您有旧版本的`unzip`. 否则，发布 和 的`unzip -v`输出`unzip -l file.zip`。

# c# - Windows 8 Metro 应用程序的 Twitter API 资源

> ID：15137594
> 
> 赞同：2
> 
> 时间：2013-02-28T14:10:23.070
> 
> 标签：c#, api, twitter, windows-8

我正在开发一个使用 Twitter API 来收集用户信息的应用程序。我在当前项目中使用 linqToTwitter，但它不允许我做很多我想做的事情。

例如，我需要获取搜索用户的关注者列表。LinqToTwitter 允许我找到一个用户，该用户的名字是给定的，并且他在经过身份验证的用户的关注者列表中。代码如下：

```
 public List<User> RecupererFollower()
        {
            var friendship =
                (from friend in MainPage.twitterCtxProp.Friendship
                where friend.Type == FriendshipType.FollowersList
                && friend.SourceScreenName==MainPage.texte
                select friend).ToList();

            Followers = (from friend in friendship
                         select new User                                      //Un utilisateur est créé grâce aux données récupérées précédemment.
                         {
                             Name = friend.ScreenName

                         }).ToList();                                         //Cette partie constitue la liste de tweets récupérés précédemment.

            return Followers;
        } 
```

但即使这样也不起作用，因为此查询需要特定用户的特定屏幕名称。

我不想要这个我想要更通用的功能。

我能做些什么？有人知道 Windows 8 Metro 应用程序的其他资源吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T18:46:59.570

@millimoose 评论“API 客户端库可能只会让您访问 API 本身”非常准确。您尝试使用的特定查询记录在[处理友谊](http://linqtotwitter.codeplex.com/wikipage?title=Showing%20Followers&referringTitle=Handling%20Friendships)中。该文档还引用了它支持的原始 Twitter 端点，在本例中为[关注者列表。](https://dev.twitter.com/docs/api/1.1/get/followers/list)在这个特定的 API 上，Twitter 文档声明 user_id 或 screen_name 是必需的。库不能支持超过可用的。

也就是说，你必须看看有什么可用的，有时可以实现你的目标。ie 还有一些社交图查询非常有效，因为它们返回用户 ID。使用这些用户 ID，您可以执行[UserType.Lookup](http://linqtotwitter.codeplex.com/wikipage?title=Querying%20User%20Details&referringTitle=Getting%20User%20Information)查询来一次收集多个用户。以下是 UserType.Lookup 查询的一些链接：

[使用 LINQ to Twitter 获取所有关注者](https://stackoverflow.com/questions/11224285/get-all-followers-using-linq-to-twitter/11237189#11237189)

[如何从多个朋友那里获取推文？](https://stackoverflow.com/questions/11135836/how-to-get-tweets-from-a-multiple-of-friends/11219427#11219427)

# string - 批处理文件字符串连接

> ID：15137598
> 
> 赞同：2
> 
> 时间：2013-02-28T14:10:45.630
> 
> 标签：string, batch-file

为什么这个字符串不连接？

```
@echo off
set NUM_NODES=4
set ENSEMBLE=127.0.0.1:2181

for /l %%x in (2, 1, %NUM_NODES%) do (
    echo %%x
   set ENSEMBLE=%ENSEMBLE%,127.0.0.1:2%%x81
)
echo ensemble: %ENSEMBLES% 
```

输出：

```
2
3
4
ensemble: 127.0.0.1:2181,127.0.0.1:2481 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-28T14:13:34.037

因为在批处理文件中，变量是在*解析*命令时展开的，而不是在它执行之前。如果你想要后一种行为，你需要使用延迟扩展：

```
setlocal enabledelayedexpansion
@echo off
set NUM_NODES=4
set ENSEMBLE=127.0.0.1:2181

for /l %%x in (2, 1, %NUM_NODES%) do (
    echo %%x
   set ENSEMBLE=!ENSEMBLE!,127.0.0.1:2%%x81
)
echo ensemble: %ENSEMBLES% 
```

`help set`包含冗长的描述和您的示例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-21T21:51:14.700

原始示例和答案都包含相同的拼写错误，在 ECHO 语句中的变量末尾添加了一个 S，因此两个示例都不会从变量中产生任何输出。

# jquery - 错误'无法使用 jquery.rating 设置属性'已检查'未定义'

> ID：15137600
> 
> 赞同：1
> 
> 时间：2013-02-28T14:10:46.010
> 
> 标签：jquery, jquery-plugins

我正在尝试将 jquery.rating 合并到一个表单中，但是当我按下“擦除”按钮时出现错误，我不确定这是一个错误还是我做错了什么。我正在使用最新版本。

此代码重现了错误（确保下载[jquery.rating](http://www.fyneworks.com/jquery/star-rating/)的 .zip 文件并将其展开到名为“starrate”的文件夹中）：

```
<!DOCTYPE HTML>
<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

</head>

<body>

<script src='starrate/jquery.js' type="text/javascript" language="javascript"></script>

<script src='starrate/jquery.MetaData.js' type="text/javascript" language="javascript"></script>
<script src='starrate/jquery.rating.js' type="text/javascript" language="javascript"></script>
<link href='starrate/jquery.rating.css' type="text/css" rel="stylesheet" />

<form action="#" method="post" class="stdform" id="ratingform">

<input type="radio" class="starrate" name="the_rating" value="1" id="rate1" title="choice 1" />
<input type="radio" class="starrate" name="the_rating" value="2" id="rate2" title="choice 2" /> 
<input type="radio" class="starrate" name="the_rating" value="3" id="rate3" title="choice 3" checked="checked" /> 
<input type="radio" class="starrate" name="the_rating" value="4" id="rate4" title="choice 4" /> 
<input type="radio" class="starrate" name="the_rating" value="5" id="rate5" title="choice 5" />

<span id="choice" style="margin:0 0 0 20px;">choice 0</span>

</form>

<script type="text/javascript">
    $(function () {
        $('#ratingform input:radio[name="the_rating"]').rating({
            focus: function(value, link){
                var tip = $('#choice');
                tip[0].data = tip[0].data || tip.html();
                tip.html(link.title || 'value: '+value);
            },
            blur: function(value, link){
                if ( !this.checked ) {
                    var tip = $('#choice');
                    $('#choice').html(tip[0].data || '');
                }
            }, 
            callback: function(value, link){
            }
        });
    });
</script>

</body>

</html> 
```

一切正常，除非我按下星星左侧的“删除”按钮。在 Crome 我得到`Cannot set property 'checked' of undefined`，在 IE9 中我得到一个荷兰语错误消息，意思大致相同（SCRIPT5007：Kan de waarde van de eigenschap 检查了 niet instellen：het object is null of niet gedefinieerd）。

它们都指向 jquery.rating.js 中的同一行代码，即“$(input)[0].checked=true;”。这是一段代码：

```
[...]
        // Update rating control state
        this.data('rating', control);
        // Update display
        this.rating('draw');
        // find data for event
        var input = $( control.current ? control.current.data('rating.input') : null );
        // change selection - required since 1.9, see http://code.google.com/p/jquery-star-rating-plugin/issues/detail?id=123
ERROR:      $(input)[0].checked=true; 
```

有人知道这里发生了什么吗？

# asp.net - AjaxToolKit 中的自动完成

> ID：15137604
> 
> 赞同：0
> 
> 时间：2013-02-28T14:11:17.157
> 
> 标签：asp.net, ajax

我想使用`AjaxToolKit` `AutoComplete`功能。标签的语法是：

```
<ajaxToolkit:AutoCompleteExtender ID="autoComplete1" runat="server"
  EnableCaching="true"
  BehaviorID="AutoCompleteEx"
  MinimumPrefixLength="2"
  TargetControlID="myTextBox"
  ServicePath="AutoComplete.asmx"
  ServiceMethod="GetCompletionList" 
  CompletionInterval="1000"  
  CompletionSetCount="20"
  CompletionListCssClass="autocomplete_completionListElement"
  CompletionListItemCssClass="autocomplete_listItem"
  CompletionListHighlightedItemCssClass="autocomplete_highlightedListItem"
  DelimiterCharacters=";, :"
  ShowOnlyCurrentWordInCompletionListItem="true">
  <!-- Some formatting code -->
</ajaxToolkit:AutoCompleteExtender> 
```

有属性 ServicePath 和 ServiceMethod 可以帮助标签从中获取数据。ServiceMethod 具有架构：

```
[WebMethod]
public string[] GetCompletionList(string prefixText, int count) 
```

该方法只需要两个参数。对于某些业务逻辑要求，我想将三个参数发送到方法：

```
[WebMethod]
public string[] GetCompletionList(string type, string prefixText, int count) 
```

如何传递这第三个参数并在服务方法中接受它进行处理。我的结果将取决于此类型参数。我怎样才能做到这一点？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-10-17T22:50:19.590

您可以将 contextKey 作为第三个参数传递。

在设置 ajaxToolkit:AutoCompleteExtender 时，添加键值对 UseContextKey="True"，例如

```
<ajaxToolkit:AutoCompleteExtender ID="autoComplete1" runat="server"
  UseContextKey="True"
  EnableCaching="true"
  BehaviorID="AutoCompleteEx"
  MinimumPrefixLength="2"
  TargetControlID="myTextBox"
  ServicePath="AutoComplete.asmx"
  ServiceMethod="GetCompletionList" 
  CompletionInterval="1000"  
  CompletionSetCount="20"
  CompletionListCssClass="autocomplete_completionListElement"
  CompletionListItemCssClass="autocomplete_listItem"
  CompletionListHighlightedItemCssClass="autocomplete_highlightedListItem"
  DelimiterCharacters=";, :"
  ShowOnlyCurrentWordInCompletionListItem="true">
  <!-- Some formatting code -->
</ajaxToolkit:AutoCompleteExtender> 
```

在调用服务方法之前将上下文设置为您想要的任何字符串：

```
function setContextKey() {
    text = 'my type information';
    $find('<%=autoComplete1.ClientID%>').set_contextKey(text);
} 
```

然后在后面的代码中，您可以访问该 contextKey：

```
[System.Web.Services.WebMethodAttribute(), System.Web.Script.Services.ScriptMethodAttribute()]
public static string[] GetCompletionList(string prefixText, int count, string contextKey)
{
    string myType = contextKey;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T14:15:11.493

您不能添加第三个参数。但是您可以通过存储然后从`Session`或检索它来读取此参数信息`Request`，通过从 访问它们`HttpContext.Current`，因为您处于静态方法中。

# asp.net - Ajax 计时器、更新面板和中继器

> ID：15137608
> 
> 赞同：0
> 
> 时间：2013-02-28T14:11:34.310
> 
> 标签：asp.net, ajax, timer, updatepanel, repeater

我在带有中继器的页面上使用计时器时遇到问题。
我的页面基本上是这样的：（没有写下所有的标签和其他不重要的东西，页面很大）

```
<asp:Timer runat="server" Interval="5000" OnTick="UpdateTimer_Tick" ID="UpdateTimer" />
<UpdatePanel 1>
<dropdownlist/>
<Panel 1>
    <TextBox/><Button/>
</Panel 1>

<Repeater 1> //Bound to a list in code behind
    <Checkbox/><textbox/>
</Repeater 1>
<Button/>

<Repeater 2> //Bound to a list in code behind
    <button/><button/>
</Repeater 2>

<Repeater 3> //Bound to a dataset in code behind
    <textbox/><button/><button/>
</Repeater 3>
<button/><button/><button/>
</UpdatePanel 1>
<panel 2>
   //Jscript stuff that doesn't change anything to my current problem.
</panel 2>
<UpdatePanel 2>
    <Image/>
</UpdatePanel 2> 
```

在我的页面中，我正在尝试添加一个 5000 毫秒滴答的计时器。OnTick 事件需要调用我的 BindRepeater2 方法，因为我只想重新加载转发器以显示更新的信息。
我尝试将计时器放置在 updatePanel 之前、内部、之后、面板 1 中、面板 2 中、中继器中。我尝试为每个中继器设置多个 updatePanel，我尝试将面板放置在任何地方……我得到的最好结果是面板 1 中的文本框不会丢失其中的信息。UpdatePanel2 中的图像总是消失（因为我在 pageLoad 上绑定过一次，如果不是回发），repeater1 中的文本框总是会自行重置。最重要的是，当我浏览下拉列表时，OnTick 事件会失去对文本框和左键的关注。

我不知道如何解决这个问题。

编辑：我发现我可以使用 ajax 来构建我的转发器。但我不知道该怎么做。任何人都可以解释我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T15:05:40.930

添加**UpdateMode="Conditional"**属性到您的 UpdatePanel 和绑定中继器集后的 OnTick 事件`UpdatePanel1.update();`

* * *

**OnTick 事件**

```
protected void Timer1_Tick(object sender, EventArgs e)
    {
        BindRepeater();
        UpdatePanel1.update();
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T16:59:43.807

在调整了我的页面之后，我最终得到了这个。

```
<asp:Timer runat="server" Interval="5000" OnTick="UpdateTimer_Tick" ID="UpdateTimer" />
<UpdatePanel1 UpdateMode="Conditional">
<dropdownlist/>
<Panel 1>
    <TextBox/><Button/>
</Panel 1>
<Repeater 1> //Bound to a list in code behind
    <Checkbox/><textbox/>
</Repeater 1>
<Button/>
</UpdatePanel1>

<UpdatePanel2 UpdateMode="Conditional">
<Repeater 2> //Bound to a list in code behind
    <button/><button/>
</Repeater 2>
</UpdatePanel2>

<UpdatePanel3 UpdateMode="Conditional">
<Repeater 3> //Bound to a dataset in code behind
    <textbox/><button/><button/>
</Repeater 3>
<button/><button/><button/>
</UpdatePanel3>

<UpdatePanel4 UpdateMode="Conditional">
<panel 2>
   //Stuff
</panel 2>
    <Image/>
</UpdatePanel4> 
```

在后面的代码中使用

```
protected void Timer1_Tick(object sender, EventArgs e) 
{ BindRepeater(); UpdatePanel2.Update(); } 
```

# sql - 更多的表或更多的行在 sql 中更好？

> ID：15137610
> 
> 赞同：0
> 
> 时间：2013-02-28T14:11:35.597
> 
> 标签：sql, sql-server, sql-server-2005

实际上我正在为学术机构构建一个软件，所以我只想知道几个问题的答案：

如您所知，每年都会生成一些新数据（针对新招生），并且一些数据会升级。所以我应该将所有数据存储在一个具有学年分隔的表中（作为 ac_year 之类的列），或者我应该为每年制作单独的表。此外，还有不同的表格来存储有关学生的课程、分数、费用、宿舍等信息。因此，每个信息（例如费用）都将存储在不同的表中，例如 Fee-2010 Fee-2011 Fee-2012 ...

或在以年份为列的 1 个单一费用表中。

还有一点是，在 1-2 年后数据库会变得更重，因此可以在单个表中备份一年的数据（例如以年为列的费用）？

请记住 SQL Server 2005。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T14:28:51.903

当您提出问题时，答案显然是将数据存储在一个表中，将年份（或日期或其他信息）作为一列。这是正确的做法。随着时间的推移，您正在与同一个实体打交道。

一个例外是当领域从一年到下一年发生显着变化时。我怀疑你的桌子就是这种情况。

如果您的数据库真的越来越大，那么您可以考虑按时间对表进行分区。每个分区将是一年的数据。这将加快只需要访问一年价值的查询。它还有助于备份和恢复数据。这可能是您最终要寻找的解决方案。

“真正变大”意味着表中至少有数百万行。即使表中有几百万行，大多数查询也可能在具有适当索引的体面硬件上运行良好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T14:14:27.350

It's not typical to store the data in multiple tables based on time constraints. I would prefer to store it all in one table. In the future, you may look to archiving old data, but it will still be significant time before performance will become an issue.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-28T14:21:46.413

向实体添加新属性总是比为每个不同的属性创建一个新实体更好。这样维护和查询对您来说会容易得多。在查询的性能部分，您不必担心数据和数据库的内部事务。如果出现真正的性能问题，有许多解决方案，例如在您的情况下多年创建索引。

# javascript - 从js文件调用函数到html页面

> ID：15137611
> 
> 赞同：6
> 
> 时间：2013-02-28T14:11:38.477
> 
> 标签：javascript, jquery, html

我的所有网页都有三个 js 文件，并且我有预定义的函数集来调用每个网页。我可以将所有这些函数移动到一个新的 js 文件中，然后调用另一个 js 文件中的其他函数吗？[我在http://code.google.com/p/rloader/](http://code.google.com/p/rloader/)阅读了有关 rloader 的信息，但我不确定是否可以使用它。

```
<script src="js/rootNameSpace.js"></script>
<script src="js/jquery-min.js"></script>
<script src="js/ui.js"></script>
<script src="js/form.js"></script>

<script type="text/javascript">
    console.dir(com);
    com.rela.form.helloWorld1();
    com.rela.form.helloWorld2();
</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T14:14:32.227

是的。如果将脚本标记的内容移动到路径为“js/main.js”的文件中，然后添加脚本

```
<script src="js/main.js"></script> 
```

在其他脚本之后，它将能够调用函数。包含一个外部脚本相当于将该脚本中的文本内联到文件中。

脚本可以读取先前脚本的内容，因此页面上有多个脚本类似于将它们全部连接到一个文件中，这意味着如果您在其他脚本下方添加一个脚本，它将能够“看到”其他脚本中的所有内容

### 关于rloader的问题

rloader 会在需要时进行延迟加载以拉入脚本。

有关[延迟加载的更多信息，您可以](https://stackoverflow.com/questions/36274/what-is-lazy-loading)[从其网站](http://code.google.com/p/rloader/) 了解rloader （我不是这方面的专家）

如果您真的在一页上只有 4 个脚本，那么我不建议您使用 rloader。它的矫枉过正。如果您打算拥有一个更大的项目，那么您可以使用它或更流行的[requirejs](http://requirejs.org/)来跨页面管理您的脚本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T14:22:35.113

将代码放在单独的文件中总是更好（只要它们的大小和数量较少）。**这将允许浏览器缓存**$(document).ready 将使您对其他未加载的 dom 元素保持安全。

创建这样的东西：

```
<script src="js/rootNameSpace.js"></script>
<script src="js/jquery-min.js"></script>
<script src="js/ui.js"></script>
<script src="js/form.js"></script>

<script src="js/pages/some-page.js"></script> 
```

**一些页面.js**

```
$(document).ready(function(){
    console.dir(com);
    //call to function form.helloWorld1 
    com.relais.form.helloWorld1();
    com.relais.form.helloWorld2();
}); 
```

更好的选择是合并文件（如果它们在每个页面上都很常见）。rootNameSpace.js、jquery-min.js、ui.js、form.js 放到一个文件中说common.js。你可以使用[Google Closure](https://developers.google.com/closure/)来做到这一点。

```
<script src="js/common.js"></script>
<script src="js/pages/some-page.js"></script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-28T14:22:48.210

如果你有动态生成的页面，你可以有不同的名称/动作/控制器。那么你就可以

```
echo '<script type="text/javascript">$(document).ready(function(){'.$page_name.'();});</script>'; 
```

然后您可以在任何 JS 文件中声明全局函数，是的，您可以拥有任意数量的 JS 文件，并以您想要的任何方式拆分，它们都是全局的。

```
function name1(){...}; 
```

如果您有一个包含许多 JS 文件的大型应用程序，您可以在单个文件夹中拆分为更多文件，然后添加一个缩小插件以将它们“收集”到单个输出文件（或 JS 构建器）中。

rloader 是一个动态加载脚本，基本上是在你的文档中注入 JS 文件（[http://ntt.cc/2008/02/10/4-ways-to-dynamically-load-external-javascriptwith-source.html](http://ntt.cc/2008/02/10/4-ways-to-dynamically-load-external-javascriptwith-source.html)）。我不建议使用它，除非您有一个非常大的应用程序并使用加载的 MVC [http://coding.smashingmagazine.com/2012/07/27/journey-through-the-javascript-mvc-jungle/](http://coding.smashingmagazine.com/2012/07/27/journey-through-the-javascript-mvc-jungle/)仅当前模块。

# java - 如何在动作Struts2 REST Annotation之间传递动态值？

> ID：15137613
> 
> 赞同：0
> 
> 时间：2013-02-28T14:11:42.543
> 
> 标签：java, struts2

订单在 PaymentController 中生成，然后发送到ThankyouController

```
@Results({
    @Result(name="create",  type="redirectAction", 
            params = {"actionName" , "thankyou", "order", "${order}"})
})
public class PaymentController {
    private Order order;

    public Order getOrder()
        return order;

    public void setOrder(Order order)
        this.order = order;

    public String create()
        order = generateOrder();
        return "create";
}

public class ThankyouController
    private Order order;

    public HttpHeaders index()
    {
        System.out.println("---------------------" + order + "-----------------------------");
        return new DefaultHttpHeaders("index").withStatus(200);
    }

    public Order getOrder()
        return order;

    public void setOrder(Order order)
        this.order = order; 
```

但由于某些原因，我不断在ThankyouController 中获得Null 值。

谁能建议我在不使用 session 的情况下在动作之间传递价值的正确方法？

# sql - cassandra：单行中的可变列数

> ID：15137616
> 
> 赞同：1
> 
> 时间：2013-02-28T14:11:47.157
> 
> 标签：sql, database, cassandra

我想设计列族来存储一对客户的聊天历史，将一对特定夫妇的所有历史存储在一行中，对于给定的行，我们如何只存储该行所需的列。

样本：

```
id1 | id2 | message1 | message2
5     2     "hey"      "why"
id1| id2  | message1 | message2 | message3 | message4
2     3     "dcx"       "ddfs"    "ddd"         "dd"

id1| id2  | message1 | message2 | message3 | message4
4     6     "dcx"       "ppp"    

create columnfamily chat (id1 int,id2 int primary key)
insert into chat(id1,id2) values(8103333,8104444); 
```

我想在同一行中添加新列`'message1'`，`'message2'`......等等，所以我如何使用 cqlsh 2.3.0 在特定行中创建列 卡桑德拉 1.2.1 | cql空间3.0.0

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-28T14:18:21.487

代替 message1、message2 等列，使用如下复合键：

```
CREATE TABLE chat (
   id1 int,
   id2 int,
   message_sent_at timestamp,
   message text,
   primary key ((id1, id2), message_sent_at)
) 
```

Cassandra 现在将为您按时间顺序对属于 id1/id2 对的消息进行聚类。

请参阅[http://www.datastax.com/dev/blog/schema-in-cassandra-1-1](http://www.datastax.com/dev/blog/schema-in-cassandra-1-1)和[http://www.datastax.com/docs/1.2/ddl/table#cassandra-tables](http://www.datastax.com/docs/1.2/ddl/table#cassandra-tables)。

# java - 从目录中读取文件并比较java中嵌套for循环中的文件

> ID：15137622
> 
> 赞同：0
> 
> 时间：2013-02-28T14:12:07.937
> 
> 标签：java, file, file-io

从目录中读取文件并在 java 中的嵌套 for 循环中比较文件。第一个文件比较，但其余的说“不一样”，即使它是相同的。我知道我必须在循环中调整一些东西以防止它发送空值、任何指针

```
 File Directory = new File (location);
  File files[] = Directory.listFiles();

  for (File f : files)
  {   

     for (File g : files) 
     {
         br = new BufferedReader (new FileReader (f));
         while(( z = br.readLine()) != null)  s1+= z;

         br2 = new BufferedReader (new FileReader (g));   
         while ((y = br2.readLine()) != null) s2 += y;

         System.out.println();

      //     System.out.println(s1);   

      //   System.out.println(f.getName() + "=" + g.getName());

          if (s1.equals(s2)) {
         System.out.println(f.getName() + "=" + g.getName());
         System.out.println( "Content of both files are same");

     }
    else {
         System.out.println(f.getName() + "!=" + g.getName());
         System.out.println("Content of both files are not same"); 
     }

     } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-28T14:14:25.760

You keep adding to the same `s1` and `s2`, which means after the first couple of files you'll always have the previous files' contents in there. You'd probably want to clear them when you open the files.

Also, you should probably move the reading of `f` in the outer loop. There's no point reading it every time.

There are other ways to make this faster, for instance hashing the contents of each file, and then comparing hashes before actually starting to compare each pair of files, or more easily, comparing the sizes of the files first -- two files having different sizes (as given by e.g. `f.length()` and `g.length()`) will never be the same.

*(Editing to answer comment)*

If you want to delete one of two identical files, you might want to follow Windle's comment to make sure you never compare the same pair of files twice, and then you can always delete `f` if `f` and `g` are the same. To delete a file, use [`File.delete()`](http://docs.oracle.com/javase/6/docs/api/java/io/File.html#delete()).

As for copying files, you can try looking at this: [Standard concise way to copy a file in Java?](https://stackoverflow.com/questions/106770/standard-concise-way-to-copy-a-file-in-java) To create the name of the destination file, you can use this [constructor](http://docs.oracle.com/javase/6/docs/api/java/io/File.html#File(java.io.File,%20java.lang.String)).

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-28T14:16:22.620

我在任何地方都没有看到`s1`和`s2`宣布。它们应该在内部 foreach 循环中声明。否则，您会将每个文件的内容连接到 ses 字符串中。

您的算法效率非常低，并且没有考虑新行，但这是另一回事。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-28T14:32:02.067

您不断在 s1 和 s2 中添加行，一旦您点击了第一个不同的文件，s1 和 s2 将永远不再相同。此外，这种连接并没有真正的必要，为什么不一次比较两行并在不相等的第一行上中断并返回 false 呢？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-28T14:19:58.900

我已尝试修改您的解决方案以保持正确和快速。尝试这个。

```
StringBuffer s1 = new StringBuffer();
StringBuffer s2 = new StringBuffer();
for (int i = 0 ; i < files.length ; i++ )
 {   
     File f = files[i];
     s1 = new StringBuffer();
     br = new BufferedReader (new FileReader (f));
     while(( z = br.readLine()) != null)  s1.append(z);

  for (int j = i+1 ; j < files.length ; j++ )
    {
File g = files[j]  ;         
     s2 = new StringBuffer();
     br2 = new BufferedReader (new FileReader (g));   
     while ((y = br2.readLine()) != null) s2.append(y);

     System.out.println(" ");

     if (s1.equals(s2)) {
        System.out.println(f.getName() + "=" + g.getName());
        System.out.println( "Content of both files are same");

        // To write file to a new directory pass the new path and the file as String to the method as given below.
        writeToFile(newPath, s2);

        // To delete the file use the below statement.
        g.delete();
                 }
    else {
        System.out.println(f.getName() + "!=" + g.getName());
       System.out.println("Content of both files are not same"); 
     }

 }

 private void writeToFile(String fileName, String data) throws IOException{
     FileWriter fstream = new FileWriter(fileName);
      BufferedWriter out = new BufferedWriter(fstream);
      out.write(data);
      out.flush();
      out.close();
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-28T14:27:55.273

让我们举这个例子。假设您在目录中有4 个文件：`A`、`B`和.`C``D`

您的代码试图做的是将 中的`location`每个文件与同一目录中的每个文件进行比较。

这意味着`A`与`A`、`B`和`C`进行比较`D`。`B`与`A`、`B`、`C`等`D`进行比较。

在此示例中，发现文件相等的唯一情况`A`是与比较`A`时`B`与`B`..比较

因此，在`16`这里发生的全部比较中，`4`其中的文件将导致文件相等，而其余的则被标记为不相等。

因此，您应该期望更多的“不一样”而不是“相同”的输出。

# android - 如何使用 UiAutomatorViewer 点击 RelativeLayout

> ID：15137623
> 
> 赞同：0
> 
> 时间：2013-02-28T14:12:08.443
> 
> 标签：android, ui-automation, android-testing

我有

```
UiObject okButton = new UiObject(new UiSelector().text("button1"));
okButton.click(); 
```

它完美地工作我设置`android:contentDescription="button1"`并且一切正常，单击按钮并且一切正常。

但是当我设置`android:contentDescription="relativelayout1"`为相对布局时

```
UiObject rel1 = new UiObject(new UiSelector().text("relativelayout1"));
rel1.click(); 
```

此代码确实会产生`com.android.uiautomator.core.UiObjectNotFoundException` ，但我确信存在相对布局。

有没有其他人点击过相对布局？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T14:47:24.247

您需要使用`.description("foo")`它的 contentDescription 来查找 UiObject

# twitter-bootstrap - 尝试在 Yii 中激活主题并安装 Bootstrap

> ID：15137625
> 
> 赞同：0
> 
> 时间：2013-02-28T14:12:11.340
> 
> 标签：twitter-bootstrap, yii, themes

我设法在我的测试 yii 安装上创建了“Testdrive”应用程序。我*想*我已经安装了 Bootstrap。

更重要的是，我正在努力激活我想使用的主题。我已经浏览了所有我能找到的 Yii 教程，并且`'theme' => 'xxxx'`没有成功地更改过。

我仔细检查了文件/文件夹权限以消除明显的错误。

观看演示站点的网址是[http://www.pureads.co.uk/testdrive](http://www.pureads.co.uk/testdrive)

随便问我什么，我会尽我所能回答。

这是我的`protected/config/main.php`文件，我*试图*在其中调用我所坐的主题，`/testdrive/themes`但似乎没有工作。

```
 <?php

// uncomment the following to define a path alias
// Yii::setPathOfAlias('local','path/to/local-folder');

// This is the main Web application configuration. Any writable
// CWebApplication properties can be configured here.

return array(
    'basePath'=>dirname(__FILE__).DIRECTORY_SEPARATOR.'..',
    'name'=>'My Web Application',
    // preloading 'log' component
    'preload'=>array('log'),

    // autoloading model and component classes
    'import'=>array(
        'application.models.*',
        'application.components.*',
    ),
    'modules'=>array(
        // uncomment the following to enable the Gii tool

        'gii'=>array(
            'class'=>'system.gii.GiiModule',
            'password'=>'Enter Your Password Here',
            // If removed, Gii defaults to localhost only. Edit carefully to taste.
            'ipFilters'=>array('127.0.0.1','::1'),
        ),

    ),

    // application components
    'components'=>array(
        'user'=>array(
            // enable cookie-based authentication
            'allowAutoLogin'=>true,
        ),
        // uncomment the following to enable URLs in path-format
        /*
        'urlManager'=>array(
            'urlFormat'=>'path',
            'rules'=>array(
                '<controller:\w+>/<id:\d+>'=>'<controller>/view',
                '<controller:\w+>/<action:\w+>/<id:\d+>'=>'<controller>/<action>',
                '<controller:\w+>/<action:\w+>'=>'<controller>/<action>',
            ),
        ),
        */
        'db'=>array(
            'connectionString' => 'sqlite:'.dirname(__FILE__).'/../data/testdrive.db',
        ),
        // uncomment the following to use a MySQL database
        /*
        'db'=>array(
            'connectionString' => 'mysql:host=localhost;dbname=testdrive',
            'emulatePrepare' => true,
            'username' => 'root',
            'password' => '',
            'charset' => 'utf8',
        ),
        */
        'errorHandler'=>array(
            // use 'site/error' action to display errors
            'errorAction'=>'site/error',
        ),
        'log'=>array(
            'class'=>'CLogRouter',
            'routes'=>array(
                array(
                    'class'=>'CFileLogRoute',
                    'levels'=>'error, warning',
                ),
                // uncomment the following to show log messages on web pages
                /*
                array(
                    'class'=>'CWebLogRoute',
                ),
                */
            ),
        ),
    ),

    // application-level parameters that can be accessed
    // using Yii::app()->params['paramName']
    'params'=>array(
        // this is used in contact page
        'adminEmail'=>'webmaster@example.com',
    ),
    'theme'=>'andia-agency', // requires you to copy the theme under your themes directory
    'modules'=>array(
        'gii'=>array(
            'generatorPaths'=>array(
                'bootstrap.gii',
            ),
        ),
    ),
    'components'=>array(
        'bootstrap'=>array(
            'class'=>'bootstrap.components.Bootstrap',
        ),
    ),
); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T21:16:28.993

您的*主题文件夹应该与您的**protected/views/*文件夹具有相同的结构。所以你的主题应该设置如下（当然相对于根目录）。

*   主题
    *   意见
    *   布局
    *   地点

我有时无法让“主题”配置选项正常工作。通常我在我的控制器中添加以下内容 CController::beforeAction($action);

```
Yii::app()->setTheme('andia-agency'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-11T15:25:12.780

你有没有包括

```
 <?php Yii::app()->bootstrap->register(); ?> 
```

进入你的`<head></head>`部分？？

这对我有用。:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-11-22T03:13:17.390

对于 Yii 版本 1.xx ，请按照以下站点和 youtube 获取设置说明：

> [http://docs.siquo.net/yii-bootstrap/setup.html](http://docs.siquo.net/yii-bootstrap/setup.html)
> 
> [https://www.youtube.com/watch?v=jw7hVR7EGHc](https://www.youtube.com/watch?v=jw7hVR7EGHc)

## 1）将主题目录复制到您的主题目录

将主题（引导程序）复制到主题（yii）文件夹的说明[确实如此，但]在翻译中不知何故丢失了。

## 2) Yii 项目 >> 保护 > 配置 > main.php

```
// Define a path alias for the Bootstrap extension as it's used internally.
// In this example we assume that you unzipped the extension under protected/extensions.

Yii::setPathOfAlias('bootstrap', dirname(__FILE__).'/../extensions/bootstrap');

return array(
    'theme'=>'bootstrap', // requires you to copy the theme under your themes directory
    'modules'=>array(
        'gii'=>array(
            'generatorPaths'=>array(
                'bootstrap.gii',
            ),
        ),
    ),
    'components'=>array(
        'bootstrap'=>array(
            'class'=>'bootstrap.components.Bootstrap',
        ),
    ),
); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-12-21T17:27:05.660

您的引导主题安装不正确。[yii-bootstrap setup](http://www.cniska.net/yii-bootstrap/setup.html)中描述了正确的方法。因此，如您所见，您必须在 config/main.php 文件的第一个文件中定义其地址，如下所示：

```
// Define a path alias for the Bootstrap extension as it's used internally.
// In this example we assume that you unzipped the extension under protected/extensions.
Yii::setPathOfAlias('bootstrap', dirname(__FILE__).'/../extensions/bootstrap');
return array(
'theme'=>'bootstrap', // requires you to copy the theme under your themes directory
'modules'=>array(
    'gii'=>array(
        'generatorPaths'=>array(
            'bootstrap.gii',
        ),
    ),
),
'components'=>array(
    'bootstrap'=>array(
        'class'=>'bootstrap.components.Bootstrap',
    ),
),
); 
```

# c++ - shared_ptr 的自定义删除器的附加参数

> ID：15137626
> 
> 赞同：14
> 
> 时间：2013-02-28T14:12:12.543
> 
> 标签：c++, smart-pointers

无论如何我可以向删除者发送参数`std::shared_ptr`吗？

感觉就像：

```
std::shared_ptr<A> myA( a, myDeleter(a, 5) ); 
```

哪里`myDeleter`有这个签名：

```
void myDeleter(A* a, int i) 
```

（显然上面的语法是错误的，但只是为了强调我需要我的删除器来接受额外的参数。）

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-02-28T14:15:21.547

您可以`std::bind`在将删除器的第二个参数作为删除器传递之前：

```
auto deleter = std::bind(myDeleter, std::placeholders::_1, 5);
std::shared_ptr<A> myA(a, deleter); 
```

或者，您的删除器可以是一个函子，它`int`通过其构造函数获取：

```
struct myDeleter
{
  myDeleter(int);
  void operator()(A*);
};

myDeleter deleter(5);
std::shared_ptr<A> myA(a, deleter); 
```

或者，您可以使用 lambda 表达式：

```
std::shared_ptr<A> myA(a, [](A* a){ myDeleter(a, 5); }); 
```

# asp.net - 找到文本框的正确值

> ID：15137627
> 
> 赞同：1
> 
> 时间：2013-02-28T14:12:12.657
> 
> 标签：asp.net, html, vb.net, findcontrol

我在将数据插入数据库时​​遇到问题。

```
 <asp:Repeater ID="Repeater1" runat="server" DataSourceID="SqlDataSource1"   OnItemDataBound="Repeater1_ItemDataBound">
   <ItemTemplate> 
     <!-- Some other data (text...) -->

     <asp:HiddenField ID="HiddenField1" runat="server" Value='<%# Eval("PostId") %>' />  

     <asp:TextBox ID="txtAddComment" runat="server" CssClass="textbox"  Width="200px" />
     <asp:Button ID="btnAddComment" runat="server" CssClass="button" Text="Comment"   CausesValidation="false" OnClick="btnAddComment_Click"/>
   </ItemTemplate>
</asp:Repeater> 
```

后面的代码：

```
 Protected Sub btnAddComment_Click(sender As Object, e As EventArgs)
        Dim HiddenField1 As HiddenField = DirectCast(Repeater1.Items(0).FindControl("HiddenField1"), HiddenField)
        Dim txtAddComment As TextBox = DirectCast(Repeater1.Items(0).FindControl("txtAddComment"), TextBox)
        Dim conn As New SqlConnection(ConfigurationManager.ConnectionStrings("ConnectionString").ConnectionString.ToString)
        Try
            If txtAddComment.Text = "" Then
                Exit Sub
            Else
                conn.Open()
                Dim cmd As SqlCommand = conn.CreateCommand()
                cmd.CommandText = "INSERT INTO Comments (PostId, UserName, CommentText) VALUES (@PostId, @UserName, @Text)"

                cmd.Parameters.Add("PostId", System.Data.SqlDbType.Int).Value = CInt(HiddenField1.Value)
                cmd.Parameters.Add("UserName", System.Data.SqlDbType.NVarChar).Value = Context.User.Identity.Name
                cmd.Parameters.Add("Text", System.Data.SqlDbType.NText).Value = MakeLink(HtmlRemoval.StripTagsCharArray(txtAddComment.Text))                    
                cmd.ExecuteNonQuery()            
            End If

        Catch ex As SqlException                
        Finally
            conn.Close()
        End Try
    End Sub 
```

我显示一些文本，在文本下有文本框和评论按钮。我在隐藏字段中绑定 textId 以插入评论。代码工作正常，但我只能为转发器显示的数据库中的第一行添加注释。当我想为其他行（2、3...）添加注释时，页面会刷新并且 TextBox 中的文本会保留在那里。

这行代码有问题：

```
Dim txtAddComment As TextBox = DirectCast(Repeater1.Items(0).FindControl("txtAddComment"), TextBox) 
```

HiddenField 的 ID 是正确的。但是代码没有执行，因为上面的行引用了页面上的第一个文本框，并且他的值为 null。

当我像这样更改代码行时：

```
 Dim txtAddComment As TextBox = DirectCast(Repeater1.FindControl("txtAddComment"), TextBox) 
```

它返回一个错误，即*Object 引用未设置为 object 的实例*。

如何获得具有正确值的正确文本框？感谢你的回答

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T14:35:58.750

将发件人投射到发送它的按钮，然后从父级获取文本框。例子：

```
Protected Sub button_click(ByVal sender As Object, ByVal e As EventArgs)
   Dim myButton As button= CType(sender, button)
   Dim myTextBox as TextBox = CType(myButton Parent.FindControl("buttonName"), TextBox)

end sub 
```

# google-app-engine - 没有用户名/密码提示的批量上传

> ID：15137631
> 
> 赞同：0
> 
> 时间：2013-02-28T14:12:16.570
> 
> 标签：google-app-engine

我有一个每天生成一些数据的过程，我想使用以下命令将其更新为在 appengine 上运行的 java 应用程序：

> appcfg.py upload_data --url= [http://your_app_id.appspot.com/_ah/remote_api](http://your_app_id.appspot.com/_ah/remote_api) --kind= --filename=

它工作得很好，但它总是问我我的用户名/密码。

有没有办法保存凭据，使用证书，以避免用户名提示？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T15:33:58.363

添加这些选项：

```
--email=
--passin
 and at the end :  < "your password file.txt" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-02-21T20:23:32.480

似乎这种技术不再适用于 SDK 1.9.17。更新的文档包括一些新的 oauth2 命令行选项，但说明相当混乱。任何人都可以使用旧的 passin 或新的 oauth2 技术？如何？

# olap-cube - 关于 Rolap 或 Molap 的假设分析以及如何分析？

> ID：15137634
> 
> 赞同：0
> 
> 时间：2013-02-28T14:12:27.440
> 
> 标签：olap-cube, mondrian, rolap

我想在 OLAP 多维数据集上模拟假设分析 例如，我想知道在部门之间移动员工或产品从一家工厂搬到另一家工厂时制造成本的变动对部门资源预算的影响。

那么我应该使用 rolap cube'mondrian' 还是 molap ？

如果你能给我一些例子，我将不胜感激，tuto ... ;) 提前谢谢你

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T11:35:39.967

Actually mondrian does support "writeback" (via olap4j) so you can do what if analysis. Check out Saiku - AFAIK it's the first and only tool to have implemented it so far.

Here is how it works - it's pretty rudimentary:

[http://julianhyde.blogspot.co.uk/2009/06/cell-writeback-in-mondrian.html](http://julianhyde.blogspot.co.uk/2009/06/cell-writeback-in-mondrian.html)

Martin is close to the point though, it doesn't actually update the raw data, only objects in the cache. But you wouldnt want to update raw data if you were doing what if analysis anyway!

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T18:49:24.377

我会说 Mondrian 是一个查询现有数据库的引擎，该数据库具有 Olap 的专用结构（通常是某种星型模式）。

绝对不是操纵（甚至）更改数据的东西。由于每个假设分析都需要以某种方式更改数据，蒙德里安不是它的工具。

# django - Django 聚合值查询集

> ID：15137637
> 
> 赞同：1
> 
> 时间：2013-02-28T14:12:38.707
> 
> 标签：django, django-aggregation

我有一个名为`data`.

我正在尝试获取每个对象的所有类型的摘要计数

`data.values('type')`产生这个输出：

```
[{'type': u'internal'}, {'type': u'internal'}, {'type': u'external'}, {'type': u'external'}] 
```

我想得到这样的细分（可以有更多的选择，而不仅仅是“内部”和“外部”。这可能是多达 20 种不同的类型：

```
internal: 2
external: 2 
```

我正在尝试这个，但它只是返回一个空字典......

```
data.values('type').aggregate(Count('type')) 
```

Annotate 也产生了不希望的结果：

```
data.values('type').annotate(Count('type'))

[{'type': u'internal', 'type_count': 1}, {'type': u'internal', 'type_count': 1}, {'type': u'external', 'type_count': 1}, {'type': u'external', 'type_count': 1}] 
```

模型.py

```
class Purchase(models.Model):    

    type = models.ForeignKey(Types) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-28T14:21:52.617

```
 lists = ModelName.objects.values('type').annotate(count=Count('type')) 
```

在 html 中：

```
 {% for list in lists %}
     {{list.type}} - {{list.count}}<br/>
 {% endfor %} 
```

测试：

```
 {{lists}}
 //don't use forloop yet. This will tests if the above query produce data or it is empty 
```

**更新：**

```
def view_name(request):
    lists = ModelName.objects.values_list('type', flat=True).distinct()
    types = []
    for list in lists:
        type_count = ModelName.objects.filter(type=list.type).count()
        types.append({'type': list.type, 'count': type_count})

    return render(request, 'page.html', {
            'types': types,
    })

{% for type in types %}
    {{type.type}} - {{type.count}}
{% endfor %} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T14:24:11.127

它们有几种方法，假设您想要字典中的结果，简单的方法是：

```
results = { 'internal': data.filter( value = 'internal'  ).count(),
            'external': data.filter( value = 'external'  ).count() } 
```

对于少数查询集，您可以使用 itertools，这会将工作从数据库层转换为 django 层。这意味着它只是小查询集的解决方案。

```
from itertools import groupby
results = groupby(data.all(), lambda x: x.type) 
```

# playframework - 如何从内部方法渲染和停止

> ID：15137641
> 
> 赞同：0
> 
> 时间：2013-02-28T14:12:53.773
> 
> 标签：playframework, playframework-2.1

假设我有这个动作结构：

```
def checkAccess(request: Request[AnyContent]) {
    if (shouldntGetAccess()) {
        // I want to return 404 and stop execution here
    }
}

def index = Action { implicit request =>
    checkAccess(request)

    Ok
} 
```

我如何决定从 404 页面返回`checkAccess()`并停止执行？这是在 Play 1 中通过简单地调用实现的`notFound()`，但在 Play 2 中的行为似乎不同。

这可以通过`checkAccess()`抛出一些异常并添加过滤器来捕获它并呈现正确的响应来实现吗？如果您的代码提供了代码示例，那就太好了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T10:05:13.287

```
def checkAccess(f: Request[AnyContent] => Result) = Action{ request => 
  if(shouldntGetAccess()){
  NotFound
}else{
  f(request)
}
}

def index = checkAccess{ request => 
  Ok("success")
} 
```

# iphone - 输入有效值后如何启用 UIButton

> ID：15137645
> 
> 赞同：0
> 
> 时间：2013-02-28T14:13:01.277
> 
> 标签：iphone, ios, objective-c, cocoa-touch, uibutton

我有这个应用程序和一个重置按钮来重置我输入的值。只要我不输入有效值，我就会尝试让按钮变为灰色。

当值有效时，它应该启用并变得可触摸......

我怎样才能做到这一点？

我正在使用此代码，但它不起作用...

```
//Reset values
- (IBAction)resetPressed:(UIButton *)sender {
    if (didPan==1) {
        resetPressed.enabled = YES;
    } else {
        resetPressed.enabled = NO;
    }
    self.prozent=0;
    didPan=NO;

    //remove drawn intersection line
    [intersectionLine removeFromSuperview];
    NSLog(@"resetPressed");
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T14:16:23.657

要在按钮符合您的条件时启用该按钮，请使用**setEnabled:YES**。

例如

```
UIButton *button = (UIButton *)sender;
[button setEnabled:YES]; 
```

一个更好的方法是使用点表示的版本，如下所示：

```
button.enabled = YES; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T14:19:07.850

在您使用的情况下， `if (didPan==1) {`虽然它会给出所需的结果，但最好使用 `if(didPan)`

其次`resetPresed`是动作名称而不是按钮或发件人，所以你应该使用发件人而不是`resetPressed`

并用于设置按钮状态`[sender setEnabled:YES];//OR sender.enabled=YES;`

所以你的代码看起来像这样

```
- (IBAction)resetPressed:(UIButton *)sender {

 if (didPan) {
        [sender setEnabled:YES];  //OR sender.enabled=YES;
    } else {
       [sender setEnabled:NO];  // OR sender.enabled=NO;
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-28T14:36:16.897

如果您在 UITextField 中输入值，则可以为文本字段设置委托并编写代码以启用/禁用`textFieldDidEndEditing:`委托对象的内部方法。IE; `theButton.enabled = YES/NO` 从您的代码看来，您正在编写用于在该按钮本身的操作中禁用该按钮的代码，如果该按钮被禁用，则该按钮将不起作用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-20T09:43:48.460

***经过长时间的搜索，我确实解决了问题。

我发现 ResetButton 必须有一个看起来像这样的属性

@property（强，非原子）IBOutlet UIButton *resetButton;

然后我突出显示按钮并从控件中取消选中启用（之前尝试过，但没有用）

我使用 button.enabled=YES 并使用 [resetButton setAlpha:1] 更改颜色为正常， [resetButton setAlpha:0.5] 为未激活

谢谢大家帮助！***

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-02-28T14:35:54.503

例如，如果您在 UITextField 中输入值，则使用文本字段的委托来确定该值是否正确：

```
-(BOOL)textField:(UITextField *)textField shouldChangeCharactersInRange:(NSRange)range replacementString:(NSString *)string
{

   if ([textField.text isValid]) { // check if text in textfield is valid

       button.enabled = YES;
   } else  {
       button.enabled = NO;
   }

   return YES;
} 
```

# java - Socket Programming Java：如何从输出流接收多个文件？

> ID：15137653
> 
> 赞同：1
> 
> 时间：2013-02-28T14:13:14.690
> 
> 标签：java, networking, serversocket

我的服务器正在向我的客户端发送几个文件。但是在客户端，它只接收第一个文件，因为我不知道如何迭代和获取第二个文件。

服务器发送如下：

```
ListIterator iter = missingfiles.listIterator(); 
                    //missingfiles contain all the filenames to be sent
String filename;
while (iter.hasNext()) {
    // System.out.println(iter.next());
    filename=(String) iter.next();
    File myFile = new File("src/ee4210/files/"+filename); 
    byte[] mybytearray = new byte[(int) myFile.length()];  

    FileInputStream fis = new FileInputStream(myFile);  
    BufferedInputStream bis = new BufferedInputStream(fis);  
    //bis.read(mybytearray, 0, mybytearray.length);  

    DataInputStream dis = new DataInputStream(bis);     
    dis.readFully(mybytearray, 0, mybytearray.length);  

    OutputStream os = _socket.getOutputStream();  

    //Sending file name and file size to the server  
    DataOutputStream dos = new DataOutputStream(os);     
    dos.writeUTF(myFile.getName());     
    dos.writeLong(mybytearray.length);     
    dos.write(mybytearray, 0, mybytearray.length);     
    dos.flush(); 
} 
```

客户端接收是这样的：（它只会接收第一个文件，我不知道如何让它循环接收下一个文件）

```
int bytesRead;
int current = 0;
int filecount = 0;
InputStream in;
try {
    in = _socket.getInputStream();
    DataInputStream clientData = new DataInputStream(in);
        String fileName = clientData.readUTF();
        OutputStream output = new FileOutputStream(
                               "src/ee4210/files/"+ fileName);
        long size = clientData.readLong();
        byte[] buffer = new byte[1024];
        while (size > 0
                && (bytesRead = clientData.read(buffer, 0,
                        (int) Math.min(buffer.length, size))) != -1) {
            output.write(buffer, 0, bytesRead);
            size -= bytesRead;
        }
} catch (IOException e) {
    // TODO Auto-generated catch block
    e.printStackTrace();
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T12:04:11.700

你可以试试这个。我使用了一种惰性方法来检查是否已收到所有 3 个文件的结尾。

```
 int bytesRead;
    int current = 0;
    int filecount = 0;
    InputStream in;
    try 
    {
        in = _socket.getInputStream();
        DataInputStream clientData = new DataInputStream(in);

        while(true) 
        {
            String fileName = clientData.readUTF();
            // will throw an EOFException when the end of file is reached. Exit loop then.

            OutputStream output = new FileOutputStream("src/ee4210/files/"+ fileName);
            long size = clientData.readLong();
            byte[] buffer = new byte[1024];
            while (size > 0
                    && (bytesRead = clientData.read(buffer, 0,
                            (int) Math.min(buffer.length, size))) != -1) 
            {
                output.write(buffer, 0, bytesRead);
                size -= bytesRead;
            }
            output.close();
        }

    } 
    catch (EOFException e)
    {
        // means we have read all the files
    }
    catch (IOException e) 
    {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T23:38:05.197

> 如何从输出流接收多个文件？

显而易见的答案是“一次一个，有额外的信息告诉你一个停止和另一个开始”。最常用的技术是在文件之前发送文件大小，例如作为 long via `DataOutputStream.writeLong()`，并在接收器更改您的读取循环以在恰好那么多字节后停止，关闭输出文件，并继续读取下一个长流或流尾。

# haskell - Match any list in Haskell

> ID：15137656
> 
> 赞同：2
> 
> 时间：2013-02-28T14:13:18.520
> 
> 标签：haskell

Is there a way to pattern match any list without iterating through the two cases: empty or non-empty list ?

I would like to fix the following code:

```
foo [] = "something else"
foo [_:_] = "something else" 
```

Since the part in `something else` is the same I would like to remove it from one place.

Thank you.

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-28T14:16:23.437

该模式`_`匹配任何内容而不将其绑定到名称。一个名字，比如say，`xs`也可以匹配任何东西。因此，您可以执行以下任一操作：

`foo _ = "something else"` 或者 `foo xs = "something else"`

如果“其他东西”确实不依赖于`xs`第一种形式的值，则首选，以便另一个程序员（和您）可以快速发现该值在这个特定等式中无关紧要。

不幸的是，您的第一个案例已经是第二种形式，因此它匹配**所有**可能性。其他情况将永远无法解决。

# php - PHP preg_split utf8 characters

> ID：15137660
> 
> 赞同：5
> 
> 时间：2013-02-28T14:13:30.653
> 
> 标签：php, cakephp, preg-split

Have problem with preg split and utf. This is code:

```
$original['words'] = preg_split("/[\s]+/", $original['text']);
print_r($original); 
```

This is answer:

```
Array
(

    [text] => Šios baterijos kaista
    [words] => Array
        (
            [0] => �
            [1] => ios
            [2] => baterijos
            [3] => kaista 
```

This code is runing in CakePHP framework. Make a notice that [text] is showed correctly before words and is messed in split progress. By the way, I tried using these one:

```
mb_internal_encoding( 'UTF-8'); 
mb_regex_encoding( 'UTF-8');  
ini_set('default_charset','utf-8'); 
```

None helped. Thank you.

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-02-28T14:17:00.063

您需要`preg_split`通过将`u` [修饰符](http://www.php.net/manual/en/reference.pcre.pattern.modifiers.php)添加到正则表达式来启用 utf-8 模式：

```
preg_split("/[\s]+/u", $original['text']); 
```

您在尝试找到解决方案时提到的配置指令在这里不起作用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-04-09T15:05:54.307

```
$original = mb_split("[\s]+", 'Šios baterijos kaista');
print_r($original); 
```

结果：

```
Array
(
    [0] => Šios
    [1] => baterijos
    [2] => kaista
) 
```

笔记：

[1) 使用mb_split](https://www.php.net/manual/en/function.mb-split.php)时，不要忘记从正则表达式模式中删除前导和尾随 '/' 。

2) 仅在启用[mbstring](https://www.php.net/manual/en/mbstring.installation.php)扩展时有效。

# static - 配置 NGinx 以提供静态文件和代理传递某些 url

> ID：15137661
> 
> 赞同：3
> 
> 时间：2013-02-28T14:13:32.810
> 
> 标签：static, nginx, config

站点几乎完全包含在一个 html 文件中。所有其他文件可能是图像、css 或 javascripts，也可能是 json 文件。

```
server {

    listen 80;
    server_name git.vosnax.ru;

    location / {
        try_files $uri "/index.html";
        root   /home/sybiam/prod/blog;
        index  index.html;
    }
} 
```

这是我目前的配置，但这并不完美。它会将每个请求重定向到 index.html ，除非该文件存在，这是可以的。

*   ~~由于某些原因，它删除了 GET 参数。我想保留它们，因为我可以在 javascript 中使用它们。~~

现在，我想为该站点添加一些持久性。就像使用非常简单的身份验证从服务器保存和加载 json 一样，它支持 GET 和 POST。这意味着我不能使用`JSONP`.

问题仅在于如何配置 nginx 以将所有请求转发`/api/*`给我的金字塔 Web 服务器以及其他所有请求到 index.html，除非该文件存在。

我可能可以将服务器托管在不同的域上以使事情变得更容易，但我不知道如何处理跨域请求。`CORS`旧 IE 不支持。

*编辑：* 显然查询参数总是可用的，所以这不再是问题了。我的 javascript 在加载时覆盖了路径名并删除了`window.location.search`.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-01T22:44:55.130

除非文件存在，否则 index.html 的所有其他内容都是`try_files`您在`location /`-block 中已经拥有的位

要将`/api/*`请求仅传递给您的其他服务器，您将以下内容添加到您的服务器块（作为您的`location /`-block 的兄弟）：

```
location /api/ { 
  proxy_pass http://address_of_server_your_passing_to; 
} 
```

如果您想了解有关在有多个位置块时如何匹配请求的更多信息，请参阅[文档](http://nginx.org/en/docs/http/ngx_http_core_module.html#location)

# javascript - Using percent in jQuery Nested plugin

> ID：15137672
> 
> 赞同：1
> 
> 时间：2013-02-28T14:13:59.977
> 
> 标签：javascript, jquery

I am trying out a rather new mutli-column grid jQuery plugin called Nested ([http://suprb.com/apps/nested/](http://suprb.com/apps/nested/)) and am not used to setting the size parameters in percentages.

Here is the HTML:

```
 <div id="container">
            <div class="box">1</div> x5
            </div> 
```

Now, in the nested.js file,

```
 $.Nested.settings = {
    selector: '.box',
    minWidth: 200,
    minColumns: 1,
    gutter: 1,
    resizeToFit: true, // will resize block bigger than the gap
    resizeToFitOptions: {
        resizeAny: true // will resize any block to fit the gap         
    }, 
```

I want to change the "minWidth" to a percentage. In this case, the container which contains `.box` is 100%, and I want it to always have 5 columns with each equal to at least 20% in width, so that it fits in the 100%.

How can I accomplish this?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T14:23:12.753

你为什么不用css？

```
<style>
 .box{
 width:20% !important;
 }
 </style> 
```

# android - android: How to force TableRows to have the same height?

> ID：15137674
> 
> 赞同：1
> 
> 时间：2013-02-28T14:14:14.630
> 
> 标签：android, layout, height, tablelayout, tablerow

I have searched google and stackoverflow thoroughly, but the only answer I get is: set each `Tablerow` with `layout weight = "1"`. This doesnt work.

Now I have eight rows in a `TableLayout`, and each contains 5 `LinearLayouts`. Each of the LinearLayouts contains 2 `TextViews`, and the `FontSizes` vary from `TextView` to `TextView`.

It turns out that the TableRows vary in height, depending on the Fontsizes of the contained `TextViews`. Strangely enough, it doesnt have any impact on the layout whether I set the layout_height of the TableRows to "0dp" or to "match_parent" or "fill_parent".

How can I force the `TableRows` to have the same height? I dont want to use a specific pts value as height, because the tableRows must divide the whole screen equally between themselves.

Here is part of the xml, the actual file is huge:

```
<TableLayout
    android:layout_width="match_parent"
    android:layout_height="0dp"
    android:layout_weight="6"
    android:weightSum="8"
    tools:context=".MainActivity" >

    <TableRow
        android:layout_width="match_parent"
        android:layout_weight="1"
        tools:context=".MainActivity">

        <LinearLayout
            android:clickable="true"
            android:orientation="vertical"
            android:layout_width="0dp"
            android:layout_height="match_parent"
            android:layout_marginTop="@dimen/btnmargintop"
            android:layout_marginBottom="@dimen/btnmarginbot"
            android:layout_marginLeft="@dimen/btnmarginleft"
            android:layout_marginRight="@dimen/btnmarginright"
            android:layout_weight="1"
            android:background="@drawable/bg" >

            <myapp.TypefacedTextView
                android:layout_width="wrap_content"
                android:layout_height="0dp"
                android:layout_weight="@integer/layoutweight1"
                android:layout_gravity="center"
                stevens:typeface="myfont.otf"
                android:clickable="false"
                android:textSize="@dimen/fontsize1" />
            <myapp.TypefacedTextView
                android:layout_width="wrap_content"
                android:layout_height="0dp"
                android:layout_weight="@integer/layoutweight2"
                android:layout_gravity="center"
                stevens:typeface="myfont.otf"
                android:clickable="false"
                android:textSize="@dimen/fontsize2" />              
        </LinearLayout> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T14:21:32.127

您可能正在让选项卡的布局自动调整为内部内容的大小。有两种方法可以解决问题：

*   确保所有元素共享相同的大小 - 话虽如此，不要担心整个表格，只需确保内部元素的尺寸相同
*   或者简单地设置父布局的高度，不要让元素有所作为。这个解决方案的问题是，如果你在里面变大，你就会没有空间，所以你可能想坚持第一个选项

# java - nio HTTP decompression in Java

> ID：15137675
> 
> 赞同：1
> 
> 时间：2013-02-28T14:14:25.217
> 
> 标签：java, nio, compression

Is there any Java library that does nio decompression of GZIP (and possibly other formats) out there? I'm trying to analyze compressed HTTP content and need it to be non-blocking. I found GZipInputStream but it expects InputStream which is blocking. Any ideas?

I also found [Iterable gzip deflate/inflate in Java](https://stackoverflow.com/questions/13387215/iterable-gzip-deflate-inflate-in-java) talking about compression (deflate) but couldn't find a decompression equivalent.

Thanks

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T08:56:50.390

使用 Netty 的[ZLibWrapper](http://docs.jboss.org/netty/3.2/api/org/jboss/netty/handler/codec/compression/ZlibWrapper.html)怎么样？

# wordpress - Image deleted regardless if checkbox is checked or not

> ID：15137678
> 
> 赞同：-1
> 
> 时间：2013-02-28T14:14:30.143
> 
> 标签：wordpress, checkbox

I have a problem I'm trying to solve, but with no avail because php is really not my field. I already searched the forums and found a few solutions to similar problems, but I couldn't get the to work.

I created a Theme Options Page where you can for ex. upload a Logo to be used on the Website. I created a check box and want to delete the logo if the check box is checked. Anyway, the logo is deleted when I click Save changes, but regardless if I checked the check box or not.

This is my code:

```
// LOGO
function logo_setting() {
    $options = get_option('theme_options');
    if (empty($options['logo'])) :
        $options['logo'] = '';
    else :
        echo "<img src='{$options['logo']}' width='205px' /><br>";

        //DELETE OPTION
        if (!isset( $options['del_logo'] ) ) :
                $options['del_logo'] = '';
                echo "<br>Remove logo?&nbsp;";
                ?> <input type="checkbox" id="del_logo" name="theme_options[del_logo]" value="1" <?php checked( true, $options['del_logo'] ); ?> /><?php

                echo "<br>If logo is removed, Site Title will be used.";
            else :
                $options = get_option('theme_options');
                $options['logo'] = '';
                update_option('theme_options', $options);
                echo "Logo removed";
        endif;
        $options['del_logo'] = ( $options['del_logo'] == 1 ? 1 : 0 );
        return $options;

    endif;
    echo "<input type='file' name='logo' />";
} 
```

I hope someone can explain to me what I'm doing wrong and how I should do it properly.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-07-03T18:40:15.117

OP写道：

> 解决方案：
> 
> ```
> function logo_setting() {
>     $options = get_option('theme_options');
>     if (empty($options['logo'])) :
>     $options['logo'] = '';
>     echo "Site title is used.<br>";
>     else :
>     echo "<img src='{$options['logo']}' width='205px' /><br>";
>     endif;  
>     echo "<input type='file' name='logo' />";
> 
>     if (empty($options['hide_logo'])) :
>     $options['hide_logo'] = '';
>     endif;
>     echo '<br><br>Show site title instead of logo?&nbsp;<input name="theme_options[hide_logo]" id="hide_logo" type="checkbox" value="1" ' . checked( 1, $options['hide_logo'], false ) . ' />';
> } 
> ```
> 
> 在 html 中：
> 
> ```
>  <?php if (empty($options['logo']) || isset($options['hide_logo'])) :
>     bloginfo('name');
> else : ?>
>     <img src="<?php echo $options['logo']; ?>" alt="Logo" />
> <?php endif; ?> 
> ```

# c# - Selenium RC C# For each matching xpath node DO

> ID：15137682
> 
> 赞同：1
> 
> 时间：2013-02-28T14:14:44.603
> 
> 标签：c#, xpath, selenium, rc

What I'm trying to accomplish is for each element picked by xpath do some action. To be precise

```
 var localizator = LocalizatorGenerators.SelectOptionLocator(labelName);
                decimal totalElements = selenium.GetXpathCount((localizator));

                for (int i = 1; i < totalElements + 1; i++)
                {
                    if (selenium.IsElementPresent(string.Format("({0})[{1}]", localizator, i)))
                        selenium.Select(string.Format("({0})[{1}]", localizator, i), value);
                } 
```

The problem is with xpath probably since its not trivial.

```
//tr[not(contains(@style,'display: none;'))]/td/span[text()='{0}']/parent::*/following-sibling::*//select[not(contains(@disabled,'true'))] 
```

If i would want to try to selenium.Select(localizator,value) it's working fine but only changes first dropdown selector.

From what i've researched problem might be with using open brackets() in selenium xpath. While trying to execute xpath in firefox firepath everything works fine.

Here is part of my html code.

```
<tr><td width="34%" valign="top" bgcolor="#ffffc7"><span>Podejmij decyzję</span><span></span></td><td width="66%" bgcolor="#ffffc7"><div>
<table cellspacing="0" border="1" style="border-collapse:collapse;" id="4162" rules="all" class="gridViewCtrl">
    <tbody><tr>
        <th scope="col">Produkt</th><th scope="col">Decyzja</th>
    </tr><tr>
        <td>Ekspres Linia</td><td><select id="ctl00_ContentPlaceHolder_4162_ctl02_DropID" name="ctl00$ContentPlaceHolder$4162$ctl02$DropID">
            <option value="1"></option>
            <option value="2">Pozytywna</option>
            <option value="3">Negatywna</option>

        </select><span style="display:none;" class="validation" id="ctl00_ContentPlaceHolder_4162_ctl02_ctl00">Wymagane</span></td>
    </tr><tr>
        <td>AgroEkspres</td><td><select id="ctl00_ContentPlaceHolder_4162_ctl03_DropID" name="ctl00$ContentPlaceHolder$4162$ctl03$DropID">
            <option value="1"></option>
            <option value="2">Pozytywna</option>
            <option value="3">Negatywna</option>

        </select><span style="display:none;" class="validation" id="ctl00_ContentPlaceHolder_4162_ctl03_ctl00">Wymagane</span></td>
    </tr>
</tbody></table> 
```

Also as u might imagine i must use xpath not id's. Thank you for all the help.

**SOLUTION:** Believe it or not i spent almoust 2 hours figuring this out while the solution was really simple. With brackets u just have to explicitely type xpath= in the locator.

Full solution

```
 var localizator = LocalizatorGenerators.SelectOptionLocator(labelName);
                var totalElements = selenium.GetXpathCount((localizator));
                var anyMatched = false;
                for (var i = 1; i <= totalElements; i++)
                {
                    var loc = string.Format("xpath=({0})[{1}]", localizator, i);
                    var options = selenium.GetSelectOptions(loc);
                    foreach (var option in options)
                    {
                        if (option == value){ selenium.Select(loc, value); anyMatched = true}
                    }
                }
                if(!anyMatched) throw new Exception(string.Format("No matching value {0} for label {1}",value,labelName)); 
```

# html - Can I deploy an HTML5 game with Xamarin products?

> ID：15137685
> 
> 赞同：0
> 
> 时间：2013-02-28T14:14:51.093
> 
> 标签：html, xamarin.ios, xamarin.android, xamarin, 2d-games

I have an HTML5 game in the works and was wondering if it would make sense to try and use Xamarin products for deploying my app to iOS, Android and Windows Phone.

*   Do Xamarin products support this?
*   Would I gain anything from using Xamarin products as a wrapper? Ease of deployment, native API access, etc.
*   How would performance be for a simple side scrolling 2D platformer?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T23:06:02.357

Xamarin could be used to wrap an HTML game, but I don't think it makes sense. Bear in mind that with Xamarin you would have to rewrite the UI component for each platform, so in your case you'd manually have to render within a `UIWebView` on iOS, a `WebView` on Android, and so on for each platform you want to support.

Possibly look into other solutions, such as [PhoneGap](http://phonegap.com/), which are squarely aimed at wrapping applications written using the HTML stack. These are likely to have solved many of the problems that you would encounter by trying, using Xamarin or otherwise, to make a wrapper yourself.

# c# - 在应用程序栏项目中添加/删除事件订阅者？

> ID：15137689
> 
> 赞同：2
> 
> 时间：2013-02-28T14:15:08.607
> 
> 标签：c#, silverlight, events, windows-phone-7.1, application-bar

无论如何，我为什么要这样做？这里是：我的应用程序栏项目响应点击是这样的：

```
 <shell:ApplicationBarIconButton IconUri="/Images/appbar_button1.png" Click="Customization" x:Name="Custom" 
```

它允许用户进入设置页面，但在应用导航之前用户仍有一些事情要做。使应用程序导航的实际事件由普通按钮触发。所以，在用户这样做之前，我想从应用程序栏项目中删除事件订阅者。如果我在方法“自定义”的开头尝试这个：

```
 Custom.Click -= new System.EventHandler(Customization); 
```

我得到了 NullReferenceException。

这就是我为我的“正常”物品所做的事情并且它有效。这是我第一次使用 System.EventHandler，所以我可能缺少一些东西。

稍后在该场景中，我希望能够将此订阅者重新添加到应用程序栏项目。任何帮助表示赞赏，谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T14:17:00.087

您不能以这种方式访问​​ AppBarButtons。

尝试

```
((ApplicationBarIconButton)ApplicationBar.Buttons[0]).Click -= new System.EventHandler(Customization); 
```

# javascript - 如何计算在 jquery 中已选中且未禁用的复选框

> ID：15137694
> 
> 赞同：0
> 
> 时间：2013-02-28T14:15:24.277
> 
> 标签：javascript, jquery

如何查找在 jquery 中选中且未禁用的复选框的计数。我尝试使用语句 $(".chkbox:not(:disabled)").attr('checked', this.checked); 但这不能正确维护复选框状态

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-28T14:16:41.687

```
var boxes = $('input[type="checkbox"]').filter(function() {
    return this.checked && !this.disabled;
}).length; 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-28T14:17:13.760

```
$('input[type=checkbox]:checked').not(':disabled').length; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-28T14:17:46.550

```
$("input[type='checkbox']:checked").not("input[disabled='disabled']"); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-28T14:22:36.647

Javascript

```
var $input = $('input[type=checkbox]');
alert($input.not(':disabled').filter(':checked').length); 
```

 HTML

```
 <input type="checkbox" checked="checked">
  <input type="checkbox" checked="checked" disabled="disabled">
  <input type="checkbox"> 
```

[http://jsbin.com/idifot/1/edit](http://jsbin.com/idifot/1/edit)

# three.js - 三.js lightMap 导致报错 WebGLRenderingContext: GL ERROR :GL_INVALID_OPERATION

> ID：15137695
> 
> 赞同：1
> 
> 时间：2013-02-28T14:15:26.867
> 
> 标签：three.js, webgl

我正在为光照贴图加载 jpeg 文件 `var texture = new THREE.ImageUtils.loadTexture("textures/metal.jpg");`
然后我将纹理应用于 THREE.MeshPhongMaterial

```
var frontMaterial = new THREE.MeshPhongMaterial( {
         color: 0xfade7e,
         specular: 0xffffff,
         ambient: 0xaa0000,
         lightMap:texture
    } ) 
```

完整的错误信息是`WebGLRenderingContext: GL ERROR :GL_INVALID_OPERATION : glDrawElements: attempt to access out of range vertices in attribute 2`

这里有什么问题吗？所有浏览器都出现错误。三.js r.56

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T16:09:38.837

正如@alteredq 在[此](https://github.com/mrdoob/three.js/pull/2372)线程中所解释的，a`LightMap`需要第二组 UV。

> 光照贴图的重点是它们可以独立于其他纹理而存在，从而使其他纹理有机会获得更高的细节。光照贴图使用自己的一组 UV 坐标（通常由一些光照烘焙解决方案自动生成，而不是艺术家创建的主要 UV 集）。
> 
> 使用与其他所有东西具有相同 UV 的光照贴图没有多大意义，因为您可以通过将光照贴图与颜色贴图一起烘焙来获得基本相同的结果，但纹理成本更低（这就是 Rage 使用的方法，它看起来很棒但是需要大量的纹理）。
> 
> 光照贴图也应该是乘法的，而不是加法的。光照贴图的大用例是预烘焙阴影和环境光遮蔽，因此您需要能够使事物变暗。

因此，您的问题的答案是`geometry.faceVertexUvs[0]`包含通常的 UV 集；你需要添加到你的几何`geometry.faceVertexUvs[1]`。

三.js r.56

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-30T18:23:31.930

此错误成为因为 Three.js 缓冲区已过时。当您向 Mesh 添加一些纹理（地图、bumpMap ...）时，您必须重新组合缓冲区并更新 UV，如下所示：

```
ob is  THREE.Mesh, mt is a Material, tex is a texture.

tex.needsUpdate = true;
mt.map = tex;
ob.material = mt;
ob.geometry.buffersNeedUpdate = true;
ob.geometry.uvsNeedUpdate = true;
mt.needsUpdate = true; 
```

这就是所有的人！

希望有帮助。

问候。

赛里斯

# sql - 通过比较记录缩小结果集

> ID：15137700
> 
> 赞同：0
> 
> 时间：2013-02-28T14:15:42.313
> 
> 标签：sql, oracle

嗨，我有这个从查询到 X 表的结果集

```
1 | JOHN
2 | JOHN D
3 | JOHN D.
4 | JOHN DO
5 | JOHN DOE
6 | JOHN DD
7 | JOHN DOE.
8 | JOHNY 
```

我需要将这个结果集缩小到这个巧合中的一个结果，我需要将最一致的记录作为有效结果。所以我认为正确的算法是这样的：

1.  从左到右检查记录中第一个单词是否重合（JOHN [七次]）
2.  从左到右检查记录中的第二个单词是否重合（ DOE [两次] ）
3.  确定“JOHN DOE”是重复次数最多的值，OK

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T14:19:54.147

嗯，这在计算上是昂贵的。我会采取的方法是在字段上进行自连接，以查看每个字段之间的重叠：

```
select x.name, count(*)
from x cross join
     x x2
where left(x.name, length(x.name)) = left(x2.name, length(x.name))
group by x.name
order by count(*) desc 
```

我注意到“John”而不是“8”的计数是 7。我怀疑您不想匹配“Johny”。为此，让我们添加一个附加条款：

```
select x.name, count(*)
from x cross join
     x x2
where left(x.name, length(x.name)) = left(x2.name, length(x.name)) and
      (length(x.name = x2.name) or substr(x2.name, length(x.name)+1, 1) = ' ')
group by x.name
order by count(*) desc 
```

为此，它假定您在数据中拥有“最短”版本。因此，如果“John”不是数据行，它将不会寻找“John”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T14:18:29.927

这个怎么样？

```
SELECT  Name
FROM    tableName
GROUP   BY Name
HAVING  COUNT(*) > 1 
```

# c - 头文件中的函数原型与定义不匹配，如何捕捉？

> ID：15137702
> 
> 赞同：9
> 
> 时间：2013-02-28T14:15:50.140
> 
> 标签：c, linker, static-analysis, function-prototypes

（我发现这个问题相似但不重复： [如何检查 C 编程语言中的头文件的有效性](https://stackoverflow.com/questions/7148285/how-to-check-validity-of-header-file-in-c-programming-language)）

我有一个函数实现，以及一个头文件中的不匹配原型（同名，不同类型）。头文件包含在使用函数的 C 文件中，但不包含在定义函数的文件中。

这是一个最小的测试用例：

**标头.h：**

```
void foo(int bar); 
```

**文件1.c：**

```
#include "header.h"
int main (int argc, char * argv[])
{
    int x = 1;
    foo(x);
    return 0;
} 
```

**文件 2.c：**

```
#include <stdio.h>

typedef struct {
    int x;
    int y;
} t_struct;

void foo (t_struct *p_bar)
{
    printf("%x %x\n", p_bar->x, p_bar->y);
} 
```

我可以用 VS 2010 编译它，没有错误或警告，但不出所料，当我运行它时它会出现段错误。

*   编译器很好（我理解）
*   链接器没有捕捉到它（这让我有点惊讶）
*   静态分析工具（Coverity）没有捕捉到它（这让我很惊讶）。

我怎样才能捕捉到这些类型的错误？

[编辑：我意识到如果我也`#include "header.h"`加入`file2.c`，编译器会抱怨。但是我有一个庞大的代码库，并不总是可能或不适合保证函数原型的所有头文件都包含在实现文件中。]

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-28T14:35:47.037

`-Werror-implicit-function-declaration`，`-Wmissing-prototypes`或您支持的编译器之一上的等效项。那么如果声明没有在全局定义之前，它将出错或抱怨。

以某种形式的严格 C99 模式编译程序也应该生成这些消息。GCC、ICC 和 Clang 都支持此功能（不确定 MS 的 C 编译器及其当前状态，因为 VS 2005 或 2008 是我用于 C 的最新版本）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-28T14:18:43.023

Have the same header file included in both `file1.c` and `file2.c`. This will pretty much prevent a conflicting prototype.

Otherwise, such a mistake cannot be detected by the compiler because the source code of the function is not visible to the compiler when it compiles `file1.c`. Rather, it can only trust the signature that has been given.

At least theoretically, the linker could be able to detect such a mismatch if additional metadata is stored in the object files, but I am not aware if this is practically possible.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-30T17:39:39.867

您可以使用[http://frama-c.com](http://frama-c.com)上提供的 Frama-C 静态分析平台。

在你的例子中，你会得到：

```
$ frama-c 1.c 2.c
[kernel] preprocessing with "gcc -C -E -I.  1.c"
[kernel] preprocessing with "gcc -C -E -I.  2.c"
[kernel] user error: Incompatible declaration for foo:
                     different type constructors: int vs. t_struct *
                     First declaration was at  header.h:1
                     Current declaration is at 2.c:8
[kernel] Frama-C aborted: invalid user input. 
```

希望这可以帮助！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-28T15:58:36.080

每个文件中定义的每个（非静态）函数都`foo.c`应该在相应的`foo.h`文件中有一个原型，并且`foo.c`应该有`#include "foo.h"`. （`main`是唯一的例外。）`foo.h`不应包含任何未在`foo.c`.

每个函数都应该原型化*一次*。

如果文件不包含任何原型，您可以拥有`.h`没有相应文件的文件。`.c`唯一`.c`没有对应`.h`文件的文件应该是包含`main`.

您已经知道这一点，而您的问题是您有一个庞大的代码库，但没有遵循此规则。

那么你如何从这里到那里呢？这就是我可能会这样做的方式。

第 1 步（需要一次通过您的代码库）：

*   对于每个文件，如果它不存在，则`foo.c`创建一个文件。在顶部附近`foo.h`添加。如果您对文件的存放位置有约定（在同一目录中或与目录并行），请遵循它；如果没有，请尝试引入这样的约定）。`"#include "foo.h"``foo.c``.h``.c``include``src`
*   对于 中的每个函数，如果它不存在，则将`foo.c`其原型复制到。`foo.h`使用复制和粘贴来确保一切保持一致。（参数名称在原型中是可选的，在定义中是强制性的；我建议在这两个地方都保留名称。）
*   进行完整构建并修复出现的任何问题。

这不会抓住你所有的问题。对于某些功能，您仍然可以有多个原型。但是您会发现任何情况，即两个标头对于同一函数的原型不一致，*并且*两个标头都包含在同一个翻译单元中。

一旦一切都构建得很干净，您应该拥有一个至少与您开始使用的系统一样正确的系统。

第2步：

*   对于每个文件`foo.h`，删除任何未定义的函数原型`foo.c`.
*   进行完整构建并修复出现的任何问题。如果`bar.c`调用定义在 中的函数`foo.c`，则`bar.c`需要一个`#include "foo.h".`

对于这两个步骤，“修复出现的任何问题”阶段可能会很漫长且乏味。

如果您不能一次完成所有这些，您可能可以逐步完成很多。从一个或几个`.c`文件开始，清理它们的`.h`文件，并删除在其他地方声明的任何额外原型。

每当您发现调用使用了不正确的原型的情况时，请尝试找出执行该调用的情况，以及它如何导致您的应用程序行为异常。创建一个错误报告并向你的回归测试套件添加一个测试（你有一个，对吧？）。您可以向管理层证明，由于您所做的所有工作，测试现在通过了；你真的不只是在胡闹。

可以解析 C 的自动化工具可能很有用。Ira Baxter 有一些建议。`ctags`也可能有用。根据您的代码格式，您可能可以将一些不需要完整 C 解析器的工具放在一起。例如，您可以使用`grep`、`sed`或`perl`从`foo.c`文件中提取函数定义列表，然后手动编辑列表以删除误报。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-28T16:03:24.823

看起来这对于 C 编译器是不可能的，因为它的函数名称映射到符号对象名称的方式（直接，不考虑实际签名）。

但这在 C++ 中是可能的，因为它使用依赖于函数签名的**名称修饰。**所以在 C++ 中`void foo(int)`，`void foo(t_struct*)`链接阶段会有不同的名称，链接器会引发错误。

当然，将庞大的 C 代码库依次切换到 C++ 并不容易。但是您可以使用一些相对简单的解决方法 - 例如，将单个`.cpp`文件添加到您的项目中并将所有 C 文件包含在其中（实际上是使用一些脚本生成它）。

`TestCpp.cpp`以您的示例和我添加到项目中的 VS2010 为例：

```
#include "stdafx.h"

namespace xxx
{
#include "File1.c"
#include "File2.c"
} 
```

结果是链接器错误 LNK2019：

```
TestCpp.obj : error LNK2019: unresolved external symbol "void __cdecl xxx::foo(int)" (?foo@xxx@@YAXH@Z) referenced in function "int __cdecl xxx::main(int,char * * const)" (?main@xxx@@YAHHQAPAD@Z)
W:\TestProjects\GenericTest\Debug\GenericTest.exe : fatal error LNK1120: 1 unresolved externals 
```

当然，对于庞大的代码库来说，这并不容易，可能还有其他问题导致编译错误，如果不更改代码库就无法修复。`.cpp`您可以通过有条件地保护文件内容`#ifdef`并仅用于定期检查而不是用于常规构建来部分缓解它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-28T15:24:57.160

很明显（“我有一个庞大的代码库”）你不能手动完成。

您需要的是一个自动化工具，它可以在编译器看到它们时读取您的源文件，收集所有函数原型和定义，并验证所有定义/原型是否匹配。我怀疑你会发现这样的工具。

当然，这种匹配多检查签名，这需要编译器前端之类的东西来比较签名。

考虑

```
 typedef int T;
     void foo(T x); 
```

在一个编译单元中，并且

```
 typedef float T;
      void foo(T x); 
```

在另一个。您不能只比较签名“行”是否相等；你需要一些可以在检查时解析类型的东西。

如果您使用的是 C 的 GCC 方言，GCCXML 可能会有所帮助；它从源文件中提取顶级声明作为 XML 块。不过，我不知道它是否会解析 typedef。您显然必须构建（相当多的）支持以在中心位置（数据库）收集定义并进行比较。比较等效的 XML 文档至少相当简单，如果它们以常规方式格式化，则相当容易。这可能是您最容易的选择。

如果这不起作用，您需要具有可以自定义的完整 C 前端的东西。众所周知，GCC 是可用的，并且难以定制。Clang 可用，并且可能会为此服务，但 AFAIK 仅适用于 GCC 方言。

我们的 DMS Software Reengineering Toolkit 具有适用于许多 C 方言（GCC、MS、GreenHills 等）的 C 前端（具有完整的预处理能力），并使用完整的类型信息构建符号表。使用 DMS，您可能能够（取决于应用程序的实际规模）简单地处理所有编译单元，并仅为每个编译单元构建符号表。检查符号表条目是否“匹配”（根据编译器规则兼容，包括使用等效的 typedef）是内置在 C 前端中的；所有需要做的就是编排读取，并在各个编译单元的全局范围内为所有符号表条目调用匹配逻辑。

无论您使用 GCC/Clang/DMS 执行此操作，拼凑一个自定义工具都是相当多的工作。因此，与构建这种定制工具的精力相比，您已经决定了减少惊喜的重要性。

# php - 重新安排房间

> ID：15137705
> 
> 赞同：-5
> 
> 时间：2013-02-28T14:15:55.000
> 
> 标签：php

为什么它仍然获得取消状态的房间？有人能帮帮我吗？正确的语法应该是什么？

```
$que=mysql_query("SELECT * from roomreservation where roomtype='$roomtype' and name='$name' and status != 'cancelled' and  

arrival > '$arrival' and arrival < '$departure' and
or
departure >'$arrival' and  departure <'$departure' and
or
'$arrival'  > arrival and '$arrival' < departure and
or
'$departure' > arrival and '$departure' < departure and
or
'$arrival' = arrival and '$departure' = departure and
or
'$arrival' = arrival or '$departure' = departure and

");

$num_rows = mysql_num_rows($que);
if($num_rows >0)
    {   $error="Room Already Reserved <br/>Please Choose another date";
        header("location:rescheduleroom.php?    id=$id&type=$roomtype&roomnumber=$name&error=$error");
            } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T14:48:08.983

您的逻辑非常复杂。它可以归结为：

```
SELECT ...
WHERE roomtype='$roomtype' and name='$name' and status != 'cancelled'
   and ('$departure' >= arrival) and ('$arrival' <= departure) 
```

从本质上讲，您有以下内容。一个可用/不可用的房间，以及关于潜在到达/离开日期如何与该可用性重叠的一系列选项

```
room:      ........XXXXXXXXX.......   <--- . = available, X = in use
         1    A  D
         2       A    D
         3           A    D
         4              A      D
         5                    A   D 
```

案例 1 和 5 显然是可用的 - A/D 时间点不与房间的不可用重叠。2,3,4 是大的，它们部分/完全与停电期重叠。但是如果你仔细观察，在所有需要考虑的情况下，`A`是在停电结束之前，在停电`D`开始之后，所以你的巨大丑陋和/或链条只是

```
 ('$arrival' <= departure) AND ('$departure' >= arrival) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T14:19:45.493

尝试类似：

```
 SELECT * from roomreservation where  
   roomtype='$roomtype' and name='$name' and status != 'cancelled' and  
( arrival > '$arrival' and arrival < '$departure' )  
or  
(departure >'$arrival' and  departure <'$departure')  
or
('$arrival'  > arrival and '$arrival' < departure )
or
('$departure' > arrival and '$departure' < departure )
or
('$arrival' = arrival and '$departure' = departure )
or '$arrival' = arrival or '$departure' = departure 
```

注意：这仍然是一团糟 - 但它*更接近*。

# php - CodeIgniter/PHP中基于属性值提取对象

> ID：15137709
> 
> 赞同：0
> 
> 时间：2013-02-28T14:16:16.380
> 
> 标签：php, codeigniter, object, properties, codeigniter-2

我正在尝试从`$delegates`具有与当前事件 id 匹配的“event_id”的对象中检索所有委托，该事件 id 存储在变量中`$current_event_id`。

也就是说，我已经创建了一个辅助函数来完成这项工作，并且我将该函数包含在我的控制器中。

我已经设法让它在一定程度上发挥作用，因为它显示了我所追求的代表，每个代表都在一个列表项中，但它也为每个“event_id”没有的代表显示一个空白列表项匹配当前事件 ID。

这是我的代码：

```
function total_delegate_info( $delegates, $current_event_id ) {
    $total_delegate_info = '<ul>';
    foreach ( $delegates as $delegate ) {
        $total_delegate_info .= '<li>';
        if(  $delegate->event_id == $current_event_id ) {
            $total_delegate_info .= $delegate->delegate_first_name . ' ' . $delegate->delegate_last_name;
        }
        $total_delegate_info .= '</li>';
    }
    $total_delegate_info .= '</ul>';
    return $total_delegate_info;
} 
```

关于如何改进此功能的任何想法？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T14:34:34.407

真的很傻，但这显然是因为我在 if 语句之外生成列表标签。嗬！

```
 function total_delegate_info( $delegates, $current_event_id ) {

        $total_delegate_info = '<ul>';

            foreach ( $delegates as $delegate ) {

                    if( $delegate->event_id == $current_event_id ) {

                        $total_delegate_info .= '<li>';

                            $total_delegate_info .= $delegate->delegate_first_name . ' ' . $delegate->delegate_last_name;

                        $total_delegate_info .= '</li>';

                    }

            }
        $total_delegate_info .= '</ul>';

        return $total_delegate_info;

    } 
```

# java - 解析 Json 数组错误“jsonObject 无法解析”

> ID：15137716
> 
> 赞同：0
> 
> 时间：2013-02-28T14:16:35.733
> 
> 标签：java, json, parsing

我有以下 Json，我想解析数组 (cars) ，

```
[
{
"name": "John",
"city": "Berlin",
"cars": [
"audi",
"bmw"
], 
```

当我尝试使用以下代码时出现错误

```
JSONParser parser = new JSONParser();

    JSONArray a = (JSONArray) parser.parse(new FileReader(
            "C:\\General\\Json\\json.txt"));

    for (Object o : a) {
        JSONObject person = (JSONObject) o;

        String name = (String) person.get("name");
        System.out.println(name);

        String city = (String) person.get("city");
        System.out.println(city);

        String job = (String) person.get("job");
        System.out.println(job);

    } 
```

这是错误**“无法解析jsonObject”** 我应该如何克服它？

```
JSONArray cars = (JSONArray) jsonObject.get("cars"); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T14:19:27.237

```
 you did not declared jsonObject 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T09:56:59.447

JSONArray cars = (JSONArray) person.get("cars"); 试试这个而不是 JSONArray cars = (JSONArray) jsonObject.get("cars"); 这个 PSR 也正确

# java - 如何检查方法的哪一部分使用时间最多？

> ID：15137719
> 
> 赞同：1
> 
> 时间：2013-02-28T14:16:40.567
> 
> 标签：java, profiling, micro-optimization

我正在开发一个优化现有算法的项目。我用 JIP 和 VisualVM 分析了代码，发现了一个主要瓶颈。

现在我想看看在方法中花费最多时间的是什么。有什么简单的方法可以做到这一点？是否有分析器可以为我提供该信息，或者我是否需要开始计时方法中的每个步骤并将其写入文件？

编辑：这应该是代码在输入集上运行时

编辑 2：我正在谈论的方法被称为 1 亿次以上，总运行时间为 +/-500 秒。所以代码中的每一次优化都会有显着的提升。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T14:20:06.393

如果您正在寻找在代码执行时分析代码的工具，您将需要研究[动态分析工具](http://en.wikipedia.org/wiki/Dynamic_program_analysis)。文章中提到了 JTest（用于 Java），但恐怕我还没有使用过它。

您也可以使用像[soot](http://en.wikipedia.org/wiki/Soot_%28software%29)这样的静态代码分析工具，取得不同程度的成功。这些工具将识别代码中执行时间最长的区域。

其他包括：`SonarJ, PMD, Kalistick`

我使用 soot 等工具的方式是将其绑定到我的构建管理工具中。所以对于maven，它会被配置成这样：

```
 <plugin>
    <groupId>net.ju-n.maven.plugins</groupId>
    <artifactId>soot-maven-plugin</artifactId>
    <version>0.1.1</version>
    <executions>
      <execution>
        <goals>
          <goal><!-- put the goal name here --></goal>
        </goals>
      </execution>
    </executions>
    <configuration>
        <!-- put your configurations here -->
    </configuration>
  </plugin> 
```

然后我会将其配置为在 Maven 配置文件中运行（最好在构建服务器上）并发布结果。

执行的目标是：`mvn soot:soot`

请注意，静态分析是在代码上执行的，而不是实际执行代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T14:29:38.523

[JUnitBenchmarks](http://labs.carrotsearch.com/junit-benchmarks.html)可以提供帮助。带有时间戳的“蛮力”检查怎么样？

方法的相关部分之间？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-28T19:24:01.973

不要通过测量时间来做到这一点。

通过在调试器中抓取快照来做到这一点。这将向您展示它正在做的最好的水平。不管它在做什么，如果你在两个或更多快照上发现它在做 - 认为它是一个错误。如果你能避免它，你将节省大量时间。

多少时间？当你修复它时你会发现，但是看到它两次的快照越少，你保存的越多。

如果你害怕它找不到“问题”，别担心，它会的，而且这可能是你没想到的。[*更多关于这一切......*](https://stackoverflow.com/a/4390868/23771)

# compiler-construction - 单行程序在 Lazarus 中不起作用（Object Pascal）

> ID：15137722
> 
> 赞同：0
> 
> 时间：2013-02-28T14:16:46.927
> 
> 标签：compiler-construction, lazarus

我有一个事件 - onClickButton 只有一行：

```
Button1.Caption:="ABC"; 
```

它不能正常工作 - 单击按钮后没有效果。当我插入另一个新行时，例如：

```
if x=10 then exit; //x=0 and exit doesn't invoke;
Button1.Caption:="ABC"; 
```

它有效（按钮上的标题已更改）。

任何重新编译，构建都不起作用。我其他时间或在其他计算机上它在这两种情况下都有效。

我能做些什么来避免这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-19T20:17:02.217

有时系统没有注意到某些东西已经改变并且应该重新粉刷。您是否尝试过在按钮或整个应用程序上调用或`refresh`方法？对这种方法有很好的解释：[Refresh、Update 和 Repaint 有什么区别？](https://stackoverflow.com/questions/1251009/whats-the-difference-between-refresh-update-repaint)`repaint``update`

# javascript - 谷歌地图，检测信息窗口何时不完全可见

> ID：15137724
> 
> 赞同：1
> 
> 时间：2013-02-28T14:16:49.617
> 
> 标签：javascript, google-maps, infowindow

我需要检测（使用 API v3）我的 infowindows 是否完全可见。

（如果不完全可见，我可以调用 setCenter）。谢谢，

# python - /addbook/ 处的 MultiValueDictKeyError

> ID：15137725
> 
> 赞同：1
> 
> 时间：2013-02-28T14:16:50.483
> 
> 标签：python, mysql, django

```
def addbook(request):
    if request.method == 'POST':
        book_name =request.POST['book_name']
    Book = Book.objects.get()
        Book.save()
        return render_to_response('book_detail.html', {'books': books},context_instance=RequestContext(request))
    else:
        return render_to_response('addbook.html',context_instance=RequestContext(request))

def book_detail(request):
    return render(request, 'book_detail.html') 
```

以上是我的 view.py 我收到此错误“MultiValueDictKeyError at /addbook/”

请帮我

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T14:19:45.977

该错误意味着“book_name”不在您的 POST 数据中。

如果你想处理这种情况，你可以使用 book_name = request.POST.get('book_name')，如果它不在 POST 数据中，它将默认 book_name 为 None。

如果没有，您需要确保表单有一个名为“book_name”的输入。

# java - 如何确保没有调用实例的方法？

> ID：15137729
> 
> 赞同：3
> 
> 时间：2013-02-28T14:17:03.607
> 
> 标签：java, unit-testing, mocking

我的代码中有几个[小技巧](http://en.wikipedia.org/wiki/God_object)，在测试时会引起痛苦。假设将小神打成碎片对于这个练习来说太费力了。

通常的问题是我想测试一个方法`x()`，`Foo`但是要创建一个实例`Foo`，我需要定义 N (1 < N < 10) 个模拟实例，这些实例只是为了满足 Spring 的`@Autowire`. 在生产中，我必须确保这些字段是连线的，因此不能选择这些字段。

我看到的可能解决方案：

1.  以某种方式告诉 Spring`@Autowire`在测试期间某些字段是可选的
2.  为被测代码不需要/不应该需要的任何东西传递不可调用的模拟。

由于我不知道#1 的方法，我认为#2 是要走的路。我更喜欢的是一个 bean 工厂，它返回一个代理，该代理会为我未定义的任何 bean 的任何方法调用引发异常。

所以对于任何未知的bean，它都应该调用这个`create`方法：

```
import java.lang.reflect.InvocationHandler;
import java.lang.reflect.Method;
import java.lang.reflect.Proxy;

public class MustNotCallMe {

    @SuppressWarnings( "unchecked" )
    public static <T> T create( final Class<T> type, final Class<?>... types ) {
        InvocationHandler handler = new InvocationHandler() {

            @Override
            public Object invoke( Object proxy, Method method, Object[] args ) throws Throwable {

                if( "equals".equals( method.getName() ) && Object.class.equals( method.getDeclaringClass() ) ) {
                    return proxy == args[0];
                }

                throw new UnsupportedOperationException( "You must not call " + method );
            }
        };

        Class<?>[] allClasses = new Class<?>[ types.length + 1 ];
        allClasses[0] = type;
        System.arraycopy( types, 0, allClasses, 1, types.length );

        return (T) Proxy.newProxyInstance( MustNotCallMe.class.getClassLoader(), allClasses, handler );
    }
} 
```

这样的事情存在吗？如果没有，我将如何在 Spring 3 单元测试中注入我自己的 bean 工厂？

**编辑**我知道这个想法会让任何语言纯粹主义者感到不安。只有现实很少是纯粹的。如果这里有人愿意站出来为我们提供重构软件所需的资金和人力，我们很乐意听到。在那之前，无需大量手动工作即可解决问题的解决方案可以更好地解决我们的特定问题:-)

也就是说，我所需要的只是一种方法来创建一个`BeanFactory`从不抛出`NoSuchBeanException`但返回一个“不要打电话给我”的代理。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T14:48:52.110

我对这个领域相当陌生，但我认为 Spring 的整个想法是很容易更换部件以进行测试和其他环境变化。

从一个（认为他）理解概念但没有实现任何主要内容的人的角度来看，这有什么问题：每个自动装配的部分都是一个接口。想象一个实现该接口的类，其中每个方法只调用某种错误报告机制——它可以对所有方法都是同一个。创建这样一个类（手动）应该很快，不容易出错，现在你有了你的“模拟”。如果你有 10 个，那么为每个人创建这样一个类应该不会花那么长时间。

现在创建一个 spring 配置文件，该文件传递给定一组测试所需的这些模拟。如果有东西调用了一个模拟类，它会吐出上面的错误。当然，对于不同的测试环境，不同的配置可以包括不同的模拟。

我在这里想念什么？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T15:12:33.260

黄金路径是：不要在测试中使用 Spring，只需使用普通的 java 代码设置依赖项。如果这很痛苦，那么您就有了如何重构代码的有力指标。这是一件好事。对于不应调用的依赖项，您提供在每次方法调用时都会爆炸的模拟。实现这一点的一个简单方法应该是这个漂亮的 Mockito 功能：[http ://docs.mockito.googlecode.com/hg/org/mockito/Mockito.html#14](http://docs.mockito.googlecode.com/hg/org/mockito/Mockito.html#14)

肮脏的道路：如果你陷入了一个遗留的沼泽，你不能忍受在测试中设置所有依赖项（并且小神的存在是一个指标），你可以使用`SpringJUnit4ClassRunner`+ Spring 配置文件（如果你使用我认为 Spring 3.1 或更高版本）。

有了这个，您可以拥有一个`prod`用于生产环境的`integrationtest`配置文件，以及一个用上述模拟替换所有不能调用的 bean 的配置文件。谷歌“spring + profiles”查看各种教程。它很简单，而且工作起来就像一个魅力......但只有当你有一套固定的豆子想要更换时才适合。如果你有 50 个测试，每个测试都需要 20 个不同的 bean 子集，而这些 bean 被 Blowing-up-on-call-beans 替换，情况会变得更糟：

地狱般的道路：使用 Spring，但在每个测试级别上用 Blowing-up-on-call-bean 替换一组特定的 bean。您可以通过特殊的上下文配置来做到这一点，其中包含要替换的单个 bean 的配置。它必须与生产 bean 具有相同的名称/ID，但在调用实现时会爆炸（如果您愿意，可以再次通过 Mockito）。然后在每个测试中使用 ContextConfiguration 注解，如下所示：

```
@ContextConfiguration(locations = {"applicationContext.xml", "blowUpDemiGod42.xml",
    "blowUpDemiGod23.xml"}) 
```

这将使`blowUpDemiGod*.xml`文件中的配置覆盖您的配置`applicationContext.xml`

可能有一种地狱般的路径的轻量级形式，您可以在其中通过 Java 代码在测试中提供 bean ...不确定。

# c# - ListView 选择逻辑

> ID：15137732
> 
> 赞同：1
> 
> 时间：2013-02-28T14:17:12.993
> 
> 标签：c#, winforms, listview, logic

我有一个 ListView，其中 MultiSelect = false、View = Details 和 CheckBoxes = True。我正在逐步浏览它并控制应用程序中的可见性。我目前只使用下面代码的 Else 部分。但它不考虑第一个项目被选中，它只是打开第二个项目。以及该项目是否被选中（已经可见），它会关闭可见性。我正在将与项目关联的元素与已经可见的元素进行比较。我的应用程序在 currentItem.Checked 循环中崩溃。并且不考虑组合（首先和检查）。我怎么能编码呢？

```
 int indexCount = listView1.Items.Count;

        ListViewItem currentItem = listView1.SelectedItems[0];
        int currentIndex = currentItem.Index;

        if (currentItem.Index == 0)
        {
            //listView1.SelectedItems[0] on
        }

        if (currentItem.Index == indexCount)
        {
            //end
        }

        if (currentItem.Checked == true)
        {
            while (currentItem.Checked == true)
            {
                listView1.SelectedIndices.Clear();
                listView1.SelectedIndices.Add(currentIndex + 1);
            }
            //listView1.SelectedItems[0] on 
        }

        else
        {
            //listView1.SelectedItems[0] off

            listView1.SelectedIndices.Clear();
            listView1.SelectedIndices.Add(currentIndex + 1);

            //listView1.SelectedItems[0] on                
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T14:46:52.100

目前尚不清楚您要做什么。

您基本上是在选择一个选定的项目并将其放在“currentItem”中。如果该项目被检查为真，您将循环通过它直到？为什么？

# mysql - 需要 MySQL 查询优化提示

> ID：15137735
> 
> 赞同：1
> 
> 时间：2013-02-28T14:17:17.983
> 
> 标签：mysql, indexing, query-optimization, explain

你能帮我对付一个怪物吗？

你觉得这个有什么问题吗？

想达到秒以下的执行时间，有可能吗？

请询问您可能需要了解数据库结构的任何其他数据。欢迎任何提示和技巧！

```
SELECT 
    ORD_CLI.COD_AGE,
    ORD_CLI_RIGHE.DOC_ID,
    OFF_CLI.off_cli_id,
    ORD_CLI_RIGHE.DOC_RIGA_ID,
    ORD_CLI_RIGHE.COD_ART,
    ART_PESO.PESO_ART,
    ORD_CLI.ANNO_DOC,
    ORD_CLI.NUM_DOC,
    ORD_CLI.SERIE_DOC,
    ORD_CLI.DATA_DOC,
    CF.RAG_SOC_CF,
    AGENTI.NOME_AGE,
    ORD_CLI.COD_CF,
    ORD_CLI.COD_IVA,
    ORD_CLI.COD_DEP,
    ORD_CLI_TOT.IMPONIBILE_V1 AS IMPONIBILE_ORDINE,
    FATT_CLI_TOT.IMPONIBILE_V1 AS IMPONIBILE_FATTURA,
    ORD_CLI_TOT.IVA_V1,
    SUM(ART_PESO.PESO_ART) AS weight,
    SUM(FATT_CLI_RIGHE.QUANT_RIGA) AS quantity,
    SUM(FATT_CLI_RIGHE.QUANT_RIGA*FATT_CLI_RIGHE.PREZZO_LORDO_VU1) AS sell_price,
    SUM(FATT_CLI_RIGHE.QUANT_RIGA*DDT_FOR_RIGHE.PREZZO_LORDO_VU1) AS acqisition_price1,
    SUM(FATT_CLI_RIGHE.QUANT_RIGA*FATT_FOR_RIGHE.PREZZO_LORDO_VU1) AS acqisition_price2,
    SUM(FATT_CLI_RIGHE.QUANT_RIGA*FATT_CLI_RIGHE_PROVV.IMPORTO_PROVV_VU1) AS agent_reward,
    SUM(FATT_CLI_RIGHE.QUANT_RIGA*ART_PESO.PESO_ART * 0.13) AS transport_price,
    SUM(FATT_CLI_RIGHE.QUANT_RIGA*(
          FATT_CLI_RIGHE.PREZZO_LORDO_VU1 
        - COALESCE(DDT_FOR_RIGHE.PREZZO_LORDO_VU1, 0)
        - COALESCE(FATT_FOR_RIGHE.PREZZO_LORDO_VU1, 0)
        - COALESCE(FATT_CLI_RIGHE_PROVV.IMPORTO_PROVV_VU1, 0)
        - COALESCE(ART_PESO.PESO_ART, 0) * 0.13
    )) AS net_earning,
    OFF_CLI.stima_prezzo_acquisto,
    OFF_CLI.stima_prezzo_trasporto,
    OFF_CLI.stima_provvigioni_agenti,
    OFF_CLI.stima_utile

FROM ORD_CLI 

INNER JOIN ORD_CLI_RIGHE         
    ON ORD_CLI_RIGHE.DOC_ID = ORD_CLI.DOC_ID 

LEFT JOIN ORD_CLI_RIGHE_SPEC   
    ON ORD_CLI_RIGHE.DOC_RIGA_ID = ORD_CLI_RIGHE_SPEC.DOC_RIGA_ID

INNER JOIN ART_PESO 
    ON ART_PESO.COD_ART = ORD_CLI_RIGHE.COD_ART

INNER JOIN ORD_CLI_TOT 
    ON ORD_CLI.DOC_ID = ORD_CLI_TOT.DOC_ID

INNER JOIN AGENTI 
    ON AGENTI.COD_AGE = ORD_CLI.COD_AGE

INNER JOIN CF 
    ON CF.COD_CF = ORD_CLI.COD_CF

LEFT JOIN FATT_CLI_RIGHE_SPEC   
    ON ORD_CLI_RIGHE.DOC_RIGA_ID = FATT_CLI_RIGHE_SPEC.ORD_RIGA_ID

LEFT JOIN FATT_CLI_RIGHE        
    ON FATT_CLI_RIGHE.DOC_RIGA_ID = FATT_CLI_RIGHE_SPEC.DOC_RIGA_ID

LEFT JOIN FATT_CLI_TOT
    ON FATT_CLI_RIGHE.DOC_ID = FATT_CLI_TOT.DOC_ID

LEFT JOIN FATT_CLI_RIGHE_PROVV 
    ON FATT_CLI_RIGHE_PROVV.DOC_RIGA_ID = FATT_CLI_RIGHE_SPEC.DOC_RIGA_ID

LEFT JOIN FATT_CLI_RIGHE_LOTTI 
    ON FATT_CLI_RIGHE_LOTTI.DOC_RIGA_ID = FATT_CLI_RIGHE_SPEC.DOC_RIGA_ID

LEFT JOIN  DDT_FOR_RIGHE_LOTTI  
    ON DDT_FOR_RIGHE_LOTTI.COD_LOT = FATT_CLI_RIGHE_LOTTI.COD_LOT

LEFT JOIN  DDT_FOR_RIGHE         
    ON DDT_FOR_RIGHE.DOC_RIGA_ID = DDT_FOR_RIGHE_LOTTI.DOC_RIGA_ID

LEFT JOIN FATT_FOR_RIGHE         
    ON FATT_FOR_RIGHE.DOC_RIGA_ID = FATT_CLI_RIGHE_LOTTI.COD_LOT

LEFT JOIN OFF_CLI_RIGHE
    ON OFF_CLI_RIGHE.DOC_RIGA_ID = ORD_CLI_RIGHE_SPEC.OFF_RIGA_ID

LEFT JOIN OFF_CLI
    ON OFF_CLI.DOC_ID = OFF_CLI_RIGHE.DOC_ID

WHERE 
    ORD_CLI.COD_BUSN_UN='P' 
AND OFF_CLI_RIGHE.DOC_RIGA_ID IS NOT NULL

AND ORD_CLI.DATA_DOC >= '2012-11-29'
AND ORD_CLI.DATA_DOC <= '2013-02-28'   
GROUP BY ORD_CLI.DOC_ID 
ORDER BY   ORD_CLI.DATA_DOC 
DESC LIMIT 30 OFFSET 0 
```

执行时间

```
Showing rows 0 - 29 ( 30 total, Query took 6.3458 sec) 
```

查询的解释

```
+----+-------------+----------------------+--------+-----------------------------------------------------------------------------+----------------------------------+---------+--------------------------------------------+------+----------+----------------------------------------------+
| id | select_type | table                | type   | possible_keys                                                               | key                              | key_len | ref                                        | rows | filtered | Extra                                        |
+----+-------------+----------------------+--------+-----------------------------------------------------------------------------+----------------------------------+---------+--------------------------------------------+------+----------+----------------------------------------------+
|  1 | SIMPLE      | ORD_CLI              | range  | PRIMARY,ORD_CLI_DATA_DOC,ORD_CLI_COD_CF,ORD_CLI_COD_BUSN_UN,ORD_CLI_COD_AGE | ORD_CLI_DATA_DOC                 | 4       | NULL                            | 3728 |   100.00 | Using where; Using temporary; Using filesort |
|  1 | SIMPLE      | AGENTI               | eq_ref | PRIMARY                                                                     | PRIMARY                          | 38      | ORD_CLI.COD_AGE                 |    1 |   100.00 | Using where                                  |
|  1 | SIMPLE      | CF                   | eq_ref | PRIMARY                                                                     | PRIMARY                          | 38      | ORD_CLI.COD_CF                  |    1 |   100.00 |                                              |
|  1 | SIMPLE      | ORD_CLI_TOT          | eq_ref | PRIMARY                                                                     | PRIMARY                          | 62      | ORD_CLI.DOC_ID                  |    1 |   100.00 |                                              |
|  1 | SIMPLE      | ORD_CLI_RIGHE        | ref    | PRIMARY,ORD_CLI_RIGHE_DOC_ID,ORD_CLI_RIGHE_COD_ART                          | ORD_CLI_RIGHE_DOC_ID             | 62      | ORD_CLI_TOT.DOC_ID              |    2 |   100.00 | Using where                                  |
|  1 | SIMPLE      | ART_PESO             | eq_ref | PRIMARY                                                                     | PRIMARY                          | 92      | ORD_CLI_RIGHE.COD_ART           |    1 |   100.00 |                                              |
|  1 | SIMPLE      | ORD_CLI_RIGHE_SPEC   | eq_ref | PRIMARY,ORD_CLI_RIGHE_SPEC_OFF_RIGA_ID                                      | PRIMARY                          | 92      | ORD_CLI_RIGHE.DOC_RIGA_ID       |    1 |   100.00 | Using where                                  |
|  1 | SIMPLE      | OFF_CLI_RIGHE        | ref    | DOC_RIGA_ID                                                                 | DOC_RIGA_ID                      | 92      | ORD_CLI_RIGHE_SPEC.OFF_RIGA_ID  |    1 |   100.00 | Using where                                  |
|  1 | SIMPLE      | OFF_CLI              | ref    | DOC_ID                                                                      | DOC_ID                           | 63      | OFF_CLI_RIGHE.DOC_ID              |    1 |   100.00 |                                              |
|  1 | SIMPLE      | FATT_CLI_RIGHE_SPEC  | ref    | FATT_CLI_RIGHE_SPEC_ORD_RIGA_ID                                             | FATT_CLI_RIGHE_SPEC_ORD_RIGA_ID  | 93      | ORD_CLI_RIGHE.DOC_RIGA_ID       |    1 |   100.00 | Using index                                  |
|  1 | SIMPLE      | FATT_CLI_RIGHE       | eq_ref | PRIMARY                                                                     | PRIMARY                          | 92      | FATT_CLI_RIGHE_SPEC.DOC_RIGA_ID |    1 |   100.00 |                                              |
|  1 | SIMPLE      | FATT_CLI_TOT         | eq_ref | PRIMARY                                                                     | PRIMARY                          | 62      | FATT_CLI_RIGHE.DOC_ID           |    1 |   100.00 |                                              |
|  1 | SIMPLE      | FATT_CLI_RIGHE_PROVV | ref    | FATT_CLI_RIGHE_PROVV_DOC_RIGA_ID                                            | FATT_CLI_RIGHE_PROVV_DOC_RIGA_ID | 92      | FATT_CLI_RIGHE_SPEC.DOC_RIGA_ID |    1 |   100.00 |                                              |
|  1 | SIMPLE      | FATT_CLI_RIGHE_LOTTI | ref    | FATT_CLI_RIGHE_LOTTI_DOC_RIGA_ID                                            | FATT_CLI_RIGHE_LOTTI_DOC_RIGA_ID | 92      | FATT_CLI_RIGHE_SPEC.DOC_RIGA_ID |    1 |   100.00 |                                              |
|  1 | SIMPLE      | DDT_FOR_RIGHE_LOTTI  | ref    | DDT_FOR_RIGHE_LOTTI_COD_LOT                                                 | DDT_FOR_RIGHE_LOTTI_COD_LOT      | 92      | FATT_CLI_RIGHE_LOTTI.COD_LOT    |    1 |   100.00 |                                              |
|  1 | SIMPLE      | DDT_FOR_RIGHE        | eq_ref | PRIMARY                                                                     | PRIMARY                          | 92      | DDT_FOR_RIGHE_LOTTI.DOC_RIGA_ID |    1 |   100.00 |                                              |
|  1 | SIMPLE      | FATT_FOR_RIGHE       | eq_ref | PRIMARY                                                                     | PRIMARY                          | 92      | FATT_CLI_RIGHE_LOTTI.COD_LOT    |    1 |   100.00 |                                              |
+----+-------------+----------------------+--------+-----------------------------------------------------------------------------+----------------------------------+---------+--------------------------------------------+------+----------+----------------------------------------------+ 
```

以下是`show status like 'Handler%'`执行查询后excatly的结果

```
Handler_commit, 2
Handler_delete, 0
Handler_discover, 0
Handler_prepare, 0
Handler_read_first, 0
Handler_read_key, 421001
Handler_read_last, 0
Handler_read_next, 240344
Handler_read_prev, 0
Handler_read_rnd, 30
Handler_read_rnd_next, 2412
Handler_rollback, 0
Handler_savepoint, 0
Handler_savepoint_rollback, 0
Handler_update, 31846
Handler_write, 2409 
```

数据库结构：[https ://gist.github.com/moiseevigor/4988fc8868f92643c9fb](https://gist.github.com/moiseevigor/4988fc8868f92643c9fb)

**编辑 1**

创建索引后

```
ALTER TABLE `TCross5_NP`.`ORD_CLI` 
ADD INDEX `ORD_CLI_MULTI` (`COD_BUSN_UN` ASC, `DATA_DOC` ASC, `DOC_ID` ASC) ; 
```

执行时间减少了 2 倍，但仍然达到`ORD_CLI_MULTI`索引

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T14:56:36.120

首先，（并且在您似乎正在处理大量“查找”辅助表引用的许多其他类似查询中有所帮助），将查询开始更改为

```
SELECT STRAIGHT_JOIN 
```

它指示引擎按照您列出的确切顺序运行查询。这将阻止它尝试使用查找表作为主要考虑因素，并尝试使用反词或结束来获取数据。有时效果很好，有时（根据我的经验很少）会阻碍性能。

接下来，由于您正在寻找“AND OFF_CLI_RIGHE.DOC_RIGA_ID IS NOT NULL”，我会在加入时将您的 LEFT JOIN 更改为 INNER JOIN。

```
INNER JOIN ORD_CLI_RIGHE_SPEC   
   ON ORD_CLI_RIGHE.DOC_RIGA_ID = ORD_CLI_RIGHE_SPEC.DOC_RIGA_ID

   INNER JOIN OFF_CLI_RIGHE
      ON ORD_CLI_RIGHE_SPEC.OFF_RIGA_ID = OFF_CLI_RIGHE.DOC_RIGA_ID 
```

从而消除 WHERE 子句中的“AND ... is not null”。

最后，我会有一个索引，它是可以针对查询优化的多个部分......

```
CREATE index MultipleParts on ORD_CLI  ( COD_BUSN_UN, DATA_DOC, DOC_ID ); 
```

多部分索引将有助于查询的 WHERE、GROUP BY 和 ORDER BY。

# jquery - 选择 OnChange

> ID：15137744
> 
> 赞同：-2
> 
> 时间：2013-02-28T14:17:52.737
> 
> 标签：jquery, select, onchange, badge

这是一个简单的问题。

如何使用 select onChange 将“徽章的价格从 10 美元更改为 20 美元”？

```
<span class="badge badge-primary">$10</span>

<select>
 <option>$10 Item</option>
 <option>$20 Item</option>
</select> 
```

请提供 HTML 和 jQuery。

PS 我不想使用图像来作为徽章的价格。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T14:22:25.750

HTML：

```
<span id="mybadge" class="badge badge-primary">$10</span>

<select id="myselect">
 <option value="$10">$10 Item</option>
 <option value="$20">$20 Item</option>
</select> 
```

Javascript：

```
$('#myselect').change(function(){
    $('#mybadge').text($(this).val());
}); 
```

工作 jsFiddle ->> [http://jsfiddle.net/sUBWd/5/](http://jsfiddle.net/sUBWd/5/)

# c# - 改进算法更快 - 从文件中扫描图像

> ID：15137747
> 
> 赞同：4
> 
> 时间：2013-02-28T14:17:54.320
> 
> 标签：c#, algorithm, image-processing, bitmap

我的代码在这里有效，但需要几秒钟的时间，而对于更大的文件，它需要更长的时间，我想知道是否有人可以查看我拥有的内容并提出任何有助于加快速度的改进。

目的：

这是扫描pdf文件并搜索QR码的位图图像，它将返回它的代码（解码）

```
private void ScanQRPdf(string imagePath)
    {
        foreach (var item in Directory.GetFiles(imagePath))
        {
            if (Path.GetExtension(item).ToLower() == ".png")
            {
                Bitmap b = new Bitmap(imagePath);
                try
                {
                    QRCodeDecoder decoder = new QRCodeDecoder();
                    String decodedString = decoder.decode(new QRCodeBitmapImage(b));
                    rtbpdfData.Text += decodedString + "\n";
                }
                catch (Exception ex)
                {
                }
            }
        }
    }

 static void AddQRTag(PdfSharp.Drawing.XGraphics gfx, int xPosition, int yPosition, string QRdata, string HRdata)
    {
        gfx.DrawRectangle(XBrushes.White, xPosition, yPosition, xPosition + 55, yPosition + 85);

        PdfSharp.Drawing.XImage xImage =
            PdfSharp.Drawing.XImage.FromGdiPlusImage(BuildQR(QRdata.ToUpper(), 3,
                                            QRCodeEncoder.ENCODE_MODE.ALPHA_NUMERIC, 2, QRCodeEncoder.ERROR_CORRECTION.M));
        gfx.DrawImage(xImage, xPosition + 5, yPosition + 5, xImage.PixelWidth * .8, xImage.PixelWidth * .8);

        XFont font = new XFont("OCR B", 6);
        XTextFormatter tf = new XTextFormatter(gfx);
        tf.Alignment = XParagraphAlignment.Left;

        XRect layout = new XRect(xPosition + 5, yPosition + 55, 55, 30);
        tf.DrawString(HRdata.ToUpper(), font, XBrushes.Black, layout, XStringFormats.TopLeft);
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-28T14:28:52.693

在代码中，您过去的一切都可以。问题一定出在 QRCodeDecoder.decode 函数中。如果您通过 Bitmap.GetPixel 函数逐像素扫描图像，则会浪费大量时间。更好的方法是使用不安全的代码并将位图转换为 BitmapData。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-28T14:25:00.980

有几件事要尝试：

1.  按照 Carra 的建议，按扩展名过滤文件
2.  仅声明和实例化`QRCodeDecoder`一次
3.  使用附加文本`StringBuilder`并仅分配一次

它会是这样的：

```
private void ScanQRPdf(string imagePath)
{
    var files = Directory.GetFiles ( path, "*.png", SearchOption.AllDirectories );

    QRCodeDecoder decoder = new QRCodeDecoder();

    StringBuilder sb = new StringBuilder();

    foreach (var item in files)
    {

            Bitmap b = new Bitmap(imagePath);
            try
            {
                String decodedString = decoder.decode(new QRCodeBitmapImage(b));

                sb.AppendLine(decodedString);
            }
            catch (Exception ex)
            {
            }

    }

    rtbpdfData.Text = sb.ToString();
} 
```

但我真的不认为它会解决你的问题，这都是一些小的改进，你的延迟必须在`QRCodeDecoder`and`QRCodeBitmapImage`类中的某个地方，特别是在`decode`方法中，你应该尝试更好地理解它们，并找出它在内部做什么，这样你可以改进你的代码。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-28T16:21:22.017

根据您的评论，如果您只需要处理图像的左上角，您可以使用`Bitmap.Clone`.

在这种情况下，我会将您的代码重构为以下内容：

```
private void ScanQRPdf(string imagePath)
{
    foreach (var decodedString in DecodeAllImagesInFolder(imagePath))
    {
        rtbpdfData.Text += decodedString + "\n";
    }
}

private static IEnumerable<string> DecodeAllImagesInFolder(string imagePath)
{
    foreach (var item in Directory.GetFiles(imagePath, "*.png"))
    {
        using (Bitmap b = new Bitmap(imagePath))
        {
            yield return DecodeTopLeftCorner(b);
        }
    }
}

private static string DecodeTopLeftCorner(Bitmap bitmap)
{
    var rect = new Rectangle(0, 0, 100, 100);
    using (var topLeft = bitmap.Clone(rect, bitmap.PixelFormat))
    {
        return new QRCodeDecoder().decode(new QRCodeBitmapImage(topLeft));
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-28T14:21:38.437

您可以使用具有以下类型的 GetFiles：

```
string[ ] files = Directory.GetFiles ( path, "*.png", SearchOption.AllDirectories ); 
```

# node.js - Node.js：方法覆盖不起作用

> ID：15137750
> 
> 赞同：1
> 
> 时间：2013-02-28T14:18:10.110
> 
> 标签：node.js, methods, put

在服务器端：

```
var express = require('express');
var app = express();
app.listen(8000);

app.configure(function(){
  app.use(express.methodOverride());
});

app.put('/update', function (req, res) {
  res.send("update!");
}) 
```

我要测试`put`方法

在客户端：

```
<form action="/update">
    <input type="hidden" name="_method" value="put"/>
    <input type="submit" value="submit">
</form> 
```

但结果是

```
Cannot GET /update?_method=put 
```

那么，我的代码有什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T14:41:21.397

您还需要包含`bodyParser`中间件：

```
app.use(express.bodyParser());
app.use(express.methodOverride()); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T14:32:31.190

你有一个错字：`/upadte`应该是`/update`.

编辑：尝试`method="post"`在您的表单标签中使用。

# javascript - 自动完成 jquery ui 中的按键事件

> ID：15137752
> 
> 赞同：7
> 
> 时间：2013-02-28T14:18:14.507
> 
> 标签：javascript, jquery, jquery-ui-autocomplete

我只想在用户选择建议时在文本框上显示自动完成建议的值。我试过了

```
$("#trainerNameAutoComplete").autocomplete({
    source:"serverpage.php?id="+1,
    minLength:1,
    focus: function( event, ui ){
        $("#trainerNameAutoComplete").val('');
    },
    keypress: function(event,ui){
        if ((event.which == 38||event.Keycode ==38) || (event.which == 40||event.Keycode ==40)) {
            console.log("key down");
            $("#trainerNameAutoComplete").val('');
        }
    },
    select:function(event,ui){
        somefunction();
    }
}); 
```

但是当我将鼠标悬停在建议上时，文本框中的值会被清除，但当我按下向上和向下箭头键时不会。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T14:37:40.377

```
 keydown: function(event,ui){
        event.preventDefault();
        if (event.Keycode ==38||event.Keycode ==40) {
            console.log("key down");
            $("#trainerNameAutoComplete").val('');
        }
    }, 
```

试试这个..而不是你的按键事件

# zend-framework2 - Zend Framework 2 View Manager - 查看文件和请求的动作匹配

> ID：15137755
> 
> 赞同：0
> 
> 时间：2013-02-28T14:18:19.250
> 
> 标签：zend-framework2, zend-framework-mvc

我想制作自动匹配视图文件 - 控制器动作。

如果`/Web/TestController/testAction`（模块/控制器/动作）请求，

ZF2 尝试加载此视图：`/web/test/test`

然后，我必须添加这一行以`template_map`使其工作：

```
'web/test/test'     => __DIR__ . '/../view/pages/test/test.phtml', 
```

但我不想为所有操作添加这一行。

它可以像这样工作吗：

```
'web/{ABC}/{XYZ}'     => __DIR__ . '/../view/pages/{ABC}/{XYZ}.phtml', 
```

我如何让它自动匹配？

**模块.config.php：**

```
return array(
    'router' => array(
        'routes' => array(
            'web' => array(
                'type' => 'segment',
                'options' => array(
                    'route' => '[/:action]',
                    'constraints' => array(),
                    'defaults' => array(
                        'controller' => 'Web\Controller\Test',
                    ),
                )
            )
        )
    ),

    'view_manager' => array(

        'display_not_found_reason'  => true,
        'display_exceptions'        => true,
        'doctype'           => 'HTML5',
        'not_found_template'        => 'error/404',
        'exception_template'        => 'error/index',

        'template_map'              => array(

            'layout/test'       => __DIR__ . '/../view/layouts/test/test.phtml',
            'layout/default'    => __DIR__ . '/../view/layouts/default/default.phtml',
            'error/404'         => __DIR__ . '/../view/error/404.phtml',
            'error/index'       => __DIR__ . '/../view/error/index.phtml',

            'web/test/test'     => __DIR__ . '/../view/pages/test/test.phtml',
        ),

        'template_path_stack' => array(
            __DIR__ . '/../view',
        ),

        'layout'                    => 'layout/default'
    ),
); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T15:13:31.170

您应该将“ **pages** ”目录重命名为“ **web** ”并将配置文件更改如下

```
'web/test/test'     => __DIR__ . '/../view/web/test/test.phtml', 
```

# google-app-engine - 关于两个实体中的关系

> ID：15137756
> 
> 赞同：0
> 
> 时间：2013-02-28T14:18:20.603
> 
> 标签：google-app-engine, google-cloud-datastore, bigtable

我正在考虑创建一个属性，该属性将另一个实体的密钥或 ID 存储为对该实体的引用。
我想知道两件事。
1.属性应该存储哪些数据，key还是ID？
2.房产的类型应该是什么？也许是字符串属性？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T14:26:09.607

Datastore 对此有一个特殊的属性类型：[`ReferenceProperty`](https://developers.google.com/appengine/docs/python/datastore/typesandpropertyclasses#ReferenceProperty). 有两种使用方法。

一：

```
someothermodel = db.ReferenceProperty() 
```

二：

```
someotherspecificmodel = db.ReferenceProperty(SomeModel) 
```

在示例 2 中，只能分配类型为 SomeModel 的模型，在示例 1 中，可以分配任何模型。

的值类型`ReferenceProperty`是`db.Key`。

# sql - SQL Server 日期时间和 SQL

> ID：15137761
> 
> 赞同：2
> 
> 时间：2013-02-28T14:18:27.247
> 
> 标签：sql, sql-server

我在使用以下简单查询时遇到问题

```
SELECT * FROM users WHERE Created = '28/02/2013' 
```

问题是列`CREATED`是一种`datetime`数据类型，因此只要时间戳为 0:00:0，查询就可以正常执行，如果时间戳设置为 12:00，则查询不会返回结果集。

知道为什么吗？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-28T14:21:14.730

因为您没有指定时间，所以它假设您正在做：

```
SELECT * FROM users WHERE Created = '28/02/2013 00:00:00' 
```

如果你想要一整天，那么你需要一个时间范围：

```
SELECT * 
FROM users 
WHERE Created >= '20130228' AND Created < '20130301' 
```

此外，请使用明确的日期格式 ( `'YYYYMMDD'`) 而不是其他格式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T14:20:09.753

```
SELECT * FROM users WHERE CAST(Created AS DATE) = '28/02/2013' 
```

会修复它，但要小心，它会禁用索引

```
SELECT * FROM users WHERE Created BETWEEN '28/02/2013 00:00' AND '28/02/2013 23:59' 
```

这将使用索引

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-28T14:21:57.713

***如果您不需要考虑时间：***尝试将`created`字段转换为`date`然后比较为；

```
SELECT * FROM users WHERE convert(date,Created) = '28/02/2013'

--this would be even better with iso date format (not culture specific)
SELECT * FROM users WHERE convert(date,Created) = '20130228' --yyyymmdd format 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-02-28T14:20:28.220

您必须将列转换为日期，然后进行比较

```
SELECT * FROM users WHERE CONVERT(VARCHAR(11), Created, 106) = '28 Feb 2013' 
```

# java - 调整 JSON 或 GS ON？

> ID：15137762
> 
> 赞同：2
> 
> 时间：2013-02-28T14:18:28.527
> 
> 标签：java, json, gson

我有一个 Java 应用程序从第 3 方 RESTful Web 服务获取以下 JSON：

```
{
    "widgets":[
        [
            {
                "id":25128,
                "status":"always",
                "uuid":"96f62edd-fa8a-4267-8ffb-14af0d37de26"
            }
        ],
        [
            {
                "id":25200,
                "status":"always",
                "uuid":"78553c9e-398f-495a-8fb8-ada0fb297844"
            }
        ],
        [
            {
                "id":25128,
                "status":"never",
                "uuid":"b1e3deb2-a842-4cba-8272-458d15efb394"
            }
        ]
    ]
} 
```

并尝试将其转换为`List<Widget>`使用 GSON：

```
public class Widget {
    @SerializedName("id")
    private Long id;

    @SerializedName("status")
    private String status;

    @SerializedName("uuid")
    private String uuid;

    // Getters & setters, etc.
} 
```

这是我的映射器代码：

```
String jsonResponse = getJsonFromWebService();
Gson gson = new Gson();
List<Widget> widgets = gson.fromJson(jsonResponse, new TypeToken<List<Widget>>(){}.getType()); 
```

当我运行它时，我收到以下错误：

```
java.lang.IllegalStateException: Expected BEGIN_ARRAY but was BEGIN_OBJECT at line 1 column 2
java.lang.IllegalStateException: Expected BEGIN_ARRAY but was BEGIN_OBJECT at line 1 column 2
com.google.gson.JsonSyntaxException: java.lang.IllegalStateException: Expected BEGIN_ARRAY but was BEGIN_OBJECT at line 1 column 2 
```

显然，我需要在将 JSON 字符串发送到我的 GSON 映射器代码之前对其进行操作，或者我需要配置 GSON 来处理“意外”的 JSON，但我不确定哪个更容易/更合适。如果我需要“按摩” JSON 字符串，不确定我需要做什么才能让 GSON 很好地使用它。如果我需要配置 GSON，也不知道该做什么。有任何想法吗？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T14:26:23.623

问题是您使用单个 JSON 属性“小部件”忽略了根 JSON 对象。尝试将您的数据反序列化到此对象中：

```
public class WidgetList {
    @SerializedName("widgets")
    private List<List<Widget>> widgets;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T15:01:21.840

将其按摩为以下格式对我有用

```
[
    {
       'id':25128,
       'status':'always',
       'uuid':'96f62edd-fa8a-4267-8ffb-14af0d37de26'                                                           },       
    {
        'id':25200,
        'status':'always',
        'uuid':'78553c9e-398f-495a-8fb8-ada0fb297844'                                           },
    {   'id':25128,
        'status':'never',
        'uuid':'b1e3deb2-a842-4cba-8272-458d15efb394'   
}
] 
```

如下所示

```
public class TryMe {

    public static void main(String[] args) {

    Gson gson = new Gson();
        List<Widget> widgets = gson.fromJson(json,
                new TypeToken<List<Widget>>() {
                }.getType());

        System.out.println(widgets);
    }
}

class Widget {
    @SerializedName("id")
    private Long id;

    @SerializedName("status")
    private String status;

    @SerializedName("uuid")
    private String uuid;

    public Long getId() {
        return id;
    }

    public void setId(Long id) {
        this.id = id;
    }

    public String getStatus() {
        return status;
    }

    public void setStatus(String status) {
        this.status = status;
    }

    public String getUuid() {
        return uuid;
    }

    public void setUuid(String uuid) {
        this.uuid = uuid;
    }

    @Override
    public String toString() {
        return "Widget [id=" + id + ", status=" + status + ", uuid=" + uuid
                + "]";
    }   
} 
```

给出以下答复

```
[Widget [id=25128, status=always, uuid=96f62edd-fa8a-4267-8ffb-14af0d37de26], Widget [id=25200, status=always, uuid=78553c9e-398f-495a-8fb8-ada0fb297844], Widget [id=25128, status=never, uuid=b1e3deb2-a842-4cba-8272-458d15efb394]] 
```

# php - Codeigniter：从自定义库中获取自定义配置文件？

> ID：15137767
> 
> 赞同：1
> 
> 时间：2013-02-28T14:18:42.333
> 
> 标签：php, codeigniter, frameworks

我正在扩展 CodeIgniters 核心库（日志），具有更好的阈值级别和发送严重错误的方法。但由于某种原因，我无法从我的库中读取我的配置文件。如果我无法访问我的配置....我无法获取邮件地址。我究竟做错了什么？我收到的消息是：“致命错误：在...中找不到类 'CI_Controller'”

到目前为止，这是我的代码：

```
class MY_Log extends CI_Log {
/**
 * Constructor
 *
 * @access  public
 */
function MY_Log()
{
    parent::__construct();
    $this->_levels  = array('ERROR' => '1', 'INFO' => '2',  'DEBUG' => '3', 'ALL' => '4');
}

/**
 * Write Log File
 *
 * Calls the native write_log() method and then sends an email if a log message was generated.
 *
 * @access  public
 * @param   string  the error level
 * @param   string  the error message
 * @param   bool    whether the error is a native PHP error
 * @return  bool
 */
function write_log($level = 'error', $msg, $php_error = FALSE)
{
    $result = parent::write_log($level, $msg, $php_error);

    $this->ci =& get_instance();
    $this->ci->load->config('myconf/mailconf');
    echo $this->ci->config->item('emails');
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T22:31:31.353

我认为这是因为此类（`Log`/ `MY_Log`）在应用程序生命周期中加载得太早并且`get_instance()`不可用。

也许您可以编写自己的类来处理此类日志记录，而不是扩展日志记录功能的构建（如果这样做，您可以将其包装起来并将其作为[火花](http://getsparks.org/)释放:)）

或者，您可以使用[composer 包](https://packagist.org/search/?q=log)为您提供您所追求的功能，因为我确信已经存在一个。

如果您不熟悉作曲家，我建议您阅读[Phil Sturgeon 的文章](http://philsturgeon.co.uk/blog/2012/05/composer-with-codeigniter)。

# python - 如何使用python从不同的文本文件中删除相同的单词？

> ID：15137769
> 
> 赞同：0
> 
> 时间：2013-02-28T14:18:43.187
> 
> 标签：python, file-io, python-2.7

我正在从两个文本文件中获取数据，并比较它们，如果 file1 中的数据也在 file2 中，那么它应该从 file1 中删除数据

```
import sys
File1 = open("file1.txt")
File2 = open("file2.txt")
for lines in File1:
    for line in File2:
        for lines in line:
            print lines
File1
you
you to
you too
why
toh

File2
you
you to 
```

我的程序显示了 file2 中的单词，我如何从 file1 中删除 file2 中的条目？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T05:43:11.110

您可以使用该`fileinput`模块`inplace=True`并将第二个文件加载到一个`set`用于查找目的...

```
import fileinput

with open('file2.txt') as fin:
    exclude = set(line.rstrip() for line in fin)

for line in fileinput.input('file1.txt', inplace=True):
    if line.rstrip() not in exclude:
        print line, 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T15:10:44.547

你可以这样做：

```
file2 = open('file2.txt').readlines()
with open('result.txt', 'w') as result:
    for line in open('file1.txt'):
        if line not in file2:
            result.write(line) 
```

它不会修改“file1.txt”，而是创建另一个文件“result.txt”，其中包含不在file2 中的file1 行。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-28T16:31:55.230

```
import string

file1 = set(map(string.rstrip, open("f1").readlines()))
file2 = set(map(string.rstrip, open("f2").readlines()))

print ( file1 - file2 ) | file2 
```

给

```
set(['other great lines of text', 'from a file', 'against.', 'keep text', 'which is wanted to compare', 'This is', 'some text', 'keep is wanted to compare']) 
```

f1

```
This is 
keep text
from a file 
keep is wanted to compare
against. 
```

f2

```
This is 
some text
from a file 
which is wanted to compare
against.
other great lines of text 
```

* * *

## **保持秩序存在问题，这可能是问题，也可能不是问题。**

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-01T05:33:24.233

如果 file2 适合内存；您可以`set()`用来避免`O(n)`查找每一行：

```
with open('file2.txt') as file2:
    entries = set(file2.read().splitlines())

with open('file1.txt') as file1, open('output.txt', 'w') as outfile:
    outfile.writelines(line for line in file1
                       if line.rstrip("\n") not in entries) 
```

# sql - 用于断言 Groovy 脚本的参数化变量

> ID：15137775
> 
> 赞同：2
> 
> 时间：2013-02-28T14:19:04.240
> 
> 标签：sql, groovy, soapui, assertions

本质上，我使用 SoapUI 进行一些冒烟测试，并创建了一个断言脚本来检查 SQL 数据库中是否有数据。

该测试必须在三个不同的环境中运行，每个环境都有各自的数据库凭据。

我想做的是在测试类中创建一个自定义属性（或一组自定义属性），其中包含三组数据库信息，以允许测试人员简单地选择他们正在测试的环境，而不必更改硬-编码的断言脚本。

编码：

```
import groovy.sql.Sql    
import oracle.jdbc.driver.OracleDriver

def con = Sql.newinstance('"server", "user",
                              "pass", "oracle.jdbc.driver.OracleDriver"')

def res = con.rows("select * from table1 where message_in = 'Bang'")

log.info(res[0])

con.close()

assert res[0] != null 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T09:49:38.210

您应该首先创建全局变量，为此请按照以下步骤操作：

*   单击位于屏幕左侧的项目链接作为树形视图菜单。
*   单击左侧的“自定义属性”选项卡
*   单击 + 图标以添加新属性。

为数据库连接创建变量后，您可以在 groovy 脚本中访问它们，如下所示。

```
import groovy.sql.Sql    
import oracle.jdbc.driver.OracleDriver

def dbServer = context.expand( '${#Project#dbServer}' )
def dbUser = context.expand( '${#Project#dbUser}' )
def dbPass = context.expand( '${#Project#dbPass}' )

def con = Sql.newinstance('dbServer, dbUser,
                              dbPass, "oracle.jdbc.driver.OracleDriver"')

def res = con.rows("select * from table1 where message_in = 'Bang'")

log.info(res[0])

con.close()

assert res[0] != null 
```

# android - 如何在android中获取联系人的号码类型？

> ID：15137776
> 
> 赞同：1
> 
> 时间：2013-02-28T14:19:04.423
> 
> 标签：android, contacts

我正在开发一个使用联系人的应用程序！做一些工作！最重要的事情之一是数字类型！

所以如果一个联系人有多个号码！我需要得到数量和类型！我不想做出这样的 switch 语句

```
 int type = phones.getInt(phones.getColumnIndex(Phone.TYPE));
                switch (type) {
                    case Phone.TYPE_HOME:
                        // do something with the Home number here...
                        break;
                    case Phone.TYPE_MOBILE:
                        // do something with the Mobile number here...
                        break;
                    case Phone.TYPE_WORK:
                        // do something with the Work number here...
                        break;
                 } 
```

我需要动态获取 TEXT 类型，因为我的应用程序很可能适用于自定义类型！不仅是移动和工作......等。

有什么帮助吗？

编辑 ：

我正在尝试获取联系人作为此查询：

> 光标电话 = cr.query(Phone.CONTENT_URI, null, Phone.CONTACT_ID + " = " + id, null, null);

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T14:57:03.977

在 OP 澄清他正在寻找电话类型的标签后，扩展了@Rawkode 的答案。

我在网上找到了这个 - 似乎 Android 有一个内置的方法来获取标签*（披露：我还没有测试过这个）*

```
import android.provider.ContactsContract.CommonDataKinds.Phone;
String home_label = (String) Phone.getTypeLabel(context.getResources(), Phone.TYPE_HOME, ""); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T14:20:59.943

[文档](http://developer.android.com/reference/android/provider/ContactsContract.PhoneLookupColumns.html#LABEL)

```
String typeLabel = phones.getString(phones.getColumnIndex(Phone.LABEL)); 
```

# scala - 如何在 Play 2.1 中过滤访问代码请求

> ID：15137778
> 
> 赞同：3
> 
> 时间：2013-02-28T14:19:10.103
> 
> 标签：scala, playframework, action-filter, playframework-2.1

我想为请求添加一个（每个方法/全局）过滤器，它只是拒绝（404/403 页面）任何没有特定 URL 参数的请求。

我知道 Play 有执行此操作的一对二机制（例如 register on `Global.onRouteRequest()`），因此不要只向我发送文档链接，除非它包含涵盖此问题的代码示例。我尝试使用 API，但有点卡住了。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-28T18:35:16.843

你是这个意思吗？

```
object Global extends WithFilters(AccessCheck)

object AccessCheck extends Filter with Results {

  override def apply(next:RequestHeader => Result)(request:RequestHeader):Result =
    request
      .getQueryString("myCheck")
      .map( myCheck => next(request)) 
      .getOrElse(Forbidden)
} 
```

[http://www.playframework.com/documentation/2.1.0/ScalaInterceptors](http://www.playframework.com/documentation/2.1.0/ScalaInterceptors)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-22T01:00:25.803

如果您只是想编写一些可重用的代码来过滤对特定操作的请求，我想尝试创建一个像这样的 EssentialAction。这称为动作组合。这就是您描述的情况下的样子。文档中有更多信息：[http ://www.playframework.com/documentation/2.1.1/ScalaActionsComposition](http://www.playframework.com/documentation/2.1.1/ScalaActionsComposition)

请注意，您也可以在 Play 2.0.X 中执行此操作，但 EssentialAction 不存在，而是您使用 Action，并且涉及更多语法。

```
def RequireMyCheck(action: => EssentialAction): EssentialAction = {
  EssentialAction { request =>
    request
      .getQueryString("myCheck")
      .map( myCheck => action()(request)) 
      .getOrElse(Forbidden)
  }
} 
```

你可以像这样使用它：

```
def index = RequireMyCheck {
  Action { request =>
    Ok("Hello")
  }
} 
```

# html - 对于电子邮件通讯，我应该使用双 br 标签来减少一些内联代码吗？

> ID：15137780
> 
> 赞同：15
> 
> 时间：2013-02-28T14:19:11.673
> 
> 标签：html, email, html-email

由于我正在使用`<span>`或`<p>`标记内联样式，我应该只是去真正的老学校并使用`<br><br>`来打破段落而不是`<p>`每次都关闭和重新打开标签吗？

例如，这是我目前拥有的一段代码，它非常多余。我知道这是必须内联编码的本质，但似乎我可以通过这样做来减少一些噪音`<br><br>`

```
<p style="font-size: small; font-family:Tahoma, Geneva, sans-serif">Selection of the 200 New &amp; Recently updated companies over the last month. Click on the company name for up-to-date business information.</p>
<p style="font-size: small; font-family:Tahoma, Geneva, sans-serif">Company Name, FL provider of Category was updated on 2/12/2013</p>
<p style="font-size: small; font-family:Tahoma, Geneva, sans-serif">Company Name, TX provider of Category was updated on 2/13/2013</p>
<p style="font-size: small; font-family:Tahoma, Geneva, sans-serif">Company Name, AK provider of Category was updated on 2/15/2013</p> 
```

在适用时切换其中的一些是否有不利之处`<br><br>`？电子邮件客户端支持或类似的东西？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-28T14:25:33.017

随意使用换行标记，您已经非常正确地确定了以这种方式减少标记的潜力，并且这样做没有任何缺点。每个电子邮件客户端和 Web 客户端都支持它们，并且它们比在段落标签上使用边距更可靠，因为并非所有系统都全面支持边距。

参考： http: [//www.campaignmonitor.com/css/](http://www.campaignmonitor.com/css/)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-03-01T16:40:41.857

我在所有文本之间使用双`<br>`标签。这是电子邮件最一致的选项。

您需要将它与`&nbsp;`文本顶部和底部的虽然配对，因为它可以在某些客户端（我认为是 Outlook）中压缩空行。这是一个例子：

```
<td>
&nbsp;<br>
The no break space is needed above and below the text where it meets the table cell.
<br><br>
double br's between paragraphs are the best way to do it.
<br><br>
You need 1 no break space per line at the bottom (and top) so that Outlook doesn't remove the text row.
<br>&nbsp;<br>&nbsp;
</td> 
```

这是最快的方法，但将您限制为行高的倍数。另一种选择是使用填充：

```
<td style="padding-top:15px; padding-bottom:30px;">
The no break space is needed above and below the text where it meets the table cell.
<br><br>
double br's between paragraphs are the best way to do it.
<br><br>
You need 1 no break space per line at the bottom (and top) so that Outlook doesn't remove the text row.
</td> 
```

假设 line-height 设置为 15px，这两种方法将产生相同的结果，并且在所有主要电子邮件客户端中都得到广泛支持。

# java - 在运行时确定泛型类的类型

> ID：15137784
> 
> 赞同：0
> 
> 时间：2013-02-28T14:19:25.143
> 
> 标签：java, generics, if-statement

我知道该网站充满了类似的问题，并且通过快速阅读给定的问题，我想到的第一个答案是“不，你不能”，但我仍然觉得我是什么无论如何，询问并非不可能。

我在一个类中创建了一个泛型方法，我想检查传递给该方法的 Object 的类型。我知道它不能直接完成，因此我将一个对象`Class<T>`obj 传递给该方法。但是我找不到在方法体中正确执行类型检查的方法。

```
public <T> void readData(T obj1, Class<T> obj2){
} 
```

假设它`T`始终是以下三种类型之一`ClassA`：`ClassB`或`ClassC`。if-else-if 块应该是什么样子？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-17T10:46:12.567

Use [`obj2.cast(obj1)`](http://docs.oracle.com/javase/7/docs/api/java/lang/Class.html#cast%28java.lang.Object%29)，它强制转换`obj1`为由 表示的类或接口`obj2`，`obj1`如果`obj1`可分配给该类型`T`（请注意，`null`可分配给任何类型），则返回，否则抛出`ClassCastException`。

*我们对转换的结果*不感兴趣，因为静态已知的类型`obj1`已经是`T`and `obj2.cast(obj1)==obj1`（如果转换成功）。但是，如果强制转换失败，则会抛出早期异常。

例子：

```
public <T> void readData(T obj1, Class<T> obj2){
 obj2.cast(obj1); 
 //... 
} 
```

以下调用（从`Class<?>`to有未经检查的强制转换`Class<String>`）将失败：

```
readData("Hello",(Class<String>)(Class<?>)Integer.class); 
```

该方法`cast`对于替换未经检查的强制转换也很有用，例如：

```
public <T> void readData(Object obj1, Class<T> obj2){
 T t = (T)obj1;//BAD: unchecked cast
 //...
}

public <T> void readData(Object obj1, Class<T> obj2){
 T t = obj2.cast(obj1());//GOOD: ClassCastException if the cast fails
 //...
} 
```

# ruby-on-rails - 类似按钮模拟（Ruby on Rails 中的可嵌入小部件）

> ID：15137786
> 
> 赞同：1
> 
> 时间：2013-02-28T14:19:32.863
> 
> 标签：ruby-on-rails, widget

我正在创建可嵌入的小部件，类似于 facebook 的点赞按钮。

我有两个**模型**：widget 和 widget_like。

**我的数据库**

在小部件表中，有网站安装了我的“喜欢按钮”。

在 widget_like 表中有网站的喜欢。

***小部件控制器***

```
 def show
    @widget = Widget.find(params[:id])
    @like = WidgetLike.new
  end 
```

***小部件喜欢控制器***

```
 def create
    @widget = Widget.find(params[:widget_id])
    @like = @widget.widget_likes.build(params[:widget_like])
    if @like.save
      respond_to do |format|
        format.html 
        format.js
      end
    end
  end 
```

***小部件/show.js.erb***

```
document.write("<%= escape_javascript(render(:partial => "embed").html_safe) %>"); 
```

***小部件/embed.html.erb***

```
<%= form_for ([@widget, @like]), :remote => true do |f| %>
    <%= f.submit "widget" %>
<% end %> 
```

**问题**是我需要我的完整网址来执行我的表单。如何添加它，它安全吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T16:18:04.677

使用以下`url`选项`form_for`：

```
form_for [@widget, @like], remote: true, url: { host: "http://somewebsite.com" } 
```

[它的工作原理与url_for](http://apidock.com/rails/ActionController/Base/url_for)完全相同，并且应该将您提供的选项与`form_for`.

**更新**

现在我想到了，还有更简单的：

```
form_for [@widget, @like], remote: true, url: { only_path: false } 
```

这将为您提供当前主机的完整网址。此解决方案将更易于维护。

# gcc - 使用 GCC 获取 C 程序的抽象语法树

> ID：15137793
> 
> 赞同：4
> 
> 时间：2013-02-28T11:00:07.940
> 
> 标签：gcc, c

如何使用 GCC 获取 C 程序的抽象语法树？

我正在尝试将 OpenMP 编译指示自动插入到输入 C 程序中。我需要分析嵌套的 for 循环以查找依赖项，以便我可以插入适当的 OpenMP 编译指示。

所以基本上我要遍历分析输入C程序的抽象语法树。

我如何实现这一目标？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T14:30:22.260

使用带有`-ast-print`选项的clang，这是最干净的方法。

# oracle - 使用 EclipseLink 将 @lob 列设置为 null

> ID：15137805
> 
> 赞同：0
> 
> 时间：2013-02-28T14:20:12.907
> 
> 标签：oracle, jpa, eclipselink, blob

我正在使用 EclipseLink 来管理在 Oracle DB 中存储有 BLOB 列的实体。我需要将列值设置为 NULL。简单地将实体实例变量设置为 NULL 是行不通的。

```
@Lob
@Basic(fetch = FetchType.LAZY)
@Column(name = "SERIALIZEDEJBTIMERHANDLE")
private byte[] serializedEjbTimerHandle; 
```

什么是正确的方法？

# c# - 如何使用 C# 从安全令牌中获取信息

> ID：15137816
> 
> 赞同：11
> 
> 时间：2013-02-28T14:20:35.417
> 
> 标签：c#, sign, pki

我需要让我的应用程序的用户使用他们的个人 USB 安全令牌签署他们的批准。

我已经成功地签署了数据，但我无法获得有关谁的令牌已用于这样做的信息。

这是我到目前为止的代码：

```
CspParameters csp = new CspParameters(1, "SafeNet RSA CSP");
csp.Flags = CspProviderFlags.UseDefaultKeyContainer;            
RSACryptoServiceProvider rsa = new RSACryptoServiceProvider(csp);
// Create some data to sign. 
byte[] data = new byte[] { 0, 1, 2, 3, 4, 5, 6, 7 };
Console.WriteLine("Data         : " + BitConverter.ToString(data));
// Sign the data using the Smart Card CryptoGraphic Provider.            
byte[] sig = rsa.SignData(data, "SHA1");            
Console.WriteLine("Signature    : " + BitConverter.ToString(sig)); 
```

令牌信息中有一个字段称为“令牌名称”。如何访问该字段以验证已使用哪个令牌签署批准？

[![在此处输入图像描述](../Images/0a5f3a75d49991c6f7f7ca6df332b1eb.png)](https://i.stack.imgur.com/Plkmc.png)

附加信息和更新：

*   “令牌名称”始终匹配所有者的名称（拥有 USB 令牌的用户）
*   似乎无法完成，也许有一个网络服务或我需要调用的东西才能直接从证书颁发机构获取信息。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-05T20:27:19.287

当我最初提出这个问题时，我对数字证书的理解非常基础，所以这个问题没有被正确地提出。现在我知道我需要从智能卡设备访问证书，查询其属性并测试用户是否可以为其输入正确的 PIN。

这是我以前这样做的代码：

```
//Prompt the user with the list of certificates on the local store.
//The user have to select the certificate he wants to use for signing.
//Note: All certificates form the USB device are automatically copied to the local store as soon the device is plugged in.
X509Store store = new X509Store(StoreLocation.CurrentUser);
store.Open(OpenFlags.ReadOnly);
X509CertificateCollection certificates = X509Certificate2UI.SelectFromCollection(store.Certificates,
                                                                                "Certificados conocidos",
                                                                                "Por favor seleccione el certificado con el cual desea firmar",
                                                                                X509SelectionFlag.SingleSelection
                                                                                );
store.Close();
X509Certificate2 certificate = null;
if (certificates.Count != 0)
{
    //The selected certificate
    certificate = (X509Certificate2)certificates[0];
}
else
{
    //The user didn't select a certificate
    return "El usuario canceló la selección de un certificado";
}
//Check certificate's atributes to identify the type of certificate (censored)
if (certificate.Issuer != "CN=............................., OU=................., O=..., C=US")
{
    //The selected certificate is not of the needed type
    return "El certificado seleccionado no corresponde a un token ...";
}
//Check if the certificate is issued to the current user
if (!certificate.Subject.ToUpper().Contains(("E=" + pUserADLogin + "@censoreddomain.com").ToUpper()))
{
    return "El certificado seleccionado no corresponde al usuario actual";
}
//Check if the token is currently plugged in
XmlDocument xmlDoc = new XmlDocument();
XmlElement element = xmlDoc.CreateElement("Content", SignedXml.XmlDsigNamespaceUrl.ToString());
element.InnerText = "comodin";
xmlDoc.AppendChild(element);
SignedXml signedXml = new SignedXml();
try
{
    signedXml.SigningKey = certificate.PrivateKey;
}
catch
{
    //USB Token is not plugged in
    return "El token no se encuentra conectado al equipo";
}
DataObject dataObject = new DataObject();
dataObject.Data = xmlDoc.ChildNodes;
dataObject.Id = "CONTENT";
signedXml.AddObject(dataObject);
Reference reference = new Reference();
reference.Uri = "#CONTENT";
signedXml.AddReference(reference);
//Attempt to sign the data. The user will be prompted to enter his PIN
try
{
    signedXml.ComputeSignature();
}
catch
{
    //User didn't enter the correct PIN
    return "Hubo un error confirmando la identidad del usuario";
}
//The user has signed with the correct token
return String.Format("El usuario {0} ha firmado exitosamente usando el token con serial {1}", pUserADLogin, certificate.SerialNumber); 
```

资料来源：

[http://stormimon.developpez.com/dotnet/signature-electronique/](http://stormimon.developpez.com/dotnet/signature-electronique/)（法语） [https://www.simple-talk.com/content/print.aspx?article=1713](https://www.simple-talk.com/content/print.aspx?article=1713)（英文）

# linux - 如何在 Linux 中读取 INI 文件

> ID：15137817
> 
> 赞同：2
> 
> 时间：2013-02-28T14:20:36.703
> 
> 标签：linux, ini

你将如何使用 Linux 命令读取 INI 文件？我知道在 Windows 中您可以使用 API 调用，例如 GetPrivateProfileString..

例子; 如何获取system2下的版本：

```
[system1]

version=XYZ

date=123

[system2]

version=ABC

date=985 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-28T01:02:14.373

看看 crudini，它是一个从 shell 操作 ini 文件的专用工具

```
version=$(crudini --get example.ini system2 version) 
```

有关使用和下载的详细信息，请访问： [http ://www.pixelbeat.org/programs/crudini/](http://www.pixelbeat.org/programs/crudini/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T14:39:46.543

您可能对 python 模块[ConfigParser 感兴趣](http://docs.python.org/2/library/configparser.html)：

```
In [1]: import ConfigParser

In [2]: config = ConfigParser.ConfigParser()

In [3]: config.read('file.ini')
Out[3]: ['file.ini']

In [4]: config.get('system2','version')
Out[4]: 'ABC' 
```

作为脚本`pass_config.py`：

```
import ConfigParser

config = ConfigParser.ConfigParser()
config.read('file.ini')
print config.get('system2','version') 
```

跑：

```
$ python pass_config.py
ABC 
```

# html - 严格和过渡文档类型之间的真正区别是什么

> ID：15137819
> 
> 赞同：3
> 
> 时间：2013-02-28T14:20:37.523
> 
> 标签：html, xhtml, doctype, strict, transitional

我已经阅读了许多论坛，它们解释了严格和过渡文档类型之间的区别，但没有一个解释在呈现页面时选择严格或过渡是否重要。例如：在严格的文档类型中不推荐使用“i”标签。但无论您使用任何一种文档类型，它都可以在您的网页中正常呈现。其他不推荐使用的标签也是如此，例如“u”或“font”。所以我的问题是，在页面渲染方面，严格文档类型和过渡文档类型之间是否存在真正的区别。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-12-20T17:55:04.797

> 几乎标准模式的不同之处大致如下：没有非空白文本作为子级并且没有边框、填充或边距的内联框：

*   不影响行框的大小（即忽略它们的行高）
*   不要让高度（例如，对于他们的背景）大于他们后代的高度，即使他们的字体大小更大（如果他们没有后代，他们在基线处的高度为零）

> HTML 4.01 过渡文档类型根据 HTML 4.01 规范进行验证。它允许一些表示性标记和不推荐使用的元素（例如元素），但不允许框架集。
> 
> HTML 4.01 严格文档类型根据 HTML 4.01 规范进行验证，尽管它不允许使用任何表示性标记或不推荐使用的元素（例如元素）或框架集。
> 
> 如果您使用的是 XHTML 文档类型，则需要使用 XML 格式良好的语法

**参考**

*   [文档类型和标记样式 - Web Education Community Group](https://www.w3.org/community/webed/wiki/Doctypes_and_markup_styles)

*   [怪癖模式标准](https://quirks.spec.whatwg.org/)

*   [在怪癖模式下无法正常工作的所有内容的列表？](https://stackoverflow.com/questions/1848542/1113772)

# javascript - javascript将json对象推送到数组

> ID：15137823
> 
> 赞同：0
> 
> 时间：2013-02-28T14:20:59.687
> 
> 标签：javascript, jquery, json

我有以下内容：

```
var cookie = $.cookie("Test_cookie");
var items = cookie ? eval("([" + cookie + "])") : [];
var jsonObj = { packageId: "11", machineId: "1", operationType: "Download" };
items.push(jsonObj);
$.cookie(cookieName, JSON.stringify(items), { expires: 1, path: '/' }); 
```

结果：

```
[{"packageId":"11","machineId":"1","operationType":"Download"}] 
```

哪个是对的。

但是，当我第二次运行它时，我想将新对象附加到项目但 json 被搞砸了（注意额外的“[”）：

```
var jsonObj = { packageId: "11", machineId: "1", operationType: "Download" };
items.push(jsonObj);
$.cookie(cookieName, JSON.stringify(items), { expires: 1, path: '/' }); 
```

结果：

```
[[{"packageId":"11","machineId":"1","operationType":"Download"}],{"packageId":"11","machineId":"1","operationType":"Download"}] 
```

它应该是：

```
[{"packageId":"11","machineId":"1","operationType":"Download"},{"packageId":"11","machineId":"1","operationType":"Download"}] 
```

是什么赋予了？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-28T14:23:55.137

你的错误就在附近

```
var items = cookie ? eval("([" + cookie + "])") : []; 
```

做就是了

```
var items = cookie ? eval(cookie) : []; 
```

# asp.net - 在插件中，如何将 html 页面添加到 ckeditor 对话框

> ID：15137826
> 
> 赞同：0
> 
> 时间：2013-02-28T14:21:02.913
> 
> 标签：asp.net, plugins, dialog, ckeditor

我正在将旧的 fckeditor 升级到 ckeditorv3。我发现大多数 API 都已更新。有一个内部使用的插件，它的内容是一个aspx页面，这个页面会提供动态列表。我想升级该插件以使其在新的 ckeditorv3 中工作。

谁能给我一个关于如何将 html 页面添加到 ckedirot 对话框的教程链接？

我发现了一个[http://www.kusog.org/articles/OtherJavaScriptLibraries_WritingCustomCKEditorPlugins/](http://www.kusog.org/articles/OtherJavaScriptLibraries_WritingCustomCKEditorPlugins/)，但这只是一些基本信息。我想要做的是将 html 页面嵌入到插件的对话框中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T16:32:17.037

好的，我找到了解决方案。您需要在对话框 iframe 中加载页面。

```
CKEDITOR.plugins.add('customfields',
{
    init: function(editor) {
        editor.addCommand('customfields', new CKEDITOR.dialogCommand('customfields'));
        editor.ui.addButton('Customfields',
        {
            label: 'Custom Fields',
            command: 'customfields',
            icon: this.path + 'CustomFields.gif'
        });

        CKEDITOR.dialog.addIframe(
            'customfields',
            'Custom Fields',
            this.path + 'CustomFields2.aspx', null, null,
            function() { alert('aaaa'); }, function() { alert('bbbb'); }
        );
    }
}); 
```

# ios - 测试键盘在显示时是否隐藏文本字段

> ID：15137827
> 
> 赞同：0
> 
> 时间：2013-02-28T14:21:03.300
> 
> 标签：ios

我尝试在显示键盘时向上移动表单，我的方法是测试键盘的框架和文本字段的框架是否相交。

```
- (void)keyboardDidShow:(NSNotification *)notification
{

    // Get the size of the keyboard.
    CGRect keyboardFrame = [[[notification userInfo] objectForKey:UIKeyboardFrameBeginUserInfoKey] CGRectValue];

    //Test whether the current frame of the text field is hidden by the keyboard

    if (!CGRectIsNull(CGRectIntersection(keyboardFrame,self.activeField.frame))) {
        NSLog(@"Key board frame intersects with the text field frame");
    }

} 
```

在上面的代码中，`CGRectIsNull`总是返回 null。

调试语句返回有关键盘和在表单中选择的活动文本字段的这些信息：

键盘尺寸 = (width=352, height=1024) 键盘原点 = (x=-352, y=0)

关键板框架 = (-352,0,352,1024) 文本字段框架 = (200, 15, 300, 30)

每个文本字段都有相同的帧值，这意味着有问题。那么如何测试键盘是否隐藏了文本字段，以便我上下移动表单。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T14:55:19.067

我会把整个东西放在全屏 UIScrollView 中，然后在需要时调整它的大小......

```
// This in your init somewhere
[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(keyboardWillChange:) name:UIKeyboardWillChangeFrameNotification object:nil];

-(void) keyboardWillChange:(NSNotification*)notify {

    CGRect endFrame;
    float duration = [[[notify userInfo] valueForKey:UIKeyboardAnimationDurationUserInfoKey] floatValue];
    [[[notify userInfo] valueForKey:UIKeyboardFrameEndUserInfoKey] getValue:&endFrame];
    endFrame = [self.view convertRect:endFrame fromView:nil];
    float y = (endFrame.origin.y > self.view.bounds.size.height ? self.view.bounds.size.height : endFrame.origin.y);

    [UIView animateWithDuration:duration animations:^{
        scrollView.frame = CGRectMake(0, 0, self.view.bounds.size.width, y);
    }];

} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-28T14:58:15.397

尝试这个：

```
 [[NSNotificationCenter defaultCenter] addObserverForName:UIKeyboardWillShowNotification object:nil queue:[NSOperationQueue mainQueue] usingBlock:^(NSNotification *note) {}]; 
```

并使用来自的信息`[note userInfo];`

# iphone - 删除设备上的本地 iCloud 数据（例如在首次应用启动/重新安装时）

> ID：15137832
> 
> 赞同：1
> 
> 时间：2013-02-28T14:21:16.803
> 
> 标签：iphone, ios, ipad, icloud

如果用户安装一个使用 iCloud 的`UI(Managed)Document`应用程序，然后使用该应用程序，创建保存到 iCloud 的数据，然后在他的手机上删除该应用程序，则 iCloud 数据将保留在设备上（交易日志等）。如果用户重新安装应用程序，它将尝试使用这些旧文件。

我有以下两个问题：

*   iCloud 文档可能同时发生了变化，如果用户在重新安装应用程序后首次启动时没有网络连接，则可能会出现问题。
*   此应用程序的 iCloud 文档可能已被用户删除（通过设置或在用户库中的 Mac OS Finder 中）。现在，当用户在重新安装应用程序后第一次启动时没有网络时，应用程序可能会认为存在一个包含数据的无处不在的容器，即使它已经被删除（应用程序可能会崩溃）。

这不是很容易测试，但我已经为这两个问题明确地崩溃和故障。例如`NSMetadataQuery`，向我显示 iCloud 中不存在的文档的结果，因为它们已被删除（但它们在删除应用程序时存在）。

有什么简单的解决方案吗？我曾想过在首次启动应用程序时删除设备上的本地 iCloud 数据 - 但如何做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T17:47:47.370

这是不可能的。如果你在本地删除一个 iCloud 文档，你会在所有地方删除它——最终。iCloud API 没有独立于 iCloud 服务管理本地副本的概念，因此，如果您删除一个副本——即使网络中断——iCloud 普遍存在的守护程序也会第一时间向该服务发送删除命令。

当前 API 允许的最接近的近似值是：

*   检查网络是否可达
*   如果无法访问，请不要尝试访问任何 iCloud 文档（因为您注意到，信息可能已过时）。
*   如果网络启动，请尝试打开所有现有的 iCloud 文档。（在 iOS 上，iCloud 更新仅按需下载，因此您需要创建该需求）。

如果这还不够好（让我们面对现实，它还不够好），请向 Apple 提交错误并希望获得最好的结果。

# azure - 我在 azure microsoft 上的域名

> ID：15137833
> 
> 赞同：-1
> 
> 时间：2013-02-28T14:21:19.207
> 
> 标签：azure, dns, seo

我在 azure microsoft 上打开了一个“共享”网站。我的域名是“mydn.azurewebsites.net”，我购买了一个域名“mydomain.co.il”并从[https://www.windowsazure.com/en-us/develop/net/common-tasks执行了以下操作/custom-dns-web-site/](https://www.windowsazure.com/en-us/develop/net/common-tasks/custom-dns-web-site/)使我的域名正常工作。我的 dns 提供商告诉我将“url forwarding”添加到“mydn.azurewebsites.net”。我的Q是。它会导致搜索引擎优化问题吗？谷歌搜索

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T14:36:21.520

我和你一样，没有遇到任何问题。

我的 DNS 服务器设置有指向 mydomain.azurewebsites.net 的 CNAME 条目。

# c# - ListBox SelectionChanged WP7 使用参数导航

> ID：15137835
> 
> 赞同：2
> 
> 时间：2013-02-28T14:21:21.160
> 
> 标签：c#, json, windows-phone-7, xaml, listbox

因此，在我正在制作的 Windows Phone 7 应用程序中，我使用带有 SelectionChanged 事件处理程序的 ListBox 将用户导航到新网页，显示附加信息。MainPage.xaml 显示了一个使用 JSON 文件中的信息填充的 ListBox，它可以正常工作。但是，如果用户想要阅读更多关于新闻的信息，他/她将不得不单击 ListBox 中的新闻，这会触发 SelectionChanged 事件，如下所示：

```
 private void NewsList_SelectionChanged_1(object sender, SelectionChangedEventArgs e)
    {
        int index = NewsList.SelectedIndex;

        fetchNewsContent newsContentGetSet = new fetchNewsContent();

        newsContentGetSet.newsID = newslistJson.ElementAt(index).news_id;
        newsContentGetSet.newsTitle = newslistJson.ElementAt(index).news_title;
        newsContentGetSet.newsAbstract = newslistJson.ElementAt(index).news_abstract;
        newsContentGetSet.newsContent = newslistJson.ElementAt(index).news_content;
        newsContentGetSet.newsAuthor = newslistJson.ElementAt(index).news_author;
        newsContentGetSet.newsDatePublished = newslistJson.ElementAt(index).news_date_published_no;

        //object[] someobject = { newsContentGetSet.newsID, newsContentGetSet.newsTitle, newsContentGetSet.newsAbstract, newsContentGetSet.newsContent, newsContentGetSet.newsAuthor, newsContentGetSet.newsDatePublished };

        NavigationService.Navigate(new Uri("/NewsPage.xaml?obj=" + index, UriKind.Relative));

    } 
```

这只是为每个字符串（newsID、newsTitle 等）使用带有 getter 和 setter 的类（newsContentGetSet.cs），但是当触发 SelectionChanged 时，.cs 文件不会设置新给定的 newslistJson 值！为什么？

我还尝试在 NavigationService 中仅发送文本参数，但 newsContent 字符串太长（整个新闻故事），因此它返回了“shell 页面 uri 太长”错误。

现在，这只是将 index int 发送到 NewsPage 页面，该页面尝试捕获这些值，但由于 newsContentGetSet 实际上没有设置任何内容（当我尝试时不对其进行调试）而失败。Aaany想法，真的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T14:45:55.543

而不是在参数上传递数据。您应该将数据保存到 App 类的变量中，然后在导航到下一页时从那里检索它们。

应用程序.xaml.cs

```
public static fetchNewsContent newsContentGetSet; 
```

访问它

```
var fetchedNewsContent = App.fetchNewsContent; 
```

您可以从任何页面存储/检索数据。请注意，如果应用程序关闭，则数据将消失。

# android - Android GUI 布局

> ID：15137848
> 
> 赞同：0
> 
> 时间：2013-02-28T14:22:01.613
> 
> 标签：android, image, user-interface, button, android-edittext

我目前正在尝试研究如何在我的 Android 应用程序的 GUI 中对齐某些元素。请看下面的图片链接，第一个布局是当前的，第二个是我的目标。目前，我正在使用两个线性布局。我尝试对右侧按钮和 EditText 使用相对布局和表格布局，但 EditText 总是缩小，或者溢出平板电脑的屏幕尺寸。

谢谢你的帮助！

图片链接：（[http://postimage.org/image/pptkdkomx/](http://postimage.org/image/pptkdkomx/)）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T14:27:00.010

尝试这个：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:orientation="horizontal" >

<ImageView
    android:layout_width="0dp"
    android:layout_height="match_parent"
    android:layout_weight="0.5" />

<LinearLayout
    android:layout_width="0dp"
    android:layout_height="match_parent"
    android:layout_weight="0.5"
    android:orientation="vertical" >

    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="wrap_content" >

        <Button
            android:layout_width="0dp"
            android:layout_height="wrap_content"
            android:layout_weight="0.5" android:text="Button1"/>

        <Button
            android:layout_width="0dp"
            android:layout_height="wrap_content"
            android:layout_weight="0.5"  android:text="Button2"/>
    </LinearLayout>

    <EditText
        android:layout_width="match_parent"
        android:layout_height="match_parent" />
</LinearLayout>

</LinearLayout> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T14:33:44.860

你为什么不使用`RelativeLayout`和你`EditText`使用`android:layout_alignBottom="myImage"`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-28T14:48:24.243

刚刚汇集了一个快速模板，您可能需要修复 + 添加自己的属性，因为我只使用了记事本：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:orientation="horizontal"
    android:layout_width="match_parent"
    android:layout_height="match_parent">

    <ImageView
        android:layout_width="0dp"
        android:layout_height="match_parent"
        android:layout_weight="50"/>

    <LinearLayout 
        android:orientation="vertical"
        android:layout_width="0dp"
        android:layout_height="match_parent"
        android:layout_weight="50">

        <LinearLayout 
            android:orientation="horizontal"
            android:layout_width="match_parent"
            android:layout_height="wrap_content">

            <Button android:layout_width="0dp"
                android:layout_height="wrap_content"
                android:layout_weight="50"/>

            <Button android:layout_width="0dp"
                android:layout_height="wrap_content"
                android:layout_weight="50"/>

        </LinearLayout>

        <EditText
            android:layout_width="match_parent"
            android:layout_height="match_parent"/>

    </LinearLayout>

</LinearLayout> 
```

# java - Java：使用 nio Files.copy 移动目录

> ID：15137849
> 
> 赞同：11
> 
> 时间：2013-02-28T14:22:03.890
> 
> 标签：java, file, nio

我是 nio 类的新手，无法将文件目录移动到新创建的目录。

我首先创建2个目录：

```
File sourceDir = new File(sourceDirStr); //this directory already exists
File destDir = new File(destDirectoryStr); //this is a new directory 
```

然后我尝试将现有文件复制到新目录中，使用：

```
Path destPath = destDir.toPath();
for (int i = 0; i < sourceSize; i++) {
    Path sourcePath = sourceDir.listFiles()[i].toPath();
    Files.copy(sourcePath, destPath.resolve(sourcePath.getFileName()));
} 
```

这会引发以下错误：

```
Exception in thread "main" java.nio.file.FileSystemException: destDir/Experiment.log: Not a directory 
```

我知道那`destDir/Experiment.log`不是现有目录；由于操作，它应该是一个新文件`Files.copy`。有人能指出我的操作出了什么问题吗？谢谢！

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-11-20T00:41:13.143

您需要使用 walkFileTree 来复制目录。如果在目录上使用 Files.copy，则只会创建一个空目录。

以下代码取自/改编自[http://codingjunkie.net/java-7-copy-move/](http://codingjunkie.net/java-7-copy-move/)

```
File src = new File("c:\\temp\\srctest");
File dest = new File("c:\\temp\\desttest");
Path srcPath = src.toPath();
Path destPath = dest.toPath();

Files.walkFileTree(srcPath, new CopyDirVisitor(srcPath, destPath, StandardCopyOption.REPLACE_EXISTING));

public static class CopyDirVisitor extends SimpleFileVisitor<Path>
{
    private final Path fromPath;
    private final Path toPath;
    private final CopyOption copyOption;

    public CopyDirVisitor(Path fromPath, Path toPath, CopyOption copyOption)
    {
        this.fromPath = fromPath;
        this.toPath = toPath;
        this.copyOption = copyOption;
    }

    @Override
    public FileVisitResult preVisitDirectory(Path dir, BasicFileAttributes attrs) throws IOException
    {
        Path targetPath = toPath.resolve(fromPath.relativize(dir));
        if( !Files.exists(targetPath) )
        {
            Files.createDirectory(targetPath);
        }
        return FileVisitResult.CONTINUE;
    }

    @Override
    public FileVisitResult visitFile(Path file, BasicFileAttributes attrs) throws IOException
    {
        Files.copy(file, toPath.resolve(fromPath.relativize(file)), copyOption);
        return FileVisitResult.CONTINUE;
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-28T14:49:05.757

如果目标目录不存在，只需创建它。

```
File sourceDir = new File(source); //this directory already exists
File destDir = new File(dest); //this is a new directory
destDir.mkdirs(); // make sure that the dest directory exists

Path destPath = destDir.toPath();
for (File sourceFile : sourceDir.listFiles()) {
    Path sourcePath = sourceFile.toPath();
    Files.copy(sourcePath, destPath.resolve(sourcePath.getFileName()));
} 
```

请注意，这`sourceDir.listFiles()`还将返回目录，您要么希望递归到这些目录，要么忽略...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-01-09T02:04:18.300

这是我将目录从源递归移动到目标的解决方案。它就像一个魅力。

```
public static void move(Path source, Path target) throws IOException {

    class FileMover extends SimpleFileVisitor<Path> {
        private Path source;
        private Path target;

        private FileMover(Path source, Path target) {
            this.source = source;
            this.target = target;
        }

        @Override
        public FileVisitResult visitFile(final Path file, final BasicFileAttributes attrs) throws IOException {
            Files.move(file, target.resolve(source.relativize(file)),
                StandardCopyOption.REPLACE_EXISTING);
            return FileVisitResult.CONTINUE;
        }

        @Override
        public FileVisitResult preVisitDirectory(final Path dir, final BasicFileAttributes attrs) throws IOException {
            Path newDir = target.resolve(source.relativize(dir));
            try {
                Files.copy(dir, newDir,
                    StandardCopyOption.COPY_ATTRIBUTES,
                    StandardCopyOption.REPLACE_EXISTING);
            } catch (DirectoryNotEmptyException e) {
                // ignore and skip
            }
            return FileVisitResult.CONTINUE;
        }

        @Override
        public FileVisitResult postVisitDirectory(final Path dir, final IOException exc) throws IOException {
            Path newDir = target.resolve(source.relativize(dir));
            FileTime time = Files.getLastModifiedTime(dir);
            Files.setLastModifiedTime(newDir, time);
            Files.delete(dir);
            return FileVisitResult.CONTINUE;
        }
    }

    FileMover fm = new FileMover(source, target);
    EnumSet<FileVisitOption> opts = EnumSet.of(FileVisitOption.FOLLOW_LINKS);

    Files.walkFileTree(source, opts, Integer.MAX_VALUE, fm);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-01T05:12:47.620

```
for (int i = 0; i < sourceSize; i++) {
    Path sourcePath = sourceDir.listFiles()[i].toPath();
    Files.copy(sourcePath, destPath.resolve(sourcePath.getFileName()));
} 
```

这是非常奇怪的代码。您已经从某个地方获得了文件计数， in `sourceSize`，但您正在调用`listFiles()`每次迭代。我会期待更多这样的事情：

```
for (File file : sourceDir.listFiles()) {
    Path sourcePath = file.toPath();
    Files.copy(sourcePath, destPath.resolve(sourcePath.getFileName()));
} 
```

# ant - 指向新 Ant 的更改

> ID：15137851
> 
> 赞同：0
> 
> 时间：2013-02-28T14:22:09.907
> 
> 标签：ant, centos, environment

我在 /usr/local/ant 中有一个较新的 ANT .... “which ant”什么时候显示它仍然指向随 Centos 5.8 安装的默认 ANT“usr/bin/ant”。我该如何改变它？

尝试了以下更改，但没有运气：

```
export ANT_HOME=/usr/local/ant
export JAVA_HOME=/usr/lib/jvm/java
export PATH=$PATH:/usr/local/ant/bin
export CLASSPATH=.:$JAVA_HOME/lib/classes.zip
echo 'export ANT_HOME=/usr/local/ant' >> /etc/bashrc
echo 'export JAVA_HOME=/usr/lib/jvm/java' >> /etc/bashrc
echo 'export PATH=$PATH:/usr/local/ant/bin' >> /etc/bashrc
echo 'export CLASSPATH=.:$JAVA_HOME/lib/classes.zip' >> /etc/bashrc 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T14:23:27.097

将您的有效路径作为第一个路径放在 PATH 环境变量中：

```
export PATH=/usr/local/ant/bin:$PATH 
```

有关更多详细信息，请参阅[本文](http://docstore.mik.ua/orelly/unix/upt/ch06_04.htm)。

# python - 如何在 pylab 中使直方图“触摸”？

> ID：15137854
> 
> 赞同：0
> 
> 时间：2013-02-28T14:22:18.793
> 
> 标签：python, plot, histogram

所以我做了一个程序来做我需要的，主要是从我的数据中绘制直方图，但我有一些问题：

这是程序：

```
# -*- coding: cp1250 -*-
from __future__ import division
from numpy import *
from matplotlib import rc
from matplotlib.pyplot import *
import numpy as np
import matplotlib.pyplot as plt

data = loadtxt("mioni.txt", int)

nuz = len(data)
nsmp = 20
duz = int(nuz/nsmp)

L = []

for i1 in range(0,nsmp):
    suma = 0
    for i2 in range(0,duz):
        suma += data[i1*duz+i2]
    L.append(suma)

print L

plt.hist(L, 20, normed=1, facecolor='blue', alpha=0.75)
plt.xlabel('t(\mu s)')
plt.ylabel('Broj događaja')
plt.axis([0,10,0,300])
plt.grid(True)

plt.show() 
```

编辑：所以我设法处理丑陋的总和，但现在我的直方图不起作用:(数据在这里：`http://dropcanvas.com/kqjem`

怎么了？我收到大量错误和 python 崩溃：\

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T14:55:16.300

问题来自于有一个离散的数据集，看起来你将`bins`参数设置为不合适的东西。使用`pylab.hist`参数`histtype="stepfilled"`让它们在没有线条的情况下接触。这里有一些例子：

```
import numpy as np
import pylab as plt

# Sample data
X1 = np.random.exponential(1.0,size=5000)
X2 = [int(z) for z in X1]

plt.subplot(221)
plt.hist(X1,bins=50)
plt.title('Continuous Data')

plt.subplot(222)
plt.hist(X2,bins=50)
plt.title('Discrete Data')

plt.subplot(223)
plt.hist(X2,histtype='stepfilled')
plt.title('Discrete Data Filled')

plt.show() 
```

![在此处输入图像描述](../Images/1a7275504568dc6d4ef5445006112ec0.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T14:24:26.457

使用`numpy.histogram`：[http ://docs.scipy.org/doc/numpy/reference/generated/numpy.histogram.html](http://docs.scipy.org/doc/numpy/reference/generated/numpy.histogram.html)

或`matplotlib.pyplot.hist`： http: [//matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.hist](http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.hist)

例如：

```
plt.hist(data, bins=20) 
```

# c++ - OpenSSL：按块对大文件进行 AES CCM 256 位加密：可能吗？

> ID：15137857
> 
> 赞同：4
> 
> 时间：2013-02-28T14:22:25.433
> 
> 标签：c++, c, openssl, aes, encryption-symmetric

我正在处理使用**AES CCM 模式**（**256 位密钥**长度）加密大文件的任务。其他用于加密的参数是：

*   **标签**大小：8字节
*   **iv**大小：12 字节

由于我们已经使用**OpenSSL 1.0.1c** ，因此我也想将它用于此任务。

文件的大小事先不知道，它们可能非常大。这就是为什么我想按块读取它们并使用**EVP_EncryptUpdate**单独加密每个块，直到文件大小。

不幸的是，**只有当**整个文件一次加密时，加密才对我有效。如果我尝试多次调用它，我会收到 EVP_EncryptUpdate 错误或奇怪的崩溃。我使用 gcc 4.7.2 在 Windows 7 和 Ubuntu Linux 上测试了加密。

我无法在[OpenSSL](http://www.openssl.org/docs/crypto/EVP_EncryptInit.html)站点上找到无法（或不可能）逐块加密数据的信息。

附加参考：

*   [http://www.fredriks.se/?p=23](http://www.fredriks.se/?p=23)
*   [http://incog-izick.blogspot.in/2011/08/using-openssl-aes-gcm.html](http://incog-izick.blogspot.in/2011/08/using-openssl-aes-gcm.html)

请参阅下面的代码，该代码演示了我试图实现的目标。不幸的是，它在 for 循环中指示的地方失败了。

```
#include <QByteArray>
#include <openssl/evp.h>

// Key in HEX representation
static const char keyHex[] = "d896d105b05aaec8305d5442166d5232e672f8d5c6dfef6f5bf67f056c4cf420";
static const char ivHex[]  = "71d90ebb12037f90062d4fdb";

// Test patterns
static const char orig1[] = "Very secret message.";

const int c_tagBytes      = 8;
const int c_keyBytes      = 256 / 8;
const int c_ivBytes       = 12;

bool Encrypt()
{
    EVP_CIPHER_CTX *ctx;
    ctx = EVP_CIPHER_CTX_new();
    EVP_CIPHER_CTX_init(ctx);

    QByteArray keyArr = QByteArray::fromHex(keyHex);
    QByteArray ivArr = QByteArray::fromHex(ivHex);

    auto key = reinterpret_cast<const unsigned char*>(keyArr.constData());
    auto iv = reinterpret_cast<const unsigned char*>(ivArr.constData());

    // Initialize the context with the alg only
    bool success = EVP_EncryptInit(ctx, EVP_aes_256_ccm(), nullptr, nullptr);
    if (!success) {
        printf("EVP_EncryptInit failed.\n");
        return success;
    }

    success = EVP_CIPHER_CTX_ctrl(ctx, EVP_CTRL_CCM_SET_IVLEN, c_ivBytes, nullptr);
    if (!success) {
        printf("EVP_CIPHER_CTX_ctrl(EVP_CTRL_CCM_SET_IVLEN) failed.\n");
        return success;
    }
    success = EVP_CIPHER_CTX_ctrl(ctx, EVP_CTRL_CCM_SET_TAG, c_tagBytes, nullptr);
    if (!success) {
        printf("EVP_CIPHER_CTX_ctrl(EVP_CTRL_CCM_SET_TAG) failed.\n");
        return success;
    }

    success = EVP_EncryptInit(ctx, nullptr, key, iv);
    if (!success) {
        printf("EVP_EncryptInit failed.\n");
        return success;
    }

    const int bsize = 16;
    const int loops = 5;
    const int finsize = sizeof(orig1)-1; // Don't encrypt '\0'

    // Tell the alg we will encrypt size bytes
    // http://www.fredriks.se/?p=23
    int outl = 0;
    success = EVP_EncryptUpdate(ctx, nullptr, &outl, nullptr, loops*bsize + finsize);
    if (!success) {
        printf("EVP_EncryptUpdate for size failed.\n");
        return success;
    }
    printf("Set input size. outl: %d\n", outl);

    // Additional authentication data (AAD) is not used, but 0 must still be
    // passed to the function call:
    // http://incog-izick.blogspot.in/2011/08/using-openssl-aes-gcm.html
    static const unsigned char aadDummy[] = "dummyaad";
    success = EVP_EncryptUpdate(ctx, nullptr, &outl, aadDummy, 0);
    if (!success) {
        printf("EVP_EncryptUpdate for AAD failed.\n");
        return success;
    }
    printf("Set dummy AAD. outl: %d\n", outl);

    const unsigned char *in = reinterpret_cast<const unsigned char*>(orig1);
    unsigned char out[1000];
    int len;

    // Simulate multiple input data blocks (for example reading from file)
    for (int i = 0; i < loops; ++i) {
        // ** This function fails ***
        if (!EVP_EncryptUpdate(ctx, out+outl, &len, in, bsize)) {
            printf("DHAesDevice: EVP_EncryptUpdate failed.\n");
            return false;
        }
        outl += len;
    }

    if (!EVP_EncryptUpdate(ctx, out+outl, &len, in, finsize)) {
        printf("DHAesDevice: EVP_EncryptUpdate failed.\n");
        return false;
    }
    outl += len;

    int finlen;
    // Finish with encryption
    if (!EVP_EncryptFinal(ctx, out + outl, &finlen)) {
        printf("DHAesDevice: EVP_EncryptFinal failed.\n");
        return false;
    }
    outl += finlen;
    // Append the tag to the end of the encrypted output
    if (!EVP_CIPHER_CTX_ctrl(ctx, EVP_CTRL_CCM_GET_TAG, c_tagBytes, out + outl)) {
        printf("DHAesDevice: EVP_CIPHER_CTX_ctrl failed.\n");
        return false;
    };
    outl += c_tagBytes;
    out[outl] = '\0';

    EVP_CIPHER_CTX_cleanup(ctx);
    EVP_CIPHER_CTX_free(ctx);

    QByteArray enc(reinterpret_cast<const char*>(out));

    printf("Plain text size: %d\n", loops*bsize + finsize);
    printf("Encrypted data size: %d\n", outl);

    printf("Encrypted data: %s\n", enc.toBase64().data());

    return true;
} 
```

**编辑（错误的解决方案）**

我收到的反馈让我想到了一个不同的方向，我发现必须为**每个**要加密的块调用 EVP_EncryptUpdate 的大小，**而不是文件的总大小**。我在块被加密之前移动了它：像这样：

```
for (int i = 0; i < loops; ++i) {
    int buflen;
    (void)EVP_EncryptUpdate(m_ctx, nullptr, &buflen, nullptr, bsize);
    // Resize the output buffer to buflen here
    // ...
    // Encrypt into target buffer
    (void)EVP_EncryptUpdate(m_ctx, out, &len, in, buflen);
    outl += len;
} 
```

AES CCM 加密逐块以这种方式工作，**但不正确**，因为每个块都被视为独立消息。

**编辑 2**

OpenSSL 的实现只有在一次加密完整的消息时才能正常工作。

[http://marc.info/?t=136256200100001&r=1&w=1](http://marc.info/?t=136256200100001&r=1&w=1)

我决定改用 Crypto++。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T15:11:13.390

对于 AEAD-CCM 模式，您无法在将相关数据馈送到上下文后加密数据。加密所有数据，并且只有在它传递关联数据之后。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T15:17:05.097

我在这里发现了一些误解

首先 EVP_EncryptUpdate(ctx, nullptr, &outl 以这种方式调用是为了知道需要多少输出缓冲区，以便您可以分配缓冲区，第二次将第二个参数作为有效的足够大的缓冲区来保存数据。

当您实际添加加密输出时，您也传递了错误的（被先前的调用覆盖）值。

# java - 索引 > 使用 B 树

> ID：15137861
> 
> 赞同：4
> 
> 时间：2013-02-28T14:22:34.600
> 
> 标签：java, mutable, b-tree, multimap, persistent-storage

我即将用它们的 ID（现在是它们的行号）索引 1000 万个标题，标题将在标记它们后被存储。数据的结构必须类似于`<String, Arraylist<Integer>>.`字符串代表标记，整数代表行号。

我必须使用 Java、持久内存、尽可能不使用 RDBMS 来构建这个工具。由于这个数据结构是可变的，我找不到任何支持 MultiMaps 的工具，其结构 > 要使用 BTree 或任何其他持久数据结构进行索引。

我试过[MapDB](http://www.mapdb.org)，但转而只接受不可变的，在我的情况下不适用（Arraylist）

任何想法表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T19:58:43.677

你需要的是MultiMap。MapDB 不直接支持这些，但具有几乎一样好的复合集。

示例在这里： [https ://github.com/jankotek/MapDB/blob/release-1.0/src/test/java/examples/MultiMap.java](https://github.com/jankotek/MapDB/blob/release-1.0/src/test/java/examples/MultiMap.java)

# vb.net - Datagridview 控件修改另一个

> ID：15137863
> 
> 赞同：2
> 
> 时间：2013-02-28T14:22:36.320
> 
> 标签：vb.net, datagridview, combobox

我正在尝试根据我在我的第一个（也包含列）中`combobox`的选择为我的第二个添加值。`combobox``datagridview``textbox`

这是我的代码：

```
Private Sub DataGridView1_EditingControlShowing(sender As Object, e As System.Windows.Forms.DataGridViewEditingControlShowingEventArgs) Handles DataGridView1.EditingControlShowing
    Try
        'Sub Recurrence combobox is selected
        If DataGridView1.CurrentCell.ColumnIndex = 4 Then
            'Verify what is chosen in the Recurrence textbox
            Dim rowIndex = DataGridView1.CurrentCell.RowIndex
            Dim FirstComboboxValue = DataGridView1(3, rowIndex).Value

            If Not IsNothing(FirstComboboxValue) Then
                Dim cmb As ComboBox = TryCast(e.Control, ComboBox)
                RemoveHandler cmb.SelectedIndexChanged, New EventHandler(AddressOf ComboBox_SelectedIndexChanged)
                AddHandler cmb.SelectedIndexChanged, New EventHandler(AddressOf ComboBox_SelectedIndexChanged)
            End If
        End If
    Catch ex As Exception
        MsgBox(ex.ToString())
    End Try
End Sub 
```

我的处理程序触发 ComboBox_SelectedIndexChanged 事件的触发器：

```
Private Sub ComboBox_SelectedIndexChanged(ByVal sender As Object, ByVal e As EventArgs)
    If DataGridView1.CurrentCell.ColumnIndex = 4 Then
        Dim comboBox As ComboBox = CType(sender, ComboBox)
        Dim cbCell As DataGridViewComboBoxCell = DirectCast(DataGridView1.Rows(DataGridView1.CurrentCell.RowIndex).Cells(4), DataGridViewComboBoxCell)
        Dim rowIndex = DataGridView1.CurrentCell.RowIndex
        Dim FirstComboboxValue = DataGridView1(3, rowIndex).Value

        'Clear items so they don't keep adding on each other
        cbCell.Items.Clear()

        Select Case FirstComboboxValue
            Case "Choice1"
                cbCell.Items.Add("Item1")
                cbCell.Items.Add("Item2")
            Case "Choice2"
                cbCell.Items.Add("Item3")
                cbCell.Items.Add("Item4")
            Case "Choice3"
                cbCell.Items.Add("Item5")
            Case "Choice4"
                cbCell.Items.Add("Item6")
                cbCell.Items.Add("Item7")
        End Select

        'Remove event handler to prevent memory leak
        RemoveHandler comboBox.SelectedIndexChanged, AddressOf ComboBox_SelectedIndexChanged
    End If
End Sub 
```

出于某种原因，当我使用断点并单步执行程序时，`combobox`仅在我第二次尝试打开“项目”时才在第二次添加项目`combobox`。

如果我尝试在不调试的情况下运行程序，则不会显示任何内容。知道我做错了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T14:53:49.383

如果您在 ComboBox 中使用 SelectedIndexChanged，即使您没有单击 ComboBox，您也可能会遇到触发事件的问题。

当您打开和关闭 Windows 窗体时会发生这种情况。

**通过使用SelectionChangeCommitted**事件，这是一个更好的选择。

当所选项目发生更改并且该更改显示在 ComboBox 中时，将发生 SelectionChangeCommitted 事件。

通过使用 SelectionChangeCommitted 事件，您无需声明 RemoveHandler 和 AddHandler 语句。

* * *

另一种可能：

试试**Handles cmb.SelectedIndexChanged**

在 VB.NET 中有多种声明事件的方法。通常是使用handles 关键字。

```
Private Sub ComboBox_SelectedIndexChanged(ByVal sender As Object,
            ByVal e As EventArgs) Handles cmb.SelectedIndexChanged 
```

# javascript - 隐藏显示表格行

> ID：15137867
> 
> 赞同：1
> 
> 时间：2013-02-28T14:22:39.447
> 
> 标签：javascript, html

下面是我的代码，通过隐藏或使下面的表格行可见，它可以完美地工作。我遇到的问题是，当我验证我的表单并提交表单时，可见的表格行隐藏起来。选中复选框时，它应该保持可见。该复选框仍处于选中状态，但是，表格行隐藏了。

我还想提一下，即使表格隐藏了，在选中复选框后，它也会保留所有表单字段，没有任何丢失，问题是表格隐藏了。有任何想法吗？？

任何想法为什么会这样？

```
<style>
<!--
.hidden 
{
display: none;
}
.visible 
{
}
</style>

<script type="text/javascript">
<!--
var last = "";
function show(div)
{
    if (last)
    {
        document.getElementById(last).className = "hidden";
    }   
    if (div && document.getElementById(div))
    {
        document.getElementById(div).className = "visible";
        last = div;
    }
}
</javascript>

<input name="showme" value="yesshowme" type="checkbox" onClick="show(this.value);">

<tr id="yesshowme" class="hidden">
blablablablalbla
</tr>

<submit name="submit" value="submit"> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T14:26:31.380

当您单击提交时，表单会自行发布，并且由于您没有提供表单的标记，我的假设是它会发布**到**自己。鉴于这些信息，您的页面可能会在进行任何更改之前恢复到其原始状态。如果您希望保留所做的更改，则需要从您将这些更改发布到的任何数据源加载它们，或者通过使用会话或 cookie 来保持它们的状态。如果您通过 ajax 进行更改，您只需要添加`onclick="myAjaxCall();return false;"`到您的提交按钮。

# android - 在 uri 中使用 post 发送数据

> ID：15137870
> 
> 赞同：0
> 
> 时间：2013-02-28T14:22:53.723
> 
> 标签：android, post

我必须在类似于这样的 url 中发送数据：

[http://webservices.fecth.es/school/message/sendmessage/id/myStringId/destination/myStringDestination/msg/myMessage](http://webservices.fecth.es/school/message/sendmessage/) *_* _ **_** _ *_* _ **_** _ *_* _ **_**

我在字符串中有必要的数据，但不是通过 post 方法发送，我已经测试了这段代码但不起作用：

```
String postURL = "http://webservices.fecth.es/school/message/sendmessage/";
HttpPost post = new HttpPost(postURL);
List<NameValuePair> param = new ArrayList<NameValuePair>();
param.add(new BasicNameValuePair("id", myId));
param.add(new BasicNameValuePair("destination", myStringDestination));
param.add(new BasicNameValuePair("msg", myMessage));

UrlEncodedFormEntity ent = new UrlEncodedFormEntity(param,HTTP.ISO_8859_1);
post.setEntity(ent);
HttpResponse responsePOST = client.execute(post);
HttpEntity resEntity = responsePOST.getEntity(); 
```

他们可以帮助我解决我的问题吗？

非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T14:32:21.437

试试这个：

```
StringBuffer postURL = new StringBuffer("http://webservices.fecth.es/school/message/sendmessage/");
postURL.append("id/");
postURL.append(URLEncoder.encode(myId, "UTF-8"));
postURL.append("/destination/");
postURL.append(URLEncoder.encode(myStringDestination, "UTF-8"));
postURL.append("/msg/");
postURL.append(URLEncoder.encode(myMessage, "UTF-8"));

HttpPost post = new HttpPost(postURL.toString());
HttpResponse responsePOST = client.execute(post);
HttpEntity resEntity = responsePOST.getEntity(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T14:29:40.887

请使用以下代码检查状态

```
responsePOST.getStatusLine().getStatusCode() 
```

# android - 如何在您的 Android 应用中从 Google Play 销售音乐？

> ID：15137872
> 
> 赞同：1
> 
> 时间：2013-02-28T14:22:54.867
> 
> 标签：android, google-play

我有客户要求在他可以出售的安卓应用程序中显示他专辑的谷歌音乐。

我在谷歌上搜索并知道没有可用的官方 API，有人建议我用其他方法或解决方案来实现这一点吗？

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T14:27:41.557

谷歌搜索 Google Play 非官方 API 会出现这个基于 Java 的选项：

[https://github.com/jkiddo/gmusic.api](https://github.com/jkiddo/gmusic.api)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T14:45:53.043

如果您想直接链接到 Google Play 商店，最好的方法可能是找出您要链接到的产品的 Web URL，然后将其称为 VIEW 意图。例如：

```
Intent intent = new Intent(Intent.ACTION_VIEW);
intent.setData(Uri.parse("https://play.google.com/store/music/album?id=Bwp56isr3gk7dcvakz3zvqr5kry"));
startActivity(intent); 
```

如果设备安装了 Google Play 应用程序，它将拦截这些 URL，并为您提供使用 Google Play 应用程序打开它们的选项。

通常，您会使用 market:// URL 直接访问 Play 商店应用，但不幸的是，您似乎只能将这些 URL 用于应用。

# javascript - 下拉特定列表上的内容

> ID：15137873
> 
> 赞同：0
> 
> 时间：2013-02-28T14:22:58.503
> 
> 标签：javascript, jquery

需要这方面的帮助

单击时需要它，它会向下滑动内容，再次单击时它会向上滑动

```
<li>...</li>    
<li>...</li>
<li id="with-content"><a href="#">Click here</a>
<div class="content">Some div here Some div here Some div here</div>
</li> 
```

只有该特定列表而不是所有列表需要显示内容或使用幻灯片效果隐藏

我怎么能用jquery做到这一点？请任何帮助都可以，只是一个简单的向下滑动+向上滑动效果

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T14:27:19.903

这应该是微不足道的，通过搜索来弄清楚，一点点努力就可以了，但我还是会回答：

```
$('#with-content a').on('click', function(e) {
    e.preventDefault();
    $(this).closest('li').find('.content').slideToggle(600);
}); 
```

ID 是唯一的，它可能需要包含在 document.ready 中，并且 jQuery 必须包含在站点中？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T14:28:31.060

```
$('#with-content a').on('click', function(e) {
   e.preventDefault();
   $('#with-content').toggle();
}); 
```

# jquery-ui - jQuery UI 多个可选择的工具提示正在崩溃

> ID：15137876
> 
> 赞同：1
> 
> 时间：2013-02-28T14:23:02.310
> 
> 标签：jquery-ui, tooltip, jquery-ui-tooltip

我是 jQuery UI 的新手。

我正在尝试创建一个**可选择**的jQuery UI 工具提示。工具提示与页面上的链接相关联。

当链接仅被文本包围时，它可以正常工作。但是当彼此相邻的链接很少时，功能重叠并且工具提示不再流畅地显示。

您可以在[http://jsfiddle.net/zumot/Hc3FK/2/上找到代码](http://jsfiddle.net/zumot/Hc3FK/2/)

JavaScript 代码下方

```
$("[title][data-scan]").bind("mouseleave", function (event) {
event.stopImmediatePropagation();
var fixed = setTimeout('$("[title][data-scan]").tooltip("close")', 100);
$(".ui-tooltip").click(function () {
    alert("I am clickable");
    return false;
});
$(".ui-tooltip").hover(
function () {
    clearTimeout(fixed);
},
function () {
    $("[title][data-scan]").tooltip("close");
});}).tooltip({
items: "img, [data-scan], [title]",
content: function () {
    var element = $(this);
    if (element.is("[data-scan]")) {
        var text = element.attr("href");
        return "<a href='http://www.google.com'>You are trying to open a tooltip  <span>" + text + "</span></a>";
    }
    if (element.is("[title]")) {
        return element.attr("title");
    }
    if (element.is("img")) {
        return element.attr("alt");
    }
},
position: {
    my: "right center",
    at: "left center",
    delay: 200,
    using: function (position, feedback) {
        $(this).css(position);
        $("<div>")
        .addClass(feedback.vertical)
            .addClass(feedback.horizontal)
            .appendTo(this);
    }
}}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T11:32:08.680

My attempt to fix the issue was by making the variable **`fixed`** global (to make it accessible by other jQuery UI properties), and on **`Open`** event, hide any other previously opened tooltips and clear the timeout id saved in `fixed` variable.

* * *

You can find the solution here [http://jsfiddle.net/zumot/dVGWB/](http://jsfiddle.net/zumot/dVGWB/) , though to see the code working properly, you'll have to run it directly on your browser.

* * *

Here's the snapshort of the fixed code.

```
 // Make the timeout id variable global
    var fixed = 0;

$("[title][data-scan]").tooltip({
    items: "img, [data-scan], [title]",
    content: function () {
        var element = $(this);
        if (element.is("[data-scan]")) {
            var text = element.attr("href");
            return "<a href='http://www.google.com'>You are trying to open a tooltip  <span>" + text + "</span></a>";
        }
        if (element.is("[title]")) {
            return element.attr("title");
        }
        if (element.is("img")) {
            return element.attr("alt");
        }
    },
    open: function (event, ui) {
        // When opening a new div, hide any previously opened tooltips first.
        $(".ui-tooltip:not([id=" + ui.tooltip[0].id + "])").hide();
        // clear timeout as well if there's any.
        if (tf > 0) {
            clearTimeout(tf)
        };
    },
    position: {
        my: "right center",
        at: "left center",
        delay: 200,
        using: function (position, feedback) {
            $(this).css(position);
            $("<div>")
                .addClass(feedback.vertical)
                .addClass(feedback.horizontal)
                .appendTo(this);
        }
    }
}).bind("mouseleave", function (event) {
    // stop defeulat behaviour
    event.stopImmediatePropagation();
    fixed = setTimeout('$("[title][data-scan]").tooltip("close")', 100);
    $(".ui-tooltip").hover(

    function () {
        clearTimeout(tf);
    }, function () {
        $("[title][data-scan]").tooltip("close");
    })
}); 
```

# python - 使用熊猫返回排序行的索引值？

> ID：15137877
> 
> 赞同：1
> 
> 时间：2013-02-28T14:23:05.300
> 
> 标签：python, pandas

我最近才发现熊猫的力量。（感谢 Wes McKinney！）我有一个包含以下信息的 csv：

```
RUN_START_DATE,PUSHUP_START_DATE,SITUP_START_DATE,PULLUP_START_DATE
2013-01-24,2013-01-02,2013-01-30,2013-02-03
2013-01-30,2013-01-21,2013-01-13,2013-01-06
2013-01-29,2013-01-28,2013-01-01,2013-01-29
2013-02-16,2013-02-12,2013-01-04,2013-02-11
2013-01-06,2013-02-07,2013-02-25,2013-02-12
2013-01-26,2013-01-28,2013-02-12,2013-01-10
2013-01-26,2013-02-10,2013-01-12,2013-01-30
2013-01-03,2013-01-24,2013-01-19,2013-01-02
2013-01-22,2013-01-13,2013-02-03,2013-02-05
2013-02-06,2013-01-16,2013-02-07,2013-01-11 
```

通常，我不会在此过程中使用 pandas。我使用 csv 库来生成列表。使用日期时间库转换它们。然后我遍历每一行并运行类似以下的内容来获取每一行的排序索引：

```
'"' + ','.join(map(str, sorted(range(len(dates)), key=lambda k: dates[k]))) + '"' 
```

然后它为每一行返回如下内容：

```
Out[40]: '"1,0,2,3"' 
```

然后我将它添加到每行的末尾作为我的 csv 中的一个新字段。

我可以将 csv 读入 pandas 并将项目转换为 date dtype。我只是不确定如何使用 pandas 获取已排序的索引值，然后将它们展平为字符串并将它们放入列中？非常感谢任何帮助！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-28T14:33:27.490

您可以使用`numpy.argsort()`来获取排序索引：

```
from StringIO import StringIO
import numpy as np
import pandas as pd

txt = """RUN_START_DATE,PUSHUP_START_DATE,SITUP_START_DATE,PULLUP_START_DATE
2013-01-24,2013-01-02,2013-01-30,2013-02-03
2013-01-30,2013-01-21,2013-01-13,2013-01-06
2013-01-29,2013-01-28,2013-01-01,2013-01-29
2013-02-16,2013-02-12,2013-01-04,2013-02-11
2013-01-06,2013-02-07,2013-02-25,2013-02-12
2013-01-26,2013-01-28,2013-02-12,2013-01-10
2013-01-26,2013-02-10,2013-01-12,2013-01-30
2013-01-03,2013-01-24,2013-01-19,2013-01-02
2013-01-22,2013-01-13,2013-02-03,2013-02-05
2013-02-06,2013-01-16,2013-02-07,2013-01-11"""
df = pd.read_csv(StringIO(txt))
idx = np.argsort(df, axis=1)
buf = StringIO()
idx.to_csv(buf, index=False, header=False)
print buf.getvalue() 
```

输出：

```
1,0,2,3
3,2,1,0
2,1,0,3
2,3,1,0
0,1,3,2
3,0,1,2
2,0,3,1
3,0,2,1
1,0,2,3
3,1,0,2 
```

# c - 我不明白这个程序是如何工作的

> ID：15137881
> 
> 赞同：1
> 
> 时间：2013-02-28T14:23:09.060
> 
> 标签：c

在下面的程序中

```
#include<stdio.h>   
int main()    
{    
    char i=0;    
    for(i<=5 && i>=-1;++i;i>0)   
        printf("%d\t",i);
    return 0;    
} 
```

'i' 从 1 打印到 127，然后从 -128 打印到 -1。

为什么会这样？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-02-28T14:28:25.580

这一定是我一生中见过的最畸形的 for 循环。for 循环的格式如下

```
for ( initalization; condition; update ) 
```

在`for`循环的开始，`initialization`发生。这通常类似于`i = 0`. 在每个循环的顶部，`condition`（通常类似于`i < 5`）被评估以查看循环是否应该继续，如果循环继续，`update`则执行（再次，通常类似于`++i`），并且循环再次执行。

这里发生的事情是循环`++i`用作条件，所以它只会在`++i`计算为一个`0`值时终止，所以你从开始`1`并递增直到从to`char i`溢出，然后继续递增直到它达到，此时评估为和循环终止`128``-127``-1``++i``0`

**编辑**

因此，根据您的代码，`i<=5 && i>=-1`在循环的第一次迭代的最开始执行（这完全没有完成任何事情），然后`++i`评估布尔状态（`0`开始，并使用预增量，评估是`1`，因此，而不是`0`布尔值通过），然后执行`update`部分`i>0`，它再次什么也不做。

**编辑2**

如果你的问题真的是关于为什么会这样，`1,2....128,-127,-126....-1`那么 Joachim 对这种行为提供了一个很好的解释

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-28T14:25:42.610

好消息：在您的实施中，`char`已签署！

此外，发生的情况是`i`从 127 溢出到 -128 的值，因为 127 是适合带符号的最大正值`char`。

**编辑：**实际上，我不确定`char`您的实现中的签名，但是循环完全被破坏了：

应该是

```
for (i = 0; i <= 5; i++) 
```

但这只是一个猜测。很难解释。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-28T14:28:23.723

您可能想阅读有关[二进制补码表示的信息](http://en.wikipedia.org/wiki/Two%27s_complement)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-02-28T14:27:08.227

A`char`是编译器中的有符号 8 位整数。它可以表示从 -128 到 +127 的值。循环结束条件是`++i`，并且在 C 中所有非零值都被认为是真的，所以它将循环直到`++i`为零，这将在`i`is时发生`-1`。

if 从 127 变为 -128 的原因是有符号整数在计算机中的工作方式。127 的二进制位是`01111111`，-128 的位模式是`1000000`。加一`01111111`将导致`10000000`.

总而言之，你的`for`循环没有真正的意义。它在语法上是正确的，但没有任何意义。有关 for 循环如何工作的解释，请参阅 Dan F 的答案。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-28T14:30:35.547

顺便说一句，那个 for 循环太可怕了。你知道它应该是`for(intialisation; end condition; increment)`，对吧？

反正。i 初始化为 0；for 循环的第一个循环是测试具有预增量的结束条件 (++i)。所以我递增到 1，循环运行以打印 1。

现在重复。每个循环都会为 i 打印一个更高的值，因为结束条件测试是预先增加 i 的。

最终我达到了 127；然后它递增到 128，但您将其打印为“%d”，它需要一个有符号整数，因此使用二进制补码将其解释为 -128。

然后增量一直持续到 255（打印为 -1）。下一个预增量导致溢出，因此 i 再次变为 0，此时“结束条件测试”评估为 false 并且循环停止。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-02-28T14:31:34.727

这个程序有很奇怪的用于循环。您通过检查它们“i<=5 && i>=-1”来初始化循环变量 - 没有完成分配。在循环期间，您评估条件“++i”，直到 i = -1; 在增量步骤中，您只需检查数字是否大于零。

你实际上是这样做的：

```
for(i = 1; i != 0; i++)
{
    printf("%d\t",i);
} 
```

溢出高于 127 时，您会得到从 1 到 127 以及从 -128 到 -1 的数字。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-02-28T14:28:47.623

程序在打印时将“i”解释为一个 8 位有符号整数，即 1 位用于符号，7 位用于数据。这为您提供了 -128 到 127 的有效值范围。

“for”循环在 printf 之前*预先递增*i，因此给它一个第一次传递值 1，并且递增一直持续到 i+1=128 - 它翻转有符号整数中的符号位，然后运行循环直到 ++ i 导致 i 为 0。

# c# - 关于异常细节c#的问题

> ID：15137885
> 
> 赞同：1
> 
> 时间：2013-02-28T14:23:23.577
> 
> 标签：c#, exception, exception-handling

我试图用下面的代码捕获异常细节，但它没有给出细节错误。

我试图从我们的 ftp 服务器下载一个文件，其中包含 ftp 类之类的代码。当找不到文件时，我触发上述方法并传入异常。不幸的是，该方法打印了以下内容：

```
Error occured and Error details as follows
Exception occured in file 
Exception occured in method SyncRequestCallback
Exception occured in line & column number 0 0 
```

这是我的代码。如何捕获异常详细信息（例如行号、引发异常的方法等）？

```
public static string GetException(Exception ex)
{
    //Get a StackTrace object for the exception
    StackTrace st = new StackTrace(ex, true);
    //Get the first stack frame
    StackFrame frame = st.GetFrame(0);
    //Get the file name
    string fileName = frame.GetFileName();
    //Get the method name
    string methodName = frame.GetMethod().Name;
    //Get the line number from the stack frame
    int line = frame.GetFileLineNumber();
    //Get the column number
    int col = frame.GetFileColumnNumber();

    string strBody = "Hi,<br/><br/>";
    strBody = strBody + "Error occured and Error details as follows<br/>";
    strBody = strBody + "Error message " + ex.Message + "<br/>";
    strBody = strBody + "Exception occured in file " + fileName + "<br/>";
    strBody = strBody + "Exception occured in method " + methodName + "<br/>";
    strBody = strBody + "Exception occured in line & column number " + line + " " + col + "<br/><br/>Thanks";
    return strBody;
} 
```

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-28T14:25:31.923

为了捕获更多信息，您需要部署`.pdb` 构建时生成的文件。这将使您知道发生错误的特定行。

作为旁注，在我看来，您正在重新发明轮子，创建如此复杂的日志逻辑。[有很多框架会像log4net](http://logging.apache.org/log4net/)那样为你做脏活。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T14:25:53.873

调用`ToString`异常通常会生成公共详细信息的可读版本。并且只会显示异常可用的详细信息，因此如果应用程序未在调试模式下运行并且没有相应的 *.pdb 文件（或者事后您没有附加它们） - 和符号加载 - 那么您将无法获得详细的源信息。

# hive - 集成 hive 语句

> ID：15137888
> 
> 赞同：1
> 
> 时间：2013-02-28T14:23:32.190
> 
> 标签：hive

这几天写了一些hive Statement，但是在集成hive Statement的时候，出现了一些问题，具体情况在这（使用hadoop集群）：

当我跑步时：</p>

```
from tmp
  insert overwrite local directory '/tmp/out/jpg'
  select count(1) where logdate=0222 and req_uri regexp '\.(jpg|JPG)'； 
```

或者

```
from tmp
  insert overwrite local directory '/tmp/out/jpg_hit'                 
  select count(1) where logdate=0222 and req_uri regexp '\.(jpg|JPG)' and hit_status="hit"; 
```

结果在“/tmp/out/jpg”或“/tmp/out/jpg_hit”下面，都只有一个文件，文件上的结果（两个结果不相等）

但是当我跑步时：</p>

```
 from tmp
  insert overwrite local directory '/tmp/out/jpg'
  select count(1) where logdate=0222 and req_uri regexp '\.(jpg|JPG)'
  insert overwrite local directory '/tmp/out/jpg_hit'                 
  select count(1) where logdate=0222 and req_uri regexp '\.(jpg|JPG)' and hit_status="hit"; 
```

在“/tmp/out/jpg”或“/tmp/out/jpg_hit”下，都有很多文件，当我把每个文件编号相加时，我发现两个结果相等，并且等于大数字，结果是错误。我可以问你我如何解决这个问题吗？

# mysql - 使用 MyISAM 表在 mysql 上增加多个值

> ID：15137892
> 
> 赞同：0
> 
> 时间：2013-02-28T14:23:44.647
> 
> 标签：mysql, sql

我有这张桌子： cd_biblio 有一个书籍清单。

当我从我的 php 页面插入一本新书时，我想根据我插入的值 'Class' 增加一个字段（'Ingresso'）。

例如：
我插入一本带有“A”类的新书，他的“Ingresso”值将是“A”类的“Ingresso”的当前最大值 + 1。
如何使用 MyISAM 执行此操作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T14:27:45.320

使用程序或触发器 fe：

```
delimiter ~
CREATE PROCEDURE AddBook(...)
BEGIN
  DECLARE gIngresso INT DEFAULT 0;
  SELECT Max(Ingresso) INTO gIngresso FROM Table;
  INSERT INTO Table VALUE(... , gIngresso)
END~

delimiter ; 
```

# mysql - SELECT WITH LEFT JOIN 和 WHERE 子句

> ID：15137906
> 
> 赞同：0
> 
> 时间：2013-02-28T14:24:47.337
> 
> 标签：mysql, sql, sql-server, database

我有 2 个表：用户{用户名，用户 ID} 和奖品{用户 ID，奖品，状态}

我想选择除奖品表中“状态=死亡”的用户之外的所有用户*（来自用户左加入奖品）*

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-28T14:26:16.580

我认为你需要这里是`INNER JOIN`因为你只想搜索状态不等于的用户`dead`。

```
SELECT  a.*, b.*
FROM    Users a
        INNER JOIN Prizes b
            ON a.userID = b.UserID
WHERE   b.status <> 'dead' 
```

要进一步了解有关联接的更多信息，请访问以下链接：

*   [SQL 连接的可视化表示](http://www.codeproject.com/Articles/33052/Visual-Representation-of-SQL-Joins)

**更新 1**

```
SELECT  a.*, b.*
FROM    Users a
        LEFT JOIN Prizes b
            ON a.userID = b.UserID
WHERE   b.UserID IS NULL OR b.status <> 'dead' 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-28T14:32:24.683

试试这个;

```
select u.* 
from users as u 
left join prizes as p 
on u.userid = p.userid 
where p.status <>'dead'; 
```

谢谢

# dependency-injection - 在依赖注入中，要注入的对象在哪里创建？

> ID：15137907
> 
> 赞同：1
> 
> 时间：2013-02-28T14:24:55.843
> 
> 标签：dependency-injection

如果它是由将它注入到使用它的对象中的类创建的，那么它不只是将对象创建移到堆栈上一步吗？这是否意味着较低级别的类需要的所有对象都需要一次通过每个对象，直到它到达需要它的对象？

所有对象及其依赖项都可以在一开始就设置好，但是这会不会降低性能，因为对象会一直闲置直到需要？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T14:53:55.367

是的，它正在将对象实例化向上移动。但它正在将它向上移动到一个地方，在那里你可以更好地决定实际使用哪个实现。如果我想用存根版本替换我的数据访问层来对业务逻辑进行性能测试，我可以不更改任何一行业务逻辑代码。

有多种方法可以注入您的依赖项。就我而言，我到处都使用构造函数注入。使用此方法，如果较低级别的类需要依赖项，它只需将该依赖项的接口放在其构造函数中。无需从堆栈中更高的类传递。如果您在两个类中需要相同的实例，那么您应该查看在将依赖项注册到容器时的生活方式/范围，以便两个类碰巧传递相同的实例。

一些 DI 实现使用延迟加载来实例化它们的对象。（即，直到尝试使用该对象才实际实例化它）有些没有。此外，您将需要相当大的依赖关系图来降低性能。我向你保证，让你的构造函数保持简单和快速（无论如何都是一个好习惯），这不会是一个问题。DI 容器在释放不再使用的对象方面很聪明（同样，要特别注意生活方式/范围）。

我希望这有帮助。

# mysql - 在数组查询中添加 where 值的子句

> ID：15137910
> 
> 赞同：0
> 
> 时间：2013-02-28T14:25:00.997
> 
> 标签：mysql, sql

我有这段代码，我用它来获取列中的所有值并将它们保存在一个数组中。

```
$sektori="SELECT * FROM userss WHERE Username='".$_SESSION['user_name']."'" 
or die(mysql_error());  
$resektor = odbc_exec($connection, $sektori) or die(odbc_error());
while( $row = odbc_fetch_array($resektor) ) {
$ids_sektor = explode("/",$row['sektori']);
} 
```

我需要在这里添加这个条件：

```
$strSQL = "SELECT formas.*, SMS_SERVISI.IDTICKET, SMS_SERVISI.MBYLLUR,SMS_SERVISI.time_added
FROM formas 
LEFT JOIN SMS_SERVISI ON formas.ID = SMS_SERVISI.IDTICKET WHERE formas.data_fillim >= '$yesterday' AND formas.data_fillim <= '$tomorrow' AND  sektori_pergjegjes IN ($ids_sektor) ORDER BY formas.id DESC"; 
```

它说我有语法错误，但我不知道..也许我做错了，请帮忙。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T14:28:16.890

将您的条件更改为该条件：

```
"AND  sektori_pergjegjes IN ('" . implode('\',\'', $ids_sektor) . "')" 
```

# jasper-reports - jasper 变量表达式

> ID：15137915
> 
> 赞同：0
> 
> 时间：2013-02-28T14:25:26.683
> 
> 标签：jasper-reports, ireport

我想在 Jasper 中声明一个整数类型的变量，该变量在我的一个报告组的页脚处递增，并在另一个报告组的页脚处重置为 0。如何在变量的表达式中指定它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T14:40:47.653

在报告检查器中，右键单击“变量”以创建新变量。命名它，将变量类设置为 java.lang.Integer。设置计算类型（也许你正在对一个组求和？），将剩余类型设置为组，将剩余组设置为你的组的名称，并将初始值表达式设置为 0 以在新组开始时将其重置.

# java - WSDL 到 JAVA 客户端代码，使用 Apache Axis 1.4 和 Jdeveloper

> ID：15137917
> 
> 赞同：0
> 
> 时间：2013-02-28T14:25:31.163
> 
> 标签：java, web-services, wsdl, client

我正在尝试从 WSDL 生成客户端代码。我需要在 Jdeveloper 10g IDE 上工作。我使用内置工具 Oracle JAX-WS 2.1.5 从 WSDL 生成客户端代码。

对于特定的 WSDL，该工具生成了大约 122 个不包括该类的 Java`Locator`类。在运行代码时，我得到一个类未找到`WebServiceLocator`类的异常。

但是，当我使用 Apache Axis 1.4 ( Eclipse IDE ) 时，它会生成 63 个 java 类并且它还包含`WebServiceLocator`该类，但这并没有生成身份验证所需的所有方法，尽管 Oracle JAX-WS 2.1。 5\. 正在生成这些方法。

我尝试将 Eclipse 生成的 java 类合并到 Jdeveloper 中，但是我收到了很多与方法签名相关的错误。

为什么这两个不同的工具生成不同的客户端代码，并且没有一个完整的，有什么特别的原因吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-09-16T16:00:31.460

这可能有点晚了，但是对于遇到相同问题的人来说，这可能会有所帮助。如果您真的想使用 Axis 1.x 身份验证，请在您的客户端类上完成，如下所示：

```
MyLocator bindingService = new MyLocator();
bindingService .setPortEndPointAddress(myEndpoint);
MyPort port= bindingService.getMyPort();
((Stub)port)._setProperty(Stub.USERNAME_PROPERTY, myUsername);
((Stub)port)._setProperty(Stub.PASSWORD_PROPERTY, mPassword);
//Perform your query here 
```

我个人会使用 JAX-WS。使用 wsimport 生成存根（SOAPUI 有一个很好的插件来简化它）。对于 JAX-WS 客户端上的身份验证，最简单的方法是将 wsdl 保存在本地并将其作为 jar 的一部分导出，然后将其加载到客户端中。这首先消除了访问 wsdl 所需的 HTTP 授权需求。

```
URL myWsdlUrl = getClass().getClassLoader().getResource("wsdl/myWsdlFile.wsdl");
MyService service = new MyService(myWsdlUrl , new QName("uri", "localpart"));
myPort port= service .getPort();
BindingProvider bp= ((BindingProvider)vPort);
bp.getRequestContext().put(BindingProvider.ENDPOINT_ADDRESS_PROPERTY, myEndPoint);
bp.getRequestContext().put(BindingProvider.USERNAME_PROPERTY, myUsername);
bp.getRequestContext().put(BindingProvider.PASSWORD_PROPERTY, myPassword);
//Perform query here 
```

# integration - Scrum 中集成的用户故事

> ID：15137920
> 
> 赞同：5
> 
> 时间：2013-02-28T14:25:33.813
> 
> 标签：integration, agile, scrum, user-stories

我正在从事一个具有非常复杂的集成需求的项目，特别是接收和发送 EDI 数据以及介于两者之间的所有“有趣”的东西。我绝对可以将精力集中在数据处理（验证、必填字段、转换）上，但我遇到的问题是如何在积压工作中构建故事和史诗以计划和跟踪工作。

很容易说“作为经理，我可以拒绝休假请求，以确保我有足够的员工来履行我的承诺。” 实际上，我非常擅长这一点，但我对这种整合工作还很陌生。

对于大型集成项目，更难说明用户是谁，价值是什么。EDI 集成只是接口（非功能性）需求，但实施是一项艰巨的工作。

任何人都可以就如何在我正在创建的产品待办列表中构建/构建这些类型的需求提供一些指导吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-28T16:14:04.247

[迈克科恩](http://www.mountaingoatsoftware.com/blog/non-functional-requirements-as-user-stories)对此有话要说，我认为最后一段非常相关

> 但是，您应该注意不要沉迷于该模板。它只是一个思考工具。尝试在此模板中添加约束是一个很好的练习，因为它有助于确保您了解谁想要什么以及为什么想要什么。如果您最终得到一个措辞混乱的声明，请删除该模板。如果您无法找到表达约束的方法，只需以任何感觉自然的方式编写约束即可

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-03T03:05:31.297

Scrum 没有规定需求应该写成用户故事，你应该使用最适合你的技术。如果您正在与“AS A”类型的故事作斗争，请尝试“IN ORDER TO AS AI WANT”。如果不使用，请使用用例建模。

需求不是合同，而是沟通的占位符。这里的关键是要有足够的信息用于规划目的，让团队知道必须做什么。细节可以在sprint中讨论。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-03T09:24:47.887

我在这种情况下所做的是：

1) 尝试提出我们可以为集成实现的最简单的端到端功能。

2）尝试为该集成提出一个用例

3）将其转化为故事（可选步骤：故事不是物理定律。如果它们有用，您可以使用它们。）

例如：

1）好的 - 看起来身份验证是最简单的实现方式，涉及所有内容。

2）嘿 - 身份验证本身很有用。我们可以用它来知道这组用户是否可以访问数据。

3）“作为网站管理员，我想确保只有授权的东西才能访问 Foo 以防止有价值的信息被公开访问”

这样，您将始终拥有一个有效的 EDI 系统——它只涵盖了功能的一个子集。您可以随着时间的推移而增长的子集 - 希望按照功能对您的业务的重要性排序。

然而，我*真正的*偏好是更深入地了解*为什么要*进行 EDI。通常不会因为“EDI”是人们想要的功能。这是因为 EDI对于系统中的一些其他功能是*必需的。*

在这种情况下，与其拥有一个单独的 EDI 项目，我更愿意使用任何需要 EDI 的东西来驱动 EDI 层的开发。上面 (3) 中的故事将来自一个实时项目 - 你将更有可能构建你需要的东西并避免浪费。

# sql - 使用当前表的每小时读数创建表

> ID：15137923
> 
> 赞同：0
> 
> 时间：2013-02-28T14:25:37.750
> 
> 标签：sql, sql-server, select, create-table

我有一个用于每秒记录值的表

```
datetime                float   float
25/02/2013 08:18:56     6       147 
```

我需要创建一个表，上个月每个小时都有一行。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T14:42:21.130

为什么不直接在表中查询你想要的？

以下查询将返回每小时的第一次读数：

```
select <columns you want here>
from (select t.*,
             row_number() over (partition by year(datetime), month(datetime), day(datetime),
                                             datepart(hour, datetime)
                               ) as seqnum
      from t
     ) t
where seqnum = 1 
```

您可以将其放入表中，`into`在`select`.

# bash - 如何在批处理文件中检查 FTP 可用性以停止运行脚本

> ID：15137928
> 
> 赞同：0
> 
> 时间：2013-02-28T14:25:53.530
> 
> 标签：bash, scripting, ftp

我需要在批处理文件中创建一个验证函数来检查 FTP 服务器的可用性，因为我正在执行`put`命令然后删除我本地存储的文件。问题是如果我不检查 FTP 服务器是否启动，文件不会`put`发送到服务器而是本地删除。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T14:59:22.327

简单地使用“ping”而不是使用一些条件和“$”怎么样？> 什么时候？返回“2”（我认为）ftp 服务器已关闭

# asp.net-mvc - MVC @html.textbox 用于预填充 Guid 默认值

> ID：15137936
> 
> 赞同：2
> 
> 时间：2013-02-28T14:26:13.863
> 
> 标签：asp.net-mvc, asp.net-mvc-3, asp.net-mvc-4, guid, html.textboxfor

**我的控制器：**

```
 [HttpGet]
 public ActionResult AddEstablishment()
 {     
    return View("AddEstablishment",new EstablishmentModel());
 } 
```

**我的模型：**

```
public class EstablishmentModel
{
    [Display(Name = "Establishment ID")]
    public Guid EstablishmentId { get; set; }
    ............. 
```

**我的 AddEstablishment 视图：**

```
 @Html.TextBoxFor(x => x.EstablishmentId, new { @id = "inputEstGuid", @class = "input input-xlarge", @placeholder = "5C3B1CBC-2574-4E2A-A9FA-A8CA0041AB86" }) 
```

**结果：**

![在此处输入图像描述](../Images/85238a8758e9f8df1314b6f8a177ef5d.png)

*我的文本框预填充了 Guid 默认值*

`00000000-0000-0000-0000-000000000000`

**我怎样才能避免它？**

***请注意，我将模型实例传递给视图的原因很明显。***

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-28T14:38:14.537

这不应该工作吗？

```
 public Guid? EstablishmentId { get; set; } 
```

只需确保在最初显示视图时该值为 null。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T14:39:37.233

您不需要将模型传递到视图中，如果您不传递它，它将起作用

如果你真的必须这样做，请执行以下操作：

```
private string _establishmentIdAsString = string.Empty;
[Display(Name = "Establishment ID")]
public string EstablishmentIdAsString
{
    get
    {
        return _establishmentIdAsString;
    }
    set
    {
        _establishmentIdAsString = value;
        EstablishmentId = new Guid(value);
    }
} 
```

# java - 使用table在jsp页面中以指定的结构排列动态列表

> ID：15137942
> 
> 赞同：0
> 
> 时间：2013-02-28T14:26:27.970
> 
> 标签：java, jsp, jstl

我有一个动态生成的列表。我希望这个列表应该使用表格显示。结构应该如下

假设如果我有 6 个值，前 3 个值应该在第一行，第二个 3 应该在第二行我怎么能动态地做到这一点

```
<table>
<tr>
<td></td>
<td></td>
<td></td>
</tr>
</table> 
```

上述 tr 结构应每 3 个元素重复一次

我尝试使用 divs.its 工作，但我希望使用 table 实现相同的操作。帮帮我。

问候，拉维。

我的意思是该列表是 bean 的集合。在每个 bean 中我都有一些值。所以我的表如下所示

这是正在迭代的列表

```
<c:forEach value="#{theList}" var="item">

<div class="customer">
<p>${item.field1}</p>
<p>${item.field1}</p>
</div>

</c:foreach> 
```

从上面 div 客户的结构应该如下

*   前 3 个 bean 应该在 3 列的第一行
*   第二个 3 豆应该在第二行，有 3 列
*   继续……

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T14:30:15.100

使用 JSTL：

```
<table>
    <c:forEach items="#{theList}" var="item" varStatus="i">
    <c:if test="${i.index % 3 == 0 or i.begin}">
    <tr>
    </c:if>
        <td>${item.field}</td>
    <c:if test="${i.index % 3 == 0 or i.last}">
    </tr>
    </c:if>
    </c:forEach>
</table> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T14:37:46.647

```
<c:forEach items="${loopableObject}" var="theObject" varStatus="theCount">
 <table>
  <tr>
    <c:if test='${(status.index) lt 3}'>

    <td>${item.field1}</td>
    <td>${item.field2}</td>
    <td>${item.field3}</td>

   </c:if>
 </tr>

 <tr>
   <c:if test='${(status.index) gt 2}'>
    <td>${item.field1}</td>
    <td>${item.field2}</td>
    <td>${item.field3}</td>

   </c:if>
</tr>
</table>
</c:forEach> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-28T14:48:23.430

虽然我还没有测试过，但这样的事情可能会奏效。

```
<table>
    <tr>
        <c:forEach var="item" items="${yourList}" varStatus="loopStatus">
            <c:if test="${loopStatus.index % 3 == 0 }"><tr></c:if>
                <td><c:out value="${item}"/></td>
            <c:if test="${loopStatus.index % 3 == 0 }"></tr></c:if> 
        </c:forEach>
        <c:if test="${yourList.size % 3 != 0 }"></tr></c:if>
</table> 
```

# opengl-es - 不支持 AMD/ATI FirePro V5900 WebGl / OpenGl ES？

> ID：15137945
> 
> 赞同：0
> 
> 时间：2013-02-28T14:26:33.860
> 
> 标签：opengl-es, webgl, driver, ati, amd-processor

似乎使用 AMD 版本的当前（2013 年 2 月 28 日）催化剂驱动程序。9.3.3 不支持 WebGl。至少我无法将 Firefox 或 Chrome 与原生 GL 支持连接起来。它仅适用于启用 ANGLE。那么，是否有可用的驱动程序或有什么问题？

此外，似乎只有 Catalyst >10.8 版本支持 OpenGL ES，但根据发行说明，它们不支持 FirePro。

[发行说明 10.8](http://www2.ati.com/drivers/Catalyst_108_release_notes.pdf)

[发行说明 13.1](http://support.amd.com/us/kbarticles/Pages/AMDCatalystSoftwareSuiteVersion131.aspx)

# mercurial-server - Mercurial-server 向我的存储库添加权限

> ID：15137946
> 
> 赞同：1
> 
> 时间：2013-02-28T14:26:36.487
> 
> 标签：mercurial-server

我正在使用 mercurial-server 来管理企业服务器中的存储库。我为每个用户创建了一个存储库，我希望每个用户都可以访问另一个用户，即每个用户都可以访问存储库中的项目。但是在 mercurial-server 文档中，我看到只有管理员才能提供这种访问权限。

它是如何工作或通过 mercurial-server 甚至自己的 mercurial(hg) 以某种方式规避它的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-22T17:13:55.150

如果您想将访问权限管理委派给您的用户，他们需要有权访问`/hgadmin`存储库，并且他们应该能够修改`/hgadmin/access.conf`细粒度访问控制所在的文件。

据我所知，目前还没有办法使用 Mercurial-server 来进行访问控制孤岛，用户可以授予对他/她自己的存储库的访问权限，但不能授予*其他人的*存储库。但是，您应该能够为系统开发这样的扩展：使用一个挂钩，该挂钩可以从中提取相关权限，例如，`<user-repo>/admin/access.conf`并将它们复制到一个区域中，另一个挂钩或 cron 将仅选择与该`<user-repo>`区域相关的行（使用 sed 或perl 或任何你想要的），然后更新真实`access.conf`文件，最后提交并推送它。

希望它会有所帮助。

# javascript - 如何使用 underscore.js 进行 asc 和 desc 排序？

> ID：15137948
> 
> 赞同：176
> 
> 时间：2013-02-28T14:26:46.030
> 
> 标签：javascript, underscore.js

我目前正在使用 underscorejs 对我的 json 排序进行排序。现在我要求使用 underscore.js 进行排序`ascending`。`descending`我在文档中没有看到任何相同的内容。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：371
> 
> 时间：2013-02-28T14:30:41.427

您可以使用[`.sortBy`](http://underscorejs.org/#sortBy)，它总是会返回一个**升序**列表：

```
_.sortBy([2, 3, 1], function(num) {
    return num;
}); // [1, 2, 3] 
```

但是您可以使用[.reverse](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/reverse)方法使其**降序**：

```
var array = _.sortBy([2, 3, 1], function(num) {
    return num;
});

console.log(array); // [1, 2, 3]
console.log(array.reverse()); // [3, 2, 1] 
```

或者在处理数字时，在返回中添加一个负号以降低列表：

```
_.sortBy([-3, -2, 2, 3, 1, 0, -1], function(num) {
    return -num;
}); // [3, 2, 1, 0, -1, -2, -3] 
```

在引擎盖下[`.sortBy`](http://underscorejs.org/#sortBy)使用内置[`.sort([handler])`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/sort)：

```
// Default is alphanumeric ascending:
[2, 3, 1].sort(); // [1, 2, 3]

// But can be descending if you provide a sort handler:
[2, 3, 1].sort(function(a, b) {
    // a = current item in array
    // b = next item in array
    return b - a;
}); 
```

* * *

## 回答 #2

> 赞同：59
> 
> 时间：2013-08-12T18:28:56.733

使用下划线的降序可以通过将返回值乘以 -1 来完成。

```
//Ascending Order:
_.sortBy([2, 3, 1], function(num){
    return num;
}); // [1, 2, 3]

//Descending Order:
_.sortBy([2, 3, 1], function(num){
    return num * -1;
}); // [3, 2, 1] 
```

如果您按字符串而不是数字排序，则可以使用 charCodeAt() 方法获取 unicode 值。

```
//Descending Order Strings:
_.sortBy(['a', 'b', 'c'], function(s){ 
    return s.charCodeAt() * -1;
}); 
```

* * *

## 回答 #3

> 赞同：53
> 
> 时间：2014-09-12T11:17:20.827

Array 原型的[reverse 方法](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/reverse)修改数组并返回对它的引用，这意味着您可以这样做：

```
var sortedAsc = _.sortBy(collection, 'propertyName');
var sortedDesc = _.sortBy(collection, 'propertyName').reverse(); 
```

此外，下划线文档显示：

> 此外，[Array 原型的方法](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/prototype)通过链下划线对象代理，因此您可以将 a`reverse`或 a`push`滑入链中，并继续修改数组。

这意味着您也可以`.reverse()`在链接时使用：

```
var sortedDescAndFiltered = _.chain(collection)
    .sortBy('propertyName')
    .reverse()
    .filter(_.property('isGood'))
    .value(); 
```

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2017-06-20T08:58:46.063

与下划线库类似，还有另一个名为“lodash”的库，它有一个方法“orderBy”，它接受参数来确定排序的顺序。你可以像这样使用它

```
_.orderBy('collection', 'propertyName', 'desc') 
```

出于某种原因，它没有记录在网站文档中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-11-19T23:22:14.943

**下划线混合**

扩展@emil_lundberg 的答案，如果您使用Underscore 制作自定义排序函数，如果它是您可能在某处应用程序中重复的排序，您也可以编写一个“mixin”。

例如，也许您有一个控制器或视图排序结果，排序顺序为“ASC”或“DESC”，并且您想在该排序之间切换，您可以执行以下操作：

**Mixin.js**

```
_.mixin({
    sortByOrder: function(stooges, prop, order) {
      if (String(order) === "desc") {
          return _.sortBy(stooges, prop).reverse();
      } else if (String(order) === "asc") {
          return _.sortBy(stooges, prop);
      } else {
          return stooges;
      }
    }
}) 
```

**使用示例**

```
var sort_order = "asc";
var stooges = [
  {name: 'moe', age: 40}, 
  {name: 'larry', age: 50}, 
  {name: 'curly', age: 60},
  {name: 'July', age: 35},
  {name: 'mel', age: 38}
 ];

_.mixin({
    sortByOrder: function(stooges, prop, order) {
    if (String(order) === "desc") {
        return _.sortBy(stooges, prop).reverse();
    } else if (String(order) === "asc") {
        return _.sortBy(stooges, prop);
    } else {
        return stooges;
    }
  }
})

// find elements
var banner = $("#banner-message");
var sort_name_btn = $("button.sort-name");
var sort_age_btn = $("button.sort-age");

function showSortedResults(results, sort_order, prop) {
    banner.empty();
    banner.append("<p>Sorting: " + prop + ', ' + sort_order + "</p><hr>")
  _.each(results, function(r) {
    banner.append('<li>' + r.name + ' is '+ r.age + ' years old.</li>');
  }) 
}

// handle click and add class
sort_name_btn.on("click", function() {
  sort_order = (sort_order === "asc") ? "desc" : "asc"; 
    var sortedResults = _.sortByOrder(stooges, 'name', sort_order);
  showSortedResults(sortedResults, sort_order, 'name');
})

sort_age_btn.on('click', function() {
    sort_order = (sort_order === "asc") ? "desc" : "asc"; 
    var sortedResults = _.sortByOrder(stooges, 'age', sort_order);
  showSortedResults(sortedResults, sort_order, 'age');
}) 
```

这是一个展示这一点的 JSFiddle：[JSFiddle for SortBy Mixin](https://jsfiddle.net/zadLtr7j/)

# objective-c - 是否可以使用#define 解析数学表达式？

> ID：15137956
> 
> 赞同：0
> 
> 时间：2013-02-28T14:27:05.330
> 
> 标签：objective-c, macros, c-preprocessor

我想制作一个科学计算器，用户在其中输入类似 3+4*(3-5)/2 ³的内容，然后计算器可以返回该值。现在我试图找到一种方法来解析一串数学表达式。我知道有一些内置的解析器和算法，但我想知道是否可以通过使用`#define`方法。基本上，我想使用#define 从字面上删除字符串中的@ 和“”，使其看起来像一个可以评估的表达式。在这个阶段，我不会使用未知变量，例如 x 或 3*k 或 a*b/c。全部都是数字和运算符，例如 3+4 和 3 ²，可以由编译器直接计算。这是我想写的`#define`：

```
#define eval@"(x)" x 
```

在上面的代码中，eval 只是一个解析信号，@"x" 是需要解析的实际字符串，x 是一个数学表达式。翻译后，只剩下 x。例如，如果我写

```
double result = eval@"(3+4)"; 
```

编译器将读取

```
double result = 3+4; 
```

（根据我对 的理解`#define`）。但是，代码不起作用。我怀疑引号会混淆编译器并导致代码中断。所以我的问题是：任何人都可以提出使用的解决方案`#define`吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-28T14:36:59.213

这对于预处理器是不可能的，除了支持连接之外，没有字符串操作。

为什么你仍然需要 @"x" 语法？您可以将表达式直接放在代码中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-28T14:52:50.900

人们是对的，你不能直接这样做，但是如果你非常想要宏：

```
#define eval(x) [[[NSExpression expressionWithFormat:x] expressionValueWithObject:nil context:nil] doubleValue]

double result = eval(@"3+4"); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-28T14:41:25.547

`#define`是 C 预处理器的调用，它不能进行这种操作。听起来您几乎是在尝试定义一个与 LISP 宏做同样事情的 Objective-C 宏，但这是不可能的。您为什么不告诉我们您要解决[的原始问题是什么](https://meta.stackexchange.com/questions/66377/what-is-the-xy-problem)……我认为我们可能会想出一种更简单的方法来做您想做的事情。

# php - 如何获取magento表名

> ID：15137959
> 
> 赞同：7
> 
> 时间：2013-02-28T14:27:10.997
> 
> 标签：php, sql, magento, module, installation

我有这个全局配置：

```
<global>
    <models>
    <subscriber>
        <class>Giftlab_Subscriber_Model</class>
        <resourceModel>subscriber_resource</resourceModel>
    </subscriber>
    <subscriber_resource>
        <class>Giftlab_Subscriber_Model_Resource</class>
        <entities>
            <records>
                <table>subscriber_records</table>
            </records>
        </entities>
    </subscriber_resource>
    </models>
    <resources>
        <giftlab_subscriber_write>
            <connection>
                <use>core_write</use>
            </connection>
        </giftlab_subscriber_write>
        <giftlab_subscriber_read>
            <connection>
                <use>core_read</use>
            </connection>
        </giftlab_subscriber_read>
        <giftlab_subscriber_setup>
            <setup>
                <module>Giftlab_Subscriber</module>
                <class>Giftlab_Subscriber_Model_Resource_Setup</class>
            </setup>
            <connection>
                <use>core_setup</use>
            </connection>
        </giftlab_subscriber_setup>
    </resources>
</global> 
```

在我的 mysql4-install-0.1.0.php 文件中，我需要获取表名。我该怎么做？我知道它是这样的：

```
$this->getTable('subscriber_resource/records') 
```

但这只会产生异常`Can't retrieve entity config: subscriber_resource/records`。我需要做什么来检索表名？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-02-28T14:56:50.207

自己想出了答案，尽管感谢@Yaroslav 指导我阅读 Alan Storm 的教程，因为这有所帮助。

答案是，我需要这个：

```
$this->getTable('subscriber/records'); 
```

其中“subscriber”是模型（不是资源）的配置条目的名称，“records”是实体。事实证明，当 magento 解析thinga/thingb 时，它总是假定斜杠之前的thinga 是模型并取消引用以获取资源，方法是在配置中查找`<thinga><resourceModel>{resourcemodel}`，然后再次查找`<{resourcemodel}><entities><thingb><table>`以获取表名。

所以我的配置是正确的，我只是对模型和资源的概念感到困惑。希望这可以帮助其他人陷入同样的​​问题 - 我在各种教程中找不到任何明确的信息。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2016-03-29T13:01:21.950

如果您想获取**没有**资源模型的资源的表名（如`catalog/category_product`）并且您**不在**设置脚本中，您可以这样做：

```
$table = Mage::getSingleton('core/resource')->getTableName('catalog/category_product'); 
```

This is helpful for all N:M relations where you usually does not need a model class.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-28T14:37:01.563

在 Magento 上，您使用`Collections`. 查看示例：

```
$mysubscriber_recordsCollection = Mage::getModel('records/subscriber_records')->getCollection() 
```

查看有用的 Alan Storm 站点，特别是[Magento 模型教程](http://alanstorm.com/magento_models_orm)。

**编辑**

要在安装程序中获取表名，这里有一个详细的示例。注意`$installer->getTable('records/subscriber_records')`这里是加载表名的地方。

```
<?php
    echo 'Running This Upgrade: '.get_class($this)."\n <br /> \n";
    $installer = $this;
    $installer->startSetup();
    $installer->run("
        CREATE TABLE `{$installer->getTable('records/subscriber_records')}` (
            `subscriber_records_id` int NOT NULL AUTO_INCREMENT,
            PRIMARY KEY (`subscriber_records_id`)
            ) ENGINE=InnoDB DEFAULT CHARSET=utf8
    ");
    $installer->endSetup(); 
```

有关设置资源，请查看其他[Alan Storm 的教程](http://alanstorm.com/magento_setup_resources)

# nservicebus - Rebus 和分布式工人

> ID：15137961
> 
> 赞同：2
> 
> 时间：2013-02-28T14:27:13.357
> 
> 标签：nservicebus, worker-process, rebus

我们目前正在评估 Rebus 和 NServiceBus。Rebus 有什么类似于 NServiceBus 的分布式工作负载的东西吗？从文档中很难辨别:)。

亲切的问候克里斯蒂安

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T18:35:12.713

不，不幸的是，Rebus 还没有分销商——唯一的原因是我还没有体验到性能一直是个问题。

在我的（基于 VMWare 的）Windows 机器上，我可以使用 Rebus 发送 ~700 msg/sec 并接收 ~3500 msg/sec。

您的性能要求是什么？

如果确实需要海量消息处理能力，可以将 Rebus 与 RabbitMQ 结合使用。使用 RabbitMQ，不需要分发器，因为 RabbitMQ 在[竞争消费者](http://www.eaipatterns.com/CompetingConsumers.html)设置中运行良好。

# javascript - Telerik 的 findNodeByValue 在循环外工作，但不在循环内

> ID：15137962
> 
> 赞同：2
> 
> 时间：2013-02-28T14:27:15.167
> 
> 标签：javascript, telerik, radtreeview

我有以下代码使用客户端访问 Telerik 的 RadTreeNode。

```
 function CallbackUCSPSuccess(result, userContext, methodName) {
        var tree = $find("<%=Tree.ClientID %>"); 
```

**在这里它有效，我得到了一些节点：**

```
 var node = tree.findNodeByValue("SECTION_161");
        for (var key in result) {
             console.log(key + " - " + result[key] + "tree "+ tree);
             var foundNode = tree.FindNodeByValue(key); 
```

**但在这里我得到： TypeError: tree.FindNodeByValue is not a function**

```
 if (foundNode) {
               // doing things
            }

}; 
```

这显然是一些语法问题。请帮助我了解如何使这项工作。试图用'var'和没有'var'一起树。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T14:31:13.177

```
tree.findNodeByValue("SECTION_161"); and tree.FindNodeByValue(key); 
```

不同之处在于:)

# c++ - 无法编译简单的顶点着色器

> ID：15137969
> 
> 赞同：2
> 
> 时间：2013-02-28T14:27:54.917
> 
> 标签：c++, opengl, shader, vertex-shader

我在编译一个简单的顶点着色器时遇到了问题。我正在使用此函数进行编译：

```
GLuint TShaderManager::loadShaderFromFile(const std::string& fName, GLenum shaderType)
{
    string path = fName;

    //Open file 
    GLuint shaderID = 0; 
    string shaderString; 
    ifstream sourceFile(path.c_str()); 

    //Source file loaded 
    if(sourceFile) 
    { 
        shaderString.assign(istreambuf_iterator<char>(sourceFile), 
                            istreambuf_iterator<char>());                                           // Get shader source

        shaderID = glCreateShader(shaderType);                                                      // Create shader ID 

        const GLchar* shaderSource = shaderString.c_str(); 
        glShaderSource(shaderID, 1, (const GLchar**)&shaderSource, NULL);                           // Set shader source 

        glCompileShader(shaderID);                                                              // Compile shader source 

        GLint shaderCompiled = GL_FALSE; 
        glGetShaderiv(shaderID, GL_COMPILE_STATUS, &shaderCompiled);                                //Check shader for errors 
        if(shaderCompiled != GL_TRUE) 
        { 
            TError::showMessage("Failed to compile shader"); // I'm getting this error 
            glDeleteShader(shaderID); 
            shaderID = 0; 
        } 
    } 
    else 
    { 
        TError::showMessage(string("Unable to open file ").append(path.c_str())); 
    } 

    return shaderID;
} 
```

这是我没有编译的顶点着色器：

```
#version 330

layout(location = 0) in vec4 position;
void main()
{
    gl_Position = position;
} 
```

所以基本上`shaderCompiled`仍然存在`GL_FALSE`。

我在调试模式下检查 - 着色器在我的函数中正确加载`string`，所以问题不存在。

另外我不知道这是否有必要，但我也将我的片段着色器放在这里，它可以正确编译：

```
#version 330

out vec4 outputColor;
void main()
{
    float lerpValue = gl_FragCoord.y / 800.0f;

    outputColor = mix(vec4(1.0f, 1.0f, 1.0f, 1.0f),
                      vec4(0.2f, 0.2f, 0.2f, 1.0f), lerpValue);
} 
```

**编辑：**

`glGetShaderInfoLog`显示此消息：

> 错误：0:3 '位置'：语法错误解析错误

# php - 在codeigniter中显示图像和连接css的url

> ID：15137974
> 
> 赞同：0
> 
> 时间：2013-02-28T14:28:07.360
> 
> 标签：php, html, codeigniter

我是 Web 开发的新手（尤其是 CI 框架中的 php）。这个问题对你来说应该是一个非常简单的问题，但我已经用谷歌搜索了一个小时，仍然找不到任何解决方案。

我想显示一个图像（**img**文件夹中的 logo.png）并链接一个我放在**根**目录中的 css 文件（ **style**文件夹中的 style.css ）：

 **![在此处输入图像描述](../Images/b5a555f19633659cb6ecf8a6a6fd4789.png)

但是当我尝试显示图像并链接 css 时，我得到的只是一个**空白**的空**网页**。这是我的 html 代码：

```
<!DOCTYPE html>
<html>
    <head>
        <title>My First Design</title>
        <link href="<?php echo base_url();?>style/style.css" rel="stylesheet" type="text/css"/>
    </head>
    <body>
        <h1><img src="../../img/logo.jpg" />My First Web Design</h1>
        <p>
        I have been working on honing, and in some cases, learning new graphical skills in the past few weeks. So, I have been                          extensively watching Adobe Illustrated tutorials and working on my existing Photoshop knowledge and basically trying to                     get a hang of the software beyond basic image editing and digital painting.
        </p>
        <p>
        From a beginner’s point of view, the world of graphical design is quite vast… at times intimidating and there is no limit                           to creative options. One could branch out into any form of graphical design… illustrations or web-design or logo &                                  advertising and so much more. At the same time, one does not need to limit the options to just these.
        </p>
    </body>
</html> 
```

这是我的`config.php`base_url ：`$config['base_url'] = 'http://localhost/ciGlassProject/';`

我尝试了一些不同的方法，例如：

1.  使用 site_url 而不是 base_url
2.  手动输入网址
3.  以多种方式更改`$config['base_url']`值。但是，它们都不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T14:33:27.163

您可以使用它应该工作的基本 URL。

```
<img src="http://localhost/ciGlassProject/img/logo.jpg" /> 
```

一个更好的方法是使用 php 获取您的基本 url。这意味着如果您移动您的网站，您将不必多次更改 URL 以使其在新位置运行。为此，您可以使用简单的 php 调用：

```
<img src="<?php echo base_url(); ?>img/logo.jpg" /> 
```**

# objective-c - 多层 UIScrollView

> ID：15137979
> 
> 赞同：0
> 
> 时间：2013-02-28T14:28:14.830
> 
> 标签：objective-c, uiscrollview

各位开发者您好，

我一直在到处寻找一个项目，该项目显示了带有偏移的多层（不确定如何描述层）滚动视图的一个很好的例子。类似于此视频[http://vimeo.com/30783282](http://vimeo.com/30783282)中显示的 Victoria Secret iPad 应用程序。老实说，该应用程序比其中一些模型更好看。

这将不胜感激！！！

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T14:32:23.377

我不完全确定您指的是哪个“分层”，所以我只评论一种可能性，即在您引用的视频中的 13 秒时看到的可能性。

您可以有两个`UIScrollView`s，具有相同的框架（即一个在另一个之上）。在较低的设置`userInteractionEnabled`为`NO`，也不要设置它的委托。对于上层`UIScrollView`，设置委托并在`scrollViewDidScroll`回调上，将下层 UIScrollView 的框架调整所需的数量。

# python - 如何在 ipython 启动时将目录添加到 sys.path

> ID：15137985
> 
> 赞同：7
> 
> 时间：2013-02-28T14:28:33.510
> 
> 标签：python, ipython

环境：

*   windows 7 英文 32bit
*   蟒蛇2.7.3
*   ipython 0.13.1

我尝试配置：

```
ipython -i -c "import sys; sys.path.append('path_name')" 
```

但这似乎不起作用。
那么正确的解决方案是什么？

或者如何在 ipython 启动时将当前目录添加到 sys.path？
谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2014-08-13T09:06:07.373

只是对红河的一点跟进。吴的回答。

有人可能想添加：

```
c.InteractiveShellApp.exec_lines = [
'import sys; sys.path.append("/absolute/path/")'] 
```

到 ipython_config.py 添加任意目录。

此外，如果您是 ipython 新手（就像我一样），您需要先创建标准配置文件，因此 ipython_config.py 确实存在。所以你需要：

```
ipython profile create 
```

您可以通过以下方式找到配置目录

```
ipython locate 
```

最佳 S

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-28T15:40:16.423

在@cartman 的帮助下，我目前使用文件中的流动配置`ipython_config.py`将当前目录添加到 sys.path：

```
c.InteractiveShellApp.exec_lines = [
'import sys,os; sys.path.append(os.getcwd())'
] 
```

直到有更好的解决方案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-28T14:34:11.643

将命令放入`ipython_config.py`文件中，请参阅[配置 ipython 命令行应用程序](http://ipython.org/ipython-doc/rel-0.13/config/ipython.html)，查看更多配置选项。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-06-28T16:39:05.747

```
c = get_config()
c.InteractiveShellApp.exec_lines = ['import sys,os; sys.path.append os.get_exec_path())'] 
```

把它放在`ipython_config.py`文件中。

在 stevosn 的帮助下。

# ruby - Ruby 中 <=> 运算符的名称是什么？他们怎么称呼它？

> ID：15137987
> 
> 赞同：5
> 
> 时间：2013-02-28T14:28:34.913
> 
> 标签：ruby, ruby-1.9, spaceship-operator

在 Ruby 中有`<=>`运算符。在 API 中，他们没有命名它的名字，只是：

> 该类必须定义 <=> 运算符...
> 
> Comparable 使用 <=> 来实现常规比较...
> 
> ...集合中的对象还必须实现有意义的 <=> 运算符...

它叫什么名字？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-28T14:30:50.327

请参阅上面的@Tony。然而，它也被称为（俚语）“宇宙飞船操作员”。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-28T14:30:52.683

它被称为**组合比较运算符**

> 组合比较运算符。如果第一个操作数等于第二个，则返回 0，如果第一个操作数大于第二个，则返回 1，如果第一个操作数小于第二个，则返回 -1。

```
(a <=> b) returns -1. 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-28T14:31:01.717

这称为组合比较运算符。如果第一个操作数等于第二个，则返回 0，如果第一个操作数大于第二个，则返回 1，如果第一个操作数小于第二个，则返回 -1。

[资源](http://www.tutorialspoint.com/ruby/ruby_operators.htm)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-09-10T04:09:24.887

我也听说它只是称为双哈希火箭

# iphone - SoundManager 2 和 iPhone

> ID：15137988
> 
> 赞同：1
> 
> 时间：2013-02-28T14:28:37.137
> 
> 标签：iphone, html, audio, soundmanager2

以下代码适用于我的桌面浏览器，但不适用于我 iPhone 上的 Safari，它确实显示 alert() 但不播放音频。我究竟做错了什么？

```
soundManager.url = '/assets/backend/swf/';
soundManager.preferFlash = false;
soundManager.useHTML5Audio = true;
soundManager.onready(function(){
    function playSong(){
        soundManager.createSound({
            id: 'song_<?=$song->ID?>',
            url: '/backend/song/play/<?=$song->ID?>',
            type: 'audio/mp3'
        }).play();
    }

    $('#play').click(function(){
        alert('playSong()');
        playSong();
    });
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-03T13:12:47.133

据我所见，iPhone 不喜欢“自动播放”的声音，它们需要通过用户交互来播放声音。

在您的情况下，iOS 浏览器一定不喜欢您正在创建声音然后立即播放它的事实。

试试这个变体，看看它是否适合你：

```
soundManager.url = '/assets/backend/swf/';
soundManager.preferFlash = false;
soundManager.useHTML5Audio = true;
soundManager.onready(function(){
    // Create the sounds here (don't call play)
    soundManager.createSound({
        id: 'song_<?=$song->ID?>', // It is not cool to put PHP here, read below!
        url: '/backend/song/play/<?=$song->ID?>',
        type: 'audio/mp3'
    });

    $('#play').click(function(){
        var soundId = 'song_<?= $song->ID ?>';
        soundManager.play(soundId);
    });
}); 
```

附带说明：我建议您不要以这种方式混合 JS 和 PHP。查看这个 SoundManager2 示例，了解如何“增强”这样的常规 MP3 链接：

```
<a href="blabla.mp3">Click here to play blabla</a> 
```

进入播放 MP3 onclick 的东西： [SoundManager2 文档](http://www.schillmania.com/projects/soundmanager2/demo/page-player/)

问候和祝你好运！

# c++-cx - 如何在运行时在 C++/CX 中创建添加 WinRT 对象？

> ID：15137990
> 
> 赞同：0
> 
> 时间：2013-02-28T14:28:39.693
> 
> 标签：c++-cx

我想在一个函数（比如一个事件）中创建一个 WinRT 对象（比如一个文本块）并将其添加到 C++/CX 中的页面（比如在运行时设置其行和列编号的网格）。是否可以？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T00:26:06.050

只需像调用任何其他对象一样在类上调用“ref new”，并将其添加到网格的“儿童”集合中。

为了设置网格的行和列，您需要通过在网格上调用 SetRow/SetColumn 来设置附加属性。

这很容易通过在 xaml 文件中命名网格（使用 x:Name 属性）来完成，这样您就可以在代码中按名称引用它。xml:

```
<Grid x:Name="myGrid">
    <Grid.RowDefinitions>
        <RowDefinition />
        <RowDefinition />
    </Grid.RowDefinitions>
    <Grid.ColumnDefinitions>
        <ColumnDefinition />
        <ColumnDefinition />
    </Grid.ColumnDefinitions>
</Grid> 
```

代码隐藏：

```
auto textBlock = ref new TextBlock();
textBlock->Text = "this is my text";
myGrid->Children->Append(textBlock);
myGrid->SetRow(textBlock, 1);
myGrid->SetColumn(textBlock, 0); 
```

# sql - 使用 PIVOT 访问 SQL

> ID：15137992
> 
> 赞同：1
> 
> 时间：2013-02-28T14:28:42.200
> 
> 标签：sql, ms-access

我正在使用 Access 并尝试复制我在 MSDN 上找到的一些语法。不幸的是，似乎 Access 在我的语法中的 FROM 语句存在问题。我不确定为什么。

```
SELECT YEAR, HC
FROM
(
SELECT [Retention & Graduation].Year, [Retention & Graduation].Status, [Retention & Graduation].Hc
FROM [Retention & Graduation]
) AS X

PIVOT
(
SUM([HC]) FOR [STATUS] IN ([GONE], [HERE], [GRAD])
) AS Xx 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-28T14:36:10.403

在 MS Access 中进行透视的语法与 sql server 不同。您必须使用该[`TRANSFORM`](http://msdn.microsoft.com/en-us/library/office/bb208956%28v=office.12%29.aspx)功能来透视数据。

语法将与此类似：

```
TRANSFORM SUM([Retention & Graduation].Hc)
SELECT [Retention & Graduation].Year, 
  [Retention & Graduation].Status, 
  [Retention & Graduation].Hc
FROM [Retention & Graduation]
GROUP BY [Retention & Graduation].Year
PIVOT [Retention & Graduation].[STATUS] 
```

# couchbase - 无法连接到 http://localhost:8091/index.html

> ID：15137996
> 
> 赞同：4
> 
> 时间：2013-02-28T14:28:47.343
> 
> 标签：couchbase

我刚刚在我的 Windows 7 64 位机器上使用 setup.exe 安装了 CouchBase Server Enterprise v2.0.0，据说基于浏览器的控制台应该在安装后自动出现，但我得到的只是无法连接：

```
**Firefox can't establish a connection to the server at localhost:8091.** 
```

当我检查时，CouchBase 服务正在运行？我现在已经卸载并重新安装了几次？我在这里错过了什么吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-28T15:30:02.990

您可能在 Couchbase 服务器启动期间遇到了与 IP 地址获取相关的已知问题。

我在这里记录了一项工作：http: [//tugdualgrall.blogspot.com/2012/12/what-to-do-if-your-couchbase-server.html](http://tugdualgrall.blogspot.com/2012/12/what-to-do-if-your-couchbase-server.html)

如博客文章中所述，它将在 2.0.1 版本中修复